VERSION E05

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:1    
        1        1        /*M* QBA$ACTIVATE:  ACTIVATE some number of FRAMEs/FORMs.  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=0,DCI=4,CSI=2,IAD=2,DTI=2,AND,ECI=0,DIN=2,STI=2 */
        8        8
        9        9        /*P*  NAME:         QBA$ACTIVATE
       10       10              PURPOSE:      Activate fields within frames/forms.
       11       11              DESCRIPTION:  Execute an ACTIVATE op-code, whose argument
       12       12                            maybe a frame, a list of frames, a form,
       13       13                            a list of forms, or any combination of the
       14       14                            above.  All fields within the scope of all
       15       15                            of this op-code's argument(s) are to be
       16       16                            M$DCLFLDed.
       17       17        */
       18       18
       19       19        QBA$ACTIVATE: PROC;
       20       20
       21       21        /*D*  NAME:         QBA$ACTIVATE
       22       22              CALL:         CALL QBA$ACTIVATE;
       23       23              PARAMETERS:   None.
       24       24              INTERFACE:    Called by QAT$TALLYHO when an ACTIVATE op-code
       25       25                            is encountered.
       26       26              ENVIRONMENT:  Nothing unusual.
       27       27              INPUT:        QI_1,
       28       28                            FPL rununit static data following the op-code.
       29       29              OUTPUT:       Mostly affects dynamic memory by allocating
       30       30                            more for the fields to be activated.
       31       31              SCRATCH:      Various otter data.
       32       32              DESCRIPTION:  OK, here it is.
       33       33                            Each active field within a running FPL program
       34       34                            has associated with it a QI$GZ_FIELD structure
       35       35                            (see corresponding MACRO in QI_MACROS_M).
       36       36                            This structure contains stuff pertinent to the
       37       37                            field's "disposition" at the current time.
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:2    
       38       38                            In this way, operations which affect many
       39       39                            fields at once (such as screen-FD reads) can
       40       40                            be performed without traversing the (complicated)
       41       41                            compiler-generated field structures.  Such
       42       42                            operations simply interrogate any and all fields
       43       43                            within the scope of any and all QI$GZ_HEADERs
       44       44                            which fall under the jurisdiction of the
       45       45                            operand(s) of the operation.
       46       46                            At any rate, each field within whatever it is
       47       47                            we're activating must be represented by a
       48       48                            QI$GZ_FIELD structure in dynamic memory, and
       49       49                            must also be defined to VDH via M$DCLFLD.
       50       50        */
       51       51
       52       52          %INCLUDE B_ERRORS_C;
       53     1179          %INCLUDE LCP_6;
       54     1370          %FPT_DCLFLD ( FPTN = FPT@DCLFLD,
       55     1371                        STCLASS = AUTO );
       56     1409          %VLP_FLDATR ( FPTN = VLP@FLDATR,
       57     1410                        STCLASS = AUTO );
       58     1436          %FPT_GDS ( FPTN = FPT@GDS,
       59     1437                     STCLASS = AUTO );
       60     1461          %FPT_RLSFLD ( FPTN = FPT@RLSFLD,
       61     1462                        STCLASS = AUTO );
       62     1494          %FPT_SLCFLD ( FPTN = FPT@SLCFLD,
       63     1495                        STCLASS = AUTO );
       64     1527          %M$DCB ( DCBN = M$DCB,
       65     1528                   STCLASS = BASED );
       66     1579          %INCLUDE QG_MACRO_M;
       67     1716          %QGB_ENTRIES;
       68     1729          %INCLUDE QI_EQUATES_E;
       69     2088          %INCLUDE QI_PERR_C;
       70     2256          %INCLUDE QI_MACROS_M;
       71     7314          %QI$ALL;
       72    18427          %QI_FPTS;
       73    20472
       74    20473    1     DCL BOX_MAX_COLUMN UBIN;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:3    
       75    20474    1     DCL BOX_MAX_ROW UBIN;
       76    20475    1     DCL BOX_MIN_COLUMN UBIN;
       77    20476    1     DCL BOX_MIN_ROW UBIN;
       78    20477    1     DCL COLUMN_INCREMENT UBIN;
       79    20478    1     DCL COLUMN_INDEX UBIN;
       80    20479    1     DCL COLUMN_INDEX_STOP UBIN;
       81    20480    1     DCL COLUMN_STOP_GROUP UBIN;
       82    20481    1     DCL CURRENT_FATHER$ PTR;
       83    20482    1     DCL CURRENT_FATHER_STATUS$ PTR;
       84    20483    1     DCL DAD$ PTR;
       85    20484    1     DCL DISP UBIN;
       86    20485    1     DCL ELEM_COUNT UBIN;
       87    20486    1     DCL FIELD_BYTE_SIZE UBIN;
       88    20487    1     DCL FIELD_COLUMN UBIN;
       89    20488    1     DCL FIELD_COUNT UBIN;
       90    20489    1     DCL FIELD_DAD_P$ PTR;
       91    20490    1     DCL FIELD_DIM_CNT UBIN;
       92    20491    1     DCL FIELD_IDENTIFIER$ PTR;
       93    20492    1     DCL FIELD_INDEX SBIN;
       94    20493    1     DCL FIELD_ROW UBIN;
       95    20494    1     DCL FORM_FILE$ PTR;
       96    20495    1     DCL FORM_STATUS$ PTR;
       97    20496    1     DCL FRAME$ PTR;
       98    20497    1     DCL FRAME_COLUMN UBIN;
       99    20498    1     DCL FRAME_INDEX UBIN;
      100    20499    1     DCL FRAME_ROW UBIN;
      101    20500    1     DCL FRAME_STATUS$ PTR;
      102    20501    1     DCL GZ_FIELD$ PTR;
      103    20502    1     DCL GZ_HEADER$ PTR;
      104    20503    1     DCL INDICATORS$ PTR;
      105    20504    1     DCL INIT_DATA$ PTR;
      106    20505    1     DCL INIT_FIELD_COLUMN UBIN;
      107    20506    1     DCL INIT_FIELD_OFFSET UBIN;
      108    20507    1     DCL INSTR$ PTR;
      109    20508    1     DCL INX UBIN;
      110    20509    1     DCL INX_A$(0:2) PTR;
      111    20510    1     DCL ITS_AN_ACTIVATE BIT(1) ALIGNED;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:4    
      112    20511    1     DCL MAX_FIELD_SIZE UBIN;
      113    20512    1     DCL MULT_COUNT UBIN;
      114    20513    1     DCL NEXT_INDEX UBIN;
      115    20514    1     DCL OPERAND_COUNT UBIN;
      116    20515    1     DCL OPERAND_INDEX UBIN;
      117    20516    1     DCL OVERLAPPING_FIELD_IDENTIFIER$ PTR;
      118    20517    1     DCL PART_FIELD_SIZE UBIN;
      119    20518    1     DCL P_ITEM_INDEX UBIN;
      120    20519    1     DCL REPEATS_INDEX SBIN;
      121    20520    1     DCL ROW_INCREMENT UBIN;
      122    20521    1     DCL ROW_REPEATS$ PTR;
      123    20522    1     DCL SEPARATED_INDEX SBIN;
      124    20523    1     DCL ROW_INDEX UBIN;
      125    20524    1     DCL ROW_INDEX_STOP UBIN;
      126    20525    1     DCL TOTAL_GZ_NEEDED UBIN;
      127    20526    1     DCL TOTAL_GZ_SPACE UBIN;
      128    20527
      129    20528    1     DCL QBA$DEACTIVATE_FORM ENTRY ALTRET;
      130    20529    1     DCL QBA$DEACTIVATE_FRAME ENTRY ALTRET;
      131    20530    1     DCL QCE$ERROR ENTRY (4);
      132    20531    1     DCL QCE$ERROR_INTERNAL ENTRY (4);
      133    20532    1     DCL QCE$ERROR_M$INTERNAL ENTRY (4);
      134    20533    1     DCL QCF$FIND_CURRENTS ENTRY;
      135    20534    1     DCL QCU$UPDATE_SCREEN ENTRY;
      136    20535    1     DCL QCU$USE_IO ENTRY (1);
      137    20536
      138    20537          %SET LISTMAC = '1'B;
      139    20538
      140    20539          %INCLUDE QCU_USE_M;
      141    20593          %QCU@USE;
             20594            %BEGIN_MACRO;
             20595            %SET LISTDIR = '0'B;
             20608    1     DCL 1 QCU@USE AUTO ALIGNED,
             20609    1           2 CURR_FRAME$ PTR,
             20610                          /* Pointer to DAD of current frame or ADDR (NIL).  */
             20611    1           2 CURR_NODE$ PTR,
             20612                          /* Pointer to current node or ADDR (NIL).  */
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:5    
             20613    1           2 USE_DEFAULT_IO UBIN,
             20614                          /* For USE procedures which default applies
             20615                             (see corresponding EQUs).  */
             20616    1           2 IS_TIME_TO_SAVE_AWAY_FIELDS BIT(1) ALIGNED,
             20617                          /* If IS_TIME_TO_SAVE_AWAY_FIELDS, then
             20618                             save the fields within the bounds of
             20619                             FRAME_START_INDEX, FRAME_STOP_INDEX,
             20620                             FIELD_START_INDEX, and FIELD_STOP_INDEX
             20621                             before calling the USE procedure.  */
             20622    1           2 FRAME_START_INDEX UBIN,
             20623                          /* Foist frame of the CURRENT.FORM$
             20624                             involved with the I-O error.  */
             20625    1           2 FRAME_STOP_INDEX UBIN,
             20626                          /* Larst frame of the CURRENT.FORM$
             20627                             involved with the I-O error.  */
             20628    1           2 IS_FIELD_INDEXES_VALID BIT(1) ALIGNED,
             20629                          /* If IS_FIELD_INDEXES_VALID, use them;
             20630                             else use all the fields in the frame.  */
             20631    1           2 FIELD_START_INDEX UBIN,
             20632                          /* Starting index into QI$GZ_FIELD
             20633                             which may have values "pushed".  */
             20634    1           2 FIELD_STOP_INDEX UBIN,
             20635                          /* Stopping index into QI$GZ_FIELD
             20636                             which may have values "pushed".  */
             20637    1           2 IS_CURSOR_POSITION_VALID BIT(1) ALIGNED,
             20638                          /* If IS_CURSOR_POSITION_VALID, use it;
             20639                             else allow cursor to default to upper-left-most field.  */
             20640    1           2 CURSOR_POSITION BIT(16) ALIGNED,
             20641                          /* POSition of the field on which to place the cursor.  */
             20642    1           2 STATUS UBIN;
             20643                          /* Returned action code; see corresponding EQUs.  */
             20650            %ENDIF;
      142    20653
      143    20654          %SET LISTMAC = '0'B;
      144    20655        %EJECT;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:6    
      145    20656    1       ITS_AN_ACTIVATE = %YES;
      146    20657    1       GOTO SO_ACTIVATE_IT_ALREADY;
      147    20658
      148    20659    1   QBA$DEACTIVATE: ENTRY;
      149    20660
      150    20661    1       ITS_AN_ACTIVATE = %NO;
      151    20662
      152    20663    1   SO_ACTIVATE_IT_ALREADY:
      153    20664    1       INSTR$ = QI_1.INSTR$;
      154    20665    1       OPERAND_COUNT = INSTR$ -> QI$OP_ACTIVATE.OPERAND_COUNT;
      155    20666    1       QI_1.INSTR$ = PINCRW ( QI_1.SOURCE$, OPERAND_COUNT + 1 );
      156    20667
      157    20668    1   ACTIVATE_DEACTIVATE_FORM_FRAME:
      158    20669    2       DO OPERAND_INDEX = 0 TO OPERAND_COUNT - 1;
      159    20670
      160    20671    2   RETRY_CURRENT_ACT_DEACT_IVATE:
      161    20672              %PROC_ADDRESS ( THING@P =
             20672                  "INSTR$ -> QI$OP_ACTIVATE.OPERAND_A@P ( OPERAND_INDEX )",
      162    20673              CHECK_FOR_INDIRECTION = NO,
      163    20674              RESULT$ = "QI_1.CURRENT.NODE$" );
      164    20711
      165    20712    2         CALL QCF$FIND_CURRENTS;
      166    20713
      167    20714    2         IF QI_1.CURRENT.NODE$ -> QI$FRAME.WORD0_FLAGS.TYPE = %QI#TYPE_FRAME
      168    20715    2         THEN
      169    20716    2   GET_CURRENT_FORM$:
      170    20717    3           DO;
      171    20718                  /*  Incrementing loop index:  look out.
      172    20719                      For FRAME-type operands, the op-code sequence
      173    20720                      contains both a FRAME pointer and a FORM pointer,
      174    20721                      so we know which FORM to activate this FRAME for.
      175    20722                      (The FRAME may be in more than one FORM).  */
      176    20723    3             OPERAND_INDEX = OPERAND_INDEX + 1;
      177    20724
      178    20725                  %PROC_ADDRESS ( THING@P =
             20725                      "INSTR$ -> QI$OP_ACTIVATE.OPERAND_A@P ( OPERAND_INDEX )",
      179    20726                  CHECK_FOR_INDIRECTION = NO,
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:7    
      180    20727                  RESULT$ = "QI_1.CURRENT.FORM$");
      181    20764
      182    20765                  %DATA_ADDRESS ( THING@D =
             20765                      "QI_1.CURRENT.FORM$ -> QI$FORM_FILE.STATUS_AREA@D",
      183    20766                  CHECK_FOR_INDIRECTION = NO,
      184    20767                  RESULT$ = "QI_1.CURRENT.FORM_STATUS$" );
      185    20804    3           END GET_CURRENT_FORM$;
      186    20805
      187    20806    2         IF NOT QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.
             20806                  IS_OUTPUT
      188    20807    2           AND NOT QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.
             20807                    IS_INPUT
      189    20808    2         THEN
      190    20809    3           DO;
      191    20810    3             QI_1.ERROR_STATUS = %E$FILE_NOT_OPEN;
      192    20811    3             GOTO CHECK_USE_PROCEDURE;
      193    20812    3           END;
      194    20813
      195    20814    2         IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.WORD0_FLAGS.TYPE = %QI#TYPE_FRAME
      196    20815    2         THEN
      197    20816    2   ACTIVATE_FRAME:
      198    20817    3           DO;
      199    20818    3             IF ITS_AN_ACTIVATE
      200    20819    3             THEN
      201    20820    3               CALL ACTIVATE_FRAME ALTRET ( CHECK_USE_PROCEDURE );
      202    20821    3             ELSE
      203    20822    3               CALL QBA$DEACTIVATE_FRAME ALTRET ( CHECK_USE_PROCEDURE );
      204    20823
      205    20824    3           END ACTIVATE_FRAME;
      206    20825    2         ELSE
      207    20826    2   ACTIVATE_FORM:
      208    20827    3           DO;
      209    20828
      210    20829    3             IF ITS_AN_ACTIVATE
      211    20830    3             THEN
      212    20831    3               CALL ACTIVATE_FORM ALTRET ( CHECK_USE_PROCEDURE );
      213    20832    3             ELSE
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:8    
      214    20833    3               CALL QBA$DEACTIVATE_FORM ALTRET ( CHECK_USE_PROCEDURE );
      215    20834
      216    20835    3           END ACTIVATE_FORM;
      217    20836
      218    20837    2   NEXT_ACT_DEACT_IVATE_PLEASE:
      219    20838    2       END ACTIVATE_DEACTIVATE_FORM_FRAME;
      220    20839
      221    20840    1       RETURN;
      222    20841
      223    20842        %EJECT;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:9    
      224    20843    1   CHECK_USE_PROCEDURE:
      225    20844    1       QCU@USE.CURR_NODE$ = QI_1.CURRENT.NODE$;
      226    20845    1       QCU@USE.CURR_FRAME$ = QI_1.CURRENT.FRAME$;
      227    20846    1       QCU@USE.IS_TIME_TO_SAVE_AWAY_FIELDS = %NO;
      228    20847    1       QCU@USE.USE_DEFAULT_IO = %QI#USE_DEFAULT_NONE;
      229    20848
      230    20849    1       CALL QCU$USE_IO ( QCU@USE );
      231    20850
      232    20851    2       DO CASE ( QCU@USE.STATUS );
      233    20852
      234    20853    2         CASE ( %QI#USE_INVALID_RETURN );
      235    20854    2           RETURN;
      236    20855
      237    20856    2         CASE ( %QI#USE_INVALID_RETRY );
      238    20857    2           GOTO RETRY_CURRENT_ACT_DEACT_IVATE;
      239    20858
      240    20859    2         CASE ( %QI#USE_INVALID_SKIP_TO_NEXT );
      241    20860    2           GOTO NEXT_ACT_DEACT_IVATE_PLEASE;
      242    20861
      243    20862    2         CASE ( ELSE );
      244    20863    2           CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );
      245    20864
      246    20865    2       END;
      247    20866
      248    20867        %EJECT;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:10   
      249    20868    1   ACTIVATE_FORM: PROC ALTRET;
      250    20869
      251    20870        /*I*  NAME:         ACTIVATE_FORM
      252    20871              PURPOSE:      DCLFLD all the fields in a form.
      253    20872              PARAMETERS:   None.
      254    20873              DATA:         The usual global stuff.
      255    20874              PURPOSE:      Allocate dynamic memory for GZ$whatevers for
      256    20875                            a form.  This includes one QI$GZ_HEADER structure
      257    20876                            for each frame, and one QI$GZ_FIELD structure for
      258    20877                            each field within each frame.  Then call M$DCLFLD
      259    20878                            for each field.
      260    20879        */
      261    20880
      262    20881    3       DO FRAME_INDEX = 0 TO QI_1.CURRENT.FORM$ -> QI$FORM_FILE.FRAME_COUNT - 1;
      263    20882
      264    20883              %PROC_ADDRESS ( THING@P =
             20883                  "QI_1.CURRENT.FORM$ -> QI$FORM_FILE.FRAME_LIST_A@P ( FRAME_INDEX )",
      265    20884              CHECK_FOR_INDIRECTION = NO,
      266    20885              RESULT$ = "QI_1.CURRENT.FRAME$" );
      267    20922
      268    20923              %DATA_ADDRESS ( THING@D = "QI_1.CURRENT.FRAME$ -> QI$FRAME.STATUS_AREA@D",
      269    20924              CHECK_FOR_INDIRECTION = NO,
      270    20925              RESULT$ = "QI_1.CURRENT.FRAME_STATUS$" );
      271    20962
      272    20963    3         CALL ACTIVATE_FRAME
      273    20964    3         WHENALTRETURN
      274    20965    4           DO;
      275    20966    4             ALTRETURN;
      276    20967    4           END;
      277    20968
      278    20969    3       END;
      279    20970
      280    20971    2       RETURN;
      281    20972
      282    20973    2   END ACTIVATE_FORM;
      283    20974        %EJECT;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:11   
      284    20975    1   ACTIVATE_FRAME: PROC ALTRET;
      285    20976
      286    20977        /*I*  NAME:         ACTIVATE_FRAME
      287    20978              PURPOSE:      DCLFLD all the fields in a frame.
      288    20979              PARAMETERS:   None.
      289    20980              DATA:         The usual global stuff.
      290    20981              PURPOSE:      Allocate dynamic memory for GZ$whatevers for
      291    20982                            a frame.  This includes one QI$GZ_HEADER structure
      292    20983                            for the frame, and one QI$GZ_FIELD structure for
      293    20984                            each field within the frame.  Then call M$DCLFLD
      294    20985                            for each field.
      295    20986        */
      296    20987
      297    20988    2       IF QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.INDICATORS.IS_ACTIVE
      298    20989    2       THEN
      299    20990    3         DO;
      300    20991    3           QI_1.ERROR_STATUS = %E$FRAME_ALREADY_ACTIVATED;
      301    20992    3           ALTRETURN;
      302    20993    3         END;
      303    20994
      304    20995            /*  If a screen update is pending due to a previous DEACTIVATE,
      305    20996                do that now.  Otherwise, a new field may overlap an old one.  */
      306    20997    2       IF QI_1.SCREEN_UPDATE_FLAGS.WAS_DEACTIVATED
      307    20998    2       THEN
      308    20999    2         CALL QCU$UPDATE_SCREEN;
      309    21000
      310    21001    2       FIELD_COUNT = 0;
      311    21002    2       MAX_FIELD_SIZE = 0;
      312    21003
      313    21004    2       QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.FIELD_START_INDEX = 0;
      314    21005    2       QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.FIELD_STOP_INDEX = 0;
      315    21006
      316    21007    2       CURRENT_FATHER$ = QI_1.CURRENT.FRAME$;
      317    21008
      318    21009            %PROC_ADDRESS ( THING@P = "QI_1.CURRENT.FRAME$ -> QI$FRAME.SON@P",
      319    21010            CHECK_FOR_INDIRECTION = NO,
      320    21011            RESULT$ = DAD$ );
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:12   
      321    21048
      322    21049    2   NEXT_COUNT:
      323    21050    2       QI_1.CURRENT.NODE$ = DAD$;
      324    21051
      325    21052            %DATA_ADDRESS ( THING@D = "DAD$ -> QI$MAJOR_NODE.STATUS_AREA@D",
      326    21053            CHECK_FOR_INDIRECTION = NO,
      327    21054            RESULT$ = "QI_1.CURRENT.NODE_STATUS$" );
      328    21091
      329    21092            %DATA_ADDRESS ( THING@D = "CURRENT_FATHER$ -> QI$MAJOR_NODE.STATUS_AREA@D",
      330    21093            CHECK_FOR_INDIRECTION = NO,
      331    21094            RESULT$ = CURRENT_FATHER_STATUS$ );
      332    21131
      333    21132        /* INHERIT ROW & COL INCREMENTS                  */
      334    21133    2       QI_1.CURRENT.NODE_STATUS$ -> QI$MAJOR_STATUS.GZ.FIELD_START_INDEX =
             21133                CURRENT_FATHER_STATUS$ -> QI$MAJOR_STATUS.GZ.FIELD_START_INDEX;
      335    21134    2       QI_1.CURRENT.NODE_STATUS$ -> QI$MAJOR_STATUS.GZ.FIELD_STOP_INDEX =
             21134                CURRENT_FATHER_STATUS$ -> QI$MAJOR_STATUS.GZ.FIELD_STOP_INDEX;
      336    21135
      337    21136    3       DO CASE ( DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.TYPE );
      338    21137
      339    21138    3         CASE ( %QI#TYPE_DISPLAY );
      340    21139    3           PART_FIELD_SIZE = DAD$ -> QI$FIELD_DAD.PSEUDO_CIP.NUMERIC.LEN;
      341    21140
      342    21141    3           GOTO CONTINUE_COUNT;
      343    21142
      344    21143    3         CASE ( %QI#TYPE_ALPHANUMERIC );
      345    21144    3           PART_FIELD_SIZE = DAD$ -> QI$FIELD_DAD.PSEUDO_CIP.ALPHANUMERIC.LEN;
      346    21145
      347    21146    3   CONTINUE_COUNT:
      348    21147    3           IF PART_FIELD_SIZE > MAX_FIELD_SIZE
      349    21148    3             AND DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.IO_FLAGS.IS_INPUT
      350    21149    3           THEN
      351    21150    3             MAX_FIELD_SIZE = PART_FIELD_SIZE;
      352    21151
      353    21152    3           IF DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT > 0
      354    21153    3           THEN
      355    21154    4             DO;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:13   
      356    21155
      357    21156        /* HAVE DIMENSIONS                               */
      358    21157                    /*  Increment past any level_multipliers to get to the
      359    21158                        P.whatever flags.  */
      360    21159    4               FIELD_DAD_P$ = ADDR ( DAD$ -> QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS.
             21159                        LEVEL_MULTIPLIER_A
      361    21160    4                 ( DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT )
      362    21161    4                 );
      363    21162
      364    21163        /* CHECK IF REPEATS APPEARS ON ELEMENTARY        */
      365    21164    4               IF FIELD_DAD_P$ -> QI$FIELD_DAD_P.P.REPEATS
      366    21165    4               THEN
      367    21166    5                 DO;
      368    21167        /* YES                                           */
      369    21168        /* MUST COMPUTE COLUMN INCREMENT                 */
      370    21169    5                   IF FIELD_DAD_P$ -> QI$FIELD_DAD_P.P.SEPARATED
      371    21170    5                   THEN
      372    21171    6                     DO;
      373    21172
      374    21173        /* HAVE A SEPARATED CLAUSE                       */
      375    21174                            %PRESENCE_DISPLACEMENT (
      376    21175                            PRESENCE_THING$ = FIELD_DAD_P$,
      377    21176                            INDEX = P_ITEM_INDEX,
      378    21177                            START = %QI#P_FIELD_FIRST_INDEX,
      379    21178                            STOP = %QI#P_SEPARATED_INDEX,
      380    21179                            RESULT = SEPARATED_INDEX
      381    21180                            );
      382    21212
      383    21213    6                       QI_1.CURRENT.NODE_STATUS$ -> QI$FIELD_STATUS.GZ.FIELD_STOP_INDEX
             21213                                =
      384    21214    6                         PART_FIELD_SIZE
      385    21215    6                         + FIELD_DAD_P$ -> QI$FIELD_DAD_P.P_ITEM_A ( SEPARATED_INDEX );
      386    21216
      387    21217    6                     END;
      388    21218    5                   ELSE
      389    21219
      390    21220    5                     QI_1.CURRENT.NODE_STATUS$ -> QI$FIELD_STATUS.GZ.FIELD_STOP_INDEX =
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:14   
      391    21221    5                       PART_FIELD_SIZE + 1;
      392    21222
      393    21223    5                 END; /* IF FIELD_DAD_P$ -> QI$FIELD_DAD_P.P.REPEATS */
      394    21224
      395    21225    4             END; /* IF DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT > 0 */
      396    21226
      397    21227    3           ELEM_COUNT = 1;
      398    21228
      399    21229    3           IF DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT > 0
      400    21230    3           THEN
      401    21231    4             DO;
      402    21232        /* HAVE DIMENSIONS                               */
      403    21233    4               GOTO HAVE_FIELD_COUNT;
      404    21234
      405    21235    4   CHECK_DIM_COUNT:
      406    21236    5               DO CASE ( DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.TYPE );
      407    21237
      408    21238    5                 CASE ( %QI#TYPE_DISPLAY, %QI#TYPE_ALPHANUMERIC );
      409    21239    5   HAVE_FIELD_COUNT:
      410    21240                        /*  Increment past any level_multipliers to get to the
      411    21241                            P.whatever flags.  */
      412    21242    5                   FIELD_DAD_P$ = ADDR ( DAD$ -> QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS.
             21242                            LEVEL_MULTIPLIER_A
      413    21243    5                     ( DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT )
      414    21244    5                     );
      415    21245
      416    21246    5                   IF FIELD_DAD_P$ -> QI$FIELD_DAD_P.P.REPEATS
      417    21247    5                   THEN
      418    21248    6                     DO;
      419    21249
      420    21250                            %PRESENCE_DISPLACEMENT (
      421    21251                            PRESENCE_THING$ = FIELD_DAD_P$,
      422    21252                            INDEX = P_ITEM_INDEX,
      423    21253                            START = %QI#P_FIELD_FIRST_INDEX,
      424    21254                            STOP = %QI#P_REPEATS_INDEX,
      425    21255                            RESULT = REPEATS_INDEX
      426    21256                            );
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:15   
      427    21288
      428    21289    6                       MULT_COUNT = FIELD_DAD_P$ -> QI$FIELD_DAD_P.P_ITEM_A (
             21289                                REPEATS_INDEX );
      429    21290
      430    21291    6                       GOTO HAVE_MULT_COUNT;
      431    21292
      432    21293    6                     END;
      433    21294
      434    21295    5                 CASE ( %QI#TYPE_MINOR );
      435    21296    5                   IF DAD$ -> QI$MINOR_NODE.REPEATS > 0
      436    21297    5                   THEN
      437    21298    6                     DO;
      438    21299
      439    21300    6                       MULT_COUNT = DAD$ -> QI$MINOR_NODE.REPEATS;
      440    21301
      441    21302    6   HAVE_MULT_COUNT:
      442    21303    6                       ELEM_COUNT = MULT_COUNT * ELEM_COUNT;
      443    21304
      444    21305    6                     END;
      445    21306
      446    21307    5                 CASE ( %QI#TYPE_MAJOR, %QI#TYPE_FRAME );
      447    21308
      448    21309    5                 CASE ( ELSE );
      449    21310    5                   CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );
      450    21311
      451    21312
      452    21313    5               END;
      453    21314
      454    21315    4               IF DAD$ -> QI$MAJOR_NODE.FATHER@P > 0
      455    21316    4                 AND DAD$ -> QI$MAJOR_NODE.WORD0_FLAGS.TYPE ~= %QI#TYPE_FRAME
      456    21317    4               THEN
      457    21318    5                 DO;
      458    21319
      459    21320                        %PROC_ADDRESS ( THING@P = "DAD$ -> QI$MAJOR_NODE.FATHER@P",
      460    21321                        CHECK_FOR_INDIRECTION = NO,
      461    21322                        RESULT$ = DAD$ );
      462    21359
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:16   
      463    21360    5                   GOTO CHECK_DIM_COUNT;
      464    21361
      465    21362    5                 END;
      466    21363
      467    21364    4             END; /* IF DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT > 0 */
      468    21365
      469    21366    3           FIELD_COUNT = FIELD_COUNT + ELEM_COUNT;
      470    21367
      471    21368    3           GOTO CHECK_STEP_ACROSS_COUNT;
      472    21369
      473    21370    3         CASE ( %QI#TYPE_MINOR );
      474    21371    3           IF DAD$ -> QI$MINOR_NODE.REPEATS > 0
      475    21372    3           THEN
      476    21373    4             DO;
      477    21374
      478    21375    4               BOX_MAX_ROW = 0;
      479    21376    4               BOX_MAX_COLUMN = 0;
      480    21377
      481    21378    4               BOX_MIN_ROW = %BITBIN ('7FFF'X);
      482    21379    4               BOX_MIN_COLUMN = %BITBIN ('7FFF'X);
      483    21380
      484    21381                    %PROC_ADDRESS ( THING@P = "DAD$ -> QI$MINOR_NODE.SON@P",
      485    21382                    CHECK_FOR_INDIRECTION = NO,
      486    21383                    RESULT$ = DAD$ );
      487    21420
      488    21421    4   NEXT_BOX:
      489    21422    5               DO CASE ( DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.TYPE );
      490    21423
      491    21424    5                 CASE ( %QI#TYPE_DISPLAY );
      492    21425    5                   DISP = DAD$ -> QI$FIELD_DAD.PSEUDO_CIP.NUMERIC.LEN;
      493    21426
      494    21427    5                   GOTO NEXT_BOX_CONTINUE;
      495    21428
      496    21429    5                 CASE ( %QI#TYPE_ALPHANUMERIC );
      497    21430    5                   DISP = DAD$ -> QI$FIELD_DAD.PSEUDO_CIP.ALPHANUMERIC.LEN;
      498    21431
      499    21432    5   NEXT_BOX_CONTINUE:
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:17   
      500    21433    5                   INX = DAD$ -> QI$FIELD_DAD.POSITION.COLUMN;
      501    21434
      502    21435    5                   DISP = DISP + INX;
      503    21436
      504    21437    5                   IF DISP > BOX_MAX_COLUMN
      505    21438    5                   THEN
      506    21439    5                     BOX_MAX_COLUMN = DISP;
      507    21440
      508    21441    5                   IF INX < BOX_MIN_COLUMN
      509    21442    5                   THEN
      510    21443    5                     BOX_MIN_COLUMN = INX;
      511    21444
      512    21445    5                   DISP = DAD$ -> QI$FIELD_DAD.POSITION.LINE;
      513    21446
      514    21447    5                   IF DISP > BOX_MAX_ROW
      515    21448    5                   THEN
      516    21449    5                     BOX_MAX_ROW = DISP;
      517    21450
      518    21451    5                   IF DISP < BOX_MIN_ROW
      519    21452    5                   THEN
      520    21453    5                     BOX_MIN_ROW = DISP;
      521    21454
      522    21455    5                   GOTO BOX_STEP_ACROSS_COUNT;
      523    21456
      524    21457    5                 CASE ( %QI#TYPE_MINOR );
      525    21458
      526    21459    5                 CASE ( ELSE );
      527    21460    5                   CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );
      528    21461
      529    21462    5               END;
      530    21463
      531    21464    4   BOX_STEP_DOWN_COUNT:
      532    21465    4               IF DAD$ -> QI$MAJOR_NODE.SON@P > 0
      533    21466    4               THEN
      534    21467    5                 DO;
      535    21468
      536    21469                        %PROC_ADDRESS ( THING@P = "DAD$ -> QI$MAJOR_NODE.SON@P",
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:18   
      537    21470                        CHECK_FOR_INDIRECTION = NO,
      538    21471                        RESULT$ = DAD$ );
      539    21508
      540    21509    5                   GOTO NEXT_BOX;
      541    21510
      542    21511    5                 END;
      543    21512    4               ELSE
      544    21513    5                 DO;
      545    21514
      546    21515    5   BOX_STEP_ACROSS_COUNT:
      547    21516    5                   IF DAD$ -> QI$MAJOR_NODE.BROTHER@P > 0
      548    21517    5                   THEN
      549    21518    6                     DO;
      550    21519
      551    21520                            %PROC_ADDRESS ( THING@P = "DAD$ -> QI$MAJOR_NODE.BROTHER@P",
      552    21521                            CHECK_FOR_INDIRECTION = NO,
      553    21522                            RESULT$ = DAD$ );
      554    21559
      555    21560    6                       GOTO NEXT_BOX;
      556    21561
      557    21562    6                     END;
      558    21563    5                   ELSE
      559    21564    6                     DO;
      560    21565
      561    21566                            %PROC_ADDRESS ( THING@P = "DAD$ -> QI$MAJOR_NODE.FATHER@P",
      562    21567                            CHECK_FOR_INDIRECTION = NO,
      563    21568                            RESULT$ = DAD$ );
      564    21605
      565    21606    6                       IF DAD$ ~= QI_1.CURRENT.NODE$
      566    21607    6                       THEN
      567    21608    6                         GOTO BOX_STEP_ACROSS_COUNT;
      568    21609
      569    21610    6                     END; /* IF DAD$ -> QI$MAJOR_NODE.BROTHER@P > 0 */
      570    21611
      571    21612    5                 END; /* IF DAD$ -> QI$MAJOR_NODE.SON@P > 0 */
      572    21613
      573    21614    4               IF DAD$ -> QI$MINOR_NODE.SEPARATED > 0
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:19   
      574    21615    4               THEN
      575    21616        /* HAVE SEPARATED CLAUSE                         */
      576    21617    4                 INX = DAD$ -> QI$MINOR_NODE.SEPARATED;
      577    21618    4               ELSE
      578    21619    4                 INX = 1;
      579    21620
      580    21621    4               IF QI_1.CURRENT.NODE_STATUS$ -> QI$MINOR_STATUS.GZ.FIELD_START_INDEX = 0
      581    21622    4               THEN
      582    21623        /* SET ROW INCREMENT                             */
      583    21624    4                 QI_1.CURRENT.NODE_STATUS$ -> QI$MINOR_STATUS.GZ.FIELD_START_INDEX =
      584    21625    4                   INX
      585    21626    4                   + BOX_MAX_ROW - BOX_MIN_ROW;
      586    21627    4               ELSE
      587    21628        /* SET COLUMN INCREMENT                          */
      588    21629    4                 QI_1.CURRENT.NODE_STATUS$ -> QI$MINOR_STATUS.GZ.FIELD_STOP_INDEX =
      589    21630    4                   INX
      590    21631    4                   + BOX_MAX_COLUMN - BOX_MIN_COLUMN;
      591    21632
      592    21633    4             END; /* IF DAD$ -> QI$MINOR_NODE.REPEATS > 0 */
      593    21634
      594    21635    3         CASE ( %QI#TYPE_MAJOR, %QI#TYPE_FRAME );
      595    21636
      596    21637    3         CASE ( ELSE );
      597    21638    3           CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );
      598    21639
      599    21640    3       END;
      600    21641
      601    21642    2   CHECK_STEP_DOWN_COUNT:
      602    21643    2       IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.SON@P > 0
      603    21644    2       THEN
      604    21645    3         DO;
      605    21646
      606    21647    3           CURRENT_FATHER$ = QI_1.CURRENT.NODE$;
      607    21648
      608    21649                %PROC_ADDRESS ( THING@P = "QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.SON@P",
      609    21650                CHECK_FOR_INDIRECTION = NO,
      610    21651                RESULT$ = DAD$ );
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:20   
      611    21688
      612    21689    3           GOTO NEXT_COUNT;
      613    21690
      614    21691    3         END;
      615    21692    2       ELSE
      616    21693    3         DO;
      617    21694
      618    21695    3   CHECK_STEP_ACROSS_COUNT:
      619    21696    3           IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.BROTHER@P > 0
      620    21697    3           THEN
      621    21698    4             DO;
      622    21699
      623    21700                    %PROC_ADDRESS ( THING@P =
             21700                        "QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.BROTHER@P",
      624    21701                    CHECK_FOR_INDIRECTION = NO,
      625    21702                    RESULT$ = DAD$ );
      626    21739
      627    21740    4               GOTO NEXT_COUNT;
      628    21741
      629    21742    4             END;
      630    21743    3           ELSE
      631    21744    4             DO;
      632    21745
      633    21746    4               IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.FATHER@P > 0
      634    21747    4                 AND QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.WORD0_FLAGS.TYPE ~= %
             21747                          QI#TYPE_FRAME
      635    21748    4               THEN
      636    21749    5                 DO;
      637    21750
      638    21751                        %PROC_ADDRESS ( THING@P =
             21751                            "QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.FATHER@P",
      639    21752                        CHECK_FOR_INDIRECTION = NO,
      640    21753                        RESULT$ = "QI_1.CURRENT.NODE$" );
      641    21790
      642    21791    5                   IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.FATHER@P > 0
      643    21792    5                     AND QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.WORD0_FLAGS.TYPE ~= %
             21792                              QI#TYPE_FRAME
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:21   
      644    21793    5                   THEN
      645    21794    6                     DO;
      646    21795        /* GET FATHER                                    */
      647    21796                            %PROC_ADDRESS ( THING@P =
             21796                                "QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.FATHER@P",
      648    21797                            CHECK_FOR_INDIRECTION = NO,
      649    21798                            RESULT$ = CURRENT_FATHER$ );
      650    21835
      651    21836    6                     END; /* IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.FATHER@P > 0 */
      652    21837
      653    21838    5                   GOTO CHECK_STEP_ACROSS_COUNT;
      654    21839
      655    21840    5                 END; /* IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.FATHER@P > 0 */
      656    21841
      657    21842    4             END; /* IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.BROTHER@P > 0 */
      658    21843
      659    21844    3         END; /* IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.SON@P > 0 */
      660    21845
      661    21846        %EJECT;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:22   
      662    21847    2       MAX_FIELD_SIZE = MAX_FIELD_SIZE + 1;
      663    21848
      664    21849    2       IF QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.HEADER$ = ADDR (NIL)
      665    21850    2       THEN
      666    21851    2   MAKE_ROOM_FOR_THIS_FRAME:
      667    21852    3         DO;
      668    21853
      669    21854    3           TOTAL_GZ_NEEDED = SIZEW (QI$GZ_HEADER)
      670    21855    3             + ( FIELD_COUNT * SIZEW (QI$GZ_FIELD) );
      671    21856
      672    21857    3           TOTAL_GZ_SPACE = ( QI_VLP_SEGMENT.PAGES * 256 )
      673    21858    3             - ( POFFW ( QI_1.GZ.AVAILABLE$, QI_VLP_SEGMENT.BASE$ ) );
      674    21859
      675    21860    3           IF TOTAL_GZ_NEEDED > TOTAL_GZ_SPACE
      676    21861    3           THEN
      677    21862    3   GDS_SOME_MEMORY:
      678    21863    4             DO;
      679    21864
      680    21865    4               FPT@GDS = QI_FPT_GDS;
      681    21866    4               VBASE ( FPT@GDS.V_ ) = ADDR ( FPT@GDS.V );
      682    21867    4               FPT@GDS.V.PAGES = ( ( TOTAL_GZ_NEEDED - TOTAL_GZ_SPACE ) / 256 ) + 1;
      683    21868
      684    21869    4               CALL M$GDS ( FPT@GDS )
      685    21870    4               WHENALTRETURN
      686    21871    5                 DO;
      687    21872    5                   CALL QCE$ERROR ( %E$INSUFFICIENT_MEMORY );
      688    21873    5                 END;
      689    21874
      690    21875    4             END GDS_SOME_MEMORY;
      691    21876
      692    21877    3           GZ_HEADER$ = QI_1.GZ.AVAILABLE$;
      693    21878    3           QI_1.GZ.AVAILABLE$ = PINCRW ( QI_1.GZ.AVAILABLE$, TOTAL_GZ_NEEDED );
      694    21879
      695    21880        /* BUILD HEADER PART                             */
      696    21881    3           GZ_HEADER$ -> QI$GZ_HEADER = '0'B;
      697    21882
      698    21883    3           GZ_HEADER$ -> QI$GZ_HEADER.IS_ACTIVE = %YES;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:23   
      699    21884    3           GZ_HEADER$ -> QI$GZ_HEADER.DCB# = QI_1.CURRENT.FORM$ -> QI$FORM_FILE.DCB#;
      700    21885    3           GZ_HEADER$ -> QI$GZ_HEADER.FIELD_COUNT = FIELD_COUNT;
      701    21886    3           GZ_HEADER$ -> QI$GZ_HEADER.FRAME_DAD$ = QI_1.CURRENT.FRAME$;
      702    21887    3           GZ_HEADER$ -> QI$GZ_HEADER.BACK_LINK$ = QI_1.GZ.LAST_HEADER$;
      703    21888    3           QI_1.GZ.LAST_HEADER$ = GZ_HEADER$;
      704    21889
      705    21890    3         END MAKE_ROOM_FOR_THIS_FRAME;
      706    21891    2       ELSE
      707    21892    2   THERES_ALREADY_SOME_ROOM:
      708    21893    3         DO;
      709    21894
      710    21895    3           GZ_HEADER$ = QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.HEADER$;
      711    21896
      712    21897        /* Use the old header                            */
      713    21898    3           GZ_HEADER$ -> QI$GZ_HEADER.IS_ACTIVE = %YES;
      714    21899
      715    21900    3         END THERES_ALREADY_SOME_ROOM;
      716    21901
      717    21902        /* BUILD QI$GZ_FIELD ENTRIES                   */
      718    21903    2       GZ_FIELD$ = PINCRW ( GZ_HEADER$, SIZEW (QI$GZ_HEADER) );
      719    21904
      720    21905    2       NEXT_INDEX = 0;
      721    21906
      722    21907    2       ROW_REPEATS$ = ADDR (NIL);
      723    21908    2       ROW_INDEX_STOP = 0;
      724    21909
      725    21910        /* SET UP NEXT ROW VALUE AND NEXT COLUMN VALUE   */
      726    21911    2       FRAME_ROW = QI_1.CURRENT.FRAME$ -> QI$FRAME.LINE_ORIGIN - 1;
      727    21912    2       FRAME_COLUMN = QI_1.CURRENT.FRAME$ -> QI$FRAME.COLUMN_ORIGIN - 1;
      728    21913
      729    21914    2       QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.HEADER$ = GZ_HEADER$;
      730    21915    2       QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.START$ = GZ_FIELD$;
      731    21916    2       QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.STOP$ =
      732    21917    2         PINCRW ( GZ_FIELD$, ( FIELD_COUNT - 1 ) * SIZEW (QI$GZ_FIELD) );
      733    21918    2       QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.FIELD_START_INDEX = NEXT_INDEX;
      734    21919    2       IF NOT QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.CURRENT.USAGE.ACTIVATED
      735    21920    2       THEN
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:24   
      736    21921    2         QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.FLDID_START
      737    21922            /*  = QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.GZ.NEXT_AVAILABLE_FLDID;  */
      738    21923    2           = QI_1.GZ.NEXT_AVAILABLE_FLDID;
      739    21924    2       QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.FORM_BACK_LINK@P =
      740    21925    2         POFFW ( QI_1.CURRENT.FORM$, QI_1.BASE.PROC$ );
      741    21926
      742    21927            %PROC_ADDRESS ( THING@P = "QI_1.CURRENT.FRAME$ -> QI$FRAME.SON@P",
      743    21928            CHECK_FOR_INDIRECTION = NO,
      744    21929            RESULT$ = DAD$ );
      745    21966
      746    21967    2   NEXT_BUILD:
      747    21968    2       QI_1.CURRENT.NODE$ = DAD$;
      748    21969
      749    21970            %DATA_ADDRESS ( THING@D = "DAD$ -> QI$MAJOR_NODE.STATUS_AREA@D",
      750    21971            CHECK_FOR_INDIRECTION = NO,
      751    21972            RESULT$ = "QI_1.CURRENT.NODE_STATUS$" );
      752    22009
      753    22010    2       ROW_INCREMENT = QI_1.CURRENT.NODE_STATUS$ -> QI$FIELD_STATUS.GZ.
             22010                FIELD_START_INDEX;
      754    22011    2       COLUMN_INCREMENT = QI_1.CURRENT.NODE_STATUS$ -> QI$FIELD_STATUS.GZ.
             22011                FIELD_STOP_INDEX;
      755    22012
      756    22013        /* GET ELEMENT COUNT                             */
      757    22014    2       QI_1.CURRENT.NODE_STATUS$ -> QI$MAJOR_STATUS.GZ.FIELD_START_INDEX = NEXT_INDEX;
      758    22015
      759    22016    3       DO CASE ( DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.TYPE );
      760    22017
      761    22018    3         CASE ( %QI#TYPE_DISPLAY );
      762    22019    3           FIELD_BYTE_SIZE = DAD$ -> QI$FIELD_DAD.PSEUDO_CIP.NUMERIC.LEN;
      763    22020
      764    22021    3           GOTO BUILD_CONTINUE;
      765    22022
      766    22023    3         CASE ( %QI#TYPE_ALPHANUMERIC );
      767    22024    3           FIELD_BYTE_SIZE = DAD$ -> QI$FIELD_DAD.PSEUDO_CIP.ALPHANUMERIC.LEN;
      768    22025
      769    22026    3   BUILD_CONTINUE:
      770    22027    3           IF DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT > 0
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:25   
      771    22028    3           THEN
      772    22029    4             DO;
      773    22030
      774    22031    4               FIELD_DIM_CNT = DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT;
      775    22032
      776    22033        /* HAVE DIMENSIONS                               */
      777    22034    4               INX = DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT;
      778    22035
      779    22036                    /*  Increment past any level_multipliers to get to the
      780    22037                        P.whatever flags.  */
      781    22038    4               FIELD_DAD_P$ = ADDR ( DAD$ -> QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS.
             22038                        LEVEL_MULTIPLIER_A ( INX ) );
      782    22039
      783    22040    4               IF FIELD_DAD_P$ -> QI$FIELD_DAD_P.P.REPEATS
      784    22041    4               THEN
      785    22042    5                 DO;
      786    22043
      787    22044    5                   INX = INX - 1;
      788    22045    5                   INX_A$ (INX) = ADDR (COLUMN_INDEX);
      789    22046
      790    22047                        %PRESENCE_DISPLACEMENT (
      791    22048                        PRESENCE_THING$ = FIELD_DAD_P$,
      792    22049                        INDEX = P_ITEM_INDEX,
      793    22050                        START = %QI#P_FIELD_FIRST_INDEX,
      794    22051                        STOP = %QI#P_REPEATS_INDEX,
      795    22052                        RESULT = REPEATS_INDEX
      796    22053                        );
      797    22085
      798    22086    5                   COLUMN_INDEX_STOP = FIELD_DAD_P$ -> QI$FIELD_DAD_P.P_ITEM_A (
             22086                            REPEATS_INDEX ) - 1;
      799    22087
      800    22088    5                 END;
      801    22089    4               ELSE
      802    22090    5                 DO;
      803    22091
      804    22092    5                   IF FIELD_DIM_CNT = 2
      805    22093    5                   THEN
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:26   
      806    22094    6                     DO;
      807    22095    6                       COLUMN_INDEX_STOP = COLUMN_STOP_GROUP;
      808    22096
      809    22097    6                       INX_A$ (1) = ADDR (COLUMN_INDEX);
      810    22098    6                     END;
      811    22099    5                   ELSE
      812    22100    5                     COLUMN_INDEX_STOP = 0;
      813    22101
      814    22102    5                 END; /* IF FIELD_DAD_P$ -> QI$FIELD_DAD_P.P.REPEATS */
      815    22103
      816    22104    4             END;
      817    22105    3           ELSE
      818    22106    4             DO;
      819    22107    4               FIELD_DIM_CNT = 0;
      820    22108
      821    22109    4   SET_NO_REPEATS:
      822    22110    4               COLUMN_INDEX_STOP = 0;
      823    22111    4             END; /* IF DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT > 0 */
      824    22112
      825    22113    3           IF DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.IS_CONSTANT
      826    22114    3           THEN
      827    22115                  %PROC_ADDRESS ( THING@P = "DAD$ -> QI$FIELD_DAD.PSEUDO_CIP.DATA@",
      828    22116                    CHECK_FOR_INDIRECTION = NO,
      829    22117                    RESULT$ = INIT_DATA$ );
      830    22154    3           ELSE
      831    22155                  %DATA_ADDRESS ( THING@D = "DAD$ -> QI$FIELD_DAD.PSEUDO_CIP.DATA@",
      832    22156                    CHECK_FOR_INDIRECTION = NO,
      833    22157                    RESULT$ = INIT_DATA$ );
      834    22194
      835    22195    3           INIT_FIELD_OFFSET = DAD$ -> QI$FIELD_DAD.PSEUDO_CIP.NUMERIC.CD.OFFSET;
      836    22196
      837    22197    3           FIELD_ROW = FRAME_ROW + DAD$ -> QI$FIELD_DAD.POSITION.LINE;
      838    22198    3           INIT_FIELD_COLUMN = FRAME_COLUMN + DAD$ -> QI$FIELD_DAD.POSITION.COLUMN;
      839    22199
      840    22200    4           DO ROW_INDEX = 0 TO ROW_INDEX_STOP;
      841    22201
      842    22202    4             FIELD_COLUMN = INIT_FIELD_COLUMN;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:27   
      843    22203
      844    22204    5             DO COLUMN_INDEX = 0 TO COLUMN_INDEX_STOP;
      845    22205
      846    22206    5               GZ_FIELD$ -> QI$GZ_FIELD = '0'B;
      847    22207
      848    22208    5               GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.POSITION.LINE = FIELD_ROW;
      849    22209    5               GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.POSITION.COLUMN = FIELD_COLUMN;
      850    22210
      851    22211    5               FIELD_COLUMN = FIELD_COLUMN + COLUMN_INCREMENT;
      852    22212
      853    22213        /* SET IO/CONSTANT FLAGS                         */
      854    22214    5               GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.IO_FLAGS.IS_OUTPUT = DAD$ ->
             22214                        QI$FIELD_DAD.WORD0_FLAGS.IO_FLAGS.IS_OUTPUT;
      855    22215    5               GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.IO_FLAGS.IS_INPUT = DAD$ ->
             22215                        QI$FIELD_DAD.WORD0_FLAGS.IO_FLAGS.IS_INPUT;
      856    22216    5               GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.IS_ENTRY_REQUIRED = DAD$ ->
             22216                        QI$FIELD_DAD.WORD0_FLAGS.IS_ENTRY_REQUIRED;
      857    22217    5               GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.IS_OUTPUT_CONSTANT = DAD$ ->
             22217                        QI$FIELD_DAD.WORD0_FLAGS.IS_OUTPUT_CONSTANT;
      858    22218    5               GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.IS_AOIM = DAD$ -> QI$FIELD_DAD.
             22218                        WORD0_FLAGS.IS_AOIM;
      859    22219
      860    22220                    %IF QI#DEBUG;
      861    22221
      862    22222    5               IF DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.IO_FLAGS.IS_OUTPUT
      863    22223    5               THEN
      864    22224    6                 DO;
      865    22225    6                   IF DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.IS_ENTRY_REQUIRED
      866    22226    6                     AND NOT DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.IO_FLAGS.IS_INPUT
      867    22227    6                   THEN
      868    22228        /* ENTRY REQUIRED ON OUTPUT ONLY FIELD       */
      869    22229    6                     CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );
      870    22230    6                 END;
      871    22231    5               ELSE
      872    22232    6                 DO;
      873    22233    6                   IF DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.IO_FLAGS.IS_INPUT
      874    22234    6                   THEN
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:28   
      875    22235    7                     DO;
      876    22236    7                       IF DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.IS_CONSTANT
      877    22237    7                       THEN
      878    22238        /* CONSTANT INPUT FIELD                      */
      879    22239    7                         CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );
      880    22240    7                     END;
      881    22241    6                   ELSE
      882    22242        /* FIELD IS NOT INPUT OR OUTPUT              */
      883    22243    6                     CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );
      884    22244    6                 END;
      885    22245
      886    22246                    %ENDIF;
      887    22247
      888    22248    5               INDICATORS$ = PINCRW ( ADDR ( QI_1.CURRENT.NODE_STATUS$ ->
             22248                        QI$FIELD_STATUS.INDICATORS_A (0) ),
      889    22249    5                 ROW_INDEX * ( COLUMN_INDEX_STOP + 1 )
      890    22250    5                 + COLUMN_INDEX );
      891    22251    5               GZ_FIELD$ -> QI$GZ_FIELD.INDICATORS$ = INDICATORS$;
      892    22252
      893    22253    5               INDICATORS$ -> QI$INDICATORS.IS_ACTIVE = %YES;
      894    22254    5               INDICATORS$ -> QI$INDICATORS.STATE_VALUE = %QI#STATE_NULL;
      895    22255
      896    22256    5               IF QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.
             22256                        IS_OUTPUT
      897    22257    5                 AND GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.IO_FLAGS.IS_OUTPUT
      898    22258    5               THEN
      899    22259    5                 INDICATORS$ -> QI$INDICATORS.ENABLED_FLAGS.IS_OUTPUT = %YES;
      900    22260
      901    22261    5               IF QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.
             22261                        IS_INPUT
      902    22262    5                 AND GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.IO_FLAGS.IS_INPUT
      903    22263    5               THEN
      904    22264    5                 INDICATORS$ -> QI$INDICATORS.ENABLED_FLAGS.IS_INPUT = ITS_AN_ACTIVATE;
      905    22265
      906    22266    5               IF QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.
             22266                        IS_OUTPUT
      907    22267    5                 AND GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.IO_FLAGS.IS_OUTPUT
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:29   
      908    22268    5                 AND GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.IS_OUTPUT_CONSTANT
      909    22269    5               THEN
      910    22270    5                 INDICATORS$ -> QI$INDICATORS.STATE_VALUE = %QI#STATE_AVAIL_OUTPUT;
      911    22271
      912    22272        /* Set up VISUAL-ATTRIBUTEs                      */
      913    22273    5               GZ_FIELD$ -> QI$GZ_FIELD.STATUS.VISUAL_ATTRIBUTE = DAD$ -> QI$FIELD_DAD.
             22273                        VISUAL_ATTRIBUTE;
      914    22274
      915    22275        /* SET UP ADDRESSING VARIABLES                   */
      916    22276    5               GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.LENGTH = FIELD_BYTE_SIZE;
      917    22277
      918    22278    5               DISP = INIT_FIELD_OFFSET;
      919    22279
      920    22280    5               IF FIELD_DIM_CNT > 0
      921    22281    5               THEN
      922    22282    6                 DO;
      923    22283
      924    22284    7                   DO INX = 0 TO FIELD_DIM_CNT - 1;
      925    22285
      926    22286    7                     DISP = DISP
      927    22287    7                       + ( DAD$ -> QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS.
             22287                                LEVEL_MULTIPLIER_A.ELEMENT_LENGTH (INX)
      928    22288    7                       * INX_A$ (INX) -> QI$UWORD_A (0) );
      929    22289
      930    22290    7                   END;
      931    22291
      932    22292    6                 END;
      933    22293
      934    22294    5               GZ_FIELD$ -> QI$GZ_FIELD.STATUS.OFFSET = MOD ( DISP, 2 );
      935    22295    5               GZ_FIELD$ -> QI$GZ_FIELD.STATUS.DATA$ = PINCRW ( INIT_DATA$, DISP / 2 );
      936    22296
      937    22297    5               GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.FIELD_DAD$ = DAD$;
      938    22298
      939    22299    5               NEXT_INDEX = NEXT_INDEX + 1;
      940    22300    5               GZ_FIELD$ = PINCRW ( GZ_FIELD$, SIZEW (QI$GZ_FIELD) );
      941    22301
      942    22302    5             END; /* DO COLUMN_INDEX = ... */
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:30   
      943    22303
      944    22304    4             FIELD_ROW = FIELD_ROW + ROW_INCREMENT;
      945    22305
      946    22306    4           END; /* DO ROW_INDEX = ... */
      947    22307
      948    22308    3           GOTO CHECK_STEP_ACROSS_BUILD;
      949    22309
      950    22310    3         CASE ( %QI#TYPE_MINOR );
      951    22311    3           IF DAD$ -> QI$MINOR_NODE.REPEATS > 0
      952    22312    3           THEN
      953    22313    4             DO;
      954    22314
      955    22315    4               IF ROW_REPEATS$ = ADDR(NIL)
      956    22316    4               THEN
      957    22317    5                 DO;
      958    22318    5                   INX_A$ (0) = ADDR (ROW_INDEX);
      959    22319
      960    22320    5                   ROW_INDEX_STOP = DAD$ -> QI$MINOR_NODE.REPEATS - 1;
      961    22321
      962    22322    5                   ROW_REPEATS$ = DAD$;
      963    22323    5                 END;
      964    22324    4               ELSE
      965    22325    4                 COLUMN_STOP_GROUP = DAD$ -> QI$MINOR_NODE.REPEATS - 1;
      966    22326
      967    22327    4             END; /* IF DAD$ -> QI$MINOR_NODE.REPEATS > 0 */
      968    22328
      969    22329    3         CASE ( %QI#TYPE_MAJOR, %QI#TYPE_FRAME );
      970    22330
      971    22331    3         CASE ( ELSE );
      972    22332    3           CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );
      973    22333
      974    22334    3       END;
      975    22335
      976    22336    2   CHECK_STEP_DOWN_BUILD:
      977    22337    2       IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.SON@P > 0
      978    22338    2       THEN
      979    22339    3         DO;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:31   
      980    22340
      981    22341                %PROC_ADDRESS ( THING@P = "QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.SON@P",
      982    22342                CHECK_FOR_INDIRECTION = NO,
      983    22343                RESULT$ = DAD$ );
      984    22380
      985    22381    3           GOTO NEXT_BUILD;
      986    22382
      987    22383    3         END;
      988    22384    2       ELSE
      989    22385    3         DO;
      990    22386
      991    22387    3   CHECK_STEP_ACROSS_BUILD:
      992    22388    3           QI_1.CURRENT.NODE_STATUS$ -> QI$MAJOR_STATUS.GZ.FIELD_STOP_INDEX =
             22388                    NEXT_INDEX - 1;
      993    22389
      994    22390    3           IF QI_1.CURRENT.NODE$ = ROW_REPEATS$
      995    22391    3           THEN
      996    22392    4             DO;
      997    22393        /* RESET ROW/LINE VARIABLES                      */
      998    22394    4               ROW_REPEATS$ = ADDR (NIL);
      999    22395    4               ROW_INDEX_STOP = 0;
     1000    22396
     1001    22397    4             END;
     1002    22398
     1003    22399    3           IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.BROTHER@P > 0
     1004    22400    3           THEN
     1005    22401    4             DO;
     1006    22402
     1007    22403                    %PROC_ADDRESS ( THING@P =
             22403                        "QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.BROTHER@P",
     1008    22404                    CHECK_FOR_INDIRECTION = NO,
     1009    22405                    RESULT$ = DAD$ );
     1010    22442
     1011    22443    4               GOTO NEXT_BUILD;
     1012    22444
     1013    22445    4             END;
     1014    22446    3           ELSE
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:32   
     1015    22447    4             DO;
     1016    22448
     1017    22449    4               IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.FATHER@P > 0
     1018    22450    4                 AND QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.WORD0_FLAGS.TYPE ~= %
             22450                          QI#TYPE_FRAME
     1019    22451    4               THEN
     1020    22452    5                 DO;
     1021    22453
     1022    22454                        %PROC_ADDRESS ( THING@P =
             22454                            "QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.FATHER@P",
     1023    22455                        CHECK_FOR_INDIRECTION = NO,
     1024    22456                        RESULT$ = "QI_1.CURRENT.NODE$" );
     1025    22493
     1026    22494                        %DATA_ADDRESS ( THING@D =
             22494                            "QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.STATUS_AREA@D",
     1027    22495                        CHECK_FOR_INDIRECTION = NO,
     1028    22496                        RESULT$ = "QI_1.CURRENT.NODE_STATUS$" );
     1029    22533
     1030    22534    5                   GOTO CHECK_STEP_ACROSS_BUILD;
     1031    22535
     1032    22536    5                 END; /* IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.FATHER@P > 0 */
     1033    22537
     1034    22538    4             END; /* IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.BROTHER@P > 0 */
     1035    22539
     1036    22540    3         END; /* IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.SON@P > 0 */
     1037    22541
     1038    22542    2       QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.FIELD_STOP_INDEX = NEXT_INDEX -
             22542                1;
     1039    22543
     1040    22544            %IF QI#DEBUG;
     1041    22545
     1042    22546    2       IF NEXT_INDEX ~= FIELD_COUNT
     1043    22547    2       THEN
     1044    22548    2         CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );
     1045    22549
     1046    22550    2       IF PINCRW ( GZ_FIELD$, - SIZEW (QI$GZ_FIELD) ) ~=
     1047    22551    2         QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.STOP$
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:33   
     1048    22552    2       THEN
     1049    22553    2         CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );
     1050    22554
     1051    22555            %ENDIF;
     1052    22556
     1053    22557    2       FPT@DCLFLD = QI_FPT_DCLFLD;
     1054    22558    2       VBASE ( FPT@DCLFLD.V_ ) = ADDR ( FPT@DCLFLD.V );
     1055    22559    2       FPT@DCLFLD.V.DCB# = QI_1.CURRENT.FORM$ -> QI$FORM_FILE.DCB#;
     1056    22560    2       FPT@DCLFLD.FLDATR_ = VECTOR ( VLP@FLDATR );
     1057    22561    2       VLP@FLDATR = QI_VLP_FLDATR;
     1058    22562
     1059    22563    2       GZ_FIELD$ = PINCRW ( GZ_HEADER$, SIZEW (QI$GZ_HEADER) );
     1060    22564
     1061    22565    2   DCL_THE_FIELDS:
     1062    22566    3       DO FIELD_INDEX = 0 TO GZ_HEADER$ -> QI$GZ_HEADER.FIELD_COUNT - 1;
     1063    22567
     1064    22568    3   RE_DCL_A_FIELD:
     1065    22569    3         GZ_FIELD$ -> QI$GZ_FIELD.STATUS.FLDID =
     1066    22570    3           QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.FLDID_START
     1067    22571    3           + FIELD_INDEX;
     1068    22572    3         FPT@DCLFLD.V.ID = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.FLDID;
     1069    22573    3         FPT@DCLFLD.V.LIN = GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.POSITION.LINE;
     1070    22574    3         FPT@DCLFLD.V.CLM = GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.POSITION.COLUMN;
     1071    22575    3         FPT@DCLFLD.V.WDT = GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.LENGTH;
     1072    22576    3         VLP@FLDATR.QLF.CNS = GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.IS_OUTPUT_CONSTANT;
     1073    22577    3         VLP@FLDATR.QLF.MSTENT = GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.IS_ENTRY_REQUIRED
             22577                  ;
     1074    22578    3         VLP@FLDATR.ABSGRPRND = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.VISUAL_ATTRIBUTE;
     1075    22579
     1076    22580    3         IF FPT@DCLFLD.V.DVBYTE.RRR
     1077    22581    3         THEN
     1078    22582    3   RE_DCL_AN_OVERLAPPING_FIELD:
     1079    22583    4           DO;
     1080    22584    4             CALL M$DCLFLD ( FPT@DCLFLD )
     1081    22585    4             WHENALTRETURN
     1082    22586    5               DO;
     1083    22587
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:34   
     1084    22588                      %PROC_ADDRESS ( THING@P =
             22588              "GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.FIELD_DAD$ -> QI$FIELD_DAD.IDENTIFIER@P"
             22588                          ,
     1085    22589                      CHECK_FOR_INDIRECTION = NO,
     1086    22590                      RESULT$ = FIELD_IDENTIFIER$ );
     1087    22627
     1088    22628    6                 DO CASE ( QGB_PARAM.ERR.ERR# );
     1089    22629
     1090    22630    6                   CASE ( %E$ILGFLDPST );
     1091    22631    6                     CALL QCE$ERROR ( %E$FIELD_SPACE_CADET,
     1092    22632    6                       FIELD_IDENTIFIER$ -> QI$VARIABLE_IDENTIFIER );
     1093    22633
     1094    22634    6                   CASE ( %E$OVRLAPFLD );
     1095    22635                        /*  Very interesting problem.
     1096    22636                            A field which overlaps another has been M$DCLFLDed to obtain
     1097    22637                            the FLDID of the OTHER field.  But that other field may be
     1098    22638                            in a different FRame and/or FD.
     1099    22639                            Sooo:  loop through all the OPEN FDs, looking for an
     1100    22640                            ACTIVATEd FRame whose FLDID range encloses the FLDID of the
     1101    22641                            overlapped field.  */
     1102    22642    6                     FORM_FILE$ = QI_1.FILE_HEAD.FORM$;
     1103    22643
     1104    22644    6   FIND_FORM_THATS_OVERLAPPED:
     1105    22645    7                     DO WHILE ( FORM_FILE$ ~= ADDR (NIL) );
     1106    22646
     1107    22647    7   FIND_FRAME_THATS_OVERLAPPED:
     1108    22648    7                       DO FRAME_INDEX =
     1109    22649    8                         0 TO FORM_FILE$ -> QI$FORM_FILE.FRAME_COUNT - 1;
     1110    22650
     1111    22651                              %PROC_ADDRESS ( THING@P =
             22651                                 "FORM_FILE$ -> QI$FORM_FILE.FRAME_LIST_A@P ( FRAME_INDEX )"
             22651                                  ,
     1112    22652                              CHECK_FOR_INDIRECTION = NO,
     1113    22653                              RESULT$ = FRAME$ );
     1114    22690
     1115    22691                              %DATA_ADDRESS ( THING@D = "FRAME$ -> QI$FRAME.STATUS_AREA@D",
     1116    22692                              CHECK_FOR_INDIRECTION = NO,
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:35   
     1117    22693                              RESULT$ = FRAME_STATUS$ );
     1118    22730
     1119    22731    8                         IF FRAME_STATUS$ -> QI$FRAME_STATUS.INDICATORS.IS_ACTIVE
     1120    22732    8                           AND FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.FLDID_START <=
     1121    22733    8                           DCBADDR ( QI_1.CURRENT.FORM$ -> QI$FORM_FILE.DCB# ) -> M$DCB
             22733                                    .FLDID
     1122    22734    8                           AND FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.FLDID_STOP >=
     1123    22735    8                           DCBADDR ( QI_1.CURRENT.FORM$ -> QI$FORM_FILE.DCB# ) -> M$DCB
             22735                                    .FLDID
     1124    22736    8                         THEN
     1125    22737    8   FIND_FIELD_THATS_OVERLAPPED:
     1126    22738    9                           DO;
     1127    22739
     1128    22740    9                             FIELD_INDEX = DCBADDR ( QI_1.CURRENT.FORM$ -> QI$FORM_FILE
             22740                                      .DCB# ) -> M$DCB.FLDID
     1129    22741    9                               - FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.FLDID_START;
     1130    22742    9                             GZ_FIELD$ = PINCRW ( FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.
             22742                                      START$,
     1131    22743    9                               FIELD_INDEX * SIZEW (QI$GZ_FIELD) );
     1132    22744
     1133    22745                                  %PROC_ADDRESS ( THING@P =
             22745              "GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.FIELD_DAD$ -> QI$FIELD_DAD.IDENTIFIER@P"
             22745                                      ,
     1134    22746                                  CHECK_FOR_INDIRECTION = NO,
     1135    22747                                  RESULT$ = OVERLAPPING_FIELD_IDENTIFIER$ );
     1136    22784
     1137    22785    9                             CALL QCE$ERROR ( %E$FIELD_OVERLAPS,
     1138    22786    9                               FIELD_IDENTIFIER$ -> QI$VARIABLE_IDENTIFIER,
     1139    22787    9                               OVERLAPPING_FIELD_IDENTIFIER$ -> QI$VARIABLE_IDENTIFIER
             22787                                        );
     1140    22788    9                           END FIND_FIELD_THATS_OVERLAPPED;
     1141    22789
     1142    22790    8                       END FIND_FRAME_THATS_OVERLAPPED;
     1143    22791
     1144    22792                            %DATA_ADDRESS ( THING@D =
             22792                                "FORM_FILE$ -> QI$FORM_FILE.STATUS_AREA@D",
     1145    22793                            CHECK_FOR_INDIRECTION = NO,
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:36   
     1146    22794                            RESULT$ = FORM_STATUS$ );
     1147    22831
     1148    22832    7                       FORM_FILE$ = FORM_STATUS$ -> QI$FORM_STATUS.FLINK$;
     1149    22833
     1150    22834    7                     END FIND_FORM_THATS_OVERLAPPED;
     1151    22835
     1152    22836                        /*  If the "overlapped FRame" wasn't found, it must be the
     1153    22837                            current FRame (not yet IS_ACTIVE).  */
     1154    22838    6                     FRAME_STATUS$ = QI_1.CURRENT.FRAME_STATUS$;
     1155    22839    6                     GOTO FIND_FIELD_THATS_OVERLAPPED;
     1156    22840
     1157    22841    6                   CASE ( ELSE );
     1158    22842    6                     CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );
     1159    22843
     1160    22844    6                 END;
     1161    22845
     1162    22846    5               END;
     1163    22847
     1164    22848    4           END RE_DCL_AN_OVERLAPPING_FIELD;
     1165    22849    3         ELSE
     1166    22850    3   DCL_A_NORMAL_FIELD:
     1167    22851    4           DO;
     1168    22852    4             CALL QGB$DCLFLD ( FPT@DCLFLD, QGB_PARAM )
     1169    22853    4               ALTRET ( INITIAL_DCLFLD_ALTRET );
     1170    22854    4           END DCL_A_NORMAL_FIELD;
     1171    22855
     1172    22856    3         GZ_FIELD$ = PINCRW ( GZ_FIELD$, SIZEW (QI$GZ_FIELD) );
     1173    22857
     1174    22858    3       END DCL_THE_FIELDS;
     1175    22859
     1176    22860    2       CALL QGB$FLUSH ( , QGB_PARAM )
     1177    22861    2       WHENALTRETURN
     1178    22862    3         DO;
     1179    22863              /*  One of the QGB$DCLFLDs ALTRET'ed.
     1180    22864                  It's probably either an "overlapping" or an "off the screen"
     1181    22865                  error, so turn on RR, delete any fields already out there,
     1182    22866                  and try again.  */
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:37   
     1183    22867    3   INITIAL_DCLFLD_ALTRET:
     1184    22868    3           FPT@DCLFLD.V.DVBYTE.RRR = %YES;
     1185    22869    3           FIELD_INDEX = DCBADDR ( QI_1.CURRENT.FORM$ -> QI$FORM_FILE.DCB# ) -> M$DCB.
             22869                    FLDID
     1186    22870    3             - QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.FLDID_START;
     1187    22871    3           GZ_FIELD$ = PINCRW ( QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.START$
             22871                    ,
     1188    22872    3             FIELD_INDEX * SIZEW (QI$GZ_FIELD) );
     1189    22873
     1190    22874    3           GOTO RE_DCL_A_FIELD;
     1191    22875    3         END;
     1192    22876
     1193    22877    2       QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.FLDID_STOP =
     1194    22878    2         QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.FLDID_START
     1195    22879    2         + GZ_HEADER$ -> QI$GZ_HEADER.FIELD_COUNT
     1196    22880    2         - 1;
     1197    22881    2       IF NOT QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.CURRENT.USAGE.ACTIVATED
     1198    22882    2       THEN
     1199    22883          /*  QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.GZ.NEXT_AVAILABLE_FLDID =
     1200    22884                QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.GZ.NEXT_AVAILABLE_FLDID  */
     1201    22885    2         QI_1.GZ.NEXT_AVAILABLE_FLDID = QI_1.GZ.NEXT_AVAILABLE_FLDID
     1202    22886    2           + GZ_HEADER$ -> QI$GZ_HEADER.FIELD_COUNT;
     1203    22887
     1204    22888    2       QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.INDICATORS.IS_ACTIVE = %YES;
     1205    22889    2       QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.CURRENT.USAGE.ACTIVATED = %YES;
     1206    22890
     1207    22891    2       RETURN;
     1208    22892
     1209    22893    2   END ACTIVATE_FRAME;
     1210    22894
     1211    22895    1   END QBA$ACTIVATE;
     1212    22896        %EOD;

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:38   
--  Include file information  --

   QCU_USE_M.:E05TOU  is referenced.
   QI_MACROS_M.:E05TOU  is referenced.
   QI_PERR_C.:E05TOU  is referenced.
   QI_EQUATES_E.:E05TOU  is referenced.
   QG_MACRO_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QBA$ACTIVATE.

   Procedure QBA$ACTIVATE requires 2250 words for executable code.
   Procedure QBA$ACTIVATE requires 144 words of local(AUTO) storage.

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:39   

 Object Unit name= QBA$ACTIVATE                               File name= QBA$ACTIVATE.:E05TOU
 UTS= JUL 30 '97 04:41:07.68 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   Proc  even  none  2250    8CA  QBA$ACTIVATE
    1  RoData even  none    14      E  QBA$ACTIVATE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        0  QBA$ACTIVATE
     0      A                  yes      Std        0  QBA$DEACTIVATE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 QCF$FIND_CURRENTS
         yes           Std       4 QCE$ERROR_INTERNAL
 yes     yes           Std       0 QBA$DEACTIVATE_FRAME
 yes     yes           Std       0 QBA$DEACTIVATE_FORM
         yes           Std       1 QCU$USE_IO
         yes           Std       0 QCU$UPDATE_SCREEN
         yes           Std       4 QCE$ERROR_M$INTERNAL
         yes           Std       4 QCE$ERROR
 yes     yes           Std       2 QGB$DCLFLD
 yes     yes           Std       2 QGB$FLUSH
                       nStd      0 X6A_AUTO_0
                       nStd      0 X6A_ARET
                       nStd      0 X6D_MID
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:40   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     QI_1                                  QGB_PARAM                             QI_4_CHAR_ALPHANUMERIC
     QI_31_DIGIT_SLS_DISPLAY               QI_16_BIT_BINARY                      QI_32_BIT_BINARY
     QI_31_DIGIT_ST_PACKED                 QI_PICTURE_STRING                     QI_FPT_DCLFLD
     QI_VLP_FLDATR                         QI_FPT_GDS                            QI_VLP_SEGMENT
r    G$ROS$
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:41   


        1        1        /*M* QBA$ACTIVATE:  ACTIVATE some number of FRAMEs/FORMs.  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=0,DCI=4,CSI=2,IAD=2,DTI=2,AND,ECI=0,DIN=2,STI=2 */
        8        8
        9        9        /*P*  NAME:         QBA$ACTIVATE
       10       10              PURPOSE:      Activate fields within frames/forms.
       11       11              DESCRIPTION:  Execute an ACTIVATE op-code, whose argument
       12       12                            maybe a frame, a list of frames, a form,
       13       13                            a list of forms, or any combination of the
       14       14                            above.  All fields within the scope of all
       15       15                            of this op-code's argument(s) are to be
       16       16                            M$DCLFLDed.
       17       17        */
       18       18
       19       19        QBA$ACTIVATE: PROC;

     19   0 000000  D380 0000 0000  xent QBA$ACTIVATE    LNJ,B5   X6A_AUTO_0
          0 000003       0090 0000                       DC       144,0

       20       20
       21       21        /*D*  NAME:         QBA$ACTIVATE
       22       22              CALL:         CALL QBA$ACTIVATE;
       23       23              PARAMETERS:   None.
       24       24              INTERFACE:    Called by QAT$TALLYHO when an ACTIVATE op-code
       25       25                            is encountered.
       26       26              ENVIRONMENT:  Nothing unusual.
       27       27              INPUT:        QI_1,
       28       28                            FPL rununit static data following the op-code.
       29       29              OUTPUT:       Mostly affects dynamic memory by allocating
       30       30                            more for the fields to be activated.
       31       31              SCRATCH:      Various otter data.
       32       32              DESCRIPTION:  OK, here it is.
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:42   
       33       33                            Each active field within a running FPL program
       34       34                            has associated with it a QI$GZ_FIELD structure
       35       35                            (see corresponding MACRO in QI_MACROS_M).
       36       36                            This structure contains stuff pertinent to the
       37       37                            field's "disposition" at the current time.
       38       38                            In this way, operations which affect many
       39       39                            fields at once (such as screen-FD reads) can
       40       40                            be performed without traversing the (complicated)
       41       41                            compiler-generated field structures.  Such
       42       42                            operations simply interrogate any and all fields
       43       43                            within the scope of any and all QI$GZ_HEADERs
       44       44                            which fall under the jurisdiction of the
       45       45                            operand(s) of the operation.
       46       46                            At any rate, each field within whatever it is
       47       47                            we're activating must be represented by a
       48       48                            QI$GZ_FIELD structure in dynamic memory, and
       49       49                            must also be defined to VDH via M$DCLFLD.
       50       50        */
       51       51
       52       52          %INCLUDE B_ERRORS_C;
       53     1179          %INCLUDE LCP_6;
       54     1370          %FPT_DCLFLD ( FPTN = FPT@DCLFLD,
       55     1371                        STCLASS = AUTO );
       56     1409          %VLP_FLDATR ( FPTN = VLP@FLDATR,
       57     1410                        STCLASS = AUTO );
       58     1436          %FPT_GDS ( FPTN = FPT@GDS,
       59     1437                     STCLASS = AUTO );
       60     1461          %FPT_RLSFLD ( FPTN = FPT@RLSFLD,
       61     1462                        STCLASS = AUTO );
       62     1494          %FPT_SLCFLD ( FPTN = FPT@SLCFLD,
       63     1495                        STCLASS = AUTO );
       64     1527          %M$DCB ( DCBN = M$DCB,
       65     1528                   STCLASS = BASED );
       66     1579          %INCLUDE QG_MACRO_M;
       67     1716          %QGB_ENTRIES;
       68     1729          %INCLUDE QI_EQUATES_E;
       69     2088          %INCLUDE QI_PERR_C;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:43   
       70     2256          %INCLUDE QI_MACROS_M;
       71     7314          %QI$ALL;
       72    18427          %QI_FPTS;
       73    20472
       74    20473    1     DCL BOX_MAX_COLUMN UBIN;
       75    20474    1     DCL BOX_MAX_ROW UBIN;
       76    20475    1     DCL BOX_MIN_COLUMN UBIN;
       77    20476    1     DCL BOX_MIN_ROW UBIN;
       78    20477    1     DCL COLUMN_INCREMENT UBIN;
       79    20478    1     DCL COLUMN_INDEX UBIN;
       80    20479    1     DCL COLUMN_INDEX_STOP UBIN;
       81    20480    1     DCL COLUMN_STOP_GROUP UBIN;
       82    20481    1     DCL CURRENT_FATHER$ PTR;
       83    20482    1     DCL CURRENT_FATHER_STATUS$ PTR;
       84    20483    1     DCL DAD$ PTR;
       85    20484    1     DCL DISP UBIN;
       86    20485    1     DCL ELEM_COUNT UBIN;
       87    20486    1     DCL FIELD_BYTE_SIZE UBIN;
       88    20487    1     DCL FIELD_COLUMN UBIN;
       89    20488    1     DCL FIELD_COUNT UBIN;
       90    20489    1     DCL FIELD_DAD_P$ PTR;
       91    20490    1     DCL FIELD_DIM_CNT UBIN;
       92    20491    1     DCL FIELD_IDENTIFIER$ PTR;
       93    20492    1     DCL FIELD_INDEX SBIN;
       94    20493    1     DCL FIELD_ROW UBIN;
       95    20494    1     DCL FORM_FILE$ PTR;
       96    20495    1     DCL FORM_STATUS$ PTR;
       97    20496    1     DCL FRAME$ PTR;
       98    20497    1     DCL FRAME_COLUMN UBIN;
       99    20498    1     DCL FRAME_INDEX UBIN;
      100    20499    1     DCL FRAME_ROW UBIN;
      101    20500    1     DCL FRAME_STATUS$ PTR;
      102    20501    1     DCL GZ_FIELD$ PTR;
      103    20502    1     DCL GZ_HEADER$ PTR;
      104    20503    1     DCL INDICATORS$ PTR;
      105    20504    1     DCL INIT_DATA$ PTR;
      106    20505    1     DCL INIT_FIELD_COLUMN UBIN;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:44   
      107    20506    1     DCL INIT_FIELD_OFFSET UBIN;
      108    20507    1     DCL INSTR$ PTR;
      109    20508    1     DCL INX UBIN;
      110    20509    1     DCL INX_A$(0:2) PTR;
      111    20510    1     DCL ITS_AN_ACTIVATE BIT(1) ALIGNED;
      112    20511    1     DCL MAX_FIELD_SIZE UBIN;
      113    20512    1     DCL MULT_COUNT UBIN;
      114    20513    1     DCL NEXT_INDEX UBIN;
      115    20514    1     DCL OPERAND_COUNT UBIN;
      116    20515    1     DCL OPERAND_INDEX UBIN;
      117    20516    1     DCL OVERLAPPING_FIELD_IDENTIFIER$ PTR;
      118    20517    1     DCL PART_FIELD_SIZE UBIN;
      119    20518    1     DCL P_ITEM_INDEX UBIN;
      120    20519    1     DCL REPEATS_INDEX SBIN;
      121    20520    1     DCL ROW_INCREMENT UBIN;
      122    20521    1     DCL ROW_REPEATS$ PTR;
      123    20522    1     DCL SEPARATED_INDEX SBIN;
      124    20523    1     DCL ROW_INDEX UBIN;
      125    20524    1     DCL ROW_INDEX_STOP UBIN;
      126    20525    1     DCL TOTAL_GZ_NEEDED UBIN;
      127    20526    1     DCL TOTAL_GZ_SPACE UBIN;
      128    20527
      129    20528    1     DCL QBA$DEACTIVATE_FORM ENTRY ALTRET;
      130    20529    1     DCL QBA$DEACTIVATE_FRAME ENTRY ALTRET;
      131    20530    1     DCL QCE$ERROR ENTRY (4);
      132    20531    1     DCL QCE$ERROR_INTERNAL ENTRY (4);
      133    20532    1     DCL QCE$ERROR_M$INTERNAL ENTRY (4);
      134    20533    1     DCL QCF$FIND_CURRENTS ENTRY;
      135    20534    1     DCL QCU$UPDATE_SCREEN ENTRY;
      136    20535    1     DCL QCU$USE_IO ENTRY (1);
      137    20536
      138    20537          %SET LISTMAC = '1'B;
      139    20538
      140    20539          %INCLUDE QCU_USE_M;
      141    20593          %QCU@USE;
             20594            %BEGIN_MACRO;
             20595            %SET LISTDIR = '0'B;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:45   
             20608    1     DCL 1 QCU@USE AUTO ALIGNED,
             20609    1           2 CURR_FRAME$ PTR,
             20610                          /* Pointer to DAD of current frame or ADDR (NIL).  */
             20611    1           2 CURR_NODE$ PTR,
             20612                          /* Pointer to current node or ADDR (NIL).  */
             20613    1           2 USE_DEFAULT_IO UBIN,
             20614                          /* For USE procedures which default applies
             20615                             (see corresponding EQUs).  */
             20616    1           2 IS_TIME_TO_SAVE_AWAY_FIELDS BIT(1) ALIGNED,
             20617                          /* If IS_TIME_TO_SAVE_AWAY_FIELDS, then
             20618                             save the fields within the bounds of
             20619                             FRAME_START_INDEX, FRAME_STOP_INDEX,
             20620                             FIELD_START_INDEX, and FIELD_STOP_INDEX
             20621                             before calling the USE procedure.  */
             20622    1           2 FRAME_START_INDEX UBIN,
             20623                          /* Foist frame of the CURRENT.FORM$
             20624                             involved with the I-O error.  */
             20625    1           2 FRAME_STOP_INDEX UBIN,
             20626                          /* Larst frame of the CURRENT.FORM$
             20627                             involved with the I-O error.  */
             20628    1           2 IS_FIELD_INDEXES_VALID BIT(1) ALIGNED,
             20629                          /* If IS_FIELD_INDEXES_VALID, use them;
             20630                             else use all the fields in the frame.  */
             20631    1           2 FIELD_START_INDEX UBIN,
             20632                          /* Starting index into QI$GZ_FIELD
             20633                             which may have values "pushed".  */
             20634    1           2 FIELD_STOP_INDEX UBIN,
             20635                          /* Stopping index into QI$GZ_FIELD
             20636                             which may have values "pushed".  */
             20637    1           2 IS_CURSOR_POSITION_VALID BIT(1) ALIGNED,
             20638                          /* If IS_CURSOR_POSITION_VALID, use it;
             20639                             else allow cursor to default to upper-left-most field.  */
             20640    1           2 CURSOR_POSITION BIT(16) ALIGNED,
             20641                          /* POSition of the field on which to place the cursor.  */
             20642    1           2 STATUS UBIN;
             20643                          /* Returned action code; see corresponding EQUs.  */
             20650            %ENDIF;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:46   
      142    20653
      143    20654          %SET LISTMAC = '0'B;
      144    20655        %EJECT;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:47   
      145    20656    1       ITS_AN_ACTIVATE = %YES;

  20656   0 000005  8947 0065                            LBT,'8000'X       ITS_AN_ACTIVATE,AUTO
  20656   0 000007       8000

      146    20657    1       GOTO SO_ACTIVATE_IT_ALREADY;

  20657   0 000008  0F81 0008                            B        s:20664,PREL

      147    20658
      148    20659    1   QBA$DEACTIVATE: ENTRY;

  20659   0 00000A  D380 0000 0000  xent QBA$DEACTIVATE  LNJ,B5   X6A_AUTO_0
          0 00000D       0090 0000                       DC       144,0

      149    20660
      150    20661    1       ITS_AN_ACTIVATE = %NO;

  20661   0 00000F  8747 0065                            CL       ITS_AN_ACTIVATE,AUTO

      151    20662
      152    20663    1   SO_ACTIVATE_IT_ALREADY:
      153    20664    1       INSTR$ = QI_1.INSTR$;

  20664   0 000011  EC80 0000 0006  xsym SO_ACTIVATE_IT_*LDB,B6   QI_1+6
          0 000014  EFC7 005C                            STB,B6   INSTR$,AUTO

      154    20665    1       OPERAND_COUNT = INSTR$ -> QI$OP_ACTIVATE.OPERAND_COUNT;

  20665   0 000016  E846 0001                            LDR,R6   1,B6
          0 000018  EF47 0069                            STR,R6   OPERAND_COUNT,AUTO

      155    20666    1       QI_1.INSTR$ = PINCRW ( QI_1.SOURCE$, OPERAND_COUNT + 1 );

  20666   0 00001A  F856                                 LDR,R7   R6
          0 00001B  6C00                                 LDV,R6   0
          0 00001C  8400 0000 0018  xsym                 AID      QI_1+24
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:48   
          0 00001F  8470 0000 0001                       AID      1,IMO
          0 000022  8D00 0000 0006  xsym                 SDI      QI_1+6

      156    20667
      157    20668    1   ACTIVATE_DEACTIVATE_FORM_FRAME:
      158    20669    2       DO OPERAND_INDEX = 0 TO OPERAND_COUNT - 1;

  20669   0 000025  8747 006A            ACTIVATE_DEACTI*CL       OPERAND_INDEX,AUTO
          0 000027  0F81 0076                            B        s:20835+2,PREL

      159    20670
      160    20671    2   RETRY_CURRENT_ACT_DEACT_IVATE:
      161    20672              %PROC_ADDRESS ( THING@P =
             20672                  "INSTR$ -> QI$OP_ACTIVATE.OPERAND_A@P ( OPERAND_INDEX )",
      162    20673              CHECK_FOR_INDIRECTION = NO,
      163    20674              RESULT$ = "QI_1.CURRENT.NODE$" );

  20691   0                              RETRY_CURRENT_A*null
  20692   0 000029  ECC7 005C            RETRY_CURRENT_A*LDB,B6   INSTR$,AUTO
          0 00002B  B847 006A                            LDR,R3   OPERAND_INDEX,AUTO
          0 00002D  3E02                                 ADV,R3   2
          0 00002E  A836                                 LDR,R2   ,B6,R3
          0 00002F  F852                                 LDR,R7   R2
          0 000030  6C00                                 LDV,R6   0
          0 000031  8400 0000 0002  xsym                 AID      QI_1+2
          0 000034  8D00 0000 0080  xsym                 SDI      QI_1+128

      164    20711
      165    20712    2         CALL QCF$FIND_CURRENTS;

  20712   0 000037  CBF0 0000                            LAB,B4   0,IMO
          0 000039  E380 0000 0000  xent                 LNJ,B6   QCF$FIND_CURRENTS
          0 00003C       0001                            DC       s:20714,PREL

      166    20713
      167    20714    2         IF QI_1.CURRENT.NODE$ -> QI$FRAME.WORD0_FLAGS.TYPE = %QI#TYPE_FRAME

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:49   
  20714   0 00003D  EC80 0000 0080  xsym                 LDB,B6   QI_1+128
          0 000040  E806                                 LDR,R6   ,B6
          0 000041  E570 000F                            AND,R6   15,IMO
          0 000043  6D0A                                 CMV,R6   10
          0 000044  0981 001E                            BNE      s:20806,PREL

      168    20715    2         THEN
      169    20716    2   GET_CURRENT_FORM$:
      170    20717    3           DO;

  20717   0                              GET_CURRENT_FOR*null
      171    20718                  /*  Incrementing loop index:  look out.
      172    20719                      For FRAME-type operands, the op-code sequence
      173    20720                      contains both a FRAME pointer and a FORM pointer,
      174    20721                      so we know which FORM to activate this FRAME for.
      175    20722                      (The FRAME may be in more than one FORM).  */
      176    20723    3             OPERAND_INDEX = OPERAND_INDEX + 1;

  20723   0 000046  8AC7 006A            GET_CURRENT_FOR*INC      OPERAND_INDEX,AUTO

      177    20724
      178    20725                  %PROC_ADDRESS ( THING@P =
             20725                      "INSTR$ -> QI$OP_ACTIVATE.OPERAND_A@P ( OPERAND_INDEX )",
      179    20726                  CHECK_FOR_INDIRECTION = NO,
      180    20727                  RESULT$ = "QI_1.CURRENT.FORM$");

  20745   0 000048  DCC7 005C                            LDB,B5   INSTR$,AUTO
          0 00004A  B847 006A                            LDR,R3   OPERAND_INDEX,AUTO
          0 00004C  3E02                                 ADV,R3   2
          0 00004D  A835                                 LDR,R2   ,B5,R3
          0 00004E  F852                                 LDR,R7   R2
          0 00004F  6C00                                 LDV,R6   0
          0 000050  8400 0000 0002  xsym                 AID      QI_1+2
          0 000053  8D00 0000 0076  xsym                 SDI      QI_1+118

      181    20764
      182    20765                  %DATA_ADDRESS ( THING@D =
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:50   
             20765                      "QI_1.CURRENT.FORM$ -> QI$FORM_FILE.STATUS_AREA@D",
      183    20766                  CHECK_FOR_INDIRECTION = NO,
      184    20767                  RESULT$ = "QI_1.CURRENT.FORM_STATUS$" );

  20785   0 000056  CC80 0000 0076  xsym                 LDB,B4   QI_1+118
          0 000059  9844 0006                            LDR,R1   6,B4
          0 00005B  F851                                 LDR,R7   R1
          0 00005C  6C00                                 LDV,R6   0
          0 00005D  8400 0000 0000  xsym                 AID      QI_1
          0 000060  8D00 0000 0078  xsym                 SDI      QI_1+120

      185    20804    3           END GET_CURRENT_FORM$;

      186    20805
      187    20806    2         IF NOT QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.
             20806                  IS_OUTPUT

  20806   0 000063  DC80 0000 0078  xsym                 LDB,B5   QI_1+120
          0 000066  82C5 0008                            LB,'0400'X        8,B5
          0 000068       0400
          0 000069  0501 000C                            BBT      s:20814,PREL
          0 00006B  82C5 0008                            LB,'0200'X        8,B5
          0 00006D       0200
          0 00006E  0501 0007                            BBT      s:20814,PREL

      188    20807    2           AND NOT QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.
             20807                    IS_INPUT
      189    20808    2         THEN
      190    20809    3           DO;

      191    20810    3             QI_1.ERROR_STATUS = %E$FILE_NOT_OPEN;

  20810   0 000070  6C01                                 LDV,R6   1
          0 000071  EF00 0000 008C  xsym                 STR,R6   QI_1+140

      192    20811    3             GOTO CHECK_USE_PROCEDURE;

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:51   
  20811   0 000074  0F81 0032                            B        s:20844,PREL

      193    20812    3           END;
      194    20813
      195    20814    2         IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.WORD0_FLAGS.TYPE = %QI#TYPE_FRAME

  20814   0 000076  E806                                 LDR,R6   ,B6
          0 000077  E570 000F                            AND,R6   15,IMO
          0 000079  6D0A                                 CMV,R6   10
          0 00007A  0981 0012                            BNE      s:20827,PREL

      196    20815    2         THEN
      197    20816    2   ACTIVATE_FRAME:
      198    20817    3           DO;

  20817   0                              ACTIVATE_FRAME  null
      199    20818    3             IF ITS_AN_ACTIVATE

  20818   0 00007C  89C7 0065            ACTIVATE_FRAME  CMZ      ITS_AN_ACTIVATE,AUTO
          0 00007E  0881 0006                            BAGE     s:20822,PREL

      200    20819    3             THEN
      201    20820    3               CALL ACTIVATE_FRAME ALTRET ( CHECK_USE_PROCEDURE );

  20820   0 000080  E3C0 0098                            LNJ,B6   s:0,PREL
          0 000082       0025                            DC       s:20844,PREL
          0 000083  0F81 0018                            B        s:20835,PREL

      202    20821    3             ELSE
      203    20822    3               CALL QBA$DEACTIVATE_FRAME ALTRET ( CHECK_USE_PROCEDURE );

  20822   0 000085  CBF0 0000                            LAB,B4   0,IMO
          0 000087  E380 0000 0000  xent                 LNJ,B6   QBA$DEACTIVATE_FRAME
          0 00008A       001D                            DC       s:20844,PREL

      204    20823
      205    20824    3           END ACTIVATE_FRAME;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:52   

  20824   0 00008B  0F81 0010                            B        s:20835,PREL

      206    20825    2         ELSE
      207    20826    2   ACTIVATE_FORM:
      208    20827    3           DO;

  20827   0                              ACTIVATE_FORM   null
      209    20828
      210    20829    3             IF ITS_AN_ACTIVATE

  20829   0 00008D  89C7 0065            ACTIVATE_FORM   CMZ      ITS_AN_ACTIVATE,AUTO
          0 00008F  0881 0006                            BAGE     s:20833,PREL

      211    20830    3             THEN
      212    20831    3               CALL ACTIVATE_FORM ALTRET ( CHECK_USE_PROCEDURE );

  20831   0 000091  E3C0 004E                            LNJ,B6   s:0,PREL
          0 000093       0014                            DC       s:20844,PREL
          0 000094  0F81 0007                            B        s:20835,PREL

      213    20832    3             ELSE
      214    20833    3               CALL QBA$DEACTIVATE_FORM ALTRET ( CHECK_USE_PROCEDURE );

  20833   0 000096  CBF0 0000                            LAB,B4   0,IMO
          0 000098  E380 0000 0000  xent                 LNJ,B6   QBA$DEACTIVATE_FORM
          0 00009B       000C                            DC       s:20844,PREL

      215    20834
      216    20835    3           END ACTIVATE_FORM;

      217    20836
      218    20837    2   NEXT_ACT_DEACT_IVATE_PLEASE:
      219    20838    2       END ACTIVATE_DEACTIVATE_FORM_FRAME;

  20838   0 00009C  8AC7 006A            NEXT_ACT_DEACT_*INC      OPERAND_INDEX,AUTO
          0 00009E  E847 006A                            LDR,R6   OPERAND_INDEX,AUTO
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:53   
          0 0000A0  E947 0069                            CMR,R6   OPERAND_COUNT,AUTO
          0 0000A2  0201 FF86                            BL       s:20691,PREL

      220    20839
      221    20840    1       RETURN;

  20840   0 0000A4  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      222    20841
      223    20842        %EJECT;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:54   
      224    20843    1   CHECK_USE_PROCEDURE:
      225    20844    1       QCU@USE.CURR_NODE$ = QI_1.CURRENT.NODE$;

  20844   0 0000A7  EC80 0000 0080  xsym CHECK_USE_PROCE*LDB,B6   QI_1+128
          0 0000AA  EFC7 007A                            STB,B6   QCU@USE+2,AUTO

      226    20845    1       QCU@USE.CURR_FRAME$ = QI_1.CURRENT.FRAME$;

  20845   0 0000AC  DC80 0000 007A  xsym                 LDB,B5   QI_1+122
          0 0000AF  DFC7 0078                            STB,B5   QCU@USE,AUTO

      227    20846    1       QCU@USE.IS_TIME_TO_SAVE_AWAY_FIELDS = %NO;

  20846   0 0000B1  8747 007D                            CL       QCU@USE+5,AUTO

      228    20847    1       QCU@USE.USE_DEFAULT_IO = %QI#USE_DEFAULT_NONE;

  20847   0 0000B3  8747 007C                            CL       QCU@USE+4,AUTO

      229    20848
      230    20849    1       CALL QCU$USE_IO ( QCU@USE );

  20849   0 0000B5  CBC7 0078                            LAB,B4   QCU@USE,AUTO
          0 0000B7  CFC7 008A                            STB,B4   QCU@USE+18,AUTO
          0 0000B9  BBC7 008A                            LAB,B3   QCU@USE+18,AUTO
          0 0000BB  CBF0 0100                            LAB,B4   256,IMO
          0 0000BD  E380 0000 0000  xent                 LNJ,B6   QCU$USE_IO
          0 0000C0       0001                            DC       s:20851,PREL

      231    20850
      232    20851    2       DO CASE ( QCU@USE.STATUS );

  20851   0 0000C1  B847 0085                            LDR,R3   QCU@USE+13,AUTO
          0 0000C3  3D03                                 CMV,R3   3
          0 0000C4  0281 0010                            BGE      s:20863,PREL
          0 0000C6  A830 0000 00CC  00                   LDR,R2   s:20851+11,R3
          0 0000C9  83A0 0000 00CF  00                   JMP      s:20854,R2
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:55   
          0 0000CC       0000                            DC       s:20854,PREL
          0 0000CD       0003                            DC       s:20857,PREL
          0 0000CE       0005                            DC       s:20860,PREL

      233    20852
      234    20853    2         CASE ( %QI#USE_INVALID_RETURN );

      235    20854    2           RETURN;

  20854   0 0000CF  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      236    20855
      237    20856    2         CASE ( %QI#USE_INVALID_RETRY );

      238    20857    2           GOTO RETRY_CURRENT_ACT_DEACT_IVATE;

  20857   0 0000D2  0F81 FF56                            B        s:20691,PREL

      239    20858
      240    20859    2         CASE ( %QI#USE_INVALID_SKIP_TO_NEXT );

      241    20860    2           GOTO NEXT_ACT_DEACT_IVATE_PLEASE;

  20860   0 0000D4  0FC8                                 B        s:20835,SPREL

      242    20861
      243    20862    2         CASE ( ELSE );

      244    20863    2           CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );

  20863   0 0000D5  BB80 0000 0001  01                   LAB,B3   +1
          0 0000D8  CBF0 0100                            LAB,B4   256,IMO
          0 0000DA  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          0 0000DD       0001                            DC       s:20865,PREL

      245    20864
      246    20865    2       END;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:56   

  20865   0 0000DE  0F81 07E8                            B        s:22895,PREL

      247    20866
      248    20867        %EJECT;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:57   
      249    20868    1   ACTIVATE_FORM: PROC ALTRET;

  20868   0 0000E0  EFC7 0086            ACTIVATE_FORM   STB,B6   QCU@USE+14,AUTO

      250    20869
      251    20870        /*I*  NAME:         ACTIVATE_FORM
      252    20871              PURPOSE:      DCLFLD all the fields in a form.
      253    20872              PARAMETERS:   None.
      254    20873              DATA:         The usual global stuff.
      255    20874              PURPOSE:      Allocate dynamic memory for GZ$whatevers for
      256    20875                            a form.  This includes one QI$GZ_HEADER structure
      257    20876                            for each frame, and one QI$GZ_FIELD structure for
      258    20877                            each field within each frame.  Then call M$DCLFLD
      259    20878                            for each field.
      260    20879        */
      261    20880
      262    20881    3       DO FRAME_INDEX = 0 TO QI_1.CURRENT.FORM$ -> QI$FORM_FILE.FRAME_COUNT - 1;

  20881   0 0000E2  8747 004E                            CL       FRAME_INDEX,AUTO
          0 0000E4  0F81 0028                            B        s:20969+2,PREL

      263    20882
      264    20883              %PROC_ADDRESS ( THING@P =
             20883                  "QI_1.CURRENT.FORM$ -> QI$FORM_FILE.FRAME_LIST_A@P ( FRAME_INDEX )",
      265    20884              CHECK_FOR_INDIRECTION = NO,
      266    20885              RESULT$ = "QI_1.CURRENT.FRAME$" );

  20903   0 0000E6  EC80 0000 0076  xsym                 LDB,B6   QI_1+118
          0 0000E9  B847 004E                            LDR,R3   FRAME_INDEX,AUTO
          0 0000EB  3E0B                                 ADV,R3   11
          0 0000EC  A836                                 LDR,R2   ,B6,R3
          0 0000ED  F852                                 LDR,R7   R2
          0 0000EE  6C00                                 LDV,R6   0
          0 0000EF  8400 0000 0002  xsym                 AID      QI_1+2
          0 0000F2  8D00 0000 007A  xsym                 SDI      QI_1+122

      267    20922
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:58   
      268    20923              %DATA_ADDRESS ( THING@D = "QI_1.CURRENT.FRAME$ -> QI$FRAME.STATUS_AREA@D",
      269    20924              CHECK_FOR_INDIRECTION = NO,
      270    20925              RESULT$ = "QI_1.CURRENT.FRAME_STATUS$" );

  20943   0 0000F5  DC80 0000 007A  xsym                 LDB,B5   QI_1+122
          0 0000F8  9845 0006                            LDR,R1   6,B5
          0 0000FA  F851                                 LDR,R7   R1
          0 0000FB  6C00                                 LDV,R6   0
          0 0000FC  8400 0000 0000  xsym                 AID      QI_1
          0 0000FF  8D00 0000 007C  xsym                 SDI      QI_1+124

      271    20962
      272    20963    3         CALL ACTIVATE_FRAME

  20963   0 000102  E3C0 0016                            LNJ,B6   s:0,PREL
          0 000104       0003                            DC       s:20966,PREL
          0 000105  0F81 0005                            B        s:20969,PREL

      273    20964    3         WHENALTRETURN
      274    20965    4           DO;

      275    20966    4             ALTRETURN;

  20966   0 000107  ECC7 0086                            LDB,B6   QCU@USE+14,AUTO
          0 000109  B806                                 LDR,R3   ,B6
          0 00010A  C3B6                                 LNJ,B4   ,B6,R3

      276    20967    4           END;
      277    20968
      278    20969    3       END;

  20969   0 00010B  8AC7 004E                            INC      FRAME_INDEX,AUTO
          0 00010D  EC80 0000 0076  xsym                 LDB,B6   QI_1+118
          0 000110  E847 004E                            LDR,R6   FRAME_INDEX,AUTO
          0 000112  E946 0001                            CMR,R6   1,B6
          0 000114  0252                                 BL       s:20903,SPREL

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:59   
      279    20970
      280    20971    2       RETURN;

  20971   0 000115  ECC7 0086                            LDB,B6   QCU@USE+14,AUTO
          0 000117  C3C6 0001                            LNJ,B4   1,B6

      281    20972
      282    20973    2   END ACTIVATE_FORM;
      283    20974        %EJECT;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:60   
      284    20975    1   ACTIVATE_FRAME: PROC ALTRET;

  20975   0 000119  EFC7 0088            ACTIVATE_FRAME  STB,B6   QCU@USE+16,AUTO

      285    20976
      286    20977        /*I*  NAME:         ACTIVATE_FRAME
      287    20978              PURPOSE:      DCLFLD all the fields in a frame.
      288    20979              PARAMETERS:   None.
      289    20980              DATA:         The usual global stuff.
      290    20981              PURPOSE:      Allocate dynamic memory for GZ$whatevers for
      291    20982                            a frame.  This includes one QI$GZ_HEADER structure
      292    20983                            for the frame, and one QI$GZ_FIELD structure for
      293    20984                            each field within the frame.  Then call M$DCLFLD
      294    20985                            for each field.
      295    20986        */
      296    20987
      297    20988    2       IF QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.INDICATORS.IS_ACTIVE

  20988   0 00011B  DC80 0000 007C  xsym                 LDB,B5   QI_1+124
          0 00011E  89C5 000C                            CMZ      12,B5
          0 000120  0881 0009                            BAGE     s:20997,PREL

      298    20989    2       THEN
      299    20990    3         DO;

      300    20991    3           QI_1.ERROR_STATUS = %E$FRAME_ALREADY_ACTIVATED;

  20991   0 000122  6C0C                                 LDV,R6   12
          0 000123  EF00 0000 008C  xsym                 STR,R6   QI_1+140

      301    20992    3           ALTRETURN;

  20992   0 000126  ECC7 0088                            LDB,B6   QCU@USE+16,AUTO
          0 000128  B806                                 LDR,R3   ,B6
          0 000129  C3B6                                 LNJ,B4   ,B6,R3

      302    20993    3         END;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:61   
      303    20994
      304    20995            /*  If a screen update is pending due to a previous DEACTIVATE,
      305    20996                do that now.  Otherwise, a new field may overlap an old one.  */
      306    20997    2       IF QI_1.SCREEN_UPDATE_FLAGS.WAS_DEACTIVATED

  20997   0 00012A  8280 0000 0016  xsym                 LB,'2000'X        QI_1+22
  20997   0 00012D       2000
          0 00012E  0581 0007                            BBF      s:21001,PREL

      307    20998    2       THEN
      308    20999    2         CALL QCU$UPDATE_SCREEN;

  20999   0 000130  CBF0 0000                            LAB,B4   0,IMO
          0 000132  E380 0000 0000  xent                 LNJ,B6   QCU$UPDATE_SCREEN
          0 000135       0001                            DC       s:21001,PREL

      309    21000
      310    21001    2       FIELD_COUNT = 0;

  21001   0 000136  8747 003F                            CL       FIELD_COUNT,AUTO

      311    21002    2       MAX_FIELD_SIZE = 0;

  21002   0 000138  8747 0066                            CL       MAX_FIELD_SIZE,AUTO

      312    21003
      313    21004    2       QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.FIELD_START_INDEX = 0;

  21004   0 00013A  EC80 0000 007C  xsym                 LDB,B6   QI_1+124
          0 00013D  8706                                 CL       ,B6

      314    21005    2       QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.FIELD_STOP_INDEX = 0;

  21005   0 00013E  EC80 0000 007C  xsym                 LDB,B6   QI_1+124
          0 000141  8746 0001                            CL       1,B6

      315    21006
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:62   
      316    21007    2       CURRENT_FATHER$ = QI_1.CURRENT.FRAME$;

  21007   0 000143  EC80 0000 007A  xsym                 LDB,B6   QI_1+122
          0 000146  EFC7 0035                            STB,B6   CURRENT_FATHER$,AUTO

      317    21008
      318    21009            %PROC_ADDRESS ( THING@P = "QI_1.CURRENT.FRAME$ -> QI$FRAME.SON@P",
      319    21010            CHECK_FOR_INDIRECTION = NO,
      320    21011            RESULT$ = DAD$ );

  21029   0 000148  B846 0003                            LDR,R3   3,B6
          0 00014A  F853                                 LDR,R7   R3
          0 00014B  6C00                                 LDV,R6   0
          0 00014C  8400 0000 0002  xsym                 AID      QI_1+2
          0 00014F  8D47 0039                            SDI      DAD$,AUTO

      321    21048
      322    21049    2   NEXT_COUNT:
      323    21050    2       QI_1.CURRENT.NODE$ = DAD$;

  21050   0 000151  ECC7 0039            NEXT_COUNT      LDB,B6   DAD$,AUTO
          0 000153  EF80 0000 0080  xsym                 STB,B6   QI_1+128

      324    21051
      325    21052            %DATA_ADDRESS ( THING@D = "DAD$ -> QI$MAJOR_NODE.STATUS_AREA@D",
      326    21053            CHECK_FOR_INDIRECTION = NO,
      327    21054            RESULT$ = "QI_1.CURRENT.NODE_STATUS$" );

  21072   0 000156  B846 0006                            LDR,R3   6,B6
          0 000158  F853                                 LDR,R7   R3
          0 000159  6C00                                 LDV,R6   0
          0 00015A  8400 0000 0000  xsym                 AID      QI_1
          0 00015D  8D00 0000 0082  xsym                 SDI      QI_1+130

      328    21091
      329    21092            %DATA_ADDRESS ( THING@D = "CURRENT_FATHER$ -> QI$MAJOR_NODE.STATUS_AREA@D",
      330    21093            CHECK_FOR_INDIRECTION = NO,
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:63   
      331    21094            RESULT$ = CURRENT_FATHER_STATUS$ );

  21112   0 000160  DCC7 0035                            LDB,B5   CURRENT_FATHER$,AUTO
          0 000162  A845 0006                            LDR,R2   6,B5
          0 000164  F852                                 LDR,R7   R2
          0 000165  6C00                                 LDV,R6   0
          0 000166  8400 0000 0000  xsym                 AID      QI_1
          0 000169  8D47 0037                            SDI      CURRENT_FATHER_STATUS$,AUTO

      332    21131
      333    21132        /* INHERIT ROW & COL INCREMENTS                  */
      334    21133    2       QI_1.CURRENT.NODE_STATUS$ -> QI$MAJOR_STATUS.GZ.FIELD_START_INDEX =
             21133                CURRENT_FATHER_STATUS$ -> QI$MAJOR_STATUS.GZ.FIELD_START_INDEX;

  21133   0 00016B  CC80 0000 0082  xsym                 LDB,B4   QI_1+130
          0 00016E  BCC7 0037                            LDB,B3   CURRENT_FATHER_STATUS$,AUTO
          0 000170  D803                                 LDR,R5   ,B3
          0 000171  DF04                                 STR,R5   ,B4

      335    21134    2       QI_1.CURRENT.NODE_STATUS$ -> QI$MAJOR_STATUS.GZ.FIELD_STOP_INDEX =
             21134                CURRENT_FATHER_STATUS$ -> QI$MAJOR_STATUS.GZ.FIELD_STOP_INDEX;

  21134   0 000172  CC80 0000 0082  xsym                 LDB,B4   QI_1+130
          0 000175  D843 0001                            LDR,R5   1,B3
          0 000177  DF44 0001                            STR,R5   1,B4

      336    21135
      337    21136    3       DO CASE ( DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.TYPE );

  21136   0 000179  9806                                 LDR,R1   ,B6
          0 00017A  9570 000F                            AND,R1   15,IMO
          0 00017C  1D0B                                 CMV,R1   11
          0 00017D  0281 01A9                            BGE      s:21638,PREL
          0 00017F  B810 0000 0185  00                   LDR,R3   s:21136+12,R1
          0 000182  83B0 0000 0190  00                   JMP      s:21139,R3
          0 000185       0000                            DC       s:21139,PREL
          0 000186       0197                            DC       s:21638,PREL
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:64   
          0 000187       0197                            DC       s:21638,PREL
          0 000188       0009                            DC       s:21144,PREL
          0 000189       0197                            DC       s:21638,PREL
          0 00018A       0197                            DC       s:21638,PREL
          0 00018B       0197                            DC       s:21638,PREL
          0 00018C       0197                            DC       s:21638,PREL
          0 00018D       00D8                            DC       s:21371,PREL
          0 00018E       01A0                            DC       s:21640,PREL
          0 00018F       01A0                            DC       s:21640,PREL

      338    21137
      339    21138    3         CASE ( %QI#TYPE_DISPLAY );

      340    21139    3           PART_FIELD_SIZE = DAD$ -> QI$FIELD_DAD.PSEUDO_CIP.NUMERIC.LEN;

  21139   0 000190  D846 0001                            LDR,R5   1,B6
          0 000192  5048                                 SOR,R5   8
          0 000193  D570 001F                            AND,R5   31,IMO
          0 000195  DF47 006D                            STR,R5   PART_FIELD_SIZE,AUTO

      341    21140
      342    21141    3           GOTO CONTINUE_COUNT;

  21141   0 000197  0F81 0007                            B        s:21147,PREL

      343    21142
      344    21143    3         CASE ( %QI#TYPE_ALPHANUMERIC );

      345    21144    3           PART_FIELD_SIZE = DAD$ -> QI$FIELD_DAD.PSEUDO_CIP.ALPHANUMERIC.LEN;

  21144   0 000199  D846 0001                            LDR,R5   1,B6
          0 00019B  D570 3FFF                            AND,R5   16383,IMO
          0 00019D  DF47 006D                            STR,R5   PART_FIELD_SIZE,AUTO

      346    21145
      347    21146    3   CONTINUE_COUNT:
      348    21147    3           IF PART_FIELD_SIZE > MAX_FIELD_SIZE
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:65   

  21147   0 00019F  D947 0066            CONTINUE_COUNT  CMR,R5   MAX_FIELD_SIZE,AUTO
          0 0001A1  0381 0007                            BLE      s:21152,PREL
          0 0001A3  8286                                 LB,'2000'X        ,B6
          0 0001A4       2000
          0 0001A5  0581 0003                            BBF      s:21152,PREL

      349    21148    3             AND DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.IO_FLAGS.IS_INPUT
      350    21149    3           THEN
      351    21150    3             MAX_FIELD_SIZE = PART_FIELD_SIZE;

  21150   0 0001A7  DF47 0066                            STR,R5   MAX_FIELD_SIZE,AUTO

      352    21151
      353    21152    3           IF DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT > 0

  21152   0 0001A9  8286                                 LB,'0030'X        ,B6
  21152   0 0001AA       0030
          0 0001AB  0581 0039                            BBF      s:21227,PREL

      354    21153    3           THEN
      355    21154    4             DO;

      356    21155
      357    21156        /* HAVE DIMENSIONS                               */
      358    21157                    /*  Increment past any level_multipliers to get to the
      359    21158                        P.whatever flags.  */
      360    21159    4               FIELD_DAD_P$ = ADDR ( DAD$ -> QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS.
             21159                        LEVEL_MULTIPLIER_A

  21159   0 0001AD  B806                                 LDR,R3   ,B6
          0 0001AE  3044                                 SOR,R3   4
          0 0001AF  B570 0003                            AND,R3   3,IMO
          0 0001B1  3001                                 SOL,R3   1
          0 0001B2  3E0B                                 ADV,R3   11
          0 0001B3  CBB6                                 LAB,B4   ,B6,R3
          0 0001B4  CFC7 0040                            STB,B4   FIELD_DAD_P$,AUTO
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:66   

      361    21160    4                 ( DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT )
      362    21161    4                 );
      363    21162
      364    21163        /* CHECK IF REPEATS APPEARS ON ELEMENTARY        */
      365    21164    4               IF FIELD_DAD_P$ -> QI$FIELD_DAD_P.P.REPEATS

  21164   0 0001B6  8284                                 LB,'0800'X        ,B4
  21164   0 0001B7       0800
          0 0001B8  0581 002C                            BBF      s:21227,PREL

      366    21165    4               THEN
      367    21166    5                 DO;

      368    21167        /* YES                                           */
      369    21168        /* MUST COMPUTE COLUMN INCREMENT                 */
      370    21169    5                   IF FIELD_DAD_P$ -> QI$FIELD_DAD_P.P.SEPARATED

  21169   0 0001BA  8284                                 LB,'0400'X        ,B4
  21169   0 0001BB       0400
          0 0001BC  0581 0022                            BBF      s:21220,PREL

      371    21170    5                   THEN
      372    21171    6                     DO;

      373    21172
      374    21173        /* HAVE A SEPARATED CLAUSE                       */
      375    21174                            %PRESENCE_DISPLACEMENT (
      376    21175                            PRESENCE_THING$ = FIELD_DAD_P$,
      377    21176                            INDEX = P_ITEM_INDEX,
      378    21177                            START = %QI#P_FIELD_FIRST_INDEX,
      379    21178                            STOP = %QI#P_SEPARATED_INDEX,
      380    21179                            RESULT = SEPARATED_INDEX
      381    21180                            );

  21196   0 0001BE  8947 0073                            LBT,'FFFF'X       SEPARATED_INDEX,AUTO
  21196   0 0001C0       FFFF
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:67   

  21197   0 0001C1  8747 006E                            CL       P_ITEM_INDEX,AUTO

  21198   0 0001C3  ECC7 0040                            LDB,B6   FIELD_DAD_P$,AUTO
          0 0001C5  B847 006E                            LDR,R3   P_ITEM_INDEX,AUTO
          0 0001C7  82B6                                 LB       ,B6,R3
          0 0001C8  0581 0003                            BBF      s:21201,PREL

  21200   0 0001CA  8AC7 0073                            INC      SEPARATED_INDEX,AUTO

  21201   0 0001CC  8AC7 006E                            INC      P_ITEM_INDEX,AUTO
          0 0001CE  E847 006E                            LDR,R6   P_ITEM_INDEX,AUTO
          0 0001D0  6D05                                 CMV,R6   5
          0 0001D1  03F2                                 BLE      s:21198,SPREL

      382    21212
      383    21213    6                      QI_1.CURRENT.NODE_STATUS$ -> QI$FIELD_STATUS.GZ.FIELD_STOP_INDEX
             21213                                =

  21213   0 0001D2  B847 0073                            LDR,R3   SEPARATED_INDEX,AUTO
          0 0001D4  3E01                                 ADV,R3   1
          0 0001D5  D847 006D                            LDR,R5   PART_FIELD_SIZE,AUTO
          0 0001D7  DA36                                 ADD,R5   ,B6,R3
          0 0001D8  DC80 0000 0082  xsym                 LDB,B5   QI_1+130
          0 0001DB  DF45 0001                            STR,R5   1,B5

      384    21214    6                         PART_FIELD_SIZE
      385    21215    6                        + FIELD_DAD_P$ -> QI$FIELD_DAD_P.P_ITEM_A ( SEPARATED_INDEX );
      386    21216
      387    21217    6                     END;

  21217   0 0001DD  0F81 0007                            B        s:21227,PREL

      388    21218    5                   ELSE
      389    21219
      390    21220    5                    QI_1.CURRENT.NODE_STATUS$ -> QI$FIELD_STATUS.GZ.FIELD_STOP_INDEX =

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:68   
  21220   0 0001DF  AC80 0000 0082  xsym                 LDB,B2   QI_1+130
          0 0001E2  5E01                                 ADV,R5   1
          0 0001E3  DF42 0001                            STR,R5   1,B2

      391    21221    5                       PART_FIELD_SIZE + 1;
      392    21222
      393    21223    5                 END; /* IF FIELD_DAD_P$ -> QI$FIELD_DAD_P.P.REPEATS */

      394    21224
      395    21225    4             END; /* IF DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT > 0 */

      396    21226
      397    21227    3           ELEM_COUNT = 1;

  21227   0 0001E5  6C01                                 LDV,R6   1
          0 0001E6  EF47 003C                            STR,R6   ELEM_COUNT,AUTO

      398    21228
      399    21229    3           IF DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT > 0

  21229   0 0001E8  ECC7 0039                            LDB,B6   DAD$,AUTO
          0 0001EA  8286                                 LB,'0030'X        ,B6
          0 0001EB       0030
          0 0001EC  0581 0073                            BBF      s:21366,PREL

      400    21230    3           THEN
      401    21231    4             DO;

      402    21232        /* HAVE DIMENSIONS                               */
      403    21233    4               GOTO HAVE_FIELD_COUNT;

  21233   0 0001EE  0F81 001A                            B        s:21238,PREL

      404    21234
      405    21235    4   CHECK_DIM_COUNT:
      406    21236    5               DO CASE ( DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.TYPE );

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:69   
  21236   0 0001F0  ECC7 0039            CHECK_DIM_COUNT LDB,B6   DAD$,AUTO
          0 0001F2  B806                                 LDR,R3   ,B6
          0 0001F3  B570 000F                            AND,R3   15,IMO
          0 0001F5  3D0B                                 CMV,R3   11
          0 0001F6  0281 004A                            BGE      s:21310,PREL
          0 0001F8  A830 0000 01FE  00                   LDR,R2   CHECK_DIM_COUNT+14,R3
          0 0001FB  83A0 0000 0209  00                   JMP      HAVE_FIELD_COUNT,R2
          0 0001FE       0000                            DC       s:21238,PREL
          0 0001FF       0038                            DC       s:21310,PREL
          0 000200       0038                            DC       s:21310,PREL
          0 000201       0000                            DC       s:21238,PREL
          0 000202       0038                            DC       s:21310,PREL
          0 000203       0038                            DC       s:21310,PREL
          0 000204       0038                            DC       s:21310,PREL
          0 000205       0038                            DC       s:21310,PREL
          0 000206       0029                            DC       s:21296,PREL
          0 000207       0041                            DC       s:21315,PREL
          0 000208       0041                            DC       s:21315,PREL

      407    21237
      408    21238    5                 CASE ( %QI#TYPE_DISPLAY, %QI#TYPE_ALPHANUMERIC );

      409    21239    5   HAVE_FIELD_COUNT:
      410    21240                        /*  Increment past any level_multipliers to get to the
      411    21241                            P.whatever flags.  */
      412    21242    5                   FIELD_DAD_P$ = ADDR ( DAD$ -> QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS.
             21242                            LEVEL_MULTIPLIER_A

  21242   0 000209  B806                 HAVE_FIELD_COUNTLDR,R3   ,B6
          0 00020A  3044                                 SOR,R3   4
          0 00020B  B570 0003                            AND,R3   3,IMO
          0 00020D  3001                                 SOL,R3   1
          0 00020E  3E0B                                 ADV,R3   11
          0 00020F  DBB6                                 LAB,B5   ,B6,R3
          0 000210  DFC7 0040                            STB,B5   FIELD_DAD_P$,AUTO

      413    21243    5                     ( DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT )
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:70   
      414    21244    5                     );
      415    21245
      416    21246    5                   IF FIELD_DAD_P$ -> QI$FIELD_DAD_P.P.REPEATS

  21246   0 000212  8285                                 LB,'0800'X        ,B5
  21246   0 000213       0800
          0 000214  0581 0035                            BBF      s:21315,PREL

      417    21247    5                   THEN
      418    21248    6                     DO;

      419    21249
      420    21250                            %PRESENCE_DISPLACEMENT (
      421    21251                            PRESENCE_THING$ = FIELD_DAD_P$,
      422    21252                            INDEX = P_ITEM_INDEX,
      423    21253                            START = %QI#P_FIELD_FIRST_INDEX,
      424    21254                            STOP = %QI#P_REPEATS_INDEX,
      425    21255                            RESULT = REPEATS_INDEX
      426    21256                            );

  21272   0 000216  8947 006F                            LBT,'FFFF'X       REPEATS_INDEX,AUTO
  21272   0 000218       FFFF

  21273   0 000219  8747 006E                            CL       P_ITEM_INDEX,AUTO

  21274   0 00021B  ECC7 0040                            LDB,B6   FIELD_DAD_P$,AUTO
          0 00021D  B847 006E                            LDR,R3   P_ITEM_INDEX,AUTO
          0 00021F  82B6                                 LB       ,B6,R3
          0 000220  0581 0003                            BBF      s:21277,PREL

  21276   0 000222  8AC7 006F                            INC      REPEATS_INDEX,AUTO

  21277   0 000224  8AC7 006E                            INC      P_ITEM_INDEX,AUTO
          0 000226  E847 006E                            LDR,R6   P_ITEM_INDEX,AUTO
          0 000228  6D04                                 CMV,R6   4
          0 000229  03F2                                 BLE      s:21274,SPREL

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:71   
      427    21288
      428    21289    6                       MULT_COUNT = FIELD_DAD_P$ -> QI$FIELD_DAD_P.P_ITEM_A (
             21289                                REPEATS_INDEX );

  21289   0 00022A  B847 006F                            LDR,R3   REPEATS_INDEX,AUTO
          0 00022C  3E01                                 ADV,R3   1
          0 00022D  D836                                 LDR,R5   ,B6,R3
          0 00022E  DF47 0067                            STR,R5   MULT_COUNT,AUTO

      429    21290
      430    21291    6                       GOTO HAVE_MULT_COUNT;

  21291   0 000230  0F81 0007                            B        s:21303,PREL

      431    21292
      432    21293    6                     END;
      433    21294
      434    21295    5                 CASE ( %QI#TYPE_MINOR );

      435    21296    5                   IF DAD$ -> QI$MINOR_NODE.REPEATS > 0

  21296   0 000232  E846 0001                            LDR,R6   1,B6
          0 000234  6901 0015                            BEZ,R6   s:21315,PREL

      436    21297    5                   THEN
      437    21298    6                     DO;

      438    21299
      439    21300    6                       MULT_COUNT = DAD$ -> QI$MINOR_NODE.REPEATS;

  21300   0 000236  EF47 0067                            STR,R6   MULT_COUNT,AUTO

      440    21301
      441    21302    6   HAVE_MULT_COUNT:
      442    21303    6                       ELEM_COUNT = MULT_COUNT * ELEM_COUNT;

  21303   0 000238  F847 0067            HAVE_MULT_COUNT LDR,R7   MULT_COUNT,AUTO
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:72   
          0 00023A  FB47 003C                            MUL,R7   ELEM_COUNT,AUTO
          0 00023C  E857                                 LDR,R6   R7
          0 00023D  EF47 003C                            STR,R6   ELEM_COUNT,AUTO

      443    21304
      444    21305    6                     END;

  21305   0 00023F  0F81 000A                            B        s:21315,PREL

      445    21306
      446    21307    5                 CASE ( %QI#TYPE_MAJOR, %QI#TYPE_FRAME );

      447    21308
      448    21309    5                 CASE ( ELSE );

      449    21310    5                   CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );

  21310   0 000241  BB80 0000 0004  01                   LAB,B3   +4
          0 000244  CBF0 0100                            LAB,B4   256,IMO
          0 000246  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          0 000249       0001                            DC       s:21315,PREL

      450    21311
      451    21312
      452    21313    5               END;

      453    21314
      454    21315    4               IF DAD$ -> QI$MAJOR_NODE.FATHER@P > 0

  21315   0 00024A  ECC7 0039                            LDB,B6   DAD$,AUTO
          0 00024C  E846 0005                            LDR,R6   5,B6
          0 00024E  6901 0011                            BEZ,R6   s:21366,PREL
          0 000250  D806                                 LDR,R5   ,B6
          0 000251  D570 000F                            AND,R5   15,IMO
          0 000253  5D0A                                 CMV,R5   10
          0 000254  0901 000B                            BE       s:21366,PREL

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:73   
      455    21316    4                 AND DAD$ -> QI$MAJOR_NODE.WORD0_FLAGS.TYPE ~= %QI#TYPE_FRAME
      456    21317    4               THEN
      457    21318    5                 DO;

      458    21319
      459    21320                        %PROC_ADDRESS ( THING@P = "DAD$ -> QI$MAJOR_NODE.FATHER@P",
      460    21321                        CHECK_FOR_INDIRECTION = NO,
      461    21322                        RESULT$ = DAD$ );

  21340   0 000256  B856                                 LDR,R3   R6
          0 000257  F853                                 LDR,R7   R3
          0 000258  6C00                                 LDV,R6   0
          0 000259  8400 0000 0002  xsym                 AID      QI_1+2
          0 00025C  8D47 0039                            SDI      DAD$,AUTO

      462    21359
      463    21360    5                   GOTO CHECK_DIM_COUNT;

  21360   0 00025E  0F81 FF91                            B        s:21236,PREL

      464    21361
      465    21362    5                 END;
      466    21363
      467    21364    4             END; /* IF DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT > 0 */
      468    21365
      469    21366    3           FIELD_COUNT = FIELD_COUNT + ELEM_COUNT;

  21366   0 000260  E847 003F                            LDR,R6   FIELD_COUNT,AUTO
          0 000262  EA47 003C                            ADD,R6   ELEM_COUNT,AUTO
          0 000264  EF47 003F                            STR,R6   FIELD_COUNT,AUTO

      470    21367
      471    21368    3           GOTO CHECK_STEP_ACROSS_COUNT;

  21368   0 000266  0F81 00DC                            B        s:21693,PREL

      472    21369
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:74   
      473    21370    3         CASE ( %QI#TYPE_MINOR );

      474    21371    3           IF DAD$ -> QI$MINOR_NODE.REPEATS > 0

  21371   0 000268  D846 0001                            LDR,R5   1,B6
          0 00026A  5901 00C5                            BEZ,R5   s:21640,PREL

      475    21372    3           THEN
      476    21373    4             DO;

      477    21374
      478    21375    4               BOX_MAX_ROW = 0;

  21375   0 00026C  8747 002E                            CL       BOX_MAX_ROW,AUTO

      479    21376    4               BOX_MAX_COLUMN = 0;

  21376   0 00026E  8747 002D                            CL       BOX_MAX_COLUMN,AUTO

      480    21377
      481    21378    4               BOX_MIN_ROW = %BITBIN ('7FFF'X);

  21378   0 000270  C870 7FFF                            LDR,R4   32767,IMO
          0 000272  CF47 0030                            STR,R4   BOX_MIN_ROW,AUTO

      482    21379    4               BOX_MIN_COLUMN = %BITBIN ('7FFF'X);

  21379   0 000274  CF47 002F                            STR,R4   BOX_MIN_COLUMN,AUTO

      483    21380
      484    21381                    %PROC_ADDRESS ( THING@P = "DAD$ -> QI$MINOR_NODE.SON@P",
      485    21382                    CHECK_FOR_INDIRECTION = NO,
      486    21383                    RESULT$ = DAD$ );

  21401   0 000276  B846 0003                            LDR,R3   3,B6
          0 000278  F853                                 LDR,R7   R3
          0 000279  6C00                                 LDV,R6   0
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:75   
          0 00027A  8400 0000 0002  xsym                 AID      QI_1+2
          0 00027D  8D47 0039                            SDI      DAD$,AUTO

      487    21420
      488    21421    4   NEXT_BOX:
      489    21422    5               DO CASE ( DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.TYPE );

  21422   0 00027F  ECC7 0039            NEXT_BOX        LDB,B6   DAD$,AUTO
          0 000281  B806                                 LDR,R3   ,B6
          0 000282  B570 000F                            AND,R3   15,IMO
          0 000284  3D09                                 CMV,R3   9
          0 000285  0281 0044                            BGE      s:21460,PREL
          0 000287  A830 0000 028D  00                   LDR,R2   NEXT_BOX+14,R3
          0 00028A  83A0 0000 0296  00                   JMP      s:21425,R2
          0 00028D       0000                            DC       s:21425,PREL
          0 00028E       0034                            DC       s:21460,PREL
          0 00028F       0034                            DC       s:21460,PREL
          0 000290       0009                            DC       s:21430,PREL
          0 000291       0034                            DC       s:21460,PREL
          0 000292       0034                            DC       s:21460,PREL
          0 000293       0034                            DC       s:21460,PREL
          0 000294       0034                            DC       s:21460,PREL
          0 000295       003D                            DC       s:21462,PREL

      490    21423
      491    21424    5                 CASE ( %QI#TYPE_DISPLAY );

      492    21425    5                   DISP = DAD$ -> QI$FIELD_DAD.PSEUDO_CIP.NUMERIC.LEN;

  21425   0 000296  E846 0001                            LDR,R6   1,B6
          0 000298  6048                                 SOR,R6   8
          0 000299  E570 001F                            AND,R6   31,IMO
          0 00029B  EF47 003B                            STR,R6   DISP,AUTO

      493    21426
      494    21427    5                   GOTO NEXT_BOX_CONTINUE;

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:76   
  21427   0 00029D  0F81 0007                            B        s:21433,PREL

      495    21428
      496    21429    5                 CASE ( %QI#TYPE_ALPHANUMERIC );

      497    21430    5                   DISP = DAD$ -> QI$FIELD_DAD.PSEUDO_CIP.ALPHANUMERIC.LEN;

  21430   0 00029F  E846 0001                            LDR,R6   1,B6
          0 0002A1  E570 3FFF                            AND,R6   16383,IMO
          0 0002A3  EF47 003B                            STR,R6   DISP,AUTO

      498    21431
      499    21432    5   NEXT_BOX_CONTINUE:
      500    21433    5                   INX = DAD$ -> QI$FIELD_DAD.POSITION.COLUMN;

  21433   0 0002A5  D846 0009            NEXT_BOX_CONTIN*LDR,R5   9,B6
          0 0002A7  DF47 005E                            STR,R5   INX,AUTO

      501    21434
      502    21435    5                   DISP = DISP + INX;

  21435   0 0002A9  EA55                                 ADD,R6   R5
          0 0002AA  EF47 003B                            STR,R6   DISP,AUTO

      503    21436
      504    21437    5                   IF DISP > BOX_MAX_COLUMN

  21437   0 0002AC  E947 002D                            CMR,R6   BOX_MAX_COLUMN,AUTO
          0 0002AE  0381 0003                            BLE      s:21441,PREL

      505    21438    5                   THEN
      506    21439    5                     BOX_MAX_COLUMN = DISP;

  21439   0 0002B0  EF47 002D                            STR,R6   BOX_MAX_COLUMN,AUTO

      507    21440
      508    21441    5                   IF INX < BOX_MIN_COLUMN
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:77   

  21441   0 0002B2  D947 002F                            CMR,R5   BOX_MIN_COLUMN,AUTO
          0 0002B4  0281 0003                            BGE      s:21445,PREL

      509    21442    5                   THEN
      510    21443    5                     BOX_MIN_COLUMN = INX;

  21443   0 0002B6  DF47 002F                            STR,R5   BOX_MIN_COLUMN,AUTO

      511    21444
      512    21445    5                   DISP = DAD$ -> QI$FIELD_DAD.POSITION.LINE;

  21445   0 0002B8  E846 0008                            LDR,R6   8,B6
          0 0002BA  EF47 003B                            STR,R6   DISP,AUTO

      513    21446
      514    21447    5                   IF DISP > BOX_MAX_ROW

  21447   0 0002BC  E947 002E                            CMR,R6   BOX_MAX_ROW,AUTO
          0 0002BE  0381 0003                            BLE      s:21451,PREL

      515    21448    5                   THEN
      516    21449    5                     BOX_MAX_ROW = DISP;

  21449   0 0002C0  EF47 002E                            STR,R6   BOX_MAX_ROW,AUTO

      517    21450
      518    21451    5                   IF DISP < BOX_MIN_ROW

  21451   0 0002C2  E947 0030                            CMR,R6   BOX_MIN_ROW,AUTO
          0 0002C4  0281 0003                            BGE      s:21455,PREL

      519    21452    5                   THEN
      520    21453    5                     BOX_MIN_ROW = DISP;

  21453   0 0002C6  EF47 0030                            STR,R6   BOX_MIN_ROW,AUTO

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:78   
      521    21454
      522    21455    5                   GOTO BOX_STEP_ACROSS_COUNT;

  21455   0 0002C8  0F81 001A                            B        s:21513,PREL

      523    21456
      524    21457    5                 CASE ( %QI#TYPE_MINOR );

      525    21458
      526    21459    5                 CASE ( ELSE );

      527    21460    5                   CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );

  21460   0 0002CA  BB80 0000 0004  01                   LAB,B3   +4
          0 0002CD  CBF0 0100                            LAB,B4   256,IMO
          0 0002CF  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          0 0002D2       0001                            DC       s:21462,PREL

      528    21461
      529    21462    5               END;

      530    21463
      531    21464    4   BOX_STEP_DOWN_COUNT:
      532    21465    4               IF DAD$ -> QI$MAJOR_NODE.SON@P > 0

  21465   0 0002D3  ECC7 0039            BOX_STEP_DOWN_C*LDB,B6   DAD$,AUTO
          0 0002D5  E846 0003                            LDR,R6   3,B6
          0 0002D7  6901 000B                            BEZ,R6   s:21513,PREL

      533    21466    4               THEN
      534    21467    5                 DO;

      535    21468
      536    21469                        %PROC_ADDRESS ( THING@P = "DAD$ -> QI$MAJOR_NODE.SON@P",
      537    21470                        CHECK_FOR_INDIRECTION = NO,
      538    21471                        RESULT$ = DAD$ );

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:79   
  21489   0 0002D9  B856                                 LDR,R3   R6
          0 0002DA  F853                                 LDR,R7   R3
          0 0002DB  6C00                                 LDV,R6   0
          0 0002DC  8400 0000 0002  xsym                 AID      QI_1+2
          0 0002DF  8D47 0039                            SDI      DAD$,AUTO

      539    21508
      540    21509    5                   GOTO NEXT_BOX;

  21509   0 0002E1  0F81 FF9D                            B        s:21410,PREL

      541    21510
      542    21511    5                 END;
      543    21512    4               ELSE
      544    21513    5                 DO;

      545    21514
      546    21515    5   BOX_STEP_ACROSS_COUNT:
      547    21516    5                   IF DAD$ -> QI$MAJOR_NODE.BROTHER@P > 0

  21516   0 0002E3  ECC7 0039            BOX_STEP_ACROSS*LDB,B6   DAD$,AUTO
          0 0002E5  E846 0004                            LDR,R6   4,B6
          0 0002E7  6901 000B                            BEZ,R6   s:21586,PREL

      548    21517    5                   THEN
      549    21518    6                     DO;

      550    21519
      551    21520                            %PROC_ADDRESS ( THING@P = "DAD$ -> QI$MAJOR_NODE.BROTHER@P",
      552    21521                            CHECK_FOR_INDIRECTION = NO,
      553    21522                            RESULT$ = DAD$ );

  21540   0 0002E9  B856                                 LDR,R3   R6
          0 0002EA  F853                                 LDR,R7   R3
          0 0002EB  6C00                                 LDV,R6   0
          0 0002EC  8400 0000 0002  xsym                 AID      QI_1+2
          0 0002EF  8D47 0039                            SDI      DAD$,AUTO
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:80   

      554    21559
      555    21560    6                       GOTO NEXT_BOX;

  21560   0 0002F1  0F81 FF8D                            B        s:21410,PREL

      556    21561
      557    21562    6                     END;
      558    21563    5                   ELSE
      559    21564    6                     DO;

      560    21565
      561    21566                            %PROC_ADDRESS ( THING@P = "DAD$ -> QI$MAJOR_NODE.FATHER@P",
      562    21567                            CHECK_FOR_INDIRECTION = NO,
      563    21568                            RESULT$ = DAD$ );

  21586   0 0002F3  B846 0005                            LDR,R3   5,B6
          0 0002F5  F853                                 LDR,R7   R3
          0 0002F6  6C00                                 LDV,R6   0
          0 0002F7  8400 0000 0002  xsym                 AID      QI_1+2
          0 0002FA  8D47 0039                            SDI      DAD$,AUTO

      564    21605
      565    21606    6                       IF DAD$ ~= QI_1.CURRENT.NODE$

  21606   0 0002FC  ECC7 0039                            LDB,B6   DAD$,AUTO
          0 0002FE  ED80 0000 0080  xsym                 CMB,B6   QI_1+128
          0 000301  09E2                                 BNE      s:21513,SPREL

      566    21607    6                       THEN
      567    21608    6                         GOTO BOX_STEP_ACROSS_COUNT;
      568    21609
      569    21610    6                     END; /* IF DAD$ -> QI$MAJOR_NODE.BROTHER@P > 0 */

      570    21611
      571    21612    5                 END; /* IF DAD$ -> QI$MAJOR_NODE.SON@P > 0 */

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:81   
      572    21613
      573    21614    4               IF DAD$ -> QI$MINOR_NODE.SEPARATED > 0

  21614   0 000302  D846 0002                            LDR,R5   2,B6
          0 000304  5901 0005                            BEZ,R5   s:21619,PREL

      574    21615    4               THEN
      575    21616        /* HAVE SEPARATED CLAUSE                         */
      576    21617    4                 INX = DAD$ -> QI$MINOR_NODE.SEPARATED;

  21617   0 000306  DF47 005E                            STR,R5   INX,AUTO
          0 000308  0F81 0004                            B        s:21621,PREL

      577    21618    4               ELSE
      578    21619    4                 INX = 1;

  21619   0 00030A  4C01                                 LDV,R4   1
          0 00030B  CF47 005E                            STR,R4   INX,AUTO

      579    21620
      580    21621    4              IF QI_1.CURRENT.NODE_STATUS$ -> QI$MINOR_STATUS.GZ.FIELD_START_INDEX = 0

  21621   0 00030D  DC80 0000 0082  xsym                 LDB,B5   QI_1+130
          0 000310  C805                                 LDR,R4   ,B5
          0 000311  4981 000B                            BNEZ,R4  s:21629,PREL

      581    21622    4               THEN
      582    21623        /* SET ROW INCREMENT                             */
      583    21624    4                 QI_1.CURRENT.NODE_STATUS$ -> QI$MINOR_STATUS.GZ.FIELD_START_INDEX =

  21624   0 000313  A847 005E                            LDR,R2   INX,AUTO
          0 000315  AA47 002E                            ADD,R2   BOX_MAX_ROW,AUTO
          0 000317  A247 0030                            SUB,R2   BOX_MIN_ROW,AUTO
          0 000319  C852                                 LDR,R4   R2
          0 00031A  CF05                                 STR,R4   ,B5
          0 00031B  0F81 0014                            B        s:21640,PREL

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:82   
      584    21625    4                   INX
      585    21626    4                   + BOX_MAX_ROW - BOX_MIN_ROW;
      586    21627    4               ELSE
      587    21628        /* SET COLUMN INCREMENT                          */
      588    21629    4                 QI_1.CURRENT.NODE_STATUS$ -> QI$MINOR_STATUS.GZ.FIELD_STOP_INDEX =

  21629   0 00031D  A847 005E                            LDR,R2   INX,AUTO
          0 00031F  AA47 002D                            ADD,R2   BOX_MAX_COLUMN,AUTO
          0 000321  A247 002F                            SUB,R2   BOX_MIN_COLUMN,AUTO
          0 000323  AF45 0001                            STR,R2   1,B5

      589    21630    4                   INX
      590    21631    4                   + BOX_MAX_COLUMN - BOX_MIN_COLUMN;
      591    21632
      592    21633    4             END; /* IF DAD$ -> QI$MINOR_NODE.REPEATS > 0 */

  21633   0 000325  0F81 000A                            B        s:21640,PREL

      593    21634
      594    21635    3         CASE ( %QI#TYPE_MAJOR, %QI#TYPE_FRAME );

      595    21636
      596    21637    3         CASE ( ELSE );

      597    21638    3           CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );

  21638   0 000327  BB80 0000 0004  01                   LAB,B3   +4
          0 00032A  CBF0 0100                            LAB,B4   256,IMO
          0 00032C  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          0 00032F       0001                            DC       s:21640,PREL

      598    21639
      599    21640    3       END;

      600    21641
      601    21642    2   CHECK_STEP_DOWN_COUNT:
      602    21643    2       IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.SON@P > 0
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:83   

  21643   0 000330  EC80 0000 0080  xsym CHECK_STEP_DOWN*LDB,B6   QI_1+128
          0 000333  E846 0003                            LDR,R6   3,B6
          0 000335  6901 000D                            BEZ,R6   s:21693,PREL

      603    21644    2       THEN
      604    21645    3         DO;

      605    21646
      606    21647    3           CURRENT_FATHER$ = QI_1.CURRENT.NODE$;

  21647   0 000337  EFC7 0035                            STB,B6   CURRENT_FATHER$,AUTO

      607    21648
      608    21649                %PROC_ADDRESS ( THING@P = "QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.SON@P",
      609    21650                CHECK_FOR_INDIRECTION = NO,
      610    21651                RESULT$ = DAD$ );

  21669   0 000339  B856                                 LDR,R3   R6
          0 00033A  F853                                 LDR,R7   R3
          0 00033B  6C00                                 LDV,R6   0
          0 00033C  8400 0000 0002  xsym                 AID      QI_1+2
          0 00033F  8D47 0039                            SDI      DAD$,AUTO

      611    21688
      612    21689    3           GOTO NEXT_COUNT;

  21689   0 000341  0F81 FE0F                            B        s:21038,PREL

      613    21690
      614    21691    3         END;
      615    21692    2       ELSE
      616    21693    3         DO;

      617    21694
      618    21695    3   CHECK_STEP_ACROSS_COUNT:
      619    21696    3           IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.BROTHER@P > 0
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:84   

  21696   0 000343  EC80 0000 0080  xsym CHECK_STEP_ACRO*LDB,B6   QI_1+128
          0 000346  E846 0004                            LDR,R6   4,B6
          0 000348  6901 000B                            BEZ,R6   s:21746,PREL

      620    21697    3           THEN
      621    21698    4             DO;

      622    21699
      623    21700                    %PROC_ADDRESS ( THING@P =
             21700                        "QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.BROTHER@P",
      624    21701                    CHECK_FOR_INDIRECTION = NO,
      625    21702                    RESULT$ = DAD$ );

  21720   0 00034A  B856                                 LDR,R3   R6
          0 00034B  F853                                 LDR,R7   R3
          0 00034C  6C00                                 LDV,R6   0
          0 00034D  8400 0000 0002  xsym                 AID      QI_1+2
          0 000350  8D47 0039                            SDI      DAD$,AUTO

      626    21739
      627    21740    4               GOTO NEXT_COUNT;

  21740   0 000352  0F81 FDFE                            B        s:21038,PREL

      628    21741
      629    21742    4             END;
      630    21743    3           ELSE
      631    21744    4             DO;

      632    21745
      633    21746    4               IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.FATHER@P > 0

  21746   0 000354  D846 0005                            LDR,R5   5,B6
          0 000356  5901 0026                            BEZ,R5   s:21847,PREL
          0 000358  C806                                 LDR,R4   ,B6
          0 000359  C570 000F                            AND,R4   15,IMO
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:85   
          0 00035B  4D0A                                 CMV,R4   10
          0 00035C  0901 0020                            BE       s:21847,PREL

      634    21747    4                 AND QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.WORD0_FLAGS.TYPE ~= %
             21747                          QI#TYPE_FRAME
      635    21748    4               THEN
      636    21749    5                 DO;

      637    21750
      638    21751                        %PROC_ADDRESS ( THING@P =
             21751                            "QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.FATHER@P",
      639    21752                        CHECK_FOR_INDIRECTION = NO,
      640    21753                        RESULT$ = "QI_1.CURRENT.NODE$" );

  21771   0 00035E  B855                                 LDR,R3   R5
          0 00035F  F853                                 LDR,R7   R3
          0 000360  6C00                                 LDV,R6   0
          0 000361  8400 0000 0002  xsym                 AID      QI_1+2
          0 000364  8D00 0000 0080  xsym                 SDI      QI_1+128

      641    21790
      642    21791    5                   IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.FATHER@P > 0

  21791   0 000367  EC80 0000 0080  xsym                 LDB,B6   QI_1+128
          0 00036A  C846 0005                            LDR,R4   5,B6
          0 00036C  4901 000F                            BEZ,R4   s:21838,PREL
          0 00036E  A806                                 LDR,R2   ,B6
          0 00036F  A570 000F                            AND,R2   15,IMO
          0 000371  2D0A                                 CMV,R2   10
          0 000372  0901 0009                            BE       s:21838,PREL

      643    21792    5                     AND QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.WORD0_FLAGS.TYPE ~= %
             21792                              QI#TYPE_FRAME
      644    21793    5                   THEN
      645    21794    6                     DO;

      646    21795        /* GET FATHER                                    */
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:86   
      647    21796                            %PROC_ADDRESS ( THING@P =
             21796                                "QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.FATHER@P",
      648    21797                            CHECK_FOR_INDIRECTION = NO,
      649    21798                            RESULT$ = CURRENT_FATHER$ );

  21816   0 000374  9854                                 LDR,R1   R4
          0 000375  F851                                 LDR,R7   R1
          0 000376  6C00                                 LDV,R6   0
          0 000377  8400 0000 0002  xsym                 AID      QI_1+2
          0 00037A  8D47 0035                            SDI      CURRENT_FATHER$,AUTO

      650    21835
      651    21836    6                     END; /* IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.FATHER@P > 0 */

      652    21837
      653    21838    5                   GOTO CHECK_STEP_ACROSS_COUNT;

  21838   0 00037C  0FC7                                 B        s:21693,SPREL

      654    21839
      655    21840    5                 END; /* IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.FATHER@P > 0 */
      656    21841
      657    21842    4             END; /* IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.BROTHER@P > 0 */
      658    21843
      659    21844    3         END; /* IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.SON@P > 0 */
      660    21845
      661    21846        %EJECT;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:87   
      662    21847    2       MAX_FIELD_SIZE = MAX_FIELD_SIZE + 1;

  21847   0 00037D  8AC7 0066                            INC      MAX_FIELD_SIZE,AUTO

      663    21848
      664    21849    2       IF QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.HEADER$ = ADDR (NIL)

  21849   0 00037F  DC80 0000 007C  xsym                 LDB,B5   QI_1+124
          0 000382  8DC5 0004                            CMN      4,B5
          0 000384  0981 007F                            BNE      s:21893,PREL

      665    21850    2       THEN
      666    21851    2   MAKE_ROOM_FOR_THIS_FRAME:
      667    21852    3         DO;

  21852   0                              MAKE_ROOM_FOR_T*null
      668    21853
      669    21854    3           TOTAL_GZ_NEEDED = SIZEW (QI$GZ_HEADER)

  21854   0 000386  C847 003F            MAKE_ROOM_FOR_T*LDR,R4   FIELD_COUNT,AUTO
          0 000388  4F0C                                 MLV,R4   12
          0 000389  4E0B                                 ADV,R4   11
          0 00038A  CF47 0076                            STR,R4   TOTAL_GZ_NEEDED,AUTO

      670    21855    3             + ( FIELD_COUNT * SIZEW (QI$GZ_FIELD) );
      671    21856
      672    21857    3           TOTAL_GZ_SPACE = ( QI_VLP_SEGMENT.PAGES * 256 )

  21857   0 00038C  8C80 0000 006C  xsym                 LDI      QI_1+108
          0 00038F  8480 0000 0000  xsym                 SID      QI_VLP_SEGMENT
          0 000392  8D47 008A                            SDI      QCU@USE+18,AUTO
          0 000394  F800 0000 0002  xsym                 LDR,R7   QI_VLP_SEGMENT+2
          0 000397  6C00                                 LDV,R6   0
          0 000398  7088                                 DOL,R7   8
          0 000399  8656                                 CPL      R6
          0 00039A  8657                                 CPL      R7
          0 00039B  8470 0000 0001                       AID      1,IMO
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:88   
          0 00039E  8447 008A                            AID      QCU@USE+18,AUTO
          0 0003A0  8656                                 CPL      R6
          0 0003A1  8657                                 CPL      R7
          0 0003A2  8470 0000 0001                       AID      1,IMO
          0 0003A5  E857                                 LDR,R6   R7
          0 0003A6  EF47 0077                            STR,R6   TOTAL_GZ_SPACE,AUTO

      673    21858    3             - ( POFFW ( QI_1.GZ.AVAILABLE$, QI_VLP_SEGMENT.BASE$ ) );
      674    21859
      675    21860    3           IF TOTAL_GZ_NEEDED > TOTAL_GZ_SPACE

  21860   0 0003A8  C956                                 CMR,R4   R6
          0 0003A9  0381 0027                            BLE      s:21877,PREL

      676    21861    3           THEN
      677    21862    3   GDS_SOME_MEMORY:
      678    21863    4             DO;

  21863   0                              GDS_SOME_MEMORY null
      679    21864
      680    21865    4               FPT@GDS = QI_FPT_GDS;

  21865   0 0003AB  AB80 0000 0000  xsym GDS_SOME_MEMORY LAB,B2   QI_FPT_GDS
          0 0003AE  2C00                                 LDV,R2   0
          0 0003AF  6C10                                 LDV,R6   16
          0 0003B0  BB87                                 LAB,B3   ,AUTO
          0 0003B1  3C2A                                 LDV,R3   42
          0 0003B2  0008                                 MMM

      681    21866    4               VBASE ( FPT@GDS.V_ ) = ADDR ( FPT@GDS.V );

  21866   0 0003B3  EBC7 001B                            LAB,B6   FPT@GDS+6,AUTO
          0 0003B5  EFC7 0016                            STB,B6   FPT@GDS+1,AUTO

      682    21867    4               FPT@GDS.V.PAGES = ( ( TOTAL_GZ_NEEDED - TOTAL_GZ_SPACE ) / 256 ) + 1;

  21867   0 0003B7  E847 0076                            LDR,R6   TOTAL_GZ_NEEDED,AUTO
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:89   
          0 0003B9  E247 0077                            SUB,R6   TOTAL_GZ_SPACE,AUTO
          0 0003BB  E370 0100                            DIV,R6   256,IMO
          0 0003BD  6E01                                 ADV,R6   1
          0 0003BE  EF47 001B                            STR,R6   FPT@GDS+6,AUTO

      683    21868
      684    21869    4               CALL M$GDS ( FPT@GDS )

  21869   0 0003C0  BBC7 0015                            LAB,B3   FPT@GDS,AUTO
          0 0003C2  B870 0902                            LDR,R3   2306,IMO
          0 0003C4  0001                                 MCL
          0 0003C5       0003                            DC       s:21872,PREL
          0 0003C6  0F81 000A                            B        s:21877,PREL

      685    21870    4               WHENALTRETURN
      686    21871    5                 DO;

      687    21872    5                   CALL QCE$ERROR ( %E$INSUFFICIENT_MEMORY );

  21872   0 0003C8  BB80 0000 0007  01                   LAB,B3   +7
          0 0003CB  CBF0 0100                            LAB,B4   256,IMO
          0 0003CD  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR
          0 0003D0       0001                            DC       s:21877,PREL

      688    21873    5                 END;

      689    21874
      690    21875    4             END GDS_SOME_MEMORY;

      691    21876
      692    21877    3           GZ_HEADER$ = QI_1.GZ.AVAILABLE$;

  21877   0 0003D1  EC80 0000 006C  xsym                 LDB,B6   QI_1+108
          0 0003D4  EFC7 0054                            STB,B6   GZ_HEADER$,AUTO

      693    21878    3           QI_1.GZ.AVAILABLE$ = PINCRW ( QI_1.GZ.AVAILABLE$, TOTAL_GZ_NEEDED );

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:90   
  21878   0 0003D6  F847 0076                            LDR,R7   TOTAL_GZ_NEEDED,AUTO
          0 0003D8  6C00                                 LDV,R6   0
          0 0003D9  8400 0000 006C  xsym                 AID      QI_1+108
          0 0003DC  8D00 0000 006C  xsym                 SDI      QI_1+108

      694    21879
      695    21880        /* BUILD HEADER PART                             */
      696    21881    3           GZ_HEADER$ -> QI$GZ_HEADER = '0'B;

  21881   0 0003DF  5C16                                 LDV,R5   22
          0 0003E0  0021                                 ALR      ;
          0 0003E1       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          0 0003E3       4006 0000                                ALPHANUM(0,B6,,R5,FILL)

      697    21882
      698    21883    3           GZ_HEADER$ -> QI$GZ_HEADER.IS_ACTIVE = %YES;

  21883   0 0003E5  437F                                 CSYNC    s:21881+5,SPREL
          0 0003E6  ECC7 0054                            LDB,B6   GZ_HEADER$,AUTO
          0 0003E8  8906                                 LBT,'8000'X       ,B6
          0 0003E9       8000

      699    21884    3           GZ_HEADER$ -> QI$GZ_HEADER.DCB# = QI_1.CURRENT.FORM$ -> QI$FORM_FILE.DCB#;

  21884   0 0003EA  DC80 0000 0076  xsym                 LDB,B5   QI_1+118
          0 0003ED  E845 0008                            LDR,R6   8,B5
          0 0003EF  EF46 0003                            STR,R6   3,B6

      700    21885    3           GZ_HEADER$ -> QI$GZ_HEADER.FIELD_COUNT = FIELD_COUNT;

  21885   0 0003F1  C847 003F                            LDR,R4   FIELD_COUNT,AUTO
          0 0003F3  CF46 0004                            STR,R4   4,B6

      701    21886    3           GZ_HEADER$ -> QI$GZ_HEADER.FRAME_DAD$ = QI_1.CURRENT.FRAME$;

  21886   0 0003F5  DC80 0000 007A  xsym                 LDB,B5   QI_1+122
          0 0003F8  DFC6 0005                            STB,B5   5,B6
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:91   

      702    21887    3           GZ_HEADER$ -> QI$GZ_HEADER.BACK_LINK$ = QI_1.GZ.LAST_HEADER$;

  21887   0 0003FA  CC80 0000 006A  xsym                 LDB,B4   QI_1+106
          0 0003FD  CFC6 0001                            STB,B4   1,B6

      703    21888    3           QI_1.GZ.LAST_HEADER$ = GZ_HEADER$;

  21888   0 0003FF  EF80 0000 006A  xsym                 STB,B6   QI_1+106

      704    21889
      705    21890    3         END MAKE_ROOM_FOR_THIS_FRAME;

  21890   0 000402  0F81 0007                            B        s:21903,PREL

      706    21891    2       ELSE
      707    21892    2   THERES_ALREADY_SOME_ROOM:
      708    21893    3         DO;

  21893   0                              THERES_ALREADY_*null
      709    21894
      710    21895    3           GZ_HEADER$ = QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.HEADER$;

  21895   0 000404  CCC5 0004            THERES_ALREADY_*LDB,B4   4,B5
          0 000406  CFC7 0054                            STB,B4   GZ_HEADER$,AUTO

      711    21896
      712    21897        /* Use the old header                            */
      713    21898    3           GZ_HEADER$ -> QI$GZ_HEADER.IS_ACTIVE = %YES;

  21898   0 000408  8904                                 LBT,'8000'X       ,B4
  21898   0 000409       8000

      714    21899
      715    21900    3         END THERES_ALREADY_SOME_ROOM;

      716    21901
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:92   
      717    21902        /* BUILD QI$GZ_FIELD ENTRIES                   */
      718    21903    2       GZ_FIELD$ = PINCRW ( GZ_HEADER$, SIZEW (QI$GZ_HEADER) );

  21903   0 00040A  ECC7 0054                            LDB,B6   GZ_HEADER$,AUTO
          0 00040C  DBC6 000B                            LAB,B5   11,B6
          0 00040E  DFC7 0052                            STB,B5   GZ_FIELD$,AUTO

      719    21904
      720    21905    2       NEXT_INDEX = 0;

  21905   0 000410  8747 0068                            CL       NEXT_INDEX,AUTO

      721    21906
      722    21907    2       ROW_REPEATS$ = ADDR (NIL);

  21907   0 000412  CB80 0000 0000                       LAB,B4   0
          0 000415  CFC7 0071                            STB,B4   ROW_REPEATS$,AUTO

      723    21908    2       ROW_INDEX_STOP = 0;

  21908   0 000417  8747 0075                            CL       ROW_INDEX_STOP,AUTO

      724    21909
      725    21910        /* SET UP NEXT ROW VALUE AND NEXT COLUMN VALUE   */
      726    21911    2       FRAME_ROW = QI_1.CURRENT.FRAME$ -> QI$FRAME.LINE_ORIGIN - 1;

  21911   0 000419  BC80 0000 007A  xsym                 LDB,B3   QI_1+122
          0 00041C  E843 0001                            LDR,R6   1,B3
          0 00041E  6EFF                                 ADV,R6   -1
          0 00041F  EF47 004F                            STR,R6   FRAME_ROW,AUTO

      727    21912    2       FRAME_COLUMN = QI_1.CURRENT.FRAME$ -> QI$FRAME.COLUMN_ORIGIN - 1;

  21912   0 000421  D843 0002                            LDR,R5   2,B3
          0 000423  5EFF                                 ADV,R5   -1
          0 000424  DF47 004D                            STR,R5   FRAME_COLUMN,AUTO

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:93   
      728    21913
      729    21914    2       QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.HEADER$ = GZ_HEADER$;

  21914   0 000426  AC80 0000 007C  xsym                 LDB,B2   QI_1+124
          0 000429  EFC2 0004                            STB,B6   4,B2

      730    21915    2       QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.START$ = GZ_FIELD$;

  21915   0 00042B  BC80 0000 007C  xsym                 LDB,B3   QI_1+124
          0 00042E  DFC3 0006                            STB,B5   6,B3

      731    21916    2       QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.STOP$ =

  21916   0 000430  F847 003F                            LDR,R7   FIELD_COUNT,AUTO
          0 000432  6C00                                 LDV,R6   0
          0 000433  9B80 0000 0009  01                   LAB,B1   +9
          0 000436  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          0 000439  8447 0052                            AID      GZ_FIELD$,AUTO
          0 00043B  8470 FFFF FFF4                       AID      -12,IMO
          0 00043E  EC80 0000 007C  xsym                 LDB,B6   QI_1+124
          0 000441  8D46 0008                            SDI      8,B6

      732    21917    2         PINCRW ( GZ_FIELD$, ( FIELD_COUNT - 1 ) * SIZEW (QI$GZ_FIELD) );
      733    21918    2      QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.FIELD_START_INDEX = NEXT_INDEX;

  21918   0 000443  EC80 0000 007C  xsym                 LDB,B6   QI_1+124
          0 000446  E847 0068                            LDR,R6   NEXT_INDEX,AUTO
          0 000448  EF06                                 STR,R6   ,B6

      734    21919    2       IF NOT QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.CURRENT.USAGE.ACTIVATED

  21919   0 000449  EC80 0000 007C  xsym                 LDB,B6   QI_1+124
          0 00044C  82C6 000A                            LB,'0400'X        10,B6
          0 00044E       0400
          0 00044F  0501 0006                            BBT      s:21924,PREL

      735    21920    2       THEN
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:94   
      736    21921    2         QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.FLDID_START

  21921   0 000451  D800 0000 006E  xsym                 LDR,R5   QI_1+110
          0 000454  DF46 0002                            STR,R5   2,B6

      737    21922            /*  = QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.GZ.NEXT_AVAILABLE_FLDID;  */
      738    21923    2           = QI_1.GZ.NEXT_AVAILABLE_FLDID;
      739    21924    2       QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.FORM_BACK_LINK@P =

  21924   0 000456  8C80 0000 0076  xsym                 LDI      QI_1+118
          0 000459  8480 0000 0002  xsym                 SID      QI_1+2
          0 00045C  EC80 0000 007C  xsym                 LDB,B6   QI_1+124
          0 00045F  E857                                 LDR,R6   R7
          0 000460  EF46 000B                            STR,R6   11,B6

      740    21925    2         POFFW ( QI_1.CURRENT.FORM$, QI_1.BASE.PROC$ );
      741    21926
      742    21927            %PROC_ADDRESS ( THING@P = "QI_1.CURRENT.FRAME$ -> QI$FRAME.SON@P",
      743    21928            CHECK_FOR_INDIRECTION = NO,
      744    21929            RESULT$ = DAD$ );

  21947   0 000462  EC80 0000 007A  xsym                 LDB,B6   QI_1+122
          0 000465  B846 0003                            LDR,R3   3,B6
          0 000467  F853                                 LDR,R7   R3
          0 000468  6C00                                 LDV,R6   0
          0 000469  8400 0000 0002  xsym                 AID      QI_1+2
          0 00046C  8D47 0039                            SDI      DAD$,AUTO

      745    21966
      746    21967    2   NEXT_BUILD:
      747    21968    2       QI_1.CURRENT.NODE$ = DAD$;

  21968   0 00046E  ECC7 0039            NEXT_BUILD      LDB,B6   DAD$,AUTO
          0 000470  EF80 0000 0080  xsym                 STB,B6   QI_1+128

      748    21969
      749    21970            %DATA_ADDRESS ( THING@D = "DAD$ -> QI$MAJOR_NODE.STATUS_AREA@D",
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:95   
      750    21971            CHECK_FOR_INDIRECTION = NO,
      751    21972            RESULT$ = "QI_1.CURRENT.NODE_STATUS$" );

  21990   0 000473  B846 0006                            LDR,R3   6,B6
          0 000475  F853                                 LDR,R7   R3
          0 000476  6C00                                 LDV,R6   0
          0 000477  8400 0000 0000  xsym                 AID      QI_1
          0 00047A  8D00 0000 0082  xsym                 SDI      QI_1+130

      752    22009
      753    22010    2       ROW_INCREMENT = QI_1.CURRENT.NODE_STATUS$ -> QI$FIELD_STATUS.GZ.
             22010                FIELD_START_INDEX;

  22010   0 00047D  DC80 0000 0082  xsym                 LDB,B5   QI_1+130
          0 000480  D805                                 LDR,R5   ,B5
          0 000481  DF47 0070                            STR,R5   ROW_INCREMENT,AUTO

      754    22011    2       COLUMN_INCREMENT = QI_1.CURRENT.NODE_STATUS$ -> QI$FIELD_STATUS.GZ.
             22011                FIELD_STOP_INDEX;

  22011   0 000483  C845 0001                            LDR,R4   1,B5
          0 000485  CF47 0031                            STR,R4   COLUMN_INCREMENT,AUTO

      755    22012
      756    22013        /* GET ELEMENT COUNT                             */
      757    22014    2       QI_1.CURRENT.NODE_STATUS$ -> QI$MAJOR_STATUS.GZ.FIELD_START_INDEX = NEXT_INDEX;

  22014   0 000487  D847 0068                            LDR,R5   NEXT_INDEX,AUTO
          0 000489  DF05                                 STR,R5   ,B5

      758    22015
      759    22016    3       DO CASE ( DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.TYPE );

  22016   0 00048A  A806                                 LDR,R2   ,B6
          0 00048B  A570 000F                            AND,R2   15,IMO
          0 00048D  2D0B                                 CMV,R2   11
          0 00048E  0281 01DC                            BGE      s:22332,PREL
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:96   
          0 000490  9820 0000 0496  00                   LDR,R1   s:22016+12,R2
          0 000493  8390 0000 04A1  00                   JMP      s:22019,R1
          0 000496       0000                            DC       s:22019,PREL
          0 000497       01CA                            DC       s:22332,PREL
          0 000498       01CA                            DC       s:22332,PREL
          0 000499       0009                            DC       s:22024,PREL
          0 00049A       01CA                            DC       s:22332,PREL
          0 00049B       01CA                            DC       s:22332,PREL
          0 00049C       01CA                            DC       s:22332,PREL
          0 00049D       01CA                            DC       s:22332,PREL
          0 00049E       01B2                            DC       s:22311,PREL
          0 00049F       01D3                            DC       s:22334,PREL
          0 0004A0       01D3                            DC       s:22334,PREL

      760    22017
      761    22018    3         CASE ( %QI#TYPE_DISPLAY );

      762    22019    3           FIELD_BYTE_SIZE = DAD$ -> QI$FIELD_DAD.PSEUDO_CIP.NUMERIC.LEN;

  22019   0 0004A1  E846 0001                            LDR,R6   1,B6
          0 0004A3  6048                                 SOR,R6   8
          0 0004A4  E570 001F                            AND,R6   31,IMO
          0 0004A6  EF47 003D                            STR,R6   FIELD_BYTE_SIZE,AUTO

      763    22020
      764    22021    3           GOTO BUILD_CONTINUE;

  22021   0 0004A8  0F81 0007                            B        s:22027,PREL

      765    22022
      766    22023    3         CASE ( %QI#TYPE_ALPHANUMERIC );

      767    22024    3           FIELD_BYTE_SIZE = DAD$ -> QI$FIELD_DAD.PSEUDO_CIP.ALPHANUMERIC.LEN;

  22024   0 0004AA  E846 0001                            LDR,R6   1,B6
          0 0004AC  E570 3FFF                            AND,R6   16383,IMO
          0 0004AE  EF47 003D                            STR,R6   FIELD_BYTE_SIZE,AUTO
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:97   

      768    22025
      769    22026    3   BUILD_CONTINUE:
      770    22027    3           IF DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT > 0

  22027   0 0004B0  8286                 BUILD_CONTINUE  LB,'0030'X        ,B6
  22027   0 0004B1       0030
          0 0004B2  0581 004A                            BBF      s:22107,PREL

      771    22028    3           THEN
      772    22029    4             DO;

      773    22030
      774    22031    4               FIELD_DIM_CNT = DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT;

  22031   0 0004B4  E806                                 LDR,R6   ,B6
          0 0004B5  6044                                 SOR,R6   4
          0 0004B6  E570 0003                            AND,R6   3,IMO
          0 0004B8  EF47 0042                            STR,R6   FIELD_DIM_CNT,AUTO

      775    22032
      776    22033        /* HAVE DIMENSIONS                               */
      777    22034    4               INX = DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT;

  22034   0 0004BA  EF47 005E                            STR,R6   INX,AUTO

      778    22035
      779    22036                    /*  Increment past any level_multipliers to get to the
      780    22037                        P.whatever flags.  */
      781    22038    4               FIELD_DAD_P$ = ADDR ( DAD$ -> QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS.
             22038                        LEVEL_MULTIPLIER_A ( INX ) );

  22038   0 0004BC  B856                                 LDR,R3   R6
          0 0004BD  3001                                 SOL,R3   1
          0 0004BE  3E0B                                 ADV,R3   11
          0 0004BF  DBB6                                 LAB,B5   ,B6,R3
          0 0004C0  DFC7 0040                            STB,B5   FIELD_DAD_P$,AUTO
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:98   

      782    22039
      783    22040    4               IF FIELD_DAD_P$ -> QI$FIELD_DAD_P.P.REPEATS

  22040   0 0004C2  8285                                 LB,'0800'X        ,B5
  22040   0 0004C3       0800
          0 0004C4  0581 0027                            BBF      s:22092,PREL

      784    22041    4               THEN
      785    22042    5                 DO;

      786    22043
      787    22044    5                   INX = INX - 1;

  22044   0 0004C6  88C7 005E                            DEC      INX,AUTO

      788    22045    5                   INX_A$ (INX) = ADDR (COLUMN_INDEX);

  22045   0 0004C8  CBC7 0032                            LAB,B4   COLUMN_INDEX,AUTO
          0 0004CA  BBC7 005F                            LAB,B3   INX_A$,AUTO
          0 0004CC  B847 005E                            LDR,R3   INX,AUTO
          0 0004CE  CFB3                                 STB,B4   ,B3,R3

      789    22046
      790    22047                        %PRESENCE_DISPLACEMENT (
      791    22048                        PRESENCE_THING$ = FIELD_DAD_P$,
      792    22049                        INDEX = P_ITEM_INDEX,
      793    22050                        START = %QI#P_FIELD_FIRST_INDEX,
      794    22051                        STOP = %QI#P_REPEATS_INDEX,
      795    22052                        RESULT = REPEATS_INDEX
      796    22053                        );

  22069   0 0004CF  8947 006F                            LBT,'FFFF'X       REPEATS_INDEX,AUTO
  22069   0 0004D1       FFFF

  22070   0 0004D2  8747 006E                            CL       P_ITEM_INDEX,AUTO

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:99   
  22071   0 0004D4  ECC7 0040                            LDB,B6   FIELD_DAD_P$,AUTO
          0 0004D6  B847 006E                            LDR,R3   P_ITEM_INDEX,AUTO
          0 0004D8  82B6                                 LB       ,B6,R3
          0 0004D9  0581 0003                            BBF      s:22074,PREL

  22073   0 0004DB  8AC7 006F                            INC      REPEATS_INDEX,AUTO

  22074   0 0004DD  8AC7 006E                            INC      P_ITEM_INDEX,AUTO
          0 0004DF  E847 006E                            LDR,R6   P_ITEM_INDEX,AUTO
          0 0004E1  6D04                                 CMV,R6   4
          0 0004E2  03F2                                 BLE      s:22071,SPREL

      797    22085
      798    22086    5                   COLUMN_INDEX_STOP = FIELD_DAD_P$ -> QI$FIELD_DAD_P.P_ITEM_A (
             22086                            REPEATS_INDEX ) - 1;

  22086   0 0004E3  B847 006F                            LDR,R3   REPEATS_INDEX,AUTO
          0 0004E5  3E01                                 ADV,R3   1
          0 0004E6  D836                                 LDR,R5   ,B6,R3
          0 0004E7  5EFF                                 ADV,R5   -1
          0 0004E8  DF47 0033                            STR,R5   COLUMN_INDEX_STOP,AUTO

      799    22087
      800    22088    5                 END;

  22088   0 0004EA  0F81 0016                            B        s:22113,PREL

      801    22089    4               ELSE
      802    22090    5                 DO;

      803    22091
      804    22092    5                   IF FIELD_DIM_CNT = 2

  22092   0 0004EC  6D02                                 CMV,R6   2
          0 0004ED  0981 000B                            BNE      s:22100,PREL

      805    22093    5                   THEN
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:100  
      806    22094    6                     DO;

      807    22095    6                       COLUMN_INDEX_STOP = COLUMN_STOP_GROUP;

  22095   0 0004EF  E847 0034                            LDR,R6   COLUMN_STOP_GROUP,AUTO
          0 0004F1  EF47 0033                            STR,R6   COLUMN_INDEX_STOP,AUTO

      808    22096
      809    22097    6                       INX_A$ (1) = ADDR (COLUMN_INDEX);

  22097   0 0004F3  CBC7 0032                            LAB,B4   COLUMN_INDEX,AUTO
          0 0004F5  CFC7 0061                            STB,B4   INX_A$+2,AUTO

      810    22098    6                     END;

  22098   0 0004F7  0F81 0009                            B        s:22113,PREL

      811    22099    5                   ELSE
      812    22100    5                     COLUMN_INDEX_STOP = 0;

  22100   0 0004F9  8747 0033                            CL       COLUMN_INDEX_STOP,AUTO

      813    22101
      814    22102    5                 END; /* IF FIELD_DAD_P$ -> QI$FIELD_DAD_P.P.REPEATS */

      815    22103
      816    22104    4             END;

  22104   0 0004FB  0F81 0005                            B        s:22113,PREL

      817    22105    3           ELSE
      818    22106    4             DO;

      819    22107    4               FIELD_DIM_CNT = 0;

  22107   0 0004FD  8747 0042                            CL       FIELD_DIM_CNT,AUTO

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:101  
      820    22108
      821    22109    4   SET_NO_REPEATS:
      822    22110    4               COLUMN_INDEX_STOP = 0;

  22110   0 0004FF  8747 0033            SET_NO_REPEATS  CL       COLUMN_INDEX_STOP,AUTO

      823    22111    4             END; /* IF DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT > 0 */

      824    22112
      825    22113    3           IF DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.IS_CONSTANT

  22113   0 000501  ECC7 0039                            LDB,B6   DAD$,AUTO
          0 000503  8286                                 LB,'0040'X        ,B6
          0 000504       0040
          0 000505  0581 000C                            BBF      s:22175,PREL

      826    22114    3           THEN
      827    22115                  %PROC_ADDRESS ( THING@P = "DAD$ -> QI$FIELD_DAD.PSEUDO_CIP.DATA@",
      828    22116                    CHECK_FOR_INDIRECTION = NO,
      829    22117                    RESULT$ = INIT_DATA$ );

  22135   0 000507  B846 0002                            LDR,R3   2,B6
          0 000509  F853                                 LDR,R7   R3
          0 00050A  6C00                                 LDV,R6   0
          0 00050B  8400 0000 0002  xsym                 AID      QI_1+2
          0 00050E  8D47 0058                            SDI      INIT_DATA$,AUTO

  22144   0 000510  0F81 000A                            B        s:22195,PREL

      830    22154    3           ELSE
      831    22155                  %DATA_ADDRESS ( THING@D = "DAD$ -> QI$FIELD_DAD.PSEUDO_CIP.DATA@",
      832    22156                    CHECK_FOR_INDIRECTION = NO,
      833    22157                    RESULT$ = INIT_DATA$ );

  22175   0 000512  B846 0002                            LDR,R3   2,B6
          0 000514  F853                                 LDR,R7   R3
          0 000515  6C00                                 LDV,R6   0
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:102  
          0 000516  8400 0000 0000  xsym                 AID      QI_1
          0 000519  8D47 0058                            SDI      INIT_DATA$,AUTO

      834    22194
      835    22195    3           INIT_FIELD_OFFSET = DAD$ -> QI$FIELD_DAD.PSEUDO_CIP.NUMERIC.CD.OFFSET;

  22195   0 00051B  D846 0001                            LDR,R5   1,B6
          0 00051D  504F                                 SOR,R5   15
          0 00051E  DF47 005B                            STR,R5   INIT_FIELD_OFFSET,AUTO

      836    22196
      837    22197    3           FIELD_ROW = FRAME_ROW + DAD$ -> QI$FIELD_DAD.POSITION.LINE;

  22197   0 000520  C847 004F                            LDR,R4   FRAME_ROW,AUTO
          0 000522  CA46 0008                            ADD,R4   8,B6
          0 000524  CF47 0046                            STR,R4   FIELD_ROW,AUTO

      838    22198    3           INIT_FIELD_COLUMN = FRAME_COLUMN + DAD$ -> QI$FIELD_DAD.POSITION.COLUMN;

  22198   0 000526  A847 004D                            LDR,R2   FRAME_COLUMN,AUTO
          0 000528  AA46 0009                            ADD,R2   9,B6
          0 00052A  AF47 005A                            STR,R2   INIT_FIELD_COLUMN,AUTO

      839    22199
      840    22200    4           DO ROW_INDEX = 0 TO ROW_INDEX_STOP;

  22200   0 00052C  8747 0074                            CL       ROW_INDEX,AUTO
          0 00052E  0F81 011C                            B        s:22306+2,PREL

      841    22201
      842    22202    4             FIELD_COLUMN = INIT_FIELD_COLUMN;

  22202   0 000530  E847 005A                            LDR,R6   INIT_FIELD_COLUMN,AUTO
          0 000532  EF47 003E                            STR,R6   FIELD_COLUMN,AUTO

      843    22203
      844    22204    5             DO COLUMN_INDEX = 0 TO COLUMN_INDEX_STOP;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:103  

  22204   0 000534  8747 0032                            CL       COLUMN_INDEX,AUTO
          0 000536  0F81 0106                            B        s:22302+2,PREL

      845    22205
      846    22206    5               GZ_FIELD$ -> QI$GZ_FIELD = '0'B;

  22206   0 000538  ECC7 0052                            LDB,B6   GZ_FIELD$,AUTO
          0 00053A  5C17                                 LDV,R5   23
          0 00053B  0021                                 ALR      ;
          0 00053C       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          0 00053E       4006 0000                                ALPHANUM(0,B6,,R5,FILL)

      847    22207
      848    22208    5               GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.POSITION.LINE = FIELD_ROW;

  22208   0 000540  437F                                 CSYNC    s:22206+7,SPREL
          0 000541  E847 0046                            LDR,R6   FIELD_ROW,AUTO
          0 000543  ECC7 0052                            LDB,B6   GZ_FIELD$,AUTO
          0 000545  E7C6 0003                            STH,R6   3,B6

      849    22209    5               GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.POSITION.COLUMN = FIELD_COLUMN;

  22209   0 000547  C847 003E                            LDR,R4   FIELD_COLUMN,AUTO
          0 000549  CAC6 0003                            SRM,R4,'00FF'X    3,B6
          0 00054B       00FF

      850    22210
      851    22211    5               FIELD_COLUMN = FIELD_COLUMN + COLUMN_INCREMENT;

  22211   0 00054C  CA47 0031                            ADD,R4   COLUMN_INCREMENT,AUTO
          0 00054E  CF47 003E                            STR,R4   FIELD_COLUMN,AUTO

      852    22212
      853    22213        /* SET IO/CONSTANT FLAGS                         */
      854    22214    5               GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.IO_FLAGS.IS_OUTPUT = DAD$ ->
             22214                        QI$FIELD_DAD.WORD0_FLAGS.IO_FLAGS.IS_OUTPUT;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:104  

  22214   0 000550  DCC7 0039                            LDB,B5   DAD$,AUTO
          0 000552  B805                                 LDR,R3   ,B5
          0 000553  3001                                 SOL,R3   1
          0 000554  BAC6 0002                            SRM,R3,'8000'X    2,B6
          0 000556       8000

      855    22215    5               GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.IO_FLAGS.IS_INPUT = DAD$ ->
             22215                        QI$FIELD_DAD.WORD0_FLAGS.IO_FLAGS.IS_INPUT;

  22215   0 000557  B805                                 LDR,R3   ,B5
          0 000558  3001                                 SOL,R3   1
          0 000559  BAC6 0002                            SRM,R3,'4000'X    2,B6
          0 00055B       4000

      856    22216    5               GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.IS_ENTRY_REQUIRED = DAD$ ->
             22216                        QI$FIELD_DAD.WORD0_FLAGS.IS_ENTRY_REQUIRED;

  22216   0 00055C  B805                                 LDR,R3   ,B5
          0 00055D  3001                                 SOL,R3   1
          0 00055E  BAC6 0002                            SRM,R3,'2000'X    2,B6
          0 000560       2000

      857    22217    5               GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.IS_OUTPUT_CONSTANT = DAD$ ->
             22217                        QI$FIELD_DAD.WORD0_FLAGS.IS_OUTPUT_CONSTANT;

  22217   0 000561  B805                                 LDR,R3   ,B5
          0 000562  3001                                 SOL,R3   1
          0 000563  BAC6 0002                            SRM,R3,'1000'X    2,B6
          0 000565       1000

      858    22218    5               GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.IS_AOIM = DAD$ -> QI$FIELD_DAD.
             22218                        WORD0_FLAGS.IS_AOIM;

  22218   0 000566  B805                                 LDR,R3   ,B5
          0 000567  3002                                 SOL,R3   2
          0 000568  BAC6 0002                            SRM,R3,'0800'X    2,B6
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:105  
          0 00056A       0800

      859    22219
      860    22220                    %IF QI#DEBUG;
      861    22221
      862    22222    5               IF DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.IO_FLAGS.IS_OUTPUT

  22222   0 00056B  8285                                 LB,'4000'X        ,B5
  22222   0 00056C       4000
          0 00056D  0581 0014                            BBF      s:22233,PREL

      863    22223    5               THEN
      864    22224    6                 DO;

      865    22225    6                   IF DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.IS_ENTRY_REQUIRED

  22225   0 00056F  8285                                 LB,'1000'X        ,B5
  22225   0 000570       1000
          0 000571  0581 002C                            BBF      s:22248,PREL
          0 000573  8285                                 LB,'2000'X        ,B5
          0 000574       2000
          0 000575  0501 0028                            BBT      s:22248,PREL

      866    22226    6                     AND NOT DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.IO_FLAGS.IS_INPUT
      867    22227    6                   THEN
      868    22228        /* ENTRY REQUIRED ON OUTPUT ONLY FIELD       */
      869    22229    6                     CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );

  22229   0 000577  BB80 0000 0004  01                   LAB,B3   +4
          0 00057A  CBF0 0100                            LAB,B4   256,IMO
          0 00057C  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          0 00057F       0001                            DC       s:22230,PREL

      870    22230    6                 END;

  22230   0 000580  0F81 001D                            B        s:22248,PREL

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:106  
      871    22231    5               ELSE
      872    22232    6                 DO;

      873    22233    6                   IF DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.IO_FLAGS.IS_INPUT

  22233   0 000582  8285                                 LB,'2000'X        ,B5
  22233   0 000583       2000
          0 000584  0581 0010                            BBF      s:22243,PREL

      874    22234    6                   THEN
      875    22235    7                     DO;

      876    22236    7                       IF DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.IS_CONSTANT

  22236   0 000586  8285                                 LB,'0040'X        ,B5
  22236   0 000587       0040
          0 000588  0581 0015                            BBF      s:22248,PREL

      877    22237    7                       THEN
      878    22238        /* CONSTANT INPUT FIELD                      */
      879    22239    7                         CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );

  22239   0 00058A  BB80 0000 0004  01                   LAB,B3   +4
          0 00058D  CBF0 0100                            LAB,B4   256,IMO
          0 00058F  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          0 000592       0001                            DC       s:22240,PREL

      880    22240    7                     END;

  22240   0 000593  0F81 000A                            B        s:22248,PREL

      881    22241    6                   ELSE
      882    22242        /* FIELD IS NOT INPUT OR OUTPUT              */
      883    22243    6                     CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );

  22243   0 000595  BB80 0000 0004  01                   LAB,B3   +4
          0 000598  CBF0 0100                            LAB,B4   256,IMO
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:107  
          0 00059A  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          0 00059D       0001                            DC       s:22248,PREL

      884    22244    6                 END;

      885    22245
      886    22246                    %ENDIF;
      887    22247
      888    22248    5               INDICATORS$ = PINCRW ( ADDR ( QI_1.CURRENT.NODE_STATUS$ ->
             22248                        QI$FIELD_STATUS.INDICATORS_A (0) ),

  22248   0 00059E  F847 0033                            LDR,R7   COLUMN_INDEX_STOP,AUTO
          0 0005A0  7E01                                 ADV,R7   1
          0 0005A1  FB47 0074                            MUL,R7   ROW_INDEX,AUTO
          0 0005A3  E857                                 LDR,R6   R7
          0 0005A4  EA47 0032                            ADD,R6   COLUMN_INDEX,AUTO
          0 0005A6  F856                                 LDR,R7   R6
          0 0005A7  6C00                                 LDV,R6   0
          0 0005A8  8400 0000 0082  xsym                 AID      QI_1+130
          0 0005AB  8470 0000 0002                       AID      2,IMO
          0 0005AE  8D47 0056                            SDI      INDICATORS$,AUTO

      889    22249    5                 ROW_INDEX * ( COLUMN_INDEX_STOP + 1 )
      890    22250    5                 + COLUMN_INDEX );
      891    22251    5               GZ_FIELD$ -> QI$GZ_FIELD.INDICATORS$ = INDICATORS$;

  22251   0 0005B0  ECC7 0056                            LDB,B6   INDICATORS$,AUTO
          0 0005B2  DCC7 0052                            LDB,B5   GZ_FIELD$,AUTO
          0 0005B4  EF85                                 STB,B6   ,B5

      892    22252
      893    22253    5               INDICATORS$ -> QI$INDICATORS.IS_ACTIVE = %YES;

  22253   0 0005B5  8906                                 LBT,'8000'X       ,B6
  22253   0 0005B6       8000

      894    22254    5               INDICATORS$ -> QI$INDICATORS.STATE_VALUE = %QI#STATE_NULL;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:108  

  22254   0 0005B7  8806                                 LBF,'1800'X       ,B6
  22254   0 0005B8       1800

      895    22255
      896    22256    5               IF QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.
             22256                        IS_OUTPUT

  22256   0 0005B9  CC80 0000 0078  xsym                 LDB,B4   QI_1+120
          0 0005BC  82C4 0008                            LB,'0400'X        8,B4
          0 0005BE       0400
          0 0005BF  0581 0007                            BBF      s:22261,PREL
          0 0005C1  89C5 0002                            CMZ      2,B5
          0 0005C3  0881 0003                            BAGE     s:22261,PREL

      897    22257    5                 AND GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.IO_FLAGS.IS_OUTPUT
      898    22258    5               THEN
      899    22259    5                 INDICATORS$ -> QI$INDICATORS.ENABLED_FLAGS.IS_OUTPUT = %YES;

  22259   0 0005C5  8906                                 LBT,'4000'X       ,B6
  22259   0 0005C6       4000

      900    22260
      901    22261    5               IF QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.
             22261                        IS_INPUT

  22261   0 0005C7  CC80 0000 0078  xsym                 LDB,B4   QI_1+120
          0 0005CA  82C4 0008                            LB,'0200'X        8,B4
          0 0005CC       0200
          0 0005CD  0581 000B                            BBF      s:22266,PREL
          0 0005CF  82C5 0002                            LB,'4000'X        2,B5
          0 0005D1       4000
          0 0005D2  0581 0006                            BBF      s:22266,PREL

      902    22262    5                 AND GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.IO_FLAGS.IS_INPUT
      903    22263    5               THEN
      904    22264    5                INDICATORS$ -> QI$INDICATORS.ENABLED_FLAGS.IS_INPUT = ITS_AN_ACTIVATE;
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:109  

  22264   0 0005D4  D847 0065                            LDR,R5   ITS_AN_ACTIVATE,AUTO
          0 0005D6  5042                                 SOR,R5   2
          0 0005D7  DA86                                 SRM,R5,'2000'X    ,B6
          0 0005D8       2000

      905    22265
      906    22266    5               IF QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.
             22266                        IS_OUTPUT

  22266   0 0005D9  CC80 0000 0078  xsym                 LDB,B4   QI_1+120
          0 0005DC  82C4 0008                            LB,'0400'X        8,B4
          0 0005DE       0400
          0 0005DF  0581 000E                            BBF      s:22273,PREL
          0 0005E1  89C5 0002                            CMZ      2,B5
          0 0005E3  0881 000A                            BAGE     s:22273,PREL
          0 0005E5  82C5 0002                            LB,'1000'X        2,B5
          0 0005E7       1000
          0 0005E8  0581 0005                            BBF      s:22273,PREL

      907    22267    5                 AND GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.IO_FLAGS.IS_OUTPUT
      908    22268    5                 AND GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.IS_OUTPUT_CONSTANT
      909    22269    5               THEN
      910    22270    5                 INDICATORS$ -> QI$INDICATORS.STATE_VALUE = %QI#STATE_AVAIL_OUTPUT;

  22270   0 0005EA  D870 0800                            LDR,R5   2048,IMO
          0 0005EC  DA86                                 SRM,R5,'1800'X    ,B6
          0 0005ED       1800

      911    22271
      912    22272        /* Set up VISUAL-ATTRIBUTEs                      */
      913    22273    5              GZ_FIELD$ -> QI$GZ_FIELD.STATUS.VISUAL_ATTRIBUTE = DAD$ -> QI$FIELD_DAD.
             22273                        VISUAL_ATTRIBUTE;

  22273   0 0005EE  CCC7 0039                            LDB,B4   DAD$,AUTO
          0 0005F0  D844 000A                            LDR,R5   10,B4
          0 0005F2  D570 00FF                            AND,R5   255,IMO
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:110  
          0 0005F4  D7C5 0007                            STH,R5   7,B5

      914    22274
      915    22275        /* SET UP ADDRESSING VARIABLES                   */
      916    22276    5               GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.LENGTH = FIELD_BYTE_SIZE;

  22276   0 0005F6  D847 003D                            LDR,R5   FIELD_BYTE_SIZE,AUTO
          0 0005F8  DAC5 0002                            SRM,R5,'00FF'X    2,B5
          0 0005FA       00FF

      917    22277
      918    22278    5               DISP = INIT_FIELD_OFFSET;

  22278   0 0005FB  C847 005B                            LDR,R4   INIT_FIELD_OFFSET,AUTO
          0 0005FD  CF47 003B                            STR,R4   DISP,AUTO

      919    22279
      920    22280    5               IF FIELD_DIM_CNT > 0

  22280   0 0005FF  B847 0042                            LDR,R3   FIELD_DIM_CNT,AUTO
          0 000601  3901 001C                            BEZ,R3   s:22294,PREL

      921    22281    5               THEN
      922    22282    6                 DO;

      923    22283
      924    22284    7                   DO INX = 0 TO FIELD_DIM_CNT - 1;

  22284   0 000603  8747 005E                            CL       INX,AUTO
          0 000605  0F81 0013                            B        s:22290+2,PREL

      925    22285
      926    22286    7                     DISP = DISP

  22286   0 000607  EBC7 005F                            LAB,B6   INX_A$,AUTO
          0 000609  B847 005E                            LDR,R3   INX,AUTO
          0 00060B  DCB6                                 LDB,B5   ,B6,R3
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:111  
          0 00060C  ECC7 0039                            LDB,B6   DAD$,AUTO
          0 00060E  3001                                 SOL,R3   1
          0 00060F  3E0C                                 ADV,R3   12
          0 000610  F836                                 LDR,R7   ,B6,R3
          0 000611  FB05                                 MUL,R7   ,B5
          0 000612  E857                                 LDR,R6   R7
          0 000613  EA47 003B                            ADD,R6   DISP,AUTO
          0 000615  EF47 003B                            STR,R6   DISP,AUTO

      927    22287    7                       + ( DAD$ -> QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS.
             22287                                LEVEL_MULTIPLIER_A.ELEMENT_LENGTH (INX)
      928    22288    7                       * INX_A$ (INX) -> QI$UWORD_A (0) );
      929    22289
      930    22290    7                   END;

  22290   0 000617  8AC7 005E                            INC      INX,AUTO
          0 000619  E847 005E                            LDR,R6   INX,AUTO
          0 00061B  E947 0042                            CMR,R6   FIELD_DIM_CNT,AUTO
          0 00061D  026A                                 BL       s:22286,SPREL

      931    22291
      932    22292    6                 END;

      933    22293
      934    22294    5               GZ_FIELD$ -> QI$GZ_FIELD.STATUS.OFFSET = MOD ( DISP, 2 );

  22294   0 00061E  E847 003B                            LDR,R6   DISP,AUTO
          0 000620  E570 0001                            AND,R6   1,IMO
          0 000622  600F                                 SOL,R6   15
          0 000623  ECC7 0052                            LDB,B6   GZ_FIELD$,AUTO
          0 000625  EAC6 0006                            SRM,R6,'8000'X    6,B6
          0 000627       8000

      935    22295    5              GZ_FIELD$ -> QI$GZ_FIELD.STATUS.DATA$ = PINCRW ( INIT_DATA$, DISP / 2 );

  22295   0 000628  E847 003B                            LDR,R6   DISP,AUTO
          0 00062A  6041                                 SOR,R6   1
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:112  
          0 00062B  F856                                 LDR,R7   R6
          0 00062C  6C00                                 LDV,R6   0
          0 00062D  8447 0058                            AID      INIT_DATA$,AUTO
          0 00062F  8D46 0009                            SDI      9,B6

      936    22296
      937    22297    5               GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.FIELD_DAD$ = DAD$;

  22297   0 000631  DCC7 0039                            LDB,B5   DAD$,AUTO
          0 000633  DFC6 0004                            STB,B5   4,B6

      938    22298
      939    22299    5               NEXT_INDEX = NEXT_INDEX + 1;

  22299   0 000635  8AC7 0068                            INC      NEXT_INDEX,AUTO

      940    22300    5               GZ_FIELD$ = PINCRW ( GZ_FIELD$, SIZEW (QI$GZ_FIELD) );

  22300   0 000637  CBC6 000C                            LAB,B4   12,B6
          0 000639  CFC7 0052                            STB,B4   GZ_FIELD$,AUTO

      941    22301
      942    22302    5             END; /* DO COLUMN_INDEX = ... */

  22302   0 00063B  8AC7 0032                            INC      COLUMN_INDEX,AUTO
          0 00063D  E847 0032                            LDR,R6   COLUMN_INDEX,AUTO
          0 00063F  E947 0033                            CMR,R6   COLUMN_INDEX_STOP,AUTO
          0 000641  0381 FEF6                            BLE      s:22206,PREL

      943    22303
      944    22304    4             FIELD_ROW = FIELD_ROW + ROW_INCREMENT;

  22304   0 000643  D847 0046                            LDR,R5   FIELD_ROW,AUTO
          0 000645  DA47 0070                            ADD,R5   ROW_INCREMENT,AUTO
          0 000647  DF47 0046                            STR,R5   FIELD_ROW,AUTO

      945    22305
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:113  
      946    22306    4           END; /* DO ROW_INDEX = ... */

  22306   0 000649  8AC7 0074                            INC      ROW_INDEX,AUTO
          0 00064B  E847 0074                            LDR,R6   ROW_INDEX,AUTO
          0 00064D  E947 0075                            CMR,R6   ROW_INDEX_STOP,AUTO
          0 00064F  0381 FEE0                            BLE      s:22202,PREL

      947    22307
      948    22308    3           GOTO CHECK_STEP_ACROSS_BUILD;

  22308   0 000651  0F81 0033                            B        s:22385,PREL

      949    22309
      950    22310    3         CASE ( %QI#TYPE_MINOR );

      951    22311    3           IF DAD$ -> QI$MINOR_NODE.REPEATS > 0

  22311   0 000653  E846 0001                            LDR,R6   1,B6
          0 000655  6901 001E                            BEZ,R6   s:22334,PREL

      952    22312    3           THEN
      953    22313    4             DO;

      954    22314
      955    22315    4               IF ROW_REPEATS$ = ADDR(NIL)

  22315   0 000657  8DC7 0071                            CMN      ROW_REPEATS$,AUTO
          0 000659  0981 000C                            BNE      s:22325,PREL

      956    22316    4               THEN
      957    22317    5                 DO;

      958    22318    5                   INX_A$ (0) = ADDR (ROW_INDEX);

  22318   0 00065B  DBC7 0074                            LAB,B5   ROW_INDEX,AUTO
          0 00065D  DFC7 005F                            STB,B5   INX_A$,AUTO

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:114  
      959    22319
      960    22320    5                   ROW_INDEX_STOP = DAD$ -> QI$MINOR_NODE.REPEATS - 1;

  22320   0 00065F  6EFF                                 ADV,R6   -1
          0 000660  EF47 0075                            STR,R6   ROW_INDEX_STOP,AUTO

      961    22321
      962    22322    5                   ROW_REPEATS$ = DAD$;

  22322   0 000662  EFC7 0071                            STB,B6   ROW_REPEATS$,AUTO

      963    22323    5                 END;

  22323   0 000664  0F81 000F                            B        s:22334,PREL

      964    22324    4               ELSE
      965    22325    4                 COLUMN_STOP_GROUP = DAD$ -> QI$MINOR_NODE.REPEATS - 1;

  22325   0 000666  6EFF                                 ADV,R6   -1
          0 000667  EF47 0034                            STR,R6   COLUMN_STOP_GROUP,AUTO

      966    22326
      967    22327    4             END; /* IF DAD$ -> QI$MINOR_NODE.REPEATS > 0 */

  22327   0 000669  0F81 000A                            B        s:22334,PREL

      968    22328
      969    22329    3         CASE ( %QI#TYPE_MAJOR, %QI#TYPE_FRAME );

      970    22330
      971    22331    3         CASE ( ELSE );

      972    22332    3           CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );

  22332   0 00066B  BB80 0000 0004  01                   LAB,B3   +4
          0 00066E  CBF0 0100                            LAB,B4   256,IMO
          0 000670  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:115  
          0 000673       0001                            DC       s:22334,PREL

      973    22333
      974    22334    3       END;

      975    22335
      976    22336    2   CHECK_STEP_DOWN_BUILD:
      977    22337    2       IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.SON@P > 0

  22337   0 000674  EC80 0000 0080  xsym CHECK_STEP_DOWN*LDB,B6   QI_1+128
          0 000677  E846 0003                            LDR,R6   3,B6
          0 000679  6901 000B                            BEZ,R6   s:22385,PREL

      978    22338    2       THEN
      979    22339    3         DO;

      980    22340
      981    22341                %PROC_ADDRESS ( THING@P = "QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.SON@P",
      982    22342                CHECK_FOR_INDIRECTION = NO,
      983    22343                RESULT$ = DAD$ );

  22361   0 00067B  B856                                 LDR,R3   R6
          0 00067C  F853                                 LDR,R7   R3
          0 00067D  6C00                                 LDV,R6   0
          0 00067E  8400 0000 0002  xsym                 AID      QI_1+2
          0 000681  8D47 0039                            SDI      DAD$,AUTO

      984    22380
      985    22381    3           GOTO NEXT_BUILD;

  22381   0 000683  0F81 FDEA                            B        s:21956,PREL

      986    22382
      987    22383    3         END;
      988    22384    2       ELSE
      989    22385    3         DO;

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:116  
      990    22386
      991    22387    3   CHECK_STEP_ACROSS_BUILD:
      992    22388    3           QI_1.CURRENT.NODE_STATUS$ -> QI$MAJOR_STATUS.GZ.FIELD_STOP_INDEX =
             22388                    NEXT_INDEX - 1;

  22388   0 000685  EC80 0000 0082  xsym CHECK_STEP_ACRO*LDB,B6   QI_1+130
          0 000688  E847 0068                            LDR,R6   NEXT_INDEX,AUTO
          0 00068A  6EFF                                 ADV,R6   -1
          0 00068B  EF46 0001                            STR,R6   1,B6

      993    22389
      994    22390    3           IF QI_1.CURRENT.NODE$ = ROW_REPEATS$

  22390   0 00068D  EC80 0000 0080  xsym                 LDB,B6   QI_1+128
          0 000690  EDC7 0071                            CMB,B6   ROW_REPEATS$,AUTO
          0 000692  0981 0008                            BNE      s:22399,PREL

      995    22391    3           THEN
      996    22392    4             DO;

      997    22393        /* RESET ROW/LINE VARIABLES                      */
      998    22394    4               ROW_REPEATS$ = ADDR (NIL);

  22394   0 000694  DB80 0000 0000                       LAB,B5   0
          0 000697  DFC7 0071                            STB,B5   ROW_REPEATS$,AUTO

      999    22395    4               ROW_INDEX_STOP = 0;

  22395   0 000699  8747 0075                            CL       ROW_INDEX_STOP,AUTO

     1000    22396
     1001    22397    4             END;

     1002    22398
     1003    22399    3           IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.BROTHER@P > 0

  22399   0 00069B  D846 0004                            LDR,R5   4,B6
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:117  
          0 00069D  5901 000B                            BEZ,R5   s:22449,PREL

     1004    22400    3           THEN
     1005    22401    4             DO;

     1006    22402
     1007    22403                    %PROC_ADDRESS ( THING@P =
             22403                        "QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.BROTHER@P",
     1008    22404                    CHECK_FOR_INDIRECTION = NO,
     1009    22405                    RESULT$ = DAD$ );

  22423   0 00069F  B855                                 LDR,R3   R5
          0 0006A0  F853                                 LDR,R7   R3
          0 0006A1  6C00                                 LDV,R6   0
          0 0006A2  8400 0000 0002  xsym                 AID      QI_1+2
          0 0006A5  8D47 0039                            SDI      DAD$,AUTO

     1010    22442
     1011    22443    4               GOTO NEXT_BUILD;

  22443   0 0006A7  0F81 FDC6                            B        s:21956,PREL

     1012    22444
     1013    22445    4             END;
     1014    22446    3           ELSE
     1015    22447    4             DO;

     1016    22448
     1017    22449    4               IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.FATHER@P > 0

  22449   0 0006A9  C846 0005                            LDR,R4   5,B6
          0 0006AB  4901 001F                            BEZ,R4   s:22542,PREL
          0 0006AD  B806                                 LDR,R3   ,B6
          0 0006AE  B570 000F                            AND,R3   15,IMO
          0 0006B0  3D0A                                 CMV,R3   10
          0 0006B1  0901 0019                            BE       s:22542,PREL

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:118  
     1018    22450    4                 AND QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.WORD0_FLAGS.TYPE ~= %
             22450                          QI#TYPE_FRAME
     1019    22451    4               THEN
     1020    22452    5                 DO;

     1021    22453
     1022    22454                        %PROC_ADDRESS ( THING@P =
             22454                            "QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.FATHER@P",
     1023    22455                        CHECK_FOR_INDIRECTION = NO,
     1024    22456                        RESULT$ = "QI_1.CURRENT.NODE$" );

  22474   0 0006B3  A854                                 LDR,R2   R4
          0 0006B4  F852                                 LDR,R7   R2
          0 0006B5  6C00                                 LDV,R6   0
          0 0006B6  8400 0000 0002  xsym                 AID      QI_1+2
          0 0006B9  8D00 0000 0080  xsym                 SDI      QI_1+128

     1025    22493
     1026    22494                        %DATA_ADDRESS ( THING@D =
             22494                            "QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.STATUS_AREA@D",
     1027    22495                        CHECK_FOR_INDIRECTION = NO,
     1028    22496                        RESULT$ = "QI_1.CURRENT.NODE_STATUS$" );

  22514   0 0006BC  EC80 0000 0080  xsym                 LDB,B6   QI_1+128
          0 0006BF  B846 0006                            LDR,R3   6,B6
          0 0006C1  F853                                 LDR,R7   R3
          0 0006C2  6C00                                 LDV,R6   0
          0 0006C3  8400 0000 0000  xsym                 AID      QI_1
          0 0006C6  8D00 0000 0082  xsym                 SDI      QI_1+130

     1029    22533
     1030    22534    5                   GOTO CHECK_STEP_ACROSS_BUILD;

  22534   0 0006C9  0F81 FFBB                            B        s:22385,PREL

     1031    22535
     1032    22536    5                 END; /* IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.FATHER@P > 0 */
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:119  
     1033    22537
     1034    22538    4             END; /* IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.BROTHER@P > 0 */
     1035    22539
     1036    22540    3         END; /* IF QI_1.CURRENT.NODE$ -> QI$MAJOR_NODE.SON@P > 0 */
     1037    22541
     1038    22542    2      QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.FIELD_STOP_INDEX = NEXT_INDEX -
             22542                1;

  22542   0 0006CB  DC80 0000 007C  xsym                 LDB,B5   QI_1+124
          0 0006CE  EF45 0001                            STR,R6   1,B5

     1039    22543
     1040    22544            %IF QI#DEBUG;
     1041    22545
     1042    22546    2       IF NEXT_INDEX ~= FIELD_COUNT

  22546   0 0006D0  D847 0068                            LDR,R5   NEXT_INDEX,AUTO
          0 0006D2  D947 003F                            CMR,R5   FIELD_COUNT,AUTO
          0 0006D4  0901 000A                            BE       s:22550,PREL

     1043    22547    2       THEN
     1044    22548    2         CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );

  22548   0 0006D6  BB80 0000 0001  01                   LAB,B3   +1
          0 0006D9  CBF0 0100                            LAB,B4   256,IMO
          0 0006DB  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          0 0006DE       0001                            DC       s:22550,PREL

     1045    22549
     1046    22550    2       IF PINCRW ( GZ_FIELD$, - SIZEW (QI$GZ_FIELD) ) ~=

  22550   0 0006DF  ECC7 0052                            LDB,B6   GZ_FIELD$,AUTO
          0 0006E1  DBC6 FFF4                            LAB,B5   -12,B6
          0 0006E3  CC80 0000 007C  xsym                 LDB,B4   QI_1+124
          0 0006E6  DDC4 0008                            CMB,B5   8,B4
          0 0006E8  0901 000A                            BE       s:22557,PREL

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:120  
     1047    22551    2         QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.STOP$
     1048    22552    2       THEN
     1049    22553    2         CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );

  22553   0 0006EA  BB80 0000 0001  01                   LAB,B3   +1
          0 0006ED  CBF0 0100                            LAB,B4   256,IMO
          0 0006EF  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          0 0006F2       0001                            DC       s:22557,PREL

     1050    22554
     1051    22555            %ENDIF;
     1052    22556
     1053    22557    2       FPT@DCLFLD = QI_FPT_DCLFLD;

  22557   0 0006F3  AB80 0000 0000  xsym                 LAB,B2   QI_FPT_DCLFLD
          0 0006F6  2C00                                 LDV,R2   0
          0 0006F7  6C1C                                 LDV,R6   28
          0 0006F8  BB87                                 LAB,B3   ,AUTO
          0 0006F9  3C08                                 LDV,R3   8
          0 0006FA  0008                                 MMM

     1054    22558    2       VBASE ( FPT@DCLFLD.V_ ) = ADDR ( FPT@DCLFLD.V );

  22558   0 0006FB  EBC7 000D                            LAB,B6   FPT@DCLFLD+9,AUTO
          0 0006FD  EFC7 0005                            STB,B6   FPT@DCLFLD+1,AUTO

     1055    22559    2       FPT@DCLFLD.V.DCB# = QI_1.CURRENT.FORM$ -> QI$FORM_FILE.DCB#;

  22559   0 0006FF  DC80 0000 0076  xsym                 LDB,B5   QI_1+118
          0 000702  E845 0008                            LDR,R6   8,B5
          0 000704  E7C7 000D                            STH,R6   FPT@DCLFLD+9,AUTO

     1056    22560    2       FPT@DCLFLD.FLDATR_ = VECTOR ( VLP@FLDATR );

  22560   0 000706  CBC7 0012                            LAB,B4   VLP@FLDATR,AUTO
          0 000708  CFC7 008B                            STB,B4   QCU@USE+19,AUTO
          0 00070A  6C05                                 LDV,R6   5
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:121  
          0 00070B  EF47 008A                            STR,R6   QCU@USE+18,AUTO
          0 00070D  ABC7 008A                            LAB,B2   QCU@USE+18,AUTO
          0 00070F  2C00                                 LDV,R2   0
          0 000710  6C06                                 LDV,R6   6
          0 000711  BB87                                 LAB,B3   ,AUTO
          0 000712  3C14                                 LDV,R3   20
          0 000713  0008                                 MMM

     1057    22561    2       VLP@FLDATR = QI_VLP_FLDATR;

  22561   0 000714  AB80 0000 0000  xsym                 LAB,B2   QI_VLP_FLDATR
          0 000717  2C00                                 LDV,R2   0
          0 000718  6C06                                 LDV,R6   6
          0 000719  BB87                                 LAB,B3   ,AUTO
          0 00071A  3C24                                 LDV,R3   36
          0 00071B  0008                                 MMM

     1058    22562
     1059    22563    2       GZ_FIELD$ = PINCRW ( GZ_HEADER$, SIZEW (QI$GZ_HEADER) );

  22563   0 00071C  ECC7 0054                            LDB,B6   GZ_HEADER$,AUTO
          0 00071E  DBC6 000B                            LAB,B5   11,B6
          0 000720  DFC7 0052                            STB,B5   GZ_FIELD$,AUTO

     1060    22564
     1061    22565    2   DCL_THE_FIELDS:
     1062    22566    3       DO FIELD_INDEX = 0 TO GZ_HEADER$ -> QI$GZ_HEADER.FIELD_COUNT - 1;

  22566   0 000722  8747 0045            DCL_THE_FIELDS  CL       FIELD_INDEX,AUTO
          0 000724  0F81 0134                            B        s:22858+2,PREL

     1063    22567
     1064    22568    3   RE_DCL_A_FIELD:
     1065    22569    3         GZ_FIELD$ -> QI$GZ_FIELD.STATUS.FLDID =

  22569   0 000726  EC80 0000 007C  xsym RE_DCL_A_FIELD  LDB,B6   QI_1+124
          0 000729  E846 0002                            LDR,R6   2,B6
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:122  
          0 00072B  EA47 0045                            ADD,R6   FIELD_INDEX,AUTO
          0 00072D  DCC7 0052                            LDB,B5   GZ_FIELD$,AUTO
          0 00072F  EF45 0008                            STR,R6   8,B5

     1066    22570    3           QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.FLDID_START
     1067    22571    3           + FIELD_INDEX;
     1068    22572    3         FPT@DCLFLD.V.ID = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.FLDID;

  22572   0 000731  EF47 0010                            STR,R6   FPT@DCLFLD+12,AUTO

     1069    22573    3         FPT@DCLFLD.V.LIN = GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.POSITION.LINE;

  22573   0 000733  D2C5 0003                            LLH,R5   3,B5
          0 000735  DF47 000E                            STR,R5   FPT@DCLFLD+10,AUTO

     1070    22574    3         FPT@DCLFLD.V.CLM = GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.POSITION.COLUMN;

  22574   0 000737  C845 0003                            LDR,R4   3,B5
          0 000739  C570 00FF                            AND,R4   255,IMO
          0 00073B  CF47 000F                            STR,R4   FPT@DCLFLD+11,AUTO

     1071    22575    3         FPT@DCLFLD.V.WDT = GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.LENGTH;

  22575   0 00073D  B845 0002                            LDR,R3   2,B5
          0 00073F  B570 00FF                            AND,R3   255,IMO
          0 000741  B7C7 0011                            STH,R3   FPT@DCLFLD+13,AUTO

     1072    22576    3         VLP@FLDATR.QLF.CNS = GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.IS_OUTPUT_CONSTANT;

  22576   0 000743  B845 0002                            LDR,R3   2,B5
          0 000745  3044                                 SOR,R3   4
          0 000746  BAC7 0013                            SRM,R3,'0100'X    VLP@FLDATR+1,AUTO
          0 000748       0100

     1073    22577    3        VLP@FLDATR.QLF.MSTENT = GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.IS_ENTRY_REQUIRED
             22577                  ;

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:123  
  22577   0 000749  B845 0002                            LDR,R3   2,B5
          0 00074B  3044                                 SOR,R3   4
          0 00074C  BAC7 0013                            SRM,R3,'0200'X    VLP@FLDATR+1,AUTO
          0 00074E       0200

     1074    22578    3         VLP@FLDATR.ABSGRPRND = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.VISUAL_ATTRIBUTE;

  22578   0 00074F  B2C5 0007                            LLH,R3   7,B5
          0 000751  B7C7 0014                            STH,R3   VLP@FLDATR+2,AUTO

     1075    22579
     1076    22580    3         IF FPT@DCLFLD.V.DVBYTE.RRR

  22580   0 000753  82C7 000D                            LB,'0008'X        FPT@DCLFLD+9,AUTO
  22580   0 000755       0008
          0 000756  0581 00E9                            BBF      s:22851,PREL

     1077    22581    3         THEN
     1078    22582    3   RE_DCL_AN_OVERLAPPING_FIELD:
     1079    22583    4           DO;

  22583   0                              RE_DCL_AN_OVERL*null
     1080    22584    4             CALL M$DCLFLD ( FPT@DCLFLD )

  22584   0 000758  BBC7 0004            RE_DCL_AN_OVERL*LAB,B3   FPT@DCLFLD,AUTO
          0 00075A  B870 0D8F                            LDR,R3   3471,IMO
          0 00075C  0001                                 MCL
          0 00075D       0003                            DC       s:22608,PREL
          0 00075E  0F81 00DF                            B        s:22848,PREL

     1081    22585    4             WHENALTRETURN
     1082    22586    5               DO;

     1083    22587
     1084    22588                      %PROC_ADDRESS ( THING@P =
             22588             "GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.FIELD_DAD$ -> QI$FIELD_DAD.IDENTIFIER@P"
             22588                          ,
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:124  
     1085    22589                      CHECK_FOR_INDIRECTION = NO,
     1086    22590                      RESULT$ = FIELD_IDENTIFIER$ );

  22608   0 000760  ECC7 0052                            LDB,B6   GZ_FIELD$,AUTO
          0 000762  DCC6 0004                            LDB,B5   4,B6
          0 000764  B845 0007                            LDR,R3   7,B5
          0 000766  F853                                 LDR,R7   R3
          0 000767  6C00                                 LDV,R6   0
          0 000768  8400 0000 0002  xsym                 AID      QI_1+2
          0 00076B  8D47 0043                            SDI      FIELD_IDENTIFIER$,AUTO

     1087    22627
     1088    22628    6                 DO CASE ( QGB_PARAM.ERR.ERR# );

  22628   0 00076D  A800 0000 0006  xsym                 LDR,R2   QGB_PARAM+6
          0 000770  2043                                 SOR,R2   3
          0 000771  AA70 FA87                            ADD,R2   -1401,IMO
          0 000773  2D02                                 CMV,R2   2
          0 000774  0281 00C0                            BGE      s:22842,PREL
          0 000776  9820 0000 077C  00                   LDR,R1   s:22628+15,R2
          0 000779  8390 0000 077E  00                   JMP      s:22631,R1
          0 00077C       0000                            DC       s:22631,PREL
          0 00077D       0012                            DC       s:22642,PREL

     1089    22629
     1090    22630    6                   CASE ( %E$ILGFLDPST );

     1091    22631    6                     CALL QCE$ERROR ( %E$FIELD_SPACE_CADET,

  22631   0 00077E  CBF0 000F                            LAB,B4   15,IMO
          0 000780  BCC7 0043                            LDB,B3   FIELD_IDENTIFIER$,AUTO
          0 000782  BFC7 008C                            STB,B3   QCU@USE+20,AUTO
          0 000784  CFC7 008A                            STB,B4   QCU@USE+18,AUTO
          0 000786  BBC7 008A                            LAB,B3   QCU@USE+18,AUTO
          0 000788  CBF0 0200                            LAB,B4   512,IMO
          0 00078A  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR
          0 00078D       0001                            DC       s:22631+16,PREL
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:125  
          0 00078E  0F81 00AF                            B        s:22848,PREL

     1092    22632    6                       FIELD_IDENTIFIER$ -> QI$VARIABLE_IDENTIFIER );
     1093    22633
     1094    22634    6                   CASE ( %E$OVRLAPFLD );

     1095    22635                        /*  Very interesting problem.
     1096    22636                            A field which overlaps another has been M$DCLFLDed to obtain
     1097    22637                            the FLDID of the OTHER field.  But that other field may be
     1098    22638                            in a different FRame and/or FD.
     1099    22639                            Sooo:  loop through all the OPEN FDs, looking for an
     1100    22640                            ACTIVATEd FRame whose FLDID range encloses the FLDID of the
     1101    22641                            overlapped field.  */
     1102    22642    6                     FORM_FILE$ = QI_1.FILE_HEAD.FORM$;

  22642   0 000790  CC80 0000 0070  xsym                 LDB,B4   QI_1+112
          0 000793  CFC7 0047                            STB,B4   FORM_FILE$,AUTO

     1103    22643
     1104    22644    6   FIND_FORM_THATS_OVERLAPPED:
     1105    22645    7                     DO WHILE ( FORM_FILE$ ~= ADDR (NIL) );

  22645   0 000795  0F81 0094            FIND_FORM_THATS*B        s:22834,PREL

     1106    22646
     1107    22647    7   FIND_FRAME_THATS_OVERLAPPED:
     1108    22648    7                       DO FRAME_INDEX =
     1109    22649    8                         0 TO FORM_FILE$ -> QI$FORM_FILE.FRAME_COUNT - 1;

  22649   0 000797  8747 004E            FIND_FRAME_THAT*CL       FRAME_INDEX,AUTO
          0 000799  0F81 0079                            B        s:22790+2,PREL

     1110    22650
     1111    22651                              %PROC_ADDRESS ( THING@P =
             22651                                "FORM_FILE$ -> QI$FORM_FILE.FRAME_LIST_A@P ( FRAME_INDEX )"
             22651                                  ,
     1112    22652                              CHECK_FOR_INDIRECTION = NO,
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:126  
     1113    22653                              RESULT$ = FRAME$ );

  22671   0 00079B  ECC7 0047                            LDB,B6   FORM_FILE$,AUTO
          0 00079D  B847 004E                            LDR,R3   FRAME_INDEX,AUTO
          0 00079F  3E0B                                 ADV,R3   11
          0 0007A0  A836                                 LDR,R2   ,B6,R3
          0 0007A1  F852                                 LDR,R7   R2
          0 0007A2  6C00                                 LDV,R6   0
          0 0007A3  8400 0000 0002  xsym                 AID      QI_1+2
          0 0007A6  8D47 004B                            SDI      FRAME$,AUTO

     1114    22690
     1115    22691                              %DATA_ADDRESS ( THING@D = "FRAME$ -> QI$FRAME.STATUS_AREA@D",
     1116    22692                              CHECK_FOR_INDIRECTION = NO,
     1117    22693                              RESULT$ = FRAME_STATUS$ );

  22711   0 0007A8  DCC7 004B                            LDB,B5   FRAME$,AUTO
          0 0007AA  9845 0006                            LDR,R1   6,B5
          0 0007AC  F851                                 LDR,R7   R1
          0 0007AD  6C00                                 LDV,R6   0
          0 0007AE  8400 0000 0000  xsym                 AID      QI_1
          0 0007B1  8D47 0050                            SDI      FRAME_STATUS$,AUTO

     1118    22730
     1119    22731    8                         IF FRAME_STATUS$ -> QI$FRAME_STATUS.INDICATORS.IS_ACTIVE

  22731   0 0007B3  CCC7 0050                            LDB,B4   FRAME_STATUS$,AUTO
          0 0007B5  89C4 000C                            CMZ      12,B4
          0 0007B7  0881 0059                            BAGE     s:22790,PREL
          0 0007B9  BC80 0000 0000  xsym                 LDB,B3   G$ROS$
          0 0007BC  AC83                                 LDB,B2   ,B3
          0 0007BD  9C80 0000 0076  xsym                 LDB,B1   QI_1+118
          0 0007C0  B841 0008                            LDR,R3   8,B1
          0 0007C2  ECB2                                 LDB,B6   ,B2,R3
          0 0007C3  D844 0002                            LDR,R5   2,B4
          0 0007C5  D946 0021                            CMR,R5   33,B6
          0 0007C7  0301 0049                            BG       s:22790,PREL
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:127  
          0 0007C9  C844 0003                            LDR,R4   3,B4
          0 0007CB  C946 0021                            CMR,R4   33,B6
          0 0007CD  0201 0043                            BL       s:22790,PREL

     1120    22732    8                           AND FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.FLDID_START <=
     1121    22733    8                          DCBADDR ( QI_1.CURRENT.FORM$ -> QI$FORM_FILE.DCB# ) -> M$DCB
             22733                                    .FLDID
     1122    22734    8                           AND FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.FLDID_STOP >=
     1123    22735    8                          DCBADDR ( QI_1.CURRENT.FORM$ -> QI$FORM_FILE.DCB# ) -> M$DCB
             22735                                    .FLDID
     1124    22736    8                         THEN
     1125    22737    8   FIND_FIELD_THATS_OVERLAPPED:
     1126    22738    9                           DO;

  22738   0                              FIND_FIELD_THAT*null
     1127    22739
     1128    22740    9                            FIELD_INDEX = DCBADDR ( QI_1.CURRENT.FORM$ -> QI$FORM_FILE
             22740                                      .DCB# ) -> M$DCB.FLDID

  22740   0 0007CF  EC80 0000 0000  xsym FIND_FIELD_THAT*LDB,B6   G$ROS$
          0 0007D2  DC86                                 LDB,B5   ,B6
          0 0007D3  CC80 0000 0076  xsym                 LDB,B4   QI_1+118
          0 0007D6  B844 0008                            LDR,R3   8,B4
          0 0007D8  BCB5                                 LDB,B3   ,B5,R3
          0 0007D9  ACC7 0050                            LDB,B2   FRAME_STATUS$,AUTO
          0 0007DB  E843 0021                            LDR,R6   33,B3
          0 0007DD  E242 0002                            SUB,R6   2,B2
          0 0007DF  EF47 0045                            STR,R6   FIELD_INDEX,AUTO

     1129    22741    9                               - FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.FLDID_START;
     1130    22742    9                             GZ_FIELD$ = PINCRW ( FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.
             22742                                      START$,

  22742   0 0007E1  9CC2 0006                            LDB,B1   6,B2
          0 0007E3  9FC7 008A                            STB,B1   QCU@USE+18,AUTO
          0 0007E5  70F0                                 DAR,R7   16
          0 0007E6  9B80 0000 0009  01                   LAB,B1   +9
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:128  
          0 0007E9  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          0 0007EC  8447 008A                            AID      QCU@USE+18,AUTO
          0 0007EE  8D47 0052                            SDI      GZ_FIELD$,AUTO

     1131    22743    9                               FIELD_INDEX * SIZEW (QI$GZ_FIELD) );
     1132    22744
     1133    22745                                  %PROC_ADDRESS ( THING@P =
             22745             "GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.FIELD_DAD$ -> QI$FIELD_DAD.IDENTIFIER@P"
             22745                                      ,
     1134    22746                                  CHECK_FOR_INDIRECTION = NO,
     1135    22747                                  RESULT$ = OVERLAPPING_FIELD_IDENTIFIER$ );

  22765   0 0007F0  ECC7 0052                            LDB,B6   GZ_FIELD$,AUTO
          0 0007F2  DCC6 0004                            LDB,B5   4,B6
          0 0007F4  B845 0007                            LDR,R3   7,B5
          0 0007F6  F853                                 LDR,R7   R3
          0 0007F7  6C00                                 LDV,R6   0
          0 0007F8  8400 0000 0002  xsym                 AID      QI_1+2
          0 0007FB  8D47 006B                            SDI      OVERLAPPING_FIELD_IDENTIFIER$,AUTO

     1136    22784
     1137    22785    9                             CALL QCE$ERROR ( %E$FIELD_OVERLAPS,

  22785   0 0007FD  CBF0 000E                            LAB,B4   14,IMO
          0 0007FF  BCC7 006B                            LDB,B3   OVERLAPPING_FIELD_IDENTIFIER$,AUTO
          0 000801  BFC7 008E                            STB,B3   QCU@USE+22,AUTO
          0 000803  DCC7 0043                            LDB,B5   FIELD_IDENTIFIER$,AUTO
          0 000805  DFC7 008C                            STB,B5   QCU@USE+20,AUTO
          0 000807  CFC7 008A                            STB,B4   QCU@USE+18,AUTO
          0 000809  BBC7 008A                            LAB,B3   QCU@USE+18,AUTO
          0 00080B  CBF0 0300                            LAB,B4   768,IMO
          0 00080D  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR
          0 000810       0001                            DC       s:22790,PREL

     1138    22786    9                               FIELD_IDENTIFIER$ -> QI$VARIABLE_IDENTIFIER,
     1139    22787    9                               OVERLAPPING_FIELD_IDENTIFIER$ -> QI$VARIABLE_IDENTIFIER
             22787                                        );
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:129  
     1140    22788    9                           END FIND_FIELD_THATS_OVERLAPPED;

     1141    22789
     1142    22790    8                       END FIND_FRAME_THATS_OVERLAPPED;

  22790   0 000811  8AC7 004E                            INC      FRAME_INDEX,AUTO
          0 000813  ECC7 0047                            LDB,B6   FORM_FILE$,AUTO
          0 000815  E847 004E                            LDR,R6   FRAME_INDEX,AUTO
          0 000817  E946 0001                            CMR,R6   1,B6
          0 000819  0201 FF81                            BL       s:22671,PREL

     1143    22791
     1144    22792                            %DATA_ADDRESS ( THING@D =
             22792                                "FORM_FILE$ -> QI$FORM_FILE.STATUS_AREA@D",
     1145    22793                            CHECK_FOR_INDIRECTION = NO,
     1146    22794                            RESULT$ = FORM_STATUS$ );

  22812   0 00081B  B846 0006                            LDR,R3   6,B6
          0 00081D  F853                                 LDR,R7   R3
          0 00081E  6C00                                 LDV,R6   0
          0 00081F  8400 0000 0000  xsym                 AID      QI_1
          0 000822  8D47 0049                            SDI      FORM_STATUS$,AUTO

     1147    22831
     1148    22832    7                       FORM_FILE$ = FORM_STATUS$ -> QI$FORM_STATUS.FLINK$;

  22832   0 000824  DCC7 0049                            LDB,B5   FORM_STATUS$,AUTO
          0 000826  CCC5 0002                            LDB,B4   2,B5
          0 000828  CFC7 0047                            STB,B4   FORM_FILE$,AUTO

     1149    22833
     1150    22834    7                     END FIND_FORM_THATS_OVERLAPPED;

  22834   0 00082A  8DC7 0047                            CMN      FORM_FILE$,AUTO
          0 00082C  0981 FF6A                            BNE      s:22649,PREL

     1151    22835
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:130  
     1152    22836                        /*  If the "overlapped FRame" wasn't found, it must be the
     1153    22837                            current FRame (not yet IS_ACTIVE).  */
     1154    22838    6                     FRAME_STATUS$ = QI_1.CURRENT.FRAME_STATUS$;

  22838   0 00082E  EC80 0000 007C  xsym                 LDB,B6   QI_1+124
          0 000831  EFC7 0050                            STB,B6   FRAME_STATUS$,AUTO

     1155    22839    6                     GOTO FIND_FIELD_THATS_OVERLAPPED;

  22839   0 000833  0F81 FF9B                            B        s:22738,PREL

     1156    22840
     1157    22841    6                   CASE ( ELSE );

     1158    22842    6                     CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );

  22842   0 000835  BB80 0000 000C  01                   LAB,B3   +12
          0 000838  CBF0 0100                            LAB,B4   256,IMO
          0 00083A  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_M$INTERNAL
          0 00083D       0001                            DC       s:22848,PREL

     1159    22843
     1160    22844    6                 END;

     1161    22845
     1162    22846    5               END;

     1163    22847
     1164    22848    4           END RE_DCL_AN_OVERLAPPING_FIELD;

  22848   0 00083E  0F81 0012                            B        s:22856,PREL

     1165    22849    3         ELSE
     1166    22850    3   DCL_A_NORMAL_FIELD:
     1167    22851    4           DO;

  22851   0                              DCL_A_NORMAL_FI*null
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:131  
     1168    22852    4             CALL QGB$DCLFLD ( FPT@DCLFLD, QGB_PARAM )

  22852   0 000840  EB80 0000 0000  xsym DCL_A_NORMAL_FI*LAB,B6   QGB_PARAM
          0 000843  EFC7 008C                            STB,B6   QCU@USE+20,AUTO
          0 000845  CBC7 0004                            LAB,B4   FPT@DCLFLD,AUTO
          0 000847  CFC7 008A                            STB,B4   QCU@USE+18,AUTO
          0 000849  BBC7 008A                            LAB,B3   QCU@USE+18,AUTO
          0 00084B  CBF0 0200                            LAB,B4   512,IMO
          0 00084D  E380 0000 0000  xent                 LNJ,B6   QGB$DCLFLD
          0 000850       0027                            DC       s:22862,PREL

     1169    22853    4               ALTRET ( INITIAL_DCLFLD_ALTRET );
     1170    22854    4           END DCL_A_NORMAL_FIELD;

     1171    22855
     1172    22856    3         GZ_FIELD$ = PINCRW ( GZ_FIELD$, SIZEW (QI$GZ_FIELD) );

  22856   0 000851  ECC7 0052                            LDB,B6   GZ_FIELD$,AUTO
          0 000853  DBC6 000C                            LAB,B5   12,B6
          0 000855  DFC7 0052                            STB,B5   GZ_FIELD$,AUTO

     1173    22857
     1174    22858    3       END DCL_THE_FIELDS;

  22858   0 000857  8AC7 0045                            INC      FIELD_INDEX,AUTO
          0 000859  ECC7 0054                            LDB,B6   GZ_HEADER$,AUTO
          0 00085B  E847 0045                            LDR,R6   FIELD_INDEX,AUTO
          0 00085D  6801 FEC8                            BLZ,R6   s:22569,PREL
          0 00085F  E946 0004                            CMR,R6   4,B6
          0 000861  0201 FEC4                            BL       s:22569,PREL

     1175    22859
     1176    22860    2       CALL QGB$FLUSH ( , QGB_PARAM )

  22860   0 000863  CB80 0000 0000  xsym                 LAB,B4   QGB_PARAM
          0 000866  CFC7 008C                            STB,B4   QCU@USE+20,AUTO
          0 000868  BB80 0000 0000                       LAB,B3   0
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:132  
          0 00086B  BFC7 008A                            STB,B3   QCU@USE+18,AUTO
          0 00086D  BBC7 008A                            LAB,B3   QCU@USE+18,AUTO
          0 00086F  CBF0 0200                            LAB,B4   512,IMO
          0 000871  E380 0000 0000  xent                 LNJ,B6   QGB$FLUSH
          0 000874       0003                            DC       s:22862,PREL
          0 000875  0F81 0028                            B        s:22877,PREL

     1177    22861    2       WHENALTRETURN
     1178    22862    3         DO;

     1179    22863              /*  One of the QGB$DCLFLDs ALTRET'ed.
     1180    22864                  It's probably either an "overlapping" or an "off the screen"
     1181    22865                  error, so turn on RR, delete any fields already out there,
     1182    22866                  and try again.  */
     1183    22867    3   INITIAL_DCLFLD_ALTRET:
     1184    22868    3           FPT@DCLFLD.V.DVBYTE.RRR = %YES;

  22868   0 000877  8947 000D            INITIAL_DCLFLD_*LBT,'0008'X       FPT@DCLFLD+9,AUTO
  22868   0 000879       0008

     1185    22869    3           FIELD_INDEX = DCBADDR ( QI_1.CURRENT.FORM$ -> QI$FORM_FILE.DCB# ) -> M$DCB.
             22869                    FLDID

  22869   0 00087A  EC80 0000 0000  xsym                 LDB,B6   G$ROS$
          0 00087D  DC86                                 LDB,B5   ,B6
          0 00087E  CC80 0000 0076  xsym                 LDB,B4   QI_1+118
          0 000881  B844 0008                            LDR,R3   8,B4
          0 000883  BCB5                                 LDB,B3   ,B5,R3
          0 000884  AC80 0000 007C  xsym                 LDB,B2   QI_1+124
          0 000887  E843 0021                            LDR,R6   33,B3
          0 000889  E242 0002                            SUB,R6   2,B2
          0 00088B  EF47 0045                            STR,R6   FIELD_INDEX,AUTO

     1186    22870    3             - QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.FLDID_START;
     1187    22871    3          GZ_FIELD$ = PINCRW ( QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.START$
             22871                    ,

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:133  
  22871   0 00088D  9CC2 0006                            LDB,B1   6,B2
          0 00088F  9FC7 008A                            STB,B1   QCU@USE+18,AUTO
          0 000891  70F0                                 DAR,R7   16
          0 000892  9B80 0000 0009  01                   LAB,B1   +9
          0 000895  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          0 000898  8447 008A                            AID      QCU@USE+18,AUTO
          0 00089A  8D47 0052                            SDI      GZ_FIELD$,AUTO

     1188    22872    3             FIELD_INDEX * SIZEW (QI$GZ_FIELD) );
     1189    22873
     1190    22874    3           GOTO RE_DCL_A_FIELD;

  22874   0 00089C  0F81 FE89                            B        s:22569,PREL

     1191    22875    3         END;
     1192    22876
     1193    22877    2       QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.FLDID_STOP =

  22877   0 00089E  EC80 0000 007C  xsym                 LDB,B6   QI_1+124
          0 0008A1  DCC7 0054                            LDB,B5   GZ_HEADER$,AUTO
          0 0008A3  E846 0002                            LDR,R6   2,B6
          0 0008A5  EA45 0004                            ADD,R6   4,B5
          0 0008A7  6EFF                                 ADV,R6   -1
          0 0008A8  EF46 0003                            STR,R6   3,B6

     1194    22878    2         QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.FLDID_START
     1195    22879    2         + GZ_HEADER$ -> QI$GZ_HEADER.FIELD_COUNT
     1196    22880    2         - 1;
     1197    22881    2       IF NOT QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.CURRENT.USAGE.ACTIVATED

  22881   0 0008AA  EC80 0000 007C  xsym                 LDB,B6   QI_1+124
          0 0008AD  82C6 000A                            LB,'0400'X        10,B6
          0 0008AF       0400
          0 0008B0  0501 0009                            BBT      s:22888,PREL

     1198    22882    2       THEN
     1199    22883          /*  QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.GZ.NEXT_AVAILABLE_FLDID =
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:134  
     1200    22884                QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.GZ.NEXT_AVAILABLE_FLDID  */
     1201    22885    2         QI_1.GZ.NEXT_AVAILABLE_FLDID = QI_1.GZ.NEXT_AVAILABLE_FLDID

  22885   0 0008B2  E800 0000 006E  xsym                 LDR,R6   QI_1+110
          0 0008B5  EA45 0004                            ADD,R6   4,B5
          0 0008B7  EF00 0000 006E  xsym                 STR,R6   QI_1+110

     1202    22886    2           + GZ_HEADER$ -> QI$GZ_HEADER.FIELD_COUNT;
     1203    22887
     1204    22888    2       QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.INDICATORS.IS_ACTIVE = %YES;

  22888   0 0008BA  8946 000C                            LBT,'8000'X       12,B6
  22888   0 0008BC       8000

     1205    22889    2       QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.CURRENT.USAGE.ACTIVATED = %YES;

  22889   0 0008BD  EC80 0000 007C  xsym                 LDB,B6   QI_1+124
          0 0008C0  8946 000A                            LBT,'0400'X       10,B6
          0 0008C2       0400

     1206    22890
     1207    22891    2       RETURN;

  22891   0 0008C3  ECC7 0088                            LDB,B6   QCU@USE+16,AUTO
          0 0008C5  C3C6 0001                            LNJ,B4   1,B6

     1208    22892
     1209    22893    2   END ACTIVATE_FRAME;
     1210    22894
     1211    22895    1   END QBA$ACTIVATE;

  22895   0 0008C7  C380 0000 0000  xent                 LNJ,B4   X6A_ARET
     1212    22896        %EOD;

PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:135  
--  Include file information  --

   QCU_USE_M.:E05TOU  is referenced.
   QI_MACROS_M.:E05TOU  is referenced.
   QI_PERR_C.:E05TOU  is referenced.
   QI_EQUATES_E.:E05TOU  is referenced.
   QG_MACRO_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QBA$ACTIVATE.
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:136  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

    2D-0-0/w UBIN(16)    r     1 BOX_MAX_COLUMN            2E-0-0/w UBIN(16)    r     1 BOX_MAX_ROW
    2F-0-0/w UBIN(16)    r     1 BOX_MIN_COLUMN            30-0-0/w UBIN(16)    r     1 BOX_MIN_ROW
    31-0-0/w UBIN(16)    r     1 COLUMN_INCREMENT          32-0-0/w UBIN(16)    r     1 COLUMN_INDEX
    33-0-0/w UBIN(16)    r     1 COLUMN_INDEX_STOP         34-0-0/w UBIN(16)    r     1 COLUMN_STOP_GROUP
    35-0-0/w PTR         r     1 CURRENT_FATHER$
    37-0-0/w PTR         r     1 CURRENT_FATHER_STATUS$
    39-0-0/w PTR         r     1 DAD$                      3B-0-0/w UBIN(16)    r     1 DISP
    3C-0-0/w UBIN(16)    r     1 ELEM_COUNT                3D-0-0/w UBIN(16)    r     1 FIELD_BYTE_SIZE
    3E-0-0/w UBIN(16)    r     1 FIELD_COLUMN              3F-0-0/w UBIN(16)    r     1 FIELD_COUNT
    40-0-0/w PTR         r     1 FIELD_DAD_P$              42-0-0/w UBIN(16)    r     1 FIELD_DIM_CNT
    43-0-0/w PTR         r     1 FIELD_IDENTIFIER$         45-0-0/w SBIN(16)    r     1 FIELD_INDEX
    46-0-0/w UBIN(16)    r     1 FIELD_ROW                 47-0-0/w PTR         r     1 FORM_FILE$
    49-0-0/w PTR         r     1 FORM_STATUS$               4-0-0/w STRC(224)   r     1 FPT@DCLFLD
    15-0-0/w STRC(128)   r     1 FPT@GDS                   4B-0-0/w PTR         r     1 FRAME$
    4D-0-0/w UBIN(16)    r     1 FRAME_COLUMN              4E-0-0/w UBIN(16)    r     1 FRAME_INDEX
    4F-0-0/w UBIN(16)    r     1 FRAME_ROW                 50-0-0/w PTR         r     1 FRAME_STATUS$
    52-0-0/w PTR         r     1 GZ_FIELD$                 54-0-0/w PTR         r     1 GZ_HEADER$
    56-0-0/w PTR         r     1 INDICATORS$               58-0-0/w PTR         r     1 INIT_DATA$
    5A-0-0/w UBIN(16)    r     1 INIT_FIELD_COLUMN         5B-0-0/w UBIN(16)    r     1 INIT_FIELD_OFFSET
    5C-0-0/w PTR         r     1 INSTR$                    5E-0-0/w UBIN(16)    r     1 INX
    5F-0-0/w PTR         r     1 INX_A$(0:2)               65-0-0/w BIT         r     1 ITS_AN_ACTIVATE
    66-0-0/w UBIN(16)    r     1 MAX_FIELD_SIZE            67-0-0/w UBIN(16)    r     1 MULT_COUNT
    68-0-0/w UBIN(16)    r     1 NEXT_INDEX                69-0-0/w UBIN(16)    r     1 OPERAND_COUNT
    6A-0-0/w UBIN(16)    r     1 OPERAND_INDEX
    6B-0-0/w PTR         r     1 OVERLAPPING_FIELD_IDENTIFIER$
    6D-0-0/w UBIN(16)    r     1 PART_FIELD_SIZE           6E-0-0/w UBIN(16)    r     1 P_ITEM_INDEX
    78-0-0/w STRC(224)   r     1 QCU@USE                   6F-0-0/w SBIN(16)    r     1 REPEATS_INDEX
    70-0-0/w UBIN(16)    r     1 ROW_INCREMENT             74-0-0/w UBIN(16)    r     1 ROW_INDEX
    75-0-0/w UBIN(16)    r     1 ROW_INDEX_STOP            71-0-0/w PTR         r     1 ROW_REPEATS$
    73-0-0/w SBIN(16)    r     1 SEPARATED_INDEX           76-0-0/w UBIN(16)    r     1 TOTAL_GZ_NEEDED
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:137  
    77-0-0/w UBIN(16)    r     1 TOTAL_GZ_SPACE            12-0-0/w STRC(48)    r     1 VLP@FLDATR

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(432)   r     1 QGB_PARAM                  0-0-0/d STRC(2576)  r     1 QI_1
     0-0-0/w STRC(224)   r     1 QI_FPT_DCLFLD              0-0-0/w STRC(128)   r     1 QI_FPT_GDS
     0-0-0/w STRC(48)    r     1 QI_VLP_FLDATR              0-0-0/w STRC(48)    r     1 QI_VLP_SEGMENT

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w ASTR(808)   r     1 M$DCB                      0-0-0/w STRC        r     1 QI$BITS
     0-0-0/w STRC(384)   r     1 QI$FIELD_DAD               0-0-0/w STRC(112)   r     1 QI$FIELD_DAD_P
     0-0-0/w STRC(48)    r     1 QI$FIELD_STATUS            0-0-0/w STRC(192)   r     1 QI$FORM_FILE
     0-0-0/w STRC(144)   r     1 QI$FORM_STATUS             0-0-0/w STRC(128)   r     1 QI$FRAME
     0-0-0/w STRC(208)   r     1 QI$FRAME_STATUS            0-0-0/w STRC(184)   r     1 QI$GZ_FIELD
     0-0-0/w STRC(176)   r     1 QI$GZ_HEADER               0-0-0/w STRC(16)    r     1 QI$INDICATORS
     0-0-0/w STRC(128)   r     1 QI$MAJOR_NODE              0-0-0/w STRC(48)    r     1 QI$MAJOR_STATUS
     0-0-0/w STRC(128)   r     1 QI$MINOR_NODE              0-0-0/w STRC(48)    r     1 QI$MINOR_STATUS
     0-0-0/w STRC(48)    r     1 QI$OP_ACTIVATE
     0-0-0/w UBIN(16)    r     1 QI$UWORD_A(0:0)
     0-0-0/c ASTR(8)     r     1 QI$VARIABLE_IDENTIFIER


   Procedure QBA$ACTIVATE requires 2250 words for executable code.
   Procedure QBA$ACTIVATE requires 144 words of local(AUTO) storage.
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:138  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:139  
          MINI XREF LISTING

ACTIVATE_FORM
     20868**PROC    20831--CALL
ACTIVATE_FRAME
     20975**PROC    20820--CALL    20963--CALL
BOX_MAX_COLUMN
     20473**DCL     21376<<ASSIGN  21437>>IF      21439<<ASSIGN  21629>>ASSIGN
BOX_MAX_ROW
     20474**DCL     21375<<ASSIGN  21447>>IF      21449<<ASSIGN  21624>>ASSIGN
BOX_MIN_COLUMN
     20475**DCL     21379<<ASSIGN  21441>>IF      21443<<ASSIGN  21629>>ASSIGN
BOX_MIN_ROW
     20476**DCL     21378<<ASSIGN  21451>>IF      21453<<ASSIGN  21624>>ASSIGN
BOX_STEP_ACROSS_COUNT IN PROCEDURE ACTIVATE_FRAME
     21516**LABEL   21455--GOTO    21608--GOTO
BUILD_CONTINUE IN PROCEDURE ACTIVATE_FRAME
     22027**LABEL   22021--GOTO
CHECK_DIM_COUNT IN PROCEDURE ACTIVATE_FRAME
     21236**LABEL   21360--GOTO
CHECK_STEP_ACROSS_BUILD IN PROCEDURE ACTIVATE_FRAME
     22388**LABEL   22308--GOTO    22534--GOTO
CHECK_STEP_ACROSS_COUNT IN PROCEDURE ACTIVATE_FRAME
     21696**LABEL   21368--GOTO    21838--GOTO
CHECK_USE_PROCEDURE
     20844**LABEL   20811--GOTO    20820--CALLALT 20822--CALLALT 20831--CALLALT 20833--CALLALT
COLUMN_INCREMENT
     20477**DCL     22011<<ASSIGN  22211>>ASSIGN
COLUMN_INDEX
     20478**DCL     22045--ASSIGN  22097--ASSIGN  22204<<DOINDEX 22248>>ASSIGN
COLUMN_INDEX_STOP
     20479**DCL     22086<<ASSIGN  22095<<ASSIGN  22100<<ASSIGN  22110<<ASSIGN  22204>>DOINDEX 22248>>ASSIGN
COLUMN_STOP_GROUP
     20480**DCL     22095>>ASSIGN  22325<<ASSIGN
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:140  
CONTINUE_COUNT IN PROCEDURE ACTIVATE_FRAME
     21147**LABEL   21141--GOTO
CURRENT_FATHER$
     20481**DCL     21007<<ASSIGN  21112>>ASSIGN  21647<<ASSIGN  21816<<ASSIGN
CURRENT_FATHER_STATUS$
     20482**DCL     21112<<ASSIGN  21133>>ASSIGN  21134>>ASSIGN
DAD$
     20483**DCL     21029<<ASSIGN  21050>>ASSIGN  21072>>ASSIGN  21136>>DOCASE  21139>>ASSIGN  21144>>ASSIGN
     21147>>IF      21152>>IF      21159>>ASSIGN  21159>>ASSIGN  21229>>IF      21236>>DOCASE  21242>>ASSIGN
     21242>>ASSIGN  21296>>IF      21300>>ASSIGN  21315>>IF      21315>>IF      21340<<ASSIGN  21340>>ASSIGN
     21371>>IF      21401<<ASSIGN  21401>>ASSIGN  21422>>DOCASE  21425>>ASSIGN  21430>>ASSIGN  21433>>ASSIGN
     21445>>ASSIGN  21465>>IF      21489<<ASSIGN  21489>>ASSIGN  21516>>IF      21540<<ASSIGN  21540>>ASSIGN
     21586<<ASSIGN  21586>>ASSIGN  21606>>IF      21614>>IF      21617>>ASSIGN  21669<<ASSIGN  21720<<ASSIGN
     21947<<ASSIGN  21968>>ASSIGN  21990>>ASSIGN  22016>>DOCASE  22019>>ASSIGN  22024>>ASSIGN  22027>>IF
     22031>>ASSIGN  22034>>ASSIGN  22038>>ASSIGN  22113>>IF      22135>>ASSIGN  22175>>ASSIGN  22195>>ASSIGN
     22197>>ASSIGN  22198>>ASSIGN  22214>>ASSIGN  22215>>ASSIGN  22216>>ASSIGN  22217>>ASSIGN  22218>>ASSIGN
     22222>>IF      22225>>IF      22225>>IF      22233>>IF      22236>>IF      22273>>ASSIGN  22286>>ASSIGN
     22297>>ASSIGN  22311>>IF      22320>>ASSIGN  22322>>ASSIGN  22325>>ASSIGN  22361<<ASSIGN  22423<<ASSIGN
DISP
     20484**DCL     21425<<ASSIGN  21430<<ASSIGN  21435<<ASSIGN  21435>>ASSIGN  21437>>IF      21439>>ASSIGN
     21445<<ASSIGN  21447>>IF      21449>>ASSIGN  21451>>IF      21453>>ASSIGN  22278<<ASSIGN  22286<<ASSIGN
     22286>>ASSIGN  22294>>ASSIGN  22295>>ASSIGN
ELEM_COUNT
     20485**DCL     21227<<ASSIGN  21303<<ASSIGN  21303>>ASSIGN  21366>>ASSIGN
FIELD_BYTE_SIZE
     20486**DCL     22019<<ASSIGN  22024<<ASSIGN  22276>>ASSIGN
FIELD_COLUMN
     20487**DCL     22202<<ASSIGN  22209>>ASSIGN  22211<<ASSIGN  22211>>ASSIGN
FIELD_COUNT
     20488**DCL     21001<<ASSIGN  21366<<ASSIGN  21366>>ASSIGN  21854>>ASSIGN  21885>>ASSIGN  21916>>ASSIGN
     22546>>IF
FIELD_DAD_P$
     20489**DCL     21159<<ASSIGN  21164>>IF      21169>>IF      21198>>IF      21213>>ASSIGN  21242<<ASSIGN
     21246>>IF      21274>>IF      21289>>ASSIGN  22038<<ASSIGN  22040>>IF      22071>>IF      22086>>ASSIGN
FIELD_DIM_CNT
     20490**DCL     22031<<ASSIGN  22092>>IF      22107<<ASSIGN  22280>>IF      22284>>DOINDEX
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:141  
FIELD_IDENTIFIER$
     20491**DCL     22608<<ASSIGN  22631>>CALL    22631>>CALL    22785>>CALL    22785>>CALL
FIELD_INDEX
     20492**DCL     22566<<DOINDEX 22569>>ASSIGN  22740<<ASSIGN  22742>>ASSIGN  22869<<ASSIGN  22871>>ASSIGN
FIELD_ROW
     20493**DCL     22197<<ASSIGN  22208>>ASSIGN  22304<<ASSIGN  22304>>ASSIGN
FIND_FIELD_THATS_OVERLAPPED IN PROCEDURE ACTIVATE_FRAME
     22738**LABEL   22839--GOTO
FORM_FILE$
     20494**DCL     22642<<ASSIGN  22645>>DOWHILE 22649>>DOINDEX 22671>>ASSIGN  22812>>ASSIGN  22832<<ASSIGN
FORM_STATUS$
     20495**DCL     22812<<ASSIGN  22832>>ASSIGN
FPT@DCLFLD
      1387**DCL     22557<<ASSIGN  22584<>CALL    22852<>CALL
FPT@DCLFLD.FLDATR_
      1393**DCL     22560<<ASSIGN
FPT@DCLFLD.V
      1395**DCL     22558--ASSIGN
FPT@DCLFLD.V.CLM
      1405**DCL     22574<<ASSIGN
FPT@DCLFLD.V.DCB#
      1395**DCL     22559<<ASSIGN
FPT@DCLFLD.V.DVBYTE.RRR
      1403**DCL     22580>>IF      22868<<ASSIGN
FPT@DCLFLD.V.ID
      1405**DCL     22572<<ASSIGN
FPT@DCLFLD.V.LIN
      1404**DCL     22573<<ASSIGN
FPT@DCLFLD.V.WDT
      1406**DCL     22575<<ASSIGN
FPT@DCLFLD.V_
      1389**DCL     22558<<ASSIGN
FPT@GDS
      1450**DCL     21865<<ASSIGN  21869<>CALL
FPT@GDS.V
      1453**DCL     21866--ASSIGN
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:142  
FPT@GDS.V.PAGES
      1457**DCL     21867<<ASSIGN
FPT@GDS.V_
      1453**DCL     21866<<ASSIGN
FRAME$
     20496**DCL     22671<<ASSIGN  22711>>ASSIGN
FRAME_COLUMN
     20497**DCL     21912<<ASSIGN  22198>>ASSIGN
FRAME_INDEX
     20498**DCL     20881<<DOINDEX 20903>>ASSIGN  22649<<DOINDEX 22671>>ASSIGN
FRAME_ROW
     20499**DCL     21911<<ASSIGN  22197>>ASSIGN
FRAME_STATUS$
     20500**DCL     22711<<ASSIGN  22731>>IF      22731>>IF      22731>>IF      22740>>ASSIGN  22742>>ASSIGN
     22838<<ASSIGN
GZ_FIELD$
     20501**DCL     21903<<ASSIGN  21915>>ASSIGN  21916>>ASSIGN  22206>>ASSIGN  22208>>ASSIGN  22209>>ASSIGN
     22214>>ASSIGN  22215>>ASSIGN  22216>>ASSIGN  22217>>ASSIGN  22218>>ASSIGN  22251>>ASSIGN  22256>>IF
     22261>>IF      22266>>IF      22266>>IF      22273>>ASSIGN  22276>>ASSIGN  22294>>ASSIGN  22295>>ASSIGN
     22297>>ASSIGN  22300<<ASSIGN  22300>>ASSIGN  22550>>IF      22563<<ASSIGN  22569>>ASSIGN  22572>>ASSIGN
     22573>>ASSIGN  22574>>ASSIGN  22575>>ASSIGN  22576>>ASSIGN  22577>>ASSIGN  22578>>ASSIGN  22608>>ASSIGN
     22742<<ASSIGN  22765>>ASSIGN  22856<<ASSIGN  22856>>ASSIGN  22871<<ASSIGN
GZ_HEADER$
     20502**DCL     21877<<ASSIGN  21881>>ASSIGN  21883>>ASSIGN  21884>>ASSIGN  21885>>ASSIGN  21886>>ASSIGN
     21887>>ASSIGN  21888>>ASSIGN  21895<<ASSIGN  21898>>ASSIGN  21903>>ASSIGN  21914>>ASSIGN  22563>>ASSIGN
     22566>>DOINDEX 22877>>ASSIGN  22885>>ASSIGN
HAVE_FIELD_COUNT IN PROCEDURE ACTIVATE_FRAME
     21242**LABEL   21233--GOTO
HAVE_MULT_COUNT IN PROCEDURE ACTIVATE_FRAME
     21303**LABEL   21291--GOTO
INDICATORS$
     20503**DCL     22248<<ASSIGN  22251>>ASSIGN  22253>>ASSIGN  22254>>ASSIGN  22259>>ASSIGN  22264>>ASSIGN
     22270>>ASSIGN
INITIAL_DCLFLD_ALTRET IN PROCEDURE ACTIVATE_FRAME
     22868**LABEL   22852--CALLALT
INIT_DATA$
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:143  
     20504**DCL     22135<<ASSIGN  22175<<ASSIGN  22295>>ASSIGN
INIT_FIELD_COLUMN
     20505**DCL     22198<<ASSIGN  22202>>ASSIGN
INIT_FIELD_OFFSET
     20506**DCL     22195<<ASSIGN  22278>>ASSIGN
INSTR$
     20507**DCL     20664<<ASSIGN  20665>>ASSIGN  20692>>ASSIGN  20745>>ASSIGN
INX
     20508**DCL     21433<<ASSIGN  21435>>ASSIGN  21441>>IF      21443>>ASSIGN  21617<<ASSIGN  21619<<ASSIGN
     21624>>ASSIGN  21629>>ASSIGN  22034<<ASSIGN  22038>>ASSIGN  22044<<ASSIGN  22044>>ASSIGN  22045>>ASSIGN
     22284<<DOINDEX 22286>>ASSIGN  22286>>ASSIGN
INX_A$
     20509**DCL     22045<<ASSIGN  22097<<ASSIGN  22286>>ASSIGN  22318<<ASSIGN
ITS_AN_ACTIVATE
     20510**DCL     20656<<ASSIGN  20661<<ASSIGN  20818>>IF      20829>>IF      22264>>ASSIGN
M$DCB.DCBNAME.L
      1575**DCL      1575--IMP-SIZ
M$DCB.EOMCHAR
      1566**DCL      1566--REDEF    1567--REDEF
M$DCB.FLDID
      1565**DCL      1565--REDEF   22731>>IF      22731>>IF      22740>>ASSIGN  22869>>ASSIGN
M$DCB.RES
      1560**DCL      1561--REDEF
M$DCLFLD
      1361**DCL-ENT 22584--CALL
M$GDS
      1346**DCL-ENT 21869--CALL
MAX_FIELD_SIZE
     20511**DCL     21002<<ASSIGN  21147>>IF      21150<<ASSIGN  21847<<ASSIGN  21847>>ASSIGN
MULT_COUNT
     20512**DCL     21289<<ASSIGN  21300<<ASSIGN  21303>>ASSIGN
NEXT_ACT_DEACT_IVATE_PLEASE
     20838**LABEL   20860--GOTO
NEXT_BOX IN PROCEDURE ACTIVATE_FRAME
     21422**LABEL   21509--GOTO    21560--GOTO
NEXT_BOX_CONTINUE IN PROCEDURE ACTIVATE_FRAME
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:144  
     21433**LABEL   21427--GOTO
NEXT_BUILD IN PROCEDURE ACTIVATE_FRAME
     21968**LABEL   22381--GOTO    22443--GOTO
NEXT_COUNT IN PROCEDURE ACTIVATE_FRAME
     21050**LABEL   21689--GOTO    21740--GOTO
NEXT_INDEX
     20513**DCL     21905<<ASSIGN  21918>>ASSIGN  22014>>ASSIGN  22299<<ASSIGN  22299>>ASSIGN  22388>>ASSIGN
     22542>>ASSIGN  22546>>IF
OPERAND_COUNT
     20514**DCL     20665<<ASSIGN  20666>>ASSIGN  20669>>DOINDEX
OPERAND_INDEX
     20515**DCL     20669<<DOINDEX 20692>>ASSIGN  20723<<ASSIGN  20723>>ASSIGN  20745>>ASSIGN
OVERLAPPING_FIELD_IDENTIFIER$
     20516**DCL     22765<<ASSIGN  22785>>CALL    22785>>CALL
PART_FIELD_SIZE
     20517**DCL     21139<<ASSIGN  21144<<ASSIGN  21147>>IF      21150>>ASSIGN  21213>>ASSIGN  21220>>ASSIGN
P_ITEM_INDEX
     20518**DCL     21197<<DOINDEX 21198>>IF      21273<<DOINDEX 21274>>IF      22070<<DOINDEX 22071>>IF
QBA$DEACTIVATE_FORM
     20528**DCL-ENT 20833--CALL
QBA$DEACTIVATE_FRAME
     20529**DCL-ENT 20822--CALL
QCE$ERROR
     20530**DCL-ENT 21872--CALL    22631--CALL    22785--CALL
QCE$ERROR_INTERNAL
     20531**DCL-ENT 20863--CALL    21310--CALL    21460--CALL    21638--CALL    22229--CALL    22239--CALL
     22243--CALL    22332--CALL    22548--CALL    22553--CALL
QCE$ERROR_M$INTERNAL
     20532**DCL-ENT 22842--CALL
QCF$FIND_CURRENTS
     20533**DCL-ENT 20712--CALL
QCU$UPDATE_SCREEN
     20534**DCL-ENT 20999--CALL
QCU$USE_IO
     20535**DCL-ENT 20849--CALL
QCU@USE
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:145  
     20608**DCL     20849<>CALL
QCU@USE.CURR_FRAME$
     20609**DCL     20845<<ASSIGN
QCU@USE.CURR_NODE$
     20611**DCL     20844<<ASSIGN
QCU@USE.IS_TIME_TO_SAVE_AWAY_FIELDS
     20616**DCL     20846<<ASSIGN
QCU@USE.STATUS
     20642**DCL     20851>>DOCASE
QCU@USE.USE_DEFAULT_IO
     20613**DCL     20847<<ASSIGN
QGB$DCLFLD
      1719**DCL-ENT 22852--CALL
QGB$FLUSH
      1727**DCL-ENT 22860--CALL
QGB_PARAM
     12843**DCL     22852<>CALL    22860<>CALL
QGB_PARAM.DVE.DVBYTE.VFC
     12911**DCL     12912--REDEF
QGB_PARAM.DVE.EOMCHAR
     12923**DCL     12924--REDEF
QGB_PARAM.ERR.ERR#
     12902**DCL     22628>>DOCASE
QGB_PARAM.MSG$
     12905**DCL     12906--REDEF
QGB_PARAM.UHDR$
     12930**DCL     12931--REDEF
QI$ACTIVATION_STATUS
     10669**DCL     10675--REDEF
QI$BITS.BIT_A
     13004**DCL     21198>>IF      21274>>IF      22071>>IF
QI$CIP
      9510**DCL      9580--REDEF
QI$CIP.CA
      9515**DCL      9519--REDEF    9522--REDEF    9525--REDEF
QI$COBOL_DAD.PSEUDO_CIP
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:146  
      9754**DCL      9779--REDEF
QI$COBOL_DAD.PSEUDO_CIP.ALPHANUMERIC
      9756**DCL      9761--REDEF
QI$COBOL_DAD.PSEUDO_CIP.NUMERIC.CB
      9762**DCL      9765--REDEF    9768--REDEF
QI$COBOL_DAD.VARIABLE_LENGTH_ITEMS
      9790**DCL      9806--REDEF    9814--REDEF    9822--REDEF
QI$COBOL_DAD.VARIABLE_LENGTH_ITEMS.LEVEL_MULTIPLIERS
      9791**DCL      9801--REDEF    9804--REDEF
QI$COBOL_DAD.WORD0
      9718**DCL      9719--REDEF    9733--REDEF
QI$COBOL_DAD_P_BITS.P
      9858**DCL      9864--REDEF
QI$CONDITION_CONTROL_BLOCK.LIST_A@P
      9344**DCL      9345--REDEF
QI$CONDITION_CONTROL_BLOCK.WORD0_FLAGS
      9340**DCL      9343--REDEF
QI$CONDITION_LEGAL_BLOCK.ARRAY@P
      9377**DCL      9378--REDEF    9379--REDEF
QI$DAD.PSEUDO_CIP
      9657**DCL      9682--REDEF
QI$DAD.PSEUDO_CIP.ALPHANUMERIC
      9659**DCL      9664--REDEF
QI$DAD.PSEUDO_CIP.NUMERIC.CB
      9665**DCL      9668--REDEF    9671--REDEF
QI$DAD.WORD0
      9626**DCL      9627--REDEF
QI$ERROR_MESSAGE_LINE
     13018**DCL     13020--REDEF
QI$ERROR_STATUS
     13015**DCL     13017--REDEF
QI$FIELD_DAD.ELEMENTARY_ITEM.P
     10072**DCL     10079--REDEF
QI$FIELD_DAD.IDENTIFIER@P
     10043**DCL     22608>>ASSIGN  22765>>ASSIGN
QI$FIELD_DAD.ONE_DIMENSIONAL_ITEM.P
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:147  
     10092**DCL     10099--REDEF
QI$FIELD_DAD.POSITION.COLUMN
     10049**DCL     21433>>ASSIGN  22198>>ASSIGN
QI$FIELD_DAD.POSITION.LINE
     10046**DCL     21445>>ASSIGN  22197>>ASSIGN
QI$FIELD_DAD.PSEUDO_CIP
      9999**DCL     10024--REDEF
QI$FIELD_DAD.PSEUDO_CIP.ALPHANUMERIC
     10001**DCL     10006--REDEF
QI$FIELD_DAD.PSEUDO_CIP.ALPHANUMERIC.LEN
     10005**DCL     21144>>ASSIGN  21430>>ASSIGN  22024>>ASSIGN
QI$FIELD_DAD.PSEUDO_CIP.DATA@
     10023**DCL     22135>>ASSIGN  22175>>ASSIGN
QI$FIELD_DAD.PSEUDO_CIP.NUMERIC.CB
     10007**DCL     10010--REDEF   10013--REDEF
QI$FIELD_DAD.PSEUDO_CIP.NUMERIC.CD.OFFSET
     10011**DCL     22195>>ASSIGN
QI$FIELD_DAD.PSEUDO_CIP.NUMERIC.LEN
     10016**DCL     21139>>ASSIGN  21425>>ASSIGN  22019>>ASSIGN
QI$FIELD_DAD.TWO_DIMENSIONAL_ITEM.P
     10112**DCL     10119--REDEF
QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS
     10055**DCL     10071--REDEF   10089--REDEF   10107--REDEF
QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS.LEVEL_MULTIPLIERS
     10056**DCL     10066--REDEF   10069--REDEF
QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS.LEVEL_MULTIPLIER_A
     10066**DCL     21159--ASSIGN  21242--ASSIGN  22038--ASSIGN
QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS.LEVEL_MULTIPLIER_A.ELEMENT_LENGTH
     10068**DCL     22286>>ASSIGN
QI$FIELD_DAD.VISUAL_ATTRIBUTE
     10053**DCL     22273>>ASSIGN
QI$FIELD_DAD.WORD0
      9951**DCL      9952--REDEF
QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT
      9975**DCL     21152>>IF      21159>>ASSIGN  21229>>IF      21242>>ASSIGN  22027>>IF      22031>>ASSIGN
     22034>>ASSIGN
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:148  
QI$FIELD_DAD.WORD0_FLAGS.IO_FLAGS
      9955**DCL      9960--REDEF
QI$FIELD_DAD.WORD0_FLAGS.IO_FLAGS.IS_INPUT
      9958**DCL     21147>>IF      22215>>ASSIGN  22225>>IF      22233>>IF
QI$FIELD_DAD.WORD0_FLAGS.IO_FLAGS.IS_OUTPUT
      9956**DCL     22214>>ASSIGN  22222>>IF
QI$FIELD_DAD.WORD0_FLAGS.IS_AOIM
      9968**DCL     22218>>ASSIGN
QI$FIELD_DAD.WORD0_FLAGS.IS_CONSTANT
      9973**DCL     22113>>IF      22236>>IF
QI$FIELD_DAD.WORD0_FLAGS.IS_ENTRY_REQUIRED
      9962**DCL     22216>>ASSIGN  22225>>IF
QI$FIELD_DAD.WORD0_FLAGS.IS_OUTPUT_CONSTANT
      9964**DCL     22217>>ASSIGN
QI$FIELD_DAD.WORD0_FLAGS.TYPE
      9977**DCL     21136>>DOCASE  21236>>DOCASE  21422>>DOCASE  22016>>DOCASE
QI$FIELD_DAD_P.P
     10153**DCL     10160--REDEF
QI$FIELD_DAD_P.P.REPEATS
     10158**DCL     21164>>IF      21246>>IF      22040>>IF
QI$FIELD_DAD_P.P.SEPARATED
     10159**DCL     21169>>IF
QI$FIELD_DAD_P.P_ITEM_A
     10163**DCL     21213>>ASSIGN  21289>>ASSIGN  22086>>ASSIGN
QI$FIELD_STATUS.GZ.FIELD_START_INDEX
     10795**DCL     22010>>ASSIGN
QI$FIELD_STATUS.GZ.FIELD_STOP_INDEX
     10797**DCL     21213<<ASSIGN  21220<<ASSIGN  22011>>ASSIGN
QI$FIELD_STATUS.INDICATORS
     10819**DCL     10851--REDEF
QI$FIELD_STATUS.INDICATORS.ENABLED_FLAGS
     10823**DCL     10828--REDEF
QI$FIELD_STATUS.INDICATORS.OPEN_FLAGS
     10835**DCL     10842--REDEF
QI$FIELD_STATUS.INDICATORS.STATE_FLAGS
     10829**DCL     10834--REDEF
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:149  
QI$FIELD_STATUS.INDICATORS_A
     10851**DCL     22248--ASSIGN
QI$FILE.WORD0
     10275**DCL     10276--REDEF
QI$FILE_STATUS.INDICATORS
     11112**DCL     11144--REDEF
QI$FILE_STATUS.INDICATORS.ENABLED_FLAGS
     11116**DCL     11121--REDEF
QI$FILE_STATUS.INDICATORS.OPEN_FLAGS
     11128**DCL     11135--REDEF
QI$FILE_STATUS.INDICATORS.STATE_FLAGS
     11122**DCL     11127--REDEF
QI$FORM_FILE.DCB#
     10373**DCL     21884>>ASSIGN  22559>>ASSIGN  22731--IF      22731--IF      22740--ASSIGN  22869--ASSIGN
QI$FORM_FILE.FRAME_COUNT
     10354**DCL     20881>>DOINDEX 22649>>DOINDEX
QI$FORM_FILE.FRAME_LIST_A@P
     10383**DCL     20903>>ASSIGN  22671>>ASSIGN
QI$FORM_FILE.STATUS_AREA@D
     10367**DCL     20785>>ASSIGN  22812>>ASSIGN
QI$FORM_FILE.USE_PROCEDURE
     10375**DCL     10382--REDEF
QI$FORM_FILE.WORD0
     10329**DCL     10330--REDEF
QI$FORM_STATUS.FLINK$
     11204**DCL     22832>>ASSIGN
QI$FORM_STATUS.INDICATORS
     11233**DCL     11265--REDEF
QI$FORM_STATUS.INDICATORS.ENABLED_FLAGS
     11237**DCL     11242--REDEF
QI$FORM_STATUS.INDICATORS.OPEN_FLAGS
     11249**DCL     11256--REDEF
QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.IS_INPUT
     11253**DCL     20806>>IF      22261>>IF
QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.IS_OUTPUT
     11250**DCL     20806>>IF      22256>>IF      22266>>IF
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:150  
QI$FORM_STATUS.INDICATORS.STATE_FLAGS
     11243**DCL     11248--REDEF
QI$FRAME.COLUMN_ORIGIN
     10501**DCL     21912>>ASSIGN
QI$FRAME.LINE_ORIGIN
     10500**DCL     21911>>ASSIGN
QI$FRAME.SON@P
     10502**DCL     21029>>ASSIGN  21947>>ASSIGN
QI$FRAME.STATUS_AREA@D
     10506**DCL     20943>>ASSIGN  22711>>ASSIGN
QI$FRAME.WORD0
     10490**DCL     10491--REDEF
QI$FRAME.WORD0_FLAGS.TYPE
     10499**DCL     20714>>IF
QI$FRAME_STATUS.CURRENT.USAGE.ACTIVATED
     11432**DCL     21919>>IF      22881>>IF      22889<<ASSIGN
QI$FRAME_STATUS.FORM_BACK_LINK@P
     11439**DCL     21924<<ASSIGN
QI$FRAME_STATUS.GZ.FIELD_START_INDEX
     11415**DCL     21004<<ASSIGN  21918<<ASSIGN
QI$FRAME_STATUS.GZ.FIELD_STOP_INDEX
     11417**DCL     21005<<ASSIGN  22542<<ASSIGN
QI$FRAME_STATUS.GZ.FLDID_START
     11419**DCL     21921<<ASSIGN  22569>>ASSIGN  22731>>IF      22740>>ASSIGN  22869>>ASSIGN  22877>>ASSIGN
QI$FRAME_STATUS.GZ.FLDID_STOP
     11421**DCL     22731>>IF      22877<<ASSIGN
QI$FRAME_STATUS.GZ.HEADER$
     11423**DCL     21849>>IF      21895>>ASSIGN  21914<<ASSIGN
QI$FRAME_STATUS.GZ.START$
     11425**DCL     21915<<ASSIGN  22742>>ASSIGN  22871>>ASSIGN
QI$FRAME_STATUS.GZ.STOP$
     11427**DCL     21916<<ASSIGN  22550>>IF
QI$FRAME_STATUS.INDICATORS
     11462**DCL     11494--REDEF
QI$FRAME_STATUS.INDICATORS.ENABLED_FLAGS
     11466**DCL     11471--REDEF
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:151  
QI$FRAME_STATUS.INDICATORS.IS_ACTIVE
     11464**DCL     20988>>IF      22731>>IF      22888<<ASSIGN
QI$FRAME_STATUS.INDICATORS.OPEN_FLAGS
     11478**DCL     11485--REDEF
QI$FRAME_STATUS.INDICATORS.STATE_FLAGS
     11472**DCL     11477--REDEF
QI$GZ_FIELD
     18341**DCL     21854--ASSIGN  21916--ASSIGN  22206<<ASSIGN  22300--ASSIGN  22550--IF      22742--ASSIGN
     22856--ASSIGN  22871--ASSIGN
QI$GZ_FIELD.DESCRIPTION.FIELD_DAD$
     18365**DCL     22297<<ASSIGN  22608>>ASSIGN  22765>>ASSIGN
QI$GZ_FIELD.DESCRIPTION.IO_FLAGS
     18344**DCL     18349--REDEF
QI$GZ_FIELD.DESCRIPTION.IO_FLAGS.IS_INPUT
     18347**DCL     22215<<ASSIGN  22261>>IF
QI$GZ_FIELD.DESCRIPTION.IO_FLAGS.IS_OUTPUT
     18345**DCL     22214<<ASSIGN  22256>>IF      22266>>IF
QI$GZ_FIELD.DESCRIPTION.IS_AOIM
     18355**DCL     22218<<ASSIGN
QI$GZ_FIELD.DESCRIPTION.IS_ENTRY_REQUIRED
     18351**DCL     22216<<ASSIGN  22577>>ASSIGN
QI$GZ_FIELD.DESCRIPTION.IS_OUTPUT_CONSTANT
     18353**DCL     22217<<ASSIGN  22266>>IF      22576>>ASSIGN
QI$GZ_FIELD.DESCRIPTION.LENGTH
     18358**DCL     22276<<ASSIGN  22575>>ASSIGN
QI$GZ_FIELD.DESCRIPTION.POSITION.COLUMN
     18363**DCL     22209<<ASSIGN  22574>>ASSIGN
QI$GZ_FIELD.DESCRIPTION.POSITION.LINE
     18361**DCL     22208<<ASSIGN  22573>>ASSIGN
QI$GZ_FIELD.INDICATORS$
     18342**DCL     22251<<ASSIGN
QI$GZ_FIELD.STATUS.DATA$
     18385**DCL     22295<<ASSIGN
QI$GZ_FIELD.STATUS.FLDID
     18382**DCL     22569<<ASSIGN  22572>>ASSIGN
QI$GZ_FIELD.STATUS.OFFSET
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:152  
     18368**DCL     22294<<ASSIGN
QI$GZ_FIELD.STATUS.VISUAL_ATTRIBUTE
     18380**DCL     22273<<ASSIGN  22578>>ASSIGN
QI$GZ_HEADER
     18292**DCL     21854--ASSIGN  21881<<ASSIGN  21903--ASSIGN  22563--ASSIGN
QI$GZ_HEADER.BACK_LINK$
     18296**DCL     21887<<ASSIGN
QI$GZ_HEADER.DCB#
     18298**DCL     21884<<ASSIGN
QI$GZ_HEADER.FIELD_COUNT
     18300**DCL     21885<<ASSIGN  22566>>DOINDEX 22877>>ASSIGN  22885>>ASSIGN
QI$GZ_HEADER.FRAME_DAD$
     18302**DCL     21886<<ASSIGN
QI$GZ_HEADER.IS_ACTIVE
     18293**DCL     21883<<ASSIGN  21898<<ASSIGN
QI$IDENTIFIER
     13021**DCL     13023--REDEF
QI$INDICATORS
     10733**DCL     10763--REDEF
QI$INDICATORS.ENABLED_FLAGS
     10739**DCL     10744--REDEF
QI$INDICATORS.ENABLED_FLAGS.IS_INPUT
     10742**DCL     22264<<ASSIGN
QI$INDICATORS.ENABLED_FLAGS.IS_OUTPUT
     10740**DCL     22259<<ASSIGN
QI$INDICATORS.IS_ACTIVE
     10737**DCL     22253<<ASSIGN
QI$INDICATORS.OPEN_FLAGS
     10751**DCL     10758--REDEF
QI$INDICATORS.STATE_FLAGS
     10745**DCL     10750--REDEF
QI$INDICATORS.STATE_VALUE
     10750**DCL     22254<<ASSIGN  22270<<ASSIGN
QI$MAJOR_NODE.BROTHER@P
     10202**DCL     21516>>IF      21540>>ASSIGN  21696>>IF      21720>>ASSIGN  22399>>IF      22423>>ASSIGN
QI$MAJOR_NODE.FATHER@P
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:153  
     10203**DCL     21315>>IF      21340>>ASSIGN  21586>>ASSIGN  21746>>IF      21771>>ASSIGN  21791>>IF
     21816>>ASSIGN  22449>>IF      22474>>ASSIGN
QI$MAJOR_NODE.SON@P
     10201**DCL     21465>>IF      21489>>ASSIGN  21643>>IF      21669>>ASSIGN  22337>>IF      22361>>ASSIGN
QI$MAJOR_NODE.STATUS_AREA@D
     10205**DCL     21072>>ASSIGN  21112>>ASSIGN  21990>>ASSIGN  22514>>ASSIGN
QI$MAJOR_NODE.WORD0
     10189**DCL     10190--REDEF
QI$MAJOR_NODE.WORD0_FLAGS.TYPE
     10198**DCL     20814>>IF      21315>>IF      21746>>IF      21791>>IF      22449>>IF
QI$MAJOR_STATUS.GZ.FIELD_START_INDEX
     10888**DCL     21133<<ASSIGN  21133>>ASSIGN  22014<<ASSIGN
QI$MAJOR_STATUS.GZ.FIELD_STOP_INDEX
     10890**DCL     21134<<ASSIGN  21134>>ASSIGN  22388<<ASSIGN
QI$MAJOR_STATUS.INDICATORS
     10912**DCL     10944--REDEF
QI$MAJOR_STATUS.INDICATORS.ENABLED_FLAGS
     10916**DCL     10921--REDEF
QI$MAJOR_STATUS.INDICATORS.OPEN_FLAGS
     10928**DCL     10935--REDEF
QI$MAJOR_STATUS.INDICATORS.STATE_FLAGS
     10922**DCL     10927--REDEF
QI$MESSAGE_TYPE
     13012**DCL     13014--REDEF
QI$MINOR_NODE.REPEATS
     10242**DCL     21296>>IF      21300>>ASSIGN  21371>>IF      22311>>IF      22320>>ASSIGN  22325>>ASSIGN
QI$MINOR_NODE.SEPARATED
     10243**DCL     21614>>IF      21617>>ASSIGN
QI$MINOR_NODE.SON@P
     10244**DCL     21401>>ASSIGN
QI$MINOR_NODE.WORD0
     10232**DCL     10233--REDEF
QI$MINOR_STATUS.GZ.FIELD_START_INDEX
     10981**DCL     21621>>IF      21624<<ASSIGN
QI$MINOR_STATUS.GZ.FIELD_STOP_INDEX
     10983**DCL     21629<<ASSIGN
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:154  
QI$MINOR_STATUS.INDICATORS
     11005**DCL     11037--REDEF
QI$MINOR_STATUS.INDICATORS.ENABLED_FLAGS
     11009**DCL     11014--REDEF
QI$MINOR_STATUS.INDICATORS.OPEN_FLAGS
     11021**DCL     11028--REDEF
QI$MINOR_STATUS.INDICATORS.STATE_FLAGS
     11015**DCL     11020--REDEF
QI$OP_ACCEPT.DATANAME@P
      7420**DCL      7421--REDEF
QI$OP_ACTIVATE.OPERAND_A@P
      7450**DCL     20692>>ASSIGN  20745>>ASSIGN
QI$OP_ACTIVATE.OPERAND_COUNT
      7449**DCL     20665>>ASSIGN
QI$OP_CALL.EPTR$
      7592**DCL      7593--REDEF
QI$OP_CLEAR.IO_FLAGS
      7625**DCL      7628--REDEF
QI$OP_DISPLAY.FIELD_A@P
      7892**DCL      7893--REDEF
QI$OP_ENABLE.IO_FLAGS
      7979**DCL      7982--REDEF
QI$OP_IFCLS.ATTRIBUTE.TYPE
      8072**DCL      8077--REDEF
QI$OP_INSPECT.TALLYING_FOR_ITEM@P
      8306**DCL      8307--REDEF
QI$OP_INSPECT.TALLYING_INITIAL_ITEM@P
      8308**DCL      8309--REDEF
QI$OP_INSPECT.TALLYING_ITEM@P
      8304**DCL      8305--REDEF
QI$OP_OPEN.IO_FLAGS
      8866**DCL      8869--REDEF
QI$OP_PERFM.BINARY_ITERATION_COUNT@P
      8904**DCL      8905--REDEF
QI$PSEUDO_CIP
      9405**DCL      9429--REDEF
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:155  
QI$PSEUDO_CIP.ALPHANUMERIC
      9409**DCL      9414--REDEF
QI$PSEUDO_CIP.NUMERIC.CB
      9415**DCL      9418--REDEF    9421--REDEF
QI$TERMINAL_ATTRIBUTES
     10626**DCL     10639--REDEF
QI$TRAN_FILE.WORD0
     10411**DCL     10412--REDEF
QI$TRAN_STATUS.INDICATORS
     11346**DCL     11378--REDEF
QI$TRAN_STATUS.INDICATORS.ENABLED_FLAGS
     11350**DCL     11355--REDEF
QI$TRAN_STATUS.INDICATORS.OPEN_FLAGS
     11362**DCL     11369--REDEF
QI$TRAN_STATUS.INDICATORS.STATE_FLAGS
     11356**DCL     11361--REDEF
QI$UWORD_A
     13008**DCL     22286>>ASSIGN
QI$VARIABLE_IDENTIFIER
     13024**DCL     22631<>CALL    22785<>CALL    22785<>CALL
QI$VARIABLE_IDENTIFIER.LENGTH
     13025**DCL     13026--IMP-SIZ 22631>>CALL    22785>>CALL    22785>>CALL
QI_1.BASE
     11554**DCL     11561--REDEF
QI_1.BASE.DATA$
     11555**DCL     20785>>ASSIGN  20943>>ASSIGN  21072>>ASSIGN  21112>>ASSIGN  21990>>ASSIGN  22175>>ASSIGN
     22514>>ASSIGN  22711>>ASSIGN  22812>>ASSIGN
QI_1.BASE.PROC$
     11557**DCL     20692>>ASSIGN  20745>>ASSIGN  20903>>ASSIGN  21029>>ASSIGN  21340>>ASSIGN  21401>>ASSIGN
     21489>>ASSIGN  21540>>ASSIGN  21586>>ASSIGN  21669>>ASSIGN  21720>>ASSIGN  21771>>ASSIGN  21816>>ASSIGN
     21924>>ASSIGN  21947>>ASSIGN  22135>>ASSIGN  22361>>ASSIGN  22423>>ASSIGN  22474>>ASSIGN  22608>>ASSIGN
     22671>>ASSIGN  22765>>ASSIGN
QI_1.CURRENT.FILE$
     12445**DCL     12447--REDEF   12449--REDEF
QI_1.CURRENT.FILE_STATUS$
     12451**DCL     12453--REDEF   12455--REDEF
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:156  
QI_1.CURRENT.FORM$
     12447**DCL     20745<<ASSIGN  20785>>ASSIGN  20881>>DOINDEX 20903>>ASSIGN  21884>>ASSIGN  21924>>ASSIGN
     22559>>ASSIGN  22731>>IF      22731>>IF      22740>>ASSIGN  22869>>ASSIGN
QI_1.CURRENT.FORM_STATUS$
     12453**DCL     20785<<ASSIGN  20806>>IF      20806>>IF      22256>>IF      22261>>IF      22266>>IF
QI_1.CURRENT.FRAME$
     12457**DCL     20845>>ASSIGN  20903<<ASSIGN  20943>>ASSIGN  21007>>ASSIGN  21029>>ASSIGN  21886>>ASSIGN
     21911>>ASSIGN  21912>>ASSIGN  21947>>ASSIGN
QI_1.CURRENT.FRAME_STATUS$
     12459**DCL     20943<<ASSIGN  20988>>IF      21004>>ASSIGN  21005>>ASSIGN  21849>>IF      21895>>ASSIGN
     21914>>ASSIGN  21915>>ASSIGN  21916>>ASSIGN  21918>>ASSIGN  21919>>IF      21921>>ASSIGN  21924>>ASSIGN
     22542>>ASSIGN  22550>>IF      22569>>ASSIGN  22838>>ASSIGN  22869>>ASSIGN  22871>>ASSIGN  22877>>ASSIGN
     22877>>ASSIGN  22881>>IF      22888>>ASSIGN  22889>>ASSIGN
QI_1.CURRENT.NODE$
     12464**DCL     20692<<ASSIGN  20714>>IF      20814>>IF      20844>>ASSIGN  21050<<ASSIGN  21606>>IF
     21643>>IF      21647>>ASSIGN  21669>>ASSIGN  21696>>IF      21720>>ASSIGN  21746>>IF      21746>>IF
     21771<<ASSIGN  21771>>ASSIGN  21791>>IF      21791>>IF      21816>>ASSIGN  21968<<ASSIGN  22337>>IF
     22361>>ASSIGN  22390>>IF      22399>>IF      22423>>ASSIGN  22449>>IF      22449>>IF      22474<<ASSIGN
     22474>>ASSIGN  22514>>ASSIGN
QI_1.CURRENT.NODE_STATUS$
     12466**DCL     21072<<ASSIGN  21133>>ASSIGN  21134>>ASSIGN  21213>>ASSIGN  21220>>ASSIGN  21621>>IF
     21624>>ASSIGN  21629>>ASSIGN  21990<<ASSIGN  22010>>ASSIGN  22011>>ASSIGN  22014>>ASSIGN  22248>>ASSIGN
     22388>>ASSIGN  22514<<ASSIGN
QI_1.DAD
     12249**DCL     12254--REDEF
QI_1.ERROR_STATUS
     12479**DCL     20810<<ASSIGN  20991<<ASSIGN
QI_1.FILE_HEAD
     12432**DCL     12439--REDEF
QI_1.FILE_HEAD.FORM$
     12433**DCL     22642>>ASSIGN
QI_1.GZ.AVAILABLE$
     12424**DCL     21857>>ASSIGN  21877>>ASSIGN  21878<<ASSIGN  21878>>ASSIGN
QI_1.GZ.LAST_HEADER$
     12421**DCL     21887>>ASSIGN  21888<<ASSIGN
QI_1.GZ.NEXT_AVAILABLE_FLDID
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:157  
     12427**DCL     21921>>ASSIGN  22885<<ASSIGN  22885>>ASSIGN
QI_1.INSTR$
     11562**DCL     20664>>ASSIGN  20666<<ASSIGN
QI_1.IS_ALL_LIT
     12255**DCL     12260--REDEF
QI_1.IS_FORM_VARIABLE
     12261**DCL     12266--REDEF
QI_1.IS_TEMP
     12267**DCL     12272--REDEF
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP
     12365**DCL     12390--REDEF
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP.ALPHANUMERIC
     12367**DCL     12372--REDEF
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP.NUMERIC.CB
     12373**DCL     12376--REDEF   12379--REDEF
QI_1.MESSAGE_LINE_DAD.WORD0
     12334**DCL     12335--REDEF
QI_1.OFFSET
     12273**DCL     12278--REDEF
QI_1.OP.CIP
     11634**DCL     12085--REDEF
QI_1.OP.CIP.AUX
     12000**DCL     12071--REDEF
QI_1.OP.CIP.AUX.CD
     12045**DCL     12048--REDEF   12052--REDEF   12055--REDEF
QI_1.OP.CIP.S
     11704**DCL     11775--REDEF
QI_1.OP.CIP.S.CD
     11749**DCL     11752--REDEF   11756--REDEF   11759--REDEF
QI_1.OP.CIP.T
     11852**DCL     11923--REDEF
QI_1.OP.CIP.T.CD
     11897**DCL     11900--REDEF   11904--REDEF   11907--REDEF
QI_1.OP.DATA
     12092**DCL     12096--REDEF
QI_1.OP.FILL_CHAR
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:158  
     12216**DCL     12219--REDEF
QI_1.OP.INX
     12149**DCL     12153--REDEF   12154--REDEF   12158--REDEF
QI_1.OP.LEN
     12132**DCL     12136--REDEF   12137--REDEF   12141--REDEF   12142--REDEF   12146--REDEF
QI_1.OP.LEN.AUX
     12135**DCL     13036--IMP-SIZ
QI_1.OP.LEN.S
     12133**DCL     13032--IMP-SIZ
QI_1.OP.LEN.T
     12134**DCL     13034--IMP-SIZ
QI_1.OP.PICTURE_STRING
     12202**DCL     12205--REDEF   12206--REDEF   12209--REDEF   12210--REDEF   12213--REDEF
QI_1.OP.ROUND
     12235**DCL     12236--REDEF   12237--REDEF
QI_1.OP.SRCH_VRFY_ELEMS
     12171**DCL     12174--REDEF
QI_1.OPENED_COUNT
     12440**DCL     12443--REDEF
QI_1.OTTER_SPACE
     12279**DCL     12284--REDEF
QI_1.PICTURE_STRING
     12285**DCL     12290--REDEF
QI_1.SCREEN_UPDATE_FLAGS.WAS_DEACTIVATED
     11601**DCL     20997>>IF
QI_1.SOURCE$
     11605**DCL     20666>>ASSIGN
QI_1.SPECIAL_NAMES
     12468**DCL     12477--REDEF
QI_1.TYPE
     12291**DCL     12296--REDEF
QI_16_BIT_BINARY
     17481**DCL     17551--REDEF
QI_16_BIT_BINARY.CB
     17500**DCL     17503--REDEF   17507--REDEF   17510--REDEF
QI_31_DIGIT_SLS_DISPLAY
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:159  
     17314**DCL     17384--REDEF
QI_31_DIGIT_SLS_DISPLAY.CD
     17361**DCL     17364--REDEF   17368--REDEF   17371--REDEF
QI_31_DIGIT_ST_PACKED
     17816**DCL     17886--REDEF
QI_31_DIGIT_ST_PACKED.CP
     17849**DCL     17852--REDEF   17856--REDEF   17859--REDEF
QI_32_BIT_BINARY
     17648**DCL     17718--REDEF
QI_32_BIT_BINARY.CB
     17667**DCL     17670--REDEF   17674--REDEF   17677--REDEF
QI_4_CHAR_ALPHANUMERIC
     17146**DCL     17216--REDEF
QI_4_CHAR_ALPHANUMERIC.CA
     17151**DCL     17155--REDEF   17158--REDEF   17161--REDEF
QI_ACCUMULATOR_DAD.CIP
     18159**DCL     18230--REDEF
QI_ACCUMULATOR_DAD.CIP.CP
     18190**DCL     18193--REDEF   18197--REDEF   18200--REDEF
QI_ALR.CIP
     13111**DCL     13562--REDEF
QI_ALR.CIP.AUX
     13477**DCL     13548--REDEF
QI_ALR.CIP.AUX.CA
     13480**DCL     13484--REDEF   13487--REDEF   13490--REDEF
QI_ALR.CIP.S
     13181**DCL     13252--REDEF
QI_ALR.CIP.S.CA
     13184**DCL     13188--REDEF   13191--REDEF   13194--REDEF
QI_ALR.CIP.T
     13329**DCL     13400--REDEF
QI_ALR.CIP.T.CA
     13332**DCL     13336--REDEF   13339--REDEF   13342--REDEF
QI_ALR.DATA
     13569**DCL     13573--REDEF
QI_ALR.FILL_CHAR
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:160  
     13693**DCL     13696--REDEF
QI_ALR.INX
     13626**DCL     13630--REDEF   13631--REDEF   13635--REDEF
QI_ALR.LEN
     13609**DCL     13613--REDEF   13614--REDEF   13618--REDEF   13619--REDEF   13623--REDEF
QI_ALR.PICTURE_STRING
     13679**DCL     13682--REDEF   13683--REDEF   13686--REDEF   13687--REDEF   13690--REDEF
QI_ALR.ROUND
     13712**DCL     13713--REDEF   13714--REDEF
QI_ALR.SRCH_VRFY_ELEMS
     13648**DCL     13651--REDEF
QI_FPT_DBCONTROL.V_
     18531**DCL     18531--REDEF
QI_FPT_DCLFLD
     18587**DCL     22557>>ASSIGN
QI_FPT_GDS
     19014**DCL     21865>>ASSIGN
QI_FPT_INT.V_
     19369**DCL     19369--REDEF
QI_MAT.CIP
     16450**DCL     16901--REDEF
QI_MAT.CIP.AUX
     16816**DCL     16887--REDEF
QI_MAT.CIP.AUX.CA
     16819**DCL     16823--REDEF   16826--REDEF   16829--REDEF
QI_MAT.CIP.S
     16520**DCL     16591--REDEF
QI_MAT.CIP.S.CA
     16523**DCL     16527--REDEF   16530--REDEF   16533--REDEF
QI_MAT.CIP.T
     16668**DCL     16739--REDEF
QI_MAT.CIP.T.CA
     16671**DCL     16675--REDEF   16678--REDEF   16681--REDEF
QI_MAT.DATA
     16908**DCL     16912--REDEF
QI_MAT.DEC
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:161  
     16976**DCL     16980--REDEF   16981--REDEF   16985--REDEF
QI_MAT.FILL_CHAR
     17032**DCL     17035--REDEF
QI_MAT.LEN
     16948**DCL     16952--REDEF   16953--REDEF   16957--REDEF   16958--REDEF   16962--REDEF
QI_MAT.PICTURE_STRING
     17018**DCL     17021--REDEF   17022--REDEF   17025--REDEF   17026--REDEF   17029--REDEF
QI_MAT.ROUND
     17051**DCL     17052--REDEF   17053--REDEF
QI_MAT.SRCH_VRFY_ELEMS
     16987**DCL     16990--REDEF
QI_PICTURE_STRING
     17984**DCL     18054--REDEF
QI_PICTURE_STRING.CA
     17989**DCL     17993--REDEF   17996--REDEF   17999--REDEF
QI_SRCH_VRFY.CIP
     15781**DCL     16232--REDEF
QI_SRCH_VRFY.CIP.AUX
     16147**DCL     16218--REDEF
QI_SRCH_VRFY.CIP.AUX.CA
     16150**DCL     16154--REDEF   16157--REDEF   16160--REDEF
QI_SRCH_VRFY.CIP.S
     15851**DCL     15922--REDEF
QI_SRCH_VRFY.CIP.S.CA
     15854**DCL     15858--REDEF   15861--REDEF   15864--REDEF
QI_SRCH_VRFY.CIP.T
     15999**DCL     16070--REDEF
QI_SRCH_VRFY.CIP.T.CA
     16002**DCL     16006--REDEF   16009--REDEF   16012--REDEF
QI_SRCH_VRFY.DATA
     16239**DCL     16243--REDEF
QI_SRCH_VRFY.DEC
     16307**DCL     16311--REDEF   16312--REDEF   16316--REDEF
QI_SRCH_VRFY.FILL_CHAR
     16363**DCL     16366--REDEF
QI_SRCH_VRFY.ROUND
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:162  
     16382**DCL     16383--REDEF   16384--REDEF
QI_SRCH_VRFY.SRCH_RESULT
     16323**DCL     16326--REDEF   16327--REDEF   16330--REDEF   16331--REDEF   16334--REDEF
QI_SRCH_VRFY.SRCH_VRFY_ARGS
     16247**DCL     16251--REDEF   16252--REDEF   16256--REDEF   16257--REDEF   16261--REDEF
QI_SRCH_VRFY.SRCH_VRFY_ELEMS
     16318**DCL     16321--REDEF
QI_TYPE_BINARY_TARGET.CIP
     15108**DCL     15559--REDEF
QI_TYPE_BINARY_TARGET.CIP.AUX
     15474**DCL     15545--REDEF
QI_TYPE_BINARY_TARGET.CIP.AUX.CA
     15477**DCL     15481--REDEF   15484--REDEF   15487--REDEF
QI_TYPE_BINARY_TARGET.CIP.S
     15178**DCL     15249--REDEF
QI_TYPE_BINARY_TARGET.CIP.S.CA
     15181**DCL     15185--REDEF   15188--REDEF   15191--REDEF
QI_TYPE_BINARY_TARGET.CIP.T
     15326**DCL     15397--REDEF
QI_TYPE_BINARY_TARGET.CIP.T.CB
     15343**DCL     15346--REDEF   15350--REDEF   15353--REDEF
QI_TYPE_BINARY_TARGET.DATA
     15566**DCL     15570--REDEF
QI_TYPE_BINARY_TARGET.DEC
     15634**DCL     15638--REDEF   15639--REDEF   15643--REDEF
QI_TYPE_BINARY_TARGET.LEN
     15606**DCL     15610--REDEF   15611--REDEF   15615--REDEF   15616--REDEF   15620--REDEF
QI_TYPE_BINARY_TARGET.PICTURE_STRING
     15676**DCL     15679--REDEF   15680--REDEF   15683--REDEF   15684--REDEF   15687--REDEF
QI_TYPE_BINARY_TARGET.ROUND
     15709**DCL     15710--REDEF   15711--REDEF
QI_TYPE_BINARY_TARGET.SIZE_ERROR
     15695**DCL     15696--REDEF
QI_TYPE_BINARY_TARGET.SRCH_VRFY_ELEMS
     15645**DCL     15648--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:163  
     13776**DCL     14227--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.AUX
     14142**DCL     14213--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.AUX.CA
     14145**DCL     14149--REDEF   14152--REDEF   14155--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.S
     13846**DCL     13917--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.S.CD
     13891**DCL     13894--REDEF   13898--REDEF   13901--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.T
     13994**DCL     14065--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.T.CA
     13997**DCL     14001--REDEF   14004--REDEF   14007--REDEF
QI_TYPE_DISPLAY_SOURCE.DATA
     14234**DCL     14238--REDEF
QI_TYPE_DISPLAY_SOURCE.DEC
     14302**DCL     14306--REDEF   14307--REDEF   14311--REDEF
QI_TYPE_DISPLAY_SOURCE.LEN
     14274**DCL     14278--REDEF   14279--REDEF   14283--REDEF   14284--REDEF   14288--REDEF
QI_TYPE_DISPLAY_SOURCE.PICTURE_STRING
     14344**DCL     14347--REDEF   14348--REDEF   14351--REDEF   14352--REDEF   14355--REDEF
QI_TYPE_DISPLAY_SOURCE.ROUND
     14377**DCL     14378--REDEF   14379--REDEF
QI_TYPE_DISPLAY_SOURCE.SIZE_ERROR
     14363**DCL     14364--REDEF
QI_TYPE_DISPLAY_SOURCE.SRCH_VRFY_ELEMS
     14313**DCL     14316--REDEF
QI_TYPE_DISPLAY_TARGET.CIP
     14442**DCL     14893--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.AUX
     14808**DCL     14879--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.AUX.CA
     14811**DCL     14815--REDEF   14818--REDEF   14821--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.S
     14512**DCL     14583--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.S.CA
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:164  
     14515**DCL     14519--REDEF   14522--REDEF   14525--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.T
     14660**DCL     14731--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.T.CD
     14705**DCL     14708--REDEF   14712--REDEF   14715--REDEF
QI_TYPE_DISPLAY_TARGET.DATA
     14900**DCL     14904--REDEF
QI_TYPE_DISPLAY_TARGET.DEC
     14968**DCL     14972--REDEF   14973--REDEF   14977--REDEF
QI_TYPE_DISPLAY_TARGET.LEN
     14940**DCL     14944--REDEF   14945--REDEF   14949--REDEF   14950--REDEF   14954--REDEF
QI_TYPE_DISPLAY_TARGET.PICTURE_STRING
     15010**DCL     15013--REDEF   15014--REDEF   15017--REDEF   15018--REDEF   15021--REDEF
QI_TYPE_DISPLAY_TARGET.ROUND
     15043**DCL     15044--REDEF   15045--REDEF
QI_TYPE_DISPLAY_TARGET.SIZE_ERROR
     15029**DCL     15030--REDEF
QI_TYPE_DISPLAY_TARGET.SRCH_VRFY_ELEMS
     14979**DCL     14982--REDEF
QI_VLP_FLDATR
     18652**DCL     22561>>ASSIGN
QI_VLP_SEGMENT.BASE
     19068**DCL     19068--REDEF
QI_VLP_SEGMENT.BASE$
     19068**DCL     21857>>ASSIGN
QI_VLP_SEGMENT.PAGES
     19068**DCL     21857>>ASSIGN
QI_VLP_SEGMENT_BUFFER.BASE
     19166**DCL     19166--REDEF
QI_VLP_SEGMENT_LOAD.BASE
     19264**DCL     19264--REDEF
QI_VLP_TRMCTL.BREAKCOUNT
     20258**DCL     20259--REDEF
QI_VLP_XBREAK.IC
     20448**DCL     20448--REDEF
QI_VLP_XBREAK.OLDIC
PL6.E3A0      #001=QBA$ACTIVATE File=QBA$ACTIVATE.:E05TSI                        WED 07/30/97 04:41 Page:165  
     20448**DCL     20449--REDEF   20449--REDEF
REPEATS_INDEX
     20519**DCL     21272<<ASSIGN  21276<<ASSIGN  21276>>ASSIGN  21289>>ASSIGN  22069<<ASSIGN  22073<<ASSIGN
     22073>>ASSIGN  22086>>ASSIGN
RETRY_CURRENT_ACT_DEACT_IVATE
     20691**LABEL   20857--GOTO
RE_DCL_A_FIELD IN PROCEDURE ACTIVATE_FRAME
     22569**LABEL   22874--GOTO
ROW_INCREMENT
     20520**DCL     22010<<ASSIGN  22304>>ASSIGN
ROW_INDEX
     20523**DCL     22200<<DOINDEX 22248>>ASSIGN  22318--ASSIGN
ROW_INDEX_STOP
     20524**DCL     21908<<ASSIGN  22200>>DOINDEX 22320<<ASSIGN  22395<<ASSIGN
ROW_REPEATS$
     20521**DCL     21907<<ASSIGN  22315>>IF      22322<<ASSIGN  22390>>IF      22394<<ASSIGN
SEPARATED_INDEX
     20522**DCL     21196<<ASSIGN  21200<<ASSIGN  21200>>ASSIGN  21213>>ASSIGN
SO_ACTIVATE_IT_ALREADY
     20664**LABEL   20657--GOTO
TOTAL_GZ_NEEDED
     20525**DCL     21854<<ASSIGN  21860>>IF      21867>>ASSIGN  21878>>ASSIGN
TOTAL_GZ_SPACE
     20526**DCL     21857<<ASSIGN  21860>>IF      21867>>ASSIGN
VLP@FLDATR
      1427**DCL     22560--ASSIGN  22561<<ASSIGN
VLP@FLDATR.ABSGRPRND
      1433**DCL     22578<<ASSIGN
VLP@FLDATR.QLF.CNS
      1433**DCL     22576<<ASSIGN
VLP@FLDATR.QLF.MSTENT
      1432**DCL     22577<<ASSIGN

PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:166  
     1213        1        /*M* QBA$DEACTIVATE_FORM:  DEACTIVATE a FORM.  */
     1214        2        /*T***********************************************************/
     1215        3        /*T*                                                         */
     1216        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1217        5        /*T*                                                         */
     1218        6        /*T***********************************************************/
     1219        7        /*X* DMC,PLM=4,IND=0,DCI=4,CSI=2,IAD=2,DTI=2,AND,ECI=0,DIN=2,STI=2 */
     1220        8
     1221        9        /*P*  NAME:         QBA$DEACTIVATE_FORM
     1222       10              PURPOSE:      Deactivate fields within a form.
     1223       11              DESCRIPTION:  Call M$SLCFLD and M$RLSFLD for a form
     1224       12                            identified by QI_1.CURRENT.whatevers.
     1225       13        */
     1226       14
     1227       15        QBA$DEACTIVATE_FORM: PROC ALTRET;
     1228       16
     1229       17        /*D*  NAME:         QBA$DEACTIVATE_FORM
     1230       18              CALL:         CALL QBA$DEACTIVATE_FORM [ALTRET (label)];
     1231       19              PARAMETERS:   None.
     1232       20              INTERFACE:    Called by QBA$DEACTIVATE for
     1233       21                            'DEACTIVATE FORM-NAME'-type statements;
     1234       22                            called by QBC$CLOSE for
     1235       23                            'CLOSE FORM-NAME'-type statments.
     1236       24              ENVIRONMENT:  Nothing unusual.
     1237       25              INPUT:        QI_1.CURRENT.stuff.
     1238       26              OUTPUT:       Mostly affects dynamic memory by deallocating
     1239       27                            it, if deemed necessary.
     1240       28              SCRATCH:      Various otter data.
     1241       29              DESCRIPTION:  Deallocation of dynamic memory occurs only off
     1242       30                            the end of the dynamic segment.  So, if this
     1243       31                            form contains the frame allocated at the end
     1244       32                            of the segment, we'll search backward (to
     1245       33                            lower addresses) in the segment to see how many
     1246       34                            other frames have been deactivated.  If enough
     1247       35                            are deactivated to total 1 page or more (but
     1248       36                            not the first page), M$FDS is called to free the
     1249       37                            excess.  This includes one QI$GZ_HEADER structure
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:167  
     1250       38                            per frame, and one QI$GZ_FIELD structure for
     1251       39                            each field within a frame.
     1252       40                            M$RLSFLD is called for each field whether
     1253       41                            the memory is deallocated or not.
     1254       42        */
     1255       43
     1256       44          %INCLUDE LCP_6;
     1257      235          %FPT_FDS ( FPTN = FPT@FDS,
     1258      236                     STCLASS = AUTO );
     1259      258          %FPT_RLSFLD ( FPTN = FPT@RLSFLD,
     1260      259                        STCLASS = AUTO );
     1261      291          %FPT_SLCFLD ( FPTN = FPT@SLCFLD,
     1262      292                        STCLASS = AUTO );
     1263      324
     1264      325          %INCLUDE QG_MACRO_M;
     1265      462          %QGB_ENTRIES;
     1266      475          %INCLUDE QI_EQUATES_E;
     1267      834          %INCLUDE QI_PERR_C;
     1268     1002          %INCLUDE QI_MACROS_M;
     1269     6060          %QI$ALL;
     1270    17173          %QI_FPTS;
     1271    19218
     1272    19219    1     DCL FIELD_COUNT UBIN;
     1273    19220    1     DCL FRAME_INDEX UBIN;
     1274    19221    1     DCL FRAME_STATUS$ PTR;
     1275    19222    1     DCL GZ_FIELD$ PTR;
     1276    19223    1     DCL GZ_HEADER$ PTR;
     1277    19224    1     DCL ITS_A_DEACTIVATE_FORM BIT(1) UNAL;
     1278    19225    1     DCL MASTER_ALREADY_GOT_EM_FLAG BIT(1) UNAL;
     1279    19226    1     DCL TOTAL_GZ_SPACE_IN_PAGES UBIN;
     1280    19227
     1281    19228    1     DCL QCE$ERROR_INTERNAL ENTRY (4);
     1282    19229    1     DCL QCE$ERROR_M$INTERNAL ENTRY (4);
     1283    19230        %EJECT;
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:168  
     1284    19231    1       ITS_A_DEACTIVATE_FORM = %YES;
     1285    19232    1       MASTER_ALREADY_GOT_EM_FLAG = %NO;
     1286    19233
     1287    19234    2       DO FRAME_INDEX = 0 TO QI_1.CURRENT.FORM$ -> QI$FORM_FILE.FRAME_COUNT - 1;
     1288    19235
     1289    19236              %PROC_ADDRESS ( THING@P =
             19236                  "QI_1.CURRENT.FORM$ -> QI$FORM_FILE.FRAME_LIST_A@P ( FRAME_INDEX )",
     1290    19237              CHECK_FOR_INDIRECTION = NO,
     1291    19238              RESULT$ = "QI_1.CURRENT.FRAME$" );
     1292    19275
     1293    19276              %DATA_ADDRESS ( THING@D = "QI_1.CURRENT.FRAME$ -> QI$FRAME.STATUS_AREA@D",
     1294    19277              CHECK_FOR_INDIRECTION = NO,
     1295    19278              RESULT$ = "QI_1.CURRENT.FRAME_STATUS$" );
     1296    19315
     1297    19316    2         IF QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.INDICATORS.IS_ACTIVE
     1298    19317    2         THEN
     1299    19318    2   DEACTIVATE_THAT_FRAME:
     1300    19319    3           DO;
     1301    19320
     1302    19321    3             CALL DEACTIVATE_FRAME
     1303    19322    3             WHENALTRETURN
     1304    19323    4               DO;
     1305    19324    4                 CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );
     1306    19325    4               END;
     1307    19326
     1308    19327    3           END DEACTIVATE_THAT_FRAME;
     1309    19328
     1310    19329    2       END;
     1311    19330
     1312    19331    1       CALL QGB$FLUSH ( , QGB_PARAM )
     1313    19332    1       WHENALTRETURN
     1314    19333    2         DO;
     1315    19334    2           CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );
     1316    19335    2         END;
     1317    19336
     1318    19337    1       RETURN;
     1319    19338
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:169  
     1320    19339        %EJECT;
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:170  
     1321    19340    1   QBA$DEACTIVATE_FRAME: ENTRY ALTRET;
     1322    19341
     1323    19342        /*D*  NAME:         QBA$DEACTIVATE_FRAME
     1324    19343              CALL:         CALL QBA$DEACTIVATE_FRAME [ALTRET (label)];
     1325    19344              PARAMETERS:   None.
     1326    19345              INTERFACE:    Called by QBA$DEACTIVATE for
     1327    19346                            'DEACTIVATE FRAME-NAME'-type statements.
     1328    19347              ENVIRONMENT:  Nothing unusual.
     1329    19348              INPUT:        QI_1.CURRENT.stuff.
     1330    19349              OUTPUT:       Mostly affects dynamic memory by deallocating
     1331    19350                            it, if deemed necessary.
     1332    19351              SCRATCH:      Various otter data.
     1333    19352              DESCRIPTION:  See QBA$DEACTIVATE_FORM.
     1334    19353        */
     1335    19354
     1336    19355    1       ITS_A_DEACTIVATE_FORM = %NO;
     1337    19356    1       MASTER_ALREADY_GOT_EM_FLAG = %NO;
     1338    19357
     1339    19358    1       CALL DEACTIVATE_FRAME
     1340    19359    1       WHENALTRETURN
     1341    19360    2         DO;
     1342    19361    2           ALTRETURN;
     1343    19362    2         END;
     1344    19363
     1345    19364    1       CALL QGB$FLUSH ( , QGB_PARAM )
     1346    19365    1       WHENALTRETURN
     1347    19366    2         DO;
     1348    19367    2           CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );
     1349    19368    2         END;
     1350    19369
     1351    19370    1       RETURN;
     1352    19371
     1353    19372        %EJECT;
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:171  
     1354    19373    1   DEACTIVATE_FRAME: PROC ALTRET;
     1355    19374
     1356    19375        /*I*  NAME:         DEACTIVATE_FRAME
     1357    19376              PURPOSE:      RLSFLD all the fields in a frame.
     1358    19377              PARAMETERS:   None.
     1359    19378              DATA:         The usual global stuff.
     1360    19379              PURPOSE:      May deallocate dynamic memory for GZ$whatevers for
     1361    19380                            a frame.  (See *D* for QBA$DEACTIVATE_FORM).
     1362    19381                            M$RLSFLD is called for each field; M$SLCFLD may
     1363    19382                            be called without a key (SeLeCting all fields
     1364    19383                            on the screen) if we're deactivating an entire
     1365    19384                            form and it's the only one open.
     1366    19385        */
     1367    19386
     1368    19387    2       IF NOT QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.INDICATORS.IS_ACTIVE
     1369    19388    2       THEN
     1370    19389    3         DO;
     1371    19390    3           QI_1.ERROR_STATUS = %E$FRAME_ALREADY_DEACTIVATED;
     1372    19391    3           ALTRETURN;
     1373    19392    3         END;
     1374    19393
     1375    19394    2       GZ_HEADER$ = QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.HEADER$;
     1376    19395    2       GZ_FIELD$ = PINCRW ( GZ_HEADER$, SIZEW (QI$GZ_HEADER) );
     1377    19396
     1378    19397    2       IF NOT MASTER_ALREADY_GOT_EM_FLAG
     1379    19398    2       THEN
     1380    19399    2   RELEASE_ALL_THE_FIELDS:
     1381    19400    3         DO;
     1382    19401
     1383    19402    3           FPT@SLCFLD = QI_FPT_SLCFLD;
     1384    19403    3           VBASE ( FPT@SLCFLD.V_ ) = ADDR ( FPT@SLCFLD.V );
     1385    19404    3           FPT@SLCFLD.V.DCB# = QI_1.CURRENT.FORM$ -> QI$FORM_FILE.DCB#;
     1386    19405
     1387    19406                /*  If we're deactivating a form, and it's the only form
     1388    19407                    open, we can do a SELECT of all the fields at once.  */
     1389    19408    3           IF ITS_A_DEACTIVATE_FORM
     1390    19409    3             AND QI_1.OPENED_COUNT.FORM = 1
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:172  
     1391    19410    3           THEN
     1392    19411    3   SELECT_ALL_OF_EM_AT_ONCE:
     1393    19412    4             DO;
     1394    19413
     1395    19414    4               MASTER_ALREADY_GOT_EM_FLAG = %YES;
     1396    19415
     1397    19416    4               CALL QGB$SLCFLD ( FPT@SLCFLD, QGB_PARAM )
     1398    19417    4               WHENALTRETURN
     1399    19418    5                 DO;
     1400    19419    5                   CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );
     1401    19420    5                 END;
     1402    19421
     1403    19422    4             END SELECT_ALL_OF_EM_AT_ONCE;
     1404    19423    3           ELSE
     1405    19424    3   SELECT_ONE_OF_EM_AT_A_TIME:
     1406    19425    4             DO;
     1407    19426
     1408    19427    5               DO FIELD_COUNT = 1 TO GZ_HEADER$ -> QI$GZ_HEADER.FIELD_COUNT;
     1409    19428
     1410    19429    5                 FPT@SLCFLD.KEY_ = VECTOR ( GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.
             19429                          POSITION );
     1411    19430
     1412    19431    5                 CALL QGB$SLCFLD ( FPT@SLCFLD, QGB_PARAM )
     1413    19432    5                 WHENALTRETURN
     1414    19433    6                   DO;
     1415    19434    6                     CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );
     1416    19435    6                   END;
     1417    19436
     1418    19437    5                 GZ_FIELD$ = PINCRW ( GZ_FIELD$, SIZEW (QI$GZ_FIELD) );
     1419    19438
     1420    19439    5               END;
     1421    19440
     1422    19441    4             END SELECT_ONE_OF_EM_AT_A_TIME;
     1423    19442
     1424    19443    3           FPT@RLSFLD = QI_FPT_RLSFLD;
     1425    19444    3           VBASE ( FPT@RLSFLD.V_ ) = ADDR ( FPT@RLSFLD.V );
     1426    19445    3           FPT@RLSFLD.V.DCB# = FPT@SLCFLD.V.DCB#;
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:173  
     1427    19446
     1428    19447    3           CALL QGB$RLSFLD ( FPT@RLSFLD, QGB_PARAM )
     1429    19448    3           WHENALTRETURN
     1430    19449    4             DO;
     1431    19450    4               CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );
     1432    19451    4             END;
     1433    19452
     1434    19453    3           QI_1.SCREEN_UPDATE_FLAGS.WAS_DEACTIVATED = %YES;
     1435    19454
     1436    19455    3         END RELEASE_ALL_THE_FIELDS;
     1437    19456
     1438    19457    2       GZ_HEADER$ -> QI$GZ_HEADER.IS_ACTIVE = %NO;
     1439    19458
     1440    19459    2       IF GZ_HEADER$ = QI_1.GZ.LAST_HEADER$
     1441    19460    2       THEN
     1442    19461    2   PRUNE_BACK_THE_SEGMENT_SOME:
     1443    19462    3         DO;
     1444    19463
     1445    19464    3   PRUNE_BACK_THE_SEGMENT_MORE:
     1446    19465    4           DO WHILE ( GZ_HEADER$ -> QI$GZ_HEADER.IS_ACTIVE = %NO );
     1447    19466
     1448    19467    4             QI_1.GZ.AVAILABLE$ = GZ_HEADER$;
     1449    19468    4             QI_1.GZ.LAST_HEADER$ = GZ_HEADER$ -> QI$GZ_HEADER.BACK_LINK$;
     1450    19469                  %DATA_ADDRESS ( THING@D =
             19469                      "GZ_HEADER$ -> QI$GZ_HEADER.FRAME_DAD$ -> QI$FRAME.STATUS_AREA@D",
     1451    19470                  CHECK_FOR_INDIRECTION = NO,
     1452    19471                  RESULT$ = FRAME_STATUS$ );
     1453    19508    4             FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.HEADER$ = ADDR (NIL);
     1454    19509    4             GZ_HEADER$ = QI_1.GZ.LAST_HEADER$;
     1455    19510
     1456    19511    4           END PRUNE_BACK_THE_SEGMENT_MORE;
     1457    19512
     1458    19513    3           TOTAL_GZ_SPACE_IN_PAGES = ( ( QI_VLP_SEGMENT.PAGES * 256 )
     1459    19514    3             - POFFW ( QI_1.GZ.AVAILABLE$, QI_VLP_SEGMENT.BASE$ ) )
     1460    19515    3             / 256;
     1461    19516
     1462    19517    3           IF TOTAL_GZ_SPACE_IN_PAGES > 0
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:174  
     1463    19518    3           THEN
     1464    19519    3   FDS_SOME_MEMORY:
     1465    19520    4             DO;
     1466    19521
     1467    19522    4               FPT@FDS = QI_FPT_FDS;
     1468    19523    4               VBASE ( FPT@FDS.V_ ) = ADDR ( FPT@FDS.V );
     1469    19524    4               FPT@FDS.V.PAGES = TOTAL_GZ_SPACE_IN_PAGES;
     1470    19525
     1471    19526    4               CALL M$FDS ( FPT@FDS )
     1472    19527    4               WHENALTRETURN
     1473    19528    5                 DO;
     1474    19529    5                   CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );
     1475    19530    5                 END;
     1476    19531
     1477    19532    4             END FDS_SOME_MEMORY;
     1478    19533
     1479    19534    3         END PRUNE_BACK_THE_SEGMENT_SOME;
     1480    19535
     1481    19536    2       QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.INDICATORS.IS_ACTIVE = %NO;
     1482    19537    2       QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.CURRENT.USAGE.DEACTIVATED = %YES;
     1483    19538
     1484    19539    2       RETURN;
     1485    19540
     1486    19541    2   END DEACTIVATE_FRAME;
     1487    19542
     1488    19543    1   END QBA$DEACTIVATE_FORM;

PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:175  
--  Include file information  --

   QI_MACROS_M.:E05TOU  is referenced.
   QI_PERR_C.:E05TOU  is referenced.
   QI_EQUATES_E.:E05TOU  is referenced.
   QG_MACRO_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QBA$DEACTIVATE_FORM.

   Procedure QBA$DEACTIVATE_FORM requires 511 words for executable code.
   Procedure QBA$DEACTIVATE_FORM requires 66 words of local(AUTO) storage.

    No errors detected in file QBA$ACTIVATE.:E05TSI    .

PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:176  

 Object Unit name= QBA$DEACTIVATE_FORM                        File name= QBA$ACTIVATE.:E05TOU
 UTS= JUL 30 '97 04:44:12.72 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   Proc  even  none   511    1FF  QBA$DEACTIVATE_FORM
    1  RoData even  none     7      7  QBA$DEACTIVATE_FORM

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        0  QBA$DEACTIVATE_FORM
     0     69          yes     yes      Std        0  QBA$DEACTIVATE_FRAME

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       4 QCE$ERROR_INTERNAL
         yes           Std       4 QCE$ERROR_M$INTERNAL
 yes     yes           Std       2 QGB$FLUSH
 yes     yes           Std       2 QGB$SLCFLD
 yes     yes           Std       2 QGB$RLSFLD
                       nStd      0 X6A_AUTO_0
                       nStd      0 X6A_ARET
                       nStd      0 X6A_AALT
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:177  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     QI_1                                  QGB_PARAM                             QI_4_CHAR_ALPHANUMERIC
     QI_31_DIGIT_SLS_DISPLAY               QI_16_BIT_BINARY                      QI_32_BIT_BINARY
     QI_31_DIGIT_ST_PACKED                 QI_PICTURE_STRING                     QI_FPT_FDS
     QI_VLP_SEGMENT                        QI_FPT_RLSFLD                         QI_FPT_SLCFLD
r    G$ROS$
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:178  


     1213        1        /*M* QBA$DEACTIVATE_FORM:  DEACTIVATE a FORM.  */
     1214        2        /*T***********************************************************/
     1215        3        /*T*                                                         */
     1216        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1217        5        /*T*                                                         */
     1218        6        /*T***********************************************************/
     1219        7        /*X* DMC,PLM=4,IND=0,DCI=4,CSI=2,IAD=2,DTI=2,AND,ECI=0,DIN=2,STI=2 */
     1220        8
     1221        9        /*P*  NAME:         QBA$DEACTIVATE_FORM
     1222       10              PURPOSE:      Deactivate fields within a form.
     1223       11              DESCRIPTION:  Call M$SLCFLD and M$RLSFLD for a form
     1224       12                            identified by QI_1.CURRENT.whatevers.
     1225       13        */
     1226       14
     1227       15        QBA$DEACTIVATE_FORM: PROC ALTRET;

     15   0 000000  D380 0000 0000  xent QBA$DEACTIVATE_*LNJ,B5   X6A_AUTO_0
          0 000003       0042 0000                       DC       66,0

     1228       16
     1229       17        /*D*  NAME:         QBA$DEACTIVATE_FORM
     1230       18              CALL:         CALL QBA$DEACTIVATE_FORM [ALTRET (label)];
     1231       19              PARAMETERS:   None.
     1232       20              INTERFACE:    Called by QBA$DEACTIVATE for
     1233       21                            'DEACTIVATE FORM-NAME'-type statements;
     1234       22                            called by QBC$CLOSE for
     1235       23                            'CLOSE FORM-NAME'-type statments.
     1236       24              ENVIRONMENT:  Nothing unusual.
     1237       25              INPUT:        QI_1.CURRENT.stuff.
     1238       26              OUTPUT:       Mostly affects dynamic memory by deallocating
     1239       27                            it, if deemed necessary.
     1240       28              SCRATCH:      Various otter data.
     1241       29              DESCRIPTION:  Deallocation of dynamic memory occurs only off
     1242       30                            the end of the dynamic segment.  So, if this
     1243       31                            form contains the frame allocated at the end
     1244       32                            of the segment, we'll search backward (to
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:179  
     1245       33                            lower addresses) in the segment to see how many
     1246       34                            other frames have been deactivated.  If enough
     1247       35                            are deactivated to total 1 page or more (but
     1248       36                            not the first page), M$FDS is called to free the
     1249       37                            excess.  This includes one QI$GZ_HEADER structure
     1250       38                            per frame, and one QI$GZ_FIELD structure for
     1251       39                            each field within a frame.
     1252       40                            M$RLSFLD is called for each field whether
     1253       41                            the memory is deallocated or not.
     1254       42        */
     1255       43
     1256       44          %INCLUDE LCP_6;
     1257      235          %FPT_FDS ( FPTN = FPT@FDS,
     1258      236                     STCLASS = AUTO );
     1259      258          %FPT_RLSFLD ( FPTN = FPT@RLSFLD,
     1260      259                        STCLASS = AUTO );
     1261      291          %FPT_SLCFLD ( FPTN = FPT@SLCFLD,
     1262      292                        STCLASS = AUTO );
     1263      324
     1264      325          %INCLUDE QG_MACRO_M;
     1265      462          %QGB_ENTRIES;
     1266      475          %INCLUDE QI_EQUATES_E;
     1267      834          %INCLUDE QI_PERR_C;
     1268     1002          %INCLUDE QI_MACROS_M;
     1269     6060          %QI$ALL;
     1270    17173          %QI_FPTS;
     1271    19218
     1272    19219    1     DCL FIELD_COUNT UBIN;
     1273    19220    1     DCL FRAME_INDEX UBIN;
     1274    19221    1     DCL FRAME_STATUS$ PTR;
     1275    19222    1     DCL GZ_FIELD$ PTR;
     1276    19223    1     DCL GZ_HEADER$ PTR;
     1277    19224    1     DCL ITS_A_DEACTIVATE_FORM BIT(1) UNAL;
     1278    19225    1     DCL MASTER_ALREADY_GOT_EM_FLAG BIT(1) UNAL;
     1279    19226    1     DCL TOTAL_GZ_SPACE_IN_PAGES UBIN;
     1280    19227
     1281    19228    1     DCL QCE$ERROR_INTERNAL ENTRY (4);
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:180  
     1282    19229    1     DCL QCE$ERROR_M$INTERNAL ENTRY (4);
     1283    19230        %EJECT;
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:181  
     1284    19231    1       ITS_A_DEACTIVATE_FORM = %YES;

  19231   0 000005  8947 0024                            LBT,'8000'X       ITS_A_DEACTIVATE_FORM,AUTO
  19231   0 000007       8000

     1285    19232    1       MASTER_ALREADY_GOT_EM_FLAG = %NO;

  19232   0 000008  8747 0025                            CL       MASTER_ALREADY_GOT_EM_FLAG,AUTO

     1286    19233
     1287    19234    2       DO FRAME_INDEX = 0 TO QI_1.CURRENT.FORM$ -> QI$FORM_FILE.FRAME_COUNT - 1;

  19234   0 00000A  8747 001D                            CL       FRAME_INDEX,AUTO
          0 00000C  0F81 0034                            B        s:19329+2,PREL

     1288    19235
     1289    19236              %PROC_ADDRESS ( THING@P =
             19236                  "QI_1.CURRENT.FORM$ -> QI$FORM_FILE.FRAME_LIST_A@P ( FRAME_INDEX )",
     1290    19237              CHECK_FOR_INDIRECTION = NO,
     1291    19238              RESULT$ = "QI_1.CURRENT.FRAME$" );

  19256   0 00000E  EC80 0000 0076  xsym                 LDB,B6   QI_1+118
          0 000011  B847 001D                            LDR,R3   FRAME_INDEX,AUTO
          0 000013  3E0B                                 ADV,R3   11
          0 000014  A836                                 LDR,R2   ,B6,R3
          0 000015  F852                                 LDR,R7   R2
          0 000016  6C00                                 LDV,R6   0
          0 000017  8400 0000 0002  xsym                 AID      QI_1+2
          0 00001A  8D00 0000 007A  xsym                 SDI      QI_1+122

     1292    19275
     1293    19276              %DATA_ADDRESS ( THING@D = "QI_1.CURRENT.FRAME$ -> QI$FRAME.STATUS_AREA@D",
     1294    19277              CHECK_FOR_INDIRECTION = NO,
     1295    19278              RESULT$ = "QI_1.CURRENT.FRAME_STATUS$" );

  19296   0 00001D  DC80 0000 007A  xsym                 LDB,B5   QI_1+122
          0 000020  9845 0006                            LDR,R1   6,B5
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:182  
          0 000022  F851                                 LDR,R7   R1
          0 000023  6C00                                 LDV,R6   0
          0 000024  8400 0000 0000  xsym                 AID      QI_1
          0 000027  8D00 0000 007C  xsym                 SDI      QI_1+124

     1296    19315
     1297    19316    2         IF QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.INDICATORS.IS_ACTIVE

  19316   0 00002A  CC80 0000 007C  xsym                 LDB,B4   QI_1+124
          0 00002D  89C4 000C                            CMZ      12,B4
          0 00002F  0881 000F                            BAGE     s:19329,PREL

     1298    19317    2         THEN
     1299    19318    2   DEACTIVATE_THAT_FRAME:
     1300    19319    3           DO;

  19319   0                              DEACTIVATE_THAT*null
     1301    19320
     1302    19321    3             CALL DEACTIVATE_FRAME

  19321   0 000031  E3C0 0068            DEACTIVATE_THAT*LNJ,B6   s:0,PREL
          0 000033       0003                            DC       s:19324,PREL
          0 000034  0F81 000A                            B        s:19329,PREL

     1303    19322    3             WHENALTRETURN
     1304    19323    4               DO;

     1305    19324    4                 CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );

  19324   0 000036  BB80 0000 0001  01                   LAB,B3   +1
          0 000039  CBF0 0100                            LAB,B4   256,IMO
          0 00003B  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          0 00003E       0001                            DC       s:19329,PREL

     1306    19325    4               END;

     1307    19326
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:183  
     1308    19327    3           END DEACTIVATE_THAT_FRAME;

     1309    19328
     1310    19329    2       END;

  19329   0 00003F  8AC7 001D                            INC      FRAME_INDEX,AUTO
          0 000041  EC80 0000 0076  xsym                 LDB,B6   QI_1+118
          0 000044  E847 001D                            LDR,R6   FRAME_INDEX,AUTO
          0 000046  E946 0001                            CMR,R6   1,B6
          0 000048  0246                                 BL       s:19256,SPREL

     1311    19330
     1312    19331    1       CALL QGB$FLUSH ( , QGB_PARAM )

  19331   0 000049  DB80 0000 0000  xsym                 LAB,B5   QGB_PARAM
          0 00004C  DFC7 002C                            STB,B5   TOTAL_GZ_SPACE_IN_PAGES+6,AUTO
          0 00004E  CB80 0000 0000                       LAB,B4   0
          0 000051  CFC7 002A                            STB,B4   TOTAL_GZ_SPACE_IN_PAGES+4,AUTO
          0 000053  BBC7 002A                            LAB,B3   TOTAL_GZ_SPACE_IN_PAGES+4,AUTO
          0 000055  CBF0 0200                            LAB,B4   512,IMO
          0 000057  E380 0000 0000  xent                 LNJ,B6   QGB$FLUSH
          0 00005A       0003                            DC       s:19334,PREL
          0 00005B  0F81 000A                            B        s:19337,PREL

     1313    19332    1       WHENALTRETURN
     1314    19333    2         DO;

     1315    19334    2           CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );

  19334   0 00005D  BB80 0000 0004  01                   LAB,B3   +4
          0 000060  CBF0 0100                            LAB,B4   256,IMO
          0 000062  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_M$INTERNAL
          0 000065       0001                            DC       s:19337,PREL

     1316    19335    2         END;

     1317    19336
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:184  
     1318    19337    1       RETURN;

  19337   0 000066  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     1319    19338
     1320    19339        %EJECT;
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:185  
     1321    19340    1   QBA$DEACTIVATE_FRAME: ENTRY ALTRET;

  19340   0 000069  D380 0000 0000  xent QBA$DEACTIVATE_*LNJ,B5   X6A_AUTO_0
          0 00006C       0042 0000                       DC       66,0

     1322    19341
     1323    19342        /*D*  NAME:         QBA$DEACTIVATE_FRAME
     1324    19343              CALL:         CALL QBA$DEACTIVATE_FRAME [ALTRET (label)];
     1325    19344              PARAMETERS:   None.
     1326    19345              INTERFACE:    Called by QBA$DEACTIVATE for
     1327    19346                            'DEACTIVATE FRAME-NAME'-type statements.
     1328    19347              ENVIRONMENT:  Nothing unusual.
     1329    19348              INPUT:        QI_1.CURRENT.stuff.
     1330    19349              OUTPUT:       Mostly affects dynamic memory by deallocating
     1331    19350                            it, if deemed necessary.
     1332    19351              SCRATCH:      Various otter data.
     1333    19352              DESCRIPTION:  See QBA$DEACTIVATE_FORM.
     1334    19353        */
     1335    19354
     1336    19355    1       ITS_A_DEACTIVATE_FORM = %NO;

  19355   0 00006E  8747 0024                            CL       ITS_A_DEACTIVATE_FORM,AUTO

     1337    19356    1       MASTER_ALREADY_GOT_EM_FLAG = %NO;

  19356   0 000070  8747 0025                            CL       MASTER_ALREADY_GOT_EM_FLAG,AUTO

     1338    19357
     1339    19358    1       CALL DEACTIVATE_FRAME

  19358   0 000072  E3C0 0027                            LNJ,B6   s:0,PREL
          0 000074       0003                            DC       s:19361,PREL
          0 000075  0F81 0004                            B        s:19364,PREL

     1340    19359    1       WHENALTRETURN
     1341    19360    2         DO;

PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:186  
     1342    19361    2           ALTRETURN;

  19361   0 000077  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

     1343    19362    2         END;
     1344    19363
     1345    19364    1       CALL QGB$FLUSH ( , QGB_PARAM )

  19364   0 00007A  EB80 0000 0000  xsym                 LAB,B6   QGB_PARAM
          0 00007D  EFC7 002C                            STB,B6   TOTAL_GZ_SPACE_IN_PAGES+6,AUTO
          0 00007F  DB80 0000 0000                       LAB,B5   0
          0 000082  DFC7 002A                            STB,B5   TOTAL_GZ_SPACE_IN_PAGES+4,AUTO
          0 000084  BBC7 002A                            LAB,B3   TOTAL_GZ_SPACE_IN_PAGES+4,AUTO
          0 000086  CBF0 0200                            LAB,B4   512,IMO
          0 000088  E380 0000 0000  xent                 LNJ,B6   QGB$FLUSH
          0 00008B       0003                            DC       s:19367,PREL
          0 00008C  0F81 000A                            B        s:19370,PREL

     1346    19365    1       WHENALTRETURN
     1347    19366    2         DO;

     1348    19367    2           CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );

  19367   0 00008E  BB80 0000 0004  01                   LAB,B3   +4
          0 000091  CBF0 0100                            LAB,B4   256,IMO
          0 000093  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_M$INTERNAL
          0 000096       0001                            DC       s:19370,PREL

     1349    19368    2         END;

     1350    19369
     1351    19370    1       RETURN;

  19370   0 000097  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     1352    19371
     1353    19372        %EJECT;
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:187  
     1354    19373    1   DEACTIVATE_FRAME: PROC ALTRET;

  19373   0 00009A  EFC7 0028            DEACTIVATE_FRAMESTB,B6   TOTAL_GZ_SPACE_IN_PAGES+2,AUTO

     1355    19374
     1356    19375        /*I*  NAME:         DEACTIVATE_FRAME
     1357    19376              PURPOSE:      RLSFLD all the fields in a frame.
     1358    19377              PARAMETERS:   None.
     1359    19378              DATA:         The usual global stuff.
     1360    19379              PURPOSE:      May deallocate dynamic memory for GZ$whatevers for
     1361    19380                            a frame.  (See *D* for QBA$DEACTIVATE_FORM).
     1362    19381                            M$RLSFLD is called for each field; M$SLCFLD may
     1363    19382                            be called without a key (SeLeCting all fields
     1364    19383                            on the screen) if we're deactivating an entire
     1365    19384                            form and it's the only one open.
     1366    19385        */
     1367    19386
     1368    19387    2       IF NOT QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.INDICATORS.IS_ACTIVE

  19387   0 00009C  DC80 0000 007C  xsym                 LDB,B5   QI_1+124
          0 00009F  89C5 000C                            CMZ      12,B5
          0 0000A1  0801 0009                            BAL      s:19394,PREL

     1369    19388    2       THEN
     1370    19389    3         DO;

     1371    19390    3           QI_1.ERROR_STATUS = %E$FRAME_ALREADY_DEACTIVATED;

  19390   0 0000A3  6C0D                                 LDV,R6   13
          0 0000A4  EF00 0000 008C  xsym                 STR,R6   QI_1+140

     1372    19391    3           ALTRETURN;

  19391   0 0000A7  ECC7 0028                            LDB,B6   TOTAL_GZ_SPACE_IN_PAGES+2,AUTO
          0 0000A9  B806                                 LDR,R3   ,B6
          0 0000AA  C3B6                                 LNJ,B4   ,B6,R3

PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:188  
     1373    19392    3         END;
     1374    19393
     1375    19394    2       GZ_HEADER$ = QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.HEADER$;

  19394   0 0000AB  CCC5 0004                            LDB,B4   4,B5
          0 0000AD  CFC7 0022                            STB,B4   GZ_HEADER$,AUTO

     1376    19395    2       GZ_FIELD$ = PINCRW ( GZ_HEADER$, SIZEW (QI$GZ_HEADER) );

  19395   0 0000AF  BBC4 000B                            LAB,B3   11,B4
          0 0000B1  BFC7 0020                            STB,B3   GZ_FIELD$,AUTO

     1377    19396
     1378    19397    2       IF NOT MASTER_ALREADY_GOT_EM_FLAG

  19397   0 0000B3  89C7 0025                            CMZ      MASTER_ALREADY_GOT_EM_FLAG,AUTO
          0 0000B5  0801 00AF                            BAL      s:19457,PREL

     1379    19398    2       THEN
     1380    19399    2   RELEASE_ALL_THE_FIELDS:
     1381    19400    3         DO;

  19400   0                              RELEASE_ALL_THE*null
     1382    19401
     1383    19402    3           FPT@SLCFLD = QI_FPT_SLCFLD;

  19402   0 0000B7  AB80 0000 0000  xsym RELEASE_ALL_THE*LAB,B2   QI_FPT_SLCFLD
          0 0000BA  2C00                                 LDV,R2   0
          0 0000BB  6C10                                 LDV,R6   16
          0 0000BC  BB87                                 LAB,B3   ,AUTO
          0 0000BD  3C28                                 LDV,R3   40
          0 0000BE  0008                                 MMM

     1384    19403    3           VBASE ( FPT@SLCFLD.V_ ) = ADDR ( FPT@SLCFLD.V );

  19403   0 0000BF  EBC7 001A                            LAB,B6   FPT@SLCFLD+6,AUTO
          0 0000C1  EFC7 0015                            STB,B6   FPT@SLCFLD+1,AUTO
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:189  

     1385    19404    3           FPT@SLCFLD.V.DCB# = QI_1.CURRENT.FORM$ -> QI$FORM_FILE.DCB#;

  19404   0 0000C3  DC80 0000 0076  xsym                 LDB,B5   QI_1+118
          0 0000C6  E845 0008                            LDR,R6   8,B5
          0 0000C8  E7C7 001A                            STH,R6   FPT@SLCFLD+6,AUTO

     1386    19405
     1387    19406                /*  If we're deactivating a form, and it's the only form
     1388    19407                    open, we can do a SELECT of all the fields at once.  */
     1389    19408    3           IF ITS_A_DEACTIVATE_FORM

  19408   0 0000CA  89C7 0024                            CMZ      ITS_A_DEACTIVATE_FORM,AUTO
          0 0000CC  0881 0028                            BAGE     s:19425,PREL
          0 0000CE  E800 0000 0074  xsym                 LDR,R6   QI_1+116
          0 0000D1  6D01                                 CMV,R6   1
          0 0000D2  0981 0022                            BNE      s:19425,PREL

     1390    19409    3             AND QI_1.OPENED_COUNT.FORM = 1
     1391    19410    3           THEN
     1392    19411    3   SELECT_ALL_OF_EM_AT_ONCE:
     1393    19412    4             DO;

  19412   0                              SELECT_ALL_OF_E*null
     1394    19413
     1395    19414    4               MASTER_ALREADY_GOT_EM_FLAG = %YES;

  19414   0 0000D4  8947 0025            SELECT_ALL_OF_E*LBT,'8000'X       MASTER_ALREADY_GOT_EM_FLAG,AUTO
  19414   0 0000D6       8000

     1396    19415
     1397    19416    4               CALL QGB$SLCFLD ( FPT@SLCFLD, QGB_PARAM )

  19416   0 0000D7  CB80 0000 0000  xsym                 LAB,B4   QGB_PARAM
          0 0000DA  CFC7 002C                            STB,B4   TOTAL_GZ_SPACE_IN_PAGES+6,AUTO
          0 0000DC  ABC7 0014                            LAB,B2   FPT@SLCFLD,AUTO
          0 0000DE  AFC7 002A                            STB,B2   TOTAL_GZ_SPACE_IN_PAGES+4,AUTO
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:190  
          0 0000E0  BBC7 002A                            LAB,B3   TOTAL_GZ_SPACE_IN_PAGES+4,AUTO
          0 0000E2  CBF0 0200                            LAB,B4   512,IMO
          0 0000E4  E380 0000 0000  xent                 LNJ,B6   QGB$SLCFLD
          0 0000E7       0003                            DC       s:19419,PREL
          0 0000E8  0F81 000A                            B        s:19422,PREL

     1398    19417    4               WHENALTRETURN
     1399    19418    5                 DO;

     1400    19419    5                   CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );

  19419   0 0000EA  BB80 0000 0004  01                   LAB,B3   +4
          0 0000ED  CBF0 0100                            LAB,B4   256,IMO
          0 0000EF  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_M$INTERNAL
          0 0000F2       0001                            DC       s:19422,PREL

     1401    19420    5                 END;

     1402    19421
     1403    19422    4             END SELECT_ALL_OF_EM_AT_ONCE;

  19422   0 0000F3  0F81 0041                            B        s:19443,PREL

     1404    19423    3           ELSE
     1405    19424    3   SELECT_ONE_OF_EM_AT_A_TIME:
     1406    19425    4             DO;

  19425   0                              SELECT_ONE_OF_E*null
     1407    19426
     1408    19427    5               DO FIELD_COUNT = 1 TO GZ_HEADER$ -> QI$GZ_HEADER.FIELD_COUNT;

  19427   0 0000F5  6C01                 SELECT_ONE_OF_E*LDV,R6   1
          0 0000F6  EF47 001C                            STR,R6   FIELD_COUNT,AUTO
          0 0000F8  0F81 0035                            B        s:19439+2,PREL

     1409    19428
     1410    19429    5                 FPT@SLCFLD.KEY_ = VECTOR ( GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:191  
             19429                          POSITION );

  19429   0 0000FA  ECC7 0020                            LDB,B6   GZ_FIELD$,AUTO
          0 0000FC  DBC6 0003                            LAB,B5   3,B6
          0 0000FE  DFC7 002B                            STB,B5   TOTAL_GZ_SPACE_IN_PAGES+5,AUTO
          0 000100  6C01                                 LDV,R6   1
          0 000101  EF47 002A                            STR,R6   TOTAL_GZ_SPACE_IN_PAGES+4,AUTO
          0 000103  ABC7 002A                            LAB,B2   TOTAL_GZ_SPACE_IN_PAGES+4,AUTO
          0 000105  2C00                                 LDV,R2   0
          0 000106  6C06                                 LDV,R6   6
          0 000107  BB87                                 LAB,B3   ,AUTO
          0 000108  3C2E                                 LDV,R3   46
          0 000109  0008                                 MMM

     1411    19430
     1412    19431    5                 CALL QGB$SLCFLD ( FPT@SLCFLD, QGB_PARAM )

  19431   0 00010A  EB80 0000 0000  xsym                 LAB,B6   QGB_PARAM
          0 00010D  EFC7 002C                            STB,B6   TOTAL_GZ_SPACE_IN_PAGES+6,AUTO
          0 00010F  DBC7 0014                            LAB,B5   FPT@SLCFLD,AUTO
          0 000111  DFC7 002A                            STB,B5   TOTAL_GZ_SPACE_IN_PAGES+4,AUTO
          0 000113  BBC7 002A                            LAB,B3   TOTAL_GZ_SPACE_IN_PAGES+4,AUTO
          0 000115  CBF0 0200                            LAB,B4   512,IMO
          0 000117  E380 0000 0000  xent                 LNJ,B6   QGB$SLCFLD
          0 00011A       0003                            DC       s:19434,PREL
          0 00011B  0F81 000A                            B        s:19437,PREL

     1413    19432    5                 WHENALTRETURN
     1414    19433    6                   DO;

     1415    19434    6                     CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );

  19434   0 00011D  BB80 0000 0004  01                   LAB,B3   +4
          0 000120  CBF0 0100                            LAB,B4   256,IMO
          0 000122  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_M$INTERNAL
          0 000125       0001                            DC       s:19437,PREL

PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:192  
     1416    19435    6                   END;

     1417    19436
     1418    19437    5                 GZ_FIELD$ = PINCRW ( GZ_FIELD$, SIZEW (QI$GZ_FIELD) );

  19437   0 000126  ECC7 0020                            LDB,B6   GZ_FIELD$,AUTO
          0 000128  DBC6 000C                            LAB,B5   12,B6
          0 00012A  DFC7 0020                            STB,B5   GZ_FIELD$,AUTO

     1419    19438
     1420    19439    5               END;

  19439   0 00012C  8AC7 001C                            INC      FIELD_COUNT,AUTO
          0 00012E  ECC7 0022                            LDB,B6   GZ_HEADER$,AUTO
          0 000130  E847 001C                            LDR,R6   FIELD_COUNT,AUTO
          0 000132  E946 0004                            CMR,R6   4,B6
          0 000134  03C6                                 BLE      s:19429,SPREL

     1421    19440
     1422    19441    4             END SELECT_ONE_OF_EM_AT_A_TIME;

     1423    19442
     1424    19443    3           FPT@RLSFLD = QI_FPT_RLSFLD;

  19443   0 000135  AB80 0000 0000  xsym                 LAB,B2   QI_FPT_RLSFLD
          0 000138  2C00                                 LDV,R2   0
          0 000139  6C10                                 LDV,R6   16
          0 00013A  BB87                                 LAB,B3   ,AUTO
          0 00013B  3C18                                 LDV,R3   24
          0 00013C  0008                                 MMM

     1425    19444    3           VBASE ( FPT@RLSFLD.V_ ) = ADDR ( FPT@RLSFLD.V );

  19444   0 00013D  EBC7 0012                            LAB,B6   FPT@RLSFLD+6,AUTO
          0 00013F  EFC7 000D                            STB,B6   FPT@RLSFLD+1,AUTO

     1426    19445    3           FPT@RLSFLD.V.DCB# = FPT@SLCFLD.V.DCB#;
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:193  

  19445   0 000141  E2C7 001A                            LLH,R6   FPT@SLCFLD+6,AUTO
          0 000143  E7C7 0012                            STH,R6   FPT@RLSFLD+6,AUTO

     1427    19446
     1428    19447    3           CALL QGB$RLSFLD ( FPT@RLSFLD, QGB_PARAM )

  19447   0 000145  DB80 0000 0000  xsym                 LAB,B5   QGB_PARAM
          0 000148  DFC7 002C                            STB,B5   TOTAL_GZ_SPACE_IN_PAGES+6,AUTO
          0 00014A  CBC7 000C                            LAB,B4   FPT@RLSFLD,AUTO
          0 00014C  CFC7 002A                            STB,B4   TOTAL_GZ_SPACE_IN_PAGES+4,AUTO
          0 00014E  BBC7 002A                            LAB,B3   TOTAL_GZ_SPACE_IN_PAGES+4,AUTO
          0 000150  CBF0 0200                            LAB,B4   512,IMO
          0 000152  E380 0000 0000  xent                 LNJ,B6   QGB$RLSFLD
          0 000155       0003                            DC       s:19450,PREL
          0 000156  0F81 000A                            B        s:19453,PREL

     1429    19448    3           WHENALTRETURN
     1430    19449    4             DO;

     1431    19450    4               CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );

  19450   0 000158  BB80 0000 0004  01                   LAB,B3   +4
          0 00015B  CBF0 0100                            LAB,B4   256,IMO
          0 00015D  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_M$INTERNAL
          0 000160       0001                            DC       s:19453,PREL

     1432    19451    4             END;

     1433    19452
     1434    19453    3           QI_1.SCREEN_UPDATE_FLAGS.WAS_DEACTIVATED = %YES;

  19453   0 000161  8900 0000 0016  xsym                 LBT,'2000'X       QI_1+22
  19453   0 000164       2000

     1435    19454
     1436    19455    3         END RELEASE_ALL_THE_FIELDS;
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:194  

     1437    19456
     1438    19457    2       GZ_HEADER$ -> QI$GZ_HEADER.IS_ACTIVE = %NO;

  19457   0 000165  ECC7 0022                            LDB,B6   GZ_HEADER$,AUTO
          0 000167  8706                                 CL       ,B6

     1439    19458
     1440    19459    2       IF GZ_HEADER$ = QI_1.GZ.LAST_HEADER$

  19459   0 000168  ED80 0000 006A  xsym                 CMB,B6   QI_1+106
          0 00016B  0981 0083                            BNE      s:19536,PREL

     1441    19460    2       THEN
     1442    19461    2   PRUNE_BACK_THE_SEGMENT_SOME:
     1443    19462    3         DO;

  19462   0                              PRUNE_BACK_THE_*null
     1444    19463
     1445    19464    3   PRUNE_BACK_THE_SEGMENT_MORE:
     1446    19465    4           DO WHILE ( GZ_HEADER$ -> QI$GZ_HEADER.IS_ACTIVE = %NO );

  19465   0 00016D  8986                 PRUNE_BACK_THE_*CMZ      ,B6
          0 00016E  0801 0024                            BAL      s:19513,PREL

     1447    19466
     1448    19467    4             QI_1.GZ.AVAILABLE$ = GZ_HEADER$;

  19467   0 000170  ECC7 0022                            LDB,B6   GZ_HEADER$,AUTO
          0 000172  EF80 0000 006C  xsym                 STB,B6   QI_1+108

     1449    19468    4             QI_1.GZ.LAST_HEADER$ = GZ_HEADER$ -> QI$GZ_HEADER.BACK_LINK$;

  19468   0 000175  DCC6 0001                            LDB,B5   1,B6
          0 000177  DF80 0000 006A  xsym                 STB,B5   QI_1+106

     1450    19469                  %DATA_ADDRESS ( THING@D =
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:195  
             19469                      "GZ_HEADER$ -> QI$GZ_HEADER.FRAME_DAD$ -> QI$FRAME.STATUS_AREA@D",
     1451    19470                  CHECK_FOR_INDIRECTION = NO,
     1452    19471                  RESULT$ = FRAME_STATUS$ );

  19489   0 00017A  CCC6 0005                            LDB,B4   5,B6
          0 00017C  B844 0006                            LDR,R3   6,B4
          0 00017E  F853                                 LDR,R7   R3
          0 00017F  6C00                                 LDV,R6   0
          0 000180  8400 0000 0000  xsym                 AID      QI_1
          0 000183  8D47 001E                            SDI      FRAME_STATUS$,AUTO

     1453    19508    4             FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.HEADER$ = ADDR (NIL);

  19508   0 000185  BB80 0000 0000                       LAB,B3   0
          0 000188  ACC7 001E                            LDB,B2   FRAME_STATUS$,AUTO
          0 00018A  BFC2 0004                            STB,B3   4,B2

     1454    19509    4             GZ_HEADER$ = QI_1.GZ.LAST_HEADER$;

  19509   0 00018C  DC80 0000 006A  xsym                 LDB,B5   QI_1+106
          0 00018F  DFC7 0022                            STB,B5   GZ_HEADER$,AUTO

     1455    19510
     1456    19511    4           END PRUNE_BACK_THE_SEGMENT_MORE;

  19511   0 000191  8985                                 CMZ      ,B5
          0 000192  08DE                                 BAGE     s:19467,SPREL

     1457    19512
     1458    19513    3           TOTAL_GZ_SPACE_IN_PAGES = ( ( QI_VLP_SEGMENT.PAGES * 256 )

  19513   0 000193  8C80 0000 006C  xsym                 LDI      QI_1+108
          0 000196  8480 0000 0000  xsym                 SID      QI_VLP_SEGMENT
          0 000199  8D47 002A                            SDI      TOTAL_GZ_SPACE_IN_PAGES+4,AUTO
          0 00019B  F800 0000 0002  xsym                 LDR,R7   QI_VLP_SEGMENT+2
          0 00019E  6C00                                 LDV,R6   0
          0 00019F  7088                                 DOL,R7   8
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:196  
          0 0001A0  8656                                 CPL      R6
          0 0001A1  8657                                 CPL      R7
          0 0001A2  8470 0000 0001                       AID      1,IMO
          0 0001A5  8447 002A                            AID      TOTAL_GZ_SPACE_IN_PAGES+4,AUTO
          0 0001A7  8656                                 CPL      R6
          0 0001A8  8657                                 CPL      R7
          0 0001A9  8470 0000 0001                       AID      1,IMO
          0 0001AC  8D47 003E                            SDI      TOTAL_GZ_SPACE_IN_PAGES+24,AUTO
          0 0001AE  EB80 0000 0000  01                   LAB,B6   0
          0 0001B1  0027                                 CBD      ;
          0 0001B2       0206 0006                                BINARY(6,B6,,2),;
          0 0001B4       4C07 002C                       UNPACKED(TOTAL_GZ_SPACE_IN_PAGES+6,AUTO,,12,LEADING)
          0 0001B6  0027                                 CBD      ;
          0 0001B7       0407 003E                               BINARY(TOTAL_GZ_SPACE_IN_PAGES+24,AUTO,,4),;
          0 0001B9       4C07 0032                      UNPACKED(TOTAL_GZ_SPACE_IN_PAGES+12,AUTO,,12,LEADING)
          0 0001BB  002B                                 DDV      ;
          0 0001BC       4C07 002C                     UNPACKED(TOTAL_GZ_SPACE_IN_PAGES+6,AUTO,,12,LEADING),;
          0 0001BE       4C07 0032                    UNPACKED(TOTAL_GZ_SPACE_IN_PAGES+12,AUTO,,12,LEADING),;
          0 0001C0       4C07 0038                      UNPACKED(TOTAL_GZ_SPACE_IN_PAGES+18,AUTO,,12,LEADING)
          0 0001C2  002A                                 CDB      ;
          0 0001C3       4C07 0038                    UNPACKED(TOTAL_GZ_SPACE_IN_PAGES+18,AUTO,,12,LEADING),;
          0 0001C5       0407 0040                                BINARY(TOTAL_GZ_SPACE_IN_PAGES+26,AUTO,,4)
          0 0001C7  437F                                 CSYNC    s:19513+51,SPREL
          0 0001C8  D847 0041                            LDR,R5   TOTAL_GZ_SPACE_IN_PAGES+27,AUTO
          0 0001CA  DF47 0026                            STR,R5   TOTAL_GZ_SPACE_IN_PAGES,AUTO

     1459    19514    3             - POFFW ( QI_1.GZ.AVAILABLE$, QI_VLP_SEGMENT.BASE$ ) )
     1460    19515    3             / 256;
     1461    19516
     1462    19517    3           IF TOTAL_GZ_SPACE_IN_PAGES > 0

  19517   0 0001CC  5901 0022                            BEZ,R5   s:19536,PREL

     1463    19518    3           THEN
     1464    19519    3   FDS_SOME_MEMORY:
     1465    19520    4             DO;

PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:197  
  19520   0                              FDS_SOME_MEMORY null
     1466    19521
     1467    19522    4               FPT@FDS = QI_FPT_FDS;

  19522   0 0001CE  AB80 0000 0000  xsym FDS_SOME_MEMORY LAB,B2   QI_FPT_FDS
          0 0001D1  2C00                                 LDV,R2   0
          0 0001D2  6C10                                 LDV,R6   16
          0 0001D3  BB87                                 LAB,B3   ,AUTO
          0 0001D4  3C08                                 LDV,R3   8
          0 0001D5  0008                                 MMM

     1468    19523    4               VBASE ( FPT@FDS.V_ ) = ADDR ( FPT@FDS.V );

  19523   0 0001D6  EBC7 000A                            LAB,B6   FPT@FDS+6,AUTO
          0 0001D8  EFC7 0005                            STB,B6   FPT@FDS+1,AUTO

     1469    19524    4               FPT@FDS.V.PAGES = TOTAL_GZ_SPACE_IN_PAGES;

  19524   0 0001DA  E847 0026                            LDR,R6   TOTAL_GZ_SPACE_IN_PAGES,AUTO
          0 0001DC  EF47 000A                            STR,R6   FPT@FDS+6,AUTO

     1470    19525
     1471    19526    4               CALL M$FDS ( FPT@FDS )

  19526   0 0001DE  BBC7 0004                            LAB,B3   FPT@FDS,AUTO
          0 0001E0  B870 0903                            LDR,R3   2307,IMO
          0 0001E2  0001                                 MCL
          0 0001E3       0003                            DC       s:19529,PREL
          0 0001E4  0F81 000A                            B        s:19536,PREL

     1472    19527    4               WHENALTRETURN
     1473    19528    5                 DO;

     1474    19529    5                   CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );

  19529   0 0001E6  BB80 0000 0004  01                   LAB,B3   +4
          0 0001E9  CBF0 0100                            LAB,B4   256,IMO
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:198  
          0 0001EB  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_M$INTERNAL
          0 0001EE       0001                            DC       s:19536,PREL

     1475    19530    5                 END;

     1476    19531
     1477    19532    4             END FDS_SOME_MEMORY;

     1478    19533
     1479    19534    3         END PRUNE_BACK_THE_SEGMENT_SOME;

     1480    19535
     1481    19536    2       QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.INDICATORS.IS_ACTIVE = %NO;

  19536   0 0001EF  EC80 0000 007C  xsym                 LDB,B6   QI_1+124
          0 0001F2  8846 000C                            LBF,'8000'X       12,B6
          0 0001F4       8000

     1482    19537    2       QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.CURRENT.USAGE.DEACTIVATED = %YES;

  19537   0 0001F5  EC80 0000 007C  xsym                 LDB,B6   QI_1+124
          0 0001F8  8946 000A                            LBT,'0200'X       10,B6
          0 0001FA       0200

     1483    19538
     1484    19539    2       RETURN;

  19539   0 0001FB  ECC7 0028                            LDB,B6   TOTAL_GZ_SPACE_IN_PAGES+2,AUTO
          0 0001FD  C3C6 0001                            LNJ,B4   1,B6
     1485    19540
     1486    19541    2   END DEACTIVATE_FRAME;
     1487    19542
     1488    19543    1   END QBA$DEACTIVATE_FORM;

PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:199  
--  Include file information  --

   QI_MACROS_M.:E05TOU  is referenced.
   QI_PERR_C.:E05TOU  is referenced.
   QI_EQUATES_E.:E05TOU  is referenced.
   QG_MACRO_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QBA$DEACTIVATE_FORM.
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:200  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

    1C-0-0/w UBIN(16)    r     1 FIELD_COUNT                4-0-0/w STRC(128)   r     1 FPT@FDS
     C-0-0/w STRC(128)   r     1 FPT@RLSFLD                14-0-0/w STRC(128)   r     1 FPT@SLCFLD
    1D-0-0/w UBIN(16)    r     1 FRAME_INDEX               1E-0-0/w PTR         r     1 FRAME_STATUS$
    20-0-0/w PTR         r     1 GZ_FIELD$                 22-0-0/w PTR         r     1 GZ_HEADER$
    24-0-0/b BIT         r     1 ITS_A_DEACTIVATE_FORM
    25-0-0/b BIT         r     1 MASTER_ALREADY_GOT_EM_FLAG
    26-0-0/w UBIN(16)    r     1 TOTAL_GZ_SPACE_IN_PAGES

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(432)   r     1 QGB_PARAM                  0-0-0/d STRC(2576)  r     1 QI_1
     0-0-0/w STRC(128)   r     1 QI_FPT_FDS                 0-0-0/w STRC(128)   r     1 QI_FPT_RLSFLD
     0-0-0/w STRC(128)   r     1 QI_FPT_SLCFLD              0-0-0/w STRC(48)    r     1 QI_VLP_SEGMENT

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(192)   r     1 QI$FORM_FILE               0-0-0/w STRC(128)   r     1 QI$FRAME
     0-0-0/w STRC(208)   r     1 QI$FRAME_STATUS            0-0-0/w STRC(184)   r     1 QI$GZ_FIELD
     0-0-0/w STRC(176)   r     1 QI$GZ_HEADER
     0-0-0/c ASTR(8)     r     1 QI$VARIABLE_IDENTIFIER


   Procedure QBA$DEACTIVATE_FORM requires 511 words for executable code.
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:201  
   Procedure QBA$DEACTIVATE_FORM requires 66 words of local(AUTO) storage.

    No errors detected in file QBA$ACTIVATE.:E05TSI    .
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:202  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:203  
          MINI XREF LISTING

DEACTIVATE_FRAME
     19373**PROC    19321--CALL    19358--CALL
FIELD_COUNT
     19219**DCL     19427<<DOINDEX
FPT@FDS
       249**DCL     19522<<ASSIGN  19526<>CALL
FPT@FDS.V
       252**DCL     19523--ASSIGN
FPT@FDS.V.PAGES
       256**DCL     19524<<ASSIGN
FPT@FDS.V_
       252**DCL     19523<<ASSIGN
FPT@RLSFLD
       275**DCL     19443<<ASSIGN  19447<>CALL
FPT@RLSFLD.V
       283**DCL     19444--ASSIGN
FPT@RLSFLD.V.DCB#
       283**DCL     19445<<ASSIGN
FPT@RLSFLD.V_
       277**DCL     19444<<ASSIGN
FPT@SLCFLD
       308**DCL     19402<<ASSIGN  19416<>CALL    19431<>CALL
FPT@SLCFLD.KEY_
       314**DCL     19429<<ASSIGN
FPT@SLCFLD.V
       316**DCL     19403--ASSIGN
FPT@SLCFLD.V.DCB#
       316**DCL     19404<<ASSIGN  19445>>ASSIGN
FPT@SLCFLD.V_
       310**DCL     19403<<ASSIGN
FRAME_INDEX
     19220**DCL     19234<<DOINDEX 19256>>ASSIGN
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:204  
FRAME_STATUS$
     19221**DCL     19489<<ASSIGN  19508>>ASSIGN
GZ_FIELD$
     19222**DCL     19395<<ASSIGN  19429>>ASSIGN  19437<<ASSIGN  19437>>ASSIGN
GZ_HEADER$
     19223**DCL     19394<<ASSIGN  19395>>ASSIGN  19427>>DOINDEX 19457>>ASSIGN  19459>>IF      19465>>DOWHILE
     19467>>ASSIGN  19468>>ASSIGN  19489>>ASSIGN  19509<<ASSIGN
ITS_A_DEACTIVATE_FORM
     19224**DCL     19231<<ASSIGN  19355<<ASSIGN  19408>>IF
M$FDS
       211**DCL-ENT 19526--CALL
MASTER_ALREADY_GOT_EM_FLAG
     19225**DCL     19232<<ASSIGN  19356<<ASSIGN  19397>>IF      19414<<ASSIGN
QCE$ERROR_INTERNAL
     19228**DCL-ENT 19324--CALL
QCE$ERROR_M$INTERNAL
     19229**DCL-ENT 19334--CALL    19367--CALL    19419--CALL    19434--CALL    19450--CALL    19529--CALL
QGB$FLUSH
       473**DCL-ENT 19331--CALL    19364--CALL
QGB$RLSFLD
       468**DCL-ENT 19447--CALL
QGB$SLCFLD
       467**DCL-ENT 19416--CALL    19431--CALL
QGB_PARAM
     11589**DCL     19331<>CALL    19364<>CALL    19416<>CALL    19431<>CALL    19447<>CALL
QGB_PARAM.DVE.DVBYTE.VFC
     11657**DCL     11658--REDEF
QGB_PARAM.DVE.EOMCHAR
     11669**DCL     11670--REDEF
QGB_PARAM.MSG$
     11651**DCL     11652--REDEF
QGB_PARAM.UHDR$
     11676**DCL     11677--REDEF
QI$ACTIVATION_STATUS
      9415**DCL      9421--REDEF
QI$CIP
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:205  
      8256**DCL      8326--REDEF
QI$CIP.CA
      8261**DCL      8265--REDEF    8268--REDEF    8271--REDEF
QI$COBOL_DAD.PSEUDO_CIP
      8500**DCL      8525--REDEF
QI$COBOL_DAD.PSEUDO_CIP.ALPHANUMERIC
      8502**DCL      8507--REDEF
QI$COBOL_DAD.PSEUDO_CIP.NUMERIC.CB
      8508**DCL      8511--REDEF    8514--REDEF
QI$COBOL_DAD.VARIABLE_LENGTH_ITEMS
      8536**DCL      8552--REDEF    8560--REDEF    8568--REDEF
QI$COBOL_DAD.VARIABLE_LENGTH_ITEMS.LEVEL_MULTIPLIERS
      8537**DCL      8547--REDEF    8550--REDEF
QI$COBOL_DAD.WORD0
      8464**DCL      8465--REDEF    8479--REDEF
QI$COBOL_DAD_P_BITS.P
      8604**DCL      8610--REDEF
QI$CONDITION_CONTROL_BLOCK.LIST_A@P
      8090**DCL      8091--REDEF
QI$CONDITION_CONTROL_BLOCK.WORD0_FLAGS
      8086**DCL      8089--REDEF
QI$CONDITION_LEGAL_BLOCK.ARRAY@P
      8123**DCL      8124--REDEF    8125--REDEF
QI$DAD.PSEUDO_CIP
      8403**DCL      8428--REDEF
QI$DAD.PSEUDO_CIP.ALPHANUMERIC
      8405**DCL      8410--REDEF
QI$DAD.PSEUDO_CIP.NUMERIC.CB
      8411**DCL      8414--REDEF    8417--REDEF
QI$DAD.WORD0
      8372**DCL      8373--REDEF
QI$ERROR_MESSAGE_LINE
     11764**DCL     11766--REDEF
QI$ERROR_STATUS
     11761**DCL     11763--REDEF
QI$FIELD_DAD.ELEMENTARY_ITEM.P
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:206  
      8818**DCL      8825--REDEF
QI$FIELD_DAD.ONE_DIMENSIONAL_ITEM.P
      8838**DCL      8845--REDEF
QI$FIELD_DAD.PSEUDO_CIP
      8745**DCL      8770--REDEF
QI$FIELD_DAD.PSEUDO_CIP.ALPHANUMERIC
      8747**DCL      8752--REDEF
QI$FIELD_DAD.PSEUDO_CIP.NUMERIC.CB
      8753**DCL      8756--REDEF    8759--REDEF
QI$FIELD_DAD.TWO_DIMENSIONAL_ITEM.P
      8858**DCL      8865--REDEF
QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS
      8801**DCL      8817--REDEF    8835--REDEF    8853--REDEF
QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS.LEVEL_MULTIPLIERS
      8802**DCL      8812--REDEF    8815--REDEF
QI$FIELD_DAD.WORD0
      8697**DCL      8698--REDEF
QI$FIELD_DAD.WORD0_FLAGS.IO_FLAGS
      8701**DCL      8706--REDEF
QI$FIELD_DAD_P.P
      8899**DCL      8906--REDEF
QI$FIELD_STATUS.INDICATORS
      9565**DCL      9597--REDEF
QI$FIELD_STATUS.INDICATORS.ENABLED_FLAGS
      9569**DCL      9574--REDEF
QI$FIELD_STATUS.INDICATORS.OPEN_FLAGS
      9581**DCL      9588--REDEF
QI$FIELD_STATUS.INDICATORS.STATE_FLAGS
      9575**DCL      9580--REDEF
QI$FILE.WORD0
      9021**DCL      9022--REDEF
QI$FILE_STATUS.INDICATORS
      9858**DCL      9890--REDEF
QI$FILE_STATUS.INDICATORS.ENABLED_FLAGS
      9862**DCL      9867--REDEF
QI$FILE_STATUS.INDICATORS.OPEN_FLAGS
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:207  
      9874**DCL      9881--REDEF
QI$FILE_STATUS.INDICATORS.STATE_FLAGS
      9868**DCL      9873--REDEF
QI$FORM_FILE.DCB#
      9119**DCL     19404>>ASSIGN
QI$FORM_FILE.FRAME_COUNT
      9100**DCL     19234>>DOINDEX
QI$FORM_FILE.FRAME_LIST_A@P
      9129**DCL     19256>>ASSIGN
QI$FORM_FILE.USE_PROCEDURE
      9121**DCL      9128--REDEF
QI$FORM_FILE.WORD0
      9075**DCL      9076--REDEF
QI$FORM_STATUS.INDICATORS
      9979**DCL     10011--REDEF
QI$FORM_STATUS.INDICATORS.ENABLED_FLAGS
      9983**DCL      9988--REDEF
QI$FORM_STATUS.INDICATORS.OPEN_FLAGS
      9995**DCL     10002--REDEF
QI$FORM_STATUS.INDICATORS.STATE_FLAGS
      9989**DCL      9994--REDEF
QI$FRAME.STATUS_AREA@D
      9252**DCL     19296>>ASSIGN  19489>>ASSIGN
QI$FRAME.WORD0
      9236**DCL      9237--REDEF
QI$FRAME_STATUS.CURRENT.USAGE.DEACTIVATED
     10181**DCL     19537<<ASSIGN
QI$FRAME_STATUS.GZ.HEADER$
     10169**DCL     19394>>ASSIGN  19508<<ASSIGN
QI$FRAME_STATUS.INDICATORS
     10208**DCL     10240--REDEF
QI$FRAME_STATUS.INDICATORS.ENABLED_FLAGS
     10212**DCL     10217--REDEF
QI$FRAME_STATUS.INDICATORS.IS_ACTIVE
     10210**DCL     19316>>IF      19387>>IF      19536<<ASSIGN
QI$FRAME_STATUS.INDICATORS.OPEN_FLAGS
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:208  
     10224**DCL     10231--REDEF
QI$FRAME_STATUS.INDICATORS.STATE_FLAGS
     10218**DCL     10223--REDEF
QI$GZ_FIELD
     17087**DCL     19437--ASSIGN
QI$GZ_FIELD.DESCRIPTION.IO_FLAGS
     17090**DCL     17095--REDEF
QI$GZ_FIELD.DESCRIPTION.POSITION
     17106**DCL     19429--ASSIGN
QI$GZ_HEADER
     17038**DCL     19395--ASSIGN
QI$GZ_HEADER.BACK_LINK$
     17042**DCL     19468>>ASSIGN
QI$GZ_HEADER.FIELD_COUNT
     17046**DCL     19427>>DOINDEX
QI$GZ_HEADER.FRAME_DAD$
     17048**DCL     19489>>ASSIGN
QI$GZ_HEADER.IS_ACTIVE
     17039**DCL     19457<<ASSIGN  19465>>DOWHILE
QI$IDENTIFIER
     11767**DCL     11769--REDEF
QI$INDICATORS
      9479**DCL      9509--REDEF
QI$INDICATORS.ENABLED_FLAGS
      9485**DCL      9490--REDEF
QI$INDICATORS.OPEN_FLAGS
      9497**DCL      9504--REDEF
QI$INDICATORS.STATE_FLAGS
      9491**DCL      9496--REDEF
QI$MAJOR_NODE.WORD0
      8935**DCL      8936--REDEF
QI$MAJOR_STATUS.INDICATORS
      9658**DCL      9690--REDEF
QI$MAJOR_STATUS.INDICATORS.ENABLED_FLAGS
      9662**DCL      9667--REDEF
QI$MAJOR_STATUS.INDICATORS.OPEN_FLAGS
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:209  
      9674**DCL      9681--REDEF
QI$MAJOR_STATUS.INDICATORS.STATE_FLAGS
      9668**DCL      9673--REDEF
QI$MESSAGE_TYPE
     11758**DCL     11760--REDEF
QI$MINOR_NODE.WORD0
      8978**DCL      8979--REDEF
QI$MINOR_STATUS.INDICATORS
      9751**DCL      9783--REDEF
QI$MINOR_STATUS.INDICATORS.ENABLED_FLAGS
      9755**DCL      9760--REDEF
QI$MINOR_STATUS.INDICATORS.OPEN_FLAGS
      9767**DCL      9774--REDEF
QI$MINOR_STATUS.INDICATORS.STATE_FLAGS
      9761**DCL      9766--REDEF
QI$OP_ACCEPT.DATANAME@P
      6166**DCL      6167--REDEF
QI$OP_CALL.EPTR$
      6338**DCL      6339--REDEF
QI$OP_CLEAR.IO_FLAGS
      6371**DCL      6374--REDEF
QI$OP_DISPLAY.FIELD_A@P
      6638**DCL      6639--REDEF
QI$OP_ENABLE.IO_FLAGS
      6725**DCL      6728--REDEF
QI$OP_IFCLS.ATTRIBUTE.TYPE
      6818**DCL      6823--REDEF
QI$OP_INSPECT.TALLYING_FOR_ITEM@P
      7052**DCL      7053--REDEF
QI$OP_INSPECT.TALLYING_INITIAL_ITEM@P
      7054**DCL      7055--REDEF
QI$OP_INSPECT.TALLYING_ITEM@P
      7050**DCL      7051--REDEF
QI$OP_OPEN.IO_FLAGS
      7612**DCL      7615--REDEF
QI$OP_PERFM.BINARY_ITERATION_COUNT@P
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:210  
      7650**DCL      7651--REDEF
QI$PSEUDO_CIP
      8151**DCL      8175--REDEF
QI$PSEUDO_CIP.ALPHANUMERIC
      8155**DCL      8160--REDEF
QI$PSEUDO_CIP.NUMERIC.CB
      8161**DCL      8164--REDEF    8167--REDEF
QI$TERMINAL_ATTRIBUTES
      9372**DCL      9385--REDEF
QI$TRAN_FILE.WORD0
      9157**DCL      9158--REDEF
QI$TRAN_STATUS.INDICATORS
     10092**DCL     10124--REDEF
QI$TRAN_STATUS.INDICATORS.ENABLED_FLAGS
     10096**DCL     10101--REDEF
QI$TRAN_STATUS.INDICATORS.OPEN_FLAGS
     10108**DCL     10115--REDEF
QI$TRAN_STATUS.INDICATORS.STATE_FLAGS
     10102**DCL     10107--REDEF
QI$VARIABLE_IDENTIFIER.LENGTH
     11771**DCL     11772--IMP-SIZ
QI_1.BASE
     10300**DCL     10307--REDEF
QI_1.BASE.DATA$
     10301**DCL     19296>>ASSIGN  19489>>ASSIGN
QI_1.BASE.PROC$
     10303**DCL     19256>>ASSIGN
QI_1.CURRENT.FILE$
     11191**DCL     11193--REDEF   11195--REDEF
QI_1.CURRENT.FILE_STATUS$
     11197**DCL     11199--REDEF   11201--REDEF
QI_1.CURRENT.FORM$
     11193**DCL     19234>>DOINDEX 19256>>ASSIGN  19404>>ASSIGN
QI_1.CURRENT.FRAME$
     11203**DCL     19256<<ASSIGN  19296>>ASSIGN
QI_1.CURRENT.FRAME_STATUS$
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:211  
     11205**DCL     19296<<ASSIGN  19316>>IF      19387>>IF      19394>>ASSIGN  19536>>ASSIGN  19537>>ASSIGN
QI_1.DAD
     10995**DCL     11000--REDEF
QI_1.ERROR_STATUS
     11225**DCL     19390<<ASSIGN
QI_1.FILE_HEAD
     11178**DCL     11185--REDEF
QI_1.GZ.AVAILABLE$
     11170**DCL     19467<<ASSIGN  19513>>ASSIGN
QI_1.GZ.LAST_HEADER$
     11167**DCL     19459>>IF      19468<<ASSIGN  19509>>ASSIGN
QI_1.IS_ALL_LIT
     11001**DCL     11006--REDEF
QI_1.IS_FORM_VARIABLE
     11007**DCL     11012--REDEF
QI_1.IS_TEMP
     11013**DCL     11018--REDEF
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP
     11111**DCL     11136--REDEF
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP.ALPHANUMERIC
     11113**DCL     11118--REDEF
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP.NUMERIC.CB
     11119**DCL     11122--REDEF   11125--REDEF
QI_1.MESSAGE_LINE_DAD.WORD0
     11080**DCL     11081--REDEF
QI_1.OFFSET
     11019**DCL     11024--REDEF
QI_1.OP.CIP
     10380**DCL     10831--REDEF
QI_1.OP.CIP.AUX
     10746**DCL     10817--REDEF
QI_1.OP.CIP.AUX.CD
     10791**DCL     10794--REDEF   10798--REDEF   10801--REDEF
QI_1.OP.CIP.S
     10450**DCL     10521--REDEF
QI_1.OP.CIP.S.CD
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:212  
     10495**DCL     10498--REDEF   10502--REDEF   10505--REDEF
QI_1.OP.CIP.T
     10598**DCL     10669--REDEF
QI_1.OP.CIP.T.CD
     10643**DCL     10646--REDEF   10650--REDEF   10653--REDEF
QI_1.OP.DATA
     10838**DCL     10842--REDEF
QI_1.OP.FILL_CHAR
     10962**DCL     10965--REDEF
QI_1.OP.INX
     10895**DCL     10899--REDEF   10900--REDEF   10904--REDEF
QI_1.OP.LEN
     10878**DCL     10882--REDEF   10883--REDEF   10887--REDEF   10888--REDEF   10892--REDEF
QI_1.OP.LEN.AUX
     10881**DCL     11782--IMP-SIZ
QI_1.OP.LEN.S
     10879**DCL     11778--IMP-SIZ
QI_1.OP.LEN.T
     10880**DCL     11780--IMP-SIZ
QI_1.OP.PICTURE_STRING
     10948**DCL     10951--REDEF   10952--REDEF   10955--REDEF   10956--REDEF   10959--REDEF
QI_1.OP.ROUND
     10981**DCL     10982--REDEF   10983--REDEF
QI_1.OP.SRCH_VRFY_ELEMS
     10917**DCL     10920--REDEF
QI_1.OPENED_COUNT
     11186**DCL     11189--REDEF
QI_1.OPENED_COUNT.FORM
     11187**DCL     19408>>IF
QI_1.OTTER_SPACE
     11025**DCL     11030--REDEF
QI_1.PICTURE_STRING
     11031**DCL     11036--REDEF
QI_1.SCREEN_UPDATE_FLAGS.WAS_DEACTIVATED
     10347**DCL     19453<<ASSIGN
QI_1.SPECIAL_NAMES
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:213  
     11214**DCL     11223--REDEF
QI_1.TYPE
     11037**DCL     11042--REDEF
QI_16_BIT_BINARY
     16227**DCL     16297--REDEF
QI_16_BIT_BINARY.CB
     16246**DCL     16249--REDEF   16253--REDEF   16256--REDEF
QI_31_DIGIT_SLS_DISPLAY
     16060**DCL     16130--REDEF
QI_31_DIGIT_SLS_DISPLAY.CD
     16107**DCL     16110--REDEF   16114--REDEF   16117--REDEF
QI_31_DIGIT_ST_PACKED
     16562**DCL     16632--REDEF
QI_31_DIGIT_ST_PACKED.CP
     16595**DCL     16598--REDEF   16602--REDEF   16605--REDEF
QI_32_BIT_BINARY
     16394**DCL     16464--REDEF
QI_32_BIT_BINARY.CB
     16413**DCL     16416--REDEF   16420--REDEF   16423--REDEF
QI_4_CHAR_ALPHANUMERIC
     15892**DCL     15962--REDEF
QI_4_CHAR_ALPHANUMERIC.CA
     15897**DCL     15901--REDEF   15904--REDEF   15907--REDEF
QI_ACCUMULATOR_DAD.CIP
     16905**DCL     16976--REDEF
QI_ACCUMULATOR_DAD.CIP.CP
     16936**DCL     16939--REDEF   16943--REDEF   16946--REDEF
QI_ALR.CIP
     11857**DCL     12308--REDEF
QI_ALR.CIP.AUX
     12223**DCL     12294--REDEF
QI_ALR.CIP.AUX.CA
     12226**DCL     12230--REDEF   12233--REDEF   12236--REDEF
QI_ALR.CIP.S
     11927**DCL     11998--REDEF
QI_ALR.CIP.S.CA
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:214  
     11930**DCL     11934--REDEF   11937--REDEF   11940--REDEF
QI_ALR.CIP.T
     12075**DCL     12146--REDEF
QI_ALR.CIP.T.CA
     12078**DCL     12082--REDEF   12085--REDEF   12088--REDEF
QI_ALR.DATA
     12315**DCL     12319--REDEF
QI_ALR.FILL_CHAR
     12439**DCL     12442--REDEF
QI_ALR.INX
     12372**DCL     12376--REDEF   12377--REDEF   12381--REDEF
QI_ALR.LEN
     12355**DCL     12359--REDEF   12360--REDEF   12364--REDEF   12365--REDEF   12369--REDEF
QI_ALR.PICTURE_STRING
     12425**DCL     12428--REDEF   12429--REDEF   12432--REDEF   12433--REDEF   12436--REDEF
QI_ALR.ROUND
     12458**DCL     12459--REDEF   12460--REDEF
QI_ALR.SRCH_VRFY_ELEMS
     12394**DCL     12397--REDEF
QI_FPT_DBCONTROL.V_
     17277**DCL     17277--REDEF
QI_FPT_FDS
     17662**DCL     19522>>ASSIGN
QI_FPT_INT.V_
     18115**DCL     18115--REDEF
QI_FPT_RLSFLD
     18489**DCL     19443>>ASSIGN
QI_FPT_SLCFLD
     18547**DCL     19402>>ASSIGN
QI_MAT.CIP
     15196**DCL     15647--REDEF
QI_MAT.CIP.AUX
     15562**DCL     15633--REDEF
QI_MAT.CIP.AUX.CA
     15565**DCL     15569--REDEF   15572--REDEF   15575--REDEF
QI_MAT.CIP.S
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:215  
     15266**DCL     15337--REDEF
QI_MAT.CIP.S.CA
     15269**DCL     15273--REDEF   15276--REDEF   15279--REDEF
QI_MAT.CIP.T
     15414**DCL     15485--REDEF
QI_MAT.CIP.T.CA
     15417**DCL     15421--REDEF   15424--REDEF   15427--REDEF
QI_MAT.DATA
     15654**DCL     15658--REDEF
QI_MAT.DEC
     15722**DCL     15726--REDEF   15727--REDEF   15731--REDEF
QI_MAT.FILL_CHAR
     15778**DCL     15781--REDEF
QI_MAT.LEN
     15694**DCL     15698--REDEF   15699--REDEF   15703--REDEF   15704--REDEF   15708--REDEF
QI_MAT.PICTURE_STRING
     15764**DCL     15767--REDEF   15768--REDEF   15771--REDEF   15772--REDEF   15775--REDEF
QI_MAT.ROUND
     15797**DCL     15798--REDEF   15799--REDEF
QI_MAT.SRCH_VRFY_ELEMS
     15733**DCL     15736--REDEF
QI_PICTURE_STRING
     16730**DCL     16800--REDEF
QI_PICTURE_STRING.CA
     16735**DCL     16739--REDEF   16742--REDEF   16745--REDEF
QI_SRCH_VRFY.CIP
     14527**DCL     14978--REDEF
QI_SRCH_VRFY.CIP.AUX
     14893**DCL     14964--REDEF
QI_SRCH_VRFY.CIP.AUX.CA
     14896**DCL     14900--REDEF   14903--REDEF   14906--REDEF
QI_SRCH_VRFY.CIP.S
     14597**DCL     14668--REDEF
QI_SRCH_VRFY.CIP.S.CA
     14600**DCL     14604--REDEF   14607--REDEF   14610--REDEF
QI_SRCH_VRFY.CIP.T
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:216  
     14745**DCL     14816--REDEF
QI_SRCH_VRFY.CIP.T.CA
     14748**DCL     14752--REDEF   14755--REDEF   14758--REDEF
QI_SRCH_VRFY.DATA
     14985**DCL     14989--REDEF
QI_SRCH_VRFY.DEC
     15053**DCL     15057--REDEF   15058--REDEF   15062--REDEF
QI_SRCH_VRFY.FILL_CHAR
     15109**DCL     15112--REDEF
QI_SRCH_VRFY.ROUND
     15128**DCL     15129--REDEF   15130--REDEF
QI_SRCH_VRFY.SRCH_RESULT
     15069**DCL     15072--REDEF   15073--REDEF   15076--REDEF   15077--REDEF   15080--REDEF
QI_SRCH_VRFY.SRCH_VRFY_ARGS
     14993**DCL     14997--REDEF   14998--REDEF   15002--REDEF   15003--REDEF   15007--REDEF
QI_SRCH_VRFY.SRCH_VRFY_ELEMS
     15064**DCL     15067--REDEF
QI_TYPE_BINARY_TARGET.CIP
     13854**DCL     14305--REDEF
QI_TYPE_BINARY_TARGET.CIP.AUX
     14220**DCL     14291--REDEF
QI_TYPE_BINARY_TARGET.CIP.AUX.CA
     14223**DCL     14227--REDEF   14230--REDEF   14233--REDEF
QI_TYPE_BINARY_TARGET.CIP.S
     13924**DCL     13995--REDEF
QI_TYPE_BINARY_TARGET.CIP.S.CA
     13927**DCL     13931--REDEF   13934--REDEF   13937--REDEF
QI_TYPE_BINARY_TARGET.CIP.T
     14072**DCL     14143--REDEF
QI_TYPE_BINARY_TARGET.CIP.T.CB
     14089**DCL     14092--REDEF   14096--REDEF   14099--REDEF
QI_TYPE_BINARY_TARGET.DATA
     14312**DCL     14316--REDEF
QI_TYPE_BINARY_TARGET.DEC
     14380**DCL     14384--REDEF   14385--REDEF   14389--REDEF
QI_TYPE_BINARY_TARGET.LEN
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:217  
     14352**DCL     14356--REDEF   14357--REDEF   14361--REDEF   14362--REDEF   14366--REDEF
QI_TYPE_BINARY_TARGET.PICTURE_STRING
     14422**DCL     14425--REDEF   14426--REDEF   14429--REDEF   14430--REDEF   14433--REDEF
QI_TYPE_BINARY_TARGET.ROUND
     14455**DCL     14456--REDEF   14457--REDEF
QI_TYPE_BINARY_TARGET.SIZE_ERROR
     14441**DCL     14442--REDEF
QI_TYPE_BINARY_TARGET.SRCH_VRFY_ELEMS
     14391**DCL     14394--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP
     12522**DCL     12973--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.AUX
     12888**DCL     12959--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.AUX.CA
     12891**DCL     12895--REDEF   12898--REDEF   12901--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.S
     12592**DCL     12663--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.S.CD
     12637**DCL     12640--REDEF   12644--REDEF   12647--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.T
     12740**DCL     12811--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.T.CA
     12743**DCL     12747--REDEF   12750--REDEF   12753--REDEF
QI_TYPE_DISPLAY_SOURCE.DATA
     12980**DCL     12984--REDEF
QI_TYPE_DISPLAY_SOURCE.DEC
     13048**DCL     13052--REDEF   13053--REDEF   13057--REDEF
QI_TYPE_DISPLAY_SOURCE.LEN
     13020**DCL     13024--REDEF   13025--REDEF   13029--REDEF   13030--REDEF   13034--REDEF
QI_TYPE_DISPLAY_SOURCE.PICTURE_STRING
     13090**DCL     13093--REDEF   13094--REDEF   13097--REDEF   13098--REDEF   13101--REDEF
QI_TYPE_DISPLAY_SOURCE.ROUND
     13123**DCL     13124--REDEF   13125--REDEF
QI_TYPE_DISPLAY_SOURCE.SIZE_ERROR
     13109**DCL     13110--REDEF
QI_TYPE_DISPLAY_SOURCE.SRCH_VRFY_ELEMS
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:218  
     13059**DCL     13062--REDEF
QI_TYPE_DISPLAY_TARGET.CIP
     13188**DCL     13639--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.AUX
     13554**DCL     13625--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.AUX.CA
     13557**DCL     13561--REDEF   13564--REDEF   13567--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.S
     13258**DCL     13329--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.S.CA
     13261**DCL     13265--REDEF   13268--REDEF   13271--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.T
     13406**DCL     13477--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.T.CD
     13451**DCL     13454--REDEF   13458--REDEF   13461--REDEF
QI_TYPE_DISPLAY_TARGET.DATA
     13646**DCL     13650--REDEF
QI_TYPE_DISPLAY_TARGET.DEC
     13714**DCL     13718--REDEF   13719--REDEF   13723--REDEF
QI_TYPE_DISPLAY_TARGET.LEN
     13686**DCL     13690--REDEF   13691--REDEF   13695--REDEF   13696--REDEF   13700--REDEF
QI_TYPE_DISPLAY_TARGET.PICTURE_STRING
     13756**DCL     13759--REDEF   13760--REDEF   13763--REDEF   13764--REDEF   13767--REDEF
QI_TYPE_DISPLAY_TARGET.ROUND
     13789**DCL     13790--REDEF   13791--REDEF
QI_TYPE_DISPLAY_TARGET.SIZE_ERROR
     13775**DCL     13776--REDEF
QI_TYPE_DISPLAY_TARGET.SRCH_VRFY_ELEMS
     13725**DCL     13728--REDEF
QI_VLP_SEGMENT.BASE
     17814**DCL     17814--REDEF
QI_VLP_SEGMENT.BASE$
     17814**DCL     19513>>ASSIGN
QI_VLP_SEGMENT.PAGES
     17814**DCL     19513>>ASSIGN
QI_VLP_SEGMENT_BUFFER.BASE
PL6.E3A0      #002=QBA$DEACTIVATE_FORM File=QBA$ACTIVATE.:E05TSI                 WED 07/30/97 04:44 Page:219  
     17912**DCL     17912--REDEF
QI_VLP_SEGMENT_LOAD.BASE
     18010**DCL     18010--REDEF
QI_VLP_TRMCTL.BREAKCOUNT
     19004**DCL     19005--REDEF
QI_VLP_XBREAK.IC
     19194**DCL     19194--REDEF
QI_VLP_XBREAK.OLDIC
     19194**DCL     19195--REDEF   19195--REDEF
TOTAL_GZ_SPACE_IN_PAGES
     19226**DCL     19513<<ASSIGN  19517>>IF      19524>>ASSIGN
