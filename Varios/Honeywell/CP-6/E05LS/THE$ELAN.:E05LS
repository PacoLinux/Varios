VERSION E05

PL6.E3A0      #001=THE$ELAN File=THE$ELAN.:E05TSI                                WED 07/30/97 06:07 Page:1    
        1        1        /*M* THE$ELAN - ERROR LISTER AND ANALYZER FOR CP-6 */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        THE$ELAN: PROC MAIN;
        8        8        /**/
        9        9        /* INCLUDE FILES */
       10       10        %INCLUDE CP_6;
       11       91        %INCLUDE B$JIT;
       12      381        %INCLUDE B_SEGIDS_C;
       13      920        %INCLUDE TH_SUBS_C;
       14     1302        %INCLUDE TH_DATA_R;
       15     1380        %INCLUDE TH_PERR_C;
       16     1421        %INCLUDE XU_MACRO_C;
       17     4527        /**/
       18     4528        /* ENTRY DEFS */
       19     4529    1   DCL THE$BRKMSG ENTRY;
       20     4530    1   DCL THE$BREAK ENTRY;
       21     4531    1   DCL THE$REPORT ENTRY ALTRET;
       22     4532    1   DCL THE$PROCESS ENTRY ALTRET;
       23     4533    1   DCL THM$ERRMSG ENTRY(1);
       24     4534    1   DCL XUR$INIT ENTRY(3) ALTRET;
       25     4535        /**/
       26     4536        /* SYMREFS */
       27     4537    1   DCL B$JIT$ PTR SYMREF;
       28     4538        /**/
       29     4539    1   DCL RE_OPT SBIN;
       30     4540        /**/
       31     4541        %FPT_MONINFO (MONPTRS=VLR_MONPTRS,
       32     4542                      STCLASS=CONSTANT);
       33     4557        %VLR_MONPTRS;
       34     4572        %FPT_SAD (FPTN=SEE_TIGR,
       35     4573                  STCLASS=CONSTANT,
       36     4574                  USERSID=%SPCL1SID,
       37     4575                  MONSID=%TIGRSID);
PL6.E3A0      #001=THE$ELAN File=THE$ELAN.:E05TSI                                WED 07/30/97 06:07 Page:2    
       38     4590        /**/
       39     4591    1   DCL PTR$(0:0) PTR BASED;
       40     4592    1   DCL N$DCT$$ PTR STATIC INIT(ADDR(NIL));
       41     4593    1   DCL 1 N$DCT$PTR REDEF N$DCT$$,
       42     4594    1         2 OFFSET UBIN(18) UNAL,
       43     4595    1         2 * BIT(6) UNAL,
       44     4596    1         2 SEGID BIT(12) UNAL;
       45     4597    1   DCL TEMP$ PTR STATIC INIT(ADDR(NIL));
       46     4598    1   DCL 1 TEMPPTR REDEF TEMP$,
       47     4599    1         2 OFFSET UBIN(18) UNAL,
       48     4600    1         2 * BIT(6) UNAL,
       49     4601    1         2 SEGID BIT(12) UNAL;
       50     4602    1   DCL P_PCB$ PTR STATIC SYMDEF INIT(ADDR(P_PCB));
       51     4603        /**/
       52     4604        /* MACRO INVOCATIONS */
       53     4605        %P_PCB;
       54     4804        %XUR_INIT (ABORT=THE$BREAK,BRKMSG=THE$BRKMSG,PCB=P_PCB);
       55     4903        %EJECT;
PL6.E3A0      #001=THE$ELAN File=THE$ELAN.:E05TSI                                WED 07/30/97 06:07 Page:3    
       56     4904    1        TH_REBUILD = '0'B;          /* RESET FLAG TO REBUILD :DEVHIST */
       57     4905    1        TH_DEVHIST_MODE = 0;
       58     4906    1        CALL XUR$INIT(XUR_INIT,P_PCB$);
       59     4907    1        CALL M$SAD(SEE_TIGR) ALTRET(ABORT_ELAN);
       60     4908    1        CALL M$MONINFO(FPT_MONINFO) ALTRET(ABORT_ELAN);
       61     4909    1        N$DCT$$ = VLR_MONPTRS.N$DCT$$;
       62     4910    1        N$DCT$PTR.SEGID = %SPCL1SID;
       63     4911    1        TH_MAXDCTX = 1;
       64     4912    1        TEMP$ = N$DCT$$->PTR$(TH_MAXDCTX);
       65     4913    2        DO WHILE(TEMPPTR.SEGID = %TIGRSID);
       66     4914    2           TH_DCT$(TH_MAXDCTX) = N$DCT$$->PTR$(TH_MAXDCTX);
       67     4915    2           TH_MAXDCTX = TH_MAXDCTX + 1;
       68     4916    2           TEMP$ = N$DCT$$->PTR$(TH_MAXDCTX);
       69     4917    2           END;  /* DO WHILE */
       70     4918    1        TH_MAXDCTX = TH_MAXDCTX - 1;
       71     4919    1        IF (B$JIT.CCARS > B$JIT.CCDISP)   /* check if REBUILD option was given */
       72     4920    2        THEN DO;
       73     4921    2             CALL INDEX(RE_OPT,'REBUILD',B$JIT.CCBUF);  /* locate option*/
       74     4922    2             IF RE_OPT = B$JIT.CCARS
       75     4923    3             THEN DO;
       76     4924    3                 CALL THM$ERRMSG(%E$TH_BAD_OPTION);
       77     4925                      /*E*  ERROR: THE-E$TH_BAD_OPTION-0
       78     4926                            MESSAGE: Bad CALLing option.
       79     4927                            DESCRIPTION: Input option for ELAN to rebuild
       80     4928                                         the :DEVHIST file is REBUILD.   */
       81     4929    3                 CALL M$EXIT;
       82     4930    3             END;  /* if option is bad */
       83     4931    3             ELSE DO;  /* option is present */
       84     4932    3                 TH_REBUILD = '1'B;
       85     4933    3                 IF (B$JIT.MODE = %M_GHOST#
       86     4934    3                     AND B$JIT.ACCN = ':SYS'
       87     4935    3                     AND B$JIT.UNAME = 'ELAN')
       88     4936    3                     THEN TH_DEVHIST_MODE = %MIDNITE_GHOST;
       89     4937    3                     ELSE TH_DEVHIST_MODE = %REBUILD;
       90     4938    3                 CALL THE$PROCESS ALTRET(ABORT_ELAN); /* rebuild :DEVHIST*/
       91     4939    3                 CALL M$EXIT;
       92     4940    3             END;  /* option present */
PL6.E3A0      #001=THE$ELAN File=THE$ELAN.:E05TSI                                WED 07/30/97 06:07 Page:4    
       93     4941    2        END; /* if option given */
       94     4942        /*
       95     4943             Check to see if we're being started as the result of a tape
       96     4944             boot; we're a GHOST running as :SYS,ELAN and all our CCBUF
       97     4945             says is ELAN
       98     4946
       99     4947             JLJ fix 07/09/84                                             */
      100     4948    1        IF TH_PHONY_GHOST
      101     4949    1        THEN GOTO DO_GHOST1;
      102     4950    1        IF (B$JIT.MODE = %M_GHOST#
      103     4951    1             AND
      104     4952    1             B$JIT.ACCN = ':SYS'
      105     4953    1             AND
      106     4954    1             B$JIT.UNAME = 'ELAN'
      107     4955    1             AND
      108     4956    1             B$JIT.CCBUF = 'ELAN')
      109     4957    2           THEN DO;
      110     4958    2   DO_GHOST1:;
      111     4959    2                TH_DEVHIST_MODE = %TB_GHOST;
      112     4960    2                TH_REBUILD = '1'B;     /* SET FLAG TO REBUILD :DEVHIST */
      113     4961    2                CALL THE$PROCESS ALTRET(ABORT_ELAN);
      114     4962    2                CALL M$EXIT;
      115     4963    2           END; /* if ghost job */
      116     4964    2           ELSE DO;
      117     4965    2             CALL THE$PROCESS ALTRET(ABORT_ELAN);  /* REBUILD :DEVHIST, IF NECESSARY */
      118     4966    2             CALL THE$REPORT ALTRET(ABORT_ELAN);
      119     4967    2           END;
      120     4968    1        CALL M$EXIT;
      121     4969    1   ABORT_ELAN:
      122     4970    1        CALL THM$ERRMSG;
      123     4971    1        CALL M$ERR;
      124     4972    1   END THE$ELAN;
      125     4973        %EOD;

PL6.E3A0      #001=THE$ELAN File=THE$ELAN.:E05TSI                                WED 07/30/97 06:07 Page:5    
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   TH_PERR_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THE$ELAN.

   Procedure THE$ELAN requires 137 words for executable code.
   Procedure THE$ELAN requires 4 words of local(AUTO) storage.

PL6.E3A0      #001=THE$ELAN File=THE$ELAN.:E05TSI                                WED 07/30/97 06:07 Page:6    

 Object Unit name= THE$ELAN                                   File name= THE$ELAN.:E05TOU
 UTS= JUL 30 '97 06:07:26.04 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     20     24  THE$ELAN
    2   Data  even  none    72    110  THE$ELAN
    3   Proc  even  none   137    211  THE$ELAN
    4  RoData even  none     4      4  THE$ELAN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Main       0  THE$ELAN

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    2     20  P_PCB$                             2     21  P_PCB
PL6.E3A0      #001=THE$ELAN File=THE$ELAN.:E05TSI                                WED 07/30/97 06:07 Page:7    

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 THE$BREAK
         yes           Std       0 THE$BRKMSG
 yes     yes           Std       2 XTX$ADAPT
         yes           Std       1 THM$ERRMSG
 yes     yes           Std       0 THE$PROCESS
 yes     yes           Std       3 XUR$INIT
 yes     yes           Std       0 THE$REPORT
                       nStd      0 X66_MAUTO
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_INDEX
                       nStd      0 X66_MARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TH_PHONY_GHOST                        TH_REBUILD
     TH_DEVHIST_MODE                       TH_MAXDCTX                            TH_DCT$
     TH_XSA_BUF_VECTOR                     B$JIT$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=THE$ELAN File=THE$ELAN.:E05TSI                                WED 07/30/97 06:07 Page:8    


        1        1        /*M* THE$ELAN - ERROR LISTER AND ANALYZER FOR CP-6 */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        THE$ELAN: PROC MAIN;

      7  3 000000   000000 700200 xent  THE$ELAN     TSX0  ! X66_MAUTO
         3 000001   000004 000000                    ZERO    4,0

        8        8        /**/
        9        9        /* INCLUDE FILES */
       10       10        %INCLUDE CP_6;
       11       91        %INCLUDE B$JIT;
       12      381        %INCLUDE B_SEGIDS_C;
       13      920        %INCLUDE TH_SUBS_C;
       14     1302        %INCLUDE TH_DATA_R;
       15     1380        %INCLUDE TH_PERR_C;
       16     1421        %INCLUDE XU_MACRO_C;
       17     4527        /**/
       18     4528        /* ENTRY DEFS */
       19     4529    1   DCL THE$BRKMSG ENTRY;
       20     4530    1   DCL THE$BREAK ENTRY;
       21     4531    1   DCL THE$REPORT ENTRY ALTRET;
       22     4532    1   DCL THE$PROCESS ENTRY ALTRET;
       23     4533    1   DCL THM$ERRMSG ENTRY(1);
       24     4534    1   DCL XUR$INIT ENTRY(3) ALTRET;
       25     4535        /**/
       26     4536        /* SYMREFS */
       27     4537    1   DCL B$JIT$ PTR SYMREF;
       28     4538        /**/
       29     4539    1   DCL RE_OPT SBIN;
       30     4540        /**/
       31     4541        %FPT_MONINFO (MONPTRS=VLR_MONPTRS,
       32     4542                      STCLASS=CONSTANT);
PL6.E3A0      #001=THE$ELAN File=THE$ELAN.:E05TSI                                WED 07/30/97 06:07 Page:9    
       33     4557        %VLR_MONPTRS;
       34     4572        %FPT_SAD (FPTN=SEE_TIGR,
       35     4573                  STCLASS=CONSTANT,
       36     4574                  USERSID=%SPCL1SID,
       37     4575                  MONSID=%TIGRSID);
       38     4590        /**/
       39     4591    1   DCL PTR$(0:0) PTR BASED;
       40     4592    1   DCL N$DCT$$ PTR STATIC INIT(ADDR(NIL));
       41     4593    1   DCL 1 N$DCT$PTR REDEF N$DCT$$,
       42     4594    1         2 OFFSET UBIN(18) UNAL,
       43     4595    1         2 * BIT(6) UNAL,
       44     4596    1         2 SEGID BIT(12) UNAL;
       45     4597    1   DCL TEMP$ PTR STATIC INIT(ADDR(NIL));
       46     4598    1   DCL 1 TEMPPTR REDEF TEMP$,
       47     4599    1         2 OFFSET UBIN(18) UNAL,
       48     4600    1         2 * BIT(6) UNAL,
       49     4601    1         2 SEGID BIT(12) UNAL;
       50     4602    1   DCL P_PCB$ PTR STATIC SYMDEF INIT(ADDR(P_PCB));
       51     4603        /**/
       52     4604        /* MACRO INVOCATIONS */
       53     4605        %P_PCB;
       54     4804        %XUR_INIT (ABORT=THE$BREAK,BRKMSG=THE$BRKMSG,PCB=P_PCB);
       55     4903        %EJECT;
PL6.E3A0      #001=THE$ELAN File=THE$ELAN.:E05TSI                                WED 07/30/97 06:07 Page:10   
       56     4904    1        TH_REBUILD = '0'B;          /* RESET FLAG TO REBUILD :DEVHIST */

   4904  3 000002   000000 450000 xsym               STZ     TH_REBUILD

       57     4905    1        TH_DEVHIST_MODE = 0;

   4905  3 000003   000000 450000 xsym               STZ     TH_DEVHIST_MODE

       58     4906    1        CALL XUR$INIT(XUR_INIT,P_PCB$);

   4906  3 000004   000000 630400 4                  EPPR0   0
         3 000005   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000006   000000 701000 xent               TSX1    XUR$INIT
         3 000007   000000 011000                    NOP     0

       59     4907    1        CALL M$SAD(SEE_TIGR) ALTRET(ABORT_ELAN);

   4907  3 000010   000014 630400 1                  EPPR0   SEE_TIGR
         3 000011   430015 713400                    CLIMB   alt,+12301
         3 000012   400000 401760                    pmme    nvectors=1
         3 000013   000203 702000 3                  TSX2    ABORT_ELAN

       60     4908    1        CALL M$MONINFO(FPT_MONINFO) ALTRET(ABORT_ELAN);

   4908  3 000014   000000 630400 1                  EPPR0   FPT_MONINFO
         3 000015   420023 713400                    CLIMB   alt,+8211
         3 000016   402400 401760                    pmme    nvectors=6
         3 000017   000203 702000 3                  TSX2    ABORT_ELAN

       61     4909    1        N$DCT$$ = VLR_MONPTRS.N$DCT$$;

   4909  3 000020   000000 236000 2                  LDQ     VLR_MONPTRS
         3 000021   000016 756000 2                  STQ     N$DCT$$

       62     4910    1        N$DCT$PTR.SEGID = %SPCL1SID;

   4910  3 000022   006021 236007                    LDQ     3089,DL
PL6.E3A0      #001=THE$ELAN File=THE$ELAN.:E05TSI                                WED 07/30/97 06:07 Page:11   
         3 000023   000016 752003 2                  STCQ    N$DCT$$,'03'O

       63     4911    1        TH_MAXDCTX = 1;

   4911  3 000024   000001 235007                    LDA     1,DL
         3 000025   000000 755000 xsym               STA     TH_MAXDCTX

       64     4912    1        TEMP$ = N$DCT$$->PTR$(TH_MAXDCTX);

   4912  3 000026   000016 470400 2                  LDP0    N$DCT$$
         3 000027   000000 236105                    LDQ     0,AL,PR0
         3 000030   000017 756000 2                  STQ     TEMP$

       65     4913    2        DO WHILE(TEMPPTR.SEGID = %TIGRSID);

   4913  3 000031   000017 236000 2                  LDQ     TEMP$
         3 000032   007777 376007                    ANQ     4095,DL
         3 000033   006123 116007                    CMPQ    3155,DL
         3 000034   000052 601000 3                  TNZ     s:4918

       66     4914    2           TH_DCT$(TH_MAXDCTX) = N$DCT$$->PTR$(TH_MAXDCTX);

   4914  3 000035   000016 470400 2                  LDP0    N$DCT$$
         3 000036   000000 720000 xsym               LXL0    TH_MAXDCTX
         3 000037   000000 236110                    LDQ     0,X0,PR0
         3 000040   000000 756010 xsym               STQ     TH_DCT$,X0

       67     4915    2           TH_MAXDCTX = TH_MAXDCTX + 1;

   4915  3 000041   000000 235000 xsym               LDA     TH_MAXDCTX
         3 000042   000001 035007                    ADLA    1,DL
         3 000043   000000 755000 xsym               STA     TH_MAXDCTX

       68     4916    2           TEMP$ = N$DCT$$->PTR$(TH_MAXDCTX);

   4916  3 000044   000000 236105                    LDQ     0,AL,PR0
         3 000045   000017 756000 2                  STQ     TEMP$
PL6.E3A0      #001=THE$ELAN File=THE$ELAN.:E05TSI                                WED 07/30/97 06:07 Page:12   

       69     4917    2           END;  /* DO WHILE */

   4917  3 000046   000017 236000 2                  LDQ     TEMP$
         3 000047   007777 376007                    ANQ     4095,DL
         3 000050   006123 116007                    CMPQ    3155,DL
         3 000051   000035 600000 3                  TZE     s:4914

       70     4918    1        TH_MAXDCTX = TH_MAXDCTX - 1;

   4918  3 000052   000000 235000 xsym               LDA     TH_MAXDCTX
         3 000053   000001 135007                    SBLA    1,DL
         3 000054   000000 755000 xsym               STA     TH_MAXDCTX

       71     4919    1        IF (B$JIT.CCARS > B$JIT.CCDISP)   /* check if REBUILD option was given */

   4919  3 000055   000000 471400 xsym               LDP1    B$JIT$
         3 000056   100032 720100                    LXL0    26,,PR1
         3 000057   100032 100100                    CMPX0   26,,PR1
         3 000060   000136 605000 3                  TPL     s:4948

       72     4920    2        THEN DO;

       73     4921    2             CALL INDEX(RE_OPT,'REBUILD',B$JIT.CCBUF);  /* locate option*/

   4921  3 000061   200003 631500                    EPPR1   RE_OPT,,AUTO
         3 000062   000020 633400 1                  EPPR3   SEE_TIGR+4
         3 000063   000007 223003                    LDX3    7,DU
         3 000064   000000 470400 xsym               LDP0    B$JIT$
         3 000065   000033 630500                    EPPR0   27,,PR0
         3 000066   000400 220003                    LDX0    256,DU
         3 000067   000000 236003                    LDQ     0,DU
         3 000070   000000 701000 xent               TSX1    X66_INDEX
         3 000071   000000 011000                    NOP     0

       74     4922    2             IF RE_OPT = B$JIT.CCARS

PL6.E3A0      #001=THE$ELAN File=THE$ELAN.:E05TSI                                WED 07/30/97 06:07 Page:13   
   4922  3 000072   000000 470400 xsym               LDP0    B$JIT$
         3 000073   000032 236100                    LDQ     26,,PR0
         3 000074   000022 732000                    QRS     18
         3 000075   200003 116100                    CMPQ    RE_OPT,,AUTO
         3 000076   000106 601000 3                  TNZ     s:4932

       75     4923    3             THEN DO;

       76     4924    3                 CALL THM$ERRMSG(%E$TH_BAD_OPTION);

   4924  3 000077   000003 630400 4                  EPPR0   3
         3 000100   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000101   000000 701000 xent               TSX1    THM$ERRMSG
         3 000102   000000 011000                    NOP     0

       77     4925                      /*E*  ERROR: THE-E$TH_BAD_OPTION-0
       78     4926                            MESSAGE: Bad CALLing option.
       79     4927                            DESCRIPTION: Input option for ELAN to rebuild
       80     4928                                         the :DEVHIST file is REBUILD.   */
       81     4929    3                 CALL M$EXIT;

   4929  3 000103   000001 713400                    CLIMB   exit
         3 000104   000000 401760                    pmme    nvectors=0

       82     4930    3             END;  /* if option is bad */

   4930  3 000105   000136 710000 3                  TRA     s:4948

       83     4931    3             ELSE DO;  /* option is present */

       84     4932    3                 TH_REBUILD = '1'B;

   4932  3 000106   400000 236003                    LDQ     -131072,DU
         3 000107   000000 756000 xsym               STQ     TH_REBUILD

       85     4933    3                 IF (B$JIT.MODE = %M_GHOST#

PL6.E3A0      #001=THE$ELAN File=THE$ELAN.:E05TSI                                WED 07/30/97 06:07 Page:14   
   4933  3 000110   000000 236100                    LDQ     0,,PR0
         3 000111   740000 376003                    ANQ     -16384,DU
         3 000112   100000 116003                    CMPQ    32768,DU
         3 000113   000127 601000 3                  TNZ     s:4937
         3 000114   040000 106500                    CMPC    fill='040'O
         3 000115   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         3 000116   000022 000004 1                  ADSC9   SEE_TIGR+6               cn=0,n=4
         3 000117   000127 601000 3                  TNZ     s:4937
         3 000120   040000 106500                    CMPC    fill='040'O
         3 000121   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
         3 000122   000023 000004 1                  ADSC9   SEE_TIGR+7               cn=0,n=4
         3 000123   000127 601000 3                  TNZ     s:4937

       86     4934    3                     AND B$JIT.ACCN = ':SYS'
       87     4935    3                     AND B$JIT.UNAME = 'ELAN')
       88     4936    3                     THEN TH_DEVHIST_MODE = %MIDNITE_GHOST;

   4936  3 000124   000003 235007                    LDA     3,DL
         3 000125   000000 755000 xsym               STA     TH_DEVHIST_MODE
         3 000126   000131 710000 3                  TRA     s:4938

       89     4937    3                     ELSE TH_DEVHIST_MODE = %REBUILD;

   4937  3 000127   000001 235007                    LDA     1,DL
         3 000130   000000 755000 xsym               STA     TH_DEVHIST_MODE

       90     4938    3                 CALL THE$PROCESS ALTRET(ABORT_ELAN); /* rebuild :DEVHIST*/

   4938  3 000131   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000132   000000 701000 xent               TSX1    THE$PROCESS
         3 000133   000203 702000 3                  TSX2    ABORT_ELAN

       91     4939    3                 CALL M$EXIT;

   4939  3 000134   000001 713400                    CLIMB   exit
         3 000135   000000 401760                    pmme    nvectors=0

PL6.E3A0      #001=THE$ELAN File=THE$ELAN.:E05TSI                                WED 07/30/97 06:07 Page:15   
       92     4940    3             END;  /* option present */

       93     4941    2        END; /* if option given */

       94     4942        /*
       95     4943             Check to see if we're being started as the result of a tape
       96     4944             boot; we're a GHOST running as :SYS,ELAN and all our CCBUF
       97     4945             says is ELAN
       98     4946
       99     4947             JLJ fix 07/09/84                                             */
      100     4948    1        IF TH_PHONY_GHOST

   4948  3 000136   000000 234000 xsym               SZN     TH_PHONY_GHOST
         3 000137   000161 604000 3                  TMI     DO_GHOST1

      101     4949    1        THEN GOTO DO_GHOST1;
      102     4950    1        IF (B$JIT.MODE = %M_GHOST#

   4950  3 000140   000000 470400 xsym               LDP0    B$JIT$
         3 000141   000000 236100                    LDQ     0,,PR0
         3 000142   740000 376003                    ANQ     -16384,DU
         3 000143   100000 116003                    CMPQ    32768,DU
         3 000144   000173 601000 3                  TNZ     s:4965
         3 000145   040000 106500                    CMPC    fill='040'O
         3 000146   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         3 000147   000022 000004 1                  ADSC9   SEE_TIGR+6               cn=0,n=4
         3 000150   000173 601000 3                  TNZ     s:4965
         3 000151   040000 106500                    CMPC    fill='040'O
         3 000152   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
         3 000153   000023 000004 1                  ADSC9   SEE_TIGR+7               cn=0,n=4
         3 000154   000173 601000 3                  TNZ     s:4965
         3 000155   040000 106500                    CMPC    fill='040'O
         3 000156   000033 000400                    ADSC9   27,,PR0                  cn=0,n=256
         3 000157   000023 000004 1                  ADSC9   SEE_TIGR+7               cn=0,n=4
         3 000160   000173 601000 3                  TNZ     s:4965

      103     4951    1             AND
PL6.E3A0      #001=THE$ELAN File=THE$ELAN.:E05TSI                                WED 07/30/97 06:07 Page:16   
      104     4952    1             B$JIT.ACCN = ':SYS'
      105     4953    1             AND
      106     4954    1             B$JIT.UNAME = 'ELAN'
      107     4955    1             AND
      108     4956    1             B$JIT.CCBUF = 'ELAN')
      109     4957    2           THEN DO;

   4954  3 000161                       DO_GHOST1    null
      110     4958    2   DO_GHOST1:;
      111     4959    2                TH_DEVHIST_MODE = %TB_GHOST;

   4959  3 000161   000002 235007                    LDA     2,DL
         3 000162   000000 755000 xsym               STA     TH_DEVHIST_MODE

      112     4960    2                TH_REBUILD = '1'B;     /* SET FLAG TO REBUILD :DEVHIST */

   4960  3 000163   400000 236003                    LDQ     -131072,DU
         3 000164   000000 756000 xsym               STQ     TH_REBUILD

      113     4961    2                CALL THE$PROCESS ALTRET(ABORT_ELAN);

   4961  3 000165   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000166   000000 701000 xent               TSX1    THE$PROCESS
         3 000167   000203 702000 3                  TSX2    ABORT_ELAN

      114     4962    2                CALL M$EXIT;

   4962  3 000170   000001 713400                    CLIMB   exit
         3 000171   000000 401760                    pmme    nvectors=0

      115     4963    2           END; /* if ghost job */

   4963  3 000172   000201 710000 3                  TRA     s:4968

      116     4964    2           ELSE DO;

      117     4965    2             CALL THE$PROCESS ALTRET(ABORT_ELAN); /* REBUILD :DEVHIST, IF NECESSARY */
PL6.E3A0      #001=THE$ELAN File=THE$ELAN.:E05TSI                                WED 07/30/97 06:07 Page:17   

   4965  3 000173   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000174   000000 701000 xent               TSX1    THE$PROCESS
         3 000175   000203 702000 3                  TSX2    ABORT_ELAN

      118     4966    2             CALL THE$REPORT ALTRET(ABORT_ELAN);

   4966  3 000176   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000177   000000 701000 xent               TSX1    THE$REPORT
         3 000200   000203 702000 3                  TSX2    ABORT_ELAN

      119     4967    2           END;

      120     4968    1        CALL M$EXIT;

   4968  3 000201   000001 713400                    CLIMB   exit
         3 000202   000000 401760                    pmme    nvectors=0

      121     4969    1   ABORT_ELAN:
      122     4970    1        CALL THM$ERRMSG;

   4970  3 000203   000002 631400 xsym  ABORT_ELAN   EPPR1   B_VECTNIL+2
         3 000204   000000 701000 xent               TSX1    THM$ERRMSG
         3 000205   000000 011000                    NOP     0

      123     4971    1        CALL M$ERR;

   4971  3 000206   000002 713400                    CLIMB   err
         3 000207   000000 401760                    pmme    nvectors=0

      124     4972    1   END THE$ELAN;

   4972  3 000210   000000 702200 xent               TSX2  ! X66_MARET
      125     4973        %EOD;

PL6.E3A0      #001=THE$ELAN File=THE$ELAN.:E05TSI                                WED 07/30/97 06:07 Page:18   
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   TH_PERR_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THE$ELAN.
PL6.E3A0      #001=THE$ELAN File=THE$ELAN.:E05TSI                                WED 07/30/97 06:07 Page:19   

 **** Variables and constants ****

  ****  Section 001 RoData THE$ELAN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(432)   r     1 FPT_MONINFO               14-0-0/d STRC(144)   r     1 SEE_TIGR

  ****  Section 002  Data  THE$ELAN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    16-0-0/w PTR         r     1 N$DCT$$                   16-0-0/w STRC        r     1 N$DCT$PTR
    21-0-0/w STRC(504)   r     1 P_PCB                     20-0-0/w PTR         r     1 P_PCB$
    17-0-0/w PTR         r     1 TEMP$                     17-0-0/w STRC        r     1 TEMPPTR
     0-0-0/d STRC(468)   r     1 VLR_MONPTRS               40-0-0/d STRC(1404)  r     1 XUR_INIT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w SBIN        r     1 RE_OPT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 TH_DCT$(0:511)
     0-0-0/w UBIN        r     1 TH_DEVHIST_MODE            0-0-0/w UBIN        r     1 TH_MAXDCTX
     0-0-0/b BIT         r     1 TH_PHONY_GHOST             0-0-0/b BIT         r     1 TH_REBUILD

  ****  BASED and DCB variables  ****

PL6.E3A0      #001=THE$ELAN File=THE$ELAN.:E05TSI                                WED 07/30/97 06:07 Page:20   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/w PTR         r     1 PTR$(0:0)


   Procedure THE$ELAN requires 137 words for executable code.
   Procedure THE$ELAN requires 4 words of local(AUTO) storage.
PL6.E3A0      #001=THE$ELAN File=THE$ELAN.:E05TSI                                WED 07/30/97 06:07 Page:21   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=THE$ELAN File=THE$ELAN.:E05TSI                                WED 07/30/97 06:07 Page:22   
          MINI XREF LISTING

ABORT_ELAN
      4970**LABEL    4907--CALLALT  4908--CALLALT  4938--CALLALT  4961--CALLALT  4965--CALLALT  4966--CALLALT
B$JIT.ACCN
       105**DCL      4933>>IF       4950>>IF
B$JIT.CCARS
       193**DCL      4919>>IF       4922>>IF
B$JIT.CCBUF
       193**DCL      4921>>CALLBLT  4950>>IF
B$JIT.CCDISP
       193**DCL      4919>>IF
B$JIT.CPFLAGS1.SLEAZE
       199**DCL       199--REDEF
B$JIT.ERR.MID
       106**DCL       106--REDEF
B$JIT.JRESPEAK
       267**DCL       268--REDEF
B$JIT.MODE
       100**DCL      4933>>IF       4950>>IF
B$JIT.ORIGINATOR_PORT.FROM_CR
       376**DCL       376--REDEF     377--REDEF
B$JIT.PNR
       280**DCL       280--REDEF
B$JIT.TSLINE
       374**DCL       375--REDEF
B$JIT.UNAME
       105**DCL      4933>>IF       4950>>IF
B$JIT$
      4537**DCL       100--IMP-PTR  4919>>IF       4919>>IF       4921>>CALLBLT  4922>>IF       4933>>IF
      4933>>IF       4933>>IF       4950>>IF       4950>>IF       4950>>IF       4950>>IF
DO_GHOST1
      4954**LABEL    4949--GOTO
FPT_MONINFO
PL6.E3A0      #001=THE$ELAN File=THE$ELAN.:E05TSI                                WED 07/30/97 06:07 Page:23   
      4553**DCL      4908<>CALL
M$ERR
        31**DCL-ENT  4971--CALL
M$EXIT
        31**DCL-ENT  4929--CALL     4939--CALL     4962--CALL     4968--CALL
M$MONINFO
        87**DCL-ENT  4908--CALL
M$SAD
        58**DCL-ENT  4907--CALL
N$DCT$$
      4592**DCL      4593--REDEF    4909<<ASSIGN   4912>>ASSIGN   4914>>ASSIGN   4916>>ASSIGN
N$DCT$PTR.SEGID
      4596**DCL      4910<<ASSIGN
PTR$
      4591**DCL      4912>>ASSIGN   4914>>ASSIGN   4916>>ASSIGN
P_PCB
      4623**DCL      4602--DCLINIT  4839--DCLINIT
P_PCB$
      4602**DCL      4906<>CALL
RE_OPT
      4539**DCL      4921<<CALLBLT  4922>>IF
SEE_TIGR
      4586**DCL      4907<>CALL
SEE_TIGR.V
      4586**DCL      4586--DCLINIT
TEMP$
      4597**DCL      4598--REDEF    4912<<ASSIGN   4916<<ASSIGN
TEMPPTR.SEGID
      4601**DCL      4913>>DOWHILE
THE$BREAK
      4530**DCL-ENT  4836--DCLINIT
THE$BRKMSG
      4529**DCL-ENT  4838--DCLINIT
THE$PROCESS
      4532**DCL-ENT  4938--CALL     4961--CALL     4965--CALL
THE$REPORT
PL6.E3A0      #001=THE$ELAN File=THE$ELAN.:E05TSI                                WED 07/30/97 06:07 Page:24   
      4531**DCL-ENT  4966--CALL
THM$ERRMSG
      4533**DCL-ENT  4924--CALL     4970--CALL
TH_CONSTRAINTS.E_BY_B
      1313**DCL      1313--REDEF
TH_CONSTRAINTS.M_BY_B
      1312**DCL      1312--REDEF
TH_CONSTRAINTS.TYPES
      1310**DCL      1310--REDEF
TH_DCT$
      1345**DCL      4914<<ASSIGN
TH_DEFAULT.E_BY_B
      1321**DCL      1321--REDEF
TH_DEFAULT.M_BY_B
      1320**DCL      1320--REDEF
TH_DEFAULT.TYPES
      1318**DCL      1318--REDEF
TH_DEVHIST_MODE
      1335**DCL      4905<<ASSIGN   4936<<ASSIGN   4937<<ASSIGN   4959<<ASSIGN
TH_MAXDCTX
      1344**DCL      4911<<ASSIGN   4912>>ASSIGN   4914>>ASSIGN   4914>>ASSIGN   4915<<ASSIGN   4915>>ASSIGN
      4916>>ASSIGN   4918<<ASSIGN   4918>>ASSIGN
TH_PHONY_GHOST
      1334**DCL      4948>>IF
TH_REBUILD
      1335**DCL      4904<<ASSIGN   4932<<ASSIGN   4960<<ASSIGN
TH_SAVE.E_BY_B
      1329**DCL      1329--REDEF
TH_SAVE.M_BY_B
      1327**DCL      1327--REDEF
TH_SAVE.TYPES
      1325**DCL      1326--REDEF
TH_XSA_BUF_VECTOR
      1345**DCL      1345--REDEF
VLR_MONPTRS
      4568**DCL      4554--DCLINIT
PL6.E3A0      #001=THE$ELAN File=THE$ELAN.:E05TSI                                WED 07/30/97 06:07 Page:25   
VLR_MONPTRS.N$DCT$$
      4568**DCL      4909>>ASSIGN
XTX$ADAPT
      4821**DCL-ENT  4900--DCLINIT
XUR$INIT
      4534**DCL-ENT  4906--CALL
XUR_INIT
      4826**DCL      4906<>CALL
XUR_INIT.WORKR_
      4840**DCL      4841--REDEF

PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:26   
      126        1        /*M* REPORT GENERATOR EXEC FOR ELAN */
      127        2        /*T***********************************************************/
      128        3        /*T*                                                         */
      129        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      130        5        /*T*                                                         */
      131        6        /*T***********************************************************/
      132        7        THE$REPORT : PROC ALTRET;
      133        8        /**/
      134        9        /* INCLUDES FILES */
      135       10        %INCLUDE CP_6;
      136       91        %INCLUDE B$JIT;
      137      381        %INCLUDE XU_MACRO_C;
      138     3487        %INCLUDE F$DCB;
      139     3536        %INCLUDE B_ERRORS_C;
      140     4663        %INCLUDE CP_6_SUBS;
      141     5203        %INCLUDE TH_DATA_R;
      142     5281        %INCLUDE TH_SUBS_C;
      143     5663        %INCLUDE TH_PERR_C;
      144     5704        %INCLUDE XUD_UTS_M;
      145     5786        /**/
      146     5787        /* SYMREFS */
      147     5788    1   DCL B$JIT$ PTR SYMREF;
      148     5789        /**/
      149     5790        /* ENTRY DEFINITIONS */
      150     5791    1   DCL XUR$GETCMD ENTRY(6) ALTRET;
      151     5792    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
      152     5793    1   DCL XUR$ERRPTR ENTRY(2) ALTRET;
      153     5794    1   DCL XUR$ENABLE ENTRY;
      154     5795    1   DCL XUR$DISABLE ENTRY;
      155     5796    1   DCL THC$COMMANDS ENTRY(1);
      156     5797    1   DCL THG$GETREC ENTRY(4) ALTRET;
      157     5798    1   DCL THG$CLOSEXSA ENTRY ALTRET;
      158     5799    1   DCL THI$INIT ENTRY;
      159     5800    1   DCL XUR$BREAK ENTRY ASYNC;
      160     5801    1   DCL THW$WRITE ENTRY(11);
      161     5802    1   DCL THM$ERRMSG ENTRY(1);
      162     5803        /**/
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:27   
      163     5804        /* DCBS */
      164     5805    1   DCL M$SI DCB;
      165     5806    1   DCL M$LO DCB;
      166     5807    1   DCL M$DO DCB;
      167     5808    1   DCL M$ERRLOG DCB;
      168     5809        /**/
      169     5810        /* FPT DEFINITIONS */
      170     5811        %FPT_PRIV (FPTN=SET_PRIV,
      171     5812                   PRIV="%(%PR_SPCLMM#)",
      172     5813                   STCLASS=CONSTANT);
      173     5828        %FPT_PRIV (FPTN=TEST_PRIV,
      174     5829                   PRIV="%(%PR_SPCLMM#)",
      175     5830                   AUTH=YES,
      176     5831                   STCLASS=CONSTANT);
      177     5846        %FPT_PRIV (PPRIV=YES,
      178     5847                   STCLASS=CONSTANT,
      179     5848                   PRIV=%PPR_EL#);
      180     5863        %FPT_TIME (FPTN=LOCAL,
      181     5864                   STCLASS=CONSTANT,
      182     5865                   SOURCE=UTS,
      183     5866                   DEST=LOCAL,
      184     5867                   DATE=DBUF,
      185     5868                   TIME=TBUF);
      186     5887        %FPT_TIME (FPTN=CUR_DATE,
      187     5888                   STCLASS=CONSTANT,
      188     5889                   SOURCE=CLOCK,
      189     5890                   DEST=UTS,
      190     5891                   TSTAMP=CURDATE);
      191     5910        %FPT_TIME (FPTN=CUR_TIME,
      192     5911                   SOURCE=UTS,
      193     5912                   DEST=EXT,
      194     5913                   TSTAMP=CURDATE,
      195     5914                   TIME=TH_TIME,
      196     5915                   DATE=TH_DATE);
      197     5934        %FPT_TIME (FPTN=ANS_DATE,
      198     5935                   STCLASS=CONSTANT,
      199     5936                   DEST=ANS,
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:28   
      200     5937                   SOURCE=UTS,
      201     5938                   TSTAMP=CURDATE,
      202     5939                   DATE=ANSDATE);
      203     5958        %FPT_TIME (FPTN=FIRST_ERRLG,
      204     5959                   DEST=UTS,
      205     5960                   TIME=TIME_BUF,
      206     5961                   TSTAMP=TH_FIRST_ERRLG,
      207     5962                   SOURCE=ANS);
      208     5981        %FPT_OPEN (FPTN=OPEN_LO,
      209     5982                   DCB=M$LO,
      210     5983                   SCRUB=YES,
      211     5984                   REASSIGN=YES,
      212     5985                   STCLASS="STATIC SYMDEF");
      213     6094        %FPT_OPEN (FPTN=TH_OPEN_ERRLOG,
      214     6095                   STCLASS=SYMREF);
      215     6204        %FPT_OPEN (FPTN=FIND_FIRST,
      216     6205                   STCLASS=CONSTANT,
      217     6206                   TEST=YES,
      218     6207                   DCB=M$ERRLOG,
      219     6208                   NAME=ERRLOG,
      220     6209                   ACCT=VLP_SYSTAC,
      221     6210                   NXTF=YES,
      222     6211                   THISF=NO,
      223     6212                   ASN=FILE,
      224     6213                   FUN=IN,
      225     6214                   SHARE=ALL);
      226     6323        %FPT_READ (FPTN=READ_CMD,
      227     6324                   STCLASS=CONSTANT,
      228     6325                   BUF=CMD_BUF,
      229     6326                   DCB=M$SI);
      230     6365        %FPT_WRITE (FPTN=ECHO_FPT,
      231     6366                    STCLASS=CONSTANT,
      232     6367                    BUF=CMD_BUF,
      233     6368                    DCB=M$LO);
      234     6399        %FPT_CLOSE (FPTN=CLOSE_LO,
      235     6400                    STCLASS=CONSTANT,
      236     6401                    DCB=M$LO);
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:29   
      237     6443        %FPT_CLOSE (FPTN=TH_CLOSE_ERRLOG,
      238     6444                    STCLASS=SYMREF);
      239     6486        %VLP_NAME (FPTN=TH_VLP_ERRLOGX,
      240     6487                   STCLASS=SYMREF);
      241     6514        %VLP_ACCT (FPTN=TH_VLP_ACCT,
      242     6515                   STCLASS=SYMREF);
      243     6528        %VLP_NAME (FPTN=TH_VLP_ERRLOG,
      244     6529                   STCLASS=SYMREF,
      245     6530                   LEN=15);
      246     6557        %VLP_NAME (FPTN=ERRLOG,
      247     6558                   STCLASS=CONSTANT,
      248     6559                   NAME=':ERRLOG19780100');
      249     6586        %FPT_INT (UENTRY=XUR$BREAK,
      250     6587                  STCLASS=CONSTANT);
      251     6601        %FPT_MONINFO (SITEINFO=VLR_SITEINFO,
      252     6602                      STCLASS=CONSTANT);
      253     6617        %VLR_SITEINFO;
      254     6636        /**/
      255     6637        /* VARIABLE DECLARES */
      256     6638    1   DCL B$TCB$ PTR SYMREF;
      257     6639    1   DCL ANSDATE CHAR(6) STATIC;
      258     6640    1   DCL TEMP_DATE CHAR(8);    /* 'yyyymmdd' */
      259     6641    1   DCL CURDATE UBIN WORD STATIC;
      260     6642    1   DCL NDAYS UBIN WORD;
      261     6643    1   DCL NAMEBUF CHAR(15);
      262     6644    1   DCL FIRST_DATE CHAR(6) STATIC;
      263     6645    1   DCL TIME_BUF CHAR(8) STATIC INIT('00000000');
      264     6646    1   DCL TBUF CHAR(5) STATIC;
      265     6647    1   DCL DBUF CHAR(8) STATIC;
      266     6648    1   DCL ERRCODE UBIN(14);
      267     6649    1   DCL TH_CMD SBIN SYMREF;
      268     6650    1   DCL TOP$ PTR;
      269     6651    1   DCL PARSE_CODE REDEF TOP$ BIT(36);
      270     6652    1   DCL CMD_BUF CHAR(256) STATIC;
      271     6653    1   DCL PRMT CHAR(0) CONSTANT INIT('elan:');
      272     6654        %FPT_PROMPT(FPTN=USER_PRMT,
      273     6655                    VFC=YES);
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:30   
      274     6683    1   DCL NEW_PRMT$ PTR;
      275     6684    1   DCL 1 PRMT_NEW$ BASED UNAL,
      276     6685    1          2 * CHAR(TH_PRMT_SIZE);
      277     6686    1   DCL HI_FMT CHAR(0) STATIC INIT(
      278     6687    1       'ELAN %A here...%A is first available errorlog %10P');
      279     6688    1   DCL HI_VEC BIT(72) DALIGNED STATIC INIT(VECTOR(HI_FMT));
      280     6689    1   DCL B_VERSION CHAR(1) SYMREF;
      281     6690    1   DCL 1 B$VERSIONB BASED,
      282     6691    1         2 C_ UBIN BYTE CALIGNED,
      283     6692    1         2 T_ CHAR(B$VERSIONB.C_) CALIGNED;
      284     6693        /**/
      285     6694        /* MACRO INVOCATIONS */
      286     6695        %P_PCB (STCLASS=SYMREF);
      287     6894        %B$TCB;
      288     6897        %B$ALT;
      289     6905        %XUD$UTS_ENTRIES;
      290     6937        %XUD_UTS_EQU;
      291     6948        /**/
      292     6949        %EJECT;
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:31   
      293     6950    1           CALL M$SPRIV (FPT_PRIV)
      294     6951    2           WHENALTRETURN DO;
      295     6952    2              CALL M$SPRIV (TEST_PRIV)
      296     6953    3              WHENALTRETURN DO;
      297     6954    3   BADPRIV:      ;
      298     6955    3                 CALL THM$ERRMSG(%E$TH_NO_ELAN_PRIV);
      299     6956                      /*E*  ERROR: THE-E$TH_NO_ELAN_PRIV-0
      300     6957                            MESSAGE: You're not allowed to run ELAN.
      301     6958                            DESCRIPTION: Insufficient privilege or PPRIVs to
      302     6959                                         run the ELAN processor.         */
      303     6960    3                 CALL M$XXX;
      304     6961    3                 END;                      /* DO IF SPCLMM NOT AUTHORIZED        */
      305     6962    2              END;                         /* DO IF EL PPRIV NOT SET             */
      306     6963    1           CALL M$SPRIV (SET_PRIV)         /* ASSUME SPCLMM FROM LINK OK         */
      307     6964    2           WHENALTRETURN DO;
      308     6965    2              GOTO BADPRIV;
      309     6966    2              END;
      310     6967    1           CALL M$TIME(CUR_DATE);
      311     6968    1            CALL M$TIME(CUR_TIME);
      312     6969    1           TH_CURDATE = CURDATE;
      313     6970    1           CALL XUD$UTS_DIFF_SEC (NDAYS, CURDATE, 0);
      314     6971    1           NDAYS = NDAYS/86400;
      315     6972    1           CALL XUD$UTS_ADJ_25TH (TH_DEFAULT.START, 0, NDAYS*%UTS_25TH_DAY#);
      316     6973    1           CALL XUD$UTS_ADJ_25TH (TH_DEFAULT.STOP, TH_DEFAULT.START, %UTS_25TH_DAY# -1)
              6973                    ;
      317     6974    1           TH_CONSTRAINTS = TH_DEFAULT;
      318     6975    1           TH_PROC_FLAG = %TRUE;
      319     6976    1           CALL M$MONINFO(FPT_MONINFO);
      320     6977    1           TH_SITE_ID = VLR_SITEINFO.SITE_ID#;
      321     6978    1           TH_SITE_NAME = VLR_SITEINFO.SITE_NAME#;
      322     6979
      323     6980    1           TH_ENDFLAG = %FALSE;
      324     6981    1           REMEMBER ERR_RETURN IN TH_ERR_RETURN;
      325     6982    1             CALL XUR$DISABLE;
      326     6983
      327     6984    1           CALL THI$INIT;
      328     6985
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:32   
      329     6986    1             CALL XUR$ENABLE;
      330     6987
      331     6988    1             CALL M$INT (FPT_INT);
      332     6989                                                /* CALL COMMAND DRIVER                */
      333     6990    2           DO WHILE(NOT TH_ENDFLAG);
      334     6991    2          IF TH_CHANGE_FILE
      335     6992    3             THEN DO;
      336     6993    3               TH_OPEN_ERRLOG.V.SHARE# = %IN#;
      337     6994    3               TH_OPEN_ERRLOG.NAME_ = VECTOR(TH_VLP_ERRLOGX);
      338     6995    3               TH_OPEN_ERRLOG.ACCT_ = VECTOR(TH_VLP_ACCT);
      339     6996    3               TH_M$ERRLOG$ = DCBADDR(DCBNUM(M$ERRLOG));
      340     6997    3               CALL M$OPEN(TH_OPEN_ERRLOG) ALTRET(OPEN_ERR2);
      341     6998    3               CALL THG$GETREC(%ERRLOG) ALTRET(ERRLOG_FILE_ERR);
      342     6999    3               CALL M$CLOSE(TH_CLOSE_ERRLOG);
      343     7000    3               TH_CHANGE_FILE = '0'B;
      344     7001    4               DO NEVER;
      345     7002    4   OPEN_ERR2:
      346     7003    4                 CALL THM$ERRMSG;
      347     7004    4                 TH_OPEN_ERRLOG.ACCT_ = VECTOR(VLP_SYSTAC);
      348     7005    4                 TH_OPEN_ERRLOG.NAME_ = VECTOR(TH_VLP_ERRLOG);
      349     7006    4                 TH_CHANGE_ACCOUNT = '1'B;
      350     7007    4                 TH_CHANGE_FILE = '0'B;
      351     7008    4               END;
      352     7009    4               DO NEVER;
      353     7010    4   ERRLOG_FILE_ERR:
      354     7011    4                 CALL THM$ERRMSG(%E$TH_BAD_ERRLOG_FILE);
      355     7012                      /*E*  ERROR:  THE-E$TH_BAD_ERRLOG_FILE-0
      356     7013                            MESSAGE:  Bad errlog file. Unable to process. */
      357     7014    4                 TH_OPEN_ERRLOG.ACCT_ = VECTOR(VLP_SYSTAC);
      358     7015    4                 TH_CHANGE_ACCOUNT = '1'B;
      359     7016    4                 TH_CHANGE_FILE = '0'B;
      360     7017    4               END;
      361     7018    3             END;
      362     7019    2           IF TH_CHANGE_ACCOUNT
      363     7020    3            THEN DO;
      364     7021    3           CALL M$TIME(ANS_DATE);
      365     7022    3           IF ASCBIN(SUBSTR(ANSDATE,0,1)) < 55 THEN /* less than 7 ? */
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:33   
      366     7023    3            CALL CONCAT(TEMP_DATE,'20',ANSDATE);
      367     7024    3           ELSE
      368     7025    3            CALL CONCAT(TEMP_DATE,'19',ANSDATE);
      369     7026    3           CALL CONCAT(NAMEBUF,':ERRLOG',TEMP_DATE);
      370     7027    3           TH_OPEN_ERRLOG.V.SHARE# = %ALL#;
      371     7028    3           TH_VLP_ERRLOG.NAME# = NAMEBUF;
      372     7029    3           TH_M$ERRLOG$ = DCBADDR(DCBNUM(M$ERRLOG));
      373     7030    3           CALL M$OPEN(TH_OPEN_ERRLOG) ALTRET(OPEN_ERR);
      374     7031    4           DO NEVER;                       /* OPEN ERROR HANDLING                */
      375     7032    4   OPEN_ERR:  CALL THM$ERRMSG;
      376     7033                   /*E* ERROR: THE-E$TH_ERRLOG_NOT_EXIST-0
      377     7034                        MESSAGE: The errlog doesn't exist.
      378     7035                   */
      379     7036    4           END;                            /* DO NEVER                           */
      380     7037    3           CALL M$CLOSE(TH_CLOSE_ERRLOG);
      381     7038
      382     7039                                                /* LOOK FOR FIRST AVAIL. :ERRLOG FILE */
      383     7040    3           CALL M$OPEN(FIND_FIRST) ALTRET(NO_ERRLOG_FILES);
      384     7041    3           IF TH_M$ERRLOG$->F$DCB.NAME.L ~= LENGTHC( ':ERRLOGyyyymmdd' )
      385     7042    3            THEN GOTO NO_ERRLOG_FILES;
      386     7043    3           NAMEBUF = TH_M$ERRLOG$->F$DCB.NAME.C;
      387     7044    3           IF SUBSTR(NAMEBUF,0,7) ~= ':ERRLOG' THEN GOTO NO_ERRLOG_FILES;
      388     7045    3           FIRST_DATE = SUBSTR(NAMEBUF,9,6);
      389     7046    3           FIRST_ERRLG.DATE_ = VECTOR(FIRST_DATE);
      390     7047    3           CALL M$TIME(FIRST_ERRLG) ALTRET(NO_ERRLOG_FILES);
      391     7048    3           CALL THW$WRITE(HI_VEC,VECTOR(ADDR(B_VERSION)->B$VERSIONB.T_),VECTOR(NAMEBUF)
              7048                    );
      392     7049    3               TH_CHANGE_ACCOUNT = '0'B;
      393     7050
      394     7051    4            DO NEVER;
      395     7052    4   NO_ERRLOG_FILES: ;
      396     7053    4               CALL THM$ERRMSG( %E$TH_NO_ERRLOG_FILES );
      397     7054                    /*E* ERROR: THE-E$TH_NO_ERRLOG_FILES-0
      398     7055                         MESSAGE: The USE account contains no :ERRLOG files
      399     7056                    */
      400     7057    4               END;
      401     7058    3           END;
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:34   
      402     7059    2          IF TH_PRMT_FLAG
      403     7060    3            THEN DO;
      404     7061    3                NEW_PRMT$ = ADDR(TH_PRMT);
      405     7062    3                USER_PRMT.PROMPT_ = VECTOR(NEW_PRMT$->PRMT_NEW$);
      406     7063    3                CALL M$PROMPT(USER_PRMT) ALTRET(PARSE_ERR);
      407     7064    3                CALL XUR$GETCMD(TH_CMD,TOP$) ALTRET(PARSE_ERR);
      408     7065    3                 END;
      409     7066    2            ELSE
      410     7067    2                CALL XUR$GETCMD(TH_CMD,TOP$,VECTOR(PRMT)) ALTRET(PARSE_ERR);
      411     7068    2              CALL THC$COMMANDS(TOP$);
      412     7069    2              CALL THG$CLOSEXSA;
      413     7070    3              DO NEVER;                    /* PARSE ERROR HANDLING               */
      414     7071    3   PARSE_ERR:    TH_ERRCODE = PARSE_CODE;
      415     7072    3                 IF NOT TH_ERRCODE.MON
      416     7073    3                    THEN TH_CPOS = P_PCB.HI_CHAR;
      417     7074    3                    ELSE TH_ENDFLAG = %TRUE;
      418     7075    3                 IF TH_ERRCODE.FCG = '302522'O  /* 'XUR' */ AND TH_ERRCODE.CODE = 1
      419     7076    3                    THEN
      420     7077    4                    DO;
      421     7078    4                       TH_ERRCODE = '241005000000'O;
      422     7079    4                       IF TH_CPOS = 0
      423     7080    4                          THEN
      424     7081    5                          DO;
      425     7082    5                             TH_ERRCODE.CODE = %E$TH_CMDERR;
      426     7083    5                             TH_CPOS = -1;
      427     7084    5                          END;
      428     7085    4                          ELSE
      429     7086    5                          DO;
      430     7087    5                             TH_ERRCODE.CODE = %E$TH_SYNTAX;
      431     7088    5                          END;
      432     7089    4                    END;                   /* IF FCG = 'XUP' AND CODE = 1        */
      433     7090    3                 IF TH_CPOS >= 0 THEN CALL XUR$ERRPTR(TH_CPOS,DCBNUM(M$DO));
      434     7091    3                 TH_CPOS = -1;
      435     7092    3                 CALL XUR$ERRMSG(TH_ERRCODE,DCBNUM(M$SI),DCBNUM(M$DO));
      436     7093    3   ERR_RETURN:
      437     7094    3              END;                         /* DO NEVER                           */
      438     7095    2           END;                            /* DO WHILE NOT TH_ENDFLAG            */
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:35   
      439     7096    1        RETURN;
      440     7097             /*E* ERROR: THE-E$TH_NO_WORK_SPACE-0
      441     7098                  MESSAGE: Unable to get necessary memory - ELAN aborts
      442     7099             */
      443     7100        /*E* ERROR: THE-E$TH_SYNTAX-0
      444     7101             MESSAGE: Syntax error      */
      445     7102        /*E* ERROR: THE-E$TH_CMDERR-0
      446     7103             MESSAGE: Eh?
      447     7104             MESSAGE1: Unknown command.
      448     7105        */
      449     7106        %EJECT;
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:36   
      450     7107    1   END THE$REPORT;
      451     7108        %EOD;

PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:37   
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   TH_PERR_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THE$REPORT.

   Procedure THE$REPORT requires 355 words for executable code.
   Procedure THE$REPORT requires 28 words of local(AUTO) storage.

PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:38   

 Object Unit name= THE$REPORT                                 File name= THE$ELAN.:E05TOU
 UTS= JUL 30 '97 06:07:55.92 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$SI
    2   DCB   even  none     0      0  M$LO
    3   DCB   even  none     0      0  M$DO
    4   DCB   even  none     0      0  M$ERRLOG
    5  RoData even  UTS    193    301  THE$REPORT
    6   Data  even  none   246    366  THE$REPORT
    7   Proc  even  none   355    543  THE$REPORT
    8  RoData even  none    38     46  THE$REPORT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     7      0   yes    yes     yes      Std        0  THE$REPORT

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    6     30  OPEN_LO
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:39   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          Async      0 XUR$BREAK
         yes           Std       1 THM$ERRMSG
 yes     yes           Std       3 XUD$UTS_DIFF_SEC
         yes           Std       0 XUR$DISABLE
 yes     yes           Std       6 XUR$GETCMD
         yes           Std       1 THC$COMMANDS
 yes     yes           Std       3 XUD$UTS_ADJ_25TH
         yes           Std      11 THW$WRITE
 yes     yes           Std       0 THG$CLOSEXSA
         yes           Std       0 THI$INIT
         yes           Std       0 XUR$ENABLE
 yes     yes           Std       4 THG$GETREC
 yes     yes           Std       2 XUR$ERRPTR
 yes     yes           Std       7 XUR$ERRMSG
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:40   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TH_CONSTRAINTS                        TH_DEFAULT
     TH_ERR_RETURN                         TH_ERRCODE                            TH_CPOS
     TH_ENDFLAG                            TH_CURDATE                            TH_FIRST_ERRLG
     TH_DATE                               TH_TIME                               TH_SITE_ID
     TH_SITE_NAME                          TH_PROC_FLAG                          TH_XSA_BUF_VECTOR
     TH_M$ERRLOG$                          VLP_SYSTAC                            TH_CHANGE_ACCOUNT
     TH_CHANGE_FILE                        TH_PRMT_FLAG                          TH_PRMT
     TH_PRMT_SIZE                          B$JIT$                                M$SI
     M$LO                                  M$DO                                  M$ERRLOG
     TH_OPEN_ERRLOG                        TH_CLOSE_ERRLOG                       TH_VLP_ERRLOGX
     TH_VLP_ACCT                           TH_VLP_ERRLOG                         TH_CMD
     B_VERSION                             P_PCB                                 B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:41   


      126        1        /*M* REPORT GENERATOR EXEC FOR ELAN */
      127        2        /*T***********************************************************/
      128        3        /*T*                                                         */
      129        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      130        5        /*T*                                                         */
      131        6        /*T***********************************************************/
      132        7        THE$REPORT : PROC ALTRET;

      7  7 000000   000000 700200 xent  THE$REPORT   TSX0  ! X66_AUTO_0
         7 000001   000034 000000                    ZERO    28,0

      133        8        /**/
      134        9        /* INCLUDES FILES */
      135       10        %INCLUDE CP_6;
      136       91        %INCLUDE B$JIT;
      137      381        %INCLUDE XU_MACRO_C;
      138     3487        %INCLUDE F$DCB;
      139     3536        %INCLUDE B_ERRORS_C;
      140     4663        %INCLUDE CP_6_SUBS;
      141     5203        %INCLUDE TH_DATA_R;
      142     5281        %INCLUDE TH_SUBS_C;
      143     5663        %INCLUDE TH_PERR_C;
      144     5704        %INCLUDE XUD_UTS_M;
      145     5786        /**/
      146     5787        /* SYMREFS */
      147     5788    1   DCL B$JIT$ PTR SYMREF;
      148     5789        /**/
      149     5790        /* ENTRY DEFINITIONS */
      150     5791    1   DCL XUR$GETCMD ENTRY(6) ALTRET;
      151     5792    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
      152     5793    1   DCL XUR$ERRPTR ENTRY(2) ALTRET;
      153     5794    1   DCL XUR$ENABLE ENTRY;
      154     5795    1   DCL XUR$DISABLE ENTRY;
      155     5796    1   DCL THC$COMMANDS ENTRY(1);
      156     5797    1   DCL THG$GETREC ENTRY(4) ALTRET;
      157     5798    1   DCL THG$CLOSEXSA ENTRY ALTRET;
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:42   
      158     5799    1   DCL THI$INIT ENTRY;
      159     5800    1   DCL XUR$BREAK ENTRY ASYNC;
      160     5801    1   DCL THW$WRITE ENTRY(11);
      161     5802    1   DCL THM$ERRMSG ENTRY(1);
      162     5803        /**/
      163     5804        /* DCBS */
      164     5805    1   DCL M$SI DCB;
      165     5806    1   DCL M$LO DCB;
      166     5807    1   DCL M$DO DCB;
      167     5808    1   DCL M$ERRLOG DCB;
      168     5809        /**/
      169     5810        /* FPT DEFINITIONS */
      170     5811        %FPT_PRIV (FPTN=SET_PRIV,
      171     5812                   PRIV="%(%PR_SPCLMM#)",
      172     5813                   STCLASS=CONSTANT);
      173     5828        %FPT_PRIV (FPTN=TEST_PRIV,
      174     5829                   PRIV="%(%PR_SPCLMM#)",
      175     5830                   AUTH=YES,
      176     5831                   STCLASS=CONSTANT);
      177     5846        %FPT_PRIV (PPRIV=YES,
      178     5847                   STCLASS=CONSTANT,
      179     5848                   PRIV=%PPR_EL#);
      180     5863        %FPT_TIME (FPTN=LOCAL,
      181     5864                   STCLASS=CONSTANT,
      182     5865                   SOURCE=UTS,
      183     5866                   DEST=LOCAL,
      184     5867                   DATE=DBUF,
      185     5868                   TIME=TBUF);
      186     5887        %FPT_TIME (FPTN=CUR_DATE,
      187     5888                   STCLASS=CONSTANT,
      188     5889                   SOURCE=CLOCK,
      189     5890                   DEST=UTS,
      190     5891                   TSTAMP=CURDATE);
      191     5910        %FPT_TIME (FPTN=CUR_TIME,
      192     5911                   SOURCE=UTS,
      193     5912                   DEST=EXT,
      194     5913                   TSTAMP=CURDATE,
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:43   
      195     5914                   TIME=TH_TIME,
      196     5915                   DATE=TH_DATE);
      197     5934        %FPT_TIME (FPTN=ANS_DATE,
      198     5935                   STCLASS=CONSTANT,
      199     5936                   DEST=ANS,
      200     5937                   SOURCE=UTS,
      201     5938                   TSTAMP=CURDATE,
      202     5939                   DATE=ANSDATE);
      203     5958        %FPT_TIME (FPTN=FIRST_ERRLG,
      204     5959                   DEST=UTS,
      205     5960                   TIME=TIME_BUF,
      206     5961                   TSTAMP=TH_FIRST_ERRLG,
      207     5962                   SOURCE=ANS);
      208     5981        %FPT_OPEN (FPTN=OPEN_LO,
      209     5982                   DCB=M$LO,
      210     5983                   SCRUB=YES,
      211     5984                   REASSIGN=YES,
      212     5985                   STCLASS="STATIC SYMDEF");
      213     6094        %FPT_OPEN (FPTN=TH_OPEN_ERRLOG,
      214     6095                   STCLASS=SYMREF);
      215     6204        %FPT_OPEN (FPTN=FIND_FIRST,
      216     6205                   STCLASS=CONSTANT,
      217     6206                   TEST=YES,
      218     6207                   DCB=M$ERRLOG,
      219     6208                   NAME=ERRLOG,
      220     6209                   ACCT=VLP_SYSTAC,
      221     6210                   NXTF=YES,
      222     6211                   THISF=NO,
      223     6212                   ASN=FILE,
      224     6213                   FUN=IN,
      225     6214                   SHARE=ALL);
      226     6323        %FPT_READ (FPTN=READ_CMD,
      227     6324                   STCLASS=CONSTANT,
      228     6325                   BUF=CMD_BUF,
      229     6326                   DCB=M$SI);
      230     6365        %FPT_WRITE (FPTN=ECHO_FPT,
      231     6366                    STCLASS=CONSTANT,
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:44   
      232     6367                    BUF=CMD_BUF,
      233     6368                    DCB=M$LO);
      234     6399        %FPT_CLOSE (FPTN=CLOSE_LO,
      235     6400                    STCLASS=CONSTANT,
      236     6401                    DCB=M$LO);
      237     6443        %FPT_CLOSE (FPTN=TH_CLOSE_ERRLOG,
      238     6444                    STCLASS=SYMREF);
      239     6486        %VLP_NAME (FPTN=TH_VLP_ERRLOGX,
      240     6487                   STCLASS=SYMREF);
      241     6514        %VLP_ACCT (FPTN=TH_VLP_ACCT,
      242     6515                   STCLASS=SYMREF);
      243     6528        %VLP_NAME (FPTN=TH_VLP_ERRLOG,
      244     6529                   STCLASS=SYMREF,
      245     6530                   LEN=15);
      246     6557        %VLP_NAME (FPTN=ERRLOG,
      247     6558                   STCLASS=CONSTANT,
      248     6559                   NAME=':ERRLOG19780100');
      249     6586        %FPT_INT (UENTRY=XUR$BREAK,
      250     6587                  STCLASS=CONSTANT);
      251     6601        %FPT_MONINFO (SITEINFO=VLR_SITEINFO,
      252     6602                      STCLASS=CONSTANT);
      253     6617        %VLR_SITEINFO;
      254     6636        /**/
      255     6637        /* VARIABLE DECLARES */
      256     6638    1   DCL B$TCB$ PTR SYMREF;
      257     6639    1   DCL ANSDATE CHAR(6) STATIC;
      258     6640    1   DCL TEMP_DATE CHAR(8);    /* 'yyyymmdd' */
      259     6641    1   DCL CURDATE UBIN WORD STATIC;
      260     6642    1   DCL NDAYS UBIN WORD;
      261     6643    1   DCL NAMEBUF CHAR(15);
      262     6644    1   DCL FIRST_DATE CHAR(6) STATIC;
      263     6645    1   DCL TIME_BUF CHAR(8) STATIC INIT('00000000');
      264     6646    1   DCL TBUF CHAR(5) STATIC;
      265     6647    1   DCL DBUF CHAR(8) STATIC;
      266     6648    1   DCL ERRCODE UBIN(14);
      267     6649    1   DCL TH_CMD SBIN SYMREF;
      268     6650    1   DCL TOP$ PTR;
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:45   
      269     6651    1   DCL PARSE_CODE REDEF TOP$ BIT(36);
      270     6652    1   DCL CMD_BUF CHAR(256) STATIC;
      271     6653    1   DCL PRMT CHAR(0) CONSTANT INIT('elan:');
      272     6654        %FPT_PROMPT(FPTN=USER_PRMT,
      273     6655                    VFC=YES);
      274     6683    1   DCL NEW_PRMT$ PTR;
      275     6684    1   DCL 1 PRMT_NEW$ BASED UNAL,
      276     6685    1          2 * CHAR(TH_PRMT_SIZE);
      277     6686    1   DCL HI_FMT CHAR(0) STATIC INIT(
      278     6687    1       'ELAN %A here...%A is first available errorlog %10P');
      279     6688    1   DCL HI_VEC BIT(72) DALIGNED STATIC INIT(VECTOR(HI_FMT));
      280     6689    1   DCL B_VERSION CHAR(1) SYMREF;
      281     6690    1   DCL 1 B$VERSIONB BASED,
      282     6691    1         2 C_ UBIN BYTE CALIGNED,
      283     6692    1         2 T_ CHAR(B$VERSIONB.C_) CALIGNED;
      284     6693        /**/
      285     6694        /* MACRO INVOCATIONS */
      286     6695        %P_PCB (STCLASS=SYMREF);
      287     6894        %B$TCB;
      288     6897        %B$ALT;
      289     6905        %XUD$UTS_ENTRIES;
      290     6937        %XUD_UTS_EQU;
      291     6948        /**/
      292     6949        %EJECT;
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:46   
      293     6950    1           CALL M$SPRIV (FPT_PRIV)

   6950  7 000002   000010 630400 5                  EPPR0   FPT_PRIV
         7 000003   420012 713400                    CLIMB   alt,+8202
         7 000004   400000 401760                    pmme    nvectors=1
         7 000005   000007 702000 7                  TSX2    s:6952
         7 000006   000022 710000 7                  TRA     s:6963

      294     6951    2           WHENALTRETURN DO;

      295     6952    2              CALL M$SPRIV (TEST_PRIV)

   6952  7 000007   000004 630400 5                  EPPR0   TEST_PRIV
         7 000010   420012 713400                    CLIMB   alt,+8202
         7 000011   400000 401760                    pmme    nvectors=1
         7 000012   000014 702000 7                  TSX2    BADPRIV
         7 000013   000022 710000 7                  TRA     s:6963

      296     6953    3              WHENALTRETURN DO;

   6953  7 000014                       BADPRIV      null
      297     6954    3   BADPRIV:      ;
      298     6955    3                 CALL THM$ERRMSG(%E$TH_NO_ELAN_PRIV);

   6955  7 000014   000001 630400 8                  EPPR0   1
         7 000015   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 000016   000000 701000 xent               TSX1    THM$ERRMSG
         7 000017   000000 011000                    NOP     0

      299     6956                      /*E*  ERROR: THE-E$TH_NO_ELAN_PRIV-0
      300     6957                            MESSAGE: You're not allowed to run ELAN.
      301     6958                            DESCRIPTION: Insufficient privilege or PPRIVs to
      302     6959                                         run the ELAN processor.         */
      303     6960    3                 CALL M$XXX;

   6960  7 000020   000003 713400                    CLIMB   3
         7 000021   000000 401760                    pmme    nvectors=0
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:47   

      304     6961    3                 END;                      /* DO IF SPCLMM NOT AUTHORIZED        */

      305     6962    2              END;                         /* DO IF EL PPRIV NOT SET             */

      306     6963    1           CALL M$SPRIV (SET_PRIV)         /* ASSUME SPCLMM FROM LINK OK         */

   6963  7 000022   000000 630400 5                  EPPR0   SET_PRIV
         7 000023   420012 713400                    CLIMB   alt,+8202
         7 000024   400000 401760                    pmme    nvectors=1
         7 000025   000027 702000 7                  TSX2    s:6965
         7 000026   000030 710000 7                  TRA     s:6967

      307     6964    2           WHENALTRETURN DO;

      308     6965    2              GOTO BADPRIV;

   6965  7 000027   000014 710000 7                  TRA     BADPRIV

      309     6966    2              END;
      310     6967    1           CALL M$TIME(CUR_DATE);

   6967  7 000030   000030 630400 5                  EPPR0   CUR_DATE
         7 000031   020004 713400                    CLIMB   8196
         7 000032   402000 401760                    pmme    nvectors=5

      311     6968    1            CALL M$TIME(CUR_TIME);

   6968  7 000033   000000 630400 6                  EPPR0   CUR_TIME
         7 000034   020004 713400                    CLIMB   8196
         7 000035   402000 401760                    pmme    nvectors=5

      312     6969    1           TH_CURDATE = CURDATE;

   6969  7 000036   000222 235000 6                  LDA     CURDATE
         7 000037   000000 755000 xsym               STA     TH_CURDATE

PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:48   
      313     6970    1           CALL XUD$UTS_DIFF_SEC (NDAYS, CURDATE, 0);

   6970  7 000040   000002 236000 8                  LDQ     2
         7 000041   200020 756100                    STQ     NEW_PRMT$+4,,AUTO
         7 000042   000003 236000 8                  LDQ     3
         7 000043   200017 756100                    STQ     NEW_PRMT$+3,,AUTO
         7 000044   200005 630500                    EPPR0   NDAYS,,AUTO
         7 000045   200016 450500                    STP0    NEW_PRMT$+2,,AUTO
         7 000046   200016 630500                    EPPR0   NEW_PRMT$+2,,AUTO
         7 000047   000021 631400 xsym               EPPR1   B_VECTNIL+17
         7 000050   000000 701000 xent               TSX1    XUD$UTS_DIFF_SEC
         7 000051   000000 011000                    NOP     0

      314     6971    1           NDAYS = NDAYS/86400;

   6971  7 000052   200005 236100                    LDQ     NDAYS,,AUTO
         7 000053   000001 772000                    QRL     1
         7 000054   124300 506007                    DIV     43200,DL
         7 000055   200005 756100                    STQ     NDAYS,,AUTO

      315     6972    1           CALL XUD$UTS_ADJ_25TH (TH_DEFAULT.START, 0, NDAYS*%UTS_25TH_DAY#);

   6972  7 000056   000004 402000 8                  MPY     4
         7 000057   200016 756100                    STQ     NEW_PRMT$+2,,AUTO
         7 000060   200016 630500                    EPPR0   NEW_PRMT$+2,,AUTO
         7 000061   200021 450500                    STP0    NEW_PRMT$+5,,AUTO
         7 000062   000002 236000 8                  LDQ     2
         7 000063   200020 756100                    STQ     NEW_PRMT$+4,,AUTO
         7 000064   000005 236000 8                  LDQ     5
         7 000065   200017 756100                    STQ     NEW_PRMT$+3,,AUTO
         7 000066   200017 630500                    EPPR0   NEW_PRMT$+3,,AUTO
         7 000067   000021 631400 xsym               EPPR1   B_VECTNIL+17
         7 000070   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         7 000071   000000 011000                    NOP     0

      316     6973    1          CALL XUD$UTS_ADJ_25TH (TH_DEFAULT.STOP, TH_DEFAULT.START, %UTS_25TH_DAY# -1)
              6973                    ;
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:49   

   6973  7 000072   000007 630400 8                  EPPR0   7
         7 000073   000021 631400 xsym               EPPR1   B_VECTNIL+17
         7 000074   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         7 000075   000000 011000                    NOP     0

      317     6974    1           TH_CONSTRAINTS = TH_DEFAULT;

   6974  7 000076   000000 100400                    MLR     fill='000'O
         7 000077   000000 000333 xsym               ADSC9   TH_DEFAULT               cn=0,n=219
         7 000100   000000 000333 xsym               ADSC9   TH_CONSTRAINTS           cn=0,n=219

      318     6975    1           TH_PROC_FLAG = %TRUE;

   6975  7 000101   400000 236003                    LDQ     -131072,DU
         7 000102   000000 756000 xsym               STQ     TH_PROC_FLAG

      319     6976    1           CALL M$MONINFO(FPT_MONINFO);

   6976  7 000103   000252 630400 5                  EPPR0   FPT_MONINFO
         7 000104   020023 713400                    CLIMB   8211
         7 000105   402400 401760                    pmme    nvectors=6

      320     6977    1           TH_SITE_ID = VLR_SITEINFO.SITE_ID#;

   6977  7 000106   040000 100400                    MLR     fill='040'O
         7 000107   000210 000006 6                  ADSC9   VLR_SITEINFO+54          cn=0,n=6
         7 000110   000000 000006 xsym               ADSC9   TH_SITE_ID               cn=0,n=6

      321     6978    1           TH_SITE_NAME = VLR_SITEINFO.SITE_NAME#;

   6978  7 000111   000000 100400                    MLR     fill='000'O
         7 000112   000123 000170 6                  ADSC9   VLR_SITEINFO+1           cn=0,n=120
         7 000113   000000 000170 xsym               ADSC9   TH_SITE_NAME             cn=0,n=120

      322     6979
      323     6980    1           TH_ENDFLAG = %FALSE;
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:50   

   6980  7 000114   000000 450000 xsym               STZ     TH_ENDFLAG

      324     6981    1           REMEMBER ERR_RETURN IN TH_ERR_RETURN;

   6981  7 000115   000540 635000 7                  EAA     ERR_RETURN
         7 000116   000000 452400 xsym               STP2    TH_ERR_RETURN
         7 000117   000001 755000 xsym               STA     TH_ERR_RETURN+1

      325     6982    1             CALL XUR$DISABLE;

   6982  7 000120   000002 631400 xsym               EPPR1   B_VECTNIL+2
         7 000121   000000 701000 xent               TSX1    XUR$DISABLE
         7 000122   000000 011000                    NOP     0

      326     6983
      327     6984    1           CALL THI$INIT;

   6984  7 000123   000002 631400 xsym               EPPR1   B_VECTNIL+2
         7 000124   000000 701000 xent               TSX1    THI$INIT
         7 000125   000000 011000                    NOP     0

      328     6985
      329     6986    1             CALL XUR$ENABLE;

   6986  7 000126   000002 631400 xsym               EPPR1   B_VECTNIL+2
         7 000127   000000 701000 xent               TSX1    XUR$ENABLE
         7 000130   000000 011000                    NOP     0

      330     6987
      331     6988    1             CALL M$INT (FPT_INT);

   6988  7 000131   000246 630400 5                  EPPR0   FPT_INT
         7 000132   010002 713400                    CLIMB   4098
         7 000133   400000 401760                    pmme    nvectors=1

      332     6989                                                /* CALL COMMAND DRIVER                */
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:51   
      333     6990    2           DO WHILE(NOT TH_ENDFLAG);

   6990  7 000134   000540 710000 7                  TRA     ERR_RETURN

      334     6991    2          IF TH_CHANGE_FILE

   6991  7 000135   000000 234000 xsym               SZN     TH_CHANGE_FILE
         7 000136   000223 605000 7                  TPL     s:7019

      335     6992    3             THEN DO;

      336     6993    3               TH_OPEN_ERRLOG.V.SHARE# = %IN#;

   6993  7 000137   000044 236000 xsym               LDQ     TH_OPEN_ERRLOG+36
         7 000140   000012 376000 8                  ANQ     10
         7 000141   000020 276007                    ORQ     16,DL
         7 000142   000044 756000 xsym               STQ     TH_OPEN_ERRLOG+36

      337     6994    3               TH_OPEN_ERRLOG.NAME_ = VECTOR(TH_VLP_ERRLOGX);

   6994  7 000143   000000 236000 xsym               LDQ     TH_VLP_ERRLOGX
         7 000144   000033 772000                    QRL     27
         7 000145   000001 620006                    EAX0    1,QL
         7 000146   000000 635010                    EAA     0,X0
         7 000147   000002 771000                    ARL     2
         7 000150   000140 135007                    SBLA    96,DL
         7 000151   000013 236000 8                  LDQ     11
         7 000152   000006 757000 xsym               STAQ    TH_OPEN_ERRLOG+6

      338     6995    3               TH_OPEN_ERRLOG.ACCT_ = VECTOR(TH_VLP_ACCT);

   6995  7 000153   000014 237000 8                  LDAQ    12
         7 000154   000024 757000 xsym               STAQ    TH_OPEN_ERRLOG+20

      339     6996    3               TH_M$ERRLOG$ = DCBADDR(DCBNUM(M$ERRLOG));

   6996  7 000155   000000 236007 xsym               LDQ     M$ERRLOG,DL
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:52   
         7 000156   000016 470400 8                  LDP0    14
         7 000157   000000 471500                    LDP1    0,,PR0
         7 000160   100000 236106                    LDQ     0,QL,PR1
         7 000161   000000 756000 xsym               STQ     TH_M$ERRLOG$

      340     6997    3               CALL M$OPEN(TH_OPEN_ERRLOG) ALTRET(OPEN_ERR2);

   6997  7 000162   000000 630400 xsym               EPPR0   TH_OPEN_ERRLOG
         7 000163   450000 713400                    CLIMB   alt,open
         7 000164   410400 401760                    pmme    nvectors=18
         7 000165   000177 702000 7                  TSX2    OPEN_ERR2

      341     6998    3               CALL THG$GETREC(%ERRLOG) ALTRET(ERRLOG_FILE_ERR);

   6998  7 000166   000017 630400 8                  EPPR0   15
         7 000167   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 000170   000000 701000 xent               TSX1    THG$GETREC
         7 000171   000212 702000 7                  TSX2    ERRLOG_FILE_ERR

      342     6999    3               CALL M$CLOSE(TH_CLOSE_ERRLOG);

   6999  7 000172   000000 630400 xsym               EPPR0   TH_CLOSE_ERRLOG
         7 000173   050001 713400                    CLIMB   close
         7 000174   406000 401760                    pmme    nvectors=13

      343     7000    3               TH_CHANGE_FILE = '0'B;

   7000  7 000175   000000 450000 xsym               STZ     TH_CHANGE_FILE

      344     7001    4               DO NEVER;

   7001  7 000176   000211 710000 7                  TRA     s:7009

      345     7002    4   OPEN_ERR2:
      346     7003    4                 CALL THM$ERRMSG;

   7003  7 000177   000002 631400 xsym  OPEN_ERR2    EPPR1   B_VECTNIL+2
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:53   
         7 000200   000000 701000 xent               TSX1    THM$ERRMSG
         7 000201   000000 011000                    NOP     0

      347     7004    4                 TH_OPEN_ERRLOG.ACCT_ = VECTOR(VLP_SYSTAC);

   7004  7 000202   000020 237000 8                  LDAQ    16
         7 000203   000024 757000 xsym               STAQ    TH_OPEN_ERRLOG+20

      348     7005    4                 TH_OPEN_ERRLOG.NAME_ = VECTOR(TH_VLP_ERRLOG);

   7005  7 000204   000022 237000 8                  LDAQ    18
         7 000205   000006 757000 xsym               STAQ    TH_OPEN_ERRLOG+6

      349     7006    4                 TH_CHANGE_ACCOUNT = '1'B;

   7006  7 000206   400000 236003                    LDQ     -131072,DU
         7 000207   000000 756000 xsym               STQ     TH_CHANGE_ACCOUNT

      350     7007    4                 TH_CHANGE_FILE = '0'B;

   7007  7 000210   000000 450000 xsym               STZ     TH_CHANGE_FILE

      351     7008    4               END;

      352     7009    4               DO NEVER;

   7009  7 000211   000223 710000 7                  TRA     s:7019

      353     7010    4   ERRLOG_FILE_ERR:
      354     7011    4                 CALL THM$ERRMSG(%E$TH_BAD_ERRLOG_FILE);

   7011  7 000212   000025 630400 8     ERRLOG_FILE* EPPR0   21
         7 000213   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 000214   000000 701000 xent               TSX1    THM$ERRMSG
         7 000215   000000 011000                    NOP     0

      355     7012                      /*E*  ERROR:  THE-E$TH_BAD_ERRLOG_FILE-0
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:54   
      356     7013                            MESSAGE:  Bad errlog file. Unable to process. */
      357     7014    4                 TH_OPEN_ERRLOG.ACCT_ = VECTOR(VLP_SYSTAC);

   7014  7 000216   000020 237000 8                  LDAQ    16
         7 000217   000024 757000 xsym               STAQ    TH_OPEN_ERRLOG+20

      358     7015    4                 TH_CHANGE_ACCOUNT = '1'B;

   7015  7 000220   400000 236003                    LDQ     -131072,DU
         7 000221   000000 756000 xsym               STQ     TH_CHANGE_ACCOUNT

      359     7016    4                 TH_CHANGE_FILE = '0'B;

   7016  7 000222   000000 450000 xsym               STZ     TH_CHANGE_FILE

      360     7017    4               END;

      361     7018    3             END;

      362     7019    2           IF TH_CHANGE_ACCOUNT

   7019  7 000223   000000 234000 xsym               SZN     TH_CHANGE_ACCOUNT
         7 000224   000374 605000 7                  TPL     s:7059

      363     7020    3            THEN DO;

      364     7021    3           CALL M$TIME(ANS_DATE);

   7021  7 000225   000044 630400 5                  EPPR0   ANS_DATE
         7 000226   020004 713400                    CLIMB   8196
         7 000227   402000 401760                    pmme    nvectors=5

      365     7022    3           IF ASCBIN(SUBSTR(ANSDATE,0,1)) < 55 THEN /* less than 7 ? */

   7022  7 000230   000220 236000 6                  LDQ     ANSDATE
         7 000231   000033 772000                    QRL     27
         7 000232   000067 116007                    CMPQ    55,DL
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:55   
         7 000233   000242 603000 7                  TRC     s:7025

      366     7023    3            CALL CONCAT(TEMP_DATE,'20',ANSDATE);

   7023  7 000234   000270 220000 5                  LDX0    PRMT+2
         7 000235   200003 740100                    STX0    TEMP_DATE,,AUTO
         7 000236   040100 100400                    MLR     fill='040'O
         7 000237   000220 000006 6                  ADSC9   ANSDATE                  cn=0,n=6
         7 000240   200003 400006                    ADSC9   TEMP_DATE,,AUTO          cn=2,n=6
         7 000241   000247 710000 7                  TRA     s:7026

      367     7024    3           ELSE
      368     7025    3            CALL CONCAT(TEMP_DATE,'19',ANSDATE);

   7025  7 000242   000271 220000 5                  LDX0    PRMT+3
         7 000243   200003 740100                    STX0    TEMP_DATE,,AUTO
         7 000244   040100 100400                    MLR     fill='040'O
         7 000245   000220 000006 6                  ADSC9   ANSDATE                  cn=0,n=6
         7 000246   200003 400006                    ADSC9   TEMP_DATE,,AUTO          cn=2,n=6

      369     7026    3           CALL CONCAT(NAMEBUF,':ERRLOG',TEMP_DATE);

   7026  7 000247   040100 100400                    MLR     fill='040'O
         7 000250   000272 000007 5                  ADSC9   PRMT+4                   cn=0,n=7
         7 000251   200006 000007                    ADSC9   NAMEBUF,,AUTO            cn=0,n=7
         7 000252   040100 100500                    MLR     fill='040'O
         7 000253   200003 000010                    ADSC9   TEMP_DATE,,AUTO          cn=0,n=8
         7 000254   200007 600010                    ADSC9   NAMEBUF+1,,AUTO          cn=3,n=8

      370     7027    3           TH_OPEN_ERRLOG.V.SHARE# = %ALL#;

   7027  7 000255   000044 236000 xsym               LDQ     TH_OPEN_ERRLOG+36
         7 000256   000012 376000 8                  ANQ     10
         7 000257   000010 276007                    ORQ     8,DL
         7 000260   000044 756000 xsym               STQ     TH_OPEN_ERRLOG+36

      371     7028    3           TH_VLP_ERRLOG.NAME# = NAMEBUF;
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:56   

   7028  7 000261   040000 100500                    MLR     fill='040'O
         7 000262   200006 000017                    ADSC9   NAMEBUF,,AUTO            cn=0,n=15
         7 000263   000000 200017 xsym               ADSC9   TH_VLP_ERRLOG            cn=1,n=15

      372     7029    3           TH_M$ERRLOG$ = DCBADDR(DCBNUM(M$ERRLOG));

   7029  7 000264   000000 236007 xsym               LDQ     M$ERRLOG,DL
         7 000265   000016 470400 8                  LDP0    14
         7 000266   000000 471500                    LDP1    0,,PR0
         7 000267   100000 236106                    LDQ     0,QL,PR1
         7 000270   000000 756000 xsym               STQ     TH_M$ERRLOG$

      373     7030    3           CALL M$OPEN(TH_OPEN_ERRLOG) ALTRET(OPEN_ERR);

   7030  7 000271   000000 630400 xsym               EPPR0   TH_OPEN_ERRLOG
         7 000272   450000 713400                    CLIMB   alt,open
         7 000273   410400 401760                    pmme    nvectors=18
         7 000274   000276 702000 7                  TSX2    OPEN_ERR

      374     7031    4           DO NEVER;                       /* OPEN ERROR HANDLING                */

   7031  7 000275   000301 710000 7                  TRA     s:7037

      375     7032    4   OPEN_ERR:  CALL THM$ERRMSG;

   7032  7 000276   000002 631400 xsym  OPEN_ERR     EPPR1   B_VECTNIL+2
         7 000277   000000 701000 xent               TSX1    THM$ERRMSG
         7 000300   000000 011000                    NOP     0

      376     7033                   /*E* ERROR: THE-E$TH_ERRLOG_NOT_EXIST-0
      377     7034                        MESSAGE: The errlog doesn't exist.
      378     7035                   */
      379     7036    4           END;                            /* DO NEVER                           */

      380     7037    3           CALL M$CLOSE(TH_CLOSE_ERRLOG);

PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:57   
   7037  7 000301   000000 630400 xsym               EPPR0   TH_CLOSE_ERRLOG
         7 000302   050001 713400                    CLIMB   close
         7 000303   406000 401760                    pmme    nvectors=13

      381     7038
      382     7039                                                /* LOOK FOR FIRST AVAIL. :ERRLOG FILE */
      383     7040    3           CALL M$OPEN(FIND_FIRST) ALTRET(NO_ERRLOG_FILES);

   7040  7 000304   000060 630400 5                  EPPR0   FIND_FIRST
         7 000305   450000 713400                    CLIMB   alt,open
         7 000306   410400 401760                    pmme    nvectors=18
         7 000307   000370 702000 7                  TSX2    NO_ERRLOG_FILES

      384     7041    3           IF TH_M$ERRLOG$->F$DCB.NAME.L ~= LENGTHC( ':ERRLOGyyyymmdd' )

   7041  7 000310   000000 470400 xsym               LDP0    TH_M$ERRLOG$
         7 000311   000010 236100                    LDQ     8,,PR0
         7 000312   777000 376003                    ANQ     -512,DU
         7 000313   017000 116003                    CMPQ    7680,DU
         7 000314   000370 601000 7                  TNZ     NO_ERRLOG_FILES

      385     7042    3            THEN GOTO NO_ERRLOG_FILES;
      386     7043    3           NAMEBUF = TH_M$ERRLOG$->F$DCB.NAME.C;

   7043  7 000315   040100 100500                    MLR     fill='040'O
         7 000316   000010 200017                    ADSC9   8,,PR0                   cn=1,n=15
         7 000317   200006 000017                    ADSC9   NAMEBUF,,AUTO            cn=0,n=15

      387     7044    3           IF SUBSTR(NAMEBUF,0,7) ~= ':ERRLOG' THEN GOTO NO_ERRLOG_FILES;

   7044  7 000320   040000 106500                    CMPC    fill='040'O
         7 000321   200006 000007                    ADSC9   NAMEBUF,,AUTO            cn=0,n=7
         7 000322   000272 000007 5                  ADSC9   PRMT+4                   cn=0,n=7
         7 000323   000370 601000 7                  TNZ     NO_ERRLOG_FILES

      388     7045    3           FIRST_DATE = SUBSTR(NAMEBUF,9,6);

PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:58   
   7045  7 000324   040000 100500                    MLR     fill='040'O
         7 000325   200010 200006                    ADSC9   NAMEBUF+2,,AUTO          cn=1,n=6
         7 000326   000223 000006 6                  ADSC9   FIRST_DATE               cn=0,n=6

      389     7046    3           FIRST_ERRLG.DATE_ = VECTOR(FIRST_DATE);

   7046  7 000327   000026 237000 8                  LDAQ    22
         7 000330   000016 757000 6                  STAQ    FIRST_ERRLG+2

      390     7047    3           CALL M$TIME(FIRST_ERRLG) ALTRET(NO_ERRLOG_FILES);

   7047  7 000331   000014 630400 6                  EPPR0   FIRST_ERRLG
         7 000332   420004 713400                    CLIMB   alt,+8196
         7 000333   402000 401760                    pmme    nvectors=5
         7 000334   000370 702000 7                  TSX2    NO_ERRLOG_FILES

      391     7048    3          CALL THW$WRITE(HI_VEC,VECTOR(ADDR(B_VERSION)->B$VERSIONB.T_),VECTOR(NAMEBUF)
              7048                    );

   7048  7 000335   000000 236000 xsym               LDQ     B_VERSION
         7 000336   000033 772000                    QRL     27
         7 000337   000064 737000                    LLS     52
         7 000340   000140 135007                    SBLA    96,DL
         7 000341   000030 236000 8                  LDQ     24
         7 000342   200016 757100                    STAQ    NEW_PRMT$+2,,AUTO
         7 000343   000031 235000 8                  LDA     25
         7 000344   200020 452500                    STP2    NEW_PRMT$+4,,AUTO
         7 000345   200020 236100                    LDQ     NEW_PRMT$+4,,AUTO
         7 000346   000006 036003                    ADLQ    6,DU
         7 000347   200024 757100                    STAQ    NEW_PRMT$+8,,AUTO
         7 000350   200016 237100                    LDAQ    NEW_PRMT$+2,,AUTO
         7 000351   200022 757100                    STAQ    NEW_PRMT$+6,,AUTO
         7 000352   200024 237100                    LDAQ    NEW_PRMT$+8,,AUTO
         7 000353   200026 757100                    STAQ    NEW_PRMT$+10,,AUTO
         7 000354   200026 630500                    EPPR0   NEW_PRMT$+10,,AUTO
         7 000355   200032 450500                    STP0    NEW_PRMT$+14,,AUTO
         7 000356   200022 631500                    EPPR1   NEW_PRMT$+6,,AUTO
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:59   
         7 000357   200031 451500                    STP1    NEW_PRMT$+13,,AUTO
         7 000360   000032 236000 8                  LDQ     26
         7 000361   200030 756100                    STQ     NEW_PRMT$+12,,AUTO
         7 000362   200030 630500                    EPPR0   NEW_PRMT$+12,,AUTO
         7 000363   000021 631400 xsym               EPPR1   B_VECTNIL+17
         7 000364   000000 701000 xent               TSX1    THW$WRITE
         7 000365   000000 011000                    NOP     0

      392     7049    3               TH_CHANGE_ACCOUNT = '0'B;

   7049  7 000366   000000 450000 xsym               STZ     TH_CHANGE_ACCOUNT

      393     7050
      394     7051    4            DO NEVER;

   7051  7 000367   000374 710000 7                  TRA     s:7059

   7048  7 000370                       NO_ERRLOG_F* null
      395     7052    4   NO_ERRLOG_FILES: ;
      396     7053    4               CALL THM$ERRMSG( %E$TH_NO_ERRLOG_FILES );

   7053  7 000370   000034 630400 8                  EPPR0   28
         7 000371   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 000372   000000 701000 xent               TSX1    THM$ERRMSG
         7 000373   000000 011000                    NOP     0

      397     7054                    /*E* ERROR: THE-E$TH_NO_ERRLOG_FILES-0
      398     7055                         MESSAGE: The USE account contains no :ERRLOG files
      399     7056                    */
      400     7057    4               END;

      401     7058    3           END;

      402     7059    2          IF TH_PRMT_FLAG

   7059  7 000374   000000 234000 xsym               SZN     TH_PRMT_FLAG
         7 000375   000421 605000 7                  TPL     s:7067
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:60   

      403     7060    3            THEN DO;

      404     7061    3                NEW_PRMT$ = ADDR(TH_PRMT);

   7061  7 000376   000035 236000 8                  LDQ     29
         7 000377   200014 756100                    STQ     NEW_PRMT$,,AUTO

      405     7062    3                USER_PRMT.PROMPT_ = VECTOR(NEW_PRMT$->PRMT_NEW$);

   7062  7 000400   000000 235000 xsym               LDA     TH_PRMT_SIZE
         7 000401   000020 735000                    ALS     16
         7 000402   000140 135007                    SBLA    96,DL
         7 000403   000340 757000 6                  STAQ    USER_PRMT+4

      406     7063    3                CALL M$PROMPT(USER_PRMT) ALTRET(PARSE_ERR);

   7063  7 000404   000334 630400 6                  EPPR0   USER_PRMT
         7 000405   560002 713400                    CLIMB   alt,+57346
         7 000406   401000 401760                    pmme    nvectors=3
         7 000407   000445 702000 7                  TSX2    PARSE_ERR

      407     7064    3                CALL XUR$GETCMD(TH_CMD,TOP$) ALTRET(PARSE_ERR);

   7064  7 000410   200013 630500                    EPPR0   TOP$,,AUTO
         7 000411   200017 450500                    STP0    NEW_PRMT$+3,,AUTO
         7 000412   000036 236000 8                  LDQ     30
         7 000413   200016 756100                    STQ     NEW_PRMT$+2,,AUTO
         7 000414   200016 630500                    EPPR0   NEW_PRMT$+2,,AUTO
         7 000415   000020 631400 xsym               EPPR1   B_VECTNIL+16
         7 000416   000000 701000 xent               TSX1    XUR$GETCMD
         7 000417   000445 702000 7                  TSX2    PARSE_ERR

      408     7065    3                 END;

   7065  7 000420   000433 710000 7                  TRA     s:7068

PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:61   
      409     7066    2            ELSE
      410     7067    2                CALL XUR$GETCMD(TH_CMD,TOP$,VECTOR(PRMT)) ALTRET(PARSE_ERR);

   7067  7 000421   000042 236000 8                  LDQ     34
         7 000422   200020 756100                    STQ     NEW_PRMT$+4,,AUTO
         7 000423   200013 630500                    EPPR0   TOP$,,AUTO
         7 000424   200017 450500                    STP0    NEW_PRMT$+3,,AUTO
         7 000425   000036 236000 8                  LDQ     30
         7 000426   200016 756100                    STQ     NEW_PRMT$+2,,AUTO
         7 000427   200016 630500                    EPPR0   NEW_PRMT$+2,,AUTO
         7 000430   000021 631400 xsym               EPPR1   B_VECTNIL+17
         7 000431   000000 701000 xent               TSX1    XUR$GETCMD
         7 000432   000445 702000 7                  TSX2    PARSE_ERR

      411     7068    2              CALL THC$COMMANDS(TOP$);

   7068  7 000433   200013 630500                    EPPR0   TOP$,,AUTO
         7 000434   200016 450500                    STP0    NEW_PRMT$+2,,AUTO
         7 000435   200016 630500                    EPPR0   NEW_PRMT$+2,,AUTO
         7 000436   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 000437   000000 701000 xent               TSX1    THC$COMMANDS
         7 000440   000000 011000                    NOP     0

      412     7069    2              CALL THG$CLOSEXSA;

   7069  7 000441   000002 631400 xsym               EPPR1   B_VECTNIL+2
         7 000442   000000 701000 xent               TSX1    THG$CLOSEXSA
         7 000443   000000 011000                    NOP     0

      413     7070    3              DO NEVER;                    /* PARSE ERROR HANDLING               */

   7070  7 000444   000540 710000 7                  TRA     ERR_RETURN

      414     7071    3   PARSE_ERR:    TH_ERRCODE = PARSE_CODE;

   7071  7 000445   200013 236100       PARSE_ERR    LDQ     TOP$,,AUTO
         7 000446   000000 756000 xsym               STQ     TH_ERRCODE
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:62   

      415     7072    3                 IF NOT TH_ERRCODE.MON

   7072  7 000447   400000 316007                    CANQ    -131072,DL
         7 000450   000454 601000 7                  TNZ     s:7074

      416     7073    3                    THEN TH_CPOS = P_PCB.HI_CHAR;

   7073  7 000451   000012 235000 xsym               LDA     P_PCB+10
         7 000452   000000 755000 xsym               STA     TH_CPOS
         7 000453   000456 710000 7                  TRA     s:7075

      417     7074    3                    ELSE TH_ENDFLAG = %TRUE;

   7074  7 000454   400000 236003                    LDQ     -131072,DU
         7 000455   000000 756000 xsym               STQ     TH_ENDFLAG

      418     7075    3                 IF TH_ERRCODE.FCG = '302522'O  /* 'XUR' */ AND TH_ERRCODE.CODE = 1

   7075  7 000456   000000 220000 xsym               LDX0    TH_ERRCODE
         7 000457   302522 100003                    CMPX0   99666,DU
         7 000460   000502 601000 7                  TNZ     s:7090
         7 000461   000000 236000 xsym               LDQ     TH_ERRCODE
         7 000462   377770 376007                    ANQ     131064,DL
         7 000463   000010 116007                    CMPQ    8,DL
         7 000464   000502 601000 7                  TNZ     s:7090

      419     7076    3                    THEN
      420     7077    4                    DO;

      421     7078    4                       TH_ERRCODE = '241005000000'O;

   7078  7 000465   000300 236000 5                  LDQ     PRMT+10
         7 000466   000000 756000 xsym               STQ     TH_ERRCODE

      422     7079    4                       IF TH_CPOS = 0

PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:63   
   7079  7 000467   000000 235000 xsym               LDA     TH_CPOS
         7 000470   000477 601000 7                  TNZ     s:7087

      423     7080    4                          THEN
      424     7081    5                          DO;

      425     7082    5                             TH_ERRCODE.CODE = %E$TH_CMDERR;

   7082  7 000471   000043 376000 8                  ANQ     35
         7 000472   017520 276007                    ORQ     8016,DL
         7 000473   000000 756000 xsym               STQ     TH_ERRCODE

      426     7083    5                             TH_CPOS = -1;

   7083  7 000474   000001 335007                    LCA     1,DL
         7 000475   000000 755000 xsym               STA     TH_CPOS

      427     7084    5                          END;

   7084  7 000476   000502 710000 7                  TRA     s:7090

      428     7085    4                          ELSE
      429     7086    5                          DO;

      430     7087    5                             TH_ERRCODE.CODE = %E$TH_SYNTAX;

   7087  7 000477   000043 376000 8                  ANQ     35
         7 000500   017530 276007                    ORQ     8024,DL
         7 000501   000000 756000 xsym               STQ     TH_ERRCODE

      431     7088    5                          END;

      432     7089    4                    END;                   /* IF FCG = 'XUP' AND CODE = 1        */

      433     7090    3                 IF TH_CPOS >= 0 THEN CALL XUR$ERRPTR(TH_CPOS,DCBNUM(M$DO));

   7090  7 000502   000000 235000 xsym               LDA     TH_CPOS
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:64   
         7 000503   000516 604000 7                  TMI     s:7091

   7090  7 000504   000000 236007 xsym               LDQ     M$DO,DL
         7 000505   200016 756100                    STQ     NEW_PRMT$+2,,AUTO
         7 000506   200016 630500                    EPPR0   NEW_PRMT$+2,,AUTO
         7 000507   200021 450500                    STP0    NEW_PRMT$+5,,AUTO
         7 000510   000044 236000 8                  LDQ     36
         7 000511   200020 756100                    STQ     NEW_PRMT$+4,,AUTO
         7 000512   200020 630500                    EPPR0   NEW_PRMT$+4,,AUTO
         7 000513   000020 631400 xsym               EPPR1   B_VECTNIL+16
         7 000514   000000 701000 xent               TSX1    XUR$ERRPTR
         7 000515   000000 011000                    NOP     0

      434     7091    3                 TH_CPOS = -1;

   7091  7 000516   000001 335007                    LCA     1,DL
         7 000517   000000 755000 xsym               STA     TH_CPOS

      435     7092    3                 CALL XUR$ERRMSG(TH_ERRCODE,DCBNUM(M$SI),DCBNUM(M$DO));

   7092  7 000520   000000 236007 xsym               LDQ     M$SI,DL
         7 000521   200016 756100                    STQ     NEW_PRMT$+2,,AUTO
         7 000522   000000 236007 xsym               LDQ     M$DO,DL
         7 000523   200016 235100                    LDA     NEW_PRMT$+2,,AUTO
         7 000524   200017 755100                    STA     NEW_PRMT$+3,,AUTO
         7 000525   200020 756100                    STQ     NEW_PRMT$+4,,AUTO
         7 000526   200020 630500                    EPPR0   NEW_PRMT$+4,,AUTO
         7 000527   200023 450500                    STP0    NEW_PRMT$+7,,AUTO
         7 000530   200017 631500                    EPPR1   NEW_PRMT$+3,,AUTO
         7 000531   200022 451500                    STP1    NEW_PRMT$+6,,AUTO
         7 000532   000045 236000 8                  LDQ     37
         7 000533   200021 756100                    STQ     NEW_PRMT$+5,,AUTO
         7 000534   200021 630500                    EPPR0   NEW_PRMT$+5,,AUTO
         7 000535   000021 631400 xsym               EPPR1   B_VECTNIL+17
         7 000536   000000 701000 xent               TSX1    XUR$ERRMSG
         7 000537   000000 011000                    NOP     0

PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:65   
      436     7093    3   ERR_RETURN:
      437     7094    3              END;                         /* DO NEVER                           */

   7094  7 000540                       ERR_RETURN   null
      438     7095    2           END;                            /* DO WHILE NOT TH_ENDFLAG            */

   7095  7 000540   000000 234000 xsym               SZN     TH_ENDFLAG
         7 000541   000135 605000 7                  TPL     s:6991

      439     7096    1        RETURN;

   7096  7 000542   000000 702200 xent               TSX2  ! X66_ARET
      440     7097             /*E* ERROR: THE-E$TH_NO_WORK_SPACE-0
      441     7098                  MESSAGE: Unable to get necessary memory - ELAN aborts
      442     7099             */
      443     7100        /*E* ERROR: THE-E$TH_SYNTAX-0
      444     7101             MESSAGE: Syntax error      */
      445     7102        /*E* ERROR: THE-E$TH_CMDERR-0
      446     7103             MESSAGE: Eh?
      447     7104             MESSAGE1: Unknown command.
      448     7105        */
      449     7106        %EJECT;
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:66   
      450     7107    1   END THE$REPORT;
      451     7108        %EOD;

PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:67   
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   TH_PERR_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THE$REPORT.
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:68   

 **** Variables and constants ****

  ****  Section 005 RoData THE$REPORT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    44-0-0/d STRC(432)   r     1 ANS_DATE                 204-0-0/d STRC(1080)  r     1 CLOSE_LO
    30-0-0/d STRC(432)   r     1 CUR_DATE                 170-0-0/d STRC(432)   r     1 ECHO_FPT
   242-0-0/c STRC(144)   r     1 ERRLOG                    60-0-0/d STRC(2088)  r     1 FIND_FIRST
   246-0-0/d STRC(144)   r     1 FPT_INT                  252-0-0/d STRC(432)   r     1 FPT_MONINFO
    10-0-0/d STRC(144)   r     1 FPT_PRIV                  14-0-0/d STRC(432)   r     1 LOCAL
   266-0-0/c CHAR(5)     r     1 PRMT                     152-0-0/d STRC(504)   r     1 READ_CMD
     0-0-0/d STRC(144)   r     1 SET_PRIV                   4-0-0/d STRC(144)   r     1 TEST_PRIV

  ****  Section 006  Data  THE$REPORT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   220-0-0/c CHAR(6)     r     1 ANSDATE                  233-0-0/c CHAR(256)   r     1 CMD_BUF
   222-0-0/w UBIN        r     1 CURDATE                    0-0-0/d STRC(432)   r     1 CUR_TIME
   231-0-0/c CHAR(8)     r     1 DBUF                     223-0-0/c CHAR(6)     r     1 FIRST_DATE
    14-0-0/d STRC(432)   r     1 FIRST_ERRLG              346-0-0/c CHAR(50)    r     1 HI_FMT
   364-0-0/d BIT (72)    r     1 HI_VEC                    30-0-0/d STRC(2088)  r     1 OPEN_LO
   227-0-0/c CHAR(5)     r     1 TBUF                     225-0-0/c CHAR(8)     r     1 TIME_BUF
   334-0-0/d STRC(360)   r     1 USER_PRMT                122-0-0/d STRC(2232)  r     1 VLR_SITEINFO

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/c CHAR(15)    r     1 NAMEBUF                    5-0-0/w UBIN        r     1 NDAYS
    14-0-0/w PTR         r     1 NEW_PRMT$                 13-0-0/w BIT         r     1 PARSE_CODE
     3-0-0/c CHAR(8)     r     1 TEMP_DATE                 13-0-0/w PTR         r     1 TOP$

PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:69   
  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/c CHAR        r     1 B_VERSION
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/b BIT         r     1 TH_CHANGE_ACCOUNT
     0-0-0/b BIT         r     1 TH_CHANGE_FILE             0-0-0/d STRC(1080)  r     1 TH_CLOSE_ERRLOG
     0-0-0/w SBIN        r     1 TH_CMD                     0-0-0/d STRC(1971)  r     1 TH_CONSTRAINTS
     0-0-0/w SBIN        r     1 TH_CPOS                    0-0-0/w UBIN        r     1 TH_CURDATE
     0-0-0/c CHAR(10)    r     1 TH_DATE                    0-0-0/d STRC(1971)  r     1 TH_DEFAULT
     0-0-0/b BIT         r     1 TH_ENDFLAG                 0-0-0/w STRC        r     1 TH_ERRCODE
     0-0-0/d REMB        r     1 TH_ERR_RETURN              0-0-0/w UBIN        r     1 TH_FIRST_ERRLG
     0-0-0/w PTR         r     1 TH_M$ERRLOG$               0-0-0/d STRC(2088)  r     1 TH_OPEN_ERRLOG
     0-0-0/c STRC(279)   r     1 TH_PRMT                    0-0-0/b BIT         r     1 TH_PRMT_FLAG
     0-0-0/w UBIN        r     1 TH_PRMT_SIZE               0-0-0/b BIT         r     1 TH_PROC_FLAG
     0-0-0/w CHAR(6)     r     1 TH_SITE_ID                 0-0-0/w STRC(1080)  r     1 TH_SITE_NAME
     0-0-0/c CHAR(11)    r     1 TH_TIME                    0-0-0/c STRC(72)    r     1 TH_VLP_ACCT
     0-0-0/c STRC(144)   r     1 TH_VLP_ERRLOG              0-0-0/c ASTR(9)     r     1 TH_VLP_ERRLOGX
     0-0-0/c STRC(72)    r     1 VLP_SYSTAC

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ASTR(9)     r     1 B$VERSIONB                 0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 M$DO                       0-0-0N  NULL        r     1 M$ERRLOG
     0-0-0N  NULL        r     1 M$LO                       0-0-0N  NULL        r     1 M$SI
     0-0-0N  NULL        r     1 M$UC                       0-0-0/c ASTR(0)     r     1 PRMT_NEW$


   Procedure THE$REPORT requires 355 words for executable code.
   Procedure THE$REPORT requires 28 words of local(AUTO) storage.
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:70   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:71   
          MINI XREF LISTING

ANSDATE
      6639**DCL      5950--DCLINIT  5951--DCLINIT  7022>>IF       7023>>CALLBLT  7025>>CALLBLT
ANS_DATE
      5950**DCL      7021<>CALL
ANS_DATE.V
      5954**DCL      5950--DCLINIT
B$ALT.CODE
      6899**DCL      6899--REDEF    6900--REDEF    6900--REDEF
B$ALT.ERR.ERR#
      6901**DCL      6901--REDEF
B$ALT.EVID
      6900**DCL      6900--REDEF    6900--REDEF
B$JIT.CPFLAGS1.SLEAZE
       199**DCL       199--REDEF
B$JIT.ERR.MID
       106**DCL       106--REDEF
B$JIT.JRESPEAK
       267**DCL       268--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
       376**DCL       376--REDEF     377--REDEF
B$JIT.PNR
       280**DCL       280--REDEF
B$JIT.TSLINE
       374**DCL       375--REDEF
B$JIT$
      5788**DCL       100--IMP-PTR
B$VERSIONB.C_
      6691**DCL      6692--IMP-SIZ  7048>>CALL
B$VERSIONB.T_
      6692**DCL      7048--CALL
BADPRIV
      6953**LABEL    6965--GOTO
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:72   
B_VERSION
      6689**DCL      7048--CALL     7048--CALL
CLOSE_LO.SN_
      6424**DCL      6424--REDEF
CLOSE_LO.UTL_
      6425**DCL      6425--REDEF
CLOSE_LO.V
      6429**DCL      6424--DCLINIT
CLOSE_LO.V.EXPIRE#
      6439**DCL      6439--REDEF
CLOSE_LO.V.TYPE#
      6437**DCL      6437--REDEF
CLOSE_LO.V.XTNSIZE#
      6434**DCL      6434--REDEF    6436--REDEF
CMD_BUF
      6652**DCL      6345--DCLINIT  6346--DCLINIT  6386--DCLINIT  6387--DCLINIT
CURDATE
      6641**DCL      5906--DCLINIT  5930--DCLINIT  5954--DCLINIT  6969>>ASSIGN   6970<>CALL
CUR_DATE
      5902**DCL      6967<>CALL
CUR_DATE.V
      5906**DCL      5902--DCLINIT
CUR_TIME
      5926**DCL      6968<>CALL
CUR_TIME.V
      5930**DCL      5926--DCLINIT
DBUF
      6647**DCL      5879--DCLINIT  5880--DCLINIT
ECHO_FPT.STATION_
      6387**DCL      6387--REDEF
ECHO_FPT.V
      6388**DCL      6385--DCLINIT
ECHO_FPT.V.DVBYTE.VFC#
      6394**DCL      6394--REDEF
ERRLOG
      6584**DCL      6280--DCLINIT
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:73   
ERRLOG_FILE_ERR
      7011**LABEL    6998--CALLALT
ERR_RETURN
      7094**LABEL    6981--REMEMBR
F$DCB.ACTPOS
      3513**DCL      3513--REDEF
F$DCB.ARS
      3488**DCL      3488--REDEF
F$DCB.ATTR
      3506**DCL      3507--REDEF
F$DCB.BORROW
      3521**DCL      3521--REDEF    3521--REDEF    3521--REDEF
F$DCB.DCBNAME.L
      3535**DCL      3535--IMP-SIZ
F$DCB.EOMCHAR
      3492**DCL      3492--REDEF
F$DCB.FLDID
      3516**DCL      3516--REDEF
F$DCB.FORM$
      3510**DCL      3510--REDEF
F$DCB.FSECT
      3526**DCL      3526--REDEF
F$DCB.FSN
      3503**DCL      3503--REDEF    3503--REDEF    3504--REDEF
F$DCB.HEADER$
      3509**DCL      3509--REDEF
F$DCB.IXTNSIZE
      3507**DCL      3507--REDEF
F$DCB.LASTSTA$
      3497**DCL      3497--REDEF
F$DCB.LVL
      3522**DCL      3522--REDEF
F$DCB.NAME.C
      3497**DCL      3497--REDEF    7043>>ASSIGN
F$DCB.NAME.L
      3497**DCL      7041>>IF
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:74   
F$DCB.NOEOF
      3518**DCL      3518--REDEF
F$DCB.NRECS
      3508**DCL      3508--REDEF
F$DCB.NRECX
      3527**DCL      3527--REDEF
F$DCB.OHDR
      3519**DCL      3519--REDEF
F$DCB.ORG
      3502**DCL      3502--REDEF
F$DCB.PRECNO
      3525**DCL      3525--REDEF
F$DCB.RCSZ
      3530**DCL      3530--REDEF
F$DCB.RES
      3498**DCL      3498--REDEF
F$DCB.SETX
      3510**DCL      3510--REDEF
F$DCB.TAB$
      3509**DCL      3510--REDEF
F$DCB.TDA
      3524**DCL      3524--REDEF
F$DCB.WSN
      3499**DCL      3499--REDEF
FIND_FIRST
      6279**DCL      7040<>CALL
FIND_FIRST.ACSVEH_
      6281**DCL      6282--REDEF
FIND_FIRST.ALTKEYS_
      6287**DCL      6288--REDEF    6288--REDEF
FIND_FIRST.HDR_
      6286**DCL      6287--REDEF
FIND_FIRST.TAB_
      6285**DCL      6286--REDEF
FIND_FIRST.UHL_
      6279**DCL      6280--REDEF    6280--REDEF
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:75   
FIND_FIRST.V
      6288**DCL      6279--DCLINIT
FIND_FIRST.V.FSN#
      6319**DCL      6319--REDEF    6319--REDEF
FIND_FIRST.WSN_
      6285**DCL      6285--REDEF
FIRST_DATE
      6644**DCL      7045<<ASSIGN   7046--ASSIGN
FIRST_ERRLG
      5973**DCL      7047<>CALL
FIRST_ERRLG.DATE_
      5973**DCL      7046<<ASSIGN
FIRST_ERRLG.V
      5977**DCL      5973--DCLINIT
FPT_INT
      6598**DCL      6988<>CALL
FPT_INT.V
      6598**DCL      6598--DCLINIT
FPT_MONINFO
      6613**DCL      6976<>CALL
FPT_PRIV
      5859**DCL      6950<>CALL
FPT_PRIV.V
      5859**DCL      5859--DCLINIT
HI_FMT
      6686**DCL      6688--DCLINIT
HI_VEC
      6688**DCL      7048<>CALL
LOCAL.V
      5883**DCL      5879--DCLINIT
M$CLOSE
        19**DCL-ENT  6999--CALL     7037--CALL
M$DO
      5807**DCL      7090<>CALL     7092<>CALL
M$ERRLOG
      5808**DCL      6996--ASSIGN   7029--ASSIGN
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:76   
M$INT
        74**DCL-ENT  6988--CALL
M$MONINFO
        87**DCL-ENT  6976--CALL
M$OPEN
        19**DCL-ENT  6997--CALL     7030--CALL     7040--CALL
M$PROMPT
        43**DCL-ENT  7063--CALL
M$SI
      5805**DCL      7092<>CALL
M$SPRIV
        78**DCL-ENT  6950--CALL     6952--CALL     6963--CALL
M$TIME
        86**DCL-ENT  6967--CALL     6968--CALL     7021--CALL     7047--CALL
M$XXX
        31**DCL-ENT  6960--CALL
NAMEBUF
      6643**DCL      7026<<CALLBLT  7028>>ASSIGN   7043<<ASSIGN   7044>>IF       7045>>ASSIGN   7048--CALL
NDAYS
      6642**DCL      6970<>CALL     6971<<ASSIGN   6971>>ASSIGN   6972>>CALL
NEW_PRMT$
      6683**DCL      7061<<ASSIGN   7062>>ASSIGN
NO_ERRLOG_FILES
      7048**LABEL    7040--CALLALT  7042--GOTO     7044--GOTO     7047--CALLALT
OPEN_ERR
      7032**LABEL    7030--CALLALT
OPEN_ERR2
      7003**LABEL    6997--CALLALT
OPEN_LO.ACSVEH_
      6052**DCL      6053--REDEF
OPEN_LO.ALTKEYS_
      6058**DCL      6059--REDEF    6059--REDEF
OPEN_LO.HDR_
      6057**DCL      6058--REDEF
OPEN_LO.TAB_
      6056**DCL      6057--REDEF
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:77   
OPEN_LO.UHL_
      6050**DCL      6051--REDEF    6051--REDEF
OPEN_LO.V
      6059**DCL      6050--DCLINIT
OPEN_LO.V.FSN#
      6090**DCL      6090--REDEF    6090--REDEF
OPEN_LO.WSN_
      6056**DCL      6056--REDEF
PARSE_CODE
      6651**DCL      7071>>ASSIGN
PARSE_ERR
      7071**LABEL    7063--CALLALT  7064--CALLALT  7067--CALLALT
PRMT
      6653**DCL      7067--CALL
PRMT_NEW$
      6684**DCL      7062--ASSIGN
P_PCB.HI_CHAR
      6864**DCL      7073>>ASSIGN
READ_CMD.STATION_
      6346**DCL      6347--REDEF
READ_CMD.V
      6347**DCL      6343--DCLINIT
READ_CMD.V.DVBYTE.REREAD#
      6358**DCL      6358--REDEF
READ_CMD.V.INDX#
      6356**DCL      6356--REDEF
SET_PRIV
      5824**DCL      6963<>CALL
SET_PRIV.V
      5824**DCL      5824--DCLINIT
TBUF
      6646**DCL      5881--DCLINIT  5882--DCLINIT
TEMP_DATE
      6640**DCL      7023<<CALLBLT  7025<<CALLBLT  7026>>CALLBLT
TEST_PRIV
      5842**DCL      6952<>CALL
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:78   
TEST_PRIV.V
      5842**DCL      5842--DCLINIT
THC$COMMANDS
      5796**DCL-ENT  7068--CALL
THG$CLOSEXSA
      5798**DCL-ENT  7069--CALL
THG$GETREC
      5797**DCL-ENT  6998--CALL
THI$INIT
      5799**DCL-ENT  6984--CALL
THM$ERRMSG
      5802**DCL-ENT  6955--CALL     7003--CALL     7011--CALL     7032--CALL     7053--CALL
THW$WRITE
      5801**DCL-ENT  7048--CALL
TH_CHANGE_ACCOUNT
      5278**DCL      7006<<ASSIGN   7015<<ASSIGN   7019>>IF       7049<<ASSIGN
TH_CHANGE_FILE
      5278**DCL      6991>>IF       7000<<ASSIGN   7007<<ASSIGN   7016<<ASSIGN
TH_CLOSE_ERRLOG
      6467**DCL      6999<>CALL     7037<>CALL
TH_CLOSE_ERRLOG.SN_
      6467**DCL      6467--REDEF
TH_CLOSE_ERRLOG.UTL_
      6468**DCL      6468--REDEF
TH_CLOSE_ERRLOG.V.EXPIRE#
      6482**DCL      6482--REDEF
TH_CLOSE_ERRLOG.V.TYPE#
      6480**DCL      6480--REDEF
TH_CLOSE_ERRLOG.V.XTNSIZE#
      6477**DCL      6477--REDEF    6479--REDEF
TH_CMD
      6649**DCL      7064<>CALL     7067<>CALL
TH_CONSTRAINTS
      5211**DCL      6974<<ASSIGN
TH_CONSTRAINTS.E_BY_B
      5214**DCL      5214--REDEF
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:79   
TH_CONSTRAINTS.M_BY_B
      5213**DCL      5213--REDEF
TH_CONSTRAINTS.TYPES
      5211**DCL      5211--REDEF
TH_CPOS
      5235**DCL      7073<<ASSIGN   7079>>IF       7083<<ASSIGN   7090>>IF       7090<>CALL     7091<<ASSIGN
TH_CURDATE
      5238**DCL      6969<<ASSIGN
TH_DATE
      5242**DCL      5926--DCLINIT  5927--DCLINIT
TH_DEFAULT
      5218**DCL      6974>>ASSIGN
TH_DEFAULT.E_BY_B
      5222**DCL      5222--REDEF
TH_DEFAULT.M_BY_B
      5221**DCL      5221--REDEF
TH_DEFAULT.START
      5219**DCL      6972<>CALL     6973<>CALL
TH_DEFAULT.STOP
      5220**DCL      6973<>CALL
TH_DEFAULT.TYPES
      5219**DCL      5219--REDEF
TH_ENDFLAG
      5235**DCL      6980<<ASSIGN   6990>>DOWHILE  7074<<ASSIGN
TH_ERRCODE
      5234**DCL      7071<<ASSIGN   7078<<ASSIGN   7092<>CALL
TH_ERRCODE.CODE
      5235**DCL      7075>>IF       7082<<ASSIGN   7087<<ASSIGN
TH_ERRCODE.FCG
      5234**DCL      7075>>IF
TH_ERRCODE.MON
      5234**DCL      7072>>IF
TH_ERR_RETURN
      5234**DCL      6981<<REMEMBR
TH_FIRST_ERRLG
      5238**DCL      5977--DCLINIT
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:80   
TH_M$ERRLOG$
      5249**DCL      6996<<ASSIGN   7029<<ASSIGN   7041>>IF       7043>>ASSIGN
TH_OPEN_ERRLOG
      6160**DCL      6997<>CALL     7030<>CALL
TH_OPEN_ERRLOG.ACCT_
      6164**DCL      6995<<ASSIGN   7004<<ASSIGN   7014<<ASSIGN
TH_OPEN_ERRLOG.ACSVEH_
      6162**DCL      6163--REDEF
TH_OPEN_ERRLOG.ALTKEYS_
      6168**DCL      6169--REDEF    6169--REDEF
TH_OPEN_ERRLOG.HDR_
      6167**DCL      6168--REDEF
TH_OPEN_ERRLOG.NAME_
      6161**DCL      6994<<ASSIGN   7005<<ASSIGN
TH_OPEN_ERRLOG.TAB_
      6166**DCL      6167--REDEF
TH_OPEN_ERRLOG.UHL_
      6160**DCL      6161--REDEF    6161--REDEF
TH_OPEN_ERRLOG.V.FSN#
      6200**DCL      6200--REDEF    6200--REDEF
TH_OPEN_ERRLOG.V.SHARE#
      6174**DCL      6993<<ASSIGN   7027<<ASSIGN
TH_OPEN_ERRLOG.WSN_
      6166**DCL      6166--REDEF
TH_PRMT
      5278**DCL      7061--ASSIGN
TH_PRMT_FLAG
      5278**DCL      7059>>IF
TH_PRMT_SIZE
      5279**DCL      6685--IMP-SIZ  7062>>ASSIGN
TH_PROC_FLAG
      5245**DCL      6975<<ASSIGN
TH_SAVE.E_BY_B
      5230**DCL      5230--REDEF
TH_SAVE.M_BY_B
      5228**DCL      5228--REDEF
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:81   
TH_SAVE.TYPES
      5226**DCL      5227--REDEF
TH_SITE_ID
      5242**DCL      6977<<ASSIGN
TH_SITE_NAME
      5243**DCL      6978<<ASSIGN
TH_TIME
      5242**DCL      5928--DCLINIT  5929--DCLINIT
TH_VLP_ACCT
      6526**DCL      6995--ASSIGN
TH_VLP_ERRLOG
      6555**DCL      7005--ASSIGN
TH_VLP_ERRLOG.NAME#
      6555**DCL      7028<<ASSIGN
TH_VLP_ERRLOGX
      6512**DCL      6994--ASSIGN
TH_VLP_ERRLOGX.L#
      6512**DCL      6512--IMP-SIZ  6994>>ASSIGN
TH_XSA_BUF_VECTOR
      5246**DCL      5246--REDEF
TIME_BUF
      6645**DCL      5975--DCLINIT  5976--DCLINIT
TOP$
      6650**DCL      6651--REDEF    7064<>CALL     7067<>CALL     7068<>CALL
USER_PRMT
      6671**DCL      7063<>CALL
USER_PRMT.PROMPT_
      6677**DCL      7062<<ASSIGN
USER_PRMT.V
      6679**DCL      6673--DCLINIT
VLP_SYSTAC
      5263**DCL      6284--DCLINIT  7004--ASSIGN   7014--ASSIGN
VLR_SITEINFO
      6628**DCL      6613--DCLINIT
VLR_SITEINFO.SITE_ID#
      6632**DCL      6977>>ASSIGN
PL6.E3A0      #002=THE$REPORT File=THE$ELAN.:E05TSI                              WED 07/30/97 06:07 Page:82   
VLR_SITEINFO.SITE_NAME#
      6628**DCL      6978>>ASSIGN
XUD$UTS_ADJ_25TH
      6930**DCL-ENT  6972--CALL     6973--CALL
XUD$UTS_DIFF_SEC
      6912**DCL-ENT  6970--CALL
XUR$BREAK
      5800**DCL-ENT  6598--DCLINIT
XUR$DISABLE
      5795**DCL-ENT  6982--CALL
XUR$ENABLE
      5794**DCL-ENT  6986--CALL
XUR$ERRMSG
      5792**DCL-ENT  7092--CALL
XUR$ERRPTR
      5793**DCL-ENT  7090--CALL
XUR$GETCMD
      5791**DCL-ENT  7064--CALL     7067--CALL

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:83   
      452        1        /*M* THE$PROCESS - PROCESS DAILY ERRLOG AND GENERATE DEVHIST */
      453        2        /*T***********************************************************/
      454        3        /*T*                                                         */
      455        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      456        5        /*T*                                                         */
      457        6        /*T***********************************************************/
      458        7        THE$PROCESS: PROC ALTRET;
      459        8        /**/
      460        9        /* INCLUDE FILES */
      461       10        %INCLUDE CP_6;
      462       91        %INCLUDE B$JIT;
      463      381        %INCLUDE B_SEGIDS_C;
      464      920        %INCLUDE NI$TABLES;
      465     1136        %INCLUDE B_ERRORS_C;
      466     2263        %INCLUDE F$DCB;
      467     2312        %INCLUDE EL$TABLES;
      468     2635        %INCLUDE TD$STRUCT;
      469     2736        %INCLUDE TH$HIST;
      470     2831        %INCLUDE TH_DATA_R;
      471     2909        %INCLUDE TH_SUBS_C;
      472     3291        %INCLUDE TH_PERR_C;
      473     3332        %INCLUDE XUD_UTS_M;
      474     3414        /**/
      475     3415        /* ENTRY DEFS */
      476     3416    1   DCL THG$GETREC ENTRY(4) ALTRET;
      477     3417    1   DCL THG$OPENXSA ENTRY(1) ALTRET;
      478     3418    1   DCL THG$CLOSEXSA ENTRY ALTRET;
      479     3419    1   DCL THE$INIT ENTRY(1) ALTRET;
      480     3420    1   DCL THM$ERRMSG ENTRY(1);
      481     3421    1   DCL THD$DEVHIST ENTRY;
      482     3422        /**/
      483     3423        /* DCBS */
      484     3424    1   DCL M$ERRLOG DCB;
      485     3425    1   DCL M$DEVHIST DCB;
      486     3426    1   DCL M$NEWDEV DCB;
      487     3427        /**/
      488     3428        /* VARS */
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:84   
      489     3429    1   DCL EOF_FLG BIT(1);
      490     3430    1   DCL FOUND BIT(1);
      491     3431    1   DCL LAST_INDX UBIN;
      492     3432    1   DCL OLD_INDX UBIN WORD;
      493     3433    1   DCL LAST_REQID UBIN STATIC INIT(0);
      494     3434    1   DCL IOM$ PTR;
      495     3435    1   DCL MPC$ PTR;
      496     3436    1   DCL DEV$ PTR;
      497     3437    1   DCL FEP$ PTR;
      498     3438    1   DCL CHAN$ PTR;
      499     3439    1   DCL IOM# UBIN(3);
      500     3440    1   DCL CHAN# UBIN(9);
      501     3441    1   DCL ZERO CHAR(8) CONSTANT INIT('0       '); /* USED FOR GETREC CALLS          */
      502     3442    1   DCL ONE CHAR(8) CONSTANT INIT('1       ');
      503     3443    1   DCL TWO CHAR(8) CONSTANT INIT('2       ');
      504     3444    1   DCL THREE CHAR(8) CONSTANT INIT('3       '); /* USED FOR GETREC CALLS           */
      505     3445    1   DCL WORDBASE UBIN WORD BASED;
      506     3446    1   DCL NUM_IOMS UBIN WORD STATIC SYMDEF;
      507     3447    1   DCL NUM_MPCS UBIN WORD STATIC SYMDEF;
      508     3448    1   DCL NUM_DEVS UBIN WORD STATIC SYMDEF;
      509     3449    1   DCL NUM_FEPS UBIN WORD STATIC SYMDEF;
      510     3450    1   DCL I SBIN WORD;
      511     3451    1   DCL J SBIN;
      512     3452    1   DCL K SBIN;
      513     3453    1   DCL INDX UBIN;
      514     3454    1   DCL DCTX UBIN WORD;
      515     3455    1   DCL DCT$ PTR;
      516     3456    1   DCL 1 DCTPTR REDEF DCT$,
      517     3457    1         2 OFFSET UBIN(18) UNAL,
      518     3458    1         2 * BIT(6) UNAL,
      519     3459    1         2 SEGID BIT(12) UNAL;
      520     3460        %NI$DCT (NAME=NI$DCT,STCLASS="BASED(DCT$)");
      521     3508    1   DCL NUM_NEW_COMPS UBIN WORD STATIC INIT(0);
      522     3509    1   DCL MPC_NAME CHAR(8);
      523     3510    1   DCL IOM_TBL$ PTR SYMREF;
      524     3511    1   DCL MPC_TBL$ PTR SYMREF;
      525     3512    1   DCL FEP_TBL$ PTR SYMREF;
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:85   
      526     3513    1   DCL DEV_TBL$ PTR SYMREF;
      527     3514    1   DCL CHN# CHAR(2);
      528     3515    1   DCL UTS UBIN WORD STATIC SYMDEF;
      529     3516    1   DCL CURUTS UBIN WORD STATIC;
      530     3517    1   DCL FIRST_UTS UBIN WORD STATIC INIT(0);
      531     3518    1   DCL LAST_UTS UBIN WORD STATIC INIT(0);
      532     3519    1   DCL DEVHIST_UTS UBIN WORD STATIC INIT(0);
      533     3520    1   DCL OLDEST_UTS UBIN WORD STATIC INIT(0);  /* UTS OF OLDEST RECORD */
      534     3521    1   DCL B$TCB$ PTR SYMREF;
      535     3522    1   DCL B$JIT$ PTR SYMREF;
      536     3523    1   DCL HEAD_KEY BIT(18) CONSTANT INIT('001000'O);
      537     3524    1   DCL THRESH_KEY BIT(18) CONSTANT INIT('001001'O);
      538     3525    1   DCL MAINT_KEY BIT(18) CONSTANT INIT('001002'O);
      539     3526    1   DCL UTS_KEY BIT(18) CONSTANT INIT('001003'O);
      540     3527        /**/
      541     3528    1   DCL HD_KEY BIT(18) STATIC;
      542     3529    1   DCL 1 RD_KEY STATIC,
      543     3530    1         2 COUNT UBIN BYTE UNAL INIT(12),
      544     3531    1         2 TXT CHAR(8) UNAL INIT(' '),
      545     3532    1         2 UTS UBIN WORD UNAL INIT(0);
      546     3533    1   DCL 1 KEY8 STATIC,
      547     3534    1         2 COUNT UBIN BYTE UNAL INIT(12),
      548     3535    1         2 TXT CHAR(8) UNAL INIT(' '),
      549     3536    1         2 UTS UBIN WORD UNAL INIT(0);
      550     3537        /**/
      551     3538    1   DCL 1 INFO STATIC ALIGNED,
      552     3539    1         2 BOUND UBIN(20) UNAL,
      553     3540    1         2 * BIT(16),
      554     3541    1         2 PTR$ PTR;
      555     3542    1   DCL 1 HDR STATIC ALIGNED,
      556     3543    1         2 BOUND UBIN(20) UNAL,
      557     3544    1         2 * BIT(16),
      558     3545    1         2 PTR$ PTR;
      559     3546    1   DCL TEMP_UTS UBIN;
      560     3547        /**/
      561     3548        /* MACRO DEFINITIONS */
      562     3549        %MACRO TBL (NAME=JUNK,STCLASS=BASED);
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:86   
      563     3550        DCL 1 NAME(0:0) STCLASS ALIGNED,
      564     3551              2 DEVNAME CHAR(8),
      565     3552              2 PTR$ PTR;
      566     3553        %MEND;
      567     3554        /**/
      568     3555        /* MACRO INVOCATIONS */
      569     3556        %TD$HEAD (NAME=TD$HEAD,NUMDEV#=200);
      570     3592        %TD$HEAD (NAME=TH$HEAD,NUMDEV#=200);
      571     3628        %TD$HEAD (NAME=TD_HEAD,STCLASS=AUTO,NUMDEV#=200);
      572     3664        %TD$HEAD (NAME=TH_HEAD,STCLASS=AUTO,NUMDEV#=200);
      573     3700        %TH$DEV (NAME=DEV,STCLASS="BASED(DEV$)");
      574     3721        %TH$IOM (NAME=IOM,STCLASS="BASED(IOM$)");
      575     3732        %TH$MPC (NAME=MPC,STCLASS="BASED(MPC$)",NUMDEV#=32);
      576     3753        %TH$FEP (NAME=FEP,STCLASS="BASED(FEP$)");
      577     3760        %TH$CHAN (NAME=CHAN,STCLASS="BASED(CHAN$)");
      578     3767        %TH$UTS (NAME=TH$UTS);
      579     3772        /**/
      580     3773        %TH$THRESH (NAME=TH$THRESH,NUMDEV#=200);
      581     3779        %TH$THRESH (NAME=TH_THRESH,STCLASS=AUTO,NUMDEV#=200);
      582     3785        %TH$THRESH (NAME=TEMP_THRESH,STCLASS=AUTO,NUMDEV#=200);
      583     3791        %TH$MAINT (NAME=TH$MAINT,NUMDEV#=200);
      584     3796        %TH$MAINT (NAME=TH_MAINT,STCLASS=AUTO,NUMDEV#=200);
      585     3801        %TH$MAINT (NAME=TEMP_MAINT,STCLASS=AUTO,NUMDEV#=200);
      586     3806        /**/
      587     3807        %TH$MPC (NAME=TH_MPC,STCLASS=AUTO,NUMDEV#=32);
      588     3828        %TH$IOM (NAME=TH_IOM,STCLASS=AUTO);
      589     3839        %TH$FEP (NAME=TH_FEP,STCLASS=AUTO);
      590     3846        %TH$DEV (NAME=TH_DEV,STCLASS=AUTO);
      591     3867        %TH$CHAN (NAME=TH_CHAN,STCLASS=AUTO);
      592     3874        %TH$UTS (NAME=TH_UTS,STCLASS=AUTO);
      593     3879        /**/
      594     3880        %EL$ENTRY (NAME=REC_BUF,
      595     3881                   INFOSZ=4096,
      596     3882                   STCLASS=STATIC);
      597     3886        %EL$IOERR (STCLASS="BASED(TH_INFO.PTR$)");
      598     3896        %EL$EDAC (STCLASS="BASED(TH_INFO.PTR$)");
      599     3905        %EL$FEPERR (STCLASS="BASED(TH_INFO.PTR$)");
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:87   
      600     3984        %EL$PROCERR (STCLASS="BASED(TH_INFO.PTR$)");
      601     3994        %EL$SPURINT (STCLASS="BASED(TH_INFO.PTR$)");
      602     3998        %EL$FEPFLT (STCLASS="BASED(TH_INFO.PTR$)");
      603     4001        /**/
      604     4002        %TBL (NAME=IOM_TBL,STCLASS="BASED(IOM_TBL$)");
      605     4007        %TBL (NAME=MPC_TBL,STCLASS="BASED(MPC_TBL$)");
      606     4012        %TBL (NAME=FEP_TBL,STCLASS="BASED(FEP_TBL$)");
      607     4017        %TBL (NAME=DEV_TBL,STCLASS="BASED(DEV_TBL$)");
      608     4022        /**/
      609     4023        %B$TCB;
      610     4026        %B$ALT;
      611     4034        /**/
      612     4035        %XUD$UTS_ENTRIES;
      613     4067        %XUD_UTS_EQU;
      614     4078        /**/
      615     4079        /* FPT DEFINITIONS */
      616     4080        %VLP_ACCT (FPTN=SYSTAC,
      617     4081                   STCLASS=CONSTANT,
      618     4082                   ACCT=':SYSTAC');
      619     4095        %FPT_OPEN (FPTN=OPEN_DEVHIST,
      620     4096                   STCLASS=CONSTANT,
      621     4097                   DCB=M$DEVHIST,
      622     4098                   NAME=DEVHIST,
      623     4099                   ACCT=DEVHIST_ACCT,
      624     4100                   FUN=UPDATE,
      625     4101                   EXIST=OLDFILE,
      626     4102                   ASN=FILE,
      627     4103                   ACS=DIRECT,
      628     4104                   ORG=KEYED);
      629     4213        %FPT_WRITE (FPTN=WRITE_DEVHIST,
      630     4214                    DCB=M$DEVHIST);
      631     4245        %FPT_CLOSE (FPTN=CLOSE_DEVHIST,
      632     4246                    STCLASS=CONSTANT,
      633     4247                    DCB=M$DEVHIST,
      634     4248                    DISP=SAVE);
      635     4290        %FPT_OPEN (FPTN=OPEN_NEWDEV,
      636     4291                   STCLASS=CONSTANT,
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:88   
      637     4292                   DCB=M$NEWDEV,
      638     4293                   NAME=DEVHIST,
      639     4294                   ACCT=DEVHIST_ACCT,
      640     4295                   FUN=CREATE,
      641     4296                   EXIST=NEWFILE,
      642     4297                   ASN=FILE,
      643     4298                   SHARE=NONE,
      644     4299                   ACS=DIRECT,
      645     4300                   ACCESS=ACSLIST,
      646     4301                   ACSVEH=VEHLIST,
      647     4302                   ORG=KEYED);
      648     4411        %FPT_CLOSE (FPTN=CLOSE_NEWDEV,
      649     4412                    STCLASS=CONSTANT,
      650     4413                    DCB=M$NEWDEV,
      651     4414                    DISP=SAVE);
      652     4456        %FPT_WRITE (FPTN=WRITE_NEWDEV,
      653     4457                    DCB=M$NEWDEV,
      654     4458                    BUF=REC_BUF);
      655     4489        %FPT_OPEN (FPTN=OPEN_DEV,
      656     4490                   STCLASS=CONSTANT,
      657     4491                   DCB=M$DEVHIST,
      658     4492                   NAME=DEVHIST,
      659     4493                   ACCT=DEVHIST_ACCT,
      660     4494                   FUN=IN,
      661     4495                   EXIST=OLDFILE,
      662     4496                   ASN=FILE,
      663     4497                   ACS=DIRECT,
      664     4498                   SHARE=IN,
      665     4499                   ORG=KEYED);
      666     4608        %FPT_CLOSE (FPTN=CLOSE_DEV,
      667     4609                    STCLASS=CONSTANT,
      668     4610                    DCB=M$DEVHIST,
      669     4611                    DISP=SAVE);
      670     4653        %VLP_NAME (FPTN=DEVHIST,
      671     4654                   STCLASS=CONSTANT,
      672     4655                   NAME=':DEVHIST');
      673     4682        %FPT_TIME (FPTN=CUR_UTS,
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:89   
      674     4683                   STCLASS=CONSTANT,
      675     4684                   SOURCE=CLOCK,
      676     4685                   DEST=UTS,
      677     4686                   TSTAMP=CURUTS);
      678     4705        %FPT_PFIL (FPTN=PFIL_DEVHIST,DCB=M$DEVHIST,BOF=YES);
      679     4720        %FPT_READ (FPTN=READ_DEVHIST,
      680     4721                   DCB = M$DEVHIST,
      681     4722                   BUF=REC_BUF,
      682     4723                   KEY=RD_KEY,
      683     4724                   KEYR=YES);
      684     4763        %FPT_READ (FPTN=RD_DEVHIST,
      685     4764                   DCB=M$DEVHIST,
      686     4765                   KEY=HD_KEY,
      687     4766                   BUF=REC_BUF,
      688     4767                   KEYR=YES);
      689     4806        %VLP_ATTR(FPTN=ACSLIST);
      690     4820        %VLP_ACCESS (READ=YES,EXEC=YES,ACCT='?',LAST=";");
      691     4837        %VLP_ATTR(FPTN=VEHLIST);
      692     4851        %VLP_ACSVEH(READ=YES,UPD=YES,WNEW=YES,VEHICLE='SYSCON');
      693     4868        %VLP_ACSVEH(READ=YES,UPD=YES,WNEW=YES,VEHICLE='ELAN',LAST=";");
      694     4885        /**/
      695     4886        %EJECT;
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:90   
      696     4887    1        NUM_NEW_COMPS = 0;
      697     4888    1        TH_M$ERRLOG$ = DCBADDR(DCBNUM(M$ERRLOG));
      698     4889                            /* READ DEVHIST HEAD - IF NOT THERE BUILD A BLANK ONE     */
      699     4890    1        CALL THG$GETREC(%DEVHIST,ZERO) ALTRET(NO_HEAD);
      700     4891    1        IF B$JIT.MODE = %M_INT# AND TH_DEVHIST_MODE = 0
      701     4892    1           THEN RETURN;    /* :DEVHIST FILE EXISTS - NO ACTION REQUIRED */
      702     4893    2        DO NEVER;
      703     4894    2   NO_HEAD:
      704     4895    2           IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOFILE
      705     4896    3              THEN DO;
      706     4897    3                CALL THD$DEVHIST;
      707     4898    3                TH_REBUILD = '0'B;  /* TURN OFF REBUILD FLAG-  SINCE */
      708     4899                                         /* THIS IS A NEW FILE, NO NEED TO */
      709     4900                                         /* SIZE IT DOWN                   */
      710     4901    3              END;
      711     4902    2              ELSE
      712     4903    3              DO;
      713     4904    3                 CALL THM$ERRMSG;
      714     4905    3                 ALTRETURN;
      715     4906    3              END;                         /* IF                                 */
      716     4907    2        END;                               /* DO NEVER                           */
      717     4908    1        TH_HEAD = TH_RECORD.PTR$->TH$HEAD;
      718     4909    1        CALL THG$GETREC(%DEVHIST, THREE);  /* READ UTS RECORD */
      719     4910    1        TH_UTS = TH_RECORD.PTR$ -> TH$UTS;
      720     4911    1        IF DCBADDR(DCBNUM(M$DEVHIST)) -> F$DCB.ARS < 8
      721     4912    2           THEN DO;    /* UTS RECORD IS PRE-E02 */
      722     4913    2             CALL M$CLOSE(CLOSE_DEV);
      723     4914    2             CALL THD$DEVHIST;               /* REBUILD :DEVHIST FILE */
      724     4915    2             TH_HEAD = TH_RECORD.PTR$ -> TH$HEAD;
      725     4916    2             TH_REBUILD = '0'B;
      726     4917    2             GOTO READ_CONFIG_HEAD;
      727     4918    2           END;
      728     4919    1        IF TH_DEVHIST_MODE = %MIDNITE_GHOST
      729     4920    2           THEN DO;
      730     4921    2             CALL M$TIME(CUR_UTS);
      731     4922                         /* IS OLDEST RECORD > 30 DAYS OLD? */
      732     4923    2             CALL XUD$UTS_ADJ_25TH(TEMP_UTS, TH_UTS.OLDEST_UTS, (30*%UTS_25TH_DAY#));
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:91   
      733     4924    2             IF TEMP_UTS > CURUTS
      734     4925    3                THEN DO;      /* NO- RETURN */
      735     4926    3                  CALL M$CLOSE(CLOSE_DEV) ALTRET(ALT);
      736     4927    3                  TH_REBUILD = '0'B;
      737     4928    3                  TH_DEVHIST_MODE = 0;
      738     4929    3                  RETURN;
      739     4930    3                END;
      740     4931    2                ELSE TH_REBUILD = '1'B;   /* YES- SET REBUILD FLAG */
      741     4932    2           END;
      742     4933
      743     4934                                 /* READ HEADER FROM CONFIG FILE AND SET UP VALUES    */
      744     4935    1   READ_CONFIG_HEAD:
      745     4936    1        CALL THG$GETREC(%CONFIG,ZERO) ALTRET(OPEN_ERR);
      746     4937    1        TD_HEAD = TH_RECORD.PTR$->TD$HEAD;
      747     4938    1        NUM_IOMS = TD_HEAD.NUMIOMS;
      748     4939    1        NUM_MPCS = TD_HEAD.NUMUNITMPCS + TD_HEAD.NUMTAPEMPCS + TD_HEAD.NUMDISKMPCS +
      749     4940    1                   TD_HEAD.NUMAPMPCS + TD_HEAD.NUMOPCS;
      750     4941    1        NUM_DEVS = TD_HEAD.NUMLPS + TD_HEAD.NUMCRS + TD_HEAD.NUMCPS + TD_HEAD.NUMDPS +
      751     4942    1             TD_HEAD.NUMMTS + TD_HEAD.NUMXXS + TD_HEAD.NUMAPS + TD_HEAD.NUMODS;
      752     4943    1        NUM_FEPS = TD_HEAD.NUMFEPS;
      753     4944
      754     4945         /* CHECK FOR NEW COMPONENTS IN THIS :CONFIG FILE - IF SO THEN ADD THIS INFO TO :DEV
              4945        HIST HEAD RECORD */
      755     4946
      756     4947    1        LAST_INDX = TH_HEAD.OD_INDX + TH_HEAD.NUMODS - 1;
      757     4948    1        OLD_INDX = LAST_INDX;
      758     4949    1        IF TH_PHONY_GHOST
      759     4950    1        THEN GOTO DO_GHOST2;
      760     4951    1        IF TH_DEVHIST_MODE ~= %TB_GHOST THEN GOTO BYPASS_CHECK;
      761     4952                                        /* CHECK FOR IOMS */
      762     4953    1   DO_GHOST2:;
      763     4954    2        DO I = TD_HEAD.IOM_INDX TO TD_HEAD.IOM_INDX + TD_HEAD.NUMIOMS - 1;
      764     4955    2           FOUND = %FALSE;
      765     4956    3           DO J = TH_HEAD.IOM_INDX TO TH_HEAD.IOM_INDX + TH_HEAD.NUMIOMS - 1;
      766     4957    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)
      767     4958    3                 THEN FOUND = %TRUE;
      768     4959    3           END;  /* DO J */
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:92   
      769     4960    2           IF NOT FOUND
      770     4961    2              THEN  /* STUFF INTO TH_HEAD.DEVNAME */
      771     4962    3              DO;
      772     4963    4                 DO K = TH_HEAD.FEP_INDX TO LAST_INDX;
      773     4964    4                    INDX = LAST_INDX - K + TH_HEAD.FEP_INDX;
      774     4965    4                    TH_HEAD.DEVNAME(INDX + 1) = TH_HEAD.DEVNAME(INDX);
      775     4966    4                 END;  /* DO K */
      776     4967    3                 TH_HEAD.NUMIOMS = TH_HEAD.NUMIOMS + 1;
      777     4968    3                 TH_HEAD.DEVNAME(TH_HEAD.IOM_INDX + TH_HEAD.NUMIOMS - 1) = TD_HEAD.
              4968                          DEVNAME(I);
      778     4969    3                 LAST_INDX = LAST_INDX + 1;
      779     4970    3                 TH_HEAD.FEP_INDX = TH_HEAD.FEP_INDX + 1;
      780     4971    3                 TH_HEAD.UNITMPC_INDX = TH_HEAD.UNITMPC_INDX + 1;
      781     4972    3                 TH_HEAD.TAPEMPC_INDX = TH_HEAD.TAPEMPC_INDX + 1;
      782     4973    3                 TH_HEAD.DISKMPC_INDX = TH_HEAD.DISKMPC_INDX + 1;
      783     4974    3                 TH_HEAD.APMPC_INDX = TH_HEAD.APMPC_INDX + 1;
      784     4975    3                 TH_HEAD.OPC_INDX = TH_HEAD.OPC_INDX + 1;
      785     4976    3                 TH_HEAD.CONSOLE_INDX = TH_HEAD.CONSOLE_INDX + 1;
      786     4977    3                 TH_HEAD.LP_INDX = TH_HEAD.LP_INDX + 1;
      787     4978    3                 TH_HEAD.CR_INDX = TH_HEAD.CR_INDX + 1;
      788     4979    3                 TH_HEAD.CP_INDX = TH_HEAD.CP_INDX + 1;
      789     4980    3                 TH_HEAD.DP_INDX = TH_HEAD.DP_INDX + 1;
      790     4981    3                 TH_HEAD.MT_INDX = TH_HEAD.MT_INDX + 1;
      791     4982    3                 TH_HEAD.XX_INDX = TH_HEAD.XX_INDX + 1;
      792     4983    3                 TH_HEAD.AP_INDX = TH_HEAD.AP_INDX + 1;
      793     4984    3                 TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;
      794     4985    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;
      795     4986    3              END;  /* IF NOT FOUND */
      796     4987    2        END;  /* DO I */
      797     4988
      798     4989    2        DO I = TD_HEAD.FEP_INDX TO TD_HEAD.FEP_INDX + TD_HEAD.NUMFEPS - 1;
      799     4990    2           FOUND = %FALSE;
      800     4991    3           DO J = TH_HEAD.FEP_INDX TO TH_HEAD.FEP_INDX + TH_HEAD.NUMFEPS - 1;
      801     4992    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)
      802     4993    3                 THEN FOUND = %TRUE;
      803     4994    3              END;  /* DO J */
      804     4995    3           IF NOT FOUND THEN DO;
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:93   
      805     4996    4              DO K = LAST_INDX DOWNTO TH_HEAD.UNITMPC_INDX;
      806     4997    4                 TH_HEAD.DEVNAME(K+1) = TH_HEAD.DEVNAME(K);
      807     4998    4                 END;  /* DO K */
      808     4999    3              TH_HEAD.DEVNAME(TH_HEAD.FEP_INDX + TH_HEAD.NUMFEPS) = TD_HEAD.DEVNAME(I);
      809     5000    3              TH_HEAD.NUMFEPS = TH_HEAD.NUMFEPS + 1;
      810     5001    3              LAST_INDX = LAST_INDX + 1;
      811     5002    3              TH_HEAD.UNITMPC_INDX = TH_HEAD.UNITMPC_INDX + 1;
      812     5003    3              TH_HEAD.TAPEMPC_INDX = TH_HEAD.TAPEMPC_INDX + 1;
      813     5004    3              TH_HEAD.DISKMPC_INDX = TH_HEAD.DISKMPC_INDX + 1;
      814     5005    3              TH_HEAD.APMPC_INDX = TH_HEAD.APMPC_INDX + 1;
      815     5006    3              TH_HEAD.OPC_INDX = TH_HEAD.OPC_INDX + 1;
      816     5007    3              TH_HEAD.CONSOLE_INDX = TH_HEAD.CONSOLE_INDX + 1;
      817     5008    3              TH_HEAD.LP_INDX = TH_HEAD.LP_INDX + 1;
      818     5009    3              TH_HEAD.CR_INDX = TH_HEAD.CR_INDX + 1;
      819     5010    3              TH_HEAD.CP_INDX = TH_HEAD.CP_INDX + 1;
      820     5011    3              TH_HEAD.DP_INDX = TH_HEAD.DP_INDX + 1;
      821     5012    3              TH_HEAD.MT_INDX = TH_HEAD.MT_INDX + 1;
      822     5013    3                 TH_HEAD.XX_INDX = TH_HEAD.XX_INDX + 1;
      823     5014    3              TH_HEAD.AP_INDX = TH_HEAD.AP_INDX + 1;
      824     5015    3              TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;
      825     5016    3              NUM_NEW_COMPS = NUM_NEW_COMPS + 1;
      826     5017    3              END;  /* IF NOT FOUND */
      827     5018    2           END;  /* DO I */
      828     5019
      829     5020                                        /* CHECK FOR UCS */
      830     5021    2        DO I = TD_HEAD.UNITMPC_INDX TO TD_HEAD.UNITMPC_INDX + TD_HEAD.NUMUNITMPCS - 1;
      831     5022    2           FOUND = %FALSE;
      832     5023    3           DO J = TH_HEAD.UNITMPC_INDX TO TH_HEAD.UNITMPC_INDX + TH_HEAD.NUMUNITMPCS -
              5023                    1;
      833     5024    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)
      834     5025    3                 THEN FOUND = %TRUE;
      835     5026    3           END;                            /* DO J                               */
      836     5027    2           IF NOT FOUND
      837     5028    2              THEN                         /* STUFF INTO TH_HEAD.DEVNAME         */
      838     5029    3              DO;
      839     5030    4                 DO K = TH_HEAD.TAPEMPC_INDX TO LAST_INDX;
      840     5031    4                    INDX = LAST_INDX - K + TH_HEAD.TAPEMPC_INDX;
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:94   
      841     5032    4                    TH_HEAD.DEVNAME(INDX + 1) = TH_HEAD.DEVNAME(INDX);
      842     5033    4                 END;                      /* DO K                               */
      843     5034    3                 TH_HEAD.NUMUNITMPCS = TH_HEAD.NUMUNITMPCS + 1;
      844     5035    3                 TH_HEAD.DEVNAME(TH_HEAD.UNITMPC_INDX + TH_HEAD.NUMUNITMPCS - 1) =
              5035                          TD_HEAD.DEVNAME(I);
      845     5036    3                 LAST_INDX = LAST_INDX + 1;
      846     5037    3                 TH_HEAD.TAPEMPC_INDX = TH_HEAD.TAPEMPC_INDX + 1;
      847     5038    3                 TH_HEAD.DISKMPC_INDX = TH_HEAD.DISKMPC_INDX + 1;
      848     5039    3                 TH_HEAD.APMPC_INDX = TH_HEAD.APMPC_INDX + 1;
      849     5040    3                 TH_HEAD.OPC_INDX = TH_HEAD.OPC_INDX + 1;
      850     5041    3                 TH_HEAD.CONSOLE_INDX = TH_HEAD.CONSOLE_INDX + 1;
      851     5042    3                 TH_HEAD.LP_INDX = TH_HEAD.LP_INDX + 1;
      852     5043    3                 TH_HEAD.CR_INDX = TH_HEAD.CR_INDX + 1;
      853     5044    3                 TH_HEAD.CP_INDX = TH_HEAD.CP_INDX + 1;
      854     5045    3                 TH_HEAD.DP_INDX = TH_HEAD.DP_INDX + 1;
      855     5046    3                 TH_HEAD.MT_INDX = TH_HEAD.MT_INDX + 1;
      856     5047    3                 TH_HEAD.XX_INDX = TH_HEAD.XX_INDX + 1;
      857     5048    3                 TH_HEAD.AP_INDX = TH_HEAD.AP_INDX + 1;
      858     5049    3                 TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;
      859     5050    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;
      860     5051    3              END;                         /* IF NOT FOUND                       */
      861     5052    2        END;                               /* DO I                               */
      862     5053
      863     5054                                                /* CHECK FOR TCS                      */
      864     5055    2        DO I = TD_HEAD.TAPEMPC_INDX TO TD_HEAD.TAPEMPC_INDX + TD_HEAD.NUMTAPEMPCS - 1;
      865     5056    2           FOUND = %FALSE;
      866     5057    3           DO J = TH_HEAD.TAPEMPC_INDX TO TH_HEAD.TAPEMPC_INDX + TH_HEAD.NUMTAPEMPCS -
              5057                    1;
      867     5058    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)
      868     5059    3                 THEN FOUND = %TRUE;
      869     5060    3           END;                            /* DO J                               */
      870     5061    2           IF NOT FOUND
      871     5062    2              THEN                         /* STUFF INTO TH_HEAD.DEVNAME         */
      872     5063    3              DO;
      873     5064    4                 DO K = TH_HEAD.DISKMPC_INDX TO LAST_INDX;
      874     5065    4                    INDX = LAST_INDX - K + TH_HEAD.DISKMPC_INDX;
      875     5066    4                    TH_HEAD.DEVNAME(INDX + 1) = TH_HEAD.DEVNAME(INDX);
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:95   
      876     5067    4                 END;                      /* DO K                               */
      877     5068    3                 TH_HEAD.NUMTAPEMPCS = TH_HEAD.NUMTAPEMPCS + 1;
      878     5069    3                 TH_HEAD.DEVNAME(TH_HEAD.TAPEMPC_INDX + TH_HEAD.NUMTAPEMPCS - 1) =
              5069                          TD_HEAD.DEVNAME(I);
      879     5070    3                 LAST_INDX = LAST_INDX + 1;
      880     5071    3                 TH_HEAD.DISKMPC_INDX = TH_HEAD.DISKMPC_INDX + 1;
      881     5072    3                 TH_HEAD.APMPC_INDX = TH_HEAD.APMPC_INDX + 1;
      882     5073    3                 TH_HEAD.OPC_INDX = TH_HEAD.OPC_INDX + 1;
      883     5074    3                 TH_HEAD.CONSOLE_INDX = TH_HEAD.CONSOLE_INDX + 1;
      884     5075    3                 TH_HEAD.LP_INDX = TH_HEAD.LP_INDX + 1;
      885     5076    3                 TH_HEAD.CR_INDX = TH_HEAD.CR_INDX + 1;
      886     5077    3                 TH_HEAD.CP_INDX = TH_HEAD.CP_INDX + 1;
      887     5078    3                 TH_HEAD.DP_INDX = TH_HEAD.DP_INDX + 1;
      888     5079    3                 TH_HEAD.MT_INDX = TH_HEAD.MT_INDX + 1;
      889     5080    3                 TH_HEAD.XX_INDX = TH_HEAD.XX_INDX + 1;
      890     5081    3                 TH_HEAD.AP_INDX = TH_HEAD.AP_INDX + 1;
      891     5082    3                 TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;
      892     5083    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;
      893     5084    3              END;                         /* IF NOT FOUND                       */
      894     5085    2        END;                               /* DO I                               */
      895     5086
      896     5087                                                /* CHECK FOR DCS                      */
      897     5088    2        DO I = TD_HEAD.DISKMPC_INDX TO TD_HEAD.DISKMPC_INDX + TD_HEAD.NUMDISKMPCS - 1;
      898     5089    2           FOUND = %FALSE;
      899     5090    3           DO J = TH_HEAD.DISKMPC_INDX TO TH_HEAD.DISKMPC_INDX + TH_HEAD.NUMDISKMPCS -
              5090                    1;
      900     5091    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)
      901     5092    3                 THEN FOUND = %TRUE;
      902     5093    3           END;                            /* DO J                               */
      903     5094    2           IF NOT FOUND
      904     5095    2              THEN                         /* STUFF INTO TH_HEAD.DEVNAME         */
      905     5096    3              DO;
      906     5097    4                 DO K = TH_HEAD.APMPC_INDX TO LAST_INDX;
      907     5098    4                    INDX = LAST_INDX - K + TH_HEAD.APMPC_INDX;
      908     5099    4                    TH_HEAD.DEVNAME(INDX + 1) = TH_HEAD.DEVNAME(INDX);
      909     5100    4                 END;                      /* DO K                               */
      910     5101    3                 TH_HEAD.NUMDISKMPCS = TH_HEAD.NUMDISKMPCS + 1;
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:96   
      911     5102    3                 TH_HEAD.DEVNAME(TH_HEAD.DISKMPC_INDX + TH_HEAD.NUMDISKMPCS - 1) =
              5102                          TD_HEAD.DEVNAME(I);
      912     5103    3                 LAST_INDX = LAST_INDX + 1;
      913     5104    3                 TH_HEAD.APMPC_INDX = TH_HEAD.APMPC_INDX + 1;
      914     5105    3                 TH_HEAD.OPC_INDX = TH_HEAD.OPC_INDX + 1;
      915     5106    3                 TH_HEAD.CONSOLE_INDX = TH_HEAD.CONSOLE_INDX + 1;
      916     5107    3                 TH_HEAD.LP_INDX = TH_HEAD.LP_INDX + 1;
      917     5108    3                 TH_HEAD.CR_INDX = TH_HEAD.CR_INDX + 1;
      918     5109    3                 TH_HEAD.CP_INDX = TH_HEAD.CP_INDX + 1;
      919     5110    3                 TH_HEAD.DP_INDX = TH_HEAD.DP_INDX + 1;
      920     5111    3                 TH_HEAD.MT_INDX = TH_HEAD.MT_INDX + 1;
      921     5112    3                 TH_HEAD.XX_INDX = TH_HEAD.XX_INDX + 1;
      922     5113    3                 TH_HEAD.AP_INDX = TH_HEAD.AP_INDX + 1;
      923     5114    3                 TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;
      924     5115    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;
      925     5116    3              END;                         /* IF NOT FOUND                       */
      926     5117    2        END;                               /* DO I                               */
      927     5118
      928     5119                                                /* CHECK FOR  ACS                     */
      929     5120    2        DO I = TD_HEAD.APMPC_INDX TO TD_HEAD.APMPC_INDX + TD_HEAD.NUMAPMPCS - 1;
      930     5121    2           FOUND = %FALSE;
      931     5122    3           DO J = TH_HEAD.APMPC_INDX TO TH_HEAD.APMPC_INDX + TH_HEAD.NUMAPMPCS - 1;
      932     5123    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)
      933     5124    3                 THEN FOUND = %TRUE;
      934     5125    3           END;                            /* DO J                               */
      935     5126    2           IF NOT FOUND
      936     5127    2              THEN                         /* STUFF INTO TH_HEAD.DEVNAME         */
      937     5128    3              DO;
      938     5129    4                 DO K = TH_HEAD.OPC_INDX TO LAST_INDX;
      939     5130    4                    INDX = LAST_INDX - K + TH_HEAD.OPC_INDX;
      940     5131    4                    TH_HEAD.DEVNAME(INDX + 1) = TH_HEAD.DEVNAME(INDX);
      941     5132    4                 END;                      /* DO K                               */
      942     5133    3                 TH_HEAD.NUMAPMPCS = TH_HEAD.NUMAPMPCS + 1;
      943     5134    3                 TH_HEAD.DEVNAME(TH_HEAD.APMPC_INDX + TH_HEAD.NUMAPMPCS - 1) = TD_HEAD.
              5134                          DEVNAME(I);
      944     5135    3                 LAST_INDX = LAST_INDX + 1;
      945     5136    3                 TH_HEAD.OPC_INDX = TH_HEAD.OPC_INDX + 1;
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:97   
      946     5137    3                 TH_HEAD.CONSOLE_INDX = TH_HEAD.CONSOLE_INDX + 1;
      947     5138    3                 TH_HEAD.LP_INDX = TH_HEAD.LP_INDX + 1;
      948     5139    3                 TH_HEAD.CR_INDX = TH_HEAD.CR_INDX + 1;
      949     5140    3                 TH_HEAD.CP_INDX = TH_HEAD.CP_INDX + 1;
      950     5141    3                 TH_HEAD.DP_INDX = TH_HEAD.DP_INDX + 1;
      951     5142    3                 TH_HEAD.MT_INDX = TH_HEAD.MT_INDX + 1;
      952     5143    3                 TH_HEAD.XX_INDX = TH_HEAD.XX_INDX + 1;
      953     5144    3                 TH_HEAD.AP_INDX = TH_HEAD.AP_INDX + 1;
      954     5145    3                 TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;
      955     5146    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;
      956     5147    3              END;                         /* IF NOT FOUND                       */
      957     5148    2        END;                               /* DO I                               */
      958     5149
      959     5150
      960     5151                                                /* CHECK FOR  OPCS                    */
      961     5152    2        DO I = TD_HEAD.OPC_INDX TO TD_HEAD.OPC_INDX + TD_HEAD.NUMOPCS - 1;
      962     5153    2           FOUND = %FALSE;
      963     5154    3           DO J = TH_HEAD.OPC_INDX TO TH_HEAD.OPC_INDX + TH_HEAD.NUMOPCS - 1;
      964     5155    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)
      965     5156    3                 THEN FOUND = %TRUE;
      966     5157    3           END;                            /* DO J                               */
      967     5158    2           IF NOT FOUND
      968     5159    2              THEN                         /* STUFF INTO TH_HEAD.DEVNAME         */
      969     5160    3              DO;
      970     5161    4                 DO K = TH_HEAD.CONSOLE_INDX TO LAST_INDX;
      971     5162    4                    INDX = LAST_INDX - K + TH_HEAD.CONSOLE_INDX;
      972     5163    4                    TH_HEAD.DEVNAME(INDX + 1) = TH_HEAD.DEVNAME(INDX);
      973     5164    4                 END;                      /* DO K                               */
      974     5165    3                 TH_HEAD.NUMOPCS = TH_HEAD.NUMOPCS + 1;
      975     5166    3                 TH_HEAD.DEVNAME(TH_HEAD.OPC_INDX + TH_HEAD.NUMOPCS - 1) = TD_HEAD.
              5166                          DEVNAME(I);
      976     5167    3                 LAST_INDX = LAST_INDX + 1;
      977     5168    3                 TH_HEAD.CONSOLE_INDX = TH_HEAD.CONSOLE_INDX + 1;
      978     5169    3                 TH_HEAD.LP_INDX = TH_HEAD.LP_INDX + 1;
      979     5170    3                 TH_HEAD.CR_INDX = TH_HEAD.CR_INDX + 1;
      980     5171    3                 TH_HEAD.CP_INDX = TH_HEAD.CP_INDX + 1;
      981     5172    3                 TH_HEAD.DP_INDX = TH_HEAD.DP_INDX + 1;
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:98   
      982     5173    3                 TH_HEAD.MT_INDX = TH_HEAD.MT_INDX + 1;
      983     5174    3                 TH_HEAD.XX_INDX = TH_HEAD.XX_INDX + 1;
      984     5175    3                 TH_HEAD.AP_INDX = TH_HEAD.AP_INDX + 1;
      985     5176    3                 TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;
      986     5177    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;
      987     5178    3              END;                         /* IF NOT FOUND                       */
      988     5179    2        END;                               /* DO I                               */
      989     5180
      990     5181                                                /* CHECK FOR LPS                      */
      991     5182    2        DO I = TD_HEAD.LP_INDX TO TD_HEAD.LP_INDX + TD_HEAD.NUMLPS - 1;
      992     5183    2           FOUND = %FALSE;
      993     5184    3           DO J = TH_HEAD.LP_INDX TO TH_HEAD.LP_INDX + TH_HEAD.NUMLPS - 1;
      994     5185    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)
      995     5186    3                 THEN FOUND = %TRUE;
      996     5187    3           END;                            /* DO J                               */
      997     5188    2           IF NOT FOUND
      998     5189    2              THEN                         /* STUFF INTO TH_HEAD.DEVNAME         */
      999     5190    3              DO;
     1000     5191    4                 DO K = TH_HEAD.CR_INDX TO LAST_INDX;
     1001     5192    4                    INDX = LAST_INDX - K + TH_HEAD.CR_INDX;
     1002     5193    4                    TH_HEAD.DEVNAME(INDX + 1) = TH_HEAD.DEVNAME(INDX);
     1003     5194    4                 END;                      /* DO K                               */
     1004     5195    3                 TH_HEAD.NUMLPS = TH_HEAD.NUMLPS + 1;
     1005     5196    3                 TH_HEAD.DEVNAME(TH_HEAD.LP_INDX + TH_HEAD.NUMLPS - 1) = TD_HEAD.
              5196                          DEVNAME(I);
     1006     5197    3                 LAST_INDX = LAST_INDX + 1;
     1007     5198    3                 TH_HEAD.CR_INDX = TH_HEAD.CR_INDX + 1;
     1008     5199    3                 TH_HEAD.CP_INDX = TH_HEAD.CP_INDX + 1;
     1009     5200    3                 TH_HEAD.DP_INDX = TH_HEAD.DP_INDX + 1;
     1010     5201    3                 TH_HEAD.MT_INDX = TH_HEAD.MT_INDX + 1;
     1011     5202    3                 TH_HEAD.XX_INDX = TH_HEAD.XX_INDX + 1;
     1012     5203    3                 TH_HEAD.AP_INDX = TH_HEAD.AP_INDX + 1;
     1013     5204    3                 TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;
     1014     5205    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;
     1015     5206    3              END;                         /* IF NOT FOUND                       */
     1016     5207    2        END;                               /* DO I                               */
     1017     5208
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:99   
     1018     5209                                                /* CHECK FOR CRS                      */
     1019     5210    2        DO I = TD_HEAD.CR_INDX TO TD_HEAD.CR_INDX + TD_HEAD.NUMCRS - 1;
     1020     5211    2           FOUND = %FALSE;
     1021     5212    3           DO J = TH_HEAD.CR_INDX TO TH_HEAD.CR_INDX + TH_HEAD.NUMCRS - 1;
     1022     5213    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)
     1023     5214    3                 THEN FOUND = %TRUE;
     1024     5215    3           END;                            /* DO J                               */
     1025     5216    2           IF NOT FOUND
     1026     5217    2              THEN                         /* STUFF INTO TH_HEAD.DEVNAME         */
     1027     5218    3              DO;
     1028     5219    4                 DO K = TH_HEAD.CP_INDX TO LAST_INDX;
     1029     5220    4                    INDX = LAST_INDX - K + TH_HEAD.CP_INDX;
     1030     5221    4                    TH_HEAD.DEVNAME(INDX + 1) = TH_HEAD.DEVNAME(INDX);
     1031     5222    4                 END;                      /* DO K                               */
     1032     5223    3                 TH_HEAD.NUMCRS = TH_HEAD.NUMCRS + 1;
     1033     5224    3                 TH_HEAD.DEVNAME(TH_HEAD.CR_INDX + TH_HEAD.NUMCRS - 1) = TD_HEAD.
              5224                          DEVNAME(I);
     1034     5225    3                 LAST_INDX = LAST_INDX + 1;
     1035     5226    3                 TH_HEAD.CP_INDX = TH_HEAD.CP_INDX + 1;
     1036     5227    3                 TH_HEAD.DP_INDX = TH_HEAD.DP_INDX + 1;
     1037     5228    3                 TH_HEAD.MT_INDX = TH_HEAD.MT_INDX + 1;
     1038     5229    3                 TH_HEAD.XX_INDX = TH_HEAD.XX_INDX + 1;
     1039     5230    3                 TH_HEAD.AP_INDX = TH_HEAD.AP_INDX + 1;
     1040     5231    3                 TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;
     1041     5232    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;
     1042     5233    3              END;                         /* IF NOT FOUND                       */
     1043     5234    2        END;                               /* DO I                               */
     1044     5235
     1045     5236                                                /* CHECK FOR CPS                      */
     1046     5237    2        DO I = TD_HEAD.CP_INDX TO TD_HEAD.CP_INDX + TD_HEAD.NUMCPS - 1;
     1047     5238    2           FOUND = %FALSE;
     1048     5239    3           DO J = TH_HEAD.CP_INDX TO TH_HEAD.CP_INDX + TH_HEAD.NUMCPS - 1;
     1049     5240    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)
     1050     5241    3                 THEN FOUND = %TRUE;
     1051     5242    3           END;                            /* DO J                               */
     1052     5243    2           IF NOT FOUND
     1053     5244    2              THEN                         /* STUFF INTO TH_HEAD.DEVNAME         */
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:100  
     1054     5245    3              DO;
     1055     5246    4                 DO K = TH_HEAD.DP_INDX TO LAST_INDX;
     1056     5247    4                    INDX = LAST_INDX - K + TH_HEAD.DP_INDX;
     1057     5248    4                    TH_HEAD.DEVNAME(INDX + 1) = TH_HEAD.DEVNAME(INDX);
     1058     5249    4                 END;                      /* DO K                               */
     1059     5250    3                 TH_HEAD.NUMCPS = TH_HEAD.NUMCPS + 1;
     1060     5251    3                 TH_HEAD.DEVNAME(TH_HEAD.CP_INDX + TH_HEAD.NUMCPS - 1) = TD_HEAD.
              5251                          DEVNAME(I);
     1061     5252    3                 LAST_INDX = LAST_INDX + 1;
     1062     5253    3                 TH_HEAD.DP_INDX = TH_HEAD.DP_INDX + 1;
     1063     5254    3                 TH_HEAD.MT_INDX = TH_HEAD.MT_INDX + 1;
     1064     5255    3                 TH_HEAD.XX_INDX = TH_HEAD.XX_INDX + 1;
     1065     5256    3                 TH_HEAD.AP_INDX = TH_HEAD.AP_INDX + 1;
     1066     5257    3                 TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;
     1067     5258    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;
     1068     5259    3              END;                         /* IF NOT FOUND                       */
     1069     5260    2        END;                               /* DO I                               */
     1070     5261
     1071     5262                                                /* CHECK FOR DPS                      */
     1072     5263    2        DO I = TD_HEAD.DP_INDX TO TD_HEAD.DP_INDX + TD_HEAD.NUMDPS - 1;
     1073     5264    2           FOUND = %FALSE;
     1074     5265    3           DO J = TH_HEAD.DP_INDX TO TH_HEAD.DP_INDX + TH_HEAD.NUMDPS - 1;
     1075     5266    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)
     1076     5267    3                 THEN FOUND = %TRUE;
     1077     5268    3           END;                            /* DO J                               */
     1078     5269    2           IF NOT FOUND
     1079     5270    2              THEN                         /* STUFF INTO TH_HEAD.DEVNAME         */
     1080     5271    3              DO;
     1081     5272    4                 DO K = TH_HEAD.MT_INDX TO LAST_INDX;
     1082     5273    4                    INDX = LAST_INDX - K + TH_HEAD.MT_INDX;
     1083     5274    4                    TH_HEAD.DEVNAME(INDX + 1) = TH_HEAD.DEVNAME(INDX);
     1084     5275    4                 END;                      /* DO K                               */
     1085     5276    3                 TH_HEAD.NUMDPS = TH_HEAD.NUMDPS + 1;
     1086     5277    3                 TH_HEAD.DEVNAME(TH_HEAD.DP_INDX + TH_HEAD.NUMDPS - 1) = TD_HEAD.
              5277                          DEVNAME(I);
     1087     5278    3                 LAST_INDX = LAST_INDX + 1;
     1088     5279    3                 TH_HEAD.MT_INDX = TH_HEAD.MT_INDX + 1;
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:101  
     1089     5280    3                 TH_HEAD.XX_INDX = TH_HEAD.XX_INDX + 1;
     1090     5281    3                 TH_HEAD.AP_INDX = TH_HEAD.AP_INDX + 1;
     1091     5282    3                 TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;
     1092     5283    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;
     1093     5284    3              END;                         /* IF NOT FOUND                       */
     1094     5285    2        END;                               /* DO I                               */
     1095     5286
     1096     5287                                                /* CHECK FOR MTS                      */
     1097     5288    2        DO I = TD_HEAD.MT_INDX TO TD_HEAD.MT_INDX + TD_HEAD.NUMMTS - 1;
     1098     5289    2           FOUND = %FALSE;
     1099     5290    3           DO J = TH_HEAD.MT_INDX TO TH_HEAD.MT_INDX + TH_HEAD.NUMMTS - 1;
     1100     5291    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)
     1101     5292    3                 THEN FOUND = %TRUE;
     1102     5293    3           END;                            /* DO J                               */
     1103     5294    2           IF NOT FOUND
     1104     5295    2              THEN                         /* STUFF INTO TH_HEAD.DEVNAME         */
     1105     5296    3              DO;
     1106     5297    4                 DO K = TH_HEAD.XX_INDX TO LAST_INDX;
     1107     5298    4                    INDX = LAST_INDX - K + TH_HEAD.XX_INDX;
     1108     5299    4                    TH_HEAD.DEVNAME(INDX + 1) = TH_HEAD.DEVNAME(INDX);
     1109     5300    4                 END;                      /* DO K                               */
     1110     5301    3                 TH_HEAD.NUMMTS = TH_HEAD.NUMMTS + 1;
     1111     5302    3                 TH_HEAD.DEVNAME(TH_HEAD.MT_INDX + TH_HEAD.NUMMTS - 1) = TD_HEAD.
              5302                          DEVNAME(I);
     1112     5303    3                 LAST_INDX = LAST_INDX + 1;
     1113     5304    3                 TH_HEAD.XX_INDX = TH_HEAD.XX_INDX + 1;
     1114     5305    3                 TH_HEAD.AP_INDX = TH_HEAD.AP_INDX + 1;
     1115     5306    3                 TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;
     1116     5307    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;
     1117     5308    3              END;                         /* IF NOT FOUND                       */
     1118     5309    2        END;                               /* DO I                               */
     1119     5310
     1120     5311                                                /* CHECK FOR XXS (dummy for old 7T's) */
     1121     5312    2           DO I = TD_HEAD.XX_INDX TO TD_HEAD.XX_INDX + TD_HEAD.NUMXXS - 1;
     1122     5313    2           FOUND = %FALSE;
     1123     5314    3              DO J = TH_HEAD.XX_INDX TO TH_HEAD.XX_INDX + TH_HEAD.NUMXXS - 1;
     1124     5315    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:102  
     1125     5316    3                 THEN FOUND = %TRUE;
     1126     5317    3           END;                            /* DO J                               */
     1127     5318    2           IF NOT FOUND
     1128     5319    2              THEN                         /* STUFF INTO TH_HEAD.DEVNAME         */
     1129     5320    3              DO;
     1130     5321    4                 DO K = TH_HEAD.AP_INDX TO LAST_INDX;
     1131     5322    4                    INDX = LAST_INDX - K + TH_HEAD.AP_INDX;
     1132     5323    4                    TH_HEAD.DEVNAME(INDX + 1) = TH_HEAD.DEVNAME(INDX);
     1133     5324    4                 END;                      /* DO K                               */
     1134     5325    3                 TH_HEAD.NUMXXS = TH_HEAD.NUMXXS + 1;
     1135     5326    3                 TH_HEAD.DEVNAME(TH_HEAD.XX_INDX + TH_HEAD.NUMXXS - 1) = TD_HEAD.
              5326                          DEVNAME(I);
     1136     5327    3                 LAST_INDX = LAST_INDX + 1;
     1137     5328    3                 TH_HEAD.AP_INDX = TH_HEAD.AP_INDX + 1;
     1138     5329    3                 TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;
     1139     5330    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;
     1140     5331    3              END;                         /* IF NOT FOUND                       */
     1141     5332    2        END;                               /* DO I                               */
     1142     5333
     1143     5334                                                /* CHECK FOR  APS                     */
     1144     5335    2        DO I = TD_HEAD.AP_INDX TO TD_HEAD.AP_INDX + TD_HEAD.NUMAPS - 1;
     1145     5336    2           FOUND = %FALSE;
     1146     5337    3           DO J = TH_HEAD.AP_INDX TO TH_HEAD.AP_INDX + TH_HEAD.NUMAPS - 1;
     1147     5338    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)
     1148     5339    3                 THEN FOUND = %TRUE;
     1149     5340    3           END;                            /* DO J                               */
     1150     5341    2           IF NOT FOUND
     1151     5342    2              THEN                         /* STUFF INTO TH_HEAD.DEVNAME         */
     1152     5343    3              DO;
     1153     5344    4                 DO K = TH_HEAD.OD_INDX TO LAST_INDX;
     1154     5345    4                    INDX = LAST_INDX - K + TH_HEAD.OD_INDX;
     1155     5346    4                    TH_HEAD.DEVNAME(INDX + 1) = TH_HEAD.DEVNAME(INDX);
     1156     5347    4                 END;                      /* DO K                               */
     1157     5348    3                 TH_HEAD.NUMAPS = TH_HEAD.NUMAPS + 1;
     1158     5349    3                 TH_HEAD.DEVNAME(TH_HEAD.AP_INDX + TH_HEAD.NUMAPS - 1) = TD_HEAD.
              5349                          DEVNAME(I);
     1159     5350    3                 LAST_INDX = LAST_INDX + 1;
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:103  
     1160     5351    3                 TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;
     1161     5352    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;
     1162     5353    3              END;                         /* IF NOT FOUND                       */
     1163     5354    2        END;                               /* DO I                               */
     1164     5355
     1165     5356
     1166     5357                                                /* CHECK FOR  ODS                     */
     1167     5358    2        DO I = TD_HEAD.OD_INDX TO TD_HEAD.OD_INDX + TD_HEAD.NUMODS - 1;
     1168     5359    2           FOUND = %FALSE;
     1169     5360    3           DO J = TH_HEAD.OD_INDX TO TH_HEAD.OD_INDX + TH_HEAD.NUMODS - 1;
     1170     5361    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)
     1171     5362    3                 THEN FOUND = %TRUE;
     1172     5363    3           END;                            /* DO J                               */
     1173     5364    2           IF NOT FOUND
     1174     5365    2              THEN                         /* STUFF INTO TH_HEAD.DEVNAME         */
     1175     5366    3              DO;
     1176     5367    3                 TH_HEAD.NUMODS = TH_HEAD.NUMODS + 1;
     1177     5368    3                 TH_HEAD.DEVNAME(TH_HEAD.OD_INDX + TH_HEAD.NUMODS - 1) = TD_HEAD.
              5368                          DEVNAME(I);
     1178     5369    3                 LAST_INDX = LAST_INDX + 1;
     1179     5370    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;
     1180     5371    3              END;                         /* IF NOT FOUND                       */
     1181     5372    2        END;                               /* DO I                               */
     1182     5373
     1183     5374    1        IF NUM_NEW_COMPS > 0
     1184     5375    1           THEN                            /* UPDATE THRESH AND MAINT RECORDS    */
     1185     5376    2           DO;
     1186     5377    2              CALL THG$GETREC(%DEVHIST,ONE); /* THRESH RECORD                    */
     1187     5378    2              TH_THRESH = TH_RECORD.PTR$->TH$THRESH;
     1188     5379    2              CALL THG$GETREC(%DEVHIST,TWO); /* MAINT RECORD                     */
     1189     5380    2              TH_MAINT = TH_RECORD.PTR$->TH$MAINT;
     1190     5381    2              J = 0;
     1191     5382    3              DO I = 0 TO LAST_INDX;
     1192     5383    3                 IF (J <= OLD_INDX) AND (TH_MAINT.DEVNAME(J) = TH_HEAD.DEVNAME(I))
     1193     5384    3                    THEN                   /* OLD COMPONENT                      */
     1194     5385    4                    DO;
     1195     5386    4                       TEMP_MAINT(I) = TH_MAINT(J);
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:104  
     1196     5387    4                       TEMP_THRESH(I) = TH_THRESH(J);
     1197     5388    4                       J = J + 1;
     1198     5389    4                    END;
     1199     5390    3                    ELSE                   /* NEW COMPONENT                      */
     1200     5391    4                    DO;
     1201     5392    4                       TEMP_MAINT.DEVNAME(I) = TH_HEAD.DEVNAME(I);
     1202     5393    4                       TEMP_MAINT.UTS(I) = 0;
     1203     5394    4                       TEMP_THRESH.DEVNAME(I) = TH_HEAD.DEVNAME(I);
     1204     5395    4                       TEMP_THRESH.ATTEN(I) = 9900;
     1205     5396    4                       TEMP_THRESH.ALERT(I) = 9500;
     1206     5397    4                    END;                   /* IF                                 */
     1207     5398    3              END;                         /* DO I = 0 TO LAST_INDX              */
     1208     5399    2              IF DCBADDR(DCBNUM(M$DEVHIST))->F$DCB.FCD
     1209     5400    2                 THEN CALL M$CLOSE(CLOSE_DEVHIST);
     1210     5401    2              CALL M$OPEN(OPEN_DEVHIST);
     1211     5402    2              WRITE_DEVHIST.BUF_ = VECTOR(TEMP_MAINT);
     1212     5403    2              WRITE_DEVHIST.KEY_ = VECTOR(MAINT_KEY);
     1213     5404    2              WRITE_DEVHIST.BUF_.BOUND = SIZEV(TH_MAINT) - ((200 - LAST_INDX) * 12);
     1214     5405    2              CALL M$WRITE(WRITE_DEVHIST);
     1215     5406
     1216     5407    2              WRITE_DEVHIST.KEY_ = VECTOR(THRESH_KEY);
     1217     5408    2              WRITE_DEVHIST.BUF_ = VECTOR(TEMP_THRESH);
     1218     5409    2              WRITE_DEVHIST.BUF_.BOUND = SIZEV(TH_THRESH) - ((200 - LAST_INDX) * 12);
     1219     5410    2              CALL M$WRITE(WRITE_DEVHIST);
     1220     5411    2        END;                               /* IF NUM_NEW_COMPS > 0               */
     1221     5412
     1222     5413    1   BYPASS_CHECK:
     1223     5414                            /* READ ERRLOG RECORDS AND STUFF ERROR INFO INTO RECORDS  */
     1224     5415    1        TH_CONSTRAINTS = TH_DEFAULT;
     1225     5416
     1226     5417                                                /* SET TIME CONSTRAINTS               */
     1227     5418    1        CALL THG$GETREC(%DEVHIST,THREE);   /* UTS RECORD                         */
     1228     5419    1        TH_UTS = TH_RECORD.PTR$ -> TH$UTS;
     1229     5420    1        DEVHIST_UTS = TH_UTS.ERRLOG_UTS;   /* UTS WHEN ERRLOG WAS LAST */
     1230     5421                                              /* PROCESSED AGAINST :DEVHIST */
     1231     5422    1        CALL M$TIME(CUR_UTS);
     1232     5423    1        CALL XUD$UTS_DIFF_SEC (LAST_UTS, CURUTS, 0);
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:105  
     1233     5424    1        LAST_UTS = LAST_UTS / 86400;
     1234     5425    1        CALL XUD$UTS_ADJ_25TH (LAST_UTS, 0, LAST_UTS*%UTS_25TH_DAY#);
     1235     5426    2        IF DEVHIST_UTS = 0 THEN DO;
     1236     5427    2        CALL XUD$UTS_DIFF_SEC (FIRST_UTS, CURUTS, 0);
     1237     5428    2        FIRST_UTS = FIRST_UTS / 86400;
     1238     5429    2        CALL XUD$UTS_ADJ_25TH (FIRST_UTS, 0, FIRST_UTS*%UTS_25TH_DAY#);
     1239     5430    2           DEVHIST_UTS = FIRST_UTS;
     1240     5431    2           END;  /* IF DEVHIST_UTS = 0 */
     1241     5432    2        ELSE DO;
     1242     5433    2        CALL XUD$UTS_DIFF_SEC (FIRST_UTS, DEVHIST_UTS, 0);
     1243     5434    2        FIRST_UTS = FIRST_UTS / 86400;
     1244     5435    2        CALL XUD$UTS_ADJ_25TH (FIRST_UTS, 0, FIRST_UTS*%UTS_25TH_DAY#);
     1245     5436    2           CALL XUD$UTS_ADJ_25TH(OLDEST_UTS, LAST_UTS, -(30*%UTS_25TH_DAY#));
     1246     5437    2           IF OLDEST_UTS > FIRST_UTS
     1247     5438    3              THEN DO;       /* ONLY MERGE 30 DAYS WORTH OF ERROR LOG */
     1248     5439    3                FIRST_UTS = OLDEST_UTS;         /* INFO INTO :DEVHIST*/
     1249     5440    3                DEVHIST_UTS = OLDEST_UTS;
     1250     5441    3              END;
     1251     5442    2           END;  /* ELSE */
     1252     5443    1        IF DCBADDR(DCBNUM(M$DEVHIST))->F$DCB.FCD
     1253     5444    1           THEN CALL M$CLOSE(CLOSE_DEVHIST);
     1254     5445    1        CALL M$OPEN(OPEN_DEVHIST) ALTRET(ALT);
     1255     5446
     1256     5447    1        UTS = FIRST_UTS;
     1257     5448    2        DO WHILE (UTS <= LAST_UTS);
     1258     5449    2           IF UTS = FIRST_UTS
     1259     5450    2              THEN TH_CONSTRAINTS.START = DEVHIST_UTS;
     1260     5451    2              ELSE TH_CONSTRAINTS.START = UTS;
     1261     5452    2           IF UTS = LAST_UTS
     1262     5453    2              THEN TH_CONSTRAINTS.STOP = CURUTS;
     1263     5454    2              ELSE CALL XUD$UTS_ADJ_25TH (TH_CONSTRAINTS.STOP, UTS, %UTS_25TH_DAY# -1);
     1264     5455
     1265     5456                                 /* INITIALIZE MPC, FEP, IOM, DEV, AND CHAN TABLES    */
     1266     5457    2           CALL THE$INIT(TD_HEAD) ALTRET(NO_MEM);
     1267     5458    2           CALL THG$OPENXSA(TH_CONSTRAINTS.START) ALTRET(KEEP_GOING);
     1268     5459    2           EOF_FLG = %FALSE;
     1269     5460    3           DO WHILE(NOT EOF_FLG);
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:106  
     1270     5461    3     LOOP:
     1271     5462    3              CALL THG$GETREC(%ERRLOG) ALTRET(EOF_LBL);
     1272     5463    4              DO CASE(TH_ITYPE);
     1273     5464    4                 CASE(%TH_IOERR);
     1274     5465    4                    IF LAST_REQID = EL$IOERR.REQID THEN GOTO LOOP;
     1275     5466    4                    IOM# = EL$IOERR.IOCHAN.IOM;
     1276     5467    4                    IF IOM# + 1 > NUM_IOMS THEN GOTO LOOP;
     1277     5468    4                    CHAN# = EL$IOERR.IOCHAN.CHAN;
     1278     5469    4                    IF EL$IOERR.THRESH.IOM
     1279     5470    4                       THEN
     1280     5471    5                       DO;
     1281     5472    5                          IOM$ = IOM_TBL.PTR$(IOM#);
     1282     5473    5                          IOM.COUNT = IOM.COUNT + 1;
     1283     5474    5                          IOM.CONNECTS = IOM.CONNECTS + EL$IOERR.CONNECTS.IOM;
     1284     5475    5                       END;
     1285     5476    4                    IF EL$IOERR.THRESH.MPC
     1286     5477    4                       THEN
     1287     5478    5                       DO;
     1288     5479    5                          MPC_NAME = IOM_TBL.PTR$(IOM#)->IOM.DEVNAME(CHAN#);
     1289     5480    6                          DO I = 0 TO NUM_MPCS - 1;
     1290     5481    6                             IF MPC_TBL.DEVNAME(I) = MPC_NAME
     1291     5482    6                                THEN
     1292     5483    7                                DO;
     1293     5484    7                                   MPC$ = MPC_TBL.PTR$(I);
     1294     5485    8                                   DO DCTX = 1 TO TH_MAXDCTX;
     1295     5486    8                                      DCT$ = TH_DCT$(DCTX);
     1296     5487    8                                      DCTPTR.SEGID = %SPCL1SID;
     1297     5488    9                                      IF NI$DCT.DEVNM = MPC_NAME THEN DO;
     1298     5489    9                                         MPC.COUNT = MPC.COUNT + 1;
     1299     5490    9                                         MPC.CONNECTS = NI$DCT.PM.CONNCT;
     1300     5491    9                                         END;  /* IF */
     1301     5492    8                                      END;  /* DO DCTX */
     1302     5493    7                                END;       /* IF                                 */
     1303     5494    6                          END;             /* DO I                               */
     1304     5495    5                       END;                /* IF THRESH.MPC                      */
     1305     5496    4                    IF EL$IOERR.THRESH.CHANNEL
     1306     5497    4                       THEN
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:107  
     1307     5498    5                       DO;
     1308     5499    5                          CHAN$ = IOM_TBL.PTR$(IOM#)->IOM.CHAN$;
     1309     5500    5                          CHAN.CHANS.COUNT(CHAN#) = CHAN.CHANS.COUNT(CHAN#) + 1;
     1310     5501    5                          CHAN.CHANS.CONNECTS(CHAN#) = CHAN.CHANS.CONNECTS(CHAN#) +
     1311     5502    5                                EL$IOERR.CONNECTS.CHANNEL;
     1312     5503    5                       END;                /* IF THRESH.CHANNEL                  */
     1313     5504    4                    IF EL$IOERR.THRESH.DEVICE
     1314     5505    4                       THEN
     1315     5506    5                       DO I = 0 TO NUM_DEVS - 1;
     1316     5507    5                          IF DEV_TBL.DEVNAME(I) = EL$IOERR.DEVNM
     1317     5508    5                             THEN
     1318     5509    6                             DO;
     1319     5510    6                                DEV$ = DEV_TBL.PTR$(I);
     1320     5511    6                                DEV.COUNT(%TH_IOERR) = DEV.COUNT(%TH_IOERR) + 1;
     1321     5512    6                                DEV.CONNECTS = DEV.CONNECTS + EL$IOERR.CONNECTS.DEVICE;
     1322     5513    6                             END;          /* IF                                 */
     1323     5514    5                       END;                /* DO I                               */
     1324     5515    4                   LAST_REQID = EL$IOERR.REQID;
     1325     5516    4                 CASE(ELSE);
     1326     5517                                                /* UNIMPLIMENTED AS YET               */
     1327     5518    4              END;                         /* DO CASE TH_ITYPE                   */
     1328     5519    4              DO NEVER;
     1329     5520    4      EOF_LBL:   EOF_FLG = %TRUE;
     1330     5521    4              END;                         /* DO NEVER                           */
     1331     5522    3           END;                            /* DO WHILE NOT EOF_FLG               */
     1332     5523    2   KEEP_GOING:
     1333     5524
     1334     5525                                           /* BUILD KEYS AND WRITE RECORDS TO DEVHIST */
     1335     5526    2           IF NOT DCBADDR(DCBNUM(M$DEVHIST))->F$DCB.FCD
     1336     5527    2              THEN CALL M$OPEN(OPEN_DEVHIST) ALTRET(ALT);
     1337     5528
     1338     5529                                                /* WRITE HEAD RECORD BACK             */
     1339     5530    2           WRITE_DEVHIST.KEY_ = VECTOR(HEAD_KEY);
     1340     5531    2           WRITE_DEVHIST.BUF_ = VECTOR(TH_HEAD);
     1341     5532    2           WRITE_DEVHIST.BUF_.BOUND = SIZEV(TH_HEAD) - ((200 - LAST_INDX) * 8);
     1342     5533    2           CALL M$WRITE(WRITE_DEVHIST);
     1343     5534
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:108  
     1344     5535    2           KEY8.UTS = UTS;
     1345     5536    2           WRITE_DEVHIST.KEY_ = VECTOR(KEY8);
     1346     5537
     1347     5538                                                /* WRITE IOM AND CHANNEL RECORDS      */
     1348     5539    3           DO I = 0 TO NUM_IOMS - 1;
     1349     5540    3              TH_IOM = IOM_TBL.PTR$(I)->IOM;
     1350     5541    3              KEY8.TXT = IOM_TBL.DEVNAME(I);
     1351     5542    3              WRITE_DEVHIST.BUF_ = VECTOR(TH_IOM);
     1352     5543    3              CALL M$WRITE(WRITE_DEVHIST);
     1353     5544    3              TH_CHAN = IOM_TBL.PTR$(I)->IOM.CHAN$->CHAN;
     1354     5545    3              CALL BINCHAR(CHN#,I);
     1355     5546    3              CALL INSERT(KEY8.TXT,0,4,'CH',CHN#);
     1356     5547    3              WRITE_DEVHIST.BUF_ = VECTOR(TH_CHAN);
     1357     5548    3              CALL M$WRITE(WRITE_DEVHIST);
     1358     5549    3           END;                            /* DO I                               */
     1359     5550
     1360     5551                                                /* WRITE FEP RECORDS                  */
     1361     5552    3           DO I = 0 TO NUM_FEPS - 1;
     1362     5553    3              KEY8.TXT = FEP_TBL.DEVNAME(I);
     1363     5554    3              TH_FEP = FEP_TBL.PTR$(I)->FEP;
     1364     5555    3              WRITE_DEVHIST.BUF_ = VECTOR(TH_FEP);
     1365     5556    3              CALL M$WRITE(WRITE_DEVHIST);
     1366     5557    3           END;                            /* DO I                               */
     1367     5558
     1368     5559                                                /* WRITE MPC RECORDS                  */
     1369     5560    3           DO I = 0 TO NUM_MPCS - 1;
     1370     5561    3              TH_MPC = MPC_TBL.PTR$(I)->MPC;
     1371     5562    3              KEY8.TXT = MPC_TBL.DEVNAME(I);
     1372     5563    3              WRITE_DEVHIST.BUF_ = VECTOR(TH_MPC);
     1373     5564    3              WRITE_DEVHIST.BUF_.BOUND = SIZEV(MPC) - (8 * (33 - TH_MPC.NUMDEVS));
     1374     5565    3              CALL M$WRITE(WRITE_DEVHIST);
     1375     5566    3           END;                            /* DO I                               */
     1376     5567
     1377     5568                                                /* WRITE DEVICE RECORDS               */
     1378     5569    3           DO I = 0 TO NUM_DEVS - 1;
     1379     5570    3              KEY8.TXT = DEV_TBL.DEVNAME(I);
     1380     5571    3              TH_DEV = DEV_TBL.PTR$(I)->DEV;
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:109  
     1381     5572    3              WRITE_DEVHIST.BUF_ = VECTOR(TH_DEV);
     1382     5573    3              CALL M$WRITE(WRITE_DEVHIST);
     1383     5574    3           END;                            /* DO I                               */
     1384     5575    2           CALL XUD$UTS_ADJ_25TH(UTS, UTS, %UTS_25TH_DAY#);
     1385     5576    2        END;                           /* DO WHILE (UTS <= LAST_UTS) */
     1386     5577             /* Update UTS record */
     1387     5578    1        WRITE_DEVHIST.KEY_ = VECTOR(UTS_KEY);
     1388     5579    1        TH_UTS.ERRLOG_UTS = CURUTS;
     1389     5580    1        WRITE_DEVHIST.BUF_ = VECTOR(TH_UTS);
     1390     5581    1        CALL M$WRITE(WRITE_DEVHIST) ALTRET(ALT);
     1391     5582    1        CALL THG$CLOSEXSA;
     1392     5583    1        CALL M$CLOSE (CLOSE_DEV) ALTRET(ALT);
     1393     5584             /* Delete records in :DEVHIST that are more than 30 days old  */
     1394     5585    1        IF TH_REBUILD
     1395     5586    2           THEN DO;
     1396     5587    2                 CALL M$OPEN (OPEN_DEV) ALTRET(ALT);
     1397     5588    2                 CALL M$OPEN (OPEN_NEWDEV) ALTRET(ALT);
     1398     5589    2                 CALL M$TIME (CUR_UTS) ALTRET(ALT);
     1399     5590    2                 CALL XUD$UTS_ADJ_25TH(OLDEST_UTS, CURUTS, -(30*%UTS_25TH_DAY#));
     1400     5591    2                 CALL M$PFIL (PFIL_DEVHIST) ALTRET(ALT);
     1401     5592    3                 DO I = 1 TO 3;
     1402     5593    3                    CALL M$READ (RD_DEVHIST) ALTRET(END_OF_DEV);
     1403     5594    3                    WRITE_NEWDEV.KEY_ = VECTOR(HD_KEY);
     1404     5595    3                    WRITE_NEWDEV.BUF_.BOUND = DCBADDR(DCBNUM(M$DEVHIST))->F$DCB.ARS - 1
              5595                             ;
     1405     5596    3                    CALL M$WRITE (WRITE_NEWDEV);
     1406     5597    3                 END;
     1407     5598    2                 CALL M$READ(RD_DEVHIST) ALTRET(END_OF_DEV);
     1408     5599    2                 WRITE_NEWDEV.KEY_ = VECTOR(HD_KEY);
     1409     5600    2                 WRITE_NEWDEV.BUF_.BOUND =
     1410     5601    2                   DCBADDR(DCBNUM(M$DEVHIST)) -> F$DCB.ARS - 1;
     1411     5602    2                 ADDR(REC_BUF) -> TH$UTS.OLDEST_UTS = OLDEST_UTS;
     1412     5603    2                 CALL M$WRITE(WRITE_NEWDEV);  /* WRITE UTS RECORD */
     1413     5604    2        READ_DEVHIST:
     1414     5605    2                 CALL M$READ (READ_DEVHIST) ALTRET(END_OF_DEV);
     1415     5606    2                 IF OLDEST_UTS > RD_KEY.UTS
     1416     5607    2                    THEN;
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:110  
     1417     5608    3                    ELSE DO;
     1418     5609    3                       WRITE_NEWDEV.KEY_ = VECTOR(RD_KEY);
     1419     5610    3                       WRITE_NEWDEV.BUF_.BOUND = DCBADDR(DCBNUM(M$DEVHIST))->F$DCB.ARS
              5610                                - 1;
     1420     5611    3                       CALL M$WRITE(WRITE_NEWDEV);
     1421     5612    3                    END;
     1422     5613    2                 GOTO READ_DEVHIST;
     1423     5614    2        END_OF_DEV:
     1424     5615    2                 CALL M$CLOSE(CLOSE_DEVHIST) ALTRET(ALT);
     1425     5616    2                 CALL M$CLOSE(CLOSE_NEWDEV) ALTRET(ALT);
     1426     5617    2                 TH_REBUILD = '0'B;
     1427     5618    2           END;
     1428     5619    1        RETURN;
     1429     5620    1   NO_MEM:
     1430     5621    1        CALL THM$ERRMSG(%E$TH_NO_MEM);
     1431     5622    1        ALTRETURN;
     1432     5623             /*E* ERROR: THE-E$TH_NO_MEM-0
     1433     5624                  MESSAGE: NO MEMORY FOR ELAN TO BUILD INTERNAL TABLES -
     1434     5625                           UNABLE TO BUILD HISTORY FILE - ELAN ABORTING */
     1435     5626    1   OPEN_ERR:
     1436     5627    1        CALL THM$ERRMSG(%E$TH_BAD_CONFIG);
     1437     5628    1        ALTRETURN;
     1438     5629             /*E* ERROR: THE-E$TH_BAD_CONFIG-0
     1439     5630                  MESSAGE: UNABLE TO ACCESS :CONFIG FILE - ELAN ABORTING */
     1440     5631    1   ALT:
     1441     5632    1        CALL THM$ERRMSG;
     1442     5633    1        ALTRETURN;
     1443     5634    1   END THE$PROCESS;
     1444     5635        %EOD;

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:111  
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   TH_PERR_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   TH$HIST.:E05TOU  is referenced.
   TD$STRUCT.:E05TOU  is referenced.
   EL$TABLES.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THE$PROCESS.

   Procedure THE$PROCESS requires 2493 words for executable code.
   Procedure THE$PROCESS requires 4194 words of local(AUTO) storage.

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:112  

 Object Unit name= THE$PROCESS                                File name= THE$ELAN.:E05TOU
 UTS= JUL 30 '97 06:09:10.48 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$ERRLOG
    2   DCB   even  none     0      0  M$DEVHIST
    3   DCB   even  none     0      0  M$NEWDEV
    4   Data  even  none  1119   2137  THE$PROCESS
    5  RoData even  UTS    295    447  THE$PROCESS
    6   Proc  even  none  2493   4675  THE$PROCESS
    7  RoData even  none    66    102  THE$PROCESS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     6      0   yes    yes     yes      Std        0  THE$PROCESS

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    4      1  NUM_IOMS                           4      2  NUM_MPCS
    4      3  NUM_DEVS                           4      4  NUM_FEPS
    4      6  UTS
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:113  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       4 THG$GETREC
         yes           Std       0 THD$DEVHIST
         yes           Std       1 THM$ERRMSG
 yes     yes           Std       3 XUD$UTS_DIFF_SEC
 yes     yes           Std       1 THE$INIT
 yes     yes           Std       3 XUD$UTS_ADJ_25TH
 yes     yes           Std       0 THG$CLOSEXSA
 yes     yes           Std       1 THG$OPENXSA
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TH_CONSTRAINTS                        TH_DEFAULT
     TH_PHONY_GHOST                        TH_REBUILD                            TH_DEVHIST_MODE
     TH_RECORD                             TH_INFO                               TH_ITYPE
     TH_MAXDCTX                            TH_DCT$                               TH_XSA_BUF_VECTOR
     TH_M$ERRLOG$                          DEVHIST_ACCT                          M$ERRLOG
     M$DEVHIST                             M$NEWDEV                              IOM_TBL$
     MPC_TBL$                              FEP_TBL$                              DEV_TBL$
     B$TCB$                                B$JIT$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:114  


      452        1        /*M* THE$PROCESS - PROCESS DAILY ERRLOG AND GENERATE DEVHIST */
      453        2        /*T***********************************************************/
      454        3        /*T*                                                         */
      455        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      456        5        /*T*                                                         */
      457        6        /*T***********************************************************/
      458        7        THE$PROCESS: PROC ALTRET;

      7  6 000000   000000 700200 xent  THE$PROCESS  TSX0  ! X66_AUTO_0
         6 000001   010142 000000                    ZERO    4194,0

      459        8        /**/
      460        9        /* INCLUDE FILES */
      461       10        %INCLUDE CP_6;
      462       91        %INCLUDE B$JIT;
      463      381        %INCLUDE B_SEGIDS_C;
      464      920        %INCLUDE NI$TABLES;
      465     1136        %INCLUDE B_ERRORS_C;
      466     2263        %INCLUDE F$DCB;
      467     2312        %INCLUDE EL$TABLES;
      468     2635        %INCLUDE TD$STRUCT;
      469     2736        %INCLUDE TH$HIST;
      470     2831        %INCLUDE TH_DATA_R;
      471     2909        %INCLUDE TH_SUBS_C;
      472     3291        %INCLUDE TH_PERR_C;
      473     3332        %INCLUDE XUD_UTS_M;
      474     3414        /**/
      475     3415        /* ENTRY DEFS */
      476     3416    1   DCL THG$GETREC ENTRY(4) ALTRET;
      477     3417    1   DCL THG$OPENXSA ENTRY(1) ALTRET;
      478     3418    1   DCL THG$CLOSEXSA ENTRY ALTRET;
      479     3419    1   DCL THE$INIT ENTRY(1) ALTRET;
      480     3420    1   DCL THM$ERRMSG ENTRY(1);
      481     3421    1   DCL THD$DEVHIST ENTRY;
      482     3422        /**/
      483     3423        /* DCBS */
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:115  
      484     3424    1   DCL M$ERRLOG DCB;
      485     3425    1   DCL M$DEVHIST DCB;
      486     3426    1   DCL M$NEWDEV DCB;
      487     3427        /**/
      488     3428        /* VARS */
      489     3429    1   DCL EOF_FLG BIT(1);
      490     3430    1   DCL FOUND BIT(1);
      491     3431    1   DCL LAST_INDX UBIN;
      492     3432    1   DCL OLD_INDX UBIN WORD;
      493     3433    1   DCL LAST_REQID UBIN STATIC INIT(0);
      494     3434    1   DCL IOM$ PTR;
      495     3435    1   DCL MPC$ PTR;
      496     3436    1   DCL DEV$ PTR;
      497     3437    1   DCL FEP$ PTR;
      498     3438    1   DCL CHAN$ PTR;
      499     3439    1   DCL IOM# UBIN(3);
      500     3440    1   DCL CHAN# UBIN(9);
      501     3441    1   DCL ZERO CHAR(8) CONSTANT INIT('0       '); /* USED FOR GETREC CALLS          */
      502     3442    1   DCL ONE CHAR(8) CONSTANT INIT('1       ');
      503     3443    1   DCL TWO CHAR(8) CONSTANT INIT('2       ');
      504     3444    1   DCL THREE CHAR(8) CONSTANT INIT('3       '); /* USED FOR GETREC CALLS           */
      505     3445    1   DCL WORDBASE UBIN WORD BASED;
      506     3446    1   DCL NUM_IOMS UBIN WORD STATIC SYMDEF;
      507     3447    1   DCL NUM_MPCS UBIN WORD STATIC SYMDEF;
      508     3448    1   DCL NUM_DEVS UBIN WORD STATIC SYMDEF;
      509     3449    1   DCL NUM_FEPS UBIN WORD STATIC SYMDEF;
      510     3450    1   DCL I SBIN WORD;
      511     3451    1   DCL J SBIN;
      512     3452    1   DCL K SBIN;
      513     3453    1   DCL INDX UBIN;
      514     3454    1   DCL DCTX UBIN WORD;
      515     3455    1   DCL DCT$ PTR;
      516     3456    1   DCL 1 DCTPTR REDEF DCT$,
      517     3457    1         2 OFFSET UBIN(18) UNAL,
      518     3458    1         2 * BIT(6) UNAL,
      519     3459    1         2 SEGID BIT(12) UNAL;
      520     3460        %NI$DCT (NAME=NI$DCT,STCLASS="BASED(DCT$)");
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:116  
      521     3508    1   DCL NUM_NEW_COMPS UBIN WORD STATIC INIT(0);
      522     3509    1   DCL MPC_NAME CHAR(8);
      523     3510    1   DCL IOM_TBL$ PTR SYMREF;
      524     3511    1   DCL MPC_TBL$ PTR SYMREF;
      525     3512    1   DCL FEP_TBL$ PTR SYMREF;
      526     3513    1   DCL DEV_TBL$ PTR SYMREF;
      527     3514    1   DCL CHN# CHAR(2);
      528     3515    1   DCL UTS UBIN WORD STATIC SYMDEF;
      529     3516    1   DCL CURUTS UBIN WORD STATIC;
      530     3517    1   DCL FIRST_UTS UBIN WORD STATIC INIT(0);
      531     3518    1   DCL LAST_UTS UBIN WORD STATIC INIT(0);
      532     3519    1   DCL DEVHIST_UTS UBIN WORD STATIC INIT(0);
      533     3520    1   DCL OLDEST_UTS UBIN WORD STATIC INIT(0);  /* UTS OF OLDEST RECORD */
      534     3521    1   DCL B$TCB$ PTR SYMREF;
      535     3522    1   DCL B$JIT$ PTR SYMREF;
      536     3523    1   DCL HEAD_KEY BIT(18) CONSTANT INIT('001000'O);
      537     3524    1   DCL THRESH_KEY BIT(18) CONSTANT INIT('001001'O);
      538     3525    1   DCL MAINT_KEY BIT(18) CONSTANT INIT('001002'O);
      539     3526    1   DCL UTS_KEY BIT(18) CONSTANT INIT('001003'O);
      540     3527        /**/
      541     3528    1   DCL HD_KEY BIT(18) STATIC;
      542     3529    1   DCL 1 RD_KEY STATIC,
      543     3530    1         2 COUNT UBIN BYTE UNAL INIT(12),
      544     3531    1         2 TXT CHAR(8) UNAL INIT(' '),
      545     3532    1         2 UTS UBIN WORD UNAL INIT(0);
      546     3533    1   DCL 1 KEY8 STATIC,
      547     3534    1         2 COUNT UBIN BYTE UNAL INIT(12),
      548     3535    1         2 TXT CHAR(8) UNAL INIT(' '),
      549     3536    1         2 UTS UBIN WORD UNAL INIT(0);
      550     3537        /**/
      551     3538    1   DCL 1 INFO STATIC ALIGNED,
      552     3539    1         2 BOUND UBIN(20) UNAL,
      553     3540    1         2 * BIT(16),
      554     3541    1         2 PTR$ PTR;
      555     3542    1   DCL 1 HDR STATIC ALIGNED,
      556     3543    1         2 BOUND UBIN(20) UNAL,
      557     3544    1         2 * BIT(16),
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:117  
      558     3545    1         2 PTR$ PTR;
      559     3546    1   DCL TEMP_UTS UBIN;
      560     3547        /**/
      561     3548        /* MACRO DEFINITIONS */
      562     3549        %MACRO TBL (NAME=JUNK,STCLASS=BASED);
      563     3550        DCL 1 NAME(0:0) STCLASS ALIGNED,
      564     3551              2 DEVNAME CHAR(8),
      565     3552              2 PTR$ PTR;
      566     3553        %MEND;
      567     3554        /**/
      568     3555        /* MACRO INVOCATIONS */
      569     3556        %TD$HEAD (NAME=TD$HEAD,NUMDEV#=200);
      570     3592        %TD$HEAD (NAME=TH$HEAD,NUMDEV#=200);
      571     3628        %TD$HEAD (NAME=TD_HEAD,STCLASS=AUTO,NUMDEV#=200);
      572     3664        %TD$HEAD (NAME=TH_HEAD,STCLASS=AUTO,NUMDEV#=200);
      573     3700        %TH$DEV (NAME=DEV,STCLASS="BASED(DEV$)");
      574     3721        %TH$IOM (NAME=IOM,STCLASS="BASED(IOM$)");
      575     3732        %TH$MPC (NAME=MPC,STCLASS="BASED(MPC$)",NUMDEV#=32);
      576     3753        %TH$FEP (NAME=FEP,STCLASS="BASED(FEP$)");
      577     3760        %TH$CHAN (NAME=CHAN,STCLASS="BASED(CHAN$)");
      578     3767        %TH$UTS (NAME=TH$UTS);
      579     3772        /**/
      580     3773        %TH$THRESH (NAME=TH$THRESH,NUMDEV#=200);
      581     3779        %TH$THRESH (NAME=TH_THRESH,STCLASS=AUTO,NUMDEV#=200);
      582     3785        %TH$THRESH (NAME=TEMP_THRESH,STCLASS=AUTO,NUMDEV#=200);
      583     3791        %TH$MAINT (NAME=TH$MAINT,NUMDEV#=200);
      584     3796        %TH$MAINT (NAME=TH_MAINT,STCLASS=AUTO,NUMDEV#=200);
      585     3801        %TH$MAINT (NAME=TEMP_MAINT,STCLASS=AUTO,NUMDEV#=200);
      586     3806        /**/
      587     3807        %TH$MPC (NAME=TH_MPC,STCLASS=AUTO,NUMDEV#=32);
      588     3828        %TH$IOM (NAME=TH_IOM,STCLASS=AUTO);
      589     3839        %TH$FEP (NAME=TH_FEP,STCLASS=AUTO);
      590     3846        %TH$DEV (NAME=TH_DEV,STCLASS=AUTO);
      591     3867        %TH$CHAN (NAME=TH_CHAN,STCLASS=AUTO);
      592     3874        %TH$UTS (NAME=TH_UTS,STCLASS=AUTO);
      593     3879        /**/
      594     3880        %EL$ENTRY (NAME=REC_BUF,
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:118  
      595     3881                   INFOSZ=4096,
      596     3882                   STCLASS=STATIC);
      597     3886        %EL$IOERR (STCLASS="BASED(TH_INFO.PTR$)");
      598     3896        %EL$EDAC (STCLASS="BASED(TH_INFO.PTR$)");
      599     3905        %EL$FEPERR (STCLASS="BASED(TH_INFO.PTR$)");
      600     3984        %EL$PROCERR (STCLASS="BASED(TH_INFO.PTR$)");
      601     3994        %EL$SPURINT (STCLASS="BASED(TH_INFO.PTR$)");
      602     3998        %EL$FEPFLT (STCLASS="BASED(TH_INFO.PTR$)");
      603     4001        /**/
      604     4002        %TBL (NAME=IOM_TBL,STCLASS="BASED(IOM_TBL$)");
      605     4007        %TBL (NAME=MPC_TBL,STCLASS="BASED(MPC_TBL$)");
      606     4012        %TBL (NAME=FEP_TBL,STCLASS="BASED(FEP_TBL$)");
      607     4017        %TBL (NAME=DEV_TBL,STCLASS="BASED(DEV_TBL$)");
      608     4022        /**/
      609     4023        %B$TCB;
      610     4026        %B$ALT;
      611     4034        /**/
      612     4035        %XUD$UTS_ENTRIES;
      613     4067        %XUD_UTS_EQU;
      614     4078        /**/
      615     4079        /* FPT DEFINITIONS */
      616     4080        %VLP_ACCT (FPTN=SYSTAC,
      617     4081                   STCLASS=CONSTANT,
      618     4082                   ACCT=':SYSTAC');
      619     4095        %FPT_OPEN (FPTN=OPEN_DEVHIST,
      620     4096                   STCLASS=CONSTANT,
      621     4097                   DCB=M$DEVHIST,
      622     4098                   NAME=DEVHIST,
      623     4099                   ACCT=DEVHIST_ACCT,
      624     4100                   FUN=UPDATE,
      625     4101                   EXIST=OLDFILE,
      626     4102                   ASN=FILE,
      627     4103                   ACS=DIRECT,
      628     4104                   ORG=KEYED);
      629     4213        %FPT_WRITE (FPTN=WRITE_DEVHIST,
      630     4214                    DCB=M$DEVHIST);
      631     4245        %FPT_CLOSE (FPTN=CLOSE_DEVHIST,
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:119  
      632     4246                    STCLASS=CONSTANT,
      633     4247                    DCB=M$DEVHIST,
      634     4248                    DISP=SAVE);
      635     4290        %FPT_OPEN (FPTN=OPEN_NEWDEV,
      636     4291                   STCLASS=CONSTANT,
      637     4292                   DCB=M$NEWDEV,
      638     4293                   NAME=DEVHIST,
      639     4294                   ACCT=DEVHIST_ACCT,
      640     4295                   FUN=CREATE,
      641     4296                   EXIST=NEWFILE,
      642     4297                   ASN=FILE,
      643     4298                   SHARE=NONE,
      644     4299                   ACS=DIRECT,
      645     4300                   ACCESS=ACSLIST,
      646     4301                   ACSVEH=VEHLIST,
      647     4302                   ORG=KEYED);
      648     4411        %FPT_CLOSE (FPTN=CLOSE_NEWDEV,
      649     4412                    STCLASS=CONSTANT,
      650     4413                    DCB=M$NEWDEV,
      651     4414                    DISP=SAVE);
      652     4456        %FPT_WRITE (FPTN=WRITE_NEWDEV,
      653     4457                    DCB=M$NEWDEV,
      654     4458                    BUF=REC_BUF);
      655     4489        %FPT_OPEN (FPTN=OPEN_DEV,
      656     4490                   STCLASS=CONSTANT,
      657     4491                   DCB=M$DEVHIST,
      658     4492                   NAME=DEVHIST,
      659     4493                   ACCT=DEVHIST_ACCT,
      660     4494                   FUN=IN,
      661     4495                   EXIST=OLDFILE,
      662     4496                   ASN=FILE,
      663     4497                   ACS=DIRECT,
      664     4498                   SHARE=IN,
      665     4499                   ORG=KEYED);
      666     4608        %FPT_CLOSE (FPTN=CLOSE_DEV,
      667     4609                    STCLASS=CONSTANT,
      668     4610                    DCB=M$DEVHIST,
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:120  
      669     4611                    DISP=SAVE);
      670     4653        %VLP_NAME (FPTN=DEVHIST,
      671     4654                   STCLASS=CONSTANT,
      672     4655                   NAME=':DEVHIST');
      673     4682        %FPT_TIME (FPTN=CUR_UTS,
      674     4683                   STCLASS=CONSTANT,
      675     4684                   SOURCE=CLOCK,
      676     4685                   DEST=UTS,
      677     4686                   TSTAMP=CURUTS);
      678     4705        %FPT_PFIL (FPTN=PFIL_DEVHIST,DCB=M$DEVHIST,BOF=YES);
      679     4720        %FPT_READ (FPTN=READ_DEVHIST,
      680     4721                   DCB = M$DEVHIST,
      681     4722                   BUF=REC_BUF,
      682     4723                   KEY=RD_KEY,
      683     4724                   KEYR=YES);
      684     4763        %FPT_READ (FPTN=RD_DEVHIST,
      685     4764                   DCB=M$DEVHIST,
      686     4765                   KEY=HD_KEY,
      687     4766                   BUF=REC_BUF,
      688     4767                   KEYR=YES);
      689     4806        %VLP_ATTR(FPTN=ACSLIST);
      690     4820        %VLP_ACCESS (READ=YES,EXEC=YES,ACCT='?',LAST=";");
      691     4837        %VLP_ATTR(FPTN=VEHLIST);
      692     4851        %VLP_ACSVEH(READ=YES,UPD=YES,WNEW=YES,VEHICLE='SYSCON');
      693     4868        %VLP_ACSVEH(READ=YES,UPD=YES,WNEW=YES,VEHICLE='ELAN',LAST=";");
      694     4885        /**/
      695     4886        %EJECT;
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:121  
      696     4887    1        NUM_NEW_COMPS = 0;

   4887  6 000002   000005 450000 4                  STZ     NUM_NEW_COMPS

      697     4888    1        TH_M$ERRLOG$ = DCBADDR(DCBNUM(M$ERRLOG));

   4888  6 000003   000000 236007 xsym               LDQ     M$ERRLOG,DL
         6 000004   000000 470400 7                  LDP0    0
         6 000005   000000 471500                    LDP1    0,,PR0
         6 000006   100000 236106                    LDQ     0,QL,PR1
         6 000007   000000 756000 xsym               STQ     TH_M$ERRLOG$

      698     4889                            /* READ DEVHIST HEAD - IF NOT THERE BUILD A BLANK ONE     */
      699     4890    1        CALL THG$GETREC(%DEVHIST,ZERO) ALTRET(NO_HEAD);

   4890  6 000010   000001 630400 7                  EPPR0   1
         6 000011   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 000012   000000 701000 xent               TSX1    THG$GETREC
         6 000013   000025 702000 6                  TSX2    NO_HEAD

      700     4891    1        IF B$JIT.MODE = %M_INT# AND TH_DEVHIST_MODE = 0

   4891  6 000014   000000 470400 xsym               LDP0    B$JIT$
         6 000015   000000 236100                    LDQ     0,,PR0
         6 000016   740000 376003                    ANQ     -16384,DU
         6 000017   140000 116003                    CMPQ    49152,DU
         6 000020   000024 601000 6                  TNZ     s:4893
         6 000021   000000 235000 xsym               LDA     TH_DEVHIST_MODE
         6 000022   000024 601000 6                  TNZ     s:4893

      701     4892    1           THEN RETURN;    /* :DEVHIST FILE EXISTS - NO ACTION REQUIRED */

   4892  6 000023   000000 702200 xent               TSX2  ! X66_ARET

      702     4893    2        DO NEVER;

   4893  6 000024   000044 710000 6                  TRA     s:4908
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:122  

      703     4894    2   NO_HEAD:
      704     4895    2           IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOFILE

   4895  6 000025   000000 470400 xsym  NO_HEAD      LDP0    B$TCB$
         6 000026   000000 471500                    LDP1    0,,PR0
         6 000027   100102 236100                    LDQ     66,,PR1
         6 000030   377770 376007                    ANQ     131064,DL
         6 000031   001610 116007                    CMPQ    904,DL
         6 000032   000040 601000 6                  TNZ     s:4904

      705     4896    3              THEN DO;

      706     4897    3                CALL THD$DEVHIST;

   4897  6 000033   000002 631400 xsym               EPPR1   B_VECTNIL+2
         6 000034   000000 701000 xent               TSX1    THD$DEVHIST
         6 000035   000000 011000                    NOP     0

      707     4898    3                TH_REBUILD = '0'B;  /* TURN OFF REBUILD FLAG-  SINCE */

   4898  6 000036   000000 450000 xsym               STZ     TH_REBUILD

      708     4899                                         /* THIS IS A NEW FILE, NO NEED TO */
      709     4900                                         /* SIZE IT DOWN                   */
      710     4901    3              END;

   4901  6 000037   000044 710000 6                  TRA     s:4908

      711     4902    2              ELSE
      712     4903    3              DO;

      713     4904    3                 CALL THM$ERRMSG;

   4904  6 000040   000002 631400 xsym               EPPR1   B_VECTNIL+2
         6 000041   000000 701000 xent               TSX1    THM$ERRMSG
         6 000042   000000 011000                    NOP     0
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:123  

      714     4905    3                 ALTRETURN;

   4905  6 000043   000000 702200 xent               TSX2  ! X66_AALT

      715     4906    3              END;                         /* IF                                 */
      716     4907    2        END;                               /* DO NEVER                           */

      717     4908    1        TH_HEAD = TH_RECORD.PTR$->TH$HEAD;

   4908  6 000044   000001 470400 xsym               LDP0    TH_RECORD+1
         6 000045   000100 100500                    MLR     fill='000'O
         6 000046   000000 003210                    ADSC9   0,,PR0                   cn=0,n=1672
         6 000047   200672 003210                    ADSC9   TH_HEAD,,AUTO            cn=0,n=1672

      718     4909    1        CALL THG$GETREC(%DEVHIST, THREE);  /* READ UTS RECORD */

   4909  6 000050   000003 630400 7                  EPPR0   3
         6 000051   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 000052   000000 701000 xent               TSX1    THG$GETREC
         6 000053   000000 011000                    NOP     0

      719     4910    1        TH_UTS = TH_RECORD.PTR$ -> TH$UTS;

   4910  6 000054   000001 470400 xsym               LDP0    TH_RECORD+1
         6 000055   000100 100500                    MLR     fill='000'O
         6 000056   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         6 000057   210121 000010                    ADSC9   TH_UTS,,AUTO             cn=0,n=8

      720     4911    1        IF DCBADDR(DCBNUM(M$DEVHIST)) -> F$DCB.ARS < 8

   4911  6 000060   000000 236007 xsym               LDQ     M$DEVHIST,DL
         6 000061   000000 471400 7                  LDP1    0
         6 000062   100000 473500                    LDP3    0,,PR1
         6 000063   300000 474506                    LDP4    0,QL,PR3
         6 000064   400000 235100                    LDA     0,,PR4
         6 000065   000010 115007                    CMPA    8,DL
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:124  
         6 000066   000103 605000 6                  TPL     s:4919

      721     4912    2           THEN DO;    /* UTS RECORD IS PRE-E02 */

      722     4913    2             CALL M$CLOSE(CLOSE_DEV);

   4913  6 000067   000370 630400 5                  EPPR0   CLOSE_DEV
         6 000070   050001 713400                    CLIMB   close
         6 000071   406000 401760                    pmme    nvectors=13

      723     4914    2             CALL THD$DEVHIST;               /* REBUILD :DEVHIST FILE */

   4914  6 000072   000002 631400 xsym               EPPR1   B_VECTNIL+2
         6 000073   000000 701000 xent               TSX1    THD$DEVHIST
         6 000074   000000 011000                    NOP     0

      724     4915    2             TH_HEAD = TH_RECORD.PTR$ -> TH$HEAD;

   4915  6 000075   000001 470400 xsym               LDP0    TH_RECORD+1
         6 000076   000100 100500                    MLR     fill='000'O
         6 000077   000000 003210                    ADSC9   0,,PR0                   cn=0,n=1672
         6 000100   200672 003210                    ADSC9   TH_HEAD,,AUTO            cn=0,n=1672

      725     4916    2             TH_REBUILD = '0'B;

   4916  6 000101   000000 450000 xsym               STZ     TH_REBUILD

      726     4917    2             GOTO READ_CONFIG_HEAD;

   4917  6 000102   000137 710000 6                  TRA     READ_CONFIG_HEAD

      727     4918    2           END;
      728     4919    1        IF TH_DEVHIST_MODE = %MIDNITE_GHOST

   4919  6 000103   000000 235000 xsym               LDA     TH_DEVHIST_MODE
         6 000104   000003 115007                    CMPA    3,DL
         6 000105   000137 601000 6                  TNZ     READ_CONFIG_HEAD
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:125  

      729     4920    2           THEN DO;

      730     4921    2             CALL M$TIME(CUR_UTS);

   4921  6 000106   000432 630400 5                  EPPR0   CUR_UTS
         6 000107   020004 713400                    CLIMB   8196
         6 000110   402000 401760                    pmme    nvectors=5

      731     4922                         /* IS OLDEST RECORD > 30 DAYS OLD? */
      732     4923    2             CALL XUD$UTS_ADJ_25TH(TEMP_UTS, TH_UTS.OLDEST_UTS, (30*%UTS_25TH_DAY#));

   4923  6 000111   000006 236000 7                  LDQ     6
         6 000112   210126 756100                    STQ     TH_UTS+5,,AUTO
         6 000113   210121 630500                    EPPR0   TH_UTS,,AUTO
         6 000114   210125 450500                    STP0    TH_UTS+4,,AUTO
         6 000115   200027 631500                    EPPR1   TEMP_UTS,,AUTO
         6 000116   210124 451500                    STP1    TH_UTS+3,,AUTO
         6 000117   210124 630500                    EPPR0   TH_UTS+3,,AUTO
         6 000120   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 000121   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         6 000122   000000 011000                    NOP     0

      733     4924    2             IF TEMP_UTS > CURUTS

   4924  6 000123   000007 236000 4                  LDQ     CURUTS
         6 000124   200027 116100                    CMPQ    TEMP_UTS,,AUTO
         6 000125   000135 603000 6                  TRC     s:4931

      734     4925    3                THEN DO;      /* NO- RETURN */

      735     4926    3                  CALL M$CLOSE(CLOSE_DEV) ALTRET(ALT);

   4926  6 000126   000370 630400 5                  EPPR0   CLOSE_DEV
         6 000127   450001 713400                    CLIMB   alt,close
         6 000130   406000 401760                    pmme    nvectors=13
         6 000131   004671 702000 6                  TSX2    ALT
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:126  

      736     4927    3                  TH_REBUILD = '0'B;

   4927  6 000132   000000 450000 xsym               STZ     TH_REBUILD

      737     4928    3                  TH_DEVHIST_MODE = 0;

   4928  6 000133   000000 450000 xsym               STZ     TH_DEVHIST_MODE

      738     4929    3                  RETURN;

   4929  6 000134   000000 702200 xent               TSX2  ! X66_ARET

      739     4930    3                END;
      740     4931    2                ELSE TH_REBUILD = '1'B;   /* YES- SET REBUILD FLAG */

   4931  6 000135   400000 236003                    LDQ     -131072,DU
         6 000136   000000 756000 xsym               STQ     TH_REBUILD

      741     4932    2           END;

      742     4933
      743     4934                                 /* READ HEADER FROM CONFIG FILE AND SET UP VALUES    */
      744     4935    1   READ_CONFIG_HEAD:
      745     4936    1        CALL THG$GETREC(%CONFIG,ZERO) ALTRET(OPEN_ERR);

   4936  6 000137   000007 630400 7     READ_CONFIG* EPPR0   7
         6 000140   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 000141   000000 701000 xent               TSX1    THG$GETREC
         6 000142   004664 702000 6                  TSX2    OPEN_ERR

      746     4937    1        TD_HEAD = TH_RECORD.PTR$->TD$HEAD;

   4937  6 000143   000001 470400 xsym               LDP0    TH_RECORD+1
         6 000144   000100 100500                    MLR     fill='000'O
         6 000145   000000 003210                    ADSC9   0,,PR0                   cn=0,n=1672
         6 000146   200030 003210                    ADSC9   TD_HEAD,,AUTO            cn=0,n=1672
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:127  

      747     4938    1        NUM_IOMS = TD_HEAD.NUMIOMS;

   4938  6 000147   200030 236100                    LDQ     TD_HEAD,,AUTO
         6 000150   777777 376007                    ANQ     -1,DL
         6 000151   000001 756000 4                  STQ     NUM_IOMS

      748     4939    1        NUM_MPCS = TD_HEAD.NUMUNITMPCS + TD_HEAD.NUMTAPEMPCS + TD_HEAD.NUMDISKMPCS +

   4939  6 000152   200032 236100                    LDQ     TD_HEAD+2,,AUTO
         6 000153   777777 376007                    ANQ     -1,DL
         6 000154   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 000155   200031 236100                    LDQ     TD_HEAD+1,,AUTO
         6 000156   777777 376007                    ANQ     -1,DL
         6 000157   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 000160   210125 756100                    STQ     TH_UTS+4,,AUTO
         6 000161   200033 236100                    LDQ     TD_HEAD+3,,AUTO
         6 000162   777777 376007                    ANQ     -1,DL
         6 000163   210126 756100                    STQ     TH_UTS+5,,AUTO
         6 000164   210125 236100                    LDQ     TH_UTS+4,,AUTO
         6 000165   210126 036100                    ADLQ    TH_UTS+5,,AUTO
         6 000166   210127 756100                    STQ     TH_UTS+6,,AUTO
         6 000167   200034 236100                    LDQ     TD_HEAD+4,,AUTO
         6 000170   777777 376007                    ANQ     -1,DL
         6 000171   210130 756100                    STQ     TH_UTS+7,,AUTO
         6 000172   210127 236100                    LDQ     TH_UTS+6,,AUTO
         6 000173   210130 036100                    ADLQ    TH_UTS+7,,AUTO
         6 000174   210131 756100                    STQ     TH_UTS+8,,AUTO
         6 000175   200035 236100                    LDQ     TD_HEAD+5,,AUTO
         6 000176   777777 376007                    ANQ     -1,DL
         6 000177   210132 756100                    STQ     TH_UTS+9,,AUTO
         6 000200   210131 236100                    LDQ     TH_UTS+8,,AUTO
         6 000201   210132 036100                    ADLQ    TH_UTS+9,,AUTO
         6 000202   000002 756000 4                  STQ     NUM_MPCS

      749     4940    1                   TD_HEAD.NUMAPMPCS + TD_HEAD.NUMOPCS;
      750     4941    1        NUM_DEVS = TD_HEAD.NUMLPS + TD_HEAD.NUMCRS + TD_HEAD.NUMCPS + TD_HEAD.NUMDPS +
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:128  

   4941  6 000203   200041 236100                    LDQ     TD_HEAD+9,,AUTO
         6 000204   777777 376007                    ANQ     -1,DL
         6 000205   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 000206   200040 236100                    LDQ     TD_HEAD+8,,AUTO
         6 000207   777777 376007                    ANQ     -1,DL
         6 000210   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 000211   210125 756100                    STQ     TH_UTS+4,,AUTO
         6 000212   200042 236100                    LDQ     TD_HEAD+10,,AUTO
         6 000213   777777 376007                    ANQ     -1,DL
         6 000214   210126 756100                    STQ     TH_UTS+5,,AUTO
         6 000215   210125 236100                    LDQ     TH_UTS+4,,AUTO
         6 000216   210126 036100                    ADLQ    TH_UTS+5,,AUTO
         6 000217   210127 756100                    STQ     TH_UTS+6,,AUTO
         6 000220   200043 236100                    LDQ     TD_HEAD+11,,AUTO
         6 000221   777777 376007                    ANQ     -1,DL
         6 000222   210130 756100                    STQ     TH_UTS+7,,AUTO
         6 000223   210127 236100                    LDQ     TH_UTS+6,,AUTO
         6 000224   210130 036100                    ADLQ    TH_UTS+7,,AUTO
         6 000225   210131 756100                    STQ     TH_UTS+8,,AUTO
         6 000226   200044 236100                    LDQ     TD_HEAD+12,,AUTO
         6 000227   777777 376007                    ANQ     -1,DL
         6 000230   210132 756100                    STQ     TH_UTS+9,,AUTO
         6 000231   210131 236100                    LDQ     TH_UTS+8,,AUTO
         6 000232   210132 036100                    ADLQ    TH_UTS+9,,AUTO
         6 000233   210133 756100                    STQ     TH_UTS+10,,AUTO
         6 000234   200045 236100                    LDQ     TD_HEAD+13,,AUTO
         6 000235   777777 376007                    ANQ     -1,DL
         6 000236   210134 756100                    STQ     TH_UTS+11,,AUTO
         6 000237   210133 236100                    LDQ     TH_UTS+10,,AUTO
         6 000240   210134 036100                    ADLQ    TH_UTS+11,,AUTO
         6 000241   210135 756100                    STQ     TH_UTS+12,,AUTO
         6 000242   200046 236100                    LDQ     TD_HEAD+14,,AUTO
         6 000243   777777 376007                    ANQ     -1,DL
         6 000244   210136 756100                    STQ     TH_UTS+13,,AUTO
         6 000245   210135 236100                    LDQ     TH_UTS+12,,AUTO
         6 000246   210136 036100                    ADLQ    TH_UTS+13,,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:129  
         6 000247   210137 756100                    STQ     TH_UTS+14,,AUTO
         6 000250   200047 236100                    LDQ     TD_HEAD+15,,AUTO
         6 000251   777777 376007                    ANQ     -1,DL
         6 000252   210140 756100                    STQ     TH_UTS+15,,AUTO
         6 000253   210137 236100                    LDQ     TH_UTS+14,,AUTO
         6 000254   210140 036100                    ADLQ    TH_UTS+15,,AUTO
         6 000255   000003 756000 4                  STQ     NUM_DEVS

      751     4942    1             TD_HEAD.NUMMTS + TD_HEAD.NUMXXS + TD_HEAD.NUMAPS + TD_HEAD.NUMODS;
      752     4943    1        NUM_FEPS = TD_HEAD.NUMFEPS;

   4943  6 000256   200036 236100                    LDQ     TD_HEAD+6,,AUTO
         6 000257   777777 376007                    ANQ     -1,DL
         6 000260   000004 756000 4                  STQ     NUM_FEPS

      753     4944
      754     4945        /* CHECK FOR NEW COMPONENTS IN THIS :CONFIG FILE - IF SO THEN ADD THIS INFO TO :DEV
              4945        HIST HEAD RECORD */
      755     4946
      756     4947    1        LAST_INDX = TH_HEAD.OD_INDX + TH_HEAD.NUMODS - 1;

   4947  6 000261   200711 236100                    LDQ     TH_HEAD+15,,AUTO
         6 000262   777777 376007                    ANQ     -1,DL
         6 000263   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 000264   200711 236100                    LDQ     TH_HEAD+15,,AUTO
         6 000265   000022 772000                    QRL     18
         6 000266   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 000267   000001 136007                    SBLQ    1,DL
         6 000270   200005 756100                    STQ     LAST_INDX,,AUTO

      757     4948    1        OLD_INDX = LAST_INDX;

   4948  6 000271   200006 756100                    STQ     OLD_INDX,,AUTO

      758     4949    1        IF TH_PHONY_GHOST

   4949  6 000272   000000 234000 xsym               SZN     TH_PHONY_GHOST
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:130  
         6 000273   000277 604000 6                  TMI     DO_GHOST2

      759     4950    1        THEN GOTO DO_GHOST2;
      760     4951    1        IF TH_DEVHIST_MODE ~= %TB_GHOST THEN GOTO BYPASS_CHECK;

   4951  6 000274   000000 235000 xsym               LDA     TH_DEVHIST_MODE
         6 000275   000002 115007                    CMPA    2,DL
         6 000276   003514 601000 6                  TNZ     BYPASS_CHECK

   4951  6 000277                       DO_GHOST2    null
      761     4952                                        /* CHECK FOR IOMS */
      762     4953    1   DO_GHOST2:;
      763     4954    2        DO I = TD_HEAD.IOM_INDX TO TD_HEAD.IOM_INDX + TD_HEAD.NUMIOMS - 1;

   4954  6 000277   200030 235100                    LDA     TD_HEAD,,AUTO
         6 000300   000022 771000                    ARL     18
         6 000301   200016 755100                    STA     I,,AUTO
         6 000302   000466 710000 6                  TRA     s:4987+1

      764     4955    2           FOUND = %FALSE;

   4955  6 000303   200004 450100                    STZ     FOUND,,AUTO

      765     4956    3           DO J = TH_HEAD.IOM_INDX TO TH_HEAD.IOM_INDX + TH_HEAD.NUMIOMS - 1;

   4956  6 000304   200672 235100                    LDA     TH_HEAD,,AUTO
         6 000305   000022 771000                    ARL     18
         6 000306   200017 755100                    STA     J,,AUTO
         6 000307   000323 710000 6                  TRA     s:4959+1

      766     4957    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)

   4957  6 000310   200017 235100                    LDA     J,,AUTO
         6 000311   000001 735000                    ALS     1
         6 000312   000000 620005                    EAX0    0,AL
         6 000313   200016 236100                    LDQ     I,,AUTO
         6 000314   000001 736000                    QLS     1
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:131  
         6 000315   200050 237106                    LDAQ    TD_HEAD+16,QL,AUTO
         6 000316   200712 117110                    CMPAQ   TH_HEAD+16,X0,AUTO
         6 000317   000322 601000 6                  TNZ     s:4959

      767     4958    3                 THEN FOUND = %TRUE;

   4958  6 000320   400000 236003                    LDQ     -131072,DU
         6 000321   200004 756100                    STQ     FOUND,,AUTO

      768     4959    3           END;  /* DO J */

   4959  6 000322   200017 054100                    AOS     J,,AUTO
         6 000323   200672 236100                    LDQ     TH_HEAD,,AUTO
         6 000324   777777 376007                    ANQ     -1,DL
         6 000325   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 000326   200672 236100                    LDQ     TH_HEAD,,AUTO
         6 000327   000022 772000                    QRL     18
         6 000330   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 000331   000310 604000 6                  TMI     s:4957
         6 000332   200017 116100                    CMPQ    J,,AUTO
         6 000333   000310 605400 6                  TPNZ    s:4957

      769     4960    2           IF NOT FOUND

   4960  6 000334   200004 234100                    SZN     FOUND,,AUTO
         6 000335   000465 604000 6                  TMI     s:4987

      770     4961    2              THEN  /* STUFF INTO TH_HEAD.DEVNAME */
      771     4962    3              DO;

      772     4963    4                 DO K = TH_HEAD.FEP_INDX TO LAST_INDX;

   4963  6 000336   200700 235100                    LDA     TH_HEAD+6,,AUTO
         6 000337   000022 771000                    ARL     18
         6 000340   200020 755100                    STA     K,,AUTO
         6 000341   000357 710000 6                  TRA     s:4966+1

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:132  
      773     4964    4                    INDX = LAST_INDX - K + TH_HEAD.FEP_INDX;

   4964  6 000342   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 000343   200020 136100                    SBLQ    K,,AUTO
         6 000344   200700 235100                    LDA     TH_HEAD+6,,AUTO
         6 000345   000022 771000                    ARL     18
         6 000346   210124 755100                    STA     TH_UTS+3,,AUTO
         6 000347   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 000350   200021 756100                    STQ     INDX,,AUTO

      774     4965    4                    TH_HEAD.DEVNAME(INDX + 1) = TH_HEAD.DEVNAME(INDX);

   4965  6 000351   200021 235100                    LDA     INDX,,AUTO
         6 000352   000001 735000                    ALS     1
         6 000353   000000 620005                    EAX0    0,AL
         6 000354   200712 237105                    LDAQ    TH_HEAD+16,AL,AUTO
         6 000355   200714 757110                    STAQ    TH_HEAD+18,X0,AUTO

      775     4966    4                 END;  /* DO K */

   4966  6 000356   200020 054100                    AOS     K,,AUTO
         6 000357   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 000360   000342 604000 6                  TMI     s:4964
         6 000361   200020 116100                    CMPQ    K,,AUTO
         6 000362   000342 605000 6                  TPL     s:4964

      776     4967    3                 TH_HEAD.NUMIOMS = TH_HEAD.NUMIOMS + 1;

   4967  6 000363   200672 720100                    LXL0    TH_HEAD,,AUTO
         6 000364   000001 621010                    EAX1    1,X0
         6 000365   200672 441100                    SXL1    TH_HEAD,,AUTO

      777     4968    3                 TH_HEAD.DEVNAME(TH_HEAD.IOM_INDX + TH_HEAD.NUMIOMS - 1) = TD_HEAD.
              4968                          DEVNAME(I);

   4968  6 000366   200672 236100                    LDQ     TH_HEAD,,AUTO
         6 000367   777777 376007                    ANQ     -1,DL
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:133  
         6 000370   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 000371   200672 236100                    LDQ     TH_HEAD,,AUTO
         6 000372   000022 772000                    QRL     18
         6 000373   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 000374   000001 736000                    QLS     1
         6 000375   200016 235100                    LDA     I,,AUTO
         6 000376   000001 735000                    ALS     1
         6 000377   000000 620006                    EAX0    0,QL
         6 000400   200050 237105                    LDAQ    TD_HEAD+16,AL,AUTO
         6 000401   200710 757110                    STAQ    TH_HEAD+14,X0,AUTO

      778     4969    3                 LAST_INDX = LAST_INDX + 1;

   4969  6 000402   200005 235100                    LDA     LAST_INDX,,AUTO
         6 000403   000001 035007                    ADLA    1,DL
         6 000404   200005 755100                    STA     LAST_INDX,,AUTO

      779     4970    3                 TH_HEAD.FEP_INDX = TH_HEAD.FEP_INDX + 1;

   4970  6 000405   200700 220100                    LDX0    TH_HEAD+6,,AUTO
         6 000406   000001 621010                    EAX1    1,X0
         6 000407   200700 741100                    STX1    TH_HEAD+6,,AUTO

      780     4971    3                 TH_HEAD.UNITMPC_INDX = TH_HEAD.UNITMPC_INDX + 1;

   4971  6 000410   200673 220100                    LDX0    TH_HEAD+1,,AUTO
         6 000411   000001 622010                    EAX2    1,X0
         6 000412   200673 742100                    STX2    TH_HEAD+1,,AUTO

      781     4972    3                 TH_HEAD.TAPEMPC_INDX = TH_HEAD.TAPEMPC_INDX + 1;

   4972  6 000413   200674 220100                    LDX0    TH_HEAD+2,,AUTO
         6 000414   000001 623010                    EAX3    1,X0
         6 000415   200674 743100                    STX3    TH_HEAD+2,,AUTO

      782     4973    3                 TH_HEAD.DISKMPC_INDX = TH_HEAD.DISKMPC_INDX + 1;

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:134  
   4973  6 000416   200675 220100                    LDX0    TH_HEAD+3,,AUTO
         6 000417   000001 624010                    EAX4    1,X0
         6 000420   200675 744100                    STX4    TH_HEAD+3,,AUTO

      783     4974    3                 TH_HEAD.APMPC_INDX = TH_HEAD.APMPC_INDX + 1;

   4974  6 000421   200676 220100                    LDX0    TH_HEAD+4,,AUTO
         6 000422   000001 625010                    EAX5    1,X0
         6 000423   200676 745100                    STX5    TH_HEAD+4,,AUTO

      784     4975    3                 TH_HEAD.OPC_INDX = TH_HEAD.OPC_INDX + 1;

   4975  6 000424   200677 220100                    LDX0    TH_HEAD+5,,AUTO
         6 000425   000001 626010                    EAX6    1,X0
         6 000426   200677 746100                    STX6    TH_HEAD+5,,AUTO

      785     4976    3                 TH_HEAD.CONSOLE_INDX = TH_HEAD.CONSOLE_INDX + 1;

   4976  6 000427   200701 220100                    LDX0    TH_HEAD+7,,AUTO
         6 000430   000001 627010                    EAX7    1,X0
         6 000431   200701 747100                    STX7    TH_HEAD+7,,AUTO

      786     4977    3                 TH_HEAD.LP_INDX = TH_HEAD.LP_INDX + 1;

   4977  6 000432   200702 220100                    LDX0    TH_HEAD+8,,AUTO
         6 000433   000001 621010                    EAX1    1,X0
         6 000434   200702 741100                    STX1    TH_HEAD+8,,AUTO

      787     4978    3                 TH_HEAD.CR_INDX = TH_HEAD.CR_INDX + 1;

   4978  6 000435   200703 220100                    LDX0    TH_HEAD+9,,AUTO
         6 000436   000001 621010                    EAX1    1,X0
         6 000437   200703 741100                    STX1    TH_HEAD+9,,AUTO

      788     4979    3                 TH_HEAD.CP_INDX = TH_HEAD.CP_INDX + 1;

   4979  6 000440   200704 220100                    LDX0    TH_HEAD+10,,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:135  
         6 000441   000001 621010                    EAX1    1,X0
         6 000442   200704 741100                    STX1    TH_HEAD+10,,AUTO

      789     4980    3                 TH_HEAD.DP_INDX = TH_HEAD.DP_INDX + 1;

   4980  6 000443   200705 220100                    LDX0    TH_HEAD+11,,AUTO
         6 000444   000001 621010                    EAX1    1,X0
         6 000445   200705 741100                    STX1    TH_HEAD+11,,AUTO

      790     4981    3                 TH_HEAD.MT_INDX = TH_HEAD.MT_INDX + 1;

   4981  6 000446   200706 220100                    LDX0    TH_HEAD+12,,AUTO
         6 000447   000001 621010                    EAX1    1,X0
         6 000450   200706 741100                    STX1    TH_HEAD+12,,AUTO

      791     4982    3                 TH_HEAD.XX_INDX = TH_HEAD.XX_INDX + 1;

   4982  6 000451   200707 220100                    LDX0    TH_HEAD+13,,AUTO
         6 000452   000001 621010                    EAX1    1,X0
         6 000453   200707 741100                    STX1    TH_HEAD+13,,AUTO

      792     4983    3                 TH_HEAD.AP_INDX = TH_HEAD.AP_INDX + 1;

   4983  6 000454   200710 220100                    LDX0    TH_HEAD+14,,AUTO
         6 000455   000001 621010                    EAX1    1,X0
         6 000456   200710 741100                    STX1    TH_HEAD+14,,AUTO

      793     4984    3                 TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;

   4984  6 000457   200711 220100                    LDX0    TH_HEAD+15,,AUTO
         6 000460   000001 621010                    EAX1    1,X0
         6 000461   200711 741100                    STX1    TH_HEAD+15,,AUTO

      794     4985    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;

   4985  6 000462   000005 236000 4                  LDQ     NUM_NEW_COMPS
         6 000463   000001 036007                    ADLQ    1,DL
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:136  
         6 000464   000005 756000 4                  STQ     NUM_NEW_COMPS

      795     4986    3              END;  /* IF NOT FOUND */

      796     4987    2        END;  /* DO I */

   4987  6 000465   200016 054100                    AOS     I,,AUTO
         6 000466   200030 236100                    LDQ     TD_HEAD,,AUTO
         6 000467   777777 376007                    ANQ     -1,DL
         6 000470   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 000471   200030 236100                    LDQ     TD_HEAD,,AUTO
         6 000472   000022 772000                    QRL     18
         6 000473   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 000474   000303 604000 6                  TMI     s:4955
         6 000475   200016 116100                    CMPQ    I,,AUTO
         6 000476   000303 605400 6                  TPNZ    s:4955

      797     4988
      798     4989    2        DO I = TD_HEAD.FEP_INDX TO TD_HEAD.FEP_INDX + TD_HEAD.NUMFEPS - 1;

   4989  6 000477   200036 235100                    LDA     TD_HEAD+6,,AUTO
         6 000500   000022 771000                    ARL     18
         6 000501   200016 755100                    STA     I,,AUTO
         6 000502   000654 710000 6                  TRA     s:5018+1

      799     4990    2           FOUND = %FALSE;

   4990  6 000503   200004 450100                    STZ     FOUND,,AUTO

      800     4991    3           DO J = TH_HEAD.FEP_INDX TO TH_HEAD.FEP_INDX + TH_HEAD.NUMFEPS - 1;

   4991  6 000504   200700 235100                    LDA     TH_HEAD+6,,AUTO
         6 000505   000022 771000                    ARL     18
         6 000506   200017 755100                    STA     J,,AUTO
         6 000507   000523 710000 6                  TRA     s:4994+1

      801     4992    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:137  

   4992  6 000510   200017 235100                    LDA     J,,AUTO
         6 000511   000001 735000                    ALS     1
         6 000512   000000 620005                    EAX0    0,AL
         6 000513   200016 236100                    LDQ     I,,AUTO
         6 000514   000001 736000                    QLS     1
         6 000515   200050 237106                    LDAQ    TD_HEAD+16,QL,AUTO
         6 000516   200712 117110                    CMPAQ   TH_HEAD+16,X0,AUTO
         6 000517   000522 601000 6                  TNZ     s:4994

      802     4993    3                 THEN FOUND = %TRUE;

   4993  6 000520   400000 236003                    LDQ     -131072,DU
         6 000521   200004 756100                    STQ     FOUND,,AUTO

      803     4994    3              END;  /* DO J */

   4994  6 000522   200017 054100                    AOS     J,,AUTO
         6 000523   200700 236100                    LDQ     TH_HEAD+6,,AUTO
         6 000524   777777 376007                    ANQ     -1,DL
         6 000525   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 000526   200700 236100                    LDQ     TH_HEAD+6,,AUTO
         6 000527   000022 772000                    QRL     18
         6 000530   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 000531   000510 604000 6                  TMI     s:4992
         6 000532   200017 116100                    CMPQ    J,,AUTO
         6 000533   000510 605400 6                  TPNZ    s:4992

      804     4995    3           IF NOT FOUND THEN DO;

   4995  6 000534   200004 234100                    SZN     FOUND,,AUTO
         6 000535   000653 604000 6                  TMI     s:5018

      805     4996    4              DO K = LAST_INDX DOWNTO TH_HEAD.UNITMPC_INDX;

   4996  6 000536   200005 235100                    LDA     LAST_INDX,,AUTO
         6 000537   200020 755100                    STA     K,,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:138  
         6 000540   000550 710000 6                  TRA     s:4998+2

      806     4997    4                 TH_HEAD.DEVNAME(K+1) = TH_HEAD.DEVNAME(K);

   4997  6 000541   200020 235100                    LDA     K,,AUTO
         6 000542   000001 735000                    ALS     1
         6 000543   000000 620005                    EAX0    0,AL
         6 000544   200712 237105                    LDAQ    TH_HEAD+16,AL,AUTO
         6 000545   200714 757110                    STAQ    TH_HEAD+18,X0,AUTO

      807     4998    4                 END;  /* DO K */

   4998  6 000546   000001 336007                    LCQ     1,DL
         6 000547   200020 056100                    ASQ     K,,AUTO
         6 000550   200673 236100                    LDQ     TH_HEAD+1,,AUTO
         6 000551   000022 772000                    QRL     18
         6 000552   200020 116100                    CMPQ    K,,AUTO
         6 000553   000541 604400 6                  TMOZ    s:4997

      808     4999    3             TH_HEAD.DEVNAME(TH_HEAD.FEP_INDX + TH_HEAD.NUMFEPS) = TD_HEAD.DEVNAME(I);

   4999  6 000554   200700 236100                    LDQ     TH_HEAD+6,,AUTO
         6 000555   777777 376007                    ANQ     -1,DL
         6 000556   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 000557   200700 236100                    LDQ     TH_HEAD+6,,AUTO
         6 000560   000022 772000                    QRL     18
         6 000561   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 000562   000001 736000                    QLS     1
         6 000563   200016 235100                    LDA     I,,AUTO
         6 000564   000001 735000                    ALS     1
         6 000565   000000 620006                    EAX0    0,QL
         6 000566   200050 237105                    LDAQ    TD_HEAD+16,AL,AUTO
         6 000567   200712 757110                    STAQ    TH_HEAD+16,X0,AUTO

      809     5000    3              TH_HEAD.NUMFEPS = TH_HEAD.NUMFEPS + 1;

   5000  6 000570   200700 720100                    LXL0    TH_HEAD+6,,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:139  
         6 000571   000001 621010                    EAX1    1,X0
         6 000572   200700 441100                    SXL1    TH_HEAD+6,,AUTO

      810     5001    3              LAST_INDX = LAST_INDX + 1;

   5001  6 000573   200005 235100                    LDA     LAST_INDX,,AUTO
         6 000574   000001 035007                    ADLA    1,DL
         6 000575   200005 755100                    STA     LAST_INDX,,AUTO

      811     5002    3              TH_HEAD.UNITMPC_INDX = TH_HEAD.UNITMPC_INDX + 1;

   5002  6 000576   200673 220100                    LDX0    TH_HEAD+1,,AUTO
         6 000577   000001 622010                    EAX2    1,X0
         6 000600   200673 742100                    STX2    TH_HEAD+1,,AUTO

      812     5003    3              TH_HEAD.TAPEMPC_INDX = TH_HEAD.TAPEMPC_INDX + 1;

   5003  6 000601   200674 220100                    LDX0    TH_HEAD+2,,AUTO
         6 000602   000001 623010                    EAX3    1,X0
         6 000603   200674 743100                    STX3    TH_HEAD+2,,AUTO

      813     5004    3              TH_HEAD.DISKMPC_INDX = TH_HEAD.DISKMPC_INDX + 1;

   5004  6 000604   200675 220100                    LDX0    TH_HEAD+3,,AUTO
         6 000605   000001 624010                    EAX4    1,X0
         6 000606   200675 744100                    STX4    TH_HEAD+3,,AUTO

      814     5005    3              TH_HEAD.APMPC_INDX = TH_HEAD.APMPC_INDX + 1;

   5005  6 000607   200676 220100                    LDX0    TH_HEAD+4,,AUTO
         6 000610   000001 625010                    EAX5    1,X0
         6 000611   200676 745100                    STX5    TH_HEAD+4,,AUTO

      815     5006    3              TH_HEAD.OPC_INDX = TH_HEAD.OPC_INDX + 1;

   5006  6 000612   200677 220100                    LDX0    TH_HEAD+5,,AUTO
         6 000613   000001 626010                    EAX6    1,X0
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:140  
         6 000614   200677 746100                    STX6    TH_HEAD+5,,AUTO

      816     5007    3              TH_HEAD.CONSOLE_INDX = TH_HEAD.CONSOLE_INDX + 1;

   5007  6 000615   200701 220100                    LDX0    TH_HEAD+7,,AUTO
         6 000616   000001 627010                    EAX7    1,X0
         6 000617   200701 747100                    STX7    TH_HEAD+7,,AUTO

      817     5008    3              TH_HEAD.LP_INDX = TH_HEAD.LP_INDX + 1;

   5008  6 000620   200702 220100                    LDX0    TH_HEAD+8,,AUTO
         6 000621   000001 621010                    EAX1    1,X0
         6 000622   200702 741100                    STX1    TH_HEAD+8,,AUTO

      818     5009    3              TH_HEAD.CR_INDX = TH_HEAD.CR_INDX + 1;

   5009  6 000623   200703 220100                    LDX0    TH_HEAD+9,,AUTO
         6 000624   000001 621010                    EAX1    1,X0
         6 000625   200703 741100                    STX1    TH_HEAD+9,,AUTO

      819     5010    3              TH_HEAD.CP_INDX = TH_HEAD.CP_INDX + 1;

   5010  6 000626   200704 220100                    LDX0    TH_HEAD+10,,AUTO
         6 000627   000001 621010                    EAX1    1,X0
         6 000630   200704 741100                    STX1    TH_HEAD+10,,AUTO

      820     5011    3              TH_HEAD.DP_INDX = TH_HEAD.DP_INDX + 1;

   5011  6 000631   200705 220100                    LDX0    TH_HEAD+11,,AUTO
         6 000632   000001 621010                    EAX1    1,X0
         6 000633   200705 741100                    STX1    TH_HEAD+11,,AUTO

      821     5012    3              TH_HEAD.MT_INDX = TH_HEAD.MT_INDX + 1;

   5012  6 000634   200706 220100                    LDX0    TH_HEAD+12,,AUTO
         6 000635   000001 621010                    EAX1    1,X0
         6 000636   200706 741100                    STX1    TH_HEAD+12,,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:141  

      822     5013    3                 TH_HEAD.XX_INDX = TH_HEAD.XX_INDX + 1;

   5013  6 000637   200707 220100                    LDX0    TH_HEAD+13,,AUTO
         6 000640   000001 621010                    EAX1    1,X0
         6 000641   200707 741100                    STX1    TH_HEAD+13,,AUTO

      823     5014    3              TH_HEAD.AP_INDX = TH_HEAD.AP_INDX + 1;

   5014  6 000642   200710 220100                    LDX0    TH_HEAD+14,,AUTO
         6 000643   000001 621010                    EAX1    1,X0
         6 000644   200710 741100                    STX1    TH_HEAD+14,,AUTO

      824     5015    3              TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;

   5015  6 000645   200711 220100                    LDX0    TH_HEAD+15,,AUTO
         6 000646   000001 621010                    EAX1    1,X0
         6 000647   200711 741100                    STX1    TH_HEAD+15,,AUTO

      825     5016    3              NUM_NEW_COMPS = NUM_NEW_COMPS + 1;

   5016  6 000650   000005 236000 4                  LDQ     NUM_NEW_COMPS
         6 000651   000001 036007                    ADLQ    1,DL
         6 000652   000005 756000 4                  STQ     NUM_NEW_COMPS

      826     5017    3              END;  /* IF NOT FOUND */

      827     5018    2           END;  /* DO I */

   5018  6 000653   200016 054100                    AOS     I,,AUTO
         6 000654   200036 236100                    LDQ     TD_HEAD+6,,AUTO
         6 000655   777777 376007                    ANQ     -1,DL
         6 000656   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 000657   200036 236100                    LDQ     TD_HEAD+6,,AUTO
         6 000660   000022 772000                    QRL     18
         6 000661   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 000662   000503 604000 6                  TMI     s:4990
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:142  
         6 000663   200016 116100                    CMPQ    I,,AUTO
         6 000664   000503 605400 6                  TPNZ    s:4990

      828     5019
      829     5020                                        /* CHECK FOR UCS */
      830     5021    2        DO I = TD_HEAD.UNITMPC_INDX TO TD_HEAD.UNITMPC_INDX + TD_HEAD.NUMUNITMPCS - 1;

   5021  6 000665   200031 235100                    LDA     TD_HEAD+1,,AUTO
         6 000666   000022 771000                    ARL     18
         6 000667   200016 755100                    STA     I,,AUTO
         6 000670   001046 710000 6                  TRA     s:5052+1

      831     5022    2           FOUND = %FALSE;

   5022  6 000671   200004 450100                    STZ     FOUND,,AUTO

      832     5023    3           DO J = TH_HEAD.UNITMPC_INDX TO TH_HEAD.UNITMPC_INDX + TH_HEAD.NUMUNITMPCS -
              5023                    1;

   5023  6 000672   200673 235100                    LDA     TH_HEAD+1,,AUTO
         6 000673   000022 771000                    ARL     18
         6 000674   200017 755100                    STA     J,,AUTO
         6 000675   000711 710000 6                  TRA     s:5026+1

      833     5024    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)

   5024  6 000676   200017 235100                    LDA     J,,AUTO
         6 000677   000001 735000                    ALS     1
         6 000700   000000 620005                    EAX0    0,AL
         6 000701   200016 236100                    LDQ     I,,AUTO
         6 000702   000001 736000                    QLS     1
         6 000703   200050 237106                    LDAQ    TD_HEAD+16,QL,AUTO
         6 000704   200712 117110                    CMPAQ   TH_HEAD+16,X0,AUTO
         6 000705   000710 601000 6                  TNZ     s:5026

      834     5025    3                 THEN FOUND = %TRUE;

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:143  
   5025  6 000706   400000 236003                    LDQ     -131072,DU
         6 000707   200004 756100                    STQ     FOUND,,AUTO

      835     5026    3           END;                            /* DO J                               */

   5026  6 000710   200017 054100                    AOS     J,,AUTO
         6 000711   200673 236100                    LDQ     TH_HEAD+1,,AUTO
         6 000712   777777 376007                    ANQ     -1,DL
         6 000713   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 000714   200673 236100                    LDQ     TH_HEAD+1,,AUTO
         6 000715   000022 772000                    QRL     18
         6 000716   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 000717   000676 604000 6                  TMI     s:5024
         6 000720   200017 116100                    CMPQ    J,,AUTO
         6 000721   000676 605400 6                  TPNZ    s:5024

      836     5027    2           IF NOT FOUND

   5027  6 000722   200004 234100                    SZN     FOUND,,AUTO
         6 000723   001045 604000 6                  TMI     s:5052

      837     5028    2              THEN                         /* STUFF INTO TH_HEAD.DEVNAME         */
      838     5029    3              DO;

      839     5030    4                 DO K = TH_HEAD.TAPEMPC_INDX TO LAST_INDX;

   5030  6 000724   200674 235100                    LDA     TH_HEAD+2,,AUTO
         6 000725   000022 771000                    ARL     18
         6 000726   200020 755100                    STA     K,,AUTO
         6 000727   000745 710000 6                  TRA     s:5033+1

      840     5031    4                    INDX = LAST_INDX - K + TH_HEAD.TAPEMPC_INDX;

   5031  6 000730   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 000731   200020 136100                    SBLQ    K,,AUTO
         6 000732   200674 235100                    LDA     TH_HEAD+2,,AUTO
         6 000733   000022 771000                    ARL     18
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:144  
         6 000734   210124 755100                    STA     TH_UTS+3,,AUTO
         6 000735   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 000736   200021 756100                    STQ     INDX,,AUTO

      841     5032    4                    TH_HEAD.DEVNAME(INDX + 1) = TH_HEAD.DEVNAME(INDX);

   5032  6 000737   200021 235100                    LDA     INDX,,AUTO
         6 000740   000001 735000                    ALS     1
         6 000741   000000 620005                    EAX0    0,AL
         6 000742   200712 237105                    LDAQ    TH_HEAD+16,AL,AUTO
         6 000743   200714 757110                    STAQ    TH_HEAD+18,X0,AUTO

      842     5033    4                 END;                      /* DO K                               */

   5033  6 000744   200020 054100                    AOS     K,,AUTO
         6 000745   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 000746   000730 604000 6                  TMI     s:5031
         6 000747   200020 116100                    CMPQ    K,,AUTO
         6 000750   000730 605000 6                  TPL     s:5031

      843     5034    3                 TH_HEAD.NUMUNITMPCS = TH_HEAD.NUMUNITMPCS + 1;

   5034  6 000751   200673 720100                    LXL0    TH_HEAD+1,,AUTO
         6 000752   000001 621010                    EAX1    1,X0
         6 000753   200673 441100                    SXL1    TH_HEAD+1,,AUTO

      844     5035    3                 TH_HEAD.DEVNAME(TH_HEAD.UNITMPC_INDX + TH_HEAD.NUMUNITMPCS - 1) =
              5035                          TD_HEAD.DEVNAME(I);

   5035  6 000754   200673 236100                    LDQ     TH_HEAD+1,,AUTO
         6 000755   777777 376007                    ANQ     -1,DL
         6 000756   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 000757   200673 236100                    LDQ     TH_HEAD+1,,AUTO
         6 000760   000022 772000                    QRL     18
         6 000761   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 000762   000001 736000                    QLS     1
         6 000763   200016 235100                    LDA     I,,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:145  
         6 000764   000001 735000                    ALS     1
         6 000765   000000 620006                    EAX0    0,QL
         6 000766   200050 237105                    LDAQ    TD_HEAD+16,AL,AUTO
         6 000767   200710 757110                    STAQ    TH_HEAD+14,X0,AUTO

      845     5036    3                 LAST_INDX = LAST_INDX + 1;

   5036  6 000770   200005 235100                    LDA     LAST_INDX,,AUTO
         6 000771   000001 035007                    ADLA    1,DL
         6 000772   200005 755100                    STA     LAST_INDX,,AUTO

      846     5037    3                 TH_HEAD.TAPEMPC_INDX = TH_HEAD.TAPEMPC_INDX + 1;

   5037  6 000773   200674 220100                    LDX0    TH_HEAD+2,,AUTO
         6 000774   000001 621010                    EAX1    1,X0
         6 000775   200674 741100                    STX1    TH_HEAD+2,,AUTO

      847     5038    3                 TH_HEAD.DISKMPC_INDX = TH_HEAD.DISKMPC_INDX + 1;

   5038  6 000776   200675 220100                    LDX0    TH_HEAD+3,,AUTO
         6 000777   000001 622010                    EAX2    1,X0
         6 001000   200675 742100                    STX2    TH_HEAD+3,,AUTO

      848     5039    3                 TH_HEAD.APMPC_INDX = TH_HEAD.APMPC_INDX + 1;

   5039  6 001001   200676 220100                    LDX0    TH_HEAD+4,,AUTO
         6 001002   000001 623010                    EAX3    1,X0
         6 001003   200676 743100                    STX3    TH_HEAD+4,,AUTO

      849     5040    3                 TH_HEAD.OPC_INDX = TH_HEAD.OPC_INDX + 1;

   5040  6 001004   200677 220100                    LDX0    TH_HEAD+5,,AUTO
         6 001005   000001 624010                    EAX4    1,X0
         6 001006   200677 744100                    STX4    TH_HEAD+5,,AUTO

      850     5041    3                 TH_HEAD.CONSOLE_INDX = TH_HEAD.CONSOLE_INDX + 1;

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:146  
   5041  6 001007   200701 220100                    LDX0    TH_HEAD+7,,AUTO
         6 001010   000001 625010                    EAX5    1,X0
         6 001011   200701 745100                    STX5    TH_HEAD+7,,AUTO

      851     5042    3                 TH_HEAD.LP_INDX = TH_HEAD.LP_INDX + 1;

   5042  6 001012   200702 220100                    LDX0    TH_HEAD+8,,AUTO
         6 001013   000001 626010                    EAX6    1,X0
         6 001014   200702 746100                    STX6    TH_HEAD+8,,AUTO

      852     5043    3                 TH_HEAD.CR_INDX = TH_HEAD.CR_INDX + 1;

   5043  6 001015   200703 220100                    LDX0    TH_HEAD+9,,AUTO
         6 001016   000001 627010                    EAX7    1,X0
         6 001017   200703 747100                    STX7    TH_HEAD+9,,AUTO

      853     5044    3                 TH_HEAD.CP_INDX = TH_HEAD.CP_INDX + 1;

   5044  6 001020   200704 220100                    LDX0    TH_HEAD+10,,AUTO
         6 001021   000001 621010                    EAX1    1,X0
         6 001022   200704 741100                    STX1    TH_HEAD+10,,AUTO

      854     5045    3                 TH_HEAD.DP_INDX = TH_HEAD.DP_INDX + 1;

   5045  6 001023   200705 220100                    LDX0    TH_HEAD+11,,AUTO
         6 001024   000001 621010                    EAX1    1,X0
         6 001025   200705 741100                    STX1    TH_HEAD+11,,AUTO

      855     5046    3                 TH_HEAD.MT_INDX = TH_HEAD.MT_INDX + 1;

   5046  6 001026   200706 220100                    LDX0    TH_HEAD+12,,AUTO
         6 001027   000001 621010                    EAX1    1,X0
         6 001030   200706 741100                    STX1    TH_HEAD+12,,AUTO

      856     5047    3                 TH_HEAD.XX_INDX = TH_HEAD.XX_INDX + 1;

   5047  6 001031   200707 220100                    LDX0    TH_HEAD+13,,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:147  
         6 001032   000001 621010                    EAX1    1,X0
         6 001033   200707 741100                    STX1    TH_HEAD+13,,AUTO

      857     5048    3                 TH_HEAD.AP_INDX = TH_HEAD.AP_INDX + 1;

   5048  6 001034   200710 220100                    LDX0    TH_HEAD+14,,AUTO
         6 001035   000001 621010                    EAX1    1,X0
         6 001036   200710 741100                    STX1    TH_HEAD+14,,AUTO

      858     5049    3                 TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;

   5049  6 001037   200711 220100                    LDX0    TH_HEAD+15,,AUTO
         6 001040   000001 621010                    EAX1    1,X0
         6 001041   200711 741100                    STX1    TH_HEAD+15,,AUTO

      859     5050    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;

   5050  6 001042   000005 236000 4                  LDQ     NUM_NEW_COMPS
         6 001043   000001 036007                    ADLQ    1,DL
         6 001044   000005 756000 4                  STQ     NUM_NEW_COMPS

      860     5051    3              END;                         /* IF NOT FOUND                       */

      861     5052    2        END;                               /* DO I                               */

   5052  6 001045   200016 054100                    AOS     I,,AUTO
         6 001046   200031 236100                    LDQ     TD_HEAD+1,,AUTO
         6 001047   777777 376007                    ANQ     -1,DL
         6 001050   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 001051   200031 236100                    LDQ     TD_HEAD+1,,AUTO
         6 001052   000022 772000                    QRL     18
         6 001053   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 001054   000671 604000 6                  TMI     s:5022
         6 001055   200016 116100                    CMPQ    I,,AUTO
         6 001056   000671 605400 6                  TPNZ    s:5022

      862     5053
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:148  
      863     5054                                                /* CHECK FOR TCS                      */
      864     5055    2        DO I = TD_HEAD.TAPEMPC_INDX TO TD_HEAD.TAPEMPC_INDX + TD_HEAD.NUMTAPEMPCS - 1;

   5055  6 001057   200032 235100                    LDA     TD_HEAD+2,,AUTO
         6 001060   000022 771000                    ARL     18
         6 001061   200016 755100                    STA     I,,AUTO
         6 001062   001235 710000 6                  TRA     s:5085+1

      865     5056    2           FOUND = %FALSE;

   5056  6 001063   200004 450100                    STZ     FOUND,,AUTO

      866     5057    3           DO J = TH_HEAD.TAPEMPC_INDX TO TH_HEAD.TAPEMPC_INDX + TH_HEAD.NUMTAPEMPCS -
              5057                    1;

   5057  6 001064   200674 235100                    LDA     TH_HEAD+2,,AUTO
         6 001065   000022 771000                    ARL     18
         6 001066   200017 755100                    STA     J,,AUTO
         6 001067   001103 710000 6                  TRA     s:5060+1

      867     5058    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)

   5058  6 001070   200017 235100                    LDA     J,,AUTO
         6 001071   000001 735000                    ALS     1
         6 001072   000000 620005                    EAX0    0,AL
         6 001073   200016 236100                    LDQ     I,,AUTO
         6 001074   000001 736000                    QLS     1
         6 001075   200050 237106                    LDAQ    TD_HEAD+16,QL,AUTO
         6 001076   200712 117110                    CMPAQ   TH_HEAD+16,X0,AUTO
         6 001077   001102 601000 6                  TNZ     s:5060

      868     5059    3                 THEN FOUND = %TRUE;

   5059  6 001100   400000 236003                    LDQ     -131072,DU
         6 001101   200004 756100                    STQ     FOUND,,AUTO

      869     5060    3           END;                            /* DO J                               */
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:149  

   5060  6 001102   200017 054100                    AOS     J,,AUTO
         6 001103   200674 236100                    LDQ     TH_HEAD+2,,AUTO
         6 001104   777777 376007                    ANQ     -1,DL
         6 001105   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 001106   200674 236100                    LDQ     TH_HEAD+2,,AUTO
         6 001107   000022 772000                    QRL     18
         6 001110   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 001111   001070 604000 6                  TMI     s:5058
         6 001112   200017 116100                    CMPQ    J,,AUTO
         6 001113   001070 605400 6                  TPNZ    s:5058

      870     5061    2           IF NOT FOUND

   5061  6 001114   200004 234100                    SZN     FOUND,,AUTO
         6 001115   001234 604000 6                  TMI     s:5085

      871     5062    2              THEN                         /* STUFF INTO TH_HEAD.DEVNAME         */
      872     5063    3              DO;

      873     5064    4                 DO K = TH_HEAD.DISKMPC_INDX TO LAST_INDX;

   5064  6 001116   200675 235100                    LDA     TH_HEAD+3,,AUTO
         6 001117   000022 771000                    ARL     18
         6 001120   200020 755100                    STA     K,,AUTO
         6 001121   001137 710000 6                  TRA     s:5067+1

      874     5065    4                    INDX = LAST_INDX - K + TH_HEAD.DISKMPC_INDX;

   5065  6 001122   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 001123   200020 136100                    SBLQ    K,,AUTO
         6 001124   200675 235100                    LDA     TH_HEAD+3,,AUTO
         6 001125   000022 771000                    ARL     18
         6 001126   210124 755100                    STA     TH_UTS+3,,AUTO
         6 001127   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 001130   200021 756100                    STQ     INDX,,AUTO

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:150  
      875     5066    4                    TH_HEAD.DEVNAME(INDX + 1) = TH_HEAD.DEVNAME(INDX);

   5066  6 001131   200021 235100                    LDA     INDX,,AUTO
         6 001132   000001 735000                    ALS     1
         6 001133   000000 620005                    EAX0    0,AL
         6 001134   200712 237105                    LDAQ    TH_HEAD+16,AL,AUTO
         6 001135   200714 757110                    STAQ    TH_HEAD+18,X0,AUTO

      876     5067    4                 END;                      /* DO K                               */

   5067  6 001136   200020 054100                    AOS     K,,AUTO
         6 001137   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 001140   001122 604000 6                  TMI     s:5065
         6 001141   200020 116100                    CMPQ    K,,AUTO
         6 001142   001122 605000 6                  TPL     s:5065

      877     5068    3                 TH_HEAD.NUMTAPEMPCS = TH_HEAD.NUMTAPEMPCS + 1;

   5068  6 001143   200674 720100                    LXL0    TH_HEAD+2,,AUTO
         6 001144   000001 621010                    EAX1    1,X0
         6 001145   200674 441100                    SXL1    TH_HEAD+2,,AUTO

      878     5069    3                 TH_HEAD.DEVNAME(TH_HEAD.TAPEMPC_INDX + TH_HEAD.NUMTAPEMPCS - 1) =
              5069                          TD_HEAD.DEVNAME(I);

   5069  6 001146   200674 236100                    LDQ     TH_HEAD+2,,AUTO
         6 001147   777777 376007                    ANQ     -1,DL
         6 001150   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 001151   200674 236100                    LDQ     TH_HEAD+2,,AUTO
         6 001152   000022 772000                    QRL     18
         6 001153   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 001154   000001 736000                    QLS     1
         6 001155   200016 235100                    LDA     I,,AUTO
         6 001156   000001 735000                    ALS     1
         6 001157   000000 620006                    EAX0    0,QL
         6 001160   200050 237105                    LDAQ    TD_HEAD+16,AL,AUTO
         6 001161   200710 757110                    STAQ    TH_HEAD+14,X0,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:151  

      879     5070    3                 LAST_INDX = LAST_INDX + 1;

   5070  6 001162   200005 235100                    LDA     LAST_INDX,,AUTO
         6 001163   000001 035007                    ADLA    1,DL
         6 001164   200005 755100                    STA     LAST_INDX,,AUTO

      880     5071    3                 TH_HEAD.DISKMPC_INDX = TH_HEAD.DISKMPC_INDX + 1;

   5071  6 001165   200675 220100                    LDX0    TH_HEAD+3,,AUTO
         6 001166   000001 621010                    EAX1    1,X0
         6 001167   200675 741100                    STX1    TH_HEAD+3,,AUTO

      881     5072    3                 TH_HEAD.APMPC_INDX = TH_HEAD.APMPC_INDX + 1;

   5072  6 001170   200676 220100                    LDX0    TH_HEAD+4,,AUTO
         6 001171   000001 622010                    EAX2    1,X0
         6 001172   200676 742100                    STX2    TH_HEAD+4,,AUTO

      882     5073    3                 TH_HEAD.OPC_INDX = TH_HEAD.OPC_INDX + 1;

   5073  6 001173   200677 220100                    LDX0    TH_HEAD+5,,AUTO
         6 001174   000001 623010                    EAX3    1,X0
         6 001175   200677 743100                    STX3    TH_HEAD+5,,AUTO

      883     5074    3                 TH_HEAD.CONSOLE_INDX = TH_HEAD.CONSOLE_INDX + 1;

   5074  6 001176   200701 220100                    LDX0    TH_HEAD+7,,AUTO
         6 001177   000001 624010                    EAX4    1,X0
         6 001200   200701 744100                    STX4    TH_HEAD+7,,AUTO

      884     5075    3                 TH_HEAD.LP_INDX = TH_HEAD.LP_INDX + 1;

   5075  6 001201   200702 220100                    LDX0    TH_HEAD+8,,AUTO
         6 001202   000001 625010                    EAX5    1,X0
         6 001203   200702 745100                    STX5    TH_HEAD+8,,AUTO

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:152  
      885     5076    3                 TH_HEAD.CR_INDX = TH_HEAD.CR_INDX + 1;

   5076  6 001204   200703 220100                    LDX0    TH_HEAD+9,,AUTO
         6 001205   000001 626010                    EAX6    1,X0
         6 001206   200703 746100                    STX6    TH_HEAD+9,,AUTO

      886     5077    3                 TH_HEAD.CP_INDX = TH_HEAD.CP_INDX + 1;

   5077  6 001207   200704 220100                    LDX0    TH_HEAD+10,,AUTO
         6 001210   000001 627010                    EAX7    1,X0
         6 001211   200704 747100                    STX7    TH_HEAD+10,,AUTO

      887     5078    3                 TH_HEAD.DP_INDX = TH_HEAD.DP_INDX + 1;

   5078  6 001212   200705 220100                    LDX0    TH_HEAD+11,,AUTO
         6 001213   000001 621010                    EAX1    1,X0
         6 001214   200705 741100                    STX1    TH_HEAD+11,,AUTO

      888     5079    3                 TH_HEAD.MT_INDX = TH_HEAD.MT_INDX + 1;

   5079  6 001215   200706 220100                    LDX0    TH_HEAD+12,,AUTO
         6 001216   000001 621010                    EAX1    1,X0
         6 001217   200706 741100                    STX1    TH_HEAD+12,,AUTO

      889     5080    3                 TH_HEAD.XX_INDX = TH_HEAD.XX_INDX + 1;

   5080  6 001220   200707 220100                    LDX0    TH_HEAD+13,,AUTO
         6 001221   000001 621010                    EAX1    1,X0
         6 001222   200707 741100                    STX1    TH_HEAD+13,,AUTO

      890     5081    3                 TH_HEAD.AP_INDX = TH_HEAD.AP_INDX + 1;

   5081  6 001223   200710 220100                    LDX0    TH_HEAD+14,,AUTO
         6 001224   000001 621010                    EAX1    1,X0
         6 001225   200710 741100                    STX1    TH_HEAD+14,,AUTO

      891     5082    3                 TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:153  

   5082  6 001226   200711 220100                    LDX0    TH_HEAD+15,,AUTO
         6 001227   000001 621010                    EAX1    1,X0
         6 001230   200711 741100                    STX1    TH_HEAD+15,,AUTO

      892     5083    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;

   5083  6 001231   000005 236000 4                  LDQ     NUM_NEW_COMPS
         6 001232   000001 036007                    ADLQ    1,DL
         6 001233   000005 756000 4                  STQ     NUM_NEW_COMPS

      893     5084    3              END;                         /* IF NOT FOUND                       */

      894     5085    2        END;                               /* DO I                               */

   5085  6 001234   200016 054100                    AOS     I,,AUTO
         6 001235   200032 236100                    LDQ     TD_HEAD+2,,AUTO
         6 001236   777777 376007                    ANQ     -1,DL
         6 001237   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 001240   200032 236100                    LDQ     TD_HEAD+2,,AUTO
         6 001241   000022 772000                    QRL     18
         6 001242   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 001243   001063 604000 6                  TMI     s:5056
         6 001244   200016 116100                    CMPQ    I,,AUTO
         6 001245   001063 605400 6                  TPNZ    s:5056

      895     5086
      896     5087                                                /* CHECK FOR DCS                      */
      897     5088    2        DO I = TD_HEAD.DISKMPC_INDX TO TD_HEAD.DISKMPC_INDX + TD_HEAD.NUMDISKMPCS - 1;

   5088  6 001246   200033 235100                    LDA     TD_HEAD+3,,AUTO
         6 001247   000022 771000                    ARL     18
         6 001250   200016 755100                    STA     I,,AUTO
         6 001251   001421 710000 6                  TRA     s:5117+1

      898     5089    2           FOUND = %FALSE;

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:154  
   5089  6 001252   200004 450100                    STZ     FOUND,,AUTO

      899     5090    3           DO J = TH_HEAD.DISKMPC_INDX TO TH_HEAD.DISKMPC_INDX + TH_HEAD.NUMDISKMPCS -
              5090                    1;

   5090  6 001253   200675 235100                    LDA     TH_HEAD+3,,AUTO
         6 001254   000022 771000                    ARL     18
         6 001255   200017 755100                    STA     J,,AUTO
         6 001256   001272 710000 6                  TRA     s:5093+1

      900     5091    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)

   5091  6 001257   200017 235100                    LDA     J,,AUTO
         6 001260   000001 735000                    ALS     1
         6 001261   000000 620005                    EAX0    0,AL
         6 001262   200016 236100                    LDQ     I,,AUTO
         6 001263   000001 736000                    QLS     1
         6 001264   200050 237106                    LDAQ    TD_HEAD+16,QL,AUTO
         6 001265   200712 117110                    CMPAQ   TH_HEAD+16,X0,AUTO
         6 001266   001271 601000 6                  TNZ     s:5093

      901     5092    3                 THEN FOUND = %TRUE;

   5092  6 001267   400000 236003                    LDQ     -131072,DU
         6 001270   200004 756100                    STQ     FOUND,,AUTO

      902     5093    3           END;                            /* DO J                               */

   5093  6 001271   200017 054100                    AOS     J,,AUTO
         6 001272   200675 236100                    LDQ     TH_HEAD+3,,AUTO
         6 001273   777777 376007                    ANQ     -1,DL
         6 001274   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 001275   200675 236100                    LDQ     TH_HEAD+3,,AUTO
         6 001276   000022 772000                    QRL     18
         6 001277   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 001300   001257 604000 6                  TMI     s:5091
         6 001301   200017 116100                    CMPQ    J,,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:155  
         6 001302   001257 605400 6                  TPNZ    s:5091

      903     5094    2           IF NOT FOUND

   5094  6 001303   200004 234100                    SZN     FOUND,,AUTO
         6 001304   001420 604000 6                  TMI     s:5117

      904     5095    2              THEN                         /* STUFF INTO TH_HEAD.DEVNAME         */
      905     5096    3              DO;

      906     5097    4                 DO K = TH_HEAD.APMPC_INDX TO LAST_INDX;

   5097  6 001305   200676 235100                    LDA     TH_HEAD+4,,AUTO
         6 001306   000022 771000                    ARL     18
         6 001307   200020 755100                    STA     K,,AUTO
         6 001310   001326 710000 6                  TRA     s:5100+1

      907     5098    4                    INDX = LAST_INDX - K + TH_HEAD.APMPC_INDX;

   5098  6 001311   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 001312   200020 136100                    SBLQ    K,,AUTO
         6 001313   200676 235100                    LDA     TH_HEAD+4,,AUTO
         6 001314   000022 771000                    ARL     18
         6 001315   210124 755100                    STA     TH_UTS+3,,AUTO
         6 001316   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 001317   200021 756100                    STQ     INDX,,AUTO

      908     5099    4                    TH_HEAD.DEVNAME(INDX + 1) = TH_HEAD.DEVNAME(INDX);

   5099  6 001320   200021 235100                    LDA     INDX,,AUTO
         6 001321   000001 735000                    ALS     1
         6 001322   000000 620005                    EAX0    0,AL
         6 001323   200712 237105                    LDAQ    TH_HEAD+16,AL,AUTO
         6 001324   200714 757110                    STAQ    TH_HEAD+18,X0,AUTO

      909     5100    4                 END;                      /* DO K                               */

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:156  
   5100  6 001325   200020 054100                    AOS     K,,AUTO
         6 001326   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 001327   001311 604000 6                  TMI     s:5098
         6 001330   200020 116100                    CMPQ    K,,AUTO
         6 001331   001311 605000 6                  TPL     s:5098

      910     5101    3                 TH_HEAD.NUMDISKMPCS = TH_HEAD.NUMDISKMPCS + 1;

   5101  6 001332   200675 720100                    LXL0    TH_HEAD+3,,AUTO
         6 001333   000001 621010                    EAX1    1,X0
         6 001334   200675 441100                    SXL1    TH_HEAD+3,,AUTO

      911     5102    3                 TH_HEAD.DEVNAME(TH_HEAD.DISKMPC_INDX + TH_HEAD.NUMDISKMPCS - 1) =
              5102                          TD_HEAD.DEVNAME(I);

   5102  6 001335   200675 236100                    LDQ     TH_HEAD+3,,AUTO
         6 001336   777777 376007                    ANQ     -1,DL
         6 001337   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 001340   200675 236100                    LDQ     TH_HEAD+3,,AUTO
         6 001341   000022 772000                    QRL     18
         6 001342   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 001343   000001 736000                    QLS     1
         6 001344   200016 235100                    LDA     I,,AUTO
         6 001345   000001 735000                    ALS     1
         6 001346   000000 620006                    EAX0    0,QL
         6 001347   200050 237105                    LDAQ    TD_HEAD+16,AL,AUTO
         6 001350   200710 757110                    STAQ    TH_HEAD+14,X0,AUTO

      912     5103    3                 LAST_INDX = LAST_INDX + 1;

   5103  6 001351   200005 235100                    LDA     LAST_INDX,,AUTO
         6 001352   000001 035007                    ADLA    1,DL
         6 001353   200005 755100                    STA     LAST_INDX,,AUTO

      913     5104    3                 TH_HEAD.APMPC_INDX = TH_HEAD.APMPC_INDX + 1;

   5104  6 001354   200676 220100                    LDX0    TH_HEAD+4,,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:157  
         6 001355   000001 621010                    EAX1    1,X0
         6 001356   200676 741100                    STX1    TH_HEAD+4,,AUTO

      914     5105    3                 TH_HEAD.OPC_INDX = TH_HEAD.OPC_INDX + 1;

   5105  6 001357   200677 220100                    LDX0    TH_HEAD+5,,AUTO
         6 001360   000001 622010                    EAX2    1,X0
         6 001361   200677 742100                    STX2    TH_HEAD+5,,AUTO

      915     5106    3                 TH_HEAD.CONSOLE_INDX = TH_HEAD.CONSOLE_INDX + 1;

   5106  6 001362   200701 220100                    LDX0    TH_HEAD+7,,AUTO
         6 001363   000001 623010                    EAX3    1,X0
         6 001364   200701 743100                    STX3    TH_HEAD+7,,AUTO

      916     5107    3                 TH_HEAD.LP_INDX = TH_HEAD.LP_INDX + 1;

   5107  6 001365   200702 220100                    LDX0    TH_HEAD+8,,AUTO
         6 001366   000001 624010                    EAX4    1,X0
         6 001367   200702 744100                    STX4    TH_HEAD+8,,AUTO

      917     5108    3                 TH_HEAD.CR_INDX = TH_HEAD.CR_INDX + 1;

   5108  6 001370   200703 220100                    LDX0    TH_HEAD+9,,AUTO
         6 001371   000001 625010                    EAX5    1,X0
         6 001372   200703 745100                    STX5    TH_HEAD+9,,AUTO

      918     5109    3                 TH_HEAD.CP_INDX = TH_HEAD.CP_INDX + 1;

   5109  6 001373   200704 220100                    LDX0    TH_HEAD+10,,AUTO
         6 001374   000001 626010                    EAX6    1,X0
         6 001375   200704 746100                    STX6    TH_HEAD+10,,AUTO

      919     5110    3                 TH_HEAD.DP_INDX = TH_HEAD.DP_INDX + 1;

   5110  6 001376   200705 220100                    LDX0    TH_HEAD+11,,AUTO
         6 001377   000001 627010                    EAX7    1,X0
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:158  
         6 001400   200705 747100                    STX7    TH_HEAD+11,,AUTO

      920     5111    3                 TH_HEAD.MT_INDX = TH_HEAD.MT_INDX + 1;

   5111  6 001401   200706 220100                    LDX0    TH_HEAD+12,,AUTO
         6 001402   000001 621010                    EAX1    1,X0
         6 001403   200706 741100                    STX1    TH_HEAD+12,,AUTO

      921     5112    3                 TH_HEAD.XX_INDX = TH_HEAD.XX_INDX + 1;

   5112  6 001404   200707 220100                    LDX0    TH_HEAD+13,,AUTO
         6 001405   000001 621010                    EAX1    1,X0
         6 001406   200707 741100                    STX1    TH_HEAD+13,,AUTO

      922     5113    3                 TH_HEAD.AP_INDX = TH_HEAD.AP_INDX + 1;

   5113  6 001407   200710 220100                    LDX0    TH_HEAD+14,,AUTO
         6 001410   000001 621010                    EAX1    1,X0
         6 001411   200710 741100                    STX1    TH_HEAD+14,,AUTO

      923     5114    3                 TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;

   5114  6 001412   200711 220100                    LDX0    TH_HEAD+15,,AUTO
         6 001413   000001 621010                    EAX1    1,X0
         6 001414   200711 741100                    STX1    TH_HEAD+15,,AUTO

      924     5115    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;

   5115  6 001415   000005 236000 4                  LDQ     NUM_NEW_COMPS
         6 001416   000001 036007                    ADLQ    1,DL
         6 001417   000005 756000 4                  STQ     NUM_NEW_COMPS

      925     5116    3              END;                         /* IF NOT FOUND                       */

      926     5117    2        END;                               /* DO I                               */

   5117  6 001420   200016 054100                    AOS     I,,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:159  
         6 001421   200033 236100                    LDQ     TD_HEAD+3,,AUTO
         6 001422   777777 376007                    ANQ     -1,DL
         6 001423   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 001424   200033 236100                    LDQ     TD_HEAD+3,,AUTO
         6 001425   000022 772000                    QRL     18
         6 001426   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 001427   001252 604000 6                  TMI     s:5089
         6 001430   200016 116100                    CMPQ    I,,AUTO
         6 001431   001252 605400 6                  TPNZ    s:5089

      927     5118
      928     5119                                                /* CHECK FOR  ACS                     */
      929     5120    2        DO I = TD_HEAD.APMPC_INDX TO TD_HEAD.APMPC_INDX + TD_HEAD.NUMAPMPCS - 1;

   5120  6 001432   200034 235100                    LDA     TD_HEAD+4,,AUTO
         6 001433   000022 771000                    ARL     18
         6 001434   200016 755100                    STA     I,,AUTO
         6 001435   001602 710000 6                  TRA     s:5148+1

      930     5121    2           FOUND = %FALSE;

   5121  6 001436   200004 450100                    STZ     FOUND,,AUTO

      931     5122    3           DO J = TH_HEAD.APMPC_INDX TO TH_HEAD.APMPC_INDX + TH_HEAD.NUMAPMPCS - 1;

   5122  6 001437   200676 235100                    LDA     TH_HEAD+4,,AUTO
         6 001440   000022 771000                    ARL     18
         6 001441   200017 755100                    STA     J,,AUTO
         6 001442   001456 710000 6                  TRA     s:5125+1

      932     5123    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)

   5123  6 001443   200017 235100                    LDA     J,,AUTO
         6 001444   000001 735000                    ALS     1
         6 001445   000000 620005                    EAX0    0,AL
         6 001446   200016 236100                    LDQ     I,,AUTO
         6 001447   000001 736000                    QLS     1
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:160  
         6 001450   200050 237106                    LDAQ    TD_HEAD+16,QL,AUTO
         6 001451   200712 117110                    CMPAQ   TH_HEAD+16,X0,AUTO
         6 001452   001455 601000 6                  TNZ     s:5125

      933     5124    3                 THEN FOUND = %TRUE;

   5124  6 001453   400000 236003                    LDQ     -131072,DU
         6 001454   200004 756100                    STQ     FOUND,,AUTO

      934     5125    3           END;                            /* DO J                               */

   5125  6 001455   200017 054100                    AOS     J,,AUTO
         6 001456   200676 236100                    LDQ     TH_HEAD+4,,AUTO
         6 001457   777777 376007                    ANQ     -1,DL
         6 001460   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 001461   200676 236100                    LDQ     TH_HEAD+4,,AUTO
         6 001462   000022 772000                    QRL     18
         6 001463   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 001464   001443 604000 6                  TMI     s:5123
         6 001465   200017 116100                    CMPQ    J,,AUTO
         6 001466   001443 605400 6                  TPNZ    s:5123

      935     5126    2           IF NOT FOUND

   5126  6 001467   200004 234100                    SZN     FOUND,,AUTO
         6 001470   001601 604000 6                  TMI     s:5148

      936     5127    2              THEN                         /* STUFF INTO TH_HEAD.DEVNAME         */
      937     5128    3              DO;

      938     5129    4                 DO K = TH_HEAD.OPC_INDX TO LAST_INDX;

   5129  6 001471   200677 235100                    LDA     TH_HEAD+5,,AUTO
         6 001472   000022 771000                    ARL     18
         6 001473   200020 755100                    STA     K,,AUTO
         6 001474   001512 710000 6                  TRA     s:5132+1

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:161  
      939     5130    4                    INDX = LAST_INDX - K + TH_HEAD.OPC_INDX;

   5130  6 001475   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 001476   200020 136100                    SBLQ    K,,AUTO
         6 001477   200677 235100                    LDA     TH_HEAD+5,,AUTO
         6 001500   000022 771000                    ARL     18
         6 001501   210124 755100                    STA     TH_UTS+3,,AUTO
         6 001502   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 001503   200021 756100                    STQ     INDX,,AUTO

      940     5131    4                    TH_HEAD.DEVNAME(INDX + 1) = TH_HEAD.DEVNAME(INDX);

   5131  6 001504   200021 235100                    LDA     INDX,,AUTO
         6 001505   000001 735000                    ALS     1
         6 001506   000000 620005                    EAX0    0,AL
         6 001507   200712 237105                    LDAQ    TH_HEAD+16,AL,AUTO
         6 001510   200714 757110                    STAQ    TH_HEAD+18,X0,AUTO

      941     5132    4                 END;                      /* DO K                               */

   5132  6 001511   200020 054100                    AOS     K,,AUTO
         6 001512   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 001513   001475 604000 6                  TMI     s:5130
         6 001514   200020 116100                    CMPQ    K,,AUTO
         6 001515   001475 605000 6                  TPL     s:5130

      942     5133    3                 TH_HEAD.NUMAPMPCS = TH_HEAD.NUMAPMPCS + 1;

   5133  6 001516   200676 720100                    LXL0    TH_HEAD+4,,AUTO
         6 001517   000001 621010                    EAX1    1,X0
         6 001520   200676 441100                    SXL1    TH_HEAD+4,,AUTO

      943     5134    3                TH_HEAD.DEVNAME(TH_HEAD.APMPC_INDX + TH_HEAD.NUMAPMPCS - 1) = TD_HEAD.
              5134                          DEVNAME(I);

   5134  6 001521   200676 236100                    LDQ     TH_HEAD+4,,AUTO
         6 001522   777777 376007                    ANQ     -1,DL
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:162  
         6 001523   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 001524   200676 236100                    LDQ     TH_HEAD+4,,AUTO
         6 001525   000022 772000                    QRL     18
         6 001526   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 001527   000001 736000                    QLS     1
         6 001530   200016 235100                    LDA     I,,AUTO
         6 001531   000001 735000                    ALS     1
         6 001532   000000 620006                    EAX0    0,QL
         6 001533   200050 237105                    LDAQ    TD_HEAD+16,AL,AUTO
         6 001534   200710 757110                    STAQ    TH_HEAD+14,X0,AUTO

      944     5135    3                 LAST_INDX = LAST_INDX + 1;

   5135  6 001535   200005 235100                    LDA     LAST_INDX,,AUTO
         6 001536   000001 035007                    ADLA    1,DL
         6 001537   200005 755100                    STA     LAST_INDX,,AUTO

      945     5136    3                 TH_HEAD.OPC_INDX = TH_HEAD.OPC_INDX + 1;

   5136  6 001540   200677 220100                    LDX0    TH_HEAD+5,,AUTO
         6 001541   000001 621010                    EAX1    1,X0
         6 001542   200677 741100                    STX1    TH_HEAD+5,,AUTO

      946     5137    3                 TH_HEAD.CONSOLE_INDX = TH_HEAD.CONSOLE_INDX + 1;

   5137  6 001543   200701 220100                    LDX0    TH_HEAD+7,,AUTO
         6 001544   000001 622010                    EAX2    1,X0
         6 001545   200701 742100                    STX2    TH_HEAD+7,,AUTO

      947     5138    3                 TH_HEAD.LP_INDX = TH_HEAD.LP_INDX + 1;

   5138  6 001546   200702 220100                    LDX0    TH_HEAD+8,,AUTO
         6 001547   000001 623010                    EAX3    1,X0
         6 001550   200702 743100                    STX3    TH_HEAD+8,,AUTO

      948     5139    3                 TH_HEAD.CR_INDX = TH_HEAD.CR_INDX + 1;

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:163  
   5139  6 001551   200703 220100                    LDX0    TH_HEAD+9,,AUTO
         6 001552   000001 624010                    EAX4    1,X0
         6 001553   200703 744100                    STX4    TH_HEAD+9,,AUTO

      949     5140    3                 TH_HEAD.CP_INDX = TH_HEAD.CP_INDX + 1;

   5140  6 001554   200704 220100                    LDX0    TH_HEAD+10,,AUTO
         6 001555   000001 625010                    EAX5    1,X0
         6 001556   200704 745100                    STX5    TH_HEAD+10,,AUTO

      950     5141    3                 TH_HEAD.DP_INDX = TH_HEAD.DP_INDX + 1;

   5141  6 001557   200705 220100                    LDX0    TH_HEAD+11,,AUTO
         6 001560   000001 626010                    EAX6    1,X0
         6 001561   200705 746100                    STX6    TH_HEAD+11,,AUTO

      951     5142    3                 TH_HEAD.MT_INDX = TH_HEAD.MT_INDX + 1;

   5142  6 001562   200706 220100                    LDX0    TH_HEAD+12,,AUTO
         6 001563   000001 627010                    EAX7    1,X0
         6 001564   200706 747100                    STX7    TH_HEAD+12,,AUTO

      952     5143    3                 TH_HEAD.XX_INDX = TH_HEAD.XX_INDX + 1;

   5143  6 001565   200707 220100                    LDX0    TH_HEAD+13,,AUTO
         6 001566   000001 621010                    EAX1    1,X0
         6 001567   200707 741100                    STX1    TH_HEAD+13,,AUTO

      953     5144    3                 TH_HEAD.AP_INDX = TH_HEAD.AP_INDX + 1;

   5144  6 001570   200710 220100                    LDX0    TH_HEAD+14,,AUTO
         6 001571   000001 621010                    EAX1    1,X0
         6 001572   200710 741100                    STX1    TH_HEAD+14,,AUTO

      954     5145    3                 TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;

   5145  6 001573   200711 220100                    LDX0    TH_HEAD+15,,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:164  
         6 001574   000001 621010                    EAX1    1,X0
         6 001575   200711 741100                    STX1    TH_HEAD+15,,AUTO

      955     5146    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;

   5146  6 001576   000005 236000 4                  LDQ     NUM_NEW_COMPS
         6 001577   000001 036007                    ADLQ    1,DL
         6 001600   000005 756000 4                  STQ     NUM_NEW_COMPS

      956     5147    3              END;                         /* IF NOT FOUND                       */

      957     5148    2        END;                               /* DO I                               */

   5148  6 001601   200016 054100                    AOS     I,,AUTO
         6 001602   200034 236100                    LDQ     TD_HEAD+4,,AUTO
         6 001603   777777 376007                    ANQ     -1,DL
         6 001604   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 001605   200034 236100                    LDQ     TD_HEAD+4,,AUTO
         6 001606   000022 772000                    QRL     18
         6 001607   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 001610   001436 604000 6                  TMI     s:5121
         6 001611   200016 116100                    CMPQ    I,,AUTO
         6 001612   001436 605400 6                  TPNZ    s:5121

      958     5149
      959     5150
      960     5151                                                /* CHECK FOR  OPCS                    */
      961     5152    2        DO I = TD_HEAD.OPC_INDX TO TD_HEAD.OPC_INDX + TD_HEAD.NUMOPCS - 1;

   5152  6 001613   200035 235100                    LDA     TD_HEAD+5,,AUTO
         6 001614   000022 771000                    ARL     18
         6 001615   200016 755100                    STA     I,,AUTO
         6 001616   001760 710000 6                  TRA     s:5179+1

      962     5153    2           FOUND = %FALSE;

   5153  6 001617   200004 450100                    STZ     FOUND,,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:165  

      963     5154    3           DO J = TH_HEAD.OPC_INDX TO TH_HEAD.OPC_INDX + TH_HEAD.NUMOPCS - 1;

   5154  6 001620   200677 235100                    LDA     TH_HEAD+5,,AUTO
         6 001621   000022 771000                    ARL     18
         6 001622   200017 755100                    STA     J,,AUTO
         6 001623   001637 710000 6                  TRA     s:5157+1

      964     5155    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)

   5155  6 001624   200017 235100                    LDA     J,,AUTO
         6 001625   000001 735000                    ALS     1
         6 001626   000000 620005                    EAX0    0,AL
         6 001627   200016 236100                    LDQ     I,,AUTO
         6 001630   000001 736000                    QLS     1
         6 001631   200050 237106                    LDAQ    TD_HEAD+16,QL,AUTO
         6 001632   200712 117110                    CMPAQ   TH_HEAD+16,X0,AUTO
         6 001633   001636 601000 6                  TNZ     s:5157

      965     5156    3                 THEN FOUND = %TRUE;

   5156  6 001634   400000 236003                    LDQ     -131072,DU
         6 001635   200004 756100                    STQ     FOUND,,AUTO

      966     5157    3           END;                            /* DO J                               */

   5157  6 001636   200017 054100                    AOS     J,,AUTO
         6 001637   200677 236100                    LDQ     TH_HEAD+5,,AUTO
         6 001640   777777 376007                    ANQ     -1,DL
         6 001641   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 001642   200677 236100                    LDQ     TH_HEAD+5,,AUTO
         6 001643   000022 772000                    QRL     18
         6 001644   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 001645   001624 604000 6                  TMI     s:5155
         6 001646   200017 116100                    CMPQ    J,,AUTO
         6 001647   001624 605400 6                  TPNZ    s:5155

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:166  
      967     5158    2           IF NOT FOUND

   5158  6 001650   200004 234100                    SZN     FOUND,,AUTO
         6 001651   001757 604000 6                  TMI     s:5179

      968     5159    2              THEN                         /* STUFF INTO TH_HEAD.DEVNAME         */
      969     5160    3              DO;

      970     5161    4                 DO K = TH_HEAD.CONSOLE_INDX TO LAST_INDX;

   5161  6 001652   200701 235100                    LDA     TH_HEAD+7,,AUTO
         6 001653   000022 771000                    ARL     18
         6 001654   200020 755100                    STA     K,,AUTO
         6 001655   001673 710000 6                  TRA     s:5164+1

      971     5162    4                    INDX = LAST_INDX - K + TH_HEAD.CONSOLE_INDX;

   5162  6 001656   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 001657   200020 136100                    SBLQ    K,,AUTO
         6 001660   200701 235100                    LDA     TH_HEAD+7,,AUTO
         6 001661   000022 771000                    ARL     18
         6 001662   210124 755100                    STA     TH_UTS+3,,AUTO
         6 001663   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 001664   200021 756100                    STQ     INDX,,AUTO

      972     5163    4                    TH_HEAD.DEVNAME(INDX + 1) = TH_HEAD.DEVNAME(INDX);

   5163  6 001665   200021 235100                    LDA     INDX,,AUTO
         6 001666   000001 735000                    ALS     1
         6 001667   000000 620005                    EAX0    0,AL
         6 001670   200712 237105                    LDAQ    TH_HEAD+16,AL,AUTO
         6 001671   200714 757110                    STAQ    TH_HEAD+18,X0,AUTO

      973     5164    4                 END;                      /* DO K                               */

   5164  6 001672   200020 054100                    AOS     K,,AUTO
         6 001673   200005 236100                    LDQ     LAST_INDX,,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:167  
         6 001674   001656 604000 6                  TMI     s:5162
         6 001675   200020 116100                    CMPQ    K,,AUTO
         6 001676   001656 605000 6                  TPL     s:5162

      974     5165    3                 TH_HEAD.NUMOPCS = TH_HEAD.NUMOPCS + 1;

   5165  6 001677   200677 720100                    LXL0    TH_HEAD+5,,AUTO
         6 001700   000001 621010                    EAX1    1,X0
         6 001701   200677 441100                    SXL1    TH_HEAD+5,,AUTO

      975     5166    3                 TH_HEAD.DEVNAME(TH_HEAD.OPC_INDX + TH_HEAD.NUMOPCS - 1) = TD_HEAD.
              5166                          DEVNAME(I);

   5166  6 001702   200677 236100                    LDQ     TH_HEAD+5,,AUTO
         6 001703   777777 376007                    ANQ     -1,DL
         6 001704   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 001705   200677 236100                    LDQ     TH_HEAD+5,,AUTO
         6 001706   000022 772000                    QRL     18
         6 001707   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 001710   000001 736000                    QLS     1
         6 001711   200016 235100                    LDA     I,,AUTO
         6 001712   000001 735000                    ALS     1
         6 001713   000000 620006                    EAX0    0,QL
         6 001714   200050 237105                    LDAQ    TD_HEAD+16,AL,AUTO
         6 001715   200710 757110                    STAQ    TH_HEAD+14,X0,AUTO

      976     5167    3                 LAST_INDX = LAST_INDX + 1;

   5167  6 001716   200005 235100                    LDA     LAST_INDX,,AUTO
         6 001717   000001 035007                    ADLA    1,DL
         6 001720   200005 755100                    STA     LAST_INDX,,AUTO

      977     5168    3                 TH_HEAD.CONSOLE_INDX = TH_HEAD.CONSOLE_INDX + 1;

   5168  6 001721   200701 220100                    LDX0    TH_HEAD+7,,AUTO
         6 001722   000001 621010                    EAX1    1,X0
         6 001723   200701 741100                    STX1    TH_HEAD+7,,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:168  

      978     5169    3                 TH_HEAD.LP_INDX = TH_HEAD.LP_INDX + 1;

   5169  6 001724   200702 220100                    LDX0    TH_HEAD+8,,AUTO
         6 001725   000001 622010                    EAX2    1,X0
         6 001726   200702 742100                    STX2    TH_HEAD+8,,AUTO

      979     5170    3                 TH_HEAD.CR_INDX = TH_HEAD.CR_INDX + 1;

   5170  6 001727   200703 220100                    LDX0    TH_HEAD+9,,AUTO
         6 001730   000001 623010                    EAX3    1,X0
         6 001731   200703 743100                    STX3    TH_HEAD+9,,AUTO

      980     5171    3                 TH_HEAD.CP_INDX = TH_HEAD.CP_INDX + 1;

   5171  6 001732   200704 220100                    LDX0    TH_HEAD+10,,AUTO
         6 001733   000001 624010                    EAX4    1,X0
         6 001734   200704 744100                    STX4    TH_HEAD+10,,AUTO

      981     5172    3                 TH_HEAD.DP_INDX = TH_HEAD.DP_INDX + 1;

   5172  6 001735   200705 220100                    LDX0    TH_HEAD+11,,AUTO
         6 001736   000001 625010                    EAX5    1,X0
         6 001737   200705 745100                    STX5    TH_HEAD+11,,AUTO

      982     5173    3                 TH_HEAD.MT_INDX = TH_HEAD.MT_INDX + 1;

   5173  6 001740   200706 220100                    LDX0    TH_HEAD+12,,AUTO
         6 001741   000001 626010                    EAX6    1,X0
         6 001742   200706 746100                    STX6    TH_HEAD+12,,AUTO

      983     5174    3                 TH_HEAD.XX_INDX = TH_HEAD.XX_INDX + 1;

   5174  6 001743   200707 220100                    LDX0    TH_HEAD+13,,AUTO
         6 001744   000001 627010                    EAX7    1,X0
         6 001745   200707 747100                    STX7    TH_HEAD+13,,AUTO

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:169  
      984     5175    3                 TH_HEAD.AP_INDX = TH_HEAD.AP_INDX + 1;

   5175  6 001746   200710 220100                    LDX0    TH_HEAD+14,,AUTO
         6 001747   000001 621010                    EAX1    1,X0
         6 001750   200710 741100                    STX1    TH_HEAD+14,,AUTO

      985     5176    3                 TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;

   5176  6 001751   200711 220100                    LDX0    TH_HEAD+15,,AUTO
         6 001752   000001 621010                    EAX1    1,X0
         6 001753   200711 741100                    STX1    TH_HEAD+15,,AUTO

      986     5177    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;

   5177  6 001754   000005 236000 4                  LDQ     NUM_NEW_COMPS
         6 001755   000001 036007                    ADLQ    1,DL
         6 001756   000005 756000 4                  STQ     NUM_NEW_COMPS

      987     5178    3              END;                         /* IF NOT FOUND                       */

      988     5179    2        END;                               /* DO I                               */

   5179  6 001757   200016 054100                    AOS     I,,AUTO
         6 001760   200035 236100                    LDQ     TD_HEAD+5,,AUTO
         6 001761   777777 376007                    ANQ     -1,DL
         6 001762   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 001763   200035 236100                    LDQ     TD_HEAD+5,,AUTO
         6 001764   000022 772000                    QRL     18
         6 001765   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 001766   001617 604000 6                  TMI     s:5153
         6 001767   200016 116100                    CMPQ    I,,AUTO
         6 001770   001617 605400 6                  TPNZ    s:5153

      989     5180
      990     5181                                                /* CHECK FOR LPS                      */
      991     5182    2        DO I = TD_HEAD.LP_INDX TO TD_HEAD.LP_INDX + TD_HEAD.NUMLPS - 1;

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:170  
   5182  6 001771   200040 235100                    LDA     TD_HEAD+8,,AUTO
         6 001772   000022 771000                    ARL     18
         6 001773   200016 755100                    STA     I,,AUTO
         6 001774   002130 710000 6                  TRA     s:5207+1

      992     5183    2           FOUND = %FALSE;

   5183  6 001775   200004 450100                    STZ     FOUND,,AUTO

      993     5184    3           DO J = TH_HEAD.LP_INDX TO TH_HEAD.LP_INDX + TH_HEAD.NUMLPS - 1;

   5184  6 001776   200702 235100                    LDA     TH_HEAD+8,,AUTO
         6 001777   000022 771000                    ARL     18
         6 002000   200017 755100                    STA     J,,AUTO
         6 002001   002015 710000 6                  TRA     s:5187+1

      994     5185    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)

   5185  6 002002   200017 235100                    LDA     J,,AUTO
         6 002003   000001 735000                    ALS     1
         6 002004   000000 620005                    EAX0    0,AL
         6 002005   200016 236100                    LDQ     I,,AUTO
         6 002006   000001 736000                    QLS     1
         6 002007   200050 237106                    LDAQ    TD_HEAD+16,QL,AUTO
         6 002010   200712 117110                    CMPAQ   TH_HEAD+16,X0,AUTO
         6 002011   002014 601000 6                  TNZ     s:5187

      995     5186    3                 THEN FOUND = %TRUE;

   5186  6 002012   400000 236003                    LDQ     -131072,DU
         6 002013   200004 756100                    STQ     FOUND,,AUTO

      996     5187    3           END;                            /* DO J                               */

   5187  6 002014   200017 054100                    AOS     J,,AUTO
         6 002015   200702 236100                    LDQ     TH_HEAD+8,,AUTO
         6 002016   777777 376007                    ANQ     -1,DL
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:171  
         6 002017   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 002020   200702 236100                    LDQ     TH_HEAD+8,,AUTO
         6 002021   000022 772000                    QRL     18
         6 002022   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 002023   002002 604000 6                  TMI     s:5185
         6 002024   200017 116100                    CMPQ    J,,AUTO
         6 002025   002002 605400 6                  TPNZ    s:5185

      997     5188    2           IF NOT FOUND

   5188  6 002026   200004 234100                    SZN     FOUND,,AUTO
         6 002027   002127 604000 6                  TMI     s:5207

      998     5189    2              THEN                         /* STUFF INTO TH_HEAD.DEVNAME         */
      999     5190    3              DO;

     1000     5191    4                 DO K = TH_HEAD.CR_INDX TO LAST_INDX;

   5191  6 002030   200703 235100                    LDA     TH_HEAD+9,,AUTO
         6 002031   000022 771000                    ARL     18
         6 002032   200020 755100                    STA     K,,AUTO
         6 002033   002051 710000 6                  TRA     s:5194+1

     1001     5192    4                    INDX = LAST_INDX - K + TH_HEAD.CR_INDX;

   5192  6 002034   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 002035   200020 136100                    SBLQ    K,,AUTO
         6 002036   200703 235100                    LDA     TH_HEAD+9,,AUTO
         6 002037   000022 771000                    ARL     18
         6 002040   210124 755100                    STA     TH_UTS+3,,AUTO
         6 002041   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 002042   200021 756100                    STQ     INDX,,AUTO

     1002     5193    4                    TH_HEAD.DEVNAME(INDX + 1) = TH_HEAD.DEVNAME(INDX);

   5193  6 002043   200021 235100                    LDA     INDX,,AUTO
         6 002044   000001 735000                    ALS     1
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:172  
         6 002045   000000 620005                    EAX0    0,AL
         6 002046   200712 237105                    LDAQ    TH_HEAD+16,AL,AUTO
         6 002047   200714 757110                    STAQ    TH_HEAD+18,X0,AUTO

     1003     5194    4                 END;                      /* DO K                               */

   5194  6 002050   200020 054100                    AOS     K,,AUTO
         6 002051   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 002052   002034 604000 6                  TMI     s:5192
         6 002053   200020 116100                    CMPQ    K,,AUTO
         6 002054   002034 605000 6                  TPL     s:5192

     1004     5195    3                 TH_HEAD.NUMLPS = TH_HEAD.NUMLPS + 1;

   5195  6 002055   200702 720100                    LXL0    TH_HEAD+8,,AUTO
         6 002056   000001 621010                    EAX1    1,X0
         6 002057   200702 441100                    SXL1    TH_HEAD+8,,AUTO

     1005     5196    3                 TH_HEAD.DEVNAME(TH_HEAD.LP_INDX + TH_HEAD.NUMLPS - 1) = TD_HEAD.
              5196                          DEVNAME(I);

   5196  6 002060   200702 236100                    LDQ     TH_HEAD+8,,AUTO
         6 002061   777777 376007                    ANQ     -1,DL
         6 002062   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 002063   200702 236100                    LDQ     TH_HEAD+8,,AUTO
         6 002064   000022 772000                    QRL     18
         6 002065   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 002066   000001 736000                    QLS     1
         6 002067   200016 235100                    LDA     I,,AUTO
         6 002070   000001 735000                    ALS     1
         6 002071   000000 620006                    EAX0    0,QL
         6 002072   200050 237105                    LDAQ    TD_HEAD+16,AL,AUTO
         6 002073   200710 757110                    STAQ    TH_HEAD+14,X0,AUTO

     1006     5197    3                 LAST_INDX = LAST_INDX + 1;

   5197  6 002074   200005 235100                    LDA     LAST_INDX,,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:173  
         6 002075   000001 035007                    ADLA    1,DL
         6 002076   200005 755100                    STA     LAST_INDX,,AUTO

     1007     5198    3                 TH_HEAD.CR_INDX = TH_HEAD.CR_INDX + 1;

   5198  6 002077   200703 220100                    LDX0    TH_HEAD+9,,AUTO
         6 002100   000001 621010                    EAX1    1,X0
         6 002101   200703 741100                    STX1    TH_HEAD+9,,AUTO

     1008     5199    3                 TH_HEAD.CP_INDX = TH_HEAD.CP_INDX + 1;

   5199  6 002102   200704 220100                    LDX0    TH_HEAD+10,,AUTO
         6 002103   000001 622010                    EAX2    1,X0
         6 002104   200704 742100                    STX2    TH_HEAD+10,,AUTO

     1009     5200    3                 TH_HEAD.DP_INDX = TH_HEAD.DP_INDX + 1;

   5200  6 002105   200705 220100                    LDX0    TH_HEAD+11,,AUTO
         6 002106   000001 623010                    EAX3    1,X0
         6 002107   200705 743100                    STX3    TH_HEAD+11,,AUTO

     1010     5201    3                 TH_HEAD.MT_INDX = TH_HEAD.MT_INDX + 1;

   5201  6 002110   200706 220100                    LDX0    TH_HEAD+12,,AUTO
         6 002111   000001 624010                    EAX4    1,X0
         6 002112   200706 744100                    STX4    TH_HEAD+12,,AUTO

     1011     5202    3                 TH_HEAD.XX_INDX = TH_HEAD.XX_INDX + 1;

   5202  6 002113   200707 220100                    LDX0    TH_HEAD+13,,AUTO
         6 002114   000001 625010                    EAX5    1,X0
         6 002115   200707 745100                    STX5    TH_HEAD+13,,AUTO

     1012     5203    3                 TH_HEAD.AP_INDX = TH_HEAD.AP_INDX + 1;

   5203  6 002116   200710 220100                    LDX0    TH_HEAD+14,,AUTO
         6 002117   000001 626010                    EAX6    1,X0
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:174  
         6 002120   200710 746100                    STX6    TH_HEAD+14,,AUTO

     1013     5204    3                 TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;

   5204  6 002121   200711 220100                    LDX0    TH_HEAD+15,,AUTO
         6 002122   000001 627010                    EAX7    1,X0
         6 002123   200711 747100                    STX7    TH_HEAD+15,,AUTO

     1014     5205    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;

   5205  6 002124   000005 236000 4                  LDQ     NUM_NEW_COMPS
         6 002125   000001 036007                    ADLQ    1,DL
         6 002126   000005 756000 4                  STQ     NUM_NEW_COMPS

     1015     5206    3              END;                         /* IF NOT FOUND                       */

     1016     5207    2        END;                               /* DO I                               */

   5207  6 002127   200016 054100                    AOS     I,,AUTO
         6 002130   200040 236100                    LDQ     TD_HEAD+8,,AUTO
         6 002131   777777 376007                    ANQ     -1,DL
         6 002132   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 002133   200040 236100                    LDQ     TD_HEAD+8,,AUTO
         6 002134   000022 772000                    QRL     18
         6 002135   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 002136   001775 604000 6                  TMI     s:5183
         6 002137   200016 116100                    CMPQ    I,,AUTO
         6 002140   001775 605400 6                  TPNZ    s:5183

     1017     5208
     1018     5209                                                /* CHECK FOR CRS                      */
     1019     5210    2        DO I = TD_HEAD.CR_INDX TO TD_HEAD.CR_INDX + TD_HEAD.NUMCRS - 1;

   5210  6 002141   200041 235100                    LDA     TD_HEAD+9,,AUTO
         6 002142   000022 771000                    ARL     18
         6 002143   200016 755100                    STA     I,,AUTO
         6 002144   002275 710000 6                  TRA     s:5234+1
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:175  

     1020     5211    2           FOUND = %FALSE;

   5211  6 002145   200004 450100                    STZ     FOUND,,AUTO

     1021     5212    3           DO J = TH_HEAD.CR_INDX TO TH_HEAD.CR_INDX + TH_HEAD.NUMCRS - 1;

   5212  6 002146   200703 235100                    LDA     TH_HEAD+9,,AUTO
         6 002147   000022 771000                    ARL     18
         6 002150   200017 755100                    STA     J,,AUTO
         6 002151   002165 710000 6                  TRA     s:5215+1

     1022     5213    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)

   5213  6 002152   200017 235100                    LDA     J,,AUTO
         6 002153   000001 735000                    ALS     1
         6 002154   000000 620005                    EAX0    0,AL
         6 002155   200016 236100                    LDQ     I,,AUTO
         6 002156   000001 736000                    QLS     1
         6 002157   200050 237106                    LDAQ    TD_HEAD+16,QL,AUTO
         6 002160   200712 117110                    CMPAQ   TH_HEAD+16,X0,AUTO
         6 002161   002164 601000 6                  TNZ     s:5215

     1023     5214    3                 THEN FOUND = %TRUE;

   5214  6 002162   400000 236003                    LDQ     -131072,DU
         6 002163   200004 756100                    STQ     FOUND,,AUTO

     1024     5215    3           END;                            /* DO J                               */

   5215  6 002164   200017 054100                    AOS     J,,AUTO
         6 002165   200703 236100                    LDQ     TH_HEAD+9,,AUTO
         6 002166   777777 376007                    ANQ     -1,DL
         6 002167   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 002170   200703 236100                    LDQ     TH_HEAD+9,,AUTO
         6 002171   000022 772000                    QRL     18
         6 002172   210124 036100                    ADLQ    TH_UTS+3,,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:176  
         6 002173   002152 604000 6                  TMI     s:5213
         6 002174   200017 116100                    CMPQ    J,,AUTO
         6 002175   002152 605400 6                  TPNZ    s:5213

     1025     5216    2           IF NOT FOUND

   5216  6 002176   200004 234100                    SZN     FOUND,,AUTO
         6 002177   002274 604000 6                  TMI     s:5234

     1026     5217    2              THEN                         /* STUFF INTO TH_HEAD.DEVNAME         */
     1027     5218    3              DO;

     1028     5219    4                 DO K = TH_HEAD.CP_INDX TO LAST_INDX;

   5219  6 002200   200704 235100                    LDA     TH_HEAD+10,,AUTO
         6 002201   000022 771000                    ARL     18
         6 002202   200020 755100                    STA     K,,AUTO
         6 002203   002221 710000 6                  TRA     s:5222+1

     1029     5220    4                    INDX = LAST_INDX - K + TH_HEAD.CP_INDX;

   5220  6 002204   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 002205   200020 136100                    SBLQ    K,,AUTO
         6 002206   200704 235100                    LDA     TH_HEAD+10,,AUTO
         6 002207   000022 771000                    ARL     18
         6 002210   210124 755100                    STA     TH_UTS+3,,AUTO
         6 002211   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 002212   200021 756100                    STQ     INDX,,AUTO

     1030     5221    4                    TH_HEAD.DEVNAME(INDX + 1) = TH_HEAD.DEVNAME(INDX);

   5221  6 002213   200021 235100                    LDA     INDX,,AUTO
         6 002214   000001 735000                    ALS     1
         6 002215   000000 620005                    EAX0    0,AL
         6 002216   200712 237105                    LDAQ    TH_HEAD+16,AL,AUTO
         6 002217   200714 757110                    STAQ    TH_HEAD+18,X0,AUTO

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:177  
     1031     5222    4                 END;                      /* DO K                               */

   5222  6 002220   200020 054100                    AOS     K,,AUTO
         6 002221   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 002222   002204 604000 6                  TMI     s:5220
         6 002223   200020 116100                    CMPQ    K,,AUTO
         6 002224   002204 605000 6                  TPL     s:5220

     1032     5223    3                 TH_HEAD.NUMCRS = TH_HEAD.NUMCRS + 1;

   5223  6 002225   200703 720100                    LXL0    TH_HEAD+9,,AUTO
         6 002226   000001 621010                    EAX1    1,X0
         6 002227   200703 441100                    SXL1    TH_HEAD+9,,AUTO

     1033     5224    3                 TH_HEAD.DEVNAME(TH_HEAD.CR_INDX + TH_HEAD.NUMCRS - 1) = TD_HEAD.
              5224                          DEVNAME(I);

   5224  6 002230   200703 236100                    LDQ     TH_HEAD+9,,AUTO
         6 002231   777777 376007                    ANQ     -1,DL
         6 002232   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 002233   200703 236100                    LDQ     TH_HEAD+9,,AUTO
         6 002234   000022 772000                    QRL     18
         6 002235   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 002236   000001 736000                    QLS     1
         6 002237   200016 235100                    LDA     I,,AUTO
         6 002240   000001 735000                    ALS     1
         6 002241   000000 620006                    EAX0    0,QL
         6 002242   200050 237105                    LDAQ    TD_HEAD+16,AL,AUTO
         6 002243   200710 757110                    STAQ    TH_HEAD+14,X0,AUTO

     1034     5225    3                 LAST_INDX = LAST_INDX + 1;

   5225  6 002244   200005 235100                    LDA     LAST_INDX,,AUTO
         6 002245   000001 035007                    ADLA    1,DL
         6 002246   200005 755100                    STA     LAST_INDX,,AUTO

     1035     5226    3                 TH_HEAD.CP_INDX = TH_HEAD.CP_INDX + 1;
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:178  

   5226  6 002247   200704 220100                    LDX0    TH_HEAD+10,,AUTO
         6 002250   000001 621010                    EAX1    1,X0
         6 002251   200704 741100                    STX1    TH_HEAD+10,,AUTO

     1036     5227    3                 TH_HEAD.DP_INDX = TH_HEAD.DP_INDX + 1;

   5227  6 002252   200705 220100                    LDX0    TH_HEAD+11,,AUTO
         6 002253   000001 622010                    EAX2    1,X0
         6 002254   200705 742100                    STX2    TH_HEAD+11,,AUTO

     1037     5228    3                 TH_HEAD.MT_INDX = TH_HEAD.MT_INDX + 1;

   5228  6 002255   200706 220100                    LDX0    TH_HEAD+12,,AUTO
         6 002256   000001 623010                    EAX3    1,X0
         6 002257   200706 743100                    STX3    TH_HEAD+12,,AUTO

     1038     5229    3                 TH_HEAD.XX_INDX = TH_HEAD.XX_INDX + 1;

   5229  6 002260   200707 220100                    LDX0    TH_HEAD+13,,AUTO
         6 002261   000001 624010                    EAX4    1,X0
         6 002262   200707 744100                    STX4    TH_HEAD+13,,AUTO

     1039     5230    3                 TH_HEAD.AP_INDX = TH_HEAD.AP_INDX + 1;

   5230  6 002263   200710 220100                    LDX0    TH_HEAD+14,,AUTO
         6 002264   000001 625010                    EAX5    1,X0
         6 002265   200710 745100                    STX5    TH_HEAD+14,,AUTO

     1040     5231    3                 TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;

   5231  6 002266   200711 220100                    LDX0    TH_HEAD+15,,AUTO
         6 002267   000001 626010                    EAX6    1,X0
         6 002270   200711 746100                    STX6    TH_HEAD+15,,AUTO

     1041     5232    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:179  
   5232  6 002271   000005 236000 4                  LDQ     NUM_NEW_COMPS
         6 002272   000001 036007                    ADLQ    1,DL
         6 002273   000005 756000 4                  STQ     NUM_NEW_COMPS

     1042     5233    3              END;                         /* IF NOT FOUND                       */

     1043     5234    2        END;                               /* DO I                               */

   5234  6 002274   200016 054100                    AOS     I,,AUTO
         6 002275   200041 236100                    LDQ     TD_HEAD+9,,AUTO
         6 002276   777777 376007                    ANQ     -1,DL
         6 002277   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 002300   200041 236100                    LDQ     TD_HEAD+9,,AUTO
         6 002301   000022 772000                    QRL     18
         6 002302   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 002303   002145 604000 6                  TMI     s:5211
         6 002304   200016 116100                    CMPQ    I,,AUTO
         6 002305   002145 605400 6                  TPNZ    s:5211

     1044     5235
     1045     5236                                                /* CHECK FOR CPS                      */
     1046     5237    2        DO I = TD_HEAD.CP_INDX TO TD_HEAD.CP_INDX + TD_HEAD.NUMCPS - 1;

   5237  6 002306   200042 235100                    LDA     TD_HEAD+10,,AUTO
         6 002307   000022 771000                    ARL     18
         6 002310   200016 755100                    STA     I,,AUTO
         6 002311   002437 710000 6                  TRA     s:5260+1

     1047     5238    2           FOUND = %FALSE;

   5238  6 002312   200004 450100                    STZ     FOUND,,AUTO

     1048     5239    3           DO J = TH_HEAD.CP_INDX TO TH_HEAD.CP_INDX + TH_HEAD.NUMCPS - 1;

   5239  6 002313   200704 235100                    LDA     TH_HEAD+10,,AUTO
         6 002314   000022 771000                    ARL     18
         6 002315   200017 755100                    STA     J,,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:180  
         6 002316   002332 710000 6                  TRA     s:5242+1

     1049     5240    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)

   5240  6 002317   200017 235100                    LDA     J,,AUTO
         6 002320   000001 735000                    ALS     1
         6 002321   000000 620005                    EAX0    0,AL
         6 002322   200016 236100                    LDQ     I,,AUTO
         6 002323   000001 736000                    QLS     1
         6 002324   200050 237106                    LDAQ    TD_HEAD+16,QL,AUTO
         6 002325   200712 117110                    CMPAQ   TH_HEAD+16,X0,AUTO
         6 002326   002331 601000 6                  TNZ     s:5242

     1050     5241    3                 THEN FOUND = %TRUE;

   5241  6 002327   400000 236003                    LDQ     -131072,DU
         6 002330   200004 756100                    STQ     FOUND,,AUTO

     1051     5242    3           END;                            /* DO J                               */

   5242  6 002331   200017 054100                    AOS     J,,AUTO
         6 002332   200704 236100                    LDQ     TH_HEAD+10,,AUTO
         6 002333   777777 376007                    ANQ     -1,DL
         6 002334   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 002335   200704 236100                    LDQ     TH_HEAD+10,,AUTO
         6 002336   000022 772000                    QRL     18
         6 002337   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 002340   002317 604000 6                  TMI     s:5240
         6 002341   200017 116100                    CMPQ    J,,AUTO
         6 002342   002317 605400 6                  TPNZ    s:5240

     1052     5243    2           IF NOT FOUND

   5243  6 002343   200004 234100                    SZN     FOUND,,AUTO
         6 002344   002436 604000 6                  TMI     s:5260

     1053     5244    2              THEN                         /* STUFF INTO TH_HEAD.DEVNAME         */
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:181  
     1054     5245    3              DO;

     1055     5246    4                 DO K = TH_HEAD.DP_INDX TO LAST_INDX;

   5246  6 002345   200705 235100                    LDA     TH_HEAD+11,,AUTO
         6 002346   000022 771000                    ARL     18
         6 002347   200020 755100                    STA     K,,AUTO
         6 002350   002366 710000 6                  TRA     s:5249+1

     1056     5247    4                    INDX = LAST_INDX - K + TH_HEAD.DP_INDX;

   5247  6 002351   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 002352   200020 136100                    SBLQ    K,,AUTO
         6 002353   200705 235100                    LDA     TH_HEAD+11,,AUTO
         6 002354   000022 771000                    ARL     18
         6 002355   210124 755100                    STA     TH_UTS+3,,AUTO
         6 002356   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 002357   200021 756100                    STQ     INDX,,AUTO

     1057     5248    4                    TH_HEAD.DEVNAME(INDX + 1) = TH_HEAD.DEVNAME(INDX);

   5248  6 002360   200021 235100                    LDA     INDX,,AUTO
         6 002361   000001 735000                    ALS     1
         6 002362   000000 620005                    EAX0    0,AL
         6 002363   200712 237105                    LDAQ    TH_HEAD+16,AL,AUTO
         6 002364   200714 757110                    STAQ    TH_HEAD+18,X0,AUTO

     1058     5249    4                 END;                      /* DO K                               */

   5249  6 002365   200020 054100                    AOS     K,,AUTO
         6 002366   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 002367   002351 604000 6                  TMI     s:5247
         6 002370   200020 116100                    CMPQ    K,,AUTO
         6 002371   002351 605000 6                  TPL     s:5247

     1059     5250    3                 TH_HEAD.NUMCPS = TH_HEAD.NUMCPS + 1;

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:182  
   5250  6 002372   200704 720100                    LXL0    TH_HEAD+10,,AUTO
         6 002373   000001 621010                    EAX1    1,X0
         6 002374   200704 441100                    SXL1    TH_HEAD+10,,AUTO

     1060     5251    3                 TH_HEAD.DEVNAME(TH_HEAD.CP_INDX + TH_HEAD.NUMCPS - 1) = TD_HEAD.
              5251                          DEVNAME(I);

   5251  6 002375   200704 236100                    LDQ     TH_HEAD+10,,AUTO
         6 002376   777777 376007                    ANQ     -1,DL
         6 002377   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 002400   200704 236100                    LDQ     TH_HEAD+10,,AUTO
         6 002401   000022 772000                    QRL     18
         6 002402   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 002403   000001 736000                    QLS     1
         6 002404   200016 235100                    LDA     I,,AUTO
         6 002405   000001 735000                    ALS     1
         6 002406   000000 620006                    EAX0    0,QL
         6 002407   200050 237105                    LDAQ    TD_HEAD+16,AL,AUTO
         6 002410   200710 757110                    STAQ    TH_HEAD+14,X0,AUTO

     1061     5252    3                 LAST_INDX = LAST_INDX + 1;

   5252  6 002411   200005 235100                    LDA     LAST_INDX,,AUTO
         6 002412   000001 035007                    ADLA    1,DL
         6 002413   200005 755100                    STA     LAST_INDX,,AUTO

     1062     5253    3                 TH_HEAD.DP_INDX = TH_HEAD.DP_INDX + 1;

   5253  6 002414   200705 220100                    LDX0    TH_HEAD+11,,AUTO
         6 002415   000001 621010                    EAX1    1,X0
         6 002416   200705 741100                    STX1    TH_HEAD+11,,AUTO

     1063     5254    3                 TH_HEAD.MT_INDX = TH_HEAD.MT_INDX + 1;

   5254  6 002417   200706 220100                    LDX0    TH_HEAD+12,,AUTO
         6 002420   000001 622010                    EAX2    1,X0
         6 002421   200706 742100                    STX2    TH_HEAD+12,,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:183  

     1064     5255    3                 TH_HEAD.XX_INDX = TH_HEAD.XX_INDX + 1;

   5255  6 002422   200707 220100                    LDX0    TH_HEAD+13,,AUTO
         6 002423   000001 623010                    EAX3    1,X0
         6 002424   200707 743100                    STX3    TH_HEAD+13,,AUTO

     1065     5256    3                 TH_HEAD.AP_INDX = TH_HEAD.AP_INDX + 1;

   5256  6 002425   200710 220100                    LDX0    TH_HEAD+14,,AUTO
         6 002426   000001 624010                    EAX4    1,X0
         6 002427   200710 744100                    STX4    TH_HEAD+14,,AUTO

     1066     5257    3                 TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;

   5257  6 002430   200711 220100                    LDX0    TH_HEAD+15,,AUTO
         6 002431   000001 625010                    EAX5    1,X0
         6 002432   200711 745100                    STX5    TH_HEAD+15,,AUTO

     1067     5258    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;

   5258  6 002433   000005 236000 4                  LDQ     NUM_NEW_COMPS
         6 002434   000001 036007                    ADLQ    1,DL
         6 002435   000005 756000 4                  STQ     NUM_NEW_COMPS

     1068     5259    3              END;                         /* IF NOT FOUND                       */

     1069     5260    2        END;                               /* DO I                               */

   5260  6 002436   200016 054100                    AOS     I,,AUTO
         6 002437   200042 236100                    LDQ     TD_HEAD+10,,AUTO
         6 002440   777777 376007                    ANQ     -1,DL
         6 002441   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 002442   200042 236100                    LDQ     TD_HEAD+10,,AUTO
         6 002443   000022 772000                    QRL     18
         6 002444   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 002445   002312 604000 6                  TMI     s:5238
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:184  
         6 002446   200016 116100                    CMPQ    I,,AUTO
         6 002447   002312 605400 6                  TPNZ    s:5238

     1070     5261
     1071     5262                                                /* CHECK FOR DPS                      */
     1072     5263    2        DO I = TD_HEAD.DP_INDX TO TD_HEAD.DP_INDX + TD_HEAD.NUMDPS - 1;

   5263  6 002450   200043 235100                    LDA     TD_HEAD+11,,AUTO
         6 002451   000022 771000                    ARL     18
         6 002452   200016 755100                    STA     I,,AUTO
         6 002453   002576 710000 6                  TRA     s:5285+1

     1073     5264    2           FOUND = %FALSE;

   5264  6 002454   200004 450100                    STZ     FOUND,,AUTO

     1074     5265    3           DO J = TH_HEAD.DP_INDX TO TH_HEAD.DP_INDX + TH_HEAD.NUMDPS - 1;

   5265  6 002455   200705 235100                    LDA     TH_HEAD+11,,AUTO
         6 002456   000022 771000                    ARL     18
         6 002457   200017 755100                    STA     J,,AUTO
         6 002460   002474 710000 6                  TRA     s:5268+1

     1075     5266    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)

   5266  6 002461   200017 235100                    LDA     J,,AUTO
         6 002462   000001 735000                    ALS     1
         6 002463   000000 620005                    EAX0    0,AL
         6 002464   200016 236100                    LDQ     I,,AUTO
         6 002465   000001 736000                    QLS     1
         6 002466   200050 237106                    LDAQ    TD_HEAD+16,QL,AUTO
         6 002467   200712 117110                    CMPAQ   TH_HEAD+16,X0,AUTO
         6 002470   002473 601000 6                  TNZ     s:5268

     1076     5267    3                 THEN FOUND = %TRUE;

   5267  6 002471   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:185  
         6 002472   200004 756100                    STQ     FOUND,,AUTO

     1077     5268    3           END;                            /* DO J                               */

   5268  6 002473   200017 054100                    AOS     J,,AUTO
         6 002474   200705 236100                    LDQ     TH_HEAD+11,,AUTO
         6 002475   777777 376007                    ANQ     -1,DL
         6 002476   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 002477   200705 236100                    LDQ     TH_HEAD+11,,AUTO
         6 002500   000022 772000                    QRL     18
         6 002501   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 002502   002461 604000 6                  TMI     s:5266
         6 002503   200017 116100                    CMPQ    J,,AUTO
         6 002504   002461 605400 6                  TPNZ    s:5266

     1078     5269    2           IF NOT FOUND

   5269  6 002505   200004 234100                    SZN     FOUND,,AUTO
         6 002506   002575 604000 6                  TMI     s:5285

     1079     5270    2              THEN                         /* STUFF INTO TH_HEAD.DEVNAME         */
     1080     5271    3              DO;

     1081     5272    4                 DO K = TH_HEAD.MT_INDX TO LAST_INDX;

   5272  6 002507   200706 235100                    LDA     TH_HEAD+12,,AUTO
         6 002510   000022 771000                    ARL     18
         6 002511   200020 755100                    STA     K,,AUTO
         6 002512   002530 710000 6                  TRA     s:5275+1

     1082     5273    4                    INDX = LAST_INDX - K + TH_HEAD.MT_INDX;

   5273  6 002513   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 002514   200020 136100                    SBLQ    K,,AUTO
         6 002515   200706 235100                    LDA     TH_HEAD+12,,AUTO
         6 002516   000022 771000                    ARL     18
         6 002517   210124 755100                    STA     TH_UTS+3,,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:186  
         6 002520   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 002521   200021 756100                    STQ     INDX,,AUTO

     1083     5274    4                    TH_HEAD.DEVNAME(INDX + 1) = TH_HEAD.DEVNAME(INDX);

   5274  6 002522   200021 235100                    LDA     INDX,,AUTO
         6 002523   000001 735000                    ALS     1
         6 002524   000000 620005                    EAX0    0,AL
         6 002525   200712 237105                    LDAQ    TH_HEAD+16,AL,AUTO
         6 002526   200714 757110                    STAQ    TH_HEAD+18,X0,AUTO

     1084     5275    4                 END;                      /* DO K                               */

   5275  6 002527   200020 054100                    AOS     K,,AUTO
         6 002530   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 002531   002513 604000 6                  TMI     s:5273
         6 002532   200020 116100                    CMPQ    K,,AUTO
         6 002533   002513 605000 6                  TPL     s:5273

     1085     5276    3                 TH_HEAD.NUMDPS = TH_HEAD.NUMDPS + 1;

   5276  6 002534   200705 720100                    LXL0    TH_HEAD+11,,AUTO
         6 002535   000001 621010                    EAX1    1,X0
         6 002536   200705 441100                    SXL1    TH_HEAD+11,,AUTO

     1086     5277    3                 TH_HEAD.DEVNAME(TH_HEAD.DP_INDX + TH_HEAD.NUMDPS - 1) = TD_HEAD.
              5277                          DEVNAME(I);

   5277  6 002537   200705 236100                    LDQ     TH_HEAD+11,,AUTO
         6 002540   777777 376007                    ANQ     -1,DL
         6 002541   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 002542   200705 236100                    LDQ     TH_HEAD+11,,AUTO
         6 002543   000022 772000                    QRL     18
         6 002544   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 002545   000001 736000                    QLS     1
         6 002546   200016 235100                    LDA     I,,AUTO
         6 002547   000001 735000                    ALS     1
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:187  
         6 002550   000000 620006                    EAX0    0,QL
         6 002551   200050 237105                    LDAQ    TD_HEAD+16,AL,AUTO
         6 002552   200710 757110                    STAQ    TH_HEAD+14,X0,AUTO

     1087     5278    3                 LAST_INDX = LAST_INDX + 1;

   5278  6 002553   200005 235100                    LDA     LAST_INDX,,AUTO
         6 002554   000001 035007                    ADLA    1,DL
         6 002555   200005 755100                    STA     LAST_INDX,,AUTO

     1088     5279    3                 TH_HEAD.MT_INDX = TH_HEAD.MT_INDX + 1;

   5279  6 002556   200706 220100                    LDX0    TH_HEAD+12,,AUTO
         6 002557   000001 621010                    EAX1    1,X0
         6 002560   200706 741100                    STX1    TH_HEAD+12,,AUTO

     1089     5280    3                 TH_HEAD.XX_INDX = TH_HEAD.XX_INDX + 1;

   5280  6 002561   200707 220100                    LDX0    TH_HEAD+13,,AUTO
         6 002562   000001 622010                    EAX2    1,X0
         6 002563   200707 742100                    STX2    TH_HEAD+13,,AUTO

     1090     5281    3                 TH_HEAD.AP_INDX = TH_HEAD.AP_INDX + 1;

   5281  6 002564   200710 220100                    LDX0    TH_HEAD+14,,AUTO
         6 002565   000001 623010                    EAX3    1,X0
         6 002566   200710 743100                    STX3    TH_HEAD+14,,AUTO

     1091     5282    3                 TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;

   5282  6 002567   200711 220100                    LDX0    TH_HEAD+15,,AUTO
         6 002570   000001 624010                    EAX4    1,X0
         6 002571   200711 744100                    STX4    TH_HEAD+15,,AUTO

     1092     5283    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;

   5283  6 002572   000005 236000 4                  LDQ     NUM_NEW_COMPS
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:188  
         6 002573   000001 036007                    ADLQ    1,DL
         6 002574   000005 756000 4                  STQ     NUM_NEW_COMPS

     1093     5284    3              END;                         /* IF NOT FOUND                       */

     1094     5285    2        END;                               /* DO I                               */

   5285  6 002575   200016 054100                    AOS     I,,AUTO
         6 002576   200043 236100                    LDQ     TD_HEAD+11,,AUTO
         6 002577   777777 376007                    ANQ     -1,DL
         6 002600   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 002601   200043 236100                    LDQ     TD_HEAD+11,,AUTO
         6 002602   000022 772000                    QRL     18
         6 002603   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 002604   002454 604000 6                  TMI     s:5264
         6 002605   200016 116100                    CMPQ    I,,AUTO
         6 002606   002454 605400 6                  TPNZ    s:5264

     1095     5286
     1096     5287                                                /* CHECK FOR MTS                      */
     1097     5288    2        DO I = TD_HEAD.MT_INDX TO TD_HEAD.MT_INDX + TD_HEAD.NUMMTS - 1;

   5288  6 002607   200044 235100                    LDA     TD_HEAD+12,,AUTO
         6 002610   000022 771000                    ARL     18
         6 002611   200016 755100                    STA     I,,AUTO
         6 002612   002732 710000 6                  TRA     s:5309+1

     1098     5289    2           FOUND = %FALSE;

   5289  6 002613   200004 450100                    STZ     FOUND,,AUTO

     1099     5290    3           DO J = TH_HEAD.MT_INDX TO TH_HEAD.MT_INDX + TH_HEAD.NUMMTS - 1;

   5290  6 002614   200706 235100                    LDA     TH_HEAD+12,,AUTO
         6 002615   000022 771000                    ARL     18
         6 002616   200017 755100                    STA     J,,AUTO
         6 002617   002633 710000 6                  TRA     s:5293+1
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:189  

     1100     5291    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)

   5291  6 002620   200017 235100                    LDA     J,,AUTO
         6 002621   000001 735000                    ALS     1
         6 002622   000000 620005                    EAX0    0,AL
         6 002623   200016 236100                    LDQ     I,,AUTO
         6 002624   000001 736000                    QLS     1
         6 002625   200050 237106                    LDAQ    TD_HEAD+16,QL,AUTO
         6 002626   200712 117110                    CMPAQ   TH_HEAD+16,X0,AUTO
         6 002627   002632 601000 6                  TNZ     s:5293

     1101     5292    3                 THEN FOUND = %TRUE;

   5292  6 002630   400000 236003                    LDQ     -131072,DU
         6 002631   200004 756100                    STQ     FOUND,,AUTO

     1102     5293    3           END;                            /* DO J                               */

   5293  6 002632   200017 054100                    AOS     J,,AUTO
         6 002633   200706 236100                    LDQ     TH_HEAD+12,,AUTO
         6 002634   777777 376007                    ANQ     -1,DL
         6 002635   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 002636   200706 236100                    LDQ     TH_HEAD+12,,AUTO
         6 002637   000022 772000                    QRL     18
         6 002640   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 002641   002620 604000 6                  TMI     s:5291
         6 002642   200017 116100                    CMPQ    J,,AUTO
         6 002643   002620 605400 6                  TPNZ    s:5291

     1103     5294    2           IF NOT FOUND

   5294  6 002644   200004 234100                    SZN     FOUND,,AUTO
         6 002645   002731 604000 6                  TMI     s:5309

     1104     5295    2              THEN                         /* STUFF INTO TH_HEAD.DEVNAME         */
     1105     5296    3              DO;
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:190  

     1106     5297    4                 DO K = TH_HEAD.XX_INDX TO LAST_INDX;

   5297  6 002646   200707 235100                    LDA     TH_HEAD+13,,AUTO
         6 002647   000022 771000                    ARL     18
         6 002650   200020 755100                    STA     K,,AUTO
         6 002651   002667 710000 6                  TRA     s:5300+1

     1107     5298    4                    INDX = LAST_INDX - K + TH_HEAD.XX_INDX;

   5298  6 002652   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 002653   200020 136100                    SBLQ    K,,AUTO
         6 002654   200707 235100                    LDA     TH_HEAD+13,,AUTO
         6 002655   000022 771000                    ARL     18
         6 002656   210124 755100                    STA     TH_UTS+3,,AUTO
         6 002657   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 002660   200021 756100                    STQ     INDX,,AUTO

     1108     5299    4                    TH_HEAD.DEVNAME(INDX + 1) = TH_HEAD.DEVNAME(INDX);

   5299  6 002661   200021 235100                    LDA     INDX,,AUTO
         6 002662   000001 735000                    ALS     1
         6 002663   000000 620005                    EAX0    0,AL
         6 002664   200712 237105                    LDAQ    TH_HEAD+16,AL,AUTO
         6 002665   200714 757110                    STAQ    TH_HEAD+18,X0,AUTO

     1109     5300    4                 END;                      /* DO K                               */

   5300  6 002666   200020 054100                    AOS     K,,AUTO
         6 002667   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 002670   002652 604000 6                  TMI     s:5298
         6 002671   200020 116100                    CMPQ    K,,AUTO
         6 002672   002652 605000 6                  TPL     s:5298

     1110     5301    3                 TH_HEAD.NUMMTS = TH_HEAD.NUMMTS + 1;

   5301  6 002673   200706 720100                    LXL0    TH_HEAD+12,,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:191  
         6 002674   000001 621010                    EAX1    1,X0
         6 002675   200706 441100                    SXL1    TH_HEAD+12,,AUTO

     1111     5302    3                 TH_HEAD.DEVNAME(TH_HEAD.MT_INDX + TH_HEAD.NUMMTS - 1) = TD_HEAD.
              5302                          DEVNAME(I);

   5302  6 002676   200706 236100                    LDQ     TH_HEAD+12,,AUTO
         6 002677   777777 376007                    ANQ     -1,DL
         6 002700   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 002701   200706 236100                    LDQ     TH_HEAD+12,,AUTO
         6 002702   000022 772000                    QRL     18
         6 002703   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 002704   000001 736000                    QLS     1
         6 002705   200016 235100                    LDA     I,,AUTO
         6 002706   000001 735000                    ALS     1
         6 002707   000000 620006                    EAX0    0,QL
         6 002710   200050 237105                    LDAQ    TD_HEAD+16,AL,AUTO
         6 002711   200710 757110                    STAQ    TH_HEAD+14,X0,AUTO

     1112     5303    3                 LAST_INDX = LAST_INDX + 1;

   5303  6 002712   200005 235100                    LDA     LAST_INDX,,AUTO
         6 002713   000001 035007                    ADLA    1,DL
         6 002714   200005 755100                    STA     LAST_INDX,,AUTO

     1113     5304    3                 TH_HEAD.XX_INDX = TH_HEAD.XX_INDX + 1;

   5304  6 002715   200707 220100                    LDX0    TH_HEAD+13,,AUTO
         6 002716   000001 621010                    EAX1    1,X0
         6 002717   200707 741100                    STX1    TH_HEAD+13,,AUTO

     1114     5305    3                 TH_HEAD.AP_INDX = TH_HEAD.AP_INDX + 1;

   5305  6 002720   200710 220100                    LDX0    TH_HEAD+14,,AUTO
         6 002721   000001 622010                    EAX2    1,X0
         6 002722   200710 742100                    STX2    TH_HEAD+14,,AUTO

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:192  
     1115     5306    3                 TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;

   5306  6 002723   200711 220100                    LDX0    TH_HEAD+15,,AUTO
         6 002724   000001 623010                    EAX3    1,X0
         6 002725   200711 743100                    STX3    TH_HEAD+15,,AUTO

     1116     5307    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;

   5307  6 002726   000005 236000 4                  LDQ     NUM_NEW_COMPS
         6 002727   000001 036007                    ADLQ    1,DL
         6 002730   000005 756000 4                  STQ     NUM_NEW_COMPS

     1117     5308    3              END;                         /* IF NOT FOUND                       */

     1118     5309    2        END;                               /* DO I                               */

   5309  6 002731   200016 054100                    AOS     I,,AUTO
         6 002732   200044 236100                    LDQ     TD_HEAD+12,,AUTO
         6 002733   777777 376007                    ANQ     -1,DL
         6 002734   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 002735   200044 236100                    LDQ     TD_HEAD+12,,AUTO
         6 002736   000022 772000                    QRL     18
         6 002737   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 002740   002613 604000 6                  TMI     s:5289
         6 002741   200016 116100                    CMPQ    I,,AUTO
         6 002742   002613 605400 6                  TPNZ    s:5289

     1119     5310
     1120     5311                                                /* CHECK FOR XXS (dummy for old 7T's) */
     1121     5312    2           DO I = TD_HEAD.XX_INDX TO TD_HEAD.XX_INDX + TD_HEAD.NUMXXS - 1;

   5312  6 002743   200045 235100                    LDA     TD_HEAD+13,,AUTO
         6 002744   000022 771000                    ARL     18
         6 002745   200016 755100                    STA     I,,AUTO
         6 002746   003063 710000 6                  TRA     s:5332+1

     1122     5313    2           FOUND = %FALSE;
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:193  

   5313  6 002747   200004 450100                    STZ     FOUND,,AUTO

     1123     5314    3              DO J = TH_HEAD.XX_INDX TO TH_HEAD.XX_INDX + TH_HEAD.NUMXXS - 1;

   5314  6 002750   200707 235100                    LDA     TH_HEAD+13,,AUTO
         6 002751   000022 771000                    ARL     18
         6 002752   200017 755100                    STA     J,,AUTO
         6 002753   002767 710000 6                  TRA     s:5317+1

     1124     5315    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)

   5315  6 002754   200017 235100                    LDA     J,,AUTO
         6 002755   000001 735000                    ALS     1
         6 002756   000000 620005                    EAX0    0,AL
         6 002757   200016 236100                    LDQ     I,,AUTO
         6 002760   000001 736000                    QLS     1
         6 002761   200050 237106                    LDAQ    TD_HEAD+16,QL,AUTO
         6 002762   200712 117110                    CMPAQ   TH_HEAD+16,X0,AUTO
         6 002763   002766 601000 6                  TNZ     s:5317

     1125     5316    3                 THEN FOUND = %TRUE;

   5316  6 002764   400000 236003                    LDQ     -131072,DU
         6 002765   200004 756100                    STQ     FOUND,,AUTO

     1126     5317    3           END;                            /* DO J                               */

   5317  6 002766   200017 054100                    AOS     J,,AUTO
         6 002767   200707 236100                    LDQ     TH_HEAD+13,,AUTO
         6 002770   777777 376007                    ANQ     -1,DL
         6 002771   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 002772   200707 236100                    LDQ     TH_HEAD+13,,AUTO
         6 002773   000022 772000                    QRL     18
         6 002774   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 002775   002754 604000 6                  TMI     s:5315
         6 002776   200017 116100                    CMPQ    J,,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:194  
         6 002777   002754 605400 6                  TPNZ    s:5315

     1127     5318    2           IF NOT FOUND

   5318  6 003000   200004 234100                    SZN     FOUND,,AUTO
         6 003001   003062 604000 6                  TMI     s:5332

     1128     5319    2              THEN                         /* STUFF INTO TH_HEAD.DEVNAME         */
     1129     5320    3              DO;

     1130     5321    4                 DO K = TH_HEAD.AP_INDX TO LAST_INDX;

   5321  6 003002   200710 235100                    LDA     TH_HEAD+14,,AUTO
         6 003003   000022 771000                    ARL     18
         6 003004   200020 755100                    STA     K,,AUTO
         6 003005   003023 710000 6                  TRA     s:5324+1

     1131     5322    4                    INDX = LAST_INDX - K + TH_HEAD.AP_INDX;

   5322  6 003006   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 003007   200020 136100                    SBLQ    K,,AUTO
         6 003010   200710 235100                    LDA     TH_HEAD+14,,AUTO
         6 003011   000022 771000                    ARL     18
         6 003012   210124 755100                    STA     TH_UTS+3,,AUTO
         6 003013   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 003014   200021 756100                    STQ     INDX,,AUTO

     1132     5323    4                    TH_HEAD.DEVNAME(INDX + 1) = TH_HEAD.DEVNAME(INDX);

   5323  6 003015   200021 235100                    LDA     INDX,,AUTO
         6 003016   000001 735000                    ALS     1
         6 003017   000000 620005                    EAX0    0,AL
         6 003020   200712 237105                    LDAQ    TH_HEAD+16,AL,AUTO
         6 003021   200714 757110                    STAQ    TH_HEAD+18,X0,AUTO

     1133     5324    4                 END;                      /* DO K                               */

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:195  
   5324  6 003022   200020 054100                    AOS     K,,AUTO
         6 003023   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 003024   003006 604000 6                  TMI     s:5322
         6 003025   200020 116100                    CMPQ    K,,AUTO
         6 003026   003006 605000 6                  TPL     s:5322

     1134     5325    3                 TH_HEAD.NUMXXS = TH_HEAD.NUMXXS + 1;

   5325  6 003027   200707 720100                    LXL0    TH_HEAD+13,,AUTO
         6 003030   000001 621010                    EAX1    1,X0
         6 003031   200707 441100                    SXL1    TH_HEAD+13,,AUTO

     1135     5326    3                 TH_HEAD.DEVNAME(TH_HEAD.XX_INDX + TH_HEAD.NUMXXS - 1) = TD_HEAD.
              5326                          DEVNAME(I);

   5326  6 003032   200707 236100                    LDQ     TH_HEAD+13,,AUTO
         6 003033   777777 376007                    ANQ     -1,DL
         6 003034   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 003035   200707 236100                    LDQ     TH_HEAD+13,,AUTO
         6 003036   000022 772000                    QRL     18
         6 003037   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 003040   000001 736000                    QLS     1
         6 003041   200016 235100                    LDA     I,,AUTO
         6 003042   000001 735000                    ALS     1
         6 003043   000000 620006                    EAX0    0,QL
         6 003044   200050 237105                    LDAQ    TD_HEAD+16,AL,AUTO
         6 003045   200710 757110                    STAQ    TH_HEAD+14,X0,AUTO

     1136     5327    3                 LAST_INDX = LAST_INDX + 1;

   5327  6 003046   200005 235100                    LDA     LAST_INDX,,AUTO
         6 003047   000001 035007                    ADLA    1,DL
         6 003050   200005 755100                    STA     LAST_INDX,,AUTO

     1137     5328    3                 TH_HEAD.AP_INDX = TH_HEAD.AP_INDX + 1;

   5328  6 003051   200710 220100                    LDX0    TH_HEAD+14,,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:196  
         6 003052   000001 621010                    EAX1    1,X0
         6 003053   200710 741100                    STX1    TH_HEAD+14,,AUTO

     1138     5329    3                 TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;

   5329  6 003054   200711 220100                    LDX0    TH_HEAD+15,,AUTO
         6 003055   000001 622010                    EAX2    1,X0
         6 003056   200711 742100                    STX2    TH_HEAD+15,,AUTO

     1139     5330    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;

   5330  6 003057   000005 236000 4                  LDQ     NUM_NEW_COMPS
         6 003060   000001 036007                    ADLQ    1,DL
         6 003061   000005 756000 4                  STQ     NUM_NEW_COMPS

     1140     5331    3              END;                         /* IF NOT FOUND                       */

     1141     5332    2        END;                               /* DO I                               */

   5332  6 003062   200016 054100                    AOS     I,,AUTO
         6 003063   200045 236100                    LDQ     TD_HEAD+13,,AUTO
         6 003064   777777 376007                    ANQ     -1,DL
         6 003065   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 003066   200045 236100                    LDQ     TD_HEAD+13,,AUTO
         6 003067   000022 772000                    QRL     18
         6 003070   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 003071   002747 604000 6                  TMI     s:5313
         6 003072   200016 116100                    CMPQ    I,,AUTO
         6 003073   002747 605400 6                  TPNZ    s:5313

     1142     5333
     1143     5334                                                /* CHECK FOR  APS                     */
     1144     5335    2        DO I = TD_HEAD.AP_INDX TO TD_HEAD.AP_INDX + TD_HEAD.NUMAPS - 1;

   5335  6 003074   200046 235100                    LDA     TD_HEAD+14,,AUTO
         6 003075   000022 771000                    ARL     18
         6 003076   200016 755100                    STA     I,,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:197  
         6 003077   003211 710000 6                  TRA     s:5354+1

     1145     5336    2           FOUND = %FALSE;

   5336  6 003100   200004 450100                    STZ     FOUND,,AUTO

     1146     5337    3           DO J = TH_HEAD.AP_INDX TO TH_HEAD.AP_INDX + TH_HEAD.NUMAPS - 1;

   5337  6 003101   200710 235100                    LDA     TH_HEAD+14,,AUTO
         6 003102   000022 771000                    ARL     18
         6 003103   200017 755100                    STA     J,,AUTO
         6 003104   003120 710000 6                  TRA     s:5340+1

     1147     5338    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)

   5338  6 003105   200017 235100                    LDA     J,,AUTO
         6 003106   000001 735000                    ALS     1
         6 003107   000000 620005                    EAX0    0,AL
         6 003110   200016 236100                    LDQ     I,,AUTO
         6 003111   000001 736000                    QLS     1
         6 003112   200050 237106                    LDAQ    TD_HEAD+16,QL,AUTO
         6 003113   200712 117110                    CMPAQ   TH_HEAD+16,X0,AUTO
         6 003114   003117 601000 6                  TNZ     s:5340

     1148     5339    3                 THEN FOUND = %TRUE;

   5339  6 003115   400000 236003                    LDQ     -131072,DU
         6 003116   200004 756100                    STQ     FOUND,,AUTO

     1149     5340    3           END;                            /* DO J                               */

   5340  6 003117   200017 054100                    AOS     J,,AUTO
         6 003120   200710 236100                    LDQ     TH_HEAD+14,,AUTO
         6 003121   777777 376007                    ANQ     -1,DL
         6 003122   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 003123   200710 236100                    LDQ     TH_HEAD+14,,AUTO
         6 003124   000022 772000                    QRL     18
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:198  
         6 003125   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 003126   003105 604000 6                  TMI     s:5338
         6 003127   200017 116100                    CMPQ    J,,AUTO
         6 003130   003105 605400 6                  TPNZ    s:5338

     1150     5341    2           IF NOT FOUND

   5341  6 003131   200004 234100                    SZN     FOUND,,AUTO
         6 003132   003210 604000 6                  TMI     s:5354

     1151     5342    2              THEN                         /* STUFF INTO TH_HEAD.DEVNAME         */
     1152     5343    3              DO;

     1153     5344    4                 DO K = TH_HEAD.OD_INDX TO LAST_INDX;

   5344  6 003133   200711 235100                    LDA     TH_HEAD+15,,AUTO
         6 003134   000022 771000                    ARL     18
         6 003135   200020 755100                    STA     K,,AUTO
         6 003136   003154 710000 6                  TRA     s:5347+1

     1154     5345    4                    INDX = LAST_INDX - K + TH_HEAD.OD_INDX;

   5345  6 003137   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 003140   200020 136100                    SBLQ    K,,AUTO
         6 003141   200711 235100                    LDA     TH_HEAD+15,,AUTO
         6 003142   000022 771000                    ARL     18
         6 003143   210124 755100                    STA     TH_UTS+3,,AUTO
         6 003144   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 003145   200021 756100                    STQ     INDX,,AUTO

     1155     5346    4                    TH_HEAD.DEVNAME(INDX + 1) = TH_HEAD.DEVNAME(INDX);

   5346  6 003146   200021 235100                    LDA     INDX,,AUTO
         6 003147   000001 735000                    ALS     1
         6 003150   000000 620005                    EAX0    0,AL
         6 003151   200712 237105                    LDAQ    TH_HEAD+16,AL,AUTO
         6 003152   200714 757110                    STAQ    TH_HEAD+18,X0,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:199  

     1156     5347    4                 END;                      /* DO K                               */

   5347  6 003153   200020 054100                    AOS     K,,AUTO
         6 003154   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 003155   003137 604000 6                  TMI     s:5345
         6 003156   200020 116100                    CMPQ    K,,AUTO
         6 003157   003137 605000 6                  TPL     s:5345

     1157     5348    3                 TH_HEAD.NUMAPS = TH_HEAD.NUMAPS + 1;

   5348  6 003160   200710 720100                    LXL0    TH_HEAD+14,,AUTO
         6 003161   000001 621010                    EAX1    1,X0
         6 003162   200710 441100                    SXL1    TH_HEAD+14,,AUTO

     1158     5349    3                 TH_HEAD.DEVNAME(TH_HEAD.AP_INDX + TH_HEAD.NUMAPS - 1) = TD_HEAD.
              5349                          DEVNAME(I);

   5349  6 003163   200710 236100                    LDQ     TH_HEAD+14,,AUTO
         6 003164   777777 376007                    ANQ     -1,DL
         6 003165   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 003166   200710 236100                    LDQ     TH_HEAD+14,,AUTO
         6 003167   000022 772000                    QRL     18
         6 003170   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 003171   000001 736000                    QLS     1
         6 003172   200016 235100                    LDA     I,,AUTO
         6 003173   000001 735000                    ALS     1
         6 003174   000000 620006                    EAX0    0,QL
         6 003175   200050 237105                    LDAQ    TD_HEAD+16,AL,AUTO
         6 003176   200710 757110                    STAQ    TH_HEAD+14,X0,AUTO

     1159     5350    3                 LAST_INDX = LAST_INDX + 1;

   5350  6 003177   200005 235100                    LDA     LAST_INDX,,AUTO
         6 003200   000001 035007                    ADLA    1,DL
         6 003201   200005 755100                    STA     LAST_INDX,,AUTO

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:200  
     1160     5351    3                 TH_HEAD.OD_INDX = TH_HEAD.OD_INDX + 1;

   5351  6 003202   200711 220100                    LDX0    TH_HEAD+15,,AUTO
         6 003203   000001 621010                    EAX1    1,X0
         6 003204   200711 741100                    STX1    TH_HEAD+15,,AUTO

     1161     5352    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;

   5352  6 003205   000005 236000 4                  LDQ     NUM_NEW_COMPS
         6 003206   000001 036007                    ADLQ    1,DL
         6 003207   000005 756000 4                  STQ     NUM_NEW_COMPS

     1162     5353    3              END;                         /* IF NOT FOUND                       */

     1163     5354    2        END;                               /* DO I                               */

   5354  6 003210   200016 054100                    AOS     I,,AUTO
         6 003211   200046 236100                    LDQ     TD_HEAD+14,,AUTO
         6 003212   777777 376007                    ANQ     -1,DL
         6 003213   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 003214   200046 236100                    LDQ     TD_HEAD+14,,AUTO
         6 003215   000022 772000                    QRL     18
         6 003216   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 003217   003100 604000 6                  TMI     s:5336
         6 003220   200016 116100                    CMPQ    I,,AUTO
         6 003221   003100 605400 6                  TPNZ    s:5336

     1164     5355
     1165     5356
     1166     5357                                                /* CHECK FOR  ODS                     */
     1167     5358    2        DO I = TD_HEAD.OD_INDX TO TD_HEAD.OD_INDX + TD_HEAD.NUMODS - 1;

   5358  6 003222   200047 235100                    LDA     TD_HEAD+15,,AUTO
         6 003223   000022 771000                    ARL     18
         6 003224   200016 755100                    STA     I,,AUTO
         6 003225   003307 710000 6                  TRA     s:5372+1

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:201  
     1168     5359    2           FOUND = %FALSE;

   5359  6 003226   200004 450100                    STZ     FOUND,,AUTO

     1169     5360    3           DO J = TH_HEAD.OD_INDX TO TH_HEAD.OD_INDX + TH_HEAD.NUMODS - 1;

   5360  6 003227   200711 235100                    LDA     TH_HEAD+15,,AUTO
         6 003230   000022 771000                    ARL     18
         6 003231   200017 755100                    STA     J,,AUTO
         6 003232   003246 710000 6                  TRA     s:5363+1

     1170     5361    3              IF TD_HEAD.DEVNAME(I) = TH_HEAD.DEVNAME(J)

   5361  6 003233   200017 235100                    LDA     J,,AUTO
         6 003234   000001 735000                    ALS     1
         6 003235   000000 620005                    EAX0    0,AL
         6 003236   200016 236100                    LDQ     I,,AUTO
         6 003237   000001 736000                    QLS     1
         6 003240   200050 237106                    LDAQ    TD_HEAD+16,QL,AUTO
         6 003241   200712 117110                    CMPAQ   TH_HEAD+16,X0,AUTO
         6 003242   003245 601000 6                  TNZ     s:5363

     1171     5362    3                 THEN FOUND = %TRUE;

   5362  6 003243   400000 236003                    LDQ     -131072,DU
         6 003244   200004 756100                    STQ     FOUND,,AUTO

     1172     5363    3           END;                            /* DO J                               */

   5363  6 003245   200017 054100                    AOS     J,,AUTO
         6 003246   200711 236100                    LDQ     TH_HEAD+15,,AUTO
         6 003247   777777 376007                    ANQ     -1,DL
         6 003250   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 003251   200711 236100                    LDQ     TH_HEAD+15,,AUTO
         6 003252   000022 772000                    QRL     18
         6 003253   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 003254   003233 604000 6                  TMI     s:5361
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:202  
         6 003255   200017 116100                    CMPQ    J,,AUTO
         6 003256   003233 605400 6                  TPNZ    s:5361

     1173     5364    2           IF NOT FOUND

   5364  6 003257   200004 234100                    SZN     FOUND,,AUTO
         6 003260   003306 604000 6                  TMI     s:5372

     1174     5365    2              THEN                         /* STUFF INTO TH_HEAD.DEVNAME         */
     1175     5366    3              DO;

     1176     5367    3                 TH_HEAD.NUMODS = TH_HEAD.NUMODS + 1;

   5367  6 003261   200711 720100                    LXL0    TH_HEAD+15,,AUTO
         6 003262   000001 621010                    EAX1    1,X0
         6 003263   200711 441100                    SXL1    TH_HEAD+15,,AUTO

     1177     5368    3                 TH_HEAD.DEVNAME(TH_HEAD.OD_INDX + TH_HEAD.NUMODS - 1) = TD_HEAD.
              5368                          DEVNAME(I);

   5368  6 003264   200711 236100                    LDQ     TH_HEAD+15,,AUTO
         6 003265   777777 376007                    ANQ     -1,DL
         6 003266   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 003267   200711 236100                    LDQ     TH_HEAD+15,,AUTO
         6 003270   000022 772000                    QRL     18
         6 003271   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 003272   000001 736000                    QLS     1
         6 003273   200016 235100                    LDA     I,,AUTO
         6 003274   000001 735000                    ALS     1
         6 003275   000000 620006                    EAX0    0,QL
         6 003276   200050 237105                    LDAQ    TD_HEAD+16,AL,AUTO
         6 003277   200710 757110                    STAQ    TH_HEAD+14,X0,AUTO

     1178     5369    3                 LAST_INDX = LAST_INDX + 1;

   5369  6 003300   200005 235100                    LDA     LAST_INDX,,AUTO
         6 003301   000001 035007                    ADLA    1,DL
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:203  
         6 003302   200005 755100                    STA     LAST_INDX,,AUTO

     1179     5370    3                 NUM_NEW_COMPS = NUM_NEW_COMPS + 1;

   5370  6 003303   000005 236000 4                  LDQ     NUM_NEW_COMPS
         6 003304   000001 036007                    ADLQ    1,DL
         6 003305   000005 756000 4                  STQ     NUM_NEW_COMPS

     1180     5371    3              END;                         /* IF NOT FOUND                       */

     1181     5372    2        END;                               /* DO I                               */

   5372  6 003306   200016 054100                    AOS     I,,AUTO
         6 003307   200047 236100                    LDQ     TD_HEAD+15,,AUTO
         6 003310   777777 376007                    ANQ     -1,DL
         6 003311   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 003312   200047 236100                    LDQ     TD_HEAD+15,,AUTO
         6 003313   000022 772000                    QRL     18
         6 003314   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 003315   003226 604000 6                  TMI     s:5359
         6 003316   200016 116100                    CMPQ    I,,AUTO
         6 003317   003226 605400 6                  TPNZ    s:5359

     1182     5373
     1183     5374    1        IF NUM_NEW_COMPS > 0

   5374  6 003320   000005 235000 4                  LDA     NUM_NEW_COMPS
         6 003321   003514 600000 6                  TZE     BYPASS_CHECK

     1184     5375    1           THEN                            /* UPDATE THRESH AND MAINT RECORDS    */
     1185     5376    2           DO;

     1186     5377    2              CALL THG$GETREC(%DEVHIST,ONE); /* THRESH RECORD                    */

   5377  6 003322   000011 630400 7                  EPPR0   9
         6 003323   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 003324   000000 701000 xent               TSX1    THG$GETREC
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:204  
         6 003325   000000 011000                    NOP     0

     1187     5378    2              TH_THRESH = TH_RECORD.PTR$->TH$THRESH;

   5378  6 003326   000001 470400 xsym               LDP0    TH_RECORD+1
         6 003327   000100 100500                    MLR     fill='000'O
         6 003330   000000 006220                    ADSC9   0,,PR0                   cn=0,n=3216
         6 003331   201534 006220                    ADSC9   TH_THRESH,,AUTO          cn=0,n=3216

     1188     5379    2              CALL THG$GETREC(%DEVHIST,TWO); /* MAINT RECORD                     */

   5379  6 003332   000013 630400 7                  EPPR0   11
         6 003333   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 003334   000000 701000 xent               TSX1    THG$GETREC
         6 003335   000000 011000                    NOP     0

     1189     5380    2              TH_MAINT = TH_RECORD.PTR$->TH$MAINT;

   5380  6 003336   000001 470400 xsym               LDP0    TH_RECORD+1
         6 003337   000100 100500                    MLR     fill='000'O
         6 003340   000000 004554                    ADSC9   0,,PR0                   cn=0,n=2412
         6 003341   204644 004554                    ADSC9   TH_MAINT,,AUTO           cn=0,n=2412

     1190     5381    2              J = 0;

   5381  6 003342   200017 450100                    STZ     J,,AUTO

     1191     5382    3              DO I = 0 TO LAST_INDX;

   5382  6 003343   200016 450100                    STZ     I,,AUTO
         6 003344   003431 710000 6                  TRA     s:5398+1

     1192     5383    3                 IF (J <= OLD_INDX) AND (TH_MAINT.DEVNAME(J) = TH_HEAD.DEVNAME(I))

   5383  6 003345   200006 236100                    LDQ     OLD_INDX,,AUTO
         6 003346   003351 604000 6                  TMI     s:5383+4
         6 003347   200017 116100                    CMPQ    J,,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:205  
         6 003350   003401 604000 6                  TMI     s:5392
         6 003351   200017 236100                    LDQ     J,,AUTO
         6 003352   000014 402007                    MPY     12,DL
         6 003353   200016 235100                    LDA     I,,AUTO
         6 003354   000003 735000                    ALS     3
         6 003355   040105 106506                    CMPC    fill='040'O
         6 003356   204644 000010                    ADSC9   TH_MAINT,Q,AUTO          cn=0,n=8
         6 003357   200712 000010                    ADSC9   TH_HEAD+16,A,AUTO        cn=0,n=8
         6 003360   003401 601000 6                  TNZ     s:5392

     1193     5384    3                    THEN                   /* OLD COMPONENT                      */
     1194     5385    4                    DO;

     1195     5386    4                       TEMP_MAINT(I) = TH_MAINT(J);

   5386  6 003361   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 003362   200016 236100                    LDQ     I,,AUTO
         6 003363   000014 402007                    MPY     12,DL
         6 003364   210124 235100                    LDA     TH_UTS+3,,AUTO
         6 003365   000106 100505                    MLR     fill='000'O
         6 003366   204644 000014                    ADSC9   TH_MAINT,A,AUTO          cn=0,n=12
         6 003367   205777 000014                    ADSC9   TEMP_MAINT,Q,AUTO        cn=0,n=12

     1196     5387    4                       TEMP_THRESH(I) = TH_THRESH(J);

   5387  6 003370   200017 235100                    LDA     J,,AUTO
         6 003371   000004 735000                    ALS     4
         6 003372   200016 236100                    LDQ     I,,AUTO
         6 003373   000004 736000                    QLS     4
         6 003374   000106 100505                    MLR     fill='000'O
         6 003375   201534 000020                    ADSC9   TH_THRESH,A,AUTO         cn=0,n=16
         6 003376   203200 000020                    ADSC9   TEMP_THRESH,Q,AUTO       cn=0,n=16

     1197     5388    4                       J = J + 1;

   5388  6 003377   200017 054100                    AOS     J,,AUTO

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:206  
     1198     5389    4                    END;

   5389  6 003400   003430 710000 6                  TRA     s:5398

     1199     5390    3                    ELSE                   /* NEW COMPONENT                      */
     1200     5391    4                    DO;

     1201     5392    4                       TEMP_MAINT.DEVNAME(I) = TH_HEAD.DEVNAME(I);

   5392  6 003401   200016 236100                    LDQ     I,,AUTO
         6 003402   000003 402007                    MPY     3,DL
         6 003403   000000 620006                    EAX0    0,QL
         6 003404   000000 621006                    EAX1    0,QL
         6 003405   200016 235100                    LDA     I,,AUTO
         6 003406   000001 735000                    ALS     1
         6 003407   200712 237105                    LDAQ    TH_HEAD+16,AL,AUTO
         6 003410   205777 755110                    STA     TEMP_MAINT,X0,AUTO
         6 003411   206000 756111                    STQ     TEMP_MAINT+1,X1,AUTO

     1202     5393    4                       TEMP_MAINT.UTS(I) = 0;

   5393  6 003412   206001 450110                    STZ     TEMP_MAINT+2,X0,AUTO

     1203     5394    4                       TEMP_THRESH.DEVNAME(I) = TH_HEAD.DEVNAME(I);

   5394  6 003413   200016 235100                    LDA     I,,AUTO
         6 003414   000002 735000                    ALS     2
         6 003415   200016 236100                    LDQ     I,,AUTO
         6 003416   000001 736000                    QLS     1
         6 003417   000000 622005                    EAX2    0,AL
         6 003420   200712 237106                    LDAQ    TH_HEAD+16,QL,AUTO
         6 003421   203200 757112                    STAQ    TEMP_THRESH,X2,AUTO

     1204     5395    4                       TEMP_THRESH.ATTEN(I) = 9900;

   5395  6 003422   200016 235100                    LDA     I,,AUTO
         6 003423   000002 735000                    ALS     2
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:207  
         6 003424   023254 236007                    LDQ     9900,DL
         6 003425   203202 756105                    STQ     TEMP_THRESH+2,AL,AUTO

     1205     5396    4                       TEMP_THRESH.ALERT(I) = 9500;

   5396  6 003426   022434 236007                    LDQ     9500,DL
         6 003427   203203 756105                    STQ     TEMP_THRESH+3,AL,AUTO

     1206     5397    4                    END;                   /* IF                                 */

     1207     5398    3              END;                         /* DO I = 0 TO LAST_INDX              */

   5398  6 003430   200016 054100                    AOS     I,,AUTO
         6 003431   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 003432   003345 604000 6                  TMI     s:5383
         6 003433   200016 116100                    CMPQ    I,,AUTO
         6 003434   003345 605000 6                  TPL     s:5383

     1208     5399    2              IF DCBADDR(DCBNUM(M$DEVHIST))->F$DCB.FCD

   5399  6 003435   000000 236007 xsym               LDQ     M$DEVHIST,DL
         6 003436   000000 470400 7                  LDP0    0
         6 003437   000000 471500                    LDP1    0,,PR0
         6 003440   100000 473506                    LDP3    0,QL,PR1
         6 003441   300031 236100                    LDQ     25,,PR3
         6 003442   020000 316007                    CANQ    8192,DL
         6 003443   003447 600000 6                  TZE     s:5401

     1209     5400    2                 THEN CALL M$CLOSE(CLOSE_DEVHIST);

   5400  6 003444   000110 630400 5                  EPPR0   CLOSE_DEVHIST
         6 003445   050001 713400                    CLIMB   close
         6 003446   406000 401760                    pmme    nvectors=13

     1210     5401    2              CALL M$OPEN(OPEN_DEVHIST);

   5401  6 003447   000016 630400 5                  EPPR0   OPEN_DEVHIST
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:208  
         6 003450   050000 713400                    CLIMB   open
         6 003451   410400 401760                    pmme    nvectors=18

     1211     5402    2              WRITE_DEVHIST.BUF_ = VECTOR(TEMP_MAINT);

   5402  6 003452   000015 235000 7                  LDA     13
         6 003453   210124 452500                    STP2    TH_UTS+3,,AUTO
         6 003454   210124 236100                    LDQ     TH_UTS+3,,AUTO
         6 003455   005777 036003                    ADLQ    3071,DU
         6 003456   002042 757000 4                  STAQ    WRITE_DEVHIST+4

     1212     5403    2              WRITE_DEVHIST.KEY_ = VECTOR(MAINT_KEY);

   5403  6 003457   000016 237000 7                  LDAQ    14
         6 003460   002040 757000 4                  STAQ    WRITE_DEVHIST+2

     1213     5404    2              WRITE_DEVHIST.BUF_.BOUND = SIZEV(TH_MAINT) - ((200 - LAST_INDX) * 12);

   5404  6 003461   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 003462   000014 402007                    MPY     12,DL
         6 003463   000013 036007                    ADLQ    11,DL
         6 003464   000020 736000                    QLS     16
         6 003465   002042 676000 4                  ERQ     WRITE_DEVHIST+4
         6 003466   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 003467   002042 656000 4                  ERSQ    WRITE_DEVHIST+4

     1214     5405    2              CALL M$WRITE(WRITE_DEVHIST);

   5405  6 003470   002036 630400 4                  EPPR0   WRITE_DEVHIST
         6 003471   040001 713400                    CLIMB   write
         6 003472   401400 401760                    pmme    nvectors=4

     1215     5406
     1216     5407    2              WRITE_DEVHIST.KEY_ = VECTOR(THRESH_KEY);

   5407  6 003473   000020 237000 7                  LDAQ    16
         6 003474   002040 757000 4                  STAQ    WRITE_DEVHIST+2
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:209  

     1217     5408    2              WRITE_DEVHIST.BUF_ = VECTOR(TEMP_THRESH);

   5408  6 003475   000022 235000 7                  LDA     18
         6 003476   210124 452500                    STP2    TH_UTS+3,,AUTO
         6 003477   210124 236100                    LDQ     TH_UTS+3,,AUTO
         6 003500   003200 036003                    ADLQ    1664,DU
         6 003501   002042 757000 4                  STAQ    WRITE_DEVHIST+4

     1218     5409    2              WRITE_DEVHIST.BUF_.BOUND = SIZEV(TH_THRESH) - ((200 - LAST_INDX) * 12);

   5409  6 003502   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 003503   000014 402007                    MPY     12,DL
         6 003504   001457 036007                    ADLQ    815,DL
         6 003505   000020 736000                    QLS     16
         6 003506   002042 676000 4                  ERQ     WRITE_DEVHIST+4
         6 003507   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 003510   002042 656000 4                  ERSQ    WRITE_DEVHIST+4

     1219     5410    2              CALL M$WRITE(WRITE_DEVHIST);

   5410  6 003511   002036 630400 4                  EPPR0   WRITE_DEVHIST
         6 003512   040001 713400                    CLIMB   write
         6 003513   401400 401760                    pmme    nvectors=4

     1220     5411    2        END;                               /* IF NUM_NEW_COMPS > 0               */

     1221     5412
     1222     5413    1   BYPASS_CHECK:
     1223     5414                            /* READ ERRLOG RECORDS AND STUFF ERROR INFO INTO RECORDS  */
     1224     5415    1        TH_CONSTRAINTS = TH_DEFAULT;

   5415  6 003514   000000 100400       BYPASS_CHECK MLR     fill='000'O
         6 003515   000000 000333 xsym               ADSC9   TH_DEFAULT               cn=0,n=219
         6 003516   000000 000333 xsym               ADSC9   TH_CONSTRAINTS           cn=0,n=219

     1225     5416
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:210  
     1226     5417                                                /* SET TIME CONSTRAINTS               */
     1227     5418    1        CALL THG$GETREC(%DEVHIST,THREE);   /* UTS RECORD                         */

   5418  6 003517   000003 630400 7                  EPPR0   3
         6 003520   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 003521   000000 701000 xent               TSX1    THG$GETREC
         6 003522   000000 011000                    NOP     0

     1228     5419    1        TH_UTS = TH_RECORD.PTR$ -> TH$UTS;

   5419  6 003523   000001 470400 xsym               LDP0    TH_RECORD+1
         6 003524   000100 100500                    MLR     fill='000'O
         6 003525   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         6 003526   210121 000010                    ADSC9   TH_UTS,,AUTO             cn=0,n=8

     1229     5420    1        DEVHIST_UTS = TH_UTS.ERRLOG_UTS;   /* UTS WHEN ERRLOG WAS LAST */

   5420  6 003527   210122 235100                    LDA     TH_UTS+1,,AUTO
         6 003530   000012 755000 4                  STA     DEVHIST_UTS

     1230     5421                                              /* PROCESSED AGAINST :DEVHIST */
     1231     5422    1        CALL M$TIME(CUR_UTS);

   5422  6 003531   000432 630400 5                  EPPR0   CUR_UTS
         6 003532   020004 713400                    CLIMB   8196
         6 003533   402000 401760                    pmme    nvectors=5

     1232     5423    1        CALL XUD$UTS_DIFF_SEC (LAST_UTS, CURUTS, 0);

   5423  6 003534   000023 630400 7                  EPPR0   19
         6 003535   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 003536   000000 701000 xent               TSX1    XUD$UTS_DIFF_SEC
         6 003537   000000 011000                    NOP     0

     1233     5424    1        LAST_UTS = LAST_UTS / 86400;

   5424  6 003540   000011 236000 4                  LDQ     LAST_UTS
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:211  
         6 003541   000001 772000                    QRL     1
         6 003542   124300 506007                    DIV     43200,DL
         6 003543   000011 756000 4                  STQ     LAST_UTS

     1234     5425    1        CALL XUD$UTS_ADJ_25TH (LAST_UTS, 0, LAST_UTS*%UTS_25TH_DAY#);

   5425  6 003544   000026 402000 7                  MPY     22
         6 003545   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 003546   210124 630500                    EPPR0   TH_UTS+3,,AUTO
         6 003547   210127 450500                    STP0    TH_UTS+6,,AUTO
         6 003550   000025 236000 7                  LDQ     21
         6 003551   210126 756100                    STQ     TH_UTS+5,,AUTO
         6 003552   000023 236000 7                  LDQ     19
         6 003553   210125 756100                    STQ     TH_UTS+4,,AUTO
         6 003554   210125 630500                    EPPR0   TH_UTS+4,,AUTO
         6 003555   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 003556   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         6 003557   000000 011000                    NOP     0

     1235     5426    2        IF DEVHIST_UTS = 0 THEN DO;

   5426  6 003560   000012 235000 4                  LDA     DEVHIST_UTS
         6 003561   003611 601000 6                  TNZ     s:5433

     1236     5427    2        CALL XUD$UTS_DIFF_SEC (FIRST_UTS, CURUTS, 0);

   5427  6 003562   000027 630400 7                  EPPR0   23
         6 003563   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 003564   000000 701000 xent               TSX1    XUD$UTS_DIFF_SEC
         6 003565   000000 011000                    NOP     0

     1237     5428    2        FIRST_UTS = FIRST_UTS / 86400;

   5428  6 003566   000010 236000 4                  LDQ     FIRST_UTS
         6 003567   000001 772000                    QRL     1
         6 003570   124300 506007                    DIV     43200,DL
         6 003571   000010 756000 4                  STQ     FIRST_UTS
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:212  

     1238     5429    2        CALL XUD$UTS_ADJ_25TH (FIRST_UTS, 0, FIRST_UTS*%UTS_25TH_DAY#);

   5429  6 003572   000026 402000 7                  MPY     22
         6 003573   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 003574   210124 630500                    EPPR0   TH_UTS+3,,AUTO
         6 003575   210127 450500                    STP0    TH_UTS+6,,AUTO
         6 003576   000025 236000 7                  LDQ     21
         6 003577   210126 756100                    STQ     TH_UTS+5,,AUTO
         6 003600   000027 236000 7                  LDQ     23
         6 003601   210125 756100                    STQ     TH_UTS+4,,AUTO
         6 003602   210125 630500                    EPPR0   TH_UTS+4,,AUTO
         6 003603   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 003604   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         6 003605   000000 011000                    NOP     0

     1239     5430    2           DEVHIST_UTS = FIRST_UTS;

   5430  6 003606   000010 235000 4                  LDA     FIRST_UTS
         6 003607   000012 755000 4                  STA     DEVHIST_UTS

     1240     5431    2           END;  /* IF DEVHIST_UTS = 0 */

   5431  6 003610   003647 710000 6                  TRA     s:5443

     1241     5432    2        ELSE DO;

     1242     5433    2        CALL XUD$UTS_DIFF_SEC (FIRST_UTS, DEVHIST_UTS, 0);

   5433  6 003611   000032 630400 7                  EPPR0   26
         6 003612   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 003613   000000 701000 xent               TSX1    XUD$UTS_DIFF_SEC
         6 003614   000000 011000                    NOP     0

     1243     5434    2        FIRST_UTS = FIRST_UTS / 86400;

   5434  6 003615   000010 236000 4                  LDQ     FIRST_UTS
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:213  
         6 003616   000001 772000                    QRL     1
         6 003617   124300 506007                    DIV     43200,DL
         6 003620   000010 756000 4                  STQ     FIRST_UTS

     1244     5435    2        CALL XUD$UTS_ADJ_25TH (FIRST_UTS, 0, FIRST_UTS*%UTS_25TH_DAY#);

   5435  6 003621   000026 402000 7                  MPY     22
         6 003622   210124 756100                    STQ     TH_UTS+3,,AUTO
         6 003623   210124 630500                    EPPR0   TH_UTS+3,,AUTO
         6 003624   210127 450500                    STP0    TH_UTS+6,,AUTO
         6 003625   000025 236000 7                  LDQ     21
         6 003626   210126 756100                    STQ     TH_UTS+5,,AUTO
         6 003627   000027 236000 7                  LDQ     23
         6 003630   210125 756100                    STQ     TH_UTS+4,,AUTO
         6 003631   210125 630500                    EPPR0   TH_UTS+4,,AUTO
         6 003632   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 003633   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         6 003634   000000 011000                    NOP     0

     1245     5436    2           CALL XUD$UTS_ADJ_25TH(OLDEST_UTS, LAST_UTS, -(30*%UTS_25TH_DAY#));

   5436  6 003635   000036 630400 7                  EPPR0   30
         6 003636   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 003637   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         6 003640   000000 011000                    NOP     0

     1246     5437    2           IF OLDEST_UTS > FIRST_UTS

   5437  6 003641   000010 236000 4                  LDQ     FIRST_UTS
         6 003642   000013 116000 4                  CMPQ    OLDEST_UTS
         6 003643   003647 603000 6                  TRC     s:5443

     1247     5438    3              THEN DO;       /* ONLY MERGE 30 DAYS WORTH OF ERROR LOG */

     1248     5439    3                FIRST_UTS = OLDEST_UTS;         /* INFO INTO :DEVHIST*/

   5439  6 003644   000013 235000 4                  LDA     OLDEST_UTS
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:214  
         6 003645   000010 755000 4                  STA     FIRST_UTS

     1249     5440    3                DEVHIST_UTS = OLDEST_UTS;

   5440  6 003646   000012 755000 4                  STA     DEVHIST_UTS

     1250     5441    3              END;

     1251     5442    2           END;  /* ELSE */

     1252     5443    1        IF DCBADDR(DCBNUM(M$DEVHIST))->F$DCB.FCD

   5443  6 003647   000000 236007 xsym               LDQ     M$DEVHIST,DL
         6 003650   000000 470400 7                  LDP0    0
         6 003651   000000 471500                    LDP1    0,,PR0
         6 003652   100000 473506                    LDP3    0,QL,PR1
         6 003653   300031 236100                    LDQ     25,,PR3
         6 003654   020000 316007                    CANQ    8192,DL
         6 003655   003661 600000 6                  TZE     s:5445

     1253     5444    1           THEN CALL M$CLOSE(CLOSE_DEVHIST);

   5444  6 003656   000110 630400 5                  EPPR0   CLOSE_DEVHIST
         6 003657   050001 713400                    CLIMB   close
         6 003660   406000 401760                    pmme    nvectors=13

     1254     5445    1        CALL M$OPEN(OPEN_DEVHIST) ALTRET(ALT);

   5445  6 003661   000016 630400 5                  EPPR0   OPEN_DEVHIST
         6 003662   450000 713400                    CLIMB   alt,open
         6 003663   410400 401760                    pmme    nvectors=18
         6 003664   004671 702000 6                  TSX2    ALT

     1255     5446
     1256     5447    1        UTS = FIRST_UTS;

   5447  6 003665   000010 235000 4                  LDA     FIRST_UTS
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:215  
         6 003666   000006 755000 4                  STA     UTS

     1257     5448    2        DO WHILE (UTS <= LAST_UTS);

   5448  6 003667   000011 236000 4                  LDQ     LAST_UTS
         6 003670   000006 116000 4                  CMPQ    UTS
         6 003671   004464 602000 6                  TNC     s:5578

     1258     5449    2           IF UTS = FIRST_UTS

   5449  6 003672   000006 236000 4                  LDQ     UTS
         6 003673   000010 116000 4                  CMPQ    FIRST_UTS
         6 003674   003700 601000 6                  TNZ     s:5451

     1259     5450    2              THEN TH_CONSTRAINTS.START = DEVHIST_UTS;

   5450  6 003675   000012 235000 4                  LDA     DEVHIST_UTS
         6 003676   000012 755000 xsym               STA     TH_CONSTRAINTS+10
         6 003677   003701 710000 6                  TRA     s:5452

     1260     5451    2              ELSE TH_CONSTRAINTS.START = UTS;

   5451  6 003700   000012 756000 xsym               STQ     TH_CONSTRAINTS+10

     1261     5452    2           IF UTS = LAST_UTS

   5452  6 003701   000011 116000 4                  CMPQ    LAST_UTS
         6 003702   003706 601000 6                  TNZ     s:5454

     1262     5453    2              THEN TH_CONSTRAINTS.STOP = CURUTS;

   5453  6 003703   000007 235000 4                  LDA     CURUTS
         6 003704   000013 755000 xsym               STA     TH_CONSTRAINTS+11
         6 003705   003712 710000 6                  TRA     s:5457

     1263     5454    2             ELSE CALL XUD$UTS_ADJ_25TH (TH_CONSTRAINTS.STOP, UTS, %UTS_25TH_DAY# -1);

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:216  
   5454  6 003706   000042 630400 7                  EPPR0   34
         6 003707   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 003710   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         6 003711   000000 011000                    NOP     0

     1264     5455
     1265     5456                                 /* INITIALIZE MPC, FEP, IOM, DEV, AND CHAN TABLES    */
     1266     5457    2           CALL THE$INIT(TD_HEAD) ALTRET(NO_MEM);

   5457  6 003712   200030 630500                    EPPR0   TD_HEAD,,AUTO
         6 003713   210124 450500                    STP0    TH_UTS+3,,AUTO
         6 003714   210124 630500                    EPPR0   TH_UTS+3,,AUTO
         6 003715   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 003716   000000 701000 xent               TSX1    THE$INIT
         6 003717   004657 702000 6                  TSX2    NO_MEM

     1267     5458    2           CALL THG$OPENXSA(TH_CONSTRAINTS.START) ALTRET(KEEP_GOING);

   5458  6 003720   000045 630400 7                  EPPR0   37
         6 003721   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 003722   000000 701000 xent               TSX1    THG$OPENXSA
         6 003723   004200 702000 6                  TSX2    KEEP_GOING

     1268     5459    2           EOF_FLG = %FALSE;

   5459  6 003724   200003 450100                    STZ     EOF_FLG,,AUTO

     1269     5460    3           DO WHILE(NOT EOF_FLG);

   5460  6 003725   004176 710000 6                  TRA     s:5522

     1270     5461    3     LOOP:
     1271     5462    3              CALL THG$GETREC(%ERRLOG) ALTRET(EOF_LBL);

   5462  6 003726   000046 630400 7     LOOP         EPPR0   38
         6 003727   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 003730   000000 701000 xent               TSX1    THG$GETREC
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:217  
         6 003731   004174 702000 6                  TSX2    EOF_LBL

     1272     5463    4              DO CASE(TH_ITYPE);

   5463  6 003732   000000 235000 xsym               LDA     TH_ITYPE
         6 003733   000022 135007                    SBLA    18,DL
         6 003734   000001 115007                    CMPA    1,DL
         6 003735   003737 602005 6                  TNC     s:5463+5,AL
         6 003736   004173 710000 6                  TRA     s:5519
         6 003737   003740 710000 6                  TRA     s:5465

     1273     5464    4                 CASE(%TH_IOERR);

     1274     5465    4                    IF LAST_REQID = EL$IOERR.REQID THEN GOTO LOOP;

   5465  6 003740   000001 470400 xsym               LDP0    TH_INFO+1
         6 003741   000000 236000 4                  LDQ     LAST_REQID
         6 003742   000000 116100                    CMPQ    0,,PR0
         6 003743   003726 600000 6                  TZE     LOOP

     1275     5466    4                    IOM# = EL$IOERR.IOCHAN.IOM;

   5466  6 003744   000005 236100                    LDQ     5,,PR0
         6 003745   000033 772000                    QRL     27
         6 003746   000007 376007                    ANQ     7,DL
         6 003747   000041 736000                    QLS     33
         6 003750   200014 756100                    STQ     IOM#,,AUTO

     1276     5467    4                    IF IOM# + 1 > NUM_IOMS THEN GOTO LOOP;

   5467  6 003751   200014 236100                    LDQ     IOM#,,AUTO
         6 003752   000041 772000                    QRL     33
         6 003753   000001 116000 4                  CMPQ    NUM_IOMS
         6 003754   003726 603000 6                  TRC     LOOP

     1277     5468    4                    CHAN# = EL$IOERR.IOCHAN.CHAN;

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:218  
   5468  6 003755   000005 236100                    LDQ     5,,PR0
         6 003756   000022 772000                    QRL     18
         6 003757   000777 376007                    ANQ     511,DL
         6 003760   000033 736000                    QLS     27
         6 003761   200015 756100                    STQ     CHAN#,,AUTO

     1278     5469    4                    IF EL$IOERR.THRESH.IOM

   5469  6 003762   000027 236100                    LDQ     23,,PR0
         6 003763   400000 316007                    CANQ    -131072,DL
         6 003764   004003 600000 6                  TZE     s:5476

     1279     5470    4                       THEN
     1280     5471    5                       DO;

     1281     5472    5                          IOM$ = IOM_TBL.PTR$(IOM#);

   5472  6 003765   200014 236100                    LDQ     IOM#,,AUTO
         6 003766   000041 772000                    QRL     33
         6 003767   000003 402007                    MPY     3,DL
         6 003770   000000 471400 xsym               LDP1    IOM_TBL$
         6 003771   100002 236106                    LDQ     2,QL,PR1
         6 003772   200007 756100                    STQ     IOM$,,AUTO

     1282     5473    5                          IOM.COUNT = IOM.COUNT + 1;

   5473  6 003773   200007 473500                    LDP3    IOM$,,AUTO
         6 003774   300413 235100                    LDA     267,,PR3
         6 003775   000001 035007                    ADLA    1,DL
         6 003776   300413 755100                    STA     267,,PR3

     1283     5474    5                          IOM.CONNECTS = IOM.CONNECTS + EL$IOERR.CONNECTS.IOM;

   5474  6 003777   000006 236100                    LDQ     6,,PR0
         6 004000   000022 772000                    QRL     18
         6 004001   300412 036100                    ADLQ    266,,PR3
         6 004002   300412 756100                    STQ     266,,PR3
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:219  

     1284     5475    5                       END;

     1285     5476    4                    IF EL$IOERR.THRESH.MPC

   5476  6 004003   000027 236100                    LDQ     23,,PR0
         6 004004   100000 316007                    CANQ    32768,DL
         6 004005   004075 600000 6                  TZE     s:5496

     1286     5477    4                       THEN
     1287     5478    5                       DO;

     1288     5479    5                          MPC_NAME = IOM_TBL.PTR$(IOM#)->IOM.DEVNAME(CHAN#);

   5479  6 004006   200014 236100                    LDQ     IOM#,,AUTO
         6 004007   000041 772000                    QRL     33
         6 004010   000003 402007                    MPY     3,DL
         6 004011   000000 471400 xsym               LDP1    IOM_TBL$
         6 004012   100002 473506                    LDP3    2,QL,PR1
         6 004013   200015 236100                    LDQ     CHAN#,,AUTO
         6 004014   000032 772000                    QRL     26
         6 004015   001776 376007                    ANQ     1022,DL
         6 004016   000002 736000                    QLS     2
         6 004017   040100 100506                    MLR     fill='040'O
         6 004020   300000 000010                    ADSC9   0,Q,PR3                  cn=0,n=8
         6 004021   200024 000010                    ADSC9   MPC_NAME,,AUTO           cn=0,n=8

     1289     5480    6                          DO I = 0 TO NUM_MPCS - 1;

   5480  6 004022   200016 450100                    STZ     I,,AUTO
         6 004023   004071 710000 6                  TRA     s:5494+1

     1290     5481    6                             IF MPC_TBL.DEVNAME(I) = MPC_NAME

   5481  6 004024   200016 236100                    LDQ     I,,AUTO
         6 004025   000014 402007                    MPY     12,DL
         6 004026   000000 470400 xsym               LDP0    MPC_TBL$
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:220  
         6 004027   040100 106506                    CMPC    fill='040'O
         6 004030   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=8
         6 004031   200024 000010                    ADSC9   MPC_NAME,,AUTO           cn=0,n=8
         6 004032   004070 601000 6                  TNZ     s:5494

     1291     5482    6                                THEN
     1292     5483    7                                DO;

     1293     5484    7                                   MPC$ = MPC_TBL.PTR$(I);

   5484  6 004033   200016 236100                    LDQ     I,,AUTO
         6 004034   000003 402007                    MPY     3,DL
         6 004035   000002 236106                    LDQ     2,QL,PR0
         6 004036   200010 756100                    STQ     MPC$,,AUTO

     1294     5485    8                                   DO DCTX = 1 TO TH_MAXDCTX;

   5485  6 004037   000001 235007                    LDA     1,DL
         6 004040   200022 755100                    STA     DCTX,,AUTO
         6 004041   004065 710000 6                  TRA     s:5492+3

     1295     5486    8                                      DCT$ = TH_DCT$(DCTX);

   5486  6 004042   200022 720100                    LXL0    DCTX,,AUTO
         6 004043   000000 236010 xsym               LDQ     TH_DCT$,X0
         6 004044   200023 756100                    STQ     DCT$,,AUTO

     1296     5487    8                                      DCTPTR.SEGID = %SPCL1SID;

   5487  6 004045   006021 236007                    LDQ     3089,DL
         6 004046   200023 752103                    STCQ    DCT$,'03'O,AUTO

     1297     5488    9                                      IF NI$DCT.DEVNM = MPC_NAME THEN DO;

   5488  6 004047   200023 470500                    LDP0    DCT$,,AUTO
         6 004050   040100 106500                    CMPC    fill='040'O
         6 004051   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:221  
         6 004052   200024 000010                    ADSC9   MPC_NAME,,AUTO           cn=0,n=8
         6 004053   004062 601000 6                  TNZ     s:5492

     1298     5489    9                                         MPC.COUNT = MPC.COUNT + 1;

   5489  6 004054   200010 471500                    LDP1    MPC$,,AUTO
         6 004055   100000 235100                    LDA     0,,PR1
         6 004056   000001 035007                    ADLA    1,DL
         6 004057   100000 755100                    STA     0,,PR1

     1299     5490    9                                         MPC.CONNECTS = NI$DCT.PM.CONNCT;

   5490  6 004060   000011 235100                    LDA     9,,PR0
         6 004061   100001 755100                    STA     1,,PR1

     1300     5491    9                                         END;  /* IF */

     1301     5492    8                                      END;  /* DO DCTX */

   5492  6 004062   200022 235100                    LDA     DCTX,,AUTO
         6 004063   000001 035007                    ADLA    1,DL
         6 004064   200022 755100                    STA     DCTX,,AUTO
         6 004065   000000 236000 xsym               LDQ     TH_MAXDCTX
         6 004066   200022 116100                    CMPQ    DCTX,,AUTO
         6 004067   004042 603000 6                  TRC     s:5486

     1302     5493    7                                END;       /* IF                                 */

     1303     5494    6                          END;             /* DO I                               */

   5494  6 004070   200016 054100                    AOS     I,,AUTO
         6 004071   200016 236100                    LDQ     I,,AUTO
         6 004072   004024 604000 6                  TMI     s:5481
         6 004073   000002 116000 4                  CMPQ    NUM_MPCS
         6 004074   004024 602000 6                  TNC     s:5481

     1304     5495    5                       END;                /* IF THRESH.MPC                      */
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:222  

     1305     5496    4                    IF EL$IOERR.THRESH.CHANNEL

   5496  6 004075   000001 470400 xsym               LDP0    TH_INFO+1
         6 004076   000027 236100                    LDQ     23,,PR0
         6 004077   200000 316007                    CANQ    65536,DL
         6 004100   004130 600000 6                  TZE     s:5504

     1306     5497    4                       THEN
     1307     5498    5                       DO;

     1308     5499    5                          CHAN$ = IOM_TBL.PTR$(IOM#)->IOM.CHAN$;

   5499  6 004101   200014 236100                    LDQ     IOM#,,AUTO
         6 004102   000041 772000                    QRL     33
         6 004103   000003 402007                    MPY     3,DL
         6 004104   000000 471400 xsym               LDP1    IOM_TBL$
         6 004105   100002 473506                    LDP3    2,QL,PR1
         6 004106   300411 236100                    LDQ     265,,PR3
         6 004107   200013 756100                    STQ     CHAN$,,AUTO

     1309     5500    5                          CHAN.CHANS.COUNT(CHAN#) = CHAN.CHANS.COUNT(CHAN#) + 1;

   5500  6 004110   200015 236100                    LDQ     CHAN#,,AUTO
         6 004111   000033 772000                    QRL     27
         6 004112   200013 473500                    LDP3    CHAN$,,AUTO
         6 004113   300001 220106                    LDX0    1,QL,PR3
         6 004114   000001 621010                    EAX1    1,X0
         6 004115   300001 741106                    STX1    1,QL,PR3

     1310     5501    5                          CHAN.CHANS.CONNECTS(CHAN#) = CHAN.CHANS.CONNECTS(CHAN#) +

   5501  6 004116   000001 470400 xsym               LDP0    TH_INFO+1
         6 004117   000000 620006                    EAX0    0,QL
         6 004120   000006 236100                    LDQ     6,,PR0
         6 004121   777777 376007                    ANQ     -1,DL
         6 004122   210124 756100                    STQ     TH_UTS+3,,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:223  
         6 004123   300001 236110                    LDQ     1,X0,PR3
         6 004124   777777 376007                    ANQ     -1,DL
         6 004125   210124 036100                    ADLQ    TH_UTS+3,,AUTO
         6 004126   000000 621006                    EAX1    0,QL
         6 004127   300001 441110                    SXL1    1,X0,PR3

     1311     5502    5                                EL$IOERR.CONNECTS.CHANNEL;
     1312     5503    5                       END;                /* IF THRESH.CHANNEL                  */

     1313     5504    4                    IF EL$IOERR.THRESH.DEVICE

   5504  6 004130   000001 470400 xsym               LDP0    TH_INFO+1
         6 004131   000027 236100                    LDQ     23,,PR0
         6 004132   040000 316007                    CANQ    16384,DL
         6 004133   004167 600000 6                  TZE     s:5515

     1314     5505    4                       THEN
     1315     5506    5                       DO I = 0 TO NUM_DEVS - 1;

   5506  6 004134   200016 450100                    STZ     I,,AUTO
         6 004135   004163 710000 6                  TRA     s:5514+1

     1316     5507    5                          IF DEV_TBL.DEVNAME(I) = EL$IOERR.DEVNM

   5507  6 004136   200016 236100                    LDQ     I,,AUTO
         6 004137   000014 402007                    MPY     12,DL
         6 004140   000000 470400 xsym               LDP0    DEV_TBL$
         6 004141   000001 471400 xsym               LDP1    TH_INFO+1
         6 004142   040100 106506                    CMPC    fill='040'O
         6 004143   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=8
         6 004144   100024 000010                    ADSC9   20,,PR1                  cn=0,n=8
         6 004145   004162 601000 6                  TNZ     s:5514

     1317     5508    5                             THEN
     1318     5509    6                             DO;

     1319     5510    6                                DEV$ = DEV_TBL.PTR$(I);
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:224  

   5510  6 004146   200016 236100                    LDQ     I,,AUTO
         6 004147   000003 402007                    MPY     3,DL
         6 004150   000002 236106                    LDQ     2,QL,PR0
         6 004151   200011 756100                    STQ     DEV$,,AUTO

     1320     5511    6                                DEV.COUNT(%TH_IOERR) = DEV.COUNT(%TH_IOERR) + 1;

   5511  6 004152   200011 473500                    LDP3    DEV$,,AUTO
         6 004153   300022 220100                    LDX0    18,,PR3
         6 004154   000001 621010                    EAX1    1,X0
         6 004155   300022 741100                    STX1    18,,PR3

     1321     5512    6                               DEV.CONNECTS = DEV.CONNECTS + EL$IOERR.CONNECTS.DEVICE;

   5512  6 004156   100007 236100                    LDQ     7,,PR1
         6 004157   777777 376007                    ANQ     -1,DL
         6 004160   300026 036100                    ADLQ    22,,PR3
         6 004161   300026 756100                    STQ     22,,PR3

     1322     5513    6                             END;          /* IF                                 */

     1323     5514    5                       END;                /* DO I                               */

   5514  6 004162   200016 054100                    AOS     I,,AUTO
         6 004163   200016 236100                    LDQ     I,,AUTO
         6 004164   004136 604000 6                  TMI     s:5507
         6 004165   000003 116000 4                  CMPQ    NUM_DEVS
         6 004166   004136 602000 6                  TNC     s:5507

     1324     5515    4                   LAST_REQID = EL$IOERR.REQID;

   5515  6 004167   000001 470400 xsym               LDP0    TH_INFO+1
         6 004170   000000 235100                    LDA     0,,PR0
         6 004171   000000 755000 4                  STA     LAST_REQID
         6 004172   004173 710000 6                  TRA     s:5519

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:225  
     1325     5516    4                 CASE(ELSE);

     1326     5517                                                /* UNIMPLIMENTED AS YET               */
     1327     5518    4              END;                         /* DO CASE TH_ITYPE                   */

     1328     5519    4              DO NEVER;

   5519  6 004173   004176 710000 6                  TRA     s:5522

     1329     5520    4      EOF_LBL:   EOF_FLG = %TRUE;

   5520  6 004174   400000 236003       EOF_LBL      LDQ     -131072,DU
         6 004175   200003 756100                    STQ     EOF_FLG,,AUTO

     1330     5521    4              END;                         /* DO NEVER                           */

     1331     5522    3           END;                            /* DO WHILE NOT EOF_FLG               */

   5522  6 004176   200003 234100                    SZN     EOF_FLG,,AUTO
         6 004177   003726 605000 6                  TPL     LOOP

     1332     5523    2   KEEP_GOING:
     1333     5524
     1334     5525                                           /* BUILD KEYS AND WRITE RECORDS TO DEVHIST */
     1335     5526    2           IF NOT DCBADDR(DCBNUM(M$DEVHIST))->F$DCB.FCD

   5526  6 004200   000000 236007 xsym  KEEP_GOING   LDQ     M$DEVHIST,DL
         6 004201   000000 470400 7                  LDP0    0
         6 004202   000000 471500                    LDP1    0,,PR0
         6 004203   100000 473506                    LDP3    0,QL,PR1
         6 004204   300031 236100                    LDQ     25,,PR3
         6 004205   020000 316007                    CANQ    8192,DL
         6 004206   004213 601000 6                  TNZ     s:5530

     1336     5527    2              THEN CALL M$OPEN(OPEN_DEVHIST) ALTRET(ALT);

   5527  6 004207   000016 630400 5                  EPPR0   OPEN_DEVHIST
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:226  
         6 004210   450000 713400                    CLIMB   alt,open
         6 004211   410400 401760                    pmme    nvectors=18
         6 004212   004671 702000 6                  TSX2    ALT

     1337     5528
     1338     5529                                                /* WRITE HEAD RECORD BACK             */
     1339     5530    2           WRITE_DEVHIST.KEY_ = VECTOR(HEAD_KEY);

   5530  6 004213   000050 237000 7                  LDAQ    40
         6 004214   002040 757000 4                  STAQ    WRITE_DEVHIST+2

     1340     5531    2           WRITE_DEVHIST.BUF_ = VECTOR(TH_HEAD);

   5531  6 004215   000052 235000 7                  LDA     42
         6 004216   210124 452500                    STP2    TH_UTS+3,,AUTO
         6 004217   210124 236100                    LDQ     TH_UTS+3,,AUTO
         6 004220   000672 036003                    ADLQ    442,DU
         6 004221   002042 757000 4                  STAQ    WRITE_DEVHIST+4

     1341     5532    2           WRITE_DEVHIST.BUF_.BOUND = SIZEV(TH_HEAD) - ((200 - LAST_INDX) * 8);

   5532  6 004222   200005 236100                    LDQ     LAST_INDX,,AUTO
         6 004223   000003 736000                    QLS     3
         6 004224   000107 036007                    ADLQ    71,DL
         6 004225   000020 736000                    QLS     16
         6 004226   002042 676000 4                  ERQ     WRITE_DEVHIST+4
         6 004227   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 004230   002042 656000 4                  ERSQ    WRITE_DEVHIST+4

     1342     5533    2           CALL M$WRITE(WRITE_DEVHIST);

   5533  6 004231   002036 630400 4                  EPPR0   WRITE_DEVHIST
         6 004232   040001 713400                    CLIMB   write
         6 004233   401400 401760                    pmme    nvectors=4

     1343     5534
     1344     5535    2           KEY8.UTS = UTS;
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:227  

   5535  6 004234   000000 100400                    MLR     fill='000'O
         6 004235   000006 000004 4                  ADSC9   UTS                      cn=0,n=4
         6 004236   000023 200004 4                  ADSC9   KEY8+2                   cn=1,n=4

     1345     5536    2           WRITE_DEVHIST.KEY_ = VECTOR(KEY8);

   5536  6 004237   000054 237000 7                  LDAQ    44
         6 004240   002040 757000 4                  STAQ    WRITE_DEVHIST+2

     1346     5537
     1347     5538                                                /* WRITE IOM AND CHANNEL RECORDS      */
     1348     5539    3           DO I = 0 TO NUM_IOMS - 1;

   5539  6 004241   200016 450100                    STZ     I,,AUTO
         6 004242   004321 710000 6                  TRA     s:5549+1

     1349     5540    3              TH_IOM = IOM_TBL.PTR$(I)->IOM;

   5540  6 004243   200016 236100                    LDQ     I,,AUTO
         6 004244   000003 402007                    MPY     3,DL
         6 004245   000000 470400 xsym               LDP0    IOM_TBL$
         6 004246   000002 471506                    LDP1    2,QL,PR0
         6 004247   000100 100500                    MLR     fill='000'O
         6 004250   100000 002060                    ADSC9   0,,PR1                   cn=0,n=1072
         6 004251   207254 002060                    ADSC9   TH_IOM,,AUTO             cn=0,n=1072

     1350     5541    3              KEY8.TXT = IOM_TBL.DEVNAME(I);

   5541  6 004252   200016 236100                    LDQ     I,,AUTO
         6 004253   000014 402007                    MPY     12,DL
         6 004254   040000 100506                    MLR     fill='040'O
         6 004255   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=8
         6 004256   000021 200010 4                  ADSC9   KEY8                     cn=1,n=8

     1351     5542    3              WRITE_DEVHIST.BUF_ = VECTOR(TH_IOM);

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:228  
   5542  6 004257   000053 235000 7                  LDA     43
         6 004260   210124 452500                    STP2    TH_UTS+3,,AUTO
         6 004261   210124 236100                    LDQ     TH_UTS+3,,AUTO
         6 004262   007254 036003                    ADLQ    3756,DU
         6 004263   002042 757000 4                  STAQ    WRITE_DEVHIST+4

     1352     5543    3              CALL M$WRITE(WRITE_DEVHIST);

   5543  6 004264   002036 630400 4                  EPPR0   WRITE_DEVHIST
         6 004265   040001 713400                    CLIMB   write
         6 004266   401400 401760                    pmme    nvectors=4

     1353     5544    3              TH_CHAN = IOM_TBL.PTR$(I)->IOM.CHAN$->CHAN;

   5544  6 004267   200016 236100                    LDQ     I,,AUTO
         6 004270   000003 402007                    MPY     3,DL
         6 004271   000000 470400 xsym               LDP0    IOM_TBL$
         6 004272   000002 471506                    LDP1    2,QL,PR0
         6 004273   100411 473500                    LDP3    265,,PR1
         6 004274   000100 100500                    MLR     fill='000'O
         6 004275   300000 001004                    ADSC9   0,,PR3                   cn=0,n=516
         6 004276   207720 001004                    ADSC9   TH_CHAN,,AUTO            cn=0,n=516

     1354     5545    3              CALL BINCHAR(CHN#,I);

   5545  6 004277   000100 301500                    BTD
         6 004300   200016 000004                    NDSC9   I,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
         6 004301   200026 030002                    NDSC9   CHN#,,AUTO               cn=0,s=nosgn,sf=0,n=2

     1355     5546    3              CALL INSERT(KEY8.TXT,0,4,'CH',CHN#);

   5546  6 004302   000446 236000 5                  LDQ     CUR_UTS+12
         6 004303   000011 772000                    QRL     9
         6 004304   000021 552030 4                  STBQ    KEY8,'30'O
         6 004305   040000 100500                    MLR     fill='040'O
         6 004306   200026 000002                    ADSC9   CHN#,,AUTO               cn=0,n=2
         6 004307   000021 600002 4                  ADSC9   KEY8                     cn=3,n=2
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:229  

     1356     5547    3              WRITE_DEVHIST.BUF_ = VECTOR(TH_CHAN);

   5547  6 004310   000056 235000 7                  LDA     46
         6 004311   210124 452500                    STP2    TH_UTS+3,,AUTO
         6 004312   210124 236100                    LDQ     TH_UTS+3,,AUTO
         6 004313   007720 036003                    ADLQ    4048,DU
         6 004314   002042 757000 4                  STAQ    WRITE_DEVHIST+4

     1357     5548    3              CALL M$WRITE(WRITE_DEVHIST);

   5548  6 004315   002036 630400 4                  EPPR0   WRITE_DEVHIST
         6 004316   040001 713400                    CLIMB   write
         6 004317   401400 401760                    pmme    nvectors=4

     1358     5549    3           END;                            /* DO I                               */

   5549  6 004320   200016 054100                    AOS     I,,AUTO
         6 004321   200016 236100                    LDQ     I,,AUTO
         6 004322   004243 604000 6                  TMI     s:5540
         6 004323   000001 116000 4                  CMPQ    NUM_IOMS
         6 004324   004243 602000 6                  TNC     s:5540

     1359     5550
     1360     5551                                                /* WRITE FEP RECORDS                  */
     1361     5552    3           DO I = 0 TO NUM_FEPS - 1;

   5552  6 004325   200016 450100                    STZ     I,,AUTO
         6 004326   004353 710000 6                  TRA     s:5557+1

     1362     5553    3              KEY8.TXT = FEP_TBL.DEVNAME(I);

   5553  6 004327   200016 236100                    LDQ     I,,AUTO
         6 004330   000014 402007                    MPY     12,DL
         6 004331   000000 470400 xsym               LDP0    FEP_TBL$
         6 004332   040000 100506                    MLR     fill='040'O
         6 004333   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=8
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:230  
         6 004334   000021 200010 4                  ADSC9   KEY8                     cn=1,n=8

     1363     5554    3              TH_FEP = FEP_TBL.PTR$(I)->FEP;

   5554  6 004335   200016 236100                    LDQ     I,,AUTO
         6 004336   000003 402007                    MPY     3,DL
         6 004337   000002 471506                    LDP1    2,QL,PR0
         6 004340   100000 236100                    LDQ     0,,PR1
         6 004341   207670 756100                    STQ     TH_FEP,,AUTO

     1364     5555    3              WRITE_DEVHIST.BUF_ = VECTOR(TH_FEP);

   5555  6 004342   777640 235007                    LDA     -96,DL
         6 004343   210124 452500                    STP2    TH_UTS+3,,AUTO
         6 004344   210124 236100                    LDQ     TH_UTS+3,,AUTO
         6 004345   007670 036003                    ADLQ    4024,DU
         6 004346   002042 757000 4                  STAQ    WRITE_DEVHIST+4

     1365     5556    3              CALL M$WRITE(WRITE_DEVHIST);

   5556  6 004347   002036 630400 4                  EPPR0   WRITE_DEVHIST
         6 004350   040001 713400                    CLIMB   write
         6 004351   401400 401760                    pmme    nvectors=4

     1366     5557    3           END;                            /* DO I                               */

   5557  6 004352   200016 054100                    AOS     I,,AUTO
         6 004353   200016 236100                    LDQ     I,,AUTO
         6 004354   004327 604000 6                  TMI     s:5553
         6 004355   000004 116000 4                  CMPQ    NUM_FEPS
         6 004356   004327 602000 6                  TNC     s:5553

     1367     5558
     1368     5559                                                /* WRITE MPC RECORDS                  */
     1369     5560    3           DO I = 0 TO NUM_MPCS - 1;

   5560  6 004357   200016 450100                    STZ     I,,AUTO
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:231  
         6 004360   004416 710000 6                  TRA     s:5566+1

     1370     5561    3              TH_MPC = MPC_TBL.PTR$(I)->MPC;

   5561  6 004361   200016 236100                    LDQ     I,,AUTO
         6 004362   000003 402007                    MPY     3,DL
         6 004363   000000 470400 xsym               LDP0    MPC_TBL$
         6 004364   000002 471506                    LDP1    2,QL,PR0
         6 004365   000100 100500                    MLR     fill='000'O
         6 004366   100000 000510                    ADSC9   0,,PR1                   cn=0,n=328
         6 004367   207132 000510                    ADSC9   TH_MPC,,AUTO             cn=0,n=328

     1371     5562    3              KEY8.TXT = MPC_TBL.DEVNAME(I);

   5562  6 004370   200016 236100                    LDQ     I,,AUTO
         6 004371   000014 402007                    MPY     12,DL
         6 004372   040000 100506                    MLR     fill='040'O
         6 004373   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=8
         6 004374   000021 200010 4                  ADSC9   KEY8                     cn=1,n=8

     1372     5563    3              WRITE_DEVHIST.BUF_ = VECTOR(TH_MPC);

   5563  6 004375   000057 235000 7                  LDA     47
         6 004376   210124 452500                    STP2    TH_UTS+3,,AUTO
         6 004377   210124 236100                    LDQ     TH_UTS+3,,AUTO
         6 004400   007132 036003                    ADLQ    3674,DU
         6 004401   002042 757000 4                  STAQ    WRITE_DEVHIST+4

     1373     5564    3              WRITE_DEVHIST.BUF_.BOUND = SIZEV(MPC) - (8 * (33 - TH_MPC.NUMDEVS));

   5564  6 004402   207146 236100                    LDQ     TH_MPC+12,,AUTO
         6 004403   777777 376003                    ANQ     -1,DU
         6 004404   000017 772000                    QRL     15
         6 004405   000077 036007                    ADLQ    63,DL
         6 004406   000020 736000                    QLS     16
         6 004407   002042 676000 4                  ERQ     WRITE_DEVHIST+4
         6 004410   000034 376000 xsym               ANQ     B_VECTNIL+28
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:232  
         6 004411   002042 656000 4                  ERSQ    WRITE_DEVHIST+4

     1374     5565    3              CALL M$WRITE(WRITE_DEVHIST);

   5565  6 004412   002036 630400 4                  EPPR0   WRITE_DEVHIST
         6 004413   040001 713400                    CLIMB   write
         6 004414   401400 401760                    pmme    nvectors=4

     1375     5566    3           END;                            /* DO I                               */

   5566  6 004415   200016 054100                    AOS     I,,AUTO
         6 004416   200016 236100                    LDQ     I,,AUTO
         6 004417   004361 604000 6                  TMI     s:5561
         6 004420   000002 116000 4                  CMPQ    NUM_MPCS
         6 004421   004361 602000 6                  TNC     s:5561

     1376     5567
     1377     5568                                                /* WRITE DEVICE RECORDS               */
     1378     5569    3           DO I = 0 TO NUM_DEVS - 1;

   5569  6 004422   200016 450100                    STZ     I,,AUTO
         6 004423   004451 710000 6                  TRA     s:5574+1

     1379     5570    3              KEY8.TXT = DEV_TBL.DEVNAME(I);

   5570  6 004424   200016 236100                    LDQ     I,,AUTO
         6 004425   000014 402007                    MPY     12,DL
         6 004426   000000 470400 xsym               LDP0    DEV_TBL$
         6 004427   040000 100506                    MLR     fill='040'O
         6 004430   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=8
         6 004431   000021 200010 4                  ADSC9   KEY8                     cn=1,n=8

     1380     5571    3              TH_DEV = DEV_TBL.PTR$(I)->DEV;

   5571  6 004432   200016 236100                    LDQ     I,,AUTO
         6 004433   000003 402007                    MPY     3,DL
         6 004434   000002 471506                    LDP1    2,QL,PR0
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:233  
         6 004435   000100 100500                    MLR     fill='000'O
         6 004436   100000 000134                    ADSC9   0,,PR1                   cn=0,n=92
         6 004437   207671 000134                    ADSC9   TH_DEV,,AUTO             cn=0,n=92

     1381     5572    3              WRITE_DEVHIST.BUF_ = VECTOR(TH_DEV);

   5572  6 004440   000060 235000 7                  LDA     48
         6 004441   210124 452500                    STP2    TH_UTS+3,,AUTO
         6 004442   210124 236100                    LDQ     TH_UTS+3,,AUTO
         6 004443   007671 036003                    ADLQ    4025,DU
         6 004444   002042 757000 4                  STAQ    WRITE_DEVHIST+4

     1382     5573    3              CALL M$WRITE(WRITE_DEVHIST);

   5573  6 004445   002036 630400 4                  EPPR0   WRITE_DEVHIST
         6 004446   040001 713400                    CLIMB   write
         6 004447   401400 401760                    pmme    nvectors=4

     1383     5574    3           END;                            /* DO I                               */

   5574  6 004450   200016 054100                    AOS     I,,AUTO
         6 004451   200016 236100                    LDQ     I,,AUTO
         6 004452   004424 604000 6                  TMI     s:5570
         6 004453   000003 116000 4                  CMPQ    NUM_DEVS
         6 004454   004424 602000 6                  TNC     s:5570

     1384     5575    2           CALL XUD$UTS_ADJ_25TH(UTS, UTS, %UTS_25TH_DAY#);

   5575  6 004455   000061 630400 7                  EPPR0   49
         6 004456   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 004457   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         6 004460   000000 011000                    NOP     0

     1385     5576    2        END;                           /* DO WHILE (UTS <= LAST_UTS) */

   5576  6 004461   000011 236000 4                  LDQ     LAST_UTS
         6 004462   000006 116000 4                  CMPQ    UTS
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:234  
         6 004463   003672 603000 6                  TRC     s:5449

     1386     5577             /* Update UTS record */
     1387     5578    1        WRITE_DEVHIST.KEY_ = VECTOR(UTS_KEY);

   5578  6 004464   000064 237000 7                  LDAQ    52
         6 004465   002040 757000 4                  STAQ    WRITE_DEVHIST+2

     1388     5579    1        TH_UTS.ERRLOG_UTS = CURUTS;

   5579  6 004466   000007 235000 4                  LDA     CURUTS
         6 004467   210122 755100                    STA     TH_UTS+1,,AUTO

     1389     5580    1        WRITE_DEVHIST.BUF_ = VECTOR(TH_UTS);

   5580  6 004470   000066 235000 7                  LDA     54
         6 004471   210124 452500                    STP2    TH_UTS+3,,AUTO
         6 004472   210124 236100                    LDQ     TH_UTS+3,,AUTO
         6 004473   010121 036003                    ADLQ    4177,DU
         6 004474   002042 757000 4                  STAQ    WRITE_DEVHIST+4

     1390     5581    1        CALL M$WRITE(WRITE_DEVHIST) ALTRET(ALT);

   5581  6 004475   002036 630400 4                  EPPR0   WRITE_DEVHIST
         6 004476   440001 713400                    CLIMB   alt,write
         6 004477   401400 401760                    pmme    nvectors=4
         6 004500   004671 702000 6                  TSX2    ALT

     1391     5582    1        CALL THG$CLOSEXSA;

   5582  6 004501   000002 631400 xsym               EPPR1   B_VECTNIL+2
         6 004502   000000 701000 xent               TSX1    THG$CLOSEXSA
         6 004503   000000 011000                    NOP     0

     1392     5583    1        CALL M$CLOSE (CLOSE_DEV) ALTRET(ALT);

   5583  6 004504   000370 630400 5                  EPPR0   CLOSE_DEV
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:235  
         6 004505   450001 713400                    CLIMB   alt,close
         6 004506   406000 401760                    pmme    nvectors=13
         6 004507   004671 702000 6                  TSX2    ALT

     1393     5584             /* Delete records in :DEVHIST that are more than 30 days old  */
     1394     5585    1        IF TH_REBUILD

   5585  6 004510   000000 234000 xsym               SZN     TH_REBUILD
         6 004511   004656 605000 6                  TPL     s:5619

     1395     5586    2           THEN DO;

     1396     5587    2                 CALL M$OPEN (OPEN_DEV) ALTRET(ALT);

   5587  6 004512   000276 630400 5                  EPPR0   OPEN_DEV
         6 004513   450000 713400                    CLIMB   alt,open
         6 004514   410400 401760                    pmme    nvectors=18
         6 004515   004671 702000 6                  TSX2    ALT

     1397     5588    2                 CALL M$OPEN (OPEN_NEWDEV) ALTRET(ALT);

   5588  6 004516   000146 630400 5                  EPPR0   OPEN_NEWDEV
         6 004517   450000 713400                    CLIMB   alt,open
         6 004520   410400 401760                    pmme    nvectors=18
         6 004521   004671 702000 6                  TSX2    ALT

     1398     5589    2                 CALL M$TIME (CUR_UTS) ALTRET(ALT);

   5589  6 004522   000432 630400 5                  EPPR0   CUR_UTS
         6 004523   420004 713400                    CLIMB   alt,+8196
         6 004524   402000 401760                    pmme    nvectors=5
         6 004525   004671 702000 6                  TSX2    ALT

     1399     5590    2                 CALL XUD$UTS_ADJ_25TH(OLDEST_UTS, CURUTS, -(30*%UTS_25TH_DAY#));

   5590  6 004526   000067 630400 7                  EPPR0   55
         6 004527   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:236  
         6 004530   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         6 004531   000000 011000                    NOP     0

     1400     5591    2                 CALL M$PFIL (PFIL_DEVHIST) ALTRET(ALT);

   5591  6 004532   002066 630400 4                  EPPR0   PFIL_DEVHIST
         6 004533   440004 713400                    CLIMB   alt,+16388
         6 004534   400000 401760                    pmme    nvectors=1
         6 004535   004671 702000 6                  TSX2    ALT

     1401     5592    3                 DO I = 1 TO 3;

   5592  6 004536   000001 235007                    LDA     1,DL
         6 004537   200016 755100                    STA     I,,AUTO

     1402     5593    3                    CALL M$READ (RD_DEVHIST) ALTRET(END_OF_DEV);

   5593  6 004540   002110 630400 4                  EPPR0   RD_DEVHIST
         6 004541   440000 713400                    CLIMB   alt,read
         6 004542   401400 401760                    pmme    nvectors=4
         6 004543   004645 702000 6                  TSX2    END_OF_DEV

     1403     5594    3                    WRITE_NEWDEV.KEY_ = VECTOR(HD_KEY);

   5594  6 004544   000072 237000 7                  LDAQ    58
         6 004545   002054 757000 4                  STAQ    WRITE_NEWDEV+2

     1404     5595    3                   WRITE_NEWDEV.BUF_.BOUND = DCBADDR(DCBNUM(M$DEVHIST))->F$DCB.ARS - 1
              5595                             ;

   5595  6 004546   000000 236007 xsym               LDQ     M$DEVHIST,DL
         6 004547   000000 470400 7                  LDP0    0
         6 004550   000000 471500                    LDP1    0,,PR0
         6 004551   100000 473506                    LDP3    0,QL,PR1
         6 004552   300000 236100                    LDQ     0,,PR3
         6 004553   000001 136007                    SBLQ    1,DL
         6 004554   000020 736000                    QLS     16
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:237  
         6 004555   002056 676000 4                  ERQ     WRITE_NEWDEV+4
         6 004556   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 004557   002056 656000 4                  ERSQ    WRITE_NEWDEV+4

     1405     5596    3                    CALL M$WRITE (WRITE_NEWDEV);

   5596  6 004560   002052 630400 4                  EPPR0   WRITE_NEWDEV
         6 004561   040001 713400                    CLIMB   write
         6 004562   401400 401760                    pmme    nvectors=4

     1406     5597    3                 END;

   5597  6 004563   200016 054100                    AOS     I,,AUTO
         6 004564   200016 235100                    LDA     I,,AUTO
         6 004565   000003 115007                    CMPA    3,DL
         6 004566   004540 604400 6                  TMOZ    s:5593

     1407     5598    2                 CALL M$READ(RD_DEVHIST) ALTRET(END_OF_DEV);

   5598  6 004567   002110 630400 4                  EPPR0   RD_DEVHIST
         6 004570   440000 713400                    CLIMB   alt,read
         6 004571   401400 401760                    pmme    nvectors=4
         6 004572   004645 702000 6                  TSX2    END_OF_DEV

     1408     5599    2                 WRITE_NEWDEV.KEY_ = VECTOR(HD_KEY);

   5599  6 004573   000072 237000 7                  LDAQ    58
         6 004574   002054 757000 4                  STAQ    WRITE_NEWDEV+2

     1409     5600    2                 WRITE_NEWDEV.BUF_.BOUND =

   5600  6 004575   000000 236007 xsym               LDQ     M$DEVHIST,DL
         6 004576   000000 470400 7                  LDP0    0
         6 004577   000000 471500                    LDP1    0,,PR0
         6 004600   100000 473506                    LDP3    0,QL,PR1
         6 004601   300000 236100                    LDQ     0,,PR3
         6 004602   000001 136007                    SBLQ    1,DL
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:238  
         6 004603   000020 736000                    QLS     16
         6 004604   002056 676000 4                  ERQ     WRITE_NEWDEV+4
         6 004605   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 004606   002056 656000 4                  ERSQ    WRITE_NEWDEV+4

     1410     5601    2                   DCBADDR(DCBNUM(M$DEVHIST)) -> F$DCB.ARS - 1;
     1411     5602    2                 ADDR(REC_BUF) -> TH$UTS.OLDEST_UTS = OLDEST_UTS;

   5602  6 004607   000013 236000 4                  LDQ     OLDEST_UTS
         6 004610   000031 756000 4                  STQ     REC_BUF

     1412     5603    2                 CALL M$WRITE(WRITE_NEWDEV);  /* WRITE UTS RECORD */

   5603  6 004611   002052 630400 4                  EPPR0   WRITE_NEWDEV
         6 004612   040001 713400                    CLIMB   write
         6 004613   401400 401760                    pmme    nvectors=4

     1413     5604    2        READ_DEVHIST:
     1414     5605    2                 CALL M$READ (READ_DEVHIST) ALTRET(END_OF_DEV);

   5605  6 004614   002072 630400 4     READ_DEVHIST EPPR0   READ_DEVHIST
         6 004615   440000 713400                    CLIMB   alt,read
         6 004616   401400 401760                    pmme    nvectors=4
         6 004617   004645 702000 6                  TSX2    END_OF_DEV

     1415     5606    2                 IF OLDEST_UTS > RD_KEY.UTS

   5606  6 004620   000017 235000 4                  LDA     RD_KEY+2
         6 004621   000020 236000 4                  LDQ     RD_KEY+3
         6 004622   000033 773000                    LRL     27
         6 004623   000013 116000 4                  CMPQ    OLDEST_UTS
         6 004624   004644 602000 6                  TNC     s:5613

     1416     5607    2                    THEN;
     1417     5608    3                    ELSE DO;

     1418     5609    3                       WRITE_NEWDEV.KEY_ = VECTOR(RD_KEY);
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:239  

   5609  6 004625   000074 237000 7                  LDAQ    60
         6 004626   002054 757000 4                  STAQ    WRITE_NEWDEV+2

     1419     5610    3                       WRITE_NEWDEV.BUF_.BOUND = DCBADDR(DCBNUM(M$DEVHIST))->F$DCB.ARS
              5610                                - 1;

   5610  6 004627   000000 236007 xsym               LDQ     M$DEVHIST,DL
         6 004630   000000 470400 7                  LDP0    0
         6 004631   000000 471500                    LDP1    0,,PR0
         6 004632   100000 473506                    LDP3    0,QL,PR1
         6 004633   300000 236100                    LDQ     0,,PR3
         6 004634   000001 136007                    SBLQ    1,DL
         6 004635   000020 736000                    QLS     16
         6 004636   002056 676000 4                  ERQ     WRITE_NEWDEV+4
         6 004637   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 004640   002056 656000 4                  ERSQ    WRITE_NEWDEV+4

     1420     5611    3                       CALL M$WRITE(WRITE_NEWDEV);

   5611  6 004641   002052 630400 4                  EPPR0   WRITE_NEWDEV
         6 004642   040001 713400                    CLIMB   write
         6 004643   401400 401760                    pmme    nvectors=4

     1421     5612    3                    END;

     1422     5613    2                 GOTO READ_DEVHIST;

   5613  6 004644   004614 710000 6                  TRA     READ_DEVHIST

     1423     5614    2        END_OF_DEV:
     1424     5615    2                 CALL M$CLOSE(CLOSE_DEVHIST) ALTRET(ALT);

   5615  6 004645   000110 630400 5     END_OF_DEV   EPPR0   CLOSE_DEVHIST
         6 004646   450001 713400                    CLIMB   alt,close
         6 004647   406000 401760                    pmme    nvectors=13
         6 004650   004671 702000 6                  TSX2    ALT
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:240  

     1425     5616    2                 CALL M$CLOSE(CLOSE_NEWDEV) ALTRET(ALT);

   5616  6 004651   000240 630400 5                  EPPR0   CLOSE_NEWDEV
         6 004652   450001 713400                    CLIMB   alt,close
         6 004653   406000 401760                    pmme    nvectors=13
         6 004654   004671 702000 6                  TSX2    ALT

     1426     5617    2                 TH_REBUILD = '0'B;

   5617  6 004655   000000 450000 xsym               STZ     TH_REBUILD

     1427     5618    2           END;

     1428     5619    1        RETURN;

   5619  6 004656   000000 702200 xent               TSX2  ! X66_ARET

     1429     5620    1   NO_MEM:
     1430     5621    1        CALL THM$ERRMSG(%E$TH_NO_MEM);

   5621  6 004657   000077 630400 7     NO_MEM       EPPR0   63
         6 004660   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 004661   000000 701000 xent               TSX1    THM$ERRMSG
         6 004662   000000 011000                    NOP     0

     1431     5622    1        ALTRETURN;

   5622  6 004663   000000 702200 xent               TSX2  ! X66_AALT

     1432     5623             /*E* ERROR: THE-E$TH_NO_MEM-0
     1433     5624                  MESSAGE: NO MEMORY FOR ELAN TO BUILD INTERNAL TABLES -
     1434     5625                           UNABLE TO BUILD HISTORY FILE - ELAN ABORTING */
     1435     5626    1   OPEN_ERR:
     1436     5627    1        CALL THM$ERRMSG(%E$TH_BAD_CONFIG);

   5627  6 004664   000101 630400 7     OPEN_ERR     EPPR0   65
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:241  
         6 004665   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 004666   000000 701000 xent               TSX1    THM$ERRMSG
         6 004667   000000 011000                    NOP     0

     1437     5628    1        ALTRETURN;

   5628  6 004670   000000 702200 xent               TSX2  ! X66_AALT

     1438     5629             /*E* ERROR: THE-E$TH_BAD_CONFIG-0
     1439     5630                  MESSAGE: UNABLE TO ACCESS :CONFIG FILE - ELAN ABORTING */
     1440     5631    1   ALT:
     1441     5632    1        CALL THM$ERRMSG;

   5632  6 004671   000002 631400 xsym  ALT          EPPR1   B_VECTNIL+2
         6 004672   000000 701000 xent               TSX1    THM$ERRMSG
         6 004673   000000 011000                    NOP     0

     1442     5633    1        ALTRETURN;

   5633  6 004674   000000 702200 xent               TSX2  ! X66_AALT
     1443     5634    1   END THE$PROCESS;
     1444     5635        %EOD;

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:242  
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   TH_PERR_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   TH$HIST.:E05TOU  is referenced.
   TD$STRUCT.:E05TOU  is referenced.
   EL$TABLES.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THE$PROCESS.
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:243  

 **** Variables and constants ****

  ****  Section 004  Data  THE$PROCESS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  2126-0-0/w STRC(126)   r     1 ACSLIST                    7-0-0/w UBIN        r     1 CURUTS
    12-0-0/w UBIN        r     1 DEVHIST_UTS               10-0-0/w UBIN        r     1 FIRST_UTS
    14-0-0/b BIT (18)    r     1 HD_KEY                    21-0-0/c STRC(117)   r     1 KEY8
     0-0-0/w UBIN        r     1 LAST_REQID                11-0-0/w UBIN        r     1 LAST_UTS
     3-0-0/w UBIN        r     1 NUM_DEVS                   4-0-0/w UBIN        r     1 NUM_FEPS
     1-0-0/w UBIN        r     1 NUM_IOMS                   2-0-0/w UBIN        r     1 NUM_MPCS
     5-0-0/w UBIN        r     1 NUM_NEW_COMPS             13-0-0/w UBIN        r     1 OLDEST_UTS
  2066-0-0/d STRC(144)   r     1 PFIL_DEVHIST            2110-0-0/d STRC(504)   r     1 RD_DEVHIST
    15-0-0/c STRC(117)   r     1 RD_KEY                  2072-0-0/d STRC(504)   r     1 READ_DEVHIST
    31-0-0/w STRC(37044) r     1 REC_BUF                    6-0-0/w UBIN        r     1 UTS
  2132-0-0/w STRC(180)   r     1 VEHLIST                 2036-0-0/d STRC(432)   r     1 WRITE_DEVHIST
  2052-0-0/d STRC(432)   r     1 WRITE_NEWDEV

  ****  Section 005 RoData THE$PROCESS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   370-0-0/d STRC(1080)  r     1 CLOSE_DEV                110-0-0/d STRC(1080)  r     1 CLOSE_DEVHIST
   240-0-0/d STRC(1080)  r     1 CLOSE_NEWDEV             432-0-0/d STRC(432)   r     1 CUR_UTS
   426-0-0/c STRC(81)    r     1 DEVHIST                   10-0-0/b BIT (18)    r     1 HEAD_KEY
    12-0-0/b BIT (18)    r     1 MAINT_KEY                  2-0-0/c CHAR(8)     r     1 ONE
   276-0-0/d STRC(2088)  r     1 OPEN_DEV                  16-0-0/d STRC(2088)  r     1 OPEN_DEVHIST
   146-0-0/d STRC(2088)  r     1 OPEN_NEWDEV                6-0-0/c CHAR(8)     r     1 THREE
    11-0-0/b BIT (18)    r     1 THRESH_KEY                 4-0-0/c CHAR(8)     r     1 TWO
    13-0-0/b BIT (18)    r     1 UTS_KEY                    0-0-0/c CHAR(8)     r     1 ZERO

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:244  
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    15-0-0/w UBIN(9)     r     1 CHAN#                     13-0-0/w PTR         r     1 CHAN$
    26-0-0/c CHAR(2)     r     1 CHN#                      23-0-0/w PTR         r     1 DCT$
    23-0-0/w STRC        r     1 DCTPTR                    22-0-0/w UBIN        r     1 DCTX
    11-0-0/w PTR         r     1 DEV$                       3-0-0/b BIT         r     1 EOF_FLG
    12-0-0/w PTR         r     1 FEP$                       4-0-0/b BIT         r     1 FOUND
    16-0-0/w SBIN        r     1 I                         21-0-0/w UBIN        r     1 INDX
    14-0-0/w UBIN(3)     r     1 IOM#                       7-0-0/w PTR         r     1 IOM$
    17-0-0/w SBIN        r     1 J                         20-0-0/w SBIN        r     1 K
     5-0-0/w UBIN        r     1 LAST_INDX                 10-0-0/w PTR         r     1 MPC$
    24-0-0/c CHAR(8)     r     1 MPC_NAME                   6-0-0/w UBIN        r     1 OLD_INDX
    30-0-0/w STRC(15048) r     1 TD_HEAD
  5777-0-0/w STRC(108)   r     1 TEMP_MAINT(0:200)
  3200-0-0/w STRC(144)   r     1 TEMP_THRESH(0:200)
    27-0-0/w UBIN        r     1 TEMP_UTS                7720-0-0/w STRC(4644)  r     1 TH_CHAN
  7671-0-0/w STRC(828)   r     1 TH_DEV                  7670-0-0/w STRC        r     1 TH_FEP
   672-0-0/w STRC(15048) r     1 TH_HEAD                 7254-0-0/w STRC(9648)  r     1 TH_IOM
  4644-0-0/w STRC(108)   r     1 TH_MAINT(0:200)         7132-0-0/w STRC(2952)  r     1 TH_MPC
  1534-0-0/w STRC(144)   r     1 TH_THRESH(0:200)
 10121-0-0/w STRC(72)    r     1 TH_UTS

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/c STRC(72)    r     1 DEVHIST_ACCT               0-0-0/w PTR         r     1 DEV_TBL$
     0-0-0/w PTR         r     1 FEP_TBL$                   0-0-0/w PTR         r     1 IOM_TBL$
     0-0-0/w PTR         r     1 MPC_TBL$                   0-0-0/d STRC(1971)  r     1 TH_CONSTRAINTS
     0-0-0/w PTR         r     1 TH_DCT$(0:511)             0-0-0/d STRC(1971)  r     1 TH_DEFAULT
     0-0-0/w UBIN        r     1 TH_DEVHIST_MODE            0-0-0/d STRC(72)    r     1 TH_INFO
     0-0-0/w UBIN        r     1 TH_ITYPE                   0-0-0/w PTR         r     1 TH_M$ERRLOG$
     0-0-0/w UBIN        r     1 TH_MAXDCTX                 0-0-0/b BIT         r     1 TH_PHONY_GHOST
     0-0-0/b BIT         r     1 TH_REBUILD                 0-0-0/d STRC(72)    r     1 TH_RECORD

PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:245  
  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/w STRC(4644)  r     1 CHAN
     0-0-0/w STRC(828)   r     1 DEV
     0-0-0/w STRC(108)   r     1 DEV_TBL(0:0)
     0-0-0/w STRC(1080)  r     1 EL$IOERR                   0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/w STRC        r     1 FEP
     0-0-0/w STRC(108)   r     1 FEP_TBL(0:0)
     0-0-0/w STRC(9648)  r     1 IOM
     0-0-0/w STRC(108)   r     1 IOM_TBL(0:0)
     0-0-0N  NULL        r     1 M$DEVHIST                  0-0-0N  NULL        r     1 M$ERRLOG
     0-0-0N  NULL        r     1 M$NEWDEV                   0-0-0/w STRC(2952)  r     1 MPC
     0-0-0/w STRC(108)   r     1 MPC_TBL(0:0)
     0-0-0/w STRC(1332)  r     1 NI$DCT                     0-0-0/w STRC(15048) r     1 TD$HEAD
     0-0-0/w STRC(15048) r     1 TH$HEAD                    0-0-0/w STRC(108)   r     1 TH$MAINT(0:200)
     0-0-0/w STRC(144)   r     1 TH$THRESH(0:200)
     0-0-0/w STRC(72)    r     1 TH$UTS


   Procedure THE$PROCESS requires 2493 words for executable code.
   Procedure THE$PROCESS requires 4194 words of local(AUTO) storage.
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:246  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:247  
          MINI XREF LISTING

ACSLIST
      4817**DCL      4369--DCLINIT
ACSLIST.Q
      4818**DCL      4817--DCLINIT
ALT
      5632**LABEL    4926--CALLALT  5445--CALLALT  5527--CALLALT  5581--CALLALT  5583--CALLALT  5587--CALLALT
      5588--CALLALT  5589--CALLALT  5591--CALLALT  5615--CALLALT  5616--CALLALT
B$ALT.CODE
      4028**DCL      4028--REDEF    4029--REDEF    4029--REDEF
B$ALT.ERR.CODE
      4030**DCL      4895>>IF
B$ALT.ERR.ERR#
      4030**DCL      4030--REDEF
B$ALT.EVID
      4029**DCL      4029--REDEF    4029--REDEF
B$JIT.CPFLAGS1.SLEAZE
       199**DCL       199--REDEF
B$JIT.ERR.MID
       106**DCL       106--REDEF
B$JIT.JRESPEAK
       267**DCL       268--REDEF
B$JIT.MODE
       100**DCL      4891>>IF
B$JIT.ORIGINATOR_PORT.FROM_CR
       376**DCL       376--REDEF     377--REDEF
B$JIT.PNR
       280**DCL       280--REDEF
B$JIT.TSLINE
       374**DCL       375--REDEF
B$JIT$
      3522**DCL       100--IMP-PTR  4891>>IF
B$TCB.ALT$
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:248  
      4024**DCL      4895>>IF
B$TCB$
      3521**DCL      4895>>IF
BYPASS_CHECK
      5415**LABEL    4951--GOTO
CHAN
      3761**DCL      5544>>ASSIGN
CHAN.CHANS.CONNECTS
      3765**DCL      5501<<ASSIGN   5501>>ASSIGN
CHAN.CHANS.COUNT
      3764**DCL      5500<<ASSIGN   5500>>ASSIGN
CHAN#
      3440**DCL      5468<<ASSIGN   5479>>ASSIGN   5500>>ASSIGN   5500>>ASSIGN   5501>>ASSIGN   5501>>ASSIGN
CHAN$
      3438**DCL      3761--IMP-PTR  5499<<ASSIGN   5500>>ASSIGN   5500>>ASSIGN   5501>>ASSIGN   5501>>ASSIGN
CHN#
      3514**DCL      5545<<CALLBLT  5546>>CALLBLT
CLOSE_DEV
      4634**DCL      4913<>CALL     4926<>CALL     5583<>CALL
CLOSE_DEV.SN_
      4634**DCL      4634--REDEF
CLOSE_DEV.UTL_
      4635**DCL      4635--REDEF
CLOSE_DEV.V
      4639**DCL      4634--DCLINIT
CLOSE_DEV.V.EXPIRE#
      4649**DCL      4649--REDEF
CLOSE_DEV.V.TYPE#
      4647**DCL      4647--REDEF
CLOSE_DEV.V.XTNSIZE#
      4644**DCL      4644--REDEF    4646--REDEF
CLOSE_DEVHIST
      4271**DCL      5400<>CALL     5444<>CALL     5615<>CALL
CLOSE_DEVHIST.SN_
      4271**DCL      4271--REDEF
CLOSE_DEVHIST.UTL_
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:249  
      4272**DCL      4272--REDEF
CLOSE_DEVHIST.V
      4276**DCL      4271--DCLINIT
CLOSE_DEVHIST.V.EXPIRE#
      4286**DCL      4286--REDEF
CLOSE_DEVHIST.V.TYPE#
      4284**DCL      4284--REDEF
CLOSE_DEVHIST.V.XTNSIZE#
      4281**DCL      4281--REDEF    4283--REDEF
CLOSE_NEWDEV
      4437**DCL      5616<>CALL
CLOSE_NEWDEV.SN_
      4437**DCL      4437--REDEF
CLOSE_NEWDEV.UTL_
      4438**DCL      4438--REDEF
CLOSE_NEWDEV.V
      4442**DCL      4437--DCLINIT
CLOSE_NEWDEV.V.EXPIRE#
      4452**DCL      4452--REDEF
CLOSE_NEWDEV.V.TYPE#
      4450**DCL      4450--REDEF
CLOSE_NEWDEV.V.XTNSIZE#
      4447**DCL      4447--REDEF    4449--REDEF
CURUTS
      3516**DCL      4701--DCLINIT  4924>>IF       5423<>CALL     5427<>CALL     5453>>ASSIGN   5579>>ASSIGN
      5590<>CALL
CUR_UTS
      4697**DCL      4921<>CALL     5422<>CALL     5589<>CALL
CUR_UTS.V
      4701**DCL      4697--DCLINIT
DCT$
      3455**DCL      3456--REDEF    3469--IMP-PTR  5486<<ASSIGN   5488>>IF       5490>>ASSIGN
DCTPTR.SEGID
      3459**DCL      5487<<ASSIGN
DCTX
      3454**DCL      5485<<DOINDEX  5486>>ASSIGN
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:250  
DEV
      3701**DCL      5571>>ASSIGN
DEV.CONNECTS
      3719**DCL      5512<<ASSIGN   5512>>ASSIGN
DEV.COUNT
      3718**DCL      5511<<ASSIGN   5511>>ASSIGN
DEV$
      3436**DCL      3701--IMP-PTR  5510<<ASSIGN   5511>>ASSIGN   5511>>ASSIGN   5512>>ASSIGN   5512>>ASSIGN
DEVHIST
      4680**DCL      4170--DCLINIT  4368--DCLINIT  4565--DCLINIT
DEVHIST_ACCT
      2904**DCL      4174--DCLINIT  4372--DCLINIT  4569--DCLINIT
DEVHIST_UTS
      3519**DCL      5420<<ASSIGN   5426>>IF       5430<<ASSIGN   5433<>CALL     5440<<ASSIGN   5450>>ASSIGN
DEV_TBL.DEVNAME
      4019**DCL      5507>>IF       5570>>ASSIGN
DEV_TBL.PTR$
      4020**DCL      5510>>ASSIGN   5571>>ASSIGN
DEV_TBL$
      3513**DCL      4018--IMP-PTR  5507>>IF       5510>>ASSIGN   5570>>ASSIGN   5571>>ASSIGN
DO_GHOST2
      4951**LABEL    4950--GOTO
EL$FEPERR.STATDATA.TERMID.TERM
      3971**DCL      3980--REDEF
EL$IOERR.CONNECTS.CHANNEL
      3890**DCL      5501>>ASSIGN
EL$IOERR.CONNECTS.DEVICE
      3890**DCL      5512>>ASSIGN
EL$IOERR.CONNECTS.IOM
      3890**DCL      5474>>ASSIGN
EL$IOERR.DEVNM
      3892**DCL      5507>>IF
EL$IOERR.IOCHAN.CHAN
      3889**DCL      5468>>ASSIGN
EL$IOERR.IOCHAN.IOM
      3889**DCL      5466>>ASSIGN
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:251  
EL$IOERR.REQID
      3887**DCL      5465>>IF       5515>>ASSIGN
EL$IOERR.SEEK
      3891**DCL      3892--REDEF
EL$IOERR.STATUS
      3887**DCL      3888--REDEF
EL$IOERR.THRESH.CHANNEL
      3893**DCL      5496>>IF
EL$IOERR.THRESH.DEVICE
      3893**DCL      5504>>IF
EL$IOERR.THRESH.IOM
      3892**DCL      5469>>IF
EL$IOERR.THRESH.MPC
      3893**DCL      5476>>IF
END_OF_DEV
      5615**LABEL    5593--CALLALT  5598--CALLALT  5605--CALLALT
EOF_FLG
      3429**DCL      5459<<ASSIGN   5460>>DOWHILE  5520<<ASSIGN
EOF_LBL
      5520**LABEL    5462--CALLALT
F$DCB.ACTPOS
      2289**DCL      2289--REDEF
F$DCB.ARS
      2264**DCL      2264--REDEF    4911>>IF       5595>>ASSIGN   5600>>ASSIGN   5610>>ASSIGN
F$DCB.ATTR
      2282**DCL      2283--REDEF
F$DCB.BORROW
      2297**DCL      2297--REDEF    2297--REDEF    2297--REDEF
F$DCB.DCBNAME.L
      2311**DCL      2311--IMP-SIZ
F$DCB.EOMCHAR
      2268**DCL      2268--REDEF
F$DCB.FCD
      2277**DCL      5399>>IF       5443>>IF       5526>>IF
F$DCB.FLDID
      2292**DCL      2292--REDEF
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:252  
F$DCB.FORM$
      2286**DCL      2286--REDEF
F$DCB.FSECT
      2302**DCL      2302--REDEF
F$DCB.FSN
      2279**DCL      2279--REDEF    2279--REDEF    2280--REDEF
F$DCB.HEADER$
      2285**DCL      2285--REDEF
F$DCB.IXTNSIZE
      2283**DCL      2283--REDEF
F$DCB.LASTSTA$
      2273**DCL      2273--REDEF
F$DCB.LVL
      2298**DCL      2298--REDEF
F$DCB.NAME.C
      2273**DCL      2273--REDEF
F$DCB.NOEOF
      2294**DCL      2294--REDEF
F$DCB.NRECS
      2284**DCL      2284--REDEF
F$DCB.NRECX
      2303**DCL      2303--REDEF
F$DCB.OHDR
      2295**DCL      2295--REDEF
F$DCB.ORG
      2278**DCL      2278--REDEF
F$DCB.PRECNO
      2301**DCL      2301--REDEF
F$DCB.RCSZ
      2306**DCL      2306--REDEF
F$DCB.RES
      2274**DCL      2274--REDEF
F$DCB.SETX
      2286**DCL      2286--REDEF
F$DCB.TAB$
      2285**DCL      2286--REDEF
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:253  
F$DCB.TDA
      2300**DCL      2300--REDEF
F$DCB.WSN
      2275**DCL      2275--REDEF
FEP
      3754**DCL      5554>>ASSIGN
FEP$
      3437**DCL      3754--IMP-PTR
FEP_TBL.DEVNAME
      4014**DCL      5553>>ASSIGN
FEP_TBL.PTR$
      4015**DCL      5554>>ASSIGN
FEP_TBL$
      3512**DCL      4013--IMP-PTR  5553>>ASSIGN   5554>>ASSIGN
FIRST_UTS
      3517**DCL      5427<>CALL     5428<<ASSIGN   5428>>ASSIGN   5429<>CALL     5429>>CALL     5430>>ASSIGN
      5433<>CALL     5434<<ASSIGN   5434>>ASSIGN   5435<>CALL     5435>>CALL     5437>>IF       5439<<ASSIGN
      5447>>ASSIGN   5449>>IF
FOUND
      3430**DCL      4955<<ASSIGN   4958<<ASSIGN   4960>>IF       4990<<ASSIGN   4993<<ASSIGN   4995>>IF
      5022<<ASSIGN   5025<<ASSIGN   5027>>IF       5056<<ASSIGN   5059<<ASSIGN   5061>>IF       5089<<ASSIGN
      5092<<ASSIGN   5094>>IF       5121<<ASSIGN   5124<<ASSIGN   5126>>IF       5153<<ASSIGN   5156<<ASSIGN
      5158>>IF       5183<<ASSIGN   5186<<ASSIGN   5188>>IF       5211<<ASSIGN   5214<<ASSIGN   5216>>IF
      5238<<ASSIGN   5241<<ASSIGN   5243>>IF       5264<<ASSIGN   5267<<ASSIGN   5269>>IF       5289<<ASSIGN
      5292<<ASSIGN   5294>>IF       5313<<ASSIGN   5316<<ASSIGN   5318>>IF       5336<<ASSIGN   5339<<ASSIGN
      5341>>IF       5359<<ASSIGN   5362<<ASSIGN   5364>>IF
HD_KEY
      3528**DCL      4784--DCLINIT  4785--DCLINIT  5594--ASSIGN   5599--ASSIGN
HEAD_KEY
      3523**DCL      5530--ASSIGN
I
      3450**DCL      4954<<DOINDEX  4957>>IF       4968>>ASSIGN   4989<<DOINDEX  4992>>IF       4999>>ASSIGN
      5021<<DOINDEX  5024>>IF       5035>>ASSIGN   5055<<DOINDEX  5058>>IF       5069>>ASSIGN   5088<<DOINDEX
      5091>>IF       5102>>ASSIGN   5120<<DOINDEX  5123>>IF       5134>>ASSIGN   5152<<DOINDEX  5155>>IF
      5166>>ASSIGN   5182<<DOINDEX  5185>>IF       5196>>ASSIGN   5210<<DOINDEX  5213>>IF       5224>>ASSIGN
      5237<<DOINDEX  5240>>IF       5251>>ASSIGN   5263<<DOINDEX  5266>>IF       5277>>ASSIGN   5288<<DOINDEX
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:254  
      5291>>IF       5302>>ASSIGN   5312<<DOINDEX  5315>>IF       5326>>ASSIGN   5335<<DOINDEX  5338>>IF
      5349>>ASSIGN   5358<<DOINDEX  5361>>IF       5368>>ASSIGN   5382<<DOINDEX  5383>>IF       5386>>ASSIGN
      5387>>ASSIGN   5392>>ASSIGN   5392>>ASSIGN   5393>>ASSIGN   5394>>ASSIGN   5394>>ASSIGN   5395>>ASSIGN
      5396>>ASSIGN   5480<<DOINDEX  5481>>IF       5484>>ASSIGN   5506<<DOINDEX  5507>>IF       5510>>ASSIGN
      5539<<DOINDEX  5540>>ASSIGN   5541>>ASSIGN   5544>>ASSIGN   5545>>CALLBLT  5552<<DOINDEX  5553>>ASSIGN
      5554>>ASSIGN   5560<<DOINDEX  5561>>ASSIGN   5562>>ASSIGN   5569<<DOINDEX  5570>>ASSIGN   5571>>ASSIGN
      5592<<DOINDEX
INDX
      3453**DCL      4964<<ASSIGN   4965>>ASSIGN   4965>>ASSIGN   5031<<ASSIGN   5032>>ASSIGN   5032>>ASSIGN
      5065<<ASSIGN   5066>>ASSIGN   5066>>ASSIGN   5098<<ASSIGN   5099>>ASSIGN   5099>>ASSIGN   5130<<ASSIGN
      5131>>ASSIGN   5131>>ASSIGN   5162<<ASSIGN   5163>>ASSIGN   5163>>ASSIGN   5192<<ASSIGN   5193>>ASSIGN
      5193>>ASSIGN   5220<<ASSIGN   5221>>ASSIGN   5221>>ASSIGN   5247<<ASSIGN   5248>>ASSIGN   5248>>ASSIGN
      5273<<ASSIGN   5274>>ASSIGN   5274>>ASSIGN   5298<<ASSIGN   5299>>ASSIGN   5299>>ASSIGN   5322<<ASSIGN
      5323>>ASSIGN   5323>>ASSIGN   5345<<ASSIGN   5346>>ASSIGN   5346>>ASSIGN
IOM
      3722**DCL      5540>>ASSIGN
IOM.CHAN$
      3728**DCL      5499>>ASSIGN   5544>>ASSIGN
IOM.CONNECTS
      3729**DCL      5474<<ASSIGN   5474>>ASSIGN
IOM.COUNT
      3730**DCL      5473<<ASSIGN   5473>>ASSIGN
IOM.DEVNAME
      3723**DCL      5479>>ASSIGN
IOM#
      3439**DCL      5466<<ASSIGN   5467>>IF       5472>>ASSIGN   5479>>ASSIGN   5499>>ASSIGN
IOM$
      3434**DCL      3722--IMP-PTR  5472<<ASSIGN   5473>>ASSIGN   5473>>ASSIGN   5474>>ASSIGN   5474>>ASSIGN
IOM_TBL.DEVNAME
      4004**DCL      5541>>ASSIGN
IOM_TBL.PTR$
      4005**DCL      5472>>ASSIGN   5479>>ASSIGN   5499>>ASSIGN   5540>>ASSIGN   5544>>ASSIGN
IOM_TBL$
      3510**DCL      4003--IMP-PTR  5472>>ASSIGN   5479>>ASSIGN   5499>>ASSIGN   5540>>ASSIGN   5541>>ASSIGN
      5544>>ASSIGN
J
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:255  
      3451**DCL      4956<<DOINDEX  4957>>IF       4991<<DOINDEX  4992>>IF       5023<<DOINDEX  5024>>IF
      5057<<DOINDEX  5058>>IF       5090<<DOINDEX  5091>>IF       5122<<DOINDEX  5123>>IF       5154<<DOINDEX
      5155>>IF       5184<<DOINDEX  5185>>IF       5212<<DOINDEX  5213>>IF       5239<<DOINDEX  5240>>IF
      5265<<DOINDEX  5266>>IF       5290<<DOINDEX  5291>>IF       5314<<DOINDEX  5315>>IF       5337<<DOINDEX
      5338>>IF       5360<<DOINDEX  5361>>IF       5381<<ASSIGN   5383>>IF       5383>>IF       5386>>ASSIGN
      5387>>ASSIGN   5388<<ASSIGN   5388>>ASSIGN
K
      3452**DCL      4963<<DOINDEX  4964>>ASSIGN   4996<<DOINDEX  4997>>ASSIGN   4997>>ASSIGN   5030<<DOINDEX
      5031>>ASSIGN   5064<<DOINDEX  5065>>ASSIGN   5097<<DOINDEX  5098>>ASSIGN   5129<<DOINDEX  5130>>ASSIGN
      5161<<DOINDEX  5162>>ASSIGN   5191<<DOINDEX  5192>>ASSIGN   5219<<DOINDEX  5220>>ASSIGN   5246<<DOINDEX
      5247>>ASSIGN   5272<<DOINDEX  5273>>ASSIGN   5297<<DOINDEX  5298>>ASSIGN   5321<<DOINDEX  5322>>ASSIGN
      5344<<DOINDEX  5345>>ASSIGN
KEEP_GOING
      5526**LABEL    5458--CALLALT
KEY8
      3533**DCL      5536--ASSIGN
KEY8.TXT
      3535**DCL      5541<<ASSIGN   5546<<CALLBLT  5553<<ASSIGN   5562<<ASSIGN   5570<<ASSIGN
KEY8.UTS
      3536**DCL      5535<<ASSIGN
LAST_INDX
      3431**DCL      4947<<ASSIGN   4948>>ASSIGN   4963>>DOINDEX  4964>>ASSIGN   4969<<ASSIGN   4969>>ASSIGN
      4996>>DOINDEX  5001<<ASSIGN   5001>>ASSIGN   5030>>DOINDEX  5031>>ASSIGN   5036<<ASSIGN   5036>>ASSIGN
      5064>>DOINDEX  5065>>ASSIGN   5070<<ASSIGN   5070>>ASSIGN   5097>>DOINDEX  5098>>ASSIGN   5103<<ASSIGN
      5103>>ASSIGN   5129>>DOINDEX  5130>>ASSIGN   5135<<ASSIGN   5135>>ASSIGN   5161>>DOINDEX  5162>>ASSIGN
      5167<<ASSIGN   5167>>ASSIGN   5191>>DOINDEX  5192>>ASSIGN   5197<<ASSIGN   5197>>ASSIGN   5219>>DOINDEX
      5220>>ASSIGN   5225<<ASSIGN   5225>>ASSIGN   5246>>DOINDEX  5247>>ASSIGN   5252<<ASSIGN   5252>>ASSIGN
      5272>>DOINDEX  5273>>ASSIGN   5278<<ASSIGN   5278>>ASSIGN   5297>>DOINDEX  5298>>ASSIGN   5303<<ASSIGN
      5303>>ASSIGN   5321>>DOINDEX  5322>>ASSIGN   5327<<ASSIGN   5327>>ASSIGN   5344>>DOINDEX  5345>>ASSIGN
      5350<<ASSIGN   5350>>ASSIGN   5369<<ASSIGN   5369>>ASSIGN   5382>>DOINDEX  5404>>ASSIGN   5409>>ASSIGN
      5532>>ASSIGN
LAST_REQID
      3433**DCL      5465>>IF       5515<<ASSIGN
LAST_UTS
      3518**DCL      5423<>CALL     5424<<ASSIGN   5424>>ASSIGN   5425<>CALL     5425>>CALL     5436<>CALL
      5448>>DOWHILE  5452>>IF
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:256  
LOOP
      5462**LABEL    5465--GOTO     5467--GOTO
M$CLOSE
        19**DCL-ENT  4913--CALL     4926--CALL     5400--CALL     5444--CALL     5583--CALL     5615--CALL
      5616--CALL
M$DEVHIST
      3425**DCL      4911--IF       5399--IF       5443--IF       5526--IF       5595--ASSIGN   5600--ASSIGN
      5610--ASSIGN
M$ERRLOG
      3424**DCL      4888--ASSIGN
M$OPEN
        19**DCL-ENT  5401--CALL     5445--CALL     5527--CALL     5587--CALL     5588--CALL
M$PFIL
        21**DCL-ENT  5591--CALL
M$READ
        20**DCL-ENT  5593--CALL     5598--CALL     5605--CALL
M$TIME
        86**DCL-ENT  4921--CALL     5422--CALL     5589--CALL
M$WRITE
        20**DCL-ENT  5405--CALL     5410--CALL     5533--CALL     5543--CALL     5548--CALL     5556--CALL
      5565--CALL     5573--CALL     5581--CALL     5596--CALL     5603--CALL     5611--CALL
MAINT_KEY
      3525**DCL      5403--ASSIGN
MPC
      3733**DCL      5561>>ASSIGN   5564--ASSIGN
MPC.CONNECTS
      3735**DCL      5490<<ASSIGN
MPC.COUNT
      3734**DCL      5489<<ASSIGN   5489>>ASSIGN
MPC$
      3435**DCL      3733--IMP-PTR  5484<<ASSIGN   5489>>ASSIGN   5489>>ASSIGN   5490>>ASSIGN
MPC_NAME
      3509**DCL      5479<<ASSIGN   5481>>IF       5488>>IF
MPC_TBL.DEVNAME
      4009**DCL      5481>>IF       5562>>ASSIGN
MPC_TBL.PTR$
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:257  
      4010**DCL      5484>>ASSIGN   5561>>ASSIGN
MPC_TBL$
      3511**DCL      4008--IMP-PTR  5481>>IF       5484>>ASSIGN   5561>>ASSIGN   5562>>ASSIGN
NI$DCT.DEVNM
      3469**DCL      5488>>IF
NI$DCT.DP
      3489**DCL      3496--REDEF    3499--REDEF    3500--REDEF    3502--REDEF    3502--REDEF    3503--REDEF
      3504--REDEF    3504--REDEF
NI$DCT.MPC.IOCHANX
      3497**DCL      3497--REDEF
NI$DCT.PM.CONNCT
      3480**DCL      5490>>ASSIGN
NO_HEAD
      4895**LABEL    4890--CALLALT
NO_MEM
      5621**LABEL    5457--CALLALT
NUM_DEVS
      3448**DCL      4941<<ASSIGN   5506>>DOINDEX  5569>>DOINDEX
NUM_FEPS
      3449**DCL      4943<<ASSIGN   5552>>DOINDEX
NUM_IOMS
      3446**DCL      4938<<ASSIGN   5467>>IF       5539>>DOINDEX
NUM_MPCS
      3447**DCL      4939<<ASSIGN   5480>>DOINDEX  5560>>DOINDEX
NUM_NEW_COMPS
      3508**DCL      4887<<ASSIGN   4985<<ASSIGN   4985>>ASSIGN   5016<<ASSIGN   5016>>ASSIGN   5050<<ASSIGN
      5050>>ASSIGN   5083<<ASSIGN   5083>>ASSIGN   5115<<ASSIGN   5115>>ASSIGN   5146<<ASSIGN   5146>>ASSIGN
      5177<<ASSIGN   5177>>ASSIGN   5205<<ASSIGN   5205>>ASSIGN   5232<<ASSIGN   5232>>ASSIGN   5258<<ASSIGN
      5258>>ASSIGN   5283<<ASSIGN   5283>>ASSIGN   5307<<ASSIGN   5307>>ASSIGN   5330<<ASSIGN   5330>>ASSIGN
      5352<<ASSIGN   5352>>ASSIGN   5370<<ASSIGN   5370>>ASSIGN   5374>>IF
OLDEST_UTS
      3520**DCL      5436<>CALL     5437>>IF       5439>>ASSIGN   5440>>ASSIGN   5590<>CALL     5602>>ASSIGN
      5606>>IF
OLD_INDX
      3432**DCL      4948<<ASSIGN   5383>>IF
ONE
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:258  
      3442**DCL      5377<>CALL
OPEN_DEV
      4564**DCL      5587<>CALL
OPEN_DEV.ACSVEH_
      4566**DCL      4567--REDEF
OPEN_DEV.ALTKEYS_
      4572**DCL      4573--REDEF    4573--REDEF
OPEN_DEV.HDR_
      4571**DCL      4572--REDEF
OPEN_DEV.TAB_
      4570**DCL      4571--REDEF
OPEN_DEV.UHL_
      4564**DCL      4565--REDEF    4565--REDEF
OPEN_DEV.V
      4573**DCL      4564--DCLINIT
OPEN_DEV.V.FSN#
      4604**DCL      4604--REDEF    4604--REDEF
OPEN_DEV.WSN_
      4570**DCL      4570--REDEF
OPEN_DEVHIST
      4169**DCL      5401<>CALL     5445<>CALL     5527<>CALL
OPEN_DEVHIST.ACSVEH_
      4171**DCL      4172--REDEF
OPEN_DEVHIST.ALTKEYS_
      4177**DCL      4178--REDEF    4178--REDEF
OPEN_DEVHIST.HDR_
      4176**DCL      4177--REDEF
OPEN_DEVHIST.TAB_
      4175**DCL      4176--REDEF
OPEN_DEVHIST.UHL_
      4169**DCL      4170--REDEF    4170--REDEF
OPEN_DEVHIST.V
      4178**DCL      4169--DCLINIT
OPEN_DEVHIST.V.FSN#
      4209**DCL      4209--REDEF    4209--REDEF
OPEN_DEVHIST.WSN_
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:259  
      4175**DCL      4175--REDEF
OPEN_ERR
      5627**LABEL    4936--CALLALT
OPEN_NEWDEV
      4367**DCL      5588<>CALL
OPEN_NEWDEV.ACSVEH_
      4369**DCL      4370--REDEF
OPEN_NEWDEV.ALTKEYS_
      4375**DCL      4376--REDEF    4376--REDEF
OPEN_NEWDEV.HDR_
      4374**DCL      4375--REDEF
OPEN_NEWDEV.TAB_
      4373**DCL      4374--REDEF
OPEN_NEWDEV.UHL_
      4367**DCL      4368--REDEF    4368--REDEF
OPEN_NEWDEV.V
      4376**DCL      4367--DCLINIT
OPEN_NEWDEV.V.FSN#
      4407**DCL      4407--REDEF    4407--REDEF
OPEN_NEWDEV.WSN_
      4373**DCL      4373--REDEF
PFIL_DEVHIST
      4716**DCL      5591<>CALL
PFIL_DEVHIST.V
      4716**DCL      4716--DCLINIT
RD_DEVHIST
      4784**DCL      5593<>CALL     5598<>CALL
RD_DEVHIST.STATION_
      4787**DCL      4788--REDEF
RD_DEVHIST.V
      4788**DCL      4784--DCLINIT
RD_DEVHIST.V.DVBYTE.REREAD#
      4799**DCL      4799--REDEF
RD_DEVHIST.V.INDX#
      4797**DCL      4797--REDEF
RD_KEY
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:260  
      3529**DCL      4741--DCLINIT  4742--DCLINIT  5609--ASSIGN
RD_KEY.UTS
      3532**DCL      5606>>IF
READ_CONFIG_HEAD
      4936**LABEL    4917--GOTO
READ_DEVHIST
      5605**LABEL    5605<>CALL     5613--GOTO
READ_DEVHIST.STATION_
      4744**DCL      4745--REDEF
READ_DEVHIST.V
      4745**DCL      4741--DCLINIT
READ_DEVHIST.V.DVBYTE.REREAD#
      4756**DCL      4756--REDEF
READ_DEVHIST.V.INDX#
      4754**DCL      4754--REDEF
REC_BUF
      3883**DCL      4476--DCLINIT  4477--DCLINIT  4743--DCLINIT  4744--DCLINIT  4786--DCLINIT  4787--DCLINIT
      5602--ASSIGN
REC_BUF.TYPE
      3883**DCL      3883--REDEF
TD$HEAD
      3557**DCL      4937>>ASSIGN
TD_HEAD
      3629**DCL      4937<<ASSIGN   5457<>CALL
TD_HEAD.APMPC_INDX
      3638**DCL      5120>>DOINDEX  5120>>DOINDEX
TD_HEAD.AP_INDX
      3658**DCL      5335>>DOINDEX  5335>>DOINDEX
TD_HEAD.CP_INDX
      3650**DCL      5237>>DOINDEX  5237>>DOINDEX
TD_HEAD.CR_INDX
      3648**DCL      5210>>DOINDEX  5210>>DOINDEX
TD_HEAD.DEVNAME
      3662**DCL      4957>>IF       4968>>ASSIGN   4992>>IF       4999>>ASSIGN   5024>>IF       5035>>ASSIGN
      5058>>IF       5069>>ASSIGN   5091>>IF       5102>>ASSIGN   5123>>IF       5134>>ASSIGN   5155>>IF
      5166>>ASSIGN   5185>>IF       5196>>ASSIGN   5213>>IF       5224>>ASSIGN   5240>>IF       5251>>ASSIGN
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:261  
      5266>>IF       5277>>ASSIGN   5291>>IF       5302>>ASSIGN   5315>>IF       5326>>ASSIGN   5338>>IF
      5349>>ASSIGN   5361>>IF       5368>>ASSIGN
TD_HEAD.DISKMPC_INDX
      3636**DCL      5088>>DOINDEX  5088>>DOINDEX
TD_HEAD.DP_INDX
      3652**DCL      5263>>DOINDEX  5263>>DOINDEX
TD_HEAD.FEP_INDX
      3642**DCL      4989>>DOINDEX  4989>>DOINDEX
TD_HEAD.IOM_INDX
      3630**DCL      4954>>DOINDEX  4954>>DOINDEX
TD_HEAD.LP_INDX
      3646**DCL      5182>>DOINDEX  5182>>DOINDEX
TD_HEAD.MT_INDX
      3654**DCL      5288>>DOINDEX  5288>>DOINDEX
TD_HEAD.NUMAPMPCS
      3639**DCL      4939>>ASSIGN   5120>>DOINDEX
TD_HEAD.NUMAPS
      3659**DCL      4941>>ASSIGN   5335>>DOINDEX
TD_HEAD.NUMCPS
      3651**DCL      4941>>ASSIGN   5237>>DOINDEX
TD_HEAD.NUMCRS
      3649**DCL      4941>>ASSIGN   5210>>DOINDEX
TD_HEAD.NUMDISKMPCS
      3637**DCL      4939>>ASSIGN   5088>>DOINDEX
TD_HEAD.NUMDPS
      3653**DCL      4941>>ASSIGN   5263>>DOINDEX
TD_HEAD.NUMFEPS
      3643**DCL      4943>>ASSIGN   4989>>DOINDEX
TD_HEAD.NUMIOMS
      3631**DCL      4938>>ASSIGN   4954>>DOINDEX
TD_HEAD.NUMLPS
      3647**DCL      4941>>ASSIGN   5182>>DOINDEX
TD_HEAD.NUMMTS
      3655**DCL      4941>>ASSIGN   5288>>DOINDEX
TD_HEAD.NUMODS
      3661**DCL      4941>>ASSIGN   5358>>DOINDEX
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:262  
TD_HEAD.NUMOPCS
      3641**DCL      4939>>ASSIGN   5152>>DOINDEX
TD_HEAD.NUMTAPEMPCS
      3635**DCL      4939>>ASSIGN   5055>>DOINDEX
TD_HEAD.NUMUNITMPCS
      3633**DCL      4939>>ASSIGN   5021>>DOINDEX
TD_HEAD.NUMXXS
      3657**DCL      4941>>ASSIGN   5312>>DOINDEX
TD_HEAD.OD_INDX
      3660**DCL      5358>>DOINDEX  5358>>DOINDEX
TD_HEAD.OPC_INDX
      3640**DCL      5152>>DOINDEX  5152>>DOINDEX
TD_HEAD.TAPEMPC_INDX
      3634**DCL      5055>>DOINDEX  5055>>DOINDEX
TD_HEAD.UNITMPC_INDX
      3632**DCL      5021>>DOINDEX  5021>>DOINDEX
TD_HEAD.XX_INDX
      3656**DCL      5312>>DOINDEX  5312>>DOINDEX
TEMP_MAINT
      3802**DCL      5386<<ASSIGN   5402--ASSIGN
TEMP_MAINT.DEVNAME
      3803**DCL      5392<<ASSIGN
TEMP_MAINT.UTS
      3804**DCL      5393<<ASSIGN
TEMP_THRESH
      3786**DCL      5387<<ASSIGN   5408--ASSIGN
TEMP_THRESH.ALERT
      3789**DCL      5396<<ASSIGN
TEMP_THRESH.ATTEN
      3788**DCL      5395<<ASSIGN
TEMP_THRESH.DEVNAME
      3787**DCL      5394<<ASSIGN
TEMP_UTS
      3546**DCL      4923<>CALL     4924>>IF
TH$HEAD
      3593**DCL      4908>>ASSIGN   4915>>ASSIGN
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:263  
TH$MAINT
      3792**DCL      5380>>ASSIGN
TH$THRESH
      3774**DCL      5378>>ASSIGN
TH$UTS
      3768**DCL      4910>>ASSIGN   5419>>ASSIGN
TH$UTS.OLDEST_UTS
      3769**DCL      5602<<ASSIGN
THD$DEVHIST
      3421**DCL-ENT  4897--CALL     4914--CALL
THE$INIT
      3419**DCL-ENT  5457--CALL
THG$CLOSEXSA
      3418**DCL-ENT  5582--CALL
THG$GETREC
      3416**DCL-ENT  4890--CALL     4909--CALL     4936--CALL     5377--CALL     5379--CALL     5418--CALL
      5462--CALL
THG$OPENXSA
      3417**DCL-ENT  5458--CALL
THM$ERRMSG
      3420**DCL-ENT  4904--CALL     5621--CALL     5627--CALL     5632--CALL
THREE
      3444**DCL      4909<>CALL     5418<>CALL
THRESH_KEY
      3524**DCL      5407--ASSIGN
TH_CHAN
      3868**DCL      5544<<ASSIGN   5547--ASSIGN
TH_CONSTRAINTS
      2839**DCL      5415<<ASSIGN
TH_CONSTRAINTS.E_BY_B
      2842**DCL      2842--REDEF
TH_CONSTRAINTS.M_BY_B
      2841**DCL      2841--REDEF
TH_CONSTRAINTS.START
      2840**DCL      5450<<ASSIGN   5451<<ASSIGN   5458<>CALL
TH_CONSTRAINTS.STOP
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:264  
      2840**DCL      5453<<ASSIGN   5454<>CALL
TH_CONSTRAINTS.TYPES
      2839**DCL      2839--REDEF
TH_DCT$
      2874**DCL      5486>>ASSIGN
TH_DEFAULT
      2846**DCL      5415>>ASSIGN
TH_DEFAULT.E_BY_B
      2850**DCL      2850--REDEF
TH_DEFAULT.M_BY_B
      2849**DCL      2849--REDEF
TH_DEFAULT.TYPES
      2847**DCL      2847--REDEF
TH_DEV
      3847**DCL      5571<<ASSIGN   5572--ASSIGN
TH_DEVHIST_MODE
      2864**DCL      4891>>IF       4919>>IF       4928<<ASSIGN   4951>>IF
TH_FEP
      3840**DCL      5554<<ASSIGN   5555--ASSIGN
TH_HEAD
      3665**DCL      4908<<ASSIGN   4915<<ASSIGN   5531--ASSIGN   5532--ASSIGN
TH_HEAD.APMPC_INDX
      3674**DCL      4974<<ASSIGN   4974>>ASSIGN   5005<<ASSIGN   5005>>ASSIGN   5039<<ASSIGN   5039>>ASSIGN
      5072<<ASSIGN   5072>>ASSIGN   5097>>DOINDEX  5098>>ASSIGN   5104<<ASSIGN   5104>>ASSIGN   5122>>DOINDEX
      5122>>DOINDEX  5134>>ASSIGN
TH_HEAD.AP_INDX
      3694**DCL      4983<<ASSIGN   4983>>ASSIGN   5014<<ASSIGN   5014>>ASSIGN   5048<<ASSIGN   5048>>ASSIGN
      5081<<ASSIGN   5081>>ASSIGN   5113<<ASSIGN   5113>>ASSIGN   5144<<ASSIGN   5144>>ASSIGN   5175<<ASSIGN
      5175>>ASSIGN   5203<<ASSIGN   5203>>ASSIGN   5230<<ASSIGN   5230>>ASSIGN   5256<<ASSIGN   5256>>ASSIGN
      5281<<ASSIGN   5281>>ASSIGN   5305<<ASSIGN   5305>>ASSIGN   5321>>DOINDEX  5322>>ASSIGN   5328<<ASSIGN
      5328>>ASSIGN   5337>>DOINDEX  5337>>DOINDEX  5349>>ASSIGN
TH_HEAD.CONSOLE_INDX
      3680**DCL      4976<<ASSIGN   4976>>ASSIGN   5007<<ASSIGN   5007>>ASSIGN   5041<<ASSIGN   5041>>ASSIGN
      5074<<ASSIGN   5074>>ASSIGN   5106<<ASSIGN   5106>>ASSIGN   5137<<ASSIGN   5137>>ASSIGN   5161>>DOINDEX
      5162>>ASSIGN   5168<<ASSIGN   5168>>ASSIGN
TH_HEAD.CP_INDX
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:265  
      3686**DCL      4979<<ASSIGN   4979>>ASSIGN   5010<<ASSIGN   5010>>ASSIGN   5044<<ASSIGN   5044>>ASSIGN
      5077<<ASSIGN   5077>>ASSIGN   5109<<ASSIGN   5109>>ASSIGN   5140<<ASSIGN   5140>>ASSIGN   5171<<ASSIGN
      5171>>ASSIGN   5199<<ASSIGN   5199>>ASSIGN   5219>>DOINDEX  5220>>ASSIGN   5226<<ASSIGN   5226>>ASSIGN
      5239>>DOINDEX  5239>>DOINDEX  5251>>ASSIGN
TH_HEAD.CR_INDX
      3684**DCL      4978<<ASSIGN   4978>>ASSIGN   5009<<ASSIGN   5009>>ASSIGN   5043<<ASSIGN   5043>>ASSIGN
      5076<<ASSIGN   5076>>ASSIGN   5108<<ASSIGN   5108>>ASSIGN   5139<<ASSIGN   5139>>ASSIGN   5170<<ASSIGN
      5170>>ASSIGN   5191>>DOINDEX  5192>>ASSIGN   5198<<ASSIGN   5198>>ASSIGN   5212>>DOINDEX  5212>>DOINDEX
      5224>>ASSIGN
TH_HEAD.DEVNAME
      3698**DCL      4957>>IF       4965<<ASSIGN   4965>>ASSIGN   4968<<ASSIGN   4992>>IF       4997<<ASSIGN
      4997>>ASSIGN   4999<<ASSIGN   5024>>IF       5032<<ASSIGN   5032>>ASSIGN   5035<<ASSIGN   5058>>IF
      5066<<ASSIGN   5066>>ASSIGN   5069<<ASSIGN   5091>>IF       5099<<ASSIGN   5099>>ASSIGN   5102<<ASSIGN
      5123>>IF       5131<<ASSIGN   5131>>ASSIGN   5134<<ASSIGN   5155>>IF       5163<<ASSIGN   5163>>ASSIGN
      5166<<ASSIGN   5185>>IF       5193<<ASSIGN   5193>>ASSIGN   5196<<ASSIGN   5213>>IF       5221<<ASSIGN
      5221>>ASSIGN   5224<<ASSIGN   5240>>IF       5248<<ASSIGN   5248>>ASSIGN   5251<<ASSIGN   5266>>IF
      5274<<ASSIGN   5274>>ASSIGN   5277<<ASSIGN   5291>>IF       5299<<ASSIGN   5299>>ASSIGN   5302<<ASSIGN
      5315>>IF       5323<<ASSIGN   5323>>ASSIGN   5326<<ASSIGN   5338>>IF       5346<<ASSIGN   5346>>ASSIGN
      5349<<ASSIGN   5361>>IF       5368<<ASSIGN   5383>>IF       5392>>ASSIGN   5394>>ASSIGN
TH_HEAD.DISKMPC_INDX
      3672**DCL      4973<<ASSIGN   4973>>ASSIGN   5004<<ASSIGN   5004>>ASSIGN   5038<<ASSIGN   5038>>ASSIGN
      5064>>DOINDEX  5065>>ASSIGN   5071<<ASSIGN   5071>>ASSIGN   5090>>DOINDEX  5090>>DOINDEX  5102>>ASSIGN
TH_HEAD.DP_INDX
      3688**DCL      4980<<ASSIGN   4980>>ASSIGN   5011<<ASSIGN   5011>>ASSIGN   5045<<ASSIGN   5045>>ASSIGN
      5078<<ASSIGN   5078>>ASSIGN   5110<<ASSIGN   5110>>ASSIGN   5141<<ASSIGN   5141>>ASSIGN   5172<<ASSIGN
      5172>>ASSIGN   5200<<ASSIGN   5200>>ASSIGN   5227<<ASSIGN   5227>>ASSIGN   5246>>DOINDEX  5247>>ASSIGN
      5253<<ASSIGN   5253>>ASSIGN   5265>>DOINDEX  5265>>DOINDEX  5277>>ASSIGN
TH_HEAD.FEP_INDX
      3678**DCL      4963>>DOINDEX  4964>>ASSIGN   4970<<ASSIGN   4970>>ASSIGN   4991>>DOINDEX  4991>>DOINDEX
      4999>>ASSIGN
TH_HEAD.IOM_INDX
      3666**DCL      4956>>DOINDEX  4956>>DOINDEX  4968>>ASSIGN
TH_HEAD.LP_INDX
      3682**DCL      4977<<ASSIGN   4977>>ASSIGN   5008<<ASSIGN   5008>>ASSIGN   5042<<ASSIGN   5042>>ASSIGN
      5075<<ASSIGN   5075>>ASSIGN   5107<<ASSIGN   5107>>ASSIGN   5138<<ASSIGN   5138>>ASSIGN   5169<<ASSIGN
      5169>>ASSIGN   5184>>DOINDEX  5184>>DOINDEX  5196>>ASSIGN
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:266  
TH_HEAD.MT_INDX
      3690**DCL      4981<<ASSIGN   4981>>ASSIGN   5012<<ASSIGN   5012>>ASSIGN   5046<<ASSIGN   5046>>ASSIGN
      5079<<ASSIGN   5079>>ASSIGN   5111<<ASSIGN   5111>>ASSIGN   5142<<ASSIGN   5142>>ASSIGN   5173<<ASSIGN
      5173>>ASSIGN   5201<<ASSIGN   5201>>ASSIGN   5228<<ASSIGN   5228>>ASSIGN   5254<<ASSIGN   5254>>ASSIGN
      5272>>DOINDEX  5273>>ASSIGN   5279<<ASSIGN   5279>>ASSIGN   5290>>DOINDEX  5290>>DOINDEX  5302>>ASSIGN
TH_HEAD.NUMAPMPCS
      3675**DCL      5122>>DOINDEX  5133<<ASSIGN   5133>>ASSIGN   5134>>ASSIGN
TH_HEAD.NUMAPS
      3695**DCL      5337>>DOINDEX  5348<<ASSIGN   5348>>ASSIGN   5349>>ASSIGN
TH_HEAD.NUMCPS
      3687**DCL      5239>>DOINDEX  5250<<ASSIGN   5250>>ASSIGN   5251>>ASSIGN
TH_HEAD.NUMCRS
      3685**DCL      5212>>DOINDEX  5223<<ASSIGN   5223>>ASSIGN   5224>>ASSIGN
TH_HEAD.NUMDISKMPCS
      3673**DCL      5090>>DOINDEX  5101<<ASSIGN   5101>>ASSIGN   5102>>ASSIGN
TH_HEAD.NUMDPS
      3689**DCL      5265>>DOINDEX  5276<<ASSIGN   5276>>ASSIGN   5277>>ASSIGN
TH_HEAD.NUMFEPS
      3679**DCL      4991>>DOINDEX  4999>>ASSIGN   5000<<ASSIGN   5000>>ASSIGN
TH_HEAD.NUMIOMS
      3667**DCL      4956>>DOINDEX  4967<<ASSIGN   4967>>ASSIGN   4968>>ASSIGN
TH_HEAD.NUMLPS
      3683**DCL      5184>>DOINDEX  5195<<ASSIGN   5195>>ASSIGN   5196>>ASSIGN
TH_HEAD.NUMMTS
      3691**DCL      5290>>DOINDEX  5301<<ASSIGN   5301>>ASSIGN   5302>>ASSIGN
TH_HEAD.NUMODS
      3697**DCL      4947>>ASSIGN   5360>>DOINDEX  5367<<ASSIGN   5367>>ASSIGN   5368>>ASSIGN
TH_HEAD.NUMOPCS
      3677**DCL      5154>>DOINDEX  5165<<ASSIGN   5165>>ASSIGN   5166>>ASSIGN
TH_HEAD.NUMTAPEMPCS
      3671**DCL      5057>>DOINDEX  5068<<ASSIGN   5068>>ASSIGN   5069>>ASSIGN
TH_HEAD.NUMUNITMPCS
      3669**DCL      5023>>DOINDEX  5034<<ASSIGN   5034>>ASSIGN   5035>>ASSIGN
TH_HEAD.NUMXXS
      3693**DCL      5314>>DOINDEX  5325<<ASSIGN   5325>>ASSIGN   5326>>ASSIGN
TH_HEAD.OD_INDX
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:267  
      3696**DCL      4947>>ASSIGN   4984<<ASSIGN   4984>>ASSIGN   5015<<ASSIGN   5015>>ASSIGN   5049<<ASSIGN
      5049>>ASSIGN   5082<<ASSIGN   5082>>ASSIGN   5114<<ASSIGN   5114>>ASSIGN   5145<<ASSIGN   5145>>ASSIGN
      5176<<ASSIGN   5176>>ASSIGN   5204<<ASSIGN   5204>>ASSIGN   5231<<ASSIGN   5231>>ASSIGN   5257<<ASSIGN
      5257>>ASSIGN   5282<<ASSIGN   5282>>ASSIGN   5306<<ASSIGN   5306>>ASSIGN   5329<<ASSIGN   5329>>ASSIGN
      5344>>DOINDEX  5345>>ASSIGN   5351<<ASSIGN   5351>>ASSIGN   5360>>DOINDEX  5360>>DOINDEX  5368>>ASSIGN
TH_HEAD.OPC_INDX
      3676**DCL      4975<<ASSIGN   4975>>ASSIGN   5006<<ASSIGN   5006>>ASSIGN   5040<<ASSIGN   5040>>ASSIGN
      5073<<ASSIGN   5073>>ASSIGN   5105<<ASSIGN   5105>>ASSIGN   5129>>DOINDEX  5130>>ASSIGN   5136<<ASSIGN
      5136>>ASSIGN   5154>>DOINDEX  5154>>DOINDEX  5166>>ASSIGN
TH_HEAD.TAPEMPC_INDX
      3670**DCL      4972<<ASSIGN   4972>>ASSIGN   5003<<ASSIGN   5003>>ASSIGN   5030>>DOINDEX  5031>>ASSIGN
      5037<<ASSIGN   5037>>ASSIGN   5057>>DOINDEX  5057>>DOINDEX  5069>>ASSIGN
TH_HEAD.UNITMPC_INDX
      3668**DCL      4971<<ASSIGN   4971>>ASSIGN   4996>>DOINDEX  5002<<ASSIGN   5002>>ASSIGN   5023>>DOINDEX
      5023>>DOINDEX  5035>>ASSIGN
TH_HEAD.XX_INDX
      3692**DCL      4982<<ASSIGN   4982>>ASSIGN   5013<<ASSIGN   5013>>ASSIGN   5047<<ASSIGN   5047>>ASSIGN
      5080<<ASSIGN   5080>>ASSIGN   5112<<ASSIGN   5112>>ASSIGN   5143<<ASSIGN   5143>>ASSIGN   5174<<ASSIGN
      5174>>ASSIGN   5202<<ASSIGN   5202>>ASSIGN   5229<<ASSIGN   5229>>ASSIGN   5255<<ASSIGN   5255>>ASSIGN
      5280<<ASSIGN   5280>>ASSIGN   5297>>DOINDEX  5298>>ASSIGN   5304<<ASSIGN   5304>>ASSIGN   5314>>DOINDEX
      5314>>DOINDEX  5326>>ASSIGN
TH_INFO.PTR$
      2868**DCL      3887--IMP-PTR  3897--IMP-PTR  3906--IMP-PTR  3985--IMP-PTR  3995--IMP-PTR  3999--IMP-PTR
      5465>>IF       5466>>ASSIGN   5468>>ASSIGN   5469>>IF       5474>>ASSIGN   5476>>IF       5496>>IF
      5501>>ASSIGN   5504>>IF       5507>>IF       5512>>ASSIGN   5515>>ASSIGN
TH_IOM
      3829**DCL      5540<<ASSIGN   5542--ASSIGN
TH_ITYPE
      2869**DCL      5463>>DOCASE
TH_M$ERRLOG$
      2877**DCL      4888<<ASSIGN
TH_MAINT
      3797**DCL      5380<<ASSIGN   5386>>ASSIGN   5404--ASSIGN
TH_MAINT.DEVNAME
      3798**DCL      5383>>IF
TH_MAXDCTX
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:268  
      2873**DCL      5485>>DOINDEX
TH_MPC
      3808**DCL      5561<<ASSIGN   5563--ASSIGN
TH_MPC.NUMDEVS
      3818**DCL      5564>>ASSIGN
TH_PHONY_GHOST
      2863**DCL      4949>>IF
TH_REBUILD
      2864**DCL      4898<<ASSIGN   4916<<ASSIGN   4927<<ASSIGN   4931<<ASSIGN   5585>>IF       5617<<ASSIGN
TH_RECORD.PTR$
      2867**DCL      4908>>ASSIGN   4910>>ASSIGN   4915>>ASSIGN   4937>>ASSIGN   5378>>ASSIGN   5380>>ASSIGN
      5419>>ASSIGN
TH_SAVE.E_BY_B
      2858**DCL      2858--REDEF
TH_SAVE.M_BY_B
      2856**DCL      2856--REDEF
TH_SAVE.TYPES
      2854**DCL      2855--REDEF
TH_THRESH
      3780**DCL      5378<<ASSIGN   5387>>ASSIGN   5409--ASSIGN
TH_UTS
      3875**DCL      4910<<ASSIGN   5419<<ASSIGN   5580--ASSIGN
TH_UTS.ERRLOG_UTS
      3877**DCL      5420>>ASSIGN   5579<<ASSIGN
TH_UTS.OLDEST_UTS
      3876**DCL      4923<>CALL
TH_XSA_BUF_VECTOR
      2874**DCL      2874--REDEF
TWO
      3443**DCL      5379<>CALL
UTS
      3515**DCL      5447<<ASSIGN   5448>>DOWHILE  5449>>IF       5451>>ASSIGN   5452>>IF       5454<>CALL
      5535>>ASSIGN   5575<>CALL     5575<>CALL
UTS_KEY
      3526**DCL      5578--ASSIGN
VEHLIST
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:269  
      4848**DCL      4370--DCLINIT
VEHLIST.Q
      4849**DCL      4848--DCLINIT
WRITE_DEVHIST
      4231**DCL      5405<>CALL     5410<>CALL     5533<>CALL     5543<>CALL     5548<>CALL     5556<>CALL
      5565<>CALL     5573<>CALL     5581<>CALL
WRITE_DEVHIST.BUF_
      4231**DCL      5402<<ASSIGN   5408<<ASSIGN   5531<<ASSIGN   5542<<ASSIGN   5547<<ASSIGN   5555<<ASSIGN
      5563<<ASSIGN   5572<<ASSIGN   5580<<ASSIGN
WRITE_DEVHIST.BUF_.BOUND
      4231**DCL      5404<<ASSIGN   5409<<ASSIGN   5532<<ASSIGN   5564<<ASSIGN
WRITE_DEVHIST.KEY_
      4231**DCL      5403<<ASSIGN   5407<<ASSIGN   5530<<ASSIGN   5536<<ASSIGN   5578<<ASSIGN
WRITE_DEVHIST.STATION_
      4233**DCL      4233--REDEF
WRITE_DEVHIST.V
      4234**DCL      4231--DCLINIT
WRITE_DEVHIST.V.DVBYTE.VFC#
      4240**DCL      4240--REDEF
WRITE_NEWDEV
      4475**DCL      5596<>CALL     5603<>CALL     5611<>CALL
WRITE_NEWDEV.BUF_.BOUND
      4475**DCL      5595<<ASSIGN   5600<<ASSIGN   5610<<ASSIGN
WRITE_NEWDEV.KEY_
      4475**DCL      5594<<ASSIGN   5599<<ASSIGN   5609<<ASSIGN
WRITE_NEWDEV.STATION_
      4477**DCL      4477--REDEF
WRITE_NEWDEV.V
      4478**DCL      4475--DCLINIT
WRITE_NEWDEV.V.DVBYTE.VFC#
      4484**DCL      4484--REDEF
XUD$UTS_ADJ_25TH
      4060**DCL-ENT  4923--CALL     5425--CALL     5429--CALL     5435--CALL     5436--CALL     5454--CALL
      5575--CALL     5590--CALL
XUD$UTS_DIFF_SEC
      4042**DCL-ENT  5423--CALL     5427--CALL     5433--CALL
PL6.E3A0      #003=THE$PROCESS File=THE$ELAN.:E05TSI                             WED 07/30/97 06:09 Page:270  
ZERO
      3441**DCL      4890<>CALL     4936<>CALL

PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:271  
     1445        1        /*M* THE$INIT - ROUTINE TO BUILD AND INITIALIZE TABLES FOR ELAN ERRLOG PROCESSOR */
     1446        2        /*T***********************************************************/
     1447        3        /*T*                                                         */
     1448        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1449        5        /*T*                                                         */
     1450        6        /*T***********************************************************/
     1451        7        THE$INIT: PROC(TD_HEAD) ALTRET;
     1452        8        /**/
     1453        9        /* INCLUDE FILES */
     1454       10        %INCLUDE CP_6;
     1455       91        %INCLUDE TD$STRUCT;
     1456      192        %INCLUDE TH$HIST;
     1457      287        %INCLUDE TH_DATA_R;
     1458      365        %INCLUDE TH_SUBS_C;
     1459      747        %INCLUDE IT_SUBS_C;
     1460     1014        %INCLUDE NI$TABLES ;
     1461     1230        /**/
     1462     1231        /* PARAMETERS */
     1463     1232        %TD$HEAD (NAME=TD_HEAD,STCLASS="");
     1464     1268        /**/
     1465     1269        /* ENTRY DEFS */
     1466     1270    1   DCL THG$GETREC ENTRY(4) ALTRET;
     1467     1271        /**/
     1468     1272        /* DCBS */
     1469     1273        /**/
     1470     1274        /* VARS */
     1471     1275    1   DCL IOM_TBL$ PTR STATIC SYMDEF;
     1472     1276    1   DCL MPC_TBL$ PTR STATIC SYMDEF;
     1473     1277    1   DCL FEP_TBL$ PTR STATIC SYMDEF;
     1474     1278    1   DCL DEV_TBL$ PTR STATIC SYMDEF;
     1475     1279        /**/
     1476     1280    1   DCL NUM_IOMS UBIN WORD SYMREF;
     1477     1281    1   DCL NUM_MPCS UBIN WORD SYMREF;
     1478     1282    1   DCL NUM_FEPS UBIN WORD SYMREF;
     1479     1283    1   DCL NUM_DEVS UBIN WORD SYMREF;
     1480     1284        /**/
     1481     1285    1   DCL 1 TABLESEG STATIC DALIGNED,
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:272  
     1482     1286    1         2 BOUND UBIN(20) UNAL,
     1483     1287    1         2 * BIT(16),
     1484     1288    1         2 PTR$ PTR INIT(ADDR(NIL));
     1485     1289    1   DCL 1 TBL STATIC ALIGNED,
     1486     1290    1         2 DEVNAME CHAR(8),
     1487     1291    1         2 PTR$ PTR;
     1488     1292        /**/
     1489     1293    1   DCL I UBIN WORD;
     1490     1294    1   DCL J UBIN WORD;
     1491     1295    1   DCL K UBIN WORD;
     1492     1296    1   DCL L UBIN WORD;
     1493     1297    1   DCL IOM# CHAR(1);
     1494     1298    1   DCL IOM_NAME CHAR(8);
     1495     1299    1   DCL TABLE$ PTR;
     1496     1300    1   DCL UTS UBIN WORD SYMREF;
     1497     1301    1   DCL FEP# CHAR(3) UNAL;
     1498     1302    1   DCL FEP#1(0:2) REDEF FEP# CHAR(1);
     1499     1303    1   DCL FEP_NAME CHAR(6);
     1500     1304        /**/
     1501     1305        /* MACRO DEFINITIONS */
     1502     1306        %MACRO TBL (NAME=JUNK,STCLASS=BASED);
     1503     1307        DCL 1 NAME(0:0) STCLASS ALIGNED,
     1504     1308              2 DEVNAME CHAR(8),
     1505     1309              2 PTR$ PTR;
     1506     1310        %MEND;
     1507     1311        /**/
     1508     1312        /* MACRO INVOCATIONS */
     1509     1313        %TH$IOM (NAME=IOM);
     1510     1324        %TH$MPC (NAME=MPC,NUMDEV#=32);
     1511     1345        %TH$FEP (NAME=FEP);
     1512     1352        %TH$DEV (NAME=DEV);
     1513     1373        %TH$CHAN (NAME=CHAN);
     1514     1380        /**/
     1515     1381        %TH$MPC (NAME=TH$MPC,STCLASS="BASED(TH_RECORD.PTR$)",NUMDEV#=32);
     1516     1402        %TH$DEV (NAME=TH$DEV,STCLASS="BASED(TH_RECORD.PTR$)");
     1517     1423        %TH$IOM (NAME=TH$IOM,STCLASS="BASED(TH_RECORD.PTR$)");
     1518     1434        %TH$FEP (NAME=TH$FEP,STCLASS="BASED(TH_RECORD.PTR$)");
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:273  
     1519     1441        %TBL (NAME=IOM_TBL,STCLASS="BASED(IOM_TBL$)");
     1520     1446        %TBL (NAME=MPC_TBL,STCLASS="BASED(MPC_TBL$)");
     1521     1451        %TBL (NAME=FEP_TBL,STCLASS="BASED(FEP_TBL$)");
     1522     1456        %TBL (NAME=DEV_TBL,STCLASS="BASED(DEV_TBL$)");
     1523     1461        /**/
     1524     1462        %TD$MPC (NAME=TD$MPC,STCLASS="BASED(TH_RECORD.PTR$)",NUMDEV#=32);
     1525     1484        %TD$IOM (NAME=TD$IOM,STCLASS="BASED(TH_RECORD.PTR$)");
     1526     1492        %TD$DEV (NAME=TD$DEV,STCLASS="BASED(TH_RECORD.PTR$)");
     1527     1511        /**/
     1528     1512        /* FPT DEFINITIONS */
     1529     1513        %FPT_GDS (FPTN=FPT_GDS,
     1530     1514                  STCLASS=CONSTANT,
     1531     1515                  RESULTS=TABLESEG,
     1532     1516                  SEGSIZE=1024);
     1533     1532        /**/
     1534     1533        %EJECT;
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:274  
     1535     1534                                                /* GET FIRST DATA SEGMENT             */
     1536     1535    1           IF TABLESEG.PTR$ = ADDR(NIL)
     1537     1536    1           THEN CALL M$GDS(FPT_GDS) ALTRET(NO_MEM);
     1538     1537    1           TABLE$ = TABLESEG.PTR$;
     1539     1538
     1540     1539                                                /* BUILD IOM TABLE                    */
     1541     1540    1           CALL GETBLK(IOM_TBL$,SIZEW(TBL)*NUM_IOMS) ALTRET(NO_MEM);
     1542     1541    2           DO I = 0 TO NUM_IOMS - 1;
     1543     1542    2              CALL BINCHAR(IOM#,I);
     1544     1543    2              CALL CONCAT(IOM_NAME,'IOM',IOM#,'    ');
     1545     1544    2              IOM_TBL.DEVNAME(I) = IOM_NAME;
     1546     1545    2              CALL GETBLK(IOM_TBL.PTR$(I),SIZEW(IOM)) ALTRET(NO_MEM);
     1547     1546    2              IOM_TBL.PTR$(I)->IOM = '0'B;
     1548     1547    2              CALL THG$GETREC(%DEVHIST,IOM_NAME,UTS) ALTRET(L1);
     1549     1548    2              IOM_TBL.PTR$(I)->IOM = TH$IOM;
     1550     1549    3              DO NEVER;
     1551     1550    3        L1:      CALL THG$GETREC(%CONFIG,IOM_NAME);
     1552     1551    3                 IOM_TBL.PTR$(I)->IOM = TD$IOM;
     1553     1552    3              END;                         /* DO NEVER                           */
     1554     1553    2              CALL GETBLK(IOM_TBL.PTR$(I)->IOM.CHAN$,SIZEW(CHAN)) ALTRET(NO_MEM);
     1555     1554    2              IOM_TBL.PTR$(I)->IOM.CHAN$->CHAN = '0'B;
     1556     1555    2              IOM_TBL.PTR$(I)->IOM.CHAN$->CHAN.IOM_NAME = IOM_NAME;
     1557     1556    2           END;                            /* DO I                               */
     1558     1557
     1559     1558                                                /* BUILD MPC TABLE                    */
     1560     1559    1           CALL GETBLK(MPC_TBL$,SIZEW(TBL)*NUM_MPCS) ALTRET(NO_MEM);
     1561     1560    1           J = 0;
     1562     1561    2           DO I = TD_HEAD.UNITMPC_INDX TO TD_HEAD.UNITMPC_INDX + NUM_MPCS - 1;
     1563     1562    2              MPC_TBL.DEVNAME(J) = TD_HEAD.DEVNAME(I);
     1564     1563    2              CALL THG$GETREC(%DEVHIST,TD_HEAD.DEVNAME(I),UTS) ALTRET(L2);
     1565     1564    2              CALL GETBLK(MPC_TBL.PTR$(J),SIZEW(MPC)+(2*TH$MPC.NUMDEVS-1)) ALTRET(
              1564                       NO_MEM);
     1566     1565    2              MPC_TBL.PTR$(J)->MPC = TH$MPC;
     1567     1566    3              DO NEVER;
     1568     1567    3         L2:     CALL THG$GETREC(%CONFIG,TD_HEAD.DEVNAME(I));
     1569     1568    3                 CALL GETBLK(MPC_TBL.PTR$(J),SIZEW(MPC)+(2*TD$MPC.NUMDEVS-1)) ALTRET(
              1568                          NO_MEM);
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:275  
     1570     1569    3                 MPC_TBL.PTR$(J)->MPC = '0'B;
     1571     1570    3                 MPC_TBL.PTR$(J)->MPC.MODEL = TD$MPC.MODEL;
     1572     1571    3                 MPC_TBL.PTR$(J)->MPC.IOCHAN = TD$MPC.IOCHAN;
     1573     1572    3                 MPC_TBL.PTR$(J)->MPC.NUMDEVS = TD$MPC.NUMDEVS;
     1574     1573    3                 MPC_TBL.PTR$(J)->MPC.FLAGS = TD$MPC.FLAGS;
     1575     1574    3                 MPC_TBL.PTR$(J)->MPC.FWNAME = TD$MPC.FWNAME;
     1576     1575    3                 MPC_TBL.PTR$(J)->MPC.LPFWNAME = TD$MPC.LPFWNAME;
     1577     1576    3                 MPC_TBL.PTR$(J)->MPC.CRPFWNAME = TD$MPC.CRPFWNAME;
     1578     1577    4                 DO K = 0 TO TD$MPC.NUMDEVS - 1;
     1579     1578    4                    MPC_TBL.PTR$(J)->MPC.DEVNAME(K) = TD$MPC.DEVNAME(K);
     1580     1579    4                 END;                      /* DO K                               */
     1581     1580    3                 MPC_TBL.PTR$(J)->MPC.COUNT = 0;
     1582     1581    3                 MPC_TBL.PTR$(J)->MPC.CONNECTS = 0;
     1583     1582    3              END;                         /* DO NEVER                           */
     1584     1583    2              J = J + 1;
     1585     1584    2           END;                            /* DO I                               */
     1586     1585
     1587     1586                                                /* BUILD FEP TABLE                    */
     1588     1587    1           CALL GETBLK(FEP_TBL$,SIZEW(TBL)* %FEP_MAX) ALTRET(NO_MEM);
     1589     1588    1           J = 0;
     1590     1589    2           DO I = 1 TO %FEP_MAX;
     1591     1590    2              FEP# = ' ';
     1592     1591    2              CALL BINCHAR (FEP#,I);
     1593     1592    2              IF(FEP#1(0) = '0' AND FEP#1(1) = '0')
     1594     1593    2                 THEN CALL CONCAT(FEP_NAME,'FEP',FEP#1(2));
     1595     1594    2                 ELSE IF FEP#1(0) = '0'
     1596     1595    2                 THEN CALL CONCAT(FEP_NAME,'FEP',FEP#1(1),FEP#1(2));
     1597     1596    2                 ELSE CALL CONCAT(FEP_NAME,'FEP',FEP#);
     1598     1597    2              FEP_TBL.DEVNAME(J) = FEP_NAME;
     1599     1598    2              CALL GETBLK(FEP_TBL.PTR$(J),SIZEW(FEP)) ALTRET(NO_MEM);
     1600     1599    2              FEP_TBL.PTR$(J)->FEP = '0'B;
     1601     1600    2              CALL THG$GETREC(%DEVHIST,FEP_NAME,UTS) ALTRET(L3);
     1602     1601    2              FEP_TBL.PTR$(J)->FEP = TH$FEP;
     1603     1602    3              DO NEVER;
     1604     1603
     1605     1604    3      L3:         /* FIND CHANNEL THAT THIS FEP IS ON AND STUFF INTO FEP RECORD  */
     1606     1605    4                 DO K = 0 TO NUM_IOMS - 1;
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:276  
     1607     1606    5                    DO L = 0 TO %N_MAXCHANS-1;
     1608     1607    6                       IF IOM_TBL.PTR$(K)->IOM.DEVNAME(L) = FEP_TBL.DEVNAME(J) THEN DO;
     1609     1608    6                          FEP_TBL.PTR$(J)->FEP.CHANNEL = L;
     1610     1609    6                          FEP_TBL.PTR$(J)->FEP.IOM = K;
     1611     1610    6                          END;  /* IF */
     1612     1611    5                    END;                   /* DO L                               */
     1613     1612    4                 END;                      /* DO K                               */
     1614     1613    3              END;                         /* DO NEVER                           */
     1615     1614    2              J = J + 1;
     1616     1615    2           END;                            /* DO I                               */
     1617     1616
     1618     1617                                                /* BUILD DEVICE TABLE                 */
     1619     1618    1           CALL GETBLK(DEV_TBL$,SIZEW(TBL)*NUM_DEVS) ALTRET(NO_MEM);
     1620     1619    1           J = 0;
     1621     1620    2           DO I = TD_HEAD.LP_INDX TO TD_HEAD.LP_INDX + NUM_DEVS - 1;
     1622     1621    2              DEV_TBL.DEVNAME(J) = TD_HEAD.DEVNAME(I);
     1623     1622    2              CALL GETBLK(DEV_TBL.PTR$(J),SIZEW(DEV)) ALTRET(NO_MEM);
     1624     1623    2              DEV_TBL.PTR$(J)->DEV = '0'B;
     1625     1624    2              CALL THG$GETREC(%DEVHIST,TD_HEAD.DEVNAME(I),UTS) ALTRET(L4);
     1626     1625    2              DEV_TBL.PTR$(J)->DEV = TH$DEV;
     1627     1626    3              DO NEVER;
     1628     1627    3        L4:      CALL THG$GETREC(%CONFIG,TD_HEAD.DEVNAME(I));
     1629     1628    3                 DEV_TBL.PTR$(J)->DEV = TD$DEV;
     1630     1629    3              END;                         /* DO NEVER                           */
     1631     1630    2              J = J + 1;
     1632     1631    2           END;                            /* DO I                               */
     1633     1632    1           RETURN;
     1634     1633    1   NO_MEM: ;
     1635     1634    1           ALTRETURN;
     1636     1635        %EJECT;
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:277  
     1637     1636    1   GETBLK: PROC(PTR$,SIZE) ALTRET;
     1638     1637        /**/
     1639     1638    2   DCL PTR$ PTR;
     1640     1639    2   DCL SIZE SBIN;
     1641     1640        /**/
     1642     1641    3        DO WHILE(SIZE > ((TABLESEG.BOUND+1)/4) - POFFW(TABLE$,TABLESEG.PTR$));
     1643     1642    3           CALL M$GDS(FPT_GDS) ALTRET(GDS_ERR);
     1644     1643    3        END;                               /* DO WHILE                           */
     1645     1644    2        PTR$ = TABLE$;
     1646     1645    2        TABLE$ = PINCRW(TABLE$,SIZE);
     1647     1646    2        RETURN;
     1648     1647    2   GDS_ERR: ;
     1649     1648    2        ALTRETURN;
     1650     1649    2   END GETBLK;
     1651     1650    1   END THE$INIT;
     1652     1651        %EOD;

PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:278  
--  Include file information  --

   NI$TABLES.:E05TOU  is referenced.
   IT_SUBS_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   TH$HIST.:E05TOU  is referenced.
   TD$STRUCT.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THE$INIT.

   Procedure THE$INIT requires 566 words for executable code.
   Procedure THE$INIT requires 28 words of local(AUTO) storage.

PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:279  

 Object Unit name= THE$INIT                                   File name= THE$ELAN.:E05TOU
 UTS= JUL 30 '97 06:11:54.44 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none     9     11  THE$INIT
    2  RoData even  UTS      9     11  THE$INIT
    3   Proc  even  none   566   1066  THE$INIT
    4  RoData even  none    19     23  THE$INIT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        1  THE$INIT

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1      0  IOM_TBL$                           1      1  MPC_TBL$
    1      2  FEP_TBL$                           1      3  DEV_TBL$

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       4 THG$GETREC
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:280  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TH_RECORD                             TH_XSA_BUF_VECTOR
     NUM_IOMS                              NUM_MPCS                              NUM_DEVS
     UTS                                   B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:281  


     1445        1        /*M* THE$INIT - ROUTINE TO BUILD AND INITIALIZE TABLES FOR ELAN ERRLOG PROCESSOR */
     1446        2        /*T***********************************************************/
     1447        3        /*T*                                                         */
     1448        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1449        5        /*T*                                                         */
     1450        6        /*T***********************************************************/
     1451        7        THE$INIT: PROC(TD_HEAD) ALTRET;

      7  3 000000   000000 700200 xent  THE$INIT     TSX0  ! X66_AUTO_1
         3 000001   000034 000001                    ZERO    28,1

     1452        8        /**/
     1453        9        /* INCLUDE FILES */
     1454       10        %INCLUDE CP_6;
     1455       91        %INCLUDE TD$STRUCT;
     1456      192        %INCLUDE TH$HIST;
     1457      287        %INCLUDE TH_DATA_R;
     1458      365        %INCLUDE TH_SUBS_C;
     1459      747        %INCLUDE IT_SUBS_C;
     1460     1014        %INCLUDE NI$TABLES ;
     1461     1230        /**/
     1462     1231        /* PARAMETERS */
     1463     1232        %TD$HEAD (NAME=TD_HEAD,STCLASS="");
     1464     1268        /**/
     1465     1269        /* ENTRY DEFS */
     1466     1270    1   DCL THG$GETREC ENTRY(4) ALTRET;
     1467     1271        /**/
     1468     1272        /* DCBS */
     1469     1273        /**/
     1470     1274        /* VARS */
     1471     1275    1   DCL IOM_TBL$ PTR STATIC SYMDEF;
     1472     1276    1   DCL MPC_TBL$ PTR STATIC SYMDEF;
     1473     1277    1   DCL FEP_TBL$ PTR STATIC SYMDEF;
     1474     1278    1   DCL DEV_TBL$ PTR STATIC SYMDEF;
     1475     1279        /**/
     1476     1280    1   DCL NUM_IOMS UBIN WORD SYMREF;
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:282  
     1477     1281    1   DCL NUM_MPCS UBIN WORD SYMREF;
     1478     1282    1   DCL NUM_FEPS UBIN WORD SYMREF;
     1479     1283    1   DCL NUM_DEVS UBIN WORD SYMREF;
     1480     1284        /**/
     1481     1285    1   DCL 1 TABLESEG STATIC DALIGNED,
     1482     1286    1         2 BOUND UBIN(20) UNAL,
     1483     1287    1         2 * BIT(16),
     1484     1288    1         2 PTR$ PTR INIT(ADDR(NIL));
     1485     1289    1   DCL 1 TBL STATIC ALIGNED,
     1486     1290    1         2 DEVNAME CHAR(8),
     1487     1291    1         2 PTR$ PTR;
     1488     1292        /**/
     1489     1293    1   DCL I UBIN WORD;
     1490     1294    1   DCL J UBIN WORD;
     1491     1295    1   DCL K UBIN WORD;
     1492     1296    1   DCL L UBIN WORD;
     1493     1297    1   DCL IOM# CHAR(1);
     1494     1298    1   DCL IOM_NAME CHAR(8);
     1495     1299    1   DCL TABLE$ PTR;
     1496     1300    1   DCL UTS UBIN WORD SYMREF;
     1497     1301    1   DCL FEP# CHAR(3) UNAL;
     1498     1302    1   DCL FEP#1(0:2) REDEF FEP# CHAR(1);
     1499     1303    1   DCL FEP_NAME CHAR(6);
     1500     1304        /**/
     1501     1305        /* MACRO DEFINITIONS */
     1502     1306        %MACRO TBL (NAME=JUNK,STCLASS=BASED);
     1503     1307        DCL 1 NAME(0:0) STCLASS ALIGNED,
     1504     1308              2 DEVNAME CHAR(8),
     1505     1309              2 PTR$ PTR;
     1506     1310        %MEND;
     1507     1311        /**/
     1508     1312        /* MACRO INVOCATIONS */
     1509     1313        %TH$IOM (NAME=IOM);
     1510     1324        %TH$MPC (NAME=MPC,NUMDEV#=32);
     1511     1345        %TH$FEP (NAME=FEP);
     1512     1352        %TH$DEV (NAME=DEV);
     1513     1373        %TH$CHAN (NAME=CHAN);
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:283  
     1514     1380        /**/
     1515     1381        %TH$MPC (NAME=TH$MPC,STCLASS="BASED(TH_RECORD.PTR$)",NUMDEV#=32);
     1516     1402        %TH$DEV (NAME=TH$DEV,STCLASS="BASED(TH_RECORD.PTR$)");
     1517     1423        %TH$IOM (NAME=TH$IOM,STCLASS="BASED(TH_RECORD.PTR$)");
     1518     1434        %TH$FEP (NAME=TH$FEP,STCLASS="BASED(TH_RECORD.PTR$)");
     1519     1441        %TBL (NAME=IOM_TBL,STCLASS="BASED(IOM_TBL$)");
     1520     1446        %TBL (NAME=MPC_TBL,STCLASS="BASED(MPC_TBL$)");
     1521     1451        %TBL (NAME=FEP_TBL,STCLASS="BASED(FEP_TBL$)");
     1522     1456        %TBL (NAME=DEV_TBL,STCLASS="BASED(DEV_TBL$)");
     1523     1461        /**/
     1524     1462        %TD$MPC (NAME=TD$MPC,STCLASS="BASED(TH_RECORD.PTR$)",NUMDEV#=32);
     1525     1484        %TD$IOM (NAME=TD$IOM,STCLASS="BASED(TH_RECORD.PTR$)");
     1526     1492        %TD$DEV (NAME=TD$DEV,STCLASS="BASED(TH_RECORD.PTR$)");
     1527     1511        /**/
     1528     1512        /* FPT DEFINITIONS */
     1529     1513        %FPT_GDS (FPTN=FPT_GDS,
     1530     1514                  STCLASS=CONSTANT,
     1531     1515                  RESULTS=TABLESEG,
     1532     1516                  SEGSIZE=1024);
     1533     1532        /**/
     1534     1533        %EJECT;
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:284  
     1535     1534                                                /* GET FIRST DATA SEGMENT             */
     1536     1535    1           IF TABLESEG.PTR$ = ADDR(NIL)

   1535  3 000002   000005 236000 1                  LDQ     TABLESEG+1
         3 000003   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000004   000011 601000 3                  TNZ     s:1537

     1537     1536    1           THEN CALL M$GDS(FPT_GDS) ALTRET(NO_MEM);

   1536  3 000005   000000 630400 2                  EPPR0   FPT_GDS
         3 000006   430001 713400                    CLIMB   alt,gds
         3 000007   400400 401760                    pmme    nvectors=2
         3 000010   001023 702000 3                  TSX2    NO_MEM

     1538     1537    1           TABLE$ = TABLESEG.PTR$;

   1537  3 000011   000005 236000 1                  LDQ     TABLESEG+1
         3 000012   200013 756100                    STQ     TABLE$,,AUTO

     1539     1538
     1540     1539                                                /* BUILD IOM TABLE                    */
     1541     1540    1           CALL GETBLK(IOM_TBL$,SIZEW(TBL)*NUM_IOMS) ALTRET(NO_MEM);

   1540  3 000013   000000 236000 xsym               LDQ     NUM_IOMS
         3 000014   000003 402007                    MPY     3,DL
         3 000015   200027 756100                    STQ     @SIZE+5,,AUTO
         3 000016   200027 630500                    EPPR0   @SIZE+5,,AUTO
         3 000017   200022 450500                    STP0    @PTR$+1,,AUTO
         3 000020   000000 236000 4                  LDQ     0
         3 000021   200021 756100                    STQ     FEP_NAME+4,,AUTO
         3 000022   001024 701000 3                  TSX1    GETBLK
         3 000023   001023 702000 3                  TSX2    NO_MEM

     1542     1541    2           DO I = 0 TO NUM_IOMS - 1;

   1541  3 000024   200004 450100                    STZ     I,,AUTO
         3 000025   000167 710000 3                  TRA     s:1556+3
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:285  

     1543     1542    2              CALL BINCHAR(IOM#,I);

   1542  3 000026   200004 235100                    LDA     I,,AUTO
         3 000027   000044 773000                    LRL     36
         3 000030   200024 757100                    STAQ    @SIZE+2,,AUTO
         3 000031   000100 301500                    BTD
         3 000032   200024 000010                    NDSC9   @SIZE+2,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         3 000033   200010 030001                    NDSC9   IOM#,,AUTO               cn=0,s=nosgn,sf=0,n=1

     1544     1543    2              CALL CONCAT(IOM_NAME,'IOM',IOM#,'    ');

   1543  3 000034   000006 236000 2                  LDQ     FPT_GDS+6
         3 000035   000001 376000 4                  ANQ     1
         3 000036   000040 276007                    ORQ     32,DL
         3 000037   200011 756100                    STQ     IOM_NAME,,AUTO
         3 000040   200010 236100                    LDQ     IOM#,,AUTO
         3 000041   000033 772000                    QRL     27
         3 000042   200011 552104                    STBQ    IOM_NAME,'04'O,AUTO
         3 000043   000007 236000 2                  LDQ     FPT_GDS+7
         3 000044   200012 756100                    STQ     IOM_NAME+1,,AUTO

     1545     1544    2              IOM_TBL.DEVNAME(I) = IOM_NAME;

   1544  3 000045   200004 236100                    LDQ     I,,AUTO
         3 000046   000003 402007                    MPY     3,DL
         3 000047   000002 736000                    QLS     2
         3 000050   000000 470400 1                  LDP0    IOM_TBL$
         3 000051   040106 100500                    MLR     fill='040'O
         3 000052   200011 000010                    ADSC9   IOM_NAME,,AUTO           cn=0,n=8
         3 000053   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=8

     1546     1545    2              CALL GETBLK(IOM_TBL.PTR$(I),SIZEW(IOM)) ALTRET(NO_MEM);

   1545  3 000054   000003 236000 4                  LDQ     3
         3 000055   200022 756100                    STQ     @PTR$+1,,AUTO
         3 000056   200004 236100                    LDQ     I,,AUTO
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:286  
         3 000057   000003 402003                    MPY     3,DU
         3 000060   000002 036003                    ADLQ    2,DU
         3 000061   000000 036000 1                  ADLQ    IOM_TBL$
         3 000062   200021 756100                    STQ     FEP_NAME+4,,AUTO
         3 000063   001024 701000 3                  TSX1    GETBLK
         3 000064   001023 702000 3                  TSX2    NO_MEM

     1547     1546    2              IOM_TBL.PTR$(I)->IOM = '0'B;

   1546  3 000065   200004 236100                    LDQ     I,,AUTO
         3 000066   000003 402007                    MPY     3,DL
         3 000067   000000 470400 1                  LDP0    IOM_TBL$
         3 000070   000002 471506                    LDP1    2,QL,PR0
         3 000071   000100 100400                    MLR     fill='000'O
         3 000072   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         3 000073   100000 002060                    ADSC9   0,,PR1                   cn=0,n=1072

     1548     1547    2              CALL THG$GETREC(%DEVHIST,IOM_NAME,UTS) ALTRET(L1);

   1547  3 000074   000004 236000 4                  LDQ     4
         3 000075   200026 756100                    STQ     @SIZE+4,,AUTO
         3 000076   200011 630500                    EPPR0   IOM_NAME,,AUTO
         3 000077   200025 450500                    STP0    @SIZE+3,,AUTO
         3 000100   000005 236000 4                  LDQ     5
         3 000101   200024 756100                    STQ     @SIZE+2,,AUTO
         3 000102   200024 630500                    EPPR0   @SIZE+2,,AUTO
         3 000103   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000104   000000 701000 xent               TSX1    THG$GETREC
         3 000105   000117 702000 3                  TSX2    L1

     1549     1548    2              IOM_TBL.PTR$(I)->IOM = TH$IOM;

   1548  3 000106   200004 236100                    LDQ     I,,AUTO
         3 000107   000003 402007                    MPY     3,DL
         3 000110   000000 470400 1                  LDP0    IOM_TBL$
         3 000111   000002 471506                    LDP1    2,QL,PR0
         3 000112   000001 473400 xsym               LDP3    TH_RECORD+1
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:287  
         3 000113   000100 100500                    MLR     fill='000'O
         3 000114   300000 002060                    ADSC9   0,,PR3                   cn=0,n=1072
         3 000115   100000 002060                    ADSC9   0,,PR1                   cn=0,n=1072

     1550     1549    3              DO NEVER;

   1549  3 000116   000137 710000 3                  TRA     s:1553

     1551     1550    3        L1:      CALL THG$GETREC(%CONFIG,IOM_NAME);

   1550  3 000117   200011 630500       L1           EPPR0   IOM_NAME,,AUTO
         3 000120   200025 450500                    STP0    @SIZE+3,,AUTO
         3 000121   000006 236000 4                  LDQ     6
         3 000122   200024 756100                    STQ     @SIZE+2,,AUTO
         3 000123   200024 630500                    EPPR0   @SIZE+2,,AUTO
         3 000124   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000125   000000 701000 xent               TSX1    THG$GETREC
         3 000126   000000 011000                    NOP     0

     1552     1551    3                 IOM_TBL.PTR$(I)->IOM = TD$IOM;

   1551  3 000127   200004 236100                    LDQ     I,,AUTO
         3 000130   000003 402007                    MPY     3,DL
         3 000131   000000 470400 1                  LDP0    IOM_TBL$
         3 000132   000002 471506                    LDP1    2,QL,PR0
         3 000133   000001 473400 xsym               LDP3    TH_RECORD+1
         3 000134   000100 100500                    MLR     fill='000'O
         3 000135   300000 002044                    ADSC9   0,,PR3                   cn=0,n=1060
         3 000136   100000 002060                    ADSC9   0,,PR1                   cn=0,n=1072

     1553     1552    3              END;                         /* DO NEVER                           */

     1554     1553    2              CALL GETBLK(IOM_TBL.PTR$(I)->IOM.CHAN$,SIZEW(CHAN)) ALTRET(NO_MEM);

   1553  3 000137   000000 470400 1                  LDP0    IOM_TBL$
         3 000140   000002 471506                    LDP1    2,QL,PR0
         3 000141   000010 236000 4                  LDQ     8
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:288  
         3 000142   200022 756100                    STQ     @PTR$+1,,AUTO
         3 000143   100411 633500                    EPPR3   265,,PR1
         3 000144   200021 453500                    STP3    FEP_NAME+4,,AUTO
         3 000145   001024 701000 3                  TSX1    GETBLK
         3 000146   001023 702000 3                  TSX2    NO_MEM

     1555     1554    2              IOM_TBL.PTR$(I)->IOM.CHAN$->CHAN = '0'B;

   1554  3 000147   200004 236100                    LDQ     I,,AUTO
         3 000150   000003 402007                    MPY     3,DL
         3 000151   000000 470400 1                  LDP0    IOM_TBL$
         3 000152   000002 471506                    LDP1    2,QL,PR0
         3 000153   100411 473500                    LDP3    265,,PR1
         3 000154   000100 100400                    MLR     fill='000'O
         3 000155   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         3 000156   300000 001004                    ADSC9   0,,PR3                   cn=0,n=516

     1556     1555    2              IOM_TBL.PTR$(I)->IOM.CHAN$->CHAN.IOM_NAME = IOM_NAME;

   1555  3 000157   000000 470400 1                  LDP0    IOM_TBL$
         3 000160   000002 471506                    LDP1    2,QL,PR0
         3 000161   100411 473500                    LDP3    265,,PR1
         3 000162   200011 236100                    LDQ     IOM_NAME,,AUTO
         3 000163   300000 756100                    STQ     0,,PR3

     1557     1556    2           END;                            /* DO I                               */

   1556  3 000164   200004 235100                    LDA     I,,AUTO
         3 000165   000001 035007                    ADLA    1,DL
         3 000166   200004 755100                    STA     I,,AUTO
         3 000167   200004 236100                    LDQ     I,,AUTO
         3 000170   000000 116000 xsym               CMPQ    NUM_IOMS
         3 000171   000026 602000 3                  TNC     s:1542

     1558     1557
     1559     1558                                                /* BUILD MPC TABLE                    */
     1560     1559    1           CALL GETBLK(MPC_TBL$,SIZEW(TBL)*NUM_MPCS) ALTRET(NO_MEM);
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:289  

   1559  3 000172   000000 236000 xsym               LDQ     NUM_MPCS
         3 000173   000003 402007                    MPY     3,DL
         3 000174   200030 756100                    STQ     @SIZE+6,,AUTO
         3 000175   200030 630500                    EPPR0   @SIZE+6,,AUTO
         3 000176   200022 450500                    STP0    @PTR$+1,,AUTO
         3 000177   000011 236000 4                  LDQ     9
         3 000200   200021 756100                    STQ     FEP_NAME+4,,AUTO
         3 000201   001024 701000 3                  TSX1    GETBLK
         3 000202   001023 702000 3                  TSX2    NO_MEM

     1561     1560    1           J = 0;

   1560  3 000203   200005 450100                    STZ     J,,AUTO

     1562     1561    2           DO I = TD_HEAD.UNITMPC_INDX TO TD_HEAD.UNITMPC_INDX + NUM_MPCS - 1;

   1561  3 000204   200003 470500                    LDP0    @TD_HEAD,,AUTO
         3 000205   000001 236100                    LDQ     1,,PR0
         3 000206   000022 772000                    QRL     18
         3 000207   200004 756100                    STQ     I,,AUTO
         3 000210   000432 710000 3                  TRA     s:1584+3

     1563     1562    2              MPC_TBL.DEVNAME(J) = TD_HEAD.DEVNAME(I);

   1562  3 000211   200005 236100                    LDQ     J,,AUTO
         3 000212   000003 402007                    MPY     3,DL
         3 000213   200004 235100                    LDA     I,,AUTO
         3 000214   000003 735000                    ALS     3
         3 000215   000002 736000                    QLS     2
         3 000216   200003 470500                    LDP0    @TD_HEAD,,AUTO
         3 000217   000001 471400 1                  LDP1    MPC_TBL$
         3 000220   040106 100505                    MLR     fill='040'O
         3 000221   000020 000010                    ADSC9   16,A,PR0                 cn=0,n=8
         3 000222   100000 000010                    ADSC9   0,Q,PR1                  cn=0,n=8

     1564     1563    2              CALL THG$GETREC(%DEVHIST,TD_HEAD.DEVNAME(I),UTS) ALTRET(L2);
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:290  

   1563  3 000223   000004 236000 4                  LDQ     4
         3 000224   200026 756100                    STQ     @SIZE+4,,AUTO
         3 000225   200004 236100                    LDQ     I,,AUTO
         3 000226   000023 736000                    QLS     19
         3 000227   000020 036003                    ADLQ    16,DU
         3 000230   200003 036100                    ADLQ    @TD_HEAD,,AUTO
         3 000231   000005 235000 4                  LDA     5
         3 000232   200024 757100                    STAQ    @SIZE+2,,AUTO
         3 000233   200024 630500                    EPPR0   @SIZE+2,,AUTO
         3 000234   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000235   000000 701000 xent               TSX1    THG$GETREC
         3 000236   000267 702000 3                  TSX2    L2

     1565     1564    2              CALL GETBLK(MPC_TBL.PTR$(J),SIZEW(MPC)+(2*TH$MPC.NUMDEVS-1)) ALTRET(
              1564                       NO_MEM);

   1564  3 000237   000001 470400 xsym               LDP0    TH_RECORD+1
         3 000240   000014 236100                    LDQ     12,,PR0
         3 000241   000021 772000                    QRL     17
         3 000242   000012 376000 4                  ANQ     10
         3 000243   000121 036007                    ADLQ    81,DL
         3 000244   200031 756100                    STQ     @SIZE+7,,AUTO
         3 000245   200031 631500                    EPPR1   @SIZE+7,,AUTO
         3 000246   200022 451500                    STP1    @PTR$+1,,AUTO
         3 000247   200005 236100                    LDQ     J,,AUTO
         3 000250   000003 402003                    MPY     3,DU
         3 000251   000002 036003                    ADLQ    2,DU
         3 000252   000001 036000 1                  ADLQ    MPC_TBL$
         3 000253   200021 756100                    STQ     FEP_NAME+4,,AUTO
         3 000254   001024 701000 3                  TSX1    GETBLK
         3 000255   001023 702000 3                  TSX2    NO_MEM

     1566     1565    2              MPC_TBL.PTR$(J)->MPC = TH$MPC;

   1565  3 000256   200005 236100                    LDQ     J,,AUTO
         3 000257   000003 402007                    MPY     3,DL
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:291  
         3 000260   000001 470400 1                  LDP0    MPC_TBL$
         3 000261   000002 471506                    LDP1    2,QL,PR0
         3 000262   000001 473400 xsym               LDP3    TH_RECORD+1
         3 000263   000100 100500                    MLR     fill='000'O
         3 000264   300000 000510                    ADSC9   0,,PR3                   cn=0,n=328
         3 000265   100000 000510                    ADSC9   0,,PR1                   cn=0,n=328

     1567     1566    3              DO NEVER;

   1566  3 000266   000424 710000 3                  TRA     s:1583

     1568     1567    3         L2:     CALL THG$GETREC(%CONFIG,TD_HEAD.DEVNAME(I));

   1567  3 000267   200004 236100       L2           LDQ     I,,AUTO
         3 000270   000023 736000                    QLS     19
         3 000271   000020 036003                    ADLQ    16,DU
         3 000272   200003 036100                    ADLQ    @TD_HEAD,,AUTO
         3 000273   000006 235000 4                  LDA     6
         3 000274   200024 757100                    STAQ    @SIZE+2,,AUTO
         3 000275   200024 630500                    EPPR0   @SIZE+2,,AUTO
         3 000276   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000277   000000 701000 xent               TSX1    THG$GETREC
         3 000300   000000 011000                    NOP     0

     1569     1568    3                 CALL GETBLK(MPC_TBL.PTR$(J),SIZEW(MPC)+(2*TD$MPC.NUMDEVS-1)) ALTRET(
              1568                          NO_MEM);

   1568  3 000301   000001 470400 xsym               LDP0    TH_RECORD+1
         3 000302   000012 236100                    LDQ     10,,PR0
         3 000303   000021 772000                    QRL     17
         3 000304   000012 376000 4                  ANQ     10
         3 000305   000121 036007                    ADLQ    81,DL
         3 000306   200032 756100                    STQ     @SIZE+8,,AUTO
         3 000307   200032 631500                    EPPR1   @SIZE+8,,AUTO
         3 000310   200022 451500                    STP1    @PTR$+1,,AUTO
         3 000311   200005 236100                    LDQ     J,,AUTO
         3 000312   000003 402003                    MPY     3,DU
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:292  
         3 000313   000002 036003                    ADLQ    2,DU
         3 000314   000001 036000 1                  ADLQ    MPC_TBL$
         3 000315   200021 756100                    STQ     FEP_NAME+4,,AUTO
         3 000316   001024 701000 3                  TSX1    GETBLK
         3 000317   001023 702000 3                  TSX2    NO_MEM

     1570     1569    3                 MPC_TBL.PTR$(J)->MPC = '0'B;

   1569  3 000320   200005 236100                    LDQ     J,,AUTO
         3 000321   000003 402007                    MPY     3,DL
         3 000322   000001 470400 1                  LDP0    MPC_TBL$
         3 000323   000002 471506                    LDP1    2,QL,PR0
         3 000324   000100 100400                    MLR     fill='000'O
         3 000325   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         3 000326   100000 000510                    ADSC9   0,,PR1                   cn=0,n=328

     1571     1570    3                 MPC_TBL.PTR$(J)->MPC.MODEL = TD$MPC.MODEL;

   1570  3 000327   000001 470400 1                  LDP0    MPC_TBL$
         3 000330   000002 471506                    LDP1    2,QL,PR0
         3 000331   000001 473400 xsym               LDP3    TH_RECORD+1
         3 000332   040100 100500                    MLR     fill='040'O
         3 000333   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8
         3 000334   100002 000010                    ADSC9   2,,PR1                   cn=0,n=8

     1572     1571    3                 MPC_TBL.PTR$(J)->MPC.IOCHAN = TD$MPC.IOCHAN;

   1571  3 000335   000002 471506                    LDP1    2,QL,PR0
         3 000336   000100 100500                    MLR     fill='000'O
         3 000337   300002 000040                    ADSC9   2,,PR3                   cn=0,n=32
         3 000340   100004 000040                    ADSC9   4,,PR1                   cn=0,n=32

     1573     1572    3                 MPC_TBL.PTR$(J)->MPC.NUMDEVS = TD$MPC.NUMDEVS;

   1572  3 000341   000002 471506                    LDP1    2,QL,PR0
         3 000342   300012 220100                    LDX0    10,,PR3
         3 000343   100014 740100                    STX0    12,,PR1
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:293  

     1574     1573    3                 MPC_TBL.PTR$(J)->MPC.FLAGS = TD$MPC.FLAGS;

   1573  3 000344   000002 471506                    LDP1    2,QL,PR0
         3 000345   300012 720100                    LXL0    10,,PR3
         3 000346   100014 440100                    SXL0    12,,PR1

     1575     1574    3                 MPC_TBL.PTR$(J)->MPC.FWNAME = TD$MPC.FWNAME;

   1574  3 000347   000002 471506                    LDP1    2,QL,PR0
         3 000350   300013 236100                    LDQ     11,,PR3
         3 000351   100015 756100                    STQ     13,,PR1

     1576     1575    3                 MPC_TBL.PTR$(J)->MPC.LPFWNAME = TD$MPC.LPFWNAME;

   1575  3 000352   200005 236100                    LDQ     J,,AUTO
         3 000353   000003 402007                    MPY     3,DL
         3 000354   000002 471506                    LDP1    2,QL,PR0
         3 000355   300014 236100                    LDQ     12,,PR3
         3 000356   100016 756100                    STQ     14,,PR1

     1577     1576    3                 MPC_TBL.PTR$(J)->MPC.CRPFWNAME = TD$MPC.CRPFWNAME;

   1576  3 000357   200005 236100                    LDQ     J,,AUTO
         3 000360   000003 402007                    MPY     3,DL
         3 000361   000002 471506                    LDP1    2,QL,PR0
         3 000362   300015 236100                    LDQ     13,,PR3
         3 000363   100017 756100                    STQ     15,,PR1

     1578     1577    4                 DO K = 0 TO TD$MPC.NUMDEVS - 1;

   1577  3 000364   200006 450100                    STZ     K,,AUTO
         3 000365   000406 710000 3                  TRA     s:1579+3

     1579     1578    4                    MPC_TBL.PTR$(J)->MPC.DEVNAME(K) = TD$MPC.DEVNAME(K);

   1578  3 000366   200005 236100                    LDQ     J,,AUTO
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:294  
         3 000367   000003 402007                    MPY     3,DL
         3 000370   000001 470400 1                  LDP0    MPC_TBL$
         3 000371   000002 471506                    LDP1    2,QL,PR0
         3 000372   200006 235100                    LDA     K,,AUTO
         3 000373   000001 735000                    ALS     1
         3 000374   200006 236100                    LDQ     K,,AUTO
         3 000375   000003 736000                    QLS     3
         3 000376   000002 735000                    ALS     2
         3 000377   000001 473400 xsym               LDP3    TH_RECORD+1
         3 000400   040105 100506                    MLR     fill='040'O
         3 000401   300017 000010                    ADSC9   15,Q,PR3                 cn=0,n=8
         3 000402   100020 000010                    ADSC9   16,A,PR1                 cn=0,n=8

     1580     1579    4                 END;                      /* DO K                               */

   1579  3 000403   200006 235100                    LDA     K,,AUTO
         3 000404   000001 035007                    ADLA    1,DL
         3 000405   200006 755100                    STA     K,,AUTO
         3 000406   000001 470400 xsym               LDP0    TH_RECORD+1
         3 000407   000012 236100                    LDQ     10,,PR0
         3 000410   000022 772000                    QRL     18
         3 000411   200006 116100                    CMPQ    K,,AUTO
         3 000412   000414 600000 3                  TZE     s:1580
         3 000413   000366 603000 3                  TRC     s:1578

     1581     1580    3                 MPC_TBL.PTR$(J)->MPC.COUNT = 0;

   1580  3 000414   200005 236100                    LDQ     J,,AUTO
         3 000415   000003 402007                    MPY     3,DL
         3 000416   000001 471400 1                  LDP1    MPC_TBL$
         3 000417   100002 473506                    LDP3    2,QL,PR1
         3 000420   300000 450100                    STZ     0,,PR3

     1582     1581    3                 MPC_TBL.PTR$(J)->MPC.CONNECTS = 0;

   1581  3 000421   000001 470400 1                  LDP0    MPC_TBL$
         3 000422   000002 471506                    LDP1    2,QL,PR0
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:295  
         3 000423   100001 450100                    STZ     1,,PR1

     1583     1582    3              END;                         /* DO NEVER                           */

     1584     1583    2              J = J + 1;

   1583  3 000424   200005 235100                    LDA     J,,AUTO
         3 000425   000001 035007                    ADLA    1,DL
         3 000426   200005 755100                    STA     J,,AUTO

     1585     1584    2           END;                            /* DO I                               */

   1584  3 000427   200004 236100                    LDQ     I,,AUTO
         3 000430   000001 036007                    ADLQ    1,DL
         3 000431   200004 756100                    STQ     I,,AUTO
         3 000432   200003 470500                    LDP0    @TD_HEAD,,AUTO
         3 000433   000001 236100                    LDQ     1,,PR0
         3 000434   000022 772000                    QRL     18
         3 000435   000000 036000 xsym               ADLQ    NUM_MPCS
         3 000436   200004 116100                    CMPQ    I,,AUTO
         3 000437   000441 600000 3                  TZE     s:1587
         3 000440   000211 603000 3                  TRC     s:1562

     1586     1585
     1587     1586                                                /* BUILD FEP TABLE                    */
     1588     1587    1           CALL GETBLK(FEP_TBL$,SIZEW(TBL)* %FEP_MAX) ALTRET(NO_MEM);

   1587  3 000441   000014 236000 4                  LDQ     12
         3 000442   200022 756100                    STQ     @PTR$+1,,AUTO
         3 000443   000015 236000 4                  LDQ     13
         3 000444   200021 756100                    STQ     FEP_NAME+4,,AUTO
         3 000445   001024 701000 3                  TSX1    GETBLK
         3 000446   001023 702000 3                  TSX2    NO_MEM

     1589     1588    1           J = 0;

   1588  3 000447   200005 450100                    STZ     J,,AUTO
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:296  

     1590     1589    2           DO I = 1 TO %FEP_MAX;

   1589  3 000450   000001 235007                    LDA     1,DL
         3 000451   200004 755100                    STA     I,,AUTO

     1591     1590    2              FEP# = ' ';

   1590  3 000452   000016 236000 4                  LDQ     14
         3 000453   200014 552170                    STBQ    FEP#,'70'O,AUTO

     1592     1591    2              CALL BINCHAR (FEP#,I);

   1591  3 000454   200004 235100                    LDA     I,,AUTO
         3 000455   000044 773000                    LRL     36
         3 000456   200024 757100                    STAQ    @SIZE+2,,AUTO
         3 000457   000100 301500                    BTD
         3 000460   200024 000010                    NDSC9   @SIZE+2,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         3 000461   200014 030003                    NDSC9   FEP#,,AUTO               cn=0,s=nosgn,sf=0,n=3

     1593     1592    2              IF(FEP#1(0) = '0' AND FEP#1(1) = '0')

   1592  3 000462   200014 236100                    LDQ     FEP#,,AUTO
         3 000463   777000 376003                    ANQ     -512,DU
         3 000464   060000 116003                    CMPQ    24576,DU
         3 000465   000502 601000 3                  TNZ     s:1594
         3 000466   200014 236100                    LDQ     FEP#,,AUTO
         3 000467   000777 376003                    ANQ     511,DU
         3 000470   000060 116003                    CMPQ    48,DU
         3 000471   000502 601000 3                  TNZ     s:1594

     1594     1593    2                 THEN CALL CONCAT(FEP_NAME,'FEP',FEP#1(2));

   1593  3 000472   000010 236000 2                  LDQ     FPT_GDS+8
         3 000473   000001 376000 4                  ANQ     1
         3 000474   000040 276007                    ORQ     32,DL
         3 000475   200015 756100                    STQ     FEP_NAME,,AUTO
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:297  
         3 000476   040100 100500                    MLR     fill='040'O
         3 000477   200014 400001                    ADSC9   FEP#,,AUTO               cn=2,n=1
         3 000500   200015 600003                    ADSC9   FEP_NAME,,AUTO           cn=3,n=3
         3 000501   000532 710000 3                  TRA     s:1597

     1595     1594    2                 ELSE IF FEP#1(0) = '0'

   1594  3 000502   200014 236100                    LDQ     FEP#,,AUTO
         3 000503   777000 376003                    ANQ     -512,DU
         3 000504   060000 116003                    CMPQ    24576,DU
         3 000505   000523 601000 3                  TNZ     s:1596

     1596     1595    2                 THEN CALL CONCAT(FEP_NAME,'FEP',FEP#1(1),FEP#1(2));

   1595  3 000506   000010 236000 2                  LDQ     FPT_GDS+8
         3 000507   000001 376000 4                  ANQ     1
         3 000510   000040 276007                    ORQ     32,DL
         3 000511   200015 756100                    STQ     FEP_NAME,,AUTO
         3 000512   200014 236100                    LDQ     FEP#,,AUTO
         3 000513   000022 772000                    QRL     18
         3 000514   200015 552104                    STBQ    FEP_NAME,'04'O,AUTO
         3 000515   040100 100500                    MLR     fill='040'O
         3 000516   200014 400001                    ADSC9   FEP#,,AUTO               cn=2,n=1
         3 000517   200024 000004                    ADSC9   @SIZE+2,,AUTO            cn=0,n=4
         3 000520   200024 220100                    LDX0    @SIZE+2,,AUTO
         3 000521   200016 740100                    STX0    FEP_NAME+1,,AUTO
         3 000522   000532 710000 3                  TRA     s:1597

     1597     1596    2                 ELSE CALL CONCAT(FEP_NAME,'FEP',FEP#);

   1596  3 000523   000010 236000 2                  LDQ     FPT_GDS+8
         3 000524   000001 376000 4                  ANQ     1
         3 000525   000040 276007                    ORQ     32,DL
         3 000526   200015 756100                    STQ     FEP_NAME,,AUTO
         3 000527   040100 100500                    MLR     fill='040'O
         3 000530   200014 000003                    ADSC9   FEP#,,AUTO               cn=0,n=3
         3 000531   200015 600003                    ADSC9   FEP_NAME,,AUTO           cn=3,n=3
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:298  

     1598     1597    2              FEP_TBL.DEVNAME(J) = FEP_NAME;

   1597  3 000532   200005 236100                    LDQ     J,,AUTO
         3 000533   000003 402007                    MPY     3,DL
         3 000534   000002 736000                    QLS     2
         3 000535   000002 470400 1                  LDP0    FEP_TBL$
         3 000536   040106 100500                    MLR     fill='040'O
         3 000537   200015 000006                    ADSC9   FEP_NAME,,AUTO           cn=0,n=6
         3 000540   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=8

     1599     1598    2              CALL GETBLK(FEP_TBL.PTR$(J),SIZEW(FEP)) ALTRET(NO_MEM);

   1598  3 000541   000017 236000 4                  LDQ     15
         3 000542   200022 756100                    STQ     @PTR$+1,,AUTO
         3 000543   200005 236100                    LDQ     J,,AUTO
         3 000544   000003 402003                    MPY     3,DU
         3 000545   000002 036003                    ADLQ    2,DU
         3 000546   000002 036000 1                  ADLQ    FEP_TBL$
         3 000547   200021 756100                    STQ     FEP_NAME+4,,AUTO
         3 000550   001024 701000 3                  TSX1    GETBLK
         3 000551   001023 702000 3                  TSX2    NO_MEM

     1600     1599    2              FEP_TBL.PTR$(J)->FEP = '0'B;

   1599  3 000552   200005 236100                    LDQ     J,,AUTO
         3 000553   000003 402007                    MPY     3,DL
         3 000554   000002 470400 1                  LDP0    FEP_TBL$
         3 000555   000002 471506                    LDP1    2,QL,PR0
         3 000556   100000 450100                    STZ     0,,PR1

     1601     1600    2              CALL THG$GETREC(%DEVHIST,FEP_NAME,UTS) ALTRET(L3);

   1600  3 000557   000004 236000 4                  LDQ     4
         3 000560   200026 756100                    STQ     @SIZE+4,,AUTO
         3 000561   200015 630500                    EPPR0   FEP_NAME,,AUTO
         3 000562   200025 450500                    STP0    @SIZE+3,,AUTO
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:299  
         3 000563   000005 236000 4                  LDQ     5
         3 000564   200024 756100                    STQ     @SIZE+2,,AUTO
         3 000565   200024 630500                    EPPR0   @SIZE+2,,AUTO
         3 000566   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000567   000000 701000 xent               TSX1    THG$GETREC
         3 000570   000601 702000 3                  TSX2    L3

     1602     1601    2              FEP_TBL.PTR$(J)->FEP = TH$FEP;

   1601  3 000571   200005 236100                    LDQ     J,,AUTO
         3 000572   000003 402007                    MPY     3,DL
         3 000573   000002 470400 1                  LDP0    FEP_TBL$
         3 000574   000002 471506                    LDP1    2,QL,PR0
         3 000575   000001 473400 xsym               LDP3    TH_RECORD+1
         3 000576   300000 236100                    LDQ     0,,PR3
         3 000577   100000 756100                    STQ     0,,PR1

     1603     1602    3              DO NEVER;

   1602  3 000600   000655 710000 3                  TRA     s:1614

     1604     1603
     1605     1604    3      L3:         /* FIND CHANNEL THAT THIS FEP IS ON AND STUFF INTO FEP RECORD  */
     1606     1605    4                 DO K = 0 TO NUM_IOMS - 1;

   1605  3 000601   200006 450100       L3           STZ     K,,AUTO
         3 000602   000652 710000 3                  TRA     s:1612+3

     1607     1606    5                    DO L = 0 TO %N_MAXCHANS-1;

   1606  3 000603   200007 450100                    STZ     L,,AUTO
         3 000604   000644 710000 3                  TRA     s:1611+3

     1608     1607    6                      IF IOM_TBL.PTR$(K)->IOM.DEVNAME(L) = FEP_TBL.DEVNAME(J) THEN DO;

   1607  3 000605   200006 236100                    LDQ     K,,AUTO
         3 000606   000003 402007                    MPY     3,DL
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:300  
         3 000607   000000 470400 1                  LDP0    IOM_TBL$
         3 000610   000002 471506                    LDP1    2,QL,PR0
         3 000611   200007 235100                    LDA     L,,AUTO
         3 000612   000003 735000                    ALS     3
         3 000613   200005 236100                    LDQ     J,,AUTO
         3 000614   200024 755100                    STA     @SIZE+2,,AUTO
         3 000615   000014 402007                    MPY     12,DL
         3 000616   200024 235100                    LDA     @SIZE+2,,AUTO
         3 000617   000002 473400 1                  LDP3    FEP_TBL$
         3 000620   040106 106505                    CMPC    fill='040'O
         3 000621   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=8
         3 000622   300000 000010                    ADSC9   0,Q,PR3                  cn=0,n=8
         3 000623   000641 601000 3                  TNZ     s:1611

     1609     1608    6                          FEP_TBL.PTR$(J)->FEP.CHANNEL = L;

   1608  3 000624   200005 236100                    LDQ     J,,AUTO
         3 000625   000003 402007                    MPY     3,DL
         3 000626   300002 471506                    LDP1    2,QL,PR3
         3 000627   200007 236100                    LDQ     L,,AUTO
         3 000630   000022 736000                    QLS     18
         3 000631   100000 552120                    STBQ    0,'20'O,PR1

     1610     1609    6                          FEP_TBL.PTR$(J)->FEP.IOM = K;

   1609  3 000632   200005 236100                    LDQ     J,,AUTO
         3 000633   000003 402007                    MPY     3,DL
         3 000634   000002 470400 1                  LDP0    FEP_TBL$
         3 000635   000002 471506                    LDP1    2,QL,PR0
         3 000636   200006 236100                    LDQ     K,,AUTO
         3 000637   000033 736000                    QLS     27
         3 000640   100000 552140                    STBQ    0,'40'O,PR1

     1611     1610    6                          END;  /* IF */

     1612     1611    5                    END;                   /* DO L                               */

PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:301  
   1611  3 000641   200007 235100                    LDA     L,,AUTO
         3 000642   000001 035007                    ADLA    1,DL
         3 000643   200007 755100                    STA     L,,AUTO
         3 000644   200007 235100                    LDA     L,,AUTO
         3 000645   000200 115007                    CMPA    128,DL
         3 000646   000605 602000 3                  TNC     s:1607

     1613     1612    4                 END;                      /* DO K                               */

   1612  3 000647   200006 236100                    LDQ     K,,AUTO
         3 000650   000001 036007                    ADLQ    1,DL
         3 000651   200006 756100                    STQ     K,,AUTO
         3 000652   200006 236100                    LDQ     K,,AUTO
         3 000653   000000 116000 xsym               CMPQ    NUM_IOMS
         3 000654   000603 602000 3                  TNC     s:1606

     1614     1613    3              END;                         /* DO NEVER                           */

     1615     1614    2              J = J + 1;

   1614  3 000655   200005 235100                    LDA     J,,AUTO
         3 000656   000001 035007                    ADLA    1,DL
         3 000657   200005 755100                    STA     J,,AUTO

     1616     1615    2           END;                            /* DO I                               */

   1615  3 000660   200004 236100                    LDQ     I,,AUTO
         3 000661   000001 036007                    ADLQ    1,DL
         3 000662   200004 756100                    STQ     I,,AUTO
         3 000663   000401 116007                    CMPQ    257,DL
         3 000664   000452 602000 3                  TNC     s:1590

     1617     1616
     1618     1617                                                /* BUILD DEVICE TABLE                 */
     1619     1618    1           CALL GETBLK(DEV_TBL$,SIZEW(TBL)*NUM_DEVS) ALTRET(NO_MEM);

   1618  3 000665   000000 236000 xsym               LDQ     NUM_DEVS
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:302  
         3 000666   000003 402007                    MPY     3,DL
         3 000667   200033 756100                    STQ     @SIZE+9,,AUTO
         3 000670   200033 630500                    EPPR0   @SIZE+9,,AUTO
         3 000671   200022 450500                    STP0    @PTR$+1,,AUTO
         3 000672   000020 236000 4                  LDQ     16
         3 000673   200021 756100                    STQ     FEP_NAME+4,,AUTO
         3 000674   001024 701000 3                  TSX1    GETBLK
         3 000675   001023 702000 3                  TSX2    NO_MEM

     1620     1619    1           J = 0;

   1619  3 000676   200005 450100                    STZ     J,,AUTO

     1621     1620    2           DO I = TD_HEAD.LP_INDX TO TD_HEAD.LP_INDX + NUM_DEVS - 1;

   1620  3 000677   200003 470500                    LDP0    @TD_HEAD,,AUTO
         3 000700   000010 236100                    LDQ     8,,PR0
         3 000701   000022 772000                    QRL     18
         3 000702   200004 756100                    STQ     I,,AUTO
         3 000703   001013 710000 3                  TRA     s:1631+3

     1622     1621    2              DEV_TBL.DEVNAME(J) = TD_HEAD.DEVNAME(I);

   1621  3 000704   200005 236100                    LDQ     J,,AUTO
         3 000705   000003 402007                    MPY     3,DL
         3 000706   200004 235100                    LDA     I,,AUTO
         3 000707   000003 735000                    ALS     3
         3 000710   000002 736000                    QLS     2
         3 000711   200003 470500                    LDP0    @TD_HEAD,,AUTO
         3 000712   000003 471400 1                  LDP1    DEV_TBL$
         3 000713   040106 100505                    MLR     fill='040'O
         3 000714   000020 000010                    ADSC9   16,A,PR0                 cn=0,n=8
         3 000715   100000 000010                    ADSC9   0,Q,PR1                  cn=0,n=8

     1623     1622    2              CALL GETBLK(DEV_TBL.PTR$(J),SIZEW(DEV)) ALTRET(NO_MEM);

   1622  3 000716   000022 236000 4                  LDQ     18
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:303  
         3 000717   200022 756100                    STQ     @PTR$+1,,AUTO
         3 000720   200005 236100                    LDQ     J,,AUTO
         3 000721   000003 402003                    MPY     3,DU
         3 000722   000002 036003                    ADLQ    2,DU
         3 000723   000003 036000 1                  ADLQ    DEV_TBL$
         3 000724   200021 756100                    STQ     FEP_NAME+4,,AUTO
         3 000725   001024 701000 3                  TSX1    GETBLK
         3 000726   001023 702000 3                  TSX2    NO_MEM

     1624     1623    2              DEV_TBL.PTR$(J)->DEV = '0'B;

   1623  3 000727   200005 236100                    LDQ     J,,AUTO
         3 000730   000003 402007                    MPY     3,DL
         3 000731   000003 470400 1                  LDP0    DEV_TBL$
         3 000732   000002 471506                    LDP1    2,QL,PR0
         3 000733   000100 100400                    MLR     fill='000'O
         3 000734   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         3 000735   100000 000134                    ADSC9   0,,PR1                   cn=0,n=92

     1625     1624    2              CALL THG$GETREC(%DEVHIST,TD_HEAD.DEVNAME(I),UTS) ALTRET(L4);

   1624  3 000736   000004 236000 4                  LDQ     4
         3 000737   200026 756100                    STQ     @SIZE+4,,AUTO
         3 000740   200004 236100                    LDQ     I,,AUTO
         3 000741   000023 736000                    QLS     19
         3 000742   000020 036003                    ADLQ    16,DU
         3 000743   200003 036100                    ADLQ    @TD_HEAD,,AUTO
         3 000744   000005 235000 4                  LDA     5
         3 000745   200024 757100                    STAQ    @SIZE+2,,AUTO
         3 000746   200024 630500                    EPPR0   @SIZE+2,,AUTO
         3 000747   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000750   000000 701000 xent               TSX1    THG$GETREC
         3 000751   000763 702000 3                  TSX2    L4

     1626     1625    2              DEV_TBL.PTR$(J)->DEV = TH$DEV;

   1625  3 000752   200005 236100                    LDQ     J,,AUTO
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:304  
         3 000753   000003 402007                    MPY     3,DL
         3 000754   000003 470400 1                  LDP0    DEV_TBL$
         3 000755   000002 471506                    LDP1    2,QL,PR0
         3 000756   000001 473400 xsym               LDP3    TH_RECORD+1
         3 000757   000100 100500                    MLR     fill='000'O
         3 000760   300000 000134                    ADSC9   0,,PR3                   cn=0,n=92
         3 000761   100000 000134                    ADSC9   0,,PR1                   cn=0,n=92

     1627     1626    3              DO NEVER;

   1626  3 000762   001005 710000 3                  TRA     s:1630

     1628     1627    3        L4:      CALL THG$GETREC(%CONFIG,TD_HEAD.DEVNAME(I));

   1627  3 000763   200004 236100       L4           LDQ     I,,AUTO
         3 000764   000023 736000                    QLS     19
         3 000765   000020 036003                    ADLQ    16,DU
         3 000766   200003 036100                    ADLQ    @TD_HEAD,,AUTO
         3 000767   000006 235000 4                  LDA     6
         3 000770   200024 757100                    STAQ    @SIZE+2,,AUTO
         3 000771   200024 630500                    EPPR0   @SIZE+2,,AUTO
         3 000772   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000773   000000 701000 xent               TSX1    THG$GETREC
         3 000774   000000 011000                    NOP     0

     1629     1628    3                 DEV_TBL.PTR$(J)->DEV = TD$DEV;

   1628  3 000775   200005 236100                    LDQ     J,,AUTO
         3 000776   000003 402007                    MPY     3,DL
         3 000777   000003 470400 1                  LDP0    DEV_TBL$
         3 001000   000002 471506                    LDP1    2,QL,PR0
         3 001001   000001 473400 xsym               LDP3    TH_RECORD+1
         3 001002   000100 100500                    MLR     fill='000'O
         3 001003   300000 000054                    ADSC9   0,,PR3                   cn=0,n=44
         3 001004   100000 000134                    ADSC9   0,,PR1                   cn=0,n=92

     1630     1629    3              END;                         /* DO NEVER                           */
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:305  

     1631     1630    2              J = J + 1;

   1630  3 001005   200005 235100                    LDA     J,,AUTO
         3 001006   000001 035007                    ADLA    1,DL
         3 001007   200005 755100                    STA     J,,AUTO

     1632     1631    2           END;                            /* DO I                               */

   1631  3 001010   200004 236100                    LDQ     I,,AUTO
         3 001011   000001 036007                    ADLQ    1,DL
         3 001012   200004 756100                    STQ     I,,AUTO
         3 001013   200003 470500                    LDP0    @TD_HEAD,,AUTO
         3 001014   000010 236100                    LDQ     8,,PR0
         3 001015   000022 772000                    QRL     18
         3 001016   000000 036000 xsym               ADLQ    NUM_DEVS
         3 001017   200004 116100                    CMPQ    I,,AUTO
         3 001020   001022 600000 3                  TZE     s:1632
         3 001021   000704 603000 3                  TRC     s:1621

     1633     1632    1           RETURN;

   1632  3 001022   000000 702200 xent               TSX2  ! X66_ARET

   1628  3 001023                       NO_MEM       null
     1634     1633    1   NO_MEM: ;
     1635     1634    1           ALTRETURN;

   1634  3 001023   000000 702200 xent               TSX2  ! X66_AALT

     1636     1635        %EJECT;
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:306  
     1637     1636    1   GETBLK: PROC(PTR$,SIZE) ALTRET;

   1636  3 001024   200020 741300       GETBLK       STX1  ! FEP_NAME+3,,AUTO

     1638     1637        /**/
     1639     1638    2   DCL PTR$ PTR;
     1640     1639    2   DCL SIZE SBIN;
     1641     1640        /**/
     1642     1641    3        DO WHILE(SIZE > ((TABLESEG.BOUND+1)/4) - POFFW(TABLE$,TABLESEG.PTR$));

   1641  3 001025   001032 710000 3                  TRA     s:1643

     1643     1642    3           CALL M$GDS(FPT_GDS) ALTRET(GDS_ERR);

   1642  3 001026   000000 630400 2                  EPPR0   FPT_GDS
         3 001027   430001 713400                    CLIMB   alt,gds
         3 001030   400400 401760                    pmme    nvectors=2
         3 001031   001064 702000 3                  TSX2    GDS_ERR

     1644     1643    3        END;                               /* DO WHILE                           */

   1643  3 001032   000004 236000 1                  LDQ     TABLESEG
         3 001033   000020 772000                    QRL     16
         3 001034   000001 036007                    ADLQ    1,DL
         3 001035   000002 772000                    QRL     2
         3 001036   000005 235000 1                  LDA     TABLESEG+1
         3 001037   000022 771000                    ARL     18
         3 001040   200024 755100                    STA     @SIZE+2,,AUTO
         3 001041   200025 756100                    STQ     @SIZE+3,,AUTO
         3 001042   200013 236100                    LDQ     TABLE$,,AUTO
         3 001043   000022 772000                    QRL     18
         3 001044   200024 136100                    SBLQ    @SIZE+2,,AUTO
         3 001045   200026 756100                    STQ     @SIZE+4,,AUTO
         3 001046   200025 236100                    LDQ     @SIZE+3,,AUTO
         3 001047   200026 136100                    SBLQ    @SIZE+4,,AUTO
         3 001050   200022 470500                    LDP0    @SIZE,,AUTO
         3 001051   000000 116100                    CMPQ    0,,PR0
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:307  
         3 001052   001026 604000 3                  TMI     s:1642

     1645     1644    2        PTR$ = TABLE$;

   1644  3 001053   200013 236100                    LDQ     TABLE$,,AUTO
         3 001054   200021 471500                    LDP1    @PTR$,,AUTO
         3 001055   100000 756100                    STQ     0,,PR1

     1646     1645    2        TABLE$ = PINCRW(TABLE$,SIZE);

   1645  3 001056   000000 236100                    LDQ     0,,PR0
         3 001057   000022 736000                    QLS     18
         3 001060   200013 036100                    ADLQ    TABLE$,,AUTO
         3 001061   200013 756100                    STQ     TABLE$,,AUTO

     1647     1646    2        RETURN;

   1646  3 001062   200020 221300                    LDX1  ! FEP_NAME+3,,AUTO
         3 001063   000001 702211                    TSX2  ! 1,X1

   1645  3 001064                       GDS_ERR      null
     1648     1647    2   GDS_ERR: ;
     1649     1648    2        ALTRETURN;

   1648  3 001064   200020 221300                    LDX1  ! FEP_NAME+3,,AUTO
         3 001065   000000 702211                    TSX2  ! 0,X1
     1650     1649    2   END GETBLK;
     1651     1650    1   END THE$INIT;
     1652     1651        %EOD;

PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:308  
--  Include file information  --

   NI$TABLES.:E05TOU  is referenced.
   IT_SUBS_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   TH$HIST.:E05TOU  is referenced.
   TD$STRUCT.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THE$INIT.
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:309  

 **** Variables and constants ****

  ****  Section 001  Data  THE$INIT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 DEV_TBL$                   2-0-0/w PTR         r     1 FEP_TBL$
     0-0-0/w PTR         r     1 IOM_TBL$                   1-0-0/w PTR         r     1 MPC_TBL$
     4-0-0/d STRC(72)    r     1 TABLESEG                   6-0-0/w STRC(108)   r     1 TBL

  ****  Section 002 RoData THE$INIT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(216)   r     1 FPT_GDS

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    21-0-0/w PTR         r     1 @PTR$                     22-0-0/w PTR         r     1 @SIZE
     3-0-0/w PTR         r     1 @TD_HEAD                  14-0-0/c CHAR(3)     r     1 FEP#
    14-0-0/c CHAR        r     1 FEP#1(0:2)                15-0-0/c CHAR(6)     r     1 FEP_NAME
     4-0-0/w UBIN        r     1 I                         10-0-0/c CHAR        r     1 IOM#
    11-0-0/c CHAR(8)     r     1 IOM_NAME                   5-0-0/w UBIN        r     1 J
     6-0-0/w UBIN        r     1 K                          7-0-0/w UBIN        r     1 L
    *0-0-0/w PTR         r     1 PTR$                      *0-0-0/w SBIN        r     1 SIZE
    13-0-0/w PTR         r     1 TABLE$                    *0-0-0/w STRC(648)   r     1 TD_HEAD

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:310  
     0-0-0/w UBIN        r     1 NUM_DEVS                   0-0-0/w UBIN        r     1 NUM_IOMS
     0-0-0/w UBIN        r     1 NUM_MPCS                   0-0-0/d STRC(72)    r     1 TH_RECORD
     0-0-0/w UBIN        r     1 UTS

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(4644)  r     1 CHAN                       0-0-0/w STRC(828)   r     1 DEV
     0-0-0/w STRC(108)   r     1 DEV_TBL(0:0)
     0-0-0/w STRC        r     1 FEP
     0-0-0/w STRC(108)   r     1 FEP_TBL(0:0)
     0-0-0/w STRC(9648)  r     1 IOM
     0-0-0/w STRC(108)   r     1 IOM_TBL(0:0)
     0-0-0/w STRC(2952)  r     1 MPC
     0-0-0/w STRC(108)   r     1 MPC_TBL(0:0)
     0-0-0/w STRC(396)   r     1 TD$DEV                     0-0-0/w STRC(9540)  r     1 TD$IOM
     0-0-0/w STRC(2916)  r     1 TD$MPC                     0-0-0/w STRC(828)   r     1 TH$DEV
     0-0-0/w STRC        r     1 TH$FEP                     0-0-0/w STRC(9648)  r     1 TH$IOM
     0-0-0/w STRC(2952)  r     1 TH$MPC


   Procedure THE$INIT requires 566 words for executable code.
   Procedure THE$INIT requires 28 words of local(AUTO) storage.
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:311  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:312  
          MINI XREF LISTING

CHAN
      1374**DCL      1553--CALL     1554<<ASSIGN
CHAN.IOM_NAME
      1375**DCL      1555<<ASSIGN
DEV
      1353**DCL      1622--CALL     1623<<ASSIGN   1625<<ASSIGN   1628<<ASSIGN
DEV_TBL.DEVNAME
      1458**DCL      1621<<ASSIGN
DEV_TBL.PTR$
      1459**DCL      1622<>CALL     1623>>ASSIGN   1625>>ASSIGN   1628>>ASSIGN
DEV_TBL$
      1278**DCL      1457--IMP-PTR  1618<>CALL     1621>>ASSIGN   1622>>CALL     1623>>ASSIGN   1625>>ASSIGN
      1628>>ASSIGN
FEP
      1346**DCL      1598--CALL     1599<<ASSIGN   1601<<ASSIGN
FEP.CHANNEL
      1348**DCL      1608<<ASSIGN
FEP.IOM
      1347**DCL      1609<<ASSIGN
FEP#
      1301**DCL      1302--REDEF    1590<<ASSIGN   1591<<CALLBLT  1596>>CALLBLT
FEP#1
      1302**DCL      1592>>IF       1592>>IF       1593>>CALLBLT  1594>>IF       1595>>CALLBLT  1595>>CALLBLT
FEP_NAME
      1303**DCL      1593<<CALLBLT  1595<<CALLBLT  1596<<CALLBLT  1597>>ASSIGN   1600<>CALL
FEP_TBL.DEVNAME
      1453**DCL      1597<<ASSIGN   1607>>IF
FEP_TBL.PTR$
      1454**DCL      1598<>CALL     1599>>ASSIGN   1601>>ASSIGN   1608>>ASSIGN   1609>>ASSIGN
FEP_TBL$
      1277**DCL      1452--IMP-PTR  1587<>CALL     1597>>ASSIGN   1598>>CALL     1599>>ASSIGN   1601>>ASSIGN
      1607>>IF       1608>>ASSIGN   1609>>ASSIGN
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:313  
FPT_GDS
      1527**DCL      1536<>CALL     1642<>CALL
FPT_GDS.V
      1527**DCL      1527--DCLINIT
GDS_ERR IN PROCEDURE GETBLK
      1645**LABEL    1642--CALLALT
GETBLK
      1636**PROC     1540--CALL     1545--CALL     1553--CALL     1559--CALL     1564--CALL     1568--CALL
      1587--CALL     1598--CALL     1618--CALL     1622--CALL
I
      1293**DCL      1541<<DOINDEX  1542>>CALLBLT  1544>>ASSIGN   1545>>CALL     1546>>ASSIGN   1548>>ASSIGN
      1551>>ASSIGN   1553>>CALL     1554>>ASSIGN   1555>>ASSIGN   1561<<DOINDEX  1562>>ASSIGN   1563>>CALL
      1567>>CALL     1589<<DOINDEX  1591>>CALLBLT  1620<<DOINDEX  1621>>ASSIGN   1624>>CALL     1627>>CALL
IOM
      1314**DCL      1545--CALL     1546<<ASSIGN   1548<<ASSIGN   1551<<ASSIGN
IOM.CHAN$
      1320**DCL      1553<>CALL     1554>>ASSIGN   1555>>ASSIGN
IOM.DEVNAME
      1315**DCL      1607>>IF
IOM#
      1297**DCL      1542<<CALLBLT  1543>>CALLBLT
IOM_NAME
      1298**DCL      1543<<CALLBLT  1544>>ASSIGN   1547<>CALL     1550<>CALL     1555>>ASSIGN
IOM_TBL.DEVNAME
      1443**DCL      1544<<ASSIGN
IOM_TBL.PTR$
      1444**DCL      1545<>CALL     1546>>ASSIGN   1548>>ASSIGN   1551>>ASSIGN   1553>>CALL     1554>>ASSIGN
      1555>>ASSIGN   1607>>IF
IOM_TBL$
      1275**DCL      1442--IMP-PTR  1540<>CALL     1544>>ASSIGN   1545>>CALL     1546>>ASSIGN   1548>>ASSIGN
      1551>>ASSIGN   1553>>CALL     1554>>ASSIGN   1555>>ASSIGN   1607>>IF
J
      1294**DCL      1560<<ASSIGN   1562>>ASSIGN   1564>>CALL     1565>>ASSIGN   1568>>CALL     1569>>ASSIGN
      1570>>ASSIGN   1571>>ASSIGN   1572>>ASSIGN   1573>>ASSIGN   1574>>ASSIGN   1575>>ASSIGN   1576>>ASSIGN
      1578>>ASSIGN   1580>>ASSIGN   1581>>ASSIGN   1583<<ASSIGN   1583>>ASSIGN   1588<<ASSIGN   1597>>ASSIGN
      1598>>CALL     1599>>ASSIGN   1601>>ASSIGN   1607>>IF       1608>>ASSIGN   1609>>ASSIGN   1614<<ASSIGN
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:314  
      1614>>ASSIGN   1619<<ASSIGN   1621>>ASSIGN   1622>>CALL     1623>>ASSIGN   1625>>ASSIGN   1628>>ASSIGN
      1630<<ASSIGN   1630>>ASSIGN
K
      1295**DCL      1577<<DOINDEX  1578>>ASSIGN   1578>>ASSIGN   1605<<DOINDEX  1607>>IF       1609>>ASSIGN
L
      1296**DCL      1606<<DOINDEX  1607>>IF       1608>>ASSIGN
L1
      1550**LABEL    1547--CALLALT
L2
      1567**LABEL    1563--CALLALT
L3
      1605**LABEL    1600--CALLALT
L4
      1627**LABEL    1624--CALLALT
M$GDS
        54**DCL-ENT  1536--CALL     1642--CALL
MPC
      1325**DCL      1564--CALL     1565<<ASSIGN   1568--CALL     1569<<ASSIGN
MPC.CONNECTS
      1327**DCL      1581<<ASSIGN
MPC.COUNT
      1326**DCL      1580<<ASSIGN
MPC.CRPFWNAME
      1342**DCL      1576<<ASSIGN
MPC.DEVNAME
      1343**DCL      1578<<ASSIGN
MPC.FLAGS
      1336**DCL      1573<<ASSIGN
MPC.FWNAME
      1340**DCL      1574<<ASSIGN
MPC.IOCHAN
      1329**DCL      1571<<ASSIGN
MPC.LPFWNAME
      1341**DCL      1575<<ASSIGN
MPC.MODEL
      1328**DCL      1570<<ASSIGN
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:315  
MPC.NUMDEVS
      1335**DCL      1572<<ASSIGN
MPC_TBL.DEVNAME
      1448**DCL      1562<<ASSIGN
MPC_TBL.PTR$
      1449**DCL      1564<>CALL     1565>>ASSIGN   1568<>CALL     1569>>ASSIGN   1570>>ASSIGN   1571>>ASSIGN
      1572>>ASSIGN   1573>>ASSIGN   1574>>ASSIGN   1575>>ASSIGN   1576>>ASSIGN   1578>>ASSIGN   1580>>ASSIGN
      1581>>ASSIGN
MPC_TBL$
      1276**DCL      1447--IMP-PTR  1559<>CALL     1562>>ASSIGN   1564>>CALL     1565>>ASSIGN   1568>>CALL
      1569>>ASSIGN   1570>>ASSIGN   1571>>ASSIGN   1572>>ASSIGN   1573>>ASSIGN   1574>>ASSIGN   1575>>ASSIGN
      1576>>ASSIGN   1578>>ASSIGN   1580>>ASSIGN   1581>>ASSIGN
NO_MEM
      1628**LABEL    1536--CALLALT  1540--CALLALT  1545--CALLALT  1553--CALLALT  1559--CALLALT  1564--CALLALT
      1568--CALLALT  1587--CALLALT  1598--CALLALT  1618--CALLALT  1622--CALLALT
NUM_DEVS
      1283**DCL      1618>>CALL     1620>>DOINDEX
NUM_IOMS
      1280**DCL      1540>>CALL     1541>>DOINDEX  1605>>DOINDEX
NUM_MPCS
      1281**DCL      1559>>CALL     1561>>DOINDEX
PTR$ IN PROCEDURE GETBLK
      1638**DCL      1636--PROC     1644<<ASSIGN
SIZE IN PROCEDURE GETBLK
      1639**DCL      1636--PROC     1641>>DOWHILE  1645>>ASSIGN
TABLE$
      1299**DCL      1537<<ASSIGN   1641>>DOWHILE  1644>>ASSIGN   1645<<ASSIGN   1645>>ASSIGN
TABLESEG
      1285**DCL      1527--DCLINIT
TABLESEG.BOUND
      1286**DCL      1641>>DOWHILE
TABLESEG.PTR$
      1288**DCL      1535>>IF       1537>>ASSIGN   1641>>DOWHILE
TBL
      1289**DCL      1540--CALL     1559--CALL     1587--CALL     1618--CALL
TD$DEV
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:316  
      1493**DCL      1628>>ASSIGN
TD$IOM
      1485**DCL      1551>>ASSIGN
TD$MPC.CRPFWNAME
      1478**DCL      1576>>ASSIGN
TD$MPC.DEVNAME
      1482**DCL      1578>>ASSIGN
TD$MPC.FLAGS
      1472**DCL      1573>>ASSIGN
TD$MPC.FWNAME
      1476**DCL      1574>>ASSIGN
TD$MPC.IOCHAN
      1465**DCL      1571>>ASSIGN
TD$MPC.LPFWNAME
      1477**DCL      1575>>ASSIGN
TD$MPC.MODEL
      1464**DCL      1570>>ASSIGN
TD$MPC.NUMDEVS
      1471**DCL      1568>>CALL     1572>>ASSIGN   1577>>DOINDEX
TD_HEAD
      1233**DCL         7--PROC
TD_HEAD.DEVNAME
      1266**DCL      1562>>ASSIGN   1563<>CALL     1567<>CALL     1621>>ASSIGN   1624<>CALL     1627<>CALL
TD_HEAD.LP_INDX
      1250**DCL      1620>>DOINDEX  1620>>DOINDEX
TD_HEAD.UNITMPC_INDX
      1236**DCL      1561>>DOINDEX  1561>>DOINDEX
TH$DEV
      1403**DCL      1625>>ASSIGN
TH$FEP
      1435**DCL      1601>>ASSIGN
TH$IOM
      1424**DCL      1548>>ASSIGN
TH$MPC
      1382**DCL      1565>>ASSIGN
TH$MPC.NUMDEVS
PL6.E3A0      #004=THE$INIT File=THE$ELAN.:E05TSI                                WED 07/30/97 06:11 Page:317  
      1392**DCL      1564>>CALL
THG$GETREC
      1270**DCL-ENT  1547--CALL     1550--CALL     1563--CALL     1567--CALL     1600--CALL     1624--CALL
      1627--CALL
TH_CONSTRAINTS.E_BY_B
       298**DCL       298--REDEF
TH_CONSTRAINTS.M_BY_B
       297**DCL       297--REDEF
TH_CONSTRAINTS.TYPES
       295**DCL       295--REDEF
TH_DEFAULT.E_BY_B
       306**DCL       306--REDEF
TH_DEFAULT.M_BY_B
       305**DCL       305--REDEF
TH_DEFAULT.TYPES
       303**DCL       303--REDEF
TH_RECORD.PTR$
       323**DCL      1382--IMP-PTR  1403--IMP-PTR  1424--IMP-PTR  1435--IMP-PTR  1463--IMP-PTR  1485--IMP-PTR
      1493--IMP-PTR  1548>>ASSIGN   1551>>ASSIGN   1564>>CALL     1565>>ASSIGN   1568>>CALL     1570>>ASSIGN
      1571>>ASSIGN   1572>>ASSIGN   1573>>ASSIGN   1574>>ASSIGN   1575>>ASSIGN   1576>>ASSIGN   1577>>DOINDEX
      1578>>ASSIGN   1601>>ASSIGN   1625>>ASSIGN   1628>>ASSIGN
TH_SAVE.E_BY_B
       314**DCL       314--REDEF
TH_SAVE.M_BY_B
       312**DCL       312--REDEF
TH_SAVE.TYPES
       310**DCL       311--REDEF
TH_XSA_BUF_VECTOR
       330**DCL       330--REDEF
UTS
      1300**DCL      1547<>CALL     1563<>CALL     1600<>CALL     1624<>CALL

PL6.E3A0      #005=THE$BREAK File=THE$ELAN.:E05TSI                               WED 07/30/97 06:12 Page:318  
     1653        1        /*M* THE$BREAK - BREAK CONTROL FOR ELAN */
     1654        2        /*T***********************************************************/
     1655        3        /*T*                                                         */
     1656        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1657        5        /*T*                                                         */
     1658        6        /*T***********************************************************/
     1659        7        THE$BREAK: PROC;
     1660        8        /**/
     1661        9        /* INCLUDE FILES */
     1662       10        %INCLUDE CP_6;
     1663       91        %INCLUDE TH_DATA_R;
     1664      169        /**/
     1665      170        /**/
     1666      171        /* ENTRY DEFS */
     1667      172    1   DCL THG$CLOSEXSA ENTRY ALTRET;
     1668      173        %EJECT;
PL6.E3A0      #005=THE$BREAK File=THE$ELAN.:E05TSI                               WED 07/30/97 06:12 Page:319  
     1669      174    1        TH_CONSTRAINTS = TH_SAVE;
     1670      175    1        TH_NUM_REP_DEVS = 0;
     1671      176    1        TH_REP_DEVS = '0'B;
     1672      177    1        TH_LASTTYPE = -1;
     1673      178    1        TH_LAST_DEVTYPE = ' ';
     1674      179    1        CALL THG$CLOSEXSA;
     1675      180    1        UNWIND TO TH_ERR_RETURN;
     1676      181    1   END THE$BREAK;
     1677      182        %EOD;

PL6.E3A0      #005=THE$BREAK File=THE$ELAN.:E05TSI                               WED 07/30/97 06:12 Page:320  
--  Include file information  --

   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THE$BREAK.

   Procedure THE$BREAK requires 20 words for executable code.
   Procedure THE$BREAK requires 4 words of local(AUTO) storage.

PL6.E3A0      #005=THE$BREAK File=THE$ELAN.:E05TSI                               WED 07/30/97 06:12 Page:321  

 Object Unit name= THE$BREAK                                  File name= THE$ELAN.:E05TOU
 UTS= JUL 30 '97 06:12:29.76 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none    20     24  THE$BREAK

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        0  THE$BREAK

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 THG$CLOSEXSA
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUNWIND

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TH_CONSTRAINTS                        TH_SAVE
     TH_ERR_RETURN                         TH_NUM_REP_DEVS                       TH_REP_DEVS
     TH_LASTTYPE                           TH_LAST_DEVTYPE                       TH_XSA_BUF_VECTOR
     B_VECTNIL
PL6.E3A0      #005=THE$BREAK File=THE$ELAN.:E05TSI                               WED 07/30/97 06:12 Page:322  


     1653        1        /*M* THE$BREAK - BREAK CONTROL FOR ELAN */
     1654        2        /*T***********************************************************/
     1655        3        /*T*                                                         */
     1656        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1657        5        /*T*                                                         */
     1658        6        /*T***********************************************************/
     1659        7        THE$BREAK: PROC;

      7  1 000000   000000 700200 xent  THE$BREAK    TSX0  ! X66_AUTO_0
         1 000001   000004 000000                    ZERO    4,0

     1660        8        /**/
     1661        9        /* INCLUDE FILES */
     1662       10        %INCLUDE CP_6;
     1663       91        %INCLUDE TH_DATA_R;
     1664      169        /**/
     1665      170        /**/
     1666      171        /* ENTRY DEFS */
     1667      172    1   DCL THG$CLOSEXSA ENTRY ALTRET;
     1668      173        %EJECT;
PL6.E3A0      #005=THE$BREAK File=THE$ELAN.:E05TSI                               WED 07/30/97 06:12 Page:323  
     1669      174    1        TH_CONSTRAINTS = TH_SAVE;

    174  1 000002   000000 100400                    MLR     fill='000'O
         1 000003   000000 000333 xsym               ADSC9   TH_SAVE                  cn=0,n=219
         1 000004   000000 000333 xsym               ADSC9   TH_CONSTRAINTS           cn=0,n=219

     1670      175    1        TH_NUM_REP_DEVS = 0;

    175  1 000005   000000 450000 xsym               STZ     TH_NUM_REP_DEVS

     1671      176    1        TH_REP_DEVS = '0'B;

    176  1 000006   010000 220003                    LDX0    4096,DU
         1 000007   000040 100400                    MLR     fill='000'O
         1 000010   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000011   000000 000010 xsym               ADSC9   TH_REP_DEVS              cn=0,n=*X0

     1672      177    1        TH_LASTTYPE = -1;

    177  1 000012   000001 335007                    LCA     1,DL
         1 000013   000000 755000 xsym               STA     TH_LASTTYPE

     1673      178    1        TH_LAST_DEVTYPE = ' ';

    178  1 000014   040040 221003                    LDX1    16416,DU
         1 000015   000000 741000 xsym               STX1    TH_LAST_DEVTYPE

     1674      179    1        CALL THG$CLOSEXSA;

    179  1 000016   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000017   000000 701000 xent               TSX1    THG$CLOSEXSA
         1 000020   000000 011000                    NOP     0

     1675      180    1        UNWIND TO TH_ERR_RETURN;

    180  1 000021   000000 237200 xsym               LDAQ  ! TH_ERR_RETURN
         1 000022   000000 700200 xent               TSX0  ! X66_AUNWIND
PL6.E3A0      #005=THE$BREAK File=THE$ELAN.:E05TSI                               WED 07/30/97 06:12 Page:324  
         1 000023   000000 000200                    ZERO    0,128
     1676      181    1   END THE$BREAK;
     1677      182        %EOD;

PL6.E3A0      #005=THE$BREAK File=THE$ELAN.:E05TSI                               WED 07/30/97 06:12 Page:325  
--  Include file information  --

   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THE$BREAK.
PL6.E3A0      #005=THE$BREAK File=THE$ELAN.:E05TSI                               WED 07/30/97 06:12 Page:326  

 **** Variables and constants ****

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(1971)  r     1 TH_CONSTRAINTS             0-0-0/d REMB        r     1 TH_ERR_RETURN
     0-0-0/w SBIN        r     1 TH_LASTTYPE                0-0-0/w CHAR(2)     r     1 TH_LAST_DEVTYPE
     0-0-0/w UBIN        r     1 TH_NUM_REP_DEVS
     0-0-0/w CHAR(8)     r     1 TH_REP_DEVS(0:511)
     0-0-0/d STRC(1971)  r     1 TH_SAVE


   Procedure THE$BREAK requires 20 words for executable code.
   Procedure THE$BREAK requires 4 words of local(AUTO) storage.
PL6.E3A0      #005=THE$BREAK File=THE$ELAN.:E05TSI                               WED 07/30/97 06:12 Page:327  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=THE$BREAK File=THE$ELAN.:E05TSI                               WED 07/30/97 06:12 Page:328  
          MINI XREF LISTING

THG$CLOSEXSA
       172**DCL-ENT   179--CALL
TH_CONSTRAINTS
        99**DCL       174<<ASSIGN
TH_CONSTRAINTS.E_BY_B
       102**DCL       102--REDEF
TH_CONSTRAINTS.M_BY_B
       101**DCL       101--REDEF
TH_CONSTRAINTS.TYPES
        99**DCL        99--REDEF
TH_DEFAULT.E_BY_B
       110**DCL       110--REDEF
TH_DEFAULT.M_BY_B
       109**DCL       109--REDEF
TH_DEFAULT.TYPES
       107**DCL       107--REDEF
TH_ERR_RETURN
       122**DCL       180>>UNWIND
TH_LASTTYPE
       129**DCL       177<<ASSIGN
TH_LAST_DEVTYPE
       131**DCL       178<<ASSIGN
TH_NUM_REP_DEVS
       124**DCL       175<<ASSIGN
TH_REP_DEVS
       125**DCL       176<<ASSIGN
TH_SAVE
       114**DCL       174>>ASSIGN
TH_SAVE.E_BY_B
       118**DCL       118--REDEF
TH_SAVE.M_BY_B
       116**DCL       116--REDEF
PL6.E3A0      #005=THE$BREAK File=THE$ELAN.:E05TSI                               WED 07/30/97 06:12 Page:329  
TH_SAVE.TYPES
       114**DCL       115--REDEF
TH_XSA_BUF_VECTOR
       134**DCL       134--REDEF

PL6.E3A0      #006=THE$BRKMSG File=THE$ELAN.:E05TSI                              WED 07/30/97 06:12 Page:330  
     1678        1        /*T***********************************************************/
     1679        2        /*T*                                                         */
     1680        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1681        4        /*T*                                                         */
     1682        5        /*T***********************************************************/
     1683        6        THE$BRKMSG:PROC;
     1684        7        %INCLUDE CP_6;
     1685       88        %INCLUDE TH_DATA_R;
     1686      166    1   DCL M$LO DCB;
     1687      167    1   DCL MSGBUF CHAR(80) STATIC INIT(' ');
     1688      168        %FPT_TIME
     1689      169               (FPTN=CUR_TIME,
     1690      170                SOURCE=CLOCK,
     1691      171                DEST=EXT,
     1692      172                DATE=TH_DATE,
     1693      173                TIME=TH_TIME);
     1694      192        %FPT_WRITE
     1695      193               (FPTN=RECORD_DATE,
     1696      194               DCB=M$LO,
     1697      195               BUF=MSGBUF,
     1698      196               WAIT=YES);
     1699      227        %EJECT;
PL6.E3A0      #006=THE$BRKMSG File=THE$ELAN.:E05TSI                              WED 07/30/97 06:12 Page:331  
     1700      228    1   IF NOT TH_BRKMSG
     1701      229    1      THEN
     1702      230    1         CALL M$TIME(CUR_TIME);
     1703      231    1   CALL CONCAT(MSGBUF,'Break at ',TH_TIME,' ',TH_DATE,'! C to continue.');
     1704      232    1   CALL M$WRITE(RECORD_DATE) ALTRET(DO_NOTHING);
     1705      233    1   DO_NOTHING:
     1706      234    1   END THE$BRKMSG;

PL6.E3A0      #006=THE$BRKMSG File=THE$ELAN.:E05TSI                              WED 07/30/97 06:12 Page:332  
--  Include file information  --

   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THE$BRKMSG.

   Procedure THE$BRKMSG requires 26 words for executable code.
   Procedure THE$BRKMSG requires 4 words of local(AUTO) storage.

    No errors detected in file THE$ELAN.:E05TSI    .

PL6.E3A0      #006=THE$BRKMSG File=THE$ELAN.:E05TSI                              WED 07/30/97 06:12 Page:333  

 Object Unit name= THE$BRKMSG                                 File name= THE$ELAN.:E05TOU
 UTS= JUL 30 '97 06:12:39.08 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2   Data  even  none    44     54  THE$BRKMSG
    3  RoData even  UTS      7      7  THE$BRKMSG
    4   Proc  even  none    26     32  THE$BRKMSG

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        0  THE$BRKMSG

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TH_BRKMSG                             TH_DATE
     TH_TIME                               TH_XSA_BUF_VECTOR                     M$LO
PL6.E3A0      #006=THE$BRKMSG File=THE$ELAN.:E05TSI                              WED 07/30/97 06:12 Page:334  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #006=THE$BRKMSG File=THE$ELAN.:E05TSI                              WED 07/30/97 06:12 Page:335  


     1678        1        /*T***********************************************************/
     1679        2        /*T*                                                         */
     1680        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1681        4        /*T*                                                         */
     1682        5        /*T***********************************************************/
     1683        6        THE$BRKMSG:PROC;

      6  4 000000   000000 700200 xent  THE$BRKMSG   TSX0  ! X66_AUTO_0
         4 000001   000004 000000                    ZERO    4,0

     1684        7        %INCLUDE CP_6;
     1685       88        %INCLUDE TH_DATA_R;
     1686      166    1   DCL M$LO DCB;
     1687      167    1   DCL MSGBUF CHAR(80) STATIC INIT(' ');
     1688      168        %FPT_TIME
     1689      169               (FPTN=CUR_TIME,
     1690      170                SOURCE=CLOCK,
     1691      171                DEST=EXT,
     1692      172                DATE=TH_DATE,
     1693      173                TIME=TH_TIME);
     1694      192        %FPT_WRITE
     1695      193               (FPTN=RECORD_DATE,
     1696      194               DCB=M$LO,
     1697      195               BUF=MSGBUF,
     1698      196               WAIT=YES);
     1699      227        %EJECT;
PL6.E3A0      #006=THE$BRKMSG File=THE$ELAN.:E05TSI                              WED 07/30/97 06:12 Page:336  
     1700      228    1   IF NOT TH_BRKMSG

    228  4 000002   000000 234000 xsym               SZN     TH_BRKMSG
         4 000003   000007 604000 4                  TMI     s:231

     1701      229    1      THEN
     1702      230    1         CALL M$TIME(CUR_TIME);

    230  4 000004   000024 630400 2                  EPPR0   CUR_TIME
         4 000005   020004 713400                    CLIMB   8196
         4 000006   402000 401760                    pmme    nvectors=5

     1703      231    1   CALL CONCAT(MSGBUF,'Break at ',TH_TIME,' ',TH_DATE,'! C to continue.');

    231  4 000007   040000 100400                    MLR     fill='040'O
         4 000010   000000 000011 3                  ADSC9   0                        cn=0,n=9
         4 000011   000000 000011 2                  ADSC9   MSGBUF                   cn=0,n=9
         4 000012   040000 100400                    MLR     fill='040'O
         4 000013   000000 000013 xsym               ADSC9   TH_TIME                  cn=0,n=11
         4 000014   000002 200013 2                  ADSC9   MSGBUF+2                 cn=1,n=11
         4 000015   040000 236003                    LDQ     16384,DU
         4 000016   000005 756000 2                  STQ     MSGBUF+5
         4 000017   040000 100400                    MLR     fill='040'O
         4 000020   000000 000012 xsym               ADSC9   TH_DATE                  cn=0,n=10
         4 000021   000005 200012 2                  ADSC9   MSGBUF+5                 cn=1,n=10
         4 000022   040000 100400                    MLR     fill='040'O
         4 000023   000003 000020 3                  ADSC9   3                        cn=0,n=16
         4 000024   000007 600061 2                  ADSC9   MSGBUF+7                 cn=3,n=49

     1704      232    1   CALL M$WRITE(RECORD_DATE) ALTRET(DO_NOTHING);

    232  4 000025   000040 630400 2                  EPPR0   RECORD_DATE
         4 000026   440001 713400                    CLIMB   alt,write
         4 000027   401400 401760                    pmme    nvectors=4
         4 000030   000031 702000 4                  TSX2    DO_NOTHING

     1705      233    1   DO_NOTHING:
PL6.E3A0      #006=THE$BRKMSG File=THE$ELAN.:E05TSI                              WED 07/30/97 06:12 Page:337  
     1706      234    1   END THE$BRKMSG;

    234  4 000031                       DO_NOTHING   null
    234  4 000031   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #006=THE$BRKMSG File=THE$ELAN.:E05TSI                              WED 07/30/97 06:12 Page:338  
--  Include file information  --

   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THE$BRKMSG.
PL6.E3A0      #006=THE$BRKMSG File=THE$ELAN.:E05TSI                              WED 07/30/97 06:12 Page:339  

 **** Variables and constants ****

  ****  Section 002  Data  THE$BRKMSG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    24-0-0/d STRC(432)   r     1 CUR_TIME                   0-0-0/c CHAR(80)    r     1 MSGBUF
    40-0-0/d STRC(432)   r     1 RECORD_DATE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 TH_BRKMSG                  0-0-0/c CHAR(10)    r     1 TH_DATE
     0-0-0/c CHAR(11)    r     1 TH_TIME

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0N  NULL        r     1 M$LO


   Procedure THE$BRKMSG requires 26 words for executable code.
   Procedure THE$BRKMSG requires 4 words of local(AUTO) storage.

    No errors detected in file THE$ELAN.:E05TSI    .
PL6.E3A0      #006=THE$BRKMSG File=THE$ELAN.:E05TSI                              WED 07/30/97 06:12 Page:340  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #006=THE$BRKMSG File=THE$ELAN.:E05TSI                              WED 07/30/97 06:12 Page:341  
          MINI XREF LISTING

CUR_TIME
       184**DCL       230<>CALL
CUR_TIME.V
       188**DCL       184--DCLINIT
DO_NOTHING
       234**LABEL     232--CALLALT
M$TIME
        83**DCL-ENT   230--CALL
M$WRITE
        17**DCL-ENT   232--CALL
MSGBUF
       167**DCL       214--DCLINIT   215--DCLINIT   231<<CALLBLT
RECORD_DATE
       213**DCL       232<>CALL
RECORD_DATE.STATION_
       215**DCL       215--REDEF
RECORD_DATE.V
       216**DCL       213--DCLINIT
RECORD_DATE.V.DVBYTE.VFC#
       222**DCL       222--REDEF
TH_BRKMSG
       120**DCL       228>>IF
TH_CONSTRAINTS.E_BY_B
        99**DCL        99--REDEF
TH_CONSTRAINTS.M_BY_B
        98**DCL        98--REDEF
TH_CONSTRAINTS.TYPES
        96**DCL        96--REDEF
TH_DATE
       127**DCL       184--DCLINIT   185--DCLINIT   231>>CALLBLT
TH_DEFAULT.E_BY_B
       107**DCL       107--REDEF
PL6.E3A0      #006=THE$BRKMSG File=THE$ELAN.:E05TSI                              WED 07/30/97 06:12 Page:342  
TH_DEFAULT.M_BY_B
       106**DCL       106--REDEF
TH_DEFAULT.TYPES
       104**DCL       104--REDEF
TH_SAVE.E_BY_B
       115**DCL       115--REDEF
TH_SAVE.M_BY_B
       113**DCL       113--REDEF
TH_SAVE.TYPES
       111**DCL       112--REDEF
TH_TIME
       127**DCL       186--DCLINIT   187--DCLINIT   231>>CALLBLT
TH_XSA_BUF_VECTOR
       131**DCL       131--REDEF
