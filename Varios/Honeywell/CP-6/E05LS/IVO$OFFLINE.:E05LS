VERSION E05

PL6.E3A0      #001=IVO$FINDDVT File=IVO$OFFLINE.:E05TSI                          TUE 07/29/97 23:12 Page:1    
        1        1        /*M* Off-Line Version of VOLINIT Subroutines */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR */
        8        8        /**/
        9        9        /* FIND DVT FOR THIS DEVICE */
       10       10        /**/
       11       11        IVO$FINDDVT: PROC (VIP,DVT$) ALTRET;
       12       12        /**/
       13       13        /* INCLUDE FILES */
       14       14        /**/
       15       15        %INCLUDE IV$MACROS;
       16      185        %INCLUDE NI_DATA_C;
       17      298        %INCLUDE NI_DATA_R;
       18      735        %INCLUDE IV_SUBS_C;
       19      798        /**/
       20      799        /* PARAMETERS */
       21      800        /**/
       22      801        %IV$VIP(NAME=VIP,STCLASS="");
       23      865    1   DCL DVT$ PTR;
       24      866    1   DCL MPC_DVT$ PTR;
       25      867        /**/
       26      868        /* EXTERNAL REFERENCES */
       27      869        /**/
       28      870    1   DCL NK_MXLOCAL SBIN SYMREF;             /* DCTX OF LAST LOCAL DEVICE */
       29      871    1   DCL IT_CP6UP UBIN WORD SYMREF;
       30      872        /**/
       31      873        /* DATA STRUCTURES */
       32      874        /**/
       33      875        %NI$DCT(NAME=DCT,STCLASS="BASED(DCT$)");
       34      923        %NI$DVT(NAME=DVT,STCLASS="BASED(DVT$)");
       35      930        %NI$DVT(NAME=MPC_DVT,STCLASS="BASED(MPC_DVT$)");
       36      937        %NI$SQH(NAME=SQH,STCLASS="BASED(SQH$)");
       37      950        %NI$PARTITION (NAME=IT_PARTITION, STCLASS=SYMREF);
PL6.E3A0      #001=IVO$FINDDVT File=IVO$OFFLINE.:E05TSI                          TUE 07/29/97 23:12 Page:2    
       38      958        /**/
       39      959        /* AUTO STACK */
       40      960        /**/
       41      961    1   DCL I SBIN;
       42      962    1   DCL DCT$ PTR;
       43      963    1   DCL SQH$ PTR;
       44      964        /**/
       45      965        /* FIND DCT FOR DISK DRIVE */
       46      966        /**/
       47      967    2           DO I=1 TO NK_MXLOCAL;
       48      968    2              IF N$DCT$(I)~=ADDR(NIL) THEN
       49      969    2                 DCT$=N$DCT$(I);
       50      970    3              IF VIP.DEVID=SUBSTR(N$DCT$(I)->DCT.DEVNM,0,4) THEN DO;
       51      971    3                 VIP.DCTX=I;
       52      972    3                 DVT$=N$DCT$(I)->DCT.DVT$;
       53      973    3                 IF DVT.TYPE~=%DV_DP THEN ALTRETURN; /* DEVICE NOT DISK!?!?!? */
       54      974    3                 VIP.MODEL=DVT.MODEL(DCT.MODX);
       55      975    3                 VIP.DVN = DCT.DVN;
       56      976    3                 SQH$ = DCT.SQH$;
       57      977    3                 DCT$ = SQH.MPC$(0);
       58      978    3                 IF DCT.STATUS.DOWN
       59      979    3                   OR (IT_CP6UP = 0 AND IT_PARTITION.DEVICE(DCT.DCTX))
       60      980    4                 THEN DO;
       61      981    4                    DCT$ = SQH.MPC$(1);
       62      982    4                    IF (DCT$ = ADDR(NIL) OR DCT.STATUS.DOWN
       63      983    4                      OR (IT_CP6UP = 0 AND IT_PARTITION.DEVICE(DCT.DCTX)))
       64      984    4                    THEN ALTRETURN;
       65      985    4                    END;
       66      986    3                 VIP.MPC_DCTX = DCT.DCTX;  /* DCTX OF MPC */
       67      987    3                 MPC_DVT$ = DCT.DVT$;
       68      988    4                 DO SELECT (MPC_DVT.MODEL(DCT.MODX));
       69      989    4                    SELECT ( 'MSP8021 ', 'MSP8022 ', 'MSP8023 ' );
       70      990    4                    VIP.MPC_TYPE = #DAU;
       71      991    4                    SELECT ( 'MSP3881 ', 'MSP3885 ', 'MSP3882 ',
       72      992    4                      'MSP3886 ', 'MSP3991 ', 'MSP3993 ',
       73      993    4                      'MSP3992 ', 'MSP3994 ' );
       74      994    4                    VIP.MPC_TYPE = #FIPS;
PL6.E3A0      #001=IVO$FINDDVT File=IVO$OFFLINE.:E05TSI                          TUE 07/29/97 23:12 Page:3    
       75      995    4                    SELECT ( 'MSS8080 ', 'MSS8090 ', 'MSP8080 ', 'MSP8090 ' );
       76      996    4                    VIP.MPC_TYPE = #MDS;
       77      997    4                    SELECT (ELSE);
       78      998    4                 VIP.MPC_TYPE = #MPC;
       79      999    4                    END;                   /* DO SELECT */
       80     1000    3              RETURN;
       81     1001    3                 END;
       82     1002    2              END/* DO I */;
       83     1003    1           ALTRETURN;                      /* DISK NOT FOUND */
       84     1004    1   END IVO$FINDDVT;
       85     1005        %EOD;

PL6.E3A0      #001=IVO$FINDDVT File=IVO$OFFLINE.:E05TSI                          TUE 07/29/97 23:12 Page:4    
--  Include file information  --

   IV_SUBS_C.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   NI_DATA_C.:E05TOU  is referenced.
   IV$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure IVO$FINDDVT.

   Procedure IVO$FINDDVT requires 250 words for executable code.
   Procedure IVO$FINDDVT requires 10 words of local(AUTO) storage.

PL6.E3A0      #001=IVO$FINDDVT File=IVO$OFFLINE.:E05TSI                          TUE 07/29/97 23:12 Page:5    

 Object Unit name= IVO$FINDDVT                                File name= IVO$OFFLINE.:E05TOU
 UTS= JUL 29 '97 23:12:31.96 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     30     36  IVO$FINDDVT
    1   Proc  even  none   250    372  IVO$FINDDVT
    2  RoData even  none     1      1  IVO$FINDDVT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        2  IVO$FINDDVT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     N$DCT$$                               N$FQ$                                 NI$FQ$
     NI$IBUF$                              NI$RP$                                NK_MXLOCAL
     IT_CP6UP                              IT_PARTITION                          B_VECTNIL
PL6.E3A0      #001=IVO$FINDDVT File=IVO$OFFLINE.:E05TSI                          TUE 07/29/97 23:12 Page:6    


        1        1        /*M* Off-Line Version of VOLINIT Subroutines */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR */
        8        8        /**/
        9        9        /* FIND DVT FOR THIS DEVICE */
       10       10        /**/
       11       11        IVO$FINDDVT: PROC (VIP,DVT$) ALTRET;

     11  1 000000   000000 700200 xent  IVO$FINDDVT  TSX0  ! X66_AUTO_2
         1 000001   000012 000002                    ZERO    10,2

       12       12        /**/
       13       13        /* INCLUDE FILES */
       14       14        /**/
       15       15        %INCLUDE IV$MACROS;
       16      185        %INCLUDE NI_DATA_C;
       17      298        %INCLUDE NI_DATA_R;
       18      735        %INCLUDE IV_SUBS_C;
       19      798        /**/
       20      799        /* PARAMETERS */
       21      800        /**/
       22      801        %IV$VIP(NAME=VIP,STCLASS="");
       23      865    1   DCL DVT$ PTR;
       24      866    1   DCL MPC_DVT$ PTR;
       25      867        /**/
       26      868        /* EXTERNAL REFERENCES */
       27      869        /**/
       28      870    1   DCL NK_MXLOCAL SBIN SYMREF;             /* DCTX OF LAST LOCAL DEVICE */
       29      871    1   DCL IT_CP6UP UBIN WORD SYMREF;
       30      872        /**/
       31      873        /* DATA STRUCTURES */
       32      874        /**/
PL6.E3A0      #001=IVO$FINDDVT File=IVO$OFFLINE.:E05TSI                          TUE 07/29/97 23:12 Page:7    
       33      875        %NI$DCT(NAME=DCT,STCLASS="BASED(DCT$)");
       34      923        %NI$DVT(NAME=DVT,STCLASS="BASED(DVT$)");
       35      930        %NI$DVT(NAME=MPC_DVT,STCLASS="BASED(MPC_DVT$)");
       36      937        %NI$SQH(NAME=SQH,STCLASS="BASED(SQH$)");
       37      950        %NI$PARTITION (NAME=IT_PARTITION, STCLASS=SYMREF);
       38      958        /**/
       39      959        /* AUTO STACK */
       40      960        /**/
       41      961    1   DCL I SBIN;
       42      962    1   DCL DCT$ PTR;
       43      963    1   DCL SQH$ PTR;
       44      964        /**/
       45      965        /* FIND DCT FOR DISK DRIVE */
       46      966        /**/
       47      967    2           DO I=1 TO NK_MXLOCAL;

    967  1 000002   000001 235007                    LDA     1,DL
         1 000003   200006 755100                    STA     I,,AUTO
         1 000004   000366 710000 1                  TRA     s:1002+1

       48      968    2              IF N$DCT$(I)~=ADDR(NIL) THEN

    968  1 000005   000000 470400 xsym               LDP0    N$DCT$$
         1 000006   200006 720100                    LXL0    I,,AUTO
         1 000007   000000 236110                    LDQ     0,X0,PR0
         1 000010   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000011   000013 600000 1                  TZE     s:970

       49      969    2                 DCT$=N$DCT$(I);

    969  1 000012   200007 756100                    STQ     DCT$,,AUTO

       50      970    3              IF VIP.DEVID=SUBSTR(N$DCT$(I)->DCT.DEVNM,0,4) THEN DO;

    970  1 000013   000000 471510                    LDP1    0,X0,PR0
         1 000014   200003 473500                    LDP3    @VIP,,AUTO
         1 000015   040100 106500                    CMPC    fill='040'O
PL6.E3A0      #001=IVO$FINDDVT File=IVO$OFFLINE.:E05TSI                          TUE 07/29/97 23:12 Page:8    
         1 000016   300005 000010                    ADSC9   5,,PR3                   cn=0,n=8
         1 000017   100002 000004                    ADSC9   2,,PR1                   cn=0,n=4
         1 000020   000365 601000 1                  TNZ     s:1002

       51      971    3                 VIP.DCTX=I;

    971  1 000021   200006 236100                    LDQ     I,,AUTO
         1 000022   000025 736000                    QLS     21
         1 000023   300017 676100                    ERQ     15,,PR3
         1 000024   777770 376003                    ANQ     -8,DU
         1 000025   300017 656100                    ERSQ    15,,PR3

       52      972    3                 DVT$=N$DCT$(I)->DCT.DVT$;

    972  1 000026   000000 471510                    LDP1    0,X0,PR0
         1 000027   100024 236100                    LDQ     20,,PR1
         1 000030   200004 474500                    LDP4    @DVT$,,AUTO
         1 000031   400000 756100                    STQ     0,,PR4

       53      973    3                 IF DVT.TYPE~=%DV_DP THEN ALTRETURN; /* DEVICE NOT DISK!?!?!? */

    973  1 000032   400000 470500                    LDP0    0,,PR4
         1 000033   000053 236100                    LDQ     43,,PR0
         1 000034   777000 376003                    ANQ     -512,DU
         1 000035   006000 116003                    CMPQ    3072,DU
         1 000036   000040 600000 1                  TZE     s:974

    973  1 000037   000000 702200 xent               TSX2  ! X66_AALT

       54      974    3                 VIP.MODEL=DVT.MODEL(DCT.MODX);

    974  1 000040   200007 471500                    LDP1    DCT$,,AUTO
         1 000041   100007 236100                    LDQ     7,,PR1
         1 000042   000021 772000                    QRL     17
         1 000043   000176 376007                    ANQ     126,DL
         1 000044   000002 736000                    QLS     2
         1 000045   040100 100506                    MLR     fill='040'O
PL6.E3A0      #001=IVO$FINDDVT File=IVO$OFFLINE.:E05TSI                          TUE 07/29/97 23:12 Page:9    
         1 000046   000003 000010                    ADSC9   3,Q,PR0                  cn=0,n=8
         1 000047   300007 000010                    ADSC9   7,,PR3                   cn=0,n=8

       55      975    3                 VIP.DVN = DCT.DVN;

    975  1 000050   100007 236100                    LDQ     7,,PR1
         1 000051   007700 376003                    ANQ     4032,DU
         1 000052   000003 736000                    QLS     3
         1 000053   300021 552140                    STBQ    17,'40'O,PR3

       56      976    3                 SQH$ = DCT.SQH$;

    976  1 000054   100022 236100                    LDQ     18,,PR1
         1 000055   200010 756100                    STQ     SQH$,,AUTO

       57      977    3                 DCT$ = SQH.MPC$(0);

    977  1 000056   200010 470500                    LDP0    SQH$,,AUTO
         1 000057   000005 236100                    LDQ     5,,PR0
         1 000060   200007 756100                    STQ     DCT$,,AUTO

       58      978    3                 IF DCT.STATUS.DOWN

    978  1 000061   200007 471500                    LDP1    DCT$,,AUTO
         1 000062   100027 234100                    SZN     23,,PR1
         1 000063   000074 604000 1                  TMI     s:981
         1 000064   000000 235000 xsym               LDA     IT_CP6UP
         1 000065   000114 601000 1                  TNZ     s:986
         1 000066   100006 236100                    LDQ     6,,PR1
         1 000067   000025 772000                    QRL     21
         1 000070   000000 066406                    CMPB    filb='0'B
         1 000071   000000 000001 xsym               BDSC    IT_PARTITION,Q           by=0,bit=0,n=1
         1 000072   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 000073   000114 600000 1                  TZE     s:986

       59      979    3                   OR (IT_CP6UP = 0 AND IT_PARTITION.DEVICE(DCT.DCTX))
       60      980    4                 THEN DO;
PL6.E3A0      #001=IVO$FINDDVT File=IVO$OFFLINE.:E05TSI                          TUE 07/29/97 23:12 Page:10   

       61      981    4                    DCT$ = SQH.MPC$(1);

    981  1 000074   000006 236100                    LDQ     6,,PR0
         1 000075   200007 756100                    STQ     DCT$,,AUTO

       62      982    4                    IF (DCT$ = ADDR(NIL) OR DCT.STATUS.DOWN

    982  1 000076   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000077   000113 600000 1                  TZE     s:984
         1 000100   200007 471500                    LDP1    DCT$,,AUTO
         1 000101   100027 234100                    SZN     23,,PR1
         1 000102   000113 604000 1                  TMI     s:984
         1 000103   000000 235000 xsym               LDA     IT_CP6UP
         1 000104   000114 601000 1                  TNZ     s:986
         1 000105   100006 236100                    LDQ     6,,PR1
         1 000106   000025 772000                    QRL     21
         1 000107   000000 066406                    CMPB    filb='0'B
         1 000110   000000 000001 xsym               BDSC    IT_PARTITION,Q           by=0,bit=0,n=1
         1 000111   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 000112   000114 600000 1                  TZE     s:986

       63      983    4                      OR (IT_CP6UP = 0 AND IT_PARTITION.DEVICE(DCT.DCTX)))
       64      984    4                    THEN ALTRETURN;

    984  1 000113   000000 702200 xent               TSX2  ! X66_AALT

       65      985    4                    END;
       66      986    3                 VIP.MPC_DCTX = DCT.DCTX;  /* DCTX OF MPC */

    986  1 000114   100006 236100                    LDQ     6,,PR1
         1 000115   000011 772000                    QRL     9
         1 000116   300021 676100                    ERQ     17,,PR3
         1 000117   000000 376000 2                  ANQ     0
         1 000120   300021 656100                    ERSQ    17,,PR3

       67      987    3                 MPC_DVT$ = DCT.DVT$;
PL6.E3A0      #001=IVO$FINDDVT File=IVO$OFFLINE.:E05TSI                          TUE 07/29/97 23:12 Page:11   

    987  1 000121   100024 236100                    LDQ     20,,PR1
         1 000122   200005 756100                    STQ     MPC_DVT$,,AUTO

       68      988    4                 DO SELECT (MPC_DVT.MODEL(DCT.MODX));

    988  1 000123   100007 236100                    LDQ     7,,PR1
         1 000124   000021 772000                    QRL     17
         1 000125   000176 376007                    ANQ     126,DL
         1 000126   000000 621006                    EAX1    0,QL
         1 000127   000002 736000                    QLS     2
         1 000130   200005 475500                    LDP5    MPC_DVT$,,AUTO
         1 000131   040000 106506                    CMPC    fill='040'O
         1 000132   500003 000010                    ADSC9   3,Q,PR5                  cn=0,n=8
         1 000133   000000 000010 0                  ADSC9   0                        cn=0,n=8
         1 000134   000303 602000 1                  TNC     s:988+112
         1 000135   000000 636011                    EAQ     0,X1
         1 000136   000020 772000                    QRL     16
         1 000137   040000 106506                    CMPC    fill='040'O
         1 000140   500003 000010                    ADSC9   3,Q,PR5                  cn=0,n=8
         1 000141   000000 000010 0                  ADSC9   0                        cn=0,n=8
         1 000142   000354 600000 1                  TZE     s:994
         1 000143   000000 636011                    EAQ     0,X1
         1 000144   000020 772000                    QRL     16
         1 000145   040000 106506                    CMPC    fill='040'O
         1 000146   500003 000010                    ADSC9   3,Q,PR5                  cn=0,n=8
         1 000147   000002 000010 0                  ADSC9   2                        cn=0,n=8
         1 000150   000251 602000 1                  TNC     s:988+86
         1 000151   000000 636011                    EAQ     0,X1
         1 000152   000020 772000                    QRL     16
         1 000153   040000 106506                    CMPC    fill='040'O
         1 000154   500003 000010                    ADSC9   3,Q,PR5                  cn=0,n=8
         1 000155   000002 000010 0                  ADSC9   2                        cn=0,n=8
         1 000156   000351 600000 1                  TZE     s:990
         1 000157   000000 636011                    EAQ     0,X1
         1 000160   000020 772000                    QRL     16
         1 000161   040000 106506                    CMPC    fill='040'O
PL6.E3A0      #001=IVO$FINDDVT File=IVO$OFFLINE.:E05TSI                          TUE 07/29/97 23:12 Page:12   
         1 000162   500003 000010                    ADSC9   3,Q,PR5                  cn=0,n=8
         1 000163   000004 000010 0                  ADSC9   4                        cn=0,n=8
         1 000164   000225 602000 1                  TNC     s:988+66
         1 000165   000000 636011                    EAQ     0,X1
         1 000166   000020 772000                    QRL     16
         1 000167   040000 106506                    CMPC    fill='040'O
         1 000170   500003 000010                    ADSC9   3,Q,PR5                  cn=0,n=8
         1 000171   000004 000010 0                  ADSC9   4                        cn=0,n=8
         1 000172   000357 600000 1                  TZE     s:996
         1 000173   000000 636011                    EAQ     0,X1
         1 000174   000020 772000                    QRL     16
         1 000175   040000 106506                    CMPC    fill='040'O
         1 000176   500003 000010                    ADSC9   3,Q,PR5                  cn=0,n=8
         1 000177   000006 000010 0                  ADSC9   6                        cn=0,n=8
         1 000200   000216 602000 1                  TNC     s:988+59
         1 000201   000000 636011                    EAQ     0,X1
         1 000202   000020 772000                    QRL     16
         1 000203   040000 106506                    CMPC    fill='040'O
         1 000204   500003 000010                    ADSC9   3,Q,PR5                  cn=0,n=8
         1 000205   000006 000010 0                  ADSC9   6                        cn=0,n=8
         1 000206   000357 600000 1                  TZE     s:996
         1 000207   000000 636011                    EAQ     0,X1
         1 000210   000020 772000                    QRL     16
         1 000211   040000 106506                    CMPC    fill='040'O
         1 000212   500003 000010                    ADSC9   3,Q,PR5                  cn=0,n=8
         1 000213   000010 000010 0                  ADSC9   8                        cn=0,n=8
         1 000214   000362 601000 1                  TNZ     s:998
         1 000215   000357 710000 1                  TRA     s:996
         1 000216   000000 636011                    EAQ     0,X1
         1 000217   000020 772000                    QRL     16
         1 000220   040000 106506                    CMPC    fill='040'O
         1 000221   500003 000010                    ADSC9   3,Q,PR5                  cn=0,n=8
         1 000222   000012 000010 0                  ADSC9   10                       cn=0,n=8
         1 000223   000362 601000 1                  TNZ     s:998
         1 000224   000357 710000 1                  TRA     s:996
         1 000225   000000 636011                    EAQ     0,X1
         1 000226   000020 772000                    QRL     16
PL6.E3A0      #001=IVO$FINDDVT File=IVO$OFFLINE.:E05TSI                          TUE 07/29/97 23:12 Page:13   
         1 000227   040000 106506                    CMPC    fill='040'O
         1 000230   500003 000010                    ADSC9   3,Q,PR5                  cn=0,n=8
         1 000231   000014 000010 0                  ADSC9   12                       cn=0,n=8
         1 000232   000242 602000 1                  TNC     s:988+79
         1 000233   000000 636011                    EAQ     0,X1
         1 000234   000020 772000                    QRL     16
         1 000235   040000 106506                    CMPC    fill='040'O
         1 000236   500003 000010                    ADSC9   3,Q,PR5                  cn=0,n=8
         1 000237   000014 000010 0                  ADSC9   12                       cn=0,n=8
         1 000240   000351 600000 1                  TZE     s:990
         1 000241   000362 710000 1                  TRA     s:998
         1 000242   000000 636011                    EAQ     0,X1
         1 000243   000020 772000                    QRL     16
         1 000244   040000 106506                    CMPC    fill='040'O
         1 000245   500003 000010                    ADSC9   3,Q,PR5                  cn=0,n=8
         1 000246   000016 000010 0                  ADSC9   14                       cn=0,n=8
         1 000247   000362 601000 1                  TNZ     s:998
         1 000250   000351 710000 1                  TRA     s:990
         1 000251   000000 636011                    EAQ     0,X1
         1 000252   000020 772000                    QRL     16
         1 000253   040000 106506                    CMPC    fill='040'O
         1 000254   500003 000010                    ADSC9   3,Q,PR5                  cn=0,n=8
         1 000255   000020 000010 0                  ADSC9   16                       cn=0,n=8
         1 000256   000274 602000 1                  TNC     s:988+105
         1 000257   000000 636011                    EAQ     0,X1
         1 000260   000020 772000                    QRL     16
         1 000261   040000 106506                    CMPC    fill='040'O
         1 000262   500003 000010                    ADSC9   3,Q,PR5                  cn=0,n=8
         1 000263   000020 000010 0                  ADSC9   16                       cn=0,n=8
         1 000264   000354 600000 1                  TZE     s:994
         1 000265   000000 636011                    EAQ     0,X1
         1 000266   000020 772000                    QRL     16
         1 000267   040000 106506                    CMPC    fill='040'O
         1 000270   500003 000010                    ADSC9   3,Q,PR5                  cn=0,n=8
         1 000271   000022 000010 0                  ADSC9   18                       cn=0,n=8
         1 000272   000362 601000 1                  TNZ     s:998
         1 000273   000354 710000 1                  TRA     s:994
PL6.E3A0      #001=IVO$FINDDVT File=IVO$OFFLINE.:E05TSI                          TUE 07/29/97 23:12 Page:14   
         1 000274   000000 636011                    EAQ     0,X1
         1 000275   000020 772000                    QRL     16
         1 000276   040000 106506                    CMPC    fill='040'O
         1 000277   500003 000010                    ADSC9   3,Q,PR5                  cn=0,n=8
         1 000300   000024 000010 0                  ADSC9   20                       cn=0,n=8
         1 000301   000362 601000 1                  TNZ     s:998
         1 000302   000354 710000 1                  TRA     s:994
         1 000303   000000 636011                    EAQ     0,X1
         1 000304   000020 772000                    QRL     16
         1 000305   040000 106506                    CMPC    fill='040'O
         1 000306   500003 000010                    ADSC9   3,Q,PR5                  cn=0,n=8
         1 000307   000026 000010 0                  ADSC9   22                       cn=0,n=8
         1 000310   000326 602000 1                  TNC     s:988+131
         1 000311   000000 636011                    EAQ     0,X1
         1 000312   000020 772000                    QRL     16
         1 000313   040000 106506                    CMPC    fill='040'O
         1 000314   500003 000010                    ADSC9   3,Q,PR5                  cn=0,n=8
         1 000315   000026 000010 0                  ADSC9   22                       cn=0,n=8
         1 000316   000354 600000 1                  TZE     s:994
         1 000317   000000 636011                    EAQ     0,X1
         1 000320   000020 772000                    QRL     16
         1 000321   040000 106506                    CMPC    fill='040'O
         1 000322   500003 000010                    ADSC9   3,Q,PR5                  cn=0,n=8
         1 000323   000030 000010 0                  ADSC9   24                       cn=0,n=8
         1 000324   000362 601000 1                  TNZ     s:998
         1 000325   000354 710000 1                  TRA     s:994
         1 000326   000000 636011                    EAQ     0,X1
         1 000327   000020 772000                    QRL     16
         1 000330   040000 106506                    CMPC    fill='040'O
         1 000331   500003 000010                    ADSC9   3,Q,PR5                  cn=0,n=8
         1 000332   000032 000010 0                  ADSC9   26                       cn=0,n=8
         1 000333   000362 602000 1                  TNC     s:998
         1 000334   000000 636011                    EAQ     0,X1
         1 000335   000020 772000                    QRL     16
         1 000336   040000 106506                    CMPC    fill='040'O
         1 000337   500003 000010                    ADSC9   3,Q,PR5                  cn=0,n=8
         1 000340   000032 000010 0                  ADSC9   26                       cn=0,n=8
PL6.E3A0      #001=IVO$FINDDVT File=IVO$OFFLINE.:E05TSI                          TUE 07/29/97 23:12 Page:15   
         1 000341   000354 600000 1                  TZE     s:994
         1 000342   000000 636011                    EAQ     0,X1
         1 000343   000020 772000                    QRL     16
         1 000344   040000 106506                    CMPC    fill='040'O
         1 000345   500003 000010                    ADSC9   3,Q,PR5                  cn=0,n=8
         1 000346   000034 000010 0                  ADSC9   28                       cn=0,n=8
         1 000347   000362 601000 1                  TNZ     s:998
         1 000350   000354 710000 1                  TRA     s:994

       69      989    4                    SELECT ( 'MSP8021 ', 'MSP8022 ', 'MSP8023 ' );

       70      990    4                    VIP.MPC_TYPE = #DAU;

    990  1 000351   000001 236007                    LDQ     1,DL
         1 000352   300021 552104                    STBQ    17,'04'O,PR3
         1 000353   000364 710000 1                  TRA     s:1000

       71      991    4                    SELECT ( 'MSP3881 ', 'MSP3885 ', 'MSP3882 ',

       72      992    4                      'MSP3886 ', 'MSP3991 ', 'MSP3993 ',
       73      993    4                      'MSP3992 ', 'MSP3994 ' );
       74      994    4                    VIP.MPC_TYPE = #FIPS;

    994  1 000354   000002 236007                    LDQ     2,DL
         1 000355   300021 552104                    STBQ    17,'04'O,PR3
         1 000356   000364 710000 1                  TRA     s:1000

       75      995    4                    SELECT ( 'MSS8080 ', 'MSS8090 ', 'MSP8080 ', 'MSP8090 ' );

       76      996    4                    VIP.MPC_TYPE = #MDS;

    996  1 000357   000003 236007                    LDQ     3,DL
         1 000360   300021 552104                    STBQ    17,'04'O,PR3
         1 000361   000364 710000 1                  TRA     s:1000

       77      997    4                    SELECT (ELSE);

PL6.E3A0      #001=IVO$FINDDVT File=IVO$OFFLINE.:E05TSI                          TUE 07/29/97 23:12 Page:16   
       78      998    4                 VIP.MPC_TYPE = #MPC;

    998  1 000362   000000 236003                    LDQ     0,DU
         1 000363   300021 552104                    STBQ    17,'04'O,PR3

       79      999    4                    END;                   /* DO SELECT */

       80     1000    3              RETURN;

   1000  1 000364   000000 702200 xent               TSX2  ! X66_ARET

       81     1001    3                 END;
       82     1002    2              END/* DO I */;

   1002  1 000365   200006 054100                    AOS     I,,AUTO
         1 000366   200006 236100                    LDQ     I,,AUTO
         1 000367   000000 116000 xsym               CMPQ    NK_MXLOCAL
         1 000370   000005 604400 1                  TMOZ    s:968

       83     1003    1           ALTRETURN;                      /* DISK NOT FOUND */

   1003  1 000371   000000 702200 xent               TSX2  ! X66_AALT

(unnamed)
 Sect OctLoc
   0     000   115123 120063   071071 061040   115123 120070   060062 061040    MSP3991 MSP8021
   0     004   115123 120070   060070 060040   115123 123070   060070 060040    MSP8080 MSS8080
   0     010   115123 123070   060071 060040   115123 120070   060071 060040    MSS8090 MSP8090
   0     014   115123 120070   060062 063040   115123 120070   060062 062040    MSP8023 MSP8022
   0     020   115123 120063   071071 063040   115123 120063   071071 064040    MSP3993 MSP3994
   0     024   115123 120063   071071 062040   115123 120063   070070 065040    MSP3992 MSP3885
   0     030   115123 120063   070070 066040   115123 120063   070070 061040    MSP3886 MSP3881
   0     034   115123 120063   070070 062040                                    MSP3882

(unnamed)
 Sect OctLoc
   2     000   000777 770000                                                    ....
PL6.E3A0      #001=IVO$FINDDVT File=IVO$OFFLINE.:E05TSI                          TUE 07/29/97 23:12 Page:17   
       84     1004    1   END IVO$FINDDVT;
       85     1005        %EOD;

PL6.E3A0      #001=IVO$FINDDVT File=IVO$OFFLINE.:E05TSI                          TUE 07/29/97 23:12 Page:18   
--  Include file information  --

   IV_SUBS_C.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   NI_DATA_C.:E05TOU  is referenced.
   IV$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure IVO$FINDDVT.
PL6.E3A0      #001=IVO$FINDDVT File=IVO$OFFLINE.:E05TSI                          TUE 07/29/97 23:12 Page:19   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @DVT$                      3-0-0/w PTR         r     1 @VIP
     7-0-0/w PTR         r     1 DCT$                      *0-0-0/w PTR         r     1 DVT$
     6-0-0/w SBIN        r     1 I                          5-0-0/w PTR         r     1 MPC_DVT$
    10-0-0/w PTR         r     1 SQH$                      *0-0-0/w STRC(3024)  r     1 VIP

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 IT_CP6UP                   0-0-0/w STRC(1800)  r     1 IT_PARTITION
     0-0-0/w PTR         r     1 N$DCT$$                    0-0-0/w PTR         r     1 N$FQ$
     0-0-0/w PTR         r     1 NI$FQ$                     0-0-0/w PTR         r     1 NI$IBUF$
     0-0-0/w PTR         r     1 NI$RP$                     0-0-0/w SBIN        r     1 NK_MXLOCAL

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1332)  r     1 DCT                        0-0-0/w STRC(2844)  r     1 DVT
     0-0-0/w STRC(2844)  r     1 MPC_DVT                    0-0-0/w PTR         r     1 N$DCT$(0:0)
     0-0-0/w STRC(252)   r     1 SQH


   Procedure IVO$FINDDVT requires 250 words for executable code.
   Procedure IVO$FINDDVT requires 10 words of local(AUTO) storage.
PL6.E3A0      #001=IVO$FINDDVT File=IVO$OFFLINE.:E05TSI                          TUE 07/29/97 23:12 Page:20   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=IVO$FINDDVT File=IVO$OFFLINE.:E05TSI                          TUE 07/29/97 23:12 Page:21   
          MINI XREF LISTING

DCT.DCTX
       885**DCL       978>>IF        982>>IF        986>>ASSIGN
DCT.DEVNM
       884**DCL       970>>IF
DCT.DP
       904**DCL       911--REDEF     914--REDEF     915--REDEF     917--REDEF     917--REDEF     918--REDEF
       919--REDEF     919--REDEF
DCT.DVN
       893**DCL       975>>ASSIGN
DCT.DVT$
       900**DCL       972>>ASSIGN    987>>ASSIGN
DCT.MODX
       893**DCL       974>>ASSIGN    988>>DOSELCT
DCT.MPC.IOCHANX
       912**DCL       912--REDEF
DCT.SQH$
       899**DCL       976>>ASSIGN
DCT.STATUS.DOWN
       901**DCL       978>>IF        982>>IF
DCT$
       962**DCL       884--IMP-PTR   969<<ASSIGN    974>>ASSIGN    975>>ASSIGN    976>>ASSIGN    977<<ASSIGN
       978>>IF        978>>IF        981<<ASSIGN    982>>IF        982>>IF        982>>IF        986>>ASSIGN
       987>>ASSIGN    988>>DOSELCT
DVT.MODEL
       924**DCL       974>>ASSIGN
DVT.MPC
       926**DCL       927--REDEF
DVT.TYPE
       924**DCL       973>>IF
DVT$
       865**DCL        11--PROC      924--IMP-PTR   972<<ASSIGN    973>>IF        974>>ASSIGN
I
PL6.E3A0      #001=IVO$FINDDVT File=IVO$OFFLINE.:E05TSI                          TUE 07/29/97 23:12 Page:22   
       961**DCL       967<<DOINDEX   968>>IF        969>>ASSIGN    970>>IF        971>>ASSIGN    972>>ASSIGN
IT_CP6UP
       871**DCL       978>>IF        982>>IF
IT_PARTITION.DEVICE
       956**DCL       978>>IF        982>>IF
MPC_DVT.MODEL
       931**DCL       988>>DOSELCT
MPC_DVT.MPC
       933**DCL       934--REDEF
MPC_DVT$
       866**DCL       931--IMP-PTR   987<<ASSIGN    988>>DOSELCT
N$DCT$
       730**DCL       968>>IF        969>>ASSIGN    970>>IF        972>>ASSIGN
N$DCT$$
       596**DCL       730--IMP-PTR   968>>IF        969>>ASSIGN    970>>IF        972>>ASSIGN
N$FQ$
       596**DCL       731--IMP-PTR
N$REQ_INIT.BUFADDR
       615**DCL       616--REDEF     616--REDEF
N$REQ_INIT.DLA.DRELADDR
       607**DCL       607--REDEF
N$REQ_INIT.DVE.EOMCHAR
       644**DCL       645--REDEF
N$REQ_INIT.EAINFO
       638**DCL       638--REDEF
N$REQ_INIT.EAINFOX
       638**DCL       639--REDEF
N$REQ_INIT.EVNTINFO
       639**DCL       639--REDEF
N$REQ_INIT.STATUS
       620**DCL       626--REDEF
NI$FQ$
       656**DCL       732--IMP-PTR
NI$IBUF$
       656**DCL       732--IMP-PTR
NI$IMXMBX_INIT.PAGED_BASE
PL6.E3A0      #001=IVO$FINDDVT File=IVO$OFFLINE.:E05TSI                          TUE 07/29/97 23:12 Page:23   
       666**DCL       667--REDEF     667--REDEF
NI$IMXMBX_INIT.SIZE
       668**DCL       668--REDEF
NI$REQ_INIT.DCW
       690**DCL       693--REDEF
NI$REQ_INIT.DCW.TALLY
       691**DCL       691--REDEF
NI$REQ_INIT.IDCW.EXTA
       693**DCL       693--REDEF
NI$REQ_INIT.PCW
       695**DCL       699--REDEF
NI$REQ_INIT.SEEK
       700**DCL       701--REDEF     702--REDEF
NI$RP$
       704**DCL       734--IMP-PTR
NI_MBX_INIT.DCW.CONTROL.AE
       726**DCL       726--REDEF
NI_MBX_INIT.LPW.CONTROL.AE
       722**DCL       722--REDEF
NK_MXLOCAL
       870**DCL       967>>DOINDEX
SQH.DOOR
       946**DCL       946--REDEF
SQH.MPC$
       948**DCL       977>>ASSIGN    981>>ASSIGN
SQH$
       963**DCL       946--IMP-PTR   976<<ASSIGN    977>>ASSIGN    981>>ASSIGN
VIP
       802**DCL        11--PROC
VIP.CTRACK
       818**DCL       819--REDEF
VIP.DCTX
       823**DCL       971<<ASSIGN
VIP.DEVID
       808**DCL       970>>IF
VIP.DVN
PL6.E3A0      #001=IVO$FINDDVT File=IVO$OFFLINE.:E05TSI                          TUE 07/29/97 23:12 Page:24   
       848**DCL       975<<ASSIGN
VIP.MODEL
       809**DCL       974<<ASSIGN
VIP.MPC_DCTX
       849**DCL       986<<ASSIGN
VIP.MPC_TYPE
       850**DCL       990<<ASSIGN    994<<ASSIGN    996<<ASSIGN    998<<ASSIGN
VIP.RANGE.FTRACK
       856**DCL       857--REDEF
VIP.RANGE.LTRACK
       860**DCL       861--REDEF

PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:25   
       86        1        /*T***********************************************************/
       87        2        /*T*                                                         */
       88        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       89        4        /*T*                                                         */
       90        5        /*T***********************************************************/
       91        6        /**/
       92        7        /* GET AND FREE DYNAMIC DATA SPACE */
       93        8        /**/
       94        9        IVO$GET: PROC(D$,NWP) ALTRET;
       95       10        /**/
       96       11        /* PARAMETERS */
       97       12        /**/
       98       13    1   DCL D$ PTR;
       99       14    1   DCL NWP SBIN;
      100       15    1   DCL NW SBIN;
      101       16        /**/
      102       17        /* INCLUDE FILES */
      103       18        /**/
      104       19        %INCLUDE B_SEGIDS_C;
      105      558        %INCLUDE MM_DATA_R;
      106     1078        /**/
      107     1079        /* EXTERNAL REFERENCES */
      108     1080        /**/
      109     1081    1   DCL B$DS8$ PTR SYMREF;
      110     1082    1   DCL MMH$GDS ENTRY(5) ALTRET;
      111     1083    1   DCL MMH$FDS ENTRY(4) ALTRET;
      112     1084        /**/
      113     1085        /* DATA STRUCTURES */
      114     1086        /**/
      115     1087    1   DCL 1 F BASED(F$) DALIGNED,             /* FREE SPACE PACKET */
      116     1088    1         2 FREE BIT(1),
      117     1089    1         2 NW UBIN(17) UNAL,
      118     1090    1         2 PFREE BIT(1),
      119     1091    1         2 PNW UBIN(17) UNAL,
      120     1092    1         2 FL$ PTR;
      121     1093    1   DCL FW SBIN BASED(F$);
      122     1094        /**/
PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:26   
      123     1095        /* STATIC DATA */
      124     1096        /**/
      125     1097    1   DCL 1 FREE SYMREF DALIGNED,             /* FREE SPACE HEAD */
      126     1098    1         2 * SBIN,
      127     1099    1         2 FL$ PTR;
      128     1100    1   DCL SEGSIZE SBIN SYMREF;                /* SIZE OF DATA SEGMENT */
      129     1101        /**/
      130     1102        /* AUTO STACK */
      131     1103        /**/
      132     1104    1   DCL C$ PTR;
      133     1105    1   DCL F$ PTR;
      134     1106    1   DCL ERRWD SBIN;
      135     1107    1   DCL I SBIN;
      136     1108    1   DCL N SBIN;
      137     1109    1   DCL P$ PTR;
      138     1110        /**/
      139     1111        /* GET NW WORDS OF DYNAMIC SPACE */
      140     1112        /* RETURN POINTER IN D$ */
      141     1113        /**/
      142     1114    1           NW=NWP+MOD(NWP,2);
      143     1115    1           N=NW+2;
      144     1116    1           CALL FIND(N) ALTRET(FOUND);
      145     1117    2           IF SEGSIZE=0 THEN DO;
      146     1118    2              F$=ADDR(NIL);
      147     1119    2              I=N+2;
      148     1120    2              END;
      149     1121    2           ELSE DO;
      150     1122    2              F$=PINCRW(B$DS8$,SEGSIZE-2);
      151     1123    2              I=N;
      152     1124    2              END;
      153     1125    1           CALL MMH$GDS(%MONWSQ,BITBIN(%DS8SID),I,ERRWD) ALTRET(GDS_ERR);
      154     1126    1           SEGSIZE=SEGSIZE+I;
      155     1127    2           IF F$=ADDR(NIL) THEN DO;
      156     1128    2              F$=B$DS8$;
      157     1129    2              FW=0;
      158     1130    2              END;
      159     1131    1           F.FREE='0'B;
PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:27   
      160     1132    1           F.NW=N;
      161     1133    1           C$=PINCRW(F$,N);
      162     1134    1           C$->FW=0;
      163     1135    1           C$->F.PNW=N;
      164     1136    1           D$=PINCRW(F$,2);
      165     1137    1           RETURN;
      166     1138        /**/
      167     1139    1   FOUND:
      168     1140    1           CALL DELINK;
      169     1141    1           D$=PINCRW(F$,2);
      170     1142    1           N=F.NW-N;
      171     1143    1           IF N<4 THEN RETURN;
      172     1144    1           F.NW=NW+2;
      173     1145    1           C$=PINCRW(F$,F.NW);
      174     1146    1           C$->F.PFREE='0'B;
      175     1147    1           C$->F.PNW=F.NW;
      176     1148    1           GOTO RELINK;
      177     1149        /**/
      178     1150    1   GDS_ERR:
      179     1151    1           ALTRETURN;
      180     1152        /**/
      181     1153        /* FREE NW WORDS AT D$ */
      182     1154        /**/
      183     1155    1   IVO$FREE: ENTRY (D$) ALTRET;
      184     1156    1           F$=PINCRW(D$,-2);
      185     1157    1           N=F.NW;
      186     1158    2           DO WHILE (F.PFREE);
      187     1159    2              N=N+F.PNW;
      188     1160    2              F$=PINCRW(F$,-F.PNW);
      189     1161    2              CALL FINDPREV;
      190     1162    2              CALL DELINK;
      191     1163    2              END;
      192     1164    1           C$=F$;
      193     1165    2   AGGLUT: DO;
      194     1166    2              F$=PINCRW(C$,N);
      195     1167    2              IF NOT F.FREE THEN GOTO NO_MORE;
      196     1168    2              N=N+F.NW;
PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:28   
      197     1169    2              CALL FINDPREV;
      198     1170    2              CALL DELINK;
      199     1171    2              GOTO AGGLUT;
      200     1172    2              END AGGLUT;
      201     1173    1   NO_MORE:
      202     1174    2           IF SEGSIZE=POFFW(C$,B$DS8$)+N+2 THEN DO;
      203     1175    3              IF C$=B$DS8$ THEN DO;
      204     1176    3                 N=N+2;
      205     1177    3                 FREE.FL$=ADDR(FREE);
      206     1178    3                 END;
      207     1179    2              ELSE
      208     1180    2                 C$->F.FREE='0'B;
      209     1181    2              CALL MMH$FDS(%MONWSQ,BITBIN(%DS8SID),N,ERRWD) ALTRET(GDS_ERR);
      210     1182    2              SEGSIZE=SEGSIZE-N;
      211     1183    2              END;
      212     1184    2           ELSE DO;
      213     1185    2   RELINK:
      214     1186    2              CALL FIND(N);
      215     1187    2              C$->F.FREE='1'B;
      216     1188    2              C$->F.NW=N;
      217     1189    2              C$->F.FL$=F$;
      218     1190    2              P$->F.FL$=C$;
      219     1191    2              F$=PINCRW(C$,N);
      220     1192    2              F.PFREE='1'B;
      221     1193    2              F.PNW=N;
      222     1194    2              END;
      223     1195    1           RETURN;
      224     1196        /**/
      225     1197        /* INITIALIZE FREE SPACE */
      226     1198        /**/
      227     1199    1   IVO$GET_INIT: ENTRY ALTRET;
      228     1200    1           FREE.FL$=ADDR(FREE);
      229     1201    1           MM_DSMAX(7)=BITBIN('777'O);
      230     1202    1           SEGSIZE=0;
      231     1203    1           RETURN;
      232     1204        /**/
      233     1205        /* CLEAN UP FREE SPACE */
PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:29   
      234     1206        /**/
      235     1207    1   IVO$GET_CLEANUP: ENTRY ALTRET;
      236     1208    1           IF SEGSIZE~=0 THEN CALL MMH$FDS(%MONWSQ,BITBIN(%DS8SID),SEGSIZE,ERRWD);
      237     1209    1           MM_DSMAX(7)=1;
      238     1210    1           RETURN;
      239     1211        %EJECT;
PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:30   
      240     1212        /**/
      241     1213        /* FIND FREE SPACE FOR ENTRY WITH AT LEAST SN WORDS */
      242     1214        /*     RETURN IF NOT FOUND */
      243     1215        /*     ALTRET IF NOT FOUND */
      244     1216        /**/
      245     1217    1   FIND:   PROC (SN) ALTRET;
      246     1218    2   DCL SN SBIN;
      247     1219        /**/
      248     1220    2           F$=FREE.FL$;
      249     1221    2           P$=ADDR(FREE);
      250     1222    3           DO WHILE (F$~=ADDR(FREE));
      251     1223    3              IF SN<=F.NW THEN ALTRETURN;
      252     1224    3              P$=F$;
      253     1225    3              F$=F.FL$;
      254     1226    3              END;
      255     1227    2           RETURN;
      256     1228    2   END FIND;
      257     1229        /**/
      258     1230        /* FIND PREVIOUS ENTRY IN FREE SPACE LIST, RETURN IN P$ */
      259     1231        /**/
      260     1232    1   FINDPREV: PROC;
      261     1233    2           P$=ADDR(FREE);
      262     1234    3           DO WHILE(P$->F.FL$~=F$);
      263     1235    3              P$=P$->F.FL$;
      264     1236    3              END;
      265     1237    2   END FINDPREV;
      266     1238        /**/
      267     1239        /* DELINK F$->SPACE FROM FREE SPACE LIST */
      268     1240        /**/
      269     1241    1   DELINK: PROC;
      270     1242    2           F.FREE='0'B;
      271     1243    2           P$->F.FL$=F.FL$;
      272     1244    2           PINCRW(F$,F.NW)->F.PFREE='0'B;
      273     1245    2           RETURN;
      274     1246    2   END DELINK;
      275     1247    1   END IVO$GET;
      276     1248        %EOD;
PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:31   

PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:32   
--  Include file information  --

   MM_MACRO_M.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   MM$SYSGEN.:E05TOU  is referenced.
   M_INFO_C.:E05TOU  is referenced.
   MM_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure IVO$GET.

   Procedure IVO$GET requires 302 words for executable code.
   Procedure IVO$GET requires 18 words of local(AUTO) storage.

PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:33   

 Object Unit name= IVO$GET                                    File name= IVO$OFFLINE.:E05TOU
 UTS= JUL 29 '97 23:13:08.44 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none   302    456  IVO$GET
    1  RoData even  none     6      6  IVO$GET

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        2  IVO$GET
     0    154          yes     yes      Std        1  IVO$FREE
     0    340          yes     yes      Std        0  IVO$GET_INIT
     0    350          yes     yes      Std        0  IVO$GET_CLEANUP

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       4 MMH$FDS
 yes     yes           Std       5 MMH$GDS
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:34   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    MM_BYP$                               MM_DSMAX                              B$DS8$
     FREE                                  SEGSIZE                               B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:35   


       86        1        /*T***********************************************************/
       87        2        /*T*                                                         */
       88        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       89        4        /*T*                                                         */
       90        5        /*T***********************************************************/
       91        6        /**/
       92        7        /* GET AND FREE DYNAMIC DATA SPACE */
       93        8        /**/
       94        9        IVO$GET: PROC(D$,NWP) ALTRET;

      9  0 000000   000000 700200 xent  IVO$GET      TSX0  ! X66_AUTO_2
         0 000001   000022 000002                    ZERO    18,2

       95       10        /**/
       96       11        /* PARAMETERS */
       97       12        /**/
       98       13    1   DCL D$ PTR;
       99       14    1   DCL NWP SBIN;
      100       15    1   DCL NW SBIN;
      101       16        /**/
      102       17        /* INCLUDE FILES */
      103       18        /**/
      104       19        %INCLUDE B_SEGIDS_C;
      105      558        %INCLUDE MM_DATA_R;
      106     1078        /**/
      107     1079        /* EXTERNAL REFERENCES */
      108     1080        /**/
      109     1081    1   DCL B$DS8$ PTR SYMREF;
      110     1082    1   DCL MMH$GDS ENTRY(5) ALTRET;
      111     1083    1   DCL MMH$FDS ENTRY(4) ALTRET;
      112     1084        /**/
      113     1085        /* DATA STRUCTURES */
      114     1086        /**/
      115     1087    1   DCL 1 F BASED(F$) DALIGNED,             /* FREE SPACE PACKET */
      116     1088    1         2 FREE BIT(1),
      117     1089    1         2 NW UBIN(17) UNAL,
PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:36   
      118     1090    1         2 PFREE BIT(1),
      119     1091    1         2 PNW UBIN(17) UNAL,
      120     1092    1         2 FL$ PTR;
      121     1093    1   DCL FW SBIN BASED(F$);
      122     1094        /**/
      123     1095        /* STATIC DATA */
      124     1096        /**/
      125     1097    1   DCL 1 FREE SYMREF DALIGNED,             /* FREE SPACE HEAD */
      126     1098    1         2 * SBIN,
      127     1099    1         2 FL$ PTR;
      128     1100    1   DCL SEGSIZE SBIN SYMREF;                /* SIZE OF DATA SEGMENT */
      129     1101        /**/
      130     1102        /* AUTO STACK */
      131     1103        /**/
      132     1104    1   DCL C$ PTR;
      133     1105    1   DCL F$ PTR;
      134     1106    1   DCL ERRWD SBIN;
      135     1107    1   DCL I SBIN;
      136     1108    1   DCL N SBIN;
      137     1109    1   DCL P$ PTR;
      138     1110        /**/
      139     1111        /* GET NW WORDS OF DYNAMIC SPACE */
      140     1112        /* RETURN POINTER IN D$ */
      141     1113        /**/
      142     1114    1           NW=NWP+MOD(NWP,2);

   1114  0 000002   200004 470500                    LDP0    @NWP,,AUTO
         0 000003   000000 236100                    LDQ     0,,PR0
         0 000004   000002 506007                    DIV     2,DL
         0 000005   000044 733000                    LRS     36
         0 000006   000000 036100                    ADLQ    0,,PR0
         0 000007   200005 756100                    STQ     NW,,AUTO

      143     1115    1           N=NW+2;

   1115  0 000010   000002 036007                    ADLQ    2,DL
         0 000011   200012 756100                    STQ     N,,AUTO
PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:37   

      144     1116    1           CALL FIND(N) ALTRET(FOUND);

   1116  0 000012   200012 631500                    EPPR1   N,,AUTO
         0 000013   200015 451500                    STP1    P$+2,,AUTO
         0 000014   000371 701000 0                  TSX1    FIND
         0 000015   000110 702000 0                  TSX2    FOUND

      145     1117    2           IF SEGSIZE=0 THEN DO;

   1117  0 000016   000000 235000 xsym               LDA     SEGSIZE
         0 000017   000026 601000 0                  TNZ     s:1122

      146     1118    2              F$=ADDR(NIL);

   1118  0 000020   000001 236000 xsym               LDQ     B_VECTNIL+1
         0 000021   200007 756100                    STQ     F$,,AUTO

      147     1119    2              I=N+2;

   1119  0 000022   200012 235100                    LDA     N,,AUTO
         0 000023   000002 035007                    ADLA    2,DL
         0 000024   200011 755100                    STA     I,,AUTO

      148     1120    2              END;

   1120  0 000025   000035 710000 0                  TRA     s:1125

      149     1121    2           ELSE DO;

      150     1122    2              F$=PINCRW(B$DS8$,SEGSIZE-2);

   1122  0 000026   000000 236000 xsym               LDQ     SEGSIZE
         0 000027   000022 736000                    QLS     18
         0 000030   000002 136003                    SBLQ    2,DU
         0 000031   000000 036000 xsym               ADLQ    B$DS8$
         0 000032   200007 756100                    STQ     F$,,AUTO
PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:38   

      151     1123    2              I=N;

   1123  0 000033   200012 235100                    LDA     N,,AUTO
         0 000034   200011 755100                    STA     I,,AUTO

      152     1124    2              END;

      153     1125    1           CALL MMH$GDS(%MONWSQ,BITBIN(%DS8SID),I,ERRWD) ALTRET(GDS_ERR);

   1125  0 000035   200010 630500                    EPPR0   ERRWD,,AUTO
         0 000036   200021 450500                    STP0    @SN+4,,AUTO
         0 000037   200011 631500                    EPPR1   I,,AUTO
         0 000040   200020 451500                    STP1    @SN+3,,AUTO
         0 000041   000002 237000 1                  LDAQ    2
         0 000042   200016 757100                    STAQ    @SN+1,,AUTO
         0 000043   200016 630500                    EPPR0   @SN+1,,AUTO
         0 000044   000022 631400 xsym               EPPR1   B_VECTNIL+18
         0 000045   000000 701000 xent               TSX1    MMH$GDS
         0 000046   000153 702000 0                  TSX2    GDS_ERR

      154     1126    1           SEGSIZE=SEGSIZE+I;

   1126  0 000047   000000 236000 xsym               LDQ     SEGSIZE
         0 000050   200011 036100                    ADLQ    I,,AUTO
         0 000051   000000 756000 xsym               STQ     SEGSIZE

      155     1127    2           IF F$=ADDR(NIL) THEN DO;

   1127  0 000052   200007 236100                    LDQ     F$,,AUTO
         0 000053   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000054   000061 601000 0                  TNZ     s:1131

      156     1128    2              F$=B$DS8$;

   1128  0 000055   000000 236000 xsym               LDQ     B$DS8$
         0 000056   200007 756100                    STQ     F$,,AUTO
PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:39   

      157     1129    2              FW=0;

   1129  0 000057   200007 470500                    LDP0    F$,,AUTO
         0 000060   000000 450100                    STZ     0,,PR0

      158     1130    2              END;

      159     1131    1           F.FREE='0'B;

   1131  0 000061   200007 470500                    LDP0    F$,,AUTO
         0 000062   000031 236000 xsym               LDQ     B_VECTNIL+25
         0 000063   000000 356100                    ANSQ    0,,PR0

      160     1132    1           F.NW=N;

   1132  0 000064   200012 236100                    LDQ     N,,AUTO
         0 000065   000022 736000                    QLS     18
         0 000066   000000 676100                    ERQ     0,,PR0
         0 000067   377777 376003                    ANQ     131071,DU
         0 000070   000000 656100                    ERSQ    0,,PR0

      161     1133    1           C$=PINCRW(F$,N);

   1133  0 000071   200012 236100                    LDQ     N,,AUTO
         0 000072   000022 736000                    QLS     18
         0 000073   200007 036100                    ADLQ    F$,,AUTO
         0 000074   200006 756100                    STQ     C$,,AUTO

      162     1134    1           C$->FW=0;

   1134  0 000075   200006 471500                    LDP1    C$,,AUTO
         0 000076   100000 450100                    STZ     0,,PR1

      163     1135    1           C$->F.PNW=N;

   1135  0 000077   200012 236100                    LDQ     N,,AUTO
PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:40   
         0 000100   100000 676100                    ERQ     0,,PR1
         0 000101   377777 376007                    ANQ     131071,DL
         0 000102   100000 656100                    ERSQ    0,,PR1

      164     1136    1           D$=PINCRW(F$,2);

   1136  0 000103   200007 236100                    LDQ     F$,,AUTO
         0 000104   000002 036003                    ADLQ    2,DU
         0 000105   200003 473500                    LDP3    @D$,,AUTO
         0 000106   300000 756100                    STQ     0,,PR3

      165     1137    1           RETURN;

   1137  0 000107   000000 702200 xent               TSX2  ! X66_ARET

      166     1138        /**/
      167     1139    1   FOUND:
      168     1140    1           CALL DELINK;

   1140  0 000110   000441 701000 0     FOUND        TSX1    DELINK
         0 000111   000000 011000                    NOP     0

      169     1141    1           D$=PINCRW(F$,2);

   1141  0 000112   200007 236100                    LDQ     F$,,AUTO
         0 000113   000002 036003                    ADLQ    2,DU
         0 000114   200003 470500                    LDP0    @D$,,AUTO
         0 000115   000000 756100                    STQ     0,,PR0

      170     1142    1           N=F.NW-N;

   1142  0 000116   200007 471500                    LDP1    F$,,AUTO
         0 000117   100000 236100                    LDQ     0,,PR1
         0 000120   000022 772000                    QRL     18
         0 000121   377777 376007                    ANQ     131071,DL
         0 000122   200012 136100                    SBLQ    N,,AUTO
         0 000123   200012 756100                    STQ     N,,AUTO
PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:41   

      171     1143    1           IF N<4 THEN RETURN;

   1143  0 000124   000004 116007                    CMPQ    4,DL
         0 000125   000127 605000 0                  TPL     s:1144

   1143  0 000126   000000 702200 xent               TSX2  ! X66_ARET

      172     1144    1           F.NW=NW+2;

   1144  0 000127   200005 236100                    LDQ     NW,,AUTO
         0 000130   000002 036007                    ADLQ    2,DL
         0 000131   000022 736000                    QLS     18
         0 000132   100000 676100                    ERQ     0,,PR1
         0 000133   377777 376003                    ANQ     131071,DU
         0 000134   100000 656100                    ERSQ    0,,PR1

      173     1145    1           C$=PINCRW(F$,F.NW);

   1145  0 000135   100000 220100                    LDX0    0,,PR1
         0 000136   377777 360003                    ANX0    131071,DU
         0 000137   000000 636010                    EAQ     0,X0
         0 000140   200007 036100                    ADLQ    F$,,AUTO
         0 000141   200006 756100                    STQ     C$,,AUTO

      174     1146    1           C$->F.PFREE='0'B;

   1146  0 000142   200006 473500                    LDP3    C$,,AUTO
         0 000143   000001 236000 1                  LDQ     1
         0 000144   300000 356100                    ANSQ    0,,PR3

      175     1147    1           C$->F.PNW=F.NW;

   1147  0 000145   100000 236100                    LDQ     0,,PR1
         0 000146   000022 772000                    QRL     18
         0 000147   300000 676100                    ERQ     0,,PR3
         0 000150   377777 376007                    ANQ     131071,DL
PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:42   
         0 000151   300000 656100                    ERSQ    0,,PR3

      176     1148    1           GOTO RELINK;

   1148  0 000152   000303 710000 0                  TRA     RELINK

      177     1149        /**/
      178     1150    1   GDS_ERR:
      179     1151    1           ALTRETURN;

   1151  0 000153   000000 702200 xent  GDS_ERR      TSX2  ! X66_AALT

      180     1152        /**/
      181     1153        /* FREE NW WORDS AT D$ */
      182     1154        /**/
      183     1155    1   IVO$FREE: ENTRY (D$) ALTRET;

   1155  0 000154   000000 700200 xent  IVO$FREE     TSX0  ! X66_AUTO_2
         0 000155   000022 000002                    ZERO    18,2

      184     1156    1           F$=PINCRW(D$,-2);

   1156  0 000156   200003 470500                    LDP0    @D$,,AUTO
         0 000157   000000 236100                    LDQ     0,,PR0
         0 000160   777776 036003                    ADLQ    -2,DU
         0 000161   200007 756100                    STQ     F$,,AUTO

      185     1157    1           N=F.NW;

   1157  0 000162   200007 471500                    LDP1    F$,,AUTO
         0 000163   100000 236100                    LDQ     0,,PR1
         0 000164   000022 772000                    QRL     18
         0 000165   377777 376007                    ANQ     131071,DL
         0 000166   200012 756100                    STQ     N,,AUTO

      186     1158    2           DO WHILE (F.PFREE);

PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:43   
   1158  0 000167   100000 236100                    LDQ     0,,PR1
         0 000170   400000 316007                    CANQ    -131072,DL
         0 000171   000215 600000 0                  TZE     s:1164

      187     1159    2              N=N+F.PNW;

   1159  0 000172   200007 470500                    LDP0    F$,,AUTO
         0 000173   000000 236100                    LDQ     0,,PR0
         0 000174   377777 376007                    ANQ     131071,DL
         0 000175   200012 036100                    ADLQ    N,,AUTO
         0 000176   200012 756100                    STQ     N,,AUTO

      188     1160    2              F$=PINCRW(F$,-F.PNW);

   1160  0 000177   000000 720100                    LXL0    0,,PR0
         0 000200   377777 360003                    ANX0    131071,DU
         0 000201   777777 636010                    EAQ     -1,X0
         0 000202   777777 676003                    ERQ     -1,DU
         0 000203   200007 036100                    ADLQ    F$,,AUTO
         0 000204   200007 756100                    STQ     F$,,AUTO

      189     1161    2              CALL FINDPREV;

   1161  0 000205   000421 701000 0                  TSX1    FINDPREV
         0 000206   000000 011000                    NOP     0

      190     1162    2              CALL DELINK;

   1162  0 000207   000441 701000 0                  TSX1    DELINK
         0 000210   000000 011000                    NOP     0

      191     1163    2              END;

   1163  0 000211   200007 470500                    LDP0    F$,,AUTO
         0 000212   000000 236100                    LDQ     0,,PR0
         0 000213   400000 316007                    CANQ    -131072,DL
         0 000214   000172 601000 0                  TNZ     s:1159
PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:44   

      192     1164    1           C$=F$;

   1164  0 000215   200007 236100                    LDQ     F$,,AUTO
         0 000216   200006 756100                    STQ     C$,,AUTO

      193     1165    2   AGGLUT: DO;

   1165  0 000217                       AGGLUT       null
      194     1166    2              F$=PINCRW(C$,N);

   1166  0 000217   200012 236100                    LDQ     N,,AUTO
         0 000220   000022 736000                    QLS     18
         0 000221   200006 036100                    ADLQ    C$,,AUTO
         0 000222   200007 756100                    STQ     F$,,AUTO

      195     1167    2              IF NOT F.FREE THEN GOTO NO_MORE;

   1167  0 000223   200007 470500                    LDP0    F$,,AUTO
         0 000224   000000 234100                    SZN     0,,PR0
         0 000225   000240 605000 0                  TPL     NO_MORE

      196     1168    2              N=N+F.NW;

   1168  0 000226   000000 236100                    LDQ     0,,PR0
         0 000227   000022 772000                    QRL     18
         0 000230   377777 376007                    ANQ     131071,DL
         0 000231   200012 036100                    ADLQ    N,,AUTO
         0 000232   200012 756100                    STQ     N,,AUTO

      197     1169    2              CALL FINDPREV;

   1169  0 000233   000421 701000 0                  TSX1    FINDPREV
         0 000234   000000 011000                    NOP     0

      198     1170    2              CALL DELINK;

PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:45   
   1170  0 000235   000441 701000 0                  TSX1    DELINK
         0 000236   000000 011000                    NOP     0

      199     1171    2              GOTO AGGLUT;

   1171  0 000237   000217 710000 0                  TRA     AGGLUT

      200     1172    2              END AGGLUT;
      201     1173    1   NO_MORE:
      202     1174    2           IF SEGSIZE=POFFW(C$,B$DS8$)+N+2 THEN DO;

   1174  0 000240   000000 235000 xsym  NO_MORE      LDA     B$DS8$
         0 000241   000022 771000                    ARL     18
         0 000242   200016 755100                    STA     @SN+1,,AUTO
         0 000243   200006 236100                    LDQ     C$,,AUTO
         0 000244   000022 772000                    QRL     18
         0 000245   200016 136100                    SBLQ    @SN+1,,AUTO
         0 000246   200012 036100                    ADLQ    N,,AUTO
         0 000247   000002 036007                    ADLQ    2,DL
         0 000250   000000 116000 xsym               CMPQ    SEGSIZE
         0 000251   000303 601000 0                  TNZ     RELINK

      203     1175    3              IF C$=B$DS8$ THEN DO;

   1175  0 000252   200006 236100                    LDQ     C$,,AUTO
         0 000253   000000 116000 xsym               CMPQ    B$DS8$
         0 000254   000262 601000 0                  TNZ     s:1180

      204     1176    3                 N=N+2;

   1176  0 000255   000002 236007                    LDQ     2,DL
         0 000256   200012 056100                    ASQ     N,,AUTO

      205     1177    3                 FREE.FL$=ADDR(FREE);

   1177  0 000257   000004 236000 1                  LDQ     4
         0 000260   000001 756000 xsym               STQ     FREE+1
PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:46   

      206     1178    3                 END;

   1178  0 000261   000265 710000 0                  TRA     s:1181

      207     1179    2              ELSE
      208     1180    2                 C$->F.FREE='0'B;

   1180  0 000262   200006 471500                    LDP1    C$,,AUTO
         0 000263   000031 236000 xsym               LDQ     B_VECTNIL+25
         0 000264   100000 356100                    ANSQ    0,,PR1

      209     1181    2              CALL MMH$FDS(%MONWSQ,BITBIN(%DS8SID),N,ERRWD) ALTRET(GDS_ERR);

   1181  0 000265   200010 631500                    EPPR1   ERRWD,,AUTO
         0 000266   200021 451500                    STP1    @SN+4,,AUTO
         0 000267   200012 633500                    EPPR3   N,,AUTO
         0 000270   200020 453500                    STP3    @SN+3,,AUTO
         0 000271   000002 237000 1                  LDAQ    2
         0 000272   200016 757100                    STAQ    @SN+1,,AUTO
         0 000273   200016 630500                    EPPR0   @SN+1,,AUTO
         0 000274   000022 631400 xsym               EPPR1   B_VECTNIL+18
         0 000275   000000 701000 xent               TSX1    MMH$FDS
         0 000276   000153 702000 0                  TSX2    GDS_ERR

      210     1182    2              SEGSIZE=SEGSIZE-N;

   1182  0 000277   000000 236000 xsym               LDQ     SEGSIZE
         0 000300   200012 136100                    SBLQ    N,,AUTO
         0 000301   000000 756000 xsym               STQ     SEGSIZE

      211     1183    2              END;

   1183  0 000302   000337 710000 0                  TRA     s:1195

      212     1184    2           ELSE DO;

PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:47   
      213     1185    2   RELINK:
      214     1186    2              CALL FIND(N);

   1186  0 000303   200012 630500       RELINK       EPPR0   N,,AUTO
         0 000304   200015 450500                    STP0    P$+2,,AUTO
         0 000305   000371 701000 0                  TSX1    FIND
         0 000306   000000 011000                    NOP     0

      215     1187    2              C$->F.FREE='1'B;

   1187  0 000307   200006 470500                    LDP0    C$,,AUTO
         0 000310   400000 236003                    LDQ     -131072,DU
         0 000311   000000 256100                    ORSQ    0,,PR0

      216     1188    2              C$->F.NW=N;

   1188  0 000312   200012 236100                    LDQ     N,,AUTO
         0 000313   000022 736000                    QLS     18
         0 000314   000000 676100                    ERQ     0,,PR0
         0 000315   377777 376003                    ANQ     131071,DU
         0 000316   000000 656100                    ERSQ    0,,PR0

      217     1189    2              C$->F.FL$=F$;

   1189  0 000317   200007 236100                    LDQ     F$,,AUTO
         0 000320   000001 756100                    STQ     1,,PR0

      218     1190    2              P$->F.FL$=C$;

   1190  0 000321   200006 236100                    LDQ     C$,,AUTO
         0 000322   200013 471500                    LDP1    P$,,AUTO
         0 000323   100001 756100                    STQ     1,,PR1

      219     1191    2              F$=PINCRW(C$,N);

   1191  0 000324   200012 236100                    LDQ     N,,AUTO
         0 000325   000022 736000                    QLS     18
PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:48   
         0 000326   200006 036100                    ADLQ    C$,,AUTO
         0 000327   200007 756100                    STQ     F$,,AUTO

      220     1192    2              F.PFREE='1'B;

   1192  0 000330   200007 473500                    LDP3    F$,,AUTO
         0 000331   400000 236007                    LDQ     -131072,DL
         0 000332   300000 256100                    ORSQ    0,,PR3

      221     1193    2              F.PNW=N;

   1193  0 000333   200012 236100                    LDQ     N,,AUTO
         0 000334   300000 676100                    ERQ     0,,PR3
         0 000335   377777 376007                    ANQ     131071,DL
         0 000336   300000 656100                    ERSQ    0,,PR3

      222     1194    2              END;

      223     1195    1           RETURN;

   1195  0 000337   000000 702200 xent               TSX2  ! X66_ARET

      224     1196        /**/
      225     1197        /* INITIALIZE FREE SPACE */
      226     1198        /**/
      227     1199    1   IVO$GET_INIT: ENTRY ALTRET;

   1199  0 000340   000000 700200 xent  IVO$GET_INIT TSX0  ! X66_AUTO_2
         0 000341   000022 000002                    ZERO    18,2

      228     1200    1           FREE.FL$=ADDR(FREE);

   1200  0 000342   000004 236000 1                  LDQ     4
         0 000343   000001 756000 xsym               STQ     FREE+1

      229     1201    1           MM_DSMAX(7)=BITBIN('777'O);

PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:49   
   1201  0 000344   000777 236007                    LDQ     511,DL
         0 000345   000001 552004 xsym               STBQ    MM_DSMAX+1,'04'O

      230     1202    1           SEGSIZE=0;

   1202  0 000346   000000 450000 xsym               STZ     SEGSIZE

      231     1203    1           RETURN;

   1203  0 000347   000000 702200 xent               TSX2  ! X66_ARET

      232     1204        /**/
      233     1205        /* CLEAN UP FREE SPACE */
      234     1206        /**/
      235     1207    1   IVO$GET_CLEANUP: ENTRY ALTRET;

   1207  0 000350   000000 700200 xent  IVO$GET_CLE* TSX0  ! X66_AUTO_2
         0 000351   000022 000002                    ZERO    18,2

      236     1208    1           IF SEGSIZE~=0 THEN CALL MMH$FDS(%MONWSQ,BITBIN(%DS8SID),SEGSIZE,ERRWD);

   1208  0 000352   000000 235000 xsym               LDA     SEGSIZE
         0 000353   000366 600000 0                  TZE     s:1209

   1208  0 000354   200010 630500                    EPPR0   ERRWD,,AUTO
         0 000355   200021 450500                    STP0    @SN+4,,AUTO
         0 000356   000005 236000 1                  LDQ     5
         0 000357   200020 756100                    STQ     @SN+3,,AUTO
         0 000360   000002 237000 1                  LDAQ    2
         0 000361   200016 757100                    STAQ    @SN+1,,AUTO
         0 000362   200016 630500                    EPPR0   @SN+1,,AUTO
         0 000363   000022 631400 xsym               EPPR1   B_VECTNIL+18
         0 000364   000000 701000 xent               TSX1    MMH$FDS
         0 000365   000000 011000                    NOP     0

      237     1209    1           MM_DSMAX(7)=1;

PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:50   
   1209  0 000366   000001 236007                    LDQ     1,DL
         0 000367   000001 552004 xsym               STBQ    MM_DSMAX+1,'04'O

      238     1210    1           RETURN;

   1210  0 000370   000000 702200 xent               TSX2  ! X66_ARET

      239     1211        %EJECT;
PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:51   
      240     1212        /**/
      241     1213        /* FIND FREE SPACE FOR ENTRY WITH AT LEAST SN WORDS */
      242     1214        /*     RETURN IF NOT FOUND */
      243     1215        /*     ALTRET IF NOT FOUND */
      244     1216        /**/
      245     1217    1   FIND:   PROC (SN) ALTRET;

   1217  0 000371   200014 741300       FIND         STX1  ! P$+1,,AUTO

      246     1218    2   DCL SN SBIN;
      247     1219        /**/
      248     1220    2           F$=FREE.FL$;

   1220  0 000372   000001 236000 xsym               LDQ     FREE+1
         0 000373   200007 756100                    STQ     F$,,AUTO

      249     1221    2           P$=ADDR(FREE);

   1221  0 000374   000004 236000 1                  LDQ     4
         0 000375   200013 756100                    STQ     P$,,AUTO

      250     1222    3           DO WHILE (F$~=ADDR(FREE));

   1222  0 000376   000414 710000 0                  TRA     s:1226

      251     1223    3              IF SN<=F.NW THEN ALTRETURN;

   1223  0 000377   200015 470500                    LDP0    @SN,,AUTO
         0 000400   200007 471500                    LDP1    F$,,AUTO
         0 000401   100000 236100                    LDQ     0,,PR1
         0 000402   000022 772000                    QRL     18
         0 000403   377777 376007                    ANQ     131071,DL
         0 000404   000000 116100                    CMPQ    0,,PR0
         0 000405   000410 604000 0                  TMI     s:1224

   1223  0 000406   200014 221300                    LDX1  ! P$+1,,AUTO
         0 000407   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:52   

      252     1224    3              P$=F$;

   1224  0 000410   200007 236100                    LDQ     F$,,AUTO
         0 000411   200013 756100                    STQ     P$,,AUTO

      253     1225    3              F$=F.FL$;

   1225  0 000412   100001 236100                    LDQ     1,,PR1
         0 000413   200007 756100                    STQ     F$,,AUTO

      254     1226    3              END;

   1226  0 000414   000004 236000 1                  LDQ     4
         0 000415   200007 116100                    CMPQ    F$,,AUTO
         0 000416   000377 601000 0                  TNZ     s:1223

      255     1227    2           RETURN;

   1227  0 000417   200014 221300                    LDX1  ! P$+1,,AUTO
         0 000420   000001 702211                    TSX2  ! 1,X1

      256     1228    2   END FIND;
      257     1229        /**/
      258     1230        /* FIND PREVIOUS ENTRY IN FREE SPACE LIST, RETURN IN P$ */
      259     1231        /**/
      260     1232    1   FINDPREV: PROC;

   1232  0 000421   200014 741300       FINDPREV     STX1  ! P$+1,,AUTO

      261     1233    2           P$=ADDR(FREE);

   1233  0 000422   000004 236000 1                  LDQ     4
         0 000423   200013 756100                    STQ     P$,,AUTO

      262     1234    3           DO WHILE(P$->F.FL$~=F$);

PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:53   
   1234  0 000424   200013 470500                    LDP0    P$,,AUTO
         0 000425   000001 236100                    LDQ     1,,PR0
         0 000426   200007 116100                    CMPQ    F$,,AUTO
         0 000427   000437 600000 0                  TZE     s:1237

      263     1235    3              P$=P$->F.FL$;

   1235  0 000430   200013 470500                    LDP0    P$,,AUTO
         0 000431   000001 236100                    LDQ     1,,PR0
         0 000432   200013 756100                    STQ     P$,,AUTO

      264     1236    3              END;

   1236  0 000433   200013 470500                    LDP0    P$,,AUTO
         0 000434   000001 236100                    LDQ     1,,PR0
         0 000435   200007 116100                    CMPQ    F$,,AUTO
         0 000436   000430 601000 0                  TNZ     s:1235

      265     1237    2   END FINDPREV;

   1237  0 000437   200014 221300                    LDX1  ! P$+1,,AUTO
         0 000440   000001 702211                    TSX2  ! 1,X1

      266     1238        /**/
      267     1239        /* DELINK F$->SPACE FROM FREE SPACE LIST */
      268     1240        /**/
      269     1241    1   DELINK: PROC;

   1241  0 000441   200014 741300       DELINK       STX1  ! P$+1,,AUTO

      270     1242    2           F.FREE='0'B;

   1242  0 000442   200007 470500                    LDP0    F$,,AUTO
         0 000443   000031 236000 xsym               LDQ     B_VECTNIL+25
         0 000444   000000 356100                    ANSQ    0,,PR0

      271     1243    2           P$->F.FL$=F.FL$;
PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:54   

   1243  0 000445   000001 236100                    LDQ     1,,PR0
         0 000446   200013 471500                    LDP1    P$,,AUTO
         0 000447   100001 756100                    STQ     1,,PR1

      272     1244    2           PINCRW(F$,F.NW)->F.PFREE='0'B;

   1244  0 000450   000000 220100                    LDX0    0,,PR0
         0 000451   377777 360003                    ANX0    131071,DU
         0 000452   000001 236000 1                  LDQ     1
         0 000453   000000 356110                    ANSQ    0,X0,PR0

      273     1245    2           RETURN;

   1245  0 000454   200014 221300                    LDX1  ! P$+1,,AUTO
         0 000455   000001 702211                    TSX2  ! 1,X1

(unnamed)
 Sect OctLoc
   1     000   000000 006013   777777 377777   000003 006000   000000 006000    ................
   1     004   000000 006000   000000 006000                                    ........
      274     1246    2   END DELINK;
      275     1247    1   END IVO$GET;
      276     1248        %EOD;

PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:55   
--  Include file information  --

   MM_MACRO_M.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   MM$SYSGEN.:E05TOU  is referenced.
   M_INFO_C.:E05TOU  is referenced.
   MM_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure IVO$GET.
PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:56   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @D$                        4-0-0/w PTR         r     1 @NWP
    15-0-0/w PTR         r     1 @SN                        6-0-0/w PTR         r     1 C$
    *0-0-0/w PTR         r     1 D$                        10-0-0/w SBIN        r     1 ERRWD
     7-0-0/w PTR         r     1 F$                        11-0-0/w SBIN        r     1 I
    12-0-0/w SBIN        r     1 N                          5-0-0/w SBIN        r     1 NW
    *0-0-0/w SBIN        r     1 NWP                       13-0-0/w PTR         r     1 P$
    *0-0-0/w SBIN        r     1 SN

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$DS8$                     0-0-0/d STRC(72)    r     1 FREE
     0-0-0/w PTR         r     1 MM_BYP$
     0-0-0/b UBIN(9)     r     1 MM_DSMAX(0:7)
     0-0-0/w SBIN        r     1 SEGSIZE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(72)    r     1 F                          0-0-0/w SBIN        r     1 FW


   Procedure IVO$GET requires 302 words for executable code.
   Procedure IVO$GET requires 18 words of local(AUTO) storage.
PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:57   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:58   
          MINI XREF LISTING

AGGLUT
      1165**LABEL    1171--GOTO
B$DS8$
      1081**DCL      1122>>ASSIGN   1128>>ASSIGN   1174>>IF       1175>>IF
C$
      1104**DCL      1133<<ASSIGN   1134>>ASSIGN   1135>>ASSIGN   1145<<ASSIGN   1146>>ASSIGN   1147>>ASSIGN
      1164<<ASSIGN   1166>>ASSIGN   1174>>IF       1175>>IF       1180>>ASSIGN   1187>>ASSIGN   1188>>ASSIGN
      1189>>ASSIGN   1190>>ASSIGN   1191>>ASSIGN
D$
        13**DCL         9--PROC     1136<<ASSIGN   1141<<ASSIGN   1155--ENTRY    1156>>ASSIGN
DELINK
      1241**PROC     1140--CALL     1162--CALL     1170--CALL
ERRWD
      1106**DCL      1125<>CALL     1181<>CALL     1208<>CALL
F.FL$
      1092**DCL      1189<<ASSIGN   1190<<ASSIGN   1225>>ASSIGN   1234>>DOWHILE  1235>>ASSIGN   1243<<ASSIGN
      1243>>ASSIGN
F.FREE
      1088**DCL      1131<<ASSIGN   1167>>IF       1180<<ASSIGN   1187<<ASSIGN   1242<<ASSIGN
F.NW
      1089**DCL      1132<<ASSIGN   1142>>ASSIGN   1144<<ASSIGN   1145>>ASSIGN   1147>>ASSIGN   1157>>ASSIGN
      1168>>ASSIGN   1188<<ASSIGN   1223>>IF       1244>>ASSIGN
F.PFREE
      1090**DCL      1146<<ASSIGN   1158>>DOWHILE  1192<<ASSIGN   1244<<ASSIGN
F.PNW
      1091**DCL      1135<<ASSIGN   1147<<ASSIGN   1159>>ASSIGN   1160>>ASSIGN   1193<<ASSIGN
F$
      1105**DCL      1087--IMP-PTR  1093--IMP-PTR  1118<<ASSIGN   1122<<ASSIGN   1127>>IF       1128<<ASSIGN
      1129>>ASSIGN   1131>>ASSIGN   1132>>ASSIGN   1133>>ASSIGN   1136>>ASSIGN   1141>>ASSIGN   1142>>ASSIGN
      1144>>ASSIGN   1145>>ASSIGN   1145>>ASSIGN   1147>>ASSIGN   1156<<ASSIGN   1157>>ASSIGN   1158>>DOWHILE
      1159>>ASSIGN   1160<<ASSIGN   1160>>ASSIGN   1160>>ASSIGN   1164>>ASSIGN   1166<<ASSIGN   1167>>IF
      1168>>ASSIGN   1189>>ASSIGN   1191<<ASSIGN   1192>>ASSIGN   1193>>ASSIGN   1220<<ASSIGN   1222>>DOWHILE
PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:59   
      1223>>IF       1224>>ASSIGN   1225<<ASSIGN   1225>>ASSIGN   1234>>DOWHILE  1242>>ASSIGN   1243>>ASSIGN
      1244>>ASSIGN   1244>>ASSIGN
FIND
      1217**PROC     1116--CALL     1186--CALL
FINDPREV
      1232**PROC     1161--CALL     1169--CALL
FOUND
      1140**LABEL    1116--CALLALT
FREE
      1097**DCL      1177--ASSIGN   1200--ASSIGN   1221--ASSIGN   1222--DOWHILE  1233--ASSIGN
FREE.FL$
      1099**DCL      1177<<ASSIGN   1200<<ASSIGN   1220>>ASSIGN
FW
      1093**DCL      1129<<ASSIGN   1134<<ASSIGN
GDS_ERR
      1151**LABEL    1125--CALLALT  1181--CALLALT
I
      1107**DCL      1119<<ASSIGN   1123<<ASSIGN   1125<>CALL     1126>>ASSIGN
MM$DESC.BOUND
      1029**DCL      1030--REDEF
MM$DESC.FLGS
      1030**DCL      1030--REDEF
MM$PPUT.USER#
      1018**DCL      1018--REDEF
MMH$FDS
      1083**DCL-ENT  1181--CALL     1208--CALL
MMH$GDS
      1082**DCL-ENT  1125--CALL
MM_BYP$
       949**DCL       949--IMP-PTR
MM_DSMAX
       952**DCL      1201<<ASSIGN   1209<<ASSIGN
N
      1108**DCL      1115<<ASSIGN   1116<>CALL     1119>>ASSIGN   1123>>ASSIGN   1132>>ASSIGN   1133>>ASSIGN
      1135>>ASSIGN   1142<<ASSIGN   1142>>ASSIGN   1143>>IF       1157<<ASSIGN   1159<<ASSIGN   1159>>ASSIGN
      1166>>ASSIGN   1168<<ASSIGN   1168>>ASSIGN   1174>>IF       1176<<ASSIGN   1176>>ASSIGN   1181<>CALL
PL6.E3A0      #002=IVO$GET File=IVO$OFFLINE.:E05TSI                              TUE 07/29/97 23:13 Page:60   
      1182>>ASSIGN   1186<>CALL     1188>>ASSIGN   1191>>ASSIGN   1193>>ASSIGN
NO_MORE
      1174**LABEL    1167--GOTO
NW
        15**DCL      1114<<ASSIGN   1115>>ASSIGN   1144>>ASSIGN
NWP
        14**DCL         9--PROC     1114>>ASSIGN   1114>>ASSIGN
P$
      1109**DCL      1190>>ASSIGN   1221<<ASSIGN   1224<<ASSIGN   1233<<ASSIGN   1234>>DOWHILE  1235<<ASSIGN
      1235>>ASSIGN   1243>>ASSIGN
RELINK
      1186**LABEL    1148--GOTO
SEGSIZE
      1100**DCL      1117>>IF       1122>>ASSIGN   1126<<ASSIGN   1126>>ASSIGN   1174>>IF       1182<<ASSIGN
      1182>>ASSIGN   1202<<ASSIGN   1208>>IF       1208<>CALL
SN IN PROCEDURE FIND
      1218**DCL      1217--PROC     1223>>IF

PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:61   
      277        1        /*T***********************************************************/
      278        2        /*T*                                                         */
      279        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      280        4        /*T*                                                         */
      281        5        /*T***********************************************************/
      282        6        /**/
      283        7        /* INITIALIZATION ROUTINE */
      284        8        /**/
      285        9        IVO$INIT: PROC (PARAME,DIAG) ALTRET;
      286       10        /**/
      287       11        /* INCLUDE FILES */
      288       12        /**/
      289       13        %INCLUDE B_SEGIDS_C;
      290      552        %INCLUDE B_STRINGS_C;
      291      681        %INCLUDE B$TABLES_C;
      292      789        %INCLUDE CP_6_SUBS;
      293     1329        %INCLUDE IV_SUBS_C;
      294     1392        %INCLUDE N_FC_C;
      295     1429        %INCLUDE NI_DATA_R;
      296     1866        %INCLUDE XU_MACRO_C;
      297     4972        /**/
      298     4973        /* PARAMETERS */
      299     4974        /**/
      300     4975        %PARSE$PARAM(NAME=PARAME);
      301     5056    1   DCL 1 SWP REDEF PARAME,
      302     5057    1         2 DEVID CHAR(4),
      303     5058    1         2 *(0:6) SBIN;
      304     5059    1   DCL 1 PROMPT REDEF PARAME,
      305     5060    1         2 CHR CHAR(1) ALIGNED,
      306     5061    1         2 *(0:6) SBIN;
      307     5062    1   DCL 1 KEYIN REDEF PARAME,
      308     5063    1         2 CMD SBIN,
      309     5064    1         2 *(0:6) SBIN;
      310     5065    1   DCL DIAG BIT(1) UNAL;
      311     5066    1   DCL IV_ONLINE BIT(1) ALIGNED CONSTANT SYMDEF INIT('0'B);
      312     5067        /**/
      313     5068        /* SUBSTITUTIONS */
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:62   
      314     5069        /**/
      315     5070        %EQU CMDBUFSZ=256;
      316     5071        %SUB NULL="ADDR(NIL)";
      317     5072        %EQU WORKSZ=768;
      318     5073        /**/
      319     5074        /* STATIC DATA */
      320     5075        /**/
      321     5076    1   DCL CONSOLE_DCTX UBIN(15) SYMREF;       /* CONSOLE DCTX */
      322     5077    1   DCL IN_DCTX UBIN(15) SYMREF;            /* INPUT DCTX */
      323     5078    1   DCL OUT_DCTX UBIN(15) SYMREF;           /* OUTPUT DCTX */
      324     5079    1   DCL B_SCDCTX UBIN SYMREF;
      325     5080    1   DCL PCB$ PTR SYMREF;
      326     5081    1   DCL PRCHAR CHAR(1) SYMREF ALIGNED;      /* PROMPT CHARACTER */
      327     5082        /**/
      328     5083        /* EXTERNAL REFERENCES */
      329     5084        /**/
      330     5085    1   DCL B$DS7$ PTR SYMREF;
      331     5086    1   DCL IVO$GET_CLEANUP ENTRY ALTRET;
      332     5087    1   DCL IVO$GET_INIT ENTRY ALTRET;
      333     5088    1   DCL IVO$OPINT ENTRY (3) ALTRET;
      334     5089    1   DCL IVO$WAIT ENTRY (1) ALTRET;
      335     5090    1   DCL IVV$ERROR ENTRY (3);
      336     5091    1   DCL MMH$GDS ENTRY(5) ALTRET;
      337     5092    1   DCL MMH$FDS ENTRY(4) ALTRET;
      338     5093    1   DCL NIO$QUE ENTRY (1) ALTRET;
      339     5094    1   DCL NIO$SPINTCON ENTRY (3) ALTRET;
      340     5095    1   DCL NIQ$GET ENTRY (1) ALTRET;
      341     5096    1   DCL NIQ$REL ENTRY (1) ALTRET;
      342     5097    1   DCL OCI$SPINTCON ENTRY(1);
      343     5098    1   DCL OCX$XDELTA ENTRY ALTRET;
      344     5099        /**/
      345     5100        /* DATA STRUCTURES */
      346     5101        /**/
      347     5102        %N$REQ(NAME=REQ,STCLASS="BASED(REQ$)");
      348     5160        %NI$DCT(NAME=DCT);
      349     5208        %P$PCB(NAME=PCB,STCLASS="BASED(PCB$)");
      350     5409    1   DCL PRBUF CHAR(1) BASED ALIGNED;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:63   
      351     5410    1   DCL TEXT CHAR(%CMDBUFSZ) BASED ALIGNED;
      352     5411        /**/
      353     5412        /* AUTO STACK */
      354     5413        /**/
      355     5414    1   DCL ARS SBIN;
      356     5415    1   DCL CP SBIN;
      357     5416    1   DCL REQ$ PTR;
      358     5417    1   DCL ERRWD SBIN;
      359     5418    1   DCL OCBUF CHAR(80);
      360     5419        /**/
      361     5420    1   DCL OUT$ PTR;
      362     5421    1   DCL 1 OUT BASED(OUT$),
      363     5422    1         2 LEN SBIN,
      364     5423    1         2 MSG CHAR(OUT.LEN);
      365     5424        %EJECT;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:64   
      366     5425    1           CALL MMH$GDS(%MONWSQ,BITBIN(%DS7SID),%(WORKSZ+CMDBUFSZ/4),ERRWD) ALTRET(
              5425                    GDS_ERR);
      367     5426    1           PCB$=ADDR(PARAME);
      368     5427    1           PCB.TEXT$=PINCRW(B$DS7$,%WORKSZ);
      369     5428    1           PCB.NCHARS=0;
      370     5429    1           PCB.WORK$=B$DS7$;
      371     5430    1           PCB.WKSZ=%WORKSZ;
      372     5431    1           CALL IVO$GET_INIT;
      373     5432    1           CONSOLE_DCTX=B_SCDCTX;
      374     5433    1           CALL NIO$SPINTCON(CONSOLE_DCTX,ENTADDR(IVO$OPINT),0);
      375     5434    1           IN_DCTX=CONSOLE_DCTX;
      376     5435    1           OUT_DCTX=CONSOLE_DCTX;
      377     5436    1           RETURN;
      378     5437    1   GDS_ERR:
      379     5438    1           ALTRETURN;
      380     5439        %EJECT;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:65   
      381     5440        /**/
      382     5441        /* ALTRETURN IF BATCH */
      383     5442        /**/
      384     5443    1   IVO$BATCH: ENTRY ALTRET;
      385     5444    1           RETURN;
      386     5445        %EJECT;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:66   
      387     5446        /**/
      388     5447        /* CLEAN-UP ROUTINE */
      389     5448        /**/
      390     5449    1   IVO$CLEANUP: ENTRY ALTRET;
      391     5450    1           CALL NIO$SPINTCON(CONSOLE_DCTX,ENTADDR(NIL),0);
      392     5451    1           CALL MMH$FDS(%MONWSQ,BITBIN(%DS7SID),%(WORKSZ+CMDBUFSZ/4),ERRWD);
      393     5452    1           CALL IVO$GET_CLEANUP;
      394     5453    1   FREEZE: CP=0; CP=10; GOTO FREEZE;       /* FREEZE FOR OFFLINE */
      395     5454        %EJECT;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:67   
      396     5455        /**/
      397     5456        /* READ CONTINUATION OF COMMAND */
      398     5457        /**/
      399     5458    1   IVO$CONT: ENTRY (PARAME) ALTRET;
      400     5459    1           CP=((PARAME.CHARPOS+3)/4)*4;
      401     5460    1           CALL INSERT(PCB.TEXT$->TEXT,PARAME.CHARPOS,CP-PARAME.CHARPOS,'   ');
      402     5461    1           IF CP>=%CMDBUFSZ THEN RETURN;
      403     5462    1           PARAME.CHARPOS=CP;
      404     5463    1           REQ$=ADDR(NIL);
      405     5464    1           CALL NIQ$GET(REQ$) ALTRET(CONT_ERR);
      406     5465    1           REQ.DLA.DCTX=IN_DCTX;
      407     5466    1           REQ.BUFSIZE=%CMDBUFSZ-PARAME.CHARPOS;
      408     5467    1           REQ.FC=%N_READ;
      409     5468    1           REQ.OPFLG=OP_BPF | OP_HOLD;
      410     5469    1           REQ.BUF$=PINCRC(PCB.TEXT$,PARAME.CHARPOS);
      411     5470    1           REQ.BUF$->PRBUF='+';
      412     5471    1           CALL READ ALTRET(CONT_ERR);
      413     5472    1           PCB.NCHARS=PARAME.CHARPOS+ARS;
      414     5473    2           DO WHILE ('0'B);
      415     5474    2   CONT_ERR:
      416     5475    2              CALL IVV$ERROR(,11);
      417     5476    2              CALL INSERT(PCB.TEXT$->TEXT,PARAME.CHARPOS,1,' ');
      418     5477    2              PCB.NCHARS=PARAME.CHARPOS+1;
      419     5478    2              END;
      420     5479    1           RETURN;
      421     5480        %EJECT;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:68   
      422     5481        /**/
      423     5482        /* INVOKE DELTA OR KEYIN */
      424     5483        /**/
      425     5484    1   IVO$KEYIN: ENTRY (PARAME) ALTRET;
      426     5485    1           IF KEYIN.CMD=#DELTA THEN CALL OCX$XDELTA;
      427     5486    1           ELSE CALL OCI$SPINTCON;
      428     5487    1           RETURN;
      429     5488        %EJECT;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:69   
      430     5489        /**/
      431     5490        /* PRINT OUTPUT */
      432     5491        /**/
      433     5492    1   IVO$PRINT: ENTRY (PARAME,DIAG) ALTRET;
      434     5493    1           OUT$=ADDR(PARAME);
      435     5494    1           CALL NIQ$GET(REQ$) ALTRET(PRINT_ERR_2);
      436     5495    1           REQ.DLA.DCTX=OUT_DCTX;
      437     5496    1           REQ.BUFSIZE=OUT.LEN-1;
      438     5497    1           REQ.FC=%N_WRITE;
      439     5498    1           REQ.OPFLG=OP_BPF | OP_HOLD;
      440     5499    1           OCBUF=SUBSTR(OUT.MSG,1);
      441     5500    1           REQ.BUF$=ADDR(OCBUF);
      442     5501    1           REQ.RCT=1;
      443     5502    1           REQ.DVE.VFC=SUBSTR(OUT.MSG,0,1);
      444     5503    1           CALL NIO$QUE(REQ) ALTRET(PRINT_ERR);
      445     5504    2           DO WHILE (NOT REQ.TYC.EGV);
      446     5505    2              CALL IVO$WAIT('0'B);
      447     5506    2              END;
      448     5507    1   PRINT_ERR:
      449     5508    2           IF DIAG AND OUT_DCTX~=CONSOLE_DCTX THEN DO;
      450     5509    2              REQ.DLA.DCTX=CONSOLE_DCTX;
      451     5510    2              CALL NIO$QUE(REQ) ALTRET(PRINT_ERR_1);
      452     5511    3              DO WHILE (NOT REQ.TYC.EGV);
      453     5512    3                 CALL IVO$WAIT('0'B);
      454     5513    3                 END;
      455     5514    2   PRINT_ERR_1:
      456     5515    2              END/* IF DIAG */;
      457     5516    1           CALL NIQ$REL(REQ$);
      458     5517    1   PRINT_ERR_2:
      459     5518    1           RETURN;
      460     5519        %EJECT;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:70   
      461     5520        /**/
      462     5521        /* READ COMMAND */
      463     5522        /**/
      464     5523    1   IVO$READ: ENTRY ALTRET;
      465     5524    1           CALL NIQ$GET(REQ$) ALTRET(READ_ERR);
      466     5525    1           REQ.DLA.DCTX=IN_DCTX;
      467     5526    1           REQ.BUFSIZE=%CMDBUFSZ;
      468     5527    1           REQ.FC=%N_READ;
      469     5528    1           REQ.OPFLG=OP_BPF | OP_HOLD;
      470     5529    1           REQ.BUF$=PCB.TEXT$;
      471     5530    1           REQ.BUF$->PRBUF=PRCHAR;
      472     5531    1           CALL READ ALTRET(READ_ERR);
      473     5532    1           PCB.NCHARS=ARS;
      474     5533    1           RETURN;
      475     5534        /**/
      476     5535    1   READ_ERR:
      477     5536    1           CALL IVV$ERROR(,11);
      478     5537    1           ALTRETURN;
      479     5538        %EJECT;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:71   
      480     5539        /**/
      481     5540        /* SET PROMPT CHARACTER */
      482     5541        /**/
      483     5542    1   IVO$SETPC: ENTRY (PARAME) ALTRET;
      484     5543    1           PRCHAR=PROMPT.CHR;
      485     5544    1           RETURN;
      486     5545        %EJECT;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:72   
      487     5546        /**/
      488     5547        /* SWAP INPUT */
      489     5548        /**/
      490     5549    1   IVO$SWIN: ENTRY (PARAME) ALTRET;
      491     5550    1           CP=1;
      492     5551    2           DO WHILE (N$DCT$(CP)~=ADDR(NIL));
      493     5552    3              IF SWP.DEVID=SUBSTR(N$DCT$(CP)->DCT.DEVNM,0,4) THEN DO;
      494     5553    3                 IF NOT N$DCT$(CP)->DCT.DFLG.INPUT THEN GOTO SWAP_ERR;
      495     5554    3                 IN_DCTX=CP;
      496     5555    3                 RETURN;
      497     5556    3                 END;
      498     5557    2              CP=CP+1;
      499     5558    2              END/* WHILE N$DCT$(CP) */;
      500     5559    1           GOTO SWAP_ERR;
      501     5560        /**/
      502     5561        /* SWAP OUTPUT */
      503     5562        /**/
      504     5563    1   IVO$SWOUT: ENTRY (PARAME) ALTRET;
      505     5564    1           CP=1;
      506     5565    2           DO WHILE (N$DCT$(CP)~=ADDR(NIL));
      507     5566    3              IF SWP.DEVID=SUBSTR(N$DCT$(CP)->DCT.DEVNM,0,4) THEN DO;
      508     5567    3                 IF NOT N$DCT$(CP)->DCT.DFLG.OUTPUT THEN GOTO SWAP_ERR;
      509     5568    3                 OUT_DCTX=CP;
      510     5569    3                 RETURN;
      511     5570    3                 END;
      512     5571    2              CP=CP+1;
      513     5572    2              END/* WHILE N$DCT$(CP) */;
      514     5573    1   SWAP_ERR:
      515     5574    1           CALL IVV$ERROR(,4);
      516     5575    1           ALTRETURN;
      517     5576        %EJECT;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:73   
      518     5577        /**/
      519     5578        /* READ AND EDIT INPUT BUFFER */
      520     5579        /**/
      521     5580    1   READ:   PROC ALTRET;
      522     5581        /**/
      523     5582        /* LOCAL DATA */
      524     5583        /**/
      525     5584    2   DCL CMDPRBUF CHAR(%CMDBUFSZ) ALIGNED;
      526     5585        %B$XL_UPPER_UR(NAME=UC);
      527     5589        /**/
      528     5590    2           CALL INSERT(CMDPRBUF,1,1,REQ.BUF$->PRBUF);
      529     5591    3   READ_LOOP: DO;
      530     5592    3              CALL NIO$QUE(REQ) ALTRET(READ_ERR);
      531     5593    4              DO WHILE (NOT REQ.TYC.EGV);
      532     5594    4                 CALL IVO$WAIT('0'B);
      533     5595    4                 END;
      534     5596    3              IF REQ.TYC~=%TYC_EGV THEN
      535     5597    4                 IF REQ.TYC&%TYC_TIMO THEN DO;
      536     5598    4                    REQ.BUF$->PRBUF=SUBSTR(CMDPRBUF,1,1);
      537     5599    4                    GOTO READ_LOOP;
      538     5600    4                    END;
      539     5601    4                 ELSE DO;
      540     5602    4   READ_ERR:
      541     5603    4                    CALL NIQ$REL(REQ$);
      542     5604    4                    ALTRETURN;
      543     5605    4                    END;
      544     5606        /**/
      545     5607    3              END READ_LOOP;
      546     5608    2           ARS=REQ.ARSIZE;
      547     5609    2           CALL XLATE(SUBSTR(REQ.BUF$->TEXT,0,ARS),UC,SUBSTR(REQ.BUF$->TEXT,0,ARS));
      548     5610    3           IF IN_DCTX~=OUT_DCTX THEN DO;
      549     5611    3              REQ.BUFSIZE=((ARS+5)/4)*4-1;
      550     5612    3              IF REQ.BUFSIZE<7 THEN REQ.BUFSIZE=7;
      551     5613    3              IF REQ.BUFSIZE>%(CMDBUFSZ-1) THEN REQ.BUFSIZE=%(CMDBUFSZ-1);
      552     5614    3              CALL INSERT(CMDPRBUF,2,REQ.BUFSIZE,SUBSTR(REQ.BUF$->TEXT,0,ARS));
      553     5615    3              REQ.DLA.DCTX=OUT_DCTX;
      554     5616    3              REQ.FC=%N_WRITE;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:74   
      555     5617    3              REQ.OPFLG=OP_BPF | OP_HOLD;
      556     5618    3              REQ.BUF$=ADDR(SUBSTR(CMDPRBUF,1));
      557     5619    3              REQ.RCT=1;
      558     5620    3              REQ.DVE.VFC='A';
      559     5621    3              CALL NIO$QUE(REQ) ALTRET(PRINT_ERR);
      560     5622    4              DO WHILE (NOT REQ.TYC.EGV);
      561     5623    4                 CALL IVO$WAIT('0'B);
      562     5624    4                 END;
      563     5625    3   PRINT_ERR:
      564     5626    3              END/* IF IN_DCTX */;
      565     5627    2           CALL NIQ$REL(REQ$);
      566     5628    2           RETURN;
      567     5629    2   END READ;
      568     5630    1   END IVO$INIT;
      569     5631        %EOD;

PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:75   
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   N_FC_C.:E05TOU  is referenced.
   IV_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure IVO$INIT.

   Procedure IVO$INIT requires 509 words for executable code.
   Procedure IVO$INIT requires 100 words of local(AUTO) storage.

PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:76   

 Object Unit name= IVO$INIT                                   File name= IVO$OFFLINE.:E05TOU
 UTS= JUL 29 '97 23:13:42.36 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      2      2  IVO$INIT
    1   Proc  even  none   509    775  IVO$INIT
    2  RoData even  none    17     21  IVO$INIT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        2  IVO$INIT
     1     64          yes     yes      Std        0  IVO$BATCH
     1     67          yes     yes      Std        0  IVO$CLEANUP
     1    116          yes     yes      Std        1  IVO$CONT
     1    243          yes     yes      Std        1  IVO$KEYIN
     1    261          yes     yes      Std        2  IVO$PRINT
     1    412          yes     yes      Std        0  IVO$READ
     1    471          yes     yes      Std        1  IVO$SETPC
     1    501          yes     yes      Std        1  IVO$SWIN
     1    533          yes     yes      Std        1  IVO$SWOUT

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  IV_ONLINE
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:77   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 B_POINTER
 yes     yes           Std       4 MMH$FDS
 yes     yes           Std       1 NIO$QUE
 yes     yes           Std       5 MMH$GDS
 yes     yes           Std       0 IVO$GET_INIT
 yes     yes           Std       3 NIO$SPINTCON
 yes     yes           Std       0 IVO$GET_CLEANUP
         yes           Std       3 IVV$ERROR
 yes     yes           Std       1 NIQ$REL
 yes     yes           Std       1 NIQ$GET
 yes     yes           Std       0 OCX$XDELTA
 yes     yes           Std       3 IVO$OPINT
         yes           Std       1 OCI$SPINTCON
 yes     yes           Std       1 IVO$WAIT
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     N$DCT$$                               N$FQ$                                 NI$FQ$
     NI$IBUF$                              NI$RP$                                CONSOLE_DCTX
     IN_DCTX                               OUT_DCTX                              B_SCDCTX
     PCB$                                  PRCHAR                                B$DS7$
r    B$XL_UPPER_UR$                        B_VECTNIL
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:78   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:79   


      277        1        /*T***********************************************************/
      278        2        /*T*                                                         */
      279        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      280        4        /*T*                                                         */
      281        5        /*T***********************************************************/
      282        6        /**/
      283        7        /* INITIALIZATION ROUTINE */
      284        8        /**/
      285        9        IVO$INIT: PROC (PARAME,DIAG) ALTRET;

      9  1 000000   000000 700200 xent  IVO$INIT     TSX0  ! X66_AUTO_2
         1 000001   000144 000002                    ZERO    100,2

      286       10        /**/
      287       11        /* INCLUDE FILES */
      288       12        /**/
      289       13        %INCLUDE B_SEGIDS_C;
      290      552        %INCLUDE B_STRINGS_C;
      291      681        %INCLUDE B$TABLES_C;
      292      789        %INCLUDE CP_6_SUBS;
      293     1329        %INCLUDE IV_SUBS_C;
      294     1392        %INCLUDE N_FC_C;
      295     1429        %INCLUDE NI_DATA_R;
      296     1866        %INCLUDE XU_MACRO_C;
      297     4972        /**/
      298     4973        /* PARAMETERS */
      299     4974        /**/
      300     4975        %PARSE$PARAM(NAME=PARAME);
      301     5056    1   DCL 1 SWP REDEF PARAME,
      302     5057    1         2 DEVID CHAR(4),
      303     5058    1         2 *(0:6) SBIN;
      304     5059    1   DCL 1 PROMPT REDEF PARAME,
      305     5060    1         2 CHR CHAR(1) ALIGNED,
      306     5061    1         2 *(0:6) SBIN;
      307     5062    1   DCL 1 KEYIN REDEF PARAME,
      308     5063    1         2 CMD SBIN,
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:80   
      309     5064    1         2 *(0:6) SBIN;
      310     5065    1   DCL DIAG BIT(1) UNAL;
      311     5066    1   DCL IV_ONLINE BIT(1) ALIGNED CONSTANT SYMDEF INIT('0'B);
      312     5067        /**/
      313     5068        /* SUBSTITUTIONS */
      314     5069        /**/
      315     5070        %EQU CMDBUFSZ=256;
      316     5071        %SUB NULL="ADDR(NIL)";
      317     5072        %EQU WORKSZ=768;
      318     5073        /**/
      319     5074        /* STATIC DATA */
      320     5075        /**/
      321     5076    1   DCL CONSOLE_DCTX UBIN(15) SYMREF;       /* CONSOLE DCTX */
      322     5077    1   DCL IN_DCTX UBIN(15) SYMREF;            /* INPUT DCTX */
      323     5078    1   DCL OUT_DCTX UBIN(15) SYMREF;           /* OUTPUT DCTX */
      324     5079    1   DCL B_SCDCTX UBIN SYMREF;
      325     5080    1   DCL PCB$ PTR SYMREF;
      326     5081    1   DCL PRCHAR CHAR(1) SYMREF ALIGNED;      /* PROMPT CHARACTER */
      327     5082        /**/
      328     5083        /* EXTERNAL REFERENCES */
      329     5084        /**/
      330     5085    1   DCL B$DS7$ PTR SYMREF;
      331     5086    1   DCL IVO$GET_CLEANUP ENTRY ALTRET;
      332     5087    1   DCL IVO$GET_INIT ENTRY ALTRET;
      333     5088    1   DCL IVO$OPINT ENTRY (3) ALTRET;
      334     5089    1   DCL IVO$WAIT ENTRY (1) ALTRET;
      335     5090    1   DCL IVV$ERROR ENTRY (3);
      336     5091    1   DCL MMH$GDS ENTRY(5) ALTRET;
      337     5092    1   DCL MMH$FDS ENTRY(4) ALTRET;
      338     5093    1   DCL NIO$QUE ENTRY (1) ALTRET;
      339     5094    1   DCL NIO$SPINTCON ENTRY (3) ALTRET;
      340     5095    1   DCL NIQ$GET ENTRY (1) ALTRET;
      341     5096    1   DCL NIQ$REL ENTRY (1) ALTRET;
      342     5097    1   DCL OCI$SPINTCON ENTRY(1);
      343     5098    1   DCL OCX$XDELTA ENTRY ALTRET;
      344     5099        /**/
      345     5100        /* DATA STRUCTURES */
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:81   
      346     5101        /**/
      347     5102        %N$REQ(NAME=REQ,STCLASS="BASED(REQ$)");
      348     5160        %NI$DCT(NAME=DCT);
      349     5208        %P$PCB(NAME=PCB,STCLASS="BASED(PCB$)");
      350     5409    1   DCL PRBUF CHAR(1) BASED ALIGNED;
      351     5410    1   DCL TEXT CHAR(%CMDBUFSZ) BASED ALIGNED;
      352     5411        /**/
      353     5412        /* AUTO STACK */
      354     5413        /**/
      355     5414    1   DCL ARS SBIN;
      356     5415    1   DCL CP SBIN;
      357     5416    1   DCL REQ$ PTR;
      358     5417    1   DCL ERRWD SBIN;
      359     5418    1   DCL OCBUF CHAR(80);
      360     5419        /**/
      361     5420    1   DCL OUT$ PTR;
      362     5421    1   DCL 1 OUT BASED(OUT$),
      363     5422    1         2 LEN SBIN,
      364     5423    1         2 MSG CHAR(OUT.LEN);
      365     5424        %EJECT;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:82   
      366     5425    1           CALL MMH$GDS(%MONWSQ,BITBIN(%DS7SID),%(WORKSZ+CMDBUFSZ/4),ERRWD) ALTRET(
              5425                    GDS_ERR);

   5425  1 000002   200010 630500                    EPPR0   ERRWD,,AUTO
         1 000003   200143 450500                    STP0    CMDPRBUF+68,,AUTO
         1 000004   000002 236000 2                  LDQ     2
         1 000005   200142 756100                    STQ     CMDPRBUF+67,,AUTO
         1 000006   000004 237000 2                  LDAQ    4
         1 000007   200140 757100                    STAQ    CMDPRBUF+65,,AUTO
         1 000010   200140 630500                    EPPR0   CMDPRBUF+65,,AUTO
         1 000011   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000012   000000 701000 xent               TSX1    MMH$GDS
         1 000013   000063 702000 1                  TSX2    GDS_ERR

      367     5426    1           PCB$=ADDR(PARAME);

   5426  1 000014   200003 236100                    LDQ     @PARAME,,AUTO
         1 000015   000000 756000 xsym               STQ     PCB$

      368     5427    1           PCB.TEXT$=PINCRW(B$DS7$,%WORKSZ);

   5427  1 000016   000000 236000 xsym               LDQ     B$DS7$
         1 000017   001400 036003                    ADLQ    768,DU
         1 000020   000000 470400 xsym               LDP0    PCB$
         1 000021   000000 756100                    STQ     0,,PR0

      369     5428    1           PCB.NCHARS=0;

   5428  1 000022   000000 470400 xsym               LDP0    PCB$
         1 000023   000011 450100                    STZ     9,,PR0

      370     5429    1           PCB.WORK$=B$DS7$;

   5429  1 000024   000000 236000 xsym               LDQ     B$DS7$
         1 000025   000002 756100                    STQ     2,,PR0

      371     5430    1           PCB.WKSZ=%WORKSZ;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:83   

   5430  1 000026   001400 220003                    LDX0    768,DU
         1 000027   000005 740100                    STX0    5,,PR0

      372     5431    1           CALL IVO$GET_INIT;

   5431  1 000030   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000031   000000 701000 xent               TSX1    IVO$GET_INIT
         1 000032   000000 011000                    NOP     0

      373     5432    1           CONSOLE_DCTX=B_SCDCTX;

   5432  1 000033   000000 235000 xsym               LDA     B_SCDCTX
         1 000034   000025 735000                    ALS     21
         1 000035   000000 755000 xsym               STA     CONSOLE_DCTX

      374     5433    1           CALL NIO$SPINTCON(CONSOLE_DCTX,ENTADDR(IVO$OPINT),0);

   5433  1 000036   000000 636000 xent               EAQ     IVO$OPINT
         1 000037   200140 756100                    STQ     CMDPRBUF+65,,AUTO
         1 000040   000006 236000 2                  LDQ     6
         1 000041   200143 756100                    STQ     CMDPRBUF+68,,AUTO
         1 000042   200140 630500                    EPPR0   CMDPRBUF+65,,AUTO
         1 000043   200142 450500                    STP0    CMDPRBUF+67,,AUTO
         1 000044   000007 236000 2                  LDQ     7
         1 000045   200141 756100                    STQ     CMDPRBUF+66,,AUTO
         1 000046   200141 630500                    EPPR0   CMDPRBUF+66,,AUTO
         1 000047   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000050   000000 701000 xent               TSX1    NIO$SPINTCON
         1 000051   000000 011000                    NOP     0

      375     5434    1           IN_DCTX=CONSOLE_DCTX;

   5434  1 000052   000000 236000 xsym               LDQ     CONSOLE_DCTX
         1 000053   000025 772000                    QRL     21
         1 000054   000025 736000                    QLS     21
         1 000055   000000 756000 xsym               STQ     IN_DCTX
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:84   

      376     5435    1           OUT_DCTX=CONSOLE_DCTX;

   5435  1 000056   000000 236000 xsym               LDQ     CONSOLE_DCTX
         1 000057   000025 772000                    QRL     21
         1 000060   000025 736000                    QLS     21
         1 000061   000000 756000 xsym               STQ     OUT_DCTX

      377     5436    1           RETURN;

   5436  1 000062   000000 702200 xent               TSX2  ! X66_ARET

      378     5437    1   GDS_ERR:
      379     5438    1           ALTRETURN;

   5438  1 000063   000000 702200 xent  GDS_ERR      TSX2  ! X66_AALT

      380     5439        %EJECT;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:85   
      381     5440        /**/
      382     5441        /* ALTRETURN IF BATCH */
      383     5442        /**/
      384     5443    1   IVO$BATCH: ENTRY ALTRET;

   5443  1 000064   000000 700200 xent  IVO$BATCH    TSX0  ! X66_AUTO_2
         1 000065   000144 000002                    ZERO    100,2

      385     5444    1           RETURN;

   5444  1 000066   000000 702200 xent               TSX2  ! X66_ARET

      386     5445        %EJECT;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:86   
      387     5446        /**/
      388     5447        /* CLEAN-UP ROUTINE */
      389     5448        /**/
      390     5449    1   IVO$CLEANUP: ENTRY ALTRET;

   5449  1 000067   000000 700200 xent  IVO$CLEANUP  TSX0  ! X66_AUTO_2
         1 000070   000144 000002                    ZERO    100,2

      391     5450    1           CALL NIO$SPINTCON(CONSOLE_DCTX,ENTADDR(NIL),0);

   5450  1 000071   000010 630400 2                  EPPR0   8
         1 000072   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000073   000000 701000 xent               TSX1    NIO$SPINTCON
         1 000074   000000 011000                    NOP     0

      392     5451    1           CALL MMH$FDS(%MONWSQ,BITBIN(%DS7SID),%(WORKSZ+CMDBUFSZ/4),ERRWD);

   5451  1 000075   200010 630500                    EPPR0   ERRWD,,AUTO
         1 000076   200143 450500                    STP0    CMDPRBUF+68,,AUTO
         1 000077   000002 236000 2                  LDQ     2
         1 000100   200142 756100                    STQ     CMDPRBUF+67,,AUTO
         1 000101   000004 237000 2                  LDAQ    4
         1 000102   200140 757100                    STAQ    CMDPRBUF+65,,AUTO
         1 000103   200140 630500                    EPPR0   CMDPRBUF+65,,AUTO
         1 000104   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000105   000000 701000 xent               TSX1    MMH$FDS
         1 000106   000000 011000                    NOP     0

      393     5452    1           CALL IVO$GET_CLEANUP;

   5452  1 000107   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000110   000000 701000 xent               TSX1    IVO$GET_CLEANUP
         1 000111   000000 011000                    NOP     0

      394     5453    1   FREEZE: CP=0; CP=10; GOTO FREEZE;       /* FREEZE FOR OFFLINE */

   5453  1 000112   200006 450100       FREEZE       STZ     CP,,AUTO
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:87   

   5453  1 000113   000012 235007                    LDA     10,DL
         1 000114   200006 755100                    STA     CP,,AUTO

   5453  1 000115   000112 710000 1                  TRA     FREEZE

      395     5454        %EJECT;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:88   
      396     5455        /**/
      397     5456        /* READ CONTINUATION OF COMMAND */
      398     5457        /**/
      399     5458    1   IVO$CONT: ENTRY (PARAME) ALTRET;

   5458  1 000116   000000 700200 xent  IVO$CONT     TSX0  ! X66_AUTO_2
         1 000117   000144 000002                    ZERO    100,2

      400     5459    1           CP=((PARAME.CHARPOS+3)/4)*4;

   5459  1 000120   200003 470500                    LDP0    @PARAME,,AUTO
         1 000121   000004 236100                    LDQ     4,,PR0
         1 000122   000003 036007                    ADLQ    3,DL
         1 000123   000002 772000                    QRL     2
         1 000124   000002 736000                    QLS     2
         1 000125   200006 756100                    STQ     CP,,AUTO

      401     5460    1           CALL INSERT(PCB.TEXT$->TEXT,PARAME.CHARPOS,CP-PARAME.CHARPOS,'   ');

   5460  1 000126   000000 471400 xsym               LDP1    PCB$
         1 000127   100000 473500                    LDP3    0,,PR1
         1 000130   000004 136100                    SBLQ    4,,PR0
         1 000131   000004 235100                    LDA     4,,PR0
         1 000132   000000 620006                    EAX0    0,QL
         1 000133   040145 100400                    MLR     fill='040'O
         1 000134   000001 000003 0                  ADSC9   1                        cn=0,n=3
         1 000135   300000 000010                    ADSC9   0,A,PR3                  cn=0,n=*X0

      402     5461    1           IF CP>=%CMDBUFSZ THEN RETURN;

   5461  1 000136   200006 235100                    LDA     CP,,AUTO
         1 000137   000400 115007                    CMPA    256,DL
         1 000140   000142 604000 1                  TMI     s:5462

   5461  1 000141   000000 702200 xent               TSX2  ! X66_ARET

      403     5462    1           PARAME.CHARPOS=CP;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:89   

   5462  1 000142   000004 755100                    STA     4,,PR0

      404     5463    1           REQ$=ADDR(NIL);

   5463  1 000143   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000144   200007 756100                    STQ     REQ$,,AUTO

      405     5464    1           CALL NIQ$GET(REQ$) ALTRET(CONT_ERR);

   5464  1 000145   200007 631500                    EPPR1   REQ$,,AUTO
         1 000146   200140 451500                    STP1    CMDPRBUF+65,,AUTO
         1 000147   200140 630500                    EPPR0   CMDPRBUF+65,,AUTO
         1 000150   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000151   000000 701000 xent               TSX1    NIQ$GET
         1 000152   000220 702000 1                  TSX2    CONT_ERR

      406     5465    1           REQ.DLA.DCTX=IN_DCTX;

   5465  1 000153   200007 470500                    LDP0    REQ$,,AUTO
         1 000154   000000 236000 xsym               LDQ     IN_DCTX
         1 000155   000001 676100                    ERQ     1,,PR0
         1 000156   777770 376003                    ANQ     -8,DU
         1 000157   000001 656100                    ERSQ    1,,PR0

      407     5466    1           REQ.BUFSIZE=%CMDBUFSZ-PARAME.CHARPOS;

   5466  1 000160   200003 470500                    LDP0    @PARAME,,AUTO
         1 000161   200007 471500                    LDP1    REQ$,,AUTO
         1 000162   000400 236007                    LDQ     256,DL
         1 000163   000004 136100                    SBLQ    4,,PR0
         1 000164   000020 736000                    QLS     16
         1 000165   100004 676100                    ERQ     4,,PR1
         1 000166   000034 376000 xsym               ANQ     B_VECTNIL+28
         1 000167   100004 656100                    ERSQ    4,,PR1

      408     5467    1           REQ.FC=%N_READ;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:90   

   5467  1 000170   200007 471500                    LDP1    REQ$,,AUTO
         1 000171   000014 236007                    LDQ     12,DL
         1 000172   100003 552104                    STBQ    3,'04'O,PR1

      409     5468    1           REQ.OPFLG=OP_BPF | OP_HOLD;

   5468  1 000173   200007 471500                    LDP1    REQ$,,AUTO
         1 000174   100004 552104                    STBQ    4,'04'O,PR1

      410     5469    1           REQ.BUF$=PINCRC(PCB.TEXT$,PARAME.CHARPOS);

   5469  1 000175   000004 236100                    LDQ     4,,PR0
         1 000176   000000 471400 xsym               LDP1    PCB$
         1 000177   100000 473500                    LDP3    0,,PR1
         1 000200   000011 402007                    MPY     9,DL
         1 000201   300000 503506                    ABD     0,QL,PR3
         1 000202   200007 474500                    LDP4    REQ$,,AUTO
         1 000203   400005 453500                    STP3    5,,PR4

      411     5470    1           REQ.BUF$->PRBUF='+';

   5470  1 000204   200007 473500                    LDP3    REQ$,,AUTO
         1 000205   300005 474500                    LDP4    5,,PR3
         1 000206   053000 236003                    LDQ     22016,DU
         1 000207   400000 756100                    STQ     0,,PR4

      412     5471    1           CALL READ ALTRET(CONT_ERR);

   5471  1 000210   000574 701000 1                  TSX1    READ
         1 000211   000220 702000 1                  TSX2    CONT_ERR

      413     5472    1           PCB.NCHARS=PARAME.CHARPOS+ARS;

   5472  1 000212   200003 470500                    LDP0    @PARAME,,AUTO
         1 000213   000004 236100                    LDQ     4,,PR0
         1 000214   200005 036100                    ADLQ    ARS,,AUTO
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:91   
         1 000215   000000 471400 xsym               LDP1    PCB$
         1 000216   100011 756100                    STQ     9,,PR1

      414     5473    2           DO WHILE ('0'B);

   5473  1 000217   000242 710000 1                  TRA     s:5479

      415     5474    2   CONT_ERR:
      416     5475    2              CALL IVV$ERROR(,11);

   5475  1 000220   000013 236000 2     CONT_ERR     LDQ     11
         1 000221   000001 235000 xsym               LDA     B_VECTNIL+1
         1 000222   200140 757100                    STAQ    CMDPRBUF+65,,AUTO
         1 000223   200140 630500                    EPPR0   CMDPRBUF+65,,AUTO
         1 000224   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000225   000000 701000 xent               TSX1    IVV$ERROR
         1 000226   000000 011000                    NOP     0

      417     5476    2              CALL INSERT(PCB.TEXT$->TEXT,PARAME.CHARPOS,1,' ');

   5476  1 000227   000000 470400 xsym               LDP0    PCB$
         1 000230   000000 471500                    LDP1    0,,PR0
         1 000231   200003 473500                    LDP3    @PARAME,,AUTO
         1 000232   300004 235100                    LDA     4,,PR3
         1 000233   040105 100400                    MLR     fill='040'O
         1 000234   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000235   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1

      418     5477    2              PCB.NCHARS=PARAME.CHARPOS+1;

   5477  1 000236   000000 470400 xsym               LDP0    PCB$
         1 000237   300004 235100                    LDA     4,,PR3
         1 000240   000001 035007                    ADLA    1,DL
         1 000241   000011 755100                    STA     9,,PR0

      419     5478    2              END;

PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:92   
      420     5479    1           RETURN;

   5479  1 000242   000000 702200 xent               TSX2  ! X66_ARET

      421     5480        %EJECT;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:93   
      422     5481        /**/
      423     5482        /* INVOKE DELTA OR KEYIN */
      424     5483        /**/
      425     5484    1   IVO$KEYIN: ENTRY (PARAME) ALTRET;

   5484  1 000243   000000 700200 xent  IVO$KEYIN    TSX0  ! X66_AUTO_2
         1 000244   000144 000002                    ZERO    100,2

      426     5485    1           IF KEYIN.CMD=#DELTA THEN CALL OCX$XDELTA;

   5485  1 000245   200003 470500                    LDP0    @PARAME,,AUTO
         1 000246   000000 235100                    LDA     0,,PR0
         1 000247   000010 115007                    CMPA    8,DL
         1 000250   000255 601000 1                  TNZ     s:5486

   5485  1 000251   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000252   000000 701000 xent               TSX1    OCX$XDELTA
         1 000253   000000 011000                    NOP     0
         1 000254   000260 710000 1                  TRA     s:5487

      427     5486    1           ELSE CALL OCI$SPINTCON;

   5486  1 000255   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000256   000000 701000 xent               TSX1    OCI$SPINTCON
         1 000257   000000 011000                    NOP     0

      428     5487    1           RETURN;

   5487  1 000260   000000 702200 xent               TSX2  ! X66_ARET

      429     5488        %EJECT;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:94   
      430     5489        /**/
      431     5490        /* PRINT OUTPUT */
      432     5491        /**/
      433     5492    1   IVO$PRINT: ENTRY (PARAME,DIAG) ALTRET;

   5492  1 000261   000000 700200 xent  IVO$PRINT    TSX0  ! X66_AUTO_2
         1 000262   000144 000002                    ZERO    100,2

      434     5493    1           OUT$=ADDR(PARAME);

   5493  1 000263   200003 236100                    LDQ     @PARAME,,AUTO
         1 000264   200035 756100                    STQ     OUT$,,AUTO

      435     5494    1           CALL NIQ$GET(REQ$) ALTRET(PRINT_ERR_2);

   5494  1 000265   200007 630500                    EPPR0   REQ$,,AUTO
         1 000266   200140 450500                    STP0    CMDPRBUF+65,,AUTO
         1 000267   200140 630500                    EPPR0   CMDPRBUF+65,,AUTO
         1 000270   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000271   000000 701000 xent               TSX1    NIQ$GET
         1 000272   000411 702000 1                  TSX2    PRINT_ERR_2

      436     5495    1           REQ.DLA.DCTX=OUT_DCTX;

   5495  1 000273   200007 470500                    LDP0    REQ$,,AUTO
         1 000274   000000 236000 xsym               LDQ     OUT_DCTX
         1 000275   000001 676100                    ERQ     1,,PR0
         1 000276   777770 376003                    ANQ     -8,DU
         1 000277   000001 656100                    ERSQ    1,,PR0

      437     5496    1           REQ.BUFSIZE=OUT.LEN-1;

   5496  1 000300   200007 470500                    LDP0    REQ$,,AUTO
         1 000301   200035 471500                    LDP1    OUT$,,AUTO
         1 000302   100000 236100                    LDQ     0,,PR1
         1 000303   000001 136007                    SBLQ    1,DL
         1 000304   000020 736000                    QLS     16
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:95   
         1 000305   000004 676100                    ERQ     4,,PR0
         1 000306   000034 376000 xsym               ANQ     B_VECTNIL+28
         1 000307   000004 656100                    ERSQ    4,,PR0

      438     5497    1           REQ.FC=%N_WRITE;

   5497  1 000310   200007 470500                    LDP0    REQ$,,AUTO
         1 000311   000015 236007                    LDQ     13,DL
         1 000312   000003 552104                    STBQ    3,'04'O,PR0

      439     5498    1           REQ.OPFLG=OP_BPF | OP_HOLD;

   5498  1 000313   200007 470500                    LDP0    REQ$,,AUTO
         1 000314   000014 236007                    LDQ     12,DL
         1 000315   000004 552104                    STBQ    4,'04'O,PR0

      440     5499    1           OCBUF=SUBSTR(OUT.MSG,1);

   5499  1 000316   100000 720100                    LXL0    0,,PR1
         1 000317   777777 621010                    EAX1    -1,X0
         1 000320   040100 100540                    MLR     fill='040'O
         1 000321   100001 200011                    ADSC9   1,,PR1                   cn=1,n=*X1
         1 000322   200011 000120                    ADSC9   OCBUF,,AUTO              cn=0,n=80

      441     5500    1           REQ.BUF$=ADDR(OCBUF);

   5500  1 000323   200011 630500                    EPPR0   OCBUF,,AUTO
         1 000324   200007 473500                    LDP3    REQ$,,AUTO
         1 000325   300005 450500                    STP0    5,,PR3

      442     5501    1           REQ.RCT=1;

   5501  1 000326   000001 220003                    LDX0    1,DU
         1 000327   200007 470500                    LDP0    REQ$,,AUTO
         1 000330   000030 440100                    SXL0    24,,PR0

      443     5502    1           REQ.DVE.VFC=SUBSTR(OUT.MSG,0,1);
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:96   

   5502  1 000331   100000 721100                    LXL1    0,,PR1
         1 000332   100001 236100                    LDQ     1,,PR1
         1 000333   000011 772000                    QRL     9
         1 000334   000031 552120                    STBQ    25,'20'O,PR0

      444     5503    1           CALL NIO$QUE(REQ) ALTRET(PRINT_ERR);

   5503  1 000335   200007 630500                    EPPR0   REQ$,,AUTO
         1 000336   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000337   000000 701000 xent               TSX1    NIO$QUE
         1 000340   000351 702000 1                  TSX2    PRINT_ERR

      445     5504    2           DO WHILE (NOT REQ.TYC.EGV);

   5504  1 000341   000346 710000 1                  TRA     s:5506

      446     5505    2              CALL IVO$WAIT('0'B);

   5505  1 000342   000006 630400 2                  EPPR0   6
         1 000343   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000344   000000 701000 xent               TSX1    IVO$WAIT
         1 000345   000000 011000                    NOP     0

      447     5506    2              END;

   5506  1 000346   200007 470500                    LDP0    REQ$,,AUTO
         1 000347   000021 234100                    SZN     17,,PR0
         1 000350   000342 605000 1                  TPL     s:5505

      448     5507    1   PRINT_ERR:
      449     5508    2           IF DIAG AND OUT_DCTX~=CONSOLE_DCTX THEN DO;

   5508  1 000351   200004 470500       PRINT_ERR    LDP0    @DIAG,,AUTO
         1 000352   000000 066500                    CMPB    filb='0'B
         1 000353   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         1 000354   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:97   
         1 000355   000403 600000 1                  TZE     PRINT_ERR_1
         1 000356   000000 236000 xsym               LDQ     OUT_DCTX
         1 000357   000000 676000 xsym               ERQ     CONSOLE_DCTX
         1 000360   777770 376003                    ANQ     -8,DU
         1 000361   000403 600000 1                  TZE     PRINT_ERR_1

      450     5509    2              REQ.DLA.DCTX=CONSOLE_DCTX;

   5509  1 000362   200007 471500                    LDP1    REQ$,,AUTO
         1 000363   000000 236000 xsym               LDQ     CONSOLE_DCTX
         1 000364   100001 676100                    ERQ     1,,PR1
         1 000365   777770 376003                    ANQ     -8,DU
         1 000366   100001 656100                    ERSQ    1,,PR1

      451     5510    2              CALL NIO$QUE(REQ) ALTRET(PRINT_ERR_1);

   5510  1 000367   200007 630500                    EPPR0   REQ$,,AUTO
         1 000370   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000371   000000 701000 xent               TSX1    NIO$QUE
         1 000372   000403 702000 1                  TSX2    PRINT_ERR_1

      452     5511    3              DO WHILE (NOT REQ.TYC.EGV);

   5511  1 000373   000400 710000 1                  TRA     s:5513

      453     5512    3                 CALL IVO$WAIT('0'B);

   5512  1 000374   000006 630400 2                  EPPR0   6
         1 000375   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000376   000000 701000 xent               TSX1    IVO$WAIT
         1 000377   000000 011000                    NOP     0

      454     5513    3                 END;

   5513  1 000400   200007 470500                    LDP0    REQ$,,AUTO
         1 000401   000021 234100                    SZN     17,,PR0
         1 000402   000374 605000 1                  TPL     s:5512
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:98   

      455     5514    2   PRINT_ERR_1:
      456     5515    2              END/* IF DIAG */;

   5515  1 000403                       PRINT_ERR_1  null
      457     5516    1           CALL NIQ$REL(REQ$);

   5516  1 000403   200007 630500                    EPPR0   REQ$,,AUTO
         1 000404   200140 450500                    STP0    CMDPRBUF+65,,AUTO
         1 000405   200140 630500                    EPPR0   CMDPRBUF+65,,AUTO
         1 000406   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000407   000000 701000 xent               TSX1    NIQ$REL
         1 000410   000000 011000                    NOP     0

      458     5517    1   PRINT_ERR_2:
      459     5518    1           RETURN;

   5518  1 000411   000000 702200 xent  PRINT_ERR_2  TSX2  ! X66_ARET

      460     5519        %EJECT;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:99   
      461     5520        /**/
      462     5521        /* READ COMMAND */
      463     5522        /**/
      464     5523    1   IVO$READ: ENTRY ALTRET;

   5523  1 000412   000000 700200 xent  IVO$READ     TSX0  ! X66_AUTO_2
         1 000413   000144 000002                    ZERO    100,2

      465     5524    1           CALL NIQ$GET(REQ$) ALTRET(READ_ERR);

   5524  1 000414   200007 630500                    EPPR0   REQ$,,AUTO
         1 000415   200140 450500                    STP0    CMDPRBUF+65,,AUTO
         1 000416   200140 630500                    EPPR0   CMDPRBUF+65,,AUTO
         1 000417   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000420   000000 701000 xent               TSX1    NIQ$GET
         1 000421   000461 702000 1                  TSX2    READ_ERR

      466     5525    1           REQ.DLA.DCTX=IN_DCTX;

   5525  1 000422   200007 470500                    LDP0    REQ$,,AUTO
         1 000423   000000 236000 xsym               LDQ     IN_DCTX
         1 000424   000001 676100                    ERQ     1,,PR0
         1 000425   777770 376003                    ANQ     -8,DU
         1 000426   000001 656100                    ERSQ    1,,PR0

      467     5526    1           REQ.BUFSIZE=%CMDBUFSZ;

   5526  1 000427   200007 470500                    LDP0    REQ$,,AUTO
         1 000430   000004 236100                    LDQ     4,,PR0
         1 000431   177777 376007                    ANQ     65535,DL
         1 000432   000100 276003                    ORQ     64,DU
         1 000433   000004 756100                    STQ     4,,PR0

      468     5527    1           REQ.FC=%N_READ;

   5527  1 000434   200007 470500                    LDP0    REQ$,,AUTO
         1 000435   000014 236007                    LDQ     12,DL
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:100  
         1 000436   000003 552104                    STBQ    3,'04'O,PR0

      469     5528    1           REQ.OPFLG=OP_BPF | OP_HOLD;

   5528  1 000437   200007 470500                    LDP0    REQ$,,AUTO
         1 000440   000004 552104                    STBQ    4,'04'O,PR0

      470     5529    1           REQ.BUF$=PCB.TEXT$;

   5529  1 000441   000000 470400 xsym               LDP0    PCB$
         1 000442   000000 236100                    LDQ     0,,PR0
         1 000443   200007 471500                    LDP1    REQ$,,AUTO
         1 000444   100005 756100                    STQ     5,,PR1

      471     5530    1           REQ.BUF$->PRBUF=PRCHAR;

   5530  1 000445   200007 471500                    LDP1    REQ$,,AUTO
         1 000446   100005 473500                    LDP3    5,,PR1
         1 000447   000000 236000 xsym               LDQ     PRCHAR
         1 000450   777000 376003                    ANQ     -512,DU
         1 000451   000014 276000 2                  ORQ     12
         1 000452   300000 756100                    STQ     0,,PR3

      472     5531    1           CALL READ ALTRET(READ_ERR);

   5531  1 000453   000574 701000 1                  TSX1    READ
         1 000454   000461 702000 1                  TSX2    READ_ERR

      473     5532    1           PCB.NCHARS=ARS;

   5532  1 000455   200005 235100                    LDA     ARS,,AUTO
         1 000456   000000 470400 xsym               LDP0    PCB$
         1 000457   000011 755100                    STA     9,,PR0

      474     5533    1           RETURN;

   5533  1 000460   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:101  

      475     5534        /**/
      476     5535    1   READ_ERR:
      477     5536    1           CALL IVV$ERROR(,11);

   5536  1 000461   000013 236000 2     READ_ERR     LDQ     11
         1 000462   000001 235000 xsym               LDA     B_VECTNIL+1
         1 000463   200140 757100                    STAQ    CMDPRBUF+65,,AUTO
         1 000464   200140 630500                    EPPR0   CMDPRBUF+65,,AUTO
         1 000465   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000466   000000 701000 xent               TSX1    IVV$ERROR
         1 000467   000000 011000                    NOP     0

      478     5537    1           ALTRETURN;

   5537  1 000470   000000 702200 xent               TSX2  ! X66_AALT

      479     5538        %EJECT;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:102  
      480     5539        /**/
      481     5540        /* SET PROMPT CHARACTER */
      482     5541        /**/
      483     5542    1   IVO$SETPC: ENTRY (PARAME) ALTRET;

   5542  1 000471   000000 700200 xent  IVO$SETPC    TSX0  ! X66_AUTO_2
         1 000472   000144 000002                    ZERO    100,2

      484     5543    1           PRCHAR=PROMPT.CHR;

   5543  1 000473   200003 470500                    LDP0    @PARAME,,AUTO
         1 000474   000000 236100                    LDQ     0,,PR0
         1 000475   777000 376003                    ANQ     -512,DU
         1 000476   000014 276000 2                  ORQ     12
         1 000477   000000 756000 xsym               STQ     PRCHAR

      485     5544    1           RETURN;

   5544  1 000500   000000 702200 xent               TSX2  ! X66_ARET

      486     5545        %EJECT;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:103  
      487     5546        /**/
      488     5547        /* SWAP INPUT */
      489     5548        /**/
      490     5549    1   IVO$SWIN: ENTRY (PARAME) ALTRET;

   5549  1 000501   000000 700200 xent  IVO$SWIN     TSX0  ! X66_AUTO_2
         1 000502   000144 000002                    ZERO    100,2

      491     5550    1           CP=1;

   5550  1 000503   000001 235007                    LDA     1,DL
         1 000504   200006 755100                    STA     CP,,AUTO

      492     5551    2           DO WHILE (N$DCT$(CP)~=ADDR(NIL));

   5551  1 000505   000525 710000 1                  TRA     s:5558

      493     5552    3              IF SWP.DEVID=SUBSTR(N$DCT$(CP)->DCT.DEVNM,0,4) THEN DO;

   5552  1 000506   000000 470400 xsym               LDP0    N$DCT$$
         1 000507   200006 720100                    LXL0    CP,,AUTO
         1 000510   000000 471510                    LDP1    0,X0,PR0
         1 000511   200003 473500                    LDP3    @PARAME,,AUTO
         1 000512   300000 236100                    LDQ     0,,PR3
         1 000513   100002 116100                    CMPQ    2,,PR1
         1 000514   000524 601000 1                  TNZ     s:5557

      494     5553    3                 IF NOT N$DCT$(CP)->DCT.DFLG.INPUT THEN GOTO SWAP_ERR;

   5553  1 000515   100006 236100                    LDQ     6,,PR1
         1 000516   400000 316007                    CANQ    -131072,DL
         1 000517   000564 600000 1                  TZE     SWAP_ERR

      495     5554    3                 IN_DCTX=CP;

   5554  1 000520   200006 235100                    LDA     CP,,AUTO
         1 000521   000025 735000                    ALS     21
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:104  
         1 000522   000000 755000 xsym               STA     IN_DCTX

      496     5555    3                 RETURN;

   5555  1 000523   000000 702200 xent               TSX2  ! X66_ARET

      497     5556    3                 END;
      498     5557    2              CP=CP+1;

   5557  1 000524   200006 054100                    AOS     CP,,AUTO

      499     5558    2              END/* WHILE N$DCT$(CP) */;

   5558  1 000525   000000 470400 xsym               LDP0    N$DCT$$
         1 000526   200006 720100                    LXL0    CP,,AUTO
         1 000527   000000 236110                    LDQ     0,X0,PR0
         1 000530   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000531   000506 601000 1                  TNZ     s:5552

      500     5559    1           GOTO SWAP_ERR;

   5559  1 000532   000564 710000 1                  TRA     SWAP_ERR

      501     5560        /**/
      502     5561        /* SWAP OUTPUT */
      503     5562        /**/
      504     5563    1   IVO$SWOUT: ENTRY (PARAME) ALTRET;

   5563  1 000533   000000 700200 xent  IVO$SWOUT    TSX0  ! X66_AUTO_2
         1 000534   000144 000002                    ZERO    100,2

      505     5564    1           CP=1;

   5564  1 000535   000001 235007                    LDA     1,DL
         1 000536   200006 755100                    STA     CP,,AUTO

      506     5565    2           DO WHILE (N$DCT$(CP)~=ADDR(NIL));
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:105  

   5565  1 000537   000557 710000 1                  TRA     s:5572

      507     5566    3              IF SWP.DEVID=SUBSTR(N$DCT$(CP)->DCT.DEVNM,0,4) THEN DO;

   5566  1 000540   000000 470400 xsym               LDP0    N$DCT$$
         1 000541   200006 720100                    LXL0    CP,,AUTO
         1 000542   000000 471510                    LDP1    0,X0,PR0
         1 000543   200003 473500                    LDP3    @PARAME,,AUTO
         1 000544   300000 236100                    LDQ     0,,PR3
         1 000545   100002 116100                    CMPQ    2,,PR1
         1 000546   000556 601000 1                  TNZ     s:5571

      508     5567    3                 IF NOT N$DCT$(CP)->DCT.DFLG.OUTPUT THEN GOTO SWAP_ERR;

   5567  1 000547   100006 236100                    LDQ     6,,PR1
         1 000550   200000 316007                    CANQ    65536,DL
         1 000551   000564 600000 1                  TZE     SWAP_ERR

      509     5568    3                 OUT_DCTX=CP;

   5568  1 000552   200006 235100                    LDA     CP,,AUTO
         1 000553   000025 735000                    ALS     21
         1 000554   000000 755000 xsym               STA     OUT_DCTX

      510     5569    3                 RETURN;

   5569  1 000555   000000 702200 xent               TSX2  ! X66_ARET

      511     5570    3                 END;
      512     5571    2              CP=CP+1;

   5571  1 000556   200006 054100                    AOS     CP,,AUTO

      513     5572    2              END/* WHILE N$DCT$(CP) */;

   5572  1 000557   000000 470400 xsym               LDP0    N$DCT$$
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:106  
         1 000560   200006 720100                    LXL0    CP,,AUTO
         1 000561   000000 236110                    LDQ     0,X0,PR0
         1 000562   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000563   000540 601000 1                  TNZ     s:5566

      514     5573    1   SWAP_ERR:
      515     5574    1           CALL IVV$ERROR(,4);

   5574  1 000564   000015 236000 2     SWAP_ERR     LDQ     13
         1 000565   000001 235000 xsym               LDA     B_VECTNIL+1
         1 000566   200140 757100                    STAQ    CMDPRBUF+65,,AUTO
         1 000567   200140 630500                    EPPR0   CMDPRBUF+65,,AUTO
         1 000570   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000571   000000 701000 xent               TSX1    IVV$ERROR
         1 000572   000000 011000                    NOP     0

      516     5575    1           ALTRETURN;

   5575  1 000573   000000 702200 xent               TSX2  ! X66_AALT

      517     5576        %EJECT;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:107  
      518     5577        /**/
      519     5578        /* READ AND EDIT INPUT BUFFER */
      520     5579        /**/
      521     5580    1   READ:   PROC ALTRET;

   5580  1 000574   200036 741300       READ         STX1  ! OUT$+1,,AUTO

      522     5581        /**/
      523     5582        /* LOCAL DATA */
      524     5583        /**/
      525     5584    2   DCL CMDPRBUF CHAR(%CMDBUFSZ) ALIGNED;
      526     5585        %B$XL_UPPER_UR(NAME=UC);
      527     5589        /**/
      528     5590    2           CALL INSERT(CMDPRBUF,1,1,REQ.BUF$->PRBUF);

   5590  1 000575   200007 470500                    LDP0    REQ$,,AUTO
         1 000576   000005 471500                    LDP1    5,,PR0
         1 000577   100000 236100                    LDQ     0,,PR1
         1 000600   000011 772000                    QRL     9
         1 000601   200037 552120                    STBQ    CMDPRBUF,'20'O,AUTO

      529     5591    3   READ_LOOP: DO;

   5591  1 000602                       READ_LOOP    null
      530     5592    3              CALL NIO$QUE(REQ) ALTRET(READ_ERR);

   5592  1 000602   200007 630500                    EPPR0   REQ$,,AUTO
         1 000603   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000604   000000 701000 xent               TSX1    NIO$QUE
         1 000605   000632 702000 1                  TSX2    READ_ERR

      531     5593    4              DO WHILE (NOT REQ.TYC.EGV);

   5593  1 000606   000613 710000 1                  TRA     s:5595

      532     5594    4                 CALL IVO$WAIT('0'B);

PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:108  
   5594  1 000607   000006 630400 2                  EPPR0   6
         1 000610   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000611   000000 701000 xent               TSX1    IVO$WAIT
         1 000612   000000 011000                    NOP     0

      533     5595    4                 END;

   5595  1 000613   200007 470500                    LDP0    REQ$,,AUTO
         1 000614   000021 234100                    SZN     17,,PR0
         1 000615   000607 605000 1                  TPL     s:5594

      534     5596    3              IF REQ.TYC~=%TYC_EGV THEN

   5596  1 000616   000021 236100                    LDQ     17,,PR0
         1 000617   000030 116000 xsym               CMPQ    B_VECTNIL+24
         1 000620   000642 600000 1                  TZE     s:5608

      535     5597    4                 IF REQ.TYC&%TYC_TIMO THEN DO;

   5597  1 000621   000026 376000 xsym               ANQ     B_VECTNIL+22
         1 000622   000632 600000 1                  TZE     READ_ERR

      536     5598    4                    REQ.BUF$->PRBUF=SUBSTR(CMDPRBUF,1,1);

   5598  1 000623   000005 471500                    LDP1    5,,PR0
         1 000624   200037 236100                    LDQ     CMDPRBUF,,AUTO
         1 000625   000011 736000                    QLS     9
         1 000626   777000 376003                    ANQ     -512,DU
         1 000627   000014 276000 2                  ORQ     12
         1 000630   100000 756100                    STQ     0,,PR1

      537     5599    4                    GOTO READ_LOOP;

   5599  1 000631   000602 710000 1                  TRA     READ_LOOP

      538     5600    4                    END;
      539     5601    4                 ELSE DO;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:109  

      540     5602    4   READ_ERR:
      541     5603    4                    CALL NIQ$REL(REQ$);

   5603  1 000632   200007 630500       READ_ERR     EPPR0   REQ$,,AUTO
         1 000633   200140 450500                    STP0    CMDPRBUF+65,,AUTO
         1 000634   200140 630500                    EPPR0   CMDPRBUF+65,,AUTO
         1 000635   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000636   000000 701000 xent               TSX1    NIQ$REL
         1 000637   000000 011000                    NOP     0

      542     5604    4                    ALTRETURN;

   5604  1 000640   200036 221300                    LDX1  ! OUT$+1,,AUTO
         1 000641   000000 702211                    TSX2  ! 0,X1

      543     5605    4                    END;
      544     5606        /**/
      545     5607    3              END READ_LOOP;
      546     5608    2           ARS=REQ.ARSIZE;

   5608  1 000642   000027 236100                    LDQ     23,,PR0
         1 000643   000020 772000                    QRL     16
         1 000644   200005 756100                    STQ     ARS,,AUTO

      547     5609    2           CALL XLATE(SUBSTR(REQ.BUF$->TEXT,0,ARS),UC,SUBSTR(REQ.BUF$->TEXT,0,ARS));

   5609  1 000645   000005 471500                    LDP1    5,,PR0
         1 000646   000000 620006                    EAX0    0,QL
         1 000647   000000 473400 xsym               LDP3    B$XL_UPPER_UR$
         1 000650   200005 721100                    LXL1    ARS,,AUTO
         1 000651   040140 160540                    MVT     fill='040'O
         1 000652   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         1 000653   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
         1 000654   300000 000100                    ARG     0,,PR3

      548     5610    3           IF IN_DCTX~=OUT_DCTX THEN DO;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:110  

   5610  1 000655   000000 236000 xsym               LDQ     IN_DCTX
         1 000656   000000 676000 xsym               ERQ     OUT_DCTX
         1 000657   777770 376003                    ANQ     -8,DU
         1 000660   000765 600000 1                  TZE     PRINT_ERR

      549     5611    3              REQ.BUFSIZE=((ARS+5)/4)*4-1;

   5611  1 000661   200005 236100                    LDQ     ARS,,AUTO
         1 000662   000005 036007                    ADLQ    5,DL
         1 000663   000004 506007                    DIV     4,DL
         1 000664   200007 470500                    LDP0    REQ$,,AUTO
         1 000665   000002 736000                    QLS     2
         1 000666   000001 136007                    SBLQ    1,DL
         1 000667   000020 736000                    QLS     16
         1 000670   000004 676100                    ERQ     4,,PR0
         1 000671   000034 376000 xsym               ANQ     B_VECTNIL+28
         1 000672   000004 656100                    ERSQ    4,,PR0

      550     5612    3              IF REQ.BUFSIZE<7 THEN REQ.BUFSIZE=7;

   5612  1 000673   200007 470500                    LDP0    REQ$,,AUTO
         1 000674   000004 236100                    LDQ     4,,PR0
         1 000675   000034 376000 xsym               ANQ     B_VECTNIL+28
         1 000676   000016 116000 2                  CMPQ    14
         1 000677   000704 603000 1                  TRC     s:5613

   5612  1 000700   000004 236100                    LDQ     4,,PR0
         1 000701   177777 376007                    ANQ     65535,DL
         1 000702   000016 276000 2                  ORQ     14
         1 000703   000004 756100                    STQ     4,,PR0

      551     5613    3              IF REQ.BUFSIZE>%(CMDBUFSZ-1) THEN REQ.BUFSIZE=%(CMDBUFSZ-1);

   5613  1 000704   200007 470500                    LDP0    REQ$,,AUTO
         1 000705   000004 236100                    LDQ     4,,PR0
         1 000706   000034 376000 xsym               ANQ     B_VECTNIL+28
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:111  
         1 000707   000100 116003                    CMPQ    64,DU
         1 000710   000715 602000 1                  TNC     s:5614

   5613  1 000711   000004 236100                    LDQ     4,,PR0
         1 000712   177777 376007                    ANQ     65535,DL
         1 000713   000017 276000 2                  ORQ     15
         1 000714   000004 756100                    STQ     4,,PR0

      552     5614    3              CALL INSERT(CMDPRBUF,2,REQ.BUFSIZE,SUBSTR(REQ.BUF$->TEXT,0,ARS));

   5614  1 000715   200007 470500                    LDP0    REQ$,,AUTO
         1 000716   000005 471500                    LDP1    5,,PR0
         1 000717   000004 236100                    LDQ     4,,PR0
         1 000720   000020 772000                    QRL     16
         1 000721   000000 620006                    EAX0    0,QL
         1 000722   040140 100540                    MLR     fill='040'O
         1 000723   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
         1 000724   200037 400010                    ADSC9   CMDPRBUF,,AUTO           cn=2,n=*X0

      553     5615    3              REQ.DLA.DCTX=OUT_DCTX;

   5615  1 000725   000000 236000 xsym               LDQ     OUT_DCTX
         1 000726   000001 676100                    ERQ     1,,PR0
         1 000727   777770 376003                    ANQ     -8,DU
         1 000730   000001 656100                    ERSQ    1,,PR0

      554     5616    3              REQ.FC=%N_WRITE;

   5616  1 000731   200007 470500                    LDP0    REQ$,,AUTO
         1 000732   000015 236007                    LDQ     13,DL
         1 000733   000003 552104                    STBQ    3,'04'O,PR0

      555     5617    3              REQ.OPFLG=OP_BPF | OP_HOLD;

   5617  1 000734   200007 470500                    LDP0    REQ$,,AUTO
         1 000735   000014 236007                    LDQ     12,DL
         1 000736   000004 552104                    STBQ    4,'04'O,PR0
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:112  

      556     5618    3              REQ.BUF$=ADDR(SUBSTR(CMDPRBUF,1));

   5618  1 000737   200140 452500                    STP2    CMDPRBUF+65,,AUTO
         1 000740   200140 236100                    LDQ     CMDPRBUF+65,,AUTO
         1 000741   000020 036000 2                  ADLQ    16
         1 000742   200007 470500                    LDP0    REQ$,,AUTO
         1 000743   000005 756100                    STQ     5,,PR0

      557     5619    3              REQ.RCT=1;

   5619  1 000744   000001 220003                    LDX0    1,DU
         1 000745   200007 470500                    LDP0    REQ$,,AUTO
         1 000746   000030 440100                    SXL0    24,,PR0

      558     5620    3              REQ.DVE.VFC='A';

   5620  1 000747   000101 236003                    LDQ     65,DU
         1 000750   000031 552120                    STBQ    25,'20'O,PR0

      559     5621    3              CALL NIO$QUE(REQ) ALTRET(PRINT_ERR);

   5621  1 000751   200007 630500                    EPPR0   REQ$,,AUTO
         1 000752   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000753   000000 701000 xent               TSX1    NIO$QUE
         1 000754   000765 702000 1                  TSX2    PRINT_ERR

      560     5622    4              DO WHILE (NOT REQ.TYC.EGV);

   5622  1 000755   000762 710000 1                  TRA     s:5624

      561     5623    4                 CALL IVO$WAIT('0'B);

   5623  1 000756   000006 630400 2                  EPPR0   6
         1 000757   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000760   000000 701000 xent               TSX1    IVO$WAIT
         1 000761   000000 011000                    NOP     0
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:113  

      562     5624    4                 END;

   5624  1 000762   200007 470500                    LDP0    REQ$,,AUTO
         1 000763   000021 234100                    SZN     17,,PR0
         1 000764   000756 605000 1                  TPL     s:5623

      563     5625    3   PRINT_ERR:
      564     5626    3              END/* IF IN_DCTX */;

   5626  1 000765                       PRINT_ERR    null
      565     5627    2           CALL NIQ$REL(REQ$);

   5627  1 000765   200007 630500                    EPPR0   REQ$,,AUTO
         1 000766   200140 450500                    STP0    CMDPRBUF+65,,AUTO
         1 000767   200140 630500                    EPPR0   CMDPRBUF+65,,AUTO
         1 000770   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000771   000000 701000 xent               TSX1    NIQ$REL
         1 000772   000000 011000                    NOP     0

      566     5628    2           RETURN;

   5628  1 000773   200036 221300                    LDX1  ! OUT$+1,,AUTO
         1 000774   000001 702211                    TSX2  ! 1,X1

(unnamed)
 Sect OctLoc
   0     000   0***** ******   040040 040040                                    ....

(unnamed)
 Sect OctLoc
   2     000   000000 006012   000000 001500   000001 006000   000000 000000    ................
   2     004   000003 006000   000000 006000   000002 006000   000000 006000    ................
   2     010   000000 006000   000002 006000   000002 006000   000015 006000    ................
   2     014   000040 040040   000006 006000   000001 600000   000077 600000    .   .........?..
   2     020   000037 200000                                                    ....
      567     5629    2   END READ;
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:114  
      568     5630    1   END IVO$INIT;
      569     5631        %EOD;

PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:115  
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   N_FC_C.:E05TOU  is referenced.
   IV_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure IVO$INIT.
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:116  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @DIAG                      3-0-0/w PTR         r     1 @PARAME
     5-0-0/w SBIN        r     1 ARS                       37-0-0/w CHAR(256)   r     1 CMDPRBUF
     6-0-0/w SBIN        r     1 CP                        *0-0-0/b BIT         r     1 DIAG
    10-0-0/w SBIN        r     1 ERRWD                     *0-0-0/w STRC(288)   r     1 KEYIN
    11-0-0/c CHAR(80)    r     1 OCBUF                     35-0-0/w PTR         r     1 OUT$
    *0-0-0/w STRC(270)   r     1 PARAME                    *0-0-0/w STRC(288)   r     1 PROMPT
     7-0-0/w PTR         r     1 REQ$                      *0-0-0/w STRC(288)   r     1 SWP

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$DS7$                     0-0-0/w PTR         r     1 B$XL_UPPER_UR$
     0-0-0/w UBIN        r     1 B_SCDCTX                   0-0-0/w UBIN(15)    r     1 CONSOLE_DCTX
     0-0-0/w UBIN(15)    r     1 IN_DCTX                    0-0-0/w PTR         r     1 N$DCT$$
     0-0-0/w PTR         r     1 N$FQ$                      0-0-0/w PTR         r     1 NI$FQ$
     0-0-0/w PTR         r     1 NI$IBUF$                   0-0-0/w PTR         r     1 NI$RP$
     0-0-0/w UBIN(15)    r     1 OUT_DCTX                   0-0-0/w PTR         r     1 PCB$
     0-0-0/w CHAR        r     1 PRCHAR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1332)  r     1 DCT                        0-0-0/w PTR         r     1 N$DCT$(0:0)
     0-0-0/w ASTR        r     1 OUT                        0-0-0/w STRC(504)   r     1 PCB
     0-0-0/w CHAR        r     1 PRBUF                      0-0-0/d STRC(1080)  r     1 REQ
     0-0-0/w CHAR(256)   r     1 TEXT                       0-0-0/d STRC(4608)  r     1 UC
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:117  


   Procedure IVO$INIT requires 509 words for executable code.
   Procedure IVO$INIT requires 100 words of local(AUTO) storage.
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:118  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:119  
          MINI XREF LISTING

ARS
      5414**DCL      5472>>ASSIGN   5532>>ASSIGN   5608<<ASSIGN   5609>>CALLBLT  5609>>CALLBLT  5611>>ASSIGN
      5614>>CALLBLT
B$DS7$
      5085**DCL      5427>>ASSIGN   5429>>ASSIGN
B$XL_UPPER_UR$ IN PROCEDURE READ
      5586**DCL      5587--IMP-PTR  5609>>CALLBLT
B_SCDCTX
      5079**DCL      5432>>ASSIGN
CMDPRBUF IN PROCEDURE READ
      5584**DCL      5590<<CALLBLT  5598>>ASSIGN   5614<<CALLBLT  5618--ASSIGN
CONSOLE_DCTX
      5076**DCL      5432<<ASSIGN   5433<>CALL     5434>>ASSIGN   5435>>ASSIGN   5450<>CALL     5508>>IF
      5509>>ASSIGN
CONT_ERR
      5475**LABEL    5464--CALLALT  5471--CALLALT
CP
      5415**DCL      5453<<ASSIGN   5453<<ASSIGN   5459<<ASSIGN   5460>>CALLBLT  5461>>IF       5462>>ASSIGN
      5550<<ASSIGN   5551>>DOWHILE  5552>>IF       5553>>IF       5554>>ASSIGN   5557<<ASSIGN   5557>>ASSIGN
      5564<<ASSIGN   5565>>DOWHILE  5566>>IF       5567>>IF       5568>>ASSIGN   5571<<ASSIGN   5571>>ASSIGN
DCT.DEVNM
      5169**DCL      5552>>IF       5566>>IF
DCT.DFLG.INPUT
      5171**DCL      5553>>IF
DCT.DFLG.OUTPUT
      5172**DCL      5567>>IF
DCT.DP
      5189**DCL      5196--REDEF    5199--REDEF    5200--REDEF    5202--REDEF    5202--REDEF    5203--REDEF
      5204--REDEF    5204--REDEF
DCT.MPC.IOCHANX
      5197**DCL      5197--REDEF
DIAG
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:120  
      5065**DCL         9--PROC     5492--ENTRY    5508>>IF
ERRWD
      5417**DCL      5425<>CALL     5451<>CALL
FREEZE
      5453**LABEL    5453--GOTO
GDS_ERR
      5438**LABEL    5425--CALLALT
IN_DCTX
      5077**DCL      5434<<ASSIGN   5465>>ASSIGN   5525>>ASSIGN   5554<<ASSIGN   5610>>IF
IVO$GET_CLEANUP
      5086**DCL-ENT  5452--CALL
IVO$GET_INIT
      5087**DCL-ENT  5431--CALL
IVO$OPINT
      5088**DCL-ENT  5433--CALL
IVO$WAIT
      5089**DCL-ENT  5505--CALL     5512--CALL     5594--CALL     5623--CALL
IVV$ERROR
      5090**DCL-ENT  5475--CALL     5536--CALL     5574--CALL
KEYIN.CMD
      5063**DCL      5485>>IF
MMH$FDS
      5092**DCL-ENT  5451--CALL
MMH$GDS
      5091**DCL-ENT  5425--CALL
N$DCT$
      1861**DCL      5551>>DOWHILE  5552>>IF       5553>>IF       5565>>DOWHILE  5566>>IF       5567>>IF
N$DCT$$
      1727**DCL      1861--IMP-PTR  5551>>DOWHILE  5552>>IF       5553>>IF       5565>>DOWHILE  5566>>IF
      5567>>IF
N$FQ$
      1727**DCL      1862--IMP-PTR
N$REQ_INIT.BUFADDR
      1746**DCL      1747--REDEF    1747--REDEF
N$REQ_INIT.DLA.DRELADDR
      1738**DCL      1738--REDEF
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:121  
N$REQ_INIT.DVE.EOMCHAR
      1775**DCL      1776--REDEF
N$REQ_INIT.EAINFO
      1769**DCL      1769--REDEF
N$REQ_INIT.EAINFOX
      1769**DCL      1770--REDEF
N$REQ_INIT.EVNTINFO
      1770**DCL      1770--REDEF
N$REQ_INIT.STATUS
      1751**DCL      1757--REDEF
NI$FQ$
      1787**DCL      1863--IMP-PTR
NI$IBUF$
      1787**DCL      1863--IMP-PTR
NI$IMXMBX_INIT.PAGED_BASE
      1797**DCL      1798--REDEF    1798--REDEF
NI$IMXMBX_INIT.SIZE
      1799**DCL      1799--REDEF
NI$REQ_INIT.DCW
      1821**DCL      1824--REDEF
NI$REQ_INIT.DCW.TALLY
      1822**DCL      1822--REDEF
NI$REQ_INIT.IDCW.EXTA
      1824**DCL      1824--REDEF
NI$REQ_INIT.PCW
      1826**DCL      1830--REDEF
NI$REQ_INIT.SEEK
      1831**DCL      1832--REDEF    1833--REDEF
NI$RP$
      1835**DCL      1865--IMP-PTR
NIO$QUE
      5093**DCL-ENT  5503--CALL     5510--CALL     5592--CALL     5621--CALL
NIO$SPINTCON
      5094**DCL-ENT  5433--CALL     5450--CALL
NIQ$GET
      5095**DCL-ENT  5464--CALL     5494--CALL     5524--CALL
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:122  
NIQ$REL
      5096**DCL-ENT  5516--CALL     5603--CALL     5627--CALL
NI_MBX_INIT.DCW.CONTROL.AE
      1857**DCL      1857--REDEF
NI_MBX_INIT.LPW.CONTROL.AE
      1853**DCL      1853--REDEF
OCBUF
      5418**DCL      5499<<ASSIGN   5500--ASSIGN
OCI$SPINTCON
      5097**DCL-ENT  5486--CALL
OCX$XDELTA
      5098**DCL-ENT  5485--CALL
OUT.LEN
      5422**DCL      5423--IMP-SIZ  5496>>ASSIGN   5499>>ASSIGN   5502>>ASSIGN
OUT.MSG
      5423**DCL      5499>>ASSIGN   5502>>ASSIGN
OUT$
      5420**DCL      5421--IMP-PTR  5493<<ASSIGN   5496>>ASSIGN   5499>>ASSIGN   5499>>ASSIGN   5502>>ASSIGN
      5502>>ASSIGN
OUT_DCTX
      5078**DCL      5435<<ASSIGN   5495>>ASSIGN   5508>>IF       5568<<ASSIGN   5610>>IF       5615>>ASSIGN
PARAME
      4994**DCL         9--PROC     5056--REDEF    5059--REDEF    5062--REDEF    5426--ASSIGN   5458--ENTRY
      5484--ENTRY    5492--ENTRY    5493--ASSIGN   5542--ENTRY    5549--ENTRY    5563--ENTRY
PARAME.CHARPOS
      5032**DCL      5459>>ASSIGN   5460>>CALLBLT  5460>>CALLBLT  5462<<ASSIGN   5466>>ASSIGN   5469>>ASSIGN
      5472>>ASSIGN   5476>>CALLBLT  5477>>ASSIGN
PCB.NCHARS
      5374**DCL      5428<<ASSIGN   5472<<ASSIGN   5477<<ASSIGN   5532<<ASSIGN
PCB.TEXT$
      5228**DCL      5427<<ASSIGN   5460>>CALLBLT  5469>>ASSIGN   5476>>CALLBLT  5529>>ASSIGN
PCB.WKSZ
      5257**DCL      5430<<ASSIGN
PCB.WORK$
      5236**DCL      5429<<ASSIGN
PCB$
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:123  
      5080**DCL      5227--IMP-PTR  5426<<ASSIGN   5427>>ASSIGN   5428>>ASSIGN   5429>>ASSIGN   5430>>ASSIGN
      5460>>CALLBLT  5469>>ASSIGN   5472>>ASSIGN   5476>>CALLBLT  5477>>ASSIGN   5529>>ASSIGN   5532>>ASSIGN
PRBUF
      5409**DCL      5470<<ASSIGN   5530<<ASSIGN   5590>>CALLBLT  5598<<ASSIGN
PRCHAR
      5081**DCL      5530>>ASSIGN   5543<<ASSIGN
PRINT_ERR
      5508**LABEL    5503--CALLALT
PRINT_ERR IN PROCEDURE READ
      5626**LABEL    5621--CALLALT
PRINT_ERR_1
      5515**LABEL    5510--CALLALT
PRINT_ERR_2
      5518**LABEL    5494--CALLALT
PROMPT.CHR
      5060**DCL      5543>>ASSIGN
READ
      5580**PROC     5471--CALL     5531--CALL
READ_ERR
      5536**LABEL    5524--CALLALT  5531--CALLALT
READ_ERR IN PROCEDURE READ
      5603**LABEL    5592--CALLALT
READ_LOOP IN PROCEDURE READ
      5591**LABEL    5599--GOTO
REQ
      5111**DCL      5503<>CALL     5510<>CALL     5592<>CALL     5621<>CALL
REQ.ARSIZE
      5144**DCL      5608>>ASSIGN
REQ.BUF$
      5120**DCL      5469<<ASSIGN   5470>>ASSIGN   5500<<ASSIGN   5529<<ASSIGN   5530>>ASSIGN   5590>>CALLBLT
      5598>>ASSIGN   5609>>CALLBLT  5609>>CALLBLT  5614>>CALLBLT  5618<<ASSIGN
REQ.BUFADDR
      5120**DCL      5121--REDEF    5121--REDEF
REQ.BUFSIZE
      5114**DCL      5466<<ASSIGN   5496<<ASSIGN   5526<<ASSIGN   5611<<ASSIGN   5612>>IF       5612<<ASSIGN
      5613>>IF       5613<<ASSIGN   5614>>CALLBLT
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:124  
REQ.DLA.DCTX
      5111**DCL      5465<<ASSIGN   5495<<ASSIGN   5509<<ASSIGN   5525<<ASSIGN   5615<<ASSIGN
REQ.DLA.DRELADDR
      5112**DCL      5112--REDEF
REQ.DVE.EOMCHAR
      5149**DCL      5150--REDEF
REQ.DVE.VFC
      5150**DCL      5502<<ASSIGN   5620<<ASSIGN
REQ.EAINFO
      5143**DCL      5143--REDEF
REQ.EAINFOX
      5143**DCL      5144--REDEF
REQ.EVNTINFO
      5144**DCL      5144--REDEF
REQ.FC
      5114**DCL      5467<<ASSIGN   5497<<ASSIGN   5527<<ASSIGN   5616<<ASSIGN
REQ.OPFLG
      5117**DCL      5468<<ASSIGN   5498<<ASSIGN   5528<<ASSIGN   5617<<ASSIGN
REQ.RCT
      5146**DCL      5501<<ASSIGN   5619<<ASSIGN
REQ.STATUS
      5125**DCL      5131--REDEF
REQ.TYC
      5133**DCL      5596>>IF       5597>>IF
REQ.TYC.EGV
      5133**DCL      5504>>DOWHILE  5511>>DOWHILE  5593>>DOWHILE  5622>>DOWHILE
REQ$
      5416**DCL      5111--IMP-PTR  5463<<ASSIGN   5464<>CALL     5465>>ASSIGN   5466>>ASSIGN   5467>>ASSIGN
      5468>>ASSIGN   5469>>ASSIGN   5470>>ASSIGN   5494<>CALL     5495>>ASSIGN   5496>>ASSIGN   5497>>ASSIGN
      5498>>ASSIGN   5500>>ASSIGN   5501>>ASSIGN   5502>>ASSIGN   5503>>CALL     5504>>DOWHILE  5509>>ASSIGN
      5510>>CALL     5511>>DOWHILE  5516<>CALL     5524<>CALL     5525>>ASSIGN   5526>>ASSIGN   5527>>ASSIGN
      5528>>ASSIGN   5529>>ASSIGN   5530>>ASSIGN   5590>>CALLBLT  5592>>CALL     5593>>DOWHILE  5596>>IF
      5597>>IF       5598>>ASSIGN   5603<>CALL     5608>>ASSIGN   5609>>CALLBLT  5609>>CALLBLT  5611>>ASSIGN
      5612>>IF       5612>>ASSIGN   5613>>IF       5613>>ASSIGN   5614>>CALLBLT  5614>>CALLBLT  5615>>ASSIGN
      5616>>ASSIGN   5617>>ASSIGN   5618>>ASSIGN   5619>>ASSIGN   5620>>ASSIGN   5621>>CALL     5622>>DOWHILE
      5627<>CALL
PL6.E3A0      #003=IVO$INIT File=IVO$OFFLINE.:E05TSI                             TUE 07/29/97 23:13 Page:125  
SWAP_ERR
      5574**LABEL    5553--GOTO     5559--GOTO     5567--GOTO
SWP.DEVID
      5057**DCL      5552>>IF       5566>>IF
TEXT
      5410**DCL      5460<<CALLBLT  5476<<CALLBLT  5609<<CALLBLT  5609>>CALLBLT  5614>>CALLBLT
UC IN PROCEDURE READ
      5587**DCL      5609>>CALLBLT

PL6.E3A0      #004=IVO$GETCMD File=IVO$OFFLINE.:E05TSI                           TUE 07/29/97 23:15 Page:126  
      570        1        /*T***********************************************************/
      571        2        /*T*                                                         */
      572        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      573        4        /*T*                                                         */
      574        5        /*T***********************************************************/
      575        6        /**/
      576        7        IVO$GETCMD: PROC (P1,P2,P3) ALTRET;
      577        8    1   DCL P1 UBIN;
      578        9    1   DCL P2 UBIN;
      579       10    1   DCL P3 UBIN;
      580       11    1           RETURN;
      581       12    1   END IVO$GETCMD;
      582       13        %EOD;

PL6.E3A0      #004=IVO$GETCMD File=IVO$OFFLINE.:E05TSI                           TUE 07/29/97 23:15 Page:127  
      No diagnostics issued in procedure IVO$GETCMD.

   Procedure IVO$GETCMD requires 3 words for executable code.
   Procedure IVO$GETCMD requires 6 words of local(AUTO) storage.

PL6.E3A0      #004=IVO$GETCMD File=IVO$OFFLINE.:E05TSI                           TUE 07/29/97 23:15 Page:128  

 Object Unit name= IVO$GETCMD                                 File name= IVO$OFFLINE.:E05TOU
 UTS= JUL 29 '97 23:15:04.80 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none     3      3  IVO$GETCMD

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        3  IVO$GETCMD

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET
PL6.E3A0      #004=IVO$GETCMD File=IVO$OFFLINE.:E05TSI                           TUE 07/29/97 23:15 Page:129  


      570        1        /*T***********************************************************/
      571        2        /*T*                                                         */
      572        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      573        4        /*T*                                                         */
      574        5        /*T***********************************************************/
      575        6        /**/
      576        7        IVO$GETCMD: PROC (P1,P2,P3) ALTRET;

      7  0 000000   000000 700200 xent  IVO$GETCMD   TSX0  ! X66_AUTO_3
         0 000001   000006 000003                    ZERO    6,3

      577        8    1   DCL P1 UBIN;
      578        9    1   DCL P2 UBIN;
      579       10    1   DCL P3 UBIN;
      580       11    1           RETURN;

     11  0 000002   000000 702200 xent               TSX2  ! X66_ARET
      581       12    1   END IVO$GETCMD;
      582       13        %EOD;

PL6.E3A0      #004=IVO$GETCMD File=IVO$OFFLINE.:E05TSI                           TUE 07/29/97 23:15 Page:130  
      No diagnostics issued in procedure IVO$GETCMD.
PL6.E3A0      #004=IVO$GETCMD File=IVO$OFFLINE.:E05TSI                           TUE 07/29/97 23:15 Page:131  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @P1                        4-0-0/w PTR         r     1 @P2
     5-0-0/w PTR         r     1 @P3                       *0-0-0/w UBIN        r     1 P1
    *0-0-0/w UBIN        r     1 P2                        *0-0-0/w UBIN        r     1 P3


   Procedure IVO$GETCMD requires 3 words for executable code.
   Procedure IVO$GETCMD requires 6 words of local(AUTO) storage.
PL6.E3A0      #004=IVO$GETCMD File=IVO$OFFLINE.:E05TSI                           TUE 07/29/97 23:15 Page:132  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=IVO$GETCMD File=IVO$OFFLINE.:E05TSI                           TUE 07/29/97 23:15 Page:133  
          MINI XREF LISTING

P1
         8**DCL         7--PROC
P2
         9**DCL         7--PROC
P3
        10**DCL         7--PROC

PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:134  
      583        1        /*T***********************************************************/
      584        2        /*T*                                                         */
      585        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      586        4        /*T*                                                         */
      587        5        /*T***********************************************************/
      588        6        /**/
      589        7        /* DISK I/O ROUTINES */
      590        8        /**/
      591        9        IVO$QUEIO: PROC (VIP) ALTRET;
      592       10        /**/
      593       11        /* INCLUDE FILES */
      594       12        /**/
      595       13        %INCLUDE CP_6_SUBS;
      596      553        %INCLUDE IV$MACROS;
      597      723        %INCLUDE N$REQ;
      598      797        %INCLUDE N_FC_C;
      599      834        %INCLUDE NI$TABLES;
      600     1050        %INCLUDE FM$GRAN;
      601     1119        %INCLUDE IV_SUBS_C;
      602     1182        /**/
      603     1183        /* PARAMETER */
      604     1184        /**/
      605     1185        %IV$VIP(NAME=VIP,STCLASS="");
      606     1249        /**/
      607     1250        /* EXTERNAL REFERENCES */
      608     1251        /**/
      609     1252    1   DCL IVO$EA ENTRY (1) ALTRET;
      610     1253    1   DCL IVO$WAIT ENTRY (1) ALTRET;
      611     1254    1   DCL NIO$QUE ENTRY (1) ALTRET;
      612     1255    1   DCL NIQ$GET ENTRY (1) ALTRET;
      613     1256    1   DCL NIQ$REL ENTRY (1) ALTRET;
      614     1257    1   DCL IVV$ERROR ENTRY(3);
      615     1258    1   DCL IVO$GET ENTRY(2) ALTRET;
      616     1259    1   DCL IVO$FREE ENTRY(1) ALTRET;
      617     1260        /**/
      618     1261        /* DATA STRUCTURES */
      619     1262        /**/
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:135  
      620     1263    1   DCL 1 F BASED ALIGNED,                  /* FREE SPACE PACKET */
      621     1264    1         2 FREE BIT(1),
      622     1265    1         2 NW UBIN(17) UNAL,
      623     1266    1         2 PFREE BIT(1),
      624     1267    1         2 PNW UBIN(17) UNAL;
      625     1268        %IV$FMT(NAME=ELT,STCLASS="BASED(ELT$)");
      626     1324        %IV$FMT(NAME=FMT,STCLASS="BASED(FMT$)");
      627     1380        %N$REQ(NAME=REQ,STCLASS="BASED(REQ$)");
      628     1438        %NI$DVT (NAME=DVT,STCLASS="BASED(VIP.DVT$)");
      629     1445        %FM$VID(FM$VID=VID,BASED="BASED(VIP.VID$)");
      630     1451    1   DCL 1 IOQBUF BASED(IDCW$) DALIGNED,
      631     1452    1         2 IDCW BIT(36) ALIGNED,
      632     1453    1         2 DCW ALIGNED,
      633     1454    1           3 OFFSET UBIN(18) UNAL,
      634     1455    1           3 TALLY UBIN(18) UNAL,
      635     1456    1         2 DATA(0:139) UBIN WORD ALIGNED,
      636     1457    1         2 DATA_MPC REDEF DATA,            /* MPC CONFIGURATION TABLE */
      637     1458    1           3 TABLE_ENTRY(0:279),
      638     1459    1             4 DEV_TYPE UBIN BYTE CALIGNED,
      639     1460    1             4 DEV_NUM UBIN BYTE CALIGNED;
      640     1461    1   DCL 1 MDS_ENTRY BASED(PTR$) ALIGNED,    /* MDS CONFIG TABLE ENTRY */
      641     1462    1         2 STATUS UBIN BYTE CALIGNED,
      642     1463    1         2 TYPE UBIN BYTE CALIGNED,
      643     1464    1         2 FORMAT UBIN BYTE CALIGNED,
      644     1465    1         2 * UBIN BYTE CALIGNED;
      645     1466    1   DCL 1 FIPS_ENTRY BASED(PTR$) ALIGNED,   /* FIPS CONFIG TABLE ENTRY */
      646     1467    1         2 STATUS UBIN BYTE CALIGNED,
      647     1468    1         2 DEV_TYPE UBIN BYTE CALIGNED,
      648     1469    1         2 FORMAT UBIN BYTE CALIGNED,
      649     1470    1         2 * UBIN BYTE CALIGNED;
      650     1471    1   DCL 1 DAU_ENTRY BASED(PTR$) ALIGNED,    /* DAU CONFIG TABLE ENTRY */
      651     1472    1         2 DEV_TYPE UBIN BYTE CALIGNED,
      652     1473    1         2 DEV_NUM UBIN BYTE CALIGNED,
      653     1474    1         2 * UBIN(18) UNAL;
      654     1475        /**/
      655     1476        /* AUTO STACK */
      656     1477        /**/
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:136  
      657     1478    1   DCL I SBIN;
      658     1479    1   DCL J SBIN;
      659     1480    1   DCL PTR$ PTR;
      660     1481    1   DCL IDCW$ PTR;
      661     1482    1   DCL FC SBIN;
      662     1483    1   DCL ELT$ PTR;
      663     1484    1   DCL FMT$ PTR;
      664     1485    1   DCL REQ$ PTR;
      665     1486        /**/
      666     1487    1   DCL SECTSTRT(0:25) UBIN;
      667     1488    1   DCL DTT(0:63) UBIN;
      668     1489    1   DCL DGT(0:63) UBIN;
      669     1490    1   DCL 1 DEV_NUM UBIN(9) CALIGNED;
      670     1491    1   DCL 1 MDS_ADDR REDEF DEV_NUM,
      671     1492    1         2 * BIT(3) UNAL,
      672     1493    1         2 CM# BIT(3) UNAL,
      673     1494    1         2 DEV# BIT(3) UNAL;
      674     1495        /**/
      675     1496        /* INITIATE FORMATTING OF DISK */
      676     1497        /**/
      677     1498    1           CALL NIQ$GET(REQ$) ALTRET(DISK_ERR_1);
      678     1499    1           REQ.DLA.DCTX=VIP.DCTX;
      679     1500    1           REQ.FC=%N_DCWLIST;
      680     1501    1           REQ.OPFLG=OP_BPF | OP_EA;
      681     1502    1           FMT$=VIP.FMT$;
      682     1503    1           REQ.BUFSIZE=FMT.BOUND+1;
      683     1504    1           REQ.BUF$=FMT$;
      684     1505    1           REQ.EAENTRY=ENTADDR(IVO$EA);
      685     1506    1           REQ.DOPTR$=ADDR(VIP);
      686     1507    1           REQ.BPMIR = '1'B;               /* BYPASS MIRRORED DISC PROCESSING */
      687     1508    1           CALL NIO$QUE(REQ) ALTRET(DISK_ERR);
      688     1509    1           RETURN;
      689     1510        %EJECT;
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:137  
      690     1511        /**/
      691     1512        /* READ VID */
      692     1513        /**/
      693     1514    1   IVO$READ_VID: ENTRY (VIP) ALTRET;
      694     1515    1           FC=%N_RDBIN;
      695     1516    1           GOTO VID_CMN;
      696     1517        /**/
      697     1518        /* WRITE VID */
      698     1519        /**/
      699     1520    1   IVO$WRITE_VID: ENTRY (VIP) ALTRET;
      700     1521    1           FC=%N_WRBIN;
      701     1522    1   VID_CMN:
      702     1523    1           CALL NIQ$GET(REQ$) ALTRET(DISK_ERR_1);
      703     1524    1           REQ.DLA.DCTX=VIP.DCTX;
      704     1525    1           REQ.BUFSIZE=4096;
      705     1526    1           REQ.FC=FC;
      706     1527    1           REQ.OPFLG=OP_BPF | OP_HOLD;
      707     1528    1           REQ.BUF$=VIP.VID$;
      708     1529    1           REQ.BPMIR = '1'B;               /* BYPASS MIRRORED DISC PROCESSING */
      709     1530    1           CALL NIO$QUE(REQ) ALTRET(DISK_ERR);
      710     1531    2           DO WHILE (NOT REQ.TYC.EGV);
      711     1532    2              CALL IVO$WAIT('0'B);
      712     1533    2              END;
      713     1534    2           IF REQ.TYC~=%TYC_EGV THEN DO;
      714     1535    2   DISK_ERR:
      715     1536    2              CALL NIQ$REL(REQ$);
      716     1537    2   DISK_ERR_1:
      717     1538    2              ALTRETURN;
      718     1539    2              END;
      719     1540    1           IF FC = %N_RDBIN THEN GOTO RET;
      720     1541    1           SECTSTRT = VID.SECTSTRT;
      721     1542    1           DTT = VID.DTT;
      722     1543    1           DGT = VID.DGT;
      723     1544    2           DO I = 1 TO 25;                 /* Need to put DTT on *ALL* VIDs */
      724     1545    2              IF SECTSTRT(I) = 0 OR SECTSTRT(I)>=DVT.PACKSIZE THEN GOTO RET;
      725     1546    2              REQ.FC = %N_RDBIN;
      726     1547    2              REQ.DLA.DRELADDR = SECTSTRT(I);
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:138  
      727     1548    2              REQ.BPMIR = '1'B;            /* BYPASS MIRRORED DISC PROCESSING */
      728     1549    2              CALL NIO$QUE (REQ) ALTRET (DISK_ERR);
      729     1550    3              DO WHILE (NOT REQ.TYC.EGV);
      730     1551    3                 CALL IVO$WAIT ('0'B);
      731     1552    3                 END;
      732     1553    2              REQ.FC = %N_WRBIN;
      733     1554    2              VID.DTT = DTT;
      734     1555    2              VID.DGT = DGT;
      735     1556    2              REQ.BPMIR = '1'B;            /* BYPASS MIRRORED DISC PROCESSING */
      736     1557    2              CALL NIO$QUE (REQ) ALTRET (DISK_ERR);
      737     1558    3              DO WHILE (NOT REQ.TYC.EGV);
      738     1559    3                 CALL IVO$WAIT ('0'B);
      739     1560    3                 END;
      740     1561    2              END;
      741     1562    1   RET:    ;
      742     1563    1           CALL NIQ$REL(REQ$);
      743     1564    1           RETURN;
      744     1565        %EJECT;
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:139  
      745     1566        /**/
      746     1567        /* READ ELT */
      747     1568        /**/
      748     1569    1   IVO$READ_ELT: ENTRY (VIP) ALTRET;
      749     1570    1           FC=%N_DCWLIST;
      750     1571    1           GOTO ELT_CMN;
      751     1572        /**/
      752     1573        /* WRITE ELT */
      753     1574        /**/
      754     1575    1   IVO$WRITE_ELT: ENTRY (VIP) ALTRET;
      755     1576    1           FC=%N_WRBIN;
      756     1577    1   ELT_CMN: ELT$=VIP.ELT$;
      757     1578    1           CALL NIQ$GET(REQ$) ALTRET(ELT_ERR_1);
      758     1579    1           REQ.DLA.DCTX=VIP.DCTX;
      759     1580    1           REQ.BUFSIZE=ELT.BOUND+1 ;
      760     1581    1           REQ.FC=FC;
      761     1582    1           REQ.OPFLG=OP_BPF | OP_HOLD;
      762     1583    1           REQ.BUF$=VIP.ELT$;
      763     1584    1           REQ.BPMIR = '1'B;               /* BYPASS MIRRORED DISC PROCESSING */
      764     1585    1           CALL NIO$QUE(REQ) ALTRET(ELT_ERR);
      765     1586    2           DO WHILE (NOT REQ.TYC.EGV);
      766     1587    2              CALL IVO$WAIT('0'B);
      767     1588    2              END;
      768     1589    2           IF REQ.TYC~=%TYC_EGV THEN DO;
      769     1590    2   ELT_ERR:
      770     1591    2              CALL NIQ$REL(REQ$);
      771     1592    2   ELT_ERR_1:
      772     1593    2              ALTRETURN;
      773     1594    2              END;
      774     1595    1           CALL NIQ$REL(REQ$);
      775     1596    1           RETURN;
      776     1597        %EJECT;
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:140  
      777     1598        /**/
      778     1599        /* RELEASE DCB */
      779     1600        /**/
      780     1601    1   IVO$RELDCB: ENTRY(VIP) ALTRET;
      781     1602    1           RETURN;               /* THIS ROUTINE ONLY CALLED BY ONLINE VOLINIT */
      782     1603        %EJECT;
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:141  
      783     1604        /**/
      784     1605        /* VERIFY FORMAT */
      785     1606        /**/
      786     1607    1   IVO$VERIFY_FMT: ENTRY(VIP) ALTRET;
      787     1608    1           CALL IVO$GET(IDCW$, 142) ALTRET(NO_SPACE); /* SET UP IDCW */
      788     1609    1           IOQBUF.IDCW = '240000702100'O;  /* READ CONFIG CMD */
      789     1610    1           IOQBUF.DCW.TALLY = 140;
      790     1611    1           IOQBUF.DCW.OFFSET = POFFW( ADDR(IOQBUF.DATA), ADDR(IOQBUF) );
      791     1612    2           DO I = 0 TO 139;
      792     1613    2              IOQBUF.DATA(I) = 0;          /* CLEAR BUFFER */
      793     1614    2              END;
      794     1615    1           CALL NIQ$GET(REQ$) ALTRET(NO_PACKETS);
      795     1616    1           REQ.DLA.DCTX = VIP.MPC_DCTX;
      796     1617    1           REQ.BUFSIZE = 568;
      797     1618    1           REQ.FC = %N_DCWLIST;
      798     1619    1           REQ.OPFLG = OP_BPF | OP_HOLD;
      799     1620    1           REQ.BUF$ = IDCW$;               /* ADDR OF DCW LIST */
      800     1621    1           CALL NIO$QUE(REQ) ALTRET(MPC_ERR); /* ISSUE READ CONFIG TO MPC */
      801     1622    2           DO WHILE (NOT REQ.TYC.EGV);
      802     1623    2              CALL IVO$WAIT('0'B);
      803     1624    2              END;
      804     1625    1           IF REQ.TYC ~= %TYC_EGV THEN GOTO MPC_ERR;
      805     1626    2           DO SELECT (VIP.MODEL);
      806     1627    2              SELECT ('MSU8082 ', 'MSU8092 '); /* MDS DISK */
      807     1628    2              DEV_NUM = VIP.DVN;
      808     1629    2              I = BITBIN(MDS_ADDR.CM#);    /* I = CM# */
      809     1630    2              J = BITBIN(MDS_ADDR.DEV#);   /* J = REL DEVICE # */
      810     1631    2              PTR$ = PINCRW ( ADDR(IOQBUF.DATA), (I*17 + J + 1) );
      811     1632    2              IF MDS_ENTRY.STATUS ~= BITBIN('377'O) /* DEVICE ON-LINE? */
      812     1633    3              THEN DO;
      813     1634    3                 CALL IVV$ERROR(VIP.DEVID,34);
      814     1635    3                 GOTO BAD_FMT;
      815     1636    3                 END;
      816     1637    2              IF MDS_ENTRY.FORMAT ~= BITBIN('002'O) /* 512 WORDS/SECTOR? */
      817     1638    3              THEN DO;
      818     1639    3                 CALL IVV$ERROR(VIP.DEVID, 29);
      819     1640    3                 GOTO BAD_FMT;
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:142  
      820     1641    3                 END;
      821     1642    2              SELECT ('MSU3380 ', 'MSU3382 ', 'MSU3390 ', /* FIPS DISKS */
      822     1643    2                'MSU3392 ', 'MSU3391 ', 'MSU3393 ',
      823     1644    2                'MSU3381 ', 'MSU3383 ');
      824     1645    2              I = VIP.DVN;                 /* I = DEVICE # */
      825     1646    2              PTR$ =PINCRW( ADDR(IOQBUF.DATA), I);
      826     1647    2              IF FIPS_ENTRY.STATUS ~= BITBIN('377'O) /* DEVICE ON-LINE? */
      827     1648    3              THEN DO;
      828     1649    3                 CALL IVV$ERROR(VIP.DEVID,34);
      829     1650    3                 GOTO BAD_FMT;
      830     1651    3                 END;
      831     1652    2              IF FIPS_ENTRY.FORMAT ~= BITBIN('002'O) /* 512 WORDS/SECTOR? */
      832     1653    3              THEN DO;
      833     1654    3                 CALL IVV$ERROR(VIP.DEVID, 30);
      834     1655    3                 GOTO BAD_FMT;
      835     1656    3                 END;
      836     1657    2              SELECT ('MSU0501 ', 'MSU0509 '); /* 501 DISKS */
      837     1658    2              IF VIP.MPC_TYPE = #DAU
      838     1659    3              THEN DO;                     /* DAU CONTROLLER */
      839     1660    4                 DO I = 1 TO 32;
      840     1661    4                    PTR$ = PINCRW (ADDR(IOQBUF.DATA), I);
      841     1662    4                    IF DAU_ENTRY.DEV_NUM = VIP.DVN
      842     1663    4                    THEN GOTO DEVICE_MATCH1;
      843     1664    4                    END;                   /* DO I */
      844     1665    3                 CALL IVV$ERROR(VIP.DEVID, 34); /* DEVICE NOT CONFIGURED */
      845     1666    3                 GOTO BAD_FMT;
      846     1667    3   DEVICE_MATCH1:
      847     1668    3                 IF NOT (DAU_ENTRY.DEV_TYPE = BITBIN(#501N_SP) OR
      848     1669    3                   DAU_ENTRY.DEV_TYPE = BITBIN(#501N_DP))
      849     1670    4                 THEN DO;
      850     1671    4                    CALL IVV$ERROR(VIP.DEVID, 31); /* NOT A 501N DEVICE */
      851     1672    4                    GOTO BAD_FMT;
      852     1673    4                    END;
      853     1674    3                 END;
      854     1675    3              ELSE DO;                     /* MPC CONTROLLER */
      855     1676    4                 DO I = 0 TO 65;
      856     1677    4                    IF IOQBUF.DATA_MPC.TABLE_ENTRY.DEV_NUM(I) = VIP.DVN
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:143  
      857     1678    4                    THEN GOTO DEVICE_MATCH2;
      858     1679    4                    END;                   /* DO I */
      859     1680    3                 CALL IVV$ERROR(VIP.DEVID, 34); /* DEVICE NOT CONFIGURED */
      860     1681    3                 GOTO BAD_FMT;
      861     1682    3   DEVICE_MATCH2:
      862     1683    3                 IF NOT (IOQBUF.DATA_MPC.TABLE_ENTRY.DEV_TYPE(I) = BITBIN(#501N_SP) OR
      863     1684    3                   IOQBUF.DATA_MPC.TABLE_ENTRY.DEV_TYPE(I) = BITBIN(#501N_DP))
      864     1685    4                 THEN DO;                  /* NOT A 501N DEVICE */
      865     1686    4                    CALL IVV$ERROR(VIP.DEVID, 31);
      866     1687    4                    GOTO BAD_FMT;
      867     1688    4                    END;
      868     1689    3                 END;                      /* ELSE DO */
      869     1690    2              END;                         /* DO SELECT */
      870     1691    1           CALL NIQ$REL(REQ$);
      871     1692    1           CALL IVO$FREE(IDCW$);
      872     1693    1           RETURN;
      873     1694    1   NO_SPACE:
      874     1695    1           CALL IVV$ERROR(,9);
      875     1696    1           ALTRETURN;
      876     1697    1   NO_PACKETS:
      877     1698    1           CALL IVV$ERROR(,32);
      878     1699    1           CALL IVO$FREE(IDCW$);
      879     1700    1           ALTRETURN;
      880     1701    1   MPC_ERR:
      881     1702    1           CALL IVV$ERROR(VIP.DEVID, 33);
      882     1703    1   BAD_FMT:
      883     1704    1           CALL IVO$FREE(IDCW$);
      884     1705    1           CALL NIQ$REL(REQ$);
      885     1706    1           ALTRETURN;
      886     1707    1   END IVO$QUEIO;
      887     1708        %EOD;

PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:144  
--  Include file information  --

   IV_SUBS_C.:E05TOU  is referenced.
   FM$GRAN.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N_FC_C.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   IV$MACROS.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
      No diagnostics issued in procedure IVO$QUEIO.

   Procedure IVO$QUEIO requires 641 words for executable code.
   Procedure IVO$QUEIO requires 170 words of local(AUTO) storage.

PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:145  

 Object Unit name= IVO$QUEIO                                  File name= IVO$OFFLINE.:E05TOU
 UTS= JUL 29 '97 23:15:08.24 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     25     31  IVO$QUEIO
    1   Proc  even  none   641   1201  IVO$QUEIO
    2  RoData even  none    17     21  IVO$QUEIO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        1  IVO$QUEIO
     1     55          yes     yes      Std        1  IVO$READ_VID
     1     62          yes     yes      Std        1  IVO$WRITE_VID
     1    275          yes     yes      Std        1  IVO$READ_ELT
     1    301          yes     yes      Std        1  IVO$WRITE_ELT
     1    405          yes     yes      Std        1  IVO$RELDCB
     1    410          yes     yes      Std        1  IVO$VERIFY_FMT
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:146  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 NIQ$GET
 yes     yes           Std       1 NIO$QUE
 yes     yes           Std       1 NIQ$REL
 yes     yes           Std       1 IVO$FREE
         yes           Std       3 IVV$ERROR
 yes     yes           Std       1 IVO$EA
 yes     yes           Std       1 IVO$WAIT
 yes     yes           Std       2 IVO$GET
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:147  


      583        1        /*T***********************************************************/
      584        2        /*T*                                                         */
      585        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      586        4        /*T*                                                         */
      587        5        /*T***********************************************************/
      588        6        /**/
      589        7        /* DISK I/O ROUTINES */
      590        8        /**/
      591        9        IVO$QUEIO: PROC (VIP) ALTRET;

      9  1 000000   000000 700200 xent  IVO$QUEIO    TSX0  ! X66_AUTO_1
         1 000001   000252 000001                    ZERO    170,1

      592       10        /**/
      593       11        /* INCLUDE FILES */
      594       12        /**/
      595       13        %INCLUDE CP_6_SUBS;
      596      553        %INCLUDE IV$MACROS;
      597      723        %INCLUDE N$REQ;
      598      797        %INCLUDE N_FC_C;
      599      834        %INCLUDE NI$TABLES;
      600     1050        %INCLUDE FM$GRAN;
      601     1119        %INCLUDE IV_SUBS_C;
      602     1182        /**/
      603     1183        /* PARAMETER */
      604     1184        /**/
      605     1185        %IV$VIP(NAME=VIP,STCLASS="");
      606     1249        /**/
      607     1250        /* EXTERNAL REFERENCES */
      608     1251        /**/
      609     1252    1   DCL IVO$EA ENTRY (1) ALTRET;
      610     1253    1   DCL IVO$WAIT ENTRY (1) ALTRET;
      611     1254    1   DCL NIO$QUE ENTRY (1) ALTRET;
      612     1255    1   DCL NIQ$GET ENTRY (1) ALTRET;
      613     1256    1   DCL NIQ$REL ENTRY (1) ALTRET;
      614     1257    1   DCL IVV$ERROR ENTRY(3);
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:148  
      615     1258    1   DCL IVO$GET ENTRY(2) ALTRET;
      616     1259    1   DCL IVO$FREE ENTRY(1) ALTRET;
      617     1260        /**/
      618     1261        /* DATA STRUCTURES */
      619     1262        /**/
      620     1263    1   DCL 1 F BASED ALIGNED,                  /* FREE SPACE PACKET */
      621     1264    1         2 FREE BIT(1),
      622     1265    1         2 NW UBIN(17) UNAL,
      623     1266    1         2 PFREE BIT(1),
      624     1267    1         2 PNW UBIN(17) UNAL;
      625     1268        %IV$FMT(NAME=ELT,STCLASS="BASED(ELT$)");
      626     1324        %IV$FMT(NAME=FMT,STCLASS="BASED(FMT$)");
      627     1380        %N$REQ(NAME=REQ,STCLASS="BASED(REQ$)");
      628     1438        %NI$DVT (NAME=DVT,STCLASS="BASED(VIP.DVT$)");
      629     1445        %FM$VID(FM$VID=VID,BASED="BASED(VIP.VID$)");
      630     1451    1   DCL 1 IOQBUF BASED(IDCW$) DALIGNED,
      631     1452    1         2 IDCW BIT(36) ALIGNED,
      632     1453    1         2 DCW ALIGNED,
      633     1454    1           3 OFFSET UBIN(18) UNAL,
      634     1455    1           3 TALLY UBIN(18) UNAL,
      635     1456    1         2 DATA(0:139) UBIN WORD ALIGNED,
      636     1457    1         2 DATA_MPC REDEF DATA,            /* MPC CONFIGURATION TABLE */
      637     1458    1           3 TABLE_ENTRY(0:279),
      638     1459    1             4 DEV_TYPE UBIN BYTE CALIGNED,
      639     1460    1             4 DEV_NUM UBIN BYTE CALIGNED;
      640     1461    1   DCL 1 MDS_ENTRY BASED(PTR$) ALIGNED,    /* MDS CONFIG TABLE ENTRY */
      641     1462    1         2 STATUS UBIN BYTE CALIGNED,
      642     1463    1         2 TYPE UBIN BYTE CALIGNED,
      643     1464    1         2 FORMAT UBIN BYTE CALIGNED,
      644     1465    1         2 * UBIN BYTE CALIGNED;
      645     1466    1   DCL 1 FIPS_ENTRY BASED(PTR$) ALIGNED,   /* FIPS CONFIG TABLE ENTRY */
      646     1467    1         2 STATUS UBIN BYTE CALIGNED,
      647     1468    1         2 DEV_TYPE UBIN BYTE CALIGNED,
      648     1469    1         2 FORMAT UBIN BYTE CALIGNED,
      649     1470    1         2 * UBIN BYTE CALIGNED;
      650     1471    1   DCL 1 DAU_ENTRY BASED(PTR$) ALIGNED,    /* DAU CONFIG TABLE ENTRY */
      651     1472    1         2 DEV_TYPE UBIN BYTE CALIGNED,
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:149  
      652     1473    1         2 DEV_NUM UBIN BYTE CALIGNED,
      653     1474    1         2 * UBIN(18) UNAL;
      654     1475        /**/
      655     1476        /* AUTO STACK */
      656     1477        /**/
      657     1478    1   DCL I SBIN;
      658     1479    1   DCL J SBIN;
      659     1480    1   DCL PTR$ PTR;
      660     1481    1   DCL IDCW$ PTR;
      661     1482    1   DCL FC SBIN;
      662     1483    1   DCL ELT$ PTR;
      663     1484    1   DCL FMT$ PTR;
      664     1485    1   DCL REQ$ PTR;
      665     1486        /**/
      666     1487    1   DCL SECTSTRT(0:25) UBIN;
      667     1488    1   DCL DTT(0:63) UBIN;
      668     1489    1   DCL DGT(0:63) UBIN;
      669     1490    1   DCL 1 DEV_NUM UBIN(9) CALIGNED;
      670     1491    1   DCL 1 MDS_ADDR REDEF DEV_NUM,
      671     1492    1         2 * BIT(3) UNAL,
      672     1493    1         2 CM# BIT(3) UNAL,
      673     1494    1         2 DEV# BIT(3) UNAL;
      674     1495        /**/
      675     1496        /* INITIATE FORMATTING OF DISK */
      676     1497        /**/
      677     1498    1           CALL NIQ$GET(REQ$) ALTRET(DISK_ERR_1);

   1498  1 000002   200013 630500                    EPPR0   REQ$,,AUTO
         1 000003   200250 450500                    STP0    DEV_NUM+2,,AUTO
         1 000004   200250 630500                    EPPR0   DEV_NUM+2,,AUTO
         1 000005   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000006   000000 701000 xent               TSX1    NIQ$GET
         1 000007   000150 702000 1                  TSX2    DISK_ERR_1

      678     1499    1           REQ.DLA.DCTX=VIP.DCTX;

   1499  1 000010   200003 470500                    LDP0    @VIP,,AUTO
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:150  
         1 000011   200013 471500                    LDP1    REQ$,,AUTO
         1 000012   000017 236100                    LDQ     15,,PR0
         1 000013   100001 676100                    ERQ     1,,PR1
         1 000014   777770 376003                    ANQ     -8,DU
         1 000015   100001 656100                    ERSQ    1,,PR1

      679     1500    1           REQ.FC=%N_DCWLIST;

   1500  1 000016   200013 471500                    LDP1    REQ$,,AUTO
         1 000017   000000 236003                    LDQ     0,DU
         1 000020   100003 552104                    STBQ    3,'04'O,PR1

      680     1501    1           REQ.OPFLG=OP_BPF | OP_EA;

   1501  1 000021   200013 471500                    LDP1    REQ$,,AUTO
         1 000022   000050 236007                    LDQ     40,DL
         1 000023   100004 552104                    STBQ    4,'04'O,PR1

      681     1502    1           FMT$=VIP.FMT$;

   1502  1 000024   000013 236100                    LDQ     11,,PR0
         1 000025   200012 756100                    STQ     FMT$,,AUTO

      682     1503    1           REQ.BUFSIZE=FMT.BOUND+1;

   1503  1 000026   200013 471500                    LDP1    REQ$,,AUTO
         1 000027   200012 473500                    LDP3    FMT$,,AUTO
         1 000030   300010 236100                    LDQ     8,,PR3
         1 000031   000001 036007                    ADLQ    1,DL
         1 000032   000020 736000                    QLS     16
         1 000033   100004 676100                    ERQ     4,,PR1
         1 000034   000034 376000 xsym               ANQ     B_VECTNIL+28
         1 000035   100004 656100                    ERSQ    4,,PR1

      683     1504    1           REQ.BUF$=FMT$;

   1504  1 000036   200012 236100                    LDQ     FMT$,,AUTO
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:151  
         1 000037   200013 471500                    LDP1    REQ$,,AUTO
         1 000040   100005 756100                    STQ     5,,PR1

      684     1505    1           REQ.EAENTRY=ENTADDR(IVO$EA);

   1505  1 000041   000000 636000 xent               EAQ     IVO$EA
         1 000042   200013 471500                    LDP1    REQ$,,AUTO
         1 000043   100023 756100                    STQ     19,,PR1

      685     1506    1           REQ.DOPTR$=ADDR(VIP);

   1506  1 000044   200003 236100                    LDQ     @VIP,,AUTO
         1 000045   100026 756100                    STQ     22,,PR1

      686     1507    1           REQ.BPMIR = '1'B;               /* BYPASS MIRRORED DISC PROCESSING */

   1507  1 000046   200000 236003                    LDQ     65536,DU
         1 000047   100034 256100                    ORSQ    28,,PR1

      687     1508    1           CALL NIO$QUE(REQ) ALTRET(DISK_ERR);

   1508  1 000050   200013 630500                    EPPR0   REQ$,,AUTO
         1 000051   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000052   000000 701000 xent               TSX1    NIO$QUE
         1 000053   000142 702000 1                  TSX2    DISK_ERR

      688     1509    1           RETURN;

   1509  1 000054   000000 702200 xent               TSX2  ! X66_ARET

      689     1510        %EJECT;
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:152  
      690     1511        /**/
      691     1512        /* READ VID */
      692     1513        /**/
      693     1514    1   IVO$READ_VID: ENTRY (VIP) ALTRET;

   1514  1 000055   000000 700200 xent  IVO$READ_VID TSX0  ! X66_AUTO_1
         1 000056   000252 000001                    ZERO    170,1

      694     1515    1           FC=%N_RDBIN;

   1515  1 000057   000002 235007                    LDA     2,DL
         1 000060   200010 755100                    STA     FC,,AUTO

      695     1516    1           GOTO VID_CMN;

   1516  1 000061   000066 710000 1                  TRA     VID_CMN

      696     1517        /**/
      697     1518        /* WRITE VID */
      698     1519        /**/
      699     1520    1   IVO$WRITE_VID: ENTRY (VIP) ALTRET;

   1520  1 000062   000000 700200 xent  IVO$WRITE_V* TSX0  ! X66_AUTO_1
         1 000063   000252 000001                    ZERO    170,1

      700     1521    1           FC=%N_WRBIN;

   1521  1 000064   000003 235007                    LDA     3,DL
         1 000065   200010 755100                    STA     FC,,AUTO

      701     1522    1   VID_CMN:
      702     1523    1           CALL NIQ$GET(REQ$) ALTRET(DISK_ERR_1);

   1523  1 000066   200013 630500       VID_CMN      EPPR0   REQ$,,AUTO
         1 000067   200250 450500                    STP0    DEV_NUM+2,,AUTO
         1 000070   200250 630500                    EPPR0   DEV_NUM+2,,AUTO
         1 000071   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:153  
         1 000072   000000 701000 xent               TSX1    NIQ$GET
         1 000073   000150 702000 1                  TSX2    DISK_ERR_1

      703     1524    1           REQ.DLA.DCTX=VIP.DCTX;

   1524  1 000074   200003 470500                    LDP0    @VIP,,AUTO
         1 000075   200013 471500                    LDP1    REQ$,,AUTO
         1 000076   000017 236100                    LDQ     15,,PR0
         1 000077   100001 676100                    ERQ     1,,PR1
         1 000100   777770 376003                    ANQ     -8,DU
         1 000101   100001 656100                    ERSQ    1,,PR1

      704     1525    1           REQ.BUFSIZE=4096;

   1525  1 000102   200013 471500                    LDP1    REQ$,,AUTO
         1 000103   100004 236100                    LDQ     4,,PR1
         1 000104   177777 376007                    ANQ     65535,DL
         1 000105   002000 276003                    ORQ     1024,DU
         1 000106   100004 756100                    STQ     4,,PR1

      705     1526    1           REQ.FC=FC;

   1526  1 000107   200013 471500                    LDP1    REQ$,,AUTO
         1 000110   200010 236100                    LDQ     FC,,AUTO
         1 000111   100003 552104                    STBQ    3,'04'O,PR1

      706     1527    1           REQ.OPFLG=OP_BPF | OP_HOLD;

   1527  1 000112   200013 471500                    LDP1    REQ$,,AUTO
         1 000113   000014 236007                    LDQ     12,DL
         1 000114   100004 552104                    STBQ    4,'04'O,PR1

      707     1528    1           REQ.BUF$=VIP.VID$;

   1528  1 000115   000012 236100                    LDQ     10,,PR0
         1 000116   200013 471500                    LDP1    REQ$,,AUTO
         1 000117   100005 756100                    STQ     5,,PR1
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:154  

      708     1529    1           REQ.BPMIR = '1'B;               /* BYPASS MIRRORED DISC PROCESSING */

   1529  1 000120   200013 471500                    LDP1    REQ$,,AUTO
         1 000121   200000 236003                    LDQ     65536,DU
         1 000122   100034 256100                    ORSQ    28,,PR1

      709     1530    1           CALL NIO$QUE(REQ) ALTRET(DISK_ERR);

   1530  1 000123   200013 630500                    EPPR0   REQ$,,AUTO
         1 000124   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000125   000000 701000 xent               TSX1    NIO$QUE
         1 000126   000142 702000 1                  TSX2    DISK_ERR

      710     1531    2           DO WHILE (NOT REQ.TYC.EGV);

   1531  1 000127   000134 710000 1                  TRA     s:1533

      711     1532    2              CALL IVO$WAIT('0'B);

   1532  1 000130   000000 630400 2                  EPPR0   0
         1 000131   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000132   000000 701000 xent               TSX1    IVO$WAIT
         1 000133   000000 011000                    NOP     0

      712     1533    2              END;

   1533  1 000134   200013 470500                    LDP0    REQ$,,AUTO
         1 000135   000021 234100                    SZN     17,,PR0
         1 000136   000130 605000 1                  TPL     s:1532

      713     1534    2           IF REQ.TYC~=%TYC_EGV THEN DO;

   1534  1 000137   000021 236100                    LDQ     17,,PR0
         1 000140   000030 116000 xsym               CMPQ    B_VECTNIL+24
         1 000141   000151 600000 1                  TZE     s:1540

PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:155  
      714     1535    2   DISK_ERR:
      715     1536    2              CALL NIQ$REL(REQ$);

   1536  1 000142   200013 630500       DISK_ERR     EPPR0   REQ$,,AUTO
         1 000143   200250 450500                    STP0    DEV_NUM+2,,AUTO
         1 000144   200250 630500                    EPPR0   DEV_NUM+2,,AUTO
         1 000145   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000146   000000 701000 xent               TSX1    NIQ$REL
         1 000147   000000 011000                    NOP     0

      716     1537    2   DISK_ERR_1:
      717     1538    2              ALTRETURN;

   1538  1 000150   000000 702200 xent  DISK_ERR_1   TSX2  ! X66_AALT

      718     1539    2              END;
      719     1540    1           IF FC = %N_RDBIN THEN GOTO RET;

   1540  1 000151   200010 235100                    LDA     FC,,AUTO
         1 000152   000002 115007                    CMPA    2,DL
         1 000153   000266 600000 1                  TZE     RET

      720     1541    1           SECTSTRT = VID.SECTSTRT;

   1541  1 000154   200003 471500                    LDP1    @VIP,,AUTO
         1 000155   100012 473500                    LDP3    10,,PR1
         1 000156   000100 100500                    MLR     fill='000'O
         1 000157   300010 000150                    ADSC9   8,,PR3                   cn=0,n=104
         1 000160   200014 000150                    ADSC9   SECTSTRT,,AUTO           cn=0,n=104

      721     1542    1           DTT = VID.DTT;

   1542  1 000161   000100 100500                    MLR     fill='000'O
         1 000162   300400 000376                    ADSC9   256,,PR3                 cn=0,n=254
         1 000163   200046 000400                    ADSC9   DTT,,AUTO                cn=0,n=256

      722     1543    1           DGT = VID.DGT;
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:156  

   1543  1 000164   000100 100500                    MLR     fill='000'O
         1 000165   300300 000400                    ADSC9   192,,PR3                 cn=0,n=256
         1 000166   200146 000400                    ADSC9   DGT,,AUTO                cn=0,n=256

      723     1544    2           DO I = 1 TO 25;                 /* Need to put DTT on *ALL* VIDs */

   1544  1 000167   000001 235007                    LDA     1,DL
         1 000170   200004 755100                    STA     I,,AUTO

      724     1545    2              IF SECTSTRT(I) = 0 OR SECTSTRT(I)>=DVT.PACKSIZE THEN GOTO RET;

   1545  1 000171   200004 720100                    LXL0    I,,AUTO
         1 000172   200014 235110                    LDA     SECTSTRT,X0,AUTO
         1 000173   000266 600000 1                  TZE     RET
         1 000174   200003 470500                    LDP0    @VIP,,AUTO
         1 000175   000002 471500                    LDP1    2,,PR0
         1 000176   200014 236110                    LDQ     SECTSTRT,X0,AUTO
         1 000177   100054 116100                    CMPQ    44,,PR1
         1 000200   000266 603000 1                  TRC     RET

      725     1546    2              REQ.FC = %N_RDBIN;

   1546  1 000201   200013 473500                    LDP3    REQ$,,AUTO
         1 000202   000002 236007                    LDQ     2,DL
         1 000203   300003 552104                    STBQ    3,'04'O,PR3

      726     1547    2              REQ.DLA.DRELADDR = SECTSTRT(I);

   1547  1 000204   200013 471500                    LDP1    REQ$,,AUTO
         1 000205   200014 236110                    LDQ     SECTSTRT,X0,AUTO
         1 000206   100001 676100                    ERQ     1,,PR1
         1 000207   000001 376000 2                  ANQ     1
         1 000210   100001 656100                    ERSQ    1,,PR1

      727     1548    2              REQ.BPMIR = '1'B;            /* BYPASS MIRRORED DISC PROCESSING */

PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:157  
   1548  1 000211   200013 471500                    LDP1    REQ$,,AUTO
         1 000212   200000 236003                    LDQ     65536,DU
         1 000213   100034 256100                    ORSQ    28,,PR1

      728     1549    2              CALL NIO$QUE (REQ) ALTRET (DISK_ERR);

   1549  1 000214   200013 630500                    EPPR0   REQ$,,AUTO
         1 000215   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000216   000000 701000 xent               TSX1    NIO$QUE
         1 000217   000142 702000 1                  TSX2    DISK_ERR

      729     1550    3              DO WHILE (NOT REQ.TYC.EGV);

   1550  1 000220   000225 710000 1                  TRA     s:1552

      730     1551    3                 CALL IVO$WAIT ('0'B);

   1551  1 000221   000000 630400 2                  EPPR0   0
         1 000222   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000223   000000 701000 xent               TSX1    IVO$WAIT
         1 000224   000000 011000                    NOP     0

      731     1552    3                 END;

   1552  1 000225   200013 470500                    LDP0    REQ$,,AUTO
         1 000226   000021 234100                    SZN     17,,PR0
         1 000227   000221 605000 1                  TPL     s:1551

      732     1553    2              REQ.FC = %N_WRBIN;

   1553  1 000230   000003 236007                    LDQ     3,DL
         1 000231   000003 552104                    STBQ    3,'04'O,PR0

      733     1554    2              VID.DTT = DTT;

   1554  1 000232   200003 470500                    LDP0    @VIP,,AUTO
         1 000233   000012 471500                    LDP1    10,,PR0
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:158  
         1 000234   000100 100500                    MLR     fill='000'O
         1 000235   200046 000376                    ADSC9   DTT,,AUTO                cn=0,n=254
         1 000236   100400 000376                    ADSC9   256,,PR1                 cn=0,n=254

      734     1555    2              VID.DGT = DGT;

   1555  1 000237   000012 471500                    LDP1    10,,PR0
         1 000240   000100 100500                    MLR     fill='000'O
         1 000241   200146 000400                    ADSC9   DGT,,AUTO                cn=0,n=256
         1 000242   100300 000400                    ADSC9   192,,PR1                 cn=0,n=256

      735     1556    2              REQ.BPMIR = '1'B;            /* BYPASS MIRRORED DISC PROCESSING */

   1556  1 000243   200013 471500                    LDP1    REQ$,,AUTO
         1 000244   200000 236003                    LDQ     65536,DU
         1 000245   100034 256100                    ORSQ    28,,PR1

      736     1557    2              CALL NIO$QUE (REQ) ALTRET (DISK_ERR);

   1557  1 000246   200013 630500                    EPPR0   REQ$,,AUTO
         1 000247   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000250   000000 701000 xent               TSX1    NIO$QUE
         1 000251   000142 702000 1                  TSX2    DISK_ERR

      737     1558    3              DO WHILE (NOT REQ.TYC.EGV);

   1558  1 000252   000257 710000 1                  TRA     s:1560

      738     1559    3                 CALL IVO$WAIT ('0'B);

   1559  1 000253   000000 630400 2                  EPPR0   0
         1 000254   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000255   000000 701000 xent               TSX1    IVO$WAIT
         1 000256   000000 011000                    NOP     0

      739     1560    3                 END;

PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:159  
   1560  1 000257   200013 470500                    LDP0    REQ$,,AUTO
         1 000260   000021 234100                    SZN     17,,PR0
         1 000261   000253 605000 1                  TPL     s:1559

      740     1561    2              END;

   1561  1 000262   200004 054100                    AOS     I,,AUTO
         1 000263   200004 235100                    LDA     I,,AUTO
         1 000264   000031 115007                    CMPA    25,DL
         1 000265   000171 604400 1                  TMOZ    s:1545

   1557  1 000266                       RET          null
      741     1562    1   RET:    ;
      742     1563    1           CALL NIQ$REL(REQ$);

   1563  1 000266   200013 630500                    EPPR0   REQ$,,AUTO
         1 000267   200250 450500                    STP0    DEV_NUM+2,,AUTO
         1 000270   200250 630500                    EPPR0   DEV_NUM+2,,AUTO
         1 000271   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000272   000000 701000 xent               TSX1    NIQ$REL
         1 000273   000000 011000                    NOP     0

      743     1564    1           RETURN;

   1564  1 000274   000000 702200 xent               TSX2  ! X66_ARET

      744     1565        %EJECT;
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:160  
      745     1566        /**/
      746     1567        /* READ ELT */
      747     1568        /**/
      748     1569    1   IVO$READ_ELT: ENTRY (VIP) ALTRET;

   1569  1 000275   000000 700200 xent  IVO$READ_ELT TSX0  ! X66_AUTO_1
         1 000276   000252 000001                    ZERO    170,1

      749     1570    1           FC=%N_DCWLIST;

   1570  1 000277   200010 450100                    STZ     FC,,AUTO

      750     1571    1           GOTO ELT_CMN;

   1571  1 000300   000305 710000 1                  TRA     ELT_CMN

      751     1572        /**/
      752     1573        /* WRITE ELT */
      753     1574        /**/
      754     1575    1   IVO$WRITE_ELT: ENTRY (VIP) ALTRET;

   1575  1 000301   000000 700200 xent  IVO$WRITE_E* TSX0  ! X66_AUTO_1
         1 000302   000252 000001                    ZERO    170,1

      755     1576    1           FC=%N_WRBIN;

   1576  1 000303   000003 235007                    LDA     3,DL
         1 000304   200010 755100                    STA     FC,,AUTO

      756     1577    1   ELT_CMN: ELT$=VIP.ELT$;

   1577  1 000305   200003 470500       ELT_CMN      LDP0    @VIP,,AUTO
         1 000306   000003 236100                    LDQ     3,,PR0
         1 000307   200011 756100                    STQ     ELT$,,AUTO

      757     1578    1           CALL NIQ$GET(REQ$) ALTRET(ELT_ERR_1);

PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:161  
   1578  1 000310   200013 631500                    EPPR1   REQ$,,AUTO
         1 000311   200250 451500                    STP1    DEV_NUM+2,,AUTO
         1 000312   200250 630500                    EPPR0   DEV_NUM+2,,AUTO
         1 000313   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000314   000000 701000 xent               TSX1    NIQ$GET
         1 000315   000375 702000 1                  TSX2    ELT_ERR_1

      758     1579    1           REQ.DLA.DCTX=VIP.DCTX;

   1579  1 000316   200003 470500                    LDP0    @VIP,,AUTO
         1 000317   200013 471500                    LDP1    REQ$,,AUTO
         1 000320   000017 236100                    LDQ     15,,PR0
         1 000321   100001 676100                    ERQ     1,,PR1
         1 000322   777770 376003                    ANQ     -8,DU
         1 000323   100001 656100                    ERSQ    1,,PR1

      759     1580    1           REQ.BUFSIZE=ELT.BOUND+1 ;

   1580  1 000324   200013 471500                    LDP1    REQ$,,AUTO
         1 000325   200011 473500                    LDP3    ELT$,,AUTO
         1 000326   300010 236100                    LDQ     8,,PR3
         1 000327   000001 036007                    ADLQ    1,DL
         1 000330   000020 736000                    QLS     16
         1 000331   100004 676100                    ERQ     4,,PR1
         1 000332   000034 376000 xsym               ANQ     B_VECTNIL+28
         1 000333   100004 656100                    ERSQ    4,,PR1

      760     1581    1           REQ.FC=FC;

   1581  1 000334   200013 471500                    LDP1    REQ$,,AUTO
         1 000335   200010 236100                    LDQ     FC,,AUTO
         1 000336   100003 552104                    STBQ    3,'04'O,PR1

      761     1582    1           REQ.OPFLG=OP_BPF | OP_HOLD;

   1582  1 000337   200013 471500                    LDP1    REQ$,,AUTO
         1 000340   000014 236007                    LDQ     12,DL
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:162  
         1 000341   100004 552104                    STBQ    4,'04'O,PR1

      762     1583    1           REQ.BUF$=VIP.ELT$;

   1583  1 000342   000003 236100                    LDQ     3,,PR0
         1 000343   200013 471500                    LDP1    REQ$,,AUTO
         1 000344   100005 756100                    STQ     5,,PR1

      763     1584    1           REQ.BPMIR = '1'B;               /* BYPASS MIRRORED DISC PROCESSING */

   1584  1 000345   200013 471500                    LDP1    REQ$,,AUTO
         1 000346   200000 236003                    LDQ     65536,DU
         1 000347   100034 256100                    ORSQ    28,,PR1

      764     1585    1           CALL NIO$QUE(REQ) ALTRET(ELT_ERR);

   1585  1 000350   200013 630500                    EPPR0   REQ$,,AUTO
         1 000351   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000352   000000 701000 xent               TSX1    NIO$QUE
         1 000353   000367 702000 1                  TSX2    ELT_ERR

      765     1586    2           DO WHILE (NOT REQ.TYC.EGV);

   1586  1 000354   000361 710000 1                  TRA     s:1588

      766     1587    2              CALL IVO$WAIT('0'B);

   1587  1 000355   000000 630400 2                  EPPR0   0
         1 000356   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000357   000000 701000 xent               TSX1    IVO$WAIT
         1 000360   000000 011000                    NOP     0

      767     1588    2              END;

   1588  1 000361   200013 470500                    LDP0    REQ$,,AUTO
         1 000362   000021 234100                    SZN     17,,PR0
         1 000363   000355 605000 1                  TPL     s:1587
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:163  

      768     1589    2           IF REQ.TYC~=%TYC_EGV THEN DO;

   1589  1 000364   000021 236100                    LDQ     17,,PR0
         1 000365   000030 116000 xsym               CMPQ    B_VECTNIL+24
         1 000366   000376 600000 1                  TZE     s:1595

      769     1590    2   ELT_ERR:
      770     1591    2              CALL NIQ$REL(REQ$);

   1591  1 000367   200013 630500       ELT_ERR      EPPR0   REQ$,,AUTO
         1 000370   200250 450500                    STP0    DEV_NUM+2,,AUTO
         1 000371   200250 630500                    EPPR0   DEV_NUM+2,,AUTO
         1 000372   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000373   000000 701000 xent               TSX1    NIQ$REL
         1 000374   000000 011000                    NOP     0

      771     1592    2   ELT_ERR_1:
      772     1593    2              ALTRETURN;

   1593  1 000375   000000 702200 xent  ELT_ERR_1    TSX2  ! X66_AALT

      773     1594    2              END;
      774     1595    1           CALL NIQ$REL(REQ$);

   1595  1 000376   200013 631500                    EPPR1   REQ$,,AUTO
         1 000377   200250 451500                    STP1    DEV_NUM+2,,AUTO
         1 000400   200250 630500                    EPPR0   DEV_NUM+2,,AUTO
         1 000401   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000402   000000 701000 xent               TSX1    NIQ$REL
         1 000403   000000 011000                    NOP     0

      775     1596    1           RETURN;

   1596  1 000404   000000 702200 xent               TSX2  ! X66_ARET

      776     1597        %EJECT;
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:164  
      777     1598        /**/
      778     1599        /* RELEASE DCB */
      779     1600        /**/
      780     1601    1   IVO$RELDCB: ENTRY(VIP) ALTRET;

   1601  1 000405   000000 700200 xent  IVO$RELDCB   TSX0  ! X66_AUTO_1
         1 000406   000252 000001                    ZERO    170,1

      781     1602    1           RETURN;               /* THIS ROUTINE ONLY CALLED BY ONLINE VOLINIT */

   1602  1 000407   000000 702200 xent               TSX2  ! X66_ARET

      782     1603        %EJECT;
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:165  
      783     1604        /**/
      784     1605        /* VERIFY FORMAT */
      785     1606        /**/
      786     1607    1   IVO$VERIFY_FMT: ENTRY(VIP) ALTRET;

   1607  1 000410   000000 700200 xent  IVO$VERIFY_* TSX0  ! X66_AUTO_1
         1 000411   000252 000001                    ZERO    170,1

      787     1608    1           CALL IVO$GET(IDCW$, 142) ALTRET(NO_SPACE); /* SET UP IDCW */

   1608  1 000412   000003 236000 2                  LDQ     3
         1 000413   200251 756100                    STQ     DEV_NUM+3,,AUTO
         1 000414   200007 630500                    EPPR0   IDCW$,,AUTO
         1 000415   200250 450500                    STP0    DEV_NUM+2,,AUTO
         1 000416   200250 630500                    EPPR0   DEV_NUM+2,,AUTO
         1 000417   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000420   000000 701000 xent               TSX1    IVO$GET
         1 000421   001125 702000 1                  TSX2    NO_SPACE

      788     1609    1           IOQBUF.IDCW = '240000702100'O;  /* READ CONFIG CMD */

   1609  1 000422   000000 236000 0                  LDQ     0
         1 000423   200007 470500                    LDP0    IDCW$,,AUTO
         1 000424   000000 756100                    STQ     0,,PR0

      789     1610    1           IOQBUF.DCW.TALLY = 140;

   1610  1 000425   000214 220003                    LDX0    140,DU
         1 000426   200007 470500                    LDP0    IDCW$,,AUTO
         1 000427   000001 440100                    SXL0    1,,PR0

      790     1611    1           IOQBUF.DCW.OFFSET = POFFW( ADDR(IOQBUF.DATA), ADDR(IOQBUF) );

   1611  1 000430   200007 236100                    LDQ     IDCW$,,AUTO
         1 000431   000022 772000                    QRL     18
         1 000432   200250 756100                    STQ     DEV_NUM+2,,AUTO
         1 000433   200007 236100                    LDQ     IDCW$,,AUTO
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:166  
         1 000434   000002 036003                    ADLQ    2,DU
         1 000435   000022 772000                    QRL     18
         1 000436   200250 136100                    SBLQ    DEV_NUM+2,,AUTO
         1 000437   000000 621006                    EAX1    0,QL
         1 000440   200007 470500                    LDP0    IDCW$,,AUTO
         1 000441   000001 741100                    STX1    1,,PR0

      791     1612    2           DO I = 0 TO 139;

   1612  1 000442   200004 450100                    STZ     I,,AUTO

      792     1613    2              IOQBUF.DATA(I) = 0;          /* CLEAR BUFFER */

   1613  1 000443   200007 470500                    LDP0    IDCW$,,AUTO
         1 000444   200004 720100                    LXL0    I,,AUTO
         1 000445   000002 450110                    STZ     2,X0,PR0

      793     1614    2              END;

   1614  1 000446   200004 054100                    AOS     I,,AUTO
         1 000447   200004 235100                    LDA     I,,AUTO
         1 000450   000213 115007                    CMPA    139,DL
         1 000451   000443 604400 1                  TMOZ    s:1613

      794     1615    1           CALL NIQ$GET(REQ$) ALTRET(NO_PACKETS);

   1615  1 000452   200013 630500                    EPPR0   REQ$,,AUTO
         1 000453   200250 450500                    STP0    DEV_NUM+2,,AUTO
         1 000454   200250 630500                    EPPR0   DEV_NUM+2,,AUTO
         1 000455   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000456   000000 701000 xent               TSX1    NIQ$GET
         1 000457   001135 702000 1                  TSX2    NO_PACKETS

      795     1616    1           REQ.DLA.DCTX = VIP.MPC_DCTX;

   1616  1 000460   200003 470500                    LDP0    @VIP,,AUTO
         1 000461   200013 471500                    LDP1    REQ$,,AUTO
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:167  
         1 000462   000021 236100                    LDQ     17,,PR0
         1 000463   000011 736000                    QLS     9
         1 000464   100001 676100                    ERQ     1,,PR1
         1 000465   777770 376003                    ANQ     -8,DU
         1 000466   100001 656100                    ERSQ    1,,PR1

      796     1617    1           REQ.BUFSIZE = 568;

   1617  1 000467   200013 471500                    LDP1    REQ$,,AUTO
         1 000470   100004 236100                    LDQ     4,,PR1
         1 000471   177777 376007                    ANQ     65535,DL
         1 000472   000216 276003                    ORQ     142,DU
         1 000473   100004 756100                    STQ     4,,PR1

      797     1618    1           REQ.FC = %N_DCWLIST;

   1618  1 000474   200013 471500                    LDP1    REQ$,,AUTO
         1 000475   000000 236003                    LDQ     0,DU
         1 000476   100003 552104                    STBQ    3,'04'O,PR1

      798     1619    1           REQ.OPFLG = OP_BPF | OP_HOLD;

   1619  1 000477   200013 471500                    LDP1    REQ$,,AUTO
         1 000500   000014 236007                    LDQ     12,DL
         1 000501   100004 552104                    STBQ    4,'04'O,PR1

      799     1620    1           REQ.BUF$ = IDCW$;               /* ADDR OF DCW LIST */

   1620  1 000502   200007 236100                    LDQ     IDCW$,,AUTO
         1 000503   200013 471500                    LDP1    REQ$,,AUTO
         1 000504   100005 756100                    STQ     5,,PR1

      800     1621    1           CALL NIO$QUE(REQ) ALTRET(MPC_ERR); /* ISSUE READ CONFIG TO MPC */

   1621  1 000505   200013 630500                    EPPR0   REQ$,,AUTO
         1 000506   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000507   000000 701000 xent               TSX1    NIO$QUE
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:168  
         1 000510   001153 702000 1                  TSX2    MPC_ERR

      801     1622    2           DO WHILE (NOT REQ.TYC.EGV);

   1622  1 000511   000516 710000 1                  TRA     s:1624

      802     1623    2              CALL IVO$WAIT('0'B);

   1623  1 000512   000000 630400 2                  EPPR0   0
         1 000513   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000514   000000 701000 xent               TSX1    IVO$WAIT
         1 000515   000000 011000                    NOP     0

      803     1624    2              END;

   1624  1 000516   200013 470500                    LDP0    REQ$,,AUTO
         1 000517   000021 234100                    SZN     17,,PR0
         1 000520   000512 605000 1                  TPL     s:1623

      804     1625    1           IF REQ.TYC ~= %TYC_EGV THEN GOTO MPC_ERR;

   1625  1 000521   000021 236100                    LDQ     17,,PR0
         1 000522   000030 116000 xsym               CMPQ    B_VECTNIL+24
         1 000523   001153 601000 1                  TNZ     MPC_ERR

      805     1626    2           DO SELECT (VIP.MODEL);

   1626  1 000524   200003 471500                    LDP1    @VIP,,AUTO
         1 000525   040000 106500                    CMPC    fill='040'O
         1 000526   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         1 000527   000001 000010 0                  ADSC9   1                        cn=0,n=8
         1 000530   000563 602000 1                  TNC     s:1626+31
         1 000531   000677 600000 1                  TZE     s:1645
         1 000532   040000 106500                    CMPC    fill='040'O
         1 000533   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         1 000534   000003 000010 0                  ADSC9   3                        cn=0,n=8
         1 000535   000544 602000 1                  TNC     s:1626+16
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:169  
         1 000536   000621 600000 1                  TZE     s:1628
         1 000537   040000 106500                    CMPC    fill='040'O
         1 000540   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         1 000541   000005 000010 0                  ADSC9   5                        cn=0,n=8
         1 000542   001110 601000 1                  TNZ     s:1691
         1 000543   000621 710000 1                  TRA     s:1628
         1 000544   040000 106500                    CMPC    fill='040'O
         1 000545   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         1 000546   000007 000010 0                  ADSC9   7                        cn=0,n=8
         1 000547   000556 602000 1                  TNC     s:1626+26
         1 000550   000677 600000 1                  TZE     s:1645
         1 000551   040000 106500                    CMPC    fill='040'O
         1 000552   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         1 000553   000011 000010 0                  ADSC9   9                        cn=0,n=8
         1 000554   001110 601000 1                  TNZ     s:1691
         1 000555   000677 710000 1                  TRA     s:1645
         1 000556   040000 106500                    CMPC    fill='040'O
         1 000557   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         1 000560   000013 000010 0                  ADSC9   11                       cn=0,n=8
         1 000561   001110 601000 1                  TNZ     s:1691
         1 000562   000677 710000 1                  TRA     s:1645
         1 000563   040000 106500                    CMPC    fill='040'O
         1 000564   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         1 000565   000015 000010 0                  ADSC9   13                       cn=0,n=8
         1 000566   000602 602000 1                  TNC     s:1626+46
         1 000567   000677 600000 1                  TZE     s:1645
         1 000570   040000 106500                    CMPC    fill='040'O
         1 000571   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         1 000572   000017 000010 0                  ADSC9   15                       cn=0,n=8
         1 000573   001110 602000 1                  TNC     s:1691
         1 000574   000677 600000 1                  TZE     s:1645
         1 000575   040000 106500                    CMPC    fill='040'O
         1 000576   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         1 000577   000021 000010 0                  ADSC9   17                       cn=0,n=8
         1 000600   001110 601000 1                  TNZ     s:1691
         1 000601   000677 710000 1                  TRA     s:1645
         1 000602   040000 106500                    CMPC    fill='040'O
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:170  
         1 000603   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         1 000604   000023 000010 0                  ADSC9   19                       cn=0,n=8
         1 000605   000614 602000 1                  TNC     s:1626+56
         1 000606   000743 600000 1                  TZE     s:1658
         1 000607   040000 106500                    CMPC    fill='040'O
         1 000610   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         1 000611   000025 000010 0                  ADSC9   21                       cn=0,n=8
         1 000612   001110 601000 1                  TNZ     s:1691
         1 000613   000677 710000 1                  TRA     s:1645
         1 000614   040000 106500                    CMPC    fill='040'O
         1 000615   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         1 000616   000027 000010 0                  ADSC9   23                       cn=0,n=8
         1 000617   001110 601000 1                  TNZ     s:1691
         1 000620   000743 710000 1                  TRA     s:1658

      806     1627    2              SELECT ('MSU8082 ', 'MSU8092 '); /* MDS DISK */

      807     1628    2              DEV_NUM = VIP.DVN;

   1628  1 000621   100021 236100                    LDQ     17,,PR1
         1 000622   200246 552140                    STBQ    DEV_NUM,'40'O,AUTO

      808     1629    2              I = BITBIN(MDS_ADDR.CM#);    /* I = CM# */

   1629  1 000623   200246 236100                    LDQ     DEV_NUM,,AUTO
         1 000624   000036 772000                    QRL     30
         1 000625   000007 376007                    ANQ     7,DL
         1 000626   200004 756100                    STQ     I,,AUTO

      809     1630    2              J = BITBIN(MDS_ADDR.DEV#);   /* J = REL DEVICE # */

   1630  1 000627   200246 236100                    LDQ     DEV_NUM,,AUTO
         1 000630   000033 772000                    QRL     27
         1 000631   000007 376007                    ANQ     7,DL
         1 000632   200005 756100                    STQ     J,,AUTO

      810     1631    2              PTR$ = PINCRW ( ADDR(IOQBUF.DATA), (I*17 + J + 1) );
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:171  

   1631  1 000633   200004 236100                    LDQ     I,,AUTO
         1 000634   000021 402007                    MPY     17,DL
         1 000635   200005 036100                    ADLQ    J,,AUTO
         1 000636   000022 736000                    QLS     18
         1 000637   000003 036003                    ADLQ    3,DU
         1 000640   200007 036100                    ADLQ    IDCW$,,AUTO
         1 000641   200006 756100                    STQ     PTR$,,AUTO

      811     1632    2              IF MDS_ENTRY.STATUS ~= BITBIN('377'O) /* DEVICE ON-LINE? */

   1632  1 000642   200006 473500                    LDP3    PTR$,,AUTO
         1 000643   300000 236100                    LDQ     0,,PR3
         1 000644   777000 376003                    ANQ     -512,DU
         1 000645   377000 116003                    CMPQ    130560,DU
         1 000646   000661 600000 1                  TZE     s:1637

      812     1633    3              THEN DO;

      813     1634    3                 CALL IVV$ERROR(VIP.DEVID,34);

   1634  1 000647   000005 236000 2                  LDQ     5
         1 000650   200251 756100                    STQ     DEV_NUM+3,,AUTO
         1 000651   200003 236100                    LDQ     @VIP,,AUTO
         1 000652   000005 036003                    ADLQ    5,DU
         1 000653   200250 756100                    STQ     DEV_NUM+2,,AUTO
         1 000654   200250 630500                    EPPR0   DEV_NUM+2,,AUTO
         1 000655   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000656   000000 701000 xent               TSX1    IVV$ERROR
         1 000657   000000 011000                    NOP     0

      814     1635    3                 GOTO BAD_FMT;

   1635  1 000660   001164 710000 1                  TRA     BAD_FMT

      815     1636    3                 END;
      816     1637    2              IF MDS_ENTRY.FORMAT ~= BITBIN('002'O) /* 512 WORDS/SECTOR? */
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:172  

   1637  1 000661   300000 236100                    LDQ     0,,PR3
         1 000662   777000 376007                    ANQ     -512,DL
         1 000663   002000 116007                    CMPQ    1024,DL
         1 000664   001110 600000 1                  TZE     s:1691

      817     1638    3              THEN DO;

      818     1639    3                 CALL IVV$ERROR(VIP.DEVID, 29);

   1639  1 000665   000007 236000 2                  LDQ     7
         1 000666   200251 756100                    STQ     DEV_NUM+3,,AUTO
         1 000667   200003 236100                    LDQ     @VIP,,AUTO
         1 000670   000005 036003                    ADLQ    5,DU
         1 000671   200250 756100                    STQ     DEV_NUM+2,,AUTO
         1 000672   200250 630500                    EPPR0   DEV_NUM+2,,AUTO
         1 000673   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000674   000000 701000 xent               TSX1    IVV$ERROR
         1 000675   000000 011000                    NOP     0

      819     1640    3                 GOTO BAD_FMT;

   1640  1 000676   001164 710000 1                  TRA     BAD_FMT

      820     1641    3                 END;
      821     1642    2              SELECT ('MSU3380 ', 'MSU3382 ', 'MSU3390 ', /* FIPS DISKS */

      822     1643    2                'MSU3392 ', 'MSU3391 ', 'MSU3393 ',
      823     1644    2                'MSU3381 ', 'MSU3383 ');
      824     1645    2              I = VIP.DVN;                 /* I = DEVICE # */

   1645  1 000677   100021 236100                    LDQ     17,,PR1
         1 000700   000033 772000                    QRL     27
         1 000701   200004 756100                    STQ     I,,AUTO

      825     1646    2              PTR$ =PINCRW( ADDR(IOQBUF.DATA), I);

PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:173  
   1646  1 000702   000022 736000                    QLS     18
         1 000703   000002 036003                    ADLQ    2,DU
         1 000704   200007 036100                    ADLQ    IDCW$,,AUTO
         1 000705   200006 756100                    STQ     PTR$,,AUTO

      826     1647    2              IF FIPS_ENTRY.STATUS ~= BITBIN('377'O) /* DEVICE ON-LINE? */

   1647  1 000706   200006 473500                    LDP3    PTR$,,AUTO
         1 000707   300000 236100                    LDQ     0,,PR3
         1 000710   777000 376003                    ANQ     -512,DU
         1 000711   377000 116003                    CMPQ    130560,DU
         1 000712   000725 600000 1                  TZE     s:1652

      827     1648    3              THEN DO;

      828     1649    3                 CALL IVV$ERROR(VIP.DEVID,34);

   1649  1 000713   000005 236000 2                  LDQ     5
         1 000714   200251 756100                    STQ     DEV_NUM+3,,AUTO
         1 000715   200003 236100                    LDQ     @VIP,,AUTO
         1 000716   000005 036003                    ADLQ    5,DU
         1 000717   200250 756100                    STQ     DEV_NUM+2,,AUTO
         1 000720   200250 630500                    EPPR0   DEV_NUM+2,,AUTO
         1 000721   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000722   000000 701000 xent               TSX1    IVV$ERROR
         1 000723   000000 011000                    NOP     0

      829     1650    3                 GOTO BAD_FMT;

   1650  1 000724   001164 710000 1                  TRA     BAD_FMT

      830     1651    3                 END;
      831     1652    2              IF FIPS_ENTRY.FORMAT ~= BITBIN('002'O) /* 512 WORDS/SECTOR? */

   1652  1 000725   300000 236100                    LDQ     0,,PR3
         1 000726   777000 376007                    ANQ     -512,DL
         1 000727   002000 116007                    CMPQ    1024,DL
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:174  
         1 000730   001110 600000 1                  TZE     s:1691

      832     1653    3              THEN DO;

      833     1654    3                 CALL IVV$ERROR(VIP.DEVID, 30);

   1654  1 000731   000011 236000 2                  LDQ     9
         1 000732   200251 756100                    STQ     DEV_NUM+3,,AUTO
         1 000733   200003 236100                    LDQ     @VIP,,AUTO
         1 000734   000005 036003                    ADLQ    5,DU
         1 000735   200250 756100                    STQ     DEV_NUM+2,,AUTO
         1 000736   200250 630500                    EPPR0   DEV_NUM+2,,AUTO
         1 000737   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000740   000000 701000 xent               TSX1    IVV$ERROR
         1 000741   000000 011000                    NOP     0

      834     1655    3                 GOTO BAD_FMT;

   1655  1 000742   001164 710000 1                  TRA     BAD_FMT

      835     1656    3                 END;
      836     1657    2              SELECT ('MSU0501 ', 'MSU0509 '); /* 501 DISKS */

      837     1658    2              IF VIP.MPC_TYPE = #DAU

   1658  1 000743   100021 236100                    LDQ     17,,PR1
         1 000744   000777 376007                    ANQ     511,DL
         1 000745   000001 116007                    CMPQ    1,DL
         1 000746   001026 601000 1                  TNZ     s:1676

      838     1659    3              THEN DO;                     /* DAU CONTROLLER */

      839     1660    4                 DO I = 1 TO 32;

   1660  1 000747   000001 235007                    LDA     1,DL
         1 000750   200004 755100                    STA     I,,AUTO

PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:175  
      840     1661    4                    PTR$ = PINCRW (ADDR(IOQBUF.DATA), I);

   1661  1 000751   200004 236100                    LDQ     I,,AUTO
         1 000752   000022 736000                    QLS     18
         1 000753   000002 036003                    ADLQ    2,DU
         1 000754   200007 036100                    ADLQ    IDCW$,,AUTO
         1 000755   200006 756100                    STQ     PTR$,,AUTO

      841     1662    4                    IF DAU_ENTRY.DEV_NUM = VIP.DVN

   1662  1 000756   200003 470500                    LDP0    @VIP,,AUTO
         1 000757   000021 236100                    LDQ     17,,PR0
         1 000760   000033 772000                    QRL     27
         1 000761   200250 756100                    STQ     DEV_NUM+2,,AUTO
         1 000762   200006 471500                    LDP1    PTR$,,AUTO
         1 000763   100000 236100                    LDQ     0,,PR1
         1 000764   000022 772000                    QRL     18
         1 000765   000777 376007                    ANQ     511,DL
         1 000766   200250 116100                    CMPQ    DEV_NUM+2,,AUTO
         1 000767   001006 600000 1                  TZE     DEVICE_MATCH1

      842     1663    4                    THEN GOTO DEVICE_MATCH1;
      843     1664    4                    END;                   /* DO I */

   1664  1 000770   200004 054100                    AOS     I,,AUTO
         1 000771   200004 235100                    LDA     I,,AUTO
         1 000772   000040 115007                    CMPA    32,DL
         1 000773   000751 604400 1                  TMOZ    s:1661

      844     1665    3                 CALL IVV$ERROR(VIP.DEVID, 34); /* DEVICE NOT CONFIGURED */

   1665  1 000774   000005 236000 2                  LDQ     5
         1 000775   200251 756100                    STQ     DEV_NUM+3,,AUTO
         1 000776   200003 236100                    LDQ     @VIP,,AUTO
         1 000777   000005 036003                    ADLQ    5,DU
         1 001000   200250 756100                    STQ     DEV_NUM+2,,AUTO
         1 001001   200250 630500                    EPPR0   DEV_NUM+2,,AUTO
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:176  
         1 001002   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001003   000000 701000 xent               TSX1    IVV$ERROR
         1 001004   000000 011000                    NOP     0

      845     1666    3                 GOTO BAD_FMT;

   1666  1 001005   001164 710000 1                  TRA     BAD_FMT

      846     1667    3   DEVICE_MATCH1:
      847     1668    3                 IF NOT (DAU_ENTRY.DEV_TYPE = BITBIN(#501N_SP) OR

   1668  1 001006   100000 236100       DEVICE_MATC* LDQ     0,,PR1
         1 001007   777000 376003                    ANQ     -512,DU
         1 001010   331000 116003                    CMPQ    111104,DU
         1 001011   001110 600000 1                  TZE     s:1691
         1 001012   333000 116003                    CMPQ    112128,DU
         1 001013   001110 600000 1                  TZE     s:1691

      848     1669    3                   DAU_ENTRY.DEV_TYPE = BITBIN(#501N_DP))
      849     1670    4                 THEN DO;

      850     1671    4                    CALL IVV$ERROR(VIP.DEVID, 31); /* NOT A 501N DEVICE */

   1671  1 001014   000013 236000 2                  LDQ     11
         1 001015   200251 756100                    STQ     DEV_NUM+3,,AUTO
         1 001016   200003 236100                    LDQ     @VIP,,AUTO
         1 001017   000005 036003                    ADLQ    5,DU
         1 001020   200250 756100                    STQ     DEV_NUM+2,,AUTO
         1 001021   200250 630500                    EPPR0   DEV_NUM+2,,AUTO
         1 001022   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001023   000000 701000 xent               TSX1    IVV$ERROR
         1 001024   000000 011000                    NOP     0

      851     1672    4                    GOTO BAD_FMT;

   1672  1 001025   001164 710000 1                  TRA     BAD_FMT

PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:177  
      852     1673    4                    END;
      853     1674    3                 END;
      854     1675    3              ELSE DO;                     /* MPC CONTROLLER */

      855     1676    4                 DO I = 0 TO 65;

   1676  1 001026   200004 450100                    STZ     I,,AUTO

      856     1677    4                    IF IOQBUF.DATA_MPC.TABLE_ENTRY.DEV_NUM(I) = VIP.DVN

   1677  1 001027   200003 470500                    LDP0    @VIP,,AUTO
         1 001030   000021 236100                    LDQ     17,,PR0
         1 001031   000033 772000                    QRL     27
         1 001032   200250 756100                    STQ     DEV_NUM+2,,AUTO
         1 001033   200004 235100                    LDA     I,,AUTO
         1 001034   000001 735000                    ALS     1
         1 001035   200007 471500                    LDP1    IDCW$,,AUTO
         1 001036   000100 101505                    MRL     fill='000'O
         1 001037   100002 200001                    ADSC9   2,A,PR1                  cn=1,n=1
         1 001040   200251 000004                    ADSC9   DEV_NUM+3,,AUTO          cn=0,n=4
         1 001041   200251 236100                    LDQ     DEV_NUM+3,,AUTO
         1 001042   200250 116100                    CMPQ    DEV_NUM+2,,AUTO
         1 001043   001062 600000 1                  TZE     DEVICE_MATCH2

      857     1678    4                    THEN GOTO DEVICE_MATCH2;
      858     1679    4                    END;                   /* DO I */

   1679  1 001044   200004 054100                    AOS     I,,AUTO
         1 001045   200004 235100                    LDA     I,,AUTO
         1 001046   000101 115007                    CMPA    65,DL
         1 001047   001027 604400 1                  TMOZ    s:1677

      859     1680    3                 CALL IVV$ERROR(VIP.DEVID, 34); /* DEVICE NOT CONFIGURED */

   1680  1 001050   000005 236000 2                  LDQ     5
         1 001051   200251 756100                    STQ     DEV_NUM+3,,AUTO
         1 001052   200003 236100                    LDQ     @VIP,,AUTO
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:178  
         1 001053   000005 036003                    ADLQ    5,DU
         1 001054   200250 756100                    STQ     DEV_NUM+2,,AUTO
         1 001055   200250 630500                    EPPR0   DEV_NUM+2,,AUTO
         1 001056   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001057   000000 701000 xent               TSX1    IVV$ERROR
         1 001060   000000 011000                    NOP     0

      860     1681    3                 GOTO BAD_FMT;

   1681  1 001061   001164 710000 1                  TRA     BAD_FMT

      861     1682    3   DEVICE_MATCH2:
      862     1683    3                 IF NOT (IOQBUF.DATA_MPC.TABLE_ENTRY.DEV_TYPE(I) = BITBIN(#501N_SP) OR

   1683  1 001062   000100 101505       DEVICE_MATC* MRL     fill='000'O
         1 001063   100002 000001                    ADSC9   2,A,PR1                  cn=0,n=1
         1 001064   200250 000004                    ADSC9   DEV_NUM+2,,AUTO          cn=0,n=4
         1 001065   200250 236100                    LDQ     DEV_NUM+2,,AUTO
         1 001066   000331 116007                    CMPQ    217,DL
         1 001067   001110 600000 1                  TZE     s:1691
         1 001070   000100 101505                    MRL     fill='000'O
         1 001071   100002 000001                    ADSC9   2,A,PR1                  cn=0,n=1
         1 001072   200251 000004                    ADSC9   DEV_NUM+3,,AUTO          cn=0,n=4
         1 001073   200251 236100                    LDQ     DEV_NUM+3,,AUTO
         1 001074   000333 116007                    CMPQ    219,DL
         1 001075   001110 600000 1                  TZE     s:1691

      863     1684    3                   IOQBUF.DATA_MPC.TABLE_ENTRY.DEV_TYPE(I) = BITBIN(#501N_DP))
      864     1685    4                 THEN DO;                  /* NOT A 501N DEVICE */

      865     1686    4                    CALL IVV$ERROR(VIP.DEVID, 31);

   1686  1 001076   000013 236000 2                  LDQ     11
         1 001077   200251 756100                    STQ     DEV_NUM+3,,AUTO
         1 001100   200003 236100                    LDQ     @VIP,,AUTO
         1 001101   000005 036003                    ADLQ    5,DU
         1 001102   200250 756100                    STQ     DEV_NUM+2,,AUTO
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:179  
         1 001103   200250 630500                    EPPR0   DEV_NUM+2,,AUTO
         1 001104   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001105   000000 701000 xent               TSX1    IVV$ERROR
         1 001106   000000 011000                    NOP     0

      866     1687    4                    GOTO BAD_FMT;

   1687  1 001107   001164 710000 1                  TRA     BAD_FMT

      867     1688    4                    END;
      868     1689    3                 END;                      /* ELSE DO */
      869     1690    2              END;                         /* DO SELECT */

      870     1691    1           CALL NIQ$REL(REQ$);

   1691  1 001110   200013 630500                    EPPR0   REQ$,,AUTO
         1 001111   200250 450500                    STP0    DEV_NUM+2,,AUTO
         1 001112   200250 630500                    EPPR0   DEV_NUM+2,,AUTO
         1 001113   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001114   000000 701000 xent               TSX1    NIQ$REL
         1 001115   000000 011000                    NOP     0

      871     1692    1           CALL IVO$FREE(IDCW$);

   1692  1 001116   200007 630500                    EPPR0   IDCW$,,AUTO
         1 001117   200250 450500                    STP0    DEV_NUM+2,,AUTO
         1 001120   200250 630500                    EPPR0   DEV_NUM+2,,AUTO
         1 001121   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001122   000000 701000 xent               TSX1    IVO$FREE
         1 001123   000000 011000                    NOP     0

      872     1693    1           RETURN;

   1693  1 001124   000000 702200 xent               TSX2  ! X66_ARET

      873     1694    1   NO_SPACE:
      874     1695    1           CALL IVV$ERROR(,9);
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:180  

   1695  1 001125   000014 236000 2     NO_SPACE     LDQ     12
         1 001126   000001 235000 xsym               LDA     B_VECTNIL+1
         1 001127   200250 757100                    STAQ    DEV_NUM+2,,AUTO
         1 001130   200250 630500                    EPPR0   DEV_NUM+2,,AUTO
         1 001131   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001132   000000 701000 xent               TSX1    IVV$ERROR
         1 001133   000000 011000                    NOP     0

      875     1696    1           ALTRETURN;

   1696  1 001134   000000 702200 xent               TSX2  ! X66_AALT

      876     1697    1   NO_PACKETS:
      877     1698    1           CALL IVV$ERROR(,32);

   1698  1 001135   000016 236000 2     NO_PACKETS   LDQ     14
         1 001136   000001 235000 xsym               LDA     B_VECTNIL+1
         1 001137   200250 757100                    STAQ    DEV_NUM+2,,AUTO
         1 001140   200250 630500                    EPPR0   DEV_NUM+2,,AUTO
         1 001141   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001142   000000 701000 xent               TSX1    IVV$ERROR
         1 001143   000000 011000                    NOP     0

      878     1699    1           CALL IVO$FREE(IDCW$);

   1699  1 001144   200007 630500                    EPPR0   IDCW$,,AUTO
         1 001145   200250 450500                    STP0    DEV_NUM+2,,AUTO
         1 001146   200250 630500                    EPPR0   DEV_NUM+2,,AUTO
         1 001147   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001150   000000 701000 xent               TSX1    IVO$FREE
         1 001151   000000 011000                    NOP     0

      879     1700    1           ALTRETURN;

   1700  1 001152   000000 702200 xent               TSX2  ! X66_AALT

PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:181  
      880     1701    1   MPC_ERR:
      881     1702    1           CALL IVV$ERROR(VIP.DEVID, 33);

   1702  1 001153   000020 236000 2     MPC_ERR      LDQ     16
         1 001154   200251 756100                    STQ     DEV_NUM+3,,AUTO
         1 001155   200003 236100                    LDQ     @VIP,,AUTO
         1 001156   000005 036003                    ADLQ    5,DU
         1 001157   200250 756100                    STQ     DEV_NUM+2,,AUTO
         1 001160   200250 630500                    EPPR0   DEV_NUM+2,,AUTO
         1 001161   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001162   000000 701000 xent               TSX1    IVV$ERROR
         1 001163   000000 011000                    NOP     0

      882     1703    1   BAD_FMT:
      883     1704    1           CALL IVO$FREE(IDCW$);

   1704  1 001164   200007 630500       BAD_FMT      EPPR0   IDCW$,,AUTO
         1 001165   200250 450500                    STP0    DEV_NUM+2,,AUTO
         1 001166   200250 630500                    EPPR0   DEV_NUM+2,,AUTO
         1 001167   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001170   000000 701000 xent               TSX1    IVO$FREE
         1 001171   000000 011000                    NOP     0

      884     1705    1           CALL NIQ$REL(REQ$);

   1705  1 001172   200013 630500                    EPPR0   REQ$,,AUTO
         1 001173   200250 450500                    STP0    DEV_NUM+2,,AUTO
         1 001174   200250 630500                    EPPR0   DEV_NUM+2,,AUTO
         1 001175   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001176   000000 701000 xent               TSX1    NIQ$REL
         1 001177   000000 011000                    NOP     0

      885     1706    1           ALTRETURN;

   1706  1 001200   000000 702200 xent               TSX2  ! X66_AALT

(unnamed)
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:182  
 Sect OctLoc
   0     000   240000 702100   115123 125063   063071 060040   115123 125070    ...@MSU3390 MSU8
   0     004   060070 062040   115123 125070   060071 062040   115123 125063    082 MSU8092 MSU3
   0     010   063071 062040   115123 125063   063071 063040   115123 125063    392 MSU3393 MSU3
   0     014   063071 061040   115123 125063   063070 061040   115123 125063    391 MSU3381 MSU3
   0     020   063070 062040   115123 125063   063070 063040   115123 125060    382 MSU3383 MSU0
   0     024   065060 071040   115123 125063   063070 060040   115123 125060    509 MSU3380 MSU0
   0     030   065060 061040                                                    501

(unnamed)
 Sect OctLoc
   2     000   000002 006000   000007 777777   000000 000216   000002 006000    ................
   2     004   000000 000042   000004 006000   000000 000035   000006 006000    ..."............
   2     010   000000 000036   000010 006000   000000 000037   000012 006000    ................
   2     014   000013 006000   000000 000040   000015 006000   000000 000041    ....... .......!
   2     020   000017 006000                                                    ....
      886     1707    1   END IVO$QUEIO;
      887     1708        %EOD;

PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:183  
--  Include file information  --

   IV_SUBS_C.:E05TOU  is referenced.
   FM$GRAN.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N_FC_C.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   IV$MACROS.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
      No diagnostics issued in procedure IVO$QUEIO.
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:184  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @VIP                     246-0-0/c UBIN(9)     r     1 DEV_NUM
   146-0-0/w UBIN        r     1 DGT(0:63)                 46-0-0/w UBIN        r     1 DTT(0:63)
    11-0-0/w PTR         r     1 ELT$                      10-0-0/w SBIN        r     1 FC
    12-0-0/w PTR         r     1 FMT$                       4-0-0/w SBIN        r     1 I
     7-0-0/w PTR         r     1 IDCW$                      5-0-0/w SBIN        r     1 J
   246-0-0/c STRC(9)     r     1 MDS_ADDR                   6-0-0/w PTR         r     1 PTR$
    13-0-0/w PTR         r     1 REQ$
    14-0-0/w UBIN        r     1 SECTSTRT(0:25)
    *0-0-0/w STRC(3024)  r     1 VIP

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 DAU_ENTRY                  0-0-0/w STRC(2844)  r     1 DVT
     0-0-0/w STRC(828)   r     1 ELT                        0-0-0/w STRC        r     1 FIPS_ENTRY
     0-0-0/w STRC(828)   r     1 FMT                        0-0-0/d STRC(5112)  r     1 IOQBUF
     0-0-0/w STRC        r     1 MDS_ENTRY                  0-0-0/d STRC(1080)  r     1 REQ
     0-0-0/w STRC(36864) r     1 VID


   Procedure IVO$QUEIO requires 641 words for executable code.
   Procedure IVO$QUEIO requires 170 words of local(AUTO) storage.
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:185  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:186  
          MINI XREF LISTING

BAD_FMT
      1704**LABEL    1635--GOTO     1640--GOTO     1650--GOTO     1655--GOTO     1666--GOTO     1672--GOTO
      1681--GOTO     1687--GOTO
DAU_ENTRY.DEV_NUM
      1473**DCL      1662>>IF
DAU_ENTRY.DEV_TYPE
      1472**DCL      1668>>IF       1668>>IF
DEVICE_MATCH1
      1668**LABEL    1663--GOTO
DEVICE_MATCH2
      1683**LABEL    1678--GOTO
DEV_NUM
      1490**DCL      1491--REDEF    1628<<ASSIGN
DGT
      1489**DCL      1543<<ASSIGN   1555>>ASSIGN
DISK_ERR
      1536**LABEL    1508--CALLALT  1530--CALLALT  1549--CALLALT  1557--CALLALT
DISK_ERR_1
      1538**LABEL    1498--CALLALT  1523--CALLALT
DTT
      1488**DCL      1542<<ASSIGN   1554>>ASSIGN
DVT.MPC
      1441**DCL      1442--REDEF
DVT.PACKSIZE
      1440**DCL      1545>>IF
ELT.BOUND
      1296**DCL      1580>>ASSIGN
ELT.HEADER
      1305**DCL      1321--REDEF    1322--REDEF
ELT.SEEK.SECTOR
      1289**DCL      1290--REDEF
ELT$
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:187  
      1483**DCL      1269--IMP-PTR  1577<<ASSIGN   1580>>ASSIGN
ELT_CMN
      1577**LABEL    1571--GOTO
ELT_ERR
      1591**LABEL    1585--CALLALT
ELT_ERR_1
      1593**LABEL    1578--CALLALT
FC
      1482**DCL      1515<<ASSIGN   1521<<ASSIGN   1526>>ASSIGN   1540>>IF       1570<<ASSIGN   1576<<ASSIGN
      1581>>ASSIGN
FIPS_ENTRY.FORMAT
      1469**DCL      1652>>IF
FIPS_ENTRY.STATUS
      1467**DCL      1647>>IF
FMT.BOUND
      1352**DCL      1503>>ASSIGN
FMT.HEADER
      1361**DCL      1377--REDEF    1378--REDEF
FMT.SEEK.SECTOR
      1345**DCL      1346--REDEF
FMT$
      1484**DCL      1325--IMP-PTR  1502<<ASSIGN   1503>>ASSIGN   1504>>ASSIGN
I
      1478**DCL      1544<<DOINDEX  1545>>IF       1545>>IF       1547>>ASSIGN   1612<<DOINDEX  1613>>ASSIGN
      1629<<ASSIGN   1631>>ASSIGN   1645<<ASSIGN   1646>>ASSIGN   1660<<DOINDEX  1661>>ASSIGN   1676<<DOINDEX
      1677>>IF       1683>>IF       1683>>IF
IDCW$
      1481**DCL      1451--IMP-PTR  1608<>CALL     1609>>ASSIGN   1610>>ASSIGN   1611>>ASSIGN   1611>>ASSIGN
      1611>>ASSIGN   1613>>ASSIGN   1620>>ASSIGN   1631>>ASSIGN   1646>>ASSIGN   1661>>ASSIGN   1677>>IF
      1683>>IF       1683>>IF       1692<>CALL     1699<>CALL     1704<>CALL
IOQBUF
      1451**DCL      1611--ASSIGN
IOQBUF.DATA
      1456**DCL      1457--REDEF    1611--ASSIGN   1613<<ASSIGN   1631--ASSIGN   1646--ASSIGN   1661--ASSIGN
IOQBUF.DATA_MPC.TABLE_ENTRY.DEV_NUM
      1460**DCL      1677>>IF
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:188  
IOQBUF.DATA_MPC.TABLE_ENTRY.DEV_TYPE
      1459**DCL      1683>>IF       1683>>IF
IOQBUF.DCW.OFFSET
      1454**DCL      1611<<ASSIGN
IOQBUF.DCW.TALLY
      1455**DCL      1610<<ASSIGN
IOQBUF.IDCW
      1452**DCL      1609<<ASSIGN
IVO$EA
      1252**DCL-ENT  1505--ASSIGN
IVO$FREE
      1259**DCL-ENT  1692--CALL     1699--CALL     1704--CALL
IVO$GET
      1258**DCL-ENT  1608--CALL
IVO$WAIT
      1253**DCL-ENT  1532--CALL     1551--CALL     1559--CALL     1587--CALL     1623--CALL
IVV$ERROR
      1257**DCL-ENT  1634--CALL     1639--CALL     1649--CALL     1654--CALL     1665--CALL     1671--CALL
      1680--CALL     1686--CALL     1695--CALL     1698--CALL     1702--CALL
J
      1479**DCL      1630<<ASSIGN   1631>>ASSIGN
MDS_ADDR.CM#
      1493**DCL      1629>>ASSIGN
MDS_ADDR.DEV#
      1494**DCL      1630>>ASSIGN
MDS_ENTRY.FORMAT
      1464**DCL      1637>>IF
MDS_ENTRY.STATUS
      1462**DCL      1632>>IF
MPC_ERR
      1702**LABEL    1621--CALLALT  1625--GOTO
NIO$QUE
      1254**DCL-ENT  1508--CALL     1530--CALL     1549--CALL     1557--CALL     1585--CALL     1621--CALL
NIQ$GET
      1255**DCL-ENT  1498--CALL     1523--CALL     1578--CALL     1615--CALL
NIQ$REL
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:189  
      1256**DCL-ENT  1536--CALL     1563--CALL     1591--CALL     1595--CALL     1691--CALL     1705--CALL
NO_PACKETS
      1698**LABEL    1615--CALLALT
NO_SPACE
      1695**LABEL    1608--CALLALT
PTR$
      1480**DCL      1461--IMP-PTR  1466--IMP-PTR  1471--IMP-PTR  1631<<ASSIGN   1632>>IF       1637>>IF
      1646<<ASSIGN   1647>>IF       1652>>IF       1661<<ASSIGN   1662>>IF       1668>>IF       1668>>IF
REQ
      1389**DCL      1508<>CALL     1530<>CALL     1549<>CALL     1557<>CALL     1585<>CALL     1621<>CALL
REQ.BPMIR
      1434**DCL      1507<<ASSIGN   1529<<ASSIGN   1548<<ASSIGN   1556<<ASSIGN   1584<<ASSIGN
REQ.BUF$
      1398**DCL      1504<<ASSIGN   1528<<ASSIGN   1583<<ASSIGN   1620<<ASSIGN
REQ.BUFADDR
      1398**DCL      1399--REDEF    1399--REDEF
REQ.BUFSIZE
      1392**DCL      1503<<ASSIGN   1525<<ASSIGN   1580<<ASSIGN   1617<<ASSIGN
REQ.DLA.DCTX
      1389**DCL      1499<<ASSIGN   1524<<ASSIGN   1579<<ASSIGN   1616<<ASSIGN
REQ.DLA.DRELADDR
      1390**DCL      1390--REDEF    1547<<ASSIGN
REQ.DOPTR$
      1422**DCL      1506<<ASSIGN
REQ.DVE.EOMCHAR
      1427**DCL      1428--REDEF
REQ.EAENTRY
      1420**DCL      1505<<ASSIGN
REQ.EAINFO
      1421**DCL      1421--REDEF
REQ.EAINFOX
      1421**DCL      1422--REDEF
REQ.EVNTINFO
      1422**DCL      1422--REDEF
REQ.FC
      1392**DCL      1500<<ASSIGN   1526<<ASSIGN   1546<<ASSIGN   1553<<ASSIGN   1581<<ASSIGN   1618<<ASSIGN
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:190  
REQ.OPFLG
      1395**DCL      1501<<ASSIGN   1527<<ASSIGN   1582<<ASSIGN   1619<<ASSIGN
REQ.STATUS
      1403**DCL      1409--REDEF
REQ.TYC
      1411**DCL      1534>>IF       1589>>IF       1625>>IF
REQ.TYC.EGV
      1411**DCL      1531>>DOWHILE  1550>>DOWHILE  1558>>DOWHILE  1586>>DOWHILE  1622>>DOWHILE
REQ$
      1485**DCL      1389--IMP-PTR  1498<>CALL     1499>>ASSIGN   1500>>ASSIGN   1501>>ASSIGN   1503>>ASSIGN
      1504>>ASSIGN   1505>>ASSIGN   1506>>ASSIGN   1507>>ASSIGN   1508>>CALL     1523<>CALL     1524>>ASSIGN
      1525>>ASSIGN   1526>>ASSIGN   1527>>ASSIGN   1528>>ASSIGN   1529>>ASSIGN   1530>>CALL     1531>>DOWHILE
      1534>>IF       1536<>CALL     1546>>ASSIGN   1547>>ASSIGN   1548>>ASSIGN   1549>>CALL     1550>>DOWHILE
      1553>>ASSIGN   1556>>ASSIGN   1557>>CALL     1558>>DOWHILE  1563<>CALL     1578<>CALL     1579>>ASSIGN
      1580>>ASSIGN   1581>>ASSIGN   1582>>ASSIGN   1583>>ASSIGN   1584>>ASSIGN   1585>>CALL     1586>>DOWHILE
      1589>>IF       1591<>CALL     1595<>CALL     1615<>CALL     1616>>ASSIGN   1617>>ASSIGN   1618>>ASSIGN
      1619>>ASSIGN   1620>>ASSIGN   1621>>CALL     1622>>DOWHILE  1625>>IF       1691<>CALL     1705<>CALL
RET
      1557**LABEL    1540--GOTO     1545--GOTO
SECTSTRT
      1487**DCL      1541<<ASSIGN   1545>>IF       1545>>IF       1547>>ASSIGN
VID.DGT
      1448**DCL      1543>>ASSIGN   1555<<ASSIGN
VID.DTT
      1448**DCL      1448--REDEF    1542>>ASSIGN   1554<<ASSIGN
VID.SECTSTRT
      1447**DCL      1541>>ASSIGN
VID_CMN
      1523**LABEL    1516--GOTO
VIP
      1186**DCL         9--PROC     1506--ASSIGN   1514--ENTRY    1520--ENTRY    1569--ENTRY    1575--ENTRY
      1601--ENTRY    1607--ENTRY
VIP.CTRACK
      1202**DCL      1203--REDEF
VIP.DCTX
      1207**DCL      1499>>ASSIGN   1524>>ASSIGN   1579>>ASSIGN
PL6.E3A0      #005=IVO$QUEIO File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:15 Page:191  
VIP.DEVID
      1192**DCL      1634<>CALL     1639<>CALL     1649<>CALL     1654<>CALL     1665<>CALL     1671<>CALL
      1680<>CALL     1686<>CALL     1702<>CALL
VIP.DVN
      1232**DCL      1628>>ASSIGN   1645>>ASSIGN   1662>>IF       1677>>IF
VIP.DVT$
      1189**DCL      1439--IMP-PTR  1545>>IF
VIP.ELT$
      1190**DCL      1577>>ASSIGN   1583>>ASSIGN
VIP.FMT$
      1196**DCL      1502>>ASSIGN
VIP.MODEL
      1193**DCL      1626>>DOSELCT
VIP.MPC_DCTX
      1233**DCL      1616>>ASSIGN
VIP.MPC_TYPE
      1234**DCL      1658>>IF
VIP.RANGE.FTRACK
      1240**DCL      1241--REDEF
VIP.RANGE.LTRACK
      1244**DCL      1245--REDEF
VIP.VID$
      1195**DCL      1446--IMP-PTR  1528>>ASSIGN   1541>>ASSIGN   1542>>ASSIGN   1543>>ASSIGN   1554>>ASSIGN
      1555>>ASSIGN

PL6.E3A0      #006=IVO$EA File=IVO$OFFLINE.:E05TSI                               TUE 07/29/97 23:16 Page:192  
      888        1        /*T***********************************************************/
      889        2        /*T*                                                         */
      890        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      891        4        /*T*                                                         */
      892        5        /*T***********************************************************/
      893        6        /**/
      894        7        /* FORMATTING END-ACTION ROUTINE */
      895        8        /**/
      896        9        IVO$EA: PROC (REQ) ALTRET;
      897       10        /**/
      898       11        /* INCLUDE FILES */
      899       12        /**/
      900       13        %INCLUDE CP_6_SUBS;
      901      553        %INCLUDE IV$MACROS;
      902      723        %INCLUDE N$REQ;
      903      797        /**/
      904      798        /* PARAMETER */
      905      799        /**/
      906      800        %N$REQ(NAME=REQ,STCLASS="");
      907      858        /**/
      908      859        /* EXTERNAL REFERENCES */
      909      860        /**/
      910      861    1   DCL IVV$NEXT ENTRY (2) ALTRET;
      911      862        /**/
      912      863        /* DATA STRUCTURES */
      913      864        /**/
      914      865        %IV$VIP(NAME=VIP,STCLASS="BASED(VIP$)");
      915      929        /**/
      916      930        /* AUTO STACK */
      917      931        /**/
      918      932    1   DCL VIP$ PTR;
      919      933        /**/
      920      934        /* PROCEDURE */
      921      935        /**/
      922      936    1           VIP$=REQ.DOPTR$;
      923      937    1           CALL IVV$NEXT(REQ.DOPTR$->VIP,REQ.TYC & ~%TYC_EGV) ALTRET(DONE);
      924      938    1   DONE:
PL6.E3A0      #006=IVO$EA File=IVO$OFFLINE.:E05TSI                               TUE 07/29/97 23:16 Page:193  
      925      939    1           RETURN;
      926      940    1   END IVO$EA;
      927      941        %EOD;

PL6.E3A0      #006=IVO$EA File=IVO$OFFLINE.:E05TSI                               TUE 07/29/97 23:16 Page:194  
--  Include file information  --

   N$REQ.:E05TOU  is referenced.
   IV$MACROS.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
      No diagnostics issued in procedure IVO$EA.

   Procedure IVO$EA requires 18 words for executable code.
   Procedure IVO$EA requires 10 words of local(AUTO) storage.

PL6.E3A0      #006=IVO$EA File=IVO$OFFLINE.:E05TSI                               TUE 07/29/97 23:16 Page:195  

 Object Unit name= IVO$EA                                     File name= IVO$OFFLINE.:E05TOU
 UTS= JUL 29 '97 23:16:08.60 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    18     22  IVO$EA

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        1  IVO$EA

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 IVV$NEXT
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B_VECTNIL
PL6.E3A0      #006=IVO$EA File=IVO$OFFLINE.:E05TSI                               TUE 07/29/97 23:16 Page:196  


      888        1        /*T***********************************************************/
      889        2        /*T*                                                         */
      890        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      891        4        /*T*                                                         */
      892        5        /*T***********************************************************/
      893        6        /**/
      894        7        /* FORMATTING END-ACTION ROUTINE */
      895        8        /**/
      896        9        IVO$EA: PROC (REQ) ALTRET;

      9  0 000000   000000 700200 xent  IVO$EA       TSX0  ! X66_AUTO_1
         0 000001   000012 000001                    ZERO    10,1

      897       10        /**/
      898       11        /* INCLUDE FILES */
      899       12        /**/
      900       13        %INCLUDE CP_6_SUBS;
      901      553        %INCLUDE IV$MACROS;
      902      723        %INCLUDE N$REQ;
      903      797        /**/
      904      798        /* PARAMETER */
      905      799        /**/
      906      800        %N$REQ(NAME=REQ,STCLASS="");
      907      858        /**/
      908      859        /* EXTERNAL REFERENCES */
      909      860        /**/
      910      861    1   DCL IVV$NEXT ENTRY (2) ALTRET;
      911      862        /**/
      912      863        /* DATA STRUCTURES */
      913      864        /**/
      914      865        %IV$VIP(NAME=VIP,STCLASS="BASED(VIP$)");
      915      929        /**/
      916      930        /* AUTO STACK */
      917      931        /**/
      918      932    1   DCL VIP$ PTR;
      919      933        /**/
PL6.E3A0      #006=IVO$EA File=IVO$OFFLINE.:E05TSI                               TUE 07/29/97 23:16 Page:197  
      920      934        /* PROCEDURE */
      921      935        /**/
      922      936    1           VIP$=REQ.DOPTR$;

    936  0 000002   200003 470500                    LDP0    @REQ,,AUTO
         0 000003   000026 236100                    LDQ     22,,PR0
         0 000004   200004 756100                    STQ     VIP$,,AUTO

      923      937    1           CALL IVV$NEXT(REQ.DOPTR$->VIP,REQ.TYC & ~%TYC_EGV) ALTRET(DONE);

    937  0 000005   000026 471500                    LDP1    22,,PR0
         0 000006   000030 236000 xsym               LDQ     B_VECTNIL+24
         0 000007   000027 676000 xsym               ERQ     B_VECTNIL+23
         0 000010   000021 376100                    ANQ     17,,PR0
         0 000011   200006 756100                    STQ     VIP$+2,,AUTO
         0 000012   200006 633500                    EPPR3   VIP$+2,,AUTO
         0 000013   200011 453500                    STP3    VIP$+5,,AUTO
         0 000014   200010 451500                    STP1    VIP$+4,,AUTO
         0 000015   200010 630500                    EPPR0   VIP$+4,,AUTO
         0 000016   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000017   000000 701000 xent               TSX1    IVV$NEXT
         0 000020   000021 702000 0                  TSX2    DONE

      924      938    1   DONE:
      925      939    1           RETURN;

    939  0 000021   000000 702200 xent  DONE         TSX2  ! X66_ARET
      926      940    1   END IVO$EA;
      927      941        %EOD;

PL6.E3A0      #006=IVO$EA File=IVO$OFFLINE.:E05TSI                               TUE 07/29/97 23:16 Page:198  
--  Include file information  --

   N$REQ.:E05TOU  is referenced.
   IV$MACROS.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
      No diagnostics issued in procedure IVO$EA.
PL6.E3A0      #006=IVO$EA File=IVO$OFFLINE.:E05TSI                               TUE 07/29/97 23:16 Page:199  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @REQ                      *0-0-0/d STRC(1080)  r     1 REQ
     4-0-0/w PTR         r     1 VIP$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3024)  r     1 VIP


   Procedure IVO$EA requires 18 words for executable code.
   Procedure IVO$EA requires 10 words of local(AUTO) storage.
PL6.E3A0      #006=IVO$EA File=IVO$OFFLINE.:E05TSI                               TUE 07/29/97 23:16 Page:200  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #006=IVO$EA File=IVO$OFFLINE.:E05TSI                               TUE 07/29/97 23:16 Page:201  
          MINI XREF LISTING

DONE
       939**LABEL     937--CALLALT
IVV$NEXT
       861**DCL-ENT   937--CALL
REQ
       809**DCL         9--PROC
REQ.BUFADDR
       818**DCL       819--REDEF     819--REDEF
REQ.DLA.DRELADDR
       810**DCL       810--REDEF
REQ.DOPTR$
       842**DCL       936>>ASSIGN    937>>CALL
REQ.DVE.EOMCHAR
       847**DCL       848--REDEF
REQ.EAINFO
       841**DCL       841--REDEF
REQ.EAINFOX
       841**DCL       842--REDEF
REQ.EVNTINFO
       842**DCL       842--REDEF
REQ.STATUS
       823**DCL       829--REDEF
REQ.TYC
       831**DCL       937>>CALL
VIP
       866**DCL       937<>CALL
VIP.CTRACK
       882**DCL       883--REDEF
VIP.RANGE.FTRACK
       920**DCL       921--REDEF
VIP.RANGE.LTRACK
       924**DCL       925--REDEF
PL6.E3A0      #006=IVO$EA File=IVO$OFFLINE.:E05TSI                               TUE 07/29/97 23:16 Page:202  
VIP$
       932**DCL       866--IMP-PTR   936<<ASSIGN

PL6.E3A0      #007=IVO$OPINT File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:16 Page:203  
      928        1        /*T***********************************************************/
      929        2        /*T*                                                         */
      930        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      931        4        /*T*                                                         */
      932        5        /*T***********************************************************/
      933        6        /**/
      934        7        /* OPERATOR INTERRUPT AND WAIT ROUTINES */
      935        8        /**/
      936        9        IVO$OPINT: PROC (DCTX,STATUS,INFO) ALTRET;
      937       10        /**/
      938       11        /* PARAMETERS */
      939       12        /**/
      940       13    1   DCL DCTX UBIN(15);
      941       14    1   DCL OPINT REDEF DCTX BIT(1) ALIGNED;
      942       15    1   DCL STATUS SBIN;
      943       16    1   DCL INFO SBIN;
      944       17        /**/
      945       18        /* EXTERNAL REFERENCES */
      946       19        /**/
      947       20    1   DCL NII$LIP ENTRY (1);
      948       21    1   DCL IVZ$IDLE ENTRY;
      949       22        /**/
      950       23        /* STATIC DATA */
      951       24        /**/
      952       25    1   DCL IVO_OPINT BIT(1) SYMREF;
      953       26    1   DCL CTR SBIN SYMREF;
      954       27        /**/
      955       28        /* OPERATOR INTERRUPT */
      956       29        /**/
      957       30    1           IVO_OPINT='1'B;
      958       31    1           RETURN;
      959       32        /**/
      960       33        /* WAIT FOR OPERATOR INTERRUPT */
      961       34        /**/
      962       35    1   IVO$WAIT: ENTRY (DCTX) ALTRET;
      963       36    1           CALL IVZ$IDLE;
      964       37    2           DO INHIBIT;
PL6.E3A0      #007=IVO$OPINT File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:16 Page:204  
      965       38    2              CTR=CTR+1;
      966       39    3              IF CTR>=300 THEN DO;
      967       40    3                 CTR=0;
      968       41    3                 CALL NII$LIP(1);
      969       42    3                 END;
      970       43    3              IF IVO_OPINT THEN DO;
      971       44    4                 IF OPINT THEN DO;
      972       45    4                    IVO_OPINT='0'B;
      973       46    4                    ALTRETURN;
      974       47    4                    END;
      975       48    3                 END/* IF IVO_OPINT */;
      976       49    2              RETURN;
      977       50    2              END/* INHIBIT */;
      978       51    1   END IVO$OPINT;

PL6.E3A0      #007=IVO$OPINT File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:16 Page:205  
      No diagnostics issued in procedure IVO$OPINT.

   Procedure IVO$OPINT requires 28 words for executable code.
   Procedure IVO$OPINT requires 6 words of local(AUTO) storage.

    No errors detected in file IVO$OFFLINE.:E05TSI    .

PL6.E3A0      #007=IVO$OPINT File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:16 Page:206  

 Object Unit name= IVO$OPINT                                  File name= IVO$OFFLINE.:E05TOU
 UTS= JUL 29 '97 23:16:23.56 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    28     34  IVO$OPINT
    1  RoData even  none     1      1  IVO$OPINT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        3  IVO$OPINT
     0      5          yes     yes      Std        1  IVO$WAIT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 IVZ$IDLE
         yes           Std       1 NII$LIP
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     IVO_OPINT                             CTR                                   B_VECTNIL
PL6.E3A0      #007=IVO$OPINT File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:16 Page:207  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #007=IVO$OPINT File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:16 Page:208  


      928        1        /*T***********************************************************/
      929        2        /*T*                                                         */
      930        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      931        4        /*T*                                                         */
      932        5        /*T***********************************************************/
      933        6        /**/
      934        7        /* OPERATOR INTERRUPT AND WAIT ROUTINES */
      935        8        /**/
      936        9        IVO$OPINT: PROC (DCTX,STATUS,INFO) ALTRET;

      9  0 000000   000000 700200 xent  IVO$OPINT    TSX0  ! X66_AUTO_3
         0 000001   000006 000003                    ZERO    6,3

      937       10        /**/
      938       11        /* PARAMETERS */
      939       12        /**/
      940       13    1   DCL DCTX UBIN(15);
      941       14    1   DCL OPINT REDEF DCTX BIT(1) ALIGNED;
      942       15    1   DCL STATUS SBIN;
      943       16    1   DCL INFO SBIN;
      944       17        /**/
      945       18        /* EXTERNAL REFERENCES */
      946       19        /**/
      947       20    1   DCL NII$LIP ENTRY (1);
      948       21    1   DCL IVZ$IDLE ENTRY;
      949       22        /**/
      950       23        /* STATIC DATA */
      951       24        /**/
      952       25    1   DCL IVO_OPINT BIT(1) SYMREF;
      953       26    1   DCL CTR SBIN SYMREF;
      954       27        /**/
      955       28        /* OPERATOR INTERRUPT */
      956       29        /**/
      957       30    1           IVO_OPINT='1'B;

     30  0 000002   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #007=IVO$OPINT File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:16 Page:209  
         0 000003   000000 756000 xsym               STQ     IVO_OPINT

      958       31    1           RETURN;

     31  0 000004   000000 702200 xent               TSX2  ! X66_ARET

      959       32        /**/
      960       33        /* WAIT FOR OPERATOR INTERRUPT */
      961       34        /**/
      962       35    1   IVO$WAIT: ENTRY (DCTX) ALTRET;

     35  0 000005   000000 700200 xent  IVO$WAIT     TSX0  ! X66_AUTO_3
         0 000006   000006 000003                    ZERO    6,3

      963       36    1           CALL IVZ$IDLE;

     36  0 000007   000002 631400 xsym               EPPR1   B_VECTNIL+2
         0 000010   000000 701000 xent               TSX1    IVZ$IDLE
         0 000011   000000 011000                    NOP     0

      964       37    2           DO INHIBIT;

      965       38    2              CTR=CTR+1;

     38  0 000012   000000 054200 xsym               AOS   ! CTR

      966       39    3              IF CTR>=300 THEN DO;

     39  0 000013   000000 235200 xsym               LDA   ! CTR
         0 000014   000454 115207                    CMPA  ! 300,DL
         0 000015   000023 604200 0                  TMI   ! s:43

      967       40    3                 CTR=0;

     40  0 000016   000000 450200 xsym               STZ   ! CTR

      968       41    3                 CALL NII$LIP(1);
PL6.E3A0      #007=IVO$OPINT File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:16 Page:210  

     41  0 000017   000000 630600 1                  EPPR0 ! 0
         0 000020   000017 631600 xsym               EPPR1 ! B_VECTNIL+15
         0 000021   000000 701200 xent               TSX1  ! NII$LIP
         0 000022   000000 011200                    NOP   ! 0

      969       42    3                 END;

      970       43    3              IF IVO_OPINT THEN DO;

     43  0 000023   000000 234200 xsym               SZN   ! IVO_OPINT
         0 000024   000032 605200 0                  TPL   ! s:49

      971       44    4                 IF OPINT THEN DO;

     44  0 000025   200003 470700                    LDP0  ! @DCTX,,AUTO
         0 000026   000000 234300                    SZN   ! 0,,PR0
         0 000027   000032 605200 0                  TPL   ! s:49

      972       45    4                    IVO_OPINT='0'B;

     45  0 000030   000000 450200 xsym               STZ   ! IVO_OPINT

      973       46    4                    ALTRETURN;

     46  0 000031   000000 702200 xent               TSX2  ! X66_AALT

      974       47    4                    END;
      975       48    3                 END/* IF IVO_OPINT */;
      976       49    2              RETURN;

     49  0 000032   000000 702200 xent               TSX2  ! X66_ARET

      977       50    2              END/* INHIBIT */;

      978       51    1   END IVO$OPINT;

PL6.E3A0      #007=IVO$OPINT File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:16 Page:211  
     51  0 000033   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   1     000   000003 006000                                                    ....

PL6.E3A0      #007=IVO$OPINT File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:16 Page:212  
      No diagnostics issued in procedure IVO$OPINT.
PL6.E3A0      #007=IVO$OPINT File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:16 Page:213  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @DCTX                      5-0-0/w PTR         r     1 @INFO
     4-0-0/w PTR         r     1 @STATUS                   *0-0-0/w UBIN(15)    r     1 DCTX
    *0-0-0/w SBIN        r     1 INFO                      *0-0-0/w BIT         r     1 OPINT
    *0-0-0/w SBIN        r     1 STATUS

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 CTR                        0-0-0/b BIT         r     1 IVO_OPINT


   Procedure IVO$OPINT requires 28 words for executable code.
   Procedure IVO$OPINT requires 6 words of local(AUTO) storage.

    No errors detected in file IVO$OFFLINE.:E05TSI    .
PL6.E3A0      #007=IVO$OPINT File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:16 Page:214  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #007=IVO$OPINT File=IVO$OFFLINE.:E05TSI                            TUE 07/29/97 23:16 Page:215  
          MINI XREF LISTING

CTR
        26**DCL        38<<ASSIGN     38>>ASSIGN     39>>IF         40<<ASSIGN
DCTX
        13**DCL         9--PROC       14--REDEF      35--ENTRY
INFO
        16**DCL         9--PROC
IVO_OPINT
        25**DCL        30<<ASSIGN     43>>IF         45<<ASSIGN
IVZ$IDLE
        21**DCL-ENT    36--CALL
NII$LIP
        20**DCL-ENT    41--CALL
OPINT
        14**DCL        44>>IF
STATUS
        15**DCL         9--PROC
