VERSION E05

PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:1    
        1        1        /*M*  DDK$GETADDR - RESOLVES DATA DESCRIPTOR; GIVING ADDRESS */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MCL=4,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*P*  NAME: DDK$GETADDR
       10       10              PURPOSE: THIS ROUTINE RESOLVES A SIM_DTYPE DATA DESCRIPTOR TO
       11       11                       A SET OF VALUES WHICH CAN BE INPUT TO DDK$GETVAL
       12       12                       TO FETCH THE DESCRIBED ITEM OR TO DDK$GETEVAL TO
       13       13                       YIELD A SINGLE RESOLVED ADDRESS.
       14       14             DESCRIPTION: RUNS THROUGH DATA DESCRIPTOR RESOLVING ALL
       15       15                       POINTER QUALIFICATIONS, INDEX CALCULATIONS, AND
       16       16                       ADDRESS EXPRESSION MODIFICATIONS UNTIL IT CAN RETURN
       17       17                       A SINGLE SET OF THESE WHICH DESCRIBE THE ITEM DIRECTLY
       18       18                       (ONE POINTER, ONE BIT OFFSET VALUE, ONE ADDRESS
       19       19                       EXPRESSION AND OPERATOR, ONE SIZE IN BITS AND ONE ADDRESS
       20       20                       TYPE SPECIFICATION FOR THE DESCRIBED ITEM.)
       21       21                                                     */
       22       22        /*D*  NAME: DDK$GETADDR
       23       23              CALL: DDK$GETADDR(ITEM, BIGVAL, SVALUE, SIZE, INDXX, POINTER,
       24       24                       EXPR_VAL, EXPR_OP, ADDR_TYPE, ARRAY_FLAG, SFLAG) ALTRET(ADDRERR)
       25       25             INTERFACE: CALLS DDS$UD_SRCH, DDK$GETVAL
       26       26             INPUT: S_D.DESC$ POINTS TO WORD 0 OF DATA DESCRIPTOR.
       27       27             OUTPUT: ITEM   STRUC(36) - WORD 1 OF DESCRIPTOR
       28       28                     BIGVAL SBIN - VALUE IF ADDR_TYPE = BIGXXX_ACODE
       29       29                     SVALUE SBIN - UDEF VALUE IF ADDR_TYPE = UDEF_ACODE
       30       30                     SIZE   SBIN - SIZE IN BITS OF ITEM (FROM SIZE_ICODE ENTRY)
       31       31                     INDXX  SBIN - BIT OFFSET TO BE ADDED IF ARRAY_FLAG SET
       32       32                     POINTER SBIN - POINTER TO BE USED IF ADDR_TYPE = BASED_ACODE
       33       33                     EXPR_VAL SBIN - VALUE FOR EXPRESSION MODIFICATION IF
       34       34                                     EXPR_OP > 0
       35       35                     EXPR_OP SBIN - 0 NO ADDRESS MODIFICATION
       36       36                                    1 ADD EXPR_VAL TO TRUNCATED WORD OFFSET
       37       37                                    2 SUBTR EXPR_VAL FROM TRUNCATED WORD OFFSET
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:2    
       38       38                                    3 LEFT SHFT EXPR_VAL TO TRUNCATED WORD OFFSET
       39       39                                    4 RIGHT SHFT EXPR_VAL TO TRUNCATED WORD AFFSET
       40       40                    ADDR_TYPE SBIN - ADDRESS TYPE FOR THIS ITEM
       41       41                    ARRAY_FLAG BIT(1) - SET IF ITEM NEEDS INDEX OFSET ADDED
       42       42                    SFLAG BIT(1) - SET IF ITEM.ADR.W OF ITEM NEEDS SIGN EXTENSION
       43       43                                                     */
       44       44        DDK$GETADDR: PROC(ITEM, SVALUE, SIZE, INDXX, POINTER, EXPR_VAL,
       45       45               EXPR_OP, ADDR_TYPE, ARRAY_FLAG) ALTRET;
       46       46          /* PARMS */
       47       47    1   DCL 1 PUP,
       48       48    1         2 SIZE UBIN(22) UNAL,
       49       49    1         2 SCALE SBIN(8) UNAL,
       50       50    1         2 PUB UBIN(2) UNAL,
       51       51    1         2 SIGNPOS UBIN(2) UNAL,
       52       52    1         2 SIGNTYP BIT(1),
       53       53    1         2 SIGNOVER BIT(1);
       54       54    1   DCL SVALUE SBIN;
       55       55    1   DCL SIZE SBIN;
       56       56    1   DCL INDXX SBIN;
       57       57    1   DCL FUDGE UBIN;                    /* FUDGE FACTOR FOR PACKED DECIMAL ARRAYS */
       58       58    1   DCL POINTER SBIN;
       59       59    1   DCL EXPR_VAL SBIN;
       60       60    1   DCL EXPR_OP SBIN;
       61       61    1   DCL ADDR_TYPE SBIN;
       62       62    1   DCL ARRAY_FLAG BIT(1) UNAL;
       63       63          /* LOCAL TMEPS */
       64       64    1   DCL TPOINTER UBIN;
       65       65    1   DCL 1 POINTR REDEF TPOINTER,
       66       66    1         2 ADR,
       67       67    1           3 W UBIN(18) UNAL,
       68       68    1           3 C UBIN(2) UNAL,
       69       69    1           3 B UBIN(4) UNAL,
       70       70    1         2 SEG UBIN(2) UNAL,
       71       71    1         2 DESC# UBIN(10) UNAL;
       72       72    1   DCL 1 PSDITEM REDEF TPOINTER,
       73       73    1         2 TYPE UBIN(6) UNAL,
       74       74    1         2 ID UBIN(9) UNAL,
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:3    
       75       75    1         2 DISP UBIN(9) UNAL,
       76       76    1         2 SEGID UBIN(12) UNAL;
       77       77    1   DCL TEMP SBIN;
       78       78    1   DCL CVALUE CHAR(63) DALIGNED;
       79       79    1   DCL 1 VAL REDEF CVALUE,
       80       80    1         2 WRD UBIN,
       81       81    1         2 * CHAR(60);
       82       82    1   DCL VALUE SBIN;
       83       83    1   DCL 1 PVALUE REDEF VALUE,
       84       84    1         2 * UBIN(24) UNAL,
       85       85    1         2 SFIELD UBIN(2) UNAL,
       86       86    1         2 * UBIN(10) UNAL;
       87       87    1   DCL EIS UBIN;
       88       88    1   DCL PNTR(0:10) SBIN;
       89       89    1   DCL PLEVEL SBIN;
       90       90    1   DCL 1 INDX(0:10),
       91       91    1         2 ADR UBIN,
       92       92    1         2 MULT UBIN,
       93       93    1         2 OFS SBIN,
       94       94    1         2 ELMNTSIZ SBIN;
       95       95    1   DCL ILEVEL SBIN;
       96       96    1   DCL TYPE_CODE SBIN;
       97       97    1   DCL ITEM$ PTR;
       98       98    1   DCL NEXT$ PTR;
       99       99    1   DCL MULT$ PTR;
      100      100    1   DCL MULT SBIN;
      101      101    1   DCL FIRST BIT(1);
      102      102    1   DCL DSIZE SBIN;
      103      103    1   DCL RSIZE SBIN;
      104      104    1   DCL TATYP SBIN;
      105      105    1   DCL IATYP SBIN;
      106      106    1   DCL IIATYP SBIN;
      107      107    1   DCL PITEM$ PTR;
      108      108    1   DCL PPITEM$ PTR;
      109      109    1   DCL SDSIZE SBIN;
      110      110    1   DCL TPNTR SBIN;
      111      111    1   DCL SYM$ PTR;
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:4    
      112      112             %INCLUDE DD_EIS_C;
      113      138    1   DCL MVN(0:2) UBIN CONSTANT INIT(4, 5, 6); /* MVNU_EIS, MVNL_EIS, MVNT_EIS */
      114      139    1   DCL UMVN(0:2) UBIN CONSTANT INIT(15, 16, 17); /* UMVNU_EIS, UMVNL_EIS, UMVNT_EIS */
      115      140    1   DCL BASED_FLAG BIT(1);
      116      141          /* MISC */
      117      142    1   DCL D_XDELTA BIT(1) SYMREF;
      118      143    1   DCL 1 TEXTC BASED,
      119      144    1         2 SZ UBIN(9) UNAL,
      120      145    1         2 * CHAR(1);
      121      146    1   DCL UBIN36 UBIN BASED;
      122      147             %INCLUDE DD$DITEM;
       12+     250             %LIST;
       13+     251    1        DCL SDD$ PTR;
       14+     252    1        DCL ZITEM$ PTR;
       15+     253    1        DCL SDD_L6$ PTR;
       16+     254    1        DCL ZITEM_L6$ PTR;
      123      828             %ZITEM;
      124      900             %DITEM;
      125      980             %DITEM (NAME=ITEM, STCLASS=PARAM);
      126     1060             %MITEM;
      127     1108             %INCLUDE XUH_MACRO_C;
      128     1192             %INCLUDE DD_SD_M;
      129     2528             %S_D;
      130     3846             %INCLUDE DD_ERR_C;
      131     4243          /* EXTERNAL ROUTINES */
      132     4244    1   DCL DDS$UD_SRCH ENTRY(2) ALTRET;
      133     4245    1   DCL DDK$ADDEXPR ENTRY(4);
      134     4246    1   DCL DDK$GETVAL ENTRY(13) ALTRET;
      135     4247    1   DCL DDK$SEXTEND ENTRY(2);
      136     4248    1   DCL DDE$ERROR ENTRY;
      137     4249    1        TYPE_CODE = %SIZE_ICODE + 1;
      138     4250    1        PLEVEL = 0;
      139     4251    1        PNTR(0) = BITBIN('6000'O);
      140     4252    1        INDX.ADR(0) = 0;
      141     4253    1        ILEVEL = 0;
      142     4254    1        EXPR_OP = 0;
      143     4255    1        ZITEM$ = S_D.DESC$;
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:5    
      144     4256    1        ITEM$ = PINCRW(S_D.DESC$, SIZEW(ZITEM)); /* POINT TO FIRST ITEM */
      145     4257                                                /**/
      146     4258    2        DO WHILE( TYPE_CODE ~= %SIZE_ICODE);
      147     4259                                                /**/
      148     4260    2             ITEM = ITEM$ -> DITEM;
      149     4261    2             ARRAY_FLAG = ITEM$ -> DITEM.FLAGS.AFLAG;
      150     4262    2             TYPE_CODE = ITEM$ -> DITEM.TYPE_CODE;
      151     4263    2             IF TYPE_CODE = %SIZE_ICODE
      152     4264    3             THEN DO;
      153     4265    3                  ADDR_TYPE = ZITEM.ADDR_TYPE;
      154     4266    3                END;
      155     4267    3             ELSE DO;
      156     4268    3                  ADDR_TYPE = ITEM$ -> DITEM.ADDR_TYPE;
      157     4269    3                END;
      158     4270    2             NEXT$ = PINCRW(ITEM$, SIZEW(DITEM));
      159     4271    2             IF ADDR_TYPE = %BASED_ACODE
      160     4272    2               OR ADDR_TYPE = %PARM_ACODE
      161     4273    2               OR ADDR_TYPE = %BIGBASED_ACODE
      162     4274    2             THEN BASED_FLAG = '1'B;
      163     4275    2             ELSE BASED_FLAG = '0'B;
      164     4276                                                /**/
      165     4277    3             DO CASE (TYPE_CODE );
      166     4278                                                /**/
      167     4279    3               CASE(ELSE);
      168     4280    3                  S_D.ERROR = 502;    /* E@DELBUG */
      169     4281    3                  CALL DDE$ERROR;
      170     4282    3                  ALTRETURN;
      171     4283                                                /*
      172     4284           SIDX_ICODE
      173     4285                                                */
      174     4286    3               CASE( %SIDX_ICODE );
      175     4287    3                  MULT$ = NEXT$;
      176     4288    3                  NEXT$ = PINCRW(NEXT$, SIZEW(MITEM));
      177     4289    3                  FIRST = ~ MULT$ -> MITEM.CONT;
      178     4290    3   FIRST_LIDX:
      179     4291    3                  PUP = ITEM$ -> DITEM.PUP;
      180     4292    3                  DSIZE = PUP.SIZE;
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:6    
      181     4293    4                  DO CASE(PUP.PUB);
      182     4294    4                    CASE(0);               /* binary value */
      183     4295    4                       RSIZE = 36;
      184     4296    4                       EIS = 0;
      185     4297    4                    CASE(1);               /* packed decimal */
      186     4298    4                       RSIZE = 63;
      187     4299    4                       EIS = MVN(PUP.SIGNPOS);
      188     4300    4                    CASE(2);               /* unpacked decimal */
      189     4301    4                       RSIZE = 63;
      190     4302    4                       EIS = UMVN(PUP.SIGNPOS);
      191     4303    4                       DSIZE = DSIZE / 9;
      192     4304    4                    END;                   /* DO CASE(PUP.PUB) */
      193     4305    3                  CALL DDK$GETVAL(ADDR(CVALUE), ITEM, SVALUE, DSIZE, RSIZE,
      194     4306    3                    INDX.ADR(ILEVEL), PNTR(PLEVEL), EXPR_VAL, EXPR_OP,
      195     4307    3                    ADDR_TYPE, ARRAY_FLAG, '0'B, EIS) ALTRET(ADDRERR);
      196     4308    3                  S_D.ACCESS = '1'B;
      197     4309    3                  REMEMBER TRAP_RTN IN S_D.REM_ACCESS;
      198     4310    3                  IF PUP.PUB ~= 0
      199     4311    3                  THEN CALL XCHARBIN(VALUE, CVALUE);
      200     4312    3                  ELSE VALUE = VAL.WRD;
      201     4313    3                  S_D.ACCESS = '0'B;
      202     4314    3   NOTFIRST_LIDX:
      203     4315    3                  IF ARRAY_FLAG
      204     4316    3                  THEN ILEVEL = ILEVEL - 1;
      205     4317    3                  IF BASED_FLAG
      206     4318    3                  THEN PLEVEL = PLEVEL - 1;
      207     4319    3                  IF TYPE_CODE = %LIDX_ICODE
      208     4320    3                    AND S_D.ARRAY.FIRST
      209     4321    3                  THEN S_D.ARRAY.CUR = VALUE;
      210     4322    3                  IF FIRST
      211     4323    4                  THEN DO;
      212     4324    4                       ILEVEL = ILEVEL + 1;
      213     4325    4                       IF ILEVEL > 10
      214     4326    5                       THEN DO;
      215     4327    5                            S_D.ERROR = 37; /* E@EXPR2CMPLX */
      216     4328    5                            ALTRETURN;
      217     4329    5                          END;
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:7    
      218     4330    4                       INDX.ADR(ILEVEL) = 0;
      219     4331    4                       INDX.MULT(ILEVEL) = 0;
      220     4332    4                       INDX.OFS(ILEVEL) = 0;
      221     4333    4                     END;
      222     4334    3                  IF MULT$ -> MITEM.NEWOFF
      223     4335    4                  THEN DO;
      224     4336    4                       INDX.ADR(ILEVEL) = INDX.ADR(ILEVEL) +
      225     4337    4                         (INDX.MULT(ILEVEL) - INDX.OFS(ILEVEL)) * INDX.ELMNTSIZ(ILEVEL)
              4337                                  ;
      226     4338    4                       INDX.OFS(ILEVEL) = MULT$ -> MITEM.OFS;
      227     4339    4                       INDX.ELMNTSIZ(ILEVEL) = MULT$ -> MITEM.ELMNTSIZ;
      228     4340    4                       INDX.MULT(ILEVEL) = MULT$ -> MITEM.MULT * VALUE;
      229     4341    4                     END;
      230     4342    3                  ELSE INDX.MULT(ILEVEL) = INDX.MULT(ILEVEL) + MULT$ -> MITEM.MULT *
              4342                           VALUE;
      231     4343    3   CHKLAST:       ;
      232     4344    3                  IF ITEM$ -> DITEM.FLAGS.LFLAG
      233     4345    3                  THEN INDX.ADR(ILEVEL) = INDX.ADR(ILEVEL) +
      234     4346    3                         (INDX.MULT(ILEVEL) - INDX.OFS(ILEVEL)) * INDX.ELMNTSIZ(ILEVEL)
              4346                                  ;
      235     4347    3                  FUDGE = (MOD(INDX.ELMNTSIZ(ILEVEL),9)/4) *
      236     4348    3                    ((INDX.MULT(ILEVEL) - INDX.OFS(ILEVEL)+1)/2);
      237     4349                                                /*
      238     4350           LIDX_ICODE
      239     4351                                                */
      240     4352    3               CASE( %LIDX_ICODE );
      241     4353    3                  MULT$ = NEXT$;
      242     4354    3                  NEXT$ = PINCRW(NEXT$, SIZEW(MITEM));
      243     4355    3                  FIRST = ~ MULT$ -> MITEM.CONT;
      244     4356    3                  IF S_D.ARRAY.FIRST
      245     4357    3                  THEN GOTO FIRST_LIDX;
      246     4358    3                  VALUE = S_D.ARRAY.CUR;
      247     4359    3                  GOTO NOTFIRST_LIDX;
      248     4360                                                /*
      249     4361          UIDX_CODE
      250     4362                                                */
      251     4363    3               CASE( %UIDX_ICODE );
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:8    
      252     4364    3                  IF S_D.ARRAY.FIRST
      253     4365    4                  THEN DO;
      254     4366    4                       PUP = ITEM$ -> DITEM.PUP;
      255     4367    4                       DSIZE = PUP.SIZE;
      256     4368    4                       S_D.ARRAY.FIRST = '0'B;
      257     4369    5                       DO CASE(PUP.PUB);
      258     4370    5                         CASE(0);          /* binary */
      259     4371    5                            RSIZE = 36;
      260     4372    5                            EIS=0;
      261     4373    5                         CASE(1);          /* packed decimal */
      262     4374    5                            RSIZE = 63;
      263     4375    5                            EIS = MVN(PUP.SIGNPOS);
      264     4376    5                         CASE(2);          /* unpacked decimal */
      265     4377    5                            RSIZE = 63;
      266     4378    5                            EIS = UMVN(PUP.SIGNPOS);
      267     4379    5                            DSIZE = DSIZE / 9;
      268     4380    5                         END;              /* DO CASE(PUP.PUB) */
      269     4381    4                       CALL DDK$GETVAL(ADDR(CVALUE), ITEM, SVALUE,
      270     4382    4                         DSIZE, RSIZE, INDX.ADR(ILEVEL), PNTR(PLEVEL), EXPR_VAL,
      271     4383    4                         EXPR_OP, ADDR_TYPE, ARRAY_FLAG, '0'B ,EIS) ALTRET(ADDRERR);
      272     4384    4                       IF PUP.PUB ~= 0
      273     4385    4                       THEN CALL XCHARBIN(S_D.ARRAY.HIGH, CVALUE);
      274     4386    4                       ELSE S_D.ARRAY.HIGH = VAL.WRD;
      275     4387    4                     END;
      276     4388    3                  IF ARRAY_FLAG
      277     4389    3                  THEN ILEVEL = ILEVEL - 1;
      278     4390    3                  IF BASED_FLAG
      279     4391    3                  THEN PLEVEL = PLEVEL - 1;
      280     4392    3                  GOTO CHKLAST;
      281     4393                                                /*
      282     4394          PTR_ICODE
      283     4395                                                */
      284     4396    3               CASE( %PTR_ICODE );
      285     4397    3                  TPOINTER = PNTR( PLEVEL );
      286     4398    3                  IF ADDR_TYPE = %SPEC_ACODE
      287     4399    4                  THEN DO;
      288     4400    5                       DO CASE (ITEM.SP.VS.ID);
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:9    
      289     4401    5                         CASE (%IOBUFSZ_RTN, %WSR_RTN, %WSQ_RTN);
      290     4402    5                            IF NOT D_XDELTA
      291     4403    6                            THEN DO;
      292     4404    6                                 S_D.ERROR = 111; /* E@XDONLYSYM */
      293     4405    6                                 ALTRETURN;
      294     4406    6                               END;
      295     4407    5                         CASE (%O_RTN);
      296     4408    5                            RSIZE = 36;
      297     4409    5                            DSIZE = 36;
      298     4410    5                            GOTO GET_NEXT; /* $O SKIP TO END.... */
      299     4411    5                         CASE (ELSE);
      300     4412    5                            ;
      301     4413    5                         END;
      302     4414    4                     END;
      303     4415    3                  IF ADDR_TYPE = %DESC_ACODE AND
      304     4416    3                    (ITEM.SP.VD.TYPE = 8 OR ITEM.SP.VD.TYPE = 9)
      305     4417    4                  THEN DO;
      306     4418    4                       S_D.ERROR = 304; /* E@SYMNOTHOST */
      307     4419    4                       ALTRETURN;
      308     4420    4                     END;
      309     4421    3                  IF POINTR.SEG = 1
      310     4422    4                  THEN DO;
      311     4423    5                       DO CASE (PSDITEM.TYPE);
      312     4424    5                         CASE (0);
      313     4425    6                            DO CASE (PSDITEM.ID);
      314     4426    6                              CASE (3);    /* $TCB */
      315     4427    6                                 IF D_XDELTA
      316     4428    7                                 THEN DO;
      317     4429    7                                      S_D.ERROR = 113; /* E@UDONLYSYM */
      318     4430    7                                      ALTRETURN;
      319     4431    7                                    END;
      320     4432    6                              CASE (5, 6, 7, 9); /* $RVB, $USD, $ERR, $CGn */
      321     4433    6                                 IF NOT S_D.ANLZ_FILE
      322     4434    7                                 THEN DO;
      323     4435    7                                      S_D.ERROR = 182; /* E@NOTANLZ_FILE */
      324     4436    7                                      ALTRETURN;
      325     4437    7                                    END;
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:10   
      326     4438    6                              CASE (8);    /* $HEAD */
      327     4439    6                                 IF NOT S_D.RUM
      328     4440    7                                 THEN DO;
      329     4441    7                                      S_D.ERROR = 202; /* E@RUMONLY */
      330     4442    7                                      ALTRETURN;
      331     4443    7                                    END;
      332     4444    6                              END;         /* DO CASE (PSDITEM.ID)  */
      333     4445    5                         CASE(8,9);        /* $ROSEG, $RDBR, $TSA, $Bn */
      334     4446    5                            IF S_D.RUM
      335     4447    5                            THEN S_D.ERROR = 232; /* E@NOSSRUM */
      336     4448    5                            ELSE S_D.ERROR = 304; /* E@SYMNOTHOST */
      337     4449    5                            ALTRETURN;
      338     4450    5                         CASE (ELSE);
      339     4451    5                            ;
      340     4452    5                         END;              /* DO CASE (PSDITEM.TYPE) */
      341     4453
      342     4454    4                     END;
      343     4455    3                  RSIZE = 36;
      344     4456    3                  DSIZE = 36;
      345     4457    3                  CALL DDK$GETVAL(ADDR(CVALUE), ITEM, SVALUE, DSIZE,
      346     4458    3                    RSIZE, INDX(ILEVEL), PNTR(PLEVEL), EXPR_VAL,
      347     4459    3                    EXPR_OP, ADDR_TYPE, ARRAY_FLAG, '0'B) ALTRET(ADDRERR);
      348     4460    3                  VALUE = VAL.WRD;
      349     4461    3                  IF ARRAY_FLAG
      350     4462    3                  THEN ILEVEL = ILEVEL - 1;
      351     4463    3                  IF BASED_FLAG
      352     4464    3                  THEN PLEVEL = PLEVEL - 1;
      353     4465                                      /* CANT ALLOW GARBAGE PTR TO HAVE S-FIELD = 1  */
      354     4466    3                  IF ADDR_TYPE ~= %DESC_ACODE
      355     4467    3                    AND ADDR_TYPE ~= %SPEC_ACODE
      356     4468    3                  THEN IF PVALUE.SFIELD = 1
      357     4469    3                       THEN PVALUE.SFIELD = 3;
      358     4470    3                  PLEVEL = PLEVEL + 1;
      359     4471    3                  PNTR(PLEVEL) = VALUE;
      360     4472                                                /*
      361     4473          EXP_ICODE
      362     4474                                                */
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:11   
      363     4475    3               CASE( %EXP_ICODE );
      364     4476    3                  EXPR_OP = ITEM$ -> DITEM.FLAGS.EXPOP; /* RESET BY DDK$ADDREXP */
      365     4477    3                  EXPR_VAL = ITEM$ -> DITEM.VALUE;
      366     4478                                                /*
      367     4479          SIZE_ICODE
      368     4480                                                */
      369     4481    3               CASE( %SIZE_ICODE );
      370     4482    3                  TATYP = ITEM.ADDR_TYPE; /* Pick up address type of size of item */
      371     4483    3                  IF TATYP = %PARM_ACODE
      372     4484    4                  THEN DO;                 /* Size of item is based */
      373     4485    4                       PITEM$ = NEXT$;
      374     4486    4                       NEXT$ = PINCRW(NEXT$, SIZEW(DITEM));
      375     4487    4                       IATYP = PITEM$ -> DITEM.ADDR_TYPE;
      376     4488    4                       IF IATYP = %BASED_ACODE
      377     4489    5                       THEN DO;            /* Implied ptr is based */
      378     4490    5                            PPITEM$ = NEXT$;
      379     4491    5                            NEXT$ = PINCRW(NEXT$, SIZEW(DITEM));
      380     4492    5                            IIATYP = PPITEM$ -> DITEM.ADDR_TYPE;
      381     4493    5                            CALL DDK$GETVAL(ADDR(TPNTR), PPITEM$ -> DITEM, SVALUE, 36,
              4493                                     36,
      382     4494    5                              0, 0, 0, 0, IIATYP, '0'B, '0'B) ALTRET(ADDRERR);
      383     4495    5                          END;
      384     4496    4                       CALL DDK$GETVAL(ADDR(TPNTR), PITEM$ -> DITEM, SVALUE, 36, 36, 0,
      385     4497    4                         TPNTR, 0, 0, IATYP, '0'B, '0'B) ALTRET(ADDRERR);
      386     4498    4                     END;
      387     4499    4                  ELSE DO;
              4499                           /* In case it's based, use same pointer as for actual item */
      388     4500    4                       TPNTR = PNTR(PLEVEL);
      389     4501    4                     END;
      390     4502    3                  SDSIZE = ITEM.PUP.SIZE;
      391     4503    3                  CALL DDK$GETVAL(ADDR(SIZE), ITEM, SVALUE, SDSIZE, 36, 0, TPNTR,
      392     4504    3                    0, 0, TATYP, '0'B, '0'B) ALTRET(ADDRERR);
      393     4505    3                  SIZE = SIZE * ITEM.SMULT;
      394     4506    3                  ITEM = PINCRW(ZITEM$, POFFW(ADDR(ZITEM.ADDR_TYPE), ADDR(ZITEM))) ->
              4506                           DITEM;
      395     4507    3                  POINTER = PNTR(PLEVEL);
      396     4508    3                  INDXX = INDX.ADR(ILEVEL);
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:12   
      397     4509    3                  IF ZITEM.PUP.BITS.PUB = 1 THEN INDXX = INDXX + FUDGE;
      398     4510    3               END;                        /* DO CASE( TYPE_CODE ) */
      399     4511    2   GET_NEXT:
      400     4512    2             ITEM$ = NEXT$;
      401     4513    2           END;                       /* DO WHILE (TYPE_CODE ~= %SIZE_ICODE) */
      402     4514    1        S_D.DESC$ = PINCRW(S_D.DESC$, ZITEM.SIZE);
      403     4515    1        RETURN;
      404     4516                                                /**/
      405     4517    1   ADDRERR:
      406     4518    1        S_D.ERROR = 36;             /* E@ADDRBAD */
      407     4519    1        ALTRETURN;
      408     4520    1   TRAP_RTN:
      409     4521    1        S_D.ERROR = 234;         /* E@SUBNOTVALID */
      410     4522    1        S_D.ACCESS = '0'B;
      411     4523    1        ALTRETURN;
      412     4524    1   END DDK$GETADDR;

PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:13   
--  Include file information  --

   DD_ERR_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   DD_EIS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDK$GETADDR.

   Procedure DDK$GETADDR requires 730 words for executable code.
   Procedure DDK$GETADDR requires 126 words of local(AUTO) storage.

    No errors detected in file DDK$GETADDR.:E05TSI    .

PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:14   

 Object Unit name= DDK$GETADDR                                File name= DDK$GETADDR.:E05TOU
 UTS= JUL 29 '97 14:01:18.56 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      6      6  DDK$GETADDR
    1   Proc  even  none   730   1332  DDK$GETADDR
    2  RoData even  none     9     11  DDK$GETADDR

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        9  DDK$GETADDR

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 DDE$ERROR
 yes     yes           Std      13 DDK$GETVAL
                       nStd      0 X66_AUTO_N
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     D_XDELTA                         r    S_D$                                  B_VECTNIL
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:15   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:16   


        1        1        /*M*  DDK$GETADDR - RESOLVES DATA DESCRIPTOR; GIVING ADDRESS */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MCL=4,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*P*  NAME: DDK$GETADDR
       10       10              PURPOSE: THIS ROUTINE RESOLVES A SIM_DTYPE DATA DESCRIPTOR TO
       11       11                       A SET OF VALUES WHICH CAN BE INPUT TO DDK$GETVAL
       12       12                       TO FETCH THE DESCRIBED ITEM OR TO DDK$GETEVAL TO
       13       13                       YIELD A SINGLE RESOLVED ADDRESS.
       14       14             DESCRIPTION: RUNS THROUGH DATA DESCRIPTOR RESOLVING ALL
       15       15                       POINTER QUALIFICATIONS, INDEX CALCULATIONS, AND
       16       16                       ADDRESS EXPRESSION MODIFICATIONS UNTIL IT CAN RETURN
       17       17                       A SINGLE SET OF THESE WHICH DESCRIBE THE ITEM DIRECTLY
       18       18                       (ONE POINTER, ONE BIT OFFSET VALUE, ONE ADDRESS
       19       19                       EXPRESSION AND OPERATOR, ONE SIZE IN BITS AND ONE ADDRESS
       20       20                       TYPE SPECIFICATION FOR THE DESCRIBED ITEM.)
       21       21                                                     */
       22       22        /*D*  NAME: DDK$GETADDR
       23       23              CALL: DDK$GETADDR(ITEM, BIGVAL, SVALUE, SIZE, INDXX, POINTER,
       24       24                       EXPR_VAL, EXPR_OP, ADDR_TYPE, ARRAY_FLAG, SFLAG) ALTRET(ADDRERR)
       25       25             INTERFACE: CALLS DDS$UD_SRCH, DDK$GETVAL
       26       26             INPUT: S_D.DESC$ POINTS TO WORD 0 OF DATA DESCRIPTOR.
       27       27             OUTPUT: ITEM   STRUC(36) - WORD 1 OF DESCRIPTOR
       28       28                     BIGVAL SBIN - VALUE IF ADDR_TYPE = BIGXXX_ACODE
       29       29                     SVALUE SBIN - UDEF VALUE IF ADDR_TYPE = UDEF_ACODE
       30       30                     SIZE   SBIN - SIZE IN BITS OF ITEM (FROM SIZE_ICODE ENTRY)
       31       31                     INDXX  SBIN - BIT OFFSET TO BE ADDED IF ARRAY_FLAG SET
       32       32                     POINTER SBIN - POINTER TO BE USED IF ADDR_TYPE = BASED_ACODE
       33       33                     EXPR_VAL SBIN - VALUE FOR EXPRESSION MODIFICATION IF
       34       34                                     EXPR_OP > 0
       35       35                     EXPR_OP SBIN - 0 NO ADDRESS MODIFICATION
       36       36                                    1 ADD EXPR_VAL TO TRUNCATED WORD OFFSET
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:17   
       37       37                                    2 SUBTR EXPR_VAL FROM TRUNCATED WORD OFFSET
       38       38                                    3 LEFT SHFT EXPR_VAL TO TRUNCATED WORD OFFSET
       39       39                                    4 RIGHT SHFT EXPR_VAL TO TRUNCATED WORD AFFSET
       40       40                    ADDR_TYPE SBIN - ADDRESS TYPE FOR THIS ITEM
       41       41                    ARRAY_FLAG BIT(1) - SET IF ITEM NEEDS INDEX OFSET ADDED
       42       42                    SFLAG BIT(1) - SET IF ITEM.ADR.W OF ITEM NEEDS SIGN EXTENSION
       43       43                                                     */
       44       44        DDK$GETADDR: PROC(ITEM, SVALUE, SIZE, INDXX, POINTER, EXPR_VAL,

     44  1 000000   000000 700200 xent  DDK$GETADDR  TSX0  ! X66_AUTO_N
         1 000001   000176 000011                    ZERO    126,9

       45       45               EXPR_OP, ADDR_TYPE, ARRAY_FLAG) ALTRET;
       46       46          /* PARMS */
       47       47    1   DCL 1 PUP,
       48       48    1         2 SIZE UBIN(22) UNAL,
       49       49    1         2 SCALE SBIN(8) UNAL,
       50       50    1         2 PUB UBIN(2) UNAL,
       51       51    1         2 SIGNPOS UBIN(2) UNAL,
       52       52    1         2 SIGNTYP BIT(1),
       53       53    1         2 SIGNOVER BIT(1);
       54       54    1   DCL SVALUE SBIN;
       55       55    1   DCL SIZE SBIN;
       56       56    1   DCL INDXX SBIN;
       57       57    1   DCL FUDGE UBIN;                    /* FUDGE FACTOR FOR PACKED DECIMAL ARRAYS */
       58       58    1   DCL POINTER SBIN;
       59       59    1   DCL EXPR_VAL SBIN;
       60       60    1   DCL EXPR_OP SBIN;
       61       61    1   DCL ADDR_TYPE SBIN;
       62       62    1   DCL ARRAY_FLAG BIT(1) UNAL;
       63       63          /* LOCAL TMEPS */
       64       64    1   DCL TPOINTER UBIN;
       65       65    1   DCL 1 POINTR REDEF TPOINTER,
       66       66    1         2 ADR,
       67       67    1           3 W UBIN(18) UNAL,
       68       68    1           3 C UBIN(2) UNAL,
       69       69    1           3 B UBIN(4) UNAL,
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:18   
       70       70    1         2 SEG UBIN(2) UNAL,
       71       71    1         2 DESC# UBIN(10) UNAL;
       72       72    1   DCL 1 PSDITEM REDEF TPOINTER,
       73       73    1         2 TYPE UBIN(6) UNAL,
       74       74    1         2 ID UBIN(9) UNAL,
       75       75    1         2 DISP UBIN(9) UNAL,
       76       76    1         2 SEGID UBIN(12) UNAL;
       77       77    1   DCL TEMP SBIN;
       78       78    1   DCL CVALUE CHAR(63) DALIGNED;
       79       79    1   DCL 1 VAL REDEF CVALUE,
       80       80    1         2 WRD UBIN,
       81       81    1         2 * CHAR(60);
       82       82    1   DCL VALUE SBIN;
       83       83    1   DCL 1 PVALUE REDEF VALUE,
       84       84    1         2 * UBIN(24) UNAL,
       85       85    1         2 SFIELD UBIN(2) UNAL,
       86       86    1         2 * UBIN(10) UNAL;
       87       87    1   DCL EIS UBIN;
       88       88    1   DCL PNTR(0:10) SBIN;
       89       89    1   DCL PLEVEL SBIN;
       90       90    1   DCL 1 INDX(0:10),
       91       91    1         2 ADR UBIN,
       92       92    1         2 MULT UBIN,
       93       93    1         2 OFS SBIN,
       94       94    1         2 ELMNTSIZ SBIN;
       95       95    1   DCL ILEVEL SBIN;
       96       96    1   DCL TYPE_CODE SBIN;
       97       97    1   DCL ITEM$ PTR;
       98       98    1   DCL NEXT$ PTR;
       99       99    1   DCL MULT$ PTR;
      100      100    1   DCL MULT SBIN;
      101      101    1   DCL FIRST BIT(1);
      102      102    1   DCL DSIZE SBIN;
      103      103    1   DCL RSIZE SBIN;
      104      104    1   DCL TATYP SBIN;
      105      105    1   DCL IATYP SBIN;
      106      106    1   DCL IIATYP SBIN;
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:19   
      107      107    1   DCL PITEM$ PTR;
      108      108    1   DCL PPITEM$ PTR;
      109      109    1   DCL SDSIZE SBIN;
      110      110    1   DCL TPNTR SBIN;
      111      111    1   DCL SYM$ PTR;
      112      112             %INCLUDE DD_EIS_C;
      113      138    1   DCL MVN(0:2) UBIN CONSTANT INIT(4, 5, 6); /* MVNU_EIS, MVNL_EIS, MVNT_EIS */
      114      139    1   DCL UMVN(0:2) UBIN CONSTANT INIT(15, 16, 17); /* UMVNU_EIS, UMVNL_EIS, UMVNT_EIS */
      115      140    1   DCL BASED_FLAG BIT(1);
      116      141          /* MISC */
      117      142    1   DCL D_XDELTA BIT(1) SYMREF;
      118      143    1   DCL 1 TEXTC BASED,
      119      144    1         2 SZ UBIN(9) UNAL,
      120      145    1         2 * CHAR(1);
      121      146    1   DCL UBIN36 UBIN BASED;
      122      147             %INCLUDE DD$DITEM;
       12+     250             %LIST;
       13+     251    1        DCL SDD$ PTR;
       14+     252    1        DCL ZITEM$ PTR;
       15+     253    1        DCL SDD_L6$ PTR;
       16+     254    1        DCL ZITEM_L6$ PTR;
      123      828             %ZITEM;
      124      900             %DITEM;
      125      980             %DITEM (NAME=ITEM, STCLASS=PARAM);
      126     1060             %MITEM;
      127     1108             %INCLUDE XUH_MACRO_C;
      128     1192             %INCLUDE DD_SD_M;
      129     2528             %S_D;
      130     3846             %INCLUDE DD_ERR_C;
      131     4243          /* EXTERNAL ROUTINES */
      132     4244    1   DCL DDS$UD_SRCH ENTRY(2) ALTRET;
      133     4245    1   DCL DDK$ADDEXPR ENTRY(4);
      134     4246    1   DCL DDK$GETVAL ENTRY(13) ALTRET;
      135     4247    1   DCL DDK$SEXTEND ENTRY(2);
      136     4248    1   DCL DDE$ERROR ENTRY;
      137     4249    1        TYPE_CODE = %SIZE_ICODE + 1;

PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:20   
   4249  1 000002   000012 235007                    LDA     10,DL
         1 000003   200133 755100                    STA     TYPE_CODE,,AUTO

      138     4250    1        PLEVEL = 0;

   4250  1 000004   200055 450100                    STZ     PLEVEL,,AUTO

      139     4251    1        PNTR(0) = BITBIN('6000'O);

   4251  1 000005   006000 236007                    LDQ     3072,DL
         1 000006   200042 756100                    STQ     PNTR,,AUTO

      140     4252    1        INDX.ADR(0) = 0;

   4252  1 000007   200056 450100                    STZ     INDX,,AUTO

      141     4253    1        ILEVEL = 0;

   4253  1 000010   200132 450100                    STZ     ILEVEL,,AUTO

      142     4254    1        EXPR_OP = 0;

   4254  1 000011   200011 470500                    LDP0    @EXPR_OP,,AUTO
         1 000012   000000 450100                    STZ     0,,PR0

      143     4255    1        ZITEM$ = S_D.DESC$;

   4255  1 000013   000000 471400 xsym               LDP1    S_D$
         1 000014   100041 236100                    LDQ     33,,PR1
         1 000015   200155 756100                    STQ     ZITEM$,,AUTO

      144     4256    1        ITEM$ = PINCRW(S_D.DESC$, SIZEW(ZITEM)); /* POINT TO FIRST ITEM */

   4256  1 000016   000015 036003                    ADLQ    13,DU
         1 000017   200134 756100                    STQ     ITEM$,,AUTO

      145     4257                                                /**/
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:21   
      146     4258    2        DO WHILE( TYPE_CODE ~= %SIZE_ICODE);

   4258  1 000020   000011 115007                    CMPA    9,DL
         1 000021   001312 600000 1                  TZE     s:4514

      147     4259                                                /**/
      148     4260    2             ITEM = ITEM$ -> DITEM;

   4260  1 000022   200134 470500                    LDP0    ITEM$,,AUTO
         1 000023   200003 471500                    LDP1    @ITEM,,AUTO
         1 000024   000100 100500                    MLR     fill='000'O
         1 000025   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12
         1 000026   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

      149     4261    2             ARRAY_FLAG = ITEM$ -> DITEM.FLAGS.AFLAG;

   4261  1 000027   200013 473500                    LDP3    @ARRAY_FLAG,,AUTO
         1 000030   003100 060500                    CSL     bolr='003'O
         1 000031   000000 210001                    BDSC    0,,PR0                   by=1,bit=1,n=1
         1 000032   300000 000001                    BDSC    0,,PR3                   by=0,bit=0,n=1

      150     4262    2             TYPE_CODE = ITEM$ -> DITEM.TYPE_CODE;

   4262  1 000033   000000 236100                    LDQ     0,,PR0
         1 000034   000777 376007                    ANQ     511,DL
         1 000035   200133 756100                    STQ     TYPE_CODE,,AUTO

      151     4263    2             IF TYPE_CODE = %SIZE_ICODE

   4263  1 000036   000011 116007                    CMPQ    9,DL
         1 000037   000047 601000 1                  TNZ     s:4268

      152     4264    3             THEN DO;

      153     4265    3                  ADDR_TYPE = ZITEM.ADDR_TYPE;

   4265  1 000040   200155 474500                    LDP4    ZITEM$,,AUTO
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:22   
         1 000041   400006 236100                    LDQ     6,,PR4
         1 000042   000022 772000                    QRL     18
         1 000043   000777 376007                    ANQ     511,DL
         1 000044   200012 475500                    LDP5    @ADDR_TYPE,,AUTO
         1 000045   500000 756100                    STQ     0,,PR5

      154     4266    3                END;

   4266  1 000046   000054 710000 1                  TRA     s:4270

      155     4267    3             ELSE DO;

      156     4268    3                  ADDR_TYPE = ITEM$ -> DITEM.ADDR_TYPE;

   4268  1 000047   000000 236100                    LDQ     0,,PR0
         1 000050   000011 772000                    QRL     9
         1 000051   000777 376007                    ANQ     511,DL
         1 000052   200012 474500                    LDP4    @ADDR_TYPE,,AUTO
         1 000053   400000 756100                    STQ     0,,PR4

      157     4269    3                END;

      158     4270    2             NEXT$ = PINCRW(ITEM$, SIZEW(DITEM));

   4270  1 000054   200134 236100                    LDQ     ITEM$,,AUTO
         1 000055   000003 036003                    ADLQ    3,DU
         1 000056   200135 756100                    STQ     NEXT$,,AUTO

      159     4271    2             IF ADDR_TYPE = %BASED_ACODE

   4271  1 000057   200012 474500                    LDP4    @ADDR_TYPE,,AUTO
         1 000060   400000 235100                    LDA     0,,PR4
         1 000061   000002 115007                    CMPA    2,DL
         1 000062   000067 600000 1                  TZE     s:4274
         1 000063   000004 115007                    CMPA    4,DL
         1 000064   000067 600000 1                  TZE     s:4274
         1 000065   000103 115007                    CMPA    67,DL
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:23   
         1 000066   000072 601000 1                  TNZ     s:4275

      160     4272    2               OR ADDR_TYPE = %PARM_ACODE
      161     4273    2               OR ADDR_TYPE = %BIGBASED_ACODE
      162     4274    2             THEN BASED_FLAG = '1'B;

   4274  1 000067   400000 236003                    LDQ     -131072,DU
         1 000070   200153 756100                    STQ     BASED_FLAG,,AUTO
         1 000071   000073 710000 1                  TRA     s:4277

      163     4275    2             ELSE BASED_FLAG = '0'B;

   4275  1 000072   200153 450100                    STZ     BASED_FLAG,,AUTO

      164     4276                                                /**/
      165     4277    3             DO CASE (TYPE_CODE );

   4277  1 000073   200133 236100                    LDQ     TYPE_CODE,,AUTO
         1 000074   000012 116007                    CMPQ    10,DL
         1 000075   000077 602006 1                  TNC     s:4277+4,QL
         1 000076   000111 710000 1                  TRA     s:4280
         1 000077   000111 710000 1                  TRA     s:4280
         1 000100   000565 710000 1                  TRA     s:4397
         1 000101   000120 710000 1                  TRA     s:4287
         1 000102   000410 710000 1                  TRA     s:4353
         1 000103   000430 710000 1                  TRA     s:4364
         1 000104   000111 710000 1                  TRA     s:4280
         1 000105   000111 710000 1                  TRA     s:4280
         1 000106   000111 710000 1                  TRA     s:4280
         1 000107   001060 710000 1                  TRA     s:4476
         1 000110   001071 710000 1                  TRA     s:4482

      166     4278                                                /**/
      167     4279    3               CASE(ELSE);

      168     4280    3                  S_D.ERROR = 502;    /* E@DELBUG */

PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:24   
   4280  1 000111   000766 235007                    LDA     502,DL
         1 000112   000000 475400 xsym               LDP5    S_D$
         1 000113   500013 755100                    STA     11,,PR5

      169     4281    3                  CALL DDE$ERROR;

   4281  1 000114   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000115   000000 701000 xent               TSX1    DDE$ERROR
         1 000116   000000 011000                    NOP     0

      170     4282    3                  ALTRETURN;

   4282  1 000117   000000 702200 xent               TSX2  ! X66_AALT

      171     4283                                                /*
      172     4284           SIDX_ICODE
      173     4285                                                */
      174     4286    3               CASE( %SIDX_ICODE );

      175     4287    3                  MULT$ = NEXT$;

   4287  1 000120   200135 236100                    LDQ     NEXT$,,AUTO
         1 000121   200136 756100                    STQ     MULT$,,AUTO

      176     4288    3                  NEXT$ = PINCRW(NEXT$, SIZEW(MITEM));

   4288  1 000122   000004 036003                    ADLQ    4,DU
         1 000123   200135 756100                    STQ     NEXT$,,AUTO

      177     4289    3                  FIRST = ~ MULT$ -> MITEM.CONT;

   4289  1 000124   200136 475500                    LDP5    MULT$,,AUTO
         1 000125   500000 236100                    LDQ     0,,PR5
         1 000126   000003 736000                    QLS     3
         1 000127   400000 376003                    ANQ     -131072,DU
         1 000130   400000 676003                    ERQ     -131072,DU
         1 000131   200140 756100                    STQ     FIRST,,AUTO
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:25   

      178     4290    3   FIRST_LIDX:
      179     4291    3                  PUP = ITEM$ -> DITEM.PUP;

   4291  1 000132   200134 470500       FIRST_LIDX   LDP0    ITEM$,,AUTO
         1 000133   000002 236100                    LDQ     2,,PR0
         1 000134   200014 756100                    STQ     PUP,,AUTO

      180     4292    3                  DSIZE = PUP.SIZE;

   4292  1 000135   200014 236100                    LDQ     PUP,,AUTO
         1 000136   000016 772000                    QRL     14
         1 000137   200141 756100                    STQ     DSIZE,,AUTO

      181     4293    4                  DO CASE(PUP.PUB);

   4293  1 000140   200014 236100                    LDQ     PUP,,AUTO
         1 000141   000004 772000                    QRL     4
         1 000142   000003 376007                    ANQ     3,DL
         1 000143   000003 116007                    CMPQ    3,DL
         1 000144   000146 602006 1                  TNC     s:4293+6,QL
         1 000145   000177 710000 1                  TRA     s:4305
         1 000146   000151 710000 1                  TRA     s:4295
         1 000147   000155 710000 1                  TRA     s:4298
         1 000150   000165 710000 1                  TRA     s:4301

      182     4294    4                    CASE(0);               /* binary value */

      183     4295    4                       RSIZE = 36;

   4295  1 000151   000044 235007                    LDA     36,DL
         1 000152   200142 755100                    STA     RSIZE,,AUTO

      184     4296    4                       EIS = 0;

   4296  1 000153   200041 450100                    STZ     EIS,,AUTO
         1 000154   000177 710000 1                  TRA     s:4305
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:26   

      185     4297    4                    CASE(1);               /* packed decimal */

      186     4298    4                       RSIZE = 63;

   4298  1 000155   000077 235007                    LDA     63,DL
         1 000156   200142 755100                    STA     RSIZE,,AUTO

      187     4299    4                       EIS = MVN(PUP.SIGNPOS);

   4299  1 000157   200014 236100                    LDQ     PUP,,AUTO
         1 000160   000002 772000                    QRL     2
         1 000161   000003 376007                    ANQ     3,DL
         1 000162   000000 235006 0                  LDA     MVN,QL
         1 000163   200041 755100                    STA     EIS,,AUTO
         1 000164   000177 710000 1                  TRA     s:4305

      188     4300    4                    CASE(2);               /* unpacked decimal */

      189     4301    4                       RSIZE = 63;

   4301  1 000165   000077 235007                    LDA     63,DL
         1 000166   200142 755100                    STA     RSIZE,,AUTO

      190     4302    4                       EIS = UMVN(PUP.SIGNPOS);

   4302  1 000167   200014 236100                    LDQ     PUP,,AUTO
         1 000170   000002 772000                    QRL     2
         1 000171   000003 376007                    ANQ     3,DL
         1 000172   000003 235006 0                  LDA     UMVN,QL
         1 000173   200041 755100                    STA     EIS,,AUTO

      191     4303    4                       DSIZE = DSIZE / 9;

   4303  1 000174   200141 236100                    LDQ     DSIZE,,AUTO
         1 000175   000011 506007                    DIV     9,DL
         1 000176   200141 756100                    STQ     DSIZE,,AUTO
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:27   

      192     4304    4                    END;                   /* DO CASE(PUP.PUB) */

      193     4305    3                  CALL DDK$GETVAL(ADDR(CVALUE), ITEM, SVALUE, DSIZE, RSIZE,

   4305  1 000177   200020 631500                    EPPR1   CVALUE,,AUTO
         1 000200   200160 451500                    STP1    ZITEM$+3,,AUTO
         1 000201   200041 633500                    EPPR3   EIS,,AUTO
         1 000202   200175 453500                    STP3    ZITEM$+16,,AUTO
         1 000203   000001 236000 2                  LDQ     1
         1 000204   200174 756100                    STQ     ZITEM$+15,,AUTO
         1 000205   200012 237100                    LDAQ    @ADDR_TYPE,,AUTO
         1 000206   200172 757100                    STAQ    ZITEM$+13,,AUTO
         1 000207   200010 237100                    LDAQ    @EXPR_VAL,,AUTO
         1 000210   200170 757100                    STAQ    ZITEM$+11,,AUTO
         1 000211   200055 720100                    LXL0    PLEVEL,,AUTO
         1 000212   200042 634510                    EPPR4   PNTR,X0,AUTO
         1 000213   200167 454500                    STP4    ZITEM$+10,,AUTO
         1 000214   200132 235100                    LDA     ILEVEL,,AUTO
         1 000215   000002 735000                    ALS     2
         1 000216   200056 635505                    EPPR5   INDX,AL,AUTO
         1 000217   200166 455500                    STP5    ZITEM$+9,,AUTO
         1 000220   200142 636500                    EPPR6   RSIZE,,AUTO
         1 000221   200165 456500                    STP6    ZITEM$+8,,AUTO
         1 000222   200141 637500                    EPPR7   DSIZE,,AUTO
         1 000223   200164 457500                    STP7    ZITEM$+7,,AUTO
         1 000224   200004 236100                    LDQ     @SVALUE,,AUTO
         1 000225   200003 235100                    LDA     @ITEM,,AUTO
         1 000226   200162 757100                    STAQ    ZITEM$+5,,AUTO
         1 000227   200160 630500                    EPPR0   ZITEM$+3,,AUTO
         1 000230   200161 450500                    STP0    ZITEM$+4,,AUTO
         1 000231   200161 630500                    EPPR0   ZITEM$+4,,AUTO
         1 000232   000000 631400 2                  EPPR1   0
         1 000233   000000 701000 xent               TSX1    DDK$GETVAL
         1 000234   001321 702000 1                  TSX2    ADDRERR

      194     4306    3                    INDX.ADR(ILEVEL), PNTR(PLEVEL), EXPR_VAL, EXPR_OP,
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:28   
      195     4307    3                    ADDR_TYPE, ARRAY_FLAG, '0'B, EIS) ALTRET(ADDRERR);
      196     4308    3                  S_D.ACCESS = '1'B;

   4308  1 000235   400000 236003                    LDQ     -131072,DU
         1 000236   000000 470400 xsym               LDP0    S_D$
         1 000237   000016 756100                    STQ     14,,PR0

      197     4309    3                  REMEMBER TRAP_RTN IN S_D.REM_ACCESS;

   4309  1 000240   001325 635000 1                  EAA     TRAP_RTN
         1 000241   000024 452500                    STP2    20,,PR0
         1 000242   000025 755100                    STA     21,,PR0

      198     4310    3                  IF PUP.PUB ~= 0

   4310  1 000243   200014 236100                    LDQ     PUP,,AUTO
         1 000244   000060 316007                    CANQ    48,DL
         1 000245   000252 600000 1                  TZE     s:4312

      199     4311    3                  THEN CALL XCHARBIN(VALUE, CVALUE);

   4311  1 000246   000100 305500                    DTB
         1 000247   200020 010077                    NDSC9   CVALUE,,AUTO             cn=0,s=lsgns,sf=0,n=63
         1 000250   200040 000004                    NDSC9   VALUE,,AUTO              cn=0,s=lsgnf,sf=0,n=4
         1 000251   000254 710000 1                  TRA     s:4313

      200     4312    3                  ELSE VALUE = VAL.WRD;

   4312  1 000252   200020 235100                    LDA     CVALUE,,AUTO
         1 000253   200040 755100                    STA     VALUE,,AUTO

      201     4313    3                  S_D.ACCESS = '0'B;

   4313  1 000254   000016 450100                    STZ     14,,PR0

      202     4314    3   NOTFIRST_LIDX:
      203     4315    3                  IF ARRAY_FLAG
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:29   

   4315  1 000255   200013 470500       NOTFIRST_LI* LDP0    @ARRAY_FLAG,,AUTO
         1 000256   000000 066500                    CMPB    filb='0'B
         1 000257   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         1 000260   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 000261   000264 600000 1                  TZE     s:4317

      204     4316    3                  THEN ILEVEL = ILEVEL - 1;

   4316  1 000262   000001 336007                    LCQ     1,DL
         1 000263   200132 056100                    ASQ     ILEVEL,,AUTO

      205     4317    3                  IF BASED_FLAG

   4317  1 000264   200153 234100                    SZN     BASED_FLAG,,AUTO
         1 000265   000270 605000 1                  TPL     s:4319

      206     4318    3                  THEN PLEVEL = PLEVEL - 1;

   4318  1 000266   000001 336007                    LCQ     1,DL
         1 000267   200055 056100                    ASQ     PLEVEL,,AUTO

      207     4319    3                  IF TYPE_CODE = %LIDX_ICODE

   4319  1 000270   200133 235100                    LDA     TYPE_CODE,,AUTO
         1 000271   000003 115007                    CMPA    3,DL
         1 000272   000300 601000 1                  TNZ     s:4322
         1 000273   000000 471400 xsym               LDP1    S_D$
         1 000274   100715 234100                    SZN     461,,PR1
         1 000275   000300 605000 1                  TPL     s:4322

      208     4320    3                    AND S_D.ARRAY.FIRST
      209     4321    3                  THEN S_D.ARRAY.CUR = VALUE;

   4321  1 000276   200040 236100                    LDQ     VALUE,,AUTO
         1 000277   100716 756100                    STQ     462,,PR1

PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:30   
      210     4322    3                  IF FIRST

   4322  1 000300   200140 234100                    SZN     FIRST,,AUTO
         1 000301   000317 605000 1                  TPL     s:4334

      211     4323    4                  THEN DO;

      212     4324    4                       ILEVEL = ILEVEL + 1;

   4324  1 000302   200132 054100                    AOS     ILEVEL,,AUTO

      213     4325    4                       IF ILEVEL > 10

   4325  1 000303   200132 236100                    LDQ     ILEVEL,,AUTO
         1 000304   000012 116007                    CMPQ    10,DL
         1 000305   000312 604400 1                  TMOZ    s:4330

      214     4326    5                       THEN DO;

      215     4327    5                            S_D.ERROR = 37; /* E@EXPR2CMPLX */

   4327  1 000306   000045 235007                    LDA     37,DL
         1 000307   000000 471400 xsym               LDP1    S_D$
         1 000310   100013 755100                    STA     11,,PR1

      216     4328    5                            ALTRETURN;

   4328  1 000311   000000 702200 xent               TSX2  ! X66_AALT

      217     4329    5                          END;
      218     4330    4                       INDX.ADR(ILEVEL) = 0;

   4330  1 000312   200132 235100                    LDA     ILEVEL,,AUTO
         1 000313   000002 735000                    ALS     2
         1 000314   200056 450105                    STZ     INDX,AL,AUTO

      219     4331    4                       INDX.MULT(ILEVEL) = 0;
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:31   

   4331  1 000315   200057 450105                    STZ     INDX+1,AL,AUTO

      220     4332    4                       INDX.OFS(ILEVEL) = 0;

   4332  1 000316   200060 450105                    STZ     INDX+2,AL,AUTO

      221     4333    4                     END;

      222     4334    3                  IF MULT$ -> MITEM.NEWOFF

   4334  1 000317   200136 471500                    LDP1    MULT$,,AUTO
         1 000320   100000 236100                    LDQ     0,,PR1
         1 000321   100000 316003                    CANQ    32768,DU
         1 000322   000343 600000 1                  TZE     s:4342

      223     4335    4                  THEN DO;

      224     4336    4                       INDX.ADR(ILEVEL) = INDX.ADR(ILEVEL) +

   4336  1 000323   200132 235100                    LDA     ILEVEL,,AUTO
         1 000324   000002 735000                    ALS     2
         1 000325   200057 236105                    LDQ     INDX+1,AL,AUTO
         1 000326   200060 136105                    SBLQ    INDX+2,AL,AUTO
         1 000327   000000 620005                    EAX0    0,AL
         1 000330   200061 402105                    MPY     INDX+3,AL,AUTO
         1 000331   200056 036110                    ADLQ    INDX,X0,AUTO
         1 000332   200056 756110                    STQ     INDX,X0,AUTO

      225     4337    4                        (INDX.MULT(ILEVEL) - INDX.OFS(ILEVEL)) * INDX.ELMNTSIZ(ILEVEL)
              4337                                  ;
      226     4338    4                       INDX.OFS(ILEVEL) = MULT$ -> MITEM.OFS;

   4338  1 000333   100002 235100                    LDA     2,,PR1
         1 000334   200060 755110                    STA     INDX+2,X0,AUTO

      227     4339    4                       INDX.ELMNTSIZ(ILEVEL) = MULT$ -> MITEM.ELMNTSIZ;
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:32   

   4339  1 000335   100003 235100                    LDA     3,,PR1
         1 000336   200061 755110                    STA     INDX+3,X0,AUTO

      228     4340    4                       INDX.MULT(ILEVEL) = MULT$ -> MITEM.MULT * VALUE;

   4340  1 000337   100001 236100                    LDQ     1,,PR1
         1 000340   200040 402100                    MPY     VALUE,,AUTO
         1 000341   200057 756110                    STQ     INDX+1,X0,AUTO

      229     4341    4                     END;

   4341  1 000342   000354 710000 1                  TRA     CHKLAST

      230     4342    3                  ELSE INDX.MULT(ILEVEL) = INDX.MULT(ILEVEL) + MULT$ -> MITEM.MULT *
              4342                           VALUE;

   4342  1 000343   200132 235100                    LDA     ILEVEL,,AUTO
         1 000344   000002 735000                    ALS     2
         1 000345   100001 236100                    LDQ     1,,PR1
         1 000346   000000 620005                    EAX0    0,AL
         1 000347   200040 402100                    MPY     VALUE,,AUTO
         1 000350   200132 235100                    LDA     ILEVEL,,AUTO
         1 000351   000002 735000                    ALS     2
         1 000352   200057 036105                    ADLQ    INDX+1,AL,AUTO
         1 000353   200057 756110                    STQ     INDX+1,X0,AUTO

   4342  1 000354                       CHKLAST      null
      231     4343    3   CHKLAST:       ;
      232     4344    3                  IF ITEM$ -> DITEM.FLAGS.LFLAG

   4344  1 000354   200134 470500                    LDP0    ITEM$,,AUTO
         1 000355   000000 236100                    LDQ     0,,PR0
         1 000356   000100 316003                    CANQ    64,DU
         1 000357   000370 600000 1                  TZE     s:4347

      233     4345    3                  THEN INDX.ADR(ILEVEL) = INDX.ADR(ILEVEL) +
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:33   

   4345  1 000360   200132 235100                    LDA     ILEVEL,,AUTO
         1 000361   000002 735000                    ALS     2
         1 000362   200057 236105                    LDQ     INDX+1,AL,AUTO
         1 000363   200060 136105                    SBLQ    INDX+2,AL,AUTO
         1 000364   000000 620005                    EAX0    0,AL
         1 000365   200061 402105                    MPY     INDX+3,AL,AUTO
         1 000366   200056 036110                    ADLQ    INDX,X0,AUTO
         1 000367   200056 756110                    STQ     INDX,X0,AUTO

      234     4346    3                        (INDX.MULT(ILEVEL) - INDX.OFS(ILEVEL)) * INDX.ELMNTSIZ(ILEVEL)
              4346                                  ;
      235     4347    3                  FUDGE = (MOD(INDX.ELMNTSIZ(ILEVEL),9)/4) *

   4347  1 000370   200132 235100                    LDA     ILEVEL,,AUTO
         1 000371   000002 735000                    ALS     2
         1 000372   200061 236105                    LDQ     INDX+3,AL,AUTO
         1 000373   000011 506007                    DIV     9,DL
         1 000374   000044 733000                    LRS     36
         1 000375   000004 506007                    DIV     4,DL
         1 000376   200132 235100                    LDA     ILEVEL,,AUTO
         1 000377   000002 735000                    ALS     2
         1 000400   200160 756100                    STQ     ZITEM$+3,,AUTO
         1 000401   200057 236105                    LDQ     INDX+1,AL,AUTO
         1 000402   200060 136105                    SBLQ    INDX+2,AL,AUTO
         1 000403   000001 036007                    ADLQ    1,DL
         1 000404   000002 506007                    DIV     2,DL
         1 000405   200160 402100                    MPY     ZITEM$+3,,AUTO
         1 000406   200015 756100                    STQ     FUDGE,,AUTO
         1 000407   001305 710000 1                  TRA     GET_NEXT

      236     4348    3                    ((INDX.MULT(ILEVEL) - INDX.OFS(ILEVEL)+1)/2);
      237     4349                                                /*
      238     4350           LIDX_ICODE
      239     4351                                                */
      240     4352    3               CASE( %LIDX_ICODE );

PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:34   
      241     4353    3                  MULT$ = NEXT$;

   4353  1 000410   200135 236100                    LDQ     NEXT$,,AUTO
         1 000411   200136 756100                    STQ     MULT$,,AUTO

      242     4354    3                  NEXT$ = PINCRW(NEXT$, SIZEW(MITEM));

   4354  1 000412   000004 036003                    ADLQ    4,DU
         1 000413   200135 756100                    STQ     NEXT$,,AUTO

      243     4355    3                  FIRST = ~ MULT$ -> MITEM.CONT;

   4355  1 000414   200136 475500                    LDP5    MULT$,,AUTO
         1 000415   500000 236100                    LDQ     0,,PR5
         1 000416   000003 736000                    QLS     3
         1 000417   400000 376003                    ANQ     -131072,DU
         1 000420   400000 676003                    ERQ     -131072,DU
         1 000421   200140 756100                    STQ     FIRST,,AUTO

      244     4356    3                  IF S_D.ARRAY.FIRST

   4356  1 000422   000000 476400 xsym               LDP6    S_D$
         1 000423   600715 234100                    SZN     461,,PR6
         1 000424   000132 604000 1                  TMI     FIRST_LIDX

      245     4357    3                  THEN GOTO FIRST_LIDX;
      246     4358    3                  VALUE = S_D.ARRAY.CUR;

   4358  1 000425   600716 235100                    LDA     462,,PR6
         1 000426   200040 755100                    STA     VALUE,,AUTO

      247     4359    3                  GOTO NOTFIRST_LIDX;

   4359  1 000427   000255 710000 1                  TRA     NOTFIRST_LIDX

      248     4360                                                /*
      249     4361          UIDX_CODE
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:35   
      250     4362                                                */
      251     4363    3               CASE( %UIDX_ICODE );

      252     4364    3                  IF S_D.ARRAY.FIRST

   4364  1 000430   000000 475400 xsym               LDP5    S_D$
         1 000431   500715 234100                    SZN     461,,PR5
         1 000432   000551 605000 1                  TPL     s:4388

      253     4365    4                  THEN DO;

      254     4366    4                       PUP = ITEM$ -> DITEM.PUP;

   4366  1 000433   000002 236100                    LDQ     2,,PR0
         1 000434   200014 756100                    STQ     PUP,,AUTO

      255     4367    4                       DSIZE = PUP.SIZE;

   4367  1 000435   200014 236100                    LDQ     PUP,,AUTO
         1 000436   000016 772000                    QRL     14
         1 000437   200141 756100                    STQ     DSIZE,,AUTO

      256     4368    4                       S_D.ARRAY.FIRST = '0'B;

   4368  1 000440   500715 450100                    STZ     461,,PR5

      257     4369    5                       DO CASE(PUP.PUB);

   4369  1 000441   200014 236100                    LDQ     PUP,,AUTO
         1 000442   000004 772000                    QRL     4
         1 000443   000003 376007                    ANQ     3,DL
         1 000444   000003 116007                    CMPQ    3,DL
         1 000445   000447 602006 1                  TNC     s:4369+6,QL
         1 000446   000500 710000 1                  TRA     s:4381
         1 000447   000452 710000 1                  TRA     s:4371
         1 000450   000456 710000 1                  TRA     s:4374
         1 000451   000466 710000 1                  TRA     s:4377
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:36   

      258     4370    5                         CASE(0);          /* binary */

      259     4371    5                            RSIZE = 36;

   4371  1 000452   000044 235007                    LDA     36,DL
         1 000453   200142 755100                    STA     RSIZE,,AUTO

      260     4372    5                            EIS=0;

   4372  1 000454   200041 450100                    STZ     EIS,,AUTO
         1 000455   000500 710000 1                  TRA     s:4381

      261     4373    5                         CASE(1);          /* packed decimal */

      262     4374    5                            RSIZE = 63;

   4374  1 000456   000077 235007                    LDA     63,DL
         1 000457   200142 755100                    STA     RSIZE,,AUTO

      263     4375    5                            EIS = MVN(PUP.SIGNPOS);

   4375  1 000460   200014 236100                    LDQ     PUP,,AUTO
         1 000461   000002 772000                    QRL     2
         1 000462   000003 376007                    ANQ     3,DL
         1 000463   000000 235006 0                  LDA     MVN,QL
         1 000464   200041 755100                    STA     EIS,,AUTO
         1 000465   000500 710000 1                  TRA     s:4381

      264     4376    5                         CASE(2);          /* unpacked decimal */

      265     4377    5                            RSIZE = 63;

   4377  1 000466   000077 235007                    LDA     63,DL
         1 000467   200142 755100                    STA     RSIZE,,AUTO

      266     4378    5                            EIS = UMVN(PUP.SIGNPOS);
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:37   

   4378  1 000470   200014 236100                    LDQ     PUP,,AUTO
         1 000471   000002 772000                    QRL     2
         1 000472   000003 376007                    ANQ     3,DL
         1 000473   000003 235006 0                  LDA     UMVN,QL
         1 000474   200041 755100                    STA     EIS,,AUTO

      267     4379    5                            DSIZE = DSIZE / 9;

   4379  1 000475   200141 236100                    LDQ     DSIZE,,AUTO
         1 000476   000011 506007                    DIV     9,DL
         1 000477   200141 756100                    STQ     DSIZE,,AUTO

      268     4380    5                         END;              /* DO CASE(PUP.PUB) */

      269     4381    4                       CALL DDK$GETVAL(ADDR(CVALUE), ITEM, SVALUE,

   4381  1 000500   200020 636500                    EPPR6   CVALUE,,AUTO
         1 000501   200160 456500                    STP6    ZITEM$+3,,AUTO
         1 000502   200041 637500                    EPPR7   EIS,,AUTO
         1 000503   200175 457500                    STP7    ZITEM$+16,,AUTO
         1 000504   000001 236000 2                  LDQ     1
         1 000505   200174 756100                    STQ     ZITEM$+15,,AUTO
         1 000506   200012 237100                    LDAQ    @ADDR_TYPE,,AUTO
         1 000507   200172 757100                    STAQ    ZITEM$+13,,AUTO
         1 000510   200010 237100                    LDAQ    @EXPR_VAL,,AUTO
         1 000511   200170 757100                    STAQ    ZITEM$+11,,AUTO
         1 000512   200055 720100                    LXL0    PLEVEL,,AUTO
         1 000513   200042 630510                    EPPR0   PNTR,X0,AUTO
         1 000514   200167 450500                    STP0    ZITEM$+10,,AUTO
         1 000515   200132 235100                    LDA     ILEVEL,,AUTO
         1 000516   000002 735000                    ALS     2
         1 000517   200056 630505                    EPPR0   INDX,AL,AUTO
         1 000520   200166 450500                    STP0    ZITEM$+9,,AUTO
         1 000521   200142 630500                    EPPR0   RSIZE,,AUTO
         1 000522   200165 450500                    STP0    ZITEM$+8,,AUTO
         1 000523   200141 630500                    EPPR0   DSIZE,,AUTO
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:38   
         1 000524   200164 450500                    STP0    ZITEM$+7,,AUTO
         1 000525   200004 236100                    LDQ     @SVALUE,,AUTO
         1 000526   200003 235100                    LDA     @ITEM,,AUTO
         1 000527   200162 757100                    STAQ    ZITEM$+5,,AUTO
         1 000530   200160 630500                    EPPR0   ZITEM$+3,,AUTO
         1 000531   200161 450500                    STP0    ZITEM$+4,,AUTO
         1 000532   200161 630500                    EPPR0   ZITEM$+4,,AUTO
         1 000533   000000 631400 2                  EPPR1   0
         1 000534   000000 701000 xent               TSX1    DDK$GETVAL
         1 000535   001321 702000 1                  TSX2    ADDRERR

      270     4382    4                         DSIZE, RSIZE, INDX.ADR(ILEVEL), PNTR(PLEVEL), EXPR_VAL,
      271     4383    4                         EXPR_OP, ADDR_TYPE, ARRAY_FLAG, '0'B ,EIS) ALTRET(ADDRERR);
      272     4384    4                       IF PUP.PUB ~= 0

   4384  1 000536   200014 236100                    LDQ     PUP,,AUTO
         1 000537   000060 316007                    CANQ    48,DL
         1 000540   000546 600000 1                  TZE     s:4386

      273     4385    4                       THEN CALL XCHARBIN(S_D.ARRAY.HIGH, CVALUE);

   4385  1 000541   000000 470400 xsym               LDP0    S_D$
         1 000542   000100 305500                    DTB
         1 000543   200020 010077                    NDSC9   CVALUE,,AUTO             cn=0,s=lsgns,sf=0,n=63
         1 000544   000717 000004                    NDSC9   463,,PR0                 cn=0,s=lsgnf,sf=0,n=4
         1 000545   000551 710000 1                  TRA     s:4388

      274     4386    4                       ELSE S_D.ARRAY.HIGH = VAL.WRD;

   4386  1 000546   200020 235100                    LDA     CVALUE,,AUTO
         1 000547   000000 470400 xsym               LDP0    S_D$
         1 000550   000717 755100                    STA     463,,PR0

      275     4387    4                     END;

      276     4388    3                  IF ARRAY_FLAG

PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:39   
   4388  1 000551   200013 470500                    LDP0    @ARRAY_FLAG,,AUTO
         1 000552   000000 066500                    CMPB    filb='0'B
         1 000553   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         1 000554   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 000555   000560 600000 1                  TZE     s:4390

      277     4389    3                  THEN ILEVEL = ILEVEL - 1;

   4389  1 000556   000001 336007                    LCQ     1,DL
         1 000557   200132 056100                    ASQ     ILEVEL,,AUTO

      278     4390    3                  IF BASED_FLAG

   4390  1 000560   200153 234100                    SZN     BASED_FLAG,,AUTO
         1 000561   000564 605000 1                  TPL     s:4392

      279     4391    3                  THEN PLEVEL = PLEVEL - 1;

   4391  1 000562   000001 336007                    LCQ     1,DL
         1 000563   200055 056100                    ASQ     PLEVEL,,AUTO

      280     4392    3                  GOTO CHKLAST;

   4392  1 000564   000354 710000 1                  TRA     CHKLAST

      281     4393                                                /*
      282     4394          PTR_ICODE
      283     4395                                                */
      284     4396    3               CASE( %PTR_ICODE );

      285     4397    3                  TPOINTER = PNTR( PLEVEL );

   4397  1 000565   200055 720100                    LXL0    PLEVEL,,AUTO
         1 000566   200042 235110                    LDA     PNTR,X0,AUTO
         1 000567   200016 755100                    STA     TPOINTER,,AUTO

      286     4398    3                  IF ADDR_TYPE = %SPEC_ACODE
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:40   

   4398  1 000570   400000 235100                    LDA     0,,PR4
         1 000571   000101 115007                    CMPA    65,DL
         1 000572   000646 601000 1                  TNZ     s:4415

      287     4399    4                  THEN DO;

      288     4400    5                       DO CASE (ITEM.SP.VS.ID);

   4400  1 000573   100001 236100                    LDQ     1,,PR1
         1 000574   000033 772000                    QRL     27
         1 000575   000034 116007                    CMPQ    28,DL
         1 000576   000600 602006 1                  TNC     s:4400+5,QL
         1 000577   000646 710000 1                  TRA     s:4415
         1 000600   000642 710000 1                  TRA     s:4408
         1 000601   000646 710000 1                  TRA     s:4415
         1 000602   000646 710000 1                  TRA     s:4415
         1 000603   000646 710000 1                  TRA     s:4415
         1 000604   000634 710000 1                  TRA     s:4402
         1 000605   000646 710000 1                  TRA     s:4415
         1 000606   000646 710000 1                  TRA     s:4415
         1 000607   000646 710000 1                  TRA     s:4415
         1 000610   000646 710000 1                  TRA     s:4415
         1 000611   000646 710000 1                  TRA     s:4415
         1 000612   000646 710000 1                  TRA     s:4415
         1 000613   000646 710000 1                  TRA     s:4415
         1 000614   000646 710000 1                  TRA     s:4415
         1 000615   000646 710000 1                  TRA     s:4415
         1 000616   000646 710000 1                  TRA     s:4415
         1 000617   000646 710000 1                  TRA     s:4415
         1 000620   000646 710000 1                  TRA     s:4415
         1 000621   000646 710000 1                  TRA     s:4415
         1 000622   000646 710000 1                  TRA     s:4415
         1 000623   000646 710000 1                  TRA     s:4415
         1 000624   000646 710000 1                  TRA     s:4415
         1 000625   000646 710000 1                  TRA     s:4415
         1 000626   000646 710000 1                  TRA     s:4415
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:41   
         1 000627   000646 710000 1                  TRA     s:4415
         1 000630   000646 710000 1                  TRA     s:4415
         1 000631   000646 710000 1                  TRA     s:4415
         1 000632   000634 710000 1                  TRA     s:4402
         1 000633   000634 710000 1                  TRA     s:4402

      289     4401    5                         CASE (%IOBUFSZ_RTN, %WSR_RTN, %WSQ_RTN);

      290     4402    5                            IF NOT D_XDELTA

   4402  1 000634   000000 234000 xsym               SZN     D_XDELTA
         1 000635   000646 604000 1                  TMI     s:4415

      291     4403    6                            THEN DO;

      292     4404    6                                 S_D.ERROR = 111; /* E@XDONLYSYM */

   4404  1 000636   000157 235007                    LDA     111,DL
         1 000637   000000 475400 xsym               LDP5    S_D$
         1 000640   500013 755100                    STA     11,,PR5

      293     4405    6                                 ALTRETURN;

   4405  1 000641   000000 702200 xent               TSX2  ! X66_AALT

      294     4406    6                               END;
      295     4407    5                         CASE (%O_RTN);

      296     4408    5                            RSIZE = 36;

   4408  1 000642   000044 235007                    LDA     36,DL
         1 000643   200142 755100                    STA     RSIZE,,AUTO

      297     4409    5                            DSIZE = 36;

   4409  1 000644   200141 755100                    STA     DSIZE,,AUTO

PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:42   
      298     4410    5                            GOTO GET_NEXT; /* $O SKIP TO END.... */

   4410  1 000645   001305 710000 1                  TRA     GET_NEXT

      299     4411    5                         CASE (ELSE);

      300     4412    5                            ;
      301     4413    5                         END;

      302     4414    4                     END;

      303     4415    3                  IF ADDR_TYPE = %DESC_ACODE AND

   4415  1 000646   000100 115007                    CMPA    64,DL
         1 000647   000662 601000 1                  TNZ     s:4421
         1 000650   100001 236100                    LDQ     1,,PR1
         1 000651   770000 376003                    ANQ     -4096,DU
         1 000652   100000 116003                    CMPQ    32768,DU
         1 000653   000656 600000 1                  TZE     s:4418
         1 000654   110000 116003                    CMPQ    36864,DU
         1 000655   000662 601000 1                  TNZ     s:4421

      304     4416    3                    (ITEM.SP.VD.TYPE = 8 OR ITEM.SP.VD.TYPE = 9)
      305     4417    4                  THEN DO;

      306     4418    4                       S_D.ERROR = 304; /* E@SYMNOTHOST */

   4418  1 000656   000460 235007                    LDA     304,DL
         1 000657   000000 475400 xsym               LDP5    S_D$
         1 000660   500013 755100                    STA     11,,PR5

      307     4419    4                       ALTRETURN;

   4419  1 000661   000000 702200 xent               TSX2  ! X66_AALT

      308     4420    4                     END;
      309     4421    3                  IF POINTR.SEG = 1
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:43   

   4421  1 000662   200016 236100                    LDQ     TPOINTER,,AUTO
         1 000663   006000 376007                    ANQ     3072,DL
         1 000664   002000 116007                    CMPQ    1024,DL
         1 000665   000761 601000 1                  TNZ     s:4455

      310     4422    4                  THEN DO;

      311     4423    5                       DO CASE (PSDITEM.TYPE);

   4423  1 000666   200016 236100                    LDQ     TPOINTER,,AUTO
         1 000667   000036 772000                    QRL     30
         1 000670   000012 116007                    CMPQ    10,DL
         1 000671   000673 602006 1                  TNC     s:4423+5,QL
         1 000672   000761 710000 1                  TRA     s:4455
         1 000673   000705 710000 1                  TRA     s:4425
         1 000674   000761 710000 1                  TRA     s:4455
         1 000675   000761 710000 1                  TRA     s:4455
         1 000676   000761 710000 1                  TRA     s:4455
         1 000677   000761 710000 1                  TRA     s:4455
         1 000700   000761 710000 1                  TRA     s:4455
         1 000701   000761 710000 1                  TRA     s:4455
         1 000702   000761 710000 1                  TRA     s:4455
         1 000703   000750 710000 1                  TRA     s:4446
         1 000704   000750 710000 1                  TRA     s:4446

      312     4424    5                         CASE (0);

      313     4425    6                            DO CASE (PSDITEM.ID);

   4425  1 000705   200016 236100                    LDQ     TPOINTER,,AUTO
         1 000706   000025 772000                    QRL     21
         1 000707   000777 376007                    ANQ     511,DL
         1 000710   000012 116007                    CMPQ    10,DL
         1 000711   000713 602006 1                  TNC     s:4425+6,QL
         1 000712   000761 710000 1                  TRA     s:4455
         1 000713   000747 710000 1                  TRA     s:4444
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:44   
         1 000714   000747 710000 1                  TRA     s:4444
         1 000715   000747 710000 1                  TRA     s:4444
         1 000716   000725 710000 1                  TRA     s:4427
         1 000717   000747 710000 1                  TRA     s:4444
         1 000720   000733 710000 1                  TRA     s:4433
         1 000721   000733 710000 1                  TRA     s:4433
         1 000722   000733 710000 1                  TRA     s:4433
         1 000723   000741 710000 1                  TRA     s:4439
         1 000724   000733 710000 1                  TRA     s:4433

      314     4426    6                              CASE (3);    /* $TCB */

      315     4427    6                                 IF D_XDELTA

   4427  1 000725   000000 234000 xsym               SZN     D_XDELTA
         1 000726   000761 605000 1                  TPL     s:4455

      316     4428    7                                 THEN DO;

      317     4429    7                                      S_D.ERROR = 113; /* E@UDONLYSYM */

   4429  1 000727   000161 235007                    LDA     113,DL
         1 000730   000000 475400 xsym               LDP5    S_D$
         1 000731   500013 755100                    STA     11,,PR5

      318     4430    7                                      ALTRETURN;

   4430  1 000732   000000 702200 xent               TSX2  ! X66_AALT

      319     4431    7                                    END;
      320     4432    6                              CASE (5, 6, 7, 9); /* $RVB, $USD, $ERR, $CGn */

      321     4433    6                                 IF NOT S_D.ANLZ_FILE

   4433  1 000733   000000 475400 xsym               LDP5    S_D$
         1 000734   505052 234100                    SZN     2602,,PR5
         1 000735   000761 604000 1                  TMI     s:4455
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:45   

      322     4434    7                                 THEN DO;

      323     4435    7                                      S_D.ERROR = 182; /* E@NOTANLZ_FILE */

   4435  1 000736   000266 235007                    LDA     182,DL
         1 000737   500013 755100                    STA     11,,PR5

      324     4436    7                                      ALTRETURN;

   4436  1 000740   000000 702200 xent               TSX2  ! X66_AALT

      325     4437    7                                    END;
      326     4438    6                              CASE (8);    /* $HEAD */

      327     4439    6                                 IF NOT S_D.RUM

   4439  1 000741   000000 475400 xsym               LDP5    S_D$
         1 000742   504755 234100                    SZN     2541,,PR5
         1 000743   000761 604000 1                  TMI     s:4455

      328     4440    7                                 THEN DO;

      329     4441    7                                      S_D.ERROR = 202; /* E@RUMONLY */

   4441  1 000744   000312 235007                    LDA     202,DL
         1 000745   500013 755100                    STA     11,,PR5

      330     4442    7                                      ALTRETURN;

   4442  1 000746   000000 702200 xent               TSX2  ! X66_AALT

      331     4443    7                                    END;
      332     4444    6                              END;         /* DO CASE (PSDITEM.ID)  */

   4444  1 000747   000761 710000 1                  TRA     s:4455

PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:46   
      333     4445    5                         CASE(8,9);        /* $ROSEG, $RDBR, $TSA, $Bn */

      334     4446    5                            IF S_D.RUM

   4446  1 000750   000000 475400 xsym               LDP5    S_D$
         1 000751   504755 234100                    SZN     2541,,PR5
         1 000752   000756 605000 1                  TPL     s:4448

      335     4447    5                            THEN S_D.ERROR = 232; /* E@NOSSRUM */

   4447  1 000753   000350 235007                    LDA     232,DL
         1 000754   500013 755100                    STA     11,,PR5
         1 000755   000760 710000 1                  TRA     s:4449

      336     4448    5                            ELSE S_D.ERROR = 304; /* E@SYMNOTHOST */

   4448  1 000756   000460 235007                    LDA     304,DL
         1 000757   500013 755100                    STA     11,,PR5

      337     4449    5                            ALTRETURN;

   4449  1 000760   000000 702200 xent               TSX2  ! X66_AALT

      338     4450    5                         CASE (ELSE);

      339     4451    5                            ;
      340     4452    5                         END;              /* DO CASE (PSDITEM.TYPE) */

      341     4453
      342     4454    4                     END;

      343     4455    3                  RSIZE = 36;

   4455  1 000761   000044 236007                    LDQ     36,DL
         1 000762   200142 756100                    STQ     RSIZE,,AUTO

      344     4456    3                  DSIZE = 36;
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:47   

   4456  1 000763   200141 756100                    STQ     DSIZE,,AUTO

      345     4457    3                  CALL DDK$GETVAL(ADDR(CVALUE), ITEM, SVALUE, DSIZE,

   4457  1 000764   200020 635500                    EPPR5   CVALUE,,AUTO
         1 000765   200160 455500                    STP5    ZITEM$+3,,AUTO
         1 000766   000001 236000 2                  LDQ     1
         1 000767   200013 235100                    LDA     @ARRAY_FLAG,,AUTO
         1 000770   200174 757100                    STAQ    ZITEM$+15,,AUTO
         1 000771   200012 236100                    LDQ     @ADDR_TYPE,,AUTO
         1 000772   200011 235100                    LDA     @EXPR_OP,,AUTO
         1 000773   200172 757100                    STAQ    ZITEM$+13,,AUTO
         1 000774   200010 236100                    LDQ     @EXPR_VAL,,AUTO
         1 000775   200171 756100                    STQ     ZITEM$+12,,AUTO
         1 000776   200042 636510                    EPPR6   PNTR,X0,AUTO
         1 000777   200170 456500                    STP6    ZITEM$+11,,AUTO
         1 001000   200132 235100                    LDA     ILEVEL,,AUTO
         1 001001   000002 735000                    ALS     2
         1 001002   200056 637505                    EPPR7   INDX,AL,AUTO
         1 001003   200167 457500                    STP7    ZITEM$+10,,AUTO
         1 001004   200142 630500                    EPPR0   RSIZE,,AUTO
         1 001005   200166 450500                    STP0    ZITEM$+9,,AUTO
         1 001006   200141 630500                    EPPR0   DSIZE,,AUTO
         1 001007   200165 450500                    STP0    ZITEM$+8,,AUTO
         1 001010   200004 236100                    LDQ     @SVALUE,,AUTO
         1 001011   200164 756100                    STQ     ZITEM$+7,,AUTO
         1 001012   200003 236100                    LDQ     @ITEM,,AUTO
         1 001013   200163 756100                    STQ     ZITEM$+6,,AUTO
         1 001014   200160 630500                    EPPR0   ZITEM$+3,,AUTO
         1 001015   200162 450500                    STP0    ZITEM$+5,,AUTO
         1 001016   200162 630500                    EPPR0   ZITEM$+5,,AUTO
         1 001017   000002 631400 2                  EPPR1   2
         1 001020   000000 701000 xent               TSX1    DDK$GETVAL
         1 001021   001321 702000 1                  TSX2    ADDRERR

      346     4458    3                    RSIZE, INDX(ILEVEL), PNTR(PLEVEL), EXPR_VAL,
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:48   
      347     4459    3                    EXPR_OP, ADDR_TYPE, ARRAY_FLAG, '0'B) ALTRET(ADDRERR);
      348     4460    3                  VALUE = VAL.WRD;

   4460  1 001022   200020 235100                    LDA     CVALUE,,AUTO
         1 001023   200040 755100                    STA     VALUE,,AUTO

      349     4461    3                  IF ARRAY_FLAG

   4461  1 001024   200013 470500                    LDP0    @ARRAY_FLAG,,AUTO
         1 001025   000000 066500                    CMPB    filb='0'B
         1 001026   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         1 001027   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 001030   001033 600000 1                  TZE     s:4463

      350     4462    3                  THEN ILEVEL = ILEVEL - 1;

   4462  1 001031   000001 336007                    LCQ     1,DL
         1 001032   200132 056100                    ASQ     ILEVEL,,AUTO

      351     4463    3                  IF BASED_FLAG

   4463  1 001033   200153 234100                    SZN     BASED_FLAG,,AUTO
         1 001034   001037 605000 1                  TPL     s:4466

      352     4464    3                  THEN PLEVEL = PLEVEL - 1;

   4464  1 001035   000001 336007                    LCQ     1,DL
         1 001036   200055 056100                    ASQ     PLEVEL,,AUTO

      353     4465                                      /* CANT ALLOW GARBAGE PTR TO HAVE S-FIELD = 1  */
      354     4466    3                  IF ADDR_TYPE ~= %DESC_ACODE

   4466  1 001037   200012 471500                    LDP1    @ADDR_TYPE,,AUTO
         1 001040   100000 235100                    LDA     0,,PR1
         1 001041   000100 115007                    CMPA    64,DL
         1 001042   001053 600000 1                  TZE     s:4470
         1 001043   000101 115007                    CMPA    65,DL
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:49   
         1 001044   001053 600000 1                  TZE     s:4470

      355     4467    3                    AND ADDR_TYPE ~= %SPEC_ACODE
      356     4468    3                  THEN IF PVALUE.SFIELD = 1

   4468  1 001045   200040 236100                    LDQ     VALUE,,AUTO
         1 001046   006000 376007                    ANQ     3072,DL
         1 001047   002000 116007                    CMPQ    1024,DL
         1 001050   001053 601000 1                  TNZ     s:4470

      357     4469    3                       THEN PVALUE.SFIELD = 3;

   4469  1 001051   006000 236007                    LDQ     3072,DL
         1 001052   200040 256100                    ORSQ    VALUE,,AUTO

      358     4470    3                  PLEVEL = PLEVEL + 1;

   4470  1 001053   200055 054100                    AOS     PLEVEL,,AUTO

      359     4471    3                  PNTR(PLEVEL) = VALUE;

   4471  1 001054   200055 720100                    LXL0    PLEVEL,,AUTO
         1 001055   200040 236100                    LDQ     VALUE,,AUTO
         1 001056   200042 756110                    STQ     PNTR,X0,AUTO
         1 001057   001305 710000 1                  TRA     GET_NEXT

      360     4472                                                /*
      361     4473          EXP_ICODE
      362     4474                                                */
      363     4475    3               CASE( %EXP_ICODE );

      364     4476    3                  EXPR_OP = ITEM$ -> DITEM.FLAGS.EXPOP; /* RESET BY DDK$ADDREXP */

   4476  1 001060   000000 236100                    LDQ     0,,PR0
         1 001061   000022 772000                    QRL     18
         1 001062   000017 376007                    ANQ     15,DL
         1 001063   200011 475500                    LDP5    @EXPR_OP,,AUTO
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:50   
         1 001064   500000 756100                    STQ     0,,PR5

      365     4477    3                  EXPR_VAL = ITEM$ -> DITEM.VALUE;

   4477  1 001065   000001 235100                    LDA     1,,PR0
         1 001066   200010 476500                    LDP6    @EXPR_VAL,,AUTO
         1 001067   600000 755100                    STA     0,,PR6
         1 001070   001305 710000 1                  TRA     GET_NEXT

      366     4478                                                /*
      367     4479          SIZE_ICODE
      368     4480                                                */
      369     4481    3               CASE( %SIZE_ICODE );

      370     4482    3                  TATYP = ITEM.ADDR_TYPE; /* Pick up address type of size of item */

   4482  1 001071   100000 236100                    LDQ     0,,PR1
         1 001072   000011 772000                    QRL     9
         1 001073   000777 376007                    ANQ     511,DL
         1 001074   200143 756100                    STQ     TATYP,,AUTO

      371     4483    3                  IF TATYP = %PARM_ACODE

   4483  1 001075   000004 116007                    CMPQ    4,DL
         1 001076   001203 601000 1                  TNZ     s:4500

      372     4484    4                  THEN DO;                 /* Size of item is based */

      373     4485    4                       PITEM$ = NEXT$;

   4485  1 001077   200135 236100                    LDQ     NEXT$,,AUTO
         1 001100   200146 756100                    STQ     PITEM$,,AUTO

      374     4486    4                       NEXT$ = PINCRW(NEXT$, SIZEW(DITEM));

   4486  1 001101   000003 036003                    ADLQ    3,DU
         1 001102   200135 756100                    STQ     NEXT$,,AUTO
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:51   

      375     4487    4                       IATYP = PITEM$ -> DITEM.ADDR_TYPE;

   4487  1 001103   200146 475500                    LDP5    PITEM$,,AUTO
         1 001104   500000 236100                    LDQ     0,,PR5
         1 001105   000011 772000                    QRL     9
         1 001106   000777 376007                    ANQ     511,DL
         1 001107   200144 756100                    STQ     IATYP,,AUTO

      376     4488    4                       IF IATYP = %BASED_ACODE

   4488  1 001110   000002 116007                    CMPQ    2,DL
         1 001111   001152 601000 1                  TNZ     s:4496

      377     4489    5                       THEN DO;            /* Implied ptr is based */

      378     4490    5                            PPITEM$ = NEXT$;

   4490  1 001112   200135 236100                    LDQ     NEXT$,,AUTO
         1 001113   200147 756100                    STQ     PPITEM$,,AUTO

      379     4491    5                            NEXT$ = PINCRW(NEXT$, SIZEW(DITEM));

   4491  1 001114   000003 036003                    ADLQ    3,DU
         1 001115   200135 756100                    STQ     NEXT$,,AUTO

      380     4492    5                            IIATYP = PPITEM$ -> DITEM.ADDR_TYPE;

   4492  1 001116   200147 476500                    LDP6    PPITEM$,,AUTO
         1 001117   600000 236100                    LDQ     0,,PR6
         1 001120   000011 772000                    QRL     9
         1 001121   000777 376007                    ANQ     511,DL
         1 001122   200145 756100                    STQ     IIATYP,,AUTO

      381     4493    5                            CALL DDK$GETVAL(ADDR(TPNTR), PPITEM$ -> DITEM, SVALUE, 36,
              4493                                     36,

PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:52   
   4493  1 001123   200151 637500                    EPPR7   TPNTR,,AUTO
         1 001124   200160 457500                    STP7    ZITEM$+3,,AUTO
         1 001125   000004 237000 2                  LDAQ    4
         1 001126   200174 757100                    STAQ    ZITEM$+15,,AUTO
         1 001127   200145 630500                    EPPR0   IIATYP,,AUTO
         1 001130   200173 450500                    STP0    ZITEM$+14,,AUTO
         1 001131   000001 236000 2                  LDQ     1
         1 001132   200172 756100                    STQ     ZITEM$+13,,AUTO
         1 001133   000004 237000 2                  LDAQ    4
         1 001134   200170 757100                    STAQ    ZITEM$+11,,AUTO
         1 001135   000006 237000 2                  LDAQ    6
         1 001136   200166 757100                    STAQ    ZITEM$+9,,AUTO
         1 001137   000006 236000 2                  LDQ     6
         1 001140   200004 235100                    LDA     @SVALUE,,AUTO
         1 001141   200164 757100                    STAQ    ZITEM$+7,,AUTO
         1 001142   200147 236100                    LDQ     PPITEM$,,AUTO
         1 001143   200163 756100                    STQ     ZITEM$+6,,AUTO
         1 001144   200160 630500                    EPPR0   ZITEM$+3,,AUTO
         1 001145   200162 450500                    STP0    ZITEM$+5,,AUTO
         1 001146   200162 630500                    EPPR0   ZITEM$+5,,AUTO
         1 001147   000002 631400 2                  EPPR1   2
         1 001150   000000 701000 xent               TSX1    DDK$GETVAL
         1 001151   001321 702000 1                  TSX2    ADDRERR

      382     4494    5                              0, 0, 0, 0, IIATYP, '0'B, '0'B) ALTRET(ADDRERR);
      383     4495    5                          END;

      384     4496    4                      CALL DDK$GETVAL(ADDR(TPNTR), PITEM$ -> DITEM, SVALUE, 36, 36, 0,

   4496  1 001152   200151 630500                    EPPR0   TPNTR,,AUTO
         1 001153   200160 450500                    STP0    ZITEM$+3,,AUTO
         1 001154   000004 237000 2                  LDAQ    4
         1 001155   200174 757100                    STAQ    ZITEM$+15,,AUTO
         1 001156   200144 631500                    EPPR1   IATYP,,AUTO
         1 001157   200173 451500                    STP1    ZITEM$+14,,AUTO
         1 001160   000001 236000 2                  LDQ     1
         1 001161   200172 756100                    STQ     ZITEM$+13,,AUTO
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:53   
         1 001162   200171 756100                    STQ     ZITEM$+12,,AUTO
         1 001163   200151 633500                    EPPR3   TPNTR,,AUTO
         1 001164   200170 453500                    STP3    ZITEM$+11,,AUTO
         1 001165   000006 237000 2                  LDAQ    6
         1 001166   200166 757100                    STAQ    ZITEM$+9,,AUTO
         1 001167   000006 236000 2                  LDQ     6
         1 001170   200004 235100                    LDA     @SVALUE,,AUTO
         1 001171   200164 757100                    STAQ    ZITEM$+7,,AUTO
         1 001172   200146 236100                    LDQ     PITEM$,,AUTO
         1 001173   200163 756100                    STQ     ZITEM$+6,,AUTO
         1 001174   200160 634500                    EPPR4   ZITEM$+3,,AUTO
         1 001175   200162 454500                    STP4    ZITEM$+5,,AUTO
         1 001176   200162 630500                    EPPR0   ZITEM$+5,,AUTO
         1 001177   000002 631400 2                  EPPR1   2
         1 001200   000000 701000 xent               TSX1    DDK$GETVAL
         1 001201   001321 702000 1                  TSX2    ADDRERR

      385     4497    4                         TPNTR, 0, 0, IATYP, '0'B, '0'B) ALTRET(ADDRERR);
      386     4498    4                     END;

   4498  1 001202   001206 710000 1                  TRA     s:4502

      387     4499    4                  ELSE DO;
              4499                           /* In case it's based, use same pointer as for actual item */

      388     4500    4                       TPNTR = PNTR(PLEVEL);

   4500  1 001203   200055 720100                    LXL0    PLEVEL,,AUTO
         1 001204   200042 235110                    LDA     PNTR,X0,AUTO
         1 001205   200151 755100                    STA     TPNTR,,AUTO

      389     4501    4                     END;

      390     4502    3                  SDSIZE = ITEM.PUP.SIZE;

   4502  1 001206   200003 470500                    LDP0    @ITEM,,AUTO
         1 001207   000002 236100                    LDQ     2,,PR0
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:54   
         1 001210   000016 772000                    QRL     14
         1 001211   200150 756100                    STQ     SDSIZE,,AUTO

      391     4503    3                  CALL DDK$GETVAL(ADDR(SIZE), ITEM, SVALUE, SDSIZE, 36, 0, TPNTR,

   4503  1 001212   200005 236100                    LDQ     @SIZE,,AUTO
         1 001213   200160 756100                    STQ     ZITEM$+3,,AUTO
         1 001214   000004 237000 2                  LDAQ    4
         1 001215   200174 757100                    STAQ    ZITEM$+15,,AUTO
         1 001216   200143 631500                    EPPR1   TATYP,,AUTO
         1 001217   200173 451500                    STP1    ZITEM$+14,,AUTO
         1 001220   000001 236000 2                  LDQ     1
         1 001221   200172 756100                    STQ     ZITEM$+13,,AUTO
         1 001222   200171 756100                    STQ     ZITEM$+12,,AUTO
         1 001223   200151 633500                    EPPR3   TPNTR,,AUTO
         1 001224   200170 453500                    STP3    ZITEM$+11,,AUTO
         1 001225   000006 237000 2                  LDAQ    6
         1 001226   200166 757100                    STAQ    ZITEM$+9,,AUTO
         1 001227   200150 634500                    EPPR4   SDSIZE,,AUTO
         1 001230   200165 454500                    STP4    ZITEM$+8,,AUTO
         1 001231   200004 236100                    LDQ     @SVALUE,,AUTO
         1 001232   200164 756100                    STQ     ZITEM$+7,,AUTO
         1 001233   200003 236100                    LDQ     @ITEM,,AUTO
         1 001234   200163 756100                    STQ     ZITEM$+6,,AUTO
         1 001235   200160 635500                    EPPR5   ZITEM$+3,,AUTO
         1 001236   200162 455500                    STP5    ZITEM$+5,,AUTO
         1 001237   200162 630500                    EPPR0   ZITEM$+5,,AUTO
         1 001240   000002 631400 2                  EPPR1   2
         1 001241   000000 701000 xent               TSX1    DDK$GETVAL
         1 001242   001321 702000 1                  TSX2    ADDRERR

      392     4504    3                    0, 0, TATYP, '0'B, '0'B) ALTRET(ADDRERR);
      393     4505    3                  SIZE = SIZE * ITEM.SMULT;

   4505  1 001243   200005 470500                    LDP0    @SIZE,,AUTO
         1 001244   200003 471500                    LDP1    @ITEM,,AUTO
         1 001245   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:55   
         1 001246   000033 772000                    QRL     27
         1 001247   000000 402100                    MPY     0,,PR0
         1 001250   000000 756100                    STQ     0,,PR0

      394     4506    3                  ITEM = PINCRW(ZITEM$, POFFW(ADDR(ZITEM.ADDR_TYPE), ADDR(ZITEM))) ->
              4506                           DITEM;

   4506  1 001251   200155 236100                    LDQ     ZITEM$,,AUTO
         1 001252   000022 772000                    QRL     18
         1 001253   200160 756100                    STQ     ZITEM$+3,,AUTO
         1 001254   200155 236100                    LDQ     ZITEM$,,AUTO
         1 001255   000010 036000 2                  ADLQ    8
         1 001256   000022 772000                    QRL     18
         1 001257   200160 136100                    SBLQ    ZITEM$+3,,AUTO
         1 001260   000002 736000                    QLS     2
         1 001261   200155 473500                    LDP3    ZITEM$,,AUTO
         1 001262   000100 100506                    MLR     fill='000'O
         1 001263   300000 000014                    ADSC9   0,Q,PR3                  cn=0,n=12
         1 001264   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

      395     4507    3                  POINTER = PNTR(PLEVEL);

   4507  1 001265   200055 720100                    LXL0    PLEVEL,,AUTO
         1 001266   200007 474500                    LDP4    @POINTER,,AUTO
         1 001267   200042 235110                    LDA     PNTR,X0,AUTO
         1 001270   400000 755100                    STA     0,,PR4

      396     4508    3                  INDXX = INDX.ADR(ILEVEL);

   4508  1 001271   200132 236100                    LDQ     ILEVEL,,AUTO
         1 001272   000002 736000                    QLS     2
         1 001273   200056 235106                    LDA     INDX,QL,AUTO
         1 001274   200006 475500                    LDP5    @INDXX,,AUTO
         1 001275   500000 755100                    STA     0,,PR5

      397     4509    3                  IF ZITEM.PUP.BITS.PUB = 1 THEN INDXX = INDXX + FUDGE;

PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:56   
   4509  1 001276   300010 236100                    LDQ     8,,PR3
         1 001277   000060 376007                    ANQ     48,DL
         1 001300   000020 116007                    CMPQ    16,DL
         1 001301   001305 601000 1                  TNZ     GET_NEXT

   4509  1 001302   500000 236100                    LDQ     0,,PR5
         1 001303   200015 036100                    ADLQ    FUDGE,,AUTO
         1 001304   500000 756100                    STQ     0,,PR5

      398     4510    3               END;                        /* DO CASE( TYPE_CODE ) */

      399     4511    2   GET_NEXT:
      400     4512    2             ITEM$ = NEXT$;

   4512  1 001305   200135 236100       GET_NEXT     LDQ     NEXT$,,AUTO
         1 001306   200134 756100                    STQ     ITEM$,,AUTO

      401     4513    2           END;                       /* DO WHILE (TYPE_CODE ~= %SIZE_ICODE) */

   4513  1 001307   200133 235100                    LDA     TYPE_CODE,,AUTO
         1 001310   000011 115007                    CMPA    9,DL
         1 001311   000022 601000 1                  TNZ     s:4260

      402     4514    1        S_D.DESC$ = PINCRW(S_D.DESC$, ZITEM.SIZE);

   4514  1 001312   200155 470500                    LDP0    ZITEM$,,AUTO
         1 001313   000000 720100                    LXL0    0,,PR0
         1 001314   000000 471400 xsym               LDP1    S_D$
         1 001315   100041 473500                    LDP3    33,,PR1
         1 001316   300000 634510                    EPPR4   0,X0,PR3
         1 001317   100041 454500                    STP4    33,,PR1

      403     4515    1        RETURN;

   4515  1 001320   000000 702200 xent               TSX2  ! X66_ARET

      404     4516                                                /**/
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:57   
      405     4517    1   ADDRERR:
      406     4518    1        S_D.ERROR = 36;             /* E@ADDRBAD */

   4518  1 001321   000044 235007       ADDRERR      LDA     36,DL
         1 001322   000000 470400 xsym               LDP0    S_D$
         1 001323   000013 755100                    STA     11,,PR0

      407     4519    1        ALTRETURN;

   4519  1 001324   000000 702200 xent               TSX2  ! X66_AALT

      408     4520    1   TRAP_RTN:
      409     4521    1        S_D.ERROR = 234;         /* E@SUBNOTVALID */

   4521  1 001325   000352 235007       TRAP_RTN     LDA     234,DL
         1 001326   000000 470400 xsym               LDP0    S_D$
         1 001327   000013 755100                    STA     11,,PR0

      410     4522    1        S_D.ACCESS = '0'B;

   4522  1 001330   000016 450100                    STZ     14,,PR0

      411     4523    1        ALTRETURN;

   4523  1 001331   000000 702200 xent               TSX2  ! X66_AALT

MVN
 Sect OctLoc
   0     000   000000 000004   000000 000005   000000 000006                    ............

UMVN
 Sect OctLoc
   0     003   000000 000017   000000 000020   000000 000021                    ............

(unnamed)
 Sect OctLoc
   2     000   000015 000000   000002 006000   000014 000000   000000 000044    ...............$
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:58   
   2     004   000002 006000   000002 006000   000003 006000   000002 006000    ................
   2     010   000006 200000                                                    ....
      412     4524    1   END DDK$GETADDR;

PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:59   
--  Include file information  --

   DD_ERR_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   DD_EIS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDK$GETADDR.

   Procedure DDK$GETADDR requires 730 words for executable code.
   Procedure DDK$GETADDR requires 126 words of local(AUTO) storage.

    No errors detected in file DDK$GETADDR.:E05TSI    .
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:60   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:61   
          MINI XREF LISTING

ADDRERR
      4518**LABEL    4305--CALLALT  4381--CALLALT  4457--CALLALT  4493--CALLALT  4496--CALLALT  4503--CALLALT
ADDR_TYPE
        61**DCL        44--PROC     4265<<ASSIGN   4268<<ASSIGN   4271>>IF       4271>>IF       4271>>IF
      4305<>CALL     4381<>CALL     4398>>IF       4415>>IF       4457<>CALL     4466>>IF       4466>>IF
ARRAY_FLAG
        62**DCL        44--PROC     4261<<ASSIGN   4305<>CALL     4315>>IF       4381<>CALL     4388>>IF
      4457<>CALL     4461>>IF
BASED_FLAG
       140**DCL      4274<<ASSIGN   4275<<ASSIGN   4317>>IF       4390>>IF       4463>>IF
CHKLAST
      4342**LABEL    4392--GOTO
CVALUE
        78**DCL        79--REDEF    4305--CALL     4311>>CALLBLT  4381--CALL     4385>>CALLBLT  4457--CALL
DDE$ERROR
      4248**DCL-ENT  4281--CALL
DDK$GETVAL
      4246**DCL-ENT  4305--CALL     4381--CALL     4457--CALL     4493--CALL     4496--CALL     4503--CALL
DITEM
       901**DCL      4260>>ASSIGN   4270--ASSIGN   4486--ASSIGN   4491--ASSIGN   4493<>CALL     4496<>CALL
      4506>>ASSIGN
DITEM.ADDRESS
       922**DCL       927--REDEF     928--REDEF     929--REDEF
DITEM.ADDR_TYPE
       917**DCL      4268>>ASSIGN   4487>>ASSIGN   4492>>ASSIGN
DITEM.FLAGS.AFLAG
       907**DCL      4261>>ASSIGN
DITEM.FLAGS.EXPOP
       916**DCL      4476>>ASSIGN
DITEM.FLAGS.LFLAG
       912**DCL      4344>>IF
DITEM.PUP
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:62   
       954**DCL      4291>>ASSIGN   4366>>ASSIGN
DITEM.SP.VD
       930**DCL       934--REDEF     937--REDEF
DITEM.TYPE_CODE
       920**DCL      4262>>ASSIGN
DITEM.VALUE
       927**DCL      4477>>ASSIGN
DSIZE
       102**DCL      4292<<ASSIGN   4303<<ASSIGN   4303>>ASSIGN   4305<>CALL     4367<<ASSIGN   4379<<ASSIGN
      4379>>ASSIGN   4381<>CALL     4409<<ASSIGN   4456<<ASSIGN   4457<>CALL
D_XDELTA
       142**DCL      4402>>IF       4427>>IF
EIS
        87**DCL      4296<<ASSIGN   4299<<ASSIGN   4302<<ASSIGN   4305<>CALL     4372<<ASSIGN   4375<<ASSIGN
      4378<<ASSIGN   4381<>CALL
EXPR_OP
        60**DCL        44--PROC     4254<<ASSIGN   4305<>CALL     4381<>CALL     4457<>CALL     4476<<ASSIGN
EXPR_VAL
        59**DCL        44--PROC     4305<>CALL     4381<>CALL     4457<>CALL     4477<<ASSIGN
FIRST
       101**DCL      4289<<ASSIGN   4322>>IF       4355<<ASSIGN
FIRST_LIDX
      4291**LABEL    4357--GOTO
FUDGE
        57**DCL      4347<<ASSIGN   4509>>ASSIGN
GET_NEXT
      4512**LABEL    4410--GOTO
IATYP
       105**DCL      4487<<ASSIGN   4488>>IF       4496<>CALL
IIATYP
       106**DCL      4492<<ASSIGN   4493<>CALL
ILEVEL
        95**DCL      4253<<ASSIGN   4305>>CALL     4316<<ASSIGN   4316>>ASSIGN   4324<<ASSIGN   4324>>ASSIGN
      4325>>IF       4330>>ASSIGN   4331>>ASSIGN   4332>>ASSIGN   4336>>ASSIGN   4336>>ASSIGN   4336>>ASSIGN
      4336>>ASSIGN   4336>>ASSIGN   4338>>ASSIGN   4339>>ASSIGN   4340>>ASSIGN   4342>>ASSIGN   4342>>ASSIGN
      4345>>ASSIGN   4345>>ASSIGN   4345>>ASSIGN   4345>>ASSIGN   4345>>ASSIGN   4347>>ASSIGN   4347>>ASSIGN
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:63   
      4347>>ASSIGN   4381>>CALL     4389<<ASSIGN   4389>>ASSIGN   4457>>CALL     4462<<ASSIGN   4462>>ASSIGN
      4508>>ASSIGN
INDX
        90**DCL      4457<>CALL
INDX.ADR
        91**DCL      4252<<ASSIGN   4305<>CALL     4330<<ASSIGN   4336<<ASSIGN   4336>>ASSIGN   4345<<ASSIGN
      4345>>ASSIGN   4381<>CALL     4508>>ASSIGN
INDX.ELMNTSIZ
        94**DCL      4336>>ASSIGN   4339<<ASSIGN   4345>>ASSIGN   4347>>ASSIGN
INDX.MULT
        92**DCL      4331<<ASSIGN   4336>>ASSIGN   4340<<ASSIGN   4342<<ASSIGN   4342>>ASSIGN   4345>>ASSIGN
      4347>>ASSIGN
INDX.OFS
        93**DCL      4332<<ASSIGN   4336>>ASSIGN   4338<<ASSIGN   4345>>ASSIGN   4347>>ASSIGN
INDXX
        56**DCL        44--PROC     4508<<ASSIGN   4509<<ASSIGN   4509>>ASSIGN
ITEM
       981**DCL        44--PROC     4260<<ASSIGN   4305<>CALL     4381<>CALL     4457<>CALL     4503<>CALL
      4506<<ASSIGN
ITEM.ADDRESS
      1002**DCL      1007--REDEF    1008--REDEF    1009--REDEF
ITEM.ADDR_TYPE
       997**DCL      4482>>ASSIGN
ITEM.PUP.SIZE
      1035**DCL      4502>>ASSIGN
ITEM.SMULT
       982**DCL      4505>>ASSIGN
ITEM.SP.VD
      1010**DCL      1014--REDEF    1017--REDEF
ITEM.SP.VD.TYPE
      1011**DCL      4415>>IF       4415>>IF
ITEM.SP.VS.ID
      1018**DCL      4400>>DOCASE
ITEM$
        97**DCL      4256<<ASSIGN   4260>>ASSIGN   4261>>ASSIGN   4262>>ASSIGN   4268>>ASSIGN   4270>>ASSIGN
      4291>>ASSIGN   4344>>IF       4366>>ASSIGN   4476>>ASSIGN   4477>>ASSIGN   4512<<ASSIGN
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:64   
MITEM
      1061**DCL      4288--ASSIGN   4354--ASSIGN
MITEM.AMULT.ADR
      1079**DCL      1083--REDEF
MITEM.AOFS.ADR
      1094**DCL      1098--REDEF
MITEM.CONT
      1071**DCL      4289>>ASSIGN   4355>>ASSIGN
MITEM.ELMNTSIZ
      1105**DCL      4339>>ASSIGN
MITEM.MULT
      1075**DCL      1077--REDEF    4340>>ASSIGN   4342>>ASSIGN
MITEM.NEWOFF
      1068**DCL      4334>>IF
MITEM.OFS
      1090**DCL      1092--REDEF    4338>>ASSIGN
MULT$
        99**DCL      4287<<ASSIGN   4289>>ASSIGN   4334>>IF       4338>>ASSIGN   4339>>ASSIGN   4340>>ASSIGN
      4342>>ASSIGN   4353<<ASSIGN   4355>>ASSIGN
MVN
       138**DCL      4299>>ASSIGN   4375>>ASSIGN
NEXT$
        98**DCL      4270<<ASSIGN   4287>>ASSIGN   4288<<ASSIGN   4288>>ASSIGN   4353>>ASSIGN   4354<<ASSIGN
      4354>>ASSIGN   4485>>ASSIGN   4486<<ASSIGN   4486>>ASSIGN   4490>>ASSIGN   4491<<ASSIGN   4491>>ASSIGN
      4512>>ASSIGN
NOTFIRST_LIDX
      4315**LABEL    4359--GOTO
PITEM$
       107**DCL      4485<<ASSIGN   4487>>ASSIGN   4496>>CALL
PLEVEL
        89**DCL      4250<<ASSIGN   4305>>CALL     4318<<ASSIGN   4318>>ASSIGN   4381>>CALL     4391<<ASSIGN
      4391>>ASSIGN   4397>>ASSIGN   4457>>CALL     4464<<ASSIGN   4464>>ASSIGN   4470<<ASSIGN   4470>>ASSIGN
      4471>>ASSIGN   4500>>ASSIGN   4507>>ASSIGN
PNTR
        88**DCL      4251<<ASSIGN   4305<>CALL     4381<>CALL     4397>>ASSIGN   4457<>CALL     4471<<ASSIGN
      4500>>ASSIGN   4507>>ASSIGN
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:65   
POINTER
        58**DCL        44--PROC     4507<<ASSIGN
POINTR.SEG
        70**DCL      4421>>IF
PPITEM$
       108**DCL      4490<<ASSIGN   4492>>ASSIGN   4493>>CALL
PSDITEM.ID
        74**DCL      4425>>DOCASE
PSDITEM.TYPE
        73**DCL      4423>>DOCASE
PUP
        47**DCL      4291<<ASSIGN   4366<<ASSIGN
PUP.PUB
        50**DCL      4293>>DOCASE   4310>>IF       4369>>DOCASE   4384>>IF
PUP.SIGNPOS
        51**DCL      4299>>ASSIGN   4302>>ASSIGN   4375>>ASSIGN   4378>>ASSIGN
PUP.SIZE
        48**DCL      4292>>ASSIGN   4367>>ASSIGN
PVALUE.SFIELD
        85**DCL      4468>>IF       4469<<ASSIGN
RSIZE
       103**DCL      4295<<ASSIGN   4298<<ASSIGN   4301<<ASSIGN   4305<>CALL     4371<<ASSIGN   4374<<ASSIGN
      4377<<ASSIGN   4381<>CALL     4408<<ASSIGN   4455<<ASSIGN   4457<>CALL
SDD$
       251**DCL       901--IMP-PTR
SDSIZE
       109**DCL      4502<<ASSIGN   4503<>CALL
SIZE
        55**DCL        44--PROC     4503--CALL     4505<<ASSIGN   4505>>ASSIGN
SVALUE
        54**DCL        44--PROC     4305<>CALL     4381<>CALL     4457<>CALL     4493<>CALL     4496<>CALL
      4503<>CALL
S_D.ACCESS
      2567**DCL      4308<<ASSIGN   4313<<ASSIGN   4522<<ASSIGN
S_D.ANLZ_FILE
      3244**DCL      4433>>IF
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:66   
S_D.ARRAY.CUR
      2808**DCL      4321<<ASSIGN   4358>>ASSIGN
S_D.ARRAY.FIRST
      2807**DCL      4319>>IF       4356>>IF       4364>>IF       4368<<ASSIGN
S_D.ARRAY.HIGH
      2809**DCL      4385<<CALLBLT  4386<<ASSIGN
S_D.CURRENT_CHANNEL
      3480**DCL      3482--REDEF
S_D.DEBUGA
      2632**DCL      2634--REDEF
S_D.DESC$
      2612**DCL      4255>>ASSIGN   4256>>ASSIGN   4514<<ASSIGN   4514>>ASSIGN
S_D.EIS
      3590**DCL      3619--REDEF
S_D.ERROR
      2561**DCL      4280<<ASSIGN   4327<<ASSIGN   4404<<ASSIGN   4418<<ASSIGN   4429<<ASSIGN   4435<<ASSIGN
      4441<<ASSIGN   4447<<ASSIGN   4448<<ASSIGN   4518<<ASSIGN   4521<<ASSIGN
S_D.HOST_MESSAGE_BUF_REMOTE
      3523**DCL      3524--REDEF    3538--REDEF
S_D.JDE
      3137**DCL      3138--REDEF
S_D.L$.VALUE
      2690**DCL      2696--REDEF    2704--REDEF    2707--REDEF    2710--REDEF    2713--REDEF
S_D.L$.VALUE.L
      2691**DCL      2692--REDEF    2693--REDEF
S_D.L6_MESSAGE_BUF
      3544**DCL      3546--REDEF
S_D.OUTPUT
      3510**DCL      3512--REDEF
S_D.REMOTE_MSG.FNCC
      3529**DCL      3530--REDEF
S_D.REMOTE_MSG.STXC
      3525**DCL      3526--REDEF
S_D.REMOTE_MSG.SUBFNCC
      3533**DCL      3534--REDEF
S_D.REM_ACCESS
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:67   
      2575**DCL      4309<<REMEMBR
S_D.RUM
      3178**DCL      4439>>IF       4446>>IF
S_D.SV
      2589**DCL      2610--REDEF
S_D$
      3841**DCL      2537--IMP-PTR  4255>>ASSIGN   4256>>ASSIGN   4280>>ASSIGN   4308>>ASSIGN   4309>>REMEMBR
      4313>>ASSIGN   4319>>IF       4321>>ASSIGN   4327>>ASSIGN   4356>>IF       4358>>ASSIGN   4364>>IF
      4368>>ASSIGN   4385>>CALLBLT  4386>>ASSIGN   4404>>ASSIGN   4418>>ASSIGN   4429>>ASSIGN   4433>>IF
      4435>>ASSIGN   4439>>IF       4441>>ASSIGN   4446>>IF       4447>>ASSIGN   4448>>ASSIGN   4514>>ASSIGN
      4514>>ASSIGN   4518>>ASSIGN   4521>>ASSIGN   4522>>ASSIGN
TATYP
       104**DCL      4482<<ASSIGN   4483>>IF       4503<>CALL
TPNTR
       110**DCL      4493--CALL     4496--CALL     4496<>CALL     4500<<ASSIGN   4503<>CALL
TPOINTER
        64**DCL        65--REDEF      72--REDEF    4397<<ASSIGN
TRAP_RTN
      4521**LABEL    4309--REMEMBR
TYPE_CODE
        96**DCL      4249<<ASSIGN   4258>>DOWHILE  4262<<ASSIGN   4263>>IF       4277>>DOCASE   4319>>IF
UMVN
       139**DCL      4302>>ASSIGN   4378>>ASSIGN
VAL.WRD
        80**DCL      4312>>ASSIGN   4386>>ASSIGN   4460>>ASSIGN
VALUE
        82**DCL        83--REDEF    4311<<CALLBLT  4312<<ASSIGN   4321>>ASSIGN   4340>>ASSIGN   4342>>ASSIGN
      4358<<ASSIGN   4460<<ASSIGN   4471>>ASSIGN
ZITEM
       829**DCL      4256--ASSIGN   4506--ASSIGN
ZITEM.ADDRESS
       863**DCL       868--REDEF     869--REDEF     870--REDEF
ZITEM.ADDR_TYPE
       857**DCL      4265>>ASSIGN   4506--ASSIGN
ZITEM.PUP.BITS.PUB
       888**DCL      4509>>IF
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:68   
ZITEM.SIZE
       830**DCL      4514>>ASSIGN
ZITEM.SP.VD
       871**DCL       875--REDEF     878--REDEF
ZITEM$
       252**DCL       829--IMP-PTR  4255<<ASSIGN   4265>>ASSIGN   4506>>ASSIGN   4506>>ASSIGN   4506>>ASSIGN
      4509>>IF       4514>>ASSIGN
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:69   
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDK$GETADDR File=DDK$GETADDR.:E05TSI                          TUE 07/29/97 14:01 Page:70   
              MINI UREF LISTING

DDK$ADDEXPR    4245**DCL-ENT
DDK$GETADDR      44**PROC
DDK$SEXTEND    4247**DCL-ENT
DDS$UD_SRCH    4244**DCL-ENT
MULT     100**DCL
SDD_L6$     253**DCL
SYM$     111**DCL
TEMP      77**DCL
TEXTC     143**DCL
UBIN36     146**DCL
ZITEM_L6$     254**DCL
