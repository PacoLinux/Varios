VERSION E05

PL6.E3A0      #001=FRC$AVR File=FRC$AVR.:E05TSI                                  TUE 07/29/97 17:21 Page:1    
        1        1        /*M* FRC$AVR Process tape mounts and keyins  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* MCL=0,MOC,MEC,CLM=3,EXM=3,CRT=6,DMR,PLM=3,IND=3,ENU=0,DCI=3,NSO,
        8        8        CSU=3,ECU=3,THI=0,DTI=0,CRM=86 */
        9        9           /**/
       10       10           /**/
       11       11        FRC$AVR: PROC (DCTX,TYPE,SERN) ALTRET;
       12       12           /**/
       13       13           /**/
       14       14        %INCLUDE FR$RAT;
       15       67        %FR$RAT (NAME=RAT,STCLASS="BASED(RAT$)");
       16      107        %INCLUDE FR_DATA_R;
       17      139        %INCLUDE NI_DATA_R;
       18      576        %INCLUDE JG_GHOSTS_C;
       19      666        %INCLUDE OC_SUBS_C;
       20     1397        %INCLUDE FT_SUBS;
       21     1477        %INCLUDE NK_SUBS;
       22     1502        %INCLUDE FR_SUBS;
       23     1570           /**/
       24     1571        %NI$DCT (NAME=DCT,STCLASS=BASED);
       25     1619           /**/
       26     1620           /**/
       27     1621    1   DCL DCTX UBIN WORD;
       28     1622    1   DCL TYPE SBIN;
       29     1623    1   DCL SERN CHAR(6);
       30     1624    1   DCL RAT$ PTR;
       31     1625    1   DCL MSG# UBIN WORD;
       32     1626    1   DCL FT_PROT UBIN WORD SYMREF;
       33     1627    1   DCL OCI$MK_WR ENTRY(7);
       34     1628    1   DCL FRC$WAKU ENTRY(1);
       35     1629           /**/
       36     1630    1   DCL SC_AVRDCT ENTRY CONV(2,0); /* BAD DCTX FROM AVR                  */
       37     1631    1   DCL SC_AVRTYP ENTRY CONV(2,0); /* BAD TYPE FROM AVR                  */
PL6.E3A0      #001=FRC$AVR File=FRC$AVR.:E05TSI                                  TUE 07/29/97 17:21 Page:2    
       38     1632           /**/
       39     1633           /**/
       40     1634    1      RAT$=N$DCT$(DCTX);
       41     1635    1      IF RAT$=ADDR(NIL) THEN CALL SC_AVRDCT;
       42     1636    1      RAT$=RAT$->DCT.RAT$;
       43     1637    1      IF RAT$=ADDR(NIL) THEN CALL SC_AVRDCT;
       44     1638    1      FR_AVRCNT=FR_AVRCNT+1;
       45     1639    2      DO CASE(RAT.RCOD);
       46     1640    2      CASE(ELSE);
       47     1641    2         CALL SC_AVRDCT;
       48     1642           /*S*  SCREECH_CODE:  FRC-S$AVRDCT
       49     1643                 TYPE:          Screech
       50     1644                 MESSAGE:       AVR passed a bad DCT index to resource management
       51     1645                 REMARKS:       This screech occurs in any of three situations:
       52     1646                                  1. There is no DCT entry for the DCTX.
       53     1647                                  2. There is no RAT for the DCT (non-resource)
       54     1648                                  3. The resource type is not legal
       55     1649                                  4. The device does not AVR (printers,etc.)
       56     1650                                Note the use of RAT$ as the DCT pointer for one test    */
       57     1651    2      CASE(FR_MT,FR_NPOOL);
       58     1652    2         IF RAT.FLG.FORM THEN CALL SC_AVRDCT;
       59     1653    3         IF RAT.FLG.DOWN THEN DO;
       60     1654    3            MSG#=DAVR_MSG#;
       61     1655    3            GOTO MESALT;
       62     1656    3            END;
       63     1657    3         IF RAT.FLG.RUP THEN DO;
       64     1658    3   BAVU:    ;
       65     1659    3            IF RAT.FLG.MBIT.MTD OR RAT.FLG.OPN THEN MSG#=BAVU_MSG#;
       66     1660    4            ELSE DO;
       67     1661    4               MSG#=BAVR_MSG#;
       68     1662    4               RAT.REEL.ASID=JG_KEYIN#;
       69     1663    4               END;
       70     1664    3   MESALT:  ;
       71     1665    3            CALL MESSOUT;
       72     1666    3            ALTRETURN;
       73     1667    3            END;
       74     1668    2         RAT.REEL.SER=SERN;
PL6.E3A0      #001=FRC$AVR File=FRC$AVR.:E05TSI                                  TUE 07/29/97 17:21 Page:3    
       75     1669    2         RAT.FLG.RUP='1'B;
       76     1670    3         DO CASE (TYPE);
       77     1671    3         CASE (FRC_LBL#);
       78     1672    3   ALLLBLD: ;
       79     1673    3            MSG#=MNTD_MSG#;
       80     1674    3         CASE (FRC_SCR#);
       81     1675    3            RAT.FLG.MBIT.MTSC='1'B;
       82     1676    3            IF RAT.REEL.ASID=0 THEN MSG#=RQKN_MSG#;
       83     1677    3            ELSE MSG#=MNTD_MSG#;
       84     1678    3         CASE (FRC_LSCR#);
       85     1679    3            IF FT_PROT=FT_FULLPROT# THEN GOTO ALLLBLD;
       86     1680    3            IF RAT.REEL.ASID~=0 THEN MSG#=ANSC_MSG#;
       87     1681    4            ELSE DO;
       88     1682    4               RAT.REEL.ASID=JG_SLUG#;
       89     1683    4               MSG#=RQKN_MSG#;
       90     1684    4               END;
       91     1685    3            RAT.FLG.MBIT.MTSC='1'B;
       92     1686    3         CASE (ELSE);
       93     1687    3            CALL SC_AVRTYP;
       94     1688           /*S*  SCREECH_CODE:  FRC-S$AVRTYP
       95     1689                 TYPE:          Screech
       96     1690                 MESSAGE:       Unknown TAPE type passed to resource management from AVR
       97     1691                 REMARKS:       AVR calls FRC$AVR with a type code indicating
       98     1692                                whether the tape is LABELED (ANS), LABELED SCRATCH
       99     1693                                (ANSCRATCH), OR UNLABELED (SCRATCH).  This screech
      100     1694                                occurs when the type passed is none of these            */
      101     1695    3         END;
      102     1696    2         CALL MESSOUT;
      103     1697    2         CALL FRC$WAKU (RAT);
      104     1698    2         RETURN;
      105     1699    2      CASE(FR_DP);
      106     1700    3         IF TYPE>=0 THEN DO;
      107     1701    3            RAT.FLG.RUP='1'B;
      108     1702    4            IF TYPE~=0 THEN DO;
      109     1703    4               RAT.REEL.SER=SERN;
      110     1704    4               RAT.FLG.MBIT.MTSC='0'B;
      111     1705    4               CALL FRC$WAKU(RAT);
PL6.E3A0      #001=FRC$AVR File=FRC$AVR.:E05TSI                                  TUE 07/29/97 17:21 Page:4    
      112     1706    4               END;
      113     1707    4            ELSE DO;
      114     1708    4               RAT.REEL.SER=' ';
      115     1709    4               RAT.FLG.MBIT.MTSC='1'B;
      116     1710    4               END;
      117     1711    3            END;
      118     1712    3         ELSE DO;
      119     1713    3            IF RAT.FLG.MBIT.MTD THEN RETURN;
      120     1714    3            RAT.REEL='0'B;
      121     1715    3            RAT.FLG.RUP='0'B;
      122     1716    3            END;
      123     1717    2         RETURN;
      124     1718    2      END;
      125     1719           /**/
      126     1720           /**/
      127     1721    1   MESSOUT: PROC;
      128     1722           /**/
      129     1723    2      CALL OCI$MK_WR (M_TAPE,MSG#,LENGTHC(FR_AMSGL),FR_AMSGL,RAT.REEL,DCTX);
      130     1724    2      RETURN;
      131     1725    2   END;
      132     1726           /**/
      133     1727    1   END;
      134     1728           /**/
      135     1729           /**/
      136     1730        %EOD;

PL6.E3A0      #001=FRC$AVR File=FRC$AVR.:E05TSI                                  TUE 07/29/97 17:21 Page:5    
--  Include file information  --

   FR_SUBS.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   FT_SUBS.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FR_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FR$RAT.:E05TOU  is referenced.
      No diagnostics issued in procedure FRC$AVR.

   Procedure FRC$AVR requires 167 words for executable code.
   Procedure FRC$AVR requires 16 words of local(AUTO) storage.

PL6.E3A0      #001=FRC$AVR File=FRC$AVR.:E05TSI                                  TUE 07/29/97 17:21 Page:6    

 Object Unit name= FRC$AVR                                    File name= FRC$AVR.:E05TOU
 UTS= JUL 29 '97 17:21:44.20 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none   167    247  FRC$AVR
    1  RoData even  none     6      6  FRC$AVR

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        3  FRC$AVR

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 FRC$WAKU
         yes           Std       7 OCI$MK_WR
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #001=FRC$AVR File=FRC$AVR.:E05TSI                                  TUE 07/29/97 17:21 Page:7    

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     SC_AVRDCT                             SC_AVRTYP                             FR_AMSGL
     FR_AVRCNT                             N$DCT$$                               N$FQ$
     NI$FQ$                                NI$IBUF$                              NI$RP$
     FT_PROT                               B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ASLENTSID                             ISSID
PL6.E3A0      #001=FRC$AVR File=FRC$AVR.:E05TSI                                  TUE 07/29/97 17:21 Page:8    


        1        1        /*M* FRC$AVR Process tape mounts and keyins  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* MCL=0,MOC,MEC,CLM=3,EXM=3,CRT=6,DMR,PLM=3,IND=3,ENU=0,DCI=3,NSO,
        8        8        CSU=3,ECU=3,THI=0,DTI=0,CRM=86 */
        9        9           /**/
       10       10           /**/
       11       11        FRC$AVR: PROC (DCTX,TYPE,SERN) ALTRET;

     11  0 000000   000000 700200 xent  FRC$AVR      TSX0  ! X66_AUTO_3
         0 000001   000020 000003                    ZERO    16,3

       12       12           /**/
       13       13           /**/
       14       14        %INCLUDE FR$RAT;
       15       67        %FR$RAT (NAME=RAT,STCLASS="BASED(RAT$)");
       16      107        %INCLUDE FR_DATA_R;
       17      139        %INCLUDE NI_DATA_R;
       18      576        %INCLUDE JG_GHOSTS_C;
       19      666        %INCLUDE OC_SUBS_C;
       20     1397        %INCLUDE FT_SUBS;
       21     1477        %INCLUDE NK_SUBS;
       22     1502        %INCLUDE FR_SUBS;
       23     1570           /**/
       24     1571        %NI$DCT (NAME=DCT,STCLASS=BASED);
       25     1619           /**/
       26     1620           /**/
       27     1621    1   DCL DCTX UBIN WORD;
       28     1622    1   DCL TYPE SBIN;
       29     1623    1   DCL SERN CHAR(6);
       30     1624    1   DCL RAT$ PTR;
       31     1625    1   DCL MSG# UBIN WORD;
       32     1626    1   DCL FT_PROT UBIN WORD SYMREF;
PL6.E3A0      #001=FRC$AVR File=FRC$AVR.:E05TSI                                  TUE 07/29/97 17:21 Page:9    
       33     1627    1   DCL OCI$MK_WR ENTRY(7);
       34     1628    1   DCL FRC$WAKU ENTRY(1);
       35     1629           /**/
       36     1630    1   DCL SC_AVRDCT ENTRY CONV(2,0); /* BAD DCTX FROM AVR                  */
       37     1631    1   DCL SC_AVRTYP ENTRY CONV(2,0); /* BAD TYPE FROM AVR                  */
       38     1632           /**/
       39     1633           /**/
       40     1634    1      RAT$=N$DCT$(DCTX);

   1634  0 000002   200003 470500                    LDP0    @DCTX,,AUTO
         0 000003   000000 720100                    LXL0    0,,PR0
         0 000004   000000 471400 xsym               LDP1    N$DCT$$
         0 000005   100000 236110                    LDQ     0,X0,PR1
         0 000006   200006 756100                    STQ     RAT$,,AUTO

       41     1635    1      IF RAT$=ADDR(NIL) THEN CALL SC_AVRDCT;

   1635  0 000007   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000010   000013 601000 0                  TNZ     s:1636

   1635  0 000011   000000 713400 xsym               CLIMB   SC_AVRDCT
         0 000012   000000 600000 xsid               climb   nvectors=         0

       42     1636    1      RAT$=RAT$->DCT.RAT$;

   1636  0 000013   200006 470500                    LDP0    RAT$,,AUTO
         0 000014   000005 236100                    LDQ     5,,PR0
         0 000015   200006 756100                    STQ     RAT$,,AUTO

       43     1637    1      IF RAT$=ADDR(NIL) THEN CALL SC_AVRDCT;

   1637  0 000016   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000017   000022 601000 0                  TNZ     s:1638

   1637  0 000020   000000 713400 xsym               CLIMB   SC_AVRDCT
         0 000021   000000 600000 xsid               climb   nvectors=         0

PL6.E3A0      #001=FRC$AVR File=FRC$AVR.:E05TSI                                  TUE 07/29/97 17:21 Page:10   
       44     1638    1      FR_AVRCNT=FR_AVRCNT+1;

   1638  0 000022   000000 235000 xsym               LDA     FR_AVRCNT
         0 000023   000001 035007                    ADLA    1,DL
         0 000024   000000 755000 xsym               STA     FR_AVRCNT

       45     1639    2      DO CASE(RAT.RCOD);

   1639  0 000025   200006 470500                    LDP0    RAT$,,AUTO
         0 000026   000003 236100                    LDQ     3,,PR0
         0 000027   000027 772000                    QRL     23
         0 000030   000017 376007                    ANQ     15,DL
         0 000031   000003 116007                    CMPQ    3,DL
         0 000032   000034 602006 0                  TNC     s:1639+7,QL
         0 000033   000037 710000 0                  TRA     s:1641
         0 000034   000162 710000 0                  TRA     s:1700
         0 000035   000042 710000 0                  TRA     s:1652
         0 000036   000042 710000 0                  TRA     s:1652

       46     1640    2      CASE(ELSE);

       47     1641    2         CALL SC_AVRDCT;

   1641  0 000037   000000 713400 xsym               CLIMB   SC_AVRDCT
         0 000040   000000 600000 xsid               climb   nvectors=         0
         0 000041   000223 710000 0                  TRA     s:1718

       48     1642           /*S*  SCREECH_CODE:  FRC-S$AVRDCT
       49     1643                 TYPE:          Screech
       50     1644                 MESSAGE:       AVR passed a bad DCT index to resource management
       51     1645                 REMARKS:       This screech occurs in any of three situations:
       52     1646                                  1. There is no DCT entry for the DCTX.
       53     1647                                  2. There is no RAT for the DCT (non-resource)
       54     1648                                  3. The resource type is not legal
       55     1649                                  4. The device does not AVR (printers,etc.)
       56     1650                                Note the use of RAT$ as the DCT pointer for one test    */
       57     1651    2      CASE(FR_MT,FR_NPOOL);
PL6.E3A0      #001=FRC$AVR File=FRC$AVR.:E05TSI                                  TUE 07/29/97 17:21 Page:11   

       58     1652    2         IF RAT.FLG.FORM THEN CALL SC_AVRDCT;

   1652  0 000042   000010 236100                    LDQ     8,,PR0
         0 000043   000010 316007                    CANQ    8,DL
         0 000044   000047 600000 0                  TZE     s:1653

   1652  0 000045   000000 713400 xsym               CLIMB   SC_AVRDCT
         0 000046   000000 600000 xsid               climb   nvectors=         0

       59     1653    3         IF RAT.FLG.DOWN THEN DO;

   1653  0 000047   200006 470500                    LDP0    RAT$,,AUTO
         0 000050   000010 236100                    LDQ     8,,PR0
         0 000051   000002 316007                    CANQ    2,DL
         0 000052   000056 600000 0                  TZE     s:1657

       60     1654    3            MSG#=DAVR_MSG#;

   1654  0 000053   000022 235007                    LDA     18,DL
         0 000054   200007 755100                    STA     MSG#,,AUTO

       61     1655    3            GOTO MESALT;

   1655  0 000055   000073 710000 0                  TRA     MESALT

       62     1656    3            END;
       63     1657    3         IF RAT.FLG.RUP THEN DO;

   1657  0 000056   000004 316007                    CANQ    4,DL
         0 000057   000076 600000 0                  TZE     s:1668

   1655  0 000060                       BAVU         null
       64     1658    3   BAVU:    ;
       65     1659    3            IF RAT.FLG.MBIT.MTD OR RAT.FLG.OPN THEN MSG#=BAVU_MSG#;

   1659  0 000060   000400 316007                    CANQ    256,DL
PL6.E3A0      #001=FRC$AVR File=FRC$AVR.:E05TSI                                  TUE 07/29/97 17:21 Page:12   
         0 000061   000064 601000 0                  TNZ     s:1659
         0 000062   000020 316007                    CANQ    16,DL
         0 000063   000067 600000 0                  TZE     s:1661

   1659  0 000064   000034 235007                    LDA     28,DL
         0 000065   200007 755100                    STA     MSG#,,AUTO
         0 000066   000073 710000 0                  TRA     MESALT

       66     1660    4            ELSE DO;

       67     1661    4               MSG#=BAVR_MSG#;

   1661  0 000067   000033 235007                    LDA     27,DL
         0 000070   200007 755100                    STA     MSG#,,AUTO

       68     1662    4               RAT.REEL.ASID=JG_KEYIN#;

   1662  0 000071   000002 220003                    LDX0    2,DU
         0 000072   000004 740100                    STX0    4,,PR0

       69     1663    4               END;

   1659  0 000073                       MESALT       null
       70     1664    3   MESALT:  ;
       71     1665    3            CALL MESSOUT;

   1665  0 000073   000224 701000 0                  TSX1    MESSOUT
         0 000074   000000 011000                    NOP     0

       72     1666    3            ALTRETURN;

   1666  0 000075   000000 702200 xent               TSX2  ! X66_AALT

       73     1667    3            END;
       74     1668    2         RAT.REEL.SER=SERN;

   1668  0 000076   200005 471500                    LDP1    @SERN,,AUTO
PL6.E3A0      #001=FRC$AVR File=FRC$AVR.:E05TSI                                  TUE 07/29/97 17:21 Page:13   
         0 000077   040100 100500                    MLR     fill='040'O
         0 000100   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6
         0 000101   000004 400006                    ADSC9   4,,PR0                   cn=2,n=6

       75     1669    2         RAT.FLG.RUP='1'B;

   1669  0 000102   000004 236007                    LDQ     4,DL
         0 000103   000010 256100                    ORSQ    8,,PR0

       76     1670    3         DO CASE (TYPE);

   1670  0 000104   200004 473500                    LDP3    @TYPE,,AUTO
         0 000105   300000 235100                    LDA     0,,PR3
         0 000106   000004 115007                    CMPA    4,DL
         0 000107   000111 602005 0                  TNC     s:1670+5,AL
         0 000110   000151 710000 0                  TRA     s:1687
         0 000111   000151 710000 0                  TRA     s:1687
         0 000112   000115 710000 0                  TRA     ALLLBLD
         0 000113   000120 710000 0                  TRA     s:1675
         0 000114   000132 710000 0                  TRA     s:1679

       77     1671    3         CASE (FRC_LBL#);

   1668  0 000115                       ALLLBLD      null
       78     1672    3   ALLLBLD: ;
       79     1673    3            MSG#=MNTD_MSG#;

   1673  0 000115   000030 235007                    LDA     24,DL
         0 000116   200007 755100                    STA     MSG#,,AUTO
         0 000117   000153 710000 0                  TRA     s:1696

       80     1674    3         CASE (FRC_SCR#);

       81     1675    3            RAT.FLG.MBIT.MTSC='1'B;

   1675  0 000120   000200 236007                    LDQ     128,DL
         0 000121   000010 256100                    ORSQ    8,,PR0
PL6.E3A0      #001=FRC$AVR File=FRC$AVR.:E05TSI                                  TUE 07/29/97 17:21 Page:14   

       82     1676    3            IF RAT.REEL.ASID=0 THEN MSG#=RQKN_MSG#;

   1676  0 000122   000004 220100                    LDX0    4,,PR0
         0 000123   000127 601000 0                  TNZ     s:1677

   1676  0 000124   000032 235007                    LDA     26,DL
         0 000125   200007 755100                    STA     MSG#,,AUTO
         0 000126   000153 710000 0                  TRA     s:1696

       83     1677    3            ELSE MSG#=MNTD_MSG#;

   1677  0 000127   000030 235007                    LDA     24,DL
         0 000130   200007 755100                    STA     MSG#,,AUTO
         0 000131   000153 710000 0                  TRA     s:1696

       84     1678    3         CASE (FRC_LSCR#);

       85     1679    3            IF FT_PROT=FT_FULLPROT# THEN GOTO ALLLBLD;

   1679  0 000132   000000 235000 xsym               LDA     FT_PROT
         0 000133   000002 115007                    CMPA    2,DL
         0 000134   000115 600000 0                  TZE     ALLLBLD

       86     1680    3            IF RAT.REEL.ASID~=0 THEN MSG#=ANSC_MSG#;

   1680  0 000135   000004 220100                    LDX0    4,,PR0
         0 000136   000142 600000 0                  TZE     s:1682

   1680  0 000137   000031 235007                    LDA     25,DL
         0 000140   200007 755100                    STA     MSG#,,AUTO
         0 000141   000146 710000 0                  TRA     s:1685

       87     1681    4            ELSE DO;

       88     1682    4               RAT.REEL.ASID=JG_SLUG#;

PL6.E3A0      #001=FRC$AVR File=FRC$AVR.:E05TSI                                  TUE 07/29/97 17:21 Page:15   
   1682  0 000142   000001 221003                    LDX1    1,DU
         0 000143   000004 741100                    STX1    4,,PR0

       89     1683    4               MSG#=RQKN_MSG#;

   1683  0 000144   000032 235007                    LDA     26,DL
         0 000145   200007 755100                    STA     MSG#,,AUTO

       90     1684    4               END;

       91     1685    3            RAT.FLG.MBIT.MTSC='1'B;

   1685  0 000146   000200 236007                    LDQ     128,DL
         0 000147   000010 256100                    ORSQ    8,,PR0
         0 000150   000153 710000 0                  TRA     s:1696

       92     1686    3         CASE (ELSE);

       93     1687    3            CALL SC_AVRTYP;

   1687  0 000151   000000 713400 xsym               CLIMB   SC_AVRTYP
         0 000152   000000 600000 xsid               climb   nvectors=         0

       94     1688           /*S*  SCREECH_CODE:  FRC-S$AVRTYP
       95     1689                 TYPE:          Screech
       96     1690                 MESSAGE:       Unknown TAPE type passed to resource management from AVR
       97     1691                 REMARKS:       AVR calls FRC$AVR with a type code indicating
       98     1692                                whether the tape is LABELED (ANS), LABELED SCRATCH
       99     1693                                (ANSCRATCH), OR UNLABELED (SCRATCH).  This screech
      100     1694                                occurs when the type passed is none of these            */
      101     1695    3         END;

      102     1696    2         CALL MESSOUT;

   1696  0 000153   000224 701000 0                  TSX1    MESSOUT
         0 000154   000000 011000                    NOP     0

PL6.E3A0      #001=FRC$AVR File=FRC$AVR.:E05TSI                                  TUE 07/29/97 17:21 Page:16   
      103     1697    2         CALL FRC$WAKU (RAT);

   1697  0 000155   200006 630500                    EPPR0   RAT$,,AUTO
         0 000156   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000157   000000 701000 xent               TSX1    FRC$WAKU
         0 000160   000000 011000                    NOP     0

      104     1698    2         RETURN;

   1698  0 000161   000000 702200 xent               TSX2  ! X66_ARET

      105     1699    2      CASE(FR_DP);

      106     1700    3         IF TYPE>=0 THEN DO;

   1700  0 000162   200004 471500                    LDP1    @TYPE,,AUTO
         0 000163   100000 235100                    LDA     0,,PR1
         0 000164   000212 604000 0                  TMI     s:1713

      107     1701    3            RAT.FLG.RUP='1'B;

   1701  0 000165   000004 236007                    LDQ     4,DL
         0 000166   000010 256100                    ORSQ    8,,PR0

      108     1702    4            IF TYPE~=0 THEN DO;

   1702  0 000167   100000 235100                    LDA     0,,PR1
         0 000170   000204 600000 0                  TZE     s:1708

      109     1703    4               RAT.REEL.SER=SERN;

   1703  0 000171   200005 473500                    LDP3    @SERN,,AUTO
         0 000172   040100 100500                    MLR     fill='040'O
         0 000173   300000 000006                    ADSC9   0,,PR3                   cn=0,n=6
         0 000174   000004 400006                    ADSC9   4,,PR0                   cn=2,n=6

      110     1704    4               RAT.FLG.MBIT.MTSC='0'B;
PL6.E3A0      #001=FRC$AVR File=FRC$AVR.:E05TSI                                  TUE 07/29/97 17:21 Page:17   

   1704  0 000175   000000 236000 1                  LDQ     0
         0 000176   000010 356100                    ANSQ    8,,PR0

      111     1705    4               CALL FRC$WAKU(RAT);

   1705  0 000177   200006 630500                    EPPR0   RAT$,,AUTO
         0 000200   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000201   000000 701000 xent               TSX1    FRC$WAKU
         0 000202   000000 011000                    NOP     0

      112     1706    4               END;

   1706  0 000203   000222 710000 0                  TRA     s:1717

      113     1707    4            ELSE DO;

      114     1708    4               RAT.REEL.SER=' ';

   1708  0 000204   040100 100400                    MLR     fill='040'O
         0 000205   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         0 000206   000004 400006                    ADSC9   4,,PR0                   cn=2,n=6

      115     1709    4               RAT.FLG.MBIT.MTSC='1'B;

   1709  0 000207   000200 236007                    LDQ     128,DL
         0 000210   000010 256100                    ORSQ    8,,PR0

      116     1710    4               END;

      117     1711    3            END;

   1711  0 000211   000222 710000 0                  TRA     s:1717

      118     1712    3         ELSE DO;

      119     1713    3            IF RAT.FLG.MBIT.MTD THEN RETURN;
PL6.E3A0      #001=FRC$AVR File=FRC$AVR.:E05TSI                                  TUE 07/29/97 17:21 Page:18   

   1713  0 000212   000010 236100                    LDQ     8,,PR0
         0 000213   000400 316007                    CANQ    256,DL
         0 000214   000216 600000 0                  TZE     s:1714

   1713  0 000215   000000 702200 xent               TSX2  ! X66_ARET

      120     1714    3            RAT.REEL='0'B;

   1714  0 000216   000004 450100                    STZ     4,,PR0
         0 000217   000005 450100                    STZ     5,,PR0

      121     1715    3            RAT.FLG.RUP='0'B;

   1715  0 000220   000001 236000 1                  LDQ     1
         0 000221   000010 356100                    ANSQ    8,,PR0

      122     1716    3            END;

      123     1717    2         RETURN;

   1717  0 000222   000000 702200 xent               TSX2  ! X66_ARET

      124     1718    2      END;

   1718  0 000223   000246 710000 0                  TRA     s:1727

      125     1719           /**/
      126     1720           /**/
      127     1721    1   MESSOUT: PROC;

   1721  0 000224   200010 741300       MESSOUT      STX1  ! MSG#+1,,AUTO

      128     1722           /**/
      129     1723    2      CALL OCI$MK_WR (M_TAPE,MSG#,LENGTHC(FR_AMSGL),FR_AMSGL,RAT.REEL,DCTX);

   1723  0 000225   200003 236100                    LDQ     @DCTX,,AUTO
PL6.E3A0      #001=FRC$AVR File=FRC$AVR.:E05TSI                                  TUE 07/29/97 17:21 Page:19   
         0 000226   200017 756100                    STQ     MSG#+8,,AUTO
         0 000227   200006 236100                    LDQ     RAT$,,AUTO
         0 000230   000004 036003                    ADLQ    4,DU
         0 000231   200016 756100                    STQ     MSG#+7,,AUTO
         0 000232   000004 237000 1                  LDAQ    4
         0 000233   200014 757100                    STAQ    MSG#+5,,AUTO
         0 000234   200007 630500                    EPPR0   MSG#,,AUTO
         0 000235   200013 450500                    STP0    MSG#+4,,AUTO
         0 000236   000003 236000 1                  LDQ     3
         0 000237   200012 756100                    STQ     MSG#+3,,AUTO
         0 000240   200012 630500                    EPPR0   MSG#+3,,AUTO
         0 000241   000024 631400 xsym               EPPR1   B_VECTNIL+20
         0 000242   000000 701000 xent               TSX1    OCI$MK_WR
         0 000243   000000 011000                    NOP     0

      130     1724    2      RETURN;

   1724  0 000244   200010 221300                    LDX1  ! MSG#+1,,AUTO
         0 000245   000001 702211                    TSX2  ! 1,X1

      131     1725    2   END;
      132     1726           /**/
      133     1727    1   END;

   1727  0 000246   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   1     000   777777 777577   777777 777773   100000 000000   000002 006000    ........@.......
   1     004   000004 006000   000000 006000                                    ........
      134     1728           /**/
      135     1729           /**/
      136     1730        %EOD;

PL6.E3A0      #001=FRC$AVR File=FRC$AVR.:E05TSI                                  TUE 07/29/97 17:21 Page:20   
--  Include file information  --

   FR_SUBS.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   FT_SUBS.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FR_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FR$RAT.:E05TOU  is referenced.
      No diagnostics issued in procedure FRC$AVR.
PL6.E3A0      #001=FRC$AVR File=FRC$AVR.:E05TSI                                  TUE 07/29/97 17:21 Page:21   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @DCTX                      5-0-0/w PTR         r     1 @SERN
     4-0-0/w PTR         r     1 @TYPE                     *0-0-0/w UBIN        r     1 DCTX
     7-0-0/w UBIN        r     1 MSG#                       6-0-0/w PTR         r     1 RAT$
    *0-0-0/c CHAR(6)     r     1 SERN                      *0-0-0/w SBIN        r     1 TYPE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(2)     r     1 FR_AMSGL                   0-0-0/w UBIN        r     1 FR_AVRCNT
     0-0-0/w UBIN        r     1 FT_PROT                    0-0-0/w PTR         r     1 N$DCT$$
     0-0-0/w PTR         r     1 N$FQ$                      0-0-0/w PTR         r     1 NI$FQ$
     0-0-0/w PTR         r     1 NI$IBUF$                   0-0-0/w PTR         r     1 NI$RP$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1332)  r     1 DCT                        0-0-0/w PTR         r     1 N$DCT$(0:0)
     0-0-0/w STRC(324)   r     1 RAT


   Procedure FRC$AVR requires 167 words for executable code.
   Procedure FRC$AVR requires 16 words of local(AUTO) storage.
PL6.E3A0      #001=FRC$AVR File=FRC$AVR.:E05TSI                                  TUE 07/29/97 17:21 Page:22   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=FRC$AVR File=FRC$AVR.:E05TSI                                  TUE 07/29/97 17:21 Page:23   
          MINI XREF LISTING

ALLLBLD
      1668**LABEL    1679--GOTO
DCT.DP
      1600**DCL      1607--REDEF    1610--REDEF    1611--REDEF    1613--REDEF    1613--REDEF    1614--REDEF
      1615--REDEF    1615--REDEF
DCT.MPC.IOCHANX
      1608**DCL      1608--REDEF
DCT.RAT$
      1581**DCL      1636>>ASSIGN
DCTX
      1621**DCL        11--PROC     1634>>ASSIGN   1723<>CALL
FRC$WAKU
      1628**DCL-ENT  1697--CALL     1705--CALL
FR_AMSGL
       120**DCL      1723--CALL     1723<>CALL
FR_AVRCNT
       133**DCL      1638<<ASSIGN   1638>>ASSIGN
FT_PROT
      1626**DCL      1679>>IF
MESALT
      1659**LABEL    1655--GOTO
MESSOUT
      1721**PROC     1665--CALL     1696--CALL
MSG#
      1625**DCL      1654<<ASSIGN   1659<<ASSIGN   1661<<ASSIGN   1673<<ASSIGN   1676<<ASSIGN   1677<<ASSIGN
      1680<<ASSIGN   1683<<ASSIGN   1723<>CALL
N$DCT$
       571**DCL      1634>>ASSIGN
N$DCT$$
       437**DCL       571--IMP-PTR  1634>>ASSIGN
N$FQ$
       437**DCL       572--IMP-PTR
PL6.E3A0      #001=FRC$AVR File=FRC$AVR.:E05TSI                                  TUE 07/29/97 17:21 Page:24   
N$REQ_INIT.BUFADDR
       456**DCL       457--REDEF     457--REDEF
N$REQ_INIT.DLA.DRELADDR
       448**DCL       448--REDEF
N$REQ_INIT.DVE.EOMCHAR
       485**DCL       486--REDEF
N$REQ_INIT.EAINFO
       479**DCL       479--REDEF
N$REQ_INIT.EAINFOX
       479**DCL       480--REDEF
N$REQ_INIT.EVNTINFO
       480**DCL       480--REDEF
N$REQ_INIT.STATUS
       461**DCL       467--REDEF
NI$FQ$
       497**DCL       573--IMP-PTR
NI$IBUF$
       497**DCL       573--IMP-PTR
NI$IMXMBX_INIT.PAGED_BASE
       507**DCL       508--REDEF     508--REDEF
NI$IMXMBX_INIT.SIZE
       509**DCL       509--REDEF
NI$REQ_INIT.DCW
       531**DCL       534--REDEF
NI$REQ_INIT.DCW.TALLY
       532**DCL       532--REDEF
NI$REQ_INIT.IDCW.EXTA
       534**DCL       534--REDEF
NI$REQ_INIT.PCW
       536**DCL       540--REDEF
NI$REQ_INIT.SEEK
       541**DCL       542--REDEF     543--REDEF
NI$RP$
       545**DCL       575--IMP-PTR
NI_MBX_INIT.DCW.CONTROL.AE
       567**DCL       567--REDEF
PL6.E3A0      #001=FRC$AVR File=FRC$AVR.:E05TSI                                  TUE 07/29/97 17:21 Page:25   
NI_MBX_INIT.LPW.CONTROL.AE
       563**DCL       563--REDEF
OCI$MK_WR
      1627**DCL-ENT  1723--CALL
RAT
        69**DCL      1697<>CALL     1705<>CALL
RAT.FLG.DOWN
       104**DCL      1653>>IF
RAT.FLG.FORM
       102**DCL      1652>>IF
RAT.FLG.MBIT.MTD
        97**DCL      1659>>IF       1713>>IF
RAT.FLG.MBIT.MTSC
        98**DCL      1675<<ASSIGN   1685<<ASSIGN   1704<<ASSIGN   1709<<ASSIGN
RAT.FLG.OPN
       101**DCL      1659>>IF
RAT.FLG.RUP
       103**DCL      1657>>IF       1669<<ASSIGN   1701<<ASSIGN   1715<<ASSIGN
RAT.RCOD
        82**DCL      1639>>DOCASE
RAT.REEL
        88**DCL      1714<<ASSIGN   1723<>CALL
RAT.REEL.ASID
        89**DCL      1662<<ASSIGN   1676>>IF       1680>>IF       1682<<ASSIGN
RAT.REEL.SER
        90**DCL      1668<<ASSIGN   1703<<ASSIGN   1708<<ASSIGN
RAT$
      1624**DCL        69--IMP-PTR  1634<<ASSIGN   1635>>IF       1636<<ASSIGN   1636>>ASSIGN   1637>>IF
      1639>>DOCASE   1652>>IF       1653>>IF       1657>>IF       1659>>IF       1659>>IF       1662>>ASSIGN
      1668>>ASSIGN   1669>>ASSIGN   1675>>ASSIGN   1676>>IF       1680>>IF       1682>>ASSIGN   1685>>ASSIGN
      1697>>CALL     1701>>ASSIGN   1703>>ASSIGN   1704>>ASSIGN   1705>>CALL     1708>>ASSIGN   1709>>ASSIGN
      1713>>IF       1714>>ASSIGN   1715>>ASSIGN   1723>>CALL
SC_AVRDCT
      1630**DCL-ENT  1635--CALL     1637--CALL     1641--CALL     1652--CALL
SC_AVRTYP
      1631**DCL-ENT  1687--CALL
PL6.E3A0      #001=FRC$AVR File=FRC$AVR.:E05TSI                                  TUE 07/29/97 17:21 Page:26   
SERN
      1623**DCL        11--PROC     1668>>ASSIGN   1703>>ASSIGN
TYPE
      1622**DCL        11--PROC     1670>>DOCASE   1700>>IF       1702>>IF

PL6.E3A0      #002=FRC$WAKU File=FRC$AVR.:E05TSI                                 TUE 07/29/97 17:21 Page:27   
      137        1        /*T***********************************************************/
      138        2        /*T*                                                         */
      139        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      140        4        /*T*                                                         */
      141        5        /*T***********************************************************/
      142        6           /**/
      143        7           /**/
      144        8        FRC$WAKU: PROC (RAT);
      145        9           /**/
      146       10           /**/
      147       11        %INCLUDE FR$RAT;
      148       64        %FR$RAT (NAME=RAT,STCLASS=);
      149      104        %FR$RAT (NAME=RA1,STCLASS="BASED(RA1$)");
      150      144        %INCLUDE FR_DATA_R;
      151      176        %INCLUDE SS_SCHED_C;
      152      409        %INCLUDE JG_GHOSTS_C;
      153      499        %INCLUDE FR_SUBS;
      154      567           /**/
      155      568           /**/
      156      569    1   DCL RAT$ PTR;
      157      570    1   DCL RA1$ PTR;
      158      571    1   DCL SERN CHAR(6);
      159      572    1   DCL SYSID UBIN WORD;
      160      573    1   DCL SSR$RUE ENTRY(4);
      161      574           /**/
      162      575           /**/
      163      576    1      SERN=RAT.REEL.SER;
      164      577    1      SYSID=RAT.REEL.ASID;
      165      578    2      IF SYSID>JG_SLUG# OR (SERN~=' ' AND SYSID~=JG_SLUG#) THEN DO;
      166      579    2         RA1$=FR$HD$(RAT.RCOD);
      167      580    3         DO WHILE (RA1$~=ADDR(NIL));
      168      581    4            IF RA1.FLG.MBIT.SOL THEN DO;
      169      582    5               IF RA1.SSER=' ' THEN DO;
      170      583    5                  IF RAT.FLG.MBIT.MTSC='0'B OR SYSID~=RA1.RES.SISID THEN GOTO WAK1;
      171      584    5                  END;
      172      585    5               ELSE DO;
      173      586    5                  IF RA1.SSER~=SERN OR
PL6.E3A0      #002=FRC$WAKU File=FRC$AVR.:E05TSI                                 TUE 07/29/97 17:21 Page:28   
      174      587    5                    (SYSID~=0 AND SYSID~=RA1.RES.SISID) THEN GOTO WAK1;
      175      588    5                  END;
      176      589    4               RA1.FLG.MBIT.SOL='0'B;
      177      590    4               CALL SSR$RUE (%SS_WU,RA1.SOLU);
      178      591    4               END;
      179      592    3   WAK1:    ;
      180      593    3            RA1$=RA1.LNK$;
      181      594    3            END;
      182      595    2         END;
      183      596    2      IF RAT.FLG.MBIT.SOL THEN DO;
      184      597    2         RAT.FLG.MBIT.SOL='0'B;
      185      598    2         CALL SSR$RUE (%SS_WU,RAT.SOLU);
      186      599    2         END;
      187      600    1      RETURN;
      188      601           /**/
      189      602    1   END;
      190      603           /**/
      191      604           /**/
      192      605        %EOD;

PL6.E3A0      #002=FRC$WAKU File=FRC$AVR.:E05TSI                                 TUE 07/29/97 17:21 Page:29   
--  Include file information  --

   FR_SUBS.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   FR_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FR$RAT.:E05TOU  is referenced.
      No diagnostics issued in procedure FRC$WAKU.

   Procedure FRC$WAKU requires 82 words for executable code.
   Procedure FRC$WAKU requires 12 words of local(AUTO) storage.

PL6.E3A0      #002=FRC$WAKU File=FRC$AVR.:E05TSI                                 TUE 07/29/97 17:21 Page:30   

 Object Unit name= FRC$WAKU                                   File name= FRC$AVR.:E05TOU
 UTS= JUL 29 '97 17:21:53.84 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    82    122  FRC$WAKU
    1  RoData even  none     4      4  FRC$WAKU

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        1  FRC$WAKU

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       4 SSR$RUE
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     FR$HD$                                B_VECTNIL
PL6.E3A0      #002=FRC$WAKU File=FRC$AVR.:E05TSI                                 TUE 07/29/97 17:21 Page:31   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=FRC$WAKU File=FRC$AVR.:E05TSI                                 TUE 07/29/97 17:21 Page:32   


      137        1        /*T***********************************************************/
      138        2        /*T*                                                         */
      139        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      140        4        /*T*                                                         */
      141        5        /*T***********************************************************/
      142        6           /**/
      143        7           /**/
      144        8        FRC$WAKU: PROC (RAT);

      8  0 000000   000000 700200 xent  FRC$WAKU     TSX0  ! X66_AUTO_1
         0 000001   000014 000001                    ZERO    12,1

      145        9           /**/
      146       10           /**/
      147       11        %INCLUDE FR$RAT;
      148       64        %FR$RAT (NAME=RAT,STCLASS=);
      149      104        %FR$RAT (NAME=RA1,STCLASS="BASED(RA1$)");
      150      144        %INCLUDE FR_DATA_R;
      151      176        %INCLUDE SS_SCHED_C;
      152      409        %INCLUDE JG_GHOSTS_C;
      153      499        %INCLUDE FR_SUBS;
      154      567           /**/
      155      568           /**/
      156      569    1   DCL RAT$ PTR;
      157      570    1   DCL RA1$ PTR;
      158      571    1   DCL SERN CHAR(6);
      159      572    1   DCL SYSID UBIN WORD;
      160      573    1   DCL SSR$RUE ENTRY(4);
      161      574           /**/
      162      575           /**/
      163      576    1      SERN=RAT.REEL.SER;

    576  0 000002   200003 470500                    LDP0    @RAT,,AUTO
         0 000003   040100 100500                    MLR     fill='040'O
         0 000004   000004 400006                    ADSC9   4,,PR0                   cn=2,n=6
         0 000005   200006 000006                    ADSC9   SERN,,AUTO               cn=0,n=6
PL6.E3A0      #002=FRC$WAKU File=FRC$AVR.:E05TSI                                 TUE 07/29/97 17:21 Page:33   

      164      577    1      SYSID=RAT.REEL.ASID;

    577  0 000006   000004 236100                    LDQ     4,,PR0
         0 000007   000022 732000                    QRS     18
         0 000010   200010 756100                    STQ     SYSID,,AUTO

      165      578    2      IF SYSID>JG_SLUG# OR (SERN~=' ' AND SYSID~=JG_SLUG#) THEN DO;

    578  0 000011   000002 116007                    CMPQ    2,DL
         0 000012   000021 603000 0                  TRC     s:579
         0 000013   040000 106500                    CMPC    fill='040'O
         0 000014   200006 000006                    ADSC9   SERN,,AUTO               cn=0,n=6
         0 000015   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         0 000016   000103 600000 0                  TZE     s:596
         0 000017   000001 116007                    CMPQ    1,DL
         0 000020   000103 600000 0                  TZE     s:596

      166      579    2         RA1$=FR$HD$(RAT.RCOD);

    579  0 000021   000003 236100                    LDQ     3,,PR0
         0 000022   000027 772000                    QRL     23
         0 000023   000017 376007                    ANQ     15,DL
         0 000024   000000 236006 xsym               LDQ     FR$HD$,QL
         0 000025   200005 756100                    STQ     RA1$,,AUTO

      167      580    3         DO WHILE (RA1$~=ADDR(NIL));

    580  0 000026   000101 710000 0                  TRA     s:594

      168      581    4            IF RA1.FLG.MBIT.SOL THEN DO;

    581  0 000027   200005 470500                    LDP0    RA1$,,AUTO
         0 000030   000010 236100                    LDQ     8,,PR0
         0 000031   000100 316007                    CANQ    64,DL
         0 000032   000076 600000 0                  TZE     WAK1

PL6.E3A0      #002=FRC$WAKU File=FRC$AVR.:E05TSI                                 TUE 07/29/97 17:21 Page:34   
      169      582    5               IF RA1.SSER=' ' THEN DO;

    582  0 000033   040000 106500                    CMPC    fill='040'O
         0 000034   000006 400006                    ADSC9   6,,PR0                   cn=2,n=6
         0 000035   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         0 000036   000051 601000 0                  TNZ     s:586

      170      583    5                  IF RAT.FLG.MBIT.MTSC='0'B OR SYSID~=RA1.RES.SISID THEN GOTO WAK1;

    583  0 000037   200003 471500                    LDP1    @RAT,,AUTO
         0 000040   100010 236100                    LDQ     8,,PR1
         0 000041   000200 316007                    CANQ    128,DL
         0 000042   000076 600000 0                  TZE     WAK1
         0 000043   000001 236100                    LDQ     1,,PR0
         0 000044   000022 732000                    QRS     18
         0 000045   000076 604000 0                  TMI     WAK1
         0 000046   200010 116100                    CMPQ    SYSID,,AUTO
         0 000047   000076 601000 0                  TNZ     WAK1

      171      584    5                  END;

    584  0 000050   000064 710000 0                  TRA     s:589

      172      585    5               ELSE DO;

      173      586    5                  IF RA1.SSER~=SERN OR

    586  0 000051   040100 106500                    CMPC    fill='040'O
         0 000052   000006 400006                    ADSC9   6,,PR0                   cn=2,n=6
         0 000053   200006 000006                    ADSC9   SERN,,AUTO               cn=0,n=6
         0 000054   000076 601000 0                  TNZ     WAK1
         0 000055   200010 235100                    LDA     SYSID,,AUTO
         0 000056   000064 600000 0                  TZE     s:589
         0 000057   000001 236100                    LDQ     1,,PR0
         0 000060   000022 732000                    QRS     18
         0 000061   000076 604000 0                  TMI     WAK1
         0 000062   200010 116100                    CMPQ    SYSID,,AUTO
PL6.E3A0      #002=FRC$WAKU File=FRC$AVR.:E05TSI                                 TUE 07/29/97 17:21 Page:35   
         0 000063   000076 601000 0                  TNZ     WAK1

      174      587    5                    (SYSID~=0 AND SYSID~=RA1.RES.SISID) THEN GOTO WAK1;
      175      588    5                  END;

      176      589    4               RA1.FLG.MBIT.SOL='0'B;

    589  0 000064   000000 236000 1                  LDQ     0
         0 000065   000010 356100                    ANSQ    8,,PR0

      177      590    4               CALL SSR$RUE (%SS_WU,RA1.SOLU);

    590  0 000066   200005 236100                    LDQ     RA1$,,AUTO
         0 000067   000002 036000 1                  ADLQ    2
         0 000070   000003 235000 1                  LDA     3
         0 000071   200012 757100                    STAQ    SYSID+2,,AUTO
         0 000072   200012 630500                    EPPR0   SYSID+2,,AUTO
         0 000073   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000074   000000 701000 xent               TSX1    SSR$RUE
         0 000075   000000 011000                    NOP     0

      178      591    4               END;

    587  0 000076                       WAK1         null
      179      592    3   WAK1:    ;
      180      593    3            RA1$=RA1.LNK$;

    593  0 000076   200005 470500                    LDP0    RA1$,,AUTO
         0 000077   000000 236100                    LDQ     0,,PR0
         0 000100   200005 756100                    STQ     RA1$,,AUTO

      181      594    3            END;

    594  0 000101   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000102   000027 601000 0                  TNZ     s:581

      182      595    2         END;
PL6.E3A0      #002=FRC$WAKU File=FRC$AVR.:E05TSI                                 TUE 07/29/97 17:21 Page:36   

      183      596    2      IF RAT.FLG.MBIT.SOL THEN DO;

    596  0 000103   200003 470500                    LDP0    @RAT,,AUTO
         0 000104   000010 236100                    LDQ     8,,PR0
         0 000105   000100 316007                    CANQ    64,DL
         0 000106   000121 600000 0                  TZE     s:600

      184      597    2         RAT.FLG.MBIT.SOL='0'B;

    597  0 000107   000000 236000 1                  LDQ     0
         0 000110   000010 356100                    ANSQ    8,,PR0

      185      598    2         CALL SSR$RUE (%SS_WU,RAT.SOLU);

    598  0 000111   200003 236100                    LDQ     @RAT,,AUTO
         0 000112   000002 036000 1                  ADLQ    2
         0 000113   000003 235000 1                  LDA     3
         0 000114   200012 757100                    STAQ    SYSID+2,,AUTO
         0 000115   200012 630500                    EPPR0   SYSID+2,,AUTO
         0 000116   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000117   000000 701000 xent               TSX1    SSR$RUE
         0 000120   000000 011000                    NOP     0

      186      599    2         END;

      187      600    1      RETURN;

    600  0 000121   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   1     000   777777 777677   000000 000027   000010 400000   000001 006000    ................
      188      601           /**/
      189      602    1   END;
      190      603           /**/
      191      604           /**/
PL6.E3A0      #002=FRC$WAKU File=FRC$AVR.:E05TSI                                 TUE 07/29/97 17:21 Page:37   
      192      605        %EOD;

PL6.E3A0      #002=FRC$WAKU File=FRC$AVR.:E05TSI                                 TUE 07/29/97 17:21 Page:38   
--  Include file information  --

   FR_SUBS.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   FR_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FR$RAT.:E05TOU  is referenced.
      No diagnostics issued in procedure FRC$WAKU.
PL6.E3A0      #002=FRC$WAKU File=FRC$AVR.:E05TSI                                 TUE 07/29/97 17:21 Page:39   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @RAT                       5-0-0/w PTR         r     1 RA1$
    *0-0-0/w STRC(324)   r     1 RAT                        6-0-0/c CHAR(6)     r     1 SERN
    10-0-0/w UBIN        r     1 SYSID

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 FR$HD$(0:3)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(324)   r     1 RA1


   Procedure FRC$WAKU requires 82 words for executable code.
   Procedure FRC$WAKU requires 12 words of local(AUTO) storage.
PL6.E3A0      #002=FRC$WAKU File=FRC$AVR.:E05TSI                                 TUE 07/29/97 17:21 Page:40   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=FRC$WAKU File=FRC$AVR.:E05TSI                                 TUE 07/29/97 17:21 Page:41   
          MINI XREF LISTING

FR$HD$
       153**DCL       579>>ASSIGN
RA1.FLG.MBIT.SOL
       136**DCL       581>>IF        589<<ASSIGN
RA1.LNK$
       107**DCL       593>>ASSIGN
RA1.RES.SISID
       109**DCL       583>>IF        586>>IF
RA1.SOLU
       131**DCL       590<>CALL
RA1.SSER
       129**DCL       582>>IF        586>>IF
RA1$
       570**DCL       106--IMP-PTR   579<<ASSIGN    580>>DOWHILE   581>>IF        582>>IF        583>>IF
       586>>IF        586>>IF        589>>ASSIGN    590>>CALL      593<<ASSIGN    593>>ASSIGN
RAT
        66**DCL         8--PROC
RAT.FLG.MBIT.MTSC
        95**DCL       583>>IF
RAT.FLG.MBIT.SOL
        96**DCL       596>>IF        597<<ASSIGN
RAT.RCOD
        79**DCL       579>>ASSIGN
RAT.REEL.ASID
        86**DCL       577>>ASSIGN
RAT.REEL.SER
        87**DCL       576>>ASSIGN
RAT.SOLU
        91**DCL       598<>CALL
SERN
       571**DCL       576<<ASSIGN    578>>IF        586>>IF
SSR$RUE
PL6.E3A0      #002=FRC$WAKU File=FRC$AVR.:E05TSI                                 TUE 07/29/97 17:21 Page:42   
       573**DCL-ENT   590--CALL      598--CALL
SYSID
       572**DCL       577<<ASSIGN    578>>IF        578>>IF        583>>IF        586>>IF        586>>IF
WAK1
       587**LABEL     583--GOTO      587--GOTO

PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:43   
      193        1        /*T***********************************************************/
      194        2        /*T*                                                         */
      195        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      196        4        /*T*                                                         */
      197        5        /*T***********************************************************/
      198        6           /**/
      199        7           /**/
      200        8        FRC$KEYIN: PROC (KMSG) ALTRET;
      201        9           /**/
      202       10           /**/
      203       11        %INCLUDE CP_6_SUBS;
      204      551        %INCLUDE FR$RAT;
      205      604        %FR$RAT (NAME=RAT,STCLASS="BASED(RAT$)");
      206      644        %INCLUDE N_FC_C;
      207      681        %INCLUDE NI_DATA_C;
      208      794        %INCLUDE NI_DATA_R;
      209     1231           %N$REQ;
      210     1289        %INCLUDE FR_DATA_R;
      211     1321        %INCLUDE JG_GHOSTS_C;
      212     1411        %INCLUDE OC_SUBS_C;
      213     2142        %INCLUDE NK_SUBS;
      214     2167        %INCLUDE FR_SUBS;
      215     2235        %INCLUDE FT_SUBS;
      216     2315        %INCLUDE FT$DDT;
      217     2376           /**/
      218     2377        %NI$DCT (NAME=DCT,STCLASS=BASED);
      219     2425           /**/
      220     2426           /**/
      221     2427    1   DCL 1 KMSG ALIGNED,
      222     2428    1         2 KIN# UBIN(18) UNAL,
      223     2429    1         2 CADDR BIT(18) UNAL,
      224     2430    1         2 SYSID UBIN(18) UNAL,
      225     2431    1         2 SERN CHAR(6) UNAL,
      226     2432    1         2 DEV CHAR(8) UNAL,
      227     2433    1         2 DTW REDEF DEV UNAL,
      228     2434    1           3 D CHAR(4) UNAL,
      229     2435    1           3 TN REDEF D UNAL,
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:44   
      230     2436    1             4 T CHAR(2) UNAL,
      231     2437    1             4 N CHAR(2) UNAL,
      232     2438    1           3 TW CHAR(4) UNAL;
      233     2439    1   DCL ANYLISTED SBIN WORD;
      234     2440    1   DCL 1 KERR ALIGNED,
      235     2441    1         2 CODE UBIN WORD,
      236     2442    1         2 SERN CHAR(6);
      237     2443    1   DCL EMSGL (0:1) UBIN BYTE UNAL CONSTANT INIT(4,6);
      238     2444    1   DCL 1 KDSP ALIGNED,
      239     2445    1         2 ASYD UBIN(18) UNAL,
      240     2446    1         2 SERN CHAR(6) UNAL,
      241     2447    1         2 STATE UNAL,
      242     2448    1           3 * BIT(4) UNAL,
      243     2449    1           3 SOLIC BIT(1) UNAL,
      244     2450    1           3 DOWN BIT(1) UNAL,
      245     2451    1           3 MBT BIT(3) UNAL,
      246     2452    1           3 MBTR REDEF MBT UNAL,
      247     2453    1             4 * BIT(2) UNAL,
      248     2454    1             4 UP BIT(1),
      249     2455    1         2 SYSID UBIN(18) UNAL;
      250     2456    1   DCL TMSGL (0:3) UBIN BYTE UNAL CONSTANT INIT(2,6,1,2);
      251     2457    1   DCL RAT$ PTR;
      252     2458    1   DCL DCTX UBIN WORD;
      253     2459    1   DCL MSG# UBIN WORD;
      254     2460    1   DCL IDCTX REDEF MSG# UBIN WORD;
      255     2461    1   DCL IOQ$ PTR;
      256     2462    1   DCL FT_PROT UBIN WORD SYMREF;
      257     2463    1   DCL FMN$AVR ENTRY(2);
      258     2464    1   DCL FRC$WAKU ENTRY(1);
      259     2465    1   DCL FRL$AVREA ENTRY(1) ALTRET;
      260     2466    1   DCL FRZ$DSMT ENTRY(1);
      261     2467    1   DCL NIO$QUE ENTRY(1) ALTRET;
      262     2468    1   DCL NIQ$GET ENTRY(1) ALTRET;
      263     2469    1   DCL NIQ$REL ENTRY(1) ALTRET;
      264     2470    1   DCL OCZ$DEV_DCT ENTRY(3) ALTRET;
      265     2471    1   DCL OCI$MK_WR ENTRY(7);
      266     2472           /**/
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:45   
      267     2473           /**/
      268     2474    2      IF KMSG.KIN# = KEY_TAPES# OR KMSG.KIN# = KEY_VOLUME# THEN DO;
      269     2475    2         RAT$=FR$HD$(FR_MT);
      270     2476    2         KDSP.STATE='0'B;
      271     2477    2         IF KMSG.DTW.TN.T='DP' THEN RAT$=FR$HD$(FR_DP);
      272     2478    3         IF KMSG.DTW.TN.N=' ' THEN DO;
      273     2479    4            IF KMSG.DTW.TW~='0000' THEN DO;
      274     2480    4               CALL OCI$MK_WR (KMSG.CADDR,NOTP_MSG#,0);
      275     2481    4               RETURN;
      276     2482    4               END;
      277     2483    3            IDCTX=0;
      278     2484    3            END;
      279     2485    2         ELSE CALL OCZ$DEV_DCT (KMSG.DEV,IDCTX,KMSG.CADDR) ALTRET (RET);
      280     2486    2         ANYLISTED = 0;
      281     2487    3         DO WHILE (RAT$~=ADDR(NIL));
      282     2488    4            IF KMSG.KIN# ~= KEY_VOLUME# OR RAT.FLG.RUP OR RAT.FLG.MBIT.SOL OR IDCTX ~=
              2488                     0 THEN DO;
      283     2489    5               IF IDCTX=0 OR IDCTX=RAT.DCTX THEN DO;
      284     2490    6                  IF RAT.FLG.MBIT.SOL AND RAT.FLG.RUP='0'B THEN DO;
      285     2491    6                     KDSP.ASYD=RAT.RES.SISID;
      286     2492    6                     KDSP.SERN=RAT.SSER;
      287     2493    6                     KDSP.STATE.SOLIC = '1'B;
      288     2494    6                     END;
      289     2495    6                  ELSE DO;
      290     2496    6                     KDSP.ASYD=RAT.REEL.ASID;
      291     2497    6                     KDSP.SERN=RAT.REEL.SER;
      292     2498    6                     KDSP.STATE.SOLIC = '0'B;
      293     2499    6                     END;
      294     2500    5                  KDSP.SYSID=RAT.RES.SISID;
      295     2501    5                  KDSP.STATE.MBT=RAT.FLG.MBIT;
      296     2502    5                  KDSP.STATE.MBTR.UP=RAT.FLG.RUP;
      297     2503    5                  KDSP.STATE.DOWN=RAT.FLG.DOWN;
      298     2504    5                  DCTX=RAT.DCTX;
      299     2505    5                  CALL OCI$MK_WR (KMSG.CADDR,DSTP_MSG#,LENGTHC(TMSGL),TMSGL,KDSP,DCTX);
      300     2506    5                  ANYLISTED = 1;
      301     2507    5                  IF IDCTX~=0 THEN RETURN;
      302     2508    5                  END;
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:46   
      303     2509    4               END;
      304     2510    3            RAT$=RAT.LNK$;
      305     2511    3            END;
      306     2512    3         IF IDCTX~=0 THEN DO;
      307     2513    3            DCTX=IDCTX;
      308     2514    3            GOTO BDDEV;
      309     2515    3            END;
      310     2516    3         IF ANYLISTED = 0 THEN DO;
      311     2517    3            CALL OCI$MK_WR(KMSG.CADDR,NVOL_MSG#,0,0,0);
      312     2518    3            END;
      313     2519    2         RETURN;
      314     2520    2         END;
      315     2521    1      CALL OCZ$DEV_DCT (KMSG.DEV,DCTX,KMSG.CADDR) ALTRET (RET);
      316     2522    1      RAT$=N$DCT$(DCTX)->DCT.RAT$;
      317     2523    1      IF RAT$=ADDR(NIL) THEN GOTO BDDEV;
      318     2524    1      IF RAT.RCOD~=FR_MT
      319     2525    1        AND (RAT.RCOD~=FR_DP
      320     2526    1        OR KMSG.KIN#~=KEY_REQUEST#
      321     2527    1        AND KMSG.KIN#~=KEY_CANTMOUNT#
      322     2528    1        AND KMSG.KIN#~=KEY_MOUNT#)
      323     2529    2      THEN DO;
      324     2530    2   BDDEV: ;
      325     2531    2         KERR.CODE=FRKE_NTP;
      326     2532    2         GOTO ERRXIT;
      327     2533    2         END;
      328     2534    2      IF RAT.FLG.DOWN THEN DO;
      329     2535    2         KERR.CODE=FRKE_TDN;
      330     2536    2         GOTO ERRXIT;
      331     2537    2         END;
      332     2538    1      IF RAT.FLG.RUP='0'B
      333     2539    1        AND KMSG.KIN# ~= KEY_RESERVE#
      334     2540    1        AND KMSG.KIN# ~= KEY_CANTMOUNT#
      335     2541    1        AND KMSG.KIN# ~= KEY_LOAD#
      336     2542    2      THEN DO;
      337     2543    2         IF KMSG.KIN# = KEY_REQUEST#
      338     2544    2           AND RAT.RCOD = FR_MT
      339     2545    3         THEN DO; /* REQUEST MT with no reel up...clear DDT SOLICIT */
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:47   
      340     2546    3            N$DCT$(DCTX)->DCT.DDT$->FT$DDT.SOLICIT = 0;
      341     2547    3            END;
      342     2548    2         KERR.CODE=FRKE_NMT;
      343     2549    2         GOTO ERRXIT;
      344     2550    2         END;
      345     2551    1      IF RAT.FLG.MBIT.MTD
      346     2552    1        OR (RAT.REEL.ASID = JG_KEYIN# AND KMSG.KIN# ~= KEY_REQUEST#)
      347     2553    2      THEN DO;
      348     2554    2         KERR.CODE=FRKE_INU;
      349     2555    2         GOTO ERRXIT;
      350     2556    2         END;
      351     2557    2      DO CASE (KMSG.KIN#);
      352     2558    2      CASE (KEY_MOUNT#);
      353     2559    3         IF KMSG.SERN~=RAT.REEL.SER THEN DO;
      354     2560    3            IF RAT.FLG.MBIT.MTSC='0'B AND FT_PROT~=FT_UNPROT#
      355     2561    4              OR RAT.RCOD = FR_DP THEN DO;
      356     2562    4               KERR.CODE=FRKE_MTD;
      357     2563    4               KERR.SERN=RAT.REEL.SER;
      358     2564    4               GOTO ERRXIT;
      359     2565    4               END;
      360     2566    3            RAT.REEL.SER=KMSG.SERN;
      361     2567    3            END;
      362     2568    2         RAT.FLG.MBIT.MTSC='0'B;
      363     2569    2         MSG#=MNTD_MSG#;
      364     2570    2      CASE (KEY_ANSCRATCH#);
      365     2571    2         IF FT_PROT=FT_UNPROT# THEN RAT.FLG.MBIT.MTSC='1'B;
      366     2572    3         ELSE IF RAT.FLG.MBIT.MTSC='0'B THEN DO;
      367     2573    3               KERR.CODE=FRKE_NAS;
      368     2574    3               GOTO ERRXIT;
      369     2575    3               END;
      370     2576    2         IF KMSG.SERN~=' ' THEN RAT.REEL.SER=KMSG.SERN;
      371     2577    2         MSG#=ANSC_MSG#;
      372     2578    2      CASE (KEY_SCRATCH#);
      373     2579    3         IF FT_PROT=FT_UNPROT# THEN DO;
      374     2580    3            RAT.REEL.SER=' ';
      375     2581    3            RAT.FLG.MBIT.MTSC='1'B;
      376     2582    3            END;
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:48   
      377     2583    3         ELSE IF RAT.REEL.SER~=' ' THEN DO;
      378     2584    3               KERR.CODE=FRKE_NSC;
      379     2585    3               GOTO ERRXIT;
      380     2586    3               END;
      381     2587    2         MSG#=MNTD_MSG#;
      382     2588    2      CASE (KEY_CANTMOUNT#);
      383     2589    3         IF RAT.FLG.MBIT.SOL='0'B THEN DO;
      384     2590    3            KERR.CODE=FRKE_NMP;
      385     2591    3            GOTO ERRXIT;
      386     2592    3            END;
      387     2593    2         RAT.RES.RFLG.CANT='1'B;
      388     2594    2         RAT.REEL.ASID=0;
      389     2595    2         GOTO NOMSG;
      390     2596    2      CASE (KEY_REQUEST#);
      391     2597    2         CALL FRZ$DSMT (RAT);
      392     2598    2         IF NOT RAT.FLG.FORM
      393     2599    2           AND RAT.RCOD = FR_DP
      394     2600    2           AND RAT.M1&%(ATTR_DD600#|ATTR_DD500#|ATTR_DD1000#|ATTR_DD1500#|
      395     2601    2           ATTR_DD400#|ATTR_DD1100#)
      396     2602    2         THEN
      397     2603    2            CALL FMN$AVR( BINBIT(RAT.DCTX,15) , %NI_AVR_PART );
      398     2604    2         RETURN;
      399     2605    2      CASE (KEY_RESERVE#);
      400     2606    3         IF RAT.FLG.RUP='0'B THEN DO;
      401     2607    3            RAT.REEL.ASID=KMSG.SYSID;
      402     2608    3            RETURN;
      403     2609    3            END;
      404     2610    2         IF RAT.REEL.SER~=' ' AND RAT.FLG.MBIT.MTSC THEN MSG#=ANSC_MSG#;
      405     2611    2         ELSE MSG#=MNTD_MSG#;
      406     2612    2      CASE (KEY_LOAD#); /* LOAD keyin                         */
      407     2613    2         IF RAT.FLG.RUP
      408     2614    3         THEN DO; /* Reel already up                    */
      409     2615    3            KERR.CODE = FRKE_ARL;
      410     2616    3            GOTO ERRXIT;
      411     2617    3            END;
      412     2618    2         IF N$DCT$(DCTX)->DCT.DDT$->FT$DDT.SOLICIT = FT_AVRSOL#
      413     2619    3         THEN DO; /* Already AVRing                     */
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:49   
      414     2620    3            KERR.CODE = FRKE_AAR;
      415     2621    3            GOTO ERRXIT;
      416     2622    3            END;
      417     2623    2         CALL NIQ$GET(IOQ$) ALTRET(CNTLOAD);
      418     2624    2         IOQ$->N$REQ.DLA.DCTX = RAT.DCTX;
      419     2625    2         IOQ$->N$REQ.FC = %N_RQSTAT;
      420     2626    2         IOQ$->N$REQ.OPFLG.EA = '1'B;
      421     2627    2         IOQ$->N$REQ.EAENTRY = ENTADDR(FRL$AVREA);
              2627                  /* Knows what to do about such things */
      422     2628    2         IOQ$->N$REQ.EAINFO = FRL_LOADTAPE#;
      423     2629    2         IOQ$->N$REQ.OPFLG.HOLD = '1'B;
      424     2630    2         CALL NIO$QUE(IOQ$->N$REQ) ALTRET(CNTLOADR);
      425     2631    2         RETURN;
      426     2632    2      CASE (ELSE);
      427     2633    2         ALTRETURN;
      428     2634    2      END;
      429     2635    1      RAT.REEL.ASID=KMSG.SYSID;
      430     2636    1      CALL OCI$MK_WR (M_TAPE,MSG#,LENGTHC(FR_AMSGL),FR_AMSGL,RAT.REEL,DCTX);
      431     2637    1   NOMSG: ;
      432     2638    1      CALL FRC$WAKU (RAT);
      433     2639    1   RET: ;
      434     2640    1      RETURN;
      435     2641    1   CNTLOADR: ;
      436     2642    1      CALL NIQ$REL(IOQ$) ALTRET(CNTLOAD);
      437     2643    1   CNTLOAD: ;
      438     2644    1      KERR.CODE = FRKE_CNL;
      439     2645    1   ERRXIT: ;
      440     2646    1      CALL OCI$MK_WR (KMSG.CADDR,BADMT_MSG#,LENGTHC(EMSGL),EMSGL,KERR,DCTX);
      441     2647    1      RETURN;
      442     2648           /**/
      443     2649    1   END;
      444     2650           /**/
      445     2651           /**/

PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:50   
--  Include file information  --

   FT$DDT.:E05TOU  cannot be made into a system file and is referenced.
   FT_SUBS.:E05TOU  is referenced.
   FR_SUBS.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   FR_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   NI_DATA_C.:E05TOU  is referenced.
   N_FC_C.:E05TOU  is referenced.
   FR$RAT.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
      No diagnostics issued in procedure FRC$KEYIN.

   Procedure FRC$KEYIN requires 460 words for executable code.
   Procedure FRC$KEYIN requires 22 words of local(AUTO) storage.

    No errors detected in file FRC$AVR.:E05TSI    .

PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:51   

 Object Unit name= FRC$KEYIN                                  File name= FRC$AVR.:E05TOU
 UTS= JUL 29 '97 17:21:57.04 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      4      4  FRC$KEYIN
    1   Proc  even  none   460    714  FRC$KEYIN
    2  RoData even  none    23     27  FRC$KEYIN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        1  FRC$KEYIN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       7 OCI$MK_WR
         yes           Std       2 FMN$AVR
 yes     yes           Std       1 NIO$QUE
 yes     yes           Std       1 NIQ$GET
 yes     yes           Std       1 NIQ$REL
 yes     yes           Std       3 OCZ$DEV_DCT
         yes           Std       1 FRZ$DSMT
 yes     yes           Std       1 FRL$AVREA
         yes           Std       1 FRC$WAKU
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:52   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     N$DCT$$                               N$FQ$                                 NI$FQ$
     NI$IBUF$                              NI$RP$                                FR$HD$
     FR_AMSGL                              FT_PROT                               B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:53   


      193        1        /*T***********************************************************/
      194        2        /*T*                                                         */
      195        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      196        4        /*T*                                                         */
      197        5        /*T***********************************************************/
      198        6           /**/
      199        7           /**/
      200        8        FRC$KEYIN: PROC (KMSG) ALTRET;

      8  1 000000   000000 700200 xent  FRC$KEYIN    TSX0  ! X66_AUTO_1
         1 000001   000026 000001                    ZERO    22,1

      201        9           /**/
      202       10           /**/
      203       11        %INCLUDE CP_6_SUBS;
      204      551        %INCLUDE FR$RAT;
      205      604        %FR$RAT (NAME=RAT,STCLASS="BASED(RAT$)");
      206      644        %INCLUDE N_FC_C;
      207      681        %INCLUDE NI_DATA_C;
      208      794        %INCLUDE NI_DATA_R;
      209     1231           %N$REQ;
      210     1289        %INCLUDE FR_DATA_R;
      211     1321        %INCLUDE JG_GHOSTS_C;
      212     1411        %INCLUDE OC_SUBS_C;
      213     2142        %INCLUDE NK_SUBS;
      214     2167        %INCLUDE FR_SUBS;
      215     2235        %INCLUDE FT_SUBS;
      216     2315        %INCLUDE FT$DDT;
      217     2376           /**/
      218     2377        %NI$DCT (NAME=DCT,STCLASS=BASED);
      219     2425           /**/
      220     2426           /**/
      221     2427    1   DCL 1 KMSG ALIGNED,
      222     2428    1         2 KIN# UBIN(18) UNAL,
      223     2429    1         2 CADDR BIT(18) UNAL,
      224     2430    1         2 SYSID UBIN(18) UNAL,
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:54   
      225     2431    1         2 SERN CHAR(6) UNAL,
      226     2432    1         2 DEV CHAR(8) UNAL,
      227     2433    1         2 DTW REDEF DEV UNAL,
      228     2434    1           3 D CHAR(4) UNAL,
      229     2435    1           3 TN REDEF D UNAL,
      230     2436    1             4 T CHAR(2) UNAL,
      231     2437    1             4 N CHAR(2) UNAL,
      232     2438    1           3 TW CHAR(4) UNAL;
      233     2439    1   DCL ANYLISTED SBIN WORD;
      234     2440    1   DCL 1 KERR ALIGNED,
      235     2441    1         2 CODE UBIN WORD,
      236     2442    1         2 SERN CHAR(6);
      237     2443    1   DCL EMSGL (0:1) UBIN BYTE UNAL CONSTANT INIT(4,6);
      238     2444    1   DCL 1 KDSP ALIGNED,
      239     2445    1         2 ASYD UBIN(18) UNAL,
      240     2446    1         2 SERN CHAR(6) UNAL,
      241     2447    1         2 STATE UNAL,
      242     2448    1           3 * BIT(4) UNAL,
      243     2449    1           3 SOLIC BIT(1) UNAL,
      244     2450    1           3 DOWN BIT(1) UNAL,
      245     2451    1           3 MBT BIT(3) UNAL,
      246     2452    1           3 MBTR REDEF MBT UNAL,
      247     2453    1             4 * BIT(2) UNAL,
      248     2454    1             4 UP BIT(1),
      249     2455    1         2 SYSID UBIN(18) UNAL;
      250     2456    1   DCL TMSGL (0:3) UBIN BYTE UNAL CONSTANT INIT(2,6,1,2);
      251     2457    1   DCL RAT$ PTR;
      252     2458    1   DCL DCTX UBIN WORD;
      253     2459    1   DCL MSG# UBIN WORD;
      254     2460    1   DCL IDCTX REDEF MSG# UBIN WORD;
      255     2461    1   DCL IOQ$ PTR;
      256     2462    1   DCL FT_PROT UBIN WORD SYMREF;
      257     2463    1   DCL FMN$AVR ENTRY(2);
      258     2464    1   DCL FRC$WAKU ENTRY(1);
      259     2465    1   DCL FRL$AVREA ENTRY(1) ALTRET;
      260     2466    1   DCL FRZ$DSMT ENTRY(1);
      261     2467    1   DCL NIO$QUE ENTRY(1) ALTRET;
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:55   
      262     2468    1   DCL NIQ$GET ENTRY(1) ALTRET;
      263     2469    1   DCL NIQ$REL ENTRY(1) ALTRET;
      264     2470    1   DCL OCZ$DEV_DCT ENTRY(3) ALTRET;
      265     2471    1   DCL OCI$MK_WR ENTRY(7);
      266     2472           /**/
      267     2473           /**/
      268     2474    2      IF KMSG.KIN# = KEY_TAPES# OR KMSG.KIN# = KEY_VOLUME# THEN DO;

   2474  1 000002   200003 470500                    LDP0    @KMSG,,AUTO
         1 000003   000000 220100                    LDX0    0,,PR0
         1 000004   000007 100003                    CMPX0   7,DU
         1 000005   000010 600000 1                  TZE     s:2475
         1 000006   000011 100003                    CMPX0   9,DU
         1 000007   000236 601000 1                  TNZ     s:2521

      269     2475    2         RAT$=FR$HD$(FR_MT);

   2475  1 000010   000001 236000 xsym               LDQ     FR$HD$+1
         1 000011   200013 756100                    STQ     RAT$,,AUTO

      270     2476    2         KDSP.STATE='0'B;

   2476  1 000012   000000 236003                    LDQ     0,DU
         1 000013   200012 552140                    STBQ    KDSP+2,'40'O,AUTO

      271     2477    2         IF KMSG.DTW.TN.T='DP' THEN RAT$=FR$HD$(FR_DP);

   2477  1 000014   000003 220100                    LDX0    3,,PR0
         1 000015   000002 100000 0                  CMPX0   TMSGL+1
         1 000016   000021 601000 1                  TNZ     s:2478

   2477  1 000017   000000 236000 xsym               LDQ     FR$HD$
         1 000020   200013 756100                    STQ     RAT$,,AUTO

      272     2478    3         IF KMSG.DTW.TN.N=' ' THEN DO;

   2478  1 000021   000003 721100                    LXL1    3,,PR0
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:56   
         1 000022   040040 101003                    CMPX1   16416,DU
         1 000023   000045 601000 1                  TNZ     s:2485

      273     2479    4            IF KMSG.DTW.TW~='0000' THEN DO;

   2479  1 000024   000004 236100                    LDQ     4,,PR0
         1 000025   000003 116000 0                  CMPQ    TMSGL+2
         1 000026   000043 600000 1                  TZE     s:2483

      274     2480    4               CALL OCI$MK_WR (KMSG.CADDR,NOTP_MSG#,0);

   2480  1 000027   000001 236000 2                  LDQ     1
         1 000030   200022 756100                    STQ     IOQ$+4,,AUTO
         1 000031   000002 236000 2                  LDQ     2
         1 000032   200021 756100                    STQ     IOQ$+3,,AUTO
         1 000033   200003 236100                    LDQ     @KMSG,,AUTO
         1 000034   400000 036007                    ADLQ    -131072,DL
         1 000035   200020 756100                    STQ     IOQ$+2,,AUTO
         1 000036   200020 630500                    EPPR0   IOQ$+2,,AUTO
         1 000037   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000040   000000 701000 xent               TSX1    OCI$MK_WR
         1 000041   000000 011000                    NOP     0

      275     2481    4               RETURN;

   2481  1 000042   000000 702200 xent               TSX2  ! X66_ARET

      276     2482    4               END;
      277     2483    3            IDCTX=0;

   2483  1 000043   200015 450100                    STZ     MSG#,,AUTO

      278     2484    3            END;

   2484  1 000044   000061 710000 1                  TRA     s:2486

      279     2485    2         ELSE CALL OCZ$DEV_DCT (KMSG.DEV,IDCTX,KMSG.CADDR) ALTRET (RET);
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:57   

   2485  1 000045   200003 236100                    LDQ     @KMSG,,AUTO
         1 000046   400000 036007                    ADLQ    -131072,DL
         1 000047   200022 756100                    STQ     IOQ$+4,,AUTO
         1 000050   200015 631500                    EPPR1   MSG#,,AUTO
         1 000051   200021 451500                    STP1    IOQ$+3,,AUTO
         1 000052   200003 236100                    LDQ     @KMSG,,AUTO
         1 000053   000003 036003                    ADLQ    3,DU
         1 000054   200020 756100                    STQ     IOQ$+2,,AUTO
         1 000055   200020 630500                    EPPR0   IOQ$+2,,AUTO
         1 000056   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000057   000000 701000 xent               TSX1    OCZ$DEV_DCT
         1 000060   000663 702000 1                  TSX2    RET

      280     2486    2         ANYLISTED = 0;

   2486  1 000061   200004 450100                    STZ     ANYLISTED,,AUTO

      281     2487    3         DO WHILE (RAT$~=ADDR(NIL));

   2487  1 000062   000207 710000 1                  TRA     s:2511

      282     2488    4            IF KMSG.KIN# ~= KEY_VOLUME# OR RAT.FLG.RUP OR RAT.FLG.MBIT.SOL OR IDCTX ~=
              2488                     0 THEN DO;

   2488  1 000063   200003 470500                    LDP0    @KMSG,,AUTO
         1 000064   000000 220100                    LDX0    0,,PR0
         1 000065   000011 100003                    CMPX0   9,DU
         1 000066   000077 601000 1                  TNZ     s:2489
         1 000067   200013 471500                    LDP1    RAT$,,AUTO
         1 000070   100010 236100                    LDQ     8,,PR1
         1 000071   000004 316007                    CANQ    4,DL
         1 000072   000077 601000 1                  TNZ     s:2489
         1 000073   000100 316007                    CANQ    64,DL
         1 000074   000077 601000 1                  TNZ     s:2489
         1 000075   200015 235100                    LDA     MSG#,,AUTO
         1 000076   000204 600000 1                  TZE     s:2510
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:58   

      283     2489    5               IF IDCTX=0 OR IDCTX=RAT.DCTX THEN DO;

   2489  1 000077   200015 235100                    LDA     MSG#,,AUTO
         1 000100   000106 600000 1                  TZE     s:2490
         1 000101   200013 471500                    LDP1    RAT$,,AUTO
         1 000102   100003 236100                    LDQ     3,,PR1
         1 000103   777777 376007                    ANQ     -1,DL
         1 000104   200015 116100                    CMPQ    MSG#,,AUTO
         1 000105   000204 601000 1                  TNZ     s:2510

      284     2490    6                  IF RAT.FLG.MBIT.SOL AND RAT.FLG.RUP='0'B THEN DO;

   2490  1 000106   200013 471500                    LDP1    RAT$,,AUTO
         1 000107   100010 236100                    LDQ     8,,PR1
         1 000110   000100 316007                    CANQ    64,DL
         1 000111   000124 600000 1                  TZE     s:2496
         1 000112   000004 316007                    CANQ    4,DL
         1 000113   000124 601000 1                  TNZ     s:2496

      285     2491    6                     KDSP.ASYD=RAT.RES.SISID;

   2491  1 000114   100001 221100                    LDX1    1,,PR1
         1 000115   200010 741100                    STX1    KDSP,,AUTO

      286     2492    6                     KDSP.SERN=RAT.SSER;

   2492  1 000116   040100 100500                    MLR     fill='040'O
         1 000117   100006 400006                    ADSC9   6,,PR1                   cn=2,n=6
         1 000120   200010 400006                    ADSC9   KDSP,,AUTO               cn=2,n=6

      287     2493    6                     KDSP.STATE.SOLIC = '1'B;

   2493  1 000121   020000 236003                    LDQ     8192,DU
         1 000122   200012 256100                    ORSQ    KDSP+2,,AUTO

      288     2494    6                     END;
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:59   

   2494  1 000123   000133 710000 1                  TRA     s:2500

      289     2495    6                  ELSE DO;

      290     2496    6                     KDSP.ASYD=RAT.REEL.ASID;

   2496  1 000124   100004 221100                    LDX1    4,,PR1
         1 000125   200010 741100                    STX1    KDSP,,AUTO

      291     2497    6                     KDSP.SERN=RAT.REEL.SER;

   2497  1 000126   040100 100500                    MLR     fill='040'O
         1 000127   100004 400006                    ADSC9   4,,PR1                   cn=2,n=6
         1 000130   200010 400006                    ADSC9   KDSP,,AUTO               cn=2,n=6

      292     2498    6                     KDSP.STATE.SOLIC = '0'B;

   2498  1 000131   000003 236000 2                  LDQ     3
         1 000132   200012 356100                    ANSQ    KDSP+2,,AUTO

      293     2499    6                     END;

      294     2500    5                  KDSP.SYSID=RAT.RES.SISID;

   2500  1 000133   100001 236100                    LDQ     1,,PR1
         1 000134   000011 772000                    QRL     9
         1 000135   200012 552130                    STBQ    KDSP+2,'30'O,AUTO

      295     2501    5                  KDSP.STATE.MBT=RAT.FLG.MBIT;

   2501  1 000136   100010 236100                    LDQ     8,,PR1
         1 000137   000025 736000                    QLS     21
         1 000140   200012 676100                    ERQ     KDSP+2,,AUTO
         1 000141   007000 376003                    ANQ     3584,DU
         1 000142   200012 656100                    ERSQ    KDSP+2,,AUTO

PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:60   
      296     2502    5                  KDSP.STATE.MBTR.UP=RAT.FLG.RUP;

   2502  1 000143   100010 236100                    LDQ     8,,PR1
         1 000144   000031 736000                    QLS     25
         1 000145   200012 676100                    ERQ     KDSP+2,,AUTO
         1 000146   001000 376003                    ANQ     512,DU
         1 000147   200012 656100                    ERSQ    KDSP+2,,AUTO

      297     2503    5                  KDSP.STATE.DOWN=RAT.FLG.DOWN;

   2503  1 000150   100010 236100                    LDQ     8,,PR1
         1 000151   000035 736000                    QLS     29
         1 000152   200012 676100                    ERQ     KDSP+2,,AUTO
         1 000153   010000 376003                    ANQ     4096,DU
         1 000154   200012 656100                    ERSQ    KDSP+2,,AUTO

      298     2504    5                  DCTX=RAT.DCTX;

   2504  1 000155   100003 236100                    LDQ     3,,PR1
         1 000156   777777 376007                    ANQ     -1,DL
         1 000157   200014 756100                    STQ     DCTX,,AUTO

      299     2505    5                 CALL OCI$MK_WR (KMSG.CADDR,DSTP_MSG#,LENGTHC(TMSGL),TMSGL,KDSP,DCTX);

   2505  1 000160   200014 633500                    EPPR3   DCTX,,AUTO
         1 000161   200025 453500                    STP3    IOQ$+7,,AUTO
         1 000162   200010 634500                    EPPR4   KDSP,,AUTO
         1 000163   200024 454500                    STP4    IOQ$+6,,AUTO
         1 000164   000006 237000 2                  LDAQ    6
         1 000165   200022 757100                    STAQ    IOQ$+4,,AUTO
         1 000166   000005 236000 2                  LDQ     5
         1 000167   200021 756100                    STQ     IOQ$+3,,AUTO
         1 000170   200003 236100                    LDQ     @KMSG,,AUTO
         1 000171   400000 036007                    ADLQ    -131072,DL
         1 000172   200020 756100                    STQ     IOQ$+2,,AUTO
         1 000173   200020 630500                    EPPR0   IOQ$+2,,AUTO
         1 000174   000024 631400 xsym               EPPR1   B_VECTNIL+20
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:61   
         1 000175   000000 701000 xent               TSX1    OCI$MK_WR
         1 000176   000000 011000                    NOP     0

      300     2506    5                  ANYLISTED = 1;

   2506  1 000177   000001 235007                    LDA     1,DL
         1 000200   200004 755100                    STA     ANYLISTED,,AUTO

      301     2507    5                  IF IDCTX~=0 THEN RETURN;

   2507  1 000201   200015 236100                    LDQ     MSG#,,AUTO
         1 000202   000204 600000 1                  TZE     s:2510

   2507  1 000203   000000 702200 xent               TSX2  ! X66_ARET

      302     2508    5                  END;
      303     2509    4               END;
      304     2510    3            RAT$=RAT.LNK$;

   2510  1 000204   200013 470500                    LDP0    RAT$,,AUTO
         1 000205   000000 236100                    LDQ     0,,PR0
         1 000206   200013 756100                    STQ     RAT$,,AUTO

      305     2511    3            END;

   2511  1 000207   200013 236100                    LDQ     RAT$,,AUTO
         1 000210   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000211   000063 601000 1                  TNZ     s:2488

      306     2512    3         IF IDCTX~=0 THEN DO;

   2512  1 000212   200015 235100                    LDA     MSG#,,AUTO
         1 000213   000216 600000 1                  TZE     s:2516

      307     2513    3            DCTX=IDCTX;

   2513  1 000214   200014 755100                    STA     DCTX,,AUTO
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:62   

      308     2514    3            GOTO BDDEV;

   2514  1 000215   000301 710000 1                  TRA     BDDEV

      309     2515    3            END;
      310     2516    3         IF ANYLISTED = 0 THEN DO;

   2516  1 000216   200004 235100                    LDA     ANYLISTED,,AUTO
         1 000217   000235 601000 1                  TNZ     s:2519

      311     2517    3            CALL OCI$MK_WR(KMSG.CADDR,NVOL_MSG#,0,0,0);

   2517  1 000220   000001 236000 2                  LDQ     1
         1 000221   200024 756100                    STQ     IOQ$+6,,AUTO
         1 000222   000012 237000 2                  LDAQ    10
         1 000223   200022 757100                    STAQ    IOQ$+4,,AUTO
         1 000224   000011 236000 2                  LDQ     9
         1 000225   200021 756100                    STQ     IOQ$+3,,AUTO
         1 000226   200003 236100                    LDQ     @KMSG,,AUTO
         1 000227   400000 036007                    ADLQ    -131072,DL
         1 000230   200020 756100                    STQ     IOQ$+2,,AUTO
         1 000231   200020 630500                    EPPR0   IOQ$+2,,AUTO
         1 000232   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 000233   000000 701000 xent               TSX1    OCI$MK_WR
         1 000234   000000 011000                    NOP     0

      312     2518    3            END;

      313     2519    2         RETURN;

   2519  1 000235   000000 702200 xent               TSX2  ! X66_ARET

      314     2520    2         END;
      315     2521    1      CALL OCZ$DEV_DCT (KMSG.DEV,DCTX,KMSG.CADDR) ALTRET (RET);

   2521  1 000236   200003 236100                    LDQ     @KMSG,,AUTO
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:63   
         1 000237   400000 036007                    ADLQ    -131072,DL
         1 000240   200022 756100                    STQ     IOQ$+4,,AUTO
         1 000241   200014 631500                    EPPR1   DCTX,,AUTO
         1 000242   200021 451500                    STP1    IOQ$+3,,AUTO
         1 000243   200003 236100                    LDQ     @KMSG,,AUTO
         1 000244   000003 036003                    ADLQ    3,DU
         1 000245   200020 756100                    STQ     IOQ$+2,,AUTO
         1 000246   200020 630500                    EPPR0   IOQ$+2,,AUTO
         1 000247   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000250   000000 701000 xent               TSX1    OCZ$DEV_DCT
         1 000251   000663 702000 1                  TSX2    RET

      316     2522    1      RAT$=N$DCT$(DCTX)->DCT.RAT$;

   2522  1 000252   000000 470400 xsym               LDP0    N$DCT$$
         1 000253   200014 720100                    LXL0    DCTX,,AUTO
         1 000254   000000 471510                    LDP1    0,X0,PR0
         1 000255   100005 236100                    LDQ     5,,PR1
         1 000256   200013 756100                    STQ     RAT$,,AUTO

      317     2523    1      IF RAT$=ADDR(NIL) THEN GOTO BDDEV;

   2523  1 000257   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000260   000301 600000 1                  TZE     BDDEV

      318     2524    1      IF RAT.RCOD~=FR_MT

   2524  1 000261   200013 473500                    LDP3    RAT$,,AUTO
         1 000262   300003 236100                    LDQ     3,,PR3
         1 000263   000740 376003                    ANQ     480,DU
         1 000264   000040 116003                    CMPQ    32,DU
         1 000265   000304 600000 1                  TZE     s:2534
         1 000266   300003 236100                    LDQ     3,,PR3
         1 000267   000740 316003                    CANQ    480,DU
         1 000270   000301 601000 1                  TNZ     BDDEV
         1 000271   200003 474500                    LDP4    @KMSG,,AUTO
         1 000272   400000 221100                    LDX1    0,,PR4
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:64   
         1 000273   000003 101003                    CMPX1   3,DU
         1 000274   000304 600000 1                  TZE     s:2534
         1 000275   000006 101003                    CMPX1   6,DU
         1 000276   000304 600000 1                  TZE     s:2534
         1 000277   000002 101003                    CMPX1   2,DU
         1 000300   000304 600000 1                  TZE     s:2534

      319     2525    1        AND (RAT.RCOD~=FR_DP
      320     2526    1        OR KMSG.KIN#~=KEY_REQUEST#
      321     2527    1        AND KMSG.KIN#~=KEY_CANTMOUNT#
      322     2528    1        AND KMSG.KIN#~=KEY_MOUNT#)
      323     2529    2      THEN DO;

   2528  1 000301                       BDDEV        null
      324     2530    2   BDDEV: ;
      325     2531    2         KERR.CODE=FRKE_NTP;

   2531  1 000301   000007 235007                    LDA     7,DL
         1 000302   200005 755100                    STA     KERR,,AUTO

      326     2532    2         GOTO ERRXIT;

   2532  1 000303   000674 710000 1                  TRA     ERRXIT

      327     2533    2         END;
      328     2534    2      IF RAT.FLG.DOWN THEN DO;

   2534  1 000304   300010 236100                    LDQ     8,,PR3
         1 000305   000002 316007                    CANQ    2,DL
         1 000306   000312 600000 1                  TZE     s:2538

      329     2535    2         KERR.CODE=FRKE_TDN;

   2535  1 000307   000010 235007                    LDA     8,DL
         1 000310   200005 755100                    STA     KERR,,AUTO

      330     2536    2         GOTO ERRXIT;
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:65   

   2536  1 000311   000674 710000 1                  TRA     ERRXIT

      331     2537    2         END;
      332     2538    1      IF RAT.FLG.RUP='0'B

   2538  1 000312   000004 316007                    CANQ    4,DL
         1 000313   000340 601000 1                  TNZ     s:2551
         1 000314   200003 474500                    LDP4    @KMSG,,AUTO
         1 000315   400000 221100                    LDX1    0,,PR4
         1 000316   000001 101003                    CMPX1   1,DU
         1 000317   000340 600000 1                  TZE     s:2551
         1 000320   000006 101003                    CMPX1   6,DU
         1 000321   000340 600000 1                  TZE     s:2551
         1 000322   000010 101003                    CMPX1   8,DU
         1 000323   000340 600000 1                  TZE     s:2551

      333     2539    1        AND KMSG.KIN# ~= KEY_RESERVE#
      334     2540    1        AND KMSG.KIN# ~= KEY_CANTMOUNT#
      335     2541    1        AND KMSG.KIN# ~= KEY_LOAD#
      336     2542    2      THEN DO;

      337     2543    2         IF KMSG.KIN# = KEY_REQUEST#

   2543  1 000324   000003 101003                    CMPX1   3,DU
         1 000325   000335 601000 1                  TNZ     s:2548
         1 000326   300003 236100                    LDQ     3,,PR3
         1 000327   000740 376003                    ANQ     480,DU
         1 000330   000040 116003                    CMPQ    32,DU
         1 000331   000335 601000 1                  TNZ     s:2548

      338     2544    2           AND RAT.RCOD = FR_MT
      339     2545    3         THEN DO; /* REQUEST MT with no reel up...clear DDT SOLICIT */

      340     2546    3            N$DCT$(DCTX)->DCT.DDT$->FT$DDT.SOLICIT = 0;

   2546  1 000332   100004 475500                    LDP5    4,,PR1
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:66   
         1 000333   000014 236000 2                  LDQ     12
         1 000334   500006 356100                    ANSQ    6,,PR5

      341     2547    3            END;

      342     2548    2         KERR.CODE=FRKE_NMT;

   2548  1 000335   000005 235007                    LDA     5,DL
         1 000336   200005 755100                    STA     KERR,,AUTO

      343     2549    2         GOTO ERRXIT;

   2549  1 000337   000674 710000 1                  TRA     ERRXIT

      344     2550    2         END;
      345     2551    1      IF RAT.FLG.MBIT.MTD

   2551  1 000340   000400 316007                    CANQ    256,DL
         1 000341   000351 601000 1                  TNZ     s:2554
         1 000342   300004 221100                    LDX1    4,,PR3
         1 000343   000002 101003                    CMPX1   2,DU
         1 000344   000354 601000 1                  TNZ     s:2557
         1 000345   200003 474500                    LDP4    @KMSG,,AUTO
         1 000346   400000 222100                    LDX2    0,,PR4
         1 000347   000003 102003                    CMPX2   3,DU
         1 000350   000354 600000 1                  TZE     s:2557

      346     2552    1        OR (RAT.REEL.ASID = JG_KEYIN# AND KMSG.KIN# ~= KEY_REQUEST#)
      347     2553    2      THEN DO;

      348     2554    2         KERR.CODE=FRKE_INU;

   2554  1 000351   000001 235007                    LDA     1,DL
         1 000352   200005 755100                    STA     KERR,,AUTO

      349     2555    2         GOTO ERRXIT;

PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:67   
   2555  1 000353   000674 710000 1                  TRA     ERRXIT

      350     2556    2         END;
      351     2557    2      DO CASE (KMSG.KIN#);

   2557  1 000354   200003 474500                    LDP4    @KMSG,,AUTO
         1 000355   400000 222100                    LDX2    0,,PR4
         1 000356   000011 102003                    CMPX2   9,DU
         1 000357   000361 602012 1                  TNC     s:2557+5,X2
         1 000360   000635 710000 1                  TRA     s:2633
         1 000361   000635 710000 1                  TRA     s:2633
         1 000362   000540 710000 1                  TRA     s:2606
         1 000363   000372 710000 1                  TRA     s:2559
         1 000364   000503 710000 1                  TRA     s:2597
         1 000365   000447 710000 1                  TRA     s:2579
         1 000366   000423 710000 1                  TRA     s:2571
         1 000367   000471 710000 1                  TRA     s:2589
         1 000370   000635 710000 1                  TRA     s:2633
         1 000371   000561 710000 1                  TRA     s:2613

      352     2558    2      CASE (KEY_MOUNT#);

      353     2559    3         IF KMSG.SERN~=RAT.REEL.SER THEN DO;

   2559  1 000372   040100 106500                    CMPC    fill='040'O
         1 000373   400001 400006                    ADSC9   1,,PR4                   cn=2,n=6
         1 000374   300004 400006                    ADSC9   4,,PR3                   cn=2,n=6
         1 000375   000416 600000 1                  TZE     s:2568

      354     2560    3            IF RAT.FLG.MBIT.MTSC='0'B AND FT_PROT~=FT_UNPROT#

   2560  1 000376   000200 316007                    CANQ    128,DL
         1 000377   000402 601000 1                  TNZ     s:2560+4
         1 000400   000000 235000 xsym               LDA     FT_PROT
         1 000401   000405 601000 1                  TNZ     s:2562
         1 000402   300003 236100                    LDQ     3,,PR3
         1 000403   000740 316003                    CANQ    480,DU
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:68   
         1 000404   000413 601000 1                  TNZ     s:2566

      355     2561    4              OR RAT.RCOD = FR_DP THEN DO;

      356     2562    4               KERR.CODE=FRKE_MTD;

   2562  1 000405   000002 235007                    LDA     2,DL
         1 000406   200005 755100                    STA     KERR,,AUTO

      357     2563    4               KERR.SERN=RAT.REEL.SER;

   2563  1 000407   040100 100500                    MLR     fill='040'O
         1 000410   300004 400006                    ADSC9   4,,PR3                   cn=2,n=6
         1 000411   200006 000006                    ADSC9   KERR+1,,AUTO             cn=0,n=6

      358     2564    4               GOTO ERRXIT;

   2564  1 000412   000674 710000 1                  TRA     ERRXIT

      359     2565    4               END;
      360     2566    3            RAT.REEL.SER=KMSG.SERN;

   2566  1 000413   040100 100500                    MLR     fill='040'O
         1 000414   400001 400006                    ADSC9   1,,PR4                   cn=2,n=6
         1 000415   300004 400006                    ADSC9   4,,PR3                   cn=2,n=6

      361     2567    3            END;

      362     2568    2         RAT.FLG.MBIT.MTSC='0'B;

   2568  1 000416   000015 236000 2                  LDQ     13
         1 000417   300010 356100                    ANSQ    8,,PR3

      363     2569    2         MSG#=MNTD_MSG#;

   2569  1 000420   000030 235007                    LDA     24,DL
         1 000421   200015 755100                    STA     MSG#,,AUTO
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:69   
         1 000422   000636 710000 1                  TRA     s:2635

      364     2570    2      CASE (KEY_ANSCRATCH#);

      365     2571    2         IF FT_PROT=FT_UNPROT# THEN RAT.FLG.MBIT.MTSC='1'B;

   2571  1 000423   000000 235000 xsym               LDA     FT_PROT
         1 000424   000430 601000 1                  TNZ     s:2572

   2571  1 000425   000200 236007                    LDQ     128,DL
         1 000426   300010 256100                    ORSQ    8,,PR3
         1 000427   000435 710000 1                  TRA     s:2576

      366     2572    3         ELSE IF RAT.FLG.MBIT.MTSC='0'B THEN DO;

   2572  1 000430   000200 316007                    CANQ    128,DL
         1 000431   000435 601000 1                  TNZ     s:2576

      367     2573    3               KERR.CODE=FRKE_NAS;

   2573  1 000432   000004 235007                    LDA     4,DL
         1 000433   200005 755100                    STA     KERR,,AUTO

      368     2574    3               GOTO ERRXIT;

   2574  1 000434   000674 710000 1                  TRA     ERRXIT

      369     2575    3               END;
      370     2576    2         IF KMSG.SERN~=' ' THEN RAT.REEL.SER=KMSG.SERN;

   2576  1 000435   040000 106500                    CMPC    fill='040'O
         1 000436   400001 400006                    ADSC9   1,,PR4                   cn=2,n=6
         1 000437   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000440   000444 600000 1                  TZE     s:2577

   2576  1 000441   040100 100500                    MLR     fill='040'O
         1 000442   400001 400006                    ADSC9   1,,PR4                   cn=2,n=6
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:70   
         1 000443   300004 400006                    ADSC9   4,,PR3                   cn=2,n=6

      371     2577    2         MSG#=ANSC_MSG#;

   2577  1 000444   000031 236007                    LDQ     25,DL
         1 000445   200015 756100                    STQ     MSG#,,AUTO
         1 000446   000636 710000 1                  TRA     s:2635

      372     2578    2      CASE (KEY_SCRATCH#);

      373     2579    3         IF FT_PROT=FT_UNPROT# THEN DO;

   2579  1 000447   000000 235000 xsym               LDA     FT_PROT
         1 000450   000457 601000 1                  TNZ     s:2583

      374     2580    3            RAT.REEL.SER=' ';

   2580  1 000451   040100 100400                    MLR     fill='040'O
         1 000452   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000453   300004 400006                    ADSC9   4,,PR3                   cn=2,n=6

      375     2581    3            RAT.FLG.MBIT.MTSC='1'B;

   2581  1 000454   000200 236007                    LDQ     128,DL
         1 000455   300010 256100                    ORSQ    8,,PR3

      376     2582    3            END;

   2582  1 000456   000466 710000 1                  TRA     s:2587

      377     2583    3         ELSE IF RAT.REEL.SER~=' ' THEN DO;

   2583  1 000457   040000 106500                    CMPC    fill='040'O
         1 000460   300004 400006                    ADSC9   4,,PR3                   cn=2,n=6
         1 000461   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000462   000466 600000 1                  TZE     s:2587

PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:71   
      378     2584    3               KERR.CODE=FRKE_NSC;

   2584  1 000463   000003 235007                    LDA     3,DL
         1 000464   200005 755100                    STA     KERR,,AUTO

      379     2585    3               GOTO ERRXIT;

   2585  1 000465   000674 710000 1                  TRA     ERRXIT

      380     2586    3               END;
      381     2587    2         MSG#=MNTD_MSG#;

   2587  1 000466   000030 236007                    LDQ     24,DL
         1 000467   200015 756100                    STQ     MSG#,,AUTO
         1 000470   000636 710000 1                  TRA     s:2635

      382     2588    2      CASE (KEY_CANTMOUNT#);

      383     2589    3         IF RAT.FLG.MBIT.SOL='0'B THEN DO;

   2589  1 000471   000100 316007                    CANQ    64,DL
         1 000472   000476 601000 1                  TNZ     s:2593

      384     2590    3            KERR.CODE=FRKE_NMP;

   2590  1 000473   000006 235007                    LDA     6,DL
         1 000474   200005 755100                    STA     KERR,,AUTO

      385     2591    3            GOTO ERRXIT;

   2591  1 000475   000674 710000 1                  TRA     ERRXIT

      386     2592    3            END;
      387     2593    2         RAT.RES.RFLG.CANT='1'B;

   2593  1 000476   004000 236003                    LDQ     2048,DU
         1 000477   300003 256100                    ORSQ    3,,PR3
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:72   

      388     2594    2         RAT.REEL.ASID=0;

   2594  1 000500   000000 220003                    LDX0    0,DU
         1 000501   300004 740100                    STX0    4,,PR3

      389     2595    2         GOTO NOMSG;

   2595  1 000502   000657 710000 1                  TRA     NOMSG

      390     2596    2      CASE (KEY_REQUEST#);

      391     2597    2         CALL FRZ$DSMT (RAT);

   2597  1 000503   200013 630500                    EPPR0   RAT$,,AUTO
         1 000504   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000505   000000 701000 xent               TSX1    FRZ$DSMT
         1 000506   000000 011000                    NOP     0

      392     2598    2         IF NOT RAT.FLG.FORM

   2598  1 000507   200013 470500                    LDP0    RAT$,,AUTO
         1 000510   000010 236100                    LDQ     8,,PR0
         1 000511   000010 316007                    CANQ    8,DL
         1 000512   000537 601000 1                  TNZ     s:2604
         1 000513   000003 236100                    LDQ     3,,PR0
         1 000514   000740 316003                    CANQ    480,DU
         1 000515   000537 601000 1                  TNZ     s:2604
         1 000516   000006 220100                    LDX0    6,,PR0
         1 000517   167000 360003                    ANX0    60928,DU
         1 000520   000537 600000 1                  TZE     s:2604

      393     2599    2           AND RAT.RCOD = FR_DP
      394     2600    2           AND RAT.M1&%(ATTR_DD600#|ATTR_DD500#|ATTR_DD1000#|ATTR_DD1500#|
      395     2601    2           ATTR_DD400#|ATTR_DD1100#)
      396     2602    2         THEN
      397     2603    2            CALL FMN$AVR( BINBIT(RAT.DCTX,15) , %NI_AVR_PART );
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:73   

   2603  1 000521   000003 236100                    LDQ     3,,PR0
         1 000522   777777 376007                    ANQ     -1,DL
         1 000523   000025 736000                    QLS     21
         1 000524   200020 676100                    ERQ     IOQ$+2,,AUTO
         1 000525   777770 376003                    ANQ     -8,DU
         1 000526   200020 656100                    ERSQ    IOQ$+2,,AUTO
         1 000527   000016 236000 2                  LDQ     14
         1 000530   200023 756100                    STQ     IOQ$+5,,AUTO
         1 000531   200020 631500                    EPPR1   IOQ$+2,,AUTO
         1 000532   200022 451500                    STP1    IOQ$+4,,AUTO
         1 000533   200022 630500                    EPPR0   IOQ$+4,,AUTO
         1 000534   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000535   000000 701000 xent               TSX1    FMN$AVR
         1 000536   000000 011000                    NOP     0

      398     2604    2         RETURN;

   2604  1 000537   000000 702200 xent               TSX2  ! X66_ARET

      399     2605    2      CASE (KEY_RESERVE#);

      400     2606    3         IF RAT.FLG.RUP='0'B THEN DO;

   2606  1 000540   000004 316007                    CANQ    4,DL
         1 000541   000545 601000 1                  TNZ     s:2610

      401     2607    3            RAT.REEL.ASID=KMSG.SYSID;

   2607  1 000542   400001 223100                    LDX3    1,,PR4
         1 000543   300004 743100                    STX3    4,,PR3

      402     2608    3            RETURN;

   2608  1 000544   000000 702200 xent               TSX2  ! X66_ARET

      403     2609    3            END;
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:74   
      404     2610    2         IF RAT.REEL.SER~=' ' AND RAT.FLG.MBIT.MTSC THEN MSG#=ANSC_MSG#;

   2610  1 000545   040000 106500                    CMPC    fill='040'O
         1 000546   300004 400006                    ADSC9   4,,PR3                   cn=2,n=6
         1 000547   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000550   000556 600000 1                  TZE     s:2611
         1 000551   000200 316007                    CANQ    128,DL
         1 000552   000556 600000 1                  TZE     s:2611

   2610  1 000553   000031 235007                    LDA     25,DL
         1 000554   200015 755100                    STA     MSG#,,AUTO
         1 000555   000636 710000 1                  TRA     s:2635

      405     2611    2         ELSE MSG#=MNTD_MSG#;

   2611  1 000556   000030 235007                    LDA     24,DL
         1 000557   200015 755100                    STA     MSG#,,AUTO
         1 000560   000636 710000 1                  TRA     s:2635

      406     2612    2      CASE (KEY_LOAD#); /* LOAD keyin                         */

      407     2613    2         IF RAT.FLG.RUP

   2613  1 000561   000004 316007                    CANQ    4,DL
         1 000562   000566 600000 1                  TZE     s:2618

      408     2614    3         THEN DO; /* Reel already up                    */

      409     2615    3            KERR.CODE = FRKE_ARL;

   2615  1 000563   000011 235007                    LDA     9,DL
         1 000564   200005 755100                    STA     KERR,,AUTO

      410     2616    3            GOTO ERRXIT;

   2616  1 000565   000674 710000 1                  TRA     ERRXIT

PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:75   
      411     2617    3            END;
      412     2618    2         IF N$DCT$(DCTX)->DCT.DDT$->FT$DDT.SOLICIT = FT_AVRSOL#

   2618  1 000566   100004 475500                    LDP5    4,,PR1
         1 000567   500006 236100                    LDQ     6,,PR5
         1 000570   000007 376007                    ANQ     7,DL
         1 000571   000004 116007                    CMPQ    4,DL
         1 000572   000576 601000 1                  TNZ     s:2623

      413     2619    3         THEN DO; /* Already AVRing                     */

      414     2620    3            KERR.CODE = FRKE_AAR;

   2620  1 000573   000012 235007                    LDA     10,DL
         1 000574   200005 755100                    STA     KERR,,AUTO

      415     2621    3            GOTO ERRXIT;

   2621  1 000575   000674 710000 1                  TRA     ERRXIT

      416     2622    3            END;
      417     2623    2         CALL NIQ$GET(IOQ$) ALTRET(CNTLOAD);

   2623  1 000576   200016 636500                    EPPR6   IOQ$,,AUTO
         1 000577   200020 456500                    STP6    IOQ$+2,,AUTO
         1 000600   200020 630500                    EPPR0   IOQ$+2,,AUTO
         1 000601   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000602   000000 701000 xent               TSX1    NIQ$GET
         1 000603   000672 702000 1                  TSX2    CNTLOAD

      418     2624    2         IOQ$->N$REQ.DLA.DCTX = RAT.DCTX;

   2624  1 000604   200016 470500                    LDP0    IOQ$,,AUTO
         1 000605   200013 471500                    LDP1    RAT$,,AUTO
         1 000606   100003 236100                    LDQ     3,,PR1
         1 000607   000025 736000                    QLS     21
         1 000610   000001 676100                    ERQ     1,,PR0
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:76   
         1 000611   777770 376003                    ANQ     -8,DU
         1 000612   000001 656100                    ERSQ    1,,PR0

      419     2625    2         IOQ$->N$REQ.FC = %N_RQSTAT;

   2625  1 000613   200016 470500                    LDP0    IOQ$,,AUTO
         1 000614   000001 236007                    LDQ     1,DL
         1 000615   000003 552104                    STBQ    3,'04'O,PR0

      420     2626    2         IOQ$->N$REQ.OPFLG.EA = '1'B;

   2626  1 000616   200016 470500                    LDP0    IOQ$,,AUTO
         1 000617   000040 236007                    LDQ     32,DL
         1 000620   000004 256100                    ORSQ    4,,PR0

      421     2627    2         IOQ$->N$REQ.EAENTRY = ENTADDR(FRL$AVREA);
              2627                  /* Knows what to do about such things */

   2627  1 000621   000000 636000 xent               EAQ     FRL$AVREA
         1 000622   200016 470500                    LDP0    IOQ$,,AUTO
         1 000623   000023 756100                    STQ     19,,PR0

      422     2628    2         IOQ$->N$REQ.EAINFO = FRL_LOADTAPE#;

   2628  1 000624   000017 235007                    LDA     15,DL
         1 000625   000024 755100                    STA     20,,PR0

      423     2629    2         IOQ$->N$REQ.OPFLG.HOLD = '1'B;

   2629  1 000626   000004 236007                    LDQ     4,DL
         1 000627   000004 256100                    ORSQ    4,,PR0

      424     2630    2         CALL NIO$QUE(IOQ$->N$REQ) ALTRET(CNTLOADR);

   2630  1 000630   200016 630500                    EPPR0   IOQ$,,AUTO
         1 000631   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000632   000000 701000 xent               TSX1    NIO$QUE
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:77   
         1 000633   000664 702000 1                  TSX2    CNTLOADR

      425     2631    2         RETURN;

   2631  1 000634   000000 702200 xent               TSX2  ! X66_ARET

      426     2632    2      CASE (ELSE);

      427     2633    2         ALTRETURN;

   2633  1 000635   000000 702200 xent               TSX2  ! X66_AALT

      428     2634    2      END;

      429     2635    1      RAT.REEL.ASID=KMSG.SYSID;

   2635  1 000636   400001 220100                    LDX0    1,,PR4
         1 000637   300004 740100                    STX0    4,,PR3

      430     2636    1      CALL OCI$MK_WR (M_TAPE,MSG#,LENGTHC(FR_AMSGL),FR_AMSGL,RAT.REEL,DCTX);

   2636  1 000640   200014 631500                    EPPR1   DCTX,,AUTO
         1 000641   200025 451500                    STP1    IOQ$+7,,AUTO
         1 000642   200013 236100                    LDQ     RAT$,,AUTO
         1 000643   000004 036003                    ADLQ    4,DU
         1 000644   200024 756100                    STQ     IOQ$+6,,AUTO
         1 000645   000020 237000 2                  LDAQ    16
         1 000646   200022 757100                    STAQ    IOQ$+4,,AUTO
         1 000647   200015 635500                    EPPR5   MSG#,,AUTO
         1 000650   200021 455500                    STP5    IOQ$+3,,AUTO
         1 000651   000022 236000 2                  LDQ     18
         1 000652   200020 756100                    STQ     IOQ$+2,,AUTO
         1 000653   200020 630500                    EPPR0   IOQ$+2,,AUTO
         1 000654   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 000655   000000 701000 xent               TSX1    OCI$MK_WR
         1 000656   000000 011000                    NOP     0

PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:78   
   2635  1 000657                       NOMSG        null
      431     2637    1   NOMSG: ;
      432     2638    1      CALL FRC$WAKU (RAT);

   2638  1 000657   200013 630500                    EPPR0   RAT$,,AUTO
         1 000660   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000661   000000 701000 xent               TSX1    FRC$WAKU
         1 000662   000000 011000                    NOP     0

   2635  1 000663                       RET          null
      433     2639    1   RET: ;
      434     2640    1      RETURN;

   2640  1 000663   000000 702200 xent               TSX2  ! X66_ARET

   2635  1 000664                       CNTLOADR     null
      435     2641    1   CNTLOADR: ;
      436     2642    1      CALL NIQ$REL(IOQ$) ALTRET(CNTLOAD);

   2642  1 000664   200016 630500                    EPPR0   IOQ$,,AUTO
         1 000665   200020 450500                    STP0    IOQ$+2,,AUTO
         1 000666   200020 630500                    EPPR0   IOQ$+2,,AUTO
         1 000667   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000670   000000 701000 xent               TSX1    NIQ$REL
         1 000671   000672 702000 1                  TSX2    CNTLOAD

   2642  1 000672                       CNTLOAD      null
      437     2643    1   CNTLOAD: ;
      438     2644    1      KERR.CODE = FRKE_CNL;

   2644  1 000672   000013 235007                    LDA     11,DL
         1 000673   200005 755100                    STA     KERR,,AUTO

   2644  1 000674                       ERRXIT       null
      439     2645    1   ERRXIT: ;
      440     2646    1      CALL OCI$MK_WR (KMSG.CADDR,BADMT_MSG#,LENGTHC(EMSGL),EMSGL,KERR,DCTX);

PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:79   
   2646  1 000674   200014 630500                    EPPR0   DCTX,,AUTO
         1 000675   200025 450500                    STP0    IOQ$+7,,AUTO
         1 000676   200005 631500                    EPPR1   KERR,,AUTO
         1 000677   200024 451500                    STP1    IOQ$+6,,AUTO
         1 000700   000024 237000 2                  LDAQ    20
         1 000701   200022 757100                    STAQ    IOQ$+4,,AUTO
         1 000702   000026 236000 2                  LDQ     22
         1 000703   200021 756100                    STQ     IOQ$+3,,AUTO
         1 000704   200003 236100                    LDQ     @KMSG,,AUTO
         1 000705   400000 036007                    ADLQ    -131072,DL
         1 000706   200020 756100                    STQ     IOQ$+2,,AUTO
         1 000707   200020 630500                    EPPR0   IOQ$+2,,AUTO
         1 000710   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 000711   000000 701000 xent               TSX1    OCI$MK_WR
         1 000712   000000 011000                    NOP     0

      441     2647    1      RETURN;

   2647  1 000713   000000 702200 xent               TSX2  ! X66_ARET

EMSGL
 Sect OctLoc
   0     000   004006 ******                                                    ....

TMSGL
 Sect OctLoc
   0     001   002006 001002                                                    ....

(unnamed)
 Sect OctLoc
   0     002   104120 040040   060060 060060                                    DP  0000

(unnamed)
 Sect OctLoc
   2     000   000000 000021   000002 006000   000000 006000   757777 777777    ................
   2     004   000000 000024   000004 006000   000006 006000   000001 006000    ................
   2     010   000000 000377   000010 006000   000002 006000   000002 006000    ................
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:80   
   2     014   777777 777770   777777 777577   000005 006000   100000 000000    ............@...
   2     020   000004 006000   000000 006000   000017 006000   000000 000035    ................
   2     024   000004 006000   000000 006000   000023 006000                    ............
      442     2648           /**/
      443     2649    1   END;
      444     2650           /**/
      445     2651           /**/

PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:81   
--  Include file information  --

   FT$DDT.:E05TOU  cannot be made into a system file and is referenced.
   FT_SUBS.:E05TOU  is referenced.
   FR_SUBS.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   FR_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   NI_DATA_C.:E05TOU  is referenced.
   N_FC_C.:E05TOU  is referenced.
   FR$RAT.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
      No diagnostics issued in procedure FRC$KEYIN.
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:82   

 **** Variables and constants ****

  ****  Section 000 RoData FRC$KEYIN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b UBIN(9)     r     1 EMSGL(0:1)                 1-0-0/b UBIN(9)     r     1 TMSGL(0:3)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @KMSG                      4-0-0/w SBIN        r     1 ANYLISTED
    14-0-0/w UBIN        r     1 DCTX                      15-0-0/w UBIN        r     1 IDCTX
    16-0-0/w PTR         r     1 IOQ$                      10-0-0/w STRC(99)    r     1 KDSP
     5-0-0/w STRC(90)    r     1 KERR                      *0-0-0/w STRC(180)   r     1 KMSG
    15-0-0/w UBIN        r     1 MSG#                      13-0-0/w PTR         r     1 RAT$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 FR$HD$(0:3)                0-0-0/c CHAR(2)     r     1 FR_AMSGL
     0-0-0/w UBIN        r     1 FT_PROT                    0-0-0/w PTR         r     1 N$DCT$$
     0-0-0/w PTR         r     1 N$FQ$                      0-0-0/w PTR         r     1 NI$FQ$
     0-0-0/w PTR         r     1 NI$IBUF$                   0-0-0/w PTR         r     1 NI$RP$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1332)  r     1 DCT                        0-0-0/w STRC(288)   r     1 FT$DDT
     0-0-0/w PTR         r     1 N$DCT$(0:0)                0-0-0/d STRC(1080)  r     1 N$REQ
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:83   
     0-0-0/w STRC(324)   r     1 RAT


   Procedure FRC$KEYIN requires 460 words for executable code.
   Procedure FRC$KEYIN requires 22 words of local(AUTO) storage.

    No errors detected in file FRC$AVR.:E05TSI    .
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:84   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:85   
          MINI XREF LISTING

ANYLISTED
      2439**DCL      2486<<ASSIGN   2506<<ASSIGN   2516>>IF
BDDEV
      2528**LABEL    2514--GOTO     2523--GOTO
CNTLOAD
      2642**LABEL    2623--CALLALT  2642--CALLALT
CNTLOADR
      2635**LABEL    2630--CALLALT
DCT.DDT$
      2387**DCL      2546>>ASSIGN   2618>>IF
DCT.DP
      2406**DCL      2413--REDEF    2416--REDEF    2417--REDEF    2419--REDEF    2419--REDEF    2420--REDEF
      2421--REDEF    2421--REDEF
DCT.MPC.IOCHANX
      2414**DCL      2414--REDEF
DCT.RAT$
      2387**DCL      2522>>ASSIGN
DCTX
      2458**DCL      2504<<ASSIGN   2505<>CALL     2513<<ASSIGN   2521<>CALL     2522>>ASSIGN   2546>>ASSIGN
      2618>>IF       2636<>CALL     2646<>CALL
EMSGL
      2443**DCL      2646--CALL     2646<>CALL
ERRXIT
      2644**LABEL    2532--GOTO     2536--GOTO     2549--GOTO     2555--GOTO     2564--GOTO     2574--GOTO
      2585--GOTO     2591--GOTO     2616--GOTO     2621--GOTO
FMN$AVR
      2463**DCL-ENT  2603--CALL
FR$HD$
      1298**DCL      2475>>ASSIGN   2477>>ASSIGN
FRC$WAKU
      2464**DCL-ENT  2638--CALL
FRL$AVREA
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:86   
      2465**DCL-ENT  2627--ASSIGN
FRZ$DSMT
      2466**DCL-ENT  2597--CALL
FR_AMSGL
      1302**DCL      2636--CALL     2636<>CALL
FT$DDT.SOLICIT
      2359**DCL      2546<<ASSIGN   2618>>IF
FT_PROT
      2462**DCL      2560>>IF       2571>>IF       2579>>IF
IDCTX
      2460**DCL      2483<<ASSIGN   2485<>CALL     2488>>IF       2489>>IF       2489>>IF       2507>>IF
      2512>>IF       2513>>ASSIGN
IOQ$
      2461**DCL      2623<>CALL     2624>>ASSIGN   2625>>ASSIGN   2626>>ASSIGN   2627>>ASSIGN   2628>>ASSIGN
      2629>>ASSIGN   2630>>CALL     2642<>CALL
KDSP
      2444**DCL      2505<>CALL
KDSP.ASYD
      2445**DCL      2491<<ASSIGN   2496<<ASSIGN
KDSP.SERN
      2446**DCL      2492<<ASSIGN   2497<<ASSIGN
KDSP.STATE
      2447**DCL      2476<<ASSIGN
KDSP.STATE.DOWN
      2450**DCL      2503<<ASSIGN
KDSP.STATE.MBT
      2451**DCL      2452--REDEF    2501<<ASSIGN
KDSP.STATE.MBTR.UP
      2454**DCL      2502<<ASSIGN
KDSP.STATE.SOLIC
      2449**DCL      2493<<ASSIGN   2498<<ASSIGN
KDSP.SYSID
      2455**DCL      2500<<ASSIGN
KERR
      2440**DCL      2646<>CALL
KERR.CODE
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:87   
      2441**DCL      2531<<ASSIGN   2535<<ASSIGN   2548<<ASSIGN   2554<<ASSIGN   2562<<ASSIGN   2573<<ASSIGN
      2584<<ASSIGN   2590<<ASSIGN   2615<<ASSIGN   2620<<ASSIGN   2644<<ASSIGN
KERR.SERN
      2442**DCL      2563<<ASSIGN
KMSG
      2427**DCL         8--PROC
KMSG.CADDR
      2429**DCL      2480<>CALL     2485<>CALL     2505<>CALL     2517<>CALL     2521<>CALL     2646<>CALL
KMSG.DEV
      2432**DCL      2433--REDEF    2485<>CALL     2521<>CALL
KMSG.DTW.D
      2434**DCL      2435--REDEF
KMSG.DTW.TN.N
      2437**DCL      2478>>IF
KMSG.DTW.TN.T
      2436**DCL      2477>>IF
KMSG.DTW.TW
      2438**DCL      2479>>IF
KMSG.KIN#
      2428**DCL      2474>>IF       2474>>IF       2488>>IF       2524>>IF       2524>>IF       2524>>IF
      2538>>IF       2538>>IF       2538>>IF       2543>>IF       2551>>IF       2557>>DOCASE
KMSG.SERN
      2431**DCL      2559>>IF       2566>>ASSIGN   2576>>IF       2576>>ASSIGN
KMSG.SYSID
      2430**DCL      2607>>ASSIGN   2635>>ASSIGN
MSG#
      2459**DCL      2460--REDEF    2569<<ASSIGN   2577<<ASSIGN   2587<<ASSIGN   2610<<ASSIGN   2611<<ASSIGN
      2636<>CALL
N$DCT$
      1226**DCL      2522>>ASSIGN   2546>>ASSIGN   2618>>IF
N$DCT$$
      1092**DCL      1226--IMP-PTR  2522>>ASSIGN   2546>>ASSIGN   2618>>IF
N$FQ$
      1092**DCL      1227--IMP-PTR
N$REQ
      1240**DCL      2630<>CALL
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:88   
N$REQ.BUFADDR
      1249**DCL      1250--REDEF    1250--REDEF
N$REQ.DLA.DCTX
      1240**DCL      2624<<ASSIGN
N$REQ.DLA.DRELADDR
      1241**DCL      1241--REDEF
N$REQ.DVE.EOMCHAR
      1278**DCL      1279--REDEF
N$REQ.EAENTRY
      1271**DCL      2627<<ASSIGN
N$REQ.EAINFO
      1272**DCL      1272--REDEF    2628<<ASSIGN
N$REQ.EAINFOX
      1272**DCL      1273--REDEF
N$REQ.EVNTINFO
      1273**DCL      1273--REDEF
N$REQ.FC
      1243**DCL      2625<<ASSIGN
N$REQ.OPFLG.EA
      1247**DCL      2626<<ASSIGN
N$REQ.OPFLG.HOLD
      1248**DCL      2629<<ASSIGN
N$REQ.STATUS
      1254**DCL      1260--REDEF
N$REQ_INIT.BUFADDR
      1111**DCL      1112--REDEF    1112--REDEF
N$REQ_INIT.DLA.DRELADDR
      1103**DCL      1103--REDEF
N$REQ_INIT.DVE.EOMCHAR
      1140**DCL      1141--REDEF
N$REQ_INIT.EAINFO
      1134**DCL      1134--REDEF
N$REQ_INIT.EAINFOX
      1134**DCL      1135--REDEF
N$REQ_INIT.EVNTINFO
      1135**DCL      1135--REDEF
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:89   
N$REQ_INIT.STATUS
      1116**DCL      1122--REDEF
NI$FQ$
      1152**DCL      1228--IMP-PTR
NI$IBUF$
      1152**DCL      1228--IMP-PTR
NI$IMXMBX_INIT.PAGED_BASE
      1162**DCL      1163--REDEF    1163--REDEF
NI$IMXMBX_INIT.SIZE
      1164**DCL      1164--REDEF
NI$REQ_INIT.DCW
      1186**DCL      1189--REDEF
NI$REQ_INIT.DCW.TALLY
      1187**DCL      1187--REDEF
NI$REQ_INIT.IDCW.EXTA
      1189**DCL      1189--REDEF
NI$REQ_INIT.PCW
      1191**DCL      1195--REDEF
NI$REQ_INIT.SEEK
      1196**DCL      1197--REDEF    1198--REDEF
NI$RP$
      1200**DCL      1230--IMP-PTR
NIO$QUE
      2467**DCL-ENT  2630--CALL
NIQ$GET
      2468**DCL-ENT  2623--CALL
NIQ$REL
      2469**DCL-ENT  2642--CALL
NI_MBX_INIT.DCW.CONTROL.AE
      1222**DCL      1222--REDEF
NI_MBX_INIT.LPW.CONTROL.AE
      1218**DCL      1218--REDEF
NOMSG
      2635**LABEL    2595--GOTO
OCI$MK_WR
      2471**DCL-ENT  2480--CALL     2505--CALL     2517--CALL     2636--CALL     2646--CALL
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:90   
OCZ$DEV_DCT
      2470**DCL-ENT  2485--CALL     2521--CALL
RAT
       606**DCL      2597<>CALL     2638<>CALL
RAT.DCTX
       624**DCL      2489>>IF       2504>>ASSIGN   2603>>CALL     2624>>ASSIGN
RAT.FLG.DOWN
       641**DCL      2503>>ASSIGN   2534>>IF
RAT.FLG.FORM
       639**DCL      2598>>IF
RAT.FLG.MBIT
       633**DCL      2501>>ASSIGN
RAT.FLG.MBIT.MTD
       634**DCL      2551>>IF
RAT.FLG.MBIT.MTSC
       635**DCL      2560>>IF       2568<<ASSIGN   2571<<ASSIGN   2572>>IF       2581<<ASSIGN   2610>>IF
RAT.FLG.MBIT.SOL
       636**DCL      2488>>IF       2490>>IF       2589>>IF
RAT.FLG.RUP
       640**DCL      2488>>IF       2490>>IF       2502>>ASSIGN   2538>>IF       2606>>IF       2613>>IF
RAT.LNK$
       607**DCL      2510>>ASSIGN
RAT.M1
       628**DCL      2598>>IF
RAT.RCOD
       619**DCL      2524>>IF       2524>>IF       2543>>IF       2560>>IF       2598>>IF
RAT.REEL
       625**DCL      2636<>CALL
RAT.REEL.ASID
       626**DCL      2496>>ASSIGN   2551>>IF       2594<<ASSIGN   2607<<ASSIGN   2635<<ASSIGN
RAT.REEL.SER
       627**DCL      2497>>ASSIGN   2559>>IF       2563>>ASSIGN   2566<<ASSIGN   2576<<ASSIGN   2580<<ASSIGN
      2583>>IF       2610>>IF
RAT.RES.RFLG.CANT
       617**DCL      2593<<ASSIGN
RAT.RES.SISID
PL6.E3A0      #003=FRC$KEYIN File=FRC$AVR.:E05TSI                                TUE 07/29/97 17:21 Page:91   
       609**DCL      2491>>ASSIGN   2500>>ASSIGN
RAT.SSER
       629**DCL      2492>>ASSIGN
RAT$
      2457**DCL       606--IMP-PTR  2475<<ASSIGN   2477<<ASSIGN   2487>>DOWHILE  2488>>IF       2488>>IF
      2489>>IF       2490>>IF       2490>>IF       2491>>ASSIGN   2492>>ASSIGN   2496>>ASSIGN   2497>>ASSIGN
      2500>>ASSIGN   2501>>ASSIGN   2502>>ASSIGN   2503>>ASSIGN   2504>>ASSIGN   2510<<ASSIGN   2510>>ASSIGN
      2522<<ASSIGN   2523>>IF       2524>>IF       2524>>IF       2534>>IF       2538>>IF       2543>>IF
      2551>>IF       2551>>IF       2559>>IF       2560>>IF       2560>>IF       2563>>ASSIGN   2566>>ASSIGN
      2568>>ASSIGN   2571>>ASSIGN   2572>>IF       2576>>ASSIGN   2580>>ASSIGN   2581>>ASSIGN   2583>>IF
      2589>>IF       2593>>ASSIGN   2594>>ASSIGN   2597>>CALL     2598>>IF       2598>>IF       2598>>IF
      2603>>CALL     2606>>IF       2607>>ASSIGN   2610>>IF       2610>>IF       2613>>IF       2624>>ASSIGN
      2635>>ASSIGN   2636>>CALL     2638>>CALL
RET
      2635**LABEL    2485--CALLALT  2521--CALLALT
TMSGL
      2456**DCL      2505--CALL     2505<>CALL
