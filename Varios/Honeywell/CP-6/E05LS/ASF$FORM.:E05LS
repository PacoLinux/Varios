VERSION E05

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:1    
        1        1        /*M* ASF$FORM -- PROCS TO HANDLE FORMS FOR SUPER */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9        ASF$FORM: PROC( PSEUDO_FLAG );
       10       10        %SET LISTSUB = '1'B;
       11       11        /*****************************************************************/
       12       12        /*D*  NAME:       ASF$FORMS
       13       13        DESCRIPTION:
       14       14        To create a form defintion useing SUPER, the command is:
       15       15        C[REATE] FOR[M] formname [ FROM formname2]
       16       16        'formname' is the name of the form you are creating, and
       17       17        'formname2' is the name of an existing form that you want to use
       18       18        to get the default setting for options.  If 'FROM formname2' is
       19       19        ommited, the default is 'FROM STDLP'.
       20       20        Formnames must be from 1 to 6 characters long.
       21       21        To modify an existing form, you use the command:
       22       22        M[ODIFY] FOR[M] formname [ FROM formname2]
       23       23        'formname' and 'formname2' mean the same thing as in the create
       24       24        command, but if 'FROM formname2' is ommited, the default is
       25       25        'FROM formname'.
       26       26        **
       27       27        ASF$FORM calls the internal procedure FORM_OPTS to proccess
       28       28        the options.                                                   */
       29       29        /****************************************************************/
       30       30        /*
       31       31                  I n c l u d e     f i l e s
       32       32        */
       33       33        %INCLUDE AS_ENTRIES_M;
       34     1083        %INCLUDE CP_6;
       35     1164        %INCLUDE CP_6_SUBS;
       36     1704        %INCLUDE AS_SUPER_C;
       37     2139        %INCLUDE FS_SUPER_C;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:2    
       38     2902        %INCLUDE KL_SUPER_C;
       39     5804        %INCLUDE AS_SUBS_C;
       40     7218        %INCLUDE AS_MAC_C;
       41     7298        %INCLUDE AS_PERR_C;
       42     7900        %INCLUDE B_ERRORS_C;
       43     9027        %INCLUDE XU_MACRO_C;
       44    12133        %INCLUDE XU_FORMAT_C;
       45    12295        %INCLUDE XG_SUBS_C;
       46    12789        %INCLUDE AS_SUPER_R;
       47    15805        /*
       48    15806                  P a r a m e t e r
       49    15807        */
       50    15808    1   DCL PSEUDO_FLAG BIT(1) ALIGNED; /*'0'B => create/modify form command*/
       51    15809                                      /* '1'b => create/modify pseudo command */
       52    15810        %LIST;
       53    15811        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:3    
       54    15812        %FS$GFORMREC (NAME = FS$GFORMREC,
       55    15813                      STCLASS="BASED") ;
             15814        %LSET STR=CONCAT(TEXTCHAR(BASED),'        ');
             15815        %IF (SUBSTR(STR,0,6)='STATIC') OR
             15816         (SUBSTR(STR,0,8)='CONSTANT') OR
             15817         (SUBSTR(STR,0,3)='EXT');
             15819        %ELSE;
             15820        %LSET INIT=CHARTEXT('/*');
             15821        %ENDIF;
             15822    1   DCL 1 FS$GFORMREC BASED ALIGNED,
             15823    1         2 FNAME CHAR(6) %INIT('  ')%CHARTEXT('/**/'), /* GRAPHIC FORM NAME   */
             15824    1         2 ACCTDISP UBIN HALF UNAL %INIT(0)%CHARTEXT('/**/'),
             15825    1         2 SETUPDISP UBIN HALF UNAL %INIT(0)%CHARTEXT('/**/'), /* WD DISP TO SETUP */
             15826    1         2 ACCSDISP UBIN HALF UNAL %INIT(0)%CHARTEXT('/**/'), /* DISP TO ACCESS */
             15827    1         2 BANRDISP UBIN HALF UNAL %INIT(0)%CHARTEXT('/**/'), /* DISP TO BANNER */
             15828    1         2 ALGNDISP UBIN HALF UNAL %INIT(0)%CHARTEXT('/**/'), /* DISP TO ALGNMENT */
             15829    1         2 * BIT(7) %INIT('0000000'B)%CHARTEXT('/**/'),
             15830    1         2 TRANSLGL BIT(1) %INIT('0'B)%CHARTEXT('/**/'), /* TRANSPARENT LEGAL */
             15831    1         2 GRAPHIC BIT(1) %INIT('1'B)%CHARTEXT('/**/'), /* GRAPHIC FORM   */
             15832        /*   The LGLTYPS field here is duplicated in the FS$CHARSET record
             15833             and when that structure is changed, this one should be checked!
             15834            CHAIN is specified in the form definition to bring in the
             15835           attributes and the legal devices list...
             15836        */
             15837        /*  LEGAL TYPE OF DEVICES FOR THIS GRAPHIC FORM */
             15838    1         2 LGLTYPS,
             15839    1           3 LPOK BIT(1) %INIT('0'B)%CHARTEXT('/**/'), /* LEGAL ON LP           */
             15840    1           3 TSOK BIT(1) %INIT('0'B)%CHARTEXT('/**/'), /* LEGAL ON TS           */
             15841    1           3 ELSOK BIT(1) %INIT('0'B)%CHARTEXT('/**/'), /* LEGAL ON ALL BUT TS+LP */
             15842    1           3 ONEOK BIT(1) %INIT('1'B)%CHARTEXT('/**/'), /* LEGAL ON TYP=LTYP   */
             15843    1           3 * BIT(5) %INIT('00000'B)%CHARTEXT('/**/'),
             15844    1           3 LTYP CHAR(2) %INIT('GR')%CHARTEXT('/**/'), /* LEGAL IF ONEOK=YES   */
             15845    1         2 ATTR BIT(18) UNAL %INIT('000002'O) %CHARTEXT('/**/'),
             15846    1         2 CHAIN_NAME CHAR(8) %INIT('NONE')%CHARTEXT('/**/'),
             15847    1         2 X_SIZE UBIN (18) UNAL %INIT (0) %CHARTEXT('/**/'),
             15848    1         2 Y_SIZE UBIN (18) UNAL %INIT (0) %CHARTEXT('/**/'),
             15849    1         2 Z_SIZE UBIN (18) UNAL %INIT (0) %CHARTEXT('/**/'),
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:4    
             15850    1         2 X_OFFSET UBIN (18) UNAL %INIT(0) %CHARTEXT('/**/'),
             15851    1         2 Y_OFFSET UBIN (18) UNAL %INIT(0) %CHARTEXT('/**/'),
             15852    1         2 Z_OFFSET UBIN (18) UNAL %INIT(0) %CHARTEXT('/**/'),
             15853    1         2 SET_DEV_LIM,
             15854    1           3 DEV_LIM_OPCODE,
             15855    1             4 CLASS UBIN (9) UNAL %INIT(%XG_COOP_CONTROL#) %CHARTEXT ('/**/'),
             15856    1             4 INDX UBIN (9) UNAL %INIT(%XG_COOP_SET_DEV_LIM#) %CHARTEXT ('/**/'),
             15857    1           3 X_SIZE BIT (18) UNAL %INIT('000000'O) %CHARTEXT('/**/'),
             15858    1           3 Y_SIZE BIT (18) UNAL %INIT('000000'O) %CHARTEXT('/**/'),
             15859    1           3 Z_SIZE BIT (18) UNAL %INIT('000000'O) %CHARTEXT('/**/'),
             15860    1           3 X_OFFSET BIT (18) UNAL %INIT('000000'O) %CHARTEXT('/**/'),
             15861    1           3 Y_OFFSET BIT (18) UNAL %INIT('000000'O) %CHARTEXT('/**/'),
             15862    1           3 Z_OFFSET BIT (18) UNAL %INIT('000000'O) %CHARTEXT('/**/'),
             15863    1           3 SPARAM6 BIT (18) UNAL %INIT('000000'O) %CHARTEXT('/**/'),
             15864    1           3 SPARAM7 BIT (18) UNAL %INIT('000000'O) %CHARTEXT('/**/'),
             15865    1           3 SPARAM8 BIT (18) UNAL %INIT('000000'O) %CHARTEXT('/**/'),
             15866    1           3 SPARAM9 BIT (18) UNAL %INIT('000000'O) %CHARTEXT('/**/'),
             15867    1           3 UPARAM (0:9) BIT (18) UNAL %INIT('000000'O,'000000'O,
             15868    1                      '000000'O,'000000'O,'000000'O,'000000'O,'000000'O,
             15869    1                      '000000'O,'000000'O,'000000'O) %CHARTEXT('/**/'),
             15870    1         2 SET_DEV_LIM_CMD REDEF SET_DEV_LIM CHAR (42) UNAL;
       56    15872        %FS$GRAPHIC_BANNER (NAME = FS$GBAN,
       57    15873                      STCLASS="BASED") ;
             15874        %LSET STR=CONCAT(TEXTCHAR(BASED),'        ');
             15875        %IF (SUBSTR(STR,0,6)='STATIC') OR
             15876         (SUBSTR(STR,0,8)='CONSTANT') OR
             15877         (SUBSTR(STR,0,3)='EXT');
             15879        %ELSE;
             15880        %LSET INIT=CHARTEXT('/*');
             15881        %ENDIF;
             15882    1   DCL 1 FS$GBAN BASED,
             15883    1         2 CHARGE UBIN BYTE UNAL %INIT(0) %CHARTEXT('/**/'),
             15883                  /* DO WE CHARGE FOR BANNER */
             15884    1         2 ALIGNCTL REDEF CHARGE UNAL,
             15885    1           3 EVERY BIT(1) UNAL,            /* DO WE ALIGN EVERY MOUNT            */
             15886    1           3 * BIT(8) UNAL,
             15887    1         2 REPEATS UBIN BYTE UNAL %INIT(0) %CHARTEXT('/**/'),
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:5    
             15887                  /* NUM OF TIMES TO PRINT THIS BANNER */
             15888    1         2 INTR UBIN BYTE UNAL %INIT(0) %CHARTEXT('/**/'),
             15888                  /* ARE INTRINSICS  ALLOWED */
             15889    1         2 NUM_ENTRIES UBIN BYTE UNAL %INIT(0) %CHARTEXT('/**/'),
             15889                  /* NUM OF ENTRIES IN THE TABLE */
             15890    1         2 ENTRIES(0:0),
             15891    1           3 CHARUP,
             15892    1             4 CHARUP_OPCODE,
             15893    1               5 CLASS UBIN (9) UNAL %INIT (%XG_COOP_SEGM_BASIC#) %CHARTEXT('/**/'),
             15894    1               5 INDX UBIN (9) UNAL %INIT (%XG_COOP_SET_CHARACTER_UP#) %CHARTEXT('/**/'
             15894                        ),
             15895    1             4 X UBIN (18) UNAL %INIT (65535) %CHARTEXT ('/**/'),
             15896    1             4 Y UBIN (18) UNAL %INIT (0) %CHARTEXT ('/**/'),
             15897    1             4 Z UBIN (18) UNAL %INIT (0) %CHARTEXT ('/**/'),
             15898    1           3 SET_CHARUP_CMD REDEF CHARUP CHAR (8) UNAL,
             15899    1           3 DIRECTION UBIN (9) UNAL %INIT (90) %CHARTEXT ('/**/'),
             15900    1           3 CHARSIZE,
             15901    1             4 CHARSIZE_OPCODE,
             15902    1               5 CLASS UBIN (9) UNAL %INIT (%XG_COOP_ATTR_BAS_NONE_2#) %CHARTEXT('/**/'
             15902                        ),
             15903    1               5 INDX UBIN (9) UNAL %INIT (%XG_COOP_SET_CHARSIZE#) %CHARTEXT('/**/'),
             15904    1             4 CHAR_WIDTH BIT (18) UNAL %INIT (1167) %CHARTEXT ('/**/'),
             15905    1             4 CHAR_HITE BIT (18) UNAL %INIT (1167) %CHARTEXT ('/**/'),
             15906    1           3 SET_CHARSIZE_CMD REDEF CHARSIZE CHAR (6) UNAL,
             15907    1           3 CHAR_WIDTH UBIN (18) UNAL %INIT (655) %CHARTEXT ('/**/'),
             15908    1           3 CHAR_HITE UBIN (18) UNAL %INIT (655) %CHARTEXT ('/**/'),
             15909    1           3 CHARSPACE,
             15910    1             4 CHARSPACE_OPCODE,
             15911    1               5 CLASS UBIN (9) UNAL %INIT (%XG_COOP_ATTR_BAS_NONE_2#) %CHARTEXT('/**/'
             15911                        ),
             15912    1               5 INDX UBIN (9) UNAL %INIT (%XG_COOP_SET_CHARSPACE#) %CHARTEXT('/**/'),
             15913    1             4 CHAR_SPACE BIT (18) UNAL %INIT (1167) %CHARTEXT ('/**/'),
             15914    1           3 SET_CHARSPACE_CMD REDEF CHARSPACE CHAR (4) UNAL,
             15915    1           3 CHAR_SPACE UBIN (18) UNAL %INIT (655) %CHARTEXT ('/**/'),
             15916    1           3 X_VAL UBIN (18) UNAL,
             15917    1           3 Y_VAL UBIN (18) UNAL,
             15918    1           3 Z_VAL UBIN (18) UNAL,
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:6    
             15919    1           3 NDC_X_VAL UBIN (18) UNAL,
             15920    1           3 NDC_Y_VAL UBIN (18) UNAL,
             15921    1           3 NDC_Z_VAL UBIN (18) UNAL,
             15922    1           3 TYPE UBIN BYTE UNAL,          /* TYPE OF ENTRY(INTRINSIC/PLAIN)     */
             15923    1           3 COUNT UBIN BYTE UNAL,         /* COUNT OF TEXT (IF ANY) OR          */
             15924    1           3 CHR REDEF COUNT CHAR (1),     /*CHAR FOR REPEAT ACCROSS PAGE        */
             15925    1           3 DISP UBIN HALF UNAL,          /* DISP IN WORDS TO TEXT (IF ANY)     */
             15926    1           3 TOTLEN UBIN (27) UNAL,        /* TOTLEN OF ENTRY (INTERNAL)         */
             15927    1           3 * UBIN (27) UNAL,
             15928    1           3 MARK UBIN BYTE UNAL;          /* MARK (INTERNAL)                    */
       58    15930        %FS$FORMREC(NAME=FS$FORMREC,
       59    15931                    STCLASS=BASED) ;
             15932        %LSET STR=CONCAT(TEXTCHAR(BASED),'        ');
             15933        %IF (SUBSTR(STR,0,6)='STATIC') OR
             15934         (SUBSTR(STR,0,8)='CONSTANT') OR
             15935         (SUBSTR(STR,0,3)='EXT');
             15937        %ELSE;
             15938        %LSET INIT=CHARTEXT('/*');
             15939        %ENDIF;
             15940        /*
             15941        */
             15942    1   DCL 1 FS$FORMREC BASED ALIGNED,
             15943    1         2 FNAME CHAR(6) %INIT('  ')%CHARTEXT('/**/'), /* FORM NAME           */
             15944    1         2 ACCTDISP UBIN HALF UNAL %INIT(0)%CHARTEXT('/**/'),
             15945    1         2 SETUPDISP UBIN HALF UNAL %INIT(0)%CHARTEXT('/**/'), /* WD DISP TO SETUP */
             15946    1         2 ACCSDISP UBIN HALF UNAL %INIT(0)%CHARTEXT('/**/'), /* DISP TO ACCESS */
             15947    1         2 BANRDISP UBIN HALF UNAL %INIT(0)%CHARTEXT('/**/'), /* DISP TO BANNER */
             15948    1         2 ALGNDISP UBIN HALF UNAL %INIT(0)%CHARTEXT('/**/'), /* DISP TO ALGNMENT */
             15949    1         2 FLAGS BIT(7) %INIT('0000000'B) %CHARTEXT('/**/'), /* SETABLE BUT NOT USED */
             15950    1         2 * BIT(1) %INIT('0'B)%CHARTEXT('/**/'), /* THIS BIT IS FREE            */
             15951    1         2 GRAPHIC BIT(1) %INIT('0'B)%CHARTEXT('/**/'), /* GRAPHIC FORM   */
             15952        /**/
             15953        /*  LEGAL TYPE OF DEVICES FOR THIS FORM */
             15954        /*   The LGLTYPS field here is duplicated in the FS$CHARSET record
             15955             and when this macro is changed, this one should be checked!
             15956        */
             15957        /**/
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:7    
             15958    1         2 LGLTYPS,
             15959    1           3 LPOK BIT(1) %INIT('0'B)%CHARTEXT('/**/'), /* LEGAL ON LP           */
             15960    1           3 TSOK BIT(1) %INIT('0'B)%CHARTEXT('/**/'), /* LEGAL ON TS           */
             15961    1           3 ELSOK BIT(1) %INIT('0'B)%CHARTEXT('/**/'), /* LEGAL ON ALL BUT TS+LP */
             15962    1           3 ONEOK BIT(1) %INIT('0'B)%CHARTEXT('/**/'), /* LEGAL ON TYP=LTYP   */
             15963    1           3 * BIT(5) %INIT('00000'B)%CHARTEXT('/**/'),
             15964    1           3 LTYP CHAR(2) %INIT(' ')%CHARTEXT('/**/'), /* LEGAL IF ONEOK=YES   */
             15965    1         2 ATTR BIT(18) UNAL %INIT('000006'O) %CHARTEXT('/**/'),
             15966    1         2 SOFTFORM,                       /*SOFT VFU/PLATEN INFO                */
             15967        /**/
             15968        /*  WRITE SOFTFORM WITH VFC_VFU AND BP ON IN DVBYTE */
             15969        /**/
             15970    1           3 VLPPLATEN,                    /* SEE KI_CP6_C FOR DESC              */
             15971    1             4 TL,
             15972    1               5 T UBIN BYTE UNAL %INIT(8)%CHARTEXT('/**/'),
             15973    1               5 L UBIN BYTE UNAL %INIT(16)%CHARTEXT('/**/'),
             15974    1             4 WIDTH UBIN BYTE UNAL %INIT(0)%CHARTEXT('/**/'),
             15975    1             4 LENGTH UBIN BYTE UNAL %INIT(0)%CHARTEXT('/**/'),
             15976    1             4 LIMBO UBIN BYTE UNAL %INIT(0)%CHARTEXT('/**/'),
             15977    1             4 FIRSTLINE UBIN BYTE UNAL %INIT(0)%CHARTEXT('/**/'),
             15978    1             4 * BIT(8) %INIT('00000000'B)%CHARTEXT('/**/'),
             15979    1             4 EXTWID BIT(1) %INIT('0'B)%CHARTEXT('/**/'),
             15980    1             4 LPI UBIN BYTE UNAL %INIT(6)%CHARTEXT('/**/'),
             15981    1             4 * (0:9) UBIN BYTE UNAL %INIT(0*0)%CHARTEXT('/**/'),
             15982    1           3 VFUIM,                        /* TED AND PAULS SOFT VFU IMAGE       */
             15983    1             4 TL,
             15984    1               5 T UBIN BYTE UNAL %INIT(18)%CHARTEXT('/**/'),
             15985    1               5 L UBIN BYTE UNAL %INIT(64)%CHARTEXT('/**/'),
             15986    1             4 V,
             15987    1               5 LINE(0:31) UBIN BYTE UNAL %INIT(0*0)%CHARTEXT('/**/'),
             15988    1               5 NEXT(0:31) UBIN BYTE UNAL %INIT(0*0)%CHARTEXT('/**/'),
             15989    1         2 CHAIN_NAME CHAR(8) UNAL %INIT('600')%CHARTEXT('/**/'),
             15990    1         2 CHAINS(0:5) CHAR(40) UNAL %INIT(
             15991                %C600;
             15992    1             'BDFGHJgS0ACEINORLTabcdefKhijklmM0PQUVWXY',
             15993    1             'Z:;?!%7xynoprstw0z123456#89.,()@$=&/''\^_',
             15994    1             '0"<>[]gS~ACEINOR{Tabcdef0hijklm}|`-*+quv',
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:8    
             15995    1             'BDFGHJ7x0noprstwLz123456K89.,()M0PQUVWXY',
             15996    1             'Z:;?!%gSyACEINOR0Tabcdef#hijklm@$=&/''\^_',
             15997    1             '0"<>[]7x~noprstw{z123456089.,()}|`-*+quv')
             15999    1           %CHARTEXT('/**/'),
             16000    1         2 CHAINIMAGE REDEF CHAINS CHAR(240) UNAL;
       60    16002        %FS$ACCT_INIT(NAME=FS$ACCOUNTS,
       61    16003                        STCLASS=BASED) ;
             16004        %LSET STR=CONCAT(TEXTCHAR(BASED),'        ');
             16005        %IF (SUBSTR(STR,0,5)='BASED') OR
             16006            (SUBSTR(STR,0,8)='       ');
             16007    1   DCL 1 FS$ACCOUNTS BASED,
             16008    1         2 TACCTS UBIN WORD UNAL,          /* NUM OF ACCTS                       */
             16009    1         2 LIST(0:0) CHAR(8);
             16010        %ELSE;
             16015        %ENDIF;
       62    16017        %FS$ACC_INIT(NAME=FS$ACCESS,
       63    16018                    STCLASS=BASED) ;
             16019        %LSET STR=CONCAT(TEXTCHAR(BASED),'        ');
             16020        %IF (SUBSTR(STR,0,5)='BASED') OR
             16021            (SUBSTR(STR,0,8)='       ');
             16022    1   DCL 1 FS$ACCESS BASED,
             16023    1         2 TNAMES UBIN WORD UNAL,          /* NUM OF NAMES                       */
             16024    1         2 LIST(0:0) CHAR(8);
             16025        %ELSE;
             16030        %ENDIF;
       64    16032        %FS$BAN_INIT(NAME=FS$FINST,
       65    16033                    STCLASS=BASED);
             16034        %LSET STR=CONCAT(TEXTCHAR(BASED),'        ');
             16035        %IF ( SUBSTR(STR,0,5)='BASED') OR
             16036         (SUBSTR(STR,0,8)='        ');
             16037    1   DCL 1 FS$FINST BASED,
             16038    1         2 CHARGE UBIN BYTE UNAL,          /* DO WE CHARGE FOR BANNER            */
             16039    1         2 ALIGNCTL REDEF CHARGE UNAL,
             16040    1           3 EVERY BIT(1) UNAL,
             16041    1           3 * BIT(8) UNAL,
             16042    1         2 REPEATS UBIN BYTE UNAL,         /* NUM OF TIMES TO PRINT THIS BANNER  */
             16043    1         2 INTR UBIN BYTE UNAL,            /* ARE INTRINSICS  ALLOWED            */
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:9    
             16044    1         2 NUM_ENTRIES UBIN BYTE UNAL,     /* NUM OF ENTRIES IN THE TABLE        */
             16045    1         2 ENTRIES(0:0),
             16046    1           3 ROW UBIN BYTE UNAL,           /* START ROW                          */
             16047    1           3 COL UBIN BYTE UNAL,           /* START COL                          */
             16048    1           3 FONT UBIN BYTE UNAL,          /* FONT TO BE USED                    */
             16049    1           3 STRIKES UBIN BYTE UNAL,       /* NUMBER OF PRINT STRIKES            */
             16050    1           3 ICSH UBIN BYTE UNAL,          /* INTER CHAR SPACING HORZ.           */
             16051    1           3 REPS UBIN BYTE UNAL,          /* NUM OF TIME TO PRINT THIS ENTRY    */
             16052    1           3 RINC UBIN BYTE UNAL,          /* ROW INCERMENT PER REPEAT           */
             16053    1           3 CINC UBIN BYTE UNAL,          /* COL INCERMENT PER REPEAT           */
             16054    1           3 TYPE UBIN BYTE UNAL,     /* TYPE OF ENTRY(PLAIN TEXT, INTRINIC)     */
             16055    1           3 DISP UBIN HALF UNAL,          /* DISP(IN WORDS) TO TEXT(IF ANY)     */
             16056    1           3 B REDEF DISP,
             16057    1             4 START UBIN BYTE UNAL,
             16058    1             4 LEN UBIN BYTE UNAL,
             16059    1           3 COUNT UBIN BYTE UNAL,         /* COUNT OF TEXT(IF ANY)              */
             16060    1           3 CHR REDEF COUNT CHAR(1),      /* OR CHAR TO BE REPEATED ACROSS PAGE */
             16061    1           3 TOTLEN UBIN(27) UNAL,         /* TOTLEN OF ENTRY(INTERNAL)          */
             16062    1           3 MARK UBIN BYTE UNAL;          /* MARK(INTERNAL)                     */
             16063        %ELSE;
             16088        %ENDIF;
       66    16090        %FS$SET_INIT(NAME=FS$SETUP,
       67    16091                  STCLASS=BASED);
             16092        %LSET STR=CONCAT(TEXTCHAR(BASED),'        ');
             16093        %IF (SUBSTR(STR,0,5)='BASED') OR
             16094            (SUBSTR(STR,0,8)='       ');
             16095    1   DCL 1 FS$SETUP BASED,
             16096    1         2 LINES UBIN BYTE UNAL,           /* NUM OF LINES                       */
             16097    1         2 * UBIN BYTE UNAL,
             16098    1         2 * UBIN HALF UNAL,
             16099    1         2 TXT(0:0) CHAR(72);
             16100        %ELSE;
             16107        %ENDIF;
       68    16109        %FS$CHARSET (NAME=CHARSET,
       69    16110                      STCLASS="BASED(CHARSET$)");
             16111        %LSET STR=CONCAT(TEXTCHAR(BASED(CHARSET$)),'        ');
             16112        %IF (SUBSTR(STR,0,6)='STATIC') OR
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:10   
             16113         (SUBSTR(STR,0,8)='CONSTANT') OR
             16114         (SUBSTR(STR,0,3)='EXT');
             16116        %ELSE;
             16117        %LSET INIT=CHARTEXT('/*');
             16118        %ENDIF;
             16119    1   DCL 1 CHARSET BASED(CHARSET$) ALIGNED,
             16120    1         2 SETS (0:9) CHAR (24) %INIT ('BDFGHJgS0ACEINORLTabcdef',
             16121    1                                    'KhijklmM0PQUVWXYZ:;?!%7x',
             16122    1                                    'ynoprstw0z123456#89.,()@',
             16123    1                                    '$=&/''\^_0"<>[]gS~ACEINOR',
             16124    1                                    '{Tabcdef0hijklm}|`-*+quv',
             16125    1                                    'BDFGHJ7x0noprstwLz123456',
             16126    1                                    'K89.,()M0PQUVWXYZ:;?!%gS',
             16127    1                                    'yACEINOR0Tabcdef#hijklm@',
             16128    1                                    '$=&/''\^_0"<>[]7x~noprstw',
             16129    1                                    '{z123456089.,()}|`-*+quv') %CHARTEXT ('/**/'),
             16130    1         2 CHAINIMAGE REDEF SETS CHAR (240) UNAL,
             16131    1         2 ATTRS BIT (18) %INIT ('000001'O) %CHARTEXT ('/**/'),
             16132    1         2 LGLTYPS,
             16133    1           3 LPOK BIT(1) %INIT('0'B)%CHARTEXT('/**/'),
             16134    1           3 TSOK BIT(1) %INIT('0'B)%CHARTEXT('/**/'),
             16135    1           3 ELSOK BIT(1) %INIT('0'B)%CHARTEXT('/**/'),
             16136    1           3 ONEOK BIT(1) %INIT('0'B)%CHARTEXT('/**/'),
             16137    1           3 * BIT(5) %INIT('00000'B)%CHARTEXT('/**/'),
             16138    1           3 LTYP CHAR(2) %INIT('  ')%CHARTEXT('/**/'),
             16139    1           3 * BIT(27) %INIT('000000000'O)%CHARTEXT('/**/');
       70    16141        %PLIST;
       71    16142        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:11   
       72    16143    1   DCL X$PARSE ENTRY(1) ALTRET;
       73    16144        %ASB$SET_PROMPT ;
       74    16147        %ASH$ERROR ;
       75    16150        %ASH$WARN ;
       76    16153        %ASH$HELP ;
       77    16156        %ASH$QUEST ;
       78    16159        %ASH$DQUEST ;
       79    16162        %ASF$READ_FORM ;
       80    16165        %ASF$WRITE_FORM ;
       81    16168        %ASB$READ_SI ;
       82    16171        %ASB$GETSEG ;
       83    16174        %ASF$QUERY_PSEUDO_FORMS ;
       84    16177        %ASR$R_PSEUDO_FORMS ;
       85    16180        %ASH$INFO ;
       86    16183        %ASF$PREC_FORM ;
       87    16186        %ASF$PREC_SKIP_FORM ;
       88    16189        %ASF$READ_FORM_SEQ ;
       89    16192    1   DCL ENUM UBIN WORD;
       90    16193    1   DCL I UBIN WORD;
       91    16194    1   DCL FC$ PTR;
       92    16195    1   DCL FCB$ PTR;
       93    16196    1   DCL FCA$ PTR;
       94    16197    1   DCL FF$ PTR;
       95    16198    1   DCL CHARSET$ PTR;
       96    16199    1   DCL DISP_TALLY UBIN HALF;
       97    16200    1   DCL MOVE_CNT UBIN WORD;
       98    16201    1   DCL TEMPLATE CHAR(MOVE_CNT) BASED;
       99    16202    1   DCL OLD_BANNER BIT(1) STATIC INIT('0'B);
      100    16203    1   DCL OLD_ALGN BIT(1) STATIC INIT('0'B);
      101    16204    1   DCL CREATE BIT(1);
      102    16205    1   DCL FROM BIT(1);
      103    16206    1   DCL PSEUDO_FLG BIT(1);
      104    16207    1   DCL ARS UBIN WORD;
      105    16208    1   DCL SUBS UBIN WORD;
      106    16209    1   DCL OLD_TOTAL_LINES UBIN;
      107    16210    1   DCL NEW_TOTAL_LINES UBIN;
      108    16211    1   DCL ELSOK BIT(1);
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:12   
      109    16212    1   DCL LPOK BIT(1);
      110    16213    1   DCL TSOK BIT(1);
      111    16214    1   DCL GRAPHIC BIT(1);
      112    16215    1   DCL 1 PSEUDO_FORM_REC ALIGNED,
      113    16216    1          2 LPOK BIT(1) UNAL,
      114    16217    1          2 TSOK BIT(1) UNAL,
      115    16218    1          2 ELSOK BIT(1) UNAL,
      116    16219    1          2 * BIT(33) UNAL;
      117    16220    1   DCL 1 FORM_KEY ALIGNED,
      118    16221    1          2 CNT UBIN BYTE UNAL,
      119    16222    1          2 TEXT CHAR(6) UNAL;
      120    16223    1   DCL 1 FORM_KEY_OLD ALIGNED,
      121    16224    1          2 CNT UBIN BYTE UNAL,
      122    16225    1          2 TEXT CHAR(6) UNAL;
      123    16226    1   DCL 1 PSEUDO_FORM_KEY,
      124    16227    1          2 CNT UBIN BYTE UNAL,
      125    16228    1          2 TXT CHAR(12) UNAL;
      126    16229    1   DCL 1 CHARSET_KEY,
      127    16230    1          2 CNT UBIN BYTE UNAL,
      128    16231    1          2 TXT CHAR(16) UNAL;
      129    16232    1   DCL PSEUDO_FORMS BIT(1);
      130    16233    1   DCL FORM_BUF(0:2047) UBIN WORD ;
      131    16234        %PARSE$OUT (NAME=P$NODE, STCLASS="BASED(NODE$)",
      132    16235                    NDTYPE=TYPE, NSUBLKS=SUBNODES);
      133    16280        %PARSE$SYM (NAME=OUT$SYM, STCLASS="BASED(BLK$)");
      134    16318    1   DCL FORM$ PTR;
      135    16319    1   DCL BLK$ PTR;
      136    16320    1   DCL F$ PTR;
      137    16321        /* These symrefs are the parse-nodes for X$PARSE */
      138    16322    1   DCL FORM_CMD UBIN(36) SYMREF;
      139    16323    1   DCL PSEUDO_CMD UBIN SYMREF;
      140    16324    1   DCL FORM_OPTS_LIST UBIN WORD SYMREF;
      141    16325    1   DCL PSEUDO_OPTS_LIST UBIN WORD SYMREF;
      142    16326    1   DCL GFORM_OPTS_LIST UBIN WORD SYMREF;
      143    16327    1   DCL GPSEUDO_OPTS_LIST UBIN WORD SYMREF;
      144    16328    1   DCL F_A_OR_B_LIST UBIN WORD SYMREF;
      145    16329    1   DCL F_VFU_LIST UBIN WORD SYMREF;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:13   
      146    16330    1   DCL FB_TYPE_LIST UBIN WORD SYMREF;
      147    16331    1   DCL F_SETUP_LIST UBIN WORD SYMREF;
      148    16332        /**/
      149    16333        /*
      150    16334        These are the offsets that will be used in
      151    16335        building the variable length record for :FORM
      152    16336        */
      153    16337    1   DCL ACCNT_OFFSET UBIN WORD CONSTANT INIT(0);
      154    16338    1   DCL ACCSS_OFFSET UBIN WORD CONSTANT INIT(1000);
      155    16339    1   DCL BNNR_OFFSET UBIN WORD CONSTANT INIT(2000);
      156    16340    1   DCL SETUP_OFFSET UBIN WORD CONSTANT INIT(0);
      157    16341    1   DCL ALGN_OFFSET UBIN WORD CONSTANT INIT(1500);
      158    16342    1   DCL TEXT_OFFSET UBIN WORD CONSTANT INIT(3000) ;
      159    16343        /*
      160    16344        Some pointers to use into the variable length record
      161    16345        */
      162    16346    1   DCL ACCNT$ PTR STATIC INIT(ADDR(NIL));
      163    16347    1   DCL ACCSS$ PTR STATIC INIT(ADDR(NIL));
      164    16348    1   DCL BNNR$ PTR STATIC INIT(ADDR(NIL));
      165    16349    1   DCL ALGN$ PTR STATIC INIT(ADDR(NIL));
      166    16350    1   DCL SETUP$ PTR STATIC INIT(ADDR(NIL));
      167    16351        /*
      168    16352        */
      169    16353        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:14   
      170    16354        /* Procedure */
      171    16355        /* This routine is called from ASA$SUPER to proccess the
      172    16356           commands 'CREATE FORM', 'MODIFY FORM', 'CREATE PSEUDO' and 'MODIFY PSEUDO'.
      173    16357              The following code gets date segments in order to
      174    16358              build the variable length record
      175    16359        */
      176    16360                                                              /* Get data segs */
      177    16361    1   PSEUDO_FLG = PSEUDO_FLAG;
      178    16362    1   IF NOT DSEG_FLG
      179    16363    1   THEN
      180    16364    2      CALL ASB$GETSEG WHENALTRETURN DO;
      181    16365              %SCREAM( ERR#=%E$GETSEGERR ,MID='F',LEVEL=ERROR);
      182    16380    2         RETURN ;
      183    16381    2         END ; /* Do whenaltreturn */
      184    16382    1   F$ = ADDR(FORM_BUF);
      185    16383    1   IF PSEUDO_FLG THEN
      186    16384    1      P_PCB.ROOT$ = ADDR(PSEUDO_CMD);
      187    16385    1   ELSE
      188    16386    1      P_PCB.ROOT$ = ADDR(FORM_CMD);
      189    16387    1   CALL X$PARSE(P_PCB) ALTRET (FORM_ERR);
      190    16388    1   NODE$ = P_PCB.OUT$;
      191    16389    1   IF P$NODE.CODE = 902 /* CR_FORM */ THEN
      192    16390    1      CREATE = AS_TRUE;
      193    16391    1   ELSE
      194    16392    1      CREATE = AS_FALSE;
      195    16393        /* Go through the subnodes and look for the graphics node.  If
      196    16394           it exists - set the graphic flag.  The reason we have to search
      197    16395           the nodes is because the previous syntax was hard coded.
      198    16396        */
      199    16397    1   GRAPHIC = AS_FALSE;
      200    16398    2   DO I = 0 TO P$NODE.SUBNODES-1 ;
      201    16399    2      IF P$NODE.SUBLK$(I) -> P$NODE.CODE = 906 /* CR_MOD_GRAPHICS_FORM */
      202    16400    3      THEN DO;
      203    16401    3         GRAPHIC = AS_TRUE;
      204    16402    3         END;
      205    16403    2      END;
      206    16404
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:15   
      207    16405        /*       Get first form name and test legality and existance.       */
      208    16406    1   FORM_KEY.TEXT = AS_BLANK;
      209    16407    1   FORM_KEY_OLD.TEXT = AS_BLANK;
      210    16408    1   BLK$ = P$NODE.SUBLK$(0)-> P$NODE.SUBLK$(0);
      211    16409    1   FORM_KEY.CNT=6;
      212    16410    1   FORM_KEY_OLD.CNT=6;
      213    16411    1   PSEUDO_FORMS = AS_FALSE;
      214    16412    1   IF OUT$SYM.COUNT > 6 THEN
      215    16413    2   DO;
      216    16414        /*E* ERROR: ASF-E$FNAMETOOBIG-0
      217    16415             MESSAGE: FORM name too long.
      218    16416             MESSAGE1: FORM name can be at most 6 characters long.
      219    16417        */
      220    16418           %SCREAM( ERR#=E$FNAMETOOBIG,MID='F',LEVEL=ERROR);
      221    16433    2      RETURN;
      222    16434    2      END;
      223    16435    1   FORM_KEY.TEXT=OUT$SYM.TEXT;
      224    16436    1   ARS = 2048 * 4;
      225    16437    1   CALL ASF$READ_FORM( FORM_KEY, F$, ARS)
      226    16438    2   WHENALTRETURN DO;
      227    16439    2      IF CREATE THEN GOTO CM_FORM_OK;
      228    16440        /*E* ERROR: ASF-E$FSWITCH-0
      229    16441             MESSAGE: %%U1 %does not exist. Switching to CREATE mode.
      230    16442        */
      231    16443    2      AS_FIELD1 = FORM_KEY;
      232    16444           %SCREAM( ERR#= E$FSWITCH,MID='F',LEVEL=WARN );
      233    16459    2      CREATE=AS_TRUE;
      234    16460    2      GOTO CM_FORM_OK;
      235    16461    2      END;
      236    16462    1   IF ((NOT F$->FS$FORMREC.GRAPHIC) AND GRAPHIC)
      237    16463    2   THEN DO;
      238    16464        /*E*   ERROR: ASF-E$GRAPHONNONGRAPHFORM-C
      239    16465               MESSAGE: Graphics was specified, this is not a graphic form.
      240    16466               MESSAGE1: The specified form is not a graphic form, yet graphic
      241    16467                         was specified.  The two types are not interchangable.
      242    16468        */
      243    16469           %SCREAM (ERR#=E$GRAPHONNONGRAPHFORM,MID='F',LEVEL=ERROR);
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:16   
      244    16484    2      RETURN;
      245    16485    2      END;
      246    16486    1   IF (F$->FS$FORMREC.GRAPHIC AND (NOT GRAPHIC))
      247    16487    2   THEN DO;
      248    16488    2      GRAPHIC = AS_TRUE;
      249    16489    2      END;
      250    16490
      251    16491    1   IF CREATE THEN
      252    16492    2   DO;
      253    16493        /*E* ERROR: ASF-E$FEXISTS-C
      254    16494             MESSAGE: That FORM already exists.
      255    16495             MESSAGE1: You can't create a FORM that already exists */
      256    16496           %SCREAM( ERR#=E$FEXISTS,MID='F',LEVEL=ERROR);
      257    16511    2      RETURN;
      258    16512    2      END;
      259    16513    1   IF (PSEUDO_FLG  \  (FORM_KEY.TEXT ~= F$->FS$FORMREC.FNAME)) = '1'B
      260    16514    2   THEN DO;
      261    16515    2      AS_FIELD1.COUNT = OUT$SYM.COUNT;
      262    16516    2      AS_FIELD1.TEXT  = OUT$SYM.TEXT;
      263    16517    2      IF PSEUDO_FLG
      264    16518    3      THEN DO;
      265    16519        /*E* ERROR:   ASF-E$NOT_FORM-C
      266    16520             MESSAGE: "%U1" is a form, not a pseudo form.
      267    16521        */
      268    16522              %SCREAM( ERR#=E$NOT_FORM, MID='F', LEVEL=WARN );
      269    16537    3         END;
      270    16538    3      ELSE DO;
      271    16539        /*E* ERROR:   ASF-E$NOT_PSEUDO-C
      272    16540             MESSAGE: "%U1" is a pseudo form, not a form.
      273    16541        */
      274    16542              %SCREAM( ERR#=E$NOT_PSEUDO, MID='F', LEVEL=WARN );
      275    16557    3         END;
      276    16558    2      PSEUDO_FLG = ~ PSEUDO_FLG;
      277    16559    2      END;
      278    16560    1   IF GRAPHIC
      279    16561    2   THEN DO;
      280    16562    2      OLD_TOTAL_LINES = 0;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:17   
      281    16563    2      END;
      282    16564    2   ELSE DO;
      283    16565    2      OLD_TOTAL_LINES = F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LENGTH
      284    16566    2           + F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LIMBO
      285    16567    2           + F$->FS$FORMREC.SOFTFORM.VLPPLATEN.FIRSTLINE;
      286    16568    2      END;
      287    16569    2   IF PSEUDO_FLG THEN DO;
      288    16570    2      PSEUDO_FORM_KEY.CNT = 12;
      289    16571    2      CALL CONCAT( PSEUDO_FORM_KEY.TXT, F$->FS$FORMREC.FNAME, FORM_KEY.TEXT );
      290    16572    2      ARS = 4;
      291    16573    2      CALL ASF$READ_FORM( PSEUDO_FORM_KEY, ADDR(PSEUDO_FORM_REC), ARS)
      292    16574    3      WHENALTRETURN DO;
      293    16575        /*E* ERROR: ASF-E$CANT_READ_FORM-C
      294    16576             MESSAGE: Unable to read form %U1 from :FORM file.
      295    16577        */
      296    16578    3         CALL ASH$ERROR( ERR_CODE );
      297    16579              %SCREAM( ERR#=E$CANT_READ_FORM, LEVEL=ERROR, MID='F' );
      298    16594    3         RETURN;
      299    16595    3         END;
      300    16596    2      LPOK = PSEUDO_FORM_REC.LPOK;
      301    16597    2      TSOK = PSEUDO_FORM_REC.TSOK;
      302    16598    2      ELSOK = PSEUDO_FORM_REC.ELSOK;
      303    16599    2      END;
      304    16600    2   ELSE DO;
      305    16601    2      LPOK  = F$->FS$FORMREC.LGLTYPS.LPOK;
      306    16602    2      TSOK = F$ -> FS$FORMREC.LGLTYPS.TSOK;
      307    16603    2      ELSOK = F$->FS$FORMREC.LGLTYPS.ELSOK;
      308    16604    2      END;
      309    16605    1   CALL ASF$QUERY_PSEUDO_FORMS( FORM_KEY, PSEUDO_FORM_KEY, PSEUDO_FORMS );
      310    16606    1   CM_FORM_OK:
      311    16607    1   SUBS = P$NODE.SUBNODES;
      312    16608    1   FROM = AS_FALSE;
      313    16609    1   IF P$NODE.SUBLK$(1)->P$NODE.CODE = 905 /* FORM_NAME_2 */ THEN
      314    16610    2   DO;
      315    16611    2      BLK$ = P$NODE.SUBLK$(1)->P$NODE.SUBLK$(0);
      316    16612    2      FROM = AS_TRUE;
      317    16613    2      IF OUT$SYM.COUNT > 6 THEN
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:18   
      318    16614    3      DO;
      319    16615        /*   ERROR: ASF-E$FNAMETOOBIG-0
      320    16616             DESCRIPTION: Form name too long.
      321    16617             DESCRIPTION: Form name can be at most 6 characters long.
      322    16618        */
      323    16619              %SCREAM( ERR#=E$FNAMETOOBIG,MID='F',LEVEL=ERROR);
      324    16634    3         RETURN;
      325    16635    3         END;
      326    16636    2      FORM_KEY_OLD.TEXT=OUT$SYM.TEXT;
      327    16637    2      END;
      328    16638    2   ELSE DO;
      329    16639    2      IF CREATE THEN
      330    16640    2         IF GRAPHIC
      331    16641    3         THEN DO;
      332    16642    3            FORM_KEY_OLD.TEXT='STDGR ';
      333    16643    3            END;
      334    16644    3         ELSE DO;
      335    16645    3            FORM_KEY_OLD.TEXT='STDLP ';
      336    16646    3            END;
      337    16647    2      ELSE
      338    16648    2         FORM_KEY_OLD.TEXT=FORM_KEY.TEXT;
      339    16649    2      END;
      340    16650    1   ARS = 2048 * 4;
      341    16651    1   CALL ASF$READ_FORM( FORM_KEY_OLD,F$,ARS)
      342    16652    2   WHENALTRETURN DO;
      343    16653        /*E* ERROR: ASF-E$FNOEXIST-0
      344    16654             MESSAGE: %%U1 %does not exist.
      345    16655             MESSAGE1: The specified FORM does not exist.
      346    16656        */
      347    16657    2      AS_FIELD1 = FORM_KEY_OLD;
      348    16658           %SCREAM( ERR#= E$FNOEXIST,MID='F',LEVEL=ERROR);
      349    16673    2      RETURN;
      350    16674    2      END;
      351    16675
      352    16676    1   IF GRAPHIC ~=  F$->FS$FORMREC.GRAPHIC
      353    16677    2   THEN DO;
      354    16678        /*E*  ERROR: ASF-E$NOMIXGR_ANDREGULARFORMS-C
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:19   
      355    16679              MESSAGE: Both form types must be the same.
      356    16680              MESSAGE1: One form is regular the other is graphic, this mix is not allowed.
      357    16681        */
      358    16682           %SCREAM (ERR#=E$NOMIXGR_ANDREGULARFORMS,MID='F',LEVEL=ERROR);
      359    16697    2      RETURN;
      360    16698    2      END;
      361    16699
      362    16700    1   IF F$->FS$FORMREC.GRAPHIC
      363    16701    2   THEN DO;
      364    16702    2      GRAPHIC = AS_TRUE;
      365    16703    2      END;
      366    16704
      367    16705    1   IF FROM  AND  FORM_KEY_OLD.TEXT ~= F$ -> FS$FORMREC.FNAME
      368    16706    2   THEN DO;
      369    16707    2      AS_FIELD1.COUNT = OUT$SYM.COUNT;
      370    16708    2      AS_FIELD1.TEXT  = OUT$SYM.TEXT;
      371    16709           %SCREAM( ERR#=E$NOT_PSEUDO, LEVEL=ERROR, MID='F' );
      372    16724    2      RETURN;
      373    16725    2      END;
      374    16726    1   IF PSEUDO_FLG THEN
      375    16727    2      IF CREATE THEN DO;
      376    16728    2         IF GRAPHIC
      377    16729    3         THEN DO;
      378    16730    3            LPOK = F$->FS$GFORMREC.LGLTYPS.LPOK;
      379    16731    3            TSOK = F$->FS$GFORMREC.LGLTYPS.TSOK;
      380    16732    3            ELSOK = F$->FS$GFORMREC.LGLTYPS.ELSOK;
      381    16733    3            OLD_TOTAL_LINES = 0;
      382    16734    3            END;
      383    16735    3         ELSE DO;
      384    16736    3            LPOK = F$->FS$FORMREC.LGLTYPS.LPOK;
      385    16737    3            TSOK = F$ -> FS$FORMREC.LGLTYPS.TSOK;
      386    16738    3            ELSOK = F$->FS$FORMREC.LGLTYPS.ELSOK;
      387    16739    3            OLD_TOTAL_LINES = F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LENGTH
      388    16740    3                 + F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LIMBO
      389    16741    3                 + F$->FS$FORMREC.SOFTFORM.VLPPLATEN.FIRSTLINE;
      390    16742    3            END;
      391    16743    2         END;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:20   
      392    16744    1      ELSE
      393    16745    1         FORM_KEY_OLD.TEXT = F$ -> FS$FORMREC.FNAME;
      394    16746    1   IF F$->FS$FORMREC.ACCTDISP ~= 0 THEN
      395    16747    2   DO;
      396    16748    2      ACCNT$ = PINCRW(DSEG1$,ACCNT_OFFSET);
      397    16749    2      MOVE_CNT = 1000 * 4;
      398    16750    2      FF$ = PINCRW(F$,F$->FS$FORMREC.ACCTDISP);
      399    16751    2      ACCNT$->TEMPLATE = FF$->TEMPLATE;
      400    16752    2      END;      /* Account  */
      401    16753    1   IF F$->FS$FORMREC.SETUPDISP ~= 0 AND NOT PSEUDO_FLG THEN
      402    16754    2   DO;
      403    16755    2      SETUP$ = PINCRW(DSEG2$,SETUP_OFFSET);
      404    16756    2      MOVE_CNT = 1500 * 4;
      405    16757    2      FF$ = PINCRW(F$,F$->FS$FORMREC.SETUPDISP);
      406    16758    2      SETUP$->TEMPLATE = FF$->TEMPLATE;
      407    16759    2      END;       /* Setup   */
      408    16760    1   IF F$->FS$FORMREC.BANRDISP ~= 0 THEN
      409    16761    2   DO;
      410    16762    2      BNNR$ = PINCRW(DSEG1$,BNNR_OFFSET);
      411    16763    2      MOVE_CNT = 1000 * 4;
      412    16764    2      FF$ = PINCRW(F$,F$->FS$FORMREC.BANRDISP);
      413    16765    2      BNNR$->TEMPLATE = FF$->TEMPLATE;
      414    16766    2      OLD_BANNER='1'B;
      415    16767    2      END;      /* Banner  */
      416    16768    1   IF F$->FS$FORMREC.ALGNDISP ~= 0 AND NOT PSEUDO_FLG THEN
      417    16769    2   DO;
      418    16770    2      ALGN$ = PINCRW(DSEG2$,ALGN_OFFSET);
      419    16771    2      MOVE_CNT = 1500 * 4;
      420    16772    2      FF$ = PINCRW(F$,F$->FS$FORMREC.ALGNDISP);
      421    16773    2      ALGN$->TEMPLATE = FF$ -> TEMPLATE;
      422    16774    2      OLD_ALGN = '1'B;
      423    16775    2      END;
      424    16776    1   IF F$->FS$FORMREC.ACCSDISP ~= 0 THEN
      425    16777    2   DO;
      426    16778    2      ACCSS$ = PINCRW(DSEG1$,ACCSS_OFFSET);
      427    16779    2      MOVE_CNT = 1000 * 4;
      428    16780    2      FF$ = PINCRW(F$,F$->FS$FORMREC.ACCSDISP);
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:21   
      429    16781    2      ACCSS$->TEMPLATE = FF$->TEMPLATE;
      430    16782    2      END;     /* Access  */
      431    16783    1   CHARSET$ = DSEG3$;
      432    16784
      433    16785    1   REMEMBER GET_OPTS IN REMEM_VAR;
      434    16786    1   GET_OPTS:
      435    16787    1   IF GRAPHIC
      436    16788    2   THEN DO;
      437    16789    2      CALL GFORM_OPTS;
      438    16790    2      NEW_TOTAL_LINES = 0;
      439    16791    2      END;
      440    16792    2   ELSE DO;
      441    16793    2      CALL FORM_OPTS; /* Get all options and update FS$FORMREC */
      442    16794    2      NEW_TOTAL_LINES = F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LENGTH
      443    16795    2           + F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LIMBO
      444    16796    2           + F$->FS$FORMREC.SOFTFORM.VLPPLATEN.FIRSTLINE;
      445    16797    2      END;
      446    16798    1   IF NEW_TOTAL_LINES ~= OLD_TOTAL_LINES THEN
      447    16799    2      IF PSEUDO_FLG THEN DO;
      448    16800        /*E* ERROR:   ASF-E$PSEUDO_LENGTH_WRONG-C
      449    16801        MESSAGE: Total length of pseudo form (FIRSTLINE + LENGTH + LIMBO) is not equal
      450    16802                 to the total length of form %U1. Re-enter pseudo form definition.
      451    16803        MESSAGE1: The total length (FIRSTLINE + LENGTH +LIMBO) of the pseudo form must
      452    16804                  equal the total length of the form. Total length of pseudo form = %U2.
      453    16805                  Total length of form %U1 = %U3.  Re-enter the pseudo form definition.
      454    16806        */
      455    16807    2         AS_FIELD1 = FORM_KEY_OLD;
      456    16808              %NUMBER( NUM2=NEW_TOTAL_LINES, NUM3=OLD_TOTAL_LINES );
             16824    2         CALL ASB$BINCHAR( AS_FIELD2.TEXT, 0, -2, NEW_TOTAL_LINES );
             16832    2         CALL ASB$BINCHAR( AS_FIELD3.TEXT, 0, -3, OLD_TOTAL_LINES );
      457    16838              %SCREAM( ERR#=E$PSEUDO_LENGTH_WRONG, LEVEL=ERROR, MID='F' );
      458    16853    2         RETURN;
      459    16854    2         END;
      460    16855    2      ELSE DO;
      461    16856    3         IF PSEUDO_FORMS THEN DO;
      462    16857        /*E*  ERROR:  ASF-E$FORM_LENGTH_CHANGED-C
      463    16858        MESSAGE: The total length (FIRSTLINE + LENGTH + LIMBO) of form %U1 has been
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:22   
      464    16859                 changed from %U2 to %U3.  Because of this change the following pseudo
      465    16860                 forms have been removed:
      466    16861        */
      467    16862    3            AS_FIELD1 = FORM_KEY;
      468    16863                 %NUMBER( NUM2=OLD_TOTAL_LINES, NUM3=NEW_TOTAL_LINES );
             16879    3         CALL ASB$BINCHAR( AS_FIELD2.TEXT, 0, -2, OLD_TOTAL_LINES );
             16887    3         CALL ASB$BINCHAR( AS_FIELD3.TEXT, 0, -3, NEW_TOTAL_LINES );
      469    16893                 %SCREAM( ERR#=E$FORM_LENGTH_CHANGED, LEVEL=WARN, MID='F' );
      470    16908    3            CALL ASR$R_PSEUDO_FORMS( PSEUDO_FORM_KEY );
      471    16909    3            END;
      472    16910    2         END;
      473    16911    1   IF PSEUDO_FLG THEN
      474    16912    1      F$->FS$FORMREC.FNAME = FORM_KEY_OLD.TEXT;
      475    16913    1   ELSE
      476    16914    1      F$->FS$FORMREC.FNAME=FORM_KEY.TEXT;
      477    16915    1   CALL FORM_GATHER
      478    16916    2   WHENRETURN DO;
      479    16917    2      ARS = DISP_TALLY * 4;
      480    16918    2      CALL ASF$WRITE_FORM(FORM_KEY,F$,ARS);
      481    16919    3      IF PSEUDO_FLG AND CREATE THEN DO;
      482    16920    3         PSEUDO_FORM_KEY.CNT = 12;
      483    16921    3         CALL CONCAT(PSEUDO_FORM_KEY.TXT, FORM_KEY_OLD.TEXT, FORM_KEY.TEXT );
      484    16922    3         PSEUDO_FORM_REC.ELSOK = ELSOK;
      485    16923    3         PSEUDO_FORM_REC.TSOK = TSOK;
      486    16924    3         PSEUDO_FORM_REC.LPOK = LPOK;
      487    16925    3         ARS = 4;
      488    16926    3         CALL ASF$WRITE_FORM( PSEUDO_FORM_KEY, ADDR(PSEUDO_FORM_REC), ARS );
      489    16927    3         END;
      490    16928    3      IF NOT PSEUDO_FLG AND PSEUDO_FORMS THEN DO;
      491    16929    3         I = 1;
      492    16930    4         IF NOT F$->FS$FORMREC.LGLTYPS.LPOK AND LPOK THEN DO;
      493    16931    4            LPOK = AS_FALSE;
      494    16932    4            I = 0;
      495    16933    4            END;
      496    16934    4         IF NOT F$->FS$FORMREC.LGLTYPS.TSOK AND TSOK THEN DO;
      497    16935    4            TSOK = AS_FALSE;
      498    16936    4            I = 0;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:23   
      499    16937    4            END;
      500    16938    4         IF NOT F$->FS$FORMREC.LGLTYPS.ELSOK AND ELSOK THEN DO;
      501    16939    4            ELSOK = AS_FALSE;
      502    16940    4            I = 0;
      503    16941    4            END;
      504    16942    3         IF I = 0 THEN CALL MOD_PSEUDO_FORMS;
      505    16943    3         END;
      506    16944    2      END; /* When return */
      507    16945    1   RETURN;
      508    16946    1   FORM_ERR:
      509    16947    1   CALL ASH$ERROR (P_PCB.ERROR);
      510    16948    1   RETURN;
      511    16949        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:24   
      512    16950    1   FORM_OPTS: PROC;
      513    16951        /****************************************************************
      514    16952        FORM_OPTS proccesses the options.  They are:
      515    16953
      516    16954
      517    16955        Wi[dth] = dec (0-508)
      518    16956              the decimal numberr specifies the maximum number of
      519    16957              characters to be written per line on the form.
      520    16958        Le[ngth] = dec (0-555)
      521    16959              the decimal number specifies the number of printable lines
      522    16960              on the page.  There are firstline+length+limbo total lines
      523    16961              on one page of the form.
      524    16962        Li[mbo] = dec (0-444)
      525    16963              specifies the number of lines to be left blank between the last
      526    16964              legal print line and the bottom of the page.
      527    16965        Fi[rstline] = dec (0-100)
      528    16966              specifies the height of the area which is to be left blank
      529    16967              between the beginning of the page and the first legal print
      530    16968              line.  It can also be considered the number of the first
      531    16969              legal print line.
      532    16970        Lpi = dec
      533    16971              specifies the number of lines per inch.
      534    16972        Fl[ags] = dec
      535    16973              this is used to set the flags feild. Currently, no flags are
      536    16974              defined.
      537    16975        Vf[uim]
      538    16976              this command indicats that you want to define the
      539    16977              vfu image for this form. Super will prompt for sub-options.
      540    16978              At that point, you type in definitions of the form:
      541    16979              Ch[an] dec = dec[,dec...]
      542    16980              for example, 'CHAN5 = 2,10' says that there is a channel 5 punch
      543    16981              for lines 2 and 10.
      544    16982        Se[tup]
      545    16983              this one says you want to define a message to be given to
      546    16984              the operator when he says 'SETUP formname'. Super will then
      547    16985              prompt with 'TXT*' and you can enter up to 10 lines of 72
      548    16986              characters each.  To end before that, simple type a blank line.
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:25   
      549    16987              If you type all 10 lines of setup info, super will inform
      550    16988              you of this by saying:
      551    16989              Setup buffer full, returning to 'OPT*' level.
      552    16990        Ac[cess] = tname[,tname,...]
      553    16991              the access options is used to set the access list of tnames,
      554    16992              to say which tnames can use this form.  You can put in from
      555    16993              one to 12 tname, and any of them may include the 'wild-card'
      556    16994              character '?'.
      557    16995        Ba[nner]
      558    16996        al[ignment]
      559    16997              these two options are described with the banner procedure,
      560    16998              which proccesses the sub-options for both of them.
      561    16999        Ch[arset] | chai[n] = charset name
      562    17000              is the 6 character name of an existing charset.  The lpok,
      563    17001              tsok, elsok, and ltyp device legality fields,
      564    17002              along with the attributes as described in the charset record,
      565    17003              are moved from the charset record to the graphic form record.
      566    17004        Acco[unt] = account[,account,...]
      567    17005              the account options is used to set the account list of account
      568    17006              names to say which accounts can use this form.  You can put in
      569    17007              from one to 12 accounts, and any of them may include the
      570    17008              'wild-card' character '?'.
      571    17009        Ba[nner]
      572    17010        al[ignment]
      573    17011              these two options are described with the banner procedure,
      574    17012              which proccesses the sub-options for both of them.
      575    17013        R[emove] ('b/anner' | 'A/LIGNMENT')
      576    17014              will remove either the banner or alignment image.
      577    17015        Tran/sparent [ l/egal] [= ('y/es'|'n/o')]
      578    17016           allows the specification of the transparent legal setting at the
      579    17017           form level in addition to the setting at the charset level.
      580    17018           This setting will override the charset setting.
      581    17019           The default is no and if the option appears on the command line
      582    17020           alone yes is assumed.
      583    17021        *****************************************************************/
      584    17022
      585    17023    2   DCL I UBIN WORD;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:26   
      586    17024    2   DCL J UBIN WORD;
      587    17025    2   DCL K UBIN WORD;
      588    17026    2   DCL L UBIN WORD;
      589    17027    2   DCL M UBIN WORD;
      590    17028    2   DCL PTR$ PTR;
      591    17029    2   DCL PTR2$ PTR;
      592    17030    2   DCL SUBNODES UBIN WORD;
      593    17031    2   DCL OP_CODE UBIN WORD;
      594    17032    2   DCL VAL UBIN WORD;
      595    17033    2   DCL DEV_TYPE CHAR(2);
      596    17034    2   DCL DEV_TYPE_A(0:1) REDEF DEV_TYPE CHAR(1);
      597    17035    2   DCL CHECK_VFU_FLG BIT(1);
      598    17036    2   DCL TRANSLGL_SET  BIT(1);
      599    17037    2   DCL TRANSLGL_VAL  BIT(1);
      600    17038    2   DCL ONEBIT  BIT(1)  BASED;
      601    17039
      602    17040
      603    17041    2   TRANSLGL_SET = AS_FALSE;
      604    17042    2   CHECK_VFU_FLG = AS_FALSE;
      605    17043    2   FORM_OPTS_LOOP:
      606    17044    2   CALL ASB$SET_PROMPT ( %PROMPT_OPT );
      607    17045    2   IF PSEUDO_FLG
      608    17046    2   THEN P_PCB.ROOT$ = ADDR( PSEUDO_OPTS_LIST );
      609    17047    2   ELSE P_PCB.ROOT$ = ADDR( FORM_OPTS_LIST );
      610    17048    3   DO WHILE ( AS_TRUE );
      611    17049    3      CALL ASB$READ_SI( IN_BUF, ARS);
      612    17050    3      P_PCB.NCHARS = ARS;
      613    17051    3      CALL X$PARSE( P_PCB ) ALTRET ( OPTS_ERR );
      614    17052    3      NODE$ = P_PCB.OUT$;
      615    17053    3      SUBNODES=P$NODE.SUBNODES;
      616    17054    4   DO_J: DO J = 0 TO SUBNODES - 1;
      617    17055    4         PTR$ = P$NODE.SUBLK$(J);
      618    17056    4         CODE = PTR$-> P$NODE.CODE;
      619    17057    4         IF PTR$->P$NODE.SUBNODES = 0
      620    17058    4         THEN OP_CODE = 1   /*  YES_VAL  */;
      621    17059    5         ELSE DO;
      622    17060    5            PTR2$=PTR$->P$NODE.SUBLK$(0);
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:27   
      623    17061    5            OP_CODE = PTR2$->P$NODE.CODE;
      624    17062    5            END;
      625    17063    5   DO_CASE: DO SELECT (CODE);
      626    17064    5            SELECT(16   /*  EOL_VAL  */);
      627    17065    5            ;
      628    17066    5            SELECT( 302 /* HELP_VAL */ );
      629    17067    5            CALL ASH$HELP;
      630    17068    5            SELECT( 301 /* QUESTION_VAL */ );
      631    17069    5            CALL ASH$QUEST;
      632    17070    5            SELECT( 300 /* DQUESTION_VAL */ );
      633    17071    5            CALL ASH$DQUEST;
      634    17072    5            SELECT(12   /*  END_VAL  */, 26   /*  BLANK_LINE_VAL */);
      635    17073    5            IF F$->FS$FORMREC.SOFTFORM.VFUIM.V ~= '0'B
      636    17074    5                 AND CHECK_VFU_FLG THEN
      637    17075    5               CALL CHECK_VFU_IMAGE;
      638    17076    5            IF TRANSLGL_SET THEN
      639    17077    6            DO;
      640    17078    6               PTR$ = PINCRB (ADDR (F$->FS$FORMREC.ATTR),10);
      641    17079    6               PTR$ -> ONEBIT = TRANSLGL_VAL;
      642    17080    6               END; /*  TRANSLGL_SET  */
      643    17081    5            RETURN;
      644    17082    5            SELECT( 17 /* F_WIDTH */ );
      645    17083    5            BLK$=PTR2$;
      646    17084    5            CALL CHARBIN( VAL, OUT$SYM.TEXT );
      647    17085    6            IF VAL > 508 THEN DO;
      648    17086        /*E* ERROR: ASF-E$BADWIDTH-0
      649    17087             MESSAGE: WIDTH too large.
      650    17088             MESSAGE1: WIDTH can not exceed 508 characters.
      651    17089        */
      652    17090                    %SCREAM( ERR#=E$BADWIDTH,MID='F',LEVEL=ERROR);
      653    17105    6               GOTO FORM_OPTS_LOOP_END;
      654    17106    6               END;
      655    17107    5            IF VAL > 254 THEN
      656    17108    6            DO;
      657    17109    6               VAL = VAL - 254;
      658    17110    6               F$->FS$FORMREC.SOFTFORM.VLPPLATEN.EXTWID= AS_TRUE;
      659    17111    6               END;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:28   
      660    17112    5            ELSE
      661    17113    5               F$->FS$FORMREC.SOFTFORM.VLPPLATEN.EXTWID= AS_FALSE;
      662    17114    5            F$->FS$FORMREC.SOFTFORM.VLPPLATEN.WIDTH = VAL;
      663    17115
      664    17116    5            SELECT( 18 /* F_LENGTH */ );
      665    17117    5            BLK$ = PTR2$;
      666    17118    5            CALL CHARBIN( VAL, OUT$SYM.TEXT);
      667    17119    6            IF (VAL <= 254) THEN DO;
      668    17120    6               IF VAL < F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LENGTH THEN
      669    17121    6                  CHECK_VFU_FLG = AS_TRUE;
      670    17122    6               F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LENGTH = VAL;
      671    17123    6               END;
      672    17124    6            ELSE DO;
      673    17125        /*E* ERROR: ASF-E$BADLENGTH-0
      674    17126             MESSAGE: LENGTH too large.
      675    17127             MESSAGE1: LENGTH range is 0 to 254 lines.
      676    17128        */
      677    17129                    %SCREAM( ERR#=E$BADLENGTH,MID='F',LEVEL=ERROR);
      678    17144    6               END;
      679    17145
      680    17146    5            SELECT ( 19 /* F_LIMBO */ );
      681    17147    5            BLK$= PTR2$;
      682    17148    5            CALL CHARBIN( VAL, OUT$SYM.TEXT);
      683    17149    6            IF VAL <= 254 THEN DO;
      684    17150    6               IF VAL = 0 AND F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LIMBO ~= 0 THEN
             17150                        CHECK_VFU_FLG = AS_TRUE;
      685    17151    6               F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LIMBO = VAL;
      686    17152    6               END;
      687    17153    6            ELSE DO;
      688    17154        /*E* ERROR: ASF-E$BADLIMBO-0
      689    17155             MESSAGE: LIMBO too large.
      690    17156             MESSAGE1: LIMBO can not exceed 254 lines.
      691    17157        */
      692    17158                    %SCREAM( ERR#= E$BADLIMBO,MID='F',LEVEL=ERROR);
      693    17173    6               END;
      694    17174
      695    17175    5            SELECT ( 20 /* F_FIRSTLINE */ );
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:29   
      696    17176    5            BLK$=PTR2$;
      697    17177    5            CALL CHARBIN( VAL, OUT$SYM.TEXT);
      698    17178    5            IF VAL <= 254 THEN
      699    17179    5               F$->FS$FORMREC.SOFTFORM.VLPPLATEN.FIRSTLINE = VAL;
      700    17180    6            ELSE DO;
      701    17181        /*E* ERROR: ASF-E$BADFIRSTLINE-0
      702    17182             MESSAGE: FIRSTLINE too large.
      703    17183             MESSAGE1: FIRSTLINE must not exceed 254.
      704    17184        */
      705    17185                    %SCREAM( ERR#= E$BADFIRSTLINE,MID='F',LEVEL=ERROR);
      706    17200    6               END;
      707    17201
      708    17202    5            SELECT( 21 /* F_LPI */ );
      709    17203    5            BLK$=PTR2$;
      710    17204    5            CALL CHARBIN ( VAL, OUT$SYM.TEXT);
      711    17205    5            IF VAL <= 10 THEN
      712    17206    5               F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LPI = VAL;
      713    17207    6            ELSE DO;
      714    17208        /*E* ERROR: ASF-E$BADLPI-0
      715    17209             MESSAGE: LPI is too large.
      716    17210             MESSAGE1: LPI range is from 0 to 10, inclusive.
      717    17211             MESSAGE2: The LPI value must be supported in the hardware.
      718    17212        */
      719    17213                    %SCREAM( ERR#= E$BADLPI,MID='F',LEVEL=ERROR);
      720    17228    6               END;
      721    17229
      722    17230    5            SELECT( 27 /* F_FLAGS */ );
      723    17231    5            BLK$ = PTR2$;
      724    17232    5            CALL CHARBIN( VAL, OUT$SYM.TEXT);
      725    17233    5            IF VAL <= 128 THEN
      726    17234    5               F$->FS$FORMREC.FLAGS = BINBIT(VAL, 7);
      727    17235    6            ELSE DO;
      728    17236        /*E* ERROR: ASF-E$BADFLAGS-0
      729    17237             MESSAGE: FLAGS too large.
      730    17238             MESSAGE1: FLAGS must be less than 128.
      731    17239        */
      732    17240                    %SCREAM( ERR#=E$BADFLAGS,MID='F',LEVEL=ERROR);
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:30   
      733    17255    6               END;
      734    17256
      735    17257    5            SELECT( 28 /* F_VFUIM */ );
      736    17258    5            CALL VFUIM;
      737    17259    5            GOTO FORM_OPTS_LOOP;
      738    17260
      739    17261    5            SELECT( 29 /* F_SETUP */ );
      740    17262    5            CALL SETUP;
      741    17263    5            GOTO FORM_OPTS_LOOP;
      742    17264
      743    17265        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:31   
      744    17266    5            SELECT( 30 /* F_ACCESS */, 61 /*F_ACCESS_ADD_VAL */, 62
             17266                     /*F_ACCESS_REM_VAL */ );
      745    17267    5            SUBS = PTR$->P$NODE.SUBNODES;
      746    17268        /*
      747    17269
      748    17270              1000 words will be used to save the access info
      749    17271              each account entered in this structure will take
      750    17272              two words, so we have room for about 500
      751    17273
      752    17274              first build a pointer to the data segment that was
      753    17275              returned from ASB$GETSEG.
      754    17276
      755    17277              Access will begin at word 1000 of the first
      756    17278              data segment that was gotten.  It will be 1000
      757    17279              words long
      758    17280
      759    17281        */
      760    17282    6            IF ACCSS$ = ADDR(NIL) THEN DO;
      761    17283    6               ACCSS$ = PINCRW(DSEG1$,ACCSS_OFFSET) ;
      762    17284    6               ACCSS$->FS$ACCESS.TNAMES = 0;
      763    17285    6               END;
      764    17286    6            IF CODE = 30 /* F_ACCESS */ THEN DO;
      765    17287    6               ACCSS$->FS$ACCESS.TNAMES = 0;
      766    17288    6               IF SUBS = 0 THEN F$->FS$FORMREC.ACCSDISP = 0 ;
      767    17289    6               END;
      768    17290    6            DO K = 0 TO SUBS -1;
      769    17291    6               BLK$ = PTR$->P$NODE.SUBLK$(K);
      770    17292    7               IF OUT$SYM.COUNT > 8 THEN DO;
      771    17293        /*E* ERROR: ASF-E$BADACCESS-0
      772    17294             MESSAGE: ACCESS terminal name too long: "%U1".
      773    17295             MESSAGE1: Terminal names must not be more than 8 characters long.
      774    17296        */
      775    17297    7                  AS_FIELD1.COUNT = OUT$SYM.COUNT;
      776    17298    7                  AS_FIELD1.TEXT = OUT$SYM.TEXT;
      777    17299                       %SCREAM( ERR#=E$BADACCESS,MID='F',LEVEL=ERROR);
      778    17314    7                  GOTO F_ACCESS_LOOP_END;
      779    17315    7                  END;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:32   
      780    17316    7               IF CODE = 30 /* F_ACCESS */ THEN DO;
      781    17317    7                  ACCSS$->FS$ACCESS.LIST(K) = OUT$SYM.TEXT;
      782    17318    7                  ACCSS$->FS$ACCESS.TNAMES = ACCSS$->FS$ACCESS.TNAMES+1;
      783    17319    7                  END;
      784    17320    7               ELSE DO;
      785    17321    7                  L = 0;
      786    17322    8                  DO WHILE( L < ACCSS$->FS$ACCESS.TNAMES );
      787    17323    8                     IF ACCSS$->FS$ACCESS.LIST(L) = OUT$SYM.TEXT
      788    17324    8                     THEN GOTO FOUND_ACCESS;
      789    17325    8                     L = L + 1;
      790    17326    8                     END;
      791    17327    8                  IF CODE = 62 /*F_ACCESS_REM_VAL */ THEN DO;
      792    17328        /*E* ERROR:   ASF-E$F_ACCESS_NO_EXIST-C
      793    17329             MESSAGE: %U1 does not exist in the ACCESS list.
      794    17330        */
      795    17331    8                     AS_FIELD1.COUNT = OUT$SYM.COUNT;
      796    17332    8                     AS_FIELD1.TEXT  = OUT$SYM.TEXT;
      797    17333                          %SCREAM(ERR#=E$F_ACCESS_NO_EXIST,LEVEL=WARN,MID='F');
      798    17348    8                     END;
      799    17349    8                  ELSE DO;
      800    17350    8                     ACCSS$->FS$ACCESS.LIST(L) = OUT$SYM.TEXT;
      801    17351    8                     ACCSS$->FS$ACCESS.TNAMES = L + 1;
      802    17352    8                     END;
      803    17353    8                  DO WHILE( AS_FALSE );
      804    17354    9   FOUND_ACCESS:     IF CODE = 62 /*F_ACCESS_REM_VAL */ THEN DO;
      805    17355   10                        DO M = L+1 TO ACCSS$->FS$ACCESS.TNAMES-1;
      806    17356   10                           ACCSS$->FS$ACCESS.LIST(M-1) = ACCSS$->FS$ACCESS.LIST(M);
      807    17357   10                           END;
      808    17358    9                        ACCSS$->FS$ACCESS.TNAMES = ACCSS$->FS$ACCESS.TNAMES-1;
      809    17359    9                        END;
      810    17360    8                     END;
      811    17361    7                  END;
      812    17362    6   F_ACCESS_LOOP_END:
      813    17363    6               END; /*  K loop     */
      814    17364        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:33   
      815    17365    5            SELECT( 31 /* F_BANNER */ );
      816    17366    5            CALL BANNER(0);
      817    17367    5            GOTO FORM_OPTS_LOOP;
      818    17368
      819    17369    5            SELECT( 32 /* F_ALIGNMENT */ );
      820    17370    5            CALL BANNER(1);
      821    17371    5            GOTO FORM_OPTS_LOOP;
      822    17372
      823    17373    5            SELECT( 65 /*F_REMOVE_BANNER_VAL*/ );
      824    17374    5            BNNR$ = ADDR(NIL);
      825    17375    5            OLD_BANNER = '0'B;
      826    17376
      827    17377    5            SELECT( 66 /*F_REMOVE_ALIGN_VAL*/ );
      828    17378    5            ALGN$ = ADDR(NIL);
      829    17379    5            OLD_ALGN = '0'B;
      830    17380
      831    17381        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:34   
      832    17382    5            SELECT( 35 /* F_ACCOUNT  */, 63 /*F_ACCOUNT_ADD_VAL */, 64
             17382                     /*F_ACCOUNT_REM_VAL */ );
      833    17383    5            SUBS = PTR$->P$NODE.SUBNODES ;
      834    17384        /*
      835    17385
      836    17386              1000 words will be used to save the accounts info
      837    17387              each account entered in this structure will take
      838    17388              two words, so we have room for about 500
      839    17389        */
      840    17390        /*
      841    17391
      842    17392              First build a pointer to the data segment that was
      843    17393              returned from ABS$GETSEG
      844    17394
      845    17395              accounts will begin at word zero of the first
      846    17396              data segment that was gotten.  It will be 1000
      847    17397              words long
      848    17398
      849    17399        */
      850    17400    6            IF ACCNT$ = ADDR(NIL) THEN DO;
      851    17401    6               ACCNT$ = PINCRW(DSEG1$,ACCNT_OFFSET) ;
      852    17402    6               ACCNT$->FS$ACCOUNTS.TACCTS = 0;
      853    17403    6               END;
      854    17404        /*
      855    17405
      856    17406        */
      857    17407    6            IF CODE = 35 /* F_ACCOUNT  */ THEN DO;
      858    17408    6               ACCNT$->FS$ACCOUNTS.TACCTS = 0 ;
      859    17409    6               IF SUBS = 0 THEN F$->FS$FORMREC.ACCTDISP = 0;
      860    17410    6               END;
      861    17411    6            DO K = 0 TO SUBS -1;
      862    17412    6               BLK$ = PTR$->P$NODE.SUBLK$(K);
      863    17413    7               IF OUT$SYM.COUNT > 8 THEN DO;
      864    17414        /*E* ERROR: ASF-E$BADACCOUNT-0
      865    17415             MESSAGE: Account name too long: "%U1".
      866    17416             MESSAGE1: Account names must not be more than 8 characters long.
      867    17417        */
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:35   
      868    17418    7                  AS_FIELD1.COUNT = OUT$SYM.COUNT;
      869    17419    7                  AS_FIELD1.TEXT  = OUT$SYM.TEXT;
      870    17420                       %SCREAM( ERR#=E$BADACCOUNT ,MID='F',LEVEL=ERROR);
      871    17435    7                  GOTO F_ACCOUNT_LOOP_END;
      872    17436    7                  END;
      873    17437    7               IF CODE = 35 /* F_ACCOUNT  */ THEN DO;
      874    17438    7                  ACCNT$->FS$ACCOUNTS.LIST(K) = OUT$SYM.TEXT;
      875    17439    7                  ACCNT$->FS$ACCOUNTS.TACCTS = ACCNT$->FS$ACCOUNTS.TACCTS + 1;
      876    17440    7                  END;
      877    17441    7               ELSE DO;
      878    17442    7                  L = 0;
      879    17443    8                  DO WHILE( L < ACCNT$->FS$ACCOUNTS.TACCTS );
      880    17444    8                     IF ACCNT$->FS$ACCOUNTS.LIST(L) = OUT$SYM.TEXT
      881    17445    8                     THEN GOTO FOUND_ACCOUNT;
      882    17446    8                     L = L + 1;
      883    17447    8                     END;
      884    17448    8                  IF CODE = 64 /*F_ACCOUNT_REM_VAL */ THEN DO;
      885    17449        /*E* ERROR:   ASF-E$F_ACCOUNT_NO_EXIST-C
      886    17450             MESSAGE: %U1 does not exist in the ACCOUNT list.
      887    17451        */
      888    17452    8                     AS_FIELD1.COUNT = OUT$SYM.COUNT;
      889    17453    8                     AS_FIELD1.TEXT  = OUT$SYM.TEXT;
      890    17454                          %SCREAM(ERR#=E$F_ACCOUNT_NO_EXIST,LEVEL=WARN,MID='F');
      891    17469    8                     END;
      892    17470    8                  ELSE DO;
      893    17471    8                     ACCNT$->FS$ACCOUNTS.LIST(L) = OUT$SYM.TEXT;
      894    17472    8                     ACCNT$->FS$ACCOUNTS.TACCTS = L + 1;
      895    17473    8                     END;
      896    17474    8                  DO WHILE( '0'B );
      897    17475    9   FOUND_ACCOUNT:    IF CODE = 64 /*F_ACCOUNT_REM_VAL */ THEN DO;
      898    17476   10                        DO M = L+1 TO ACCNT$->FS$ACCOUNTS.TACCTS-1;
      899    17477   10                           ACCNT$->FS$ACCOUNTS.LIST(M-1) = ACCNT$->FS$ACCOUNTS.LIST(M);
      900    17478   10                           END;
      901    17479    9                        ACCNT$->FS$ACCOUNTS.TACCTS = ACCNT$->FS$ACCOUNTS.TACCTS-1;
      902    17480    9                        END;
      903    17481    8                     END;
      904    17482    7                  END;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:36   
      905    17483    6   F_ACCOUNT_LOOP_END:
      906    17484    6               END; /*   K loop   */
      907    17485
      908    17486    5            SELECT (36 /* F_CHAIN */) ;
      909    17487    5            BLK$ = PTR2$->P$NODE.SUBLK$(0);
      910    17488    5            IF OUT$SYM.COUNT > 8
      911    17489    6            THEN DO;
      912    17490        /*E* ERROR: ASF-E$CHARSETTOOBIG-C
      913    17491             MESSAGE: That charset name is too long.
      914    17492             MESSAGE1: The maximum size of a charset name is 8 characters.
      915    17493        */
      916    17494                    %SCREAM(ERR#=E$CHARSETTOOBIG,MID='F',LEVEL=ERROR);
      917    17509    6               END;
      918    17510    6            ELSE DO;
      919    17511    6               CHARSET_KEY.CNT = OUT$SYM.COUNT + 8;
      920    17512    6               CALL CONCAT (CHARSET_KEY.TXT, '~',
      921    17513    6                    SUBSTR(OUT$SYM.TEXT,0,OUT$SYM.COUNT),'CHARSET');
      922    17514    6               ARS = SIZEB(CHARSET);
      923    17515    6               CALL ASF$READ_FORM (CHARSET_KEY, CHARSET$, ARS)
      924    17516    7               WHENRETURN DO;
      925    17517    7                  F$->FS$FORMREC.LGLTYPS = CHARSET.LGLTYPS;
      926    17518    7                  F$->FS$FORMREC.ATTR = CHARSET.ATTRS;
      927    17519    7                  F$->FS$FORMREC.CHAINIMAGE = CHARSET.CHAINIMAGE;
      928    17520    7                  F$->FS$FORMREC.CHAIN_NAME = OUT$SYM.TEXT;
      929    17521    7                  END;
      930    17522    7               WHENALTRETURN DO;
      931    17523    7                  IF MERR_CODE.CODE ~= %E$NOREC
      932    17524    8                  THEN DO;
      933    17525        /*E* ERROR: ASF-E$BADCHAIN-C
      934    17526             MESSAGE: Charset %U1 does not exist.
      935    17527             MESSAGE1: Charsets must exist before their contents can move to
      936    17528                       the form definition.
      937    17529        */
      938    17530    8                     AS_FIELD1.COUNT = OUT$SYM.COUNT;
      939    17531    8                     AS_FIELD1.TEXT = OUT$SYM.TEXT;
      940    17532                          %SCREAM(ERR#=E$BADCHAIN, MID='F', LEVEL=ERROR);
      941    17547    8                     END;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:37   
      942    17548    8                  ELSE DO;
      943    17549    8                     CALL ASH$ERROR (P_PCB.ERROR);
      944    17550    8                     END;
      945    17551    7                  END;
      946    17552    6               END;
      947    17553
      948    17554    5            SELECT ( 22 /* F_TRANSLGL */ );
      949    17555    5            TRANSLGL_SET = AS_TRUE;
      950    17556    5            IF OP_CODE = 1 THEN
      951    17557    5               TRANSLGL_VAL = AS_TRUE;
      952    17558    5            ELSE
      953    17559    5               TRANSLGL_VAL = AS_FALSE;
      954    17560    5            END DO_CASE;
      955    17561    4         END DO_J;
      956    17562    3   FORM_OPTS_LOOP_END:;
      957    17563    3      END;
      958    17564    2   OPTS_ERR:
      959    17565    2   CALL ASH$ERROR ( P_PCB.ERROR );
      960    17566    2   GOTO FORM_OPTS_LOOP;
      961    17567        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:38   
      962    17568    2   VFUIM: PROC;
      963    17569    3   DCL MORE BIT(1);
      964    17570    3   DCL NUM UBIN WORD;
      965    17571    3   DCL I UBIN WORD;
      966    17572    3   DCL CHAN UBIN WORD;
      967    17573    3   DCL PTR$ PTR;
      968    17574    3   DCL CODE UBIN WORD;
      969    17575    3   DCL SUBNODES UBIN WORD;
      970    17576    3   DCL NEXT UBIN WORD;
      971    17577
      972    17578
      973    17579
      974    17580
      975    17581    3   CHECK_VFU_FLG = AS_FALSE;
      976    17582    3   P_PCB.ROOT$ = ADDR( F_VFU_LIST );
      977    17583    3   MORE = AS_TRUE;
      978    17584    3   F$->FS$FORMREC.SOFTFORM.VFUIM.V = '0'B;
      979    17585    3   NUM = 0;
      980    17586    3   NEXT = 16;
      981    17587    4   VFU_LOOP: DO WHILE( MORE );
      982    17588    4      CALL ASB$SET_PROMPT ( %PROMPT_SUB );
      983    17589    4      CALL ASB$READ_SI( IN_BUF,ARS );
      984    17590    4      P_PCB.NCHARS= ARS;
      985    17591    4      CALL X$PARSE( P_PCB ) ALTRET (VFU_ERR);
      986    17592    4      NODE$=P_PCB.OUT$;
      987    17593    5   DO_I: DO I = 0 TO P$NODE.SUBNODES -1;
      988    17594    5         PTR$=P$NODE.SUBLK$(I);
      989    17595    5         CODE=PTR$->P$NODE.CODE;
      990    17596    6   DO_CASE: DO SELECT (CODE);
      991    17597    6            SELECT( 302 /* HELP_VAL */ );
      992    17598    6            CALL ASH$HELP;
      993    17599    6            SELECT( 301 /* QUESTION_VAL */ );
      994    17600    6            CALL ASH$QUEST;
      995    17601    6            SELECT( 300 /* DQUESTION_VAL */ );
      996    17602    6            CALL ASH$DQUEST;
      997    17603    6            SELECT(12   /*  END_VAL  */,26   /*  BLANK_LINE_VAL */);
      998    17604    6            RETURN;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:39   
      999    17605    6            SELECT(41 /* FV_CHAN_VAL */);
     1000    17606    6            PTR2$=PTR$->P$NODE.SUBLK$(0);
     1001    17607    6            BLK$=PTR2$;
     1002    17608    6            CALL CHARBIN( VAL,OUT$SYM.TEXT);
     1003    17609    7            IF VAL < 1 OR VAL > 15 THEN DO;
     1004    17610        /*E* ERROR: ASF-E$BADCHAN-0
     1005    17611             MESSAGE: CHAN must be 1 to 15.
     1006    17612        */
     1007    17613                    %SCREAM( ERR#=E$BADCHAN,MID='F',LEVEL=ERROR);
     1008    17628    7               GOTO VFU_LOOP;
     1009    17629    7               END;
     1010    17630    6            CHAN=VAL;
     1011    17631    6            BLK$=PTR$->P$NODE.SUBLK$(1);
     1012    17632    6            CALL GET_VFU_VAL ALTRET(VFU_LOOP);
     1013    17633    6            NUM = NUM+1;
     1014    17634    6            IF NUM > 29 THEN GOTO VFU_NUM;
     1015    17635    6            F$->FS$FORMREC.SOFTFORM.VFUIM.V.LINE(CHAN) = VAL;
     1016    17636    7            DO K = 2 TO PTR$->P$NODE.SUBNODES -1;
     1017    17637    7               BLK$=PTR$->P$NODE.SUBLK$(K);
     1018    17638    7               CALL GET_VFU_VAL ALTRET(VFU_LOOP);
     1019    17639    7               NUM = NUM+1;
     1020    17640    7               IF NUM > 29 THEN GOTO VFU_NUM;
     1021    17641    7               F$->FS$FORMREC.SOFTFORM.VFUIM.V.LINE(NEXT) = VAL;
     1022    17642    7               F$->FS$FORMREC.SOFTFORM.VFUIM.V.NEXT(CHAN) = NEXT;
     1023    17643    7               CHAN=NEXT;
     1024    17644    7               NEXT=NEXT+1;
     1025    17645    7               END;
     1026    17646    6            END DO_CASE;
     1027    17647    5         END DO_I;
     1028    17648    4      END VFU_LOOP;
     1029    17649    3   VFU_NUM:
     1030    17650        /*E* ERROR: ASF-E$VFUCOUNT-0
     1031    17651             MESSAGE: Too many VFU values.
     1032    17652             MESSAGE1: There can be no more than 29 VFU values.
     1033    17653        */
     1034    17654        %SCREAM( ERR#=E$VFUCOUNT ,MID='F',LEVEL=ERROR);
     1035    17669    3   RETURN;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:40   
     1036    17670
     1037    17671
     1038    17672    3   VFU_ERR:
     1039    17673    3   CALL ASH$ERROR( P_PCB.ERROR );
     1040    17674    3   GOTO VFU_LOOP;
     1041    17675
     1042    17676
     1043    17677
     1044    17678    3   GET_VFU_VAL: PROC ALTRET;
     1045    17679
     1046    17680    4   DCL J SBIN;
     1047    17681
     1048    17682    4   CALL CHARBIN( VAL, OUT$SYM.TEXT );
     1049    17683    5   DO J = 0 TO 31 ;
     1050    17684    6      IF VAL = F$->FS$FORMREC.SOFTFORM.VFUIM.V.LINE (J) THEN DO;
     1051    17685        /*E* ERROR : ASF-E$VFUVAL_EXISTS-C
     1052    17686             MESSAGE: VFU value %U1 cannot be defined twice.
     1053    17687        */
     1054    17688              %NUMBER (NUM1 = VAL) ;
             17696    6         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, VAL );
     1055    17718              %SCREAM (ERR#=E$VFUVAL_EXISTS,LEVEL=ERROR,MID = 'F') ;
     1056    17733    6         ALTRETURN ;
     1057    17734    6         END ;
     1058    17735    5      END;
     1059    17736    5   IF VAL > 511 THEN DO;
     1060    17737        /*E* ERROR: ASF-E$VFUVAL-C
     1061    17738             MESSAGE: VFU values must not exceed 511.
     1062    17739        */
     1063    17740           %SCREAM( ERR#=E$VFUVAL,MID='F',LEVEL=ERROR);
     1064    17755    5      ALTRETURN;
     1065    17756    5      END;
     1066    17757    4   J = F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LENGTH;
     1067    17758    5   IF F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LIMBO = 0 THEN DO;
     1068    17759    6      IF VAL >= J - 1 THEN DO;
     1069    17760        /*E* ERROR: ASF-E$VFU_LENGTH_1-C
     1070    17761             MESSAGE: VFU value must be less than LENGTH-1 ( %U1 ) when LIMBO = 0.
     1071    17762        */
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:41   
     1072    17763    6         J = J - 1;
     1073    17764              %NUMBER( NUM1=J );
             17772    6         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, J );
     1074    17794              %SCREAM( ERR#=E$VFU_LENGTH_1, LEVEL=ERROR, MID='F' );
     1075    17809    6         ALTRETURN;
     1076    17810    6         END;
     1077    17811    5      END;
     1078    17812    4   ELSE
     1079    17813    5      IF VAL >= J THEN DO;
     1080    17814        /*E* ERROR: ASF-E$VFU_LENGTH-C
     1081    17815             MESSAGE: VFU value must be less than LENGTH ( %U1 ).
     1082    17816        */
     1083    17817              %NUMBER( NUM1=J );
             17825    5         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, J );
     1084    17847              %SCREAM( ERR#=E$VFU_LENGTH, MID='F', LEVEL=ERROR );
     1085    17862    5         ALTRETURN;
     1086    17863    5         END;
     1087    17864
     1088    17865
     1089    17866    4   END GET_VFU_VAL;
     1090    17867
     1091    17868
     1092    17869
     1093    17870
     1094    17871    3   END VFUIM;
     1095    17872
     1096    17873
     1097    17874        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:42   
     1098    17875    2   CHECK_VFU_IMAGE: PROC;
     1099    17876
     1100    17877    3   DCL VAL SBIN;
     1101    17878    3   DCL CHAN SBIN;
     1102    17879    3   DCL NEXT SBIN;
     1103    17880
     1104    17881
     1105    17882    4   DO CHAN = 1 TO 15;
     1106    17883    4      VAL = F$->FS$FORMREC.SOFTFORM.VFUIM.V.LINE(CHAN);
     1107    17884    4      CALL CHECK_VFU_VAL ALTRET(EXIT#);
     1108    17885    4      NEXT = F$->FS$FORMREC.SOFTFORM.VFUIM.V.NEXT(CHAN);
     1109    17886    5      DO WHILE( NEXT ~= 0 );
     1110    17887    5         VAL = F$->FS$FORMREC.SOFTFORM.VFUIM.V.LINE(NEXT);
     1111    17888    5         CALL CHECK_VFU_VAL ALTRET(EXIT#);
     1112    17889    5         NEXT = F$->FS$FORMREC.SOFTFORM.VFUIM.V.NEXT(VAL);
     1113    17890    5         END;
     1114    17891    4      END;
     1115    17892    3   EXIT#:
     1116    17893    3   RETURN;
     1117    17894
     1118    17895
     1119    17896
     1120    17897    3   CHECK_VFU_VAL: PROC  ALTRET;
     1121    17898
     1122    17899
     1123    17900    4   DCL J   SBIN;
     1124    17901
     1125    17902
     1126    17903    4   J = F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LENGTH;
     1127    17904    5   IF F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LIMBO = 0 THEN DO;
     1128    17905    6      IF VAL >= J-1 THEN DO;
     1129    17906        /*E* ERROR: ASF-E$RE_ENTER_VFU1-C
     1130    17907             MESSAGE: CHAN%U1 = %U2 must be less than LENGTH-1 ( %U3 ) when LIMBO = 0.
     1131    17908                      The VFU image must be re-entered.
     1132    17909        */
     1133    17910    6         J = J - 1;
     1134    17911              %NUMBER( NUM1=CHAN, NUM2=VAL, NUM3=J );
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:43   
             17919    6         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, CHAN );
             17927    6         CALL ASB$BINCHAR( AS_FIELD2.TEXT, 0, -2, VAL );
             17935    6         CALL ASB$BINCHAR( AS_FIELD3.TEXT, 0, -3, J );
     1135    17941              %SCREAM( ERR#=E$RE_ENTER_VFU1, LEVEL=ERROR, MID='F' );
     1136    17956    6         F$->FS$FORMREC.SOFTFORM.VFUIM.V = '0'B;
     1137    17957    6         ALTRETURN;
     1138    17958    6         END;
     1139    17959    5      END;
     1140    17960    4   ELSE
     1141    17961    5      IF VAL >= J THEN DO;
     1142    17962        /*E* ERROR: ASF-E$RE_ENTER_VFU2-C
     1143    17963             MESSAGE: CHAN%U1 = %U2 must be less than LENGTH ( %U3 ).
     1144    17964                      The VFU image must be re-entered.
     1145    17965        */
     1146    17966              %NUMBER( NUM1=CHAN, NUM2=VAL, NUM3=J );
             17974    5         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, CHAN );
             17982    5         CALL ASB$BINCHAR( AS_FIELD2.TEXT, 0, -2, VAL );
             17990    5         CALL ASB$BINCHAR( AS_FIELD3.TEXT, 0, -3, J );
     1147    17996              %SCREAM( ERR#=E$RE_ENTER_VFU2, LEVEL=ERROR, MID='F' );
     1148    18011    5         F$->FS$FORMREC.SOFTFORM.VFUIM.V = '0'B;
     1149    18012    5         ALTRETURN;
     1150    18013    5         END;
     1151    18014
     1152    18015    4   END CHECK_VFU_VAL;
     1153    18016
     1154    18017
     1155    18018    3   END CHECK_VFU_IMAGE;
     1156    18019        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:44   
     1157    18020    2   SETUP: PROC;
     1158    18021
     1159    18022
     1160    18023    3   DCL I UBIN WORD;
     1161    18024    3   DCL CODE2 UBIN WORD;
     1162    18025        /*
     1163    18026              1500 words will be used to save the setup info
     1164    18027              this allows 83 lines of input
     1165    18028        */
     1166    18029        /*    First build a pointer to the data segment that was
     1167    18030              returned from ASB$GETSEG.
     1168    18031
     1169    18032              Setup will begin at word 0 of the second
     1170    18033              segment gotten
     1171    18034
     1172    18035        */
     1173    18036        /*
     1174    18037        */
     1175    18038    3   SETUP$ = PINCRW(DSEG2$,SETUP_OFFSET);       /* Ptr to our setup area   */
     1176    18039    4   DO I = 0 TO 82;
     1177    18040    4      SETUP$->FS$SETUP.TXT(I) = ' ';
     1178    18041    4      END;
     1179    18042    3   F$->FS$SETUP.LINES = 0 ;
     1180    18043    3   CALL ASB$SET_PROMPT ( %PROMPT_TXT );
     1181    18044    3   I = 0;
     1182    18045    4   DO UNTIL( I = 83  OR  IN_BUF = ' ' );
     1183    18046    4      CALL ASB$READ_SI( IN_BUF,ARS);
     1184    18047    5      IF IN_BUF ~= ' ' THEN DO;
     1185    18048    6         IF ARS <= 72 THEN DO;
     1186    18049    6            SETUP$ -> FS$SETUP.TXT(I) = IN_BUF;
     1187    18050    6            I = I + 1;
     1188    18051    6            END;
     1189    18052    6         ELSE DO;
     1190    18053        /*E* ERROR: ASF-E$SETUPBAD-C
     1191    18054             MESSAGE: SETUP text must be 72 characters or less per line.
     1192    18055        */
     1193    18056                 %SCREAM( ERR#=E$SETUPBAD,MID='F',LEVEL=ERROR);
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:45   
     1194    18071    6            END;
     1195    18072    5         END;
     1196    18073    4      END;        /* do until */
     1197    18074    4   IF I = 83 THEN DO;
     1198    18075        /*E* ERROR:   ASF-E$SETUP_FULL-C
     1199    18076             MESSAGE: SETUP buffer full, returning to 'OPT*' level.
     1200    18077        */
     1201    18078           %SCREAM( ERR#=E$SETUP_FULL, MID='F', LEVEL=WARN );
     1202    18093    4      END;
     1203    18094    3   SETUP$ -> FS$SETUP.LINES = I;
     1204    18095    3   IF I = 0 THEN F$ -> FS$FORMREC.SETUPDISP = 0;
     1205    18096    3   RETURN;
     1206    18097
     1207    18098
     1208    18099    3   END SETUP;
     1209    18100        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:46   
     1210    18101    2   BANNER: PROC (A);
     1211    18102        /****************************************************************
     1212    18103        Banner proccesses the sub-options for both banners and alignments.
     1213    18104        The format is:
     1214    18105
     1215    18106        Ba[nner]
     1216    18107        al[ignment]
     1217    18108              these two options define the banner and alignment image for
     1218    18109              this form.  Super will ask for sub-options. They are:
     1219    18110              Ch[arge] [=yes|no]
     1220    18111                  legal only for banners.  This says whether or not to
     1221    18112                  charge the user for the banner pages.
     1222    18113                  If '=yes|no' is ommited, yes is assumed.
     1223    18114              Re[peats] = dec
     1224    18115                  this says how many times to repeat this entire banner or
     1225    18116                  alignment image.  If this option is ommited, it defaults
     1226    18117                  to one if there are any entries, and zero if there are none.
     1227    18118              Al[ign][every] [=yes|no]
     1228    18119                  legal only for alignment images.  This says whether to
     1229    18120                  print the alignment after every file or not. Default is no.
     1230    18121              En[try] = row,col[,font,strikes,icsh,reps,rinc,cinc]
     1231    18122                  this options defines one element of this banner or alignment,
     1232    18123                  and may be used as many times as needed. The values are:
     1233    18124
     1234    18125                  row : the row to start printing this element
     1235    18126                  col : the column to start at
     1236    18127                  font: The font to use. 0 means standard typing, 1-3 are
     1237    18128                         block-print fonts. 1 includes lower case.
     1238    18129                          defaults to zero.
     1239    18130                  strikes: how many times to overprint this element.
     1240    18131                  icsh: inter-charater spacing. defaults to 0 for font 0,
     1241    18132                          1 for fonts 1-3.
     1242    18133                  reps: how many times to repeat this element.
     1243    18134                  rinc: amount to increment the row each repeat.
     1244    18135                  cinc: amount to increment the column each repeat.
     1245    18136
     1246    18137                  After typing the entry option, super will prompt with
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:47   
     1247    18138                  'TXT*'.  at this point you can type one of the following:
     1248    18139
     1249    18140                  %SY[SID]      the sysid of the user whos output we are printing
     1250    18141                  %AC[CN]       the account name of the user.
     1251    18142                  %UN[AME]      the username of the user.
     1252    18143                  %WOO          the users work-station of origin.
     1253    18144                  %JO[BNAME]    the name the user specified on his job card.
     1254    18145                  %TI[ME]       the current time.
     1255    18146                  %DA[TE]       the current date.
     1256    18147                  %VE[RSION]    the system version.
     1257    18148                  %SU[BFILE]    the subfile number of this printout.
     1258    18149                  %LO[GO]       the standard CP-6 logo.
     1259    18150                  %WOD          the users work-station of destination.
     1260    18151                  %SI[TENAME]   the site name.
     1261    18152                  %SA[LUTE]     the standard system salutation
     1262    18153        %BAN[NERTEXT]0 the first of 10 bannertext fields, it should contain
     1263    18154                                              the registered name.
     1264    18155        %BAN[NERTEXT]1 the first bannertext field
     1265    18156        %BAN[NERTEXT]2 the second bannertext field
     1266    18157        %BAN[NERTEXT]3 the third bannertext field
     1267    18158        %BAN[NERTEXT]4 the fourth bannertext field
     1268    18159        %BAN[NERTEXT]5 the fifth bannertext field
     1269    18160        %BAN[NERTEXT]6 the sixth bannertext field
     1270    18161        %BAN[NERTEXT]7 the seventh bannertext field
     1271    18162        %BAN[NERTEXT]8 the eigth bannertext field
     1272    18163        %BAN[NERTEXT]9 the ninth bannertext field
     1273    18164        %RE[GISTEREDNAME] this is the registered name from mail!
     1274    18165                  %x     where x is any single charater.
     1275    18166                  Any text line, not starting with a '%'.
     1276    18167
     1277    18168                  For aligments, only %LOGO,%x or the line of text are
     1278    18169                  legal.  If a line of text was entered, that line will
     1279    18170                  be printed on the banner just as it is entered.
     1280    18171                  %x says to repeat the single charater x accross the whole
     1281    18172                  line.  For the others, CP-6 will look up the value and
     1282    18173                  use that to print on the banner.  Note that for %LOGO,
     1283    18174                  the entry options 'font' and 'icsh' are ignored.
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:48   
     1284    18175        *****************************************************************/
     1285    18176    3   DCL A UBIN WORD;
     1286    18177    3   DCL MORE BIT(1);
     1287    18178    3   DCL PTR$ PTR;
     1288    18179    3   DCL FB$ PTR;
     1289    18180    3   DCL CODE UBIN WORD;
     1290    18181    3   DCL CODE2 UBIN WORD;
     1291    18182    3   DCL SUBNODES UBIN WORD;
     1292    18183    3   DCL SUBNS UBIN WORD;
     1293    18184    3   DCL FC_CHAR CHAR(FC_LEN) BASED(FC$);
     1294    18185    3   DCL FC_LEN UBIN WORD;
     1295    18186    3   DCL FC_BIT BIT(FC_B_LEN) BASED(FB$);
     1296    18187    3   DCL FC_B_LEN UBIN WORD;
     1297    18188
     1298    18189
     1299    18190
     1300    18191
     1301    18192
     1302    18193    3   P_PCB.ROOT$ = ADDR( F_A_OR_B_LIST );
     1303    18194    3   ENUM=0;
     1304    18195    3   IF A = 0 THEN
     1305    18196    4   DO;
     1306    18197    4      FB$ = PINCRW (DSEG1$,BNNR_OFFSET) ; /* Point to banner record   */
     1307    18198    4      FC$ = PINCRW(DSEG1$,TEXT_OFFSET) ;
     1308    18199    4      BNNR$ = FB$ ;
     1309    18200    4      FCB$ = ADDR(NIL);
     1310    18201    4      OLD_BANNER = '0'B;
     1311    18202    4      FB$->FS$FINST.INTR = 1;
     1312    18203    4      FB$->FS$FINST.CHARGE=1;
     1313    18204    4      FB$->FS$FINST.REPEATS = 0;
     1314    18205    4      END;       /* End of banner pointer initialization   */
     1315    18206    4   ELSE DO ;
     1316    18207    4      FB$ = PINCRW (DSEG2$,ALGN_OFFSET) ; /* Point to alignment record   */
     1317    18208    4      FC$ = PINCRW(DSEG2$,TEXT_OFFSET) ;
     1318    18209    4      ALGN$ = FB$ ;
     1319    18210    4      FCA$ = ADDR(NIL) ;
     1320    18211    4      OLD_ALGN = '0'B;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:49   
     1321    18212    4      FB$->FS$FINST.INTR = 0;
     1322    18213    4      FB$->FS$FINST.CHARGE=0;
     1323    18214    4      FB$->FS$FINST.REPEATS = 1;
     1324    18215    4      END;          /* End of alignment initialization  */
     1325    18216    3   FB$->FS$FINST.NUM_ENTRIES=0;
     1326    18217    3   MORE = AS_TRUE;
     1327    18218    4   BANNER_LOOP: DO WHILE (MORE);
     1328    18219    4      CALL ASB$SET_PROMPT ( %PROMPT_SUB );
     1329    18220    4      CALL ASB$READ_SI(IN_BUF,ARS);
     1330    18221    4      P_PCB.NCHARS = ARS;
     1331    18222    4      CALL X$PARSE( P_PCB ) ALTRET(BANNER_ERR);
     1332    18223    4      NODE$ = P_PCB.OUT$;
     1333    18224    4      SUBNS= P$NODE.SUBNODES;
     1334    18225    5   DO_I: DO I = 0 TO SUBNS -1;
     1335    18226    5         PTR$=P$NODE.SUBLK$(I);
     1336    18227    5         CODE = PTR$->P$NODE.CODE;
     1337    18228    5         IF PTR$->P$NODE.SUBNODES = 0
     1338    18229    5         THEN OP_CODE = 1   /*  YES_VAL  */;
     1339    18230    5         ELSE OP_CODE = PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE;
     1340    18231    6   DO_CASE: DO SELECT (CODE);
     1341    18232    6            SELECT( 302 /* HELP_VAL */ );
     1342    18233    6            CALL ASH$HELP;
     1343    18234    6            SELECT( 301 /* QUESTION_VAL */ );
     1344    18235    6            CALL ASH$QUEST;
     1345    18236    6            SELECT( 300 /* DQUESTION_VAL */ );
     1346    18237    6            CALL ASH$DQUEST;
     1347    18238    6            SELECT(12   /*  END_VAL  */,26   /*  BLANK_LINE_VAL */);
     1348    18239    7            IF A = 0 THEN DO;
     1349    18240    7               IF FB$->FS$FINST.NUM_ENTRIES = 0 THEN
     1350    18241    7                  F$->FS$FORMREC.BANRDISP = 0;
     1351    18242    7               END;
     1352    18243    6            ELSE
     1353    18244    6               IF FB$->FS$FINST.NUM_ENTRIES = 0 THEN
     1354    18245    6                  F$->FS$FORMREC.ALGNDISP = 0;
     1355    18246    6            RETURN;
     1356    18247
     1357    18248    6            SELECT(35 /* FB_CHARGE */);
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:50   
     1358    18249    7            IF (A = 1) AND (OP_CODE = 1   /*  YES_VAL  */) THEN DO;
     1359    18250        /*E* ERROR: ASF-E$ALIGNCHARGE-0
     1360    18251             MESSAGE: You can't charge for alignment images.
     1361    18252        */
     1362    18253                    %SCREAM( ERR#=E$ALIGNCHARGE,MID='F',LEVEL=ERROR);
     1363    18268    7               GOTO BANNER_LOOP_END;
     1364    18269    7               END;
     1365    18270    6            IF OP_CODE = 1   /*  YES_VAL  */ THEN
     1366    18271    6               FB$->FS$FINST.CHARGE = 1;
     1367    18272    6            ELSE
     1368    18273    6               FB$->FS$FINST.CHARGE = 0;
     1369    18274
     1370    18275    6            SELECT( 36 /* FB_REPEATS */);
     1371    18276    6            BLK$=P$NODE.SUBLK$(I)->P$NODE.SUBLK$(0);
     1372    18277    6            CALL CHARBIN(VAL , OUT$SYM.TEXT);
     1373    18278    6            IF (A = 0)
     1374    18279    7            THEN DO;   /* This is a banner repeats */
     1375    18280    7               IF (VAL <= 511)
     1376    18281    8               THEN DO;
     1377    18282    8                  FB$->FS$FINST.REPEATS = VAL;
     1378    18283    8                  END;
     1379    18284    8               ELSE DO;
     1380    18285        /*E* ERROR: ASF-E$BREPEATS-0
     1381    18286             MESSAGE: Bad number of repeats.  Repeats must be less than 512.
     1382    18287                      For alignments, the repeats must be at least 1.
     1383    18288                      For banners, the repeats can be at least 0.
     1384    18289        */
     1385    18290                       %SCREAM( ERR#=E$BREPEATS,MID='F',LEVEL=ERROR);
     1386    18305    8                  END;
     1387    18306    7               END; /* Repeats for banners */
     1388    18307    7            ELSE DO; /* Repeats for alignments */
     1389    18308
     1390    18309    7               IF ( (VAL <= 511) AND
     1391    18310    7                    (VAL >= 1) )
     1392    18311    8               THEN DO;
     1393    18312    8                  FB$->FS$FINST.REPEATS = VAL;
     1394    18313    8                  END;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:51   
     1395    18314    8               ELSE DO;
     1396    18315        /*   ERROR: ASF-E$BREPEATS-0
     1397    18316             MESSAGE: Bad number of repeats.  Repeats must be less than 512.
     1398    18317                      For alignments, the repeats must be at least 1.
     1399    18318                      For banners, the repeats can be at least 0.
     1400    18319        */
     1401    18320                       %SCREAM( ERR#=E$BREPEATS,MID='F',LEVEL=ERROR);
     1402    18335    8                  END;
     1403    18336    7               END; /* Repeats for alignments */
     1404    18337    6            SELECT( 37 /* FB_ALIGNEVERY */ );
     1405    18338    7            IF A = 0 THEN DO;
     1406    18339        /*E* ERROR: ASF-E$BEVERY-0
     1407    18340             MESSAGE: ALIGNEVERY meaningless for banners.
     1408    18341        */
     1409    18342                    %SCREAM( ERR#=E$BEVERY,MID='F',LEVEL=WARN );
     1410    18357    7               END;
     1411    18358    6            ELSE
     1412    18359    6               FB$->FS$FINST.ALIGNCTL.EVERY = ( OP_CODE = 1   /*  YES_VAL  */ );
     1413    18360
     1414    18361    6            SELECT( 38 /* FB_ENTRY */);
     1415    18362    7            IF ADDR(FB$->FS$FINST.ENTRIES.MARK(ENUM)) >= FC$ THEN DO;
     1416    18363        /*E* ERROR: ASF-E$BANBUFFULL-0
     1417    18364             MESSAGE: The Banner or Alignment buffer has been exceeded.
     1418    18365                      You must re-enter the banner or alignment.
     1419    18366        */
     1420    18367                    %SCREAM( ERR#=E$BANBUFFULL,MID='F',LEVEL=ERROR);
     1421    18382    7               FB$->FS$FINST.NUM_ENTRIES = 0;
     1422    18383    7               IF A = 0 THEN
     1423    18384    7                  F$->FS$FORMREC.BANRDISP = 0;
     1424    18385    7               ELSE
     1425    18386    7                  F$->FS$FORMREC.ALGNDISP = 0;
     1426    18387    7               RETURN;
     1427    18388    7               END;
     1428    18389    6            SUBNODES = PTR$->P$NODE.SUBNODES;
     1429    18390    6            IF FB$->FS$FINST.REPEATS= 0 THEN
     1430    18391    6               FB$->FS$FINST.REPEATS = 1;
     1431    18392    7            IF SUBNODES < 2 OR SUBNODES > 8 THEN DO;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:52   
     1432    18393        /*E* ERROR: ASF-E$BADENTRY-0
     1433    18394             MESSAGE: Bad number of entrys.
     1434    18395             MESSAGE1: There must be between 2 and 8 numbers.
     1435    18396        */
     1436    18397                    %SCREAM( ERR#=E$BADENTRY,MID='F',LEVEL=ERROR);
     1437    18412    7               GOTO BANNER_LOOP_END;
     1438    18413    7               END;
     1439    18414    6            FB$->FS$FINST.ENTRIES.FONT(ENUM)=0;
     1440    18415    6            FB$->FS$FINST.ENTRIES.STRIKES(ENUM)=1;
     1441    18416    6            FB$->FS$FINST.ENTRIES.ICSH(ENUM)=0;
     1442    18417    6            FB$->FS$FINST.ENTRIES.REPS(ENUM)=1;
     1443    18418    6            FB$->FS$FINST.ENTRIES.RINC(ENUM)=0;
     1444    18419    6            FB$->FS$FINST.ENTRIES.CINC(ENUM)=0;
     1445    18420    6            FB$->FS$FINST.ENTRIES.DISP(ENUM)=0;
     1446    18421    6            FB$->FS$FINST.ENTRIES.COUNT(ENUM)=0;
     1447    18422    7            DO K= 0 TO SUBNODES-1;
     1448    18423    7               BLK$=PTR$->P$NODE.SUBLK$(K);
     1449    18424    7               CALL CHARBIN(VAL, OUT$SYM.TEXT);
     1450    18425    8               DO SELECT(K);
     1451    18426    8                  SELECT(0);
     1452    18427    8                  FB$->FS$FINST.ENTRIES.ROW(ENUM)=VAL;
     1453    18428    8                  SELECT(1);
     1454    18429    8                  FB$->FS$FINST.ENTRIES.COL(ENUM)=VAL;
     1455    18430    8                  SELECT(2);
     1456    18431    9                  IF VAL > 3/*FONT#*/ THEN DO;
     1457    18432        /*E* ERROR: ASF-E$BADFONT-0
     1458    18433             MESSAGE: Illegal font.
     1459    18434        */
     1460    18435                          %SCREAM( ERR#=E$BADFONT,MID='F',LEVEL=ERROR);
     1461    18450    9                     END;
     1462    18451    8                  FB$->FS$FINST.ENTRIES.FONT(ENUM)=VAL;
     1463    18452    8                  FB$->FS$FINST.ENTRIES.ICSH(ENUM)=1;
     1464    18453    8                  SELECT(3);
     1465    18454    8                  FB$->FS$FINST.ENTRIES.STRIKES(ENUM)=VAL;
     1466    18455    8                  SELECT(4);
     1467    18456    8                  FB$->FS$FINST.ENTRIES.ICSH(ENUM)=VAL;
     1468    18457    8                  SELECT(5);
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:53   
     1469    18458    8                  FB$->FS$FINST.ENTRIES.REPS(ENUM)=VAL;
     1470    18459    8                  SELECT(6);
     1471    18460    8                  FB$->FS$FINST.ENTRIES.RINC(ENUM)=VAL;
     1472    18461    8                  SELECT(7);
     1473    18462    8                  FB$->FS$FINST.ENTRIES.CINC(ENUM)=VAL;
     1474    18463    8                  END;
     1475    18464    7               END;
     1476    18465    6            CALL ASB$SET_PROMPT ( %PROMPT_TXT );
     1477    18466    6            CALL ASB$READ_SI(IN_BUF,ARS);
     1478    18467    6            P_PCB.ROOT$ = ADDR( FB_TYPE_LIST );
     1479    18468    6            P_PCB.NCHARS = ARS;
     1480    18469    6            CALL X$PARSE(P_PCB) ALTRET( STRANGE_ERR);
     1481    18470    6            CODE2= P_PCB.OUT$->P$NODE.CODE;
     1482    18471    6            IF A = 1 THEN
     1483    18472    7            DO SELECT (CODE2);
     1484    18473    7               SELECT(52 /* FT_LOGO */,53 /* FT_X */,58 /* FT_PLAIN */);
     1485    18474    7               SELECT(ELSE);
     1486    18475        /*E* ERROR: ASF-E$BADINTRINSIC-0
     1487    18476             MESSAGE: That intrinsic is illegal for ALIGNMENTs.
     1488    18477             MESSAGE1: You can only use %LOG, %x, or plaintext
     1489    18478                         for an alignment image.
     1490    18479        */
     1491    18480                 %SCREAM( ERR#=E$BADINTRINSIC,MID='F',LEVEL=ERROR);
     1492    18495    7            P_PCB.ROOT$ = ADDR( F_A_OR_B_LIST);
     1493    18496    7            GOTO BANNER_LOOP;
     1494    18497    7               END;
     1495    18498    7            DO SELECT ( CODE2 );
     1496    18499    7               SELECT( 43 /* FT_SYSID */ );
     1497    18500    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 1/*SYSID*/;
     1498    18501    7               SELECT( 44 /* FT_ACCN */ );
     1499    18502    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 2/*ACCN*/;
     1500    18503    7               SELECT ( 45 /* FT_UNAME */ );
     1501    18504    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 3/*UNAME*/;
     1502    18505    7               SELECT( 46 /* FT_WOO */ );
     1503    18506    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 4/*WOO*/;
     1504    18507    7               SELECT( 47 /* FT_JOBNAME */ );
     1505    18508    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 5/*JNAME*/;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:54   
     1506    18509    7               SELECT( 48 /* FT_TIME */ );
     1507    18510    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 6/*TIME*/;
     1508    18511    7               SELECT( 49 /* FT_DATE */ );
     1509    18512    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 7/*DATE*/;
     1510    18513    7               SELECT( 50 /* FT_VERSION */ );
     1511    18514    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 8/*VERS*/;
     1512    18515    7               SELECT( 51 /* FT_SUBFILE */ );
     1513    18516    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 9/*SFILE*/;
     1514    18517    7               SELECT( 52 /* FT_LOGO */ );
     1515    18518    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 10/*LOGO*/;
     1516    18519    7               SELECT( 54 /* FT_WOD */ );
     1517    18520    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM)=12/*WOD*/;
     1518    18521    7               SELECT( 56 /* FT_SITENAME */ );
     1519    18522    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 14/*SITENAME*/;
     1520    18523    7               SELECT( 57 /* FT_SALUTE */ );
     1521    18524    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 15/*SALUTE*/;
     1522    18525    7               SELECT( 61 /* FT_FORM */ );
     1523    18526    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 16/*FORM*/;
     1524    18527    7               SELECT( 62 /* FT_MINI_ID */ );
     1525    18528    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 17/*MINI_ID*/;
     1526    18529    7               SELECT( 63 /*FT_BANNERTEXT0 */ );
     1527    18530    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 18/*BANRTEXT0*/;
     1528    18531    7               SELECT( 64 /*FT_BANNERTEXT1 */ );
     1529    18532    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 19/*BANRTEXT1*/;
     1530    18533    7               SELECT( 65 /*FT_BANNERTEXT2 */ );
     1531    18534    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 20/*BANRTEXT2*/;
     1532    18535    7               SELECT( 66 /*FT_BANNERTEXT3 */ );
     1533    18536    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 21/*BANRTEXT3*/;
     1534    18537    7               SELECT( 67 /*FT_BANNERTEXT4 */ );
     1535    18538    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 22/*BANRTEXT4*/;
     1536    18539    7               SELECT( 68 /*FT_BANNERTEXT5 */ );
     1537    18540    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 23/*BANRTEXT5*/;
     1538    18541    7               SELECT( 69 /*FT_BANNERTEXT6 */ );
     1539    18542    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 24/*BANRTEXT6*/;
     1540    18543    7               SELECT( 70 /*FT_BANNERTEXT7 */ );
     1541    18544    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 25/*BANRTEXT7*/;
     1542    18545    7               SELECT( 71 /*FT_BANNERTEXT8 */ );
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:55   
     1543    18546    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 26/*BANRTEXT8*/;
     1544    18547    7               SELECT( 72 /*FT_BANNERTEXT9 */ );
     1545    18548    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 27/*BANRTEXT9*/;
     1546    18549    7               SELECT( 73 /*FT_REGISTEREDNAME */ );
     1547    18550    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 28/*RGSTDNAM*/;
     1548    18551    7               SELECT( 53 /* FT_X */ );
     1549    18552    7               IF P_PCB.OUT$->P$NODE.SUBLK$(0)->OUT$SYM.COUNT ~= 1 THEN
     1550    18553    8               DO;
     1551    18554        /*E* ERROR: ASF-E$BADXTYPE-0
     1552    18555             MESSAGE: Illegal type.
     1553    18556             MESSAGE1: Type must be an intrinsic name or a single character.
     1554    18557        */
     1555    18558                       %SCREAM( ERR#=E$BADXTYPE,MID='F',LEVEL=ERROR);
     1556    18573    8                  P_PCB.ROOT$ = ADDR(F_A_OR_B_LIST);
     1557    18574    8                  GOTO BANNER_LOOP;
     1558    18575    8                  END;
     1559    18576    8               ELSE DO;
     1560    18577    8                  FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 11/*RPTX*/;
     1561    18578    8                  FB$->FS$FINST.ENTRIES.CHR(ENUM) = P_PCB.OUT$->
     1562    18579    8                       P$NODE.SUBLK$(0)->OUT$SYM.TEXT;
     1563    18580    8                  END;
     1564    18581    7               SELECT( 58 /* FT_PLAIN */ );
     1565    18582    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 0/*TEXT*/;
     1566    18583    7               FC_LEN = ARS;
     1567    18584    8               IF FC_LEN = 0 THEN DO;
     1568    18585        /*E* ERROR: ASF-E$NULLENTRY-0
     1569    18586             MESSAGE: You must specify either:
     1570    18587                          a %intrinsic name
     1571    18588                          a %single character,
     1572    18589                          or a line of text.
     1573    18590        */
     1574    18591                       %SCREAM( ERR#=E$NULLENTRY,MID='F',LEVEL=ERROR);
     1575    18606    8                  P_PCB.ROOT$ = ADDR(F_A_OR_B_LIST);
     1576    18607    8                  GOTO BANNER_LOOP;
     1577    18608    8                  END;
     1578    18609    8               IF ADDR(FB$->FS$FINST.ENTRIES.MARK(ENUM))>=FC$ THEN DO;
     1579    18610                       %SCREAM( ERR#=E$BANBUFFULL,MID='F',LEVEL=ERROR);
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:56   
     1580    18625    8                  FB$->FS$FINST.NUM_ENTRIES = 0;
     1581    18626    8                  IF A = 0 THEN
     1582    18627    8                     F$->FS$FORMREC.BANRDISP = 0;
     1583    18628    8                  ELSE
     1584    18629    8                     F$->FS$FORMREC.ALGNDISP = 0;
     1585    18630    8                  RETURN;
     1586    18631    8                  END;
     1587    18632    7               FB$->FS$FINST.ENTRIES.COUNT(ENUM) = FC_LEN;
     1588    18633    7               FC_LEN=(FC_LEN+3)/4;
     1589    18634    7               FC$=PINCRW(FC$,-(FC_LEN));
     1590    18635    7               FC_LEN=FC_LEN*4;
     1591    18636    7               FC_CHAR = IN_BUF;
     1592    18637    7               FB$->FS$FINST.ENTRIES.DISP(ENUM) = POFFW(FC$,FB$);
     1593    18638    7               SUBNS=0;
     1594    18639    7               IF A = 0 THEN
     1595    18640    7                  FCB$ = FC$ ;
     1596    18641    7               ELSE
     1597    18642    7                  FCA$ = FC$;
     1598    18643    7               END;
     1599    18644    6            P_PCB.ROOT$ = ADDR( F_A_OR_B_LIST );
     1600    18645    6            ENUM=ENUM+1;
     1601    18646    6            FB$->FS$FINST.NUM_ENTRIES = ENUM;
     1602    18647
     1603    18648    6            END DO_CASE;
     1604    18649    5   BANNER_LOOP_END:;
     1605    18650    5         END DO_I;
     1606    18651    4      END BANNER_LOOP;
     1607    18652    3   BANNER_ERR:
     1608    18653    3   CALL ASH$ERROR( P_PCB.ERROR );
     1609    18654    3   GOTO BANNER_LOOP;
     1610    18655    3   STRANGE_ERR: GOTO BANNER_ERR;
     1611    18656    3   END BANNER;
     1612    18657    2   END FORM_OPTS;
     1613    18658        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:57   
     1614    18659    1   GFORM_OPTS: PROC;
     1615    18660        /****************************************************************
     1616    18661        GFORM_OPTS proccesses the options.  They are:
     1617    18662
     1618    18663
     1619    18664        Xs[ize] = dec (1-100)
     1620    18665              the decimal value of a percentage of the ndc space this axis
     1621    18666              will fill.
     1622    18667        Ys[ize] = dec (1-100)
     1623    18668              the decimal value of a percentage of the ndc space this axis
     1624    18669              will fill.
     1625    18670        Zs[ize] = dec (1-100)
     1626    18671              the decimal value of a percentage of the ndc space this axis
     1627    18672              will fill.
     1628    18673        Xo[ffset] = dec (0 - %XG_DEFAULT_MAX_NDC# )
     1629    18674              this is the number of millimeters the driver will add to all
     1630    18675              x coordinates for output.  It is used for translation.
     1631    18676        Yo[ffset] = dec (0 - %XG_DEFAULT_MAX_NDC# )
     1632    18677              this is the number of millimeters the driver will add to all
     1633    18678              x coordinates for output.  It is used for translation.
     1634    18679        Zo[ffset] = dec (0 - %XG_DEFAULT_MAX_NDC# )
     1635    18680              this is the number of millimeters the driver will add to all
     1636    18681              x coordinates for output.  It is used for translation.
     1637    18682        Ch[arset] | chai[n] = charset name
     1638    18683              is the 6 character name of an existing charset.  The lpok,
     1639    18684              tsok, elsok, and ltyp device legality fields,
     1640    18685              along with the attributes as described in the charset record,
     1641    18686              are moved from the charset record to the graphic form record.
     1642    18687        Se[tup]
     1643    18688              this one says you want to define a message to be given to
     1644    18689              the operator when he says 'SETUP formname'. Super will then
     1645    18690              prompt with 'TXT*' and you can enter up to 10 lines of 72
     1646    18691              characters each.  To end before that, simple type a blank line.
     1647    18692              If you type all 10 lines of setup info, super will inform
     1648    18693              you of this by saying:
     1649    18694              Setup buffer full, returning to 'OPT*' level.
     1650    18695        Acce[ss] = tname[,tname,...]
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:58   
     1651    18696              the access options is used to set the access list of tnames,
     1652    18697              to say which tnames can use this form.  You can put in from
     1653    18698              one to 12 tname, and any of them may include the 'wild-card'
     1654    18699              character '?'.
     1655    18700        Acco[unt] = account[,account,...]
     1656    18701              the account options is used to set the account list of account
     1657    18702              names to say which accounts can use this form.  You can put in
     1658    18703              from one to 12 accounts, and any of them may include the
     1659    18704              'wild-card' character '?'.
     1660    18705        Ba[nner]
     1661    18706        al[ignment]
     1662    18707              these two options are described with the banner procedure,
     1663    18708              which proccesses the sub-options for both of them.
     1664    18709        R[emove] ('b/anner' | 'A/LIGNMENT')
     1665    18710              will remove either the banner or alignment image.
     1666    18711        'DEV/ICE' 'LIM/ITS' x
     1667    18712              allows the user to set any one of 10 (1 <= x <= 10) of the user
     1668    18713              alterable parameters of the set device limits command.
     1669    18714        *****************************************************************/
     1670    18715
     1671    18716    2   DCL I UBIN WORD;
     1672    18717    2   DCL J UBIN WORD;
     1673    18718    2   DCL K UBIN WORD;
     1674    18719    2   DCL L UBIN WORD;
     1675    18720    2   DCL M UBIN WORD;
     1676    18721    2   DCL DEV_LIM_NUM UBIN WORD;
     1677    18722    2   DCL PTR$ PTR;
     1678    18723    2   DCL PTR2$ PTR;
     1679    18724    2   DCL SUBNODES UBIN WORD;
     1680    18725    2   DCL OP_CODE UBIN WORD;
     1681    18726    2   DCL VAL UBIN WORD;
     1682    18727    2   DCL 1 SPLIT_VAL REDEF VAL,
     1683    18728    2          2 * UBIN (20) UNAL,
     1684    18729    2          2 T UBIN (8) UNAL,
     1685    18730    2          2 B UBIN (8) UNAL;
     1686    18731    2   DCL 1 VAL18 REDEF VAL UNAL,
     1687    18732    2          2 UPPER UBIN (18) UNAL,
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:59   
     1688    18733    2          2 LOWER UBIN (18) UNAL;
     1689    18734
     1690    18735    2   DCL 1 SPLIT,
     1691    18736    2          2 * UBIN (1) UNAL,
     1692    18737    2          2 T UBIN (8) UNAL,
     1693    18738    2          2 * UBIN (1) UNAL,
     1694    18739    2          2 B UBIN (8) UNAL;
     1695    18740    2   DCL UBINSPLIT REDEF SPLIT UBIN (18) UNAL;
     1696    18741    2   DCL DEV_TYPE CHAR(2);
     1697    18742    2   DCL DEV_TYPE_A(0:1) REDEF DEV_TYPE CHAR(1);
     1698    18743    2   DCL REMOVED BIT (1);
     1699    18744    2   DCL FOUND BIT (1);
     1700    18745
     1701    18746    2   FORM_OPTS_LOOP:
     1702    18747    2   CALL ASB$SET_PROMPT ( %PROMPT_OPT );
     1703    18748    2   IF PSEUDO_FLG
     1704    18749    3   THEN DO;
     1705    18750    3      P_PCB.ROOT$ = ADDR( GPSEUDO_OPTS_LIST );
     1706    18751    3      END;
     1707    18752    3   ELSE DO;
     1708    18753    3      P_PCB.ROOT$ = ADDR( GFORM_OPTS_LIST );
     1709    18754    3      END;
     1710    18755    2   F$->FS$GFORMREC.SET_DEV_LIM.DEV_LIM_OPCODE.CLASS = %XG_COOP_CONTROL#;
     1711    18756    2   F$->FS$GFORMREC.SET_DEV_LIM.DEV_LIM_OPCODE.INDX = %XG_COOP_SET_DEV_LIM#;
     1712    18757    3   DO WHILE ( '1'B );
     1713    18758    3      CALL ASB$READ_SI( IN_BUF, ARS);
     1714    18759    3      P_PCB.NCHARS = ARS;
     1715    18760    3      CALL X$PARSE( P_PCB ) ALTRET ( OPTS_ERR );
     1716    18761    3      NODE$ = P_PCB.OUT$;
     1717    18762    3      SUBNODES=P$NODE.SUBNODES;
     1718    18763    4   DO_J: DO J = 0 TO SUBNODES - 1;
     1719    18764    4         PTR$ = P$NODE.SUBLK$(J);
     1720    18765    4         CODE = PTR$-> P$NODE.CODE;
     1721    18766    4         IF PTR$->P$NODE.SUBNODES = 0
     1722    18767    4         THEN OP_CODE = 1   /*  YES_VAL  */;
     1723    18768    5         ELSE DO;
     1724    18769    5            PTR2$=PTR$->P$NODE.SUBLK$(0);
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:60   
     1725    18770    5            OP_CODE = PTR2$->P$NODE.CODE;
     1726    18771    5            END;
     1727    18772    5   DO_CASE: DO SELECT (CODE);
     1728    18773    5            SELECT(16   /*  EOL_VAL  */);
     1729    18774    5            ;
     1730    18775    5            SELECT( 302 /* HELP_VAL */ );
     1731    18776    5            CALL ASH$HELP;
     1732    18777    5            SELECT( 301 /* QUESTION_VAL */ );
     1733    18778    5            CALL ASH$QUEST;
     1734    18779    5            SELECT( 300 /* DQUESTION_VAL */ );
     1735    18780    5            CALL ASH$DQUEST;
     1736    18781    5            SELECT(12   /*  END_VAL  */, 26   /*  BLANK_LINE_VAL */);
     1737    18782    5            F$->FS$GFORMREC.TRANSLGL = AS_TRUE;
     1738    18783    5            RETURN;
     1739    18784    5            SELECT( 117 /* GRAPHIC X SIZE */ );
     1740    18785    5            BLK$=PTR2$;
     1741    18786    5            CALL CHANGE162_9X9 ( %XG_DEFAULT_MAX_NDC# )
     1742    18787    6            WHENRETURN DO;
     1743    18788    6               F$->FS$GFORMREC.SET_DEV_LIM.X_SIZE = SPLIT;
     1744    18789    6               F$->FS$GFORMREC.X_SIZE = VAL;
     1745    18790    6               END;
     1746    18791    5            SELECT( 118 /* GRAPHIC Y SIZE */ );
     1747    18792    5            BLK$=PTR2$;
     1748    18793    5            CALL CHANGE162_9X9 ( %XG_DEFAULT_MAX_NDC# )
     1749    18794    6            WHENRETURN DO;
     1750    18795    6               F$->FS$GFORMREC.SET_DEV_LIM.Y_SIZE = SPLIT;
     1751    18796    6               F$->FS$GFORMREC.Y_SIZE = VAL;
     1752    18797    6               END;
     1753    18798    5            SELECT( 119 /* GRAPHIC Z SIZE */ );
     1754    18799    5            BLK$=PTR2$;
     1755    18800    5            CALL CHANGE162_9X9 ( %XG_DEFAULT_MAX_NDC# )
     1756    18801    6            WHENRETURN DO;
     1757    18802    6               F$->FS$GFORMREC.SET_DEV_LIM.Z_SIZE = SPLIT;
     1758    18803    6               F$->FS$GFORMREC.Z_SIZE = VAL;
     1759    18804    6               END;
     1760    18805    5            SELECT( 120 /* GRAPHIC X OFFSET */ );
     1761    18806    5            BLK$ = PTR2$;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:61   
     1762    18807    5            CALL CHANGE162_9X9 ( %XG_DEFAULT_MAX_NDC# )
     1763    18808    6            WHENRETURN DO;
     1764    18809    6               F$->FS$GFORMREC.SET_DEV_LIM.X_OFFSET = SPLIT;
     1765    18810    6               F$->FS$GFORMREC.X_OFFSET = VAL;
     1766    18811    6               END;
     1767    18812    5            SELECT( 121 /* GRAPHIC Y OFFSET */ );
     1768    18813    5            BLK$ = PTR2$;
     1769    18814    5            CALL CHANGE162_9X9 ( %XG_DEFAULT_MAX_NDC# )
     1770    18815    6            WHENRETURN DO;
     1771    18816    6               F$->FS$GFORMREC.SET_DEV_LIM.Y_OFFSET = SPLIT;
     1772    18817    6               F$->FS$GFORMREC.Y_OFFSET = VAL;
     1773    18818    6               END;
     1774    18819    5            SELECT( 122 /* GRAPHIC Z OFFSET */ );
     1775    18820    5            BLK$ = PTR2$;
     1776    18821    5            CALL CHANGE162_9X9 ( %XG_DEFAULT_MAX_NDC# )
     1777    18822    6            WHENRETURN DO;
     1778    18823    6               F$->FS$GFORMREC.SET_DEV_LIM.Z_OFFSET = SPLIT;
     1779    18824    6               F$->FS$GFORMREC.Z_OFFSET = VAL;
     1780    18825    6               END;
     1781    18826    5            SELECT (123 /* DEVICE LIMITS */);
     1782    18827    5            BLK$ = PTR2$;
     1783    18828    5            CALL CHARBIN (DEV_LIM_NUM, OUT$SYM.TEXT);
     1784    18829    5            BLK$ = PTR$ -> P$NODE.SUBLK$(1);
     1785    18830    5            CALL CHANGE162_9X9 ( %XG_DEFAULT_MAX_NDC# )
     1786    18831    6            WHENRETURN DO;
     1787    18832    6               F$->FS$GFORMREC.SET_DEV_LIM.UPARAM(DEV_LIM_NUM) =SPLIT;
     1788    18833    6               END; /* Whenreturn for CHANGE162_9X9 */
     1789    18834    5            SELECT( 29 /* F_SETUP */ );
     1790    18835    5            CALL SETUP;
     1791    18836    5            GOTO FORM_OPTS_LOOP;
     1792    18837
     1793    18838    5            SELECT( 30 /* F_ACCESS */, 61 /*F_ACCESS_ADD_VAL */, 62
             18838                     /*F_ACCESS_REM_VAL */ );
     1794    18839    5            SUBS = PTR$->P$NODE.SUBNODES;
     1795    18840        /*
     1796    18841
     1797    18842              1000 words will be used to save the access info
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:62   
     1798    18843              each account entered in this structure will take
     1799    18844              two words, so we have room for about 500
     1800    18845
     1801    18846              first build a pointer to the data segment that was
     1802    18847              returned from ASB$GETSEG.
     1803    18848
     1804    18849              Access will begin at word 1000 of the first
     1805    18850              data segment that was gotten.  It will be 1000
     1806    18851              words long
     1807    18852
     1808    18853        */
     1809    18854    5            IF ACCSS$ = ADDR(NIL)
     1810    18855    6            THEN DO;
     1811    18856    6               ACCSS$ = PINCRW(DSEG1$,ACCSS_OFFSET) ;
     1812    18857    6               ACCSS$->FS$ACCESS.TNAMES = 0;
     1813    18858    6               END;
     1814    18859    5            IF CODE = 30 /* F_ACCESS */
     1815    18860    6            THEN DO;
     1816    18861    6               ACCSS$->FS$ACCESS.TNAMES = 0;
     1817    18862    6               IF SUBS = 0
     1818    18863    7               THEN DO;
     1819    18864    7                  F$->FS$GFORMREC.ACCSDISP = 0 ;
     1820    18865    7                  END;
     1821    18866    6               END;
     1822    18867    6            DO K = 0 TO SUBS -1;
     1823    18868    6               BLK$ = PTR$->P$NODE.SUBLK$(K);
     1824    18869    6               IF OUT$SYM.COUNT > 8
     1825    18870    7               THEN DO;
     1826    18871    7                  AS_FIELD1.COUNT = OUT$SYM.COUNT;
     1827    18872    7                  AS_FIELD1.TEXT = OUT$SYM.TEXT;
     1828    18873                       %SCREAM( ERR#=E$BADACCESS,MID='F',LEVEL=ERROR);
     1829    18888    7                  END;
     1830    18889    7               ELSE DO;
     1831    18890    7                  IF CODE = 30 /* F_ACCESS */
     1832    18891    8                  THEN DO;
     1833    18892    8                     ACCSS$->FS$ACCESS.LIST(K) = OUT$SYM.TEXT;
     1834    18893    8                     ACCSS$->FS$ACCESS.TNAMES = ACCSS$->FS$ACCESS.TNAMES+1;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:63   
     1835    18894    8                     END;
     1836    18895    8                  ELSE DO;
     1837    18896    8                     L = 0;
     1838    18897    8                     FOUND = AS_FALSE;
     1839    18898    8                     REMOVED = AS_FALSE;
     1840    18899    9                     DO WHILE( L < ACCSS$->FS$ACCESS.TNAMES );
     1841    18900    9                        IF ACCSS$->FS$ACCESS.LIST(L) = OUT$SYM.TEXT
     1842    18901   10                        THEN DO; /* Found one */
     1843    18902   10                           FOUND = AS_TRUE;
     1844    18903   10                           IF CODE = 62 /*F_ACCESS_REM_VAL */
     1845    18904   11                           THEN DO;
     1846    18905   12                              DO M = L+1 TO ACCSS$->FS$ACCESS.TNAMES-1;
     1847    18906   12                                 ACCSS$->FS$ACCESS.LIST(M-1) =
     1848    18907   12                                      ACCSS$->FS$ACCESS.LIST(M);
     1849    18908   12                                 END;
     1850    18909   11                              ACCSS$->FS$ACCESS.TNAMES =
     1851    18910   11                                   ACCSS$->FS$ACCESS.TNAMES-1;
     1852    18911   11                              REMOVED = AS_TRUE;
     1853    18912   11                              END;
     1854    18913   10                           END;
     1855    18914    9                        L = L + 1;
     1856    18915    9                        END;
     1857    18916    8                     IF NOT REMOVED AND CODE = 62 /*F_ACCESS_REM_VAL */
     1858    18917    9                     THEN DO;
     1859    18918        /*   ERROR:   ASF-E$F_ACCESS_NO_EXIST-C
     1860    18919             MESSAGE: %U1 does not exist in the access list.
     1861    18920             MESSAGE1: A tname not in the access list cannot be removed.
     1862    18921        */
     1863    18922    9                        AS_FIELD1.COUNT = OUT$SYM.COUNT;
     1864    18923    9                        AS_FIELD1.TEXT = OUT$SYM.TEXT;
     1865    18924                             %SCREAM(ERR#=E$F_ACCESS_NO_EXIST,LEVEL=WARN,MID='F');
     1866    18939    9                        END;
     1867    18940    8                     ELSE IF NOT FOUND
     1868    18941    9                        THEN DO;
     1869    18942    9                           ACCSS$->FS$ACCESS.LIST(L) = OUT$SYM.TEXT;
     1870    18943    9                           ACCSS$->FS$ACCESS.TNAMES = L + 1;
     1871    18944    9                           END;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:64   
     1872    18945    8                     END;
     1873    18946    7                  END;
     1874    18947    6               END; /* K loop */
     1875    18948    5            SELECT( 31 /* F_BANNER */ );
     1876    18949    5            CALL BANNER(0);
     1877    18950    5            GOTO FORM_OPTS_LOOP;
     1878    18951
     1879    18952    5            SELECT( 32 /* F_ALIGNMENT */ );
     1880    18953    5            CALL BANNER(1);
     1881    18954    5            GOTO FORM_OPTS_LOOP;
     1882    18955
     1883    18956    5            SELECT( 65 /*F_REMOVE_BANNER_VAL*/ );
     1884    18957    5            BNNR$ = ADDR(NIL);
     1885    18958    5            OLD_BANNER = '0'B;
     1886    18959
     1887    18960    5            SELECT( 66 /*F_REMOVE_ALIGN_VAL*/ );
     1888    18961    5            ALGN$ = ADDR(NIL);
     1889    18962    5            OLD_ALGN = '0'B;
     1890    18963
     1891    18964    5            SELECT( 35 /* F_ACCOUNT  */, 63 /*F_ACCOUNT_ADD_VAL */, 64
             18964                     /*F_ACCOUNT_REM_VAL */ );
     1892    18965    5            SUBS = PTR$->P$NODE.SUBNODES ;
     1893    18966        /*
     1894    18967
     1895    18968              1000 words will be used to save the accounts info
     1896    18969              each account entered in this structure will take
     1897    18970              two words, so we have room for about 500
     1898    18971        */
     1899    18972        /*
     1900    18973
     1901    18974              First build a pointer to the data segment that was
     1902    18975              returned from ABS$GETSEG
     1903    18976
     1904    18977              accounts will begin at word zero of the first
     1905    18978              data segment that was gotten.  It will be 1000
     1906    18979              words long
     1907    18980
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:65   
     1908    18981        */
     1909    18982    5            IF ACCNT$ = ADDR(NIL)
     1910    18983    6            THEN DO;
     1911    18984    6               ACCNT$ = PINCRW(DSEG1$,ACCNT_OFFSET) ;
     1912    18985    6               ACCNT$->FS$ACCOUNTS.TACCTS = 0;
     1913    18986    6               END;
     1914    18987
     1915    18988    5            IF CODE = 35 /* F_ACCOUNT  */
     1916    18989    6            THEN DO;
     1917    18990    6               ACCNT$->FS$ACCOUNTS.TACCTS = 0 ;
     1918    18991    6               IF SUBS = 0
     1919    18992    7               THEN DO;
     1920    18993    7                  F$->FS$GFORMREC.ACCTDISP = 0;
     1921    18994    7                  END;
     1922    18995    6               END;
     1923    18996
     1924    18997    6            DO K = 0 TO SUBS -1;
     1925    18998    6               BLK$ = PTR$->P$NODE.SUBLK$(K);
     1926    18999    6               IF OUT$SYM.COUNT > 8
     1927    19000    7               THEN DO;
     1928    19001        /*   ERROR: ASF-E$BADACCOUNT-0
     1929    19002             MESSAGE: Account name too long: "%U1".
     1930    19003             MESSAGE1: Account names must not be more than 8 characters long.
     1931    19004        */
     1932    19005    7                  AS_FIELD1.COUNT = OUT$SYM.COUNT;
     1933    19006    7                  AS_FIELD1.TEXT = OUT$SYM.TEXT;
     1934    19007                       %SCREAM( ERR#=E$BADACCOUNT ,MID='F',LEVEL=ERROR);
     1935    19022    7                  END;
     1936    19023    7               ELSE DO;
     1937    19024    7                  IF CODE = 35 /* F_ACCOUNT  */
     1938    19025    8                  THEN DO;
     1939    19026    8                     ACCNT$->FS$ACCOUNTS.LIST(K) = OUT$SYM.TEXT;
     1940    19027    8                     ACCNT$->FS$ACCOUNTS.TACCTS = ACCNT$->FS$ACCOUNTS.TACCTS + 1;
     1941    19028    8                     END;
     1942    19029    8                  ELSE DO;
     1943    19030    8                     L = 0;
     1944    19031    8                     REMOVED = AS_FALSE;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:66   
     1945    19032    8                     FOUND = AS_FALSE;
     1946    19033    9                     DO WHILE( L < ACCNT$->FS$ACCOUNTS.TACCTS );
     1947    19034    9                        IF ACCNT$->FS$ACCOUNTS.LIST(L) = OUT$SYM.TEXT
     1948    19035   10                        THEN DO; /* Found one */
     1949    19036   10                           FOUND = AS_TRUE;
     1950    19037   10                           IF CODE = 64 /*F_ACCOUNT_REM_VAL */
     1951    19038   11                           THEN DO;
     1952    19039   12                              DO M = L+1 TO ACCNT$->FS$ACCOUNTS.TACCTS-1;
     1953    19040   12                                 ACCNT$->FS$ACCOUNTS.LIST(M-1) =
     1954    19041   12                                      ACCNT$->FS$ACCOUNTS.LIST(M);
     1955    19042   12                                 END;
     1956    19043   11                              ACCNT$->FS$ACCOUNTS.TACCTS =
     1957    19044   11                                   ACCNT$->FS$ACCOUNTS.TACCTS-1;
     1958    19045   11                              REMOVED = AS_TRUE;
     1959    19046   11                              END;
     1960    19047   10                           END;
     1961    19048    9                        L = L + 1;
     1962    19049    9                        END;
     1963    19050    8                     IF NOT REMOVED AND CODE = 64 /*F_ACCOUNT_REM_VAL */
     1964    19051    9                     THEN DO;
     1965    19052           /*   ERROR:   ASF-E$F_ACCOUNT_NO_EXIST-C
     1966    19053                MESSAGE: %U1 does not exist in the account list.
     1967    19054                MESSAGE1: An account not in the account list cannot be removed.
     1968    19055           */
     1969    19056    9                        AS_FIELD1.COUNT = OUT$SYM.COUNT;
     1970    19057    9                        AS_FIELD1.TEXT = OUT$SYM.TEXT;
     1971    19058                             %SCREAM(ERR#=E$F_ACCOUNT_NO_EXIST,LEVEL=WARN,MID='F');
     1972    19073    9                        END;
     1973    19074    8                     ELSE IF NOT FOUND
     1974    19075    9                        THEN DO;
     1975    19076    9                           ACCNT$->FS$ACCOUNTS.LIST(L) = OUT$SYM.TEXT;
     1976    19077    9                           ACCNT$->FS$ACCOUNTS.TACCTS = L + 1;
     1977    19078    9                           END;
     1978    19079    8                     END; /* Else do l = 0 */
     1979    19080    7                  END;
     1980    19081    6               END; /*   K loop   */
     1981    19082
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:67   
     1982    19083    5            SELECT (36 /* F_CHAIN */) ;
     1983    19084    5            BLK$ = PTR2$->P$NODE.SUBLK$(0);
     1984    19085    5            IF OUT$SYM.COUNT > 8
     1985    19086    6            THEN DO;
     1986    19087        /*   ERROR: ASF-E$CHARSETTOOBIG-C
     1987    19088             MESSAGE: That charset name is too long.
     1988    19089             MESSAGE1: The maximum size of a charset name is 8 characters.
     1989    19090        */
     1990    19091                    %SCREAM(ERR#=E$CHARSETTOOBIG,MID='F',LEVEL=ERROR);
     1991    19106    6               END;
     1992    19107    6            ELSE DO;
     1993    19108    6               CHARSET_KEY.CNT = OUT$SYM.COUNT + 8;
     1994    19109    6               CALL CONCAT (CHARSET_KEY.TXT, '~',
     1995    19110    6                    SUBSTR(OUT$SYM.TEXT,0,OUT$SYM.COUNT),'CHARSET');
     1996    19111    6               ARS = SIZEB(CHARSET);
     1997    19112    6               CALL ASF$READ_FORM (CHARSET_KEY, CHARSET$, ARS)
     1998    19113    7               WHENRETURN DO;
     1999    19114    7                  F$->FS$GFORMREC.LGLTYPS = CHARSET.LGLTYPS;
     2000    19115    7                  F$->FS$GFORMREC.ATTR = CHARSET.ATTRS;
     2001    19116    7                  F$->FS$GFORMREC.ATTR = CHARSET.ATTRS | %ATTR_TRANSLGL#;
             19116                           /*This forces tranparent legal for graphic forms*/
     2002    19117    7                  F$->FS$GFORMREC.ATTR = F$->FS$GFORMREC.ATTR | %ATTR_GRLGL#;
             19117                           /*This forces graphics legal for graphic forms*/
     2003    19118    7                  F$->FS$GFORMREC.CHAIN_NAME = OUT$SYM.TEXT;
     2004    19119    7                  END;
     2005    19120    7               WHENALTRETURN DO;
     2006    19121    7                  IF MERR_CODE.CODE ~= %E$NOREC
     2007    19122    8                  THEN DO;
     2008    19123        /*   ERROR: ASF-E$BADCHAIN-C
     2009    19124             MESSAGE: Charset %U1 does not exist.
     2010    19125             MESSAGE1: Charsets must exist before their contents can move to
     2011    19126                       the form definition.
     2012    19127        */
     2013    19128    8                     AS_FIELD1.COUNT = OUT$SYM.COUNT;
     2014    19129    8                     AS_FIELD1.TEXT = OUT$SYM.TEXT;
     2015    19130                          %SCREAM(ERR#=E$BADCHAIN, MID='F', LEVEL=ERROR);
     2016    19145    8                     END;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:68   
     2017    19146    8                  ELSE DO;
     2018    19147    8                     CALL ASH$ERROR (P_PCB.ERROR);
     2019    19148    8                     END;
     2020    19149    7                  END;
     2021    19150    6               END;
     2022    19151
     2023    19152    5            END DO_CASE;
     2024    19153    4         END DO_J;
     2025    19154    3      END;
     2026    19155    2   OPTS_ERR:
     2027    19156    2   CALL ASH$ERROR ( P_PCB.ERROR );
     2028    19157    2   GOTO FORM_OPTS_LOOP;
     2029    19158        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:69   
     2030    19159    2   SETUP: PROC;
     2031    19160
     2032    19161
     2033    19162    3   DCL I UBIN WORD;
     2034    19163    3   DCL CODE2 UBIN WORD;
     2035    19164        /*
     2036    19165              1500 words will be used to save the setup info
     2037    19166              this allows 83 lines of input
     2038    19167        */
     2039    19168        /*    First build a pointer to the data segment that was
     2040    19169              returned from ASB$GETSEG.
     2041    19170
     2042    19171              Setup will begin at word 0 of the second
     2043    19172              segment gotten
     2044    19173
     2045    19174        */
     2046    19175        /*
     2047    19176        */
     2048    19177    3   SETUP$ = PINCRW(DSEG2$,SETUP_OFFSET);       /* Ptr to our setup area   */
     2049    19178    4   DO I = 0 TO 82;
     2050    19179    4      SETUP$->FS$SETUP.TXT(I) = ' ';
     2051    19180    4      END;
     2052    19181    3   F$->FS$SETUP.LINES = 0 ;
     2053    19182    3   CALL ASB$SET_PROMPT ( %PROMPT_TXT );
     2054    19183    3   I = 0;
     2055    19184    4   DO UNTIL( I = 83  OR  IN_BUF = ' ' );
     2056    19185    4      CALL ASB$READ_SI( IN_BUF,ARS);
     2057    19186    4      IF IN_BUF ~= ' '
     2058    19187    5      THEN DO;
     2059    19188    5         IF ARS <= 72
     2060    19189    6         THEN DO;
     2061    19190    6            SETUP$ -> FS$SETUP.TXT(I) = IN_BUF;
     2062    19191    6            I = I + 1;
     2063    19192    6            END;
     2064    19193    6         ELSE DO;
     2065    19194        /*   ERROR: ASF-E$SETUPBAD-C
     2066    19195             MESSAGE: Setup text must be 72 characters or less per line.
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:70   
     2067    19196        */
     2068    19197                 %SCREAM( ERR#=E$SETUPBAD,MID='F',LEVEL=ERROR);
     2069    19212    6            END;
     2070    19213    5         END;
     2071    19214    4      END;        /* Do until */
     2072    19215    4   IF I = 83 THEN DO;
     2073    19216        /*   ERROR:   ASF-E$SETUP_FULL-C
     2074    19217             MESSAGE: Setup buffer full, returning to 'OPT*' level.
     2075    19218        */
     2076    19219           %SCREAM( ERR#=E$SETUP_FULL, MID='F', LEVEL=WARN );
     2077    19234    4      END;
     2078    19235    3   SETUP$ -> FS$SETUP.LINES = I;
     2079    19236    3   IF I = 0
     2080    19237    4   THEN DO;
     2081    19238    4      F$ -> FS$GFORMREC.SETUPDISP = 0;
     2082    19239    4      END;
     2083    19240    3   RETURN;
     2084    19241
     2085    19242
     2086    19243    3   END SETUP;
     2087    19244        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:71   
     2088    19245    2   BANNER: PROC (A);
     2089    19246        /****************************************************************
     2090    19247        Banner proccesses the sub-options for both banners and alignments.
     2091    19248        The format is:
     2092    19249
     2093    19250        Ba[nner]
     2094    19251        al[ignment]
     2095    19252              these two options define the banner and alignment image for
     2096    19253              this form.  Super will ask for sub-options. They are:
     2097    19254              Ch[arge] [=yes|no]
     2098    19255                  legal only for banners.  This says whether or not to
     2099    19256                  charge the user for the banner pages.
     2100    19257                  If '=yes|no' is ommited, yes is assumed.
     2101    19258              Re[peats] = dec
     2102    19259                  this says how many times to repeat this entire banner or
     2103    19260                  alignment image.  If this option is ommited, it defaults
     2104    19261                  to one if there are any entries, and zero if there are none.
     2105    19262              Al[ign][every] [=yes|no]
     2106    19263                  legal only for alignment images.  This says whether to
     2107    19264                  print the alignment after every file or not. Default is no.
     2108    19265              En[try] = x,y[,rotation,char_width,char_hite,char_space]
     2109    19266                  this options defines one element of this banner or alignment,
     2110    19267                  and may be used as many times as needed. The values are:
     2111    19268
     2112    19269                 x: The x position for this entry on the output device
     2113    19270                 y: The y position for this entry on the output device
     2114    19271                 z: The z position for this entry on the output device.
     2115    19272                 rotation: The path this entry will take -
     2116    19273                    0 = right to left
     2117    19274                    90 = up
     2118    19275                    180 = left to right
     2119    19276                    270 = down
     2120    19277                    yes that right the value are specified as degrees.
     2121    19278                 char_width: The width of the individual characters.
     2122    19279                 char_hite: The height of the individual characters.
     2123    19280                 char_space: The spacing in between the individual characters.
     2124    19281
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:72   
     2125    19282                  After typing the entry option, super will prompt with
     2126    19283                  'TXT*'.  at this point you can type one of the following:
     2127    19284
     2128    19285                  %SY[SID]      the sysid of the user whos output we are printing
     2129    19286                  %AC[CN]       the account name of the user.
     2130    19287                  %UN[AME]      the username of the user.
     2131    19288                  %WOO          the users work-station of origin.
     2132    19289                  %JO[BNAME]    the name the user specified on his job card.
     2133    19290                  %TI[ME]       the current time.
     2134    19291                  %DA[TE]       the current date.
     2135    19292                  %VE[RSION]    the system version.
     2136    19293                  %SU[BFILE]    the subfile number of this printout.
     2137    19294                  %LO[GO]       the standard CP-6 logo.
     2138    19295                  %WOD          the users work-station of destination.
     2139    19296                  %SI[TENAME]   the site name.
     2140    19297                  %SA[LUTE]     the standard system salutation
     2141    19298                  %BAN[NERTEXT]0 the first of 10 bannertext fields,
     2142    19299                     it should contain the registered name.
     2143    19300                  %BAN[NERTEXT]1 the first bannertext field
     2144    19301                  %BAN[NERTEXT]2 the second bannertext field
     2145    19302                  %BAN[NERTEXT]3 the third bannertext field
     2146    19303                  %BAN[NERTEXT]4 the fourth bannertext field
     2147    19304                  %BAN[NERTEXT]5 the fifth bannertext field
     2148    19305                  %BAN[NERTEXT]6 the sixth bannertext field
     2149    19306                  %BAN[NERTEXT]7 the seventh bannertext field
     2150    19307                  %BAN[NERTEXT]8 the eigth bannertext field
     2151    19308                  %BAN[NERTEXT]9 the ninth bannertext field
     2152    19309                  %RE[GISTEREDNAME] this is the registered name from mail!
     2153    19310                  %x     where x is any single charater.
     2154    19311                  Any text line, not starting with a '%'.
     2155    19312
     2156    19313                  For aligments, only %LOGO,%x or the line of text are
     2157    19314                  legal.  If a line of text was entered, that line will
     2158    19315                  be printed on the banner just as it is entered.
     2159    19316                  %x says to repeat the single charater x accross the whole
     2160    19317                  line.  For the others, CP-6 will look up the value and
     2161    19318                  use that to print on the banner.  Note that for %LOGO,
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:73   
     2162    19319                  the entry options 'font' and 'icsh' are ignored.
     2163    19320        *****************************************************************/
     2164    19321    3   DCL A UBIN WORD;
     2165    19322    3   DCL MORE BIT(1);
     2166    19323    3   DCL PTR$ PTR;
     2167    19324    3   DCL FB$ PTR;
     2168    19325    3   DCL CODE UBIN WORD;
     2169    19326    3   DCL CODE2 UBIN WORD;
     2170    19327    3   DCL SUBNODES UBIN WORD;
     2171    19328    3   DCL SUBNS UBIN WORD;
     2172    19329    3   DCL FC_CHAR CHAR(FC_LEN) BASED(FC$);
     2173    19330    3   DCL FC_LEN UBIN WORD;
     2174    19331    3   DCL FC_BIT BIT(FC_B_LEN) BASED(FB$);
     2175    19332    3   DCL FC_B_LEN UBIN WORD;
     2176    19333
     2177    19334
     2178    19335
     2179    19336
     2180    19337
     2181    19338    3   P_PCB.ROOT$ = ADDR( F_A_OR_B_LIST );
     2182    19339    3   ENUM=0;
     2183    19340    3   IF A = 0 THEN
     2184    19341    4   DO;
     2185    19342    4      FB$ = PINCRW (DSEG1$,BNNR_OFFSET) ; /* Point to banner record   */
     2186    19343    4      FC$ = PINCRW(DSEG1$,TEXT_OFFSET) ;
     2187    19344    4      BNNR$ = FB$ ;
     2188    19345    4      FCB$ = ADDR(NIL);
     2189    19346    4      OLD_BANNER = '0'B;
     2190    19347    4      FB$->FS$GBAN.INTR = 1;
     2191    19348    4      FB$->FS$GBAN.CHARGE=1;
     2192    19349    4      END;       /* End of banner pointer initialization   */
     2193    19350    4   ELSE DO ;
     2194    19351    4      FB$ = PINCRW (DSEG2$,ALGN_OFFSET) ; /* Point to alignment record   */
     2195    19352    4      FC$ = PINCRW(DSEG2$,TEXT_OFFSET) ;
     2196    19353    4      ALGN$ = FB$ ;
     2197    19354    4      FCA$ = ADDR(NIL) ;
     2198    19355    4      OLD_ALGN = '0'B;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:74   
     2199    19356    4      FB$->FS$GBAN.INTR = 0;
     2200    19357    4      FB$->FS$GBAN.CHARGE=0;
     2201    19358    4      END;          /* End of alignment initialization  */
     2202    19359    3   FB$->FS$GBAN.NUM_ENTRIES=0;
     2203    19360    3   FB$->FS$GBAN.REPEATS=0;
     2204    19361    3   MORE = AS_TRUE;
     2205    19362    4   BANNER_LOOP: DO WHILE (MORE);
     2206    19363    4      CALL ASB$SET_PROMPT ( %PROMPT_SUB );
     2207    19364    4      CALL ASB$READ_SI(IN_BUF,ARS);
     2208    19365    4      P_PCB.NCHARS = ARS;
     2209    19366    4      CALL X$PARSE( P_PCB ) ALTRET( PARSE_ERR);
     2210    19367    4      NODE$ = P_PCB.OUT$;
     2211    19368    4      SUBNS= P$NODE.SUBNODES;
     2212    19369    5   DO_I: DO I = 0 TO SUBNS -1;
     2213    19370    5         PTR$=P$NODE.SUBLK$(I);
     2214    19371    5         CODE = PTR$->P$NODE.CODE;
     2215    19372    5         IF PTR$->P$NODE.SUBNODES = 0
     2216    19373    5         THEN OP_CODE = 1   /*  YES_VAL  */;
     2217    19374    5         ELSE OP_CODE = PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE;
     2218    19375    6   DO_CASE: DO SELECT (CODE);
     2219    19376    6            SELECT( 302 /* HELP_VAL */ );
     2220    19377    6            CALL ASH$HELP;
     2221    19378    6            SELECT( 301 /* QUESTION_VAL */ );
     2222    19379    6            CALL ASH$QUEST;
     2223    19380    6            SELECT( 300 /* DQUESTION_VAL */ );
     2224    19381    6            CALL ASH$DQUEST;
     2225    19382    6            SELECT(12   /*  END_VAL  */,26   /*  BLANK_LINE_VAL */);
     2226    19383    7            IF A = 0 THEN DO;
     2227    19384    7               IF FB$->FS$GBAN.NUM_ENTRIES = 0 THEN
     2228    19385    7                  F$->FS$GFORMREC.BANRDISP = 0;
     2229    19386    7               END;
     2230    19387    6            ELSE
     2231    19388    6               IF FB$->FS$GBAN.NUM_ENTRIES = 0 THEN
     2232    19389    6                  F$->FS$GFORMREC.ALGNDISP = 0;
     2233    19390    6            RETURN;
     2234    19391
     2235    19392    6            SELECT(35 /* FB_CHARGE */);
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:75   
     2236    19393    7            IF (A = 1) AND (OP_CODE = 1   /*  YES_VAL  */) THEN DO;
     2237    19394        /*   ERROR: ASF-E$ALIGNCHARGE-0
     2238    19395             MESSAGE: You can't charge for alignment images.
     2239    19396        */
     2240    19397                    %SCREAM( ERR#=E$ALIGNCHARGE,MID='F',LEVEL=ERROR);
     2241    19412    7               GOTO BANNER_LOOP_END;
     2242    19413    7               END;
     2243    19414    6            IF OP_CODE = 1   /*  YES_VAL  */ THEN
     2244    19415    6               FB$->FS$GBAN.CHARGE = 1;
     2245    19416    6            ELSE
     2246    19417    6               FB$->FS$GBAN.CHARGE = 0;
     2247    19418
     2248    19419    6            SELECT( 36 /* FB_REPEATS */);
     2249    19420    6            BLK$=P$NODE.SUBLK$(I)->P$NODE.SUBLK$(0);
     2250    19421    6            CALL CHARBIN(VAL , OUT$SYM.TEXT);
     2251    19422    6            IF VAL <= 511 THEN
     2252    19423    6               FB$->FS$GBAN.REPEATS = VAL;
     2253    19424    7            ELSE DO;
     2254    19425        /*   ERROR: ASF-E$BREPEATS-0
     2255    19426             MESSAGE: Too many repeats.
     2256    19427        */
     2257    19428                    %SCREAM( ERR#=E$BREPEATS,MID='F',LEVEL=ERROR);
     2258    19443    7               END;
     2259    19444
     2260    19445    6            SELECT( 37 /* FB_ALIGNEVERY */ );
     2261    19446    7            IF A = 0 THEN DO;
     2262    19447        /*   ERROR: ASF-E$BEVERY-0
     2263    19448             MESSAGE: Alignevery meaningless for banners.
     2264    19449        */
     2265    19450                    %SCREAM( ERR#=E$BEVERY,MID='F',LEVEL=WARN );
     2266    19465    7               END;
     2267    19466    6            ELSE
     2268    19467    6               FB$->FS$GBAN.ALIGNCTL.EVERY = ( OP_CODE = 1   /*  YES_VAL  */ );
     2269    19468
     2270    19469    6            SELECT( 38 /* FB_ENTRY */);
     2271    19470    7            IF ADDR(FB$->FS$GBAN.ENTRIES.MARK(ENUM)) >= FC$ THEN DO;
     2272    19471        /*   ERROR: ASF-E$BANBUFFULL-0
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:76   
     2273    19472             MESSAGE: The banner or alignment buffer has been exceeded.
     2274    19473                      You must re-enter the banner or alignment.
     2275    19474        */
     2276    19475                    %SCREAM( ERR#=E$BANBUFFULL,MID='F',LEVEL=ERROR);
     2277    19490    7               FB$->FS$GBAN.NUM_ENTRIES = 0;
     2278    19491    7               IF A = 0 THEN
     2279    19492    7                  F$->FS$GFORMREC.BANRDISP = 0;
     2280    19493    7               ELSE
     2281    19494    7                  F$->FS$GFORMREC.ALGNDISP = 0;
     2282    19495    7               RETURN;
     2283    19496    7               END;
     2284    19497    6            SUBNODES = PTR$->P$NODE.SUBNODES;
     2285    19498    6            IF FB$->FS$GBAN.REPEATS= 0 THEN
     2286    19499    6               FB$->FS$GBAN.REPEATS = 1;
     2287    19500    7            IF SUBNODES < 2 OR SUBNODES > 7 THEN DO;
     2288    19501        /*   ERROR: ASF-E$BADENTRY-0
     2289    19502             MESSAGE: Bad number of entrys.
     2290    19503             MESSAGE1: There must be between 2 and 8 numbers.
     2291    19504        */
     2292    19505                    %SCREAM( ERR#=E$BADENTRY,MID='F',LEVEL=ERROR);
     2293    19520    7               GOTO BANNER_LOOP_END;
     2294    19521    7               END;
     2295    19522    6            FB$->FS$GBAN.ENTRIES.CHARUP.CHARUP_OPCODE.CLASS(ENUM) = %
             19522                     XG_COOP_ATTR_BAS_NONE_2#;
     2296    19523    6            FB$->FS$GBAN.ENTRIES.CHARUP.CHARUP_OPCODE.INDX(ENUM) = %
             19523                     XG_COOP_SET_CHARACTER_UP#;
     2297    19524    6            FB$->FS$GBAN.ENTRIES.CHARSIZE.CHARSIZE_OPCODE.CLASS(ENUM) = %
             19524                     XG_COOP_ATTR_BAS_NONE_2#;
     2298    19525    6            FB$->FS$GBAN.ENTRIES.CHARSIZE.CHARSIZE_OPCODE.INDX(ENUM) = %
             19525                     XG_COOP_SET_CHARSIZE#;
     2299    19526    6            FB$->FS$GBAN.ENTRIES.CHARSPACE.CHARSPACE_OPCODE.CLASS(ENUM) = %
             19526                     XG_COOP_ATTR_BAS_NONE_2#;
     2300    19527    6            FB$->FS$GBAN.ENTRIES.CHARSPACE.CHARSPACE_OPCODE.INDX(ENUM) = %
             19527                     XG_COOP_SET_CHARSPACE#;
     2301    19528    6            FB$->FS$GBAN.ENTRIES.Z_VAL(ENUM) = 0;
     2302    19529    6            FB$->FS$GBAN.ENTRIES.NDC_Z_VAL(ENUM) = 0;
     2303    19530    6            FB$->FS$GBAN.ENTRIES.DIRECTION(ENUM) = 90;/* Up */
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:77   
     2304    19531    6            FB$->FS$GBAN.ENTRIES.CHARUP.X(ENUM) = %XG_DEFAULT_MAX_NDC# ;
     2305    19532    6            FB$->FS$GBAN.ENTRIES.CHARUP.Y(ENUM) = 0;
     2306    19533    6            FB$->FS$GBAN.ENTRIES.CHARUP.Z(ENUM) = 0;
     2307    19534    6            FB$->FS$GBAN.ENTRIES.CHARSIZE.CHAR_WIDTH(ENUM)='1'B;
     2308    19535    6            FB$->FS$GBAN.ENTRIES.CHARSIZE.CHAR_HITE(ENUM)='1'B;
     2309    19536    6            FB$->FS$GBAN.ENTRIES.CHAR_WIDTH(ENUM) = 1;
     2310    19537    6            FB$->FS$GBAN.ENTRIES.CHAR_HITE(ENUM) = 1;
     2311    19538    6            FB$->FS$GBAN.ENTRIES.CHARSPACE.CHAR_SPACE(ENUM)='0'B;
     2312    19539    6            FB$->FS$GBAN.ENTRIES.CHAR_SPACE(ENUM) = 0;
     2313    19540    6            FB$->FS$GBAN.ENTRIES.COUNT(ENUM)=0;
     2314    19541    6            FB$->FS$GBAN.ENTRIES.DISP(ENUM)=0;
     2315    19542    7            DO K= 0 TO SUBNODES-1;
     2316    19543    7               BLK$=PTR$->P$NODE.SUBLK$(K);
     2317    19544    7               IF (K ~= 3)
     2318    19545    8               THEN DO;  /* Percentage for all but rotation */
     2319    19546    8                  CALL CHANGE162_9X9 (100) ALTRET (BANNER_LOOP_END);
     2320    19547    8                  END;
     2321    19548    8               ELSE DO; /* Check and convert rotation */
     2322    19549    8                  CALL CHANGE162_9X9 (400) ALTRET (BANNER_LOOP_END);
     2323    19550    8                  END;
     2324    19551    8               DO SELECT(K);
     2325    19552    8                  SELECT(0);
     2326    19553    8                  FB$->FS$GBAN.ENTRIES.X_VAL(ENUM) = VAL;
     2327    19554    8                  VAL = (VAL * %XG_DEFAULT_MAX_NDC# ) / 100;
     2328    19555    8                  CALL SPLIT_VAL;
     2329    19556    8                  FB$->FS$GBAN.ENTRIES.NDC_X_VAL (ENUM) = UBINSPLIT;
     2330    19557    8                  SELECT(1);
     2331    19558    8                  FB$->FS$GBAN.ENTRIES.Y_VAL(ENUM) = VAL;
     2332    19559    8                  VAL = (VAL * %XG_DEFAULT_MAX_NDC# ) / 100;
     2333    19560    8                  CALL SPLIT_VAL;
     2334    19561    8                  FB$->FS$GBAN.ENTRIES.NDC_Y_VAL (ENUM) = UBINSPLIT;
     2335    19562    8                  SELECT(2);
     2336    19563    8                  FB$->FS$GBAN.ENTRIES.Z_VAL(ENUM) = VAL;
     2337    19564    8                  VAL = (VAL * %XG_DEFAULT_MAX_NDC# ) / 100;
     2338    19565    8                  CALL SPLIT_VAL;
     2339    19566    8                  FB$->FS$GBAN.ENTRIES.NDC_Z_VAL (ENUM) = UBINSPLIT;
     2340    19567    8                  SELECT(3);
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:78   
     2341    19568    9                  DO SELECT (VAL);
     2342    19569    9                     SELECT (0);
     2343    19570    9                     FB$->FS$GBAN.ENTRIES.DIRECTION (ENUM) = 0;
     2344    19571    9                     FB$->FS$GBAN.ENTRIES.CHARUP.X (ENUM) = 0;
     2345    19572    9                     FB$->FS$GBAN.ENTRIES.CHARUP.Y (ENUM) = 32767;  /* A one */
     2346    19573    9                     FB$->FS$GBAN.ENTRIES.CHARUP.Z (ENUM) = 0;
     2347    19574    9                     SELECT (90);
     2348    19575    9                     FB$->FS$GBAN.ENTRIES.DIRECTION (ENUM) = 90;
     2349    19576    9                     FB$->FS$GBAN.ENTRIES.CHARUP.X (ENUM) = %XG_DEFAULT_MAX_NDC# ;
     2350    19577    9                     FB$->FS$GBAN.ENTRIES.CHARUP.Y (ENUM) = 0;
     2351    19578    9                     FB$->FS$GBAN.ENTRIES.CHARUP.Z (ENUM) = 0;
     2352    19579    9                     SELECT (180);
     2353    19580    9                     FB$->FS$GBAN.ENTRIES.DIRECTION (ENUM) = 180;
     2354    19581    9                     FB$->FS$GBAN.ENTRIES.CHARUP.X (ENUM) = 0;
     2355    19582    9                     FB$->FS$GBAN.ENTRIES.CHARUP.Y (ENUM) = %XG_DEFAULT_MAX_NDC# ;
     2356    19583    9                     FB$->FS$GBAN.ENTRIES.CHARUP.Z (ENUM) = 0;
     2357    19584    9                     SELECT (270);
     2358    19585    9                     FB$->FS$GBAN.ENTRIES.DIRECTION (ENUM) = 270;
     2359    19586    9                     FB$->FS$GBAN.ENTRIES.CHARUP.X (ENUM) = 32767;
     2360    19587    9                     FB$->FS$GBAN.ENTRIES.CHARUP.Y (ENUM) = 0;
     2361    19588    9                     FB$->FS$GBAN.ENTRIES.CHARUP.Z (ENUM) = 0;
     2362    19589    9                     SELECT (ELSE);
     2363    19590        /*E* ERROR: ASF-E$BADROTATIONGRAPHIC-C
     2364    19591            MESSAGE: The allow specification for rotation is only 0, 90, 180 or 270 degrees.
     2365    19592             MESSAGE1: Value must also be below 361 degrees.
     2366    19593        */
     2367    19594                       %SCREAM (ERR#=E$BADROTATIONGRAPHIC,MID='F',LEVEL=ERROR);
     2368    19609    9                  GOTO BANNER_LOOP_END;
     2369    19610    9                     END; /* Do case on val */
     2370    19611    8               SELECT(4);
     2371    19612    8               FB$->FS$GBAN.ENTRIES.CHAR_WIDTH(ENUM) =VAL;
     2372    19613    8               VAL = (VAL * %XG_DEFAULT_MAX_NDC# ) / 100;
     2373    19614    8               CALL SPLIT_VAL;
     2374    19615    8               FB$->FS$GBAN.ENTRIES.CHARSIZE.CHAR_WIDTH (ENUM) = SPLIT;
     2375    19616    8               SELECT(5);
     2376    19617    8               FB$->FS$GBAN.ENTRIES.CHAR_HITE(ENUM) = VAL;
     2377    19618    8               VAL = (VAL * %XG_DEFAULT_MAX_NDC# ) / 100;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:79   
     2378    19619    8               CALL SPLIT_VAL;
     2379    19620    8               FB$->FS$GBAN.ENTRIES.CHARSIZE.CHAR_HITE (ENUM) = SPLIT;
     2380    19621    8               SELECT(6);
     2381    19622    8               FB$->FS$GBAN.ENTRIES.CHAR_SPACE(ENUM) =VAL;
     2382    19623    8               VAL = (VAL * %XG_DEFAULT_MAX_NDC# ) / 100;
     2383    19624    8               CALL SPLIT_VAL;
     2384    19625    8               FB$->FS$GBAN.ENTRIES.CHARSPACE.CHAR_SPACE (ENUM) = SPLIT;
     2385    19626    8                  END; /* Do case for entries */
     2386    19627    7               END;
     2387    19628    6            CALL ASB$SET_PROMPT ( %PROMPT_TXT );
     2388    19629    6            CALL ASB$READ_SI(IN_BUF,ARS);
     2389    19630    6            P_PCB.ROOT$ = ADDR( FB_TYPE_LIST );
     2390    19631    6            P_PCB.NCHARS = ARS;
     2391    19632    6            CALL X$PARSE(P_PCB) ALTRET( PARSE_ERR);
     2392    19633    6            CODE2= P_PCB.OUT$->P$NODE.CODE;
     2393    19634    6            IF A = 1 THEN
     2394    19635    7            DO SELECT (CODE2);
     2395    19636    7               SELECT(52 /* FT_LOGO */,53 /* FT_X */,58 /* FT_PLAIN */);
     2396    19637    7               SELECT(ELSE);
     2397    19638        /*   ERROR: ASF-E$BADINTRINSIC-0
     2398    19639             MESSAGE: That intrinsic is illegal for alignments.
     2399    19640             MESSAGE1: You can only use %LOG, %x, or plaintext
     2400    19641                         for an alignment image.
     2401    19642        */
     2402    19643                 %SCREAM( ERR#=E$BADINTRINSIC,MID='F',LEVEL=ERROR);
     2403    19658    7            P_PCB.ROOT$ = ADDR( F_A_OR_B_LIST);
     2404    19659    7            GOTO BANNER_LOOP;
     2405    19660    7               END;
     2406    19661    7            DO SELECT ( CODE2 );
     2407    19662    7               SELECT( 43 /* FT_SYSID */ );
     2408    19663    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 1/*SYSID*/;
     2409    19664    7               SELECT( 44 /* FT_ACCN */ );
     2410    19665    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 2/*ACCN*/;
     2411    19666    7               SELECT ( 45 /* FT_UNAME */ );
     2412    19667    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 3/*UNAME*/;
     2413    19668    7               SELECT( 46 /* FT_WOO */ );
     2414    19669    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 4/*WOO*/;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:80   
     2415    19670    7               SELECT( 47 /* FT_JOBNAME */ );
     2416    19671    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 5/*JNAME*/;
     2417    19672    7               SELECT( 48 /* FT_TIME */ );
     2418    19673    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 6/*TIME*/;
     2419    19674    7               SELECT( 49 /* FT_DATE */ );
     2420    19675    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 7/*DATE*/;
     2421    19676    7               SELECT( 50 /* FT_VERSION */ );
     2422    19677    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 8/*VERS*/;
     2423    19678    7               SELECT( 51 /* FT_SUBFILE */ );
     2424    19679    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 9/*SFILE*/;
     2425    19680    7               SELECT( 52 /* FT_LOGO */ );
     2426    19681    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 10/*LOGO*/;
     2427    19682    7               SELECT( 54 /* FT_WOD */ );
     2428    19683    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM)=12/*WOD*/;
     2429    19684    7               SELECT( 56 /* FT_SITENAME */ );
     2430    19685    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 14/*SITENAME*/;
     2431    19686    7               SELECT( 57 /* FT_SALUTE */ );
     2432    19687    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 15/*SALUTE*/;
     2433    19688    7               SELECT( 61 /* FT_FORM */ );
     2434    19689    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 16/*FORM*/;
     2435    19690    7               SELECT( 62 /* FT_MINI_ID */ );
     2436    19691    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 17/*MINI_ID*/;
     2437    19692    7               SELECT( 63 /*FT_BANNERTEXT0 */ );
     2438    19693    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 18/*BANRTEXT0*/;
     2439    19694    7               SELECT( 64 /*FT_BANNERTEXT1 */ );
     2440    19695    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 19/*BANRTEXT1*/;
     2441    19696    7               SELECT( 65 /*FT_BANNERTEXT2 */ );
     2442    19697    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 20/*BANRTEXT2*/;
     2443    19698    7               SELECT( 66 /*FT_BANNERTEXT3 */ );
     2444    19699    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 21/*BANRTEXT3*/;
     2445    19700    7               SELECT( 67 /*FT_BANNERTEXT4 */ );
     2446    19701    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 22/*BANRTEXT4*/;
     2447    19702    7               SELECT( 68 /*FT_BANNERTEXT5 */ );
     2448    19703    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 23/*BANRTEXT5*/;
     2449    19704    7               SELECT( 69 /*FT_BANNERTEXT6 */ );
     2450    19705    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 24/*BANRTEXT6*/;
     2451    19706    7               SELECT( 70 /*FT_BANNERTEXT7 */ );
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:81   
     2452    19707    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 25/*BANRTEXT7*/;
     2453    19708    7               SELECT( 71 /*FT_BANNERTEXT8 */ );
     2454    19709    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 26/*BANRTEXT8*/;
     2455    19710    7               SELECT( 72 /*FT_BANNERTEXT9 */ );
     2456    19711    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 27/*BANRTEXT9*/;
     2457    19712    7               SELECT( 73 /*FT_REGISTEREDNAME */ );
     2458    19713    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 28/*RGSTDNAM*/;
     2459    19714    7               SELECT( 53 /* FT_X */ );
     2460    19715    7               IF P_PCB.OUT$->P$NODE.SUBLK$(0)->OUT$SYM.COUNT ~= 1 THEN
     2461    19716    8               DO;
     2462    19717        /*   ERROR: ASF-E$BADXTYPE-0
     2463    19718             MESSAGE: Illegal type.
     2464    19719             MESSAGE1: Text of entry must be an intrinsic name or single character.
     2465    19720        */
     2466    19721                       %SCREAM( ERR#=E$BADXTYPE,MID='F',LEVEL=ERROR);
     2467    19736    8                  P_PCB.ROOT$ = ADDR(F_A_OR_B_LIST);
     2468    19737    8                  GOTO BANNER_LOOP;
     2469    19738    8                  END;
     2470    19739    8               ELSE DO;
     2471    19740    8                  FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 11/*RPTX*/;
     2472    19741    8                  FB$->FS$GBAN.ENTRIES.CHR(ENUM) = P_PCB.OUT$->
     2473    19742    8                       P$NODE.SUBLK$(0)->OUT$SYM.TEXT;
     2474    19743    8                  END;
     2475    19744    7               SELECT( 58 /* FT_PLAIN */ );
     2476    19745    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 0/*TEXT*/;
     2477    19746    7               FC_LEN = ARS;
     2478    19747    8               IF FC_LEN = 0 THEN DO;
     2479    19748        /*   ERROR: ASF-E$NULLENTRY-0
     2480    19749             MESSAGE: You must specify either:
     2481    19750                          a %intrinsic name
     2482    19751                          a %single character,
     2483    19752                          or a line of text.
     2484    19753        */
     2485    19754                       %SCREAM( ERR#=E$NULLENTRY,MID='F',LEVEL=ERROR);
     2486    19769    8                  P_PCB.ROOT$ = ADDR(F_A_OR_B_LIST);
     2487    19770    8                  GOTO BANNER_LOOP;
     2488    19771    8                  END;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:82   
     2489    19772    7               IF ADDR(FB$->FS$GBAN.ENTRIES.MARK(ENUM))>=FC$
     2490    19773    8               THEN DO;
     2491    19774                       %SCREAM( ERR#=E$BANBUFFULL,MID='F',LEVEL=ERROR);
     2492    19789    8                  FB$->FS$GBAN.NUM_ENTRIES = 0;
     2493    19790    8                  IF A = 0 THEN
     2494    19791    8                     F$->FS$GFORMREC.BANRDISP = 0;
     2495    19792    8                  ELSE
     2496    19793    8                     F$->FS$GFORMREC.ALGNDISP = 0;
     2497    19794    8                  RETURN;
     2498    19795    8                  END;
     2499    19796    7               FB$->FS$GBAN.ENTRIES.COUNT(ENUM) = FC_LEN;
     2500    19797    7               FC_LEN=(FC_LEN+3)/4;
     2501    19798    7               FC$=PINCRW(FC$,-(FC_LEN));
     2502    19799    7               FC_LEN=FC_LEN*4;
     2503    19800    7               FC_CHAR = IN_BUF;
     2504    19801    7               FB$->FS$GBAN.ENTRIES.DISP(ENUM) = POFFW(FC$,FB$);
     2505    19802    7               SUBNS=0;
     2506    19803    7               IF A = 0 THEN
     2507    19804    7                  FCB$ = FC$ ;
     2508    19805    7               ELSE
     2509    19806    7                  FCA$ = FC$;
     2510    19807    7               END;
     2511    19808    6            P_PCB.ROOT$ = ADDR( F_A_OR_B_LIST );
     2512    19809    6            ENUM=ENUM+1;
     2513    19810    6            FB$->FS$GBAN.NUM_ENTRIES = ENUM;
     2514    19811
     2515    19812    6            END DO_CASE;
     2516    19813    5   BANNER_LOOP_END:;
     2517    19814    5         END DO_I;
     2518    19815    4      END BANNER_LOOP;
     2519    19816    3   PARSE_ERR:
     2520    19817    3   CALL ASH$ERROR( P_PCB.ERROR );
     2521    19818    3   GOTO BANNER_LOOP;
     2522    19819    3   END BANNER;
     2523    19820        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:83   
     2524    19821    2   CHANGE162_9X9: PROC( MAX_VAL ) ALTRET;
     2525    19822
     2526    19823    3   DCL MAX_VAL UBIN WORD ;
     2527    19824
     2528    19825    3   CALL CHARBIN( VAL, OUT$SYM.TEXT );
     2529    19826    4   IF VAL > MAX_VAL THEN DO;
     2530    19827        /*E*  ERROR:  ASF-E$DEC_VALUE_TOO_BIG-C
     2531    19828              MESSAGE: %U1 value too large.
     2532    19829              MESSAGE1: %U1 is larger than the maximum value of %U2.
     2533    19830        */
     2534    19831           %NUMBER (NUM1=VAL,NUM2=MAX_VAL );
             19839    4         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, VAL );
             19847    4         CALL ASB$BINCHAR( AS_FIELD2.TEXT, 0, -2, MAX_VAL );
     2535    19861           %SCREAM( ERR#=E$DEC_VALUE_TOO_BIG, LEVEL=ERROR, MID='F' );
     2536    19876    4      ALTRETURN;
     2537    19877    4      END;
     2538    19878
     2539    19879    3   SPLIT = '0'B;
     2540    19880    3   SPLIT.T = SPLIT_VAL.T;
     2541    19881    3   SPLIT.B = SPLIT_VAL.B;
     2542    19882
     2543    19883
     2544    19884    3   END CHANGE162_9X9 ;
     2545    19885    2   SPLIT_VAL: PROC;
     2546    19886    3   SPLIT = '0'B;
     2547    19887    3   SPLIT.T = SPLIT_VAL.T;
     2548    19888    3   SPLIT.B = SPLIT_VAL.B;
     2549    19889    3   END SPLIT_VAL;
     2550    19890    2   END GFORM_OPTS;
     2551    19891        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:84   
     2552    19892    1   MOD_PSEUDO_FORMS: PROC ;
     2553    19893
     2554    19894    2   DCL I SBIN;
     2555    19895    2   DCL J SBIN;
     2556    19896    2   DCL FORM CHAR(6);
     2557    19897
     2558    19898    2   USERS_KEY = PSEUDO_FORM_KEY;
     2559    19899    2   FORM = SUBSTR( PSEUDO_FORM_KEY.TXT, 0, 6 );
     2560    19900    2   CALL ASF$PREC_FORM( USERS_KEY ) ALTRET(FINISHED);
     2561    19901    2   ARS = SIZEC(PSEUDO_FORM_REC);
     2562    19902    2   CALL ASF$READ_FORM_SEQ(, ADDR(PSEUDO_FORM_REC), ARS ) ALTRET(FINISHED);
     2563    19903    3   DO WHILE( USERS_KEY.COUNT = 12  AND  SUBSTR(USERS_KEY.TXTC,0,6)=FORM );
     2564    19904    3      I = 0;
     2565    19905    4      IF PSEUDO_FORM_REC.LPOK AND NOT LPOK THEN DO;
     2566    19906    4         PSEUDO_FORM_REC.LPOK = AS_FALSE;
     2567    19907    4         I = 1;
     2568    19908    4         END;
     2569    19909    4      IF PSEUDO_FORM_REC.TSOK AND NOT TSOK THEN DO;
     2570    19910    4         PSEUDO_FORM_REC.TSOK = AS_FALSE;
     2571    19911    4         I = 1;
     2572    19912    4         END;
     2573    19913    4      IF PSEUDO_FORM_REC.ELSOK AND NOT ELSOK THEN DO;
     2574    19914    4         PSEUDO_FORM_REC.ELSOK = AS_FALSE;
     2575    19915    4         I = 1;
     2576    19916    4         END;
     2577    19917    4      IF I > 0 THEN DO;
     2578    19918    4         CALL ASF$WRITE_FORM( USERS_KEY, ADDR(PSEUDO_FORM_REC),SIZEC(PSEUDO_FORM_REC) )
             19918                  ;
     2579    19919
     2580    19920    4         FORM_KEY.TEXT = SUBSTR(USERS_KEY.TXTC,6,6);
     2581    19921    4         ARS = 2048 * 4;
     2582    19922    4         CALL ASF$READ_FORM( FORM_KEY, F$, ARS ) ALTRET(NEXT);
     2583    19923    4         J = 0;
     2584    19924    4         IF GRAPHIC
     2585    19925    5         THEN DO;
     2586    19926    6            IF F$->FS$GFORMREC.LGLTYPS.LPOK AND NOT LPOK THEN DO;
     2587    19927    6               F$->FS$GFORMREC.LGLTYPS.LPOK = AS_FALSE;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:85   
     2588    19928    6               AS_FIELD3.TEXT = 'LPOK=NO,';
     2589    19929    6               J = 7;
     2590    19930    6               END;
     2591    19931    6            IF F$->FS$GFORMREC.LGLTYPS.TSOK AND NOT TSOK THEN DO;
     2592    19932    6               F$->FS$GFORMREC.LGLTYPS.TSOK = AS_FALSE;
     2593    19933    6               IF J > 0 THEN J = 8;
     2594    19934    6               CALL INSERT( AS_FIELD3.TEXT, J, , 'TSOK=NO,' );
     2595    19935    6               J = J + 7;
     2596    19936    6               END;
     2597    19937    6            IF F$->FS$GFORMREC.LGLTYPS.ELSOK AND NOT ELSOK THEN DO;
     2598    19938    6               F$->FS$GFORMREC.LGLTYPS.ELSOK = AS_FALSE;
     2599    19939    6               IF J > 0 THEN J = J + 1;
     2600    19940    6               CALL INSERT( AS_FIELD3.TEXT, J, , 'ELSOK=NO' );
     2601    19941    6               J = J + 8;
     2602    19942    6               END;
     2603    19943    5            END;
     2604    19944    5         ELSE DO;
     2605    19945    6            IF F$->FS$FORMREC.LGLTYPS.LPOK AND NOT LPOK THEN DO;
     2606    19946    6               F$->FS$FORMREC.LGLTYPS.LPOK = AS_FALSE;
     2607    19947    6               AS_FIELD3.TEXT = 'LPOK=NO,';
     2608    19948    6               J = 7;
     2609    19949    6               END;
     2610    19950    6            IF F$->FS$FORMREC.LGLTYPS.TSOK AND NOT TSOK THEN DO;
     2611    19951    6               F$->FS$FORMREC.LGLTYPS.TSOK = AS_FALSE;
     2612    19952    6               IF J > 0 THEN J = 8;
     2613    19953    6               CALL INSERT( AS_FIELD3.TEXT, J, , 'TSOK=NO,' );
     2614    19954    6               J = J + 7;
     2615    19955    6               END;
     2616    19956    6            IF F$->FS$FORMREC.LGLTYPS.ELSOK AND NOT ELSOK THEN DO;
     2617    19957    6               F$->FS$FORMREC.LGLTYPS.ELSOK = AS_FALSE;
     2618    19958    6               IF J > 0 THEN J = J + 1;
     2619    19959    6               CALL INSERT( AS_FIELD3.TEXT, J, , 'ELSOK=NO' );
     2620    19960    6               J = J + 8;
     2621    19961    6               END;
     2622    19962    5            END;
     2623    19963    5         IF J > 0 THEN DO;
     2624    19964    5            CALL ASF$WRITE_FORM( FORM_KEY, F$, ARS );
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:86   
     2625    19965        /*E* ERROR:   ASF-E$MOD_PSEUDO_FORM-C
     2626    19966             MESSAGE: Pseudo form %U1 also modified: %U3.
     2627    19967        */
     2628    19968    5            CALL INDEX( I, AS_BLANK, FORM_KEY.TEXT );
     2629    19969    5            AS_FIELD1.COUNT = I;
     2630    19970    5            AS_FIELD1.TEXT = FORM_KEY.TEXT;
     2631    19971    5            AS_FIELD3.COUNT = J;
     2632    19972                 %SCREAM( ERR#=E$MOD_PSEUDO_FORM, LEVEL=INFO, MID='F' );
     2633    19987    5            END;
     2634    19988    4         END;
     2635    19989    3   NEXT: CALL ASF$PREC_SKIP_FORM( USERS_KEY );
     2636    19990    3      ARS = SIZEC(PSEUDO_FORM_REC);
     2637    19991    3      CALL ASF$READ_FORM_SEQ( , ADDR(PSEUDO_FORM_REC), ARS ) ALTRET(FINISHED);
     2638    19992    3      END;
     2639    19993    2   FINISHED:
     2640    19994    2   RETURN;
     2641    19995
     2642    19996    2   END MOD_PSEUDO_FORMS;
     2643    19997        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:87   
     2644    19998    1   FORM_GATHER: PROC ALTRET;
     2645    19999
     2646    20000
     2647    20001    2   DCL FIXED_LENGTH STATIC UBIN HALF INIT(SIZEW(FS$FORMREC));
     2648    20002    2   DCL GFIXED_LENGTH STATIC UBIN HALF INIT(SIZEW(FS$GFORMREC));
     2649    20003    2   DCL FENTRYLEN STATIC UBIN HALF INIT(SIZEW(FS$FINST));
     2650    20004    2   DCL GENTRYLEN STATIC UBIN HALF INIT(SIZEW(FS$GBAN));
     2651    20005    2   DCL USE_LENGTH UBIN HALF;
     2652    20006    2   DCL ENTRY_LEN UBIN HALF;
     2653    20007    2   DCL NEW_BNRDISP UBIN HALF;
     2654    20008    2   DCL TEXT_LENGTH UBIN WORD;
     2655    20009    2   DCL ACCSS_LENGTH UBIN WORD UNAL;
     2656    20010    2   DCL ACCNT_LENGTH UBIN WORD UNAL;
     2657    20011    2   DCL BNNR_LENGTH UBIN WORD ;
     2658    20012    2   DCL ALGN_LENGTH UBIN WORD ;
     2659    20013    2   DCL SETUP_LENGTH UBIN WORD ;
     2660    20014    2   DCL I UBIN WORD;
     2661    20015        /*
     2662    20016              This code will gather all the elelments of the variable
     2663    20017              length :FORMS record and build and enter
     2664    20018              the appropriate displacement in the fixed portion of the
     2665    20019              record
     2666    20020
     2667    20021              there are some restrictions on the size of the record.
     2668    20022
     2669    20023                  Fixed + access + accounts + banner < 700 words
     2670    20024
     2671    20025                  total record < 2K
     2672    20026
     2673    20027        */
     2674    20028                                                                  /* */
     2675    20029                                                                  /* */
     2676    20030    2   IF GRAPHIC
     2677    20031    3   THEN DO;
     2678    20032    3      USE_LENGTH = GFIXED_LENGTH;
     2679    20033    3      ENTRY_LEN = GENTRYLEN - 1; /* 1 word header in gban */
     2680    20034    3      END;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:88   
     2681    20035    3   ELSE DO;
     2682    20036    3      USE_LENGTH = FIXED_LENGTH;
     2683    20037    3      ENTRY_LEN = FENTRYLEN - 1; /* 1 word header in finstn */
     2684    20038    3      END;
     2685    20039    2   DISP_TALLY = USE_LENGTH; /* Displacement to access part */
     2686    20040    2   FF$ = PINCRW(F$,DISP_TALLY) ;
     2687    20041    2   ACCESS_PART: ;
     2688    20042    2   IF ACCSS$ ~= ADDR(NIL) AND ACCSS$->FS$ACCESS.TNAMES > 0 THEN
     2689    20043    2      F$->FS$FORMREC.ACCSDISP = DISP_TALLY;
     2690    20044    3   ELSE DO;
     2691    20045    3      F$->FS$FORMREC.ACCSDISP = 0;
     2692    20046    3      GOTO ACCOUNT_PART;      /* No accesses  */
     2693    20047    3      END;  /* Do */
     2694    20048                                                                  /* */
     2695    20049                                                                  /* */
     2696    20050    2   ACCSS_LENGTH = (ACCSS$->FS$ACCESS.TNAMES * 2) + 1;
     2697    20051                                                                  /* */
     2698    20052                                                                  /* */
     2699    20053                                                                 /*
     2700    20054              Now we know how much to move
     2701    20055                                                                 */
     2702    20056    2   FF$ = PINCRW(F$,DISP_TALLY);    /* Adjust pointer  */
     2703    20057    2   MOVE_CNT = ACCSS_LENGTH*4;      /* Char count */
     2704    20058    2   FF$->TEMPLATE = ACCSS$->TEMPLATE;   /* Move it  */
     2705    20059    2   ACCSS$ = ADDR(NIL);
     2706    20060    2   DISP_TALLY = DISP_TALLY + ACCSS_LENGTH;
     2707    20061                                                                  /* */
     2708    20062                                                                  /* */
     2709    20063    2   ACCOUNT_PART: ;
     2710    20064    2   IF ACCNT$ ~= ADDR(NIL) AND ACCNT$->FS$ACCOUNTS.TACCTS > 0 THEN
     2711    20065    2      F$->FS$FORMREC.ACCTDISP = DISP_TALLY;
     2712    20066    3   ELSE DO;
     2713    20067    3      F$->FS$FORMREC.ACCTDISP = 0;
     2714    20068    3      GOTO BANNER_PART;      /* No accounts  */
     2715    20069    3      END;  /* Do */
     2716    20070                                                                  /* */
     2717    20071                                                                  /* */
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:89   
     2718    20072    2   ACCNT_LENGTH = (ACCNT$->FS$ACCOUNTS.TACCTS * 2) + 1;
     2719    20073                                                                  /* */
     2720    20074                                                                  /* */
     2721    20075                                                                 /*
     2722    20076              Now we know how much to move
     2723    20077                                                                 */
     2724    20078    2   FF$ = PINCRW(F$,DISP_TALLY);    /* Adjust pointer  */
     2725    20079    2   MOVE_CNT = ACCNT_LENGTH*4;      /* Char count */
     2726    20080    2   FF$->TEMPLATE = ACCNT$->TEMPLATE;   /* Move it  */
     2727    20081    2   ACCNT$ = ADDR(NIL);
     2728    20082    2   DISP_TALLY = DISP_TALLY + ACCNT_LENGTH;
     2729    20083    2   BANNER_PART: ;
     2730    20084    2   IF BNNR$ = ADDR(NIL)
     2731    20085    3   THEN DO;
     2732    20086    3      F$->FS$FORMREC.BANRDISP = 0;
     2733    20087    3      GOTO CHECK_LENGTH_1;
     2734    20088    3      END;     /* Do */
     2735    20089    2   F$->FS$FORMREC.BANRDISP = DISP_TALLY;
     2736    20090    2   IF OLD_BANNER = '1'B
     2737    20091    3   THEN DO;                  /* The banner is in tact from a
     2738    20092                                          previous record, I.E.,
     2739    20093                                          create = AS_FALSE      */
     2740    20094    3      OLD_BANNER='0'B;     /* Clear it               */
     2741    20095    3      IF GRAPHIC
     2742    20096    4      THEN DO;
     2743    20097    4         ENUM = BNNR$->FS$GBAN.NUM_ENTRIES;
     2744    20098    4         BNNR_LENGTH = ENUM * ENTRY_LEN + 1;
     2745    20099    5         DO I = 0 TO ENUM-1; /* Find first disp   */
     2746    20100    5            IF BNNR$->FS$GBAN.ENTRIES.DISP(I) ~= 0
     2747    20101    6            THEN DO;
     2748    20102                         /* This only works because the text area is built
     2749    20103                            backwards.  The first entry is the last piece of
     2750    20104                            text.
     2751    20105                         */
     2752    20106    6               BNNR_LENGTH = (BNNR$->FS$GBAN.ENTRIES.COUNT(I) +3) / 4;
     2753    20107    6               BNNR_LENGTH = BNNR$->FS$GBAN.ENTRIES.DISP(I) + BNNR_LENGTH;
     2754    20108    6               GOTO END_LOOP;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:90   
     2755    20109    6               END;
     2756    20110    5            END; /* Do i */
     2757    20111    4         END;
     2758    20112    4      ELSE DO;
     2759    20113    4         ENUM = BNNR$->FS$FINST.NUM_ENTRIES;
     2760    20114    4         BNNR_LENGTH = ENUM * 4 + 1;  /* Size of banner (words)*/
     2761    20115    5         DO I = 0 TO ENUM-1; /* Find first disp   */
     2762    20116    5            IF BNNR$->FS$FINST.ENTRIES.DISP(I) ~= 0
     2763    20117    6            THEN DO;
     2764    20118                         /* This only works because the text area is built
     2765    20119                            backwards.  The first entry is the last piece of
     2766    20120                            text.
     2767    20121                         */
     2768    20122    6               BNNR_LENGTH = (BNNR$->FS$FINST.ENTRIES.COUNT(I) +3) / 4;
     2769    20123    6               BNNR_LENGTH = BNNR$->FS$FINST.ENTRIES.DISP(I) + BNNR_LENGTH;
     2770    20124    6               GOTO END_LOOP;
     2771    20125    6               END;
     2772    20126    5            END; /* Do i */
     2773    20127    4         END;
     2774    20128    3   END_LOOP:
     2775    20129                                                                    /* */
     2776    20130    3      FF$ = PINCRW(F$,DISP_TALLY);
     2777    20131    3      MOVE_CNT = BNNR_LENGTH*4;
     2778    20132    3      FF$->TEMPLATE = BNNR$->TEMPLATE;
     2779    20133    3      BNNR$ = ADDR(NIL);
     2780    20134    3      DISP_TALLY = DISP_TALLY + BNNR_LENGTH;
     2781    20135    3      BNNR$ = ADDR(NIL);
     2782    20136    3      GOTO CHECK_LENGTH_1;
     2783    20137    3      END;    /* Do if using old banner   */
     2784    20138                                                                  /* */
     2785    20139    2   IF GRAPHIC
     2786    20140    3   THEN DO;
     2787    20141    3      ENUM = BNNR$->FS$GBAN.NUM_ENTRIES;
     2788    20142    4      DO I = 0 TO ENUM-1;
     2789    20143    4         BNNR$->FS$GBAN.ENTRIES.TOTLEN(I) = 0;
     2790    20144    4         BNNR$->FS$GBAN.ENTRIES.MARK(I) = 0;
     2791    20145    4         END;              /*  End i   */
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:91   
     2792    20146    3      END;
     2793    20147    3   ELSE DO;
     2794    20148    3      ENUM = BNNR$->FS$FINST.NUM_ENTRIES;
     2795    20149    4      DO I = 0 TO ENUM-1;
     2796    20150    4         BNNR$->FS$FINST.ENTRIES.TOTLEN(I) = 0;
     2797    20151    4         BNNR$->FS$FINST.ENTRIES.MARK(I) = 0;
     2798    20152    4         END;              /*  End i   */
     2799    20153    3      END;
     2800    20154                                                                  /*
     2801    20155              The length of the banner portion must be done in
     2802    20156              two parts -
     2803    20157                  first the forms instruction protion
     2804    20158                                                                  */
     2805    20159    2   IF GRAPHIC
     2806    20160    3   THEN DO;
     2807    20161    3      BNNR_LENGTH = (BNNR$ ->FS$GBAN.NUM_ENTRIES * ENTRY_LEN) + 1;
     2808    20162    3      END;
     2809    20163    3   ELSE DO;
     2810    20164    3      BNNR_LENGTH = (BNNR$ ->FS$FINST.NUM_ENTRIES * 4) + 1;
     2811    20165    3      END;
     2812    20166                                                                 /*
     2813    20167              Change the disp field in each entry before bringing
     2814    20168              up the text
     2815    20169                                                          */
     2816    20170    3   IF FCB$ ~= ADDR(NIL) THEN DO ;
     2817    20171    3      FF$ = PINCRW(BNNR$,BNNR_LENGTH) ;
     2818    20172    3      NEW_BNRDISP = POFFW(FCB$,FF$);
     2819    20173    4      DO I = 0 TO ENUM - 1;
     2820    20174    4         IF GRAPHIC
     2821    20175    5         THEN DO;
     2822    20176    5            IF BNNR$ ->FS$GBAN.ENTRIES.DISP(I) ~= 0
     2823    20177    6            THEN DO;
     2824    20178    6               BNNR$ ->FS$GBAN.ENTRIES.DISP(I) = BNNR$ ->FS$GBAN.ENTRIES.DISP(I) -
             20178                        NEW_BNRDISP;
     2825    20179    6               END;
     2826    20180    5            END;
     2827    20181    5         ELSE DO;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:92   
     2828    20182    5            IF BNNR$ -> FS$FINST.ENTRIES.DISP(I) ~= 0
     2829    20183    6            THEN DO;
     2830    20184    6               BNNR$ -> FS$FINST.ENTRIES.DISP(I) = BNNR$ ->FS$FINST.ENTRIES.DISP(I) -
             20184                        NEW_BNRDISP;
     2831    20185    6               END;
     2832    20186    5            END;
     2833    20187    4         END; /* I */
     2834    20188    3      END;      /* Do if   */
     2835    20189    2   FF$ = PINCRW(F$,DISP_TALLY);
     2836    20190    2   MOVE_CNT = BNNR_LENGTH*4;       /* Char count  */
     2837    20191    2   FF$->TEMPLATE = BNNR$->TEMPLATE;      /* Move 'EM  */
     2838    20192    2   DISP_TALLY = DISP_TALLY + BNNR_LENGTH;
     2839    20193    2   IF FCB$ = ADDR(NIL)
     2840    20194    3   THEN DO;
     2841    20195    3      BNNR$ = ADDR(NIL) ;
     2842    20196    3      GOTO CHECK_LENGTH_1;
     2843    20197    3      END;      /*   End do    */
     2844    20198                                                        /*
     2845    20199
     2846    20200              Now move the text
     2847    20201
     2848    20202                                                          */
     2849    20203    2   TEXT_LENGTH = POFFW(FCB$,BNNR$);
     2850    20204    2   TEXT_LENGTH = (TEXT_OFFSET-BNNR_OFFSET) - TEXT_LENGTH;
     2851    20205    2   BNNR$ = ADDR(NIL);
     2852    20206                                                            /*
     2853    20207                                                            */
     2854    20208    2   FF$ = PINCRW(F$,DISP_TALLY);
     2855    20209    2   MOVE_CNT = TEXT_LENGTH*4;
     2856    20210    2   FF$ -> TEMPLATE = FCB$ -> TEMPLATE;
     2857    20211    2   DISP_TALLY = DISP_TALLY + TEXT_LENGTH;
     2858    20212    2   FCB$ = ADDR(NIL);
     2859    20213    2   CHECK_LENGTH_1: ;
     2860    20214    2   IF (DISP_TALLY - USE_LENGTH) > 1024
     2861    20215    3   THEN DO;
     2862    20216        /*E*     ERROR: ASF-E$FORMTOOLONG-0
     2863    20217                 MESSAGE: :FORM Record too long
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:93   
     2864    20218                 MESSAGE1: FIXED + ACCESS + ACCOUNT + BANNER > 700 WORDS
     2865    20219        */
     2866    20220           %SCREAM( ERR#=E$FORMTOOLONG,MID='F',LEVEL=ERROR);
     2867    20235    3      ALTRETURN;
     2868    20236    3      END;
     2869    20237    2   IF SETUP$ = ADDR(NIL)
     2870    20238    3   THEN DO;
     2871    20239    3      F$->FS$FORMREC.SETUPDISP = 0;
     2872    20240    3      GOTO ALIGNMENT_PART;
     2873    20241    3      END;
     2874    20242                                                               /*
     2875    20243                                                               */
     2876    20244    2   F$ -> FS$FORMREC.SETUPDISP = DISP_TALLY;
     2877    20245    2   SETUP_LENGTH = SETUP$ ->FS$SETUP.LINES;
     2878    20246    2   SETUP_LENGTH = SETUP_LENGTH * 18;  /*  18 wds/line  */
     2879    20247    2   SETUP_LENGTH = SETUP_LENGTH +1;
     2880    20248                                                                  /* */
     2881    20249                                                                  /* */
     2882    20250                                                                /*
     2883    20251              Let's move it
     2884    20252                                                                */
     2885    20253    2   FF$ = PINCRW(F$,DISP_TALLY);
     2886    20254    2   MOVE_CNT = SETUP_LENGTH*4;            /* Char count  */
     2887    20255    2   FF$ -> TEMPLATE = SETUP$ -> TEMPLATE;
     2888    20256    2   SETUP$ = ADDR(NIL);
     2889    20257    2   DISP_TALLY = DISP_TALLY + SETUP_LENGTH;
     2890    20258    2   ALIGNMENT_PART: ;
     2891    20259    2   IF ALGN$ = ADDR(NIL)
     2892    20260    3   THEN DO;
     2893    20261    3      F$->FS$FORMREC.ALGNDISP = 0;
     2894    20262    3      GOTO CHECK_LENGTH_2;
     2895    20263    3      END;   /*  Do  */
     2896    20264    2   F$->FS$FORMREC.ALGNDISP = DISP_TALLY;
     2897    20265    2   IF OLD_ALGN = '1'B
     2898    20266    3   THEN DO;                  /* The algn is in tact from a
     2899    20267                                          previous record, I.E.,
     2900    20268                                          create = AS_FALSE      */
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:94   
     2901    20269    3      OLD_ALGN='0'B;       /* Clear it               */
     2902    20270    3      IF GRAPHIC
     2903    20271    4      THEN DO;
     2904    20272    4         ENUM = ALGN$->FS$GBAN.NUM_ENTRIES;
     2905    20273    4         ALGN_LENGTH = ENUM * ENTRY_LEN + 1;
     2906    20274    5         DO I = 0 TO ENUM-1;       /* Find first disp   */
     2907    20275    5            IF ALGN$->FS$GBAN.ENTRIES.DISP(I) ~= 0
     2908    20276    6            THEN DO;
     2909    20277    6               ALGN_LENGTH = (ALGN$->FS$GBAN.ENTRIES.COUNT(I) +3) / 4;
     2910    20278    6               ALGN_LENGTH = ALGN$->FS$GBAN.ENTRIES.DISP(I) + ALGN_LENGTH;
     2911    20279    6               GOTO END_LOOP$A;
     2912    20280    6               END;
     2913    20281    5            END; /* Do i */
     2914    20282    4         END;
     2915    20283    4      ELSE DO;
     2916    20284    4         ENUM = ALGN$->FS$FINST.NUM_ENTRIES; /* Size of algn???  */
     2917    20285    4         ALGN_LENGTH = ENUM*4 + 1;
     2918    20286    5         DO I = 0 TO ENUM-1; /* Find first disp   */
     2919    20287    5            IF ALGN$->FS$FINST.ENTRIES.DISP(I) ~= 0
     2920    20288    6            THEN DO;
     2921    20289    6               ALGN_LENGTH = (ALGN$->FS$FINST.ENTRIES.COUNT(I) +3) / 4;
     2922    20290    6               ALGN_LENGTH = ALGN$->FS$FINST.ENTRIES.DISP(I) + ALGN_LENGTH;
     2923    20291    6               GOTO END_LOOP$A;
     2924    20292    6               END;
     2925    20293    5            END; /* Do i */
     2926    20294    4         END;
     2927    20295    3   END_LOOP$A:;
     2928    20296                                                                    /* */
     2929    20297    3      FF$ = PINCRW(F$,DISP_TALLY);
     2930    20298    3      MOVE_CNT = ALGN_LENGTH*4;
     2931    20299    3      FF$->TEMPLATE = ALGN$->TEMPLATE;
     2932    20300    3      ALGN$ = ADDR(NIL);
     2933    20301    3      DISP_TALLY = DISP_TALLY + ALGN_LENGTH;
     2934    20302    3      ALGN$ = ADDR(NIL);
     2935    20303    3      GOTO CHECK_LENGTH_2;
     2936    20304    3      END;    /* Do if using old algn   */
     2937    20305    2   ENUM = ALGN$->FS$FINST.NUM_ENTRIES;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:95   
     2938    20306    2   IF GRAPHIC
     2939    20307    3   THEN DO;
     2940    20308    4      DO I = 0 TO ENUM-1;
     2941    20309    4         ALGN$->FS$GBAN.ENTRIES.MARK(I) = 0;
     2942    20310    4         ALGN$->FS$GBAN.ENTRIES.TOTLEN(I) = 0;
     2943    20311    4         END; /* End i  */
     2944    20312    3      END;
     2945    20313    3   ELSE DO;
     2946    20314    4      DO I = 0 TO ENUM-1;
     2947    20315    4         ALGN$->FS$FINST.ENTRIES.MARK(I) = 0;
     2948    20316    4         ALGN$->FS$FINST.ENTRIES.TOTLEN(I) = 0;
     2949    20317    4         END; /* End i  */
     2950    20318    3      END;
     2951    20319                                                                  /*
     2952    20320              The length of the alignment protion must be done in
     2953    20321              two parts -
     2954    20322                  first the forms instruction protion
     2955    20323                                                                  */
     2956    20324    2   IF GRAPHIC
     2957    20325    3   THEN DO;
     2958    20326    3      ALGN_LENGTH = ALGN$ ->FS$GBAN.NUM_ENTRIES;
     2959    20327    3      ALGN_LENGTH = ALGN_LENGTH * ENTRY_LEN;
     2960    20328    3      ALGN_LENGTH = ALGN_LENGTH + 1;
     2961    20329    3      END;
     2962    20330    3   ELSE DO;
     2963    20331    3      ALGN_LENGTH = ALGN$ ->FS$FINST.NUM_ENTRIES;
     2964    20332    3      ALGN_LENGTH = ALGN_LENGTH * 4;
     2965    20333    3      ALGN_LENGTH = ALGN_LENGTH + 1;
     2966    20334    3      END;
     2967    20335                                                                 /*
     2968    20336              Change the disp field in each entry before bringing
     2969    20337              up the text
     2970    20338                                                                 */
     2971    20339    3   IF FCA$ ~= ADDR(NIL) THEN DO ;
     2972    20340    3      FF$ = PINCRW(ALGN$,ALGN_LENGTH);
     2973    20341    3      NEW_BNRDISP = POFFW(FCA$,FF$);
     2974    20342    4      DO I = 0 TO ENUM - 1;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:96   
     2975    20343    4         IF GRAPHIC
     2976    20344    5         THEN DO;
     2977    20345    5            IF ALGN$ ->FS$GBAN.ENTRIES.DISP(I) ~= 0
     2978    20346    6            THEN DO;
     2979    20347    6               ALGN$ ->FS$GBAN.ENTRIES.DISP(I) = ALGN$ ->FS$GBAN.ENTRIES.DISP(I) -
             20347                        NEW_BNRDISP;
     2980    20348    6               END;
     2981    20349    5            END;
     2982    20350    5         ELSE DO;
     2983    20351    5            IF ALGN$ -> FS$FINST.ENTRIES.DISP(I) ~= 0
     2984    20352    6            THEN DO;
     2985    20353    6               ALGN$ -> FS$FINST.ENTRIES.DISP(I) = ALGN$ ->FS$FINST.ENTRIES.DISP(I) -
             20353                        NEW_BNRDISP;
     2986    20354    6               END;
     2987    20355    5            END;
     2988    20356    4         END; /* I */
     2989    20357    3      END;    /* End do if  */
     2990    20358    2   FF$ = PINCRW(F$,DISP_TALLY);
     2991    20359    2   MOVE_CNT = ALGN_LENGTH*4;       /* Char count  */
     2992    20360    2   FF$->TEMPLATE = ALGN$->TEMPLATE;      /* Move 'EM  */
     2993    20361    2   DISP_TALLY = DISP_TALLY + ALGN_LENGTH;
     2994    20362    2   IF FCA$ = ADDR(NIL)
     2995    20363    3   THEN DO;
     2996    20364    3      ALGN$=ADDR(NIL);
     2997    20365    3      GOTO CHECK_LENGTH_2;
     2998    20366    3      END;     /* End do */
     2999    20367                                                     /*
     3000    20368
     3001    20369              Now move the text
     3002    20370
     3003    20371                                                          */
     3004    20372    2   TEXT_LENGTH = POFFW(FCA$,ALGN$);
     3005    20373    2   TEXT_LENGTH = (TEXT_OFFSET - ALGN_OFFSET) - TEXT_LENGTH;
     3006    20374    2   ALGN$ = ADDR(NIL);
     3007    20375                                                            /*
     3008    20376                                                            */
     3009    20377    2   FF$ = PINCRW(F$,DISP_TALLY);
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:97   
     3010    20378    2   MOVE_CNT = TEXT_LENGTH*4;
     3011    20379    2   FF$ -> TEMPLATE = FCA$ -> TEMPLATE;
     3012    20380    2   DISP_TALLY = DISP_TALLY + TEXT_LENGTH;
     3013    20381    2   FCA$ = ADDR(NIL) ;
     3014    20382    2   CHECK_LENGTH_2: ;
     3015    20383    2   IF DISP_TALLY < 1025 THEN RETURN;
     3016    20384        /*E* ERROR: ASF-E$FORMRECERR-0
     3017    20385              MESSAGE: :FORM record too long
     3018    20386              MESSAGE1: FIXED + ACCESS + ACCOUNT + BANNER + ALIGNMENT + SETUP > 1024 WORDS
     3019    20387        */
     3020    20388        %SCREAM( ERR#=E$FORMRECERR,MID='F',LEVEL=ERROR);
     3021    20403    2   ALTRETURN;
     3022    20404    2   END FORM_GATHER;
     3023    20405    1   END ASF$FORM;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:98   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XG_SUBS_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   FS_SUPER_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASF$FORM.

   Procedure ASF$FORM requires 6016 words for executable code.
   Procedure ASF$FORM requires 2124 words of local(AUTO) storage.

    No errors detected in file ASF$FORM.:E05TSI    .

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:99   

 Object Unit name= ASF$FORM                                   File name= ASF$FORM.:E05TOU
 UTS= JUL 29 '97 09:50:58.88 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2   Data  even  none    11     13  ASF$FORM
    3  RoData even  UTS     66    102  ASF$FORM
    4   Proc  even  none  6016  13600  ASF$FORM
    5  RoData even  none   107    153  ASF$FORM

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        1  ASF$FORM
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:100  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
 yes     yes           Std       3 ASF$READ_FORM
         yes           Std       4 ASB$BINCHAR
 yes     yes           Std       3 ASF$WRITE_FORM
         yes           Std       1 ASR$R_PSEUDO_FORMS
 yes     yes           Std       0 ASB$GETSEG
         yes           Std       2 ASH$ERROR
         yes           Std       3 ASF$QUERY_PSEUDO_FORMS
         yes           Std       2 ASH$WARN
 yes     yes           Std       1 X$PARSE
 yes     yes           Std       3 ASB$SET_PROMPT
         yes           Std       2 ASB$READ_SI
         yes           Std       0 ASH$HELP
         yes           Std       0 ASH$QUEST
         yes           Std       0 ASH$DQUEST
 yes     yes           Std       1 ASF$PREC_FORM
 yes     yes           Std       3 ASF$READ_FORM_SEQ
 yes     yes           Std       1 ASF$PREC_SKIP_FORM
         yes           Std       2 ASH$INFO
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:101  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    AS_BLANK                         r    AS_TRUE
r    AS_FALSE                         r    AS_MODE                          r    AS_FE_MODE
     M$LO                                  USERS_KEY                             IN_BUF
     NODE$                                 CODE                                  ERR_CODE
     AS_FIELD1                             AS_FIELD2                             AS_FIELD3
     REMEM_VAR                             REM_FCMD                              ASA_BRKS_LOC
     DSEG_FLG                              DSEG1$                                DSEG2$
     DSEG3$                                P_PCB                                 FORM_CMD
     PSEUDO_CMD                            FORM_OPTS_LIST                        PSEUDO_OPTS_LIST
     GFORM_OPTS_LIST                       GPSEUDO_OPTS_LIST                     F_A_OR_B_LIST
     F_VFU_LIST                            FB_TYPE_LIST                          B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:102  


        1        1        /*M* ASF$FORM -- PROCS TO HANDLE FORMS FOR SUPER */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9        ASF$FORM: PROC( PSEUDO_FLAG );

      9  4 000000   000000 700200 xent  ASF$FORM     TSX0  ! X66_AUTO_1
         4 000001   004114 000001                    ZERO    2124,1

       10       10        %SET LISTSUB = '1'B;
       11       11        /*****************************************************************/
       12       12        /*D*  NAME:       ASF$FORMS
       13       13        DESCRIPTION:
       14       14        To create a form defintion useing SUPER, the command is:
       15       15        C[REATE] FOR[M] formname [ FROM formname2]
       16       16        'formname' is the name of the form you are creating, and
       17       17        'formname2' is the name of an existing form that you want to use
       18       18        to get the default setting for options.  If 'FROM formname2' is
       19       19        ommited, the default is 'FROM STDLP'.
       20       20        Formnames must be from 1 to 6 characters long.
       21       21        To modify an existing form, you use the command:
       22       22        M[ODIFY] FOR[M] formname [ FROM formname2]
       23       23        'formname' and 'formname2' mean the same thing as in the create
       24       24        command, but if 'FROM formname2' is ommited, the default is
       25       25        'FROM formname'.
       26       26        **
       27       27        ASF$FORM calls the internal procedure FORM_OPTS to proccess
       28       28        the options.                                                   */
       29       29        /****************************************************************/
       30       30        /*
       31       31                  I n c l u d e     f i l e s
       32       32        */
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:103  
       33       33        %INCLUDE AS_ENTRIES_M;
       34     1083        %INCLUDE CP_6;
       35     1164        %INCLUDE CP_6_SUBS;
       36     1704        %INCLUDE AS_SUPER_C;
       37     2139        %INCLUDE FS_SUPER_C;
       38     2902        %INCLUDE KL_SUPER_C;
       39     5804        %INCLUDE AS_SUBS_C;
       40     7218        %INCLUDE AS_MAC_C;
       41     7298        %INCLUDE AS_PERR_C;
       42     7900        %INCLUDE B_ERRORS_C;
       43     9027        %INCLUDE XU_MACRO_C;
       44    12133        %INCLUDE XU_FORMAT_C;
       45    12295        %INCLUDE XG_SUBS_C;
       46    12789        %INCLUDE AS_SUPER_R;
       47    15805        /*
       48    15806                  P a r a m e t e r
       49    15807        */
       50    15808    1   DCL PSEUDO_FLAG BIT(1) ALIGNED; /*'0'B => create/modify form command*/
       51    15809                                      /* '1'b => create/modify pseudo command */
       52    15810        %LIST;
       53    15811        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:104  
       54    15812        %FS$GFORMREC (NAME = FS$GFORMREC,
       55    15813                      STCLASS="BASED") ;
             15814        %LSET STR=CONCAT(TEXTCHAR(BASED),'        ');
             15815        %IF (SUBSTR(STR,0,6)='STATIC') OR
             15816         (SUBSTR(STR,0,8)='CONSTANT') OR
             15817         (SUBSTR(STR,0,3)='EXT');
             15819        %ELSE;
             15820        %LSET INIT=CHARTEXT('/*');
             15821        %ENDIF;
             15822    1   DCL 1 FS$GFORMREC BASED ALIGNED,
             15823    1         2 FNAME CHAR(6) %INIT('  ')%CHARTEXT('/**/'), /* GRAPHIC FORM NAME   */
             15824    1         2 ACCTDISP UBIN HALF UNAL %INIT(0)%CHARTEXT('/**/'),
             15825    1         2 SETUPDISP UBIN HALF UNAL %INIT(0)%CHARTEXT('/**/'), /* WD DISP TO SETUP */
             15826    1         2 ACCSDISP UBIN HALF UNAL %INIT(0)%CHARTEXT('/**/'), /* DISP TO ACCESS */
             15827    1         2 BANRDISP UBIN HALF UNAL %INIT(0)%CHARTEXT('/**/'), /* DISP TO BANNER */
             15828    1         2 ALGNDISP UBIN HALF UNAL %INIT(0)%CHARTEXT('/**/'), /* DISP TO ALGNMENT */
             15829    1         2 * BIT(7) %INIT('0000000'B)%CHARTEXT('/**/'),
             15830    1         2 TRANSLGL BIT(1) %INIT('0'B)%CHARTEXT('/**/'), /* TRANSPARENT LEGAL */
             15831    1         2 GRAPHIC BIT(1) %INIT('1'B)%CHARTEXT('/**/'), /* GRAPHIC FORM   */
             15832        /*   The LGLTYPS field here is duplicated in the FS$CHARSET record
             15833             and when that structure is changed, this one should be checked!
             15834            CHAIN is specified in the form definition to bring in the
             15835           attributes and the legal devices list...
             15836        */
             15837        /*  LEGAL TYPE OF DEVICES FOR THIS GRAPHIC FORM */
             15838    1         2 LGLTYPS,
             15839    1           3 LPOK BIT(1) %INIT('0'B)%CHARTEXT('/**/'), /* LEGAL ON LP           */
             15840    1           3 TSOK BIT(1) %INIT('0'B)%CHARTEXT('/**/'), /* LEGAL ON TS           */
             15841    1           3 ELSOK BIT(1) %INIT('0'B)%CHARTEXT('/**/'), /* LEGAL ON ALL BUT TS+LP */
             15842    1           3 ONEOK BIT(1) %INIT('1'B)%CHARTEXT('/**/'), /* LEGAL ON TYP=LTYP   */
             15843    1           3 * BIT(5) %INIT('00000'B)%CHARTEXT('/**/'),
             15844    1           3 LTYP CHAR(2) %INIT('GR')%CHARTEXT('/**/'), /* LEGAL IF ONEOK=YES   */
             15845    1         2 ATTR BIT(18) UNAL %INIT('000002'O) %CHARTEXT('/**/'),
             15846    1         2 CHAIN_NAME CHAR(8) %INIT('NONE')%CHARTEXT('/**/'),
             15847    1         2 X_SIZE UBIN (18) UNAL %INIT (0) %CHARTEXT('/**/'),
             15848    1         2 Y_SIZE UBIN (18) UNAL %INIT (0) %CHARTEXT('/**/'),
             15849    1         2 Z_SIZE UBIN (18) UNAL %INIT (0) %CHARTEXT('/**/'),
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:105  
             15850    1         2 X_OFFSET UBIN (18) UNAL %INIT(0) %CHARTEXT('/**/'),
             15851    1         2 Y_OFFSET UBIN (18) UNAL %INIT(0) %CHARTEXT('/**/'),
             15852    1         2 Z_OFFSET UBIN (18) UNAL %INIT(0) %CHARTEXT('/**/'),
             15853    1         2 SET_DEV_LIM,
             15854    1           3 DEV_LIM_OPCODE,
             15855    1             4 CLASS UBIN (9) UNAL %INIT(%XG_COOP_CONTROL#) %CHARTEXT ('/**/'),
             15856    1             4 INDX UBIN (9) UNAL %INIT(%XG_COOP_SET_DEV_LIM#) %CHARTEXT ('/**/'),
             15857    1           3 X_SIZE BIT (18) UNAL %INIT('000000'O) %CHARTEXT('/**/'),
             15858    1           3 Y_SIZE BIT (18) UNAL %INIT('000000'O) %CHARTEXT('/**/'),
             15859    1           3 Z_SIZE BIT (18) UNAL %INIT('000000'O) %CHARTEXT('/**/'),
             15860    1           3 X_OFFSET BIT (18) UNAL %INIT('000000'O) %CHARTEXT('/**/'),
             15861    1           3 Y_OFFSET BIT (18) UNAL %INIT('000000'O) %CHARTEXT('/**/'),
             15862    1           3 Z_OFFSET BIT (18) UNAL %INIT('000000'O) %CHARTEXT('/**/'),
             15863    1           3 SPARAM6 BIT (18) UNAL %INIT('000000'O) %CHARTEXT('/**/'),
             15864    1           3 SPARAM7 BIT (18) UNAL %INIT('000000'O) %CHARTEXT('/**/'),
             15865    1           3 SPARAM8 BIT (18) UNAL %INIT('000000'O) %CHARTEXT('/**/'),
             15866    1           3 SPARAM9 BIT (18) UNAL %INIT('000000'O) %CHARTEXT('/**/'),
             15867    1           3 UPARAM (0:9) BIT (18) UNAL %INIT('000000'O,'000000'O,
             15868    1                      '000000'O,'000000'O,'000000'O,'000000'O,'000000'O,
             15869    1                      '000000'O,'000000'O,'000000'O) %CHARTEXT('/**/'),
             15870    1         2 SET_DEV_LIM_CMD REDEF SET_DEV_LIM CHAR (42) UNAL;
       56    15872        %FS$GRAPHIC_BANNER (NAME = FS$GBAN,
       57    15873                      STCLASS="BASED") ;
             15874        %LSET STR=CONCAT(TEXTCHAR(BASED),'        ');
             15875        %IF (SUBSTR(STR,0,6)='STATIC') OR
             15876         (SUBSTR(STR,0,8)='CONSTANT') OR
             15877         (SUBSTR(STR,0,3)='EXT');
             15879        %ELSE;
             15880        %LSET INIT=CHARTEXT('/*');
             15881        %ENDIF;
             15882    1   DCL 1 FS$GBAN BASED,
             15883    1         2 CHARGE UBIN BYTE UNAL %INIT(0) %CHARTEXT('/**/'),
             15883                  /* DO WE CHARGE FOR BANNER */
             15884    1         2 ALIGNCTL REDEF CHARGE UNAL,
             15885    1           3 EVERY BIT(1) UNAL,            /* DO WE ALIGN EVERY MOUNT            */
             15886    1           3 * BIT(8) UNAL,
             15887    1         2 REPEATS UBIN BYTE UNAL %INIT(0) %CHARTEXT('/**/'),
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:106  
             15887                  /* NUM OF TIMES TO PRINT THIS BANNER */
             15888    1         2 INTR UBIN BYTE UNAL %INIT(0) %CHARTEXT('/**/'),
             15888                  /* ARE INTRINSICS  ALLOWED */
             15889    1         2 NUM_ENTRIES UBIN BYTE UNAL %INIT(0) %CHARTEXT('/**/'),
             15889                  /* NUM OF ENTRIES IN THE TABLE */
             15890    1         2 ENTRIES(0:0),
             15891    1           3 CHARUP,
             15892    1             4 CHARUP_OPCODE,
             15893    1               5 CLASS UBIN (9) UNAL %INIT (%XG_COOP_SEGM_BASIC#) %CHARTEXT('/**/'),
             15894    1              5 INDX UBIN (9) UNAL %INIT (%XG_COOP_SET_CHARACTER_UP#) %CHARTEXT('/**/'
             15894                        ),
             15895    1             4 X UBIN (18) UNAL %INIT (65535) %CHARTEXT ('/**/'),
             15896    1             4 Y UBIN (18) UNAL %INIT (0) %CHARTEXT ('/**/'),
             15897    1             4 Z UBIN (18) UNAL %INIT (0) %CHARTEXT ('/**/'),
             15898    1           3 SET_CHARUP_CMD REDEF CHARUP CHAR (8) UNAL,
             15899    1           3 DIRECTION UBIN (9) UNAL %INIT (90) %CHARTEXT ('/**/'),
             15900    1           3 CHARSIZE,
             15901    1             4 CHARSIZE_OPCODE,
             15902    1              5 CLASS UBIN (9) UNAL %INIT (%XG_COOP_ATTR_BAS_NONE_2#) %CHARTEXT('/**/'
             15902                        ),
             15903    1               5 INDX UBIN (9) UNAL %INIT (%XG_COOP_SET_CHARSIZE#) %CHARTEXT('/**/'),
             15904    1             4 CHAR_WIDTH BIT (18) UNAL %INIT (1167) %CHARTEXT ('/**/'),
             15905    1             4 CHAR_HITE BIT (18) UNAL %INIT (1167) %CHARTEXT ('/**/'),
             15906    1           3 SET_CHARSIZE_CMD REDEF CHARSIZE CHAR (6) UNAL,
             15907    1           3 CHAR_WIDTH UBIN (18) UNAL %INIT (655) %CHARTEXT ('/**/'),
             15908    1           3 CHAR_HITE UBIN (18) UNAL %INIT (655) %CHARTEXT ('/**/'),
             15909    1           3 CHARSPACE,
             15910    1             4 CHARSPACE_OPCODE,
             15911    1              5 CLASS UBIN (9) UNAL %INIT (%XG_COOP_ATTR_BAS_NONE_2#) %CHARTEXT('/**/'
             15911                        ),
             15912    1               5 INDX UBIN (9) UNAL %INIT (%XG_COOP_SET_CHARSPACE#) %CHARTEXT('/**/'),
             15913    1             4 CHAR_SPACE BIT (18) UNAL %INIT (1167) %CHARTEXT ('/**/'),
             15914    1           3 SET_CHARSPACE_CMD REDEF CHARSPACE CHAR (4) UNAL,
             15915    1           3 CHAR_SPACE UBIN (18) UNAL %INIT (655) %CHARTEXT ('/**/'),
             15916    1           3 X_VAL UBIN (18) UNAL,
             15917    1           3 Y_VAL UBIN (18) UNAL,
             15918    1           3 Z_VAL UBIN (18) UNAL,
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:107  
             15919    1           3 NDC_X_VAL UBIN (18) UNAL,
             15920    1           3 NDC_Y_VAL UBIN (18) UNAL,
             15921    1           3 NDC_Z_VAL UBIN (18) UNAL,
             15922    1           3 TYPE UBIN BYTE UNAL,          /* TYPE OF ENTRY(INTRINSIC/PLAIN)     */
             15923    1           3 COUNT UBIN BYTE UNAL,         /* COUNT OF TEXT (IF ANY) OR          */
             15924    1           3 CHR REDEF COUNT CHAR (1),     /*CHAR FOR REPEAT ACCROSS PAGE        */
             15925    1           3 DISP UBIN HALF UNAL,          /* DISP IN WORDS TO TEXT (IF ANY)     */
             15926    1           3 TOTLEN UBIN (27) UNAL,        /* TOTLEN OF ENTRY (INTERNAL)         */
             15927    1           3 * UBIN (27) UNAL,
             15928    1           3 MARK UBIN BYTE UNAL;          /* MARK (INTERNAL)                    */
       58    15930        %FS$FORMREC(NAME=FS$FORMREC,
       59    15931                    STCLASS=BASED) ;
             15932        %LSET STR=CONCAT(TEXTCHAR(BASED),'        ');
             15933        %IF (SUBSTR(STR,0,6)='STATIC') OR
             15934         (SUBSTR(STR,0,8)='CONSTANT') OR
             15935         (SUBSTR(STR,0,3)='EXT');
             15937        %ELSE;
             15938        %LSET INIT=CHARTEXT('/*');
             15939        %ENDIF;
             15940        /*
             15941        */
             15942    1   DCL 1 FS$FORMREC BASED ALIGNED,
             15943    1         2 FNAME CHAR(6) %INIT('  ')%CHARTEXT('/**/'), /* FORM NAME           */
             15944    1         2 ACCTDISP UBIN HALF UNAL %INIT(0)%CHARTEXT('/**/'),
             15945    1         2 SETUPDISP UBIN HALF UNAL %INIT(0)%CHARTEXT('/**/'), /* WD DISP TO SETUP */
             15946    1         2 ACCSDISP UBIN HALF UNAL %INIT(0)%CHARTEXT('/**/'), /* DISP TO ACCESS */
             15947    1         2 BANRDISP UBIN HALF UNAL %INIT(0)%CHARTEXT('/**/'), /* DISP TO BANNER */
             15948    1         2 ALGNDISP UBIN HALF UNAL %INIT(0)%CHARTEXT('/**/'), /* DISP TO ALGNMENT */
             15949    1        2 FLAGS BIT(7) %INIT('0000000'B) %CHARTEXT('/**/'), /* SETABLE BUT NOT USED */
             15950    1         2 * BIT(1) %INIT('0'B)%CHARTEXT('/**/'), /* THIS BIT IS FREE            */
             15951    1         2 GRAPHIC BIT(1) %INIT('0'B)%CHARTEXT('/**/'), /* GRAPHIC FORM   */
             15952        /**/
             15953        /*  LEGAL TYPE OF DEVICES FOR THIS FORM */
             15954        /*   The LGLTYPS field here is duplicated in the FS$CHARSET record
             15955             and when this macro is changed, this one should be checked!
             15956        */
             15957        /**/
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:108  
             15958    1         2 LGLTYPS,
             15959    1           3 LPOK BIT(1) %INIT('0'B)%CHARTEXT('/**/'), /* LEGAL ON LP           */
             15960    1           3 TSOK BIT(1) %INIT('0'B)%CHARTEXT('/**/'), /* LEGAL ON TS           */
             15961    1           3 ELSOK BIT(1) %INIT('0'B)%CHARTEXT('/**/'), /* LEGAL ON ALL BUT TS+LP */
             15962    1           3 ONEOK BIT(1) %INIT('0'B)%CHARTEXT('/**/'), /* LEGAL ON TYP=LTYP   */
             15963    1           3 * BIT(5) %INIT('00000'B)%CHARTEXT('/**/'),
             15964    1           3 LTYP CHAR(2) %INIT(' ')%CHARTEXT('/**/'), /* LEGAL IF ONEOK=YES   */
             15965    1         2 ATTR BIT(18) UNAL %INIT('000006'O) %CHARTEXT('/**/'),
             15966    1         2 SOFTFORM,                       /*SOFT VFU/PLATEN INFO                */
             15967        /**/
             15968        /*  WRITE SOFTFORM WITH VFC_VFU AND BP ON IN DVBYTE */
             15969        /**/
             15970    1           3 VLPPLATEN,                    /* SEE KI_CP6_C FOR DESC              */
             15971    1             4 TL,
             15972    1               5 T UBIN BYTE UNAL %INIT(8)%CHARTEXT('/**/'),
             15973    1               5 L UBIN BYTE UNAL %INIT(16)%CHARTEXT('/**/'),
             15974    1             4 WIDTH UBIN BYTE UNAL %INIT(0)%CHARTEXT('/**/'),
             15975    1             4 LENGTH UBIN BYTE UNAL %INIT(0)%CHARTEXT('/**/'),
             15976    1             4 LIMBO UBIN BYTE UNAL %INIT(0)%CHARTEXT('/**/'),
             15977    1             4 FIRSTLINE UBIN BYTE UNAL %INIT(0)%CHARTEXT('/**/'),
             15978    1             4 * BIT(8) %INIT('00000000'B)%CHARTEXT('/**/'),
             15979    1             4 EXTWID BIT(1) %INIT('0'B)%CHARTEXT('/**/'),
             15980    1             4 LPI UBIN BYTE UNAL %INIT(6)%CHARTEXT('/**/'),
             15981    1             4 * (0:9) UBIN BYTE UNAL %INIT(0*0)%CHARTEXT('/**/'),
             15982    1           3 VFUIM,                        /* TED AND PAULS SOFT VFU IMAGE       */
             15983    1             4 TL,
             15984    1               5 T UBIN BYTE UNAL %INIT(18)%CHARTEXT('/**/'),
             15985    1               5 L UBIN BYTE UNAL %INIT(64)%CHARTEXT('/**/'),
             15986    1             4 V,
             15987    1               5 LINE(0:31) UBIN BYTE UNAL %INIT(0*0)%CHARTEXT('/**/'),
             15988    1               5 NEXT(0:31) UBIN BYTE UNAL %INIT(0*0)%CHARTEXT('/**/'),
             15989    1         2 CHAIN_NAME CHAR(8) UNAL %INIT('600')%CHARTEXT('/**/'),
             15990    1         2 CHAINS(0:5) CHAR(40) UNAL %INIT(
             15991                %C600;
             15992    1             'BDFGHJgS0ACEINORLTabcdefKhijklmM0PQUVWXY',
             15993    1             'Z:;?!%7xynoprstw0z123456#89.,()@$=&/''\^_',
             15994    1             '0"<>[]gS~ACEINOR{Tabcdef0hijklm}|`-*+quv',
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:109  
             15995    1             'BDFGHJ7x0noprstwLz123456K89.,()M0PQUVWXY',
             15996    1             'Z:;?!%gSyACEINOR0Tabcdef#hijklm@$=&/''\^_',
             15997    1             '0"<>[]7x~noprstw{z123456089.,()}|`-*+quv')
             15999    1           %CHARTEXT('/**/'),
             16000    1         2 CHAINIMAGE REDEF CHAINS CHAR(240) UNAL;
       60    16002        %FS$ACCT_INIT(NAME=FS$ACCOUNTS,
       61    16003                        STCLASS=BASED) ;
             16004        %LSET STR=CONCAT(TEXTCHAR(BASED),'        ');
             16005        %IF (SUBSTR(STR,0,5)='BASED') OR
             16006            (SUBSTR(STR,0,8)='       ');
             16007    1   DCL 1 FS$ACCOUNTS BASED,
             16008    1         2 TACCTS UBIN WORD UNAL,          /* NUM OF ACCTS                       */
             16009    1         2 LIST(0:0) CHAR(8);
             16010        %ELSE;
             16015        %ENDIF;
       62    16017        %FS$ACC_INIT(NAME=FS$ACCESS,
       63    16018                    STCLASS=BASED) ;
             16019        %LSET STR=CONCAT(TEXTCHAR(BASED),'        ');
             16020        %IF (SUBSTR(STR,0,5)='BASED') OR
             16021            (SUBSTR(STR,0,8)='       ');
             16022    1   DCL 1 FS$ACCESS BASED,
             16023    1         2 TNAMES UBIN WORD UNAL,          /* NUM OF NAMES                       */
             16024    1         2 LIST(0:0) CHAR(8);
             16025        %ELSE;
             16030        %ENDIF;
       64    16032        %FS$BAN_INIT(NAME=FS$FINST,
       65    16033                    STCLASS=BASED);
             16034        %LSET STR=CONCAT(TEXTCHAR(BASED),'        ');
             16035        %IF ( SUBSTR(STR,0,5)='BASED') OR
             16036         (SUBSTR(STR,0,8)='        ');
             16037    1   DCL 1 FS$FINST BASED,
             16038    1         2 CHARGE UBIN BYTE UNAL,          /* DO WE CHARGE FOR BANNER            */
             16039    1         2 ALIGNCTL REDEF CHARGE UNAL,
             16040    1           3 EVERY BIT(1) UNAL,
             16041    1           3 * BIT(8) UNAL,
             16042    1         2 REPEATS UBIN BYTE UNAL,         /* NUM OF TIMES TO PRINT THIS BANNER  */
             16043    1         2 INTR UBIN BYTE UNAL,            /* ARE INTRINSICS  ALLOWED            */
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:110  
             16044    1         2 NUM_ENTRIES UBIN BYTE UNAL,     /* NUM OF ENTRIES IN THE TABLE        */
             16045    1         2 ENTRIES(0:0),
             16046    1           3 ROW UBIN BYTE UNAL,           /* START ROW                          */
             16047    1           3 COL UBIN BYTE UNAL,           /* START COL                          */
             16048    1           3 FONT UBIN BYTE UNAL,          /* FONT TO BE USED                    */
             16049    1           3 STRIKES UBIN BYTE UNAL,       /* NUMBER OF PRINT STRIKES            */
             16050    1           3 ICSH UBIN BYTE UNAL,          /* INTER CHAR SPACING HORZ.           */
             16051    1           3 REPS UBIN BYTE UNAL,          /* NUM OF TIME TO PRINT THIS ENTRY    */
             16052    1           3 RINC UBIN BYTE UNAL,          /* ROW INCERMENT PER REPEAT           */
             16053    1           3 CINC UBIN BYTE UNAL,          /* COL INCERMENT PER REPEAT           */
             16054    1           3 TYPE UBIN BYTE UNAL,     /* TYPE OF ENTRY(PLAIN TEXT, INTRINIC)     */
             16055    1           3 DISP UBIN HALF UNAL,          /* DISP(IN WORDS) TO TEXT(IF ANY)     */
             16056    1           3 B REDEF DISP,
             16057    1             4 START UBIN BYTE UNAL,
             16058    1             4 LEN UBIN BYTE UNAL,
             16059    1           3 COUNT UBIN BYTE UNAL,         /* COUNT OF TEXT(IF ANY)              */
             16060    1           3 CHR REDEF COUNT CHAR(1),      /* OR CHAR TO BE REPEATED ACROSS PAGE */
             16061    1           3 TOTLEN UBIN(27) UNAL,         /* TOTLEN OF ENTRY(INTERNAL)          */
             16062    1           3 MARK UBIN BYTE UNAL;          /* MARK(INTERNAL)                     */
             16063        %ELSE;
             16088        %ENDIF;
       66    16090        %FS$SET_INIT(NAME=FS$SETUP,
       67    16091                  STCLASS=BASED);
             16092        %LSET STR=CONCAT(TEXTCHAR(BASED),'        ');
             16093        %IF (SUBSTR(STR,0,5)='BASED') OR
             16094            (SUBSTR(STR,0,8)='       ');
             16095    1   DCL 1 FS$SETUP BASED,
             16096    1         2 LINES UBIN BYTE UNAL,           /* NUM OF LINES                       */
             16097    1         2 * UBIN BYTE UNAL,
             16098    1         2 * UBIN HALF UNAL,
             16099    1         2 TXT(0:0) CHAR(72);
             16100        %ELSE;
             16107        %ENDIF;
       68    16109        %FS$CHARSET (NAME=CHARSET,
       69    16110                      STCLASS="BASED(CHARSET$)");
             16111        %LSET STR=CONCAT(TEXTCHAR(BASED(CHARSET$)),'        ');
             16112        %IF (SUBSTR(STR,0,6)='STATIC') OR
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:111  
             16113         (SUBSTR(STR,0,8)='CONSTANT') OR
             16114         (SUBSTR(STR,0,3)='EXT');
             16116        %ELSE;
             16117        %LSET INIT=CHARTEXT('/*');
             16118        %ENDIF;
             16119    1   DCL 1 CHARSET BASED(CHARSET$) ALIGNED,
             16120    1         2 SETS (0:9) CHAR (24) %INIT ('BDFGHJgS0ACEINORLTabcdef',
             16121    1                                    'KhijklmM0PQUVWXYZ:;?!%7x',
             16122    1                                    'ynoprstw0z123456#89.,()@',
             16123    1                                    '$=&/''\^_0"<>[]gS~ACEINOR',
             16124    1                                    '{Tabcdef0hijklm}|`-*+quv',
             16125    1                                    'BDFGHJ7x0noprstwLz123456',
             16126    1                                    'K89.,()M0PQUVWXYZ:;?!%gS',
             16127    1                                    'yACEINOR0Tabcdef#hijklm@',
             16128    1                                    '$=&/''\^_0"<>[]7x~noprstw',
             16129    1                                    '{z123456089.,()}|`-*+quv') %CHARTEXT ('/**/'),
             16130    1         2 CHAINIMAGE REDEF SETS CHAR (240) UNAL,
             16131    1         2 ATTRS BIT (18) %INIT ('000001'O) %CHARTEXT ('/**/'),
             16132    1         2 LGLTYPS,
             16133    1           3 LPOK BIT(1) %INIT('0'B)%CHARTEXT('/**/'),
             16134    1           3 TSOK BIT(1) %INIT('0'B)%CHARTEXT('/**/'),
             16135    1           3 ELSOK BIT(1) %INIT('0'B)%CHARTEXT('/**/'),
             16136    1           3 ONEOK BIT(1) %INIT('0'B)%CHARTEXT('/**/'),
             16137    1           3 * BIT(5) %INIT('00000'B)%CHARTEXT('/**/'),
             16138    1           3 LTYP CHAR(2) %INIT('  ')%CHARTEXT('/**/'),
             16139    1           3 * BIT(27) %INIT('000000000'O)%CHARTEXT('/**/');
       70    16141        %PLIST;
       71    16142        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:112  
       72    16143    1   DCL X$PARSE ENTRY(1) ALTRET;
       73    16144        %ASB$SET_PROMPT ;
       74    16147        %ASH$ERROR ;
       75    16150        %ASH$WARN ;
       76    16153        %ASH$HELP ;
       77    16156        %ASH$QUEST ;
       78    16159        %ASH$DQUEST ;
       79    16162        %ASF$READ_FORM ;
       80    16165        %ASF$WRITE_FORM ;
       81    16168        %ASB$READ_SI ;
       82    16171        %ASB$GETSEG ;
       83    16174        %ASF$QUERY_PSEUDO_FORMS ;
       84    16177        %ASR$R_PSEUDO_FORMS ;
       85    16180        %ASH$INFO ;
       86    16183        %ASF$PREC_FORM ;
       87    16186        %ASF$PREC_SKIP_FORM ;
       88    16189        %ASF$READ_FORM_SEQ ;
       89    16192    1   DCL ENUM UBIN WORD;
       90    16193    1   DCL I UBIN WORD;
       91    16194    1   DCL FC$ PTR;
       92    16195    1   DCL FCB$ PTR;
       93    16196    1   DCL FCA$ PTR;
       94    16197    1   DCL FF$ PTR;
       95    16198    1   DCL CHARSET$ PTR;
       96    16199    1   DCL DISP_TALLY UBIN HALF;
       97    16200    1   DCL MOVE_CNT UBIN WORD;
       98    16201    1   DCL TEMPLATE CHAR(MOVE_CNT) BASED;
       99    16202    1   DCL OLD_BANNER BIT(1) STATIC INIT('0'B);
      100    16203    1   DCL OLD_ALGN BIT(1) STATIC INIT('0'B);
      101    16204    1   DCL CREATE BIT(1);
      102    16205    1   DCL FROM BIT(1);
      103    16206    1   DCL PSEUDO_FLG BIT(1);
      104    16207    1   DCL ARS UBIN WORD;
      105    16208    1   DCL SUBS UBIN WORD;
      106    16209    1   DCL OLD_TOTAL_LINES UBIN;
      107    16210    1   DCL NEW_TOTAL_LINES UBIN;
      108    16211    1   DCL ELSOK BIT(1);
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:113  
      109    16212    1   DCL LPOK BIT(1);
      110    16213    1   DCL TSOK BIT(1);
      111    16214    1   DCL GRAPHIC BIT(1);
      112    16215    1   DCL 1 PSEUDO_FORM_REC ALIGNED,
      113    16216    1          2 LPOK BIT(1) UNAL,
      114    16217    1          2 TSOK BIT(1) UNAL,
      115    16218    1          2 ELSOK BIT(1) UNAL,
      116    16219    1          2 * BIT(33) UNAL;
      117    16220    1   DCL 1 FORM_KEY ALIGNED,
      118    16221    1          2 CNT UBIN BYTE UNAL,
      119    16222    1          2 TEXT CHAR(6) UNAL;
      120    16223    1   DCL 1 FORM_KEY_OLD ALIGNED,
      121    16224    1          2 CNT UBIN BYTE UNAL,
      122    16225    1          2 TEXT CHAR(6) UNAL;
      123    16226    1   DCL 1 PSEUDO_FORM_KEY,
      124    16227    1          2 CNT UBIN BYTE UNAL,
      125    16228    1          2 TXT CHAR(12) UNAL;
      126    16229    1   DCL 1 CHARSET_KEY,
      127    16230    1          2 CNT UBIN BYTE UNAL,
      128    16231    1          2 TXT CHAR(16) UNAL;
      129    16232    1   DCL PSEUDO_FORMS BIT(1);
      130    16233    1   DCL FORM_BUF(0:2047) UBIN WORD ;
      131    16234        %PARSE$OUT (NAME=P$NODE, STCLASS="BASED(NODE$)",
      132    16235                    NDTYPE=TYPE, NSUBLKS=SUBNODES);
      133    16280        %PARSE$SYM (NAME=OUT$SYM, STCLASS="BASED(BLK$)");
      134    16318    1   DCL FORM$ PTR;
      135    16319    1   DCL BLK$ PTR;
      136    16320    1   DCL F$ PTR;
      137    16321        /* These symrefs are the parse-nodes for X$PARSE */
      138    16322    1   DCL FORM_CMD UBIN(36) SYMREF;
      139    16323    1   DCL PSEUDO_CMD UBIN SYMREF;
      140    16324    1   DCL FORM_OPTS_LIST UBIN WORD SYMREF;
      141    16325    1   DCL PSEUDO_OPTS_LIST UBIN WORD SYMREF;
      142    16326    1   DCL GFORM_OPTS_LIST UBIN WORD SYMREF;
      143    16327    1   DCL GPSEUDO_OPTS_LIST UBIN WORD SYMREF;
      144    16328    1   DCL F_A_OR_B_LIST UBIN WORD SYMREF;
      145    16329    1   DCL F_VFU_LIST UBIN WORD SYMREF;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:114  
      146    16330    1   DCL FB_TYPE_LIST UBIN WORD SYMREF;
      147    16331    1   DCL F_SETUP_LIST UBIN WORD SYMREF;
      148    16332        /**/
      149    16333        /*
      150    16334        These are the offsets that will be used in
      151    16335        building the variable length record for :FORM
      152    16336        */
      153    16337    1   DCL ACCNT_OFFSET UBIN WORD CONSTANT INIT(0);
      154    16338    1   DCL ACCSS_OFFSET UBIN WORD CONSTANT INIT(1000);
      155    16339    1   DCL BNNR_OFFSET UBIN WORD CONSTANT INIT(2000);
      156    16340    1   DCL SETUP_OFFSET UBIN WORD CONSTANT INIT(0);
      157    16341    1   DCL ALGN_OFFSET UBIN WORD CONSTANT INIT(1500);
      158    16342    1   DCL TEXT_OFFSET UBIN WORD CONSTANT INIT(3000) ;
      159    16343        /*
      160    16344        Some pointers to use into the variable length record
      161    16345        */
      162    16346    1   DCL ACCNT$ PTR STATIC INIT(ADDR(NIL));
      163    16347    1   DCL ACCSS$ PTR STATIC INIT(ADDR(NIL));
      164    16348    1   DCL BNNR$ PTR STATIC INIT(ADDR(NIL));
      165    16349    1   DCL ALGN$ PTR STATIC INIT(ADDR(NIL));
      166    16350    1   DCL SETUP$ PTR STATIC INIT(ADDR(NIL));
      167    16351        /*
      168    16352        */
      169    16353        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:115  
      170    16354        /* Procedure */
      171    16355        /* This routine is called from ASA$SUPER to proccess the
      172    16356           commands 'CREATE FORM', 'MODIFY FORM', 'CREATE PSEUDO' and 'MODIFY PSEUDO'.
      173    16357              The following code gets date segments in order to
      174    16358              build the variable length record
      175    16359        */
      176    16360                                                              /* Get data segs */
      177    16361    1   PSEUDO_FLG = PSEUDO_FLAG;

  16361  4 000002   200003 470500                    LDP0    @PSEUDO_FLAG,,AUTO
         4 000003   000000 236100                    LDQ     0,,PR0
         4 000004   400000 376003                    ANQ     -131072,DU
         4 000005   200017 756100                    STQ     PSEUDO_FLG,,AUTO

      178    16362    1   IF NOT DSEG_FLG

  16362  4 000006   000000 234000 xsym               SZN     DSEG_FLG
         4 000007   000021 604000 4                  TMI     s:16382

      179    16363    1   THEN
      180    16364    2      CALL ASB$GETSEG WHENALTRETURN DO;

  16364  4 000010   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000011   000000 701000 xent               TSX1    ASB$GETSEG
         4 000012   000014 702000 4                  TSX2    s:16377
         4 000013   000021 710000 4                  TRA     s:16382

      181    16365              %SCREAM( ERR#=%E$GETSEGERR ,MID='F',LEVEL=ERROR);

  16377  4 000014   000000 630400 5                  EPPR0   0
         4 000015   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000016   000000 701000 xent               TSX1    ASH$ERROR
         4 000017   000000 011000                    NOP     0

      182    16380    2         RETURN ;

  16380  4 000020   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:116  

      183    16381    2         END ; /* Do whenaltreturn */
      184    16382    1   F$ = ADDR(FORM_BUF);

  16382  4 000021   200047 630500                    EPPR0   FORM_BUF,,AUTO
         4 000022   204051 450500                    STP0    F$,,AUTO

      185    16383    1   IF PSEUDO_FLG THEN

  16383  4 000023   200017 234100                    SZN     PSEUDO_FLG,,AUTO
         4 000024   000030 605000 4                  TPL     s:16386

      186    16384    1      P_PCB.ROOT$ = ADDR(PSEUDO_CMD);

  16384  4 000025   000001 236000 5                  LDQ     1
         4 000026   000001 756000 xsym               STQ     P_PCB+1
         4 000027   000032 710000 4                  TRA     s:16387

      187    16385    1   ELSE
      188    16386    1      P_PCB.ROOT$ = ADDR(FORM_CMD);

  16386  4 000030   000002 236000 5                  LDQ     2
         4 000031   000001 756000 xsym               STQ     P_PCB+1

      189    16387    1   CALL X$PARSE(P_PCB) ALTRET (FORM_ERR);

  16387  4 000032   000003 630400 5                  EPPR0   3
         4 000033   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000034   000000 701000 xent               TSX1    X$PARSE
         4 000035   001334 702000 4                  TSX2    FORM_ERR

      190    16388    1   NODE$ = P_PCB.OUT$;

  16388  4 000036   000003 236000 xsym               LDQ     P_PCB+3
         4 000037   000000 756000 xsym               STQ     NODE$

      191    16389    1   IF P$NODE.CODE = 902 /* CR_FORM */ THEN
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:117  

  16389  4 000040   000000 470400 xsym               LDP0    NODE$
         4 000041   000000 720100                    LXL0    0,,PR0
         4 000042   001606 100003                    CMPX0   902,DU
         4 000043   000050 601000 4                  TNZ     s:16392

      192    16390    1      CREATE = AS_TRUE;

  16390  4 000044   000000 236000 xsym               LDQ     AS_TRUE
         4 000045   400000 376003                    ANQ     -131072,DU
         4 000046   200015 756100                    STQ     CREATE,,AUTO
         4 000047   000053 710000 4                  TRA     s:16397

      193    16391    1   ELSE
      194    16392    1      CREATE = AS_FALSE;

  16392  4 000050   000000 236000 xsym               LDQ     AS_FALSE
         4 000051   400000 376003                    ANQ     -131072,DU
         4 000052   200015 756100                    STQ     CREATE,,AUTO

      195    16393        /* Go through the subnodes and look for the graphics node.  If
      196    16394           it exists - set the graphic flag.  The reason we have to search
      197    16395           the nodes is because the previous syntax was hard coded.
      198    16396        */
      199    16397    1   GRAPHIC = AS_FALSE;

  16397  4 000053   000000 236000 xsym               LDQ     AS_FALSE
         4 000054   400000 376003                    ANQ     -131072,DU
         4 000055   200027 756100                    STQ     GRAPHIC,,AUTO

      200    16398    2   DO I = 0 TO P$NODE.SUBNODES-1 ;

  16398  4 000056   200005 450100                    STZ     I,,AUTO
         4 000057   000074 710000 4                  TRA     s:16403+3

      201    16399    2      IF P$NODE.SUBLK$(I) -> P$NODE.CODE = 906 /* CR_MOD_GRAPHICS_FORM */

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:118  
  16399  4 000060   000000 470400 xsym               LDP0    NODE$
         4 000061   200005 720100                    LXL0    I,,AUTO
         4 000062   000003 471510                    LDP1    3,X0,PR0
         4 000063   100000 721100                    LXL1    0,,PR1
         4 000064   001612 101003                    CMPX1   906,DU
         4 000065   000071 601000 4                  TNZ     s:16403

      202    16400    3      THEN DO;

      203    16401    3         GRAPHIC = AS_TRUE;

  16401  4 000066   000000 236000 xsym               LDQ     AS_TRUE
         4 000067   400000 376003                    ANQ     -131072,DU
         4 000070   200027 756100                    STQ     GRAPHIC,,AUTO

      204    16402    3         END;

      205    16403    2      END;

  16403  4 000071   200005 235100                    LDA     I,,AUTO
         4 000072   000001 035007                    ADLA    1,DL
         4 000073   200005 755100                    STA     I,,AUTO
         4 000074   000001 236100                    LDQ     1,,PR0
         4 000075   000022 772000                    QRL     18
         4 000076   200005 116100                    CMPQ    I,,AUTO
         4 000077   000101 600000 4                  TZE     s:16406
         4 000100   000060 603000 4                  TRC     s:16399

      206    16404
      207    16405        /*       Get first form name and test legality and existance.       */
      208    16406    1   FORM_KEY.TEXT = AS_BLANK;

  16406  4 000101   040100 100400                    MLR     fill='040'O
         4 000102   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 000103   200031 200006                    ADSC9   FORM_KEY,,AUTO           cn=1,n=6

      209    16407    1   FORM_KEY_OLD.TEXT = AS_BLANK;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:119  

  16407  4 000104   040100 100400                    MLR     fill='040'O
         4 000105   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 000106   200033 200006                    ADSC9   FORM_KEY_OLD,,AUTO       cn=1,n=6

      210    16408    1   BLK$ = P$NODE.SUBLK$(0)-> P$NODE.SUBLK$(0);

  16408  4 000107   000003 471500                    LDP1    3,,PR0
         4 000110   100003 236100                    LDQ     3,,PR1
         4 000111   204050 756100                    STQ     BLK$,,AUTO

      211    16409    1   FORM_KEY.CNT=6;

  16409  4 000112   006000 236003                    LDQ     3072,DU
         4 000113   200031 552140                    STBQ    FORM_KEY,'40'O,AUTO

      212    16410    1   FORM_KEY_OLD.CNT=6;

  16410  4 000114   200033 552140                    STBQ    FORM_KEY_OLD,'40'O,AUTO

      213    16411    1   PSEUDO_FORMS = AS_FALSE;

  16411  4 000115   000000 236000 xsym               LDQ     AS_FALSE
         4 000116   400000 376003                    ANQ     -131072,DU
         4 000117   200046 756100                    STQ     PSEUDO_FORMS,,AUTO

      214    16412    1   IF OUT$SYM.COUNT > 6 THEN

  16412  4 000120   204050 471500                    LDP1    BLK$,,AUTO
         4 000121   100004 236100                    LDQ     4,,PR1
         4 000122   777000 376003                    ANQ     -512,DU
         4 000123   007000 116003                    CMPQ    3584,DU
         4 000124   000132 602000 4                  TNC     s:16435

      215    16413    2   DO;

      216    16414        /*E* ERROR: ASF-E$FNAMETOOBIG-0
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:120  
      217    16415             MESSAGE: FORM name too long.
      218    16416             MESSAGE1: FORM name can be at most 6 characters long.
      219    16417        */
      220    16418           %SCREAM( ERR#=E$FNAMETOOBIG,MID='F',LEVEL=ERROR);

  16430  4 000125   000004 630400 5                  EPPR0   4
         4 000126   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000127   000000 701000 xent               TSX1    ASH$ERROR
         4 000130   000000 011000                    NOP     0

      221    16433    2      RETURN;

  16433  4 000131   000000 702200 xent               TSX2  ! X66_ARET

      222    16434    2      END;
      223    16435    1   FORM_KEY.TEXT=OUT$SYM.TEXT;

  16435  4 000132   100004 236100                    LDQ     4,,PR1
         4 000133   000033 772000                    QRL     27
         4 000134   000000 620006                    EAX0    0,QL
         4 000135   040100 100540                    MLR     fill='040'O
         4 000136   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         4 000137   200031 200006                    ADSC9   FORM_KEY,,AUTO           cn=1,n=6

      224    16436    1   ARS = 2048 * 4;

  16436  4 000140   020000 235007                    LDA     8192,DL
         4 000141   200020 755100                    STA     ARS,,AUTO

      225    16437    1   CALL ASF$READ_FORM( FORM_KEY, F$, ARS)

  16437  4 000142   200020 633500                    EPPR3   ARS,,AUTO
         4 000143   204112 453500                    STP3    @MAX_VAL+3,,AUTO
         4 000144   204051 634500                    EPPR4   F$,,AUTO
         4 000145   204111 454500                    STP4    @MAX_VAL+2,,AUTO
         4 000146   200031 635500                    EPPR5   FORM_KEY,,AUTO
         4 000147   204110 455500                    STP5    @MAX_VAL+1,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:121  
         4 000150   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 000151   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000152   000000 701000 xent               TSX1    ASF$READ_FORM
         4 000153   000155 702000 4                  TSX2    s:16439
         4 000154   000172 710000 4                  TRA     s:16462

      226    16438    2   WHENALTRETURN DO;

      227    16439    2      IF CREATE THEN GOTO CM_FORM_OK;

  16439  4 000155   200015 234100                    SZN     CREATE,,AUTO
         4 000156   000420 604000 4                  TMI     CM_FORM_OK

      228    16440        /*E* ERROR: ASF-E$FSWITCH-0
      229    16441             MESSAGE: %%U1 %does not exist. Switching to CREATE mode.
      230    16442        */
      231    16443    2      AS_FIELD1 = FORM_KEY;

  16443  4 000157   000000 100500                    MLR     fill='000'O
         4 000160   200031 000007                    ADSC9   FORM_KEY,,AUTO           cn=0,n=7
         4 000161   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      232    16444           %SCREAM( ERR#= E$FSWITCH,MID='F',LEVEL=WARN );

  16454  4 000162   000005 630400 5                  EPPR0   5
         4 000163   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000164   000000 701000 xent               TSX1    ASH$WARN
         4 000165   000000 011000                    NOP     0

      233    16459    2      CREATE=AS_TRUE;

  16459  4 000166   000000 236000 xsym               LDQ     AS_TRUE
         4 000167   400000 376003                    ANQ     -131072,DU
         4 000170   200015 756100                    STQ     CREATE,,AUTO

      234    16460    2      GOTO CM_FORM_OK;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:122  
  16460  4 000171   000420 710000 4                  TRA     CM_FORM_OK

      235    16461    2      END;
      236    16462    1   IF ((NOT F$->FS$FORMREC.GRAPHIC) AND GRAPHIC)

  16462  4 000172   204051 470500                    LDP0    F$,,AUTO
         4 000173   000004 430100                    FSZN    4,,PR0
         4 000174   000204 604000 4                  TMI     s:16486
         4 000175   200027 234100                    SZN     GRAPHIC,,AUTO
         4 000176   000204 605000 4                  TPL     s:16486

      237    16463    2   THEN DO;

      238    16464        /*E*   ERROR: ASF-E$GRAPHONNONGRAPHFORM-C
      239    16465               MESSAGE: Graphics was specified, this is not a graphic form.
      240    16466               MESSAGE1: The specified form is not a graphic form, yet graphic
      241    16467                         was specified.  The two types are not interchangable.
      242    16468        */
      243    16469           %SCREAM (ERR#=E$GRAPHONNONGRAPHFORM,MID='F',LEVEL=ERROR);

  16481  4 000177   000006 630400 5                  EPPR0   6
         4 000200   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000201   000000 701000 xent               TSX1    ASH$ERROR
         4 000202   000000 011000                    NOP     0

      244    16484    2      RETURN;

  16484  4 000203   000000 702200 xent               TSX2  ! X66_ARET

      245    16485    2      END;
      246    16486    1   IF (F$->FS$FORMREC.GRAPHIC AND (NOT GRAPHIC))

  16486  4 000204   000004 430100                    FSZN    4,,PR0
         4 000205   000213 605000 4                  TPL     s:16491
         4 000206   200027 234100                    SZN     GRAPHIC,,AUTO
         4 000207   000213 604000 4                  TMI     s:16491

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:123  
      247    16487    2   THEN DO;

      248    16488    2      GRAPHIC = AS_TRUE;

  16488  4 000210   000000 236000 xsym               LDQ     AS_TRUE
         4 000211   400000 376003                    ANQ     -131072,DU
         4 000212   200027 756100                    STQ     GRAPHIC,,AUTO

      249    16489    2      END;

      250    16490
      251    16491    1   IF CREATE THEN

  16491  4 000213   200015 234100                    SZN     CREATE,,AUTO
         4 000214   000222 605000 4                  TPL     s:16513

      252    16492    2   DO;

      253    16493        /*E* ERROR: ASF-E$FEXISTS-C
      254    16494             MESSAGE: That FORM already exists.
      255    16495             MESSAGE1: You can't create a FORM that already exists */
      256    16496           %SCREAM( ERR#=E$FEXISTS,MID='F',LEVEL=ERROR);

  16508  4 000215   000007 630400 5                  EPPR0   7
         4 000216   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000217   000000 701000 xent               TSX1    ASH$ERROR
         4 000220   000000 011000                    NOP     0

      257    16511    2      RETURN;

  16511  4 000221   000000 702200 xent               TSX2  ! X66_ARET

      258    16512    2      END;
      259    16513    1   IF (PSEUDO_FLG  \  (FORM_KEY.TEXT ~= F$->FS$FORMREC.FNAME)) = '1'B

  16513  4 000222   400000 220003                    LDX0    -131072,DU
         4 000223   040100 106500                    CMPC    fill='040'O
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:124  
         4 000224   200031 200006                    ADSC9   FORM_KEY,,AUTO           cn=1,n=6
         4 000225   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6
         4 000226   000230 601000 4                  TNZ     s:16513+6
         4 000227   000000 220003                    LDX0    0,DU
         4 000230   200017 236100                    LDQ     PSEUDO_FLG,,AUTO
         4 000231   400000 376003                    ANQ     -131072,DU
         4 000232   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 000233   000000 636010                    EAQ     0,X0
         4 000234   204110 676100                    ERQ     @MAX_VAL+1,,AUTO
         4 000235   000266 600000 4                  TZE     s:16560

      260    16514    2   THEN DO;

      261    16515    2      AS_FIELD1.COUNT = OUT$SYM.COUNT;

  16515  4 000236   204050 471500                    LDP1    BLK$,,AUTO
         4 000237   100004 236100                    LDQ     4,,PR1
         4 000240   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      262    16516    2      AS_FIELD1.TEXT  = OUT$SYM.TEXT;

  16516  4 000241   100004 236100                    LDQ     4,,PR1
         4 000242   000033 772000                    QRL     27
         4 000243   000000 620006                    EAX0    0,QL
         4 000244   040000 100540                    MLR     fill='040'O
         4 000245   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         4 000246   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      263    16517    2      IF PSEUDO_FLG

  16517  4 000247   200017 234100                    SZN     PSEUDO_FLG,,AUTO
         4 000250   000256 605000 4                  TPL     s:16552

      264    16518    3      THEN DO;

      265    16519        /*E* ERROR:   ASF-E$NOT_FORM-C
      266    16520             MESSAGE: "%U1" is a form, not a pseudo form.
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:125  
      267    16521        */
      268    16522              %SCREAM( ERR#=E$NOT_FORM, MID='F', LEVEL=WARN );

  16532  4 000251   000010 630400 5                  EPPR0   8
         4 000252   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000253   000000 701000 xent               TSX1    ASH$WARN
         4 000254   000000 011000                    NOP     0

      269    16537    3         END;

  16537  4 000255   000262 710000 4                  TRA     s:16558

      270    16538    3      ELSE DO;

      271    16539        /*E* ERROR:   ASF-E$NOT_PSEUDO-C
      272    16540             MESSAGE: "%U1" is a pseudo form, not a form.
      273    16541        */
      274    16542              %SCREAM( ERR#=E$NOT_PSEUDO, MID='F', LEVEL=WARN );

  16552  4 000256   000011 630400 5                  EPPR0   9
         4 000257   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000260   000000 701000 xent               TSX1    ASH$WARN
         4 000261   000000 011000                    NOP     0

      275    16557    3         END;

      276    16558    2      PSEUDO_FLG = ~ PSEUDO_FLG;

  16558  4 000262   200017 236100                    LDQ     PSEUDO_FLG,,AUTO
         4 000263   400000 376003                    ANQ     -131072,DU
         4 000264   400000 676003                    ERQ     -131072,DU
         4 000265   200017 756100                    STQ     PSEUDO_FLG,,AUTO

      277    16559    2      END;

      278    16560    1   IF GRAPHIC

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:126  
  16560  4 000266   200027 234100                    SZN     GRAPHIC,,AUTO
         4 000267   000272 605000 4                  TPL     s:16565

      279    16561    2   THEN DO;

      280    16562    2      OLD_TOTAL_LINES = 0;

  16562  4 000270   200022 450100                    STZ     OLD_TOTAL_LINES,,AUTO

      281    16563    2      END;

  16563  4 000271   000312 710000 4                  TRA     s:16569

      282    16564    2   ELSE DO;

      283    16565    2      OLD_TOTAL_LINES = F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LENGTH

  16565  4 000272   204051 470500                    LDP0    F$,,AUTO
         4 000273   000006 236100                    LDQ     6,,PR0
         4 000274   000011 772000                    QRL     9
         4 000275   000777 376007                    ANQ     511,DL
         4 000276   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 000277   000006 236100                    LDQ     6,,PR0
         4 000300   000022 772000                    QRL     18
         4 000301   000777 376007                    ANQ     511,DL
         4 000302   204110 036100                    ADLQ    @MAX_VAL+1,,AUTO
         4 000303   204111 756100                    STQ     @MAX_VAL+2,,AUTO
         4 000304   000006 236100                    LDQ     6,,PR0
         4 000305   000777 376007                    ANQ     511,DL
         4 000306   204112 756100                    STQ     @MAX_VAL+3,,AUTO
         4 000307   204111 236100                    LDQ     @MAX_VAL+2,,AUTO
         4 000310   204112 036100                    ADLQ    @MAX_VAL+3,,AUTO
         4 000311   200022 756100                    STQ     OLD_TOTAL_LINES,,AUTO

      284    16566    2           + F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LIMBO
      285    16567    2           + F$->FS$FORMREC.SOFTFORM.VLPPLATEN.FIRSTLINE;
      286    16568    2      END;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:127  

      287    16569    2   IF PSEUDO_FLG THEN DO;

  16569  4 000312   200017 234100                    SZN     PSEUDO_FLG,,AUTO
         4 000313   000371 605000 4                  TPL     s:16601

      288    16570    2      PSEUDO_FORM_KEY.CNT = 12;

  16570  4 000314   014000 236003                    LDQ     6144,DU
         4 000315   200035 552140                    STBQ    PSEUDO_FORM_KEY,'40'O,AUTO

      289    16571    2      CALL CONCAT( PSEUDO_FORM_KEY.TXT, F$->FS$FORMREC.FNAME, FORM_KEY.TEXT );

  16571  4 000316   204051 470500                    LDP0    F$,,AUTO
         4 000317   040100 100500                    MLR     fill='040'O
         4 000320   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6
         4 000321   200035 200006                    ADSC9   PSEUDO_FORM_KEY,,AUTO    cn=1,n=6
         4 000322   040100 100500                    MLR     fill='040'O
         4 000323   200031 200006                    ADSC9   FORM_KEY,,AUTO           cn=1,n=6
         4 000324   200036 600006                    ADSC9   PSEUDO_FORM_KEY+1,,AUTO  cn=3,n=6

      290    16572    2      ARS = 4;

  16572  4 000325   000004 235007                    LDA     4,DL
         4 000326   200020 755100                    STA     ARS,,AUTO

      291    16573    2      CALL ASF$READ_FORM( PSEUDO_FORM_KEY, ADDR(PSEUDO_FORM_REC), ARS)

  16573  4 000327   200030 630500                    EPPR0   PSEUDO_FORM_REC,,AUTO
         4 000330   204110 450500                    STP0    @MAX_VAL+1,,AUTO
         4 000331   200020 631500                    EPPR1   ARS,,AUTO
         4 000332   204113 451500                    STP1    @MAX_VAL+4,,AUTO
         4 000333   204110 633500                    EPPR3   @MAX_VAL+1,,AUTO
         4 000334   204112 453500                    STP3    @MAX_VAL+3,,AUTO
         4 000335   200035 634500                    EPPR4   PSEUDO_FORM_KEY,,AUTO
         4 000336   204111 454500                    STP4    @MAX_VAL+2,,AUTO
         4 000337   204111 630500                    EPPR0   @MAX_VAL+2,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:128  
         4 000340   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000341   000000 701000 xent               TSX1    ASF$READ_FORM
         4 000342   000344 702000 4                  TSX2    s:16578
         4 000343   000355 710000 4                  TRA     s:16596

      292    16574    3      WHENALTRETURN DO;

      293    16575        /*E* ERROR: ASF-E$CANT_READ_FORM-C
      294    16576             MESSAGE: Unable to read form %U1 from :FORM file.
      295    16577        */
      296    16578    3         CALL ASH$ERROR( ERR_CODE );

  16578  4 000344   000012 630400 5                  EPPR0   10
         4 000345   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000346   000000 701000 xent               TSX1    ASH$ERROR
         4 000347   000000 011000                    NOP     0

      297    16579              %SCREAM( ERR#=E$CANT_READ_FORM, LEVEL=ERROR, MID='F' );

  16591  4 000350   000013 630400 5                  EPPR0   11
         4 000351   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000352   000000 701000 xent               TSX1    ASH$ERROR
         4 000353   000000 011000                    NOP     0

      298    16594    3         RETURN;

  16594  4 000354   000000 702200 xent               TSX2  ! X66_ARET

      299    16595    3         END;
      300    16596    2      LPOK = PSEUDO_FORM_REC.LPOK;

  16596  4 000355   200030 236100                    LDQ     PSEUDO_FORM_REC,,AUTO
         4 000356   400000 376003                    ANQ     -131072,DU
         4 000357   200025 756100                    STQ     LPOK,,AUTO

      301    16597    2      TSOK = PSEUDO_FORM_REC.TSOK;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:129  
  16597  4 000360   200030 236100                    LDQ     PSEUDO_FORM_REC,,AUTO
         4 000361   000001 736000                    QLS     1
         4 000362   400000 376003                    ANQ     -131072,DU
         4 000363   200026 756100                    STQ     TSOK,,AUTO

      302    16598    2      ELSOK = PSEUDO_FORM_REC.ELSOK;

  16598  4 000364   200030 236100                    LDQ     PSEUDO_FORM_REC,,AUTO
         4 000365   000002 736000                    QLS     2
         4 000366   400000 376003                    ANQ     -131072,DU
         4 000367   200024 756100                    STQ     ELSOK,,AUTO

      303    16599    2      END;

  16599  4 000370   000406 710000 4                  TRA     s:16605

      304    16600    2   ELSE DO;

      305    16601    2      LPOK  = F$->FS$FORMREC.LGLTYPS.LPOK;

  16601  4 000371   204051 470500                    LDP0    F$,,AUTO
         4 000372   000004 236100                    LDQ     4,,PR0
         4 000373   000011 736000                    QLS     9
         4 000374   400000 376003                    ANQ     -131072,DU
         4 000375   200025 756100                    STQ     LPOK,,AUTO

      306    16602    2      TSOK = F$ -> FS$FORMREC.LGLTYPS.TSOK;

  16602  4 000376   000004 236100                    LDQ     4,,PR0
         4 000377   000012 736000                    QLS     10
         4 000400   400000 376003                    ANQ     -131072,DU
         4 000401   200026 756100                    STQ     TSOK,,AUTO

      307    16603    2      ELSOK = F$->FS$FORMREC.LGLTYPS.ELSOK;

  16603  4 000402   000004 236100                    LDQ     4,,PR0
         4 000403   000013 736000                    QLS     11
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:130  
         4 000404   400000 376003                    ANQ     -131072,DU
         4 000405   200024 756100                    STQ     ELSOK,,AUTO

      308    16604    2      END;

      309    16605    1   CALL ASF$QUERY_PSEUDO_FORMS( FORM_KEY, PSEUDO_FORM_KEY, PSEUDO_FORMS );

  16605  4 000406   200046 630500                    EPPR0   PSEUDO_FORMS,,AUTO
         4 000407   204112 450500                    STP0    @MAX_VAL+3,,AUTO
         4 000410   200035 631500                    EPPR1   PSEUDO_FORM_KEY,,AUTO
         4 000411   204111 451500                    STP1    @MAX_VAL+2,,AUTO
         4 000412   200031 633500                    EPPR3   FORM_KEY,,AUTO
         4 000413   204110 453500                    STP3    @MAX_VAL+1,,AUTO
         4 000414   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 000415   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000416   000000 701000 xent               TSX1    ASF$QUERY_PSEUDO_FORMS
         4 000417   000000 011000                    NOP     0

      310    16606    1   CM_FORM_OK:
      311    16607    1   SUBS = P$NODE.SUBNODES;

  16607  4 000420   000000 470400 xsym  CM_FORM_OK   LDP0    NODE$
         4 000421   000001 236100                    LDQ     1,,PR0
         4 000422   000022 772000                    QRL     18
         4 000423   200021 756100                    STQ     SUBS,,AUTO

      312    16608    1   FROM = AS_FALSE;

  16608  4 000424   000000 236000 xsym               LDQ     AS_FALSE
         4 000425   400000 376003                    ANQ     -131072,DU
         4 000426   200016 756100                    STQ     FROM,,AUTO

      313    16609    1   IF P$NODE.SUBLK$(1)->P$NODE.CODE = 905 /* FORM_NAME_2 */ THEN

  16609  4 000427   000004 471500                    LDP1    4,,PR0
         4 000430   100000 720100                    LXL0    0,,PR1
         4 000431   001611 100003                    CMPX0   905,DU
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:131  
         4 000432   000461 601000 4                  TNZ     s:16639

      314    16610    2   DO;

      315    16611    2      BLK$ = P$NODE.SUBLK$(1)->P$NODE.SUBLK$(0);

  16611  4 000433   100003 236100                    LDQ     3,,PR1
         4 000434   204050 756100                    STQ     BLK$,,AUTO

      316    16612    2      FROM = AS_TRUE;

  16612  4 000435   000000 236000 xsym               LDQ     AS_TRUE
         4 000436   400000 376003                    ANQ     -131072,DU
         4 000437   200016 756100                    STQ     FROM,,AUTO

      317    16613    2      IF OUT$SYM.COUNT > 6 THEN

  16613  4 000440   204050 473500                    LDP3    BLK$,,AUTO
         4 000441   300004 236100                    LDQ     4,,PR3
         4 000442   777000 376003                    ANQ     -512,DU
         4 000443   007000 116003                    CMPQ    3584,DU
         4 000444   000452 602000 4                  TNC     s:16636

      318    16614    3      DO;

      319    16615        /*   ERROR: ASF-E$FNAMETOOBIG-0
      320    16616             DESCRIPTION: Form name too long.
      321    16617             DESCRIPTION: Form name can be at most 6 characters long.
      322    16618        */
      323    16619              %SCREAM( ERR#=E$FNAMETOOBIG,MID='F',LEVEL=ERROR);

  16631  4 000445   000004 630400 5                  EPPR0   4
         4 000446   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000447   000000 701000 xent               TSX1    ASH$ERROR
         4 000450   000000 011000                    NOP     0

      324    16634    3         RETURN;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:132  

  16634  4 000451   000000 702200 xent               TSX2  ! X66_ARET

      325    16635    3         END;
      326    16636    2      FORM_KEY_OLD.TEXT=OUT$SYM.TEXT;

  16636  4 000452   300004 236100                    LDQ     4,,PR3
         4 000453   000033 772000                    QRL     27
         4 000454   000000 621006                    EAX1    0,QL
         4 000455   040100 100540                    MLR     fill='040'O
         4 000456   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         4 000457   200033 200006                    ADSC9   FORM_KEY_OLD,,AUTO       cn=1,n=6

      327    16637    2      END;

  16637  4 000460   000500 710000 4                  TRA     s:16650

      328    16638    2   ELSE DO;

      329    16639    2      IF CREATE THEN

  16639  4 000461   200015 234100                    SZN     CREATE,,AUTO
         4 000462   000475 605000 4                  TPL     s:16648

      330    16640    2         IF GRAPHIC

  16640  4 000463   200027 234100                    SZN     GRAPHIC,,AUTO
         4 000464   000471 605000 4                  TPL     s:16645

      331    16641    3         THEN DO;

      332    16642    3            FORM_KEY_OLD.TEXT='STDGR ';

  16642  4 000465   040100 100400                    MLR     fill='040'O
         4 000466   000016 000006 3                  ADSC9   TEXT_OFFSET+9            cn=0,n=6
         4 000467   200033 200006                    ADSC9   FORM_KEY_OLD,,AUTO       cn=1,n=6

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:133  
      333    16643    3            END;

  16643  4 000470   000500 710000 4                  TRA     s:16650

      334    16644    3         ELSE DO;

      335    16645    3            FORM_KEY_OLD.TEXT='STDLP ';

  16645  4 000471   040100 100400                    MLR     fill='040'O
         4 000472   000020 000006 3                  ADSC9   TEXT_OFFSET+11           cn=0,n=6
         4 000473   200033 200006                    ADSC9   FORM_KEY_OLD,,AUTO       cn=1,n=6

      336    16646    3            END;

  16646  4 000474   000500 710000 4                  TRA     s:16650

      337    16647    2      ELSE
      338    16648    2         FORM_KEY_OLD.TEXT=FORM_KEY.TEXT;

  16648  4 000475   040100 100500                    MLR     fill='040'O
         4 000476   200031 200006                    ADSC9   FORM_KEY,,AUTO           cn=1,n=6
         4 000477   200033 200006                    ADSC9   FORM_KEY_OLD,,AUTO       cn=1,n=6

      339    16649    2      END;

      340    16650    1   ARS = 2048 * 4;

  16650  4 000500   020000 235007                    LDA     8192,DL
         4 000501   200020 755100                    STA     ARS,,AUTO

      341    16651    1   CALL ASF$READ_FORM( FORM_KEY_OLD,F$,ARS)

  16651  4 000502   200020 631500                    EPPR1   ARS,,AUTO
         4 000503   204112 451500                    STP1    @MAX_VAL+3,,AUTO
         4 000504   204051 633500                    EPPR3   F$,,AUTO
         4 000505   204111 453500                    STP3    @MAX_VAL+2,,AUTO
         4 000506   200033 634500                    EPPR4   FORM_KEY_OLD,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:134  
         4 000507   204110 454500                    STP4    @MAX_VAL+1,,AUTO
         4 000510   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 000511   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000512   000000 701000 xent               TSX1    ASF$READ_FORM
         4 000513   000515 702000 4                  TSX2    s:16657
         4 000514   000525 710000 4                  TRA     s:16676

      342    16652    2   WHENALTRETURN DO;

      343    16653        /*E* ERROR: ASF-E$FNOEXIST-0
      344    16654             MESSAGE: %%U1 %does not exist.
      345    16655             MESSAGE1: The specified FORM does not exist.
      346    16656        */
      347    16657    2      AS_FIELD1 = FORM_KEY_OLD;

  16657  4 000515   000000 100500                    MLR     fill='000'O
         4 000516   200033 000007                    ADSC9   FORM_KEY_OLD,,AUTO       cn=0,n=7
         4 000517   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      348    16658           %SCREAM( ERR#= E$FNOEXIST,MID='F',LEVEL=ERROR);

  16670  4 000520   000014 630400 5                  EPPR0   12
         4 000521   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000522   000000 701000 xent               TSX1    ASH$ERROR
         4 000523   000000 011000                    NOP     0

      349    16673    2      RETURN;

  16673  4 000524   000000 702200 xent               TSX2  ! X66_ARET

      350    16674    2      END;
      351    16675
      352    16676    1   IF GRAPHIC ~=  F$->FS$FORMREC.GRAPHIC

  16676  4 000525   204051 470500                    LDP0    F$,,AUTO
         4 000526   000100 066500                    CMPB    filb='0'B
         4 000527   200027 000001                    BDSC    GRAPHIC,,AUTO            by=0,bit=0,n=1
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:135  
         4 000530   000004 100001                    BDSC    4,,PR0                   by=0,bit=8,n=1
         4 000531   000537 600000 4                  TZE     s:16700

      353    16677    2   THEN DO;

      354    16678        /*E*  ERROR: ASF-E$NOMIXGR_ANDREGULARFORMS-C
      355    16679              MESSAGE: Both form types must be the same.
      356    16680              MESSAGE1: One form is regular the other is graphic, this mix is not allowed.
      357    16681        */
      358    16682           %SCREAM (ERR#=E$NOMIXGR_ANDREGULARFORMS,MID='F',LEVEL=ERROR);

  16694  4 000532   000015 630400 5                  EPPR0   13
         4 000533   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000534   000000 701000 xent               TSX1    ASH$ERROR
         4 000535   000000 011000                    NOP     0

      359    16697    2      RETURN;

  16697  4 000536   000000 702200 xent               TSX2  ! X66_ARET

      360    16698    2      END;
      361    16699
      362    16700    1   IF F$->FS$FORMREC.GRAPHIC

  16700  4 000537   000004 430100                    FSZN    4,,PR0
         4 000540   000544 605000 4                  TPL     s:16705

      363    16701    2   THEN DO;

      364    16702    2      GRAPHIC = AS_TRUE;

  16702  4 000541   000000 236000 xsym               LDQ     AS_TRUE
         4 000542   400000 376003                    ANQ     -131072,DU
         4 000543   200027 756100                    STQ     GRAPHIC,,AUTO

      365    16703    2      END;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:136  
      366    16704
      367    16705    1   IF FROM  AND  FORM_KEY_OLD.TEXT ~= F$ -> FS$FORMREC.FNAME

  16705  4 000544   200016 234100                    SZN     FROM,,AUTO
         4 000545   000570 605000 4                  TPL     s:16726
         4 000546   040100 106500                    CMPC    fill='040'O
         4 000547   200033 200006                    ADSC9   FORM_KEY_OLD,,AUTO       cn=1,n=6
         4 000550   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6
         4 000551   000570 600000 4                  TZE     s:16726

      368    16706    2   THEN DO;

      369    16707    2      AS_FIELD1.COUNT = OUT$SYM.COUNT;

  16707  4 000552   204050 471500                    LDP1    BLK$,,AUTO
         4 000553   100004 236100                    LDQ     4,,PR1
         4 000554   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      370    16708    2      AS_FIELD1.TEXT  = OUT$SYM.TEXT;

  16708  4 000555   100004 236100                    LDQ     4,,PR1
         4 000556   000033 772000                    QRL     27
         4 000557   000000 620006                    EAX0    0,QL
         4 000560   040000 100540                    MLR     fill='040'O
         4 000561   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         4 000562   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      371    16709           %SCREAM( ERR#=E$NOT_PSEUDO, LEVEL=ERROR, MID='F' );

  16721  4 000563   000011 630400 5                  EPPR0   9
         4 000564   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000565   000000 701000 xent               TSX1    ASH$ERROR
         4 000566   000000 011000                    NOP     0

      372    16724    2      RETURN;

  16724  4 000567   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:137  

      373    16725    2      END;
      374    16726    1   IF PSEUDO_FLG THEN

  16726  4 000570   200017 234100                    SZN     PSEUDO_FLG,,AUTO
         4 000571   000653 605000 4                  TPL     s:16746

      375    16727    2      IF CREATE THEN DO;

  16727  4 000572   200015 234100                    SZN     CREATE,,AUTO
         4 000573   000650 605000 4                  TPL     s:16745

      376    16728    2         IF GRAPHIC

  16728  4 000574   200027 234100                    SZN     GRAPHIC,,AUTO
         4 000575   000614 605000 4                  TPL     s:16736

      377    16729    3         THEN DO;

      378    16730    3            LPOK = F$->FS$GFORMREC.LGLTYPS.LPOK;

  16730  4 000576   000004 236100                    LDQ     4,,PR0
         4 000577   000011 736000                    QLS     9
         4 000600   400000 376003                    ANQ     -131072,DU
         4 000601   200025 756100                    STQ     LPOK,,AUTO

      379    16731    3            TSOK = F$->FS$GFORMREC.LGLTYPS.TSOK;

  16731  4 000602   000004 236100                    LDQ     4,,PR0
         4 000603   000012 736000                    QLS     10
         4 000604   400000 376003                    ANQ     -131072,DU
         4 000605   200026 756100                    STQ     TSOK,,AUTO

      380    16732    3            ELSOK = F$->FS$GFORMREC.LGLTYPS.ELSOK;

  16732  4 000606   000004 236100                    LDQ     4,,PR0
         4 000607   000013 736000                    QLS     11
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:138  
         4 000610   400000 376003                    ANQ     -131072,DU
         4 000611   200024 756100                    STQ     ELSOK,,AUTO

      381    16733    3            OLD_TOTAL_LINES = 0;

  16733  4 000612   200022 450100                    STZ     OLD_TOTAL_LINES,,AUTO

      382    16734    3            END;

  16734  4 000613   000653 710000 4                  TRA     s:16746

      383    16735    3         ELSE DO;

      384    16736    3            LPOK = F$->FS$FORMREC.LGLTYPS.LPOK;

  16736  4 000614   000004 236100                    LDQ     4,,PR0
         4 000615   000011 736000                    QLS     9
         4 000616   400000 376003                    ANQ     -131072,DU
         4 000617   200025 756100                    STQ     LPOK,,AUTO

      385    16737    3            TSOK = F$ -> FS$FORMREC.LGLTYPS.TSOK;

  16737  4 000620   000004 236100                    LDQ     4,,PR0
         4 000621   000012 736000                    QLS     10
         4 000622   400000 376003                    ANQ     -131072,DU
         4 000623   200026 756100                    STQ     TSOK,,AUTO

      386    16738    3            ELSOK = F$->FS$FORMREC.LGLTYPS.ELSOK;

  16738  4 000624   000004 236100                    LDQ     4,,PR0
         4 000625   000013 736000                    QLS     11
         4 000626   400000 376003                    ANQ     -131072,DU
         4 000627   200024 756100                    STQ     ELSOK,,AUTO

      387    16739    3            OLD_TOTAL_LINES = F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LENGTH

  16739  4 000630   000006 236100                    LDQ     6,,PR0
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:139  
         4 000631   000011 772000                    QRL     9
         4 000632   000777 376007                    ANQ     511,DL
         4 000633   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 000634   000006 236100                    LDQ     6,,PR0
         4 000635   000022 772000                    QRL     18
         4 000636   000777 376007                    ANQ     511,DL
         4 000637   204110 036100                    ADLQ    @MAX_VAL+1,,AUTO
         4 000640   204111 756100                    STQ     @MAX_VAL+2,,AUTO
         4 000641   000006 236100                    LDQ     6,,PR0
         4 000642   000777 376007                    ANQ     511,DL
         4 000643   204112 756100                    STQ     @MAX_VAL+3,,AUTO
         4 000644   204111 236100                    LDQ     @MAX_VAL+2,,AUTO
         4 000645   204112 036100                    ADLQ    @MAX_VAL+3,,AUTO
         4 000646   200022 756100                    STQ     OLD_TOTAL_LINES,,AUTO

      388    16740    3                 + F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LIMBO
      389    16741    3                 + F$->FS$FORMREC.SOFTFORM.VLPPLATEN.FIRSTLINE;
      390    16742    3            END;

      391    16743    2         END;

  16743  4 000647   000653 710000 4                  TRA     s:16746

      392    16744    1      ELSE
      393    16745    1         FORM_KEY_OLD.TEXT = F$ -> FS$FORMREC.FNAME;

  16745  4 000650   040100 100500                    MLR     fill='040'O
         4 000651   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6
         4 000652   200033 200006                    ADSC9   FORM_KEY_OLD,,AUTO       cn=1,n=6

      394    16746    1   IF F$->FS$FORMREC.ACCTDISP ~= 0 THEN

  16746  4 000653   000001 720100                    LXL0    1,,PR0
         4 000654   000675 600000 4                  TZE     s:16753

      395    16747    2   DO;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:140  
      396    16748    2      ACCNT$ = PINCRW(DSEG1$,ACCNT_OFFSET);

  16748  4 000655   000000 236000 3                  LDQ     ACCNT_OFFSET
         4 000656   000022 736000                    QLS     18
         4 000657   000000 036000 xsym               ADLQ    DSEG1$
         4 000660   000002 756000 2                  STQ     ACCNT$

      397    16749    2      MOVE_CNT = 1000 * 4;

  16749  4 000661   007640 235007                    LDA     4000,DL
         4 000662   200014 755100                    STA     MOVE_CNT,,AUTO

      398    16750    2      FF$ = PINCRW(F$,F$->FS$FORMREC.ACCTDISP);

  16750  4 000663   000000 636010                    EAQ     0,X0
         4 000664   204051 036100                    ADLQ    F$,,AUTO
         4 000665   200011 756100                    STQ     FF$,,AUTO

      399    16751    2      ACCNT$->TEMPLATE = FF$->TEMPLATE;

  16751  4 000666   200011 471500                    LDP1    FF$,,AUTO
         4 000667   000000 621005                    EAX1    0,AL
         4 000670   000002 473400 2                  LDP3    ACCNT$
         4 000671   200014 722100                    LXL2    MOVE_CNT,,AUTO
         4 000672   040140 100540                    MLR     fill='040'O
         4 000673   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
         4 000674   300000 000012                    ADSC9   0,,PR3                   cn=0,n=*X2

      400    16752    2      END;      /* Account  */

      401    16753    1   IF F$->FS$FORMREC.SETUPDISP ~= 0 AND NOT PSEUDO_FLG THEN

  16753  4 000675   204051 470500                    LDP0    F$,,AUTO
         4 000676   000002 220100                    LDX0    2,,PR0
         4 000677   000722 600000 4                  TZE     s:16760
         4 000700   200017 234100                    SZN     PSEUDO_FLG,,AUTO
         4 000701   000722 604000 4                  TMI     s:16760
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:141  

      402    16754    2   DO;

      403    16755    2      SETUP$ = PINCRW(DSEG2$,SETUP_OFFSET);

  16755  4 000702   000003 236000 3                  LDQ     SETUP_OFFSET
         4 000703   000022 736000                    QLS     18
         4 000704   000000 036000 xsym               ADLQ    DSEG2$
         4 000705   000006 756000 2                  STQ     SETUP$

      404    16756    2      MOVE_CNT = 1500 * 4;

  16756  4 000706   013560 235007                    LDA     6000,DL
         4 000707   200014 755100                    STA     MOVE_CNT,,AUTO

      405    16757    2      FF$ = PINCRW(F$,F$->FS$FORMREC.SETUPDISP);

  16757  4 000710   000000 636010                    EAQ     0,X0
         4 000711   204051 036100                    ADLQ    F$,,AUTO
         4 000712   200011 756100                    STQ     FF$,,AUTO

      406    16758    2      SETUP$->TEMPLATE = FF$->TEMPLATE;

  16758  4 000713   200011 471500                    LDP1    FF$,,AUTO
         4 000714   000000 621005                    EAX1    0,AL
         4 000715   000006 473400 2                  LDP3    SETUP$
         4 000716   200014 722100                    LXL2    MOVE_CNT,,AUTO
         4 000717   040140 100540                    MLR     fill='040'O
         4 000720   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
         4 000721   300000 000012                    ADSC9   0,,PR3                   cn=0,n=*X2

      407    16759    2      END;       /* Setup   */

      408    16760    1   IF F$->FS$FORMREC.BANRDISP ~= 0 THEN

  16760  4 000722   204051 470500                    LDP0    F$,,AUTO
         4 000723   000003 220100                    LDX0    3,,PR0
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:142  
         4 000724   000747 600000 4                  TZE     s:16768

      409    16761    2   DO;

      410    16762    2      BNNR$ = PINCRW(DSEG1$,BNNR_OFFSET);

  16762  4 000725   000002 236000 3                  LDQ     BNNR_OFFSET
         4 000726   000022 736000                    QLS     18
         4 000727   000000 036000 xsym               ADLQ    DSEG1$
         4 000730   000004 756000 2                  STQ     BNNR$

      411    16763    2      MOVE_CNT = 1000 * 4;

  16763  4 000731   007640 235007                    LDA     4000,DL
         4 000732   200014 755100                    STA     MOVE_CNT,,AUTO

      412    16764    2      FF$ = PINCRW(F$,F$->FS$FORMREC.BANRDISP);

  16764  4 000733   000000 636010                    EAQ     0,X0
         4 000734   204051 036100                    ADLQ    F$,,AUTO
         4 000735   200011 756100                    STQ     FF$,,AUTO

      413    16765    2      BNNR$->TEMPLATE = FF$->TEMPLATE;

  16765  4 000736   200011 471500                    LDP1    FF$,,AUTO
         4 000737   000000 621005                    EAX1    0,AL
         4 000740   000004 473400 2                  LDP3    BNNR$
         4 000741   200014 722100                    LXL2    MOVE_CNT,,AUTO
         4 000742   040140 100540                    MLR     fill='040'O
         4 000743   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
         4 000744   300000 000012                    ADSC9   0,,PR3                   cn=0,n=*X2

      414    16766    2      OLD_BANNER='1'B;

  16766  4 000745   400000 236003                    LDQ     -131072,DU
         4 000746   000000 756000 2                  STQ     OLD_BANNER

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:143  
      415    16767    2      END;      /* Banner  */

      416    16768    1   IF F$->FS$FORMREC.ALGNDISP ~= 0 AND NOT PSEUDO_FLG THEN

  16768  4 000747   204051 470500                    LDP0    F$,,AUTO
         4 000750   000003 720100                    LXL0    3,,PR0
         4 000751   000776 600000 4                  TZE     s:16776
         4 000752   200017 234100                    SZN     PSEUDO_FLG,,AUTO
         4 000753   000776 604000 4                  TMI     s:16776

      417    16769    2   DO;

      418    16770    2      ALGN$ = PINCRW(DSEG2$,ALGN_OFFSET);

  16770  4 000754   000004 236000 3                  LDQ     ALGN_OFFSET
         4 000755   000022 736000                    QLS     18
         4 000756   000000 036000 xsym               ADLQ    DSEG2$
         4 000757   000005 756000 2                  STQ     ALGN$

      419    16771    2      MOVE_CNT = 1500 * 4;

  16771  4 000760   013560 235007                    LDA     6000,DL
         4 000761   200014 755100                    STA     MOVE_CNT,,AUTO

      420    16772    2      FF$ = PINCRW(F$,F$->FS$FORMREC.ALGNDISP);

  16772  4 000762   000000 636010                    EAQ     0,X0
         4 000763   204051 036100                    ADLQ    F$,,AUTO
         4 000764   200011 756100                    STQ     FF$,,AUTO

      421    16773    2      ALGN$->TEMPLATE = FF$ -> TEMPLATE;

  16773  4 000765   200011 471500                    LDP1    FF$,,AUTO
         4 000766   000000 621005                    EAX1    0,AL
         4 000767   000005 473400 2                  LDP3    ALGN$
         4 000770   200014 722100                    LXL2    MOVE_CNT,,AUTO
         4 000771   040140 100540                    MLR     fill='040'O
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:144  
         4 000772   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
         4 000773   300000 000012                    ADSC9   0,,PR3                   cn=0,n=*X2

      422    16774    2      OLD_ALGN = '1'B;

  16774  4 000774   400000 236003                    LDQ     -131072,DU
         4 000775   000001 756000 2                  STQ     OLD_ALGN

      423    16775    2      END;

      424    16776    1   IF F$->FS$FORMREC.ACCSDISP ~= 0 THEN

  16776  4 000776   204051 470500                    LDP0    F$,,AUTO
         4 000777   000002 720100                    LXL0    2,,PR0
         4 001000   001021 600000 4                  TZE     s:16783

      425    16777    2   DO;

      426    16778    2      ACCSS$ = PINCRW(DSEG1$,ACCSS_OFFSET);

  16778  4 001001   000001 236000 3                  LDQ     ACCSS_OFFSET
         4 001002   000022 736000                    QLS     18
         4 001003   000000 036000 xsym               ADLQ    DSEG1$
         4 001004   000003 756000 2                  STQ     ACCSS$

      427    16779    2      MOVE_CNT = 1000 * 4;

  16779  4 001005   007640 235007                    LDA     4000,DL
         4 001006   200014 755100                    STA     MOVE_CNT,,AUTO

      428    16780    2      FF$ = PINCRW(F$,F$->FS$FORMREC.ACCSDISP);

  16780  4 001007   000000 636010                    EAQ     0,X0
         4 001010   204051 036100                    ADLQ    F$,,AUTO
         4 001011   200011 756100                    STQ     FF$,,AUTO

      429    16781    2      ACCSS$->TEMPLATE = FF$->TEMPLATE;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:145  

  16781  4 001012   200011 471500                    LDP1    FF$,,AUTO
         4 001013   000000 621005                    EAX1    0,AL
         4 001014   000003 473400 2                  LDP3    ACCSS$
         4 001015   200014 722100                    LXL2    MOVE_CNT,,AUTO
         4 001016   040140 100540                    MLR     fill='040'O
         4 001017   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
         4 001020   300000 000012                    ADSC9   0,,PR3                   cn=0,n=*X2

      430    16782    2      END;     /* Access  */

      431    16783    1   CHARSET$ = DSEG3$;

  16783  4 001021   000000 236000 xsym               LDQ     DSEG3$
         4 001022   200012 756100                    STQ     CHARSET$,,AUTO

      432    16784
      433    16785    1   REMEMBER GET_OPTS IN REMEM_VAR;

  16785  4 001023   001026 635000 4                  EAA     GET_OPTS
         4 001024   000000 452400 xsym               STP2    REMEM_VAR
         4 001025   000001 755000 xsym               STA     REMEM_VAR+1

      434    16786    1   GET_OPTS:
      435    16787    1   IF GRAPHIC

  16787  4 001026   200027 234100       GET_OPTS     SZN     GRAPHIC,,AUTO
         4 001027   001034 605000 4                  TPL     s:16793

      436    16788    2   THEN DO;

      437    16789    2      CALL GFORM_OPTS;

  16789  4 001030   005630 701000 4                  TSX1    GFORM_OPTS
         4 001031   000000 011000                    NOP     0

      438    16790    2      NEW_TOTAL_LINES = 0;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:146  

  16790  4 001032   200023 450100                    STZ     NEW_TOTAL_LINES,,AUTO

      439    16791    2      END;

  16791  4 001033   001056 710000 4                  TRA     s:16798

      440    16792    2   ELSE DO;

      441    16793    2      CALL FORM_OPTS; /* Get all options and update FS$FORMREC */

  16793  4 001034   001341 701000 4                  TSX1    FORM_OPTS
         4 001035   000000 011000                    NOP     0

      442    16794    2      NEW_TOTAL_LINES = F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LENGTH

  16794  4 001036   204051 470500                    LDP0    F$,,AUTO
         4 001037   000006 236100                    LDQ     6,,PR0
         4 001040   000011 772000                    QRL     9
         4 001041   000777 376007                    ANQ     511,DL
         4 001042   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 001043   000006 236100                    LDQ     6,,PR0
         4 001044   000022 772000                    QRL     18
         4 001045   000777 376007                    ANQ     511,DL
         4 001046   204110 036100                    ADLQ    @MAX_VAL+1,,AUTO
         4 001047   204111 756100                    STQ     @MAX_VAL+2,,AUTO
         4 001050   000006 236100                    LDQ     6,,PR0
         4 001051   000777 376007                    ANQ     511,DL
         4 001052   204112 756100                    STQ     @MAX_VAL+3,,AUTO
         4 001053   204111 236100                    LDQ     @MAX_VAL+2,,AUTO
         4 001054   204112 036100                    ADLQ    @MAX_VAL+3,,AUTO
         4 001055   200023 756100                    STQ     NEW_TOTAL_LINES,,AUTO

      443    16795    2           + F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LIMBO
      444    16796    2           + F$->FS$FORMREC.SOFTFORM.VLPPLATEN.FIRSTLINE;
      445    16797    2      END;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:147  
      446    16798    1   IF NEW_TOTAL_LINES ~= OLD_TOTAL_LINES THEN

  16798  4 001056   200023 236100                    LDQ     NEW_TOTAL_LINES,,AUTO
         4 001057   200022 116100                    CMPQ    OLD_TOTAL_LINES,,AUTO
         4 001060   001162 600000 4                  TZE     s:16911

      447    16799    2      IF PSEUDO_FLG THEN DO;

  16799  4 001061   200017 234100                    SZN     PSEUDO_FLG,,AUTO
         4 001062   001117 605000 4                  TPL     s:16856

      448    16800        /*E* ERROR:   ASF-E$PSEUDO_LENGTH_WRONG-C
      449    16801        MESSAGE: Total length of pseudo form (FIRSTLINE + LENGTH + LIMBO) is not equal
      450    16802                 to the total length of form %U1. Re-enter pseudo form definition.
      451    16803        MESSAGE1: The total length (FIRSTLINE + LENGTH +LIMBO) of the pseudo form must
      452    16804                  equal the total length of the form. Total length of pseudo form = %U2.
      453    16805                  Total length of form %U1 = %U3.  Re-enter the pseudo form definition.
      454    16806        */
      455    16807    2         AS_FIELD1 = FORM_KEY_OLD;

  16807  4 001063   000000 100500                    MLR     fill='000'O
         4 001064   200033 000007                    ADSC9   FORM_KEY_OLD,,AUTO       cn=0,n=7
         4 001065   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      456    16808              %NUMBER( NUM2=NEW_TOTAL_LINES, NUM3=OLD_TOTAL_LINES );
             16824    2         CALL ASB$BINCHAR( AS_FIELD2.TEXT, 0, -2, NEW_TOTAL_LINES );

  16824  4 001066   200023 630500                    EPPR0   NEW_TOTAL_LINES,,AUTO
         4 001067   204113 450500                    STP0    @MAX_VAL+4,,AUTO
         4 001070   000017 236000 5                  LDQ     15
         4 001071   204112 756100                    STQ     @MAX_VAL+3,,AUTO
         4 001072   000020 237000 5                  LDAQ    16
         4 001073   204110 757100                    STAQ    @MAX_VAL+1,,AUTO
         4 001074   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 001075   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001076   000000 701000 xent               TSX1    ASB$BINCHAR
         4 001077   000000 011000                    NOP     0
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:148  

             16832    2         CALL ASB$BINCHAR( AS_FIELD3.TEXT, 0, -3, OLD_TOTAL_LINES );

  16832  4 001100   200022 630500                    EPPR0   OLD_TOTAL_LINES,,AUTO
         4 001101   204113 450500                    STP0    @MAX_VAL+4,,AUTO
         4 001102   000023 236000 5                  LDQ     19
         4 001103   204112 756100                    STQ     @MAX_VAL+3,,AUTO
         4 001104   000024 237000 5                  LDAQ    20
         4 001105   204110 757100                    STAQ    @MAX_VAL+1,,AUTO
         4 001106   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 001107   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001110   000000 701000 xent               TSX1    ASB$BINCHAR
         4 001111   000000 011000                    NOP     0

      457    16838              %SCREAM( ERR#=E$PSEUDO_LENGTH_WRONG, LEVEL=ERROR, MID='F' );

  16850  4 001112   000026 630400 5                  EPPR0   22
         4 001113   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001114   000000 701000 xent               TSX1    ASH$ERROR
         4 001115   000000 011000                    NOP     0

      458    16853    2         RETURN;

  16853  4 001116   000000 702200 xent               TSX2  ! X66_ARET

      459    16854    2         END;
      460    16855    2      ELSE DO;

      461    16856    3         IF PSEUDO_FORMS THEN DO;

  16856  4 001117   200046 234100                    SZN     PSEUDO_FORMS,,AUTO
         4 001120   001162 605000 4                  TPL     s:16911

      462    16857        /*E*  ERROR:  ASF-E$FORM_LENGTH_CHANGED-C
      463    16858        MESSAGE: The total length (FIRSTLINE + LENGTH + LIMBO) of form %U1 has been
      464    16859                 changed from %U2 to %U3.  Because of this change the following pseudo
      465    16860                 forms have been removed:
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:149  
      466    16861        */
      467    16862    3            AS_FIELD1 = FORM_KEY;

  16862  4 001121   000000 100500                    MLR     fill='000'O
         4 001122   200031 000007                    ADSC9   FORM_KEY,,AUTO           cn=0,n=7
         4 001123   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      468    16863                 %NUMBER( NUM2=OLD_TOTAL_LINES, NUM3=NEW_TOTAL_LINES );
             16879    3         CALL ASB$BINCHAR( AS_FIELD2.TEXT, 0, -2, OLD_TOTAL_LINES );

  16879  4 001124   200022 630500                    EPPR0   OLD_TOTAL_LINES,,AUTO
         4 001125   204113 450500                    STP0    @MAX_VAL+4,,AUTO
         4 001126   000017 236000 5                  LDQ     15
         4 001127   204112 756100                    STQ     @MAX_VAL+3,,AUTO
         4 001130   000020 237000 5                  LDAQ    16
         4 001131   204110 757100                    STAQ    @MAX_VAL+1,,AUTO
         4 001132   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 001133   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001134   000000 701000 xent               TSX1    ASB$BINCHAR
         4 001135   000000 011000                    NOP     0

             16887    3         CALL ASB$BINCHAR( AS_FIELD3.TEXT, 0, -3, NEW_TOTAL_LINES );

  16887  4 001136   200023 630500                    EPPR0   NEW_TOTAL_LINES,,AUTO
         4 001137   204113 450500                    STP0    @MAX_VAL+4,,AUTO
         4 001140   000023 236000 5                  LDQ     19
         4 001141   204112 756100                    STQ     @MAX_VAL+3,,AUTO
         4 001142   000024 237000 5                  LDAQ    20
         4 001143   204110 757100                    STAQ    @MAX_VAL+1,,AUTO
         4 001144   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 001145   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001146   000000 701000 xent               TSX1    ASB$BINCHAR
         4 001147   000000 011000                    NOP     0

      469    16893                 %SCREAM( ERR#=E$FORM_LENGTH_CHANGED, LEVEL=WARN, MID='F' );

  16903  4 001150   000027 630400 5                  EPPR0   23
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:150  
         4 001151   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001152   000000 701000 xent               TSX1    ASH$WARN
         4 001153   000000 011000                    NOP     0

      470    16908    3            CALL ASR$R_PSEUDO_FORMS( PSEUDO_FORM_KEY );

  16908  4 001154   200035 630500                    EPPR0   PSEUDO_FORM_KEY,,AUTO
         4 001155   204110 450500                    STP0    @MAX_VAL+1,,AUTO
         4 001156   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 001157   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001160   000000 701000 xent               TSX1    ASR$R_PSEUDO_FORMS
         4 001161   000000 011000                    NOP     0

      471    16909    3            END;

      472    16910    2         END;

      473    16911    1   IF PSEUDO_FLG THEN

  16911  4 001162   200017 234100                    SZN     PSEUDO_FLG,,AUTO
         4 001163   001171 605000 4                  TPL     s:16914

      474    16912    1      F$->FS$FORMREC.FNAME = FORM_KEY_OLD.TEXT;

  16912  4 001164   204051 470500                    LDP0    F$,,AUTO
         4 001165   040100 100500                    MLR     fill='040'O
         4 001166   200033 200006                    ADSC9   FORM_KEY_OLD,,AUTO       cn=1,n=6
         4 001167   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6
         4 001170   001175 710000 4                  TRA     s:16915

      475    16913    1   ELSE
      476    16914    1      F$->FS$FORMREC.FNAME=FORM_KEY.TEXT;

  16914  4 001171   204051 470500                    LDP0    F$,,AUTO
         4 001172   040100 100500                    MLR     fill='040'O
         4 001173   200031 200006                    ADSC9   FORM_KEY,,AUTO           cn=1,n=6
         4 001174   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:151  

      477    16915    1   CALL FORM_GATHER

  16915  4 001175   012136 701000 4                  TSX1    FORM_GATHER
         4 001176   001333 702000 4                  TSX2    s:16945

      478    16916    2   WHENRETURN DO;

      479    16917    2      ARS = DISP_TALLY * 4;

  16917  4 001177   200013 235100                    LDA     DISP_TALLY,,AUTO
         4 001200   777777 375003                    ANA     -1,DU
         4 001201   000020 771000                    ARL     16
         4 001202   200020 755100                    STA     ARS,,AUTO

      480    16918    2      CALL ASF$WRITE_FORM(FORM_KEY,F$,ARS);

  16918  4 001203   200020 630500                    EPPR0   ARS,,AUTO
         4 001204   204112 450500                    STP0    @MAX_VAL+3,,AUTO
         4 001205   204051 631500                    EPPR1   F$,,AUTO
         4 001206   204111 451500                    STP1    @MAX_VAL+2,,AUTO
         4 001207   200031 633500                    EPPR3   FORM_KEY,,AUTO
         4 001210   204110 453500                    STP3    @MAX_VAL+1,,AUTO
         4 001211   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 001212   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001213   000000 701000 xent               TSX1    ASF$WRITE_FORM
         4 001214   000000 011000                    NOP     0

      481    16919    3      IF PSEUDO_FLG AND CREATE THEN DO;

  16919  4 001215   200017 234100                    SZN     PSEUDO_FLG,,AUTO
         4 001216   001265 605000 4                  TPL     s:16928
         4 001217   200015 234100                    SZN     CREATE,,AUTO
         4 001220   001265 605000 4                  TPL     s:16928

      482    16920    3         PSEUDO_FORM_KEY.CNT = 12;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:152  
  16920  4 001221   014000 236003                    LDQ     6144,DU
         4 001222   200035 552140                    STBQ    PSEUDO_FORM_KEY,'40'O,AUTO

      483    16921    3         CALL CONCAT(PSEUDO_FORM_KEY.TXT, FORM_KEY_OLD.TEXT, FORM_KEY.TEXT );

  16921  4 001223   040100 100500                    MLR     fill='040'O
         4 001224   200033 200006                    ADSC9   FORM_KEY_OLD,,AUTO       cn=1,n=6
         4 001225   200035 200006                    ADSC9   PSEUDO_FORM_KEY,,AUTO    cn=1,n=6
         4 001226   040100 100500                    MLR     fill='040'O
         4 001227   200031 200006                    ADSC9   FORM_KEY,,AUTO           cn=1,n=6
         4 001230   200036 600006                    ADSC9   PSEUDO_FORM_KEY+1,,AUTO  cn=3,n=6

      484    16922    3         PSEUDO_FORM_REC.ELSOK = ELSOK;

  16922  4 001231   200024 236100                    LDQ     ELSOK,,AUTO
         4 001232   000002 772000                    QRL     2
         4 001233   200030 676100                    ERQ     PSEUDO_FORM_REC,,AUTO
         4 001234   100000 376003                    ANQ     32768,DU
         4 001235   200030 656100                    ERSQ    PSEUDO_FORM_REC,,AUTO

      485    16923    3         PSEUDO_FORM_REC.TSOK = TSOK;

  16923  4 001236   200026 236100                    LDQ     TSOK,,AUTO
         4 001237   000001 772000                    QRL     1
         4 001240   200030 676100                    ERQ     PSEUDO_FORM_REC,,AUTO
         4 001241   200000 376003                    ANQ     65536,DU
         4 001242   200030 656100                    ERSQ    PSEUDO_FORM_REC,,AUTO

      486    16924    3         PSEUDO_FORM_REC.LPOK = LPOK;

  16924  4 001243   200025 236100                    LDQ     LPOK,,AUTO
         4 001244   200030 676100                    ERQ     PSEUDO_FORM_REC,,AUTO
         4 001245   400000 376003                    ANQ     -131072,DU
         4 001246   200030 656100                    ERSQ    PSEUDO_FORM_REC,,AUTO

      487    16925    3         ARS = 4;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:153  
  16925  4 001247   000004 235007                    LDA     4,DL
         4 001250   200020 755100                    STA     ARS,,AUTO

      488    16926    3         CALL ASF$WRITE_FORM( PSEUDO_FORM_KEY, ADDR(PSEUDO_FORM_REC), ARS );

  16926  4 001251   200030 630500                    EPPR0   PSEUDO_FORM_REC,,AUTO
         4 001252   204110 450500                    STP0    @MAX_VAL+1,,AUTO
         4 001253   200020 631500                    EPPR1   ARS,,AUTO
         4 001254   204113 451500                    STP1    @MAX_VAL+4,,AUTO
         4 001255   204110 633500                    EPPR3   @MAX_VAL+1,,AUTO
         4 001256   204112 453500                    STP3    @MAX_VAL+3,,AUTO
         4 001257   200035 634500                    EPPR4   PSEUDO_FORM_KEY,,AUTO
         4 001260   204111 454500                    STP4    @MAX_VAL+2,,AUTO
         4 001261   204111 630500                    EPPR0   @MAX_VAL+2,,AUTO
         4 001262   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001263   000000 701000 xent               TSX1    ASF$WRITE_FORM
         4 001264   000000 011000                    NOP     0

      489    16927    3         END;

      490    16928    3      IF NOT PSEUDO_FLG AND PSEUDO_FORMS THEN DO;

  16928  4 001265   200017 234100                    SZN     PSEUDO_FLG,,AUTO
         4 001266   001333 604000 4                  TMI     s:16945
         4 001267   200046 234100                    SZN     PSEUDO_FORMS,,AUTO
         4 001270   001333 605000 4                  TPL     s:16945

      491    16929    3         I = 1;

  16929  4 001271   000001 235007                    LDA     1,DL
         4 001272   200005 755100                    STA     I,,AUTO

      492    16930    4         IF NOT F$->FS$FORMREC.LGLTYPS.LPOK AND LPOK THEN DO;

  16930  4 001273   204051 470500                    LDP0    F$,,AUTO
         4 001274   000004 236100                    LDQ     4,,PR0
         4 001275   000400 316003                    CANQ    256,DU
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:154  
         4 001276   001305 601000 4                  TNZ     s:16934
         4 001277   200025 234100                    SZN     LPOK,,AUTO
         4 001300   001305 605000 4                  TPL     s:16934

      493    16931    4            LPOK = AS_FALSE;

  16931  4 001301   000000 236000 xsym               LDQ     AS_FALSE
         4 001302   400000 376003                    ANQ     -131072,DU
         4 001303   200025 756100                    STQ     LPOK,,AUTO

      494    16932    4            I = 0;

  16932  4 001304   200005 450100                    STZ     I,,AUTO

      495    16933    4            END;

      496    16934    4         IF NOT F$->FS$FORMREC.LGLTYPS.TSOK AND TSOK THEN DO;

  16934  4 001305   000004 236100                    LDQ     4,,PR0
         4 001306   000200 316003                    CANQ    128,DU
         4 001307   001316 601000 4                  TNZ     s:16938
         4 001310   200026 234100                    SZN     TSOK,,AUTO
         4 001311   001316 605000 4                  TPL     s:16938

      497    16935    4            TSOK = AS_FALSE;

  16935  4 001312   000000 236000 xsym               LDQ     AS_FALSE
         4 001313   400000 376003                    ANQ     -131072,DU
         4 001314   200026 756100                    STQ     TSOK,,AUTO

      498    16936    4            I = 0;

  16936  4 001315   200005 450100                    STZ     I,,AUTO

      499    16937    4            END;

      500    16938    4         IF NOT F$->FS$FORMREC.LGLTYPS.ELSOK AND ELSOK THEN DO;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:155  

  16938  4 001316   000004 236100                    LDQ     4,,PR0
         4 001317   000100 316003                    CANQ    64,DU
         4 001320   001327 601000 4                  TNZ     s:16942
         4 001321   200024 234100                    SZN     ELSOK,,AUTO
         4 001322   001327 605000 4                  TPL     s:16942

      501    16939    4            ELSOK = AS_FALSE;

  16939  4 001323   000000 236000 xsym               LDQ     AS_FALSE
         4 001324   400000 376003                    ANQ     -131072,DU
         4 001325   200024 756100                    STQ     ELSOK,,AUTO

      502    16940    4            I = 0;

  16940  4 001326   200005 450100                    STZ     I,,AUTO

      503    16941    4            END;

      504    16942    3         IF I = 0 THEN CALL MOD_PSEUDO_FORMS;

  16942  4 001327   200005 236100                    LDQ     I,,AUTO
         4 001330   001333 601000 4                  TNZ     s:16945

  16942  4 001331   011511 701000 4                  TSX1    MOD_PSEUDO_FORMS
         4 001332   000000 011000                    NOP     0

      505    16943    3         END;

      506    16944    2      END; /* When return */

      507    16945    1   RETURN;

  16945  4 001333   000000 702200 xent               TSX2  ! X66_ARET

      508    16946    1   FORM_ERR:
      509    16947    1   CALL ASH$ERROR (P_PCB.ERROR);
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:156  

  16947  4 001334   000030 630400 5     FORM_ERR     EPPR0   24
         4 001335   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001336   000000 701000 xent               TSX1    ASH$ERROR
         4 001337   000000 011000                    NOP     0

      510    16948    1   RETURN;

  16948  4 001340   000000 702200 xent               TSX2  ! X66_ARET

      511    16949        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:157  
      512    16950    1   FORM_OPTS: PROC;

  16950  4 001341   204052 741300       FORM_OPTS    STX1  ! F$+1,,AUTO

      513    16951        /****************************************************************
      514    16952        FORM_OPTS proccesses the options.  They are:
      515    16953
      516    16954
      517    16955        Wi[dth] = dec (0-508)
      518    16956              the decimal numberr specifies the maximum number of
      519    16957              characters to be written per line on the form.
      520    16958        Le[ngth] = dec (0-555)
      521    16959              the decimal number specifies the number of printable lines
      522    16960              on the page.  There are firstline+length+limbo total lines
      523    16961              on one page of the form.
      524    16962        Li[mbo] = dec (0-444)
      525    16963              specifies the number of lines to be left blank between the last
      526    16964              legal print line and the bottom of the page.
      527    16965        Fi[rstline] = dec (0-100)
      528    16966              specifies the height of the area which is to be left blank
      529    16967              between the beginning of the page and the first legal print
      530    16968              line.  It can also be considered the number of the first
      531    16969              legal print line.
      532    16970        Lpi = dec
      533    16971              specifies the number of lines per inch.
      534    16972        Fl[ags] = dec
      535    16973              this is used to set the flags feild. Currently, no flags are
      536    16974              defined.
      537    16975        Vf[uim]
      538    16976              this command indicats that you want to define the
      539    16977              vfu image for this form. Super will prompt for sub-options.
      540    16978              At that point, you type in definitions of the form:
      541    16979              Ch[an] dec = dec[,dec...]
      542    16980              for example, 'CHAN5 = 2,10' says that there is a channel 5 punch
      543    16981              for lines 2 and 10.
      544    16982        Se[tup]
      545    16983              this one says you want to define a message to be given to
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:158  
      546    16984              the operator when he says 'SETUP formname'. Super will then
      547    16985              prompt with 'TXT*' and you can enter up to 10 lines of 72
      548    16986              characters each.  To end before that, simple type a blank line.
      549    16987              If you type all 10 lines of setup info, super will inform
      550    16988              you of this by saying:
      551    16989              Setup buffer full, returning to 'OPT*' level.
      552    16990        Ac[cess] = tname[,tname,...]
      553    16991              the access options is used to set the access list of tnames,
      554    16992              to say which tnames can use this form.  You can put in from
      555    16993              one to 12 tname, and any of them may include the 'wild-card'
      556    16994              character '?'.
      557    16995        Ba[nner]
      558    16996        al[ignment]
      559    16997              these two options are described with the banner procedure,
      560    16998              which proccesses the sub-options for both of them.
      561    16999        Ch[arset] | chai[n] = charset name
      562    17000              is the 6 character name of an existing charset.  The lpok,
      563    17001              tsok, elsok, and ltyp device legality fields,
      564    17002              along with the attributes as described in the charset record,
      565    17003              are moved from the charset record to the graphic form record.
      566    17004        Acco[unt] = account[,account,...]
      567    17005              the account options is used to set the account list of account
      568    17006              names to say which accounts can use this form.  You can put in
      569    17007              from one to 12 accounts, and any of them may include the
      570    17008              'wild-card' character '?'.
      571    17009        Ba[nner]
      572    17010        al[ignment]
      573    17011              these two options are described with the banner procedure,
      574    17012              which proccesses the sub-options for both of them.
      575    17013        R[emove] ('b/anner' | 'A/LIGNMENT')
      576    17014              will remove either the banner or alignment image.
      577    17015        Tran/sparent [ l/egal] [= ('y/es'|'n/o')]
      578    17016           allows the specification of the transparent legal setting at the
      579    17017           form level in addition to the setting at the charset level.
      580    17018           This setting will override the charset setting.
      581    17019           The default is no and if the option appears on the command line
      582    17020           alone yes is assumed.
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:159  
      583    17021        *****************************************************************/
      584    17022
      585    17023    2   DCL I UBIN WORD;
      586    17024    2   DCL J UBIN WORD;
      587    17025    2   DCL K UBIN WORD;
      588    17026    2   DCL L UBIN WORD;
      589    17027    2   DCL M UBIN WORD;
      590    17028    2   DCL PTR$ PTR;
      591    17029    2   DCL PTR2$ PTR;
      592    17030    2   DCL SUBNODES UBIN WORD;
      593    17031    2   DCL OP_CODE UBIN WORD;
      594    17032    2   DCL VAL UBIN WORD;
      595    17033    2   DCL DEV_TYPE CHAR(2);
      596    17034    2   DCL DEV_TYPE_A(0:1) REDEF DEV_TYPE CHAR(1);
      597    17035    2   DCL CHECK_VFU_FLG BIT(1);
      598    17036    2   DCL TRANSLGL_SET  BIT(1);
      599    17037    2   DCL TRANSLGL_VAL  BIT(1);
      600    17038    2   DCL ONEBIT  BIT(1)  BASED;
      601    17039
      602    17040
      603    17041    2   TRANSLGL_SET = AS_FALSE;

  17041  4 001342   000000 236000 xsym               LDQ     AS_FALSE
         4 001343   400000 376003                    ANQ     -131072,DU
         4 001344   204067 756100                    STQ     TRANSLGL_SET,,AUTO

      604    17042    2   CHECK_VFU_FLG = AS_FALSE;

  17042  4 001345   204066 756100                    STQ     CHECK_VFU_FLG,,AUTO

      605    17043    2   FORM_OPTS_LOOP:
      606    17044    2   CALL ASB$SET_PROMPT ( %PROMPT_OPT );

  17044  4 001346   000031 630400 5     FORM_OPTS_L* EPPR0   25
         4 001347   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001350   000000 701000 xent               TSX1    ASB$SET_PROMPT
         4 001351   000000 011000                    NOP     0
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:160  

      607    17045    2   IF PSEUDO_FLG

  17045  4 001352   200017 234100                    SZN     PSEUDO_FLG,,AUTO
         4 001353   001357 605000 4                  TPL     s:17047

      608    17046    2   THEN P_PCB.ROOT$ = ADDR( PSEUDO_OPTS_LIST );

  17046  4 001354   000032 236000 5                  LDQ     26
         4 001355   000001 756000 xsym               STQ     P_PCB+1
         4 001356   001361 710000 4                  TRA     s:17048

      609    17047    2   ELSE P_PCB.ROOT$ = ADDR( FORM_OPTS_LIST );

  17047  4 001357   000033 236000 5                  LDQ     27
         4 001360   000001 756000 xsym               STQ     P_PCB+1

      610    17048    3   DO WHILE ( AS_TRUE );

  17048  4 001361   000000 234000 xsym               SZN     AS_TRUE
         4 001362   003053 605000 4                  TPL     OPTS_ERR

      611    17049    3      CALL ASB$READ_SI( IN_BUF, ARS);

  17049  4 001363   200020 630500                    EPPR0   ARS,,AUTO
         4 001364   204111 450500                    STP0    @MAX_VAL+2,,AUTO
         4 001365   000034 236000 5                  LDQ     28
         4 001366   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 001367   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 001370   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001371   000000 701000 xent               TSX1    ASB$READ_SI
         4 001372   000000 011000                    NOP     0

      612    17050    3      P_PCB.NCHARS = ARS;

  17050  4 001373   200020 235100                    LDA     ARS,,AUTO
         4 001374   000011 755000 xsym               STA     P_PCB+9
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:161  

      613    17051    3      CALL X$PARSE( P_PCB ) ALTRET ( OPTS_ERR );

  17051  4 001375   000003 630400 5                  EPPR0   3
         4 001376   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001377   000000 701000 xent               TSX1    X$PARSE
         4 001400   003053 702000 4                  TSX2    OPTS_ERR

      614    17052    3      NODE$ = P_PCB.OUT$;

  17052  4 001401   000003 236000 xsym               LDQ     P_PCB+3
         4 001402   000000 756000 xsym               STQ     NODE$

      615    17053    3      SUBNODES=P$NODE.SUBNODES;

  17053  4 001403   000000 470400 xsym               LDP0    NODE$
         4 001404   000001 236100                    LDQ     1,,PR0
         4 001405   000022 772000                    QRL     18
         4 001406   204062 756100                    STQ     SUBNODES,,AUTO

      616    17054    4   DO_J: DO J = 0 TO SUBNODES - 1;

  17054  4 001407   204054 450100       DO_J         STZ     J,,AUTO
         4 001410   003046 710000 4                  TRA     s:17561+3

      617    17055    4         PTR$ = P$NODE.SUBLK$(J);

  17055  4 001411   000000 470400 xsym               LDP0    NODE$
         4 001412   204054 720100                    LXL0    J,,AUTO
         4 001413   000003 236110                    LDQ     3,X0,PR0
         4 001414   204060 756100                    STQ     PTR$,,AUTO

      618    17056    4         CODE = PTR$-> P$NODE.CODE;

  17056  4 001415   204060 471500                    LDP1    PTR$,,AUTO
         4 001416   100000 236100                    LDQ     0,,PR1
         4 001417   777777 376007                    ANQ     -1,DL
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:162  
         4 001420   000000 756000 xsym               STQ     CODE

      619    17057    4         IF PTR$->P$NODE.SUBNODES = 0

  17057  4 001421   100001 221100                    LDX1    1,,PR1
         4 001422   001426 601000 4                  TNZ     s:17060

      620    17058    4         THEN OP_CODE = 1   /*  YES_VAL  */;

  17058  4 001423   000001 235007                    LDA     1,DL
         4 001424   204063 755100                    STA     OP_CODE,,AUTO
         4 001425   001434 710000 4                  TRA     DO_CASE

      621    17059    5         ELSE DO;

      622    17060    5            PTR2$=PTR$->P$NODE.SUBLK$(0);

  17060  4 001426   100003 236100                    LDQ     3,,PR1
         4 001427   204061 756100                    STQ     PTR2$,,AUTO

      623    17061    5            OP_CODE = PTR2$->P$NODE.CODE;

  17061  4 001430   204061 473500                    LDP3    PTR2$,,AUTO
         4 001431   300000 236100                    LDQ     0,,PR3
         4 001432   777777 376007                    ANQ     -1,DL
         4 001433   204063 756100                    STQ     OP_CODE,,AUTO

      624    17062    5            END;

      625    17063    5   DO_CASE: DO SELECT (CODE);

  17063  4 001434   000000 236000 xsym  DO_CASE      LDQ     CODE
         4 001435   000036 116007                    CMPQ    30,DL
         4 001436   001507 602000 4                  TNC     DO_CASE+43
         4 001437   002100 600000 4                  TZE     s:17267
         4 001440   000101 116007                    CMPQ    65,DL
         4 001441   001457 602000 4                  TNC     DO_CASE+19
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:163  
         4 001442   002375 600000 4                  TZE     s:17374
         4 001443   000454 116007                    CMPQ    300,DL
         4 001444   001454 602000 4                  TNC     DO_CASE+16
         4 001445   001564 600000 4                  TZE     s:17071
         4 001446   000455 116007                    CMPQ    301,DL
         4 001447   003043 602000 4                  TNC     s:17561
         4 001450   001560 600000 4                  TZE     s:17069
         4 001451   000456 116007                    CMPQ    302,DL
         4 001452   003043 601000 4                  TNZ     s:17561
         4 001453   001554 710000 4                  TRA     s:17067
         4 001454   000102 116007                    CMPQ    66,DL
         4 001455   003043 601000 4                  TNZ     s:17561
         4 001456   002401 710000 4                  TRA     s:17378
         4 001457   000075 116007                    CMPQ    61,DL
         4 001460   001473 602000 4                  TNC     DO_CASE+31
         4 001461   002100 600000 4                  TZE     s:17267
         4 001462   000077 116007                    CMPQ    63,DL
         4 001463   001470 602000 4                  TNC     DO_CASE+28
         4 001464   002405 600000 4                  TZE     s:17383
         4 001465   000100 116007                    CMPQ    64,DL
         4 001466   003043 601000 4                  TNZ     s:17561
         4 001467   002405 710000 4                  TRA     s:17383
         4 001470   000076 116007                    CMPQ    62,DL
         4 001471   003043 601000 4                  TNZ     s:17561
         4 001472   002100 710000 4                  TRA     s:17267
         4 001473   000040 116007                    CMPQ    32,DL
         4 001474   001504 602000 4                  TNC     DO_CASE+40
         4 001475   002370 600000 4                  TZE     s:17370
         4 001476   000043 116007                    CMPQ    35,DL
         4 001477   003043 602000 4                  TNC     s:17561
         4 001500   002405 600000 4                  TZE     s:17383
         4 001501   000044 116007                    CMPQ    36,DL
         4 001502   003043 601000 4                  TNZ     s:17561
         4 001503   002665 710000 4                  TRA     s:17487
         4 001504   000037 116007                    CMPQ    31,DL
         4 001505   003043 601000 4                  TNZ     s:17561
         4 001506   002363 710000 4                  TRA     s:17366
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:164  
         4 001507   000024 116007                    CMPQ    20,DL
         4 001510   001534 602000 4                  TNC     DO_CASE+64
         4 001511   001764 600000 4                  TZE     s:17176
         4 001512   000032 116007                    CMPQ    26,DL
         4 001513   001526 602000 4                  TNC     DO_CASE+58
         4 001514   001570 600000 4                  TZE     s:17073
         4 001515   000034 116007                    CMPQ    28,DL
         4 001516   001523 602000 4                  TNC     DO_CASE+55
         4 001517   002072 600000 4                  TZE     s:17258
         4 001520   000035 116007                    CMPQ    29,DL
         4 001521   003043 601000 4                  TNZ     s:17561
         4 001522   002075 710000 4                  TRA     s:17262
         4 001523   000033 116007                    CMPQ    27,DL
         4 001524   003043 601000 4                  TNZ     s:17561
         4 001525   002041 710000 4                  TRA     s:17231
         4 001526   000025 116007                    CMPQ    21,DL
         4 001527   003043 602000 4                  TNC     s:17561
         4 001530   002012 600000 4                  TZE     s:17203
         4 001531   000026 116007                    CMPQ    22,DL
         4 001532   003043 601000 4                  TNZ     s:17561
         4 001533   003030 710000 4                  TRA     s:17555
         4 001534   000022 116007                    CMPQ    18,DL
         4 001535   001542 602000 4                  TNC     DO_CASE+70
         4 001536   001664 600000 4                  TZE     s:17117
         4 001537   000023 116007                    CMPQ    19,DL
         4 001540   003043 601000 4                  TNZ     s:17561
         4 001541   001724 710000 4                  TRA     s:17147
         4 001542   000020 116007                    CMPQ    16,DL
         4 001543   001550 602000 4                  TNC     DO_CASE+76
         4 001544   001553 600000 4                  TZE     s:17064
         4 001545   000021 116007                    CMPQ    17,DL
         4 001546   003043 601000 4                  TNZ     s:17561
         4 001547   001614 710000 4                  TRA     s:17083
         4 001550   000014 116007                    CMPQ    12,DL
         4 001551   003043 601000 4                  TNZ     s:17561
         4 001552   001570 710000 4                  TRA     s:17073

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:165  
      626    17064    5            SELECT(16   /*  EOL_VAL  */);

  17064  4 001553   003043 710000 4                  TRA     s:17561

      627    17065    5            ;
      628    17066    5            SELECT( 302 /* HELP_VAL */ );

      629    17067    5            CALL ASH$HELP;

  17067  4 001554   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001555   000000 701000 xent               TSX1    ASH$HELP
         4 001556   000000 011000                    NOP     0
         4 001557   003043 710000 4                  TRA     s:17561

      630    17068    5            SELECT( 301 /* QUESTION_VAL */ );

      631    17069    5            CALL ASH$QUEST;

  17069  4 001560   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001561   000000 701000 xent               TSX1    ASH$QUEST
         4 001562   000000 011000                    NOP     0
         4 001563   003043 710000 4                  TRA     s:17561

      632    17070    5            SELECT( 300 /* DQUESTION_VAL */ );

      633    17071    5            CALL ASH$DQUEST;

  17071  4 001564   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001565   000000 701000 xent               TSX1    ASH$DQUEST
         4 001566   000000 011000                    NOP     0
         4 001567   003043 710000 4                  TRA     s:17561

      634    17072    5            SELECT(12   /*  END_VAL  */, 26   /*  BLANK_LINE_VAL */);

      635    17073    5            IF F$->FS$FORMREC.SOFTFORM.VFUIM.V ~= '0'B

  17073  4 001570   204051 473500                    LDP3    F$,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:166  
         4 001571   000000 106500                    CMPC    fill='000'O
         4 001572   300012 400100                    ADSC9   10,,PR3                  cn=2,n=64
         4 001573   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
         4 001574   001601 600000 4                  TZE     s:17076
         4 001575   204066 234100                    SZN     CHECK_VFU_FLG,,AUTO
         4 001576   001601 605000 4                  TPL     s:17076

      636    17074    5                 AND CHECK_VFU_FLG THEN
      637    17075    5               CALL CHECK_VFU_IMAGE;

  17075  4 001577   003502 701000 4                  TSX1    CHECK_VFU_IMAGE
         4 001600   000000 011000                    NOP     0

      638    17076    5            IF TRANSLGL_SET THEN

  17076  4 001601   204067 234100                    SZN     TRANSLGL_SET,,AUTO
         4 001602   001612 605000 4                  TPL     s:17081

      639    17077    6            DO;

      640    17078    6               PTR$ = PINCRB (ADDR (F$->FS$FORMREC.ATTR),10);

  17078  4 001603   204051 236100                    LDQ     F$,,AUTO
         4 001604   000035 036000 5                  ADLQ    29
         4 001605   204060 756100                    STQ     PTR$,,AUTO

      641    17079    6               PTR$ -> ONEBIT = TRANSLGL_VAL;

  17079  4 001606   204060 470500                    LDP0    PTR$,,AUTO
         4 001607   003100 060500                    CSL     bolr='003'O
         4 001610   204070 000001                    BDSC    TRANSLGL_VAL,,AUTO       by=0,bit=0,n=1
         4 001611   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1

      642    17080    6               END; /*  TRANSLGL_SET  */

      643    17081    5            RETURN;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:167  
  17081  4 001612   204052 221300                    LDX1  ! F$+1,,AUTO
         4 001613   000001 702211                    TSX2  ! 1,X1

      644    17082    5            SELECT( 17 /* F_WIDTH */ );

      645    17083    5            BLK$=PTR2$;

  17083  4 001614   204061 236100                    LDQ     PTR2$,,AUTO
         4 001615   204050 756100                    STQ     BLK$,,AUTO

      646    17084    5            CALL CHARBIN( VAL, OUT$SYM.TEXT );

  17084  4 001616   204050 470500                    LDP0    BLK$,,AUTO
         4 001617   000004 236100                    LDQ     4,,PR0
         4 001620   000033 772000                    QRL     27
         4 001621   000000 620006                    EAX0    0,QL
         4 001622   000100 305540                    DTB
         4 001623   000004 230010                    NDSC9   4,,PR0                   cn=1,s=nosgn,sf=0,n=*X0
         4 001624   204110 000010                    NDSC9   @MAX_VAL+1,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         4 001625   204111 235100                    LDA     @MAX_VAL+2,,AUTO
         4 001626   204064 755100                    STA     VAL,,AUTO

      647    17085    6            IF VAL > 508 THEN DO;

  17085  4 001627   000775 115007                    CMPA    509,DL
         4 001630   001636 602000 4                  TNC     s:17107

      648    17086        /*E* ERROR: ASF-E$BADWIDTH-0
      649    17087             MESSAGE: WIDTH too large.
      650    17088             MESSAGE1: WIDTH can not exceed 508 characters.
      651    17089        */
      652    17090                    %SCREAM( ERR#=E$BADWIDTH,MID='F',LEVEL=ERROR);

  17102  4 001631   000036 630400 5                  EPPR0   30
         4 001632   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001633   000000 701000 xent               TSX1    ASH$ERROR
         4 001634   000000 011000                    NOP     0
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:168  

      653    17105    6               GOTO FORM_OPTS_LOOP_END;

  17105  4 001635   003051 710000 4                  TRA     FORM_OPTS_LOOP_END

      654    17106    6               END;
      655    17107    5            IF VAL > 254 THEN

  17107  4 001636   000377 115007                    CMPA    255,DL
         4 001637   001651 602000 4                  TNC     s:17113

      656    17108    6            DO;

      657    17109    6               VAL = VAL - 254;

  17109  4 001640   000376 135007                    SBLA    254,DL
         4 001641   204064 755100                    STA     VAL,,AUTO

      658    17110    6               F$->FS$FORMREC.SOFTFORM.VLPPLATEN.EXTWID= AS_TRUE;

  17110  4 001642   204051 471500                    LDP1    F$,,AUTO
         4 001643   000000 236000 xsym               LDQ     AS_TRUE
         4 001644   000010 772000                    QRL     8
         4 001645   100007 676100                    ERQ     7,,PR1
         4 001646   001000 376003                    ANQ     512,DU
         4 001647   100007 656100                    ERSQ    7,,PR1

      659    17111    6               END;

  17111  4 001650   001657 710000 4                  TRA     s:17114

      660    17112    5            ELSE
      661    17113    5               F$->FS$FORMREC.SOFTFORM.VLPPLATEN.EXTWID= AS_FALSE;

  17113  4 001651   204051 471500                    LDP1    F$,,AUTO
         4 001652   000000 236000 xsym               LDQ     AS_FALSE
         4 001653   000010 772000                    QRL     8
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:169  
         4 001654   100007 676100                    ERQ     7,,PR1
         4 001655   001000 376003                    ANQ     512,DU
         4 001656   100007 656100                    ERSQ    7,,PR1

      662    17114    5            F$->FS$FORMREC.SOFTFORM.VLPPLATEN.WIDTH = VAL;

  17114  4 001657   204051 471500                    LDP1    F$,,AUTO
         4 001660   204064 236100                    LDQ     VAL,,AUTO
         4 001661   000033 736000                    QLS     27
         4 001662   100006 552140                    STBQ    6,'40'O,PR1
         4 001663   003043 710000 4                  TRA     s:17561

      663    17115
      664    17116    5            SELECT( 18 /* F_LENGTH */ );

      665    17117    5            BLK$ = PTR2$;

  17117  4 001664   204061 236100                    LDQ     PTR2$,,AUTO
         4 001665   204050 756100                    STQ     BLK$,,AUTO

      666    17118    5            CALL CHARBIN( VAL, OUT$SYM.TEXT);

  17118  4 001666   204050 470500                    LDP0    BLK$,,AUTO
         4 001667   000004 236100                    LDQ     4,,PR0
         4 001670   000033 772000                    QRL     27
         4 001671   000000 620006                    EAX0    0,QL
         4 001672   000100 305540                    DTB
         4 001673   000004 230010                    NDSC9   4,,PR0                   cn=1,s=nosgn,sf=0,n=*X0
         4 001674   204110 000010                    NDSC9   @MAX_VAL+1,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         4 001675   204111 235100                    LDA     @MAX_VAL+2,,AUTO
         4 001676   204064 755100                    STA     VAL,,AUTO

      667    17119    6            IF (VAL <= 254) THEN DO;

  17119  4 001677   000377 115007                    CMPA    255,DL
         4 001700   001717 603000 4                  TRC     s:17141

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:170  
      668    17120    6               IF VAL < F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LENGTH THEN

  17120  4 001701   204051 471500                    LDP1    F$,,AUTO
         4 001702   100006 236100                    LDQ     6,,PR1
         4 001703   000022 772000                    QRL     18
         4 001704   000777 376007                    ANQ     511,DL
         4 001705   204064 116100                    CMPQ    VAL,,AUTO
         4 001706   001713 602000 4                  TNC     s:17122
         4 001707   001713 600000 4                  TZE     s:17122

      669    17121    6                  CHECK_VFU_FLG = AS_TRUE;

  17121  4 001710   000000 236000 xsym               LDQ     AS_TRUE
         4 001711   400000 376003                    ANQ     -131072,DU
         4 001712   204066 756100                    STQ     CHECK_VFU_FLG,,AUTO

      670    17122    6               F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LENGTH = VAL;

  17122  4 001713   204064 236100                    LDQ     VAL,,AUTO
         4 001714   000022 736000                    QLS     18
         4 001715   100006 552120                    STBQ    6,'20'O,PR1

      671    17123    6               END;

  17123  4 001716   003043 710000 4                  TRA     s:17561

      672    17124    6            ELSE DO;

      673    17125        /*E* ERROR: ASF-E$BADLENGTH-0
      674    17126             MESSAGE: LENGTH too large.
      675    17127             MESSAGE1: LENGTH range is 0 to 254 lines.
      676    17128        */
      677    17129                    %SCREAM( ERR#=E$BADLENGTH,MID='F',LEVEL=ERROR);

  17141  4 001717   000037 630400 5                  EPPR0   31
         4 001720   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001721   000000 701000 xent               TSX1    ASH$ERROR
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:171  
         4 001722   000000 011000                    NOP     0

      678    17144    6               END;

  17144  4 001723   003043 710000 4                  TRA     s:17561

      679    17145
      680    17146    5            SELECT ( 19 /* F_LIMBO */ );

      681    17147    5            BLK$= PTR2$;

  17147  4 001724   204061 236100                    LDQ     PTR2$,,AUTO
         4 001725   204050 756100                    STQ     BLK$,,AUTO

      682    17148    5            CALL CHARBIN( VAL, OUT$SYM.TEXT);

  17148  4 001726   204050 470500                    LDP0    BLK$,,AUTO
         4 001727   000004 236100                    LDQ     4,,PR0
         4 001730   000033 772000                    QRL     27
         4 001731   000000 620006                    EAX0    0,QL
         4 001732   000100 305540                    DTB
         4 001733   000004 230010                    NDSC9   4,,PR0                   cn=1,s=nosgn,sf=0,n=*X0
         4 001734   204110 000010                    NDSC9   @MAX_VAL+1,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         4 001735   204111 235100                    LDA     @MAX_VAL+2,,AUTO
         4 001736   204064 755100                    STA     VAL,,AUTO

      683    17149    6            IF VAL <= 254 THEN DO;

  17149  4 001737   000377 115007                    CMPA    255,DL
         4 001740   001757 603000 4                  TRC     s:17170

      684    17150    6               IF VAL = 0 AND F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LIMBO ~= 0 THEN
             17150                        CHECK_VFU_FLG = AS_TRUE;

  17150  4 001741   000000 115003                    CMPA    0,DU
         4 001742   001752 601000 4                  TNZ     s:17151
         4 001743   204051 471500                    LDP1    F$,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:172  
         4 001744   100006 236100                    LDQ     6,,PR1
         4 001745   777000 316007                    CANQ    -512,DL
         4 001746   001752 600000 4                  TZE     s:17151

  17150  4 001747   000000 236000 xsym               LDQ     AS_TRUE
         4 001750   400000 376003                    ANQ     -131072,DU
         4 001751   204066 756100                    STQ     CHECK_VFU_FLG,,AUTO

      685    17151    6               F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LIMBO = VAL;

  17151  4 001752   204051 471500                    LDP1    F$,,AUTO
         4 001753   204064 236100                    LDQ     VAL,,AUTO
         4 001754   000011 736000                    QLS     9
         4 001755   100006 552110                    STBQ    6,'10'O,PR1

      686    17152    6               END;

  17152  4 001756   003043 710000 4                  TRA     s:17561

      687    17153    6            ELSE DO;

      688    17154        /*E* ERROR: ASF-E$BADLIMBO-0
      689    17155             MESSAGE: LIMBO too large.
      690    17156             MESSAGE1: LIMBO can not exceed 254 lines.
      691    17157        */
      692    17158                    %SCREAM( ERR#= E$BADLIMBO,MID='F',LEVEL=ERROR);

  17170  4 001757   000040 630400 5                  EPPR0   32
         4 001760   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001761   000000 701000 xent               TSX1    ASH$ERROR
         4 001762   000000 011000                    NOP     0

      693    17173    6               END;

  17173  4 001763   003043 710000 4                  TRA     s:17561

      694    17174
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:173  
      695    17175    5            SELECT ( 20 /* F_FIRSTLINE */ );

      696    17176    5            BLK$=PTR2$;

  17176  4 001764   204061 236100                    LDQ     PTR2$,,AUTO
         4 001765   204050 756100                    STQ     BLK$,,AUTO

      697    17177    5            CALL CHARBIN( VAL, OUT$SYM.TEXT);

  17177  4 001766   204050 473500                    LDP3    BLK$,,AUTO
         4 001767   300004 236100                    LDQ     4,,PR3
         4 001770   000033 772000                    QRL     27
         4 001771   000000 622006                    EAX2    0,QL
         4 001772   000100 305540                    DTB
         4 001773   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
         4 001774   204110 000010                    NDSC9   @MAX_VAL+1,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         4 001775   204111 235100                    LDA     @MAX_VAL+2,,AUTO
         4 001776   204064 755100                    STA     VAL,,AUTO

      698    17178    5            IF VAL <= 254 THEN

  17178  4 001777   000377 115007                    CMPA    255,DL
         4 002000   002005 603000 4                  TRC     s:17197

      699    17179    5               F$->FS$FORMREC.SOFTFORM.VLPPLATEN.FIRSTLINE = VAL;

  17179  4 002001   204051 474500                    LDP4    F$,,AUTO
         4 002002   204064 236100                    LDQ     VAL,,AUTO
         4 002003   400006 552104                    STBQ    6,'04'O,PR4
         4 002004   003043 710000 4                  TRA     s:17561

      700    17180    6            ELSE DO;

      701    17181        /*E* ERROR: ASF-E$BADFIRSTLINE-0
      702    17182             MESSAGE: FIRSTLINE too large.
      703    17183             MESSAGE1: FIRSTLINE must not exceed 254.
      704    17184        */
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:174  
      705    17185                    %SCREAM( ERR#= E$BADFIRSTLINE,MID='F',LEVEL=ERROR);

  17197  4 002005   000041 630400 5                  EPPR0   33
         4 002006   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002007   000000 701000 xent               TSX1    ASH$ERROR
         4 002010   000000 011000                    NOP     0

      706    17200    6               END;

  17200  4 002011   003043 710000 4                  TRA     s:17561

      707    17201
      708    17202    5            SELECT( 21 /* F_LPI */ );

      709    17203    5            BLK$=PTR2$;

  17203  4 002012   204061 236100                    LDQ     PTR2$,,AUTO
         4 002013   204050 756100                    STQ     BLK$,,AUTO

      710    17204    5            CALL CHARBIN ( VAL, OUT$SYM.TEXT);

  17204  4 002014   204050 473500                    LDP3    BLK$,,AUTO
         4 002015   300004 236100                    LDQ     4,,PR3
         4 002016   000033 772000                    QRL     27
         4 002017   000000 622006                    EAX2    0,QL
         4 002020   000100 305540                    DTB
         4 002021   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
         4 002022   204110 000010                    NDSC9   @MAX_VAL+1,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         4 002023   204111 235100                    LDA     @MAX_VAL+2,,AUTO
         4 002024   204064 755100                    STA     VAL,,AUTO

      711    17205    5            IF VAL <= 10 THEN

  17205  4 002025   000013 115007                    CMPA    11,DL
         4 002026   002034 603000 4                  TRC     s:17225

      712    17206    5               F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LPI = VAL;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:175  

  17206  4 002027   204051 474500                    LDP4    F$,,AUTO
         4 002030   204064 236100                    LDQ     VAL,,AUTO
         4 002031   000022 736000                    QLS     18
         4 002032   400007 552120                    STBQ    7,'20'O,PR4
         4 002033   003043 710000 4                  TRA     s:17561

      713    17207    6            ELSE DO;

      714    17208        /*E* ERROR: ASF-E$BADLPI-0
      715    17209             MESSAGE: LPI is too large.
      716    17210             MESSAGE1: LPI range is from 0 to 10, inclusive.
      717    17211             MESSAGE2: The LPI value must be supported in the hardware.
      718    17212        */
      719    17213                    %SCREAM( ERR#= E$BADLPI,MID='F',LEVEL=ERROR);

  17225  4 002034   000042 630400 5                  EPPR0   34
         4 002035   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002036   000000 701000 xent               TSX1    ASH$ERROR
         4 002037   000000 011000                    NOP     0

      720    17228    6               END;

  17228  4 002040   003043 710000 4                  TRA     s:17561

      721    17229
      722    17230    5            SELECT( 27 /* F_FLAGS */ );

      723    17231    5            BLK$ = PTR2$;

  17231  4 002041   204061 236100                    LDQ     PTR2$,,AUTO
         4 002042   204050 756100                    STQ     BLK$,,AUTO

      724    17232    5            CALL CHARBIN( VAL, OUT$SYM.TEXT);

  17232  4 002043   204050 473500                    LDP3    BLK$,,AUTO
         4 002044   300004 236100                    LDQ     4,,PR3
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:176  
         4 002045   000033 772000                    QRL     27
         4 002046   000000 622006                    EAX2    0,QL
         4 002047   000100 305540                    DTB
         4 002050   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
         4 002051   204110 000010                    NDSC9   @MAX_VAL+1,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         4 002052   204111 235100                    LDA     @MAX_VAL+2,,AUTO
         4 002053   204064 755100                    STA     VAL,,AUTO

      725    17233    5            IF VAL <= 128 THEN

  17233  4 002054   000201 115007                    CMPA    129,DL
         4 002055   002065 603000 4                  TRC     s:17252

      726    17234    5               F$->FS$FORMREC.FLAGS = BINBIT(VAL, 7);

  17234  4 002056   204064 236100                    LDQ     VAL,,AUTO
         4 002057   000035 736000                    QLS     29
         4 002060   204051 474500                    LDP4    F$,,AUTO
         4 002061   400004 676100                    ERQ     4,,PR4
         4 002062   774000 376003                    ANQ     -2048,DU
         4 002063   400004 656100                    ERSQ    4,,PR4
         4 002064   003043 710000 4                  TRA     s:17561

      727    17235    6            ELSE DO;

      728    17236        /*E* ERROR: ASF-E$BADFLAGS-0
      729    17237             MESSAGE: FLAGS too large.
      730    17238             MESSAGE1: FLAGS must be less than 128.
      731    17239        */
      732    17240                    %SCREAM( ERR#=E$BADFLAGS,MID='F',LEVEL=ERROR);

  17252  4 002065   000043 630400 5                  EPPR0   35
         4 002066   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002067   000000 701000 xent               TSX1    ASH$ERROR
         4 002070   000000 011000                    NOP     0

      733    17255    6               END;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:177  

  17255  4 002071   003043 710000 4                  TRA     s:17561

      734    17256
      735    17257    5            SELECT( 28 /* F_VFUIM */ );

      736    17258    5            CALL VFUIM;

  17258  4 002072   003060 701000 4                  TSX1    VFUIM
         4 002073   000000 011000                    NOP     0

      737    17259    5            GOTO FORM_OPTS_LOOP;

  17259  4 002074   001346 710000 4                  TRA     FORM_OPTS_LOOP

      738    17260
      739    17261    5            SELECT( 29 /* F_SETUP */ );

      740    17262    5            CALL SETUP;

  17262  4 002075   003712 701000 4                  TSX1    SETUP
         4 002076   000000 011000                    NOP     0

      741    17263    5            GOTO FORM_OPTS_LOOP;

  17263  4 002077   001346 710000 4                  TRA     FORM_OPTS_LOOP

      742    17264
      743    17265        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:178  
      744    17266    5            SELECT( 30 /* F_ACCESS */, 61 /*F_ACCESS_ADD_VAL */, 62
             17266                     /*F_ACCESS_REM_VAL */ );

      745    17267    5            SUBS = PTR$->P$NODE.SUBNODES;

  17267  4 002100   100001 236100                    LDQ     1,,PR1
         4 002101   000022 772000                    QRL     18
         4 002102   200021 756100                    STQ     SUBS,,AUTO

      746    17268        /*
      747    17269
      748    17270              1000 words will be used to save the access info
      749    17271              each account entered in this structure will take
      750    17272              two words, so we have room for about 500
      751    17273
      752    17274              first build a pointer to the data segment that was
      753    17275              returned from ASB$GETSEG.
      754    17276
      755    17277              Access will begin at word 1000 of the first
      756    17278              data segment that was gotten.  It will be 1000
      757    17279              words long
      758    17280
      759    17281        */
      760    17282    6            IF ACCSS$ = ADDR(NIL) THEN DO;

  17282  4 002103   000003 236000 2                  LDQ     ACCSS$
         4 002104   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 002105   002116 601000 4                  TNZ     s:17286

      761    17283    6               ACCSS$ = PINCRW(DSEG1$,ACCSS_OFFSET) ;

  17283  4 002106   000001 236000 3                  LDQ     ACCSS_OFFSET
         4 002107   000022 736000                    QLS     18
         4 002110   000000 036000 xsym               ADLQ    DSEG1$
         4 002111   000003 756000 2                  STQ     ACCSS$

      762    17284    6               ACCSS$->FS$ACCESS.TNAMES = 0;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:179  

  17284  4 002112   000003 473400 2                  LDP3    ACCSS$
         4 002113   000100 100400                    MLR     fill='000'O
         4 002114   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 002115   300000 000004                    ADSC9   0,,PR3                   cn=0,n=4

      763    17285    6               END;

      764    17286    6            IF CODE = 30 /* F_ACCESS */ THEN DO;

  17286  4 002116   000000 235000 xsym               LDA     CODE
         4 002117   000036 115007                    CMPA    30,DL
         4 002120   002132 601000 4                  TNZ     s:17290

      765    17287    6               ACCSS$->FS$ACCESS.TNAMES = 0;

  17287  4 002121   000003 470400 2                  LDP0    ACCSS$
         4 002122   000100 100400                    MLR     fill='000'O
         4 002123   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 002124   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4

      766    17288    6               IF SUBS = 0 THEN F$->FS$FORMREC.ACCSDISP = 0 ;

  17288  4 002125   200021 235100                    LDA     SUBS,,AUTO
         4 002126   002132 601000 4                  TNZ     s:17290

  17288  4 002127   000000 221003                    LDX1    0,DU
         4 002130   204051 473500                    LDP3    F$,,AUTO
         4 002131   300002 441100                    SXL1    2,,PR3

      767    17289    6               END;

      768    17290    6            DO K = 0 TO SUBS -1;

  17290  4 002132   204055 450100                    STZ     K,,AUTO
         4 002133   002357 710000 4                  TRA     F_ACCESS_LOOP_END+3

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:180  
      769    17291    6               BLK$ = PTR$->P$NODE.SUBLK$(K);

  17291  4 002134   204060 470500                    LDP0    PTR$,,AUTO
         4 002135   204055 720100                    LXL0    K,,AUTO
         4 002136   000003 236110                    LDQ     3,X0,PR0
         4 002137   204050 756100                    STQ     BLK$,,AUTO

      770    17292    7               IF OUT$SYM.COUNT > 8 THEN DO;

  17292  4 002140   204050 471500                    LDP1    BLK$,,AUTO
         4 002141   100004 236100                    LDQ     4,,PR1
         4 002142   777000 376003                    ANQ     -512,DU
         4 002143   011000 116003                    CMPQ    4608,DU
         4 002144   002162 602000 4                  TNC     s:17316

      771    17293        /*E* ERROR: ASF-E$BADACCESS-0
      772    17294             MESSAGE: ACCESS terminal name too long: "%U1".
      773    17295             MESSAGE1: Terminal names must not be more than 8 characters long.
      774    17296        */
      775    17297    7                  AS_FIELD1.COUNT = OUT$SYM.COUNT;

  17297  4 002145   100004 236100                    LDQ     4,,PR1
         4 002146   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      776    17298    7                  AS_FIELD1.TEXT = OUT$SYM.TEXT;

  17298  4 002147   100004 236100                    LDQ     4,,PR1
         4 002150   000033 772000                    QRL     27
         4 002151   000000 621006                    EAX1    0,QL
         4 002152   040000 100540                    MLR     fill='040'O
         4 002153   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 002154   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      777    17299                       %SCREAM( ERR#=E$BADACCESS,MID='F',LEVEL=ERROR);

  17311  4 002155   000044 630400 5                  EPPR0   36
         4 002156   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:181  
         4 002157   000000 701000 xent               TSX1    ASH$ERROR
         4 002160   000000 011000                    NOP     0

      778    17314    7                  GOTO F_ACCESS_LOOP_END;

  17314  4 002161   002354 710000 4                  TRA     F_ACCESS_LOOP_END

      779    17315    7                  END;
      780    17316    7               IF CODE = 30 /* F_ACCESS */ THEN DO;

  17316  4 002162   000000 235000 xsym               LDA     CODE
         4 002163   000036 115007                    CMPA    30,DL
         4 002164   002210 601000 4                  TNZ     s:17321

      781    17317    7                  ACCSS$->FS$ACCESS.LIST(K) = OUT$SYM.TEXT;

  17317  4 002165   100004 236100                    LDQ     4,,PR1
         4 002166   000033 772000                    QRL     27
         4 002167   204055 235100                    LDA     K,,AUTO
         4 002170   000003 735000                    ALS     3
         4 002171   000000 621006                    EAX1    0,QL
         4 002172   000003 473400 2                  LDP3    ACCSS$
         4 002173   040105 100540                    MLR     fill='040'O
         4 002174   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 002175   300001 000010                    ADSC9   1,A,PR3                  cn=0,n=8

      782    17318    7                  ACCSS$->FS$ACCESS.TNAMES = ACCSS$->FS$ACCESS.TNAMES+1;

  17318  4 002176   000100 100500                    MLR     fill='000'O
         4 002177   300000 000004                    ADSC9   0,,PR3                   cn=0,n=4
         4 002200   204111 000004                    ADSC9   @MAX_VAL+2,,AUTO         cn=0,n=4
         4 002201   204111 236100                    LDQ     @MAX_VAL+2,,AUTO
         4 002202   000001 036007                    ADLQ    1,DL
         4 002203   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 002204   000100 100500                    MLR     fill='000'O
         4 002205   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 002206   300000 000004                    ADSC9   0,,PR3                   cn=0,n=4
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:182  

      783    17319    7                  END;

  17319  4 002207   002354 710000 4                  TRA     F_ACCESS_LOOP_END

      784    17320    7               ELSE DO;

      785    17321    7                  L = 0;

  17321  4 002210   204056 450100                    STZ     L,,AUTO

      786    17322    8                  DO WHILE( L < ACCSS$->FS$ACCESS.TNAMES );

  17322  4 002211   000003 473400 2                  LDP3    ACCSS$
         4 002212   000100 100500                    MLR     fill='000'O
         4 002213   300000 000004                    ADSC9   0,,PR3                   cn=0,n=4
         4 002214   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 002215   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 002216   204056 116100                    CMPQ    L,,AUTO
         4 002217   002246 602000 4                  TNC     s:17327
         4 002220   002246 600000 4                  TZE     s:17327

      787    17323    8                     IF ACCSS$->FS$ACCESS.LIST(L) = OUT$SYM.TEXT

  17323  4 002221   204050 470500                    LDP0    BLK$,,AUTO
         4 002222   000004 236100                    LDQ     4,,PR0
         4 002223   000033 772000                    QRL     27
         4 002224   204056 235100                    LDA     L,,AUTO
         4 002225   000003 735000                    ALS     3
         4 002226   000003 471400 2                  LDP1    ACCSS$
         4 002227   000000 620006                    EAX0    0,QL
         4 002230   040140 106505                    CMPC    fill='040'O
         4 002231   100001 000010                    ADSC9   1,A,PR1                  cn=0,n=8
         4 002232   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 002233   002311 600000 4                  TZE     FOUND_ACCESS

      788    17324    8                     THEN GOTO FOUND_ACCESS;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:183  
      789    17325    8                     L = L + 1;

  17325  4 002234   204056 235100                    LDA     L,,AUTO
         4 002235   000001 035007                    ADLA    1,DL
         4 002236   204056 755100                    STA     L,,AUTO

      790    17326    8                     END;

  17326  4 002237   000100 100500                    MLR     fill='000'O
         4 002240   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         4 002241   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 002242   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 002243   204056 116100                    CMPQ    L,,AUTO
         4 002244   002246 600000 4                  TZE     s:17327
         4 002245   002221 603000 4                  TRC     s:17323

      791    17327    8                  IF CODE = 62 /*F_ACCESS_REM_VAL */ THEN DO;

  17327  4 002246   000000 235000 xsym               LDA     CODE
         4 002247   000076 115007                    CMPA    62,DL
         4 002250   002267 601000 4                  TNZ     s:17350

      792    17328        /*E* ERROR:   ASF-E$F_ACCESS_NO_EXIST-C
      793    17329             MESSAGE: %U1 does not exist in the ACCESS list.
      794    17330        */
      795    17331    8                     AS_FIELD1.COUNT = OUT$SYM.COUNT;

  17331  4 002251   204050 470500                    LDP0    BLK$,,AUTO
         4 002252   000004 236100                    LDQ     4,,PR0
         4 002253   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      796    17332    8                     AS_FIELD1.TEXT  = OUT$SYM.TEXT;

  17332  4 002254   000004 236100                    LDQ     4,,PR0
         4 002255   000033 772000                    QRL     27
         4 002256   000000 620006                    EAX0    0,QL
         4 002257   040000 100540                    MLR     fill='040'O
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:184  
         4 002260   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 002261   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      797    17333                          %SCREAM(ERR#=E$F_ACCESS_NO_EXIST,LEVEL=WARN,MID='F');

  17343  4 002262   000045 630400 5                  EPPR0   37
         4 002263   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002264   000000 701000 xent               TSX1    ASH$WARN
         4 002265   000000 011000                    NOP     0

      798    17348    8                     END;

  17348  4 002266   002307 710000 4                  TRA     s:17353

      799    17349    8                  ELSE DO;

      800    17350    8                     ACCSS$->FS$ACCESS.LIST(L) = OUT$SYM.TEXT;

  17350  4 002267   204050 470500                    LDP0    BLK$,,AUTO
         4 002270   000004 236100                    LDQ     4,,PR0
         4 002271   000033 772000                    QRL     27
         4 002272   204056 235100                    LDA     L,,AUTO
         4 002273   000003 735000                    ALS     3
         4 002274   000000 620006                    EAX0    0,QL
         4 002275   000003 471400 2                  LDP1    ACCSS$
         4 002276   040105 100540                    MLR     fill='040'O
         4 002277   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 002300   100001 000010                    ADSC9   1,A,PR1                  cn=0,n=8

      801    17351    8                     ACCSS$->FS$ACCESS.TNAMES = L + 1;

  17351  4 002301   204056 236100                    LDQ     L,,AUTO
         4 002302   000001 036007                    ADLQ    1,DL
         4 002303   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 002304   000100 100500                    MLR     fill='000'O
         4 002305   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 002306   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:185  

      802    17352    8                     END;

      803    17353    8                  DO WHILE( AS_FALSE );

  17353  4 002307   000000 234000 xsym               SZN     AS_FALSE
         4 002310   002354 605000 4                  TPL     F_ACCESS_LOOP_END

      804    17354    9   FOUND_ACCESS:     IF CODE = 62 /*F_ACCESS_REM_VAL */ THEN DO;

  17354  4 002311   000000 235000 xsym  FOUND_ACCESS LDA     CODE
         4 002312   000076 115007                    CMPA    62,DL
         4 002313   002352 601000 4                  TNZ     s:17360

      805    17355   10                        DO M = L+1 TO ACCSS$->FS$ACCESS.TNAMES-1;

  17355  4 002314   204056 236100                    LDQ     L,,AUTO
         4 002315   000001 036007                    ADLQ    1,DL
         4 002316   204057 756100                    STQ     M,,AUTO
         4 002317   002331 710000 4                  TRA     s:17357+3

      806    17356   10                           ACCSS$->FS$ACCESS.LIST(M-1) = ACCSS$->FS$ACCESS.LIST(M);

  17356  4 002320   204057 235100                    LDA     M,,AUTO
         4 002321   000003 735000                    ALS     3
         4 002322   000003 470400 2                  LDP0    ACCSS$
         4 002323   040105 100505                    MLR     fill='040'O
         4 002324   000001 000010                    ADSC9   1,A,PR0                  cn=0,n=8
         4 002325   077777 000010                    ADSC9   -1,A,PR0                 cn=0,n=8

      807    17357   10                           END;

  17357  4 002326   204057 236100                    LDQ     M,,AUTO
         4 002327   000001 036007                    ADLQ    1,DL
         4 002330   204057 756100                    STQ     M,,AUTO
         4 002331   000003 470400 2                  LDP0    ACCSS$
         4 002332   000100 100500                    MLR     fill='000'O
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:186  
         4 002333   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         4 002334   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 002335   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 002336   204057 116100                    CMPQ    M,,AUTO
         4 002337   002341 600000 4                  TZE     s:17358
         4 002340   002320 603000 4                  TRC     s:17356

      808    17358    9                        ACCSS$->FS$ACCESS.TNAMES = ACCSS$->FS$ACCESS.TNAMES-1;

  17358  4 002341   000100 100500                    MLR     fill='000'O
         4 002342   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         4 002343   204111 000004                    ADSC9   @MAX_VAL+2,,AUTO         cn=0,n=4
         4 002344   204111 236100                    LDQ     @MAX_VAL+2,,AUTO
         4 002345   000001 136007                    SBLQ    1,DL
         4 002346   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 002347   000100 100500                    MLR     fill='000'O
         4 002350   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 002351   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4

      809    17359    9                        END;

      810    17360    8                     END;

  17360  4 002352   000000 234000 xsym               SZN     AS_FALSE
         4 002353   002311 604000 4                  TMI     FOUND_ACCESS

      811    17361    7                  END;

      812    17362    6   F_ACCESS_LOOP_END:
      813    17363    6               END; /*  K loop     */

  17363  4 002354   204055 235100       F_ACCESS_LO* LDA     K,,AUTO
         4 002355   000001 035007                    ADLA    1,DL
         4 002356   204055 755100                    STA     K,,AUTO
         4 002357   204055 236100                    LDQ     K,,AUTO
         4 002360   200021 116100                    CMPQ    SUBS,,AUTO
         4 002361   002134 602000 4                  TNC     s:17291
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:187  
         4 002362   003043 710000 4                  TRA     s:17561

      814    17364        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:188  
      815    17365    5            SELECT( 31 /* F_BANNER */ );

      816    17366    5            CALL BANNER(0);

  17366  4 002363   000021 236000 5                  LDQ     17
         4 002364   204073 756100                    STQ     FOUND+2,,AUTO
         4 002365   004031 701000 4                  TSX1    BANNER
         4 002366   000000 011000                    NOP     0

      817    17367    5            GOTO FORM_OPTS_LOOP;

  17367  4 002367   001346 710000 4                  TRA     FORM_OPTS_LOOP

      818    17368
      819    17369    5            SELECT( 32 /* F_ALIGNMENT */ );

      820    17370    5            CALL BANNER(1);

  17370  4 002370   000031 236000 5                  LDQ     25
         4 002371   204073 756100                    STQ     FOUND+2,,AUTO
         4 002372   004031 701000 4                  TSX1    BANNER
         4 002373   000000 011000                    NOP     0

      821    17371    5            GOTO FORM_OPTS_LOOP;

  17371  4 002374   001346 710000 4                  TRA     FORM_OPTS_LOOP

      822    17372
      823    17373    5            SELECT( 65 /*F_REMOVE_BANNER_VAL*/ );

      824    17374    5            BNNR$ = ADDR(NIL);

  17374  4 002375   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 002376   000004 756000 2                  STQ     BNNR$

      825    17375    5            OLD_BANNER = '0'B;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:189  
  17375  4 002377   000000 450000 2                  STZ     OLD_BANNER
         4 002400   003043 710000 4                  TRA     s:17561

      826    17376
      827    17377    5            SELECT( 66 /*F_REMOVE_ALIGN_VAL*/ );

      828    17378    5            ALGN$ = ADDR(NIL);

  17378  4 002401   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 002402   000005 756000 2                  STQ     ALGN$

      829    17379    5            OLD_ALGN = '0'B;

  17379  4 002403   000001 450000 2                  STZ     OLD_ALGN
         4 002404   003043 710000 4                  TRA     s:17561

      830    17380
      831    17381        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:190  
      832    17382    5            SELECT( 35 /* F_ACCOUNT  */, 63 /*F_ACCOUNT_ADD_VAL */, 64
             17382                     /*F_ACCOUNT_REM_VAL */ );

      833    17383    5            SUBS = PTR$->P$NODE.SUBNODES ;

  17383  4 002405   100001 236100                    LDQ     1,,PR1
         4 002406   000022 772000                    QRL     18
         4 002407   200021 756100                    STQ     SUBS,,AUTO

      834    17384        /*
      835    17385
      836    17386              1000 words will be used to save the accounts info
      837    17387              each account entered in this structure will take
      838    17388              two words, so we have room for about 500
      839    17389        */
      840    17390        /*
      841    17391
      842    17392              First build a pointer to the data segment that was
      843    17393              returned from ABS$GETSEG
      844    17394
      845    17395              accounts will begin at word zero of the first
      846    17396              data segment that was gotten.  It will be 1000
      847    17397              words long
      848    17398
      849    17399        */
      850    17400    6            IF ACCNT$ = ADDR(NIL) THEN DO;

  17400  4 002410   000002 236000 2                  LDQ     ACCNT$
         4 002411   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 002412   002423 601000 4                  TNZ     s:17407

      851    17401    6               ACCNT$ = PINCRW(DSEG1$,ACCNT_OFFSET) ;

  17401  4 002413   000000 236000 3                  LDQ     ACCNT_OFFSET
         4 002414   000022 736000                    QLS     18
         4 002415   000000 036000 xsym               ADLQ    DSEG1$
         4 002416   000002 756000 2                  STQ     ACCNT$
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:191  

      852    17402    6               ACCNT$->FS$ACCOUNTS.TACCTS = 0;

  17402  4 002417   000002 473400 2                  LDP3    ACCNT$
         4 002420   000100 100400                    MLR     fill='000'O
         4 002421   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 002422   300000 000004                    ADSC9   0,,PR3                   cn=0,n=4

      853    17403    6               END;

      854    17404        /*
      855    17405
      856    17406        */
      857    17407    6            IF CODE = 35 /* F_ACCOUNT  */ THEN DO;

  17407  4 002423   000000 235000 xsym               LDA     CODE
         4 002424   000043 115007                    CMPA    35,DL
         4 002425   002437 601000 4                  TNZ     s:17411

      858    17408    6               ACCNT$->FS$ACCOUNTS.TACCTS = 0 ;

  17408  4 002426   000002 470400 2                  LDP0    ACCNT$
         4 002427   000100 100400                    MLR     fill='000'O
         4 002430   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 002431   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4

      859    17409    6               IF SUBS = 0 THEN F$->FS$FORMREC.ACCTDISP = 0;

  17409  4 002432   200021 235100                    LDA     SUBS,,AUTO
         4 002433   002437 601000 4                  TNZ     s:17411

  17409  4 002434   000000 221003                    LDX1    0,DU
         4 002435   204051 473500                    LDP3    F$,,AUTO
         4 002436   300001 441100                    SXL1    1,,PR3

      860    17410    6               END;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:192  
      861    17411    6            DO K = 0 TO SUBS -1;

  17411  4 002437   204055 450100                    STZ     K,,AUTO
         4 002440   002661 710000 4                  TRA     F_ACCOUNT_LOOP_END+3

      862    17412    6               BLK$ = PTR$->P$NODE.SUBLK$(K);

  17412  4 002441   204060 470500                    LDP0    PTR$,,AUTO
         4 002442   204055 720100                    LXL0    K,,AUTO
         4 002443   000003 236110                    LDQ     3,X0,PR0
         4 002444   204050 756100                    STQ     BLK$,,AUTO

      863    17413    7               IF OUT$SYM.COUNT > 8 THEN DO;

  17413  4 002445   204050 471500                    LDP1    BLK$,,AUTO
         4 002446   100004 236100                    LDQ     4,,PR1
         4 002447   777000 376003                    ANQ     -512,DU
         4 002450   011000 116003                    CMPQ    4608,DU
         4 002451   002467 602000 4                  TNC     s:17437

      864    17414        /*E* ERROR: ASF-E$BADACCOUNT-0
      865    17415             MESSAGE: Account name too long: "%U1".
      866    17416             MESSAGE1: Account names must not be more than 8 characters long.
      867    17417        */
      868    17418    7                  AS_FIELD1.COUNT = OUT$SYM.COUNT;

  17418  4 002452   100004 236100                    LDQ     4,,PR1
         4 002453   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      869    17419    7                  AS_FIELD1.TEXT  = OUT$SYM.TEXT;

  17419  4 002454   100004 236100                    LDQ     4,,PR1
         4 002455   000033 772000                    QRL     27
         4 002456   000000 621006                    EAX1    0,QL
         4 002457   040000 100540                    MLR     fill='040'O
         4 002460   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 002461   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:193  

      870    17420                       %SCREAM( ERR#=E$BADACCOUNT ,MID='F',LEVEL=ERROR);

  17432  4 002462   000046 630400 5                  EPPR0   38
         4 002463   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002464   000000 701000 xent               TSX1    ASH$ERROR
         4 002465   000000 011000                    NOP     0

      871    17435    7                  GOTO F_ACCOUNT_LOOP_END;

  17435  4 002466   002656 710000 4                  TRA     F_ACCOUNT_LOOP_END

      872    17436    7                  END;
      873    17437    7               IF CODE = 35 /* F_ACCOUNT  */ THEN DO;

  17437  4 002467   000000 235000 xsym               LDA     CODE
         4 002470   000043 115007                    CMPA    35,DL
         4 002471   002515 601000 4                  TNZ     s:17442

      874    17438    7                  ACCNT$->FS$ACCOUNTS.LIST(K) = OUT$SYM.TEXT;

  17438  4 002472   100004 236100                    LDQ     4,,PR1
         4 002473   000033 772000                    QRL     27
         4 002474   204055 235100                    LDA     K,,AUTO
         4 002475   000003 735000                    ALS     3
         4 002476   000000 621006                    EAX1    0,QL
         4 002477   000002 473400 2                  LDP3    ACCNT$
         4 002500   040105 100540                    MLR     fill='040'O
         4 002501   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 002502   300001 000010                    ADSC9   1,A,PR3                  cn=0,n=8

      875    17439    7                  ACCNT$->FS$ACCOUNTS.TACCTS = ACCNT$->FS$ACCOUNTS.TACCTS + 1;

  17439  4 002503   000100 100500                    MLR     fill='000'O
         4 002504   300000 000004                    ADSC9   0,,PR3                   cn=0,n=4
         4 002505   204111 000004                    ADSC9   @MAX_VAL+2,,AUTO         cn=0,n=4
         4 002506   204111 236100                    LDQ     @MAX_VAL+2,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:194  
         4 002507   000001 036007                    ADLQ    1,DL
         4 002510   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 002511   000100 100500                    MLR     fill='000'O
         4 002512   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 002513   300000 000004                    ADSC9   0,,PR3                   cn=0,n=4

      876    17440    7                  END;

  17440  4 002514   002656 710000 4                  TRA     F_ACCOUNT_LOOP_END

      877    17441    7               ELSE DO;

      878    17442    7                  L = 0;

  17442  4 002515   204056 450100                    STZ     L,,AUTO

      879    17443    8                  DO WHILE( L < ACCNT$->FS$ACCOUNTS.TACCTS );

  17443  4 002516   000002 473400 2                  LDP3    ACCNT$
         4 002517   000100 100500                    MLR     fill='000'O
         4 002520   300000 000004                    ADSC9   0,,PR3                   cn=0,n=4
         4 002521   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 002522   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 002523   204056 116100                    CMPQ    L,,AUTO
         4 002524   002553 602000 4                  TNC     s:17448
         4 002525   002553 600000 4                  TZE     s:17448

      880    17444    8                     IF ACCNT$->FS$ACCOUNTS.LIST(L) = OUT$SYM.TEXT

  17444  4 002526   204050 470500                    LDP0    BLK$,,AUTO
         4 002527   000004 236100                    LDQ     4,,PR0
         4 002530   000033 772000                    QRL     27
         4 002531   204056 235100                    LDA     L,,AUTO
         4 002532   000003 735000                    ALS     3
         4 002533   000002 471400 2                  LDP1    ACCNT$
         4 002534   000000 620006                    EAX0    0,QL
         4 002535   040140 106505                    CMPC    fill='040'O
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:195  
         4 002536   100001 000010                    ADSC9   1,A,PR1                  cn=0,n=8
         4 002537   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 002540   002615 600000 4                  TZE     FOUND_ACCOUNT

      881    17445    8                     THEN GOTO FOUND_ACCOUNT;
      882    17446    8                     L = L + 1;

  17446  4 002541   204056 235100                    LDA     L,,AUTO
         4 002542   000001 035007                    ADLA    1,DL
         4 002543   204056 755100                    STA     L,,AUTO

      883    17447    8                     END;

  17447  4 002544   000100 100500                    MLR     fill='000'O
         4 002545   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         4 002546   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 002547   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 002550   204056 116100                    CMPQ    L,,AUTO
         4 002551   002553 600000 4                  TZE     s:17448
         4 002552   002526 603000 4                  TRC     s:17444

      884    17448    8                  IF CODE = 64 /*F_ACCOUNT_REM_VAL */ THEN DO;

  17448  4 002553   000000 235000 xsym               LDA     CODE
         4 002554   000100 115007                    CMPA    64,DL
         4 002555   002574 601000 4                  TNZ     s:17471

      885    17449        /*E* ERROR:   ASF-E$F_ACCOUNT_NO_EXIST-C
      886    17450             MESSAGE: %U1 does not exist in the ACCOUNT list.
      887    17451        */
      888    17452    8                     AS_FIELD1.COUNT = OUT$SYM.COUNT;

  17452  4 002556   204050 470500                    LDP0    BLK$,,AUTO
         4 002557   000004 236100                    LDQ     4,,PR0
         4 002560   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      889    17453    8                     AS_FIELD1.TEXT  = OUT$SYM.TEXT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:196  

  17453  4 002561   000004 236100                    LDQ     4,,PR0
         4 002562   000033 772000                    QRL     27
         4 002563   000000 620006                    EAX0    0,QL
         4 002564   040000 100540                    MLR     fill='040'O
         4 002565   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 002566   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      890    17454                          %SCREAM(ERR#=E$F_ACCOUNT_NO_EXIST,LEVEL=WARN,MID='F');

  17464  4 002567   000047 630400 5                  EPPR0   39
         4 002570   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002571   000000 701000 xent               TSX1    ASH$WARN
         4 002572   000000 011000                    NOP     0

      891    17469    8                     END;

  17469  4 002573   002614 710000 4                  TRA     s:17474

      892    17470    8                  ELSE DO;

      893    17471    8                     ACCNT$->FS$ACCOUNTS.LIST(L) = OUT$SYM.TEXT;

  17471  4 002574   204050 470500                    LDP0    BLK$,,AUTO
         4 002575   000004 236100                    LDQ     4,,PR0
         4 002576   000033 772000                    QRL     27
         4 002577   204056 235100                    LDA     L,,AUTO
         4 002600   000003 735000                    ALS     3
         4 002601   000000 620006                    EAX0    0,QL
         4 002602   000002 471400 2                  LDP1    ACCNT$
         4 002603   040105 100540                    MLR     fill='040'O
         4 002604   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 002605   100001 000010                    ADSC9   1,A,PR1                  cn=0,n=8

      894    17472    8                     ACCNT$->FS$ACCOUNTS.TACCTS = L + 1;

  17472  4 002606   204056 236100                    LDQ     L,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:197  
         4 002607   000001 036007                    ADLQ    1,DL
         4 002610   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 002611   000100 100500                    MLR     fill='000'O
         4 002612   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 002613   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4

      895    17473    8                     END;

      896    17474    8                  DO WHILE( '0'B );

  17474  4 002614   002656 710000 4                  TRA     F_ACCOUNT_LOOP_END

      897    17475    9   FOUND_ACCOUNT:    IF CODE = 64 /*F_ACCOUNT_REM_VAL */ THEN DO;

  17475  4 002615   000000 235000 xsym  FOUND_ACCOU* LDA     CODE
         4 002616   000100 115007                    CMPA    64,DL
         4 002617   002656 601000 4                  TNZ     F_ACCOUNT_LOOP_END

      898    17476   10                        DO M = L+1 TO ACCNT$->FS$ACCOUNTS.TACCTS-1;

  17476  4 002620   204056 235100                    LDA     L,,AUTO
         4 002621   000001 035007                    ADLA    1,DL
         4 002622   204057 755100                    STA     M,,AUTO
         4 002623   002635 710000 4                  TRA     s:17478+3

      899    17477   10                          ACCNT$->FS$ACCOUNTS.LIST(M-1) = ACCNT$->FS$ACCOUNTS.LIST(M);

  17477  4 002624   204057 235100                    LDA     M,,AUTO
         4 002625   000003 735000                    ALS     3
         4 002626   000002 470400 2                  LDP0    ACCNT$
         4 002627   040105 100505                    MLR     fill='040'O
         4 002630   000001 000010                    ADSC9   1,A,PR0                  cn=0,n=8
         4 002631   077777 000010                    ADSC9   -1,A,PR0                 cn=0,n=8

      900    17478   10                           END;

  17478  4 002632   204057 236100                    LDQ     M,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:198  
         4 002633   000001 036007                    ADLQ    1,DL
         4 002634   204057 756100                    STQ     M,,AUTO
         4 002635   000002 470400 2                  LDP0    ACCNT$
         4 002636   000100 100500                    MLR     fill='000'O
         4 002637   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         4 002640   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 002641   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 002642   204057 116100                    CMPQ    M,,AUTO
         4 002643   002645 600000 4                  TZE     s:17479
         4 002644   002624 603000 4                  TRC     s:17477

      901    17479    9                        ACCNT$->FS$ACCOUNTS.TACCTS = ACCNT$->FS$ACCOUNTS.TACCTS-1;

  17479  4 002645   000100 100500                    MLR     fill='000'O
         4 002646   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         4 002647   204111 000004                    ADSC9   @MAX_VAL+2,,AUTO         cn=0,n=4
         4 002650   204111 236100                    LDQ     @MAX_VAL+2,,AUTO
         4 002651   000001 136007                    SBLQ    1,DL
         4 002652   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 002653   000100 100500                    MLR     fill='000'O
         4 002654   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 002655   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4

      902    17480    9                        END;

      903    17481    8                     END;

      904    17482    7                  END;

      905    17483    6   F_ACCOUNT_LOOP_END:
      906    17484    6               END; /*   K loop   */

  17484  4 002656   204055 235100       F_ACCOUNT_L* LDA     K,,AUTO
         4 002657   000001 035007                    ADLA    1,DL
         4 002660   204055 755100                    STA     K,,AUTO
         4 002661   204055 236100                    LDQ     K,,AUTO
         4 002662   200021 116100                    CMPQ    SUBS,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:199  
         4 002663   002441 602000 4                  TNC     s:17412
         4 002664   003043 710000 4                  TRA     s:17561

      907    17485
      908    17486    5            SELECT (36 /* F_CHAIN */) ;

      909    17487    5            BLK$ = PTR2$->P$NODE.SUBLK$(0);

  17487  4 002665   204061 473500                    LDP3    PTR2$,,AUTO
         4 002666   300003 236100                    LDQ     3,,PR3
         4 002667   204050 756100                    STQ     BLK$,,AUTO

      910    17488    5            IF OUT$SYM.COUNT > 8

  17488  4 002670   204050 474500                    LDP4    BLK$,,AUTO
         4 002671   400004 236100                    LDQ     4,,PR4
         4 002672   777000 376003                    ANQ     -512,DU
         4 002673   011000 116003                    CMPQ    4608,DU
         4 002674   002702 602000 4                  TNC     s:17511

      911    17489    6            THEN DO;

      912    17490        /*E* ERROR: ASF-E$CHARSETTOOBIG-C
      913    17491             MESSAGE: That charset name is too long.
      914    17492             MESSAGE1: The maximum size of a charset name is 8 characters.
      915    17493        */
      916    17494                    %SCREAM(ERR#=E$CHARSETTOOBIG,MID='F',LEVEL=ERROR);

  17506  4 002675   000050 630400 5                  EPPR0   40
         4 002676   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002677   000000 701000 xent               TSX1    ASH$ERROR
         4 002700   000000 011000                    NOP     0

      917    17509    6               END;

  17509  4 002701   003043 710000 4                  TRA     s:17561

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:200  
      918    17510    6            ELSE DO;

      919    17511    6               CHARSET_KEY.CNT = OUT$SYM.COUNT + 8;

  17511  4 002702   400004 236100                    LDQ     4,,PR4
         4 002703   000033 772000                    QRL     27
         4 002704   000010 036007                    ADLQ    8,DL
         4 002705   000033 736000                    QLS     27
         4 002706   200041 552140                    STBQ    CHARSET_KEY,'40'O,AUTO

      920    17512    6               CALL CONCAT (CHARSET_KEY.TXT, '~',

  17512  4 002707   400004 236100                    LDQ     4,,PR4
         4 002710   000033 772000                    QRL     27
         4 002711   000000 621006                    EAX1    0,QL
         4 002712   000176 236003                    LDQ     126,DU
         4 002713   200041 552120                    STBQ    CHARSET_KEY,'20'O,AUTO
         4 002714   040100 100540                    MLR     fill='040'O
         4 002715   400004 200011                    ADSC9   4,,PR4                   cn=1,n=*X1
         4 002716   200041 400017                    ADSC9   CHARSET_KEY,,AUTO        cn=2,n=15
         4 002717   000000 636011                    EAQ     0,X1
         4 002720   000022 772000                    QRL     18
         4 002721   000017 116007                    CMPQ    15,DL
         4 002722   002733 603000 4                  TRC     s:17514
         4 002723   204110 741100                    STX1    @MAX_VAL+1,,AUTO
         4 002724   777760 621011                    EAX1    -16,X1
         4 002725   777777 661003                    ERX1    -1,DU
         4 002726   204110 235100                    LDA     @MAX_VAL+1,,AUTO
         4 002727   000022 771000                    ARL     18
         4 002730   040145 100400                    MLR     fill='040'O
         4 002731   000041 000007 3                  ADSC9   TEXT_OFFSET+28           cn=0,n=7
         4 002732   200041 400011                    ADSC9   CHARSET_KEY,A,AUTO       cn=2,n=*X1

      921    17513    6                    SUBSTR(OUT$SYM.TEXT,0,OUT$SYM.COUNT),'CHARSET');
      922    17514    6               ARS = SIZEB(CHARSET);

  17514  4 002733   004270 235007                    LDA     2232,DL
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:201  
         4 002734   200020 755100                    STA     ARS,,AUTO

      923    17515    6               CALL ASF$READ_FORM (CHARSET_KEY, CHARSET$, ARS)

  17515  4 002735   200020 635500                    EPPR5   ARS,,AUTO
         4 002736   204112 455500                    STP5    @MAX_VAL+3,,AUTO
         4 002737   200012 636500                    EPPR6   CHARSET$,,AUTO
         4 002740   204111 456500                    STP6    @MAX_VAL+2,,AUTO
         4 002741   200041 637500                    EPPR7   CHARSET_KEY,,AUTO
         4 002742   204110 457500                    STP7    @MAX_VAL+1,,AUTO
         4 002743   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 002744   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 002745   000000 701000 xent               TSX1    ASF$READ_FORM
         4 002746   003001 702000 4                  TSX2    s:17523

      924    17516    7               WHENRETURN DO;

      925    17517    7                  F$->FS$FORMREC.LGLTYPS = CHARSET.LGLTYPS;

  17517  4 002747   204051 470500                    LDP0    F$,,AUTO
         4 002750   200012 471500                    LDP1    CHARSET$,,AUTO
         4 002751   100074 235100                    LDA     60,,PR1
         4 002752   100075 236100                    LDQ     61,,PR1
         4 002753   000022 773000                    LRL     18
         4 002754   000051 376000 5                  ANQ     41
         4 002755   000011 772000                    QRL     9
         4 002756   000004 552134                    STBQ    4,'34'O,PR0

      926    17518    7                  F$->FS$FORMREC.ATTR = CHARSET.ATTRS;

  17518  4 002757   200012 470500                    LDP0    CHARSET$,,AUTO
         4 002760   000074 220100                    LDX0    60,,PR0
         4 002761   204051 471500                    LDP1    F$,,AUTO
         4 002762   100005 740100                    STX0    5,,PR1

      927    17519    7                  F$->FS$FORMREC.CHAINIMAGE = CHARSET.CHAINIMAGE;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:202  
  17519  4 002763   200012 470500                    LDP0    CHARSET$,,AUTO
         4 002764   204051 471500                    LDP1    F$,,AUTO
         4 002765   040100 100500                    MLR     fill='040'O
         4 002766   000000 000360                    ADSC9   0,,PR0                   cn=0,n=240
         4 002767   100034 400360                    ADSC9   28,,PR1                  cn=2,n=240

      928    17520    7                  F$->FS$FORMREC.CHAIN_NAME = OUT$SYM.TEXT;

  17520  4 002770   204050 471500                    LDP1    BLK$,,AUTO
         4 002771   100004 236100                    LDQ     4,,PR1
         4 002772   000033 772000                    QRL     27
         4 002773   000000 620006                    EAX0    0,QL
         4 002774   204051 473500                    LDP3    F$,,AUTO
         4 002775   040100 100540                    MLR     fill='040'O
         4 002776   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         4 002777   300032 400010                    ADSC9   26,,PR3                  cn=2,n=8

      929    17521    7                  END;

  17521  4 003000   003027 710000 4                  TRA     s:17552

      930    17522    7               WHENALTRETURN DO;

      931    17523    7                  IF MERR_CODE.CODE ~= %E$NOREC

  17523  4 003001   000000 236000 xsym               LDQ     ERR_CODE
         4 003002   377770 376007                    ANQ     131064,DL
         4 003003   001260 116007                    CMPQ    688,DL
         4 003004   003023 600000 4                  TZE     s:17549

      932    17524    8                  THEN DO;

      933    17525        /*E* ERROR: ASF-E$BADCHAIN-C
      934    17526             MESSAGE: Charset %U1 does not exist.
      935    17527             MESSAGE1: Charsets must exist before their contents can move to
      936    17528                       the form definition.
      937    17529        */
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:203  
      938    17530    8                     AS_FIELD1.COUNT = OUT$SYM.COUNT;

  17530  4 003005   204050 470500                    LDP0    BLK$,,AUTO
         4 003006   000004 236100                    LDQ     4,,PR0
         4 003007   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      939    17531    8                     AS_FIELD1.TEXT = OUT$SYM.TEXT;

  17531  4 003010   000004 236100                    LDQ     4,,PR0
         4 003011   000033 772000                    QRL     27
         4 003012   000000 620006                    EAX0    0,QL
         4 003013   040000 100540                    MLR     fill='040'O
         4 003014   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 003015   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      940    17532                          %SCREAM(ERR#=E$BADCHAIN, MID='F', LEVEL=ERROR);

  17544  4 003016   000052 630400 5                  EPPR0   42
         4 003017   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003020   000000 701000 xent               TSX1    ASH$ERROR
         4 003021   000000 011000                    NOP     0

      941    17547    8                     END;

  17547  4 003022   003027 710000 4                  TRA     s:17552

      942    17548    8                  ELSE DO;

      943    17549    8                     CALL ASH$ERROR (P_PCB.ERROR);

  17549  4 003023   000030 630400 5                  EPPR0   24
         4 003024   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003025   000000 701000 xent               TSX1    ASH$ERROR
         4 003026   000000 011000                    NOP     0

      944    17550    8                     END;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:204  
      945    17551    7                  END;

      946    17552    6               END;

  17552  4 003027   003043 710000 4                  TRA     s:17561

      947    17553
      948    17554    5            SELECT ( 22 /* F_TRANSLGL */ );

      949    17555    5            TRANSLGL_SET = AS_TRUE;

  17555  4 003030   000000 236000 xsym               LDQ     AS_TRUE
         4 003031   400000 376003                    ANQ     -131072,DU
         4 003032   204067 756100                    STQ     TRANSLGL_SET,,AUTO

      950    17556    5            IF OP_CODE = 1 THEN

  17556  4 003033   204063 235100                    LDA     OP_CODE,,AUTO
         4 003034   000001 115007                    CMPA    1,DL
         4 003035   003040 601000 4                  TNZ     s:17559

      951    17557    5               TRANSLGL_VAL = AS_TRUE;

  17557  4 003036   204070 756100                    STQ     TRANSLGL_VAL,,AUTO
         4 003037   003043 710000 4                  TRA     s:17561

      952    17558    5            ELSE
      953    17559    5               TRANSLGL_VAL = AS_FALSE;

  17559  4 003040   000000 236000 xsym               LDQ     AS_FALSE
         4 003041   400000 376003                    ANQ     -131072,DU
         4 003042   204070 756100                    STQ     TRANSLGL_VAL,,AUTO

      954    17560    5            END DO_CASE;

      955    17561    4         END DO_J;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:205  
  17561  4 003043   204054 235100                    LDA     J,,AUTO
         4 003044   000001 035007                    ADLA    1,DL
         4 003045   204054 755100                    STA     J,,AUTO
         4 003046   204054 236100                    LDQ     J,,AUTO
         4 003047   204062 116100                    CMPQ    SUBNODES,,AUTO
         4 003050   001411 602000 4                  TNC     s:17055

  17547  4 003051                       FORM_OPTS_L* null
      956    17562    3   FORM_OPTS_LOOP_END:;
      957    17563    3      END;

  17563  4 003051   000000 234000 xsym               SZN     AS_TRUE
         4 003052   001363 604000 4                  TMI     s:17049

      958    17564    2   OPTS_ERR:
      959    17565    2   CALL ASH$ERROR ( P_PCB.ERROR );

  17565  4 003053   000030 630400 5     OPTS_ERR     EPPR0   24
         4 003054   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003055   000000 701000 xent               TSX1    ASH$ERROR
         4 003056   000000 011000                    NOP     0

      960    17566    2   GOTO FORM_OPTS_LOOP;

  17566  4 003057   001346 710000 4                  TRA     FORM_OPTS_LOOP

      961    17567        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:206  
      962    17568    2   VFUIM: PROC;

  17568  4 003060   204072 741300       VFUIM        STX1  ! FOUND+1,,AUTO

      963    17569    3   DCL MORE BIT(1);
      964    17570    3   DCL NUM UBIN WORD;
      965    17571    3   DCL I UBIN WORD;
      966    17572    3   DCL CHAN UBIN WORD;
      967    17573    3   DCL PTR$ PTR;
      968    17574    3   DCL CODE UBIN WORD;
      969    17575    3   DCL SUBNODES UBIN WORD;
      970    17576    3   DCL NEXT UBIN WORD;
      971    17577
      972    17578
      973    17579
      974    17580
      975    17581    3   CHECK_VFU_FLG = AS_FALSE;

  17581  4 003061   000000 236000 xsym               LDQ     AS_FALSE
         4 003062   400000 376003                    ANQ     -131072,DU
         4 003063   204066 756100                    STQ     CHECK_VFU_FLG,,AUTO

      976    17582    3   P_PCB.ROOT$ = ADDR( F_VFU_LIST );

  17582  4 003064   000053 236000 5                  LDQ     43
         4 003065   000001 756000 xsym               STQ     P_PCB+1

      977    17583    3   MORE = AS_TRUE;

  17583  4 003066   000000 236000 xsym               LDQ     AS_TRUE
         4 003067   400000 376003                    ANQ     -131072,DU
         4 003070   204073 756100                    STQ     MORE,,AUTO

      978    17584    3   F$->FS$FORMREC.SOFTFORM.VFUIM.V = '0'B;

  17584  4 003071   204051 470500                    LDP0    F$,,AUTO
         4 003072   000100 100400                    MLR     fill='000'O
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:207  
         4 003073   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 003074   000012 400100                    ADSC9   10,,PR0                  cn=2,n=64

      979    17585    3   NUM = 0;

  17585  4 003075   204074 450100                    STZ     NUM,,AUTO

      980    17586    3   NEXT = 16;

  17586  4 003076   000020 235007                    LDA     16,DL
         4 003077   204102 755100                    STA     NEXT,,AUTO

      981    17587    4   VFU_LOOP: DO WHILE( MORE );

  17587  4 003100   204073 234100       VFU_LOOP     SZN     MORE,,AUTO
         4 003101   003322 605000 4                  TPL     VFU_NUM

      982    17588    4      CALL ASB$SET_PROMPT ( %PROMPT_SUB );

  17588  4 003102   000054 630400 5                  EPPR0   44
         4 003103   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003104   000000 701000 xent               TSX1    ASB$SET_PROMPT
         4 003105   000000 011000                    NOP     0

      983    17589    4      CALL ASB$READ_SI( IN_BUF,ARS );

  17589  4 003106   200020 630500                    EPPR0   ARS,,AUTO
         4 003107   204111 450500                    STP0    @MAX_VAL+2,,AUTO
         4 003110   000034 236000 5                  LDQ     28
         4 003111   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 003112   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 003113   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003114   000000 701000 xent               TSX1    ASB$READ_SI
         4 003115   000000 011000                    NOP     0

      984    17590    4      P_PCB.NCHARS= ARS;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:208  
  17590  4 003116   200020 235100                    LDA     ARS,,AUTO
         4 003117   000011 755000 xsym               STA     P_PCB+9

      985    17591    4      CALL X$PARSE( P_PCB ) ALTRET (VFU_ERR);

  17591  4 003120   000003 630400 5                  EPPR0   3
         4 003121   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003122   000000 701000 xent               TSX1    X$PARSE
         4 003123   003330 702000 4                  TSX2    VFU_ERR

      986    17592    4      NODE$=P_PCB.OUT$;

  17592  4 003124   000003 236000 xsym               LDQ     P_PCB+3
         4 003125   000000 756000 xsym               STQ     NODE$

      987    17593    5   DO_I: DO I = 0 TO P$NODE.SUBNODES -1;

  17593  4 003126   204075 450100       DO_I         STZ     I,,AUTO
         4 003127   003312 710000 4                  TRA     s:17647+3

      988    17594    5         PTR$=P$NODE.SUBLK$(I);

  17594  4 003130   000000 470400 xsym               LDP0    NODE$
         4 003131   204075 720100                    LXL0    I,,AUTO
         4 003132   000003 236110                    LDQ     3,X0,PR0
         4 003133   204077 756100                    STQ     PTR$,,AUTO

      989    17595    5         CODE=PTR$->P$NODE.CODE;

  17595  4 003134   204077 471500                    LDP1    PTR$,,AUTO
         4 003135   100000 236100                    LDQ     0,,PR1
         4 003136   777777 376007                    ANQ     -1,DL
         4 003137   204100 756100                    STQ     CODE,,AUTO

      990    17596    6   DO_CASE: DO SELECT (CODE);

  17596  4 003140   000454 116007       DO_CASE      CMPQ    300,DL
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:209  
         4 003141   003151 602000 4                  TNC     DO_CASE+9
         4 003142   003172 600000 4                  TZE     s:17602
         4 003143   000455 116007                    CMPQ    301,DL
         4 003144   003307 602000 4                  TNC     s:17647
         4 003145   003166 600000 4                  TZE     s:17600
         4 003146   000456 116007                    CMPQ    302,DL
         4 003147   003307 601000 4                  TNZ     s:17647
         4 003150   003162 710000 4                  TRA     s:17598
         4 003151   000032 116007                    CMPQ    26,DL
         4 003152   003157 602000 4                  TNC     DO_CASE+15
         4 003153   003176 600000 4                  TZE     s:17604
         4 003154   000051 116007                    CMPQ    41,DL
         4 003155   003307 601000 4                  TNZ     s:17647
         4 003156   003200 710000 4                  TRA     s:17606
         4 003157   000014 116007                    CMPQ    12,DL
         4 003160   003307 601000 4                  TNZ     s:17647
         4 003161   003176 710000 4                  TRA     s:17604

      991    17597    6            SELECT( 302 /* HELP_VAL */ );

      992    17598    6            CALL ASH$HELP;

  17598  4 003162   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 003163   000000 701000 xent               TSX1    ASH$HELP
         4 003164   000000 011000                    NOP     0
         4 003165   003307 710000 4                  TRA     s:17647

      993    17599    6            SELECT( 301 /* QUESTION_VAL */ );

      994    17600    6            CALL ASH$QUEST;

  17600  4 003166   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 003167   000000 701000 xent               TSX1    ASH$QUEST
         4 003170   000000 011000                    NOP     0
         4 003171   003307 710000 4                  TRA     s:17647

      995    17601    6            SELECT( 300 /* DQUESTION_VAL */ );
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:210  

      996    17602    6            CALL ASH$DQUEST;

  17602  4 003172   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 003173   000000 701000 xent               TSX1    ASH$DQUEST
         4 003174   000000 011000                    NOP     0
         4 003175   003307 710000 4                  TRA     s:17647

      997    17603    6            SELECT(12   /*  END_VAL  */,26   /*  BLANK_LINE_VAL */);

      998    17604    6            RETURN;

  17604  4 003176   204072 221300                    LDX1  ! FOUND+1,,AUTO
         4 003177   000001 702211                    TSX2  ! 1,X1

      999    17605    6            SELECT(41 /* FV_CHAN_VAL */);

     1000    17606    6            PTR2$=PTR$->P$NODE.SUBLK$(0);

  17606  4 003200   100003 236100                    LDQ     3,,PR1
         4 003201   204061 756100                    STQ     PTR2$,,AUTO

     1001    17607    6            BLK$=PTR2$;

  17607  4 003202   204050 756100                    STQ     BLK$,,AUTO

     1002    17608    6            CALL CHARBIN( VAL,OUT$SYM.TEXT);

  17608  4 003203   204050 473500                    LDP3    BLK$,,AUTO
         4 003204   300004 236100                    LDQ     4,,PR3
         4 003205   000033 772000                    QRL     27
         4 003206   000000 621006                    EAX1    0,QL
         4 003207   000100 305540                    DTB
         4 003210   300004 230011                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
         4 003211   204110 000010                    NDSC9   @MAX_VAL+1,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         4 003212   204111 235100                    LDA     @MAX_VAL+2,,AUTO
         4 003213   204064 755100                    STA     VAL,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:211  

     1003    17609    7            IF VAL < 1 OR VAL > 15 THEN DO;

  17609  4 003214   003217 600000 4                  TZE     s:17625
         4 003215   000020 115007                    CMPA    16,DL
         4 003216   003224 602000 4                  TNC     s:17630

     1004    17610        /*E* ERROR: ASF-E$BADCHAN-0
     1005    17611             MESSAGE: CHAN must be 1 to 15.
     1006    17612        */
     1007    17613                    %SCREAM( ERR#=E$BADCHAN,MID='F',LEVEL=ERROR);

  17625  4 003217   000055 630400 5                  EPPR0   45
         4 003220   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003221   000000 701000 xent               TSX1    ASH$ERROR
         4 003222   000000 011000                    NOP     0

     1008    17628    7               GOTO VFU_LOOP;

  17628  4 003223   003100 710000 4                  TRA     VFU_LOOP

     1009    17629    7               END;
     1010    17630    6            CHAN=VAL;

  17630  4 003224   204076 755100                    STA     CHAN,,AUTO

     1011    17631    6            BLK$=PTR$->P$NODE.SUBLK$(1);

  17631  4 003225   100004 236100                    LDQ     4,,PR1
         4 003226   204050 756100                    STQ     BLK$,,AUTO

     1012    17632    6            CALL GET_VFU_VAL ALTRET(VFU_LOOP);

  17632  4 003227   003335 701000 4                  TSX1    GET_VFU_VAL
         4 003230   003100 702000 4                  TSX2    VFU_LOOP

     1013    17633    6            NUM = NUM+1;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:212  

  17633  4 003231   204074 235100                    LDA     NUM,,AUTO
         4 003232   000001 035007                    ADLA    1,DL
         4 003233   204074 755100                    STA     NUM,,AUTO

     1014    17634    6            IF NUM > 29 THEN GOTO VFU_NUM;

  17634  4 003234   000036 115007                    CMPA    30,DL
         4 003235   003322 603000 4                  TRC     VFU_NUM

     1015    17635    6            F$->FS$FORMREC.SOFTFORM.VFUIM.V.LINE(CHAN) = VAL;

  17635  4 003236   204051 470500                    LDP0    F$,,AUTO
         4 003237   204076 236100                    LDQ     CHAN,,AUTO
         4 003240   000106 101500                    MRL     fill='000'O
         4 003241   204064 000004                    ADSC9   VAL,,AUTO                cn=0,n=4
         4 003242   000012 400001                    ADSC9   10,Q,PR0                 cn=2,n=1

     1016    17636    7            DO K = 2 TO PTR$->P$NODE.SUBNODES -1;

  17636  4 003243   000002 235007                    LDA     2,DL
         4 003244   204055 755100                    STA     K,,AUTO
         4 003245   003301 710000 4                  TRA     s:17645+3

     1017    17637    7               BLK$=PTR$->P$NODE.SUBLK$(K);

  17637  4 003246   204077 470500                    LDP0    PTR$,,AUTO
         4 003247   204055 720100                    LXL0    K,,AUTO
         4 003250   000003 236110                    LDQ     3,X0,PR0
         4 003251   204050 756100                    STQ     BLK$,,AUTO

     1018    17638    7               CALL GET_VFU_VAL ALTRET(VFU_LOOP);

  17638  4 003252   003335 701000 4                  TSX1    GET_VFU_VAL
         4 003253   003100 702000 4                  TSX2    VFU_LOOP

     1019    17639    7               NUM = NUM+1;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:213  

  17639  4 003254   204074 235100                    LDA     NUM,,AUTO
         4 003255   000001 035007                    ADLA    1,DL
         4 003256   204074 755100                    STA     NUM,,AUTO

     1020    17640    7               IF NUM > 29 THEN GOTO VFU_NUM;

  17640  4 003257   000036 115007                    CMPA    30,DL
         4 003260   003322 603000 4                  TRC     VFU_NUM

     1021    17641    7               F$->FS$FORMREC.SOFTFORM.VFUIM.V.LINE(NEXT) = VAL;

  17641  4 003261   204051 470500                    LDP0    F$,,AUTO
         4 003262   204102 236100                    LDQ     NEXT,,AUTO
         4 003263   000106 101500                    MRL     fill='000'O
         4 003264   204064 000004                    ADSC9   VAL,,AUTO                cn=0,n=4
         4 003265   000012 400001                    ADSC9   10,Q,PR0                 cn=2,n=1

     1022    17642    7               F$->FS$FORMREC.SOFTFORM.VFUIM.V.NEXT(CHAN) = NEXT;

  17642  4 003266   204051 470500                    LDP0    F$,,AUTO
         4 003267   204076 235100                    LDA     CHAN,,AUTO
         4 003270   000105 101500                    MRL     fill='000'O
         4 003271   204102 000004                    ADSC9   NEXT,,AUTO               cn=0,n=4
         4 003272   000022 400001                    ADSC9   18,A,PR0                 cn=2,n=1

     1023    17643    7               CHAN=NEXT;

  17643  4 003273   204076 756100                    STQ     CHAN,,AUTO

     1024    17644    7               NEXT=NEXT+1;

  17644  4 003274   000001 036007                    ADLQ    1,DL
         4 003275   204102 756100                    STQ     NEXT,,AUTO

     1025    17645    7               END;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:214  
  17645  4 003276   204055 235100                    LDA     K,,AUTO
         4 003277   000001 035007                    ADLA    1,DL
         4 003300   204055 755100                    STA     K,,AUTO
         4 003301   204077 470500                    LDP0    PTR$,,AUTO
         4 003302   000001 236100                    LDQ     1,,PR0
         4 003303   000022 772000                    QRL     18
         4 003304   204055 116100                    CMPQ    K,,AUTO
         4 003305   003307 600000 4                  TZE     s:17647
         4 003306   003246 603000 4                  TRC     s:17637

     1026    17646    6            END DO_CASE;

     1027    17647    5         END DO_I;

  17647  4 003307   204075 235100                    LDA     I,,AUTO
         4 003310   000001 035007                    ADLA    1,DL
         4 003311   204075 755100                    STA     I,,AUTO
         4 003312   000000 470400 xsym               LDP0    NODE$
         4 003313   000001 236100                    LDQ     1,,PR0
         4 003314   000022 772000                    QRL     18
         4 003315   204075 116100                    CMPQ    I,,AUTO
         4 003316   003320 600000 4                  TZE     s:17648
         4 003317   003130 603000 4                  TRC     s:17594

     1028    17648    4      END VFU_LOOP;

  17648  4 003320   204073 234100                    SZN     MORE,,AUTO
         4 003321   003102 604000 4                  TMI     s:17588

     1029    17649    3   VFU_NUM:
     1030    17650        /*E* ERROR: ASF-E$VFUCOUNT-0
     1031    17651             MESSAGE: Too many VFU values.
     1032    17652             MESSAGE1: There can be no more than 29 VFU values.
     1033    17653        */
     1034    17654        %SCREAM( ERR#=E$VFUCOUNT ,MID='F',LEVEL=ERROR);

  17666  4 003322   000056 630400 5     VFU_NUM      EPPR0   46
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:215  
         4 003323   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003324   000000 701000 xent               TSX1    ASH$ERROR
         4 003325   000000 011000                    NOP     0

     1035    17669    3   RETURN;

  17669  4 003326   204072 221300                    LDX1  ! FOUND+1,,AUTO
         4 003327   000001 702211                    TSX2  ! 1,X1

     1036    17670
     1037    17671
     1038    17672    3   VFU_ERR:
     1039    17673    3   CALL ASH$ERROR( P_PCB.ERROR );

  17673  4 003330   000030 630400 5     VFU_ERR      EPPR0   24
         4 003331   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003332   000000 701000 xent               TSX1    ASH$ERROR
         4 003333   000000 011000                    NOP     0

     1040    17674    3   GOTO VFU_LOOP;

  17674  4 003334   003100 710000 4                  TRA     VFU_LOOP

     1041    17675
     1042    17676
     1043    17677
     1044    17678    3   GET_VFU_VAL: PROC ALTRET;

  17678  4 003335   204104 741300       GET_VFU_VAL  STX1  ! FC_LEN+1,,AUTO

     1045    17679
     1046    17680    4   DCL J SBIN;
     1047    17681
     1048    17682    4   CALL CHARBIN( VAL, OUT$SYM.TEXT );

  17682  4 003336   204050 470500                    LDP0    BLK$,,AUTO
         4 003337   000004 236100                    LDQ     4,,PR0
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:216  
         4 003340   000033 772000                    QRL     27
         4 003341   000000 620006                    EAX0    0,QL
         4 003342   000100 305540                    DTB
         4 003343   000004 230010                    NDSC9   4,,PR0                   cn=1,s=nosgn,sf=0,n=*X0
         4 003344   204110 000010                    NDSC9   @MAX_VAL+1,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         4 003345   204111 235100                    LDA     @MAX_VAL+2,,AUTO
         4 003346   204064 755100                    STA     VAL,,AUTO

     1049    17683    5   DO J = 0 TO 31 ;

  17683  4 003347   204105 450100                    STZ     J,,AUTO

     1050    17684    6      IF VAL = F$->FS$FORMREC.SOFTFORM.VFUIM.V.LINE (J) THEN DO;

  17684  4 003350   204051 470500                    LDP0    F$,,AUTO
         4 003351   204105 235100                    LDA     J,,AUTO
         4 003352   000100 101505                    MRL     fill='000'O
         4 003353   000012 400001                    ADSC9   10,A,PR0                 cn=2,n=1
         4 003354   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 003355   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 003356   204064 116100                    CMPQ    VAL,,AUTO
         4 003357   003400 601000 4                  TNZ     s:17735

     1051    17685        /*E* ERROR : ASF-E$VFUVAL_EXISTS-C
     1052    17686             MESSAGE: VFU value %U1 cannot be defined twice.
     1053    17687        */
     1054    17688              %NUMBER (NUM1 = VAL) ;
             17696    6         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, VAL );

  17696  4 003360   204064 631500                    EPPR1   VAL,,AUTO
         4 003361   204113 451500                    STP1    @MAX_VAL+4,,AUTO
         4 003362   000057 236000 5                  LDQ     47
         4 003363   204112 756100                    STQ     @MAX_VAL+3,,AUTO
         4 003364   000060 237000 5                  LDAQ    48
         4 003365   204110 757100                    STAQ    @MAX_VAL+1,,AUTO
         4 003366   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 003367   000022 631400 xsym               EPPR1   B_VECTNIL+18
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:217  
         4 003370   000000 701000 xent               TSX1    ASB$BINCHAR
         4 003371   000000 011000                    NOP     0

     1055    17718              %SCREAM (ERR#=E$VFUVAL_EXISTS,LEVEL=ERROR,MID = 'F') ;

  17730  4 003372   000062 630400 5                  EPPR0   50
         4 003373   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003374   000000 701000 xent               TSX1    ASH$ERROR
         4 003375   000000 011000                    NOP     0

     1056    17733    6         ALTRETURN ;

  17733  4 003376   204104 221300                    LDX1  ! FC_LEN+1,,AUTO
         4 003377   000000 702211                    TSX2  ! 0,X1

     1057    17734    6         END ;
     1058    17735    5      END;

  17735  4 003400   204105 054100                    AOS     J,,AUTO
         4 003401   204105 235100                    LDA     J,,AUTO
         4 003402   000037 115007                    CMPA    31,DL
         4 003403   003350 604400 4                  TMOZ    s:17684

     1059    17736    5   IF VAL > 511 THEN DO;

  17736  4 003404   204064 235100                    LDA     VAL,,AUTO
         4 003405   001000 115007                    CMPA    512,DL
         4 003406   003415 602000 4                  TNC     s:17757

     1060    17737        /*E* ERROR: ASF-E$VFUVAL-C
     1061    17738             MESSAGE: VFU values must not exceed 511.
     1062    17739        */
     1063    17740           %SCREAM( ERR#=E$VFUVAL,MID='F',LEVEL=ERROR);

  17752  4 003407   000063 630400 5                  EPPR0   51
         4 003410   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003411   000000 701000 xent               TSX1    ASH$ERROR
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:218  
         4 003412   000000 011000                    NOP     0

     1064    17755    5      ALTRETURN;

  17755  4 003413   204104 221300                    LDX1  ! FC_LEN+1,,AUTO
         4 003414   000000 702211                    TSX2  ! 0,X1

     1065    17756    5      END;
     1066    17757    4   J = F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LENGTH;

  17757  4 003415   000006 236100                    LDQ     6,,PR0
         4 003416   000022 772000                    QRL     18
         4 003417   000777 376007                    ANQ     511,DL
         4 003420   204105 756100                    STQ     J,,AUTO

     1067    17758    5   IF F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LIMBO = 0 THEN DO;

  17758  4 003421   000006 236100                    LDQ     6,,PR0
         4 003422   777000 316007                    CANQ    -512,DL
         4 003423   003454 601000 4                  TNZ     s:17813

     1068    17759    6      IF VAL >= J - 1 THEN DO;

  17759  4 003424   204105 236100                    LDQ     J,,AUTO
         4 003425   000001 136007                    SBLQ    1,DL
         4 003426   003432 604000 4                  TMI     s:17763
         4 003427   204064 116100                    CMPQ    VAL,,AUTO
         4 003430   003432 600000 4                  TZE     s:17763
         4 003431   003500 603000 4                  TRC     s:17866

     1069    17760        /*E* ERROR: ASF-E$VFU_LENGTH_1-C
     1070    17761             MESSAGE: VFU value must be less than LENGTH-1 ( %U1 ) when LIMBO = 0.
     1071    17762        */
     1072    17763    6         J = J - 1;

  17763  4 003432   000001 336007                    LCQ     1,DL
         4 003433   204105 056100                    ASQ     J,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:219  

     1073    17764              %NUMBER( NUM1=J );
             17772    6         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, J );

  17772  4 003434   204105 631500                    EPPR1   J,,AUTO
         4 003435   204113 451500                    STP1    @MAX_VAL+4,,AUTO
         4 003436   000057 236000 5                  LDQ     47
         4 003437   204112 756100                    STQ     @MAX_VAL+3,,AUTO
         4 003440   000060 237000 5                  LDAQ    48
         4 003441   204110 757100                    STAQ    @MAX_VAL+1,,AUTO
         4 003442   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 003443   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 003444   000000 701000 xent               TSX1    ASB$BINCHAR
         4 003445   000000 011000                    NOP     0

     1074    17794              %SCREAM( ERR#=E$VFU_LENGTH_1, LEVEL=ERROR, MID='F' );

  17806  4 003446   000064 630400 5                  EPPR0   52
         4 003447   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003450   000000 701000 xent               TSX1    ASH$ERROR
         4 003451   000000 011000                    NOP     0

     1075    17809    6         ALTRETURN;

  17809  4 003452   204104 221300                    LDX1  ! FC_LEN+1,,AUTO
         4 003453   000000 702211                    TSX2  ! 0,X1

     1076    17810    6         END;
     1077    17811    5      END;
     1078    17812    4   ELSE
     1079    17813    5      IF VAL >= J THEN DO;

  17813  4 003454   204064 236100                    LDQ     VAL,,AUTO
         4 003455   003460 604000 4                  TMI     s:17825
         4 003456   204105 116100                    CMPQ    J,,AUTO
         4 003457   003500 604000 4                  TMI     s:17866

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:220  
     1080    17814        /*E* ERROR: ASF-E$VFU_LENGTH-C
     1081    17815             MESSAGE: VFU value must be less than LENGTH ( %U1 ).
     1082    17816        */
     1083    17817              %NUMBER( NUM1=J );
             17825    5         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, J );

  17825  4 003460   204105 631500                    EPPR1   J,,AUTO
         4 003461   204113 451500                    STP1    @MAX_VAL+4,,AUTO
         4 003462   000057 236000 5                  LDQ     47
         4 003463   204112 756100                    STQ     @MAX_VAL+3,,AUTO
         4 003464   000060 237000 5                  LDAQ    48
         4 003465   204110 757100                    STAQ    @MAX_VAL+1,,AUTO
         4 003466   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 003467   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 003470   000000 701000 xent               TSX1    ASB$BINCHAR
         4 003471   000000 011000                    NOP     0

     1084    17847              %SCREAM( ERR#=E$VFU_LENGTH, MID='F', LEVEL=ERROR );

  17859  4 003472   000065 630400 5                  EPPR0   53
         4 003473   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003474   000000 701000 xent               TSX1    ASH$ERROR
         4 003475   000000 011000                    NOP     0

     1085    17862    5         ALTRETURN;

  17862  4 003476   204104 221300                    LDX1  ! FC_LEN+1,,AUTO
         4 003477   000000 702211                    TSX2  ! 0,X1

     1086    17863    5         END;
     1087    17864
     1088    17865
     1089    17866    4   END GET_VFU_VAL;

  17866  4 003500   204104 221300                    LDX1  ! FC_LEN+1,,AUTO
         4 003501   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:221  
     1090    17867
     1091    17868
     1092    17869
     1093    17870
     1094    17871    3   END VFUIM;
     1095    17872
     1096    17873
     1097    17874        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:222  
     1098    17875    2   CHECK_VFU_IMAGE: PROC;

  17875  4 003502   204072 741300       CHECK_VFU_I* STX1  ! FOUND+1,,AUTO

     1099    17876
     1100    17877    3   DCL VAL SBIN;
     1101    17878    3   DCL CHAN SBIN;
     1102    17879    3   DCL NEXT SBIN;
     1103    17880
     1104    17881
     1105    17882    4   DO CHAN = 1 TO 15;

  17882  4 003503   000001 235007                    LDA     1,DL
         4 003504   204074 755100                    STA     CHAN,,AUTO

     1106    17883    4      VAL = F$->FS$FORMREC.SOFTFORM.VFUIM.V.LINE(CHAN);

  17883  4 003505   204051 470500                    LDP0    F$,,AUTO
         4 003506   204074 235100                    LDA     CHAN,,AUTO
         4 003507   000100 101505                    MRL     fill='000'O
         4 003510   000012 400001                    ADSC9   10,A,PR0                 cn=2,n=1
         4 003511   204073 000004                    ADSC9   VAL,,AUTO                cn=0,n=4

     1107    17884    4      CALL CHECK_VFU_VAL ALTRET(EXIT#);

  17884  4 003512   003547 701000 4                  TSX1    CHECK_VFU_VAL
         4 003513   003545 702000 4                  TSX2    EXIT#

     1108    17885    4      NEXT = F$->FS$FORMREC.SOFTFORM.VFUIM.V.NEXT(CHAN);

  17885  4 003514   204051 470500                    LDP0    F$,,AUTO
         4 003515   204074 235100                    LDA     CHAN,,AUTO
         4 003516   000100 101505                    MRL     fill='000'O
         4 003517   000022 400001                    ADSC9   18,A,PR0                 cn=2,n=1
         4 003520   204075 000004                    ADSC9   NEXT,,AUTO               cn=0,n=4

     1109    17886    5      DO WHILE( NEXT ~= 0 );
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:223  

  17886  4 003521   204075 236100                    LDQ     NEXT,,AUTO
         4 003522   003541 600000 4                  TZE     s:17891

     1110    17887    5         VAL = F$->FS$FORMREC.SOFTFORM.VFUIM.V.LINE(NEXT);

  17887  4 003523   204051 470500                    LDP0    F$,,AUTO
         4 003524   204075 235100                    LDA     NEXT,,AUTO
         4 003525   000100 101505                    MRL     fill='000'O
         4 003526   000012 400001                    ADSC9   10,A,PR0                 cn=2,n=1
         4 003527   204073 000004                    ADSC9   VAL,,AUTO                cn=0,n=4

     1111    17888    5         CALL CHECK_VFU_VAL ALTRET(EXIT#);

  17888  4 003530   003547 701000 4                  TSX1    CHECK_VFU_VAL
         4 003531   003545 702000 4                  TSX2    EXIT#

     1112    17889    5         NEXT = F$->FS$FORMREC.SOFTFORM.VFUIM.V.NEXT(VAL);

  17889  4 003532   204051 470500                    LDP0    F$,,AUTO
         4 003533   204073 235100                    LDA     VAL,,AUTO
         4 003534   000100 101505                    MRL     fill='000'O
         4 003535   000022 400001                    ADSC9   18,A,PR0                 cn=2,n=1
         4 003536   204075 000004                    ADSC9   NEXT,,AUTO               cn=0,n=4

     1113    17890    5         END;

  17890  4 003537   204075 236100                    LDQ     NEXT,,AUTO
         4 003540   003523 601000 4                  TNZ     s:17887

     1114    17891    4      END;

  17891  4 003541   204074 054100                    AOS     CHAN,,AUTO
         4 003542   204074 235100                    LDA     CHAN,,AUTO
         4 003543   000017 115007                    CMPA    15,DL
         4 003544   003505 604400 4                  TMOZ    s:17883

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:224  
     1115    17892    3   EXIT#:
     1116    17893    3   RETURN;

  17893  4 003545   204072 221300       EXIT#        LDX1  ! FOUND+1,,AUTO
         4 003546   000001 702211                    TSX2  ! 1,X1

     1117    17894
     1118    17895
     1119    17896
     1120    17897    3   CHECK_VFU_VAL: PROC  ALTRET;

  17897  4 003547   204076 741300       CHECK_VFU_V* STX1  ! CHAN,,AUTO

     1121    17898
     1122    17899
     1123    17900    4   DCL J   SBIN;
     1124    17901
     1125    17902
     1126    17903    4   J = F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LENGTH;

  17903  4 003550   204051 470500                    LDP0    F$,,AUTO
         4 003551   000006 236100                    LDQ     6,,PR0
         4 003552   000022 772000                    QRL     18
         4 003553   000777 376007                    ANQ     511,DL
         4 003554   204077 756100                    STQ     J,,AUTO

     1127    17904    5   IF F$->FS$FORMREC.SOFTFORM.VLPPLATEN.LIMBO = 0 THEN DO;

  17904  4 003555   000006 236100                    LDQ     6,,PR0
         4 003556   777000 316007                    CANQ    -512,DL
         4 003557   003636 601000 4                  TNZ     s:17961

     1128    17905    6      IF VAL >= J-1 THEN DO;

  17905  4 003560   204077 236100                    LDQ     J,,AUTO
         4 003561   000001 136007                    SBLQ    1,DL
         4 003562   204073 116100                    CMPQ    VAL,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:225  
         4 003563   003711 605400 4                  TPNZ    s:18015

     1129    17906        /*E* ERROR: ASF-E$RE_ENTER_VFU1-C
     1130    17907             MESSAGE: CHAN%U1 = %U2 must be less than LENGTH-1 ( %U3 ) when LIMBO = 0.
     1131    17908                      The VFU image must be re-entered.
     1132    17909        */
     1133    17910    6         J = J - 1;

  17910  4 003564   000001 336007                    LCQ     1,DL
         4 003565   204077 056100                    ASQ     J,,AUTO

     1134    17911              %NUMBER( NUM1=CHAN, NUM2=VAL, NUM3=J );
             17919    6         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, CHAN );

  17919  4 003566   204074 631500                    EPPR1   CHAN,,AUTO
         4 003567   204113 451500                    STP1    @MAX_VAL+4,,AUTO
         4 003570   000057 236000 5                  LDQ     47
         4 003571   204112 756100                    STQ     @MAX_VAL+3,,AUTO
         4 003572   000060 237000 5                  LDAQ    48
         4 003573   204110 757100                    STAQ    @MAX_VAL+1,,AUTO
         4 003574   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 003575   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 003576   000000 701000 xent               TSX1    ASB$BINCHAR
         4 003577   000000 011000                    NOP     0

             17927    6         CALL ASB$BINCHAR( AS_FIELD2.TEXT, 0, -2, VAL );

  17927  4 003600   204073 630500                    EPPR0   VAL,,AUTO
         4 003601   204113 450500                    STP0    @MAX_VAL+4,,AUTO
         4 003602   000017 236000 5                  LDQ     15
         4 003603   204112 756100                    STQ     @MAX_VAL+3,,AUTO
         4 003604   000020 237000 5                  LDAQ    16
         4 003605   204110 757100                    STAQ    @MAX_VAL+1,,AUTO
         4 003606   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 003607   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 003610   000000 701000 xent               TSX1    ASB$BINCHAR
         4 003611   000000 011000                    NOP     0
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:226  

             17935    6         CALL ASB$BINCHAR( AS_FIELD3.TEXT, 0, -3, J );

  17935  4 003612   204077 630500                    EPPR0   J,,AUTO
         4 003613   204113 450500                    STP0    @MAX_VAL+4,,AUTO
         4 003614   000023 236000 5                  LDQ     19
         4 003615   204112 756100                    STQ     @MAX_VAL+3,,AUTO
         4 003616   000024 237000 5                  LDAQ    20
         4 003617   204110 757100                    STAQ    @MAX_VAL+1,,AUTO
         4 003620   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 003621   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 003622   000000 701000 xent               TSX1    ASB$BINCHAR
         4 003623   000000 011000                    NOP     0

     1135    17941              %SCREAM( ERR#=E$RE_ENTER_VFU1, LEVEL=ERROR, MID='F' );

  17953  4 003624   000066 630400 5                  EPPR0   54
         4 003625   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003626   000000 701000 xent               TSX1    ASH$ERROR
         4 003627   000000 011000                    NOP     0

     1136    17956    6         F$->FS$FORMREC.SOFTFORM.VFUIM.V = '0'B;

  17956  4 003630   204051 470500                    LDP0    F$,,AUTO
         4 003631   000100 100400                    MLR     fill='000'O
         4 003632   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 003633   000012 400100                    ADSC9   10,,PR0                  cn=2,n=64

     1137    17957    6         ALTRETURN;

  17957  4 003634   204076 221300                    LDX1  ! CHAN,,AUTO
         4 003635   000000 702211                    TSX2  ! 0,X1

     1138    17958    6         END;
     1139    17959    5      END;
     1140    17960    4   ELSE
     1141    17961    5      IF VAL >= J THEN DO;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:227  

  17961  4 003636   204073 236100                    LDQ     VAL,,AUTO
         4 003637   204077 116100                    CMPQ    J,,AUTO
         4 003640   003711 604000 4                  TMI     s:18015

     1142    17962        /*E* ERROR: ASF-E$RE_ENTER_VFU2-C
     1143    17963             MESSAGE: CHAN%U1 = %U2 must be less than LENGTH ( %U3 ).
     1144    17964                      The VFU image must be re-entered.
     1145    17965        */
     1146    17966              %NUMBER( NUM1=CHAN, NUM2=VAL, NUM3=J );
             17974    5         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, CHAN );

  17974  4 003641   204074 631500                    EPPR1   CHAN,,AUTO
         4 003642   204113 451500                    STP1    @MAX_VAL+4,,AUTO
         4 003643   000057 236000 5                  LDQ     47
         4 003644   204112 756100                    STQ     @MAX_VAL+3,,AUTO
         4 003645   000060 237000 5                  LDAQ    48
         4 003646   204110 757100                    STAQ    @MAX_VAL+1,,AUTO
         4 003647   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 003650   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 003651   000000 701000 xent               TSX1    ASB$BINCHAR
         4 003652   000000 011000                    NOP     0

             17982    5         CALL ASB$BINCHAR( AS_FIELD2.TEXT, 0, -2, VAL );

  17982  4 003653   204073 630500                    EPPR0   VAL,,AUTO
         4 003654   204113 450500                    STP0    @MAX_VAL+4,,AUTO
         4 003655   000017 236000 5                  LDQ     15
         4 003656   204112 756100                    STQ     @MAX_VAL+3,,AUTO
         4 003657   000020 237000 5                  LDAQ    16
         4 003660   204110 757100                    STAQ    @MAX_VAL+1,,AUTO
         4 003661   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 003662   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 003663   000000 701000 xent               TSX1    ASB$BINCHAR
         4 003664   000000 011000                    NOP     0

             17990    5         CALL ASB$BINCHAR( AS_FIELD3.TEXT, 0, -3, J );
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:228  

  17990  4 003665   204077 630500                    EPPR0   J,,AUTO
         4 003666   204113 450500                    STP0    @MAX_VAL+4,,AUTO
         4 003667   000023 236000 5                  LDQ     19
         4 003670   204112 756100                    STQ     @MAX_VAL+3,,AUTO
         4 003671   000024 237000 5                  LDAQ    20
         4 003672   204110 757100                    STAQ    @MAX_VAL+1,,AUTO
         4 003673   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 003674   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 003675   000000 701000 xent               TSX1    ASB$BINCHAR
         4 003676   000000 011000                    NOP     0

     1147    17996              %SCREAM( ERR#=E$RE_ENTER_VFU2, LEVEL=ERROR, MID='F' );

  18008  4 003677   000067 630400 5                  EPPR0   55
         4 003700   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003701   000000 701000 xent               TSX1    ASH$ERROR
         4 003702   000000 011000                    NOP     0

     1148    18011    5         F$->FS$FORMREC.SOFTFORM.VFUIM.V = '0'B;

  18011  4 003703   204051 470500                    LDP0    F$,,AUTO
         4 003704   000100 100400                    MLR     fill='000'O
         4 003705   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 003706   000012 400100                    ADSC9   10,,PR0                  cn=2,n=64

     1149    18012    5         ALTRETURN;

  18012  4 003707   204076 221300                    LDX1  ! CHAN,,AUTO
         4 003710   000000 702211                    TSX2  ! 0,X1

     1150    18013    5         END;
     1151    18014
     1152    18015    4   END CHECK_VFU_VAL;

  18015  4 003711   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:229  
     1153    18016
     1154    18017
     1155    18018    3   END CHECK_VFU_IMAGE;
     1156    18019        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:230  
     1157    18020    2   SETUP: PROC;

  18020  4 003712   204072 741300       SETUP        STX1  ! FOUND+1,,AUTO

     1158    18021
     1159    18022
     1160    18023    3   DCL I UBIN WORD;
     1161    18024    3   DCL CODE2 UBIN WORD;
     1162    18025        /*
     1163    18026              1500 words will be used to save the setup info
     1164    18027              this allows 83 lines of input
     1165    18028        */
     1166    18029        /*    First build a pointer to the data segment that was
     1167    18030              returned from ASB$GETSEG.
     1168    18031
     1169    18032              Setup will begin at word 0 of the second
     1170    18033              segment gotten
     1171    18034
     1172    18035        */
     1173    18036        /*
     1174    18037        */
     1175    18038    3   SETUP$ = PINCRW(DSEG2$,SETUP_OFFSET);       /* Ptr to our setup area   */

  18038  4 003713   000003 236000 3                  LDQ     SETUP_OFFSET
         4 003714   000022 736000                    QLS     18
         4 003715   000000 036000 xsym               ADLQ    DSEG2$
         4 003716   000006 756000 2                  STQ     SETUP$

     1176    18039    4   DO I = 0 TO 82;

  18039  4 003717   204073 450100                    STZ     I,,AUTO

     1177    18040    4      SETUP$->FS$SETUP.TXT(I) = ' ';

  18040  4 003720   204073 236100                    LDQ     I,,AUTO
         4 003721   000110 402007                    MPY     72,DL
         4 003722   000006 470400 2                  LDP0    SETUP$
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:231  
         4 003723   040106 100400                    MLR     fill='040'O
         4 003724   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 003725   000001 000110                    ADSC9   1,Q,PR0                  cn=0,n=72

     1178    18041    4      END;

  18041  4 003726   204073 235100                    LDA     I,,AUTO
         4 003727   000001 035007                    ADLA    1,DL
         4 003730   204073 755100                    STA     I,,AUTO
         4 003731   000123 115007                    CMPA    83,DL
         4 003732   003720 602000 4                  TNC     s:18040

     1179    18042    3   F$->FS$SETUP.LINES = 0 ;

  18042  4 003733   204051 471500                    LDP1    F$,,AUTO
         4 003734   000100 101400                    MRL     fill='000'O
         4 003735   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 003736   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

     1180    18043    3   CALL ASB$SET_PROMPT ( %PROMPT_TXT );

  18043  4 003737   000070 630400 5                  EPPR0   56
         4 003740   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003741   000000 701000 xent               TSX1    ASB$SET_PROMPT
         4 003742   000000 011000                    NOP     0

     1181    18044    3   I = 0;

  18044  4 003743   204073 450100                    STZ     I,,AUTO

     1182    18045    4   DO UNTIL( I = 83  OR  IN_BUF = ' ' );

     1183    18046    4      CALL ASB$READ_SI( IN_BUF,ARS);

  18046  4 003744   200020 630500                    EPPR0   ARS,,AUTO
         4 003745   204111 450500                    STP0    @MAX_VAL+2,,AUTO
         4 003746   000034 236000 5                  LDQ     28
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:232  
         4 003747   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 003750   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 003751   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003752   000000 701000 xent               TSX1    ASB$READ_SI
         4 003753   000000 011000                    NOP     0

     1184    18047    5      IF IN_BUF ~= ' ' THEN DO;

  18047  4 003754   040000 106400                    CMPC    fill='040'O
         4 003755   000000 000377 xsym               ADSC9   IN_BUF                   cn=0,n=255
         4 003756   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 003757   004001 600000 4                  TZE     s:18073

     1185    18048    6         IF ARS <= 72 THEN DO;

  18048  4 003760   200020 235100                    LDA     ARS,,AUTO
         4 003761   000111 115007                    CMPA    73,DL
         4 003762   003775 603000 4                  TRC     s:18068

     1186    18049    6            SETUP$ -> FS$SETUP.TXT(I) = IN_BUF;

  18049  4 003763   204073 236100                    LDQ     I,,AUTO
         4 003764   000110 402007                    MPY     72,DL
         4 003765   000006 470400 2                  LDP0    SETUP$
         4 003766   040106 100400                    MLR     fill='040'O
         4 003767   000000 000110 xsym               ADSC9   IN_BUF                   cn=0,n=72
         4 003770   000001 000110                    ADSC9   1,Q,PR0                  cn=0,n=72

     1187    18050    6            I = I + 1;

  18050  4 003771   204073 235100                    LDA     I,,AUTO
         4 003772   000001 035007                    ADLA    1,DL
         4 003773   204073 755100                    STA     I,,AUTO

     1188    18051    6            END;

  18051  4 003774   004001 710000 4                  TRA     s:18073
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:233  

     1189    18052    6         ELSE DO;

     1190    18053        /*E* ERROR: ASF-E$SETUPBAD-C
     1191    18054             MESSAGE: SETUP text must be 72 characters or less per line.
     1192    18055        */
     1193    18056                 %SCREAM( ERR#=E$SETUPBAD,MID='F',LEVEL=ERROR);

  18068  4 003775   000071 630400 5                  EPPR0   57
         4 003776   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003777   000000 701000 xent               TSX1    ASH$ERROR
         4 004000   000000 011000                    NOP     0

     1194    18071    6            END;

     1195    18072    5         END;

     1196    18073    4      END;        /* do until */

  18073  4 004001   204073 235100                    LDA     I,,AUTO
         4 004002   000123 115007                    CMPA    83,DL
         4 004003   004010 600000 4                  TZE     s:18074
         4 004004   040000 106400                    CMPC    fill='040'O
         4 004005   000000 000377 xsym               ADSC9   IN_BUF                   cn=0,n=255
         4 004006   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 004007   003744 601000 4                  TNZ     s:18046

     1197    18074    4   IF I = 83 THEN DO;

  18074  4 004010   000123 115007                    CMPA    83,DL
         4 004011   004016 601000 4                  TNZ     s:18094

     1198    18075        /*E* ERROR:   ASF-E$SETUP_FULL-C
     1199    18076             MESSAGE: SETUP buffer full, returning to 'OPT*' level.
     1200    18077        */
     1201    18078           %SCREAM( ERR#=E$SETUP_FULL, MID='F', LEVEL=WARN );

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:234  
  18088  4 004012   000072 630400 5                  EPPR0   58
         4 004013   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004014   000000 701000 xent               TSX1    ASH$WARN
         4 004015   000000 011000                    NOP     0

     1202    18093    4      END;

     1203    18094    3   SETUP$ -> FS$SETUP.LINES = I;

  18094  4 004016   000006 470400 2                  LDP0    SETUP$
         4 004017   000100 101500                    MRL     fill='000'O
         4 004020   204073 000004                    ADSC9   I,,AUTO                  cn=0,n=4
         4 004021   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1204    18095    3   IF I = 0 THEN F$ -> FS$FORMREC.SETUPDISP = 0;

  18095  4 004022   204073 235100                    LDA     I,,AUTO
         4 004023   004027 601000 4                  TNZ     s:18096

  18095  4 004024   000000 220003                    LDX0    0,DU
         4 004025   204051 471500                    LDP1    F$,,AUTO
         4 004026   100002 740100                    STX0    2,,PR1

     1205    18096    3   RETURN;

  18096  4 004027   204072 221300                    LDX1  ! FOUND+1,,AUTO
         4 004030   000001 702211                    TSX2  ! 1,X1

     1206    18097
     1207    18098
     1208    18099    3   END SETUP;
     1209    18100        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:235  
     1210    18101    2   BANNER: PROC (A);

  18101  4 004031   204072 741300       BANNER       STX1  ! FOUND+1,,AUTO

     1211    18102        /****************************************************************
     1212    18103        Banner proccesses the sub-options for both banners and alignments.
     1213    18104        The format is:
     1214    18105
     1215    18106        Ba[nner]
     1216    18107        al[ignment]
     1217    18108              these two options define the banner and alignment image for
     1218    18109              this form.  Super will ask for sub-options. They are:
     1219    18110              Ch[arge] [=yes|no]
     1220    18111                  legal only for banners.  This says whether or not to
     1221    18112                  charge the user for the banner pages.
     1222    18113                  If '=yes|no' is ommited, yes is assumed.
     1223    18114              Re[peats] = dec
     1224    18115                  this says how many times to repeat this entire banner or
     1225    18116                  alignment image.  If this option is ommited, it defaults
     1226    18117                  to one if there are any entries, and zero if there are none.
     1227    18118              Al[ign][every] [=yes|no]
     1228    18119                  legal only for alignment images.  This says whether to
     1229    18120                  print the alignment after every file or not. Default is no.
     1230    18121              En[try] = row,col[,font,strikes,icsh,reps,rinc,cinc]
     1231    18122                  this options defines one element of this banner or alignment,
     1232    18123                  and may be used as many times as needed. The values are:
     1233    18124
     1234    18125                  row : the row to start printing this element
     1235    18126                  col : the column to start at
     1236    18127                  font: The font to use. 0 means standard typing, 1-3 are
     1237    18128                         block-print fonts. 1 includes lower case.
     1238    18129                          defaults to zero.
     1239    18130                  strikes: how many times to overprint this element.
     1240    18131                  icsh: inter-charater spacing. defaults to 0 for font 0,
     1241    18132                          1 for fonts 1-3.
     1242    18133                  reps: how many times to repeat this element.
     1243    18134                  rinc: amount to increment the row each repeat.
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:236  
     1244    18135                  cinc: amount to increment the column each repeat.
     1245    18136
     1246    18137                  After typing the entry option, super will prompt with
     1247    18138                  'TXT*'.  at this point you can type one of the following:
     1248    18139
     1249    18140                  %SY[SID]      the sysid of the user whos output we are printing
     1250    18141                  %AC[CN]       the account name of the user.
     1251    18142                  %UN[AME]      the username of the user.
     1252    18143                  %WOO          the users work-station of origin.
     1253    18144                  %JO[BNAME]    the name the user specified on his job card.
     1254    18145                  %TI[ME]       the current time.
     1255    18146                  %DA[TE]       the current date.
     1256    18147                  %VE[RSION]    the system version.
     1257    18148                  %SU[BFILE]    the subfile number of this printout.
     1258    18149                  %LO[GO]       the standard CP-6 logo.
     1259    18150                  %WOD          the users work-station of destination.
     1260    18151                  %SI[TENAME]   the site name.
     1261    18152                  %SA[LUTE]     the standard system salutation
     1262    18153        %BAN[NERTEXT]0 the first of 10 bannertext fields, it should contain
     1263    18154                                              the registered name.
     1264    18155        %BAN[NERTEXT]1 the first bannertext field
     1265    18156        %BAN[NERTEXT]2 the second bannertext field
     1266    18157        %BAN[NERTEXT]3 the third bannertext field
     1267    18158        %BAN[NERTEXT]4 the fourth bannertext field
     1268    18159        %BAN[NERTEXT]5 the fifth bannertext field
     1269    18160        %BAN[NERTEXT]6 the sixth bannertext field
     1270    18161        %BAN[NERTEXT]7 the seventh bannertext field
     1271    18162        %BAN[NERTEXT]8 the eigth bannertext field
     1272    18163        %BAN[NERTEXT]9 the ninth bannertext field
     1273    18164        %RE[GISTEREDNAME] this is the registered name from mail!
     1274    18165                  %x     where x is any single charater.
     1275    18166                  Any text line, not starting with a '%'.
     1276    18167
     1277    18168                  For aligments, only %LOGO,%x or the line of text are
     1278    18169                  legal.  If a line of text was entered, that line will
     1279    18170                  be printed on the banner just as it is entered.
     1280    18171                  %x says to repeat the single charater x accross the whole
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:237  
     1281    18172                  line.  For the others, CP-6 will look up the value and
     1282    18173                  use that to print on the banner.  Note that for %LOGO,
     1283    18174                  the entry options 'font' and 'icsh' are ignored.
     1284    18175        *****************************************************************/
     1285    18176    3   DCL A UBIN WORD;
     1286    18177    3   DCL MORE BIT(1);
     1287    18178    3   DCL PTR$ PTR;
     1288    18179    3   DCL FB$ PTR;
     1289    18180    3   DCL CODE UBIN WORD;
     1290    18181    3   DCL CODE2 UBIN WORD;
     1291    18182    3   DCL SUBNODES UBIN WORD;
     1292    18183    3   DCL SUBNS UBIN WORD;
     1293    18184    3   DCL FC_CHAR CHAR(FC_LEN) BASED(FC$);
     1294    18185    3   DCL FC_LEN UBIN WORD;
     1295    18186    3   DCL FC_BIT BIT(FC_B_LEN) BASED(FB$);
     1296    18187    3   DCL FC_B_LEN UBIN WORD;
     1297    18188
     1298    18189
     1299    18190
     1300    18191
     1301    18192
     1302    18193    3   P_PCB.ROOT$ = ADDR( F_A_OR_B_LIST );

  18193  4 004032   000073 236000 5                  LDQ     59
         4 004033   000001 756000 xsym               STQ     P_PCB+1

     1303    18194    3   ENUM=0;

  18194  4 004034   200004 450100                    STZ     ENUM,,AUTO

     1304    18195    3   IF A = 0 THEN

  18195  4 004035   204073 470500                    LDP0    @A,,AUTO
         4 004036   000000 235100                    LDA     0,,PR0
         4 004037   004070 601000 4                  TNZ     s:18207

     1305    18196    4   DO;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:238  

     1306    18197    4      FB$ = PINCRW (DSEG1$,BNNR_OFFSET) ; /* Point to banner record   */

  18197  4 004040   000002 236000 3                  LDQ     BNNR_OFFSET
         4 004041   000022 736000                    QLS     18
         4 004042   000000 036000 xsym               ADLQ    DSEG1$
         4 004043   204076 756100                    STQ     FB$,,AUTO

     1307    18198    4      FC$ = PINCRW(DSEG1$,TEXT_OFFSET) ;

  18198  4 004044   000005 236000 3                  LDQ     TEXT_OFFSET
         4 004045   000022 736000                    QLS     18
         4 004046   000000 036000 xsym               ADLQ    DSEG1$
         4 004047   200006 756100                    STQ     FC$,,AUTO

     1308    18199    4      BNNR$ = FB$ ;

  18199  4 004050   204076 236100                    LDQ     FB$,,AUTO
         4 004051   000004 756000 2                  STQ     BNNR$

     1309    18200    4      FCB$ = ADDR(NIL);

  18200  4 004052   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 004053   200007 756100                    STQ     FCB$,,AUTO

     1310    18201    4      OLD_BANNER = '0'B;

  18201  4 004054   000000 450000 2                  STZ     OLD_BANNER

     1311    18202    4      FB$->FS$FINST.INTR = 1;

  18202  4 004055   204076 471500                    LDP1    FB$,,AUTO
         4 004056   000100 101400                    MRL     fill='000'O
         4 004057   000003 000004 xsym               ADSC9   B_VECTNIL+3              cn=0,n=4
         4 004060   100000 400001                    ADSC9   0,,PR1                   cn=2,n=1

     1312    18203    4      FB$->FS$FINST.CHARGE=1;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:239  

  18203  4 004061   000100 101400                    MRL     fill='000'O
         4 004062   000003 000004 xsym               ADSC9   B_VECTNIL+3              cn=0,n=4
         4 004063   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

     1313    18204    4      FB$->FS$FINST.REPEATS = 0;

  18204  4 004064   000100 101400                    MRL     fill='000'O
         4 004065   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 004066   100000 200001                    ADSC9   0,,PR1                   cn=1,n=1

     1314    18205    4      END;       /* End of banner pointer initialization   */

  18205  4 004067   004117 710000 4                  TRA     s:18216

     1315    18206    4   ELSE DO ;

     1316    18207    4      FB$ = PINCRW (DSEG2$,ALGN_OFFSET) ; /* Point to alignment record   */

  18207  4 004070   000004 236000 3                  LDQ     ALGN_OFFSET
         4 004071   000022 736000                    QLS     18
         4 004072   000000 036000 xsym               ADLQ    DSEG2$
         4 004073   204076 756100                    STQ     FB$,,AUTO

     1317    18208    4      FC$ = PINCRW(DSEG2$,TEXT_OFFSET) ;

  18208  4 004074   000005 236000 3                  LDQ     TEXT_OFFSET
         4 004075   000022 736000                    QLS     18
         4 004076   000000 036000 xsym               ADLQ    DSEG2$
         4 004077   200006 756100                    STQ     FC$,,AUTO

     1318    18209    4      ALGN$ = FB$ ;

  18209  4 004100   204076 236100                    LDQ     FB$,,AUTO
         4 004101   000005 756000 2                  STQ     ALGN$

     1319    18210    4      FCA$ = ADDR(NIL) ;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:240  

  18210  4 004102   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 004103   200010 756100                    STQ     FCA$,,AUTO

     1320    18211    4      OLD_ALGN = '0'B;

  18211  4 004104   000001 450000 2                  STZ     OLD_ALGN

     1321    18212    4      FB$->FS$FINST.INTR = 0;

  18212  4 004105   204076 471500                    LDP1    FB$,,AUTO
         4 004106   000100 101400                    MRL     fill='000'O
         4 004107   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 004110   100000 400001                    ADSC9   0,,PR1                   cn=2,n=1

     1322    18213    4      FB$->FS$FINST.CHARGE=0;

  18213  4 004111   000100 101400                    MRL     fill='000'O
         4 004112   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 004113   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

     1323    18214    4      FB$->FS$FINST.REPEATS = 1;

  18214  4 004114   000100 101400                    MRL     fill='000'O
         4 004115   000003 000004 xsym               ADSC9   B_VECTNIL+3              cn=0,n=4
         4 004116   100000 200001                    ADSC9   0,,PR1                   cn=1,n=1

     1324    18215    4      END;          /* End of alignment initialization  */

     1325    18216    3   FB$->FS$FINST.NUM_ENTRIES=0;

  18216  4 004117   000100 101400                    MRL     fill='000'O
         4 004120   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 004121   100000 600001                    ADSC9   0,,PR1                   cn=3,n=1

     1326    18217    3   MORE = AS_TRUE;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:241  
  18217  4 004122   000000 236000 xsym               LDQ     AS_TRUE
         4 004123   400000 376003                    ANQ     -131072,DU
         4 004124   204074 756100                    STQ     MORE,,AUTO

     1327    18218    4   BANNER_LOOP: DO WHILE (MORE);

  18218  4 004125   204074 234100       BANNER_LOOP  SZN     MORE,,AUTO
         4 004126   005622 605000 4                  TPL     BANNER_ERR

     1328    18219    4      CALL ASB$SET_PROMPT ( %PROMPT_SUB );

  18219  4 004127   000054 630400 5                  EPPR0   44
         4 004130   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004131   000000 701000 xent               TSX1    ASB$SET_PROMPT
         4 004132   000000 011000                    NOP     0

     1329    18220    4      CALL ASB$READ_SI(IN_BUF,ARS);

  18220  4 004133   200020 630500                    EPPR0   ARS,,AUTO
         4 004134   204111 450500                    STP0    @MAX_VAL+2,,AUTO
         4 004135   000034 236000 5                  LDQ     28
         4 004136   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 004137   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 004140   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 004141   000000 701000 xent               TSX1    ASB$READ_SI
         4 004142   000000 011000                    NOP     0

     1330    18221    4      P_PCB.NCHARS = ARS;

  18221  4 004143   200020 235100                    LDA     ARS,,AUTO
         4 004144   000011 755000 xsym               STA     P_PCB+9

     1331    18222    4      CALL X$PARSE( P_PCB ) ALTRET(BANNER_ERR);

  18222  4 004145   000003 630400 5                  EPPR0   3
         4 004146   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004147   000000 701000 xent               TSX1    X$PARSE
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:242  
         4 004150   005622 702000 4                  TSX2    BANNER_ERR

     1332    18223    4      NODE$ = P_PCB.OUT$;

  18223  4 004151   000003 236000 xsym               LDQ     P_PCB+3
         4 004152   000000 756000 xsym               STQ     NODE$

     1333    18224    4      SUBNS= P$NODE.SUBNODES;

  18224  4 004153   000000 470400 xsym               LDP0    NODE$
         4 004154   000001 236100                    LDQ     1,,PR0
         4 004155   000022 772000                    QRL     18
         4 004156   204102 756100                    STQ     SUBNS,,AUTO

     1334    18225    5   DO_I: DO I = 0 TO SUBNS -1;

  18225  4 004157   204053 450100       DO_I         STZ     I,,AUTO
         4 004160   005615 710000 4                  TRA     BANNER_LOOP_END+3

     1335    18226    5         PTR$=P$NODE.SUBLK$(I);

  18226  4 004161   000000 470400 xsym               LDP0    NODE$
         4 004162   204053 720100                    LXL0    I,,AUTO
         4 004163   000003 236110                    LDQ     3,X0,PR0
         4 004164   204075 756100                    STQ     PTR$,,AUTO

     1336    18227    5         CODE = PTR$->P$NODE.CODE;

  18227  4 004165   204075 471500                    LDP1    PTR$,,AUTO
         4 004166   100000 236100                    LDQ     0,,PR1
         4 004167   777777 376007                    ANQ     -1,DL
         4 004170   204077 756100                    STQ     CODE,,AUTO

     1337    18228    5         IF PTR$->P$NODE.SUBNODES = 0

  18228  4 004171   100001 221100                    LDX1    1,,PR1
         4 004172   004176 601000 4                  TNZ     s:18230
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:243  

     1338    18229    5         THEN OP_CODE = 1   /*  YES_VAL  */;

  18229  4 004173   000001 235007                    LDA     1,DL
         4 004174   204063 755100                    STA     OP_CODE,,AUTO
         4 004175   004202 710000 4                  TRA     DO_CASE

     1339    18230    5         ELSE OP_CODE = PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE;

  18230  4 004176   100003 473500                    LDP3    3,,PR1
         4 004177   300000 236100                    LDQ     0,,PR3
         4 004200   777777 376007                    ANQ     -1,DL
         4 004201   204063 756100                    STQ     OP_CODE,,AUTO

     1340    18231    6   DO_CASE: DO SELECT (CODE);

  18231  4 004202   204077 236100       DO_CASE      LDQ     CODE,,AUTO
         4 004203   000454 116007                    CMPQ    300,DL
         4 004204   004214 602000 4                  TNC     DO_CASE+10
         4 004205   004246 600000 4                  TZE     s:18237
         4 004206   000455 116007                    CMPQ    301,DL
         4 004207   005612 602000 4                  TNC     BANNER_LOOP_END
         4 004210   004242 600000 4                  TZE     s:18235
         4 004211   000456 116007                    CMPQ    302,DL
         4 004212   005612 601000 4                  TNZ     BANNER_LOOP_END
         4 004213   004236 710000 4                  TRA     s:18233
         4 004214   000044 116007                    CMPQ    36,DL
         4 004215   004225 602000 4                  TNC     DO_CASE+19
         4 004216   004335 600000 4                  TZE     s:18276
         4 004217   000045 116007                    CMPQ    37,DL
         4 004220   005612 602000 4                  TNC     BANNER_LOOP_END
         4 004221   004410 600000 4                  TZE     s:18338
         4 004222   000046 116007                    CMPQ    38,DL
         4 004223   005612 601000 4                  TNZ     BANNER_LOOP_END
         4 004224   004434 710000 4                  TRA     s:18362
         4 004225   000032 116007                    CMPQ    26,DL
         4 004226   004233 602000 4                  TNC     DO_CASE+25
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:244  
         4 004227   004252 600000 4                  TZE     s:18239
         4 004230   000043 116007                    CMPQ    35,DL
         4 004231   005612 601000 4                  TNZ     BANNER_LOOP_END
         4 004232   004304 710000 4                  TRA     s:18249
         4 004233   000014 116007                    CMPQ    12,DL
         4 004234   005612 601000 4                  TNZ     BANNER_LOOP_END
         4 004235   004252 710000 4                  TRA     s:18239

     1341    18232    6            SELECT( 302 /* HELP_VAL */ );

     1342    18233    6            CALL ASH$HELP;

  18233  4 004236   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 004237   000000 701000 xent               TSX1    ASH$HELP
         4 004240   000000 011000                    NOP     0
         4 004241   005612 710000 4                  TRA     BANNER_LOOP_END

     1343    18234    6            SELECT( 301 /* QUESTION_VAL */ );

     1344    18235    6            CALL ASH$QUEST;

  18235  4 004242   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 004243   000000 701000 xent               TSX1    ASH$QUEST
         4 004244   000000 011000                    NOP     0
         4 004245   005612 710000 4                  TRA     BANNER_LOOP_END

     1345    18236    6            SELECT( 300 /* DQUESTION_VAL */ );

     1346    18237    6            CALL ASH$DQUEST;

  18237  4 004246   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 004247   000000 701000 xent               TSX1    ASH$DQUEST
         4 004250   000000 011000                    NOP     0
         4 004251   005612 710000 4                  TRA     BANNER_LOOP_END

     1347    18238    6            SELECT(12   /*  END_VAL  */,26   /*  BLANK_LINE_VAL */);

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:245  
     1348    18239    7            IF A = 0 THEN DO;

  18239  4 004252   204073 473500                    LDP3    @A,,AUTO
         4 004253   300000 235100                    LDA     0,,PR3
         4 004254   004270 601000 4                  TNZ     s:18244

     1349    18240    7               IF FB$->FS$FINST.NUM_ENTRIES = 0 THEN

  18240  4 004255   204076 474500                    LDP4    FB$,,AUTO
         4 004256   000100 101500                    MRL     fill='000'O
         4 004257   400000 600001                    ADSC9   0,,PR4                   cn=3,n=1
         4 004260   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 004261   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 004262   000000 116003                    CMPQ    0,DU
         4 004263   004302 601000 4                  TNZ     s:18246

     1350    18241    7                  F$->FS$FORMREC.BANRDISP = 0;

  18241  4 004264   000000 221003                    LDX1    0,DU
         4 004265   204051 475500                    LDP5    F$,,AUTO
         4 004266   500003 741100                    STX1    3,,PR5

     1351    18242    7               END;

  18242  4 004267   004302 710000 4                  TRA     s:18246

     1352    18243    6            ELSE
     1353    18244    6               IF FB$->FS$FINST.NUM_ENTRIES = 0 THEN

  18244  4 004270   204076 474500                    LDP4    FB$,,AUTO
         4 004271   000100 101500                    MRL     fill='000'O
         4 004272   400000 600001                    ADSC9   0,,PR4                   cn=3,n=1
         4 004273   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 004274   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 004275   000000 116003                    CMPQ    0,DU
         4 004276   004302 601000 4                  TNZ     s:18246

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:246  
     1354    18245    6                  F$->FS$FORMREC.ALGNDISP = 0;

  18245  4 004277   000000 221003                    LDX1    0,DU
         4 004300   204051 475500                    LDP5    F$,,AUTO
         4 004301   500003 441100                    SXL1    3,,PR5

     1355    18246    6            RETURN;

  18246  4 004302   204072 221300                    LDX1  ! FOUND+1,,AUTO
         4 004303   000001 702211                    TSX2  ! 1,X1

     1356    18247
     1357    18248    6            SELECT(35 /* FB_CHARGE */);

     1358    18249    7            IF (A = 1) AND (OP_CODE = 1   /*  YES_VAL  */) THEN DO;

  18249  4 004304   204073 473500                    LDP3    @A,,AUTO
         4 004305   300000 235100                    LDA     0,,PR3
         4 004306   000001 115007                    CMPA    1,DL
         4 004307   004320 601000 4                  TNZ     s:18270
         4 004310   204063 235100                    LDA     OP_CODE,,AUTO
         4 004311   000001 115007                    CMPA    1,DL
         4 004312   004320 601000 4                  TNZ     s:18270

     1359    18250        /*E* ERROR: ASF-E$ALIGNCHARGE-0
     1360    18251             MESSAGE: You can't charge for alignment images.
     1361    18252        */
     1362    18253                    %SCREAM( ERR#=E$ALIGNCHARGE,MID='F',LEVEL=ERROR);

  18265  4 004313   000074 630400 5                  EPPR0   60
         4 004314   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004315   000000 701000 xent               TSX1    ASH$ERROR
         4 004316   000000 011000                    NOP     0

     1363    18268    7               GOTO BANNER_LOOP_END;

  18268  4 004317   005612 710000 4                  TRA     BANNER_LOOP_END
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:247  

     1364    18269    7               END;
     1365    18270    6            IF OP_CODE = 1   /*  YES_VAL  */ THEN

  18270  4 004320   204063 235100                    LDA     OP_CODE,,AUTO
         4 004321   000001 115007                    CMPA    1,DL
         4 004322   004330 601000 4                  TNZ     s:18273

     1366    18271    6               FB$->FS$FINST.CHARGE = 1;

  18271  4 004323   204076 474500                    LDP4    FB$,,AUTO
         4 004324   000100 101400                    MRL     fill='000'O
         4 004325   000003 000004 xsym               ADSC9   B_VECTNIL+3              cn=0,n=4
         4 004326   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         4 004327   005612 710000 4                  TRA     BANNER_LOOP_END

     1367    18272    6            ELSE
     1368    18273    6               FB$->FS$FINST.CHARGE = 0;

  18273  4 004330   204076 474500                    LDP4    FB$,,AUTO
         4 004331   000100 101400                    MRL     fill='000'O
         4 004332   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 004333   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         4 004334   005612 710000 4                  TRA     BANNER_LOOP_END

     1369    18274
     1370    18275    6            SELECT( 36 /* FB_REPEATS */);

     1371    18276    6            BLK$=P$NODE.SUBLK$(I)->P$NODE.SUBLK$(0);

  18276  4 004335   000003 473510                    LDP3    3,X0,PR0
         4 004336   300003 236100                    LDQ     3,,PR3
         4 004337   204050 756100                    STQ     BLK$,,AUTO

     1372    18277    6            CALL CHARBIN(VAL , OUT$SYM.TEXT);

  18277  4 004340   204050 474500                    LDP4    BLK$,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:248  
         4 004341   400004 236100                    LDQ     4,,PR4
         4 004342   000033 772000                    QRL     27
         4 004343   000000 622006                    EAX2    0,QL
         4 004344   000100 305540                    DTB
         4 004345   400004 230012                    NDSC9   4,,PR4                   cn=1,s=nosgn,sf=0,n=*X2
         4 004346   204110 000010                    NDSC9   @MAX_VAL+1,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         4 004347   204111 235100                    LDA     @MAX_VAL+2,,AUTO
         4 004350   204064 755100                    STA     VAL,,AUTO

     1373    18278    6            IF (A = 0)

  18278  4 004351   204073 473500                    LDP3    @A,,AUTO
         4 004352   300000 235100                    LDA     0,,PR3
         4 004353   004371 601000 4                  TNZ     s:18309

     1374    18279    7            THEN DO;   /* This is a banner repeats */

     1375    18280    7               IF (VAL <= 511)

  18280  4 004354   204064 236100                    LDQ     VAL,,AUTO
         4 004355   001000 116007                    CMPQ    512,DL
         4 004356   004364 603000 4                  TRC     s:18302

     1376    18281    8               THEN DO;

     1377    18282    8                  FB$->FS$FINST.REPEATS = VAL;

  18282  4 004357   204076 475500                    LDP5    FB$,,AUTO
         4 004360   000100 101500                    MRL     fill='000'O
         4 004361   204064 000004                    ADSC9   VAL,,AUTO                cn=0,n=4
         4 004362   500000 200001                    ADSC9   0,,PR5                   cn=1,n=1

     1378    18283    8                  END;

  18283  4 004363   005612 710000 4                  TRA     BANNER_LOOP_END

     1379    18284    8               ELSE DO;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:249  

     1380    18285        /*E* ERROR: ASF-E$BREPEATS-0
     1381    18286             MESSAGE: Bad number of repeats.  Repeats must be less than 512.
     1382    18287                      For alignments, the repeats must be at least 1.
     1383    18288                      For banners, the repeats can be at least 0.
     1384    18289        */
     1385    18290                       %SCREAM( ERR#=E$BREPEATS,MID='F',LEVEL=ERROR);

  18302  4 004364   000075 630400 5                  EPPR0   61
         4 004365   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004366   000000 701000 xent               TSX1    ASH$ERROR
         4 004367   000000 011000                    NOP     0

     1386    18305    8                  END;

     1387    18306    7               END; /* Repeats for banners */

  18306  4 004370   005612 710000 4                  TRA     BANNER_LOOP_END

     1388    18307    7            ELSE DO; /* Repeats for alignments */

     1389    18308
     1390    18309    7               IF ( (VAL <= 511) AND

  18309  4 004371   204064 236100                    LDQ     VAL,,AUTO
         4 004372   001000 116007                    CMPQ    512,DL
         4 004373   004403 603000 4                  TRC     s:18332
         4 004374   000000 116003                    CMPQ    0,DU
         4 004375   004403 600000 4                  TZE     s:18332

     1391    18310    7                    (VAL >= 1) )
     1392    18311    8               THEN DO;

     1393    18312    8                  FB$->FS$FINST.REPEATS = VAL;

  18312  4 004376   204076 475500                    LDP5    FB$,,AUTO
         4 004377   000100 101500                    MRL     fill='000'O
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:250  
         4 004400   204064 000004                    ADSC9   VAL,,AUTO                cn=0,n=4
         4 004401   500000 200001                    ADSC9   0,,PR5                   cn=1,n=1

     1394    18313    8                  END;

  18313  4 004402   005612 710000 4                  TRA     BANNER_LOOP_END

     1395    18314    8               ELSE DO;

     1396    18315        /*   ERROR: ASF-E$BREPEATS-0
     1397    18316             MESSAGE: Bad number of repeats.  Repeats must be less than 512.
     1398    18317                      For alignments, the repeats must be at least 1.
     1399    18318                      For banners, the repeats can be at least 0.
     1400    18319        */
     1401    18320                       %SCREAM( ERR#=E$BREPEATS,MID='F',LEVEL=ERROR);

  18332  4 004403   000075 630400 5                  EPPR0   61
         4 004404   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004405   000000 701000 xent               TSX1    ASH$ERROR
         4 004406   000000 011000                    NOP     0

     1402    18335    8                  END;

     1403    18336    7               END; /* Repeats for alignments */

  18336  4 004407   005612 710000 4                  TRA     BANNER_LOOP_END

     1404    18337    6            SELECT( 37 /* FB_ALIGNEVERY */ );

     1405    18338    7            IF A = 0 THEN DO;

  18338  4 004410   204073 473500                    LDP3    @A,,AUTO
         4 004411   300000 235100                    LDA     0,,PR3
         4 004412   004420 601000 4                  TNZ     s:18359

     1406    18339        /*E* ERROR: ASF-E$BEVERY-0
     1407    18340             MESSAGE: ALIGNEVERY meaningless for banners.
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:251  
     1408    18341        */
     1409    18342                    %SCREAM( ERR#=E$BEVERY,MID='F',LEVEL=WARN );

  18352  4 004413   000076 630400 5                  EPPR0   62
         4 004414   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004415   000000 701000 xent               TSX1    ASH$WARN
         4 004416   000000 011000                    NOP     0

     1410    18357    7               END;

  18357  4 004417   005612 710000 4                  TRA     BANNER_LOOP_END

     1411    18358    6            ELSE
     1412    18359    6               FB$->FS$FINST.ALIGNCTL.EVERY = ( OP_CODE = 1   /*  YES_VAL  */ );

  18359  4 004420   400000 222003                    LDX2    -131072,DU
         4 004421   204063 235100                    LDA     OP_CODE,,AUTO
         4 004422   000001 115007                    CMPA    1,DL
         4 004423   004425 600000 4                  TZE     s:18359+5
         4 004424   000000 222003                    LDX2    0,DU
         4 004425   000000 636012                    EAQ     0,X2
         4 004426   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 004427   204076 474500                    LDP4    FB$,,AUTO
         4 004430   003100 060500                    CSL     bolr='003'O
         4 004431   204110 000044                    BDSC    @MAX_VAL+1,,AUTO         by=0,bit=0,n=36
         4 004432   400000 000001                    BDSC    0,,PR4                   by=0,bit=0,n=1
         4 004433   005612 710000 4                  TRA     BANNER_LOOP_END

     1413    18360
     1414    18361    6            SELECT( 38 /* FB_ENTRY */);

     1415    18362    7            IF ADDR(FB$->FS$FINST.ENTRIES.MARK(ENUM)) >= FC$ THEN DO;

  18362  4 004434   200004 236100                    LDQ     ENUM,,AUTO
         4 004435   000024 736000                    QLS     20
         4 004436   000077 036000 5                  ADLQ    63
         4 004437   204076 036100                    ADLQ    FB$,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:252  
         4 004440   200006 116100                    CMPQ    FC$,,AUTO
         4 004441   004466 602000 4                  TNC     s:18389

     1416    18363        /*E* ERROR: ASF-E$BANBUFFULL-0
     1417    18364             MESSAGE: The Banner or Alignment buffer has been exceeded.
     1418    18365                      You must re-enter the banner or alignment.
     1419    18366        */
     1420    18367                    %SCREAM( ERR#=E$BANBUFFULL,MID='F',LEVEL=ERROR);

  18379  4 004442   000100 630400 5                  EPPR0   64
         4 004443   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004444   000000 701000 xent               TSX1    ASH$ERROR
         4 004445   000000 011000                    NOP     0

     1421    18382    7               FB$->FS$FINST.NUM_ENTRIES = 0;

  18382  4 004446   204076 470500                    LDP0    FB$,,AUTO
         4 004447   000100 101400                    MRL     fill='000'O
         4 004450   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 004451   000000 600001                    ADSC9   0,,PR0                   cn=3,n=1

     1422    18383    7               IF A = 0 THEN

  18383  4 004452   204073 471500                    LDP1    @A,,AUTO
         4 004453   100000 235100                    LDA     0,,PR1
         4 004454   004461 601000 4                  TNZ     s:18386

     1423    18384    7                  F$->FS$FORMREC.BANRDISP = 0;

  18384  4 004455   000000 220003                    LDX0    0,DU
         4 004456   204051 473500                    LDP3    F$,,AUTO
         4 004457   300003 740100                    STX0    3,,PR3
         4 004460   004464 710000 4                  TRA     s:18387

     1424    18385    7               ELSE
     1425    18386    7                  F$->FS$FORMREC.ALGNDISP = 0;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:253  
  18386  4 004461   000000 220003                    LDX0    0,DU
         4 004462   204051 473500                    LDP3    F$,,AUTO
         4 004463   300003 440100                    SXL0    3,,PR3

     1426    18387    7               RETURN;

  18387  4 004464   204072 221300                    LDX1  ! FOUND+1,,AUTO
         4 004465   000001 702211                    TSX2  ! 1,X1

     1427    18388    7               END;
     1428    18389    6            SUBNODES = PTR$->P$NODE.SUBNODES;

  18389  4 004466   100001 236100                    LDQ     1,,PR1
         4 004467   000022 772000                    QRL     18
         4 004470   204101 756100                    STQ     SUBNODES,,AUTO

     1429    18390    6            IF FB$->FS$FINST.REPEATS= 0 THEN

  18390  4 004471   204076 473500                    LDP3    FB$,,AUTO
         4 004472   000100 101500                    MRL     fill='000'O
         4 004473   300000 200001                    ADSC9   0,,PR3                   cn=1,n=1
         4 004474   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 004475   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 004476   000000 116003                    CMPQ    0,DU
         4 004477   004503 601000 4                  TNZ     s:18392

     1430    18391    6               FB$->FS$FINST.REPEATS = 1;

  18391  4 004500   000100 101400                    MRL     fill='000'O
         4 004501   000003 000004 xsym               ADSC9   B_VECTNIL+3              cn=0,n=4
         4 004502   300000 200001                    ADSC9   0,,PR3                   cn=1,n=1

     1431    18392    7            IF SUBNODES < 2 OR SUBNODES > 8 THEN DO;

  18392  4 004503   204101 235100                    LDA     SUBNODES,,AUTO
         4 004504   000002 115007                    CMPA    2,DL
         4 004505   004510 602000 4                  TNC     s:18409
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:254  
         4 004506   000011 115007                    CMPA    9,DL
         4 004507   004515 602000 4                  TNC     s:18414

     1432    18393        /*E* ERROR: ASF-E$BADENTRY-0
     1433    18394             MESSAGE: Bad number of entrys.
     1434    18395             MESSAGE1: There must be between 2 and 8 numbers.
     1435    18396        */
     1436    18397                    %SCREAM( ERR#=E$BADENTRY,MID='F',LEVEL=ERROR);

  18409  4 004510   000101 630400 5                  EPPR0   65
         4 004511   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004512   000000 701000 xent               TSX1    ASH$ERROR
         4 004513   000000 011000                    NOP     0

     1437    18412    7               GOTO BANNER_LOOP_END;

  18412  4 004514   005612 710000 4                  TRA     BANNER_LOOP_END

     1438    18413    7               END;
     1439    18414    6            FB$->FS$FINST.ENTRIES.FONT(ENUM)=0;

  18414  4 004515   200004 236100                    LDQ     ENUM,,AUTO
         4 004516   000004 736000                    QLS     4
         4 004517   000106 101400                    MRL     fill='000'O
         4 004520   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 004521   300001 400001                    ADSC9   1,Q,PR3                  cn=2,n=1

     1440    18415    6            FB$->FS$FINST.ENTRIES.STRIKES(ENUM)=1;

  18415  4 004522   000106 101400                    MRL     fill='000'O
         4 004523   000003 000004 xsym               ADSC9   B_VECTNIL+3              cn=0,n=4
         4 004524   300001 600001                    ADSC9   1,Q,PR3                  cn=3,n=1

     1441    18416    6            FB$->FS$FINST.ENTRIES.ICSH(ENUM)=0;

  18416  4 004525   000106 101400                    MRL     fill='000'O
         4 004526   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:255  
         4 004527   300002 000001                    ADSC9   2,Q,PR3                  cn=0,n=1

     1442    18417    6            FB$->FS$FINST.ENTRIES.REPS(ENUM)=1;

  18417  4 004530   000106 101400                    MRL     fill='000'O
         4 004531   000003 000004 xsym               ADSC9   B_VECTNIL+3              cn=0,n=4
         4 004532   300002 200001                    ADSC9   2,Q,PR3                  cn=1,n=1

     1443    18418    6            FB$->FS$FINST.ENTRIES.RINC(ENUM)=0;

  18418  4 004533   000106 101400                    MRL     fill='000'O
         4 004534   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 004535   300002 400001                    ADSC9   2,Q,PR3                  cn=2,n=1

     1444    18419    6            FB$->FS$FINST.ENTRIES.CINC(ENUM)=0;

  18419  4 004536   000106 101400                    MRL     fill='000'O
         4 004537   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 004540   300002 600001                    ADSC9   2,Q,PR3                  cn=3,n=1

     1445    18420    6            FB$->FS$FINST.ENTRIES.DISP(ENUM)=0;

  18420  4 004541   000106 101400                    MRL     fill='000'O
         4 004542   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 004543   300003 200002                    ADSC9   3,Q,PR3                  cn=1,n=2

     1446    18421    6            FB$->FS$FINST.ENTRIES.COUNT(ENUM)=0;

  18421  4 004544   000106 101400                    MRL     fill='000'O
         4 004545   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 004546   300003 600001                    ADSC9   3,Q,PR3                  cn=3,n=1

     1447    18422    7            DO K= 0 TO SUBNODES-1;

  18422  4 004547   204055 450100                    STZ     K,,AUTO
         4 004550   004722 710000 4                  TRA     s:18464+3

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:256  
     1448    18423    7               BLK$=PTR$->P$NODE.SUBLK$(K);

  18423  4 004551   204075 470500                    LDP0    PTR$,,AUTO
         4 004552   204055 720100                    LXL0    K,,AUTO
         4 004553   000003 236110                    LDQ     3,X0,PR0
         4 004554   204050 756100                    STQ     BLK$,,AUTO

     1449    18424    7               CALL CHARBIN(VAL, OUT$SYM.TEXT);

  18424  4 004555   204050 471500                    LDP1    BLK$,,AUTO
         4 004556   100004 236100                    LDQ     4,,PR1
         4 004557   000033 772000                    QRL     27
         4 004560   000000 621006                    EAX1    0,QL
         4 004561   000100 305540                    DTB
         4 004562   100004 230011                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X1
         4 004563   204110 000010                    NDSC9   @MAX_VAL+1,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         4 004564   204111 235100                    LDA     @MAX_VAL+2,,AUTO
         4 004565   204064 755100                    STA     VAL,,AUTO

     1450    18425    8               DO SELECT(K);

  18425  4 004566   204055 236100                    LDQ     K,,AUTO
         4 004567   000003 116007                    CMPQ    3,DL
         4 004570   004606 602000 4                  TNC     s:18425+16
         4 004571   004655 600000 4                  TZE     s:18454
         4 004572   000005 116007                    CMPQ    5,DL
         4 004573   004603 602000 4                  TNC     s:18425+13
         4 004574   004673 600000 4                  TZE     s:18458
         4 004575   000006 116007                    CMPQ    6,DL
         4 004576   004717 602000 4                  TNC     s:18464
         4 004577   004702 600000 4                  TZE     s:18460
         4 004600   000007 116007                    CMPQ    7,DL
         4 004601   004717 601000 4                  TNZ     s:18464
         4 004602   004711 710000 4                  TRA     s:18462
         4 004603   000004 116007                    CMPQ    4,DL
         4 004604   004717 601000 4                  TNZ     s:18464
         4 004605   004664 710000 4                  TRA     s:18456
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:257  
         4 004606   000001 116007                    CMPQ    1,DL
         4 004607   004614 602000 4                  TNC     s:18425+22
         4 004610   004626 600000 4                  TZE     s:18429
         4 004611   000002 116007                    CMPQ    2,DL
         4 004612   004717 601000 4                  TNZ     s:18464
         4 004613   004635 710000 4                  TRA     s:18431
         4 004614   000000 116003                    CMPQ    0,DU
         4 004615   004617 600000 4                  TZE     s:18427
         4 004616   004717 710000 4                  TRA     s:18464

     1451    18426    8                  SELECT(0);

     1452    18427    8                  FB$->FS$FINST.ENTRIES.ROW(ENUM)=VAL;

  18427  4 004617   200004 235100                    LDA     ENUM,,AUTO
         4 004620   000004 735000                    ALS     4
         4 004621   204076 473500                    LDP3    FB$,,AUTO
         4 004622   000105 101500                    MRL     fill='000'O
         4 004623   204064 000004                    ADSC9   VAL,,AUTO                cn=0,n=4
         4 004624   300001 000001                    ADSC9   1,A,PR3                  cn=0,n=1
         4 004625   004717 710000 4                  TRA     s:18464

     1453    18428    8                  SELECT(1);

     1454    18429    8                  FB$->FS$FINST.ENTRIES.COL(ENUM)=VAL;

  18429  4 004626   200004 235100                    LDA     ENUM,,AUTO
         4 004627   000004 735000                    ALS     4
         4 004630   204076 473500                    LDP3    FB$,,AUTO
         4 004631   000105 101500                    MRL     fill='000'O
         4 004632   204064 000004                    ADSC9   VAL,,AUTO                cn=0,n=4
         4 004633   300001 200001                    ADSC9   1,A,PR3                  cn=1,n=1
         4 004634   004717 710000 4                  TRA     s:18464

     1455    18430    8                  SELECT(2);

     1456    18431    9                  IF VAL > 3/*FONT#*/ THEN DO;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:258  

  18431  4 004635   000004 115007                    CMPA    4,DL
         4 004636   004643 602000 4                  TNC     s:18451

     1457    18432        /*E* ERROR: ASF-E$BADFONT-0
     1458    18433             MESSAGE: Illegal font.
     1459    18434        */
     1460    18435                          %SCREAM( ERR#=E$BADFONT,MID='F',LEVEL=ERROR);

  18447  4 004637   000102 630400 5                  EPPR0   66
         4 004640   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004641   000000 701000 xent               TSX1    ASH$ERROR
         4 004642   000000 011000                    NOP     0

     1461    18450    9                     END;

     1462    18451    8                  FB$->FS$FINST.ENTRIES.FONT(ENUM)=VAL;

  18451  4 004643   200004 235100                    LDA     ENUM,,AUTO
         4 004644   000004 735000                    ALS     4
         4 004645   204076 470500                    LDP0    FB$,,AUTO
         4 004646   000105 101500                    MRL     fill='000'O
         4 004647   204064 000004                    ADSC9   VAL,,AUTO                cn=0,n=4
         4 004650   000001 400001                    ADSC9   1,A,PR0                  cn=2,n=1

     1463    18452    8                  FB$->FS$FINST.ENTRIES.ICSH(ENUM)=1;

  18452  4 004651   000105 101400                    MRL     fill='000'O
         4 004652   000003 000004 xsym               ADSC9   B_VECTNIL+3              cn=0,n=4
         4 004653   000002 000001                    ADSC9   2,A,PR0                  cn=0,n=1
         4 004654   004717 710000 4                  TRA     s:18464

     1464    18453    8                  SELECT(3);

     1465    18454    8                  FB$->FS$FINST.ENTRIES.STRIKES(ENUM)=VAL;

  18454  4 004655   200004 235100                    LDA     ENUM,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:259  
         4 004656   000004 735000                    ALS     4
         4 004657   204076 473500                    LDP3    FB$,,AUTO
         4 004660   000105 101500                    MRL     fill='000'O
         4 004661   204064 000004                    ADSC9   VAL,,AUTO                cn=0,n=4
         4 004662   300001 600001                    ADSC9   1,A,PR3                  cn=3,n=1
         4 004663   004717 710000 4                  TRA     s:18464

     1466    18455    8                  SELECT(4);

     1467    18456    8                  FB$->FS$FINST.ENTRIES.ICSH(ENUM)=VAL;

  18456  4 004664   200004 235100                    LDA     ENUM,,AUTO
         4 004665   000004 735000                    ALS     4
         4 004666   204076 473500                    LDP3    FB$,,AUTO
         4 004667   000105 101500                    MRL     fill='000'O
         4 004670   204064 000004                    ADSC9   VAL,,AUTO                cn=0,n=4
         4 004671   300002 000001                    ADSC9   2,A,PR3                  cn=0,n=1
         4 004672   004717 710000 4                  TRA     s:18464

     1468    18457    8                  SELECT(5);

     1469    18458    8                  FB$->FS$FINST.ENTRIES.REPS(ENUM)=VAL;

  18458  4 004673   200004 235100                    LDA     ENUM,,AUTO
         4 004674   000004 735000                    ALS     4
         4 004675   204076 473500                    LDP3    FB$,,AUTO
         4 004676   000105 101500                    MRL     fill='000'O
         4 004677   204064 000004                    ADSC9   VAL,,AUTO                cn=0,n=4
         4 004700   300002 200001                    ADSC9   2,A,PR3                  cn=1,n=1
         4 004701   004717 710000 4                  TRA     s:18464

     1470    18459    8                  SELECT(6);

     1471    18460    8                  FB$->FS$FINST.ENTRIES.RINC(ENUM)=VAL;

  18460  4 004702   200004 235100                    LDA     ENUM,,AUTO
         4 004703   000004 735000                    ALS     4
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:260  
         4 004704   204076 473500                    LDP3    FB$,,AUTO
         4 004705   000105 101500                    MRL     fill='000'O
         4 004706   204064 000004                    ADSC9   VAL,,AUTO                cn=0,n=4
         4 004707   300002 400001                    ADSC9   2,A,PR3                  cn=2,n=1
         4 004710   004717 710000 4                  TRA     s:18464

     1472    18461    8                  SELECT(7);

     1473    18462    8                  FB$->FS$FINST.ENTRIES.CINC(ENUM)=VAL;

  18462  4 004711   200004 235100                    LDA     ENUM,,AUTO
         4 004712   000004 735000                    ALS     4
         4 004713   204076 473500                    LDP3    FB$,,AUTO
         4 004714   000105 101500                    MRL     fill='000'O
         4 004715   204064 000004                    ADSC9   VAL,,AUTO                cn=0,n=4
         4 004716   300002 600001                    ADSC9   2,A,PR3                  cn=3,n=1

     1474    18463    8                  END;

     1475    18464    7               END;

  18464  4 004717   204055 235100                    LDA     K,,AUTO
         4 004720   000001 035007                    ADLA    1,DL
         4 004721   204055 755100                    STA     K,,AUTO
         4 004722   204055 236100                    LDQ     K,,AUTO
         4 004723   204101 116100                    CMPQ    SUBNODES,,AUTO
         4 004724   004551 602000 4                  TNC     s:18423

     1476    18465    6            CALL ASB$SET_PROMPT ( %PROMPT_TXT );

  18465  4 004725   000070 630400 5                  EPPR0   56
         4 004726   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004727   000000 701000 xent               TSX1    ASB$SET_PROMPT
         4 004730   000000 011000                    NOP     0

     1477    18466    6            CALL ASB$READ_SI(IN_BUF,ARS);

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:261  
  18466  4 004731   200020 630500                    EPPR0   ARS,,AUTO
         4 004732   204111 450500                    STP0    @MAX_VAL+2,,AUTO
         4 004733   000034 236000 5                  LDQ     28
         4 004734   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 004735   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 004736   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 004737   000000 701000 xent               TSX1    ASB$READ_SI
         4 004740   000000 011000                    NOP     0

     1478    18467    6            P_PCB.ROOT$ = ADDR( FB_TYPE_LIST );

  18467  4 004741   000103 236000 5                  LDQ     67
         4 004742   000001 756000 xsym               STQ     P_PCB+1

     1479    18468    6            P_PCB.NCHARS = ARS;

  18468  4 004743   200020 235100                    LDA     ARS,,AUTO
         4 004744   000011 755000 xsym               STA     P_PCB+9

     1480    18469    6            CALL X$PARSE(P_PCB) ALTRET( STRANGE_ERR);

  18469  4 004745   000003 630400 5                  EPPR0   3
         4 004746   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004747   000000 701000 xent               TSX1    X$PARSE
         4 004750   005627 702000 4                  TSX2    STRANGE_ERR

     1481    18470    6            CODE2= P_PCB.OUT$->P$NODE.CODE;

  18470  4 004751   000003 470400 xsym               LDP0    P_PCB+3
         4 004752   000000 236100                    LDQ     0,,PR0
         4 004753   777777 376007                    ANQ     -1,DL
         4 004754   204100 756100                    STQ     CODE2,,AUTO

     1482    18471    6            IF A = 1 THEN

  18471  4 004755   204073 471500                    LDP1    @A,,AUTO
         4 004756   100000 235100                    LDA     0,,PR1
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:262  
         4 004757   000001 115007                    CMPA    1,DL
         4 004760   005002 601000 4                  TNZ     s:18498

     1483    18472    7            DO SELECT (CODE2);

  18472  4 004761   000065 116007                    CMPQ    53,DL
         4 004762   004767 602000 4                  TNC     s:18472+6
         4 004763   004772 600000 4                  TZE     s:18473
         4 004764   000072 116007                    CMPQ    58,DL
         4 004765   004773 601000 4                  TNZ     s:18492
         4 004766   004772 710000 4                  TRA     s:18473
         4 004767   000064 116007                    CMPQ    52,DL
         4 004770   004773 601000 4                  TNZ     s:18492
         4 004771   004772 710000 4                  TRA     s:18473

     1484    18473    7               SELECT(52 /* FT_LOGO */,53 /* FT_X */,58 /* FT_PLAIN */);

  18473  4 004772   005002 710000 4                  TRA     s:18498

     1485    18474    7               SELECT(ELSE);

     1486    18475        /*E* ERROR: ASF-E$BADINTRINSIC-0
     1487    18476             MESSAGE: That intrinsic is illegal for ALIGNMENTs.
     1488    18477             MESSAGE1: You can only use %LOG, %x, or plaintext
     1489    18478                         for an alignment image.
     1490    18479        */
     1491    18480                 %SCREAM( ERR#=E$BADINTRINSIC,MID='F',LEVEL=ERROR);

  18492  4 004773   000104 630400 5                  EPPR0   68
         4 004774   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004775   000000 701000 xent               TSX1    ASH$ERROR
         4 004776   000000 011000                    NOP     0

     1492    18495    7            P_PCB.ROOT$ = ADDR( F_A_OR_B_LIST);

  18495  4 004777   000073 236000 5                  LDQ     59
         4 005000   000001 756000 xsym               STQ     P_PCB+1
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:263  

     1493    18496    7            GOTO BANNER_LOOP;

  18496  4 005001   004125 710000 4                  TRA     BANNER_LOOP

     1494    18497    7               END;

     1495    18498    7            DO SELECT ( CODE2 );

  18498  4 005002   000077 116007                    CMPQ    63,DL
         4 005003   005043 602000 4                  TNC     s:18498+33
         4 005004   005305 600000 4                  TZE     s:18530
         4 005005   000103 116007                    CMPQ    67,DL
         4 005006   005032 602000 4                  TNC     s:18498+24
         4 005007   005341 600000 4                  TZE     s:18538
         4 005010   000107 116007                    CMPQ    71,DL
         4 005011   005021 602000 4                  TNC     s:18498+15
         4 005012   005375 600000 4                  TZE     s:18546
         4 005013   000110 116007                    CMPQ    72,DL
         4 005014   005601 602000 4                  TNC     s:18644
         4 005015   005404 600000 4                  TZE     s:18548
         4 005016   000111 116007                    CMPQ    73,DL
         4 005017   005601 601000 4                  TNZ     s:18644
         4 005020   005413 710000 4                  TRA     s:18550
         4 005021   000105 116007                    CMPQ    69,DL
         4 005022   005027 602000 4                  TNC     s:18498+21
         4 005023   005357 600000 4                  TZE     s:18542
         4 005024   000106 116007                    CMPQ    70,DL
         4 005025   005601 601000 4                  TNZ     s:18644
         4 005026   005366 710000 4                  TRA     s:18544
         4 005027   000104 116007                    CMPQ    68,DL
         4 005030   005601 601000 4                  TNZ     s:18644
         4 005031   005350 710000 4                  TRA     s:18540
         4 005032   000101 116007                    CMPQ    65,DL
         4 005033   005040 602000 4                  TNC     s:18498+30
         4 005034   005323 600000 4                  TZE     s:18534
         4 005035   000102 116007                    CMPQ    66,DL
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:264  
         4 005036   005601 601000 4                  TNZ     s:18644
         4 005037   005332 710000 4                  TRA     s:18536
         4 005040   000100 116007                    CMPQ    64,DL
         4 005041   005601 601000 4                  TNZ     s:18644
         4 005042   005314 710000 4                  TRA     s:18532
         4 005043   000062 116007                    CMPQ    50,DL
         4 005044   005104 602000 4                  TNC     s:18498+66
         4 005045   005215 600000 4                  TZE     s:18514
         4 005046   000070 116007                    CMPQ    56,DL
         4 005047   005065 602000 4                  TNC     s:18498+51
         4 005050   005251 600000 4                  TZE     s:18522
         4 005051   000075 116007                    CMPQ    61,DL
         4 005052   005057 602000 4                  TNC     s:18498+45
         4 005053   005267 600000 4                  TZE     s:18526
         4 005054   000076 116007                    CMPQ    62,DL
         4 005055   005601 601000 4                  TNZ     s:18644
         4 005056   005276 710000 4                  TRA     s:18528
         4 005057   000071 116007                    CMPQ    57,DL
         4 005060   005601 602000 4                  TNC     s:18644
         4 005061   005260 600000 4                  TZE     s:18524
         4 005062   000072 116007                    CMPQ    58,DL
         4 005063   005601 601000 4                  TNZ     s:18644
         4 005064   005456 710000 4                  TRA     s:18582
         4 005065   000064 116007                    CMPQ    52,DL
         4 005066   005100 602000 4                  TNC     s:18498+62
         4 005067   005233 600000 4                  TZE     s:18518
         4 005070   000066 116007                    CMPQ    54,DL
         4 005071   005074 602000 4                  TNC     s:18498+58
         4 005072   005242 600000 4                  TZE     s:18520
         4 005073   005601 710000 4                  TRA     s:18644
         4 005074   204100 235100                    LDA     CODE2,,AUTO
         4 005075   000065 115007                    CMPA    53,DL
         4 005076   005601 601000 4                  TNZ     s:18644
         4 005077   005422 710000 4                  TRA     s:18552
         4 005100   204100 235100                    LDA     CODE2,,AUTO
         4 005101   000063 115007                    CMPA    51,DL
         4 005102   005601 601000 4                  TNZ     s:18644
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:265  
         4 005103   005224 710000 4                  TRA     s:18516
         4 005104   204100 236100                    LDQ     CODE2,,AUTO
         4 005105   000056 116007                    CMPQ    46,DL
         4 005106   005122 602000 4                  TNC     s:18498+80
         4 005107   005161 600000 4                  TZE     s:18506
         4 005110   000060 116007                    CMPQ    48,DL
         4 005111   005116 602000 4                  TNC     s:18498+76
         4 005112   005177 600000 4                  TZE     s:18510
         4 005113   000061 116007                    CMPQ    49,DL
         4 005114   005601 601000 4                  TNZ     s:18644
         4 005115   005206 710000 4                  TRA     s:18512
         4 005116   204100 235100                    LDA     CODE2,,AUTO
         4 005117   000057 115007                    CMPA    47,DL
         4 005120   005601 601000 4                  TNZ     s:18644
         4 005121   005170 710000 4                  TRA     s:18508
         4 005122   204100 236100                    LDQ     CODE2,,AUTO
         4 005123   000054 116007                    CMPQ    44,DL
         4 005124   005131 602000 4                  TNC     s:18498+87
         4 005125   005143 600000 4                  TZE     s:18502
         4 005126   000055 116007                    CMPQ    45,DL
         4 005127   005601 601000 4                  TNZ     s:18644
         4 005130   005152 710000 4                  TRA     s:18504
         4 005131   000053 116007                    CMPQ    43,DL
         4 005132   005601 601000 4                  TNZ     s:18644
         4 005133   005134 710000 4                  TRA     s:18500

     1496    18499    7               SELECT( 43 /* FT_SYSID */ );

     1497    18500    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 1/*SYSID*/;

  18500  4 005134   200004 235100                    LDA     ENUM,,AUTO
         4 005135   000004 735000                    ALS     4
         4 005136   204076 470500                    LDP0    FB$,,AUTO
         4 005137   000105 101400                    MRL     fill='000'O
         4 005140   000003 000004 xsym               ADSC9   B_VECTNIL+3              cn=0,n=4
         4 005141   000003 000001                    ADSC9   3,A,PR0                  cn=0,n=1
         4 005142   005601 710000 4                  TRA     s:18644
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:266  

     1498    18501    7               SELECT( 44 /* FT_ACCN */ );

     1499    18502    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 2/*ACCN*/;

  18502  4 005143   200004 235100                    LDA     ENUM,,AUTO
         4 005144   000004 735000                    ALS     4
         4 005145   204076 470500                    LDP0    FB$,,AUTO
         4 005146   000105 101400                    MRL     fill='000'O
         4 005147   000004 000004 xsym               ADSC9   B_VECTNIL+4              cn=0,n=4
         4 005150   000003 000001                    ADSC9   3,A,PR0                  cn=0,n=1
         4 005151   005601 710000 4                  TRA     s:18644

     1500    18503    7               SELECT ( 45 /* FT_UNAME */ );

     1501    18504    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 3/*UNAME*/;

  18504  4 005152   200004 235100                    LDA     ENUM,,AUTO
         4 005153   000004 735000                    ALS     4
         4 005154   204076 470500                    LDP0    FB$,,AUTO
         4 005155   000105 101400                    MRL     fill='000'O
         4 005156   000005 000004 xsym               ADSC9   B_VECTNIL+5              cn=0,n=4
         4 005157   000003 000001                    ADSC9   3,A,PR0                  cn=0,n=1
         4 005160   005601 710000 4                  TRA     s:18644

     1502    18505    7               SELECT( 46 /* FT_WOO */ );

     1503    18506    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 4/*WOO*/;

  18506  4 005161   200004 235100                    LDA     ENUM,,AUTO
         4 005162   000004 735000                    ALS     4
         4 005163   204076 470500                    LDP0    FB$,,AUTO
         4 005164   000105 101400                    MRL     fill='000'O
         4 005165   000006 000004 xsym               ADSC9   B_VECTNIL+6              cn=0,n=4
         4 005166   000003 000001                    ADSC9   3,A,PR0                  cn=0,n=1
         4 005167   005601 710000 4                  TRA     s:18644

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:267  
     1504    18507    7               SELECT( 47 /* FT_JOBNAME */ );

     1505    18508    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 5/*JNAME*/;

  18508  4 005170   200004 235100                    LDA     ENUM,,AUTO
         4 005171   000004 735000                    ALS     4
         4 005172   204076 470500                    LDP0    FB$,,AUTO
         4 005173   000105 101400                    MRL     fill='000'O
         4 005174   000007 000004 xsym               ADSC9   B_VECTNIL+7              cn=0,n=4
         4 005175   000003 000001                    ADSC9   3,A,PR0                  cn=0,n=1
         4 005176   005601 710000 4                  TRA     s:18644

     1506    18509    7               SELECT( 48 /* FT_TIME */ );

     1507    18510    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 6/*TIME*/;

  18510  4 005177   200004 235100                    LDA     ENUM,,AUTO
         4 005200   000004 735000                    ALS     4
         4 005201   204076 470500                    LDP0    FB$,,AUTO
         4 005202   000105 101400                    MRL     fill='000'O
         4 005203   000010 000004 xsym               ADSC9   B_VECTNIL+8              cn=0,n=4
         4 005204   000003 000001                    ADSC9   3,A,PR0                  cn=0,n=1
         4 005205   005601 710000 4                  TRA     s:18644

     1508    18511    7               SELECT( 49 /* FT_DATE */ );

     1509    18512    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 7/*DATE*/;

  18512  4 005206   200004 235100                    LDA     ENUM,,AUTO
         4 005207   000004 735000                    ALS     4
         4 005210   204076 470500                    LDP0    FB$,,AUTO
         4 005211   000105 101400                    MRL     fill='000'O
         4 005212   000011 000004 xsym               ADSC9   B_VECTNIL+9              cn=0,n=4
         4 005213   000003 000001                    ADSC9   3,A,PR0                  cn=0,n=1
         4 005214   005601 710000 4                  TRA     s:18644

     1510    18513    7               SELECT( 50 /* FT_VERSION */ );
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:268  

     1511    18514    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 8/*VERS*/;

  18514  4 005215   200004 235100                    LDA     ENUM,,AUTO
         4 005216   000004 735000                    ALS     4
         4 005217   204076 473500                    LDP3    FB$,,AUTO
         4 005220   000105 101400                    MRL     fill='000'O
         4 005221   000012 000004 xsym               ADSC9   B_VECTNIL+10             cn=0,n=4
         4 005222   300003 000001                    ADSC9   3,A,PR3                  cn=0,n=1
         4 005223   005601 710000 4                  TRA     s:18644

     1512    18515    7               SELECT( 51 /* FT_SUBFILE */ );

     1513    18516    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 9/*SFILE*/;

  18516  4 005224   200004 236100                    LDQ     ENUM,,AUTO
         4 005225   000004 736000                    QLS     4
         4 005226   204076 470500                    LDP0    FB$,,AUTO
         4 005227   000106 101400                    MRL     fill='000'O
         4 005230   000013 000004 xsym               ADSC9   B_VECTNIL+11             cn=0,n=4
         4 005231   000003 000001                    ADSC9   3,Q,PR0                  cn=0,n=1
         4 005232   005601 710000 4                  TRA     s:18644

     1514    18517    7               SELECT( 52 /* FT_LOGO */ );

     1515    18518    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 10/*LOGO*/;

  18518  4 005233   200004 235100                    LDA     ENUM,,AUTO
         4 005234   000004 735000                    ALS     4
         4 005235   204076 470500                    LDP0    FB$,,AUTO
         4 005236   000105 101400                    MRL     fill='000'O
         4 005237   000014 000004 xsym               ADSC9   B_VECTNIL+12             cn=0,n=4
         4 005240   000003 000001                    ADSC9   3,A,PR0                  cn=0,n=1
         4 005241   005601 710000 4                  TRA     s:18644

     1516    18519    7               SELECT( 54 /* FT_WOD */ );

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:269  
     1517    18520    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM)=12/*WOD*/;

  18520  4 005242   200004 235100                    LDA     ENUM,,AUTO
         4 005243   000004 735000                    ALS     4
         4 005244   204076 470500                    LDP0    FB$,,AUTO
         4 005245   000105 101400                    MRL     fill='000'O
         4 005246   000105 000004 5                  ADSC9   69                       cn=0,n=4
         4 005247   000003 000001                    ADSC9   3,A,PR0                  cn=0,n=1
         4 005250   005601 710000 4                  TRA     s:18644

     1518    18521    7               SELECT( 56 /* FT_SITENAME */ );

     1519    18522    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 14/*SITENAME*/;

  18522  4 005251   200004 235100                    LDA     ENUM,,AUTO
         4 005252   000004 735000                    ALS     4
         4 005253   204076 473500                    LDP3    FB$,,AUTO
         4 005254   000105 101400                    MRL     fill='000'O
         4 005255   000106 000004 5                  ADSC9   70                       cn=0,n=4
         4 005256   300003 000001                    ADSC9   3,A,PR3                  cn=0,n=1
         4 005257   005601 710000 4                  TRA     s:18644

     1520    18523    7               SELECT( 57 /* FT_SALUTE */ );

     1521    18524    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 15/*SALUTE*/;

  18524  4 005260   200004 235100                    LDA     ENUM,,AUTO
         4 005261   000004 735000                    ALS     4
         4 005262   204076 473500                    LDP3    FB$,,AUTO
         4 005263   000105 101400                    MRL     fill='000'O
         4 005264   000107 000004 5                  ADSC9   71                       cn=0,n=4
         4 005265   300003 000001                    ADSC9   3,A,PR3                  cn=0,n=1
         4 005266   005601 710000 4                  TRA     s:18644

     1522    18525    7               SELECT( 61 /* FT_FORM */ );

     1523    18526    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 16/*FORM*/;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:270  

  18526  4 005267   200004 235100                    LDA     ENUM,,AUTO
         4 005270   000004 735000                    ALS     4
         4 005271   204076 473500                    LDP3    FB$,,AUTO
         4 005272   000105 101400                    MRL     fill='000'O
         4 005273   000110 000004 5                  ADSC9   72                       cn=0,n=4
         4 005274   300003 000001                    ADSC9   3,A,PR3                  cn=0,n=1
         4 005275   005601 710000 4                  TRA     s:18644

     1524    18527    7               SELECT( 62 /* FT_MINI_ID */ );

     1525    18528    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 17/*MINI_ID*/;

  18528  4 005276   200004 235100                    LDA     ENUM,,AUTO
         4 005277   000004 735000                    ALS     4
         4 005300   204076 473500                    LDP3    FB$,,AUTO
         4 005301   000105 101400                    MRL     fill='000'O
         4 005302   000111 000004 5                  ADSC9   73                       cn=0,n=4
         4 005303   300003 000001                    ADSC9   3,A,PR3                  cn=0,n=1
         4 005304   005601 710000 4                  TRA     s:18644

     1526    18529    7               SELECT( 63 /*FT_BANNERTEXT0 */ );

     1527    18530    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 18/*BANRTEXT0*/;

  18530  4 005305   200004 235100                    LDA     ENUM,,AUTO
         4 005306   000004 735000                    ALS     4
         4 005307   204076 473500                    LDP3    FB$,,AUTO
         4 005310   000105 101400                    MRL     fill='000'O
         4 005311   000112 000004 5                  ADSC9   74                       cn=0,n=4
         4 005312   300003 000001                    ADSC9   3,A,PR3                  cn=0,n=1
         4 005313   005601 710000 4                  TRA     s:18644

     1528    18531    7               SELECT( 64 /*FT_BANNERTEXT1 */ );

     1529    18532    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 19/*BANRTEXT1*/;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:271  
  18532  4 005314   200004 235100                    LDA     ENUM,,AUTO
         4 005315   000004 735000                    ALS     4
         4 005316   204076 473500                    LDP3    FB$,,AUTO
         4 005317   000105 101400                    MRL     fill='000'O
         4 005320   000113 000004 5                  ADSC9   75                       cn=0,n=4
         4 005321   300003 000001                    ADSC9   3,A,PR3                  cn=0,n=1
         4 005322   005601 710000 4                  TRA     s:18644

     1530    18533    7               SELECT( 65 /*FT_BANNERTEXT2 */ );

     1531    18534    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 20/*BANRTEXT2*/;

  18534  4 005323   200004 235100                    LDA     ENUM,,AUTO
         4 005324   000004 735000                    ALS     4
         4 005325   204076 473500                    LDP3    FB$,,AUTO
         4 005326   000105 101400                    MRL     fill='000'O
         4 005327   000114 000004 5                  ADSC9   76                       cn=0,n=4
         4 005330   300003 000001                    ADSC9   3,A,PR3                  cn=0,n=1
         4 005331   005601 710000 4                  TRA     s:18644

     1532    18535    7               SELECT( 66 /*FT_BANNERTEXT3 */ );

     1533    18536    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 21/*BANRTEXT3*/;

  18536  4 005332   200004 235100                    LDA     ENUM,,AUTO
         4 005333   000004 735000                    ALS     4
         4 005334   204076 473500                    LDP3    FB$,,AUTO
         4 005335   000105 101400                    MRL     fill='000'O
         4 005336   000115 000004 5                  ADSC9   77                       cn=0,n=4
         4 005337   300003 000001                    ADSC9   3,A,PR3                  cn=0,n=1
         4 005340   005601 710000 4                  TRA     s:18644

     1534    18537    7               SELECT( 67 /*FT_BANNERTEXT4 */ );

     1535    18538    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 22/*BANRTEXT4*/;

  18538  4 005341   200004 235100                    LDA     ENUM,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:272  
         4 005342   000004 735000                    ALS     4
         4 005343   204076 473500                    LDP3    FB$,,AUTO
         4 005344   000105 101400                    MRL     fill='000'O
         4 005345   000116 000004 5                  ADSC9   78                       cn=0,n=4
         4 005346   300003 000001                    ADSC9   3,A,PR3                  cn=0,n=1
         4 005347   005601 710000 4                  TRA     s:18644

     1536    18539    7               SELECT( 68 /*FT_BANNERTEXT5 */ );

     1537    18540    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 23/*BANRTEXT5*/;

  18540  4 005350   200004 235100                    LDA     ENUM,,AUTO
         4 005351   000004 735000                    ALS     4
         4 005352   204076 473500                    LDP3    FB$,,AUTO
         4 005353   000105 101400                    MRL     fill='000'O
         4 005354   000117 000004 5                  ADSC9   79                       cn=0,n=4
         4 005355   300003 000001                    ADSC9   3,A,PR3                  cn=0,n=1
         4 005356   005601 710000 4                  TRA     s:18644

     1538    18541    7               SELECT( 69 /*FT_BANNERTEXT6 */ );

     1539    18542    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 24/*BANRTEXT6*/;

  18542  4 005357   200004 235100                    LDA     ENUM,,AUTO
         4 005360   000004 735000                    ALS     4
         4 005361   204076 473500                    LDP3    FB$,,AUTO
         4 005362   000105 101400                    MRL     fill='000'O
         4 005363   000120 000004 5                  ADSC9   80                       cn=0,n=4
         4 005364   300003 000001                    ADSC9   3,A,PR3                  cn=0,n=1
         4 005365   005601 710000 4                  TRA     s:18644

     1540    18543    7               SELECT( 70 /*FT_BANNERTEXT7 */ );

     1541    18544    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 25/*BANRTEXT7*/;

  18544  4 005366   200004 235100                    LDA     ENUM,,AUTO
         4 005367   000004 735000                    ALS     4
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:273  
         4 005370   204076 473500                    LDP3    FB$,,AUTO
         4 005371   000105 101400                    MRL     fill='000'O
         4 005372   000121 000004 5                  ADSC9   81                       cn=0,n=4
         4 005373   300003 000001                    ADSC9   3,A,PR3                  cn=0,n=1
         4 005374   005601 710000 4                  TRA     s:18644

     1542    18545    7               SELECT( 71 /*FT_BANNERTEXT8 */ );

     1543    18546    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 26/*BANRTEXT8*/;

  18546  4 005375   200004 235100                    LDA     ENUM,,AUTO
         4 005376   000004 735000                    ALS     4
         4 005377   204076 473500                    LDP3    FB$,,AUTO
         4 005400   000105 101400                    MRL     fill='000'O
         4 005401   000122 000004 5                  ADSC9   82                       cn=0,n=4
         4 005402   300003 000001                    ADSC9   3,A,PR3                  cn=0,n=1
         4 005403   005601 710000 4                  TRA     s:18644

     1544    18547    7               SELECT( 72 /*FT_BANNERTEXT9 */ );

     1545    18548    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 27/*BANRTEXT9*/;

  18548  4 005404   200004 235100                    LDA     ENUM,,AUTO
         4 005405   000004 735000                    ALS     4
         4 005406   204076 473500                    LDP3    FB$,,AUTO
         4 005407   000105 101400                    MRL     fill='000'O
         4 005410   000123 000004 5                  ADSC9   83                       cn=0,n=4
         4 005411   300003 000001                    ADSC9   3,A,PR3                  cn=0,n=1
         4 005412   005601 710000 4                  TRA     s:18644

     1546    18549    7               SELECT( 73 /*FT_REGISTEREDNAME */ );

     1547    18550    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 28/*RGSTDNAM*/;

  18550  4 005413   200004 235100                    LDA     ENUM,,AUTO
         4 005414   000004 735000                    ALS     4
         4 005415   204076 473500                    LDP3    FB$,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:274  
         4 005416   000105 101400                    MRL     fill='000'O
         4 005417   000124 000004 5                  ADSC9   84                       cn=0,n=4
         4 005420   300003 000001                    ADSC9   3,A,PR3                  cn=0,n=1
         4 005421   005601 710000 4                  TRA     s:18644

     1548    18551    7               SELECT( 53 /* FT_X */ );

     1549    18552    7               IF P_PCB.OUT$->P$NODE.SUBLK$(0)->OUT$SYM.COUNT ~= 1 THEN

  18552  4 005422   000003 470400 xsym               LDP0    P_PCB+3
         4 005423   000003 471500                    LDP1    3,,PR0
         4 005424   100004 236100                    LDQ     4,,PR1
         4 005425   777000 376003                    ANQ     -512,DU
         4 005426   001000 116003                    CMPQ    512,DU
         4 005427   005437 600000 4                  TZE     s:18577

     1550    18553    8               DO;

     1551    18554        /*E* ERROR: ASF-E$BADXTYPE-0
     1552    18555             MESSAGE: Illegal type.
     1553    18556             MESSAGE1: Type must be an intrinsic name or a single character.
     1554    18557        */
     1555    18558                       %SCREAM( ERR#=E$BADXTYPE,MID='F',LEVEL=ERROR);

  18570  4 005430   000125 630400 5                  EPPR0   85
         4 005431   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005432   000000 701000 xent               TSX1    ASH$ERROR
         4 005433   000000 011000                    NOP     0

     1556    18573    8                  P_PCB.ROOT$ = ADDR(F_A_OR_B_LIST);

  18573  4 005434   000073 236000 5                  LDQ     59
         4 005435   000001 756000 xsym               STQ     P_PCB+1

     1557    18574    8                  GOTO BANNER_LOOP;

  18574  4 005436   004125 710000 4                  TRA     BANNER_LOOP
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:275  

     1558    18575    8                  END;
     1559    18576    8               ELSE DO;

     1560    18577    8                  FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 11/*RPTX*/;

  18577  4 005437   200004 235100                    LDA     ENUM,,AUTO
         4 005440   000004 735000                    ALS     4
         4 005441   204076 473500                    LDP3    FB$,,AUTO
         4 005442   000105 101400                    MRL     fill='000'O
         4 005443   000015 000004 xsym               ADSC9   B_VECTNIL+13             cn=0,n=4
         4 005444   300003 000001                    ADSC9   3,A,PR3                  cn=0,n=1

     1561    18578    8                  FB$->FS$FINST.ENTRIES.CHR(ENUM) = P_PCB.OUT$->

  18578  4 005445   000003 470400 xsym               LDP0    P_PCB+3
         4 005446   000003 471500                    LDP1    3,,PR0
         4 005447   100004 236100                    LDQ     4,,PR1
         4 005450   000033 772000                    QRL     27
         4 005451   000000 620006                    EAX0    0,QL
         4 005452   040105 100540                    MLR     fill='040'O
         4 005453   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         4 005454   300003 600001                    ADSC9   3,A,PR3                  cn=3,n=1

     1562    18579    8                       P$NODE.SUBLK$(0)->OUT$SYM.TEXT;
     1563    18580    8                  END;

  18580  4 005455   005601 710000 4                  TRA     s:18644

     1564    18581    7               SELECT( 58 /* FT_PLAIN */ );

     1565    18582    7               FB$->FS$FINST.ENTRIES.TYPE(ENUM) = 0/*TEXT*/;

  18582  4 005456   200004 235100                    LDA     ENUM,,AUTO
         4 005457   000004 735000                    ALS     4
         4 005460   204076 470500                    LDP0    FB$,,AUTO
         4 005461   000105 101400                    MRL     fill='000'O
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:276  
         4 005462   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 005463   000003 000001                    ADSC9   3,A,PR0                  cn=0,n=1

     1566    18583    7               FC_LEN = ARS;

  18583  4 005464   200020 236100                    LDQ     ARS,,AUTO
         4 005465   204103 756100                    STQ     FC_LEN,,AUTO

     1567    18584    8               IF FC_LEN = 0 THEN DO;

  18584  4 005466   005476 601000 4                  TNZ     s:18609

     1568    18585        /*E* ERROR: ASF-E$NULLENTRY-0
     1569    18586             MESSAGE: You must specify either:
     1570    18587                          a %intrinsic name
     1571    18588                          a %single character,
     1572    18589                          or a line of text.
     1573    18590        */
     1574    18591                       %SCREAM( ERR#=E$NULLENTRY,MID='F',LEVEL=ERROR);

  18603  4 005467   000126 630400 5                  EPPR0   86
         4 005470   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005471   000000 701000 xent               TSX1    ASH$ERROR
         4 005472   000000 011000                    NOP     0

     1575    18606    8                  P_PCB.ROOT$ = ADDR(F_A_OR_B_LIST);

  18606  4 005473   000073 236000 5                  LDQ     59
         4 005474   000001 756000 xsym               STQ     P_PCB+1

     1576    18607    8                  GOTO BANNER_LOOP;

  18607  4 005475   004125 710000 4                  TRA     BANNER_LOOP

     1577    18608    8                  END;
     1578    18609    8               IF ADDR(FB$->FS$FINST.ENTRIES.MARK(ENUM))>=FC$ THEN DO;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:277  
  18609  4 005476   200004 236100                    LDQ     ENUM,,AUTO
         4 005477   000024 736000                    QLS     20
         4 005500   000077 036000 5                  ADLQ    63
         4 005501   204076 036100                    ADLQ    FB$,,AUTO
         4 005502   200006 116100                    CMPQ    FC$,,AUTO
         4 005503   005530 602000 4                  TNC     s:18632

     1579    18610                       %SCREAM( ERR#=E$BANBUFFULL,MID='F',LEVEL=ERROR);

  18622  4 005504   000100 630400 5                  EPPR0   64
         4 005505   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005506   000000 701000 xent               TSX1    ASH$ERROR
         4 005507   000000 011000                    NOP     0

     1580    18625    8                  FB$->FS$FINST.NUM_ENTRIES = 0;

  18625  4 005510   204076 470500                    LDP0    FB$,,AUTO
         4 005511   000100 101400                    MRL     fill='000'O
         4 005512   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 005513   000000 600001                    ADSC9   0,,PR0                   cn=3,n=1

     1581    18626    8                  IF A = 0 THEN

  18626  4 005514   204073 471500                    LDP1    @A,,AUTO
         4 005515   100000 235100                    LDA     0,,PR1
         4 005516   005523 601000 4                  TNZ     s:18629

     1582    18627    8                     F$->FS$FORMREC.BANRDISP = 0;

  18627  4 005517   000000 220003                    LDX0    0,DU
         4 005520   204051 473500                    LDP3    F$,,AUTO
         4 005521   300003 740100                    STX0    3,,PR3
         4 005522   005526 710000 4                  TRA     s:18630

     1583    18628    8                  ELSE
     1584    18629    8                     F$->FS$FORMREC.ALGNDISP = 0;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:278  
  18629  4 005523   000000 220003                    LDX0    0,DU
         4 005524   204051 473500                    LDP3    F$,,AUTO
         4 005525   300003 440100                    SXL0    3,,PR3

     1585    18630    8                  RETURN;

  18630  4 005526   204072 221300                    LDX1  ! FOUND+1,,AUTO
         4 005527   000001 702211                    TSX2  ! 1,X1

     1586    18631    8                  END;
     1587    18632    7               FB$->FS$FINST.ENTRIES.COUNT(ENUM) = FC_LEN;

  18632  4 005530   000105 101500                    MRL     fill='000'O
         4 005531   204103 000004                    ADSC9   FC_LEN,,AUTO             cn=0,n=4
         4 005532   000003 600001                    ADSC9   3,A,PR0                  cn=3,n=1

     1588    18633    7               FC_LEN=(FC_LEN+3)/4;

  18633  4 005533   204103 236100                    LDQ     FC_LEN,,AUTO
         4 005534   000003 036007                    ADLQ    3,DL
         4 005535   000002 772000                    QRL     2
         4 005536   204103 756100                    STQ     FC_LEN,,AUTO

     1589    18634    7               FC$=PINCRW(FC$,-(FC_LEN));

  18634  4 005537   000022 736000                    QLS     18
         4 005540   000027 676000 xsym               ERQ     B_VECTNIL+23
         4 005541   000001 036007                    ADLQ    1,DL
         4 005542   200006 036100                    ADLQ    FC$,,AUTO
         4 005543   200006 756100                    STQ     FC$,,AUTO

     1590    18635    7               FC_LEN=FC_LEN*4;

  18635  4 005544   204103 235100                    LDA     FC_LEN,,AUTO
         4 005545   000002 735000                    ALS     2
         4 005546   204103 755100                    STA     FC_LEN,,AUTO

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:279  
     1591    18636    7               FC_CHAR = IN_BUF;

  18636  4 005547   200006 471500                    LDP1    FC$,,AUTO
         4 005550   000000 620005                    EAX0    0,AL
         4 005551   040140 100400                    MLR     fill='040'O
         4 005552   000000 000377 xsym               ADSC9   IN_BUF                   cn=0,n=255
         4 005553   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

     1592    18637    7               FB$->FS$FINST.ENTRIES.DISP(ENUM) = POFFW(FC$,FB$);

  18637  4 005554   204076 235100                    LDA     FB$,,AUTO
         4 005555   000022 771000                    ARL     18
         4 005556   204110 755100                    STA     @MAX_VAL+1,,AUTO
         4 005557   200006 236100                    LDQ     FC$,,AUTO
         4 005560   000022 772000                    QRL     18
         4 005561   204110 136100                    SBLQ    @MAX_VAL+1,,AUTO
         4 005562   204111 756100                    STQ     @MAX_VAL+2,,AUTO
         4 005563   200004 235100                    LDA     ENUM,,AUTO
         4 005564   000004 735000                    ALS     4
         4 005565   000105 101500                    MRL     fill='000'O
         4 005566   204111 000004                    ADSC9   @MAX_VAL+2,,AUTO         cn=0,n=4
         4 005567   000003 200002                    ADSC9   3,A,PR0                  cn=1,n=2

     1593    18638    7               SUBNS=0;

  18638  4 005570   204102 450100                    STZ     SUBNS,,AUTO

     1594    18639    7               IF A = 0 THEN

  18639  4 005571   204073 473500                    LDP3    @A,,AUTO
         4 005572   300000 235100                    LDA     0,,PR3
         4 005573   005577 601000 4                  TNZ     s:18642

     1595    18640    7                  FCB$ = FC$ ;

  18640  4 005574   200006 236100                    LDQ     FC$,,AUTO
         4 005575   200007 756100                    STQ     FCB$,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:280  
         4 005576   005601 710000 4                  TRA     s:18644

     1596    18641    7               ELSE
     1597    18642    7                  FCA$ = FC$;

  18642  4 005577   200006 236100                    LDQ     FC$,,AUTO
         4 005600   200010 756100                    STQ     FCA$,,AUTO

     1598    18643    7               END;

     1599    18644    6            P_PCB.ROOT$ = ADDR( F_A_OR_B_LIST );

  18644  4 005601   000073 236000 5                  LDQ     59
         4 005602   000001 756000 xsym               STQ     P_PCB+1

     1600    18645    6            ENUM=ENUM+1;

  18645  4 005603   200004 235100                    LDA     ENUM,,AUTO
         4 005604   000001 035007                    ADLA    1,DL
         4 005605   200004 755100                    STA     ENUM,,AUTO

     1601    18646    6            FB$->FS$FINST.NUM_ENTRIES = ENUM;

  18646  4 005606   204076 470500                    LDP0    FB$,,AUTO
         4 005607   000100 101500                    MRL     fill='000'O
         4 005610   200004 000004                    ADSC9   ENUM,,AUTO               cn=0,n=4
         4 005611   000000 600001                    ADSC9   0,,PR0                   cn=3,n=1

     1602    18647
     1603    18648    6            END DO_CASE;

  18640  4 005612                       BANNER_LOOP* null
     1604    18649    5   BANNER_LOOP_END:;
     1605    18650    5         END DO_I;

  18650  4 005612   204053 235100                    LDA     I,,AUTO
         4 005613   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:281  
         4 005614   204053 755100                    STA     I,,AUTO
         4 005615   204053 236100                    LDQ     I,,AUTO
         4 005616   204102 116100                    CMPQ    SUBNS,,AUTO
         4 005617   004161 602000 4                  TNC     s:18226

     1606    18651    4      END BANNER_LOOP;

  18651  4 005620   204074 234100                    SZN     MORE,,AUTO
         4 005621   004127 604000 4                  TMI     s:18219

     1607    18652    3   BANNER_ERR:
     1608    18653    3   CALL ASH$ERROR( P_PCB.ERROR );

  18653  4 005622   000030 630400 5     BANNER_ERR   EPPR0   24
         4 005623   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005624   000000 701000 xent               TSX1    ASH$ERROR
         4 005625   000000 011000                    NOP     0

     1609    18654    3   GOTO BANNER_LOOP;

  18654  4 005626   004125 710000 4                  TRA     BANNER_LOOP

     1610    18655    3   STRANGE_ERR: GOTO BANNER_ERR;

  18655  4 005627   005622 710000 4     STRANGE_ERR  TRA     BANNER_ERR

     1611    18656    3   END BANNER;
     1612    18657    2   END FORM_OPTS;
     1613    18658        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:282  
     1614    18659    1   GFORM_OPTS: PROC;

  18659  4 005630   204052 741300       GFORM_OPTS   STX1  ! F$+1,,AUTO

     1615    18660        /****************************************************************
     1616    18661        GFORM_OPTS proccesses the options.  They are:
     1617    18662
     1618    18663
     1619    18664        Xs[ize] = dec (1-100)
     1620    18665              the decimal value of a percentage of the ndc space this axis
     1621    18666              will fill.
     1622    18667        Ys[ize] = dec (1-100)
     1623    18668              the decimal value of a percentage of the ndc space this axis
     1624    18669              will fill.
     1625    18670        Zs[ize] = dec (1-100)
     1626    18671              the decimal value of a percentage of the ndc space this axis
     1627    18672              will fill.
     1628    18673        Xo[ffset] = dec (0 - %XG_DEFAULT_MAX_NDC# )
     1629    18674              this is the number of millimeters the driver will add to all
     1630    18675              x coordinates for output.  It is used for translation.
     1631    18676        Yo[ffset] = dec (0 - %XG_DEFAULT_MAX_NDC# )
     1632    18677              this is the number of millimeters the driver will add to all
     1633    18678              x coordinates for output.  It is used for translation.
     1634    18679        Zo[ffset] = dec (0 - %XG_DEFAULT_MAX_NDC# )
     1635    18680              this is the number of millimeters the driver will add to all
     1636    18681              x coordinates for output.  It is used for translation.
     1637    18682        Ch[arset] | chai[n] = charset name
     1638    18683              is the 6 character name of an existing charset.  The lpok,
     1639    18684              tsok, elsok, and ltyp device legality fields,
     1640    18685              along with the attributes as described in the charset record,
     1641    18686              are moved from the charset record to the graphic form record.
     1642    18687        Se[tup]
     1643    18688              this one says you want to define a message to be given to
     1644    18689              the operator when he says 'SETUP formname'. Super will then
     1645    18690              prompt with 'TXT*' and you can enter up to 10 lines of 72
     1646    18691              characters each.  To end before that, simple type a blank line.
     1647    18692              If you type all 10 lines of setup info, super will inform
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:283  
     1648    18693              you of this by saying:
     1649    18694              Setup buffer full, returning to 'OPT*' level.
     1650    18695        Acce[ss] = tname[,tname,...]
     1651    18696              the access options is used to set the access list of tnames,
     1652    18697              to say which tnames can use this form.  You can put in from
     1653    18698              one to 12 tname, and any of them may include the 'wild-card'
     1654    18699              character '?'.
     1655    18700        Acco[unt] = account[,account,...]
     1656    18701              the account options is used to set the account list of account
     1657    18702              names to say which accounts can use this form.  You can put in
     1658    18703              from one to 12 accounts, and any of them may include the
     1659    18704              'wild-card' character '?'.
     1660    18705        Ba[nner]
     1661    18706        al[ignment]
     1662    18707              these two options are described with the banner procedure,
     1663    18708              which proccesses the sub-options for both of them.
     1664    18709        R[emove] ('b/anner' | 'A/LIGNMENT')
     1665    18710              will remove either the banner or alignment image.
     1666    18711        'DEV/ICE' 'LIM/ITS' x
     1667    18712              allows the user to set any one of 10 (1 <= x <= 10) of the user
     1668    18713              alterable parameters of the set device limits command.
     1669    18714        *****************************************************************/
     1670    18715
     1671    18716    2   DCL I UBIN WORD;
     1672    18717    2   DCL J UBIN WORD;
     1673    18718    2   DCL K UBIN WORD;
     1674    18719    2   DCL L UBIN WORD;
     1675    18720    2   DCL M UBIN WORD;
     1676    18721    2   DCL DEV_LIM_NUM UBIN WORD;
     1677    18722    2   DCL PTR$ PTR;
     1678    18723    2   DCL PTR2$ PTR;
     1679    18724    2   DCL SUBNODES UBIN WORD;
     1680    18725    2   DCL OP_CODE UBIN WORD;
     1681    18726    2   DCL VAL UBIN WORD;
     1682    18727    2   DCL 1 SPLIT_VAL REDEF VAL,
     1683    18728    2          2 * UBIN (20) UNAL,
     1684    18729    2          2 T UBIN (8) UNAL,
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:284  
     1685    18730    2          2 B UBIN (8) UNAL;
     1686    18731    2   DCL 1 VAL18 REDEF VAL UNAL,
     1687    18732    2          2 UPPER UBIN (18) UNAL,
     1688    18733    2          2 LOWER UBIN (18) UNAL;
     1689    18734
     1690    18735    2   DCL 1 SPLIT,
     1691    18736    2          2 * UBIN (1) UNAL,
     1692    18737    2          2 T UBIN (8) UNAL,
     1693    18738    2          2 * UBIN (1) UNAL,
     1694    18739    2          2 B UBIN (8) UNAL;
     1695    18740    2   DCL UBINSPLIT REDEF SPLIT UBIN (18) UNAL;
     1696    18741    2   DCL DEV_TYPE CHAR(2);
     1697    18742    2   DCL DEV_TYPE_A(0:1) REDEF DEV_TYPE CHAR(1);
     1698    18743    2   DCL REMOVED BIT (1);
     1699    18744    2   DCL FOUND BIT (1);
     1700    18745
     1701    18746    2   FORM_OPTS_LOOP:
     1702    18747    2   CALL ASB$SET_PROMPT ( %PROMPT_OPT );

  18747  4 005631   000031 630400 5     FORM_OPTS_L* EPPR0   25
         4 005632   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005633   000000 701000 xent               TSX1    ASB$SET_PROMPT
         4 005634   000000 011000                    NOP     0

     1703    18748    2   IF PSEUDO_FLG

  18748  4 005635   200017 234100                    SZN     PSEUDO_FLG,,AUTO
         4 005636   005642 605000 4                  TPL     s:18753

     1704    18749    3   THEN DO;

     1705    18750    3      P_PCB.ROOT$ = ADDR( GPSEUDO_OPTS_LIST );

  18750  4 005637   000127 236000 5                  LDQ     87
         4 005640   000001 756000 xsym               STQ     P_PCB+1

     1706    18751    3      END;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:285  

  18751  4 005641   005644 710000 4                  TRA     s:18755

     1707    18752    3   ELSE DO;

     1708    18753    3      P_PCB.ROOT$ = ADDR( GFORM_OPTS_LIST );

  18753  4 005642   000130 236000 5                  LDQ     88
         4 005643   000001 756000 xsym               STQ     P_PCB+1

     1709    18754    3      END;

     1710    18755    2   F$->FS$GFORMREC.SET_DEV_LIM.DEV_LIM_OPCODE.CLASS = %XG_COOP_CONTROL#;

  18755  4 005644   204051 470500                    LDP0    F$,,AUTO
         4 005645   224000 236007                    LDQ     75776,DL
         4 005646   000012 552110                    STBQ    10,'10'O,PR0

     1711    18756    2   F$->FS$GFORMREC.SET_DEV_LIM.DEV_LIM_OPCODE.INDX = %XG_COOP_SET_DEV_LIM#;

  18756  4 005647   204051 470500                    LDP0    F$,,AUTO
         4 005650   000021 236007                    LDQ     17,DL
         4 005651   000012 552104                    STBQ    10,'04'O,PR0

     1712    18757    3   DO WHILE ( '1'B );

     1713    18758    3      CALL ASB$READ_SI( IN_BUF, ARS);

  18758  4 005652   200020 630500                    EPPR0   ARS,,AUTO
         4 005653   204111 450500                    STP0    @MAX_VAL+2,,AUTO
         4 005654   000034 236000 5                  LDQ     28
         4 005655   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 005656   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 005657   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 005660   000000 701000 xent               TSX1    ASB$READ_SI
         4 005661   000000 011000                    NOP     0

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:286  
     1714    18759    3      P_PCB.NCHARS = ARS;

  18759  4 005662   200020 235100                    LDA     ARS,,AUTO
         4 005663   000011 755000 xsym               STA     P_PCB+9

     1715    18760    3      CALL X$PARSE( P_PCB ) ALTRET ( OPTS_ERR );

  18760  4 005664   000003 630400 5                  EPPR0   3
         4 005665   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005666   000000 701000 xent               TSX1    X$PARSE
         4 005667   007232 702000 4                  TSX2    OPTS_ERR

     1716    18761    3      NODE$ = P_PCB.OUT$;

  18761  4 005670   000003 236000 xsym               LDQ     P_PCB+3
         4 005671   000000 756000 xsym               STQ     NODE$

     1717    18762    3      SUBNODES=P$NODE.SUBNODES;

  18762  4 005672   000000 470400 xsym               LDP0    NODE$
         4 005673   000001 236100                    LDQ     1,,PR0
         4 005674   000022 772000                    QRL     18
         4 005675   204063 756100                    STQ     SUBNODES,,AUTO

     1718    18763    4   DO_J: DO J = 0 TO SUBNODES - 1;

  18763  4 005676   204054 450100       DO_J         STZ     J,,AUTO
         4 005677   007226 710000 4                  TRA     s:19153+3

     1719    18764    4         PTR$ = P$NODE.SUBLK$(J);

  18764  4 005700   000000 470400 xsym               LDP0    NODE$
         4 005701   204054 720100                    LXL0    J,,AUTO
         4 005702   000003 236110                    LDQ     3,X0,PR0
         4 005703   204061 756100                    STQ     PTR$,,AUTO

     1720    18765    4         CODE = PTR$-> P$NODE.CODE;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:287  

  18765  4 005704   204061 471500                    LDP1    PTR$,,AUTO
         4 005705   100000 236100                    LDQ     0,,PR1
         4 005706   777777 376007                    ANQ     -1,DL
         4 005707   000000 756000 xsym               STQ     CODE

     1721    18766    4         IF PTR$->P$NODE.SUBNODES = 0

  18766  4 005710   100001 221100                    LDX1    1,,PR1
         4 005711   005715 601000 4                  TNZ     s:18769

     1722    18767    4         THEN OP_CODE = 1   /*  YES_VAL  */;

  18767  4 005712   000001 235007                    LDA     1,DL
         4 005713   204064 755100                    STA     OP_CODE,,AUTO
         4 005714   005723 710000 4                  TRA     DO_CASE

     1723    18768    5         ELSE DO;

     1724    18769    5            PTR2$=PTR$->P$NODE.SUBLK$(0);

  18769  4 005715   100003 236100                    LDQ     3,,PR1
         4 005716   204062 756100                    STQ     PTR2$,,AUTO

     1725    18770    5            OP_CODE = PTR2$->P$NODE.CODE;

  18770  4 005717   204062 473500                    LDP3    PTR2$,,AUTO
         4 005720   300000 236100                    LDQ     0,,PR3
         4 005721   777777 376007                    ANQ     -1,DL
         4 005722   204064 756100                    STQ     OP_CODE,,AUTO

     1726    18771    5            END;

     1727    18772    5   DO_CASE: DO SELECT (CODE);

  18772  4 005723   000000 236000 xsym  DO_CASE      LDQ     CODE
         4 005724   000167 116007                    CMPQ    119,DL
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:288  
         4 005725   005754 602000 4                  TNC     DO_CASE+25
         4 005726   006117 600000 4                  TZE     s:18799
         4 005727   000454 116007                    CMPQ    300,DL
         4 005730   005740 602000 4                  TNC     DO_CASE+13
         4 005731   006051 600000 4                  TZE     s:18780
         4 005732   000455 116007                    CMPQ    301,DL
         4 005733   007223 602000 4                  TNC     s:19153
         4 005734   006045 600000 4                  TZE     s:18778
         4 005735   000456 116007                    CMPQ    302,DL
         4 005736   007223 601000 4                  TNZ     s:19153
         4 005737   006041 710000 4                  TRA     s:18776
         4 005740   000171 116007                    CMPQ    121,DL
         4 005741   005751 602000 4                  TNC     DO_CASE+22
         4 005742   006151 600000 4                  TZE     s:18813
         4 005743   000172 116007                    CMPQ    122,DL
         4 005744   007223 602000 4                  TNC     s:19153
         4 005745   006166 600000 4                  TZE     s:18820
         4 005746   000173 116007                    CMPQ    123,DL
         4 005747   007223 601000 4                  TNZ     s:19153
         4 005750   006203 710000 4                  TRA     s:18827
         4 005751   000170 116007                    CMPQ    120,DL
         4 005752   007223 601000 4                  TNZ     s:19153
         4 005753   006134 710000 4                  TRA     s:18806
         4 005754   000036 116007                    CMPQ    30,DL
         4 005755   006023 602000 4                  TNC     DO_CASE+64
         4 005756   006236 600000 4                  TZE     s:18839
         4 005757   000075 116007                    CMPQ    61,DL
         4 005760   006007 602000 4                  TNC     DO_CASE+52
         4 005761   006236 600000 4                  TZE     s:18839
         4 005762   000101 116007                    CMPQ    65,DL
         4 005763   005776 602000 4                  TNC     DO_CASE+43
         4 005764   006546 600000 4                  TZE     s:18957
         4 005765   000165 116007                    CMPQ    117,DL
         4 005766   005773 602000 4                  TNC     DO_CASE+40
         4 005767   006065 600000 4                  TZE     s:18785
         4 005770   000166 116007                    CMPQ    118,DL
         4 005771   007223 601000 4                  TNZ     s:19153
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:289  
         4 005772   006102 710000 4                  TRA     s:18792
         4 005773   000102 116007                    CMPQ    66,DL
         4 005774   007223 601000 4                  TNZ     s:19153
         4 005775   006552 710000 4                  TRA     s:18961
         4 005776   000077 116007                    CMPQ    63,DL
         4 005777   006004 602000 4                  TNC     DO_CASE+49
         4 006000   006556 600000 4                  TZE     s:18965
         4 006001   000100 116007                    CMPQ    64,DL
         4 006002   007223 601000 4                  TNZ     s:19153
         4 006003   006556 710000 4                  TRA     s:18965
         4 006004   000076 116007                    CMPQ    62,DL
         4 006005   007223 601000 4                  TNZ     s:19153
         4 006006   006236 710000 4                  TRA     s:18839
         4 006007   000040 116007                    CMPQ    32,DL
         4 006010   006020 602000 4                  TNC     DO_CASE+61
         4 006011   006541 600000 4                  TZE     s:18953
         4 006012   000043 116007                    CMPQ    35,DL
         4 006013   007223 602000 4                  TNC     s:19153
         4 006014   006556 600000 4                  TZE     s:18965
         4 006015   000044 116007                    CMPQ    36,DL
         4 006016   007223 601000 4                  TNZ     s:19153
         4 006017   007055 710000 4                  TRA     s:19084
         4 006020   000037 116007                    CMPQ    31,DL
         4 006021   007223 601000 4                  TNZ     s:19153
         4 006022   006534 710000 4                  TRA     s:18949
         4 006023   000032 116007                    CMPQ    26,DL
         4 006024   006031 602000 4                  TNC     DO_CASE+70
         4 006025   006055 600000 4                  TZE     s:18782
         4 006026   000035 116007                    CMPQ    29,DL
         4 006027   007223 601000 4                  TNZ     s:19153
         4 006030   006233 710000 4                  TRA     s:18835
         4 006031   000020 116007                    CMPQ    16,DL
         4 006032   006035 602000 4                  TNC     DO_CASE+74
         4 006033   006040 600000 4                  TZE     s:18773
         4 006034   007223 710000 4                  TRA     s:19153
         4 006035   000014 116007                    CMPQ    12,DL
         4 006036   007223 601000 4                  TNZ     s:19153
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:290  
         4 006037   006055 710000 4                  TRA     s:18782

     1728    18773    5            SELECT(16   /*  EOL_VAL  */);

  18773  4 006040   007223 710000 4                  TRA     s:19153

     1729    18774    5            ;
     1730    18775    5            SELECT( 302 /* HELP_VAL */ );

     1731    18776    5            CALL ASH$HELP;

  18776  4 006041   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 006042   000000 701000 xent               TSX1    ASH$HELP
         4 006043   000000 011000                    NOP     0
         4 006044   007223 710000 4                  TRA     s:19153

     1732    18777    5            SELECT( 301 /* QUESTION_VAL */ );

     1733    18778    5            CALL ASH$QUEST;

  18778  4 006045   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 006046   000000 701000 xent               TSX1    ASH$QUEST
         4 006047   000000 011000                    NOP     0
         4 006050   007223 710000 4                  TRA     s:19153

     1734    18779    5            SELECT( 300 /* DQUESTION_VAL */ );

     1735    18780    5            CALL ASH$DQUEST;

  18780  4 006051   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 006052   000000 701000 xent               TSX1    ASH$DQUEST
         4 006053   000000 011000                    NOP     0
         4 006054   007223 710000 4                  TRA     s:19153

     1736    18781    5            SELECT(12   /*  END_VAL  */, 26   /*  BLANK_LINE_VAL */);

     1737    18782    5            F$->FS$GFORMREC.TRANSLGL = AS_TRUE;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:291  

  18782  4 006055   204051 470500                    LDP0    F$,,AUTO
         4 006056   000000 236000 xsym               LDQ     AS_TRUE
         4 006057   000007 772000                    QRL     7
         4 006060   000004 676100                    ERQ     4,,PR0
         4 006061   002000 376003                    ANQ     1024,DU
         4 006062   000004 656100                    ERSQ    4,,PR0

     1738    18783    5            RETURN;

  18783  4 006063   204052 221300                    LDX1  ! F$+1,,AUTO
         4 006064   000001 702211                    TSX2  ! 1,X1

     1739    18784    5            SELECT( 117 /* GRAPHIC X SIZE */ );

     1740    18785    5            BLK$=PTR2$;

  18785  4 006065   204062 236100                    LDQ     PTR2$,,AUTO
         4 006066   204050 756100                    STQ     BLK$,,AUTO

     1741    18786    5            CALL CHANGE162_9X9 ( %XG_DEFAULT_MAX_NDC# )

  18786  4 006067   000132 236000 5                  LDQ     90
         4 006070   204107 756100                    STQ     J+2,,AUTO
         4 006071   011407 701000 4                  TSX1    CHANGE162_9X9
         4 006072   006101 702000 4                  TSX2    s:18790

     1742    18787    6            WHENRETURN DO;

     1743    18788    6               F$->FS$GFORMREC.SET_DEV_LIM.X_SIZE = SPLIT;

  18788  4 006073   204066 220100                    LDX0    SPLIT,,AUTO
         4 006074   204051 470500                    LDP0    F$,,AUTO
         4 006075   000013 740100                    STX0    11,,PR0

     1744    18789    6               F$->FS$GFORMREC.X_SIZE = VAL;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:292  
  18789  4 006076   204065 721100                    LXL1    VAL,,AUTO
         4 006077   204051 470500                    LDP0    F$,,AUTO
         4 006100   000007 441100                    SXL1    7,,PR0

     1745    18790    6               END;

  18790  4 006101   007223 710000 4                  TRA     s:19153

     1746    18791    5            SELECT( 118 /* GRAPHIC Y SIZE */ );

     1747    18792    5            BLK$=PTR2$;

  18792  4 006102   204062 236100                    LDQ     PTR2$,,AUTO
         4 006103   204050 756100                    STQ     BLK$,,AUTO

     1748    18793    5            CALL CHANGE162_9X9 ( %XG_DEFAULT_MAX_NDC# )

  18793  4 006104   000132 236000 5                  LDQ     90
         4 006105   204107 756100                    STQ     J+2,,AUTO
         4 006106   011407 701000 4                  TSX1    CHANGE162_9X9
         4 006107   006116 702000 4                  TSX2    s:18797

     1749    18794    6            WHENRETURN DO;

     1750    18795    6               F$->FS$GFORMREC.SET_DEV_LIM.Y_SIZE = SPLIT;

  18795  4 006110   204066 220100                    LDX0    SPLIT,,AUTO
         4 006111   204051 470500                    LDP0    F$,,AUTO
         4 006112   000013 440100                    SXL0    11,,PR0

     1751    18796    6               F$->FS$GFORMREC.Y_SIZE = VAL;

  18796  4 006113   204065 721100                    LXL1    VAL,,AUTO
         4 006114   204051 470500                    LDP0    F$,,AUTO
         4 006115   000010 741100                    STX1    8,,PR0

     1752    18797    6               END;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:293  

  18797  4 006116   007223 710000 4                  TRA     s:19153

     1753    18798    5            SELECT( 119 /* GRAPHIC Z SIZE */ );

     1754    18799    5            BLK$=PTR2$;

  18799  4 006117   204062 236100                    LDQ     PTR2$,,AUTO
         4 006120   204050 756100                    STQ     BLK$,,AUTO

     1755    18800    5            CALL CHANGE162_9X9 ( %XG_DEFAULT_MAX_NDC# )

  18800  4 006121   000132 236000 5                  LDQ     90
         4 006122   204107 756100                    STQ     J+2,,AUTO
         4 006123   011407 701000 4                  TSX1    CHANGE162_9X9
         4 006124   006133 702000 4                  TSX2    s:18804

     1756    18801    6            WHENRETURN DO;

     1757    18802    6               F$->FS$GFORMREC.SET_DEV_LIM.Z_SIZE = SPLIT;

  18802  4 006125   204066 220100                    LDX0    SPLIT,,AUTO
         4 006126   204051 470500                    LDP0    F$,,AUTO
         4 006127   000014 740100                    STX0    12,,PR0

     1758    18803    6               F$->FS$GFORMREC.Z_SIZE = VAL;

  18803  4 006130   204065 721100                    LXL1    VAL,,AUTO
         4 006131   204051 470500                    LDP0    F$,,AUTO
         4 006132   000010 441100                    SXL1    8,,PR0

     1759    18804    6               END;

  18804  4 006133   007223 710000 4                  TRA     s:19153

     1760    18805    5            SELECT( 120 /* GRAPHIC X OFFSET */ );

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:294  
     1761    18806    5            BLK$ = PTR2$;

  18806  4 006134   204062 236100                    LDQ     PTR2$,,AUTO
         4 006135   204050 756100                    STQ     BLK$,,AUTO

     1762    18807    5            CALL CHANGE162_9X9 ( %XG_DEFAULT_MAX_NDC# )

  18807  4 006136   000132 236000 5                  LDQ     90
         4 006137   204107 756100                    STQ     J+2,,AUTO
         4 006140   011407 701000 4                  TSX1    CHANGE162_9X9
         4 006141   006150 702000 4                  TSX2    s:18811

     1763    18808    6            WHENRETURN DO;

     1764    18809    6               F$->FS$GFORMREC.SET_DEV_LIM.X_OFFSET = SPLIT;

  18809  4 006142   204066 220100                    LDX0    SPLIT,,AUTO
         4 006143   204051 470500                    LDP0    F$,,AUTO
         4 006144   000014 440100                    SXL0    12,,PR0

     1765    18810    6               F$->FS$GFORMREC.X_OFFSET = VAL;

  18810  4 006145   204065 721100                    LXL1    VAL,,AUTO
         4 006146   204051 470500                    LDP0    F$,,AUTO
         4 006147   000011 741100                    STX1    9,,PR0

     1766    18811    6               END;

  18811  4 006150   007223 710000 4                  TRA     s:19153

     1767    18812    5            SELECT( 121 /* GRAPHIC Y OFFSET */ );

     1768    18813    5            BLK$ = PTR2$;

  18813  4 006151   204062 236100                    LDQ     PTR2$,,AUTO
         4 006152   204050 756100                    STQ     BLK$,,AUTO

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:295  
     1769    18814    5            CALL CHANGE162_9X9 ( %XG_DEFAULT_MAX_NDC# )

  18814  4 006153   000132 236000 5                  LDQ     90
         4 006154   204107 756100                    STQ     J+2,,AUTO
         4 006155   011407 701000 4                  TSX1    CHANGE162_9X9
         4 006156   006165 702000 4                  TSX2    s:18818

     1770    18815    6            WHENRETURN DO;

     1771    18816    6               F$->FS$GFORMREC.SET_DEV_LIM.Y_OFFSET = SPLIT;

  18816  4 006157   204066 220100                    LDX0    SPLIT,,AUTO
         4 006160   204051 470500                    LDP0    F$,,AUTO
         4 006161   000015 740100                    STX0    13,,PR0

     1772    18817    6               F$->FS$GFORMREC.Y_OFFSET = VAL;

  18817  4 006162   204065 721100                    LXL1    VAL,,AUTO
         4 006163   204051 470500                    LDP0    F$,,AUTO
         4 006164   000011 441100                    SXL1    9,,PR0

     1773    18818    6               END;

  18818  4 006165   007223 710000 4                  TRA     s:19153

     1774    18819    5            SELECT( 122 /* GRAPHIC Z OFFSET */ );

     1775    18820    5            BLK$ = PTR2$;

  18820  4 006166   204062 236100                    LDQ     PTR2$,,AUTO
         4 006167   204050 756100                    STQ     BLK$,,AUTO

     1776    18821    5            CALL CHANGE162_9X9 ( %XG_DEFAULT_MAX_NDC# )

  18821  4 006170   000132 236000 5                  LDQ     90
         4 006171   204107 756100                    STQ     J+2,,AUTO
         4 006172   011407 701000 4                  TSX1    CHANGE162_9X9
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:296  
         4 006173   006202 702000 4                  TSX2    s:18825

     1777    18822    6            WHENRETURN DO;

     1778    18823    6               F$->FS$GFORMREC.SET_DEV_LIM.Z_OFFSET = SPLIT;

  18823  4 006174   204066 220100                    LDX0    SPLIT,,AUTO
         4 006175   204051 470500                    LDP0    F$,,AUTO
         4 006176   000015 440100                    SXL0    13,,PR0

     1779    18824    6               F$->FS$GFORMREC.Z_OFFSET = VAL;

  18824  4 006177   204065 721100                    LXL1    VAL,,AUTO
         4 006200   204051 470500                    LDP0    F$,,AUTO
         4 006201   000012 741100                    STX1    10,,PR0

     1780    18825    6               END;

  18825  4 006202   007223 710000 4                  TRA     s:19153

     1781    18826    5            SELECT (123 /* DEVICE LIMITS */);

     1782    18827    5            BLK$ = PTR2$;

  18827  4 006203   204062 236100                    LDQ     PTR2$,,AUTO
         4 006204   204050 756100                    STQ     BLK$,,AUTO

     1783    18828    5            CALL CHARBIN (DEV_LIM_NUM, OUT$SYM.TEXT);

  18828  4 006205   204050 473500                    LDP3    BLK$,,AUTO
         4 006206   300004 236100                    LDQ     4,,PR3
         4 006207   000033 772000                    QRL     27
         4 006210   000000 622006                    EAX2    0,QL
         4 006211   000100 305540                    DTB
         4 006212   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
         4 006213   204110 000010                    NDSC9   @MAX_VAL+1,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         4 006214   204111 235100                    LDA     @MAX_VAL+2,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:297  
         4 006215   204060 755100                    STA     DEV_LIM_NUM,,AUTO

     1784    18829    5            BLK$ = PTR$ -> P$NODE.SUBLK$(1);

  18829  4 006216   100004 236100                    LDQ     4,,PR1
         4 006217   204050 756100                    STQ     BLK$,,AUTO

     1785    18830    5            CALL CHANGE162_9X9 ( %XG_DEFAULT_MAX_NDC# )

  18830  4 006220   000132 236000 5                  LDQ     90
         4 006221   204107 756100                    STQ     J+2,,AUTO
         4 006222   011407 701000 4                  TSX1    CHANGE162_9X9
         4 006223   006232 702000 4                  TSX2    s:18833

     1786    18831    6            WHENRETURN DO;

     1787    18832    6               F$->FS$GFORMREC.SET_DEV_LIM.UPARAM(DEV_LIM_NUM) =SPLIT;

  18832  4 006224   204060 235100                    LDA     DEV_LIM_NUM,,AUTO
         4 006225   000001 735000                    ALS     1
         4 006226   204051 470500                    LDP0    F$,,AUTO
         4 006227   000105 100500                    MLR     fill='000'O
         4 006230   204066 000002                    ADSC9   SPLIT,,AUTO              cn=0,n=2
         4 006231   000020 000002                    ADSC9   16,A,PR0                 cn=0,n=2

     1788    18833    6               END; /* Whenreturn for CHANGE162_9X9 */

  18833  4 006232   007223 710000 4                  TRA     s:19153

     1789    18834    5            SELECT( 29 /* F_SETUP */ );

     1790    18835    5            CALL SETUP;

  18835  4 006233   007237 701000 4                  TSX1    SETUP
         4 006234   000000 011000                    NOP     0

     1791    18836    5            GOTO FORM_OPTS_LOOP;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:298  

  18836  4 006235   005631 710000 4                  TRA     FORM_OPTS_LOOP

     1792    18837
     1793    18838    5            SELECT( 30 /* F_ACCESS */, 61 /*F_ACCESS_ADD_VAL */, 62
             18838                     /*F_ACCESS_REM_VAL */ );

     1794    18839    5            SUBS = PTR$->P$NODE.SUBNODES;

  18839  4 006236   100001 236100                    LDQ     1,,PR1
         4 006237   000022 772000                    QRL     18
         4 006240   200021 756100                    STQ     SUBS,,AUTO

     1795    18840        /*
     1796    18841
     1797    18842              1000 words will be used to save the access info
     1798    18843              each account entered in this structure will take
     1799    18844              two words, so we have room for about 500
     1800    18845
     1801    18846              first build a pointer to the data segment that was
     1802    18847              returned from ASB$GETSEG.
     1803    18848
     1804    18849              Access will begin at word 1000 of the first
     1805    18850              data segment that was gotten.  It will be 1000
     1806    18851              words long
     1807    18852
     1808    18853        */
     1809    18854    5            IF ACCSS$ = ADDR(NIL)

  18854  4 006241   000003 236000 2                  LDQ     ACCSS$
         4 006242   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 006243   006254 601000 4                  TNZ     s:18859

     1810    18855    6            THEN DO;

     1811    18856    6               ACCSS$ = PINCRW(DSEG1$,ACCSS_OFFSET) ;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:299  
  18856  4 006244   000001 236000 3                  LDQ     ACCSS_OFFSET
         4 006245   000022 736000                    QLS     18
         4 006246   000000 036000 xsym               ADLQ    DSEG1$
         4 006247   000003 756000 2                  STQ     ACCSS$

     1812    18857    6               ACCSS$->FS$ACCESS.TNAMES = 0;

  18857  4 006250   000003 473400 2                  LDP3    ACCSS$
         4 006251   000100 100400                    MLR     fill='000'O
         4 006252   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 006253   300000 000004                    ADSC9   0,,PR3                   cn=0,n=4

     1813    18858    6               END;

     1814    18859    5            IF CODE = 30 /* F_ACCESS */

  18859  4 006254   000000 235000 xsym               LDA     CODE
         4 006255   000036 115007                    CMPA    30,DL
         4 006256   006270 601000 4                  TNZ     s:18867

     1815    18860    6            THEN DO;

     1816    18861    6               ACCSS$->FS$ACCESS.TNAMES = 0;

  18861  4 006257   000003 470400 2                  LDP0    ACCSS$
         4 006260   000100 100400                    MLR     fill='000'O
         4 006261   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 006262   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4

     1817    18862    6               IF SUBS = 0

  18862  4 006263   200021 235100                    LDA     SUBS,,AUTO
         4 006264   006270 601000 4                  TNZ     s:18867

     1818    18863    7               THEN DO;

     1819    18864    7                  F$->FS$GFORMREC.ACCSDISP = 0 ;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:300  

  18864  4 006265   000000 221003                    LDX1    0,DU
         4 006266   204051 473500                    LDP3    F$,,AUTO
         4 006267   300002 441100                    SXL1    2,,PR3

     1820    18865    7                  END;

     1821    18866    6               END;

     1822    18867    6            DO K = 0 TO SUBS -1;

  18867  4 006270   204055 450100                    STZ     K,,AUTO
         4 006271   006530 710000 4                  TRA     s:18947+3

     1823    18868    6               BLK$ = PTR$->P$NODE.SUBLK$(K);

  18868  4 006272   204061 470500                    LDP0    PTR$,,AUTO
         4 006273   204055 720100                    LXL0    K,,AUTO
         4 006274   000003 236110                    LDQ     3,X0,PR0
         4 006275   204050 756100                    STQ     BLK$,,AUTO

     1824    18869    6               IF OUT$SYM.COUNT > 8

  18869  4 006276   204050 471500                    LDP1    BLK$,,AUTO
         4 006277   100004 236100                    LDQ     4,,PR1
         4 006300   777000 376003                    ANQ     -512,DU
         4 006301   011000 116003                    CMPQ    4608,DU
         4 006302   006320 602000 4                  TNC     s:18890

     1825    18870    7               THEN DO;

     1826    18871    7                  AS_FIELD1.COUNT = OUT$SYM.COUNT;

  18871  4 006303   100004 236100                    LDQ     4,,PR1
         4 006304   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

     1827    18872    7                  AS_FIELD1.TEXT = OUT$SYM.TEXT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:301  

  18872  4 006305   100004 236100                    LDQ     4,,PR1
         4 006306   000033 772000                    QRL     27
         4 006307   000000 621006                    EAX1    0,QL
         4 006310   040000 100540                    MLR     fill='040'O
         4 006311   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 006312   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

     1828    18873                       %SCREAM( ERR#=E$BADACCESS,MID='F',LEVEL=ERROR);

  18885  4 006313   000044 630400 5                  EPPR0   36
         4 006314   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 006315   000000 701000 xent               TSX1    ASH$ERROR
         4 006316   000000 011000                    NOP     0

     1829    18888    7                  END;

  18888  4 006317   006525 710000 4                  TRA     s:18947

     1830    18889    7               ELSE DO;

     1831    18890    7                  IF CODE = 30 /* F_ACCESS */

  18890  4 006320   000000 235000 xsym               LDA     CODE
         4 006321   000036 115007                    CMPA    30,DL
         4 006322   006346 601000 4                  TNZ     s:18896

     1832    18891    8                  THEN DO;

     1833    18892    8                     ACCSS$->FS$ACCESS.LIST(K) = OUT$SYM.TEXT;

  18892  4 006323   100004 236100                    LDQ     4,,PR1
         4 006324   000033 772000                    QRL     27
         4 006325   204055 235100                    LDA     K,,AUTO
         4 006326   000003 735000                    ALS     3
         4 006327   000000 621006                    EAX1    0,QL
         4 006330   000003 473400 2                  LDP3    ACCSS$
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:302  
         4 006331   040105 100540                    MLR     fill='040'O
         4 006332   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 006333   300001 000010                    ADSC9   1,A,PR3                  cn=0,n=8

     1834    18893    8                     ACCSS$->FS$ACCESS.TNAMES = ACCSS$->FS$ACCESS.TNAMES+1;

  18893  4 006334   000100 100500                    MLR     fill='000'O
         4 006335   300000 000004                    ADSC9   0,,PR3                   cn=0,n=4
         4 006336   204111 000004                    ADSC9   @MAX_VAL+2,,AUTO         cn=0,n=4
         4 006337   204111 236100                    LDQ     @MAX_VAL+2,,AUTO
         4 006340   000001 036007                    ADLQ    1,DL
         4 006341   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 006342   000100 100500                    MLR     fill='000'O
         4 006343   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 006344   300000 000004                    ADSC9   0,,PR3                   cn=0,n=4

     1835    18894    8                     END;

  18894  4 006345   006525 710000 4                  TRA     s:18947

     1836    18895    8                  ELSE DO;

     1837    18896    8                     L = 0;

  18896  4 006346   204056 450100                    STZ     L,,AUTO

     1838    18897    8                     FOUND = AS_FALSE;

  18897  4 006347   000000 236000 xsym               LDQ     AS_FALSE
         4 006350   400000 376003                    ANQ     -131072,DU
         4 006351   204071 756100                    STQ     FOUND,,AUTO

     1839    18898    8                     REMOVED = AS_FALSE;

  18898  4 006352   204070 756100                    STQ     REMOVED,,AUTO

     1840    18899    9                     DO WHILE( L < ACCSS$->FS$ACCESS.TNAMES );
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:303  

  18899  4 006353   000003 473400 2                  LDP3    ACCSS$
         4 006354   000100 100500                    MLR     fill='000'O
         4 006355   300000 000004                    ADSC9   0,,PR3                   cn=0,n=4
         4 006356   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 006357   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 006360   204056 116100                    CMPQ    L,,AUTO
         4 006361   006460 602000 4                  TNC     s:18916
         4 006362   006460 600000 4                  TZE     s:18916

     1841    18900    9                        IF ACCSS$->FS$ACCESS.LIST(L) = OUT$SYM.TEXT

  18900  4 006363   204050 470500                    LDP0    BLK$,,AUTO
         4 006364   000004 236100                    LDQ     4,,PR0
         4 006365   000033 772000                    QRL     27
         4 006366   204056 235100                    LDA     L,,AUTO
         4 006367   000003 735000                    ALS     3
         4 006370   000003 471400 2                  LDP1    ACCSS$
         4 006371   000000 620006                    EAX0    0,QL
         4 006372   040140 106505                    CMPC    fill='040'O
         4 006373   100001 000010                    ADSC9   1,A,PR1                  cn=0,n=8
         4 006374   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 006375   006445 601000 4                  TNZ     s:18914

     1842    18901   10                        THEN DO; /* Found one */

     1843    18902   10                           FOUND = AS_TRUE;

  18902  4 006376   000000 236000 xsym               LDQ     AS_TRUE
         4 006377   400000 376003                    ANQ     -131072,DU
         4 006400   204071 756100                    STQ     FOUND,,AUTO

     1844    18903   10                           IF CODE = 62 /*F_ACCESS_REM_VAL */

  18903  4 006401   000000 235000 xsym               LDA     CODE
         4 006402   000076 115007                    CMPA    62,DL
         4 006403   006445 601000 4                  TNZ     s:18914
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:304  

     1845    18904   11                           THEN DO;

     1846    18905   12                              DO M = L+1 TO ACCSS$->FS$ACCESS.TNAMES-1;

  18905  4 006404   204056 235100                    LDA     L,,AUTO
         4 006405   000001 035007                    ADLA    1,DL
         4 006406   204057 755100                    STA     M,,AUTO
         4 006407   006421 710000 4                  TRA     s:18908+3

     1847    18906   12                                 ACCSS$->FS$ACCESS.LIST(M-1) =

  18906  4 006410   204057 235100                    LDA     M,,AUTO
         4 006411   000003 735000                    ALS     3
         4 006412   000003 470400 2                  LDP0    ACCSS$
         4 006413   040105 100505                    MLR     fill='040'O
         4 006414   000001 000010                    ADSC9   1,A,PR0                  cn=0,n=8
         4 006415   077777 000010                    ADSC9   -1,A,PR0                 cn=0,n=8

     1848    18907   12                                      ACCSS$->FS$ACCESS.LIST(M);
     1849    18908   12                                 END;

  18908  4 006416   204057 236100                    LDQ     M,,AUTO
         4 006417   000001 036007                    ADLQ    1,DL
         4 006420   204057 756100                    STQ     M,,AUTO
         4 006421   000003 470400 2                  LDP0    ACCSS$
         4 006422   000100 100500                    MLR     fill='000'O
         4 006423   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         4 006424   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 006425   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 006426   204057 116100                    CMPQ    M,,AUTO
         4 006427   006431 600000 4                  TZE     s:18909
         4 006430   006410 603000 4                  TRC     s:18906

     1850    18909   11                              ACCSS$->FS$ACCESS.TNAMES =

  18909  4 006431   000100 100500                    MLR     fill='000'O
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:305  
         4 006432   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         4 006433   204111 000004                    ADSC9   @MAX_VAL+2,,AUTO         cn=0,n=4
         4 006434   204111 236100                    LDQ     @MAX_VAL+2,,AUTO
         4 006435   000001 136007                    SBLQ    1,DL
         4 006436   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 006437   000100 100500                    MLR     fill='000'O
         4 006440   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 006441   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4

     1851    18910   11                                   ACCSS$->FS$ACCESS.TNAMES-1;
     1852    18911   11                              REMOVED = AS_TRUE;

  18911  4 006442   000000 236000 xsym               LDQ     AS_TRUE
         4 006443   400000 376003                    ANQ     -131072,DU
         4 006444   204070 756100                    STQ     REMOVED,,AUTO

     1853    18912   11                              END;

     1854    18913   10                           END;

     1855    18914    9                        L = L + 1;

  18914  4 006445   204056 235100                    LDA     L,,AUTO
         4 006446   000001 035007                    ADLA    1,DL
         4 006447   204056 755100                    STA     L,,AUTO

     1856    18915    9                        END;

  18915  4 006450   000003 470400 2                  LDP0    ACCSS$
         4 006451   000100 100500                    MLR     fill='000'O
         4 006452   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         4 006453   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 006454   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 006455   204056 116100                    CMPQ    L,,AUTO
         4 006456   006460 600000 4                  TZE     s:18916
         4 006457   006363 603000 4                  TRC     s:18900

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:306  
     1857    18916    8                     IF NOT REMOVED AND CODE = 62 /*F_ACCESS_REM_VAL */

  18916  4 006460   204070 234100                    SZN     REMOVED,,AUTO
         4 006461   006503 604000 4                  TMI     s:18940
         4 006462   000000 235000 xsym               LDA     CODE
         4 006463   000076 115007                    CMPA    62,DL
         4 006464   006503 601000 4                  TNZ     s:18940

     1858    18917    9                     THEN DO;

     1859    18918        /*   ERROR:   ASF-E$F_ACCESS_NO_EXIST-C
     1860    18919             MESSAGE: %U1 does not exist in the access list.
     1861    18920             MESSAGE1: A tname not in the access list cannot be removed.
     1862    18921        */
     1863    18922    9                        AS_FIELD1.COUNT = OUT$SYM.COUNT;

  18922  4 006465   204050 470500                    LDP0    BLK$,,AUTO
         4 006466   000004 236100                    LDQ     4,,PR0
         4 006467   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

     1864    18923    9                        AS_FIELD1.TEXT = OUT$SYM.TEXT;

  18923  4 006470   000004 236100                    LDQ     4,,PR0
         4 006471   000033 772000                    QRL     27
         4 006472   000000 620006                    EAX0    0,QL
         4 006473   040000 100540                    MLR     fill='040'O
         4 006474   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 006475   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

     1865    18924                             %SCREAM(ERR#=E$F_ACCESS_NO_EXIST,LEVEL=WARN,MID='F');

  18934  4 006476   000045 630400 5                  EPPR0   37
         4 006477   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 006500   000000 701000 xent               TSX1    ASH$WARN
         4 006501   000000 011000                    NOP     0

     1866    18939    9                        END;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:307  

  18939  4 006502   006525 710000 4                  TRA     s:18947

     1867    18940    8                     ELSE IF NOT FOUND

  18940  4 006503   204071 234100                    SZN     FOUND,,AUTO
         4 006504   006525 604000 4                  TMI     s:18947

     1868    18941    9                        THEN DO;

     1869    18942    9                           ACCSS$->FS$ACCESS.LIST(L) = OUT$SYM.TEXT;

  18942  4 006505   204050 470500                    LDP0    BLK$,,AUTO
         4 006506   000004 236100                    LDQ     4,,PR0
         4 006507   000033 772000                    QRL     27
         4 006510   204056 235100                    LDA     L,,AUTO
         4 006511   000003 735000                    ALS     3
         4 006512   000000 620006                    EAX0    0,QL
         4 006513   000003 471400 2                  LDP1    ACCSS$
         4 006514   040105 100540                    MLR     fill='040'O
         4 006515   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 006516   100001 000010                    ADSC9   1,A,PR1                  cn=0,n=8

     1870    18943    9                           ACCSS$->FS$ACCESS.TNAMES = L + 1;

  18943  4 006517   204056 236100                    LDQ     L,,AUTO
         4 006520   000001 036007                    ADLQ    1,DL
         4 006521   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 006522   000100 100500                    MLR     fill='000'O
         4 006523   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 006524   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4

     1871    18944    9                           END;

     1872    18945    8                     END;

     1873    18946    7                  END;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:308  

     1874    18947    6               END; /* K loop */

  18947  4 006525   204055 235100                    LDA     K,,AUTO
         4 006526   000001 035007                    ADLA    1,DL
         4 006527   204055 755100                    STA     K,,AUTO
         4 006530   204055 236100                    LDQ     K,,AUTO
         4 006531   200021 116100                    CMPQ    SUBS,,AUTO
         4 006532   006272 602000 4                  TNC     s:18868
         4 006533   007223 710000 4                  TRA     s:19153

     1875    18948    5            SELECT( 31 /* F_BANNER */ );

     1876    18949    5            CALL BANNER(0);

  18949  4 006534   000021 236000 5                  LDQ     17
         4 006535   204073 756100                    STQ     @A,,AUTO
         4 006536   007356 701000 4                  TSX1    BANNER
         4 006537   000000 011000                    NOP     0

     1877    18950    5            GOTO FORM_OPTS_LOOP;

  18950  4 006540   005631 710000 4                  TRA     FORM_OPTS_LOOP

     1878    18951
     1879    18952    5            SELECT( 32 /* F_ALIGNMENT */ );

     1880    18953    5            CALL BANNER(1);

  18953  4 006541   000031 236000 5                  LDQ     25
         4 006542   204073 756100                    STQ     @A,,AUTO
         4 006543   007356 701000 4                  TSX1    BANNER
         4 006544   000000 011000                    NOP     0

     1881    18954    5            GOTO FORM_OPTS_LOOP;

  18954  4 006545   005631 710000 4                  TRA     FORM_OPTS_LOOP
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:309  

     1882    18955
     1883    18956    5            SELECT( 65 /*F_REMOVE_BANNER_VAL*/ );

     1884    18957    5            BNNR$ = ADDR(NIL);

  18957  4 006546   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 006547   000004 756000 2                  STQ     BNNR$

     1885    18958    5            OLD_BANNER = '0'B;

  18958  4 006550   000000 450000 2                  STZ     OLD_BANNER
         4 006551   007223 710000 4                  TRA     s:19153

     1886    18959
     1887    18960    5            SELECT( 66 /*F_REMOVE_ALIGN_VAL*/ );

     1888    18961    5            ALGN$ = ADDR(NIL);

  18961  4 006552   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 006553   000005 756000 2                  STQ     ALGN$

     1889    18962    5            OLD_ALGN = '0'B;

  18962  4 006554   000001 450000 2                  STZ     OLD_ALGN
         4 006555   007223 710000 4                  TRA     s:19153

     1890    18963
     1891    18964    5            SELECT( 35 /* F_ACCOUNT  */, 63 /*F_ACCOUNT_ADD_VAL */, 64
             18964                     /*F_ACCOUNT_REM_VAL */ );

     1892    18965    5            SUBS = PTR$->P$NODE.SUBNODES ;

  18965  4 006556   204061 470500                    LDP0    PTR$,,AUTO
         4 006557   000001 236100                    LDQ     1,,PR0
         4 006560   000022 772000                    QRL     18
         4 006561   200021 756100                    STQ     SUBS,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:310  

     1893    18966        /*
     1894    18967
     1895    18968              1000 words will be used to save the accounts info
     1896    18969              each account entered in this structure will take
     1897    18970              two words, so we have room for about 500
     1898    18971        */
     1899    18972        /*
     1900    18973
     1901    18974              First build a pointer to the data segment that was
     1902    18975              returned from ABS$GETSEG
     1903    18976
     1904    18977              accounts will begin at word zero of the first
     1905    18978              data segment that was gotten.  It will be 1000
     1906    18979              words long
     1907    18980
     1908    18981        */
     1909    18982    5            IF ACCNT$ = ADDR(NIL)

  18982  4 006562   000002 236000 2                  LDQ     ACCNT$
         4 006563   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 006564   006575 601000 4                  TNZ     s:18988

     1910    18983    6            THEN DO;

     1911    18984    6               ACCNT$ = PINCRW(DSEG1$,ACCNT_OFFSET) ;

  18984  4 006565   000000 236000 3                  LDQ     ACCNT_OFFSET
         4 006566   000022 736000                    QLS     18
         4 006567   000000 036000 xsym               ADLQ    DSEG1$
         4 006570   000002 756000 2                  STQ     ACCNT$

     1912    18985    6               ACCNT$->FS$ACCOUNTS.TACCTS = 0;

  18985  4 006571   000002 471400 2                  LDP1    ACCNT$
         4 006572   000100 100400                    MLR     fill='000'O
         4 006573   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:311  
         4 006574   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4

     1913    18986    6               END;

     1914    18987
     1915    18988    5            IF CODE = 35 /* F_ACCOUNT  */

  18988  4 006575   000000 235000 xsym               LDA     CODE
         4 006576   000043 115007                    CMPA    35,DL
         4 006577   006611 601000 4                  TNZ     s:18997

     1916    18989    6            THEN DO;

     1917    18990    6               ACCNT$->FS$ACCOUNTS.TACCTS = 0 ;

  18990  4 006600   000002 471400 2                  LDP1    ACCNT$
         4 006601   000100 100400                    MLR     fill='000'O
         4 006602   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 006603   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4

     1918    18991    6               IF SUBS = 0

  18991  4 006604   200021 235100                    LDA     SUBS,,AUTO
         4 006605   006611 601000 4                  TNZ     s:18997

     1919    18992    7               THEN DO;

     1920    18993    7                  F$->FS$GFORMREC.ACCTDISP = 0;

  18993  4 006606   000000 220003                    LDX0    0,DU
         4 006607   204051 473500                    LDP3    F$,,AUTO
         4 006610   300001 440100                    SXL0    1,,PR3

     1921    18994    7                  END;

     1922    18995    6               END;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:312  
     1923    18996
     1924    18997    6            DO K = 0 TO SUBS -1;

  18997  4 006611   204055 450100                    STZ     K,,AUTO
         4 006612   007051 710000 4                  TRA     s:19081+3

     1925    18998    6               BLK$ = PTR$->P$NODE.SUBLK$(K);

  18998  4 006613   204061 470500                    LDP0    PTR$,,AUTO
         4 006614   204055 720100                    LXL0    K,,AUTO
         4 006615   000003 236110                    LDQ     3,X0,PR0
         4 006616   204050 756100                    STQ     BLK$,,AUTO

     1926    18999    6               IF OUT$SYM.COUNT > 8

  18999  4 006617   204050 471500                    LDP1    BLK$,,AUTO
         4 006620   100004 236100                    LDQ     4,,PR1
         4 006621   777000 376003                    ANQ     -512,DU
         4 006622   011000 116003                    CMPQ    4608,DU
         4 006623   006641 602000 4                  TNC     s:19024

     1927    19000    7               THEN DO;

     1928    19001        /*   ERROR: ASF-E$BADACCOUNT-0
     1929    19002             MESSAGE: Account name too long: "%U1".
     1930    19003             MESSAGE1: Account names must not be more than 8 characters long.
     1931    19004        */
     1932    19005    7                  AS_FIELD1.COUNT = OUT$SYM.COUNT;

  19005  4 006624   100004 236100                    LDQ     4,,PR1
         4 006625   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

     1933    19006    7                  AS_FIELD1.TEXT = OUT$SYM.TEXT;

  19006  4 006626   100004 236100                    LDQ     4,,PR1
         4 006627   000033 772000                    QRL     27
         4 006630   000000 621006                    EAX1    0,QL
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:313  
         4 006631   040000 100540                    MLR     fill='040'O
         4 006632   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 006633   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

     1934    19007                       %SCREAM( ERR#=E$BADACCOUNT ,MID='F',LEVEL=ERROR);

  19019  4 006634   000046 630400 5                  EPPR0   38
         4 006635   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 006636   000000 701000 xent               TSX1    ASH$ERROR
         4 006637   000000 011000                    NOP     0

     1935    19022    7                  END;

  19022  4 006640   007046 710000 4                  TRA     s:19081

     1936    19023    7               ELSE DO;

     1937    19024    7                  IF CODE = 35 /* F_ACCOUNT  */

  19024  4 006641   000000 235000 xsym               LDA     CODE
         4 006642   000043 115007                    CMPA    35,DL
         4 006643   006667 601000 4                  TNZ     s:19030

     1938    19025    8                  THEN DO;

     1939    19026    8                     ACCNT$->FS$ACCOUNTS.LIST(K) = OUT$SYM.TEXT;

  19026  4 006644   100004 236100                    LDQ     4,,PR1
         4 006645   000033 772000                    QRL     27
         4 006646   204055 235100                    LDA     K,,AUTO
         4 006647   000003 735000                    ALS     3
         4 006650   000000 621006                    EAX1    0,QL
         4 006651   000002 473400 2                  LDP3    ACCNT$
         4 006652   040105 100540                    MLR     fill='040'O
         4 006653   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 006654   300001 000010                    ADSC9   1,A,PR3                  cn=0,n=8

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:314  
     1940    19027    8                     ACCNT$->FS$ACCOUNTS.TACCTS = ACCNT$->FS$ACCOUNTS.TACCTS + 1;

  19027  4 006655   000100 100500                    MLR     fill='000'O
         4 006656   300000 000004                    ADSC9   0,,PR3                   cn=0,n=4
         4 006657   204111 000004                    ADSC9   @MAX_VAL+2,,AUTO         cn=0,n=4
         4 006660   204111 236100                    LDQ     @MAX_VAL+2,,AUTO
         4 006661   000001 036007                    ADLQ    1,DL
         4 006662   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 006663   000100 100500                    MLR     fill='000'O
         4 006664   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 006665   300000 000004                    ADSC9   0,,PR3                   cn=0,n=4

     1941    19028    8                     END;

  19028  4 006666   007046 710000 4                  TRA     s:19081

     1942    19029    8                  ELSE DO;

     1943    19030    8                     L = 0;

  19030  4 006667   204056 450100                    STZ     L,,AUTO

     1944    19031    8                     REMOVED = AS_FALSE;

  19031  4 006670   000000 236000 xsym               LDQ     AS_FALSE
         4 006671   400000 376003                    ANQ     -131072,DU
         4 006672   204070 756100                    STQ     REMOVED,,AUTO

     1945    19032    8                     FOUND = AS_FALSE;

  19032  4 006673   204071 756100                    STQ     FOUND,,AUTO

     1946    19033    9                     DO WHILE( L < ACCNT$->FS$ACCOUNTS.TACCTS );

  19033  4 006674   000002 473400 2                  LDP3    ACCNT$
         4 006675   000100 100500                    MLR     fill='000'O
         4 006676   300000 000004                    ADSC9   0,,PR3                   cn=0,n=4
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:315  
         4 006677   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 006700   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 006701   204056 116100                    CMPQ    L,,AUTO
         4 006702   007001 602000 4                  TNC     s:19050
         4 006703   007001 600000 4                  TZE     s:19050

     1947    19034    9                        IF ACCNT$->FS$ACCOUNTS.LIST(L) = OUT$SYM.TEXT

  19034  4 006704   204050 470500                    LDP0    BLK$,,AUTO
         4 006705   000004 236100                    LDQ     4,,PR0
         4 006706   000033 772000                    QRL     27
         4 006707   204056 235100                    LDA     L,,AUTO
         4 006710   000003 735000                    ALS     3
         4 006711   000002 471400 2                  LDP1    ACCNT$
         4 006712   000000 620006                    EAX0    0,QL
         4 006713   040140 106505                    CMPC    fill='040'O
         4 006714   100001 000010                    ADSC9   1,A,PR1                  cn=0,n=8
         4 006715   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 006716   006766 601000 4                  TNZ     s:19048

     1948    19035   10                        THEN DO; /* Found one */

     1949    19036   10                           FOUND = AS_TRUE;

  19036  4 006717   000000 236000 xsym               LDQ     AS_TRUE
         4 006720   400000 376003                    ANQ     -131072,DU
         4 006721   204071 756100                    STQ     FOUND,,AUTO

     1950    19037   10                           IF CODE = 64 /*F_ACCOUNT_REM_VAL */

  19037  4 006722   000000 235000 xsym               LDA     CODE
         4 006723   000100 115007                    CMPA    64,DL
         4 006724   006766 601000 4                  TNZ     s:19048

     1951    19038   11                           THEN DO;

     1952    19039   12                              DO M = L+1 TO ACCNT$->FS$ACCOUNTS.TACCTS-1;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:316  

  19039  4 006725   204056 235100                    LDA     L,,AUTO
         4 006726   000001 035007                    ADLA    1,DL
         4 006727   204057 755100                    STA     M,,AUTO
         4 006730   006742 710000 4                  TRA     s:19042+3

     1953    19040   12                                 ACCNT$->FS$ACCOUNTS.LIST(M-1) =

  19040  4 006731   204057 235100                    LDA     M,,AUTO
         4 006732   000003 735000                    ALS     3
         4 006733   000002 470400 2                  LDP0    ACCNT$
         4 006734   040105 100505                    MLR     fill='040'O
         4 006735   000001 000010                    ADSC9   1,A,PR0                  cn=0,n=8
         4 006736   077777 000010                    ADSC9   -1,A,PR0                 cn=0,n=8

     1954    19041   12                                      ACCNT$->FS$ACCOUNTS.LIST(M);
     1955    19042   12                                 END;

  19042  4 006737   204057 236100                    LDQ     M,,AUTO
         4 006740   000001 036007                    ADLQ    1,DL
         4 006741   204057 756100                    STQ     M,,AUTO
         4 006742   000002 470400 2                  LDP0    ACCNT$
         4 006743   000100 100500                    MLR     fill='000'O
         4 006744   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         4 006745   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 006746   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 006747   204057 116100                    CMPQ    M,,AUTO
         4 006750   006752 600000 4                  TZE     s:19043
         4 006751   006731 603000 4                  TRC     s:19040

     1956    19043   11                              ACCNT$->FS$ACCOUNTS.TACCTS =

  19043  4 006752   000100 100500                    MLR     fill='000'O
         4 006753   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         4 006754   204111 000004                    ADSC9   @MAX_VAL+2,,AUTO         cn=0,n=4
         4 006755   204111 236100                    LDQ     @MAX_VAL+2,,AUTO
         4 006756   000001 136007                    SBLQ    1,DL
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:317  
         4 006757   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 006760   000100 100500                    MLR     fill='000'O
         4 006761   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 006762   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4

     1957    19044   11                                   ACCNT$->FS$ACCOUNTS.TACCTS-1;
     1958    19045   11                              REMOVED = AS_TRUE;

  19045  4 006763   000000 236000 xsym               LDQ     AS_TRUE
         4 006764   400000 376003                    ANQ     -131072,DU
         4 006765   204070 756100                    STQ     REMOVED,,AUTO

     1959    19046   11                              END;

     1960    19047   10                           END;

     1961    19048    9                        L = L + 1;

  19048  4 006766   204056 235100                    LDA     L,,AUTO
         4 006767   000001 035007                    ADLA    1,DL
         4 006770   204056 755100                    STA     L,,AUTO

     1962    19049    9                        END;

  19049  4 006771   000002 470400 2                  LDP0    ACCNT$
         4 006772   000100 100500                    MLR     fill='000'O
         4 006773   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         4 006774   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 006775   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 006776   204056 116100                    CMPQ    L,,AUTO
         4 006777   007001 600000 4                  TZE     s:19050
         4 007000   006704 603000 4                  TRC     s:19034

     1963    19050    8                     IF NOT REMOVED AND CODE = 64 /*F_ACCOUNT_REM_VAL */

  19050  4 007001   204070 234100                    SZN     REMOVED,,AUTO
         4 007002   007024 604000 4                  TMI     s:19074
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:318  
         4 007003   000000 235000 xsym               LDA     CODE
         4 007004   000100 115007                    CMPA    64,DL
         4 007005   007024 601000 4                  TNZ     s:19074

     1964    19051    9                     THEN DO;

     1965    19052           /*   ERROR:   ASF-E$F_ACCOUNT_NO_EXIST-C
     1966    19053                MESSAGE: %U1 does not exist in the account list.
     1967    19054                MESSAGE1: An account not in the account list cannot be removed.
     1968    19055           */
     1969    19056    9                        AS_FIELD1.COUNT = OUT$SYM.COUNT;

  19056  4 007006   204050 470500                    LDP0    BLK$,,AUTO
         4 007007   000004 236100                    LDQ     4,,PR0
         4 007010   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

     1970    19057    9                        AS_FIELD1.TEXT = OUT$SYM.TEXT;

  19057  4 007011   000004 236100                    LDQ     4,,PR0
         4 007012   000033 772000                    QRL     27
         4 007013   000000 620006                    EAX0    0,QL
         4 007014   040000 100540                    MLR     fill='040'O
         4 007015   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 007016   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

     1971    19058                             %SCREAM(ERR#=E$F_ACCOUNT_NO_EXIST,LEVEL=WARN,MID='F');

  19068  4 007017   000047 630400 5                  EPPR0   39
         4 007020   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007021   000000 701000 xent               TSX1    ASH$WARN
         4 007022   000000 011000                    NOP     0

     1972    19073    9                        END;

  19073  4 007023   007046 710000 4                  TRA     s:19081

     1973    19074    8                     ELSE IF NOT FOUND
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:319  

  19074  4 007024   204071 234100                    SZN     FOUND,,AUTO
         4 007025   007046 604000 4                  TMI     s:19081

     1974    19075    9                        THEN DO;

     1975    19076    9                           ACCNT$->FS$ACCOUNTS.LIST(L) = OUT$SYM.TEXT;

  19076  4 007026   204050 470500                    LDP0    BLK$,,AUTO
         4 007027   000004 236100                    LDQ     4,,PR0
         4 007030   000033 772000                    QRL     27
         4 007031   204056 235100                    LDA     L,,AUTO
         4 007032   000003 735000                    ALS     3
         4 007033   000000 620006                    EAX0    0,QL
         4 007034   000002 471400 2                  LDP1    ACCNT$
         4 007035   040105 100540                    MLR     fill='040'O
         4 007036   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 007037   100001 000010                    ADSC9   1,A,PR1                  cn=0,n=8

     1976    19077    9                           ACCNT$->FS$ACCOUNTS.TACCTS = L + 1;

  19077  4 007040   204056 236100                    LDQ     L,,AUTO
         4 007041   000001 036007                    ADLQ    1,DL
         4 007042   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 007043   000100 100500                    MLR     fill='000'O
         4 007044   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 007045   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4

     1977    19078    9                           END;

     1978    19079    8                     END; /* Else do l = 0 */

     1979    19080    7                  END;

     1980    19081    6               END; /*   K loop   */

  19081  4 007046   204055 235100                    LDA     K,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:320  
         4 007047   000001 035007                    ADLA    1,DL
         4 007050   204055 755100                    STA     K,,AUTO
         4 007051   204055 236100                    LDQ     K,,AUTO
         4 007052   200021 116100                    CMPQ    SUBS,,AUTO
         4 007053   006613 602000 4                  TNC     s:18998
         4 007054   007223 710000 4                  TRA     s:19153

     1981    19082
     1982    19083    5            SELECT (36 /* F_CHAIN */) ;

     1983    19084    5            BLK$ = PTR2$->P$NODE.SUBLK$(0);

  19084  4 007055   204062 470500                    LDP0    PTR2$,,AUTO
         4 007056   000003 236100                    LDQ     3,,PR0
         4 007057   204050 756100                    STQ     BLK$,,AUTO

     1984    19085    5            IF OUT$SYM.COUNT > 8

  19085  4 007060   204050 471500                    LDP1    BLK$,,AUTO
         4 007061   100004 236100                    LDQ     4,,PR1
         4 007062   777000 376003                    ANQ     -512,DU
         4 007063   011000 116003                    CMPQ    4608,DU
         4 007064   007072 602000 4                  TNC     s:19108

     1985    19086    6            THEN DO;

     1986    19087        /*   ERROR: ASF-E$CHARSETTOOBIG-C
     1987    19088             MESSAGE: That charset name is too long.
     1988    19089             MESSAGE1: The maximum size of a charset name is 8 characters.
     1989    19090        */
     1990    19091                    %SCREAM(ERR#=E$CHARSETTOOBIG,MID='F',LEVEL=ERROR);

  19103  4 007065   000050 630400 5                  EPPR0   40
         4 007066   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007067   000000 701000 xent               TSX1    ASH$ERROR
         4 007070   000000 011000                    NOP     0

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:321  
     1991    19106    6               END;

  19106  4 007071   007223 710000 4                  TRA     s:19153

     1992    19107    6            ELSE DO;

     1993    19108    6               CHARSET_KEY.CNT = OUT$SYM.COUNT + 8;

  19108  4 007072   100004 236100                    LDQ     4,,PR1
         4 007073   000033 772000                    QRL     27
         4 007074   000010 036007                    ADLQ    8,DL
         4 007075   000033 736000                    QLS     27
         4 007076   200041 552140                    STBQ    CHARSET_KEY,'40'O,AUTO

     1994    19109    6               CALL CONCAT (CHARSET_KEY.TXT, '~',

  19109  4 007077   100004 236100                    LDQ     4,,PR1
         4 007100   000033 772000                    QRL     27
         4 007101   000000 620006                    EAX0    0,QL
         4 007102   000176 236003                    LDQ     126,DU
         4 007103   200041 552120                    STBQ    CHARSET_KEY,'20'O,AUTO
         4 007104   040100 100540                    MLR     fill='040'O
         4 007105   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         4 007106   200041 400017                    ADSC9   CHARSET_KEY,,AUTO        cn=2,n=15
         4 007107   000000 636010                    EAQ     0,X0
         4 007110   000022 772000                    QRL     18
         4 007111   000017 116007                    CMPQ    15,DL
         4 007112   007123 603000 4                  TRC     s:19111
         4 007113   204110 740100                    STX0    @MAX_VAL+1,,AUTO
         4 007114   777760 620010                    EAX0    -16,X0
         4 007115   777777 660003                    ERX0    -1,DU
         4 007116   204110 235100                    LDA     @MAX_VAL+1,,AUTO
         4 007117   000022 771000                    ARL     18
         4 007120   040145 100400                    MLR     fill='040'O
         4 007121   000041 000007 3                  ADSC9   TEXT_OFFSET+28           cn=0,n=7
         4 007122   200041 400010                    ADSC9   CHARSET_KEY,A,AUTO       cn=2,n=*X0

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:322  
     1995    19110    6                    SUBSTR(OUT$SYM.TEXT,0,OUT$SYM.COUNT),'CHARSET');
     1996    19111    6               ARS = SIZEB(CHARSET);

  19111  4 007123   004270 235007                    LDA     2232,DL
         4 007124   200020 755100                    STA     ARS,,AUTO

     1997    19112    6               CALL ASF$READ_FORM (CHARSET_KEY, CHARSET$, ARS)

  19112  4 007125   200020 633500                    EPPR3   ARS,,AUTO
         4 007126   204112 453500                    STP3    @MAX_VAL+3,,AUTO
         4 007127   200012 634500                    EPPR4   CHARSET$,,AUTO
         4 007130   204111 454500                    STP4    @MAX_VAL+2,,AUTO
         4 007131   200041 635500                    EPPR5   CHARSET_KEY,,AUTO
         4 007132   204110 455500                    STP5    @MAX_VAL+1,,AUTO
         4 007133   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 007134   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 007135   000000 701000 xent               TSX1    ASF$READ_FORM
         4 007136   007175 702000 4                  TSX2    s:19121

     1998    19113    7               WHENRETURN DO;

     1999    19114    7                  F$->FS$GFORMREC.LGLTYPS = CHARSET.LGLTYPS;

  19114  4 007137   204051 470500                    LDP0    F$,,AUTO
         4 007140   200012 471500                    LDP1    CHARSET$,,AUTO
         4 007141   100074 235100                    LDA     60,,PR1
         4 007142   100075 236100                    LDQ     61,,PR1
         4 007143   000022 773000                    LRL     18
         4 007144   000051 376000 5                  ANQ     41
         4 007145   000011 772000                    QRL     9
         4 007146   000004 552134                    STBQ    4,'34'O,PR0

     2000    19115    7                  F$->FS$GFORMREC.ATTR = CHARSET.ATTRS;

  19115  4 007147   200012 470500                    LDP0    CHARSET$,,AUTO
         4 007150   000074 220100                    LDX0    60,,PR0
         4 007151   204051 471500                    LDP1    F$,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:323  
         4 007152   100005 740100                    STX0    5,,PR1

     2001    19116    7                  F$->FS$GFORMREC.ATTR = CHARSET.ATTRS | %ATTR_TRANSLGL#;
             19116                           /*This forces tranparent legal for graphic forms*/

  19116  4 007153   200012 470500                    LDP0    CHARSET$,,AUTO
         4 007154   000074 220100                    LDX0    60,,PR0
         4 007155   000200 260003                    ORX0    128,DU
         4 007156   204051 471500                    LDP1    F$,,AUTO
         4 007157   100005 740100                    STX0    5,,PR1

     2002    19117    7                  F$->FS$GFORMREC.ATTR = F$->FS$GFORMREC.ATTR | %ATTR_GRLGL#;
             19117                           /*This forces graphics legal for graphic forms*/

  19117  4 007160   204051 470500                    LDP0    F$,,AUTO
         4 007161   000005 220100                    LDX0    5,,PR0
         4 007162   000400 260003                    ORX0    256,DU
         4 007163   000005 740100                    STX0    5,,PR0

     2003    19118    7                  F$->FS$GFORMREC.CHAIN_NAME = OUT$SYM.TEXT;

  19118  4 007164   204050 470500                    LDP0    BLK$,,AUTO
         4 007165   000004 236100                    LDQ     4,,PR0
         4 007166   000033 772000                    QRL     27
         4 007167   000000 620006                    EAX0    0,QL
         4 007170   204051 471500                    LDP1    F$,,AUTO
         4 007171   040100 100540                    MLR     fill='040'O
         4 007172   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 007173   100005 400010                    ADSC9   5,,PR1                   cn=2,n=8

     2004    19119    7                  END;

  19119  4 007174   007223 710000 4                  TRA     s:19153

     2005    19120    7               WHENALTRETURN DO;

     2006    19121    7                  IF MERR_CODE.CODE ~= %E$NOREC
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:324  

  19121  4 007175   000000 236000 xsym               LDQ     ERR_CODE
         4 007176   377770 376007                    ANQ     131064,DL
         4 007177   001260 116007                    CMPQ    688,DL
         4 007200   007217 600000 4                  TZE     s:19147

     2007    19122    8                  THEN DO;

     2008    19123        /*   ERROR: ASF-E$BADCHAIN-C
     2009    19124             MESSAGE: Charset %U1 does not exist.
     2010    19125             MESSAGE1: Charsets must exist before their contents can move to
     2011    19126                       the form definition.
     2012    19127        */
     2013    19128    8                     AS_FIELD1.COUNT = OUT$SYM.COUNT;

  19128  4 007201   204050 470500                    LDP0    BLK$,,AUTO
         4 007202   000004 236100                    LDQ     4,,PR0
         4 007203   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

     2014    19129    8                     AS_FIELD1.TEXT = OUT$SYM.TEXT;

  19129  4 007204   000004 236100                    LDQ     4,,PR0
         4 007205   000033 772000                    QRL     27
         4 007206   000000 620006                    EAX0    0,QL
         4 007207   040000 100540                    MLR     fill='040'O
         4 007210   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 007211   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

     2015    19130                          %SCREAM(ERR#=E$BADCHAIN, MID='F', LEVEL=ERROR);

  19142  4 007212   000052 630400 5                  EPPR0   42
         4 007213   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007214   000000 701000 xent               TSX1    ASH$ERROR
         4 007215   000000 011000                    NOP     0

     2016    19145    8                     END;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:325  
  19145  4 007216   007223 710000 4                  TRA     s:19153

     2017    19146    8                  ELSE DO;

     2018    19147    8                     CALL ASH$ERROR (P_PCB.ERROR);

  19147  4 007217   000030 630400 5                  EPPR0   24
         4 007220   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007221   000000 701000 xent               TSX1    ASH$ERROR
         4 007222   000000 011000                    NOP     0

     2019    19148    8                     END;

     2020    19149    7                  END;

     2021    19150    6               END;

     2022    19151
     2023    19152    5            END DO_CASE;

     2024    19153    4         END DO_J;

  19153  4 007223   204054 235100                    LDA     J,,AUTO
         4 007224   000001 035007                    ADLA    1,DL
         4 007225   204054 755100                    STA     J,,AUTO
         4 007226   204054 236100                    LDQ     J,,AUTO
         4 007227   204063 116100                    CMPQ    SUBNODES,,AUTO
         4 007230   005700 602000 4                  TNC     s:18764

     2025    19154    3      END;

  19154  4 007231   005652 710000 4                  TRA     s:18758

     2026    19155    2   OPTS_ERR:
     2027    19156    2   CALL ASH$ERROR ( P_PCB.ERROR );

  19156  4 007232   000030 630400 5     OPTS_ERR     EPPR0   24
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:326  
         4 007233   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007234   000000 701000 xent               TSX1    ASH$ERROR
         4 007235   000000 011000                    NOP     0

     2028    19157    2   GOTO FORM_OPTS_LOOP;

  19157  4 007236   005631 710000 4                  TRA     FORM_OPTS_LOOP

     2029    19158        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:327  
     2030    19159    2   SETUP: PROC;

  19159  4 007237   204072 741300       SETUP        STX1  ! FOUND+1,,AUTO

     2031    19160
     2032    19161
     2033    19162    3   DCL I UBIN WORD;
     2034    19163    3   DCL CODE2 UBIN WORD;
     2035    19164        /*
     2036    19165              1500 words will be used to save the setup info
     2037    19166              this allows 83 lines of input
     2038    19167        */
     2039    19168        /*    First build a pointer to the data segment that was
     2040    19169              returned from ASB$GETSEG.
     2041    19170
     2042    19171              Setup will begin at word 0 of the second
     2043    19172              segment gotten
     2044    19173
     2045    19174        */
     2046    19175        /*
     2047    19176        */
     2048    19177    3   SETUP$ = PINCRW(DSEG2$,SETUP_OFFSET);       /* Ptr to our setup area   */

  19177  4 007240   000003 236000 3                  LDQ     SETUP_OFFSET
         4 007241   000022 736000                    QLS     18
         4 007242   000000 036000 xsym               ADLQ    DSEG2$
         4 007243   000006 756000 2                  STQ     SETUP$

     2049    19178    4   DO I = 0 TO 82;

  19178  4 007244   204073 450100                    STZ     I,,AUTO

     2050    19179    4      SETUP$->FS$SETUP.TXT(I) = ' ';

  19179  4 007245   204073 236100                    LDQ     I,,AUTO
         4 007246   000110 402007                    MPY     72,DL
         4 007247   000006 470400 2                  LDP0    SETUP$
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:328  
         4 007250   040106 100400                    MLR     fill='040'O
         4 007251   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 007252   000001 000110                    ADSC9   1,Q,PR0                  cn=0,n=72

     2051    19180    4      END;

  19180  4 007253   204073 235100                    LDA     I,,AUTO
         4 007254   000001 035007                    ADLA    1,DL
         4 007255   204073 755100                    STA     I,,AUTO
         4 007256   000123 115007                    CMPA    83,DL
         4 007257   007245 602000 4                  TNC     s:19179

     2052    19181    3   F$->FS$SETUP.LINES = 0 ;

  19181  4 007260   204051 471500                    LDP1    F$,,AUTO
         4 007261   000100 101400                    MRL     fill='000'O
         4 007262   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 007263   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

     2053    19182    3   CALL ASB$SET_PROMPT ( %PROMPT_TXT );

  19182  4 007264   000070 630400 5                  EPPR0   56
         4 007265   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007266   000000 701000 xent               TSX1    ASB$SET_PROMPT
         4 007267   000000 011000                    NOP     0

     2054    19183    3   I = 0;

  19183  4 007270   204073 450100                    STZ     I,,AUTO

     2055    19184    4   DO UNTIL( I = 83  OR  IN_BUF = ' ' );

     2056    19185    4      CALL ASB$READ_SI( IN_BUF,ARS);

  19185  4 007271   200020 630500                    EPPR0   ARS,,AUTO
         4 007272   204111 450500                    STP0    @MAX_VAL+2,,AUTO
         4 007273   000034 236000 5                  LDQ     28
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:329  
         4 007274   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 007275   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 007276   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 007277   000000 701000 xent               TSX1    ASB$READ_SI
         4 007300   000000 011000                    NOP     0

     2057    19186    4      IF IN_BUF ~= ' '

  19186  4 007301   040000 106400                    CMPC    fill='040'O
         4 007302   000000 000377 xsym               ADSC9   IN_BUF                   cn=0,n=255
         4 007303   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 007304   007326 600000 4                  TZE     s:19214

     2058    19187    5      THEN DO;

     2059    19188    5         IF ARS <= 72

  19188  4 007305   200020 235100                    LDA     ARS,,AUTO
         4 007306   000111 115007                    CMPA    73,DL
         4 007307   007322 603000 4                  TRC     s:19209

     2060    19189    6         THEN DO;

     2061    19190    6            SETUP$ -> FS$SETUP.TXT(I) = IN_BUF;

  19190  4 007310   204073 236100                    LDQ     I,,AUTO
         4 007311   000110 402007                    MPY     72,DL
         4 007312   000006 470400 2                  LDP0    SETUP$
         4 007313   040106 100400                    MLR     fill='040'O
         4 007314   000000 000110 xsym               ADSC9   IN_BUF                   cn=0,n=72
         4 007315   000001 000110                    ADSC9   1,Q,PR0                  cn=0,n=72

     2062    19191    6            I = I + 1;

  19191  4 007316   204073 235100                    LDA     I,,AUTO
         4 007317   000001 035007                    ADLA    1,DL
         4 007320   204073 755100                    STA     I,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:330  

     2063    19192    6            END;

  19192  4 007321   007326 710000 4                  TRA     s:19214

     2064    19193    6         ELSE DO;

     2065    19194        /*   ERROR: ASF-E$SETUPBAD-C
     2066    19195             MESSAGE: Setup text must be 72 characters or less per line.
     2067    19196        */
     2068    19197                 %SCREAM( ERR#=E$SETUPBAD,MID='F',LEVEL=ERROR);

  19209  4 007322   000071 630400 5                  EPPR0   57
         4 007323   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007324   000000 701000 xent               TSX1    ASH$ERROR
         4 007325   000000 011000                    NOP     0

     2069    19212    6            END;

     2070    19213    5         END;

     2071    19214    4      END;        /* Do until */

  19214  4 007326   204073 235100                    LDA     I,,AUTO
         4 007327   000123 115007                    CMPA    83,DL
         4 007330   007335 600000 4                  TZE     s:19215
         4 007331   040000 106400                    CMPC    fill='040'O
         4 007332   000000 000377 xsym               ADSC9   IN_BUF                   cn=0,n=255
         4 007333   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 007334   007271 601000 4                  TNZ     s:19185

     2072    19215    4   IF I = 83 THEN DO;

  19215  4 007335   000123 115007                    CMPA    83,DL
         4 007336   007343 601000 4                  TNZ     s:19235

     2073    19216        /*   ERROR:   ASF-E$SETUP_FULL-C
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:331  
     2074    19217             MESSAGE: Setup buffer full, returning to 'OPT*' level.
     2075    19218        */
     2076    19219           %SCREAM( ERR#=E$SETUP_FULL, MID='F', LEVEL=WARN );

  19229  4 007337   000072 630400 5                  EPPR0   58
         4 007340   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007341   000000 701000 xent               TSX1    ASH$WARN
         4 007342   000000 011000                    NOP     0

     2077    19234    4      END;

     2078    19235    3   SETUP$ -> FS$SETUP.LINES = I;

  19235  4 007343   000006 470400 2                  LDP0    SETUP$
         4 007344   000100 101500                    MRL     fill='000'O
         4 007345   204073 000004                    ADSC9   I,,AUTO                  cn=0,n=4
         4 007346   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     2079    19236    3   IF I = 0

  19236  4 007347   204073 235100                    LDA     I,,AUTO
         4 007350   007354 601000 4                  TNZ     s:19240

     2080    19237    4   THEN DO;

     2081    19238    4      F$ -> FS$GFORMREC.SETUPDISP = 0;

  19238  4 007351   000000 220003                    LDX0    0,DU
         4 007352   204051 471500                    LDP1    F$,,AUTO
         4 007353   100002 740100                    STX0    2,,PR1

     2082    19239    4      END;

     2083    19240    3   RETURN;

  19240  4 007354   204072 221300                    LDX1  ! FOUND+1,,AUTO
         4 007355   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:332  

     2084    19241
     2085    19242
     2086    19243    3   END SETUP;
     2087    19244        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:333  
     2088    19245    2   BANNER: PROC (A);

  19245  4 007356   204072 741300       BANNER       STX1  ! FOUND+1,,AUTO

     2089    19246        /****************************************************************
     2090    19247        Banner proccesses the sub-options for both banners and alignments.
     2091    19248        The format is:
     2092    19249
     2093    19250        Ba[nner]
     2094    19251        al[ignment]
     2095    19252              these two options define the banner and alignment image for
     2096    19253              this form.  Super will ask for sub-options. They are:
     2097    19254              Ch[arge] [=yes|no]
     2098    19255                  legal only for banners.  This says whether or not to
     2099    19256                  charge the user for the banner pages.
     2100    19257                  If '=yes|no' is ommited, yes is assumed.
     2101    19258              Re[peats] = dec
     2102    19259                  this says how many times to repeat this entire banner or
     2103    19260                  alignment image.  If this option is ommited, it defaults
     2104    19261                  to one if there are any entries, and zero if there are none.
     2105    19262              Al[ign][every] [=yes|no]
     2106    19263                  legal only for alignment images.  This says whether to
     2107    19264                  print the alignment after every file or not. Default is no.
     2108    19265              En[try] = x,y[,rotation,char_width,char_hite,char_space]
     2109    19266                  this options defines one element of this banner or alignment,
     2110    19267                  and may be used as many times as needed. The values are:
     2111    19268
     2112    19269                 x: The x position for this entry on the output device
     2113    19270                 y: The y position for this entry on the output device
     2114    19271                 z: The z position for this entry on the output device.
     2115    19272                 rotation: The path this entry will take -
     2116    19273                    0 = right to left
     2117    19274                    90 = up
     2118    19275                    180 = left to right
     2119    19276                    270 = down
     2120    19277                    yes that right the value are specified as degrees.
     2121    19278                 char_width: The width of the individual characters.
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:334  
     2122    19279                 char_hite: The height of the individual characters.
     2123    19280                 char_space: The spacing in between the individual characters.
     2124    19281
     2125    19282                  After typing the entry option, super will prompt with
     2126    19283                  'TXT*'.  at this point you can type one of the following:
     2127    19284
     2128    19285                  %SY[SID]      the sysid of the user whos output we are printing
     2129    19286                  %AC[CN]       the account name of the user.
     2130    19287                  %UN[AME]      the username of the user.
     2131    19288                  %WOO          the users work-station of origin.
     2132    19289                  %JO[BNAME]    the name the user specified on his job card.
     2133    19290                  %TI[ME]       the current time.
     2134    19291                  %DA[TE]       the current date.
     2135    19292                  %VE[RSION]    the system version.
     2136    19293                  %SU[BFILE]    the subfile number of this printout.
     2137    19294                  %LO[GO]       the standard CP-6 logo.
     2138    19295                  %WOD          the users work-station of destination.
     2139    19296                  %SI[TENAME]   the site name.
     2140    19297                  %SA[LUTE]     the standard system salutation
     2141    19298                  %BAN[NERTEXT]0 the first of 10 bannertext fields,
     2142    19299                     it should contain the registered name.
     2143    19300                  %BAN[NERTEXT]1 the first bannertext field
     2144    19301                  %BAN[NERTEXT]2 the second bannertext field
     2145    19302                  %BAN[NERTEXT]3 the third bannertext field
     2146    19303                  %BAN[NERTEXT]4 the fourth bannertext field
     2147    19304                  %BAN[NERTEXT]5 the fifth bannertext field
     2148    19305                  %BAN[NERTEXT]6 the sixth bannertext field
     2149    19306                  %BAN[NERTEXT]7 the seventh bannertext field
     2150    19307                  %BAN[NERTEXT]8 the eigth bannertext field
     2151    19308                  %BAN[NERTEXT]9 the ninth bannertext field
     2152    19309                  %RE[GISTEREDNAME] this is the registered name from mail!
     2153    19310                  %x     where x is any single charater.
     2154    19311                  Any text line, not starting with a '%'.
     2155    19312
     2156    19313                  For aligments, only %LOGO,%x or the line of text are
     2157    19314                  legal.  If a line of text was entered, that line will
     2158    19315                  be printed on the banner just as it is entered.
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:335  
     2159    19316                  %x says to repeat the single charater x accross the whole
     2160    19317                  line.  For the others, CP-6 will look up the value and
     2161    19318                  use that to print on the banner.  Note that for %LOGO,
     2162    19319                  the entry options 'font' and 'icsh' are ignored.
     2163    19320        *****************************************************************/
     2164    19321    3   DCL A UBIN WORD;
     2165    19322    3   DCL MORE BIT(1);
     2166    19323    3   DCL PTR$ PTR;
     2167    19324    3   DCL FB$ PTR;
     2168    19325    3   DCL CODE UBIN WORD;
     2169    19326    3   DCL CODE2 UBIN WORD;
     2170    19327    3   DCL SUBNODES UBIN WORD;
     2171    19328    3   DCL SUBNS UBIN WORD;
     2172    19329    3   DCL FC_CHAR CHAR(FC_LEN) BASED(FC$);
     2173    19330    3   DCL FC_LEN UBIN WORD;
     2174    19331    3   DCL FC_BIT BIT(FC_B_LEN) BASED(FB$);
     2175    19332    3   DCL FC_B_LEN UBIN WORD;
     2176    19333
     2177    19334
     2178    19335
     2179    19336
     2180    19337
     2181    19338    3   P_PCB.ROOT$ = ADDR( F_A_OR_B_LIST );

  19338  4 007357   000073 236000 5                  LDQ     59
         4 007360   000001 756000 xsym               STQ     P_PCB+1

     2182    19339    3   ENUM=0;

  19339  4 007361   200004 450100                    STZ     ENUM,,AUTO

     2183    19340    3   IF A = 0 THEN

  19340  4 007362   204073 470500                    LDP0    @A,,AUTO
         4 007363   000000 235100                    LDA     0,,PR0
         4 007364   007412 601000 4                  TNZ     s:19351

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:336  
     2184    19341    4   DO;

     2185    19342    4      FB$ = PINCRW (DSEG1$,BNNR_OFFSET) ; /* Point to banner record   */

  19342  4 007365   000002 236000 3                  LDQ     BNNR_OFFSET
         4 007366   000022 736000                    QLS     18
         4 007367   000000 036000 xsym               ADLQ    DSEG1$
         4 007370   204076 756100                    STQ     FB$,,AUTO

     2186    19343    4      FC$ = PINCRW(DSEG1$,TEXT_OFFSET) ;

  19343  4 007371   000005 236000 3                  LDQ     TEXT_OFFSET
         4 007372   000022 736000                    QLS     18
         4 007373   000000 036000 xsym               ADLQ    DSEG1$
         4 007374   200006 756100                    STQ     FC$,,AUTO

     2187    19344    4      BNNR$ = FB$ ;

  19344  4 007375   204076 236100                    LDQ     FB$,,AUTO
         4 007376   000004 756000 2                  STQ     BNNR$

     2188    19345    4      FCB$ = ADDR(NIL);

  19345  4 007377   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 007400   200007 756100                    STQ     FCB$,,AUTO

     2189    19346    4      OLD_BANNER = '0'B;

  19346  4 007401   000000 450000 2                  STZ     OLD_BANNER

     2190    19347    4      FB$->FS$GBAN.INTR = 1;

  19347  4 007402   204076 471500                    LDP1    FB$,,AUTO
         4 007403   000100 101400                    MRL     fill='000'O
         4 007404   000003 000004 xsym               ADSC9   B_VECTNIL+3              cn=0,n=4
         4 007405   100000 400001                    ADSC9   0,,PR1                   cn=2,n=1

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:337  
     2191    19348    4      FB$->FS$GBAN.CHARGE=1;

  19348  4 007406   000100 101400                    MRL     fill='000'O
         4 007407   000003 000004 xsym               ADSC9   B_VECTNIL+3              cn=0,n=4
         4 007410   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

     2192    19349    4      END;       /* End of banner pointer initialization   */

  19349  4 007411   007436 710000 4                  TRA     s:19359

     2193    19350    4   ELSE DO ;

     2194    19351    4      FB$ = PINCRW (DSEG2$,ALGN_OFFSET) ; /* Point to alignment record   */

  19351  4 007412   000004 236000 3                  LDQ     ALGN_OFFSET
         4 007413   000022 736000                    QLS     18
         4 007414   000000 036000 xsym               ADLQ    DSEG2$
         4 007415   204076 756100                    STQ     FB$,,AUTO

     2195    19352    4      FC$ = PINCRW(DSEG2$,TEXT_OFFSET) ;

  19352  4 007416   000005 236000 3                  LDQ     TEXT_OFFSET
         4 007417   000022 736000                    QLS     18
         4 007420   000000 036000 xsym               ADLQ    DSEG2$
         4 007421   200006 756100                    STQ     FC$,,AUTO

     2196    19353    4      ALGN$ = FB$ ;

  19353  4 007422   204076 236100                    LDQ     FB$,,AUTO
         4 007423   000005 756000 2                  STQ     ALGN$

     2197    19354    4      FCA$ = ADDR(NIL) ;

  19354  4 007424   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 007425   200010 756100                    STQ     FCA$,,AUTO

     2198    19355    4      OLD_ALGN = '0'B;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:338  

  19355  4 007426   000001 450000 2                  STZ     OLD_ALGN

     2199    19356    4      FB$->FS$GBAN.INTR = 0;

  19356  4 007427   204076 471500                    LDP1    FB$,,AUTO
         4 007430   000100 101400                    MRL     fill='000'O
         4 007431   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 007432   100000 400001                    ADSC9   0,,PR1                   cn=2,n=1

     2200    19357    4      FB$->FS$GBAN.CHARGE=0;

  19357  4 007433   000100 101400                    MRL     fill='000'O
         4 007434   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 007435   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

     2201    19358    4      END;          /* End of alignment initialization  */

     2202    19359    3   FB$->FS$GBAN.NUM_ENTRIES=0;

  19359  4 007436   000100 101400                    MRL     fill='000'O
         4 007437   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 007440   100000 600001                    ADSC9   0,,PR1                   cn=3,n=1

     2203    19360    3   FB$->FS$GBAN.REPEATS=0;

  19360  4 007441   000100 101400                    MRL     fill='000'O
         4 007442   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 007443   100000 200001                    ADSC9   0,,PR1                   cn=1,n=1

     2204    19361    3   MORE = AS_TRUE;

  19361  4 007444   000000 236000 xsym               LDQ     AS_TRUE
         4 007445   400000 376003                    ANQ     -131072,DU
         4 007446   204074 756100                    STQ     MORE,,AUTO

     2205    19362    4   BANNER_LOOP: DO WHILE (MORE);
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:339  

  19362  4 007447   204074 234100       BANNER_LOOP  SZN     MORE,,AUTO
         4 007450   011402 605000 4                  TPL     PARSE_ERR

     2206    19363    4      CALL ASB$SET_PROMPT ( %PROMPT_SUB );

  19363  4 007451   000054 630400 5                  EPPR0   44
         4 007452   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007453   000000 701000 xent               TSX1    ASB$SET_PROMPT
         4 007454   000000 011000                    NOP     0

     2207    19364    4      CALL ASB$READ_SI(IN_BUF,ARS);

  19364  4 007455   200020 630500                    EPPR0   ARS,,AUTO
         4 007456   204111 450500                    STP0    @MAX_VAL+2,,AUTO
         4 007457   000034 236000 5                  LDQ     28
         4 007460   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 007461   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 007462   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 007463   000000 701000 xent               TSX1    ASB$READ_SI
         4 007464   000000 011000                    NOP     0

     2208    19365    4      P_PCB.NCHARS = ARS;

  19365  4 007465   200020 235100                    LDA     ARS,,AUTO
         4 007466   000011 755000 xsym               STA     P_PCB+9

     2209    19366    4      CALL X$PARSE( P_PCB ) ALTRET( PARSE_ERR);

  19366  4 007467   000003 630400 5                  EPPR0   3
         4 007470   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007471   000000 701000 xent               TSX1    X$PARSE
         4 007472   011402 702000 4                  TSX2    PARSE_ERR

     2210    19367    4      NODE$ = P_PCB.OUT$;

  19367  4 007473   000003 236000 xsym               LDQ     P_PCB+3
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:340  
         4 007474   000000 756000 xsym               STQ     NODE$

     2211    19368    4      SUBNS= P$NODE.SUBNODES;

  19368  4 007475   000000 470400 xsym               LDP0    NODE$
         4 007476   000001 236100                    LDQ     1,,PR0
         4 007477   000022 772000                    QRL     18
         4 007500   204102 756100                    STQ     SUBNS,,AUTO

     2212    19369    5   DO_I: DO I = 0 TO SUBNS -1;

  19369  4 007501   204053 450100       DO_I         STZ     I,,AUTO
         4 007502   011375 710000 4                  TRA     BANNER_LOOP_END+3

     2213    19370    5         PTR$=P$NODE.SUBLK$(I);

  19370  4 007503   000000 470400 xsym               LDP0    NODE$
         4 007504   204053 720100                    LXL0    I,,AUTO
         4 007505   000003 236110                    LDQ     3,X0,PR0
         4 007506   204075 756100                    STQ     PTR$,,AUTO

     2214    19371    5         CODE = PTR$->P$NODE.CODE;

  19371  4 007507   204075 471500                    LDP1    PTR$,,AUTO
         4 007510   100000 236100                    LDQ     0,,PR1
         4 007511   777777 376007                    ANQ     -1,DL
         4 007512   204077 756100                    STQ     CODE,,AUTO

     2215    19372    5         IF PTR$->P$NODE.SUBNODES = 0

  19372  4 007513   100001 221100                    LDX1    1,,PR1
         4 007514   007520 601000 4                  TNZ     s:19374

     2216    19373    5         THEN OP_CODE = 1   /*  YES_VAL  */;

  19373  4 007515   000001 235007                    LDA     1,DL
         4 007516   204064 755100                    STA     OP_CODE,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:341  
         4 007517   007524 710000 4                  TRA     DO_CASE

     2217    19374    5         ELSE OP_CODE = PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE;

  19374  4 007520   100003 473500                    LDP3    3,,PR1
         4 007521   300000 236100                    LDQ     0,,PR3
         4 007522   777777 376007                    ANQ     -1,DL
         4 007523   204064 756100                    STQ     OP_CODE,,AUTO

     2218    19375    6   DO_CASE: DO SELECT (CODE);

  19375  4 007524   204077 236100       DO_CASE      LDQ     CODE,,AUTO
         4 007525   000454 116007                    CMPQ    300,DL
         4 007526   007536 602000 4                  TNC     DO_CASE+10
         4 007527   007570 600000 4                  TZE     s:19381
         4 007530   000455 116007                    CMPQ    301,DL
         4 007531   011372 602000 4                  TNC     BANNER_LOOP_END
         4 007532   007564 600000 4                  TZE     s:19379
         4 007533   000456 116007                    CMPQ    302,DL
         4 007534   011372 601000 4                  TNZ     BANNER_LOOP_END
         4 007535   007560 710000 4                  TRA     s:19377
         4 007536   000044 116007                    CMPQ    36,DL
         4 007537   007547 602000 4                  TNC     DO_CASE+19
         4 007540   007657 600000 4                  TZE     s:19420
         4 007541   000045 116007                    CMPQ    37,DL
         4 007542   011372 602000 4                  TNC     BANNER_LOOP_END
         4 007543   007707 600000 4                  TZE     s:19446
         4 007544   000046 116007                    CMPQ    38,DL
         4 007545   011372 601000 4                  TNZ     BANNER_LOOP_END
         4 007546   007733 710000 4                  TRA     s:19470
         4 007547   000032 116007                    CMPQ    26,DL
         4 007550   007555 602000 4                  TNC     DO_CASE+25
         4 007551   007574 600000 4                  TZE     s:19383
         4 007552   000043 116007                    CMPQ    35,DL
         4 007553   011372 601000 4                  TNZ     BANNER_LOOP_END
         4 007554   007626 710000 4                  TRA     s:19393
         4 007555   000014 116007                    CMPQ    12,DL
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:342  
         4 007556   011372 601000 4                  TNZ     BANNER_LOOP_END
         4 007557   007574 710000 4                  TRA     s:19383

     2219    19376    6            SELECT( 302 /* HELP_VAL */ );

     2220    19377    6            CALL ASH$HELP;

  19377  4 007560   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 007561   000000 701000 xent               TSX1    ASH$HELP
         4 007562   000000 011000                    NOP     0
         4 007563   011372 710000 4                  TRA     BANNER_LOOP_END

     2221    19378    6            SELECT( 301 /* QUESTION_VAL */ );

     2222    19379    6            CALL ASH$QUEST;

  19379  4 007564   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 007565   000000 701000 xent               TSX1    ASH$QUEST
         4 007566   000000 011000                    NOP     0
         4 007567   011372 710000 4                  TRA     BANNER_LOOP_END

     2223    19380    6            SELECT( 300 /* DQUESTION_VAL */ );

     2224    19381    6            CALL ASH$DQUEST;

  19381  4 007570   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 007571   000000 701000 xent               TSX1    ASH$DQUEST
         4 007572   000000 011000                    NOP     0
         4 007573   011372 710000 4                  TRA     BANNER_LOOP_END

     2225    19382    6            SELECT(12   /*  END_VAL  */,26   /*  BLANK_LINE_VAL */);

     2226    19383    7            IF A = 0 THEN DO;

  19383  4 007574   204073 473500                    LDP3    @A,,AUTO
         4 007575   300000 235100                    LDA     0,,PR3
         4 007576   007612 601000 4                  TNZ     s:19388
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:343  

     2227    19384    7               IF FB$->FS$GBAN.NUM_ENTRIES = 0 THEN

  19384  4 007577   204076 474500                    LDP4    FB$,,AUTO
         4 007600   000100 101500                    MRL     fill='000'O
         4 007601   400000 600001                    ADSC9   0,,PR4                   cn=3,n=1
         4 007602   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 007603   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 007604   000000 116003                    CMPQ    0,DU
         4 007605   007624 601000 4                  TNZ     s:19390

     2228    19385    7                  F$->FS$GFORMREC.BANRDISP = 0;

  19385  4 007606   000000 221003                    LDX1    0,DU
         4 007607   204051 475500                    LDP5    F$,,AUTO
         4 007610   500003 741100                    STX1    3,,PR5

     2229    19386    7               END;

  19386  4 007611   007624 710000 4                  TRA     s:19390

     2230    19387    6            ELSE
     2231    19388    6               IF FB$->FS$GBAN.NUM_ENTRIES = 0 THEN

  19388  4 007612   204076 474500                    LDP4    FB$,,AUTO
         4 007613   000100 101500                    MRL     fill='000'O
         4 007614   400000 600001                    ADSC9   0,,PR4                   cn=3,n=1
         4 007615   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 007616   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 007617   000000 116003                    CMPQ    0,DU
         4 007620   007624 601000 4                  TNZ     s:19390

     2232    19389    6                  F$->FS$GFORMREC.ALGNDISP = 0;

  19389  4 007621   000000 221003                    LDX1    0,DU
         4 007622   204051 475500                    LDP5    F$,,AUTO
         4 007623   500003 441100                    SXL1    3,,PR5
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:344  

     2233    19390    6            RETURN;

  19390  4 007624   204072 221300                    LDX1  ! FOUND+1,,AUTO
         4 007625   000001 702211                    TSX2  ! 1,X1

     2234    19391
     2235    19392    6            SELECT(35 /* FB_CHARGE */);

     2236    19393    7            IF (A = 1) AND (OP_CODE = 1   /*  YES_VAL  */) THEN DO;

  19393  4 007626   204073 473500                    LDP3    @A,,AUTO
         4 007627   300000 235100                    LDA     0,,PR3
         4 007630   000001 115007                    CMPA    1,DL
         4 007631   007642 601000 4                  TNZ     s:19414
         4 007632   204064 235100                    LDA     OP_CODE,,AUTO
         4 007633   000001 115007                    CMPA    1,DL
         4 007634   007642 601000 4                  TNZ     s:19414

     2237    19394        /*   ERROR: ASF-E$ALIGNCHARGE-0
     2238    19395             MESSAGE: You can't charge for alignment images.
     2239    19396        */
     2240    19397                    %SCREAM( ERR#=E$ALIGNCHARGE,MID='F',LEVEL=ERROR);

  19409  4 007635   000074 630400 5                  EPPR0   60
         4 007636   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007637   000000 701000 xent               TSX1    ASH$ERROR
         4 007640   000000 011000                    NOP     0

     2241    19412    7               GOTO BANNER_LOOP_END;

  19412  4 007641   011372 710000 4                  TRA     BANNER_LOOP_END

     2242    19413    7               END;
     2243    19414    6            IF OP_CODE = 1   /*  YES_VAL  */ THEN

  19414  4 007642   204064 235100                    LDA     OP_CODE,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:345  
         4 007643   000001 115007                    CMPA    1,DL
         4 007644   007652 601000 4                  TNZ     s:19417

     2244    19415    6               FB$->FS$GBAN.CHARGE = 1;

  19415  4 007645   204076 474500                    LDP4    FB$,,AUTO
         4 007646   000100 101400                    MRL     fill='000'O
         4 007647   000003 000004 xsym               ADSC9   B_VECTNIL+3              cn=0,n=4
         4 007650   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         4 007651   011372 710000 4                  TRA     BANNER_LOOP_END

     2245    19416    6            ELSE
     2246    19417    6               FB$->FS$GBAN.CHARGE = 0;

  19417  4 007652   204076 474500                    LDP4    FB$,,AUTO
         4 007653   000100 101400                    MRL     fill='000'O
         4 007654   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 007655   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         4 007656   011372 710000 4                  TRA     BANNER_LOOP_END

     2247    19418
     2248    19419    6            SELECT( 36 /* FB_REPEATS */);

     2249    19420    6            BLK$=P$NODE.SUBLK$(I)->P$NODE.SUBLK$(0);

  19420  4 007657   000003 473510                    LDP3    3,X0,PR0
         4 007660   300003 236100                    LDQ     3,,PR3
         4 007661   204050 756100                    STQ     BLK$,,AUTO

     2250    19421    6            CALL CHARBIN(VAL , OUT$SYM.TEXT);

  19421  4 007662   204050 474500                    LDP4    BLK$,,AUTO
         4 007663   400004 236100                    LDQ     4,,PR4
         4 007664   000033 772000                    QRL     27
         4 007665   000000 622006                    EAX2    0,QL
         4 007666   000100 305540                    DTB
         4 007667   400004 230012                    NDSC9   4,,PR4                   cn=1,s=nosgn,sf=0,n=*X2
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:346  
         4 007670   204110 000010                    NDSC9   @MAX_VAL+1,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         4 007671   204111 235100                    LDA     @MAX_VAL+2,,AUTO
         4 007672   204065 755100                    STA     VAL,,AUTO

     2251    19422    6            IF VAL <= 511 THEN

  19422  4 007673   001000 115007                    CMPA    512,DL
         4 007674   007702 603000 4                  TRC     s:19440

     2252    19423    6               FB$->FS$GBAN.REPEATS = VAL;

  19423  4 007675   204076 473500                    LDP3    FB$,,AUTO
         4 007676   000100 101500                    MRL     fill='000'O
         4 007677   204065 000004                    ADSC9   VAL,,AUTO                cn=0,n=4
         4 007700   300000 200001                    ADSC9   0,,PR3                   cn=1,n=1
         4 007701   011372 710000 4                  TRA     BANNER_LOOP_END

     2253    19424    7            ELSE DO;

     2254    19425        /*   ERROR: ASF-E$BREPEATS-0
     2255    19426             MESSAGE: Too many repeats.
     2256    19427        */
     2257    19428                    %SCREAM( ERR#=E$BREPEATS,MID='F',LEVEL=ERROR);

  19440  4 007702   000075 630400 5                  EPPR0   61
         4 007703   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007704   000000 701000 xent               TSX1    ASH$ERROR
         4 007705   000000 011000                    NOP     0

     2258    19443    7               END;

  19443  4 007706   011372 710000 4                  TRA     BANNER_LOOP_END

     2259    19444
     2260    19445    6            SELECT( 37 /* FB_ALIGNEVERY */ );

     2261    19446    7            IF A = 0 THEN DO;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:347  

  19446  4 007707   204073 473500                    LDP3    @A,,AUTO
         4 007710   300000 235100                    LDA     0,,PR3
         4 007711   007717 601000 4                  TNZ     s:19467

     2262    19447        /*   ERROR: ASF-E$BEVERY-0
     2263    19448             MESSAGE: Alignevery meaningless for banners.
     2264    19449        */
     2265    19450                    %SCREAM( ERR#=E$BEVERY,MID='F',LEVEL=WARN );

  19460  4 007712   000076 630400 5                  EPPR0   62
         4 007713   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007714   000000 701000 xent               TSX1    ASH$WARN
         4 007715   000000 011000                    NOP     0

     2266    19465    7               END;

  19465  4 007716   011372 710000 4                  TRA     BANNER_LOOP_END

     2267    19466    6            ELSE
     2268    19467    6               FB$->FS$GBAN.ALIGNCTL.EVERY = ( OP_CODE = 1   /*  YES_VAL  */ );

  19467  4 007717   400000 222003                    LDX2    -131072,DU
         4 007720   204064 235100                    LDA     OP_CODE,,AUTO
         4 007721   000001 115007                    CMPA    1,DL
         4 007722   007724 600000 4                  TZE     s:19467+5
         4 007723   000000 222003                    LDX2    0,DU
         4 007724   000000 636012                    EAQ     0,X2
         4 007725   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 007726   204076 474500                    LDP4    FB$,,AUTO
         4 007727   003100 060500                    CSL     bolr='003'O
         4 007730   204110 000044                    BDSC    @MAX_VAL+1,,AUTO         by=0,bit=0,n=36
         4 007731   400000 000001                    BDSC    0,,PR4                   by=0,bit=0,n=1
         4 007732   011372 710000 4                  TRA     BANNER_LOOP_END

     2269    19468
     2270    19469    6            SELECT( 38 /* FB_ENTRY */);
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:348  

     2271    19470    7            IF ADDR(FB$->FS$GBAN.ENTRIES.MARK(ENUM)) >= FC$ THEN DO;

  19470  4 007733   200004 236100                    LDQ     ENUM,,AUTO
         4 007734   000014 402003                    MPY     12,DU
         4 007735   000133 036000 5                  ADLQ    91
         4 007736   204076 036100                    ADLQ    FB$,,AUTO
         4 007737   200006 116100                    CMPQ    FC$,,AUTO
         4 007740   007765 602000 4                  TNC     s:19497

     2272    19471        /*   ERROR: ASF-E$BANBUFFULL-0
     2273    19472             MESSAGE: The banner or alignment buffer has been exceeded.
     2274    19473                      You must re-enter the banner or alignment.
     2275    19474        */
     2276    19475                    %SCREAM( ERR#=E$BANBUFFULL,MID='F',LEVEL=ERROR);

  19487  4 007741   000100 630400 5                  EPPR0   64
         4 007742   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007743   000000 701000 xent               TSX1    ASH$ERROR
         4 007744   000000 011000                    NOP     0

     2277    19490    7               FB$->FS$GBAN.NUM_ENTRIES = 0;

  19490  4 007745   204076 470500                    LDP0    FB$,,AUTO
         4 007746   000100 101400                    MRL     fill='000'O
         4 007747   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 007750   000000 600001                    ADSC9   0,,PR0                   cn=3,n=1

     2278    19491    7               IF A = 0 THEN

  19491  4 007751   204073 471500                    LDP1    @A,,AUTO
         4 007752   100000 235100                    LDA     0,,PR1
         4 007753   007760 601000 4                  TNZ     s:19494

     2279    19492    7                  F$->FS$GFORMREC.BANRDISP = 0;

  19492  4 007754   000000 220003                    LDX0    0,DU
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:349  
         4 007755   204051 473500                    LDP3    F$,,AUTO
         4 007756   300003 740100                    STX0    3,,PR3
         4 007757   007763 710000 4                  TRA     s:19495

     2280    19493    7               ELSE
     2281    19494    7                  F$->FS$GFORMREC.ALGNDISP = 0;

  19494  4 007760   000000 220003                    LDX0    0,DU
         4 007761   204051 473500                    LDP3    F$,,AUTO
         4 007762   300003 440100                    SXL0    3,,PR3

     2282    19495    7               RETURN;

  19495  4 007763   204072 221300                    LDX1  ! FOUND+1,,AUTO
         4 007764   000001 702211                    TSX2  ! 1,X1

     2283    19496    7               END;
     2284    19497    6            SUBNODES = PTR$->P$NODE.SUBNODES;

  19497  4 007765   100001 236100                    LDQ     1,,PR1
         4 007766   000022 772000                    QRL     18
         4 007767   204101 756100                    STQ     SUBNODES,,AUTO

     2285    19498    6            IF FB$->FS$GBAN.REPEATS= 0 THEN

  19498  4 007770   204076 473500                    LDP3    FB$,,AUTO
         4 007771   000100 101500                    MRL     fill='000'O
         4 007772   300000 200001                    ADSC9   0,,PR3                   cn=1,n=1
         4 007773   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 007774   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 007775   000000 116003                    CMPQ    0,DU
         4 007776   010002 601000 4                  TNZ     s:19500

     2286    19499    6               FB$->FS$GBAN.REPEATS = 1;

  19499  4 007777   000100 101400                    MRL     fill='000'O
         4 010000   000003 000004 xsym               ADSC9   B_VECTNIL+3              cn=0,n=4
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:350  
         4 010001   300000 200001                    ADSC9   0,,PR3                   cn=1,n=1

     2287    19500    7            IF SUBNODES < 2 OR SUBNODES > 7 THEN DO;

  19500  4 010002   204101 235100                    LDA     SUBNODES,,AUTO
         4 010003   000002 115007                    CMPA    2,DL
         4 010004   010007 602000 4                  TNC     s:19517
         4 010005   000010 115007                    CMPA    8,DL
         4 010006   010014 602000 4                  TNC     s:19522

     2288    19501        /*   ERROR: ASF-E$BADENTRY-0
     2289    19502             MESSAGE: Bad number of entrys.
     2290    19503             MESSAGE1: There must be between 2 and 8 numbers.
     2291    19504        */
     2292    19505                    %SCREAM( ERR#=E$BADENTRY,MID='F',LEVEL=ERROR);

  19517  4 010007   000101 630400 5                  EPPR0   65
         4 010010   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 010011   000000 701000 xent               TSX1    ASH$ERROR
         4 010012   000000 011000                    NOP     0

     2293    19520    7               GOTO BANNER_LOOP_END;

  19520  4 010013   011372 710000 4                  TRA     BANNER_LOOP_END

     2294    19521    7               END;
     2295    19522    6            FB$->FS$GBAN.ENTRIES.CHARUP.CHARUP_OPCODE.CLASS(ENUM) = %
             19522                     XG_COOP_ATTR_BAS_NONE_2#;

  19522  4 010014   200004 236100                    LDQ     ENUM,,AUTO
         4 010015   000060 402007                    MPY     48,DL
         4 010016   000106 101400                    MRL     fill='000'O
         4 010017   000134 000004 5                  ADSC9   92                       cn=0,n=4
         4 010020   300001 000001                    ADSC9   1,Q,PR3                  cn=0,n=1

     2296    19523    6            FB$->FS$GBAN.ENTRIES.CHARUP.CHARUP_OPCODE.INDX(ENUM) = %
             19523                     XG_COOP_SET_CHARACTER_UP#;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:351  

  19523  4 010021   000106 101400                    MRL     fill='000'O
         4 010022   000111 000004 5                  ADSC9   73                       cn=0,n=4
         4 010023   300001 200001                    ADSC9   1,Q,PR3                  cn=1,n=1

     2297    19524    6            FB$->FS$GBAN.ENTRIES.CHARSIZE.CHARSIZE_OPCODE.CLASS(ENUM) = %
             19524                     XG_COOP_ATTR_BAS_NONE_2#;

  19524  4 010024   000106 101400                    MRL     fill='000'O
         4 010025   000134 000004 5                  ADSC9   92                       cn=0,n=4
         4 010026   300003 200001                    ADSC9   3,Q,PR3                  cn=1,n=1

     2298    19525    6            FB$->FS$GBAN.ENTRIES.CHARSIZE.CHARSIZE_OPCODE.INDX(ENUM) = %
             19525                     XG_COOP_SET_CHARSIZE#;

  19525  4 010027   000106 101400                    MRL     fill='000'O
         4 010030   000011 000004 xsym               ADSC9   B_VECTNIL+9              cn=0,n=4
         4 010031   300003 400001                    ADSC9   3,Q,PR3                  cn=2,n=1

     2299    19526    6            FB$->FS$GBAN.ENTRIES.CHARSPACE.CHARSPACE_OPCODE.CLASS(ENUM) = %
             19526                     XG_COOP_ATTR_BAS_NONE_2#;

  19526  4 010032   000106 101400                    MRL     fill='000'O
         4 010033   000134 000004 5                  ADSC9   92                       cn=0,n=4
         4 010034   300005 600001                    ADSC9   5,Q,PR3                  cn=3,n=1

     2300    19527    6            FB$->FS$GBAN.ENTRIES.CHARSPACE.CHARSPACE_OPCODE.INDX(ENUM) = %
             19527                     XG_COOP_SET_CHARSPACE#;

  19527  4 010035   000106 101400                    MRL     fill='000'O
         4 010036   000012 000004 xsym               ADSC9   B_VECTNIL+10             cn=0,n=4
         4 010037   300006 000001                    ADSC9   6,Q,PR3                  cn=0,n=1

     2301    19528    6            FB$->FS$GBAN.ENTRIES.Z_VAL(ENUM) = 0;

  19528  4 010040   000106 101400                    MRL     fill='000'O
         4 010041   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:352  
         4 010042   300010 200002                    ADSC9   8,Q,PR3                  cn=1,n=2

     2302    19529    6            FB$->FS$GBAN.ENTRIES.NDC_Z_VAL(ENUM) = 0;

  19529  4 010043   000106 101400                    MRL     fill='000'O
         4 010044   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 010045   300011 600002                    ADSC9   9,Q,PR3                  cn=3,n=2

     2303    19530    6            FB$->FS$GBAN.ENTRIES.DIRECTION(ENUM) = 90;/* Up */

  19530  4 010046   000106 101400                    MRL     fill='000'O
         4 010047   000135 000004 5                  ADSC9   93                       cn=0,n=4
         4 010050   300003 000001                    ADSC9   3,Q,PR3                  cn=0,n=1

     2304    19531    6            FB$->FS$GBAN.ENTRIES.CHARUP.X(ENUM) = %XG_DEFAULT_MAX_NDC# ;

  19531  4 010051   000106 101400                    MRL     fill='000'O
         4 010052   000131 000004 5                  ADSC9   89                       cn=0,n=4
         4 010053   300001 400002                    ADSC9   1,Q,PR3                  cn=2,n=2

     2305    19532    6            FB$->FS$GBAN.ENTRIES.CHARUP.Y(ENUM) = 0;

  19532  4 010054   000106 101400                    MRL     fill='000'O
         4 010055   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 010056   300002 000002                    ADSC9   2,Q,PR3                  cn=0,n=2

     2306    19533    6            FB$->FS$GBAN.ENTRIES.CHARUP.Z(ENUM) = 0;

  19533  4 010057   000106 101400                    MRL     fill='000'O
         4 010060   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 010061   300002 400002                    ADSC9   2,Q,PR3                  cn=2,n=2

     2307    19534    6            FB$->FS$GBAN.ENTRIES.CHARSIZE.CHAR_WIDTH(ENUM)='1'B;

  19534  4 010062   000106 100400                    MLR     fill='000'O
         4 010063   000030 000001 xsym               ADSC9   B_VECTNIL+24             cn=0,n=1
         4 010064   300003 600002                    ADSC9   3,Q,PR3                  cn=3,n=2
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:353  

     2308    19535    6            FB$->FS$GBAN.ENTRIES.CHARSIZE.CHAR_HITE(ENUM)='1'B;

  19535  4 010065   000106 100400                    MLR     fill='000'O
         4 010066   000030 000001 xsym               ADSC9   B_VECTNIL+24             cn=0,n=1
         4 010067   300004 200002                    ADSC9   4,Q,PR3                  cn=1,n=2

     2309    19536    6            FB$->FS$GBAN.ENTRIES.CHAR_WIDTH(ENUM) = 1;

  19536  4 010070   000106 101400                    MRL     fill='000'O
         4 010071   000003 000004 xsym               ADSC9   B_VECTNIL+3              cn=0,n=4
         4 010072   300004 600002                    ADSC9   4,Q,PR3                  cn=3,n=2

     2310    19537    6            FB$->FS$GBAN.ENTRIES.CHAR_HITE(ENUM) = 1;

  19537  4 010073   000106 101400                    MRL     fill='000'O
         4 010074   000003 000004 xsym               ADSC9   B_VECTNIL+3              cn=0,n=4
         4 010075   300005 200002                    ADSC9   5,Q,PR3                  cn=1,n=2

     2311    19538    6            FB$->FS$GBAN.ENTRIES.CHARSPACE.CHAR_SPACE(ENUM)='0'B;

  19538  4 010076   000106 100400                    MLR     fill='000'O
         4 010077   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 010100   300006 200002                    ADSC9   6,Q,PR3                  cn=1,n=2

     2312    19539    6            FB$->FS$GBAN.ENTRIES.CHAR_SPACE(ENUM) = 0;

  19539  4 010101   000106 101400                    MRL     fill='000'O
         4 010102   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 010103   300006 600002                    ADSC9   6,Q,PR3                  cn=3,n=2

     2313    19540    6            FB$->FS$GBAN.ENTRIES.COUNT(ENUM)=0;

  19540  4 010104   000106 101400                    MRL     fill='000'O
         4 010105   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 010106   300012 400001                    ADSC9   10,Q,PR3                 cn=2,n=1

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:354  
     2314    19541    6            FB$->FS$GBAN.ENTRIES.DISP(ENUM)=0;

  19541  4 010107   000106 101400                    MRL     fill='000'O
         4 010110   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 010111   300012 600002                    ADSC9   10,Q,PR3                 cn=3,n=2

     2315    19542    7            DO K= 0 TO SUBNODES-1;

  19542  4 010112   204055 450100                    STZ     K,,AUTO
         4 010113   010476 710000 4                  TRA     s:19627+3

     2316    19543    7               BLK$=PTR$->P$NODE.SUBLK$(K);

  19543  4 010114   204075 470500                    LDP0    PTR$,,AUTO
         4 010115   204055 720100                    LXL0    K,,AUTO
         4 010116   000003 236110                    LDQ     3,X0,PR0
         4 010117   204050 756100                    STQ     BLK$,,AUTO

     2317    19544    7               IF (K ~= 3)

  19544  4 010120   204055 235100                    LDA     K,,AUTO
         4 010121   000003 115007                    CMPA    3,DL
         4 010122   010130 600000 4                  TZE     s:19549

     2318    19545    8               THEN DO;  /* Percentage for all but rotation */

     2319    19546    8                  CALL CHANGE162_9X9 (100) ALTRET (BANNER_LOOP_END);

  19546  4 010123   000137 236000 5                  LDQ     95
         4 010124   204107 756100                    STQ     J+2,,AUTO
         4 010125   011407 701000 4                  TSX1    CHANGE162_9X9
         4 010126   011372 702000 4                  TSX2    BANNER_LOOP_END

     2320    19547    8                  END;

  19547  4 010127   010134 710000 4                  TRA     s:19551

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:355  
     2321    19548    8               ELSE DO; /* Check and convert rotation */

     2322    19549    8                  CALL CHANGE162_9X9 (400) ALTRET (BANNER_LOOP_END);

  19549  4 010130   000141 236000 5                  LDQ     97
         4 010131   204107 756100                    STQ     J+2,,AUTO
         4 010132   011407 701000 4                  TSX1    CHANGE162_9X9
         4 010133   011372 702000 4                  TSX2    BANNER_LOOP_END

     2323    19550    8                  END;

     2324    19551    8               DO SELECT(K);

  19551  4 010134   204055 236100                    LDQ     K,,AUTO
         4 010135   000003 116007                    CMPQ    3,DL
         4 010136   010151 602000 4                  TNC     s:19551+13
         4 010137   010256 600000 4                  TZE     s:19568
         4 010140   000005 116007                    CMPQ    5,DL
         4 010141   010146 602000 4                  TNC     s:19551+10
         4 010142   010424 600000 4                  TZE     s:19617
         4 010143   000006 116007                    CMPQ    6,DL
         4 010144   010473 601000 4                  TNZ     s:19627
         4 010145   010450 710000 4                  TRA     s:19622
         4 010146   000004 116007                    CMPQ    4,DL
         4 010147   010473 601000 4                  TNZ     s:19627
         4 010150   010400 710000 4                  TRA     s:19612
         4 010151   000001 116007                    CMPQ    1,DL
         4 010152   010157 602000 4                  TNC     s:19551+19
         4 010153   010206 600000 4                  TZE     s:19558
         4 010154   000002 116007                    CMPQ    2,DL
         4 010155   010473 601000 4                  TNZ     s:19627
         4 010156   010232 710000 4                  TRA     s:19563
         4 010157   000000 116003                    CMPQ    0,DU
         4 010160   010162 600000 4                  TZE     s:19553
         4 010161   010473 710000 4                  TRA     s:19627

     2325    19552    8                  SELECT(0);
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:356  

     2326    19553    8                  FB$->FS$GBAN.ENTRIES.X_VAL(ENUM) = VAL;

  19553  4 010162   200004 236100                    LDQ     ENUM,,AUTO
         4 010163   000060 402007                    MPY     48,DL
         4 010164   204076 470500                    LDP0    FB$,,AUTO
         4 010165   000106 101500                    MRL     fill='000'O
         4 010166   204065 000004                    ADSC9   VAL,,AUTO                cn=0,n=4
         4 010167   000007 200002                    ADSC9   7,Q,PR0                  cn=1,n=2

     2327    19554    8                  VAL = (VAL * %XG_DEFAULT_MAX_NDC# ) / 100;

  19554  4 010170   204065 236100                    LDQ     VAL,,AUTO
         4 010171   077777 402007                    MPY     32767,DL
         4 010172   000001 772000                    QRL     1
         4 010173   000062 506007                    DIV     50,DL
         4 010174   204065 756100                    STQ     VAL,,AUTO

     2328    19555    8                  CALL SPLIT_VAL;

  19555  4 010175   011473 701000 4                  TSX1    SPLIT_VAL
         4 010176   000000 011000                    NOP     0

     2329    19556    8                  FB$->FS$GBAN.ENTRIES.NDC_X_VAL (ENUM) = UBINSPLIT;

  19556  4 010177   200004 236100                    LDQ     ENUM,,AUTO
         4 010200   000060 402007                    MPY     48,DL
         4 010201   204076 470500                    LDP0    FB$,,AUTO
         4 010202   000106 100500                    MLR     fill='000'O
         4 010203   204066 000002                    ADSC9   SPLIT,,AUTO              cn=0,n=2
         4 010204   000010 600002                    ADSC9   8,Q,PR0                  cn=3,n=2
         4 010205   010473 710000 4                  TRA     s:19627

     2330    19557    8                  SELECT(1);

     2331    19558    8                  FB$->FS$GBAN.ENTRIES.Y_VAL(ENUM) = VAL;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:357  
  19558  4 010206   200004 236100                    LDQ     ENUM,,AUTO
         4 010207   000060 402007                    MPY     48,DL
         4 010210   204076 470500                    LDP0    FB$,,AUTO
         4 010211   000106 101500                    MRL     fill='000'O
         4 010212   204065 000004                    ADSC9   VAL,,AUTO                cn=0,n=4
         4 010213   000007 600002                    ADSC9   7,Q,PR0                  cn=3,n=2

     2332    19559    8                  VAL = (VAL * %XG_DEFAULT_MAX_NDC# ) / 100;

  19559  4 010214   204065 236100                    LDQ     VAL,,AUTO
         4 010215   077777 402007                    MPY     32767,DL
         4 010216   000001 772000                    QRL     1
         4 010217   000062 506007                    DIV     50,DL
         4 010220   204065 756100                    STQ     VAL,,AUTO

     2333    19560    8                  CALL SPLIT_VAL;

  19560  4 010221   011473 701000 4                  TSX1    SPLIT_VAL
         4 010222   000000 011000                    NOP     0

     2334    19561    8                  FB$->FS$GBAN.ENTRIES.NDC_Y_VAL (ENUM) = UBINSPLIT;

  19561  4 010223   200004 236100                    LDQ     ENUM,,AUTO
         4 010224   000060 402007                    MPY     48,DL
         4 010225   204076 470500                    LDP0    FB$,,AUTO
         4 010226   000106 100500                    MLR     fill='000'O
         4 010227   204066 000002                    ADSC9   SPLIT,,AUTO              cn=0,n=2
         4 010230   000011 200002                    ADSC9   9,Q,PR0                  cn=1,n=2
         4 010231   010473 710000 4                  TRA     s:19627

     2335    19562    8                  SELECT(2);

     2336    19563    8                  FB$->FS$GBAN.ENTRIES.Z_VAL(ENUM) = VAL;

  19563  4 010232   200004 236100                    LDQ     ENUM,,AUTO
         4 010233   000060 402007                    MPY     48,DL
         4 010234   204076 470500                    LDP0    FB$,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:358  
         4 010235   000106 101500                    MRL     fill='000'O
         4 010236   204065 000004                    ADSC9   VAL,,AUTO                cn=0,n=4
         4 010237   000010 200002                    ADSC9   8,Q,PR0                  cn=1,n=2

     2337    19564    8                  VAL = (VAL * %XG_DEFAULT_MAX_NDC# ) / 100;

  19564  4 010240   204065 236100                    LDQ     VAL,,AUTO
         4 010241   077777 402007                    MPY     32767,DL
         4 010242   000001 772000                    QRL     1
         4 010243   000062 506007                    DIV     50,DL
         4 010244   204065 756100                    STQ     VAL,,AUTO

     2338    19565    8                  CALL SPLIT_VAL;

  19565  4 010245   011473 701000 4                  TSX1    SPLIT_VAL
         4 010246   000000 011000                    NOP     0

     2339    19566    8                  FB$->FS$GBAN.ENTRIES.NDC_Z_VAL (ENUM) = UBINSPLIT;

  19566  4 010247   200004 236100                    LDQ     ENUM,,AUTO
         4 010250   000060 402007                    MPY     48,DL
         4 010251   204076 470500                    LDP0    FB$,,AUTO
         4 010252   000106 100500                    MLR     fill='000'O
         4 010253   204066 000002                    ADSC9   SPLIT,,AUTO              cn=0,n=2
         4 010254   000011 600002                    ADSC9   9,Q,PR0                  cn=3,n=2
         4 010255   010473 710000 4                  TRA     s:19627

     2340    19567    8                  SELECT(3);

     2341    19568    9                  DO SELECT (VAL);

  19568  4 010256   204065 236100                    LDQ     VAL,,AUTO
         4 010257   000132 116007                    CMPQ    90,DL
         4 010260   010270 602000 4                  TNC     s:19568+10
         4 010261   010313 600000 4                  TZE     s:19575
         4 010262   000264 116007                    CMPQ    180,DL
         4 010263   010373 602000 4                  TNC     s:19606
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:359  
         4 010264   010333 600000 4                  TZE     s:19580
         4 010265   000416 116007                    CMPQ    270,DL
         4 010266   010373 601000 4                  TNZ     s:19606
         4 010267   010353 710000 4                  TRA     s:19585
         4 010270   000000 116003                    CMPQ    0,DU
         4 010271   010273 600000 4                  TZE     s:19570
         4 010272   010373 710000 4                  TRA     s:19606

     2342    19569    9                     SELECT (0);

     2343    19570    9                     FB$->FS$GBAN.ENTRIES.DIRECTION (ENUM) = 0;

  19570  4 010273   200004 236100                    LDQ     ENUM,,AUTO
         4 010274   000060 402007                    MPY     48,DL
         4 010275   204076 470500                    LDP0    FB$,,AUTO
         4 010276   000106 101400                    MRL     fill='000'O
         4 010277   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 010300   000003 000001                    ADSC9   3,Q,PR0                  cn=0,n=1

     2344    19571    9                     FB$->FS$GBAN.ENTRIES.CHARUP.X (ENUM) = 0;

  19571  4 010301   000106 101400                    MRL     fill='000'O
         4 010302   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 010303   000001 400002                    ADSC9   1,Q,PR0                  cn=2,n=2

     2345    19572    9                     FB$->FS$GBAN.ENTRIES.CHARUP.Y (ENUM) = 32767;  /* A one */

  19572  4 010304   000106 101400                    MRL     fill='000'O
         4 010305   000131 000004 5                  ADSC9   89                       cn=0,n=4
         4 010306   000002 000002                    ADSC9   2,Q,PR0                  cn=0,n=2

     2346    19573    9                     FB$->FS$GBAN.ENTRIES.CHARUP.Z (ENUM) = 0;

  19573  4 010307   000106 101400                    MRL     fill='000'O
         4 010310   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 010311   000002 400002                    ADSC9   2,Q,PR0                  cn=2,n=2
         4 010312   010473 710000 4                  TRA     s:19627
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:360  

     2347    19574    9                     SELECT (90);

     2348    19575    9                     FB$->FS$GBAN.ENTRIES.DIRECTION (ENUM) = 90;

  19575  4 010313   200004 236100                    LDQ     ENUM,,AUTO
         4 010314   000060 402007                    MPY     48,DL
         4 010315   204076 470500                    LDP0    FB$,,AUTO
         4 010316   000106 101400                    MRL     fill='000'O
         4 010317   000135 000004 5                  ADSC9   93                       cn=0,n=4
         4 010320   000003 000001                    ADSC9   3,Q,PR0                  cn=0,n=1

     2349    19576    9                     FB$->FS$GBAN.ENTRIES.CHARUP.X (ENUM) = %XG_DEFAULT_MAX_NDC# ;

  19576  4 010321   000106 101400                    MRL     fill='000'O
         4 010322   000131 000004 5                  ADSC9   89                       cn=0,n=4
         4 010323   000001 400002                    ADSC9   1,Q,PR0                  cn=2,n=2

     2350    19577    9                     FB$->FS$GBAN.ENTRIES.CHARUP.Y (ENUM) = 0;

  19577  4 010324   000106 101400                    MRL     fill='000'O
         4 010325   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 010326   000002 000002                    ADSC9   2,Q,PR0                  cn=0,n=2

     2351    19578    9                     FB$->FS$GBAN.ENTRIES.CHARUP.Z (ENUM) = 0;

  19578  4 010327   000106 101400                    MRL     fill='000'O
         4 010330   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 010331   000002 400002                    ADSC9   2,Q,PR0                  cn=2,n=2
         4 010332   010473 710000 4                  TRA     s:19627

     2352    19579    9                     SELECT (180);

     2353    19580    9                     FB$->FS$GBAN.ENTRIES.DIRECTION (ENUM) = 180;

  19580  4 010333   200004 236100                    LDQ     ENUM,,AUTO
         4 010334   000060 402007                    MPY     48,DL
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:361  
         4 010335   204076 470500                    LDP0    FB$,,AUTO
         4 010336   000106 101400                    MRL     fill='000'O
         4 010337   000142 000004 5                  ADSC9   98                       cn=0,n=4
         4 010340   000003 000001                    ADSC9   3,Q,PR0                  cn=0,n=1

     2354    19581    9                     FB$->FS$GBAN.ENTRIES.CHARUP.X (ENUM) = 0;

  19581  4 010341   000106 101400                    MRL     fill='000'O
         4 010342   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 010343   000001 400002                    ADSC9   1,Q,PR0                  cn=2,n=2

     2355    19582    9                     FB$->FS$GBAN.ENTRIES.CHARUP.Y (ENUM) = %XG_DEFAULT_MAX_NDC# ;

  19582  4 010344   000106 101400                    MRL     fill='000'O
         4 010345   000131 000004 5                  ADSC9   89                       cn=0,n=4
         4 010346   000002 000002                    ADSC9   2,Q,PR0                  cn=0,n=2

     2356    19583    9                     FB$->FS$GBAN.ENTRIES.CHARUP.Z (ENUM) = 0;

  19583  4 010347   000106 101400                    MRL     fill='000'O
         4 010350   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 010351   000002 400002                    ADSC9   2,Q,PR0                  cn=2,n=2
         4 010352   010473 710000 4                  TRA     s:19627

     2357    19584    9                     SELECT (270);

     2358    19585    9                     FB$->FS$GBAN.ENTRIES.DIRECTION (ENUM) = 270;

  19585  4 010353   200004 236100                    LDQ     ENUM,,AUTO
         4 010354   000060 402007                    MPY     48,DL
         4 010355   204076 470500                    LDP0    FB$,,AUTO
         4 010356   000106 101400                    MRL     fill='000'O
         4 010357   000143 000004 5                  ADSC9   99                       cn=0,n=4
         4 010360   000003 000001                    ADSC9   3,Q,PR0                  cn=0,n=1

     2359    19586    9                     FB$->FS$GBAN.ENTRIES.CHARUP.X (ENUM) = 32767;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:362  
  19586  4 010361   000106 101400                    MRL     fill='000'O
         4 010362   000131 000004 5                  ADSC9   89                       cn=0,n=4
         4 010363   000001 400002                    ADSC9   1,Q,PR0                  cn=2,n=2

     2360    19587    9                     FB$->FS$GBAN.ENTRIES.CHARUP.Y (ENUM) = 0;

  19587  4 010364   000106 101400                    MRL     fill='000'O
         4 010365   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 010366   000002 000002                    ADSC9   2,Q,PR0                  cn=0,n=2

     2361    19588    9                     FB$->FS$GBAN.ENTRIES.CHARUP.Z (ENUM) = 0;

  19588  4 010367   000106 101400                    MRL     fill='000'O
         4 010370   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 010371   000002 400002                    ADSC9   2,Q,PR0                  cn=2,n=2
         4 010372   010473 710000 4                  TRA     s:19627

     2362    19589    9                     SELECT (ELSE);

     2363    19590        /*E* ERROR: ASF-E$BADROTATIONGRAPHIC-C
     2364    19591           MESSAGE: The allow specification for rotation is only 0, 90, 180 or 270 degrees.
     2365    19592             MESSAGE1: Value must also be below 361 degrees.
     2366    19593        */
     2367    19594                       %SCREAM (ERR#=E$BADROTATIONGRAPHIC,MID='F',LEVEL=ERROR);

  19606  4 010373   000144 630400 5                  EPPR0   100
         4 010374   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 010375   000000 701000 xent               TSX1    ASH$ERROR
         4 010376   000000 011000                    NOP     0

     2368    19609    9                  GOTO BANNER_LOOP_END;

  19609  4 010377   011372 710000 4                  TRA     BANNER_LOOP_END

     2369    19610    9                     END; /* Do case on val */

     2370    19611    8               SELECT(4);
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:363  

     2371    19612    8               FB$->FS$GBAN.ENTRIES.CHAR_WIDTH(ENUM) =VAL;

  19612  4 010400   200004 236100                    LDQ     ENUM,,AUTO
         4 010401   000060 402007                    MPY     48,DL
         4 010402   204076 470500                    LDP0    FB$,,AUTO
         4 010403   000106 101500                    MRL     fill='000'O
         4 010404   204065 000004                    ADSC9   VAL,,AUTO                cn=0,n=4
         4 010405   000004 600002                    ADSC9   4,Q,PR0                  cn=3,n=2

     2372    19613    8               VAL = (VAL * %XG_DEFAULT_MAX_NDC# ) / 100;

  19613  4 010406   204065 236100                    LDQ     VAL,,AUTO
         4 010407   077777 402007                    MPY     32767,DL
         4 010410   000001 772000                    QRL     1
         4 010411   000062 506007                    DIV     50,DL
         4 010412   204065 756100                    STQ     VAL,,AUTO

     2373    19614    8               CALL SPLIT_VAL;

  19614  4 010413   011473 701000 4                  TSX1    SPLIT_VAL
         4 010414   000000 011000                    NOP     0

     2374    19615    8               FB$->FS$GBAN.ENTRIES.CHARSIZE.CHAR_WIDTH (ENUM) = SPLIT;

  19615  4 010415   200004 236100                    LDQ     ENUM,,AUTO
         4 010416   000060 402007                    MPY     48,DL
         4 010417   204076 470500                    LDP0    FB$,,AUTO
         4 010420   000106 100500                    MLR     fill='000'O
         4 010421   204066 000002                    ADSC9   SPLIT,,AUTO              cn=0,n=2
         4 010422   000003 600002                    ADSC9   3,Q,PR0                  cn=3,n=2
         4 010423   010473 710000 4                  TRA     s:19627

     2375    19616    8               SELECT(5);

     2376    19617    8               FB$->FS$GBAN.ENTRIES.CHAR_HITE(ENUM) = VAL;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:364  
  19617  4 010424   200004 236100                    LDQ     ENUM,,AUTO
         4 010425   000060 402007                    MPY     48,DL
         4 010426   204076 470500                    LDP0    FB$,,AUTO
         4 010427   000106 101500                    MRL     fill='000'O
         4 010430   204065 000004                    ADSC9   VAL,,AUTO                cn=0,n=4
         4 010431   000005 200002                    ADSC9   5,Q,PR0                  cn=1,n=2

     2377    19618    8               VAL = (VAL * %XG_DEFAULT_MAX_NDC# ) / 100;

  19618  4 010432   204065 236100                    LDQ     VAL,,AUTO
         4 010433   077777 402007                    MPY     32767,DL
         4 010434   000001 772000                    QRL     1
         4 010435   000062 506007                    DIV     50,DL
         4 010436   204065 756100                    STQ     VAL,,AUTO

     2378    19619    8               CALL SPLIT_VAL;

  19619  4 010437   011473 701000 4                  TSX1    SPLIT_VAL
         4 010440   000000 011000                    NOP     0

     2379    19620    8               FB$->FS$GBAN.ENTRIES.CHARSIZE.CHAR_HITE (ENUM) = SPLIT;

  19620  4 010441   200004 236100                    LDQ     ENUM,,AUTO
         4 010442   000060 402007                    MPY     48,DL
         4 010443   204076 470500                    LDP0    FB$,,AUTO
         4 010444   000106 100500                    MLR     fill='000'O
         4 010445   204066 000002                    ADSC9   SPLIT,,AUTO              cn=0,n=2
         4 010446   000004 200002                    ADSC9   4,Q,PR0                  cn=1,n=2
         4 010447   010473 710000 4                  TRA     s:19627

     2380    19621    8               SELECT(6);

     2381    19622    8               FB$->FS$GBAN.ENTRIES.CHAR_SPACE(ENUM) =VAL;

  19622  4 010450   200004 236100                    LDQ     ENUM,,AUTO
         4 010451   000060 402007                    MPY     48,DL
         4 010452   204076 470500                    LDP0    FB$,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:365  
         4 010453   000106 101500                    MRL     fill='000'O
         4 010454   204065 000004                    ADSC9   VAL,,AUTO                cn=0,n=4
         4 010455   000006 600002                    ADSC9   6,Q,PR0                  cn=3,n=2

     2382    19623    8               VAL = (VAL * %XG_DEFAULT_MAX_NDC# ) / 100;

  19623  4 010456   204065 236100                    LDQ     VAL,,AUTO
         4 010457   077777 402007                    MPY     32767,DL
         4 010460   000001 772000                    QRL     1
         4 010461   000062 506007                    DIV     50,DL
         4 010462   204065 756100                    STQ     VAL,,AUTO

     2383    19624    8               CALL SPLIT_VAL;

  19624  4 010463   011473 701000 4                  TSX1    SPLIT_VAL
         4 010464   000000 011000                    NOP     0

     2384    19625    8               FB$->FS$GBAN.ENTRIES.CHARSPACE.CHAR_SPACE (ENUM) = SPLIT;

  19625  4 010465   200004 236100                    LDQ     ENUM,,AUTO
         4 010466   000060 402007                    MPY     48,DL
         4 010467   204076 470500                    LDP0    FB$,,AUTO
         4 010470   000106 100500                    MLR     fill='000'O
         4 010471   204066 000002                    ADSC9   SPLIT,,AUTO              cn=0,n=2
         4 010472   000006 200002                    ADSC9   6,Q,PR0                  cn=1,n=2

     2385    19626    8                  END; /* Do case for entries */

     2386    19627    7               END;

  19627  4 010473   204055 235100                    LDA     K,,AUTO
         4 010474   000001 035007                    ADLA    1,DL
         4 010475   204055 755100                    STA     K,,AUTO
         4 010476   204055 236100                    LDQ     K,,AUTO
         4 010477   204101 116100                    CMPQ    SUBNODES,,AUTO
         4 010500   010114 602000 4                  TNC     s:19543

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:366  
     2387    19628    6            CALL ASB$SET_PROMPT ( %PROMPT_TXT );

  19628  4 010501   000070 630400 5                  EPPR0   56
         4 010502   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 010503   000000 701000 xent               TSX1    ASB$SET_PROMPT
         4 010504   000000 011000                    NOP     0

     2388    19629    6            CALL ASB$READ_SI(IN_BUF,ARS);

  19629  4 010505   200020 630500                    EPPR0   ARS,,AUTO
         4 010506   204111 450500                    STP0    @MAX_VAL+2,,AUTO
         4 010507   000034 236000 5                  LDQ     28
         4 010510   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 010511   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 010512   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 010513   000000 701000 xent               TSX1    ASB$READ_SI
         4 010514   000000 011000                    NOP     0

     2389    19630    6            P_PCB.ROOT$ = ADDR( FB_TYPE_LIST );

  19630  4 010515   000103 236000 5                  LDQ     67
         4 010516   000001 756000 xsym               STQ     P_PCB+1

     2390    19631    6            P_PCB.NCHARS = ARS;

  19631  4 010517   200020 235100                    LDA     ARS,,AUTO
         4 010520   000011 755000 xsym               STA     P_PCB+9

     2391    19632    6            CALL X$PARSE(P_PCB) ALTRET( PARSE_ERR);

  19632  4 010521   000003 630400 5                  EPPR0   3
         4 010522   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 010523   000000 701000 xent               TSX1    X$PARSE
         4 010524   011402 702000 4                  TSX2    PARSE_ERR

     2392    19633    6            CODE2= P_PCB.OUT$->P$NODE.CODE;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:367  
  19633  4 010525   000003 470400 xsym               LDP0    P_PCB+3
         4 010526   000000 236100                    LDQ     0,,PR0
         4 010527   777777 376007                    ANQ     -1,DL
         4 010530   204100 756100                    STQ     CODE2,,AUTO

     2393    19634    6            IF A = 1 THEN

  19634  4 010531   204073 471500                    LDP1    @A,,AUTO
         4 010532   100000 235100                    LDA     0,,PR1
         4 010533   000001 115007                    CMPA    1,DL
         4 010534   010556 601000 4                  TNZ     s:19661

     2394    19635    7            DO SELECT (CODE2);

  19635  4 010535   000065 116007                    CMPQ    53,DL
         4 010536   010543 602000 4                  TNC     s:19635+6
         4 010537   010546 600000 4                  TZE     s:19636
         4 010540   000072 116007                    CMPQ    58,DL
         4 010541   010547 601000 4                  TNZ     s:19655
         4 010542   010546 710000 4                  TRA     s:19636
         4 010543   000064 116007                    CMPQ    52,DL
         4 010544   010547 601000 4                  TNZ     s:19655
         4 010545   010546 710000 4                  TRA     s:19636

     2395    19636    7               SELECT(52 /* FT_LOGO */,53 /* FT_X */,58 /* FT_PLAIN */);

  19636  4 010546   010556 710000 4                  TRA     s:19661

     2396    19637    7               SELECT(ELSE);

     2397    19638        /*   ERROR: ASF-E$BADINTRINSIC-0
     2398    19639             MESSAGE: That intrinsic is illegal for alignments.
     2399    19640             MESSAGE1: You can only use %LOG, %x, or plaintext
     2400    19641                         for an alignment image.
     2401    19642        */
     2402    19643                 %SCREAM( ERR#=E$BADINTRINSIC,MID='F',LEVEL=ERROR);

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:368  
  19655  4 010547   000104 630400 5                  EPPR0   68
         4 010550   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 010551   000000 701000 xent               TSX1    ASH$ERROR
         4 010552   000000 011000                    NOP     0

     2403    19658    7            P_PCB.ROOT$ = ADDR( F_A_OR_B_LIST);

  19658  4 010553   000073 236000 5                  LDQ     59
         4 010554   000001 756000 xsym               STQ     P_PCB+1

     2404    19659    7            GOTO BANNER_LOOP;

  19659  4 010555   007447 710000 4                  TRA     BANNER_LOOP

     2405    19660    7               END;

     2406    19661    7            DO SELECT ( CODE2 );

  19661  4 010556   000077 116007                    CMPQ    63,DL
         4 010557   010617 602000 4                  TNC     s:19661+33
         4 010560   011061 600000 4                  TZE     s:19693
         4 010561   000103 116007                    CMPQ    67,DL
         4 010562   010606 602000 4                  TNC     s:19661+24
         4 010563   011115 600000 4                  TZE     s:19701
         4 010564   000107 116007                    CMPQ    71,DL
         4 010565   010575 602000 4                  TNC     s:19661+15
         4 010566   011151 600000 4                  TZE     s:19709
         4 010567   000110 116007                    CMPQ    72,DL
         4 010570   011361 602000 4                  TNC     s:19808
         4 010571   011160 600000 4                  TZE     s:19711
         4 010572   000111 116007                    CMPQ    73,DL
         4 010573   011361 601000 4                  TNZ     s:19808
         4 010574   011167 710000 4                  TRA     s:19713
         4 010575   000105 116007                    CMPQ    69,DL
         4 010576   010603 602000 4                  TNC     s:19661+21
         4 010577   011133 600000 4                  TZE     s:19705
         4 010600   000106 116007                    CMPQ    70,DL
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:369  
         4 010601   011361 601000 4                  TNZ     s:19808
         4 010602   011142 710000 4                  TRA     s:19707
         4 010603   000104 116007                    CMPQ    68,DL
         4 010604   011361 601000 4                  TNZ     s:19808
         4 010605   011124 710000 4                  TRA     s:19703
         4 010606   000101 116007                    CMPQ    65,DL
         4 010607   010614 602000 4                  TNC     s:19661+30
         4 010610   011077 600000 4                  TZE     s:19697
         4 010611   000102 116007                    CMPQ    66,DL
         4 010612   011361 601000 4                  TNZ     s:19808
         4 010613   011106 710000 4                  TRA     s:19699
         4 010614   000100 116007                    CMPQ    64,DL
         4 010615   011361 601000 4                  TNZ     s:19808
         4 010616   011070 710000 4                  TRA     s:19695
         4 010617   000062 116007                    CMPQ    50,DL
         4 010620   010660 602000 4                  TNC     s:19661+66
         4 010621   010771 600000 4                  TZE     s:19677
         4 010622   000070 116007                    CMPQ    56,DL
         4 010623   010641 602000 4                  TNC     s:19661+51
         4 010624   011025 600000 4                  TZE     s:19685
         4 010625   000075 116007                    CMPQ    61,DL
         4 010626   010633 602000 4                  TNC     s:19661+45
         4 010627   011043 600000 4                  TZE     s:19689
         4 010630   000076 116007                    CMPQ    62,DL
         4 010631   011361 601000 4                  TNZ     s:19808
         4 010632   011052 710000 4                  TRA     s:19691
         4 010633   000071 116007                    CMPQ    57,DL
         4 010634   011361 602000 4                  TNC     s:19808
         4 010635   011034 600000 4                  TZE     s:19687
         4 010636   000072 116007                    CMPQ    58,DL
         4 010637   011361 601000 4                  TNZ     s:19808
         4 010640   011234 710000 4                  TRA     s:19745
         4 010641   000064 116007                    CMPQ    52,DL
         4 010642   010654 602000 4                  TNC     s:19661+62
         4 010643   011007 600000 4                  TZE     s:19681
         4 010644   000066 116007                    CMPQ    54,DL
         4 010645   010650 602000 4                  TNC     s:19661+58
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:370  
         4 010646   011016 600000 4                  TZE     s:19683
         4 010647   011361 710000 4                  TRA     s:19808
         4 010650   204100 235100                    LDA     CODE2,,AUTO
         4 010651   000065 115007                    CMPA    53,DL
         4 010652   011361 601000 4                  TNZ     s:19808
         4 010653   011176 710000 4                  TRA     s:19715
         4 010654   204100 235100                    LDA     CODE2,,AUTO
         4 010655   000063 115007                    CMPA    51,DL
         4 010656   011361 601000 4                  TNZ     s:19808
         4 010657   011000 710000 4                  TRA     s:19679
         4 010660   204100 236100                    LDQ     CODE2,,AUTO
         4 010661   000056 116007                    CMPQ    46,DL
         4 010662   010676 602000 4                  TNC     s:19661+80
         4 010663   010735 600000 4                  TZE     s:19669
         4 010664   000060 116007                    CMPQ    48,DL
         4 010665   010672 602000 4                  TNC     s:19661+76
         4 010666   010753 600000 4                  TZE     s:19673
         4 010667   000061 116007                    CMPQ    49,DL
         4 010670   011361 601000 4                  TNZ     s:19808
         4 010671   010762 710000 4                  TRA     s:19675
         4 010672   204100 235100                    LDA     CODE2,,AUTO
         4 010673   000057 115007                    CMPA    47,DL
         4 010674   011361 601000 4                  TNZ     s:19808
         4 010675   010744 710000 4                  TRA     s:19671
         4 010676   204100 236100                    LDQ     CODE2,,AUTO
         4 010677   000054 116007                    CMPQ    44,DL
         4 010700   010705 602000 4                  TNC     s:19661+87
         4 010701   010717 600000 4                  TZE     s:19665
         4 010702   000055 116007                    CMPQ    45,DL
         4 010703   011361 601000 4                  TNZ     s:19808
         4 010704   010726 710000 4                  TRA     s:19667
         4 010705   000053 116007                    CMPQ    43,DL
         4 010706   011361 601000 4                  TNZ     s:19808
         4 010707   010710 710000 4                  TRA     s:19663

     2407    19662    7               SELECT( 43 /* FT_SYSID */ );

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:371  
     2408    19663    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 1/*SYSID*/;

  19663  4 010710   200004 236100                    LDQ     ENUM,,AUTO
         4 010711   000060 402007                    MPY     48,DL
         4 010712   204076 470500                    LDP0    FB$,,AUTO
         4 010713   000106 101400                    MRL     fill='000'O
         4 010714   000003 000004 xsym               ADSC9   B_VECTNIL+3              cn=0,n=4
         4 010715   000012 200001                    ADSC9   10,Q,PR0                 cn=1,n=1
         4 010716   011361 710000 4                  TRA     s:19808

     2409    19664    7               SELECT( 44 /* FT_ACCN */ );

     2410    19665    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 2/*ACCN*/;

  19665  4 010717   200004 236100                    LDQ     ENUM,,AUTO
         4 010720   000060 402007                    MPY     48,DL
         4 010721   204076 470500                    LDP0    FB$,,AUTO
         4 010722   000106 101400                    MRL     fill='000'O
         4 010723   000004 000004 xsym               ADSC9   B_VECTNIL+4              cn=0,n=4
         4 010724   000012 200001                    ADSC9   10,Q,PR0                 cn=1,n=1
         4 010725   011361 710000 4                  TRA     s:19808

     2411    19666    7               SELECT ( 45 /* FT_UNAME */ );

     2412    19667    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 3/*UNAME*/;

  19667  4 010726   200004 236100                    LDQ     ENUM,,AUTO
         4 010727   000060 402007                    MPY     48,DL
         4 010730   204076 470500                    LDP0    FB$,,AUTO
         4 010731   000106 101400                    MRL     fill='000'O
         4 010732   000005 000004 xsym               ADSC9   B_VECTNIL+5              cn=0,n=4
         4 010733   000012 200001                    ADSC9   10,Q,PR0                 cn=1,n=1
         4 010734   011361 710000 4                  TRA     s:19808

     2413    19668    7               SELECT( 46 /* FT_WOO */ );

     2414    19669    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 4/*WOO*/;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:372  

  19669  4 010735   200004 236100                    LDQ     ENUM,,AUTO
         4 010736   000060 402007                    MPY     48,DL
         4 010737   204076 470500                    LDP0    FB$,,AUTO
         4 010740   000106 101400                    MRL     fill='000'O
         4 010741   000006 000004 xsym               ADSC9   B_VECTNIL+6              cn=0,n=4
         4 010742   000012 200001                    ADSC9   10,Q,PR0                 cn=1,n=1
         4 010743   011361 710000 4                  TRA     s:19808

     2415    19670    7               SELECT( 47 /* FT_JOBNAME */ );

     2416    19671    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 5/*JNAME*/;

  19671  4 010744   200004 236100                    LDQ     ENUM,,AUTO
         4 010745   000060 402007                    MPY     48,DL
         4 010746   204076 470500                    LDP0    FB$,,AUTO
         4 010747   000106 101400                    MRL     fill='000'O
         4 010750   000007 000004 xsym               ADSC9   B_VECTNIL+7              cn=0,n=4
         4 010751   000012 200001                    ADSC9   10,Q,PR0                 cn=1,n=1
         4 010752   011361 710000 4                  TRA     s:19808

     2417    19672    7               SELECT( 48 /* FT_TIME */ );

     2418    19673    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 6/*TIME*/;

  19673  4 010753   200004 236100                    LDQ     ENUM,,AUTO
         4 010754   000060 402007                    MPY     48,DL
         4 010755   204076 470500                    LDP0    FB$,,AUTO
         4 010756   000106 101400                    MRL     fill='000'O
         4 010757   000010 000004 xsym               ADSC9   B_VECTNIL+8              cn=0,n=4
         4 010760   000012 200001                    ADSC9   10,Q,PR0                 cn=1,n=1
         4 010761   011361 710000 4                  TRA     s:19808

     2419    19674    7               SELECT( 49 /* FT_DATE */ );

     2420    19675    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 7/*DATE*/;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:373  
  19675  4 010762   200004 236100                    LDQ     ENUM,,AUTO
         4 010763   000060 402007                    MPY     48,DL
         4 010764   204076 470500                    LDP0    FB$,,AUTO
         4 010765   000106 101400                    MRL     fill='000'O
         4 010766   000011 000004 xsym               ADSC9   B_VECTNIL+9              cn=0,n=4
         4 010767   000012 200001                    ADSC9   10,Q,PR0                 cn=1,n=1
         4 010770   011361 710000 4                  TRA     s:19808

     2421    19676    7               SELECT( 50 /* FT_VERSION */ );

     2422    19677    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 8/*VERS*/;

  19677  4 010771   200004 236100                    LDQ     ENUM,,AUTO
         4 010772   000060 402007                    MPY     48,DL
         4 010773   204076 473500                    LDP3    FB$,,AUTO
         4 010774   000106 101400                    MRL     fill='000'O
         4 010775   000012 000004 xsym               ADSC9   B_VECTNIL+10             cn=0,n=4
         4 010776   300012 200001                    ADSC9   10,Q,PR3                 cn=1,n=1
         4 010777   011361 710000 4                  TRA     s:19808

     2423    19678    7               SELECT( 51 /* FT_SUBFILE */ );

     2424    19679    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 9/*SFILE*/;

  19679  4 011000   200004 236100                    LDQ     ENUM,,AUTO
         4 011001   000060 402007                    MPY     48,DL
         4 011002   204076 470500                    LDP0    FB$,,AUTO
         4 011003   000106 101400                    MRL     fill='000'O
         4 011004   000013 000004 xsym               ADSC9   B_VECTNIL+11             cn=0,n=4
         4 011005   000012 200001                    ADSC9   10,Q,PR0                 cn=1,n=1
         4 011006   011361 710000 4                  TRA     s:19808

     2425    19680    7               SELECT( 52 /* FT_LOGO */ );

     2426    19681    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 10/*LOGO*/;

  19681  4 011007   200004 236100                    LDQ     ENUM,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:374  
         4 011010   000060 402007                    MPY     48,DL
         4 011011   204076 470500                    LDP0    FB$,,AUTO
         4 011012   000106 101400                    MRL     fill='000'O
         4 011013   000014 000004 xsym               ADSC9   B_VECTNIL+12             cn=0,n=4
         4 011014   000012 200001                    ADSC9   10,Q,PR0                 cn=1,n=1
         4 011015   011361 710000 4                  TRA     s:19808

     2427    19682    7               SELECT( 54 /* FT_WOD */ );

     2428    19683    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM)=12/*WOD*/;

  19683  4 011016   200004 236100                    LDQ     ENUM,,AUTO
         4 011017   000060 402007                    MPY     48,DL
         4 011020   204076 470500                    LDP0    FB$,,AUTO
         4 011021   000106 101400                    MRL     fill='000'O
         4 011022   000105 000004 5                  ADSC9   69                       cn=0,n=4
         4 011023   000012 200001                    ADSC9   10,Q,PR0                 cn=1,n=1
         4 011024   011361 710000 4                  TRA     s:19808

     2429    19684    7               SELECT( 56 /* FT_SITENAME */ );

     2430    19685    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 14/*SITENAME*/;

  19685  4 011025   200004 236100                    LDQ     ENUM,,AUTO
         4 011026   000060 402007                    MPY     48,DL
         4 011027   204076 473500                    LDP3    FB$,,AUTO
         4 011030   000106 101400                    MRL     fill='000'O
         4 011031   000106 000004 5                  ADSC9   70                       cn=0,n=4
         4 011032   300012 200001                    ADSC9   10,Q,PR3                 cn=1,n=1
         4 011033   011361 710000 4                  TRA     s:19808

     2431    19686    7               SELECT( 57 /* FT_SALUTE */ );

     2432    19687    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 15/*SALUTE*/;

  19687  4 011034   200004 236100                    LDQ     ENUM,,AUTO
         4 011035   000060 402007                    MPY     48,DL
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:375  
         4 011036   204076 473500                    LDP3    FB$,,AUTO
         4 011037   000106 101400                    MRL     fill='000'O
         4 011040   000107 000004 5                  ADSC9   71                       cn=0,n=4
         4 011041   300012 200001                    ADSC9   10,Q,PR3                 cn=1,n=1
         4 011042   011361 710000 4                  TRA     s:19808

     2433    19688    7               SELECT( 61 /* FT_FORM */ );

     2434    19689    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 16/*FORM*/;

  19689  4 011043   200004 236100                    LDQ     ENUM,,AUTO
         4 011044   000060 402007                    MPY     48,DL
         4 011045   204076 473500                    LDP3    FB$,,AUTO
         4 011046   000106 101400                    MRL     fill='000'O
         4 011047   000110 000004 5                  ADSC9   72                       cn=0,n=4
         4 011050   300012 200001                    ADSC9   10,Q,PR3                 cn=1,n=1
         4 011051   011361 710000 4                  TRA     s:19808

     2435    19690    7               SELECT( 62 /* FT_MINI_ID */ );

     2436    19691    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 17/*MINI_ID*/;

  19691  4 011052   200004 236100                    LDQ     ENUM,,AUTO
         4 011053   000060 402007                    MPY     48,DL
         4 011054   204076 473500                    LDP3    FB$,,AUTO
         4 011055   000106 101400                    MRL     fill='000'O
         4 011056   000111 000004 5                  ADSC9   73                       cn=0,n=4
         4 011057   300012 200001                    ADSC9   10,Q,PR3                 cn=1,n=1
         4 011060   011361 710000 4                  TRA     s:19808

     2437    19692    7               SELECT( 63 /*FT_BANNERTEXT0 */ );

     2438    19693    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 18/*BANRTEXT0*/;

  19693  4 011061   200004 236100                    LDQ     ENUM,,AUTO
         4 011062   000060 402007                    MPY     48,DL
         4 011063   204076 473500                    LDP3    FB$,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:376  
         4 011064   000106 101400                    MRL     fill='000'O
         4 011065   000112 000004 5                  ADSC9   74                       cn=0,n=4
         4 011066   300012 200001                    ADSC9   10,Q,PR3                 cn=1,n=1
         4 011067   011361 710000 4                  TRA     s:19808

     2439    19694    7               SELECT( 64 /*FT_BANNERTEXT1 */ );

     2440    19695    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 19/*BANRTEXT1*/;

  19695  4 011070   200004 236100                    LDQ     ENUM,,AUTO
         4 011071   000060 402007                    MPY     48,DL
         4 011072   204076 473500                    LDP3    FB$,,AUTO
         4 011073   000106 101400                    MRL     fill='000'O
         4 011074   000113 000004 5                  ADSC9   75                       cn=0,n=4
         4 011075   300012 200001                    ADSC9   10,Q,PR3                 cn=1,n=1
         4 011076   011361 710000 4                  TRA     s:19808

     2441    19696    7               SELECT( 65 /*FT_BANNERTEXT2 */ );

     2442    19697    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 20/*BANRTEXT2*/;

  19697  4 011077   200004 236100                    LDQ     ENUM,,AUTO
         4 011100   000060 402007                    MPY     48,DL
         4 011101   204076 473500                    LDP3    FB$,,AUTO
         4 011102   000106 101400                    MRL     fill='000'O
         4 011103   000114 000004 5                  ADSC9   76                       cn=0,n=4
         4 011104   300012 200001                    ADSC9   10,Q,PR3                 cn=1,n=1
         4 011105   011361 710000 4                  TRA     s:19808

     2443    19698    7               SELECT( 66 /*FT_BANNERTEXT3 */ );

     2444    19699    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 21/*BANRTEXT3*/;

  19699  4 011106   200004 236100                    LDQ     ENUM,,AUTO
         4 011107   000060 402007                    MPY     48,DL
         4 011110   204076 473500                    LDP3    FB$,,AUTO
         4 011111   000106 101400                    MRL     fill='000'O
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:377  
         4 011112   000115 000004 5                  ADSC9   77                       cn=0,n=4
         4 011113   300012 200001                    ADSC9   10,Q,PR3                 cn=1,n=1
         4 011114   011361 710000 4                  TRA     s:19808

     2445    19700    7               SELECT( 67 /*FT_BANNERTEXT4 */ );

     2446    19701    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 22/*BANRTEXT4*/;

  19701  4 011115   200004 236100                    LDQ     ENUM,,AUTO
         4 011116   000060 402007                    MPY     48,DL
         4 011117   204076 473500                    LDP3    FB$,,AUTO
         4 011120   000106 101400                    MRL     fill='000'O
         4 011121   000116 000004 5                  ADSC9   78                       cn=0,n=4
         4 011122   300012 200001                    ADSC9   10,Q,PR3                 cn=1,n=1
         4 011123   011361 710000 4                  TRA     s:19808

     2447    19702    7               SELECT( 68 /*FT_BANNERTEXT5 */ );

     2448    19703    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 23/*BANRTEXT5*/;

  19703  4 011124   200004 236100                    LDQ     ENUM,,AUTO
         4 011125   000060 402007                    MPY     48,DL
         4 011126   204076 473500                    LDP3    FB$,,AUTO
         4 011127   000106 101400                    MRL     fill='000'O
         4 011130   000117 000004 5                  ADSC9   79                       cn=0,n=4
         4 011131   300012 200001                    ADSC9   10,Q,PR3                 cn=1,n=1
         4 011132   011361 710000 4                  TRA     s:19808

     2449    19704    7               SELECT( 69 /*FT_BANNERTEXT6 */ );

     2450    19705    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 24/*BANRTEXT6*/;

  19705  4 011133   200004 236100                    LDQ     ENUM,,AUTO
         4 011134   000060 402007                    MPY     48,DL
         4 011135   204076 473500                    LDP3    FB$,,AUTO
         4 011136   000106 101400                    MRL     fill='000'O
         4 011137   000120 000004 5                  ADSC9   80                       cn=0,n=4
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:378  
         4 011140   300012 200001                    ADSC9   10,Q,PR3                 cn=1,n=1
         4 011141   011361 710000 4                  TRA     s:19808

     2451    19706    7               SELECT( 70 /*FT_BANNERTEXT7 */ );

     2452    19707    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 25/*BANRTEXT7*/;

  19707  4 011142   200004 236100                    LDQ     ENUM,,AUTO
         4 011143   000060 402007                    MPY     48,DL
         4 011144   204076 473500                    LDP3    FB$,,AUTO
         4 011145   000106 101400                    MRL     fill='000'O
         4 011146   000121 000004 5                  ADSC9   81                       cn=0,n=4
         4 011147   300012 200001                    ADSC9   10,Q,PR3                 cn=1,n=1
         4 011150   011361 710000 4                  TRA     s:19808

     2453    19708    7               SELECT( 71 /*FT_BANNERTEXT8 */ );

     2454    19709    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 26/*BANRTEXT8*/;

  19709  4 011151   200004 236100                    LDQ     ENUM,,AUTO
         4 011152   000060 402007                    MPY     48,DL
         4 011153   204076 473500                    LDP3    FB$,,AUTO
         4 011154   000106 101400                    MRL     fill='000'O
         4 011155   000122 000004 5                  ADSC9   82                       cn=0,n=4
         4 011156   300012 200001                    ADSC9   10,Q,PR3                 cn=1,n=1
         4 011157   011361 710000 4                  TRA     s:19808

     2455    19710    7               SELECT( 72 /*FT_BANNERTEXT9 */ );

     2456    19711    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 27/*BANRTEXT9*/;

  19711  4 011160   200004 236100                    LDQ     ENUM,,AUTO
         4 011161   000060 402007                    MPY     48,DL
         4 011162   204076 473500                    LDP3    FB$,,AUTO
         4 011163   000106 101400                    MRL     fill='000'O
         4 011164   000123 000004 5                  ADSC9   83                       cn=0,n=4
         4 011165   300012 200001                    ADSC9   10,Q,PR3                 cn=1,n=1
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:379  
         4 011166   011361 710000 4                  TRA     s:19808

     2457    19712    7               SELECT( 73 /*FT_REGISTEREDNAME */ );

     2458    19713    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 28/*RGSTDNAM*/;

  19713  4 011167   200004 236100                    LDQ     ENUM,,AUTO
         4 011170   000060 402007                    MPY     48,DL
         4 011171   204076 473500                    LDP3    FB$,,AUTO
         4 011172   000106 101400                    MRL     fill='000'O
         4 011173   000124 000004 5                  ADSC9   84                       cn=0,n=4
         4 011174   300012 200001                    ADSC9   10,Q,PR3                 cn=1,n=1
         4 011175   011361 710000 4                  TRA     s:19808

     2459    19714    7               SELECT( 53 /* FT_X */ );

     2460    19715    7               IF P_PCB.OUT$->P$NODE.SUBLK$(0)->OUT$SYM.COUNT ~= 1 THEN

  19715  4 011176   000003 470400 xsym               LDP0    P_PCB+3
         4 011177   000003 471500                    LDP1    3,,PR0
         4 011200   100004 236100                    LDQ     4,,PR1
         4 011201   777000 376003                    ANQ     -512,DU
         4 011202   001000 116003                    CMPQ    512,DU
         4 011203   011213 600000 4                  TZE     s:19740

     2461    19716    8               DO;

     2462    19717        /*   ERROR: ASF-E$BADXTYPE-0
     2463    19718             MESSAGE: Illegal type.
     2464    19719             MESSAGE1: Text of entry must be an intrinsic name or single character.
     2465    19720        */
     2466    19721                       %SCREAM( ERR#=E$BADXTYPE,MID='F',LEVEL=ERROR);

  19733  4 011204   000125 630400 5                  EPPR0   85
         4 011205   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 011206   000000 701000 xent               TSX1    ASH$ERROR
         4 011207   000000 011000                    NOP     0
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:380  

     2467    19736    8                  P_PCB.ROOT$ = ADDR(F_A_OR_B_LIST);

  19736  4 011210   000073 236000 5                  LDQ     59
         4 011211   000001 756000 xsym               STQ     P_PCB+1

     2468    19737    8                  GOTO BANNER_LOOP;

  19737  4 011212   007447 710000 4                  TRA     BANNER_LOOP

     2469    19738    8                  END;
     2470    19739    8               ELSE DO;

     2471    19740    8                  FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 11/*RPTX*/;

  19740  4 011213   200004 236100                    LDQ     ENUM,,AUTO
         4 011214   000060 402007                    MPY     48,DL
         4 011215   204076 473500                    LDP3    FB$,,AUTO
         4 011216   000106 101400                    MRL     fill='000'O
         4 011217   000015 000004 xsym               ADSC9   B_VECTNIL+13             cn=0,n=4
         4 011220   300012 200001                    ADSC9   10,Q,PR3                 cn=1,n=1

     2472    19741    8                  FB$->FS$GBAN.ENTRIES.CHR(ENUM) = P_PCB.OUT$->

  19741  4 011221   000003 470400 xsym               LDP0    P_PCB+3
         4 011222   000003 471500                    LDP1    3,,PR0
         4 011223   100004 236100                    LDQ     4,,PR1
         4 011224   000033 772000                    QRL     27
         4 011225   000000 620006                    EAX0    0,QL
         4 011226   200004 236100                    LDQ     ENUM,,AUTO
         4 011227   000060 402007                    MPY     48,DL
         4 011230   040106 100540                    MLR     fill='040'O
         4 011231   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         4 011232   300012 400001                    ADSC9   10,Q,PR3                 cn=2,n=1

     2473    19742    8                       P$NODE.SUBLK$(0)->OUT$SYM.TEXT;
     2474    19743    8                  END;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:381  

  19743  4 011233   011361 710000 4                  TRA     s:19808

     2475    19744    7               SELECT( 58 /* FT_PLAIN */ );

     2476    19745    7               FB$->FS$GBAN.ENTRIES.TYPE(ENUM) = 0/*TEXT*/;

  19745  4 011234   200004 236100                    LDQ     ENUM,,AUTO
         4 011235   000060 402007                    MPY     48,DL
         4 011236   204076 470500                    LDP0    FB$,,AUTO
         4 011237   000106 101400                    MRL     fill='000'O
         4 011240   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 011241   000012 200001                    ADSC9   10,Q,PR0                 cn=1,n=1

     2477    19746    7               FC_LEN = ARS;

  19746  4 011242   200020 235100                    LDA     ARS,,AUTO
         4 011243   204103 755100                    STA     FC_LEN,,AUTO

     2478    19747    8               IF FC_LEN = 0 THEN DO;

  19747  4 011244   011254 601000 4                  TNZ     s:19772

     2479    19748        /*   ERROR: ASF-E$NULLENTRY-0
     2480    19749             MESSAGE: You must specify either:
     2481    19750                          a %intrinsic name
     2482    19751                          a %single character,
     2483    19752                          or a line of text.
     2484    19753        */
     2485    19754                       %SCREAM( ERR#=E$NULLENTRY,MID='F',LEVEL=ERROR);

  19766  4 011245   000126 630400 5                  EPPR0   86
         4 011246   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 011247   000000 701000 xent               TSX1    ASH$ERROR
         4 011250   000000 011000                    NOP     0

     2486    19769    8                  P_PCB.ROOT$ = ADDR(F_A_OR_B_LIST);
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:382  

  19769  4 011251   000073 236000 5                  LDQ     59
         4 011252   000001 756000 xsym               STQ     P_PCB+1

     2487    19770    8                  GOTO BANNER_LOOP;

  19770  4 011253   007447 710000 4                  TRA     BANNER_LOOP

     2488    19771    8                  END;
     2489    19772    7               IF ADDR(FB$->FS$GBAN.ENTRIES.MARK(ENUM))>=FC$

  19772  4 011254   200004 236100                    LDQ     ENUM,,AUTO
         4 011255   000014 402003                    MPY     12,DU
         4 011256   000133 036000 5                  ADLQ    91
         4 011257   204076 036100                    ADLQ    FB$,,AUTO
         4 011260   200006 116100                    CMPQ    FC$,,AUTO
         4 011261   011306 602000 4                  TNC     s:19796

     2490    19773    8               THEN DO;

     2491    19774                       %SCREAM( ERR#=E$BANBUFFULL,MID='F',LEVEL=ERROR);

  19786  4 011262   000100 630400 5                  EPPR0   64
         4 011263   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 011264   000000 701000 xent               TSX1    ASH$ERROR
         4 011265   000000 011000                    NOP     0

     2492    19789    8                  FB$->FS$GBAN.NUM_ENTRIES = 0;

  19789  4 011266   204076 470500                    LDP0    FB$,,AUTO
         4 011267   000100 101400                    MRL     fill='000'O
         4 011270   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 011271   000000 600001                    ADSC9   0,,PR0                   cn=3,n=1

     2493    19790    8                  IF A = 0 THEN

  19790  4 011272   204073 471500                    LDP1    @A,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:383  
         4 011273   100000 235100                    LDA     0,,PR1
         4 011274   011301 601000 4                  TNZ     s:19793

     2494    19791    8                     F$->FS$GFORMREC.BANRDISP = 0;

  19791  4 011275   000000 220003                    LDX0    0,DU
         4 011276   204051 473500                    LDP3    F$,,AUTO
         4 011277   300003 740100                    STX0    3,,PR3
         4 011300   011304 710000 4                  TRA     s:19794

     2495    19792    8                  ELSE
     2496    19793    8                     F$->FS$GFORMREC.ALGNDISP = 0;

  19793  4 011301   000000 220003                    LDX0    0,DU
         4 011302   204051 473500                    LDP3    F$,,AUTO
         4 011303   300003 440100                    SXL0    3,,PR3

     2497    19794    8                  RETURN;

  19794  4 011304   204072 221300                    LDX1  ! FOUND+1,,AUTO
         4 011305   000001 702211                    TSX2  ! 1,X1

     2498    19795    8                  END;
     2499    19796    7               FB$->FS$GBAN.ENTRIES.COUNT(ENUM) = FC_LEN;

  19796  4 011306   200004 236100                    LDQ     ENUM,,AUTO
         4 011307   000060 402007                    MPY     48,DL
         4 011310   000106 101500                    MRL     fill='000'O
         4 011311   204103 000004                    ADSC9   FC_LEN,,AUTO             cn=0,n=4
         4 011312   000012 400001                    ADSC9   10,Q,PR0                 cn=2,n=1

     2500    19797    7               FC_LEN=(FC_LEN+3)/4;

  19797  4 011313   204103 236100                    LDQ     FC_LEN,,AUTO
         4 011314   000003 036007                    ADLQ    3,DL
         4 011315   000002 772000                    QRL     2
         4 011316   204103 756100                    STQ     FC_LEN,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:384  

     2501    19798    7               FC$=PINCRW(FC$,-(FC_LEN));

  19798  4 011317   000022 736000                    QLS     18
         4 011320   000027 676000 xsym               ERQ     B_VECTNIL+23
         4 011321   000001 036007                    ADLQ    1,DL
         4 011322   200006 036100                    ADLQ    FC$,,AUTO
         4 011323   200006 756100                    STQ     FC$,,AUTO

     2502    19799    7               FC_LEN=FC_LEN*4;

  19799  4 011324   204103 235100                    LDA     FC_LEN,,AUTO
         4 011325   000002 735000                    ALS     2
         4 011326   204103 755100                    STA     FC_LEN,,AUTO

     2503    19800    7               FC_CHAR = IN_BUF;

  19800  4 011327   200006 471500                    LDP1    FC$,,AUTO
         4 011330   000000 620005                    EAX0    0,AL
         4 011331   040140 100400                    MLR     fill='040'O
         4 011332   000000 000377 xsym               ADSC9   IN_BUF                   cn=0,n=255
         4 011333   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

     2504    19801    7               FB$->FS$GBAN.ENTRIES.DISP(ENUM) = POFFW(FC$,FB$);

  19801  4 011334   204076 235100                    LDA     FB$,,AUTO
         4 011335   000022 771000                    ARL     18
         4 011336   204110 755100                    STA     @MAX_VAL+1,,AUTO
         4 011337   200006 236100                    LDQ     FC$,,AUTO
         4 011340   000022 772000                    QRL     18
         4 011341   204110 136100                    SBLQ    @MAX_VAL+1,,AUTO
         4 011342   204111 756100                    STQ     @MAX_VAL+2,,AUTO
         4 011343   200004 236100                    LDQ     ENUM,,AUTO
         4 011344   000060 402007                    MPY     48,DL
         4 011345   000106 101500                    MRL     fill='000'O
         4 011346   204111 000004                    ADSC9   @MAX_VAL+2,,AUTO         cn=0,n=4
         4 011347   000012 600002                    ADSC9   10,Q,PR0                 cn=3,n=2
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:385  

     2505    19802    7               SUBNS=0;

  19802  4 011350   204102 450100                    STZ     SUBNS,,AUTO

     2506    19803    7               IF A = 0 THEN

  19803  4 011351   204073 473500                    LDP3    @A,,AUTO
         4 011352   300000 235100                    LDA     0,,PR3
         4 011353   011357 601000 4                  TNZ     s:19806

     2507    19804    7                  FCB$ = FC$ ;

  19804  4 011354   200006 236100                    LDQ     FC$,,AUTO
         4 011355   200007 756100                    STQ     FCB$,,AUTO
         4 011356   011361 710000 4                  TRA     s:19808

     2508    19805    7               ELSE
     2509    19806    7                  FCA$ = FC$;

  19806  4 011357   200006 236100                    LDQ     FC$,,AUTO
         4 011360   200010 756100                    STQ     FCA$,,AUTO

     2510    19807    7               END;

     2511    19808    6            P_PCB.ROOT$ = ADDR( F_A_OR_B_LIST );

  19808  4 011361   000073 236000 5                  LDQ     59
         4 011362   000001 756000 xsym               STQ     P_PCB+1

     2512    19809    6            ENUM=ENUM+1;

  19809  4 011363   200004 235100                    LDA     ENUM,,AUTO
         4 011364   000001 035007                    ADLA    1,DL
         4 011365   200004 755100                    STA     ENUM,,AUTO

     2513    19810    6            FB$->FS$GBAN.NUM_ENTRIES = ENUM;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:386  

  19810  4 011366   204076 470500                    LDP0    FB$,,AUTO
         4 011367   000100 101500                    MRL     fill='000'O
         4 011370   200004 000004                    ADSC9   ENUM,,AUTO               cn=0,n=4
         4 011371   000000 600001                    ADSC9   0,,PR0                   cn=3,n=1

     2514    19811
     2515    19812    6            END DO_CASE;

  19810  4 011372                       BANNER_LOOP* null
     2516    19813    5   BANNER_LOOP_END:;
     2517    19814    5         END DO_I;

  19814  4 011372   204053 235100                    LDA     I,,AUTO
         4 011373   000001 035007                    ADLA    1,DL
         4 011374   204053 755100                    STA     I,,AUTO
         4 011375   204053 236100                    LDQ     I,,AUTO
         4 011376   204102 116100                    CMPQ    SUBNS,,AUTO
         4 011377   007503 602000 4                  TNC     s:19370

     2518    19815    4      END BANNER_LOOP;

  19815  4 011400   204074 234100                    SZN     MORE,,AUTO
         4 011401   007451 604000 4                  TMI     s:19363

     2519    19816    3   PARSE_ERR:
     2520    19817    3   CALL ASH$ERROR( P_PCB.ERROR );

  19817  4 011402   000030 630400 5     PARSE_ERR    EPPR0   24
         4 011403   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 011404   000000 701000 xent               TSX1    ASH$ERROR
         4 011405   000000 011000                    NOP     0

     2521    19818    3   GOTO BANNER_LOOP;

  19818  4 011406   007447 710000 4                  TRA     BANNER_LOOP

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:387  
     2522    19819    3   END BANNER;
     2523    19820        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:388  
     2524    19821    2   CHANGE162_9X9: PROC( MAX_VAL ) ALTRET;

  19821  4 011407   204106 741300       CHANGE162_9* STX1  ! J+1,,AUTO

     2525    19822
     2526    19823    3   DCL MAX_VAL UBIN WORD ;
     2527    19824
     2528    19825    3   CALL CHARBIN( VAL, OUT$SYM.TEXT );

  19825  4 011410   204050 470500                    LDP0    BLK$,,AUTO
         4 011411   000004 236100                    LDQ     4,,PR0
         4 011412   000033 772000                    QRL     27
         4 011413   000000 620006                    EAX0    0,QL
         4 011414   000100 305540                    DTB
         4 011415   000004 230010                    NDSC9   4,,PR0                   cn=1,s=nosgn,sf=0,n=*X0
         4 011416   204110 000010                    NDSC9   @MAX_VAL+1,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         4 011417   204111 235100                    LDA     @MAX_VAL+2,,AUTO
         4 011420   204065 755100                    STA     VAL,,AUTO

     2529    19826    4   IF VAL > MAX_VAL THEN DO;

  19826  4 011421   204107 471500                    LDP1    @MAX_VAL,,AUTO
         4 011422   100000 236100                    LDQ     0,,PR1
         4 011423   204065 116100                    CMPQ    VAL,,AUTO
         4 011424   011456 603000 4                  TRC     s:19879

     2530    19827        /*E*  ERROR:  ASF-E$DEC_VALUE_TOO_BIG-C
     2531    19828              MESSAGE: %U1 value too large.
     2532    19829              MESSAGE1: %U1 is larger than the maximum value of %U2.
     2533    19830        */
     2534    19831           %NUMBER (NUM1=VAL,NUM2=MAX_VAL );
             19839    4         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, VAL );

  19839  4 011425   204065 633500                    EPPR3   VAL,,AUTO
         4 011426   204113 453500                    STP3    @MAX_VAL+4,,AUTO
         4 011427   000057 236000 5                  LDQ     47
         4 011430   204112 756100                    STQ     @MAX_VAL+3,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:389  
         4 011431   000060 237000 5                  LDAQ    48
         4 011432   204110 757100                    STAQ    @MAX_VAL+1,,AUTO
         4 011433   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 011434   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 011435   000000 701000 xent               TSX1    ASB$BINCHAR
         4 011436   000000 011000                    NOP     0

             19847    4         CALL ASB$BINCHAR( AS_FIELD2.TEXT, 0, -2, MAX_VAL );

  19847  4 011437   204107 236100                    LDQ     @MAX_VAL,,AUTO
         4 011440   000017 235000 5                  LDA     15
         4 011441   204112 757100                    STAQ    @MAX_VAL+3,,AUTO
         4 011442   000020 237000 5                  LDAQ    16
         4 011443   204110 757100                    STAQ    @MAX_VAL+1,,AUTO
         4 011444   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 011445   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 011446   000000 701000 xent               TSX1    ASB$BINCHAR
         4 011447   000000 011000                    NOP     0

     2535    19861           %SCREAM( ERR#=E$DEC_VALUE_TOO_BIG, LEVEL=ERROR, MID='F' );

  19873  4 011450   000145 630400 5                  EPPR0   101
         4 011451   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 011452   000000 701000 xent               TSX1    ASH$ERROR
         4 011453   000000 011000                    NOP     0

     2536    19876    4      ALTRETURN;

  19876  4 011454   204106 221300                    LDX1  ! J+1,,AUTO
         4 011455   000000 702211                    TSX2  ! 0,X1

     2537    19877    4      END;
     2538    19878
     2539    19879    3   SPLIT = '0'B;

  19879  4 011456   000000 220003                    LDX0    0,DU
         4 011457   204066 740100                    STX0    SPLIT,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:390  

     2540    19880    3   SPLIT.T = SPLIT_VAL.T;

  19880  4 011460   204065 236100                    LDQ     VAL,,AUTO
         4 011461   000023 736000                    QLS     19
         4 011462   204066 676100                    ERQ     SPLIT,,AUTO
         4 011463   377000 376003                    ANQ     130560,DU
         4 011464   204066 656100                    ERSQ    SPLIT,,AUTO

     2541    19881    3   SPLIT.B = SPLIT_VAL.B;

  19881  4 011465   204065 236100                    LDQ     VAL,,AUTO
         4 011466   000022 736000                    QLS     18
         4 011467   204066 676100                    ERQ     SPLIT,,AUTO
         4 011470   000377 376003                    ANQ     255,DU
         4 011471   204066 656100                    ERSQ    SPLIT,,AUTO

     2542    19882
     2543    19883
     2544    19884    3   END CHANGE162_9X9 ;

  19884  4 011472   000001 702211                    TSX2  ! 1,X1

     2545    19885    2   SPLIT_VAL: PROC;

  19885  4 011473   204106 741300       SPLIT_VAL    STX1  ! J+1,,AUTO

     2546    19886    3   SPLIT = '0'B;

  19886  4 011474   000000 220003                    LDX0    0,DU
         4 011475   204066 740100                    STX0    SPLIT,,AUTO

     2547    19887    3   SPLIT.T = SPLIT_VAL.T;

  19887  4 011476   204065 236100                    LDQ     VAL,,AUTO
         4 011477   000023 736000                    QLS     19
         4 011500   204066 676100                    ERQ     SPLIT,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:391  
         4 011501   377000 376003                    ANQ     130560,DU
         4 011502   204066 656100                    ERSQ    SPLIT,,AUTO

     2548    19888    3   SPLIT.B = SPLIT_VAL.B;

  19888  4 011503   204065 236100                    LDQ     VAL,,AUTO
         4 011504   000022 736000                    QLS     18
         4 011505   204066 676100                    ERQ     SPLIT,,AUTO
         4 011506   000377 376003                    ANQ     255,DU
         4 011507   204066 656100                    ERSQ    SPLIT,,AUTO

     2549    19889    3   END SPLIT_VAL;

  19889  4 011510   000001 702211                    TSX2  ! 1,X1

     2550    19890    2   END GFORM_OPTS;
     2551    19891        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:392  
     2552    19892    1   MOD_PSEUDO_FORMS: PROC ;

  19892  4 011511   204052 741300       MOD_PSEUDO_* STX1  ! F$+1,,AUTO

     2553    19893
     2554    19894    2   DCL I SBIN;
     2555    19895    2   DCL J SBIN;
     2556    19896    2   DCL FORM CHAR(6);
     2557    19897
     2558    19898    2   USERS_KEY = PSEUDO_FORM_KEY;

  19898  4 011512   000000 100500                    MLR     fill='000'O
         4 011513   200035 000015                    ADSC9   PSEUDO_FORM_KEY,,AUTO    cn=0,n=13
         4 011514   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     2559    19899    2   FORM = SUBSTR( PSEUDO_FORM_KEY.TXT, 0, 6 );

  19899  4 011515   040100 100500                    MLR     fill='040'O
         4 011516   200035 200006                    ADSC9   PSEUDO_FORM_KEY,,AUTO    cn=1,n=6
         4 011517   204055 000006                    ADSC9   FORM,,AUTO               cn=0,n=6

     2560    19900    2   CALL ASF$PREC_FORM( USERS_KEY ) ALTRET(FINISHED);

  19900  4 011520   000146 630400 5                  EPPR0   102
         4 011521   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 011522   000000 701000 xent               TSX1    ASF$PREC_FORM
         4 011523   012134 702000 4                  TSX2    FINISHED

     2561    19901    2   ARS = SIZEC(PSEUDO_FORM_REC);

  19901  4 011524   000004 235007                    LDA     4,DL
         4 011525   200020 755100                    STA     ARS,,AUTO

     2562    19902    2   CALL ASF$READ_FORM_SEQ(, ADDR(PSEUDO_FORM_REC), ARS ) ALTRET(FINISHED);

  19902  4 011526   200030 630500                    EPPR0   PSEUDO_FORM_REC,,AUTO
         4 011527   204110 450500                    STP0    @MAX_VAL+1,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:393  
         4 011530   200020 631500                    EPPR1   ARS,,AUTO
         4 011531   204113 451500                    STP1    @MAX_VAL+4,,AUTO
         4 011532   204110 633500                    EPPR3   @MAX_VAL+1,,AUTO
         4 011533   204112 453500                    STP3    @MAX_VAL+3,,AUTO
         4 011534   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 011535   204111 756100                    STQ     @MAX_VAL+2,,AUTO
         4 011536   204111 630500                    EPPR0   @MAX_VAL+2,,AUTO
         4 011537   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 011540   000000 701000 xent               TSX1    ASF$READ_FORM_SEQ
         4 011541   012134 702000 4                  TSX2    FINISHED

     2563    19903    3   DO WHILE( USERS_KEY.COUNT = 12  AND  SUBSTR(USERS_KEY.TXTC,0,6)=FORM );

  19903  4 011542   012124 710000 4                  TRA     s:19992

     2564    19904    3      I = 0;

  19904  4 011543   204053 450100                    STZ     I,,AUTO

     2565    19905    4      IF PSEUDO_FORM_REC.LPOK AND NOT LPOK THEN DO;

  19905  4 011544   200030 234100                    SZN     PSEUDO_FORM_REC,,AUTO
         4 011545   011556 605000 4                  TPL     s:19909
         4 011546   200025 234100                    SZN     LPOK,,AUTO
         4 011547   011556 604000 4                  TMI     s:19909

     2566    19906    4         PSEUDO_FORM_REC.LPOK = AS_FALSE;

  19906  4 011550   000000 236000 xsym               LDQ     AS_FALSE
         4 011551   200030 676100                    ERQ     PSEUDO_FORM_REC,,AUTO
         4 011552   400000 376003                    ANQ     -131072,DU
         4 011553   200030 656100                    ERSQ    PSEUDO_FORM_REC,,AUTO

     2567    19907    4         I = 1;

  19907  4 011554   000001 235007                    LDA     1,DL
         4 011555   204053 755100                    STA     I,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:394  

     2568    19908    4         END;

     2569    19909    4      IF PSEUDO_FORM_REC.TSOK AND NOT TSOK THEN DO;

  19909  4 011556   200030 236100                    LDQ     PSEUDO_FORM_REC,,AUTO
         4 011557   200000 316003                    CANQ    65536,DU
         4 011560   011572 600000 4                  TZE     s:19913
         4 011561   200026 234100                    SZN     TSOK,,AUTO
         4 011562   011572 604000 4                  TMI     s:19913

     2570    19910    4         PSEUDO_FORM_REC.TSOK = AS_FALSE;

  19910  4 011563   000000 236000 xsym               LDQ     AS_FALSE
         4 011564   000001 772000                    QRL     1
         4 011565   200030 676100                    ERQ     PSEUDO_FORM_REC,,AUTO
         4 011566   200000 376003                    ANQ     65536,DU
         4 011567   200030 656100                    ERSQ    PSEUDO_FORM_REC,,AUTO

     2571    19911    4         I = 1;

  19911  4 011570   000001 235007                    LDA     1,DL
         4 011571   204053 755100                    STA     I,,AUTO

     2572    19912    4         END;

     2573    19913    4      IF PSEUDO_FORM_REC.ELSOK AND NOT ELSOK THEN DO;

  19913  4 011572   200030 236100                    LDQ     PSEUDO_FORM_REC,,AUTO
         4 011573   100000 316003                    CANQ    32768,DU
         4 011574   011606 600000 4                  TZE     s:19917
         4 011575   200024 234100                    SZN     ELSOK,,AUTO
         4 011576   011606 604000 4                  TMI     s:19917

     2574    19914    4         PSEUDO_FORM_REC.ELSOK = AS_FALSE;

  19914  4 011577   000000 236000 xsym               LDQ     AS_FALSE
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:395  
         4 011600   000002 772000                    QRL     2
         4 011601   200030 676100                    ERQ     PSEUDO_FORM_REC,,AUTO
         4 011602   100000 376003                    ANQ     32768,DU
         4 011603   200030 656100                    ERSQ    PSEUDO_FORM_REC,,AUTO

     2575    19915    4         I = 1;

  19915  4 011604   000001 235007                    LDA     1,DL
         4 011605   204053 755100                    STA     I,,AUTO

     2576    19916    4         END;

     2577    19917    4      IF I > 0 THEN DO;

  19917  4 011606   204053 235100                    LDA     I,,AUTO
         4 011607   012102 604400 4                  TMOZ    NEXT

     2578    19918    4        CALL ASF$WRITE_FORM( USERS_KEY, ADDR(PSEUDO_FORM_REC),SIZEC(PSEUDO_FORM_REC) )
             19918                  ;

  19918  4 011610   200030 630500                    EPPR0   PSEUDO_FORM_REC,,AUTO
         4 011611   204110 450500                    STP0    @MAX_VAL+1,,AUTO
         4 011612   000147 236000 5                  LDQ     103
         4 011613   204113 756100                    STQ     @MAX_VAL+4,,AUTO
         4 011614   204110 631500                    EPPR1   @MAX_VAL+1,,AUTO
         4 011615   204112 451500                    STP1    @MAX_VAL+3,,AUTO
         4 011616   000146 236000 5                  LDQ     102
         4 011617   204111 756100                    STQ     @MAX_VAL+2,,AUTO
         4 011620   204111 630500                    EPPR0   @MAX_VAL+2,,AUTO
         4 011621   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 011622   000000 701000 xent               TSX1    ASF$WRITE_FORM
         4 011623   000000 011000                    NOP     0

     2579    19919
     2580    19920    4         FORM_KEY.TEXT = SUBSTR(USERS_KEY.TXTC,6,6);

  19920  4 011624   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:396  
         4 011625   000001 600006 xsym               ADSC9   USERS_KEY+1              cn=3,n=6
         4 011626   200031 200006                    ADSC9   FORM_KEY,,AUTO           cn=1,n=6

     2581    19921    4         ARS = 2048 * 4;

  19921  4 011627   020000 235007                    LDA     8192,DL
         4 011630   200020 755100                    STA     ARS,,AUTO

     2582    19922    4         CALL ASF$READ_FORM( FORM_KEY, F$, ARS ) ALTRET(NEXT);

  19922  4 011631   200020 630500                    EPPR0   ARS,,AUTO
         4 011632   204112 450500                    STP0    @MAX_VAL+3,,AUTO
         4 011633   204051 631500                    EPPR1   F$,,AUTO
         4 011634   204111 451500                    STP1    @MAX_VAL+2,,AUTO
         4 011635   200031 633500                    EPPR3   FORM_KEY,,AUTO
         4 011636   204110 453500                    STP3    @MAX_VAL+1,,AUTO
         4 011637   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 011640   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 011641   000000 701000 xent               TSX1    ASF$READ_FORM
         4 011642   012102 702000 4                  TSX2    NEXT

     2583    19923    4         J = 0;

  19923  4 011643   204054 450100                    STZ     J,,AUTO

     2584    19924    4         IF GRAPHIC

  19924  4 011644   200027 234100                    SZN     GRAPHIC,,AUTO
         4 011645   011746 605000 4                  TPL     s:19945

     2585    19925    5         THEN DO;

     2586    19926    6            IF F$->FS$GFORMREC.LGLTYPS.LPOK AND NOT LPOK THEN DO;

  19926  4 011646   204051 470500                    LDP0    F$,,AUTO
         4 011647   000004 236100                    LDQ     4,,PR0
         4 011650   000400 316003                    CANQ    256,DU
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:397  
         4 011651   011666 600000 4                  TZE     s:19931
         4 011652   200025 234100                    SZN     LPOK,,AUTO
         4 011653   011666 604000 4                  TMI     s:19931

     2587    19927    6               F$->FS$GFORMREC.LGLTYPS.LPOK = AS_FALSE;

  19927  4 011654   000000 236000 xsym               LDQ     AS_FALSE
         4 011655   000011 772000                    QRL     9
         4 011656   000004 676100                    ERQ     4,,PR0
         4 011657   000400 376003                    ANQ     256,DU
         4 011660   000004 656100                    ERSQ    4,,PR0

     2588    19928    6               AS_FIELD3.TEXT = 'LPOK=NO,';

  19928  4 011661   040000 100400                    MLR     fill='040'O
         4 011662   000071 000010 3                  ADSC9   TEXT_OFFSET+52           cn=0,n=8
         4 011663   000000 200050 xsym               ADSC9   AS_FIELD3                cn=1,n=40

     2589    19929    6               J = 7;

  19929  4 011664   000007 235007                    LDA     7,DL
         4 011665   204054 755100                    STA     J,,AUTO

     2590    19930    6               END;

     2591    19931    6            IF F$->FS$GFORMREC.LGLTYPS.TSOK AND NOT TSOK THEN DO;

  19931  4 011666   204051 470500                    LDP0    F$,,AUTO
         4 011667   000004 236100                    LDQ     4,,PR0
         4 011670   000200 316003                    CANQ    128,DU
         4 011671   011716 600000 4                  TZE     s:19937
         4 011672   200026 234100                    SZN     TSOK,,AUTO
         4 011673   011716 604000 4                  TMI     s:19937

     2592    19932    6               F$->FS$GFORMREC.LGLTYPS.TSOK = AS_FALSE;

  19932  4 011674   000000 236000 xsym               LDQ     AS_FALSE
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:398  
         4 011675   000012 772000                    QRL     10
         4 011676   000004 676100                    ERQ     4,,PR0
         4 011677   000200 376003                    ANQ     128,DU
         4 011700   000004 656100                    ERSQ    4,,PR0

     2593    19933    6               IF J > 0 THEN J = 8;

  19933  4 011701   204054 235100                    LDA     J,,AUTO
         4 011702   011705 604400 4                  TMOZ    s:19934

  19933  4 011703   000010 236007                    LDQ     8,DL
         4 011704   204054 756100                    STQ     J,,AUTO

     2594    19934    6               CALL INSERT( AS_FIELD3.TEXT, J, , 'TSOK=NO,' );

  19934  4 011705   204054 720100                    LXL0    J,,AUTO
         4 011706   777727 620010                    EAX0    -41,X0
         4 011707   777777 660003                    ERX0    -1,DU
         4 011710   204054 235100                    LDA     J,,AUTO
         4 011711   040045 100400                    MLR     fill='040'O
         4 011712   000073 000010 3                  ADSC9   TEXT_OFFSET+54           cn=0,n=8
         4 011713   000000 200010 xsym               ADSC9   AS_FIELD3,A              cn=1,n=*X0

     2595    19935    6               J = J + 7;

  19935  4 011714   000007 236007                    LDQ     7,DL
         4 011715   204054 056100                    ASQ     J,,AUTO

     2596    19936    6               END;

     2597    19937    6            IF F$->FS$GFORMREC.LGLTYPS.ELSOK AND NOT ELSOK THEN DO;

  19937  4 011716   204051 470500                    LDP0    F$,,AUTO
         4 011717   000004 236100                    LDQ     4,,PR0
         4 011720   000100 316003                    CANQ    64,DU
         4 011721   012045 600000 4                  TZE     s:19963
         4 011722   200024 234100                    SZN     ELSOK,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:399  
         4 011723   012045 604000 4                  TMI     s:19963

     2598    19938    6               F$->FS$GFORMREC.LGLTYPS.ELSOK = AS_FALSE;

  19938  4 011724   000000 236000 xsym               LDQ     AS_FALSE
         4 011725   000013 772000                    QRL     11
         4 011726   000004 676100                    ERQ     4,,PR0
         4 011727   000100 376003                    ANQ     64,DU
         4 011730   000004 656100                    ERSQ    4,,PR0

     2599    19939    6               IF J > 0 THEN J = J + 1;

  19939  4 011731   204054 235100                    LDA     J,,AUTO
         4 011732   011734 604400 4                  TMOZ    s:19940

  19939  4 011733   204054 054100                    AOS     J,,AUTO

     2600    19940    6               CALL INSERT( AS_FIELD3.TEXT, J, , 'ELSOK=NO' );

  19940  4 011734   204054 720100                    LXL0    J,,AUTO
         4 011735   777727 620010                    EAX0    -41,X0
         4 011736   777777 660003                    ERX0    -1,DU
         4 011737   204054 235100                    LDA     J,,AUTO
         4 011740   040045 100400                    MLR     fill='040'O
         4 011741   000075 000010 3                  ADSC9   TEXT_OFFSET+56           cn=0,n=8
         4 011742   000000 200010 xsym               ADSC9   AS_FIELD3,A              cn=1,n=*X0

     2601    19941    6               J = J + 8;

  19941  4 011743   000010 236007                    LDQ     8,DL
         4 011744   204054 056100                    ASQ     J,,AUTO

     2602    19942    6               END;

     2603    19943    5            END;

  19943  4 011745   012045 710000 4                  TRA     s:19963
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:400  

     2604    19944    5         ELSE DO;

     2605    19945    6            IF F$->FS$FORMREC.LGLTYPS.LPOK AND NOT LPOK THEN DO;

  19945  4 011746   204051 470500                    LDP0    F$,,AUTO
         4 011747   000004 236100                    LDQ     4,,PR0
         4 011750   000400 316003                    CANQ    256,DU
         4 011751   011766 600000 4                  TZE     s:19950
         4 011752   200025 234100                    SZN     LPOK,,AUTO
         4 011753   011766 604000 4                  TMI     s:19950

     2606    19946    6               F$->FS$FORMREC.LGLTYPS.LPOK = AS_FALSE;

  19946  4 011754   000000 236000 xsym               LDQ     AS_FALSE
         4 011755   000011 772000                    QRL     9
         4 011756   000004 676100                    ERQ     4,,PR0
         4 011757   000400 376003                    ANQ     256,DU
         4 011760   000004 656100                    ERSQ    4,,PR0

     2607    19947    6               AS_FIELD3.TEXT = 'LPOK=NO,';

  19947  4 011761   040000 100400                    MLR     fill='040'O
         4 011762   000071 000010 3                  ADSC9   TEXT_OFFSET+52           cn=0,n=8
         4 011763   000000 200050 xsym               ADSC9   AS_FIELD3                cn=1,n=40

     2608    19948    6               J = 7;

  19948  4 011764   000007 235007                    LDA     7,DL
         4 011765   204054 755100                    STA     J,,AUTO

     2609    19949    6               END;

     2610    19950    6            IF F$->FS$FORMREC.LGLTYPS.TSOK AND NOT TSOK THEN DO;

  19950  4 011766   204051 470500                    LDP0    F$,,AUTO
         4 011767   000004 236100                    LDQ     4,,PR0
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:401  
         4 011770   000200 316003                    CANQ    128,DU
         4 011771   012016 600000 4                  TZE     s:19956
         4 011772   200026 234100                    SZN     TSOK,,AUTO
         4 011773   012016 604000 4                  TMI     s:19956

     2611    19951    6               F$->FS$FORMREC.LGLTYPS.TSOK = AS_FALSE;

  19951  4 011774   000000 236000 xsym               LDQ     AS_FALSE
         4 011775   000012 772000                    QRL     10
         4 011776   000004 676100                    ERQ     4,,PR0
         4 011777   000200 376003                    ANQ     128,DU
         4 012000   000004 656100                    ERSQ    4,,PR0

     2612    19952    6               IF J > 0 THEN J = 8;

  19952  4 012001   204054 235100                    LDA     J,,AUTO
         4 012002   012005 604400 4                  TMOZ    s:19953

  19952  4 012003   000010 236007                    LDQ     8,DL
         4 012004   204054 756100                    STQ     J,,AUTO

     2613    19953    6               CALL INSERT( AS_FIELD3.TEXT, J, , 'TSOK=NO,' );

  19953  4 012005   204054 720100                    LXL0    J,,AUTO
         4 012006   777727 620010                    EAX0    -41,X0
         4 012007   777777 660003                    ERX0    -1,DU
         4 012010   204054 235100                    LDA     J,,AUTO
         4 012011   040045 100400                    MLR     fill='040'O
         4 012012   000073 000010 3                  ADSC9   TEXT_OFFSET+54           cn=0,n=8
         4 012013   000000 200010 xsym               ADSC9   AS_FIELD3,A              cn=1,n=*X0

     2614    19954    6               J = J + 7;

  19954  4 012014   000007 236007                    LDQ     7,DL
         4 012015   204054 056100                    ASQ     J,,AUTO

     2615    19955    6               END;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:402  

     2616    19956    6            IF F$->FS$FORMREC.LGLTYPS.ELSOK AND NOT ELSOK THEN DO;

  19956  4 012016   204051 470500                    LDP0    F$,,AUTO
         4 012017   000004 236100                    LDQ     4,,PR0
         4 012020   000100 316003                    CANQ    64,DU
         4 012021   012045 600000 4                  TZE     s:19963
         4 012022   200024 234100                    SZN     ELSOK,,AUTO
         4 012023   012045 604000 4                  TMI     s:19963

     2617    19957    6               F$->FS$FORMREC.LGLTYPS.ELSOK = AS_FALSE;

  19957  4 012024   000000 236000 xsym               LDQ     AS_FALSE
         4 012025   000013 772000                    QRL     11
         4 012026   000004 676100                    ERQ     4,,PR0
         4 012027   000100 376003                    ANQ     64,DU
         4 012030   000004 656100                    ERSQ    4,,PR0

     2618    19958    6               IF J > 0 THEN J = J + 1;

  19958  4 012031   204054 235100                    LDA     J,,AUTO
         4 012032   012034 604400 4                  TMOZ    s:19959

  19958  4 012033   204054 054100                    AOS     J,,AUTO

     2619    19959    6               CALL INSERT( AS_FIELD3.TEXT, J, , 'ELSOK=NO' );

  19959  4 012034   204054 720100                    LXL0    J,,AUTO
         4 012035   777727 620010                    EAX0    -41,X0
         4 012036   777777 660003                    ERX0    -1,DU
         4 012037   204054 235100                    LDA     J,,AUTO
         4 012040   040045 100400                    MLR     fill='040'O
         4 012041   000075 000010 3                  ADSC9   TEXT_OFFSET+56           cn=0,n=8
         4 012042   000000 200010 xsym               ADSC9   AS_FIELD3,A              cn=1,n=*X0

     2620    19960    6               J = J + 8;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:403  
  19960  4 012043   000010 236007                    LDQ     8,DL
         4 012044   204054 056100                    ASQ     J,,AUTO

     2621    19961    6               END;

     2622    19962    5            END;

     2623    19963    5         IF J > 0 THEN DO;

  19963  4 012045   204054 235100                    LDA     J,,AUTO
         4 012046   012102 604400 4                  TMOZ    NEXT

     2624    19964    5            CALL ASF$WRITE_FORM( FORM_KEY, F$, ARS );

  19964  4 012047   200020 630500                    EPPR0   ARS,,AUTO
         4 012050   204112 450500                    STP0    @MAX_VAL+3,,AUTO
         4 012051   204051 631500                    EPPR1   F$,,AUTO
         4 012052   204111 451500                    STP1    @MAX_VAL+2,,AUTO
         4 012053   200031 633500                    EPPR3   FORM_KEY,,AUTO
         4 012054   204110 453500                    STP3    @MAX_VAL+1,,AUTO
         4 012055   204110 630500                    EPPR0   @MAX_VAL+1,,AUTO
         4 012056   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 012057   000000 701000 xent               TSX1    ASF$WRITE_FORM
         4 012060   000000 011000                    NOP     0

     2625    19965        /*E* ERROR:   ASF-E$MOD_PSEUDO_FORM-C
     2626    19966             MESSAGE: Pseudo form %U1 also modified: %U3.
     2627    19967        */
     2628    19968    5            CALL INDEX( I, AS_BLANK, FORM_KEY.TEXT );

  19968  4 012061   000000 124500                    SCM     mask='000'O
         4 012062   200031 200006                    ADSC9   FORM_KEY,,AUTO           cn=1,n=6
         4 012063   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 012064   204053 000100                    ARG     I,,AUTO

     2629    19969    5            AS_FIELD1.COUNT = I;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:404  
  19969  4 012065   204053 236100                    LDQ     I,,AUTO
         4 012066   000033 736000                    QLS     27
         4 012067   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

     2630    19970    5            AS_FIELD1.TEXT = FORM_KEY.TEXT;

  19970  4 012070   040000 100500                    MLR     fill='040'O
         4 012071   200031 200006                    ADSC9   FORM_KEY,,AUTO           cn=1,n=6
         4 012072   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

     2631    19971    5            AS_FIELD3.COUNT = J;

  19971  4 012073   204054 236100                    LDQ     J,,AUTO
         4 012074   000033 736000                    QLS     27
         4 012075   000000 552040 xsym               STBQ    AS_FIELD3,'40'O

     2632    19972                 %SCREAM( ERR#=E$MOD_PSEUDO_FORM, LEVEL=INFO, MID='F' );

  19980  4 012076   000150 630400 5                  EPPR0   104
         4 012077   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 012100   000000 701000 xent               TSX1    ASH$INFO
         4 012101   000000 011000                    NOP     0

     2633    19987    5            END;

     2634    19988    4         END;

     2635    19989    3   NEXT: CALL ASF$PREC_SKIP_FORM( USERS_KEY );

  19989  4 012102   000146 630400 5     NEXT         EPPR0   102
         4 012103   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 012104   000000 701000 xent               TSX1    ASF$PREC_SKIP_FORM
         4 012105   000000 011000                    NOP     0

     2636    19990    3      ARS = SIZEC(PSEUDO_FORM_REC);

  19990  4 012106   000004 235007                    LDA     4,DL
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:405  
         4 012107   200020 755100                    STA     ARS,,AUTO

     2637    19991    3      CALL ASF$READ_FORM_SEQ( , ADDR(PSEUDO_FORM_REC), ARS ) ALTRET(FINISHED);

  19991  4 012110   200030 630500                    EPPR0   PSEUDO_FORM_REC,,AUTO
         4 012111   204110 450500                    STP0    @MAX_VAL+1,,AUTO
         4 012112   200020 631500                    EPPR1   ARS,,AUTO
         4 012113   204113 451500                    STP1    @MAX_VAL+4,,AUTO
         4 012114   204110 633500                    EPPR3   @MAX_VAL+1,,AUTO
         4 012115   204112 453500                    STP3    @MAX_VAL+3,,AUTO
         4 012116   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 012117   204111 756100                    STQ     @MAX_VAL+2,,AUTO
         4 012120   204111 630500                    EPPR0   @MAX_VAL+2,,AUTO
         4 012121   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 012122   000000 701000 xent               TSX1    ASF$READ_FORM_SEQ
         4 012123   012134 702000 4                  TSX2    FINISHED

     2638    19992    3      END;

  19992  4 012124   000000 236000 xsym               LDQ     USERS_KEY
         4 012125   777000 376003                    ANQ     -512,DU
         4 012126   014000 116003                    CMPQ    6144,DU
         4 012127   012134 601000 4                  TNZ     FINISHED
         4 012130   040100 106400                    CMPC    fill='040'O
         4 012131   000000 200006 xsym               ADSC9   USERS_KEY                cn=1,n=6
         4 012132   204055 000006                    ADSC9   FORM,,AUTO               cn=0,n=6
         4 012133   011543 600000 4                  TZE     s:19904

     2639    19993    2   FINISHED:
     2640    19994    2   RETURN;

  19994  4 012134   204052 221300       FINISHED     LDX1  ! F$+1,,AUTO
         4 012135   000001 702211                    TSX2  ! 1,X1

     2641    19995
     2642    19996    2   END MOD_PSEUDO_FORMS;
     2643    19997        %EJECT;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:406  
     2644    19998    1   FORM_GATHER: PROC ALTRET;

  19998  4 012136   204052 741300       FORM_GATHER  STX1  ! F$+1,,AUTO

     2645    19999
     2646    20000
     2647    20001    2   DCL FIXED_LENGTH STATIC UBIN HALF INIT(SIZEW(FS$FORMREC));
     2648    20002    2   DCL GFIXED_LENGTH STATIC UBIN HALF INIT(SIZEW(FS$GFORMREC));
     2649    20003    2   DCL FENTRYLEN STATIC UBIN HALF INIT(SIZEW(FS$FINST));
     2650    20004    2   DCL GENTRYLEN STATIC UBIN HALF INIT(SIZEW(FS$GBAN));
     2651    20005    2   DCL USE_LENGTH UBIN HALF;
     2652    20006    2   DCL ENTRY_LEN UBIN HALF;
     2653    20007    2   DCL NEW_BNRDISP UBIN HALF;
     2654    20008    2   DCL TEXT_LENGTH UBIN WORD;
     2655    20009    2   DCL ACCSS_LENGTH UBIN WORD UNAL;
     2656    20010    2   DCL ACCNT_LENGTH UBIN WORD UNAL;
     2657    20011    2   DCL BNNR_LENGTH UBIN WORD ;
     2658    20012    2   DCL ALGN_LENGTH UBIN WORD ;
     2659    20013    2   DCL SETUP_LENGTH UBIN WORD ;
     2660    20014    2   DCL I UBIN WORD;
     2661    20015        /*
     2662    20016              This code will gather all the elelments of the variable
     2663    20017              length :FORMS record and build and enter
     2664    20018              the appropriate displacement in the fixed portion of the
     2665    20019              record
     2666    20020
     2667    20021              there are some restrictions on the size of the record.
     2668    20022
     2669    20023                  Fixed + access + accounts + banner < 700 words
     2670    20024
     2671    20025                  total record < 2K
     2672    20026
     2673    20027        */
     2674    20028                                                                  /* */
     2675    20029                                                                  /* */
     2676    20030    2   IF GRAPHIC

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:407  
  20030  4 012137   200027 234100                    SZN     GRAPHIC,,AUTO
         4 012140   012147 605000 4                  TPL     s:20036

     2677    20031    3   THEN DO;

     2678    20032    3      USE_LENGTH = GFIXED_LENGTH;

  20032  4 012141   000010 220000 2                  LDX0    GFIXED_LENGTH
         4 012142   204053 740100                    STX0    USE_LENGTH,,AUTO

     2679    20033    3      ENTRY_LEN = GENTRYLEN - 1; /* 1 word header in gban */

  20033  4 012143   000012 222000 2                  LDX2    GENTRYLEN
         4 012144   777777 623012                    EAX3    -1,X2
         4 012145   204054 743100                    STX3    ENTRY_LEN,,AUTO

     2680    20034    3      END;

  20034  4 012146   012154 710000 4                  TRA     s:20039

     2681    20035    3   ELSE DO;

     2682    20036    3      USE_LENGTH = FIXED_LENGTH;

  20036  4 012147   000007 220000 2                  LDX0    FIXED_LENGTH
         4 012150   204053 740100                    STX0    USE_LENGTH,,AUTO

     2683    20037    3      ENTRY_LEN = FENTRYLEN - 1; /* 1 word header in finstn */

  20037  4 012151   000011 222000 2                  LDX2    FENTRYLEN
         4 012152   777777 623012                    EAX3    -1,X2
         4 012153   204054 743100                    STX3    ENTRY_LEN,,AUTO

     2684    20038    3      END;

     2685    20039    2   DISP_TALLY = USE_LENGTH; /* Displacement to access part */

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:408  
  20039  4 012154   200013 740100                    STX0    DISP_TALLY,,AUTO

     2686    20040    2   FF$ = PINCRW(F$,DISP_TALLY) ;

  20040  4 012155   200013 236100                    LDQ     DISP_TALLY,,AUTO
         4 012156   777777 376003                    ANQ     -1,DU
         4 012157   204051 036100                    ADLQ    F$,,AUTO
         4 012160   200011 756100                    STQ     FF$,,AUTO

  20040  4 012161                       ACCESS_PART  null
     2687    20041    2   ACCESS_PART: ;
     2688    20042    2   IF ACCSS$ ~= ADDR(NIL) AND ACCSS$->FS$ACCESS.TNAMES > 0 THEN

  20042  4 012161   000003 236000 2                  LDQ     ACCSS$
         4 012162   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 012163   012176 600000 4                  TZE     s:20045
         4 012164   000003 470400 2                  LDP0    ACCSS$
         4 012165   000100 100500                    MLR     fill='000'O
         4 012166   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         4 012167   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 012170   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 012171   000000 116003                    CMPQ    0,DU
         4 012172   012176 600000 4                  TZE     s:20045

     2689    20043    2      F$->FS$FORMREC.ACCSDISP = DISP_TALLY;

  20043  4 012173   204051 471500                    LDP1    F$,,AUTO
         4 012174   100002 440100                    SXL0    2,,PR1
         4 012175   012202 710000 4                  TRA     s:20050

     2690    20044    3   ELSE DO;

     2691    20045    3      F$->FS$FORMREC.ACCSDISP = 0;

  20045  4 012176   000000 222003                    LDX2    0,DU
         4 012177   204051 470500                    LDP0    F$,,AUTO
         4 012200   000002 442100                    SXL2    2,,PR0
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:409  

     2692    20046    3      GOTO ACCOUNT_PART;      /* No accesses  */

  20046  4 012201   012235 710000 4                  TRA     ACCOUNT_PART

     2693    20047    3      END;  /* Do */
     2694    20048                                                                  /* */
     2695    20049                                                                  /* */
     2696    20050    2   ACCSS_LENGTH = (ACCSS$->FS$ACCESS.TNAMES * 2) + 1;

  20050  4 012202   000100 100500                    MLR     fill='000'O
         4 012203   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         4 012204   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 012205   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 012206   000001 736000                    QLS     1
         4 012207   000001 036007                    ADLQ    1,DL
         4 012210   204057 756100                    STQ     ACCSS_LENGTH,,AUTO

     2697    20051                                                                  /* */
     2698    20052                                                                  /* */
     2699    20053                                                                 /*
     2700    20054              Now we know how much to move
     2701    20055                                                                 */
     2702    20056    2   FF$ = PINCRW(F$,DISP_TALLY);    /* Adjust pointer  */

  20056  4 012211   200013 236100                    LDQ     DISP_TALLY,,AUTO
         4 012212   777777 376003                    ANQ     -1,DU
         4 012213   204051 036100                    ADLQ    F$,,AUTO
         4 012214   200011 756100                    STQ     FF$,,AUTO

     2703    20057    2   MOVE_CNT = ACCSS_LENGTH*4;      /* Char count */

  20057  4 012215   204057 235100                    LDA     ACCSS_LENGTH,,AUTO
         4 012216   000002 735000                    ALS     2
         4 012217   200014 755100                    STA     MOVE_CNT,,AUTO

     2704    20058    2   FF$->TEMPLATE = ACCSS$->TEMPLATE;   /* Move it  */
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:410  

  20058  4 012220   000000 621005                    EAX1    0,AL
         4 012221   200011 471500                    LDP1    FF$,,AUTO
         4 012222   200014 722100                    LXL2    MOVE_CNT,,AUTO
         4 012223   040140 100540                    MLR     fill='040'O
         4 012224   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
         4 012225   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2

     2705    20059    2   ACCSS$ = ADDR(NIL);

  20059  4 012226   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 012227   000003 756000 2                  STQ     ACCSS$

     2706    20060    2   DISP_TALLY = DISP_TALLY + ACCSS_LENGTH;

  20060  4 012230   200013 236100                    LDQ     DISP_TALLY,,AUTO
         4 012231   000022 772000                    QRL     18
         4 012232   204057 036100                    ADLQ    ACCSS_LENGTH,,AUTO
         4 012233   000000 621006                    EAX1    0,QL
         4 012234   200013 741100                    STX1    DISP_TALLY,,AUTO

  20060  4 012235                       ACCOUNT_PART null
     2707    20061                                                                  /* */
     2708    20062                                                                  /* */
     2709    20063    2   ACCOUNT_PART: ;
     2710    20064    2   IF ACCNT$ ~= ADDR(NIL) AND ACCNT$->FS$ACCOUNTS.TACCTS > 0 THEN

  20064  4 012235   000002 236000 2                  LDQ     ACCNT$
         4 012236   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 012237   012253 600000 4                  TZE     s:20067
         4 012240   000002 470400 2                  LDP0    ACCNT$
         4 012241   000100 100500                    MLR     fill='000'O
         4 012242   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         4 012243   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 012244   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 012245   000000 116003                    CMPQ    0,DU
         4 012246   012253 600000 4                  TZE     s:20067
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:411  

     2711    20065    2      F$->FS$FORMREC.ACCTDISP = DISP_TALLY;

  20065  4 012247   200013 221100                    LDX1    DISP_TALLY,,AUTO
         4 012250   204051 471500                    LDP1    F$,,AUTO
         4 012251   100001 441100                    SXL1    1,,PR1
         4 012252   012257 710000 4                  TRA     s:20072

     2712    20066    3   ELSE DO;

     2713    20067    3      F$->FS$FORMREC.ACCTDISP = 0;

  20067  4 012253   000000 221003                    LDX1    0,DU
         4 012254   204051 470500                    LDP0    F$,,AUTO
         4 012255   000001 441100                    SXL1    1,,PR0

     2714    20068    3      GOTO BANNER_PART;      /* No accounts  */

  20068  4 012256   012312 710000 4                  TRA     BANNER_PART

     2715    20069    3      END;  /* Do */
     2716    20070                                                                  /* */
     2717    20071                                                                  /* */
     2718    20072    2   ACCNT_LENGTH = (ACCNT$->FS$ACCOUNTS.TACCTS * 2) + 1;

  20072  4 012257   000100 100500                    MLR     fill='000'O
         4 012260   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         4 012261   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 012262   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 012263   000001 736000                    QLS     1
         4 012264   000001 036007                    ADLQ    1,DL
         4 012265   204060 756100                    STQ     ACCNT_LENGTH,,AUTO

     2719    20073                                                                  /* */
     2720    20074                                                                  /* */
     2721    20075                                                                 /*
     2722    20076              Now we know how much to move
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:412  
     2723    20077                                                                 */
     2724    20078    2   FF$ = PINCRW(F$,DISP_TALLY);    /* Adjust pointer  */

  20078  4 012266   200013 236100                    LDQ     DISP_TALLY,,AUTO
         4 012267   777777 376003                    ANQ     -1,DU
         4 012270   204051 036100                    ADLQ    F$,,AUTO
         4 012271   200011 756100                    STQ     FF$,,AUTO

     2725    20079    2   MOVE_CNT = ACCNT_LENGTH*4;      /* Char count */

  20079  4 012272   204060 235100                    LDA     ACCNT_LENGTH,,AUTO
         4 012273   000002 735000                    ALS     2
         4 012274   200014 755100                    STA     MOVE_CNT,,AUTO

     2726    20080    2   FF$->TEMPLATE = ACCNT$->TEMPLATE;   /* Move it  */

  20080  4 012275   000000 622005                    EAX2    0,AL
         4 012276   200011 471500                    LDP1    FF$,,AUTO
         4 012277   200014 724100                    LXL4    MOVE_CNT,,AUTO
         4 012300   040140 100540                    MLR     fill='040'O
         4 012301   000000 000012                    ADSC9   0,,PR0                   cn=0,n=*X2
         4 012302   100000 000014                    ADSC9   0,,PR1                   cn=0,n=*X4

     2727    20081    2   ACCNT$ = ADDR(NIL);

  20081  4 012303   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 012304   000002 756000 2                  STQ     ACCNT$

     2728    20082    2   DISP_TALLY = DISP_TALLY + ACCNT_LENGTH;

  20082  4 012305   200013 236100                    LDQ     DISP_TALLY,,AUTO
         4 012306   000022 772000                    QRL     18
         4 012307   204060 036100                    ADLQ    ACCNT_LENGTH,,AUTO
         4 012310   000000 622006                    EAX2    0,QL
         4 012311   200013 742100                    STX2    DISP_TALLY,,AUTO

  20082  4 012312                       BANNER_PART  null
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:413  
     2729    20083    2   BANNER_PART: ;
     2730    20084    2   IF BNNR$ = ADDR(NIL)

  20084  4 012312   000004 236000 2                  LDQ     BNNR$
         4 012313   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 012314   012321 601000 4                  TNZ     s:20089

     2731    20085    3   THEN DO;

     2732    20086    3      F$->FS$FORMREC.BANRDISP = 0;

  20086  4 012315   000000 221003                    LDX1    0,DU
         4 012316   204051 470500                    LDP0    F$,,AUTO
         4 012317   000003 741100                    STX1    3,,PR0

     2733    20087    3      GOTO CHECK_LENGTH_1;

  20087  4 012320   013007 710000 4                  TRA     CHECK_LENGTH_1

     2734    20088    3      END;     /* Do */
     2735    20089    2   F$->FS$FORMREC.BANRDISP = DISP_TALLY;

  20089  4 012321   200013 221100                    LDX1    DISP_TALLY,,AUTO
         4 012322   204051 470500                    LDP0    F$,,AUTO
         4 012323   000003 741100                    STX1    3,,PR0

     2736    20090    2   IF OLD_BANNER = '1'B

  20090  4 012324   000000 234000 2                  SZN     OLD_BANNER
         4 012325   012504 605000 4                  TPL     s:20139

     2737    20091    3   THEN DO;                  /* The banner is in tact from a

     2738    20092                                          previous record, I.E.,
     2739    20093                                          create = AS_FALSE      */
     2740    20094    3      OLD_BANNER='0'B;     /* Clear it               */

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:414  
  20094  4 012326   000000 450000 2                  STZ     OLD_BANNER

     2741    20095    3      IF GRAPHIC

  20095  4 012327   200027 234100                    SZN     GRAPHIC,,AUTO
         4 012330   012406 605000 4                  TPL     s:20113

     2742    20096    4      THEN DO;

     2743    20097    4         ENUM = BNNR$->FS$GBAN.NUM_ENTRIES;

  20097  4 012331   000004 470400 2                  LDP0    BNNR$
         4 012332   000100 101500                    MRL     fill='000'O
         4 012333   000000 600001                    ADSC9   0,,PR0                   cn=3,n=1
         4 012334   200004 000004                    ADSC9   ENUM,,AUTO               cn=0,n=4

     2744    20098    4         BNNR_LENGTH = ENUM * ENTRY_LEN + 1;

  20098  4 012335   204054 236100                    LDQ     ENTRY_LEN,,AUTO
         4 012336   000022 772000                    QRL     18
         4 012337   200004 402100                    MPY     ENUM,,AUTO
         4 012340   000001 036007                    ADLQ    1,DL
         4 012341   204061 756100                    STQ     BNNR_LENGTH,,AUTO

     2745    20099    5         DO I = 0 TO ENUM-1; /* Find first disp   */

  20099  4 012342   204064 450100                    STZ     I,,AUTO
         4 012343   012402 710000 4                  TRA     s:20110+3

     2746    20100    5            IF BNNR$->FS$GBAN.ENTRIES.DISP(I) ~= 0

  20100  4 012344   204064 236100                    LDQ     I,,AUTO
         4 012345   000060 402007                    MPY     48,DL
         4 012346   000004 470400 2                  LDP0    BNNR$
         4 012347   000100 101506                    MRL     fill='000'O
         4 012350   000012 600002                    ADSC9   10,Q,PR0                 cn=3,n=2
         4 012351   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:415  
         4 012352   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 012353   000000 116003                    CMPQ    0,DU
         4 012354   012377 600000 4                  TZE     s:20110

     2747    20101    6            THEN DO;

     2748    20102                         /* This only works because the text area is built
     2749    20103                            backwards.  The first entry is the last piece of
     2750    20104                            text.
     2751    20105                         */
     2752    20106    6               BNNR_LENGTH = (BNNR$->FS$GBAN.ENTRIES.COUNT(I) +3) / 4;

  20106  4 012355   204064 236100                    LDQ     I,,AUTO
         4 012356   000060 402007                    MPY     48,DL
         4 012357   000100 101506                    MRL     fill='000'O
         4 012360   000012 400001                    ADSC9   10,Q,PR0                 cn=2,n=1
         4 012361   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 012362   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 012363   000003 036007                    ADLQ    3,DL
         4 012364   000002 772000                    QRL     2
         4 012365   204061 756100                    STQ     BNNR_LENGTH,,AUTO

     2753    20107    6               BNNR_LENGTH = BNNR$->FS$GBAN.ENTRIES.DISP(I) + BNNR_LENGTH;

  20107  4 012366   204064 236100                    LDQ     I,,AUTO
         4 012367   000060 402007                    MPY     48,DL
         4 012370   000100 101506                    MRL     fill='000'O
         4 012371   000012 600002                    ADSC9   10,Q,PR0                 cn=3,n=2
         4 012372   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 012373   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 012374   204061 036100                    ADLQ    BNNR_LENGTH,,AUTO
         4 012375   204061 756100                    STQ     BNNR_LENGTH,,AUTO

     2754    20108    6               GOTO END_LOOP;

  20108  4 012376   012455 710000 4                  TRA     END_LOOP

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:416  
     2755    20109    6               END;
     2756    20110    5            END; /* Do i */

  20110  4 012377   204064 235100                    LDA     I,,AUTO
         4 012400   000001 035007                    ADLA    1,DL
         4 012401   204064 755100                    STA     I,,AUTO
         4 012402   204064 236100                    LDQ     I,,AUTO
         4 012403   200004 116100                    CMPQ    ENUM,,AUTO
         4 012404   012344 602000 4                  TNC     s:20100

     2757    20111    4         END;

  20111  4 012405   012455 710000 4                  TRA     END_LOOP

     2758    20112    4      ELSE DO;

     2759    20113    4         ENUM = BNNR$->FS$FINST.NUM_ENTRIES;

  20113  4 012406   000004 470400 2                  LDP0    BNNR$
         4 012407   000100 101500                    MRL     fill='000'O
         4 012410   000000 600001                    ADSC9   0,,PR0                   cn=3,n=1
         4 012411   200004 000004                    ADSC9   ENUM,,AUTO               cn=0,n=4

     2760    20114    4         BNNR_LENGTH = ENUM * 4 + 1;  /* Size of banner (words)*/

  20114  4 012412   200004 235100                    LDA     ENUM,,AUTO
         4 012413   000002 735000                    ALS     2
         4 012414   000001 035007                    ADLA    1,DL
         4 012415   204061 755100                    STA     BNNR_LENGTH,,AUTO

     2761    20115    5         DO I = 0 TO ENUM-1; /* Find first disp   */

  20115  4 012416   204064 450100                    STZ     I,,AUTO
         4 012417   012452 710000 4                  TRA     s:20126+3

     2762    20116    5            IF BNNR$->FS$FINST.ENTRIES.DISP(I) ~= 0

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:417  
  20116  4 012420   204064 235100                    LDA     I,,AUTO
         4 012421   000004 735000                    ALS     4
         4 012422   000004 470400 2                  LDP0    BNNR$
         4 012423   000100 101505                    MRL     fill='000'O
         4 012424   000003 200002                    ADSC9   3,A,PR0                  cn=1,n=2
         4 012425   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 012426   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 012427   000000 116003                    CMPQ    0,DU
         4 012430   012447 600000 4                  TZE     s:20126

     2763    20117    6            THEN DO;

     2764    20118                         /* This only works because the text area is built
     2765    20119                            backwards.  The first entry is the last piece of
     2766    20120                            text.
     2767    20121                         */
     2768    20122    6               BNNR_LENGTH = (BNNR$->FS$FINST.ENTRIES.COUNT(I) +3) / 4;

  20122  4 012431   000100 101505                    MRL     fill='000'O
         4 012432   000003 600001                    ADSC9   3,A,PR0                  cn=3,n=1
         4 012433   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 012434   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 012435   000003 036007                    ADLQ    3,DL
         4 012436   000002 772000                    QRL     2
         4 012437   204061 756100                    STQ     BNNR_LENGTH,,AUTO

     2769    20123    6               BNNR_LENGTH = BNNR$->FS$FINST.ENTRIES.DISP(I) + BNNR_LENGTH;

  20123  4 012440   000100 101505                    MRL     fill='000'O
         4 012441   000003 200002                    ADSC9   3,A,PR0                  cn=1,n=2
         4 012442   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 012443   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 012444   204061 036100                    ADLQ    BNNR_LENGTH,,AUTO
         4 012445   204061 756100                    STQ     BNNR_LENGTH,,AUTO

     2770    20124    6               GOTO END_LOOP;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:418  
  20124  4 012446   012455 710000 4                  TRA     END_LOOP

     2771    20125    6               END;
     2772    20126    5            END; /* Do i */

  20126  4 012447   204064 235100                    LDA     I,,AUTO
         4 012450   000001 035007                    ADLA    1,DL
         4 012451   204064 755100                    STA     I,,AUTO
         4 012452   204064 236100                    LDQ     I,,AUTO
         4 012453   200004 116100                    CMPQ    ENUM,,AUTO
         4 012454   012420 602000 4                  TNC     s:20116

     2773    20127    4         END;

     2774    20128    3   END_LOOP:
     2775    20129                                                                    /* */
     2776    20130    3      FF$ = PINCRW(F$,DISP_TALLY);

  20130  4 012455   200013 236100       END_LOOP     LDQ     DISP_TALLY,,AUTO
         4 012456   777777 376003                    ANQ     -1,DU
         4 012457   204051 036100                    ADLQ    F$,,AUTO
         4 012460   200011 756100                    STQ     FF$,,AUTO

     2777    20131    3      MOVE_CNT = BNNR_LENGTH*4;

  20131  4 012461   204061 235100                    LDA     BNNR_LENGTH,,AUTO
         4 012462   000002 735000                    ALS     2
         4 012463   200014 755100                    STA     MOVE_CNT,,AUTO

     2778    20132    3      FF$->TEMPLATE = BNNR$->TEMPLATE;

  20132  4 012464   000000 620005                    EAX0    0,AL
         4 012465   200011 471500                    LDP1    FF$,,AUTO
         4 012466   200014 721100                    LXL1    MOVE_CNT,,AUTO
         4 012467   040140 100540                    MLR     fill='040'O
         4 012470   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         4 012471   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:419  

     2779    20133    3      BNNR$ = ADDR(NIL);

  20133  4 012472   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 012473   000004 756000 2                  STQ     BNNR$

     2780    20134    3      DISP_TALLY = DISP_TALLY + BNNR_LENGTH;

  20134  4 012474   200013 236100                    LDQ     DISP_TALLY,,AUTO
         4 012475   000022 772000                    QRL     18
         4 012476   204061 036100                    ADLQ    BNNR_LENGTH,,AUTO
         4 012477   000000 620006                    EAX0    0,QL
         4 012500   200013 740100                    STX0    DISP_TALLY,,AUTO

     2781    20135    3      BNNR$ = ADDR(NIL);

  20135  4 012501   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 012502   000004 756000 2                  STQ     BNNR$

     2782    20136    3      GOTO CHECK_LENGTH_1;

  20136  4 012503   013007 710000 4                  TRA     CHECK_LENGTH_1

     2783    20137    3      END;    /* Do if using old banner   */
     2784    20138                                                                  /* */
     2785    20139    2   IF GRAPHIC

  20139  4 012504   200027 234100                    SZN     GRAPHIC,,AUTO
         4 012505   012534 605000 4                  TPL     s:20148

     2786    20140    3   THEN DO;

     2787    20141    3      ENUM = BNNR$->FS$GBAN.NUM_ENTRIES;

  20141  4 012506   000004 470400 2                  LDP0    BNNR$
         4 012507   000100 101500                    MRL     fill='000'O
         4 012510   000000 600001                    ADSC9   0,,PR0                   cn=3,n=1
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:420  
         4 012511   200004 000004                    ADSC9   ENUM,,AUTO               cn=0,n=4

     2788    20142    4      DO I = 0 TO ENUM-1;

  20142  4 012512   204064 450100                    STZ     I,,AUTO
         4 012513   012530 710000 4                  TRA     s:20145+3

     2789    20143    4         BNNR$->FS$GBAN.ENTRIES.TOTLEN(I) = 0;

  20143  4 012514   204064 236100                    LDQ     I,,AUTO
         4 012515   000060 402007                    MPY     48,DL
         4 012516   000004 470400 2                  LDP0    BNNR$
         4 012517   000106 101400                    MRL     fill='000'O
         4 012520   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 012521   000013 200003                    ADSC9   11,Q,PR0                 cn=1,n=3

     2790    20144    4         BNNR$->FS$GBAN.ENTRIES.MARK(I) = 0;

  20144  4 012522   000106 101400                    MRL     fill='000'O
         4 012523   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 012524   000014 600001                    ADSC9   12,Q,PR0                 cn=3,n=1

     2791    20145    4         END;              /*  End i   */

  20145  4 012525   204064 235100                    LDA     I,,AUTO
         4 012526   000001 035007                    ADLA    1,DL
         4 012527   204064 755100                    STA     I,,AUTO
         4 012530   204064 236100                    LDQ     I,,AUTO
         4 012531   200004 116100                    CMPQ    ENUM,,AUTO
         4 012532   012514 602000 4                  TNC     s:20143

     2792    20146    3      END;

  20146  4 012533   012561 710000 4                  TRA     s:20159

     2793    20147    3   ELSE DO;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:421  
     2794    20148    3      ENUM = BNNR$->FS$FINST.NUM_ENTRIES;

  20148  4 012534   000004 470400 2                  LDP0    BNNR$
         4 012535   000100 101500                    MRL     fill='000'O
         4 012536   000000 600001                    ADSC9   0,,PR0                   cn=3,n=1
         4 012537   200004 000004                    ADSC9   ENUM,,AUTO               cn=0,n=4

     2795    20149    4      DO I = 0 TO ENUM-1;

  20149  4 012540   204064 450100                    STZ     I,,AUTO
         4 012541   012556 710000 4                  TRA     s:20152+3

     2796    20150    4         BNNR$->FS$FINST.ENTRIES.TOTLEN(I) = 0;

  20150  4 012542   204064 235100                    LDA     I,,AUTO
         4 012543   000004 735000                    ALS     4
         4 012544   000004 470400 2                  LDP0    BNNR$
         4 012545   000105 101400                    MRL     fill='000'O
         4 012546   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 012547   000004 000003                    ADSC9   4,A,PR0                  cn=0,n=3

     2797    20151    4         BNNR$->FS$FINST.ENTRIES.MARK(I) = 0;

  20151  4 012550   000105 101400                    MRL     fill='000'O
         4 012551   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 012552   000004 600001                    ADSC9   4,A,PR0                  cn=3,n=1

     2798    20152    4         END;              /*  End i   */

  20152  4 012553   204064 236100                    LDQ     I,,AUTO
         4 012554   000001 036007                    ADLQ    1,DL
         4 012555   204064 756100                    STQ     I,,AUTO
         4 012556   204064 236100                    LDQ     I,,AUTO
         4 012557   200004 116100                    CMPQ    ENUM,,AUTO
         4 012560   012542 602000 4                  TNC     s:20150

     2799    20153    3      END;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:422  

     2800    20154                                                                  /*
     2801    20155              The length of the banner portion must be done in
     2802    20156              two parts -
     2803    20157                  first the forms instruction protion
     2804    20158                                                                  */
     2805    20159    2   IF GRAPHIC

  20159  4 012561   200027 234100                    SZN     GRAPHIC,,AUTO
         4 012562   012576 605000 4                  TPL     s:20164

     2806    20160    3   THEN DO;

     2807    20161    3      BNNR_LENGTH = (BNNR$ ->FS$GBAN.NUM_ENTRIES * ENTRY_LEN) + 1;

  20161  4 012563   204054 235100                    LDA     ENTRY_LEN,,AUTO
         4 012564   000022 771000                    ARL     18
         4 012565   204110 755100                    STA     @MAX_VAL+1,,AUTO
         4 012566   000100 101500                    MRL     fill='000'O
         4 012567   000000 600001                    ADSC9   0,,PR0                   cn=3,n=1
         4 012570   204111 000004                    ADSC9   @MAX_VAL+2,,AUTO         cn=0,n=4
         4 012571   204111 236100                    LDQ     @MAX_VAL+2,,AUTO
         4 012572   204110 402100                    MPY     @MAX_VAL+1,,AUTO
         4 012573   000001 036007                    ADLQ    1,DL
         4 012574   204061 756100                    STQ     BNNR_LENGTH,,AUTO

     2808    20162    3      END;

  20162  4 012575   012605 710000 4                  TRA     s:20170

     2809    20163    3   ELSE DO;

     2810    20164    3      BNNR_LENGTH = (BNNR$ ->FS$FINST.NUM_ENTRIES * 4) + 1;

  20164  4 012576   000100 101500                    MRL     fill='000'O
         4 012577   000000 600001                    ADSC9   0,,PR0                   cn=3,n=1
         4 012600   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:423  
         4 012601   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 012602   000002 736000                    QLS     2
         4 012603   000001 036007                    ADLQ    1,DL
         4 012604   204061 756100                    STQ     BNNR_LENGTH,,AUTO

     2811    20165    3      END;

     2812    20166                                                                 /*
     2813    20167              Change the disp field in each entry before bringing
     2814    20168              up the text
     2815    20169                                                          */
     2816    20170    3   IF FCB$ ~= ADDR(NIL) THEN DO ;

  20170  4 012605   200007 236100                    LDQ     FCB$,,AUTO
         4 012606   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 012607   012715 600000 4                  TZE     s:20189

     2817    20171    3      FF$ = PINCRW(BNNR$,BNNR_LENGTH) ;

  20171  4 012610   204061 236100                    LDQ     BNNR_LENGTH,,AUTO
         4 012611   000022 736000                    QLS     18
         4 012612   000004 036000 2                  ADLQ    BNNR$
         4 012613   200011 756100                    STQ     FF$,,AUTO

     2818    20172    3      NEW_BNRDISP = POFFW(FCB$,FF$);

  20172  4 012614   200011 235100                    LDA     FF$,,AUTO
         4 012615   000022 771000                    ARL     18
         4 012616   204110 755100                    STA     @MAX_VAL+1,,AUTO
         4 012617   200007 236100                    LDQ     FCB$,,AUTO
         4 012620   000022 772000                    QRL     18
         4 012621   204110 136100                    SBLQ    @MAX_VAL+1,,AUTO
         4 012622   000000 620006                    EAX0    0,QL
         4 012623   204055 740100                    STX0    NEW_BNRDISP,,AUTO

     2819    20173    4      DO I = 0 TO ENUM - 1;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:424  
  20173  4 012624   204064 450100                    STZ     I,,AUTO
         4 012625   012712 710000 4                  TRA     s:20187+3

     2820    20174    4         IF GRAPHIC

  20174  4 012626   200027 234100                    SZN     GRAPHIC,,AUTO
         4 012627   012662 605000 4                  TPL     s:20182

     2821    20175    5         THEN DO;

     2822    20176    5            IF BNNR$ ->FS$GBAN.ENTRIES.DISP(I) ~= 0

  20176  4 012630   204064 236100                    LDQ     I,,AUTO
         4 012631   000060 402007                    MPY     48,DL
         4 012632   000004 470400 2                  LDP0    BNNR$
         4 012633   000100 101506                    MRL     fill='000'O
         4 012634   000012 600002                    ADSC9   10,Q,PR0                 cn=3,n=2
         4 012635   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 012636   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 012637   000000 116003                    CMPQ    0,DU
         4 012640   012707 600000 4                  TZE     s:20187

     2823    20177    6            THEN DO;

     2824    20178    6               BNNR$ ->FS$GBAN.ENTRIES.DISP(I) = BNNR$ ->FS$GBAN.ENTRIES.DISP(I) -
             20178                        NEW_BNRDISP;

  20178  4 012641   204055 235100                    LDA     NEW_BNRDISP,,AUTO
         4 012642   000022 771000                    ARL     18
         4 012643   204110 755100                    STA     @MAX_VAL+1,,AUTO
         4 012644   204064 236100                    LDQ     I,,AUTO
         4 012645   000060 402007                    MPY     48,DL
         4 012646   000100 101506                    MRL     fill='000'O
         4 012647   000012 600002                    ADSC9   10,Q,PR0                 cn=3,n=2
         4 012650   204111 000004                    ADSC9   @MAX_VAL+2,,AUTO         cn=0,n=4
         4 012651   204111 236100                    LDQ     @MAX_VAL+2,,AUTO
         4 012652   204110 136100                    SBLQ    @MAX_VAL+1,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:425  
         4 012653   204112 756100                    STQ     @MAX_VAL+3,,AUTO
         4 012654   204064 236100                    LDQ     I,,AUTO
         4 012655   000060 402007                    MPY     48,DL
         4 012656   000106 101500                    MRL     fill='000'O
         4 012657   204112 000004                    ADSC9   @MAX_VAL+3,,AUTO         cn=0,n=4
         4 012660   000012 600002                    ADSC9   10,Q,PR0                 cn=3,n=2

     2825    20179    6               END;

     2826    20180    5            END;

  20180  4 012661   012707 710000 4                  TRA     s:20187

     2827    20181    5         ELSE DO;

     2828    20182    5            IF BNNR$ -> FS$FINST.ENTRIES.DISP(I) ~= 0

  20182  4 012662   204064 235100                    LDA     I,,AUTO
         4 012663   000004 735000                    ALS     4
         4 012664   000004 470400 2                  LDP0    BNNR$
         4 012665   000100 101505                    MRL     fill='000'O
         4 012666   000003 200002                    ADSC9   3,A,PR0                  cn=1,n=2
         4 012667   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 012670   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 012671   000000 116003                    CMPQ    0,DU
         4 012672   012707 600000 4                  TZE     s:20187

     2829    20183    6            THEN DO;

     2830    20184    6               BNNR$ -> FS$FINST.ENTRIES.DISP(I) = BNNR$ ->FS$FINST.ENTRIES.DISP(I) -
             20184                        NEW_BNRDISP;

  20184  4 012673   204055 236100                    LDQ     NEW_BNRDISP,,AUTO
         4 012674   000022 772000                    QRL     18
         4 012675   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 012676   000100 101505                    MRL     fill='000'O
         4 012677   000003 200002                    ADSC9   3,A,PR0                  cn=1,n=2
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:426  
         4 012700   204111 000004                    ADSC9   @MAX_VAL+2,,AUTO         cn=0,n=4
         4 012701   204111 236100                    LDQ     @MAX_VAL+2,,AUTO
         4 012702   204110 136100                    SBLQ    @MAX_VAL+1,,AUTO
         4 012703   204112 756100                    STQ     @MAX_VAL+3,,AUTO
         4 012704   000105 101500                    MRL     fill='000'O
         4 012705   204112 000004                    ADSC9   @MAX_VAL+3,,AUTO         cn=0,n=4
         4 012706   000003 200002                    ADSC9   3,A,PR0                  cn=1,n=2

     2831    20185    6               END;

     2832    20186    5            END;

     2833    20187    4         END; /* I */

  20187  4 012707   204064 235100                    LDA     I,,AUTO
         4 012710   000001 035007                    ADLA    1,DL
         4 012711   204064 755100                    STA     I,,AUTO
         4 012712   204064 236100                    LDQ     I,,AUTO
         4 012713   200004 116100                    CMPQ    ENUM,,AUTO
         4 012714   012626 602000 4                  TNC     s:20174

     2834    20188    3      END;      /* Do if   */

     2835    20189    2   FF$ = PINCRW(F$,DISP_TALLY);

  20189  4 012715   200013 236100                    LDQ     DISP_TALLY,,AUTO
         4 012716   777777 376003                    ANQ     -1,DU
         4 012717   204051 036100                    ADLQ    F$,,AUTO
         4 012720   200011 756100                    STQ     FF$,,AUTO

     2836    20190    2   MOVE_CNT = BNNR_LENGTH*4;       /* Char count  */

  20190  4 012721   204061 235100                    LDA     BNNR_LENGTH,,AUTO
         4 012722   000002 735000                    ALS     2
         4 012723   200014 755100                    STA     MOVE_CNT,,AUTO

     2837    20191    2   FF$->TEMPLATE = BNNR$->TEMPLATE;      /* Move 'EM  */
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:427  

  20191  4 012724   000000 620005                    EAX0    0,AL
         4 012725   200011 471500                    LDP1    FF$,,AUTO
         4 012726   200014 721100                    LXL1    MOVE_CNT,,AUTO
         4 012727   040140 100540                    MLR     fill='040'O
         4 012730   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         4 012731   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

     2838    20192    2   DISP_TALLY = DISP_TALLY + BNNR_LENGTH;

  20192  4 012732   200013 236100                    LDQ     DISP_TALLY,,AUTO
         4 012733   000022 772000                    QRL     18
         4 012734   204061 036100                    ADLQ    BNNR_LENGTH,,AUTO
         4 012735   000000 620006                    EAX0    0,QL
         4 012736   200013 740100                    STX0    DISP_TALLY,,AUTO

     2839    20193    2   IF FCB$ = ADDR(NIL)

  20193  4 012737   200007 236100                    LDQ     FCB$,,AUTO
         4 012740   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 012741   012745 601000 4                  TNZ     s:20203

     2840    20194    3   THEN DO;

     2841    20195    3      BNNR$ = ADDR(NIL) ;

  20195  4 012742   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 012743   000004 756000 2                  STQ     BNNR$

     2842    20196    3      GOTO CHECK_LENGTH_1;

  20196  4 012744   013007 710000 4                  TRA     CHECK_LENGTH_1

     2843    20197    3      END;      /*   End do    */
     2844    20198                                                        /*
     2845    20199
     2846    20200              Now move the text
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:428  
     2847    20201
     2848    20202                                                          */
     2849    20203    2   TEXT_LENGTH = POFFW(FCB$,BNNR$);

  20203  4 012745   000004 235000 2                  LDA     BNNR$
         4 012746   000022 771000                    ARL     18
         4 012747   204110 755100                    STA     @MAX_VAL+1,,AUTO
         4 012750   200007 236100                    LDQ     FCB$,,AUTO
         4 012751   000022 772000                    QRL     18
         4 012752   204110 136100                    SBLQ    @MAX_VAL+1,,AUTO
         4 012753   204056 756100                    STQ     TEXT_LENGTH,,AUTO

     2850    20204    2   TEXT_LENGTH = (TEXT_OFFSET-BNNR_OFFSET) - TEXT_LENGTH;

  20204  4 012754   000005 236000 3                  LDQ     TEXT_OFFSET
         4 012755   000002 136000 3                  SBLQ    BNNR_OFFSET
         4 012756   204056 136100                    SBLQ    TEXT_LENGTH,,AUTO
         4 012757   204056 756100                    STQ     TEXT_LENGTH,,AUTO

     2851    20205    2   BNNR$ = ADDR(NIL);

  20205  4 012760   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 012761   000004 756000 2                  STQ     BNNR$

     2852    20206                                                            /*
     2853    20207                                                            */
     2854    20208    2   FF$ = PINCRW(F$,DISP_TALLY);

  20208  4 012762   200013 236100                    LDQ     DISP_TALLY,,AUTO
         4 012763   777777 376003                    ANQ     -1,DU
         4 012764   204051 036100                    ADLQ    F$,,AUTO
         4 012765   200011 756100                    STQ     FF$,,AUTO

     2855    20209    2   MOVE_CNT = TEXT_LENGTH*4;

  20209  4 012766   204056 235100                    LDA     TEXT_LENGTH,,AUTO
         4 012767   000002 735000                    ALS     2
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:429  
         4 012770   200014 755100                    STA     MOVE_CNT,,AUTO

     2856    20210    2   FF$ -> TEMPLATE = FCB$ -> TEMPLATE;

  20210  4 012771   200007 470500                    LDP0    FCB$,,AUTO
         4 012772   000000 621005                    EAX1    0,AL
         4 012773   200011 471500                    LDP1    FF$,,AUTO
         4 012774   200014 722100                    LXL2    MOVE_CNT,,AUTO
         4 012775   040140 100540                    MLR     fill='040'O
         4 012776   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
         4 012777   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2

     2857    20211    2   DISP_TALLY = DISP_TALLY + TEXT_LENGTH;

  20211  4 013000   200013 236100                    LDQ     DISP_TALLY,,AUTO
         4 013001   000022 772000                    QRL     18
         4 013002   204056 036100                    ADLQ    TEXT_LENGTH,,AUTO
         4 013003   000000 621006                    EAX1    0,QL
         4 013004   200013 741100                    STX1    DISP_TALLY,,AUTO

     2858    20212    2   FCB$ = ADDR(NIL);

  20212  4 013005   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 013006   200007 756100                    STQ     FCB$,,AUTO

  20212  4 013007                       CHECK_LENGT* null
     2859    20213    2   CHECK_LENGTH_1: ;
     2860    20214    2   IF (DISP_TALLY - USE_LENGTH) > 1024

  20214  4 013007   204053 235100                    LDA     USE_LENGTH,,AUTO
         4 013010   000022 771000                    ARL     18
         4 013011   204110 755100                    STA     @MAX_VAL+1,,AUTO
         4 013012   200013 236100                    LDQ     DISP_TALLY,,AUTO
         4 013013   000022 772000                    QRL     18
         4 013014   204110 136100                    SBLQ    @MAX_VAL+1,,AUTO
         4 013015   002000 116007                    CMPQ    1024,DL
         4 013016   013025 604400 4                  TMOZ    s:20237
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:430  

     2861    20215    3   THEN DO;

     2862    20216        /*E*     ERROR: ASF-E$FORMTOOLONG-0
     2863    20217                 MESSAGE: :FORM Record too long
     2864    20218                 MESSAGE1: FIXED + ACCESS + ACCOUNT + BANNER > 700 WORDS
     2865    20219        */
     2866    20220           %SCREAM( ERR#=E$FORMTOOLONG,MID='F',LEVEL=ERROR);

  20232  4 013017   000151 630400 5                  EPPR0   105
         4 013020   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 013021   000000 701000 xent               TSX1    ASH$ERROR
         4 013022   000000 011000                    NOP     0

     2867    20235    3      ALTRETURN;

  20235  4 013023   204052 221300                    LDX1  ! F$+1,,AUTO
         4 013024   000000 702211                    TSX2  ! 0,X1

     2868    20236    3      END;
     2869    20237    2   IF SETUP$ = ADDR(NIL)

  20237  4 013025   000006 236000 2                  LDQ     SETUP$
         4 013026   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 013027   013034 601000 4                  TNZ     s:20244

     2870    20238    3   THEN DO;

     2871    20239    3      F$->FS$FORMREC.SETUPDISP = 0;

  20239  4 013030   000000 220003                    LDX0    0,DU
         4 013031   204051 470500                    LDP0    F$,,AUTO
         4 013032   000002 740100                    STX0    2,,PR0

     2872    20240    3      GOTO ALIGNMENT_PART;

  20240  4 013033   013074 710000 4                  TRA     ALIGNMENT_PART
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:431  

     2873    20241    3      END;
     2874    20242                                                               /*
     2875    20243                                                               */
     2876    20244    2   F$ -> FS$FORMREC.SETUPDISP = DISP_TALLY;

  20244  4 013034   200013 220100                    LDX0    DISP_TALLY,,AUTO
         4 013035   204051 470500                    LDP0    F$,,AUTO
         4 013036   000002 740100                    STX0    2,,PR0

     2877    20245    2   SETUP_LENGTH = SETUP$ ->FS$SETUP.LINES;

  20245  4 013037   000006 470400 2                  LDP0    SETUP$
         4 013040   000100 101500                    MRL     fill='000'O
         4 013041   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         4 013042   204063 000004                    ADSC9   SETUP_LENGTH,,AUTO       cn=0,n=4

     2878    20246    2   SETUP_LENGTH = SETUP_LENGTH * 18;  /*  18 wds/line  */

  20246  4 013043   204063 236100                    LDQ     SETUP_LENGTH,,AUTO
         4 013044   000022 402007                    MPY     18,DL
         4 013045   204063 756100                    STQ     SETUP_LENGTH,,AUTO

     2879    20247    2   SETUP_LENGTH = SETUP_LENGTH +1;

  20247  4 013046   000001 036007                    ADLQ    1,DL
         4 013047   204063 756100                    STQ     SETUP_LENGTH,,AUTO

     2880    20248                                                                  /* */
     2881    20249                                                                  /* */
     2882    20250                                                                /*
     2883    20251              Let's move it
     2884    20252                                                                */
     2885    20253    2   FF$ = PINCRW(F$,DISP_TALLY);

  20253  4 013050   200013 236100                    LDQ     DISP_TALLY,,AUTO
         4 013051   777777 376003                    ANQ     -1,DU
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:432  
         4 013052   204051 036100                    ADLQ    F$,,AUTO
         4 013053   200011 756100                    STQ     FF$,,AUTO

     2886    20254    2   MOVE_CNT = SETUP_LENGTH*4;            /* Char count  */

  20254  4 013054   204063 235100                    LDA     SETUP_LENGTH,,AUTO
         4 013055   000002 735000                    ALS     2
         4 013056   200014 755100                    STA     MOVE_CNT,,AUTO

     2887    20255    2   FF$ -> TEMPLATE = SETUP$ -> TEMPLATE;

  20255  4 013057   000000 621005                    EAX1    0,AL
         4 013060   200011 471500                    LDP1    FF$,,AUTO
         4 013061   200014 722100                    LXL2    MOVE_CNT,,AUTO
         4 013062   040140 100540                    MLR     fill='040'O
         4 013063   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
         4 013064   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2

     2888    20256    2   SETUP$ = ADDR(NIL);

  20256  4 013065   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 013066   000006 756000 2                  STQ     SETUP$

     2889    20257    2   DISP_TALLY = DISP_TALLY + SETUP_LENGTH;

  20257  4 013067   200013 236100                    LDQ     DISP_TALLY,,AUTO
         4 013070   000022 772000                    QRL     18
         4 013071   204063 036100                    ADLQ    SETUP_LENGTH,,AUTO
         4 013072   000000 621006                    EAX1    0,QL
         4 013073   200013 741100                    STX1    DISP_TALLY,,AUTO

  20257  4 013074                       ALIGNMENT_P* null
     2890    20258    2   ALIGNMENT_PART: ;
     2891    20259    2   IF ALGN$ = ADDR(NIL)

  20259  4 013074   000005 236000 2                  LDQ     ALGN$
         4 013075   000001 116000 xsym               CMPQ    B_VECTNIL+1
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:433  
         4 013076   013103 601000 4                  TNZ     s:20264

     2892    20260    3   THEN DO;

     2893    20261    3      F$->FS$FORMREC.ALGNDISP = 0;

  20261  4 013077   000000 220003                    LDX0    0,DU
         4 013100   204051 470500                    LDP0    F$,,AUTO
         4 013101   000003 440100                    SXL0    3,,PR0

     2894    20262    3      GOTO CHECK_LENGTH_2;

  20262  4 013102   013565 710000 4                  TRA     CHECK_LENGTH_2

     2895    20263    3      END;   /*  Do  */
     2896    20264    2   F$->FS$FORMREC.ALGNDISP = DISP_TALLY;

  20264  4 013103   200013 220100                    LDX0    DISP_TALLY,,AUTO
         4 013104   204051 470500                    LDP0    F$,,AUTO
         4 013105   000003 440100                    SXL0    3,,PR0

     2897    20265    2   IF OLD_ALGN = '1'B

  20265  4 013106   000001 234000 2                  SZN     OLD_ALGN
         4 013107   013266 605000 4                  TPL     s:20305

     2898    20266    3   THEN DO;                  /* The algn is in tact from a

     2899    20267                                          previous record, I.E.,
     2900    20268                                          create = AS_FALSE      */
     2901    20269    3      OLD_ALGN='0'B;       /* Clear it               */

  20269  4 013110   000001 450000 2                  STZ     OLD_ALGN

     2902    20270    3      IF GRAPHIC

  20270  4 013111   200027 234100                    SZN     GRAPHIC,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:434  
         4 013112   013170 605000 4                  TPL     s:20284

     2903    20271    4      THEN DO;

     2904    20272    4         ENUM = ALGN$->FS$GBAN.NUM_ENTRIES;

  20272  4 013113   000005 470400 2                  LDP0    ALGN$
         4 013114   000100 101500                    MRL     fill='000'O
         4 013115   000000 600001                    ADSC9   0,,PR0                   cn=3,n=1
         4 013116   200004 000004                    ADSC9   ENUM,,AUTO               cn=0,n=4

     2905    20273    4         ALGN_LENGTH = ENUM * ENTRY_LEN + 1;

  20273  4 013117   204054 236100                    LDQ     ENTRY_LEN,,AUTO
         4 013120   000022 772000                    QRL     18
         4 013121   200004 402100                    MPY     ENUM,,AUTO
         4 013122   000001 036007                    ADLQ    1,DL
         4 013123   204062 756100                    STQ     ALGN_LENGTH,,AUTO

     2906    20274    5         DO I = 0 TO ENUM-1;       /* Find first disp   */

  20274  4 013124   204064 450100                    STZ     I,,AUTO
         4 013125   013164 710000 4                  TRA     s:20281+3

     2907    20275    5            IF ALGN$->FS$GBAN.ENTRIES.DISP(I) ~= 0

  20275  4 013126   204064 236100                    LDQ     I,,AUTO
         4 013127   000060 402007                    MPY     48,DL
         4 013130   000005 470400 2                  LDP0    ALGN$
         4 013131   000100 101506                    MRL     fill='000'O
         4 013132   000012 600002                    ADSC9   10,Q,PR0                 cn=3,n=2
         4 013133   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 013134   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 013135   000000 116003                    CMPQ    0,DU
         4 013136   013161 600000 4                  TZE     s:20281

     2908    20276    6            THEN DO;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:435  

     2909    20277    6               ALGN_LENGTH = (ALGN$->FS$GBAN.ENTRIES.COUNT(I) +3) / 4;

  20277  4 013137   204064 236100                    LDQ     I,,AUTO
         4 013140   000060 402007                    MPY     48,DL
         4 013141   000100 101506                    MRL     fill='000'O
         4 013142   000012 400001                    ADSC9   10,Q,PR0                 cn=2,n=1
         4 013143   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 013144   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 013145   000003 036007                    ADLQ    3,DL
         4 013146   000002 772000                    QRL     2
         4 013147   204062 756100                    STQ     ALGN_LENGTH,,AUTO

     2910    20278    6               ALGN_LENGTH = ALGN$->FS$GBAN.ENTRIES.DISP(I) + ALGN_LENGTH;

  20278  4 013150   204064 236100                    LDQ     I,,AUTO
         4 013151   000060 402007                    MPY     48,DL
         4 013152   000100 101506                    MRL     fill='000'O
         4 013153   000012 600002                    ADSC9   10,Q,PR0                 cn=3,n=2
         4 013154   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 013155   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 013156   204062 036100                    ADLQ    ALGN_LENGTH,,AUTO
         4 013157   204062 756100                    STQ     ALGN_LENGTH,,AUTO

     2911    20279    6               GOTO END_LOOP$A;

  20279  4 013160   013237 710000 4                  TRA     END_LOOP$A

     2912    20280    6               END;
     2913    20281    5            END; /* Do i */

  20281  4 013161   204064 235100                    LDA     I,,AUTO
         4 013162   000001 035007                    ADLA    1,DL
         4 013163   204064 755100                    STA     I,,AUTO
         4 013164   204064 236100                    LDQ     I,,AUTO
         4 013165   200004 116100                    CMPQ    ENUM,,AUTO
         4 013166   013126 602000 4                  TNC     s:20275
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:436  

     2914    20282    4         END;

  20282  4 013167   013237 710000 4                  TRA     END_LOOP$A

     2915    20283    4      ELSE DO;

     2916    20284    4         ENUM = ALGN$->FS$FINST.NUM_ENTRIES; /* Size of algn???  */

  20284  4 013170   000005 470400 2                  LDP0    ALGN$
         4 013171   000100 101500                    MRL     fill='000'O
         4 013172   000000 600001                    ADSC9   0,,PR0                   cn=3,n=1
         4 013173   200004 000004                    ADSC9   ENUM,,AUTO               cn=0,n=4

     2917    20285    4         ALGN_LENGTH = ENUM*4 + 1;

  20285  4 013174   200004 235100                    LDA     ENUM,,AUTO
         4 013175   000002 735000                    ALS     2
         4 013176   000001 035007                    ADLA    1,DL
         4 013177   204062 755100                    STA     ALGN_LENGTH,,AUTO

     2918    20286    5         DO I = 0 TO ENUM-1; /* Find first disp   */

  20286  4 013200   204064 450100                    STZ     I,,AUTO
         4 013201   013234 710000 4                  TRA     s:20293+3

     2919    20287    5            IF ALGN$->FS$FINST.ENTRIES.DISP(I) ~= 0

  20287  4 013202   204064 235100                    LDA     I,,AUTO
         4 013203   000004 735000                    ALS     4
         4 013204   000005 470400 2                  LDP0    ALGN$
         4 013205   000100 101505                    MRL     fill='000'O
         4 013206   000003 200002                    ADSC9   3,A,PR0                  cn=1,n=2
         4 013207   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 013210   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 013211   000000 116003                    CMPQ    0,DU
         4 013212   013231 600000 4                  TZE     s:20293
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:437  

     2920    20288    6            THEN DO;

     2921    20289    6               ALGN_LENGTH = (ALGN$->FS$FINST.ENTRIES.COUNT(I) +3) / 4;

  20289  4 013213   000100 101505                    MRL     fill='000'O
         4 013214   000003 600001                    ADSC9   3,A,PR0                  cn=3,n=1
         4 013215   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 013216   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 013217   000003 036007                    ADLQ    3,DL
         4 013220   000002 772000                    QRL     2
         4 013221   204062 756100                    STQ     ALGN_LENGTH,,AUTO

     2922    20290    6               ALGN_LENGTH = ALGN$->FS$FINST.ENTRIES.DISP(I) + ALGN_LENGTH;

  20290  4 013222   000100 101505                    MRL     fill='000'O
         4 013223   000003 200002                    ADSC9   3,A,PR0                  cn=1,n=2
         4 013224   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 013225   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 013226   204062 036100                    ADLQ    ALGN_LENGTH,,AUTO
         4 013227   204062 756100                    STQ     ALGN_LENGTH,,AUTO

     2923    20291    6               GOTO END_LOOP$A;

  20291  4 013230   013237 710000 4                  TRA     END_LOOP$A

     2924    20292    6               END;
     2925    20293    5            END; /* Do i */

  20293  4 013231   204064 235100                    LDA     I,,AUTO
         4 013232   000001 035007                    ADLA    1,DL
         4 013233   204064 755100                    STA     I,,AUTO
         4 013234   204064 236100                    LDQ     I,,AUTO
         4 013235   200004 116100                    CMPQ    ENUM,,AUTO
         4 013236   013202 602000 4                  TNC     s:20287

     2926    20294    4         END;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:438  

  20290  4 013237                       END_LOOP$A   null
     2927    20295    3   END_LOOP$A:;
     2928    20296                                                                    /* */
     2929    20297    3      FF$ = PINCRW(F$,DISP_TALLY);

  20297  4 013237   200013 236100                    LDQ     DISP_TALLY,,AUTO
         4 013240   777777 376003                    ANQ     -1,DU
         4 013241   204051 036100                    ADLQ    F$,,AUTO
         4 013242   200011 756100                    STQ     FF$,,AUTO

     2930    20298    3      MOVE_CNT = ALGN_LENGTH*4;

  20298  4 013243   204062 235100                    LDA     ALGN_LENGTH,,AUTO
         4 013244   000002 735000                    ALS     2
         4 013245   200014 755100                    STA     MOVE_CNT,,AUTO

     2931    20299    3      FF$->TEMPLATE = ALGN$->TEMPLATE;

  20299  4 013246   000000 620005                    EAX0    0,AL
         4 013247   200011 471500                    LDP1    FF$,,AUTO
         4 013250   200014 721100                    LXL1    MOVE_CNT,,AUTO
         4 013251   040140 100540                    MLR     fill='040'O
         4 013252   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         4 013253   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

     2932    20300    3      ALGN$ = ADDR(NIL);

  20300  4 013254   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 013255   000005 756000 2                  STQ     ALGN$

     2933    20301    3      DISP_TALLY = DISP_TALLY + ALGN_LENGTH;

  20301  4 013256   200013 236100                    LDQ     DISP_TALLY,,AUTO
         4 013257   000022 772000                    QRL     18
         4 013260   204062 036100                    ADLQ    ALGN_LENGTH,,AUTO
         4 013261   000000 620006                    EAX0    0,QL
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:439  
         4 013262   200013 740100                    STX0    DISP_TALLY,,AUTO

     2934    20302    3      ALGN$ = ADDR(NIL);

  20302  4 013263   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 013264   000005 756000 2                  STQ     ALGN$

     2935    20303    3      GOTO CHECK_LENGTH_2;

  20303  4 013265   013565 710000 4                  TRA     CHECK_LENGTH_2

     2936    20304    3      END;    /* Do if using old algn   */
     2937    20305    2   ENUM = ALGN$->FS$FINST.NUM_ENTRIES;

  20305  4 013266   000005 470400 2                  LDP0    ALGN$
         4 013267   000100 101500                    MRL     fill='000'O
         4 013270   000000 600001                    ADSC9   0,,PR0                   cn=3,n=1
         4 013271   200004 000004                    ADSC9   ENUM,,AUTO               cn=0,n=4

     2938    20306    2   IF GRAPHIC

  20306  4 013272   200027 234100                    SZN     GRAPHIC,,AUTO
         4 013273   013316 605000 4                  TPL     s:20314

     2939    20307    3   THEN DO;

     2940    20308    4      DO I = 0 TO ENUM-1;

  20308  4 013274   204064 450100                    STZ     I,,AUTO
         4 013275   013312 710000 4                  TRA     s:20311+3

     2941    20309    4         ALGN$->FS$GBAN.ENTRIES.MARK(I) = 0;

  20309  4 013276   204064 236100                    LDQ     I,,AUTO
         4 013277   000060 402007                    MPY     48,DL
         4 013300   000005 470400 2                  LDP0    ALGN$
         4 013301   000106 101400                    MRL     fill='000'O
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:440  
         4 013302   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 013303   000014 600001                    ADSC9   12,Q,PR0                 cn=3,n=1

     2942    20310    4         ALGN$->FS$GBAN.ENTRIES.TOTLEN(I) = 0;

  20310  4 013304   000106 101400                    MRL     fill='000'O
         4 013305   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 013306   000013 200003                    ADSC9   11,Q,PR0                 cn=1,n=3

     2943    20311    4         END; /* End i  */

  20311  4 013307   204064 235100                    LDA     I,,AUTO
         4 013310   000001 035007                    ADLA    1,DL
         4 013311   204064 755100                    STA     I,,AUTO
         4 013312   204064 236100                    LDQ     I,,AUTO
         4 013313   200004 116100                    CMPQ    ENUM,,AUTO
         4 013314   013276 602000 4                  TNC     s:20309

     2944    20312    3      END;

  20312  4 013315   013337 710000 4                  TRA     s:20324

     2945    20313    3   ELSE DO;

     2946    20314    4      DO I = 0 TO ENUM-1;

  20314  4 013316   204064 450100                    STZ     I,,AUTO
         4 013317   013334 710000 4                  TRA     s:20317+3

     2947    20315    4         ALGN$->FS$FINST.ENTRIES.MARK(I) = 0;

  20315  4 013320   204064 235100                    LDA     I,,AUTO
         4 013321   000004 735000                    ALS     4
         4 013322   000005 470400 2                  LDP0    ALGN$
         4 013323   000105 101400                    MRL     fill='000'O
         4 013324   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 013325   000004 600001                    ADSC9   4,A,PR0                  cn=3,n=1
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:441  

     2948    20316    4         ALGN$->FS$FINST.ENTRIES.TOTLEN(I) = 0;

  20316  4 013326   000105 101400                    MRL     fill='000'O
         4 013327   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         4 013330   000004 000003                    ADSC9   4,A,PR0                  cn=0,n=3

     2949    20317    4         END; /* End i  */

  20317  4 013331   204064 236100                    LDQ     I,,AUTO
         4 013332   000001 036007                    ADLQ    1,DL
         4 013333   204064 756100                    STQ     I,,AUTO
         4 013334   204064 236100                    LDQ     I,,AUTO
         4 013335   200004 116100                    CMPQ    ENUM,,AUTO
         4 013336   013320 602000 4                  TNC     s:20315

     2950    20318    3      END;

     2951    20319                                                                  /*
     2952    20320              The length of the alignment protion must be done in
     2953    20321              two parts -
     2954    20322                  first the forms instruction protion
     2955    20323                                                                  */
     2956    20324    2   IF GRAPHIC

  20324  4 013337   200027 234100                    SZN     GRAPHIC,,AUTO
         4 013340   013353 605000 4                  TPL     s:20331

     2957    20325    3   THEN DO;

     2958    20326    3      ALGN_LENGTH = ALGN$ ->FS$GBAN.NUM_ENTRIES;

  20326  4 013341   000100 101500                    MRL     fill='000'O
         4 013342   000000 600001                    ADSC9   0,,PR0                   cn=3,n=1
         4 013343   204062 000004                    ADSC9   ALGN_LENGTH,,AUTO        cn=0,n=4

     2959    20327    3      ALGN_LENGTH = ALGN_LENGTH * ENTRY_LEN;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:442  

  20327  4 013344   204054 236100                    LDQ     ENTRY_LEN,,AUTO
         4 013345   000022 772000                    QRL     18
         4 013346   204062 402100                    MPY     ALGN_LENGTH,,AUTO
         4 013347   204062 756100                    STQ     ALGN_LENGTH,,AUTO

     2960    20328    3      ALGN_LENGTH = ALGN_LENGTH + 1;

  20328  4 013350   000001 036007                    ADLQ    1,DL
         4 013351   204062 756100                    STQ     ALGN_LENGTH,,AUTO

     2961    20329    3      END;

  20329  4 013352   013363 710000 4                  TRA     s:20339

     2962    20330    3   ELSE DO;

     2963    20331    3      ALGN_LENGTH = ALGN$ ->FS$FINST.NUM_ENTRIES;

  20331  4 013353   000100 101500                    MRL     fill='000'O
         4 013354   000000 600001                    ADSC9   0,,PR0                   cn=3,n=1
         4 013355   204062 000004                    ADSC9   ALGN_LENGTH,,AUTO        cn=0,n=4

     2964    20332    3      ALGN_LENGTH = ALGN_LENGTH * 4;

  20332  4 013356   204062 235100                    LDA     ALGN_LENGTH,,AUTO
         4 013357   000002 735000                    ALS     2
         4 013360   204062 755100                    STA     ALGN_LENGTH,,AUTO

     2965    20333    3      ALGN_LENGTH = ALGN_LENGTH + 1;

  20333  4 013361   000001 035007                    ADLA    1,DL
         4 013362   204062 755100                    STA     ALGN_LENGTH,,AUTO

     2966    20334    3      END;

     2967    20335                                                                 /*
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:443  
     2968    20336              Change the disp field in each entry before bringing
     2969    20337              up the text
     2970    20338                                                                 */
     2971    20339    3   IF FCA$ ~= ADDR(NIL) THEN DO ;

  20339  4 013363   200010 236100                    LDQ     FCA$,,AUTO
         4 013364   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 013365   013473 600000 4                  TZE     s:20358

     2972    20340    3      FF$ = PINCRW(ALGN$,ALGN_LENGTH);

  20340  4 013366   204062 236100                    LDQ     ALGN_LENGTH,,AUTO
         4 013367   000022 736000                    QLS     18
         4 013370   000005 036000 2                  ADLQ    ALGN$
         4 013371   200011 756100                    STQ     FF$,,AUTO

     2973    20341    3      NEW_BNRDISP = POFFW(FCA$,FF$);

  20341  4 013372   200011 235100                    LDA     FF$,,AUTO
         4 013373   000022 771000                    ARL     18
         4 013374   204110 755100                    STA     @MAX_VAL+1,,AUTO
         4 013375   200010 236100                    LDQ     FCA$,,AUTO
         4 013376   000022 772000                    QRL     18
         4 013377   204110 136100                    SBLQ    @MAX_VAL+1,,AUTO
         4 013400   000000 620006                    EAX0    0,QL
         4 013401   204055 740100                    STX0    NEW_BNRDISP,,AUTO

     2974    20342    4      DO I = 0 TO ENUM - 1;

  20342  4 013402   204064 450100                    STZ     I,,AUTO
         4 013403   013470 710000 4                  TRA     s:20356+3

     2975    20343    4         IF GRAPHIC

  20343  4 013404   200027 234100                    SZN     GRAPHIC,,AUTO
         4 013405   013440 605000 4                  TPL     s:20351

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:444  
     2976    20344    5         THEN DO;

     2977    20345    5            IF ALGN$ ->FS$GBAN.ENTRIES.DISP(I) ~= 0

  20345  4 013406   204064 236100                    LDQ     I,,AUTO
         4 013407   000060 402007                    MPY     48,DL
         4 013410   000005 470400 2                  LDP0    ALGN$
         4 013411   000100 101506                    MRL     fill='000'O
         4 013412   000012 600002                    ADSC9   10,Q,PR0                 cn=3,n=2
         4 013413   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 013414   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 013415   000000 116003                    CMPQ    0,DU
         4 013416   013465 600000 4                  TZE     s:20356

     2978    20346    6            THEN DO;

     2979    20347    6               ALGN$ ->FS$GBAN.ENTRIES.DISP(I) = ALGN$ ->FS$GBAN.ENTRIES.DISP(I) -
             20347                        NEW_BNRDISP;

  20347  4 013417   204055 235100                    LDA     NEW_BNRDISP,,AUTO
         4 013420   000022 771000                    ARL     18
         4 013421   204110 755100                    STA     @MAX_VAL+1,,AUTO
         4 013422   204064 236100                    LDQ     I,,AUTO
         4 013423   000060 402007                    MPY     48,DL
         4 013424   000100 101506                    MRL     fill='000'O
         4 013425   000012 600002                    ADSC9   10,Q,PR0                 cn=3,n=2
         4 013426   204111 000004                    ADSC9   @MAX_VAL+2,,AUTO         cn=0,n=4
         4 013427   204111 236100                    LDQ     @MAX_VAL+2,,AUTO
         4 013430   204110 136100                    SBLQ    @MAX_VAL+1,,AUTO
         4 013431   204112 756100                    STQ     @MAX_VAL+3,,AUTO
         4 013432   204064 236100                    LDQ     I,,AUTO
         4 013433   000060 402007                    MPY     48,DL
         4 013434   000106 101500                    MRL     fill='000'O
         4 013435   204112 000004                    ADSC9   @MAX_VAL+3,,AUTO         cn=0,n=4
         4 013436   000012 600002                    ADSC9   10,Q,PR0                 cn=3,n=2

     2980    20348    6               END;
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:445  

     2981    20349    5            END;

  20349  4 013437   013465 710000 4                  TRA     s:20356

     2982    20350    5         ELSE DO;

     2983    20351    5            IF ALGN$ -> FS$FINST.ENTRIES.DISP(I) ~= 0

  20351  4 013440   204064 235100                    LDA     I,,AUTO
         4 013441   000004 735000                    ALS     4
         4 013442   000005 470400 2                  LDP0    ALGN$
         4 013443   000100 101505                    MRL     fill='000'O
         4 013444   000003 200002                    ADSC9   3,A,PR0                  cn=1,n=2
         4 013445   204110 000004                    ADSC9   @MAX_VAL+1,,AUTO         cn=0,n=4
         4 013446   204110 236100                    LDQ     @MAX_VAL+1,,AUTO
         4 013447   000000 116003                    CMPQ    0,DU
         4 013450   013465 600000 4                  TZE     s:20356

     2984    20352    6            THEN DO;

     2985    20353    6               ALGN$ -> FS$FINST.ENTRIES.DISP(I) = ALGN$ ->FS$FINST.ENTRIES.DISP(I) -
             20353                        NEW_BNRDISP;

  20353  4 013451   204055 236100                    LDQ     NEW_BNRDISP,,AUTO
         4 013452   000022 772000                    QRL     18
         4 013453   204110 756100                    STQ     @MAX_VAL+1,,AUTO
         4 013454   000100 101505                    MRL     fill='000'O
         4 013455   000003 200002                    ADSC9   3,A,PR0                  cn=1,n=2
         4 013456   204111 000004                    ADSC9   @MAX_VAL+2,,AUTO         cn=0,n=4
         4 013457   204111 236100                    LDQ     @MAX_VAL+2,,AUTO
         4 013460   204110 136100                    SBLQ    @MAX_VAL+1,,AUTO
         4 013461   204112 756100                    STQ     @MAX_VAL+3,,AUTO
         4 013462   000105 101500                    MRL     fill='000'O
         4 013463   204112 000004                    ADSC9   @MAX_VAL+3,,AUTO         cn=0,n=4
         4 013464   000003 200002                    ADSC9   3,A,PR0                  cn=1,n=2

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:446  
     2986    20354    6               END;

     2987    20355    5            END;

     2988    20356    4         END; /* I */

  20356  4 013465   204064 235100                    LDA     I,,AUTO
         4 013466   000001 035007                    ADLA    1,DL
         4 013467   204064 755100                    STA     I,,AUTO
         4 013470   204064 236100                    LDQ     I,,AUTO
         4 013471   200004 116100                    CMPQ    ENUM,,AUTO
         4 013472   013404 602000 4                  TNC     s:20343

     2989    20357    3      END;    /* End do if  */

     2990    20358    2   FF$ = PINCRW(F$,DISP_TALLY);

  20358  4 013473   200013 236100                    LDQ     DISP_TALLY,,AUTO
         4 013474   777777 376003                    ANQ     -1,DU
         4 013475   204051 036100                    ADLQ    F$,,AUTO
         4 013476   200011 756100                    STQ     FF$,,AUTO

     2991    20359    2   MOVE_CNT = ALGN_LENGTH*4;       /* Char count  */

  20359  4 013477   204062 235100                    LDA     ALGN_LENGTH,,AUTO
         4 013500   000002 735000                    ALS     2
         4 013501   200014 755100                    STA     MOVE_CNT,,AUTO

     2992    20360    2   FF$->TEMPLATE = ALGN$->TEMPLATE;      /* Move 'EM  */

  20360  4 013502   000000 620005                    EAX0    0,AL
         4 013503   200011 471500                    LDP1    FF$,,AUTO
         4 013504   200014 721100                    LXL1    MOVE_CNT,,AUTO
         4 013505   040140 100540                    MLR     fill='040'O
         4 013506   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         4 013507   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:447  
     2993    20361    2   DISP_TALLY = DISP_TALLY + ALGN_LENGTH;

  20361  4 013510   200013 236100                    LDQ     DISP_TALLY,,AUTO
         4 013511   000022 772000                    QRL     18
         4 013512   204062 036100                    ADLQ    ALGN_LENGTH,,AUTO
         4 013513   000000 620006                    EAX0    0,QL
         4 013514   200013 740100                    STX0    DISP_TALLY,,AUTO

     2994    20362    2   IF FCA$ = ADDR(NIL)

  20362  4 013515   200010 236100                    LDQ     FCA$,,AUTO
         4 013516   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 013517   013523 601000 4                  TNZ     s:20372

     2995    20363    3   THEN DO;

     2996    20364    3      ALGN$=ADDR(NIL);

  20364  4 013520   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 013521   000005 756000 2                  STQ     ALGN$

     2997    20365    3      GOTO CHECK_LENGTH_2;

  20365  4 013522   013565 710000 4                  TRA     CHECK_LENGTH_2

     2998    20366    3      END;     /* End do */
     2999    20367                                                     /*
     3000    20368
     3001    20369              Now move the text
     3002    20370
     3003    20371                                                          */
     3004    20372    2   TEXT_LENGTH = POFFW(FCA$,ALGN$);

  20372  4 013523   000005 235000 2                  LDA     ALGN$
         4 013524   000022 771000                    ARL     18
         4 013525   204110 755100                    STA     @MAX_VAL+1,,AUTO
         4 013526   200010 236100                    LDQ     FCA$,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:448  
         4 013527   000022 772000                    QRL     18
         4 013530   204110 136100                    SBLQ    @MAX_VAL+1,,AUTO
         4 013531   204056 756100                    STQ     TEXT_LENGTH,,AUTO

     3005    20373    2   TEXT_LENGTH = (TEXT_OFFSET - ALGN_OFFSET) - TEXT_LENGTH;

  20373  4 013532   000005 236000 3                  LDQ     TEXT_OFFSET
         4 013533   000004 136000 3                  SBLQ    ALGN_OFFSET
         4 013534   204056 136100                    SBLQ    TEXT_LENGTH,,AUTO
         4 013535   204056 756100                    STQ     TEXT_LENGTH,,AUTO

     3006    20374    2   ALGN$ = ADDR(NIL);

  20374  4 013536   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 013537   000005 756000 2                  STQ     ALGN$

     3007    20375                                                            /*
     3008    20376                                                            */
     3009    20377    2   FF$ = PINCRW(F$,DISP_TALLY);

  20377  4 013540   200013 236100                    LDQ     DISP_TALLY,,AUTO
         4 013541   777777 376003                    ANQ     -1,DU
         4 013542   204051 036100                    ADLQ    F$,,AUTO
         4 013543   200011 756100                    STQ     FF$,,AUTO

     3010    20378    2   MOVE_CNT = TEXT_LENGTH*4;

  20378  4 013544   204056 235100                    LDA     TEXT_LENGTH,,AUTO
         4 013545   000002 735000                    ALS     2
         4 013546   200014 755100                    STA     MOVE_CNT,,AUTO

     3011    20379    2   FF$ -> TEMPLATE = FCA$ -> TEMPLATE;

  20379  4 013547   200010 470500                    LDP0    FCA$,,AUTO
         4 013550   000000 621005                    EAX1    0,AL
         4 013551   200011 471500                    LDP1    FF$,,AUTO
         4 013552   200014 722100                    LXL2    MOVE_CNT,,AUTO
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:449  
         4 013553   040140 100540                    MLR     fill='040'O
         4 013554   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
         4 013555   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2

     3012    20380    2   DISP_TALLY = DISP_TALLY + TEXT_LENGTH;

  20380  4 013556   200013 236100                    LDQ     DISP_TALLY,,AUTO
         4 013557   000022 772000                    QRL     18
         4 013560   204056 036100                    ADLQ    TEXT_LENGTH,,AUTO
         4 013561   000000 621006                    EAX1    0,QL
         4 013562   200013 741100                    STX1    DISP_TALLY,,AUTO

     3013    20381    2   FCA$ = ADDR(NIL) ;

  20381  4 013563   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 013564   200010 756100                    STQ     FCA$,,AUTO

  20381  4 013565                       CHECK_LENGT* null
     3014    20382    2   CHECK_LENGTH_2: ;
     3015    20383    2   IF DISP_TALLY < 1025 THEN RETURN;

  20383  4 013565   200013 220100                    LDX0    DISP_TALLY,,AUTO
         4 013566   002001 100003                    CMPX0   1025,DU
         4 013567   013572 603000 4                  TRC     s:20400

  20383  4 013570   204052 221300                    LDX1  ! F$+1,,AUTO
         4 013571   000001 702211                    TSX2  ! 1,X1

     3016    20384        /*E* ERROR: ASF-E$FORMRECERR-0
     3017    20385              MESSAGE: :FORM record too long
     3018    20386              MESSAGE1: FIXED + ACCESS + ACCOUNT + BANNER + ALIGNMENT + SETUP > 1024 WORDS
     3019    20387        */
     3020    20388        %SCREAM( ERR#=E$FORMRECERR,MID='F',LEVEL=ERROR);

  20400  4 013572   000152 630400 5                  EPPR0   106
         4 013573   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 013574   000000 701000 xent               TSX1    ASH$ERROR
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:450  
         4 013575   000000 011000                    NOP     0

     3021    20403    2   ALTRETURN;

  20403  4 013576   204052 221300                    LDX1  ! F$+1,,AUTO
         4 013577   000000 702211                    TSX2  ! 0,X1
     3022    20404    2   END FORM_GATHER;
     3023    20405    1   END ASF$FORM;

PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:451  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XG_SUBS_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   FS_SUPER_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASF$FORM.
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:452  

 **** Variables and constants ****

  ****  Section 002  Data  ASF$FORM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     2-0-0/w PTR         r     1 ACCNT$                     3-0-0/w PTR         r     1 ACCSS$
     5-0-0/w PTR         r     1 ALGN$                      4-0-0/w PTR         r     1 BNNR$
    11-0-0/w UBIN(18)    r     1 FENTRYLEN                  7-0-0/w UBIN(18)    r     1 FIXED_LENGTH
    12-0-0/w UBIN(18)    r     1 GENTRYLEN                 10-0-0/w UBIN(18)    r     1 GFIXED_LENGTH
     1-0-0/b BIT         r     1 OLD_ALGN                   0-0-0/b BIT         r     1 OLD_BANNER
     6-0-0/w PTR         r     1 SETUP$

  ****  Section 003 RoData ASF$FORM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 ACCNT_OFFSET               1-0-0/w UBIN        r     1 ACCSS_OFFSET
     4-0-0/w UBIN        r     1 ALGN_OFFSET                2-0-0/w UBIN        r     1 BNNR_OFFSET
     3-0-0/w UBIN        r     1 SETUP_OFFSET               5-0-0/w UBIN        r     1 TEXT_OFFSET

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  4073-0-0/w PTR         r     1 @A                      4073-0-0/w PTR         r     1 @A
  4107-0-0/w PTR         r     1 @MAX_VAL                   3-0-0/w PTR         r     1 @PSEUDO_FLAG
    *0-0-0/w UBIN        r     1 A                         *0-0-0/w UBIN        r     1 A
  4060-0-0/b UBIN        r     1 ACCNT_LENGTH            4057-0-0/b UBIN        r     1 ACCSS_LENGTH
  4062-0-0/w UBIN        r     1 ALGN_LENGTH               20-0-0/w UBIN        r     1 ARS
  4050-0-0/w PTR         r     1 BLK$                    4061-0-0/w UBIN        r     1 BNNR_LENGTH
  4076-0-0/w UBIN        r     1 CHAN                    4074-0-0/w SBIN        r     1 CHAN
    12-0-0/w PTR         r     1 CHARSET$                  41-0-0/c STRC(153)   r     1 CHARSET_KEY
  4066-0-0/b BIT         r     1 CHECK_VFU_FLG           4100-0-0/w UBIN        r     1 CODE
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:453  
  4077-0-0/w UBIN        r     1 CODE                    4077-0-0/w UBIN        r     1 CODE
  4100-0-0/w UBIN        r     1 CODE2                   4100-0-0/w UBIN        r     1 CODE2
    15-0-0/b BIT         r     1 CREATE                  4060-0-0/w UBIN        r     1 DEV_LIM_NUM
    13-0-0/w UBIN(18)    r     1 DISP_TALLY                24-0-0/b BIT         r     1 ELSOK
  4054-0-0/w UBIN(18)    r     1 ENTRY_LEN                  4-0-0/w UBIN        r     1 ENUM
  4051-0-0/w PTR         r     1 F$                      4076-0-0/w PTR         r     1 FB$
  4076-0-0/w PTR         r     1 FB$                        6-0-0/w PTR         r     1 FC$
    10-0-0/w PTR         r     1 FCA$                       7-0-0/w PTR         r     1 FCB$
  4104-0-0/w UBIN        r     1 FC_B_LEN                4104-0-0/w UBIN        r     1 FC_B_LEN
  4103-0-0/w UBIN        r     1 FC_LEN                  4103-0-0/w UBIN        r     1 FC_LEN
    11-0-0/w PTR         r     1 FF$                     4055-0-0/c CHAR(6)     r     1 FORM
    47-0-0/w UBIN        r     1 FORM_BUF(0:2047)          31-0-0/w STRC(63)    r     1 FORM_KEY
    33-0-0/w STRC(63)    r     1 FORM_KEY_OLD            4071-0-0/b BIT         r     1 FOUND
    16-0-0/b BIT         r     1 FROM                      27-0-0/b BIT         r     1 GRAPHIC
     5-0-0/w UBIN        r     1 I                       4053-0-0/w UBIN        r     1 I
  4075-0-0/w UBIN        r     1 I                       4073-0-0/w UBIN        r     1 I
  4053-0-0/w UBIN        r     1 I                       4073-0-0/w UBIN        r     1 I
  4053-0-0/w SBIN        r     1 I                       4064-0-0/w UBIN        r     1 I
  4054-0-0/w UBIN        r     1 J                       4105-0-0/w SBIN        r     1 J
  4077-0-0/w SBIN        r     1 J                       4054-0-0/w UBIN        r     1 J
  4054-0-0/w SBIN        r     1 J                       4055-0-0/w UBIN        r     1 K
  4055-0-0/w UBIN        r     1 K                       4056-0-0/w UBIN        r     1 L
  4056-0-0/w UBIN        r     1 L                         25-0-0/b BIT         r     1 LPOK
  4057-0-0/w UBIN        r     1 M                       4057-0-0/w UBIN        r     1 M
    *0-0-0/w UBIN        r     1 MAX_VAL                 4073-0-0/b BIT         r     1 MORE
  4074-0-0/b BIT         r     1 MORE                    4074-0-0/b BIT         r     1 MORE
    14-0-0/w UBIN        r     1 MOVE_CNT                4055-0-0/w UBIN(18)    r     1 NEW_BNRDISP
    23-0-0/w UBIN        r     1 NEW_TOTAL_LINES         4102-0-0/w UBIN        r     1 NEXT
  4075-0-0/w SBIN        r     1 NEXT                    4074-0-0/w UBIN        r     1 NUM
    22-0-0/w UBIN        r     1 OLD_TOTAL_LINES         4063-0-0/w UBIN        r     1 OP_CODE
  4064-0-0/w UBIN        r     1 OP_CODE                   *0-0-0/w BIT         r     1 PSEUDO_FLAG
    17-0-0/b BIT         r     1 PSEUDO_FLG                46-0-0/b BIT         r     1 PSEUDO_FORMS
    35-0-0/c STRC(117)   r     1 PSEUDO_FORM_KEY           30-0-0/w STRC        r     1 PSEUDO_FORM_REC
  4060-0-0/w PTR         r     1 PTR$                    4077-0-0/w PTR         r     1 PTR$
  4075-0-0/w PTR         r     1 PTR$                    4061-0-0/w PTR         r     1 PTR$
  4075-0-0/w PTR         r     1 PTR$                    4061-0-0/w PTR         r     1 PTR2$
  4062-0-0/w PTR         r     1 PTR2$                   4070-0-0/b BIT         r     1 REMOVED
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:454  
  4063-0-0/w UBIN        r     1 SETUP_LENGTH            4066-0-0/b STRC(18)    r     1 SPLIT
  4065-0-0/w STRC        r     1 SPLIT_VAL               4062-0-0/w UBIN        r     1 SUBNODES
  4101-0-0/w UBIN        r     1 SUBNODES                4063-0-0/w UBIN        r     1 SUBNODES
  4101-0-0/w UBIN        r     1 SUBNODES                4102-0-0/w UBIN        r     1 SUBNS
  4102-0-0/w UBIN        r     1 SUBNS                     21-0-0/w UBIN        r     1 SUBS
  4056-0-0/w UBIN        r     1 TEXT_LENGTH             4067-0-0/b BIT         r     1 TRANSLGL_SET
  4070-0-0/b BIT         r     1 TRANSLGL_VAL              26-0-0/b BIT         r     1 TSOK
  4066-0-0/b UBIN(18)    r     1 UBINSPLIT               4053-0-0/w UBIN(18)    r     1 USE_LENGTH
  4064-0-0/w UBIN        r     1 VAL                     4073-0-0/w SBIN        r     1 VAL
  4065-0-0/w UBIN        r     1 VAL

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/b BIT         r     1 AS_FALSE
     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w STRC(369)   r     1 AS_FIELD2
     0-0-0/w STRC(369)   r     1 AS_FIELD3                  0-0-0/b BIT         r     1 AS_TRUE
     0-0-0/w UBIN        r     1 CODE                       0-0-0/w PTR         r     1 DSEG1$
     0-0-0/w PTR         r     1 DSEG2$                     0-0-0/w PTR         r     1 DSEG3$
     0-0-0/b BIT         r     1 DSEG_FLG                   0-0-0/b STRC        r     1 ERR_CODE
     0-0-0/w UBIN        r     1 FB_TYPE_LIST               0-0-0/w UBIN        r     1 FORM_CMD
     0-0-0/w UBIN        r     1 FORM_OPTS_LIST             0-0-0/w UBIN        r     1 F_A_OR_B_LIST
     0-0-0/w UBIN        r     1 F_VFU_LIST                 0-0-0/w UBIN        r     1 GFORM_OPTS_LIST
     0-0-0/w UBIN        r     1 GPSEUDO_OPTS_LIST          0-0-0/c CHAR(255)   r     1 IN_BUF
     0-0-0/b STRC        r     1 MERR_CODE                  0-0-0/w PTR         r     1 NODE$
     0-0-0/w UBIN        r     1 PSEUDO_CMD                 0-0-0/w UBIN        r     1 PSEUDO_OPTS_LIST
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/d REMB        r     1 REMEM_VAR
     0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2232)  r     1 CHARSET                    0-0-0/c ACHR        r     1 FC_CHAR
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:455  
     0-0-0/c ACHR        r     1 FC_CHAR                    0-0-0/c STRC(108)   r     1 FS$ACCESS
     0-0-0/c STRC(108)   r     1 FS$ACCOUNTS                0-0-0/c STRC(180)   r     1 FS$FINST
     0-0-0/w STRC(3186)  r     1 FS$FORMREC                 0-0-0/c STRC(468)   r     1 FS$GBAN
     0-0-0/w STRC(756)   r     1 FS$GFORMREC                0-0-0/c STRC(684)   r     1 FS$SETUP
     0-0-0/b BIT         r     1 ONEBIT                     0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/w STRC(144)   r     1 P$NODE                     0-0-0/c ACHR        r     1 TEMPLATE


   Procedure ASF$FORM requires 6016 words for executable code.
   Procedure ASF$FORM requires 2124 words of local(AUTO) storage.

    No errors detected in file ASF$FORM.:E05TSI    .
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:456  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:457  
          MINI XREF LISTING

A IN PROCEDURE BANNER
     19321**DCL     18101--PROC    18195>>IF      18239>>IF      18249>>IF      18278>>IF      18338>>IF
     18383>>IF      18471>>IF      18626>>IF      18639>>IF      19245--PROC    19340>>IF      19383>>IF
     19393>>IF      19446>>IF      19491>>IF      19634>>IF      19790>>IF      19803>>IF
ACCNT$
     16346**DCL     16748<<ASSIGN  16751>>ASSIGN  17400>>IF      17401<<ASSIGN  17402>>ASSIGN  17408>>ASSIGN
     17438>>ASSIGN  17439>>ASSIGN  17439>>ASSIGN  17443>>DOWHILE 17444>>IF      17471>>ASSIGN  17472>>ASSIGN
     17476>>DOINDEX 17477>>ASSIGN  17477>>ASSIGN  17479>>ASSIGN  17479>>ASSIGN  18982>>IF      18984<<ASSIGN
     18985>>ASSIGN  18990>>ASSIGN  19026>>ASSIGN  19027>>ASSIGN  19027>>ASSIGN  19033>>DOWHILE 19034>>IF
     19039>>DOINDEX 19040>>ASSIGN  19040>>ASSIGN  19043>>ASSIGN  19043>>ASSIGN  19076>>ASSIGN  19077>>ASSIGN
     20064>>IF      20064>>IF      20072>>ASSIGN  20080>>ASSIGN  20081<<ASSIGN
ACCNT_LENGTH IN PROCEDURE FORM_GATHER
     20010**DCL     20072<<ASSIGN  20079>>ASSIGN  20082>>ASSIGN
ACCNT_OFFSET
     16337**DCL     16748>>ASSIGN  17401>>ASSIGN  18984>>ASSIGN
ACCOUNT_PART IN PROCEDURE FORM_GATHER
     20060**LABEL   20046--GOTO
ACCSS$
     16347**DCL     16778<<ASSIGN  16781>>ASSIGN  17282>>IF      17283<<ASSIGN  17284>>ASSIGN  17287>>ASSIGN
     17317>>ASSIGN  17318>>ASSIGN  17318>>ASSIGN  17322>>DOWHILE 17323>>IF      17350>>ASSIGN  17351>>ASSIGN
     17355>>DOINDEX 17356>>ASSIGN  17356>>ASSIGN  17358>>ASSIGN  17358>>ASSIGN  18854>>IF      18856<<ASSIGN
     18857>>ASSIGN  18861>>ASSIGN  18892>>ASSIGN  18893>>ASSIGN  18893>>ASSIGN  18899>>DOWHILE 18900>>IF
     18905>>DOINDEX 18906>>ASSIGN  18906>>ASSIGN  18909>>ASSIGN  18909>>ASSIGN  18942>>ASSIGN  18943>>ASSIGN
     20042>>IF      20042>>IF      20050>>ASSIGN  20058>>ASSIGN  20059<<ASSIGN
ACCSS_LENGTH IN PROCEDURE FORM_GATHER
     20009**DCL     20050<<ASSIGN  20057>>ASSIGN  20060>>ASSIGN
ACCSS_OFFSET
     16338**DCL     16778>>ASSIGN  17283>>ASSIGN  18856>>ASSIGN
ALGN$
     16349**DCL     16770<<ASSIGN  16773>>ASSIGN  17378<<ASSIGN  18209<<ASSIGN  18961<<ASSIGN  19353<<ASSIGN
     20259>>IF      20272>>ASSIGN  20275>>IF      20277>>ASSIGN  20278>>ASSIGN  20284>>ASSIGN  20287>>IF
     20289>>ASSIGN  20290>>ASSIGN  20299>>ASSIGN  20300<<ASSIGN  20302<<ASSIGN  20305>>ASSIGN  20309>>ASSIGN
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:458  
     20310>>ASSIGN  20315>>ASSIGN  20316>>ASSIGN  20326>>ASSIGN  20331>>ASSIGN  20340>>ASSIGN  20345>>IF
     20347>>ASSIGN  20347>>ASSIGN  20351>>IF      20353>>ASSIGN  20353>>ASSIGN  20360>>ASSIGN  20364<<ASSIGN
     20372>>ASSIGN  20374<<ASSIGN
ALGN_LENGTH IN PROCEDURE FORM_GATHER
     20012**DCL     20273<<ASSIGN  20277<<ASSIGN  20278<<ASSIGN  20278>>ASSIGN  20285<<ASSIGN  20289<<ASSIGN
     20290<<ASSIGN  20290>>ASSIGN  20298>>ASSIGN  20301>>ASSIGN  20326<<ASSIGN  20327<<ASSIGN  20327>>ASSIGN
     20328<<ASSIGN  20328>>ASSIGN  20331<<ASSIGN  20332<<ASSIGN  20332>>ASSIGN  20333<<ASSIGN  20333>>ASSIGN
     20340>>ASSIGN  20359>>ASSIGN  20361>>ASSIGN
ALGN_OFFSET
     16341**DCL     16770>>ASSIGN  18207>>ASSIGN  19351>>ASSIGN  20373>>ASSIGN
ALIGNMENT_PART IN PROCEDURE FORM_GATHER
     20257**LABEL   20240--GOTO
ARS
     16207**DCL     16436<<ASSIGN  16437<>CALL    16572<<ASSIGN  16573<>CALL    16650<<ASSIGN  16651<>CALL
     16917<<ASSIGN  16918<>CALL    16925<<ASSIGN  16926<>CALL    17049<>CALL    17050>>ASSIGN  17514<<ASSIGN
     17515<>CALL    17589<>CALL    17590>>ASSIGN  18046<>CALL    18048>>IF      18220<>CALL    18221>>ASSIGN
     18466<>CALL    18468>>ASSIGN  18583>>ASSIGN  18758<>CALL    18759>>ASSIGN  19111<<ASSIGN  19112<>CALL
     19185<>CALL    19188>>IF      19364<>CALL    19365>>ASSIGN  19629<>CALL    19631>>ASSIGN  19746>>ASSIGN
     19901<<ASSIGN  19902<>CALL    19921<<ASSIGN  19922<>CALL    19964<>CALL    19990<<ASSIGN  19991<>CALL
ASA_BRKS_LOC
     12953**DCL     12953--REDEF
ASB$BINCHAR
      7296**DCL-ENT 16824--CALL    16832--CALL    16879--CALL    16887--CALL    17696--CALL    17772--CALL
     17825--CALL    17919--CALL    17927--CALL    17935--CALL    17974--CALL    17982--CALL    17990--CALL
     19839--CALL    19847--CALL
ASB$GETSEG
     16172**DCL-ENT 16364--CALL
ASB$READ_SI
     16169**DCL-ENT 17049--CALL    17589--CALL    18046--CALL    18220--CALL    18466--CALL    18758--CALL
     19185--CALL    19364--CALL    19629--CALL
ASB$SET_PROMPT
     16145**DCL-ENT 17044--CALL    17588--CALL    18043--CALL    18219--CALL    18465--CALL    18747--CALL
     19182--CALL    19363--CALL    19628--CALL
ASF$PREC_FORM
     16184**DCL-ENT 19900--CALL
ASF$PREC_SKIP_FORM
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:459  
     16187**DCL-ENT 19989--CALL
ASF$QUERY_PSEUDO_FORMS
     16175**DCL-ENT 16605--CALL
ASF$READ_FORM
     16163**DCL-ENT 16437--CALL    16573--CALL    16651--CALL    17515--CALL    19112--CALL    19922--CALL
ASF$READ_FORM_SEQ
     16190**DCL-ENT 19902--CALL    19991--CALL
ASF$WRITE_FORM
     16166**DCL-ENT 16918--CALL    16926--CALL    19918--CALL    19964--CALL
ASH$DQUEST
     16160**DCL-ENT 17071--CALL    17602--CALL    18237--CALL    18780--CALL    19381--CALL
ASH$ERROR
     16148**DCL-ENT 16377--CALL    16430--CALL    16481--CALL    16508--CALL    16578--CALL    16591--CALL
     16631--CALL    16670--CALL    16694--CALL    16721--CALL    16850--CALL    16947--CALL    17102--CALL
     17141--CALL    17170--CALL    17197--CALL    17225--CALL    17252--CALL    17311--CALL    17432--CALL
     17506--CALL    17544--CALL    17549--CALL    17565--CALL    17625--CALL    17666--CALL    17673--CALL
     17730--CALL    17752--CALL    17806--CALL    17859--CALL    17953--CALL    18008--CALL    18068--CALL
     18265--CALL    18302--CALL    18332--CALL    18379--CALL    18409--CALL    18447--CALL    18492--CALL
     18570--CALL    18603--CALL    18622--CALL    18653--CALL    18885--CALL    19019--CALL    19103--CALL
     19142--CALL    19147--CALL    19156--CALL    19209--CALL    19409--CALL    19440--CALL    19487--CALL
     19517--CALL    19606--CALL    19655--CALL    19733--CALL    19766--CALL    19786--CALL    19817--CALL
     19873--CALL    20232--CALL    20400--CALL
ASH$HELP
     16154**DCL-ENT 17067--CALL    17598--CALL    18233--CALL    18776--CALL    19377--CALL
ASH$INFO
     16181**DCL-ENT 19980--CALL
ASH$QUEST
     16157**DCL-ENT 17069--CALL    17600--CALL    18235--CALL    18778--CALL    19379--CALL
ASH$WARN
     16151**DCL-ENT 16454--CALL    16532--CALL    16552--CALL    16903--CALL    17343--CALL    17464--CALL
     18088--CALL    18352--CALL    18934--CALL    19068--CALL    19229--CALL    19460--CALL
ASR$R_PSEUDO_FORMS
     16178**DCL-ENT 16908--CALL
AS_BLANK
     12813**DCL     16406>>ASSIGN  16407>>ASSIGN  19968>>CALLBLT
AS_DEFAULT.BANNER_PERM
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:460  
     13646**DCL     13647--REDEF
AS_DEFAULT.BUDGET.MACCT
     13551**DCL     13555--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     13564**DCL     13567--REDEF
AS_DEFAULT.BUDGET.PACCUM
     13547**DCL     13549--REDEF
AS_DEFAULT.BUDGET.PMAXC
     13542**DCL     13544--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     13662**DCL     13663--REDEF   13664--REDEF
AS_DEFAULT_DREC.PASSWORD
     14916**DCL     14920--REDEF
AS_DEFAULT_DREC.RENAME
     14939**DCL     14940--REDEF
AS_DFLT.BANNER_PERM
     13468**DCL     13469--REDEF
AS_DFLT.BUDGET.MACCT
     13373**DCL     13377--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     13386**DCL     13389--REDEF
AS_DFLT.BUDGET.PACCUM
     13369**DCL     13371--REDEF
AS_DFLT.BUDGET.PMAXC
     13364**DCL     13366--REDEF
AS_DFLT.SETUP_CHRA.TXT
     13484**DCL     13485--REDEF   13486--REDEF
AS_FALSE
     12813**DCL     16392>>ASSIGN  16397>>ASSIGN  16411>>ASSIGN  16608>>ASSIGN  16931>>ASSIGN  16935>>ASSIGN
     16939>>ASSIGN  17041>>ASSIGN  17042>>ASSIGN  17113>>ASSIGN  17353>>DOWHILE 17559>>ASSIGN  17581>>ASSIGN
     18897>>ASSIGN  18898>>ASSIGN  19031>>ASSIGN  19032>>ASSIGN  19906>>ASSIGN  19910>>ASSIGN  19914>>ASSIGN
     19927>>ASSIGN  19932>>ASSIGN  19938>>ASSIGN  19946>>ASSIGN  19951>>ASSIGN  19957>>ASSIGN
AS_FE_MODE
     12819**DCL     12820--REDEF
AS_FIELD1
     12949**DCL     16443<<ASSIGN  16657<<ASSIGN  16807<<ASSIGN  16862<<ASSIGN
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:461  
AS_FIELD1.COUNT
     12950**DCL     16515<<ASSIGN  16707<<ASSIGN  17297<<ASSIGN  17331<<ASSIGN  17418<<ASSIGN  17452<<ASSIGN
     17530<<ASSIGN  18871<<ASSIGN  18922<<ASSIGN  19005<<ASSIGN  19056<<ASSIGN  19128<<ASSIGN  19969<<ASSIGN
AS_FIELD1.TEXT
     12950**DCL     16516<<ASSIGN  16708<<ASSIGN  17298<<ASSIGN  17332<<ASSIGN  17419<<ASSIGN  17453<<ASSIGN
     17531<<ASSIGN  17696<>CALL    17772<>CALL    17825<>CALL    17919<>CALL    17974<>CALL    18872<<ASSIGN
     18923<<ASSIGN  19006<<ASSIGN  19057<<ASSIGN  19129<<ASSIGN  19839<>CALL    19970<<ASSIGN
AS_FIELD2.TEXT
     12950**DCL     16824<>CALL    16879<>CALL    17927<>CALL    17982<>CALL    19847<>CALL
AS_FIELD3.COUNT
     12951**DCL     19971<<ASSIGN
AS_FIELD3.TEXT
     12951**DCL     16832<>CALL    16887<>CALL    17935<>CALL    17990<>CALL    19928<<ASSIGN  19934<<CALLBLT
     19940<<CALLBLT 19947<<ASSIGN  19953<<CALLBLT 19959<<CALLBLT
AS_MODE
     12816**DCL     12818--REDEF
AS_MOD_USER.ACCESS
     15681**DCL     15682--REDEF
AS_MOD_USER.BANNER
     15668**DCL     15669--REDEF
AS_MOD_USER.BANNER_PERM
     15670**DCL     15671--REDEF
AS_MOD_USER.BILL
     15676**DCL     15677--REDEF
AS_MOD_USER.CPROC
     15672**DCL     15673--REDEF
AS_MOD_USER.FEBILL
     15752**DCL     15753--REDEF
AS_MOD_USER.FECXTMEM
     15769**DCL     15770--REDEF
AS_MOD_USER.FEMINTS
     15754**DCL     15755--REDEF
AS_MOD_USER.FEMMEM
     15765**DCL     15766--REDEF
AS_MOD_USER.FEMTIME
     15763**DCL     15764--REDEF
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:462  
AS_MOD_USER.FEPPRIV
     15760**DCL     15762--REDEF
AS_MOD_USER.FEPRIV
     15757**DCL     15759--REDEF
AS_MOD_USER.FORCE_BIT
     15666**DCL     15667--REDEF
AS_MOD_USER.KEY
     15748**DCL     15750--REDEF
AS_MOD_USER.LASTCPROC
     15674**DCL     15675--REDEF
AS_MOD_USER.LIMITS.DO_
     15722**DCL     15723--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     15738**DCL     15739--REDEF
AS_MOD_USER.LIMITS.LO
     15718**DCL     15719--REDEF
AS_MOD_USER.LIMITS.MEM
     15714**DCL     15715--REDEF
AS_MOD_USER.LIMITS.MPRIO
     15742**DCL     15743--REDEF
AS_MOD_USER.LIMITS.PDIS
     15730**DCL     15731--REDEF
AS_MOD_USER.LIMITS.PO
     15726**DCL     15727--REDEF
AS_MOD_USER.LIMITS.TDIS
     15734**DCL     15735--REDEF
AS_MOD_USER.LIMITS.TIME
     15710**DCL     15711--REDEF
AS_MOD_USER.MAXENQ
     15691**DCL     15692--REDEF
AS_MOD_USER.PERM_BIT
     15664**DCL     15665--REDEF
AS_MOD_USER.PPRIV
     15686**DCL     15688--REDEF
AS_MOD_USER.PRIOB
     15693**DCL     15694--REDEF
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:463  
AS_MOD_USER.PRIV
     15683**DCL     15685--REDEF
AS_MOD_USER.QUAN
     15689**DCL     15690--REDEF
AS_MOD_USER.SETUP
     15662**DCL     15663--REDEF
AS_PROJECT.BANNER_PERM
     14002**DCL     14003--REDEF
AS_PROJECT.BUDGET.MACCT
     13907**DCL     13911--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     13920**DCL     13923--REDEF
AS_PROJECT.BUDGET.PACCUM
     13903**DCL     13905--REDEF
AS_PROJECT.BUDGET.PMAXC
     13898**DCL     13900--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     14018**DCL     14019--REDEF   14020--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     14180**DCL     14181--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     14085**DCL     14089--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     14098**DCL     14101--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     14081**DCL     14083--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     14076**DCL     14078--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     14196**DCL     14197--REDEF   14198--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     15402**DCL     15406--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     15425**DCL     15426--REDEF
AS_PROJECT_DREC.PASSWORD
     15240**DCL     15244--REDEF
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:464  
AS_PROJECT_DREC.RENAME
     15263**DCL     15264--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     13824**DCL     13825--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     13729**DCL     13733--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     13742**DCL     13745--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     13725**DCL     13727--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     13720**DCL     13722--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     13840**DCL     13841--REDEF   13842--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     15078**DCL     15082--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     15101**DCL     15102--REDEF
AS_TRUE
     12813**DCL     16390>>ASSIGN  16401>>ASSIGN  16459>>ASSIGN  16488>>ASSIGN  16612>>ASSIGN  16702>>ASSIGN
     17048>>DOWHILE 17110>>ASSIGN  17121>>ASSIGN  17150>>ASSIGN  17555>>ASSIGN  17557>>ASSIGN  17583>>ASSIGN
     18217>>ASSIGN  18782>>ASSIGN  18902>>ASSIGN  18911>>ASSIGN  19036>>ASSIGN  19045>>ASSIGN  19361>>ASSIGN
AS_USERS.BANNER_PERM
     13290**DCL     13291--REDEF
AS_USERS.BUDGET.MACCT
     13195**DCL     13199--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     13208**DCL     13211--REDEF
AS_USERS.BUDGET.PACCUM
     13191**DCL     13193--REDEF
AS_USERS.BUDGET.PMAXC
     13186**DCL     13188--REDEF
AS_USERS.SETUP_CHRA.TXT
     13306**DCL     13307--REDEF   13308--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     14358**DCL     14359--REDEF
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:465  
AS_USERS_CONSTANT.BUDGET.MACCT
     14263**DCL     14267--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     14276**DCL     14279--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     14259**DCL     14261--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     14254**DCL     14256--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     14374**DCL     14375--REDEF   14376--REDEF
BANNER IN PROCEDURE FORM_OPTS
     18101**PROC    17366--CALL    17370--CALL
BANNER IN PROCEDURE GFORM_OPTS
     19245**PROC    18949--CALL    18953--CALL
BANNER_ERR IN PROCEDURE BANNER
     18653**LABEL   18222--CALLALT 18655--GOTO
BANNER_LOOP IN PROCEDURE BANNER
     19362**LABEL   18496--GOTO    18574--GOTO    18607--GOTO    18654--GOTO    19659--GOTO    19737--GOTO
     19770--GOTO    19818--GOTO
BANNER_LOOP_END IN PROCEDURE BANNER
     19810**LABEL   18268--GOTO    18412--GOTO    19412--GOTO    19520--GOTO    19546--CALLALT 19549--CALLALT
     19609--GOTO
BANNER_PART IN PROCEDURE FORM_GATHER
     20082**LABEL   20068--GOTO
BLK$
     16319**DCL     16287--IMP-PTR 16408<<ASSIGN  16412>>IF      16435>>ASSIGN  16435>>ASSIGN  16515>>ASSIGN
     16516>>ASSIGN  16516>>ASSIGN  16611<<ASSIGN  16613>>IF      16636>>ASSIGN  16636>>ASSIGN  16707>>ASSIGN
     16708>>ASSIGN  16708>>ASSIGN  17083<<ASSIGN  17084>>CALLBLT 17084>>CALLBLT 17117<<ASSIGN  17118>>CALLBLT
     17118>>CALLBLT 17147<<ASSIGN  17148>>CALLBLT 17148>>CALLBLT 17176<<ASSIGN  17177>>CALLBLT 17177>>CALLBLT
     17203<<ASSIGN  17204>>CALLBLT 17204>>CALLBLT 17231<<ASSIGN  17232>>CALLBLT 17232>>CALLBLT 17291<<ASSIGN
     17292>>IF      17297>>ASSIGN  17298>>ASSIGN  17298>>ASSIGN  17317>>ASSIGN  17317>>ASSIGN  17323>>IF
     17323>>IF      17331>>ASSIGN  17332>>ASSIGN  17332>>ASSIGN  17350>>ASSIGN  17350>>ASSIGN  17412<<ASSIGN
     17413>>IF      17418>>ASSIGN  17419>>ASSIGN  17419>>ASSIGN  17438>>ASSIGN  17438>>ASSIGN  17444>>IF
     17444>>IF      17452>>ASSIGN  17453>>ASSIGN  17453>>ASSIGN  17471>>ASSIGN  17471>>ASSIGN  17487<<ASSIGN
     17488>>IF      17511>>ASSIGN  17512>>CALLBLT 17512>>CALLBLT 17512>>CALLBLT 17520>>ASSIGN  17520>>ASSIGN
     17530>>ASSIGN  17531>>ASSIGN  17531>>ASSIGN  17607<<ASSIGN  17608>>CALLBLT 17608>>CALLBLT 17631<<ASSIGN
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:466  
     17637<<ASSIGN  17682>>CALLBLT 17682>>CALLBLT 18276<<ASSIGN  18277>>CALLBLT 18277>>CALLBLT 18423<<ASSIGN
     18424>>CALLBLT 18424>>CALLBLT 18785<<ASSIGN  18792<<ASSIGN  18799<<ASSIGN  18806<<ASSIGN  18813<<ASSIGN
     18820<<ASSIGN  18827<<ASSIGN  18828>>CALLBLT 18828>>CALLBLT 18829<<ASSIGN  18868<<ASSIGN  18869>>IF
     18871>>ASSIGN  18872>>ASSIGN  18872>>ASSIGN  18892>>ASSIGN  18892>>ASSIGN  18900>>IF      18900>>IF
     18922>>ASSIGN  18923>>ASSIGN  18923>>ASSIGN  18942>>ASSIGN  18942>>ASSIGN  18998<<ASSIGN  18999>>IF
     19005>>ASSIGN  19006>>ASSIGN  19006>>ASSIGN  19026>>ASSIGN  19026>>ASSIGN  19034>>IF      19034>>IF
     19056>>ASSIGN  19057>>ASSIGN  19057>>ASSIGN  19076>>ASSIGN  19076>>ASSIGN  19084<<ASSIGN  19085>>IF
     19108>>ASSIGN  19109>>CALLBLT 19109>>CALLBLT 19109>>CALLBLT 19118>>ASSIGN  19118>>ASSIGN  19128>>ASSIGN
     19129>>ASSIGN  19129>>ASSIGN  19420<<ASSIGN  19421>>CALLBLT 19421>>CALLBLT 19543<<ASSIGN  19825>>CALLBLT
     19825>>CALLBLT
BNNR$
     16348**DCL     16762<<ASSIGN  16765>>ASSIGN  17374<<ASSIGN  18199<<ASSIGN  18957<<ASSIGN  19344<<ASSIGN
     20084>>IF      20097>>ASSIGN  20100>>IF      20106>>ASSIGN  20107>>ASSIGN  20113>>ASSIGN  20116>>IF
     20122>>ASSIGN  20123>>ASSIGN  20132>>ASSIGN  20133<<ASSIGN  20135<<ASSIGN  20141>>ASSIGN  20143>>ASSIGN
     20144>>ASSIGN  20148>>ASSIGN  20150>>ASSIGN  20151>>ASSIGN  20161>>ASSIGN  20164>>ASSIGN  20171>>ASSIGN
     20176>>IF      20178>>ASSIGN  20178>>ASSIGN  20182>>IF      20184>>ASSIGN  20184>>ASSIGN  20191>>ASSIGN
     20195<<ASSIGN  20203>>ASSIGN  20205<<ASSIGN
BNNR_LENGTH IN PROCEDURE FORM_GATHER
     20011**DCL     20098<<ASSIGN  20106<<ASSIGN  20107<<ASSIGN  20107>>ASSIGN  20114<<ASSIGN  20122<<ASSIGN
     20123<<ASSIGN  20123>>ASSIGN  20131>>ASSIGN  20134>>ASSIGN  20161<<ASSIGN  20164<<ASSIGN  20171>>ASSIGN
     20190>>ASSIGN  20192>>ASSIGN
BNNR_OFFSET
     16339**DCL     16762>>ASSIGN  18197>>ASSIGN  19342>>ASSIGN  20204>>ASSIGN
CHAN IN PROCEDURE CHECK_VFU_IMAGE
     17878**DCL     17882<<DOINDEX 17883>>ASSIGN  17885>>ASSIGN  17919<>CALL    17974<>CALL
CHAN IN PROCEDURE VFUIM
     17572**DCL     17630<<ASSIGN  17635>>ASSIGN  17642>>ASSIGN  17643<<ASSIGN
CHANGE162_9X9 IN PROCEDURE GFORM_OPTS
     19821**PROC    18786--CALL    18793--CALL    18800--CALL    18807--CALL    18814--CALL    18821--CALL
     18830--CALL    19546--CALL    19549--CALL
CHARSET
     16119**DCL     17514--ASSIGN  19111--ASSIGN
CHARSET.ATTRS
     16131**DCL     17518>>ASSIGN  19115>>ASSIGN  19116>>ASSIGN
CHARSET.CHAINIMAGE
     16130**DCL     17519>>ASSIGN
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:467  
CHARSET.LGLTYPS
     16132**DCL     17517>>ASSIGN  19114>>ASSIGN
CHARSET.SETS
     16120**DCL     16130--REDEF
CHARSET$
     16198**DCL     16119--IMP-PTR 16783<<ASSIGN  17515<>CALL    17517>>ASSIGN  17518>>ASSIGN  17519>>ASSIGN
     19112<>CALL    19114>>ASSIGN  19115>>ASSIGN  19116>>ASSIGN
CHARSET_KEY
     16229**DCL     17515<>CALL    19112<>CALL
CHARSET_KEY.CNT
     16230**DCL     17511<<ASSIGN  19108<<ASSIGN
CHARSET_KEY.TXT
     16231**DCL     17512<<CALLBLT 19109<<CALLBLT
CHECK_LENGTH_1 IN PROCEDURE FORM_GATHER
     20212**LABEL   20087--GOTO    20136--GOTO    20196--GOTO
CHECK_LENGTH_2 IN PROCEDURE FORM_GATHER
     20381**LABEL   20262--GOTO    20303--GOTO    20365--GOTO
CHECK_VFU_FLG IN PROCEDURE FORM_OPTS
     17035**DCL     17042<<ASSIGN  17073>>IF      17121<<ASSIGN  17150<<ASSIGN  17581<<ASSIGN
CHECK_VFU_IMAGE IN PROCEDURE FORM_OPTS
     17875**PROC    17075--CALL
CHECK_VFU_VAL IN PROCEDURE CHECK_VFU_IMAGE
     17897**PROC    17884--CALL    17888--CALL
CM_FORM_OK
     16607**LABEL   16439--GOTO    16460--GOTO
CODE
     12946**DCL     17056<<ASSIGN  17063>>DOSELCT 17286>>IF      17316>>IF      17327>>IF      17354>>IF
     17407>>IF      17437>>IF      17448>>IF      17475>>IF      18765<<ASSIGN  18772>>DOSELCT 18859>>IF
     18890>>IF      18903>>IF      18916>>IF      18988>>IF      19024>>IF      19037>>IF      19050>>IF
CODE IN PROCEDURE BANNER
     19325**DCL     18227<<ASSIGN  18231>>DOSELCT 19371<<ASSIGN  19375>>DOSELCT
CODE IN PROCEDURE VFUIM
     17574**DCL     17595<<ASSIGN  17596>>DOSELCT
CODE2 IN PROCEDURE BANNER
     19326**DCL     18470<<ASSIGN  18472>>DOSELCT 18498>>DOSELCT 19633<<ASSIGN  19635>>DOSELCT 19661>>DOSELCT
CREATE
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:468  
     16204**DCL     16390<<ASSIGN  16392<<ASSIGN  16439>>IF      16459<<ASSIGN  16491>>IF      16639>>IF
     16727>>IF      16919>>IF
DEV_LIM_NUM IN PROCEDURE GFORM_OPTS
     18721**DCL     18828<<CALLBLT 18832>>ASSIGN
DEV_TYPE IN PROCEDURE FORM_OPTS
     17033**DCL     17034--REDEF
DEV_TYPE IN PROCEDURE GFORM_OPTS
     18741**DCL     18742--REDEF
DISP_TALLY
     16199**DCL     16917>>ASSIGN  20039<<ASSIGN  20040>>ASSIGN  20043>>ASSIGN  20056>>ASSIGN  20060<<ASSIGN
     20060>>ASSIGN  20065>>ASSIGN  20078>>ASSIGN  20082<<ASSIGN  20082>>ASSIGN  20089>>ASSIGN  20130>>ASSIGN
     20134<<ASSIGN  20134>>ASSIGN  20189>>ASSIGN  20192<<ASSIGN  20192>>ASSIGN  20208>>ASSIGN  20211<<ASSIGN
     20211>>ASSIGN  20214>>IF      20244>>ASSIGN  20253>>ASSIGN  20257<<ASSIGN  20257>>ASSIGN  20264>>ASSIGN
     20297>>ASSIGN  20301<<ASSIGN  20301>>ASSIGN  20358>>ASSIGN  20361<<ASSIGN  20361>>ASSIGN  20377>>ASSIGN
     20380<<ASSIGN  20380>>ASSIGN  20383>>IF
DSEG1$
     12954**DCL     16748>>ASSIGN  16762>>ASSIGN  16778>>ASSIGN  17283>>ASSIGN  17401>>ASSIGN  18197>>ASSIGN
     18198>>ASSIGN  18856>>ASSIGN  18984>>ASSIGN  19342>>ASSIGN  19343>>ASSIGN
DSEG2$
     12955**DCL     16755>>ASSIGN  16770>>ASSIGN  18038>>ASSIGN  18207>>ASSIGN  18208>>ASSIGN  19177>>ASSIGN
     19351>>ASSIGN  19352>>ASSIGN
DSEG3$
     12955**DCL     16783>>ASSIGN
DSEG_FLG
     12954**DCL     16362>>IF
ELSOK
     16211**DCL     16598<<ASSIGN  16603<<ASSIGN  16732<<ASSIGN  16738<<ASSIGN  16922>>ASSIGN  16938>>IF
     16939<<ASSIGN  19913>>IF      19937>>IF      19956>>IF
END_LOOP IN PROCEDURE FORM_GATHER
     20130**LABEL   20108--GOTO    20124--GOTO
END_LOOP$A IN PROCEDURE FORM_GATHER
     20290**LABEL   20279--GOTO    20291--GOTO
ENTRY_LEN IN PROCEDURE FORM_GATHER
     20006**DCL     20033<<ASSIGN  20037<<ASSIGN  20098>>ASSIGN  20161>>ASSIGN  20273>>ASSIGN  20327>>ASSIGN
ENUM
     16192**DCL     18194<<ASSIGN  18362>>IF      18414>>ASSIGN  18415>>ASSIGN  18416>>ASSIGN  18417>>ASSIGN
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:469  
     18418>>ASSIGN  18419>>ASSIGN  18420>>ASSIGN  18421>>ASSIGN  18427>>ASSIGN  18429>>ASSIGN  18451>>ASSIGN
     18452>>ASSIGN  18454>>ASSIGN  18456>>ASSIGN  18458>>ASSIGN  18460>>ASSIGN  18462>>ASSIGN  18500>>ASSIGN
     18502>>ASSIGN  18504>>ASSIGN  18506>>ASSIGN  18508>>ASSIGN  18510>>ASSIGN  18512>>ASSIGN  18514>>ASSIGN
     18516>>ASSIGN  18518>>ASSIGN  18520>>ASSIGN  18522>>ASSIGN  18524>>ASSIGN  18526>>ASSIGN  18528>>ASSIGN
     18530>>ASSIGN  18532>>ASSIGN  18534>>ASSIGN  18536>>ASSIGN  18538>>ASSIGN  18540>>ASSIGN  18542>>ASSIGN
     18544>>ASSIGN  18546>>ASSIGN  18548>>ASSIGN  18550>>ASSIGN  18577>>ASSIGN  18578>>ASSIGN  18582>>ASSIGN
     18609>>IF      18632>>ASSIGN  18637>>ASSIGN  18645<<ASSIGN  18645>>ASSIGN  18646>>ASSIGN  19339<<ASSIGN
     19470>>IF      19522>>ASSIGN  19523>>ASSIGN  19524>>ASSIGN  19525>>ASSIGN  19526>>ASSIGN  19527>>ASSIGN
     19528>>ASSIGN  19529>>ASSIGN  19530>>ASSIGN  19531>>ASSIGN  19532>>ASSIGN  19533>>ASSIGN  19534>>ASSIGN
     19535>>ASSIGN  19536>>ASSIGN  19537>>ASSIGN  19538>>ASSIGN  19539>>ASSIGN  19540>>ASSIGN  19541>>ASSIGN
     19553>>ASSIGN  19556>>ASSIGN  19558>>ASSIGN  19561>>ASSIGN  19563>>ASSIGN  19566>>ASSIGN  19570>>ASSIGN
     19571>>ASSIGN  19572>>ASSIGN  19573>>ASSIGN  19575>>ASSIGN  19576>>ASSIGN  19577>>ASSIGN  19578>>ASSIGN
     19580>>ASSIGN  19581>>ASSIGN  19582>>ASSIGN  19583>>ASSIGN  19585>>ASSIGN  19586>>ASSIGN  19587>>ASSIGN
     19588>>ASSIGN  19612>>ASSIGN  19615>>ASSIGN  19617>>ASSIGN  19620>>ASSIGN  19622>>ASSIGN  19625>>ASSIGN
     19663>>ASSIGN  19665>>ASSIGN  19667>>ASSIGN  19669>>ASSIGN  19671>>ASSIGN  19673>>ASSIGN  19675>>ASSIGN
     19677>>ASSIGN  19679>>ASSIGN  19681>>ASSIGN  19683>>ASSIGN  19685>>ASSIGN  19687>>ASSIGN  19689>>ASSIGN
     19691>>ASSIGN  19693>>ASSIGN  19695>>ASSIGN  19697>>ASSIGN  19699>>ASSIGN  19701>>ASSIGN  19703>>ASSIGN
     19705>>ASSIGN  19707>>ASSIGN  19709>>ASSIGN  19711>>ASSIGN  19713>>ASSIGN  19740>>ASSIGN  19741>>ASSIGN
     19745>>ASSIGN  19772>>IF      19796>>ASSIGN  19801>>ASSIGN  19809<<ASSIGN  19809>>ASSIGN  19810>>ASSIGN
     20097<<ASSIGN  20098>>ASSIGN  20099>>DOINDEX 20113<<ASSIGN  20114>>ASSIGN  20115>>DOINDEX 20141<<ASSIGN
     20142>>DOINDEX 20148<<ASSIGN  20149>>DOINDEX 20173>>DOINDEX 20272<<ASSIGN  20273>>ASSIGN  20274>>DOINDEX
     20284<<ASSIGN  20285>>ASSIGN  20286>>DOINDEX 20305<<ASSIGN  20308>>DOINDEX 20314>>DOINDEX 20342>>DOINDEX
ERR_CODE
     12948**DCL     12949--REDEF   16578<>CALL
EXIT# IN PROCEDURE CHECK_VFU_IMAGE
     17893**LABEL   17884--CALLALT 17888--CALLALT
F$
     16320**DCL     16382<<ASSIGN  16437<>CALL    16462>>IF      16486>>IF      16513>>IF      16565>>ASSIGN
     16565>>ASSIGN  16565>>ASSIGN  16571>>CALLBLT 16601>>ASSIGN  16602>>ASSIGN  16603>>ASSIGN  16651<>CALL
     16676>>IF      16700>>IF      16705>>IF      16730>>ASSIGN  16731>>ASSIGN  16732>>ASSIGN  16736>>ASSIGN
     16737>>ASSIGN  16738>>ASSIGN  16739>>ASSIGN  16739>>ASSIGN  16739>>ASSIGN  16745>>ASSIGN  16746>>IF
     16750>>ASSIGN  16750>>ASSIGN  16753>>IF      16757>>ASSIGN  16757>>ASSIGN  16760>>IF      16764>>ASSIGN
     16764>>ASSIGN  16768>>IF      16772>>ASSIGN  16772>>ASSIGN  16776>>IF      16780>>ASSIGN  16780>>ASSIGN
     16794>>ASSIGN  16794>>ASSIGN  16794>>ASSIGN  16912>>ASSIGN  16914>>ASSIGN  16918<>CALL    16930>>IF
     16934>>IF      16938>>IF      17073>>IF      17078>>ASSIGN  17110>>ASSIGN  17113>>ASSIGN  17114>>ASSIGN
     17120>>IF      17122>>ASSIGN  17150>>IF      17151>>ASSIGN  17179>>ASSIGN  17206>>ASSIGN  17234>>ASSIGN
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:470  
     17288>>ASSIGN  17409>>ASSIGN  17517>>ASSIGN  17518>>ASSIGN  17519>>ASSIGN  17520>>ASSIGN  17584>>ASSIGN
     17635>>ASSIGN  17641>>ASSIGN  17642>>ASSIGN  17684>>IF      17757>>ASSIGN  17758>>IF      17883>>ASSIGN
     17885>>ASSIGN  17887>>ASSIGN  17889>>ASSIGN  17903>>ASSIGN  17904>>IF      17956>>ASSIGN  18011>>ASSIGN
     18042>>ASSIGN  18095>>ASSIGN  18241>>ASSIGN  18245>>ASSIGN  18384>>ASSIGN  18386>>ASSIGN  18627>>ASSIGN
     18629>>ASSIGN  18755>>ASSIGN  18756>>ASSIGN  18782>>ASSIGN  18788>>ASSIGN  18789>>ASSIGN  18795>>ASSIGN
     18796>>ASSIGN  18802>>ASSIGN  18803>>ASSIGN  18809>>ASSIGN  18810>>ASSIGN  18816>>ASSIGN  18817>>ASSIGN
     18823>>ASSIGN  18824>>ASSIGN  18832>>ASSIGN  18864>>ASSIGN  18993>>ASSIGN  19114>>ASSIGN  19115>>ASSIGN
     19116>>ASSIGN  19117>>ASSIGN  19117>>ASSIGN  19118>>ASSIGN  19181>>ASSIGN  19238>>ASSIGN  19385>>ASSIGN
     19389>>ASSIGN  19492>>ASSIGN  19494>>ASSIGN  19791>>ASSIGN  19793>>ASSIGN  19922<>CALL    19926>>IF
     19927>>ASSIGN  19931>>IF      19932>>ASSIGN  19937>>IF      19938>>ASSIGN  19945>>IF      19946>>ASSIGN
     19950>>IF      19951>>ASSIGN  19956>>IF      19957>>ASSIGN  19964<>CALL    20040>>ASSIGN  20043>>ASSIGN
     20045>>ASSIGN  20056>>ASSIGN  20065>>ASSIGN  20067>>ASSIGN  20078>>ASSIGN  20086>>ASSIGN  20089>>ASSIGN
     20130>>ASSIGN  20189>>ASSIGN  20208>>ASSIGN  20239>>ASSIGN  20244>>ASSIGN  20253>>ASSIGN  20261>>ASSIGN
     20264>>ASSIGN  20297>>ASSIGN  20358>>ASSIGN  20377>>ASSIGN
FB$ IN PROCEDURE BANNER
     19324**DCL     18186--IMP-PTR 18197<<ASSIGN  18199>>ASSIGN  18202>>ASSIGN  18203>>ASSIGN  18204>>ASSIGN
     18207<<ASSIGN  18209>>ASSIGN  18212>>ASSIGN  18213>>ASSIGN  18214>>ASSIGN  18216>>ASSIGN  18240>>IF
     18244>>IF      18271>>ASSIGN  18273>>ASSIGN  18282>>ASSIGN  18312>>ASSIGN  18359>>ASSIGN  18362>>IF
     18382>>ASSIGN  18390>>IF      18391>>ASSIGN  18414>>ASSIGN  18415>>ASSIGN  18416>>ASSIGN  18417>>ASSIGN
     18418>>ASSIGN  18419>>ASSIGN  18420>>ASSIGN  18421>>ASSIGN  18427>>ASSIGN  18429>>ASSIGN  18451>>ASSIGN
     18452>>ASSIGN  18454>>ASSIGN  18456>>ASSIGN  18458>>ASSIGN  18460>>ASSIGN  18462>>ASSIGN  18500>>ASSIGN
     18502>>ASSIGN  18504>>ASSIGN  18506>>ASSIGN  18508>>ASSIGN  18510>>ASSIGN  18512>>ASSIGN  18514>>ASSIGN
     18516>>ASSIGN  18518>>ASSIGN  18520>>ASSIGN  18522>>ASSIGN  18524>>ASSIGN  18526>>ASSIGN  18528>>ASSIGN
     18530>>ASSIGN  18532>>ASSIGN  18534>>ASSIGN  18536>>ASSIGN  18538>>ASSIGN  18540>>ASSIGN  18542>>ASSIGN
     18544>>ASSIGN  18546>>ASSIGN  18548>>ASSIGN  18550>>ASSIGN  18577>>ASSIGN  18578>>ASSIGN  18582>>ASSIGN
     18609>>IF      18625>>ASSIGN  18632>>ASSIGN  18637>>ASSIGN  18637>>ASSIGN  18646>>ASSIGN  19331--IMP-PTR
     19342<<ASSIGN  19344>>ASSIGN  19347>>ASSIGN  19348>>ASSIGN  19351<<ASSIGN  19353>>ASSIGN  19356>>ASSIGN
     19357>>ASSIGN  19359>>ASSIGN  19360>>ASSIGN  19384>>IF      19388>>IF      19415>>ASSIGN  19417>>ASSIGN
     19423>>ASSIGN  19467>>ASSIGN  19470>>IF      19490>>ASSIGN  19498>>IF      19499>>ASSIGN  19522>>ASSIGN
     19523>>ASSIGN  19524>>ASSIGN  19525>>ASSIGN  19526>>ASSIGN  19527>>ASSIGN  19528>>ASSIGN  19529>>ASSIGN
     19530>>ASSIGN  19531>>ASSIGN  19532>>ASSIGN  19533>>ASSIGN  19534>>ASSIGN  19535>>ASSIGN  19536>>ASSIGN
     19537>>ASSIGN  19538>>ASSIGN  19539>>ASSIGN  19540>>ASSIGN  19541>>ASSIGN  19553>>ASSIGN  19556>>ASSIGN
     19558>>ASSIGN  19561>>ASSIGN  19563>>ASSIGN  19566>>ASSIGN  19570>>ASSIGN  19571>>ASSIGN  19572>>ASSIGN
     19573>>ASSIGN  19575>>ASSIGN  19576>>ASSIGN  19577>>ASSIGN  19578>>ASSIGN  19580>>ASSIGN  19581>>ASSIGN
     19582>>ASSIGN  19583>>ASSIGN  19585>>ASSIGN  19586>>ASSIGN  19587>>ASSIGN  19588>>ASSIGN  19612>>ASSIGN
     19615>>ASSIGN  19617>>ASSIGN  19620>>ASSIGN  19622>>ASSIGN  19625>>ASSIGN  19663>>ASSIGN  19665>>ASSIGN
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:471  
     19667>>ASSIGN  19669>>ASSIGN  19671>>ASSIGN  19673>>ASSIGN  19675>>ASSIGN  19677>>ASSIGN  19679>>ASSIGN
     19681>>ASSIGN  19683>>ASSIGN  19685>>ASSIGN  19687>>ASSIGN  19689>>ASSIGN  19691>>ASSIGN  19693>>ASSIGN
     19695>>ASSIGN  19697>>ASSIGN  19699>>ASSIGN  19701>>ASSIGN  19703>>ASSIGN  19705>>ASSIGN  19707>>ASSIGN
     19709>>ASSIGN  19711>>ASSIGN  19713>>ASSIGN  19740>>ASSIGN  19741>>ASSIGN  19745>>ASSIGN  19772>>IF
     19789>>ASSIGN  19796>>ASSIGN  19801>>ASSIGN  19801>>ASSIGN  19810>>ASSIGN
FB_TYPE_LIST
     16330**DCL     18467--ASSIGN  19630--ASSIGN
FC$
     16194**DCL     18184--IMP-PTR 18198<<ASSIGN  18208<<ASSIGN  18362>>IF      18609>>IF      18634<<ASSIGN
     18634>>ASSIGN  18636>>ASSIGN  18637>>ASSIGN  18640>>ASSIGN  18642>>ASSIGN  19329--IMP-PTR 19343<<ASSIGN
     19352<<ASSIGN  19470>>IF      19772>>IF      19798<<ASSIGN  19798>>ASSIGN  19800>>ASSIGN  19801>>ASSIGN
     19804>>ASSIGN  19806>>ASSIGN
FCA$
     16196**DCL     18210<<ASSIGN  18642<<ASSIGN  19354<<ASSIGN  19806<<ASSIGN  20339>>IF      20341>>ASSIGN
     20362>>IF      20372>>ASSIGN  20379>>ASSIGN  20381<<ASSIGN
FCB$
     16195**DCL     18200<<ASSIGN  18640<<ASSIGN  19345<<ASSIGN  19804<<ASSIGN  20170>>IF      20172>>ASSIGN
     20193>>IF      20203>>ASSIGN  20210>>ASSIGN  20212<<ASSIGN
FC_B_LEN IN PROCEDURE BANNER
     19332**DCL     18186--IMP-SIZ 19331--IMP-SIZ
FC_CHAR IN PROCEDURE BANNER
     19329**DCL     18636<<ASSIGN  19800<<ASSIGN
FC_LEN IN PROCEDURE BANNER
     19330**DCL     18184--IMP-SIZ 18583<<ASSIGN  18584>>IF      18632>>ASSIGN  18633<<ASSIGN  18633>>ASSIGN
     18634>>ASSIGN  18635<<ASSIGN  18635>>ASSIGN  18636>>ASSIGN  19329--IMP-SIZ 19746<<ASSIGN  19747>>IF
     19796>>ASSIGN  19797<<ASSIGN  19797>>ASSIGN  19798>>ASSIGN  19799<<ASSIGN  19799>>ASSIGN  19800>>ASSIGN
FENTRYLEN IN PROCEDURE FORM_GATHER
     20003**DCL     20037>>ASSIGN
FF$
     16197**DCL     16750<<ASSIGN  16751>>ASSIGN  16757<<ASSIGN  16758>>ASSIGN  16764<<ASSIGN  16765>>ASSIGN
     16772<<ASSIGN  16773>>ASSIGN  16780<<ASSIGN  16781>>ASSIGN  20040<<ASSIGN  20056<<ASSIGN  20058>>ASSIGN
     20078<<ASSIGN  20080>>ASSIGN  20130<<ASSIGN  20132>>ASSIGN  20171<<ASSIGN  20172>>ASSIGN  20189<<ASSIGN
     20191>>ASSIGN  20208<<ASSIGN  20210>>ASSIGN  20253<<ASSIGN  20255>>ASSIGN  20297<<ASSIGN  20299>>ASSIGN
     20340<<ASSIGN  20341>>ASSIGN  20358<<ASSIGN  20360>>ASSIGN  20377<<ASSIGN  20379>>ASSIGN
FINISHED IN PROCEDURE MOD_PSEUDO_FORMS
     19994**LABEL   19900--CALLALT 19902--CALLALT 19991--CALLALT
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:472  
FIXED_LENGTH IN PROCEDURE FORM_GATHER
     20001**DCL     20036>>ASSIGN
FORM IN PROCEDURE MOD_PSEUDO_FORMS
     19896**DCL     19899<<ASSIGN  19903>>DOWHILE
FORM_BUF
     16233**DCL     16382--ASSIGN
FORM_CMD
     16322**DCL     16386--ASSIGN
FORM_ERR
     16947**LABEL   16387--CALLALT
FORM_GATHER
     19998**PROC    16915--CALL
FORM_KEY
     16220**DCL     16437<>CALL    16443>>ASSIGN  16605<>CALL    16862>>ASSIGN  16918<>CALL    19922<>CALL
     19964<>CALL
FORM_KEY.CNT
     16221**DCL     16409<<ASSIGN
FORM_KEY.TEXT
     16222**DCL     16406<<ASSIGN  16435<<ASSIGN  16513>>IF      16571>>CALLBLT 16648>>ASSIGN  16914>>ASSIGN
     16921>>CALLBLT 19920<<ASSIGN  19968>>CALLBLT 19970>>ASSIGN
FORM_KEY_OLD
     16223**DCL     16651<>CALL    16657>>ASSIGN  16807>>ASSIGN
FORM_KEY_OLD.CNT
     16224**DCL     16410<<ASSIGN
FORM_KEY_OLD.TEXT
     16225**DCL     16407<<ASSIGN  16636<<ASSIGN  16642<<ASSIGN  16645<<ASSIGN  16648<<ASSIGN  16705>>IF
     16745<<ASSIGN  16912>>ASSIGN  16921>>CALLBLT
FORM_OPTS
     16950**PROC    16793--CALL
FORM_OPTS_LIST
     16324**DCL     17047--ASSIGN
FORM_OPTS_LOOP IN PROCEDURE FORM_OPTS
     17044**LABEL   17259--GOTO    17263--GOTO    17367--GOTO    17371--GOTO    17566--GOTO
FORM_OPTS_LOOP IN PROCEDURE GFORM_OPTS
     18747**LABEL   18836--GOTO    18950--GOTO    18954--GOTO    19157--GOTO
FORM_OPTS_LOOP_END IN PROCEDURE FORM_OPTS
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:473  
     17547**LABEL   17105--GOTO
FOUND IN PROCEDURE GFORM_OPTS
     18744**DCL     18897<<ASSIGN  18902<<ASSIGN  18940>>IF      19032<<ASSIGN  19036<<ASSIGN  19074>>IF
FOUND_ACCESS IN PROCEDURE FORM_OPTS
     17354**LABEL   17324--GOTO
FOUND_ACCOUNT IN PROCEDURE FORM_OPTS
     17475**LABEL   17445--GOTO
FROM
     16205**DCL     16608<<ASSIGN  16612<<ASSIGN  16705>>IF
FS$ACCESS.LIST
     16024**DCL     17317<<ASSIGN  17323>>IF      17350<<ASSIGN  17356<<ASSIGN  17356>>ASSIGN  18892<<ASSIGN
     18900>>IF      18906<<ASSIGN  18906>>ASSIGN  18942<<ASSIGN
FS$ACCESS.TNAMES
     16023**DCL     17284<<ASSIGN  17287<<ASSIGN  17318<<ASSIGN  17318>>ASSIGN  17322>>DOWHILE 17351<<ASSIGN
     17355>>DOINDEX 17358<<ASSIGN  17358>>ASSIGN  18857<<ASSIGN  18861<<ASSIGN  18893<<ASSIGN  18893>>ASSIGN
     18899>>DOWHILE 18905>>DOINDEX 18909<<ASSIGN  18909>>ASSIGN  18943<<ASSIGN  20042>>IF      20050>>ASSIGN
FS$ACCOUNTS.LIST
     16009**DCL     17438<<ASSIGN  17444>>IF      17471<<ASSIGN  17477<<ASSIGN  17477>>ASSIGN  19026<<ASSIGN
     19034>>IF      19040<<ASSIGN  19040>>ASSIGN  19076<<ASSIGN
FS$ACCOUNTS.TACCTS
     16008**DCL     17402<<ASSIGN  17408<<ASSIGN  17439<<ASSIGN  17439>>ASSIGN  17443>>DOWHILE 17472<<ASSIGN
     17476>>DOINDEX 17479<<ASSIGN  17479>>ASSIGN  18985<<ASSIGN  18990<<ASSIGN  19027<<ASSIGN  19027>>ASSIGN
     19033>>DOWHILE 19039>>DOINDEX 19043<<ASSIGN  19043>>ASSIGN  19077<<ASSIGN  20064>>IF      20072>>ASSIGN
FS$FINST
     16037**DCL     20003--DCLINIT
FS$FINST.ALIGNCTL.EVERY
     16040**DCL     18359<<ASSIGN
FS$FINST.CHARGE
     16038**DCL     16039--REDEF   18203<<ASSIGN  18213<<ASSIGN  18271<<ASSIGN  18273<<ASSIGN
FS$FINST.ENTRIES.CHR
     16060**DCL     18578<<ASSIGN
FS$FINST.ENTRIES.CINC
     16053**DCL     18419<<ASSIGN  18462<<ASSIGN
FS$FINST.ENTRIES.COL
     16047**DCL     18429<<ASSIGN
FS$FINST.ENTRIES.COUNT
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:474  
     16059**DCL     16060--REDEF   18421<<ASSIGN  18632<<ASSIGN  20122>>ASSIGN  20289>>ASSIGN
FS$FINST.ENTRIES.DISP
     16055**DCL     16056--REDEF   18420<<ASSIGN  18637<<ASSIGN  20116>>IF      20123>>ASSIGN  20182>>IF
     20184<<ASSIGN  20184>>ASSIGN  20287>>IF      20290>>ASSIGN  20351>>IF      20353<<ASSIGN  20353>>ASSIGN
FS$FINST.ENTRIES.FONT
     16048**DCL     18414<<ASSIGN  18451<<ASSIGN
FS$FINST.ENTRIES.ICSH
     16050**DCL     18416<<ASSIGN  18452<<ASSIGN  18456<<ASSIGN
FS$FINST.ENTRIES.MARK
     16062**DCL     18362--IF      18609--IF      20151<<ASSIGN  20315<<ASSIGN
FS$FINST.ENTRIES.REPS
     16051**DCL     18417<<ASSIGN  18458<<ASSIGN
FS$FINST.ENTRIES.RINC
     16052**DCL     18418<<ASSIGN  18460<<ASSIGN
FS$FINST.ENTRIES.ROW
     16046**DCL     18427<<ASSIGN
FS$FINST.ENTRIES.STRIKES
     16049**DCL     18415<<ASSIGN  18454<<ASSIGN
FS$FINST.ENTRIES.TOTLEN
     16061**DCL     20150<<ASSIGN  20316<<ASSIGN
FS$FINST.ENTRIES.TYPE
     16054**DCL     18500<<ASSIGN  18502<<ASSIGN  18504<<ASSIGN  18506<<ASSIGN  18508<<ASSIGN  18510<<ASSIGN
     18512<<ASSIGN  18514<<ASSIGN  18516<<ASSIGN  18518<<ASSIGN  18520<<ASSIGN  18522<<ASSIGN  18524<<ASSIGN
     18526<<ASSIGN  18528<<ASSIGN  18530<<ASSIGN  18532<<ASSIGN  18534<<ASSIGN  18536<<ASSIGN  18538<<ASSIGN
     18540<<ASSIGN  18542<<ASSIGN  18544<<ASSIGN  18546<<ASSIGN  18548<<ASSIGN  18550<<ASSIGN  18577<<ASSIGN
     18582<<ASSIGN
FS$FINST.INTR
     16043**DCL     18202<<ASSIGN  18212<<ASSIGN
FS$FINST.NUM_ENTRIES
     16044**DCL     18216<<ASSIGN  18240>>IF      18244>>IF      18382<<ASSIGN  18625<<ASSIGN  18646<<ASSIGN
     20113>>ASSIGN  20148>>ASSIGN  20164>>ASSIGN  20284>>ASSIGN  20305>>ASSIGN  20331>>ASSIGN
FS$FINST.REPEATS
     16042**DCL     18204<<ASSIGN  18214<<ASSIGN  18282<<ASSIGN  18312<<ASSIGN  18390>>IF      18391<<ASSIGN
FS$FORMREC
     15942**DCL     20001--DCLINIT
FS$FORMREC.ACCSDISP
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:475  
     15946**DCL     16776>>IF      16780>>ASSIGN  17288<<ASSIGN  20043<<ASSIGN  20045<<ASSIGN
FS$FORMREC.ACCTDISP
     15944**DCL     16746>>IF      16750>>ASSIGN  17409<<ASSIGN  20065<<ASSIGN  20067<<ASSIGN
FS$FORMREC.ALGNDISP
     15948**DCL     16768>>IF      16772>>ASSIGN  18245<<ASSIGN  18386<<ASSIGN  18629<<ASSIGN  20261<<ASSIGN
     20264<<ASSIGN
FS$FORMREC.ATTR
     15965**DCL     17078--ASSIGN  17518<<ASSIGN
FS$FORMREC.BANRDISP
     15947**DCL     16760>>IF      16764>>ASSIGN  18241<<ASSIGN  18384<<ASSIGN  18627<<ASSIGN  20086<<ASSIGN
     20089<<ASSIGN
FS$FORMREC.CHAINIMAGE
     16000**DCL     17519<<ASSIGN
FS$FORMREC.CHAINS
     15990**DCL     16000--REDEF
FS$FORMREC.CHAIN_NAME
     15989**DCL     17520<<ASSIGN
FS$FORMREC.FLAGS
     15949**DCL     17234<<ASSIGN
FS$FORMREC.FNAME
     15943**DCL     16513>>IF      16571>>CALLBLT 16705>>IF      16745>>ASSIGN  16912<<ASSIGN  16914<<ASSIGN
FS$FORMREC.GRAPHIC
     15951**DCL     16462>>IF      16486>>IF      16676>>IF      16700>>IF
FS$FORMREC.LGLTYPS
     15958**DCL     17517<<ASSIGN
FS$FORMREC.LGLTYPS.ELSOK
     15961**DCL     16603>>ASSIGN  16738>>ASSIGN  16938>>IF      19956>>IF      19957<<ASSIGN
FS$FORMREC.LGLTYPS.LPOK
     15959**DCL     16601>>ASSIGN  16736>>ASSIGN  16930>>IF      19945>>IF      19946<<ASSIGN
FS$FORMREC.LGLTYPS.TSOK
     15960**DCL     16602>>ASSIGN  16737>>ASSIGN  16934>>IF      19950>>IF      19951<<ASSIGN
FS$FORMREC.SETUPDISP
     15945**DCL     16753>>IF      16757>>ASSIGN  18095<<ASSIGN  20239<<ASSIGN  20244<<ASSIGN
FS$FORMREC.SOFTFORM.VFUIM.V
     15986**DCL     17073>>IF      17584<<ASSIGN  17956<<ASSIGN  18011<<ASSIGN
FS$FORMREC.SOFTFORM.VFUIM.V.LINE
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:476  
     15987**DCL     17635<<ASSIGN  17641<<ASSIGN  17684>>IF      17883>>ASSIGN  17887>>ASSIGN
FS$FORMREC.SOFTFORM.VFUIM.V.NEXT
     15988**DCL     17642<<ASSIGN  17885>>ASSIGN  17889>>ASSIGN
FS$FORMREC.SOFTFORM.VLPPLATEN.EXTWID
     15979**DCL     17110<<ASSIGN  17113<<ASSIGN
FS$FORMREC.SOFTFORM.VLPPLATEN.FIRSTLINE
     15977**DCL     16565>>ASSIGN  16739>>ASSIGN  16794>>ASSIGN  17179<<ASSIGN
FS$FORMREC.SOFTFORM.VLPPLATEN.LENGTH
     15975**DCL     16565>>ASSIGN  16739>>ASSIGN  16794>>ASSIGN  17120>>IF      17122<<ASSIGN  17757>>ASSIGN
     17903>>ASSIGN
FS$FORMREC.SOFTFORM.VLPPLATEN.LIMBO
     15976**DCL     16565>>ASSIGN  16739>>ASSIGN  16794>>ASSIGN  17150>>IF      17151<<ASSIGN  17758>>IF
     17904>>IF
FS$FORMREC.SOFTFORM.VLPPLATEN.LPI
     15980**DCL     17206<<ASSIGN
FS$FORMREC.SOFTFORM.VLPPLATEN.WIDTH
     15974**DCL     17114<<ASSIGN
FS$GBAN
     15882**DCL     20004--DCLINIT
FS$GBAN.ALIGNCTL.EVERY
     15885**DCL     19467<<ASSIGN
FS$GBAN.CHARGE
     15883**DCL     15884--REDEF   19348<<ASSIGN  19357<<ASSIGN  19415<<ASSIGN  19417<<ASSIGN
FS$GBAN.ENTRIES.CHARSIZE
     15900**DCL     15906--REDEF
FS$GBAN.ENTRIES.CHARSIZE.CHARSIZE_OPCODE.CLASS
     15902**DCL     19524<<ASSIGN
FS$GBAN.ENTRIES.CHARSIZE.CHARSIZE_OPCODE.INDX
     15903**DCL     19525<<ASSIGN
FS$GBAN.ENTRIES.CHARSIZE.CHAR_HITE
     15905**DCL     19535<<ASSIGN  19620<<ASSIGN
FS$GBAN.ENTRIES.CHARSIZE.CHAR_WIDTH
     15904**DCL     19534<<ASSIGN  19615<<ASSIGN
FS$GBAN.ENTRIES.CHARSPACE
     15909**DCL     15914--REDEF
FS$GBAN.ENTRIES.CHARSPACE.CHARSPACE_OPCODE.CLASS
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:477  
     15911**DCL     19526<<ASSIGN
FS$GBAN.ENTRIES.CHARSPACE.CHARSPACE_OPCODE.INDX
     15912**DCL     19527<<ASSIGN
FS$GBAN.ENTRIES.CHARSPACE.CHAR_SPACE
     15913**DCL     19538<<ASSIGN  19625<<ASSIGN
FS$GBAN.ENTRIES.CHARUP
     15891**DCL     15898--REDEF
FS$GBAN.ENTRIES.CHARUP.CHARUP_OPCODE.CLASS
     15893**DCL     19522<<ASSIGN
FS$GBAN.ENTRIES.CHARUP.CHARUP_OPCODE.INDX
     15894**DCL     19523<<ASSIGN
FS$GBAN.ENTRIES.CHARUP.X
     15895**DCL     19531<<ASSIGN  19571<<ASSIGN  19576<<ASSIGN  19581<<ASSIGN  19586<<ASSIGN
FS$GBAN.ENTRIES.CHARUP.Y
     15896**DCL     19532<<ASSIGN  19572<<ASSIGN  19577<<ASSIGN  19582<<ASSIGN  19587<<ASSIGN
FS$GBAN.ENTRIES.CHARUP.Z
     15897**DCL     19533<<ASSIGN  19573<<ASSIGN  19578<<ASSIGN  19583<<ASSIGN  19588<<ASSIGN
FS$GBAN.ENTRIES.CHAR_HITE
     15908**DCL     19537<<ASSIGN  19617<<ASSIGN
FS$GBAN.ENTRIES.CHAR_SPACE
     15915**DCL     19539<<ASSIGN  19622<<ASSIGN
FS$GBAN.ENTRIES.CHAR_WIDTH
     15907**DCL     19536<<ASSIGN  19612<<ASSIGN
FS$GBAN.ENTRIES.CHR
     15924**DCL     19741<<ASSIGN
FS$GBAN.ENTRIES.COUNT
     15923**DCL     15924--REDEF   19540<<ASSIGN  19796<<ASSIGN  20106>>ASSIGN  20277>>ASSIGN
FS$GBAN.ENTRIES.DIRECTION
     15899**DCL     19530<<ASSIGN  19570<<ASSIGN  19575<<ASSIGN  19580<<ASSIGN  19585<<ASSIGN
FS$GBAN.ENTRIES.DISP
     15925**DCL     19541<<ASSIGN  19801<<ASSIGN  20100>>IF      20107>>ASSIGN  20176>>IF      20178<<ASSIGN
     20178>>ASSIGN  20275>>IF      20278>>ASSIGN  20345>>IF      20347<<ASSIGN  20347>>ASSIGN
FS$GBAN.ENTRIES.MARK
     15928**DCL     19470--IF      19772--IF      20144<<ASSIGN  20309<<ASSIGN
FS$GBAN.ENTRIES.NDC_X_VAL
     15919**DCL     19556<<ASSIGN
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:478  
FS$GBAN.ENTRIES.NDC_Y_VAL
     15920**DCL     19561<<ASSIGN
FS$GBAN.ENTRIES.NDC_Z_VAL
     15921**DCL     19529<<ASSIGN  19566<<ASSIGN
FS$GBAN.ENTRIES.TOTLEN
     15926**DCL     20143<<ASSIGN  20310<<ASSIGN
FS$GBAN.ENTRIES.TYPE
     15922**DCL     19663<<ASSIGN  19665<<ASSIGN  19667<<ASSIGN  19669<<ASSIGN  19671<<ASSIGN  19673<<ASSIGN
     19675<<ASSIGN  19677<<ASSIGN  19679<<ASSIGN  19681<<ASSIGN  19683<<ASSIGN  19685<<ASSIGN  19687<<ASSIGN
     19689<<ASSIGN  19691<<ASSIGN  19693<<ASSIGN  19695<<ASSIGN  19697<<ASSIGN  19699<<ASSIGN  19701<<ASSIGN
     19703<<ASSIGN  19705<<ASSIGN  19707<<ASSIGN  19709<<ASSIGN  19711<<ASSIGN  19713<<ASSIGN  19740<<ASSIGN
     19745<<ASSIGN
FS$GBAN.ENTRIES.X_VAL
     15916**DCL     19553<<ASSIGN
FS$GBAN.ENTRIES.Y_VAL
     15917**DCL     19558<<ASSIGN
FS$GBAN.ENTRIES.Z_VAL
     15918**DCL     19528<<ASSIGN  19563<<ASSIGN
FS$GBAN.INTR
     15888**DCL     19347<<ASSIGN  19356<<ASSIGN
FS$GBAN.NUM_ENTRIES
     15889**DCL     19359<<ASSIGN  19384>>IF      19388>>IF      19490<<ASSIGN  19789<<ASSIGN  19810<<ASSIGN
     20097>>ASSIGN  20141>>ASSIGN  20161>>ASSIGN  20272>>ASSIGN  20326>>ASSIGN
FS$GBAN.REPEATS
     15887**DCL     19360<<ASSIGN  19423<<ASSIGN  19498>>IF      19499<<ASSIGN
FS$GFORMREC
     15822**DCL     20002--DCLINIT
FS$GFORMREC.ACCSDISP
     15826**DCL     18864<<ASSIGN
FS$GFORMREC.ACCTDISP
     15824**DCL     18993<<ASSIGN
FS$GFORMREC.ALGNDISP
     15828**DCL     19389<<ASSIGN  19494<<ASSIGN  19793<<ASSIGN
FS$GFORMREC.ATTR
     15845**DCL     19115<<ASSIGN  19116<<ASSIGN  19117<<ASSIGN  19117>>ASSIGN
FS$GFORMREC.BANRDISP
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:479  
     15827**DCL     19385<<ASSIGN  19492<<ASSIGN  19791<<ASSIGN
FS$GFORMREC.CHAIN_NAME
     15846**DCL     19118<<ASSIGN
FS$GFORMREC.LGLTYPS
     15838**DCL     19114<<ASSIGN
FS$GFORMREC.LGLTYPS.ELSOK
     15841**DCL     16732>>ASSIGN  19937>>IF      19938<<ASSIGN
FS$GFORMREC.LGLTYPS.LPOK
     15839**DCL     16730>>ASSIGN  19926>>IF      19927<<ASSIGN
FS$GFORMREC.LGLTYPS.TSOK
     15840**DCL     16731>>ASSIGN  19931>>IF      19932<<ASSIGN
FS$GFORMREC.SETUPDISP
     15825**DCL     19238<<ASSIGN
FS$GFORMREC.SET_DEV_LIM
     15853**DCL     15870--REDEF
FS$GFORMREC.SET_DEV_LIM.DEV_LIM_OPCODE.CLASS
     15855**DCL     18755<<ASSIGN
FS$GFORMREC.SET_DEV_LIM.DEV_LIM_OPCODE.INDX
     15856**DCL     18756<<ASSIGN
FS$GFORMREC.SET_DEV_LIM.UPARAM
     15867**DCL     18832<<ASSIGN
FS$GFORMREC.SET_DEV_LIM.X_OFFSET
     15860**DCL     18809<<ASSIGN
FS$GFORMREC.SET_DEV_LIM.X_SIZE
     15857**DCL     18788<<ASSIGN
FS$GFORMREC.SET_DEV_LIM.Y_OFFSET
     15861**DCL     18816<<ASSIGN
FS$GFORMREC.SET_DEV_LIM.Y_SIZE
     15858**DCL     18795<<ASSIGN
FS$GFORMREC.SET_DEV_LIM.Z_OFFSET
     15862**DCL     18823<<ASSIGN
FS$GFORMREC.SET_DEV_LIM.Z_SIZE
     15859**DCL     18802<<ASSIGN
FS$GFORMREC.TRANSLGL
     15830**DCL     18782<<ASSIGN
FS$GFORMREC.X_OFFSET
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:480  
     15850**DCL     18810<<ASSIGN
FS$GFORMREC.X_SIZE
     15847**DCL     18789<<ASSIGN
FS$GFORMREC.Y_OFFSET
     15851**DCL     18817<<ASSIGN
FS$GFORMREC.Y_SIZE
     15848**DCL     18796<<ASSIGN
FS$GFORMREC.Z_OFFSET
     15852**DCL     18824<<ASSIGN
FS$GFORMREC.Z_SIZE
     15849**DCL     18803<<ASSIGN
FS$SETUP.LINES
     16096**DCL     18042<<ASSIGN  18094<<ASSIGN  19181<<ASSIGN  19235<<ASSIGN  20245>>ASSIGN
FS$SETUP.TXT
     16099**DCL     18040<<ASSIGN  18049<<ASSIGN  19179<<ASSIGN  19190<<ASSIGN
F_ACCESS_LOOP_END IN PROCEDURE FORM_OPTS
     17363**LABEL   17314--GOTO
F_ACCOUNT_LOOP_END IN PROCEDURE FORM_OPTS
     17484**LABEL   17435--GOTO
F_A_OR_B_LIST
     16328**DCL     18193--ASSIGN  18495--ASSIGN  18573--ASSIGN  18606--ASSIGN  18644--ASSIGN  19338--ASSIGN
     19658--ASSIGN  19736--ASSIGN  19769--ASSIGN  19808--ASSIGN
F_VFU_LIST
     16329**DCL     17582--ASSIGN
GENTRYLEN IN PROCEDURE FORM_GATHER
     20004**DCL     20033>>ASSIGN
GET_OPTS
     16787**LABEL   16785--REMEMBR
GET_VFU_VAL IN PROCEDURE VFUIM
     17678**PROC    17632--CALL    17638--CALL
GFIXED_LENGTH IN PROCEDURE FORM_GATHER
     20002**DCL     20032>>ASSIGN
GFORM_OPTS
     18659**PROC    16789--CALL
GFORM_OPTS_LIST
     16326**DCL     18753--ASSIGN
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:481  
GPSEUDO_OPTS_LIST
     16327**DCL     18750--ASSIGN
GRAPHIC
     16214**DCL     16397<<ASSIGN  16401<<ASSIGN  16462>>IF      16486>>IF      16488<<ASSIGN  16560>>IF
     16640>>IF      16676>>IF      16702<<ASSIGN  16728>>IF      16787>>IF      19924>>IF      20030>>IF
     20095>>IF      20139>>IF      20159>>IF      20174>>IF      20270>>IF      20306>>IF      20324>>IF
     20343>>IF
I
     16193**DCL     16398<<DOINDEX 16399>>IF      16929<<ASSIGN  16932<<ASSIGN  16936<<ASSIGN  16940<<ASSIGN
     16942>>IF
I IN PROCEDURE FORM_GATHER
     20014**DCL     20099<<DOINDEX 20100>>IF      20106>>ASSIGN  20107>>ASSIGN  20115<<DOINDEX 20116>>IF
     20122>>ASSIGN  20123>>ASSIGN  20142<<DOINDEX 20143>>ASSIGN  20144>>ASSIGN  20149<<DOINDEX 20150>>ASSIGN
     20151>>ASSIGN  20173<<DOINDEX 20176>>IF      20178>>ASSIGN  20178>>ASSIGN  20182>>IF      20184>>ASSIGN
     20184>>ASSIGN  20274<<DOINDEX 20275>>IF      20277>>ASSIGN  20278>>ASSIGN  20286<<DOINDEX 20287>>IF
     20289>>ASSIGN  20290>>ASSIGN  20308<<DOINDEX 20309>>ASSIGN  20310>>ASSIGN  20314<<DOINDEX 20315>>ASSIGN
     20316>>ASSIGN  20342<<DOINDEX 20345>>IF      20347>>ASSIGN  20347>>ASSIGN  20351>>IF      20353>>ASSIGN
     20353>>ASSIGN
I IN PROCEDURE FORM_OPTS
     17023**DCL     18225<<DOINDEX 18226>>ASSIGN  18276>>ASSIGN
I IN PROCEDURE GFORM_OPTS
     18716**DCL     19369<<DOINDEX 19370>>ASSIGN  19420>>ASSIGN
I IN PROCEDURE MOD_PSEUDO_FORMS
     19894**DCL     19904<<ASSIGN  19907<<ASSIGN  19911<<ASSIGN  19915<<ASSIGN  19917>>IF      19968<<CALLBLT
     19969>>ASSIGN
I IN PROCEDURE SETUP
     19162**DCL     18039<<DOINDEX 18040>>ASSIGN  18044<<ASSIGN  18045>>DOUNTIL 18049>>ASSIGN  18050<<ASSIGN
     18050>>ASSIGN  18074>>IF      18094>>ASSIGN  18095>>IF      19178<<DOINDEX 19179>>ASSIGN  19183<<ASSIGN
     19184>>DOUNTIL 19190>>ASSIGN  19191<<ASSIGN  19191>>ASSIGN  19215>>IF      19235>>ASSIGN  19236>>IF
I IN PROCEDURE VFUIM
     17571**DCL     17593<<DOINDEX 17594>>ASSIGN
IN_BUF
     12944**DCL     17049<>CALL    17589<>CALL    18045>>DOUNTIL 18046<>CALL    18047>>IF      18049>>ASSIGN
     18220<>CALL    18466<>CALL    18636>>ASSIGN  18758<>CALL    19184>>DOUNTIL 19185<>CALL    19186>>IF
     19190>>ASSIGN  19364<>CALL    19629<>CALL    19800>>ASSIGN
J IN PROCEDURE CHECK_VFU_VAL
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:482  
     17900**DCL     17903<<ASSIGN  17905>>IF      17910<<ASSIGN  17910>>ASSIGN  17935<>CALL    17961>>IF
     17990<>CALL
J IN PROCEDURE FORM_OPTS
     17024**DCL     17054<<DOINDEX 17055>>ASSIGN
J IN PROCEDURE GET_VFU_VAL
     17680**DCL     17683<<DOINDEX 17684>>IF      17757<<ASSIGN  17759>>IF      17763<<ASSIGN  17763>>ASSIGN
     17772<>CALL    17813>>IF      17825<>CALL
J IN PROCEDURE GFORM_OPTS
     18717**DCL     18763<<DOINDEX 18764>>ASSIGN
J IN PROCEDURE MOD_PSEUDO_FORMS
     19895**DCL     19923<<ASSIGN  19929<<ASSIGN  19933>>IF      19933<<ASSIGN  19934>>CALLBLT 19935<<ASSIGN
     19935>>ASSIGN  19939>>IF      19939<<ASSIGN  19939>>ASSIGN  19940>>CALLBLT 19941<<ASSIGN  19941>>ASSIGN
     19948<<ASSIGN  19952>>IF      19952<<ASSIGN  19953>>CALLBLT 19954<<ASSIGN  19954>>ASSIGN  19958>>IF
     19958<<ASSIGN  19958>>ASSIGN  19959>>CALLBLT 19960<<ASSIGN  19960>>ASSIGN  19963>>IF      19971>>ASSIGN
K IN PROCEDURE FORM_OPTS
     17025**DCL     17290<<DOINDEX 17291>>ASSIGN  17317>>ASSIGN  17411<<DOINDEX 17412>>ASSIGN  17438>>ASSIGN
     17636<<DOINDEX 17637>>ASSIGN  18422<<DOINDEX 18423>>ASSIGN  18425>>DOSELCT
K IN PROCEDURE GFORM_OPTS
     18718**DCL     18867<<DOINDEX 18868>>ASSIGN  18892>>ASSIGN  18997<<DOINDEX 18998>>ASSIGN  19026>>ASSIGN
     19542<<DOINDEX 19543>>ASSIGN  19544>>IF      19551>>DOSELCT
KL_DEFAULT.PASSWORD
     15564**DCL     15568--REDEF
KL_DEFAULT.RENAME
     15587**DCL     15588--REDEF
KL_DFLT.PASSWORD
     14754**DCL     14758--REDEF
KL_DFLT.RENAME
     14777**DCL     14778--REDEF
KL_DREC.PASSWORD
     14592**DCL     14596--REDEF
KL_DREC.RENAME
     14615**DCL     14616--REDEF
KL_DREC_CNT.PASSWORD
     14479**DCL     14483--REDEF
KL_DREC_CNT.RENAME
     14502**DCL     14503--REDEF
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:483  
L IN PROCEDURE FORM_OPTS
     17026**DCL     17321<<ASSIGN  17322>>DOWHILE 17323>>IF      17325<<ASSIGN  17325>>ASSIGN  17350>>ASSIGN
     17351>>ASSIGN  17355>>DOINDEX 17442<<ASSIGN  17443>>DOWHILE 17444>>IF      17446<<ASSIGN  17446>>ASSIGN
     17471>>ASSIGN  17472>>ASSIGN  17476>>DOINDEX
L IN PROCEDURE GFORM_OPTS
     18719**DCL     18896<<ASSIGN  18899>>DOWHILE 18900>>IF      18905>>DOINDEX 18914<<ASSIGN  18914>>ASSIGN
     18942>>ASSIGN  18943>>ASSIGN  19030<<ASSIGN  19033>>DOWHILE 19034>>IF      19039>>DOINDEX 19048<<ASSIGN
     19048>>ASSIGN  19076>>ASSIGN  19077>>ASSIGN
LPOK
     16212**DCL     16596<<ASSIGN  16601<<ASSIGN  16730<<ASSIGN  16736<<ASSIGN  16924>>ASSIGN  16930>>IF
     16931<<ASSIGN  19905>>IF      19926>>IF      19945>>IF
M IN PROCEDURE FORM_OPTS
     17027**DCL     17355<<DOINDEX 17356>>ASSIGN  17356>>ASSIGN  17476<<DOINDEX 17477>>ASSIGN  17477>>ASSIGN
M IN PROCEDURE GFORM_OPTS
     18720**DCL     18905<<DOINDEX 18906>>ASSIGN  18906>>ASSIGN  19039<<DOINDEX 19040>>ASSIGN  19040>>ASSIGN
MAX_VAL IN PROCEDURE CHANGE162_9X9
     19823**DCL     19821--PROC    19826>>IF      19847<>CALL
MERR_CODE.CODE
     12949**DCL     17523>>IF      19121>>IF
MOD_PSEUDO_FORMS
     19892**PROC    16942--CALL
MORE IN PROCEDURE BANNER
     19322**DCL     18217<<ASSIGN  18218>>DOWHILE 19361<<ASSIGN  19362>>DOWHILE
MORE IN PROCEDURE VFUIM
     17569**DCL     17583<<ASSIGN  17587>>DOWHILE
MOVE_CNT
     16200**DCL     16201--IMP-SIZ 16749<<ASSIGN  16751>>ASSIGN  16751>>ASSIGN  16756<<ASSIGN  16758>>ASSIGN
     16758>>ASSIGN  16763<<ASSIGN  16765>>ASSIGN  16765>>ASSIGN  16771<<ASSIGN  16773>>ASSIGN  16773>>ASSIGN
     16779<<ASSIGN  16781>>ASSIGN  16781>>ASSIGN  20057<<ASSIGN  20058>>ASSIGN  20058>>ASSIGN  20079<<ASSIGN
     20080>>ASSIGN  20080>>ASSIGN  20131<<ASSIGN  20132>>ASSIGN  20132>>ASSIGN  20190<<ASSIGN  20191>>ASSIGN
     20191>>ASSIGN  20209<<ASSIGN  20210>>ASSIGN  20210>>ASSIGN  20254<<ASSIGN  20255>>ASSIGN  20255>>ASSIGN
     20298<<ASSIGN  20299>>ASSIGN  20299>>ASSIGN  20359<<ASSIGN  20360>>ASSIGN  20360>>ASSIGN  20378<<ASSIGN
     20379>>ASSIGN  20379>>ASSIGN
NEW_BNRDISP IN PROCEDURE FORM_GATHER
     20007**DCL     20172<<ASSIGN  20178>>ASSIGN  20184>>ASSIGN  20341<<ASSIGN  20347>>ASSIGN  20353>>ASSIGN
NEW_TOTAL_LINES
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:484  
     16210**DCL     16790<<ASSIGN  16794<<ASSIGN  16798>>IF      16824<>CALL    16887<>CALL
NEXT IN PROCEDURE CHECK_VFU_IMAGE
     17879**DCL     17885<<ASSIGN  17886>>DOWHILE 17887>>ASSIGN  17889<<ASSIGN
NEXT IN PROCEDURE MOD_PSEUDO_FORMS
     19989**LABEL   19922--CALLALT
NEXT IN PROCEDURE VFUIM
     17576**DCL     17586<<ASSIGN  17641>>ASSIGN  17642>>ASSIGN  17643>>ASSIGN  17644<<ASSIGN  17644>>ASSIGN
NODE$
     12946**DCL     16241--IMP-PTR 16388<<ASSIGN  16389>>IF      16398>>DOINDEX 16399>>IF      16408>>ASSIGN
     16607>>ASSIGN  16609>>IF      16611>>ASSIGN  17052<<ASSIGN  17053>>ASSIGN  17055>>ASSIGN  17592<<ASSIGN
     17593>>DOINDEX 17594>>ASSIGN  18223<<ASSIGN  18224>>ASSIGN  18226>>ASSIGN  18276>>ASSIGN  18761<<ASSIGN
     18762>>ASSIGN  18764>>ASSIGN  19367<<ASSIGN  19368>>ASSIGN  19370>>ASSIGN  19420>>ASSIGN
NUM IN PROCEDURE VFUIM
     17570**DCL     17585<<ASSIGN  17633<<ASSIGN  17633>>ASSIGN  17634>>IF      17639<<ASSIGN  17639>>ASSIGN
     17640>>IF
OLD_ALGN
     16203**DCL     16774<<ASSIGN  17379<<ASSIGN  18211<<ASSIGN  18962<<ASSIGN  19355<<ASSIGN  20265>>IF
     20269<<ASSIGN
OLD_BANNER
     16202**DCL     16766<<ASSIGN  17375<<ASSIGN  18201<<ASSIGN  18958<<ASSIGN  19346<<ASSIGN  20090>>IF
     20094<<ASSIGN
OLD_TOTAL_LINES
     16209**DCL     16562<<ASSIGN  16565<<ASSIGN  16733<<ASSIGN  16739<<ASSIGN  16798>>IF      16832<>CALL
     16879<>CALL
ONEBIT IN PROCEDURE FORM_OPTS
     17038**DCL     17079<<ASSIGN
OPTS_ERR IN PROCEDURE FORM_OPTS
     17565**LABEL   17051--CALLALT
OPTS_ERR IN PROCEDURE GFORM_OPTS
     19156**LABEL   18760--CALLALT
OP_CODE IN PROCEDURE FORM_OPTS
     17031**DCL     17058<<ASSIGN  17061<<ASSIGN  17556>>IF      18229<<ASSIGN  18230<<ASSIGN  18249>>IF
     18270>>IF      18359>>ASSIGN
OP_CODE IN PROCEDURE GFORM_OPTS
     18725**DCL     18767<<ASSIGN  18770<<ASSIGN  19373<<ASSIGN  19374<<ASSIGN  19393>>IF      19414>>IF
     19467>>ASSIGN
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:485  
OUT$SYM.COUNT
     16310**DCL     16313--IMP-SIZ 16412>>IF      16435>>ASSIGN  16515>>ASSIGN  16516>>ASSIGN  16613>>IF
     16636>>ASSIGN  16707>>ASSIGN  16708>>ASSIGN  17084>>CALLBLT 17118>>CALLBLT 17148>>CALLBLT 17177>>CALLBLT
     17204>>CALLBLT 17232>>CALLBLT 17292>>IF      17297>>ASSIGN  17298>>ASSIGN  17317>>ASSIGN  17323>>IF
     17331>>ASSIGN  17332>>ASSIGN  17350>>ASSIGN  17413>>IF      17418>>ASSIGN  17419>>ASSIGN  17438>>ASSIGN
     17444>>IF      17452>>ASSIGN  17453>>ASSIGN  17471>>ASSIGN  17488>>IF      17511>>ASSIGN  17512>>CALLBLT
     17512>>CALLBLT 17520>>ASSIGN  17530>>ASSIGN  17531>>ASSIGN  17608>>CALLBLT 17682>>CALLBLT 18277>>CALLBLT
     18424>>CALLBLT 18552>>IF      18578>>ASSIGN  18828>>CALLBLT 18869>>IF      18871>>ASSIGN  18872>>ASSIGN
     18892>>ASSIGN  18900>>IF      18922>>ASSIGN  18923>>ASSIGN  18942>>ASSIGN  18999>>IF      19005>>ASSIGN
     19006>>ASSIGN  19026>>ASSIGN  19034>>IF      19056>>ASSIGN  19057>>ASSIGN  19076>>ASSIGN  19085>>IF
     19108>>ASSIGN  19109>>CALLBLT 19109>>CALLBLT 19118>>ASSIGN  19128>>ASSIGN  19129>>ASSIGN  19421>>CALLBLT
     19715>>IF      19741>>ASSIGN  19825>>CALLBLT
OUT$SYM.TEXT
     16313**DCL     16435>>ASSIGN  16516>>ASSIGN  16636>>ASSIGN  16708>>ASSIGN  17084>>CALLBLT 17118>>CALLBLT
     17148>>CALLBLT 17177>>CALLBLT 17204>>CALLBLT 17232>>CALLBLT 17298>>ASSIGN  17317>>ASSIGN  17323>>IF
     17332>>ASSIGN  17350>>ASSIGN  17419>>ASSIGN  17438>>ASSIGN  17444>>IF      17453>>ASSIGN  17471>>ASSIGN
     17512>>CALLBLT 17520>>ASSIGN  17531>>ASSIGN  17608>>CALLBLT 17682>>CALLBLT 18277>>CALLBLT 18424>>CALLBLT
     18578>>ASSIGN  18828>>CALLBLT 18872>>ASSIGN  18892>>ASSIGN  18900>>IF      18923>>ASSIGN  18942>>ASSIGN
     19006>>ASSIGN  19026>>ASSIGN  19034>>IF      19057>>ASSIGN  19076>>ASSIGN  19109>>CALLBLT 19118>>ASSIGN
     19129>>ASSIGN  19421>>CALLBLT 19741>>ASSIGN  19825>>CALLBLT
P$NODE.CODE
     16249**DCL     16389>>IF      16399>>IF      16609>>IF      17056>>ASSIGN  17061>>ASSIGN  17595>>ASSIGN
     18227>>ASSIGN  18230>>ASSIGN  18470>>ASSIGN  18765>>ASSIGN  18770>>ASSIGN  19371>>ASSIGN  19374>>ASSIGN
     19633>>ASSIGN
P$NODE.SUBLK$
     16274**DCL     16399>>IF      16408>>ASSIGN  16408>>ASSIGN  16609>>IF      16611>>ASSIGN  16611>>ASSIGN
     17055>>ASSIGN  17060>>ASSIGN  17291>>ASSIGN  17412>>ASSIGN  17487>>ASSIGN  17594>>ASSIGN  17606>>ASSIGN
     17631>>ASSIGN  17637>>ASSIGN  18226>>ASSIGN  18230>>ASSIGN  18276>>ASSIGN  18276>>ASSIGN  18423>>ASSIGN
     18552>>IF      18578>>ASSIGN  18578>>ASSIGN  18764>>ASSIGN  18769>>ASSIGN  18829>>ASSIGN  18868>>ASSIGN
     18998>>ASSIGN  19084>>ASSIGN  19370>>ASSIGN  19374>>ASSIGN  19420>>ASSIGN  19420>>ASSIGN  19543>>ASSIGN
     19715>>IF      19741>>ASSIGN  19741>>ASSIGN
P$NODE.SUBNODES
     16253**DCL     16398>>DOINDEX 16607>>ASSIGN  17053>>ASSIGN  17057>>IF      17267>>ASSIGN  17383>>ASSIGN
     17593>>DOINDEX 17636>>DOINDEX 18224>>ASSIGN  18228>>IF      18389>>ASSIGN  18762>>ASSIGN  18766>>IF
     18839>>ASSIGN  18965>>ASSIGN  19368>>ASSIGN  19372>>IF      19497>>ASSIGN
PARSE_ERR IN PROCEDURE BANNER
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:486  
     19817**LABEL   19366--CALLALT 19632--CALLALT
PROJ_KEY.TEXT
     12826**DCL     12826--REDEF
PROJ_KEY.TXT.PROJECT
     12826**DCL     12826--REDEF
PSEUDO_CMD
     16323**DCL     16384--ASSIGN
PSEUDO_FLAG
     15808**DCL         9--PROC    16361>>ASSIGN
PSEUDO_FLG
     16206**DCL     16361<<ASSIGN  16383>>IF      16513>>IF      16517>>IF      16558<<ASSIGN  16558>>ASSIGN
     16569>>IF      16726>>IF      16753>>IF      16768>>IF      16799>>IF      16911>>IF      16919>>IF
     16928>>IF      17045>>IF      18748>>IF
PSEUDO_FORMS
     16232**DCL     16411<<ASSIGN  16605<>CALL    16856>>IF      16928>>IF
PSEUDO_FORM_KEY
     16226**DCL     16573<>CALL    16605<>CALL    16908<>CALL    16926<>CALL    19898>>ASSIGN
PSEUDO_FORM_KEY.CNT
     16227**DCL     16570<<ASSIGN  16920<<ASSIGN
PSEUDO_FORM_KEY.TXT
     16228**DCL     16571<<CALLBLT 16921<<CALLBLT 19899>>ASSIGN
PSEUDO_FORM_REC
     16215**DCL     16573--CALL    16926--CALL    19901--ASSIGN  19902--CALL    19918--CALL    19918--CALL
     19990--ASSIGN  19991--CALL
PSEUDO_FORM_REC.ELSOK
     16218**DCL     16598>>ASSIGN  16922<<ASSIGN  19913>>IF      19914<<ASSIGN
PSEUDO_FORM_REC.LPOK
     16216**DCL     16596>>ASSIGN  16924<<ASSIGN  19905>>IF      19906<<ASSIGN
PSEUDO_FORM_REC.TSOK
     16217**DCL     16597>>ASSIGN  16923<<ASSIGN  19909>>IF      19910<<ASSIGN
PSEUDO_OPTS_LIST
     16325**DCL     17046--ASSIGN
PTR$ IN PROCEDURE BANNER
     19323**DCL     18226<<ASSIGN  18227>>ASSIGN  18228>>IF      18230>>ASSIGN  18389>>ASSIGN  18423>>ASSIGN
     19370<<ASSIGN  19371>>ASSIGN  19372>>IF      19374>>ASSIGN  19497>>ASSIGN  19543>>ASSIGN
PTR$ IN PROCEDURE FORM_OPTS
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:487  
     17028**DCL     17055<<ASSIGN  17056>>ASSIGN  17057>>IF      17060>>ASSIGN  17078<<ASSIGN  17079>>ASSIGN
     17267>>ASSIGN  17291>>ASSIGN  17383>>ASSIGN  17412>>ASSIGN
PTR$ IN PROCEDURE GFORM_OPTS
     18722**DCL     18764<<ASSIGN  18765>>ASSIGN  18766>>IF      18769>>ASSIGN  18829>>ASSIGN  18839>>ASSIGN
     18868>>ASSIGN  18965>>ASSIGN  18998>>ASSIGN
PTR$ IN PROCEDURE VFUIM
     17573**DCL     17594<<ASSIGN  17595>>ASSIGN  17606>>ASSIGN  17631>>ASSIGN  17636>>DOINDEX 17637>>ASSIGN
PTR2$ IN PROCEDURE FORM_OPTS
     17029**DCL     17060<<ASSIGN  17061>>ASSIGN  17083>>ASSIGN  17117>>ASSIGN  17147>>ASSIGN  17176>>ASSIGN
     17203>>ASSIGN  17231>>ASSIGN  17487>>ASSIGN  17606<<ASSIGN  17607>>ASSIGN
PTR2$ IN PROCEDURE GFORM_OPTS
     18723**DCL     18769<<ASSIGN  18770>>ASSIGN  18785>>ASSIGN  18792>>ASSIGN  18799>>ASSIGN  18806>>ASSIGN
     18813>>ASSIGN  18820>>ASSIGN  18827>>ASSIGN  19084>>ASSIGN
P_PCB
     12981**DCL     16387<>CALL    17051<>CALL    17591<>CALL    18222<>CALL    18469<>CALL    18760<>CALL
     19366<>CALL    19632<>CALL
P_PCB.ERROR
     13085**DCL     16947<>CALL    17549<>CALL    17565<>CALL    17673<>CALL    18653<>CALL    19147<>CALL
     19156<>CALL    19817<>CALL
P_PCB.NCHARS
     13128**DCL     17050<<ASSIGN  17590<<ASSIGN  18221<<ASSIGN  18468<<ASSIGN  18759<<ASSIGN  19365<<ASSIGN
     19631<<ASSIGN
P_PCB.OUT$
     12994**DCL     16388>>ASSIGN  17052>>ASSIGN  17592>>ASSIGN  18223>>ASSIGN  18470>>ASSIGN  18552>>IF
     18578>>ASSIGN  18578>>ASSIGN  18761>>ASSIGN  19367>>ASSIGN  19633>>ASSIGN  19715>>IF      19741>>ASSIGN
     19741>>ASSIGN
P_PCB.ROOT$
     12986**DCL     16384<<ASSIGN  16386<<ASSIGN  17046<<ASSIGN  17047<<ASSIGN  17582<<ASSIGN  18193<<ASSIGN
     18467<<ASSIGN  18495<<ASSIGN  18573<<ASSIGN  18606<<ASSIGN  18644<<ASSIGN  18750<<ASSIGN  18753<<ASSIGN
     19338<<ASSIGN  19630<<ASSIGN  19658<<ASSIGN  19736<<ASSIGN  19769<<ASSIGN  19808<<ASSIGN
REMEM_VAR
     12952**DCL     12952--REDEF   16785<<REMEMBR
REMOVED IN PROCEDURE GFORM_OPTS
     18743**DCL     18898<<ASSIGN  18911<<ASSIGN  18916>>IF      19031<<ASSIGN  19045<<ASSIGN  19050>>IF
REM_FCMD
     12952**DCL     12953--REDEF
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:488  
SETUP IN PROCEDURE FORM_OPTS
     18020**PROC    17262--CALL
SETUP IN PROCEDURE GFORM_OPTS
     19159**PROC    18835--CALL
SETUP$
     16350**DCL     16755<<ASSIGN  16758>>ASSIGN  18038<<ASSIGN  18040>>ASSIGN  18049>>ASSIGN  18094>>ASSIGN
     19177<<ASSIGN  19179>>ASSIGN  19190>>ASSIGN  19235>>ASSIGN  20237>>IF      20245>>ASSIGN  20255>>ASSIGN
     20256<<ASSIGN
SETUP_LENGTH IN PROCEDURE FORM_GATHER
     20013**DCL     20245<<ASSIGN  20246<<ASSIGN  20246>>ASSIGN  20247<<ASSIGN  20247>>ASSIGN  20254>>ASSIGN
     20257>>ASSIGN
SETUP_OFFSET
     16340**DCL     16755>>ASSIGN  18038>>ASSIGN  19177>>ASSIGN
SPLIT IN PROCEDURE GFORM_OPTS
     18735**DCL     18740--REDEF   18788>>ASSIGN  18795>>ASSIGN  18802>>ASSIGN  18809>>ASSIGN  18816>>ASSIGN
     18823>>ASSIGN  18832>>ASSIGN  19615>>ASSIGN  19620>>ASSIGN  19625>>ASSIGN  19879<<ASSIGN  19886<<ASSIGN
SPLIT.B IN PROCEDURE GFORM_OPTS
     18739**DCL     19881<<ASSIGN  19888<<ASSIGN
SPLIT.T IN PROCEDURE GFORM_OPTS
     18737**DCL     19880<<ASSIGN  19887<<ASSIGN
SPLIT_VAL IN PROCEDURE GFORM_OPTS
     19885**PROC    19555--CALL    19560--CALL    19565--CALL    19614--CALL    19619--CALL    19624--CALL
SPLIT_VAL.B IN PROCEDURE GFORM_OPTS
     18730**DCL     19881>>ASSIGN  19888>>ASSIGN
SPLIT_VAL.T IN PROCEDURE GFORM_OPTS
     18729**DCL     19880>>ASSIGN  19887>>ASSIGN
STRANGE_ERR IN PROCEDURE BANNER
     18655**LABEL   18469--CALLALT
SUBNODES IN PROCEDURE BANNER
     19327**DCL     18389<<ASSIGN  18392>>IF      18392>>IF      18422>>DOINDEX 19497<<ASSIGN  19500>>IF
     19500>>IF      19542>>DOINDEX
SUBNODES IN PROCEDURE FORM_OPTS
     17030**DCL     17053<<ASSIGN  17054>>DOINDEX
SUBNODES IN PROCEDURE GFORM_OPTS
     18724**DCL     18762<<ASSIGN  18763>>DOINDEX
SUBNS IN PROCEDURE BANNER
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:489  
     19328**DCL     18224<<ASSIGN  18225>>DOINDEX 18638<<ASSIGN  19368<<ASSIGN  19369>>DOINDEX 19802<<ASSIGN
SUBS
     16208**DCL     16607<<ASSIGN  17267<<ASSIGN  17288>>IF      17290>>DOINDEX 17383<<ASSIGN  17409>>IF
     17411>>DOINDEX 18839<<ASSIGN  18862>>IF      18867>>DOINDEX 18965<<ASSIGN  18991>>IF      18997>>DOINDEX
TEMPLATE
     16201**DCL     16751<<ASSIGN  16751>>ASSIGN  16758<<ASSIGN  16758>>ASSIGN  16765<<ASSIGN  16765>>ASSIGN
     16773<<ASSIGN  16773>>ASSIGN  16781<<ASSIGN  16781>>ASSIGN  20058<<ASSIGN  20058>>ASSIGN  20080<<ASSIGN
     20080>>ASSIGN  20132<<ASSIGN  20132>>ASSIGN  20191<<ASSIGN  20191>>ASSIGN  20210<<ASSIGN  20210>>ASSIGN
     20255<<ASSIGN  20255>>ASSIGN  20299<<ASSIGN  20299>>ASSIGN  20360<<ASSIGN  20360>>ASSIGN  20379<<ASSIGN
     20379>>ASSIGN
TEXT_LENGTH IN PROCEDURE FORM_GATHER
     20008**DCL     20203<<ASSIGN  20204<<ASSIGN  20204>>ASSIGN  20209>>ASSIGN  20211>>ASSIGN  20372<<ASSIGN
     20373<<ASSIGN  20373>>ASSIGN  20378>>ASSIGN  20380>>ASSIGN
TEXT_OFFSET
     16342**DCL     18198>>ASSIGN  18208>>ASSIGN  19343>>ASSIGN  19352>>ASSIGN  20204>>ASSIGN  20373>>ASSIGN
TRANSLGL_SET IN PROCEDURE FORM_OPTS
     17036**DCL     17041<<ASSIGN  17076>>IF      17555<<ASSIGN
TRANSLGL_VAL IN PROCEDURE FORM_OPTS
     17037**DCL     17079>>ASSIGN  17557<<ASSIGN  17559<<ASSIGN
TSOK
     16213**DCL     16597<<ASSIGN  16602<<ASSIGN  16731<<ASSIGN  16737<<ASSIGN  16923>>ASSIGN  16934>>IF
     16935<<ASSIGN  19909>>IF      19931>>IF      19950>>IF
UBINSPLIT IN PROCEDURE GFORM_OPTS
     18740**DCL     19556>>ASSIGN  19561>>ASSIGN  19566>>ASSIGN
USERS_KEY
     12823**DCL     19898<<ASSIGN  19900<>CALL    19918<>CALL    19989<>CALL
USERS_KEY.COUNT
     12823**DCL     19903>>DOWHILE
USERS_KEY.TEXT
     12823**DCL     12824--REDEF   12824--REDEF   12824--REDEF   12825--REDEF
USERS_KEY.TXTC
     12824**DCL     19903>>DOWHILE 19920>>ASSIGN
USE_LENGTH IN PROCEDURE FORM_GATHER
     20005**DCL     20032<<ASSIGN  20036<<ASSIGN  20039>>ASSIGN  20214>>IF
VAL IN PROCEDURE CHECK_VFU_IMAGE
     17877**DCL     17883<<ASSIGN  17887<<ASSIGN  17889>>ASSIGN  17905>>IF      17927<>CALL    17961>>IF
PL6.E3A0      #001=ASF$FORM File=ASF$FORM.:E05TSI                                TUE 07/29/97 09:50 Page:490  
     17982<>CALL
VAL IN PROCEDURE FORM_OPTS
     17032**DCL     17084<<CALLBLT 17085>>IF      17107>>IF      17109<<ASSIGN  17109>>ASSIGN  17114>>ASSIGN
     17118<<CALLBLT 17119>>IF      17120>>IF      17122>>ASSIGN  17148<<CALLBLT 17149>>IF      17150>>IF
     17151>>ASSIGN  17177<<CALLBLT 17178>>IF      17179>>ASSIGN  17204<<CALLBLT 17205>>IF      17206>>ASSIGN
     17232<<CALLBLT 17233>>IF      17234>>ASSIGN  17608<<CALLBLT 17609>>IF      17609>>IF      17630>>ASSIGN
     17635>>ASSIGN  17641>>ASSIGN  17682<<CALLBLT 17684>>IF      17696<>CALL    17736>>IF      17759>>IF
     17813>>IF      18277<<CALLBLT 18280>>IF      18282>>ASSIGN  18309>>IF      18309>>IF      18312>>ASSIGN
     18424<<CALLBLT 18427>>ASSIGN  18429>>ASSIGN  18431>>IF      18451>>ASSIGN  18454>>ASSIGN  18456>>ASSIGN
     18458>>ASSIGN  18460>>ASSIGN  18462>>ASSIGN
VAL IN PROCEDURE GFORM_OPTS
     18726**DCL     18727--REDEF   18731--REDEF   18789>>ASSIGN  18796>>ASSIGN  18803>>ASSIGN  18810>>ASSIGN
     18817>>ASSIGN  18824>>ASSIGN  19421<<CALLBLT 19422>>IF      19423>>ASSIGN  19553>>ASSIGN  19554<<ASSIGN
     19554>>ASSIGN  19558>>ASSIGN  19559<<ASSIGN  19559>>ASSIGN  19563>>ASSIGN  19564<<ASSIGN  19564>>ASSIGN
     19568>>DOSELCT 19612>>ASSIGN  19613<<ASSIGN  19613>>ASSIGN  19617>>ASSIGN  19618<<ASSIGN  19618>>ASSIGN
     19622>>ASSIGN  19623<<ASSIGN  19623>>ASSIGN  19825<<CALLBLT 19826>>IF      19839<>CALL
VFUIM IN PROCEDURE FORM_OPTS
     17568**PROC    17258--CALL
VFU_ERR IN PROCEDURE VFUIM
     17673**LABEL   17591--CALLALT
VFU_LOOP IN PROCEDURE VFUIM
     17587**LABEL   17628--GOTO    17632--CALLALT 17638--CALLALT 17674--GOTO
VFU_NUM IN PROCEDURE VFUIM
     17666**LABEL   17634--GOTO    17640--GOTO
X$PARSE
     16143**DCL-ENT 16387--CALL    17051--CALL    17591--CALL    18222--CALL    18469--CALL    18760--CALL
     19366--CALL    19632--CALL
