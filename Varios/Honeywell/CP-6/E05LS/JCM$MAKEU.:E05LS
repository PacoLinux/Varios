VERSION E05

PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:1    
        1        1        /*M* JCM$MAKEU User maker for SLUG ghost  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*DMC,PLM=6,IND=2,ENU=2,DCI=4,CSU=2,ECU=2,THI=2,DTI=0*/
        8        8        /**/
        9        9        /**/
       10       10        JCM$SETU: PROC   (UMODE,VJIT$,VM_UC$,VROSEG$,PP) ALTRET;
       11       11        /**/
       12       12        /**/
       13       13        %INCLUDE CP_6;
       14       94        %INCLUDE CP_6_SUBS;
       15      634        %INCLUDE B_LSDATA_C;
       16     3840        %INCLUDE B_SEGIDS_C;
       17     4379        %INCLUDE M_INFO_C;
       18     4519        %INCLUDE B$MAP;                         /* PAGE TABLE DEFINITIONS             */
       19     4618 S      %INCLUDE B$JIT_C;
       20     4619        %B$JIT0 (STCLASS=BASED);
       21     4708        %U$JIT1;
       22     4782        %M$JIT2;
       23     4792        %F$JIT3;
       24     4797        %S$JIT4;
       25     4803        %J$JIT5;
       26     4891        %A$JIT6;
       27     4901        %B$JIT0X (STCLASS="STATIC SYMDEF",B$JIT0=JC_JIT);
       28     4904        %U$JIT1X;
       29     4907        %M$JIT2X;
       30     4910        %F$JIT3X;
       31     4913        %S$JIT4X;
       32     4916        %J$JIT5X;
       33     4919        %A$JIT6X;
       34     4922        %INCLUDE F$DCB;
       35     4971        %INCLUDE B$ROSEG;
       36     5034        %INCLUDE JC_SCODE_C;
       37     5050        /**/
PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:2    
       38     5051        /**/
       39     5052    1   DCL UMODE UBIN WORD;      /*  UMODE = 5 IS CONSOLE GHOST */
       40     5053    1   DCL VJIT$ PTR;
       41     5054    1   DCL VM_UC$ PTR;
       42     5055    1   DCL VROSEG$ PTR;
       43     5056    1   DCL PP (0:2) UBIN WORD;
       44     5057    1   DCL VHJIT$ PTR;
       45     5058    1   DCL VPTR$ PTR;
       46     5059    1   DCL PBSE UBIN WORD;
       47     5060    1   DCL I SBIN;
       48     5061    1   DCL B$IS$ PTR SYMREF;
       49     5062    1   DCL 1 RSLT DALIGNED,
       50     5063    1         2 WORD1 SBIN,
       51     5064    1         2 PNO UBIN(36) UNAL;
       52     5065    1   DCL UCRES (0:5) CHAR(2) UNAL CONSTANT INIT('NO'*3,'UC','  '*2);
       53     5066    1   DCL UCASN (0:5) UBIN WORD CONSTANT INIT(%DEVICE#*4,%COMGROUP#*2);
       54     5067    1   DCL NXTCC (0:5) UBIN WORD CONSTANT INIT(%CC_FROMNO#,%CC_FROMJOB#,%CC_FROMNO#,%
              5067            CC_FROMUC#*3);
       55     5068    1   DCL JC_VBSE UBIN WORD STATIC SYMDEF INIT(100);
       56     5069    1   DCL B_UHJIT(0:1023) SBIN   SYMREF;
       57     5070    1   DCL JC_ROSEG (0:1023) UBIN WORD SYMREF;
       58     5071    1   DCL M_UC UBIN WORD SYMREF;              /* DUMMY */
       59     5072    1   DCL   JC_8000_FLG BIT(1) SYMREF;
       60     5073        %B_USRULS_8000 (FPTN=DPS8000_ULS,STCLASS=CONSTANT);
       61     5272        %B_USRULS_8000;
       62     5471    1   DCL JCM$RELJ ENTRY(2);
       63     5472    1   DCL FOI$CRASH ENTRY(3) ALTRET;
       64     5473        /**/
       65     5474        /**/
       66     5475        %FPT_STLPP (FPTN=FPT$STLPP,STCLASS=" ");
       67     5488        %FPT_STLPP (FPTN=STLPPC,STCLASS=CONSTANT);
       68     5501        %FPT_CVM (FPTN=FPT$CVM,STCLASS=" ");
       69     5517        %FPT_CVM (FPTN=CVMC,PHYSICAL=NO,STCLASS=CONSTANT);
       70     5533        /**/
       71     5534        %SUB F_JC='1203'O;
       72     5535        %SUB M_M='15'O;
       73     5536        /**/
PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:3    
       74     5537    1         FPT$CVM=CVMC;
       75     5538    1         FPT$CVM.V_=VECTOR(FPT$CVM.V);
       76     5539    1         FPT$STLPP=STLPPC;
       77     5540    1         FPT$STLPP.RESULTS_=VECTOR(RSLT);
       78     5541        /**/
       79     5542    2         DO INHIBIT;
       80     5543    2           PBSE=JC_VBSE;
       81     5544    2           JC_VBSE=JC_VBSE+3;
       82     5545    2         END;
       83     5546        /**/
       84     5547    1         VPTR$=PINCRW(B$IS$,PBSE*1024);   /* PTR TO NEW JIT PAGE                */
       85     5548    1         VJIT$ = VPTR$;
       86     5549    1         VHJIT$=PINCRW(B$IS$,(PBSE+1)*1024); /* PTR TO NEW HJIT PAGE           */
       87     5550    1         VROSEG$=PINCRW(B$IS$,(PBSE+2)*1024); /* PTR TO NEW ROSEG              */
       88     5551        /**/
       89     5552    2         DO I = 0 TO 2;
       90     5553    2           CALL M$STLPP(FPT$STLPP)  ALTRET(NOPAGE);
       91     5554    2           PP(I) = RSLT.PNO;            /* REMEMBER PHY PG NO.                */
       92     5555    2           FPT$CVM.V.PPNO# = RSLT.PNO;  /* SET UP FOR CVM                     */
       93     5556    2           FPT$CVM.V.VPNO# = PBSE + I;
       94     5557    2           CALL M$CVM(FPT$CVM) ALTRET(BADCVM); /* MAP IT IN                   */
       95     5558    2         END;
       96     5559        /*
       97     5560             GOT ALL THREE PAGES. NOW, SET UP INITIAL JIT, HJIT, & ROSEG
       98     5561             INFORMATION...
       99     5562        */
      100     5563    1         VPTR$->B$PAGE='0'B;
      101     5564    1         VJIT$->B$JIT=JC_JIT;
      102     5565    1         IF UMODE=5/*CONS GHOST*/
      103     5566    1           THEN VJIT$->B$JIT.MODE = %M_INT#; /* Cons ghosts look like M_INT */
      104     5567    1           ELSE VJIT$->B$JIT.MODE = UMODE;
      105     5568    1         VJIT$->B$JIT.NEXTCC=NXTCC(UMODE);
      106     5569        /**/
      107     5570    1         VHJIT$->B$PAGE=B_UHJIT;
      108     5571    1         IF JC_8000_FLG THEN
      109     5572    1           VHJIT$->B_USRULS_8000 = DPS8000_ULS;
      110     5573    1         VROSEG$->B$PAGE=JC_ROSEG;
PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:4    
      111     5574    1         IF UMODE=5 THEN VROSEG$->B$ROSEG.STREAM_VALID='34'O; /* Make 3 of 'em */
      112     5575    2           ELSE IF UMODE<%M_INT# THEN DO; /* Get rid of UC LDEVs if useless. */
      113     5576    2             VROSEG$->B$ROSEG.LDEVNAME(1)='    ';
      114     5577    2             VROSEG$->B$ROSEG.LDEVNAME(2)='    ';
      115     5578    2             VROSEG$->B$ROSEG.LDEVNAME(3)='    ';
      116     5579    2             VROSEG$->B$ROSEG.STREAMID(1)='0'B;
      117     5580    2             VROSEG$->B$ROSEG.STREAMID(2)='0'B;
      118     5581    2             VROSEG$->B$ROSEG.STREAMID(3)='0'B;
      119     5582    2           END;
      120     5583    1         VM_UC$=PINCRW(VROSEG$,POFFW(ADDR(M_UC),ADDR(JC_ROSEG)));
      121     5584    1         VM_UC$->F$DCB.RES=UCRES(UMODE);
      122     5585    1         VM_UC$->F$DCB.ASN=UCASN(UMODE);
      123     5586    1         VM_UC$->F$DCB.ORG=%TERMINAL#;
      124     5587    1         RETURN;
      125     5588        /**/
      126     5589        /**/
      127     5590    1   NOPAGE: ;
      128     5591    1         CALL JCM$RELJ (PP,I);
      129     5592    1         ALTRETURN;
      130     5593    1   BADCVM: ;
      131     5594    1         CALL FOI$CRASH (%S$BDCVM,F_JC,M_M);
      132     5595        /*S*  SCREECH_CODE: JCM-S$BDCVM
      133     5596              TYPE:    Screech
      134     5597              MESSAGE: SLUG M$CVM failed trying to create new user
      135     5598              REMARKS: When SLUG makes a new user he steals three physical pages
      136     5599                       and M$CVMs onto them to make JIT, HJIT, and ROSEG.  If
      137     5600                       the pages can be gotten but the M$CVM fails, this screech
      138     5601                       occurs.                                                       */
      139     5602        /**/
      140     5603        /**/
      141     5604    1   END;
      142     5605        /**/
      143     5606        /**/
      144     5607        %EOD;

PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:5    
--  Include file information  --

   JC_SCODE_C.:E05TOU  is referenced.
   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B$MAP.:E05TOU  cannot be made into a system file and is referenced.
   M_INFO_C.:E05TOU  is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   B_MLSMAC_C.:E05TOU  is referenced.
   B_ULSMAC_C.:E05TOU  is referenced.
   B_LSDATA_C.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure JCM$SETU.

   Procedure JCM$SETU requires 167 words for executable code.
   Procedure JCM$SETU requires 24 words of local(AUTO) storage.

PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:6    

 Object Unit name= JCM$SETU                                   File name= JCM$MAKEU.:E05TOU
 UTS= JUL 29 '97 23:17:36.76 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none   247    367  JCM$SETU
    2  RoData even  UTS     97    141  JCM$SETU
    3   Proc  even  none   167    247  JCM$SETU
    4  RoData even  none    12     14  JCM$SETU

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        5  JCM$SETU

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1      0  JC_JIT                             1    366  JC_VBSE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 JCM$RELJ
 yes     yes           Std       3 FOI$CRASH
                       nStd      0 X66_AUTO_5
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:7    

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B$IS$                                 B_UHJIT
     JC_ROSEG                              M_UC                                  JC_8000_FLG
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:8    


        1        1        /*M* JCM$MAKEU User maker for SLUG ghost  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*DMC,PLM=6,IND=2,ENU=2,DCI=4,CSU=2,ECU=2,THI=2,DTI=0*/
        8        8        /**/
        9        9        /**/
       10       10        JCM$SETU: PROC   (UMODE,VJIT$,VM_UC$,VROSEG$,PP) ALTRET;

     10  3 000000   000000 700200 xent  JCM$SETU     TSX0  ! X66_AUTO_5
         3 000001   000030 000005                    ZERO    24,5

       11       11        /**/
       12       12        /**/
       13       13        %INCLUDE CP_6;
       14       94        %INCLUDE CP_6_SUBS;
       15      634        %INCLUDE B_LSDATA_C;
       16     3840        %INCLUDE B_SEGIDS_C;
       17     4379        %INCLUDE M_INFO_C;
       18     4519        %INCLUDE B$MAP;                         /* PAGE TABLE DEFINITIONS             */
       19     4618 S      %INCLUDE B$JIT_C;
       20     4619        %B$JIT0 (STCLASS=BASED);
       21     4708        %U$JIT1;
       22     4782        %M$JIT2;
       23     4792        %F$JIT3;
       24     4797        %S$JIT4;
       25     4803        %J$JIT5;
       26     4891        %A$JIT6;
       27     4901        %B$JIT0X (STCLASS="STATIC SYMDEF",B$JIT0=JC_JIT);
       28     4904        %U$JIT1X;
       29     4907        %M$JIT2X;
       30     4910        %F$JIT3X;
       31     4913        %S$JIT4X;
       32     4916        %J$JIT5X;
PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:9    
       33     4919        %A$JIT6X;
       34     4922        %INCLUDE F$DCB;
       35     4971        %INCLUDE B$ROSEG;
       36     5034        %INCLUDE JC_SCODE_C;
       37     5050        /**/
       38     5051        /**/
       39     5052    1   DCL UMODE UBIN WORD;      /*  UMODE = 5 IS CONSOLE GHOST */
       40     5053    1   DCL VJIT$ PTR;
       41     5054    1   DCL VM_UC$ PTR;
       42     5055    1   DCL VROSEG$ PTR;
       43     5056    1   DCL PP (0:2) UBIN WORD;
       44     5057    1   DCL VHJIT$ PTR;
       45     5058    1   DCL VPTR$ PTR;
       46     5059    1   DCL PBSE UBIN WORD;
       47     5060    1   DCL I SBIN;
       48     5061    1   DCL B$IS$ PTR SYMREF;
       49     5062    1   DCL 1 RSLT DALIGNED,
       50     5063    1         2 WORD1 SBIN,
       51     5064    1         2 PNO UBIN(36) UNAL;
       52     5065    1   DCL UCRES (0:5) CHAR(2) UNAL CONSTANT INIT('NO'*3,'UC','  '*2);
       53     5066    1   DCL UCASN (0:5) UBIN WORD CONSTANT INIT(%DEVICE#*4,%COMGROUP#*2);
       54     5067    1   DCL NXTCC (0:5) UBIN WORD CONSTANT INIT(%CC_FROMNO#,%CC_FROMJOB#,%CC_FROMNO#,%
              5067            CC_FROMUC#*3);
       55     5068    1   DCL JC_VBSE UBIN WORD STATIC SYMDEF INIT(100);
       56     5069    1   DCL B_UHJIT(0:1023) SBIN   SYMREF;
       57     5070    1   DCL JC_ROSEG (0:1023) UBIN WORD SYMREF;
       58     5071    1   DCL M_UC UBIN WORD SYMREF;              /* DUMMY */
       59     5072    1   DCL   JC_8000_FLG BIT(1) SYMREF;
       60     5073        %B_USRULS_8000 (FPTN=DPS8000_ULS,STCLASS=CONSTANT);
       61     5272        %B_USRULS_8000;
       62     5471    1   DCL JCM$RELJ ENTRY(2);
       63     5472    1   DCL FOI$CRASH ENTRY(3) ALTRET;
       64     5473        /**/
       65     5474        /**/
       66     5475        %FPT_STLPP (FPTN=FPT$STLPP,STCLASS=" ");
       67     5488        %FPT_STLPP (FPTN=STLPPC,STCLASS=CONSTANT);
       68     5501        %FPT_CVM (FPTN=FPT$CVM,STCLASS=" ");
PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:10   
       69     5517        %FPT_CVM (FPTN=CVMC,PHYSICAL=NO,STCLASS=CONSTANT);
       70     5533        /**/
       71     5534        %SUB F_JC='1203'O;
       72     5535        %SUB M_M='15'O;
       73     5536        /**/
       74     5537    1         FPT$CVM=CVMC;

   5537  3 000002   000100 100400                    MLR     fill='000'O
         3 000003   000132 000030 2                  ADSC9   CVMC                     cn=0,n=24
         3 000004   200020 000030                    ADSC9   FPT$CVM,,AUTO            cn=0,n=24

       75     5538    1         FPT$CVM.V_=VECTOR(FPT$CVM.V);

   5538  3 000005   000000 235000 4                  LDA     0
         3 000006   200026 452500                    STP2    FPT$CVM+6,,AUTO
         3 000007   200026 236100                    LDQ     FPT$CVM+6,,AUTO
         3 000010   000022 036003                    ADLQ    18,DU
         3 000011   200020 757100                    STAQ    FPT$CVM,,AUTO

       76     5539    1         FPT$STLPP=STLPPC;

   5539  3 000012   000130 237000 2                  LDAQ    STLPPC
         3 000013   200016 757100                    STAQ    FPT$STLPP,,AUTO

       77     5540    1         FPT$STLPP.RESULTS_=VECTOR(RSLT);

   5540  3 000014   000001 235000 4                  LDA     1
         3 000015   200026 452500                    STP2    FPT$CVM+6,,AUTO
         3 000016   200026 236100                    LDQ     FPT$CVM+6,,AUTO
         3 000017   000014 036003                    ADLQ    12,DU
         3 000020   200016 757100                    STAQ    FPT$STLPP,,AUTO

       78     5541        /**/
       79     5542    2         DO INHIBIT;

       80     5543    2           PBSE=JC_VBSE;

PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:11   
   5543  3 000021   000366 235200 1                  LDA   ! JC_VBSE
         3 000022   200012 755300                    STA   ! PBSE,,AUTO

       81     5544    2           JC_VBSE=JC_VBSE+3;

   5544  3 000023   000003 035207                    ADLA  ! 3,DL
         3 000024   000366 755200 1                  STA   ! JC_VBSE

       82     5545    2         END;

       83     5546        /**/
       84     5547    1         VPTR$=PINCRW(B$IS$,PBSE*1024);   /* PTR TO NEW JIT PAGE                */

   5547  3 000025   200012 236100                    LDQ     PBSE,,AUTO
         3 000026   000034 736000                    QLS     28
         3 000027   000000 036000 xsym               ADLQ    B$IS$
         3 000030   200011 756100                    STQ     VPTR$,,AUTO

       85     5548    1         VJIT$ = VPTR$;

   5548  3 000031   200004 470500                    LDP0    @VJIT$,,AUTO
         3 000032   000000 756100                    STQ     0,,PR0

       86     5549    1         VHJIT$=PINCRW(B$IS$,(PBSE+1)*1024); /* PTR TO NEW HJIT PAGE           */

   5549  3 000033   200012 236100                    LDQ     PBSE,,AUTO
         3 000034   000034 736000                    QLS     28
         3 000035   002000 036003                    ADLQ    1024,DU
         3 000036   000000 036000 xsym               ADLQ    B$IS$
         3 000037   200010 756100                    STQ     VHJIT$,,AUTO

       87     5550    1         VROSEG$=PINCRW(B$IS$,(PBSE+2)*1024); /* PTR TO NEW ROSEG              */

   5550  3 000040   200012 236100                    LDQ     PBSE,,AUTO
         3 000041   000034 736000                    QLS     28
         3 000042   004000 036003                    ADLQ    2048,DU
         3 000043   000000 036000 xsym               ADLQ    B$IS$
PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:12   
         3 000044   200006 471500                    LDP1    @VROSEG$,,AUTO
         3 000045   100000 756100                    STQ     0,,PR1

       88     5551        /**/
       89     5552    2         DO I = 0 TO 2;

   5552  3 000046   200013 450100                    STZ     I,,AUTO

       90     5553    2           CALL M$STLPP(FPT$STLPP)  ALTRET(NOPAGE);

   5553  3 000047   200016 630500                    EPPR0   FPT$STLPP,,AUTO
         3 000050   430007 713400                    CLIMB   alt,+12295
         3 000051   400000 401760                    pmme    nvectors=1
         3 000052   000231 702000 3                  TSX2    NOPAGE

       91     5554    2           PP(I) = RSLT.PNO;            /* REMEMBER PHY PG NO.                */

   5554  3 000053   200007 470500                    LDP0    @PP,,AUTO
         3 000054   200013 720100                    LXL0    I,,AUTO
         3 000055   200015 235100                    LDA     RSLT+1,,AUTO
         3 000056   000000 755110                    STA     0,X0,PR0

       92     5555    2           FPT$CVM.V.PPNO# = RSLT.PNO;  /* SET UP FOR CVM                     */

   5555  3 000057   200015 235100                    LDA     RSLT+1,,AUTO
         3 000060   200023 755100                    STA     FPT$CVM+3,,AUTO

       93     5556    2           FPT$CVM.V.VPNO# = PBSE + I;

   5556  3 000061   200012 236100                    LDQ     PBSE,,AUTO
         3 000062   200013 036100                    ADLQ    I,,AUTO
         3 000063   000000 620006                    EAX0    0,QL
         3 000064   200024 440100                    SXL0    FPT$CVM+4,,AUTO

       94     5557    2           CALL M$CVM(FPT$CVM) ALTRET(BADCVM); /* MAP IT IN                   */

   5557  3 000065   200020 630500                    EPPR0   FPT$CVM,,AUTO
PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:13   
         3 000066   430011 713400                    CLIMB   alt,+12297
         3 000067   400000 401760                    pmme    nvectors=1
         3 000070   000242 702000 3                  TSX2    BADCVM

       95     5558    2         END;

   5558  3 000071   200013 054100                    AOS     I,,AUTO
         3 000072   200013 235100                    LDA     I,,AUTO
         3 000073   000002 115007                    CMPA    2,DL
         3 000074   000047 604400 3                  TMOZ    s:5553

       96     5559        /*
       97     5560             GOT ALL THREE PAGES. NOW, SET UP INITIAL JIT, HJIT, & ROSEG
       98     5561             INFORMATION...
       99     5562        */
      100     5563    1         VPTR$->B$PAGE='0'B;

   5563  3 000075   200011 470500                    LDP0    VPTR$,,AUTO
         3 000076   010000 220003                    LDX0    4096,DU
         3 000077   000140 100400                    MLR     fill='000'O
         3 000100   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         3 000101   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      101     5564    1         VJIT$->B$JIT=JC_JIT;

   5564  3 000102   200004 471500                    LDP1    @VJIT$,,AUTO
         3 000103   100000 473500                    LDP3    0,,PR1
         3 000104   000100 100400                    MLR     fill='000'O
         3 000105   000000 001730 1                  ADSC9   JC_JIT                   cn=0,n=984
         3 000106   300000 001730                    ADSC9   0,,PR3                   cn=0,n=984

      102     5565    1         IF UMODE=5/*CONS GHOST*/

   5565  3 000107   200003 473500                    LDP3    @UMODE,,AUTO
         3 000110   300000 235100                    LDA     0,,PR3
         3 000111   000005 115007                    CMPA    5,DL
         3 000112   000121 601000 3                  TNZ     s:5567
PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:14   

      103     5566    1           THEN VJIT$->B$JIT.MODE = %M_INT#; /* Cons ghosts look like M_INT */

   5566  3 000113   100000 474500                    LDP4    0,,PR1
         3 000114   400000 236100                    LDQ     0,,PR4
         3 000115   000002 376000 4                  ANQ     2
         3 000116   140000 276003                    ORQ     49152,DU
         3 000117   400000 756100                    STQ     0,,PR4
         3 000120   000127 710000 3                  TRA     s:5568

      104     5567    1           ELSE VJIT$->B$JIT.MODE = UMODE;

   5567  3 000121   100000 474500                    LDP4    0,,PR1
         3 000122   300000 236100                    LDQ     0,,PR3
         3 000123   000040 736000                    QLS     32
         3 000124   400000 676100                    ERQ     0,,PR4
         3 000125   740000 376003                    ANQ     -16384,DU
         3 000126   400000 656100                    ERSQ    0,,PR4

      105     5568    1         VJIT$->B$JIT.NEXTCC=NXTCC(UMODE);

   5568  3 000127   100000 474500                    LDP4    0,,PR1
         3 000130   300000 721100                    LXL1    0,,PR3
         3 000131   000011 236011 2                  LDQ     NXTCC,X1
         3 000132   000022 736000                    QLS     18
         3 000133   400151 552120                    STBQ    105,'20'O,PR4

      106     5569        /**/
      107     5570    1         VHJIT$->B$PAGE=B_UHJIT;

   5570  3 000134   200010 474500                    LDP4    VHJIT$,,AUTO
         3 000135   000140 100440                    MLR     fill='000'O
         3 000136   000000 000010 xsym               ADSC9   B_UHJIT                  cn=0,n=*X0
         3 000137   400000 000010                    ADSC9   0,,PR4                   cn=0,n=*X0

      108     5571    1         IF JC_8000_FLG THEN

PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:15   
   5571  3 000140   000000 234000 xsym               SZN     JC_8000_FLG
         3 000141   000145 605000 3                  TPL     s:5573

      109     5572    1           VHJIT$->B_USRULS_8000 = DPS8000_ULS;

   5572  3 000142   000100 100400                    MLR     fill='000'O
         3 000143   000020 000440 2                  ADSC9   DPS8000_ULS              cn=0,n=288
         3 000144   400000 000440                    ADSC9   0,,PR4                   cn=0,n=288

      110     5573    1         VROSEG$->B$PAGE=JC_ROSEG;

   5573  3 000145   200006 475500                    LDP5    @VROSEG$,,AUTO
         3 000146   500000 476500                    LDP6    0,,PR5
         3 000147   000140 100440                    MLR     fill='000'O
         3 000150   000000 000010 xsym               ADSC9   JC_ROSEG                 cn=0,n=*X0
         3 000151   600000 000010                    ADSC9   0,,PR6                   cn=0,n=*X0

      111     5574    1         IF UMODE=5 THEN VROSEG$->B$ROSEG.STREAM_VALID='34'O; /* Make 3 of 'em */

   5574  3 000152   300000 235100                    LDA     0,,PR3
         3 000153   000005 115007                    CMPA    5,DL
         3 000154   000162 601000 3                  TNZ     s:5575

   5574  3 000155   500000 476500                    LDP6    0,,PR5
         3 000156   000100 100400                    MLR     fill='000'O
         3 000157   000003 000001 4                  ADSC9   3                        cn=0,n=1
         3 000160   600117 000020                    ADSC9   79,,PR6                  cn=0,n=16
         3 000161   000201 710000 3                  TRA     s:5583

      112     5575    2           ELSE IF UMODE<%M_INT# THEN DO; /* Get rid of UC LDEVs if useless. */

   5575  3 000162   000003 115007                    CMPA    3,DL
         3 000163   000201 603000 3                  TRC     s:5583

      113     5576    2             VROSEG$->B$ROSEG.LDEVNAME(1)='    ';

   5576  3 000164   500000 476500                    LDP6    0,,PR5
PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:16   
         3 000165   000140 236000 2                  LDQ     CVMC+6
         3 000166   600055 756100                    STQ     45,,PR6

      114     5577    2             VROSEG$->B$ROSEG.LDEVNAME(2)='    ';

   5577  3 000167   500000 476500                    LDP6    0,,PR5
         3 000170   600056 756100                    STQ     46,,PR6

      115     5578    2             VROSEG$->B$ROSEG.LDEVNAME(3)='    ';

   5578  3 000171   500000 476500                    LDP6    0,,PR5
         3 000172   600057 756100                    STQ     47,,PR6

      116     5579    2             VROSEG$->B$ROSEG.STREAMID(1)='0'B;

   5579  3 000173   500000 476500                    LDP6    0,,PR5
         3 000174   600075 450100                    STZ     61,,PR6

      117     5580    2             VROSEG$->B$ROSEG.STREAMID(2)='0'B;

   5580  3 000175   500000 476500                    LDP6    0,,PR5
         3 000176   600076 450100                    STZ     62,,PR6

      118     5581    2             VROSEG$->B$ROSEG.STREAMID(3)='0'B;

   5581  3 000177   500000 476500                    LDP6    0,,PR5
         3 000200   600077 450100                    STZ     63,,PR6

      119     5582    2           END;

      120     5583    1         VM_UC$=PINCRW(VROSEG$,POFFW(ADDR(M_UC),ADDR(JC_ROSEG)));

   5583  3 000201   000004 236000 4                  LDQ     4
         3 000202   000022 772000                    QRL     18
         3 000203   200026 756100                    STQ     FPT$CVM+6,,AUTO
         3 000204   000005 236000 4                  LDQ     5
         3 000205   000022 772000                    QRL     18
PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:17   
         3 000206   200026 136100                    SBLQ    FPT$CVM+6,,AUTO
         3 000207   500000 476500                    LDP6    0,,PR5
         3 000210   600000 637506                    EPPR7   0,QL,PR6
         3 000211   200005 470500                    LDP0    @VM_UC$,,AUTO
         3 000212   000000 457500                    STP7    0,,PR0

      121     5584    1         VM_UC$->F$DCB.RES=UCRES(UMODE);

   5584  3 000213   300000 235100                    LDA     0,,PR3
         3 000214   000001 735000                    ALS     1
         3 000215   040100 100405                    MLR     fill='040'O
         3 000216   000000 000002 2                  ADSC9   UCRES,A                  cn=0,n=2
         3 000217   700026 000004                    ADSC9   22,,PR7                  cn=0,n=4

      122     5585    1         VM_UC$->F$DCB.ASN=UCASN(UMODE);

   5585  3 000220   000000 476500                    LDP6    0,,PR0
         3 000221   300000 721100                    LXL1    0,,PR3
         3 000222   000003 236011 2                  LDQ     UCASN,X1
         3 000223   000011 736000                    QLS     9
         3 000224   600032 552110                    STBQ    26,'10'O,PR6

      123     5586    1         VM_UC$->F$DCB.ORG=%TERMINAL#;

   5586  3 000225   000000 476500                    LDP6    0,,PR0
         3 000226   010000 236003                    LDQ     4096,DU
         3 000227   600032 552140                    STBQ    26,'40'O,PR6

      124     5587    1         RETURN;

   5587  3 000230   000000 702200 xent               TSX2  ! X66_ARET

   5586  3 000231                       NOPAGE       null
      125     5588        /**/
      126     5589        /**/
      127     5590    1   NOPAGE: ;
      128     5591    1         CALL JCM$RELJ (PP,I);
PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:18   

   5591  3 000231   200013 630500                    EPPR0   I,,AUTO
         3 000232   200027 450500                    STP0    FPT$CVM+7,,AUTO
         3 000233   200007 236100                    LDQ     @PP,,AUTO
         3 000234   200026 756100                    STQ     FPT$CVM+6,,AUTO
         3 000235   200026 630500                    EPPR0   FPT$CVM+6,,AUTO
         3 000236   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000237   000000 701000 xent               TSX1    JCM$RELJ
         3 000240   000000 011000                    NOP     0

      129     5592    1         ALTRETURN;

   5592  3 000241   000000 702200 xent               TSX2  ! X66_AALT

   5586  3 000242                       BADCVM       null
      130     5593    1   BADCVM: ;
      131     5594    1         CALL FOI$CRASH (%S$BDCVM,F_JC,M_M);

   5594  3 000242   000011 630400 4                  EPPR0   9
         3 000243   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000244   000000 701000 xent               TSX1    FOI$CRASH
         3 000245   000000 011000                    NOP     0

      132     5595        /*S*  SCREECH_CODE: JCM-S$BDCVM
      133     5596              TYPE:    Screech
      134     5597              MESSAGE: SLUG M$CVM failed trying to create new user
      135     5598              REMARKS: When SLUG makes a new user he steals three physical pages
      136     5599                       and M$CVMs onto them to make JIT, HJIT, and ROSEG.  If
      137     5600                       the pages can be gotten but the M$CVM fails, this screech
      138     5601                       occurs.                                                       */
      139     5602        /**/
      140     5603        /**/
      141     5604    1   END;

   5604  3 000246   000000 702200 xent               TSX2  ! X66_ARET
      142     5605        /**/
      143     5606        /**/
PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:19   
      144     5607        %EOD;

PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:20   
--  Include file information  --

   JC_SCODE_C.:E05TOU  is referenced.
   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B$MAP.:E05TOU  cannot be made into a system file and is referenced.
   M_INFO_C.:E05TOU  is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   B_MLSMAC_C.:E05TOU  is referenced.
   B_ULSMAC_C.:E05TOU  is referenced.
   B_LSDATA_C.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure JCM$SETU.
PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:21   

 **** Variables and constants ****

  ****  Section 001  Data  JCM$SETU

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 JC_JIT                   366-0-0/w UBIN        r     1 JC_VBSE

  ****  Section 002 RoData JCM$SETU

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   132-0-0/d STRC(216)   r     1 CVMC                      20-0-0/d STRC(2592)  r     1 DPS8000_ULS
    11-0-0/w UBIN        r     1 NXTCC(0:5)               130-0-0/d STRC(72)    r     1 STLPPC
     3-0-0/w UBIN        r     1 UCASN(0:5)                 0-0-0/c CHAR(2)     r     1 UCRES(0:5)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     7-0-0/w PTR         r     1 @PP                        3-0-0/w PTR         r     1 @UMODE
     4-0-0/w PTR         r     1 @VJIT$                     5-0-0/w PTR         r     1 @VM_UC$
     6-0-0/w PTR         r     1 @VROSEG$                  20-0-0/d STRC(216)   r     1 FPT$CVM
    16-0-0/d STRC(72)    r     1 FPT$STLPP                 13-0-0/w SBIN        r     1 I
    12-0-0/w UBIN        r     1 PBSE                      *0-0-0/w UBIN        r     1 PP(0:2)
    14-0-0/d STRC(72)    r     1 RSLT                      *0-0-0/w UBIN        r     1 UMODE
    10-0-0/w PTR         r     1 VHJIT$                    *0-0-0/w PTR         r     1 VJIT$
    *0-0-0/w PTR         r     1 VM_UC$                    11-0-0/w PTR         r     1 VPTR$
    *0-0-0/w PTR         r     1 VROSEG$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:22   

     0-0-0/w PTR         r     1 B$IS$                      0-0-0/w SBIN        r     1 B_UHJIT(0:1023)
     0-0-0/b BIT         r     1 JC_8000_FLG                0-0-0/w UBIN        r     1 JC_ROSEG(0:1023)
     0-0-0/w UBIN        r     1 M_UC

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/w STRC(36864) r     1 B$PAGE
     0-0-0/d STRC(3024)  r     1 B$ROSEG                    0-0-0/d STRC(2592)  r     1 B_USRULS_8000
     0-0-0/d ASTR(3528)  r     1 F$DCB


   Procedure JCM$SETU requires 167 words for executable code.
   Procedure JCM$SETU requires 24 words of local(AUTO) storage.
PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:23   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:24   
          MINI XREF LISTING

B$IS$
      5061**DCL      5547>>ASSIGN   5549>>ASSIGN   5550>>ASSIGN
B$JIT
      4620**DCL      5098--DCLINIT  5564<<ASSIGN
B$JIT.CPFLAGS1.SLEAZE
      4719**DCL      4719--REDEF
B$JIT.ERR.MID
      4626**DCL      4626--REDEF
B$JIT.JRESPEAK
      4787**DCL      4788--REDEF
B$JIT.MODE
      4620**DCL      5566<<ASSIGN   5567<<ASSIGN
B$JIT.NEXTCC
      4767**DCL      5568<<ASSIGN
B$JIT.ORIGINATOR_PORT.FROM_CR
      4896**DCL      4896--REDEF    4897--REDEF
B$JIT.PNR
      4800**DCL      4800--REDEF
B$JIT.TSLINE
      4894**DCL      4895--REDEF
B$MAP.SCTRL
      4562**DCL      4563--REDEF
B$PAGE
      4611**DCL      5563<<ASSIGN   5570<<ASSIGN   5573<<ASSIGN
B$ROSEG.LDEVNAME
      4992**DCL      5576<<ASSIGN   5577<<ASSIGN   5578<<ASSIGN
B$ROSEG.STREAMID
      4993**DCL      5579<<ASSIGN   5580<<ASSIGN   5581<<ASSIGN
B$ROSEG.STREAM_VALID
      5014**DCL      5574<<ASSIGN
BADCVM
      5586**LABEL    5557--CALLALT
PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:25   
B_UHJIT
      5069**DCL      5570>>ASSIGN
B_USRULS_8000
      5286**DCL      5572<<ASSIGN
CVMC
      5528**DCL      5537>>ASSIGN
CVMC.V
      5528**DCL      5528--DCLINIT
DPS8000_ULS
      5087**DCL      5572>>ASSIGN
F$DCB.ACTPOS
      4948**DCL      4948--REDEF
F$DCB.ARS
      4923**DCL      4923--REDEF
F$DCB.ASN
      4938**DCL      5585<<ASSIGN
F$DCB.ATTR
      4941**DCL      4942--REDEF
F$DCB.BORROW
      4956**DCL      4956--REDEF    4956--REDEF    4956--REDEF
F$DCB.DCBNAME.L
      4970**DCL      4970--IMP-SIZ
F$DCB.EOMCHAR
      4927**DCL      4927--REDEF
F$DCB.FLDID
      4951**DCL      4951--REDEF
F$DCB.FORM$
      4945**DCL      4945--REDEF
F$DCB.FSECT
      4961**DCL      4961--REDEF
F$DCB.FSN
      4938**DCL      4938--REDEF    4938--REDEF    4939--REDEF
F$DCB.HEADER$
      4944**DCL      4944--REDEF
F$DCB.IXTNSIZE
      4942**DCL      4942--REDEF
PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:26   
F$DCB.LASTSTA$
      4932**DCL      4932--REDEF
F$DCB.LVL
      4957**DCL      4957--REDEF
F$DCB.NAME.C
      4932**DCL      4932--REDEF
F$DCB.NOEOF
      4953**DCL      4953--REDEF
F$DCB.NRECS
      4943**DCL      4943--REDEF
F$DCB.NRECX
      4962**DCL      4962--REDEF
F$DCB.OHDR
      4954**DCL      4954--REDEF
F$DCB.ORG
      4937**DCL      4937--REDEF    5586<<ASSIGN
F$DCB.PRECNO
      4960**DCL      4960--REDEF
F$DCB.RCSZ
      4965**DCL      4965--REDEF
F$DCB.RES
      4933**DCL      4933--REDEF    5584<<ASSIGN
F$DCB.SETX
      4945**DCL      4945--REDEF
F$DCB.TAB$
      4944**DCL      4945--REDEF
F$DCB.TDA
      4959**DCL      4959--REDEF
F$DCB.WSN
      4934**DCL      4934--REDEF
FOI$CRASH
      5472**DCL-ENT  5594--CALL
FPT$CVM
      5512**DCL      5537<<ASSIGN   5557<>CALL
FPT$CVM.V
      5512**DCL      5538--ASSIGN
PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:27   
FPT$CVM.V.PPNO#
      5513**DCL      5555<<ASSIGN
FPT$CVM.V.VPNO#
      5514**DCL      5556<<ASSIGN
FPT$CVM.V_
      5512**DCL      5538<<ASSIGN
FPT$STLPP
      5486**DCL      5539<<ASSIGN   5553<>CALL
FPT$STLPP.RESULTS_
      5486**DCL      5540<<ASSIGN
I
      5060**DCL      5552<<DOINDEX  5554>>ASSIGN   5556>>ASSIGN   5591<>CALL
JCM$RELJ
      5471**DCL-ENT  5591--CALL
JC_8000_FLG
      5072**DCL      5571>>IF
JC_JIT
      4902**DCL      5564>>ASSIGN
JC_ROSEG
      5070**DCL      5573>>ASSIGN   5583--ASSIGN
JC_VBSE
      5068**DCL      5543>>ASSIGN   5544<<ASSIGN   5544>>ASSIGN
M$CVM
        60**DCL-ENT  5557--CALL
M$STLPP
        59**DCL-ENT  5553--CALL
M_UC
      5071**DCL      5583--ASSIGN
NOPAGE
      5586**LABEL    5553--CALLALT
NXTCC
      5067**DCL      5568>>ASSIGN
PBSE
      5059**DCL      5543<<ASSIGN   5547>>ASSIGN   5549>>ASSIGN   5550>>ASSIGN   5556>>ASSIGN
PP
      5056**DCL        10--PROC     5554<<ASSIGN   5591<>CALL
PL6.E3A0      #001=JCM$SETU File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:17 Page:28   
RSLT
      5062**DCL      5540--ASSIGN
RSLT.PNO
      5064**DCL      5554>>ASSIGN   5555>>ASSIGN
STLPPC
      5499**DCL      5539>>ASSIGN
UCASN
      5066**DCL      5585>>ASSIGN
UCRES
      5065**DCL      5584>>ASSIGN
UMODE
      5052**DCL        10--PROC     5565>>IF       5567>>ASSIGN   5568>>ASSIGN   5574>>IF       5575>>IF
      5584>>ASSIGN   5585>>ASSIGN
VHJIT$
      5057**DCL      5549<<ASSIGN   5570>>ASSIGN   5572>>ASSIGN
VJIT$
      5053**DCL        10--PROC     5548<<ASSIGN   5564>>ASSIGN   5566>>ASSIGN   5567>>ASSIGN   5568>>ASSIGN
VM_UC$
      5054**DCL        10--PROC     5583<<ASSIGN   5584>>ASSIGN   5585>>ASSIGN   5586>>ASSIGN
VPTR$
      5058**DCL      5547<<ASSIGN   5548>>ASSIGN   5563>>ASSIGN
VROSEG$
      5055**DCL        10--PROC     5550<<ASSIGN   5573>>ASSIGN   5574>>ASSIGN   5576>>ASSIGN   5577>>ASSIGN
      5578>>ASSIGN   5579>>ASSIGN   5580>>ASSIGN   5581>>ASSIGN   5583>>ASSIGN

PL6.E3A0      #002=JCM$RELJ File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:19 Page:29   
      145        1        /*T***********************************************************/
      146        2        /*T*                                                         */
      147        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      148        4        /*T*                                                         */
      149        5        /*T***********************************************************/
      150        6        /**/
      151        7        /**/
      152        8        JCM$RELJ: PROC (PP,I);
      153        9        /**/
      154       10        /**/
      155       11        %INCLUDE CP_6;
      156       92        %INCLUDE JC_SCODE_C;
      157      108        /**/
      158      109        /**/
      159      110        /**/
      160      111    1   DCL PP (0:2) UBIN WORD;
      161      112    1   DCL I UBIN WORD;
      162      113    1   DCL J SBIN;
      163      114    1   DCL 1 RSLT DALIGNED,
      164      115    1         2 WORD1 SBIN,
      165      116    1         2 PNO UBIN WORD;
      166      117    1   DCL B$TCB$ PTR SYMREF;
      167      118    1   DCL JC_VBSE UBIN WORD SYMREF;
      168      119    1   DCL FOI$CRASH ENTRY(3) ALTRET;
      169      120        /**/
      170      121        /**/
      171      122        %FPT_MAKUSER (FPTN=FPT$MAKUSER,STCLASS=" ");
      172      136        %FPT_MAKUSER (STCLASS=CONSTANT,FPTN=MKUC);
      173      150        %FPT_RSPP (FPTN=FPT$RSPP,STCLASS=" ");
      174      163        %FPT_RSPP (STCLASS=CONSTANT,FPTN=RSPPC);
      175      176        /**/
      176      177        %SUB F_JC='1203'O;
      177      178        %SUB M_M='15'O;
      178      179        /**/
      179      180    2         IF I~=0 THEN DO;
      180      181    2           FPT$RSPP=RSPPC;
      181      182    2           FPT$RSPP.RESULTS_=VECTOR(RSLT);
PL6.E3A0      #002=JCM$RELJ File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:19 Page:30   
      182      183    3           DO J=0 TO I-1;
      183      184    3             RSLT.PNO=PP(J);
      184      185    3             CALL M$RSPP (FPT$RSPP);
      185      186    3           END;
      186      187    2         END;
      187      188    1         GOTO MXIT;
      188      189        /**/
      189      190    1   JCM$MAKEU: ENTRY(PP);
      190      191        /**/
      191      192    1         FPT$MAKUSER=MKUC;
      192      193    1         FPT$MAKUSER.V_=VECTOR(FPT$MAKUSER.V);
      193      194    1         FPT$MAKUSER.V.JITPP#=PP(0);
      194      195    1         FPT$MAKUSER.V.HJITPP#=PP(1);
      195      196    1         FPT$MAKUSER.V.ROPP#=PP(2);
      196      197    1         CALL M$MAKUSER (FPT$MAKUSER) ALTRET (BADMAKE);
      197      198    1   MXIT: ;
      198      199    2         DO INHIBIT;
      199      200    2           JC_VBSE=JC_VBSE-3;
      200      201    2         END;
      201      202    1         RETURN;
      202      203        /**/
      203      204    1   BADMAKE:;
      204      205    1         CALL FOI$CRASH (%S$NOMAKU,F_JC,M_M);
      205      206        /*S*  SCREECH_CODE: JCM-S$NOMAKU
      206      207              TYPE:    Screech
      207      208              MESSAGE: SLUG got altreturn from M$MAKUSER
      208      209              REMARKS: SLUG makes a new user by issuing an M$MAKUSER PMME passing
      209      210                       3 physical pages it has set up as a JIT, HJIT, AND ROSEG.
      210      211                       If the PMME altrets, SLUG has malformed one or more of
      211      212                       these.  It is also possible that SLUG and the monitor are
      212      213                       different versions.                                           */
      213      214        /**/
      214      215    1   END;
      215      216        /**/
      216      217        /**/

PL6.E3A0      #002=JCM$RELJ File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:19 Page:31   
--  Include file information  --

   JC_SCODE_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure JCM$RELJ.

   Procedure JCM$RELJ requires 58 words for executable code.
   Procedure JCM$RELJ requires 18 words of local(AUTO) storage.

    No errors detected in file JCM$MAKEU.:E05TSI    .

PL6.E3A0      #002=JCM$RELJ File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:19 Page:32   

 Object Unit name= JCM$RELJ                                   File name= JCM$MAKEU.:E05TOU
 UTS= JUL 29 '97 23:19:23.72 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS      8     10  JCM$RELJ
    2   Proc  even  none    58     72  JCM$RELJ
    3  RoData even  none     8     10  JCM$RELJ

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        2  JCM$RELJ
     2     34                  yes      Std        1  JCM$MAKEU

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 FOI$CRASH
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  JC_VBSE                               B_VECTNIL
PL6.E3A0      #002=JCM$RELJ File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:19 Page:33   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #002=JCM$RELJ File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:19 Page:34   


      145        1        /*T***********************************************************/
      146        2        /*T*                                                         */
      147        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      148        4        /*T*                                                         */
      149        5        /*T***********************************************************/
      150        6        /**/
      151        7        /**/
      152        8        JCM$RELJ: PROC (PP,I);

      8  2 000000   000000 700200 xent  JCM$RELJ     TSX0  ! X66_AUTO_2
         2 000001   000022 000002                    ZERO    18,2

      153        9        /**/
      154       10        /**/
      155       11        %INCLUDE CP_6;
      156       92        %INCLUDE JC_SCODE_C;
      157      108        /**/
      158      109        /**/
      159      110        /**/
      160      111    1   DCL PP (0:2) UBIN WORD;
      161      112    1   DCL I UBIN WORD;
      162      113    1   DCL J SBIN;
      163      114    1   DCL 1 RSLT DALIGNED,
      164      115    1         2 WORD1 SBIN,
      165      116    1         2 PNO UBIN WORD;
      166      117    1   DCL B$TCB$ PTR SYMREF;
      167      118    1   DCL JC_VBSE UBIN WORD SYMREF;
      168      119    1   DCL FOI$CRASH ENTRY(3) ALTRET;
      169      120        /**/
      170      121        /**/
      171      122        %FPT_MAKUSER (FPTN=FPT$MAKUSER,STCLASS=" ");
      172      136        %FPT_MAKUSER (STCLASS=CONSTANT,FPTN=MKUC);
      173      150        %FPT_RSPP (FPTN=FPT$RSPP,STCLASS=" ");
      174      163        %FPT_RSPP (STCLASS=CONSTANT,FPTN=RSPPC);
      175      176        /**/
      176      177        %SUB F_JC='1203'O;
PL6.E3A0      #002=JCM$RELJ File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:19 Page:35   
      177      178        %SUB M_M='15'O;
      178      179        /**/
      179      180    2         IF I~=0 THEN DO;

    180  2 000002   200004 470500                    LDP0    @I,,AUTO
         2 000003   000000 235100                    LDA     0,,PR0
         2 000004   000033 600000 2                  TZE     s:188

      180      181    2           FPT$RSPP=RSPPC;

    181  2 000005   000006 237000 1                  LDAQ    RSPPC
         2 000006   200016 757100                    STAQ    FPT$RSPP,,AUTO

      181      182    2           FPT$RSPP.RESULTS_=VECTOR(RSLT);

    182  2 000007   000000 235000 3                  LDA     0
         2 000010   200020 452500                    STP2    FPT$RSPP+2,,AUTO
         2 000011   200020 236100                    LDQ     FPT$RSPP+2,,AUTO
         2 000012   000006 036003                    ADLQ    6,DU
         2 000013   200016 757100                    STAQ    FPT$RSPP,,AUTO

      182      183    3           DO J=0 TO I-1;

    183  2 000014   200005 450100                    STZ     J,,AUTO
         2 000015   000026 710000 2                  TRA     s:186+1

      183      184    3             RSLT.PNO=PP(J);

    184  2 000016   200003 470500                    LDP0    @PP,,AUTO
         2 000017   200005 720100                    LXL0    J,,AUTO
         2 000020   000000 235110                    LDA     0,X0,PR0
         2 000021   200007 755100                    STA     RSLT+1,,AUTO

      184      185    3             CALL M$RSPP (FPT$RSPP);

    185  2 000022   200016 630500                    EPPR0   FPT$RSPP,,AUTO
         2 000023   030010 713400                    CLIMB   12296
PL6.E3A0      #002=JCM$RELJ File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:19 Page:36   
         2 000024   400000 401760                    pmme    nvectors=1

      185      186    3           END;

    186  2 000025   200005 054100                    AOS     J,,AUTO
         2 000026   200004 470500                    LDP0    @I,,AUTO
         2 000027   200005 236100                    LDQ     J,,AUTO
         2 000030   000016 604000 2                  TMI     s:184
         2 000031   000000 116100                    CMPQ    0,,PR0
         2 000032   000016 602000 2                  TNC     s:184

      186      187    2         END;

      187      188    1         GOTO MXIT;

    188  2 000033   000061 710000 2                  TRA     MXIT

      188      189        /**/
      189      190    1   JCM$MAKEU: ENTRY(PP);

    190  2 000034   000000 700200 xent  JCM$MAKEU    TSX0  ! X66_AUTO_2
         2 000035   000022 000002                    ZERO    18,2

      190      191        /**/
      191      192    1         FPT$MAKUSER=MKUC;

    192  2 000036   000100 100400                    MLR     fill='000'O
         2 000037   000000 000030 1                  ADSC9   MKUC                     cn=0,n=24
         2 000040   200010 000030                    ADSC9   FPT$MAKUSER,,AUTO        cn=0,n=24

      192      193    1         FPT$MAKUSER.V_=VECTOR(FPT$MAKUSER.V);

    193  2 000041   000001 235000 3                  LDA     1
         2 000042   200020 452500                    STP2    FPT$RSPP+2,,AUTO
         2 000043   200020 236100                    LDQ     FPT$RSPP+2,,AUTO
         2 000044   000012 036003                    ADLQ    10,DU
         2 000045   200010 757100                    STAQ    FPT$MAKUSER,,AUTO
PL6.E3A0      #002=JCM$RELJ File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:19 Page:37   

      193      194    1         FPT$MAKUSER.V.JITPP#=PP(0);

    194  2 000046   200003 470500                    LDP0    @PP,,AUTO
         2 000047   000000 235100                    LDA     0,,PR0
         2 000050   200012 755100                    STA     FPT$MAKUSER+2,,AUTO

      194      195    1         FPT$MAKUSER.V.HJITPP#=PP(1);

    195  2 000051   000001 235100                    LDA     1,,PR0
         2 000052   200013 755100                    STA     FPT$MAKUSER+3,,AUTO

      195      196    1         FPT$MAKUSER.V.ROPP#=PP(2);

    196  2 000053   000002 235100                    LDA     2,,PR0
         2 000054   200014 755100                    STA     FPT$MAKUSER+4,,AUTO

      196      197    1         CALL M$MAKUSER (FPT$MAKUSER) ALTRET (BADMAKE);

    197  2 000055   200010 630500                    EPPR0   FPT$MAKUSER,,AUTO
         2 000056   430000 713400                    CLIMB   alt,+12288
         2 000057   400000 401760                    pmme    nvectors=1
         2 000060   000065 702000 2                  TSX2    BADMAKE

    196  2 000061                       MXIT         null
      197      198    1   MXIT: ;
      198      199    2         DO INHIBIT;

      199      200    2           JC_VBSE=JC_VBSE-3;

    200  2 000061   000000 235200 xsym               LDA   ! JC_VBSE
         2 000062   000003 135207                    SBLA  ! 3,DL
         2 000063   000000 755200 xsym               STA   ! JC_VBSE

      200      201    2         END;

      201      202    1         RETURN;
PL6.E3A0      #002=JCM$RELJ File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:19 Page:38   

    202  2 000064   000000 702200 xent               TSX2  ! X66_ARET

    200  2 000065                       BADMAKE      null
      202      203        /**/
      203      204    1   BADMAKE:;
      204      205    1         CALL FOI$CRASH (%S$NOMAKU,F_JC,M_M);

    205  2 000065   000005 630400 3                  EPPR0   5
         2 000066   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000067   000000 701000 xent               TSX1    FOI$CRASH
         2 000070   000000 011000                    NOP     0

      205      206        /*S*  SCREECH_CODE: JCM-S$NOMAKU
      206      207              TYPE:    Screech
      207      208              MESSAGE: SLUG got altreturn from M$MAKUSER
      208      209              REMARKS: SLUG makes a new user by issuing an M$MAKUSER PMME passing
      209      210                       3 physical pages it has set up as a JIT, HJIT, AND ROSEG.
      210      211                       If the PMME altrets, SLUG has malformed one or more of
      211      212                       these.  It is also possible that SLUG and the monitor are
      212      213                       different versions.                                           */
      213      214        /**/
      214      215    1   END;

    215  2 000071   000000 702200 xent               TSX2  ! X66_ARET
      215      216        /**/
      216      217        /**/

PL6.E3A0      #002=JCM$RELJ File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:19 Page:39   
--  Include file information  --

   JC_SCODE_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure JCM$RELJ.
PL6.E3A0      #002=JCM$RELJ File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:19 Page:40   

 **** Variables and constants ****

  ****  Section 001 RoData JCM$RELJ

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(216)   r     1 MKUC                       6-0-0/d STRC(72)    r     1 RSPPC

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @I                         3-0-0/w PTR         r     1 @PP
    10-0-0/d STRC(216)   r     1 FPT$MAKUSER               16-0-0/d STRC(72)    r     1 FPT$RSPP
    *0-0-0/w UBIN        r     1 I                          5-0-0/w SBIN        r     1 J
    *0-0-0/w UBIN        r     1 PP(0:2)                    6-0-0/d STRC(72)    r     1 RSLT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 JC_VBSE


   Procedure JCM$RELJ requires 58 words for executable code.
   Procedure JCM$RELJ requires 18 words of local(AUTO) storage.

    No errors detected in file JCM$MAKEU.:E05TSI    .
PL6.E3A0      #002=JCM$RELJ File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:19 Page:41   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=JCM$RELJ File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:19 Page:42   
          MINI XREF LISTING

BADMAKE
       200**LABEL     197--CALLALT
FOI$CRASH
       119**DCL-ENT   205--CALL
FPT$MAKUSER
       133**DCL       192<<ASSIGN    197<>CALL
FPT$MAKUSER.V
       133**DCL       193--ASSIGN
FPT$MAKUSER.V.HJITPP#
       133**DCL       195<<ASSIGN
FPT$MAKUSER.V.JITPP#
       133**DCL       194<<ASSIGN
FPT$MAKUSER.V.ROPP#
       134**DCL       196<<ASSIGN
FPT$MAKUSER.V_
       133**DCL       193<<ASSIGN
FPT$RSPP
       161**DCL       181<<ASSIGN    185<>CALL
FPT$RSPP.RESULTS_
       161**DCL       182<<ASSIGN
I
       112**DCL         8--PROC      180>>IF        183>>DOINDEX
J
       113**DCL       183<<DOINDEX   184>>ASSIGN
JC_VBSE
       118**DCL       200<<ASSIGN    200>>ASSIGN
M$MAKUSER
        59**DCL-ENT   197--CALL
M$RSPP
        58**DCL-ENT   185--CALL
MKUC
       147**DCL       192>>ASSIGN
PL6.E3A0      #002=JCM$RELJ File=JCM$MAKEU.:E05TSI                               TUE 07/29/97 23:19 Page:43   
MKUC.V
       147**DCL       147--DCLINIT
MXIT
       196**LABEL     188--GOTO
PP
       111**DCL         8--PROC      184>>ASSIGN    190--ENTRY     194>>ASSIGN    195>>ASSIGN    196>>ASSIGN
RSLT
       114**DCL       182--ASSIGN
RSLT.PNO
       116**DCL       184<<ASSIGN
RSPPC
       174**DCL       181>>ASSIGN
