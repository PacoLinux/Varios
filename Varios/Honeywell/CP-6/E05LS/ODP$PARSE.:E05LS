VERSION E05

PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:1    
        1        1        /*M* ODP$PARSE Routine to parse commands for online DOG */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*P* NAME:         ODP$PARSE
       10       10             PURPOSE:      To parse commands for online DOG
       11       11             DESCRIPTION:  Called with the command line in OD_CSCGBUF,
       12       12                           having been read thru M$SI.  OD_CXT$ points
       13       13                           to a context block to be filled in.  The
       14       14                           routine ALTRETs if a syntax error is found,
       15       15                           and otherwise returns with the context block
       16       16                           filled in properly.
       17       17
       18       18                           The available commands are described below:
       19       19
       20       20                           o Any command may begin with 'DISP' or 'DISPLAY',
       21       21                             which is ignored.
       22       22
       23       23                           o Any command may terminate
       24       24                             with '[ON] LP', which forces display to LP
       25       25
       26       26                           The commands are:
       27       27                           o A[LL] [S[HORT]]
       28       28
       29       29                           o I[NPUT]  [[~].ACCT] [[~]@WSN] [S[HORT]]
       30       30
       31       31                           o J[OB] [[~].ACCT] [[~]@WSN] [S[HORT]]
       32       32
       33       33                           o R[UN] [[~].ACCT] [[~]@WSN] [S[HORT]]
       34       34
       35       35                        o O[UTPUT] [[~]FORM formnm] [FOR DT] [[~].ACCT] [[~]@TERM] [S[HORT]]
       36       36
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:2    
       37       37                           o D[EFER]  [[~].ACCT] [[~]@WSN] [S[HORT]]
       38       38
       39       39                           o NO[RUN]  [[~].ACCT] [[~]@WSN] [S[HORT]]
       40       40
       41       41                           o NS[FORM] [[~].ACCT] [[~]@TERM] [S[HORT]]
       42       42
       43       43                           o P[RIO]  n [[TO/-] m] [[~].ACCT] [[~]@WSN] [S[HORT]]
       44       44
       45       45                           o sysid [F[ULL]] [S[HORT]]
       46       46
       47       47                           o %jobname [.ACCT] [F[ULL] [S[HORT]]
       48       48
       49       49                           o M[E] see below
       50       50
       51       51                           o H[ELP]    produces this display
       52       52
       53       53                           o S[YSTEM] causes subsequent commands which are
       54       54                             not explicitly qualified by account, to include
       55       55                             all accounts (if the user has DISPJOB priv;
       56       56                             note that DOG attempts to turn DISPJOB on when
       57       57                             this command is encountered, and rejects the
       58       58                             command as illegal if it cannot).
       59       59                             ME causes subsequent such commands to display
       60       60                             only items bearing the user's own account.
       61       61
       62       62                      On consoles, the display is not given if there are
       63       63                      more than an arbitrarily-chosen number of items.
       64       64                      For online DOG, this is not done, and the FORCE
       65       65                      option is not present.  However, the SHORT option
       66       66                      causes only the above number of items to be displayed.
       67       67
       68       68                      The LP option causes DOG to write to M$LO rather than
       69       69                      M$ME, and to format the display as for the operator
       70       70                      keyin LP option.  M$LO may be set at the discretion
       71       71                      of the user.
       72       72        */
       73       73        /**/
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:3    
       74       74        ODP$PARSE: PROC (ALLFLG) ALTRET;
       75       75        /**/
       76       76
       77       77
       78       78
       79       79        /**/
       80       80        /* PARAMETERS */
       81       81        /**/
       82       82    1   DCL ALLFLG UBIN WORD ALIGNED;
       83       83
       84       84
       85       85
       86       86        /**/
       87       87        /* INCLUDES */
       88       88        /**/
       89       89        %INCLUDE CP_6;
       90      170        %INCLUDE CP_6_SUBS;
       91      710        %INCLUDE OC_MESSHD_C;
       92      763        %INCLUDE OC_SUBS_C;
       93     1494        %INCLUDE OD_SUBS_C;
       94     1555        %INCLUDE OD_MAC_C;
       95     1643        %INCLUDE FOO_MAC_C;
       96     2391        %INCLUDE OD_DATA_R;
       97     2617        %INCLUDE F$DCB;
       98     2666 S      %INCLUDE B$JIT_C;
       99     2667        %INCLUDE XSJ_MAC_C;
      100     2746        %INCLUDE XSJ_SUBS_C;
      101     2773
      102     2774
      103     2775
      104     2776        /**/
      105     2777        /* BASED STRUCTURES */
      106     2778        /**/
      107     2779        %OD_CXT (FPTN=OD$CXT,STCLASS=BASED);
      108     2847    1   DCL B$CHAR CHAR(1) BASED UNAL;
      109     2848    1   DCL B$CHARS CHAR(TDISP) BASED UNAL;
      110     2849        %B$JIT0;
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:4    
      111     2938        %A$JIT6X;
      112     2941
      113     2942
      114     2943
      115     2944        /**/
      116     2945        /* AUTO */
      117     2946        /**/
      118     2947    1   DCL I SBIN;
      119     2948    1   DCL TDISP SBIN WORD;
      120     2949    1   DCL TEMP SBIN WORD;
      121     2950    1   DCL ISIZ SBIN WORD;
      122     2951    1   DCL IDISP SBIN WORD;
      123     2952    1   DCL ICHAR CHAR(1);
      124     2953    1   DCL NOT_ UBIN;
      125     2954
      126     2955
      127     2956
      128     2957        /**/
      129     2958        /* STATIC */
      130     2959        /**/
      131     2960    1   DCL HELP (0:49) CHAR(0) CONSTANT CALIGNED INIT('
      132     2961    1   DOG produces displays that are almost identical',
      133     2962    1   'to those produced as a result of the operator',
      134     2963    1   'console DISPLAY keyins.  The formats of the',
      135     2964    1   'displays are therefore not documented here;',
      136     2965    1   'refer to the OPERATIONS REFERENCE MANUAL.',
      137     2966    1   'Similarly, the names of the various commands',
      138     2967    1   'are held to be self-explanitory since they',
      139     2968    1   'mimic the various DISPLAY keyins.',
      140     2969    1   ' ',
      141     2970    1   'Any command may begin with ''DISP'' or ''DISPLAY'',',
      142     2971    1   'which is ignored.',
      143     2972    1   'Any command may terminate',
      144     2973    1   'with ''[ON] LP'', which forces display thru M$LO',
      145     2974    1   'in a tabular format (M$LO can be set anywhere).',
      146     2975    1   ' ',
      147     2976    1   'The commands are:',
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:5    
      148     2977    1   'o A[LL] [S[HORT]]',
      149     2978    1   ' ',
      150     2979    1   'o I[NPUT]  [[~].ACCT] [[~]@WSN] [S[HORT]]',
      151     2980    1   ' ',
      152     2981    1   'o J[OB] [[~].ACCT] [[~]@WSN] [S[HORT]]',
      153     2982    1   ' ',
      154     2983    1   'o R[UN] [[~].ACCT] [[~]@WSN] [S[HORT]]',
      155     2984    1   ' ',
      156     2985    1   'o O[UTPUT] [[~]FORM formnm] [FOR DT] [[~].ACCT] [[~]@TERM] [S[HORT]]',
      157     2986    1   ' ',
      158     2987    1   'o D[EFER]  [[~].ACCT] [[~]@WSN] [S[HORT]]',
      159     2988    1   ' ',
      160     2989    1   'o NO[RUN]  [[~].ACCT] [[~]@WSN] [S[HORT]]',
      161     2990    1   ' ',
      162     2991    1   'o NS[FORM] [[~].ACCT] [[~]@TERM] [S[HORT]]',
      163     2992    1   ' ',
      164     2993    1   'o P[RIO]  n [[TO/-] m] [[~].ACCT] [[~]@WSN] [S[HORT]]',
      165     2994    1   ' ',
      166     2995    1   'o sysid [F[ULL]] [S[HORT]]',
      167     2996    1   ' ',
      168     2997    1   'o %jobname [.ACCT] [F[ULL] [S[HORT]]',
      169     2998    1   ' ',
      170     2999    1   'o M[E] see SYSTEM below',
      171     3000    1   ' ',
      172     3001    1   'o H[ELP]    produces this display',
      173     3002    1   ' ',
      174     3003    1   'o S[YSTEM] causes subsequent commands which are',
      175     3004    1   '  not explicitly qualified by account, to include',
      176     3005    1   '  all accounts (if the user has DISPJOB priv;',
      177     3006    1   '  note that DOG attempts to turn DISPJOB on when',
      178     3007    1   '  this command is encountered, and rejects the',
      179     3008    1   '  command as illegal if it cannot).',
      180     3009    1   '  ME causes subsequent such commands to display',
      181     3010    1   '  only items bearing the user''s own account.');
      182     3011    1   DCL TOKEN CHAR(32) STATIC ALIGNED;
      183     3012    1   DCL JNAME CHAR(31) STATIC ALIGNED;
      184     3013    1   DCL JACCT CHAR(8) STATIC ALIGNED;
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:6    
      185     3014        %XSJ_PARAM              (FPTN=JOPN,
      186     3015                 MODE      = %IN#,
      187     3016                 DCB       = M$JSF,
      188     3017                 STCLASS   = STATIC);
      189     3034        %XSJ_PARAM              (FPTN=JREAD,
      190     3035                 DCB       = M$JSF,
      191     3036                 TYPE      = %TYP_NAME#,
      192     3037                 BUF       = XSJ_NAMEREC,
      193     3038                 ACCT      = JACCT,
      194     3039                 NAME      = JNAME,
      195     3040                 STCLASS   = STATIC);
      196     3057        %XSJ_NAMEREC;
      197     3070
      198     3071
      199     3072
      200     3073        /**/
      201     3074        /* DCBS */
      202     3075        /**/
      203     3076    1   DCL M$ME DCB;
      204     3077    1   DCL M$SI DCB;
      205     3078    1   DCL M$JSF DCB;
      206     3079
      207     3080
      208     3081
      209     3082        /**/
      210     3083        /* PMME FPTS */
      211     3084        /**/
      212     3085        %FPT_PRIV                              (FPTN=SET_DISPJOB,
      213     3086                 PRIV      = %PR_DISPJOB#,
      214     3087                 AUTH      = YES,
      215     3088                 STCLASS   = CONSTANT);
      216     3103        %FPT_WRITE                            (FPTN=WRITE_HELP,
      217     3104                 DCB       = M$ME,
      218     3105                 BUF       = NIL,
      219     3106                 VFC       = NO,
      220     3107                 STCLASS   = STATIC);
      221     3138
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:7    
      222     3139
      223     3140
      224     3141        /**/
      225     3142        /* REFS */
      226     3143        /**/
      227     3144    1   DCL B$JIT$ PTR SYMREF;
      228     3145    1   DCL XSJ$OPEN ENTRY(1) ALTRET;
      229     3146    1   DCL XSJ$READ ENTRY(1) ALTRET;
      230     3147        %EJECT;
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:8    
      231     3148
      232     3149        /**/
      233     3150        /* START HERE */
      234     3151        /**/
      235     3152
      236     3153    1         OD_CXT=OD_CXT_INIT;
      237     3154    1         OD_CXT.LPWSN=B$JIT$->B$JIT.WOO;
      238     3155    1         OD_CXT.SWSN=' ';
      239     3156    1         OD_CXT.STNAME=' ';
      240     3157    1         OD_CXT.SFORM=' ';
      241     3158    1         OD_CXT.NOTACCT=0;
      242     3159    1         OD_CXT.NOTFORM=0;
      243     3160    1         OD_CXT.NOTWSN=0;
      244     3161    1         OD_CXT.NOTTERM=0;
      245     3162    1         OD_CXT.DEVTYP=' ';
      246     3163    1         OD_CXT.SACCT=' ';
      247     3164    1         OD_CXT.FORCE=1;
      248     3165    1         OD_CXT.ONLP=0;
      249     3166    1         OD_CXT.CATTR.OUTPUT='777777'O;
      250     3167    1         ISIZ=DCBADDR(DCBNUM(M$SI))->F$DCB.ARS;
      251     3168    1         IF ISIZ = 0 THEN CALL M$EXIT;
      252     3169    1         IDISP=0;
      253     3170    1   CMD0: ;
      254     3171    1         CALL GTOKE ALTRET(ALTRT);
      255     3172    1         IF SUBSTR(TOKEN,0,4) = 'DISP'
      256     3173    1         OR SUBSTR(TOKEN,0,4) = 'disp' THEN
      257     3174    2           DO;
      258     3175    2           IF TOKEN = 'DISP'
      259     3176    2           OR TOKEN = 'disp'
      260     3177    2           OR TOKEN = 'display'
      261     3178    2           OR TOKEN = 'DISPLAY' THEN GOTO CMD0;
      262     3179    2           IF TDISP = 8 THEN TOKEN=SUBSTR(TOKEN,7,1);
      263     3180    2           ELSE TOKEN=SUBSTR(TOKEN,4,4);
      264     3181    2           END;
      265     3182        /**/
      266     3183    1         IF  SUBSTR(TOKEN,0,1) = 'X'  OR SUBSTR(TOKEN,0,1) = 'x'
      267     3184    1         OR SUBSTR(TOKEN,0,1) = 'Q'   OR SUBSTR(TOKEN,0,1) = 'q'
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:9    
      268     3185    1         OR SUBSTR(TOKEN,0,1) = 'E' OR SUBSTR(TOKEN,0,1) = 'e' THEN
      269     3186    1          CALL M$EXIT;
      270     3187        /**/
      271     3188    1         IF SUBSTR(TOKEN,0,1) = 'M'
      272     3189    1         OR SUBSTR(TOKEN,0,1) = 'm' THEN
      273     3190    2           DO;
      274     3191                                /* ME COMMAND */
      275     3192    2           ALLFLG=0;
      276     3193    2           GOTO CMD01;
      277     3194    2           END;
      278     3195        /**/
      279     3196    1         IF SUBSTR(TOKEN,0,1) = 'H'
      280     3197    1         OR SUBSTR(TOKEN,0,1) = 'h' THEN
      281     3198    2           DO;
      282     3199                                /* HELP   COMMAND */
      283     3200    3             DO I = 0 TO 49;
      284     3201    3             WRITE_HELP.BUF_=VECTOR(HELP(I));
      285     3202    3             CALL M$WRITE (WRITE_HELP);
      286     3203    3             END;
      287     3204    2           GOTO CMD01;
      288     3205    2           END;
      289     3206        /**/
      290     3207    1         IF SUBSTR(TOKEN,0,1) = 'S'
      291     3208    1         OR SUBSTR(TOKEN,0,1) = 's' THEN
      292     3209    2           DO;
      293     3210                                /* SYSTEM COMMAND */
      294     3211    2           ALLFLG=1;
      295     3212    2           CALL M$SPRIV (SET_DISPJOB) ALTRET(BADCMD);
      296     3213    2   CMD01:  ;
      297     3214    2           OD_CXT.KIN#=0;
      298     3215    2           RETURN;
      299     3216    2           END;
      300     3217        /**/
      301     3218    1         IF SUBSTR(TOKEN,0,1) = 'A'
      302     3219    1         OR SUBSTR(TOKEN,0,1) = 'a' THEN
      303     3220    2           DO;
      304     3221    2           OD_CXT.KIN#=KEY_DISPALL#;
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:10   
      305     3222    2           CALL GTOKE ALTRET(GOTCMD);
      306     3223    2           GOTO CMD11;
      307     3224    2           END;
      308     3225        /**/
      309     3226    1         IF SUBSTR(TOKEN,0,1) = 'I'
      310     3227    1         OR SUBSTR(TOKEN,0,1) = 'i' THEN
      311     3228    2           DO;
      312     3229    2           OD_CXT.KIN#=KEY_DISPINPUT#;
      313     3230    2           CALL GTOKE ALTRET(GOTCMD);
      314     3231    2           GOTO CMD1;
      315     3232    2           END;
      316     3233        /**/
      317     3234    1         IF SUBSTR(TOKEN,0,1) = 'O'
      318     3235    1         OR SUBSTR(TOKEN,0,1) = 'o' THEN
      319     3236    2           DO;
      320     3237    2           OD_CXT.KIN#=KEY_DISPOUTPUT#;
      321     3238    2           CALL GTOKE ALTRET(GOTCMD);
      322     3239    2           IF TOKEN = 'FORM' THEN
      323     3240    3             DO;
      324     3241    3             OD_CXT.NOTFORM=NOT_;
      325     3242    3             CALL GTOKE ALTRET(BADCMD);
      326     3243    3             OD_CXT.SFORM=TOKEN;
      327     3244    3             CALL GTOKE ALTRET(GOTCMD);
      328     3245    3             END;
      329     3246    2           IF TOKEN = 'FOR' THEN
      330     3247    3             DO;
      331     3248    3             CALL GTOKE ALTRET(BADCMD);
      332     3249    3             OD_CXT.DEVTYP=TOKEN;
      333     3250    3             CALL GTOKE ALTRET(GOTCMD);
      334     3251    3             END;
      335     3252    2   CMD1:   ;
      336     3253    2           IF SUBSTR(TOKEN,0,1) = '.' THEN
      337     3254    3             DO;
      338     3255    3             OD_CXT.SACCT=SUBSTR(TOKEN,1,11);
      339     3256    3             OD_CXT.NOTACCT=NOT_;
      340     3257    3             CALL GTOKE ALTRET(GOTCMD);
      341     3258    3             END;
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:11   
      342     3259    2           IF SUBSTR(TOKEN,0,1) = '@' THEN
      343     3260    3             DO;
      344     3261    3             OD_CXT.SWSN=SUBSTR(TOKEN,1,11);
      345     3262    3             OD_CXT.NOTWSN=NOT_;
      346     3263    3             OD_CXT.STNAME=OD_CXT.SWSN;
      347     3264    3             OD_CXT.NOTTERM=NOT_;
      348     3265    3             CALL GTOKE ALTRET(GOTCMD);
      349     3266    3             END;
      350     3267    2   CMD11:  ;
      351     3268    2           IF SUBSTR(TOKEN,0,1) = 'S'
      352     3269    2           OR SUBSTR(TOKEN,0,1) = 's' THEN
      353     3270    3             DO;
      354     3271    3             OD_CXT.FORCE=2; /* SHORT */
      355     3272    3             CALL GTOKE ALTRET(GOTCMD);
      356     3273    3             END;
      357     3274    2           IF TOKEN = 'ON'
      358     3275    2           OR TOKEN = 'on' THEN
      359     3276    3             DO;
      360     3277    3             CALL GTOKE ALTRET(BADCMD);
      361     3278    3             END;
      362     3279    2           IF TOKEN = 'LP'
      363     3280    2           OR TOKEN = 'lp' THEN
      364     3281    3             DO;
      365     3282    3             OD_CXT.ONLP=1;
      366     3283    3             GOTO GOTCMD;
      367     3284    3             END;
      368     3285    2           GOTO BADCMD;
      369     3286    2           END;
      370     3287    1         IF  SUBSTR(TOKEN,0,1) = 'J'
      371     3288    1         OR  SUBSTR(TOKEN,0,1) = 'j'
      372     3289    1         OR  SUBSTR(TOKEN,0,1) = 'R'
      373     3290    1         OR SUBSTR(TOKEN,0,1) = 'r' THEN
      374     3291    2           DO;
      375     3292    2           OD_CXT.KIN#=KEY_DISPJOB#;
      376     3293    2           CALL GTOKE ALTRET(GOTCMD);
      377     3294    2           GOTO CMD1;
      378     3295    2           END;
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:12   
      379     3296        /**/
      380     3297    1         IF SUBSTR(TOKEN,0,1) = 'D'
      381     3298    1         OR SUBSTR(TOKEN,0,1) = 'd' THEN
      382     3299    2           DO;
      383     3300    2           OD_CXT.KIN#=KEY_DISPDEFER#;
      384     3301    2           CALL GTOKE ALTRET(GOTCMD);
      385     3302    2           GOTO CMD1;
      386     3303    2           END;
      387     3304        /**/
      388     3305    1         IF SUBSTR(TOKEN,0,2) = 'NO'
      389     3306    1         OR SUBSTR(TOKEN,0,2) = 'no' THEN
      390     3307    2           DO;
      391     3308    2           OD_CXT.KIN#=KEY_DISPNORUN#;
      392     3309    2           CALL GTOKE ALTRET(GOTCMD);
      393     3310    2           GOTO CMD1;
      394     3311    2           END;
      395     3312        /**/
      396     3313    1         IF SUBSTR(TOKEN,0,2) = 'NS'
      397     3314    1         OR SUBSTR(TOKEN,0,2) = 'ns' THEN
      398     3315    2           DO;
      399     3316    2           OD_CXT.KIN#=KEY_DISPNSFORM#;
      400     3317    2           CALL GTOKE ALTRET(GOTCMD);
      401     3318    2           GOTO CMD1;
      402     3319    2           END;
      403     3320        /**/
      404     3321    1         IF SUBSTR(TOKEN,0,1) = 'P'
      405     3322    1         OR SUBSTR(TOKEN,0,1) = 'p' THEN
      406     3323    2           DO;
      407     3324    2           OD_CXT.KIN#=KEY_DISPPRIO#;
      408     3325    2           CALL GTOKE ALTRET(BADCMD);
      409     3326    2           CALL GNUM ALTRET(BADCMD);
      410     3327    2           OD_CXT.LOPRIO=TEMP;
      411     3328    2           OD_CXT.HIPRIO=OD_CXT.LOPRIO;
      412     3329    2           CALL GTOKE ALTRET(GOTCMD);
      413     3330    2   CMD2:   ;
      414     3331    2           IF SUBSTR(TOKEN,0,1) >= '0'
      415     3332    2           AND SUBSTR(TOKEN,0,1) <= '9' THEN
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:13   
      416     3333    3             DO;
      417     3334    3             CALL GNUM ALTRET(BADCMD);
      418     3335    3             OD_CXT.HIPRIO=TEMP;
      419     3336    3             CALL GTOKE ALTRET(GOTCMD);
      420     3337    3             GOTO CMD1;
      421     3338    3             END;
      422     3339    2           IF TOKEN = '-'
      423     3340    2           OR TOKEN = 'TO'
      424     3341    2           OR TOKEN = 'to' THEN
      425     3342    3             DO;
      426     3343    3             CALL GTOKE ALTRET(BADCMD);
      427     3344    3             GOTO CMD2;
      428     3345    3             END;
      429     3346    2           GOTO CMD1;
      430     3347    2           END;
      431     3348        /**/
      432     3349    1         IF  SUBSTR(TOKEN,0,1) >= '0'
      433     3350    1         AND SUBSTR(TOKEN,0,1) <= '9' THEN
      434     3351    2           DO;
      435     3352    2           OD_CXT.KIN#=KEY_DISPSYSID#;
      436     3353    2           CALL GNUM ALTRET(BADCMD);
      437     3354    2           OD_CXT.SYSID=TEMP;
      438     3355    2           OD_CXT.FULL=0;
      439     3356    2           CALL GTOKE ALTRET(GOTCMD);
      440     3357    2   CMD8:   ;
      441     3358    2           IF SUBSTR(TOKEN,0,1) = 'F'
      442     3359    2           OR SUBSTR(TOKEN,0,1) = 'f' THEN
      443     3360    3             DO;
      444     3361    3             OD_CXT.FULL=1;
      445     3362    3             CALL GTOKE ALTRET(GOTCMD);
      446     3363    3             END;
      447     3364    2           GOTO CMD11;
      448     3365    2           END;
      449     3366        /**/
      450     3367    1         IF SUBSTR(TOKEN,0,1) = '%' THEN
      451     3368    2           DO;
      452     3369    2           JNAME=SUBSTR(TOKEN,1,31);
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:14   
      453     3370    2           JACCT=B$JIT$->B$JIT.ACCN;
      454     3371    2           CALL GTOKE ALTRET(CMD9);
      455     3372    2           IF SUBSTR(TOKEN,0,1) = '.' THEN
      456     3373    3             DO;
      457     3374    3             JACCT=SUBSTR(TOKEN,1,8);
      458     3375    3             CALL GTOKE;
      459     3376    3             END;
      460     3377    2   CMD9:   ;
      461     3378    2           OD_CXT.KIN#=KEY_DISPSYSID#;
      462     3379    2           OD_CXT.SYSID=256000;
      463     3380    2           IF DCBADDR(DCBNUM(M$JSF))->F$DCB.FCD = '0'B THEN
      464     3381    2            CALL XSJ$OPEN (JOPN) ALTRET(GOTCMD);
      465     3382    2           CALL XSJ$READ (JREAD) ALTRET(GOTCMD);
      466     3383    2           OD_CXT.SYSID=XSJ_NAMEREC.SYSID#;
      467     3384    2           OD_CXT.FULL=0;
      468     3385    2           IF TOKEN ~= ' ' THEN
      469     3386    2            GOTO CMD8;
      470     3387    2           GOTO GOTCMD;
      471     3388    2           END;
      472     3389        /**/
      473     3390    1   BADCMD:;
      474     3391    1   ALTRT:;
      475     3392    1         ALTRETURN;
      476     3393    1   GOTCMD:;
      477     3394    1         RETURN;
      478     3395
      479     3396        /**/
      480     3397        /* PROC TO GET THE NEXT TOKEN */
      481     3398        /**/
      482     3399    1   GTOKE: PROC ALTRET;
      483     3400    2         NOT_=0;
      484     3401    2         TDISP=0;
      485     3402    2         TOKEN=' ';
      486     3403    3           DO WHILE (IDISP < ISIZ);
      487     3404    3           ICHAR=PINCRC(ADDR(OD_CSCGBUF),IDISP)->B$CHAR;
      488     3405    3           IF ICHAR ~= ' ' THEN
      489     3406    4             DO;
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:15   
      490     3407        /**/
      491     3408    4             IF ICHAR = '~' THEN
      492     3409    5               DO;
      493     3410    5               NOT_=1;
      494     3411    5               IDISP=IDISP+1;
      495     3412    5               IF IDISP = ISIZ THEN ALTRETURN;
      496     3413    5               ICHAR=PINCRC(ADDR(OD_CSCGBUF),IDISP)->B$CHAR;
      497     3414    5               END;
      498     3415    4             CALL INSERT (TOKEN,TDISP,1,ICHAR);
      499     3416    4             TDISP=TDISP+1;
      500     3417    4             IDISP=IDISP+1;
      501     3418    5               DO WHILE (IDISP < ISIZ);
      502     3419    5               ICHAR=PINCRC(ADDR(OD_CSCGBUF),IDISP)->B$CHAR;
      503     3420    5               IF ICHAR = ' ' THEN RETURN;
      504     3421    5               IF TDISP > 11 THEN ALTRETURN;
      505     3422    5               CALL INSERT (TOKEN,TDISP,1,ICHAR);
      506     3423    5               TDISP=TDISP+1;
      507     3424    5               IDISP=IDISP+1;
      508     3425    5               END;
      509     3426    4             RETURN;
      510     3427    4             END;
      511     3428    3           IDISP=IDISP+1;
      512     3429    3           END;
      513     3430    2         ALTRETURN;
      514     3431    2   END GTOKE;
      515     3432        /* PROC TO GET TEMP AS UBIN FROM TOKEN */
      516     3433    1   GNUM: PROC ALTRET;
      517     3434        /**/
      518     3435    2   DCL J SBIN;
      519     3436        /**/
      520     3437    3           DO J = 0 TO TDISP-1;
      521     3438    3           IF SUBSTR(TOKEN,J,1) < '0'
      522     3439    3           OR SUBSTR(TOKEN,J,1) > '9' THEN ALTRETURN;
      523     3440    3           END;
      524     3441    2         CALL CHARBIN (TEMP,ADDR(TOKEN)->B$CHARS);
      525     3442    2         RETURN;
      526     3443    2   END GNUM;
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:16   
      527     3444    1   END ODP$PARSE;

PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:17   
--  Include file information  --

   XSJ_SUBS_C.:E05TOU  is referenced.
   XSJ_MAC_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   OD_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FOO_MAC_C.:E05TOU  is referenced.
   OD_MAC_C.:E05TOU  is referenced.
   OD_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ODP$PARSE.

   Procedure ODP$PARSE requires 566 words for executable code.
   Procedure ODP$PARSE requires 16 words of local(AUTO) storage.

    No errors detected in file ODP$PARSE.:E05TSI    .

PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:18   

 Object Unit name= ODP$PARSE                                  File name= ODP$PARSE.:E05TOU
 UTS= JUL 30 '97 04:12:41.20 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    871   1547  ODP$PARSE
    2   Data  even  none    48     60  ODP$PARSE
    3   DCB   even  none     0      0  M$ME
    4   DCB   even  none     0      0  M$SI
    5   DCB   even  none     0      0  M$JSF
    6   Proc  even  none   566   1066  ODP$PARSE
    7  RoData even  none     8     10  ODP$PARSE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     6      0   yes    yes     yes      Std        1  ODP$PARSE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 XSJ$OPEN
 yes     yes           Std       1 XSJ$READ
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:19   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  OD_CSCGBUF                            OD_CXT_INIT
     OD_CXT                                M$ME                                  M$SI
     M$JSF                                 B$JIT$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID                                 ROSID
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:20   


        1        1        /*M* ODP$PARSE Routine to parse commands for online DOG */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7       /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*P* NAME:         ODP$PARSE
       10       10             PURPOSE:      To parse commands for online DOG
       11       11             DESCRIPTION:  Called with the command line in OD_CSCGBUF,
       12       12                           having been read thru M$SI.  OD_CXT$ points
       13       13                           to a context block to be filled in.  The
       14       14                           routine ALTRETs if a syntax error is found,
       15       15                           and otherwise returns with the context block
       16       16                           filled in properly.
       17       17
       18       18                           The available commands are described below:
       19       19
       20       20                           o Any command may begin with 'DISP' or 'DISPLAY',
       21       21                             which is ignored.
       22       22
       23       23                           o Any command may terminate
       24       24                             with '[ON] LP', which forces display to LP
       25       25
       26       26                           The commands are:
       27       27                           o A[LL] [S[HORT]]
       28       28
       29       29                           o I[NPUT]  [[~].ACCT] [[~]@WSN] [S[HORT]]
       30       30
       31       31                           o J[OB] [[~].ACCT] [[~]@WSN] [S[HORT]]
       32       32
       33       33                           o R[UN] [[~].ACCT] [[~]@WSN] [S[HORT]]
       34       34
       35       35                       o O[UTPUT] [[~]FORM formnm] [FOR DT] [[~].ACCT] [[~]@TERM] [S[HORT]]
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:21   
       36       36
       37       37                           o D[EFER]  [[~].ACCT] [[~]@WSN] [S[HORT]]
       38       38
       39       39                           o NO[RUN]  [[~].ACCT] [[~]@WSN] [S[HORT]]
       40       40
       41       41                           o NS[FORM] [[~].ACCT] [[~]@TERM] [S[HORT]]
       42       42
       43       43                           o P[RIO]  n [[TO/-] m] [[~].ACCT] [[~]@WSN] [S[HORT]]
       44       44
       45       45                           o sysid [F[ULL]] [S[HORT]]
       46       46
       47       47                           o %jobname [.ACCT] [F[ULL] [S[HORT]]
       48       48
       49       49                           o M[E] see below
       50       50
       51       51                           o H[ELP]    produces this display
       52       52
       53       53                           o S[YSTEM] causes subsequent commands which are
       54       54                             not explicitly qualified by account, to include
       55       55                             all accounts (if the user has DISPJOB priv;
       56       56                             note that DOG attempts to turn DISPJOB on when
       57       57                             this command is encountered, and rejects the
       58       58                             command as illegal if it cannot).
       59       59                             ME causes subsequent such commands to display
       60       60                             only items bearing the user's own account.
       61       61
       62       62                      On consoles, the display is not given if there are
       63       63                      more than an arbitrarily-chosen number of items.
       64       64                      For online DOG, this is not done, and the FORCE
       65       65                      option is not present.  However, the SHORT option
       66       66                      causes only the above number of items to be displayed.
       67       67
       68       68                      The LP option causes DOG to write to M$LO rather than
       69       69                      M$ME, and to format the display as for the operator
       70       70                      keyin LP option.  M$LO may be set at the discretion
       71       71                      of the user.
       72       72        */
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:22   
       73       73        /**/
       74       74        ODP$PARSE: PROC (ALLFLG) ALTRET;

     74  6 000000   000000 700200 xent  ODP$PARSE    TSX0  ! X66_AUTO_1
         6 000001   000020 000001                    ZERO    16,1

       75       75        /**/
       76       76
       77       77
       78       78
       79       79        /**/
       80       80        /* PARAMETERS */
       81       81        /**/
       82       82    1   DCL ALLFLG UBIN WORD ALIGNED;
       83       83
       84       84
       85       85
       86       86        /**/
       87       87        /* INCLUDES */
       88       88        /**/
       89       89        %INCLUDE CP_6;
       90      170        %INCLUDE CP_6_SUBS;
       91      710        %INCLUDE OC_MESSHD_C;
       92      763        %INCLUDE OC_SUBS_C;
       93     1494        %INCLUDE OD_SUBS_C;
       94     1555        %INCLUDE OD_MAC_C;
       95     1643        %INCLUDE FOO_MAC_C;
       96     2391        %INCLUDE OD_DATA_R;
       97     2617        %INCLUDE F$DCB;
       98     2666 S      %INCLUDE B$JIT_C;
       99     2667        %INCLUDE XSJ_MAC_C;
      100     2746        %INCLUDE XSJ_SUBS_C;
      101     2773
      102     2774
      103     2775
      104     2776        /**/
      105     2777        /* BASED STRUCTURES */
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:23   
      106     2778        /**/
      107     2779        %OD_CXT (FPTN=OD$CXT,STCLASS=BASED);
      108     2847    1   DCL B$CHAR CHAR(1) BASED UNAL;
      109     2848    1   DCL B$CHARS CHAR(TDISP) BASED UNAL;
      110     2849        %B$JIT0;
      111     2938        %A$JIT6X;
      112     2941
      113     2942
      114     2943
      115     2944        /**/
      116     2945        /* AUTO */
      117     2946        /**/
      118     2947    1   DCL I SBIN;
      119     2948    1   DCL TDISP SBIN WORD;
      120     2949    1   DCL TEMP SBIN WORD;
      121     2950    1   DCL ISIZ SBIN WORD;
      122     2951    1   DCL IDISP SBIN WORD;
      123     2952    1   DCL ICHAR CHAR(1);
      124     2953    1   DCL NOT_ UBIN;
      125     2954
      126     2955
      127     2956
      128     2957        /**/
      129     2958        /* STATIC */
      130     2959        /**/
      131     2960    1   DCL HELP (0:49) CHAR(0) CONSTANT CALIGNED INIT('
      132     2961    1   DOG produces displays that are almost identical',
      133     2962    1   'to those produced as a result of the operator',
      134     2963    1   'console DISPLAY keyins.  The formats of the',
      135     2964    1   'displays are therefore not documented here;',
      136     2965    1   'refer to the OPERATIONS REFERENCE MANUAL.',
      137     2966    1   'Similarly, the names of the various commands',
      138     2967    1   'are held to be self-explanitory since they',
      139     2968    1   'mimic the various DISPLAY keyins.',
      140     2969    1   ' ',
      141     2970    1   'Any command may begin with ''DISP'' or ''DISPLAY'',',
      142     2971    1   'which is ignored.',
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:24   
      143     2972    1   'Any command may terminate',
      144     2973    1   'with ''[ON] LP'', which forces display thru M$LO',
      145     2974    1   'in a tabular format (M$LO can be set anywhere).',
      146     2975    1   ' ',
      147     2976    1   'The commands are:',
      148     2977    1   'o A[LL] [S[HORT]]',
      149     2978    1   ' ',
      150     2979    1   'o I[NPUT]  [[~].ACCT] [[~]@WSN] [S[HORT]]',
      151     2980    1   ' ',
      152     2981    1   'o J[OB] [[~].ACCT] [[~]@WSN] [S[HORT]]',
      153     2982    1   ' ',
      154     2983    1   'o R[UN] [[~].ACCT] [[~]@WSN] [S[HORT]]',
      155     2984    1   ' ',
      156     2985    1   'o O[UTPUT] [[~]FORM formnm] [FOR DT] [[~].ACCT] [[~]@TERM] [S[HORT]]',
      157     2986    1   ' ',
      158     2987    1   'o D[EFER]  [[~].ACCT] [[~]@WSN] [S[HORT]]',
      159     2988    1   ' ',
      160     2989    1   'o NO[RUN]  [[~].ACCT] [[~]@WSN] [S[HORT]]',
      161     2990    1   ' ',
      162     2991    1   'o NS[FORM] [[~].ACCT] [[~]@TERM] [S[HORT]]',
      163     2992    1   ' ',
      164     2993    1   'o P[RIO]  n [[TO/-] m] [[~].ACCT] [[~]@WSN] [S[HORT]]',
      165     2994    1   ' ',
      166     2995    1   'o sysid [F[ULL]] [S[HORT]]',
      167     2996    1   ' ',
      168     2997    1   'o %jobname [.ACCT] [F[ULL] [S[HORT]]',
      169     2998    1   ' ',
      170     2999    1   'o M[E] see SYSTEM below',
      171     3000    1   ' ',
      172     3001    1   'o H[ELP]    produces this display',
      173     3002    1   ' ',
      174     3003    1   'o S[YSTEM] causes subsequent commands which are',
      175     3004    1   '  not explicitly qualified by account, to include',
      176     3005    1   '  all accounts (if the user has DISPJOB priv;',
      177     3006    1   '  note that DOG attempts to turn DISPJOB on when',
      178     3007    1   '  this command is encountered, and rejects the',
      179     3008    1   '  command as illegal if it cannot).',
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:25   
      180     3009    1   '  ME causes subsequent such commands to display',
      181     3010    1   '  only items bearing the user''s own account.');
      182     3011    1   DCL TOKEN CHAR(32) STATIC ALIGNED;
      183     3012    1   DCL JNAME CHAR(31) STATIC ALIGNED;
      184     3013    1   DCL JACCT CHAR(8) STATIC ALIGNED;
      185     3014        %XSJ_PARAM              (FPTN=JOPN,
      186     3015                 MODE      = %IN#,
      187     3016                 DCB       = M$JSF,
      188     3017                 STCLASS   = STATIC);
      189     3034        %XSJ_PARAM              (FPTN=JREAD,
      190     3035                 DCB       = M$JSF,
      191     3036                 TYPE      = %TYP_NAME#,
      192     3037                 BUF       = XSJ_NAMEREC,
      193     3038                 ACCT      = JACCT,
      194     3039                 NAME      = JNAME,
      195     3040                 STCLASS   = STATIC);
      196     3057        %XSJ_NAMEREC;
      197     3070
      198     3071
      199     3072
      200     3073        /**/
      201     3074        /* DCBS */
      202     3075        /**/
      203     3076    1   DCL M$ME DCB;
      204     3077    1   DCL M$SI DCB;
      205     3078    1   DCL M$JSF DCB;
      206     3079
      207     3080
      208     3081
      209     3082        /**/
      210     3083        /* PMME FPTS */
      211     3084        /**/
      212     3085        %FPT_PRIV                              (FPTN=SET_DISPJOB,
      213     3086                 PRIV      = %PR_DISPJOB#,
      214     3087                 AUTH      = YES,
      215     3088                 STCLASS   = CONSTANT);
      216     3103        %FPT_WRITE                            (FPTN=WRITE_HELP,
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:26   
      217     3104                 DCB       = M$ME,
      218     3105                 BUF       = NIL,
      219     3106                 VFC       = NO,
      220     3107                 STCLASS   = STATIC);
      221     3138
      222     3139
      223     3140
      224     3141        /**/
      225     3142        /* REFS */
      226     3143        /**/
      227     3144    1   DCL B$JIT$ PTR SYMREF;
      228     3145    1   DCL XSJ$OPEN ENTRY(1) ALTRET;
      229     3146    1   DCL XSJ$READ ENTRY(1) ALTRET;
      230     3147        %EJECT;
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:27   
      231     3148
      232     3149        /**/
      233     3150        /* START HERE */
      234     3151        /**/
      235     3152
      236     3153    1         OD_CXT=OD_CXT_INIT;

   3153  6 000002   000000 100400                    MLR     fill='000'O
         6 000003   000000 000130 xsym               ADSC9   OD_CXT_INIT              cn=0,n=88
         6 000004   000000 000130 xsym               ADSC9   OD_CXT                   cn=0,n=88

      237     3154    1         OD_CXT.LPWSN=B$JIT$->B$JIT.WOO;

   3154  6 000005   000000 470400 xsym               LDP0    B$JIT$
         6 000006   000010 237100                    LDAQ    8,,PR0
         6 000007   000011 755000 xsym               STA     OD_CXT+9
         6 000010   000012 756000 xsym               STQ     OD_CXT+10

      238     3155    1         OD_CXT.SWSN=' ';

   3155  6 000011   000035 235000 xsym               LDA     B_VECTNIL+29
         6 000012   000035 236000 xsym               LDQ     B_VECTNIL+29
         6 000013   000015 755000 xsym               STA     OD_CXT+13
         6 000014   000016 756000 xsym               STQ     OD_CXT+14

      239     3156    1         OD_CXT.STNAME=' ';

   3156  6 000015   000035 235000 xsym               LDA     B_VECTNIL+29
         6 000016   000035 236000 xsym               LDQ     B_VECTNIL+29
         6 000017   000017 755000 xsym               STA     OD_CXT+15
         6 000020   000020 756000 xsym               STQ     OD_CXT+16

      240     3157    1         OD_CXT.SFORM=' ';

   3157  6 000021   040000 100400                    MLR     fill='040'O
         6 000022   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000023   000023 000006 xsym               ADSC9   OD_CXT+19                cn=0,n=6
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:28   

      241     3158    1         OD_CXT.NOTACCT=0;

   3158  6 000024   000000 236003                    LDQ     0,DU
         6 000025   000013 552010 xsym               STBQ    OD_CXT+11,'10'O

      242     3159    1         OD_CXT.NOTFORM=0;

   3159  6 000026   000024 552010 xsym               STBQ    OD_CXT+20,'10'O

      243     3160    1         OD_CXT.NOTWSN=0;

   3160  6 000027   000013 552004 xsym               STBQ    OD_CXT+11,'04'O

      244     3161    1         OD_CXT.NOTTERM=0;

   3161  6 000030   000013 552004 xsym               STBQ    OD_CXT+11,'04'O

      245     3162    1         OD_CXT.DEVTYP=' ';

   3162  6 000031   040040 220003                    LDX0    16416,DU
         6 000032   000013 740000 xsym               STX0    OD_CXT+11

      246     3163    1         OD_CXT.SACCT=' ';

   3163  6 000033   000035 235000 xsym               LDA     B_VECTNIL+29
         6 000034   000035 236000 xsym               LDQ     B_VECTNIL+29
         6 000035   000021 755000 xsym               STA     OD_CXT+17
         6 000036   000022 756000 xsym               STQ     OD_CXT+18

      247     3164    1         OD_CXT.FORCE=1;

   3164  6 000037   000001 221003                    LDX1    1,DU
         6 000040   000007 441000 xsym               SXL1    OD_CXT+7

      248     3165    1         OD_CXT.ONLP=0;

PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:29   
   3165  6 000041   000000 222003                    LDX2    0,DU
         6 000042   000007 742000 xsym               STX2    OD_CXT+7

      249     3166    1         OD_CXT.CATTR.OUTPUT='777777'O;

   3166  6 000043   777777 223003                    LDX3    -1,DU
         6 000044   000025 443000 xsym               SXL3    OD_CXT+21

      250     3167    1         ISIZ=DCBADDR(DCBNUM(M$SI))->F$DCB.ARS;

   3167  6 000045   000000 236007 xsym               LDQ     M$SI,DL
         6 000046   000000 471400 7                  LDP1    0
         6 000047   100000 473500                    LDP3    0,,PR1
         6 000050   300000 474506                    LDP4    0,QL,PR3
         6 000051   400000 235100                    LDA     0,,PR4
         6 000052   200007 755100                    STA     ISIZ,,AUTO

      251     3168    1         IF ISIZ = 0 THEN CALL M$EXIT;

   3168  6 000053   000056 601000 6                  TNZ     s:3169

   3168  6 000054   000001 713400                    CLIMB   exit
         6 000055   000000 401760                    pmme    nvectors=0

      252     3169    1         IDISP=0;

   3169  6 000056   200010 450100                    STZ     IDISP,,AUTO

   3169  6 000057                       CMD0         null
      253     3170    1   CMD0: ;
      254     3171    1         CALL GTOKE ALTRET(ALTRT);

   3171  6 000057   000726 701000 6                  TSX1    GTOKE
         6 000060   000724 702000 6                  TSX2    BADCMD

      255     3172    1         IF SUBSTR(TOKEN,0,4) = 'DISP'

PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:30   
   3172  6 000061   000000 236000 2                  LDQ     TOKEN
         6 000062   001526 116000 1                  CMPQ    SET_DISPJOB+4
         6 000063   000066 600000 6                  TZE     s:3175
         6 000064   001527 116000 1                  CMPQ    SET_DISPJOB+5
         6 000065   000120 601000 6                  TNZ     s:3183

      256     3173    1         OR SUBSTR(TOKEN,0,4) = 'disp' THEN
      257     3174    2           DO;

      258     3175    2           IF TOKEN = 'DISP'

   3175  6 000066   040000 106400                    CMPC    fill='040'O
         6 000067   000000 000040 2                  ADSC9   TOKEN                    cn=0,n=32
         6 000070   001526 000004 1                  ADSC9   SET_DISPJOB+4            cn=0,n=4
         6 000071   000057 600000 6                  TZE     CMD0
         6 000072   040000 106400                    CMPC    fill='040'O
         6 000073   000000 000040 2                  ADSC9   TOKEN                    cn=0,n=32
         6 000074   001527 000004 1                  ADSC9   SET_DISPJOB+5            cn=0,n=4
         6 000075   000057 600000 6                  TZE     CMD0
         6 000076   040000 106400                    CMPC    fill='040'O
         6 000077   000000 000040 2                  ADSC9   TOKEN                    cn=0,n=32
         6 000100   001530 000007 1                  ADSC9   SET_DISPJOB+6            cn=0,n=7
         6 000101   000057 600000 6                  TZE     CMD0
         6 000102   040000 106400                    CMPC    fill='040'O
         6 000103   000000 000040 2                  ADSC9   TOKEN                    cn=0,n=32
         6 000104   001532 000007 1                  ADSC9   SET_DISPJOB+8            cn=0,n=7
         6 000105   000057 600000 6                  TZE     CMD0

      259     3176    2           OR TOKEN = 'disp'
      260     3177    2           OR TOKEN = 'display'
      261     3178    2           OR TOKEN = 'DISPLAY' THEN GOTO CMD0;
      262     3179    2           IF TDISP = 8 THEN TOKEN=SUBSTR(TOKEN,7,1);

   3179  6 000106   200005 235100                    LDA     TDISP,,AUTO
         6 000107   000010 115007                    CMPA    8,DL
         6 000110   000115 601000 6                  TNZ     s:3180

PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:31   
   3179  6 000111   040000 100400                    MLR     fill='040'O
         6 000112   000001 600001 2                  ADSC9   TOKEN+1                  cn=3,n=1
         6 000113   000000 000040 2                  ADSC9   TOKEN                    cn=0,n=32
         6 000114   000120 710000 6                  TRA     s:3183

      263     3180    2           ELSE TOKEN=SUBSTR(TOKEN,4,4);

   3180  6 000115   040000 100400                    MLR     fill='040'O
         6 000116   000001 000004 2                  ADSC9   TOKEN+1                  cn=0,n=4
         6 000117   000000 000040 2                  ADSC9   TOKEN                    cn=0,n=32

      264     3181    2           END;

      265     3182        /**/
      266     3183    1         IF  SUBSTR(TOKEN,0,1) = 'X'  OR SUBSTR(TOKEN,0,1) = 'x'

   3183  6 000120   000000 236000 2                  LDQ     TOKEN
         6 000121   777000 376003                    ANQ     -512,DU
         6 000122   130000 116003                    CMPQ    45056,DU
         6 000123   000150 600000 6                  TZE     s:3186
         6 000124   000000 236000 2                  LDQ     TOKEN
         6 000125   777000 376003                    ANQ     -512,DU
         6 000126   170000 116003                    CMPQ    61440,DU
         6 000127   000150 600000 6                  TZE     s:3186
         6 000130   000000 236000 2                  LDQ     TOKEN
         6 000131   777000 376003                    ANQ     -512,DU
         6 000132   121000 116003                    CMPQ    41472,DU
         6 000133   000150 600000 6                  TZE     s:3186
         6 000134   000000 236000 2                  LDQ     TOKEN
         6 000135   777000 376003                    ANQ     -512,DU
         6 000136   161000 116003                    CMPQ    57856,DU
         6 000137   000150 600000 6                  TZE     s:3186
         6 000140   000000 236000 2                  LDQ     TOKEN
         6 000141   777000 376003                    ANQ     -512,DU
         6 000142   105000 116003                    CMPQ    35328,DU
         6 000143   000150 600000 6                  TZE     s:3186
         6 000144   000000 236000 2                  LDQ     TOKEN
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:32   
         6 000145   777000 376003                    ANQ     -512,DU
         6 000146   145000 116003                    CMPQ    51712,DU
         6 000147   000152 601000 6                  TNZ     s:3188

      267     3184    1         OR SUBSTR(TOKEN,0,1) = 'Q'   OR SUBSTR(TOKEN,0,1) = 'q'
      268     3185    1         OR SUBSTR(TOKEN,0,1) = 'E' OR SUBSTR(TOKEN,0,1) = 'e' THEN
      269     3186    1          CALL M$EXIT;

   3186  6 000150   000001 713400                    CLIMB   exit
         6 000151   000000 401760                    pmme    nvectors=0

      270     3187        /**/
      271     3188    1         IF SUBSTR(TOKEN,0,1) = 'M'

   3188  6 000152   000000 236000 2                  LDQ     TOKEN
         6 000153   777000 376003                    ANQ     -512,DU
         6 000154   115000 116003                    CMPQ    39424,DU
         6 000155   000162 600000 6                  TZE     s:3192
         6 000156   000000 236000 2                  LDQ     TOKEN
         6 000157   777000 376003                    ANQ     -512,DU
         6 000160   155000 116003                    CMPQ    55808,DU
         6 000161   000165 601000 6                  TNZ     s:3196

      272     3189    1         OR SUBSTR(TOKEN,0,1) = 'm' THEN
      273     3190    2           DO;

      274     3191                                /* ME COMMAND */
      275     3192    2           ALLFLG=0;

   3192  6 000162   200003 470500                    LDP0    @ALLFLG,,AUTO
         6 000163   000000 450100                    STZ     0,,PR0

      276     3193    2           GOTO CMD01;

   3193  6 000164   000234 710000 6                  TRA     CMD01

      277     3194    2           END;
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:33   
      278     3195        /**/
      279     3196    1         IF SUBSTR(TOKEN,0,1) = 'H'

   3196  6 000165   000000 236000 2                  LDQ     TOKEN
         6 000166   777000 376003                    ANQ     -512,DU
         6 000167   110000 116003                    CMPQ    36864,DU
         6 000170   000175 600000 6                  TZE     s:3200
         6 000171   000000 236000 2                  LDQ     TOKEN
         6 000172   777000 376003                    ANQ     -512,DU
         6 000173   150000 116003                    CMPQ    53248,DU
         6 000174   000215 601000 6                  TNZ     s:3207

      280     3197    1         OR SUBSTR(TOKEN,0,1) = 'h' THEN
      281     3198    2           DO;

      282     3199                                /* HELP   COMMAND */
      283     3200    3             DO I = 0 TO 49;

   3200  6 000175   200004 450100                    STZ     I,,AUTO

      284     3201    3             WRITE_HELP.BUF_=VECTOR(HELP(I));

   3201  6 000176   000001 235000 7                  LDA     1
         6 000177   200004 236100                    LDQ     I,,AUTO
         6 000200   200016 755100                    STA     J+1,,AUTO
         6 000201   000021 402003                    MPY     17,DU
         6 000202   000002 036000 7                  ADLQ    2
         6 000203   200016 235100                    LDA     J+1,,AUTO
         6 000204   000050 757000 2                  STAQ    WRITE_HELP+4

      285     3202    3             CALL M$WRITE (WRITE_HELP);

   3202  6 000205   000044 630400 2                  EPPR0   WRITE_HELP
         6 000206   040001 713400                    CLIMB   write
         6 000207   401400 401760                    pmme    nvectors=4

      286     3203    3             END;
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:34   

   3203  6 000210   200004 054100                    AOS     I,,AUTO
         6 000211   200004 235100                    LDA     I,,AUTO
         6 000212   000061 115007                    CMPA    49,DL
         6 000213   000176 604400 6                  TMOZ    s:3201

      287     3204    2           GOTO CMD01;

   3204  6 000214   000234 710000 6                  TRA     CMD01

      288     3205    2           END;
      289     3206        /**/
      290     3207    1         IF SUBSTR(TOKEN,0,1) = 'S'

   3207  6 000215   000000 236000 2                  LDQ     TOKEN
         6 000216   777000 376003                    ANQ     -512,DU
         6 000217   123000 116003                    CMPQ    42496,DU
         6 000220   000225 600000 6                  TZE     s:3211
         6 000221   000000 236000 2                  LDQ     TOKEN
         6 000222   777000 376003                    ANQ     -512,DU
         6 000223   163000 116003                    CMPQ    58880,DU
         6 000224   000237 601000 6                  TNZ     s:3218

      291     3208    1         OR SUBSTR(TOKEN,0,1) = 's' THEN
      292     3209    2           DO;

      293     3210                                /* SYSTEM COMMAND */
      294     3211    2           ALLFLG=1;

   3211  6 000225   000001 235007                    LDA     1,DL
         6 000226   200003 470500                    LDP0    @ALLFLG,,AUTO
         6 000227   000000 755100                    STA     0,,PR0

      295     3212    2           CALL M$SPRIV (SET_DISPJOB) ALTRET(BADCMD);

   3212  6 000230   001522 630400 1                  EPPR0   SET_DISPJOB
         6 000231   420012 713400                    CLIMB   alt,+8202
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:35   
         6 000232   400000 401760                    pmme    nvectors=1
         6 000233   000724 702000 6                  TSX2    BADCMD

   3211  6 000234                       CMD01        null
      296     3213    2   CMD01:  ;
      297     3214    2           OD_CXT.KIN#=0;

   3214  6 000234   000000 220003                    LDX0    0,DU
         6 000235   000006 740000 xsym               STX0    OD_CXT+6

      298     3215    2           RETURN;

   3215  6 000236   000000 702200 xent               TSX2  ! X66_ARET

      299     3216    2           END;
      300     3217        /**/
      301     3218    1         IF SUBSTR(TOKEN,0,1) = 'A'

   3218  6 000237   000000 236000 2                  LDQ     TOKEN
         6 000240   777000 376003                    ANQ     -512,DU
         6 000241   101000 116003                    CMPQ    33280,DU
         6 000242   000247 600000 6                  TZE     s:3221
         6 000243   000000 236000 2                  LDQ     TOKEN
         6 000244   777000 376003                    ANQ     -512,DU
         6 000245   141000 116003                    CMPQ    49664,DU
         6 000246   000254 601000 6                  TNZ     s:3226

      302     3219    1         OR SUBSTR(TOKEN,0,1) = 'a' THEN
      303     3220    2           DO;

      304     3221    2           OD_CXT.KIN#=KEY_DISPALL#;

   3221  6 000247   000011 220003                    LDX0    9,DU
         6 000250   000006 740000 xsym               STX0    OD_CXT+6

      305     3222    2           CALL GTOKE ALTRET(GOTCMD);

PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:36   
   3222  6 000251   000726 701000 6                  TSX1    GTOKE
         6 000252   000725 702000 6                  TSX2    GOTCMD

      306     3223    2           GOTO CMD11;

   3223  6 000253   000370 710000 6                  TRA     CMD11

      307     3224    2           END;
      308     3225        /**/
      309     3226    1         IF SUBSTR(TOKEN,0,1) = 'I'

   3226  6 000254   000000 236000 2                  LDQ     TOKEN
         6 000255   777000 376003                    ANQ     -512,DU
         6 000256   111000 116003                    CMPQ    37376,DU
         6 000257   000264 600000 6                  TZE     s:3229
         6 000260   000000 236000 2                  LDQ     TOKEN
         6 000261   777000 376003                    ANQ     -512,DU
         6 000262   151000 116003                    CMPQ    53760,DU
         6 000263   000271 601000 6                  TNZ     s:3234

      310     3227    1         OR SUBSTR(TOKEN,0,1) = 'i' THEN
      311     3228    2           DO;

      312     3229    2           OD_CXT.KIN#=KEY_DISPINPUT#;

   3229  6 000264   000002 220003                    LDX0    2,DU
         6 000265   000006 740000 xsym               STX0    OD_CXT+6

      313     3230    2           CALL GTOKE ALTRET(GOTCMD);

   3230  6 000266   000726 701000 6                  TSX1    GTOKE
         6 000267   000725 702000 6                  TSX2    GOTCMD

      314     3231    2           GOTO CMD1;

   3231  6 000270   000335 710000 6                  TRA     CMD1

PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:37   
      315     3232    2           END;
      316     3233        /**/
      317     3234    1         IF SUBSTR(TOKEN,0,1) = 'O'

   3234  6 000271   000000 236000 2                  LDQ     TOKEN
         6 000272   777000 376003                    ANQ     -512,DU
         6 000273   117000 116003                    CMPQ    40448,DU
         6 000274   000301 600000 6                  TZE     s:3237
         6 000275   000000 236000 2                  LDQ     TOKEN
         6 000276   777000 376003                    ANQ     -512,DU
         6 000277   157000 116003                    CMPQ    56832,DU
         6 000300   000432 601000 6                  TNZ     s:3287

      318     3235    1         OR SUBSTR(TOKEN,0,1) = 'o' THEN
      319     3236    2           DO;

      320     3237    2           OD_CXT.KIN#=KEY_DISPOUTPUT#;

   3237  6 000301   000003 220003                    LDX0    3,DU
         6 000302   000006 740000 xsym               STX0    OD_CXT+6

      321     3238    2           CALL GTOKE ALTRET(GOTCMD);

   3238  6 000303   000726 701000 6                  TSX1    GTOKE
         6 000304   000725 702000 6                  TSX2    GOTCMD

      322     3239    2           IF TOKEN = 'FORM' THEN

   3239  6 000305   040000 106400                    CMPC    fill='040'O
         6 000306   000000 000040 2                  ADSC9   TOKEN                    cn=0,n=32
         6 000307   001534 000004 1                  ADSC9   SET_DISPJOB+10           cn=0,n=4
         6 000310   000323 601000 6                  TNZ     s:3246

      323     3240    3             DO;

      324     3241    3             OD_CXT.NOTFORM=NOT_;

PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:38   
   3241  6 000311   200012 236100                    LDQ     NOT_,,AUTO
         6 000312   000011 736000                    QLS     9
         6 000313   000024 552010 xsym               STBQ    OD_CXT+20,'10'O

      325     3242    3             CALL GTOKE ALTRET(BADCMD);

   3242  6 000314   000726 701000 6                  TSX1    GTOKE
         6 000315   000724 702000 6                  TSX2    BADCMD

      326     3243    3             OD_CXT.SFORM=TOKEN;

   3243  6 000316   040000 100400                    MLR     fill='040'O
         6 000317   000000 000006 2                  ADSC9   TOKEN                    cn=0,n=6
         6 000320   000023 000006 xsym               ADSC9   OD_CXT+19                cn=0,n=6

      327     3244    3             CALL GTOKE ALTRET(GOTCMD);

   3244  6 000321   000726 701000 6                  TSX1    GTOKE
         6 000322   000725 702000 6                  TSX2    GOTCMD

      328     3245    3             END;

      329     3246    2           IF TOKEN = 'FOR' THEN

   3246  6 000323   040000 106400                    CMPC    fill='040'O
         6 000324   000000 000040 2                  ADSC9   TOKEN                    cn=0,n=32
         6 000325   001534 000003 1                  ADSC9   SET_DISPJOB+10           cn=0,n=3
         6 000326   000335 601000 6                  TNZ     CMD1

      330     3247    3             DO;

      331     3248    3             CALL GTOKE ALTRET(BADCMD);

   3248  6 000327   000726 701000 6                  TSX1    GTOKE
         6 000330   000724 702000 6                  TSX2    BADCMD

      332     3249    3             OD_CXT.DEVTYP=TOKEN;
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:39   

   3249  6 000331   000000 220000 2                  LDX0    TOKEN
         6 000332   000013 740000 xsym               STX0    OD_CXT+11

      333     3250    3             CALL GTOKE ALTRET(GOTCMD);

   3250  6 000333   000726 701000 6                  TSX1    GTOKE
         6 000334   000725 702000 6                  TSX2    GOTCMD

      334     3251    3             END;

   3246  6 000335                       CMD1         null
      335     3252    2   CMD1:   ;
      336     3253    2           IF SUBSTR(TOKEN,0,1) = '.' THEN

   3253  6 000335   000000 236000 2                  LDQ     TOKEN
         6 000336   777000 376003                    ANQ     -512,DU
         6 000337   056000 116003                    CMPQ    23552,DU
         6 000340   000351 601000 6                  TNZ     s:3259

      337     3254    3             DO;

      338     3255    3             OD_CXT.SACCT=SUBSTR(TOKEN,1,11);

   3255  6 000341   040000 100400                    MLR     fill='040'O
         6 000342   000000 200010 2                  ADSC9   TOKEN                    cn=1,n=8
         6 000343   000021 000010 xsym               ADSC9   OD_CXT+17                cn=0,n=8

      339     3256    3             OD_CXT.NOTACCT=NOT_;

   3256  6 000344   200012 236100                    LDQ     NOT_,,AUTO
         6 000345   000011 736000                    QLS     9
         6 000346   000013 552010 xsym               STBQ    OD_CXT+11,'10'O

      340     3257    3             CALL GTOKE ALTRET(GOTCMD);

   3257  6 000347   000726 701000 6                  TSX1    GTOKE
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:40   
         6 000350   000725 702000 6                  TSX2    GOTCMD

      341     3258    3             END;

      342     3259    2           IF SUBSTR(TOKEN,0,1) = '@' THEN

   3259  6 000351   000000 236000 2                  LDQ     TOKEN
         6 000352   777000 376003                    ANQ     -512,DU
         6 000353   100000 116003                    CMPQ    32768,DU
         6 000354   000370 601000 6                  TNZ     CMD11

      343     3260    3             DO;

      344     3261    3             OD_CXT.SWSN=SUBSTR(TOKEN,1,11);

   3261  6 000355   040000 100400                    MLR     fill='040'O
         6 000356   000000 200010 2                  ADSC9   TOKEN                    cn=1,n=8
         6 000357   000015 000010 xsym               ADSC9   OD_CXT+13                cn=0,n=8

      345     3262    3             OD_CXT.NOTWSN=NOT_;

   3262  6 000360   200012 236100                    LDQ     NOT_,,AUTO
         6 000361   000013 552004 xsym               STBQ    OD_CXT+11,'04'O

      346     3263    3             OD_CXT.STNAME=OD_CXT.SWSN;

   3263  6 000362   040000 100400                    MLR     fill='040'O
         6 000363   000015 000010 xsym               ADSC9   OD_CXT+13                cn=0,n=8
         6 000364   000017 000010 xsym               ADSC9   OD_CXT+15                cn=0,n=8

      347     3264    3             OD_CXT.NOTTERM=NOT_;

   3264  6 000365   000013 552004 xsym               STBQ    OD_CXT+11,'04'O

      348     3265    3             CALL GTOKE ALTRET(GOTCMD);

   3265  6 000366   000726 701000 6                  TSX1    GTOKE
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:41   
         6 000367   000725 702000 6                  TSX2    GOTCMD

      349     3266    3             END;

   3265  6 000370                       CMD11        null
      350     3267    2   CMD11:  ;
      351     3268    2           IF SUBSTR(TOKEN,0,1) = 'S'

   3268  6 000370   000000 236000 2                  LDQ     TOKEN
         6 000371   777000 376003                    ANQ     -512,DU
         6 000372   123000 116003                    CMPQ    42496,DU
         6 000373   000400 600000 6                  TZE     s:3271
         6 000374   000000 236000 2                  LDQ     TOKEN
         6 000375   777000 376003                    ANQ     -512,DU
         6 000376   163000 116003                    CMPQ    58880,DU
         6 000377   000404 601000 6                  TNZ     s:3274

      352     3269    2           OR SUBSTR(TOKEN,0,1) = 's' THEN
      353     3270    3             DO;

      354     3271    3             OD_CXT.FORCE=2; /* SHORT */

   3271  6 000400   000002 220003                    LDX0    2,DU
         6 000401   000007 440000 xsym               SXL0    OD_CXT+7

      355     3272    3             CALL GTOKE ALTRET(GOTCMD);

   3272  6 000402   000726 701000 6                  TSX1    GTOKE
         6 000403   000725 702000 6                  TSX2    GOTCMD

      356     3273    3             END;

      357     3274    2           IF TOKEN = 'ON'

   3274  6 000404   040000 106400                    CMPC    fill='040'O
         6 000405   000000 000040 2                  ADSC9   TOKEN                    cn=0,n=32
         6 000406   001535 000002 1                  ADSC9   SET_DISPJOB+11           cn=0,n=2
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:42   
         6 000407   000414 600000 6                  TZE     s:3277
         6 000410   040000 106400                    CMPC    fill='040'O
         6 000411   000000 000040 2                  ADSC9   TOKEN                    cn=0,n=32
         6 000412   001536 000002 1                  ADSC9   SET_DISPJOB+12           cn=0,n=2
         6 000413   000416 601000 6                  TNZ     s:3279

      358     3275    2           OR TOKEN = 'on' THEN
      359     3276    3             DO;

      360     3277    3             CALL GTOKE ALTRET(BADCMD);

   3277  6 000414   000726 701000 6                  TSX1    GTOKE
         6 000415   000724 702000 6                  TSX2    BADCMD

      361     3278    3             END;

      362     3279    2           IF TOKEN = 'LP'

   3279  6 000416   040000 106400                    CMPC    fill='040'O
         6 000417   000000 000040 2                  ADSC9   TOKEN                    cn=0,n=32
         6 000420   001537 000002 1                  ADSC9   SET_DISPJOB+13           cn=0,n=2
         6 000421   000426 600000 6                  TZE     s:3282
         6 000422   040000 106400                    CMPC    fill='040'O
         6 000423   000000 000040 2                  ADSC9   TOKEN                    cn=0,n=32
         6 000424   001540 000002 1                  ADSC9   SET_DISPJOB+14           cn=0,n=2
         6 000425   000431 601000 6                  TNZ     s:3285

      363     3280    2           OR TOKEN = 'lp' THEN
      364     3281    3             DO;

      365     3282    3             OD_CXT.ONLP=1;

   3282  6 000426   000001 220003                    LDX0    1,DU
         6 000427   000007 740000 xsym               STX0    OD_CXT+7

      366     3283    3             GOTO GOTCMD;

PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:43   
   3283  6 000430   000725 710000 6                  TRA     GOTCMD

      367     3284    3             END;
      368     3285    2           GOTO BADCMD;

   3285  6 000431   000724 710000 6                  TRA     BADCMD

      369     3286    2           END;
      370     3287    1         IF  SUBSTR(TOKEN,0,1) = 'J'

   3287  6 000432   000000 236000 2                  LDQ     TOKEN
         6 000433   777000 376003                    ANQ     -512,DU
         6 000434   112000 116003                    CMPQ    37888,DU
         6 000435   000452 600000 6                  TZE     s:3292
         6 000436   000000 236000 2                  LDQ     TOKEN
         6 000437   777000 376003                    ANQ     -512,DU
         6 000440   152000 116003                    CMPQ    54272,DU
         6 000441   000452 600000 6                  TZE     s:3292
         6 000442   000000 236000 2                  LDQ     TOKEN
         6 000443   777000 376003                    ANQ     -512,DU
         6 000444   122000 116003                    CMPQ    41984,DU
         6 000445   000452 600000 6                  TZE     s:3292
         6 000446   000000 236000 2                  LDQ     TOKEN
         6 000447   777000 376003                    ANQ     -512,DU
         6 000450   162000 116003                    CMPQ    58368,DU
         6 000451   000457 601000 6                  TNZ     s:3297

      371     3288    1         OR  SUBSTR(TOKEN,0,1) = 'j'
      372     3289    1         OR  SUBSTR(TOKEN,0,1) = 'R'
      373     3290    1         OR SUBSTR(TOKEN,0,1) = 'r' THEN
      374     3291    2           DO;

      375     3292    2           OD_CXT.KIN#=KEY_DISPJOB#;

   3292  6 000452   000001 220003                    LDX0    1,DU
         6 000453   000006 740000 xsym               STX0    OD_CXT+6

PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:44   
      376     3293    2           CALL GTOKE ALTRET(GOTCMD);

   3293  6 000454   000726 701000 6                  TSX1    GTOKE
         6 000455   000725 702000 6                  TSX2    GOTCMD

      377     3294    2           GOTO CMD1;

   3294  6 000456   000335 710000 6                  TRA     CMD1

      378     3295    2           END;
      379     3296        /**/
      380     3297    1         IF SUBSTR(TOKEN,0,1) = 'D'

   3297  6 000457   000000 236000 2                  LDQ     TOKEN
         6 000460   777000 376003                    ANQ     -512,DU
         6 000461   104000 116003                    CMPQ    34816,DU
         6 000462   000467 600000 6                  TZE     s:3300
         6 000463   000000 236000 2                  LDQ     TOKEN
         6 000464   777000 376003                    ANQ     -512,DU
         6 000465   144000 116003                    CMPQ    51200,DU
         6 000466   000474 601000 6                  TNZ     s:3305

      381     3298    1         OR SUBSTR(TOKEN,0,1) = 'd' THEN
      382     3299    2           DO;

      383     3300    2           OD_CXT.KIN#=KEY_DISPDEFER#;

   3300  6 000467   000006 220003                    LDX0    6,DU
         6 000470   000006 740000 xsym               STX0    OD_CXT+6

      384     3301    2           CALL GTOKE ALTRET(GOTCMD);

   3301  6 000471   000726 701000 6                  TSX1    GTOKE
         6 000472   000725 702000 6                  TSX2    GOTCMD

      385     3302    2           GOTO CMD1;

PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:45   
   3302  6 000473   000335 710000 6                  TRA     CMD1

      386     3303    2           END;
      387     3304        /**/
      388     3305    1         IF SUBSTR(TOKEN,0,2) = 'NO'

   3305  6 000474   000000 220000 2                  LDX0    TOKEN
         6 000475   001541 100000 1                  CMPX0   SET_DISPJOB+15
         6 000476   000501 600000 6                  TZE     s:3308
         6 000477   001542 100000 1                  CMPX0   SET_DISPJOB+16
         6 000500   000506 601000 6                  TNZ     s:3313

      389     3306    1         OR SUBSTR(TOKEN,0,2) = 'no' THEN
      390     3307    2           DO;

      391     3308    2           OD_CXT.KIN#=KEY_DISPNORUN#;

   3308  6 000501   000005 221003                    LDX1    5,DU
         6 000502   000006 741000 xsym               STX1    OD_CXT+6

      392     3309    2           CALL GTOKE ALTRET(GOTCMD);

   3309  6 000503   000726 701000 6                  TSX1    GTOKE
         6 000504   000725 702000 6                  TSX2    GOTCMD

      393     3310    2           GOTO CMD1;

   3310  6 000505   000335 710000 6                  TRA     CMD1

      394     3311    2           END;
      395     3312        /**/
      396     3313    1         IF SUBSTR(TOKEN,0,2) = 'NS'

   3313  6 000506   001543 100000 1                  CMPX0   SET_DISPJOB+17
         6 000507   000512 600000 6                  TZE     s:3316
         6 000510   001544 100000 1                  CMPX0   SET_DISPJOB+18
         6 000511   000517 601000 6                  TNZ     s:3321
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:46   

      397     3314    1         OR SUBSTR(TOKEN,0,2) = 'ns' THEN
      398     3315    2           DO;

      399     3316    2           OD_CXT.KIN#=KEY_DISPNSFORM#;

   3316  6 000512   000004 221003                    LDX1    4,DU
         6 000513   000006 741000 xsym               STX1    OD_CXT+6

      400     3317    2           CALL GTOKE ALTRET(GOTCMD);

   3317  6 000514   000726 701000 6                  TSX1    GTOKE
         6 000515   000725 702000 6                  TSX2    GOTCMD

      401     3318    2           GOTO CMD1;

   3318  6 000516   000335 710000 6                  TRA     CMD1

      402     3319    2           END;
      403     3320        /**/
      404     3321    1         IF SUBSTR(TOKEN,0,1) = 'P'

   3321  6 000517   000000 236000 2                  LDQ     TOKEN
         6 000520   777000 376003                    ANQ     -512,DU
         6 000521   120000 116003                    CMPQ    40960,DU
         6 000522   000527 600000 6                  TZE     s:3324
         6 000523   000000 236000 2                  LDQ     TOKEN
         6 000524   777000 376003                    ANQ     -512,DU
         6 000525   160000 116003                    CMPQ    57344,DU
         6 000526   000602 601000 6                  TNZ     s:3349

      405     3322    1         OR SUBSTR(TOKEN,0,1) = 'p' THEN
      406     3323    2           DO;

      407     3324    2           OD_CXT.KIN#=KEY_DISPPRIO#;

   3324  6 000527   000007 221003                    LDX1    7,DU
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:47   
         6 000530   000006 741000 xsym               STX1    OD_CXT+6

      408     3325    2           CALL GTOKE ALTRET(BADCMD);

   3325  6 000531   000726 701000 6                  TSX1    GTOKE
         6 000532   000724 702000 6                  TSX2    BADCMD

      409     3326    2           CALL GNUM ALTRET(BADCMD);

   3326  6 000533   001036 701000 6                  TSX1    GNUM
         6 000534   000724 702000 6                  TSX2    BADCMD

      410     3327    2           OD_CXT.LOPRIO=TEMP;

   3327  6 000535   200006 720100                    LXL0    TEMP,,AUTO
         6 000536   000014 740000 xsym               STX0    OD_CXT+12

      411     3328    2           OD_CXT.HIPRIO=OD_CXT.LOPRIO;

   3328  6 000537   000014 440000 xsym               SXL0    OD_CXT+12

      412     3329    2           CALL GTOKE ALTRET(GOTCMD);

   3329  6 000540   000726 701000 6                  TSX1    GTOKE
         6 000541   000725 702000 6                  TSX2    GOTCMD

   3328  6 000542                       CMD2         null
      413     3330    2   CMD2:   ;
      414     3331    2           IF SUBSTR(TOKEN,0,1) >= '0'

   3331  6 000542   000000 236000 2                  LDQ     TOKEN
         6 000543   777000 376003                    ANQ     -512,DU
         6 000544   060000 116003                    CMPQ    24576,DU
         6 000545   000562 602000 6                  TNC     s:3339
         6 000546   000000 236000 2                  LDQ     TOKEN
         6 000547   777000 376003                    ANQ     -512,DU
         6 000550   071000 116003                    CMPQ    29184,DU
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:48   
         6 000551   000553 600000 6                  TZE     s:3334
         6 000552   000562 603000 6                  TRC     s:3339

      415     3332    2           AND SUBSTR(TOKEN,0,1) <= '9' THEN
      416     3333    3             DO;

      417     3334    3             CALL GNUM ALTRET(BADCMD);

   3334  6 000553   001036 701000 6                  TSX1    GNUM
         6 000554   000724 702000 6                  TSX2    BADCMD

      418     3335    3             OD_CXT.HIPRIO=TEMP;

   3335  6 000555   200006 720100                    LXL0    TEMP,,AUTO
         6 000556   000014 440000 xsym               SXL0    OD_CXT+12

      419     3336    3             CALL GTOKE ALTRET(GOTCMD);

   3336  6 000557   000726 701000 6                  TSX1    GTOKE
         6 000560   000725 702000 6                  TSX2    GOTCMD

      420     3337    3             GOTO CMD1;

   3337  6 000561   000335 710000 6                  TRA     CMD1

      421     3338    3             END;
      422     3339    2           IF TOKEN = '-'

   3339  6 000562   040000 106400                    CMPC    fill='040'O
         6 000563   000000 000040 2                  ADSC9   TOKEN                    cn=0,n=32
         6 000564   000003 000001 7                  ADSC9   3                        cn=0,n=1
         6 000565   000576 600000 6                  TZE     s:3343
         6 000566   040000 106400                    CMPC    fill='040'O
         6 000567   000000 000040 2                  ADSC9   TOKEN                    cn=0,n=32
         6 000570   001545 000002 1                  ADSC9   SET_DISPJOB+19           cn=0,n=2
         6 000571   000576 600000 6                  TZE     s:3343
         6 000572   040000 106400                    CMPC    fill='040'O
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:49   
         6 000573   000000 000040 2                  ADSC9   TOKEN                    cn=0,n=32
         6 000574   001546 000002 1                  ADSC9   SET_DISPJOB+20           cn=0,n=2
         6 000575   000601 601000 6                  TNZ     s:3346

      423     3340    2           OR TOKEN = 'TO'
      424     3341    2           OR TOKEN = 'to' THEN
      425     3342    3             DO;

      426     3343    3             CALL GTOKE ALTRET(BADCMD);

   3343  6 000576   000726 701000 6                  TSX1    GTOKE
         6 000577   000724 702000 6                  TSX2    BADCMD

      427     3344    3             GOTO CMD2;

   3344  6 000600   000542 710000 6                  TRA     CMD2

      428     3345    3             END;
      429     3346    2           GOTO CMD1;

   3346  6 000601   000335 710000 6                  TRA     CMD1

      430     3347    2           END;
      431     3348        /**/
      432     3349    1         IF  SUBSTR(TOKEN,0,1) >= '0'

   3349  6 000602   000000 236000 2                  LDQ     TOKEN
         6 000603   777000 376003                    ANQ     -512,DU
         6 000604   060000 116003                    CMPQ    24576,DU
         6 000605   000642 602000 6                  TNC     s:3367
         6 000606   000000 236000 2                  LDQ     TOKEN
         6 000607   777000 376003                    ANQ     -512,DU
         6 000610   071000 116003                    CMPQ    29184,DU
         6 000611   000613 600000 6                  TZE     s:3352
         6 000612   000642 603000 6                  TRC     s:3367

      433     3350    1         AND SUBSTR(TOKEN,0,1) <= '9' THEN
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:50   
      434     3351    2           DO;

      435     3352    2           OD_CXT.KIN#=KEY_DISPSYSID#;

   3352  6 000613   000010 221003                    LDX1    8,DU
         6 000614   000006 741000 xsym               STX1    OD_CXT+6

      436     3353    2           CALL GNUM ALTRET(BADCMD);

   3353  6 000615   001036 701000 6                  TSX1    GNUM
         6 000616   000724 702000 6                  TSX2    BADCMD

      437     3354    2           OD_CXT.SYSID=TEMP;

   3354  6 000617   200006 720100                    LXL0    TEMP,,AUTO
         6 000620   000010 440000 xsym               SXL0    OD_CXT+8

      438     3355    2           OD_CXT.FULL=0;

   3355  6 000621   000000 221003                    LDX1    0,DU
         6 000622   000010 741000 xsym               STX1    OD_CXT+8

      439     3356    2           CALL GTOKE ALTRET(GOTCMD);

   3356  6 000623   000726 701000 6                  TSX1    GTOKE
         6 000624   000725 702000 6                  TSX2    GOTCMD

   3355  6 000625                       CMD8         null
      440     3357    2   CMD8:   ;
      441     3358    2           IF SUBSTR(TOKEN,0,1) = 'F'

   3358  6 000625   000000 236000 2                  LDQ     TOKEN
         6 000626   777000 376003                    ANQ     -512,DU
         6 000627   106000 116003                    CMPQ    35840,DU
         6 000630   000635 600000 6                  TZE     s:3361
         6 000631   000000 236000 2                  LDQ     TOKEN
         6 000632   777000 376003                    ANQ     -512,DU
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:51   
         6 000633   146000 116003                    CMPQ    52224,DU
         6 000634   000641 601000 6                  TNZ     s:3364

      442     3359    2           OR SUBSTR(TOKEN,0,1) = 'f' THEN
      443     3360    3             DO;

      444     3361    3             OD_CXT.FULL=1;

   3361  6 000635   000001 220003                    LDX0    1,DU
         6 000636   000010 740000 xsym               STX0    OD_CXT+8

      445     3362    3             CALL GTOKE ALTRET(GOTCMD);

   3362  6 000637   000726 701000 6                  TSX1    GTOKE
         6 000640   000725 702000 6                  TSX2    GOTCMD

      446     3363    3             END;

      447     3364    2           GOTO CMD11;

   3364  6 000641   000370 710000 6                  TRA     CMD11

      448     3365    2           END;
      449     3366        /**/
      450     3367    1         IF SUBSTR(TOKEN,0,1) = '%' THEN

   3367  6 000642   000000 236000 2                  LDQ     TOKEN
         6 000643   777000 376003                    ANQ     -512,DU
         6 000644   045000 116003                    CMPQ    18944,DU
         6 000645   000724 601000 6                  TNZ     BADCMD

      451     3368    2           DO;

      452     3369    2           JNAME=SUBSTR(TOKEN,1,31);

   3369  6 000646   040000 100400                    MLR     fill='040'O
         6 000647   000000 200037 2                  ADSC9   TOKEN                    cn=1,n=31
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:52   
         6 000650   000010 000037 2                  ADSC9   JNAME                    cn=0,n=31

      453     3370    2           JACCT=B$JIT$->B$JIT.ACCN;

   3370  6 000651   000000 470400 xsym               LDP0    B$JIT$
         6 000652   040000 100500                    MLR     fill='040'O
         6 000653   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         6 000654   000020 000010 2                  ADSC9   JACCT                    cn=0,n=8

      454     3371    2           CALL GTOKE ALTRET(CMD9);

   3371  6 000655   000726 701000 6                  TSX1    GTOKE
         6 000656   000670 702000 6                  TSX2    CMD9

      455     3372    2           IF SUBSTR(TOKEN,0,1) = '.' THEN

   3372  6 000657   000000 236000 2                  LDQ     TOKEN
         6 000660   777000 376003                    ANQ     -512,DU
         6 000661   056000 116003                    CMPQ    23552,DU
         6 000662   000670 601000 6                  TNZ     CMD9

      456     3373    3             DO;

      457     3374    3             JACCT=SUBSTR(TOKEN,1,8);

   3374  6 000663   040000 100400                    MLR     fill='040'O
         6 000664   000000 200010 2                  ADSC9   TOKEN                    cn=1,n=8
         6 000665   000020 000010 2                  ADSC9   JACCT                    cn=0,n=8

      458     3375    3             CALL GTOKE;

   3375  6 000666   000726 701000 6                  TSX1    GTOKE
         6 000667   000000 011000                    NOP     0

      459     3376    3             END;

   3372  6 000670                       CMD9         null
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:53   
      460     3377    2   CMD9:   ;
      461     3378    2           OD_CXT.KIN#=KEY_DISPSYSID#;

   3378  6 000670   000010 220003                    LDX0    8,DU
         6 000671   000006 740000 xsym               STX0    OD_CXT+6

      462     3379    2           OD_CXT.SYSID=256000;

   3379  6 000672   764000 221003                    LDX1    -6144,DU
         6 000673   000010 441000 xsym               SXL1    OD_CXT+8

      463     3380    2           IF DCBADDR(DCBNUM(M$JSF))->F$DCB.FCD = '0'B THEN

   3380  6 000674   000000 236007 xsym               LDQ     M$JSF,DL
         6 000675   000000 470400 7                  LDP0    0
         6 000676   000000 471500                    LDP1    0,,PR0
         6 000677   100000 473506                    LDP3    0,QL,PR1
         6 000700   300031 236100                    LDQ     25,,PR3
         6 000701   020000 316007                    CANQ    8192,DL
         6 000702   000707 601000 6                  TNZ     s:3382

      464     3381    2            CALL XSJ$OPEN (JOPN) ALTRET(GOTCMD);

   3381  6 000703   000004 630400 7                  EPPR0   4
         6 000704   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000705   000000 701000 xent               TSX1    XSJ$OPEN
         6 000706   000725 702000 6                  TSX2    GOTCMD

      465     3382    2           CALL XSJ$READ (JREAD) ALTRET(GOTCMD);

   3382  6 000707   000005 630400 7                  EPPR0   5
         6 000710   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000711   000000 701000 xent               TSX1    XSJ$READ
         6 000712   000725 702000 6                  TSX2    GOTCMD

      466     3383    2           OD_CXT.SYSID=XSJ_NAMEREC.SYSID#;

PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:54   
   3383  6 000713   000042 220000 2                  LDX0    XSJ_NAMEREC
         6 000714   000010 440000 xsym               SXL0    OD_CXT+8

      467     3384    2           OD_CXT.FULL=0;

   3384  6 000715   000000 221003                    LDX1    0,DU
         6 000716   000010 741000 xsym               STX1    OD_CXT+8

      468     3385    2           IF TOKEN ~= ' ' THEN

   3385  6 000717   040000 106400                    CMPC    fill='040'O
         6 000720   000000 000040 2                  ADSC9   TOKEN                    cn=0,n=32
         6 000721   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000722   000625 601000 6                  TNZ     CMD8

      469     3386    2            GOTO CMD8;
      470     3387    2           GOTO GOTCMD;

   3387  6 000723   000725 710000 6                  TRA     GOTCMD

   3381  6 000724                       BADCMD       null
   3381  6 000724                       ALTRT        null
      471     3388    2           END;
      472     3389        /**/
      473     3390    1   BADCMD:;
      474     3391    1   ALTRT:;
      475     3392    1         ALTRETURN;

   3392  6 000724   000000 702200 xent               TSX2  ! X66_AALT

   3392  6 000725                       GOTCMD       null
      476     3393    1   GOTCMD:;
      477     3394    1         RETURN;

   3394  6 000725   000000 702200 xent               TSX2  ! X66_ARET

      478     3395
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:55   
      479     3396        /**/
      480     3397        /* PROC TO GET THE NEXT TOKEN */
      481     3398        /**/
      482     3399    1   GTOKE: PROC ALTRET;

   3399  6 000726   200014 741300       GTOKE        STX1  ! NOT_+2,,AUTO

      483     3400    2         NOT_=0;

   3400  6 000727   200012 450100                    STZ     NOT_,,AUTO

      484     3401    2         TDISP=0;

   3401  6 000730   200005 450100                    STZ     TDISP,,AUTO

      485     3402    2         TOKEN=' ';

   3402  6 000731   040000 100400                    MLR     fill='040'O
         6 000732   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000733   000000 000040 2                  ADSC9   TOKEN                    cn=0,n=32

      486     3403    3           DO WHILE (IDISP < ISIZ);

   3403  6 000734   200010 236100                    LDQ     IDISP,,AUTO
         6 000735   200007 116100                    CMPQ    ISIZ,,AUTO
         6 000736   001034 605000 6                  TPL     s:3430

      487     3404    3           ICHAR=PINCRC(ADDR(OD_CSCGBUF),IDISP)->B$CHAR;

   3404  6 000737   200010 235100                    LDA     IDISP,,AUTO
         6 000740   040100 100405                    MLR     fill='040'O
         6 000741   000000 000001 xsym               ADSC9   OD_CSCGBUF,A             cn=0,n=1
         6 000742   200011 000001                    ADSC9   ICHAR,,AUTO              cn=0,n=1

      488     3405    3           IF ICHAR ~= ' ' THEN

   3405  6 000743   200011 236100                    LDQ     ICHAR,,AUTO
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:56   
         6 000744   777000 376003                    ANQ     -512,DU
         6 000745   040000 116003                    CMPQ    16384,DU
         6 000746   001030 600000 6                  TZE     s:3428

      489     3406    4             DO;

      490     3407        /**/
      491     3408    4             IF ICHAR = '~' THEN

   3408  6 000747   200011 236100                    LDQ     ICHAR,,AUTO
         6 000750   777000 376003                    ANQ     -512,DU
         6 000751   176000 116003                    CMPQ    64512,DU
         6 000752   000766 601000 6                  TNZ     s:3415

      492     3409    5               DO;

      493     3410    5               NOT_=1;

   3410  6 000753   000001 236007                    LDQ     1,DL
         6 000754   200012 756100                    STQ     NOT_,,AUTO

      494     3411    5               IDISP=IDISP+1;

   3411  6 000755   200010 054100                    AOS     IDISP,,AUTO

      495     3412    5               IF IDISP = ISIZ THEN ALTRETURN;

   3412  6 000756   200010 236100                    LDQ     IDISP,,AUTO
         6 000757   200007 116100                    CMPQ    ISIZ,,AUTO
         6 000760   000763 601000 6                  TNZ     s:3413

   3412  6 000761   200014 221300                    LDX1  ! NOT_+2,,AUTO
         6 000762   000000 702211                    TSX2  ! 0,X1

      496     3413    5               ICHAR=PINCRC(ADDR(OD_CSCGBUF),IDISP)->B$CHAR;

   3413  6 000763   040100 100406                    MLR     fill='040'O
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:57   
         6 000764   000000 000001 xsym               ADSC9   OD_CSCGBUF,Q             cn=0,n=1
         6 000765   200011 000001                    ADSC9   ICHAR,,AUTO              cn=0,n=1

      497     3414    5               END;

      498     3415    4             CALL INSERT (TOKEN,TDISP,1,ICHAR);

   3415  6 000766   200005 235100                    LDA     TDISP,,AUTO
         6 000767   040005 100500                    MLR     fill='040'O
         6 000770   200011 000001                    ADSC9   ICHAR,,AUTO              cn=0,n=1
         6 000771   000000 000001 2                  ADSC9   TOKEN,A                  cn=0,n=1

      499     3416    4             TDISP=TDISP+1;

   3416  6 000772   200005 054100                    AOS     TDISP,,AUTO

      500     3417    4             IDISP=IDISP+1;

   3417  6 000773   200010 054100                    AOS     IDISP,,AUTO

      501     3418    5               DO WHILE (IDISP < ISIZ);

   3418  6 000774   200010 236100                    LDQ     IDISP,,AUTO
         6 000775   200007 116100                    CMPQ    ISIZ,,AUTO
         6 000776   001026 605000 6                  TPL     s:3426

      502     3419    5               ICHAR=PINCRC(ADDR(OD_CSCGBUF),IDISP)->B$CHAR;

   3419  6 000777   200010 235100                    LDA     IDISP,,AUTO
         6 001000   040100 100405                    MLR     fill='040'O
         6 001001   000000 000001 xsym               ADSC9   OD_CSCGBUF,A             cn=0,n=1
         6 001002   200011 000001                    ADSC9   ICHAR,,AUTO              cn=0,n=1

      503     3420    5               IF ICHAR = ' ' THEN RETURN;

   3420  6 001003   200011 236100                    LDQ     ICHAR,,AUTO
         6 001004   777000 376003                    ANQ     -512,DU
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:58   
         6 001005   040000 116003                    CMPQ    16384,DU
         6 001006   001011 601000 6                  TNZ     s:3421

   3420  6 001007   200014 221300                    LDX1  ! NOT_+2,,AUTO
         6 001010   000001 702211                    TSX2  ! 1,X1

      504     3421    5               IF TDISP > 11 THEN ALTRETURN;

   3421  6 001011   200005 236100                    LDQ     TDISP,,AUTO
         6 001012   000013 116007                    CMPQ    11,DL
         6 001013   001016 604400 6                  TMOZ    s:3422

   3421  6 001014   200014 221300                    LDX1  ! NOT_+2,,AUTO
         6 001015   000000 702211                    TSX2  ! 0,X1

      505     3422    5               CALL INSERT (TOKEN,TDISP,1,ICHAR);

   3422  6 001016   040006 100500                    MLR     fill='040'O
         6 001017   200011 000001                    ADSC9   ICHAR,,AUTO              cn=0,n=1
         6 001020   000000 000001 2                  ADSC9   TOKEN,Q                  cn=0,n=1

      506     3423    5               TDISP=TDISP+1;

   3423  6 001021   200005 054100                    AOS     TDISP,,AUTO

      507     3424    5               IDISP=IDISP+1;

   3424  6 001022   200010 054100                    AOS     IDISP,,AUTO

      508     3425    5               END;

   3425  6 001023   200010 236100                    LDQ     IDISP,,AUTO
         6 001024   200007 116100                    CMPQ    ISIZ,,AUTO
         6 001025   000777 604000 6                  TMI     s:3419

      509     3426    4             RETURN;

PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:59   
   3426  6 001026   200014 221300                    LDX1  ! NOT_+2,,AUTO
         6 001027   000001 702211                    TSX2  ! 1,X1

      510     3427    4             END;
      511     3428    3           IDISP=IDISP+1;

   3428  6 001030   200010 054100                    AOS     IDISP,,AUTO

      512     3429    3           END;

   3429  6 001031   200010 236100                    LDQ     IDISP,,AUTO
         6 001032   200007 116100                    CMPQ    ISIZ,,AUTO
         6 001033   000737 604000 6                  TMI     s:3404

      513     3430    2         ALTRETURN;

   3430  6 001034   200014 221300                    LDX1  ! NOT_+2,,AUTO
         6 001035   000000 702211                    TSX2  ! 0,X1

      514     3431    2   END GTOKE;
      515     3432        /* PROC TO GET TEMP AS UBIN FROM TOKEN */
      516     3433    1   GNUM: PROC ALTRET;

   3433  6 001036   200014 741300       GNUM         STX1  ! NOT_+2,,AUTO

      517     3434        /**/
      518     3435    2   DCL J SBIN;
      519     3436        /**/
      520     3437    3           DO J = 0 TO TDISP-1;

   3437  6 001037   200015 450100                    STZ     J,,AUTO
         6 001040   001055 710000 6                  TRA     s:3440+1

      521     3438    3           IF SUBSTR(TOKEN,J,1) < '0'

   3438  6 001041   200015 235100                    LDA     J,,AUTO
         6 001042   040000 106405                    CMPC    fill='040'O
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:60   
         6 001043   000000 000001 2                  ADSC9   TOKEN,A                  cn=0,n=1
         6 001044   000006 000001 7                  ADSC9   6                        cn=0,n=1
         6 001045   001052 602000 6                  TNC     s:3439
         6 001046   040005 106400                    CMPC    fill='040'O
         6 001047   000007 000001 7                  ADSC9   7                        cn=0,n=1
         6 001050   000000 000001 2                  ADSC9   TOKEN,A                  cn=0,n=1
         6 001051   001054 603000 6                  TRC     s:3440

      522     3439    3           OR SUBSTR(TOKEN,J,1) > '9' THEN ALTRETURN;

   3439  6 001052   200014 221300                    LDX1  ! NOT_+2,,AUTO
         6 001053   000000 702211                    TSX2  ! 0,X1

      523     3440    3           END;

   3440  6 001054   200015 054100                    AOS     J,,AUTO
         6 001055   200015 236100                    LDQ     J,,AUTO
         6 001056   200005 116100                    CMPQ    TDISP,,AUTO
         6 001057   001041 604000 6                  TMI     s:3438

      524     3441    2         CALL CHARBIN (TEMP,ADDR(TOKEN)->B$CHARS);

   3441  6 001060   200005 720100                    LXL0    TDISP,,AUTO
         6 001061   000100 305440                    DTB
         6 001062   000000 030010 2                  NDSC9   TOKEN                    cn=0,s=nosgn,sf=0,n=*X0
         6 001063   200006 000004                    NDSC9   TEMP,,AUTO               cn=0,s=lsgnf,sf=0,n=4

      525     3442    2         RETURN;

   3442  6 001064   200014 221300                    LDX1  ! NOT_+2,,AUTO
         6 001065   000001 702211                    TSX2  ! 1,X1
      526     3443    2   END GNUM;
      527     3444    1   END ODP$PARSE;

PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:61   
--  Include file information  --

   XSJ_SUBS_C.:E05TOU  is referenced.
   XSJ_MAC_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   OD_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FOO_MAC_C.:E05TOU  is referenced.
   OD_MAC_C.:E05TOU  is referenced.
   OD_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ODP$PARSE.
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:62   

 **** Variables and constants ****

  ****  Section 001 RoData ODP$PARSE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(68)    r     1 HELP(0:49)              1522-0-0/d STRC(144)   r     1 SET_DISPJOB

  ****  Section 002  Data  ODP$PARSE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    20-0-0/w CHAR(8)     r     1 JACCT                     10-0-0/w CHAR(31)    r     1 JNAME
    22-0-0/d STRC(288)   r     1 JOPN                      32-0-0/d STRC(288)   r     1 JREAD
     0-0-0/w CHAR(32)    r     1 TOKEN                     44-0-0/d STRC(432)   r     1 WRITE_HELP
    42-0-0/w STRC(18)    r     1 XSJ_NAMEREC

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @ALLFLG                   *0-0-0/w UBIN        r     1 ALLFLG
     4-0-0/w SBIN        r     1 I                         11-0-0/c CHAR        r     1 ICHAR
    10-0-0/w SBIN        r     1 IDISP                      7-0-0/w SBIN        r     1 ISIZ
    15-0-0/w SBIN        r     1 J                         12-0-0/w UBIN        r     1 NOT_
     5-0-0/w SBIN        r     1 TDISP                      6-0-0/w SBIN        r     1 TEMP

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/d CHAR(140)   r     1 OD_CSCGBUF
     0-0-0/w STRC(792)   r     1 OD_CXT                     0-0-0/w STRC(792)   r     1 OD_CXT_INIT
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:63   

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 B$CHAR                     0-0-0/c ACHR        r     1 B$CHARS
     0-0-0/d STRC(2088)  r     1 B$JIT                      0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 M$JSF                      0-0-0N  NULL        r     1 M$ME
     0-0-0N  NULL        r     1 M$SI


   Procedure ODP$PARSE requires 566 words for executable code.
   Procedure ODP$PARSE requires 16 words of local(AUTO) storage.

    No errors detected in file ODP$PARSE.:E05TSI    .
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:64   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:65   
          MINI XREF LISTING

ALLFLG
        82**DCL        74--PROC     3192<<ASSIGN   3211<<ASSIGN
ALTRT
      3381**LABEL    3171--CALLALT
B$CHAR
      2847**DCL      3404>>ASSIGN   3413>>ASSIGN   3419>>ASSIGN
B$CHARS
      2848**DCL      3441>>CALLBLT
B$JIT.ACCN
      2855**DCL      3370>>ASSIGN
B$JIT.ERR.MID
      2856**DCL      2856--REDEF
B$JIT.WOO
      2855**DCL      3154>>ASSIGN
B$JIT$
      3144**DCL      2850--IMP-PTR  3154>>ASSIGN   3370>>ASSIGN
BADCMD
      3381**LABEL    3212--CALLALT  3242--CALLALT  3248--CALLALT  3277--CALLALT  3285--GOTO     3325--CALLALT
      3326--CALLALT  3334--CALLALT  3343--CALLALT  3353--CALLALT
CMD0
      3169**LABEL    3178--GOTO
CMD01
      3211**LABEL    3193--GOTO     3204--GOTO
CMD1
      3246**LABEL    3231--GOTO     3294--GOTO     3302--GOTO     3310--GOTO     3318--GOTO     3337--GOTO
      3346--GOTO
CMD11
      3265**LABEL    3223--GOTO     3364--GOTO
CMD2
      3328**LABEL    3344--GOTO
CMD8
      3355**LABEL    3386--GOTO
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:66   
CMD9
      3372**LABEL    3371--CALLALT
F$DCB.ACTPOS
      2643**DCL      2643--REDEF
F$DCB.ARS
      2618**DCL      2618--REDEF    3167>>ASSIGN
F$DCB.ATTR
      2636**DCL      2637--REDEF
F$DCB.BORROW
      2651**DCL      2651--REDEF    2651--REDEF    2651--REDEF
F$DCB.DCBNAME.L
      2665**DCL      2665--IMP-SIZ
F$DCB.EOMCHAR
      2622**DCL      2622--REDEF
F$DCB.FCD
      2631**DCL      3380>>IF
F$DCB.FLDID
      2646**DCL      2646--REDEF
F$DCB.FORM$
      2640**DCL      2640--REDEF
F$DCB.FSECT
      2656**DCL      2656--REDEF
F$DCB.FSN
      2633**DCL      2633--REDEF    2633--REDEF    2634--REDEF
F$DCB.HEADER$
      2639**DCL      2639--REDEF
F$DCB.IXTNSIZE
      2637**DCL      2637--REDEF
F$DCB.LASTSTA$
      2627**DCL      2627--REDEF
F$DCB.LVL
      2652**DCL      2652--REDEF
F$DCB.NAME.C
      2627**DCL      2627--REDEF
F$DCB.NOEOF
      2648**DCL      2648--REDEF
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:67   
F$DCB.NRECS
      2638**DCL      2638--REDEF
F$DCB.NRECX
      2657**DCL      2657--REDEF
F$DCB.OHDR
      2649**DCL      2649--REDEF
F$DCB.ORG
      2632**DCL      2632--REDEF
F$DCB.PRECNO
      2655**DCL      2655--REDEF
F$DCB.RCSZ
      2660**DCL      2660--REDEF
F$DCB.RES
      2628**DCL      2628--REDEF
F$DCB.SETX
      2640**DCL      2640--REDEF
F$DCB.TAB$
      2639**DCL      2640--REDEF
F$DCB.TDA
      2654**DCL      2654--REDEF
F$DCB.WSN
      2629**DCL      2629--REDEF
GNUM
      3433**PROC     3326--CALL     3334--CALL     3353--CALL
GOTCMD
      3392**LABEL    3222--CALLALT  3230--CALLALT  3238--CALLALT  3244--CALLALT  3250--CALLALT  3257--CALLALT
      3265--CALLALT  3272--CALLALT  3283--GOTO     3293--CALLALT  3301--CALLALT  3309--CALLALT  3317--CALLALT
      3329--CALLALT  3336--CALLALT  3356--CALLALT  3362--CALLALT  3381--CALLALT  3382--CALLALT  3387--GOTO
GTOKE
      3399**PROC     3171--CALL     3222--CALL     3230--CALL     3238--CALL     3242--CALL     3244--CALL
      3248--CALL     3250--CALL     3257--CALL     3265--CALL     3272--CALL     3277--CALL     3293--CALL
      3301--CALL     3309--CALL     3317--CALL     3325--CALL     3329--CALL     3336--CALL     3343--CALL
      3356--CALL     3362--CALL     3371--CALL     3375--CALL
HELP
      2960**DCL      3201--ASSIGN
I
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:68   
      2947**DCL      3200<<DOINDEX  3201>>ASSIGN
ICHAR
      2952**DCL      3404<<ASSIGN   3405>>IF       3408>>IF       3413<<ASSIGN   3415>>CALLBLT  3419<<ASSIGN
      3420>>IF       3422>>CALLBLT
IDISP
      2951**DCL      3169<<ASSIGN   3403>>DOWHILE  3404>>ASSIGN   3411<<ASSIGN   3411>>ASSIGN   3412>>IF
      3413>>ASSIGN   3417<<ASSIGN   3417>>ASSIGN   3418>>DOWHILE  3419>>ASSIGN   3424<<ASSIGN   3424>>ASSIGN
      3428<<ASSIGN   3428>>ASSIGN
ISIZ
      2950**DCL      3167<<ASSIGN   3168>>IF       3403>>DOWHILE  3412>>IF       3418>>DOWHILE
J IN PROCEDURE GNUM
      3435**DCL      3437<<DOINDEX  3438>>IF       3438>>IF
JACCT
      3013**DCL      3052--DCLINIT  3370<<ASSIGN   3374<<ASSIGN
JNAME
      3012**DCL      3053--DCLINIT  3369<<ASSIGN
JOPN
      3028**DCL      3381<>CALL
JREAD
      3051**DCL      3382<>CALL
M$EXIT
       110**DCL-ENT  3168--CALL     3186--CALL
M$JSF
      3078**DCL      3380--IF
M$SI
      3077**DCL      3167--ASSIGN
M$SPRIV
       157**DCL-ENT  3212--CALL
M$WRITE
        99**DCL-ENT  3202--CALL
NOT_
      2953**DCL      3241>>ASSIGN   3256>>ASSIGN   3262>>ASSIGN   3264>>ASSIGN   3400<<ASSIGN   3410<<ASSIGN
OD$CXT.HIPRIO
      2834**DCL      2835--REDEF
OD$CXT.NOTWSN
      2831**DCL      2832--REDEF
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:69   
OD_CSCGBUF
      2400**DCL      3404--ASSIGN   3413--ASSIGN   3419--ASSIGN
OD_CXT
      2492**DCL      3153<<ASSIGN
OD_CXT.CATTR.OUTPUT
      2544**DCL      3166<<ASSIGN
OD_CXT.DEVTYP
      2529**DCL      3162<<ASSIGN   3249<<ASSIGN
OD_CXT.FORCE
      2525**DCL      3164<<ASSIGN   3271<<ASSIGN
OD_CXT.FULL
      2526**DCL      3355<<ASSIGN   3361<<ASSIGN   3384<<ASSIGN
OD_CXT.HIPRIO
      2534**DCL      2535--REDEF    3328<<ASSIGN   3335<<ASSIGN
OD_CXT.KIN#
      2522**DCL      3214<<ASSIGN   3221<<ASSIGN   3229<<ASSIGN   3237<<ASSIGN   3292<<ASSIGN   3300<<ASSIGN
      3308<<ASSIGN   3316<<ASSIGN   3324<<ASSIGN   3352<<ASSIGN   3378<<ASSIGN
OD_CXT.LOPRIO
      2533**DCL      3327<<ASSIGN   3328>>ASSIGN
OD_CXT.LPWSN
      2528**DCL      3154<<ASSIGN
OD_CXT.NOTACCT
      2530**DCL      3158<<ASSIGN   3256<<ASSIGN
OD_CXT.NOTFORM
      2540**DCL      3159<<ASSIGN   3241<<ASSIGN
OD_CXT.NOTTERM
      2532**DCL      3161<<ASSIGN   3264<<ASSIGN
OD_CXT.NOTWSN
      2531**DCL      2532--REDEF    3160<<ASSIGN   3262<<ASSIGN
OD_CXT.ONLP
      2524**DCL      3165<<ASSIGN   3282<<ASSIGN
OD_CXT.SACCT
      2538**DCL      3163<<ASSIGN   3255<<ASSIGN
OD_CXT.SFORM
      2539**DCL      3157<<ASSIGN   3243<<ASSIGN
OD_CXT.STNAME
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:70   
      2537**DCL      3156<<ASSIGN   3263<<ASSIGN
OD_CXT.SWSN
      2536**DCL      3155<<ASSIGN   3261<<ASSIGN   3263>>ASSIGN
OD_CXT.SYSID
      2527**DCL      3354<<ASSIGN   3379<<ASSIGN   3383<<ASSIGN
OD_CXT_INIT
      2423**DCL      3153>>ASSIGN
OD_CXT_INIT.HIPRIO
      2465**DCL      2466--REDEF
OD_CXT_INIT.NOTWSN
      2462**DCL      2463--REDEF
OD_READCSCG.STATION_
      2581**DCL      2582--REDEF
OD_READCSCG.V.DVBYTE.REREAD#
      2593**DCL      2593--REDEF
OD_READCSCG.V.INDX#
      2591**DCL      2591--REDEF
SET_DISPJOB
      3099**DCL      3212<>CALL
SET_DISPJOB.V
      3099**DCL      3099--DCLINIT
TDISP
      2948**DCL      2848--IMP-SIZ  3179>>IF       3401<<ASSIGN   3415>>CALLBLT  3416<<ASSIGN   3416>>ASSIGN
      3421>>IF       3422>>CALLBLT  3423<<ASSIGN   3423>>ASSIGN   3437>>DOINDEX  3441>>CALLBLT
TEMP
      2949**DCL      3327>>ASSIGN   3335>>ASSIGN   3354>>ASSIGN   3441<<CALLBLT
TOKEN
      3011**DCL      3172>>IF       3172>>IF       3175>>IF       3175>>IF       3175>>IF       3175>>IF
      3179<<ASSIGN   3179>>ASSIGN   3180<<ASSIGN   3180>>ASSIGN   3183>>IF       3183>>IF       3183>>IF
      3183>>IF       3183>>IF       3183>>IF       3188>>IF       3188>>IF       3196>>IF       3196>>IF
      3207>>IF       3207>>IF       3218>>IF       3218>>IF       3226>>IF       3226>>IF       3234>>IF
      3234>>IF       3239>>IF       3243>>ASSIGN   3246>>IF       3249>>ASSIGN   3253>>IF       3255>>ASSIGN
      3259>>IF       3261>>ASSIGN   3268>>IF       3268>>IF       3274>>IF       3274>>IF       3279>>IF
      3279>>IF       3287>>IF       3287>>IF       3287>>IF       3287>>IF       3297>>IF       3297>>IF
      3305>>IF       3305>>IF       3313>>IF       3313>>IF       3321>>IF       3321>>IF       3331>>IF
      3331>>IF       3339>>IF       3339>>IF       3339>>IF       3349>>IF       3349>>IF       3358>>IF
PL6.E3A0      #001=ODP$PARSE File=ODP$PARSE.:E05TSI                              WED 07/30/97 04:12 Page:71   
      3358>>IF       3367>>IF       3369>>ASSIGN   3372>>IF       3374>>ASSIGN   3385>>IF       3402<<ASSIGN
      3415<<CALLBLT  3422<<CALLBLT  3438>>IF       3438>>IF       3441--CALLBLT
WRITE_HELP
      3124**DCL      3202<>CALL
WRITE_HELP.BUF_
      3124**DCL      3201<<ASSIGN
WRITE_HELP.STATION_
      3126**DCL      3126--REDEF
WRITE_HELP.V
      3127**DCL      3124--DCLINIT
WRITE_HELP.V.DVBYTE.VFC#
      3133**DCL      3133--REDEF
XSJ$OPEN
      3145**DCL-ENT  3381--CALL
XSJ$READ
      3146**DCL-ENT  3382--CALL
XSJ_NAMEREC
      3068**DCL      3051--DCLINIT  3052--DCLINIT
XSJ_NAMEREC.SYSID#
      3068**DCL      3383>>ASSIGN
