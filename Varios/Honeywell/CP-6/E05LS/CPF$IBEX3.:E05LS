VERSION E05

PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:1    
        1        1        /*M* SWITCH, PROFILE, TERMINAL, PRIV, PPRIV, PROMPT cmds */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DFC   */
        8        8        /*P*   NAME:   CPF$IBEX3
        9        9               PURPOSE: To perform all the required operations in  the execution
       10       10                       of selected IBEX commands.
       11       11               DESCRIPTION:
       12       12               REFERENCE: Programmers Reference Manual
       13       13        */
       14       14        /**********************************************************************/
       15       15        CPF$IBEX3:
       16       16          PROC(P$PCB) ALTRET;
       17       17                   %INCLUDE B$JIT;
       18      307                   %INCLUDE B_ERRORS_C;
       19     1434                   %INCLUDE B_MACROS_C;
       20     1545                   %INCLUDE CP_6;
       21     1626                   %INCLUDE CP_6_SUBS;
       22     2166                   %INCLUDE CP_MACROS_C;
       23     2918                   %INCLUDE CP_PERR_C;
       24     3256                   %INCLUDE CP_SUBS_C;
       25     4173                   %INCLUDE XU_MACRO_C;
       26     7279                   %INCLUDE CP_DATA_R;
       27     9842                   %INCLUDE KL_SUPER_C;
       28    12744                   %INCLUDE NK_VFC_C;
       29    12818    1   DCL BLK$ PTR;                                    /*Parse output block ptr*/
       30    12819    1   DCL I SBIN;                                      /*Temp. Loc. For indexes*/
       31    12820    1   DCL J SBIN;                                      /*Temp. Loc for indexes*/
       32    12821    1   DCL PROMPT$ PTR;
       33    12822        %CP_PROMPT (NAME=PROMPT, STCLASS="BASED(PROMPT$)");
       34    12842        %CP_PROMPT (NAME=WRT_PROMPT, LEN=WRT_PROMPT.LEN_, STCLASS="BASED(PROMPT$)");
       35    12862    1   DCL TEMP$ PTR;                                   /*Temp. Pointer*/
       36    12863    1   DCL OUTBUFF CHAR (1024);
       37    12864    1   DCL OUTBUFF$ PTR;                                /*Output buffer ptr*/
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:2    
       38    12865    1   DCL DEST$ PTR;                                   /*Dynamic buffer ptr*/
       39    12866    1   DCL IN$ PTR;                                     /*Buffer ptr*/
       40    12867    1   DCL TBUFF CHAR(4);                               /*Temp. Buffer*/
       41    12868    1   DCL EXIST_FLG BIT(1) UNAL;                       /*Existence flag*/
       42    12869    1   DCL HAVE_EDTCTL BIT (1);
       43    12870    1   DCL HAVE_WINDOW BIT (1);
       44    12871    1   DCL FLAG_FOUND BIT (1);
       45    12872    1   DCL INBUFF CHAR(120);                            /*Input buffer*/
       46    12873    1   DCL LEN SBIN;                                    /*String length*/
       47    12874    1   DCL TAB_VAL SBIN;                                /*Tab value*/
       48    12875    1   DCL TEMP_STOR SBIN;                              /*Temp. Storage*/
       49    12876    1   DCL PROFC SBIN;                                  /*profile count*/
       50    12877    1   DCL MATCH_STR$ PTR;                              /*ptr to ? textc*/
       51    12878        %TEXTC (NAME=MATCH_STR, STCLASS="BASED(MATCH_STR$)");
       52    12883    1   DCL DCB# UBIN WORD ;
       53    12884    1   DCL STRM CHAR(2) ;
       54    12885    1   DCL LSPEED_TABLE(0:15) CHAR(5) CONSTANT INIT
       55    12886    1                  ('50','75','110','134','150','200','300','600','1050',
       56    12887    1                  '1200','1800','2000','2400','4800','9600','19200');
       57    12888    1   DCL 1 PPRIV_TBL(0:19) CONSTANT ALIGNED,  /*Processor privilege tables*/
       58    12889    1          2 LEN UBIN BYTE UNAL INIT
       59    12890    1            (6,6,3,2,6,5,6,4,4,5,6,7,7,5,9,6,9,8,6,7),
       60    12891    1          2 HDR CHAR(9) UNAL INIT
       61    12892    1            ('CntrlC','CntrlD','Eft','EL','NetCon','Label',
       62    12893    1            'PAdmin','PigC','PigD','Rates','Replay',
       63    12894    1            'SpiderC','SpiderD','Super','SuperAuth','SuperD','SuperForm',
       64    12895    1            'SuperWSN','SysCon','Volinit'),
       65    12896    1          2 MASK BIT(36) UNAL INIT
       66    12897    1            (%PPR_CNTRLC#,%PPR_CNTRLD#,%PPR_EFT#,%PPR_EL#,%PPR_NETCON#,
       67    12898    1            %PPR_LABEL#,%PPR_PADMIN#,%PPR_PIGC#,%PPR_PIGD#,
       68    12899    1            %PPR_RATES#,%PPR_REPLAY#,%PPR_SPIDERC#,%PPR_SPIDERD#,%PPR_SUPER#,
       69    12900    1            %PPR_SUPERAUTH#,%PPR_SUPERD#,%PPR_SUPERFORM#,%PPR_SUPERWSN#,
       70    12901    1            %PPR_SYSCON#,%PPR_VOLINIT#);
       71    12902        %EQU NUM_PRIVS = 22;
       72    12903    1   DCL 1 PRIV_TBL(0:%(NUM_PRIVS-1)) CONSTANT ALIGNED,  /*User privilege tables*/
       73    12904    1          2 LEN UBIN BYTE UNAL INIT
       74    12905    1            (5,4,7,4,4,5,6,5,6,5,3,3,4,3,6,4,4,2,6,6,6,3),
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:3    
       75    12906    1          2 HDR CHAR(7) UNAL INIT
       76    12907    1            ('ASave','CFEP','DispJob','ExMM','ExPM','FMBlk',
       77    12908    1            'FMDiag','FMEFT','FMRead','FMSec',
       78    12909    1            'GPP','IOQ','IOQW','JIT','MaxMem',
       79    12910    1            'MFEP','MSys','PM','SpclMM','SysCon','SysLog','TND'),
       80    12911    1          2 MASK BIT(36) UNAL INIT
       81    12912    1            (%PR_ASAVE#,%PR_CFEP#,%PR_DISPJOB#,
       82    12913    1           %PR_EXMM#,%PR_EXPM#,%PR_FMBLK#,%PR_FMDIAG#,%PR_FMEFT#,
       83    12914    1            %PR_FMREAD#,
       84    12915    1           %PR_FMSEC#,%PR_GPP#,%PR_IOQ#,%PR_IOQW#,%PR_JIT#,%PR_MAXMEM#,
       85    12916    1           %PR_MFEP#,%PR_MSYS#,%PR_PM#,%PR_SPCLMM#,%PR_SYSCON#,
       86    12917    1           %PR_SYSLOG#,%PR_TND#),
       87    12918               /* Add CODE for setting JIT active, job, and saved privs in
       88    12919                  the PRIV command. 999999 codes mean it's impossible to get
       89    12920                  this priv via IBEX. I.e., we'll never see it in this case.*/
       90    12921    1          2 CODE UBIN WORD UNAL INIT
       91    12922    1            (ASAVEOPT,CFEPOPT,DISPJOBOPT,EXMMOPT,EXPMOPT,999999,
       92    12923    1            FMDIAGOPT,999999,FMREADOPT,FMSECOPT,
       93    12924    1            GPPOPT,IOQOPT,IOQWOPT,JITOPT,MAXMEMOPT,
       94    12925    1            MFEPOPT,MSYSOPT,PMOPT,SPCLMMOPT,SYSCONOPT,SYSLOGOPT,TNDOPT);
       95    12926    1   DCL B$OCTAL(0:11) CHAR(1) BASED UNAL;            /*Octal based structure*/
       96    12927    1   DCL SW_OCTAL(0:11) UBIN(3) UNAL;                 /*Octal switch values*/
       97    12928    1   DCL SW_BINARY(0:35) REDEF SW_OCTAL BIT(1) UNAL;  /*Binary switches*/
       98    12929    1   DCL THDR CONSTANT CHAR(23) INIT('   Terminal attributes:');
       99    12930    1   DCL PRIVHDR CONSTANT CHAR(23) INIT('   Privileges:');
      100    12931    1   DCL PRO_HDR CONSTANT CHAR(12) INIT('   Profiles:');
      101    12932    1   DCL PRO_CUR CONSTANT CHAR(15) INIT('      current: ');
      102    12933    1   DCL PRO_AVAIL CONSTANT CHAR(18) INIT('      available:  ');
      103    12934    1   DCL PPRIV_HDR CONSTANT CHAR(24) INIT('   Processor privileges:');
      104    12935    1   DCL LPARITY_TYPE (0:7) CHAR(4) CONSTANT INIT ('none', 'odd', 'even',
      105    12936    1      'one', 'zero', '?'*0);
      106    12937    1   DCL LDVCFLWCTRALG (0:7) CHAR (6) CONSTANT INIT ('none', 'EnqAck', 'EtxAck',
      107    12938    1      'DC1DC3', '?'*0);
      108    12939    1   DCL LKEYTYPE (0:7) CHAR (6) CONSTANT INIT ('?'*4, 'Bin10', 'BinHlf',
      109    12940    1      'Bin521', 'String');
      110    12941    1   DCL SET_PRIVS BIT(36);
      111    12942    1   DCL RESET_PRIVS BIT(36);
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:4    
      112    12943    1   DCL PRIV_ERR BIT(1) UNAL;                        /*Priv. Err flag*/
      113    12944    1   DCL DI_FULL BIT(1) ALIGNED AUTO;
      114    12945             /***** External procedure (entry) declarations *****/
      115    12946    1   DCL CPE$RZEROS ENTRY(3);                         /*Remove leading zeros*/
      116    12947    1   DCL CPB$BLDIMAGE ENTRY(5) ALTRET;                /*Build print image*/
      117    12948    1   DCL CPE$LISTOUT ENTRY(1) ALTRET;                 /*List buffer contents*/
      118    12949    1   DCL CPC$GETSEG ENTRY(2) ALTRET;                  /*Get spec'd segment*/
      119    12950    1   DCL CPC$RELSEG ENTRY(1);
      120    12951    1   DCL CPC$RDHLP ENTRY(2) ALTRET;
      121    12952    1   DCL CPC$WRHLP ENTRY(1) ALTRET;
      122    12953    1   DCL CPC$OPEN_S ENTRY(1) ALTRET ;
      123    12954    1   DCL CPJ$WRITE_S ENTRY(3) ALTRET ;
      124    12955    1   DCL CPC$WRITEMSGE ENTRY(6);
      125    12956    1   DCL CPF$FIND_UCNN ENTRY(2) ALTRET ;
      126    12957    1   DCL CPB$WILDCMPR ENTRY(2) ALTRET ;
      127    12958             /***** Fpts *****/
      128    12959        %FPT_OPEN(FPTN=FPT_OPEN,STCLASS=AUTO);
      129    13068        %FPT_CLOSE(FPTN=FPT$CLOSE,STCLASS=BASED);
      130    13110        %FPT_CLOSE(FPTN=FPT_CLOSE,STCLASS=AUTO);
      131    13152        %FPT_READ(FPTN=FPT_READ,STCLASS=AUTO);
      132    13191        %F$DCB(DCBN=F$DCB);
      133    13248        %FPT_WRITE(FPTN=FPT$WRITE,STCLASS=BASED);
      134    13279        %FPT_PROFILE(FPTN=FPT_PROFILE,STCLASS=AUTO);
      135    13300        %FPT_GLINEATTR(FPTN=FPT_GLINEATTR,STCLASS=AUTO);
      136    13325        %FPT_TRMCTL(FPTN=FPT_TRMCTL,STCLASS=AUTO);
      137    13352        %FPT_TRMATTR(FPTN=FPT_TRMATTR,STCLASS=AUTO);
      138    13377        %FPT_PRIV(FPTN=USER_PRIV,STCLASS=AUTO);
      139    13392        %VLP_NAME(FPTN=K_PRO,NAME=':PRO',LEN=4,STCLASS=CONSTANT);
      140    13419        %VLP_NAME(FPTN=PRO_NAME,LEN=31,STCLASS=AUTO);
      141    13446        %VLP_TRMCTL(FPTN=VLP_TRMCTL,STCLASS=AUTO);
      142    13486        %VLP_EDTCTL(FPTN=VLP_EDTCTL,STCLASS=AUTO);
      143    13514        %VLP_WINDOW(FPTN=VLP_WINDOW,STCLASS=AUTO);
      144    13558        %VLP_LINEATTR(FPTN=VLP_LINEATTR,STCLASS=AUTO);
      145    13580        %VLP_TRMATTR(FPTN=VLP_TRMATTR,STCLASS=AUTO);
      146    13618             /***** Error codes *****/
      147    13619        %ERR_CODE (NAME=E_NOPRIVLGE,MID#=CPF$IBEXMID,CODE#=E$NOPRIVLGE,STCLASS=CONSTANT);
      148    13639        %ERR_CODE (NAME=E_NOSUCHSTRM,MID#=CPF$IBEXMID,CODE#=E$NOSUCHSTRM,STCLASS=CONSTANT);
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:5    
      149    13659             /***** Based structures *****/
      150    13660        %B$EXCFR;
      151    13678        %B$TCB (STCLASS="BASED(B$TCB$)");
      152    13681        %PARSE$OUT (NAME=P$B);
      153    13726        %P$PCB(NAME=P$PCB,STCLASS="");
      154    13927        %PARSE$SYM(NAME=P$S);
      155    13965        %SEG$2(NAME=SEG$2);
      156    14025        %TEXTC(NAME=TEXT$C);
      157    14030        %KL_DREC(NAME=KL$DREC,STCLASS=BASED,LAST=",");
      158    14143        %KL_FEBLK(NAME=KL$FEBLK,RCNT=31,LVL=2) ;
      159    14192                   %EJECT;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:6    
      160    14193        /**********************************************************************/
      161    14194        /*F*   NAME:   CPF$SWITCH
      162    14195               PURPOSE: The SWITCH command is utilized to set specified sense switches
      163    14196                       or to display same.
      164    14197               DESCRIPTION: A user is permitted to set any of thirty six switches
      165    14198                       individually or all switches by specifying 'ALL'. With
      166    14199                       no arguments, the current setting of the user's pseudo
      167    14200                       sense switches are displayed.
      168    14201               REFERENCE: Programmers Reference Manual
      169    14202        */
      170    14203        /*D*   NAME:   CPF$SWITCH
      171    14204               CALL:   CALL CPE$SWITCH
      172    14205               INTERFACE: CPE$RZEROS,CPB$BLDIMAGE,CPE$LISTOUT
      173    14206               INPUT:  BLK$ - pointer to parsed output
      174    14207               OUTPUT: sense switches settings to the listing device
      175    14208                       B$JIT.SWITCH - pseudo sense switches set
      176    14209               DESCRIPTION: If no sub-blocks are found, the sense switch settings
      177    14210                       are displayed. If the sub-block for 'ALL' is found, all
      178    14211                       sense switches are set. Otherwise, individual sense switches
      179    14212                       are set as specified by the various sub-blocks.
      180    14213        */
      181    14214        /**********************************************************************/
      182    14215    1   CPF$SWITCH:
      183    14216    1     ENTRY(P$PCB)   ALTRET;
      184    14217        /**/
      185    14218        /**/
      186    14219    1     BLK$ = P$PCB.OUT$;
      187    14220        /*
      188    14221          ****     No options after switch indicates switches are to be displayed
      189    14222        */
      190    14223    1     IF (BLK$->P$B.NSUBLKS=0)
      191    14224    1        THEN
      192    14225    2           DO;
      193    14226    2              OUTBUFF$=ADDR(OUTBUFF);
      194    14227    2              DEST$=OUTBUFF$;                 /*Dynamic ptr*/
      195    14228        /* ****          Insert 'SWITCHES SET:' into output image*/
      196    14229    2              OUTBUFF='   Switches set: ';
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:7    
      197    14230    2              DEST$=PINCRC(DEST$,SIZEC('   Switches set: ')); /*Incr. To nxt LOC.*/
      198    14231    2              TAB_VAL=6;
      199    14232        /* ****          Insert switch values into output image*/
      200    14233    2              EXIST_FLG=%NO#;                   /*Init. Switch flag*/
      201    14234    3              DO I=0 TO 35;
      202    14235    3                 IF B$JIT.SWITCH(I)=%YES#
      203    14236    3                    THEN
      204    14237    4                       DO;
      205    14238    4                          CALL BINCHAR(TBUFF,I);
      206    14239    4                          CALL CPE$RZEROS(TBUFF,SIZEC(TBUFF),LEN);
      207    14240    4                          CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TBUFF),LEN,TAB_VAL)
             14240                                   ALTRET(SWITCH50);
      208    14241    4                          TBUFF=',';
      209    14242    4                          CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TBUFF),1,TAB_VAL)
             14242                                   ALTRET(SWITCH50);
      210    14243    4                          EXIST_FLG=%YES#;
      211    14244    4                       END;
      212    14245    3              END;
      213    14246        /* ****          See if any switches set         */
      214    14247    2              IF (EXIST_FLG=%YES#)
      215    14248    2                 THEN   /* Remove comma */
      216    14249    2                    SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$)-2;
      217    14250
      218    14251    2                 ELSE
      219    14252    3                    DO;
      220    14253    3                       TBUFF='none';
      221    14254    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TBUFF),4) ALTRET(SWITCH50)
             14254                                ;
      222    14255    3                       SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$);
      223    14256    3                    END;
      224    14257    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;
      225    14258    2              CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(SWITCH50);
      226    14259    2              RETURN;
      227    14260    2           END;
      228    14261        /*
      229    14262          ****     Set or reset specified switches in the jit.
      230    14263        */
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:8    
      231    14264    2     DO CASE (BLK$->P$B.SUBLK$(0)->P$B.CODE);
      232    14265    2      CASE(SWLISTOPT);
      233    14266    3        DO I = 0 TO BLK$->P$B.SUBLK$(0)->P$B.NSUBLKS - 1;
      234    14267    3           TEMP$ = BLK$->P$B.SUBLK$(0)->P$B.SUBLK$(I);
      235    14268    4           DO CASE(TEMP$->P$B.SUBLK$(0)->P$B.CODE);
      236    14269    4            CASE(IBEX_NO);
      237    14270    4              CALL CHARBIN (J,TEMP$->P$B.SUBLK$(0)->
      238    14271    4                   P$B.SUBLK$(0)->P$S.TEXT);
      239    14272    4              B$JIT.SWITCH(J) = %NO#;
      240    14273    4            CASE(IBEX_YES);
      241    14274    4              CALL CHARBIN (J,TEMP$->P$B.SUBLK$(0)->
      242    14275    4                   P$B.SUBLK$(0)->P$S.TEXT);
      243    14276    4              B$JIT.SWITCH(J) = %YES#;
      244    14277    4            END;
      245    14278    3        END;
      246    14279    2      CASE(SWOCTOPT);
      247    14280        /*
      248    14281             ***** Convert octal values to binary...
      249    14282        */
      250    14283    2        TEMP$ = BLK$ -> P$B.SUBLK$(0);
      251    14284    2        SW_OCTAL='0'O;
      252    14285    2        DEST$=ADDR(TEMP$->P$B.SUBLK$(0)->P$B.SUBLK$(0)
      253    14286    2             ->P$S.TEXT);
      254    14287    2        J=11;
      255    14288    2        LEN=TEMP$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->
      256    14289    2             P$S.COUNT-1;
      257    14290    3        DO WHILE (LEN >= 0);
      258    14291    3           CALL CHARBIN(TEMP_STOR,DEST$->B$OCTAL(LEN));
      259    14292    3           SW_OCTAL(J)=TEMP_STOR;
      260    14293    3           J=J-1;
      261    14294    3           LEN=LEN-1;
      262    14295    3        END;
      263    14296    3        DO CASE(TEMP$->P$B.SUBLK$(0)->P$B.CODE);
      264    14297    3         CASE(IBEX_NO);
      265    14298    4           DO J=0 TO 35;
      266    14299    4              B$JIT.SWITCH(J) = B$JIT.SWITCH(J) & ~(SW_BINARY(J));
      267    14300    4           END;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:9    
      268    14301    3         CASE(IBEX_YES);
      269    14302    4           DO J=0 TO 35;
      270    14303    4              B$JIT.SWITCH(J) = B$JIT.SWITCH(J) | SW_BINARY(J);
      271    14304    4           END;
      272    14305    3         END;
      273    14306    2      CASE(SWALLOPT);
      274    14307    3        DO CASE(BLK$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE);
      275    14308    3         CASE(IBEX_NO);
      276    14309    4           DO J=0 TO 35;
      277    14310    4              B$JIT.SWITCH(J) = %NO#;
      278    14311    4           END;
      279    14312    3         CASE(IBEX_YES);
      280    14313    4           DO J=0 TO 35;
      281    14314    4              B$JIT.SWITCH(J) = %YES#;
      282    14315    4           END;
      283    14316    3         END;
      284    14317    2      END; /* do case ... end */
      285    14318    1     RETURN;
      286    14319    1   SWITCH50:;
      287    14320    1     ALTRETURN;
      288    14321                   %EJECT;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:10   
      289    14322        /**********************************************************************/
      290    14323        /*F*   NAME:   CPF$PROFILE
      291    14324               PURPOSE: The PROFILE command is utilized to specify a desired
      292    14325                       terminal profile. Also the current profile and available
      293    14326                       profiles can be displayed using this command.
      294    14327               DESCRIPTION: The terminal profile is changed to the one specified
      295    14328                       on the command. The profile specified must be a recognized
      296    14329                       profile previously established by the system mamager. These
      297    14330                       profiles are established by SUPER. The user's default profile
      298    14331                       is modified if PERM is specified.
      299    14332                      If a profile display is requested, the current profile
      300    14333                        and available profiles are utput to the listing device.
      301    14334               REFERENCE: Programmers Reference Manual
      302    14335        */
      303    14336        /*D*   NAME:   CPF$PROFILE
      304    14337               CALL:   CALL CPF$PROFILE(P$PCB)
      305    14338               INTERFACE:
      306    14339               INPUT:  parse control block
      307    14340                       :PRO file in :SYS
      308    14341               OUTPUT: user profile established
      309    14342                        profile information to the listing device
      310    14343               DESCRIPTION: The users profile is established via the M$PROFILE
      311    14344                       pmme. A message is output to the user if a
      312    14345                       unrecognized profile name is specified.
      313    14346                       On a display, the file :PRO in :SYS is read and it's keys
      314    14347                       which are the available profile names are output to
      315    14348                       the user.
      316    14349
      317    14350        */
      318    14351        /**********************************************************************/
      319    14352    1   CPF$PROFILE: ENTRY(P$PCB) ALTRET;
      320    14353    1     BLK$=P$PCB.OUT$;
      321    14354        /*
      322    14355             ***** If not INTERACTIVE then this command makes no sense...
      323    14356        */
      324    14357    1     IF B$JIT.MODE ~= %M_INT#
      325    14358    1        THEN   /* Ignore this command */
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:11   
      326    14359    1           RETURN;
      327    14360    1     CALL CPC$GETSEG(SEG3$) ALTRET(PROFILE50);
      328    14361    1     IF (BLK$->P$B.NSUBLKS=0)
      329    14362    1        THEN
      330    14363    2           DO;   /* Only display part of the information */
      331    14364    2              DI_FULL = %NO#;
      332    14365    2              MATCH_STR$ = ADDR(NIL);
      333    14366    2              GOTO PROFILE10;
      334    14367    2           END;
      335    14368    1     TEMP$ = BLK$->P$B.SUBLK$(0);
      336    14369    1     IF TEMP$ -> P$B.CODE = PROF_NAME
      337    14370    1       THEN
      338    14371    2         DO ;
      339    14372    2           FPT_PROFILE = CFPT_PROFILE;
      340    14373    2           FPT_PROFILE.V_ = VECTOR(FPT_PROFILE.V);
      341    14374    2           FPT_PROFILE.PROFILE_ =
      342    14375    2                VECTOR(TEMP$->P$B.SUBLK$(0)->P$S.TEXTC$->TEXT$C);
      343    14376    2           FPT_PROFILE.BUF_.BOUND = 4095;
      344    14377    2           FPT_PROFILE.BUF_.BUF$ = SEG3$;
      345    14378    2           FPT_PROFILE.V.DCB# = M$UC_NUM;
      346    14379    2           CALL M$PROFILE (FPT_PROFILE) ALTRET(PROFILE50);
      347    14380    2         END ; /* Then Do */
      348    14381    1     CALL CPC$RELSEG (SEG3$);
      349    14382        /*
      350    14383          ****  STORE PROFILE IN :HLP IF PERM SPEC'D
      351    14384        */
      352    14385    1     IF TEMP$->P$B.NSUBLKS > 1
      353    14386    1        THEN
      354    14387    2           DO;
      355    14388    2              CALL CPC$RDHLP(M$IBEX1_NUM,1) ALTRET(PROFILE60);
      356    14389    2              IF TEMP$ -> P$B.CODE = PROF_NAME
      357    14390    2               THEN
      358    14391    2                 SEG$2.HLP$->KL$DREC.PNAME = TEMP$->P$B.SUBLK$(0)->P$S.TEXTC$->
      359    14392    2                                               TEXT$C ;
      360    14393    2               ELSE
      361    14394    3                 DO ;
      362    14395    3                   SEG$2.HLP$->KL$DREC.PNAME.CNT = 0 ;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:12   
      363    14396    3                   SEG$2.HLP$->KL$DREC.PNAME.TXT = ' ' ;
      364    14397    3                 END ; /* Else Do */
      365    14398    2              CALL CPC$WRHLP(M$IBEX1_NUM) ALTRET(PROFILE60);
      366    14399        /*
      367    14400          **** Close and save :HLP
      368    14401        */
      369    14402    2              FPT_CLOSE = CFPT_CLOSE;
      370    14403    2              FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V);
      371    14404    2              FPT_CLOSE.V.DCB#=M$IBEX1_NUM;
      372    14405    2              FPT_CLOSE.V.DISP#=%SAVE#;
      373    14406    2              CALL M$CLOSE(FPT_CLOSE) ALTRET(PROFILE50);
      374    14407    2           END;
      375    14408    1     RETURN;
      376    14409        %EJECT;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:13   
      377    14410        /*F*    NAME:   CPF$DIPROFILES
      378    14411                PURPOSE: To allow different levels of display for PROFILEs
      379    14412        */
      380    14413    1   CPF$DIPROFILES: ENTRY(P$PCB) ALTRET;
      381    14414        /*
      382    14415             ***** If not in INTERACTIVE mode then this commands makes no sense ...
      383    14416        */
      384    14417    1     IF B$JIT.MODE ~= %M_INT#
      385    14418    1        THEN
      386    14419    1           RETURN;
      387    14420    1     CALL CPC$GETSEG(SEG3$) ALTRET(PROFILE50);
      388    14421    1     DI_FULL = %YES#;
      389    14422    1     BLK$=P$PCB.OUT$ -> P$B.SUBLK$(0);
      390    14423    1     IF (BLK$->P$B.NSUBLKS=0)
      391    14424    1       THEN MATCH_STR$ = ADDR(NIL);
      392    14425    1       ELSE MATCH_STR$ = BLK$->P$B.SUBLK$(0)->P$S.TEXTC$;
      393    14426        /*
      394    14427          ****  DISPLAY PROFILE INFORMATION
      395    14428        */
      396    14429    1   PROFILE10:;
      397    14430    1     IN$=ADDR(INBUFF);
      398    14431    1     OUTBUFF$=ADDR(OUTBUFF);
      399    14432    1     DEST$=OUTBUFF$;
      400    14433    1     TAB_VAL=6;
      401    14434    1     OUTBUFF=' ';
      402    14435        /*
      403    14436          ****  Output header
      404    14437        */
      405    14438    1     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_=VECTOR(PRO_HDR);
      406    14439    1     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(PROFILE50);
      407    14440        /*
      408    14441          ****  Output current profile
      409    14442        */
      410    14443    1     FPT_GLINEATTR = CFPT_GLINEATTR;
      411    14444    1     FPT_GLINEATTR.V_ = VECTOR(FPT_GLINEATTR.V);
      412    14445    1     FPT_GLINEATTR.LINEATTR_ = VECTOR(VLP_LINEATTR);
      413    14446    1     CALL M$GLINEATTR (FPT_GLINEATTR)
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:14   
      414    14447    2     WHENRETURN DO;
      415    14448    2        CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(PRO_CUR),SIZEC(PRO_CUR))
      416    14449    2             ALTRET(PROFILE50);
      417    14450    2        LEN = VLP_LINEATTR.PROTXTC.CNT;
      418    14451    2        CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(VLP_LINEATTR.PROTXTC.TXT)
      419    14452    2             ,LEN) ALTRET(PROFILE50);
      420    14453    2        SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$);
      421    14454    2        SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;
      422    14455    2        CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(PROFILE50);
      423    14456    2     END;
      424    14457        /*
      425    14458             ***** If the DI_FULL flag is NO then only display
      426    14459                   the current PROFILE. User doesn't need complete list ...
      427    14460        */
      428    14461    1     IF DI_FULL = %NO#
      429    14462    1        THEN
      430    14463    2           DO;
      431    14464    2              CALL CLOSE_REL ALTRET(PROFILE50);
      432    14465    2              RETURN;
      433    14466    2           END;
      434    14467        /*
      435    14468          ****   Output available profiles
      436    14469        */
      437    14470    1     DEST$=OUTBUFF$;
      438    14471    1     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(PRO_AVAIL),SIZEC(PRO_AVAIL))
      439    14472    1          ALTRET(PROFILE50);
      440    14473    1     FPT_OPEN=CFPT_OPEN;
      441    14474    1     FPT_OPEN.V_=VECTOR(FPT_OPEN.V);
      442    14475    1     FPT_OPEN.NAME_=VECTOR(K_PRO);
      443    14476    1     FPT_OPEN.ACCT_=VECTOR(COLONSYS);
      444    14477    1     FPT_OPEN.V.DCB#=M$IBEX1_NUM;
      445    14478    1     FPT_OPEN.V.ASN#=%FILE#;
      446    14479    1     FPT_OPEN.V.FUN#=%IN#;
      447    14480    1     FPT_OPEN.V.SHARE#=%ALL#;
      448    14481    1     FPT_OPEN.V.ORG#=%KEYED#;
      449    14482    1     FPT_OPEN.V.ACS#=%SEQUEN#;
      450    14483    1     CALL M$OPEN(FPT_OPEN) ALTRET(PROFILE40);
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:15   
      451    14484        /*
      452    14485          ****  Read in :PRO keys
      453    14486        */
      454    14487    1     FPT_READ=CFPT_READ;
      455    14488    1     FPT_READ.V_=VECTOR(FPT_READ.V);
      456    14489    1     FPT_READ.BUF_.BUF$=SEG3$;
      457    14490    1     FPT_READ.BUF_.BOUND=4095;
      458    14491    1     FPT_READ.KEY_=VECTOR(PRO_NAME);
      459    14492    1     FPT_READ.V.KEYS#=%NO#;
      460    14493    1     FPT_READ.V.KEYR#=%YES#;
      461    14494    1     FPT_READ.V.DCB#=M$IBEX1_NUM;
      462    14495        /*
      463    14496          ****  Loop until all keys are read
      464    14497        */
      465    14498    1     PROFC = 0;
      466    14499    2     DO WHILE ('1'B);
      467    14500    2       CALL M$READ(FPT_READ) ALTRET(PROFILE40);
      468    14501    2       IF PRO_NAME.L# <= 11
      469    14502    3         THEN DO;
      470    14503    3           CALL CPB$WILDCMPR (PRO_NAME, MATCH_STR)
      471    14504    4           WHENRETURN DO;
      472    14505    4             PROFC = PROFC + 1;
      473    14506    4             INBUFF=SUBSTR (PRO_NAME.NAME#, 0, PRO_NAME.L#);
      474    14507    4             CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,12,TAB_VAL)
      475    14508    4                  ALTRET(PROFILE50);
      476    14509    4           END;
      477    14510    3         END;
      478    14511    2     END;  /* DO WHILE ('1'B); */
      479    14512    1   PROFILE40:;
      480    14513    1     IF B$TCB.ALT$ -> B$EXCFR.ERR.CODE = %E$EOF
      481    14514    1     OR B$TCB.ALT$ -> B$EXCFR.ERR.CODE = %E$NOFILE
      482    14515    1        THEN
      483    14516    2           DO;
      484    14517    2              IF PROFC = 0
      485    14518    2                 THEN
      486    14519    3                    DO;
      487    14520    3                       INBUFF='none';
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:16   
      488    14521    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC('none'))
      489    14522    3                            ALTRET(PROFILE50);
      490    14523    3                    END;
      491    14524    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,
      492    14525    2                   OUTBUFF$);
      493    14526    2              IF SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND > TAB_VAL
      494    14527    2                 THEN
      495    14528    2                    CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(PROFILE50);
      496    14529    2              CALL CLOSE_REL ALTRET(PROFILE50);
      497    14530    2              RETURN;
      498    14531    2           END;
      499    14532    1   PROFILE50:;
      500    14533    1     B$JIT.USRERR = B$TCB.ALT$ -> B$EXCFR.ERR;
      501    14534    1     CALL CLOSE_REL ALTRET(PROFILE60);
      502    14535    1   PROFILE60:;
      503    14536    1     ALTRETURN;
      504    14537                   %EJECT;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:17   
      505    14538        /***********************************************************************/
      506    14539        /*F*   NAME:   CPF$TERMINAL
      507    14540               PURPOSE: The TERMINAL command is utilized to set or display various
      508    14541                       terminal characteristics.
      509    14542               DESCRIPTION: The various terminal characteristics which may be
      510    14543                       modified are those specifiable on the M$STRMCTL
      511    14544                       and M$STRMATTR fpts. Upon request, these
      512    14545                       same set of characteristics are displayed along with
      513    14546                       additional terminal releated information.
      514    14547               REFERENCE: Programmers Reference Manual
      515    14548        */
      516    14549        /*D*   NAME:   CPF$TERMINAL
      517    14550               CALL:   CALL CPF$TERMINAL(P$PCB)
      518    14551               INPUT:  parse control block
      519    14552               OUTPUT: terminal characteristics set or displayed
      520    14553               DESCRIPTION: If no sub-blocks are found, or if 1 sub-block that
      521    14554                       specifies a stream number to be used for the display, various
      522    14555                       terminal characteristics are displayed. Otherwise, specified
      523    14556                       terminal characteristics are set.
      524    14557        */
      525    14558        /**********************************************************************/
      526    14559    1   CPF$TERMINAL: ENTRY(P$PCB) ALTRET;
      527    14560          %SUB          SINPUTDFLT            = 0 /*Sinputdflt*/;
      528    14561                                                         /*
      529    14562                                                         */
      530    14563    1     BLK$=P$PCB.OUT$;
      531    14564        /*
      532    14565             ***** If not INTERACTIVE then this command makes no sense...
      533    14566        */
      534    14567    1     IF B$JIT.MODE ~= %M_INT#
      535    14568    1        THEN   /* Ignore this command */
      536    14569    1           RETURN;
      537    14570        /*
      538    14571          ****     No options following verb or if only 1 sub-block that specifies
      539    14572          ****     a stream infers ... Display the terminal profile.
      540    14573        */
      541    14574    1     IF (BLK$->P$B.NSUBLKS=0) OR (BLK$->P$B.NSUBLKS=1 AND
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:18   
      542    14575    1                                   BLK$->P$B.SUBLK$(0)->P$B.CODE = UCNN)
      543    14576    1        THEN
      544    14577    2           DO;
      545    14578    2              FPT_GLINEATTR = CFPT_GLINEATTR;
      546    14579    2              FPT_GLINEATTR.V_ = VECTOR(FPT_GLINEATTR.V);
      547    14580    2              FPT_GLINEATTR.LINEATTR_ = VECTOR(VLP_LINEATTR);
      548    14581    2              CALL M$GLINEATTR (FPT_GLINEATTR) ALTRET (TERM50);
      549    14582    2              FPT_TRMCTL = CFPT_TRMCTL;
      550    14583    2              FPT_TRMCTL.V_ = VECTOR(FPT_TRMCTL.V);
      551    14584    2              FPT_TRMCTL.TRMCTL_ = VECTOR(VLP_TRMCTL);
      552    14585    2              IF BLK$->P$B.NSUBLKS=1
      553    14586    2               THEN                /* A stream was specified */
      554    14587    3                 DO ;
      555    14588    3                   STRM = BLK$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$S.TEXT ;
      556    14589    3                   CALL CPF$FIND_UCNN (STRM, DCB#) WHENALTRETURN
      557    14590    4                                     DO ;
      558    14591    4                                       FPT_OPEN = CFPT_OPEN ;
      559    14592    4                                       FPT_OPEN.V_ = VECTOR(FPT_OPEN.V) ;
      560    14593    4                                       FPT_OPEN.V.DCB# = M$IBEX1_NUM ;
      561    14594    4                                       DCB# = M$IBEX1_NUM ;
      562    14595    4                                       CALL CONCAT(FPT_OPEN.V.RES#, 'UC', STRM) ;
      563    14596    4                                       FPT_OPEN.V.ORG# = %TERMINAL# ;
      564    14597    4                                       CALL M$OPEN (FPT_OPEN) WHENALTRETURN
      565    14598    5                                       DO ;
      566    14599    5                                         B$JIT.USRERR = E_NOSUCHSTRM ;
      567    14600    5                                         GOTO TERM70 ;
      568    14601    5                                       END ; /* Whenaltreturn Do */
      569    14602    4                                     END ; /* Whenaltreturn Do */
      570    14603    3                   FPT_TRMCTL.V.DCB# = DCB# ;
      571    14604    3                 END ; /* Then Do */
      572    14605        /*E*    ERROR: CPF-E$NOSUCHSTRM-C
      573    14606                MESSAGE: No such stream defined.
      574    14607        */
      575    14608        /**/
      576    14609    2              CALL M$GTRMCTL (FPT_TRMCTL) ALTRET(TERM50);
      577    14610    2            FPT_TRMCTL.TRMCTL_ = VECTOR(VLP_EDTCTL);
      578    14611    2            FPT_TRMCTL.V.VLPTYPE# = %TRMCTL_EDTCTL#;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:19   
      579    14612    2            HAVE_EDTCTL = %NO#;
      580    14613    2            CALL M$GTRMCTL (FPT_TRMCTL)
      581    14614    3              WHENRETURN DO;
      582    14615    3               IF DCBADDR(FPT_TRMCTL.V.DCB#) -> F$DCB.ORG# = %SE#
      583    14616    3                 THEN
      584    14617    3                  HAVE_EDTCTL = %YES#;
      585    14618    3               END;
      586    14619    2            FPT_TRMCTL.TRMCTL_ = VECTOR(VLP_WINDOW);
      587    14620    2            FPT_TRMCTL.V.VLPTYPE# = %TRMCTL_WINDOW#;
      588    14621    2            HAVE_WINDOW = %NO#;
      589    14622    2            CALL M$GTRMCTL (FPT_TRMCTL)
      590    14623    3              WHENRETURN DO;
      591    14624    3               HAVE_WINDOW = %YES#;
      592    14625    3               END;
      593    14626    2              FPT_TRMATTR = CFPT_TRMATTR;
      594    14627    2              FPT_TRMATTR.V_ = VECTOR(FPT_TRMATTR.V);
      595    14628    2              FPT_TRMATTR.V.DCB# = FPT_TRMCTL.V.DCB# ;
      596    14629    2              FPT_TRMATTR.V.DCB# = FPT_TRMCTL.V.DCB# ;
      597    14630    2              FPT_TRMATTR.TRMATTR_ = VECTOR(VLP_TRMATTR);
      598    14631    2              CALL M$GTRMATTR (FPT_TRMATTR) ALTRET(TERM50);
      599    14632    2              SEG$2.FPT_WRITE$->FPT$WRITE=CFPT_WRITE;
      600    14633    2              SEG$2.FPT_WRITE$->FPT$WRITE.V_=VECTOR(SEG$2.FPT_WRITE$
      601    14634    2                   ->FPT$WRITE.V);
      602    14635        /*
      603    14636          ****     Output header
      604    14637        */
      605    14638    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_=VECTOR(THDR);
      606    14639    2              CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(TERM70);
      607    14640        /*
      608    14641          ****           Init. Buffer ptrs
      609    14642        */
      610    14643    2              OUTBUFF$=ADDR(OUTBUFF);         /*Ptr to buff. BEGNG.*/
      611    14644    2              DEST$=OUTBUFF$;                 /*Dynamic ptr*/
      612    14645    2              IN$=ADDR(INBUFF);
      613    14646    2              TAB_VAL = 5;
      614    14647        /*
      615    14648          ****           Create mode-port line of output
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:20   
      616    14649        */
      617    14650    2              OUTBUFF='      Node-port = ';
      618    14651    2              DEST$=PINCRC(DEST$,SIZEC('      Node-port = ')); /*Incr. PTR.*/
      619    14652        /* ****          Insert node only if present     */
      620    14653    2              IF VLP_LINEATTR.NODE#~=' '
      621    14654    2                 THEN
      622    14655    3                    DO;
      623    14656    3                       CALL CPE$RZEROS(VLP_LINEATTR.NODE#,SIZEC(VLP_LINEATTR.
      624    14657    3                            NODE#),LEN);
      625    14658    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(VLP_LINEATTR.
      626    14659    3                            NODE#),LEN) ALTRET(TERM70);
      627    14660    3                    END;
      628    14661    2              INBUFF='-';
      629    14662    2              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1)       ALTRET(TERM70);
      630    14663        /* ****          Insert port if present          */
      631    14664    2              IF VLP_LINEATTR.PORT#~=' '
      632    14665    2                 THEN
      633    14666    3                    DO;
      634    14667    3                       CALL CPE$RZEROS(VLP_LINEATTR.PORT#,SIZEC(VLP_LINEATTR.
      635    14668    3                            PORT#),LEN);
      636    14669    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(VLP_LINEATTR.
      637    14670    3                            PORT#),LEN) ALTRET(TERM70);
      638    14671    3                    END;
      639    14672    2              IF VLP_LINEATTR.CONTROLLER#~=' '
      640    14673    2                 THEN
      641    14674    3                    DO;
      642    14675    3                       CALL CPE$RZEROS(VLP_LINEATTR.CONTROLLER#,SIZEC(VLP_LINEATTR.
      643    14676    3                            CONTROLLER#),LEN);
      644    14677    3                       INBUFF='-';
      645    14678    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1)       ALTRET(TERM70);
      646    14679    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(VLP_LINEATTR.
      647    14680    3                            CONTROLLER#),LEN) ALTRET(TERM70);
      648    14681    3                    END;
      649    14682    2              IF VLP_LINEATTR.DEVICE#~=' '
      650    14683    2                 THEN
      651    14684    3                    DO;
      652    14685    3                       CALL CPE$RZEROS(VLP_LINEATTR.DEVICE#,SIZEC(VLP_LINEATTR.
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:21   
      653    14686    3                            DEVICE#),LEN);
      654    14687    3                       INBUFF='-';
      655    14688    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1)       ALTRET(TERM70);
      656    14689    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(VLP_LINEATTR.
      657    14690    3                            DEVICE#),LEN) ALTRET(TERM70);
      658    14691    3                    END;
      659    14692        /* ****          Insert multidevice if on        */
      660    14693    2              IF VLP_LINEATTR.MULTIDEVICE#=%YES#
      661    14694    2                 THEN
      662    14695    3                    DO;
      663    14696    3                       INBUFF='(multidevice)';
      664    14697    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC('(multidevice)'))
      665    14698    3                            ALTRET(TERM70);
      666    14699    3                    END;
      667    14700    2              SEG$2.FPT_WRITE$ -> FPT$WRITE.BUF_.BUF$ = OUTBUFF$;
      668    14701    2              SEG$2.FPT_WRITE$ -> FPT$WRITE.BUF_.BOUND = POFFC (DEST$, OUTBUFF$);
      669    14702    2              CALL CONCAT (INBUFF, '  Line speed = ',
      670    14703    2               LSPEED_TABLE(VLP_LINEATTR.LINESPEED#));
      671    14704    2              CALL INDEX (LEN, '   ', INBUFF);
      672    14705    2              CALL CPB$BLDIMAGE (OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET (TERM70);
      673    14706    2              CALL CONCAT (INBUFF, '  Parity = ', LPARITY_TYPE (VLP_TRMATTR.PARITY#));
      674    14707    2              CALL INDEX (LEN, '   ', INBUFF);
      675    14708    2              CALL CPB$BLDIMAGE (OUTBUFF$, DEST$, IN$, LEN, TAB_VAL) ALTRET (TERM70);
      676    14709    2              IF VLP_TRMATTR.DVCFLWCTRALG# ~= 0
      677    14710    3               THEN DO;
      678    14711    3                CALL CONCAT (INBUFF, '  DvcFlwCtrAlg = ', LDVCFLWCTRALG(VLP_TRMATTR.
             14711                         DVCFLWCTRALG#));
      679    14712    3                CALL INDEX (LEN, '   ', INBUFF);
      680    14713    3                CALL CPB$BLDIMAGE (OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET (TERM70);
      681    14714    3                END;
      682    14715    2              CALL CONCAT (INBUFF, '  Profile name = ',
      683    14716    2               SUBSTR(VLP_LINEATTR.PROTXTC.TXT, 0, VLP_LINEATTR.PROTXTC.CNT));
      684    14717    2              CALL INDEX (LEN, '   ', INBUFF);
      685    14718    2              CALL CPB$BLDIMAGE (OUTBUFF$, DEST$, IN$, LEN, TAB_VAL) ALTRET (TERM70);
      686    14719    2              CALL CONCAT (INBUFF, '  FcnTbl = ', VLP_TRMATTR.FCNTBL#);
      687    14720    2              CALL INDEX (LEN, '   ', INBUFF);
      688    14721    2              CALL CPB$BLDIMAGE (OUTBUFF$, DEST$, IN$, LEN, TAB_VAL) ALTRET (TERM70);
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:22   
      689    14722    2              CALL CONCAT (INBUFF, '  CharSetName = ', VLP_TRMATTR.CHARSETNAME#);
      690    14723    2              CALL INDEX (LEN, '   ', INBUFF);
      691    14724    2              CALL CPB$BLDIMAGE (OUTBUFF$, DEST$, IN$, LEN, TAB_VAL) ALTRET (TERM70);
      692    14725    2              CALL PUT_DECIMAL(BINBIT(VLP_TRMCTL.AUTOTABCLM#, 36), 'AutoTabClm',
             14725                       LENGTHC('AutoTabClm')) ALTRET (TERM70);
      693    14726    2              IF HAVE_WINDOW
      694    14727    2                THEN
      695    14728    2                 CALL PUT_DECIMAL(BINBIT(VLP_WINDOW.ORG_PST.COLUMN,36), 'Column',
             14728                          LENGTHC('Column')) ALTRET (TERM70);
      696    14729    2              CALL PUT_DECIMAL(BINBIT(VLP_TRMATTR.DSPHEIGHT#,36), 'DspHeight', LENGTHC(
             14729                       'DspHeight')) ALTRET (TERM70);
      697    14730    2              IF HAVE_WINDOW
      698    14731    3                THEN DO;
      699    14732    3                 IF VLP_WINDOW.HBRDRCHR# ~= BINASC(0)
      700    14733    4                   THEN DO;
      701    14734    4                    CALL CONCAT (INBUFF, '  HBrdrChr = ''', VLP_WINDOW.HBRDRCHR#, '''')
             14734                             ;
      702    14735    4                    CALL INDEX (LEN, '   ', INBUFF);
      703    14736    4                    CALL CPB$BLDIMAGE (OUTBUFF$, DEST$, IN$, LEN, TAB_VAL) ALTRET (
             14736                             TERM70);
      704    14737    4                    END;
      705    14738    3                 IF VLP_WINDOW.HBRDRSIZ# ~= 0
      706    14739    3                   THEN
      707    14740    3                    CALL PUT_DECIMAL (BINBIT(VLP_WINDOW.HBRDRSIZ#,36), 'HBrdrSiz',
             14740                             LENGTHC('HBrdrSiz')) ALTRET (TERM70);
      708    14741    3                 END;
      709    14742    2              CALL PUT_DECIMAL(BINBIT(VLP_TRMATTR.HEIGHT#, 36), 'Height', LENGTHC(
             14742                       'Height')) ALTRET (TERM70);
      710    14743    2              CALL PUT_DECIMAL(BINBIT(VLP_TRMCTL.HSMARGIN#, 36), 'HSMargin', LENGTHC(
             14743                       'HSMargin')) ALTRET (TERM70);
      711    14744    2              CALL PUT_DECIMAL(BINBIT(VLP_TRMCTL.HSSHIFT#, 36), 'HSShift', LENGTHC(
             14744                       'HSShift')) ALTRET (TERM70);
      712    14745    2              IF HAVE_EDTCTL
      713    14746    3                THEN DO;
      714    14747    3                 CALL PUT_DECIMAL(BINBIT(VLP_EDTCTL.KEYINCR#, 36), 'KeyIncr', LENGTHC(
             14747                          'KeyIncr')) ALTRET (TERM70);
      715    14748    3                 INBUFF = '  KeyType = ';
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:23   
      716    14749    3                 CALL CPB$BLDIMAGE (OUTBUFF$, DEST$, IN$, SIZEC('  LeyType = '))
      717    14750    3                   ALTRET (TERM70);
      718    14751    3                 INBUFF = LKEYTYPE(VLP_EDTCTL.KEYTYPE#);
      719    14752    3                 CALL INDEX (LEN, ' ', INBUFF);
      720    14753    3                 CALL CPB$BLDIMAGE (OUTBUFF$, DEST$, IN$, LEN) ALTRET (TERM70);
      721    14754    3                 END;
      722    14755    2              IF HAVE_WINDOW
      723    14756    2                THEN
      724    14757    2                 CALL PUT_DECIMAL(BINBIT(VLP_WINDOW.ORG_PST.LINE,36), 'Line', LENGTHC(
             14757                          'Line')) ALTRET (TERM70);
      725    14758    2              CALL PUT_DECIMAL(BINBIT(VLP_TRMATTR.MAXATRS#, 36), 'MaxAtrs', LENGTHC(
             14758                       'MaxAtrs')) ALTRET (TERM70);
      726    14759    2              IF HAVE_WINDOW
      727    14760    2                THEN
      728    14761    2                 CALL PUT_DECIMAL(BINBIT(VLP_WINDOW.MINLENGTH#,36), 'MinLength',
             14761                          LENGTHC('MinLength')) ALTRET (TERM70);
      729    14762    2              CALL PUT_DECIMAL(BINBIT(VLP_TRMATTR.MINREC#, 36), 'MinRec', LENGTHC(
             14762                       'MinRec')) ALTRET (TERM70);
      730    14763    2              IF HAVE_WINDOW
      731    14764    2                THEN
      732    14765    2                 CALL PUT_DECIMAL(BINBIT(VLP_WINDOW.MINWIDTH#,36), 'MinWidth', LENGTHC(
             14765                          'MinWidth')) ALTRET (TERM70);
      733    14766        /*         CALL PUT_DECIMAL(BINBIT(VLP_TRMATTR.RMARGIN#, 36), 'RMargin', LENGTHC('RM
             14766        argin')) ALTRET (TERM70); */
      734    14767    2              IF VLP_TRMCTL.SINPUTSZ# ~= SINPUTDFLT
      735    14768    2                THEN
      736    14769    2                 CALL PUT_DECIMAL (BINBIT(VLP_TRMCTL.SINPUTSZ#, 36), 'SInputSz',
             14769                          LENGTHC('SInputSz')) ALTRET (TERM70);
      737    14770    2              IF HAVE_WINDOW
      738    14771    3                THEN DO;
      739    14772    3                 IF VLP_WINDOW.VBRDRCHR# ~= BINASC(0)
      740    14773    4                   THEN DO;
      741    14774    4                    CALL CONCAT (INBUFF, '  VBrdrChr = ''', VLP_WINDOW.VBRDRCHR#, '''')
             14774                             ;
      742    14775    4                    CALL INDEX (LEN, '   ', INBUFF);
      743    14776    4                    CALL CPB$BLDIMAGE (OUTBUFF$, DEST$, IN$, LEN, TAB_VAL) ALTRET (
             14776                             TERM70);
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:24   
      744    14777    4                    END;
      745    14778    3                 IF VLP_WINDOW.VBRDRSIZ# ~= 0
      746    14779    3                   THEN
      747    14780    3                    CALL PUT_DECIMAL (BINBIT(VLP_WINDOW.VBRDRSIZ#,36), 'VBrdrSiz',
             14780                             LENGTHC('VBrdrSiz')) ALTRET (TERM70);
      748    14781    3                 END;
      749    14782    2              IF HAVE_EDTCTL
      750    14783    3                THEN DO;
      751    14784    3                 CALL PUT_DECIMAL(BINBIT(VLP_EDTCTL.VSMARGIN#, 36), 'VSMargin', LENGTHC
             14784                          ('VSMargin')) ALTRET (TERM70);
      752    14785    3                 CALL PUT_DECIMAL(BINBIT(VLP_EDTCTL.VSSHIFT#, 36), 'VSShift', LENGTHC(
             14785                          'VSShift')) ALTRET (TERM70);
      753    14786    3                 END;
      754    14787    2              TEMP_STOR = VLP_TRMATTR.WIDTH# ;
      755    14788    2              IF VLP_TRMATTR.EXTWID#
      756    14789    2               THEN
      757    14790    2                 TEMP_STOR = TEMP_STOR + 254 ;
      758    14791    2              CALL PUT_DECIMAL(TEMP_STOR, 'Width', LENGTHC('Width')) ALTRET (TERM70);
      759    14792    2              IF HAVE_WINDOW
      760    14793    2                THEN
      761    14794    2                 CALL PUT_DECIMAL(BINBIT(VLP_WINDOW.LENGTH#,36), 'WLength', LENGTHC(
             14794                          'WLength')) ALTRET (TERM70);
      762    14795    2              CALL PUT_DECIMAL(BINBIT(VLP_TRMCTL.WORDWRAPCLM#, 36), 'WordWrapClm',
             14795                       LENGTHC('WordWrapClm')) ALTRET (TERM70);
      763    14796    2              IF HAVE_WINDOW
      764    14797    2                THEN
      765    14798    2                 CALL PUT_DECIMAL(BINBIT(VLP_WINDOW.WIDTH#,36), 'WWidth', LENGTHC(
             14798                          'WWidth')) ALTRET (TERM70);
      766    14799    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$);
      767    14800    2              CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(TERM70);
      768    14801        /*
      769    14802          ****           Output terminal control info.
      770    14803        */
      771    14804    2              DEST$=OUTBUFF$;
      772    14805    2              FLAG_FOUND = %NO#;
      773    14806    2              INBUFF='      On: ';
      774    14807    2              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC('      On: ')) ALTRET (TERM70)
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:25   
             14807                       ;
      775    14808    2              TAB_VAL = 7;
      776    14809    2              CALL PUT_FLAG(VLP_TRMCTL.ACTONTRN#, 'ActOnTrn', LENGTHC('ActOnTrn'))
             14809                       ALTRET (TERM70);
      777    14810    2              CALL PUT_FLAG(VLP_TRMCTL.ADJTOPLFT#, 'AdjTopLft', LENGTHC('AdjTopLft'))
             14810                       ALTRET (TERM70);
      778    14811    2              CALL PUT_FLAG(VLP_TRMATTR.APL#, 'APL', LENGTHC('APL')) ALTRET (TERM70);
      779    14812    2              CALL PUT_FLAG(VLP_TRMCTL.APLLCNRM#, 'APLLCNrm', LENGTHC('APLLCNrm'))
             14812                       ALTRET (TERM70);
      780    14813    2              CALL PUT_FLAG(VLP_TRMATTR.ATRSCRNPOS#, 'AtrScrnPos', LENGTHC('AtrScrnPos'
             14813                       )) ALTRET (TERM70);
      781    14814    2              CALL PUT_FLAG(VLP_TRMCTL.AUTOCURSOR#, 'AutoCursor', LENGTHC('AutoCursor')
             14814                       ) ALTRET (TERM70);
      782    14815    2              CALL PUT_FLAG(VLP_TRMATTR.AUTONL#, 'AutoNL', LENGTHC('AutoNL')) ALTRET (
             14815                       TERM70);
      783    14816    2              CALL PUT_FLAG(VLP_TRMATTR.BIN#, 'Bin', LENGTHC('Bin')) ALTRET (TERM70);
      784    14817    2              CALL PUT_FLAG(VLP_TRMATTR.BLANKERASES#, 'BlankErases', LENGTHC(
             14817                       'BlankErases')) ALTRET (TERM70);
      785    14818    2              IF HAVE_WINDOW
      786    14819    2                THEN
      787    14820    2                 CALL PUT_FLAG (VLP_WINDOW.BTMBRDR#, 'BtmBrdr', LENGTHC('BtmBrdr'))
             14820                          ALTRET (TERM70);
      788    14821    2              CALL PUT_FLAG(VLP_TRMATTR.CRISNL#, 'CRisNL', LENGTHC('CRisNL')) ALTRET (
             14821                       TERM70);
      789    14822    2              CALL PUT_FLAG(VLP_TRMCTL.CURSORREAD#, 'CursorRead', LENGTHC('CursorRead')
             14822                       ) ALTRET (TERM70);
      790    14823    2              CALL PUT_FLAG(VLP_TRMATTR.CURSORUP#, 'CursorUp', LENGTHC('CursorUp'))
             14823                       ALTRET (TERM70);
      791    14824    2              CALL PUT_FLAG(VLP_TRMATTR.DCHMOVFLD#, 'DchMovFld', LENGTHC('DchMovFld'))
             14824                       ALTRET (TERM70);
      792    14825    2              CALL PUT_FLAG(VLP_TRMATTR.DEVICEBS#, 'DeviceBS', LENGTHC('DeviceBS'))
             14825                       ALTRET (TERM70);
      793    14826    2              CALL PUT_FLAG(VLP_TRMATTR.DEVICECR#, 'DeviceCR', LENGTHC('DeviceCR'))
             14826                       ALTRET (TERM70);
      794    14827    2              CALL PUT_FLAG(VLP_TRMATTR.DEVICELF#, 'DeviceLF', LENGTHC('DeviceLF'))
             14827                       ALTRET (TERM70);
      795    14828    2              CALL PUT_FLAG(VLP_TRMATTR.DEVPOSOPTS#, 'DevPosOpts', LENGTHC('DevPosOpts'
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:26   
             14828                       )) ALTRET (TERM70);
      796    14829    2              CALL PUT_FLAG(VLP_TRMATTR.DEVSCROLL#, 'DevScroll', LENGTHC('DevScroll'))
             14829                       ALTRET (TERM70);
      797    14830    2              CALL PUT_FLAG(VLP_TRMCTL.DISPINPUT#, 'DispInput', LENGTHC('DispInput'))
             14830                       ALTRET (TERM70);
      798    14831    2              IF HAVE_EDTCTL
      799    14832    2                THEN
      800    14833    2                 CALL PUT_FLAG(VLP_EDTCTL.EASYAPPEND#, 'EasyAppend', LENGTHC(
             14833                          'EasyAppend')) ALTRET (TERM70);
      801    14834    2              CALL PUT_FLAG(VLP_TRMCTL.EDITOVR#, 'EditOvr', LENGTHC('EditOvr')) ALTRET
             14834                       (TERM70);
      802    14835    2              CALL PUT_FLAG(VLP_TRMCTL.ENBENTEXTSRDCHR#, 'EnbEntExtSRDChr', LENGTHC(
             14835                       'EnbEntExtSRDChr')) ALTRET (TERM70);
      803    14836    2              CALL PUT_FLAG(VLP_TRMATTR.FF_FLUSH#, 'FFFlush', LENGTHC('FFFlush'))
             14836                       ALTRET (TERM70);
      804    14837    2              CALL PUT_FLAG(VLP_TRMATTR.FF_INCCR#, 'FFIncCr', LENGTHC('FFIncCr'))
             14837                       ALTRET (TERM70);
      805    14838    2              CALL PUT_FLAG(VLP_TRMCTL.FULLDUXPAPERTAPE#, 'FullDuxPaperTape', LENGTHC(
             14838                       'FullDuxPaperTape')) ALTRET (TERM70);
      806    14839    2              CALL PUT_FLAG(VLP_TRMCTL.HALFDUXPAPERTAPE#, 'HalfDuxPaperTape', LENGTHC(
             14839                       'HalfDuxPaperTape')) ALTRET (TERM70);
      807    14840    2              IF HAVE_EDTCTL
      808    14841    2                THEN
      809    14842    2                 CALL PUT_FLAG(VLP_EDTCTL.HSALL#, 'HSAll', LENGTHC('HSAll')) ALTRET (
             14842                          TERM70);
      810    14843    2              CALL PUT_FLAG(VLP_TRMCTL.HSCROLL#, 'HScroll', LENGTHC('HScroll')) ALTRET
             14843                       (TERM70);
      811    14844    2              CALL PUT_FLAG(VLP_TRMCTL.INSERTMODE#, 'InsertMode', LENGTHC('InsertMode')
             14844                       ) ALTRET (TERM70);
      812    14845    2              CALL PUT_FLAG(VLP_TRMCTL.KEEPTYPAHD#, 'KeepTypAhd', LENGTHC('KeepTypAhd')
             14845                       ) ALTRET (TERM70);
      813    14846    2              CALL PUT_FLAG(VLP_TRMATTR.LFISNL#, 'LFisNL', LENGTHC('LFisNL')) ALTRET (
             14846                       TERM70);
      814    14847    2              IF HAVE_WINDOW
      815    14848    2                THEN
      816    14849    2                 CALL PUT_FLAG (VLP_WINDOW.LFTBRDR#, 'LftBrdr', LENGTHC('LftBrdr'))
             14849                          ALTRET (TERM70);
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:27   
      817    14850    2              CALL PUT_FLAG(VLP_TRMATTR.LIMBOCLM#, 'LimboClm', LENGTHC('LimboClm'))
             14850                       ALTRET (TERM70);
      818    14851    2              CALL PUT_FLAG(VLP_TRMATTR.LOCALECHO#, 'LocalEcho', LENGTHC('LocalEcho'))
             14851                       ALTRET (TERM70);
      819    14852    2              CALL PUT_FLAG(VLP_TRMCTL.LOWERCASE#, 'LowerCase', LENGTHC('LowerCase'))
             14852                       ALTRET (TERM70);
      820    14853    2              CALL PUT_FLAG(VLP_TRMATTR.LOWERCASEPRINTS#, 'LowerCasePrints', LENGTHC(
             14853                       'LowerCasePrints')) ALTRET (TERM70);
      821    14854    2              CALL PUT_FLAG(VLP_TRMATTR.MICROFPL#, 'MicroFpl', LENGTHC('MicroFpl'))
             14854                       ALTRET (TERM70);
      822    14855    2              CALL PUT_FLAG(VLP_TRMCTL.MSGHALT#, 'MsgHalt', LENGTHC('MsgHalt')) ALTRET
             14855                       (TERM70);
      823    14856    2              CALL PUT_FLAG(VLP_TRMCTL.MSGLINE#, 'MsgLine', LENGTHC('MsgLine')) ALTRET
             14856                       (TERM70);
      824    14857    2              CALL PUT_FLAG(VLP_TRMATTR.NO_FLDTRM#, 'NoFldTrm', LENGTHC('NoFldTrm'))
             14857                       ALTRET (TERM70);
      825    14858    2              CALL PUT_FLAG(VLP_TRMCTL.NOOPTMIZ#, 'NoOptmiz', LENGTHC('NoOptmiz'))
             14858                       ALTRET (TERM70);
      826    14859    2              IF HAVE_EDTCTL
      827    14860    2                THEN
      828    14861    2                 CALL PUT_FLAG(VLP_EDTCTL.ONESPACEEDIT#,'OneSpaceEdit',LENGTHC(
             14861                          'OneSpaceEdit')) ALTRET(TERM70);
      829    14862    2              CALL PUT_FLAG(VLP_TRMATTR.OPDTAB#, 'OpDTab', LENGTHC('OpDTab')) ALTRET (
             14862                       TERM70);
      830    14863    2              IF HAVE_WINDOW
      831    14864    2                THEN
      832    14865    2                 CALL PUT_FLAG(VLP_WINDOW.REMOVABLE#, 'Optional', LENGTHC('Optional'))
             14865                          ALTRET (TERM70);
      833    14866    2              CALL PUT_FLAG(VLP_TRMCTL.OUTPUTDISCARD#, 'OutputDiscard', LENGTHC(
             14866                       'OutputDiscard')) ALTRET (TERM70);
      834    14867    2              CALL PUT_FLAG(VLP_TRMCTL.PAGEHALT#, 'PageHalt', LENGTHC('PageHalt'))
             14867                       ALTRET (TERM70);
      835    14868    2              CALL PUT_FLAG(VLP_TRMCTL.PARITYCHECK#, 'ParityCheck', LENGTHC(
             14868                       'ParityCheck')) ALTRET (TERM70);
      836    14869    2              CALL PUT_FLAG(VLP_TRMCTL.PARKCURSOR#, 'ParkCursor', LENGTHC('ParkCursor')
             14869                       ) ALTRET (TERM70);
      837    14870    2              CALL PUT_FLAG(VLP_TRMCTL.PRINTHALT#, 'PrintHalt', LENGTHC('PrintHalt'))
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:28   
             14870                       ALTRET (TERM70);
      838    14871    2              CALL PUT_FLAG(VLP_TRMATTR.PRINTTYPE#, 'PrintType', LENGTHC('PrintType'))
             14871                       ALTRET (TERM70);
      839    14872    2              CALL PUT_FLAG(VLP_TRMATTR.PROGDTAB#, 'ProgDTab', LENGTHC('ProgDTab'))
             14872                       ALTRET (TERM70);
      840    14873    2              IF HAVE_EDTCTL
      841    14874    2                THEN
      842    14875    2                 CALL PUT_FLAG(VLP_EDTCTL.RCRWRAP#, 'RcrWrap', LENGTHC('RcrWrap'))
             14875                          ALTRET (TERM70);
      843    14876    2              CALL PUT_FLAG(VLP_TRMCTL.RELPAGE#, 'RelPage', LENGTHC('RelPage')) ALTRET
             14876                       (TERM70);
      844    14877    2              CALL PUT_FLAG(VLP_TRMCTL.RETYPOVR#, 'RetypOvr', LENGTHC('RetypOvr'))
             14877                       ALTRET (TERM70);
      845    14878    2              IF HAVE_WINDOW
      846    14879    2                THEN
      847    14880    2                 CALL PUT_FLAG (VLP_WINDOW.RHTBRDR#, 'RhtBrdr', LENGTHC('BtmBrdr'))
             14880                          ALTRET (TERM70);
      848    14881    2              CALL PUT_FLAG(VLP_TRMCTL.SCROLL#, 'Scroll', LENGTHC('Scroll')) ALTRET (
             14881                       TERM70);
      849    14882    2              CALL PUT_FLAG(VLP_TRMCTL.SENDBKSPACE#, 'SendBkSpace', LENGTHC(
             14882                       'SendBkSpace')) ALTRET (TERM70);
      850    14883    2              CALL PUT_FLAG(VLP_TRMCTL.SIMPERF#, 'SimPerf', LENGTHC('SimPerf')) ALTRET
             14883                       (TERM70);
      851    14884    2              CALL PUT_FLAG(VLP_TRMCTL.SPACEINSERT#, 'SpaceInsert', LENGTHC(
             14884                       'SpaceInsert')) ALTRET (TERM70);
      852    14885    2              CALL PUT_FLAG(VLP_TRMATTR.SPCBFRPRT#, 'SpcBfrPrt', LENGTHC('SpcBfrPrt'))
             14885                       ALTRET (TERM70);
      853    14886    2              CALL PUT_FLAG(VLP_TRMCTL.TABRELATIVE#, 'TabRelative', LENGTHC(
             14886                       'TabRelative')) ALTRET (TERM70);
      854    14887    2              CALL PUT_FLAG(VLP_TRMCTL.TABSIM#, 'TabSim', LENGTHC('TabSim')) ALTRET (
             14887                       TERM70);
      855    14888    2              IF HAVE_EDTCTL
      856    14889    2                THEN
      857    14890    2                 CALL PUT_FLAG(VLP_EDTCTL.TEXTEDIT#,'TextEdit',LENGTHC('TextEdit'))
             14890                          ALTRET(TERM70);
      858    14891    2              IF HAVE_WINDOW
      859    14892    2                THEN
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:29   
      860    14893    2                 CALL PUT_FLAG (VLP_WINDOW.TOPBRDR#, 'TopBrdr', LENGTHC('TopBrdr'))
             14893                          ALTRET (TERM70);
      861    14894    2              CALL PUT_FLAG(VLP_TRMCTL.TRUNCATE#, 'Truncate', LENGTHC('Truncate'))
             14894                       ALTRET (TERM70);
      862    14895    2              CALL PUT_FLAG(VLP_TRMATTR.TRUOVRPRT#, 'TruOvrPrt', LENGTHC('TruOvrPrt'))
             14895                       ALTRET (TERM70);
      863    14896    2              CALL PUT_FLAG(VLP_TRMATTR.TTYTYPE#, 'TTyType', LENGTHC('TTyType')) ALTRET
             14896                       (TERM70);
      864    14897    2              CALL PUT_FLAG(VLP_TRMCTL.UPPERCASE#, 'Uppercase', LENGTHC('Uppercase'))
             14897                       ALTRET (TERM70);
      865    14898    2              CALL PUT_FLAG(VLP_TRMCTL.WRAPPAGE#, 'WrapPage', LENGTHC('WrapPage'))
             14898                       ALTRET (TERM70);
      866    14899        /* ****          Print only if any flags are set */
      867    14900    2              LEN=POFFC(DEST$,OUTBUFF$);
      868    14901    2              IF FLAG_FOUND
      869    14902    2                 THEN
      870    14903    2                    SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,
      871    14904    2                         OUTBUFF$)-3;
      872    14905
      873    14906    2                 ELSE
      874    14907    3                    DO;
      875    14908    3                       INBUFF='none';
      876    14909    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,4) ALTRET(TERM70);
      877    14910    3                       SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,
      878    14911    3                            OUTBUFF$);
      879    14912    3                    END;
      880    14913    2              CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(TERM70);
      881    14914    2              IF DCBADDR(M$IBEX1_NUM)->F$DCB.FCD#=%YES#
      882    14915    2               THEN
      883    14916    3                 DO;
      884    14917    3                   SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DCB#=M$IBEX1_NUM;
      885    14918    3                   SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DISP#=%SAVE#;
      886    14919    3                   CALL M$CLOSE(SEG$2.FPT_CLOSE$->FPT$CLOSE) ALTRET(TERM80);
      887    14920    3                 END;
      888    14921    2              IF DCBADDR(M$IBEX1_NUM)->F$DCB.FCD#=%YES#
      889    14922    2               THEN
      890    14923    3                 DO;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:30   
      891    14924    3                   SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DCB#=M$IBEX1_NUM;
      892    14925    3                   SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DISP#=%SAVE#;
      893    14926    3                   CALL M$CLOSE(SEG$2.FPT_CLOSE$->FPT$CLOSE) ALTRET(TERM80);
      894    14927    3                 END;
      895    14928    2              RETURN;
      896    14929    2           END;
      897    14930    1   TERM50: ;
      898    14931    1     B$JIT.USRERR = B$TCB.ALT$ -> B$EXCFR.ERR;
      899    14932    1   TERM70: ;
      900    14933    1     IF DCBADDR(M$IBEX1_NUM)->F$DCB.FCD#=%YES#
      901    14934    1        THEN
      902    14935    2           DO;
      903    14936    2              SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DCB#=M$IBEX1_NUM;
      904    14937    2              SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DISP#=%SAVE#;
      905    14938    2              CALL M$CLOSE(SEG$2.FPT_CLOSE$->FPT$CLOSE) ALTRET(TERM80);
      906    14939    2           END;
      907    14940    1   TERM80: ;
      908    14941    1     ALTRETURN;
      909    14942                   %EJECT;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:31   
      910    14943        /**********************************************************************/
      911    14944        /*F*   NAME:   CPF$PRIV
      912    14945               PURPOSE: The PRIV command is utilized to set,reset or display
      913    14946                       user privileges.
      914    14947               DESCRIPTION: Privileges which may be set are those which were
      915    14948                       previously established by the system manager via Super.
      916    14949               REFERENCE: Programmers Reference Manual
      917    14950        */
      918    14951        /*D*   NAME:   CPF$PRIV
      919    14952               CALL:   CALL CPF$PRIV(P$PCB)
      920    14953               INTERFACE: CPE$LISTOUT,CPB$BLDIMAGE
      921    14954               INPUT:  parse control block
      922    14955                       B$JIT.PRIV.AUTH
      923    14956               OUTPUT: B$JIT.PRIV.JOB - set,reset or displayed
      924    14957               DESCRIPTION: If no sub-blocks are found, privileges found in the
      925    14958                       JIT are displayed. Otherwise, any or all authorized
      926    14959                       privileges specified in B$JIT.PRIV.AUTH are
      927    14960                       set or reset in B$JIT.PRIV.JOB.
      928    14961        */
      929    14962        /**********************************************************************/
      930    14963    1   CPF$PRIV: ENTRY(P$PCB) ALTRET;
      931    14964        /**/
      932    14965    1     BLK$=P$PCB.OUT$;
      933    14966        /*
      934    14967          ****     No options following verb infers ... Display privileges
      935    14968        */
      936    14969    1     IF (BLK$->P$B.NSUBLKS=0)
      937    14970    1        THEN
      938    14971    2   PRIV5:  DO;
      939    14972        /*
      940    14973          ****     Output header
      941    14974        */
      942    14975    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_=VECTOR(PRIVHDR);
      943    14976    2              CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(PRIV45);
      944    14977        /*
      945    14978          ****     Perform init. Functions
      946    14979        */
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:32   
      947    14980    2              OUTBUFF$=ADDR(OUTBUFF);         /*Ptr to BUFF.BEGNG*/
      948    14981    2              DEST$=OUTBUFF$;                 /*Dynamic ptr*/
      949    14982    2              IN$=ADDR(INBUFF);
      950    14983    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;
      951    14984    2              TAB_VAL=6;                         /*Set tab value*/
      952    14985        /*
      953    14986          ****     Output privileges which are on
      954    14987        */
      955    14988    2              INBUFF='On: ';
      956    14989    2              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC('On: ')
      957    14990    2                   ,TAB_VAL) ALTRET(PRIV45);
      958    14991        /**/
      959    14992    3              DO I=0 TO SIZEC(PRIV_TBL)/SIZEC(PRIV_TBL(0))-1;
      960    14993    3                 IF B$JIT.PRIV.JOB & PRIV_TBL.MASK(I)
      961    14994    3                    THEN
      962    14995    4                       DO;
      963    14996    4                          INBUFF = PRIV_TBL.HDR(I);
      964    14997    4                          LEN = PRIV_TBL.LEN(I);
      965    14998    4                          CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL)
      966    14999    4                               ALTRET(PRIV45);
      967    15000    4                          INBUFF = ',';
      968    15001    4                          CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL) ALTRET(PRIV45
             15001                                   );
      969    15002    4                       END;
      970    15003    3              END;
      971    15004        /**/
      972    15005    2              CALL INDEX (I, 'On: ', OUTBUFF) ALTRET(OUTPUT_LAST_LINE);
      973    15006    2              IF POFFC(DEST$,OUTBUFF$) = SIZEC('On: ')+TAB_VAL
      974    15007    2                 THEN
      975    15008    3                    DO;
      976    15009    3                       INBUFF='none,';
      977    15010    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC('none,')
      978    15011    3                            ,TAB_VAL) ALTRET(PRIV45);
      979    15012    3                    END;
      980    15013    2   OUTPUT_LAST_LINE:
      981    15014    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,
      982    15015    2                   OUTBUFF$)-2;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:33   
      983    15016    2              CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(PRIV45);
      984    15017    2              RETURN;
      985    15018    2           END PRIV5;
      986    15019        /*
      987    15020          ****     Set,reset privilege flags
      988    15021          ****     Only those flags authorized in B$JIT.PRIV.AUTH may be
      989    15022          ****     Messed with.
      990    15023        */
      991    15024    1     PRIV_ERR=%NO#;
      992    15025    1     I=0;
      993    15026    1     USER_PRIV.V_=VECTOR(USER_PRIV.V);
      994    15027    1     USER_PRIV.V.AUTH#=%YES#;
      995    15028    1     USER_PRIV.V.PPRIV#=%NO#;
      996    15029    1   PRIV10:
      997    15030    2     DO WHILE (I < BLK$->P$B.NSUBLKS);
      998    15031    2        SET_PRIVS = %NO# ;
      999    15032    2        RESET_PRIVS = %NO# ;
     1000    15033    2        TEMP$=BLK$->P$B.SUBLK$(I);
     1001    15034    2        IF TEMP$->P$B.CODE=IBEX_ALL THEN
     1002    15035    3           DO CASE(TEMP$->P$B.SUBLK$(0)->P$B.CODE);
     1003    15036    3             CASE(IBEX_NO);
     1004    15037    3               RESET_PRIVS=B$JIT.PRIV.AUTH;
     1005    15038    3             CASE(IBEX_YES);
     1006    15039    3               SET_PRIVS=B$JIT.PRIV.AUTH;
     1007    15040    3             END;
     1008    15041    2        ELSE
     1009    15042    2   PRIV20:
     1010    15043    3        DO J=0 TO %NUM_PRIVS-1;
     1011    15044    4           IF PRIV_TBL.CODE(J)=TEMP$->P$B.CODE THEN DO;
     1012    15045    5              DO CASE(TEMP$->P$B.SUBLK$(0)->P$B.CODE);
     1013    15046    5                CASE(IBEX_NO);
     1014    15047    5                  RESET_PRIVS=RESET_PRIVS | PRIV_TBL.MASK(J);
     1015    15048    5                CASE(IBEX_YES);
     1016    15049    5                  SET_PRIVS=SET_PRIVS | PRIV_TBL.MASK(J);
     1017    15050    5                END;
     1018    15051    4              EXIT PRIV20;
     1019    15052    4              END;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:34   
     1020    15053    3           END PRIV20;
     1021    15054        /*
     1022    15055            **** Set the active priv based on the new job priv
     1023    15056        */
     1024    15057    2     IF SET_PRIVS ~= %NO#
     1025    15058    2         THEN
     1026    15059    3             DO ;
     1027    15060    3               USER_PRIV.V.PRIV#=SET_PRIVS;
     1028    15061    4               CALL M$SPRIV(USER_PRIV) WHENALTRETURN DO;
     1029    15062    4                                         PRIV_ERR=%YES#;
     1030    15063    4                                         SET_PRIVS=SET_PRIVS & B$JIT.PRIV.ACTIVE;
     1031    15064    4                                       END;
     1032    15065    3               B$JIT.PRIV.JOB = B$JIT.PRIV.JOB | SET_PRIVS;
     1033    15066    3               B$JIT.PRIV.SAVED = B$JIT.PRIV.SAVED | SET_PRIVS;
     1034    15067    3             END ; /* Then Do */
     1035    15068    2     IF RESET_PRIVS ~= %NO#
     1036    15069    2         THEN
     1037    15070    3             DO ;
     1038    15071    3               USER_PRIV.V.PRIV#=RESET_PRIVS;
     1039    15072    3               CALL M$RPRIV(USER_PRIV);
     1040    15073    4               IF (RESET_PRIVS&B$JIT.PRIV.AUTH) ~= RESET_PRIVS THEN DO;
     1041    15074    4                 PRIV_ERR=%YES#;
     1042    15075    4                 RESET_PRIVS=RESET_PRIVS & B$JIT.PRIV.AUTH;
     1043    15076    4                 END;
     1044    15077    3               RESET_PRIVS=~RESET_PRIVS;
     1045    15078    3               B$JIT.PRIV.JOB = B$JIT.PRIV.JOB & RESET_PRIVS;
     1046    15079    3               B$JIT.PRIV.SAVED = B$JIT.PRIV.SAVED & RESET_PRIVS;
     1047    15080    3             END ; /* Then Do */
     1048    15081    2        I=I+1;
     1049    15082    2        END PRIV10;
     1050    15083        /*
     1051    15084          ****     See if any unauthorized privileges were requested to be set
     1052    15085          ****     Or reset.
     1053    15086        */
     1054    15087    1     IF PRIV_ERR=%NO#
     1055    15088    1        THEN
     1056    15089    1           RETURN;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:35   
     1057    15090        /*E*       ERROR:   CPF-E$NOPRIVLGE-E
     1058    15091                   MESSAGE: Cannot effect entire privilege change requested
     1059    15092                   DESCRIPTION: User attempted to turn on or off, an unathorized
     1060    15093                            privilege flag in the JIT.
     1061    15094        */
     1062    15095    1     B$JIT.USRERR = E_NOPRIVLGE;
     1063    15096    1   PRIV45: ;
     1064    15097    1     ALTRETURN;
     1065    15098                   %EJECT;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:36   
     1066    15099        /**********************************************************************/
     1067    15100        /*F*   NAME:   CPF$PPRIV
     1068    15101             PURPOSE: The DISPLAY PPRIV command is utilized to display processor privileges.
     1069    15102               DESCRIPTION: The processor privileges in the JIT are displayed.
     1070    15103               REFERENCE: Programmers Reference Manual
     1071    15104        */
     1072    15105        /*D*   NAME:   CPF$PPRIV
     1073    15106               CALL:   CALL CPF$PPRIV(P$PCB)
     1074    15107               INTERFACE: CPE$LISTOUT,CPB$BLDIMAGE
     1075    15108               INPUT:  B$JIT.PPRIV
     1076    15109               OUTPUT: privileges displayed
     1077    15110               DESCRIPTION: Processor privileges found in the JIT are displayed.
     1078    15111        */
     1079    15112        /**********************************************************************/
     1080    15113    1   CPF$PPRIV: ENTRY ALTRET;
     1081    15114        /*
     1082    15115          ****  Output header
     1083    15116        */
     1084    15117    1     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_=VECTOR(PPRIV_HDR);
     1085    15118    1     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(PPRIV45);
     1086    15119        /*
     1087    15120          ****  Perform init. Functions
     1088    15121        */
     1089    15122    1     OUTBUFF$=ADDR(OUTBUFF);         /*Ptr to BUFF.BEGNG*/
     1090    15123    1     DEST$=OUTBUFF$;                 /*Dynamic ptr*/
     1091    15124    1     IN$=ADDR(INBUFF);
     1092    15125    1     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;
     1093    15126    1     TAB_VAL=6;                         /*Set tab value*/
     1094    15127        /*
     1095    15128          ****  Output privileges which are on
     1096    15129        */
     1097    15130    1     INBUFF='On: ';
     1098    15131    1     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC('On: ')
     1099    15132    1          ,TAB_VAL) ALTRET(PPRIV45);
     1100    15133    2     DO I=0 TO SIZEC(PPRIV_TBL)/SIZEC(PPRIV_TBL(0))-1;
     1101    15134    2        IF B$JIT.PPRIV & PPRIV_TBL.MASK(I)
     1102    15135    2           THEN
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:37   
     1103    15136    3              DO;
     1104    15137    3                 INBUFF = PPRIV_TBL.HDR(I);
     1105    15138    3                 LEN = PPRIV_TBL.LEN(I);
     1106    15139    3                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL)
     1107    15140    3                      ALTRET(PPRIV45);
     1108    15141    3                 INBUFF = ',';
     1109    15142    3                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL) ALTRET(PPRIV45);
     1110    15143    3              END;
     1111    15144    2     END;
     1112    15145    1     IF POFFC(DEST$,OUTBUFF$) = SIZEC('On: ')+TAB_VAL
     1113    15146    1        THEN
     1114    15147    2           DO;
     1115    15148    2              INBUFF='none,';
     1116    15149    2              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC('none,')
     1117    15150    2                   ,TAB_VAL) ALTRET(PPRIV45);
     1118    15151    2           END;
     1119    15152    1     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,
     1120    15153    1          OUTBUFF$)-2;
     1121    15154    1     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(PPRIV45);
     1122    15155    1     RETURN;
     1123    15156    1   PPRIV45:;
     1124    15157    1     ALTRETURN;
     1125    15158                   %EJECT;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:38   
     1126    15159        /*******************************************************************/
     1127    15160        /*F*   NAME: CPF$PROMPT
     1128    15161               PURPOSE: To set up one of the prompts IBEX displays
     1129    15162               DESCRIPTION: Re-setup the correct prompt
     1130    15163               REFERENCE: Programmers Reference Manual
     1131    15164        */
     1132    15165        /*D*   NAME: CPF$PROMPT
     1133    15166               CALL: CPF$PROMPT(P$PCB)
     1134    15167               INTERFACE: none
     1135    15168               INPUT: none
     1136    15169               OUTPUT: correct SEG$2 prompt is modified
     1137    15170               DESCRIPTION: Re-setup the correct prompt
     1138    15171        */
     1139    15172        /********************************************************************/
     1140    15173    1   CPF$PROMPT:  ENTRY (P$PCB) ALTRET;
     1141    15174        /**/
     1142    15175    1     BLK$ = P$PCB.OUT$;
     1143    15176    1     PROMPT$ = SEG$2.SPROMPT$;
     1144    15177        /**/
     1145    15178    1     PROMPT.VFC_ = BINASC(0);
     1146    15179    1     PROMPT.TYPE_ = PRMT_N;
     1147    15180    1     PROMPT.PPROCESS_ = '0'B;
     1148    15181    1     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DCB# = M$IBEX1_NUM;
     1149    15182    1     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DISP# = %SAVE#;
     1150    15183        /**/
     1151    15184    2     DO I=0 TO BLK$->P$B.NSUBLKS-1;
     1152    15185    3       DO CASE (BLK$->P$B.SUBLK$(I)->P$B.CODE);
     1153    15186    3         CASE (PRMT_TXT); PROMPT.TEXT_ = BLK$->P$B.SUBLK$(I)->P$B.SUBLK$(0)->P$S.TEXT;
     1154    15187    3                          PROMPT.LEN_ = BLK$->P$B.SUBLK$(I)->P$B.SUBLK$(0)->P$S.COUNT;
     1155    15188    3         CASE (PRMT_VFC); PROMPT.VFC_ = BLK$->P$B.SUBLK$(I)->P$B.SUBLK$(0)->P$S.TEXT;
     1156    15189    3         CASE (PRMT_N); PROMPT.TYPE_ = PRMT_N;
     1157    15190    3         CASE (PRMT_I); PROMPT.TYPE_ = PRMT_I;
     1158    15191    3         CASE (PRMT_C); PROMPT.TYPE_ = PRMT_C;
     1159    15192    3         CASE (PRMT_R); PROMPT.TYPE_ = PRMT_R;
     1160    15193    3       END;
     1161    15194    2     END;
     1162    15195    1     CALL INDEX (I,'%',PROMPT.TEXT_)
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:39   
     1163    15196    2       WHENRETURN DO;
     1164    15197    2         PROMPT.PPROCESS_ = '1'B;
     1165    15198    2       END;
     1166    15199    1     IF PROMPT.VFC_ = BINASC(0)
     1167    15200    1       THEN
     1168    15201    1         PROMPT.VFC_ = PROMPT_VFCS (PROMPT.TYPE_);
     1169    15202    1     CALL CPC$OPEN_S (M$IBEX1_NUM) ALTRET (PROMPT10);
     1170    15203    1     CALL CPJ$WRITE_S (M$IBEX1_NUM, PROMPT_KEYS (PROMPT.TYPE_),
     1171    15204    1                       VECTOR (WRT_PROMPT)) ALTRET(PROMPT20);
     1172    15205    1     B$JIT.PROMPTS = B$JIT.PROMPTS | PROMPT_MASK (PROMPT.TYPE_);
     1173    15206    2     CALL M$CLOSE (SEG$2.FPT_CLOSE$->FPT$CLOSE) WHENALTRETURN DO; END;
     1174    15207    1     RETURN;
     1175    15208    1   PROMPT20:
     1176    15209    2     CALL M$CLOSE (SEG$2.FPT_CLOSE$->FPT$CLOSE) WHENALTRETURN DO; END;
     1177    15210    1   PROMPT10:
     1178    15211    1     CALL CPC$WRITEMSGE (B$JIT.USRERR, M$IBEX1_NUM);
     1179    15212    1     B$JIT.USRERR = '0'B;
     1180    15213    1     RETURN;
     1181    15214        %EJECT;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:40   
     1182    15215        /**********************************************************************/
     1183    15216        /*I*       NAME: CLOSE_REL
     1184    15217                   PURPOSE: To close M$IBEX1 dcb and release data segment 3
     1185    15218                   CALL: CALL CLOSE_REL
     1186    15219                   INPUT:  none
     1187    15220                   OUTPUT: none
     1188    15221                   DESCRIPTION: The M$IBEX1 dcb is closed and data segment released.
     1189    15222        */
     1190    15223        /**********************************************************************/
     1191    15224    1   CLOSE_REL: PROC ALTRET;
     1192    15225    2     CALL CPC$RELSEG (SEG3$);
     1193    15226    2     IF DCBADDR(M$IBEX1_NUM)->F$DCB.FCD#=%YES#
     1194    15227    2        THEN
     1195    15228    3           DO;
     1196    15229    3              SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DCB#=M$IBEX1_NUM;
     1197    15230    3              SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DISP#=%SAVE#;
     1198    15231    3              CALL M$CLOSE(SEG$2.FPT_CLOSE$->FPT$CLOSE) ALTRET(CLOSE_REL50);
     1199    15232    3           END;
     1200    15233    2     RETURN;
     1201    15234    2   CLOSE_REL50:;
     1202    15235    2     ALTRETURN;
     1203    15236    2   END CLOSE_REL;
     1204    15237        %EJECT;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:41   
     1205    15238    1   PUT_FLAG: PROC (FLAG, TEXT, LENGTH) ALTRET;
     1206    15239
     1207    15240    2   DCL FLAG BIT (2) UNAL;
     1208    15241    2   DCL TEXT CHAR (LENGTH);
     1209    15242    2   DCL LENGTH UBIN WORD;
     1210    15243
     1211    15244    2      IF FLAG = %YES#
     1212    15245    3        THEN DO;
     1213    15246
     1214    15247    3         FLAG_FOUND = %YES#;
     1215    15248    3         LEN = LENGTH + 2;
     1216    15249    3         CALL CONCAT (INBUFF, TEXT, ', ');
     1217    15250    3         CALL CPB$BLDIMAGE (OUTBUFF$, DEST$, IN$, LEN, TAB_VAL)
     1218    15251    3          ALTRET (OOPS);
     1219    15252
     1220    15253    3         END;
     1221    15254
     1222    15255    2      RETURN;
     1223    15256
     1224    15257    2   OOPS: ALTRETURN;
     1225    15258
     1226    15259    2   END PUT_FLAG;
     1227    15260
     1228    15261        %EJECT;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:42   
     1229    15262    1   PUT_DECIMAL: PROC (DECIMAL, TEXT, LENGTH) ALTRET;
     1230    15263
     1231    15264    2   DCL DECIMAL UBIN WORD;
     1232    15265    2   DCL TEXT CHAR (LENGTH);
     1233    15266    2   DCL LENGTH UBIN WORD;
     1234    15267
     1235    15268    2   DCL TSTRING CHAR (32);
     1236    15269    2   DCL TLEN UBIN WORD;
     1237    15270
     1238    15271    2      IF DECIMAL ~= 0
     1239    15272    3        THEN DO;
     1240    15273
     1241    15274    3         CALL BINCHAR (TBUFF, DECIMAL);
     1242    15275    3         CALL CPE$RZEROS (TBUFF, SIZEC(TBUFF), LEN);
     1243    15276    3         CALL CONCAT (TSTRING, '  ', TEXT, ' = ', SUBSTR (TBUFF, 0, LEN));
     1244    15277    3         TLEN = LEN + LENGTH + 5;
     1245    15278    3         CALL CPB$BLDIMAGE (OUTBUFF$,DEST$,ADDR(TSTRING),TLEN,TAB_VAL) ALTRET (OOPS);
     1246    15279
     1247    15280    3         END;
     1248    15281
     1249    15282    2      RETURN;
     1250    15283
     1251    15284    2   OOPS: ALTRETURN;
     1252    15285
     1253    15286    2   END PUT_DECIMAL;
     1254    15287
     1255    15288    1   END CPF$IBEX3;
     1256    15289        %EOD ;

PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:43   
--  Include file information  --

   NK_VFC_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_SUBS_C.:E05TOU  is referenced.
   CP_PERR_C.:E05TOU  is referenced.
   CP_MACROS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure CPF$IBEX3.

   Procedure CPF$IBEX3 requires 3139 words for executable code.
   Procedure CPF$IBEX3 requires 566 words of local(AUTO) storage.

PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:44   

 Object Unit name= CPF$IBEX3                                  File name= CPF$IBEX3.:E05TOU
 UTS= JUL 29 '97 11:40:29.12 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    537   1031  CPF$IBEX3
    2   Proc  even  none  3139   6103  CPF$IBEX3
    3  RoData even  none   302    456  CPF$IBEX3

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        1  CPF$IBEX3
     2      3          yes     yes      Std        1  CPF$SWITCH
     2    523          yes     yes      Std        1  CPF$PROFILE
     2    712          yes     yes      Std        1  CPF$DIPROFILES
     2   1362          yes     yes      Std        1  CPF$TERMINAL
     2   4537          yes     yes      Std        1  CPF$PRIV
     2   5172          yes     yes      Std        0  CPF$PPRIV
     2   5415          yes     yes      Std        1  CPF$PROMPT
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:45   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 CPE$RZEROS
 yes     yes           Std       2 CPB$WILDCMPR
 yes     yes           Std       5 CPB$BLDIMAGE
         yes           Std       1 CPC$RELSEG
 yes     yes           Std       1 CPC$WRHLP
 yes     yes           Std       3 CPJ$WRITE_S
 yes     yes           Std       1 CPE$LISTOUT
 yes     yes           Std       2 CPC$GETSEG
 yes     yes           Std       2 CPC$RDHLP
 yes     yes           Std       1 CPC$OPEN_S
         yes           Std       6 CPC$WRITEMSGE
 yes     yes           Std       2 CPF$FIND_UCNN
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
                       nStd      0 X66_INDEX

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  CFPT_OPEN                             CFPT_CLOSE
     CFPT_READ                             CFPT_WRITE                            COLONSYS
     CFPT_TRMCTL                           CFPT_TRMATTR                          CFPT_GLINEATTR
     CFPT_PROFILE                     r    SEG2$                            r    SEG3$
r    B$JIT$                           r    B$TCB$                                M$UC_NUM
     M$IBEX1_NUM                           PROMPT_KEYS                           PROMPT_MASK
     PROMPT_VFCS                           B_VECTNIL
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:46   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ROSID                                 ISSID
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:47   


        1        1        /*M* SWITCH, PROFILE, TERMINAL, PRIV, PPRIV, PROMPT cmds */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DFC   */
        8        8        /*P*   NAME:   CPF$IBEX3
        9        9               PURPOSE: To perform all the required operations in  the execution
       10       10                       of selected IBEX commands.
       11       11               DESCRIPTION:
       12       12               REFERENCE: Programmers Reference Manual
       13       13        */
       14       14        /**********************************************************************/
       15       15        CPF$IBEX3:
       16       16          PROC(P$PCB) ALTRET;

     16  2 000000   000000 700200 xent  CPF$IBEX3    TSX0  ! X66_AUTO_1
         2 000001   001066 000001                    ZERO    566,1
         2 000002   000005 710000 2                  TRA     s:14219

       17       17                   %INCLUDE B$JIT;
       18      307                   %INCLUDE B_ERRORS_C;
       19     1434                   %INCLUDE B_MACROS_C;
       20     1545                   %INCLUDE CP_6;
       21     1626                   %INCLUDE CP_6_SUBS;
       22     2166                   %INCLUDE CP_MACROS_C;
       23     2918                   %INCLUDE CP_PERR_C;
       24     3256                   %INCLUDE CP_SUBS_C;
       25     4173                   %INCLUDE XU_MACRO_C;
       26     7279                   %INCLUDE CP_DATA_R;
       27     9842                   %INCLUDE KL_SUPER_C;
       28    12744                   %INCLUDE NK_VFC_C;
       29    12818    1   DCL BLK$ PTR;                                    /*Parse output block ptr*/
       30    12819    1   DCL I SBIN;                                      /*Temp. Loc. For indexes*/
       31    12820    1   DCL J SBIN;                                      /*Temp. Loc for indexes*/
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:48   
       32    12821    1   DCL PROMPT$ PTR;
       33    12822        %CP_PROMPT (NAME=PROMPT, STCLASS="BASED(PROMPT$)");
       34    12842        %CP_PROMPT (NAME=WRT_PROMPT, LEN=WRT_PROMPT.LEN_, STCLASS="BASED(PROMPT$)");
       35    12862    1   DCL TEMP$ PTR;                                   /*Temp. Pointer*/
       36    12863    1   DCL OUTBUFF CHAR (1024);
       37    12864    1   DCL OUTBUFF$ PTR;                                /*Output buffer ptr*/
       38    12865    1   DCL DEST$ PTR;                                   /*Dynamic buffer ptr*/
       39    12866    1   DCL IN$ PTR;                                     /*Buffer ptr*/
       40    12867    1   DCL TBUFF CHAR(4);                               /*Temp. Buffer*/
       41    12868    1   DCL EXIST_FLG BIT(1) UNAL;                       /*Existence flag*/
       42    12869    1   DCL HAVE_EDTCTL BIT (1);
       43    12870    1   DCL HAVE_WINDOW BIT (1);
       44    12871    1   DCL FLAG_FOUND BIT (1);
       45    12872    1   DCL INBUFF CHAR(120);                            /*Input buffer*/
       46    12873    1   DCL LEN SBIN;                                    /*String length*/
       47    12874    1   DCL TAB_VAL SBIN;                                /*Tab value*/
       48    12875    1   DCL TEMP_STOR SBIN;                              /*Temp. Storage*/
       49    12876    1   DCL PROFC SBIN;                                  /*profile count*/
       50    12877    1   DCL MATCH_STR$ PTR;                              /*ptr to ? textc*/
       51    12878        %TEXTC (NAME=MATCH_STR, STCLASS="BASED(MATCH_STR$)");
       52    12883    1   DCL DCB# UBIN WORD ;
       53    12884    1   DCL STRM CHAR(2) ;
       54    12885    1   DCL LSPEED_TABLE(0:15) CHAR(5) CONSTANT INIT
       55    12886    1                  ('50','75','110','134','150','200','300','600','1050',
       56    12887    1                  '1200','1800','2000','2400','4800','9600','19200');
       57    12888    1   DCL 1 PPRIV_TBL(0:19) CONSTANT ALIGNED,  /*Processor privilege tables*/
       58    12889    1          2 LEN UBIN BYTE UNAL INIT
       59    12890    1            (6,6,3,2,6,5,6,4,4,5,6,7,7,5,9,6,9,8,6,7),
       60    12891    1          2 HDR CHAR(9) UNAL INIT
       61    12892    1            ('CntrlC','CntrlD','Eft','EL','NetCon','Label',
       62    12893    1            'PAdmin','PigC','PigD','Rates','Replay',
       63    12894    1            'SpiderC','SpiderD','Super','SuperAuth','SuperD','SuperForm',
       64    12895    1            'SuperWSN','SysCon','Volinit'),
       65    12896    1          2 MASK BIT(36) UNAL INIT
       66    12897    1            (%PPR_CNTRLC#,%PPR_CNTRLD#,%PPR_EFT#,%PPR_EL#,%PPR_NETCON#,
       67    12898    1            %PPR_LABEL#,%PPR_PADMIN#,%PPR_PIGC#,%PPR_PIGD#,
       68    12899    1            %PPR_RATES#,%PPR_REPLAY#,%PPR_SPIDERC#,%PPR_SPIDERD#,%PPR_SUPER#,
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:49   
       69    12900    1            %PPR_SUPERAUTH#,%PPR_SUPERD#,%PPR_SUPERFORM#,%PPR_SUPERWSN#,
       70    12901    1            %PPR_SYSCON#,%PPR_VOLINIT#);
       71    12902        %EQU NUM_PRIVS = 22;
       72    12903    1   DCL 1 PRIV_TBL(0:%(NUM_PRIVS-1)) CONSTANT ALIGNED,  /*User privilege tables*/
       73    12904    1          2 LEN UBIN BYTE UNAL INIT
       74    12905    1            (5,4,7,4,4,5,6,5,6,5,3,3,4,3,6,4,4,2,6,6,6,3),
       75    12906    1          2 HDR CHAR(7) UNAL INIT
       76    12907    1            ('ASave','CFEP','DispJob','ExMM','ExPM','FMBlk',
       77    12908    1            'FMDiag','FMEFT','FMRead','FMSec',
       78    12909    1            'GPP','IOQ','IOQW','JIT','MaxMem',
       79    12910    1            'MFEP','MSys','PM','SpclMM','SysCon','SysLog','TND'),
       80    12911    1          2 MASK BIT(36) UNAL INIT
       81    12912    1            (%PR_ASAVE#,%PR_CFEP#,%PR_DISPJOB#,
       82    12913    1           %PR_EXMM#,%PR_EXPM#,%PR_FMBLK#,%PR_FMDIAG#,%PR_FMEFT#,
       83    12914    1            %PR_FMREAD#,
       84    12915    1           %PR_FMSEC#,%PR_GPP#,%PR_IOQ#,%PR_IOQW#,%PR_JIT#,%PR_MAXMEM#,
       85    12916    1           %PR_MFEP#,%PR_MSYS#,%PR_PM#,%PR_SPCLMM#,%PR_SYSCON#,
       86    12917    1           %PR_SYSLOG#,%PR_TND#),
       87    12918               /* Add CODE for setting JIT active, job, and saved privs in
       88    12919                  the PRIV command. 999999 codes mean it's impossible to get
       89    12920                  this priv via IBEX. I.e., we'll never see it in this case.*/
       90    12921    1          2 CODE UBIN WORD UNAL INIT
       91    12922    1            (ASAVEOPT,CFEPOPT,DISPJOBOPT,EXMMOPT,EXPMOPT,999999,
       92    12923    1            FMDIAGOPT,999999,FMREADOPT,FMSECOPT,
       93    12924    1            GPPOPT,IOQOPT,IOQWOPT,JITOPT,MAXMEMOPT,
       94    12925    1            MFEPOPT,MSYSOPT,PMOPT,SPCLMMOPT,SYSCONOPT,SYSLOGOPT,TNDOPT);
       95    12926    1   DCL B$OCTAL(0:11) CHAR(1) BASED UNAL;            /*Octal based structure*/
       96    12927    1   DCL SW_OCTAL(0:11) UBIN(3) UNAL;                 /*Octal switch values*/
       97    12928    1   DCL SW_BINARY(0:35) REDEF SW_OCTAL BIT(1) UNAL;  /*Binary switches*/
       98    12929    1   DCL THDR CONSTANT CHAR(23) INIT('   Terminal attributes:');
       99    12930    1   DCL PRIVHDR CONSTANT CHAR(23) INIT('   Privileges:');
      100    12931    1   DCL PRO_HDR CONSTANT CHAR(12) INIT('   Profiles:');
      101    12932    1   DCL PRO_CUR CONSTANT CHAR(15) INIT('      current: ');
      102    12933    1   DCL PRO_AVAIL CONSTANT CHAR(18) INIT('      available:  ');
      103    12934    1   DCL PPRIV_HDR CONSTANT CHAR(24) INIT('   Processor privileges:');
      104    12935    1   DCL LPARITY_TYPE (0:7) CHAR(4) CONSTANT INIT ('none', 'odd', 'even',
      105    12936    1      'one', 'zero', '?'*0);
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:50   
      106    12937    1   DCL LDVCFLWCTRALG (0:7) CHAR (6) CONSTANT INIT ('none', 'EnqAck', 'EtxAck',
      107    12938    1      'DC1DC3', '?'*0);
      108    12939    1   DCL LKEYTYPE (0:7) CHAR (6) CONSTANT INIT ('?'*4, 'Bin10', 'BinHlf',
      109    12940    1      'Bin521', 'String');
      110    12941    1   DCL SET_PRIVS BIT(36);
      111    12942    1   DCL RESET_PRIVS BIT(36);
      112    12943    1   DCL PRIV_ERR BIT(1) UNAL;                        /*Priv. Err flag*/
      113    12944    1   DCL DI_FULL BIT(1) ALIGNED AUTO;
      114    12945             /***** External procedure (entry) declarations *****/
      115    12946    1   DCL CPE$RZEROS ENTRY(3);                         /*Remove leading zeros*/
      116    12947    1   DCL CPB$BLDIMAGE ENTRY(5) ALTRET;                /*Build print image*/
      117    12948    1   DCL CPE$LISTOUT ENTRY(1) ALTRET;                 /*List buffer contents*/
      118    12949    1   DCL CPC$GETSEG ENTRY(2) ALTRET;                  /*Get spec'd segment*/
      119    12950    1   DCL CPC$RELSEG ENTRY(1);
      120    12951    1   DCL CPC$RDHLP ENTRY(2) ALTRET;
      121    12952    1   DCL CPC$WRHLP ENTRY(1) ALTRET;
      122    12953    1   DCL CPC$OPEN_S ENTRY(1) ALTRET ;
      123    12954    1   DCL CPJ$WRITE_S ENTRY(3) ALTRET ;
      124    12955    1   DCL CPC$WRITEMSGE ENTRY(6);
      125    12956    1   DCL CPF$FIND_UCNN ENTRY(2) ALTRET ;
      126    12957    1   DCL CPB$WILDCMPR ENTRY(2) ALTRET ;
      127    12958             /***** Fpts *****/
      128    12959        %FPT_OPEN(FPTN=FPT_OPEN,STCLASS=AUTO);
      129    13068        %FPT_CLOSE(FPTN=FPT$CLOSE,STCLASS=BASED);
      130    13110        %FPT_CLOSE(FPTN=FPT_CLOSE,STCLASS=AUTO);
      131    13152        %FPT_READ(FPTN=FPT_READ,STCLASS=AUTO);
      132    13191        %F$DCB(DCBN=F$DCB);
      133    13248        %FPT_WRITE(FPTN=FPT$WRITE,STCLASS=BASED);
      134    13279        %FPT_PROFILE(FPTN=FPT_PROFILE,STCLASS=AUTO);
      135    13300        %FPT_GLINEATTR(FPTN=FPT_GLINEATTR,STCLASS=AUTO);
      136    13325        %FPT_TRMCTL(FPTN=FPT_TRMCTL,STCLASS=AUTO);
      137    13352        %FPT_TRMATTR(FPTN=FPT_TRMATTR,STCLASS=AUTO);
      138    13377        %FPT_PRIV(FPTN=USER_PRIV,STCLASS=AUTO);
      139    13392        %VLP_NAME(FPTN=K_PRO,NAME=':PRO',LEN=4,STCLASS=CONSTANT);
      140    13419        %VLP_NAME(FPTN=PRO_NAME,LEN=31,STCLASS=AUTO);
      141    13446        %VLP_TRMCTL(FPTN=VLP_TRMCTL,STCLASS=AUTO);
      142    13486        %VLP_EDTCTL(FPTN=VLP_EDTCTL,STCLASS=AUTO);
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:51   
      143    13514        %VLP_WINDOW(FPTN=VLP_WINDOW,STCLASS=AUTO);
      144    13558        %VLP_LINEATTR(FPTN=VLP_LINEATTR,STCLASS=AUTO);
      145    13580        %VLP_TRMATTR(FPTN=VLP_TRMATTR,STCLASS=AUTO);
      146    13618             /***** Error codes *****/
      147    13619        %ERR_CODE (NAME=E_NOPRIVLGE,MID#=CPF$IBEXMID,CODE#=E$NOPRIVLGE,STCLASS=CONSTANT);
      148    13639        %ERR_CODE (NAME=E_NOSUCHSTRM,MID#=CPF$IBEXMID,CODE#=E$NOSUCHSTRM,STCLASS=CONSTANT);
      149    13659             /***** Based structures *****/
      150    13660        %B$EXCFR;
      151    13678        %B$TCB (STCLASS="BASED(B$TCB$)");
      152    13681        %PARSE$OUT (NAME=P$B);
      153    13726        %P$PCB(NAME=P$PCB,STCLASS="");
      154    13927        %PARSE$SYM(NAME=P$S);
      155    13965        %SEG$2(NAME=SEG$2);
      156    14025        %TEXTC(NAME=TEXT$C);
      157    14030        %KL_DREC(NAME=KL$DREC,STCLASS=BASED,LAST=",");
      158    14143        %KL_FEBLK(NAME=KL$FEBLK,RCNT=31,LVL=2) ;
      159    14192                   %EJECT;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:52   
      160    14193        /**********************************************************************/
      161    14194        /*F*   NAME:   CPF$SWITCH
      162    14195               PURPOSE: The SWITCH command is utilized to set specified sense switches
      163    14196                       or to display same.
      164    14197               DESCRIPTION: A user is permitted to set any of thirty six switches
      165    14198                       individually or all switches by specifying 'ALL'. With
      166    14199                       no arguments, the current setting of the user's pseudo
      167    14200                       sense switches are displayed.
      168    14201               REFERENCE: Programmers Reference Manual
      169    14202        */
      170    14203        /*D*   NAME:   CPF$SWITCH
      171    14204               CALL:   CALL CPE$SWITCH
      172    14205               INTERFACE: CPE$RZEROS,CPB$BLDIMAGE,CPE$LISTOUT
      173    14206               INPUT:  BLK$ - pointer to parsed output
      174    14207               OUTPUT: sense switches settings to the listing device
      175    14208                       B$JIT.SWITCH - pseudo sense switches set
      176    14209               DESCRIPTION: If no sub-blocks are found, the sense switch settings
      177    14210                       are displayed. If the sub-block for 'ALL' is found, all
      178    14211                       sense switches are set. Otherwise, individual sense switches
      179    14212                       are set as specified by the various sub-blocks.
      180    14213        */
      181    14214        /**********************************************************************/
      182    14215    1   CPF$SWITCH:
      183    14216    1     ENTRY(P$PCB)   ALTRET;

  14216  2 000003   000000 700200 xent  CPF$SWITCH   TSX0  ! X66_AUTO_1
         2 000004   001066 000001                    ZERO    566,1

      184    14217        /**/
      185    14218        /**/
      186    14219    1     BLK$ = P$PCB.OUT$;

  14219  2 000005   200003 470500                    LDP0    @P$PCB,,AUTO
         2 000006   000003 236100                    LDQ     3,,PR0
         2 000007   200004 756100                    STQ     BLK$,,AUTO

      187    14220        /*
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:53   
      188    14221          ****     No options after switch indicates switches are to be displayed
      189    14222        */
      190    14223    1     IF (BLK$->P$B.NSUBLKS=0)

  14223  2 000010   200004 471500                    LDP1    BLK$,,AUTO
         2 000011   100001 220100                    LDX0    1,,PR1
         2 000012   000214 601000 2                  TNZ     s:14264

      191    14224    1        THEN
      192    14225    2           DO;

      193    14226    2              OUTBUFF$=ADDR(OUTBUFF);

  14226  2 000013   200011 633500                    EPPR3   OUTBUFF,,AUTO
         2 000014   200411 453500                    STP3    OUTBUFF$,,AUTO

      194    14227    2              DEST$=OUTBUFF$;                 /*Dynamic ptr*/

  14227  2 000015   200411 236100                    LDQ     OUTBUFF$,,AUTO
         2 000016   200412 756100                    STQ     DEST$,,AUTO

      195    14228        /* ****          Insert 'SWITCHES SET:' into output image*/
      196    14229    2              OUTBUFF='   Switches set: ';

  14229  2 000017   040100 100400                    MLR     fill='040'O
         2 000020   000376 000021 1                  ADSC9   E_NOSUCHSTRM+1           cn=0,n=17
         2 000021   200011 002000                    ADSC9   OUTBUFF,,AUTO            cn=0,n=1024

      197    14230    2              DEST$=PINCRC(DEST$,SIZEC('   Switches set: ')); /*Incr. To nxt LOC.*/

  14230  2 000022   000000 036000 3                  ADLQ    0
         2 000023   200412 756100                    STQ     DEST$,,AUTO

      198    14231    2              TAB_VAL=6;

  14231  2 000024   000006 235007                    LDA     6,DL
         2 000025   200460 755100                    STA     TAB_VAL,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:54   

      199    14232        /* ****          Insert switch values into output image*/
      200    14233    2              EXIST_FLG=%NO#;                   /*Init. Switch flag*/

  14233  2 000026   200415 450100                    STZ     EXIST_FLG,,AUTO

      201    14234    3              DO I=0 TO 35;

  14234  2 000027   200005 450100                    STZ     I,,AUTO

      202    14235    3                 IF B$JIT.SWITCH(I)=%YES#

  14235  2 000030   200005 235100                    LDA     I,,AUTO
         2 000031   000033 605000 2                  TPL     s:14235+3
         2 000032   000044 035003                    ADLA    36,DU
         2 000033   000000 470400 xsym               LDP0    B$JIT$
         2 000034   000000 066505                    CMPB    filb='0'B
         2 000035   000031 000001                    BDSC    25,A,PR0                 by=0,bit=0,n=1
         2 000036   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 000037   000121 600000 2                  TZE     s:14245

      203    14236    3                    THEN
      204    14237    4                       DO;

      205    14238    4                          CALL BINCHAR(TBUFF,I);

  14238  2 000040   000100 301500                    BTD
         2 000041   200005 000004                    NDSC9   I,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
         2 000042   200414 030004                    NDSC9   TBUFF,,AUTO              cn=0,s=nosgn,sf=0,n=4

      206    14239    4                          CALL CPE$RZEROS(TBUFF,SIZEC(TBUFF),LEN);

  14239  2 000043   200457 631500                    EPPR1   LEN,,AUTO
         2 000044   201012 451500                    STP1    TLEN+4,,AUTO
         2 000045   000001 236000 3                  LDQ     1
         2 000046   201011 756100                    STQ     TLEN+3,,AUTO
         2 000047   200414 633500                    EPPR3   TBUFF,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:55   
         2 000050   201010 453500                    STP3    TLEN+2,,AUTO
         2 000051   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 000052   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000053   000000 701000 xent               TSX1    CPE$RZEROS
         2 000054   000000 011000                    NOP     0

      207    14240    4                          CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TBUFF),LEN,TAB_VAL)
             14240                                   ALTRET(SWITCH50);

  14240  2 000055   200414 630500                    EPPR0   TBUFF,,AUTO
         2 000056   201010 450500                    STP0    TLEN+2,,AUTO
         2 000057   200460 631500                    EPPR1   TAB_VAL,,AUTO
         2 000060   201015 451500                    STP1    TLEN+7,,AUTO
         2 000061   200457 633500                    EPPR3   LEN,,AUTO
         2 000062   201014 453500                    STP3    TLEN+6,,AUTO
         2 000063   201010 634500                    EPPR4   TLEN+2,,AUTO
         2 000064   201013 454500                    STP4    TLEN+5,,AUTO
         2 000065   200412 635500                    EPPR5   DEST$,,AUTO
         2 000066   201012 455500                    STP5    TLEN+4,,AUTO
         2 000067   200411 636500                    EPPR6   OUTBUFF$,,AUTO
         2 000070   201011 456500                    STP6    TLEN+3,,AUTO
         2 000071   201011 630500                    EPPR0   TLEN+3,,AUTO
         2 000072   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000073   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 000074   000522 702000 2                  TSX2    SWITCH50

      208    14241    4                          TBUFF=',';

  14241  2 000075   000002 236000 3                  LDQ     2
         2 000076   200414 756100                    STQ     TBUFF,,AUTO

      209    14242    4                          CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TBUFF),1,TAB_VAL)
             14242                                   ALTRET(SWITCH50);

  14242  2 000077   200414 630500                    EPPR0   TBUFF,,AUTO
         2 000100   201010 450500                    STP0    TLEN+2,,AUTO
         2 000101   200460 631500                    EPPR1   TAB_VAL,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:56   
         2 000102   201015 451500                    STP1    TLEN+7,,AUTO
         2 000103   000003 236000 3                  LDQ     3
         2 000104   201014 756100                    STQ     TLEN+6,,AUTO
         2 000105   201010 633500                    EPPR3   TLEN+2,,AUTO
         2 000106   201013 453500                    STP3    TLEN+5,,AUTO
         2 000107   200412 634500                    EPPR4   DEST$,,AUTO
         2 000110   201012 454500                    STP4    TLEN+4,,AUTO
         2 000111   200411 635500                    EPPR5   OUTBUFF$,,AUTO
         2 000112   201011 455500                    STP5    TLEN+3,,AUTO
         2 000113   201011 630500                    EPPR0   TLEN+3,,AUTO
         2 000114   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000115   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 000116   000522 702000 2                  TSX2    SWITCH50

      210    14243    4                          EXIST_FLG=%YES#;

  14243  2 000117   400000 236003                    LDQ     -131072,DU
         2 000120   200415 756100                    STQ     EXIST_FLG,,AUTO

      211    14244    4                       END;

      212    14245    3              END;

  14245  2 000121   200005 054100                    AOS     I,,AUTO
         2 000122   200005 235100                    LDA     I,,AUTO
         2 000123   000043 115007                    CMPA    35,DL
         2 000124   000030 604400 2                  TMOZ    s:14235

      213    14246        /* ****          See if any switches set         */
      214    14247    2              IF (EXIST_FLG=%YES#)

  14247  2 000125   200415 234100                    SZN     EXIST_FLG,,AUTO
         2 000126   000145 605000 2                  TPL     s:14253

      215    14248    2                 THEN   /* Remove comma */
      216    14249    2                    SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$)-2;

PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:57   
  14249  2 000127   000000 470400 xsym               LDP0    SEG2$
         2 000130   000165 471500                    LDP1    117,,PR0
         2 000131   200411 236100                    LDQ     OUTBUFF$,,AUTO
         2 000132   000020 772000                    QRL     16
         2 000133   201010 756100                    STQ     TLEN+2,,AUTO
         2 000134   200412 236100                    LDQ     DEST$,,AUTO
         2 000135   000020 772000                    QRL     16
         2 000136   201010 136100                    SBLQ    TLEN+2,,AUTO
         2 000137   000002 136007                    SBLQ    2,DL
         2 000140   000020 736000                    QLS     16
         2 000141   100004 676100                    ERQ     4,,PR1
         2 000142   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000143   100004 656100                    ERSQ    4,,PR1
         2 000144   000201 710000 2                  TRA     s:14257

      217    14250
      218    14251    2                 ELSE
      219    14252    3                    DO;

      220    14253    3                       TBUFF='none';

  14253  2 000145   000403 236000 1                  LDQ     E_NOSUCHSTRM+6
         2 000146   200414 756100                    STQ     TBUFF,,AUTO

      221    14254    3                      CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TBUFF),4) ALTRET(SWITCH50)
             14254                                ;

  14254  2 000147   200414 630500                    EPPR0   TBUFF,,AUTO
         2 000150   201010 450500                    STP0    TLEN+2,,AUTO
         2 000151   000001 236000 3                  LDQ     1
         2 000152   201015 756100                    STQ     TLEN+7,,AUTO
         2 000153   201010 631500                    EPPR1   TLEN+2,,AUTO
         2 000154   201014 451500                    STP1    TLEN+6,,AUTO
         2 000155   200412 633500                    EPPR3   DEST$,,AUTO
         2 000156   201013 453500                    STP3    TLEN+5,,AUTO
         2 000157   200411 634500                    EPPR4   OUTBUFF$,,AUTO
         2 000160   201012 454500                    STP4    TLEN+4,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:58   
         2 000161   201012 630500                    EPPR0   TLEN+4,,AUTO
         2 000162   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000163   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 000164   000522 702000 2                  TSX2    SWITCH50

      222    14255    3                       SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$);

  14255  2 000165   000000 470400 xsym               LDP0    SEG2$
         2 000166   000165 471500                    LDP1    117,,PR0
         2 000167   200411 236100                    LDQ     OUTBUFF$,,AUTO
         2 000170   000020 772000                    QRL     16
         2 000171   201010 756100                    STQ     TLEN+2,,AUTO
         2 000172   200412 236100                    LDQ     DEST$,,AUTO
         2 000173   000020 772000                    QRL     16
         2 000174   201010 136100                    SBLQ    TLEN+2,,AUTO
         2 000175   000020 736000                    QLS     16
         2 000176   100004 676100                    ERQ     4,,PR1
         2 000177   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000200   100004 656100                    ERSQ    4,,PR1

      223    14256    3                    END;

      224    14257    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;

  14257  2 000201   000165 471500                    LDP1    117,,PR0
         2 000202   200411 236100                    LDQ     OUTBUFF$,,AUTO
         2 000203   100005 756100                    STQ     5,,PR1

      225    14258    2              CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(SWITCH50);

  14258  2 000204   000000 236000 xsym               LDQ     SEG2$
         2 000205   000165 036003                    ADLQ    117,DU
         2 000206   201010 756100                    STQ     TLEN+2,,AUTO
         2 000207   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 000210   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000211   000000 701000 xent               TSX1    CPE$LISTOUT
         2 000212   000522 702000 2                  TSX2    SWITCH50
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:59   

      226    14259    2              RETURN;

  14259  2 000213   000000 702200 xent               TSX2  ! X66_ARET

      227    14260    2           END;
      228    14261        /*
      229    14262          ****     Set or reset specified switches in the jit.
      230    14263        */
      231    14264    2     DO CASE (BLK$->P$B.SUBLK$(0)->P$B.CODE);

  14264  2 000214   100003 473500                    LDP3    3,,PR1
         2 000215   300000 721100                    LXL1    0,,PR3
         2 000216   000005 101003                    CMPX1   5,DU
         2 000217   000221 602011 2                  TNC     s:14264+5,X1
         2 000220   000521 710000 2                  TRA     s:14318
         2 000221   000521 710000 2                  TRA     s:14318
         2 000222   000226 710000 2                  TRA     s:14266
         2 000223   000521 710000 2                  TRA     s:14318
         2 000224   000312 710000 2                  TRA     s:14283
         2 000225   000461 710000 2                  TRA     s:14307

      232    14265    2      CASE(SWLISTOPT);

      233    14266    3        DO I = 0 TO BLK$->P$B.SUBLK$(0)->P$B.NSUBLKS - 1;

  14266  2 000226   200005 450100                    STZ     I,,AUTO
         2 000227   000303 710000 2                  TRA     s:14278+1

      234    14267    3           TEMP$ = BLK$->P$B.SUBLK$(0)->P$B.SUBLK$(I);

  14267  2 000230   200004 470500                    LDP0    BLK$,,AUTO
         2 000231   000003 471500                    LDP1    3,,PR0
         2 000232   200005 720100                    LXL0    I,,AUTO
         2 000233   100003 236110                    LDQ     3,X0,PR1
         2 000234   200010 756100                    STQ     TEMP$,,AUTO

PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:60   
      235    14268    4           DO CASE(TEMP$->P$B.SUBLK$(0)->P$B.CODE);

  14268  2 000235   200010 473500                    LDP3    TEMP$,,AUTO
         2 000236   300003 474500                    LDP4    3,,PR3
         2 000237   400000 721100                    LXL1    0,,PR4
         2 000240   000002 101003                    CMPX1   2,DU
         2 000241   000243 602011 2                  TNC     s:14268+6,X1
         2 000242   000302 710000 2                  TRA     s:14278
         2 000243   000245 710000 2                  TRA     s:14270
         2 000244   000264 710000 2                  TRA     s:14274

      236    14269    4            CASE(IBEX_NO);

      237    14270    4              CALL CHARBIN (J,TEMP$->P$B.SUBLK$(0)->

  14270  2 000245   400003 475500                    LDP5    3,,PR4
         2 000246   500004 236100                    LDQ     4,,PR5
         2 000247   000033 772000                    QRL     27
         2 000250   000000 622006                    EAX2    0,QL
         2 000251   000100 305540                    DTB
         2 000252   500004 230012                    NDSC9   4,,PR5                   cn=1,s=nosgn,sf=0,n=*X2
         2 000253   200006 000004                    NDSC9   J,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      238    14271    4                   P$B.SUBLK$(0)->P$S.TEXT);
      239    14272    4              B$JIT.SWITCH(J) = %NO#;

  14272  2 000254   200006 235100                    LDA     J,,AUTO
         2 000255   000257 605000 2                  TPL     s:14272+3
         2 000256   000044 035003                    ADLA    36,DU
         2 000257   000000 476400 xsym               LDP6    B$JIT$
         2 000260   003105 060400                    CSL     bolr='003'O
         2 000261   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         2 000262   600031 000001                    BDSC    25,A,PR6                 by=0,bit=0,n=1
         2 000263   000302 710000 2                  TRA     s:14278

      240    14273    4            CASE(IBEX_YES);

PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:61   
      241    14274    4              CALL CHARBIN (J,TEMP$->P$B.SUBLK$(0)->

  14274  2 000264   400003 475500                    LDP5    3,,PR4
         2 000265   500004 236100                    LDQ     4,,PR5
         2 000266   000033 772000                    QRL     27
         2 000267   000000 622006                    EAX2    0,QL
         2 000270   000100 305540                    DTB
         2 000271   500004 230012                    NDSC9   4,,PR5                   cn=1,s=nosgn,sf=0,n=*X2
         2 000272   200006 000004                    NDSC9   J,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      242    14275    4                   P$B.SUBLK$(0)->P$S.TEXT);
      243    14276    4              B$JIT.SWITCH(J) = %YES#;

  14276  2 000273   200006 235100                    LDA     J,,AUTO
         2 000274   000276 605000 2                  TPL     s:14276+3
         2 000275   000044 035003                    ADLA    36,DU
         2 000276   000000 476400 xsym               LDP6    B$JIT$
         2 000277   003105 060400                    CSL     bolr='003'O
         2 000300   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         2 000301   600031 000001                    BDSC    25,A,PR6                 by=0,bit=0,n=1

      244    14277    4            END;

      245    14278    3        END;

  14278  2 000302   200005 054100                    AOS     I,,AUTO
         2 000303   200004 470500                    LDP0    BLK$,,AUTO
         2 000304   000003 471500                    LDP1    3,,PR0
         2 000305   100001 236100                    LDQ     1,,PR1
         2 000306   000022 772000                    QRL     18
         2 000307   200005 116100                    CMPQ    I,,AUTO
         2 000310   000230 605400 2                  TPNZ    s:14267
         2 000311   000521 710000 2                  TRA     s:14318

      246    14279    2      CASE(SWOCTOPT);

      247    14280        /*
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:62   
      248    14281             ***** Convert octal values to binary...
      249    14282        */
      250    14283    2        TEMP$ = BLK$ -> P$B.SUBLK$(0);

  14283  2 000312   100003 236100                    LDQ     3,,PR1
         2 000313   200010 756100                    STQ     TEMP$,,AUTO

      251    14284    2        SW_OCTAL='0'O;

  14284  2 000314   200466 450100                    STZ     SW_OCTAL,,AUTO

      252    14285    2        DEST$=ADDR(TEMP$->P$B.SUBLK$(0)->P$B.SUBLK$(0)

  14285  2 000315   200010 474500                    LDP4    TEMP$,,AUTO
         2 000316   400003 475500                    LDP5    3,,PR4
         2 000317   500003 476500                    LDP6    3,,PR5
         2 000320   201010 456500                    STP6    TLEN+2,,AUTO
         2 000321   201010 236100                    LDQ     TLEN+2,,AUTO
         2 000322   000000 036000 3                  ADLQ    0
         2 000323   200412 756100                    STQ     DEST$,,AUTO

      253    14286    2             ->P$S.TEXT);
      254    14287    2        J=11;

  14287  2 000324   000013 235007                    LDA     11,DL
         2 000325   200006 755100                    STA     J,,AUTO

      255    14288    2        LEN=TEMP$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->

  14288  2 000326   400003 473500                    LDP3    3,,PR4
         2 000327   300003 475500                    LDP5    3,,PR3
         2 000330   500004 236100                    LDQ     4,,PR5
         2 000331   000033 772000                    QRL     27
         2 000332   000001 136007                    SBLQ    1,DL
         2 000333   200457 756100                    STQ     LEN,,AUTO

      256    14289    2             P$S.COUNT-1;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:63   
      257    14290    3        DO WHILE (LEN >= 0);

  14290  2 000334   000356 604000 2                  TMI     s:14296

      258    14291    3           CALL CHARBIN(TEMP_STOR,DEST$->B$OCTAL(LEN));

  14291  2 000335   200412 470500                    LDP0    DEST$,,AUTO
         2 000336   200457 235100                    LDA     LEN,,AUTO
         2 000337   000100 305505                    DTB
         2 000340   000000 030001                    NDSC9   0,A,PR0                  cn=0,s=nosgn,sf=0,n=1
         2 000341   200461 000004                    NDSC9   TEMP_STOR,,AUTO          cn=0,s=lsgnf,sf=0,n=4

      259    14292    3           SW_OCTAL(J)=TEMP_STOR;

  14292  2 000342   200006 236100                    LDQ     J,,AUTO
         2 000343   000003 402007                    MPY     3,DL
         2 000344   000000 116003                    CMPQ    0,DU
         2 000345   000347 605000 2                  TPL     s:14292+5
         2 000346   000044 036003                    ADLQ    36,DU
         2 000347   003106 061500                    CSR     bolr='003'O
         2 000350   200461 000044                    BDSC    TEMP_STOR,,AUTO          by=0,bit=0,n=36
         2 000351   200466 000003                    BDSC    SW_OCTAL,Q,AUTO          by=0,bit=0,n=3

      260    14293    3           J=J-1;

  14293  2 000352   000001 336007                    LCQ     1,DL
         2 000353   200006 056100                    ASQ     J,,AUTO

      261    14294    3           LEN=LEN-1;

  14294  2 000354   200457 056100                    ASQ     LEN,,AUTO

      262    14295    3        END;

  14295  2 000355   000335 605000 2                  TPL     s:14291

      263    14296    3        DO CASE(TEMP$->P$B.SUBLK$(0)->P$B.CODE);
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:64   

  14296  2 000356   200010 470500                    LDP0    TEMP$,,AUTO
         2 000357   000003 471500                    LDP1    3,,PR0
         2 000360   100000 720100                    LXL0    0,,PR1
         2 000361   000002 100003                    CMPX0   2,DU
         2 000362   000364 602010 2                  TNC     s:14296+6,X0
         2 000363   000521 710000 2                  TRA     s:14318
         2 000364   000366 710000 2                  TRA     s:14298
         2 000365   000425 710000 2                  TRA     s:14302

      264    14297    3         CASE(IBEX_NO);

      265    14298    4           DO J=0 TO 35;

  14298  2 000366   200006 450100                    STZ     J,,AUTO

      266    14299    4              B$JIT.SWITCH(J) = B$JIT.SWITCH(J) & ~(SW_BINARY(J));

  14299  2 000367   200006 235100                    LDA     J,,AUTO
         2 000370   000372 605000 2                  TPL     s:14299+3
         2 000371   000044 035003                    ADLA    36,DU
         2 000372   003100 060505                    CSL     bolr='003'O
         2 000373   200466 000001                    BDSC    SW_OCTAL,A,AUTO          by=0,bit=0,n=1
         2 000374   201010 000044                    BDSC    TLEN+2,,AUTO             by=0,bit=0,n=36
         2 000375   201010 236100                    LDQ     TLEN+2,,AUTO
         2 000376   400000 676003                    ERQ     -131072,DU
         2 000377   201011 756100                    STQ     TLEN+3,,AUTO
         2 000400   200006 235100                    LDA     J,,AUTO
         2 000401   000403 605000 2                  TPL     s:14299+12
         2 000402   000044 035003                    ADLA    36,DU
         2 000403   000000 470400 xsym               LDP0    B$JIT$
         2 000404   003100 060505                    CSL     bolr='003'O
         2 000405   000031 000001                    BDSC    25,A,PR0                 by=0,bit=0,n=1
         2 000406   201012 000044                    BDSC    TLEN+4,,AUTO             by=0,bit=0,n=36
         2 000407   201012 236100                    LDQ     TLEN+4,,AUTO
         2 000410   201011 376100                    ANQ     TLEN+3,,AUTO
         2 000411   201013 756100                    STQ     TLEN+5,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:65   
         2 000412   200006 235100                    LDA     J,,AUTO
         2 000413   000415 605000 2                  TPL     s:14299+22
         2 000414   000044 035003                    ADLA    36,DU
         2 000415   003105 060500                    CSL     bolr='003'O
         2 000416   201013 000044                    BDSC    TLEN+5,,AUTO             by=0,bit=0,n=36
         2 000417   000031 000001                    BDSC    25,A,PR0                 by=0,bit=0,n=1

      267    14300    4           END;

  14300  2 000420   200006 054100                    AOS     J,,AUTO
         2 000421   200006 235100                    LDA     J,,AUTO
         2 000422   000043 115007                    CMPA    35,DL
         2 000423   000367 604400 2                  TMOZ    s:14299
         2 000424   000521 710000 2                  TRA     s:14318

      268    14301    3         CASE(IBEX_YES);

      269    14302    4           DO J=0 TO 35;

  14302  2 000425   200006 450100                    STZ     J,,AUTO

      270    14303    4              B$JIT.SWITCH(J) = B$JIT.SWITCH(J) | SW_BINARY(J);

  14303  2 000426   200006 235100                    LDA     J,,AUTO
         2 000427   000431 605000 2                  TPL     s:14303+3
         2 000430   000044 035003                    ADLA    36,DU
         2 000431   003100 060505                    CSL     bolr='003'O
         2 000432   200466 000001                    BDSC    SW_OCTAL,A,AUTO          by=0,bit=0,n=1
         2 000433   201010 000044                    BDSC    TLEN+2,,AUTO             by=0,bit=0,n=36
         2 000434   200006 235100                    LDA     J,,AUTO
         2 000435   000437 605000 2                  TPL     s:14303+9
         2 000436   000044 035003                    ADLA    36,DU
         2 000437   000000 470400 xsym               LDP0    B$JIT$
         2 000440   003100 060505                    CSL     bolr='003'O
         2 000441   000031 000001                    BDSC    25,A,PR0                 by=0,bit=0,n=1
         2 000442   201011 000044                    BDSC    TLEN+3,,AUTO             by=0,bit=0,n=36
         2 000443   201011 236100                    LDQ     TLEN+3,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:66   
         2 000444   201010 276100                    ORQ     TLEN+2,,AUTO
         2 000445   201012 756100                    STQ     TLEN+4,,AUTO
         2 000446   200006 235100                    LDA     J,,AUTO
         2 000447   000451 605000 2                  TPL     s:14303+19
         2 000450   000044 035003                    ADLA    36,DU
         2 000451   003105 060500                    CSL     bolr='003'O
         2 000452   201012 000044                    BDSC    TLEN+4,,AUTO             by=0,bit=0,n=36
         2 000453   000031 000001                    BDSC    25,A,PR0                 by=0,bit=0,n=1

      271    14304    4           END;

  14304  2 000454   200006 054100                    AOS     J,,AUTO
         2 000455   200006 235100                    LDA     J,,AUTO
         2 000456   000043 115007                    CMPA    35,DL
         2 000457   000426 604400 2                  TMOZ    s:14303

      272    14305    3         END;

  14305  2 000460   000521 710000 2                  TRA     s:14318

      273    14306    2      CASE(SWALLOPT);

      274    14307    3        DO CASE(BLK$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE);

  14307  2 000461   300003 474500                    LDP4    3,,PR3
         2 000462   400000 722100                    LXL2    0,,PR4
         2 000463   000002 102003                    CMPX2   2,DU
         2 000464   000466 602012 2                  TNC     s:14307+5,X2
         2 000465   000521 710000 2                  TRA     s:14318
         2 000466   000470 710000 2                  TRA     s:14309
         2 000467   000505 710000 2                  TRA     s:14313

      275    14308    3         CASE(IBEX_NO);

      276    14309    4           DO J=0 TO 35;

  14309  2 000470   200006 450100                    STZ     J,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:67   

      277    14310    4              B$JIT.SWITCH(J) = %NO#;

  14310  2 000471   200006 235100                    LDA     J,,AUTO
         2 000472   000474 605000 2                  TPL     s:14310+3
         2 000473   000044 035003                    ADLA    36,DU
         2 000474   000000 470400 xsym               LDP0    B$JIT$
         2 000475   003105 060400                    CSL     bolr='003'O
         2 000476   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         2 000477   000031 000001                    BDSC    25,A,PR0                 by=0,bit=0,n=1

      278    14311    4           END;

  14311  2 000500   200006 054100                    AOS     J,,AUTO
         2 000501   200006 235100                    LDA     J,,AUTO
         2 000502   000043 115007                    CMPA    35,DL
         2 000503   000471 604400 2                  TMOZ    s:14310
         2 000504   000521 710000 2                  TRA     s:14318

      279    14312    3         CASE(IBEX_YES);

      280    14313    4           DO J=0 TO 35;

  14313  2 000505   200006 450100                    STZ     J,,AUTO

      281    14314    4              B$JIT.SWITCH(J) = %YES#;

  14314  2 000506   200006 235100                    LDA     J,,AUTO
         2 000507   000511 605000 2                  TPL     s:14314+3
         2 000510   000044 035003                    ADLA    36,DU
         2 000511   000000 470400 xsym               LDP0    B$JIT$
         2 000512   003105 060400                    CSL     bolr='003'O
         2 000513   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         2 000514   000031 000001                    BDSC    25,A,PR0                 by=0,bit=0,n=1

      282    14315    4           END;

PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:68   
  14315  2 000515   200006 054100                    AOS     J,,AUTO
         2 000516   200006 235100                    LDA     J,,AUTO
         2 000517   000043 115007                    CMPA    35,DL
         2 000520   000506 604400 2                  TMOZ    s:14314

      283    14316    3         END;

      284    14317    2      END; /* do case ... end */

      285    14318    1     RETURN;

  14318  2 000521   000000 702200 xent               TSX2  ! X66_ARET

  14310  2 000522                       SWITCH50     null
      286    14319    1   SWITCH50:;
      287    14320    1     ALTRETURN;

  14320  2 000522   000000 702200 xent               TSX2  ! X66_AALT

      288    14321                   %EJECT;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:69   
      289    14322        /**********************************************************************/
      290    14323        /*F*   NAME:   CPF$PROFILE
      291    14324               PURPOSE: The PROFILE command is utilized to specify a desired
      292    14325                       terminal profile. Also the current profile and available
      293    14326                       profiles can be displayed using this command.
      294    14327               DESCRIPTION: The terminal profile is changed to the one specified
      295    14328                       on the command. The profile specified must be a recognized
      296    14329                       profile previously established by the system mamager. These
      297    14330                       profiles are established by SUPER. The user's default profile
      298    14331                       is modified if PERM is specified.
      299    14332                      If a profile display is requested, the current profile
      300    14333                        and available profiles are utput to the listing device.
      301    14334               REFERENCE: Programmers Reference Manual
      302    14335        */
      303    14336        /*D*   NAME:   CPF$PROFILE
      304    14337               CALL:   CALL CPF$PROFILE(P$PCB)
      305    14338               INTERFACE:
      306    14339               INPUT:  parse control block
      307    14340                       :PRO file in :SYS
      308    14341               OUTPUT: user profile established
      309    14342                        profile information to the listing device
      310    14343               DESCRIPTION: The users profile is established via the M$PROFILE
      311    14344                       pmme. A message is output to the user if a
      312    14345                       unrecognized profile name is specified.
      313    14346                       On a display, the file :PRO in :SYS is read and it's keys
      314    14347                       which are the available profile names are output to
      315    14348                       the user.
      316    14349
      317    14350        */
      318    14351        /**********************************************************************/
      319    14352    1   CPF$PROFILE: ENTRY(P$PCB) ALTRET;

  14352  2 000523   000000 700200 xent  CPF$PROFILE  TSX0  ! X66_AUTO_1
         2 000524   001066 000001                    ZERO    566,1

      320    14353    1     BLK$=P$PCB.OUT$;

PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:70   
  14353  2 000525   200003 470500                    LDP0    @P$PCB,,AUTO
         2 000526   000003 236100                    LDQ     3,,PR0
         2 000527   200004 756100                    STQ     BLK$,,AUTO

      321    14354        /*
      322    14355             ***** If not INTERACTIVE then this command makes no sense...
      323    14356        */
      324    14357    1     IF B$JIT.MODE ~= %M_INT#

  14357  2 000530   000000 471400 xsym               LDP1    B$JIT$
         2 000531   100000 236100                    LDQ     0,,PR1
         2 000532   740000 376003                    ANQ     -16384,DU
         2 000533   140000 116003                    CMPQ    49152,DU
         2 000534   000536 600000 2                  TZE     s:14360

      325    14358    1        THEN   /* Ignore this command */
      326    14359    1           RETURN;

  14359  2 000535   000000 702200 xent               TSX2  ! X66_ARET

      327    14360    1     CALL CPC$GETSEG(SEG3$) ALTRET(PROFILE50);

  14360  2 000536   000004 630400 3                  EPPR0   4
         2 000537   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000540   000000 701000 xent               TSX1    CPC$GETSEG
         2 000541   001352 702000 2                  TSX2    PROFILE50

      328    14361    1     IF (BLK$->P$B.NSUBLKS=0)

  14361  2 000542   200004 470500                    LDP0    BLK$,,AUTO
         2 000543   000001 220100                    LDX0    1,,PR0
         2 000544   000551 601000 2                  TNZ     s:14368

      329    14362    1        THEN
      330    14363    2           DO;   /* Only display part of the information */

      331    14364    2              DI_FULL = %NO#;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:71   

  14364  2 000545   200472 450100                    STZ     DI_FULL,,AUTO

      332    14365    2              MATCH_STR$ = ADDR(NIL);

  14365  2 000546   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000547   200463 756100                    STQ     MATCH_STR$,,AUTO

      333    14366    2              GOTO PROFILE10;

  14366  2 000550   000745 710000 2                  TRA     PROFILE10

      334    14367    2           END;
      335    14368    1     TEMP$ = BLK$->P$B.SUBLK$(0);

  14368  2 000551   000003 236100                    LDQ     3,,PR0
         2 000552   200010 756100                    STQ     TEMP$,,AUTO

      336    14369    1     IF TEMP$ -> P$B.CODE = PROF_NAME

  14369  2 000553   200010 471500                    LDP1    TEMP$,,AUTO
         2 000554   100000 721100                    LXL1    0,,PR1
         2 000555   000001 101003                    CMPX1   1,DU
         2 000556   000620 601000 2                  TNZ     s:14381

      337    14370    1       THEN
      338    14371    2         DO ;

      339    14372    2           FPT_PROFILE = CFPT_PROFILE;

  14372  2 000557   000100 100400                    MLR     fill='000'O
         2 000560   000000 000050 xsym               ADSC9   CFPT_PROFILE             cn=0,n=40
         2 000561   200642 000050                    ADSC9   FPT_PROFILE,,AUTO        cn=0,n=40

      340    14373    2           FPT_PROFILE.V_ = VECTOR(FPT_PROFILE.V);

  14373  2 000562   000005 235000 3                  LDA     5
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:72   
         2 000563   201010 452500                    STP2    TLEN+2,,AUTO
         2 000564   201010 236100                    LDQ     TLEN+2,,AUTO
         2 000565   000652 036003                    ADLQ    426,DU
         2 000566   200642 757100                    STAQ    FPT_PROFILE,,AUTO

      341    14374    2           FPT_PROFILE.PROFILE_ =

  14374  2 000567   100003 473500                    LDP3    3,,PR1
         2 000570   300003 474500                    LDP4    3,,PR3
         2 000571   000100 101500                    MRL     fill='000'O
         2 000572   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         2 000573   201010 000002                    ADSC9   TLEN+2,,AUTO             cn=0,n=2
         2 000574   201010 220100                    LDX0    TLEN+2,,AUTO
         2 000575   000001 621010                    EAX1    1,X0
         2 000576   000000 635011                    EAA     0,X1
         2 000577   000002 771000                    ARL     2
         2 000600   000140 135007                    SBLA    96,DL
         2 000601   201011 454500                    STP4    TLEN+3,,AUTO
         2 000602   201011 236100                    LDQ     TLEN+3,,AUTO
         2 000603   200646 757100                    STAQ    FPT_PROFILE+4,,AUTO

      342    14375    2                VECTOR(TEMP$->P$B.SUBLK$(0)->P$S.TEXTC$->TEXT$C);
      343    14376    2           FPT_PROFILE.BUF_.BOUND = 4095;

  14376  2 000604   200650 236100                    LDQ     FPT_PROFILE+6,,AUTO
         2 000605   177777 376007                    ANQ     65535,DL
         2 000606   000006 276000 3                  ORQ     6
         2 000607   200650 756100                    STQ     FPT_PROFILE+6,,AUTO

      344    14377    2           FPT_PROFILE.BUF_.BUF$ = SEG3$;

  14377  2 000610   000000 236000 xsym               LDQ     SEG3$
         2 000611   200651 756100                    STQ     FPT_PROFILE+7,,AUTO

      345    14378    2           FPT_PROFILE.V.DCB# = M$UC_NUM;

  14378  2 000612   000000 720000 xsym               LXL0    M$UC_NUM
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:73   
         2 000613   200652 740100                    STX0    FPT_PROFILE+8,,AUTO

      346    14379    2           CALL M$PROFILE (FPT_PROFILE) ALTRET(PROFILE50);

  14379  2 000614   200642 630500                    EPPR0   FPT_PROFILE,,AUTO
         2 000615   560014 713400                    CLIMB   alt,+57356
         2 000616   401400 401760                    pmme    nvectors=4
         2 000617   001352 702000 2                  TSX2    PROFILE50

      347    14380    2         END ; /* Then Do */

      348    14381    1     CALL CPC$RELSEG (SEG3$);

  14381  2 000620   000004 630400 3                  EPPR0   4
         2 000621   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000622   000000 701000 xent               TSX1    CPC$RELSEG
         2 000623   000000 011000                    NOP     0

      349    14382        /*
      350    14383          ****  STORE PROFILE IN :HLP IF PERM SPEC'D
      351    14384        */
      352    14385    1     IF TEMP$->P$B.NSUBLKS > 1

  14385  2 000624   200010 470500                    LDP0    TEMP$,,AUTO
         2 000625   000001 220100                    LDX0    1,,PR0
         2 000626   000002 100003                    CMPX0   2,DU
         2 000627   000711 602000 2                  TNC     s:14408

      353    14386    1        THEN
      354    14387    2           DO;

      355    14388    2              CALL CPC$RDHLP(M$IBEX1_NUM,1) ALTRET(PROFILE60);

  14388  2 000630   000007 630400 3                  EPPR0   7
         2 000631   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000632   000000 701000 xent               TSX1    CPC$RDHLP
         2 000633   001361 702000 2                  TSX2    PROFILE60
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:74   

      356    14389    2              IF TEMP$ -> P$B.CODE = PROF_NAME

  14389  2 000634   200010 470500                    LDP0    TEMP$,,AUTO
         2 000635   000000 720100                    LXL0    0,,PR0
         2 000636   000001 100003                    CMPX0   1,DU
         2 000637   000655 601000 2                  TNZ     s:14395

      357    14390    2               THEN
      358    14391    2                 SEG$2.HLP$->KL$DREC.PNAME = TEMP$->P$B.SUBLK$(0)->P$S.TEXTC$->

  14391  2 000640   000000 471400 xsym               LDP1    SEG2$
         2 000641   100153 473500                    LDP3    107,,PR1
         2 000642   000003 474500                    LDP4    3,,PR0
         2 000643   400003 475500                    LDP5    3,,PR4
         2 000644   000100 101500                    MRL     fill='000'O
         2 000645   500000 000001                    ADSC9   0,,PR5                   cn=0,n=1
         2 000646   201010 000002                    ADSC9   TLEN+2,,AUTO             cn=0,n=2
         2 000647   201010 220100                    LDX0    TLEN+2,,AUTO
         2 000650   000001 621010                    EAX1    1,X0
         2 000651   000100 100540                    MLR     fill='000'O
         2 000652   500000 000011                    ADSC9   0,,PR5                   cn=0,n=*X1
         2 000653   300004 000014                    ADSC9   4,,PR3                   cn=0,n=12
         2 000654   000665 710000 2                  TRA     s:14398

      359    14392    2                                               TEXT$C ;
      360    14393    2               ELSE
      361    14394    3                 DO ;

      362    14395    3                   SEG$2.HLP$->KL$DREC.PNAME.CNT = 0 ;

  14395  2 000655   000000 471400 xsym               LDP1    SEG2$
         2 000656   100153 473500                    LDP3    107,,PR1
         2 000657   000000 236003                    LDQ     0,DU
         2 000660   300004 552140                    STBQ    4,'40'O,PR3

      363    14396    3                   SEG$2.HLP$->KL$DREC.PNAME.TXT = ' ' ;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:75   

  14396  2 000661   100153 473500                    LDP3    107,,PR1
         2 000662   040100 100400                    MLR     fill='040'O
         2 000663   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000664   300004 200013                    ADSC9   4,,PR3                   cn=1,n=11

      364    14397    3                 END ; /* Else Do */

      365    14398    2              CALL CPC$WRHLP(M$IBEX1_NUM) ALTRET(PROFILE60);

  14398  2 000665   000007 630400 3                  EPPR0   7
         2 000666   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000667   000000 701000 xent               TSX1    CPC$WRHLP
         2 000670   001361 702000 2                  TSX2    PROFILE60

      366    14399        /*
      367    14400          **** Close and save :HLP
      368    14401        */
      369    14402    2              FPT_CLOSE = CFPT_CLOSE;

  14402  2 000671   000100 100400                    MLR     fill='000'O
         2 000672   000000 000170 xsym               ADSC9   CFPT_CLOSE               cn=0,n=120
         2 000673   200566 000170                    ADSC9   FPT_CLOSE,,AUTO          cn=0,n=120

      370    14403    2              FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V);

  14403  2 000674   000011 235000 3                  LDA     9
         2 000675   201010 452500                    STP2    TLEN+2,,AUTO
         2 000676   201010 236100                    LDQ     TLEN+2,,AUTO
         2 000677   000620 036003                    ADLQ    400,DU
         2 000700   200566 757100                    STAQ    FPT_CLOSE,,AUTO

      371    14404    2              FPT_CLOSE.V.DCB#=M$IBEX1_NUM;

  14404  2 000701   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 000702   200620 740100                    STX0    FPT_CLOSE+26,,AUTO

PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:76   
      372    14405    2              FPT_CLOSE.V.DISP#=%SAVE#;

  14405  2 000703   000002 236007                    LDQ     2,DL
         2 000704   200620 552104                    STBQ    FPT_CLOSE+26,'04'O,AUTO

      373    14406    2              CALL M$CLOSE(FPT_CLOSE) ALTRET(PROFILE50);

  14406  2 000705   200566 630500                    EPPR0   FPT_CLOSE,,AUTO
         2 000706   450001 713400                    CLIMB   alt,close
         2 000707   406000 401760                    pmme    nvectors=13
         2 000710   001352 702000 2                  TSX2    PROFILE50

      374    14407    2           END;

      375    14408    1     RETURN;

  14408  2 000711   000000 702200 xent               TSX2  ! X66_ARET

      376    14409        %EJECT;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:77   
      377    14410        /*F*    NAME:   CPF$DIPROFILES
      378    14411                PURPOSE: To allow different levels of display for PROFILEs
      379    14412        */
      380    14413    1   CPF$DIPROFILES: ENTRY(P$PCB) ALTRET;

  14413  2 000712   000000 700200 xent  CPF$DIPROFI* TSX0  ! X66_AUTO_1
         2 000713   001066 000001                    ZERO    566,1

      381    14414        /*
      382    14415             ***** If not in INTERACTIVE mode then this commands makes no sense ...
      383    14416        */
      384    14417    1     IF B$JIT.MODE ~= %M_INT#

  14417  2 000714   000000 470400 xsym               LDP0    B$JIT$
         2 000715   000000 236100                    LDQ     0,,PR0
         2 000716   740000 376003                    ANQ     -16384,DU
         2 000717   140000 116003                    CMPQ    49152,DU
         2 000720   000722 600000 2                  TZE     s:14420

      385    14418    1        THEN
      386    14419    1           RETURN;

  14419  2 000721   000000 702200 xent               TSX2  ! X66_ARET

      387    14420    1     CALL CPC$GETSEG(SEG3$) ALTRET(PROFILE50);

  14420  2 000722   000004 630400 3                  EPPR0   4
         2 000723   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000724   000000 701000 xent               TSX1    CPC$GETSEG
         2 000725   001352 702000 2                  TSX2    PROFILE50

      388    14421    1     DI_FULL = %YES#;

  14421  2 000726   400000 236003                    LDQ     -131072,DU
         2 000727   200472 756100                    STQ     DI_FULL,,AUTO

      389    14422    1     BLK$=P$PCB.OUT$ -> P$B.SUBLK$(0);
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:78   

  14422  2 000730   200003 470500                    LDP0    @P$PCB,,AUTO
         2 000731   000003 471500                    LDP1    3,,PR0
         2 000732   100003 236100                    LDQ     3,,PR1
         2 000733   200004 756100                    STQ     BLK$,,AUTO

      390    14423    1     IF (BLK$->P$B.NSUBLKS=0)

  14423  2 000734   200004 473500                    LDP3    BLK$,,AUTO
         2 000735   300001 220100                    LDX0    1,,PR3
         2 000736   000742 601000 2                  TNZ     s:14425

      391    14424    1       THEN MATCH_STR$ = ADDR(NIL);

  14424  2 000737   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000740   200463 756100                    STQ     MATCH_STR$,,AUTO
         2 000741   000745 710000 2                  TRA     PROFILE10

      392    14425    1       ELSE MATCH_STR$ = BLK$->P$B.SUBLK$(0)->P$S.TEXTC$;

  14425  2 000742   300003 474500                    LDP4    3,,PR3
         2 000743   400003 236100                    LDQ     3,,PR4
         2 000744   200463 756100                    STQ     MATCH_STR$,,AUTO

  14423  2 000745                       PROFILE10    null
      393    14426        /*
      394    14427          ****  DISPLAY PROFILE INFORMATION
      395    14428        */
      396    14429    1   PROFILE10:;
      397    14430    1     IN$=ADDR(INBUFF);

  14430  2 000745   200421 630500                    EPPR0   INBUFF,,AUTO
         2 000746   200413 450500                    STP0    IN$,,AUTO

      398    14431    1     OUTBUFF$=ADDR(OUTBUFF);

  14431  2 000747   200011 631500                    EPPR1   OUTBUFF,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:79   
         2 000750   200411 451500                    STP1    OUTBUFF$,,AUTO

      399    14432    1     DEST$=OUTBUFF$;

  14432  2 000751   200411 236100                    LDQ     OUTBUFF$,,AUTO
         2 000752   200412 756100                    STQ     DEST$,,AUTO

      400    14433    1     TAB_VAL=6;

  14433  2 000753   000006 235007                    LDA     6,DL
         2 000754   200460 755100                    STA     TAB_VAL,,AUTO

      401    14434    1     OUTBUFF=' ';

  14434  2 000755   040100 100400                    MLR     fill='040'O
         2 000756   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000757   200011 002000                    ADSC9   OUTBUFF,,AUTO            cn=0,n=1024

      402    14435        /*
      403    14436          ****  Output header
      404    14437        */
      405    14438    1     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_=VECTOR(PRO_HDR);

  14438  2 000760   000000 473400 xsym               LDP3    SEG2$
         2 000761   300165 474500                    LDP4    117,,PR3
         2 000762   000012 237000 3                  LDAQ    10
         2 000763   400004 757100                    STAQ    4,,PR4

      406    14439    1     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(PROFILE50);

  14439  2 000764   000000 236000 xsym               LDQ     SEG2$
         2 000765   000165 036003                    ADLQ    117,DU
         2 000766   201010 756100                    STQ     TLEN+2,,AUTO
         2 000767   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 000770   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000771   000000 701000 xent               TSX1    CPE$LISTOUT
         2 000772   001352 702000 2                  TSX2    PROFILE50
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:80   

      407    14440        /*
      408    14441          ****  Output current profile
      409    14442        */
      410    14443    1     FPT_GLINEATTR = CFPT_GLINEATTR;

  14443  2 000773   000100 100400                    MLR     fill='000'O
         2 000774   000000 000040 xsym               ADSC9   CFPT_GLINEATTR           cn=0,n=32
         2 000775   200654 000040                    ADSC9   FPT_GLINEATTR,,AUTO      cn=0,n=32

      411    14444    1     FPT_GLINEATTR.V_ = VECTOR(FPT_GLINEATTR.V);

  14444  2 000776   000005 235000 3                  LDA     5
         2 000777   201010 452500                    STP2    TLEN+2,,AUTO
         2 001000   201010 236100                    LDQ     TLEN+2,,AUTO
         2 001001   000662 036003                    ADLQ    434,DU
         2 001002   200654 757100                    STAQ    FPT_GLINEATTR,,AUTO

      412    14445    1     FPT_GLINEATTR.LINEATTR_ = VECTOR(VLP_LINEATTR);

  14445  2 001003   000014 235000 3                  LDA     12
         2 001004   201010 452500                    STP2    TLEN+2,,AUTO
         2 001005   201010 236100                    LDQ     TLEN+2,,AUTO
         2 001006   000740 036003                    ADLQ    480,DU
         2 001007   200660 757100                    STAQ    FPT_GLINEATTR+4,,AUTO

      413    14446    1     CALL M$GLINEATTR (FPT_GLINEATTR)

  14446  2 001010   200654 630500                    EPPR0   FPT_GLINEATTR,,AUTO
         2 001011   560005 713400                    CLIMB   alt,+57349
         2 001012   401000 401760                    pmme    nvectors=3
         2 001013   001103 702000 2                  TSX2    s:14461

      414    14447    2     WHENRETURN DO;

      415    14448    2        CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(PRO_CUR),SIZEC(PRO_CUR))

PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:81   
  14448  2 001014   000015 236000 3                  LDQ     13
         2 001015   201010 756100                    STQ     TLEN+2,,AUTO
         2 001016   000017 236000 3                  LDQ     15
         2 001017   201015 756100                    STQ     TLEN+7,,AUTO
         2 001020   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 001021   201014 450500                    STP0    TLEN+6,,AUTO
         2 001022   200412 631500                    EPPR1   DEST$,,AUTO
         2 001023   201013 451500                    STP1    TLEN+5,,AUTO
         2 001024   200411 633500                    EPPR3   OUTBUFF$,,AUTO
         2 001025   201012 453500                    STP3    TLEN+4,,AUTO
         2 001026   201012 630500                    EPPR0   TLEN+4,,AUTO
         2 001027   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 001030   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 001031   001352 702000 2                  TSX2    PROFILE50

      416    14449    2             ALTRET(PROFILE50);
      417    14450    2        LEN = VLP_LINEATTR.PROTXTC.CNT;

  14450  2 001032   200742 236100                    LDQ     VLP_LINEATTR+2,,AUTO
         2 001033   000033 772000                    QRL     27
         2 001034   200457 756100                    STQ     LEN,,AUTO

      418    14451    2        CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(VLP_LINEATTR.PROTXTC.TXT)

  14451  2 001035   201011 452500                    STP2    TLEN+3,,AUTO
         2 001036   201011 236100                    LDQ     TLEN+3,,AUTO
         2 001037   000020 036000 3                  ADLQ    16
         2 001040   201010 756100                    STQ     TLEN+2,,AUTO
         2 001041   200457 630500                    EPPR0   LEN,,AUTO
         2 001042   201015 450500                    STP0    TLEN+7,,AUTO
         2 001043   201010 631500                    EPPR1   TLEN+2,,AUTO
         2 001044   201014 451500                    STP1    TLEN+6,,AUTO
         2 001045   200412 633500                    EPPR3   DEST$,,AUTO
         2 001046   201013 453500                    STP3    TLEN+5,,AUTO
         2 001047   200411 634500                    EPPR4   OUTBUFF$,,AUTO
         2 001050   201012 454500                    STP4    TLEN+4,,AUTO
         2 001051   201012 630500                    EPPR0   TLEN+4,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:82   
         2 001052   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 001053   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 001054   001352 702000 2                  TSX2    PROFILE50

      419    14452    2             ,LEN) ALTRET(PROFILE50);
      420    14453    2        SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$);

  14453  2 001055   000000 470400 xsym               LDP0    SEG2$
         2 001056   000165 471500                    LDP1    117,,PR0
         2 001057   200411 236100                    LDQ     OUTBUFF$,,AUTO
         2 001060   000020 772000                    QRL     16
         2 001061   201010 756100                    STQ     TLEN+2,,AUTO
         2 001062   200412 236100                    LDQ     DEST$,,AUTO
         2 001063   000020 772000                    QRL     16
         2 001064   201010 136100                    SBLQ    TLEN+2,,AUTO
         2 001065   000020 736000                    QLS     16
         2 001066   100004 676100                    ERQ     4,,PR1
         2 001067   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 001070   100004 656100                    ERSQ    4,,PR1

      421    14454    2        SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;

  14454  2 001071   000165 471500                    LDP1    117,,PR0
         2 001072   200411 236100                    LDQ     OUTBUFF$,,AUTO
         2 001073   100005 756100                    STQ     5,,PR1

      422    14455    2        CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(PROFILE50);

  14455  2 001074   000000 236000 xsym               LDQ     SEG2$
         2 001075   000165 036003                    ADLQ    117,DU
         2 001076   201010 756100                    STQ     TLEN+2,,AUTO
         2 001077   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 001100   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001101   000000 701000 xent               TSX1    CPE$LISTOUT
         2 001102   001352 702000 2                  TSX2    PROFILE50

      423    14456    2     END;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:83   

      424    14457        /*
      425    14458             ***** If the DI_FULL flag is NO then only display
      426    14459                   the current PROFILE. User doesn't need complete list ...
      427    14460        */
      428    14461    1     IF DI_FULL = %NO#

  14461  2 001103   200472 234100                    SZN     DI_FULL,,AUTO
         2 001104   001110 604000 2                  TMI     s:14470

      429    14462    1        THEN
      430    14463    2           DO;

      431    14464    2              CALL CLOSE_REL ALTRET(PROFILE50);

  14464  2 001105   005660 701000 2                  TSX1    CLOSE_REL
         2 001106   001352 702000 2                  TSX2    PROFILE50

      432    14465    2              RETURN;

  14465  2 001107   000000 702200 xent               TSX2  ! X66_ARET

      433    14466    2           END;
      434    14467        /*
      435    14468          ****   Output available profiles
      436    14469        */
      437    14470    1     DEST$=OUTBUFF$;

  14470  2 001110   200411 236100                    LDQ     OUTBUFF$,,AUTO
         2 001111   200412 756100                    STQ     DEST$,,AUTO

      438    14471    1     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(PRO_AVAIL),SIZEC(PRO_AVAIL))

  14471  2 001112   000021 236000 3                  LDQ     17
         2 001113   201010 756100                    STQ     TLEN+2,,AUTO
         2 001114   000023 236000 3                  LDQ     19
         2 001115   201015 756100                    STQ     TLEN+7,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:84   
         2 001116   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 001117   201014 450500                    STP0    TLEN+6,,AUTO
         2 001120   200412 631500                    EPPR1   DEST$,,AUTO
         2 001121   201013 451500                    STP1    TLEN+5,,AUTO
         2 001122   200411 633500                    EPPR3   OUTBUFF$,,AUTO
         2 001123   201012 453500                    STP3    TLEN+4,,AUTO
         2 001124   201012 630500                    EPPR0   TLEN+4,,AUTO
         2 001125   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 001126   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 001127   001352 702000 2                  TSX2    PROFILE50

      439    14472    1          ALTRET(PROFILE50);
      440    14473    1     FPT_OPEN=CFPT_OPEN;

  14473  2 001130   000100 100400                    MLR     fill='000'O
         2 001131   000000 000350 xsym               ADSC9   CFPT_OPEN                cn=0,n=232
         2 001132   200474 000350                    ADSC9   FPT_OPEN,,AUTO           cn=0,n=232

      441    14474    1     FPT_OPEN.V_=VECTOR(FPT_OPEN.V);

  14474  2 001133   000024 235000 3                  LDA     20
         2 001134   201010 452500                    STP2    TLEN+2,,AUTO
         2 001135   201010 236100                    LDQ     TLEN+2,,AUTO
         2 001136   000540 036003                    ADLQ    352,DU
         2 001137   200474 757100                    STAQ    FPT_OPEN,,AUTO

      442    14475    1     FPT_OPEN.NAME_=VECTOR(K_PRO);

  14475  2 001140   000026 237000 3                  LDAQ    22
         2 001141   200502 757100                    STAQ    FPT_OPEN+6,,AUTO

      443    14476    1     FPT_OPEN.ACCT_=VECTOR(COLONSYS);

  14476  2 001142   000030 237000 3                  LDAQ    24
         2 001143   200520 757100                    STAQ    FPT_OPEN+20,,AUTO

      444    14477    1     FPT_OPEN.V.DCB#=M$IBEX1_NUM;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:85   

  14477  2 001144   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 001145   200540 740100                    STX0    FPT_OPEN+36,,AUTO

      445    14478    1     FPT_OPEN.V.ASN#=%FILE#;

  14478  2 001146   000001 236007                    LDQ     1,DL
         2 001147   200541 552104                    STBQ    FPT_OPEN+37,'04'O,AUTO

      446    14479    1     FPT_OPEN.V.FUN#=%IN#;

  14479  2 001150   002000 236007                    LDQ     1024,DL
         2 001151   200541 552110                    STBQ    FPT_OPEN+37,'10'O,AUTO

      447    14480    1     FPT_OPEN.V.SHARE#=%ALL#;

  14480  2 001152   200540 236100                    LDQ     FPT_OPEN+36,,AUTO
         2 001153   000025 376000 3                  ANQ     21
         2 001154   000010 276007                    ORQ     8,DL
         2 001155   200540 756100                    STQ     FPT_OPEN+36,,AUTO

      448    14481    1     FPT_OPEN.V.ORG#=%KEYED#;

  14481  2 001156   002000 236007                    LDQ     1024,DL
         2 001157   200542 552110                    STBQ    FPT_OPEN+38,'10'O,AUTO

      449    14482    1     FPT_OPEN.V.ACS#=%SEQUEN#;

  14482  2 001160   000001 236007                    LDQ     1,DL
         2 001161   200542 552104                    STBQ    FPT_OPEN+38,'04'O,AUTO

      450    14483    1     CALL M$OPEN(FPT_OPEN) ALTRET(PROFILE40);

  14483  2 001162   200474 630500                    EPPR0   FPT_OPEN,,AUTO
         2 001163   450000 713400                    CLIMB   alt,open
         2 001164   410400 401760                    pmme    nvectors=18
         2 001165   001266 702000 2                  TSX2    PROFILE40
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:86   

      451    14484        /*
      452    14485          ****  Read in :PRO keys
      453    14486        */
      454    14487    1     FPT_READ=CFPT_READ;

  14487  2 001166   000100 100400                    MLR     fill='000'O
         2 001167   000000 000070 xsym               ADSC9   CFPT_READ                cn=0,n=56
         2 001170   200624 000070                    ADSC9   FPT_READ,,AUTO           cn=0,n=56

      455    14488    1     FPT_READ.V_=VECTOR(FPT_READ.V);

  14488  2 001171   000032 235000 3                  LDA     26
         2 001172   201010 452500                    STP2    TLEN+2,,AUTO
         2 001173   201010 236100                    LDQ     TLEN+2,,AUTO
         2 001174   000634 036003                    ADLQ    412,DU
         2 001175   200624 757100                    STAQ    FPT_READ,,AUTO

      456    14489    1     FPT_READ.BUF_.BUF$=SEG3$;

  14489  2 001176   000000 236000 xsym               LDQ     SEG3$
         2 001177   200631 756100                    STQ     FPT_READ+5,,AUTO

      457    14490    1     FPT_READ.BUF_.BOUND=4095;

  14490  2 001200   200630 236100                    LDQ     FPT_READ+4,,AUTO
         2 001201   177777 376007                    ANQ     65535,DL
         2 001202   000006 276000 3                  ORQ     6
         2 001203   200630 756100                    STQ     FPT_READ+4,,AUTO

      458    14491    1     FPT_READ.KEY_=VECTOR(PRO_NAME);

  14491  2 001204   000033 235000 3                  LDA     27
         2 001205   201010 452500                    STP2    TLEN+2,,AUTO
         2 001206   201010 236100                    LDQ     TLEN+2,,AUTO
         2 001207   000710 036003                    ADLQ    456,DU
         2 001210   200626 757100                    STAQ    FPT_READ+2,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:87   

      459    14492    1     FPT_READ.V.KEYS#=%NO#;

  14492  2 001211   000034 236000 3                  LDQ     28
         2 001212   200634 356100                    ANSQ    FPT_READ+8,,AUTO

      460    14493    1     FPT_READ.V.KEYR#=%YES#;

  14493  2 001213   100000 236007                    LDQ     32768,DL
         2 001214   200634 256100                    ORSQ    FPT_READ+8,,AUTO

      461    14494    1     FPT_READ.V.DCB#=M$IBEX1_NUM;

  14494  2 001215   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 001216   200634 740100                    STX0    FPT_READ+8,,AUTO

      462    14495        /*
      463    14496          ****  Loop until all keys are read
      464    14497        */
      465    14498    1     PROFC = 0;

  14498  2 001217   200462 450100                    STZ     PROFC,,AUTO

      466    14499    2     DO WHILE ('1'B);

      467    14500    2       CALL M$READ(FPT_READ) ALTRET(PROFILE40);

  14500  2 001220   200624 630500                    EPPR0   FPT_READ,,AUTO
         2 001221   440000 713400                    CLIMB   alt,read
         2 001222   401400 401760                    pmme    nvectors=4
         2 001223   001266 702000 2                  TSX2    PROFILE40

      468    14501    2       IF PRO_NAME.L# <= 11

  14501  2 001224   200710 236100                    LDQ     PRO_NAME,,AUTO
         2 001225   777000 376003                    ANQ     -512,DU
         2 001226   014000 116003                    CMPQ    6144,DU
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:88   
         2 001227   001220 603000 2                  TRC     s:14500

      469    14502    3         THEN DO;

      470    14503    3           CALL CPB$WILDCMPR (PRO_NAME, MATCH_STR)

  14503  2 001230   200463 236100                    LDQ     MATCH_STR$,,AUTO
         2 001231   201011 756100                    STQ     TLEN+3,,AUTO
         2 001232   200710 630500                    EPPR0   PRO_NAME,,AUTO
         2 001233   201010 450500                    STP0    TLEN+2,,AUTO
         2 001234   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 001235   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001236   000000 701000 xent               TSX1    CPB$WILDCMPR
         2 001237   001265 702000 2                  TSX2    s:14511

      471    14504    4           WHENRETURN DO;

      472    14505    4             PROFC = PROFC + 1;

  14505  2 001240   200462 054100                    AOS     PROFC,,AUTO

      473    14506    4             INBUFF=SUBSTR (PRO_NAME.NAME#, 0, PRO_NAME.L#);

  14506  2 001241   200710 236100                    LDQ     PRO_NAME,,AUTO
         2 001242   000033 772000                    QRL     27
         2 001243   000000 620006                    EAX0    0,QL
         2 001244   040100 100540                    MLR     fill='040'O
         2 001245   200710 200010                    ADSC9   PRO_NAME,,AUTO           cn=1,n=*X0
         2 001246   200421 000170                    ADSC9   INBUFF,,AUTO             cn=0,n=120

      474    14507    4             CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,12,TAB_VAL)

  14507  2 001247   200460 630500                    EPPR0   TAB_VAL,,AUTO
         2 001250   201014 450500                    STP0    TLEN+6,,AUTO
         2 001251   000036 236000 3                  LDQ     30
         2 001252   201013 756100                    STQ     TLEN+5,,AUTO
         2 001253   200413 631500                    EPPR1   IN$,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:89   
         2 001254   201012 451500                    STP1    TLEN+4,,AUTO
         2 001255   200412 633500                    EPPR3   DEST$,,AUTO
         2 001256   201011 453500                    STP3    TLEN+3,,AUTO
         2 001257   200411 634500                    EPPR4   OUTBUFF$,,AUTO
         2 001260   201010 454500                    STP4    TLEN+2,,AUTO
         2 001261   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 001262   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 001263   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 001264   001352 702000 2                  TSX2    PROFILE50

      475    14508    4                  ALTRET(PROFILE50);
      476    14509    4           END;

      477    14510    3         END;

      478    14511    2     END;  /* DO WHILE ('1'B); */

  14511  2 001265   001220 710000 2                  TRA     s:14500

  14507  2 001266                       PROFILE40    null
      479    14512    1   PROFILE40:;
      480    14513    1     IF B$TCB.ALT$ -> B$EXCFR.ERR.CODE = %E$EOF

  14513  2 001266   000000 470400 xsym               LDP0    B$TCB$
         2 001267   000000 471500                    LDP1    0,,PR0
         2 001270   100102 236100                    LDQ     66,,PR1
         2 001271   377770 376007                    ANQ     131064,DL
         2 001272   000060 116007                    CMPQ    48,DL
         2 001273   001276 600000 2                  TZE     s:14517
         2 001274   001610 116007                    CMPQ    904,DL
         2 001275   001352 601000 2                  TNZ     PROFILE50

      481    14514    1     OR B$TCB.ALT$ -> B$EXCFR.ERR.CODE = %E$NOFILE
      482    14515    1        THEN
      483    14516    2           DO;

      484    14517    2              IF PROFC = 0
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:90   

  14517  2 001276   200462 235100                    LDA     PROFC,,AUTO
         2 001277   001317 601000 2                  TNZ     s:14524

      485    14518    2                 THEN
      486    14519    3                    DO;

      487    14520    3                       INBUFF='none';

  14520  2 001300   040100 100400                    MLR     fill='040'O
         2 001301   000403 000004 1                  ADSC9   E_NOSUCHSTRM+6           cn=0,n=4
         2 001302   200421 000170                    ADSC9   INBUFF,,AUTO             cn=0,n=120

      488    14521    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC('none'))

  14521  2 001303   000001 236000 3                  LDQ     1
         2 001304   201013 756100                    STQ     TLEN+5,,AUTO
         2 001305   200413 631500                    EPPR1   IN$,,AUTO
         2 001306   201012 451500                    STP1    TLEN+4,,AUTO
         2 001307   200412 633500                    EPPR3   DEST$,,AUTO
         2 001310   201011 453500                    STP3    TLEN+3,,AUTO
         2 001311   200411 634500                    EPPR4   OUTBUFF$,,AUTO
         2 001312   201010 454500                    STP4    TLEN+2,,AUTO
         2 001313   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 001314   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 001315   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 001316   001352 702000 2                  TSX2    PROFILE50

      489    14522    3                            ALTRET(PROFILE50);
      490    14523    3                    END;

      491    14524    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,

  14524  2 001317   000000 470400 xsym               LDP0    SEG2$
         2 001320   000165 471500                    LDP1    117,,PR0
         2 001321   200411 236100                    LDQ     OUTBUFF$,,AUTO
         2 001322   000020 772000                    QRL     16
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:91   
         2 001323   201010 756100                    STQ     TLEN+2,,AUTO
         2 001324   200412 236100                    LDQ     DEST$,,AUTO
         2 001325   000020 772000                    QRL     16
         2 001326   201010 136100                    SBLQ    TLEN+2,,AUTO
         2 001327   000020 736000                    QLS     16
         2 001330   100004 676100                    ERQ     4,,PR1
         2 001331   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 001332   100004 656100                    ERSQ    4,,PR1

      492    14525    2                   OUTBUFF$);
      493    14526    2              IF SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND > TAB_VAL

  14526  2 001333   000165 471500                    LDP1    117,,PR0
         2 001334   100004 236100                    LDQ     4,,PR1
         2 001335   000020 772000                    QRL     16
         2 001336   200460 116100                    CMPQ    TAB_VAL,,AUTO
         2 001337   001347 604400 2                  TMOZ    s:14529

      494    14527    2                 THEN
      495    14528    2                    CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(PROFILE50);

  14528  2 001340   000000 236000 xsym               LDQ     SEG2$
         2 001341   000165 036003                    ADLQ    117,DU
         2 001342   201010 756100                    STQ     TLEN+2,,AUTO
         2 001343   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 001344   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001345   000000 701000 xent               TSX1    CPE$LISTOUT
         2 001346   001352 702000 2                  TSX2    PROFILE50

      496    14529    2              CALL CLOSE_REL ALTRET(PROFILE50);

  14529  2 001347   005660 701000 2                  TSX1    CLOSE_REL
         2 001350   001352 702000 2                  TSX2    PROFILE50

      497    14530    2              RETURN;

  14530  2 001351   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:92   

  14529  2 001352                       PROFILE50    null
      498    14531    2           END;
      499    14532    1   PROFILE50:;
      500    14533    1     B$JIT.USRERR = B$TCB.ALT$ -> B$EXCFR.ERR;

  14533  2 001352   000000 470400 xsym               LDP0    B$TCB$
         2 001353   000000 471500                    LDP1    0,,PR0
         2 001354   100102 236100                    LDQ     66,,PR1
         2 001355   000000 473400 xsym               LDP3    B$JIT$
         2 001356   300144 756100                    STQ     100,,PR3

      501    14534    1     CALL CLOSE_REL ALTRET(PROFILE60);

  14534  2 001357   005660 701000 2                  TSX1    CLOSE_REL
         2 001360   001361 702000 2                  TSX2    PROFILE60

  14533  2 001361                       PROFILE60    null
      502    14535    1   PROFILE60:;
      503    14536    1     ALTRETURN;

  14536  2 001361   000000 702200 xent               TSX2  ! X66_AALT

      504    14537                   %EJECT;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:93   
      505    14538        /***********************************************************************/
      506    14539        /*F*   NAME:   CPF$TERMINAL
      507    14540               PURPOSE: The TERMINAL command is utilized to set or display various
      508    14541                       terminal characteristics.
      509    14542               DESCRIPTION: The various terminal characteristics which may be
      510    14543                       modified are those specifiable on the M$STRMCTL
      511    14544                       and M$STRMATTR fpts. Upon request, these
      512    14545                       same set of characteristics are displayed along with
      513    14546                       additional terminal releated information.
      514    14547               REFERENCE: Programmers Reference Manual
      515    14548        */
      516    14549        /*D*   NAME:   CPF$TERMINAL
      517    14550               CALL:   CALL CPF$TERMINAL(P$PCB)
      518    14551               INPUT:  parse control block
      519    14552               OUTPUT: terminal characteristics set or displayed
      520    14553               DESCRIPTION: If no sub-blocks are found, or if 1 sub-block that
      521    14554                       specifies a stream number to be used for the display, various
      522    14555                       terminal characteristics are displayed. Otherwise, specified
      523    14556                       terminal characteristics are set.
      524    14557        */
      525    14558        /**********************************************************************/
      526    14559    1   CPF$TERMINAL: ENTRY(P$PCB) ALTRET;

  14559  2 001362   000000 700200 xent  CPF$TERMINAL TSX0  ! X66_AUTO_1
         2 001363   001066 000001                    ZERO    566,1

      527    14560          %SUB          SINPUTDFLT            = 0 /*Sinputdflt*/;
      528    14561                                                         /*
      529    14562                                                         */
      530    14563    1     BLK$=P$PCB.OUT$;

  14563  2 001364   200003 470500                    LDP0    @P$PCB,,AUTO
         2 001365   000003 236100                    LDQ     3,,PR0
         2 001366   200004 756100                    STQ     BLK$,,AUTO

      531    14564        /*
      532    14565             ***** If not INTERACTIVE then this command makes no sense...
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:94   
      533    14566        */
      534    14567    1     IF B$JIT.MODE ~= %M_INT#

  14567  2 001367   000000 471400 xsym               LDP1    B$JIT$
         2 001370   100000 236100                    LDQ     0,,PR1
         2 001371   740000 376003                    ANQ     -16384,DU
         2 001372   140000 116003                    CMPQ    49152,DU
         2 001373   001375 600000 2                  TZE     s:14574

      535    14568    1        THEN   /* Ignore this command */
      536    14569    1           RETURN;

  14569  2 001374   000000 702200 xent               TSX2  ! X66_ARET

      537    14570        /*
      538    14571          ****     No options following verb or if only 1 sub-block that specifies
      539    14572          ****     a stream infers ... Display the terminal profile.
      540    14573        */
      541    14574    1     IF (BLK$->P$B.NSUBLKS=0) OR (BLK$->P$B.NSUBLKS=1 AND

  14574  2 001375   200004 473500                    LDP3    BLK$,,AUTO
         2 001376   300001 220100                    LDX0    1,,PR3
         2 001377   001406 600000 2                  TZE     s:14578
         2 001400   000001 100003                    CMPX0   1,DU
         2 001401   004507 601000 2                  TNZ     TERM50
         2 001402   300003 474500                    LDP4    3,,PR3
         2 001403   400000 721100                    LXL1    0,,PR4
         2 001404   000132 101003                    CMPX1   90,DU
         2 001405   004507 601000 2                  TNZ     TERM50

      542    14575    1                                   BLK$->P$B.SUBLK$(0)->P$B.CODE = UCNN)
      543    14576    1        THEN
      544    14577    2           DO;

      545    14578    2              FPT_GLINEATTR = CFPT_GLINEATTR;

  14578  2 001406   000100 100400                    MLR     fill='000'O
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:95   
         2 001407   000000 000040 xsym               ADSC9   CFPT_GLINEATTR           cn=0,n=32
         2 001410   200654 000040                    ADSC9   FPT_GLINEATTR,,AUTO      cn=0,n=32

      546    14579    2              FPT_GLINEATTR.V_ = VECTOR(FPT_GLINEATTR.V);

  14579  2 001411   000005 235000 3                  LDA     5
         2 001412   201010 452500                    STP2    TLEN+2,,AUTO
         2 001413   201010 236100                    LDQ     TLEN+2,,AUTO
         2 001414   000662 036003                    ADLQ    434,DU
         2 001415   200654 757100                    STAQ    FPT_GLINEATTR,,AUTO

      547    14580    2              FPT_GLINEATTR.LINEATTR_ = VECTOR(VLP_LINEATTR);

  14580  2 001416   000014 235000 3                  LDA     12
         2 001417   201010 452500                    STP2    TLEN+2,,AUTO
         2 001420   201010 236100                    LDQ     TLEN+2,,AUTO
         2 001421   000740 036003                    ADLQ    480,DU
         2 001422   200660 757100                    STAQ    FPT_GLINEATTR+4,,AUTO

      548    14581    2              CALL M$GLINEATTR (FPT_GLINEATTR) ALTRET (TERM50);

  14581  2 001423   200654 630500                    EPPR0   FPT_GLINEATTR,,AUTO
         2 001424   560005 713400                    CLIMB   alt,+57349
         2 001425   401000 401760                    pmme    nvectors=3
         2 001426   004507 702000 2                  TSX2    TERM50

      549    14582    2              FPT_TRMCTL = CFPT_TRMCTL;

  14582  2 001427   000100 100400                    MLR     fill='000'O
         2 001430   000000 000040 xsym               ADSC9   CFPT_TRMCTL              cn=0,n=32
         2 001431   200664 000040                    ADSC9   FPT_TRMCTL,,AUTO         cn=0,n=32

      550    14583    2              FPT_TRMCTL.V_ = VECTOR(FPT_TRMCTL.V);

  14583  2 001432   000005 235000 3                  LDA     5
         2 001433   201010 452500                    STP2    TLEN+2,,AUTO
         2 001434   201010 236100                    LDQ     TLEN+2,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:96   
         2 001435   000672 036003                    ADLQ    442,DU
         2 001436   200664 757100                    STAQ    FPT_TRMCTL,,AUTO

      551    14584    2              FPT_TRMCTL.TRMCTL_ = VECTOR(VLP_TRMCTL);

  14584  2 001437   000011 235000 3                  LDA     9
         2 001440   201010 452500                    STP2    TLEN+2,,AUTO
         2 001441   201010 236100                    LDQ     TLEN+2,,AUTO
         2 001442   000720 036003                    ADLQ    464,DU
         2 001443   200670 757100                    STAQ    FPT_TRMCTL+4,,AUTO

      552    14585    2              IF BLK$->P$B.NSUBLKS=1

  14585  2 001444   200004 470500                    LDP0    BLK$,,AUTO
         2 001445   000001 220100                    LDX0    1,,PR0
         2 001446   000001 100003                    CMPX0   1,DU
         2 001447   001526 601000 2                  TNZ     s:14609

      553    14586    2               THEN                /* A stream was specified */
      554    14587    3                 DO ;

      555    14588    3                   STRM = BLK$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$S.TEXT ;

  14588  2 001450   000003 471500                    LDP1    3,,PR0
         2 001451   100003 473500                    LDP3    3,,PR1
         2 001452   300004 236100                    LDQ     4,,PR3
         2 001453   000033 772000                    QRL     27
         2 001454   000000 621006                    EAX1    0,QL
         2 001455   040100 100540                    MLR     fill='040'O
         2 001456   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         2 001457   200465 000002                    ADSC9   STRM,,AUTO               cn=0,n=2

      556    14589    3                   CALL CPF$FIND_UCNN (STRM, DCB#) WHENALTRETURN

  14589  2 001460   200464 631500                    EPPR1   DCB#,,AUTO
         2 001461   201011 451500                    STP1    TLEN+3,,AUTO
         2 001462   200465 633500                    EPPR3   STRM,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:97   
         2 001463   201010 453500                    STP3    TLEN+2,,AUTO
         2 001464   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 001465   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001466   000000 701000 xent               TSX1    CPF$FIND_UCNN
         2 001467   001471 702000 2                  TSX2    s:14591
         2 001470   001524 710000 2                  TRA     s:14603

      557    14590    4                                     DO ;

      558    14591    4                                       FPT_OPEN = CFPT_OPEN ;

  14591  2 001471   000100 100400                    MLR     fill='000'O
         2 001472   000000 000350 xsym               ADSC9   CFPT_OPEN                cn=0,n=232
         2 001473   200474 000350                    ADSC9   FPT_OPEN,,AUTO           cn=0,n=232

      559    14592    4                                       FPT_OPEN.V_ = VECTOR(FPT_OPEN.V) ;

  14592  2 001474   000024 235000 3                  LDA     20
         2 001475   201010 452500                    STP2    TLEN+2,,AUTO
         2 001476   201010 236100                    LDQ     TLEN+2,,AUTO
         2 001477   000540 036003                    ADLQ    352,DU
         2 001500   200474 757100                    STAQ    FPT_OPEN,,AUTO

      560    14593    4                                       FPT_OPEN.V.DCB# = M$IBEX1_NUM ;

  14593  2 001501   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 001502   200540 740100                    STX0    FPT_OPEN+36,,AUTO

      561    14594    4                                       DCB# = M$IBEX1_NUM ;

  14594  2 001503   000000 235000 xsym               LDA     M$IBEX1_NUM
         2 001504   200464 755100                    STA     DCB#,,AUTO

      562    14595    4                                       CALL CONCAT(FPT_OPEN.V.RES#, 'UC', STRM) ;

  14595  2 001505   000404 221000 1                  LDX1    E_NOSUCHSTRM+7
         2 001506   200544 741100                    STX1    FPT_OPEN+40,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:98   
         2 001507   200465 222100                    LDX2    STRM,,AUTO
         2 001510   200544 442100                    SXL2    FPT_OPEN+40,,AUTO

      563    14596    4                                       FPT_OPEN.V.ORG# = %TERMINAL# ;

  14596  2 001511   010000 236007                    LDQ     4096,DL
         2 001512   200542 552110                    STBQ    FPT_OPEN+38,'10'O,AUTO

      564    14597    4                                       CALL M$OPEN (FPT_OPEN) WHENALTRETURN

  14597  2 001513   200474 630500                    EPPR0   FPT_OPEN,,AUTO
         2 001514   450000 713400                    CLIMB   alt,open
         2 001515   410400 401760                    pmme    nvectors=18
         2 001516   001520 702000 2                  TSX2    s:14599
         2 001517   001524 710000 2                  TRA     s:14603

      565    14598    5                                       DO ;

      566    14599    5                                         B$JIT.USRERR = E_NOSUCHSTRM ;

  14599  2 001520   000375 236000 1                  LDQ     E_NOSUCHSTRM
         2 001521   000000 470400 xsym               LDP0    B$JIT$
         2 001522   000144 756100                    STQ     100,,PR0

      567    14600    5                                         GOTO TERM70 ;

  14600  2 001523   004514 710000 2                  TRA     TERM70

      568    14601    5                                       END ; /* Whenaltreturn Do */
      569    14602    4                                     END ; /* Whenaltreturn Do */

      570    14603    3                   FPT_TRMCTL.V.DCB# = DCB# ;

  14603  2 001524   200464 720100                    LXL0    DCB#,,AUTO
         2 001525   200672 740100                    STX0    FPT_TRMCTL+6,,AUTO

      571    14604    3                 END ; /* Then Do */
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:99   

      572    14605        /*E*    ERROR: CPF-E$NOSUCHSTRM-C
      573    14606                MESSAGE: No such stream defined.
      574    14607        */
      575    14608        /**/
      576    14609    2              CALL M$GTRMCTL (FPT_TRMCTL) ALTRET(TERM50);

  14609  2 001526   200664 630500                    EPPR0   FPT_TRMCTL,,AUTO
         2 001527   560001 713400                    CLIMB   alt,+57345
         2 001530   401000 401760                    pmme    nvectors=3
         2 001531   004507 702000 2                  TSX2    TERM50

      577    14610    2            FPT_TRMCTL.TRMCTL_ = VECTOR(VLP_EDTCTL);

  14610  2 001532   000011 235000 3                  LDA     9
         2 001533   201010 452500                    STP2    TLEN+2,,AUTO
         2 001534   201010 236100                    LDQ     TLEN+2,,AUTO
         2 001535   000724 036003                    ADLQ    468,DU
         2 001536   200670 757100                    STAQ    FPT_TRMCTL+4,,AUTO

      578    14611    2            FPT_TRMCTL.V.VLPTYPE# = %TRMCTL_EDTCTL#;

  14611  2 001537   000002 220003                    LDX0    2,DU
         2 001540   200672 440100                    SXL0    FPT_TRMCTL+6,,AUTO

      579    14612    2            HAVE_EDTCTL = %NO#;

  14612  2 001541   200416 450100                    STZ     HAVE_EDTCTL,,AUTO

      580    14613    2            CALL M$GTRMCTL (FPT_TRMCTL)

  14613  2 001542   200664 630500                    EPPR0   FPT_TRMCTL,,AUTO
         2 001543   560001 713400                    CLIMB   alt,+57345
         2 001544   401000 401760                    pmme    nvectors=3
         2 001545   001560 702000 2                  TSX2    s:14619

      581    14614    3              WHENRETURN DO;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:100  

      582    14615    3               IF DCBADDR(FPT_TRMCTL.V.DCB#) -> F$DCB.ORG# = %SE#

  14615  2 001546   000037 470400 3                  LDP0    31
         2 001547   000000 471500                    LDP1    0,,PR0
         2 001550   200672 220100                    LDX0    FPT_TRMCTL+6,,AUTO
         2 001551   100000 473510                    LDP3    0,X0,PR1
         2 001552   300032 236100                    LDQ     26,,PR3
         2 001553   777000 376003                    ANQ     -512,DU
         2 001554   027000 116003                    CMPQ    11776,DU
         2 001555   001560 601000 2                  TNZ     s:14619

      583    14616    3                 THEN
      584    14617    3                  HAVE_EDTCTL = %YES#;

  14617  2 001556   400000 236003                    LDQ     -131072,DU
         2 001557   200416 756100                    STQ     HAVE_EDTCTL,,AUTO

      585    14618    3               END;

      586    14619    2            FPT_TRMCTL.TRMCTL_ = VECTOR(VLP_WINDOW);

  14619  2 001560   000033 235000 3                  LDA     27
         2 001561   201010 452500                    STP2    TLEN+2,,AUTO
         2 001562   201010 236100                    LDQ     TLEN+2,,AUTO
         2 001563   000730 036003                    ADLQ    472,DU
         2 001564   200670 757100                    STAQ    FPT_TRMCTL+4,,AUTO

      587    14620    2            FPT_TRMCTL.V.VLPTYPE# = %TRMCTL_WINDOW#;

  14620  2 001565   000001 220003                    LDX0    1,DU
         2 001566   200672 440100                    SXL0    FPT_TRMCTL+6,,AUTO

      588    14621    2            HAVE_WINDOW = %NO#;

  14621  2 001567   200417 450100                    STZ     HAVE_WINDOW,,AUTO

PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:101  
      589    14622    2            CALL M$GTRMCTL (FPT_TRMCTL)

  14622  2 001570   200664 630500                    EPPR0   FPT_TRMCTL,,AUTO
         2 001571   560001 713400                    CLIMB   alt,+57345
         2 001572   401000 401760                    pmme    nvectors=3
         2 001573   001576 702000 2                  TSX2    s:14626

      590    14623    3              WHENRETURN DO;

      591    14624    3               HAVE_WINDOW = %YES#;

  14624  2 001574   400000 236003                    LDQ     -131072,DU
         2 001575   200417 756100                    STQ     HAVE_WINDOW,,AUTO

      592    14625    3               END;

      593    14626    2              FPT_TRMATTR = CFPT_TRMATTR;

  14626  2 001576   000100 100400                    MLR     fill='000'O
         2 001577   000000 000040 xsym               ADSC9   CFPT_TRMATTR             cn=0,n=32
         2 001600   200674 000040                    ADSC9   FPT_TRMATTR,,AUTO        cn=0,n=32

      594    14627    2              FPT_TRMATTR.V_ = VECTOR(FPT_TRMATTR.V);

  14627  2 001601   000005 235000 3                  LDA     5
         2 001602   201010 452500                    STP2    TLEN+2,,AUTO
         2 001603   201010 236100                    LDQ     TLEN+2,,AUTO
         2 001604   000702 036003                    ADLQ    450,DU
         2 001605   200674 757100                    STAQ    FPT_TRMATTR,,AUTO

      595    14628    2              FPT_TRMATTR.V.DCB# = FPT_TRMCTL.V.DCB# ;

  14628  2 001606   200672 220100                    LDX0    FPT_TRMCTL+6,,AUTO
         2 001607   200702 740100                    STX0    FPT_TRMATTR+6,,AUTO

      596    14629    2              FPT_TRMATTR.V.DCB# = FPT_TRMCTL.V.DCB# ;

PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:102  
  14629  2 001610   200702 740100                    STX0    FPT_TRMATTR+6,,AUTO

      597    14630    2              FPT_TRMATTR.TRMATTR_ = VECTOR(VLP_TRMATTR);

  14630  2 001611   000040 235000 3                  LDA     32
         2 001612   201010 452500                    STP2    TLEN+2,,AUTO
         2 001613   201010 236100                    LDQ     TLEN+2,,AUTO
         2 001614   000760 036003                    ADLQ    496,DU
         2 001615   200700 757100                    STAQ    FPT_TRMATTR+4,,AUTO

      598    14631    2              CALL M$GTRMATTR (FPT_TRMATTR) ALTRET(TERM50);

  14631  2 001616   200674 630500                    EPPR0   FPT_TRMATTR,,AUTO
         2 001617   560007 713400                    CLIMB   alt,+57351
         2 001620   401000 401760                    pmme    nvectors=3
         2 001621   004507 702000 2                  TSX2    TERM50

      599    14632    2              SEG$2.FPT_WRITE$->FPT$WRITE=CFPT_WRITE;

  14632  2 001622   000000 470400 xsym               LDP0    SEG2$
         2 001623   000165 471500                    LDP1    117,,PR0
         2 001624   000100 100400                    MLR     fill='000'O
         2 001625   000000 000060 xsym               ADSC9   CFPT_WRITE               cn=0,n=48
         2 001626   100000 000060                    ADSC9   0,,PR1                   cn=0,n=48

      600    14633    2              SEG$2.FPT_WRITE$->FPT$WRITE.V_=VECTOR(SEG$2.FPT_WRITE$

  14633  2 001627   000165 471500                    LDP1    117,,PR0
         2 001630   000011 235000 3                  LDA     9
         2 001631   201010 451500                    STP1    TLEN+2,,AUTO
         2 001632   201010 236100                    LDQ     TLEN+2,,AUTO
         2 001633   000010 036003                    ADLQ    8,DU
         2 001634   100000 757100                    STAQ    0,,PR1

      601    14634    2                   ->FPT$WRITE.V);
      602    14635        /*
      603    14636          ****     Output header
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:103  
      604    14637        */
      605    14638    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_=VECTOR(THDR);

  14638  2 001635   000165 471500                    LDP1    117,,PR0
         2 001636   000042 237000 3                  LDAQ    34
         2 001637   100004 757100                    STAQ    4,,PR1

      606    14639    2              CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(TERM70);

  14639  2 001640   000000 236000 xsym               LDQ     SEG2$
         2 001641   000165 036003                    ADLQ    117,DU
         2 001642   201010 756100                    STQ     TLEN+2,,AUTO
         2 001643   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 001644   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001645   000000 701000 xent               TSX1    CPE$LISTOUT
         2 001646   004514 702000 2                  TSX2    TERM70

      607    14640        /*
      608    14641          ****           Init. Buffer ptrs
      609    14642        */
      610    14643    2              OUTBUFF$=ADDR(OUTBUFF);         /*Ptr to buff. BEGNG.*/

  14643  2 001647   200011 630500                    EPPR0   OUTBUFF,,AUTO
         2 001650   200411 450500                    STP0    OUTBUFF$,,AUTO

      611    14644    2              DEST$=OUTBUFF$;                 /*Dynamic ptr*/

  14644  2 001651   200411 236100                    LDQ     OUTBUFF$,,AUTO
         2 001652   200412 756100                    STQ     DEST$,,AUTO

      612    14645    2              IN$=ADDR(INBUFF);

  14645  2 001653   200421 631500                    EPPR1   INBUFF,,AUTO
         2 001654   200413 451500                    STP1    IN$,,AUTO

      613    14646    2              TAB_VAL = 5;

PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:104  
  14646  2 001655   000005 235007                    LDA     5,DL
         2 001656   200460 755100                    STA     TAB_VAL,,AUTO

      614    14647        /*
      615    14648          ****           Create mode-port line of output
      616    14649        */
      617    14650    2              OUTBUFF='      Node-port = ';

  14650  2 001657   040100 100400                    MLR     fill='040'O
         2 001660   000405 000022 1                  ADSC9   E_NOSUCHSTRM+8           cn=0,n=18
         2 001661   200011 002000                    ADSC9   OUTBUFF,,AUTO            cn=0,n=1024

      618    14651    2              DEST$=PINCRC(DEST$,SIZEC('      Node-port = ')); /*Incr. PTR.*/

  14651  2 001662   000041 036000 3                  ADLQ    33
         2 001663   200412 756100                    STQ     DEST$,,AUTO

      619    14652        /* ****          Insert node only if present     */
      620    14653    2              IF VLP_LINEATTR.NODE#~=' '

  14653  2 001664   200745 236100                    LDQ     VLP_LINEATTR+5,,AUTO
         2 001665   000035 116000 xsym               CMPQ    B_VECTNIL+29
         2 001666   001717 600000 2                  TZE     s:14661

      621    14654    2                 THEN
      622    14655    3                    DO;

      623    14656    3                       CALL CPE$RZEROS(VLP_LINEATTR.NODE#,SIZEC(VLP_LINEATTR.

  14656  2 001667   200457 633500                    EPPR3   LEN,,AUTO
         2 001670   201012 453500                    STP3    TLEN+4,,AUTO
         2 001671   000001 236000 3                  LDQ     1
         2 001672   201011 756100                    STQ     TLEN+3,,AUTO
         2 001673   200745 634500                    EPPR4   VLP_LINEATTR+5,,AUTO
         2 001674   201010 454500                    STP4    TLEN+2,,AUTO
         2 001675   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 001676   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:105  
         2 001677   000000 701000 xent               TSX1    CPE$RZEROS
         2 001700   000000 011000                    NOP     0

      624    14657    3                            NODE#),LEN);
      625    14658    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(VLP_LINEATTR.

  14658  2 001701   200745 630500                    EPPR0   VLP_LINEATTR+5,,AUTO
         2 001702   201010 450500                    STP0    TLEN+2,,AUTO
         2 001703   200457 631500                    EPPR1   LEN,,AUTO
         2 001704   201015 451500                    STP1    TLEN+7,,AUTO
         2 001705   201010 633500                    EPPR3   TLEN+2,,AUTO
         2 001706   201014 453500                    STP3    TLEN+6,,AUTO
         2 001707   200412 634500                    EPPR4   DEST$,,AUTO
         2 001710   201013 454500                    STP4    TLEN+5,,AUTO
         2 001711   200411 635500                    EPPR5   OUTBUFF$,,AUTO
         2 001712   201012 455500                    STP5    TLEN+4,,AUTO
         2 001713   201012 630500                    EPPR0   TLEN+4,,AUTO
         2 001714   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 001715   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 001716   004514 702000 2                  TSX2    TERM70

      626    14659    3                            NODE#),LEN) ALTRET(TERM70);
      627    14660    3                    END;

      628    14661    2              INBUFF='-';

  14661  2 001717   040100 100400                    MLR     fill='040'O
         2 001720   000044 000001 3                  ADSC9   36                       cn=0,n=1
         2 001721   200421 000170                    ADSC9   INBUFF,,AUTO             cn=0,n=120

      629    14662    2              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1)       ALTRET(TERM70);

  14662  2 001722   000003 236000 3                  LDQ     3
         2 001723   201013 756100                    STQ     TLEN+5,,AUTO
         2 001724   200413 630500                    EPPR0   IN$,,AUTO
         2 001725   201012 450500                    STP0    TLEN+4,,AUTO
         2 001726   200412 631500                    EPPR1   DEST$,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:106  
         2 001727   201011 451500                    STP1    TLEN+3,,AUTO
         2 001730   200411 633500                    EPPR3   OUTBUFF$,,AUTO
         2 001731   201010 453500                    STP3    TLEN+2,,AUTO
         2 001732   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 001733   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 001734   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 001735   004514 702000 2                  TSX2    TERM70

      630    14663        /* ****          Insert port if present          */
      631    14664    2              IF VLP_LINEATTR.PORT#~=' '

  14664  2 001736   200746 236100                    LDQ     VLP_LINEATTR+6,,AUTO
         2 001737   000035 116000 xsym               CMPQ    B_VECTNIL+29
         2 001740   001771 600000 2                  TZE     s:14672

      632    14665    2                 THEN
      633    14666    3                    DO;

      634    14667    3                       CALL CPE$RZEROS(VLP_LINEATTR.PORT#,SIZEC(VLP_LINEATTR.

  14667  2 001741   200457 630500                    EPPR0   LEN,,AUTO
         2 001742   201012 450500                    STP0    TLEN+4,,AUTO
         2 001743   000001 236000 3                  LDQ     1
         2 001744   201011 756100                    STQ     TLEN+3,,AUTO
         2 001745   200746 631500                    EPPR1   VLP_LINEATTR+6,,AUTO
         2 001746   201010 451500                    STP1    TLEN+2,,AUTO
         2 001747   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 001750   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001751   000000 701000 xent               TSX1    CPE$RZEROS
         2 001752   000000 011000                    NOP     0

      635    14668    3                            PORT#),LEN);
      636    14669    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(VLP_LINEATTR.

  14669  2 001753   200746 630500                    EPPR0   VLP_LINEATTR+6,,AUTO
         2 001754   201010 450500                    STP0    TLEN+2,,AUTO
         2 001755   200457 631500                    EPPR1   LEN,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:107  
         2 001756   201015 451500                    STP1    TLEN+7,,AUTO
         2 001757   201010 633500                    EPPR3   TLEN+2,,AUTO
         2 001760   201014 453500                    STP3    TLEN+6,,AUTO
         2 001761   200412 634500                    EPPR4   DEST$,,AUTO
         2 001762   201013 454500                    STP4    TLEN+5,,AUTO
         2 001763   200411 635500                    EPPR5   OUTBUFF$,,AUTO
         2 001764   201012 455500                    STP5    TLEN+4,,AUTO
         2 001765   201012 630500                    EPPR0   TLEN+4,,AUTO
         2 001766   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 001767   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 001770   004514 702000 2                  TSX2    TERM70

      637    14670    3                            PORT#),LEN) ALTRET(TERM70);
      638    14671    3                    END;

      639    14672    2              IF VLP_LINEATTR.CONTROLLER#~=' '

  14672  2 001771   200747 236100                    LDQ     VLP_LINEATTR+7,,AUTO
         2 001772   000035 116000 xsym               CMPQ    B_VECTNIL+29
         2 001773   002043 600000 2                  TZE     s:14682

      640    14673    2                 THEN
      641    14674    3                    DO;

      642    14675    3                       CALL CPE$RZEROS(VLP_LINEATTR.CONTROLLER#,SIZEC(VLP_LINEATTR.

  14675  2 001774   200457 630500                    EPPR0   LEN,,AUTO
         2 001775   201012 450500                    STP0    TLEN+4,,AUTO
         2 001776   000001 236000 3                  LDQ     1
         2 001777   201011 756100                    STQ     TLEN+3,,AUTO
         2 002000   200747 631500                    EPPR1   VLP_LINEATTR+7,,AUTO
         2 002001   201010 451500                    STP1    TLEN+2,,AUTO
         2 002002   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 002003   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 002004   000000 701000 xent               TSX1    CPE$RZEROS
         2 002005   000000 011000                    NOP     0

PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:108  
      643    14676    3                            CONTROLLER#),LEN);
      644    14677    3                       INBUFF='-';

  14677  2 002006   040100 100400                    MLR     fill='040'O
         2 002007   000044 000001 3                  ADSC9   36                       cn=0,n=1
         2 002010   200421 000170                    ADSC9   INBUFF,,AUTO             cn=0,n=120

      645    14678    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1)       ALTRET(TERM70);

  14678  2 002011   000003 236000 3                  LDQ     3
         2 002012   201013 756100                    STQ     TLEN+5,,AUTO
         2 002013   200413 630500                    EPPR0   IN$,,AUTO
         2 002014   201012 450500                    STP0    TLEN+4,,AUTO
         2 002015   200412 631500                    EPPR1   DEST$,,AUTO
         2 002016   201011 451500                    STP1    TLEN+3,,AUTO
         2 002017   200411 633500                    EPPR3   OUTBUFF$,,AUTO
         2 002020   201010 453500                    STP3    TLEN+2,,AUTO
         2 002021   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 002022   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 002023   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 002024   004514 702000 2                  TSX2    TERM70

      646    14679    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(VLP_LINEATTR.

  14679  2 002025   200747 630500                    EPPR0   VLP_LINEATTR+7,,AUTO
         2 002026   201010 450500                    STP0    TLEN+2,,AUTO
         2 002027   200457 631500                    EPPR1   LEN,,AUTO
         2 002030   201015 451500                    STP1    TLEN+7,,AUTO
         2 002031   201010 633500                    EPPR3   TLEN+2,,AUTO
         2 002032   201014 453500                    STP3    TLEN+6,,AUTO
         2 002033   200412 634500                    EPPR4   DEST$,,AUTO
         2 002034   201013 454500                    STP4    TLEN+5,,AUTO
         2 002035   200411 635500                    EPPR5   OUTBUFF$,,AUTO
         2 002036   201012 455500                    STP5    TLEN+4,,AUTO
         2 002037   201012 630500                    EPPR0   TLEN+4,,AUTO
         2 002040   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 002041   000000 701000 xent               TSX1    CPB$BLDIMAGE
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:109  
         2 002042   004514 702000 2                  TSX2    TERM70

      647    14680    3                            CONTROLLER#),LEN) ALTRET(TERM70);
      648    14681    3                    END;

      649    14682    2              IF VLP_LINEATTR.DEVICE#~=' '

  14682  2 002043   200750 236100                    LDQ     VLP_LINEATTR+8,,AUTO
         2 002044   000035 116000 xsym               CMPQ    B_VECTNIL+29
         2 002045   002115 600000 2                  TZE     s:14693

      650    14683    2                 THEN
      651    14684    3                    DO;

      652    14685    3                       CALL CPE$RZEROS(VLP_LINEATTR.DEVICE#,SIZEC(VLP_LINEATTR.

  14685  2 002046   200457 630500                    EPPR0   LEN,,AUTO
         2 002047   201012 450500                    STP0    TLEN+4,,AUTO
         2 002050   000001 236000 3                  LDQ     1
         2 002051   201011 756100                    STQ     TLEN+3,,AUTO
         2 002052   200750 631500                    EPPR1   VLP_LINEATTR+8,,AUTO
         2 002053   201010 451500                    STP1    TLEN+2,,AUTO
         2 002054   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 002055   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 002056   000000 701000 xent               TSX1    CPE$RZEROS
         2 002057   000000 011000                    NOP     0

      653    14686    3                            DEVICE#),LEN);
      654    14687    3                       INBUFF='-';

  14687  2 002060   040100 100400                    MLR     fill='040'O
         2 002061   000044 000001 3                  ADSC9   36                       cn=0,n=1
         2 002062   200421 000170                    ADSC9   INBUFF,,AUTO             cn=0,n=120

      655    14688    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1)       ALTRET(TERM70);

  14688  2 002063   000003 236000 3                  LDQ     3
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:110  
         2 002064   201013 756100                    STQ     TLEN+5,,AUTO
         2 002065   200413 630500                    EPPR0   IN$,,AUTO
         2 002066   201012 450500                    STP0    TLEN+4,,AUTO
         2 002067   200412 631500                    EPPR1   DEST$,,AUTO
         2 002070   201011 451500                    STP1    TLEN+3,,AUTO
         2 002071   200411 633500                    EPPR3   OUTBUFF$,,AUTO
         2 002072   201010 453500                    STP3    TLEN+2,,AUTO
         2 002073   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 002074   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 002075   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 002076   004514 702000 2                  TSX2    TERM70

      656    14689    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(VLP_LINEATTR.

  14689  2 002077   200750 630500                    EPPR0   VLP_LINEATTR+8,,AUTO
         2 002100   201010 450500                    STP0    TLEN+2,,AUTO
         2 002101   200457 631500                    EPPR1   LEN,,AUTO
         2 002102   201015 451500                    STP1    TLEN+7,,AUTO
         2 002103   201010 633500                    EPPR3   TLEN+2,,AUTO
         2 002104   201014 453500                    STP3    TLEN+6,,AUTO
         2 002105   200412 634500                    EPPR4   DEST$,,AUTO
         2 002106   201013 454500                    STP4    TLEN+5,,AUTO
         2 002107   200411 635500                    EPPR5   OUTBUFF$,,AUTO
         2 002110   201012 455500                    STP5    TLEN+4,,AUTO
         2 002111   201012 630500                    EPPR0   TLEN+4,,AUTO
         2 002112   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 002113   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 002114   004514 702000 2                  TSX2    TERM70

      657    14690    3                            DEVICE#),LEN) ALTRET(TERM70);
      658    14691    3                    END;

      659    14692        /* ****          Insert multidevice if on        */
      660    14693    2              IF VLP_LINEATTR.MULTIDEVICE#=%YES#

  14693  2 002115   200740 236100                    LDQ     VLP_LINEATTR,,AUTO
         2 002116   004000 316003                    CANQ    2048,DU
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:111  
         2 002117   002137 600000 2                  TZE     s:14700

      661    14694    2                 THEN
      662    14695    3                    DO;

      663    14696    3                       INBUFF='(multidevice)';

  14696  2 002120   040100 100400                    MLR     fill='040'O
         2 002121   000412 000015 1                  ADSC9   E_NOSUCHSTRM+13          cn=0,n=13
         2 002122   200421 000170                    ADSC9   INBUFF,,AUTO             cn=0,n=120

      664    14697    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC('(multidevice)'))

  14697  2 002123   000046 236000 3                  LDQ     38
         2 002124   201013 756100                    STQ     TLEN+5,,AUTO
         2 002125   200413 630500                    EPPR0   IN$,,AUTO
         2 002126   201012 450500                    STP0    TLEN+4,,AUTO
         2 002127   200412 631500                    EPPR1   DEST$,,AUTO
         2 002130   201011 451500                    STP1    TLEN+3,,AUTO
         2 002131   200411 633500                    EPPR3   OUTBUFF$,,AUTO
         2 002132   201010 453500                    STP3    TLEN+2,,AUTO
         2 002133   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 002134   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 002135   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 002136   004514 702000 2                  TSX2    TERM70

      665    14698    3                            ALTRET(TERM70);
      666    14699    3                    END;

      667    14700    2              SEG$2.FPT_WRITE$ -> FPT$WRITE.BUF_.BUF$ = OUTBUFF$;

  14700  2 002137   000000 470400 xsym               LDP0    SEG2$
         2 002140   000165 471500                    LDP1    117,,PR0
         2 002141   200411 236100                    LDQ     OUTBUFF$,,AUTO
         2 002142   100005 756100                    STQ     5,,PR1

      668    14701    2              SEG$2.FPT_WRITE$ -> FPT$WRITE.BUF_.BOUND = POFFC (DEST$, OUTBUFF$);
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:112  

  14701  2 002143   000165 471500                    LDP1    117,,PR0
         2 002144   200411 236100                    LDQ     OUTBUFF$,,AUTO
         2 002145   000020 772000                    QRL     16
         2 002146   201010 756100                    STQ     TLEN+2,,AUTO
         2 002147   200412 236100                    LDQ     DEST$,,AUTO
         2 002150   000020 772000                    QRL     16
         2 002151   201010 136100                    SBLQ    TLEN+2,,AUTO
         2 002152   000020 736000                    QLS     16
         2 002153   100004 676100                    ERQ     4,,PR1
         2 002154   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 002155   100004 656100                    ERSQ    4,,PR1

      669    14702    2              CALL CONCAT (INBUFF, '  Line speed = ',

  14702  2 002156   200740 236100                    LDQ     VLP_LINEATTR,,AUTO
         2 002157   000022 772000                    QRL     18
         2 002160   000777 376007                    ANQ     511,DL
         2 002161   000005 402007                    MPY     5,DL
         2 002162   040100 100400                    MLR     fill='040'O
         2 002163   000416 000017 1                  ADSC9   E_NOSUCHSTRM+17          cn=0,n=15
         2 002164   200421 000017                    ADSC9   INBUFF,,AUTO             cn=0,n=15
         2 002165   040100 100406                    MLR     fill='040'O
         2 002166   000000 000005 1                  ADSC9   LSPEED_TABLE,Q           cn=0,n=5
         2 002167   200424 600151                    ADSC9   INBUFF+3,,AUTO           cn=3,n=105

      670    14703    2               LSPEED_TABLE(VLP_LINEATTR.LINESPEED#));
      671    14704    2              CALL INDEX (LEN, '   ', INBUFF);

  14704  2 002170   200457 631500                    EPPR1   LEN,,AUTO
         2 002171   000376 633400 1                  EPPR3   E_NOSUCHSTRM+1
         2 002172   000003 223003                    LDX3    3,DU
         2 002173   200421 630500                    EPPR0   INBUFF,,AUTO
         2 002174   000170 220003                    LDX0    120,DU
         2 002175   000000 236003                    LDQ     0,DU
         2 002176   000000 701000 xent               TSX1    X66_INDEX
         2 002177   000000 011000                    NOP     0
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:113  

      672    14705    2              CALL CPB$BLDIMAGE (OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET (TERM70);

  14705  2 002200   200460 630500                    EPPR0   TAB_VAL,,AUTO
         2 002201   201014 450500                    STP0    TLEN+6,,AUTO
         2 002202   200457 631500                    EPPR1   LEN,,AUTO
         2 002203   201013 451500                    STP1    TLEN+5,,AUTO
         2 002204   200413 633500                    EPPR3   IN$,,AUTO
         2 002205   201012 453500                    STP3    TLEN+4,,AUTO
         2 002206   200412 634500                    EPPR4   DEST$,,AUTO
         2 002207   201011 454500                    STP4    TLEN+3,,AUTO
         2 002210   200411 635500                    EPPR5   OUTBUFF$,,AUTO
         2 002211   201010 455500                    STP5    TLEN+2,,AUTO
         2 002212   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 002213   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 002214   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 002215   004514 702000 2                  TSX2    TERM70

      673    14706    2              CALL CONCAT (INBUFF, '  Parity = ', LPARITY_TYPE (VLP_TRMATTR.PARITY#));

  14706  2 002216   200761 236100                    LDQ     VLP_TRMATTR+1,,AUTO
         2 002217   000033 772000                    QRL     27
         2 002220   000007 376007                    ANQ     7,DL
         2 002221   040100 100400                    MLR     fill='040'O
         2 002222   000422 000013 1                  ADSC9   E_NOSUCHSTRM+21          cn=0,n=11
         2 002223   200421 000013                    ADSC9   INBUFF,,AUTO             cn=0,n=11
         2 002224   000002 736000                    QLS     2
         2 002225   040100 100406                    MLR     fill='040'O
         2 002226   000332 000004 1                  ADSC9   LPARITY_TYPE,Q           cn=0,n=4
         2 002227   200423 600155                    ADSC9   INBUFF+2,,AUTO           cn=3,n=109

      674    14707    2              CALL INDEX (LEN, '   ', INBUFF);

  14707  2 002230   200457 631500                    EPPR1   LEN,,AUTO
         2 002231   000376 633400 1                  EPPR3   E_NOSUCHSTRM+1
         2 002232   000003 223003                    LDX3    3,DU
         2 002233   200421 630500                    EPPR0   INBUFF,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:114  
         2 002234   000170 220003                    LDX0    120,DU
         2 002235   000000 236003                    LDQ     0,DU
         2 002236   000000 701000 xent               TSX1    X66_INDEX
         2 002237   000000 011000                    NOP     0

      675    14708    2              CALL CPB$BLDIMAGE (OUTBUFF$, DEST$, IN$, LEN, TAB_VAL) ALTRET (TERM70);

  14708  2 002240   200460 630500                    EPPR0   TAB_VAL,,AUTO
         2 002241   201014 450500                    STP0    TLEN+6,,AUTO
         2 002242   200457 631500                    EPPR1   LEN,,AUTO
         2 002243   201013 451500                    STP1    TLEN+5,,AUTO
         2 002244   200413 633500                    EPPR3   IN$,,AUTO
         2 002245   201012 453500                    STP3    TLEN+4,,AUTO
         2 002246   200412 634500                    EPPR4   DEST$,,AUTO
         2 002247   201011 454500                    STP4    TLEN+3,,AUTO
         2 002250   200411 635500                    EPPR5   OUTBUFF$,,AUTO
         2 002251   201010 455500                    STP5    TLEN+2,,AUTO
         2 002252   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 002253   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 002254   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 002255   004514 702000 2                  TSX2    TERM70

      676    14709    2              IF VLP_TRMATTR.DVCFLWCTRALG# ~= 0

  14709  2 002256   200762 236100                    LDQ     VLP_TRMATTR+2,,AUTO
         2 002257   000007 316007                    CANQ    7,DL
         2 002260   002320 600000 2                  TZE     s:14715

      677    14710    3               THEN DO;

      678    14711    3                CALL CONCAT (INBUFF, '  DvcFlwCtrAlg = ', LDVCFLWCTRALG(VLP_TRMATTR.
             14711                         DVCFLWCTRALG#));

  14711  2 002261   200762 236100                    LDQ     VLP_TRMATTR+2,,AUTO
         2 002262   000007 376007                    ANQ     7,DL
         2 002263   040100 100400                    MLR     fill='040'O
         2 002264   000425 000021 1                  ADSC9   E_NOSUCHSTRM+24          cn=0,n=17
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:115  
         2 002265   200421 000021                    ADSC9   INBUFF,,AUTO             cn=0,n=17
         2 002266   000006 402007                    MPY     6,DL
         2 002267   040100 100406                    MLR     fill='040'O
         2 002270   000342 000006 1                  ADSC9   LDVCFLWCTRALG,Q          cn=0,n=6
         2 002271   200425 200147                    ADSC9   INBUFF+4,,AUTO           cn=1,n=103

      679    14712    3                CALL INDEX (LEN, '   ', INBUFF);

  14712  2 002272   200457 631500                    EPPR1   LEN,,AUTO
         2 002273   000376 633400 1                  EPPR3   E_NOSUCHSTRM+1
         2 002274   000003 223003                    LDX3    3,DU
         2 002275   200421 630500                    EPPR0   INBUFF,,AUTO
         2 002276   000170 220003                    LDX0    120,DU
         2 002277   000000 236003                    LDQ     0,DU
         2 002300   000000 701000 xent               TSX1    X66_INDEX
         2 002301   000000 011000                    NOP     0

      680    14713    3                CALL CPB$BLDIMAGE (OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET (TERM70);

  14713  2 002302   200460 630500                    EPPR0   TAB_VAL,,AUTO
         2 002303   201014 450500                    STP0    TLEN+6,,AUTO
         2 002304   200457 631500                    EPPR1   LEN,,AUTO
         2 002305   201013 451500                    STP1    TLEN+5,,AUTO
         2 002306   200413 633500                    EPPR3   IN$,,AUTO
         2 002307   201012 453500                    STP3    TLEN+4,,AUTO
         2 002310   200412 634500                    EPPR4   DEST$,,AUTO
         2 002311   201011 454500                    STP4    TLEN+3,,AUTO
         2 002312   200411 635500                    EPPR5   OUTBUFF$,,AUTO
         2 002313   201010 455500                    STP5    TLEN+2,,AUTO
         2 002314   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 002315   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 002316   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 002317   004514 702000 2                  TSX2    TERM70

      681    14714    3                END;

      682    14715    2              CALL CONCAT (INBUFF, '  Profile name = ',
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:116  

  14715  2 002320   200742 236100                    LDQ     VLP_LINEATTR+2,,AUTO
         2 002321   000033 772000                    QRL     27
         2 002322   040100 100400                    MLR     fill='040'O
         2 002323   000432 000021 1                  ADSC9   E_NOSUCHSTRM+29          cn=0,n=17
         2 002324   200421 000021                    ADSC9   INBUFF,,AUTO             cn=0,n=17
         2 002325   000000 620006                    EAX0    0,QL
         2 002326   040100 100540                    MLR     fill='040'O
         2 002327   200742 200010                    ADSC9   VLP_LINEATTR+2,,AUTO     cn=1,n=*X0
         2 002330   200425 200147                    ADSC9   INBUFF+4,,AUTO           cn=1,n=103

      683    14716    2               SUBSTR(VLP_LINEATTR.PROTXTC.TXT, 0, VLP_LINEATTR.PROTXTC.CNT));
      684    14717    2              CALL INDEX (LEN, '   ', INBUFF);

  14717  2 002331   200457 631500                    EPPR1   LEN,,AUTO
         2 002332   000376 633400 1                  EPPR3   E_NOSUCHSTRM+1
         2 002333   000003 223003                    LDX3    3,DU
         2 002334   200421 630500                    EPPR0   INBUFF,,AUTO
         2 002335   000170 220003                    LDX0    120,DU
         2 002336   000000 236003                    LDQ     0,DU
         2 002337   000000 701000 xent               TSX1    X66_INDEX
         2 002340   000000 011000                    NOP     0

      685    14718    2              CALL CPB$BLDIMAGE (OUTBUFF$, DEST$, IN$, LEN, TAB_VAL) ALTRET (TERM70);

  14718  2 002341   200460 630500                    EPPR0   TAB_VAL,,AUTO
         2 002342   201014 450500                    STP0    TLEN+6,,AUTO
         2 002343   200457 631500                    EPPR1   LEN,,AUTO
         2 002344   201013 451500                    STP1    TLEN+5,,AUTO
         2 002345   200413 633500                    EPPR3   IN$,,AUTO
         2 002346   201012 453500                    STP3    TLEN+4,,AUTO
         2 002347   200412 634500                    EPPR4   DEST$,,AUTO
         2 002350   201011 454500                    STP4    TLEN+3,,AUTO
         2 002351   200411 635500                    EPPR5   OUTBUFF$,,AUTO
         2 002352   201010 455500                    STP5    TLEN+2,,AUTO
         2 002353   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 002354   000023 631400 xsym               EPPR1   B_VECTNIL+19
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:117  
         2 002355   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 002356   004514 702000 2                  TSX2    TERM70

      686    14719    2              CALL CONCAT (INBUFF, '  FcnTbl = ', VLP_TRMATTR.FCNTBL#);

  14719  2 002357   040100 100400                    MLR     fill='040'O
         2 002360   000437 000013 1                  ADSC9   E_NOSUCHSTRM+34          cn=0,n=11
         2 002361   200421 000013                    ADSC9   INBUFF,,AUTO             cn=0,n=11
         2 002362   040100 100500                    MLR     fill='040'O
         2 002363   200765 000010                    ADSC9   VLP_TRMATTR+5,,AUTO      cn=0,n=8
         2 002364   200423 600155                    ADSC9   INBUFF+2,,AUTO           cn=3,n=109

      687    14720    2              CALL INDEX (LEN, '   ', INBUFF);

  14720  2 002365   200457 631500                    EPPR1   LEN,,AUTO
         2 002366   000376 633400 1                  EPPR3   E_NOSUCHSTRM+1
         2 002367   000003 223003                    LDX3    3,DU
         2 002370   200421 630500                    EPPR0   INBUFF,,AUTO
         2 002371   000170 220003                    LDX0    120,DU
         2 002372   000000 236003                    LDQ     0,DU
         2 002373   000000 701000 xent               TSX1    X66_INDEX
         2 002374   000000 011000                    NOP     0

      688    14721    2              CALL CPB$BLDIMAGE (OUTBUFF$, DEST$, IN$, LEN, TAB_VAL) ALTRET (TERM70);

  14721  2 002375   200460 630500                    EPPR0   TAB_VAL,,AUTO
         2 002376   201014 450500                    STP0    TLEN+6,,AUTO
         2 002377   200457 631500                    EPPR1   LEN,,AUTO
         2 002400   201013 451500                    STP1    TLEN+5,,AUTO
         2 002401   200413 633500                    EPPR3   IN$,,AUTO
         2 002402   201012 453500                    STP3    TLEN+4,,AUTO
         2 002403   200412 634500                    EPPR4   DEST$,,AUTO
         2 002404   201011 454500                    STP4    TLEN+3,,AUTO
         2 002405   200411 635500                    EPPR5   OUTBUFF$,,AUTO
         2 002406   201010 455500                    STP5    TLEN+2,,AUTO
         2 002407   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 002410   000023 631400 xsym               EPPR1   B_VECTNIL+19
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:118  
         2 002411   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 002412   004514 702000 2                  TSX2    TERM70

      689    14722    2              CALL CONCAT (INBUFF, '  CharSetName = ', VLP_TRMATTR.CHARSETNAME#);

  14722  2 002413   040100 100400                    MLR     fill='040'O
         2 002414   000442 000020 1                  ADSC9   E_NOSUCHSTRM+37          cn=0,n=16
         2 002415   200421 000020                    ADSC9   INBUFF,,AUTO             cn=0,n=16
         2 002416   040100 100500                    MLR     fill='040'O
         2 002417   200763 000010                    ADSC9   VLP_TRMATTR+3,,AUTO      cn=0,n=8
         2 002420   200425 000150                    ADSC9   INBUFF+4,,AUTO           cn=0,n=104

      690    14723    2              CALL INDEX (LEN, '   ', INBUFF);

  14723  2 002421   200457 631500                    EPPR1   LEN,,AUTO
         2 002422   000376 633400 1                  EPPR3   E_NOSUCHSTRM+1
         2 002423   000003 223003                    LDX3    3,DU
         2 002424   200421 630500                    EPPR0   INBUFF,,AUTO
         2 002425   000170 220003                    LDX0    120,DU
         2 002426   000000 236003                    LDQ     0,DU
         2 002427   000000 701000 xent               TSX1    X66_INDEX
         2 002430   000000 011000                    NOP     0

      691    14724    2              CALL CPB$BLDIMAGE (OUTBUFF$, DEST$, IN$, LEN, TAB_VAL) ALTRET (TERM70);

  14724  2 002431   200460 630500                    EPPR0   TAB_VAL,,AUTO
         2 002432   201014 450500                    STP0    TLEN+6,,AUTO
         2 002433   200457 631500                    EPPR1   LEN,,AUTO
         2 002434   201013 451500                    STP1    TLEN+5,,AUTO
         2 002435   200413 633500                    EPPR3   IN$,,AUTO
         2 002436   201012 453500                    STP3    TLEN+4,,AUTO
         2 002437   200412 634500                    EPPR4   DEST$,,AUTO
         2 002440   201011 454500                    STP4    TLEN+3,,AUTO
         2 002441   200411 635500                    EPPR5   OUTBUFF$,,AUTO
         2 002442   201010 455500                    STP5    TLEN+2,,AUTO
         2 002443   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 002444   000023 631400 xsym               EPPR1   B_VECTNIL+19
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:119  
         2 002445   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 002446   004514 702000 2                  TSX2    TERM70

      692    14725    2              CALL PUT_DECIMAL(BINBIT(VLP_TRMCTL.AUTOTABCLM#, 36), 'AutoTabClm',
             14725                       LENGTHC('AutoTabClm')) ALTRET (TERM70);

  14725  2 002447   200722 236100                    LDQ     VLP_TRMCTL+2,,AUTO
         2 002450   000777 376007                    ANQ     511,DL
         2 002451   201016 756100                    STQ     TLEN+8,,AUTO
         2 002452   000050 237000 3                  LDAQ    40
         2 002453   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 002454   201016 630500                    EPPR0   TLEN+8,,AUTO
         2 002455   200773 450500                    STP0    VLP_TRMATTR+11,,AUTO
         2 002456   005772 701000 2                  TSX1    PUT_DECIMAL
         2 002457   004514 702000 2                  TSX2    TERM70

      693    14726    2              IF HAVE_WINDOW

  14726  2 002460   200417 234100                    SZN     HAVE_WINDOW,,AUTO
         2 002461   002473 605000 2                  TPL     s:14729

      694    14727    2                THEN
      695    14728    2                 CALL PUT_DECIMAL(BINBIT(VLP_WINDOW.ORG_PST.COLUMN,36), 'Column',
             14728                          LENGTHC('Column')) ALTRET (TERM70);

  14728  2 002462   200732 236100                    LDQ     VLP_WINDOW+2,,AUTO
         2 002463   777777 376007                    ANQ     -1,DL
         2 002464   201020 756100                    STQ     TLEN+10,,AUTO
         2 002465   000052 237000 3                  LDAQ    42
         2 002466   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 002467   201020 630500                    EPPR0   TLEN+10,,AUTO
         2 002470   200773 450500                    STP0    VLP_TRMATTR+11,,AUTO
         2 002471   005772 701000 2                  TSX1    PUT_DECIMAL
         2 002472   004514 702000 2                  TSX2    TERM70

      696    14729    2             CALL PUT_DECIMAL(BINBIT(VLP_TRMATTR.DSPHEIGHT#,36), 'DspHeight', LENGTHC(
             14729                       'DspHeight')) ALTRET (TERM70);
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:120  

  14729  2 002473   200767 236100                    LDQ     VLP_TRMATTR+7,,AUTO
         2 002474   000022 772000                    QRL     18
         2 002475   000777 376007                    ANQ     511,DL
         2 002476   201022 756100                    STQ     TLEN+12,,AUTO
         2 002477   000054 237000 3                  LDAQ    44
         2 002500   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 002501   201022 630500                    EPPR0   TLEN+12,,AUTO
         2 002502   200773 450500                    STP0    VLP_TRMATTR+11,,AUTO
         2 002503   005772 701000 2                  TSX1    PUT_DECIMAL
         2 002504   004514 702000 2                  TSX2    TERM70

      697    14730    2              IF HAVE_WINDOW

  14730  2 002505   200417 234100                    SZN     HAVE_WINDOW,,AUTO
         2 002506   002567 605000 2                  TPL     s:14742

      698    14731    3                THEN DO;

      699    14732    3                 IF VLP_WINDOW.HBRDRCHR# ~= BINASC(0)

  14732  2 002507   200733 236100                    LDQ     VLP_WINDOW+3,,AUTO
         2 002510   000777 376003                    ANQ     511,DU
         2 002511   000000 116003                    CMPQ    0,DU
         2 002512   002552 600000 2                  TZE     s:14738

      700    14733    4                   THEN DO;

      701    14734    4                    CALL CONCAT (INBUFF, ' HBrdrChr = ''', VLP_WINDOW.HBRDRCHR#, '''')
             14734                             ;

  14734  2 002513   040100 100400                    MLR     fill='040'O
         2 002514   000456 000016 1                  ADSC9   E_NOSUCHSTRM+49          cn=0,n=14
         2 002515   200421 000016                    ADSC9   INBUFF,,AUTO             cn=0,n=14
         2 002516   200733 236100                    LDQ     VLP_WINDOW+3,,AUTO
         2 002517   000011 772000                    QRL     9
         2 002520   200424 552110                    STBQ    INBUFF+3,'10'O,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:121  
         2 002521   040100 100400                    MLR     fill='040'O
         2 002522   000056 000001 3                  ADSC9   46                       cn=0,n=1
         2 002523   200424 600151                    ADSC9   INBUFF+3,,AUTO           cn=3,n=105

      702    14735    4                    CALL INDEX (LEN, '   ', INBUFF);

  14735  2 002524   200457 631500                    EPPR1   LEN,,AUTO
         2 002525   000376 633400 1                  EPPR3   E_NOSUCHSTRM+1
         2 002526   000003 223003                    LDX3    3,DU
         2 002527   200421 630500                    EPPR0   INBUFF,,AUTO
         2 002530   000170 220003                    LDX0    120,DU
         2 002531   000000 236003                    LDQ     0,DU
         2 002532   000000 701000 xent               TSX1    X66_INDEX
         2 002533   000000 011000                    NOP     0

      703    14736    4                    CALL CPB$BLDIMAGE (OUTBUFF$, DEST$, IN$, LEN, TAB_VAL) ALTRET (
             14736                             TERM70);

  14736  2 002534   200460 630500                    EPPR0   TAB_VAL,,AUTO
         2 002535   201014 450500                    STP0    TLEN+6,,AUTO
         2 002536   200457 631500                    EPPR1   LEN,,AUTO
         2 002537   201013 451500                    STP1    TLEN+5,,AUTO
         2 002540   200413 633500                    EPPR3   IN$,,AUTO
         2 002541   201012 453500                    STP3    TLEN+4,,AUTO
         2 002542   200412 634500                    EPPR4   DEST$,,AUTO
         2 002543   201011 454500                    STP4    TLEN+3,,AUTO
         2 002544   200411 635500                    EPPR5   OUTBUFF$,,AUTO
         2 002545   201010 455500                    STP5    TLEN+2,,AUTO
         2 002546   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 002547   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 002550   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 002551   004514 702000 2                  TSX2    TERM70

      704    14737    4                    END;

      705    14738    3                 IF VLP_WINDOW.HBRDRSIZ# ~= 0

PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:122  
  14738  2 002552   200733 236100                    LDQ     VLP_WINDOW+3,,AUTO
         2 002553   017000 316003                    CANQ    7680,DU
         2 002554   002567 600000 2                  TZE     s:14742

      706    14739    3                   THEN
      707    14740    3                    CALL PUT_DECIMAL (BINBIT(VLP_WINDOW.HBRDRSIZ#,36), 'HBrdrSiz',
             14740                             LENGTHC('HBrdrSiz')) ALTRET (TERM70);

  14740  2 002555   200733 236100                    LDQ     VLP_WINDOW+3,,AUTO
         2 002556   000033 772000                    QRL     27
         2 002557   000017 376007                    ANQ     15,DL
         2 002560   201024 756100                    STQ     TLEN+14,,AUTO
         2 002561   000060 237000 3                  LDAQ    48
         2 002562   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 002563   201024 630500                    EPPR0   TLEN+14,,AUTO
         2 002564   200773 450500                    STP0    VLP_TRMATTR+11,,AUTO
         2 002565   005772 701000 2                  TSX1    PUT_DECIMAL
         2 002566   004514 702000 2                  TSX2    TERM70

      708    14741    3                 END;

      709    14742    2              CALL PUT_DECIMAL(BINBIT(VLP_TRMATTR.HEIGHT#, 36), 'Height', LENGTHC(
             14742                       'Height')) ALTRET (TERM70);

  14742  2 002567   200762 236100                    LDQ     VLP_TRMATTR+2,,AUTO
         2 002570   000033 772000                    QRL     27
         2 002571   000377 376007                    ANQ     255,DL
         2 002572   201026 756100                    STQ     TLEN+16,,AUTO
         2 002573   000062 237000 3                  LDAQ    50
         2 002574   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 002575   201026 630500                    EPPR0   TLEN+16,,AUTO
         2 002576   200773 450500                    STP0    VLP_TRMATTR+11,,AUTO
         2 002577   005772 701000 2                  TSX1    PUT_DECIMAL
         2 002600   004514 702000 2                  TSX2    TERM70

      710    14743    2              CALL PUT_DECIMAL(BINBIT(VLP_TRMCTL.HSMARGIN#, 36), 'HSMargin', LENGTHC(
             14743                       'HSMargin')) ALTRET (TERM70);
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:123  

  14743  2 002601   200723 236100                    LDQ     VLP_TRMCTL+3,,AUTO
         2 002602   000033 772000                    QRL     27
         2 002603   201030 756100                    STQ     TLEN+18,,AUTO
         2 002604   000064 237000 3                  LDAQ    52
         2 002605   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 002606   201030 630500                    EPPR0   TLEN+18,,AUTO
         2 002607   200773 450500                    STP0    VLP_TRMATTR+11,,AUTO
         2 002610   005772 701000 2                  TSX1    PUT_DECIMAL
         2 002611   004514 702000 2                  TSX2    TERM70

      711    14744    2              CALL PUT_DECIMAL(BINBIT(VLP_TRMCTL.HSSHIFT#, 36), 'HSShift', LENGTHC(
             14744                       'HSShift')) ALTRET (TERM70);

  14744  2 002612   200723 236100                    LDQ     VLP_TRMCTL+3,,AUTO
         2 002613   000022 772000                    QRL     18
         2 002614   000777 376007                    ANQ     511,DL
         2 002615   201032 756100                    STQ     TLEN+20,,AUTO
         2 002616   000066 237000 3                  LDAQ    54
         2 002617   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 002620   201032 630500                    EPPR0   TLEN+20,,AUTO
         2 002621   200773 450500                    STP0    VLP_TRMATTR+11,,AUTO
         2 002622   005772 701000 2                  TSX1    PUT_DECIMAL
         2 002623   004514 702000 2                  TSX2    TERM70

      712    14745    2              IF HAVE_EDTCTL

  14745  2 002624   200416 234100                    SZN     HAVE_EDTCTL,,AUTO
         2 002625   002705 605000 2                  TPL     s:14755

      713    14746    3                THEN DO;

      714    14747    3                 CALL PUT_DECIMAL(BINBIT(VLP_EDTCTL.KEYINCR#, 36), 'KeyIncr', LENGTHC(
             14747                          'KeyIncr')) ALTRET (TERM70);

  14747  2 002626   200725 236100                    LDQ     VLP_EDTCTL+1,,AUTO
         2 002627   777777 376007                    ANQ     -1,DL
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:124  
         2 002630   201034 756100                    STQ     TLEN+22,,AUTO
         2 002631   000070 237000 3                  LDAQ    56
         2 002632   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 002633   201034 630500                    EPPR0   TLEN+22,,AUTO
         2 002634   200773 450500                    STP0    VLP_TRMATTR+11,,AUTO
         2 002635   005772 701000 2                  TSX1    PUT_DECIMAL
         2 002636   004514 702000 2                  TSX2    TERM70

      715    14748    3                 INBUFF = '  KeyType = ';

  14748  2 002637   040100 100400                    MLR     fill='040'O
         2 002640   000474 000014 1                  ADSC9   E_NOSUCHSTRM+63          cn=0,n=12
         2 002641   200421 000170                    ADSC9   INBUFF,,AUTO             cn=0,n=120

      716    14749    3                 CALL CPB$BLDIMAGE (OUTBUFF$, DEST$, IN$, SIZEC('  LeyType = '))

  14749  2 002642   000036 236000 3                  LDQ     30
         2 002643   201013 756100                    STQ     TLEN+5,,AUTO
         2 002644   200413 630500                    EPPR0   IN$,,AUTO
         2 002645   201012 450500                    STP0    TLEN+4,,AUTO
         2 002646   200412 631500                    EPPR1   DEST$,,AUTO
         2 002647   201011 451500                    STP1    TLEN+3,,AUTO
         2 002650   200411 633500                    EPPR3   OUTBUFF$,,AUTO
         2 002651   201010 453500                    STP3    TLEN+2,,AUTO
         2 002652   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 002653   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 002654   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 002655   004514 702000 2                  TSX2    TERM70

      717    14750    3                   ALTRET (TERM70);
      718    14751    3                 INBUFF = LKEYTYPE(VLP_EDTCTL.KEYTYPE#);

  14751  2 002656   200724 236100                    LDQ     VLP_EDTCTL,,AUTO
         2 002657   000022 772000                    QRL     18
         2 002660   000777 376007                    ANQ     511,DL
         2 002661   000006 402007                    MPY     6,DL
         2 002662   040100 100406                    MLR     fill='040'O
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:125  
         2 002663   000356 000006 1                  ADSC9   LKEYTYPE,Q               cn=0,n=6
         2 002664   200421 000170                    ADSC9   INBUFF,,AUTO             cn=0,n=120

      719    14752    3                 CALL INDEX (LEN, ' ', INBUFF);

  14752  2 002665   000000 124500                    SCM     mask='000'O
         2 002666   200421 000170                    ADSC9   INBUFF,,AUTO             cn=0,n=120
         2 002667   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 002670   200457 000100                    ARG     LEN,,AUTO

      720    14753    3                 CALL CPB$BLDIMAGE (OUTBUFF$, DEST$, IN$, LEN) ALTRET (TERM70);

  14753  2 002671   200457 630500                    EPPR0   LEN,,AUTO
         2 002672   201013 450500                    STP0    TLEN+5,,AUTO
         2 002673   200413 631500                    EPPR1   IN$,,AUTO
         2 002674   201012 451500                    STP1    TLEN+4,,AUTO
         2 002675   200412 633500                    EPPR3   DEST$,,AUTO
         2 002676   201011 453500                    STP3    TLEN+3,,AUTO
         2 002677   200411 634500                    EPPR4   OUTBUFF$,,AUTO
         2 002700   201010 454500                    STP4    TLEN+2,,AUTO
         2 002701   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 002702   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 002703   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 002704   004514 702000 2                  TSX2    TERM70

      721    14754    3                 END;

      722    14755    2              IF HAVE_WINDOW

  14755  2 002705   200417 234100                    SZN     HAVE_WINDOW,,AUTO
         2 002706   002721 605000 2                  TPL     s:14758

      723    14756    2                THEN
      724    14757    2                 CALL PUT_DECIMAL(BINBIT(VLP_WINDOW.ORG_PST.LINE,36), 'Line', LENGTHC(
             14757                          'Line')) ALTRET (TERM70);

  14757  2 002707   200732 236100                    LDQ     VLP_WINDOW+2,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:126  
         2 002710   000022 772000                    QRL     18
         2 002711   000777 376007                    ANQ     511,DL
         2 002712   201036 756100                    STQ     TLEN+24,,AUTO
         2 002713   000072 237000 3                  LDAQ    58
         2 002714   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 002715   201036 630500                    EPPR0   TLEN+24,,AUTO
         2 002716   200773 450500                    STP0    VLP_TRMATTR+11,,AUTO
         2 002717   005772 701000 2                  TSX1    PUT_DECIMAL
         2 002720   004514 702000 2                  TSX2    TERM70

      725    14758    2              CALL PUT_DECIMAL(BINBIT(VLP_TRMATTR.MAXATRS#, 36), 'MaxAtrs', LENGTHC(
             14758                       'MaxAtrs')) ALTRET (TERM70);

  14758  2 002721   200767 236100                    LDQ     VLP_TRMATTR+7,,AUTO
         2 002722   000033 772000                    QRL     27
         2 002723   201040 756100                    STQ     TLEN+26,,AUTO
         2 002724   000074 237000 3                  LDAQ    60
         2 002725   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 002726   201040 630500                    EPPR0   TLEN+26,,AUTO
         2 002727   200773 450500                    STP0    VLP_TRMATTR+11,,AUTO
         2 002730   005772 701000 2                  TSX1    PUT_DECIMAL
         2 002731   004514 702000 2                  TSX2    TERM70

      726    14759    2              IF HAVE_WINDOW

  14759  2 002732   200417 234100                    SZN     HAVE_WINDOW,,AUTO
         2 002733   002745 605000 2                  TPL     s:14762

      727    14760    2                THEN
      728    14761    2                 CALL PUT_DECIMAL(BINBIT(VLP_WINDOW.MINLENGTH#,36), 'MinLength',
             14761                          LENGTHC('MinLength')) ALTRET (TERM70);

  14761  2 002734   200734 236100                    LDQ     VLP_WINDOW+4,,AUTO
         2 002735   000033 772000                    QRL     27
         2 002736   201042 756100                    STQ     TLEN+28,,AUTO
         2 002737   000076 237000 3                  LDAQ    62
         2 002740   200774 757100                    STAQ    @DECIMAL+1,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:127  
         2 002741   201042 630500                    EPPR0   TLEN+28,,AUTO
         2 002742   200773 450500                    STP0    VLP_TRMATTR+11,,AUTO
         2 002743   005772 701000 2                  TSX1    PUT_DECIMAL
         2 002744   004514 702000 2                  TSX2    TERM70

      729    14762    2              CALL PUT_DECIMAL(BINBIT(VLP_TRMATTR.MINREC#, 36), 'MinRec', LENGTHC(
             14762                       'MinRec')) ALTRET (TERM70);

  14762  2 002745   200762 236100                    LDQ     VLP_TRMATTR+2,,AUTO
         2 002746   000022 772000                    QRL     18
         2 002747   000377 376007                    ANQ     255,DL
         2 002750   201044 756100                    STQ     TLEN+30,,AUTO
         2 002751   000100 237000 3                  LDAQ    64
         2 002752   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 002753   201044 630500                    EPPR0   TLEN+30,,AUTO
         2 002754   200773 450500                    STP0    VLP_TRMATTR+11,,AUTO
         2 002755   005772 701000 2                  TSX1    PUT_DECIMAL
         2 002756   004514 702000 2                  TSX2    TERM70

      730    14763    2              IF HAVE_WINDOW

  14763  2 002757   200417 234100                    SZN     HAVE_WINDOW,,AUTO
         2 002760   002773 605000 2                  TPL     s:14767

      731    14764    2                THEN
      732    14765    2                CALL PUT_DECIMAL(BINBIT(VLP_WINDOW.MINWIDTH#,36), 'MinWidth', LENGTHC(
             14765                          'MinWidth')) ALTRET (TERM70);

  14765  2 002761   200734 236100                    LDQ     VLP_WINDOW+4,,AUTO
         2 002762   000022 772000                    QRL     18
         2 002763   000777 376007                    ANQ     511,DL
         2 002764   201046 756100                    STQ     TLEN+32,,AUTO
         2 002765   000102 237000 3                  LDAQ    66
         2 002766   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 002767   201046 630500                    EPPR0   TLEN+32,,AUTO
         2 002770   200773 450500                    STP0    VLP_TRMATTR+11,,AUTO
         2 002771   005772 701000 2                  TSX1    PUT_DECIMAL
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:128  
         2 002772   004514 702000 2                  TSX2    TERM70

      733    14766        /*        CALL PUT_DECIMAL(BINBIT(VLP_TRMATTR.RMARGIN#, 36), 'RMargin', LENGTHC('RM
             14766        argin')) ALTRET (TERM70); */
      734    14767    2              IF VLP_TRMCTL.SINPUTSZ# ~= SINPUTDFLT

  14767  2 002773   200721 236100                    LDQ     VLP_TRMCTL+1,,AUTO
         2 002774   377000 316007                    CANQ    130560,DL
         2 002775   003010 600000 2                  TZE     s:14770

      735    14768    2                THEN
      736    14769    2                 CALL PUT_DECIMAL (BINBIT(VLP_TRMCTL.SINPUTSZ#, 36), 'SInputSz',
             14769                          LENGTHC('SInputSz')) ALTRET (TERM70);

  14769  2 002776   200721 236100                    LDQ     VLP_TRMCTL+1,,AUTO
         2 002777   000011 772000                    QRL     9
         2 003000   000377 376007                    ANQ     255,DL
         2 003001   201050 756100                    STQ     TLEN+34,,AUTO
         2 003002   000104 237000 3                  LDAQ    68
         2 003003   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003004   201050 630500                    EPPR0   TLEN+34,,AUTO
         2 003005   200773 450500                    STP0    VLP_TRMATTR+11,,AUTO
         2 003006   005772 701000 2                  TSX1    PUT_DECIMAL
         2 003007   004514 702000 2                  TSX2    TERM70

      737    14770    2              IF HAVE_WINDOW

  14770  2 003010   200417 234100                    SZN     HAVE_WINDOW,,AUTO
         2 003011   003072 605000 2                  TPL     s:14782

      738    14771    3                THEN DO;

      739    14772    3                 IF VLP_WINDOW.VBRDRCHR# ~= BINASC(0)

  14772  2 003012   200733 236100                    LDQ     VLP_WINDOW+3,,AUTO
         2 003013   000777 376007                    ANQ     511,DL
         2 003014   000000 116003                    CMPQ    0,DU
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:129  
         2 003015   003055 600000 2                  TZE     s:14778

      740    14773    4                   THEN DO;

      741    14774    4                    CALL CONCAT (INBUFF, ' VBrdrChr = ''', VLP_WINDOW.VBRDRCHR#, '''')
             14774                             ;

  14774  2 003016   040100 100400                    MLR     fill='040'O
         2 003017   000516 000016 1                  ADSC9   E_NOSUCHSTRM+81          cn=0,n=14
         2 003020   200421 000016                    ADSC9   INBUFF,,AUTO             cn=0,n=14
         2 003021   200733 236100                    LDQ     VLP_WINDOW+3,,AUTO
         2 003022   000011 736000                    QLS     9
         2 003023   200424 552110                    STBQ    INBUFF+3,'10'O,AUTO
         2 003024   040100 100400                    MLR     fill='040'O
         2 003025   000056 000001 3                  ADSC9   46                       cn=0,n=1
         2 003026   200424 600151                    ADSC9   INBUFF+3,,AUTO           cn=3,n=105

      742    14775    4                    CALL INDEX (LEN, '   ', INBUFF);

  14775  2 003027   200457 631500                    EPPR1   LEN,,AUTO
         2 003030   000376 633400 1                  EPPR3   E_NOSUCHSTRM+1
         2 003031   000003 223003                    LDX3    3,DU
         2 003032   200421 630500                    EPPR0   INBUFF,,AUTO
         2 003033   000170 220003                    LDX0    120,DU
         2 003034   000000 236003                    LDQ     0,DU
         2 003035   000000 701000 xent               TSX1    X66_INDEX
         2 003036   000000 011000                    NOP     0

      743    14776    4                    CALL CPB$BLDIMAGE (OUTBUFF$, DEST$, IN$, LEN, TAB_VAL) ALTRET (
             14776                             TERM70);

  14776  2 003037   200460 630500                    EPPR0   TAB_VAL,,AUTO
         2 003040   201014 450500                    STP0    TLEN+6,,AUTO
         2 003041   200457 631500                    EPPR1   LEN,,AUTO
         2 003042   201013 451500                    STP1    TLEN+5,,AUTO
         2 003043   200413 633500                    EPPR3   IN$,,AUTO
         2 003044   201012 453500                    STP3    TLEN+4,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:130  
         2 003045   200412 634500                    EPPR4   DEST$,,AUTO
         2 003046   201011 454500                    STP4    TLEN+3,,AUTO
         2 003047   200411 635500                    EPPR5   OUTBUFF$,,AUTO
         2 003050   201010 455500                    STP5    TLEN+2,,AUTO
         2 003051   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 003052   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 003053   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 003054   004514 702000 2                  TSX2    TERM70

      744    14777    4                    END;

      745    14778    3                 IF VLP_WINDOW.VBRDRSIZ# ~= 0

  14778  2 003055   200733 236100                    LDQ     VLP_WINDOW+3,,AUTO
         2 003056   017000 316007                    CANQ    7680,DL
         2 003057   003072 600000 2                  TZE     s:14782

      746    14779    3                   THEN
      747    14780    3                    CALL PUT_DECIMAL (BINBIT(VLP_WINDOW.VBRDRSIZ#,36), 'VBrdrSiz',
             14780                             LENGTHC('VBrdrSiz')) ALTRET (TERM70);

  14780  2 003060   200733 236100                    LDQ     VLP_WINDOW+3,,AUTO
         2 003061   000011 772000                    QRL     9
         2 003062   000017 376007                    ANQ     15,DL
         2 003063   201052 756100                    STQ     TLEN+36,,AUTO
         2 003064   000106 237000 3                  LDAQ    70
         2 003065   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003066   201052 630500                    EPPR0   TLEN+36,,AUTO
         2 003067   200773 450500                    STP0    VLP_TRMATTR+11,,AUTO
         2 003070   005772 701000 2                  TSX1    PUT_DECIMAL
         2 003071   004514 702000 2                  TSX2    TERM70

      748    14781    3                 END;

      749    14782    2              IF HAVE_EDTCTL

  14782  2 003072   200416 234100                    SZN     HAVE_EDTCTL,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:131  
         2 003073   003117 605000 2                  TPL     s:14787

      750    14783    3                THEN DO;

      751    14784    3                CALL PUT_DECIMAL(BINBIT(VLP_EDTCTL.VSMARGIN#, 36), 'VSMargin', LENGTHC
             14784                          ('VSMargin')) ALTRET (TERM70);

  14784  2 003074   200724 236100                    LDQ     VLP_EDTCTL,,AUTO
         2 003075   000011 772000                    QRL     9
         2 003076   000777 376007                    ANQ     511,DL
         2 003077   201054 756100                    STQ     TLEN+38,,AUTO
         2 003100   000110 237000 3                  LDAQ    72
         2 003101   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003102   201054 630500                    EPPR0   TLEN+38,,AUTO
         2 003103   200773 450500                    STP0    VLP_TRMATTR+11,,AUTO
         2 003104   005772 701000 2                  TSX1    PUT_DECIMAL
         2 003105   004514 702000 2                  TSX2    TERM70

      752    14785    3                 CALL PUT_DECIMAL(BINBIT(VLP_EDTCTL.VSSHIFT#, 36), 'VSShift', LENGTHC(
             14785                          'VSShift')) ALTRET (TERM70);

  14785  2 003106   200724 236100                    LDQ     VLP_EDTCTL,,AUTO
         2 003107   000777 376007                    ANQ     511,DL
         2 003110   201056 756100                    STQ     TLEN+40,,AUTO
         2 003111   000112 237000 3                  LDAQ    74
         2 003112   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003113   201056 630500                    EPPR0   TLEN+40,,AUTO
         2 003114   200773 450500                    STP0    VLP_TRMATTR+11,,AUTO
         2 003115   005772 701000 2                  TSX1    PUT_DECIMAL
         2 003116   004514 702000 2                  TSX2    TERM70

      753    14786    3                 END;

      754    14787    2              TEMP_STOR = VLP_TRMATTR.WIDTH# ;

  14787  2 003117   200761 236100                    LDQ     VLP_TRMATTR+1,,AUTO
         2 003120   000377 376007                    ANQ     255,DL
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:132  
         2 003121   200461 756100                    STQ     TEMP_STOR,,AUTO

      755    14788    2              IF VLP_TRMATTR.EXTWID#

  14788  2 003122   200761 236100                    LDQ     VLP_TRMATTR+1,,AUTO
         2 003123   010000 316003                    CANQ    4096,DU
         2 003124   003127 600000 2                  TZE     s:14791

      756    14789    2               THEN
      757    14790    2                 TEMP_STOR = TEMP_STOR + 254 ;

  14790  2 003125   000376 236007                    LDQ     254,DL
         2 003126   200461 056100                    ASQ     TEMP_STOR,,AUTO

      758    14791    2              CALL PUT_DECIMAL(TEMP_STOR, 'Width', LENGTHC('Width')) ALTRET (TERM70);

  14791  2 003127   000114 237000 3                  LDAQ    76
         2 003130   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003131   200461 630500                    EPPR0   TEMP_STOR,,AUTO
         2 003132   200773 450500                    STP0    VLP_TRMATTR+11,,AUTO
         2 003133   005772 701000 2                  TSX1    PUT_DECIMAL
         2 003134   004514 702000 2                  TSX2    TERM70

      759    14792    2              IF HAVE_WINDOW

  14792  2 003135   200417 234100                    SZN     HAVE_WINDOW,,AUTO
         2 003136   003150 605000 2                  TPL     s:14795

      760    14793    2                THEN
      761    14794    2                 CALL PUT_DECIMAL(BINBIT(VLP_WINDOW.LENGTH#,36), 'WLength', LENGTHC(
             14794                          'WLength')) ALTRET (TERM70);

  14794  2 003137   200731 236100                    LDQ     VLP_WINDOW+1,,AUTO
         2 003140   000022 732000                    QRS     18
         2 003141   201060 756100                    STQ     TLEN+42,,AUTO
         2 003142   000116 237000 3                  LDAQ    78
         2 003143   200774 757100                    STAQ    @DECIMAL+1,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:133  
         2 003144   201060 630500                    EPPR0   TLEN+42,,AUTO
         2 003145   200773 450500                    STP0    VLP_TRMATTR+11,,AUTO
         2 003146   005772 701000 2                  TSX1    PUT_DECIMAL
         2 003147   004514 702000 2                  TSX2    TERM70

      762    14795    2              CALL PUT_DECIMAL(BINBIT(VLP_TRMCTL.WORDWRAPCLM#, 36), 'WordWrapClm',
             14795                       LENGTHC('WordWrapClm')) ALTRET (TERM70);

  14795  2 003150   200722 236100                    LDQ     VLP_TRMCTL+2,,AUTO
         2 003151   000011 772000                    QRL     9
         2 003152   000777 376007                    ANQ     511,DL
         2 003153   201062 756100                    STQ     TLEN+44,,AUTO
         2 003154   000120 237000 3                  LDAQ    80
         2 003155   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003156   201062 630500                    EPPR0   TLEN+44,,AUTO
         2 003157   200773 450500                    STP0    VLP_TRMATTR+11,,AUTO
         2 003160   005772 701000 2                  TSX1    PUT_DECIMAL
         2 003161   004514 702000 2                  TSX2    TERM70

      763    14796    2              IF HAVE_WINDOW

  14796  2 003162   200417 234100                    SZN     HAVE_WINDOW,,AUTO
         2 003163   003176 605000 2                  TPL     s:14799

      764    14797    2                THEN
      765    14798    2                 CALL PUT_DECIMAL(BINBIT(VLP_WINDOW.WIDTH#,36), 'WWidth', LENGTHC(
             14798                          'WWidth')) ALTRET (TERM70);

  14798  2 003164   200731 236100                    LDQ     VLP_WINDOW+1,,AUTO
         2 003165   000022 736000                    QLS     18
         2 003166   000022 732000                    QRS     18
         2 003167   201064 756100                    STQ     TLEN+46,,AUTO
         2 003170   000122 237000 3                  LDAQ    82
         2 003171   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003172   201064 630500                    EPPR0   TLEN+46,,AUTO
         2 003173   200773 450500                    STP0    VLP_TRMATTR+11,,AUTO
         2 003174   005772 701000 2                  TSX1    PUT_DECIMAL
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:134  
         2 003175   004514 702000 2                  TSX2    TERM70

      766    14799    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$);

  14799  2 003176   000000 470400 xsym               LDP0    SEG2$
         2 003177   000165 471500                    LDP1    117,,PR0
         2 003200   200411 236100                    LDQ     OUTBUFF$,,AUTO
         2 003201   000020 772000                    QRL     16
         2 003202   201010 756100                    STQ     TLEN+2,,AUTO
         2 003203   200412 236100                    LDQ     DEST$,,AUTO
         2 003204   000020 772000                    QRL     16
         2 003205   201010 136100                    SBLQ    TLEN+2,,AUTO
         2 003206   000020 736000                    QLS     16
         2 003207   100004 676100                    ERQ     4,,PR1
         2 003210   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 003211   100004 656100                    ERSQ    4,,PR1

      767    14800    2              CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(TERM70);

  14800  2 003212   000000 236000 xsym               LDQ     SEG2$
         2 003213   000165 036003                    ADLQ    117,DU
         2 003214   201010 756100                    STQ     TLEN+2,,AUTO
         2 003215   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 003216   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 003217   000000 701000 xent               TSX1    CPE$LISTOUT
         2 003220   004514 702000 2                  TSX2    TERM70

      768    14801        /*
      769    14802          ****           Output terminal control info.
      770    14803        */
      771    14804    2              DEST$=OUTBUFF$;

  14804  2 003221   200411 236100                    LDQ     OUTBUFF$,,AUTO
         2 003222   200412 756100                    STQ     DEST$,,AUTO

      772    14805    2              FLAG_FOUND = %NO#;

PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:135  
  14805  2 003223   200420 450100                    STZ     FLAG_FOUND,,AUTO

      773    14806    2              INBUFF='      On: ';

  14806  2 003224   040100 100400                    MLR     fill='040'O
         2 003225   000541 000012 1                  ADSC9   E_NOSUCHSTRM+100         cn=0,n=10
         2 003226   200421 000170                    ADSC9   INBUFF,,AUTO             cn=0,n=120

      774    14807    2              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC('     On: ')) ALTRET (TERM70)
             14807                       ;

  14807  2 003227   000051 236000 3                  LDQ     41
         2 003230   201013 756100                    STQ     TLEN+5,,AUTO
         2 003231   200413 630500                    EPPR0   IN$,,AUTO
         2 003232   201012 450500                    STP0    TLEN+4,,AUTO
         2 003233   200412 631500                    EPPR1   DEST$,,AUTO
         2 003234   201011 451500                    STP1    TLEN+3,,AUTO
         2 003235   200411 633500                    EPPR3   OUTBUFF$,,AUTO
         2 003236   201010 453500                    STP3    TLEN+2,,AUTO
         2 003237   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 003240   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 003241   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 003242   004514 702000 2                  TSX2    TERM70

      775    14808    2              TAB_VAL = 7;

  14808  2 003243   000007 235007                    LDA     7,DL
         2 003244   200460 755100                    STA     TAB_VAL,,AUTO

      776    14809    2              CALL PUT_FLAG(VLP_TRMCTL.ACTONTRN#, 'ActOnTrn', LENGTHC('ActOnTrn'))
             14809                       ALTRET (TERM70);

  14809  2 003245   000124 237000 3                  LDAQ    84
         2 003246   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003247   201010 452500                    STP2    TLEN+2,,AUTO
         2 003250   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003251   000057 036000 3                  ADLQ    47
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:136  
         2 003252   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003253   005713 701000 2                  TSX1    PUT_FLAG
         2 003254   004514 702000 2                  TSX2    TERM70

      777    14810    2              CALL PUT_FLAG(VLP_TRMCTL.ADJTOPLFT#, 'AdjTopLft', LENGTHC('AdjTopLft'))
             14810                       ALTRET (TERM70);

  14810  2 003255   000126 237000 3                  LDAQ    86
         2 003256   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003257   201010 452500                    STP2    TLEN+2,,AUTO
         2 003260   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003261   000130 036000 3                  ADLQ    88
         2 003262   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003263   005713 701000 2                  TSX1    PUT_FLAG
         2 003264   004514 702000 2                  TSX2    TERM70

      778    14811    2              CALL PUT_FLAG(VLP_TRMATTR.APL#, 'APL', LENGTHC('APL')) ALTRET (TERM70);

  14811  2 003265   000132 237000 3                  LDAQ    90
         2 003266   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003267   201010 452500                    STP2    TLEN+2,,AUTO
         2 003270   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003271   000131 036000 3                  ADLQ    89
         2 003272   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003273   005713 701000 2                  TSX1    PUT_FLAG
         2 003274   004514 702000 2                  TSX2    TERM70

      779    14812    2              CALL PUT_FLAG(VLP_TRMCTL.APLLCNRM#, 'APLLCNrm', LENGTHC('APLLCNrm'))
             14812                       ALTRET (TERM70);

  14812  2 003275   000134 237000 3                  LDAQ    92
         2 003276   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003277   201010 452500                    STP2    TLEN+2,,AUTO
         2 003300   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003301   000136 036000 3                  ADLQ    94
         2 003302   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003303   005713 701000 2                  TSX1    PUT_FLAG
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:137  
         2 003304   004514 702000 2                  TSX2    TERM70

      780    14813    2             CALL PUT_FLAG(VLP_TRMATTR.ATRSCRNPOS#, 'AtrScrnPos', LENGTHC('AtrScrnPos'
             14813                       )) ALTRET (TERM70);

  14813  2 003305   000140 237000 3                  LDAQ    96
         2 003306   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003307   201010 452500                    STP2    TLEN+2,,AUTO
         2 003310   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003311   000137 036000 3                  ADLQ    95
         2 003312   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003313   005713 701000 2                  TSX1    PUT_FLAG
         2 003314   004514 702000 2                  TSX2    TERM70

      781    14814    2             CALL PUT_FLAG(VLP_TRMCTL.AUTOCURSOR#, 'AutoCursor', LENGTHC('AutoCursor')
             14814                       ) ALTRET (TERM70);

  14814  2 003315   000142 237000 3                  LDAQ    98
         2 003316   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003317   201010 452500                    STP2    TLEN+2,,AUTO
         2 003320   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003321   000144 036000 3                  ADLQ    100
         2 003322   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003323   005713 701000 2                  TSX1    PUT_FLAG
         2 003324   004514 702000 2                  TSX2    TERM70

      782    14815    2              CALL PUT_FLAG(VLP_TRMATTR.AUTONL#, 'AutoNL', LENGTHC('AutoNL')) ALTRET (
             14815                       TERM70);

  14815  2 003325   000146 237000 3                  LDAQ    102
         2 003326   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003327   201010 452500                    STP2    TLEN+2,,AUTO
         2 003330   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003331   000145 036000 3                  ADLQ    101
         2 003332   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003333   005713 701000 2                  TSX1    PUT_FLAG
         2 003334   004514 702000 2                  TSX2    TERM70
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:138  

      783    14816    2              CALL PUT_FLAG(VLP_TRMATTR.BIN#, 'Bin', LENGTHC('Bin')) ALTRET (TERM70);

  14816  2 003335   000150 237000 3                  LDAQ    104
         2 003336   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003337   201010 452500                    STP2    TLEN+2,,AUTO
         2 003340   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003341   000152 036000 3                  ADLQ    106
         2 003342   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003343   005713 701000 2                  TSX1    PUT_FLAG
         2 003344   004514 702000 2                  TSX2    TERM70

      784    14817    2              CALL PUT_FLAG(VLP_TRMATTR.BLANKERASES#, 'BlankErases', LENGTHC(
             14817                       'BlankErases')) ALTRET (TERM70);

  14817  2 003345   000154 237000 3                  LDAQ    108
         2 003346   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003347   201010 452500                    STP2    TLEN+2,,AUTO
         2 003350   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003351   000153 036000 3                  ADLQ    107
         2 003352   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003353   005713 701000 2                  TSX1    PUT_FLAG
         2 003354   004514 702000 2                  TSX2    TERM70

      785    14818    2              IF HAVE_WINDOW

  14818  2 003355   200417 234100                    SZN     HAVE_WINDOW,,AUTO
         2 003356   003367 605000 2                  TPL     s:14821

      786    14819    2                THEN
      787    14820    2                 CALL PUT_FLAG (VLP_WINDOW.BTMBRDR#, 'BtmBrdr', LENGTHC('BtmBrdr'))
             14820                          ALTRET (TERM70);

  14820  2 003357   000156 237000 3                  LDAQ    110
         2 003360   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003361   201010 452500                    STP2    TLEN+2,,AUTO
         2 003362   201010 236100                    LDQ     TLEN+2,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:139  
         2 003363   000160 036000 3                  ADLQ    112
         2 003364   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003365   005713 701000 2                  TSX1    PUT_FLAG
         2 003366   004514 702000 2                  TSX2    TERM70

      788    14821    2              CALL PUT_FLAG(VLP_TRMATTR.CRISNL#, 'CRisNL', LENGTHC('CRisNL')) ALTRET (
             14821                       TERM70);

  14821  2 003367   000162 237000 3                  LDAQ    114
         2 003370   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003371   201010 452500                    STP2    TLEN+2,,AUTO
         2 003372   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003373   000161 036000 3                  ADLQ    113
         2 003374   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003375   005713 701000 2                  TSX1    PUT_FLAG
         2 003376   004514 702000 2                  TSX2    TERM70

      789    14822    2             CALL PUT_FLAG(VLP_TRMCTL.CURSORREAD#, 'CursorRead', LENGTHC('CursorRead')
             14822                       ) ALTRET (TERM70);

  14822  2 003377   000164 237000 3                  LDAQ    116
         2 003400   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003401   201010 452500                    STP2    TLEN+2,,AUTO
         2 003402   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003403   000166 036000 3                  ADLQ    118
         2 003404   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003405   005713 701000 2                  TSX1    PUT_FLAG
         2 003406   004514 702000 2                  TSX2    TERM70

      790    14823    2              CALL PUT_FLAG(VLP_TRMATTR.CURSORUP#, 'CursorUp', LENGTHC('CursorUp'))
             14823                       ALTRET (TERM70);

  14823  2 003407   000170 237000 3                  LDAQ    120
         2 003410   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003411   201010 452500                    STP2    TLEN+2,,AUTO
         2 003412   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003413   000167 036000 3                  ADLQ    119
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:140  
         2 003414   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003415   005713 701000 2                  TSX1    PUT_FLAG
         2 003416   004514 702000 2                  TSX2    TERM70

      791    14824    2              CALL PUT_FLAG(VLP_TRMATTR.DCHMOVFLD#, 'DchMovFld', LENGTHC('DchMovFld'))
             14824                       ALTRET (TERM70);

  14824  2 003417   000172 237000 3                  LDAQ    122
         2 003420   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003421   201010 452500                    STP2    TLEN+2,,AUTO
         2 003422   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003423   000174 036000 3                  ADLQ    124
         2 003424   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003425   005713 701000 2                  TSX1    PUT_FLAG
         2 003426   004514 702000 2                  TSX2    TERM70

      792    14825    2              CALL PUT_FLAG(VLP_TRMATTR.DEVICEBS#, 'DeviceBS', LENGTHC('DeviceBS'))
             14825                       ALTRET (TERM70);

  14825  2 003427   000176 237000 3                  LDAQ    126
         2 003430   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003431   201010 452500                    STP2    TLEN+2,,AUTO
         2 003432   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003433   000175 036000 3                  ADLQ    125
         2 003434   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003435   005713 701000 2                  TSX1    PUT_FLAG
         2 003436   004514 702000 2                  TSX2    TERM70

      793    14826    2              CALL PUT_FLAG(VLP_TRMATTR.DEVICECR#, 'DeviceCR', LENGTHC('DeviceCR'))
             14826                       ALTRET (TERM70);

  14826  2 003437   000200 237000 3                  LDAQ    128
         2 003440   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003441   201010 452500                    STP2    TLEN+2,,AUTO
         2 003442   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003443   000202 036000 3                  ADLQ    130
         2 003444   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:141  
         2 003445   005713 701000 2                  TSX1    PUT_FLAG
         2 003446   004514 702000 2                  TSX2    TERM70

      794    14827    2              CALL PUT_FLAG(VLP_TRMATTR.DEVICELF#, 'DeviceLF', LENGTHC('DeviceLF'))
             14827                       ALTRET (TERM70);

  14827  2 003447   000204 237000 3                  LDAQ    132
         2 003450   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003451   201010 452500                    STP2    TLEN+2,,AUTO
         2 003452   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003453   000203 036000 3                  ADLQ    131
         2 003454   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003455   005713 701000 2                  TSX1    PUT_FLAG
         2 003456   004514 702000 2                  TSX2    TERM70

      795    14828    2             CALL PUT_FLAG(VLP_TRMATTR.DEVPOSOPTS#, 'DevPosOpts', LENGTHC('DevPosOpts'
             14828                       )) ALTRET (TERM70);

  14828  2 003457   000206 237000 3                  LDAQ    134
         2 003460   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003461   201010 452500                    STP2    TLEN+2,,AUTO
         2 003462   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003463   000210 036000 3                  ADLQ    136
         2 003464   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003465   005713 701000 2                  TSX1    PUT_FLAG
         2 003466   004514 702000 2                  TSX2    TERM70

      796    14829    2              CALL PUT_FLAG(VLP_TRMATTR.DEVSCROLL#, 'DevScroll', LENGTHC('DevScroll'))
             14829                       ALTRET (TERM70);

  14829  2 003467   000212 237000 3                  LDAQ    138
         2 003470   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003471   201010 452500                    STP2    TLEN+2,,AUTO
         2 003472   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003473   000211 036000 3                  ADLQ    137
         2 003474   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003475   005713 701000 2                  TSX1    PUT_FLAG
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:142  
         2 003476   004514 702000 2                  TSX2    TERM70

      797    14830    2              CALL PUT_FLAG(VLP_TRMCTL.DISPINPUT#, 'DispInput', LENGTHC('DispInput'))
             14830                       ALTRET (TERM70);

  14830  2 003477   000214 237000 3                  LDAQ    140
         2 003500   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003501   201010 452500                    STP2    TLEN+2,,AUTO
         2 003502   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003503   000216 036000 3                  ADLQ    142
         2 003504   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003505   005713 701000 2                  TSX1    PUT_FLAG
         2 003506   004514 702000 2                  TSX2    TERM70

      798    14831    2              IF HAVE_EDTCTL

  14831  2 003507   200416 234100                    SZN     HAVE_EDTCTL,,AUTO
         2 003510   003521 605000 2                  TPL     s:14834

      799    14832    2                THEN
      800    14833    2                 CALL PUT_FLAG(VLP_EDTCTL.EASYAPPEND#, 'EasyAppend', LENGTHC(
             14833                          'EasyAppend')) ALTRET (TERM70);

  14833  2 003511   000220 237000 3                  LDAQ    144
         2 003512   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003513   201010 452500                    STP2    TLEN+2,,AUTO
         2 003514   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003515   000217 036000 3                  ADLQ    143
         2 003516   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003517   005713 701000 2                  TSX1    PUT_FLAG
         2 003520   004514 702000 2                  TSX2    TERM70

      801    14834    2              CALL PUT_FLAG(VLP_TRMCTL.EDITOVR#, 'EditOvr', LENGTHC('EditOvr')) ALTRET
             14834                       (TERM70);

  14834  2 003521   000222 237000 3                  LDAQ    146
         2 003522   200774 757100                    STAQ    @DECIMAL+1,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:143  
         2 003523   201010 452500                    STP2    TLEN+2,,AUTO
         2 003524   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003525   000224 036000 3                  ADLQ    148
         2 003526   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003527   005713 701000 2                  TSX1    PUT_FLAG
         2 003530   004514 702000 2                  TSX2    TERM70

      802    14835    2              CALL PUT_FLAG(VLP_TRMCTL.ENBENTEXTSRDCHR#, 'EnbEntExtSRDChr', LENGTHC(
             14835                       'EnbEntExtSRDChr')) ALTRET (TERM70);

  14835  2 003531   000226 237000 3                  LDAQ    150
         2 003532   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003533   201010 452500                    STP2    TLEN+2,,AUTO
         2 003534   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003535   000225 036000 3                  ADLQ    149
         2 003536   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003537   005713 701000 2                  TSX1    PUT_FLAG
         2 003540   004514 702000 2                  TSX2    TERM70

      803    14836    2              CALL PUT_FLAG(VLP_TRMATTR.FF_FLUSH#, 'FFFlush', LENGTHC('FFFlush'))
             14836                       ALTRET (TERM70);

  14836  2 003541   000230 237000 3                  LDAQ    152
         2 003542   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003543   201010 452500                    STP2    TLEN+2,,AUTO
         2 003544   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003545   000232 036000 3                  ADLQ    154
         2 003546   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003547   005713 701000 2                  TSX1    PUT_FLAG
         2 003550   004514 702000 2                  TSX2    TERM70

      804    14837    2              CALL PUT_FLAG(VLP_TRMATTR.FF_INCCR#, 'FFIncCr', LENGTHC('FFIncCr'))
             14837                       ALTRET (TERM70);

  14837  2 003551   000234 237000 3                  LDAQ    156
         2 003552   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003553   201010 452500                    STP2    TLEN+2,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:144  
         2 003554   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003555   000233 036000 3                  ADLQ    155
         2 003556   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003557   005713 701000 2                  TSX1    PUT_FLAG
         2 003560   004514 702000 2                  TSX2    TERM70

      805    14838    2              CALL PUT_FLAG(VLP_TRMCTL.FULLDUXPAPERTAPE#, 'FullDuxPaperTape', LENGTHC(
             14838                       'FullDuxPaperTape')) ALTRET (TERM70);

  14838  2 003561   000240 237000 3                  LDAQ    160
         2 003562   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003563   201010 452500                    STP2    TLEN+2,,AUTO
         2 003564   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003565   000237 036000 3                  ADLQ    159
         2 003566   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003567   005713 701000 2                  TSX1    PUT_FLAG
         2 003570   004514 702000 2                  TSX2    TERM70

      806    14839    2              CALL PUT_FLAG(VLP_TRMCTL.HALFDUXPAPERTAPE#, 'HalfDuxPaperTape', LENGTHC(
             14839                       'HalfDuxPaperTape')) ALTRET (TERM70);

  14839  2 003571   000242 237000 3                  LDAQ    162
         2 003572   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003573   201010 452500                    STP2    TLEN+2,,AUTO
         2 003574   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003575   000244 036000 3                  ADLQ    164
         2 003576   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003577   005713 701000 2                  TSX1    PUT_FLAG
         2 003600   004514 702000 2                  TSX2    TERM70

      807    14840    2              IF HAVE_EDTCTL

  14840  2 003601   200416 234100                    SZN     HAVE_EDTCTL,,AUTO
         2 003602   003613 605000 2                  TPL     s:14843

      808    14841    2                THEN
      809    14842    2                 CALL PUT_FLAG(VLP_EDTCTL.HSALL#, 'HSAll', LENGTHC('HSAll')) ALTRET (
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:145  
             14842                          TERM70);

  14842  2 003603   000246 237000 3                  LDAQ    166
         2 003604   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003605   201010 452500                    STP2    TLEN+2,,AUTO
         2 003606   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003607   000245 036000 3                  ADLQ    165
         2 003610   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003611   005713 701000 2                  TSX1    PUT_FLAG
         2 003612   004514 702000 2                  TSX2    TERM70

      810    14843    2              CALL PUT_FLAG(VLP_TRMCTL.HSCROLL#, 'HScroll', LENGTHC('HScroll')) ALTRET
             14843                       (TERM70);

  14843  2 003613   000250 237000 3                  LDAQ    168
         2 003614   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003615   201010 452500                    STP2    TLEN+2,,AUTO
         2 003616   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003617   000252 036000 3                  ADLQ    170
         2 003620   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003621   005713 701000 2                  TSX1    PUT_FLAG
         2 003622   004514 702000 2                  TSX2    TERM70

      811    14844    2             CALL PUT_FLAG(VLP_TRMCTL.INSERTMODE#, 'InsertMode', LENGTHC('InsertMode')
             14844                       ) ALTRET (TERM70);

  14844  2 003623   000254 237000 3                  LDAQ    172
         2 003624   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003625   201010 452500                    STP2    TLEN+2,,AUTO
         2 003626   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003627   000253 036000 3                  ADLQ    171
         2 003630   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003631   005713 701000 2                  TSX1    PUT_FLAG
         2 003632   004514 702000 2                  TSX2    TERM70

      812    14845    2             CALL PUT_FLAG(VLP_TRMCTL.KEEPTYPAHD#, 'KeepTypAhd', LENGTHC('KeepTypAhd')
             14845                       ) ALTRET (TERM70);
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:146  

  14845  2 003633   000256 237000 3                  LDAQ    174
         2 003634   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003635   201010 452500                    STP2    TLEN+2,,AUTO
         2 003636   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003637   000260 036000 3                  ADLQ    176
         2 003640   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003641   005713 701000 2                  TSX1    PUT_FLAG
         2 003642   004514 702000 2                  TSX2    TERM70

      813    14846    2              CALL PUT_FLAG(VLP_TRMATTR.LFISNL#, 'LFisNL', LENGTHC('LFisNL')) ALTRET (
             14846                       TERM70);

  14846  2 003643   000262 237000 3                  LDAQ    178
         2 003644   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003645   201010 452500                    STP2    TLEN+2,,AUTO
         2 003646   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003647   000261 036000 3                  ADLQ    177
         2 003650   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003651   005713 701000 2                  TSX1    PUT_FLAG
         2 003652   004514 702000 2                  TSX2    TERM70

      814    14847    2              IF HAVE_WINDOW

  14847  2 003653   200417 234100                    SZN     HAVE_WINDOW,,AUTO
         2 003654   003665 605000 2                  TPL     s:14850

      815    14848    2                THEN
      816    14849    2                 CALL PUT_FLAG (VLP_WINDOW.LFTBRDR#, 'LftBrdr', LENGTHC('LftBrdr'))
             14849                          ALTRET (TERM70);

  14849  2 003655   000264 237000 3                  LDAQ    180
         2 003656   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003657   201010 452500                    STP2    TLEN+2,,AUTO
         2 003660   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003661   000266 036000 3                  ADLQ    182
         2 003662   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:147  
         2 003663   005713 701000 2                  TSX1    PUT_FLAG
         2 003664   004514 702000 2                  TSX2    TERM70

      817    14850    2              CALL PUT_FLAG(VLP_TRMATTR.LIMBOCLM#, 'LimboClm', LENGTHC('LimboClm'))
             14850                       ALTRET (TERM70);

  14850  2 003665   000270 237000 3                  LDAQ    184
         2 003666   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003667   201010 452500                    STP2    TLEN+2,,AUTO
         2 003670   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003671   000267 036000 3                  ADLQ    183
         2 003672   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003673   005713 701000 2                  TSX1    PUT_FLAG
         2 003674   004514 702000 2                  TSX2    TERM70

      818    14851    2              CALL PUT_FLAG(VLP_TRMATTR.LOCALECHO#, 'LocalEcho', LENGTHC('LocalEcho'))
             14851                       ALTRET (TERM70);

  14851  2 003675   000272 237000 3                  LDAQ    186
         2 003676   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003677   201010 452500                    STP2    TLEN+2,,AUTO
         2 003700   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003701   000274 036000 3                  ADLQ    188
         2 003702   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003703   005713 701000 2                  TSX1    PUT_FLAG
         2 003704   004514 702000 2                  TSX2    TERM70

      819    14852    2              CALL PUT_FLAG(VLP_TRMCTL.LOWERCASE#, 'LowerCase', LENGTHC('LowerCase'))
             14852                       ALTRET (TERM70);

  14852  2 003705   000276 237000 3                  LDAQ    190
         2 003706   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003707   201010 452500                    STP2    TLEN+2,,AUTO
         2 003710   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003711   000275 036000 3                  ADLQ    189
         2 003712   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003713   005713 701000 2                  TSX1    PUT_FLAG
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:148  
         2 003714   004514 702000 2                  TSX2    TERM70

      820    14853    2              CALL PUT_FLAG(VLP_TRMATTR.LOWERCASEPRINTS#, 'LowerCasePrints', LENGTHC(
             14853                       'LowerCasePrints')) ALTRET (TERM70);

  14853  2 003715   000300 237000 3                  LDAQ    192
         2 003716   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003717   201010 452500                    STP2    TLEN+2,,AUTO
         2 003720   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003721   000302 036000 3                  ADLQ    194
         2 003722   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003723   005713 701000 2                  TSX1    PUT_FLAG
         2 003724   004514 702000 2                  TSX2    TERM70

      821    14854    2              CALL PUT_FLAG(VLP_TRMATTR.MICROFPL#, 'MicroFpl', LENGTHC('MicroFpl'))
             14854                       ALTRET (TERM70);

  14854  2 003725   000304 237000 3                  LDAQ    196
         2 003726   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003727   201010 452500                    STP2    TLEN+2,,AUTO
         2 003730   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003731   000303 036000 3                  ADLQ    195
         2 003732   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003733   005713 701000 2                  TSX1    PUT_FLAG
         2 003734   004514 702000 2                  TSX2    TERM70

      822    14855    2              CALL PUT_FLAG(VLP_TRMCTL.MSGHALT#, 'MsgHalt', LENGTHC('MsgHalt')) ALTRET
             14855                       (TERM70);

  14855  2 003735   000306 237000 3                  LDAQ    198
         2 003736   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003737   201010 452500                    STP2    TLEN+2,,AUTO
         2 003740   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003741   000310 036000 3                  ADLQ    200
         2 003742   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003743   005713 701000 2                  TSX1    PUT_FLAG
         2 003744   004514 702000 2                  TSX2    TERM70
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:149  

      823    14856    2              CALL PUT_FLAG(VLP_TRMCTL.MSGLINE#, 'MsgLine', LENGTHC('MsgLine')) ALTRET
             14856                       (TERM70);

  14856  2 003745   000312 237000 3                  LDAQ    202
         2 003746   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003747   201010 452500                    STP2    TLEN+2,,AUTO
         2 003750   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003751   000311 036000 3                  ADLQ    201
         2 003752   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003753   005713 701000 2                  TSX1    PUT_FLAG
         2 003754   004514 702000 2                  TSX2    TERM70

      824    14857    2              CALL PUT_FLAG(VLP_TRMATTR.NO_FLDTRM#, 'NoFldTrm', LENGTHC('NoFldTrm'))
             14857                       ALTRET (TERM70);

  14857  2 003755   000314 237000 3                  LDAQ    204
         2 003756   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003757   201010 452500                    STP2    TLEN+2,,AUTO
         2 003760   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003761   000316 036000 3                  ADLQ    206
         2 003762   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003763   005713 701000 2                  TSX1    PUT_FLAG
         2 003764   004514 702000 2                  TSX2    TERM70

      825    14858    2              CALL PUT_FLAG(VLP_TRMCTL.NOOPTMIZ#, 'NoOptmiz', LENGTHC('NoOptmiz'))
             14858                       ALTRET (TERM70);

  14858  2 003765   000320 237000 3                  LDAQ    208
         2 003766   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 003767   201010 452500                    STP2    TLEN+2,,AUTO
         2 003770   201010 236100                    LDQ     TLEN+2,,AUTO
         2 003771   000317 036000 3                  ADLQ    207
         2 003772   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 003773   005713 701000 2                  TSX1    PUT_FLAG
         2 003774   004514 702000 2                  TSX2    TERM70

PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:150  
      826    14859    2              IF HAVE_EDTCTL

  14859  2 003775   200416 234100                    SZN     HAVE_EDTCTL,,AUTO
         2 003776   004007 605000 2                  TPL     s:14862

      827    14860    2                THEN
      828    14861    2                 CALL PUT_FLAG(VLP_EDTCTL.ONESPACEEDIT#,'OneSpaceEdit',LENGTHC(
             14861                          'OneSpaceEdit')) ALTRET(TERM70);

  14861  2 003777   000322 237000 3                  LDAQ    210
         2 004000   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004001   201010 452500                    STP2    TLEN+2,,AUTO
         2 004002   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004003   000324 036000 3                  ADLQ    212
         2 004004   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004005   005713 701000 2                  TSX1    PUT_FLAG
         2 004006   004514 702000 2                  TSX2    TERM70

      829    14862    2              CALL PUT_FLAG(VLP_TRMATTR.OPDTAB#, 'OpDTab', LENGTHC('OpDTab')) ALTRET (
             14862                       TERM70);

  14862  2 004007   000326 237000 3                  LDAQ    214
         2 004010   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004011   201010 452500                    STP2    TLEN+2,,AUTO
         2 004012   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004013   000325 036000 3                  ADLQ    213
         2 004014   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004015   005713 701000 2                  TSX1    PUT_FLAG
         2 004016   004514 702000 2                  TSX2    TERM70

      830    14863    2              IF HAVE_WINDOW

  14863  2 004017   200417 234100                    SZN     HAVE_WINDOW,,AUTO
         2 004020   004031 605000 2                  TPL     s:14866

      831    14864    2                THEN
      832    14865    2                 CALL PUT_FLAG(VLP_WINDOW.REMOVABLE#, 'Optional', LENGTHC('Optional'))
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:151  
             14865                          ALTRET (TERM70);

  14865  2 004021   000330 237000 3                  LDAQ    216
         2 004022   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004023   201010 452500                    STP2    TLEN+2,,AUTO
         2 004024   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004025   000332 036000 3                  ADLQ    218
         2 004026   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004027   005713 701000 2                  TSX1    PUT_FLAG
         2 004030   004514 702000 2                  TSX2    TERM70

      833    14866    2              CALL PUT_FLAG(VLP_TRMCTL.OUTPUTDISCARD#, 'OutputDiscard', LENGTHC(
             14866                       'OutputDiscard')) ALTRET (TERM70);

  14866  2 004031   000334 237000 3                  LDAQ    220
         2 004032   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004033   201010 452500                    STP2    TLEN+2,,AUTO
         2 004034   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004035   000333 036000 3                  ADLQ    219
         2 004036   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004037   005713 701000 2                  TSX1    PUT_FLAG
         2 004040   004514 702000 2                  TSX2    TERM70

      834    14867    2              CALL PUT_FLAG(VLP_TRMCTL.PAGEHALT#, 'PageHalt', LENGTHC('PageHalt'))
             14867                       ALTRET (TERM70);

  14867  2 004041   000336 237000 3                  LDAQ    222
         2 004042   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004043   201010 452500                    STP2    TLEN+2,,AUTO
         2 004044   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004045   000340 036000 3                  ADLQ    224
         2 004046   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004047   005713 701000 2                  TSX1    PUT_FLAG
         2 004050   004514 702000 2                  TSX2    TERM70

      835    14868    2              CALL PUT_FLAG(VLP_TRMCTL.PARITYCHECK#, 'ParityCheck', LENGTHC(
             14868                       'ParityCheck')) ALTRET (TERM70);
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:152  

  14868  2 004051   000342 237000 3                  LDAQ    226
         2 004052   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004053   201010 452500                    STP2    TLEN+2,,AUTO
         2 004054   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004055   000341 036000 3                  ADLQ    225
         2 004056   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004057   005713 701000 2                  TSX1    PUT_FLAG
         2 004060   004514 702000 2                  TSX2    TERM70

      836    14869    2             CALL PUT_FLAG(VLP_TRMCTL.PARKCURSOR#, 'ParkCursor', LENGTHC('ParkCursor')
             14869                       ) ALTRET (TERM70);

  14869  2 004061   000344 237000 3                  LDAQ    228
         2 004062   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004063   201010 452500                    STP2    TLEN+2,,AUTO
         2 004064   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004065   000346 036000 3                  ADLQ    230
         2 004066   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004067   005713 701000 2                  TSX1    PUT_FLAG
         2 004070   004514 702000 2                  TSX2    TERM70

      837    14870    2              CALL PUT_FLAG(VLP_TRMCTL.PRINTHALT#, 'PrintHalt', LENGTHC('PrintHalt'))
             14870                       ALTRET (TERM70);

  14870  2 004071   000350 237000 3                  LDAQ    232
         2 004072   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004073   201010 452500                    STP2    TLEN+2,,AUTO
         2 004074   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004075   000347 036000 3                  ADLQ    231
         2 004076   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004077   005713 701000 2                  TSX1    PUT_FLAG
         2 004100   004514 702000 2                  TSX2    TERM70

      838    14871    2              CALL PUT_FLAG(VLP_TRMATTR.PRINTTYPE#, 'PrintType', LENGTHC('PrintType'))
             14871                       ALTRET (TERM70);

PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:153  
  14871  2 004101   000352 237000 3                  LDAQ    234
         2 004102   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004103   201010 452500                    STP2    TLEN+2,,AUTO
         2 004104   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004105   000354 036000 3                  ADLQ    236
         2 004106   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004107   005713 701000 2                  TSX1    PUT_FLAG
         2 004110   004514 702000 2                  TSX2    TERM70

      839    14872    2              CALL PUT_FLAG(VLP_TRMATTR.PROGDTAB#, 'ProgDTab', LENGTHC('ProgDTab'))
             14872                       ALTRET (TERM70);

  14872  2 004111   000356 237000 3                  LDAQ    238
         2 004112   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004113   201010 452500                    STP2    TLEN+2,,AUTO
         2 004114   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004115   000355 036000 3                  ADLQ    237
         2 004116   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004117   005713 701000 2                  TSX1    PUT_FLAG
         2 004120   004514 702000 2                  TSX2    TERM70

      840    14873    2              IF HAVE_EDTCTL

  14873  2 004121   200416 234100                    SZN     HAVE_EDTCTL,,AUTO
         2 004122   004133 605000 2                  TPL     s:14876

      841    14874    2                THEN
      842    14875    2                 CALL PUT_FLAG(VLP_EDTCTL.RCRWRAP#, 'RcrWrap', LENGTHC('RcrWrap'))
             14875                          ALTRET (TERM70);

  14875  2 004123   000360 237000 3                  LDAQ    240
         2 004124   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004125   201010 452500                    STP2    TLEN+2,,AUTO
         2 004126   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004127   000362 036000 3                  ADLQ    242
         2 004130   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004131   005713 701000 2                  TSX1    PUT_FLAG
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:154  
         2 004132   004514 702000 2                  TSX2    TERM70

      843    14876    2              CALL PUT_FLAG(VLP_TRMCTL.RELPAGE#, 'RelPage', LENGTHC('RelPage')) ALTRET
             14876                       (TERM70);

  14876  2 004133   000364 237000 3                  LDAQ    244
         2 004134   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004135   201010 452500                    STP2    TLEN+2,,AUTO
         2 004136   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004137   000363 036000 3                  ADLQ    243
         2 004140   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004141   005713 701000 2                  TSX1    PUT_FLAG
         2 004142   004514 702000 2                  TSX2    TERM70

      844    14877    2              CALL PUT_FLAG(VLP_TRMCTL.RETYPOVR#, 'RetypOvr', LENGTHC('RetypOvr'))
             14877                       ALTRET (TERM70);

  14877  2 004143   000366 237000 3                  LDAQ    246
         2 004144   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004145   201010 452500                    STP2    TLEN+2,,AUTO
         2 004146   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004147   000370 036000 3                  ADLQ    248
         2 004150   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004151   005713 701000 2                  TSX1    PUT_FLAG
         2 004152   004514 702000 2                  TSX2    TERM70

      845    14878    2              IF HAVE_WINDOW

  14878  2 004153   200417 234100                    SZN     HAVE_WINDOW,,AUTO
         2 004154   004165 605000 2                  TPL     s:14881

      846    14879    2                THEN
      847    14880    2                 CALL PUT_FLAG (VLP_WINDOW.RHTBRDR#, 'RhtBrdr', LENGTHC('BtmBrdr'))
             14880                          ALTRET (TERM70);

  14880  2 004155   000372 237000 3                  LDAQ    250
         2 004156   200774 757100                    STAQ    @DECIMAL+1,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:155  
         2 004157   201010 452500                    STP2    TLEN+2,,AUTO
         2 004160   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004161   000371 036000 3                  ADLQ    249
         2 004162   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004163   005713 701000 2                  TSX1    PUT_FLAG
         2 004164   004514 702000 2                  TSX2    TERM70

      848    14881    2              CALL PUT_FLAG(VLP_TRMCTL.SCROLL#, 'Scroll', LENGTHC('Scroll')) ALTRET (
             14881                       TERM70);

  14881  2 004165   000374 237000 3                  LDAQ    252
         2 004166   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004167   201010 452500                    STP2    TLEN+2,,AUTO
         2 004170   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004171   000376 036000 3                  ADLQ    254
         2 004172   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004173   005713 701000 2                  TSX1    PUT_FLAG
         2 004174   004514 702000 2                  TSX2    TERM70

      849    14882    2              CALL PUT_FLAG(VLP_TRMCTL.SENDBKSPACE#, 'SendBkSpace', LENGTHC(
             14882                       'SendBkSpace')) ALTRET (TERM70);

  14882  2 004175   000400 237000 3                  LDAQ    256
         2 004176   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004177   201010 452500                    STP2    TLEN+2,,AUTO
         2 004200   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004201   000377 036000 3                  ADLQ    255
         2 004202   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004203   005713 701000 2                  TSX1    PUT_FLAG
         2 004204   004514 702000 2                  TSX2    TERM70

      850    14883    2              CALL PUT_FLAG(VLP_TRMCTL.SIMPERF#, 'SimPerf', LENGTHC('SimPerf')) ALTRET
             14883                       (TERM70);

  14883  2 004205   000402 237000 3                  LDAQ    258
         2 004206   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004207   201010 452500                    STP2    TLEN+2,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:156  
         2 004210   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004211   000404 036000 3                  ADLQ    260
         2 004212   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004213   005713 701000 2                  TSX1    PUT_FLAG
         2 004214   004514 702000 2                  TSX2    TERM70

      851    14884    2              CALL PUT_FLAG(VLP_TRMCTL.SPACEINSERT#, 'SpaceInsert', LENGTHC(
             14884                       'SpaceInsert')) ALTRET (TERM70);

  14884  2 004215   000406 237000 3                  LDAQ    262
         2 004216   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004217   201010 452500                    STP2    TLEN+2,,AUTO
         2 004220   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004221   000405 036000 3                  ADLQ    261
         2 004222   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004223   005713 701000 2                  TSX1    PUT_FLAG
         2 004224   004514 702000 2                  TSX2    TERM70

      852    14885    2              CALL PUT_FLAG(VLP_TRMATTR.SPCBFRPRT#, 'SpcBfrPrt', LENGTHC('SpcBfrPrt'))
             14885                       ALTRET (TERM70);

  14885  2 004225   000410 237000 3                  LDAQ    264
         2 004226   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004227   201010 452500                    STP2    TLEN+2,,AUTO
         2 004230   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004231   000412 036000 3                  ADLQ    266
         2 004232   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004233   005713 701000 2                  TSX1    PUT_FLAG
         2 004234   004514 702000 2                  TSX2    TERM70

      853    14886    2              CALL PUT_FLAG(VLP_TRMCTL.TABRELATIVE#, 'TabRelative', LENGTHC(
             14886                       'TabRelative')) ALTRET (TERM70);

  14886  2 004235   000414 237000 3                  LDAQ    268
         2 004236   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004237   201010 452500                    STP2    TLEN+2,,AUTO
         2 004240   201010 236100                    LDQ     TLEN+2,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:157  
         2 004241   000413 036000 3                  ADLQ    267
         2 004242   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004243   005713 701000 2                  TSX1    PUT_FLAG
         2 004244   004514 702000 2                  TSX2    TERM70

      854    14887    2              CALL PUT_FLAG(VLP_TRMCTL.TABSIM#, 'TabSim', LENGTHC('TabSim')) ALTRET (
             14887                       TERM70);

  14887  2 004245   000416 237000 3                  LDAQ    270
         2 004246   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004247   201010 452500                    STP2    TLEN+2,,AUTO
         2 004250   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004251   000420 036000 3                  ADLQ    272
         2 004252   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004253   005713 701000 2                  TSX1    PUT_FLAG
         2 004254   004514 702000 2                  TSX2    TERM70

      855    14888    2              IF HAVE_EDTCTL

  14888  2 004255   200416 234100                    SZN     HAVE_EDTCTL,,AUTO
         2 004256   004267 605000 2                  TPL     s:14891

      856    14889    2                THEN
      857    14890    2                 CALL PUT_FLAG(VLP_EDTCTL.TEXTEDIT#,'TextEdit',LENGTHC('TextEdit'))
             14890                          ALTRET(TERM70);

  14890  2 004257   000422 237000 3                  LDAQ    274
         2 004260   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004261   201010 452500                    STP2    TLEN+2,,AUTO
         2 004262   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004263   000421 036000 3                  ADLQ    273
         2 004264   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004265   005713 701000 2                  TSX1    PUT_FLAG
         2 004266   004514 702000 2                  TSX2    TERM70

      858    14891    2              IF HAVE_WINDOW

PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:158  
  14891  2 004267   200417 234100                    SZN     HAVE_WINDOW,,AUTO
         2 004270   004301 605000 2                  TPL     s:14894

      859    14892    2                THEN
      860    14893    2                 CALL PUT_FLAG (VLP_WINDOW.TOPBRDR#, 'TopBrdr', LENGTHC('TopBrdr'))
             14893                          ALTRET (TERM70);

  14893  2 004271   000424 237000 3                  LDAQ    276
         2 004272   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004273   201010 452500                    STP2    TLEN+2,,AUTO
         2 004274   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004275   000426 036000 3                  ADLQ    278
         2 004276   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004277   005713 701000 2                  TSX1    PUT_FLAG
         2 004300   004514 702000 2                  TSX2    TERM70

      861    14894    2              CALL PUT_FLAG(VLP_TRMCTL.TRUNCATE#, 'Truncate', LENGTHC('Truncate'))
             14894                       ALTRET (TERM70);

  14894  2 004301   000430 237000 3                  LDAQ    280
         2 004302   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004303   201010 452500                    STP2    TLEN+2,,AUTO
         2 004304   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004305   000427 036000 3                  ADLQ    279
         2 004306   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004307   005713 701000 2                  TSX1    PUT_FLAG
         2 004310   004514 702000 2                  TSX2    TERM70

      862    14895    2              CALL PUT_FLAG(VLP_TRMATTR.TRUOVRPRT#, 'TruOvrPrt', LENGTHC('TruOvrPrt'))
             14895                       ALTRET (TERM70);

  14895  2 004311   000432 237000 3                  LDAQ    282
         2 004312   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004313   201010 452500                    STP2    TLEN+2,,AUTO
         2 004314   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004315   000434 036000 3                  ADLQ    284
         2 004316   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:159  
         2 004317   005713 701000 2                  TSX1    PUT_FLAG
         2 004320   004514 702000 2                  TSX2    TERM70

      863    14896    2             CALL PUT_FLAG(VLP_TRMATTR.TTYTYPE#, 'TTyType', LENGTHC('TTyType')) ALTRET
             14896                       (TERM70);

  14896  2 004321   000436 237000 3                  LDAQ    286
         2 004322   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004323   201010 452500                    STP2    TLEN+2,,AUTO
         2 004324   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004325   000435 036000 3                  ADLQ    285
         2 004326   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004327   005713 701000 2                  TSX1    PUT_FLAG
         2 004330   004514 702000 2                  TSX2    TERM70

      864    14897    2              CALL PUT_FLAG(VLP_TRMCTL.UPPERCASE#, 'Uppercase', LENGTHC('Uppercase'))
             14897                       ALTRET (TERM70);

  14897  2 004331   000440 237000 3                  LDAQ    288
         2 004332   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004333   201010 452500                    STP2    TLEN+2,,AUTO
         2 004334   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004335   000442 036000 3                  ADLQ    290
         2 004336   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004337   005713 701000 2                  TSX1    PUT_FLAG
         2 004340   004514 702000 2                  TSX2    TERM70

      865    14898    2              CALL PUT_FLAG(VLP_TRMCTL.WRAPPAGE#, 'WrapPage', LENGTHC('WrapPage'))
             14898                       ALTRET (TERM70);

  14898  2 004341   000444 237000 3                  LDAQ    292
         2 004342   200774 757100                    STAQ    @DECIMAL+1,,AUTO
         2 004343   201010 452500                    STP2    TLEN+2,,AUTO
         2 004344   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004345   000443 036000 3                  ADLQ    291
         2 004346   200773 756100                    STQ     VLP_TRMATTR+11,,AUTO
         2 004347   005713 701000 2                  TSX1    PUT_FLAG
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:160  
         2 004350   004514 702000 2                  TSX2    TERM70

      866    14899        /* ****          Print only if any flags are set */
      867    14900    2              LEN=POFFC(DEST$,OUTBUFF$);

  14900  2 004351   200411 236100                    LDQ     OUTBUFF$,,AUTO
         2 004352   000020 772000                    QRL     16
         2 004353   201010 756100                    STQ     TLEN+2,,AUTO
         2 004354   200412 236100                    LDQ     DEST$,,AUTO
         2 004355   000020 772000                    QRL     16
         2 004356   201010 136100                    SBLQ    TLEN+2,,AUTO
         2 004357   200457 756100                    STQ     LEN,,AUTO

      868    14901    2              IF FLAG_FOUND

  14901  2 004360   200420 234100                    SZN     FLAG_FOUND,,AUTO
         2 004361   004400 605000 2                  TPL     s:14908

      869    14902    2                 THEN
      870    14903    2                    SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,

  14903  2 004362   000000 470400 xsym               LDP0    SEG2$
         2 004363   000165 471500                    LDP1    117,,PR0
         2 004364   200411 236100                    LDQ     OUTBUFF$,,AUTO
         2 004365   000020 772000                    QRL     16
         2 004366   201010 756100                    STQ     TLEN+2,,AUTO
         2 004367   200412 236100                    LDQ     DEST$,,AUTO
         2 004370   000020 772000                    QRL     16
         2 004371   201010 136100                    SBLQ    TLEN+2,,AUTO
         2 004372   000003 136007                    SBLQ    3,DL
         2 004373   000020 736000                    QLS     16
         2 004374   100004 676100                    ERQ     4,,PR1
         2 004375   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 004376   100004 656100                    ERSQ    4,,PR1
         2 004377   004433 710000 2                  TRA     s:14913

      871    14904    2                         OUTBUFF$)-3;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:161  
      872    14905
      873    14906    2                 ELSE
      874    14907    3                    DO;

      875    14908    3                       INBUFF='none';

  14908  2 004400   040100 100400                    MLR     fill='040'O
         2 004401   001023 000004 1                  ADSC9   E_NOSUCHSTRM+278         cn=0,n=4
         2 004402   200421 000170                    ADSC9   INBUFF,,AUTO             cn=0,n=120

      876    14909    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,4) ALTRET(TERM70);

  14909  2 004403   000001 236000 3                  LDQ     1
         2 004404   201013 756100                    STQ     TLEN+5,,AUTO
         2 004405   200413 630500                    EPPR0   IN$,,AUTO
         2 004406   201012 450500                    STP0    TLEN+4,,AUTO
         2 004407   200412 631500                    EPPR1   DEST$,,AUTO
         2 004410   201011 451500                    STP1    TLEN+3,,AUTO
         2 004411   200411 633500                    EPPR3   OUTBUFF$,,AUTO
         2 004412   201010 453500                    STP3    TLEN+2,,AUTO
         2 004413   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 004414   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 004415   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 004416   004514 702000 2                  TSX2    TERM70

      877    14910    3                       SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,

  14910  2 004417   000000 470400 xsym               LDP0    SEG2$
         2 004420   000165 471500                    LDP1    117,,PR0
         2 004421   200411 236100                    LDQ     OUTBUFF$,,AUTO
         2 004422   000020 772000                    QRL     16
         2 004423   201010 756100                    STQ     TLEN+2,,AUTO
         2 004424   200412 236100                    LDQ     DEST$,,AUTO
         2 004425   000020 772000                    QRL     16
         2 004426   201010 136100                    SBLQ    TLEN+2,,AUTO
         2 004427   000020 736000                    QLS     16
         2 004430   100004 676100                    ERQ     4,,PR1
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:162  
         2 004431   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 004432   100004 656100                    ERSQ    4,,PR1

      878    14911    3                            OUTBUFF$);
      879    14912    3                    END;

      880    14913    2              CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(TERM70);

  14913  2 004433   000000 236000 xsym               LDQ     SEG2$
         2 004434   000165 036003                    ADLQ    117,DU
         2 004435   201010 756100                    STQ     TLEN+2,,AUTO
         2 004436   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 004437   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004440   000000 701000 xent               TSX1    CPE$LISTOUT
         2 004441   004514 702000 2                  TSX2    TERM70

      881    14914    2              IF DCBADDR(M$IBEX1_NUM)->F$DCB.FCD#=%YES#

  14914  2 004442   000037 470400 3                  LDP0    31
         2 004443   000000 471500                    LDP1    0,,PR0
         2 004444   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 004445   100000 473510                    LDP3    0,X0,PR1
         2 004446   300031 236100                    LDQ     25,,PR3
         2 004447   020000 316007                    CANQ    8192,DL
         2 004450   004464 600000 2                  TZE     s:14921

      882    14915    2               THEN
      883    14916    3                 DO;

      884    14917    3                   SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DCB#=M$IBEX1_NUM;

  14917  2 004451   000000 474400 xsym               LDP4    SEG2$
         2 004452   400163 475500                    LDP5    115,,PR4
         2 004453   500032 740100                    STX0    26,,PR5

      885    14918    3                   SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DISP#=%SAVE#;

PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:163  
  14918  2 004454   400163 475500                    LDP5    115,,PR4
         2 004455   000002 236007                    LDQ     2,DL
         2 004456   500032 552104                    STBQ    26,'04'O,PR5

      886    14919    3                   CALL M$CLOSE(SEG$2.FPT_CLOSE$->FPT$CLOSE) ALTRET(TERM80);

  14919  2 004457   400163 475500                    LDP5    115,,PR4
         2 004460   500000 630500                    EPPR0   0,,PR5
         2 004461   450001 713400                    CLIMB   alt,close
         2 004462   406000 401760                    pmme    nvectors=13
         2 004463   004536 702000 2                  TSX2    TERM80

      887    14920    3                 END;

      888    14921    2              IF DCBADDR(M$IBEX1_NUM)->F$DCB.FCD#=%YES#

  14921  2 004464   000037 470400 3                  LDP0    31
         2 004465   000000 471500                    LDP1    0,,PR0
         2 004466   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 004467   100000 473510                    LDP3    0,X0,PR1
         2 004470   300031 236100                    LDQ     25,,PR3
         2 004471   020000 316007                    CANQ    8192,DL
         2 004472   004506 600000 2                  TZE     s:14928

      889    14922    2               THEN
      890    14923    3                 DO;

      891    14924    3                   SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DCB#=M$IBEX1_NUM;

  14924  2 004473   000000 474400 xsym               LDP4    SEG2$
         2 004474   400163 475500                    LDP5    115,,PR4
         2 004475   500032 740100                    STX0    26,,PR5

      892    14925    3                   SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DISP#=%SAVE#;

  14925  2 004476   400163 475500                    LDP5    115,,PR4
         2 004477   000002 236007                    LDQ     2,DL
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:164  
         2 004500   500032 552104                    STBQ    26,'04'O,PR5

      893    14926    3                   CALL M$CLOSE(SEG$2.FPT_CLOSE$->FPT$CLOSE) ALTRET(TERM80);

  14926  2 004501   400163 475500                    LDP5    115,,PR4
         2 004502   500000 630500                    EPPR0   0,,PR5
         2 004503   450001 713400                    CLIMB   alt,close
         2 004504   406000 401760                    pmme    nvectors=13
         2 004505   004536 702000 2                  TSX2    TERM80

      894    14927    3                 END;

      895    14928    2              RETURN;

  14928  2 004506   000000 702200 xent               TSX2  ! X66_ARET

  14926  2 004507                       TERM50       null
      896    14929    2           END;
      897    14930    1   TERM50: ;
      898    14931    1     B$JIT.USRERR = B$TCB.ALT$ -> B$EXCFR.ERR;

  14931  2 004507   000000 470400 xsym               LDP0    B$TCB$
         2 004510   000000 471500                    LDP1    0,,PR0
         2 004511   100102 236100                    LDQ     66,,PR1
         2 004512   000000 473400 xsym               LDP3    B$JIT$
         2 004513   300144 756100                    STQ     100,,PR3

  14931  2 004514                       TERM70       null
      899    14932    1   TERM70: ;
      900    14933    1     IF DCBADDR(M$IBEX1_NUM)->F$DCB.FCD#=%YES#

  14933  2 004514   000037 470400 3                  LDP0    31
         2 004515   000000 471500                    LDP1    0,,PR0
         2 004516   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 004517   100000 473510                    LDP3    0,X0,PR1
         2 004520   300031 236100                    LDQ     25,,PR3
         2 004521   020000 316007                    CANQ    8192,DL
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:165  
         2 004522   004536 600000 2                  TZE     TERM80

      901    14934    1        THEN
      902    14935    2           DO;

      903    14936    2              SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DCB#=M$IBEX1_NUM;

  14936  2 004523   000000 474400 xsym               LDP4    SEG2$
         2 004524   400163 475500                    LDP5    115,,PR4
         2 004525   500032 740100                    STX0    26,,PR5

      904    14937    2              SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DISP#=%SAVE#;

  14937  2 004526   400163 475500                    LDP5    115,,PR4
         2 004527   000002 236007                    LDQ     2,DL
         2 004530   500032 552104                    STBQ    26,'04'O,PR5

      905    14938    2              CALL M$CLOSE(SEG$2.FPT_CLOSE$->FPT$CLOSE) ALTRET(TERM80);

  14938  2 004531   400163 475500                    LDP5    115,,PR4
         2 004532   500000 630500                    EPPR0   0,,PR5
         2 004533   450001 713400                    CLIMB   alt,close
         2 004534   406000 401760                    pmme    nvectors=13
         2 004535   004536 702000 2                  TSX2    TERM80

      906    14939    2           END;

  14939  2 004536                       TERM80       null
      907    14940    1   TERM80: ;
      908    14941    1     ALTRETURN;

  14941  2 004536   000000 702200 xent               TSX2  ! X66_AALT

      909    14942                   %EJECT;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:166  
      910    14943        /**********************************************************************/
      911    14944        /*F*   NAME:   CPF$PRIV
      912    14945               PURPOSE: The PRIV command is utilized to set,reset or display
      913    14946                       user privileges.
      914    14947               DESCRIPTION: Privileges which may be set are those which were
      915    14948                       previously established by the system manager via Super.
      916    14949               REFERENCE: Programmers Reference Manual
      917    14950        */
      918    14951        /*D*   NAME:   CPF$PRIV
      919    14952               CALL:   CALL CPF$PRIV(P$PCB)
      920    14953               INTERFACE: CPE$LISTOUT,CPB$BLDIMAGE
      921    14954               INPUT:  parse control block
      922    14955                       B$JIT.PRIV.AUTH
      923    14956               OUTPUT: B$JIT.PRIV.JOB - set,reset or displayed
      924    14957               DESCRIPTION: If no sub-blocks are found, privileges found in the
      925    14958                       JIT are displayed. Otherwise, any or all authorized
      926    14959                       privileges specified in B$JIT.PRIV.AUTH are
      927    14960                       set or reset in B$JIT.PRIV.JOB.
      928    14961        */
      929    14962        /**********************************************************************/
      930    14963    1   CPF$PRIV: ENTRY(P$PCB) ALTRET;

  14963  2 004537   000000 700200 xent  CPF$PRIV     TSX0  ! X66_AUTO_1
         2 004540   001066 000001                    ZERO    566,1

      931    14964        /**/
      932    14965    1     BLK$=P$PCB.OUT$;

  14965  2 004541   200003 470500                    LDP0    @P$PCB,,AUTO
         2 004542   000003 236100                    LDQ     3,,PR0
         2 004543   200004 756100                    STQ     BLK$,,AUTO

      933    14966        /*
      934    14967          ****     No options following verb infers ... Display privileges
      935    14968        */
      936    14969    1     IF (BLK$->P$B.NSUBLKS=0)

PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:167  
  14969  2 004544   200004 471500                    LDP1    BLK$,,AUTO
         2 004545   100001 220100                    LDX0    1,,PR1
         2 004546   004772 601000 2                  TNZ     s:15024

      937    14970    1        THEN
      938    14971    2   PRIV5:  DO;

  14971  2 004547                       PRIV5        null
      939    14972        /*
      940    14973          ****     Output header
      941    14974        */
      942    14975    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_=VECTOR(PRIVHDR);

  14975  2 004547   000000 473400 xsym               LDP3    SEG2$
         2 004550   300165 474500                    LDP4    117,,PR3
         2 004551   000446 237000 3                  LDAQ    294
         2 004552   400004 757100                    STAQ    4,,PR4

      943    14976    2              CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(PRIV45);

  14976  2 004553   000000 236000 xsym               LDQ     SEG2$
         2 004554   000165 036003                    ADLQ    117,DU
         2 004555   201010 756100                    STQ     TLEN+2,,AUTO
         2 004556   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 004557   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004560   000000 701000 xent               TSX1    CPE$LISTOUT
         2 004561   005171 702000 2                  TSX2    PRIV45

      944    14977        /*
      945    14978          ****     Perform init. Functions
      946    14979        */
      947    14980    2              OUTBUFF$=ADDR(OUTBUFF);         /*Ptr to BUFF.BEGNG*/

  14980  2 004562   200011 630500                    EPPR0   OUTBUFF,,AUTO
         2 004563   200411 450500                    STP0    OUTBUFF$,,AUTO

      948    14981    2              DEST$=OUTBUFF$;                 /*Dynamic ptr*/
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:168  

  14981  2 004564   200411 236100                    LDQ     OUTBUFF$,,AUTO
         2 004565   200412 756100                    STQ     DEST$,,AUTO

      949    14982    2              IN$=ADDR(INBUFF);

  14982  2 004566   200421 631500                    EPPR1   INBUFF,,AUTO
         2 004567   200413 451500                    STP1    IN$,,AUTO

      950    14983    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;

  14983  2 004570   000000 473400 xsym               LDP3    SEG2$
         2 004571   300165 474500                    LDP4    117,,PR3
         2 004572   400005 756100                    STQ     5,,PR4

      951    14984    2              TAB_VAL=6;                         /*Set tab value*/

  14984  2 004573   000006 235007                    LDA     6,DL
         2 004574   200460 755100                    STA     TAB_VAL,,AUTO

      952    14985        /*
      953    14986          ****     Output privileges which are on
      954    14987        */
      955    14988    2              INBUFF='On: ';

  14988  2 004575   040100 100400                    MLR     fill='040'O
         2 004576   001024 000004 1                  ADSC9   E_NOSUCHSTRM+279         cn=0,n=4
         2 004577   200421 000170                    ADSC9   INBUFF,,AUTO             cn=0,n=120

      956    14989    2              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC('On: ')

  14989  2 004600   200460 630500                    EPPR0   TAB_VAL,,AUTO
         2 004601   201014 450500                    STP0    TLEN+6,,AUTO
         2 004602   000001 236000 3                  LDQ     1
         2 004603   201013 756100                    STQ     TLEN+5,,AUTO
         2 004604   200413 631500                    EPPR1   IN$,,AUTO
         2 004605   201012 451500                    STP1    TLEN+4,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:169  
         2 004606   200412 634500                    EPPR4   DEST$,,AUTO
         2 004607   201011 454500                    STP4    TLEN+3,,AUTO
         2 004610   200411 635500                    EPPR5   OUTBUFF$,,AUTO
         2 004611   201010 455500                    STP5    TLEN+2,,AUTO
         2 004612   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 004613   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 004614   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 004615   005171 702000 2                  TSX2    PRIV45

      957    14990    2                   ,TAB_VAL) ALTRET(PRIV45);
      958    14991        /**/
      959    14992    3              DO I=0 TO SIZEC(PRIV_TBL)/SIZEC(PRIV_TBL(0))-1;

  14992  2 004616   200005 450100                    STZ     I,,AUTO
         2 004617   004676 710000 2                  TRA     s:15003+1

      960    14993    3                 IF B$JIT.PRIV.JOB & PRIV_TBL.MASK(I)

  14993  2 004620   000000 470400 xsym               LDP0    B$JIT$
         2 004621   200005 235100                    LDA     I,,AUTO
         2 004622   000002 735000                    ALS     2
         2 004623   000015 236100                    LDQ     13,,PR0
         2 004624   000146 376005 1                  ANQ     PRIV_TBL+2,AL
         2 004625   004675 600000 2                  TZE     s:15003

      961    14994    3                    THEN
      962    14995    4                       DO;

      963    14996    4                          INBUFF = PRIV_TBL.HDR(I);

  14996  2 004626   200005 236100                    LDQ     I,,AUTO
         2 004627   000004 736000                    QLS     4
         2 004630   040100 100406                    MLR     fill='040'O
         2 004631   000144 200007 1                  ADSC9   PRIV_TBL,Q               cn=1,n=7
         2 004632   200421 000170                    ADSC9   INBUFF,,AUTO             cn=0,n=120

      964    14997    4                          LEN = PRIV_TBL.LEN(I);
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:170  

  14997  2 004633   000144 236005 1                  LDQ     PRIV_TBL,AL
         2 004634   000033 772000                    QRL     27
         2 004635   200457 756100                    STQ     LEN,,AUTO

      965    14998    4                          CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL)

  14998  2 004636   200460 631500                    EPPR1   TAB_VAL,,AUTO
         2 004637   201014 451500                    STP1    TLEN+6,,AUTO
         2 004640   200457 633500                    EPPR3   LEN,,AUTO
         2 004641   201013 453500                    STP3    TLEN+5,,AUTO
         2 004642   200413 634500                    EPPR4   IN$,,AUTO
         2 004643   201012 454500                    STP4    TLEN+4,,AUTO
         2 004644   200412 635500                    EPPR5   DEST$,,AUTO
         2 004645   201011 455500                    STP5    TLEN+3,,AUTO
         2 004646   200411 636500                    EPPR6   OUTBUFF$,,AUTO
         2 004647   201010 456500                    STP6    TLEN+2,,AUTO
         2 004650   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 004651   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 004652   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 004653   005171 702000 2                  TSX2    PRIV45

      966    14999    4                               ALTRET(PRIV45);
      967    15000    4                          INBUFF = ',';

  15000  2 004654   040100 100400                    MLR     fill='040'O
         2 004655   000002 000001 3                  ADSC9   2                        cn=0,n=1
         2 004656   200421 000170                    ADSC9   INBUFF,,AUTO             cn=0,n=120

      968    15001    4                         CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL) ALTRET(PRIV45
             15001                                   );

  15001  2 004657   200460 630500                    EPPR0   TAB_VAL,,AUTO
         2 004660   201014 450500                    STP0    TLEN+6,,AUTO
         2 004661   000003 236000 3                  LDQ     3
         2 004662   201013 756100                    STQ     TLEN+5,,AUTO
         2 004663   200413 631500                    EPPR1   IN$,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:171  
         2 004664   201012 451500                    STP1    TLEN+4,,AUTO
         2 004665   200412 633500                    EPPR3   DEST$,,AUTO
         2 004666   201011 453500                    STP3    TLEN+3,,AUTO
         2 004667   200411 634500                    EPPR4   OUTBUFF$,,AUTO
         2 004670   201010 454500                    STP4    TLEN+2,,AUTO
         2 004671   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 004672   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 004673   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 004674   005171 702000 2                  TSX2    PRIV45

      969    15002    4                       END;

      970    15003    3              END;

  15003  2 004675   200005 054100                    AOS     I,,AUTO
         2 004676   200005 235100                    LDA     I,,AUTO
         2 004677   000025 115007                    CMPA    21,DL
         2 004700   004620 604400 2                  TMOZ    s:14993

      971    15004        /**/
      972    15005    2              CALL INDEX (I, 'On: ', OUTBUFF) ALTRET(OUTPUT_LAST_LINE);

  15005  2 004701   200005 631500                    EPPR1   I,,AUTO
         2 004702   001024 633400 1                  EPPR3   E_NOSUCHSTRM+279
         2 004703   000004 223003                    LDX3    4,DU
         2 004704   200011 630500                    EPPR0   OUTBUFF,,AUTO
         2 004705   002000 220003                    LDX0    1024,DU
         2 004706   000000 236003                    LDQ     0,DU
         2 004707   000000 701000 xent               TSX1    X66_INDEX
         2 004710   004745 710000 2                  TRA     OUTPUT_LAST_LINE

      973    15006    2              IF POFFC(DEST$,OUTBUFF$) = SIZEC('On: ')+TAB_VAL

  15006  2 004711   200411 236100                    LDQ     OUTBUFF$,,AUTO
         2 004712   000020 772000                    QRL     16
         2 004713   201010 756100                    STQ     TLEN+2,,AUTO
         2 004714   200412 236100                    LDQ     DEST$,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:172  
         2 004715   000020 772000                    QRL     16
         2 004716   201010 136100                    SBLQ    TLEN+2,,AUTO
         2 004717   200460 235100                    LDA     TAB_VAL,,AUTO
         2 004720   000004 035007                    ADLA    4,DL
         2 004721   201011 755100                    STA     TLEN+3,,AUTO
         2 004722   201011 116100                    CMPQ    TLEN+3,,AUTO
         2 004723   004745 601000 2                  TNZ     OUTPUT_LAST_LINE

      974    15007    2                 THEN
      975    15008    3                    DO;

      976    15009    3                       INBUFF='none,';

  15009  2 004724   040100 100400                    MLR     fill='040'O
         2 004725   001025 000005 1                  ADSC9   E_NOSUCHSTRM+280         cn=0,n=5
         2 004726   200421 000170                    ADSC9   INBUFF,,AUTO             cn=0,n=120

      977    15010    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC('none,')

  15010  2 004727   200460 630500                    EPPR0   TAB_VAL,,AUTO
         2 004730   201014 450500                    STP0    TLEN+6,,AUTO
         2 004731   000115 236000 3                  LDQ     77
         2 004732   201013 756100                    STQ     TLEN+5,,AUTO
         2 004733   200413 631500                    EPPR1   IN$,,AUTO
         2 004734   201012 451500                    STP1    TLEN+4,,AUTO
         2 004735   200412 633500                    EPPR3   DEST$,,AUTO
         2 004736   201011 453500                    STP3    TLEN+3,,AUTO
         2 004737   200411 634500                    EPPR4   OUTBUFF$,,AUTO
         2 004740   201010 454500                    STP4    TLEN+2,,AUTO
         2 004741   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 004742   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 004743   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 004744   005171 702000 2                  TSX2    PRIV45

      978    15011    3                            ,TAB_VAL) ALTRET(PRIV45);
      979    15012    3                    END;

PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:173  
      980    15013    2   OUTPUT_LAST_LINE:
      981    15014    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,

  15014  2 004745   000000 470400 xsym  OUTPUT_LAST* LDP0    SEG2$
         2 004746   000165 471500                    LDP1    117,,PR0
         2 004747   200411 236100                    LDQ     OUTBUFF$,,AUTO
         2 004750   000020 772000                    QRL     16
         2 004751   201010 756100                    STQ     TLEN+2,,AUTO
         2 004752   200412 236100                    LDQ     DEST$,,AUTO
         2 004753   000020 772000                    QRL     16
         2 004754   201010 136100                    SBLQ    TLEN+2,,AUTO
         2 004755   000002 136007                    SBLQ    2,DL
         2 004756   000020 736000                    QLS     16
         2 004757   100004 676100                    ERQ     4,,PR1
         2 004760   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 004761   100004 656100                    ERSQ    4,,PR1

      982    15015    2                   OUTBUFF$)-2;
      983    15016    2              CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(PRIV45);

  15016  2 004762   000000 236000 xsym               LDQ     SEG2$
         2 004763   000165 036003                    ADLQ    117,DU
         2 004764   201010 756100                    STQ     TLEN+2,,AUTO
         2 004765   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 004766   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004767   000000 701000 xent               TSX1    CPE$LISTOUT
         2 004770   005171 702000 2                  TSX2    PRIV45

      984    15017    2              RETURN;

  15017  2 004771   000000 702200 xent               TSX2  ! X66_ARET

      985    15018    2           END PRIV5;
      986    15019        /*
      987    15020          ****     Set,reset privilege flags
      988    15021          ****     Only those flags authorized in B$JIT.PRIV.AUTH may be
      989    15022          ****     Messed with.
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:174  
      990    15023        */
      991    15024    1     PRIV_ERR=%NO#;

  15024  2 004772   200471 450100                    STZ     PRIV_ERR,,AUTO

      992    15025    1     I=0;

  15025  2 004773   200005 450100                    STZ     I,,AUTO

      993    15026    1     USER_PRIV.V_=VECTOR(USER_PRIV.V);

  15026  2 004774   000005 235000 3                  LDA     5
         2 004775   201010 452500                    STP2    TLEN+2,,AUTO
         2 004776   201010 236100                    LDQ     TLEN+2,,AUTO
         2 004777   000706 036003                    ADLQ    454,DU
         2 005000   200704 757100                    STAQ    USER_PRIV,,AUTO

      994    15027    1     USER_PRIV.V.AUTH#=%YES#;

  15027  2 005001   400000 236003                    LDQ     -131072,DU
         2 005002   200707 256100                    ORSQ    USER_PRIV+3,,AUTO

      995    15028    1     USER_PRIV.V.PPRIV#=%NO#;

  15028  2 005003   000450 236000 3                  LDQ     296
         2 005004   200707 356100                    ANSQ    USER_PRIV+3,,AUTO

      996    15029    1   PRIV10:
      997    15030    2     DO WHILE (I < BLK$->P$B.NSUBLKS);

  15030  2 005005   100001 236100       PRIV10       LDQ     1,,PR1
         2 005006   000022 772000                    QRL     18
         2 005007   200005 116100                    CMPQ    I,,AUTO
         2 005010   005163 604400 2                  TMOZ    s:15087

      998    15031    2        SET_PRIVS = %NO# ;

PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:175  
  15031  2 005011   200467 450100                    STZ     SET_PRIVS,,AUTO

      999    15032    2        RESET_PRIVS = %NO# ;

  15032  2 005012   200470 450100                    STZ     RESET_PRIVS,,AUTO

     1000    15033    2        TEMP$=BLK$->P$B.SUBLK$(I);

  15033  2 005013   200004 470500                    LDP0    BLK$,,AUTO
         2 005014   200005 720100                    LXL0    I,,AUTO
         2 005015   000003 236110                    LDQ     3,X0,PR0
         2 005016   200010 756100                    STQ     TEMP$,,AUTO

     1001    15034    2        IF TEMP$->P$B.CODE=IBEX_ALL THEN

  15034  2 005017   200010 471500                    LDP1    TEMP$,,AUTO
         2 005020   100000 721100                    LXL1    0,,PR1
         2 005021   000062 101003                    CMPX1   50,DU
         2 005022   005042 601000 2                  TNZ     PRIV20

     1002    15035    3           DO CASE(TEMP$->P$B.SUBLK$(0)->P$B.CODE);

  15035  2 005023   100003 473500                    LDP3    3,,PR1
         2 005024   300000 722100                    LXL2    0,,PR3
         2 005025   000002 102003                    CMPX2   2,DU
         2 005026   005030 602012 2                  TNC     s:15035+5,X2
         2 005027   005076 710000 2                  TRA     s:15057
         2 005030   005032 710000 2                  TRA     s:15037
         2 005031   005036 710000 2                  TRA     s:15039

     1003    15036    3             CASE(IBEX_NO);

     1004    15037    3               RESET_PRIVS=B$JIT.PRIV.AUTH;

  15037  2 005032   000000 474400 xsym               LDP4    B$JIT$
         2 005033   400014 236100                    LDQ     12,,PR4
         2 005034   200470 756100                    STQ     RESET_PRIVS,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:176  
         2 005035   005076 710000 2                  TRA     s:15057

     1005    15038    3             CASE(IBEX_YES);

     1006    15039    3               SET_PRIVS=B$JIT.PRIV.AUTH;

  15039  2 005036   000000 474400 xsym               LDP4    B$JIT$
         2 005037   400014 236100                    LDQ     12,,PR4
         2 005040   200467 756100                    STQ     SET_PRIVS,,AUTO

     1007    15040    3             END;

  15040  2 005041   005076 710000 2                  TRA     s:15057

     1008    15041    2        ELSE
     1009    15042    2   PRIV20:
     1010    15043    3        DO J=0 TO %NUM_PRIVS-1;

  15043  2 005042   200006 450100       PRIV20       STZ     J,,AUTO
         2 005043   005073 710000 2                  TRA     s:15053+1

     1011    15044    4           IF PRIV_TBL.CODE(J)=TEMP$->P$B.CODE THEN DO;

  15044  2 005044   200006 235100                    LDA     J,,AUTO
         2 005045   000002 735000                    ALS     2
         2 005046   200010 470500                    LDP0    TEMP$,,AUTO
         2 005047   000000 236100                    LDQ     0,,PR0
         2 005050   777777 376007                    ANQ     -1,DL
         2 005051   000147 116005 1                  CMPQ    PRIV_TBL+3,AL
         2 005052   005072 601000 2                  TNZ     s:15053

     1012    15045    5              DO CASE(TEMP$->P$B.SUBLK$(0)->P$B.CODE);

  15045  2 005053   000003 471500                    LDP1    3,,PR0
         2 005054   100000 720100                    LXL0    0,,PR1
         2 005055   000002 100003                    CMPX0   2,DU
         2 005056   005060 602010 2                  TNC     s:15045+5,X0
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:177  
         2 005057   005071 710000 2                  TRA     s:15051
         2 005060   005062 710000 2                  TRA     s:15047
         2 005061   005066 710000 2                  TRA     s:15049

     1013    15046    5                CASE(IBEX_NO);

     1014    15047    5                  RESET_PRIVS=RESET_PRIVS | PRIV_TBL.MASK(J);

  15047  2 005062   200470 236100                    LDQ     RESET_PRIVS,,AUTO
         2 005063   000146 276005 1                  ORQ     PRIV_TBL+2,AL
         2 005064   200470 756100                    STQ     RESET_PRIVS,,AUTO
         2 005065   005071 710000 2                  TRA     s:15051

     1015    15048    5                CASE(IBEX_YES);

     1016    15049    5                  SET_PRIVS=SET_PRIVS | PRIV_TBL.MASK(J);

  15049  2 005066   200467 236100                    LDQ     SET_PRIVS,,AUTO
         2 005067   000146 276005 1                  ORQ     PRIV_TBL+2,AL
         2 005070   200467 756100                    STQ     SET_PRIVS,,AUTO

     1017    15050    5                END;

     1018    15051    4              EXIT PRIV20;

  15051  2 005071   005076 710000 2                  TRA     s:15057

     1019    15052    4              END;
     1020    15053    3           END PRIV20;

  15053  2 005072   200006 054100                    AOS     J,,AUTO
         2 005073   200006 235100                    LDA     J,,AUTO
         2 005074   000025 115007                    CMPA    21,DL
         2 005075   005044 604400 2                  TMOZ    s:15044

     1021    15054        /*
     1022    15055            **** Set the active priv based on the new job priv
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:178  
     1023    15056        */
     1024    15057    2     IF SET_PRIVS ~= %NO#

  15057  2 005076   200467 235100                    LDA     SET_PRIVS,,AUTO
         2 005077   005124 600000 2                  TZE     s:15068

     1025    15058    2         THEN
     1026    15059    3             DO ;

     1027    15060    3               USER_PRIV.V.PRIV#=SET_PRIVS;

  15060  2 005100   200467 236100                    LDQ     SET_PRIVS,,AUTO
         2 005101   200706 756100                    STQ     USER_PRIV+2,,AUTO

     1028    15061    4               CALL M$SPRIV(USER_PRIV) WHENALTRETURN DO;

  15061  2 005102   200704 630500                    EPPR0   USER_PRIV,,AUTO
         2 005103   420012 713400                    CLIMB   alt,+8202
         2 005104   400000 401760                    pmme    nvectors=1
         2 005105   005107 702000 2                  TSX2    s:15062
         2 005106   005115 710000 2                  TRA     s:15065

     1029    15062    4                                         PRIV_ERR=%YES#;

  15062  2 005107   400000 236003                    LDQ     -131072,DU
         2 005110   200471 756100                    STQ     PRIV_ERR,,AUTO

     1030    15063    4                                         SET_PRIVS=SET_PRIVS & B$JIT.PRIV.ACTIVE;

  15063  2 005111   000000 470400 xsym               LDP0    B$JIT$
         2 005112   200467 236100                    LDQ     SET_PRIVS,,AUTO
         2 005113   000013 376100                    ANQ     11,,PR0
         2 005114   200467 756100                    STQ     SET_PRIVS,,AUTO

     1031    15064    4                                       END;

     1032    15065    3               B$JIT.PRIV.JOB = B$JIT.PRIV.JOB | SET_PRIVS;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:179  

  15065  2 005115   000000 470400 xsym               LDP0    B$JIT$
         2 005116   000015 236100                    LDQ     13,,PR0
         2 005117   200467 276100                    ORQ     SET_PRIVS,,AUTO
         2 005120   000015 756100                    STQ     13,,PR0

     1033    15066    3               B$JIT.PRIV.SAVED = B$JIT.PRIV.SAVED | SET_PRIVS;

  15066  2 005121   000017 236100                    LDQ     15,,PR0
         2 005122   200467 276100                    ORQ     SET_PRIVS,,AUTO
         2 005123   000017 756100                    STQ     15,,PR0

     1034    15067    3             END ; /* Then Do */

     1035    15068    2     IF RESET_PRIVS ~= %NO#

  15068  2 005124   200470 235100                    LDA     RESET_PRIVS,,AUTO
         2 005125   005155 600000 2                  TZE     s:15081

     1036    15069    2         THEN
     1037    15070    3             DO ;

     1038    15071    3               USER_PRIV.V.PRIV#=RESET_PRIVS;

  15071  2 005126   200470 236100                    LDQ     RESET_PRIVS,,AUTO
         2 005127   200706 756100                    STQ     USER_PRIV+2,,AUTO

     1039    15072    3               CALL M$RPRIV(USER_PRIV);

  15072  2 005130   200704 630500                    EPPR0   USER_PRIV,,AUTO
         2 005131   020013 713400                    CLIMB   8203
         2 005132   400000 401760                    pmme    nvectors=1

     1040    15073    4               IF (RESET_PRIVS&B$JIT.PRIV.AUTH) ~= RESET_PRIVS THEN DO;

  15073  2 005133   000000 470400 xsym               LDP0    B$JIT$
         2 005134   200470 236100                    LDQ     RESET_PRIVS,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:180  
         2 005135   000014 376100                    ANQ     12,,PR0
         2 005136   200470 116100                    CMPQ    RESET_PRIVS,,AUTO
         2 005137   005145 600000 2                  TZE     s:15077

     1041    15074    4                 PRIV_ERR=%YES#;

  15074  2 005140   400000 236003                    LDQ     -131072,DU
         2 005141   200471 756100                    STQ     PRIV_ERR,,AUTO

     1042    15075    4                 RESET_PRIVS=RESET_PRIVS & B$JIT.PRIV.AUTH;

  15075  2 005142   200470 236100                    LDQ     RESET_PRIVS,,AUTO
         2 005143   000014 376100                    ANQ     12,,PR0
         2 005144   200470 756100                    STQ     RESET_PRIVS,,AUTO

     1043    15076    4                 END;

     1044    15077    3               RESET_PRIVS=~RESET_PRIVS;

  15077  2 005145   200470 236100                    LDQ     RESET_PRIVS,,AUTO
         2 005146   000027 676000 xsym               ERQ     B_VECTNIL+23
         2 005147   200470 756100                    STQ     RESET_PRIVS,,AUTO

     1045    15078    3               B$JIT.PRIV.JOB = B$JIT.PRIV.JOB & RESET_PRIVS;

  15078  2 005150   000015 376100                    ANQ     13,,PR0
         2 005151   000015 756100                    STQ     13,,PR0

     1046    15079    3               B$JIT.PRIV.SAVED = B$JIT.PRIV.SAVED & RESET_PRIVS;

  15079  2 005152   000017 236100                    LDQ     15,,PR0
         2 005153   200470 376100                    ANQ     RESET_PRIVS,,AUTO
         2 005154   000017 756100                    STQ     15,,PR0

     1047    15080    3             END ; /* Then Do */

     1048    15081    2        I=I+1;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:181  

  15081  2 005155   200005 054100                    AOS     I,,AUTO

     1049    15082    2        END PRIV10;

  15082  2 005156   200004 470500                    LDP0    BLK$,,AUTO
         2 005157   000001 236100                    LDQ     1,,PR0
         2 005160   000022 772000                    QRL     18
         2 005161   200005 116100                    CMPQ    I,,AUTO
         2 005162   005011 605400 2                  TPNZ    s:15031

     1050    15083        /*
     1051    15084          ****     See if any unauthorized privileges were requested to be set
     1052    15085          ****     Or reset.
     1053    15086        */
     1054    15087    1     IF PRIV_ERR=%NO#

  15087  2 005163   200471 234100                    SZN     PRIV_ERR,,AUTO
         2 005164   005166 604000 2                  TMI     s:15095

     1055    15088    1        THEN
     1056    15089    1           RETURN;

  15089  2 005165   000000 702200 xent               TSX2  ! X66_ARET

     1057    15090        /*E*       ERROR:   CPF-E$NOPRIVLGE-E
     1058    15091                   MESSAGE: Cannot effect entire privilege change requested
     1059    15092                   DESCRIPTION: User attempted to turn on or off, an unathorized
     1060    15093                            privilege flag in the JIT.
     1061    15094        */
     1062    15095    1     B$JIT.USRERR = E_NOPRIVLGE;

  15095  2 005166   000374 236000 1                  LDQ     E_NOPRIVLGE
         2 005167   000000 470400 xsym               LDP0    B$JIT$
         2 005170   000144 756100                    STQ     100,,PR0

  15095  2 005171                       PRIV45       null
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:182  
     1063    15096    1   PRIV45: ;
     1064    15097    1     ALTRETURN;

  15097  2 005171   000000 702200 xent               TSX2  ! X66_AALT

     1065    15098                   %EJECT;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:183  
     1066    15099        /**********************************************************************/
     1067    15100        /*F*   NAME:   CPF$PPRIV
     1068    15101            PURPOSE: The DISPLAY PPRIV command is utilized to display processor privileges.
     1069    15102               DESCRIPTION: The processor privileges in the JIT are displayed.
     1070    15103               REFERENCE: Programmers Reference Manual
     1071    15104        */
     1072    15105        /*D*   NAME:   CPF$PPRIV
     1073    15106               CALL:   CALL CPF$PPRIV(P$PCB)
     1074    15107               INTERFACE: CPE$LISTOUT,CPB$BLDIMAGE
     1075    15108               INPUT:  B$JIT.PPRIV
     1076    15109               OUTPUT: privileges displayed
     1077    15110               DESCRIPTION: Processor privileges found in the JIT are displayed.
     1078    15111        */
     1079    15112        /**********************************************************************/
     1080    15113    1   CPF$PPRIV: ENTRY ALTRET;

  15113  2 005172   000000 700200 xent  CPF$PPRIV    TSX0  ! X66_AUTO_1
         2 005173   001066 000001                    ZERO    566,1

     1081    15114        /*
     1082    15115          ****  Output header
     1083    15116        */
     1084    15117    1     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_=VECTOR(PPRIV_HDR);

  15117  2 005174   000000 470400 xsym               LDP0    SEG2$
         2 005175   000165 471500                    LDP1    117,,PR0
         2 005176   000452 237000 3                  LDAQ    298
         2 005177   100004 757100                    STAQ    4,,PR1

     1085    15118    1     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(PPRIV45);

  15118  2 005200   000000 236000 xsym               LDQ     SEG2$
         2 005201   000165 036003                    ADLQ    117,DU
         2 005202   201010 756100                    STQ     TLEN+2,,AUTO
         2 005203   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 005204   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005205   000000 701000 xent               TSX1    CPE$LISTOUT
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:184  
         2 005206   005414 702000 2                  TSX2    PPRIV45

     1086    15119        /*
     1087    15120          ****  Perform init. Functions
     1088    15121        */
     1089    15122    1     OUTBUFF$=ADDR(OUTBUFF);         /*Ptr to BUFF.BEGNG*/

  15122  2 005207   200011 630500                    EPPR0   OUTBUFF,,AUTO
         2 005210   200411 450500                    STP0    OUTBUFF$,,AUTO

     1090    15123    1     DEST$=OUTBUFF$;                 /*Dynamic ptr*/

  15123  2 005211   200411 236100                    LDQ     OUTBUFF$,,AUTO
         2 005212   200412 756100                    STQ     DEST$,,AUTO

     1091    15124    1     IN$=ADDR(INBUFF);

  15124  2 005213   200421 631500                    EPPR1   INBUFF,,AUTO
         2 005214   200413 451500                    STP1    IN$,,AUTO

     1092    15125    1     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;

  15125  2 005215   000000 473400 xsym               LDP3    SEG2$
         2 005216   300165 474500                    LDP4    117,,PR3
         2 005217   400005 756100                    STQ     5,,PR4

     1093    15126    1     TAB_VAL=6;                         /*Set tab value*/

  15126  2 005220   000006 235007                    LDA     6,DL
         2 005221   200460 755100                    STA     TAB_VAL,,AUTO

     1094    15127        /*
     1095    15128          ****  Output privileges which are on
     1096    15129        */
     1097    15130    1     INBUFF='On: ';

  15130  2 005222   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:185  
         2 005223   001024 000004 1                  ADSC9   E_NOSUCHSTRM+279         cn=0,n=4
         2 005224   200421 000170                    ADSC9   INBUFF,,AUTO             cn=0,n=120

     1098    15131    1     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC('On: ')

  15131  2 005225   200460 630500                    EPPR0   TAB_VAL,,AUTO
         2 005226   201014 450500                    STP0    TLEN+6,,AUTO
         2 005227   000001 236000 3                  LDQ     1
         2 005230   201013 756100                    STQ     TLEN+5,,AUTO
         2 005231   200413 631500                    EPPR1   IN$,,AUTO
         2 005232   201012 451500                    STP1    TLEN+4,,AUTO
         2 005233   200412 634500                    EPPR4   DEST$,,AUTO
         2 005234   201011 454500                    STP4    TLEN+3,,AUTO
         2 005235   200411 635500                    EPPR5   OUTBUFF$,,AUTO
         2 005236   201010 455500                    STP5    TLEN+2,,AUTO
         2 005237   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 005240   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 005241   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 005242   005414 702000 2                  TSX2    PPRIV45

     1099    15132    1          ,TAB_VAL) ALTRET(PPRIV45);
     1100    15133    2     DO I=0 TO SIZEC(PPRIV_TBL)/SIZEC(PPRIV_TBL(0))-1;

  15133  2 005243   200005 450100                    STZ     I,,AUTO
         2 005244   005330 710000 2                  TRA     s:15144+1

     1101    15134    2        IF B$JIT.PPRIV & PPRIV_TBL.MASK(I)

  15134  2 005245   000000 470400 xsym               LDP0    B$JIT$
         2 005246   200005 235100                    LDA     I,,AUTO
         2 005247   000002 735000                    ALS     2
         2 005250   000027 236005 1                  LDQ     PPRIV_TBL+3,AL
         2 005251   000026 235005 1                  LDA     PPRIV_TBL+2,AL
         2 005252   000022 773000                    LRL     18
         2 005253   000027 376000 xsym               ANQ     B_VECTNIL+23
         2 005254   000020 376100                    ANQ     16,,PR0
         2 005255   005327 600000 2                  TZE     s:15144
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:186  

     1102    15135    2           THEN
     1103    15136    3              DO;

     1104    15137    3                 INBUFF = PPRIV_TBL.HDR(I);

  15137  2 005256   200005 235100                    LDA     I,,AUTO
         2 005257   000004 735000                    ALS     4
         2 005260   040100 100405                    MLR     fill='040'O
         2 005261   000024 200011 1                  ADSC9   PPRIV_TBL,A              cn=1,n=9
         2 005262   200421 000170                    ADSC9   INBUFF,,AUTO             cn=0,n=120

     1105    15138    3                 LEN = PPRIV_TBL.LEN(I);

  15138  2 005263   200005 236100                    LDQ     I,,AUTO
         2 005264   000002 736000                    QLS     2
         2 005265   000024 236006 1                  LDQ     PPRIV_TBL,QL
         2 005266   000033 772000                    QRL     27
         2 005267   200457 756100                    STQ     LEN,,AUTO

     1106    15139    3                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL)

  15139  2 005270   200460 631500                    EPPR1   TAB_VAL,,AUTO
         2 005271   201014 451500                    STP1    TLEN+6,,AUTO
         2 005272   200457 633500                    EPPR3   LEN,,AUTO
         2 005273   201013 453500                    STP3    TLEN+5,,AUTO
         2 005274   200413 634500                    EPPR4   IN$,,AUTO
         2 005275   201012 454500                    STP4    TLEN+4,,AUTO
         2 005276   200412 635500                    EPPR5   DEST$,,AUTO
         2 005277   201011 455500                    STP5    TLEN+3,,AUTO
         2 005300   200411 636500                    EPPR6   OUTBUFF$,,AUTO
         2 005301   201010 456500                    STP6    TLEN+2,,AUTO
         2 005302   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 005303   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 005304   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 005305   005414 702000 2                  TSX2    PPRIV45

PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:187  
     1107    15140    3                      ALTRET(PPRIV45);
     1108    15141    3                 INBUFF = ',';

  15141  2 005306   040100 100400                    MLR     fill='040'O
         2 005307   000002 000001 3                  ADSC9   2                        cn=0,n=1
         2 005310   200421 000170                    ADSC9   INBUFF,,AUTO             cn=0,n=120

     1109    15142    3                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL) ALTRET(PPRIV45);

  15142  2 005311   200460 630500                    EPPR0   TAB_VAL,,AUTO
         2 005312   201014 450500                    STP0    TLEN+6,,AUTO
         2 005313   000003 236000 3                  LDQ     3
         2 005314   201013 756100                    STQ     TLEN+5,,AUTO
         2 005315   200413 631500                    EPPR1   IN$,,AUTO
         2 005316   201012 451500                    STP1    TLEN+4,,AUTO
         2 005317   200412 633500                    EPPR3   DEST$,,AUTO
         2 005320   201011 453500                    STP3    TLEN+3,,AUTO
         2 005321   200411 634500                    EPPR4   OUTBUFF$,,AUTO
         2 005322   201010 454500                    STP4    TLEN+2,,AUTO
         2 005323   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 005324   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 005325   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 005326   005414 702000 2                  TSX2    PPRIV45

     1110    15143    3              END;

     1111    15144    2     END;

  15144  2 005327   200005 054100                    AOS     I,,AUTO
         2 005330   200005 235100                    LDA     I,,AUTO
         2 005331   000023 115007                    CMPA    19,DL
         2 005332   005245 604400 2                  TMOZ    s:15134

     1112    15145    1     IF POFFC(DEST$,OUTBUFF$) = SIZEC('On: ')+TAB_VAL

  15145  2 005333   200411 236100                    LDQ     OUTBUFF$,,AUTO
         2 005334   000020 772000                    QRL     16
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:188  
         2 005335   201010 756100                    STQ     TLEN+2,,AUTO
         2 005336   200412 236100                    LDQ     DEST$,,AUTO
         2 005337   000020 772000                    QRL     16
         2 005340   201010 136100                    SBLQ    TLEN+2,,AUTO
         2 005341   200460 235100                    LDA     TAB_VAL,,AUTO
         2 005342   000004 035007                    ADLA    4,DL
         2 005343   201011 755100                    STA     TLEN+3,,AUTO
         2 005344   201011 116100                    CMPQ    TLEN+3,,AUTO
         2 005345   005367 601000 2                  TNZ     s:15152

     1113    15146    1        THEN
     1114    15147    2           DO;

     1115    15148    2              INBUFF='none,';

  15148  2 005346   040100 100400                    MLR     fill='040'O
         2 005347   001025 000005 1                  ADSC9   E_NOSUCHSTRM+280         cn=0,n=5
         2 005350   200421 000170                    ADSC9   INBUFF,,AUTO             cn=0,n=120

     1116    15149    2              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC('none,')

  15149  2 005351   200460 630500                    EPPR0   TAB_VAL,,AUTO
         2 005352   201014 450500                    STP0    TLEN+6,,AUTO
         2 005353   000115 236000 3                  LDQ     77
         2 005354   201013 756100                    STQ     TLEN+5,,AUTO
         2 005355   200413 631500                    EPPR1   IN$,,AUTO
         2 005356   201012 451500                    STP1    TLEN+4,,AUTO
         2 005357   200412 633500                    EPPR3   DEST$,,AUTO
         2 005360   201011 453500                    STP3    TLEN+3,,AUTO
         2 005361   200411 634500                    EPPR4   OUTBUFF$,,AUTO
         2 005362   201010 454500                    STP4    TLEN+2,,AUTO
         2 005363   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 005364   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 005365   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 005366   005414 702000 2                  TSX2    PPRIV45

     1117    15150    2                   ,TAB_VAL) ALTRET(PPRIV45);
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:189  
     1118    15151    2           END;

     1119    15152    1     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,

  15152  2 005367   000000 470400 xsym               LDP0    SEG2$
         2 005370   000165 471500                    LDP1    117,,PR0
         2 005371   200411 236100                    LDQ     OUTBUFF$,,AUTO
         2 005372   000020 772000                    QRL     16
         2 005373   201010 756100                    STQ     TLEN+2,,AUTO
         2 005374   200412 236100                    LDQ     DEST$,,AUTO
         2 005375   000020 772000                    QRL     16
         2 005376   201010 136100                    SBLQ    TLEN+2,,AUTO
         2 005377   000002 136007                    SBLQ    2,DL
         2 005400   000020 736000                    QLS     16
         2 005401   100004 676100                    ERQ     4,,PR1
         2 005402   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 005403   100004 656100                    ERSQ    4,,PR1

     1120    15153    1          OUTBUFF$)-2;
     1121    15154    1     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(PPRIV45);

  15154  2 005404   000000 236000 xsym               LDQ     SEG2$
         2 005405   000165 036003                    ADLQ    117,DU
         2 005406   201010 756100                    STQ     TLEN+2,,AUTO
         2 005407   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 005410   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005411   000000 701000 xent               TSX1    CPE$LISTOUT
         2 005412   005414 702000 2                  TSX2    PPRIV45

     1122    15155    1     RETURN;

  15155  2 005413   000000 702200 xent               TSX2  ! X66_ARET

  15152  2 005414                       PPRIV45      null
     1123    15156    1   PPRIV45:;
     1124    15157    1     ALTRETURN;

PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:190  
  15157  2 005414   000000 702200 xent               TSX2  ! X66_AALT

     1125    15158                   %EJECT;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:191  
     1126    15159        /*******************************************************************/
     1127    15160        /*F*   NAME: CPF$PROMPT
     1128    15161               PURPOSE: To set up one of the prompts IBEX displays
     1129    15162               DESCRIPTION: Re-setup the correct prompt
     1130    15163               REFERENCE: Programmers Reference Manual
     1131    15164        */
     1132    15165        /*D*   NAME: CPF$PROMPT
     1133    15166               CALL: CPF$PROMPT(P$PCB)
     1134    15167               INTERFACE: none
     1135    15168               INPUT: none
     1136    15169               OUTPUT: correct SEG$2 prompt is modified
     1137    15170               DESCRIPTION: Re-setup the correct prompt
     1138    15171        */
     1139    15172        /********************************************************************/
     1140    15173    1   CPF$PROMPT:  ENTRY (P$PCB) ALTRET;

  15173  2 005415   000000 700200 xent  CPF$PROMPT   TSX0  ! X66_AUTO_1
         2 005416   001066 000001                    ZERO    566,1

     1141    15174        /**/
     1142    15175    1     BLK$ = P$PCB.OUT$;

  15175  2 005417   200003 470500                    LDP0    @P$PCB,,AUTO
         2 005420   000003 236100                    LDQ     3,,PR0
         2 005421   200004 756100                    STQ     BLK$,,AUTO

     1143    15176    1     PROMPT$ = SEG$2.SPROMPT$;

  15176  2 005422   000000 471400 xsym               LDP1    SEG2$
         2 005423   100177 236100                    LDQ     127,,PR1
         2 005424   200007 756100                    STQ     PROMPT$,,AUTO

     1144    15177        /**/
     1145    15178    1     PROMPT.VFC_ = BINASC(0);

  15178  2 005425   200007 473500                    LDP3    PROMPT$,,AUTO
         2 005426   000000 236003                    LDQ     0,DU
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:192  
         2 005427   300001 552140                    STBQ    1,'40'O,PR3

     1146    15179    1     PROMPT.TYPE_ = PRMT_N;

  15179  2 005430   000001 220003                    LDX0    1,DU
         2 005431   300000 440100                    SXL0    0,,PR3

     1147    15180    1     PROMPT.PPROCESS_ = '0'B;

  15180  2 005432   000451 236000 3                  LDQ     297
         2 005433   300000 356100                    ANSQ    0,,PR3

     1148    15181    1     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DCB# = M$IBEX1_NUM;

  15181  2 005434   100163 474500                    LDP4    115,,PR1
         2 005435   000000 721000 xsym               LXL1    M$IBEX1_NUM
         2 005436   400032 741100                    STX1    26,,PR4

     1149    15182    1     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DISP# = %SAVE#;

  15182  2 005437   100163 474500                    LDP4    115,,PR1
         2 005440   000002 236007                    LDQ     2,DL
         2 005441   400032 552104                    STBQ    26,'04'O,PR4

     1150    15183        /**/
     1151    15184    2     DO I=0 TO BLK$->P$B.NSUBLKS-1;

  15184  2 005442   200005 450100                    STZ     I,,AUTO
         2 005443   005527 710000 2                  TRA     s:15194+1

     1152    15185    3       DO CASE (BLK$->P$B.SUBLK$(I)->P$B.CODE);

  15185  2 005444   200004 470500                    LDP0    BLK$,,AUTO
         2 005445   200005 720100                    LXL0    I,,AUTO
         2 005446   000003 471510                    LDP1    3,X0,PR0
         2 005447   100000 721100                    LXL1    0,,PR1
         2 005450   000006 101003                    CMPX1   6,DU
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:193  
         2 005451   005453 602011 2                  TNC     s:15185+7,X1
         2 005452   005526 710000 2                  TRA     s:15194
         2 005453   005461 710000 2                  TRA     s:15186
         2 005454   005507 710000 2                  TRA     s:15189
         2 005455   005513 710000 2                  TRA     s:15190
         2 005456   005517 710000 2                  TRA     s:15191
         2 005457   005523 710000 2                  TRA     s:15192
         2 005460   005476 710000 2                  TRA     s:15188

     1153    15186    3         CASE (PRMT_TXT); PROMPT.TEXT_ = BLK$->P$B.SUBLK$(I)->P$B.SUBLK$(0)->P$S.TEXT;

  15186  2 005461   100003 473500                    LDP3    3,,PR1
         2 005462   300004 236100                    LDQ     4,,PR3
         2 005463   000033 772000                    QRL     27
         2 005464   000000 622006                    EAX2    0,QL
         2 005465   200007 474500                    LDP4    PROMPT$,,AUTO
         2 005466   040100 100540                    MLR     fill='040'O
         2 005467   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         2 005470   400001 200200                    ADSC9   1,,PR4                   cn=1,n=128

     1154    15187    3                          PROMPT.LEN_ = BLK$->P$B.SUBLK$(I)->P$B.SUBLK$(0)->P$S.COUNT;

  15187  2 005471   000003 471510                    LDP1    3,X0,PR0
         2 005472   100003 473500                    LDP3    3,,PR1
         2 005473   300004 236100                    LDQ     4,,PR3
         2 005474   400000 552140                    STBQ    0,'40'O,PR4
         2 005475   005526 710000 2                  TRA     s:15194

     1155    15188    3         CASE (PRMT_VFC); PROMPT.VFC_ = BLK$->P$B.SUBLK$(I)->P$B.SUBLK$(0)->P$S.TEXT;

  15188  2 005476   100003 473500                    LDP3    3,,PR1
         2 005477   300004 236100                    LDQ     4,,PR3
         2 005500   000033 772000                    QRL     27
         2 005501   000000 622006                    EAX2    0,QL
         2 005502   200007 474500                    LDP4    PROMPT$,,AUTO
         2 005503   040100 100540                    MLR     fill='040'O
         2 005504   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:194  
         2 005505   400001 000001                    ADSC9   1,,PR4                   cn=0,n=1
         2 005506   005526 710000 2                  TRA     s:15194

     1156    15189    3         CASE (PRMT_N); PROMPT.TYPE_ = PRMT_N;

  15189  2 005507   000001 222003                    LDX2    1,DU
         2 005510   200007 473500                    LDP3    PROMPT$,,AUTO
         2 005511   300000 442100                    SXL2    0,,PR3
         2 005512   005526 710000 2                  TRA     s:15194

     1157    15190    3         CASE (PRMT_I); PROMPT.TYPE_ = PRMT_I;

  15190  2 005513   000002 222003                    LDX2    2,DU
         2 005514   200007 473500                    LDP3    PROMPT$,,AUTO
         2 005515   300000 442100                    SXL2    0,,PR3
         2 005516   005526 710000 2                  TRA     s:15194

     1158    15191    3         CASE (PRMT_C); PROMPT.TYPE_ = PRMT_C;

  15191  2 005517   000003 222003                    LDX2    3,DU
         2 005520   200007 473500                    LDP3    PROMPT$,,AUTO
         2 005521   300000 442100                    SXL2    0,,PR3
         2 005522   005526 710000 2                  TRA     s:15194

     1159    15192    3         CASE (PRMT_R); PROMPT.TYPE_ = PRMT_R;

  15192  2 005523   000004 222003                    LDX2    4,DU
         2 005524   200007 473500                    LDP3    PROMPT$,,AUTO
         2 005525   300000 442100                    SXL2    0,,PR3

     1160    15193    3       END;

     1161    15194    2     END;

  15194  2 005526   200005 054100                    AOS     I,,AUTO
         2 005527   200004 470500                    LDP0    BLK$,,AUTO
         2 005530   000001 236100                    LDQ     1,,PR0
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:195  
         2 005531   000022 772000                    QRL     18
         2 005532   200005 116100                    CMPQ    I,,AUTO
         2 005533   005444 605400 2                  TPNZ    s:15185

     1162    15195    1     CALL INDEX (I,'%',PROMPT.TEXT_)

  15195  2 005534   200007 471500                    LDP1    PROMPT$,,AUTO
         2 005535   000000 124500                    SCM     mask='000'O
         2 005536   100001 200200                    ADSC9   1,,PR1                   cn=1,n=128
         2 005537   000454 000001 3                  ADSC9   300                      cn=0,n=1
         2 005540   200005 000100                    ARG     I,,AUTO
         2 005541   005544 606400 2                  TTN     s:15199

     1163    15196    2       WHENRETURN DO;

     1164    15197    2         PROMPT.PPROCESS_ = '1'B;

  15197  2 005542   000400 236003                    LDQ     256,DU
         2 005543   100000 256100                    ORSQ    0,,PR1

     1165    15198    2       END;

     1166    15199    1     IF PROMPT.VFC_ = BINASC(0)

  15199  2 005544   200007 470500                    LDP0    PROMPT$,,AUTO
         2 005545   000001 236100                    LDQ     1,,PR0
         2 005546   777000 376003                    ANQ     -512,DU
         2 005547   000000 116003                    CMPQ    0,DU
         2 005550   005556 601000 2                  TNZ     s:15202

     1167    15200    1       THEN
     1168    15201    1         PROMPT.VFC_ = PROMPT_VFCS (PROMPT.TYPE_);

  15201  2 005551   000000 236100                    LDQ     0,,PR0
         2 005552   777777 376007                    ANQ     -1,DL
         2 005553   040100 100406                    MLR     fill='040'O
         2 005554   000000 000001 xsym               ADSC9   PROMPT_VFCS,Q            cn=0,n=1
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:196  
         2 005555   000001 000001                    ADSC9   1,,PR0                   cn=0,n=1

     1169    15202    1     CALL CPC$OPEN_S (M$IBEX1_NUM) ALTRET (PROMPT10);

  15202  2 005556   000007 630400 3                  EPPR0   7
         2 005557   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005560   000000 701000 xent               TSX1    CPC$OPEN_S
         2 005561   005644 702000 2                  TSX2    PROMPT10

     1170    15203    1     CALL CPJ$WRITE_S (M$IBEX1_NUM, PROMPT_KEYS (PROMPT.TYPE_),

  15203  2 005562   200007 470500                    LDP0    PROMPT$,,AUTO
         2 005563   000000 720100                    LXL0    0,,PR0
         2 005564   000000 236100                    LDQ     0,,PR0
         2 005565   000033 772000                    QRL     27
         2 005566   000005 621006                    EAX1    5,QL
         2 005567   000000 635011                    EAA     0,X1
         2 005570   000002 771000                    ARL     2
         2 005571   000140 135007                    SBLA    96,DL
         2 005572   200007 236100                    LDQ     PROMPT$,,AUTO
         2 005573   201010 757100                    STAQ    TLEN+2,,AUTO
         2 005574   201010 631500                    EPPR1   TLEN+2,,AUTO
         2 005575   201014 451500                    STP1    TLEN+6,,AUTO
         2 005576   000000 636010                    EAQ     0,X0
         2 005577   000001 736000                    QLS     1
         2 005600   000455 036000 3                  ADLQ    301
         2 005601   000007 235000 3                  LDA     7
         2 005602   201012 757100                    STAQ    TLEN+4,,AUTO
         2 005603   201012 630500                    EPPR0   TLEN+4,,AUTO
         2 005604   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 005605   000000 701000 xent               TSX1    CPJ$WRITE_S
         2 005606   005635 702000 2                  TSX2    PROMPT20

     1171    15204    1                       VECTOR (WRT_PROMPT)) ALTRET(PROMPT20);
     1172    15205    1     B$JIT.PROMPTS = B$JIT.PROMPTS | PROMPT_MASK (PROMPT.TYPE_);

  15205  2 005607   200007 470500                    LDP0    PROMPT$,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:197  
         2 005610   000000 720100                    LXL0    0,,PR0
         2 005611   000000 236010 xsym               LDQ     PROMPT_MASK,X0
         2 005612   760000 376003                    ANQ     -8192,DU
         2 005613   201010 756100                    STQ     TLEN+2,,AUTO
         2 005614   000000 471400 xsym               LDP1    B$JIT$
         2 005615   100153 236100                    LDQ     107,,PR1
         2 005616   000026 736000                    QLS     22
         2 005617   760000 376003                    ANQ     -8192,DU
         2 005620   201010 276100                    ORQ     TLEN+2,,AUTO
         2 005621   000026 772000                    QRL     22
         2 005622   100153 676100                    ERQ     107,,PR1
         2 005623   037000 376007                    ANQ     15872,DL
         2 005624   100153 656100                    ERSQ    107,,PR1

     1173    15206    2     CALL M$CLOSE (SEG$2.FPT_CLOSE$->FPT$CLOSE) WHENALTRETURN DO; END;

  15206  2 005625   000000 473400 xsym               LDP3    SEG2$
         2 005626   300163 474500                    LDP4    115,,PR3
         2 005627   400000 630500                    EPPR0   0,,PR4
         2 005630   450001 713400                    CLIMB   alt,close
         2 005631   406000 401760                    pmme    nvectors=13
         2 005632   005634 702000 2                  TSX2    s:15207
         2 005633   005634 710000 2                  TRA     s:15207

     1174    15207    1     RETURN;

  15207  2 005634   000000 702200 xent               TSX2  ! X66_ARET

     1175    15208    1   PROMPT20:
     1176    15209    2     CALL M$CLOSE (SEG$2.FPT_CLOSE$->FPT$CLOSE) WHENALTRETURN DO; END;

  15209  2 005635   000000 470400 xsym  PROMPT20     LDP0    SEG2$
         2 005636   000163 471500                    LDP1    115,,PR0
         2 005637   100000 630500                    EPPR0   0,,PR1
         2 005640   450001 713400                    CLIMB   alt,close
         2 005641   406000 401760                    pmme    nvectors=13
         2 005642   005644 702000 2                  TSX2    PROMPT10
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:198  
         2 005643   005644 710000 2                  TRA     PROMPT10

     1177    15210    1   PROMPT10:
     1178    15211    1     CALL CPC$WRITEMSGE (B$JIT.USRERR, M$IBEX1_NUM);

  15211  2 005644   000007 236000 3     PROMPT10     LDQ     7
         2 005645   201011 756100                    STQ     TLEN+3,,AUTO
         2 005646   000000 236000 xsym               LDQ     B$JIT$
         2 005647   000144 036003                    ADLQ    100,DU
         2 005650   201010 756100                    STQ     TLEN+2,,AUTO
         2 005651   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 005652   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 005653   000000 701000 xent               TSX1    CPC$WRITEMSGE
         2 005654   000000 011000                    NOP     0

     1179    15212    1     B$JIT.USRERR = '0'B;

  15212  2 005655   000000 470400 xsym               LDP0    B$JIT$
         2 005656   000144 450100                    STZ     100,,PR0

     1180    15213    1     RETURN;

  15213  2 005657   000000 702200 xent               TSX2  ! X66_ARET

     1181    15214        %EJECT;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:199  
     1182    15215        /**********************************************************************/
     1183    15216        /*I*       NAME: CLOSE_REL
     1184    15217                   PURPOSE: To close M$IBEX1 dcb and release data segment 3
     1185    15218                   CALL: CALL CLOSE_REL
     1186    15219                   INPUT:  none
     1187    15220                   OUTPUT: none
     1188    15221                   DESCRIPTION: The M$IBEX1 dcb is closed and data segment released.
     1189    15222        */
     1190    15223        /**********************************************************************/
     1191    15224    1   CLOSE_REL: PROC ALTRET;

  15224  2 005660   200772 741300       CLOSE_REL    STX1  ! VLP_TRMATTR+10,,AUTO

     1192    15225    2     CALL CPC$RELSEG (SEG3$);

  15225  2 005661   000004 630400 3                  EPPR0   4
         2 005662   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005663   000000 701000 xent               TSX1    CPC$RELSEG
         2 005664   000000 011000                    NOP     0

     1193    15226    2     IF DCBADDR(M$IBEX1_NUM)->F$DCB.FCD#=%YES#

  15226  2 005665   000037 470400 3                  LDP0    31
         2 005666   000000 471500                    LDP1    0,,PR0
         2 005667   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 005670   100000 473510                    LDP3    0,X0,PR1
         2 005671   300031 236100                    LDQ     25,,PR3
         2 005672   020000 316007                    CANQ    8192,DL
         2 005673   005707 600000 2                  TZE     s:15233

     1194    15227    2        THEN
     1195    15228    3           DO;

     1196    15229    3              SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DCB#=M$IBEX1_NUM;

  15229  2 005674   000000 474400 xsym               LDP4    SEG2$
         2 005675   400163 475500                    LDP5    115,,PR4
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:200  
         2 005676   500032 740100                    STX0    26,,PR5

     1197    15230    3              SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DISP#=%SAVE#;

  15230  2 005677   400163 475500                    LDP5    115,,PR4
         2 005700   000002 236007                    LDQ     2,DL
         2 005701   500032 552104                    STBQ    26,'04'O,PR5

     1198    15231    3              CALL M$CLOSE(SEG$2.FPT_CLOSE$->FPT$CLOSE) ALTRET(CLOSE_REL50);

  15231  2 005702   400163 475500                    LDP5    115,,PR4
         2 005703   500000 630500                    EPPR0   0,,PR5
         2 005704   450001 713400                    CLIMB   alt,close
         2 005705   406000 401760                    pmme    nvectors=13
         2 005706   005711 702000 2                  TSX2    CLOSE_REL50

     1199    15232    3           END;

     1200    15233    2     RETURN;

  15233  2 005707   200772 221300                    LDX1  ! VLP_TRMATTR+10,,AUTO
         2 005710   000001 702211                    TSX2  ! 1,X1

  15232  2 005711                       CLOSE_REL50  null
     1201    15234    2   CLOSE_REL50:;
     1202    15235    2     ALTRETURN;

  15235  2 005711   200772 221300                    LDX1  ! VLP_TRMATTR+10,,AUTO
         2 005712   000000 702211                    TSX2  ! 0,X1

     1203    15236    2   END CLOSE_REL;
     1204    15237        %EJECT;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:201  
     1205    15238    1   PUT_FLAG: PROC (FLAG, TEXT, LENGTH) ALTRET;

  15238  2 005713   200772 741300       PUT_FLAG     STX1  ! VLP_TRMATTR+10,,AUTO

     1206    15239
     1207    15240    2   DCL FLAG BIT (2) UNAL;
     1208    15241    2   DCL TEXT CHAR (LENGTH);
     1209    15242    2   DCL LENGTH UBIN WORD;
     1210    15243
     1211    15244    2      IF FLAG = %YES#

  15244  2 005714   200773 470500                    LDP0    @FLAG,,AUTO
         2 005715   000000 066500                    CMPB    filb='0'B
         2 005716   000000 000002                    BDSC    0,,PR0                   by=0,bit=0,n=2
         2 005717   000030 000022 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=18
         2 005720   005766 601000 2                  TNZ     s:15255

     1212    15245    3        THEN DO;

     1213    15246
     1214    15247    3         FLAG_FOUND = %YES#;

  15247  2 005721   400000 236003                    LDQ     -131072,DU
         2 005722   200420 756100                    STQ     FLAG_FOUND,,AUTO

     1215    15248    3         LEN = LENGTH + 2;

  15248  2 005723   200775 471500                    LDP1    @LENGTH,,AUTO
         2 005724   100000 235100                    LDA     0,,PR1
         2 005725   000002 035007                    ADLA    2,DL
         2 005726   200457 755100                    STA     LEN,,AUTO

     1216    15249    3         CALL CONCAT (INBUFF, TEXT, ', ');

  15249  2 005727   100000 720100                    LXL0    0,,PR1
         2 005730   200774 473500                    LDP3    @TEXT,,AUTO
         2 005731   040100 100540                    MLR     fill='040'O
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:202  
         2 005732   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         2 005733   200421 000170                    ADSC9   INBUFF,,AUTO             cn=0,n=120
         2 005734   000000 636010                    EAQ     0,X0
         2 005735   000022 772000                    QRL     18
         2 005736   000170 116007                    CMPQ    120,DL
         2 005737   005750 603000 2                  TRC     s:15250
         2 005740   201010 740100                    STX0    TLEN+2,,AUTO
         2 005741   777607 620010                    EAX0    -121,X0
         2 005742   777777 660003                    ERX0    -1,DU
         2 005743   201010 236100                    LDQ     TLEN+2,,AUTO
         2 005744   000022 772000                    QRL     18
         2 005745   040146 100400                    MLR     fill='040'O
         2 005746   001026 000002 1                  ADSC9   E_NOSUCHSTRM+281         cn=0,n=2
         2 005747   200421 000010                    ADSC9   INBUFF,Q,AUTO            cn=0,n=*X0

     1217    15250    3         CALL CPB$BLDIMAGE (OUTBUFF$, DEST$, IN$, LEN, TAB_VAL)

  15250  2 005750   200460 634500                    EPPR4   TAB_VAL,,AUTO
         2 005751   201014 454500                    STP4    TLEN+6,,AUTO
         2 005752   200457 635500                    EPPR5   LEN,,AUTO
         2 005753   201013 455500                    STP5    TLEN+5,,AUTO
         2 005754   200413 636500                    EPPR6   IN$,,AUTO
         2 005755   201012 456500                    STP6    TLEN+4,,AUTO
         2 005756   200412 637500                    EPPR7   DEST$,,AUTO
         2 005757   201011 457500                    STP7    TLEN+3,,AUTO
         2 005760   200411 630500                    EPPR0   OUTBUFF$,,AUTO
         2 005761   201010 450500                    STP0    TLEN+2,,AUTO
         2 005762   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 005763   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 005764   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 005765   005770 702000 2                  TSX2    OOPS

     1218    15251    3          ALTRET (OOPS);
     1219    15252
     1220    15253    3         END;

     1221    15254
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:203  
     1222    15255    2      RETURN;

  15255  2 005766   200772 221300                    LDX1  ! VLP_TRMATTR+10,,AUTO
         2 005767   000001 702211                    TSX2  ! 1,X1

     1223    15256
     1224    15257    2   OOPS: ALTRETURN;

  15257  2 005770   200772 221300       OOPS         LDX1  ! VLP_TRMATTR+10,,AUTO
         2 005771   000000 702211                    TSX2  ! 0,X1

     1225    15258
     1226    15259    2   END PUT_FLAG;
     1227    15260
     1228    15261        %EJECT;
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:204  
     1229    15262    1   PUT_DECIMAL: PROC (DECIMAL, TEXT, LENGTH) ALTRET;

  15262  2 005772   200772 741300       PUT_DECIMAL  STX1  ! VLP_TRMATTR+10,,AUTO

     1230    15263
     1231    15264    2   DCL DECIMAL UBIN WORD;
     1232    15265    2   DCL TEXT CHAR (LENGTH);
     1233    15266    2   DCL LENGTH UBIN WORD;
     1234    15267
     1235    15268    2   DCL TSTRING CHAR (32);
     1236    15269    2   DCL TLEN UBIN WORD;
     1237    15270
     1238    15271    2      IF DECIMAL ~= 0

  15271  2 005773   200773 470500                    LDP0    @DECIMAL,,AUTO
         2 005774   000000 235100                    LDA     0,,PR0
         2 005775   006077 600000 2                  TZE     s:15282

     1239    15272    3        THEN DO;

     1240    15273
     1241    15274    3         CALL BINCHAR (TBUFF, DECIMAL);

  15274  2 005776   000044 773000                    LRL     36
         2 005777   201010 757100                    STAQ    TLEN+2,,AUTO
         2 006000   000100 301500                    BTD
         2 006001   201010 000010                    NDSC9   TLEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         2 006002   200414 030004                    NDSC9   TBUFF,,AUTO              cn=0,s=nosgn,sf=0,n=4

     1242    15275    3         CALL CPE$RZEROS (TBUFF, SIZEC(TBUFF), LEN);

  15275  2 006003   200457 631500                    EPPR1   LEN,,AUTO
         2 006004   201012 451500                    STP1    TLEN+4,,AUTO
         2 006005   000001 236000 3                  LDQ     1
         2 006006   201011 756100                    STQ     TLEN+3,,AUTO
         2 006007   200414 633500                    EPPR3   TBUFF,,AUTO
         2 006010   201010 453500                    STP3    TLEN+2,,AUTO
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:205  
         2 006011   201010 630500                    EPPR0   TLEN+2,,AUTO
         2 006012   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 006013   000000 701000 xent               TSX1    CPE$RZEROS
         2 006014   000000 011000                    NOP     0

     1243    15276    3         CALL CONCAT (TSTRING, '  ', TEXT, ' = ', SUBSTR (TBUFF, 0, LEN));

  15276  2 006015   200775 470500                    LDP0    @LENGTH,,AUTO
         2 006016   000000 720100                    LXL0    0,,PR0
         2 006017   001027 221000 1                  LDX1    E_NOSUCHSTRM+282
         2 006020   200776 741100                    STX1    TSTRING,,AUTO
         2 006021   200774 471500                    LDP1    @TEXT,,AUTO
         2 006022   040100 100540                    MLR     fill='040'O
         2 006023   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         2 006024   200776 400036                    ADSC9   TSTRING,,AUTO            cn=2,n=30
         2 006025   000000 636010                    EAQ     0,X0
         2 006026   000022 772000                    QRL     18
         2 006027   000036 116007                    CMPQ    30,DL
         2 006030   006053 603000 2                  TRC     s:15277
         2 006031   201010 740100                    STX0    TLEN+2,,AUTO
         2 006032   777741 620010                    EAX0    -31,X0
         2 006033   777777 660003                    ERX0    -1,DU
         2 006034   201010 235100                    LDA     TLEN+2,,AUTO
         2 006035   000022 771000                    ARL     18
         2 006036   040145 100400                    MLR     fill='040'O
         2 006037   001030 000003 1                  ADSC9   E_NOSUCHSTRM+283         cn=0,n=3
         2 006040   200776 400010                    ADSC9   TSTRING,A,AUTO           cn=2,n=*X0
         2 006041   201010 236100                    LDQ     TLEN+2,,AUTO
         2 006042   000022 772000                    QRL     18
         2 006043   000033 116007                    CMPQ    27,DL
         2 006044   006053 603000 2                  TRC     s:15277
         2 006045   777744 620006                    EAX0    -28,QL
         2 006046   777777 660003                    ERX0    -1,DU
         2 006047   200457 722100                    LXL2    LEN,,AUTO
         2 006050   040146 100540                    MLR     fill='040'O
         2 006051   200414 000012                    ADSC9   TBUFF,,AUTO              cn=0,n=*X2
         2 006052   200777 200010                    ADSC9   TSTRING+1,Q,AUTO         cn=1,n=*X0
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:206  

     1244    15277    3         TLEN = LEN + LENGTH + 5;

  15277  2 006053   200457 236100                    LDQ     LEN,,AUTO
         2 006054   000000 036100                    ADLQ    0,,PR0
         2 006055   000005 036007                    ADLQ    5,DL
         2 006056   201006 756100                    STQ     TLEN,,AUTO

     1245    15278    3         CALL CPB$BLDIMAGE (OUTBUFF$,DEST$,ADDR(TSTRING),TLEN,TAB_VAL) ALTRET (OOPS);

  15278  2 006057   200776 633500                    EPPR3   TSTRING,,AUTO
         2 006060   201010 453500                    STP3    TLEN+2,,AUTO
         2 006061   200460 634500                    EPPR4   TAB_VAL,,AUTO
         2 006062   201015 454500                    STP4    TLEN+7,,AUTO
         2 006063   201006 635500                    EPPR5   TLEN,,AUTO
         2 006064   201014 455500                    STP5    TLEN+6,,AUTO
         2 006065   201010 636500                    EPPR6   TLEN+2,,AUTO
         2 006066   201013 456500                    STP6    TLEN+5,,AUTO
         2 006067   200412 637500                    EPPR7   DEST$,,AUTO
         2 006070   201012 457500                    STP7    TLEN+4,,AUTO
         2 006071   200411 630500                    EPPR0   OUTBUFF$,,AUTO
         2 006072   201011 450500                    STP0    TLEN+3,,AUTO
         2 006073   201011 630500                    EPPR0   TLEN+3,,AUTO
         2 006074   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 006075   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 006076   006101 702000 2                  TSX2    OOPS

     1246    15279
     1247    15280    3         END;

     1248    15281
     1249    15282    2      RETURN;

  15282  2 006077   200772 221300                    LDX1  ! VLP_TRMATTR+10,,AUTO
         2 006100   000001 702211                    TSX2  ! 1,X1

     1250    15283
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:207  
     1251    15284    2   OOPS: ALTRETURN;

  15284  2 006101   200772 221300       OOPS         LDX1  ! VLP_TRMATTR+10,,AUTO
         2 006102   000000 702211                    TSX2  ! 0,X1
     1252    15285
     1253    15286    2   END PUT_DECIMAL;
     1254    15287
     1255    15288    1   END CPF$IBEX3;
     1256    15289        %EOD ;

PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:208  
--  Include file information  --

   NK_VFC_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_SUBS_C.:E05TOU  is referenced.
   CP_PERR_C.:E05TOU  is referenced.
   CP_MACROS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure CPF$IBEX3.
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:209  

 **** Variables and constants ****

  ****  Section 001 RoData CPF$IBEX3

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   374-0-0/w STRC        r     1 E_NOPRIVLGE              375-0-0/w STRC        r     1 E_NOSUCHSTRM
   372-0-0/c STRC(45)    r     1 K_PRO
   342-0-0/c CHAR(6)     r     1 LDVCFLWCTRALG(0:7)
   356-0-0/c CHAR(6)     r     1 LKEYTYPE(0:7)
   332-0-0/c CHAR(4)     r     1 LPARITY_TYPE(0:7)
     0-0-0/c CHAR(5)     r     1 LSPEED_TABLE(0:15)
   324-0-0/c CHAR(24)    r     1 PPRIV_HDR
    24-0-0/w STRC(126)   r     1 PPRIV_TBL(0:19)
   302-0-0/c CHAR(23)    r     1 PRIVHDR
   144-0-0/w STRC(144)   r     1 PRIV_TBL(0:21)
   317-0-0/c CHAR(18)    r     1 PRO_AVAIL                313-0-0/c CHAR(15)    r     1 PRO_CUR
   310-0-0/c CHAR(12)    r     1 PRO_HDR                  274-0-0/c CHAR(23)    r     1 THDR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   773-0-0/w PTR         r     1 @DECIMAL                 773-0-0/w PTR         r     1 @FLAG
   775-0-0/w PTR         r     1 @LENGTH                  775-0-0/w PTR         r     1 @LENGTH
     3-0-0/w PTR         r     1 @P$PCB                   774-0-0/w PTR         r     1 @TEXT
   774-0-0/w PTR         r     1 @TEXT                      4-0-0/w PTR         r     1 BLK$
   464-0-0/w UBIN        r     1 DCB#                      *0-0-0/w UBIN        r     1 DECIMAL
   412-0-0/w PTR         r     1 DEST$                    472-0-0/w BIT         r     1 DI_FULL
   415-0-0/b BIT         r     1 EXIST_FLG                 *0-0-0/b BIT (2)     r     1 FLAG
   420-0-0/b BIT         r     1 FLAG_FOUND               566-0-0/d STRC(1080)  r     1 FPT_CLOSE
   654-0-0/d STRC(288)   r     1 FPT_GLINEATTR            474-0-0/d STRC(2088)  r     1 FPT_OPEN
   642-0-0/d STRC(360)   r     1 FPT_PROFILE              624-0-0/d STRC(504)   r     1 FPT_READ
   674-0-0/d STRC(288)   r     1 FPT_TRMATTR              664-0-0/d STRC(288)   r     1 FPT_TRMCTL
   416-0-0/b BIT         r     1 HAVE_EDTCTL              417-0-0/b BIT         r     1 HAVE_WINDOW
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:210  
     5-0-0/w SBIN        r     1 I                        413-0-0/w PTR         r     1 IN$
   421-0-0/c CHAR(120)   r     1 INBUFF                     6-0-0/w SBIN        r     1 J
   457-0-0/w SBIN        r     1 LEN                       *0-0-0/w UBIN        r     1 LENGTH
    *0-0-0/w UBIN        r     1 LENGTH                   463-0-0/w PTR         r     1 MATCH_STR$
    11-0-0/c CHAR(1024)  r     1 OUTBUFF                  411-0-0/w PTR         r     1 OUTBUFF$
    *0-0-0/w STRC(504)   r     1 P$PCB                    471-0-0/b BIT         r     1 PRIV_ERR
   462-0-0/w SBIN        r     1 PROFC                      7-0-0/w PTR         r     1 PROMPT$
   710-0-0/c STRC(288)   r     1 PRO_NAME                 470-0-0/b BIT         r     1 RESET_PRIVS
   467-0-0/b BIT         r     1 SET_PRIVS                465-0-0/c CHAR(2)     r     1 STRM
   466-0-0/b BIT         r     1 SW_BINARY(0:35)
   466-0-0/b UBIN(3)     r     1 SW_OCTAL(0:11)
   460-0-0/w SBIN        r     1 TAB_VAL                  414-0-0/c CHAR(4)     r     1 TBUFF
    10-0-0/w PTR         r     1 TEMP$                    461-0-0/w SBIN        r     1 TEMP_STOR
    *0-0-0/c ACHR        r     1 TEXT                      *0-0-0/c ACHR        r     1 TEXT
  1006-0-0/w UBIN        r     1 TLEN                     776-0-0/c CHAR(32)    r     1 TSTRING
   704-0-0/d STRC(144)   r     1 USER_PRIV                724-0-0/d STRC(144)   r     1 VLP_EDTCTL
   740-0-0/d STRC(576)   r     1 VLP_LINEATTR             760-0-0/d STRC(360)   r     1 VLP_TRMATTR
   720-0-0/d STRC(144)   r     1 VLP_TRMCTL               730-0-0/d STRC(288)   r     1 VLP_WINDOW

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/d STRC(1080)  r     1 CFPT_CLOSE                 0-0-0/d STRC(288)   r     1 CFPT_GLINEATTR
     0-0-0/d STRC(2088)  r     1 CFPT_OPEN                  0-0-0/d STRC(360)   r     1 CFPT_PROFILE
     0-0-0/d STRC(504)   r     1 CFPT_READ                  0-0-0/d STRC(288)   r     1 CFPT_TRMATTR
     0-0-0/d STRC(288)   r     1 CFPT_TRMCTL                0-0-0/d STRC(432)   r     1 CFPT_WRITE
     0-0-0/c STRC(72)    r     1 COLONSYS                   0-0-0/w UBIN        r     1 M$IBEX1_NUM
     0-0-0/w UBIN        r     1 M$UC_NUM
     0-0-0/d VECT        r     1 PROMPT_KEYS(0:4)
     0-0-0/w BIT (5)     r     1 PROMPT_MASK(0:4)
     0-0-0/c CHAR        r     1 PROMPT_VFCS(0:4)
     0-0-0/w PTR         r     1 SEG2$                      0-0-0/w PTR         r     1 SEG3$

  ****  BASED and DCB variables  ****
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:211  

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$EXCFR                    0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/c CHAR        r     1 B$OCTAL(0:11)              0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/d STRC(1080)  r     1 FPT$CLOSE
     0-0-0/d STRC(432)   r     1 FPT$WRITE                  0-0-0/w STRC(6084)  r     1 KL$DREC
     0-0-0/c ASTR(9)     r     1 MATCH_STR                  0-0-0/w STRC(144)   r     1 P$B
     0-0-0/w ASTR(153)   r     1 P$S                        0-0-0/d STRC(1197)  r     1 PROMPT
     0-0-0/w STRC(6264)  r     1 SEG$2                      0-0-0/c ASTR(9)     r     1 TEXT$C
     0-0-0/d ASTR(45)    r     1 WRT_PROMPT


   Procedure CPF$IBEX3 requires 3139 words for executable code.
   Procedure CPF$IBEX3 requires 566 words of local(AUTO) storage.
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:212  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:213  
          MINI XREF LISTING

B$EXCFR.ASL
     13661**DCL     13661--REDEF
B$EXCFR.ERR
     13675**DCL     14533>>ASSIGN  14931>>ASSIGN
B$EXCFR.ERR.CODE
     13675**DCL     14513>>IF      14513>>IF
B$EXCFR.ERR.ERR#
     13675**DCL     13675--REDEF
B$EXCFR.EVID
     13674**DCL     13674--REDEF   13675--REDEF
B$EXCFR.IR
     13662**DCL     13662--REDEF
B$EXCFR.PREVSZ
     13661**DCL     13661--REDEF
B$EXCFR.SUBC
     13673**DCL     13673--REDEF   13674--REDEF   13674--REDEF
B$JIT.CPFLAGS1.SLEAZE
       125**DCL       125--REDEF
B$JIT.ERR.MID
        32**DCL        32--REDEF
B$JIT.JRESPEAK
       193**DCL       194--REDEF
B$JIT.MODE
        26**DCL     14357>>IF      14417>>IF      14567>>IF
B$JIT.ORIGINATOR_PORT.FROM_CR
       302**DCL       302--REDEF     303--REDEF
B$JIT.PNR
       206**DCL       206--REDEF
B$JIT.PPRIV
        87**DCL     15134>>IF
B$JIT.PRIV.ACTIVE
        32**DCL     15063>>ASSIGN
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:214  
B$JIT.PRIV.AUTH
        72**DCL     15037>>ASSIGN  15039>>ASSIGN  15073>>IF      15075>>ASSIGN
B$JIT.PRIV.JOB
        75**DCL     14993>>IF      15065<<ASSIGN  15065>>ASSIGN  15078<<ASSIGN  15078>>ASSIGN
B$JIT.PRIV.SAVED
        83**DCL     15066<<ASSIGN  15066>>ASSIGN  15079<<ASSIGN  15079>>ASSIGN
B$JIT.PROMPTS
       180**DCL     15205<<ASSIGN  15205>>ASSIGN
B$JIT.SWITCH
       119**DCL     14235>>IF      14272<<ASSIGN  14276<<ASSIGN  14299<<ASSIGN  14299>>ASSIGN  14303<<ASSIGN
     14303>>ASSIGN  14310<<ASSIGN  14314<<ASSIGN
B$JIT.TSLINE
       300**DCL       301--REDEF
B$JIT.USRERR
       167**DCL     14533<<ASSIGN  14599<<ASSIGN  14931<<ASSIGN  15095<<ASSIGN  15211<>CALL    15212<<ASSIGN
B$JIT$
      9775**DCL        26--IMP-PTR 14235>>IF      14272>>ASSIGN  14276>>ASSIGN  14299>>ASSIGN  14299>>ASSIGN
     14303>>ASSIGN  14303>>ASSIGN  14310>>ASSIGN  14314>>ASSIGN  14357>>IF      14417>>IF      14533>>ASSIGN
     14567>>IF      14599>>ASSIGN  14931>>ASSIGN  14993>>IF      15037>>ASSIGN  15039>>ASSIGN  15063>>ASSIGN
     15065>>ASSIGN  15065>>ASSIGN  15066>>ASSIGN  15066>>ASSIGN  15073>>IF      15075>>ASSIGN  15078>>ASSIGN
     15078>>ASSIGN  15079>>ASSIGN  15079>>ASSIGN  15095>>ASSIGN  15134>>IF      15205>>ASSIGN  15205>>ASSIGN
     15211>>CALL    15212>>ASSIGN
B$OCTAL
     12926**DCL     14291>>CALLBLT
B$TCB.ALT$
     13679**DCL     14513>>IF      14513>>IF      14533>>ASSIGN  14931>>ASSIGN
B$TCB$
      9777**DCL     13679--IMP-PTR 14513>>IF      14513>>IF      14533>>ASSIGN  14931>>ASSIGN
BLK$
     12818**DCL     13687--IMP-PTR 13934--IMP-PTR 14219<<ASSIGN  14223>>IF      14264>>DOCASE  14266>>DOINDEX
     14267>>ASSIGN  14283>>ASSIGN  14307>>DOCASE  14353<<ASSIGN  14361>>IF      14368>>ASSIGN  14422<<ASSIGN
     14423>>IF      14425>>ASSIGN  14563<<ASSIGN  14574>>IF      14574>>IF      14574>>IF      14585>>IF
     14588>>ASSIGN  14588>>ASSIGN  14965<<ASSIGN  14969>>IF      15030>>DOWHILE 15033>>ASSIGN  15175<<ASSIGN
     15184>>DOINDEX 15185>>DOCASE  15186>>ASSIGN  15186>>ASSIGN  15187>>ASSIGN  15188>>ASSIGN  15188>>ASSIGN
CAMR_REC.ACSVEH_
      8814**DCL      8815--REDEF
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:215  
CAMR_REC.ALTKEYS_
      8820**DCL      8821--REDEF    8821--REDEF
CAMR_REC.HDR_
      8819**DCL      8820--REDEF
CAMR_REC.TAB_
      8818**DCL      8819--REDEF
CAMR_REC.UHL_
      8812**DCL      8813--REDEF    8813--REDEF
CAMR_REC.V.FSN#
      8852**DCL      8852--REDEF    8852--REDEF
CAMR_REC.WSN_
      8818**DCL      8818--REDEF
CFPT_CLOSE
      7656**DCL     14402>>ASSIGN
CFPT_CLOSE.SN_
      7656**DCL      7656--REDEF
CFPT_CLOSE.UTL_
      7657**DCL      7657--REDEF
CFPT_CLOSE.V.EXPIRE#
      7671**DCL      7671--REDEF
CFPT_CLOSE.V.TYPE#
      7669**DCL      7669--REDEF
CFPT_CLOSE.V.XTNSIZE#
      7666**DCL      7666--REDEF    7668--REDEF
CFPT_GLINEATTR
      8566**DCL     14443>>ASSIGN  14578>>ASSIGN
CFPT_OPEN
      7589**DCL     14473>>ASSIGN  14591>>ASSIGN
CFPT_OPEN.ACSVEH_
      7591**DCL      7592--REDEF
CFPT_OPEN.ALTKEYS_
      7597**DCL      7598--REDEF    7598--REDEF
CFPT_OPEN.HDR_
      7596**DCL      7597--REDEF
CFPT_OPEN.TAB_
      7595**DCL      7596--REDEF
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:216  
CFPT_OPEN.UHL_
      7589**DCL      7590--REDEF    7590--REDEF
CFPT_OPEN.V.FSN#
      7629**DCL      7629--REDEF    7629--REDEF
CFPT_OPEN.WSN_
      7595**DCL      7595--REDEF
CFPT_PROFILE
      8590**DCL     14372>>ASSIGN
CFPT_READ
      7692**DCL     14487>>ASSIGN
CFPT_READ.STATION_
      7695**DCL      7696--REDEF
CFPT_READ.V.DVBYTE.REREAD#
      7707**DCL      7707--REDEF
CFPT_READ.V.INDX#
      7705**DCL      7705--REDEF
CFPT_READUC.STATION_
      8065**DCL      8066--REDEF
CFPT_READUC.V.DVBYTE.REREAD#
      8077**DCL      8077--REDEF
CFPT_READUC.V.INDX#
      8075**DCL      8075--REDEF
CFPT_TRMATTR
      8541**DCL     14626>>ASSIGN
CFPT_TRMCTL
      8515**DCL     14582>>ASSIGN
CFPT_TRTN.V.IR#
      8301**DCL      8302--REDEF
CFPT_WRITE
      7731**DCL     14632>>ASSIGN
CFPT_WRITE.STATION_
      7733**DCL      7733--REDEF
CFPT_WRITE.V.DVBYTE.VFC#
      7740**DCL      7740--REDEF
CFPT_WRITEUC.STATION_
      8033**DCL      8033--REDEF
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:217  
CFPT_WRITEUC.V.DVBYTE.VFC#
      8040**DCL      8040--REDEF
CFPT_XXX.V.STEPCC#
      9013**DCL      9013--REDEF
CGETCMD.OUT$
      9034**DCL      9040--REDEF
CLOSE_REL
     15224**PROC    14464--CALL    14529--CALL    14534--CALL
CLOSE_REL50 IN PROCEDURE CLOSE_REL
     15232**LABEL   15231--CALLALT
COLONSYS
      8429**DCL     14476--ASSIGN
CPB$BLDIMAGE
     12947**DCL-ENT 14240--CALL    14242--CALL    14254--CALL    14448--CALL    14451--CALL    14471--CALL
     14507--CALL    14521--CALL    14658--CALL    14662--CALL    14669--CALL    14678--CALL    14679--CALL
     14688--CALL    14689--CALL    14697--CALL    14705--CALL    14708--CALL    14713--CALL    14718--CALL
     14721--CALL    14724--CALL    14736--CALL    14749--CALL    14753--CALL    14776--CALL    14807--CALL
     14909--CALL    14989--CALL    14998--CALL    15001--CALL    15010--CALL    15131--CALL    15139--CALL
     15142--CALL    15149--CALL    15250--CALL    15278--CALL
CPB$WILDCMPR
     12957**DCL-ENT 14503--CALL
CPC$GETSEG
     12949**DCL-ENT 14360--CALL    14420--CALL
CPC$OPEN_S
     12953**DCL-ENT 15202--CALL
CPC$RDHLP
     12951**DCL-ENT 14388--CALL
CPC$RELSEG
     12950**DCL-ENT 14381--CALL    15225--CALL
CPC$WRHLP
     12952**DCL-ENT 14398--CALL
CPC$WRITEMSGE
     12955**DCL-ENT 15211--CALL
CPE$LISTOUT
     12948**DCL-ENT 14258--CALL    14439--CALL    14455--CALL    14528--CALL    14639--CALL    14800--CALL
     14913--CALL    14976--CALL    15016--CALL    15118--CALL    15154--CALL
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:218  
CPE$RZEROS
     12946**DCL-ENT 14239--CALL    14656--CALL    14667--CALL    14675--CALL    14685--CALL    15275--CALL
CPF$FIND_UCNN
     12956**DCL-ENT 14589--CALL
CPJ$WRITE_S
     12954**DCL-ENT 15203--CALL
CVLP_TRMCTL.BREAKCOUNT
      8625**DCL      8626--REDEF
CVLP_WINDOW.FWINDOW#
      8721**DCL      8721--REDEF    8722--REDEF
DCB#
     12883**DCL     14589<>CALL    14594<<ASSIGN  14603>>ASSIGN
DECIMAL IN PROCEDURE PUT_DECIMAL
     15264**DCL     15262--PROC    15271>>IF      15274>>CALLBLT
DEST$
     12865**DCL     14227<<ASSIGN  14230<<ASSIGN  14230>>ASSIGN  14240<>CALL    14242<>CALL    14249>>ASSIGN
     14254<>CALL    14255>>ASSIGN  14285<<ASSIGN  14291>>CALLBLT 14432<<ASSIGN  14448<>CALL    14451<>CALL
     14453>>ASSIGN  14470<<ASSIGN  14471<>CALL    14507<>CALL    14521<>CALL    14524>>ASSIGN  14644<<ASSIGN
     14651<<ASSIGN  14651>>ASSIGN  14658<>CALL    14662<>CALL    14669<>CALL    14678<>CALL    14679<>CALL
     14688<>CALL    14689<>CALL    14697<>CALL    14701>>ASSIGN  14705<>CALL    14708<>CALL    14713<>CALL
     14718<>CALL    14721<>CALL    14724<>CALL    14736<>CALL    14749<>CALL    14753<>CALL    14776<>CALL
     14799>>ASSIGN  14804<<ASSIGN  14807<>CALL    14900>>ASSIGN  14903>>ASSIGN  14909<>CALL    14910>>ASSIGN
     14981<<ASSIGN  14989<>CALL    14998<>CALL    15001<>CALL    15006>>IF      15010<>CALL    15014>>ASSIGN
     15123<<ASSIGN  15131<>CALL    15139<>CALL    15142<>CALL    15145>>IF      15149<>CALL    15152>>ASSIGN
     15250<>CALL    15278<>CALL
DI_FULL
     12944**DCL     14364<<ASSIGN  14421<<ASSIGN  14461>>IF
EXIST_FLG
     12868**DCL     14233<<ASSIGN  14243<<ASSIGN  14247>>IF
E_NOPRIVLGE
     13632**DCL     15095>>ASSIGN
E_NOSUCHSTRM
     13652**DCL     14599>>ASSIGN
F$DCB.ACTPOS
     13224**DCL     13224--REDEF
F$DCB.ARS#
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:219  
     13198**DCL     13198--REDEF
F$DCB.ATTR
     13217**DCL     13218--REDEF
F$DCB.BORROW
     13232**DCL     13232--REDEF   13232--REDEF   13232--REDEF
F$DCB.DCBNAME.L
     13246**DCL     13246--IMP-SIZ
F$DCB.EOMCHAR#
     13202**DCL     13202--REDEF
F$DCB.FCD#
     13211**DCL     14914>>IF      14921>>IF      14933>>IF      15226>>IF
F$DCB.FLDID
     13227**DCL     13227--REDEF
F$DCB.FORM$
     13221**DCL     13221--REDEF
F$DCB.FSECT
     13237**DCL     13237--REDEF
F$DCB.FSN#
     13214**DCL     13214--REDEF   13214--REDEF   13215--REDEF
F$DCB.HEADER$
     13220**DCL     13220--REDEF
F$DCB.IXTNSIZE#
     13218**DCL     13218--REDEF
F$DCB.LASTSTA$
     13207**DCL     13207--REDEF
F$DCB.LVL
     13233**DCL     13233--REDEF
F$DCB.NAME#.C
     13208**DCL     13208--REDEF
F$DCB.NOEOF
     13230**DCL     13230--REDEF
F$DCB.NRECS#
     13219**DCL     13219--REDEF
F$DCB.NRECX
     13238**DCL     13238--REDEF
F$DCB.OHDR
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:220  
     13230**DCL     13230--REDEF
F$DCB.ORG#
     13213**DCL     13213--REDEF   14615>>IF
F$DCB.PRECNO
     13236**DCL     13236--REDEF
F$DCB.RCSZ
     13242**DCL     13242--REDEF
F$DCB.RES#
     13209**DCL     13209--REDEF
F$DCB.SETX
     13221**DCL     13221--REDEF
F$DCB.TAB$
     13221**DCL     13221--REDEF
F$DCB.TDA
     13235**DCL     13236--REDEF
F$DCB.WSN#
     13209**DCL     13209--REDEF
FLAG IN PROCEDURE PUT_FLAG
     15240**DCL     15238--PROC    15244>>IF
FLAG_FOUND
     12871**DCL     14805<<ASSIGN  14901>>IF      15247<<ASSIGN
FPT$CLOSE
     13091**DCL     14919<>CALL    14926<>CALL    14938<>CALL    15206<>CALL    15209<>CALL    15231<>CALL
FPT$CLOSE.SN_
     13091**DCL     13091--REDEF
FPT$CLOSE.UTL_
     13092**DCL     13092--REDEF
FPT$CLOSE.V.DCB#
     13097**DCL     14917<<ASSIGN  14924<<ASSIGN  14936<<ASSIGN  15181<<ASSIGN  15229<<ASSIGN
FPT$CLOSE.V.DISP#
     13100**DCL     14918<<ASSIGN  14925<<ASSIGN  14937<<ASSIGN  15182<<ASSIGN  15230<<ASSIGN
FPT$CLOSE.V.EXPIRE#
     13106**DCL     13106--REDEF
FPT$CLOSE.V.TYPE#
     13104**DCL     13104--REDEF
FPT$CLOSE.V.XTNSIZE#
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:221  
     13101**DCL     13101--REDEF   13103--REDEF
FPT$WRITE
     13265**DCL     14632<<ASSIGN
FPT$WRITE.BUF_
     13265**DCL     14438<<ASSIGN  14638<<ASSIGN  14975<<ASSIGN  15117<<ASSIGN
FPT$WRITE.BUF_.BOUND
     13265**DCL     14249<<ASSIGN  14255<<ASSIGN  14453<<ASSIGN  14524<<ASSIGN  14526>>IF      14701<<ASSIGN
     14799<<ASSIGN  14903<<ASSIGN  14910<<ASSIGN  15014<<ASSIGN  15152<<ASSIGN
FPT$WRITE.BUF_.BUF$
     13267**DCL     14257<<ASSIGN  14454<<ASSIGN  14700<<ASSIGN  14983<<ASSIGN  15125<<ASSIGN
FPT$WRITE.STATION_
     13267**DCL     13267--REDEF
FPT$WRITE.V
     13268**DCL     14633--ASSIGN
FPT$WRITE.V.DVBYTE.VFC#
     13274**DCL     13274--REDEF
FPT$WRITE.V_
     13265**DCL     14633<<ASSIGN
FPT_CLOSE
     13133**DCL     14402<<ASSIGN  14406<>CALL
FPT_CLOSE.SN_
     13133**DCL     13133--REDEF
FPT_CLOSE.UTL_
     13134**DCL     13134--REDEF
FPT_CLOSE.V
     13138**DCL     14403--ASSIGN
FPT_CLOSE.V.DCB#
     13139**DCL     14404<<ASSIGN
FPT_CLOSE.V.DISP#
     13142**DCL     14405<<ASSIGN
FPT_CLOSE.V.EXPIRE#
     13148**DCL     13148--REDEF
FPT_CLOSE.V.TYPE#
     13146**DCL     13146--REDEF
FPT_CLOSE.V.XTNSIZE#
     13143**DCL     13143--REDEF   13145--REDEF
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:222  
FPT_CLOSE.V_
     13133**DCL     14403<<ASSIGN
FPT_GLINEATTR
     13315**DCL     14443<<ASSIGN  14446<>CALL    14578<<ASSIGN  14581<>CALL
FPT_GLINEATTR.LINEATTR_
     13321**DCL     14445<<ASSIGN  14580<<ASSIGN
FPT_GLINEATTR.V
     13323**DCL     14444--ASSIGN  14579--ASSIGN
FPT_GLINEATTR.V_
     13317**DCL     14444<<ASSIGN  14579<<ASSIGN
FPT_OPEN
     13024**DCL     14473<<ASSIGN  14483<>CALL    14591<<ASSIGN  14597<>CALL
FPT_OPEN.ACCT_
     13028**DCL     14476<<ASSIGN
FPT_OPEN.ACSVEH_
     13026**DCL     13027--REDEF
FPT_OPEN.ALTKEYS_
     13032**DCL     13033--REDEF   13033--REDEF
FPT_OPEN.HDR_
     13031**DCL     13032--REDEF
FPT_OPEN.NAME_
     13025**DCL     14475<<ASSIGN
FPT_OPEN.TAB_
     13030**DCL     13031--REDEF
FPT_OPEN.UHL_
     13024**DCL     13025--REDEF   13025--REDEF
FPT_OPEN.V
     13033**DCL     14474--ASSIGN  14592--ASSIGN
FPT_OPEN.V.ACS#
     13044**DCL     14482<<ASSIGN
FPT_OPEN.V.ASN#
     13043**DCL     14478<<ASSIGN
FPT_OPEN.V.DCB#
     13033**DCL     14477<<ASSIGN  14593<<ASSIGN
FPT_OPEN.V.FSN#
     13064**DCL     13064--REDEF   13064--REDEF
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:223  
FPT_OPEN.V.FUN#
     13043**DCL     14479<<ASSIGN
FPT_OPEN.V.ORG#
     13044**DCL     14481<<ASSIGN  14596<<ASSIGN
FPT_OPEN.V.RES#
     13048**DCL     14595<<CALLBLT
FPT_OPEN.V.SHARE#
     13038**DCL     14480<<ASSIGN
FPT_OPEN.V_
     13024**DCL     14474<<ASSIGN  14592<<ASSIGN
FPT_OPEN.WSN_
     13030**DCL     13030--REDEF
FPT_PROFILE
     13293**DCL     14372<<ASSIGN  14379<>CALL
FPT_PROFILE.BUF_.BOUND
     13296**DCL     14376<<ASSIGN
FPT_PROFILE.BUF_.BUF$
     13296**DCL     14377<<ASSIGN
FPT_PROFILE.PROFILE_
     13295**DCL     14374<<ASSIGN
FPT_PROFILE.V
     13298**DCL     14373--ASSIGN
FPT_PROFILE.V.DCB#
     13298**DCL     14378<<ASSIGN
FPT_PROFILE.V_
     13295**DCL     14373<<ASSIGN
FPT_READ
     13169**DCL     14487<<ASSIGN  14500<>CALL
FPT_READ.BUF_.BOUND
     13171**DCL     14490<<ASSIGN
FPT_READ.BUF_.BUF$
     13172**DCL     14489<<ASSIGN
FPT_READ.KEY_
     13169**DCL     14491<<ASSIGN
FPT_READ.STATION_
     13172**DCL     13173--REDEF
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:224  
FPT_READ.V
     13173**DCL     14488--ASSIGN
FPT_READ.V.DCB#
     13173**DCL     14494<<ASSIGN
FPT_READ.V.DVBYTE.REREAD#
     13184**DCL     13184--REDEF
FPT_READ.V.INDX#
     13182**DCL     13182--REDEF
FPT_READ.V.KEYR#
     13174**DCL     14493<<ASSIGN
FPT_READ.V.KEYS#
     13174**DCL     14492<<ASSIGN
FPT_READ.V_
     13169**DCL     14488<<ASSIGN
FPT_TRMATTR
     13367**DCL     14626<<ASSIGN  14631<>CALL
FPT_TRMATTR.TRMATTR_
     13373**DCL     14630<<ASSIGN
FPT_TRMATTR.V
     13375**DCL     14627--ASSIGN
FPT_TRMATTR.V.DCB#
     13375**DCL     14628<<ASSIGN  14629<<ASSIGN
FPT_TRMATTR.V_
     13369**DCL     14627<<ASSIGN
FPT_TRMCTL
     13341**DCL     14582<<ASSIGN  14609<>CALL    14613<>CALL    14622<>CALL
FPT_TRMCTL.TRMCTL_
     13347**DCL     14584<<ASSIGN  14610<<ASSIGN  14619<<ASSIGN
FPT_TRMCTL.V
     13349**DCL     14583--ASSIGN
FPT_TRMCTL.V.DCB#
     13349**DCL     14603<<ASSIGN  14615--IF      14628>>ASSIGN  14629>>ASSIGN
FPT_TRMCTL.V.VLPTYPE#
     13349**DCL     14611<<ASSIGN  14620<<ASSIGN
FPT_TRMCTL.V_
     13343**DCL     14583<<ASSIGN
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:225  
HAVE_EDTCTL
     12869**DCL     14612<<ASSIGN  14617<<ASSIGN  14745>>IF      14782>>IF      14831>>IF      14840>>IF
     14859>>IF      14873>>IF      14888>>IF
HAVE_WINDOW
     12870**DCL     14621<<ASSIGN  14624<<ASSIGN  14726>>IF      14730>>IF      14755>>IF      14759>>IF
     14763>>IF      14770>>IF      14792>>IF      14796>>IF      14818>>IF      14847>>IF      14863>>IF
     14878>>IF      14891>>IF
I
     12819**DCL     14234<<DOINDEX 14235>>IF      14238>>CALLBLT 14266<<DOINDEX 14267>>ASSIGN  14992<<DOINDEX
     14993>>IF      14996>>ASSIGN  14997>>ASSIGN  15005<<CALLBLT 15025<<ASSIGN  15030>>DOWHILE 15033>>ASSIGN
     15081<<ASSIGN  15081>>ASSIGN  15133<<DOINDEX 15134>>IF      15137>>ASSIGN  15138>>ASSIGN  15184<<DOINDEX
     15185>>DOCASE  15186>>ASSIGN  15186>>ASSIGN  15187>>ASSIGN  15188>>ASSIGN  15188>>ASSIGN  15195<<CALLBLT
IN$
     12866**DCL     14430<<ASSIGN  14507<>CALL    14521<>CALL    14645<<ASSIGN  14662<>CALL    14678<>CALL
     14688<>CALL    14697<>CALL    14705<>CALL    14708<>CALL    14713<>CALL    14718<>CALL    14721<>CALL
     14724<>CALL    14736<>CALL    14749<>CALL    14753<>CALL    14776<>CALL    14807<>CALL    14909<>CALL
     14982<<ASSIGN  14989<>CALL    14998<>CALL    15001<>CALL    15010<>CALL    15124<<ASSIGN  15131<>CALL
     15139<>CALL    15142<>CALL    15149<>CALL    15250<>CALL
INBUFF
     12872**DCL     14430--ASSIGN  14506<<ASSIGN  14520<<ASSIGN  14645--ASSIGN  14661<<ASSIGN  14677<<ASSIGN
     14687<<ASSIGN  14696<<ASSIGN  14702<<CALLBLT 14704>>CALLBLT 14706<<CALLBLT 14707>>CALLBLT 14711<<CALLBLT
     14712>>CALLBLT 14715<<CALLBLT 14717>>CALLBLT 14719<<CALLBLT 14720>>CALLBLT 14722<<CALLBLT 14723>>CALLBLT
     14734<<CALLBLT 14735>>CALLBLT 14748<<ASSIGN  14751<<ASSIGN  14752>>CALLBLT 14774<<CALLBLT 14775>>CALLBLT
     14806<<ASSIGN  14908<<ASSIGN  14982--ASSIGN  14988<<ASSIGN  14996<<ASSIGN  15000<<ASSIGN  15009<<ASSIGN
     15124--ASSIGN  15130<<ASSIGN  15137<<ASSIGN  15141<<ASSIGN  15148<<ASSIGN  15249<<CALLBLT
J
     12820**DCL     14270<<CALLBLT 14272>>ASSIGN  14274<<CALLBLT 14276>>ASSIGN  14287<<ASSIGN  14292>>ASSIGN
     14293<<ASSIGN  14293>>ASSIGN  14298<<DOINDEX 14299>>ASSIGN  14299>>ASSIGN  14299>>ASSIGN  14302<<DOINDEX
     14303>>ASSIGN  14303>>ASSIGN  14303>>ASSIGN  14309<<DOINDEX 14310>>ASSIGN  14313<<DOINDEX 14314>>ASSIGN
     15043<<DOINDEX 15044>>IF      15047>>ASSIGN  15049>>ASSIGN
KL$DREC.PASSWORD
     14101**DCL     14105--REDEF
KL$DREC.PNAME
     14107**DCL     14391<<ASSIGN
KL$DREC.PNAME.CNT
     14115**DCL     14395<<ASSIGN
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:226  
KL$DREC.PNAME.TXT
     14118**DCL     14396<<ASSIGN
KL$DREC.RENAME
     14124**DCL     14125--REDEF
K_PRO
     13417**DCL     14475--ASSIGN
LDVCFLWCTRALG
     12937**DCL     14711>>CALLBLT
LEN
     12873**DCL     14239<>CALL    14240<>CALL    14288<<ASSIGN  14290>>DOWHILE 14291>>CALLBLT 14294<<ASSIGN
     14294>>ASSIGN  14450<<ASSIGN  14451<>CALL    14656<>CALL    14658<>CALL    14667<>CALL    14669<>CALL
     14675<>CALL    14679<>CALL    14685<>CALL    14689<>CALL    14704<<CALLBLT 14705<>CALL    14707<<CALLBLT
     14708<>CALL    14712<<CALLBLT 14713<>CALL    14717<<CALLBLT 14718<>CALL    14720<<CALLBLT 14721<>CALL
     14723<<CALLBLT 14724<>CALL    14735<<CALLBLT 14736<>CALL    14752<<CALLBLT 14753<>CALL    14775<<CALLBLT
     14776<>CALL    14900<<ASSIGN  14997<<ASSIGN  14998<>CALL    15138<<ASSIGN  15139<>CALL    15248<<ASSIGN
     15250<>CALL    15275<>CALL    15276>>CALLBLT 15277>>ASSIGN
LENGTH IN PROCEDURE PUT_DECIMAL
     15266**DCL     15262--PROC    15265--IMP-SIZ 15276>>CALLBLT 15277>>ASSIGN
LENGTH IN PROCEDURE PUT_FLAG
     15242**DCL     15238--PROC    15241--IMP-SIZ 15248>>ASSIGN  15249>>CALLBLT
LKEYTYPE
     12939**DCL     14751>>ASSIGN
LPARITY_TYPE
     12935**DCL     14706>>CALLBLT
LSPEED_TABLE
     12885**DCL     14702>>CALLBLT
M$CLOSE
      1554**DCL-ENT 14406--CALL    14919--CALL    14926--CALL    14938--CALL    15206--CALL    15209--CALL
     15231--CALL
M$GLINEATTR
      1579**DCL-ENT 14446--CALL    14581--CALL
M$GTRMATTR
      1580**DCL-ENT 14631--CALL
M$GTRMCTL
      1578**DCL-ENT 14609--CALL    14613--CALL    14622--CALL
M$IBEX1_NUM
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:227  
      9781**DCL     14388<>CALL    14398<>CALL    14404>>ASSIGN  14477>>ASSIGN  14494>>ASSIGN  14593>>ASSIGN
     14594>>ASSIGN  14914--IF      14917>>ASSIGN  14921--IF      14924>>ASSIGN  14933--IF      14936>>ASSIGN
     15181>>ASSIGN  15202<>CALL    15203<>CALL    15211<>CALL    15226--IF      15229>>ASSIGN
M$OPEN
      1554**DCL-ENT 14483--CALL    14597--CALL
M$PROFILE
      1582**DCL-ENT 14379--CALL
M$READ
      1555**DCL-ENT 14500--CALL
M$RPRIV
      1613**DCL-ENT 15072--CALL
M$SPRIV
      1613**DCL-ENT 15061--CALL
M$UC_NUM
      9778**DCL     14378>>ASSIGN
MATCH_STR
     12879**DCL     14503<>CALL
MATCH_STR.SIZ
     12880**DCL     12881--IMP-SIZ 14503>>CALL
MATCH_STR$
     12877**DCL     12879--IMP-PTR 14365<<ASSIGN  14424<<ASSIGN  14425<<ASSIGN  14503>>CALL    14503>>CALL
OOPS IN PROCEDURE PUT_DECIMAL
     15284**LABEL   15278--CALLALT
OOPS IN PROCEDURE PUT_FLAG
     15257**LABEL   15250--CALLALT
OUTBUFF
     12863**DCL     14226--ASSIGN  14229<<ASSIGN  14431--ASSIGN  14434<<ASSIGN  14643--ASSIGN  14650<<ASSIGN
     14980--ASSIGN  15005>>CALLBLT 15122--ASSIGN
OUTBUFF$
     12864**DCL     14226<<ASSIGN  14227>>ASSIGN  14240<>CALL    14242<>CALL    14249>>ASSIGN  14254<>CALL
     14255>>ASSIGN  14257>>ASSIGN  14431<<ASSIGN  14432>>ASSIGN  14448<>CALL    14451<>CALL    14453>>ASSIGN
     14454>>ASSIGN  14470>>ASSIGN  14471<>CALL    14507<>CALL    14521<>CALL    14524>>ASSIGN  14643<<ASSIGN
     14644>>ASSIGN  14658<>CALL    14662<>CALL    14669<>CALL    14678<>CALL    14679<>CALL    14688<>CALL
     14689<>CALL    14697<>CALL    14700>>ASSIGN  14701>>ASSIGN  14705<>CALL    14708<>CALL    14713<>CALL
     14718<>CALL    14721<>CALL    14724<>CALL    14736<>CALL    14749<>CALL    14753<>CALL    14776<>CALL
     14799>>ASSIGN  14804>>ASSIGN  14807<>CALL    14900>>ASSIGN  14903>>ASSIGN  14909<>CALL    14910>>ASSIGN
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:228  
     14980<<ASSIGN  14981>>ASSIGN  14983>>ASSIGN  14989<>CALL    14998<>CALL    15001<>CALL    15006>>IF
     15010<>CALL    15014>>ASSIGN  15122<<ASSIGN  15123>>ASSIGN  15125>>ASSIGN  15131<>CALL    15139<>CALL
     15142<>CALL    15145>>IF      15149<>CALL    15152>>ASSIGN  15250<>CALL    15278<>CALL
OUTPUT_LAST_LINE
     15014**LABEL   15005--CALLALT
P$B.CODE
     13695**DCL     14264>>DOCASE  14268>>DOCASE  14296>>DOCASE  14307>>DOCASE  14369>>IF      14389>>IF
     14574>>IF      15034>>IF      15035>>DOCASE  15044>>IF      15045>>DOCASE  15185>>DOCASE
P$B.NSUBLKS
     13699**DCL     14223>>IF      14266>>DOINDEX 14361>>IF      14385>>IF      14423>>IF      14574>>IF
     14574>>IF      14585>>IF      14969>>IF      15030>>DOWHILE 15184>>DOINDEX
P$B.SUBLK$
     13720**DCL     14264>>DOCASE  14266>>DOINDEX 14267>>ASSIGN  14267>>ASSIGN  14268>>DOCASE  14270>>CALLBLT
     14270>>CALLBLT 14270>>CALLBLT 14270>>CALLBLT 14274>>CALLBLT 14274>>CALLBLT 14274>>CALLBLT 14274>>CALLBLT
     14283>>ASSIGN  14285>>ASSIGN  14285>>ASSIGN  14288>>ASSIGN  14288>>ASSIGN  14296>>DOCASE  14307>>DOCASE
     14307>>DOCASE  14368>>ASSIGN  14374>>ASSIGN  14374>>ASSIGN  14391>>ASSIGN  14391>>ASSIGN  14422>>ASSIGN
     14425>>ASSIGN  14574>>IF      14588>>ASSIGN  14588>>ASSIGN  14588>>ASSIGN  14588>>ASSIGN  15033>>ASSIGN
     15035>>DOCASE  15045>>DOCASE  15185>>DOCASE  15186>>ASSIGN  15186>>ASSIGN  15186>>ASSIGN  15186>>ASSIGN
     15187>>ASSIGN  15187>>ASSIGN  15188>>ASSIGN  15188>>ASSIGN  15188>>ASSIGN  15188>>ASSIGN
P$PCB
     13745**DCL        15--PROC    14215--ENTRY   14352--ENTRY   14413--ENTRY   14559--ENTRY   14963--ENTRY
     15173--ENTRY
P$PCB.OUT$
     13758**DCL     14219>>ASSIGN  14353>>ASSIGN  14422>>ASSIGN  14563>>ASSIGN  14965>>ASSIGN  15175>>ASSIGN
P$S.COUNT
     13957**DCL     13960--IMP-SIZ 14270>>CALLBLT 14274>>CALLBLT 14288>>ASSIGN  14588>>ASSIGN  15186>>ASSIGN
     15187>>ASSIGN  15188>>ASSIGN
P$S.TEXT
     13960**DCL     14270>>CALLBLT 14274>>CALLBLT 14285--ASSIGN  14588>>ASSIGN  15186>>ASSIGN  15188>>ASSIGN
P$S.TEXTC$
     13952**DCL     14374>>ASSIGN  14374>>ASSIGN  14391>>ASSIGN  14391>>ASSIGN  14425>>ASSIGN
PPRIV45
     15152**LABEL   15118--CALLALT 15131--CALLALT 15139--CALLALT 15142--CALLALT 15149--CALLALT 15154--CALLALT
PPRIV_HDR
     12934**DCL     15117--ASSIGN
PPRIV_TBL
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:229  
     12888**DCL     15133--DOINDEX 15133--DOINDEX
PPRIV_TBL.HDR
     12891**DCL     15137>>ASSIGN
PPRIV_TBL.LEN
     12889**DCL     15138>>ASSIGN
PPRIV_TBL.MASK
     12896**DCL     15134>>IF
PRIV20
     15043**LABEL   15051--EXIT
PRIV45
     15095**LABEL   14976--CALLALT 14989--CALLALT 14998--CALLALT 15001--CALLALT 15010--CALLALT 15016--CALLALT
PRIVHDR
     12930**DCL     14975--ASSIGN
PRIV_ERR
     12943**DCL     15024<<ASSIGN  15062<<ASSIGN  15074<<ASSIGN  15087>>IF
PRIV_TBL
     12903**DCL     14992--DOINDEX 14992--DOINDEX
PRIV_TBL.CODE
     12921**DCL     15044>>IF
PRIV_TBL.HDR
     12906**DCL     14996>>ASSIGN
PRIV_TBL.LEN
     12904**DCL     14997>>ASSIGN
PRIV_TBL.MASK
     12911**DCL     14993>>IF      15047>>ASSIGN  15049>>ASSIGN
PROFC
     12876**DCL     14498<<ASSIGN  14505<<ASSIGN  14505>>ASSIGN  14517>>IF
PROFILE10
     14423**LABEL   14366--GOTO
PROFILE40
     14507**LABEL   14483--CALLALT 14500--CALLALT
PROFILE50
     14529**LABEL   14360--CALLALT 14379--CALLALT 14406--CALLALT 14420--CALLALT 14439--CALLALT 14448--CALLALT
     14451--CALLALT 14455--CALLALT 14464--CALLALT 14471--CALLALT 14507--CALLALT 14521--CALLALT 14528--CALLALT
     14529--CALLALT
PROFILE60
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:230  
     14533**LABEL   14388--CALLALT 14398--CALLALT 14534--CALLALT
PROMPT.LEN_
     12836**DCL     15187<<ASSIGN
PROMPT.PPROCESS_
     12837**DCL     15180<<ASSIGN  15197<<ASSIGN
PROMPT.TEXT_
     12840**DCL     15186<<ASSIGN  15195>>CALLBLT
PROMPT.TYPE_
     12838**DCL     15179<<ASSIGN  15189<<ASSIGN  15190<<ASSIGN  15191<<ASSIGN  15192<<ASSIGN  15201>>ASSIGN
     15203>>CALL    15205>>ASSIGN
PROMPT.VFC_
     12839**DCL     15178<<ASSIGN  15188<<ASSIGN  15199>>IF      15201<<ASSIGN
PROMPT$
     12821**DCL     12835--IMP-PTR 12855--IMP-PTR 15176<<ASSIGN  15178>>ASSIGN  15179>>ASSIGN  15180>>ASSIGN
     15186>>ASSIGN  15187>>ASSIGN  15188>>ASSIGN  15189>>ASSIGN  15190>>ASSIGN  15191>>ASSIGN  15192>>ASSIGN
     15195>>CALLBLT 15197>>ASSIGN  15199>>IF      15201>>ASSIGN  15201>>ASSIGN  15203>>CALL    15203>>CALL
     15203>>CALL    15205>>ASSIGN
PROMPT10
     15211**LABEL   15202--CALLALT
PROMPT20
     15209**LABEL   15203--CALLALT
PROMPT_KEYS
      9793**DCL     15203<>CALL
PROMPT_MASK
      9795**DCL     15205>>ASSIGN
PROMPT_VFCS
      9796**DCL     15201>>ASSIGN
PRO_AVAIL
     12933**DCL     14471--CALL    14471--CALL
PRO_CUR
     12932**DCL     14448--CALL    14448--CALL
PRO_HDR
     12931**DCL     14438--ASSIGN
PRO_NAME
     13444**DCL     14491--ASSIGN  14503<>CALL
PRO_NAME.L#
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:231  
     13444**DCL     14501>>IF      14506>>ASSIGN
PRO_NAME.NAME#
     13444**DCL     14506>>ASSIGN
PUT_DECIMAL
     15262**PROC    14725--CALL    14728--CALL    14729--CALL    14740--CALL    14742--CALL    14743--CALL
     14744--CALL    14747--CALL    14757--CALL    14758--CALL    14761--CALL    14762--CALL    14765--CALL
     14769--CALL    14780--CALL    14784--CALL    14785--CALL    14791--CALL    14794--CALL    14795--CALL
     14798--CALL
PUT_FLAG
     15238**PROC    14809--CALL    14810--CALL    14811--CALL    14812--CALL    14813--CALL    14814--CALL
     14815--CALL    14816--CALL    14817--CALL    14820--CALL    14821--CALL    14822--CALL    14823--CALL
     14824--CALL    14825--CALL    14826--CALL    14827--CALL    14828--CALL    14829--CALL    14830--CALL
     14833--CALL    14834--CALL    14835--CALL    14836--CALL    14837--CALL    14838--CALL    14839--CALL
     14842--CALL    14843--CALL    14844--CALL    14845--CALL    14846--CALL    14849--CALL    14850--CALL
     14851--CALL    14852--CALL    14853--CALL    14854--CALL    14855--CALL    14856--CALL    14857--CALL
     14858--CALL    14861--CALL    14862--CALL    14865--CALL    14866--CALL    14867--CALL    14868--CALL
     14869--CALL    14870--CALL    14871--CALL    14872--CALL    14875--CALL    14876--CALL    14877--CALL
     14880--CALL    14881--CALL    14882--CALL    14883--CALL    14884--CALL    14885--CALL    14886--CALL
     14887--CALL    14890--CALL    14893--CALL    14894--CALL    14895--CALL    14896--CALL    14897--CALL
     14898--CALL
RESET_PRIVS
     12942**DCL     15032<<ASSIGN  15037<<ASSIGN  15047<<ASSIGN  15047>>ASSIGN  15068>>IF      15071>>ASSIGN
     15073>>IF      15073>>IF      15075<<ASSIGN  15075>>ASSIGN  15077<<ASSIGN  15077>>ASSIGN  15078>>ASSIGN
     15079>>ASSIGN
SEG$2.FPT_CLOSE$
     14004**DCL     14917>>ASSIGN  14918>>ASSIGN  14919>>CALL    14924>>ASSIGN  14925>>ASSIGN  14926>>CALL
     14936>>ASSIGN  14937>>ASSIGN  14938>>CALL    15181>>ASSIGN  15182>>ASSIGN  15206>>CALL    15209>>CALL
     15229>>ASSIGN  15230>>ASSIGN  15231>>CALL
SEG$2.FPT_WRITE$
     14006**DCL     14249>>ASSIGN  14255>>ASSIGN  14257>>ASSIGN  14258<>CALL    14438>>ASSIGN  14439<>CALL
     14453>>ASSIGN  14454>>ASSIGN  14455<>CALL    14524>>ASSIGN  14526>>IF      14528<>CALL    14632>>ASSIGN
     14633>>ASSIGN  14633>>ASSIGN  14638>>ASSIGN  14639<>CALL    14700>>ASSIGN  14701>>ASSIGN  14799>>ASSIGN
     14800<>CALL    14903>>ASSIGN  14910>>ASSIGN  14913<>CALL    14975>>ASSIGN  14976<>CALL    14983>>ASSIGN
     15014>>ASSIGN  15016<>CALL    15117>>ASSIGN  15118<>CALL    15125>>ASSIGN  15152>>ASSIGN  15154<>CALL
SEG$2.HLP$
     13996**DCL     14391>>ASSIGN  14395>>ASSIGN  14396>>ASSIGN
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:232  
SEG$2.SPROMPT$
     14016**DCL     15176>>ASSIGN
SEG2$
      9768**DCL     13966--IMP-PTR 14249>>ASSIGN  14255>>ASSIGN  14257>>ASSIGN  14258>>CALL    14391>>ASSIGN
     14395>>ASSIGN  14396>>ASSIGN  14438>>ASSIGN  14439>>CALL    14453>>ASSIGN  14454>>ASSIGN  14455>>CALL
     14524>>ASSIGN  14526>>IF      14528>>CALL    14632>>ASSIGN  14633>>ASSIGN  14633>>ASSIGN  14638>>ASSIGN
     14639>>CALL    14700>>ASSIGN  14701>>ASSIGN  14799>>ASSIGN  14800>>CALL    14903>>ASSIGN  14910>>ASSIGN
     14913>>CALL    14917>>ASSIGN  14918>>ASSIGN  14919>>CALL    14924>>ASSIGN  14925>>ASSIGN  14926>>CALL
     14936>>ASSIGN  14937>>ASSIGN  14938>>CALL    14975>>ASSIGN  14976>>CALL    14983>>ASSIGN  15014>>ASSIGN
     15016>>CALL    15117>>ASSIGN  15118>>CALL    15125>>ASSIGN  15152>>ASSIGN  15154>>CALL    15176>>ASSIGN
     15181>>ASSIGN  15182>>ASSIGN  15206>>CALL    15209>>CALL    15229>>ASSIGN  15230>>ASSIGN  15231>>CALL
SEG3$
      9769**DCL     14360<>CALL    14377>>ASSIGN  14381<>CALL    14420<>CALL    14489>>ASSIGN  15225<>CALL
SET_PRIVS
     12941**DCL     15031<<ASSIGN  15039<<ASSIGN  15049<<ASSIGN  15049>>ASSIGN  15057>>IF      15060>>ASSIGN
     15063<<ASSIGN  15063>>ASSIGN  15065>>ASSIGN  15066>>ASSIGN
STRM
     12884**DCL     14588<<ASSIGN  14589<>CALL    14595>>CALLBLT
SWITCH50
     14310**LABEL   14240--CALLALT 14242--CALLALT 14254--CALLALT 14258--CALLALT
SW_BINARY
     12928**DCL     14299>>ASSIGN  14303>>ASSIGN
SW_OCTAL
     12927**DCL     12928--REDEF   14284<<ASSIGN  14292<<ASSIGN
TAB_VAL
     12874**DCL     14231<<ASSIGN  14240<>CALL    14242<>CALL    14433<<ASSIGN  14507<>CALL    14526>>IF
     14646<<ASSIGN  14705<>CALL    14708<>CALL    14713<>CALL    14718<>CALL    14721<>CALL    14724<>CALL
     14736<>CALL    14776<>CALL    14808<<ASSIGN  14984<<ASSIGN  14989<>CALL    14998<>CALL    15001<>CALL
     15006>>IF      15010<>CALL    15126<<ASSIGN  15131<>CALL    15139<>CALL    15142<>CALL    15145>>IF
     15149<>CALL    15250<>CALL    15278<>CALL
TBUFF
     12867**DCL     14238<<CALLBLT 14239<>CALL    14239--CALL    14240--CALL    14241<<ASSIGN  14242--CALL
     14253<<ASSIGN  14254--CALL    15274<<CALLBLT 15275<>CALL    15275--CALL    15276>>CALLBLT
TEMP$
     12862**DCL     14267<<ASSIGN  14268>>DOCASE  14270>>CALLBLT 14270>>CALLBLT 14274>>CALLBLT 14274>>CALLBLT
     14283<<ASSIGN  14285>>ASSIGN  14288>>ASSIGN  14296>>DOCASE  14368<<ASSIGN  14369>>IF      14374>>ASSIGN
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:233  
     14374>>ASSIGN  14385>>IF      14389>>IF      14391>>ASSIGN  14391>>ASSIGN  15033<<ASSIGN  15034>>IF
     15035>>DOCASE  15044>>IF      15045>>DOCASE
TEMP_STOR
     12875**DCL     14291<<CALLBLT 14292>>ASSIGN  14787<<ASSIGN  14790<<ASSIGN  14790>>ASSIGN  14791<>CALL
TERM50
     14926**LABEL   14581--CALLALT 14609--CALLALT 14631--CALLALT
TERM70
     14931**LABEL   14600--GOTO    14639--CALLALT 14658--CALLALT 14662--CALLALT 14669--CALLALT 14678--CALLALT
     14679--CALLALT 14688--CALLALT 14689--CALLALT 14697--CALLALT 14705--CALLALT 14708--CALLALT 14713--CALLALT
     14718--CALLALT 14721--CALLALT 14724--CALLALT 14725--CALLALT 14728--CALLALT 14729--CALLALT 14736--CALLALT
     14740--CALLALT 14742--CALLALT 14743--CALLALT 14744--CALLALT 14747--CALLALT 14749--CALLALT 14753--CALLALT
     14757--CALLALT 14758--CALLALT 14761--CALLALT 14762--CALLALT 14765--CALLALT 14769--CALLALT 14776--CALLALT
     14780--CALLALT 14784--CALLALT 14785--CALLALT 14791--CALLALT 14794--CALLALT 14795--CALLALT 14798--CALLALT
     14800--CALLALT 14807--CALLALT 14809--CALLALT 14810--CALLALT 14811--CALLALT 14812--CALLALT 14813--CALLALT
     14814--CALLALT 14815--CALLALT 14816--CALLALT 14817--CALLALT 14820--CALLALT 14821--CALLALT 14822--CALLALT
     14823--CALLALT 14824--CALLALT 14825--CALLALT 14826--CALLALT 14827--CALLALT 14828--CALLALT 14829--CALLALT
     14830--CALLALT 14833--CALLALT 14834--CALLALT 14835--CALLALT 14836--CALLALT 14837--CALLALT 14838--CALLALT
     14839--CALLALT 14842--CALLALT 14843--CALLALT 14844--CALLALT 14845--CALLALT 14846--CALLALT 14849--CALLALT
     14850--CALLALT 14851--CALLALT 14852--CALLALT 14853--CALLALT 14854--CALLALT 14855--CALLALT 14856--CALLALT
     14857--CALLALT 14858--CALLALT 14861--CALLALT 14862--CALLALT 14865--CALLALT 14866--CALLALT 14867--CALLALT
     14868--CALLALT 14869--CALLALT 14870--CALLALT 14871--CALLALT 14872--CALLALT 14875--CALLALT 14876--CALLALT
     14877--CALLALT 14880--CALLALT 14881--CALLALT 14882--CALLALT 14883--CALLALT 14884--CALLALT 14885--CALLALT
     14886--CALLALT 14887--CALLALT 14890--CALLALT 14893--CALLALT 14894--CALLALT 14895--CALLALT 14896--CALLALT
     14897--CALLALT 14898--CALLALT 14909--CALLALT 14913--CALLALT
TERM80
     14939**LABEL   14919--CALLALT 14926--CALLALT 14938--CALLALT
TEXT IN PROCEDURE PUT_DECIMAL
     15265**DCL     15262--PROC    15276>>CALLBLT
TEXT IN PROCEDURE PUT_FLAG
     15241**DCL     15238--PROC    15249>>CALLBLT
TEXT$C
     14026**DCL     14374--ASSIGN  14391>>ASSIGN
TEXT$C.SIZ
     14027**DCL     14028--IMP-SIZ 14374>>ASSIGN  14391>>ASSIGN
THDR
     12929**DCL     14638--ASSIGN
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:234  
TLEN IN PROCEDURE PUT_DECIMAL
     15269**DCL     15277<<ASSIGN  15278<>CALL
TSTRING IN PROCEDURE PUT_DECIMAL
     15268**DCL     15276<<CALLBLT 15278--CALL
USER_PRIV
     13388**DCL     15061<>CALL    15072<>CALL
USER_PRIV.V
     13388**DCL     15026--ASSIGN
USER_PRIV.V.AUTH#
     13389**DCL     15027<<ASSIGN
USER_PRIV.V.PPRIV#
     13389**DCL     15028<<ASSIGN
USER_PRIV.V.PRIV#
     13388**DCL     15060<<ASSIGN  15071<<ASSIGN
USER_PRIV.V_
     13388**DCL     15026<<ASSIGN
VLP_EDTCTL
     13504**DCL     14610--ASSIGN
VLP_EDTCTL.EASYAPPEND#
     13505**DCL     14833<>CALL
VLP_EDTCTL.HSALL#
     13504**DCL     14842<>CALL
VLP_EDTCTL.KEYINCR#
     13507**DCL     14747>>CALL
VLP_EDTCTL.KEYTYPE#
     13505**DCL     14751>>ASSIGN
VLP_EDTCTL.ONESPACEEDIT#
     13508**DCL     14861<>CALL
VLP_EDTCTL.RCRWRAP#
     13504**DCL     14875<>CALL
VLP_EDTCTL.TEXTEDIT#
     13505**DCL     14890<>CALL
VLP_EDTCTL.VSMARGIN#
     13506**DCL     14784>>CALL
VLP_EDTCTL.VSSHIFT#
     13507**DCL     14785>>CALL
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:235  
VLP_LINEATTR
     13574**DCL     14445--ASSIGN  14580--ASSIGN
VLP_LINEATTR.CONTROLLER#
     13577**DCL     14672>>IF      14675<>CALL    14675--CALL    14679--CALL
VLP_LINEATTR.DEVICE#
     13578**DCL     14682>>IF      14685<>CALL    14685--CALL    14689--CALL
VLP_LINEATTR.LINESPEED#
     13575**DCL     14702>>CALLBLT
VLP_LINEATTR.MULTIDEVICE#
     13574**DCL     14693>>IF
VLP_LINEATTR.NODE#
     13577**DCL     14653>>IF      14656<>CALL    14656--CALL    14658--CALL
VLP_LINEATTR.PORT#
     13577**DCL     14664>>IF      14667<>CALL    14667--CALL    14669--CALL
VLP_LINEATTR.PROFILE#
     13576**DCL     13576--REDEF
VLP_LINEATTR.PROTXTC.CNT
     13576**DCL     14450>>ASSIGN  14715>>CALLBLT
VLP_LINEATTR.PROTXTC.TXT
     13577**DCL     14451--CALL    14715>>CALLBLT
VLP_TRMATTR
     13597**DCL     14630--ASSIGN
VLP_TRMATTR.APL#
     13603**DCL     14811<>CALL
VLP_TRMATTR.ATRSCRNPOS#
     13608**DCL     14813<>CALL
VLP_TRMATTR.AUTONL#
     13600**DCL     14815<>CALL
VLP_TRMATTR.BIN#
     13603**DCL     14816<>CALL
VLP_TRMATTR.BLANKERASES#
     13601**DCL     14817<>CALL
VLP_TRMATTR.CHARSETNAME#
     13613**DCL     14722>>CALLBLT
VLP_TRMATTR.CRISNL#
     13600**DCL     14821<>CALL
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:236  
VLP_TRMATTR.CURSORUP#
     13598**DCL     14823<>CALL
VLP_TRMATTR.DCHMOVFLD#
     13609**DCL     14824<>CALL
VLP_TRMATTR.DEVICEBS#
     13599**DCL     14825<>CALL
VLP_TRMATTR.DEVICECR#
     13598**DCL     14826<>CALL
VLP_TRMATTR.DEVICELF#
     13599**DCL     14827<>CALL
VLP_TRMATTR.DEVPOSOPTS#
     13602**DCL     14828<>CALL
VLP_TRMATTR.DEVSCROLL#
     13598**DCL     14829<>CALL
VLP_TRMATTR.DSPHEIGHT#
     13614**DCL     14729>>CALL
VLP_TRMATTR.DVCFLWCTRALG#
     13612**DCL     14709>>IF      14711>>CALLBLT
VLP_TRMATTR.EXTWID#
     13605**DCL     14788>>IF
VLP_TRMATTR.FCNTBL#
     13613**DCL     14719>>CALLBLT
VLP_TRMATTR.FF_FLUSH#
     13611**DCL     14836<>CALL
VLP_TRMATTR.FF_INCCR#
     13615**DCL     14837<>CALL
VLP_TRMATTR.HEIGHT#
     13610**DCL     14742>>CALL
VLP_TRMATTR.LFISNL#
     13601**DCL     14846<>CALL
VLP_TRMATTR.LIMBOCLM#
     13604**DCL     14850<>CALL
VLP_TRMATTR.LOCALECHO#
     13604**DCL     14851<>CALL
VLP_TRMATTR.LOWERCASEPRINTS#
     13603**DCL     14853<>CALL
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:237  
VLP_TRMATTR.MAXATRS#
     13614**DCL     14758>>CALL
VLP_TRMATTR.MICROFPL#
     13612**DCL     14854<>CALL
VLP_TRMATTR.MINREC#
     13610**DCL     14762>>CALL
VLP_TRMATTR.NO_FLDTRM#
     13608**DCL     14857<>CALL
VLP_TRMATTR.OPDTAB#
     13597**DCL     14862<>CALL
VLP_TRMATTR.PARITY#
     13605**DCL     14706>>CALLBLT
VLP_TRMATTR.PRINTTYPE#
     13606**DCL     14871<>CALL
VLP_TRMATTR.PROGDTAB#
     13597**DCL     14872<>CALL
VLP_TRMATTR.SPCBFRPRT#
     13607**DCL     14885<>CALL
VLP_TRMATTR.TRUOVRPRT#
     13602**DCL     14895<>CALL
VLP_TRMATTR.TTYTYPE#
     13607**DCL     14896<>CALL
VLP_TRMATTR.WIDTH#
     13609**DCL     14787>>ASSIGN
VLP_TRMCTL
     13463**DCL     14584--ASSIGN
VLP_TRMCTL.ACTONTRN#
     13469**DCL     14809<>CALL
VLP_TRMCTL.ADJTOPLFT#
     13483**DCL     14810<>CALL
VLP_TRMCTL.APLLCNRM#
     13469**DCL     14812<>CALL
VLP_TRMCTL.AUTOCURSOR#
     13482**DCL     14814<>CALL
VLP_TRMCTL.AUTOTABCLM#
     13479**DCL     14725>>CALL
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:238  
VLP_TRMCTL.BREAKCOUNT
     13474**DCL     13475--REDEF
VLP_TRMCTL.CURSORREAD#
     13481**DCL     14822<>CALL
VLP_TRMCTL.DISPINPUT#
     13465**DCL     14830<>CALL
VLP_TRMCTL.EDITOVR#
     13470**DCL     14834<>CALL
VLP_TRMCTL.ENBENTEXTSRDCHR#
     13477**DCL     14835<>CALL
VLP_TRMCTL.FULLDUXPAPERTAPE#
     13467**DCL     14838<>CALL
VLP_TRMCTL.HALFDUXPAPERTAPE#
     13468**DCL     14839<>CALL
VLP_TRMCTL.HSCROLL#
     13475**DCL     14843<>CALL
VLP_TRMCTL.HSMARGIN#
     13480**DCL     14743>>CALL
VLP_TRMCTL.HSSHIFT#
     13480**DCL     14744>>CALL
VLP_TRMCTL.INSERTMODE#
     13476**DCL     14844<>CALL
VLP_TRMCTL.KEEPTYPAHD#
     13482**DCL     14845<>CALL
VLP_TRMCTL.LOWERCASE#
     13467**DCL     14852<>CALL
VLP_TRMCTL.MSGHALT#
     13476**DCL     14855<>CALL
VLP_TRMCTL.MSGLINE#
     13477**DCL     14856<>CALL
VLP_TRMCTL.NOOPTMIZ#
     13473**DCL     14858<>CALL
VLP_TRMCTL.OUTPUTDISCARD#
     13466**DCL     14866<>CALL
VLP_TRMCTL.PAGEHALT#
     13471**DCL     14867<>CALL
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:239  
VLP_TRMCTL.PARITYCHECK#
     13465**DCL     14868<>CALL
VLP_TRMCTL.PARKCURSOR#
     13481**DCL     14869<>CALL
VLP_TRMCTL.PRINTHALT#
     13471**DCL     14870<>CALL
VLP_TRMCTL.RELPAGE#
     13472**DCL     14876<>CALL
VLP_TRMCTL.RETYPOVR#
     13469**DCL     14877<>CALL
VLP_TRMCTL.SCROLL#
     13470**DCL     14881<>CALL
VLP_TRMCTL.SENDBKSPACE#
     13464**DCL     14882<>CALL
VLP_TRMCTL.SIMPERF#
     13472**DCL     14883<>CALL
VLP_TRMCTL.SINPUTSZ#
     13474**DCL     14767>>IF      14769>>CALL
VLP_TRMCTL.SPACEINSERT#
     13464**DCL     14884<>CALL
VLP_TRMCTL.TABRELATIVE#
     13463**DCL     14886<>CALL
VLP_TRMCTL.TABSIM#
     13463**DCL     14887<>CALL
VLP_TRMCTL.TRUNCATE#
     13473**DCL     14894<>CALL
VLP_TRMCTL.UPPERCASE#
     13466**DCL     14897<>CALL
VLP_TRMCTL.WORDWRAPCLM#
     13479**DCL     14795>>CALL
VLP_TRMCTL.WRAPPAGE#
     13473**DCL     14898<>CALL
VLP_WINDOW
     13532**DCL     14619--ASSIGN
VLP_WINDOW.BTMBRDR#
     13548**DCL     14820<>CALL
PL6.E3A0      #001=CPF$IBEX3 File=CPF$IBEX3.:E05TSI                              TUE 07/29/97 11:40 Page:240  
VLP_WINDOW.FWINDOW#
     13532**DCL     13532--REDEF   13533--REDEF
VLP_WINDOW.HBRDRCHR#
     13549**DCL     14732>>IF      14734>>CALLBLT
VLP_WINDOW.HBRDRSIZ#
     13549**DCL     14738>>IF      14740>>CALL
VLP_WINDOW.LENGTH#
     13546**DCL     14794>>CALL
VLP_WINDOW.LFTBRDR#
     13550**DCL     14849<>CALL
VLP_WINDOW.MINLENGTH#
     13551**DCL     14761>>CALL
VLP_WINDOW.MINWIDTH#
     13552**DCL     14765>>CALL
VLP_WINDOW.ORG_PST.COLUMN
     13547**DCL     14728>>CALL
VLP_WINDOW.ORG_PST.LINE
     13547**DCL     14757>>CALL
VLP_WINDOW.REMOVABLE#
     13553**DCL     14865<>CALL
VLP_WINDOW.RHTBRDR#
     13550**DCL     14880<>CALL
VLP_WINDOW.TOPBRDR#
     13548**DCL     14893<>CALL
VLP_WINDOW.VBRDRCHR#
     13551**DCL     14772>>IF      14774>>CALLBLT
VLP_WINDOW.VBRDRSIZ#
     13550**DCL     14778>>IF      14780>>CALL
VLP_WINDOW.WIDTH#
     13546**DCL     14798>>CALL
WRT_PROMPT
     12855**DCL     15203--CALL
WRT_PROMPT.LEN_
     12856**DCL     12860--IMP-SIZ 15203>>CALL

PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:241  
     1257        1        /*M* Return a vector of the desired PROMPT type */
     1258        2        /*T***********************************************************/
     1259        3        /*T*                                                         */
     1260        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1261        5        /*T*                                                         */
     1262        6        /*T***********************************************************/
     1263        7        /*X*  DMC,DFC   */
     1264        8        /*P*   NAME:   CPF$SET_PROMPT
     1265        9               PURPOSE: To set up the desired prompt in SEG$2.RPROMPT$
     1266       10               INPUT: PROMPT_TYPE - type of prompt to setup (PRMT_x)
     1267       11               OUTPUT: PROMPT_ - vector framing the prompt.
     1268       12               DESCRIPTION: CPF$SET_PROMPT will use the default prompt if
     1269       13                      the user hasn't specified one, else the user's is used.
     1270       14               REFERENCE: Programmers Reference Manual
     1271       15        */
     1272       16        /**********************************************************************/
     1273       17        CPF$SET_PROMPT: PROC (PROMPT_, PROMPT_TYPE);
     1274       18    1     DCL PROMPT_ VECTOR ALIGNED;
     1275       19    1     DCL PROMPT_TYPE SBIN;
     1276       20
     1277       21          %INCLUDE B$JIT;
     1278      311          %INCLUDE CP_6;
     1279      392          %INCLUDE CP_6_SUBS;
     1280      932          %INCLUDE XU_MACRO_C;
     1281     4038          %INCLUDE CP_MACROS_C;
     1282     4790          %INCLUDE CP_SUBS_C;
     1283     5707          %INCLUDE CP_DATA_R;
     1284     8270          %INCLUDE XUE_MACRO_C;
     1285     9014          %INCLUDE XUE_SUBS_C;
     1286     9194        /***** Constants *****/
     1287     9195    1     DCL XUE_PREEXP SBIN SYMREF READONLY;
     1288     9196        /***** Structures *****/
     1289     9197          %SEG$2;
     1290     9257          %XUE_PPCB (NAME=CXUE_PPCB, STCLASS=CONSTANT, WKSZ="SIZEW(WORK_AREA)",
     1291     9258                     FUN=CPG$FUN$$, PROCNAME=IBEX_NAME, ROOT=XUE_PREEXP);
     1292     9525          %XUE_PPCB (NAME=XUE_PPCB, STCLASS=AUTO);
     1293     9792          %CP_PROMPT (NAME=PROMPT, STCLASS=BASED);
PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:242  
     1294     9812          %FPT_CLOSE (FPTN=FPT$CLOSE, STCLASS=BASED);
     1295     9854        /***** Auto ******/
     1296     9855    1     DCL WORK_AREA (0:1023) SBIN;
     1297     9856    1     DCL PROMPT# SBIN;
     1298     9857    1     DCL CPOS UBIN;
     1299     9858    1     DCL VALUE SBIN;
     1300     9859        /***** Entries *****/
     1301     9860    1     DCL CPC$WRITEMSGE ENTRY(6);
     1302     9861    1     DCL CXP$POSTERR ENTRY(5);
     1303     9862    1     DCL CPG$FUN$$ ENTRY(1);
     1304     9863    1     DCL CPC$OPEN_S ENTRY(1) ALTRET;
     1305     9864    1     DCL CPJ$READ_S ENTRY(3) ALTRET;
     1306     9865    1     DCL X$PRE_PROCESS ENTRY(1) ALTRET;
     1307     9866
     1308     9867    1     PROMPT# = PROMPT_TYPE;
     1309     9868    1     SEG$2.LASTPROMPT = PROMPT#;
     1310     9869    1     IF NOT (B$JIT.PROMPTS & PROMPT_MASK(PROMPT#))
     1311     9870    1       THEN
     1312     9871    1         GOTO SET_DEFAULT_PROMPT;
     1313     9872    1     IF  (PROMPT# ~= PRMT_R
     1314     9873    1     AND (B$JIT.MODE ~= %M_INT# OR B$JIT.NEXTCC ~= %CC_FROMUC#))
     1315     9874    2       THEN DO;
     1316     9875    2         PROMPT# = PRMT_N;
     1317     9876    2         GOTO SET_DEFAULT_PROMPT;
     1318     9877    2       END;
     1319     9878    1     IF SEG$2.SPROMPT$->PROMPT.TYPE_ ~= PROMPT#
     1320     9879    2       THEN DO;  /* we don't have the desired user prompt, get it */
     1321     9880    2         CALL CPC$OPEN_S (M$IBEX1_NUM) ALTRET (USE_DEFAULT_PROMPT);
     1322     9881    2         CALL CPJ$READ_S (M$IBEX1_NUM, PROMPT_KEYS (PROMPT#),
     1323     9882    2                          VECTOR (SEG$2.SPROMPT$->PROMPT))
     1324     9883    2                            ALTRET (USE_DEFAULT_PROMPT);
     1325     9884    2         SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DCB# = M$IBEX1_NUM;
     1326     9885    2         SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DISP# = %SAVE#;
     1327     9886    3         CALL M$CLOSE(SEG$2.FPT_CLOSE$->FPT$CLOSE) WHENALTRETURN DO; END;
     1328     9887    2       END;
     1329     9888    1     IF SEG$2.SPROMPT$->PROMPT.PPROCESS_
     1330     9889    2       THEN DO;  /* We need to reevaluate this one every time */
PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:243  
     1331     9890    2         XUE_PPCB = CXUE_PPCB;
     1332     9891    2         XUE_PPCB.ECB.WORK$ = ADDR(WORK_AREA);
     1333     9892    2         XUE_PPCB.ECB.WORK_DCB# = M$IBEX1_NUM;
     1334     9893    2         XUE_PPCB.INBUF$ = ADDR (SEG$2.SPROMPT$->PROMPT.TEXT_);
     1335     9894    2         XUE_PPCB.ICHARS# = SEG$2.SPROMPT$->PROMPT.LEN_;
     1336     9895    2         XUE_PPCB.OUTBUF$ = ADDR (SEG$2.PROMPT$->PROMPT.TEXT_);
     1337     9896    2         XUE_PPCB.OCHARS# = LENGTHC (SEG$2.PROMPT$->PROMPT.TEXT_);
     1338     9897    2         SEG$2.FLAGS.USE_REMEM = '1'B;
     1339     9898    2         CALL X$PRE_PROCESS (XUE_PPCB)
     1340     9899    3           WHENALTRETURN DO;
     1341     9900    3             CPOS = XUE_PPCB.ECB.ERR_POS#;
     1342     9901    3             VALUE = XUE_PPCB.ECB.ERR_DCB#;
     1343     9902    3             CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,XUE_PPCB.ECB.ERR,,VALUE);
     1344     9903    3             SEG$2.FLAGS.USE_REMEM = '0'B;
     1345     9904    3             GOTO KILL_NON_DEFAULT_PROMPT;
     1346     9905    3           END;
     1347     9906    2         SEG$2.FLAGS.USE_REMEM = '0'B;
     1348     9907    2         SEG$2.PROMPT$->PROMPT.VFC_ = SEG$2.SPROMPT$->PROMPT.VFC_;
     1349     9908    2         SEG$2.PROMPT$->PROMPT.LEN_ = XUE_PPCB.RCHARS#;
     1350     9909    2       END;
     1351     9910    2       ELSE DO;
     1352     9911    2         SEG$2.PROMPT$->PROMPT = SEG$2.SPROMPT$->PROMPT;
     1353     9912    2       END;
     1354     9913    1     IF SEG$2.PROMPT$->PROMPT.LEN_ > 94 /* max prompt length */ THEN GOTO
              9913              SET_DEFAULT_PROMPT;
     1355     9914    1     PROMPT_ = VECTOR (SUBSTR (SEG$2.PROMPT$->PROMPT.VFC_, 0,
     1356     9915    1                               SEG$2.PROMPT$->PROMPT.LEN_+1));
     1357     9916    1     RETURN;
     1358     9917
     1359     9918    1   USE_DEFAULT_PROMPT:  /* we couldn't get the user's prompt */
     1360     9919    1     CALL CPC$WRITEMSGE (B$JIT.USRERR, M$IBEX1_NUM);
     1361     9920    1     B$JIT.USRERR = '0'B;
     1362     9921    1   KILL_NON_DEFAULT_PROMPT:
     1363     9922    1     B$JIT.PROMPTS = B$JIT.PROMPTS & ~PROMPT_MASK(PROMPT#);
     1364     9923    1   SET_DEFAULT_PROMPT:
     1365     9924    1     PROMPT_ = PROMPTS (PROMPT#);
     1366     9925    1     RETURN;
PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:244  
     1367     9926    1   END CPF$SET_PROMPT;
     1368     9927        %EOD;

PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:245  
--  Include file information  --

   XUE_SUBS_C.:E05TOU  is referenced.
   XUE_MACRO_C.:E05TOU  is referenced.
   CP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_SUBS_C.:E05TOU  is referenced.
   CP_MACROS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure CPF$SET_PROMPT.

   Procedure CPF$SET_PROMPT requires 201 words for executable code.
   Procedure CPF$SET_PROMPT requires 1076 words of local(AUTO) storage.

PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:246  

 Object Unit name= CPF$SET_PROMPT                             File name= CPF$IBEX3.:E05TOU
 UTS= JUL 29 '97 11:41:44.72 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     34     42  CPF$SET_PROMPT
    2   Proc  even  none   201    311  CPF$SET_PROMPT
    3  RoData even  none     5      5  CPF$SET_PROMPT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        2  CPF$SET_PROMPT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 CPG$FUN$$
 yes     yes           Std       1 CPC$OPEN_S
 yes     yes           Std       1 X$PRE_PROCESS
 yes     yes           Std       3 CPJ$READ_S
         yes           Std       6 CPC$WRITEMSGE
         yes           Std       5 CXP$POSTERR
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:247  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  IBEX_NAME                        r    SEG2$
r    B$JIT$                                M$IBEX1_NUM                           PROMPT_KEYS
     PROMPTS                               PROMPT_MASK                      r    XUE_PREEXP
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:248  


     1257        1        /*M* Return a vector of the desired PROMPT type */
     1258        2        /*T***********************************************************/
     1259        3        /*T*                                                         */
     1260        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1261        5        /*T*                                                         */
     1262        6        /*T***********************************************************/
     1263        7        /*X*  DMC,DFC   */
     1264        8        /*P*   NAME:   CPF$SET_PROMPT
     1265        9               PURPOSE: To set up the desired prompt in SEG$2.RPROMPT$
     1266       10               INPUT: PROMPT_TYPE - type of prompt to setup (PRMT_x)
     1267       11               OUTPUT: PROMPT_ - vector framing the prompt.
     1268       12               DESCRIPTION: CPF$SET_PROMPT will use the default prompt if
     1269       13                      the user hasn't specified one, else the user's is used.
     1270       14               REFERENCE: Programmers Reference Manual
     1271       15        */
     1272       16        /**********************************************************************/
     1273       17        CPF$SET_PROMPT: PROC (PROMPT_, PROMPT_TYPE);

     17  2 000000   000000 700200 xent  CPF$SET_PRO* TSX0  ! X66_AUTO_2
         2 000001   002064 000002                    ZERO    1076,2

     1274       18    1     DCL PROMPT_ VECTOR ALIGNED;
     1275       19    1     DCL PROMPT_TYPE SBIN;
     1276       20
     1277       21          %INCLUDE B$JIT;
     1278      311          %INCLUDE CP_6;
     1279      392          %INCLUDE CP_6_SUBS;
     1280      932          %INCLUDE XU_MACRO_C;
     1281     4038          %INCLUDE CP_MACROS_C;
     1282     4790          %INCLUDE CP_SUBS_C;
     1283     5707          %INCLUDE CP_DATA_R;
     1284     8270          %INCLUDE XUE_MACRO_C;
     1285     9014          %INCLUDE XUE_SUBS_C;
     1286     9194        /***** Constants *****/
     1287     9195    1     DCL XUE_PREEXP SBIN SYMREF READONLY;
     1288     9196        /***** Structures *****/
PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:249  
     1289     9197          %SEG$2;
     1290     9257          %XUE_PPCB (NAME=CXUE_PPCB, STCLASS=CONSTANT, WKSZ="SIZEW(WORK_AREA)",
     1291     9258                     FUN=CPG$FUN$$, PROCNAME=IBEX_NAME, ROOT=XUE_PREEXP);
     1292     9525          %XUE_PPCB (NAME=XUE_PPCB, STCLASS=AUTO);
     1293     9792          %CP_PROMPT (NAME=PROMPT, STCLASS=BASED);
     1294     9812          %FPT_CLOSE (FPTN=FPT$CLOSE, STCLASS=BASED);
     1295     9854        /***** Auto ******/
     1296     9855    1     DCL WORK_AREA (0:1023) SBIN;
     1297     9856    1     DCL PROMPT# SBIN;
     1298     9857    1     DCL CPOS UBIN;
     1299     9858    1     DCL VALUE SBIN;
     1300     9859        /***** Entries *****/
     1301     9860    1     DCL CPC$WRITEMSGE ENTRY(6);
     1302     9861    1     DCL CXP$POSTERR ENTRY(5);
     1303     9862    1     DCL CPG$FUN$$ ENTRY(1);
     1304     9863    1     DCL CPC$OPEN_S ENTRY(1) ALTRET;
     1305     9864    1     DCL CPJ$READ_S ENTRY(3) ALTRET;
     1306     9865    1     DCL X$PRE_PROCESS ENTRY(1) ALTRET;
     1307     9866
     1308     9867    1     PROMPT# = PROMPT_TYPE;

   9867  2 000002   200004 470500                    LDP0    @PROMPT_TYPE,,AUTO
         2 000003   000000 235100                    LDA     0,,PR0
         2 000004   202050 755100                    STA     PROMPT#,,AUTO

     1309     9868    1     SEG$2.LASTPROMPT = PROMPT#;

   9868  2 000005   000000 620005                    EAX0    0,AL
         2 000006   000000 471400 xsym               LDP1    SEG2$
         2 000007   100002 440100                    SXL0    2,,PR1

     1310     9869    1     IF NOT (B$JIT.PROMPTS & PROMPT_MASK(PROMPT#))

   9869  2 000010   202050 721100                    LXL1    PROMPT#,,AUTO
         2 000011   000000 236011 xsym               LDQ     PROMPT_MASK,X1
         2 000012   760000 376003                    ANQ     -8192,DU
         2 000013   202054 756100                    STQ     VALUE+2,,AUTO
PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:250  
         2 000014   000000 473400 xsym               LDP3    B$JIT$
         2 000015   300153 236100                    LDQ     107,,PR3
         2 000016   000026 736000                    QLS     22
         2 000017   760000 376003                    ANQ     -8192,DU
         2 000020   202054 376100                    ANQ     VALUE+2,,AUTO
         2 000021   000302 600000 2                  TZE     SET_DEFAULT_PROMPT

     1311     9870    1       THEN
     1312     9871    1         GOTO SET_DEFAULT_PROMPT;
     1313     9872    1     IF  (PROMPT# ~= PRMT_R

   9872  2 000022   202050 235100                    LDA     PROMPT#,,AUTO
         2 000023   000004 115007                    CMPA    4,DL
         2 000024   000040 600000 2                  TZE     s:9878
         2 000025   300000 236100                    LDQ     0,,PR3
         2 000026   740000 376003                    ANQ     -16384,DU
         2 000027   140000 116003                    CMPQ    49152,DU
         2 000030   000035 601000 2                  TNZ     s:9875
         2 000031   300151 236100                    LDQ     105,,PR3
         2 000032   000777 376003                    ANQ     511,DU
         2 000033   000003 116003                    CMPQ    3,DU
         2 000034   000040 600000 2                  TZE     s:9878

     1314     9873    1     AND (B$JIT.MODE ~= %M_INT# OR B$JIT.NEXTCC ~= %CC_FROMUC#))
     1315     9874    2       THEN DO;

     1316     9875    2         PROMPT# = PRMT_N;

   9875  2 000035   000001 236007                    LDQ     1,DL
         2 000036   202050 756100                    STQ     PROMPT#,,AUTO

     1317     9876    2         GOTO SET_DEFAULT_PROMPT;

   9876  2 000037   000302 710000 2                  TRA     SET_DEFAULT_PROMPT

     1318     9877    2       END;
     1319     9878    1     IF SEG$2.SPROMPT$->PROMPT.TYPE_ ~= PROMPT#
PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:251  

   9878  2 000040   100177 474500                    LDP4    127,,PR1
         2 000041   400000 236100                    LDQ     0,,PR4
         2 000042   777777 376007                    ANQ     -1,DL
         2 000043   202050 116100                    CMPQ    PROMPT#,,AUTO
         2 000044   000107 600000 2                  TZE     s:9888

     1320     9879    2       THEN DO;  /* we don't have the desired user prompt, get it */

     1321     9880    2         CALL CPC$OPEN_S (M$IBEX1_NUM) ALTRET (USE_DEFAULT_PROMPT);

   9880  2 000045   000000 630400 3                  EPPR0   0
         2 000046   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000047   000000 701000 xent               TSX1    CPC$OPEN_S
         2 000050   000251 702000 2                  TSX2    USE_DEFAULT_PROMPT

     1322     9881    2         CALL CPJ$READ_S (M$IBEX1_NUM, PROMPT_KEYS (PROMPT#),

   9881  2 000051   000000 470400 xsym               LDP0    SEG2$
         2 000052   000177 471500                    LDP1    127,,PR0
         2 000053   000001 235000 3                  LDA     1
         2 000054   202054 451500                    STP1    VALUE+2,,AUTO
         2 000055   202054 236100                    LDQ     VALUE+2,,AUTO
         2 000056   202056 757100                    STAQ    VALUE+4,,AUTO
         2 000057   202056 633500                    EPPR3   VALUE+4,,AUTO
         2 000060   202062 453500                    STP3    VALUE+8,,AUTO
         2 000061   202050 236100                    LDQ     PROMPT#,,AUTO
         2 000062   000023 736000                    QLS     19
         2 000063   000002 036000 3                  ADLQ    2
         2 000064   000000 235000 3                  LDA     0
         2 000065   202060 757100                    STAQ    VALUE+6,,AUTO
         2 000066   202060 630500                    EPPR0   VALUE+6,,AUTO
         2 000067   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000070   000000 701000 xent               TSX1    CPJ$READ_S
         2 000071   000251 702000 2                  TSX2    USE_DEFAULT_PROMPT

     1323     9882    2                          VECTOR (SEG$2.SPROMPT$->PROMPT))
PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:252  
     1324     9883    2                            ALTRET (USE_DEFAULT_PROMPT);
     1325     9884    2         SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DCB# = M$IBEX1_NUM;

   9884  2 000072   000000 470400 xsym               LDP0    SEG2$
         2 000073   000163 471500                    LDP1    115,,PR0
         2 000074   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 000075   100032 740100                    STX0    26,,PR1

     1326     9885    2         SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DISP# = %SAVE#;

   9885  2 000076   000163 471500                    LDP1    115,,PR0
         2 000077   000002 236007                    LDQ     2,DL
         2 000100   100032 552104                    STBQ    26,'04'O,PR1

     1327     9886    3         CALL M$CLOSE(SEG$2.FPT_CLOSE$->FPT$CLOSE) WHENALTRETURN DO; END;

   9886  2 000101   000163 471500                    LDP1    115,,PR0
         2 000102   100000 630500                    EPPR0   0,,PR1
         2 000103   450001 713400                    CLIMB   alt,close
         2 000104   406000 401760                    pmme    nvectors=13
         2 000105   000107 702000 2                  TSX2    s:9888
         2 000106   000107 710000 2                  TRA     s:9888

     1328     9887    2       END;

     1329     9888    1     IF SEG$2.SPROMPT$->PROMPT.PPROCESS_

   9888  2 000107   000000 470400 xsym               LDP0    SEG2$
         2 000110   000177 471500                    LDP1    127,,PR0
         2 000111   100000 236100                    LDQ     0,,PR1
         2 000112   000400 316003                    CANQ    256,DU
         2 000113   000223 600000 2                  TZE     s:9911

     1330     9889    2       THEN DO;  /* We need to reevaluate this one every time */

     1331     9890    2         XUE_PPCB = CXUE_PPCB;

PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:253  
   9890  2 000114   000100 100400                    MLR     fill='000'O
         2 000115   000000 000210 1                  ADSC9   CXUE_PPCB                cn=0,n=136
         2 000116   200006 000210                    ADSC9   XUE_PPCB,,AUTO           cn=0,n=136

     1332     9891    2         XUE_PPCB.ECB.WORK$ = ADDR(WORK_AREA);

   9891  2 000117   200050 633500                    EPPR3   WORK_AREA,,AUTO
         2 000120   200015 453500                    STP3    XUE_PPCB+7,,AUTO

     1333     9892    2         XUE_PPCB.ECB.WORK_DCB# = M$IBEX1_NUM;

   9892  2 000121   000000 235000 xsym               LDA     M$IBEX1_NUM
         2 000122   200017 755100                    STA     XUE_PPCB+9,,AUTO

     1334     9893    2         XUE_PPCB.INBUF$ = ADDR (SEG$2.SPROMPT$->PROMPT.TEXT_);

   9893  2 000123   202054 451500                    STP1    VALUE+2,,AUTO
         2 000124   202054 236100                    LDQ     VALUE+2,,AUTO
         2 000125   000003 036000 3                  ADLQ    3
         2 000126   200006 756100                    STQ     XUE_PPCB,,AUTO

     1335     9894    2         XUE_PPCB.ICHARS# = SEG$2.SPROMPT$->PROMPT.LEN_;

   9894  2 000127   000177 471500                    LDP1    127,,PR0
         2 000130   100000 236100                    LDQ     0,,PR1
         2 000131   000033 772000                    QRL     27
         2 000132   200007 756100                    STQ     XUE_PPCB+1,,AUTO

     1336     9895    2         XUE_PPCB.OUTBUF$ = ADDR (SEG$2.PROMPT$->PROMPT.TEXT_);

   9895  2 000133   000200 474500                    LDP4    128,,PR0
         2 000134   202054 454500                    STP4    VALUE+2,,AUTO
         2 000135   202054 236100                    LDQ     VALUE+2,,AUTO
         2 000136   000003 036000 3                  ADLQ    3
         2 000137   200010 756100                    STQ     XUE_PPCB+2,,AUTO

     1337     9896    2         XUE_PPCB.OCHARS# = LENGTHC (SEG$2.PROMPT$->PROMPT.TEXT_);
PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:254  

   9896  2 000140   000200 471500                    LDP1    128,,PR0
         2 000141   000200 235007                    LDA     128,DL
         2 000142   200011 755100                    STA     XUE_PPCB+3,,AUTO

     1338     9897    2         SEG$2.FLAGS.USE_REMEM = '1'B;

   9897  2 000143   000020 236003                    LDQ     16,DU
         2 000144   000000 256100                    ORSQ    0,,PR0

     1339     9898    2         CALL X$PRE_PROCESS (XUE_PPCB)

   9898  2 000145   200006 633500                    EPPR3   XUE_PPCB,,AUTO
         2 000146   202054 453500                    STP3    VALUE+2,,AUTO
         2 000147   202054 630500                    EPPR0   VALUE+2,,AUTO
         2 000150   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000151   000000 701000 xent               TSX1    X$PRE_PROCESS
         2 000152   000154 702000 2                  TSX2    s:9900
         2 000153   000207 710000 2                  TRA     s:9906

     1340     9899    3           WHENALTRETURN DO;

     1341     9900    3             CPOS = XUE_PPCB.ECB.ERR_POS#;

   9900  2 000154   200024 235100                    LDA     XUE_PPCB+14,,AUTO
         2 000155   000022 771000                    ARL     18
         2 000156   202051 755100                    STA     CPOS,,AUTO

     1342     9901    3             VALUE = XUE_PPCB.ECB.ERR_DCB#;

   9901  2 000157   200024 236100                    LDQ     XUE_PPCB+14,,AUTO
         2 000160   777777 376007                    ANQ     -1,DL
         2 000161   202052 756100                    STQ     VALUE,,AUTO

     1343     9902    3             CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,XUE_PPCB.ECB.ERR,,VALUE);

   9902  2 000162   000000 236000 xsym               LDQ     SEG2$
PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:255  
         2 000163   000003 036003                    ADLQ    3,DU
         2 000164   202054 756100                    STQ     VALUE+2,,AUTO
         2 000165   202052 630500                    EPPR0   VALUE,,AUTO
         2 000166   202061 450500                    STP0    VALUE+7,,AUTO
         2 000167   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000170   202060 756100                    STQ     VALUE+6,,AUTO
         2 000171   200025 631500                    EPPR1   XUE_PPCB+15,,AUTO
         2 000172   202057 451500                    STP1    VALUE+5,,AUTO
         2 000173   202051 633500                    EPPR3   CPOS,,AUTO
         2 000174   202056 453500                    STP3    VALUE+4,,AUTO
         2 000175   202054 634500                    EPPR4   VALUE+2,,AUTO
         2 000176   202055 454500                    STP4    VALUE+3,,AUTO
         2 000177   202055 630500                    EPPR0   VALUE+3,,AUTO
         2 000200   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000201   000000 701000 xent               TSX1    CXP$POSTERR
         2 000202   000000 011000                    NOP     0

     1344     9903    3             SEG$2.FLAGS.USE_REMEM = '0'B;

   9903  2 000203   000000 470400 xsym               LDP0    SEG2$
         2 000204   000004 236000 3                  LDQ     4
         2 000205   000000 356100                    ANSQ    0,,PR0

     1345     9904    3             GOTO KILL_NON_DEFAULT_PROMPT;

   9904  2 000206   000264 710000 2                  TRA     KILL_NON_DEFAULT_PROMPT

     1346     9905    3           END;
     1347     9906    2         SEG$2.FLAGS.USE_REMEM = '0'B;

   9906  2 000207   000000 470400 xsym               LDP0    SEG2$
         2 000210   000004 236000 3                  LDQ     4
         2 000211   000000 356100                    ANSQ    0,,PR0

     1348     9907    2         SEG$2.PROMPT$->PROMPT.VFC_ = SEG$2.SPROMPT$->PROMPT.VFC_;

   9907  2 000212   000200 471500                    LDP1    128,,PR0
PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:256  
         2 000213   000177 473500                    LDP3    127,,PR0
         2 000214   300001 236100                    LDQ     1,,PR3
         2 000215   100001 552140                    STBQ    1,'40'O,PR1

     1349     9908    2         SEG$2.PROMPT$->PROMPT.LEN_ = XUE_PPCB.RCHARS#;

   9908  2 000216   000200 471500                    LDP1    128,,PR0
         2 000217   200012 236100                    LDQ     XUE_PPCB+4,,AUTO
         2 000220   000033 736000                    QLS     27
         2 000221   100000 552140                    STBQ    0,'40'O,PR1

     1350     9909    2       END;

   9909  2 000222   000227 710000 2                  TRA     s:9913

     1351     9910    2       ELSE DO;

     1352     9911    2         SEG$2.PROMPT$->PROMPT = SEG$2.SPROMPT$->PROMPT;

   9911  2 000223   000200 473500                    LDP3    128,,PR0
         2 000224   000100 100500                    MLR     fill='000'O
         2 000225   100000 000205                    ADSC9   0,,PR1                   cn=0,n=133
         2 000226   300000 000205                    ADSC9   0,,PR3                   cn=0,n=133

     1353     9912    2       END;

     1354     9913    1     IF SEG$2.PROMPT$->PROMPT.LEN_ > 94 /* max prompt length */ THEN GOTO
              9913              SET_DEFAULT_PROMPT;

   9913  2 000227   000200 471500                    LDP1    128,,PR0
         2 000230   100000 236100                    LDQ     0,,PR1
         2 000231   777000 376003                    ANQ     -512,DU
         2 000232   137000 116003                    CMPQ    48640,DU
         2 000233   000302 603000 2                  TRC     SET_DEFAULT_PROMPT

     1355     9914    1     PROMPT_ = VECTOR (SUBSTR (SEG$2.PROMPT$->PROMPT.VFC_, 0,

PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:257  
   9914  2 000234   100000 236100                    LDQ     0,,PR1
         2 000235   000033 772000                    QRL     27
         2 000236   000001 620006                    EAX0    1,QL
         2 000237   000000 635010                    EAA     0,X0
         2 000240   000002 771000                    ARL     2
         2 000241   000140 135007                    SBLA    96,DL
         2 000242   202054 451500                    STP1    VALUE+2,,AUTO
         2 000243   202054 236100                    LDQ     VALUE+2,,AUTO
         2 000244   000001 036003                    ADLQ    1,DU
         2 000245   200003 473500                    LDP3    @PROMPT_,,AUTO
         2 000246   300000 755100                    STA     0,,PR3
         2 000247   300001 756100                    STQ     1,,PR3

     1356     9915    1                               SEG$2.PROMPT$->PROMPT.LEN_+1));
     1357     9916    1     RETURN;

   9916  2 000250   000000 702200 xent               TSX2  ! X66_ARET

     1358     9917
     1359     9918    1   USE_DEFAULT_PROMPT:  /* we couldn't get the user's prompt */
     1360     9919    1     CALL CPC$WRITEMSGE (B$JIT.USRERR, M$IBEX1_NUM);

   9919  2 000251   000000 236000 3     USE_DEFAULT* LDQ     0
         2 000252   202055 756100                    STQ     VALUE+3,,AUTO
         2 000253   000000 236000 xsym               LDQ     B$JIT$
         2 000254   000144 036003                    ADLQ    100,DU
         2 000255   202054 756100                    STQ     VALUE+2,,AUTO
         2 000256   202054 630500                    EPPR0   VALUE+2,,AUTO
         2 000257   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000260   000000 701000 xent               TSX1    CPC$WRITEMSGE
         2 000261   000000 011000                    NOP     0

     1361     9920    1     B$JIT.USRERR = '0'B;

   9920  2 000262   000000 470400 xsym               LDP0    B$JIT$
         2 000263   000144 450100                    STZ     100,,PR0

PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:258  
     1362     9921    1   KILL_NON_DEFAULT_PROMPT:
     1363     9922    1     B$JIT.PROMPTS = B$JIT.PROMPTS & ~PROMPT_MASK(PROMPT#);

   9922  2 000264   202050 720100       KILL_NON_DE* LXL0    PROMPT#,,AUTO
         2 000265   000000 236010 xsym               LDQ     PROMPT_MASK,X0
         2 000266   760000 376003                    ANQ     -8192,DU
         2 000267   760000 676003                    ERQ     -8192,DU
         2 000270   202054 756100                    STQ     VALUE+2,,AUTO
         2 000271   000000 470400 xsym               LDP0    B$JIT$
         2 000272   000153 236100                    LDQ     107,,PR0
         2 000273   000026 736000                    QLS     22
         2 000274   760000 376003                    ANQ     -8192,DU
         2 000275   202054 376100                    ANQ     VALUE+2,,AUTO
         2 000276   000026 772000                    QRL     22
         2 000277   000153 676100                    ERQ     107,,PR0
         2 000300   037000 376007                    ANQ     15872,DL
         2 000301   000153 656100                    ERSQ    107,,PR0

     1364     9923    1   SET_DEFAULT_PROMPT:
     1365     9924    1     PROMPT_ = PROMPTS (PROMPT#);

   9924  2 000302   200003 470500       SET_DEFAULT* LDP0    @PROMPT_,,AUTO
         2 000303   202050 235100                    LDA     PROMPT#,,AUTO
         2 000304   000001 735000                    ALS     1
         2 000305   000000 237005 xsym               LDAQ    PROMPTS,AL
         2 000306   000000 755100                    STA     0,,PR0
         2 000307   000001 756100                    STQ     1,,PR0

     1366     9925    1     RETURN;

   9925  2 000310   000000 702200 xent               TSX2  ! X66_ARET
     1367     9926    1   END CPF$SET_PROMPT;
     1368     9927        %EOD;

PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:259  
--  Include file information  --

   XUE_SUBS_C.:E05TOU  is referenced.
   XUE_MACRO_C.:E05TOU  is referenced.
   CP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_SUBS_C.:E05TOU  is referenced.
   CP_MACROS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure CPF$SET_PROMPT.
PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:260  

 **** Variables and constants ****

  ****  Section 001 RoData CPF$SET_PROMPT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(1224)  r     1 CXUE_PPCB

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @PROMPT_                   4-0-0/w PTR         r     1 @PROMPT_TYPE
  2051-0-0/w UBIN        r     1 CPOS                    2050-0-0/w SBIN        r     1 PROMPT#
    *0-0-0/w VECT        r     1 PROMPT_                   *0-0-0/w SBIN        r     1 PROMPT_TYPE
  2052-0-0/w SBIN        r     1 VALUE                     50-0-0/w SBIN        r     1 WORK_AREA(0:1023)
     6-0-0/d STRC(1224)  r     1 XUE_PPCB

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/c STRC(45)    r     1 IBEX_NAME
     0-0-0/w UBIN        r     1 M$IBEX1_NUM
     0-0-0/d VECT        r     1 PROMPTS(0:4)
     0-0-0/d VECT        r     1 PROMPT_KEYS(0:4)
     0-0-0/w BIT (5)     r     1 PROMPT_MASK(0:4)
     0-0-0/w PTR         r     1 SEG2$                      0-0-0/w SBIN        r     1 XUE_PREEXP

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:261  
     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/d STRC(1080)  r     1 FPT$CLOSE
     0-0-0/d STRC(1197)  r     1 PROMPT                     0-0-0/w STRC(6264)  r     1 SEG$2


   Procedure CPF$SET_PROMPT requires 201 words for executable code.
   Procedure CPF$SET_PROMPT requires 1076 words of local(AUTO) storage.
PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:262  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:263  
          MINI XREF LISTING

B$JIT.CPFLAGS1.SLEAZE
       129**DCL       129--REDEF
B$JIT.ERR.MID
        36**DCL        36--REDEF
B$JIT.JRESPEAK
       197**DCL       198--REDEF
B$JIT.MODE
        30**DCL      9872>>IF
B$JIT.NEXTCC
       177**DCL      9872>>IF
B$JIT.ORIGINATOR_PORT.FROM_CR
       306**DCL       306--REDEF     307--REDEF
B$JIT.PNR
       210**DCL       210--REDEF
B$JIT.PROMPTS
       184**DCL      9869>>IF       9922<<ASSIGN   9922>>ASSIGN
B$JIT.TSLINE
       304**DCL       305--REDEF
B$JIT.USRERR
       171**DCL      9919<>CALL     9920<<ASSIGN
B$JIT$
      8203**DCL        30--IMP-PTR  9869>>IF       9872>>IF       9872>>IF       9919>>CALL     9920>>ASSIGN
      9922>>ASSIGN   9922>>ASSIGN
CAMR_REC.ACSVEH_
      7242**DCL      7243--REDEF
CAMR_REC.ALTKEYS_
      7248**DCL      7249--REDEF    7249--REDEF
CAMR_REC.HDR_
      7247**DCL      7248--REDEF
CAMR_REC.TAB_
      7246**DCL      7247--REDEF
CAMR_REC.UHL_
PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:264  
      7240**DCL      7241--REDEF    7241--REDEF
CAMR_REC.V.FSN#
      7280**DCL      7280--REDEF    7280--REDEF
CAMR_REC.WSN_
      7246**DCL      7246--REDEF
CFPT_CLOSE.SN_
      6084**DCL      6084--REDEF
CFPT_CLOSE.UTL_
      6085**DCL      6085--REDEF
CFPT_CLOSE.V.EXPIRE#
      6099**DCL      6099--REDEF
CFPT_CLOSE.V.TYPE#
      6097**DCL      6097--REDEF
CFPT_CLOSE.V.XTNSIZE#
      6094**DCL      6094--REDEF    6096--REDEF
CFPT_OPEN.ACSVEH_
      6019**DCL      6020--REDEF
CFPT_OPEN.ALTKEYS_
      6025**DCL      6026--REDEF    6026--REDEF
CFPT_OPEN.HDR_
      6024**DCL      6025--REDEF
CFPT_OPEN.TAB_
      6023**DCL      6024--REDEF
CFPT_OPEN.UHL_
      6017**DCL      6018--REDEF    6018--REDEF
CFPT_OPEN.V.FSN#
      6057**DCL      6057--REDEF    6057--REDEF
CFPT_OPEN.WSN_
      6023**DCL      6023--REDEF
CFPT_READ.STATION_
      6123**DCL      6124--REDEF
CFPT_READ.V.DVBYTE.REREAD#
      6135**DCL      6135--REDEF
CFPT_READ.V.INDX#
      6133**DCL      6133--REDEF
CFPT_READUC.STATION_
PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:265  
      6493**DCL      6494--REDEF
CFPT_READUC.V.DVBYTE.REREAD#
      6505**DCL      6505--REDEF
CFPT_READUC.V.INDX#
      6503**DCL      6503--REDEF
CFPT_TRTN.V.IR#
      6729**DCL      6730--REDEF
CFPT_WRITE.STATION_
      6161**DCL      6161--REDEF
CFPT_WRITE.V.DVBYTE.VFC#
      6168**DCL      6168--REDEF
CFPT_WRITEUC.STATION_
      6461**DCL      6461--REDEF
CFPT_WRITEUC.V.DVBYTE.VFC#
      6468**DCL      6468--REDEF
CFPT_XXX.V.STEPCC#
      7441**DCL      7441--REDEF
CGETCMD.OUT$
      7462**DCL      7468--REDEF
CPC$OPEN_S
      9863**DCL-ENT  9880--CALL
CPC$WRITEMSGE
      9860**DCL-ENT  9919--CALL
CPG$FUN$$
      9862**DCL-ENT  9375--DCLINIT
CPJ$READ_S
      9864**DCL-ENT  9881--CALL
CPOS
      9857**DCL      9900<<ASSIGN   9902<>CALL
CVLP_TRMCTL.BREAKCOUNT
      7053**DCL      7054--REDEF
CVLP_WINDOW.FWINDOW#
      7149**DCL      7149--REDEF    7150--REDEF
CXP$POSTERR
      9861**DCL-ENT  9902--CALL
CXUE_PPCB
PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:266  
      9273**DCL      9890>>ASSIGN
FPT$CLOSE
      9835**DCL      9886<>CALL
FPT$CLOSE.SN_
      9835**DCL      9835--REDEF
FPT$CLOSE.UTL_
      9836**DCL      9836--REDEF
FPT$CLOSE.V.DCB#
      9841**DCL      9884<<ASSIGN
FPT$CLOSE.V.DISP#
      9844**DCL      9885<<ASSIGN
FPT$CLOSE.V.EXPIRE#
      9850**DCL      9850--REDEF
FPT$CLOSE.V.TYPE#
      9848**DCL      9848--REDEF
FPT$CLOSE.V.XTNSIZE#
      9845**DCL      9845--REDEF    9847--REDEF
IBEX_NAME
      6911**DCL      9435--DCLINIT
KILL_NON_DEFAULT_PROMPT
      9922**LABEL    9904--GOTO
M$CLOSE
       320**DCL-ENT  9886--CALL
M$IBEX1_NUM
      8209**DCL      9880<>CALL     9881<>CALL     9884>>ASSIGN   9892>>ASSIGN   9919<>CALL
PROMPT
      9805**DCL      9881--CALL     9911<<ASSIGN   9911>>ASSIGN
PROMPT.LEN_
      9806**DCL      9894>>ASSIGN   9908<<ASSIGN   9913>>IF       9914>>ASSIGN
PROMPT.PPROCESS_
      9807**DCL      9888>>IF
PROMPT.TEXT_
      9810**DCL      9893--ASSIGN   9895--ASSIGN   9896--ASSIGN
PROMPT.TYPE_
      9808**DCL      9878>>IF
PROMPT.VFC_
PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:267  
      9809**DCL      9907<<ASSIGN   9907>>ASSIGN   9914--ASSIGN
PROMPT#
      9856**DCL      9867<<ASSIGN   9868>>ASSIGN   9869>>IF       9872>>IF       9875<<ASSIGN   9878>>IF
      9881>>CALL     9922>>ASSIGN   9924>>ASSIGN
PROMPTS
      8222**DCL      9924>>ASSIGN
PROMPT_
        18**DCL        17--PROC     9914<<ASSIGN   9924<<ASSIGN
PROMPT_KEYS
      8221**DCL      9881<>CALL
PROMPT_MASK
      8223**DCL      9869>>IF       9922>>ASSIGN
PROMPT_TYPE
        19**DCL        17--PROC     9867>>ASSIGN
SEG$2.ERRBUF
      9223**DCL      9902--CALL
SEG$2.FLAGS.USE_REMEM
      9213**DCL      9897<<ASSIGN   9903<<ASSIGN   9906<<ASSIGN
SEG$2.FPT_CLOSE$
      9236**DCL      9884>>ASSIGN   9885>>ASSIGN   9886>>CALL
SEG$2.LASTPROMPT
      9222**DCL      9868<<ASSIGN
SEG$2.PROMPT$
      9249**DCL      9895>>ASSIGN   9896>>ASSIGN   9907>>ASSIGN   9908>>ASSIGN   9911>>ASSIGN   9913>>IF
      9914>>ASSIGN   9914>>ASSIGN
SEG$2.SPROMPT$
      9248**DCL      9878>>IF       9881>>CALL     9888>>IF       9893>>ASSIGN   9894>>ASSIGN   9907>>ASSIGN
      9911>>ASSIGN
SEG2$
      8196**DCL      9198--IMP-PTR  9868>>ASSIGN   9878>>IF       9881>>CALL     9884>>ASSIGN   9885>>ASSIGN
      9886>>CALL     9888>>IF       9893>>ASSIGN   9894>>ASSIGN   9895>>ASSIGN   9896>>ASSIGN   9897>>ASSIGN
      9902>>CALL     9903>>ASSIGN   9906>>ASSIGN   9907>>ASSIGN   9907>>ASSIGN   9908>>ASSIGN   9911>>ASSIGN
      9911>>ASSIGN   9913>>IF       9914>>ASSIGN   9914>>ASSIGN
SET_DEFAULT_PROMPT
      9924**LABEL    9871--GOTO     9876--GOTO     9913--GOTO
USE_DEFAULT_PROMPT
PL6.E3A0      #002=CPF$SET_PROMPT File=CPF$IBEX3.:E05TSI                         TUE 07/29/97 11:41 Page:268  
      9919**LABEL    9880--CALLALT  9881--CALLALT
VALUE
      9858**DCL      9901<<ASSIGN   9902<>CALL
WORK_AREA
      9855**DCL      9351--DCLINIT  9891--ASSIGN
X$PRE_PROCESS
      9865**DCL-ENT  9898--CALL
XUE_PPCB
      9540**DCL      9890<<ASSIGN   9898<>CALL
XUE_PPCB.ECB.ERR
      9687**DCL      9902<>CALL
XUE_PPCB.ECB.ERR_DCB#
      9679**DCL      9901>>ASSIGN
XUE_PPCB.ECB.ERR_POS#
      9670**DCL      9900>>ASSIGN
XUE_PPCB.ECB.WORK$
      9613**DCL      9891<<ASSIGN
XUE_PPCB.ECB.WORK_DCB#
      9625**DCL      9892<<ASSIGN
XUE_PPCB.ICHARS#
      9549**DCL      9894<<ASSIGN
XUE_PPCB.INBUF$
      9544**DCL      9893<<ASSIGN
XUE_PPCB.OCHARS#
      9563**DCL      9896<<ASSIGN
XUE_PPCB.OUTBUF$
      9556**DCL      9895<<ASSIGN
XUE_PPCB.RCHARS#
      9570**DCL      9908>>ASSIGN
XUE_PREEXP
      9195**DCL      9310--DCLINIT

PL6.E3A0      #003=CPF$FIND_UCNN File=CPF$IBEX3.:E05TSI                          TUE 07/29/97 11:42 Page:269  
     1369        1        /*M* Locate the UCnn stream for the TERMINAL cmd */
     1370        2        /*T***********************************************************/
     1371        3        /*T*                                                         */
     1372        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1373        5        /*T*                                                         */
     1374        6        /*T***********************************************************/
     1375        7        /*X*  DMC,DFC   */
     1376        8        /*P*   NAME:   CPF$FIND_UCNN
     1377        9               PURPOSE: To locate a stream that has the RES=UCnn.
     1378       10               DESCRIPTION: CPF$FIND_UCNN looks though the table of DCBs
     1379       11                      to locate a DCB with RES=UCnn.  CPF$FIND_UCNN will
     1380       12                      return the DCB# of the dcb found, otherwise it will
     1381       13                      altreturn back to the calling routine.
     1382       14               REFERENCE: Programmers Reference Manual
     1383       15        */
     1384       16        /**********************************************************************/
     1385       17        CPF$FIND_UCNN:
     1386       18          PROC(STRM, DCB#) ALTRET;
     1387       19              %INCLUDE CP_6 ;
     1388      100              %INCLUDE B$ROSEG ;
     1389      163        /*
     1390      164          *** Parameters
     1391      165        */
     1392      166    1   DCL STRM CHAR(2) ;
     1393      167    1   DCL DCB# UBIN WORD ;
     1394      168        /*
     1395      169          *** Auto
     1396      170        */
     1397      171    1   DCL I UBIN WORD ;
     1398      172    1   DCL RES CHAR(4) ;
     1399      173        /*
     1400      174          *** Symrefs
     1401      175        */
     1402      176    1   DCL B$ROS$ PTR SYMREF ;
     1403      177        %F$DCB ;
     1404      234        /**/
     1405      235    1         CALL CONCAT(RES, 'UC', STRM) ;
PL6.E3A0      #003=CPF$FIND_UCNN File=CPF$IBEX3.:E05TSI                          TUE 07/29/97 11:42 Page:270  
     1406      236    2         DO I=1 TO B$ROS$->B$ROSEG.NUMDCBS ;
     1407      237    2             IF DCBADDR(I)~=ADDR(NIL)
     1408      238    2               THEN
     1409      239    2                 IF DCBADDR(I)->F$DCB.FCD# AND DCBADDR(I)->F$DCB.RES#=RES
     1410      240    2                   THEN
     1411      241    3                     DO ;
     1412      242    3                       DCB# = I ;
     1413      243    3                       RETURN ;
     1414      244    3                     END ; /* Then Do */
     1415      245    2         END ; /* Do I */
     1416      246        /**/
     1417      247    1         ALTRETURN ;
     1418      248    1   END   CPF$FIND_UCNN ;

PL6.E3A0      #003=CPF$FIND_UCNN File=CPF$IBEX3.:E05TSI                          TUE 07/29/97 11:42 Page:271  
--  Include file information  --

   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure CPF$FIND_UCNN.

   Procedure CPF$FIND_UCNN requires 37 words for executable code.
   Procedure CPF$FIND_UCNN requires 8 words of local(AUTO) storage.

    No errors detected in file CPF$IBEX3.:E05TSI    .

PL6.E3A0      #003=CPF$FIND_UCNN File=CPF$IBEX3.:E05TSI                          TUE 07/29/97 11:42 Page:272  

 Object Unit name= CPF$FIND_UCNN                              File name= CPF$IBEX3.:E05TOU
 UTS= JUL 29 '97 11:42:12.12 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS      1      1  CPF$FIND_UCNN
    2   Proc  even  none    37     45  CPF$FIND_UCNN
    3  RoData even  none     1      1  CPF$FIND_UCNN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        2  CPF$FIND_UCNN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B$ROS$                                B_VECTNIL
PL6.E3A0      #003=CPF$FIND_UCNN File=CPF$IBEX3.:E05TSI                          TUE 07/29/97 11:42 Page:273  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ROSID
PL6.E3A0      #003=CPF$FIND_UCNN File=CPF$IBEX3.:E05TSI                          TUE 07/29/97 11:42 Page:274  


     1369        1        /*M* Locate the UCnn stream for the TERMINAL cmd */
     1370        2        /*T***********************************************************/
     1371        3        /*T*                                                         */
     1372        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1373        5        /*T*                                                         */
     1374        6        /*T***********************************************************/
     1375        7        /*X*  DMC,DFC   */
     1376        8        /*P*   NAME:   CPF$FIND_UCNN
     1377        9               PURPOSE: To locate a stream that has the RES=UCnn.
     1378       10               DESCRIPTION: CPF$FIND_UCNN looks though the table of DCBs
     1379       11                      to locate a DCB with RES=UCnn.  CPF$FIND_UCNN will
     1380       12                      return the DCB# of the dcb found, otherwise it will
     1381       13                      altreturn back to the calling routine.
     1382       14               REFERENCE: Programmers Reference Manual
     1383       15        */
     1384       16        /**********************************************************************/
     1385       17        CPF$FIND_UCNN:
     1386       18          PROC(STRM, DCB#) ALTRET;

     18  2 000000   000000 700200 xent  CPF$FIND_UC* TSX0  ! X66_AUTO_2
         2 000001   000010 000002                    ZERO    8,2

     1387       19              %INCLUDE CP_6 ;
     1388      100              %INCLUDE B$ROSEG ;
     1389      163        /*
     1390      164          *** Parameters
     1391      165        */
     1392      166    1   DCL STRM CHAR(2) ;
     1393      167    1   DCL DCB# UBIN WORD ;
     1394      168        /*
     1395      169          *** Auto
     1396      170        */
     1397      171    1   DCL I UBIN WORD ;
     1398      172    1   DCL RES CHAR(4) ;
     1399      173        /*
     1400      174          *** Symrefs
PL6.E3A0      #003=CPF$FIND_UCNN File=CPF$IBEX3.:E05TSI                          TUE 07/29/97 11:42 Page:275  
     1401      175        */
     1402      176    1   DCL B$ROS$ PTR SYMREF ;
     1403      177        %F$DCB ;
     1404      234        /**/
     1405      235    1         CALL CONCAT(RES, 'UC', STRM) ;

    235  2 000002   000000 220000 1                  LDX0    0
         2 000003   200006 740100                    STX0    RES,,AUTO
         2 000004   200003 470500                    LDP0    @STRM,,AUTO
         2 000005   040100 100500                    MLR     fill='040'O
         2 000006   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         2 000007   200006 400002                    ADSC9   RES,,AUTO                cn=2,n=2

     1406      236    2         DO I=1 TO B$ROS$->B$ROSEG.NUMDCBS ;

    236  2 000010   000001 235007                    LDA     1,DL
         2 000011   200005 755100                    STA     I,,AUTO
         2 000012   000037 710000 2                  TRA     s:245+3

     1407      237    2             IF DCBADDR(I)~=ADDR(NIL)

    237  2 000013   000000 470400 3                  LDP0    0
         2 000014   000000 471500                    LDP1    0,,PR0
         2 000015   200005 720100                    LXL0    I,,AUTO
         2 000016   100000 236110                    LDQ     0,X0,PR1
         2 000017   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000020   000034 600000 2                  TZE     s:245

     1408      238    2               THEN
     1409      239    2                 IF DCBADDR(I)->F$DCB.FCD# AND DCBADDR(I)->F$DCB.RES#=RES

    239  2 000021   100000 473510                    LDP3    0,X0,PR1
         2 000022   300031 236100                    LDQ     25,,PR3
         2 000023   020000 316007                    CANQ    8192,DL
         2 000024   000034 600000 2                  TZE     s:245
         2 000025   300026 236100                    LDQ     22,,PR3
         2 000026   200006 116100                    CMPQ    RES,,AUTO
PL6.E3A0      #003=CPF$FIND_UCNN File=CPF$IBEX3.:E05TSI                          TUE 07/29/97 11:42 Page:276  
         2 000027   000034 601000 2                  TNZ     s:245

     1410      240    2                   THEN
     1411      241    3                     DO ;

     1412      242    3                       DCB# = I ;

    242  2 000030   200004 474500                    LDP4    @DCB#,,AUTO
         2 000031   200005 235100                    LDA     I,,AUTO
         2 000032   400000 755100                    STA     0,,PR4

     1413      243    3                       RETURN ;

    243  2 000033   000000 702200 xent               TSX2  ! X66_ARET

     1414      244    3                     END ; /* Then Do */
     1415      245    2         END ; /* Do I */

    245  2 000034   200005 235100                    LDA     I,,AUTO
         2 000035   000001 035007                    ADLA    1,DL
         2 000036   200005 755100                    STA     I,,AUTO
         2 000037   000000 470400 xsym               LDP0    B$ROS$
         2 000040   000002 236100                    LDQ     2,,PR0
         2 000041   000022 772000                    QRL     18
         2 000042   200005 116100                    CMPQ    I,,AUTO
         2 000043   000013 603000 2                  TRC     s:237

     1416      246        /**/
     1417      247    1         ALTRETURN ;

    247  2 000044   000000 702200 xent               TSX2  ! X66_AALT
     1418      248    1   END   CPF$FIND_UCNN ;

PL6.E3A0      #003=CPF$FIND_UCNN File=CPF$IBEX3.:E05TSI                          TUE 07/29/97 11:42 Page:277  
--  Include file information  --

   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure CPF$FIND_UCNN.
PL6.E3A0      #003=CPF$FIND_UCNN File=CPF$IBEX3.:E05TSI                          TUE 07/29/97 11:42 Page:278  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @DCB#                      3-0-0/w PTR         r     1 @STRM
    *0-0-0/w UBIN        r     1 DCB#                       5-0-0/w UBIN        r     1 I
     6-0-0/c CHAR(4)     r     1 RES                       *0-0-0/c CHAR(2)     r     1 STRM

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$ROS$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(3024)  r     1 B$ROSEG                    0-0-0/d ASTR(3528)  r     1 F$DCB


   Procedure CPF$FIND_UCNN requires 37 words for executable code.
   Procedure CPF$FIND_UCNN requires 8 words of local(AUTO) storage.

    No errors detected in file CPF$IBEX3.:E05TSI    .
PL6.E3A0      #003=CPF$FIND_UCNN File=CPF$IBEX3.:E05TSI                          TUE 07/29/97 11:42 Page:279  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=CPF$FIND_UCNN File=CPF$IBEX3.:E05TSI                          TUE 07/29/97 11:42 Page:280  
          MINI XREF LISTING

B$ROS$
       176**DCL       236>>DOINDEX
B$ROSEG.NUMDCBS
       113**DCL       236>>DOINDEX
DCB#
       167**DCL        17--PROC      242<<ASSIGN
F$DCB.ACTPOS
       210**DCL       210--REDEF
F$DCB.ARS#
       184**DCL       184--REDEF
F$DCB.ATTR
       203**DCL       204--REDEF
F$DCB.BORROW
       218**DCL       218--REDEF     218--REDEF     218--REDEF
F$DCB.DCBNAME.L
       232**DCL       232--IMP-SIZ
F$DCB.EOMCHAR#
       188**DCL       188--REDEF
F$DCB.FCD#
       197**DCL       239>>IF
F$DCB.FLDID
       213**DCL       213--REDEF
F$DCB.FORM$
       207**DCL       207--REDEF
F$DCB.FSECT
       223**DCL       223--REDEF
F$DCB.FSN#
       200**DCL       200--REDEF     200--REDEF     201--REDEF
F$DCB.HEADER$
       206**DCL       206--REDEF
F$DCB.IXTNSIZE#
       204**DCL       204--REDEF
PL6.E3A0      #003=CPF$FIND_UCNN File=CPF$IBEX3.:E05TSI                          TUE 07/29/97 11:42 Page:281  
F$DCB.LASTSTA$
       193**DCL       193--REDEF
F$DCB.LVL
       219**DCL       219--REDEF
F$DCB.NAME#.C
       194**DCL       194--REDEF
F$DCB.NOEOF
       216**DCL       216--REDEF
F$DCB.NRECS#
       205**DCL       205--REDEF
F$DCB.NRECX
       224**DCL       224--REDEF
F$DCB.OHDR
       216**DCL       216--REDEF
F$DCB.ORG#
       199**DCL       199--REDEF
F$DCB.PRECNO
       222**DCL       222--REDEF
F$DCB.RCSZ
       228**DCL       228--REDEF
F$DCB.RES#
       195**DCL       195--REDEF     239>>IF
F$DCB.SETX
       207**DCL       207--REDEF
F$DCB.TAB$
       207**DCL       207--REDEF
F$DCB.TDA
       221**DCL       222--REDEF
F$DCB.WSN#
       195**DCL       195--REDEF
I
       171**DCL       236<<DOINDEX   237--IF        239--IF        239--IF        242>>ASSIGN
RES
       172**DCL       235<<CALLBLT   239>>IF
STRM
       166**DCL        17--PROC      235>>CALLBLT
