VERSION E05

PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:1    
        1        1        /*M*  Service M$DRIBBLE pmmes and do output etc.                      */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        UMD$DRIBBLE: PROC(VPMT,LN) ALTRET;
        8        8        /*X* PLM=6,IND=3,CTI=3,DCI=3,DTI=0,MCI,MOC,DMC  */
        9        9        %INCLUDE B$ROSEG;
       10       72        %INCLUDE KI$CP6V_C;
       11      511        %INCLUDE CP_6;
       12     6070        %INCLUDE CP_6_SUBS;
       13     6610        %INCLUDE KI_MACROS_C;
       14     7218        %INCLUDE B$JIT_C;
       15     7532        %INCLUDE UD_MACRO_C;
       16     7565        %INCLUDE UM_ERRORS_C;
       17     7599        %INCLUDE F_ERRORS_C;
       18     7839        %INCLUDE F_MACROS_C;
       19     7850        %B$JIT0;
       20     7939        %U$JIT1;
       21     8013        %M$JIT2X;
       22     8016        %F$JIT3;
       23     8021        %S$JIT4X;
       24     8024        %J$JIT5X;
       25     8027        %A$JIT6X;
       26     8030        %F$DCB;
       27     8087        %FPT$DRIBBLE_V;
       28     8090        %ERRCODE (NAME=ERRWRWOKEY, COD#=%E$WRWOKEY, FCG#='0615'O, MID#='06'O, MON#='1'B);
       29     8094        %ERRCODE (NAME=ERRDRIBINTOKEYED, COD#=%E$DRIBINTOKEYED, FCG#='2515'O, MON#='1'B,
              8094            MID#='04'O);
       30     8098        %FPT_OPEN (FPTN=EXDRIB,STCLASS=CONSTANT,EXIST=OLDFILE,
       31     8099                     FUN=CREATE,REASSIGN=YES,DCB=M$LM);
       32     8208        %FPT_OPEN (FPTN=OPDRIB,STCLASS=CONSTANT,
       33     8209                    REASSIGN=YES,DCB=M$LM);
       34     8318        %FPT_CLOSE (FPTN=CLDRIB,STCLASS=CONSTANT,DISP=SAVE,DCB=M$LM);
       35     8360        %FPT_WRITE (FPTN=WRA,STCLASS=CONSTANT,DCB=M$LM,BUF=AVFC,VFC=YES);
       36     8391        %FPT_WRITE (FPTN=WRTRNS0,STCLASS=CONSTANT,DCB=M$LM,BUF=TVFC,VFC=YES);
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:2    
       37     8422        %FPT_WRITE (FPTN=WRUCREC,STCLASS=CONSTANT,DCB=M$LM);
       38     8453        %KI_VCHRPMT (NAME=VPMT,STCLASS="",SIZE=32);
       39     8461    1   DCL LN UBIN;
       40     8462        %LIST;
       41     8463        %UD$PRMPT (FPTN=PROMPT);
              8464         %LSET LISTDIR='0'B;
              8469    1   DCL 1 PROMPT(0:2) BASED ALIGNED,
              8473    1        2 TRNS0 BIT(9) UNAL,
              8474    1        2 DVBYTE BIT(9) UNAL,
              8475    1        2 LN UBIN(9) UNAL,
              8476    1        2 TXT,
              8477    1           3 VFC CHAR(1),
              8478    1           3 M CHAR(32) ;
       42     8480        %PLIST;
       43     8481    1   DCL M$LM DCB;
       44     8482    1   DCL B$M$LM$ PTR SYMREF READONLY;
       45     8483    1   DCL DCBNR SBIN;
       46     8484    1   DCL DCB$ PTR;
       47     8485    1   DCL ERR BIT(36);
       48     8486        %FPT_WRITE (FPTN=WR,STCLASS="");
       49     8517    1   DCL I UBIN;
       50     8518    1   DCL TYC BIT(36) BASED ALIGNED;
       51     8519    1   DCL DCBP$(0:0) PTR BASED;
       52     8520    1   DCL DVBYTE BIT(9) CALIGNED BASED;
       53     8521    1   DCL VFC CHAR(1) UNAL BASED;
       54     8522    1   DCL 1 DCB0 BASED,
       55     8523    1         2 * CHAR(I);
       56     8524    1   DCL 1 DRIBON,
       57     8525    1         2 TXT CHAR(14),
       58     8526    1         2 TIME CHAR(5),
       59     8527    1         2 X CHAR(1),
       60     8528    1         2 DATE CHAR(8);
       61     8529    1   DCL 1 EOMREC,
       62     8530    1         2 VFC CHAR(1),
       63     8531    1         2 EOMCHAR CHAR(1);
       64     8532    1   DCL PRINTABLE BIT(1);
       65     8533    1   DCL CRLF BIT(1);
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:3    
       66     8534    1   DCL AVFC CHAR(1) CONSTANT INIT('A');
       67     8535    1   DCL ATVFC CHAR(1) CONSTANT INIT('@');
       68     8536    1   DCL TVFC CHAR(1) CONSTANT INIT(BITASC('036'O));
       69     8537        /*    PROMPT STRINGS ARRANGED ACCORDING TO INDEX FROM FMO$GETPFB   */
       70     8538    1   DCL PRMPT(0:2) CHAR(2) CONSTANT INIT('!!','* ','? ');
       71     8539    1   DCL PRMPTVFC CHAR(3) CONSTANT INIT('@@@');
       72     8540    1   DCL PRMPTTRNS(0:2) BIT(9) CONSTANT INIT('1'B,'0'B,'0'B);
       73     8541    1   DCL DRIBDCB# SBIN CONSTANT INIT(%M$DRIBBLE#);
       74     8542    1   DCL DRIBDCB2# SBIN CONSTANT INIT(%M$DRIBBLE2#);
       75     8543    1   DCL B$ROSEG$ PTR SYMREF;
       76     8544    1   DCL B$JIT$ PTR SYMREF;
       77     8545    1   DCL B$PS0$ PTR SYMREF;
       78     8546        /**/
       79     8547    1   DCL M$MCLOSE ENTRY(1) ALTRET;
       80     8548    1   DCL M$MWRITE ENTRY(1) ALTRET;
       81     8549    1   DCL M$MOPEN ENTRY(1) ALTRET;
       82     8550    1   DCL M$MERRMSG ENTRY(1) ALTRET;
       83     8551    1   DCL FMO$GETPFB ENTRY(1);
       84     8552    1   DCL FSA$GSP ENTRY(2) ALTRET;
       85     8553    1   DCL FSA$FSP ENTRY(2) ALTRET;
       86     8554    1   DCL FMM$SCRUB1 ENTRY(1);
       87     8555    1   DCL UMT$IDT ENTRY(2) ALTRET;
       88     8556        %EJECT;
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:4    
       89     8557        /*   Handle the M$DRIBBLE PMMEs                                       */
       90     8558        /**/
       91     8559    1         B$JIT$->B$JIT.DCB$ = ADDR(NIL);
       92     8560    1         B$JIT$->B$JIT.DCBNO = 0;
       93     8561    1         CALL UMT$IDT(DRIBON.DATE,DRIBON.TIME);
       94     8562    1         DRIBON.X=' ';
       95     8563    2         IF B$PS0$->FPT$DRIBBLE_V.DRIBBLE THEN DO;
       96     8564    2            B$ROSEG$->B$ROSEG.DCBPTR$->DCBP$(DRIBDCB2#) =
       97     8565    2               B$ROSEG$->B$ROSEG.DCBPTR$->DCBP$(%M$LM#);
       98     8566    2            IF B$JIT$->B$JIT.CPFLAGS1 & %CP_DRIBBLE# THEN
       99     8567    2               GOTO STOPDRIB;            /* Perhaps he reset fid               */
      100     8568    2   STARTDRIB:
      101     8569    2            CALL CHKOPN ALTRET(ONERR);
      102     8570    2            DRIBON.TXT= 'DRIBBLE ON @  ';
      103     8571    2            WR=WRUCREC;
      104     8572    2            WR.BUF_=VECTOR(DRIBON);
      105     8573    2            WR.V_=VECTOR(WR.V);
      106     8574    2            IF NOT DCBADDR(%M$DRIBBLE#)->F$DCB.DDEV.UCOUT# THEN
      107     8575    3               CALL M$MWRITE(WR) WHENALTRETURN DO;
      108     8576    3                  IF B$JIT$->B$JIT.ERR=ERRWRWOKEY THEN
      109     8577    3                     B$JIT$->B$JIT.ERR=ERRDRIBINTOKEYED;
      110     8578    3                  GOTO CLOSEIT;
      111     8579        /*E*     ERROR:    UMD-E$DRIBINTOKEYED-2
      112     8580                 MESSAGE:  DRIBBLE INTO an existing keyed file is not allowed.
      113     8581                 MESSAGE1: The command DRIBBLE INTO file is not allowed if
      114     8582                           the file exists and is keyed.
      115     8583        */
      116     8584    3                  END;
      117     8585    2            B$JIT$->B$JIT.CPFLAGS1=B$JIT$->B$JIT.CPFLAGS1 | %CP_DRIBBLE#;
      118     8586    2            END;
      119     8587    2         ELSE DO;
      120     8588    2            IF NOT B$JIT$->B$JIT.CPFLAGS1 & %CP_DRIBBLE# THEN
      121     8589    2               RETURN;
      122     8590    2   STOPDRIB: CALL CHKOPN ALTRET(OFFERR);
      123     8591    2            DRIBON.TXT= 'DRIBBLE OFF @  ';
      124     8592    2            WR=WRUCREC;
      125     8593    2            WR.BUF_=VECTOR(DRIBON);
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:5    
      126     8594    2            WR.V_=VECTOR(WR.V);
      127     8595    2            IF NOT DCBADDR(%M$DRIBBLE#)->F$DCB.DDEV.UCOUT# THEN
      128     8596    2               CALL M$MWRITE(WR) ALTRET(DRIBOFF);
      129     8597    3            IF B$PS0$->FPT$DRIBBLE_V.DRIBBLE THEN DO;
      130     8598    3               B$JIT$->B$JIT.CPFLAGS1=B$JIT$->B$JIT.CPFLAGS1 & ~%CP_DRIBBLE#;
      131     8599    3               ERR=B$JIT$->B$JIT.ERR;
      132     8600    3               CALL M$MCLOSE (CLDRIB) ALTRET(CLOSE1);
      133     8601    3               GOTO STARTDRIB;
      134     8602    3               END;
      135     8603    2   DRIBOFF: B$JIT$->B$JIT.CPFLAGS1=B$JIT$->B$JIT.CPFLAGS1 & ~%CP_DRIBBLE#;
      136     8604    2   CLOSEIT: ;
      137     8605    2            ERR=B$JIT$->B$JIT.ERR;
      138     8606    2            CALL M$MCLOSE (CLDRIB) ALTRET(CLOSE1);
      139     8607    2   CLOSE1:  B$JIT$->B$JIT.ERR=ERR;
      140     8608    2   RELSPACE:
      141     8609    2            DCB$ = DCBADDR(%M$DRIBBLE#);
      142     8610    2            I=SIZEW(PROMPT)+3+POFFW(ADDR(DCB$->F$DCB.DCBNAME),DCB$);
      143     8611    2            CALL FSA$FSP(I,DCB$);
      144     8612    2            B$ROSEG$->B$ROSEG.DCBPTR$->DCBP$(DRIBDCB#)=ADDR(NIL);
      145     8613    2            END;
      146     8614    1   XIT:  B$ROSEG$->B$ROSEG.DCBPTR$->DCBP$(%M$LM#)=B$M$LM$;
      147     8615    1         RETURN;
      148     8616    1   ONERR: IF DCBADDR(%M$DRIBBLE#) = ADDR(NIL) THEN
      149     8617    1            GOTO XIT;
      150     8618    1         ELSE
      151     8619    1            GOTO RELSPACE;
      152     8620    1   OFFERR: IF DCBADDR(%M$DRIBBLE#) ~= ADDR(NIL) THEN
      153     8621    1            GOTO DRIBOFF;
      154     8622    1         ELSE
      155     8623    1            B$JIT$->B$JIT.CPFLAGS1 = B$JIT$->B$JIT.CPFLAGS1 & ~%CP_DRIBBLE#;
      156     8624    1         GOTO XIT;
      157     8625        %EJECT;
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:6    
      158     8626    1   UMD$DPMT: ENTRY ALTRET;
      159     8627
      160     8628        /*    Dribble the prompt string.
      161     8629              Write the prompt string with its DVBYTE and VFC = YES.
      162     8630                                                                           */
      163     8631
      164     8632    1         CALL CHKOPN ALTRET(DRIBERR);
      165     8633    2         IF NOT DCBADDR(%M$DRIBBLE#)->F$DCB.DDEV.UCOUT# THEN DO;
      166     8634    2            CALL FMO$GETPFB(I);
      167     8635    2            IF I > 3 THEN GOTO DRIBXIT;
      168     8636    2            IF PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)->
      169     8637    2               PROMPT.TRNS0(I-1) THEN
      170     8638    2               CALL M$MWRITE (WRTRNS0) ALTRET(DRIBERR);
      171     8639
      172     8640    2            WR=WRUCREC;
      173     8641    2            WR.V_=VECTOR(WR.V);
      174     8642    2            WR.V.DVBYTE=PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)->PROMPT.
              8642                     DVBYTE(I-1);
      175     8643    2            WR.V.DVBYTE.VFC#='1'B;
      176     8644    2            WR.V.DVBYTE.BP#='1'B;
      177     8645    2            WR.BUF_.BOUND=PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)->PROMPT.
              8645                     LN(I-1);
      178     8646    2            WR.BUF_.BUF$=ADDR(PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)->
              8646                     PROMPT.TXT(I-1));
      179     8647    2            CALL M$MWRITE (WR) ALTRET(DRIBERR);
      180     8648    2            END;
      181     8649    1         GOTO DRIBXIT;
      182     8650
      183     8651
      184     8652
      185     8653
      186     8654    1   UMD$DIN: ENTRY(VPMT) ALTRET;
      187     8655
      188     8656        /*
      189     8657                    Dribble the input string.
      190     8658                    If ARS ~= 0,
      191     8659                    If EOMCHAR was CR, LF or <F>
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:7    
      192     8660                       If its a device (LP), write the record with default VFC
      193     8661                       in the DCB set to 'A'.
      194     8662                       If its a file, write a zero length record with VFC = 'A'
      195     8663                       and concatenate the input record.
      196     8664                    If EOMCHAR was not CR, LF or <F>
      197     8665                       If its a device, write the record with default VFC of
      198     8666                       '@'.
      199     8667                       If its a file, write the zero length record with VFC of
      200     8668                       '@' and concatenate the input record.
      201     8669                       If EOMCHAR was printable, write a record with a VFC of
      202     8670                       '@' and containing EOMCHAR for both device and file.
      203     8671
      204     8672                    If ARS = 0,
      205     8673                    If EOMCHAR was CR, LF or <F>, write a zero length record
      206     8674                    with VFC = 'A'.
      207     8675                    If EOMCHAR was not CR, LF or <F> and it was printable,
      208     8676                    write a record with a VFC of '@' and containing EOMCHAR.
      209     8677                    Otherwise, exit. There is no need to write EOMCHAR.
      210     8678                                                                            */
      211     8679
      212     8680
      213     8681    1         CALL CHKOPN ALTRET(DRIBERR);
      214     8682    2         IF NOT DCBADDR(%M$DRIBBLE#)->F$DCB.DDEV.UCOUT# THEN DO;
      215     8683    2            WR=WRUCREC;
      216     8684    2            WR.V_=VECTOR(WR.V);
      217     8685    2            PRINTABLE = '0'B;
      218     8686    2            IF DCB$->F$DCB.EOMCHAR# = BITASC('015'O) OR
      219     8687    2               DCB$->F$DCB.EOMCHAR# = BITASC('012'O) OR
      220     8688    3               ADDR(VPMT)->TYC & %TYC_EOF THEN DO;
      221     8689    4               IF DCB$->F$DCB.ARS# = 0 THEN DO;
      222     8690    4                  CALL M$MWRITE (WRA) ALTRET(DRIBERR);
      223     8691    4                  GOTO DRIBXIT;
      224     8692    4                  END;
      225     8693    3               CRLF = '1'B;
      226     8694    3               END;
      227     8695    3            ELSE DO;
      228     8696    3               CRLF = '0'B;
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:8    
      229     8697    3               IF (DCB$->F$DCB.EOMCHAR# > BITASC('040'O) AND DCB$->F$DCB.EOMCHAR# <=
              8697                        BITASC('176'O)) OR
      230     8698    4                  (DCB$->F$DCB.EOMCHAR#> BITASC('240'O) AND DCB$->F$DCB.EOMCHAR# <=
              8698                           BITASC('376'O)) THEN DO;
      231     8699    4                  PRINTABLE = '1'B;
      232     8700    4                  IF DCB$->F$DCB.ARS# = 0 THEN
      233     8701    4                     GOTO DIN1;
      234     8702    4                  END;
      235     8703    4               ELSE DO;
      236     8704    4                  IF DCB$->F$DCB.ARS# = 0 THEN
      237     8705    4                     GOTO DRIBXIT;
      238     8706    4                  PRINTABLE = '0'B;
      239     8707    4                  END;
      240     8708    3               END;
      241     8709    2            IF DCBADDR(%M$DRIBBLE#)->F$DCB.DDEV THEN
      242     8710    2               DCBADDR(%M$DRIBBLE#)->F$DCB.DVFC#='@';
      243     8711    3            ELSE DO;
      244     8712    3               WR.V.DVBYTE.CONT#='1'B;
      245     8713    3               WR.V.DVBYTE.VFC#='1'B;
      246     8714    3               WR.BUF_=VECTOR(ATVFC);
      247     8715    3               CALL M$MWRITE (WR) ALTRET(DRIBERR);
      248     8716    3               WR.V.DVBYTE.VFC#='0'B;
      249     8717    3               WR.V.DVBYTE.CONT# = PRINTABLE;
      250     8718    3               END;
      251     8719
      252     8720    2            WR.BUF_.BUF$=DCB$->F$DCB.UB$;
      253     8721    2            WR.BUF_.BOUND=DCB$->F$DCB.ARS#-1;
      254     8722    2            CALL M$MWRITE (WR) ALTRET(DRIBERR);
      255     8723
      256     8724    3            IF PRINTABLE THEN DO;
      257     8725    3   DIN1:       IF DCBADDR(%M$DRIBBLE#)->F$DCB.DDEV THEN
      258     8726    3                  DCBADDR(%M$DRIBBLE#)->F$DCB.DVFC#='@';
      259     8727    3               WR.V.DVBYTE.CONT# = '0'B;
      260     8728    3               WR.V.DVBYTE.VFC#='0'B;
      261     8729    3               WR.BUF_=VECTOR(DCB$->F$DCB.EOMCHAR#);
      262     8730    3               CALL M$MWRITE(WR) ALTRET(DRIBERR);
      263     8731    3               END;
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:9    
      264     8732    3            ELSE DO;
      265     8733    4               IF CRLF THEN DO;
      266     8734    4                  WR.BUF_=VECTOR(AVFC);
      267     8735    4                  WR.V.DVBYTE.VFC#='1'B;
      268     8736    4                  CALL M$WRITE (WR) ALTRET(DRIBERR);
      269     8737    4                  END;
      270     8738    3               END;
      271     8739    2            END;
      272     8740    1   DRIBXIT:;
      273     8741    1         B$ROSEG$->B$ROSEG.DCBPTR$->DCBP$(%M$LM#)=B$M$LM$;
      274     8742    1         B$JIT$->B$JIT.DCB$=DCB$;
      275     8743    1         B$JIT$->B$JIT.DCBNO=DCBNR;
      276     8744    1         B$JIT$->B$JIT.ERR=ERR;
      277     8745    1         RETURN;
      278     8746    1   UMD$DOU: ENTRY(VPMT,LN)   ALTRET;
      279     8747    1         CALL CHKOPN ALTRET(DRIBERR);
      280     8748    2         IF NOT DCBADDR(%M$DRIBBLE#)->F$DCB.DDEV.UCOUT# THEN DO;
      281     8749    2            WR=WRUCREC;
      282     8750        /* Output to the terminal always has a VFC so first write VFC character
      283     8751             and then concatenate the users output.                           */
      284     8752    2            WR.V_=VECTOR(WR.V);
      285     8753    2            WR.V.DVBYTE=ADDR(VPMT)->DVBYTE;
      286     8754    2            WR.V.DVBYTE.VFC#='1'B;
      287     8755    2            IF DCB$->F$DCB.UBYTES ~= 0 THEN
      288     8756    3               IF DCBADDR(%M$DRIBBLE#)->F$DCB.DDEV THEN DO;
      289     8757    3                  DCBADDR(%M$DRIBBLE#)->F$DCB.DVFC#=ADDR(LN)->VFC;
      290     8758    3                  WR.V.DVBYTE.VFC# = '0'B;
      291     8759    3                  GOTO DOU1;
      292     8760    3                  END;
      293     8761    2               ELSE
      294     8762    2                  WR.V.DVBYTE.CONT#='1'B;
      295     8763    2            ELSE
      296     8764    2               WR.V.DVBYTE.CONT#='0'B;
      297     8765    2            WR.BUF_=VECTOR(ADDR(LN)->VFC);
      298     8766    2            CALL M$MWRITE (WR) ALTRET(DRIBERR);
      299     8767    3            IF DCB$->F$DCB.UBYTES ~= 0 THEN DO;
      300     8768    3   DOU1:       WR.V.DVBYTE.CONT#='0'B;
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:10   
      301     8769    3               WR.V.DVBYTE.VFC#='0'B;
      302     8770    3               WR.BUF_.BUF$=DCB$->F$DCB.UB$;
      303     8771    3               IF DCB$->F$DCB.UBYTES > 2048 THEN
      304     8772    3                  WR.BUF_.BOUND=2047;
      305     8773    3               ELSE
      306     8774    3                  WR.BUF_.BOUND=DCB$->F$DCB.UBYTES-1;
      307     8775    3               CALL M$MWRITE (WR) ALTRET(DRIBERR);
      308     8776    3               END;
      309     8777    2            END;
      310     8778    1         GOTO DRIBXIT;
      311     8779        %EJECT;
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:11   
      312     8780    1   UMD$QDRIB: ENTRY ALTRET;
      313     8781        /*  Called from FMQ$RELSTARF if dribbling to * file when they are released */
      314     8782        /**/
      315     8783    1         B$JIT$->B$JIT.CPFLAGS1=B$JIT$->B$JIT.CPFLAGS1 & ~%CP_DRIBBLE#;
      316     8784        /**/
      317     8785        /**/
      318     8786    1   UMD$CLSDRIB: ENTRY ALTRET;
      319     8787        /*   Called at rundown to close M$DRIBBLE and release its space.  */
      320     8788    2   CLSDRIB: IF DCBADDR(%M$DRIBBLE#) ~= ADDR(NIL) THEN DO;
      321     8789    2            B$ROSEG$->B$ROSEG.DCBPTR$->DCBP$(%M$LM#)=DCBADDR(%M$DRIBBLE#);
      322     8790    2            IF DCBADDR(%M$DRIBBLE#)->F$DCB.FCD# THEN
      323     8791    2               GOTO CLOSEIT;
      324     8792    2            ELSE
      325     8793    2               GOTO RELSPACE;
      326     8794    2            END;
      327     8795    1         RETURN;
      328     8796        %EJECT;
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:12   
      329     8797        /*   Handle errors while dribbling inputs and outputs; not ON/OFFs. */
      330     8798        /*   Exits through DRIBXIT to get JIT back how it was at entry.     */
      331     8799        /*   Ignores the error that occured while dribbling because M$ERRMSG */
      332     8800        /*   uses to much AUTO to do whats right.                            */
      333     8801    1   DRIBERR:
      334     8802    1         B$JIT$->B$JIT.CPFLAGS1=B$JIT$->B$JIT.CPFLAGS1 & ~%CP_DRIBBLE#;
      335     8803    2         IF DCBADDR(%M$DRIBBLE#) ~= ADDR(NIL) THEN DO;
      336     8804    2            CALL M$MCLOSE (CLDRIB) ALTRET(DRIBER1);
      337     8805    2   DRIBER1: I=SIZEW(PROMPT)+3+POFFW(ADDR(DCB$->F$DCB.DCBNAME),DCB$);
      338     8806    2            CALL FSA$FSP(I,DCBADDR(%M$DRIBBLE#));
      339     8807    2            B$ROSEG$->B$ROSEG.DCBPTR$->DCBP$(DRIBDCB#)=ADDR(NIL);
      340     8808    2            END;
      341     8809    1         GOTO DRIBXIT;
      342     8810        %EJECT;
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:13   
      343     8811    1   CHKOPN: PROC ALTRET;
      344     8812    2         DCB$=B$JIT$->B$JIT.DCB$;
      345     8813    2         DCBNR=B$JIT$->B$JIT.DCBNO;
      346     8814    2         ERR=B$JIT$->B$JIT.ERR;
      347     8815    2         B$ROSEG$->B$ROSEG.DCBPTR$->DCBP$(%M$LM#)=DCBADDR(%M$DRIBBLE#);
      348     8816    2         IF DCBADDR(%M$DRIBBLE#) ~= ADDR(NIL) THEN
      349     8817    2            IF DCBADDR(%M$DRIBBLE#)->F$DCB.FCD# THEN
      350     8818    2               RETURN;
      351     8819    2            ELSE;
      352     8820    3         ELSE DO;
      353     8821    3            I=SIZEW(PROMPT)+3+POFFW(ADDR(DCB$->F$DCB.DCBNAME),DCB$);
      354     8822    3            CALL FSA$GSP(I,B$ROSEG$->B$ROSEG.DCBPTR$->DCBP$(DRIBDCB#)) ALTRET(OPNERR);
      355     8823    3            I=I*4;
      356     8824    3            DCBADDR(%M$DRIBBLE#)->DCB0='0'B;
      357     8825    3            DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME.L=4;
      358     8826    3            DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME.N='M$DR';
      359     8827    3            B$JIT$->B$JIT.DCB$=DCBADDR(%M$DRIBBLE#);
      360     8828    3            CALL FMM$SCRUB1(DCBADDR(%M$DRIBBLE#));
      361     8829    3            B$ROSEG$->B$ROSEG.DCBPTR$->DCBP$(%M$LM#)=DCBADDR(%M$DRIBBLE#);
      362     8830    4            DO I = 0 TO 2;
      363     8831    4               PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)->PROMPT(I)='0'B;
      364     8832    4               PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)->PROMPT.LN(I)=1;
      365     8833    4               PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)->PROMPT.TXT.VFC(I)=
              8833                        SUBSTR(PRMPTVFC,I,1);
      366     8834    4               PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)->PROMPT.TRNS0(I)=
              8834                        PRMPTTRNS(I);
      367     8835    4               PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)->PROMPT.TXT.M(I)=
              8835                        PRMPT(I);
      368     8836    4               END;
      369     8837    3            IF B$JIT$->B$JIT.CPFLAGS1 & %CP_YC# THEN
      370     8838    3               PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)->PROMPT.LN(0)=2;
      371     8839    3            END;
      372     8840    2         IF B$JIT$->B$JIT.CPFLAGS1 & %CP_DRIBBLE# THEN
      373     8841    2            CALL M$MOPEN (EXDRIB) ALTRET(OPNERR);
      374     8842    2         ELSE
      375     8843    2            CALL M$MOPEN (OPDRIB) ALTRET(OPNERR);
      376     8844    2         RETURN;
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:14   
      377     8845    2   OPNERR: ALTRETURN;
      378     8846    2   END CHKOPN;
      379     8847        %EJECT;
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:15   
      380     8848    1   UMD$DBPRMT: ENTRY(VPMT,LN) ALTRET;
      381     8849        /*   Save prompt string and VFC if dribbling                          */
      382     8850        /**/
      383     8851    1         CALL CHKOPN ALTRET(DRIBERR);
      384     8852    1         I = VPMT.PFB;
      385     8853    1         IF I > 0 THEN I = I - 1;
      386     8854    1         IF I > 2 THEN GOTO DRIBXIT;
      387     8855    1         PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)
      388     8856    1            ->PROMPT.DVBYTE(I)=VPMT.DVBYTE;
      389     8857    1         IF ASCBIN(VPMT.VFC) >= BITBIN('160'O) THEN
      390     8858    2         DO;
      391     8859    2            PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)
      392     8860    2               ->PROMPT.TRNS0(I) = '1'B;
      393     8861    2            PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)
      394     8862    2               ->PROMPT.TXT.VFC(I) = BITASC((ASCBIT(VPMT.VFC) & '017'O)
      395     8863    2               | '140'O);
      396     8864    2            END;
      397     8865    1         ELSE
      398     8866    2         DO;
      399     8867    2            PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)
      400     8868    2               ->PROMPT.TRNS0(I) = '0'B;
      401     8869    2            PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)
      402     8870    2               ->PROMPT.TXT.VFC(I) = VPMT.VFC;
      403     8871    2            END;
      404     8872    1         PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)
      405     8873    1            ->PROMPT.TXT.M(I)=VPMT.M;
      406     8874    1         PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)
      407     8875    1            ->PROMPT.LN(I)=LN;
      408     8876    1         GOTO DRIBXIT;
      409     8877        %EJECT;
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:16   
      410     8878    1   UMD$SVPRMPT: ENTRY (VPMT) ALTRET;
      411     8879        /*  Return current prompt info to caller                              */
      412     8880
      413     8881    1         CALL CHKOPN ALTRET(DRIBERR);
      414     8882    1         ADDR(VPMT)->PROMPT = PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME)
      415     8883    1            ,3)->PROMPT;
      416     8884    1         GOTO DRIBXIT;
      417     8885
      418     8886    1   UMD$RSTRPRMPT: ENTRY (VPMT) ALTRET;
      419     8887        /* Get prompt info from caller                                        */
      420     8888
      421     8889    1         CALL CHKOPN ALTRET(DRIBERR);
      422     8890    1         PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)->PROMPT =
      423     8891    1            ADDR(VPMT)->PROMPT;
      424     8892    1         GOTO DRIBXIT;
      425     8893    1   UMD$CHKOPN: ENTRY ALTRET;
      426     8894        /*   Make sure the Dribble DCB is there and opened.                   */
      427     8895
      428     8896    1         IF B$JIT$->B$JIT.CPFLAGS1 & %CP_DRIBBLE# THEN
      429     8897    2         DO;
      430     8898    2            CALL CHKOPN;
      431     8899    2            GOTO DRIBXIT;
      432     8900    2            END;
      433     8901    1         RETURN;
      434     8902    1   END;

PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:17   
--  Include file information  --

   F_MACROS_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   UM_ERRORS_C.:E05TOU  is referenced.
   UD_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   KI$CP6V_C.:E05TOU  is referenced.
   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure UMD$DRIBBLE.

   Procedure UMD$DRIBBLE requires 819 words for executable code.
   Procedure UMD$DRIBBLE requires 38 words of local(AUTO) storage.

    No errors detected in file UMD$DRIBBLE.:E05TSI    .

PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:18   

 Object Unit name= UMD$DRIBBLE                                File name= UMD$DRIBBLE.:E05TOU
 UTS= JUL 30 '97 06:58:28.48 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    205    315  UMD$DRIBBLE
    2   DCB   even  none     0      0  M$LM
    3   Proc  even  none   819   1463  UMD$DRIBBLE
    4  RoData even  none    21     25  UMD$DRIBBLE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        2  UMD$DRIBBLE
     3    272          yes     yes      Std        0  UMD$DPMT
     3    401          yes     yes      Std        1  UMD$DIN
     3    637          yes     yes      Std        2  UMD$DOU
     3    761          yes     yes      Std        0  UMD$QDRIB
     3    771          yes     yes      Std        0  UMD$CLSDRIB
     3   1301          yes     yes      Std        2  UMD$DBPRMT
     3   1421          yes     yes      Std        1  UMD$SVPRMPT
     3   1435          yes     yes      Std        1  UMD$RSTRPRMPT
     3   1451          yes     yes      Std        0  UMD$CHKOPN
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:19   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 UMT$IDT
 yes     yes           Std       1 M$MWRITE
 yes     yes           Std       1 M$MCLOSE
 yes     yes           Std       2 FSA$FSP
         yes           Std       1 FMO$GETPFB
 yes     yes           Std       2 FSA$GSP
         yes           Std       1 FMM$SCRUB1
 yes     yes           Std       1 M$MOPEN
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$LM                             r    B$M$LM$
     B$ROSEG$                              B$JIT$                                B$PS0$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:20   


        1        1        /*M*  Service M$DRIBBLE pmmes and do output etc.                      */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        UMD$DRIBBLE: PROC(VPMT,LN) ALTRET;

      7  3 000000   000000 700200 xent  UMD$DRIBBLE  TSX0  ! X66_AUTO_2
         3 000001   000046 000002                    ZERO    38,2

        8        8        /*X* PLM=6,IND=3,CTI=3,DCI=3,DTI=0,MCI,MOC,DMC  */
        9        9        %INCLUDE B$ROSEG;
       10       72        %INCLUDE KI$CP6V_C;
       11      511        %INCLUDE CP_6;
       12     6070        %INCLUDE CP_6_SUBS;
       13     6610        %INCLUDE KI_MACROS_C;
       14     7218        %INCLUDE B$JIT_C;
       15     7532        %INCLUDE UD_MACRO_C;
       16     7565        %INCLUDE UM_ERRORS_C;
       17     7599        %INCLUDE F_ERRORS_C;
       18     7839        %INCLUDE F_MACROS_C;
       19     7850        %B$JIT0;
       20     7939        %U$JIT1;
       21     8013        %M$JIT2X;
       22     8016        %F$JIT3;
       23     8021        %S$JIT4X;
       24     8024        %J$JIT5X;
       25     8027        %A$JIT6X;
       26     8030        %F$DCB;
       27     8087        %FPT$DRIBBLE_V;
       28     8090        %ERRCODE (NAME=ERRWRWOKEY, COD#=%E$WRWOKEY, FCG#='0615'O, MID#='06'O, MON#='1'B);
       29     8094        %ERRCODE (NAME=ERRDRIBINTOKEYED, COD#=%E$DRIBINTOKEYED, FCG#='2515'O, MON#='1'B,
              8094            MID#='04'O);
       30     8098        %FPT_OPEN (FPTN=EXDRIB,STCLASS=CONSTANT,EXIST=OLDFILE,
       31     8099                     FUN=CREATE,REASSIGN=YES,DCB=M$LM);
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:21   
       32     8208        %FPT_OPEN (FPTN=OPDRIB,STCLASS=CONSTANT,
       33     8209                    REASSIGN=YES,DCB=M$LM);
       34     8318        %FPT_CLOSE (FPTN=CLDRIB,STCLASS=CONSTANT,DISP=SAVE,DCB=M$LM);
       35     8360        %FPT_WRITE (FPTN=WRA,STCLASS=CONSTANT,DCB=M$LM,BUF=AVFC,VFC=YES);
       36     8391        %FPT_WRITE (FPTN=WRTRNS0,STCLASS=CONSTANT,DCB=M$LM,BUF=TVFC,VFC=YES);
       37     8422        %FPT_WRITE (FPTN=WRUCREC,STCLASS=CONSTANT,DCB=M$LM);
       38     8453        %KI_VCHRPMT (NAME=VPMT,STCLASS="",SIZE=32);
       39     8461    1   DCL LN UBIN;
       40     8462        %LIST;
       41     8463        %UD$PRMPT (FPTN=PROMPT);
              8464         %LSET LISTDIR='0'B;
              8469    1   DCL 1 PROMPT(0:2) BASED ALIGNED,
              8473    1        2 TRNS0 BIT(9) UNAL,
              8474    1        2 DVBYTE BIT(9) UNAL,
              8475    1        2 LN UBIN(9) UNAL,
              8476    1        2 TXT,
              8477    1           3 VFC CHAR(1),
              8478    1           3 M CHAR(32) ;
       42     8480        %PLIST;
       43     8481    1   DCL M$LM DCB;
       44     8482    1   DCL B$M$LM$ PTR SYMREF READONLY;
       45     8483    1   DCL DCBNR SBIN;
       46     8484    1   DCL DCB$ PTR;
       47     8485    1   DCL ERR BIT(36);
       48     8486        %FPT_WRITE (FPTN=WR,STCLASS="");
       49     8517    1   DCL I UBIN;
       50     8518    1   DCL TYC BIT(36) BASED ALIGNED;
       51     8519    1   DCL DCBP$(0:0) PTR BASED;
       52     8520    1   DCL DVBYTE BIT(9) CALIGNED BASED;
       53     8521    1   DCL VFC CHAR(1) UNAL BASED;
       54     8522    1   DCL 1 DCB0 BASED,
       55     8523    1         2 * CHAR(I);
       56     8524    1   DCL 1 DRIBON,
       57     8525    1         2 TXT CHAR(14),
       58     8526    1         2 TIME CHAR(5),
       59     8527    1         2 X CHAR(1),
       60     8528    1         2 DATE CHAR(8);
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:22   
       61     8529    1   DCL 1 EOMREC,
       62     8530    1         2 VFC CHAR(1),
       63     8531    1         2 EOMCHAR CHAR(1);
       64     8532    1   DCL PRINTABLE BIT(1);
       65     8533    1   DCL CRLF BIT(1);
       66     8534    1   DCL AVFC CHAR(1) CONSTANT INIT('A');
       67     8535    1   DCL ATVFC CHAR(1) CONSTANT INIT('@');
       68     8536    1   DCL TVFC CHAR(1) CONSTANT INIT(BITASC('036'O));
       69     8537        /*    PROMPT STRINGS ARRANGED ACCORDING TO INDEX FROM FMO$GETPFB   */
       70     8538    1   DCL PRMPT(0:2) CHAR(2) CONSTANT INIT('!!','* ','? ');
       71     8539    1   DCL PRMPTVFC CHAR(3) CONSTANT INIT('@@@');
       72     8540    1   DCL PRMPTTRNS(0:2) BIT(9) CONSTANT INIT('1'B,'0'B,'0'B);
       73     8541    1   DCL DRIBDCB# SBIN CONSTANT INIT(%M$DRIBBLE#);
       74     8542    1   DCL DRIBDCB2# SBIN CONSTANT INIT(%M$DRIBBLE2#);
       75     8543    1   DCL B$ROSEG$ PTR SYMREF;
       76     8544    1   DCL B$JIT$ PTR SYMREF;
       77     8545    1   DCL B$PS0$ PTR SYMREF;
       78     8546        /**/
       79     8547    1   DCL M$MCLOSE ENTRY(1) ALTRET;
       80     8548    1   DCL M$MWRITE ENTRY(1) ALTRET;
       81     8549    1   DCL M$MOPEN ENTRY(1) ALTRET;
       82     8550    1   DCL M$MERRMSG ENTRY(1) ALTRET;
       83     8551    1   DCL FMO$GETPFB ENTRY(1);
       84     8552    1   DCL FSA$GSP ENTRY(2) ALTRET;
       85     8553    1   DCL FSA$FSP ENTRY(2) ALTRET;
       86     8554    1   DCL FMM$SCRUB1 ENTRY(1);
       87     8555    1   DCL UMT$IDT ENTRY(2) ALTRET;
       88     8556        %EJECT;
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:23   
       89     8557        /*   Handle the M$DRIBBLE PMMEs                                       */
       90     8558        /**/
       91     8559    1         B$JIT$->B$JIT.DCB$ = ADDR(NIL);

   8559  3 000002   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000003   000000 470400 xsym               LDP0    B$JIT$
         3 000004   000232 756100                    STQ     154,,PR0

       92     8560    1         B$JIT$->B$JIT.DCBNO = 0;

   8560  3 000005   000000 236003                    LDQ     0,DU
         3 000006   000022 552104                    STBQ    18,'04'O,PR0

       93     8561    1         CALL UMT$IDT(DRIBON.DATE,DRIBON.TIME);

   8561  3 000007   200044 452500                    STP2    CRLF+6,,AUTO
         3 000010   200044 236100                    LDQ     CRLF+6,,AUTO
         3 000011   000000 036000 4                  ADLQ    0
         3 000012   200043 756100                    STQ     CRLF+5,,AUTO
         3 000013   200032 631500                    EPPR1   DRIBON+5,,AUTO
         3 000014   200042 451500                    STP1    CRLF+4,,AUTO
         3 000015   200042 630500                    EPPR0   CRLF+4,,AUTO
         3 000016   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000017   000000 701000 xent               TSX1    UMT$IDT
         3 000020   000000 011000                    NOP     0

       94     8562    1         DRIBON.X=' ';

   8562  3 000021   000040 236007                    LDQ     32,DL
         3 000022   200031 552104                    STBQ    DRIBON+4,'04'O,AUTO

       95     8563    2         IF B$PS0$->FPT$DRIBBLE_V.DRIBBLE THEN DO;

   8563  3 000023   000000 470400 xsym               LDP0    B$PS0$
         3 000024   000000 234100                    SZN     0,,PR0
         3 000025   000112 605000 3                  TPL     s:8588

PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:24   
       96     8564    2            B$ROSEG$->B$ROSEG.DCBPTR$->DCBP$(DRIBDCB2#) =

   8564  3 000026   000000 471400 xsym               LDP1    B$ROSEG$
         3 000027   100000 473500                    LDP3    0,,PR1
         3 000030   300002 236100                    LDQ     2,,PR3
         3 000031   000300 720000 1                  LXL0    DRIBDCB2#
         3 000032   300000 756110                    STQ     0,X0,PR3

       97     8565    2               B$ROSEG$->B$ROSEG.DCBPTR$->DCBP$(%M$LM#);
       98     8566    2            IF B$JIT$->B$JIT.CPFLAGS1 & %CP_DRIBBLE# THEN

   8566  3 000033   000000 470400 xsym               LDP0    B$JIT$
         3 000034   000143 236100                    LDQ     99,,PR0
         3 000035   000301 376000 1                  ANQ     DRIBDCB2#+1
         3 000036   000117 601000 3                  TNZ     STOPDRIB

       99     8567    2               GOTO STOPDRIB;            /* Perhaps he reset fid               */
      100     8568    2   STARTDRIB:
      101     8569    2            CALL CHKOPN ALTRET(ONERR);

   8569  3 000037   001060 701000 3     STARTDRIB    TSX1    CHKOPN
         3 000040   000251 702000 3                  TSX2    ONERR

      102     8570    2            DRIBON.TXT= 'DRIBBLE ON @  ';

   8570  3 000041   040100 100400                    MLR     fill='040'O
         3 000042   000302 000016 1                  ADSC9   DRIBDCB2#+2              cn=0,n=14
         3 000043   200025 000016                    ADSC9   DRIBON,,AUTO             cn=0,n=14

      103     8571    2            WR=WRUCREC;

   8571  3 000044   000100 100400                    MLR     fill='000'O
         3 000045   000254 000060 1                  ADSC9   WRUCREC                  cn=0,n=48
         3 000046   200010 000060                    ADSC9   WR,,AUTO                 cn=0,n=48

      104     8572    2            WR.BUF_=VECTOR(DRIBON);

PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:25   
   8572  3 000047   000001 235000 4                  LDA     1
         3 000050   200042 452500                    STP2    CRLF+4,,AUTO
         3 000051   200042 236100                    LDQ     CRLF+4,,AUTO
         3 000052   000025 036003                    ADLQ    21,DU
         3 000053   200014 757100                    STAQ    WR+4,,AUTO

      105     8573    2            WR.V_=VECTOR(WR.V);

   8573  3 000054   000002 235000 4                  LDA     2
         3 000055   200042 452500                    STP2    CRLF+4,,AUTO
         3 000056   200042 236100                    LDQ     CRLF+4,,AUTO
         3 000057   000020 036003                    ADLQ    16,DU
         3 000060   200010 757100                    STAQ    WR,,AUTO

      106     8574    2            IF NOT DCBADDR(%M$DRIBBLE#)->F$DCB.DDEV.UCOUT# THEN

   8574  3 000061   000003 470400 4                  LDP0    3
         3 000062   000000 471500                    LDP1    0,,PR0
         3 000063   177777 473500                    LDP3    -1,,PR1
         3 000064   300004 236100                    LDQ     4,,PR3
         3 000065   020000 316007                    CANQ    8192,DL
         3 000066   000105 601000 3                  TNZ     s:8585

      107     8575    3               CALL M$MWRITE(WR) WHENALTRETURN DO;

   8575  3 000067   200010 634500                    EPPR4   WR,,AUTO
         3 000070   200042 454500                    STP4    CRLF+4,,AUTO
         3 000071   200042 630500                    EPPR0   CRLF+4,,AUTO
         3 000072   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000073   000000 701000 xent               TSX1    M$MWRITE
         3 000074   000076 702000 3                  TSX2    s:8576
         3 000075   000105 710000 3                  TRA     s:8585

      108     8576    3                  IF B$JIT$->B$JIT.ERR=ERRWRWOKEY THEN

   8576  3 000076   000000 470400 xsym               LDP0    B$JIT$
         3 000077   000012 236100                    LDQ     10,,PR0
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:26   
         3 000100   000000 116000 1                  CMPQ    ERRWRWOKEY
         3 000101   000104 601000 3                  TNZ     s:8578

      109     8577    3                     B$JIT$->B$JIT.ERR=ERRDRIBINTOKEYED;

   8577  3 000102   000001 236000 1                  LDQ     ERRDRIBINTOKEYED
         3 000103   000012 756100                    STQ     10,,PR0

      110     8578    3                  GOTO CLOSEIT;

   8578  3 000104   000201 710000 3                  TRA     CLOSEIT

      111     8579        /*E*     ERROR:    UMD-E$DRIBINTOKEYED-2
      112     8580                 MESSAGE:  DRIBBLE INTO an existing keyed file is not allowed.
      113     8581                 MESSAGE1: The command DRIBBLE INTO file is not allowed if
      114     8582                           the file exists and is keyed.
      115     8583        */
      116     8584    3                  END;
      117     8585    2            B$JIT$->B$JIT.CPFLAGS1=B$JIT$->B$JIT.CPFLAGS1 | %CP_DRIBBLE#;

   8585  3 000105   000000 470400 xsym               LDP0    B$JIT$
         3 000106   000143 236100                    LDQ     99,,PR0
         3 000107   000301 276000 1                  ORQ     DRIBDCB2#+1
         3 000110   000143 756100                    STQ     99,,PR0

      118     8586    2            END;

   8586  3 000111   000244 710000 3                  TRA     XIT

      119     8587    2         ELSE DO;

      120     8588    2            IF NOT B$JIT$->B$JIT.CPFLAGS1 & %CP_DRIBBLE# THEN

   8588  3 000112   000000 471400 xsym               LDP1    B$JIT$
         3 000113   100143 236100                    LDQ     99,,PR1
         3 000114   000301 376000 1                  ANQ     DRIBDCB2#+1
         3 000115   000117 601000 3                  TNZ     STOPDRIB
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:27   

      121     8589    2               RETURN;

   8589  3 000116   000000 702200 xent               TSX2  ! X66_ARET

      122     8590    2   STOPDRIB: CALL CHKOPN ALTRET(OFFERR);

   8590  3 000117   001060 701000 3     STOPDRIB     TSX1    CHKOPN
         3 000120   000257 702000 3                  TSX2    OFFERR

      123     8591    2            DRIBON.TXT= 'DRIBBLE OFF @  ';

   8591  3 000121   040100 100400                    MLR     fill='040'O
         3 000122   000306 000016 1                  ADSC9   DRIBDCB2#+6              cn=0,n=14
         3 000123   200025 000016                    ADSC9   DRIBON,,AUTO             cn=0,n=14

      124     8592    2            WR=WRUCREC;

   8592  3 000124   000100 100400                    MLR     fill='000'O
         3 000125   000254 000060 1                  ADSC9   WRUCREC                  cn=0,n=48
         3 000126   200010 000060                    ADSC9   WR,,AUTO                 cn=0,n=48

      125     8593    2            WR.BUF_=VECTOR(DRIBON);

   8593  3 000127   000001 235000 4                  LDA     1
         3 000130   200042 452500                    STP2    CRLF+4,,AUTO
         3 000131   200042 236100                    LDQ     CRLF+4,,AUTO
         3 000132   000025 036003                    ADLQ    21,DU
         3 000133   200014 757100                    STAQ    WR+4,,AUTO

      126     8594    2            WR.V_=VECTOR(WR.V);

   8594  3 000134   000002 235000 4                  LDA     2
         3 000135   200042 452500                    STP2    CRLF+4,,AUTO
         3 000136   200042 236100                    LDQ     CRLF+4,,AUTO
         3 000137   000020 036003                    ADLQ    16,DU
         3 000140   200010 757100                    STAQ    WR,,AUTO
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:28   

      127     8595    2            IF NOT DCBADDR(%M$DRIBBLE#)->F$DCB.DDEV.UCOUT# THEN

   8595  3 000141   000003 470400 4                  LDP0    3
         3 000142   000000 471500                    LDP1    0,,PR0
         3 000143   177777 473500                    LDP3    -1,,PR1
         3 000144   300004 236100                    LDQ     4,,PR3
         3 000145   020000 316007                    CANQ    8192,DL
         3 000146   000155 601000 3                  TNZ     s:8597

      128     8596    2               CALL M$MWRITE(WR) ALTRET(DRIBOFF);

   8596  3 000147   200010 634500                    EPPR4   WR,,AUTO
         3 000150   200042 454500                    STP4    CRLF+4,,AUTO
         3 000151   200042 630500                    EPPR0   CRLF+4,,AUTO
         3 000152   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000153   000000 701000 xent               TSX1    M$MWRITE
         3 000154   000174 702000 3                  TSX2    DRIBOFF

      129     8597    3            IF B$PS0$->FPT$DRIBBLE_V.DRIBBLE THEN DO;

   8597  3 000155   000000 470400 xsym               LDP0    B$PS0$
         3 000156   000000 234100                    SZN     0,,PR0
         3 000157   000174 605000 3                  TPL     DRIBOFF

      130     8598    3               B$JIT$->B$JIT.CPFLAGS1=B$JIT$->B$JIT.CPFLAGS1 & ~%CP_DRIBBLE#;

   8598  3 000160   000301 236000 1                  LDQ     DRIBDCB2#+1
         3 000161   000027 676000 xsym               ERQ     B_VECTNIL+23
         3 000162   000000 471400 xsym               LDP1    B$JIT$
         3 000163   100143 376100                    ANQ     99,,PR1
         3 000164   100143 756100                    STQ     99,,PR1

      131     8599    3               ERR=B$JIT$->B$JIT.ERR;

   8599  3 000165   100012 236100                    LDQ     10,,PR1
         3 000166   200007 756100                    STQ     ERR,,AUTO
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:29   

      132     8600    3               CALL M$MCLOSE (CLDRIB) ALTRET(CLOSE1);

   8600  3 000167   000004 630400 4                  EPPR0   4
         3 000170   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000171   000000 701000 xent               TSX1    M$MCLOSE
         3 000172   000210 702000 3                  TSX2    CLOSE1

      133     8601    3               GOTO STARTDRIB;

   8601  3 000173   000037 710000 3                  TRA     STARTDRIB

      134     8602    3               END;
      135     8603    2   DRIBOFF: B$JIT$->B$JIT.CPFLAGS1=B$JIT$->B$JIT.CPFLAGS1 & ~%CP_DRIBBLE#;

   8603  3 000174   000301 236000 1     DRIBOFF      LDQ     DRIBDCB2#+1
         3 000175   000027 676000 xsym               ERQ     B_VECTNIL+23
         3 000176   000000 470400 xsym               LDP0    B$JIT$
         3 000177   000143 376100                    ANQ     99,,PR0
         3 000200   000143 756100                    STQ     99,,PR0

   8603  3 000201                       CLOSEIT      null
      136     8604    2   CLOSEIT: ;
      137     8605    2            ERR=B$JIT$->B$JIT.ERR;

   8605  3 000201   000000 470400 xsym               LDP0    B$JIT$
         3 000202   000012 236100                    LDQ     10,,PR0
         3 000203   200007 756100                    STQ     ERR,,AUTO

      138     8606    2            CALL M$MCLOSE (CLDRIB) ALTRET(CLOSE1);

   8606  3 000204   000004 630400 4                  EPPR0   4
         3 000205   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000206   000000 701000 xent               TSX1    M$MCLOSE
         3 000207   000210 702000 3                  TSX2    CLOSE1

      139     8607    2   CLOSE1:  B$JIT$->B$JIT.ERR=ERR;
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:30   

   8607  3 000210   200007 236100       CLOSE1       LDQ     ERR,,AUTO
         3 000211   000000 470400 xsym               LDP0    B$JIT$
         3 000212   000012 756100                    STQ     10,,PR0

      140     8608    2   RELSPACE:
      141     8609    2            DCB$ = DCBADDR(%M$DRIBBLE#);

   8609  3 000213   000003 470400 4     RELSPACE     LDP0    3
         3 000214   000000 471500                    LDP1    0,,PR0
         3 000215   177777 236100                    LDQ     -1,,PR1
         3 000216   200006 756100                    STQ     DCB$,,AUTO

      142     8610    2            I=SIZEW(PROMPT)+3+POFFW(ADDR(DCB$->F$DCB.DCBNAME),DCB$);

   8610  3 000217   000140 036003                    ADLQ    96,DU
         3 000220   000022 772000                    QRL     18
         3 000221   200006 235100                    LDA     DCB$,,AUTO
         3 000222   000022 771000                    ARL     18
         3 000223   200042 755100                    STA     CRLF+4,,AUTO
         3 000224   200042 136100                    SBLQ    CRLF+4,,AUTO
         3 000225   000036 036007                    ADLQ    30,DL
         3 000226   200024 756100                    STQ     I,,AUTO

      143     8611    2            CALL FSA$FSP(I,DCB$);

   8611  3 000227   200006 633500                    EPPR3   DCB$,,AUTO
         3 000230   200043 453500                    STP3    CRLF+5,,AUTO
         3 000231   200024 634500                    EPPR4   I,,AUTO
         3 000232   200042 454500                    STP4    CRLF+4,,AUTO
         3 000233   200042 630500                    EPPR0   CRLF+4,,AUTO
         3 000234   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000235   000000 701000 xent               TSX1    FSA$FSP
         3 000236   000000 011000                    NOP     0

      144     8612    2            B$ROSEG$->B$ROSEG.DCBPTR$->DCBP$(DRIBDCB#)=ADDR(NIL);

PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:31   
   8612  3 000237   000000 470400 xsym               LDP0    B$ROSEG$
         3 000240   000000 471500                    LDP1    0,,PR0
         3 000241   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000242   000277 720000 1                  LXL0    DRIBDCB#
         3 000243   100000 756110                    STQ     0,X0,PR1

      145     8613    2            END;

      146     8614    1   XIT:  B$ROSEG$->B$ROSEG.DCBPTR$->DCBP$(%M$LM#)=B$M$LM$;

   8614  3 000244   000000 470400 xsym  XIT          LDP0    B$ROSEG$
         3 000245   000000 471500                    LDP1    0,,PR0
         3 000246   000000 236000 xsym               LDQ     B$M$LM$
         3 000247   100002 756100                    STQ     2,,PR1

      147     8615    1         RETURN;

   8615  3 000250   000000 702200 xent               TSX2  ! X66_ARET

      148     8616    1   ONERR: IF DCBADDR(%M$DRIBBLE#) = ADDR(NIL) THEN

   8616  3 000251   000003 470400 4     ONERR        LDP0    3
         3 000252   000000 471500                    LDP1    0,,PR0
         3 000253   177777 236100                    LDQ     -1,,PR1
         3 000254   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000255   000244 600000 3                  TZE     XIT

      149     8617    1            GOTO XIT;
      150     8618    1         ELSE
      151     8619    1            GOTO RELSPACE;

   8619  3 000256   000213 710000 3                  TRA     RELSPACE

      152     8620    1   OFFERR: IF DCBADDR(%M$DRIBBLE#) ~= ADDR(NIL) THEN

   8620  3 000257   000003 470400 4     OFFERR       LDP0    3
         3 000260   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:32   
         3 000261   177777 236100                    LDQ     -1,,PR1
         3 000262   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000263   000174 601000 3                  TNZ     DRIBOFF

      153     8621    1            GOTO DRIBOFF;
      154     8622    1         ELSE
      155     8623    1            B$JIT$->B$JIT.CPFLAGS1 = B$JIT$->B$JIT.CPFLAGS1 & ~%CP_DRIBBLE#;

   8623  3 000264   000301 236000 1                  LDQ     DRIBDCB2#+1
         3 000265   000027 676000 xsym               ERQ     B_VECTNIL+23
         3 000266   000000 473400 xsym               LDP3    B$JIT$
         3 000267   300143 376100                    ANQ     99,,PR3
         3 000270   300143 756100                    STQ     99,,PR3

      156     8624    1         GOTO XIT;

   8624  3 000271   000244 710000 3                  TRA     XIT

      157     8625        %EJECT;
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:33   
      158     8626    1   UMD$DPMT: ENTRY ALTRET;

   8626  3 000272   000000 700200 xent  UMD$DPMT     TSX0  ! X66_AUTO_2
         3 000273   000046 000002                    ZERO    38,2

      159     8627
      160     8628        /*    Dribble the prompt string.
      161     8629              Write the prompt string with its DVBYTE and VFC = YES.
      162     8630                                                                           */
      163     8631
      164     8632    1         CALL CHKOPN ALTRET(DRIBERR);

   8632  3 000274   001060 701000 3                  TSX1    CHKOPN
         3 000275   001011 702000 3                  TSX2    DRIBERR

      165     8633    2         IF NOT DCBADDR(%M$DRIBBLE#)->F$DCB.DDEV.UCOUT# THEN DO;

   8633  3 000276   000003 470400 4                  LDP0    3
         3 000277   000000 471500                    LDP1    0,,PR0
         3 000300   177777 473500                    LDP3    -1,,PR1
         3 000301   300004 236100                    LDQ     4,,PR3
         3 000302   020000 316007                    CANQ    8192,DL
         3 000303   000400 601000 3                  TNZ     s:8649

      166     8634    2            CALL FMO$GETPFB(I);

   8634  3 000304   200024 634500                    EPPR4   I,,AUTO
         3 000305   200042 454500                    STP4    CRLF+4,,AUTO
         3 000306   200042 630500                    EPPR0   CRLF+4,,AUTO
         3 000307   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000310   000000 701000 xent               TSX1    FMO$GETPFB
         3 000311   000000 011000                    NOP     0

      167     8635    2            IF I > 3 THEN GOTO DRIBXIT;

   8635  3 000312   200024 235100                    LDA     I,,AUTO
         3 000313   000004 115007                    CMPA    4,DL
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:34   
         3 000314   000623 603000 3                  TRC     DRIBXIT

      168     8636    2            IF PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)->

   8636  3 000315   000003 470400 4                  LDP0    3
         3 000316   000000 471500                    LDP1    0,,PR0
         3 000317   177777 473500                    LDP3    -1,,PR1
         3 000320   200024 236100                    LDQ     I,,AUTO
         3 000321   000011 402007                    MPY     9,DL
         3 000322   300132 236106                    LDQ     90,QL,PR3
         3 000323   777000 316003                    CANQ    -512,DU
         3 000324   000331 600000 3                  TZE     s:8640

      169     8637    2               PROMPT.TRNS0(I-1) THEN
      170     8638    2               CALL M$MWRITE (WRTRNS0) ALTRET(DRIBERR);

   8638  3 000325   000005 630400 4                  EPPR0   5
         3 000326   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000327   000000 701000 xent               TSX1    M$MWRITE
         3 000330   001011 702000 3                  TSX2    DRIBERR

      171     8639
      172     8640    2            WR=WRUCREC;

   8640  3 000331   000100 100400                    MLR     fill='000'O
         3 000332   000254 000060 1                  ADSC9   WRUCREC                  cn=0,n=48
         3 000333   200010 000060                    ADSC9   WR,,AUTO                 cn=0,n=48

      173     8641    2            WR.V_=VECTOR(WR.V);

   8641  3 000334   000002 235000 4                  LDA     2
         3 000335   200042 452500                    STP2    CRLF+4,,AUTO
         3 000336   200042 236100                    LDQ     CRLF+4,,AUTO
         3 000337   000020 036003                    ADLQ    16,DU
         3 000340   200010 757100                    STAQ    WR,,AUTO

      174     8642    2            WR.V.DVBYTE=PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)->PROMPT.
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:35   
              8642                     DVBYTE(I-1);

   8642  3 000341   000003 470400 4                  LDP0    3
         3 000342   000000 471500                    LDP1    0,,PR0
         3 000343   177777 473500                    LDP3    -1,,PR1
         3 000344   200024 236100                    LDQ     I,,AUTO
         3 000345   000011 402007                    MPY     9,DL
         3 000346   300132 236106                    LDQ     90,QL,PR3
         3 000347   000011 736000                    QLS     9
         3 000350   200023 552140                    STBQ    WR+11,'40'O,AUTO

      175     8643    2            WR.V.DVBYTE.VFC#='1'B;

   8643  3 000351   100000 236003                    LDQ     32768,DU
         3 000352   200023 256100                    ORSQ    WR+11,,AUTO

      176     8644    2            WR.V.DVBYTE.BP#='1'B;

   8644  3 000353   200000 236003                    LDQ     65536,DU
         3 000354   200023 256100                    ORSQ    WR+11,,AUTO

      177     8645    2            WR.BUF_.BOUND=PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)->PROMPT.
              8645                     LN(I-1);

   8645  3 000355   200024 236100                    LDQ     I,,AUTO
         3 000356   000011 402007                    MPY     9,DL
         3 000357   300132 236106                    LDQ     90,QL,PR3
         3 000360   777000 376007                    ANQ     -512,DL
         3 000361   000007 736000                    QLS     7
         3 000362   200014 676100                    ERQ     WR+4,,AUTO
         3 000363   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 000364   200014 656100                    ERSQ    WR+4,,AUTO

      178     8646    2            WR.BUF_.BUF$=ADDR(PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)->
              8646                     PROMPT.TXT(I-1));

   8646  3 000365   200024 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:36   
         3 000366   000044 402007                    MPY     36,DL
         3 000367   000553 036007                    ADLQ    363,DL
         3 000370   300000 500506                    A9BD    0,QL,PR3
         3 000371   200015 453500                    STP3    WR+5,,AUTO

      179     8647    2            CALL M$MWRITE (WR) ALTRET(DRIBERR);

   8647  3 000372   200010 634500                    EPPR4   WR,,AUTO
         3 000373   200042 454500                    STP4    CRLF+4,,AUTO
         3 000374   200042 630500                    EPPR0   CRLF+4,,AUTO
         3 000375   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000376   000000 701000 xent               TSX1    M$MWRITE
         3 000377   001011 702000 3                  TSX2    DRIBERR

      180     8648    2            END;

      181     8649    1         GOTO DRIBXIT;

   8649  3 000400   000623 710000 3                  TRA     DRIBXIT

      182     8650
      183     8651
      184     8652
      185     8653
      186     8654    1   UMD$DIN: ENTRY(VPMT) ALTRET;

   8654  3 000401   000000 700200 xent  UMD$DIN      TSX0  ! X66_AUTO_2
         3 000402   000046 000002                    ZERO    38,2

      187     8655
      188     8656        /*
      189     8657                    Dribble the input string.
      190     8658                    If ARS ~= 0,
      191     8659                    If EOMCHAR was CR, LF or <F>
      192     8660                       If its a device (LP), write the record with default VFC
      193     8661                       in the DCB set to 'A'.
      194     8662                       If its a file, write a zero length record with VFC = 'A'
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:37   
      195     8663                       and concatenate the input record.
      196     8664                    If EOMCHAR was not CR, LF or <F>
      197     8665                       If its a device, write the record with default VFC of
      198     8666                       '@'.
      199     8667                       If its a file, write the zero length record with VFC of
      200     8668                       '@' and concatenate the input record.
      201     8669                       If EOMCHAR was printable, write a record with a VFC of
      202     8670                       '@' and containing EOMCHAR for both device and file.
      203     8671
      204     8672                    If ARS = 0,
      205     8673                    If EOMCHAR was CR, LF or <F>, write a zero length record
      206     8674                    with VFC = 'A'.
      207     8675                    If EOMCHAR was not CR, LF or <F> and it was printable,
      208     8676                    write a record with a VFC of '@' and containing EOMCHAR.
      209     8677                    Otherwise, exit. There is no need to write EOMCHAR.
      210     8678                                                                            */
      211     8679
      212     8680
      213     8681    1         CALL CHKOPN ALTRET(DRIBERR);

   8681  3 000403   001060 701000 3                  TSX1    CHKOPN
         3 000404   001011 702000 3                  TSX2    DRIBERR

      214     8682    2         IF NOT DCBADDR(%M$DRIBBLE#)->F$DCB.DDEV.UCOUT# THEN DO;

   8682  3 000405   000003 470400 4                  LDP0    3
         3 000406   000000 471500                    LDP1    0,,PR0
         3 000407   177777 473500                    LDP3    -1,,PR1
         3 000410   300004 236100                    LDQ     4,,PR3
         3 000411   020000 316007                    CANQ    8192,DL
         3 000412   000623 601000 3                  TNZ     DRIBXIT

      215     8683    2            WR=WRUCREC;

   8683  3 000413   000100 100400                    MLR     fill='000'O
         3 000414   000254 000060 1                  ADSC9   WRUCREC                  cn=0,n=48
         3 000415   200010 000060                    ADSC9   WR,,AUTO                 cn=0,n=48
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:38   

      216     8684    2            WR.V_=VECTOR(WR.V);

   8684  3 000416   000002 235000 4                  LDA     2
         3 000417   200042 452500                    STP2    CRLF+4,,AUTO
         3 000420   200042 236100                    LDQ     CRLF+4,,AUTO
         3 000421   000020 036003                    ADLQ    16,DU
         3 000422   200010 757100                    STAQ    WR,,AUTO

      217     8685    2            PRINTABLE = '0'B;

   8685  3 000423   200035 450100                    STZ     PRINTABLE,,AUTO

      218     8686    2            IF DCB$->F$DCB.EOMCHAR# = BITASC('015'O) OR

   8686  3 000424   200006 474500                    LDP4    DCB$,,AUTO
         3 000425   400003 236100                    LDQ     3,,PR4
         3 000426   000777 376007                    ANQ     511,DL
         3 000427   000015 116007                    CMPQ    13,DL
         3 000430   000441 600000 3                  TZE     s:8689
         3 000431   400003 236100                    LDQ     3,,PR4
         3 000432   000777 376007                    ANQ     511,DL
         3 000433   000012 116007                    CMPQ    10,DL
         3 000434   000441 600000 3                  TZE     s:8689
         3 000435   200003 475500                    LDP5    @VPMT,,AUTO
         3 000436   500000 236100                    LDQ     0,,PR5
         3 000437   000312 376000 1                  ANQ     DRIBDCB2#+10
         3 000440   000453 600000 3                  TZE     s:8696

      219     8687    2               DCB$->F$DCB.EOMCHAR# = BITASC('012'O) OR
      220     8688    3               ADDR(VPMT)->TYC & %TYC_EOF THEN DO;

      221     8689    4               IF DCB$->F$DCB.ARS# = 0 THEN DO;

   8689  3 000441   400000 235100                    LDA     0,,PR4
         3 000442   000450 601000 3                  TNZ     s:8693

PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:39   
      222     8690    4                  CALL M$MWRITE (WRA) ALTRET(DRIBERR);

   8690  3 000443   000006 630400 4                  EPPR0   6
         3 000444   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000445   000000 701000 xent               TSX1    M$MWRITE
         3 000446   001011 702000 3                  TSX2    DRIBERR

      223     8691    4                  GOTO DRIBXIT;

   8691  3 000447   000623 710000 3                  TRA     DRIBXIT

      224     8692    4                  END;
      225     8693    3               CRLF = '1'B;

   8693  3 000450   400000 236003                    LDQ     -131072,DU
         3 000451   200036 756100                    STQ     CRLF,,AUTO

      226     8694    3               END;

   8694  3 000452   000510 710000 3                  TRA     s:8709

      227     8695    3            ELSE DO;

      228     8696    3               CRLF = '0'B;

   8696  3 000453   200036 450100                    STZ     CRLF,,AUTO

      229     8697    3               IF (DCB$->F$DCB.EOMCHAR# > BITASC('040'O) AND DCB$->F$DCB.EOMCHAR# <=
              8697                        BITASC('176'O)) OR

   8697  3 000454   400003 236100                    LDQ     3,,PR4
         3 000455   000777 376007                    ANQ     511,DL
         3 000456   000040 116007                    CMPQ    32,DL
         3 000457   000466 602000 3                  TNC     s:8697+10
         3 000460   000466 600000 3                  TZE     s:8697+10
         3 000461   400003 236100                    LDQ     3,,PR4
         3 000462   000777 376007                    ANQ     511,DL
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:40   
         3 000463   000176 116007                    CMPQ    126,DL
         3 000464   000500 602000 3                  TNC     s:8699
         3 000465   000500 600000 3                  TZE     s:8699
         3 000466   400003 236100                    LDQ     3,,PR4
         3 000467   000777 376007                    ANQ     511,DL
         3 000470   000240 116007                    CMPQ    160,DL
         3 000471   000505 602000 3                  TNC     s:8704
         3 000472   000505 600000 3                  TZE     s:8704
         3 000473   400003 236100                    LDQ     3,,PR4
         3 000474   000777 376007                    ANQ     511,DL
         3 000475   000376 116007                    CMPQ    254,DL
         3 000476   000500 600000 3                  TZE     s:8699
         3 000477   000505 603000 3                  TRC     s:8704

      230     8698    4                  (DCB$->F$DCB.EOMCHAR#> BITASC('240'O) AND DCB$->F$DCB.EOMCHAR# <=
              8698                           BITASC('376'O)) THEN DO;

      231     8699    4                  PRINTABLE = '1'B;

   8699  3 000500   400000 236003                    LDQ     -131072,DU
         3 000501   200035 756100                    STQ     PRINTABLE,,AUTO

      232     8700    4                  IF DCB$->F$DCB.ARS# = 0 THEN

   8700  3 000502   400000 235100                    LDA     0,,PR4
         3 000503   000562 600000 3                  TZE     DIN1

      233     8701    4                     GOTO DIN1;
      234     8702    4                  END;

   8702  3 000504   000510 710000 3                  TRA     s:8709

      235     8703    4               ELSE DO;

      236     8704    4                  IF DCB$->F$DCB.ARS# = 0 THEN

   8704  3 000505   400000 235100                    LDA     0,,PR4
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:41   
         3 000506   000623 600000 3                  TZE     DRIBXIT

      237     8705    4                     GOTO DRIBXIT;
      238     8706    4                  PRINTABLE = '0'B;

   8706  3 000507   200035 450100                    STZ     PRINTABLE,,AUTO

      239     8707    4                  END;

      240     8708    3               END;

      241     8709    2            IF DCBADDR(%M$DRIBBLE#)->F$DCB.DDEV THEN

   8709  3 000510   300004 236100                    LDQ     4,,PR3
         3 000511   777000 316007                    CANQ    -512,DL
         3 000512   000516 600000 3                  TZE     s:8712

      242     8710    2               DCBADDR(%M$DRIBBLE#)->F$DCB.DVFC#='@';

   8710  3 000513   100000 236007                    LDQ     32768,DL
         3 000514   300044 552110                    STBQ    36,'10'O,PR3
         3 000515   000541 710000 3                  TRA     s:8720

      243     8711    3            ELSE DO;

      244     8712    3               WR.V.DVBYTE.CONT#='1'B;

   8712  3 000516   001000 236003                    LDQ     512,DU
         3 000517   200023 256100                    ORSQ    WR+11,,AUTO

      245     8713    3               WR.V.DVBYTE.VFC#='1'B;

   8713  3 000520   100000 236003                    LDQ     32768,DU
         3 000521   200023 256100                    ORSQ    WR+11,,AUTO

      246     8714    3               WR.BUF_=VECTOR(ATVFC);

PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:42   
   8714  3 000522   000010 237000 4                  LDAQ    8
         3 000523   200014 757100                    STAQ    WR+4,,AUTO

      247     8715    3               CALL M$MWRITE (WR) ALTRET(DRIBERR);

   8715  3 000524   200010 635500                    EPPR5   WR,,AUTO
         3 000525   200042 455500                    STP5    CRLF+4,,AUTO
         3 000526   200042 630500                    EPPR0   CRLF+4,,AUTO
         3 000527   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000530   000000 701000 xent               TSX1    M$MWRITE
         3 000531   001011 702000 3                  TSX2    DRIBERR

      248     8716    3               WR.V.DVBYTE.VFC#='0'B;

   8716  3 000532   000012 236000 4                  LDQ     10
         3 000533   200023 356100                    ANSQ    WR+11,,AUTO

      249     8717    3               WR.V.DVBYTE.CONT# = PRINTABLE;

   8717  3 000534   200035 236100                    LDQ     PRINTABLE,,AUTO
         3 000535   000010 772000                    QRL     8
         3 000536   200023 676100                    ERQ     WR+11,,AUTO
         3 000537   001000 376003                    ANQ     512,DU
         3 000540   200023 656100                    ERSQ    WR+11,,AUTO

      250     8718    3               END;

      251     8719
      252     8720    2            WR.BUF_.BUF$=DCB$->F$DCB.UB$;

   8720  3 000541   200006 470500                    LDP0    DCB$,,AUTO
         3 000542   000075 236100                    LDQ     61,,PR0
         3 000543   200015 756100                    STQ     WR+5,,AUTO

      253     8721    2            WR.BUF_.BOUND=DCB$->F$DCB.ARS#-1;

   8721  3 000544   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:43   
         3 000545   000001 136007                    SBLQ    1,DL
         3 000546   000020 736000                    QLS     16
         3 000547   200014 676100                    ERQ     WR+4,,AUTO
         3 000550   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 000551   200014 656100                    ERSQ    WR+4,,AUTO

      254     8722    2            CALL M$MWRITE (WR) ALTRET(DRIBERR);

   8722  3 000552   200010 631500                    EPPR1   WR,,AUTO
         3 000553   200042 451500                    STP1    CRLF+4,,AUTO
         3 000554   200042 630500                    EPPR0   CRLF+4,,AUTO
         3 000555   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000556   000000 701000 xent               TSX1    M$MWRITE
         3 000557   001011 702000 3                  TSX2    DRIBERR

      255     8723
      256     8724    3            IF PRINTABLE THEN DO;

   8724  3 000560   200035 234100                    SZN     PRINTABLE,,AUTO
         3 000561   000611 605000 3                  TPL     s:8733

      257     8725    3   DIN1:       IF DCBADDR(%M$DRIBBLE#)->F$DCB.DDEV THEN

   8725  3 000562   000003 470400 4     DIN1         LDP0    3
         3 000563   000000 471500                    LDP1    0,,PR0
         3 000564   177777 473500                    LDP3    -1,,PR1
         3 000565   300004 236100                    LDQ     4,,PR3
         3 000566   777000 316007                    CANQ    -512,DL
         3 000567   000572 600000 3                  TZE     s:8727

      258     8726    3                  DCBADDR(%M$DRIBBLE#)->F$DCB.DVFC#='@';

   8726  3 000570   100000 236007                    LDQ     32768,DL
         3 000571   300044 552110                    STBQ    36,'10'O,PR3

      259     8727    3               WR.V.DVBYTE.CONT# = '0'B;

PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:44   
   8727  3 000572   000013 236000 4                  LDQ     11
         3 000573   200023 356100                    ANSQ    WR+11,,AUTO

      260     8728    3               WR.V.DVBYTE.VFC#='0'B;

   8728  3 000574   000012 236000 4                  LDQ     10
         3 000575   200023 356100                    ANSQ    WR+11,,AUTO

      261     8729    3               WR.BUF_=VECTOR(DCB$->F$DCB.EOMCHAR#);

   8729  3 000576   177640 235007                    LDA     65440,DL
         3 000577   200006 236100                    LDQ     DCB$,,AUTO
         3 000600   000014 036000 4                  ADLQ    12
         3 000601   200014 757100                    STAQ    WR+4,,AUTO

      262     8730    3               CALL M$MWRITE(WR) ALTRET(DRIBERR);

   8730  3 000602   200010 634500                    EPPR4   WR,,AUTO
         3 000603   200042 454500                    STP4    CRLF+4,,AUTO
         3 000604   200042 630500                    EPPR0   CRLF+4,,AUTO
         3 000605   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000606   000000 701000 xent               TSX1    M$MWRITE
         3 000607   001011 702000 3                  TSX2    DRIBERR

      263     8731    3               END;

   8731  3 000610   000623 710000 3                  TRA     DRIBXIT

      264     8732    3            ELSE DO;

      265     8733    4               IF CRLF THEN DO;

   8733  3 000611   200036 234100                    SZN     CRLF,,AUTO
         3 000612   000623 605000 3                  TPL     DRIBXIT

      266     8734    4                  WR.BUF_=VECTOR(AVFC);

PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:45   
   8734  3 000613   000016 237000 4                  LDAQ    14
         3 000614   200014 757100                    STAQ    WR+4,,AUTO

      267     8735    4                  WR.V.DVBYTE.VFC#='1'B;

   8735  3 000615   100000 236003                    LDQ     32768,DU
         3 000616   200023 256100                    ORSQ    WR+11,,AUTO

      268     8736    4                  CALL M$WRITE (WR) ALTRET(DRIBERR);

   8736  3 000617   200010 630500                    EPPR0   WR,,AUTO
         3 000620   440001 713400                    CLIMB   alt,write
         3 000621   401400 401760                    pmme    nvectors=4
         3 000622   001011 702000 3                  TSX2    DRIBERR

      269     8737    4                  END;

      270     8738    3               END;

      271     8739    2            END;

   8734  3 000623                       DRIBXIT      null
      272     8740    1   DRIBXIT:;
      273     8741    1         B$ROSEG$->B$ROSEG.DCBPTR$->DCBP$(%M$LM#)=B$M$LM$;

   8741  3 000623   000000 470400 xsym               LDP0    B$ROSEG$
         3 000624   000000 471500                    LDP1    0,,PR0
         3 000625   000000 236000 xsym               LDQ     B$M$LM$
         3 000626   100002 756100                    STQ     2,,PR1

      274     8742    1         B$JIT$->B$JIT.DCB$=DCB$;

   8742  3 000627   200006 236100                    LDQ     DCB$,,AUTO
         3 000630   000000 471400 xsym               LDP1    B$JIT$
         3 000631   100232 756100                    STQ     154,,PR1

      275     8743    1         B$JIT$->B$JIT.DCBNO=DCBNR;
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:46   

   8743  3 000632   200005 236100                    LDQ     DCBNR,,AUTO
         3 000633   100022 552104                    STBQ    18,'04'O,PR1

      276     8744    1         B$JIT$->B$JIT.ERR=ERR;

   8744  3 000634   200007 236100                    LDQ     ERR,,AUTO
         3 000635   100012 756100                    STQ     10,,PR1

      277     8745    1         RETURN;

   8745  3 000636   000000 702200 xent               TSX2  ! X66_ARET

      278     8746    1   UMD$DOU: ENTRY(VPMT,LN)   ALTRET;

   8746  3 000637   000000 700200 xent  UMD$DOU      TSX0  ! X66_AUTO_2
         3 000640   000046 000002                    ZERO    38,2

      279     8747    1         CALL CHKOPN ALTRET(DRIBERR);

   8747  3 000641   001060 701000 3                  TSX1    CHKOPN
         3 000642   001011 702000 3                  TSX2    DRIBERR

      280     8748    2         IF NOT DCBADDR(%M$DRIBBLE#)->F$DCB.DDEV.UCOUT# THEN DO;

   8748  3 000643   000003 470400 4                  LDP0    3
         3 000644   000000 471500                    LDP1    0,,PR0
         3 000645   177777 473500                    LDP3    -1,,PR1
         3 000646   300004 236100                    LDQ     4,,PR3
         3 000647   020000 316007                    CANQ    8192,DL
         3 000650   000760 601000 3                  TNZ     s:8778

      281     8749    2            WR=WRUCREC;

   8749  3 000651   000100 100400                    MLR     fill='000'O
         3 000652   000254 000060 1                  ADSC9   WRUCREC                  cn=0,n=48
         3 000653   200010 000060                    ADSC9   WR,,AUTO                 cn=0,n=48
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:47   

      282     8750        /* Output to the terminal always has a VFC so first write VFC character
      283     8751             and then concatenate the users output.                           */
      284     8752    2            WR.V_=VECTOR(WR.V);

   8752  3 000654   000002 235000 4                  LDA     2
         3 000655   200042 452500                    STP2    CRLF+4,,AUTO
         3 000656   200042 236100                    LDQ     CRLF+4,,AUTO
         3 000657   000020 036003                    ADLQ    16,DU
         3 000660   200010 757100                    STAQ    WR,,AUTO

      285     8753    2            WR.V.DVBYTE=ADDR(VPMT)->DVBYTE;

   8753  3 000661   200003 474500                    LDP4    @VPMT,,AUTO
         3 000662   000100 100500                    MLR     fill='000'O
         3 000663   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         3 000664   200023 000001                    ADSC9   WR+11,,AUTO              cn=0,n=1

      286     8754    2            WR.V.DVBYTE.VFC#='1'B;

   8754  3 000665   100000 236003                    LDQ     32768,DU
         3 000666   200023 256100                    ORSQ    WR+11,,AUTO

      287     8755    2            IF DCB$->F$DCB.UBYTES ~= 0 THEN

   8755  3 000667   200006 475500                    LDP5    DCB$,,AUTO
         3 000670   500076 235100                    LDA     62,,PR5
         3 000671   000707 600000 3                  TZE     s:8764

      288     8756    3               IF DCBADDR(%M$DRIBBLE#)->F$DCB.DDEV THEN DO;

   8756  3 000672   300004 236100                    LDQ     4,,PR3
         3 000673   777000 316007                    CANQ    -512,DL
         3 000674   000704 600000 3                  TZE     s:8762

      289     8757    3                  DCBADDR(%M$DRIBBLE#)->F$DCB.DVFC#=ADDR(LN)->VFC;

PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:48   
   8757  3 000675   200004 476500                    LDP6    @LN,,AUTO
         3 000676   600000 236100                    LDQ     0,,PR6
         3 000677   000022 772000                    QRL     18
         3 000700   300044 552110                    STBQ    36,'10'O,PR3

      290     8758    3                  WR.V.DVBYTE.VFC# = '0'B;

   8758  3 000701   000012 236000 4                  LDQ     10
         3 000702   200023 356100                    ANSQ    WR+11,,AUTO

      291     8759    3                  GOTO DOU1;

   8759  3 000703   000725 710000 3                  TRA     DOU1

      292     8760    3                  END;
      293     8761    2               ELSE
      294     8762    2                  WR.V.DVBYTE.CONT#='1'B;

   8762  3 000704   001000 236003                    LDQ     512,DU
         3 000705   200023 256100                    ORSQ    WR+11,,AUTO
         3 000706   000711 710000 3                  TRA     s:8765

      295     8763    2            ELSE
      296     8764    2               WR.V.DVBYTE.CONT#='0'B;

   8764  3 000707   000013 236000 4                  LDQ     11
         3 000710   200023 356100                    ANSQ    WR+11,,AUTO

      297     8765    2            WR.BUF_=VECTOR(ADDR(LN)->VFC);

   8765  3 000711   177640 235007                    LDA     65440,DL
         3 000712   200004 236100                    LDQ     @LN,,AUTO
         3 000713   200014 757100                    STAQ    WR+4,,AUTO

      298     8766    2            CALL M$MWRITE (WR) ALTRET(DRIBERR);

   8766  3 000714   200010 636500                    EPPR6   WR,,AUTO
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:49   
         3 000715   200042 456500                    STP6    CRLF+4,,AUTO
         3 000716   200042 630500                    EPPR0   CRLF+4,,AUTO
         3 000717   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000720   000000 701000 xent               TSX1    M$MWRITE
         3 000721   001011 702000 3                  TSX2    DRIBERR

      299     8767    3            IF DCB$->F$DCB.UBYTES ~= 0 THEN DO;

   8767  3 000722   200006 470500                    LDP0    DCB$,,AUTO
         3 000723   000076 235100                    LDA     62,,PR0
         3 000724   000760 600000 3                  TZE     s:8778

      300     8768    3   DOU1:       WR.V.DVBYTE.CONT#='0'B;

   8768  3 000725   000013 236000 4     DOU1         LDQ     11
         3 000726   200023 356100                    ANSQ    WR+11,,AUTO

      301     8769    3               WR.V.DVBYTE.VFC#='0'B;

   8769  3 000727   000012 236000 4                  LDQ     10
         3 000730   200023 356100                    ANSQ    WR+11,,AUTO

      302     8770    3               WR.BUF_.BUF$=DCB$->F$DCB.UB$;

   8770  3 000731   200006 470500                    LDP0    DCB$,,AUTO
         3 000732   000075 236100                    LDQ     61,,PR0
         3 000733   200015 756100                    STQ     WR+5,,AUTO

      303     8771    3               IF DCB$->F$DCB.UBYTES > 2048 THEN

   8771  3 000734   000076 235100                    LDA     62,,PR0
         3 000735   004001 115007                    CMPA    2049,DL
         3 000736   000744 602000 3                  TNC     s:8774

      304     8772    3                  WR.BUF_.BOUND=2047;

   8772  3 000737   200014 236100                    LDQ     WR+4,,AUTO
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:50   
         3 000740   177777 376007                    ANQ     65535,DL
         3 000741   000015 276000 4                  ORQ     13
         3 000742   200014 756100                    STQ     WR+4,,AUTO
         3 000743   000752 710000 3                  TRA     s:8775

      305     8773    3               ELSE
      306     8774    3                  WR.BUF_.BOUND=DCB$->F$DCB.UBYTES-1;

   8774  3 000744   000076 236100                    LDQ     62,,PR0
         3 000745   000001 136007                    SBLQ    1,DL
         3 000746   000020 736000                    QLS     16
         3 000747   200014 676100                    ERQ     WR+4,,AUTO
         3 000750   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 000751   200014 656100                    ERSQ    WR+4,,AUTO

      307     8775    3               CALL M$MWRITE (WR) ALTRET(DRIBERR);

   8775  3 000752   200010 631500                    EPPR1   WR,,AUTO
         3 000753   200042 451500                    STP1    CRLF+4,,AUTO
         3 000754   200042 630500                    EPPR0   CRLF+4,,AUTO
         3 000755   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000756   000000 701000 xent               TSX1    M$MWRITE
         3 000757   001011 702000 3                  TSX2    DRIBERR

      308     8776    3               END;

      309     8777    2            END;

      310     8778    1         GOTO DRIBXIT;

   8778  3 000760   000623 710000 3                  TRA     DRIBXIT

      311     8779        %EJECT;
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:51   
      312     8780    1   UMD$QDRIB: ENTRY ALTRET;

   8780  3 000761   000000 700200 xent  UMD$QDRIB    TSX0  ! X66_AUTO_2
         3 000762   000046 000002                    ZERO    38,2

      313     8781        /*  Called from FMQ$RELSTARF if dribbling to * file when they are released */
      314     8782        /**/
      315     8783    1         B$JIT$->B$JIT.CPFLAGS1=B$JIT$->B$JIT.CPFLAGS1 & ~%CP_DRIBBLE#;

   8783  3 000763   000301 236000 1                  LDQ     DRIBDCB2#+1
         3 000764   000027 676000 xsym               ERQ     B_VECTNIL+23
         3 000765   000000 470400 xsym               LDP0    B$JIT$
         3 000766   000143 376100                    ANQ     99,,PR0
         3 000767   000143 756100                    STQ     99,,PR0
         3 000770   000773 710000 3                  TRA     CLSDRIB

      316     8784        /**/
      317     8785        /**/
      318     8786    1   UMD$CLSDRIB: ENTRY ALTRET;

   8786  3 000771   000000 700200 xent  UMD$CLSDRIB  TSX0  ! X66_AUTO_2
         3 000772   000046 000002                    ZERO    38,2

      319     8787        /*   Called at rundown to close M$DRIBBLE and release its space.  */
      320     8788    2   CLSDRIB: IF DCBADDR(%M$DRIBBLE#) ~= ADDR(NIL) THEN DO;

   8788  3 000773   000003 470400 4     CLSDRIB      LDP0    3
         3 000774   000000 471500                    LDP1    0,,PR0
         3 000775   177777 236100                    LDQ     -1,,PR1
         3 000776   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000777   001010 600000 3                  TZE     s:8795

      321     8789    2            B$ROSEG$->B$ROSEG.DCBPTR$->DCBP$(%M$LM#)=DCBADDR(%M$DRIBBLE#);

   8789  3 001000   000000 473400 xsym               LDP3    B$ROSEG$
         3 001001   300000 474500                    LDP4    0,,PR3
         3 001002   400002 756100                    STQ     2,,PR4
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:52   

      322     8790    2            IF DCBADDR(%M$DRIBBLE#)->F$DCB.FCD# THEN

   8790  3 001003   177777 474500                    LDP4    -1,,PR1
         3 001004   400031 236100                    LDQ     25,,PR4
         3 001005   020000 316007                    CANQ    8192,DL
         3 001006   000201 601000 3                  TNZ     CLOSEIT

      323     8791    2               GOTO CLOSEIT;
      324     8792    2            ELSE
      325     8793    2               GOTO RELSPACE;

   8793  3 001007   000213 710000 3                  TRA     RELSPACE

      326     8794    2            END;
      327     8795    1         RETURN;

   8795  3 001010   000000 702200 xent               TSX2  ! X66_ARET

      328     8796        %EJECT;
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:53   
      329     8797        /*   Handle errors while dribbling inputs and outputs; not ON/OFFs. */
      330     8798        /*   Exits through DRIBXIT to get JIT back how it was at entry.     */
      331     8799        /*   Ignores the error that occured while dribbling because M$ERRMSG */
      332     8800        /*   uses to much AUTO to do whats right.                            */
      333     8801    1   DRIBERR:
      334     8802    1         B$JIT$->B$JIT.CPFLAGS1=B$JIT$->B$JIT.CPFLAGS1 & ~%CP_DRIBBLE#;

   8802  3 001011   000301 236000 1     DRIBERR      LDQ     DRIBDCB2#+1
         3 001012   000027 676000 xsym               ERQ     B_VECTNIL+23
         3 001013   000000 470400 xsym               LDP0    B$JIT$
         3 001014   000143 376100                    ANQ     99,,PR0
         3 001015   000143 756100                    STQ     99,,PR0

      335     8803    2         IF DCBADDR(%M$DRIBBLE#) ~= ADDR(NIL) THEN DO;

   8803  3 001016   000003 471400 4                  LDP1    3
         3 001017   100000 473500                    LDP3    0,,PR1
         3 001020   377777 236100                    LDQ     -1,,PR3
         3 001021   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 001022   001057 600000 3                  TZE     s:8809

      336     8804    2            CALL M$MCLOSE (CLDRIB) ALTRET(DRIBER1);

   8804  3 001023   000004 630400 4                  EPPR0   4
         3 001024   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001025   000000 701000 xent               TSX1    M$MCLOSE
         3 001026   001027 702000 3                  TSX2    DRIBER1

      337     8805    2   DRIBER1: I=SIZEW(PROMPT)+3+POFFW(ADDR(DCB$->F$DCB.DCBNAME),DCB$);

   8805  3 001027   200006 236100       DRIBER1      LDQ     DCB$,,AUTO
         3 001030   000140 036003                    ADLQ    96,DU
         3 001031   000022 772000                    QRL     18
         3 001032   200006 235100                    LDA     DCB$,,AUTO
         3 001033   000022 771000                    ARL     18
         3 001034   200042 755100                    STA     CRLF+4,,AUTO
         3 001035   200042 136100                    SBLQ    CRLF+4,,AUTO
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:54   
         3 001036   000036 036007                    ADLQ    30,DL
         3 001037   200024 756100                    STQ     I,,AUTO

      338     8806    2            CALL FSA$FSP(I,DCBADDR(%M$DRIBBLE#));

   8806  3 001040   000003 470400 4                  LDP0    3
         3 001041   000000 471500                    LDP1    0,,PR0
         3 001042   177777 633500                    EPPR3   -1,,PR1
         3 001043   200043 453500                    STP3    CRLF+5,,AUTO
         3 001044   200024 634500                    EPPR4   I,,AUTO
         3 001045   200042 454500                    STP4    CRLF+4,,AUTO
         3 001046   200042 630500                    EPPR0   CRLF+4,,AUTO
         3 001047   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001050   000000 701000 xent               TSX1    FSA$FSP
         3 001051   000000 011000                    NOP     0

      339     8807    2            B$ROSEG$->B$ROSEG.DCBPTR$->DCBP$(DRIBDCB#)=ADDR(NIL);

   8807  3 001052   000000 470400 xsym               LDP0    B$ROSEG$
         3 001053   000000 471500                    LDP1    0,,PR0
         3 001054   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 001055   000277 720000 1                  LXL0    DRIBDCB#
         3 001056   100000 756110                    STQ     0,X0,PR1

      340     8808    2            END;

      341     8809    1         GOTO DRIBXIT;

   8809  3 001057   000623 710000 3                  TRA     DRIBXIT

      342     8810        %EJECT;
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:55   
      343     8811    1   CHKOPN: PROC ALTRET;

   8811  3 001060   200040 741300       CHKOPN       STX1  ! CRLF+2,,AUTO

      344     8812    2         DCB$=B$JIT$->B$JIT.DCB$;

   8812  3 001061   000000 470400 xsym               LDP0    B$JIT$
         3 001062   000232 236100                    LDQ     154,,PR0
         3 001063   200006 756100                    STQ     DCB$,,AUTO

      345     8813    2         DCBNR=B$JIT$->B$JIT.DCBNO;

   8813  3 001064   000022 236100                    LDQ     18,,PR0
         3 001065   000777 376007                    ANQ     511,DL
         3 001066   200005 756100                    STQ     DCBNR,,AUTO

      346     8814    2         ERR=B$JIT$->B$JIT.ERR;

   8814  3 001067   000012 236100                    LDQ     10,,PR0
         3 001070   200007 756100                    STQ     ERR,,AUTO

      347     8815    2         B$ROSEG$->B$ROSEG.DCBPTR$->DCBP$(%M$LM#)=DCBADDR(%M$DRIBBLE#);

   8815  3 001071   000000 471400 xsym               LDP1    B$ROSEG$
         3 001072   100000 473500                    LDP3    0,,PR1
         3 001073   000003 474400 4                  LDP4    3
         3 001074   400000 475500                    LDP5    0,,PR4
         3 001075   577777 236100                    LDQ     -1,,PR5
         3 001076   300002 756100                    STQ     2,,PR3

      348     8816    2         IF DCBADDR(%M$DRIBBLE#) ~= ADDR(NIL) THEN

   8816  3 001077   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 001100   001107 600000 3                  TZE     s:8821

      349     8817    2            IF DCBADDR(%M$DRIBBLE#)->F$DCB.FCD# THEN

PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:56   
   8817  3 001101   577777 473500                    LDP3    -1,,PR5
         3 001102   300031 236100                    LDQ     25,,PR3
         3 001103   020000 316007                    CANQ    8192,DL
         3 001104   001260 600000 3                  TZE     s:8840

      350     8818    2               RETURN;

   8818  3 001105   200040 221300                    LDX1  ! CRLF+2,,AUTO
         3 001106   000001 702211                    TSX2  ! 1,X1

      351     8819    2            ELSE;
      352     8820    3         ELSE DO;

      353     8821    3            I=SIZEW(PROMPT)+3+POFFW(ADDR(DCB$->F$DCB.DCBNAME),DCB$);

   8821  3 001107   200006 236100                    LDQ     DCB$,,AUTO
         3 001110   000140 036003                    ADLQ    96,DU
         3 001111   000022 772000                    QRL     18
         3 001112   200006 235100                    LDA     DCB$,,AUTO
         3 001113   000022 771000                    ARL     18
         3 001114   200042 755100                    STA     CRLF+4,,AUTO
         3 001115   200042 136100                    SBLQ    CRLF+4,,AUTO
         3 001116   000036 036007                    ADLQ    30,DL
         3 001117   200024 756100                    STQ     I,,AUTO

      354     8822    3            CALL FSA$GSP(I,B$ROSEG$->B$ROSEG.DCBPTR$->DCBP$(DRIBDCB#)) ALTRET(OPNERR);

   8822  3 001120   100000 473500                    LDP3    0,,PR1
         3 001121   000277 720000 1                  LXL0    DRIBDCB#
         3 001122   300000 636510                    EPPR6   0,X0,PR3
         3 001123   200043 456500                    STP6    CRLF+5,,AUTO
         3 001124   200024 633500                    EPPR3   I,,AUTO
         3 001125   200042 453500                    STP3    CRLF+4,,AUTO
         3 001126   200042 630500                    EPPR0   CRLF+4,,AUTO
         3 001127   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001130   000000 701000 xent               TSX1    FSA$GSP
         3 001131   001277 702000 3                  TSX2    OPNERR
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:57   

      355     8823    3            I=I*4;

   8823  3 001132   200024 235100                    LDA     I,,AUTO
         3 001133   000002 735000                    ALS     2
         3 001134   200024 755100                    STA     I,,AUTO

      356     8824    3            DCBADDR(%M$DRIBBLE#)->DCB0='0'B;

   8824  3 001135   000003 470400 4                  LDP0    3
         3 001136   000000 471500                    LDP1    0,,PR0
         3 001137   177777 473500                    LDP3    -1,,PR1
         3 001140   000000 620005                    EAX0    0,AL
         3 001141   000140 100400                    MLR     fill='000'O
         3 001142   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         3 001143   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0

      357     8825    3            DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME.L=4;

   8825  3 001144   300140 236100                    LDQ     96,,PR3
         3 001145   000020 376000 4                  ANQ     16
         3 001146   004000 276003                    ORQ     2048,DU
         3 001147   300140 756100                    STQ     96,,PR3

      358     8826    3            DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME.N='M$DR';

   8826  3 001150   300140 236100                    LDQ     96,,PR3
         3 001151   000033 772000                    QRL     27
         3 001152   000037 376007                    ANQ     31,DL
         3 001153   000000 620006                    EAX0    0,QL
         3 001154   040140 100400                    MLR     fill='040'O
         3 001155   000313 000004 1                  ADSC9   DRIBDCB2#+11             cn=0,n=4
         3 001156   300140 200010                    ADSC9   96,,PR3                  cn=1,n=*X0

      359     8827    3            B$JIT$->B$JIT.DCB$=DCBADDR(%M$DRIBBLE#);

   8827  3 001157   177777 236100                    LDQ     -1,,PR1
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:58   
         3 001160   000000 474400 xsym               LDP4    B$JIT$
         3 001161   400232 756100                    STQ     154,,PR4

      360     8828    3            CALL FMM$SCRUB1(DCBADDR(%M$DRIBBLE#));

   8828  3 001162   177777 635500                    EPPR5   -1,,PR1
         3 001163   200042 455500                    STP5    CRLF+4,,AUTO
         3 001164   200042 630500                    EPPR0   CRLF+4,,AUTO
         3 001165   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001166   000000 701000 xent               TSX1    FMM$SCRUB1
         3 001167   000000 011000                    NOP     0

      361     8829    3            B$ROSEG$->B$ROSEG.DCBPTR$->DCBP$(%M$LM#)=DCBADDR(%M$DRIBBLE#);

   8829  3 001170   000000 470400 xsym               LDP0    B$ROSEG$
         3 001171   000000 471500                    LDP1    0,,PR0
         3 001172   000003 473400 4                  LDP3    3
         3 001173   300000 474500                    LDP4    0,,PR3
         3 001174   477777 236100                    LDQ     -1,,PR4
         3 001175   100002 756100                    STQ     2,,PR1

      362     8830    4            DO I = 0 TO 2;

   8830  3 001176   200024 450100                    STZ     I,,AUTO

      363     8831    4               PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)->PROMPT(I)='0'B;

   8831  3 001177   000003 470400 4                  LDP0    3
         3 001200   000000 471500                    LDP1    0,,PR0
         3 001201   177777 473500                    LDP3    -1,,PR1
         3 001202   200024 236100                    LDQ     I,,AUTO
         3 001203   000044 402007                    MPY     36,DL
         3 001204   000106 100400                    MLR     fill='000'O
         3 001205   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         3 001206   300143 000044                    ADSC9   99,Q,PR3                 cn=0,n=36

      364     8832    4               PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)->PROMPT.LN(I)=1;
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:59   

   8832  3 001207   200024 236100                    LDQ     I,,AUTO
         3 001210   000011 402007                    MPY     9,DL
         3 001211   000000 620006                    EAX0    0,QL
         3 001212   300143 236106                    LDQ     99,QL,PR3
         3 001213   000021 376000 4                  ANQ     17
         3 001214   001000 276007                    ORQ     512,DL
         3 001215   300143 756110                    STQ     99,X0,PR3

      365     8833    4               PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)->PROMPT.TXT.VFC(I)=
              8833                        SUBSTR(PRMPTVFC,I,1);

   8833  3 001216   200024 236100                    LDQ     I,,AUTO
         3 001217   000011 402007                    MPY     9,DL
         3 001220   000002 736000                    QLS     2
         3 001221   200024 235100                    LDA     I,,AUTO
         3 001222   040106 100405                    MLR     fill='040'O
         3 001223   000275 000001 1                  ADSC9   PRMPTVFC,A               cn=0,n=1
         3 001224   300143 600001                    ADSC9   99,Q,PR3                 cn=3,n=1

      366     8834    4               PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)->PROMPT.TRNS0(I)=
              8834                        PRMPTTRNS(I);

   8834  3 001225   200024 236100                    LDQ     I,,AUTO
         3 001226   000011 402007                    MPY     9,DL
         3 001227   000002 736000                    QLS     2
         3 001230   200024 235100                    LDA     I,,AUTO
         3 001231   000106 100405                    MLR     fill='000'O
         3 001232   000276 000001 1                  ADSC9   PRMPTTRNS,A              cn=0,n=1
         3 001233   300143 000001                    ADSC9   99,Q,PR3                 cn=0,n=1

      367     8835    4               PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)->PROMPT.TXT.M(I)=
              8835                        PRMPT(I);

   8835  3 001234   200024 235100                    LDA     I,,AUTO
         3 001235   000001 735000                    ALS     1
         3 001236   200024 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:60   
         3 001237   200042 755100                    STA     CRLF+4,,AUTO
         3 001240   000044 402007                    MPY     36,DL
         3 001241   200042 235100                    LDA     CRLF+4,,AUTO
         3 001242   040106 100405                    MLR     fill='040'O
         3 001243   000273 000002 1                  ADSC9   PRMPT,A                  cn=0,n=2
         3 001244   300144 000040                    ADSC9   100,Q,PR3                cn=0,n=32

      368     8836    4               END;

   8836  3 001245   200024 235100                    LDA     I,,AUTO
         3 001246   000001 035007                    ADLA    1,DL
         3 001247   200024 755100                    STA     I,,AUTO
         3 001250   000003 115007                    CMPA    3,DL
         3 001251   001177 602000 3                  TNC     s:8831

      369     8837    3            IF B$JIT$->B$JIT.CPFLAGS1 & %CP_YC# THEN

   8837  3 001252   000000 474400 xsym               LDP4    B$JIT$
         3 001253   400143 236100                    LDQ     99,,PR4
         3 001254   000314 376000 1                  ANQ     DRIBDCB2#+12
         3 001255   001260 600000 3                  TZE     s:8840

      370     8838    3               PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)->PROMPT.LN(0)=2;

   8838  3 001256   002000 236007                    LDQ     1024,DL
         3 001257   300143 552110                    STBQ    99,'10'O,PR3

      371     8839    3            END;

      372     8840    2         IF B$JIT$->B$JIT.CPFLAGS1 & %CP_DRIBBLE# THEN

   8840  3 001260   000000 470400 xsym               LDP0    B$JIT$
         3 001261   000143 236100                    LDQ     99,,PR0
         3 001262   000301 376000 1                  ANQ     DRIBDCB2#+1
         3 001263   001271 600000 3                  TZE     s:8843

      373     8841    2            CALL M$MOPEN (EXDRIB) ALTRET(OPNERR);
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:61   

   8841  3 001264   000022 630400 4                  EPPR0   18
         3 001265   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001266   000000 701000 xent               TSX1    M$MOPEN
         3 001267   001277 702000 3                  TSX2    OPNERR
         3 001270   001275 710000 3                  TRA     s:8844

      374     8842    2         ELSE
      375     8843    2            CALL M$MOPEN (OPDRIB) ALTRET(OPNERR);

   8843  3 001271   000023 630400 4                  EPPR0   19
         3 001272   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001273   000000 701000 xent               TSX1    M$MOPEN
         3 001274   001277 702000 3                  TSX2    OPNERR

      376     8844    2         RETURN;

   8844  3 001275   200040 221300                    LDX1  ! CRLF+2,,AUTO
         3 001276   000001 702211                    TSX2  ! 1,X1

      377     8845    2   OPNERR: ALTRETURN;

   8845  3 001277   200040 221300       OPNERR       LDX1  ! CRLF+2,,AUTO
         3 001300   000000 702211                    TSX2  ! 0,X1

      378     8846    2   END CHKOPN;
      379     8847        %EJECT;
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:62   
      380     8848    1   UMD$DBPRMT: ENTRY(VPMT,LN) ALTRET;

   8848  3 001301   000000 700200 xent  UMD$DBPRMT   TSX0  ! X66_AUTO_2
         3 001302   000046 000002                    ZERO    38,2

      381     8849        /*   Save prompt string and VFC if dribbling                          */
      382     8850        /**/
      383     8851    1         CALL CHKOPN ALTRET(DRIBERR);

   8851  3 001303   001060 701000 3                  TSX1    CHKOPN
         3 001304   001011 702000 3                  TSX2    DRIBERR

      384     8852    1         I = VPMT.PFB;

   8852  3 001305   200003 470500                    LDP0    @VPMT,,AUTO
         3 001306   000100 101500                    MRL     fill='000'O
         3 001307   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         3 001310   200024 000004                    ADSC9   I,,AUTO                  cn=0,n=4

      385     8853    1         IF I > 0 THEN I = I - 1;

   8853  3 001311   200024 235100                    LDA     I,,AUTO
         3 001312   001315 600000 3                  TZE     s:8854

   8853  3 001313   000001 135007                    SBLA    1,DL
         3 001314   200024 755100                    STA     I,,AUTO

      386     8854    1         IF I > 2 THEN GOTO DRIBXIT;

   8854  3 001315   000003 115007                    CMPA    3,DL
         3 001316   000623 603000 3                  TRC     DRIBXIT

      387     8855    1         PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)

   8855  3 001317   000003 471400 4                  LDP1    3
         3 001320   100000 473500                    LDP3    0,,PR1
         3 001321   377777 474500                    LDP4    -1,,PR3
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:63   
         3 001322   200024 236100                    LDQ     I,,AUTO
         3 001323   000011 402007                    MPY     9,DL
         3 001324   000002 736000                    QLS     2
         3 001325   000106 100500                    MLR     fill='000'O
         3 001326   000000 200001                    ADSC9   0,,PR0                   cn=1,n=1
         3 001327   400143 200001                    ADSC9   99,Q,PR4                 cn=1,n=1

      388     8856    1            ->PROMPT.DVBYTE(I)=VPMT.DVBYTE;
      389     8857    1         IF ASCBIN(VPMT.VFC) >= BITBIN('160'O) THEN

   8857  3 001330   000100 101500                    MRL     fill='000'O
         3 001331   000000 400001                    ADSC9   0,,PR0                   cn=2,n=1
         3 001332   200042 000004                    ADSC9   CRLF+4,,AUTO             cn=0,n=4
         3 001333   200042 236100                    LDQ     CRLF+4,,AUTO
         3 001334   000160 116007                    CMPQ    112,DL
         3 001335   001367 602000 3                  TNC     s:8867

      390     8858    2         DO;

      391     8859    2            PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)

   8859  3 001336   200024 236100                    LDQ     I,,AUTO
         3 001337   000011 402007                    MPY     9,DL
         3 001340   000000 620006                    EAX0    0,QL
         3 001341   400143 236106                    LDQ     99,QL,PR4
         3 001342   000032 376000 xsym               ANQ     B_VECTNIL+26
         3 001343   400000 276003                    ORQ     -131072,DU
         3 001344   400143 756110                    STQ     99,X0,PR4

      392     8860    2               ->PROMPT.TRNS0(I) = '1'B;
      393     8861    2            PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)

   8861  3 001345   200024 236100                    LDQ     I,,AUTO
         3 001346   000011 402007                    MPY     9,DL
         3 001347   000100 100500                    MLR     fill='000'O
         3 001350   000000 400001                    ADSC9   0,,PR0                   cn=2,n=1
         3 001351   200042 000004                    ADSC9   CRLF+4,,AUTO             cn=0,n=4
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:64   
         3 001352   000000 620006                    EAX0    0,QL
         3 001353   200042 236100                    LDQ     CRLF+4,,AUTO
         3 001354   000022 772000                    QRL     18
         3 001355   000000 621006                    EAX1    0,QL
         3 001356   017000 361003                    ANX1    7680,DU
         3 001357   140000 261003                    ORX1    49152,DU
         3 001360   000000 636011                    EAQ     0,X1
         3 001361   000024 276000 4                  ORQ     20
         3 001362   000033 772000                    QRL     27
         3 001363   400143 676110                    ERQ     99,X0,PR4
         3 001364   000777 376007                    ANQ     511,DL
         3 001365   400143 656110                    ERSQ    99,X0,PR4

      394     8862    2               ->PROMPT.TXT.VFC(I) = BITASC((ASCBIT(VPMT.VFC) & '017'O)
      395     8863    2               | '140'O);
      396     8864    2            END;

   8864  3 001366   001402 710000 3                  TRA     s:8872

      397     8865    1         ELSE
      398     8866    2         DO;

      399     8867    2            PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)

   8867  3 001367   200024 236100                    LDQ     I,,AUTO
         3 001370   000011 402007                    MPY     9,DL
         3 001371   000000 620006                    EAX0    0,QL
         3 001372   000032 236000 xsym               LDQ     B_VECTNIL+26
         3 001373   400143 356110                    ANSQ    99,X0,PR4

      400     8868    2               ->PROMPT.TRNS0(I) = '0'B;
      401     8869    2            PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)

   8869  3 001374   200024 236100                    LDQ     I,,AUTO
         3 001375   000011 402007                    MPY     9,DL
         3 001376   000002 736000                    QLS     2
         3 001377   040106 100500                    MLR     fill='040'O
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:65   
         3 001400   000000 400001                    ADSC9   0,,PR0                   cn=2,n=1
         3 001401   400143 600001                    ADSC9   99,Q,PR4                 cn=3,n=1

      402     8870    2               ->PROMPT.TXT.VFC(I) = VPMT.VFC;
      403     8871    2            END;

      404     8872    1         PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)

   8872  3 001402   200024 236100                    LDQ     I,,AUTO
         3 001403   000044 402007                    MPY     36,DL
         3 001404   040106 100500                    MLR     fill='040'O
         3 001405   000000 600040                    ADSC9   0,,PR0                   cn=3,n=32
         3 001406   400144 000040                    ADSC9   100,Q,PR4                cn=0,n=32

      405     8873    1            ->PROMPT.TXT.M(I)=VPMT.M;
      406     8874    1         PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)

   8874  3 001407   200024 236100                    LDQ     I,,AUTO
         3 001410   000011 402007                    MPY     9,DL
         3 001411   200004 475500                    LDP5    @LN,,AUTO
         3 001412   000000 620006                    EAX0    0,QL
         3 001413   500000 236100                    LDQ     0,,PR5
         3 001414   000011 736000                    QLS     9
         3 001415   400143 676110                    ERQ     99,X0,PR4
         3 001416   777000 376007                    ANQ     -512,DL
         3 001417   400143 656110                    ERSQ    99,X0,PR4

      407     8875    1            ->PROMPT.LN(I)=LN;
      408     8876    1         GOTO DRIBXIT;

   8876  3 001420   000623 710000 3                  TRA     DRIBXIT

      409     8877        %EJECT;
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:66   
      410     8878    1   UMD$SVPRMPT: ENTRY (VPMT) ALTRET;

   8878  3 001421   000000 700200 xent  UMD$SVPRMPT  TSX0  ! X66_AUTO_2
         3 001422   000046 000002                    ZERO    38,2

      411     8879        /*  Return current prompt info to caller                              */
      412     8880
      413     8881    1         CALL CHKOPN ALTRET(DRIBERR);

   8881  3 001423   001060 701000 3                  TSX1    CHKOPN
         3 001424   001011 702000 3                  TSX2    DRIBERR

      414     8882    1         ADDR(VPMT)->PROMPT = PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME)

   8882  3 001425   000003 470400 4                  LDP0    3
         3 001426   000000 471500                    LDP1    0,,PR0
         3 001427   177777 473500                    LDP3    -1,,PR1
         3 001430   200003 474500                    LDP4    @VPMT,,AUTO
         3 001431   000100 100500                    MLR     fill='000'O
         3 001432   300143 000154                    ADSC9   99,,PR3                  cn=0,n=108
         3 001433   400000 000154                    ADSC9   0,,PR4                   cn=0,n=108

      415     8883    1            ,3)->PROMPT;
      416     8884    1         GOTO DRIBXIT;

   8884  3 001434   000623 710000 3                  TRA     DRIBXIT

      417     8885
      418     8886    1   UMD$RSTRPRMPT: ENTRY (VPMT) ALTRET;

   8886  3 001435   000000 700200 xent  UMD$RSTRPRM* TSX0  ! X66_AUTO_2
         3 001436   000046 000002                    ZERO    38,2

      419     8887        /* Get prompt info from caller                                        */
      420     8888
      421     8889    1         CALL CHKOPN ALTRET(DRIBERR);

PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:67   
   8889  3 001437   001060 701000 3                  TSX1    CHKOPN
         3 001440   001011 702000 3                  TSX2    DRIBERR

      422     8890    1         PINCRW(ADDR(DCBADDR(%M$DRIBBLE#)->F$DCB.DCBNAME),3)->PROMPT =

   8890  3 001441   000003 470400 4                  LDP0    3
         3 001442   000000 471500                    LDP1    0,,PR0
         3 001443   177777 473500                    LDP3    -1,,PR1
         3 001444   200003 474500                    LDP4    @VPMT,,AUTO
         3 001445   000100 100500                    MLR     fill='000'O
         3 001446   400000 000154                    ADSC9   0,,PR4                   cn=0,n=108
         3 001447   300143 000154                    ADSC9   99,,PR3                  cn=0,n=108

      423     8891    1            ADDR(VPMT)->PROMPT;
      424     8892    1         GOTO DRIBXIT;

   8892  3 001450   000623 710000 3                  TRA     DRIBXIT

      425     8893    1   UMD$CHKOPN: ENTRY ALTRET;

   8893  3 001451   000000 700200 xent  UMD$CHKOPN   TSX0  ! X66_AUTO_2
         3 001452   000046 000002                    ZERO    38,2

      426     8894        /*   Make sure the Dribble DCB is there and opened.                   */
      427     8895
      428     8896    1         IF B$JIT$->B$JIT.CPFLAGS1 & %CP_DRIBBLE# THEN

   8896  3 001453   000000 470400 xsym               LDP0    B$JIT$
         3 001454   000143 236100                    LDQ     99,,PR0
         3 001455   000301 376000 1                  ANQ     DRIBDCB2#+1
         3 001456   001462 600000 3                  TZE     s:8901

      429     8897    2         DO;

      430     8898    2            CALL CHKOPN;

   8898  3 001457   001060 701000 3                  TSX1    CHKOPN
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:68   
         3 001460   000000 011000                    NOP     0

      431     8899    2            GOTO DRIBXIT;

   8899  3 001461   000623 710000 3                  TRA     DRIBXIT

      432     8900    2            END;
      433     8901    1         RETURN;

   8901  3 001462   000000 702200 xent               TSX2  ! X66_ARET

ERRWRWOKEY
 Sect OctLoc
   1     000   061506 401012                                                    1...

ERRDRIBINTOKEYED
 Sect OctLoc
   1     001   251504 415272                                                    ....

EXDRIB
 Sect OctLoc
   1     002   000025 777640   000046 006000   000000 177640   000000 006014    .....&..........
   1     006   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     046*  000000 200442   000000 003000   252525 000000   000040 252520    ............. ..
   1     052   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   1     056   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     062   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   1     066   040040 040040   000000 000000   000000 000000   000000 000000        ............
   1     072   000000 000000   ****** ******                                    ........

OPDRIB
 Sect OctLoc
   1     074   000025 777640   000140 006000   000000 177640   000000 006014    .....`..........
   1     100   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     140*  000000 200042   000000 000000   252525 000000   000040 252520    ..."......... ..
   1     144   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   1     150   000000 000000   000000 000000   000000 000000   000000 000000    ................
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:69   
   1     154   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   1     160   040040 040040   000000 000000   000000 000000   000000 000000        ............
   1     164   000000 000000   ****** ******                                    ........

CLDRIB
 Sect OctLoc
   1     166   000003 777640   000220 006000   000000 177640   000000 006014    ................
   1     172   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     216*  000000 177640   000000 006014   000000 000002   000000 000040    ...............
   1     222   000220 000000   000000 000000                                    ........

WRA
 Sect OctLoc
   1     224   000003 777640   000234 006000   000000 177640   000000 006014    ................
   1     230   000000 177640   000270 006000   000000 177640   000000 006014    ................
   1     234   000000 400400   000000 000000   000000 000000   100000 000000    ............@...

WRTRNS0
 Sect OctLoc
   1     240   000003 777640   000250 006000   000000 177640   000000 006014    ................
   1     244   000000 177640   000272 006000   000000 177640   000000 006014    ................
   1     250   000000 400400   000000 000000   000000 000000   100000 000000    ............@...

WRUCREC
 Sect OctLoc
   1     254   000003 777640   000264 006000   000000 177640   000000 006014    ................
   1     260   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     264   000000 400400   000000 000000   000000 000000   000000 000000    ................

AVFC
 Sect OctLoc
   1     270   101*** ******                                                    A...

ATVFC
 Sect OctLoc
   1     271   100*** ******                                                    @...

PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:70   
TVFC
 Sect OctLoc
   1     272   036*** ******                                                    ....

PRMPT
 Sect OctLoc
   1     273   041041 052040   077040 ******                                    !!* ? ..

PRMPTVFC
 Sect OctLoc
   1     275   100100 100***                                                    @@@.

PRMPTTRNS
 Sect OctLoc
   1     276   400000 000***                                                    ....

DRIBDCB#
 Sect OctLoc
   1     277   777777 777777                                                    ....

DRIBDCB2#
 Sect OctLoc
   1     300   777777 777775                                                    ....

(unnamed)
 Sect OctLoc
   1     301   000000 100000   104122 111102   102114 105040   117116 040100    ..@.DRIBBLE ON @
   1     305   040040 040040   104122 111102   102114 105040   117106 106040        DRIBBLE OFF
   1     311   100040 040040   004000 000000   115044 104122   040000 000000    @   ....M$DR ...

(unnamed)
 Sect OctLoc
   4     000   000030 400000   000006 777640   000003 777640   000000 006003    ................
   4     004   000166 006000   000240 006000   000224 006000   000000 000000    .v..............
   4     010   000000 177640   000271 006000   677777 777777   776777 777777    ................
   4     014   000003 600000   000777 600000   000000 177640   000270 006000    ................
   4     020   740777 777777   777777 000777   000002 006000   000074 006000    .............<..
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:71   
   4     024   000040 040040                                                    .
      434     8902    1   END;

PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:72   
--  Include file information  --

   F_MACROS_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   UM_ERRORS_C.:E05TOU  is referenced.
   UD_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   KI$CP6V_C.:E05TOU  is referenced.
   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure UMD$DRIBBLE.
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:73   

 **** Variables and constants ****

  ****  Section 001 RoData UMD$DRIBBLE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   271-0-0/c CHAR        r     1 ATVFC                    270-0-0/c CHAR        r     1 AVFC
   166-0-0/d STRC(1080)  r     1 CLDRIB                   277-0-0/w SBIN        r     1 DRIBDCB#
   300-0-0/w SBIN        r     1 DRIBDCB2#                  1-0-0/b STRC        r     1 ERRDRIBINTOKEYED
     0-0-0/b STRC        r     1 ERRWRWOKEY                 2-0-0/d STRC(2088)  r     1 EXDRIB
    74-0-0/d STRC(2088)  r     1 OPDRIB                   273-0-0/c CHAR(2)     r     1 PRMPT(0:2)
   276-0-0/b BIT (9)     r     1 PRMPTTRNS(0:2)
   275-0-0/c CHAR(3)     r     1 PRMPTVFC                 272-0-0/c CHAR        r     1 TVFC
   224-0-0/d STRC(432)   r     1 WRA                      240-0-0/d STRC(432)   r     1 WRTRNS0
   254-0-0/d STRC(432)   r     1 WRUCREC

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @LN                        3-0-0/w PTR         r     1 @VPMT
    36-0-0/b BIT         r     1 CRLF                       6-0-0/w PTR         r     1 DCB$
     5-0-0/w SBIN        r     1 DCBNR                     25-0-0/c STRC(252)   r     1 DRIBON
     7-0-0/b BIT         r     1 ERR                       24-0-0/w UBIN        r     1 I
    *0-0-0/w UBIN        r     1 LN                        35-0-0/b BIT         r     1 PRINTABLE
    *0-0-0/c STRC(315)   r     1 VPMT                      10-0-0/d STRC(432)   r     1 WR

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$M$LM$
     0-0-0/w PTR         r     1 B$PS0$                     0-0-0/w PTR         r     1 B$ROSEG$

PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:74   
  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/d STRC(3024)  r     1 B$ROSEG
     0-0-0/c ASTR(0)     r     1 DCB0                       0-0-0/w PTR         r     1 DCBP$(0:0)
     0-0-0/c BIT (9)     r     1 DVBYTE                     0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/d STRC        r     1 FPT$DRIBBLE_V              0-0-0N  NULL        r     1 M$LM
     0-0-0/w STRC(324)   r     1 PROMPT(0:2)                0-0-0/w BIT         r     1 TYC
     0-0-0/c CHAR        r     1 VFC


   Procedure UMD$DRIBBLE requires 819 words for executable code.
   Procedure UMD$DRIBBLE requires 38 words of local(AUTO) storage.

    No errors detected in file UMD$DRIBBLE.:E05TSI    .
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:75   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:76   
          MINI XREF LISTING

ATVFC
      8535**DCL      8714--ASSIGN
AVFC
      8534**DCL      8378--DCLINIT  8379--DCLINIT  8734--ASSIGN
B$JIT.CPFLAGS1
      7945**DCL      8566>>IF       8585<<ASSIGN   8585>>ASSIGN   8588>>IF       8598<<ASSIGN   8598>>ASSIGN
      8603<<ASSIGN   8603>>ASSIGN   8623<<ASSIGN   8623>>ASSIGN   8783<<ASSIGN   8783>>ASSIGN   8802<<ASSIGN
      8802>>ASSIGN   8837>>IF       8840>>IF       8896>>IF
B$JIT.CPFLAGS1.SLEAZE
      7950**DCL      7950--REDEF
B$JIT.DCB$
      8017**DCL      8559<<ASSIGN   8742<<ASSIGN   8812>>ASSIGN   8827<<ASSIGN
B$JIT.DCBNO
      7937**DCL      8560<<ASSIGN   8743<<ASSIGN   8813>>ASSIGN
B$JIT.ERR
      7856**DCL      8576>>IF       8577<<ASSIGN   8599>>ASSIGN   8605>>ASSIGN   8607<<ASSIGN   8744<<ASSIGN
      8814>>ASSIGN
B$JIT.ERR.MID
      7857**DCL      7857--REDEF
B$JIT$
      8544**DCL      7851--IMP-PTR  8559>>ASSIGN   8560>>ASSIGN   8566>>IF       8576>>IF       8577>>ASSIGN
      8585>>ASSIGN   8585>>ASSIGN   8588>>IF       8598>>ASSIGN   8598>>ASSIGN   8599>>ASSIGN   8603>>ASSIGN
      8603>>ASSIGN   8605>>ASSIGN   8607>>ASSIGN   8623>>ASSIGN   8623>>ASSIGN   8742>>ASSIGN   8743>>ASSIGN
      8744>>ASSIGN   8783>>ASSIGN   8783>>ASSIGN   8802>>ASSIGN   8802>>ASSIGN   8812>>ASSIGN   8813>>ASSIGN
      8814>>ASSIGN   8827>>ASSIGN   8837>>IF       8840>>IF       8896>>IF
B$M$LM$
      8482**DCL      8614>>ASSIGN   8741>>ASSIGN
B$PS0$
      8545**DCL      8563>>IF       8597>>IF
B$ROSEG.DCBPTR$
        20**DCL      8564>>ASSIGN   8564>>ASSIGN   8612>>ASSIGN   8614>>ASSIGN   8741>>ASSIGN   8789>>ASSIGN
      8807>>ASSIGN   8815>>ASSIGN   8822>>CALL     8829>>ASSIGN
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:77   
B$ROSEG$
      8543**DCL      8564>>ASSIGN   8564>>ASSIGN   8612>>ASSIGN   8614>>ASSIGN   8741>>ASSIGN   8789>>ASSIGN
      8807>>ASSIGN   8815>>ASSIGN   8822>>CALL     8829>>ASSIGN
CHKOPN
      8811**PROC     8569--CALL     8590--CALL     8632--CALL     8681--CALL     8747--CALL     8851--CALL
      8881--CALL     8889--CALL     8898--CALL
CLDRIB
      8341**DCL      8600<>CALL     8606<>CALL     8804<>CALL
CLDRIB.SN_
      8341**DCL      8341--REDEF
CLDRIB.UTL_
      8342**DCL      8342--REDEF
CLDRIB.V
      8346**DCL      8341--DCLINIT
CLDRIB.V.EXPIRE#
      8356**DCL      8356--REDEF
CLDRIB.V.TYPE#
      8354**DCL      8354--REDEF
CLDRIB.V.XTNSIZE#
      8351**DCL      8351--REDEF    8353--REDEF
CLOSE1
      8607**LABEL    8600--CALLALT  8606--CALLALT
CLOSEIT
      8603**LABEL    8578--GOTO     8791--GOTO
CRLF
      8533**DCL      8693<<ASSIGN   8696<<ASSIGN   8733>>IF
DCB$
      8484**DCL      8609<<ASSIGN   8610>>ASSIGN   8610>>ASSIGN   8611<>CALL     8686>>IF       8686>>IF
      8689>>IF       8697>>IF       8697>>IF       8697>>IF       8697>>IF       8700>>IF       8704>>IF
      8720>>ASSIGN   8721>>ASSIGN   8729>>ASSIGN   8742>>ASSIGN   8755>>IF       8767>>IF       8770>>ASSIGN
      8771>>IF       8774>>ASSIGN   8805>>ASSIGN   8805>>ASSIGN   8812<<ASSIGN   8821>>ASSIGN   8821>>ASSIGN
DCB0
      8522**DCL      8824<<ASSIGN
DCBNR
      8483**DCL      8743>>ASSIGN   8813<<ASSIGN
DCBP$
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:78   
      8519**DCL      8564<<ASSIGN   8564>>ASSIGN   8612<<ASSIGN   8614<<ASSIGN   8741<<ASSIGN   8789<<ASSIGN
      8807<<ASSIGN   8815<<ASSIGN   8822<>CALL     8829<<ASSIGN
DIN1
      8725**LABEL    8701--GOTO
DOU1
      8768**LABEL    8759--GOTO
DRIBDCB#
      8541**DCL      8612>>ASSIGN   8807>>ASSIGN   8822>>CALL
DRIBDCB2#
      8542**DCL      8564>>ASSIGN
DRIBER1
      8805**LABEL    8804--CALLALT
DRIBERR
      8802**LABEL    8632--CALLALT  8638--CALLALT  8647--CALLALT  8681--CALLALT  8690--CALLALT  8715--CALLALT
      8722--CALLALT  8730--CALLALT  8736--CALLALT  8747--CALLALT  8766--CALLALT  8775--CALLALT  8851--CALLALT
      8881--CALLALT  8889--CALLALT
DRIBOFF
      8603**LABEL    8596--CALLALT  8621--GOTO
DRIBON
      8524**DCL      8572--ASSIGN   8593--ASSIGN
DRIBON.DATE
      8528**DCL      8561<>CALL
DRIBON.TIME
      8526**DCL      8561<>CALL
DRIBON.TXT
      8525**DCL      8570<<ASSIGN   8591<<ASSIGN
DRIBON.X
      8527**DCL      8562<<ASSIGN
DRIBXIT
      8734**LABEL    8635--GOTO     8649--GOTO     8691--GOTO     8705--GOTO     8778--GOTO     8809--GOTO
      8854--GOTO     8876--GOTO     8884--GOTO     8892--GOTO     8899--GOTO
DVBYTE
      8520**DCL      8753>>ASSIGN
ERR
      8485**DCL      8599<<ASSIGN   8605<<ASSIGN   8607>>ASSIGN   8744>>ASSIGN   8814<<ASSIGN
ERRDRIBINTOKEYED
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:79   
      8095**DCL      8577>>ASSIGN
ERRWRWOKEY
      8091**DCL      8576>>IF
EXDRIB
      8164**DCL      8841<>CALL
EXDRIB.ACSVEH_
      8166**DCL      8167--REDEF
EXDRIB.ALTKEYS_
      8172**DCL      8173--REDEF    8173--REDEF
EXDRIB.HDR_
      8171**DCL      8172--REDEF
EXDRIB.TAB_
      8170**DCL      8171--REDEF
EXDRIB.UHL_
      8164**DCL      8165--REDEF    8165--REDEF
EXDRIB.V
      8173**DCL      8164--DCLINIT
EXDRIB.V.FSN#
      8204**DCL      8204--REDEF    8204--REDEF
EXDRIB.WSN_
      8170**DCL      8170--REDEF
F$DCB.ACTPOS
      8063**DCL      8063--REDEF
F$DCB.ARS#
      8037**DCL      8037--REDEF    8689>>IF       8700>>IF       8704>>IF       8721>>ASSIGN
F$DCB.ATTR
      8056**DCL      8057--REDEF
F$DCB.BORROW
      8071**DCL      8071--REDEF    8071--REDEF    8071--REDEF
F$DCB.DCBNAME
      8084**DCL      8610--ASSIGN   8636--IF       8642--ASSIGN   8645--ASSIGN   8646--ASSIGN   8805--ASSIGN
      8821--ASSIGN   8831--ASSIGN   8832--ASSIGN   8833--ASSIGN   8834--ASSIGN   8835--ASSIGN   8838--ASSIGN
      8855--ASSIGN   8859--ASSIGN   8861--ASSIGN   8867--ASSIGN   8869--ASSIGN   8872--ASSIGN   8874--ASSIGN
      8882--ASSIGN   8890--ASSIGN
F$DCB.DCBNAME.L
      8085**DCL      8085--IMP-SIZ  8825<<ASSIGN   8826>>ASSIGN
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:80   
F$DCB.DCBNAME.N
      8085**DCL      8826<<ASSIGN
F$DCB.DDEV
      8043**DCL      8709>>IF       8725>>IF       8756>>IF
F$DCB.DDEV.UCOUT#
      8044**DCL      8574>>IF       8595>>IF       8633>>IF       8682>>IF       8748>>IF
F$DCB.DVFC#
      8059**DCL      8710<<ASSIGN   8726<<ASSIGN   8757<<ASSIGN
F$DCB.EOMCHAR#
      8041**DCL      8041--REDEF    8686>>IF       8686>>IF       8697>>IF       8697>>IF       8697>>IF
      8697>>IF       8729--ASSIGN
F$DCB.FCD#
      8050**DCL      8790>>IF       8817>>IF
F$DCB.FLDID
      8066**DCL      8066--REDEF
F$DCB.FORM$
      8060**DCL      8060--REDEF
F$DCB.FSECT
      8076**DCL      8076--REDEF
F$DCB.FSN#
      8053**DCL      8053--REDEF    8053--REDEF    8054--REDEF
F$DCB.HEADER$
      8059**DCL      8059--REDEF
F$DCB.IXTNSIZE#
      8057**DCL      8057--REDEF
F$DCB.LASTSTA$
      8046**DCL      8046--REDEF
F$DCB.LVL
      8072**DCL      8072--REDEF
F$DCB.NAME#.C
      8047**DCL      8047--REDEF
F$DCB.NOEOF
      8069**DCL      8069--REDEF
F$DCB.NRECS#
      8058**DCL      8058--REDEF
F$DCB.NRECX
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:81   
      8077**DCL      8077--REDEF
F$DCB.OHDR
      8069**DCL      8069--REDEF
F$DCB.ORG#
      8052**DCL      8052--REDEF
F$DCB.PRECNO
      8075**DCL      8075--REDEF
F$DCB.RCSZ
      8081**DCL      8081--REDEF
F$DCB.RES#
      8048**DCL      8048--REDEF
F$DCB.SETX
      8060**DCL      8060--REDEF
F$DCB.TAB$
      8060**DCL      8060--REDEF
F$DCB.TDA
      8074**DCL      8075--REDEF
F$DCB.UB$
      8076**DCL      8720>>ASSIGN   8770>>ASSIGN
F$DCB.UBYTES
      8076**DCL      8755>>IF       8767>>IF       8771>>IF       8774>>ASSIGN
F$DCB.WSN#
      8048**DCL      8048--REDEF
FMM$SCRUB1
      8554**DCL-ENT  8828--CALL
FMO$GETPFB
      8551**DCL-ENT  8634--CALL
FPT$DRIBBLE_V.DRIBBLE
      8088**DCL      8563>>IF       8597>>IF
FSA$FSP
      8553**DCL-ENT  8611--CALL     8806--CALL
FSA$GSP
      8552**DCL-ENT  8822--CALL
I
      8517**DCL      8523--IMP-SIZ  8610<<ASSIGN   8611<>CALL     8634<>CALL     8635>>IF       8636>>IF
      8642>>ASSIGN   8645>>ASSIGN   8646>>ASSIGN   8805<<ASSIGN   8806<>CALL     8821<<ASSIGN   8822<>CALL
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:82   
      8823<<ASSIGN   8823>>ASSIGN   8824>>ASSIGN   8830<<DOINDEX  8831>>ASSIGN   8832>>ASSIGN   8833>>ASSIGN
      8833>>ASSIGN   8834>>ASSIGN   8834>>ASSIGN   8835>>ASSIGN   8835>>ASSIGN   8852<<ASSIGN   8853>>IF
      8853<<ASSIGN   8853>>ASSIGN   8854>>IF       8855>>ASSIGN   8859>>ASSIGN   8861>>ASSIGN   8867>>ASSIGN
      8869>>ASSIGN   8872>>ASSIGN   8874>>ASSIGN
LN
      8461**DCL         7--PROC     8746--ENTRY    8757--ASSIGN   8765--ASSIGN   8848--ENTRY    8874>>ASSIGN
M$MCLOSE
      8547**DCL-ENT  8600--CALL     8606--CALL     8804--CALL
M$MOPEN
      8549**DCL-ENT  8841--CALL     8843--CALL
M$MWRITE
      8548**DCL-ENT  8575--CALL     8596--CALL     8638--CALL     8647--CALL     8690--CALL     8715--CALL
      8722--CALL     8730--CALL     8766--CALL     8775--CALL
M$WRITE
      5999**DCL-ENT  8736--CALL
OFFERR
      8620**LABEL    8590--CALLALT
ONERR
      8616**LABEL    8569--CALLALT
OPDRIB
      8274**DCL      8843<>CALL
OPDRIB.ACSVEH_
      8276**DCL      8277--REDEF
OPDRIB.ALTKEYS_
      8282**DCL      8283--REDEF    8283--REDEF
OPDRIB.HDR_
      8281**DCL      8282--REDEF
OPDRIB.TAB_
      8280**DCL      8281--REDEF
OPDRIB.UHL_
      8274**DCL      8275--REDEF    8275--REDEF
OPDRIB.V
      8283**DCL      8274--DCLINIT
OPDRIB.V.FSN#
      8314**DCL      8314--REDEF    8314--REDEF
OPDRIB.WSN_
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:83   
      8280**DCL      8280--REDEF
OPNERR IN PROCEDURE CHKOPN
      8845**LABEL    8822--CALLALT  8841--CALLALT  8843--CALLALT
PRINTABLE
      8532**DCL      8685<<ASSIGN   8699<<ASSIGN   8706<<ASSIGN   8717>>ASSIGN   8724>>IF
PRMPT
      8538**DCL      8835>>ASSIGN
PRMPTTRNS
      8540**DCL      8834>>ASSIGN
PRMPTVFC
      8539**DCL      8833>>ASSIGN
PROMPT
      8469**DCL      8610--ASSIGN   8805--ASSIGN   8821--ASSIGN   8831<<ASSIGN   8882<<ASSIGN   8882>>ASSIGN
      8890<<ASSIGN   8890>>ASSIGN
PROMPT.DVBYTE
      8474**DCL      8642>>ASSIGN   8855<<ASSIGN
PROMPT.LN
      8475**DCL      8645>>ASSIGN   8832<<ASSIGN   8838<<ASSIGN   8874<<ASSIGN
PROMPT.TRNS0
      8473**DCL      8636>>IF       8834<<ASSIGN   8859<<ASSIGN   8867<<ASSIGN
PROMPT.TXT
      8476**DCL      8646--ASSIGN
PROMPT.TXT.M
      8478**DCL      8835<<ASSIGN   8872<<ASSIGN
PROMPT.TXT.VFC
      8477**DCL      8833<<ASSIGN   8861<<ASSIGN   8869<<ASSIGN
RELSPACE
      8609**LABEL    8619--GOTO     8793--GOTO
STARTDRIB
      8569**LABEL    8601--GOTO
STOPDRIB
      8590**LABEL    8567--GOTO
TVFC
      8536**DCL      8409--DCLINIT  8410--DCLINIT
TYC
      8518**DCL      8686>>IF
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:84   
UMT$IDT
      8555**DCL-ENT  8561--CALL
VFC
      8521**DCL      8757>>ASSIGN   8765--ASSIGN
VPMT
      8454**DCL         7--PROC     8654--ENTRY    8686--IF       8746--ENTRY    8753--ASSIGN   8848--ENTRY
      8878--ENTRY    8882--ASSIGN   8886--ENTRY    8890--ASSIGN
VPMT.DVBYTE
      8456**DCL      8855>>ASSIGN
VPMT.M
      8459**DCL      8872>>ASSIGN
VPMT.PFB
      8455**DCL      8852>>ASSIGN
VPMT.VFC
      8458**DCL      8857>>IF       8861>>ASSIGN   8869>>ASSIGN
WR
      8503**DCL      8571<<ASSIGN   8575<>CALL     8592<<ASSIGN   8596<>CALL     8640<<ASSIGN   8647<>CALL
      8683<<ASSIGN   8715<>CALL     8722<>CALL     8730<>CALL     8736<>CALL     8749<<ASSIGN   8766<>CALL
      8775<>CALL
WR.BUF_
      8503**DCL      8572<<ASSIGN   8593<<ASSIGN   8714<<ASSIGN   8729<<ASSIGN   8734<<ASSIGN   8765<<ASSIGN
WR.BUF_.BOUND
      8503**DCL      8645<<ASSIGN   8721<<ASSIGN   8772<<ASSIGN   8774<<ASSIGN
WR.BUF_.BUF$
      8505**DCL      8646<<ASSIGN   8720<<ASSIGN   8770<<ASSIGN
WR.STATION_
      8505**DCL      8505--REDEF
WR.V
      8506**DCL      8573--ASSIGN   8594--ASSIGN   8641--ASSIGN   8684--ASSIGN   8752--ASSIGN
WR.V.DVBYTE
      8511**DCL      8642<<ASSIGN   8753<<ASSIGN
WR.V.DVBYTE.BP#
      8512**DCL      8644<<ASSIGN
WR.V.DVBYTE.CONT#
      8514**DCL      8712<<ASSIGN   8717<<ASSIGN   8727<<ASSIGN   8762<<ASSIGN   8764<<ASSIGN   8768<<ASSIGN
WR.V.DVBYTE.VFC#
PL6.E3A0      #001=UMD$DRIBBLE File=UMD$DRIBBLE.:E05TSI                          WED 07/30/97 06:58 Page:85   
      8512**DCL      8512--REDEF    8643<<ASSIGN   8713<<ASSIGN   8716<<ASSIGN   8728<<ASSIGN   8735<<ASSIGN
      8754<<ASSIGN   8758<<ASSIGN   8769<<ASSIGN
WR.V_
      8503**DCL      8573<<ASSIGN   8594<<ASSIGN   8641<<ASSIGN   8684<<ASSIGN   8752<<ASSIGN
WRA
      8377**DCL      8690<>CALL
WRA.STATION_
      8379**DCL      8379--REDEF
WRA.V
      8380**DCL      8377--DCLINIT
WRA.V.DVBYTE.VFC#
      8386**DCL      8386--REDEF
WRTRNS0
      8408**DCL      8638<>CALL
WRTRNS0.STATION_
      8410**DCL      8410--REDEF
WRTRNS0.V
      8411**DCL      8408--DCLINIT
WRTRNS0.V.DVBYTE.VFC#
      8417**DCL      8417--REDEF
WRUCREC
      8439**DCL      8571>>ASSIGN   8592>>ASSIGN   8640>>ASSIGN   8683>>ASSIGN   8749>>ASSIGN
WRUCREC.STATION_
      8441**DCL      8441--REDEF
WRUCREC.V
      8442**DCL      8439--DCLINIT
WRUCREC.V.DVBYTE.VFC#
      8448**DCL      8448--REDEF
XIT
      8614**LABEL    8617--GOTO     8624--GOTO
