VERSION E05

PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:1    
        1        1        /*M* VYM$MAIN - MAIN FUNCTION DRIVER; GLOBAL CONTROLLER         */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=4,STI=0,IND=4,CTI=3,DCI=4,ECI=4,CSI=0,THI=0,DTI=0,ENI=4,
        8        8             CLM=0,SQB,NTB,MOC,CCI=3,NLB,MCL=0,EDMC*/
        9        9        /*F* NAME:        VYM$MAIN
       10       10             PURPOSE:     MAIN FUNCTION DRIVER; GLOBAL CONTROLLER.
       11       11                                                                        */
       12       12        VYM$MAIN:
       13       13            PROC MAIN;
       14       14        %INCLUDE VY_INC_C;
       15     9190        %INCLUDE VY_PSUBS_C;
       16     9251        %INCLUDE CP_6_SUBS;
       17     9791        %VY$NODE;

              9803    1   /*******************************************************************************
              9804    1   *                                                                              *
              9805    1   *                          VY$NODE                                                 *
              9806    1   *                                                                              *
              9807    1   *******************************************************************************/

              9823    1   DCL 1 VY$NODE      ALIGNED    BASED,
              9824    1         2 SON$ PTR /*(ADDR(NIL))*/, /* Son pointer                      */
              9825    1         2 BROTHER$ PTR /*(ADDR(NIL))*/, /* Brother pointer              */
              9826    1         2 FATHER$ PTR /*(ADDR(NIL))*/, /* Father pointer                */
              9827    1         2 PATH$ PTR /*(ADDR(NIL))*/, /* Path   pointer                  */
              9828    1         2 HEAD$       PTR /*(ADDR(NIL))*/, /* Head pointer to
              9829                              to list of file nodes for this node            */
              9830    1         2 TAIL$ PTR /*(ADDR(NIL))*/, /* Tail pointer to list            */
              9831    1         2 SHARED_LIB_HEAD$ PTR /*(ADDR(NIL))*/,
              9831                  /* Head pointer to shared library list */
              9832    1         2 LIB_HEAD$         PTR /*(ADDR(NIL))*/,
              9832                  /* Head pointer to list of shared libraries
              9833                                          which have been mapped to included libraries */
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:2    
              9834    1         2 NUM          UBIN(36)  UNAL,    /* Node number                        */
              9835    1         2 DEPTH          UBIN(36)  UNAL,  /* Depth; ROOT=0*/
              9836    1         2 ADDR_START_A(0:2/*@ROS*/) SBIN WORD /*(0*3)*/, /* Array            */
              9837    1         2 ADDR_START REDEF  ADDR_START_A,
              9838    1           3 RDATA       SBIN WORD,   /* First address for this node in data     */
              9839    1           3 RPROC       SBIN WORD,   /* First address for this node in proc     */
              9840    1           3 ROS       SBIN WORD,          /* Last address for program in ros    */
              9841    1         2 ADDR_STOP_A(0:2/*@ROS*/) SBIN WORD /*(-1*3)*/, /* Array            */
              9842    1         2 ADDR_STOP  REDEF  ADDR_STOP_A,
              9843    1           3 RDATA       SBIN WORD,        /* Last address for this node in data */
              9844    1           3 RPROC       SBIN WORD,        /* Last address for this node in proc */
              9845    1           3 ROS       SBIN WORD,          /* Last address for program in ros    */
              9846    1         2 START_PAGE#_A(0:2/*@ROS*/) SBIN WORD /*(0*3)*/, /* Array           */
              9847    1         2 START_PAGE# REDEF START_PAGE#_A,
              9848    1           3 RDATA       SBIN WORD,   /* First page    for this node in data     */
              9849    1           3 RPROC       SBIN WORD,   /* First page    for this node in proc     */
              9850    1           3 ROS       SBIN WORD,          /* First page   for program in ros    */
              9851    1         2 STOP_PAGE#_A(0:2/*@ROS*/) SBIN WORD /*(-1*3)*/, /* Array*/
              9852    1         2 STOP_PAGE#  REDEF STOP_PAGE#_A,
              9853    1           3 RDATA       SBIN WORD,   /* Last  page    for this node in data     */
              9854    1           3 RPROC       SBIN WORD,   /* Last  page    for this node in proc     */
              9855    1           3 ROS       SBIN WORD,          /* Last  page   for program in ros    */
              9856    1         2 START_SC_ALL$ PTR /*(ADDR(NIL))*/,
              9856                  /* Starting pointer for common sections for this node */
              9857    1         2 STOP_SC_ALL$ PTR /*(ADDR(NIL))*/,
              9857                  /* Stopping pointer for common sections for this node */
              9858    1         2 L_START,
              9859    1           3 SN$ PTR /*(ADDR(NIL))*/, /* Segment definition names        */
              9860    1           3 DN$ PTR /*(ADDR(NIL))*/, /* Def names                       */
              9861    1           3 RN$ PTR /*(ADDR(NIL))*/, /* Ref names                       */
              9862    1           3 SC$ PTR /*(ADDR(NIL))*/, /* Sections                        */
              9863    1           3 ED$ PTR /*(ADDR(NIL))*/, /* Entry defs*/
              9864    1           3 ER$ PTR /*(ADDR(NIL))*/, /* Entry refs*/
              9865    1           3 DD$ PTR /*(ADDR(NIL))*/, /* Data defs                       */
              9866    1           3 DR$ PTR /*(ADDR(NIL))*/, /* Data refs                       */
              9867    1           3 SD$ PTR /*(ADDR(NIL))*/, /* Seg defs                        */
              9868    1           3 SR$ PTR /*(ADDR(NIL))*/, /* Seg refs                        */
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:3    
              9869    1         2 L_START_A$(0:9)     REDEF L_START PTR,
              9870    1         2 L_STOP,
              9871    1           3 SN$ PTR /*(ADDR(NIL))*/, /* Segment definition names        */
              9872    1           3 DN$ PTR /*(ADDR(NIL))*/, /* Def names                       */
              9873    1           3 RN$ PTR /*(ADDR(NIL))*/, /* Ref names                       */
              9874    1           3 SC$ PTR /*(ADDR(NIL))*/, /* Sections                        */
              9875    1           3 ED$ PTR /*(ADDR(NIL))*/, /* Entry defs*/
              9876    1           3 ER$ PTR /*(ADDR(NIL))*/, /* Entry refs*/
              9877    1           3 DD$ PTR /*(ADDR(NIL))*/, /* Data defs                       */
              9878    1           3 DR$ PTR /*(ADDR(NIL))*/, /* Data refs                       */
              9879    1           3 SD$ PTR /*(ADDR(NIL))*/, /* Seg defs                        */
              9880    1           3 SR$ PTR /*(ADDR(NIL))*/, /* Seg refs                        */
              9881    1         2 L_STOP_A$(0:9) REDEF   L_STOP    PTR,
              9882    1         2 L_SIZE,
              9883    1           3 SN      UBIN /*(0)*/, /* Segment definition names           */
              9884    1           3 DN      UBIN /*(0)*/, /* Def names                          */
              9885    1           3 RN      UBIN /*(0)*/, /* Ref names                          */
              9886    1           3 SC      UBIN /*(0)*/, /* Sections                           */
              9887    1           3 ED      UBIN /*(0)*/, /* Entry defs*/
              9888    1           3 ER      UBIN /*(0)*/, /* Entry refs*/
              9889    1           3 DD      UBIN /*(0)*/, /* Data defs                          */
              9890    1           3 DR      UBIN /*(0)*/, /* Data refs                          */
              9891    1           3 SD      UBIN /*(0)*/, /* Seg defs                           */
              9892    1           3 SR      UBIN /*(0)*/, /* Seg refs                           */
              9893    1         2 L_SIZE_A(0:9)  REDEF   L_SIZE    UBIN,
              9894    1         2 L_PREV_SIZE,
              9895    1           3 SN      UBIN /*(0)*/, /* Segment definition names           */
              9896    1           3 DN      UBIN /*(0)*/, /* Def names                          */
              9897    1           3 RN      UBIN /*(0)*/, /* Ref names                          */
              9898    1           3 SC      UBIN /*(0)*/, /* Sections                           */
              9899    1           3 ED      UBIN /*(0)*/, /* Entry defs*/
              9900    1           3 ER      UBIN /*(0)*/, /* Entry refs*/
              9901    1           3 DD      UBIN /*(0)*/, /* Data defs                          */
              9902    1           3 DR      UBIN /*(0)*/, /* Data refs                          */
              9903    1           3 SD      UBIN /*(0)*/, /* Seg defs                           */
              9904    1           3 SR      UBIN /*(0)*/, /* Seg refs                           */
              9905    1         2 L_PREV_SIZE_A(0:9)  REDEF   L_PREV_SIZE    UBIN,
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:4    
              9906    1         2 BIT_MAP                ALIGNED,
              9907    1           3 DATA                  ALIGNED,
              9908    1             4 BITS(0:255)          BIT(1)    UNAL /*('0'B*256)*/,
              9909    1           3 RPROC                 ALIGNED,
              9910    1             4 BITS(0:255)          BIT(1)    UNAL /*('0'B*256)*/,
              9911    1           3 ROS                   ALIGNED,
              9912    1             4 BITS(0:255)          BIT(1)    UNAL /*('0'B*256)*/,
              9913    1         2 L_SC_START,
              9914    1           3 SC_BLK_COM$ PTR /*(ADDR(NIL))*/, /* Blank common            */
              9915    1           3 SC_ROOT_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Root labelled common */
              9916    1           3 SC_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Labelled common         */
              9917    1           3 SC_DCB$ PTR /*(ADDR(NIL))*/, /* Dcbs                        */
              9918    1         2 L_SC_START_A$(0:3)  REDEF L_SC_START PTR,
              9919    1         2 L_SC_STOP,
              9920    1           3 SC_BLK_COM$ PTR /*(ADDR(NIL))*/, /* Blank common            */
              9921    1           3 SC_ROOT_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Root labelled common */
              9922    1           3 SC_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Labelled common         */
              9923    1           3 SC_DCB$ PTR /*(ADDR(NIL))*/, /* Dcbs                        */
              9924    1         2 L_SC_STOP_A$(0:3)   REDEF L_SC_STOP  PTR,
              9925    1         2 PROMOTE_HEAD,
              9926    1           3 BLK_COM$              PTR /*(ADDR(NIL))*/,
              9927    1           3 LBL_COM$              PTR /*(ADDR(NIL))*/,
              9928    1         2 PROMOTE_HEAD_A$(0:1) REDEF PROMOTE_HEAD     PTR,
              9929    1         2 PROMOTE_TAIL,
              9930    1           3 BLK_COM$              PTR /*(ADDR(NIL))*/,
              9931    1           3 LBL_COM$              PTR /*(ADDR(NIL))*/,
              9932    1         2 PROMOTE_TAIL_A$(0:1) REDEF PROMOTE_TAIL     PTR,
              9933    1         2 HAVE_ASL          BIT(1)    UNAL /*('0'B)*/,
              9934    1         2 ALL_BLK_COM          BIT(1)    UNAL /*('0'B)*/,
              9935    1         2 *                 BIT(34)   UNAL /*('0'B)*/,
              9936    1         2 BLANK_COMMON$     PTR       ALIGNED /*(ADDR(NIL))*/;

       18     9940        %C;

              9948    1   /*******************************************************************************
              9949    1   *                                                                              *
              9950    1   *                          CHAR                                                 *
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:5    
              9951    1   *                                                                              *
              9952    1   *******************************************************************************/

       19     9956    1   DCL CH CHAR(1) ALIGNED STATIC/*AUTO*/;
       20     9957        %E;

              9965    1   /*******************************************************************************
              9966    1   *                                                                              *
              9967    1   *                          ENTRY                                                 *
              9968    1   *                                                                              *
              9969    1   *******************************************************************************/

       21     9973        %ENTRIES;
       22     9988    1   DCL VYA$ND ENTRY(2);
       23     9989    1   DCL VYI$ERR ENTRY;
       24     9990    1   DCL VYI$EXIT ENTRY;
       25     9991    1   DCL VYI$INIT ENTRY;
       26     9992    1   DCL VYP$PARSE ENTRY;
       27     9993    1   DCL VYO$PROC ENTRY;
       28     9994    1   DCL VYM$MAP ENTRY;
       29     9995    1   DCL VYF$OPEN ENTRY(4) ALTRET;
       30     9996    1   DCL VYF$CLOSE ENTRY(3);
       31     9997    1   DCL VYS$LST ENTRY(6) ALTRET;
       32     9998        %U;

             10006    1   /*******************************************************************************
             10007    1   *                                                                              *
             10008    1   *                          UBIN                                                 *
             10009    1   *                                                                              *
             10010    1   *******************************************************************************/

       33    10014        %INDEX;
       34    10024    1   DCL GDP_FREE_POINT UBIN(36) ALIGNED STATIC/*AUTO*/;
       35    10025        %PTR;

             10033    1   /*******************************************************************************
             10034    1   *                                                                              *
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:6    
             10035    1   *                          PTR                                                 *
             10036    1   *                                                                              *
             10037    1   *******************************************************************************/

       36    10041    1   DCL PTR$ PTR ALIGNED STATIC/*AUTO*/;
       37    10042    1   DCL DCB$ PTR ALIGNED STATIC/*AUTO*/;
       38    10043        %BANNER( ARG=DCBS );

             10051    1   /*******************************************************************************
             10052    1   *                                                                              *
             10053    1   *                          DCBS                                                 *
             10054    1   *                                                                              *
             10055    1   *******************************************************************************/

       39    10059    1   DCL M$LO DCB;
       40    10060        %PLIST;
       41    10061    1   DCL M$OF DCB;
       42    10062    1   DCL M$RF DCB;
       43    10063        %BANNER( ARG=FPTS );

             10071    1   /*******************************************************************************
             10072    1   *                                                                              *
             10073    1   *                          FPTS                                                 *
             10074    1   *                                                                              *
             10075    1   *******************************************************************************/

       44    10079        %FPT_CLOSE(
       45    10080         FPTN=FPT_CLOSE_OF,
       46    10081         DCB=M$OF,
       47    10082         STCLASS=CONSTANT);
       48    10124        %FPT_CLOSE(
       49    10125         FPTN=FPT_CLOSE_RF,
       50    10126         DCB=M$RF,
       51    10127         STCLASS=STATIC);
       52    10169        %F$DCB;
       53    10226        %FPT_CLOSE(FPTN=VY_LO_FPT_CLOSE,
       54    10227         DCB =M$LO,
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:7    
       55    10228         DISP=SAVE,
       56    10229         STCLASS="STATIC SYMDEF");
       57    10271        %OPTIONS(NAME=VY_O_CONSTANT,STCLASS=SYMREF);
       58    10415        %EJECT;
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:8    
       59    10416         /* Do initialization */
       60    10417    1       CALL VYI$INIT;
       61    10418            %ALLOCATE( PTR$=VY_ROOT$, TYPE=@GDP, SIZE="SIZEW(VY$NODE)" );
       62    10425    1       VY_CURR$ = VY_ROOT$;
       63    10426    1       GDP_FREE_POINT = VY_M_FREE(8/*@GDP*/);
       64    10427    1       REMEMBER RESTART IN VY_UNWIND;
       65    10428    2       DO WHILE( '1'B );
       66    10429    2   NEXT_COMMAND:
       67    10430    3           DO I = 0 TO SIZEW( VY_M_FREE ) - 2;
       68    10431    4               IF I ~= 2 THEN DO;
       69    10432    5                   IF VY_M_FREE(I) > 0 THEN DO;
       70    10433    6                       IF VY_M_ALL(I) > 1024/*@PAGE_SIZE*/ THEN DO;
       71    10434    6                           IF VY_M_FREE(I) > 1024/*@PAGE_SIZE*/
       72    10435    6                           THEN J = VY_M_FREE(I);
       73    10436    6                           ELSE J = 1;
       74    10437    6                           CALL VYF$FREE( I,J,1 );
       75    10438    6                           END; /* If VY_M_ALL(I) > @PAGE_SIZE then do; */
       76    10439    5                       END; /* If VY_M_FREE(I) > 0 then do; */
       77    10440    4                   IF VY_M_FREE(I) > 0 THEN CALL VYF$FREE( I, VY_M_FREE(I), 0 );
       78    10441    4                   END; /* If i ~= 2 then do; */
       79    10442    3               END; /* Do i = 0 to sizew( VY_M_FREE ) - 2; */
       80    10443
       81    10444    2           IF VY_M_FREE(8/*@GDP*/) > GDP_FREE_POINT
       82    10445    2           THEN CALL VYF$FREE( 8/*@GDP*/, VY_M_FREE(8/*@GDP*/) - GDP_FREE_POINT, 1 );
       83    10446
       84    10447
       85    10448    2           CALL VYA$ND( VY_ROOT$, ADDR(NIL) );
       86    10449    2           VY_RUF$ = ADDR(NIL);
       87    10450
       88    10451
       89    10452    2           VY_O = VY_O_CONSTANT;
       90    10453    2           VY_OD ='0'B;
       91    10454         /* Now parse */
       92    10455    2           CALL VYP$PARSE;
       93    10456    3           IF VY_OD.MAP_ATTCH.DEF THEN DO;
       94    10457    3               VY_O.MAP_ATTCH.EDEF = 1;
       95    10458    3               VY_O.MAP_ATTCH.DDEF = 1;
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:9    
       96    10459    3               VY_O.MAP_ATTCH.SDEF = 1;
       97    10460    3               END;
       98    10461    2           ELSE IF VY_OD.MAP_ATTCH.EDEF
       99    10462    2                  OR
      100    10463    2                  VY_OD.MAP_ATTCH.DDEF
      101    10464    2                  OR
      102    10465    2                  VY_OD.MAP_ATTCH.SDEF THEN VY_O.MAP_ATTCH.DEF = 1;
      103    10466    3           IF VY_OD.MAP_ATTCH.REF THEN DO;
      104    10467    3               VY_O.MAP_ATTCH.EREF = 1;
      105    10468    3               VY_O.MAP_ATTCH.DREF = 1;
      106    10469    3               VY_O.MAP_ATTCH.SREF = 1;
      107    10470    3               END;
      108    10471    2           ELSE IF VY_OD.MAP_ATTCH.EREF
      109    10472    2                  OR
      110    10473    2                  VY_OD.MAP_ATTCH.DREF
      111    10474    2                  OR
      112    10475    2                  VY_OD.MAP_ATTCH.SREF THEN VY_O.MAP_ATTCH.REF = 1;
      113    10476        %EJECT;
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:10   
      114    10477    3           DO CASE( VY_COMMAND );
      115    10478    3           CASE(3/*@C_COPY_KEY_WORD*/);
      116    10479    3               CALL SET_WRITE;
      117    10480    3               GOTO PROCEED;
      118    10481    3           CASE(
      119    10482    3                  4/*@C_EXTRACT_KEY_WORD*/ );
      120    10483    3   PROCEED:
      121    10484    3               CALL VYF$OPEN( VY_RUF$, 1/*@RF*/, VY_ON_OVER, '0'B/*@FALSE_B*/ ) ALTRET(
             10484                        NEXT_COMMAND);
      122    10485    3               VY_COPY_EXTRACT = '0'B/*@FALSE_B*/;
      123    10486    3               GOTO PROCESS;
      124    10487    3           CASE(
      125    10488    3                  6/*@C_LIST_KEY_WORD*/ );
      126    10489    3               VY_LIST_HEADER = '0'B/*@FALSE_B*/;
      127    10490    3               GOTO PROCESS;
      128    10491    3           CASE(
      129    10492    3                  7/*@C_LINKAGE_KEY_WORD*/,
      130    10493    3                  8/*@C_XREF_KEY_WORD*/);
      131    10494    3   PROCESS:
      132    10495    3               VY_INPUT_OPEN = 0;
      133    10496    3   PROCESS1:
      134    10497    3               CALL VYO$PROC;
      135    10498    4               DO CASE( VY_COMMAND );
      136    10499    4               CASE( 3/*@C_COPY_KEY_WORD*/,
      137    10500    4                  4/*@C_EXTRACT_KEY_WORD*/ );
      138    10501    4                   CALL VYF$CLOSE( VY_RUF$, 1/*@RF*/, 2/*@SAVE*/ );
      139    10502    4                   END;
      140    10503    3           CASE(9/*@C_DEFINE_KEY_WORD*/);
      141    10504    3               CALL SET_WRITE;
      142    10505    3               GOTO JUMP;
      143    10506    3           CASE(
      144    10507    3                  10/*@C_DROP_KEY_WORD*/,
      145    10508    3                  5/*@C_DELETE_KEY_WORD*/ );
      146    10509    3   JUMP:
      147    10510    3               VY_INPUT_OPEN = 2;
      148    10511    3               GOTO PROCESS1;
      149    10512    3           CASE(11/*@C_END_KEY_WORD*/);
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:11   
      150    10513    3               CALL M$CLOSE( VY_LO_FPT_CLOSE );
      151    10514    3               CALL VYI$EXIT;
      152    10515    3               END;
      153    10516
      154    10517    2           IF VY_O.MAP_ATTCH.DEF + VY_O.MAP_ATTCH.REF > 0 THEN CALL VYM$MAP;
      155    10518
      156    10519    3           DO WHILE( '0'B );
      157    10520    3   RESTART:
      158    10521    4               IF M$OF$ -> F$DCB.FCD# THEN DO;
      159    10522    4                   CALL M$CLOSE( FPT_CLOSE_OF );
      160    10523    4                   END;
      161    10524
      162    10525    4               IF M$RF$ -> F$DCB.FCD# THEN DO;
      163    10526    5                   IF VY_ON_OVER = 4/*@C_OVER_KEY_WORD*/ THEN DO;
      164    10527    5                       FPT_CLOSE_RF.V.DISP# = 1;
      165    10528    5                       END;
      166    10529    5                   ELSE DO;
      167    10530    5                       FPT_CLOSE_RF.V.DISP# = 2;
      168    10531    5                       END;
      169    10532    4                   CALL M$CLOSE( FPT_CLOSE_RF );
      170    10533    4                   END;
      171    10534    3               VY_OD_SEARCH = '0'B;
      172    10535    3               END; /* Do never */
      173    10536    2           END; /* Do forever */
      174    10537        %EJECT;
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:12   
      175    10538
      176    10539
      177    10540    1   SET_WRITE: PROC;
      178    10541
      179    10542
      180    10543    3       IF ~VY_OD.PRIMARY_OPTION.DUPLICATE THEN DO; /* None specified */
      181    10544    4           IF VY_ONLINE = 1/*@YES*/ THEN DO;
      182    10545    4               VY_O.PRIMARY_OPTION.DUPLICATE = 1/*@C_INQUIRE_KEY_WORD*/;
      183    10546    4               END;
      184    10547    4           ELSE DO;
      185    10548    4               VY_O.PRIMARY_OPTION.DUPLICATE = 2/*@C_ERROR_KEY_WORD*/;
      186    10549    4               END;
      187    10550    3           END;
      188    10551    3       ELSE DO; /* One was specified */
      189    10552    4           IF VY_ONLINE = 0/*@NO*/ AND VY_O.PRIMARY_OPTION.DUPLICATE = 1
             10552                    /*@C_INQUIRE_KEY_WORD*/ THEN DO;
      190    10553    4               VY_O.PRIMARY_OPTION.DUPLICATE = 2/*@C_ERROR_KEY_WORD*/;
      191    10554    4               END;
      192    10555    3           END;
      193    10556
      194    10557    2       IF VY_O.PRIMARY_OPTION.DUPLICATE = 3/*@C_OVERWRITE_KEY_WORD*/
      195    10558    2       THEN VY_INV_OWRITE = '1'B/*@TRUE_B*/;
      196    10559    2       ELSE VY_INV_OWRITE = '0'B/*@FALSE_B*/;
      197    10560    2   END;
      198    10561    1   END VYM$MAIN;
      199    10562        %EOD;

PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:13   
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   VY_PSUBS_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   VY_DCB_R.:E05TOU  cannot be made into a system file and is referenced.
   VY_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VY_FIXED_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VY_MACRO_C.:E05TOU  is referenced.
   VY_PERR_C.:E05TOU  is referenced.
   VY_SUBS_C.:E05TOU  is referenced.
   VY_INC_NO_C.:E05TOU  is referenced.
   VY_SWITCH_C.:E05TOU  is referenced.
   VY_INC_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VYM$MAIN.

   Procedure VYM$MAIN requires 255 words for executable code.
   Procedure VYM$MAIN requires 10 words of local(AUTO) storage.

PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:14   

 Object Unit name= VYM$MAIN                                   File name= VYM$MAIN.:E05TOU
 UTS= JUL 30 '97 08:57:10.48 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    68    104  VYM$MAIN
    2   DCB   even  none     0      0  M$LO
    3   DCB   even  none     0      0  M$OF
    4   DCB   even  none     0      0  M$RF
    5  RoData even  UTS     30     36  VYM$MAIN
    6   Proc  even  none   255    377  VYM$MAIN
    7  RoData even  none    15     17  VYM$MAIN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     6      0   yes            yes      Main       0  VYM$MAIN

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1     46  VY_LO_FPT_CLOSE
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:15   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 VYI$INIT
         yes           Std       3 VYA$GET
         yes           Std       3 VYF$FREE
         yes           Std       2 VYA$ND
         yes           Std       0 VYO$PROC
         yes           Std       0 VYP$PARSE
         yes           Std       0 VYI$EXIT
         yes           Std       3 VYF$CLOSE
         yes           Std       0 VYM$MAP
 yes     yes           Std       4 VYF$OPEN
                       nStd      0 X66_MAUTO
                       Std       0 B_CONSPOOL_D

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  VY_OD_SEARCH                          VY_COMMAND
     VY_ON_OVER                            VY_ROOT$                              VY_RUF$
     VY_CURR$                              VY_ERRORS                             VY_M_FREE
     VY_M_ALL                              VY_M_BASE_PTR                         VY_ONLINE
     VY_O                                  VY_OD                                 VY_UNWIND
     VY_PAR_UNWIND                         VY_LIST_HEADER                        VY_INV_OWRITE
     VY_INPUT_OPEN                         VY_COPY_EXTRACT                       M$OF$
     M$RF$                                 M$LO                                  M$OF
     M$RF                                  VY_O_CONSTANT                         B_VECTNIL
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:16   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:17   


        1        1        /*M* VYM$MAIN - MAIN FUNCTION DRIVER; GLOBAL CONTROLLER         */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=4,STI=0,IND=4,CTI=3,DCI=4,ECI=4,CSI=0,THI=0,DTI=0,ENI=4,
        8        8             CLM=0,SQB,NTB,MOC,CCI=3,NLB,MCL=0,EDMC*/
        9        9        /*F* NAME:        VYM$MAIN
       10       10             PURPOSE:     MAIN FUNCTION DRIVER; GLOBAL CONTROLLER.
       11       11                                                                        */
       12       12        VYM$MAIN:
       13       13            PROC MAIN;

     13  6 000000   000000 700200 xent  VYM$MAIN     TSX0  ! X66_MAUTO
         6 000001   000012 000000                    ZERO    10,0

       14       14        %INCLUDE VY_INC_C;
       15     9190        %INCLUDE VY_PSUBS_C;
       16     9251        %INCLUDE CP_6_SUBS;
       17     9791        %VY$NODE;

              9803    1   /*******************************************************************************
              9804    1   *                                                                              *
              9805    1   *                          VY$NODE                                                *
              9806    1   *                                                                              *
              9807    1   *******************************************************************************/

              9823    1   DCL 1 VY$NODE      ALIGNED    BASED,
              9824    1         2 SON$ PTR /*(ADDR(NIL))*/, /* Son pointer                      */
              9825    1         2 BROTHER$ PTR /*(ADDR(NIL))*/, /* Brother pointer              */
              9826    1         2 FATHER$ PTR /*(ADDR(NIL))*/, /* Father pointer                */
              9827    1         2 PATH$ PTR /*(ADDR(NIL))*/, /* Path   pointer                  */
              9828    1         2 HEAD$       PTR /*(ADDR(NIL))*/, /* Head pointer to
              9829                              to list of file nodes for this node            */
              9830    1         2 TAIL$ PTR /*(ADDR(NIL))*/, /* Tail pointer to list            */
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:18   
              9831    1         2 SHARED_LIB_HEAD$ PTR /*(ADDR(NIL))*/,
              9831                  /* Head pointer to shared library list */
              9832    1         2 LIB_HEAD$         PTR /*(ADDR(NIL))*/,
              9832                  /* Head pointer to list of shared libraries
              9833                                          which have been mapped to included libraries */
              9834    1         2 NUM          UBIN(36)  UNAL,    /* Node number                        */
              9835    1         2 DEPTH          UBIN(36)  UNAL,  /* Depth; ROOT=0*/
              9836    1         2 ADDR_START_A(0:2/*@ROS*/) SBIN WORD /*(0*3)*/, /* Array            */
              9837    1         2 ADDR_START REDEF  ADDR_START_A,
              9838    1           3 RDATA       SBIN WORD,   /* First address for this node in data     */
              9839    1           3 RPROC       SBIN WORD,   /* First address for this node in proc     */
              9840    1           3 ROS       SBIN WORD,          /* Last address for program in ros    */
              9841    1         2 ADDR_STOP_A(0:2/*@ROS*/) SBIN WORD /*(-1*3)*/, /* Array            */
              9842    1         2 ADDR_STOP  REDEF  ADDR_STOP_A,
              9843    1           3 RDATA       SBIN WORD,        /* Last address for this node in data */
              9844    1           3 RPROC       SBIN WORD,        /* Last address for this node in proc */
              9845    1           3 ROS       SBIN WORD,          /* Last address for program in ros    */
              9846    1         2 START_PAGE#_A(0:2/*@ROS*/) SBIN WORD /*(0*3)*/, /* Array           */
              9847    1         2 START_PAGE# REDEF START_PAGE#_A,
              9848    1           3 RDATA       SBIN WORD,   /* First page    for this node in data     */
              9849    1           3 RPROC       SBIN WORD,   /* First page    for this node in proc     */
              9850    1           3 ROS       SBIN WORD,          /* First page   for program in ros    */
              9851    1         2 STOP_PAGE#_A(0:2/*@ROS*/) SBIN WORD /*(-1*3)*/, /* Array*/
              9852    1         2 STOP_PAGE#  REDEF STOP_PAGE#_A,
              9853    1           3 RDATA       SBIN WORD,   /* Last  page    for this node in data     */
              9854    1           3 RPROC       SBIN WORD,   /* Last  page    for this node in proc     */
              9855    1           3 ROS       SBIN WORD,          /* Last  page   for program in ros    */
              9856    1         2 START_SC_ALL$ PTR /*(ADDR(NIL))*/,
              9856                  /* Starting pointer for common sections for this node */
              9857    1         2 STOP_SC_ALL$ PTR /*(ADDR(NIL))*/,
              9857                  /* Stopping pointer for common sections for this node */
              9858    1         2 L_START,
              9859    1           3 SN$ PTR /*(ADDR(NIL))*/, /* Segment definition names        */
              9860    1           3 DN$ PTR /*(ADDR(NIL))*/, /* Def names                       */
              9861    1           3 RN$ PTR /*(ADDR(NIL))*/, /* Ref names                       */
              9862    1           3 SC$ PTR /*(ADDR(NIL))*/, /* Sections                        */
              9863    1           3 ED$ PTR /*(ADDR(NIL))*/, /* Entry defs*/
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:19   
              9864    1           3 ER$ PTR /*(ADDR(NIL))*/, /* Entry refs*/
              9865    1           3 DD$ PTR /*(ADDR(NIL))*/, /* Data defs                       */
              9866    1           3 DR$ PTR /*(ADDR(NIL))*/, /* Data refs                       */
              9867    1           3 SD$ PTR /*(ADDR(NIL))*/, /* Seg defs                        */
              9868    1           3 SR$ PTR /*(ADDR(NIL))*/, /* Seg refs                        */
              9869    1         2 L_START_A$(0:9)     REDEF L_START PTR,
              9870    1         2 L_STOP,
              9871    1           3 SN$ PTR /*(ADDR(NIL))*/, /* Segment definition names        */
              9872    1           3 DN$ PTR /*(ADDR(NIL))*/, /* Def names                       */
              9873    1           3 RN$ PTR /*(ADDR(NIL))*/, /* Ref names                       */
              9874    1           3 SC$ PTR /*(ADDR(NIL))*/, /* Sections                        */
              9875    1           3 ED$ PTR /*(ADDR(NIL))*/, /* Entry defs*/
              9876    1           3 ER$ PTR /*(ADDR(NIL))*/, /* Entry refs*/
              9877    1           3 DD$ PTR /*(ADDR(NIL))*/, /* Data defs                       */
              9878    1           3 DR$ PTR /*(ADDR(NIL))*/, /* Data refs                       */
              9879    1           3 SD$ PTR /*(ADDR(NIL))*/, /* Seg defs                        */
              9880    1           3 SR$ PTR /*(ADDR(NIL))*/, /* Seg refs                        */
              9881    1         2 L_STOP_A$(0:9) REDEF   L_STOP    PTR,
              9882    1         2 L_SIZE,
              9883    1           3 SN      UBIN /*(0)*/, /* Segment definition names           */
              9884    1           3 DN      UBIN /*(0)*/, /* Def names                          */
              9885    1           3 RN      UBIN /*(0)*/, /* Ref names                          */
              9886    1           3 SC      UBIN /*(0)*/, /* Sections                           */
              9887    1           3 ED      UBIN /*(0)*/, /* Entry defs*/
              9888    1           3 ER      UBIN /*(0)*/, /* Entry refs*/
              9889    1           3 DD      UBIN /*(0)*/, /* Data defs                          */
              9890    1           3 DR      UBIN /*(0)*/, /* Data refs                          */
              9891    1           3 SD      UBIN /*(0)*/, /* Seg defs                           */
              9892    1           3 SR      UBIN /*(0)*/, /* Seg refs                           */
              9893    1         2 L_SIZE_A(0:9)  REDEF   L_SIZE    UBIN,
              9894    1         2 L_PREV_SIZE,
              9895    1           3 SN      UBIN /*(0)*/, /* Segment definition names           */
              9896    1           3 DN      UBIN /*(0)*/, /* Def names                          */
              9897    1           3 RN      UBIN /*(0)*/, /* Ref names                          */
              9898    1           3 SC      UBIN /*(0)*/, /* Sections                           */
              9899    1           3 ED      UBIN /*(0)*/, /* Entry defs*/
              9900    1           3 ER      UBIN /*(0)*/, /* Entry refs*/
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:20   
              9901    1           3 DD      UBIN /*(0)*/, /* Data defs                          */
              9902    1           3 DR      UBIN /*(0)*/, /* Data refs                          */
              9903    1           3 SD      UBIN /*(0)*/, /* Seg defs                           */
              9904    1           3 SR      UBIN /*(0)*/, /* Seg refs                           */
              9905    1         2 L_PREV_SIZE_A(0:9)  REDEF   L_PREV_SIZE    UBIN,
              9906    1         2 BIT_MAP                ALIGNED,
              9907    1           3 DATA                  ALIGNED,
              9908    1             4 BITS(0:255)          BIT(1)    UNAL /*('0'B*256)*/,
              9909    1           3 RPROC                 ALIGNED,
              9910    1             4 BITS(0:255)          BIT(1)    UNAL /*('0'B*256)*/,
              9911    1           3 ROS                   ALIGNED,
              9912    1             4 BITS(0:255)          BIT(1)    UNAL /*('0'B*256)*/,
              9913    1         2 L_SC_START,
              9914    1           3 SC_BLK_COM$ PTR /*(ADDR(NIL))*/, /* Blank common            */
              9915    1           3 SC_ROOT_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Root labelled common */
              9916    1           3 SC_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Labelled common         */
              9917    1           3 SC_DCB$ PTR /*(ADDR(NIL))*/, /* Dcbs                        */
              9918    1         2 L_SC_START_A$(0:3)  REDEF L_SC_START PTR,
              9919    1         2 L_SC_STOP,
              9920    1           3 SC_BLK_COM$ PTR /*(ADDR(NIL))*/, /* Blank common            */
              9921    1           3 SC_ROOT_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Root labelled common */
              9922    1           3 SC_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Labelled common         */
              9923    1           3 SC_DCB$ PTR /*(ADDR(NIL))*/, /* Dcbs                        */
              9924    1         2 L_SC_STOP_A$(0:3)   REDEF L_SC_STOP  PTR,
              9925    1         2 PROMOTE_HEAD,
              9926    1           3 BLK_COM$              PTR /*(ADDR(NIL))*/,
              9927    1           3 LBL_COM$              PTR /*(ADDR(NIL))*/,
              9928    1         2 PROMOTE_HEAD_A$(0:1) REDEF PROMOTE_HEAD     PTR,
              9929    1         2 PROMOTE_TAIL,
              9930    1           3 BLK_COM$              PTR /*(ADDR(NIL))*/,
              9931    1           3 LBL_COM$              PTR /*(ADDR(NIL))*/,
              9932    1         2 PROMOTE_TAIL_A$(0:1) REDEF PROMOTE_TAIL     PTR,
              9933    1         2 HAVE_ASL          BIT(1)    UNAL /*('0'B)*/,
              9934    1         2 ALL_BLK_COM          BIT(1)    UNAL /*('0'B)*/,
              9935    1         2 *                 BIT(34)   UNAL /*('0'B)*/,
              9936    1         2 BLANK_COMMON$     PTR       ALIGNED /*(ADDR(NIL))*/;

PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:21   
       18     9940        %C;

              9948    1   /*******************************************************************************
              9949    1   *                                                                              *
              9950    1   *                          CHAR                                                 *
              9951    1   *                                                                              *
              9952    1   *******************************************************************************/

       19     9956    1   DCL CH CHAR(1) ALIGNED STATIC/*AUTO*/;
       20     9957        %E;

              9965    1   /*******************************************************************************
              9966    1   *                                                                              *
              9967    1   *                          ENTRY                                                 *
              9968    1   *                                                                              *
              9969    1   *******************************************************************************/

       21     9973        %ENTRIES;
       22     9988    1   DCL VYA$ND ENTRY(2);
       23     9989    1   DCL VYI$ERR ENTRY;
       24     9990    1   DCL VYI$EXIT ENTRY;
       25     9991    1   DCL VYI$INIT ENTRY;
       26     9992    1   DCL VYP$PARSE ENTRY;
       27     9993    1   DCL VYO$PROC ENTRY;
       28     9994    1   DCL VYM$MAP ENTRY;
       29     9995    1   DCL VYF$OPEN ENTRY(4) ALTRET;
       30     9996    1   DCL VYF$CLOSE ENTRY(3);
       31     9997    1   DCL VYS$LST ENTRY(6) ALTRET;
       32     9998        %U;

             10006    1   /*******************************************************************************
             10007    1   *                                                                              *
             10008    1   *                          UBIN                                                 *
             10009    1   *                                                                              *
             10010    1   *******************************************************************************/

       33    10014        %INDEX;
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:22   
       34    10024    1   DCL GDP_FREE_POINT UBIN(36) ALIGNED STATIC/*AUTO*/;
       35    10025        %PTR;

             10033    1   /*******************************************************************************
             10034    1   *                                                                              *
             10035    1   *                          PTR                                                 *
             10036    1   *                                                                              *
             10037    1   *******************************************************************************/

       36    10041    1   DCL PTR$ PTR ALIGNED STATIC/*AUTO*/;
       37    10042    1   DCL DCB$ PTR ALIGNED STATIC/*AUTO*/;
       38    10043        %BANNER( ARG=DCBS );

             10051    1   /*******************************************************************************
             10052    1   *                                                                              *
             10053    1   *                          DCBS                                                 *
             10054    1   *                                                                              *
             10055    1   *******************************************************************************/

       39    10059    1   DCL M$LO DCB;
       40    10060        %PLIST;
       41    10061    1   DCL M$OF DCB;
       42    10062    1   DCL M$RF DCB;
       43    10063        %BANNER( ARG=FPTS );

             10071    1   /*******************************************************************************
             10072    1   *                                                                              *
             10073    1   *                          FPTS                                                 *
             10074    1   *                                                                              *
             10075    1   *******************************************************************************/

       44    10079        %FPT_CLOSE(
       45    10080         FPTN=FPT_CLOSE_OF,
       46    10081         DCB=M$OF,
       47    10082         STCLASS=CONSTANT);
       48    10124        %FPT_CLOSE(
       49    10125         FPTN=FPT_CLOSE_RF,
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:23   
       50    10126         DCB=M$RF,
       51    10127         STCLASS=STATIC);
       52    10169        %F$DCB;
       53    10226        %FPT_CLOSE(FPTN=VY_LO_FPT_CLOSE,
       54    10227         DCB =M$LO,
       55    10228         DISP=SAVE,
       56    10229         STCLASS="STATIC SYMDEF");
       57    10271        %OPTIONS(NAME=VY_O_CONSTANT,STCLASS=SYMREF);
       58    10415        %EJECT;
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:24   
       59    10416         /* Do initialization */
       60    10417    1       CALL VYI$INIT;

  10417  6 000002   000002 631400 xsym               EPPR1   B_VECTNIL+2
         6 000003   000000 701000 xent               TSX1    VYI$INIT
         6 000004   000000 011000                    NOP     0

       61    10418            %ALLOCATE( PTR$=VY_ROOT$, TYPE=@GDP, SIZE="SIZEW(VY$NODE)" );

  10419  6 000005   000010 236000 xsym               LDQ     VY_M_ALL+8
         6 000006   000010 136000 xsym               SBLQ    VY_M_FREE+8
         6 000007   000146 116007                    CMPQ    102,DL
         6 000010   000020 604000 6                  TMI     s:10423

  10420  6 000011   000010 236000 xsym               LDQ     VY_M_FREE+8
         6 000012   000022 736000                    QLS     18
         6 000013   000010 036000 xsym               ADLQ    VY_M_BASE_PTR+8
         6 000014   000000 756000 xsym               STQ     VY_ROOT$

  10421  6 000015   000146 236007                    LDQ     102,DL
         6 000016   000010 056000 xsym               ASQ     VY_M_FREE+8

  10422  6 000017   000024 710000 6                  TRA     s:10425

  10423  6 000020   000001 630400 7                  EPPR0   1
         6 000021   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 000022   000000 701000 xent               TSX1    VYA$GET
         6 000023   000000 011000                    NOP     0

       62    10425    1       VY_CURR$ = VY_ROOT$;

  10425  6 000024   000000 236000 xsym               LDQ     VY_ROOT$
         6 000025   000000 756000 xsym               STQ     VY_CURR$

       63    10426    1       GDP_FREE_POINT = VY_M_FREE(8/*@GDP*/);

  10426  6 000026   000010 235000 xsym               LDA     VY_M_FREE+8
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:25   
         6 000027   000005 755000 1                  STA     GDP_FREE_POINT

       64    10427    1       REMEMBER RESTART IN VY_UNWIND;

  10427  6 000030   000311 635000 6                  EAA     RESTART
         6 000031   000000 452400 xsym               STP2    VY_UNWIND
         6 000032   000001 755000 xsym               STA     VY_UNWIND+1

       65    10428    2       DO WHILE( '1'B );

       66    10429    2   NEXT_COMMAND:
       67    10430    3           DO I = 0 TO SIZEW( VY_M_FREE ) - 2;

  10430  6 000033   000001 450000 1     NEXT_COMMAND STZ     I
         6 000034   000101 710000 6                  TRA     s:10442+3

       68    10431    4               IF I ~= 2 THEN DO;

  10431  6 000035   000001 235000 1                  LDA     I
         6 000036   000002 115007                    CMPA    2,DL
         6 000037   000076 600000 6                  TZE     s:10442

       69    10432    5                   IF VY_M_FREE(I) > 0 THEN DO;

  10432  6 000040   000000 235005 xsym               LDA     VY_M_FREE,AL
         6 000041   000061 604400 6                  TMOZ    s:10440

       70    10433    6                       IF VY_M_ALL(I) > 1024/*@PAGE_SIZE*/ THEN DO;

  10433  6 000042   000001 720000 1                  LXL0    I
         6 000043   000000 235010 xsym               LDA     VY_M_ALL,X0
         6 000044   002000 115007                    CMPA    1024,DL
         6 000045   000061 604400 6                  TMOZ    s:10440

       71    10434    6                           IF VY_M_FREE(I) > 1024/*@PAGE_SIZE*/

  10434  6 000046   000000 235010 xsym               LDA     VY_M_FREE,X0
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:26   
         6 000047   002000 115007                    CMPA    1024,DL
         6 000050   000053 604400 6                  TMOZ    s:10436

       72    10435    6                           THEN J = VY_M_FREE(I);

  10435  6 000051   000002 755000 1                  STA     J
         6 000052   000055 710000 6                  TRA     s:10437

       73    10436    6                           ELSE J = 1;

  10436  6 000053   000001 236007                    LDQ     1,DL
         6 000054   000002 756000 1                  STQ     J

       74    10437    6                           CALL VYF$FREE( I,J,1 );

  10437  6 000055   000004 630400 7                  EPPR0   4
         6 000056   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 000057   000000 701000 xent               TSX1    VYF$FREE
         6 000060   000000 011000                    NOP     0

       75    10438    6                           END; /* If VY_M_ALL(I) > @PAGE_SIZE then do; */

       76    10439    5                       END; /* If VY_M_FREE(I) > 0 then do; */

       77    10440    4                   IF VY_M_FREE(I) > 0 THEN CALL VYF$FREE( I, VY_M_FREE(I), 0 );

  10440  6 000061   000001 720000 1                  LXL0    I
         6 000062   000000 235010 xsym               LDA     VY_M_FREE,X0
         6 000063   000076 604400 6                  TMOZ    s:10442

  10440  6 000064   000007 236000 7                  LDQ     7
         6 000065   200010 756100                    STQ     8,,AUTO
         6 000066   000000 630410 xsym               EPPR0   VY_M_FREE,X0
         6 000067   200007 450500                    STP0    7,,AUTO
         6 000070   000004 236000 7                  LDQ     4
         6 000071   200006 756100                    STQ     6,,AUTO
         6 000072   200006 630500                    EPPR0   6,,AUTO
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:27   
         6 000073   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 000074   000000 701000 xent               TSX1    VYF$FREE
         6 000075   000000 011000                    NOP     0

       78    10441    4                   END; /* If i ~= 2 then do; */

       79    10442    3               END; /* Do i = 0 to sizew( VY_M_FREE ) - 2; */

  10442  6 000076   000001 235000 1                  LDA     I
         6 000077   000001 035007                    ADLA    1,DL
         6 000100   000001 755000 1                  STA     I
         6 000101   000001 235000 1                  LDA     I
         6 000102   000010 115007                    CMPA    8,DL
         6 000103   000035 602000 6                  TNC     s:10431

       80    10443
       81    10444    2           IF VY_M_FREE(8/*@GDP*/) > GDP_FREE_POINT

  10444  6 000104   000005 236000 1                  LDQ     GDP_FREE_POINT
         6 000105   000125 604000 6                  TMI     s:10448
         6 000106   000010 116000 xsym               CMPQ    VY_M_FREE+8
         6 000107   000125 605000 6                  TPL     s:10448

       82    10445    2           THEN CALL VYF$FREE( 8/*@GDP*/, VY_M_FREE(8/*@GDP*/) - GDP_FREE_POINT, 1 );

  10445  6 000110   000010 236000 xsym               LDQ     VY_M_FREE+8
         6 000111   000005 136000 1                  SBLQ    GDP_FREE_POINT
         6 000112   200006 756100                    STQ     6,,AUTO
         6 000113   000006 236000 7                  LDQ     6
         6 000114   200011 756100                    STQ     9,,AUTO
         6 000115   200006 630500                    EPPR0   6,,AUTO
         6 000116   200010 450500                    STP0    8,,AUTO
         6 000117   000002 236000 7                  LDQ     2
         6 000120   200007 756100                    STQ     7,,AUTO
         6 000121   200007 630500                    EPPR0   7,,AUTO
         6 000122   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 000123   000000 701000 xent               TSX1    VYF$FREE
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:28   
         6 000124   000000 011000                    NOP     0

       83    10446
       84    10447
       85    10448    2           CALL VYA$ND( VY_ROOT$, ADDR(NIL) );

  10448  6 000125   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 000126   200006 756100                    STQ     6,,AUTO
         6 000127   200006 630500                    EPPR0   6,,AUTO
         6 000130   200011 450500                    STP0    9,,AUTO
         6 000131   000001 236000 7                  LDQ     1
         6 000132   200010 756100                    STQ     8,,AUTO
         6 000133   200010 630500                    EPPR0   8,,AUTO
         6 000134   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 000135   000000 701000 xent               TSX1    VYA$ND
         6 000136   000000 011000                    NOP     0

       86    10449    2           VY_RUF$ = ADDR(NIL);

  10449  6 000137   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 000140   000000 756000 xsym               STQ     VY_RUF$

       87    10450
       88    10451
       89    10452    2           VY_O = VY_O_CONSTANT;

  10452  6 000141   000000 100400                    MLR     fill='000'O
         6 000142   000000 000110 xsym               ADSC9   VY_O_CONSTANT            cn=0,n=72
         6 000143   000000 000110 xsym               ADSC9   VY_O                     cn=0,n=72

       90    10453    2           VY_OD ='0'B;

  10453  6 000144   000000 100400                    MLR     fill='000'O
         6 000145   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         6 000146   000000 000020 xsym               ADSC9   VY_OD                    cn=0,n=16

       91    10454         /* Now parse */
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:29   
       92    10455    2           CALL VYP$PARSE;

  10455  6 000147   000002 631400 xsym               EPPR1   B_VECTNIL+2
         6 000150   000000 701000 xent               TSX1    VYP$PARSE
         6 000151   000000 011000                    NOP     0

       93    10456    3           IF VY_OD.MAP_ATTCH.DEF THEN DO;

  10456  6 000152   000001 236000 xsym               LDQ     VY_OD+1
         6 000153   200000 316003                    CANQ    65536,DU
         6 000154   000162 600000 6                  TZE     s:10461

       94    10457    3               VY_O.MAP_ATTCH.EDEF = 1;

  10457  6 000155   000001 235007                    LDA     1,DL
         6 000156   000010 755000 xsym               STA     VY_O+8

       95    10458    3               VY_O.MAP_ATTCH.DDEF = 1;

  10458  6 000157   000012 755000 xsym               STA     VY_O+10

       96    10459    3               VY_O.MAP_ATTCH.SDEF = 1;

  10459  6 000160   000014 755000 xsym               STA     VY_O+12

       97    10460    3               END;

  10460  6 000161   000172 710000 6                  TRA     s:10466

       98    10461    2           ELSE IF VY_OD.MAP_ATTCH.EDEF

  10461  6 000162   020000 316003                    CANQ    8192,DU
         6 000163   000170 601000 6                  TNZ     s:10465
         6 000164   004000 316003                    CANQ    2048,DU
         6 000165   000170 601000 6                  TNZ     s:10465
         6 000166   000001 430000 xsym               FSZN    VY_OD+1
         6 000167   000172 605000 6                  TPL     s:10466
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:30   

       99    10462    2                  OR
      100    10463    2                  VY_OD.MAP_ATTCH.DDEF
      101    10464    2                  OR
      102    10465    2                  VY_OD.MAP_ATTCH.SDEF THEN VY_O.MAP_ATTCH.DEF = 1;

  10465  6 000170   000001 235007                    LDA     1,DL
         6 000171   000005 755000 xsym               STA     VY_O+5

      103    10466    3           IF VY_OD.MAP_ATTCH.REF THEN DO;

  10466  6 000172   100000 316003                    CANQ    32768,DU
         6 000173   000201 600000 6                  TZE     s:10471

      104    10467    3               VY_O.MAP_ATTCH.EREF = 1;

  10467  6 000174   000001 235007                    LDA     1,DL
         6 000175   000011 755000 xsym               STA     VY_O+9

      105    10468    3               VY_O.MAP_ATTCH.DREF = 1;

  10468  6 000176   000013 755000 xsym               STA     VY_O+11

      106    10469    3               VY_O.MAP_ATTCH.SREF = 1;

  10469  6 000177   000015 755000 xsym               STA     VY_O+13

      107    10470    3               END;

  10470  6 000200   000211 710000 6                  TRA     s:10477

      108    10471    2           ELSE IF VY_OD.MAP_ATTCH.EREF

  10471  6 000201   010000 316003                    CANQ    4096,DU
         6 000202   000207 601000 6                  TNZ     s:10475
         6 000203   002000 316003                    CANQ    1024,DU
         6 000204   000207 601000 6                  TNZ     s:10475
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:31   
         6 000205   000400 316003                    CANQ    256,DU
         6 000206   000211 600000 6                  TZE     s:10477

      109    10472    2                  OR
      110    10473    2                  VY_OD.MAP_ATTCH.DREF
      111    10474    2                  OR
      112    10475    2                  VY_OD.MAP_ATTCH.SREF THEN VY_O.MAP_ATTCH.REF = 1;

  10475  6 000207   000001 235007                    LDA     1,DL
         6 000210   000006 755000 xsym               STA     VY_O+6

      113    10476        %EJECT;
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:32   
      114    10477    3           DO CASE( VY_COMMAND );

  10477  6 000211   000000 235000 xsym               LDA     VY_COMMAND
         6 000212   000014 115007                    CMPA    12,DL
         6 000213   000215 602005 6                  TNC     s:10477+4,AL
         6 000214   000302 710000 6                  TRA     s:10517
         6 000215   000302 710000 6                  TRA     s:10517
         6 000216   000302 710000 6                  TRA     s:10517
         6 000217   000302 710000 6                  TRA     s:10517
         6 000220   000231 710000 6                  TRA     s:10479
         6 000221   000234 710000 6                  TRA     PROCEED
         6 000222   000271 710000 6                  TRA     JUMP
         6 000223   000242 710000 6                  TRA     s:10489
         6 000224   000244 710000 6                  TRA     PROCESS
         6 000225   000244 710000 6                  TRA     PROCESS
         6 000226   000266 710000 6                  TRA     s:10504
         6 000227   000271 710000 6                  TRA     JUMP
         6 000230   000274 710000 6                  TRA     s:10513

      115    10478    3           CASE(3/*@C_COPY_KEY_WORD*/);

      116    10479    3               CALL SET_WRITE;

  10479  6 000231   000341 701000 6                  TSX1    SET_WRITE
         6 000232   000000 011000                    NOP     0

      117    10480    3               GOTO PROCEED;

  10480  6 000233   000234 710000 6                  TRA     PROCEED

      118    10481    3           CASE(

      119    10482    3                  4/*@C_EXTRACT_KEY_WORD*/ );
      120    10483    3   PROCEED:
      121    10484    3              CALL VYF$OPEN( VY_RUF$, 1/*@RF*/, VY_ON_OVER, '0'B/*@FALSE_B*/ ) ALTRET(
             10484                        NEXT_COMMAND);

PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:33   
  10484  6 000234   000010 630400 7     PROCEED      EPPR0   8
         6 000235   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 000236   000000 701000 xent               TSX1    VYF$OPEN
         6 000237   000033 702000 6                  TSX2    NEXT_COMMAND

      122    10485    3               VY_COPY_EXTRACT = '0'B/*@FALSE_B*/;

  10485  6 000240   000000 450000 xsym               STZ     VY_COPY_EXTRACT

      123    10486    3               GOTO PROCESS;

  10486  6 000241   000244 710000 6                  TRA     PROCESS

      124    10487    3           CASE(

      125    10488    3                  6/*@C_LIST_KEY_WORD*/ );
      126    10489    3               VY_LIST_HEADER = '0'B/*@FALSE_B*/;

  10489  6 000242   000000 450000 xsym               STZ     VY_LIST_HEADER

      127    10490    3               GOTO PROCESS;

  10490  6 000243   000244 710000 6                  TRA     PROCESS

      128    10491    3           CASE(

      129    10492    3                  7/*@C_LINKAGE_KEY_WORD*/,
      130    10493    3                  8/*@C_XREF_KEY_WORD*/);
      131    10494    3   PROCESS:
      132    10495    3               VY_INPUT_OPEN = 0;

  10495  6 000244   000000 450000 xsym  PROCESS      STZ     VY_INPUT_OPEN

      133    10496    3   PROCESS1:
      134    10497    3               CALL VYO$PROC;

  10497  6 000245   000002 631400 xsym  PROCESS1     EPPR1   B_VECTNIL+2
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:34   
         6 000246   000000 701000 xent               TSX1    VYO$PROC
         6 000247   000000 011000                    NOP     0

      135    10498    4               DO CASE( VY_COMMAND );

  10498  6 000250   000000 235000 xsym               LDA     VY_COMMAND
         6 000251   000005 115007                    CMPA    5,DL
         6 000252   000254 602005 6                  TNC     s:10498+4,AL
         6 000253   000302 710000 6                  TRA     s:10517
         6 000254   000265 710000 6                  TRA     s:10502
         6 000255   000265 710000 6                  TRA     s:10502
         6 000256   000265 710000 6                  TRA     s:10502
         6 000257   000261 710000 6                  TRA     s:10501
         6 000260   000261 710000 6                  TRA     s:10501

      136    10499    4               CASE( 3/*@C_COPY_KEY_WORD*/,

      137    10500    4                  4/*@C_EXTRACT_KEY_WORD*/ );
      138    10501    4                   CALL VYF$CLOSE( VY_RUF$, 1/*@RF*/, 2/*@SAVE*/ );

  10501  6 000261   000014 630400 7                  EPPR0   12
         6 000262   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 000263   000000 701000 xent               TSX1    VYF$CLOSE
         6 000264   000000 011000                    NOP     0

      139    10502    4                   END;

  10502  6 000265   000302 710000 6                  TRA     s:10517

      140    10503    3           CASE(9/*@C_DEFINE_KEY_WORD*/);

      141    10504    3               CALL SET_WRITE;

  10504  6 000266   000341 701000 6                  TSX1    SET_WRITE
         6 000267   000000 011000                    NOP     0

      142    10505    3               GOTO JUMP;
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:35   

  10505  6 000270   000271 710000 6                  TRA     JUMP

      143    10506    3           CASE(

      144    10507    3                  10/*@C_DROP_KEY_WORD*/,
      145    10508    3                  5/*@C_DELETE_KEY_WORD*/ );
      146    10509    3   JUMP:
      147    10510    3               VY_INPUT_OPEN = 2;

  10510  6 000271   000002 235007       JUMP         LDA     2,DL
         6 000272   000000 755000 xsym               STA     VY_INPUT_OPEN

      148    10511    3               GOTO PROCESS1;

  10511  6 000273   000245 710000 6                  TRA     PROCESS1

      149    10512    3           CASE(11/*@C_END_KEY_WORD*/);

      150    10513    3               CALL M$CLOSE( VY_LO_FPT_CLOSE );

  10513  6 000274   000046 630400 1                  EPPR0   VY_LO_FPT_CLOSE
         6 000275   050001 713400                    CLIMB   close
         6 000276   406000 401760                    pmme    nvectors=13

      151    10514    3               CALL VYI$EXIT;

  10514  6 000277   000002 631400 xsym               EPPR1   B_VECTNIL+2
         6 000300   000000 701000 xent               TSX1    VYI$EXIT
         6 000301   000000 011000                    NOP     0

      152    10515    3               END;

      153    10516
      154    10517    2           IF VY_O.MAP_ATTCH.DEF + VY_O.MAP_ATTCH.REF > 0 THEN CALL VYM$MAP;

  10517  6 000302   000005 236000 xsym               LDQ     VY_O+5
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:36   
         6 000303   000006 036000 xsym               ADLQ    VY_O+6
         6 000304   000310 600000 6                  TZE     s:10519

  10517  6 000305   000002 631400 xsym               EPPR1   B_VECTNIL+2
         6 000306   000000 701000 xent               TSX1    VYM$MAP
         6 000307   000000 011000                    NOP     0

      155    10518
      156    10519    3           DO WHILE( '0'B );

  10519  6 000310   000033 710000 6                  TRA     NEXT_COMMAND

      157    10520    3   RESTART:
      158    10521    4               IF M$OF$ -> F$DCB.FCD# THEN DO;

  10521  6 000311   000000 470400 xsym  RESTART      LDP0    M$OF$
         6 000312   000031 236100                    LDQ     25,,PR0
         6 000313   020000 316007                    CANQ    8192,DL
         6 000314   000320 600000 6                  TZE     s:10525

      159    10522    4                   CALL M$CLOSE( FPT_CLOSE_OF );

  10522  6 000315   000000 630400 5                  EPPR0   FPT_CLOSE_OF
         6 000316   050001 713400                    CLIMB   close
         6 000317   406000 401760                    pmme    nvectors=13

      160    10523    4                   END;

      161    10524
      162    10525    4               IF M$RF$ -> F$DCB.FCD# THEN DO;

  10525  6 000320   000000 470400 xsym               LDP0    M$RF$
         6 000321   000031 236100                    LDQ     25,,PR0
         6 000322   020000 316007                    CANQ    8192,DL
         6 000323   000337 600000 6                  TZE     s:10534

      163    10526    5                   IF VY_ON_OVER = 4/*@C_OVER_KEY_WORD*/ THEN DO;
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:37   

  10526  6 000324   000000 235000 xsym               LDA     VY_ON_OVER
         6 000325   000004 115007                    CMPA    4,DL
         6 000326   000332 601000 6                  TNZ     s:10530

      164    10527    5                       FPT_CLOSE_RF.V.DISP# = 1;

  10527  6 000327   000001 236007                    LDQ     1,DL
         6 000330   000042 552004 1                  STBQ    FPT_CLOSE_RF+26,'04'O

      165    10528    5                       END;

  10528  6 000331   000334 710000 6                  TRA     s:10532

      166    10529    5                   ELSE DO;

      167    10530    5                       FPT_CLOSE_RF.V.DISP# = 2;

  10530  6 000332   000002 236007                    LDQ     2,DL
         6 000333   000042 552004 1                  STBQ    FPT_CLOSE_RF+26,'04'O

      168    10531    5                       END;

      169    10532    4                   CALL M$CLOSE( FPT_CLOSE_RF );

  10532  6 000334   000010 630400 1                  EPPR0   FPT_CLOSE_RF
         6 000335   050001 713400                    CLIMB   close
         6 000336   406000 401760                    pmme    nvectors=13

      170    10533    4                   END;

      171    10534    3               VY_OD_SEARCH = '0'B;

  10534  6 000337   000000 450000 xsym               STZ     VY_OD_SEARCH

      172    10535    3               END; /* Do never */

PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:38   
      173    10536    2           END; /* Do forever */

  10536  6 000340   000033 710000 6                  TRA     NEXT_COMMAND

      174    10537        %EJECT;
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:39   
      175    10538
      176    10539
      177    10540    1   SET_WRITE: PROC;

  10540  6 000341   200004 741300       SET_WRITE    STX1  ! 4,,AUTO

      178    10541
      179    10542
      180    10543    3       IF ~VY_OD.PRIMARY_OPTION.DUPLICATE THEN DO; /* None specified */

  10543  6 000342   000000 236000 xsym               LDQ     VY_OD
         6 000343   000001 736000                    QLS     1
         6 000344   400000 376003                    ANQ     -131072,DU
         6 000345   400000 676003                    ERQ     -131072,DU
         6 000346   000360 600000 6                  TZE     s:10552

      181    10544    4           IF VY_ONLINE = 1/*@YES*/ THEN DO;

  10544  6 000347   000000 235000 xsym               LDA     VY_ONLINE
         6 000350   000001 115007                    CMPA    1,DL
         6 000351   000355 601000 6                  TNZ     s:10548

      182    10545    4               VY_O.PRIMARY_OPTION.DUPLICATE = 1/*@C_INQUIRE_KEY_WORD*/;

  10545  6 000352   000001 236007                    LDQ     1,DL
         6 000353   000001 756000 xsym               STQ     VY_O+1

      183    10546    4               END;

  10546  6 000354   000367 710000 6                  TRA     s:10557

      184    10547    4           ELSE DO;

      185    10548    4               VY_O.PRIMARY_OPTION.DUPLICATE = 2/*@C_ERROR_KEY_WORD*/;

  10548  6 000355   000002 236007                    LDQ     2,DL
         6 000356   000001 756000 xsym               STQ     VY_O+1
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:40   

      186    10549    4               END;

      187    10550    3           END;

  10550  6 000357   000367 710000 6                  TRA     s:10557

      188    10551    3       ELSE DO; /* One was specified */

      189    10552    4           IF VY_ONLINE = 0/*@NO*/ AND VY_O.PRIMARY_OPTION.DUPLICATE = 1
             10552                    /*@C_INQUIRE_KEY_WORD*/ THEN DO;

  10552  6 000360   000000 235000 xsym               LDA     VY_ONLINE
         6 000361   000367 601000 6                  TNZ     s:10557
         6 000362   000001 236000 xsym               LDQ     VY_O+1
         6 000363   000001 116007                    CMPQ    1,DL
         6 000364   000367 601000 6                  TNZ     s:10557

      190    10553    4               VY_O.PRIMARY_OPTION.DUPLICATE = 2/*@C_ERROR_KEY_WORD*/;

  10553  6 000365   000002 235007                    LDA     2,DL
         6 000366   000001 755000 xsym               STA     VY_O+1

      191    10554    4               END;

      192    10555    3           END;

      193    10556
      194    10557    2       IF VY_O.PRIMARY_OPTION.DUPLICATE = 3/*@C_OVERWRITE_KEY_WORD*/

  10557  6 000367   000001 235000 xsym               LDA     VY_O+1
         6 000370   000003 115007                    CMPA    3,DL
         6 000371   000375 601000 6                  TNZ     s:10559

      195    10558    2       THEN VY_INV_OWRITE = '1'B/*@TRUE_B*/;

  10558  6 000372   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:41   
         6 000373   000000 756000 xsym               STQ     VY_INV_OWRITE
         6 000374   000376 710000 6                  TRA     s:10560

      196    10559    2       ELSE VY_INV_OWRITE = '0'B/*@FALSE_B*/;

  10559  6 000375   000000 450000 xsym               STZ     VY_INV_OWRITE

      197    10560    2   END;

  10560  6 000376   000001 702211                    TSX2  ! 1,X1
      198    10561    1   END VYM$MAIN;
      199    10562        %EOD;

PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:42   
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   VY_PSUBS_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   VY_DCB_R.:E05TOU  cannot be made into a system file and is referenced.
   VY_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VY_FIXED_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VY_MACRO_C.:E05TOU  is referenced.
   VY_PERR_C.:E05TOU  is referenced.
   VY_SUBS_C.:E05TOU  is referenced.
   VY_INC_NO_C.:E05TOU  is referenced.
   VY_SWITCH_C.:E05TOU  is referenced.
   VY_INC_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VYM$MAIN.
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:43   

 **** Variables and constants ****

  ****  Section 001  Data  VYM$MAIN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    10-0-0/d STRC(1080)  r     1 FPT_CLOSE_RF               5-0-0/w UBIN        r     1 GDP_FREE_POINT
     1-0-0/w UBIN        r     1 I                          2-0-0/w UBIN        r     1 J
    46-0-0/d STRC(1080)  r     1 VY_LO_FPT_CLOSE

  ****  Section 005 RoData VYM$MAIN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(1080)  r     1 FPT_CLOSE_OF

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 M$OF$                      0-0-0/w PTR         r     1 M$RF$
     0-0-0/w UBIN        r     1 VY_COMMAND                 0-0-0/w BIT         r     1 VY_COPY_EXTRACT
     0-0-0/w PTR         r     1 VY_CURR$                   0-0-0/w UBIN        r     1 VY_INPUT_OPEN
     0-0-0/w BIT         r     1 VY_INV_OWRITE              0-0-0/w BIT         r     1 VY_LIST_HEADER
     0-0-0/w SBIN        r     1 VY_M_ALL(0:8)
     0-0-0/w PTR         r     1 VY_M_BASE_PTR(0:8)
     0-0-0/w SBIN        r     1 VY_M_FREE(0:8)
     0-0-0/w STRC(648)   r     1 VY_O                       0-0-0/w STRC(144)   r     1 VY_OD
     0-0-0/b BIT         r     1 VY_OD_SEARCH               0-0-0/w UBIN        r     1 VY_ONLINE
     0-0-0/w UBIN        r     1 VY_ON_OVER                 0-0-0/w STRC(648)   r     1 VY_O_CONSTANT
     0-0-0/w PTR         r     1 VY_ROOT$                   0-0-0/w PTR         r     1 VY_RUF$
     0-0-0/d REMB        r     1 VY_UNWIND

  ****  BASED and DCB variables  ****
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:44   

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$LO
     0-0-0N  NULL        r     1 M$OF                       0-0-0N  NULL        r     1 M$RF
     0-0-0/w STRC(3672)  r     1 VY$NODE


   Procedure VYM$MAIN requires 255 words for executable code.
   Procedure VYM$MAIN requires 10 words of local(AUTO) storage.
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:45   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:46   
          MINI XREF LISTING

F$DCB.ACTPOS
     10202**DCL     10202--REDEF
F$DCB.ARS#
     10176**DCL     10176--REDEF
F$DCB.ATTR
     10195**DCL     10196--REDEF
F$DCB.BORROW
     10210**DCL     10210--REDEF   10210--REDEF   10210--REDEF
F$DCB.DCBNAME.L
     10224**DCL     10224--IMP-SIZ
F$DCB.EOMCHAR#
     10180**DCL     10180--REDEF
F$DCB.FCD#
     10189**DCL     10521>>IF      10525>>IF
F$DCB.FLDID
     10205**DCL     10205--REDEF
F$DCB.FORM$
     10199**DCL     10199--REDEF
F$DCB.FSECT
     10215**DCL     10215--REDEF
F$DCB.FSN#
     10192**DCL     10192--REDEF   10192--REDEF   10193--REDEF
F$DCB.HEADER$
     10198**DCL     10198--REDEF
F$DCB.IXTNSIZE#
     10196**DCL     10196--REDEF
F$DCB.LASTSTA$
     10185**DCL     10185--REDEF
F$DCB.LVL
     10211**DCL     10211--REDEF
F$DCB.NAME#.C
     10186**DCL     10186--REDEF
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:47   
F$DCB.NOEOF
     10208**DCL     10208--REDEF
F$DCB.NRECS#
     10197**DCL     10197--REDEF
F$DCB.NRECX
     10216**DCL     10216--REDEF
F$DCB.OHDR
     10208**DCL     10208--REDEF
F$DCB.ORG#
     10191**DCL     10191--REDEF
F$DCB.PRECNO
     10214**DCL     10214--REDEF
F$DCB.RCSZ
     10220**DCL     10220--REDEF
F$DCB.RES#
     10187**DCL     10187--REDEF
F$DCB.SETX
     10199**DCL     10199--REDEF
F$DCB.TAB$
     10199**DCL     10199--REDEF
F$DCB.TDA
     10213**DCL     10214--REDEF
F$DCB.WSN#
     10187**DCL     10187--REDEF
FPT_CLOSE_OF
     10105**DCL     10522<>CALL
FPT_CLOSE_OF.SN_
     10105**DCL     10105--REDEF
FPT_CLOSE_OF.UTL_
     10106**DCL     10106--REDEF
FPT_CLOSE_OF.V
     10110**DCL     10105--DCLINIT
FPT_CLOSE_OF.V.EXPIRE#
     10120**DCL     10120--REDEF
FPT_CLOSE_OF.V.TYPE#
     10118**DCL     10118--REDEF
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:48   
FPT_CLOSE_OF.V.XTNSIZE#
     10115**DCL     10115--REDEF   10117--REDEF
FPT_CLOSE_RF
     10150**DCL     10532<>CALL
FPT_CLOSE_RF.SN_
     10150**DCL     10150--REDEF
FPT_CLOSE_RF.UTL_
     10151**DCL     10151--REDEF
FPT_CLOSE_RF.V
     10155**DCL     10150--DCLINIT
FPT_CLOSE_RF.V.DISP#
     10159**DCL     10527<<ASSIGN  10530<<ASSIGN
FPT_CLOSE_RF.V.EXPIRE#
     10165**DCL     10165--REDEF
FPT_CLOSE_RF.V.TYPE#
     10163**DCL     10163--REDEF
FPT_CLOSE_RF.V.XTNSIZE#
     10160**DCL     10160--REDEF   10162--REDEF
GDP_FREE_POINT
     10024**DCL     10426<<ASSIGN  10444>>IF      10445>>CALL
I
     10015**DCL     10016--REDEF   10430<<DOINDEX 10431>>IF      10432>>IF      10433>>IF      10434>>IF
     10435>>ASSIGN  10437<>CALL    10440>>IF      10440<>CALL    10440>>CALL
J
     10017**DCL     10018--REDEF   10435<<ASSIGN  10436<<ASSIGN  10437<>CALL
JUMP
     10510**LABEL   10505--GOTO
K
     10019**DCL     10020--REDEF
L
     10021**DCL     10022--REDEF
M$CLOSE
      1611**DCL-ENT 10513--CALL    10522--CALL    10532--CALL
M$OF$
      5758**DCL     10521>>IF
M$RF$
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:49   
      5758**DCL     10525>>IF
NEXT_COMMAND
     10430**LABEL   10484--CALLALT
PROCEED
     10484**LABEL   10480--GOTO
PROCESS
     10495**LABEL   10486--GOTO    10490--GOTO
PROCESS1
     10497**LABEL   10511--GOTO
RESTART
     10521**LABEL   10427--REMEMBR
SET_WRITE
     10540**PROC    10479--CALL    10504--CALL
VY$NODE
      9823**DCL     10419--IF      10421--ASSIGN  10423--CALL
VY$NODE.ADDR_START_A
      9836**DCL      9837--REDEF
VY$NODE.ADDR_STOP_A
      9841**DCL      9842--REDEF
VY$NODE.L_PREV_SIZE
      9894**DCL      9905--REDEF
VY$NODE.L_SC_START
      9913**DCL      9918--REDEF
VY$NODE.L_SC_STOP
      9919**DCL      9924--REDEF
VY$NODE.L_SIZE
      9882**DCL      9893--REDEF
VY$NODE.L_START
      9858**DCL      9869--REDEF
VY$NODE.L_STOP
      9870**DCL      9881--REDEF
VY$NODE.PROMOTE_HEAD
      9925**DCL      9928--REDEF
VY$NODE.PROMOTE_TAIL
      9929**DCL      9932--REDEF
VY$NODE.START_PAGE#_A
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:50   
      9846**DCL      9847--REDEF
VY$NODE.STOP_PAGE#_A
      9851**DCL      9852--REDEF
VYA$GET
      9983**DCL-ENT 10423--CALL
VYA$ND
      9988**DCL-ENT 10448--CALL
VYF$CLOSE
      9996**DCL-ENT 10501--CALL
VYF$FREE
      9984**DCL-ENT 10437--CALL    10440--CALL    10445--CALL
VYF$OPEN
      9995**DCL-ENT 10484--CALL
VYI$EXIT
      9990**DCL-ENT 10514--CALL
VYI$INIT
      9991**DCL-ENT 10417--CALL
VYM$MAP
      9994**DCL-ENT 10517--CALL
VYO$PROC
      9993**DCL-ENT 10497--CALL
VYP$PARSE
      9992**DCL-ENT 10455--CALL
VY_BIAS.A
      5390**DCL      5390--REDEF
VY_CBUF.CHARS_A
      5381**DCL      5381--REDEF
VY_COMMAND
      5381**DCL     10477>>DOCASE  10498>>DOCASE
VY_COPY_EXTRACT
      5748**DCL     10485<<ASSIGN
VY_CURR$
      5385**DCL     10425<<ASSIGN
VY_EBUF.CHARS_A
      5682**DCL      5683--REDEF
VY_EFIELD1.CHARS
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:51   
      5683**DCL      5683--REDEF
VY_EFIELD2.CHARS
      5684**DCL      5684--REDEF
VY_EFIELD3.CHARS
      5685**DCL      5685--REDEF
VY_ERRORS
      5386**DCL      5388--REDEF
VY_ERRORS.CONFLICT_A
      5387**DCL      5388--REDEF
VY_ERRORS.UNSAT_A
      5386**DCL      5387--REDEF
VY_IMAGE_DATA.CPAGE#_A
      5274**DCL      5275--REDEF
VY_IMAGE_DATA.NODE_A$
      5286**DCL      5287--REDEF
VY_IMAGE_DATA.START_A$
      5278**DCL      5279--REDEF
VY_IMAGE_DATA.STOP_A$
      5282**DCL      5283--REDEF
VY_IMAGE_PROC.CPAGE#_A
      5297**DCL      5298--REDEF
VY_IMAGE_PROC.NODE_A$
      5309**DCL      5310--REDEF
VY_IMAGE_PROC.START_A$
      5301**DCL      5302--REDEF
VY_IMAGE_PROC.STOP_A$
      5305**DCL      5306--REDEF
VY_IMAGE_ROS.CPAGE#_A
      5320**DCL      5321--REDEF
VY_IMAGE_ROS.NODE_A$
      5332**DCL      5333--REDEF
VY_IMAGE_ROS.START_A$
      5324**DCL      5325--REDEF
VY_IMAGE_ROS.STOP_A$
      5328**DCL      5329--REDEF
VY_INPUT_OPEN
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:52   
      5744**DCL     10495<<ASSIGN  10510<<ASSIGN
VY_INV_OWRITE
      5744**DCL     10558<<ASSIGN  10559<<ASSIGN
VY_LIST_HEADER
      5742**DCL     10489<<ASSIGN
VY_LO_FPT_CLOSE
     10252**DCL     10513<>CALL
VY_LO_FPT_CLOSE.SN_
     10252**DCL     10252--REDEF
VY_LO_FPT_CLOSE.UTL_
     10253**DCL     10253--REDEF
VY_LO_FPT_CLOSE.V
     10257**DCL     10252--DCLINIT
VY_LO_FPT_CLOSE.V.EXPIRE#
     10267**DCL     10267--REDEF
VY_LO_FPT_CLOSE.V.TYPE#
     10265**DCL     10265--REDEF
VY_LO_FPT_CLOSE.V.XTNSIZE#
     10262**DCL     10262--REDEF   10264--REDEF
VY_MAP_HDR.CHARS
      5747**DCL      5748--REDEF    5748--REDEF
VY_MAP_LIT_LO_FPT_WRITE.STATION_
      5076**DCL      5076--REDEF
VY_MAP_LIT_LO_FPT_WRITE.V.DVBYTE.VFC#
      5083**DCL      5083--REDEF
VY_MAP_LO_FPT_WRITE.STATION_
      5045**DCL      5045--REDEF
VY_MAP_LO_FPT_WRITE.V.DVBYTE.VFC#
      5052**DCL      5052--REDEF
VY_MBUF.CHARS
      5746**DCL      5747--REDEF    5747--REDEF
VY_M_ALL
      5391**DCL     10419>>IF      10433>>IF
VY_M_BASE_PTR
      5392**DCL     10420>>ASSIGN
VY_M_FREE
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:53   
      5391**DCL     10419>>IF      10420>>ASSIGN  10421<<ASSIGN  10421>>ASSIGN  10426>>ASSIGN  10430--DOINDEX
     10432>>IF      10434>>IF      10435>>ASSIGN  10440>>IF      10440<>CALL    10444>>IF      10445>>CALL
VY_M_VECTOR.F
      5115**DCL      5119--REDEF
VY_M_VECTOR_DP.F
      5150**DCL      5154--REDEF
VY_O
      5509**DCL     10452<<ASSIGN
VY_O.DUPL_ATTCH
      5528**DCL      5532--REDEF
VY_O.MAP_ATTCH
      5516**DCL      5527--REDEF
VY_O.MAP_ATTCH.DDEF
      5523**DCL     10458<<ASSIGN
VY_O.MAP_ATTCH.DEF
      5518**DCL     10465<<ASSIGN  10517>>IF
VY_O.MAP_ATTCH.DREF
      5524**DCL     10468<<ASSIGN
VY_O.MAP_ATTCH.EDEF
      5521**DCL     10457<<ASSIGN
VY_O.MAP_ATTCH.EREF
      5522**DCL     10467<<ASSIGN
VY_O.MAP_ATTCH.REF
      5519**DCL     10475<<ASSIGN  10517>>IF
VY_O.MAP_ATTCH.SDEF
      5525**DCL     10459<<ASSIGN
VY_O.MAP_ATTCH.SREF
      5526**DCL     10469<<ASSIGN
VY_O.PRIMARY_OPTION
      5510**DCL      5515--REDEF
VY_O.PRIMARY_OPTION.DUPLICATE
      5512**DCL     10545<<ASSIGN  10548<<ASSIGN  10552>>IF      10553<<ASSIGN  10557>>IF
VY_O.SEV_ATTCH
      5533**DCL      5535--REDEF
VY_OD
      5653**DCL     10453<<ASSIGN
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:54   
VY_OD.DUPL_ATTCH
      5672**DCL      5676--REDEF
VY_OD.MAP_ATTCH
      5660**DCL      5671--REDEF
VY_OD.MAP_ATTCH.DDEF
      5667**DCL     10461>>IF
VY_OD.MAP_ATTCH.DEF
      5662**DCL     10456>>IF
VY_OD.MAP_ATTCH.DREF
      5668**DCL     10471>>IF
VY_OD.MAP_ATTCH.EDEF
      5665**DCL     10461>>IF
VY_OD.MAP_ATTCH.EREF
      5666**DCL     10471>>IF
VY_OD.MAP_ATTCH.REF
      5663**DCL     10466>>IF
VY_OD.MAP_ATTCH.SDEF
      5669**DCL     10461>>IF
VY_OD.MAP_ATTCH.SREF
      5670**DCL     10471>>IF
VY_OD.PRIMARY_OPTION
      5654**DCL      5659--REDEF
VY_OD.PRIMARY_OPTION.DUPLICATE
      5656**DCL     10543>>IF
VY_OD.SEV_ATTCH
      5677**DCL      5679--REDEF
VY_OD_SEARCH
      5377**DCL     10534<<ASSIGN
VY_OL_KEY_BUF.FORM0
      5183**DCL      5186--REDEF    5193--REDEF
VY_ONLINE
      5392**DCL     10544>>IF      10552>>IF
VY_ON_OVER
      5381**DCL     10484<>CALL    10526>>IF
VY_OU_HEAD.REC_A
      5371**DCL      5372--REDEF
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:55   
VY_O_CONSTANT
     10387**DCL     10452>>ASSIGN
VY_O_CONSTANT.DUPL_ATTCH
     10406**DCL     10410--REDEF
VY_O_CONSTANT.MAP_ATTCH
     10394**DCL     10405--REDEF
VY_O_CONSTANT.PRIMARY_OPTION
     10388**DCL     10393--REDEF
VY_O_CONSTANT.SEV_ATTCH
     10411**DCL     10413--REDEF
VY_O_KEY_BUF.FORM0
      5160**DCL      5163--REDEF    5170--REDEF
VY_O_KEY_BUF_L.FORM0
      5206**DCL      5209--REDEF    5216--REDEF
VY_PAR_UNWIND
      5741**DCL      5741--REDEF
VY_PASS2_REF.OU.L_START
      5708**DCL      5709--REDEF
VY_PASS2_REF.OU.L_STOP
      5709**DCL      5710--REDEF
VY_PASS2_REF.OU.MAX
      5707**DCL      5708--REDEF
VY_PASS2_REF.OU.SIZE
      5710**DCL      5711--REDEF
VY_PASS2_REF.SAT.COUNT
      5714**DCL      5715--REDEF
VY_PASS2_REF.SAT.ENT_SIZE
      5716**DCL      5717--REDEF
VY_PASS2_REF.SAT.L_START
      5712**DCL      5713--REDEF
VY_PASS2_REF.SAT.L_STOP
      5713**DCL      5714--REDEF
VY_PASS2_REF.SAT.MAX
      5711**DCL      5712--REDEF
VY_PASS2_REF.UNSAT.L_START
      5718**DCL      5719--REDEF
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:56   
VY_PASS2_REF.UNSAT.L_STOP
      5719**DCL      5720--REDEF
VY_PASS2_REF.UNSAT.L_WHERE
      5720**DCL      5721--REDEF
VY_PASS2_REF.UNSAT.MAX
      5717**DCL      5718--REDEF
VY_PASS2_REF.UNSAT.PAGE#
      5722**DCL      5723--REDEF
VY_PASS2_REF.UNSAT.SIZE
      5721**DCL      5722--REDEF
VY_PROGRAM_BIAS.A
      5389**DCL      5389--REDEF
VY_ROOT$
      5384**DCL     10420<<ASSIGN  10423<>CALL    10425>>ASSIGN  10448<>CALL
VY_RUF$
      5384**DCL     10449<<ASSIGN  10484<>CALL    10501<>CALL
VY_RU_HEAD.DATA_SEGMENT
      5357**DCL      5357--REDEF
VY_RU_HEAD.L
      5353**DCL      5354--REDEF
VY_RU_HEAD.MAP_BITS
      5354**DCL      5356--REDEF
VY_RU_HEAD.PBIT
      5350**DCL      5350--REDEF
VY_RU_HEAD_BUF.DATA_SEGMENT
      5367**DCL      5367--REDEF
VY_RU_HEAD_BUF.L
      5362**DCL      5363--REDEF
VY_RU_HEAD_BUF.MAP_BITS
      5364**DCL      5366--REDEF
VY_RU_HEAD_BUF.PBIT
      5359**DCL      5360--REDEF
VY_R_KEY_BUF.FORM0
      5229**DCL      5233--REDEF    5239--REDEF
VY_SI_KEY_BUF.KEY
      5737**DCL      5737--REDEF
PL6.E3A0      #001=VYM$MAIN File=VYM$MAIN.:E05TSI                                WED 07/30/97 08:57 Page:57   
VY_SPC.B$.MINE
      5732**DCL      5733--REDEF
VY_SPC.B$.NAME
      5729**DCL      5729--REDEF
VY_SPC.B$.SKIP
      5731**DCL      5732--REDEF
VY_SPC.B$.VALUE
      5730**DCL      5731--REDEF
VY_SPC.SEG.NAME
      5724**DCL      5725--REDEF
VY_SPC.SEG.VALUE
      5725**DCL      5726--REDEF
VY_TSX0_OVERLAY.H
      5696**DCL      5697--REDEF
VY_UNWIND
      5741**DCL     10427<<REMEMBR

PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:58   
      200        1        /*M*  VYM$MAP - produces the map for the map options specified on a COPY or
      201        2                        LIST command.    */
      202        3        /*T***********************************************************/
      203        4        /*T*                                                         */
      204        5        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      205        6        /*T*                                                         */
      206        7        /*T***********************************************************/
      207        8
      208        9
      209       10        VYM$MAP: PROC;
      210       11
      211       12        %INCLUDE VY_INC_C;
      212     9188        %VY$NODE;

              9200    1   /*******************************************************************************
              9201    1   *                                                                              *
              9202    1   *                          VY$NODE                                                 *
              9203    1   *                                                                              *
              9204    1   *******************************************************************************/

              9220    1   DCL 1 VY$NODE      ALIGNED    BASED,
              9221    1         2 SON$ PTR /*(ADDR(NIL))*/, /* Son pointer                      */
              9222    1         2 BROTHER$ PTR /*(ADDR(NIL))*/, /* Brother pointer              */
              9223    1         2 FATHER$ PTR /*(ADDR(NIL))*/, /* Father pointer                */
              9224    1         2 PATH$ PTR /*(ADDR(NIL))*/, /* Path   pointer                  */
              9225    1         2 HEAD$       PTR /*(ADDR(NIL))*/, /* Head pointer to
              9226                              to list of file nodes for this node            */
              9227    1         2 TAIL$ PTR /*(ADDR(NIL))*/, /* Tail pointer to list            */
              9228    1         2 SHARED_LIB_HEAD$ PTR /*(ADDR(NIL))*/,
              9228                  /* Head pointer to shared library list */
              9229    1         2 LIB_HEAD$         PTR /*(ADDR(NIL))*/,
              9229                  /* Head pointer to list of shared libraries
              9230                                          which have been mapped to included libraries */
              9231    1         2 NUM          UBIN(36)  UNAL,    /* Node number                        */
              9232    1         2 DEPTH          UBIN(36)  UNAL,  /* Depth; ROOT=0*/
              9233    1         2 ADDR_START_A(0:2/*@ROS*/) SBIN WORD /*(0*3)*/, /* Array            */
              9234    1         2 ADDR_START REDEF  ADDR_START_A,
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:59   
              9235    1           3 RDATA       SBIN WORD,   /* First address for this node in data     */
              9236    1           3 RPROC       SBIN WORD,   /* First address for this node in proc     */
              9237    1           3 ROS       SBIN WORD,          /* Last address for program in ros    */
              9238    1         2 ADDR_STOP_A(0:2/*@ROS*/) SBIN WORD /*(-1*3)*/, /* Array            */
              9239    1         2 ADDR_STOP  REDEF  ADDR_STOP_A,
              9240    1           3 RDATA       SBIN WORD,        /* Last address for this node in data */
              9241    1           3 RPROC       SBIN WORD,        /* Last address for this node in proc */
              9242    1           3 ROS       SBIN WORD,          /* Last address for program in ros    */
              9243    1         2 START_PAGE#_A(0:2/*@ROS*/) SBIN WORD /*(0*3)*/, /* Array           */
              9244    1         2 START_PAGE# REDEF START_PAGE#_A,
              9245    1           3 RDATA       SBIN WORD,   /* First page    for this node in data     */
              9246    1           3 RPROC       SBIN WORD,   /* First page    for this node in proc     */
              9247    1           3 ROS       SBIN WORD,          /* First page   for program in ros    */
              9248    1         2 STOP_PAGE#_A(0:2/*@ROS*/) SBIN WORD /*(-1*3)*/, /* Array*/
              9249    1         2 STOP_PAGE#  REDEF STOP_PAGE#_A,
              9250    1           3 RDATA       SBIN WORD,   /* Last  page    for this node in data     */
              9251    1           3 RPROC       SBIN WORD,   /* Last  page    for this node in proc     */
              9252    1           3 ROS       SBIN WORD,          /* Last  page   for program in ros    */
              9253    1         2 START_SC_ALL$ PTR /*(ADDR(NIL))*/,
              9253                  /* Starting pointer for common sections for this node */
              9254    1         2 STOP_SC_ALL$ PTR /*(ADDR(NIL))*/,
              9254                  /* Stopping pointer for common sections for this node */
              9255    1         2 L_START,
              9256    1           3 SN$ PTR /*(ADDR(NIL))*/, /* Segment definition names        */
              9257    1           3 DN$ PTR /*(ADDR(NIL))*/, /* Def names                       */
              9258    1           3 RN$ PTR /*(ADDR(NIL))*/, /* Ref names                       */
              9259    1           3 SC$ PTR /*(ADDR(NIL))*/, /* Sections                        */
              9260    1           3 ED$ PTR /*(ADDR(NIL))*/, /* Entry defs*/
              9261    1           3 ER$ PTR /*(ADDR(NIL))*/, /* Entry refs*/
              9262    1           3 DD$ PTR /*(ADDR(NIL))*/, /* Data defs                       */
              9263    1           3 DR$ PTR /*(ADDR(NIL))*/, /* Data refs                       */
              9264    1           3 SD$ PTR /*(ADDR(NIL))*/, /* Seg defs                        */
              9265    1           3 SR$ PTR /*(ADDR(NIL))*/, /* Seg refs                        */
              9266    1         2 L_START_A$(0:9)     REDEF L_START PTR,
              9267    1         2 L_STOP,
              9268    1           3 SN$ PTR /*(ADDR(NIL))*/, /* Segment definition names        */
              9269    1           3 DN$ PTR /*(ADDR(NIL))*/, /* Def names                       */
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:60   
              9270    1           3 RN$ PTR /*(ADDR(NIL))*/, /* Ref names                       */
              9271    1           3 SC$ PTR /*(ADDR(NIL))*/, /* Sections                        */
              9272    1           3 ED$ PTR /*(ADDR(NIL))*/, /* Entry defs*/
              9273    1           3 ER$ PTR /*(ADDR(NIL))*/, /* Entry refs*/
              9274    1           3 DD$ PTR /*(ADDR(NIL))*/, /* Data defs                       */
              9275    1           3 DR$ PTR /*(ADDR(NIL))*/, /* Data refs                       */
              9276    1           3 SD$ PTR /*(ADDR(NIL))*/, /* Seg defs                        */
              9277    1           3 SR$ PTR /*(ADDR(NIL))*/, /* Seg refs                        */
              9278    1         2 L_STOP_A$(0:9) REDEF   L_STOP    PTR,
              9279    1         2 L_SIZE,
              9280    1           3 SN      UBIN /*(0)*/, /* Segment definition names           */
              9281    1           3 DN      UBIN /*(0)*/, /* Def names                          */
              9282    1           3 RN      UBIN /*(0)*/, /* Ref names                          */
              9283    1           3 SC      UBIN /*(0)*/, /* Sections                           */
              9284    1           3 ED      UBIN /*(0)*/, /* Entry defs*/
              9285    1           3 ER      UBIN /*(0)*/, /* Entry refs*/
              9286    1           3 DD      UBIN /*(0)*/, /* Data defs                          */
              9287    1           3 DR      UBIN /*(0)*/, /* Data refs                          */
              9288    1           3 SD      UBIN /*(0)*/, /* Seg defs                           */
              9289    1           3 SR      UBIN /*(0)*/, /* Seg refs                           */
              9290    1         2 L_SIZE_A(0:9)  REDEF   L_SIZE    UBIN,
              9291    1         2 L_PREV_SIZE,
              9292    1           3 SN      UBIN /*(0)*/, /* Segment definition names           */
              9293    1           3 DN      UBIN /*(0)*/, /* Def names                          */
              9294    1           3 RN      UBIN /*(0)*/, /* Ref names                          */
              9295    1           3 SC      UBIN /*(0)*/, /* Sections                           */
              9296    1           3 ED      UBIN /*(0)*/, /* Entry defs*/
              9297    1           3 ER      UBIN /*(0)*/, /* Entry refs*/
              9298    1           3 DD      UBIN /*(0)*/, /* Data defs                          */
              9299    1           3 DR      UBIN /*(0)*/, /* Data refs                          */
              9300    1           3 SD      UBIN /*(0)*/, /* Seg defs                           */
              9301    1           3 SR      UBIN /*(0)*/, /* Seg refs                           */
              9302    1         2 L_PREV_SIZE_A(0:9)  REDEF   L_PREV_SIZE    UBIN,
              9303    1         2 BIT_MAP                ALIGNED,
              9304    1           3 DATA                  ALIGNED,
              9305    1             4 BITS(0:255)          BIT(1)    UNAL /*('0'B*256)*/,
              9306    1           3 RPROC                 ALIGNED,
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:61   
              9307    1             4 BITS(0:255)          BIT(1)    UNAL /*('0'B*256)*/,
              9308    1           3 ROS                   ALIGNED,
              9309    1             4 BITS(0:255)          BIT(1)    UNAL /*('0'B*256)*/,
              9310    1         2 L_SC_START,
              9311    1           3 SC_BLK_COM$ PTR /*(ADDR(NIL))*/, /* Blank common            */
              9312    1           3 SC_ROOT_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Root labelled common */
              9313    1           3 SC_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Labelled common         */
              9314    1           3 SC_DCB$ PTR /*(ADDR(NIL))*/, /* Dcbs                        */
              9315    1         2 L_SC_START_A$(0:3)  REDEF L_SC_START PTR,
              9316    1         2 L_SC_STOP,
              9317    1           3 SC_BLK_COM$ PTR /*(ADDR(NIL))*/, /* Blank common            */
              9318    1           3 SC_ROOT_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Root labelled common */
              9319    1           3 SC_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Labelled common         */
              9320    1           3 SC_DCB$ PTR /*(ADDR(NIL))*/, /* Dcbs                        */
              9321    1         2 L_SC_STOP_A$(0:3)   REDEF L_SC_STOP  PTR,
              9322    1         2 PROMOTE_HEAD,
              9323    1           3 BLK_COM$              PTR /*(ADDR(NIL))*/,
              9324    1           3 LBL_COM$              PTR /*(ADDR(NIL))*/,
              9325    1         2 PROMOTE_HEAD_A$(0:1) REDEF PROMOTE_HEAD     PTR,
              9326    1         2 PROMOTE_TAIL,
              9327    1           3 BLK_COM$              PTR /*(ADDR(NIL))*/,
              9328    1           3 LBL_COM$              PTR /*(ADDR(NIL))*/,
              9329    1         2 PROMOTE_TAIL_A$(0:1) REDEF PROMOTE_TAIL     PTR,
              9330    1         2 HAVE_ASL          BIT(1)    UNAL /*('0'B)*/,
              9331    1         2 ALL_BLK_COM          BIT(1)    UNAL /*('0'B)*/,
              9332    1         2 *                 BIT(34)   UNAL /*('0'B)*/,
              9333    1         2 BLANK_COMMON$     PTR       ALIGNED /*(ADDR(NIL))*/;

      213     9337        %VYD$TMPLT;

              9349    1   /*******************************************************************************
              9350    1   *                                                                              *
              9351    1   *                          VYD$TMPLT                                               *
              9352    1   *                                                                              *
              9353    1   *******************************************************************************/

              9358    1   DCL 1 VYD$TMPLT          ALIGNED BASED, /* Template for defs                  */
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:62   
              9359    1         2 A(0:3)       UBIN(18)  UNAL,    /* Array ...                          */
              9360    1         2 A_SBIN(0:3) REDEF A    SBIN HALF UNAL,
              9361    1         2 I       REDEF     A,            /* Items                              */
              9362    1           3 WHERE        UBIN( 3) UNAL,   /* Source of def                      */
              9363                                                                /* Value from
              9364                                                                     0   object
              9365                                                                     1   library */
              9366    1           3 DEFINED      BIT( 1) UNAL,    /* Defined or not                     */
              9367    1           3 B                      UNAL,
              9368    1             4 MULTIPLY    BIT(1) UNAL,    /* Multiply defined                   */
              9369    1           3 SC#          UBIN(13) UNAL,   /* Section #                          */
              9370    1           3 AFTER        REDEF SC#      UNAL,
              9371    1             4 USED        BIT(1) UNAL,    /* Used or not                        */
              9372    1             4 *           BIT(12) UNAL,
              9373    1           3 OFFSET      UBIN(18) UNAL,    /* Offset/address                     */
              9374    1           3 NAME_DISP   UBIN(18) UNAL,    /* Displacement to name(in words)     */
              9375    1           3 NAME_DISP_SBIN REDEF NAME_DISP   SBIN HALF UNAL,
              9376    1           3 P           UBIN( 1) UNAL,    /* Primary entdef                     */
              9377    1           3 C REDEF P   BIT(  1) UNAL,    /* Constant bit for symdefs           */
              9378    1           3 A           UBIN( 1) UNAL,    /* Altret specified                   */
              9379    1           3 MULTIPLY REDEF A BIT(1) UNAL, /* Multiply defined for constant sym defs */
              9380    1           3 I           BIT(  1) UNAL,    /* Argument/parameter check           */
              9381    1           3 USED    REDEF I  BIT(1) UNAL, /* Used or not for constant sym defs  */
              9382    1           3 CST         UBIN( 4) UNAL,    /* Calling sequence type              */
              9383    1           3 WHERE_C REDEF CST UBIN(4) UNAL, /* Source of def for constant sym defs */
              9384    1           3 NP          UBIN(11) UNAL,    /* # of parameters                    */
              9385    1           3 IS_DCB  REDEF     NP,
              9386    1             4 DCB_BIT     BIT(1)    UNAL,
              9387    1             4 *           BIT(10)   UNAL,
              9388    1         2 SEG REDEF A,
              9389    1           3 *             UBIN      UNAL,
              9390    1           3 NPOINTER      UBIN(18)  UNAL,
              9391    1           3 CONSTNT       BIT(1)    UNAL,
              9392    1           3 TYPE          UBIN(5)   UNAL,
              9393    1           3 SEGID         UBIN(12)  UNAL,
              9394    1         2 V REDEF A,
              9395    1           3 VALUE       UBIN(36) UNAL,    /* Value if C=1                       */
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:63   
              9396    1           3 *           UBIN(36) UNAL,
              9397    1         2 S  REDEF  A,                    /* Value if C=1                       */
              9398    1           3 *         UBIN(24) UNAL,
              9399    1           3 SEGID     UBIN(12) UNAL,
              9400    1           3 *         UBIN     UNAL;
      214     9403        %VYR$TMPLT;

              9417    1   /*******************************************************************************
              9418    1   *                                                                              *
              9419    1   *                          VYR$TMPLT                                               *
              9420    1   *                                                                              *
              9421    1   *******************************************************************************/

              9425    1   DCL 1 VYR$TMPLT                                         BASED ALIGNED,
              9426    1         2 NAME_DISP              UBIN(18)       UNAL,
              9427    1         2 ER                                    UNAL,
              9428    1           3 SREF                  BIT (1)        UNAL,
              9429    1           3 A                     UBIN(1)        UNAL,
              9430    1           3 I                     BIT(1)         UNAL,
              9431    1           3 CST                   UBIN(4)        UNAL,
              9432    1           3 NP                    UBIN(11)       UNAL,
              9433    1         2 CAND    REDEF     ER,
              9434    1           3 SREF                  BIT (1)        UNAL,
              9435    1           3 READ_ONLY             BIT(1)         UNAL,
              9436    1           3 STATE                 BIT(1)         UNAL,
              9437    1           3 *                     UBIN(15)       UNAL,
              9438    1         2 OU_NAME_DISP REDEF     ER,
              9439    1           3 SREF                  BIT (1)        UNAL,
              9440    1           3 READ_ONLY             BIT(1)         UNAL,
              9441    1           3 GOT                   BIT(1)         UNAL,
              9442    1           3 NAME_DISP             UBIN(15)       UNAL,
              9443    1         2 SAT     REDEF     ER,
              9444    1           3 BREF                  BIT ( 1)       UNAL,
              9445    1           3 *                     BIT (17)       UNAL;

              9454    1   /*******************************************************************************
              9455    1   *                                                                              *
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:64   
              9456    1   *                          VYR$SAT                                                 *
              9457    1   *                                                                              *
              9458    1   *******************************************************************************/

              9462    1   DCL 1 VYR$SAT                 ALIGNED   BASED,
              9463    1         2 VALUE        UBIN(36)  ALIGNED,
              9464    1         2 SEG   REDEF  VALUE,
              9465    1           3 OFFSET     UBIN(18)  UNAL,
              9466    1           3 *          BIT(6)    UNAL,
              9467    1           3 SEGID      UBIN(12)  UNAL,
              9468    1         2 BELOW        BIT(1)    UNAL,
              9469    1         2 *            BIT(17)   UNAL,
              9470    1         2 NODE#        UBIN(18)  UNAL;
      215     9473        %TMPLT;

              9485    1   /*******************************************************************************
              9486    1   *                                                                              *
              9487    1   *                          TMPLT                                                 *
              9488    1   *                                                                              *
              9489    1   *******************************************************************************/

              9494    1   DCL 1 VY$TMPLT           ALIGNED BASED, /* Template for defs                  */
              9495    1         2 A(0:3)       UBIN(18)  UNAL,    /* Array access                       */
              9496    1         2 A_SBIN(0:3) REDEF A    SBIN HALF UNAL,
              9497    1         2 W       REDEF     A,            /* By name                            */
              9498    1           3 WORD0       UBIN(36)  UNAL,   /* First word                         */
              9499    1           3 WORD1       UBIN(36)  UNAL;   /* Second word                        */
      216     9502        %BANNER( ARG=B$DNAME );

              9510    1   /*******************************************************************************
              9511    1   *                                                                              *
              9512    1   *                          B$DNAME                                                 *
              9513    1   *                                                                              *
              9514    1   *******************************************************************************/

      217     9518        %B$DNAME( NAME=B$DNAME, STCLASS=BASED );
      218     9537        %BANNER( ARG=SUBS );
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:65   

              9545    1   /*******************************************************************************
              9546    1   *                                                                              *
              9547    1   *                          SUBS                                                 *
              9548    1   *                                                                              *
              9549    1   *******************************************************************************/

      219     9553        %B$RECORDSUBS;
      220     9581        %C;

              9589    1   /*******************************************************************************
              9590    1   *                                                                              *
              9591    1   *                          CHAR                                                 *
              9592    1   *                                                                              *
              9593    1   *******************************************************************************/

      221     9597    1   DCL HEADING(0:5) CHAR(40) CONSTANT INIT(
      222     9598    1    'B    ======= ENTRY DEFINITIONS =======',
      223     9599    1    'B    ======= ENTRY REFERENCES =======',
      224     9600    1    'B    ======= DATA DEFINITIONS =======',
      225     9601    1    'B    ======= DATA REFERENCES =======',
      226     9602    1    'B    ======= SEGMENT DEFINITIONS =======',
      227     9603    1    'B    ======= SEGMENT REFERENCES =======' );
      228     9604    1   DCL P_NAME CHAR(1024);
      229     9605    1   DCL S_NAME CHAR(1024);
      230     9606        %E;

              9614    1   /*******************************************************************************
              9615    1   *                                                                              *
              9616    1   *                          ENTRY                                                 *
              9617    1   *                                                                              *
              9618    1   *******************************************************************************/

      231     9622    1   DCL VYE$ERRMSG ENTRY(1);
      232     9623    1   DCL VYF$FREE ENTRY(3);
      233     9624    1   DCL VYQ$SORT ENTRY(7);
      234     9625    1   DCL VYI$ERR ENTRY;
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:66   
      235     9626        %B;

              9634    1   /*******************************************************************************
              9635    1   *                                                                              *
              9636    1   *                          BIT                                                 *
              9637    1   *                                                                              *
              9638    1   *******************************************************************************/

      236     9642    1   DCL FIRST_TIME BIT(1);
      237     9643        %PTR;

              9651    1   /*******************************************************************************
              9652    1   *                                                                              *
              9653    1   *                          PTR                                                 *
              9654    1   *                                                                              *
              9655    1   *******************************************************************************/

      238     9659        %POINTER;
      239     9664    1   DCL S$ PTR;
      240     9665    1   DCL NAME$ PTR;
      241     9666    1   DCL DNAME$ PTR;
      242     9667    1   DCL RNAME$ PTR;
      243     9668        %S;

              9676    1   /*******************************************************************************
              9677    1   *                                                                              *
              9678    1   *                          SBIN                                                 *
              9679    1   *                                                                              *
              9680    1   *******************************************************************************/

      244     9684    1   DCL SIZE SBIN;
      245     9685    1   DCL P_NAME_SIZE SBIN;
      246     9686    1   DCL S_NAME_SIZE SBIN;
      247     9687        %U;

              9695    1   /*******************************************************************************
              9696    1   *                                                                              *
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:67   
              9697    1   *                          UBIN                                                 *
              9698    1   *                                                                              *
              9699    1   *******************************************************************************/

      248     9703        %INDEX;
      249     9713    1   DCL N_D UBIN;
      250     9714
      251     9715
      252     9716    1   DCL OU_NAME UBIN;
      253     9717        %PLIST;
      254     9718        %BUMP_CTAB_DCL;
      255     9721
      256     9722        %EJECT;
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:68   
      257     9723    1       DNAME$ = VY_CURR$ -> VY$NODE.L_START.DN$;
      258     9724    1       RNAME$ = VY_CURR$ -> VY$NODE.L_START.RN$;
      259     9725    1       FIRST_TIME = '1'B/*@TRUE_B*/;
      260     9726    2       DO I = 4 TO 9;
      261     9727    3           IF VY_O.MAP_A(I) = 1/*@YES*/ THEN DO;
      262     9728    3               P$ = VY_CURR$ -> VY$NODE.L_START_A$(I);
      263     9729    4               IF P$ ~= ADDR(NIL) THEN DO;
      264     9730    5                   IF FIRST_TIME THEN DO;
      265     9731    5                       VY_MBUF.CHARS = 'A';
      266     9732                            %M_WRITE( CLEAR=" " );
      267     9741    5                       FIRST_TIME = '0'B/*@FALSE_B*/;
      268     9742    5                       END;
      269     9743                        %WR_LIT( MES1="HEADING(I-%TYPEDEF)" );
      270     9753    4                   Q$ = VY_CURR$ -> VY$NODE.L_STOP_A$(I);
      271     9754    5                   IF MOD( I, 2 ) = 0 THEN DO;
      272     9755    5                       NAME$ = DNAME$;
      273     9756    5                       N_D = 2;
      274     9757    5                       OU_NAME = 3;
      275     9758    5                       SIZE = SIZEW( VYD$TMPLT );
      276     9759    5                       END;
      277     9760    5                   ELSE DO;
      278     9761    5                       N_D = 0;
      279     9762    5                       OU_NAME = 1;
      280     9763    5                       NAME$ = RNAME$;
      281     9764    5                       SIZE = SIZEW( VYR$TMPLT );
      282     9765    5                       END;
      283     9766    4                   CALL VYQ$SORT( NAME$, P$, Q$, SIZE, 1/*@BY_NAME*/, N_D, OU_NAME );
      284     9767    5                   DO WHILE( P$ <= Q$ );
      285     9768    5                       CALL GET_NAME( P_NAME, P_NAME_SIZE, P$ );
      286     9769    5                       S$ = PINCRW( P$ ,SIZE );
      287     9770    6                       IF S$ <= Q$ THEN DO;
      288     9771    6                           CALL GET_NAME( S_NAME, S_NAME_SIZE, S$ );
      289     9772    7                           DO WHILE( S_NAME = P_NAME );
      290     9773    7                               S$ = PINCRW( S$, SIZE );
      291     9774    7                               IF S$ > Q$ THEN GOTO JUMP_OUT;
      292     9775    7                               CALL GET_NAME( S_NAME, S_NAME_SIZE, S$ );
      293     9776    7                               END;
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:69   
      294     9777    6                           END;
      295     9778    5   JUMP_OUT:
      296     9779    5                       IF VY_MAP_TABS_A(VY_CTAB) + P_NAME_SIZE > VY_MAP_WIDTH
      297     9780    5                          OR VY_CTAB > VY_MAX_CTAB
      298     9781    6                       THEN DO;
      299     9782                                %M_WRITE;
      300     9791    6                           END;
      301     9792    5                       CALL INSERT( VY_MBUF.CHARS, VY_MAP_TABS_A(VY_CTAB), ,
      302     9793    5                          SUBSTR( P_NAME, 0, P_NAME_SIZE ) );
      303     9794                            %BUMP_CTAB( INC=P_NAME_SIZE, SPACE=5 );
      304     9800    5                       P$ = S$;
      305     9801    5                       P_NAME = S_NAME;
      306     9802    5                       P_NAME_SIZE = S_NAME_SIZE;
      307     9803    5                       END; /* Do while( P$ <= Q$ ); */
      308     9804    5                   IF VY_CTAB ~= 0 THEN DO;
      309     9805                            %M_WRITE;
      310     9814    5                       END;
      311     9815                        %M_WRITE( CLEAR=" ", ZERO=" " );
      312     9824    4                   END; /* If P$ ~= addr(nil) then do; */
      313     9825    3               END; /* If VY_O.MAP_A(I) then do; */
      314     9826    2           END; /* Do i = typedef to typesegref */
      315     9827
      316     9828    2       DO I = 1 TO 9;
      317     9829    2           SIZE = VY_CURR$ -> VY$NODE.L_SIZE_A(I);
      318     9830    2           IF SIZE > 0 THEN CALL VYF$FREE( VY_PASS1_ALL_TYPE(I), SIZE, 1 );
      319     9831    2           END;
      320     9832    2       DO WHILE( '0'B );
      321     9833    2   MAP_IO_ERROR:
      322     9834    2           CALL VYE$ERRMSG;
      323     9835    2           CALL VYI$ERR;
      324     9836    2           END;
      325     9837
      326     9838        %EJECT;
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:70   
      327     9839    1   GET_NAME: PROC( NAME, NAME_SIZE, ITEM$ );
      328     9840
      329     9841    2   DCL NAME CHAR(1024);
      330     9842    2   DCL NAME_SIZE SBIN;
      331     9843    2   DCL ITEM$ PTR;
      332     9844
      333     9845    2   DCL NAME1$ PTR;
      334     9846    2   DCL NAME2$ PTR;
      335     9847
      336     9848
      337     9849    2       NAME1$ = PINCRW( NAME$, ITEM$ -> VY$TMPLT.A(N_D) );
      338     9850    2       NAME2$ = PINCRW( DNAME$, ITEM$ -> VY$TMPLT.A(OU_NAME) );
      339     9851    2       CALL CONCAT( NAME, NAME1$->B$DNAME.TEXT, ' (', NAME2$->B$DNAME.TEXT, ')' );
      340     9852    2       NAME_SIZE = NAME1$->B$DNAME.COUNT + NAME2$->B$DNAME.COUNT + 3;
      341     9853
      342     9854
      343     9855
      344     9856    2   END GET_NAME;
      345     9857
      346     9858
      347     9859    1   END VYM$MAP;

PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:71   
--  Include file information  --

   B$OBJECT_C.:E05TOU  is referenced.
   VY_DCB_R.:E05TOU  cannot be made into a system file and is referenced.
   VY_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VY_FIXED_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VY_MACRO_C.:E05TOU  is referenced.
   VY_PERR_C.:E05TOU  is referenced.
   VY_SUBS_C.:E05TOU  is referenced.
   VY_INC_NO_C.:E05TOU  is referenced.
   VY_SWITCH_C.:E05TOU  is referenced.
   VY_INC_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VYM$MAP.

   Procedure VYM$MAP requires 313 words for executable code.
   Procedure VYM$MAP requires 540 words of local(AUTO) storage.

    No errors detected in file VYM$MAIN.:E05TSI    .

PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:72   

 Object Unit name= VYM$MAP                                    File name= VYM$MAIN.:E05TOU
 UTS= JUL 30 '97 08:57:54.16 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     62     76  VYM$MAP
    2   Data  even  none     8     10  VYM$MAP
    3   Proc  even  none   313    471  VYM$MAP
    4  RoData even  none     7      7  VYM$MAP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        0  VYM$MAP

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       7 VYQ$SORT
         yes           Std       3 VYF$FREE
         yes           Std       1 VYE$ERRMSG
         yes           Std       0 VYI$ERR
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:73   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  VY_MAP_LO_FPT_WRITE                   VY_MAP_LIT_LO_FPT_WRITE
     VY_CURR$                              VY_ERRORS                             VY_O
r    VY_PASS1_ALL_TYPE                     VY_PAR_UNWIND                         VY_CTAB
r    VY_MAP_TABS_A                         VY_MAP_WIDTH                          VY_MAX_CTAB
     VY_MBUF                               B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:74   


      200        1        /*M*  VYM$MAP - produces the map for the map options specified on a COPY or
      201        2                        LIST command.    */
      202        3        /*T***********************************************************/
      203        4        /*T*                                                         */
      204        5        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      205        6        /*T*                                                         */
      206        7        /*T***********************************************************/
      207        8
      208        9
      209       10        VYM$MAP: PROC;

     10  3 000000   000000 700200 xent  VYM$MAP      TSX0  ! X66_AUTO_0
         3 000001   001034 000000                    ZERO    540,0

      210       11
      211       12        %INCLUDE VY_INC_C;
      212     9188        %VY$NODE;

              9200    1   /*******************************************************************************
              9201    1   *                                                                              *
              9202    1   *                          VY$NODE                                                *
              9203    1   *                                                                              *
              9204    1   *******************************************************************************/

              9220    1   DCL 1 VY$NODE      ALIGNED    BASED,
              9221    1         2 SON$ PTR /*(ADDR(NIL))*/, /* Son pointer                      */
              9222    1         2 BROTHER$ PTR /*(ADDR(NIL))*/, /* Brother pointer              */
              9223    1         2 FATHER$ PTR /*(ADDR(NIL))*/, /* Father pointer                */
              9224    1         2 PATH$ PTR /*(ADDR(NIL))*/, /* Path   pointer                  */
              9225    1         2 HEAD$       PTR /*(ADDR(NIL))*/, /* Head pointer to
              9226                              to list of file nodes for this node            */
              9227    1         2 TAIL$ PTR /*(ADDR(NIL))*/, /* Tail pointer to list            */
              9228    1         2 SHARED_LIB_HEAD$ PTR /*(ADDR(NIL))*/,
              9228                  /* Head pointer to shared library list */
              9229    1         2 LIB_HEAD$         PTR /*(ADDR(NIL))*/,
              9229                  /* Head pointer to list of shared libraries
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:75   
              9230                                          which have been mapped to included libraries */
              9231    1         2 NUM          UBIN(36)  UNAL,    /* Node number                        */
              9232    1         2 DEPTH          UBIN(36)  UNAL,  /* Depth; ROOT=0*/
              9233    1         2 ADDR_START_A(0:2/*@ROS*/) SBIN WORD /*(0*3)*/, /* Array            */
              9234    1         2 ADDR_START REDEF  ADDR_START_A,
              9235    1           3 RDATA       SBIN WORD,   /* First address for this node in data     */
              9236    1           3 RPROC       SBIN WORD,   /* First address for this node in proc     */
              9237    1           3 ROS       SBIN WORD,          /* Last address for program in ros    */
              9238    1         2 ADDR_STOP_A(0:2/*@ROS*/) SBIN WORD /*(-1*3)*/, /* Array            */
              9239    1         2 ADDR_STOP  REDEF  ADDR_STOP_A,
              9240    1           3 RDATA       SBIN WORD,        /* Last address for this node in data */
              9241    1           3 RPROC       SBIN WORD,        /* Last address for this node in proc */
              9242    1           3 ROS       SBIN WORD,          /* Last address for program in ros    */
              9243    1         2 START_PAGE#_A(0:2/*@ROS*/) SBIN WORD /*(0*3)*/, /* Array           */
              9244    1         2 START_PAGE# REDEF START_PAGE#_A,
              9245    1           3 RDATA       SBIN WORD,   /* First page    for this node in data     */
              9246    1           3 RPROC       SBIN WORD,   /* First page    for this node in proc     */
              9247    1           3 ROS       SBIN WORD,          /* First page   for program in ros    */
              9248    1         2 STOP_PAGE#_A(0:2/*@ROS*/) SBIN WORD /*(-1*3)*/, /* Array*/
              9249    1         2 STOP_PAGE#  REDEF STOP_PAGE#_A,
              9250    1           3 RDATA       SBIN WORD,   /* Last  page    for this node in data     */
              9251    1           3 RPROC       SBIN WORD,   /* Last  page    for this node in proc     */
              9252    1           3 ROS       SBIN WORD,          /* Last  page   for program in ros    */
              9253    1         2 START_SC_ALL$ PTR /*(ADDR(NIL))*/,
              9253                  /* Starting pointer for common sections for this node */
              9254    1         2 STOP_SC_ALL$ PTR /*(ADDR(NIL))*/,
              9254                  /* Stopping pointer for common sections for this node */
              9255    1         2 L_START,
              9256    1           3 SN$ PTR /*(ADDR(NIL))*/, /* Segment definition names        */
              9257    1           3 DN$ PTR /*(ADDR(NIL))*/, /* Def names                       */
              9258    1           3 RN$ PTR /*(ADDR(NIL))*/, /* Ref names                       */
              9259    1           3 SC$ PTR /*(ADDR(NIL))*/, /* Sections                        */
              9260    1           3 ED$ PTR /*(ADDR(NIL))*/, /* Entry defs*/
              9261    1           3 ER$ PTR /*(ADDR(NIL))*/, /* Entry refs*/
              9262    1           3 DD$ PTR /*(ADDR(NIL))*/, /* Data defs                       */
              9263    1           3 DR$ PTR /*(ADDR(NIL))*/, /* Data refs                       */
              9264    1           3 SD$ PTR /*(ADDR(NIL))*/, /* Seg defs                        */
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:76   
              9265    1           3 SR$ PTR /*(ADDR(NIL))*/, /* Seg refs                        */
              9266    1         2 L_START_A$(0:9)     REDEF L_START PTR,
              9267    1         2 L_STOP,
              9268    1           3 SN$ PTR /*(ADDR(NIL))*/, /* Segment definition names        */
              9269    1           3 DN$ PTR /*(ADDR(NIL))*/, /* Def names                       */
              9270    1           3 RN$ PTR /*(ADDR(NIL))*/, /* Ref names                       */
              9271    1           3 SC$ PTR /*(ADDR(NIL))*/, /* Sections                        */
              9272    1           3 ED$ PTR /*(ADDR(NIL))*/, /* Entry defs*/
              9273    1           3 ER$ PTR /*(ADDR(NIL))*/, /* Entry refs*/
              9274    1           3 DD$ PTR /*(ADDR(NIL))*/, /* Data defs                       */
              9275    1           3 DR$ PTR /*(ADDR(NIL))*/, /* Data refs                       */
              9276    1           3 SD$ PTR /*(ADDR(NIL))*/, /* Seg defs                        */
              9277    1           3 SR$ PTR /*(ADDR(NIL))*/, /* Seg refs                        */
              9278    1         2 L_STOP_A$(0:9) REDEF   L_STOP    PTR,
              9279    1         2 L_SIZE,
              9280    1           3 SN      UBIN /*(0)*/, /* Segment definition names           */
              9281    1           3 DN      UBIN /*(0)*/, /* Def names                          */
              9282    1           3 RN      UBIN /*(0)*/, /* Ref names                          */
              9283    1           3 SC      UBIN /*(0)*/, /* Sections                           */
              9284    1           3 ED      UBIN /*(0)*/, /* Entry defs*/
              9285    1           3 ER      UBIN /*(0)*/, /* Entry refs*/
              9286    1           3 DD      UBIN /*(0)*/, /* Data defs                          */
              9287    1           3 DR      UBIN /*(0)*/, /* Data refs                          */
              9288    1           3 SD      UBIN /*(0)*/, /* Seg defs                           */
              9289    1           3 SR      UBIN /*(0)*/, /* Seg refs                           */
              9290    1         2 L_SIZE_A(0:9)  REDEF   L_SIZE    UBIN,
              9291    1         2 L_PREV_SIZE,
              9292    1           3 SN      UBIN /*(0)*/, /* Segment definition names           */
              9293    1           3 DN      UBIN /*(0)*/, /* Def names                          */
              9294    1           3 RN      UBIN /*(0)*/, /* Ref names                          */
              9295    1           3 SC      UBIN /*(0)*/, /* Sections                           */
              9296    1           3 ED      UBIN /*(0)*/, /* Entry defs*/
              9297    1           3 ER      UBIN /*(0)*/, /* Entry refs*/
              9298    1           3 DD      UBIN /*(0)*/, /* Data defs                          */
              9299    1           3 DR      UBIN /*(0)*/, /* Data refs                          */
              9300    1           3 SD      UBIN /*(0)*/, /* Seg defs                           */
              9301    1           3 SR      UBIN /*(0)*/, /* Seg refs                           */
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:77   
              9302    1         2 L_PREV_SIZE_A(0:9)  REDEF   L_PREV_SIZE    UBIN,
              9303    1         2 BIT_MAP                ALIGNED,
              9304    1           3 DATA                  ALIGNED,
              9305    1             4 BITS(0:255)          BIT(1)    UNAL /*('0'B*256)*/,
              9306    1           3 RPROC                 ALIGNED,
              9307    1             4 BITS(0:255)          BIT(1)    UNAL /*('0'B*256)*/,
              9308    1           3 ROS                   ALIGNED,
              9309    1             4 BITS(0:255)          BIT(1)    UNAL /*('0'B*256)*/,
              9310    1         2 L_SC_START,
              9311    1           3 SC_BLK_COM$ PTR /*(ADDR(NIL))*/, /* Blank common            */
              9312    1           3 SC_ROOT_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Root labelled common */
              9313    1           3 SC_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Labelled common         */
              9314    1           3 SC_DCB$ PTR /*(ADDR(NIL))*/, /* Dcbs                        */
              9315    1         2 L_SC_START_A$(0:3)  REDEF L_SC_START PTR,
              9316    1         2 L_SC_STOP,
              9317    1           3 SC_BLK_COM$ PTR /*(ADDR(NIL))*/, /* Blank common            */
              9318    1           3 SC_ROOT_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Root labelled common */
              9319    1           3 SC_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Labelled common         */
              9320    1           3 SC_DCB$ PTR /*(ADDR(NIL))*/, /* Dcbs                        */
              9321    1         2 L_SC_STOP_A$(0:3)   REDEF L_SC_STOP  PTR,
              9322    1         2 PROMOTE_HEAD,
              9323    1           3 BLK_COM$              PTR /*(ADDR(NIL))*/,
              9324    1           3 LBL_COM$              PTR /*(ADDR(NIL))*/,
              9325    1         2 PROMOTE_HEAD_A$(0:1) REDEF PROMOTE_HEAD     PTR,
              9326    1         2 PROMOTE_TAIL,
              9327    1           3 BLK_COM$              PTR /*(ADDR(NIL))*/,
              9328    1           3 LBL_COM$              PTR /*(ADDR(NIL))*/,
              9329    1         2 PROMOTE_TAIL_A$(0:1) REDEF PROMOTE_TAIL     PTR,
              9330    1         2 HAVE_ASL          BIT(1)    UNAL /*('0'B)*/,
              9331    1         2 ALL_BLK_COM          BIT(1)    UNAL /*('0'B)*/,
              9332    1         2 *                 BIT(34)   UNAL /*('0'B)*/,
              9333    1         2 BLANK_COMMON$     PTR       ALIGNED /*(ADDR(NIL))*/;

      213     9337        %VYD$TMPLT;

              9349    1   /*******************************************************************************
              9350    1   *                                                                              *
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:78   
              9351    1   *                          VYD$TMPLT                                              *
              9352    1   *                                                                              *
              9353    1   *******************************************************************************/

              9358    1   DCL 1 VYD$TMPLT          ALIGNED BASED, /* Template for defs                  */
              9359    1         2 A(0:3)       UBIN(18)  UNAL,    /* Array ...                          */
              9360    1         2 A_SBIN(0:3) REDEF A    SBIN HALF UNAL,
              9361    1         2 I       REDEF     A,            /* Items                              */
              9362    1           3 WHERE        UBIN( 3) UNAL,   /* Source of def                      */
              9363                                                                /* Value from
              9364                                                                     0   object
              9365                                                                     1   library */
              9366    1           3 DEFINED      BIT( 1) UNAL,    /* Defined or not                     */
              9367    1           3 B                      UNAL,
              9368    1             4 MULTIPLY    BIT(1) UNAL,    /* Multiply defined                   */
              9369    1           3 SC#          UBIN(13) UNAL,   /* Section #                          */
              9370    1           3 AFTER        REDEF SC#      UNAL,
              9371    1             4 USED        BIT(1) UNAL,    /* Used or not                        */
              9372    1             4 *           BIT(12) UNAL,
              9373    1           3 OFFSET      UBIN(18) UNAL,    /* Offset/address                     */
              9374    1           3 NAME_DISP   UBIN(18) UNAL,    /* Displacement to name(in words)     */
              9375    1           3 NAME_DISP_SBIN REDEF NAME_DISP   SBIN HALF UNAL,
              9376    1           3 P           UBIN( 1) UNAL,    /* Primary entdef                     */
              9377    1           3 C REDEF P   BIT(  1) UNAL,    /* Constant bit for symdefs           */
              9378    1           3 A           UBIN( 1) UNAL,    /* Altret specified                   */
              9379    1          3 MULTIPLY REDEF A BIT(1) UNAL, /* Multiply defined for constant sym defs */
              9380    1           3 I           BIT(  1) UNAL,    /* Argument/parameter check           */
              9381    1           3 USED    REDEF I  BIT(1) UNAL, /* Used or not for constant sym defs  */
              9382    1           3 CST         UBIN( 4) UNAL,    /* Calling sequence type              */
              9383    1           3 WHERE_C REDEF CST UBIN(4) UNAL, /* Source of def for constant sym defs */
              9384    1           3 NP          UBIN(11) UNAL,    /* # of parameters                    */
              9385    1           3 IS_DCB  REDEF     NP,
              9386    1             4 DCB_BIT     BIT(1)    UNAL,
              9387    1             4 *           BIT(10)   UNAL,
              9388    1         2 SEG REDEF A,
              9389    1           3 *             UBIN      UNAL,
              9390    1           3 NPOINTER      UBIN(18)  UNAL,
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:79   
              9391    1           3 CONSTNT       BIT(1)    UNAL,
              9392    1           3 TYPE          UBIN(5)   UNAL,
              9393    1           3 SEGID         UBIN(12)  UNAL,
              9394    1         2 V REDEF A,
              9395    1           3 VALUE       UBIN(36) UNAL,    /* Value if C=1                       */
              9396    1           3 *           UBIN(36) UNAL,
              9397    1         2 S  REDEF  A,                    /* Value if C=1                       */
              9398    1           3 *         UBIN(24) UNAL,
              9399    1           3 SEGID     UBIN(12) UNAL,
              9400    1           3 *         UBIN     UNAL;
      214     9403        %VYR$TMPLT;

              9417    1   /*******************************************************************************
              9418    1   *                                                                              *
              9419    1   *                          VYR$TMPLT                                              *
              9420    1   *                                                                              *
              9421    1   *******************************************************************************/

              9425    1   DCL 1 VYR$TMPLT                                         BASED ALIGNED,
              9426    1         2 NAME_DISP              UBIN(18)       UNAL,
              9427    1         2 ER                                    UNAL,
              9428    1           3 SREF                  BIT (1)        UNAL,
              9429    1           3 A                     UBIN(1)        UNAL,
              9430    1           3 I                     BIT(1)         UNAL,
              9431    1           3 CST                   UBIN(4)        UNAL,
              9432    1           3 NP                    UBIN(11)       UNAL,
              9433    1         2 CAND    REDEF     ER,
              9434    1           3 SREF                  BIT (1)        UNAL,
              9435    1           3 READ_ONLY             BIT(1)         UNAL,
              9436    1           3 STATE                 BIT(1)         UNAL,
              9437    1           3 *                     UBIN(15)       UNAL,
              9438    1         2 OU_NAME_DISP REDEF     ER,
              9439    1           3 SREF                  BIT (1)        UNAL,
              9440    1           3 READ_ONLY             BIT(1)         UNAL,
              9441    1           3 GOT                   BIT(1)         UNAL,
              9442    1           3 NAME_DISP             UBIN(15)       UNAL,
              9443    1         2 SAT     REDEF     ER,
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:80   
              9444    1           3 BREF                  BIT ( 1)       UNAL,
              9445    1           3 *                     BIT (17)       UNAL;

              9454    1   /*******************************************************************************
              9455    1   *                                                                              *
              9456    1   *                          VYR$SAT                                                *
              9457    1   *                                                                              *
              9458    1   *******************************************************************************/

              9462    1   DCL 1 VYR$SAT                 ALIGNED   BASED,
              9463    1         2 VALUE        UBIN(36)  ALIGNED,
              9464    1         2 SEG   REDEF  VALUE,
              9465    1           3 OFFSET     UBIN(18)  UNAL,
              9466    1           3 *          BIT(6)    UNAL,
              9467    1           3 SEGID      UBIN(12)  UNAL,
              9468    1         2 BELOW        BIT(1)    UNAL,
              9469    1         2 *            BIT(17)   UNAL,
              9470    1         2 NODE#        UBIN(18)  UNAL;
      215     9473        %TMPLT;

              9485    1   /*******************************************************************************
              9486    1   *                                                                              *
              9487    1   *                          TMPLT                                                 *
              9488    1   *                                                                              *
              9489    1   *******************************************************************************/

              9494    1   DCL 1 VY$TMPLT           ALIGNED BASED, /* Template for defs                  */
              9495    1         2 A(0:3)       UBIN(18)  UNAL,    /* Array access                       */
              9496    1         2 A_SBIN(0:3) REDEF A    SBIN HALF UNAL,
              9497    1         2 W       REDEF     A,            /* By name                            */
              9498    1           3 WORD0       UBIN(36)  UNAL,   /* First word                         */
              9499    1           3 WORD1       UBIN(36)  UNAL;   /* Second word                        */
      216     9502        %BANNER( ARG=B$DNAME );

              9510    1   /*******************************************************************************
              9511    1   *                                                                              *
              9512    1   *                          B$DNAME                                                *
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:81   
              9513    1   *                                                                              *
              9514    1   *******************************************************************************/

      217     9518        %B$DNAME( NAME=B$DNAME, STCLASS=BASED );
      218     9537        %BANNER( ARG=SUBS );

              9545    1   /*******************************************************************************
              9546    1   *                                                                              *
              9547    1   *                          SUBS                                                 *
              9548    1   *                                                                              *
              9549    1   *******************************************************************************/

      219     9553        %B$RECORDSUBS;
      220     9581        %C;

              9589    1   /*******************************************************************************
              9590    1   *                                                                              *
              9591    1   *                          CHAR                                                 *
              9592    1   *                                                                              *
              9593    1   *******************************************************************************/

      221     9597    1   DCL HEADING(0:5) CHAR(40) CONSTANT INIT(
      222     9598    1    'B    ======= ENTRY DEFINITIONS =======',
      223     9599    1    'B    ======= ENTRY REFERENCES =======',
      224     9600    1    'B    ======= DATA DEFINITIONS =======',
      225     9601    1    'B    ======= DATA REFERENCES =======',
      226     9602    1    'B    ======= SEGMENT DEFINITIONS =======',
      227     9603    1    'B    ======= SEGMENT REFERENCES =======' );
      228     9604    1   DCL P_NAME CHAR(1024);
      229     9605    1   DCL S_NAME CHAR(1024);
      230     9606        %E;

              9614    1   /*******************************************************************************
              9615    1   *                                                                              *
              9616    1   *                          ENTRY                                                 *
              9617    1   *                                                                              *
              9618    1   *******************************************************************************/
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:82   

      231     9622    1   DCL VYE$ERRMSG ENTRY(1);
      232     9623    1   DCL VYF$FREE ENTRY(3);
      233     9624    1   DCL VYQ$SORT ENTRY(7);
      234     9625    1   DCL VYI$ERR ENTRY;
      235     9626        %B;

              9634    1   /*******************************************************************************
              9635    1   *                                                                              *
              9636    1   *                          BIT                                                 *
              9637    1   *                                                                              *
              9638    1   *******************************************************************************/

      236     9642    1   DCL FIRST_TIME BIT(1);
      237     9643        %PTR;

              9651    1   /*******************************************************************************
              9652    1   *                                                                              *
              9653    1   *                          PTR                                                 *
              9654    1   *                                                                              *
              9655    1   *******************************************************************************/

      238     9659        %POINTER;
      239     9664    1   DCL S$ PTR;
      240     9665    1   DCL NAME$ PTR;
      241     9666    1   DCL DNAME$ PTR;
      242     9667    1   DCL RNAME$ PTR;
      243     9668        %S;

              9676    1   /*******************************************************************************
              9677    1   *                                                                              *
              9678    1   *                          SBIN                                                 *
              9679    1   *                                                                              *
              9680    1   *******************************************************************************/

      244     9684    1   DCL SIZE SBIN;
      245     9685    1   DCL P_NAME_SIZE SBIN;
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:83   
      246     9686    1   DCL S_NAME_SIZE SBIN;
      247     9687        %U;

              9695    1   /*******************************************************************************
              9696    1   *                                                                              *
              9697    1   *                          UBIN                                                 *
              9698    1   *                                                                              *
              9699    1   *******************************************************************************/

      248     9703        %INDEX;
      249     9713    1   DCL N_D UBIN;
      250     9714
      251     9715
      252     9716    1   DCL OU_NAME UBIN;
      253     9717        %PLIST;
      254     9718        %BUMP_CTAB_DCL;
      255     9721
      256     9722        %EJECT;
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:84   
      257     9723    1       DNAME$ = VY_CURR$ -> VY$NODE.L_START.DN$;

   9723  3 000002   000000 470400 xsym               LDP0    VY_CURR$
         3 000003   000031 236100                    LDQ     25,,PR0
         3 000004   201006 756100                    STQ     DNAME$,,AUTO

      258     9724    1       RNAME$ = VY_CURR$ -> VY$NODE.L_START.RN$;

   9724  3 000005   000032 236100                    LDQ     26,,PR0
         3 000006   201007 756100                    STQ     RNAME$,,AUTO

      259     9725    1       FIRST_TIME = '1'B/*@TRUE_B*/;

   9725  3 000007   400000 236003                    LDQ     -131072,DU
         3 000010   201003 756100                    STQ     FIRST_TIME,,AUTO

      260     9726    2       DO I = 4 TO 9;

   9726  3 000011   000004 235007                    LDA     4,DL
         3 000012   000003 755000 2                  STA     I

      261     9727    3           IF VY_O.MAP_A(I) = 1/*@YES*/ THEN DO;

   9727  3 000013   000003 720000 2                  LXL0    I
         3 000014   000004 235010 xsym               LDA     VY_O+4,X0
         3 000015   000001 115007                    CMPA    1,DL
         3 000016   000304 601000 3                  TNZ     s:9826

      262     9728    3               P$ = VY_CURR$ -> VY$NODE.L_START_A$(I);

   9728  3 000017   000000 470400 xsym               LDP0    VY_CURR$
         3 000020   000030 236110                    LDQ     24,X0,PR0
         3 000021   000000 756000 2                  STQ     P$

      263     9729    4               IF P$ ~= ADDR(NIL) THEN DO;

   9729  3 000022   000001 116000 xsym               CMPQ    B_VECTNIL+1
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:85   
         3 000023   000304 600000 3                  TZE     s:9826

      264     9730    5                   IF FIRST_TIME THEN DO;

   9730  3 000024   201003 234100                    SZN     FIRST_TIME,,AUTO
         3 000025   000037 605000 3                  TPL     s:9744

      265     9731    5                       VY_MBUF.CHARS = 'A';

   9731  3 000026   040000 100400                    MLR     fill='040'O
         3 000027   000000 000001 4                  ADSC9   0                        cn=0,n=1
         3 000030   000000 000204 xsym               ADSC9   VY_MBUF                  cn=0,n=132

      266     9732                            %M_WRITE( CLEAR=" " );

   9734  3 000031   000000 630400 xsym               EPPR0   VY_MAP_LO_FPT_WRITE
         3 000032   440001 713400                    CLIMB   alt,write
         3 000033   401400 401760                    pmme    nvectors=4
         3 000034   000340 702000 3                  TSX2    MAP_IO_ERROR

   9739  3 000035   000000 450000 xsym               STZ     VY_CTAB

      267     9741    5                       FIRST_TIME = '0'B/*@FALSE_B*/;

   9741  3 000036   201003 450100                    STZ     FIRST_TIME,,AUTO

      268     9742    5                       END;

      269     9743                        %WR_LIT( MES1="HEADING(I-%TYPEDEF)" );

   9744  3 000037   000001 235000 4                  LDA     1
         3 000040   000003 236000 2                  LDQ     I
         3 000041   201024 755100                    STA     NAME2$+1,,AUTO
         3 000042   000012 402003                    MPY     10,DU
         3 000043   000002 036000 4                  ADLQ    2
         3 000044   201024 235100                    LDA     NAME2$+1,,AUTO
         3 000045   000004 757000 xsym               STAQ    VY_MAP_LIT_LO_FPT_WRITE+4
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:86   

   9745  3 000046   000000 630400 xsym               EPPR0   VY_MAP_LIT_LO_FPT_WRITE
         3 000047   440001 713400                    CLIMB   alt,write
         3 000050   401400 401760                    pmme    nvectors=4
         3 000051   000340 702000 3                  TSX2    MAP_IO_ERROR

      270     9753    4                   Q$ = VY_CURR$ -> VY$NODE.L_STOP_A$(I);

   9753  3 000052   000000 470400 xsym               LDP0    VY_CURR$
         3 000053   000003 720000 2                  LXL0    I
         3 000054   000042 236110                    LDQ     34,X0,PR0
         3 000055   000001 756000 2                  STQ     Q$

      271     9754    5                   IF MOD( I, 2 ) = 0 THEN DO;

   9754  3 000056   000003 236000 2                  LDQ     I
         3 000057   000001 376007                    ANQ     1,DL
         3 000060   000072 601000 3                  TNZ     s:9761

      272     9755    5                       NAME$ = DNAME$;

   9755  3 000061   201006 236100                    LDQ     DNAME$,,AUTO
         3 000062   201005 756100                    STQ     NAME$,,AUTO

      273     9756    5                       N_D = 2;

   9756  3 000063   000002 235007                    LDA     2,DL
         3 000064   201013 755100                    STA     N_D,,AUTO

      274     9757    5                       OU_NAME = 3;

   9757  3 000065   000003 235007                    LDA     3,DL
         3 000066   201014 755100                    STA     OU_NAME,,AUTO

      275     9758    5                       SIZE = SIZEW( VYD$TMPLT );

   9758  3 000067   000002 235007                    LDA     2,DL
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:87   
         3 000070   201010 755100                    STA     SIZE,,AUTO

      276     9759    5                       END;

   9759  3 000071   000100 710000 3                  TRA     s:9766

      277     9760    5                   ELSE DO;

      278     9761    5                       N_D = 0;

   9761  3 000072   201013 450100                    STZ     N_D,,AUTO

      279     9762    5                       OU_NAME = 1;

   9762  3 000073   000001 235007                    LDA     1,DL
         3 000074   201014 755100                    STA     OU_NAME,,AUTO

      280     9763    5                       NAME$ = RNAME$;

   9763  3 000075   201007 236100                    LDQ     RNAME$,,AUTO
         3 000076   201005 756100                    STQ     NAME$,,AUTO

      281     9764    5                       SIZE = SIZEW( VYR$TMPLT );

   9764  3 000077   201010 755100                    STA     SIZE,,AUTO

      282     9765    5                       END;

      283     9766    4                   CALL VYQ$SORT( NAME$, P$, Q$, SIZE, 1/*@BY_NAME*/, N_D, OU_NAME );

   9766  3 000100   201014 631500                    EPPR1   OU_NAME,,AUTO
         3 000101   201032 451500                    STP1    NAME2$+7,,AUTO
         3 000102   201013 633500                    EPPR3   N_D,,AUTO
         3 000103   201031 453500                    STP3    NAME2$+6,,AUTO
         3 000104   000003 236000 4                  LDQ     3
         3 000105   201030 756100                    STQ     NAME2$+5,,AUTO
         3 000106   201010 634500                    EPPR4   SIZE,,AUTO
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:88   
         3 000107   201027 454500                    STP4    NAME2$+4,,AUTO
         3 000110   000004 236000 4                  LDQ     4
         3 000111   201026 756100                    STQ     NAME2$+3,,AUTO
         3 000112   000005 236000 4                  LDQ     5
         3 000113   201025 756100                    STQ     NAME2$+2,,AUTO
         3 000114   201005 635500                    EPPR5   NAME$,,AUTO
         3 000115   201024 455500                    STP5    NAME2$+1,,AUTO
         3 000116   201024 630500                    EPPR0   NAME2$+1,,AUTO
         3 000117   000025 631400 xsym               EPPR1   B_VECTNIL+21
         3 000120   000000 701000 xent               TSX1    VYQ$SORT
         3 000121   000000 011000                    NOP     0

      284     9767    5                   DO WHILE( P$ <= Q$ );

   9767  3 000122   000001 236000 2                  LDQ     Q$
         3 000123   000000 116000 2                  CMPQ    P$
         3 000124   000266 602000 3                  TNC     s:9804

      285     9768    5                       CALL GET_NAME( P_NAME, P_NAME_SIZE, P$ );

   9768  3 000125   000005 236000 4                  LDQ     5
         3 000126   201021 756100                    STQ     @NAME_SIZE+1,,AUTO
         3 000127   201011 630500                    EPPR0   P_NAME_SIZE,,AUTO
         3 000130   201020 450500                    STP0    @NAME+1,,AUTO
         3 000131   200003 631500                    EPPR1   P_NAME,,AUTO
         3 000132   201017 451500                    STP1    OU_NAME+3,,AUTO
         3 000133   000347 701000 3                  TSX1    GET_NAME
         3 000134   000000 011000                    NOP     0

      286     9769    5                       S$ = PINCRW( P$ ,SIZE );

   9769  3 000135   201010 236100                    LDQ     SIZE,,AUTO
         3 000136   000022 736000                    QLS     18
         3 000137   000000 036000 2                  ADLQ    P$
         3 000140   201004 756100                    STQ     S$,,AUTO

      287     9770    6                       IF S$ <= Q$ THEN DO;
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:89   

   9770  3 000141   000001 116000 2                  CMPQ    Q$
         3 000142   000144 600000 3                  TZE     s:9771
         3 000143   000203 603000 3                  TRC     JUMP_OUT

      288     9771    6                           CALL GET_NAME( S_NAME, S_NAME_SIZE, S$ );

   9771  3 000144   201004 630500                    EPPR0   S$,,AUTO
         3 000145   201021 450500                    STP0    @NAME_SIZE+1,,AUTO
         3 000146   201012 631500                    EPPR1   S_NAME_SIZE,,AUTO
         3 000147   201020 451500                    STP1    @NAME+1,,AUTO
         3 000150   200403 633500                    EPPR3   S_NAME,,AUTO
         3 000151   201017 453500                    STP3    OU_NAME+3,,AUTO
         3 000152   000347 701000 3                  TSX1    GET_NAME
         3 000153   000000 011000                    NOP     0

      289     9772    7                           DO WHILE( S_NAME = P_NAME );

   9772  3 000154   040100 106500                    CMPC    fill='040'O
         3 000155   200403 002000                    ADSC9   S_NAME,,AUTO             cn=0,n=1024
         3 000156   200003 002000                    ADSC9   P_NAME,,AUTO             cn=0,n=1024
         3 000157   000203 601000 3                  TNZ     JUMP_OUT

      290     9773    7                               S$ = PINCRW( S$, SIZE );

   9773  3 000160   201010 236100                    LDQ     SIZE,,AUTO
         3 000161   000022 736000                    QLS     18
         3 000162   201004 036100                    ADLQ    S$,,AUTO
         3 000163   201004 756100                    STQ     S$,,AUTO

      291     9774    7                               IF S$ > Q$ THEN GOTO JUMP_OUT;

   9774  3 000164   000001 116000 2                  CMPQ    Q$
         3 000165   000167 600000 3                  TZE     s:9775
         3 000166   000203 603000 3                  TRC     JUMP_OUT

      292     9775    7                               CALL GET_NAME( S_NAME, S_NAME_SIZE, S$ );
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:90   

   9775  3 000167   201004 630500                    EPPR0   S$,,AUTO
         3 000170   201021 450500                    STP0    @NAME_SIZE+1,,AUTO
         3 000171   201012 631500                    EPPR1   S_NAME_SIZE,,AUTO
         3 000172   201020 451500                    STP1    @NAME+1,,AUTO
         3 000173   200403 633500                    EPPR3   S_NAME,,AUTO
         3 000174   201017 453500                    STP3    OU_NAME+3,,AUTO
         3 000175   000347 701000 3                  TSX1    GET_NAME
         3 000176   000000 011000                    NOP     0

      293     9776    7                               END;

   9776  3 000177   040100 106500                    CMPC    fill='040'O
         3 000200   200403 002000                    ADSC9   S_NAME,,AUTO             cn=0,n=1024
         3 000201   200003 002000                    ADSC9   P_NAME,,AUTO             cn=0,n=1024
         3 000202   000160 600000 3                  TZE     s:9773

      294     9777    6                           END;

      295     9778    5   JUMP_OUT:
      296     9779    5                       IF VY_MAP_TABS_A(VY_CTAB) + P_NAME_SIZE > VY_MAP_WIDTH

   9779  3 000203   000000 720000 xsym  JUMP_OUT     LXL0    VY_CTAB
         3 000204   000000 236010 xsym               LDQ     VY_MAP_TABS_A,X0
         3 000205   201011 036100                    ADLQ    P_NAME_SIZE,,AUTO
         3 000206   000000 116000 xsym               CMPQ    VY_MAP_WIDTH
         3 000207   000213 605400 3                  TPNZ    s:9784
         3 000210   000000 236000 xsym               LDQ     VY_MAX_CTAB
         3 000211   000000 116000 xsym               CMPQ    VY_CTAB
         3 000212   000223 603000 3                  TRC     s:9792

      297     9780    5                          OR VY_CTAB > VY_MAX_CTAB
      298     9781    6                       THEN DO;

      299     9782                                %M_WRITE;

   9784  3 000213   000000 630400 xsym               EPPR0   VY_MAP_LO_FPT_WRITE
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:91   
         3 000214   440001 713400                    CLIMB   alt,write
         3 000215   401400 401760                    pmme    nvectors=4
         3 000216   000340 702000 3                  TSX2    MAP_IO_ERROR

   9788  3 000217   040000 100400                    MLR     fill='040'O
         3 000220   000074 000002 1                  ADSC9   HEADING+60               cn=0,n=2
         3 000221   000000 000204 xsym               ADSC9   VY_MBUF                  cn=0,n=132

   9789  3 000222   000000 450000 xsym               STZ     VY_CTAB

      300     9791    6                           END;

      301     9792    5                       CALL INSERT( VY_MBUF.CHARS, VY_MAP_TABS_A(VY_CTAB), ,

   9792  3 000223   000000 720000 xsym               LXL0    VY_CTAB
         3 000224   000000 235010 xsym               LDA     VY_MAP_TABS_A,X0
         3 000225   201024 755100                    STA     NAME2$+1,,AUTO
         3 000226   000000 235010 xsym               LDA     VY_MAP_TABS_A,X0
         3 000227   000027 675000 xsym               ERA     B_VECTNIL+23
         3 000230   000205 035007                    ADLA    133,DL
         3 000231   201011 721100                    LXL1    P_NAME_SIZE,,AUTO
         3 000232   000000 622005                    EAX2    0,AL
         3 000233   201024 235100                    LDA     NAME2$+1,,AUTO
         3 000234   040045 100540                    MLR     fill='040'O
         3 000235   200003 000011                    ADSC9   P_NAME,,AUTO             cn=0,n=*X1
         3 000236   000000 000012 xsym               ADSC9   VY_MBUF,A                cn=0,n=*X2

      302     9793    5                          SUBSTR( P_NAME, 0, P_NAME_SIZE ) );
      303     9794                            %BUMP_CTAB( INC=P_NAME_SIZE, SPACE=5 );

   9795  3 000237   000000 236010 xsym               LDQ     VY_MAP_TABS_A,X0
         3 000240   201011 036100                    ADLQ    P_NAME_SIZE,,AUTO
         3 000241   000005 036007                    ADLQ    5,DL
         3 000242   000007 756000 2                  STQ     LAST_TAB

   9796  3 000243   000000 116010 xsym               CMPQ    VY_MAP_TABS_A,X0
         3 000244   000254 602000 3                  TNC     s:9800
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:92   
         3 000245   000254 600000 3                  TZE     s:9800

   9797  3 000246   000000 235000 xsym               LDA     VY_CTAB
         3 000247   000001 035007                    ADLA    1,DL
         3 000250   000000 755000 xsym               STA     VY_CTAB

   9798  3 000251   000000 236005 xsym               LDQ     VY_MAP_TABS_A,AL
         3 000252   000007 116000 2                  CMPQ    LAST_TAB
         3 000253   000246 602000 3                  TNC     s:9797

      304     9800    5                       P$ = S$;

   9800  3 000254   201004 236100                    LDQ     S$,,AUTO
         3 000255   000000 756000 2                  STQ     P$

      305     9801    5                       P_NAME = S_NAME;

   9801  3 000256   040100 100500                    MLR     fill='040'O
         3 000257   200403 002000                    ADSC9   S_NAME,,AUTO             cn=0,n=1024
         3 000260   200003 002000                    ADSC9   P_NAME,,AUTO             cn=0,n=1024

      306     9802    5                       P_NAME_SIZE = S_NAME_SIZE;

   9802  3 000261   201012 235100                    LDA     S_NAME_SIZE,,AUTO
         3 000262   201011 755100                    STA     P_NAME_SIZE,,AUTO

      307     9803    5                       END; /* Do while( P$ <= Q$ ); */

   9803  3 000263   000001 116000 2                  CMPQ    Q$
         3 000264   000125 602000 3                  TNC     s:9768
         3 000265   000125 600000 3                  TZE     s:9768

      308     9804    5                   IF VY_CTAB ~= 0 THEN DO;

   9804  3 000266   000000 235000 xsym               LDA     VY_CTAB
         3 000267   000300 600000 3                  TZE     s:9817

PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:93   
      309     9805                            %M_WRITE;

   9807  3 000270   000000 630400 xsym               EPPR0   VY_MAP_LO_FPT_WRITE
         3 000271   440001 713400                    CLIMB   alt,write
         3 000272   401400 401760                    pmme    nvectors=4
         3 000273   000340 702000 3                  TSX2    MAP_IO_ERROR

   9811  3 000274   040000 100400                    MLR     fill='040'O
         3 000275   000074 000002 1                  ADSC9   HEADING+60               cn=0,n=2
         3 000276   000000 000204 xsym               ADSC9   VY_MBUF                  cn=0,n=132

   9812  3 000277   000000 450000 xsym               STZ     VY_CTAB

      310     9814    5                       END;

      311     9815                        %M_WRITE( CLEAR=" ", ZERO=" " );

   9817  3 000300   000000 630400 xsym               EPPR0   VY_MAP_LO_FPT_WRITE
         3 000301   440001 713400                    CLIMB   alt,write
         3 000302   401400 401760                    pmme    nvectors=4
         3 000303   000340 702000 3                  TSX2    MAP_IO_ERROR

      312     9824    4                   END; /* If P$ ~= addr(nil) then do; */

      313     9825    3               END; /* If VY_O.MAP_A(I) then do; */

      314     9826    2           END; /* Do i = typedef to typesegref */

   9826  3 000304   000003 235000 2                  LDA     I
         3 000305   000001 035007                    ADLA    1,DL
         3 000306   000003 755000 2                  STA     I
         3 000307   000012 115007                    CMPA    10,DL
         3 000310   000013 602000 3                  TNC     s:9727

      315     9827
      316     9828    2       DO I = 1 TO 9;

PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:94   
   9828  3 000311   000001 236007                    LDQ     1,DL
         3 000312   000003 756000 2                  STQ     I

      317     9829    2           SIZE = VY_CURR$ -> VY$NODE.L_SIZE_A(I);

   9829  3 000313   000000 470400 xsym               LDP0    VY_CURR$
         3 000314   000003 720000 2                  LXL0    I
         3 000315   000054 235110                    LDA     44,X0,PR0
         3 000316   201010 755100                    STA     SIZE,,AUTO

      318     9830    2           IF SIZE > 0 THEN CALL VYF$FREE( VY_PASS1_ALL_TYPE(I), SIZE, 1 );

   9830  3 000317   000332 604400 3                  TMOZ    s:9831

   9830  3 000320   000003 236000 4                  LDQ     3
         3 000321   201026 756100                    STQ     NAME2$+3,,AUTO
         3 000322   201010 631500                    EPPR1   SIZE,,AUTO
         3 000323   201025 451500                    STP1    NAME2$+2,,AUTO
         3 000324   000000 633410 xsym               EPPR3   VY_PASS1_ALL_TYPE,X0
         3 000325   201024 453500                    STP3    NAME2$+1,,AUTO
         3 000326   201024 630500                    EPPR0   NAME2$+1,,AUTO
         3 000327   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000330   000000 701000 xent               TSX1    VYF$FREE
         3 000331   000000 011000                    NOP     0

      319     9831    2           END;

   9831  3 000332   000003 235000 2                  LDA     I
         3 000333   000001 035007                    ADLA    1,DL
         3 000334   000003 755000 2                  STA     I
         3 000335   000012 115007                    CMPA    10,DL
         3 000336   000313 602000 3                  TNC     s:9829

      320     9832    2       DO WHILE( '0'B );

   9832  3 000337   000346 710000 3                  TRA     s:9836

PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:95   
      321     9833    2   MAP_IO_ERROR:
      322     9834    2           CALL VYE$ERRMSG;

   9834  3 000340   000002 631400 xsym  MAP_IO_ERROR EPPR1   B_VECTNIL+2
         3 000341   000000 701000 xent               TSX1    VYE$ERRMSG
         3 000342   000000 011000                    NOP     0

      323     9835    2           CALL VYI$ERR;

   9835  3 000343   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000344   000000 701000 xent               TSX1    VYI$ERR
         3 000345   000000 011000                    NOP     0

      324     9836    2           END;

   9836  3 000346   000470 710000 3                  TRA     s:9859

      325     9837
      326     9838        %EJECT;
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:96   
      327     9839    1   GET_NAME: PROC( NAME, NAME_SIZE, ITEM$ );

   9839  3 000347   201016 741300       GET_NAME     STX1  ! OU_NAME+2,,AUTO

      328     9840
      329     9841    2   DCL NAME CHAR(1024);
      330     9842    2   DCL NAME_SIZE SBIN;
      331     9843    2   DCL ITEM$ PTR;
      332     9844
      333     9845    2   DCL NAME1$ PTR;
      334     9846    2   DCL NAME2$ PTR;
      335     9847
      336     9848
      337     9849    2       NAME1$ = PINCRW( NAME$, ITEM$ -> VY$TMPLT.A(N_D) );

   9849  3 000350   201021 470500                    LDP0    @ITEM$,,AUTO
         3 000351   000000 471500                    LDP1    0,,PR0
         3 000352   201013 235100                    LDA     N_D,,AUTO
         3 000353   000001 735000                    ALS     1
         3 000354   000100 100505                    MLR     fill='000'O
         3 000355   100000 000002                    ADSC9   0,A,PR1                  cn=0,n=2
         3 000356   201024 000004                    ADSC9   NAME2$+1,,AUTO           cn=0,n=4
         3 000357   201024 220100                    LDX0    NAME2$+1,,AUTO
         3 000360   000000 636010                    EAQ     0,X0
         3 000361   201005 036100                    ADLQ    NAME$,,AUTO
         3 000362   201022 756100                    STQ     NAME1$,,AUTO

      338     9850    2       NAME2$ = PINCRW( DNAME$, ITEM$ -> VY$TMPLT.A(OU_NAME) );

   9850  3 000363   000000 471500                    LDP1    0,,PR0
         3 000364   201014 235100                    LDA     OU_NAME,,AUTO
         3 000365   000001 735000                    ALS     1
         3 000366   000100 100505                    MLR     fill='000'O
         3 000367   100000 000002                    ADSC9   0,A,PR1                  cn=0,n=2
         3 000370   201024 000004                    ADSC9   NAME2$+1,,AUTO           cn=0,n=4
         3 000371   201024 220100                    LDX0    NAME2$+1,,AUTO
         3 000372   000000 636010                    EAQ     0,X0
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:97   
         3 000373   201006 036100                    ADLQ    DNAME$,,AUTO
         3 000374   201023 756100                    STQ     NAME2$,,AUTO

      339     9851    2       CALL CONCAT( NAME, NAME1$->B$DNAME.TEXT, ' (', NAME2$->B$DNAME.TEXT, ')' );

   9851  3 000375   201022 471500                    LDP1    NAME1$,,AUTO
         3 000376   100000 220100                    LDX0    0,,PR1
         3 000377   201023 473500                    LDP3    NAME2$,,AUTO
         3 000400   300000 222100                    LDX2    0,,PR3
         3 000401   201017 474500                    LDP4    @NAME,,AUTO
         3 000402   040100 100540                    MLR     fill='040'O
         3 000403   100000 400010                    ADSC9   0,,PR1                   cn=2,n=*X0
         3 000404   400000 002000                    ADSC9   0,,PR4                   cn=0,n=1024
         3 000405   000000 636010                    EAQ     0,X0
         3 000406   000022 772000                    QRL     18
         3 000407   002000 116007                    CMPQ    1024,DL
         3 000410   000455 603000 3                  TRC     s:9852
         3 000411   201024 740100                    STX0    NAME2$+1,,AUTO
         3 000412   775777 620010                    EAX0    -1025,X0
         3 000413   777777 660003                    ERX0    -1,DU
         3 000414   201024 235100                    LDA     NAME2$+1,,AUTO
         3 000415   000022 771000                    ARL     18
         3 000416   040145 100400                    MLR     fill='040'O
         3 000417   000075 000002 1                  ADSC9   HEADING+61               cn=0,n=2
         3 000420   400000 000010                    ADSC9   0,A,PR4                  cn=0,n=*X0
         3 000421   201024 236100                    LDQ     NAME2$+1,,AUTO
         3 000422   000022 772000                    QRL     18
         3 000423   001776 116007                    CMPQ    1022,DL
         3 000424   000455 603000 3                  TRC     s:9852
         3 000425   776001 620006                    EAX0    -1023,QL
         3 000426   777777 660003                    ERX0    -1,DU
         3 000427   040146 100540                    MLR     fill='040'O
         3 000430   300000 400012                    ADSC9   0,,PR3                   cn=2,n=*X2
         3 000431   400000 400010                    ADSC9   0,Q,PR4                  cn=2,n=*X0
         3 000432   000000 635012                    EAA     0,X2
         3 000433   000022 771000                    ARL     18
         3 000434   201025 755100                    STA     NAME2$+2,,AUTO
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:98   
         3 000435   201025 036100                    ADLQ    NAME2$+2,,AUTO
         3 000436   001776 116007                    CMPQ    1022,DL
         3 000437   000455 603000 3                  TRC     s:9852
         3 000440   000000 635012                    EAA     0,X2
         3 000441   000022 771000                    ARL     18
         3 000442   201026 755100                    STA     NAME2$+3,,AUTO
         3 000443   201027 756100                    STQ     NAME2$+4,,AUTO
         3 000444   201024 236100                    LDQ     NAME2$+1,,AUTO
         3 000445   000022 772000                    QRL     18
         3 000446   201026 036100                    ADLQ    NAME2$+3,,AUTO
         3 000447   201027 721100                    LXL1    NAME2$+4,,AUTO
         3 000450   776001 621011                    EAX1    -1023,X1
         3 000451   777777 661003                    ERX1    -1,DU
         3 000452   040146 100400                    MLR     fill='040'O
         3 000453   000006 000001 4                  ADSC9   6                        cn=0,n=1
         3 000454   400000 400011                    ADSC9   0,Q,PR4                  cn=2,n=*X1

      340     9852    2       NAME_SIZE = NAME1$->B$DNAME.COUNT + NAME2$->B$DNAME.COUNT + 3;

   9852  3 000455   300000 236100                    LDQ     0,,PR3
         3 000456   000022 772000                    QRL     18
         3 000457   201024 756100                    STQ     NAME2$+1,,AUTO
         3 000460   100000 236100                    LDQ     0,,PR1
         3 000461   000022 772000                    QRL     18
         3 000462   201024 036100                    ADLQ    NAME2$+1,,AUTO
         3 000463   000003 036007                    ADLQ    3,DL
         3 000464   201020 475500                    LDP5    @NAME_SIZE,,AUTO
         3 000465   500000 756100                    STQ     0,,PR5

      341     9853
      342     9854
      343     9855
      344     9856    2   END GET_NAME;

   9856  3 000466   201016 221300                    LDX1  ! OU_NAME+2,,AUTO
         3 000467   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:99   
      345     9857
      346     9858
      347     9859    1   END VYM$MAP;

   9859  3 000470   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:100  
--  Include file information  --

   B$OBJECT_C.:E05TOU  is referenced.
   VY_DCB_R.:E05TOU  cannot be made into a system file and is referenced.
   VY_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VY_FIXED_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VY_MACRO_C.:E05TOU  is referenced.
   VY_PERR_C.:E05TOU  is referenced.
   VY_SUBS_C.:E05TOU  is referenced.
   VY_INC_NO_C.:E05TOU  is referenced.
   VY_SWITCH_C.:E05TOU  is referenced.
   VY_INC_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VYM$MAP.
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:101  

 **** Variables and constants ****

  ****  Section 001 RoData VYM$MAP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(40)    r     1 HEADING(0:5)

  ****  Section 002  Data  VYM$MAP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w UBIN        r     1 I                          7-0-0/w UBIN        r     1 LAST_TAB
     0-0-0/w PTR         r     1 P$                         1-0-0/w PTR         r     1 Q$

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  1021-0-0/w PTR         r     1 @ITEM$                  1017-0-0/w PTR         r     1 @NAME
  1020-0-0/w PTR         r     1 @NAME_SIZE              1006-0-0/w PTR         r     1 DNAME$
  1003-0-0/b BIT         r     1 FIRST_TIME                *0-0-0/w PTR         r     1 ITEM$
    *0-0-0/c CHAR(1024)  r     1 NAME                    1005-0-0/w PTR         r     1 NAME$
  1022-0-0/w PTR         r     1 NAME1$                  1023-0-0/w PTR         r     1 NAME2$
    *0-0-0/w SBIN        r     1 NAME_SIZE               1013-0-0/w UBIN        r     1 N_D
  1014-0-0/w UBIN        r     1 OU_NAME                    3-0-0/c CHAR(1024)  r     1 P_NAME
  1011-0-0/w SBIN        r     1 P_NAME_SIZE             1007-0-0/w PTR         r     1 RNAME$
  1004-0-0/w PTR         r     1 S$                      1010-0-0/w SBIN        r     1 SIZE
   403-0-0/c CHAR(1024)  r     1 S_NAME                  1012-0-0/w SBIN        r     1 S_NAME_SIZE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:102  

     0-0-0/w UBIN        r     1 VY_CTAB                    0-0-0/w PTR         r     1 VY_CURR$
     0-0-0/d STRC(432)   r     1 VY_MAP_LIT_LO_FPT_WRITE
     0-0-0/d STRC(432)   r     1 VY_MAP_LO_FPT_WRITE
     0-0-0/w UBIN        r     1 VY_MAP_TABS_A(0:4)
     0-0-0/w SBIN        r     1 VY_MAP_WIDTH               0-0-0/w UBIN        r     1 VY_MAX_CTAB
     0-0-0/w STRC(1188)  r     1 VY_MBUF                    0-0-0/w STRC(648)   r     1 VY_O
     0-0-0/w SBIN        r     1 VY_PASS1_ALL_TYPE(0:9)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w ASTR(18)    r     1 B$DNAME                    0-0-0/w STRC(3672)  r     1 VY$NODE
     0-0-0/w STRC(72)    r     1 VY$TMPLT                   0-0-0/w STRC(72)    r     1 VYD$TMPLT
     0-0-0/w STRC        r     1 VYR$TMPLT


   Procedure VYM$MAP requires 313 words for executable code.
   Procedure VYM$MAP requires 540 words of local(AUTO) storage.

    No errors detected in file VYM$MAIN.:E05TSI    .
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:103  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:104  
          MINI XREF LISTING

B$DNAME.COUNT
      9527**DCL      9534--IMP-SIZ  9851>>CALLBLT  9851>>CALLBLT  9852>>ASSIGN   9852>>ASSIGN
B$DNAME.TEXT
      9534**DCL      9851>>CALLBLT  9851>>CALLBLT
DNAME$
      9666**DCL      9723<<ASSIGN   9755>>ASSIGN   9850>>ASSIGN
FIRST_TIME
      9642**DCL      9725<<ASSIGN   9730>>IF       9741<<ASSIGN
GET_NAME
      9839**PROC     9768--CALL     9771--CALL     9775--CALL
HEADING
      9597**DCL      9744--ASSIGN
I
      9704**DCL      9705--REDEF    9726<<DOINDEX  9727>>IF       9728>>ASSIGN   9744>>ASSIGN   9753>>ASSIGN
      9754>>IF       9828<<DOINDEX  9829>>ASSIGN   9830>>CALL
ITEM$ IN PROCEDURE GET_NAME
      9843**DCL      9839--PROC     9849>>ASSIGN   9850>>ASSIGN
J
      9706**DCL      9707--REDEF
JUMP_OUT
      9779**LABEL    9774--GOTO
K
      9708**DCL      9709--REDEF
L
      9710**DCL      9711--REDEF
LAST_TAB
      9719**DCL      9795<<ASSIGN   9796>>DOWHILE
M$WRITE
      1610**DCL-ENT  9734--CALL     9745--CALL     9784--CALL     9807--CALL     9817--CALL
MAP_IO_ERROR
      9834**LABEL    9734--CALLALT  9745--CALLALT  9784--CALLALT  9807--CALLALT  9817--CALLALT
NAME IN PROCEDURE GET_NAME
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:105  
      9841**DCL      9839--PROC     9851<<CALLBLT
NAME$
      9665**DCL      9755<<ASSIGN   9763<<ASSIGN   9766<>CALL     9849>>ASSIGN
NAME1$ IN PROCEDURE GET_NAME
      9845**DCL      9849<<ASSIGN   9851>>CALLBLT  9851>>CALLBLT  9852>>ASSIGN
NAME2$ IN PROCEDURE GET_NAME
      9846**DCL      9850<<ASSIGN   9851>>CALLBLT  9851>>CALLBLT  9852>>ASSIGN
NAME_SIZE IN PROCEDURE GET_NAME
      9842**DCL      9839--PROC     9852<<ASSIGN
N_D
      9713**DCL      9756<<ASSIGN   9761<<ASSIGN   9766<>CALL     9849>>ASSIGN
OU_NAME
      9716**DCL      9757<<ASSIGN   9762<<ASSIGN   9766<>CALL     9850>>ASSIGN
P$
      9660**DCL      9728<<ASSIGN   9729>>IF       9766<>CALL     9767>>DOWHILE  9768<>CALL     9769>>ASSIGN
      9800<<ASSIGN
P_NAME
      9604**DCL      9768<>CALL     9772>>DOWHILE  9792>>CALLBLT  9801<<ASSIGN
P_NAME_SIZE
      9685**DCL      9768<>CALL     9779>>IF       9792>>CALLBLT  9795>>ASSIGN   9802<<ASSIGN
Q$
      9661**DCL      9753<<ASSIGN   9766<>CALL     9767>>DOWHILE  9770>>IF       9774>>IF
RNAME$
      9667**DCL      9724<<ASSIGN   9763>>ASSIGN
S$
      9664**DCL      9769<<ASSIGN   9770>>IF       9771<>CALL     9773<<ASSIGN   9773>>ASSIGN   9774>>IF
      9775<>CALL     9800>>ASSIGN
SIZE
      9684**DCL      9758<<ASSIGN   9764<<ASSIGN   9766<>CALL     9769>>ASSIGN   9773>>ASSIGN   9829<<ASSIGN
      9830>>IF       9830<>CALL
S_NAME
      9605**DCL      9771<>CALL     9772>>DOWHILE  9775<>CALL     9801>>ASSIGN
S_NAME_SIZE
      9686**DCL      9771<>CALL     9775<>CALL     9802>>ASSIGN
VY$NODE.ADDR_START_A
      9233**DCL      9234--REDEF
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:106  
VY$NODE.ADDR_STOP_A
      9238**DCL      9239--REDEF
VY$NODE.L_PREV_SIZE
      9291**DCL      9302--REDEF
VY$NODE.L_SC_START
      9310**DCL      9315--REDEF
VY$NODE.L_SC_STOP
      9316**DCL      9321--REDEF
VY$NODE.L_SIZE
      9279**DCL      9290--REDEF
VY$NODE.L_SIZE_A
      9290**DCL      9829>>ASSIGN
VY$NODE.L_START
      9255**DCL      9266--REDEF
VY$NODE.L_START.DN$
      9257**DCL      9723>>ASSIGN
VY$NODE.L_START.RN$
      9258**DCL      9724>>ASSIGN
VY$NODE.L_START_A$
      9266**DCL      9728>>ASSIGN
VY$NODE.L_STOP
      9267**DCL      9278--REDEF
VY$NODE.L_STOP_A$
      9278**DCL      9753>>ASSIGN
VY$NODE.PROMOTE_HEAD
      9322**DCL      9325--REDEF
VY$NODE.PROMOTE_TAIL
      9326**DCL      9329--REDEF
VY$NODE.START_PAGE#_A
      9243**DCL      9244--REDEF
VY$NODE.STOP_PAGE#_A
      9248**DCL      9249--REDEF
VY$TMPLT.A
      9495**DCL      9496--REDEF    9497--REDEF    9849>>ASSIGN   9850>>ASSIGN
VYD$TMPLT
      9358**DCL      9758--ASSIGN
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:107  
VYD$TMPLT.A
      9359**DCL      9360--REDEF    9361--REDEF    9388--REDEF    9394--REDEF    9397--REDEF
VYD$TMPLT.I.A
      9378**DCL      9379--REDEF
VYD$TMPLT.I.CST
      9382**DCL      9383--REDEF
VYD$TMPLT.I.I
      9380**DCL      9381--REDEF
VYD$TMPLT.I.NAME_DISP
      9374**DCL      9375--REDEF
VYD$TMPLT.I.NP
      9384**DCL      9385--REDEF
VYD$TMPLT.I.P
      9376**DCL      9377--REDEF
VYD$TMPLT.I.SC#
      9369**DCL      9370--REDEF
VYE$ERRMSG
      9622**DCL-ENT  9834--CALL
VYF$FREE
      9623**DCL-ENT  9830--CALL
VYI$ERR
      9625**DCL-ENT  9835--CALL
VYQ$SORT
      9624**DCL-ENT  9766--CALL
VYR$SAT.VALUE
      9463**DCL      9464--REDEF
VYR$TMPLT
      9425**DCL      9764--ASSIGN
VYR$TMPLT.ER
      9427**DCL      9433--REDEF    9438--REDEF    9443--REDEF
VY_BIAS.A
      5388**DCL      5388--REDEF
VY_CBUF.CHARS_A
      5379**DCL      5379--REDEF
VY_CTAB
      5743**DCL      9739<<ASSIGN   9779>>IF       9779>>IF       9789<<ASSIGN   9792>>CALLBLT  9795>>ASSIGN
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:108  
      9796>>DOWHILE  9797<<ASSIGN   9797>>ASSIGN   9804>>IF       9812<<ASSIGN
VY_CURR$
      5383**DCL      9723>>ASSIGN   9724>>ASSIGN   9728>>ASSIGN   9753>>ASSIGN   9829>>ASSIGN
VY_EBUF.CHARS_A
      5680**DCL      5681--REDEF
VY_EFIELD1.CHARS
      5681**DCL      5681--REDEF
VY_EFIELD2.CHARS
      5682**DCL      5682--REDEF
VY_EFIELD3.CHARS
      5683**DCL      5683--REDEF
VY_ERRORS
      5384**DCL      5386--REDEF
VY_ERRORS.CONFLICT_A
      5385**DCL      5386--REDEF
VY_ERRORS.UNSAT_A
      5384**DCL      5385--REDEF
VY_IMAGE_DATA.CPAGE#_A
      5272**DCL      5273--REDEF
VY_IMAGE_DATA.NODE_A$
      5284**DCL      5285--REDEF
VY_IMAGE_DATA.START_A$
      5276**DCL      5277--REDEF
VY_IMAGE_DATA.STOP_A$
      5280**DCL      5281--REDEF
VY_IMAGE_PROC.CPAGE#_A
      5295**DCL      5296--REDEF
VY_IMAGE_PROC.NODE_A$
      5307**DCL      5308--REDEF
VY_IMAGE_PROC.START_A$
      5299**DCL      5300--REDEF
VY_IMAGE_PROC.STOP_A$
      5303**DCL      5304--REDEF
VY_IMAGE_ROS.CPAGE#_A
      5318**DCL      5319--REDEF
VY_IMAGE_ROS.NODE_A$
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:109  
      5330**DCL      5331--REDEF
VY_IMAGE_ROS.START_A$
      5322**DCL      5323--REDEF
VY_IMAGE_ROS.STOP_A$
      5326**DCL      5327--REDEF
VY_MAP_HDR.CHARS
      5745**DCL      5746--REDEF    5746--REDEF
VY_MAP_LIT_LO_FPT_WRITE
      5072**DCL      9745<>CALL
VY_MAP_LIT_LO_FPT_WRITE.BUF_
      5072**DCL      9744<<ASSIGN
VY_MAP_LIT_LO_FPT_WRITE.STATION_
      5074**DCL      5074--REDEF
VY_MAP_LIT_LO_FPT_WRITE.V.DVBYTE.VFC#
      5081**DCL      5081--REDEF
VY_MAP_LO_FPT_WRITE
      5041**DCL      9734<>CALL     9784<>CALL     9807<>CALL     9817<>CALL
VY_MAP_LO_FPT_WRITE.STATION_
      5043**DCL      5043--REDEF
VY_MAP_LO_FPT_WRITE.V.DVBYTE.VFC#
      5050**DCL      5050--REDEF
VY_MAP_TABS_A
      5743**DCL      9779>>IF       9792>>CALLBLT  9795>>ASSIGN   9796>>DOWHILE
VY_MAP_WIDTH
      5743**DCL      9779>>IF
VY_MAX_CTAB
      5744**DCL      9779>>IF
VY_MBUF.CHARS
      5744**DCL      5745--REDEF    5745--REDEF    9731<<ASSIGN   9788<<ASSIGN   9792<<CALLBLT  9811<<ASSIGN
VY_M_VECTOR.F
      5113**DCL      5117--REDEF
VY_M_VECTOR_DP.F
      5148**DCL      5152--REDEF
VY_O.DUPL_ATTCH
      5526**DCL      5530--REDEF
VY_O.MAP_A
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:110  
      5525**DCL      9727>>IF
VY_O.MAP_ATTCH
      5514**DCL      5525--REDEF
VY_O.PRIMARY_OPTION
      5508**DCL      5513--REDEF
VY_O.SEV_ATTCH
      5531**DCL      5533--REDEF
VY_OD.DUPL_ATTCH
      5670**DCL      5674--REDEF
VY_OD.MAP_ATTCH
      5658**DCL      5669--REDEF
VY_OD.PRIMARY_OPTION
      5652**DCL      5657--REDEF
VY_OD.SEV_ATTCH
      5675**DCL      5677--REDEF
VY_OL_KEY_BUF.FORM0
      5181**DCL      5184--REDEF    5191--REDEF
VY_OU_HEAD.REC_A
      5369**DCL      5370--REDEF
VY_O_KEY_BUF.FORM0
      5158**DCL      5161--REDEF    5168--REDEF
VY_O_KEY_BUF_L.FORM0
      5204**DCL      5207--REDEF    5214--REDEF
VY_PAR_UNWIND
      5739**DCL      5739--REDEF
VY_PASS1_ALL_TYPE
      5699**DCL      9830<>CALL
VY_PASS2_REF.OU.L_START
      5706**DCL      5707--REDEF
VY_PASS2_REF.OU.L_STOP
      5707**DCL      5708--REDEF
VY_PASS2_REF.OU.MAX
      5705**DCL      5706--REDEF
VY_PASS2_REF.OU.SIZE
      5708**DCL      5709--REDEF
VY_PASS2_REF.SAT.COUNT
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:111  
      5712**DCL      5713--REDEF
VY_PASS2_REF.SAT.ENT_SIZE
      5714**DCL      5715--REDEF
VY_PASS2_REF.SAT.L_START
      5710**DCL      5711--REDEF
VY_PASS2_REF.SAT.L_STOP
      5711**DCL      5712--REDEF
VY_PASS2_REF.SAT.MAX
      5709**DCL      5710--REDEF
VY_PASS2_REF.UNSAT.L_START
      5716**DCL      5717--REDEF
VY_PASS2_REF.UNSAT.L_STOP
      5717**DCL      5718--REDEF
VY_PASS2_REF.UNSAT.L_WHERE
      5718**DCL      5719--REDEF
VY_PASS2_REF.UNSAT.MAX
      5715**DCL      5716--REDEF
VY_PASS2_REF.UNSAT.PAGE#
      5720**DCL      5721--REDEF
VY_PASS2_REF.UNSAT.SIZE
      5719**DCL      5720--REDEF
VY_PROGRAM_BIAS.A
      5387**DCL      5387--REDEF
VY_RU_HEAD.DATA_SEGMENT
      5355**DCL      5355--REDEF
VY_RU_HEAD.L
      5351**DCL      5352--REDEF
VY_RU_HEAD.MAP_BITS
      5352**DCL      5354--REDEF
VY_RU_HEAD.PBIT
      5348**DCL      5348--REDEF
VY_RU_HEAD_BUF.DATA_SEGMENT
      5365**DCL      5365--REDEF
VY_RU_HEAD_BUF.L
      5360**DCL      5361--REDEF
VY_RU_HEAD_BUF.MAP_BITS
PL6.E3A0      #002=VYM$MAP File=VYM$MAIN.:E05TSI                                 WED 07/30/97 08:57 Page:112  
      5362**DCL      5364--REDEF
VY_RU_HEAD_BUF.PBIT
      5357**DCL      5358--REDEF
VY_R_KEY_BUF.FORM0
      5227**DCL      5231--REDEF    5237--REDEF
VY_SI_KEY_BUF.KEY
      5735**DCL      5735--REDEF
VY_SPC.B$.MINE
      5730**DCL      5731--REDEF
VY_SPC.B$.NAME
      5727**DCL      5727--REDEF
VY_SPC.B$.SKIP
      5729**DCL      5730--REDEF
VY_SPC.B$.VALUE
      5728**DCL      5729--REDEF
VY_SPC.SEG.NAME
      5722**DCL      5723--REDEF
VY_SPC.SEG.VALUE
      5723**DCL      5724--REDEF
VY_TSX0_OVERLAY.H
      5694**DCL      5695--REDEF
