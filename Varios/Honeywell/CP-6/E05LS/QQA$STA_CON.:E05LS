VERSION E05

PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:1    
        1        1        /*M* QQA$STA_CON - Process station connect events */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        /*P* NAME:        QQA$STA_CON
        9        9
       10       10             PURPOSE:     To process *AUEV messages heralding the arrival
       11       11                          of a new TP station.
       12       12        */
       13       13        /*D* NAME:        QQA$STA_CON
       14       14
       15       15             CALL:        CALL QQA$STA_CON
       16       16
       17       17             INPUT:       The contents of the *AUEV connect message
       18       18
       19       19             OUTPUT:      None
       20       20
       21       21             DESCRIPTION: This routine connects TP stations to the instance
       22       22                          of TP.  A position is found for the new station's
       23       23                          context and if necessary a page of a data
       24       24                          segment is obtained to make room for the new
       25       25                          station.  If the station has a priority that
       26       26                          is > 1 then we use a M$CGCTL to tell the
       27       27                          comgroup about this station's priority.
       28       28
       29       29                          The first command (if there is one) can not
       30       30                          be executed for the station at this time.
       31       31                          To execute the first command we must first
       32       32                          wait for the command forms program to be
       33       33                          loaded.  The first command will be saved until
       34       34                          we receive the *IAMRDY message.
       35       35
       36       36                          The default command forms program is started.
       37       37        */
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:2    
       38       38        %EJECT;
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:3    
       39       39        QQA$STA_CON:
       40       40                PROC;
       41       41
       42       42        %INCLUDE Q_PAGE_C;
       43       74        %SET LISTEXP = '1'B;
       44       75        %PAGE(ARG="Includes");

                92        /***************************************************************************
                93         *                                                                         *
                94         *                                  Includes                               *
                95         *                                                                         *
                96         ***************************************************************************/

       45      100        %INCLUDE QQ_SUPER_C;
       46      155        %INCLUDE QQ_MACROS_C;
       47      580        %INCLUDE QQ_SUBS_C;
       48      772        %INCLUDE CP_6;
       49      853        %INCLUDE B_ERRORS_C;
       50     1980        %INCLUDE QQ_DATA_R;
       51     2226        %INCLUDE Q_ERRCODE_C;
       52     2249        %INCLUDE QQ_PERR_C;
       53     2410        %INCLUDE QT_MACROS_C;
       54     2568        %PAGE(ARG="Externally defined routines");

              2585    1   /***************************************************************************
              2586    1    *                                                                         *
              2587    1    *                        Externally defined routines                      *
              2588    1    *                                                                         *
              2589    1    ***************************************************************************/

       55     2593    1   DCL QQA$BYTYPE ENTRY(4) ALTRET;
       56     2594    1   DCL QQA$SETFP ENTRY(2);
       57     2595    1   DCL QQC$FINDSTA ENTRY(3);
       58     2596    1   DCL QQC$SCREECH ENTRY;
       59     2597    1   DCL QQC$DISAB_CHK ENTRY(2) ALTRET;
       60     2598    1   DCL QQC$GET_BLK ENTRY(3) ALTRET;
       61     2599    1   DCL QQD$SLIDE ENTRY(3);
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:4    
       62     2600    1   DCL QQC$BLDMSG ENTRY(1);
       63     2601    1   DCL QQC$BLDMSG_ERRBLK ENTRY(1);
       64     2602    1   DCL QQC$BLDMSG_BLK ENTRY(1);
       65     2603        %PAGE(ARG="Symrefs");

              2620    1   /***************************************************************************
              2621    1    *                                                                         *
              2622    1    *                                  Symrefs                                *
              2623    1    *                                                                         *
              2624    1    ***************************************************************************/

       66     2628    1   DCL B$TCB$ PTR SYMREF;
       67     2629        %PAGE(ARG="DCBs");

              2646    1   /***************************************************************************
              2647    1    *                                                                         *
              2648    1    *                                    DCBs                                 *
              2649    1    *                                                                         *
              2650    1    ***************************************************************************/

       68     2654    1   DCL M$CG DCB;
       69     2655        %PAGE(ARG="Based");

              2672    1   /***************************************************************************
              2673    1    *                                                                         *
              2674    1    *                                   Based                                 *
              2675    1    *                                                                         *
              2676    1    ***************************************************************************/

       70     2680        %B$TCB;
       71     2683        %B$ALT;
       72     2691        %B$CGAURD(STCLASS="BASED(QQ_GLOBAL.CMDBUF$)", LAST=", ");
       73     2710        %B$CGAUCI(LVL=2, LAST=", ");
       74     2732        %QQ$LOGON(LVL=2);
       75     2768        %TP$STATION;
       76     2841
       77     2842    1   DCL CMD CHAR(80) BASED;
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:5    
       78     2843
       79     2844    1   DCL CHAR$STRING CHAR(CHAR_STRING_SIZE) BASED;
       80     2845        %PAGE(ARG="Static");

              2862    1   /***************************************************************************
              2863    1    *                                                                         *
              2864    1    *                                   Static                                *
              2865    1    *                                                                         *
              2866    1    ***************************************************************************/

       81     2870    1   DCL UTS UBIN WORD STATIC;
       82     2871
       83     2872    1   DCL STATION CHAR(8) STATIC;
       84     2873    1   DCL REPLY_BUF CHAR(80) STATIC;
       85     2874        %PAGE(ARG="Auto");

              2891    1   /***************************************************************************
              2892    1    *                                                                         *
              2893    1    *                                    Auto                                 *
              2894    1    *                                                                         *
              2895    1    ***************************************************************************/

       86     2899    1   DCL P$ PTR;
       87     2900    1   DCL ERR UBIN;
       88     2901    1   DCL FOUND_FLAG BIT(1) ALIGNED;
       89     2902
       90     2903    1   DCL WORDS_TO_MOVE SBIN WORD;
       91     2904    1   DCL CHAR_STRING_SIZE UBIN WORD;
       92     2905
       93     2906        %MSGBLK;
       94     2996        %QT$FORM(FPTN=QT_FORM,STCLASS=AUTO);
       95     3035        %VLP_NAME(FPTN=TEXTC_STATION,STCLASS=AUTO,LEN=8);
       96     3062        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:6    
              3079    1   /***************************************************************************
              3080    1    *                                                                         *
              3081    1    *                                Error codes                              *
              3082    1    *                                                                         *
              3083    1    ***************************************************************************/

       97     3087        %ERRCODE(NAME=CODE_NO_POOLMEM, CODE#=%E$NO_POOLMEM, FCG#=%FCG_QQ, MID#=%MID_A);
       98     3094        %ERRCODE(NAME=CODE_UTAS, CODE#=%E$UTAS, FCG#=%FCG_QQ, MID#=%MID_A);
       99     3101        /*E*       ERROR: QQA-E$UTAS-C
      100     3102                 MESSAGE: Unable to activate station %U1.
      101     3103             DESCRIPTION: For the reason which follows we were unable
      102     3104                          to activate this station.  The station has
      103     3105                          been deactivated.
      104     3106        */
      105     3107        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:7    
              3124    1   /***************************************************************************
              3125    1    *                                                                         *
              3126    1    *                                    FPTs                                 *
              3127    1    *                                                                         *
              3128    1    ***************************************************************************/

      106     3132        %FPT_GDS(RESULTS=VLP_VECTOR, SEGSIZE=1024);
      107     3148
      108     3149        %FPT_ACTIVATE(DCB=M$CG, STATION=STATION, DISCONNECT=YES ,MAKEFPRG=YES);
      109     3172
      110     3173        %FPT_TIME(SOURCE=CLOCK, TSTAMP=UTS);
      111     3192
      112     3193        %FPT_CGCTL(DCB=M$CG, STAFC=ADD, STALIST=VLP_CGSTAL);
      113     3216
      114     3217        %FPT_CGINFO(DCB=M$CG, STALIST=VLP_CGSTAL);
      115     3237        %VLP_FPRG;
      116     3258        %FPT_SETFP(DCB=M$CG, FPRG=VLP_FPRG, STATION=VLP_STATION);
      117     3271        %PAGE(ARG="VLPs");

              3288    1   /***************************************************************************
              3289    1    *                                                                         *
              3290    1    *                                    VLPs                                 *
              3291    1    *                                                                         *
              3292    1    ***************************************************************************/

      118     3296        %VLP_VECTOR;
      119     3311        %VLP_CGSTAL;
      120     3336        %VLP_STATION;
      121     3363        %PAGE(ARG="QQA$STA_CON", PAGE=YES);

PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:8    
              3380    1   /***************************************************************************
              3381    1    *                                                                         *
              3382    1    *                                QQA$STA_CON                              *
              3383    1    *                                                                         *
              3384    1    ***************************************************************************/

      122     3388                                      /*  Fill in Command Forms Program VLP_FPRG info */
      123     3389    1           VLP_FPRG.PSN#  = QQ_GLOBAL.CFP_RU.PSN;
      124     3390    1           VLP_FPRG.NAME  = QQ_GLOBAL.CFP_RU.NAME;
      125     3391    1           VLP_FPRG.ACCT# = QQ_GLOBAL.CFP_RU.ACCT;
      126     3392    1           VLP_FPRG.PASS# = QQ_GLOBAL.CFP_RU.PASS;
      127     3393    1           STATION = B$CGAURD.STATION;
      128     3394
      129     3395                                      /* If we are stopping TP don't disconnect cuz   */
      130     3396                                      /* auto logon stations will only just connect   */
      131     3397                                                /* again after u disconnect them      */
      132     3398    1           IF QQ_GLOBAL.TERMINATE THEN
      133     3399    2             DO;
      134     3400    2               GOTO RET;
      135     3401    2             END;
      136     3402
      137     3403    1           IF QQ_GLOBAL.STATION_CNT >= QQ_GLOBAL.STATIONMAX THEN
      138     3404    2             DO;
      139     3405    2               VLP_STATION.STATION# = STATION;
      140     3406    2               CALL M$ACTIVATE(FPT_ACTIVATE) ALTRET(ACTIVATE_ERR);
      141     3407    2               CALL M$SETFP(FPT_SETFP) ALTRET(DISCO);
      142     3408    2               RETURN;
      143     3409    2             END;
      144     3410
      145     3411    1           IF NOT B$CGAURD.QQ$LOGON.MCT THEN
      146     3412    2             DO;
      147     3413    2               CALL QQC$DISAB_CHK(STATION, 1 /* OPT_STATION */) ALTRET(DISCO);
      148     3414    2             END;
      149     3415
      150     3416    1           IF QQ_GLOBAL.STATIONSLOTS = 0 THEN
      151     3417    2             DO;
      152     3418    2               VLP_VECTOR.PTR$ = QQ_GLOBAL.STATION$;
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:9    
      153     3419    2               CALL M$GDS(FPT_GDS) ALTRET(MON_ERR);
      154     3420    2               QQ_GLOBAL.STATIONSLOTS = 1024 / SIZEW(TP$STATION);
      155     3421    2             END;
      156     3422
      157     3423    1           CALL QQC$FINDSTA(B$CGAURD.STATION, S$, FOUND_FLAG);
      158     3424
      159     3425    1           P$ = PINCRW(QQ_GLOBAL.STATION$, QQ_GLOBAL.STATION_CNT * SIZEW(TP$STATION));
      160     3426    1           WORDS_TO_MOVE = POFFW(P$, S$);
      161     3427
      162     3428    1           CALL QQD$SLIDE(S$, SIZEW(TP$STATION), WORDS_TO_MOVE);
      163     3429
      164     3430    1           TP$STATION = QQ_TP$STATION_INIT;
      165     3431    1           CALL M$TIME(FPT_TIME);
      166     3432    1           TP$STATION.LOGON_UTS = UTS;
      167     3433    1           TP$STATION.ID = B$CGAURD.STATION;
      168     3434                                                /*  Get :HLP key from B$CGAUCI        */
      169     3435    1           TP$STATION.WHO.ACCT = B$CGAURD.B$CGAUCI.WHO.ACCT;
      170     3436    1           TP$STATION.WHO.NAME = B$CGAURD.B$CGAUCI.WHO.NAME;
      171     3437
      172     3438    1           TP$STATION.FLAGS.MCT = B$CGAURD.QQ$LOGON.MCT;
      173     3439    1           TP$STATION.FLAGS.PRIV = B$CGAURD.QQ$LOGON.MCTCMD;
      174     3440    1           TP$STATION.FLAGS.ASSIST = B$CGAURD.QQ$LOGON.RAS;
      175     3441    1           TP$STATION.DFLT_PRIO = B$CGAURD.QQ$LOGON.PRIO;
      176     3442    1           QQ_GLOBAL.STATIONSLOTS = QQ_GLOBAL.STATIONSLOTS - 1;
      177     3443    1           QQ_GLOBAL.STATION_CNT = QQ_GLOBAL.STATION_CNT + 1;
      178     3444
      179     3445    1           VLP_CGSTAL.LIST.NAME#(0) = STATION;
      180     3446    1           VLP_CGSTAL.LIST.PRIO#(0) = TP$STATION.DFLT_PRIO;
      181     3447    1           IF TP$STATION.DFLT_PRIO > 1 THEN
      182     3448    2             DO;
      183     3449    2               CALL M$CGCTL(FPT_CGCTL) ALTRET(MON_ERR);
      184     3450    2             END;
      185     3451    1           ELSE
      186     3452    2             DO;
      187     3453    2               CALL M$CGINFO(FPT_CGINFO) ALTRET(CGINFO_ERR);
      188     3454    2             END;
      189     3455
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:10   
      190     3456    2           DO WHILE('0'B);
      191     3457
      192     3458    2   CGINFO_ERR:
      193     3459    2             IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 1154 /* CGAFNS */ THEN
      194     3460    3               DO;
      195     3461    3                 GOTO MON_ERR;
      196     3462    3               END;
      197     3463    2           END /* NEVER */;
      198     3464
      199     3465    1           TP$STATION.CURR_PRIO  = VLP_CGSTAL.LIST.PRIO#(0);
      200     3466
      201     3467    1           CALL M$ACTIVATE(FPT_ACTIVATE) ALTRET(ACTIVATE_ERR);
      202     3468
      203     3469    2           DO WHILE('0'B);
      204     3470
      205     3471    2   ACTIVATE_ERR:
      206     3472    2             CALL QQC$BLDMSG_ERRBLK(MSGBLK);
      207     3473    2             MSGBLK.ERRINFO.ERR(0) = CODE_UTAS;
      208     3474    2             MSGBLK.ERRINFO.ERR(1) = B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      209     3475    2             MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_STATION);
      210     3476    2             TEXTC_STATION.L# = 8;
      211     3477    2             TEXTC_STATION.NAME# = STATION;
      212     3478    2             CALL QQC$BLDMSG(MSGBLK);
      213     3479    2             IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = 1154 /* E$CGAFNS */ OR
      214     3480    2                 B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = 1095 /* E$FECRASH */ THEN
      215     3481    2               GOTO RET;
      216     3482    2             ELSE
      217     3483    2               GOTO DISCO;
      218     3484    2           END /* NEVER */;
      219     3485
      220     3486    1           IF B$CGAURD.QQ$LOGON.CMDCNT ~= 0 THEN
      221     3487    2             DO;
      222     3488    2               CALL QQC$GET_BLK(QQ_GLOBAL.POOL$, 20, TP$STATION.FIRST_CMD$)
      223     3489    2                   ALTRET(NO_MEM);
      224     3490    2               CHAR_STRING_SIZE = B$CGAURD.QQ$LOGON.CMDCNT;
      225     3491    2               TP$STATION.FIRST_CMD$ -> CMD = ADDR(B$CGAURD.QQ$LOGON.CMD) ->
              3491                        CHAR$STRING;
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:11   
      226     3492    2             END;
      227     3493        /**/
      228     3494        /* Start up the command forms program */
      229     3495        /**/
      230     3496    1           CALL QQA$BYTYPE(S$,QT_FORM,'*DFLT   ',ERR);
      231     3497    1           CALL QQA$SETFP(S$,QT_FORM);
      232     3498    1           GOTO RET;
      233     3499
      234     3500    1   DISCO:
      235     3501    2           CALL M$DEACTIVATE(FPT_ACTIVATE) WHENALTRETURN DO;
      236     3502    2               IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 1154 /* E$CGAFNS */ THEN
      237     3503    3                 DO;
      238     3504    3                   GOTO MON_ERR;
      239     3505    3                 END;
      240     3506    2             END;
      241     3507
      242     3508    1   RET:
      243     3509    1           RETURN;
      244     3510
      245     3511    1   NO_MEM:
      246     3512    1           QQ_GLOBAL.ERR = CODE_NO_POOLMEM;
      247     3513    1           GOTO SCREECH;
      248     3514
      249     3515    1   MON_ERR:
      250     3516    1           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      251     3517
      252     3518    1   SCREECH:
      253     3519    1           CALL QQC$SCREECH;
      254     3520    1   END QQA$STA_CON;

PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:12   
--  Include file information  --

   QT_MACROS_C.:E05TOU  is referenced.
   QQ_PERR_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   QQ_SUBS_C.:E05TOU  is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   QQ_SUPER_C.:E05TOU  is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQA$STA_CON.

   Procedure QQA$STA_CON requires 277 words for executable code.
   Procedure QQA$STA_CON requires 60 words of local(AUTO) storage.

    No errors detected in file QQA$STA_CON.:E05TSI    .

PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:13   

 Object Unit name= QQA$STA_CON                                File name= QQA$STA_CON.:E05TOU
 UTS= JUL 30 '97 05:27:04.80 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$CG
    2   Data  even  none   210    322  QQA$STA_CON
    3  RoData even  UTS      4      4  QQA$STA_CON
    4   Proc  even  none   277    425  QQA$STA_CON
    5  RoData even  none     9     11  QQA$STA_CON

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        0  QQA$STA_CON
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:14   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 QQC$SCREECH
         yes           Std       1 QQC$BLDMSG
         yes           Std       2 QQA$SETFP
 yes     yes           Std       2 QQC$DISAB_CHK
         yes           Std       3 QQC$FINDSTA
         yes           Std       1 QQC$BLDMSG_ERRBLK
 yes     yes           Std       3 QQC$GET_BLK
         yes           Std       3 QQD$SLIDE
 yes     yes           Std       4 QQA$BYTYPE
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  QQ_GLOBAL                             QQ_TP$STATION_INIT
     B$TCB$                                M$CG                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:15   


        1        1        /*M* QQA$STA_CON - Process station connect events */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        /*P* NAME:        QQA$STA_CON
        9        9
       10       10             PURPOSE:     To process *AUEV messages heralding the arrival
       11       11                          of a new TP station.
       12       12        */
       13       13        /*D* NAME:        QQA$STA_CON
       14       14
       15       15             CALL:        CALL QQA$STA_CON
       16       16
       17       17             INPUT:       The contents of the *AUEV connect message
       18       18
       19       19             OUTPUT:      None
       20       20
       21       21             DESCRIPTION: This routine connects TP stations to the instance
       22       22                          of TP.  A position is found for the new station's
       23       23                          context and if necessary a page of a data
       24       24                          segment is obtained to make room for the new
       25       25                          station.  If the station has a priority that
       26       26                          is > 1 then we use a M$CGCTL to tell the
       27       27                          comgroup about this station's priority.
       28       28
       29       29                          The first command (if there is one) can not
       30       30                          be executed for the station at this time.
       31       31                          To execute the first command we must first
       32       32                          wait for the command forms program to be
       33       33                          loaded.  The first command will be saved until
       34       34                          we receive the *IAMRDY message.
       35       35
       36       36                          The default command forms program is started.
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:16   
       37       37        */
       38       38        %EJECT;
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:17   
       39       39        QQA$STA_CON:
       40       40                PROC;

     40  4 000000   000000 700200 xent  QQA$STA_CON  TSX0  ! X66_AUTO_0
         4 000001   000074 000000                    ZERO    60,0

       41       41
       42       42        %INCLUDE Q_PAGE_C;
       43       74        %SET LISTEXP = '1'B;
       44       75        %PAGE(ARG="Includes");

                92        /***************************************************************************
                93         *                                                                         *
                94         *                                  Includes                               *
                95         *                                                                         *
                96         ***************************************************************************/

       45      100        %INCLUDE QQ_SUPER_C;
       46      155        %INCLUDE QQ_MACROS_C;
       47      580        %INCLUDE QQ_SUBS_C;
       48      772        %INCLUDE CP_6;
       49      853        %INCLUDE B_ERRORS_C;
       50     1980        %INCLUDE QQ_DATA_R;
       51     2226        %INCLUDE Q_ERRCODE_C;
       52     2249        %INCLUDE QQ_PERR_C;
       53     2410        %INCLUDE QT_MACROS_C;
       54     2568        %PAGE(ARG="Externally defined routines");

              2585    1   /***************************************************************************
              2586    1    *                                                                         *
              2587    1    *                        Externally defined routines                      *
              2588    1    *                                                                         *
              2589    1    ***************************************************************************/

       55     2593    1   DCL QQA$BYTYPE ENTRY(4) ALTRET;
       56     2594    1   DCL QQA$SETFP ENTRY(2);
       57     2595    1   DCL QQC$FINDSTA ENTRY(3);
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:18   
       58     2596    1   DCL QQC$SCREECH ENTRY;
       59     2597    1   DCL QQC$DISAB_CHK ENTRY(2) ALTRET;
       60     2598    1   DCL QQC$GET_BLK ENTRY(3) ALTRET;
       61     2599    1   DCL QQD$SLIDE ENTRY(3);
       62     2600    1   DCL QQC$BLDMSG ENTRY(1);
       63     2601    1   DCL QQC$BLDMSG_ERRBLK ENTRY(1);
       64     2602    1   DCL QQC$BLDMSG_BLK ENTRY(1);
       65     2603        %PAGE(ARG="Symrefs");

              2620    1   /***************************************************************************
              2621    1    *                                                                         *
              2622    1    *                                  Symrefs                                *
              2623    1    *                                                                         *
              2624    1    ***************************************************************************/

       66     2628    1   DCL B$TCB$ PTR SYMREF;
       67     2629        %PAGE(ARG="DCBs");

              2646    1   /***************************************************************************
              2647    1    *                                                                         *
              2648    1    *                                    DCBs                                 *
              2649    1    *                                                                         *
              2650    1    ***************************************************************************/

       68     2654    1   DCL M$CG DCB;
       69     2655        %PAGE(ARG="Based");

              2672    1   /***************************************************************************
              2673    1    *                                                                         *
              2674    1    *                                   Based                                 *
              2675    1    *                                                                         *
              2676    1    ***************************************************************************/

       70     2680        %B$TCB;
       71     2683        %B$ALT;
       72     2691        %B$CGAURD(STCLASS="BASED(QQ_GLOBAL.CMDBUF$)", LAST=", ");
       73     2710        %B$CGAUCI(LVL=2, LAST=", ");
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:19   
       74     2732        %QQ$LOGON(LVL=2);
       75     2768        %TP$STATION;
       76     2841
       77     2842    1   DCL CMD CHAR(80) BASED;
       78     2843
       79     2844    1   DCL CHAR$STRING CHAR(CHAR_STRING_SIZE) BASED;
       80     2845        %PAGE(ARG="Static");

              2862    1   /***************************************************************************
              2863    1    *                                                                         *
              2864    1    *                                   Static                                *
              2865    1    *                                                                         *
              2866    1    ***************************************************************************/

       81     2870    1   DCL UTS UBIN WORD STATIC;
       82     2871
       83     2872    1   DCL STATION CHAR(8) STATIC;
       84     2873    1   DCL REPLY_BUF CHAR(80) STATIC;
       85     2874        %PAGE(ARG="Auto");

              2891    1   /***************************************************************************
              2892    1    *                                                                         *
              2893    1    *                                    Auto                                 *
              2894    1    *                                                                         *
              2895    1    ***************************************************************************/

       86     2899    1   DCL P$ PTR;
       87     2900    1   DCL ERR UBIN;
       88     2901    1   DCL FOUND_FLAG BIT(1) ALIGNED;
       89     2902
       90     2903    1   DCL WORDS_TO_MOVE SBIN WORD;
       91     2904    1   DCL CHAR_STRING_SIZE UBIN WORD;
       92     2905
       93     2906        %MSGBLK;
       94     2996        %QT$FORM(FPTN=QT_FORM,STCLASS=AUTO);
       95     3035        %VLP_NAME(FPTN=TEXTC_STATION,STCLASS=AUTO,LEN=8);
       96     3062        %PAGE(ARG="Error codes", PAGE=YES);
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:20   

PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:21   
              3079    1   /***************************************************************************
              3080    1    *                                                                         *
              3081    1    *                                Error codes                              *
              3082    1    *                                                                         *
              3083    1    ***************************************************************************/

       97     3087        %ERRCODE(NAME=CODE_NO_POOLMEM, CODE#=%E$NO_POOLMEM, FCG#=%FCG_QQ, MID#=%MID_A);
       98     3094        %ERRCODE(NAME=CODE_UTAS, CODE#=%E$UTAS, FCG#=%FCG_QQ, MID#=%MID_A);
       99     3101        /*E*       ERROR: QQA-E$UTAS-C
      100     3102                 MESSAGE: Unable to activate station %U1.
      101     3103             DESCRIPTION: For the reason which follows we were unable
      102     3104                          to activate this station.  The station has
      103     3105                          been deactivated.
      104     3106        */
      105     3107        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:22   
              3124    1   /***************************************************************************
              3125    1    *                                                                         *
              3126    1    *                                    FPTs                                 *
              3127    1    *                                                                         *
              3128    1    ***************************************************************************/

      106     3132        %FPT_GDS(RESULTS=VLP_VECTOR, SEGSIZE=1024);
      107     3148
      108     3149        %FPT_ACTIVATE(DCB=M$CG, STATION=STATION, DISCONNECT=YES ,MAKEFPRG=YES);
      109     3172
      110     3173        %FPT_TIME(SOURCE=CLOCK, TSTAMP=UTS);
      111     3192
      112     3193        %FPT_CGCTL(DCB=M$CG, STAFC=ADD, STALIST=VLP_CGSTAL);
      113     3216
      114     3217        %FPT_CGINFO(DCB=M$CG, STALIST=VLP_CGSTAL);
      115     3237        %VLP_FPRG;
      116     3258        %FPT_SETFP(DCB=M$CG, FPRG=VLP_FPRG, STATION=VLP_STATION);
      117     3271        %PAGE(ARG="VLPs");

              3288    1   /***************************************************************************
              3289    1    *                                                                         *
              3290    1    *                                    VLPs                                 *
              3291    1    *                                                                         *
              3292    1    ***************************************************************************/

      118     3296        %VLP_VECTOR;
      119     3311        %VLP_CGSTAL;
      120     3336        %VLP_STATION;
      121     3363        %PAGE(ARG="QQA$STA_CON", PAGE=YES);

PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:23   
              3380    1   /***************************************************************************
              3381    1    *                                                                         *
              3382    1    *                                QQA$STA_CON                              *
              3383    1    *                                                                         *
              3384    1    ***************************************************************************/

      122     3388                                      /*  Fill in Command Forms Program VLP_FPRG info */
      123     3389    1           VLP_FPRG.PSN#  = QQ_GLOBAL.CFP_RU.PSN;

   3389  4 000002   040000 100400                    MLR     fill='040'O
         4 000003   000373 000006 xsym               ADSC9   QQ_GLOBAL+251            cn=0,n=6
         4 000004   000240 400006 2                  ADSC9   VLP_FPRG                 cn=2,n=6

      124     3390    1           VLP_FPRG.NAME  = QQ_GLOBAL.CFP_RU.NAME;

   3390  4 000005   000000 100400                    MLR     fill='000'O
         4 000006   000357 000040 xsym               ADSC9   QQ_GLOBAL+239            cn=0,n=32
         4 000007   000242 000040 2                  ADSC9   VLP_FPRG+2               cn=0,n=32

      125     3391    1           VLP_FPRG.ACCT# = QQ_GLOBAL.CFP_RU.ACCT;

   3391  4 000010   040000 100400                    MLR     fill='040'O
         4 000011   000367 000010 xsym               ADSC9   QQ_GLOBAL+247            cn=0,n=8
         4 000012   000252 000010 2                  ADSC9   VLP_FPRG+10              cn=0,n=8

      126     3392    1           VLP_FPRG.PASS# = QQ_GLOBAL.CFP_RU.PASS;

   3392  4 000013   040000 100400                    MLR     fill='040'O
         4 000014   000371 000010 xsym               ADSC9   QQ_GLOBAL+249            cn=0,n=8
         4 000015   000254 000010 2                  ADSC9   VLP_FPRG+12              cn=0,n=8

      127     3393    1           STATION = B$CGAURD.STATION;

   3393  4 000016   000052 470400 xsym               LDP0    QQ_GLOBAL+42
         4 000017   040000 100500                    MLR     fill='040'O
         4 000020   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         4 000021   000001 000010 2                  ADSC9   STATION                  cn=0,n=8
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:24   

      128     3394
      129     3395                                      /* If we are stopping TP don't disconnect cuz   */
      130     3396                                      /* auto logon stations will only just connect   */
      131     3397                                                /* again after u disconnect them      */
      132     3398    1           IF QQ_GLOBAL.TERMINATE THEN

   3398  4 000022   000015 234000 xsym               SZN     QQ_GLOBAL+13
         4 000023   000025 605000 4                  TPL     s:3403

      133     3399    2             DO;

      134     3400    2               GOTO RET;

   3400  4 000024   000411 710000 4                  TRA     RET

      135     3401    2             END;
      136     3402
      137     3403    1           IF QQ_GLOBAL.STATION_CNT >= QQ_GLOBAL.STATIONMAX THEN

   3403  4 000025   000032 236000 xsym               LDQ     QQ_GLOBAL+26
         4 000026   000027 116000 xsym               CMPQ    QQ_GLOBAL+23
         4 000027   000044 602000 4                  TNC     s:3411

      138     3404    2             DO;

      139     3405    2               VLP_STATION.STATION# = STATION;

   3405  4 000030   040000 100400                    MLR     fill='040'O
         4 000031   000001 000010 2                  ADSC9   STATION                  cn=0,n=8
         4 000032   000312 000010 2                  ADSC9   VLP_STATION              cn=0,n=8

      140     3406    2               CALL M$ACTIVATE(FPT_ACTIVATE) ALTRET(ACTIVATE_ERR);

   3406  4 000033   000036 630400 2                  EPPR0   FPT_ACTIVATE
         4 000034   500000 713400                    CLIMB   alt,+32768
         4 000035   401400 401760                    pmme    nvectors=4
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:25   
         4 000036   000252 702000 4                  TSX2    ACTIVATE_ERR

      141     3407    2               CALL M$SETFP(FPT_SETFP) ALTRET(DISCO);

   3407  4 000037   000262 630400 2                  EPPR0   FPT_SETFP
         4 000040   560021 713400                    CLIMB   alt,+57361
         4 000041   401400 401760                    pmme    nvectors=4
         4 000042   000375 702000 4                  TSX2    DISCO

      142     3408    2               RETURN;

   3408  4 000043   000000 702200 xent               TSX2  ! X66_ARET

      143     3409    2             END;
      144     3410
      145     3411    1           IF NOT B$CGAURD.QQ$LOGON.MCT THEN

   3411  4 000044   000015 234100                    SZN     13,,PR0
         4 000045   000052 604000 4                  TMI     s:3416

      146     3412    2             DO;

      147     3413    2               CALL QQC$DISAB_CHK(STATION, 1 /* OPT_STATION */) ALTRET(DISCO);

   3413  4 000046   000000 630400 5                  EPPR0   0
         4 000047   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000050   000000 701000 xent               TSX1    QQC$DISAB_CHK
         4 000051   000375 702000 4                  TSX2    DISCO

      148     3414    2             END;

      149     3415
      150     3416    1           IF QQ_GLOBAL.STATIONSLOTS = 0 THEN

   3416  4 000052   000044 235000 xsym               LDA     QQ_GLOBAL+36
         4 000053   000064 601000 4                  TNZ     s:3423

PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:26   
      151     3417    2             DO;

      152     3418    2               VLP_VECTOR.PTR$ = QQ_GLOBAL.STATION$;

   3418  4 000054   000151 236000 xsym               LDQ     QQ_GLOBAL+105
         4 000055   000277 756000 2                  STQ     VLP_VECTOR+1

      153     3419    2               CALL M$GDS(FPT_GDS) ALTRET(MON_ERR);

   3419  4 000056   000030 630400 2                  EPPR0   FPT_GDS
         4 000057   430001 713400                    CLIMB   alt,gds
         4 000060   400400 401760                    pmme    nvectors=2
         4 000061   000415 702000 4                  TSX2    MON_ERR

      154     3420    2               QQ_GLOBAL.STATIONSLOTS = 1024 / SIZEW(TP$STATION);

   3420  4 000062   000047 235007                    LDA     39,DL
         4 000063   000044 755000 xsym               STA     QQ_GLOBAL+36

      155     3421    2             END;

      156     3422
      157     3423    1           CALL QQC$FINDSTA(B$CGAURD.STATION, S$, FOUND_FLAG);

   3423  4 000064   200006 630500                    EPPR0   FOUND_FLAG,,AUTO
         4 000065   200072 450500                    STP0    TEXTC_STATION+5,,AUTO
         4 000066   200003 631500                    EPPR1   S$,,AUTO
         4 000067   200071 451500                    STP1    TEXTC_STATION+4,,AUTO
         4 000070   000052 236000 xsym               LDQ     QQ_GLOBAL+42
         4 000071   000001 036003                    ADLQ    1,DU
         4 000072   200070 756100                    STQ     TEXTC_STATION+3,,AUTO
         4 000073   200070 630500                    EPPR0   TEXTC_STATION+3,,AUTO
         4 000074   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000075   000000 701000 xent               TSX1    QQC$FINDSTA
         4 000076   000000 011000                    NOP     0

      158     3424
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:27   
      159     3425    1           P$ = PINCRW(QQ_GLOBAL.STATION$, QQ_GLOBAL.STATION_CNT * SIZEW(TP$STATION));

   3425  4 000077   000032 236000 xsym               LDQ     QQ_GLOBAL+26
         4 000100   000032 402003                    MPY     26,DU
         4 000101   000151 036000 xsym               ADLQ    QQ_GLOBAL+105
         4 000102   200004 756100                    STQ     P$,,AUTO

      160     3426    1           WORDS_TO_MOVE = POFFW(P$, S$);

   3426  4 000103   200003 235100                    LDA     S$,,AUTO
         4 000104   000022 771000                    ARL     18
         4 000105   200070 755100                    STA     TEXTC_STATION+3,,AUTO
         4 000106   200004 236100                    LDQ     P$,,AUTO
         4 000107   000022 772000                    QRL     18
         4 000110   200070 136100                    SBLQ    TEXTC_STATION+3,,AUTO
         4 000111   200007 756100                    STQ     WORDS_TO_MOVE,,AUTO

      161     3427
      162     3428    1           CALL QQD$SLIDE(S$, SIZEW(TP$STATION), WORDS_TO_MOVE);

   3428  4 000112   200007 630500                    EPPR0   WORDS_TO_MOVE,,AUTO
         4 000113   200072 450500                    STP0    TEXTC_STATION+5,,AUTO
         4 000114   000003 236000 5                  LDQ     3
         4 000115   200071 756100                    STQ     TEXTC_STATION+4,,AUTO
         4 000116   200003 631500                    EPPR1   S$,,AUTO
         4 000117   200070 451500                    STP1    TEXTC_STATION+3,,AUTO
         4 000120   200070 630500                    EPPR0   TEXTC_STATION+3,,AUTO
         4 000121   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000122   000000 701000 xent               TSX1    QQD$SLIDE
         4 000123   000000 011000                    NOP     0

      163     3429
      164     3430    1           TP$STATION = QQ_TP$STATION_INIT;

   3430  4 000124   200003 470500                    LDP0    S$,,AUTO
         4 000125   000100 100400                    MLR     fill='000'O
         4 000126   000000 000145 xsym               ADSC9   QQ_TP$STATION_INIT       cn=0,n=101
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:28   
         4 000127   000000 000145                    ADSC9   0,,PR0                   cn=0,n=101

      165     3431    1           CALL M$TIME(FPT_TIME);

   3431  4 000130   000056 630400 2                  EPPR0   FPT_TIME
         4 000131   020004 713400                    CLIMB   8196
         4 000132   402000 401760                    pmme    nvectors=5

      166     3432    1           TP$STATION.LOGON_UTS = UTS;

   3432  4 000133   200003 470500                    LDP0    S$,,AUTO
         4 000134   000000 235000 2                  LDA     UTS
         4 000135   000010 755100                    STA     8,,PR0

      167     3433    1           TP$STATION.ID = B$CGAURD.STATION;

   3433  4 000136   000052 471400 xsym               LDP1    QQ_GLOBAL+42
         4 000137   040100 100500                    MLR     fill='040'O
         4 000140   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         4 000141   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8

      168     3434                                                /*  Get :HLP key from B$CGAUCI        */
      169     3435    1           TP$STATION.WHO.ACCT = B$CGAURD.B$CGAUCI.WHO.ACCT;

   3435  4 000142   000052 470400 xsym               LDP0    QQ_GLOBAL+42
         4 000143   200003 471500                    LDP1    S$,,AUTO
         4 000144   040100 100500                    MLR     fill='040'O
         4 000145   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         4 000146   100011 000010                    ADSC9   9,,PR1                   cn=0,n=8

      170     3436    1           TP$STATION.WHO.NAME = B$CGAURD.B$CGAUCI.WHO.NAME;

   3436  4 000147   000052 470400 xsym               LDP0    QQ_GLOBAL+42
         4 000150   040100 100500                    MLR     fill='040'O
         4 000151   000011 000010                    ADSC9   9,,PR0                   cn=0,n=8
         4 000152   100013 000010                    ADSC9   11,,PR1                  cn=0,n=8

PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:29   
      171     3437
      172     3438    1           TP$STATION.FLAGS.MCT = B$CGAURD.QQ$LOGON.MCT;

   3438  4 000153   000052 470400 xsym               LDP0    QQ_GLOBAL+42
         4 000154   000015 236100                    LDQ     13,,PR0
         4 000155   000001 772000                    QRL     1
         4 000156   100022 676100                    ERQ     18,,PR1
         4 000157   200000 376003                    ANQ     65536,DU
         4 000160   100022 656100                    ERSQ    18,,PR1

      173     3439    1           TP$STATION.FLAGS.PRIV = B$CGAURD.QQ$LOGON.MCTCMD;

   3439  4 000161   000052 470400 xsym               LDP0    QQ_GLOBAL+42
         4 000162   000015 236100                    LDQ     13,,PR0
         4 000163   000001 736000                    QLS     1
         4 000164   100022 676100                    ERQ     18,,PR1
         4 000165   400000 376003                    ANQ     -131072,DU
         4 000166   100022 656100                    ERSQ    18,,PR1

      174     3440    1           TP$STATION.FLAGS.ASSIST = B$CGAURD.QQ$LOGON.RAS;

   3440  4 000167   000052 470400 xsym               LDP0    QQ_GLOBAL+42
         4 000170   000015 236100                    LDQ     13,,PR0
         4 000171   000030 736000                    QLS     24
         4 000172   100022 676100                    ERQ     18,,PR1
         4 000173   040000 376003                    ANQ     16384,DU
         4 000174   100022 656100                    ERSQ    18,,PR1

      175     3441    1           TP$STATION.DFLT_PRIO = B$CGAURD.QQ$LOGON.PRIO;

   3441  4 000175   000052 470400 xsym               LDP0    QQ_GLOBAL+42
         4 000176   000015 236100                    LDQ     13,,PR0
         4 000177   000011 772000                    QRL     9
         4 000200   100023 552104                    STBQ    19,'04'O,PR1

      176     3442    1           QQ_GLOBAL.STATIONSLOTS = QQ_GLOBAL.STATIONSLOTS - 1;

PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:30   
   3442  4 000201   000044 235000 xsym               LDA     QQ_GLOBAL+36
         4 000202   000001 135007                    SBLA    1,DL
         4 000203   000044 755000 xsym               STA     QQ_GLOBAL+36

      177     3443    1           QQ_GLOBAL.STATION_CNT = QQ_GLOBAL.STATION_CNT + 1;

   3443  4 000204   000032 236000 xsym               LDQ     QQ_GLOBAL+26
         4 000205   000001 036007                    ADLQ    1,DL
         4 000206   000032 756000 xsym               STQ     QQ_GLOBAL+26

      178     3444
      179     3445    1           VLP_CGSTAL.LIST.NAME#(0) = STATION;

   3445  4 000207   040000 100400                    MLR     fill='040'O
         4 000210   000001 000010 2                  ADSC9   STATION                  cn=0,n=8
         4 000211   000301 000010 2                  ADSC9   VLP_CGSTAL+1             cn=0,n=8

      180     3446    1           VLP_CGSTAL.LIST.PRIO#(0) = TP$STATION.DFLT_PRIO;

   3446  4 000212   100023 236100                    LDQ     19,,PR1
         4 000213   000033 736000                    QLS     27
         4 000214   000303 552040 2                  STBQ    VLP_CGSTAL+3,'40'O

      181     3447    1           IF TP$STATION.DFLT_PRIO > 1 THEN

   3447  4 000215   100023 236100                    LDQ     19,,PR1
         4 000216   000777 376007                    ANQ     511,DL
         4 000217   000002 116007                    CMPQ    2,DL
         4 000220   000226 602000 4                  TNC     s:3453

      182     3448    2             DO;

      183     3449    2               CALL M$CGCTL(FPT_CGCTL) ALTRET(MON_ERR);

   3449  4 000221   000072 630400 2                  EPPR0   FPT_CGCTL
         4 000222   500003 713400                    CLIMB   alt,+32771
         4 000223   411400 401760                    pmme    nvectors=20
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:31   
         4 000224   000415 702000 4                  TSX2    MON_ERR

      184     3450    2             END;

   3450  4 000225   000232 710000 4                  TRA     s:3456

      185     3451    1           ELSE
      186     3452    2             DO;

      187     3453    2               CALL M$CGINFO(FPT_CGINFO) ALTRET(CGINFO_ERR);

   3453  4 000226   000156 630400 2                  EPPR0   FPT_CGINFO
         4 000227   500004 713400                    CLIMB   alt,+32772
         4 000230   411400 401760                    pmme    nvectors=20
         4 000231   000233 702000 4                  TSX2    CGINFO_ERR

      188     3454    2             END;

      189     3455
      190     3456    2           DO WHILE('0'B);

   3456  4 000232   000242 710000 4                  TRA     s:3465

      191     3457
      192     3458    2   CGINFO_ERR:
      193     3459    2             IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 1154 /* CGAFNS */ THEN

   3459  4 000233   000000 470400 xsym  CGINFO_ERR   LDP0    B$TCB$
         4 000234   000000 471500                    LDP1    0,,PR0
         4 000235   100102 236100                    LDQ     66,,PR1
         4 000236   377770 376007                    ANQ     131064,DL
         4 000237   022020 116007                    CMPQ    9232,DL
         4 000240   000242 600000 4                  TZE     s:3465

      194     3460    3               DO;

      195     3461    3                 GOTO MON_ERR;
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:32   

   3461  4 000241   000415 710000 4                  TRA     MON_ERR

      196     3462    3               END;
      197     3463    2           END /* NEVER */;

      198     3464
      199     3465    1           TP$STATION.CURR_PRIO  = VLP_CGSTAL.LIST.PRIO#(0);

   3465  4 000242   200003 470500                    LDP0    S$,,AUTO
         4 000243   000303 236000 2                  LDQ     VLP_CGSTAL+3
         4 000244   000024 552140                    STBQ    20,'40'O,PR0

      200     3466
      201     3467    1           CALL M$ACTIVATE(FPT_ACTIVATE) ALTRET(ACTIVATE_ERR);

   3467  4 000245   000036 630400 2                  EPPR0   FPT_ACTIVATE
         4 000246   500000 713400                    CLIMB   alt,+32768
         4 000247   401400 401760                    pmme    nvectors=4
         4 000250   000252 702000 4                  TSX2    ACTIVATE_ERR

      202     3468
      203     3469    2           DO WHILE('0'B);

   3469  4 000251   000323 710000 4                  TRA     s:3486

      204     3470
      205     3471    2   ACTIVATE_ERR:
      206     3472    2             CALL QQC$BLDMSG_ERRBLK(MSGBLK);

   3472  4 000252   200011 630500       ACTIVATE_ERR EPPR0   MSGBLK,,AUTO
         4 000253   200070 450500                    STP0    TEXTC_STATION+3,,AUTO
         4 000254   200070 630500                    EPPR0   TEXTC_STATION+3,,AUTO
         4 000255   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000256   000000 701000 xent               TSX1    QQC$BLDMSG_ERRBLK
         4 000257   000000 011000                    NOP     0

PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:33   
      207     3473    2             MSGBLK.ERRINFO.ERR(0) = CODE_UTAS;

   3473  4 000260   000001 236000 3                  LDQ     CODE_UTAS
         4 000261   200017 756100                    STQ     MSGBLK+6,,AUTO

      208     3474    2             MSGBLK.ERRINFO.ERR(1) = B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   3474  4 000262   000000 470400 xsym               LDP0    B$TCB$
         4 000263   000000 471500                    LDP1    0,,PR0
         4 000264   000100 100500                    MLR     fill='000'O
         4 000265   100102 000004                    ADSC9   66,,PR1                  cn=0,n=4
         4 000266   200026 200004                    ADSC9   MSGBLK+13,,AUTO          cn=1,n=4

      209     3475    2             MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_STATION);

   3475  4 000267   000004 235000 5                  LDA     4
         4 000270   200070 452500                    STP2    TEXTC_STATION+3,,AUTO
         4 000271   200070 236100                    LDQ     TEXTC_STATION+3,,AUTO
         4 000272   000065 036003                    ADLQ    53,DU
         4 000273   200072 757100                    STAQ    TEXTC_STATION+5,,AUTO
         4 000274   000100 100500                    MLR     fill='000'O
         4 000275   200072 000010                    ADSC9   TEXTC_STATION+5,,AUTO    cn=0,n=8
         4 000276   200020 200010                    ADSC9   MSGBLK+7,,AUTO           cn=1,n=8

      210     3476    2             TEXTC_STATION.L# = 8;

   3476  4 000277   010000 236003                    LDQ     4096,DU
         4 000300   200065 552140                    STBQ    TEXTC_STATION,'40'O,AUTO

      211     3477    2             TEXTC_STATION.NAME# = STATION;

   3477  4 000301   040100 100400                    MLR     fill='040'O
         4 000302   000001 000010 2                  ADSC9   STATION                  cn=0,n=8
         4 000303   200065 200010                    ADSC9   TEXTC_STATION,,AUTO      cn=1,n=8

      212     3478    2             CALL QQC$BLDMSG(MSGBLK);

PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:34   
   3478  4 000304   200011 631500                    EPPR1   MSGBLK,,AUTO
         4 000305   200070 451500                    STP1    TEXTC_STATION+3,,AUTO
         4 000306   200070 630500                    EPPR0   TEXTC_STATION+3,,AUTO
         4 000307   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000310   000000 701000 xent               TSX1    QQC$BLDMSG
         4 000311   000000 011000                    NOP     0

      213     3479    2             IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = 1154 /* E$CGAFNS */ OR

   3479  4 000312   000000 470400 xsym               LDP0    B$TCB$
         4 000313   000000 471500                    LDP1    0,,PR0
         4 000314   100102 236100                    LDQ     66,,PR1
         4 000315   377770 376007                    ANQ     131064,DL
         4 000316   022020 116007                    CMPQ    9232,DL
         4 000317   000411 600000 4                  TZE     RET
         4 000320   021070 116007                    CMPQ    8760,DL
         4 000321   000411 600000 4                  TZE     RET

      214     3480    2                 B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = 1095 /* E$FECRASH */ THEN
      215     3481    2               GOTO RET;
      216     3482    2             ELSE
      217     3483    2               GOTO DISCO;

   3483  4 000322   000375 710000 4                  TRA     DISCO

      218     3484    2           END /* NEVER */;

      219     3485
      220     3486    1           IF B$CGAURD.QQ$LOGON.CMDCNT ~= 0 THEN

   3486  4 000323   000052 470400 xsym               LDP0    QQ_GLOBAL+42
         4 000324   000026 235100                    LDA     22,,PR0
         4 000325   000350 600000 4                  TZE     s:3496

      221     3487    2             DO;

      222     3488    2               CALL QQC$GET_BLK(QQ_GLOBAL.POOL$, 20, TP$STATION.FIRST_CMD$)
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:35   

   3488  4 000326   200003 236100                    LDQ     S$,,AUTO
         4 000327   000016 036003                    ADLQ    14,DU
         4 000330   200072 756100                    STQ     TEXTC_STATION+5,,AUTO
         4 000331   000006 237000 5                  LDAQ    6
         4 000332   200070 757100                    STAQ    TEXTC_STATION+3,,AUTO
         4 000333   200070 630500                    EPPR0   TEXTC_STATION+3,,AUTO
         4 000334   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000335   000000 701000 xent               TSX1    QQC$GET_BLK
         4 000336   000412 702000 4                  TSX2    NO_MEM

      223     3489    2                   ALTRET(NO_MEM);
      224     3490    2               CHAR_STRING_SIZE = B$CGAURD.QQ$LOGON.CMDCNT;

   3490  4 000337   000052 470400 xsym               LDP0    QQ_GLOBAL+42
         4 000340   000026 235100                    LDA     22,,PR0
         4 000341   200010 755100                    STA     CHAR_STRING_SIZE,,AUTO

      225     3491    2               TP$STATION.FIRST_CMD$ -> CMD = ADDR(B$CGAURD.QQ$LOGON.CMD) ->
              3491                        CHAR$STRING;

   3491  4 000342   200003 471500                    LDP1    S$,,AUTO
         4 000343   100016 473500                    LDP3    14,,PR1
         4 000344   000000 620005                    EAX0    0,AL
         4 000345   040100 100540                    MLR     fill='040'O
         4 000346   000027 000010                    ADSC9   23,,PR0                  cn=0,n=*X0
         4 000347   300000 000120                    ADSC9   0,,PR3                   cn=0,n=80

      226     3492    2             END;

      227     3493        /**/
      228     3494        /* Start up the command forms program */
      229     3495        /**/
      230     3496    1           CALL QQA$BYTYPE(S$,QT_FORM,'*DFLT   ',ERR);

   3496  4 000350   200005 630500                    EPPR0   ERR,,AUTO
         4 000351   200073 450500                    STP0    TEXTC_STATION+6,,AUTO
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:36   
         4 000352   000010 236000 5                  LDQ     8
         4 000353   200072 756100                    STQ     TEXTC_STATION+5,,AUTO
         4 000354   200036 631500                    EPPR1   QT_FORM,,AUTO
         4 000355   200071 451500                    STP1    TEXTC_STATION+4,,AUTO
         4 000356   200003 633500                    EPPR3   S$,,AUTO
         4 000357   200070 453500                    STP3    TEXTC_STATION+3,,AUTO
         4 000360   200070 630500                    EPPR0   TEXTC_STATION+3,,AUTO
         4 000361   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000362   000000 701000 xent               TSX1    QQA$BYTYPE
         4 000363   000000 011000                    NOP     0

      231     3497    1           CALL QQA$SETFP(S$,QT_FORM);

   3497  4 000364   200036 630500                    EPPR0   QT_FORM,,AUTO
         4 000365   200071 450500                    STP0    TEXTC_STATION+4,,AUTO
         4 000366   200003 631500                    EPPR1   S$,,AUTO
         4 000367   200070 451500                    STP1    TEXTC_STATION+3,,AUTO
         4 000370   200070 630500                    EPPR0   TEXTC_STATION+3,,AUTO
         4 000371   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000372   000000 701000 xent               TSX1    QQA$SETFP
         4 000373   000000 011000                    NOP     0

      232     3498    1           GOTO RET;

   3498  4 000374   000411 710000 4                  TRA     RET

      233     3499
      234     3500    1   DISCO:
      235     3501    2           CALL M$DEACTIVATE(FPT_ACTIVATE) WHENALTRETURN DO;

   3501  4 000375   000036 630400 2     DISCO        EPPR0   FPT_ACTIVATE
         4 000376   500001 713400                    CLIMB   alt,+32769
         4 000377   401400 401760                    pmme    nvectors=4
         4 000400   000402 702000 4                  TSX2    s:3502
         4 000401   000411 710000 4                  TRA     RET

      236     3502    2               IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 1154 /* E$CGAFNS */ THEN
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:37   

   3502  4 000402   000000 470400 xsym               LDP0    B$TCB$
         4 000403   000000 471500                    LDP1    0,,PR0
         4 000404   100102 236100                    LDQ     66,,PR1
         4 000405   377770 376007                    ANQ     131064,DL
         4 000406   022020 116007                    CMPQ    9232,DL
         4 000407   000411 600000 4                  TZE     RET

      237     3503    3                 DO;

      238     3504    3                   GOTO MON_ERR;

   3504  4 000410   000415 710000 4                  TRA     MON_ERR

      239     3505    3                 END;
      240     3506    2             END;
      241     3507
      242     3508    1   RET:
      243     3509    1           RETURN;

   3509  4 000411   000000 702200 xent  RET          TSX2  ! X66_ARET

      244     3510
      245     3511    1   NO_MEM:
      246     3512    1           QQ_GLOBAL.ERR = CODE_NO_POOLMEM;

   3512  4 000412   000000 236000 3     NO_MEM       LDQ     CODE_NO_POOLMEM
         4 000413   000000 756000 xsym               STQ     QQ_GLOBAL

      247     3513    1           GOTO SCREECH;

   3513  4 000414   000421 710000 4                  TRA     SCREECH

      248     3514
      249     3515    1   MON_ERR:
      250     3516    1           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:38   
   3516  4 000415   000000 470400 xsym  MON_ERR      LDP0    B$TCB$
         4 000416   000000 471500                    LDP1    0,,PR0
         4 000417   100102 236100                    LDQ     66,,PR1
         4 000420   000000 756000 xsym               STQ     QQ_GLOBAL

      251     3517
      252     3518    1   SCREECH:
      253     3519    1           CALL QQC$SCREECH;

   3519  4 000421   000002 631400 xsym  SCREECH      EPPR1   B_VECTNIL+2
         4 000422   000000 701000 xent               TSX1    QQC$SCREECH
         4 000423   000000 011000                    NOP     0

      254     3520    1   END QQA$STA_CON;

   3520  4 000424   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:39   
--  Include file information  --

   QT_MACROS_C.:E05TOU  is referenced.
   QQ_PERR_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   QQ_SUBS_C.:E05TOU  is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   QQ_SUPER_C.:E05TOU  is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQA$STA_CON.
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:40   

 **** Variables and constants ****

  ****  Section 002  Data  QQA$STA_CON

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    36-0-0/d STRC(576)   r     1 FPT_ACTIVATE              72-0-0/d STRC(1872)  r     1 FPT_CGCTL
   156-0-0/d STRC(1800)  r     1 FPT_CGINFO                30-0-0/d STRC(216)   r     1 FPT_GDS
   262-0-0/d STRC(432)   r     1 FPT_SETFP                 56-0-0/d STRC(432)   r     1 FPT_TIME
     1-0-0/c CHAR(8)     r     1 STATION                    0-0-0/w UBIN        r     1 UTS
   300-0-0/d STRC(324)   r     1 VLP_CGSTAL               240-0-0/d STRC(612)   r     1 VLP_FPRG
   312-0-0/w STRC(288)   r     1 VLP_STATION              276-0-0/d STRC(72)    r     1 VLP_VECTOR

  ****  Section 003 RoData QQA$STA_CON

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b STRC        r     1 CODE_NO_POOLMEM            1-0-0/b STRC        r     1 CODE_UTAS

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    10-0-0/w UBIN        r     1 CHAR_STRING_SIZE           5-0-0/w UBIN        r     1 ERR
     6-0-0/w BIT         r     1 FOUND_FLAG                11-0-0/w STRC(738)   r     1 MSGBLK
     4-0-0/w PTR         r     1 P$                        36-0-0/w STRC(828)   r     1 QT_FORM
     3-0-0/w PTR         r     1 S$                        65-0-0/c STRC(81)    r     1 TEXTC_STATION
     7-0-0/w SBIN        r     1 WORDS_TO_MOVE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:41   
     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/d STRC(9090)  r     1 QQ_GLOBAL
     0-0-0/w STRC(909)   r     1 QQ_TP$STATION_INIT

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(1548)  r     1 B$CGAURD
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/c ACHR        r     1 CHAR$STRING
     0-0-0/c CHAR(80)    r     1 CMD                        0-0-0N  NULL        r     1 M$CG
     0-0-0/w STRC(909)   r     1 TP$STATION


   Procedure QQA$STA_CON requires 277 words for executable code.
   Procedure QQA$STA_CON requires 60 words of local(AUTO) storage.

    No errors detected in file QQA$STA_CON.:E05TSI    .
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:42   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:43   
          MINI XREF LISTING

ACTIVATE_ERR
      3472**LABEL    3406--CALLALT  3467--CALLALT
B$ALT.CODE
      2685**DCL      2685--REDEF    2686--REDEF    2686--REDEF
B$ALT.ERR
      2686**DCL      3474>>ASSIGN   3516>>ASSIGN
B$ALT.ERR.CODE
      2687**DCL      3459>>IF       3479>>IF       3479>>IF       3502>>IF
B$ALT.ERR.ERR#
      2687**DCL      2687--REDEF
B$ALT.EVID
      2686**DCL      2686--REDEF    2686--REDEF
B$CGAURD.B$CGAUCI.ATTR
      2729**DCL      2729--REDEF
B$CGAURD.B$CGAUCI.WHO.ACCT
      2727**DCL      3435>>ASSIGN
B$CGAURD.B$CGAUCI.WHO.NAME
      2727**DCL      3436>>ASSIGN
B$CGAURD.QQ$LOGON.CMD
      2765**DCL      3491--ASSIGN
B$CGAURD.QQ$LOGON.CMDCNT
      2763**DCL      3486>>IF       3490>>ASSIGN
B$CGAURD.QQ$LOGON.MCT
      2750**DCL      3411>>IF       3438>>ASSIGN
B$CGAURD.QQ$LOGON.MCTCMD
      2752**DCL      3439>>ASSIGN
B$CGAURD.QQ$LOGON.PRIO
      2757**DCL      3441>>ASSIGN
B$CGAURD.QQ$LOGON.RAS
      2759**DCL      3440>>ASSIGN
B$CGAURD.STATION
      2707**DCL      2707--REDEF    3393>>ASSIGN   3423<>CALL     3433>>ASSIGN
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:44   
B$TCB.ALT$
      2681**DCL      3459>>IF       3474>>ASSIGN   3479>>IF       3479>>IF       3502>>IF       3516>>ASSIGN
B$TCB$
      2628**DCL      3459>>IF       3474>>ASSIGN   3479>>IF       3479>>IF       3502>>IF       3516>>ASSIGN
CGINFO_ERR
      3459**LABEL    3453--CALLALT
CHAR$STRING
      2844**DCL      3491>>ASSIGN
CHAR_STRING_SIZE
      2904**DCL      2844--IMP-SIZ  3490<<ASSIGN   3491>>ASSIGN
CMD
      2842**DCL      3491<<ASSIGN
CODE_NO_POOLMEM
      3088**DCL      3512>>ASSIGN
CODE_UTAS
      3095**DCL      3473>>ASSIGN
DISCO
      3501**LABEL    3407--CALLALT  3413--CALLALT  3483--GOTO
ERR
      2900**DCL      3496<>CALL
FOUND_FLAG
      2901**DCL      3423<>CALL
FPT_ACTIVATE
      3160**DCL      3406<>CALL     3467<>CALL     3501<>CALL
FPT_ACTIVATE.V
      3161**DCL      3160--DCLINIT
FPT_ACTIVATE.V.DVBYTE.REREAD#
      3163**DCL      3163--REDEF
FPT_CGCTL
      3204**DCL      3449<>CALL
FPT_CGCTL.V
      3209**DCL      3204--DCLINIT
FPT_CGINFO
      3228**DCL      3453<>CALL
FPT_CGINFO.V
      3233**DCL      3228--DCLINIT
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:45   
FPT_GDS
      3143**DCL      3419<>CALL
FPT_GDS.V
      3143**DCL      3143--DCLINIT
FPT_SETFP
      3267**DCL      3407<>CALL
FPT_SETFP.V
      3268**DCL      3267--DCLINIT
FPT_TIME
      3184**DCL      3431<>CALL
FPT_TIME.V
      3188**DCL      3184--DCLINIT
M$ACTIVATE
       801**DCL-ENT  3406--CALL     3467--CALL
M$CGCTL
       802**DCL-ENT  3449--CALL
M$CGINFO
       802**DCL-ENT  3453--CALL
M$DEACTIVATE
       801**DCL-ENT  3501--CALL
M$GDS
       816**DCL-ENT  3419--CALL
M$SETFP
       810**DCL-ENT  3407--CALL
M$TIME
       848**DCL-ENT  3431--CALL
MON_ERR
      3516**LABEL    3419--CALLALT  3449--CALLALT  3461--GOTO     3504--GOTO
MSGBLK
      2907**DCL      3472<>CALL     3478<>CALL
MSGBLK.ERRINFO.ERR
      2985**DCL      3473<<ASSIGN   3474<<ASSIGN
MSGBLK.ERRINFO.FIELD1
      2989**DCL      3475<<ASSIGN
NO_MEM
      3512**LABEL    3488--CALLALT
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:46   
P$
      2899**DCL      3425<<ASSIGN   3426>>ASSIGN
QQA$BYTYPE
      2593**DCL-ENT  3496--CALL
QQA$SETFP
      2594**DCL-ENT  3497--CALL
QQC$BLDMSG
      2600**DCL-ENT  3478--CALL
QQC$BLDMSG_ERRBLK
      2601**DCL-ENT  3472--CALL
QQC$DISAB_CHK
      2597**DCL-ENT  3413--CALL
QQC$FINDSTA
      2595**DCL-ENT  3423--CALL
QQC$GET_BLK
      2598**DCL-ENT  3488--CALL
QQC$SCREECH
      2596**DCL-ENT  3519--CALL
QQD$SLIDE
      2599**DCL-ENT  3428--CALL
QQ_GLOBAL.CFP_RU.ACCT
      2078**DCL      3391>>ASSIGN
QQ_GLOBAL.CFP_RU.NAME
      2078**DCL      3390>>ASSIGN
QQ_GLOBAL.CFP_RU.PASS
      2078**DCL      3392>>ASSIGN
QQ_GLOBAL.CFP_RU.PSN
      2078**DCL      3389>>ASSIGN
QQ_GLOBAL.CMDBUF$
      1997**DCL      2703--IMP-PTR  3393>>ASSIGN   3411>>IF       3423>>CALL     3433>>ASSIGN   3435>>ASSIGN
      3436>>ASSIGN   3438>>ASSIGN   3439>>ASSIGN   3440>>ASSIGN   3441>>ASSIGN   3486>>IF       3490>>ASSIGN
      3491>>ASSIGN
QQ_GLOBAL.DS1$_BITS
      2000**DCL      2000--REDEF
QQ_GLOBAL.DS2$_BITS
      2000**DCL      2001--REDEF
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:47   
QQ_GLOBAL.DS3$_BITS
      2001**DCL      2001--REDEF
QQ_GLOBAL.DS4$_BITS
      2001**DCL      2002--REDEF
QQ_GLOBAL.ERR
      1990**DCL      3512<<ASSIGN   3516<<ASSIGN
QQ_GLOBAL.POOL$
      2001**DCL      3488<>CALL
QQ_GLOBAL.STATION$
      2001**DCL      3418>>ASSIGN   3425>>ASSIGN
QQ_GLOBAL.STATIONMAX
      1994**DCL      3403>>IF
QQ_GLOBAL.STATIONSLOTS
      1996**DCL      3416>>IF       3420<<ASSIGN   3442<<ASSIGN   3442>>ASSIGN
QQ_GLOBAL.STATION_CNT
      1995**DCL      3403>>IF       3425>>ASSIGN   3443<<ASSIGN   3443>>ASSIGN
QQ_GLOBAL.TERMINATE
      1993**DCL      3398>>IF
QQ_TP$STATION_INIT
      2093**DCL      3430>>ASSIGN
QT_FORM
      3007**DCL      3496<>CALL     3497<>CALL
RET
      3509**LABEL    3400--GOTO     3481--GOTO     3498--GOTO
S$
      2780**DCL      2782--IMP-PTR  3423<>CALL     3426>>ASSIGN   3428<>CALL     3430>>ASSIGN   3432>>ASSIGN
      3433>>ASSIGN   3435>>ASSIGN   3436>>ASSIGN   3438>>ASSIGN   3439>>ASSIGN   3440>>ASSIGN   3441>>ASSIGN
      3446>>ASSIGN   3447>>IF       3465>>ASSIGN   3488>>CALL     3491>>ASSIGN   3496<>CALL     3497<>CALL
SCREECH
      3519**LABEL    3513--GOTO
STATION
      2872**DCL      3160--DCLINIT  3393<<ASSIGN   3405>>ASSIGN   3413<>CALL     3445>>ASSIGN   3477>>ASSIGN
TEXTC_STATION
      3060**DCL      3475--ASSIGN
TEXTC_STATION.L#
      3060**DCL      3476<<ASSIGN
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:48   
TEXTC_STATION.NAME#
      3060**DCL      3477<<ASSIGN
TP$STATION
      2782**DCL      3420--ASSIGN   3425--ASSIGN   3428--CALL     3430<<ASSIGN
TP$STATION.CURR_PRIO
      2836**DCL      3465<<ASSIGN
TP$STATION.DFLT_PRIO
      2834**DCL      3441<<ASSIGN   3446>>ASSIGN   3447>>IF
TP$STATION.FIRST_CMD$
      2800**DCL      3488<>CALL     3491>>ASSIGN
TP$STATION.FLAGS.ASSIST
      2816**DCL      3440<<ASSIGN
TP$STATION.FLAGS.MCT
      2812**DCL      3438<<ASSIGN
TP$STATION.FLAGS.PRIV
      2810**DCL      3439<<ASSIGN
TP$STATION.ID
      2783**DCL      3433<<ASSIGN
TP$STATION.LOGON_UTS
      2791**DCL      3432<<ASSIGN
TP$STATION.WHO.ACCT
      2794**DCL      3435<<ASSIGN
TP$STATION.WHO.NAME
      2796**DCL      3436<<ASSIGN
UTS
      2870**DCL      3188--DCLINIT  3432>>ASSIGN
VLP_CGSTAL
      3329**DCL      3205--DCLINIT  3229--DCLINIT
VLP_CGSTAL.LIST.NAME#
      3329**DCL      3445<<ASSIGN
VLP_CGSTAL.LIST.PRIO#
      3330**DCL      3446<<ASSIGN   3465>>ASSIGN
VLP_FPRG
      3248**DCL      3268--DCLINIT
VLP_FPRG.ACCT#
      3254**DCL      3391<<ASSIGN
PL6.E3A0      #001=QQA$STA_CON File=QQA$STA_CON.:E05TSI                          WED 07/30/97 05:27 Page:49   
VLP_FPRG.NAME
      3253**DCL      3390<<ASSIGN
VLP_FPRG.PASS#
      3255**DCL      3392<<ASSIGN
VLP_FPRG.PSN#
      3253**DCL      3389<<ASSIGN
VLP_STATION
      3348**DCL      3267--DCLINIT
VLP_STATION.MSGIDXT
      3358**DCL      3361--REDEF
VLP_STATION.STATION#
      3352**DCL      3405<<ASSIGN
VLP_VECTOR
      3307**DCL      3143--DCLINIT
VLP_VECTOR.PTR$
      3309**DCL      3418<<ASSIGN
VLP_VECTOR.W2
      3308**DCL      3309--REDEF
WORDS_TO_MOVE
      2903**DCL      3426<<ASSIGN   3428<>CALL
