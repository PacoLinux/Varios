VERSION E05

PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:1    
        1        1        /*M* ASB$FILES:  Processes :USERS, :PROJ, :HLP and :NETCON files
        2        2                         in the :SYS account.                            */
        3        3        /*T***********************************************************/
        4        4        /*T*                                                         */
        5        5        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        6        6        /*T*                                                         */
        7        7        /*T***********************************************************/
        8        8        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        9        9              ECU=3,CSU=3,SDI=3                                           */
       10       10        /*   ASB$FILES:  This module consists of procedures:
       11       11                         ASB$USERS
       12       12                         ASB$PROJ
       13       13                         ASB$HLP
       14       14                         ASB$NETCON                               */
       15       15                                                              /**/
       16       16                                                                                      /**/
       17       17        ASB$USERS: PROC (RW$USERS) ALTRET ;
       18       18        /***********************************************************/
       19       19
       20       20        /*P* NAME:     ASB$USERS
       21       21             PURPOSE:  Manage the :USERS file.
       22       22             DESCRIPTION:
       23       23                ASB$USERS has the following entries:
       24       24
       25       25                  ASB$READ_USERS - reads a record from :USERS file.
       26       26                  ASB$WRITE_USERS - writes a record to the :USERS file.
       27       27                  ASB$WRITE_USERS_KEY - writes a key to the :USERS file.
       28       28                  ASB$DELREC_USERS - deletes a record from the :USERS file.
       29       29                  ASB$PREC_USERS - positions to a record in the :USERS file.
       30       30                  ASB$PREC_AND_SKIP_USERS - postions to a record in the :USERS file
       31       31                                            and then skips to the next record.
       32       32                  ASB$OPEN_USERS_CR - creates the :USERS file.
       33       33                  ASB$OPEN_USERS_UP - opens :USERS as an update file.
       34       34                  ASB$CLOSE_USERS - closes the :USERS file.
       35       35                  ASB$BOF_USERS - positions to beginning of :USERS file.
       36       36                  ASB$ENQ - enqueues a record in the :USERS and :HLP files.
       37       37                  ASB$ENQ_HLP - enqueues a record in the :HLP file.
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:2    
       38       38                  ASB$ENQ_USERS - enqueues a record in the :USERS file.
       39       39                  ASB$DEQ - dequeues the :USERS and :HLP files.
       40       40                  ASB$DEQ_HLP - dequeues the :HLP file.
       41       41                  ASB$DEQ_USERS - dequeues the :USERS file.
       42       42        */
       43       43        /*******************************************************************/
       44       44                                                                                      /**/
       45       45        %EJECT;
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:3    
       46       46        /*********************************************************************/
       47       47        /*   Include files   include files   include files   include files   */
       48       48        /*********************************************************************/
       49       49                                                                                      /**/
       50       50              %INCLUDE AS_ENTRIES_M   ;
       51     1100              %INCLUDE CP_6           ;
       52     1181              %INCLUDE AS_PERR_C      ;
       53     1783              %INCLUDE B_ERRORS_C     ;
       54     2910              %INCLUDE AS_SUPER_C     ;
       55     3345              %INCLUDE AS_SUBS_C      ;
       56     4759              %INCLUDE XU_MACRO_C     ;
       57     7865              %INCLUDE KL_SUPER_C     ;
       58    10767              %INCLUDE XU_FORMAT_C    ;
       59    10929              %INCLUDE AS_MAC_C       ;
       60    11009              %INCLUDE AS_SUPER_R     ;
       61    14025                                                                                      /**/
       62    14026        %EJECT;
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:4    
       63    14027        /*********************************************************************/
       64    14028        /*   Static data     static data     static data     static data     */
       65    14029        /*********************************************************************/
       66    14030                                                                                      /**/
       67    14031    1   DCL 1 FILE_NAME STATIC ,
       68    14032    1          2 COUNT UBIN(9) UNAL INIT(6) ,
       69    14033    1          2 TEXT CHAR(31) UNAL INIT(':USERS') ;
       70    14034        %EJECT;
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:5    
       71    14035        /*********************************************************************/
       72    14036        /*   Local based     local based     local based     local based     */
       73    14037        /*********************************************************************/
       74    14038                                                              /**/
       75    14039              %B$ALT ;
       76    14047              %B$TCB ;
       77    14050        %EJECT ;
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:6    
       78    14051        /*********************************************************************/
       79    14052        /*   Symref's        symref's        symref's        symref's        */
       80    14053        /*********************************************************************/
       81    14054                                                              /**/
       82    14055    1   DCL B$TCB$ PTR SYMREF ;
       83    14056        %EJECT ;
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:7    
       84    14057        /*********************************************************************/
       85    14058        /*   Parameters      parameters      parameters      parameters      */
       86    14059        /*********************************************************************/
       87    14060                                                                                      /**/
       88    14061              %AS_USERS (STR_NAME=RW$USERS, STCLASS=PARAM) ;
       89    14239                                                                                      /**/
       90    14240        %EJECT;
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:8    
       91    14241        /*********************************************************************/
       92    14242        /*   Fpts            fpts            fpts            fpts            */
       93    14243        /*********************************************************************/
       94    14244                                                                                      /**/
       95    14245              %FPT_OPEN (FPTN=OPEN_CR_FPT ,
       96    14246                          NAME = FILE_NAME ,
       97    14247                          ACCT = FILE_ACCT ,
       98    14248                          ASN  = FILE ,
       99    14249                          DCB = M$USERS ,
      100    14250                          ACS = DIRECT ,
      101    14251                          ORG = KEYED ,
      102    14252                          ACSVEH = VLP_ATTR ,
      103    14253                          ACCESS = VLP_ATTR_ACC ,
      104    14254                          FUN = CREATE ,
      105    14255                          IXTNSIZE = 8 ,
      106    14256                          XTNSIZE = 8 ,
      107    14257                          EXIST = OLDFILE) ;
      108    14366              %FPT_OPEN (FPTN=OPEN_UP_FPT ,
      109    14367                          NAME = FILE_NAME ,
      110    14368                          ACCT = FILE_ACCT ,
      111    14369                          ASN  = FILE ,
      112    14370                          DCB = M$USERS ,
      113    14371                          ACS = DIRECT ,
      114    14372                          ORG = KEYED ,
      115    14373                          FUN = UPDATE ,
      116    14374                          SHARE = ALL) ;
      117    14483              %FPT_ENQ  ( FPTN = FPT_ENQ_USERS ,
      118    14484                          DCB = M$USERS ,
      119    14485                          RNAME = USERS_KEY ,
      120    14486                          SHARE = NONE ) ;
      121    14504              %FPT_ENQ  ( FPTN = FPT_ENQ_HLP ,
      122    14505                          DCB = M$HLP ,
      123    14506                          RNAME = USERS_KEY ,
      124    14507                          SHARE = NONE ) ;
      125    14525              %FPT_DEQ  ( FPTN = FPT_DEQ_USERS ,
      126    14526                          DCB = M$USERS ) ;
      127    14543              %FPT_DEQ  ( FPTN = FPT_DEQ_HLP ,
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:9    
      128    14544                          DCB = M$HLP ) ;
      129    14561              %FPT_CLOSE  (FPTN = CLOSE_FPT ,
      130    14562                           DCB = M$USERS ,
      131    14563                           DISP = SAVE) ;
      132    14605              %FPT_READ  (FPTN = READ_FPT ,
      133    14606                          KEY = USERS_KEY ,
      134    14607                          DCB = M$USERS ,
      135    14608                          KEYS = YES) ;
      136    14647              %FPT_WRITE  (FPTN = WRITE_FPT ,
      137    14648                           ONEWKEY = YES ,
      138    14649                           KEY = USERS_KEY ,
      139    14650                           DCB = M$USERS) ;
      140    14681              %FPT_DELREC  (FPTN = DELREC_FPT ,
      141    14682                            KEY = USERS_KEY ,
      142    14683                            DCB = M$USERS) ;
      143    14702              %FPT_PRECORD (FPTN = PREC_FPT,
      144    14703                            DCB = M$USERS,
      145    14704                            KEY = USERS_KEY,
      146    14705                            KEYS = YES,
      147    14706                            KEYR = YES,
      148    14707                            N = 0);
      149    14728              %FPT_PRECORD (FPTN = PREC_AND_SKIP_FPT ,
      150    14729                            DCB = M$USERS,
      151    14730                            KEY = USERS_KEY,
      152    14731                            KEYS = YES,
      153    14732                            KEYR = YES,
      154    14733                            N = 1 ) ;
      155    14754              %FPT_READ    (FPTN = READ_SEQ_FPT ,
      156    14755                            KEY = USERS_KEY ,
      157    14756                            DCB = M$USERS ,
      158    14757                            KEYR = YES ,
      159    14758                            KEYS = NO ) ;
      160    14797              %FPT_PFIL    (FPTN = PFIL_FPT ,
      161    14798                            DCB = M$USERS ,
      162    14799                            BOF = YES ) ;
      163    14814                                                                                      /**/
      164    14815        %EJECT;
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:10   
      165    14816        /*********************************************************************/
      166    14817        /*   Vlps            vlps            vlps            vlps            */
      167    14818        /*********************************************************************/
      168    14819                                                                                      /**/
      169    14820              %VLP_ATTR ;
      170    14834              %VLP_ACSVEH(  UPD = YES ,
      171    14835                            READ = YES ,
      172    14836                            DELR = YES,
      173    14837                            WNEW = YES,
      174    14838                            VEHICLE = 'SUPER' ) ;
      175    14855              %VLP_ACSVEH(  UPD = YES ,
      176    14856                            READ = YES ,
      177    14857                            VEHICLE = 'IBEX' ) ;
      178    14874              %VLP_ACSVEH(  UPD = YES ,
      179    14875                            READ = YES ,
      180    14876                            VEHICLE = 'LOGON' ) ;
      181    14893              %VLP_ACSVEH(  UPD = YES ,
      182    14894                            READ = YES ,
      183    14895                            VEHICLE = 'SLUG' ) ;
      184    14912              %VLP_ACSVEH(  UPD = YES ,
      185    14913                            READ = YES ,
      186    14914                            VEHICLE = 'TPCP' ) ;
      187    14931              %VLP_ACSVEH(  UPD = YES ,
      188    14932                            READ = YES,
      189    14933                            VEHICLE = 'PRESCAN' ,
      190    14934                            LAST=";") ;
      191    14951              %VLP_ATTR(  FPTN = VLP_ATTR_ACC ) ;
      192    14965              %VLP_ACCESS(  EXEC = YES ,
      193    14966                            ACCT = '?' ,
      194    14967                            LAST=";") ;
      195    14984        %EJECT ;
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:11   
      196    14985        /*********************************************************************/
      197    14986        /*   Dcbs            dcbs            dcbs            dcbs            */
      198    14987        /*********************************************************************/
      199    14988                                                                                      /**/
      200    14989    1   DCL M$USERS DCB ;                                    /*  Read-write users record */
      201    14990    1   DCL M$HLP DCB ;                                 /*  Read/write hlp record  */
      202    14991                                                              /**/
      203    14992        %EJECT ;
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:12   
      204    14993        /*********************************************************************/
      205    14994        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
      206    14995        /*********************************************************************/
      207    14996                                                              /**/
      208    14997        %ASH$ERROR ;
      209    15000        %ASB$WRITE_LO;
      210    15003        %EJECT;
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:13   
      211    15004        /********************************************************************/
      212    15005        /*   Procedure       procedure       procedure       procedure       */
      213    15006        /*********************************************************************/
      214    15007                                                              /**/
      215    15008    1   ASB$READ_USERS: ENTRY( RW$USERS )  ALTRET ;
      216    15009                                                              /* Set BUF_ in read fpt */
      217    15010    1   READ_FPT.BUF_ = VECTOR(RW$USERS) ;
      218    15011    1   CALL M$READ (READ_FPT) ALTRET(IO_ERROR) ;
      219    15012    1   RETURN ;
      220    15013                                                                                      /**/
      221    15014    1   ASB$WRITE_USERS_KEY: ENTRY ALTRET ;
      222    15015                                                           /* Set BUF_ in write fpt */
      223    15016    1   WRITE_FPT.BUF_ = VECTOR(NIL) ;
      224    15017    1   GOTO WRITE_RECORD ;
      225    15018
      226    15019    1   ASB$WRITE_USERS: ENTRY ( RW$USERS )  ALTRET ;
      227    15020                                                             /* Set BUF_ in write fpt */
      228    15021    1   WRITE_FPT.BUF_ = VECTOR(RW$USERS) ;
      229    15022    1   WRITE_RECORD:
      230    15023    1   CALL M$WRITE (WRITE_FPT) ALTRET(IO_ERROR) ;
      231    15024    1   RETURN ;
      232    15025                                                                                      /**/
      233    15026    1   ASB$DELREC_USERS: ENTRY    ALTRET;
      234    15027        /** Show the user info before deleting it. **/
      235    15028    1   CALL CONCAT (OUT_BUF,AS_USERS.ACCT,',',AS_USERS.NAME);
      236    15029    1   CALL ASB$WRITE_LO (OUT_BUF, SIZEC(OUT_BUF));
      237    15030    1   CALL M$DELREC (DELREC_FPT) ALTRET(IO_ERROR) ;
      238    15031    1   RETURN ;
      239    15032                                                              /**/
      240    15033    1   ASB$PREC_USERS: ENTRY    ALTRET;
      241    15034    1   CALL M$PRECORD (PREC_FPT) ALTRET(IO_ERROR) ;
      242    15035    1   RETURN ;
      243    15036                                                              /**/
      244    15037    1   ASB$PREC_AND_SKIP_USERS: ENTRY  ALTRET ;
      245    15038    1   CALL M$PRECORD( PREC_AND_SKIP_FPT ) ALTRET( IO_ERROR ) ;
      246    15039    1   RETURN ;
      247    15040                                                              /**/
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:14   
      248    15041    1   ASB$OPEN_USERS_CR: ENTRY    ALTRET;
      249    15042    1   CALL M$OPEN (OPEN_CR_FPT) ALTRET(IO_ERROR) ;
      250    15043    1   RETURN ;
      251    15044                                                              /**/
      252    15045    1   ASB$OPEN_USERS_UP: ENTRY    ALTRET;
      253    15046    1   CALL M$OPEN (OPEN_UP_FPT) ALTRET(IO_ERROR) ;
      254    15047    1   RETURN ;
      255    15048                                                              /**/
      256    15049    1   ASB$CLOSE_USERS: ENTRY    ALTRET;
      257    15050    1   CALL M$CLOSE (CLOSE_FPT) ;
      258    15051    1   RETURN ;
      259    15052                                                              /**/
      260    15053    1   ASB$READ_USERS_SEQ: ENTRY( RW$USERS )  ALTRET ;
      261    15054    1   READ_SEQ_FPT.BUF_ = VECTOR(RW$USERS) ;
      262    15055    1   USERS_KEY.TXTC = AS_BLANK ;
      263    15056    1   CALL M$READ(READ_SEQ_FPT) ALTRET (IO_ERROR) ;
      264    15057    1   RETURN ;
      265    15058                                                              /**/
      266    15059    1   ASB$BOF_USERS: ENTRY     ALTRET;
      267    15060    1   CALL M$PFIL(PFIL_FPT) ALTRET(IO_ERROR) ;
      268    15061    1   RETURN ;
      269    15062                                                              /**/
      270    15063    1   IO_ERROR: ;
      271    15064    1   ERR_CODE = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR ;
      272    15065    1   AS_DCBNUM# = DCBNUM( M$USERS );
      273    15066    1   ALTRETURN ;
      274    15067                                                              /**/
      275    15068    1   ASB$ENQ: ENTRY          ALTRET ;
      276    15069    1   CALL M$ENQ( FPT_ENQ_USERS ) ALTRET( ENQ_ERR1 ) ;
      277    15070    1   ASB$ENQ_HLP: ENTRY          ALTRET ;
      278    15071    1   CALL M$ENQ( FPT_ENQ_HLP ) ALTRET( ENQ_ERR2 ) ;
      279    15072    1   RETURN ;
      280    15073                                                              /**/
      281    15074    1   ASB$ENQ_USERS: ENTRY ALTRET ;
      282    15075    1   CALL M$ENQ( FPT_ENQ_USERS ) ALTRET( ENQ_ERR1 ) ;
      283    15076    1   RETURN ;
      284    15077                                                              /**/
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:15   
      285    15078    1   ENQ_ERR1: ;
      286    15079        /*E*  ERROR:    ASB-E$UNABLE_ENQ_USERS-C
      287    15080              MESSAGE:  Unable to ENQ :USERS.
      288    15081        */
      289    15082        %SCREAM( ERR#=E$UNABLE_ENQ_USERS, LEVEL=ERROR, MID='B' );
      290    15097    1   ALTRETURN ;
      291    15098                                                              /**/
      292    15099    1   ENQ_ERR2: ;
      293    15100        /*E*  ERROR:    ASB-E$UNABLE_ENQ_HLP-C
      294    15101              MESSAGE:  Unable to ENQ :HLP.
      295    15102        */
      296    15103        %SCREAM( ERR#=E$UNABLE_ENQ_HLP, LEVEL=ERROR, MID='B' );
      297    15118    1   CALL M$DEQ( FPT_DEQ_USERS ) ALTRET( DEQ_ERR1 ) ;
      298    15119    1   ALTRETURN ;
      299    15120                                                              /**/
      300    15121    1   ASB$DEQ: ENTRY          ALTRET ;
      301    15122    1   CALL M$DEQ( FPT_DEQ_USERS ) ALTRET( DEQ_ERR1 ) ;
      302    15123    1   ASB$DEQ_HLP: ENTRY          ALTRET ;
      303    15124    1   CALL M$DEQ( FPT_DEQ_HLP ) ALTRET( DEQ_ERR2 ) ;
      304    15125    1   RETURN ;
      305    15126                                                              /**/
      306    15127    1   ASB$DEQ_USERS: ENTRY ALTRET ;
      307    15128    1   CALL M$DEQ( FPT_DEQ_USERS ) ALTRET( DEQ_ERR1 ) ;
      308    15129    1   RETURN ;
      309    15130                                                              /**/
      310    15131    1   DEQ_ERR1: ;
      311    15132        /*E*  ERROR:    ASB-E$UNABLE_DEQ_USERS-C
      312    15133              MESSAGE:  Unable to DEQ :USERS.
      313    15134        */
      314    15135        %SCREAM( ERR#=E$UNABLE_DEQ_USERS, LEVEL=ERROR, MID='B' );
      315    15150    1   CALL M$DEQ( FPT_DEQ_HLP ) ALTRET( DEQ_ERR2 ) ;
      316    15151    1   ALTRETURN ;
      317    15152                                                              /**/
      318    15153    1   DEQ_ERR2: ;
      319    15154        /*E*  ERROR:    ASB-E$UNABLE_DEQ_HLP-C
      320    15155              MESSAGE:  Unable to DEQ :HLP.
      321    15156        */
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:16   
      322    15157        %SCREAM( ERR#=E$UNABLE_DEQ_HLP, LEVEL=ERROR, MID='B' );
      323    15172    1   ALTRETURN ;
      324    15173                                                              /**/
      325    15174                                                              /**/
      326    15175    1   END   ASB$USERS ;
      327    15176        %EOD ;

PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:17   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASB$USERS.

   Procedure ASB$USERS requires 178 words for executable code.
   Procedure ASB$USERS requires 4 words of local(AUTO) storage.

PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:18   

 Object Unit name= ASB$USERS                                  File name= ASB$FILES.:E05TOU
 UTS= JUL 29 '97 09:13:16.76 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2   Data  even  none   281    431  ASB$USERS
    3   DCB   even  none     0      0  M$USERS
    4   DCB   even  none     0      0  M$HLP
    5  RoData even  UTS      4      4  ASB$USERS
    6   Proc  even  none   178    262  ASB$USERS
    7  RoData even  none    10     12  ASB$USERS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     6      0   yes    yes     yes      Std        1  ASB$USERS
     6      3          yes     yes      Std        1  ASB$READ_USERS
     6     15          yes     yes      Std        0  ASB$WRITE_USERS_KEY
     6     22          yes     yes      Std        1  ASB$WRITE_USERS
     6     34          yes     yes      Std        0  ASB$DELREC_USERS
     6     57          yes     yes      Std        0  ASB$PREC_USERS
     6     66          yes     yes      Std        0  ASB$PREC_AND_SKIP_USERS
     6     75          yes     yes      Std        0  ASB$OPEN_USERS_CR
     6    104          yes     yes      Std        0  ASB$OPEN_USERS_UP
     6    113          yes     yes      Std        0  ASB$CLOSE_USERS
     6    121          yes     yes      Std        1  ASB$READ_USERS_SEQ
     6    136          yes     yes      Std        0  ASB$BOF_USERS
     6    154          yes     yes      Std        0  ASB$ENQ
     6    163          yes     yes      Std        0  ASB$ENQ_HLP
     6    172          yes     yes      Std        0  ASB$ENQ_USERS
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:19   
     6    217          yes     yes      Std        0  ASB$DEQ
     6    226          yes     yes      Std        0  ASB$DEQ_HLP
     6    235          yes     yes      Std        0  ASB$DEQ_USERS

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASB$WRITE_LO
         yes           Std       2 ASH$ERROR
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    AS_BLANK                         r    AS_MODE
r    AS_FE_MODE                            M$LO                                  USERS_KEY
     OUT_BUF                               ERR_CODE                              REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          FILE_ACCT
     AS_DCBNUM#                            AS_USERS                              B$TCB$
     M$USERS                               M$HLP                                 B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:20   


        1        1        /*M* ASB$FILES:  Processes :USERS, :PROJ, :HLP and :NETCON files
        2        2                         in the :SYS account.                            */
        3        3        /*T***********************************************************/
        4        4        /*T*                                                         */
        5        5        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        6        6        /*T*                                                         */
        7        7        /*T***********************************************************/
        8        8        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        9        9              ECU=3,CSU=3,SDI=3                                           */
       10       10        /*   ASB$FILES:  This module consists of procedures:
       11       11                         ASB$USERS
       12       12                         ASB$PROJ
       13       13                         ASB$HLP
       14       14                         ASB$NETCON                               */
       15       15                                                              /**/
       16       16                                                                                      /**/
       17       17        ASB$USERS: PROC (RW$USERS) ALTRET ;

     17  6 000000   000000 700200 xent  ASB$USERS    TSX0  ! X66_AUTO_1
         6 000001   000004 000001                    ZERO    4,1
         6 000002   000005 710000 6                  TRA     s:15010

       18       18        /***********************************************************/
       19       19
       20       20        /*P* NAME:     ASB$USERS
       21       21             PURPOSE:  Manage the :USERS file.
       22       22             DESCRIPTION:
       23       23                ASB$USERS has the following entries:
       24       24
       25       25                  ASB$READ_USERS - reads a record from :USERS file.
       26       26                  ASB$WRITE_USERS - writes a record to the :USERS file.
       27       27                  ASB$WRITE_USERS_KEY - writes a key to the :USERS file.
       28       28                  ASB$DELREC_USERS - deletes a record from the :USERS file.
       29       29                  ASB$PREC_USERS - positions to a record in the :USERS file.
       30       30                  ASB$PREC_AND_SKIP_USERS - postions to a record in the :USERS file
       31       31                                            and then skips to the next record.
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:21   
       32       32                  ASB$OPEN_USERS_CR - creates the :USERS file.
       33       33                  ASB$OPEN_USERS_UP - opens :USERS as an update file.
       34       34                  ASB$CLOSE_USERS - closes the :USERS file.
       35       35                  ASB$BOF_USERS - positions to beginning of :USERS file.
       36       36                  ASB$ENQ - enqueues a record in the :USERS and :HLP files.
       37       37                  ASB$ENQ_HLP - enqueues a record in the :HLP file.
       38       38                  ASB$ENQ_USERS - enqueues a record in the :USERS file.
       39       39                  ASB$DEQ - dequeues the :USERS and :HLP files.
       40       40                  ASB$DEQ_HLP - dequeues the :HLP file.
       41       41                  ASB$DEQ_USERS - dequeues the :USERS file.
       42       42        */
       43       43        /*******************************************************************/
       44       44                                                                                      /**/
       45       45        %EJECT;
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:22   
       46       46        /*********************************************************************/
       47       47        /*   Include files   include files   include files   include files   */
       48       48        /*********************************************************************/
       49       49                                                                                      /**/
       50       50              %INCLUDE AS_ENTRIES_M   ;
       51     1100              %INCLUDE CP_6           ;
       52     1181              %INCLUDE AS_PERR_C      ;
       53     1783              %INCLUDE B_ERRORS_C     ;
       54     2910              %INCLUDE AS_SUPER_C     ;
       55     3345              %INCLUDE AS_SUBS_C      ;
       56     4759              %INCLUDE XU_MACRO_C     ;
       57     7865              %INCLUDE KL_SUPER_C     ;
       58    10767              %INCLUDE XU_FORMAT_C    ;
       59    10929              %INCLUDE AS_MAC_C       ;
       60    11009              %INCLUDE AS_SUPER_R     ;
       61    14025                                                                                      /**/
       62    14026        %EJECT;
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:23   
       63    14027        /*********************************************************************/
       64    14028        /*   Static data     static data     static data     static data     */
       65    14029        /*********************************************************************/
       66    14030                                                                                      /**/
       67    14031    1   DCL 1 FILE_NAME STATIC ,
       68    14032    1          2 COUNT UBIN(9) UNAL INIT(6) ,
       69    14033    1          2 TEXT CHAR(31) UNAL INIT(':USERS') ;
       70    14034        %EJECT;
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:24   
       71    14035        /*********************************************************************/
       72    14036        /*   Local based     local based     local based     local based     */
       73    14037        /*********************************************************************/
       74    14038                                                              /**/
       75    14039              %B$ALT ;
       76    14047              %B$TCB ;
       77    14050        %EJECT ;
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:25   
       78    14051        /*********************************************************************/
       79    14052        /*   Symref's        symref's        symref's        symref's        */
       80    14053        /*********************************************************************/
       81    14054                                                              /**/
       82    14055    1   DCL B$TCB$ PTR SYMREF ;
       83    14056        %EJECT ;
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:26   
       84    14057        /*********************************************************************/
       85    14058        /*   Parameters      parameters      parameters      parameters      */
       86    14059        /*********************************************************************/
       87    14060                                                                                      /**/
       88    14061              %AS_USERS (STR_NAME=RW$USERS, STCLASS=PARAM) ;
       89    14239                                                                                      /**/
       90    14240        %EJECT;
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:27   
       91    14241        /*********************************************************************/
       92    14242        /*   Fpts            fpts            fpts            fpts            */
       93    14243        /*********************************************************************/
       94    14244                                                                                      /**/
       95    14245              %FPT_OPEN (FPTN=OPEN_CR_FPT ,
       96    14246                          NAME = FILE_NAME ,
       97    14247                          ACCT = FILE_ACCT ,
       98    14248                          ASN  = FILE ,
       99    14249                          DCB = M$USERS ,
      100    14250                          ACS = DIRECT ,
      101    14251                          ORG = KEYED ,
      102    14252                          ACSVEH = VLP_ATTR ,
      103    14253                          ACCESS = VLP_ATTR_ACC ,
      104    14254                          FUN = CREATE ,
      105    14255                          IXTNSIZE = 8 ,
      106    14256                          XTNSIZE = 8 ,
      107    14257                          EXIST = OLDFILE) ;
      108    14366              %FPT_OPEN (FPTN=OPEN_UP_FPT ,
      109    14367                          NAME = FILE_NAME ,
      110    14368                          ACCT = FILE_ACCT ,
      111    14369                          ASN  = FILE ,
      112    14370                          DCB = M$USERS ,
      113    14371                          ACS = DIRECT ,
      114    14372                          ORG = KEYED ,
      115    14373                          FUN = UPDATE ,
      116    14374                          SHARE = ALL) ;
      117    14483              %FPT_ENQ  ( FPTN = FPT_ENQ_USERS ,
      118    14484                          DCB = M$USERS ,
      119    14485                          RNAME = USERS_KEY ,
      120    14486                          SHARE = NONE ) ;
      121    14504              %FPT_ENQ  ( FPTN = FPT_ENQ_HLP ,
      122    14505                          DCB = M$HLP ,
      123    14506                          RNAME = USERS_KEY ,
      124    14507                          SHARE = NONE ) ;
      125    14525              %FPT_DEQ  ( FPTN = FPT_DEQ_USERS ,
      126    14526                          DCB = M$USERS ) ;
      127    14543              %FPT_DEQ  ( FPTN = FPT_DEQ_HLP ,
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:28   
      128    14544                          DCB = M$HLP ) ;
      129    14561              %FPT_CLOSE  (FPTN = CLOSE_FPT ,
      130    14562                           DCB = M$USERS ,
      131    14563                           DISP = SAVE) ;
      132    14605              %FPT_READ  (FPTN = READ_FPT ,
      133    14606                          KEY = USERS_KEY ,
      134    14607                          DCB = M$USERS ,
      135    14608                          KEYS = YES) ;
      136    14647              %FPT_WRITE  (FPTN = WRITE_FPT ,
      137    14648                           ONEWKEY = YES ,
      138    14649                           KEY = USERS_KEY ,
      139    14650                           DCB = M$USERS) ;
      140    14681              %FPT_DELREC  (FPTN = DELREC_FPT ,
      141    14682                            KEY = USERS_KEY ,
      142    14683                            DCB = M$USERS) ;
      143    14702              %FPT_PRECORD (FPTN = PREC_FPT,
      144    14703                            DCB = M$USERS,
      145    14704                            KEY = USERS_KEY,
      146    14705                            KEYS = YES,
      147    14706                            KEYR = YES,
      148    14707                            N = 0);
      149    14728              %FPT_PRECORD (FPTN = PREC_AND_SKIP_FPT ,
      150    14729                            DCB = M$USERS,
      151    14730                            KEY = USERS_KEY,
      152    14731                            KEYS = YES,
      153    14732                            KEYR = YES,
      154    14733                            N = 1 ) ;
      155    14754              %FPT_READ    (FPTN = READ_SEQ_FPT ,
      156    14755                            KEY = USERS_KEY ,
      157    14756                            DCB = M$USERS ,
      158    14757                            KEYR = YES ,
      159    14758                            KEYS = NO ) ;
      160    14797              %FPT_PFIL    (FPTN = PFIL_FPT ,
      161    14798                            DCB = M$USERS ,
      162    14799                            BOF = YES ) ;
      163    14814                                                                                      /**/
      164    14815        %EJECT;
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:29   
      165    14816        /*********************************************************************/
      166    14817        /*   Vlps            vlps            vlps            vlps            */
      167    14818        /*********************************************************************/
      168    14819                                                                                      /**/
      169    14820              %VLP_ATTR ;
      170    14834              %VLP_ACSVEH(  UPD = YES ,
      171    14835                            READ = YES ,
      172    14836                            DELR = YES,
      173    14837                            WNEW = YES,
      174    14838                            VEHICLE = 'SUPER' ) ;
      175    14855              %VLP_ACSVEH(  UPD = YES ,
      176    14856                            READ = YES ,
      177    14857                            VEHICLE = 'IBEX' ) ;
      178    14874              %VLP_ACSVEH(  UPD = YES ,
      179    14875                            READ = YES ,
      180    14876                            VEHICLE = 'LOGON' ) ;
      181    14893              %VLP_ACSVEH(  UPD = YES ,
      182    14894                            READ = YES ,
      183    14895                            VEHICLE = 'SLUG' ) ;
      184    14912              %VLP_ACSVEH(  UPD = YES ,
      185    14913                            READ = YES ,
      186    14914                            VEHICLE = 'TPCP' ) ;
      187    14931              %VLP_ACSVEH(  UPD = YES ,
      188    14932                            READ = YES,
      189    14933                            VEHICLE = 'PRESCAN' ,
      190    14934                            LAST=";") ;
      191    14951              %VLP_ATTR(  FPTN = VLP_ATTR_ACC ) ;
      192    14965              %VLP_ACCESS(  EXEC = YES ,
      193    14966                            ACCT = '?' ,
      194    14967                            LAST=";") ;
      195    14984        %EJECT ;
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:30   
      196    14985        /*********************************************************************/
      197    14986        /*   Dcbs            dcbs            dcbs            dcbs            */
      198    14987        /*********************************************************************/
      199    14988                                                                                      /**/
      200    14989    1   DCL M$USERS DCB ;                                    /*  Read-write users record */
      201    14990    1   DCL M$HLP DCB ;                                 /*  Read/write hlp record  */
      202    14991                                                              /**/
      203    14992        %EJECT ;
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:31   
      204    14993        /*********************************************************************/
      205    14994        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
      206    14995        /*********************************************************************/
      207    14996                                                              /**/
      208    14997        %ASH$ERROR ;
      209    15000        %ASB$WRITE_LO;
      210    15003        %EJECT;
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:32   
      211    15004        /********************************************************************/
      212    15005        /*   Procedure       procedure       procedure       procedure       */
      213    15006        /*********************************************************************/
      214    15007                                                              /**/
      215    15008    1   ASB$READ_USERS: ENTRY( RW$USERS )  ALTRET ;

  15008  6 000003   000000 700200 xent  ASB$READ_US* TSX0  ! X66_AUTO_1
         6 000004   000004 000001                    ZERO    4,1

      216    15009                                                              /* Set BUF_ in read fpt */
      217    15010    1   READ_FPT.BUF_ = VECTOR(RW$USERS) ;

  15010  6 000005   000000 235000 7                  LDA     0
         6 000006   200003 236100                    LDQ     @RW$USERS,,AUTO
         6 000007   000302 757000 2                  STAQ    READ_FPT+4

      218    15011    1   CALL M$READ (READ_FPT) ALTRET(IO_ERROR) ;

  15011  6 000010   000276 630400 2                  EPPR0   READ_FPT
         6 000011   440000 713400                    CLIMB   alt,read
         6 000012   401400 401760                    pmme    nvectors=4
         6 000013   000145 702000 6                  TSX2    IO_ERROR

      219    15012    1   RETURN ;

  15012  6 000014   000000 702200 xent               TSX2  ! X66_ARET

      220    15013                                                                                      /**/
      221    15014    1   ASB$WRITE_USERS_KEY: ENTRY ALTRET ;

  15014  6 000015   000000 700200 xent  ASB$WRITE_U* TSX0  ! X66_AUTO_1
         6 000016   000004 000001                    ZERO    4,1

      222    15015                                                           /* Set BUF_ in write fpt */
      223    15016    1   WRITE_FPT.BUF_ = VECTOR(NIL) ;

  15016  6 000017   000002 237000 7                  LDAQ    2
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:33   
         6 000020   000320 757000 2                  STAQ    WRITE_FPT+4

      224    15017    1   GOTO WRITE_RECORD ;

  15017  6 000021   000027 710000 6                  TRA     WRITE_RECORD

      225    15018
      226    15019    1   ASB$WRITE_USERS: ENTRY ( RW$USERS )  ALTRET ;

  15019  6 000022   000000 700200 xent  ASB$WRITE_U* TSX0  ! X66_AUTO_1
         6 000023   000004 000001                    ZERO    4,1

      227    15020                                                             /* Set BUF_ in write fpt */
      228    15021    1   WRITE_FPT.BUF_ = VECTOR(RW$USERS) ;

  15021  6 000024   000000 235000 7                  LDA     0
         6 000025   200003 236100                    LDQ     @RW$USERS,,AUTO
         6 000026   000320 757000 2                  STAQ    WRITE_FPT+4

      229    15022    1   WRITE_RECORD:
      230    15023    1   CALL M$WRITE (WRITE_FPT) ALTRET(IO_ERROR) ;

  15023  6 000027   000314 630400 2     WRITE_RECORD EPPR0   WRITE_FPT
         6 000030   440001 713400                    CLIMB   alt,write
         6 000031   401400 401760                    pmme    nvectors=4
         6 000032   000145 702000 6                  TSX2    IO_ERROR

      231    15024    1   RETURN ;

  15024  6 000033   000000 702200 xent               TSX2  ! X66_ARET

      232    15025                                                                                      /**/
      233    15026    1   ASB$DELREC_USERS: ENTRY    ALTRET;

  15026  6 000034   000000 700200 xent  ASB$DELREC_* TSX0  ! X66_AUTO_1
         6 000035   000004 000001                    ZERO    4,1

PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:34   
      234    15027        /** Show the user info before deleting it. **/
      235    15028    1   CALL CONCAT (OUT_BUF,AS_USERS.ACCT,',',AS_USERS.NAME);

  15028  6 000036   040000 100400                    MLR     fill='040'O
         6 000037   000000 000010 xsym               ADSC9   AS_USERS                 cn=0,n=8
         6 000040   000000 000010 xsym               ADSC9   OUT_BUF                  cn=0,n=8
         6 000041   054000 236003                    LDQ     22528,DU
         6 000042   000002 756000 xsym               STQ     OUT_BUF+2
         6 000043   040000 100400                    MLR     fill='040'O
         6 000044   000002 000014 xsym               ADSC9   AS_USERS+2               cn=0,n=12
         6 000045   000002 200203 xsym               ADSC9   OUT_BUF+2                cn=1,n=131

      236    15029    1   CALL ASB$WRITE_LO (OUT_BUF, SIZEC(OUT_BUF));

  15029  6 000046   000004 630400 7                  EPPR0   4
         6 000047   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 000050   000000 701000 xent               TSX1    ASB$WRITE_LO
         6 000051   000000 011000                    NOP     0

      237    15030    1   CALL M$DELREC (DELREC_FPT) ALTRET(IO_ERROR) ;

  15030  6 000052   000330 630400 2                  EPPR0   DELREC_FPT
         6 000053   440002 713400                    CLIMB   alt,+16386
         6 000054   401400 401760                    pmme    nvectors=4
         6 000055   000145 702000 6                  TSX2    IO_ERROR

      238    15031    1   RETURN ;

  15031  6 000056   000000 702200 xent               TSX2  ! X66_ARET

      239    15032                                                              /**/
      240    15033    1   ASB$PREC_USERS: ENTRY    ALTRET;

  15033  6 000057   000000 700200 xent  ASB$PREC_US* TSX0  ! X66_AUTO_1
         6 000060   000004 000001                    ZERO    4,1

      241    15034    1   CALL M$PRECORD (PREC_FPT) ALTRET(IO_ERROR) ;
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:35   

  15034  6 000061   000342 630400 2                  EPPR0   PREC_FPT
         6 000062   440003 713400                    CLIMB   alt,+16387
         6 000063   401000 401760                    pmme    nvectors=3
         6 000064   000145 702000 6                  TSX2    IO_ERROR

      242    15035    1   RETURN ;

  15035  6 000065   000000 702200 xent               TSX2  ! X66_ARET

      243    15036                                                              /**/
      244    15037    1   ASB$PREC_AND_SKIP_USERS: ENTRY  ALTRET ;

  15037  6 000066   000000 700200 xent  ASB$PREC_AN* TSX0  ! X66_AUTO_1
         6 000067   000004 000001                    ZERO    4,1

      245    15038    1   CALL M$PRECORD( PREC_AND_SKIP_FPT ) ALTRET( IO_ERROR ) ;

  15038  6 000070   000354 630400 2                  EPPR0   PREC_AND_SKIP_FPT
         6 000071   440003 713400                    CLIMB   alt,+16387
         6 000072   401000 401760                    pmme    nvectors=3
         6 000073   000145 702000 6                  TSX2    IO_ERROR

      246    15039    1   RETURN ;

  15039  6 000074   000000 702200 xent               TSX2  ! X66_ARET

      247    15040                                                              /**/
      248    15041    1   ASB$OPEN_USERS_CR: ENTRY    ALTRET;

  15041  6 000075   000000 700200 xent  ASB$OPEN_US* TSX0  ! X66_AUTO_1
         6 000076   000004 000001                    ZERO    4,1

      249    15042    1   CALL M$OPEN (OPEN_CR_FPT) ALTRET(IO_ERROR) ;

  15042  6 000077   000010 630400 2                  EPPR0   OPEN_CR_FPT
         6 000100   450000 713400                    CLIMB   alt,open
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:36   
         6 000101   410400 401760                    pmme    nvectors=18
         6 000102   000145 702000 6                  TSX2    IO_ERROR

      250    15043    1   RETURN ;

  15043  6 000103   000000 702200 xent               TSX2  ! X66_ARET

      251    15044                                                              /**/
      252    15045    1   ASB$OPEN_USERS_UP: ENTRY    ALTRET;

  15045  6 000104   000000 700200 xent  ASB$OPEN_US* TSX0  ! X66_AUTO_1
         6 000105   000004 000001                    ZERO    4,1

      253    15046    1   CALL M$OPEN (OPEN_UP_FPT) ALTRET(IO_ERROR) ;

  15046  6 000106   000102 630400 2                  EPPR0   OPEN_UP_FPT
         6 000107   450000 713400                    CLIMB   alt,open
         6 000110   410400 401760                    pmme    nvectors=18
         6 000111   000145 702000 6                  TSX2    IO_ERROR

      254    15047    1   RETURN ;

  15047  6 000112   000000 702200 xent               TSX2  ! X66_ARET

      255    15048                                                              /**/
      256    15049    1   ASB$CLOSE_USERS: ENTRY    ALTRET;

  15049  6 000113   000000 700200 xent  ASB$CLOSE_U* TSX0  ! X66_AUTO_1
         6 000114   000004 000001                    ZERO    4,1

      257    15050    1   CALL M$CLOSE (CLOSE_FPT) ;

  15050  6 000115   000240 630400 2                  EPPR0   CLOSE_FPT
         6 000116   050001 713400                    CLIMB   close
         6 000117   406000 401760                    pmme    nvectors=13

      258    15051    1   RETURN ;
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:37   

  15051  6 000120   000000 702200 xent               TSX2  ! X66_ARET

      259    15052                                                              /**/
      260    15053    1   ASB$READ_USERS_SEQ: ENTRY( RW$USERS )  ALTRET ;

  15053  6 000121   000000 700200 xent  ASB$READ_US* TSX0  ! X66_AUTO_1
         6 000122   000004 000001                    ZERO    4,1

      261    15054    1   READ_SEQ_FPT.BUF_ = VECTOR(RW$USERS) ;

  15054  6 000123   000000 235000 7                  LDA     0
         6 000124   200003 236100                    LDQ     @RW$USERS,,AUTO
         6 000125   000372 757000 2                  STAQ    READ_SEQ_FPT+4

      262    15055    1   USERS_KEY.TXTC = AS_BLANK ;

  15055  6 000126   040000 100400                    MLR     fill='040'O
         6 000127   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         6 000130   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41

      263    15056    1   CALL M$READ(READ_SEQ_FPT) ALTRET (IO_ERROR) ;

  15056  6 000131   000366 630400 2                  EPPR0   READ_SEQ_FPT
         6 000132   440000 713400                    CLIMB   alt,read
         6 000133   401400 401760                    pmme    nvectors=4
         6 000134   000145 702000 6                  TSX2    IO_ERROR

      264    15057    1   RETURN ;

  15057  6 000135   000000 702200 xent               TSX2  ! X66_ARET

      265    15058                                                              /**/
      266    15059    1   ASB$BOF_USERS: ENTRY     ALTRET;

  15059  6 000136   000000 700200 xent  ASB$BOF_USE* TSX0  ! X66_AUTO_1
         6 000137   000004 000001                    ZERO    4,1
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:38   

      267    15060    1   CALL M$PFIL(PFIL_FPT) ALTRET(IO_ERROR) ;

  15060  6 000140   000404 630400 2                  EPPR0   PFIL_FPT
         6 000141   440004 713400                    CLIMB   alt,+16388
         6 000142   400000 401760                    pmme    nvectors=1
         6 000143   000145 702000 6                  TSX2    IO_ERROR

      268    15061    1   RETURN ;

  15061  6 000144   000000 702200 xent               TSX2  ! X66_ARET

  15055  6 000145                       IO_ERROR     null
      269    15062                                                              /**/
      270    15063    1   IO_ERROR: ;
      271    15064    1   ERR_CODE = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR ;

  15064  6 000145   000000 470400 xsym               LDP0    B$TCB$
         6 000146   000000 471500                    LDP1    0,,PR0
         6 000147   100102 236100                    LDQ     66,,PR1
         6 000150   000000 756000 xsym               STQ     ERR_CODE

      272    15065    1   AS_DCBNUM# = DCBNUM( M$USERS );

  15065  6 000151   000000 236007 xsym               LDQ     M$USERS,DL
         6 000152   000000 756000 xsym               STQ     AS_DCBNUM#

      273    15066    1   ALTRETURN ;

  15066  6 000153   000000 702200 xent               TSX2  ! X66_AALT

      274    15067                                                              /**/
      275    15068    1   ASB$ENQ: ENTRY          ALTRET ;

  15068  6 000154   000000 700200 xent  ASB$ENQ      TSX0  ! X66_AUTO_1
         6 000155   000004 000001                    ZERO    4,1

PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:39   
      276    15069    1   CALL M$ENQ( FPT_ENQ_USERS ) ALTRET( ENQ_ERR1 ) ;

  15069  6 000156   000174 630400 2                  EPPR0   FPT_ENQ_USERS
         6 000157   420002 713400                    CLIMB   alt,+8194
         6 000160   401000 401760                    pmme    nvectors=3
         6 000161   000201 702000 6                  TSX2    ENQ_ERR1
         6 000162   000165 710000 6                  TRA     s:15071

      277    15070    1   ASB$ENQ_HLP: ENTRY          ALTRET ;

  15070  6 000163   000000 700200 xent  ASB$ENQ_HLP  TSX0  ! X66_AUTO_1
         6 000164   000004 000001                    ZERO    4,1

      278    15071    1   CALL M$ENQ( FPT_ENQ_HLP ) ALTRET( ENQ_ERR2 ) ;

  15071  6 000165   000206 630400 2                  EPPR0   FPT_ENQ_HLP
         6 000166   420002 713400                    CLIMB   alt,+8194
         6 000167   401000 401760                    pmme    nvectors=3
         6 000170   000206 702000 6                  TSX2    ENQ_ERR2

      279    15072    1   RETURN ;

  15072  6 000171   000000 702200 xent               TSX2  ! X66_ARET

      280    15073                                                              /**/
      281    15074    1   ASB$ENQ_USERS: ENTRY ALTRET ;

  15074  6 000172   000000 700200 xent  ASB$ENQ_USE* TSX0  ! X66_AUTO_1
         6 000173   000004 000001                    ZERO    4,1

      282    15075    1   CALL M$ENQ( FPT_ENQ_USERS ) ALTRET( ENQ_ERR1 ) ;

  15075  6 000174   000174 630400 2                  EPPR0   FPT_ENQ_USERS
         6 000175   420002 713400                    CLIMB   alt,+8194
         6 000176   401000 401760                    pmme    nvectors=3
         6 000177   000201 702000 6                  TSX2    ENQ_ERR1

PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:40   
      283    15076    1   RETURN ;

  15076  6 000200   000000 702200 xent               TSX2  ! X66_ARET

  15075  6 000201                       ENQ_ERR1     null
      284    15077                                                              /**/
      285    15078    1   ENQ_ERR1: ;
      286    15079        /*E*  ERROR:    ASB-E$UNABLE_ENQ_USERS-C
      287    15080              MESSAGE:  Unable to ENQ :USERS.
      288    15081        */
      289    15082        %SCREAM( ERR#=E$UNABLE_ENQ_USERS, LEVEL=ERROR, MID='B' );

  15094  6 000201   000006 630400 7                  EPPR0   6
         6 000202   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000203   000000 701000 xent               TSX1    ASH$ERROR
         6 000204   000000 011000                    NOP     0

      290    15097    1   ALTRETURN ;

  15097  6 000205   000000 702200 xent               TSX2  ! X66_AALT

  15075  6 000206                       ENQ_ERR2     null
      291    15098                                                              /**/
      292    15099    1   ENQ_ERR2: ;
      293    15100        /*E*  ERROR:    ASB-E$UNABLE_ENQ_HLP-C
      294    15101              MESSAGE:  Unable to ENQ :HLP.
      295    15102        */
      296    15103        %SCREAM( ERR#=E$UNABLE_ENQ_HLP, LEVEL=ERROR, MID='B' );

  15115  6 000206   000007 630400 7                  EPPR0   7
         6 000207   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000210   000000 701000 xent               TSX1    ASH$ERROR
         6 000211   000000 011000                    NOP     0

      297    15118    1   CALL M$DEQ( FPT_DEQ_USERS ) ALTRET( DEQ_ERR1 ) ;

  15118  6 000212   000220 630400 2                  EPPR0   FPT_DEQ_USERS
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:41   
         6 000213   420003 713400                    CLIMB   alt,+8195
         6 000214   401000 401760                    pmme    nvectors=3
         6 000215   000244 702000 6                  TSX2    DEQ_ERR1

      298    15119    1   ALTRETURN ;

  15119  6 000216   000000 702200 xent               TSX2  ! X66_AALT

      299    15120                                                              /**/
      300    15121    1   ASB$DEQ: ENTRY          ALTRET ;

  15121  6 000217   000000 700200 xent  ASB$DEQ      TSX0  ! X66_AUTO_1
         6 000220   000004 000001                    ZERO    4,1

      301    15122    1   CALL M$DEQ( FPT_DEQ_USERS ) ALTRET( DEQ_ERR1 ) ;

  15122  6 000221   000220 630400 2                  EPPR0   FPT_DEQ_USERS
         6 000222   420003 713400                    CLIMB   alt,+8195
         6 000223   401000 401760                    pmme    nvectors=3
         6 000224   000244 702000 6                  TSX2    DEQ_ERR1
         6 000225   000230 710000 6                  TRA     s:15124

      302    15123    1   ASB$DEQ_HLP: ENTRY          ALTRET ;

  15123  6 000226   000000 700200 xent  ASB$DEQ_HLP  TSX0  ! X66_AUTO_1
         6 000227   000004 000001                    ZERO    4,1

      303    15124    1   CALL M$DEQ( FPT_DEQ_HLP ) ALTRET( DEQ_ERR2 ) ;

  15124  6 000230   000230 630400 2                  EPPR0   FPT_DEQ_HLP
         6 000231   420003 713400                    CLIMB   alt,+8195
         6 000232   401000 401760                    pmme    nvectors=3
         6 000233   000255 702000 6                  TSX2    DEQ_ERR2

      304    15125    1   RETURN ;

  15125  6 000234   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:42   

      305    15126                                                              /**/
      306    15127    1   ASB$DEQ_USERS: ENTRY ALTRET ;

  15127  6 000235   000000 700200 xent  ASB$DEQ_USE* TSX0  ! X66_AUTO_1
         6 000236   000004 000001                    ZERO    4,1

      307    15128    1   CALL M$DEQ( FPT_DEQ_USERS ) ALTRET( DEQ_ERR1 ) ;

  15128  6 000237   000220 630400 2                  EPPR0   FPT_DEQ_USERS
         6 000240   420003 713400                    CLIMB   alt,+8195
         6 000241   401000 401760                    pmme    nvectors=3
         6 000242   000244 702000 6                  TSX2    DEQ_ERR1

      308    15129    1   RETURN ;

  15129  6 000243   000000 702200 xent               TSX2  ! X66_ARET

  15122  6 000244                       DEQ_ERR1     null
      309    15130                                                              /**/
      310    15131    1   DEQ_ERR1: ;
      311    15132        /*E*  ERROR:    ASB-E$UNABLE_DEQ_USERS-C
      312    15133              MESSAGE:  Unable to DEQ :USERS.
      313    15134        */
      314    15135        %SCREAM( ERR#=E$UNABLE_DEQ_USERS, LEVEL=ERROR, MID='B' );

  15147  6 000244   000010 630400 7                  EPPR0   8
         6 000245   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000246   000000 701000 xent               TSX1    ASH$ERROR
         6 000247   000000 011000                    NOP     0

      315    15150    1   CALL M$DEQ( FPT_DEQ_HLP ) ALTRET( DEQ_ERR2 ) ;

  15150  6 000250   000230 630400 2                  EPPR0   FPT_DEQ_HLP
         6 000251   420003 713400                    CLIMB   alt,+8195
         6 000252   401000 401760                    pmme    nvectors=3
         6 000253   000255 702000 6                  TSX2    DEQ_ERR2
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:43   

      316    15151    1   ALTRETURN ;

  15151  6 000254   000000 702200 xent               TSX2  ! X66_AALT

  15150  6 000255                       DEQ_ERR2     null
      317    15152                                                              /**/
      318    15153    1   DEQ_ERR2: ;
      319    15154        /*E*  ERROR:    ASB-E$UNABLE_DEQ_HLP-C
      320    15155              MESSAGE:  Unable to DEQ :HLP.
      321    15156        */
      322    15157        %SCREAM( ERR#=E$UNABLE_DEQ_HLP, LEVEL=ERROR, MID='B' );

  15169  6 000255   000011 630400 7                  EPPR0   9
         6 000256   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000257   000000 701000 xent               TSX1    ASH$ERROR
         6 000260   000000 011000                    NOP     0

      323    15172    1   ALTRETURN ;

  15172  6 000261   000000 702200 xent               TSX2  ! X66_AALT
      324    15173                                                              /**/
      325    15174                                                              /**/
      326    15175    1   END   ASB$USERS ;
      327    15176        %EOD ;

PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:44   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASB$USERS.
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:45   

 **** Variables and constants ****

  ****  Section 002  Data  ASB$USERS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   240-0-0/d STRC(1080)  r     1 CLOSE_FPT                330-0-0/d STRC(360)   r     1 DELREC_FPT
     0-0-0/c STRC(288)   r     1 FILE_NAME                230-0-0/d STRC(288)   r     1 FPT_DEQ_HLP
   220-0-0/d STRC(288)   r     1 FPT_DEQ_USERS            206-0-0/d STRC(360)   r     1 FPT_ENQ_HLP
   174-0-0/d STRC(360)   r     1 FPT_ENQ_USERS             10-0-0/d STRC(2088)  r     1 OPEN_CR_FPT
   102-0-0/d STRC(2088)  r     1 OPEN_UP_FPT              404-0-0/d STRC(144)   r     1 PFIL_FPT
   354-0-0/d STRC(360)   r     1 PREC_AND_SKIP_FPT        342-0-0/d STRC(360)   r     1 PREC_FPT
   276-0-0/d STRC(504)   r     1 READ_FPT                 366-0-0/d STRC(504)   r     1 READ_SEQ_FPT
   410-0-0/w STRC(459)   r     1 VLP_ATTR                 425-0-0/w STRC(126)   r     1 VLP_ATTR_ACC
   314-0-0/d STRC(432)   r     1 WRITE_FPT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @RW$USERS                 *0-0-0/w STRC(18576) r     1 RW$USERS

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/w UBIN        r     1 AS_DCBNUM#
     0-0-0/w STRC(18576) r     1 AS_USERS                   0-0-0/w PTR         r     1 B$TCB$
     0-0-0/b STRC        r     1 ERR_CODE                   0-0-0/c STRC(72)    r     1 FILE_ACCT
     0-0-0/c CHAR(140)   r     1 OUT_BUF                    0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:46   
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0N  NULL        r     1 M$HLP                      0-0-0N  NULL        r     1 M$USERS


   Procedure ASB$USERS requires 178 words for executable code.
   Procedure ASB$USERS requires 4 words of local(AUTO) storage.
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:47   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:48   
          MINI XREF LISTING

ASA_BRKS_LOC
     11173**DCL     11173--REDEF
ASB$WRITE_LO
     15001**DCL-ENT 15029--CALL
ASH$ERROR
     14998**DCL-ENT 15094--CALL    15115--CALL    15147--CALL    15169--CALL
AS_BLANK
     11033**DCL     15055>>ASSIGN
AS_DCBNUM#
     11180**DCL     15065<<ASSIGN
AS_DEFAULT.BANNER_PERM
     11866**DCL     11867--REDEF
AS_DEFAULT.BUDGET.MACCT
     11771**DCL     11775--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     11784**DCL     11787--REDEF
AS_DEFAULT.BUDGET.PACCUM
     11767**DCL     11769--REDEF
AS_DEFAULT.BUDGET.PMAXC
     11762**DCL     11764--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     11882**DCL     11883--REDEF   11884--REDEF
AS_DEFAULT_DREC.PASSWORD
     13136**DCL     13140--REDEF
AS_DEFAULT_DREC.RENAME
     13159**DCL     13160--REDEF
AS_DFLT.BANNER_PERM
     11688**DCL     11689--REDEF
AS_DFLT.BUDGET.MACCT
     11593**DCL     11597--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     11606**DCL     11609--REDEF
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:49   
AS_DFLT.BUDGET.PACCUM
     11589**DCL     11591--REDEF
AS_DFLT.BUDGET.PMAXC
     11584**DCL     11586--REDEF
AS_DFLT.SETUP_CHRA.TXT
     11704**DCL     11705--REDEF   11706--REDEF
AS_FE_MODE
     11039**DCL     11040--REDEF
AS_MODE
     11036**DCL     11038--REDEF
AS_MOD_USER.ACCESS
     13901**DCL     13902--REDEF
AS_MOD_USER.BANNER
     13888**DCL     13889--REDEF
AS_MOD_USER.BANNER_PERM
     13890**DCL     13891--REDEF
AS_MOD_USER.BILL
     13896**DCL     13897--REDEF
AS_MOD_USER.CPROC
     13892**DCL     13893--REDEF
AS_MOD_USER.FEBILL
     13972**DCL     13973--REDEF
AS_MOD_USER.FECXTMEM
     13989**DCL     13990--REDEF
AS_MOD_USER.FEMINTS
     13974**DCL     13975--REDEF
AS_MOD_USER.FEMMEM
     13985**DCL     13986--REDEF
AS_MOD_USER.FEMTIME
     13983**DCL     13984--REDEF
AS_MOD_USER.FEPPRIV
     13980**DCL     13982--REDEF
AS_MOD_USER.FEPRIV
     13977**DCL     13979--REDEF
AS_MOD_USER.FORCE_BIT
     13886**DCL     13887--REDEF
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:50   
AS_MOD_USER.KEY
     13968**DCL     13970--REDEF
AS_MOD_USER.LASTCPROC
     13894**DCL     13895--REDEF
AS_MOD_USER.LIMITS.DO_
     13942**DCL     13943--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     13958**DCL     13959--REDEF
AS_MOD_USER.LIMITS.LO
     13938**DCL     13939--REDEF
AS_MOD_USER.LIMITS.MEM
     13934**DCL     13935--REDEF
AS_MOD_USER.LIMITS.MPRIO
     13962**DCL     13963--REDEF
AS_MOD_USER.LIMITS.PDIS
     13950**DCL     13951--REDEF
AS_MOD_USER.LIMITS.PO
     13946**DCL     13947--REDEF
AS_MOD_USER.LIMITS.TDIS
     13954**DCL     13955--REDEF
AS_MOD_USER.LIMITS.TIME
     13930**DCL     13931--REDEF
AS_MOD_USER.MAXENQ
     13911**DCL     13912--REDEF
AS_MOD_USER.PERM_BIT
     13884**DCL     13885--REDEF
AS_MOD_USER.PPRIV
     13906**DCL     13908--REDEF
AS_MOD_USER.PRIOB
     13913**DCL     13914--REDEF
AS_MOD_USER.PRIV
     13903**DCL     13905--REDEF
AS_MOD_USER.QUAN
     13909**DCL     13910--REDEF
AS_MOD_USER.SETUP
     13882**DCL     13883--REDEF
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:51   
AS_PROJECT.BANNER_PERM
     12222**DCL     12223--REDEF
AS_PROJECT.BUDGET.MACCT
     12127**DCL     12131--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     12140**DCL     12143--REDEF
AS_PROJECT.BUDGET.PACCUM
     12123**DCL     12125--REDEF
AS_PROJECT.BUDGET.PMAXC
     12118**DCL     12120--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12238**DCL     12239--REDEF   12240--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     12400**DCL     12401--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     12305**DCL     12309--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     12318**DCL     12321--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     12301**DCL     12303--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     12296**DCL     12298--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     12416**DCL     12417--REDEF   12418--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     13622**DCL     13626--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     13645**DCL     13646--REDEF
AS_PROJECT_DREC.PASSWORD
     13460**DCL     13464--REDEF
AS_PROJECT_DREC.RENAME
     13483**DCL     13484--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     12044**DCL     12045--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     11949**DCL     11953--REDEF
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:52   
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     11962**DCL     11965--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     11945**DCL     11947--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     11940**DCL     11942--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     12060**DCL     12061--REDEF   12062--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     13298**DCL     13302--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     13321**DCL     13322--REDEF
AS_USERS.ACCT
     11396**DCL     15028>>CALLBLT
AS_USERS.BANNER_PERM
     11510**DCL     11511--REDEF
AS_USERS.BUDGET.MACCT
     11415**DCL     11419--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     11428**DCL     11431--REDEF
AS_USERS.BUDGET.PACCUM
     11411**DCL     11413--REDEF
AS_USERS.BUDGET.PMAXC
     11406**DCL     11408--REDEF
AS_USERS.NAME
     11397**DCL     15028>>CALLBLT
AS_USERS.SETUP_CHRA.TXT
     11526**DCL     11527--REDEF   11528--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     12578**DCL     12579--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     12483**DCL     12487--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     12496**DCL     12499--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     12479**DCL     12481--REDEF
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:53   
AS_USERS_CONSTANT.BUDGET.PMAXC
     12474**DCL     12476--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     12594**DCL     12595--REDEF   12596--REDEF
B$ALT.CODE
     14041**DCL     14041--REDEF   14042--REDEF   14042--REDEF
B$ALT.ERR
     14042**DCL     15064>>ASSIGN
B$ALT.ERR.ERR#
     14043**DCL     14043--REDEF
B$ALT.EVID
     14042**DCL     14042--REDEF   14042--REDEF
B$TCB.ALT$
     14048**DCL     15064>>ASSIGN
B$TCB$
     14055**DCL     15064>>ASSIGN
CLOSE_FPT
     14586**DCL     15050<>CALL
CLOSE_FPT.SN_
     14586**DCL     14586--REDEF
CLOSE_FPT.UTL_
     14587**DCL     14587--REDEF
CLOSE_FPT.V
     14591**DCL     14586--DCLINIT
CLOSE_FPT.V.EXPIRE#
     14601**DCL     14601--REDEF
CLOSE_FPT.V.TYPE#
     14599**DCL     14599--REDEF
CLOSE_FPT.V.XTNSIZE#
     14596**DCL     14596--REDEF   14598--REDEF
DELREC_FPT
     14694**DCL     15030<>CALL
DELREC_FPT.V
     14697**DCL     14694--DCLINIT
DEQ_ERR1
     15122**LABEL   15118--CALLALT 15122--CALLALT 15128--CALLALT
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:54   
DEQ_ERR2
     15150**LABEL   15124--CALLALT 15150--CALLALT
ENQ_ERR1
     15075**LABEL   15069--CALLALT 15075--CALLALT
ENQ_ERR2
     15075**LABEL   15071--CALLALT
ERR_CODE
     11168**DCL     11169--REDEF   15064<<ASSIGN
FILE_ACCT
     11176**DCL     14327--DCLINIT 14444--DCLINIT
FILE_NAME
     14031**DCL     14323--DCLINIT 14440--DCLINIT
FPT_DEQ_HLP
     14555**DCL     15124<>CALL    15150<>CALL
FPT_DEQ_HLP.V
     14556**DCL     14555--DCLINIT
FPT_DEQ_USERS
     14537**DCL     15118<>CALL    15122<>CALL    15128<>CALL
FPT_DEQ_USERS.V
     14538**DCL     14537--DCLINIT
FPT_ENQ_HLP
     14518**DCL     15071<>CALL
FPT_ENQ_HLP.V
     14519**DCL     14518--DCLINIT
FPT_ENQ_USERS
     14497**DCL     15069<>CALL    15075<>CALL
FPT_ENQ_USERS.V
     14498**DCL     14497--DCLINIT
IO_ERROR
     15055**LABEL   15011--CALLALT 15023--CALLALT 15030--CALLALT 15034--CALLALT 15038--CALLALT 15042--CALLALT
     15046--CALLALT 15056--CALLALT 15060--CALLALT
KL_DEFAULT.PASSWORD
     13784**DCL     13788--REDEF
KL_DEFAULT.RENAME
     13807**DCL     13808--REDEF
KL_DFLT.PASSWORD
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:55   
     12974**DCL     12978--REDEF
KL_DFLT.RENAME
     12997**DCL     12998--REDEF
KL_DREC.PASSWORD
     12812**DCL     12816--REDEF
KL_DREC.RENAME
     12835**DCL     12836--REDEF
KL_DREC_CNT.PASSWORD
     12699**DCL     12703--REDEF
KL_DREC_CNT.RENAME
     12722**DCL     12723--REDEF
M$CLOSE
      1109**DCL-ENT 15050--CALL
M$DELREC
      1111**DCL-ENT 15030--CALL
M$DEQ
      1176**DCL-ENT 15118--CALL    15122--CALL    15124--CALL    15128--CALL    15150--CALL
M$ENQ
      1175**DCL-ENT 15069--CALL    15071--CALL    15075--CALL
M$OPEN
      1109**DCL-ENT 15042--CALL    15046--CALL
M$PFIL
      1111**DCL-ENT 15060--CALL
M$PRECORD
      1113**DCL-ENT 15034--CALL    15038--CALL
M$READ
      1110**DCL-ENT 15011--CALL    15056--CALL
M$USERS
     14989**DCL     15065>>ASSIGN
M$WRITE
      1110**DCL-ENT 15023--CALL
OPEN_CR_FPT
     14322**DCL     15042<>CALL
OPEN_CR_FPT.ACSVEH_
     14324**DCL     14325--REDEF
OPEN_CR_FPT.ALTKEYS_
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:56   
     14330**DCL     14331--REDEF   14331--REDEF
OPEN_CR_FPT.HDR_
     14329**DCL     14330--REDEF
OPEN_CR_FPT.TAB_
     14328**DCL     14329--REDEF
OPEN_CR_FPT.UHL_
     14322**DCL     14323--REDEF   14323--REDEF
OPEN_CR_FPT.V
     14331**DCL     14322--DCLINIT
OPEN_CR_FPT.V.FSN#
     14362**DCL     14362--REDEF   14362--REDEF
OPEN_CR_FPT.WSN_
     14328**DCL     14328--REDEF
OPEN_UP_FPT
     14439**DCL     15046<>CALL
OPEN_UP_FPT.ACSVEH_
     14441**DCL     14442--REDEF
OPEN_UP_FPT.ALTKEYS_
     14447**DCL     14448--REDEF   14448--REDEF
OPEN_UP_FPT.HDR_
     14446**DCL     14447--REDEF
OPEN_UP_FPT.TAB_
     14445**DCL     14446--REDEF
OPEN_UP_FPT.UHL_
     14439**DCL     14440--REDEF   14440--REDEF
OPEN_UP_FPT.V
     14448**DCL     14439--DCLINIT
OPEN_UP_FPT.V.FSN#
     14479**DCL     14479--REDEF   14479--REDEF
OPEN_UP_FPT.WSN_
     14445**DCL     14445--REDEF
OUT_BUF
     11165**DCL     15028<<CALLBLT 15029<>CALL    15029--CALL
PFIL_FPT
     14810**DCL     15060<>CALL
PFIL_FPT.V
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:57   
     14810**DCL     14810--DCLINIT
PREC_AND_SKIP_FPT
     14744**DCL     15038<>CALL
PREC_AND_SKIP_FPT.V
     14746**DCL     14744--DCLINIT
PREC_FPT
     14718**DCL     15034<>CALL
PREC_FPT.V
     14720**DCL     14718--DCLINIT
PROJ_KEY.TEXT
     11046**DCL     11046--REDEF
PROJ_KEY.TXT.PROJECT
     11046**DCL     11046--REDEF
READ_FPT
     14625**DCL     15011<>CALL
READ_FPT.BUF_
     14627**DCL     15010<<ASSIGN
READ_FPT.STATION_
     14628**DCL     14629--REDEF
READ_FPT.V
     14629**DCL     14625--DCLINIT
READ_FPT.V.DVBYTE.REREAD#
     14640**DCL     14640--REDEF
READ_FPT.V.INDX#
     14638**DCL     14638--REDEF
READ_SEQ_FPT
     14775**DCL     15056<>CALL
READ_SEQ_FPT.BUF_
     14777**DCL     15054<<ASSIGN
READ_SEQ_FPT.STATION_
     14778**DCL     14779--REDEF
READ_SEQ_FPT.V
     14779**DCL     14775--DCLINIT
READ_SEQ_FPT.V.DVBYTE.REREAD#
     14790**DCL     14790--REDEF
READ_SEQ_FPT.V.INDX#
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:58   
     14788**DCL     14788--REDEF
REMEM_VAR
     11172**DCL     11172--REDEF
REM_FCMD
     11172**DCL     11173--REDEF
RW$USERS
     14074**DCL        17--PROC    15008--ENTRY   15010--ASSIGN  15019--ENTRY   15021--ASSIGN  15053--ENTRY
     15054--ASSIGN
RW$USERS.BANNER_PERM
     14189**DCL     14190--REDEF
RW$USERS.BUDGET.MACCT
     14094**DCL     14098--REDEF
RW$USERS.BUDGET.MAX_PROJECTS
     14107**DCL     14110--REDEF
RW$USERS.BUDGET.PACCUM
     14090**DCL     14092--REDEF
RW$USERS.BUDGET.PMAXC
     14085**DCL     14087--REDEF
RW$USERS.SETUP_CHRA.TXT
     14205**DCL     14206--REDEF   14207--REDEF
USERS_KEY
     11043**DCL     14497--DCLINIT 14518--DCLINIT 14625--DCLINIT 14626--DCLINIT 14667--DCLINIT 14694--DCLINIT
     14695--DCLINIT 14718--DCLINIT 14719--DCLINIT 14744--DCLINIT 14745--DCLINIT 14775--DCLINIT 14776--DCLINIT
USERS_KEY.TEXT
     11043**DCL     11044--REDEF   11044--REDEF   11044--REDEF   11045--REDEF
USERS_KEY.TXTC
     11044**DCL     15055<<ASSIGN
VLP_ATTR
     14831**DCL     14325--DCLINIT
VLP_ATTR.Q
     14832**DCL     14831--DCLINIT
VLP_ATTR_ACC
     14962**DCL     14324--DCLINIT
VLP_ATTR_ACC.Q
     14963**DCL     14962--DCLINIT
WRITE_FPT
PL6.E3A0      #001=ASB$USERS File=ASB$FILES.:E05TSI                              TUE 07/29/97 09:13 Page:59   
     14667**DCL     15023<>CALL
WRITE_FPT.BUF_
     14667**DCL     15016<<ASSIGN  15021<<ASSIGN
WRITE_FPT.STATION_
     14669**DCL     14669--REDEF
WRITE_FPT.V
     14670**DCL     14667--DCLINIT
WRITE_FPT.V.DVBYTE.VFC#
     14676**DCL     14676--REDEF
WRITE_RECORD
     15023**LABEL   15017--GOTO

PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:60   
      328        1        /*M* ASB$PROJ -  procedure to manage the :PROJ file.       */
      329        2        /*T***********************************************************/
      330        3        /*T*                                                         */
      331        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      332        5        /*T*                                                         */
      333        6        /*T***********************************************************/
      334        7                                                              /**/
      335        8                                                                                      /**/
      336        9        ASB$PROJ: PROC ( PROJ$, ARS, SEG_TYPE ) ALTRET ;
      337       10        /***********************************************************/
      338       11
      339       12        /*P*    NAME:     ASB$PROJ
      340       13                PURPOSE:  Manage the :PROJ file.
      341       14                DESCRIPTION:
      342       15                  ASB$PROJ has 11 entries:
      343       16
      344       17                      ASB$READ_PROJ - reads a record from :PROJ file.
      345       18                      ASB$WRITE_PROJ - writes a record to the :PROJ file.
      346       19                      ASB$DELREC_PROJ - deletes a record from the :PROJ file.
      347       20                      ASB$PREC_PROJ - positions to a record in the :PROJ file.
      348       21                      ASB$OPEN_PROJ_CR - creates the :PROJ file.
      349       22                      ASB$OPEN_PROJ_UP - opens :PROJ as an update file.
      350       23                      ASB$CLOSE_PROJ - closes the :PROJ file.
      351       24                      ASB$BOF_PROJ - positions to beginning of :PROJ file.
      352       25                      ASB$ENQ_PROJ - enqueues a record in the :PROJ file.
      353       26                      ASB$DEQ_PROJ - dequeues the :PROJ file.
      354       27        */
      355       28        /*******************************************************************/
      356       29                                                                                      /**/
      357       30        %EJECT;
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:61   
      358       31        /*********************************************************************/
      359       32        /*   Include files   include files   include files   include files   */
      360       33        /*********************************************************************/
      361       34                                                                                      /**/
      362       35              %INCLUDE CP_6            ;
      363      116              %INCLUDE AS_ENTRIES_M    ;
      364     1166              %INCLUDE AS_PERR_C       ;
      365     1768              %INCLUDE B_ERRORS_C      ;
      366     2895              %INCLUDE AS_MAC_C        ;
      367     2975              %INCLUDE AS_SUPER_C      ;
      368     3410              %INCLUDE AS_SUBS_C       ;
      369     4824              %INCLUDE XU_MACRO_C      ;
      370     7930              %INCLUDE KL_SUPER_C      ;
      371    10832              %INCLUDE XU_FORMAT_C     ;
      372    10994              %INCLUDE AS_SUPER_R      ;
      373    14010                                                                                      /**/
      374    14011        %EJECT;
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:62   
      375    14012        /*********************************************************************/
      376    14013        /*   Static data     static data     static data     static data     */
      377    14014        /*********************************************************************/
      378    14015                                                                                      /**/
      379    14016    1   DCL 1 FILE_NAME CONSTANT ,
      380    14017    1          2 COUNT UBIN(9) UNAL INIT(5) ,
      381    14018    1          2 TEXT CHAR(31) UNAL INIT(':PROJ') ;
      382    14019                                                                                      /**/
      383    14020        %EJECT;
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:63   
      384    14021        /*********************************************************************/
      385    14022        /*   Local based     local based     local based     local based     */
      386    14023        /*********************************************************************/
      387    14024                                                              /**/
      388    14025              %B$ALT ;
      389    14033              %B$TCB ;
      390    14036              %F$DCB;
      391    14093        %EJECT ;
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:64   
      392    14094        /*********************************************************************/
      393    14095        /*   Symref's        symref's        symref's        symref's        */
      394    14096        /*********************************************************************/
      395    14097                                                              /**/
      396    14098    1   DCL B$TCB$ PTR SYMREF ;
      397    14099        %EJECT ;
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:65   
      398    14100        /*********************************************************************/
      399    14101        /*   Parameters      parameters      parameters      parameters      */
      400    14102        /*********************************************************************/
      401    14103                                                                                      /**/
      402    14104    1   DCL PROJ$ PTR ;
      403    14105    1   DCL ARS UBIN ;
      404    14106    1   DCL SEG_TYPE UBIN;
      405    14107                                                                                      /**/
      406    14108        %EJECT;
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:66   
      407    14109        /*********************************************************************/
      408    14110        /*   Fpts            fpts            fpts            fpts            */
      409    14111        /*********************************************************************/
      410    14112                                                                                      /**/
      411    14113              %FPT_OPEN (FPTN=OPEN_CR_FPT ,
      412    14114                          NAME = FILE_NAME ,
      413    14115                          ACCT = FILE_ACCT ,
      414    14116                          ASN  = FILE ,
      415    14117                          DCB = M$PROJ ,
      416    14118                          ACS = DIRECT ,
      417    14119                          ORG = KEYED ,
      418    14120                          ACSVEH = VLP_ATTR ,
      419    14121                          ACCESS = VLP_ATTR_ACC ,
      420    14122                          FUN = CREATE ,
      421    14123                          IXTNSIZE = 8 ,
      422    14124                          XTNSIZE = 8 ,
      423    14125                          EXIST = OLDFILE) ;
      424    14234              %FPT_OPEN (FPTN=OPEN_UP_FPT ,
      425    14235                          NAME = FILE_NAME ,
      426    14236                          ACCT = FILE_ACCT ,
      427    14237                          ASN  = FILE ,
      428    14238                          DCB = M$PROJ ,
      429    14239                          ACS = DIRECT ,
      430    14240                          ORG = KEYED ,
      431    14241                          FUN = UPDATE ,
      432    14242                          SHARE = ALL) ;
      433    14351              %FPT_ENQ  ( FPTN = FPT_ENQ_PROJ ,
      434    14352                          DCB = M$PROJ ,
      435    14353                          RNAME = PROJ_KEY ,
      436    14354                          SHARE = NONE ) ;
      437    14372              %FPT_DEQ  ( FPTN = FPT_DEQ_PROJ ,
      438    14373                          DCB = M$PROJ ) ;
      439    14390              %FPT_CLOSE  (FPTN = CLOSE_FPT ,
      440    14391                           DCB = M$PROJ ,
      441    14392                           DISP = SAVE) ;
      442    14434              %FPT_READ  (FPTN = READ_FPT ,
      443    14435                          KEY = PROJ_KEY ,
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:67   
      444    14436                          DCB = M$PROJ ,
      445    14437                          KEYS = YES) ;
      446    14476              %FPT_WRITE  (FPTN = WRITE_FPT ,
      447    14477                           ONEWKEY = YES ,
      448    14478                           KEY = PROJ_KEY ,
      449    14479                           DCB = M$PROJ) ;
      450    14510              %FPT_DELREC  (FPTN = DELREC_FPT ,
      451    14511                            KEY = PROJ_KEY ,
      452    14512                            DCB = M$PROJ) ;
      453    14531              %FPT_PRECORD (FPTN = PREC_FPT,
      454    14532                            DCB = M$PROJ,
      455    14533                            KEY = PROJ_KEY,
      456    14534                            KEYS = YES,
      457    14535                            KEYR = YES,
      458    14536                            N = 0);
      459    14557              %FPT_READ    (FPTN = READ_SEQ_FPT ,
      460    14558                            KEY = PROJ_KEY ,
      461    14559                            DCB = M$PROJ ,
      462    14560                            KEYR = YES ,
      463    14561                            KEYS = NO ) ;
      464    14600              %FPT_PFIL    (FPTN = PFIL_FPT ,
      465    14601                            DCB = M$PROJ ,
      466    14602                            BOF = YES ) ;
      467    14617                                                                                      /**/
      468    14618        %EJECT;
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:68   
      469    14619        /*********************************************************************/
      470    14620        /*   Vlps            vlps            vlps            vlps            */
      471    14621        /*********************************************************************/
      472    14622                                                                                      /**/
      473    14623              %VLP_ATTR ;
      474    14637              %VLP_ACSVEH(  UPD = YES ,
      475    14638                            READ = YES ,
      476    14639                            DELR = YES,
      477    14640                            WNEW = YES,
      478    14641                            VEHICLE = 'SUPER' ) ;
      479    14658              %VLP_ACSVEH(  UPD = YES ,
      480    14659                            READ = YES ,
      481    14660                            VEHICLE = 'PIG' ,
      482    14661                            LAST=";") ;
      483    14678              %VLP_ATTR(  FPTN = VLP_ATTR_ACC ) ;
      484    14692              %VLP_ACCESS(  EXEC = YES ,
      485    14693                            ACCT = '?' ,
      486    14694                            LAST=";") ;
      487    14711        %EJECT ;
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:69   
      488    14712        /*********************************************************************/
      489    14713        /*   Dcbs            dcbs            dcbs            dcbs            */
      490    14714        /*********************************************************************/
      491    14715                                                                                      /**/
      492    14716    1   DCL M$PROJ DCB ;                                    /*  Read-write users record */
      493    14717                                                              /**/
      494    14718        %EJECT ;
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:70   
      495    14719        /*********************************************************************/
      496    14720        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
      497    14721        /*********************************************************************/
      498    14722                                                              /**/
      499    14723        %ASH$ERROR ;
      500    14726        %ASB$GET_MORE_SEG ;
      501    14729        %EJECT;
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:71   
      502    14730        /********************************************************************/
      503    14731        /*   Procedure       procedure       procedure       procedure       */
      504    14732        /*********************************************************************/
      505    14733                                                              /**/
      506    14734    1   ASB$READ_PROJ: ENTRY (PROJ$, ARS, SEG_TYPE) ALTRET;
      507    14735                                                              /*
      508    14736                                                                   Set BUF$ in read fpt
      509    14737                                                              */
      510    14738    1   READ_FPT.BUF_.BUF$ = PROJ$;
      511    14739    1   READ_REC:
      512    14740    1   READ_FPT.BUF_.BOUND = ARS - 1;
      513    14741    1   CALL M$READ (READ_FPT) ALTRET(READ_ERROR) ;
      514    14742    1   ARS = DCBADDR(DCBNUM(M$PROJ)) -> F$DCB.ARS# ;
      515    14743    1   RETURN ;
      516    14744
      517    14745    1   READ_ERROR:
      518    14746    1   MERR_CODE = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR ;
      519    14747    1   IF MERR_CODE.CODE = %E$LD
      520    14748    2   THEN DO;
      521    14749    2      IF ADDR(SEG_TYPE) = ADDR(NIL) THEN RETURN;  /* Lost data is ok */
      522    14750    2      CALL ASB$GET_MORE_SEG( SEG_TYPE, 4096 ) ALTRET(IO_ERROR);
      523    14751    2      ARS = ARS + 4096 ;
      524    14752    2      GOTO READ_REC ;
      525    14753    2      END;
      526    14754    1   AS_DCBNUM# = DCBNUM( M$PROJ );
      527    14755    1   ALTRETURN ;
      528    14756                                                                                      /**/
      529    14757    1   ASB$WRITE_PROJ: ENTRY (PROJ$, ARS) ALTRET;
      530    14758                                                              /*
      531    14759                                                                   Set BUF$ in write fpt
      532    14760                                                              */
      533    14761    1   WRITE_FPT.BUF_.BOUND = ARS - 1;
      534    14762    1   WRITE_FPT.BUF_.BUF$ = PROJ$;
      535    14763    1   CALL M$WRITE (WRITE_FPT) ALTRET(IO_ERROR) ;
      536    14764    1   RETURN ;
      537    14765                                                                                      /**/
      538    14766    1   ASB$DELREC_PROJ: ENTRY ALTRET;
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:72   
      539    14767    1   CALL M$DELREC (DELREC_FPT) ALTRET(IO_ERROR) ;
      540    14768    1   RETURN ;
      541    14769                                                                                      /**/
      542    14770    1   ASB$PREC_PROJ: ENTRY ALTRET;
      543    14771    1   CALL M$PRECORD (PREC_FPT) ALTRET(IO_ERROR) ;
      544    14772    1   RETURN ;
      545    14773                                                                                      /**/
      546    14774    1   ASB$OPEN_PROJ_CR: ENTRY ALTRET;
      547    14775    1   CALL M$OPEN (OPEN_CR_FPT) ALTRET(IO_ERROR) ;
      548    14776    1   RETURN ;
      549    14777                                                                                      /**/
      550    14778    1   ASB$OPEN_PROJ_UP: ENTRY  ALTRET;
      551    14779    1   CALL M$OPEN (OPEN_UP_FPT) ALTRET(IO_ERROR) ;
      552    14780    1   RETURN ;
      553    14781                                                                                      /**/
      554    14782    1   ASB$CLOSE_PROJ: ENTRY ALTRET;
      555    14783    1   CALL M$CLOSE (CLOSE_FPT) ;
      556    14784    1   RETURN ;
      557    14785                                                              /**/
      558    14786    1   ASB$READ_PROJ_SEQ: ENTRY (PROJ$, ARS, SEG_TYPE) ALTRET;
      559    14787    1   PROJ_KEY.TEXT = AS_BLANK;
      560    14788    1   READ_SEQ_FPT.BUF_.BUF$ = PROJ$;
      561    14789    1   READ_SEQ:
      562    14790    1   READ_SEQ_FPT.BUF_.BOUND = ARS - 1;
      563    14791    1   CALL M$READ(READ_SEQ_FPT) ALTRET ( READ_SEQ_ERR ) ;
      564    14792    1   ARS = DCBADDR(DCBNUM(M$PROJ)) -> F$DCB.ARS# ;
      565    14793    1   RETURN ;
      566    14794
      567    14795    1   READ_SEQ_ERR:
      568    14796    1   MERR_CODE = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR ;
      569    14797    1   IF MERR_CODE.CODE = %E$LD
      570    14798    2   THEN DO;
      571    14799    2      IF ADDR(SEG_TYPE) = ADDR(NIL) THEN RETURN;  /* Lost data is ok */
      572    14800    2      CALL ASB$GET_MORE_SEG( SEG_TYPE, 4096 ) ALTRET(IO_ERROR);
      573    14801    2      ARS = ARS + 4096 ;
      574    14802                                                       /* setup for precord */
      575    14803    2      PREC_FPT.V.KEYR# = AS_FALSE;
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:73   
      576    14804    2      PREC_FPT.V.KEYS# = AS_FALSE;
      577    14805    2      PREC_FPT.V.N# = -1;
      578    14806    2      CALL M$PRECORD (PREC_FPT) ALTRET (IO_ERROR);
      579    14807                                                       /* reset PREC_FPT */
      580    14808    2      PREC_FPT.V.KEYR# = AS_TRUE;
      581    14809    2      PREC_FPT.V.KEYS# = AS_TRUE;
      582    14810    2      PREC_FPT.V.N# = 0;
      583    14811    2      GOTO READ_SEQ;
      584    14812    2      END;
      585    14813    1   AS_DCBNUM# = DCBNUM( M$PROJ );
      586    14814    1   ALTRETURN ;
      587    14815                                                              /**/
      588    14816    1   ASB$BOF_PROJ: ENTRY ALTRET;
      589    14817    1   CALL M$PFIL(PFIL_FPT) ALTRET(IO_ERROR) ;
      590    14818    1   RETURN ;
      591    14819                                                                                      /**/
      592    14820    1   IO_ERROR: ;
      593    14821    1   MERR_CODE = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR ;
      594    14822    1   AS_DCBNUM# = DCBNUM( M$PROJ );
      595    14823    1   ALTRETURN ;
      596    14824                                                              /**/
      597    14825    1   ASB$ENQ_PROJ: ENTRY ALTRET ;
      598    14826    1   CALL M$ENQ( FPT_ENQ_PROJ ) ALTRET( ENQ_ERR1 ) ;
      599    14827    1   RETURN ;
      600    14828                                                              /**/
      601    14829    1   ENQ_ERR1: ;
      602    14830        /*E*  ERROR:    ASB-E$UNABLE_ENQ_PROJ-C
      603    14831              MESSAGE:  Unable to ENQ :PROJ.
      604    14832        */
      605    14833        %SCREAM( ERR#=E$UNABLE_ENQ_PROJ, LEVEL=ERROR, MID='B' );
      606    14848    1   ALTRETURN ;
      607    14849                                                              /**/
      608    14850    1   ASB$DEQ_PROJ: ENTRY ALTRET ;
      609    14851    1   CALL M$DEQ( FPT_DEQ_PROJ ) ALTRET( DEQ_ERR1 ) ;
      610    14852    1   RETURN ;
      611    14853                                                              /**/
      612    14854    1   DEQ_ERR1: ;
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:74   
      613    14855        /*E*  ERROR:    ASB-E$UNABLE_DEQ_PROJ-C
      614    14856              MESSAGE:  Unable to DEQ :PROJ.
      615    14857        */
      616    14858        %SCREAM( ERR#=E$UNABLE_DEQ_PROJ, LEVEL=ERROR, MID='B' );
      617    14873    1   ALTRETURN ;
      618    14874                                                              /**/
      619    14875                                                              /**/
      620    14876    1   END   ASB$PROJ ;
      621    14877        %EOD ;

PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:75   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASB$PROJ.

   Procedure ASB$PROJ requires 224 words for executable code.
   Procedure ASB$PROJ requires 8 words of local(AUTO) storage.

PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:76   

 Object Unit name= ASB$PROJ                                   File name= ASB$FILES.:E05TOU
 UTS= JUL 29 '97 09:14:39.24 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2  RoData even  UTS     10     12  ASB$PROJ
    3   Data  even  none   237    355  ASB$PROJ
    4   DCB   even  none     0      0  M$PROJ
    5   Proc  even  none   224    340  ASB$PROJ
    6  RoData even  none     5      5  ASB$PROJ

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes    yes     yes      Std        3  ASB$PROJ
     5      3          yes     yes      Std        3  ASB$READ_PROJ
     5     66          yes     yes      Std        2  ASB$WRITE_PROJ
     5    107          yes     yes      Std        0  ASB$DELREC_PROJ
     5    116          yes     yes      Std        0  ASB$PREC_PROJ
     5    125          yes     yes      Std        0  ASB$OPEN_PROJ_CR
     5    134          yes     yes      Std        0  ASB$OPEN_PROJ_UP
     5    143          yes     yes      Std        0  ASB$CLOSE_PROJ
     5    151          yes     yes      Std        3  ASB$READ_PROJ_SEQ
     5    272          yes     yes      Std        0  ASB$BOF_PROJ
     5    310          yes     yes      Std        0  ASB$ENQ_PROJ
     5    324          yes     yes      Std        0  ASB$DEQ_PROJ
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:77   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
 yes     yes           Std       2 ASB$GET_MORE_SEG
         yes           Std       2 ASH$ERROR
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    AS_BLANK                         r    AS_TRUE
r    AS_FALSE                         r    AS_MODE                          r    AS_FE_MODE
     M$LO                                  PROJ_KEY                              ERR_CODE
     REMEM_VAR                             REM_FCMD                              ASA_BRKS_LOC
     FILE_ACCT                             AS_DCBNUM#                            B$TCB$
     M$PROJ                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:78   


      328        1        /*M* ASB$PROJ -  procedure to manage the :PROJ file.       */
      329        2        /*T***********************************************************/
      330        3        /*T*                                                         */
      331        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      332        5        /*T*                                                         */
      333        6        /*T***********************************************************/
      334        7                                                              /**/
      335        8                                                                                      /**/
      336        9        ASB$PROJ: PROC ( PROJ$, ARS, SEG_TYPE ) ALTRET ;

      9  5 000000   000000 700200 xent  ASB$PROJ     TSX0  ! X66_AUTO_3
         5 000001   000010 000003                    ZERO    8,3
         5 000002   000005 710000 5                  TRA     s:14738

      337       10        /***********************************************************/
      338       11
      339       12        /*P*    NAME:     ASB$PROJ
      340       13                PURPOSE:  Manage the :PROJ file.
      341       14                DESCRIPTION:
      342       15                  ASB$PROJ has 11 entries:
      343       16
      344       17                      ASB$READ_PROJ - reads a record from :PROJ file.
      345       18                      ASB$WRITE_PROJ - writes a record to the :PROJ file.
      346       19                      ASB$DELREC_PROJ - deletes a record from the :PROJ file.
      347       20                      ASB$PREC_PROJ - positions to a record in the :PROJ file.
      348       21                      ASB$OPEN_PROJ_CR - creates the :PROJ file.
      349       22                      ASB$OPEN_PROJ_UP - opens :PROJ as an update file.
      350       23                      ASB$CLOSE_PROJ - closes the :PROJ file.
      351       24                      ASB$BOF_PROJ - positions to beginning of :PROJ file.
      352       25                      ASB$ENQ_PROJ - enqueues a record in the :PROJ file.
      353       26                      ASB$DEQ_PROJ - dequeues the :PROJ file.
      354       27        */
      355       28        /*******************************************************************/
      356       29                                                                                      /**/
      357       30        %EJECT;
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:79   
      358       31        /*********************************************************************/
      359       32        /*   Include files   include files   include files   include files   */
      360       33        /*********************************************************************/
      361       34                                                                                      /**/
      362       35              %INCLUDE CP_6            ;
      363      116              %INCLUDE AS_ENTRIES_M    ;
      364     1166              %INCLUDE AS_PERR_C       ;
      365     1768              %INCLUDE B_ERRORS_C      ;
      366     2895              %INCLUDE AS_MAC_C        ;
      367     2975              %INCLUDE AS_SUPER_C      ;
      368     3410              %INCLUDE AS_SUBS_C       ;
      369     4824              %INCLUDE XU_MACRO_C      ;
      370     7930              %INCLUDE KL_SUPER_C      ;
      371    10832              %INCLUDE XU_FORMAT_C     ;
      372    10994              %INCLUDE AS_SUPER_R      ;
      373    14010                                                                                      /**/
      374    14011        %EJECT;
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:80   
      375    14012        /*********************************************************************/
      376    14013        /*   Static data     static data     static data     static data     */
      377    14014        /*********************************************************************/
      378    14015                                                                                      /**/
      379    14016    1   DCL 1 FILE_NAME CONSTANT ,
      380    14017    1          2 COUNT UBIN(9) UNAL INIT(5) ,
      381    14018    1          2 TEXT CHAR(31) UNAL INIT(':PROJ') ;
      382    14019                                                                                      /**/
      383    14020        %EJECT;
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:81   
      384    14021        /*********************************************************************/
      385    14022        /*   Local based     local based     local based     local based     */
      386    14023        /*********************************************************************/
      387    14024                                                              /**/
      388    14025              %B$ALT ;
      389    14033              %B$TCB ;
      390    14036              %F$DCB;
      391    14093        %EJECT ;
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:82   
      392    14094        /*********************************************************************/
      393    14095        /*   Symref's        symref's        symref's        symref's        */
      394    14096        /*********************************************************************/
      395    14097                                                              /**/
      396    14098    1   DCL B$TCB$ PTR SYMREF ;
      397    14099        %EJECT ;
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:83   
      398    14100        /*********************************************************************/
      399    14101        /*   Parameters      parameters      parameters      parameters      */
      400    14102        /*********************************************************************/
      401    14103                                                                                      /**/
      402    14104    1   DCL PROJ$ PTR ;
      403    14105    1   DCL ARS UBIN ;
      404    14106    1   DCL SEG_TYPE UBIN;
      405    14107                                                                                      /**/
      406    14108        %EJECT;
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:84   
      407    14109        /*********************************************************************/
      408    14110        /*   Fpts            fpts            fpts            fpts            */
      409    14111        /*********************************************************************/
      410    14112                                                                                      /**/
      411    14113              %FPT_OPEN (FPTN=OPEN_CR_FPT ,
      412    14114                          NAME = FILE_NAME ,
      413    14115                          ACCT = FILE_ACCT ,
      414    14116                          ASN  = FILE ,
      415    14117                          DCB = M$PROJ ,
      416    14118                          ACS = DIRECT ,
      417    14119                          ORG = KEYED ,
      418    14120                          ACSVEH = VLP_ATTR ,
      419    14121                          ACCESS = VLP_ATTR_ACC ,
      420    14122                          FUN = CREATE ,
      421    14123                          IXTNSIZE = 8 ,
      422    14124                          XTNSIZE = 8 ,
      423    14125                          EXIST = OLDFILE) ;
      424    14234              %FPT_OPEN (FPTN=OPEN_UP_FPT ,
      425    14235                          NAME = FILE_NAME ,
      426    14236                          ACCT = FILE_ACCT ,
      427    14237                          ASN  = FILE ,
      428    14238                          DCB = M$PROJ ,
      429    14239                          ACS = DIRECT ,
      430    14240                          ORG = KEYED ,
      431    14241                          FUN = UPDATE ,
      432    14242                          SHARE = ALL) ;
      433    14351              %FPT_ENQ  ( FPTN = FPT_ENQ_PROJ ,
      434    14352                          DCB = M$PROJ ,
      435    14353                          RNAME = PROJ_KEY ,
      436    14354                          SHARE = NONE ) ;
      437    14372              %FPT_DEQ  ( FPTN = FPT_DEQ_PROJ ,
      438    14373                          DCB = M$PROJ ) ;
      439    14390              %FPT_CLOSE  (FPTN = CLOSE_FPT ,
      440    14391                           DCB = M$PROJ ,
      441    14392                           DISP = SAVE) ;
      442    14434              %FPT_READ  (FPTN = READ_FPT ,
      443    14435                          KEY = PROJ_KEY ,
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:85   
      444    14436                          DCB = M$PROJ ,
      445    14437                          KEYS = YES) ;
      446    14476              %FPT_WRITE  (FPTN = WRITE_FPT ,
      447    14477                           ONEWKEY = YES ,
      448    14478                           KEY = PROJ_KEY ,
      449    14479                           DCB = M$PROJ) ;
      450    14510              %FPT_DELREC  (FPTN = DELREC_FPT ,
      451    14511                            KEY = PROJ_KEY ,
      452    14512                            DCB = M$PROJ) ;
      453    14531              %FPT_PRECORD (FPTN = PREC_FPT,
      454    14532                            DCB = M$PROJ,
      455    14533                            KEY = PROJ_KEY,
      456    14534                            KEYS = YES,
      457    14535                            KEYR = YES,
      458    14536                            N = 0);
      459    14557              %FPT_READ    (FPTN = READ_SEQ_FPT ,
      460    14558                            KEY = PROJ_KEY ,
      461    14559                            DCB = M$PROJ ,
      462    14560                            KEYR = YES ,
      463    14561                            KEYS = NO ) ;
      464    14600              %FPT_PFIL    (FPTN = PFIL_FPT ,
      465    14601                            DCB = M$PROJ ,
      466    14602                            BOF = YES ) ;
      467    14617                                                                                      /**/
      468    14618        %EJECT;
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:86   
      469    14619        /*********************************************************************/
      470    14620        /*   Vlps            vlps            vlps            vlps            */
      471    14621        /*********************************************************************/
      472    14622                                                                                      /**/
      473    14623              %VLP_ATTR ;
      474    14637              %VLP_ACSVEH(  UPD = YES ,
      475    14638                            READ = YES ,
      476    14639                            DELR = YES,
      477    14640                            WNEW = YES,
      478    14641                            VEHICLE = 'SUPER' ) ;
      479    14658              %VLP_ACSVEH(  UPD = YES ,
      480    14659                            READ = YES ,
      481    14660                            VEHICLE = 'PIG' ,
      482    14661                            LAST=";") ;
      483    14678              %VLP_ATTR(  FPTN = VLP_ATTR_ACC ) ;
      484    14692              %VLP_ACCESS(  EXEC = YES ,
      485    14693                            ACCT = '?' ,
      486    14694                            LAST=";") ;
      487    14711        %EJECT ;
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:87   
      488    14712        /*********************************************************************/
      489    14713        /*   Dcbs            dcbs            dcbs            dcbs            */
      490    14714        /*********************************************************************/
      491    14715                                                                                      /**/
      492    14716    1   DCL M$PROJ DCB ;                                    /*  Read-write users record */
      493    14717                                                              /**/
      494    14718        %EJECT ;
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:88   
      495    14719        /*********************************************************************/
      496    14720        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
      497    14721        /*********************************************************************/
      498    14722                                                              /**/
      499    14723        %ASH$ERROR ;
      500    14726        %ASB$GET_MORE_SEG ;
      501    14729        %EJECT;
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:89   
      502    14730        /********************************************************************/
      503    14731        /*   Procedure       procedure       procedure       procedure       */
      504    14732        /*********************************************************************/
      505    14733                                                              /**/
      506    14734    1   ASB$READ_PROJ: ENTRY (PROJ$, ARS, SEG_TYPE) ALTRET;

  14734  5 000003   000000 700200 xent  ASB$READ_PR* TSX0  ! X66_AUTO_3
         5 000004   000010 000003                    ZERO    8,3

      507    14735                                                              /*
      508    14736                                                                   Set BUF$ in read fpt
      509    14737                                                              */
      510    14738    1   READ_FPT.BUF_.BUF$ = PROJ$;

  14738  5 000005   200003 470500                    LDP0    @PROJ$,,AUTO
         5 000006   000000 236100                    LDQ     0,,PR0
         5 000007   000251 756000 3                  STQ     READ_FPT+5

      511    14739    1   READ_REC:
      512    14740    1   READ_FPT.BUF_.BOUND = ARS - 1;

  14740  5 000010   200004 470500       READ_REC     LDP0    @ARS,,AUTO
         5 000011   000000 236100                    LDQ     0,,PR0
         5 000012   000001 136007                    SBLQ    1,DL
         5 000013   000020 736000                    QLS     16
         5 000014   000250 676000 3                  ERQ     READ_FPT+4
         5 000015   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 000016   000250 656000 3                  ERSQ    READ_FPT+4

      513    14741    1   CALL M$READ (READ_FPT) ALTRET(READ_ERROR) ;

  14741  5 000017   000244 630400 3                  EPPR0   READ_FPT
         5 000020   440000 713400                    CLIMB   alt,read
         5 000021   401400 401760                    pmme    nvectors=4
         5 000022   000033 702000 5                  TSX2    READ_ERROR

      514    14742    1   ARS = DCBADDR(DCBNUM(M$PROJ)) -> F$DCB.ARS# ;
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:90   

  14742  5 000023   000000 236007 xsym               LDQ     M$PROJ,DL
         5 000024   000000 470400 6                  LDP0    0
         5 000025   000000 471500                    LDP1    0,,PR0
         5 000026   100000 473506                    LDP3    0,QL,PR1
         5 000027   300000 235100                    LDA     0,,PR3
         5 000030   200004 473500                    LDP3    @ARS,,AUTO
         5 000031   300000 755100                    STA     0,,PR3

      515    14743    1   RETURN ;

  14743  5 000032   000000 702200 xent               TSX2  ! X66_ARET

      516    14744
      517    14745    1   READ_ERROR:
      518    14746    1   MERR_CODE = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR ;

  14746  5 000033   000000 470400 xsym  READ_ERROR   LDP0    B$TCB$
         5 000034   000000 471500                    LDP1    0,,PR0
         5 000035   100102 236100                    LDQ     66,,PR1
         5 000036   000000 756000 xsym               STQ     ERR_CODE

      519    14747    1   IF MERR_CODE.CODE = %E$LD

  14747  5 000037   000000 236000 xsym               LDQ     ERR_CODE
         5 000040   377770 376007                    ANQ     131064,DL
         5 000041   000070 116007                    CMPQ    56,DL
         5 000042   000063 601000 5                  TNZ     s:14754

      520    14748    2   THEN DO;

      521    14749    2      IF ADDR(SEG_TYPE) = ADDR(NIL) THEN RETURN;  /* Lost data is ok */

  14749  5 000043   200005 236100                    LDQ     @SEG_TYPE,,AUTO
         5 000044   000001 116000 xsym               CMPQ    B_VECTNIL+1
         5 000045   000047 601000 5                  TNZ     s:14750

PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:91   
  14749  5 000046   000000 702200 xent               TSX2  ! X66_ARET

      522    14750    2      CALL ASB$GET_MORE_SEG( SEG_TYPE, 4096 ) ALTRET(IO_ERROR);

  14750  5 000047   000002 236000 6                  LDQ     2
         5 000050   200005 235100                    LDA     @SEG_TYPE,,AUTO
         5 000051   200006 757100                    STAQ    @SEG_TYPE+1,,AUTO
         5 000052   200006 630500                    EPPR0   @SEG_TYPE+1,,AUTO
         5 000053   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000054   000000 701000 xent               TSX1    ASB$GET_MORE_SEG
         5 000055   000301 702000 5                  TSX2    IO_ERROR

      523    14751    2      ARS = ARS + 4096 ;

  14751  5 000056   200004 470500                    LDP0    @ARS,,AUTO
         5 000057   000000 235100                    LDA     0,,PR0
         5 000060   010000 035007                    ADLA    4096,DL
         5 000061   000000 755100                    STA     0,,PR0

      524    14752    2      GOTO READ_REC ;

  14752  5 000062   000010 710000 5                  TRA     READ_REC

      525    14753    2      END;
      526    14754    1   AS_DCBNUM# = DCBNUM( M$PROJ );

  14754  5 000063   000000 236007 xsym               LDQ     M$PROJ,DL
         5 000064   000000 756000 xsym               STQ     AS_DCBNUM#

      527    14755    1   ALTRETURN ;

  14755  5 000065   000000 702200 xent               TSX2  ! X66_AALT

      528    14756                                                                                      /**/
      529    14757    1   ASB$WRITE_PROJ: ENTRY (PROJ$, ARS) ALTRET;

  14757  5 000066   000000 700200 xent  ASB$WRITE_P* TSX0  ! X66_AUTO_3
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:92   
         5 000067   000010 000003                    ZERO    8,3

      530    14758                                                              /*
      531    14759                                                                   Set BUF$ in write fpt
      532    14760                                                              */
      533    14761    1   WRITE_FPT.BUF_.BOUND = ARS - 1;

  14761  5 000070   200004 470500                    LDP0    @ARS,,AUTO
         5 000071   000000 236100                    LDQ     0,,PR0
         5 000072   000001 136007                    SBLQ    1,DL
         5 000073   000020 736000                    QLS     16
         5 000074   000266 676000 3                  ERQ     WRITE_FPT+4
         5 000075   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 000076   000266 656000 3                  ERSQ    WRITE_FPT+4

      534    14762    1   WRITE_FPT.BUF_.BUF$ = PROJ$;

  14762  5 000077   200003 471500                    LDP1    @PROJ$,,AUTO
         5 000100   100000 236100                    LDQ     0,,PR1
         5 000101   000267 756000 3                  STQ     WRITE_FPT+5

      535    14763    1   CALL M$WRITE (WRITE_FPT) ALTRET(IO_ERROR) ;

  14763  5 000102   000262 630400 3                  EPPR0   WRITE_FPT
         5 000103   440001 713400                    CLIMB   alt,write
         5 000104   401400 401760                    pmme    nvectors=4
         5 000105   000301 702000 5                  TSX2    IO_ERROR

      536    14764    1   RETURN ;

  14764  5 000106   000000 702200 xent               TSX2  ! X66_ARET

      537    14765                                                                                      /**/
      538    14766    1   ASB$DELREC_PROJ: ENTRY ALTRET;

  14766  5 000107   000000 700200 xent  ASB$DELREC_* TSX0  ! X66_AUTO_3
         5 000110   000010 000003                    ZERO    8,3
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:93   

      539    14767    1   CALL M$DELREC (DELREC_FPT) ALTRET(IO_ERROR) ;

  14767  5 000111   000276 630400 3                  EPPR0   DELREC_FPT
         5 000112   440002 713400                    CLIMB   alt,+16386
         5 000113   401400 401760                    pmme    nvectors=4
         5 000114   000301 702000 5                  TSX2    IO_ERROR

      540    14768    1   RETURN ;

  14768  5 000115   000000 702200 xent               TSX2  ! X66_ARET

      541    14769                                                                                      /**/
      542    14770    1   ASB$PREC_PROJ: ENTRY ALTRET;

  14770  5 000116   000000 700200 xent  ASB$PREC_PR* TSX0  ! X66_AUTO_3
         5 000117   000010 000003                    ZERO    8,3

      543    14771    1   CALL M$PRECORD (PREC_FPT) ALTRET(IO_ERROR) ;

  14771  5 000120   000310 630400 3                  EPPR0   PREC_FPT
         5 000121   440003 713400                    CLIMB   alt,+16387
         5 000122   401000 401760                    pmme    nvectors=3
         5 000123   000301 702000 5                  TSX2    IO_ERROR

      544    14772    1   RETURN ;

  14772  5 000124   000000 702200 xent               TSX2  ! X66_ARET

      545    14773                                                                                      /**/
      546    14774    1   ASB$OPEN_PROJ_CR: ENTRY ALTRET;

  14774  5 000125   000000 700200 xent  ASB$OPEN_PR* TSX0  ! X66_AUTO_3
         5 000126   000010 000003                    ZERO    8,3

      547    14775    1   CALL M$OPEN (OPEN_CR_FPT) ALTRET(IO_ERROR) ;

PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:94   
  14775  5 000127   000000 630400 3                  EPPR0   OPEN_CR_FPT
         5 000130   450000 713400                    CLIMB   alt,open
         5 000131   410400 401760                    pmme    nvectors=18
         5 000132   000301 702000 5                  TSX2    IO_ERROR

      548    14776    1   RETURN ;

  14776  5 000133   000000 702200 xent               TSX2  ! X66_ARET

      549    14777                                                                                      /**/
      550    14778    1   ASB$OPEN_PROJ_UP: ENTRY  ALTRET;

  14778  5 000134   000000 700200 xent  ASB$OPEN_PR* TSX0  ! X66_AUTO_3
         5 000135   000010 000003                    ZERO    8,3

      551    14779    1   CALL M$OPEN (OPEN_UP_FPT) ALTRET(IO_ERROR) ;

  14779  5 000136   000072 630400 3                  EPPR0   OPEN_UP_FPT
         5 000137   450000 713400                    CLIMB   alt,open
         5 000140   410400 401760                    pmme    nvectors=18
         5 000141   000301 702000 5                  TSX2    IO_ERROR

      552    14780    1   RETURN ;

  14780  5 000142   000000 702200 xent               TSX2  ! X66_ARET

      553    14781                                                                                      /**/
      554    14782    1   ASB$CLOSE_PROJ: ENTRY ALTRET;

  14782  5 000143   000000 700200 xent  ASB$CLOSE_P* TSX0  ! X66_AUTO_3
         5 000144   000010 000003                    ZERO    8,3

      555    14783    1   CALL M$CLOSE (CLOSE_FPT) ;

  14783  5 000145   000206 630400 3                  EPPR0   CLOSE_FPT
         5 000146   050001 713400                    CLIMB   close
         5 000147   406000 401760                    pmme    nvectors=13
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:95   

      556    14784    1   RETURN ;

  14784  5 000150   000000 702200 xent               TSX2  ! X66_ARET

      557    14785                                                              /**/
      558    14786    1   ASB$READ_PROJ_SEQ: ENTRY (PROJ$, ARS, SEG_TYPE) ALTRET;

  14786  5 000151   000000 700200 xent  ASB$READ_PR* TSX0  ! X66_AUTO_3
         5 000152   000010 000003                    ZERO    8,3

      559    14787    1   PROJ_KEY.TEXT = AS_BLANK;

  14787  5 000153   040000 100400                    MLR     fill='040'O
         5 000154   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         5 000155   000000 200032 xsym               ADSC9   PROJ_KEY                 cn=1,n=26

      560    14788    1   READ_SEQ_FPT.BUF_.BUF$ = PROJ$;

  14788  5 000156   200003 470500                    LDP0    @PROJ$,,AUTO
         5 000157   000000 236100                    LDQ     0,,PR0
         5 000160   000327 756000 3                  STQ     READ_SEQ_FPT+5

      561    14789    1   READ_SEQ:
      562    14790    1   READ_SEQ_FPT.BUF_.BOUND = ARS - 1;

  14790  5 000161   200004 470500       READ_SEQ     LDP0    @ARS,,AUTO
         5 000162   000000 236100                    LDQ     0,,PR0
         5 000163   000001 136007                    SBLQ    1,DL
         5 000164   000020 736000                    QLS     16
         5 000165   000326 676000 3                  ERQ     READ_SEQ_FPT+4
         5 000166   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 000167   000326 656000 3                  ERSQ    READ_SEQ_FPT+4

      563    14791    1   CALL M$READ(READ_SEQ_FPT) ALTRET ( READ_SEQ_ERR ) ;

  14791  5 000170   000322 630400 3                  EPPR0   READ_SEQ_FPT
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:96   
         5 000171   440000 713400                    CLIMB   alt,read
         5 000172   401400 401760                    pmme    nvectors=4
         5 000173   000204 702000 5                  TSX2    READ_SEQ_ERR

      564    14792    1   ARS = DCBADDR(DCBNUM(M$PROJ)) -> F$DCB.ARS# ;

  14792  5 000174   000000 236007 xsym               LDQ     M$PROJ,DL
         5 000175   000000 470400 6                  LDP0    0
         5 000176   000000 471500                    LDP1    0,,PR0
         5 000177   100000 473506                    LDP3    0,QL,PR1
         5 000200   300000 235100                    LDA     0,,PR3
         5 000201   200004 473500                    LDP3    @ARS,,AUTO
         5 000202   300000 755100                    STA     0,,PR3

      565    14793    1   RETURN ;

  14793  5 000203   000000 702200 xent               TSX2  ! X66_ARET

      566    14794
      567    14795    1   READ_SEQ_ERR:
      568    14796    1   MERR_CODE = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR ;

  14796  5 000204   000000 470400 xsym  READ_SEQ_ERR LDP0    B$TCB$
         5 000205   000000 471500                    LDP1    0,,PR0
         5 000206   100102 236100                    LDQ     66,,PR1
         5 000207   000000 756000 xsym               STQ     ERR_CODE

      569    14797    1   IF MERR_CODE.CODE = %E$LD

  14797  5 000210   000000 236000 xsym               LDQ     ERR_CODE
         5 000211   377770 376007                    ANQ     131064,DL
         5 000212   000070 116007                    CMPQ    56,DL
         5 000213   000267 601000 5                  TNZ     s:14813

      570    14798    2   THEN DO;

      571    14799    2      IF ADDR(SEG_TYPE) = ADDR(NIL) THEN RETURN;  /* Lost data is ok */
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:97   

  14799  5 000214   200005 236100                    LDQ     @SEG_TYPE,,AUTO
         5 000215   000001 116000 xsym               CMPQ    B_VECTNIL+1
         5 000216   000220 601000 5                  TNZ     s:14800

  14799  5 000217   000000 702200 xent               TSX2  ! X66_ARET

      572    14800    2      CALL ASB$GET_MORE_SEG( SEG_TYPE, 4096 ) ALTRET(IO_ERROR);

  14800  5 000220   000002 236000 6                  LDQ     2
         5 000221   200005 235100                    LDA     @SEG_TYPE,,AUTO
         5 000222   200006 757100                    STAQ    @SEG_TYPE+1,,AUTO
         5 000223   200006 630500                    EPPR0   @SEG_TYPE+1,,AUTO
         5 000224   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000225   000000 701000 xent               TSX1    ASB$GET_MORE_SEG
         5 000226   000301 702000 5                  TSX2    IO_ERROR

      573    14801    2      ARS = ARS + 4096 ;

  14801  5 000227   200004 470500                    LDP0    @ARS,,AUTO
         5 000230   000000 235100                    LDA     0,,PR0
         5 000231   010000 035007                    ADLA    4096,DL
         5 000232   000000 755100                    STA     0,,PR0

      574    14802                                                       /* setup for precord */
      575    14803    2      PREC_FPT.V.KEYR# = AS_FALSE;

  14803  5 000233   000000 236000 xsym               LDQ     AS_FALSE
         5 000234   000023 772000                    QRL     19
         5 000235   000316 676000 3                  ERQ     PREC_FPT+6
         5 000236   200000 376007                    ANQ     65536,DL
         5 000237   000316 656000 3                  ERSQ    PREC_FPT+6

      576    14804    2      PREC_FPT.V.KEYS# = AS_FALSE;

  14804  5 000240   000000 236000 xsym               LDQ     AS_FALSE
         5 000241   000022 772000                    QRL     18
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:98   
         5 000242   000316 676000 3                  ERQ     PREC_FPT+6
         5 000243   400000 376007                    ANQ     -131072,DL
         5 000244   000316 656000 3                  ERSQ    PREC_FPT+6

      577    14805    2      PREC_FPT.V.N# = -1;

  14805  5 000245   000001 335007                    LCA     1,DL
         5 000246   000317 755000 3                  STA     PREC_FPT+7

      578    14806    2      CALL M$PRECORD (PREC_FPT) ALTRET (IO_ERROR);

  14806  5 000247   000310 630400 3                  EPPR0   PREC_FPT
         5 000250   440003 713400                    CLIMB   alt,+16387
         5 000251   401000 401760                    pmme    nvectors=3
         5 000252   000301 702000 5                  TSX2    IO_ERROR

      579    14807                                                       /* reset PREC_FPT */
      580    14808    2      PREC_FPT.V.KEYR# = AS_TRUE;

  14808  5 000253   000000 236000 xsym               LDQ     AS_TRUE
         5 000254   000023 772000                    QRL     19
         5 000255   000316 676000 3                  ERQ     PREC_FPT+6
         5 000256   200000 376007                    ANQ     65536,DL
         5 000257   000316 656000 3                  ERSQ    PREC_FPT+6

      581    14809    2      PREC_FPT.V.KEYS# = AS_TRUE;

  14809  5 000260   000000 236000 xsym               LDQ     AS_TRUE
         5 000261   000022 772000                    QRL     18
         5 000262   000316 676000 3                  ERQ     PREC_FPT+6
         5 000263   400000 376007                    ANQ     -131072,DL
         5 000264   000316 656000 3                  ERSQ    PREC_FPT+6

      582    14810    2      PREC_FPT.V.N# = 0;

  14810  5 000265   000317 450000 3                  STZ     PREC_FPT+7

PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:99   
      583    14811    2      GOTO READ_SEQ;

  14811  5 000266   000161 710000 5                  TRA     READ_SEQ

      584    14812    2      END;
      585    14813    1   AS_DCBNUM# = DCBNUM( M$PROJ );

  14813  5 000267   000000 236007 xsym               LDQ     M$PROJ,DL
         5 000270   000000 756000 xsym               STQ     AS_DCBNUM#

      586    14814    1   ALTRETURN ;

  14814  5 000271   000000 702200 xent               TSX2  ! X66_AALT

      587    14815                                                              /**/
      588    14816    1   ASB$BOF_PROJ: ENTRY ALTRET;

  14816  5 000272   000000 700200 xent  ASB$BOF_PROJ TSX0  ! X66_AUTO_3
         5 000273   000010 000003                    ZERO    8,3

      589    14817    1   CALL M$PFIL(PFIL_FPT) ALTRET(IO_ERROR) ;

  14817  5 000274   000340 630400 3                  EPPR0   PFIL_FPT
         5 000275   440004 713400                    CLIMB   alt,+16388
         5 000276   400000 401760                    pmme    nvectors=1
         5 000277   000301 702000 5                  TSX2    IO_ERROR

      590    14818    1   RETURN ;

  14818  5 000300   000000 702200 xent               TSX2  ! X66_ARET

  14813  5 000301                       IO_ERROR     null
      591    14819                                                                                      /**/
      592    14820    1   IO_ERROR: ;
      593    14821    1   MERR_CODE = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR ;

  14821  5 000301   000000 470400 xsym               LDP0    B$TCB$
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:100  
         5 000302   000000 471500                    LDP1    0,,PR0
         5 000303   100102 236100                    LDQ     66,,PR1
         5 000304   000000 756000 xsym               STQ     ERR_CODE

      594    14822    1   AS_DCBNUM# = DCBNUM( M$PROJ );

  14822  5 000305   000000 236007 xsym               LDQ     M$PROJ,DL
         5 000306   000000 756000 xsym               STQ     AS_DCBNUM#

      595    14823    1   ALTRETURN ;

  14823  5 000307   000000 702200 xent               TSX2  ! X66_AALT

      596    14824                                                              /**/
      597    14825    1   ASB$ENQ_PROJ: ENTRY ALTRET ;

  14825  5 000310   000000 700200 xent  ASB$ENQ_PROJ TSX0  ! X66_AUTO_3
         5 000311   000010 000003                    ZERO    8,3

      598    14826    1   CALL M$ENQ( FPT_ENQ_PROJ ) ALTRET( ENQ_ERR1 ) ;

  14826  5 000312   000164 630400 3                  EPPR0   FPT_ENQ_PROJ
         5 000313   420002 713400                    CLIMB   alt,+8194
         5 000314   401000 401760                    pmme    nvectors=3
         5 000315   000317 702000 5                  TSX2    ENQ_ERR1

      599    14827    1   RETURN ;

  14827  5 000316   000000 702200 xent               TSX2  ! X66_ARET

  14822  5 000317                       ENQ_ERR1     null
      600    14828                                                              /**/
      601    14829    1   ENQ_ERR1: ;
      602    14830        /*E*  ERROR:    ASB-E$UNABLE_ENQ_PROJ-C
      603    14831              MESSAGE:  Unable to ENQ :PROJ.
      604    14832        */
      605    14833        %SCREAM( ERR#=E$UNABLE_ENQ_PROJ, LEVEL=ERROR, MID='B' );
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:101  

  14845  5 000317   000003 630400 6                  EPPR0   3
         5 000320   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000321   000000 701000 xent               TSX1    ASH$ERROR
         5 000322   000000 011000                    NOP     0

      606    14848    1   ALTRETURN ;

  14848  5 000323   000000 702200 xent               TSX2  ! X66_AALT

      607    14849                                                              /**/
      608    14850    1   ASB$DEQ_PROJ: ENTRY ALTRET ;

  14850  5 000324   000000 700200 xent  ASB$DEQ_PROJ TSX0  ! X66_AUTO_3
         5 000325   000010 000003                    ZERO    8,3

      609    14851    1   CALL M$DEQ( FPT_DEQ_PROJ ) ALTRET( DEQ_ERR1 ) ;

  14851  5 000326   000176 630400 3                  EPPR0   FPT_DEQ_PROJ
         5 000327   420003 713400                    CLIMB   alt,+8195
         5 000330   401000 401760                    pmme    nvectors=3
         5 000331   000333 702000 5                  TSX2    DEQ_ERR1

      610    14852    1   RETURN ;

  14852  5 000332   000000 702200 xent               TSX2  ! X66_ARET

  14852  5 000333                       DEQ_ERR1     null
      611    14853                                                              /**/
      612    14854    1   DEQ_ERR1: ;
      613    14855        /*E*  ERROR:    ASB-E$UNABLE_DEQ_PROJ-C
      614    14856              MESSAGE:  Unable to DEQ :PROJ.
      615    14857        */
      616    14858        %SCREAM( ERR#=E$UNABLE_DEQ_PROJ, LEVEL=ERROR, MID='B' );

  14870  5 000333   000004 630400 6                  EPPR0   4
         5 000334   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:102  
         5 000335   000000 701000 xent               TSX1    ASH$ERROR
         5 000336   000000 011000                    NOP     0

      617    14873    1   ALTRETURN ;

  14873  5 000337   000000 702200 xent               TSX2  ! X66_AALT
      618    14874                                                              /**/
      619    14875                                                              /**/
      620    14876    1   END   ASB$PROJ ;
      621    14877        %EOD ;

PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:103  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASB$PROJ.
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:104  

 **** Variables and constants ****

  ****  Section 002 RoData ASB$PROJ

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(288)   r     1 FILE_NAME

  ****  Section 003  Data  ASB$PROJ

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   206-0-0/d STRC(1080)  r     1 CLOSE_FPT                276-0-0/d STRC(360)   r     1 DELREC_FPT
   176-0-0/d STRC(288)   r     1 FPT_DEQ_PROJ             164-0-0/d STRC(360)   r     1 FPT_ENQ_PROJ
     0-0-0/d STRC(2088)  r     1 OPEN_CR_FPT               72-0-0/d STRC(2088)  r     1 OPEN_UP_FPT
   340-0-0/d STRC(144)   r     1 PFIL_FPT                 310-0-0/d STRC(360)   r     1 PREC_FPT
   244-0-0/d STRC(504)   r     1 READ_FPT                 322-0-0/d STRC(504)   r     1 READ_SEQ_FPT
   344-0-0/w STRC(162)   r     1 VLP_ATTR                 351-0-0/w STRC(126)   r     1 VLP_ATTR_ACC
   262-0-0/d STRC(432)   r     1 WRITE_FPT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @ARS                       3-0-0/w PTR         r     1 @PROJ$
     5-0-0/w PTR         r     1 @SEG_TYPE                 *0-0-0/w UBIN        r     1 ARS
    *0-0-0/w PTR         r     1 PROJ$                     *0-0-0/w UBIN        r     1 SEG_TYPE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/w UBIN        r     1 AS_DCBNUM#
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:105  
     0-0-0/b BIT         r     1 AS_FALSE                   0-0-0/b BIT         r     1 AS_TRUE
     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/b STRC        r     1 ERR_CODE
     0-0-0/c STRC(72)    r     1 FILE_ACCT                  0-0-0/b STRC        r     1 MERR_CODE
     0-0-0/c STRC(243)   r     1 PROJ_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$PROJ


   Procedure ASB$PROJ requires 224 words for executable code.
   Procedure ASB$PROJ requires 8 words of local(AUTO) storage.
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:106  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:107  
          MINI XREF LISTING

ARS
     14105**DCL         9--PROC    14734--ENTRY   14740>>ASSIGN  14742<<ASSIGN  14751<<ASSIGN  14751>>ASSIGN
     14757--ENTRY   14761>>ASSIGN  14786--ENTRY   14790>>ASSIGN  14792<<ASSIGN  14801<<ASSIGN  14801>>ASSIGN
ASA_BRKS_LOC
     11158**DCL     11158--REDEF
ASB$GET_MORE_SEG
     14727**DCL-ENT 14750--CALL    14800--CALL
ASH$ERROR
     14724**DCL-ENT 14845--CALL    14870--CALL
AS_BLANK
     11018**DCL     14787>>ASSIGN
AS_DCBNUM#
     11165**DCL     14754<<ASSIGN  14813<<ASSIGN  14822<<ASSIGN
AS_DEFAULT.BANNER_PERM
     11851**DCL     11852--REDEF
AS_DEFAULT.BUDGET.MACCT
     11756**DCL     11760--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     11769**DCL     11772--REDEF
AS_DEFAULT.BUDGET.PACCUM
     11752**DCL     11754--REDEF
AS_DEFAULT.BUDGET.PMAXC
     11747**DCL     11749--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     11867**DCL     11868--REDEF   11869--REDEF
AS_DEFAULT_DREC.PASSWORD
     13121**DCL     13125--REDEF
AS_DEFAULT_DREC.RENAME
     13144**DCL     13145--REDEF
AS_DFLT.BANNER_PERM
     11673**DCL     11674--REDEF
AS_DFLT.BUDGET.MACCT
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:108  
     11578**DCL     11582--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     11591**DCL     11594--REDEF
AS_DFLT.BUDGET.PACCUM
     11574**DCL     11576--REDEF
AS_DFLT.BUDGET.PMAXC
     11569**DCL     11571--REDEF
AS_DFLT.SETUP_CHRA.TXT
     11689**DCL     11690--REDEF   11691--REDEF
AS_FALSE
     11018**DCL     14803>>ASSIGN  14804>>ASSIGN
AS_FE_MODE
     11024**DCL     11025--REDEF
AS_MODE
     11021**DCL     11023--REDEF
AS_MOD_USER.ACCESS
     13886**DCL     13887--REDEF
AS_MOD_USER.BANNER
     13873**DCL     13874--REDEF
AS_MOD_USER.BANNER_PERM
     13875**DCL     13876--REDEF
AS_MOD_USER.BILL
     13881**DCL     13882--REDEF
AS_MOD_USER.CPROC
     13877**DCL     13878--REDEF
AS_MOD_USER.FEBILL
     13957**DCL     13958--REDEF
AS_MOD_USER.FECXTMEM
     13974**DCL     13975--REDEF
AS_MOD_USER.FEMINTS
     13959**DCL     13960--REDEF
AS_MOD_USER.FEMMEM
     13970**DCL     13971--REDEF
AS_MOD_USER.FEMTIME
     13968**DCL     13969--REDEF
AS_MOD_USER.FEPPRIV
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:109  
     13965**DCL     13967--REDEF
AS_MOD_USER.FEPRIV
     13962**DCL     13964--REDEF
AS_MOD_USER.FORCE_BIT
     13871**DCL     13872--REDEF
AS_MOD_USER.KEY
     13953**DCL     13955--REDEF
AS_MOD_USER.LASTCPROC
     13879**DCL     13880--REDEF
AS_MOD_USER.LIMITS.DO_
     13927**DCL     13928--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     13943**DCL     13944--REDEF
AS_MOD_USER.LIMITS.LO
     13923**DCL     13924--REDEF
AS_MOD_USER.LIMITS.MEM
     13919**DCL     13920--REDEF
AS_MOD_USER.LIMITS.MPRIO
     13947**DCL     13948--REDEF
AS_MOD_USER.LIMITS.PDIS
     13935**DCL     13936--REDEF
AS_MOD_USER.LIMITS.PO
     13931**DCL     13932--REDEF
AS_MOD_USER.LIMITS.TDIS
     13939**DCL     13940--REDEF
AS_MOD_USER.LIMITS.TIME
     13915**DCL     13916--REDEF
AS_MOD_USER.MAXENQ
     13896**DCL     13897--REDEF
AS_MOD_USER.PERM_BIT
     13869**DCL     13870--REDEF
AS_MOD_USER.PPRIV
     13891**DCL     13893--REDEF
AS_MOD_USER.PRIOB
     13898**DCL     13899--REDEF
AS_MOD_USER.PRIV
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:110  
     13888**DCL     13890--REDEF
AS_MOD_USER.QUAN
     13894**DCL     13895--REDEF
AS_MOD_USER.SETUP
     13867**DCL     13868--REDEF
AS_PROJECT.BANNER_PERM
     12207**DCL     12208--REDEF
AS_PROJECT.BUDGET.MACCT
     12112**DCL     12116--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     12125**DCL     12128--REDEF
AS_PROJECT.BUDGET.PACCUM
     12108**DCL     12110--REDEF
AS_PROJECT.BUDGET.PMAXC
     12103**DCL     12105--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12223**DCL     12224--REDEF   12225--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     12385**DCL     12386--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     12290**DCL     12294--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     12303**DCL     12306--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     12286**DCL     12288--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     12281**DCL     12283--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     12401**DCL     12402--REDEF   12403--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     13607**DCL     13611--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     13630**DCL     13631--REDEF
AS_PROJECT_DREC.PASSWORD
     13445**DCL     13449--REDEF
AS_PROJECT_DREC.RENAME
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:111  
     13468**DCL     13469--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     12029**DCL     12030--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     11934**DCL     11938--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     11947**DCL     11950--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     11930**DCL     11932--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     11925**DCL     11927--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     12045**DCL     12046--REDEF   12047--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     13283**DCL     13287--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     13306**DCL     13307--REDEF
AS_TRUE
     11018**DCL     14808>>ASSIGN  14809>>ASSIGN
AS_USERS.BANNER_PERM
     11495**DCL     11496--REDEF
AS_USERS.BUDGET.MACCT
     11400**DCL     11404--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     11413**DCL     11416--REDEF
AS_USERS.BUDGET.PACCUM
     11396**DCL     11398--REDEF
AS_USERS.BUDGET.PMAXC
     11391**DCL     11393--REDEF
AS_USERS.SETUP_CHRA.TXT
     11511**DCL     11512--REDEF   11513--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     12563**DCL     12564--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     12468**DCL     12472--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:112  
     12481**DCL     12484--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     12464**DCL     12466--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     12459**DCL     12461--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     12579**DCL     12580--REDEF   12581--REDEF
B$ALT.CODE
     14027**DCL     14027--REDEF   14028--REDEF   14028--REDEF
B$ALT.ERR
     14028**DCL     14746>>ASSIGN  14796>>ASSIGN  14821>>ASSIGN
B$ALT.ERR.ERR#
     14029**DCL     14029--REDEF
B$ALT.EVID
     14028**DCL     14028--REDEF   14028--REDEF
B$TCB.ALT$
     14034**DCL     14746>>ASSIGN  14796>>ASSIGN  14821>>ASSIGN
B$TCB$
     14098**DCL     14746>>ASSIGN  14796>>ASSIGN  14821>>ASSIGN
CLOSE_FPT
     14415**DCL     14783<>CALL
CLOSE_FPT.SN_
     14415**DCL     14415--REDEF
CLOSE_FPT.UTL_
     14416**DCL     14416--REDEF
CLOSE_FPT.V
     14420**DCL     14415--DCLINIT
CLOSE_FPT.V.EXPIRE#
     14430**DCL     14430--REDEF
CLOSE_FPT.V.TYPE#
     14428**DCL     14428--REDEF
CLOSE_FPT.V.XTNSIZE#
     14425**DCL     14425--REDEF   14427--REDEF
DELREC_FPT
     14523**DCL     14767<>CALL
DELREC_FPT.V
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:113  
     14526**DCL     14523--DCLINIT
DEQ_ERR1
     14852**LABEL   14851--CALLALT
ENQ_ERR1
     14822**LABEL   14826--CALLALT
ERR_CODE
     11153**DCL     11154--REDEF
F$DCB.ACTPOS
     14069**DCL     14069--REDEF
F$DCB.ARS#
     14043**DCL     14043--REDEF   14742>>ASSIGN  14792>>ASSIGN
F$DCB.ATTR
     14062**DCL     14063--REDEF
F$DCB.BORROW
     14077**DCL     14077--REDEF   14077--REDEF   14077--REDEF
F$DCB.DCBNAME.L
     14091**DCL     14091--IMP-SIZ
F$DCB.EOMCHAR#
     14047**DCL     14047--REDEF
F$DCB.FLDID
     14072**DCL     14072--REDEF
F$DCB.FORM$
     14066**DCL     14066--REDEF
F$DCB.FSECT
     14082**DCL     14082--REDEF
F$DCB.FSN#
     14059**DCL     14059--REDEF   14059--REDEF   14060--REDEF
F$DCB.HEADER$
     14065**DCL     14065--REDEF
F$DCB.IXTNSIZE#
     14063**DCL     14063--REDEF
F$DCB.LASTSTA$
     14052**DCL     14052--REDEF
F$DCB.LVL
     14078**DCL     14078--REDEF
F$DCB.NAME#.C
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:114  
     14053**DCL     14053--REDEF
F$DCB.NOEOF
     14075**DCL     14075--REDEF
F$DCB.NRECS#
     14064**DCL     14064--REDEF
F$DCB.NRECX
     14083**DCL     14083--REDEF
F$DCB.OHDR
     14075**DCL     14075--REDEF
F$DCB.ORG#
     14058**DCL     14058--REDEF
F$DCB.PRECNO
     14081**DCL     14081--REDEF
F$DCB.RCSZ
     14087**DCL     14087--REDEF
F$DCB.RES#
     14054**DCL     14054--REDEF
F$DCB.SETX
     14066**DCL     14066--REDEF
F$DCB.TAB$
     14066**DCL     14066--REDEF
F$DCB.TDA
     14080**DCL     14081--REDEF
F$DCB.WSN#
     14054**DCL     14054--REDEF
FILE_ACCT
     11161**DCL     14195--DCLINIT 14312--DCLINIT
FILE_NAME
     14016**DCL     14191--DCLINIT 14308--DCLINIT
FPT_DEQ_PROJ
     14384**DCL     14851<>CALL
FPT_DEQ_PROJ.V
     14385**DCL     14384--DCLINIT
FPT_ENQ_PROJ
     14365**DCL     14826<>CALL
FPT_ENQ_PROJ.V
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:115  
     14366**DCL     14365--DCLINIT
IO_ERROR
     14813**LABEL   14750--CALLALT 14763--CALLALT 14767--CALLALT 14771--CALLALT 14775--CALLALT 14779--CALLALT
     14800--CALLALT 14806--CALLALT 14817--CALLALT
KL_DEFAULT.PASSWORD
     13769**DCL     13773--REDEF
KL_DEFAULT.RENAME
     13792**DCL     13793--REDEF
KL_DFLT.PASSWORD
     12959**DCL     12963--REDEF
KL_DFLT.RENAME
     12982**DCL     12983--REDEF
KL_DREC.PASSWORD
     12797**DCL     12801--REDEF
KL_DREC.RENAME
     12820**DCL     12821--REDEF
KL_DREC_CNT.PASSWORD
     12684**DCL     12688--REDEF
KL_DREC_CNT.RENAME
     12707**DCL     12708--REDEF
M$CLOSE
        44**DCL-ENT 14783--CALL
M$DELREC
        46**DCL-ENT 14767--CALL
M$DEQ
       111**DCL-ENT 14851--CALL
M$ENQ
       110**DCL-ENT 14826--CALL
M$OPEN
        44**DCL-ENT 14775--CALL    14779--CALL
M$PFIL
        46**DCL-ENT 14817--CALL
M$PRECORD
        48**DCL-ENT 14771--CALL    14806--CALL
M$PROJ
     14716**DCL     14742--ASSIGN  14754>>ASSIGN  14792--ASSIGN  14813>>ASSIGN  14822>>ASSIGN
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:116  
M$READ
        45**DCL-ENT 14741--CALL    14791--CALL
M$WRITE
        45**DCL-ENT 14763--CALL
MERR_CODE
     11154**DCL     14746<<ASSIGN  14796<<ASSIGN  14821<<ASSIGN
MERR_CODE.CODE
     11154**DCL     14747>>IF      14797>>IF
OPEN_CR_FPT
     14190**DCL     14775<>CALL
OPEN_CR_FPT.ACSVEH_
     14192**DCL     14193--REDEF
OPEN_CR_FPT.ALTKEYS_
     14198**DCL     14199--REDEF   14199--REDEF
OPEN_CR_FPT.HDR_
     14197**DCL     14198--REDEF
OPEN_CR_FPT.TAB_
     14196**DCL     14197--REDEF
OPEN_CR_FPT.UHL_
     14190**DCL     14191--REDEF   14191--REDEF
OPEN_CR_FPT.V
     14199**DCL     14190--DCLINIT
OPEN_CR_FPT.V.FSN#
     14230**DCL     14230--REDEF   14230--REDEF
OPEN_CR_FPT.WSN_
     14196**DCL     14196--REDEF
OPEN_UP_FPT
     14307**DCL     14779<>CALL
OPEN_UP_FPT.ACSVEH_
     14309**DCL     14310--REDEF
OPEN_UP_FPT.ALTKEYS_
     14315**DCL     14316--REDEF   14316--REDEF
OPEN_UP_FPT.HDR_
     14314**DCL     14315--REDEF
OPEN_UP_FPT.TAB_
     14313**DCL     14314--REDEF
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:117  
OPEN_UP_FPT.UHL_
     14307**DCL     14308--REDEF   14308--REDEF
OPEN_UP_FPT.V
     14316**DCL     14307--DCLINIT
OPEN_UP_FPT.V.FSN#
     14347**DCL     14347--REDEF   14347--REDEF
OPEN_UP_FPT.WSN_
     14313**DCL     14313--REDEF
PFIL_FPT
     14613**DCL     14817<>CALL
PFIL_FPT.V
     14613**DCL     14613--DCLINIT
PREC_FPT
     14547**DCL     14771<>CALL    14806<>CALL
PREC_FPT.V
     14549**DCL     14547--DCLINIT
PREC_FPT.V.KEYR#
     14550**DCL     14803<<ASSIGN  14808<<ASSIGN
PREC_FPT.V.KEYS#
     14550**DCL     14804<<ASSIGN  14809<<ASSIGN
PREC_FPT.V.N#
     14553**DCL     14805<<ASSIGN  14810<<ASSIGN
PROJ$
     14104**DCL         9--PROC    14734--ENTRY   14738>>ASSIGN  14757--ENTRY   14762>>ASSIGN  14786--ENTRY
     14788>>ASSIGN
PROJ_KEY
     11030**DCL     14365--DCLINIT 14454--DCLINIT 14455--DCLINIT 14496--DCLINIT 14523--DCLINIT 14524--DCLINIT
     14547--DCLINIT 14548--DCLINIT 14578--DCLINIT 14579--DCLINIT
PROJ_KEY.TEXT
     11031**DCL     11031--REDEF   14787<<ASSIGN
PROJ_KEY.TXT.PROJECT
     11031**DCL     11031--REDEF
READ_ERROR
     14746**LABEL   14741--CALLALT
READ_FPT
     14454**DCL     14741<>CALL
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:118  
READ_FPT.BUF_.BOUND
     14456**DCL     14740<<ASSIGN
READ_FPT.BUF_.BUF$
     14457**DCL     14738<<ASSIGN
READ_FPT.STATION_
     14457**DCL     14458--REDEF
READ_FPT.V
     14458**DCL     14454--DCLINIT
READ_FPT.V.DVBYTE.REREAD#
     14469**DCL     14469--REDEF
READ_FPT.V.INDX#
     14467**DCL     14467--REDEF
READ_REC
     14740**LABEL   14752--GOTO
READ_SEQ
     14790**LABEL   14811--GOTO
READ_SEQ_ERR
     14796**LABEL   14791--CALLALT
READ_SEQ_FPT
     14578**DCL     14791<>CALL
READ_SEQ_FPT.BUF_.BOUND
     14580**DCL     14790<<ASSIGN
READ_SEQ_FPT.BUF_.BUF$
     14581**DCL     14788<<ASSIGN
READ_SEQ_FPT.STATION_
     14581**DCL     14582--REDEF
READ_SEQ_FPT.V
     14582**DCL     14578--DCLINIT
READ_SEQ_FPT.V.DVBYTE.REREAD#
     14593**DCL     14593--REDEF
READ_SEQ_FPT.V.INDX#
     14591**DCL     14591--REDEF
REMEM_VAR
     11157**DCL     11157--REDEF
REM_FCMD
     11157**DCL     11158--REDEF
PL6.E3A0      #002=ASB$PROJ File=ASB$FILES.:E05TSI                               TUE 07/29/97 09:14 Page:119  
SEG_TYPE
     14106**DCL         9--PROC    14734--ENTRY   14749--IF      14750<>CALL    14786--ENTRY   14799--IF
     14800<>CALL
USERS_KEY.TEXT
     11028**DCL     11029--REDEF   11029--REDEF   11029--REDEF   11030--REDEF
VLP_ATTR
     14634**DCL     14193--DCLINIT
VLP_ATTR.Q
     14635**DCL     14634--DCLINIT
VLP_ATTR_ACC
     14689**DCL     14192--DCLINIT
VLP_ATTR_ACC.Q
     14690**DCL     14689--DCLINIT
WRITE_FPT
     14496**DCL     14763<>CALL
WRITE_FPT.BUF_.BOUND
     14496**DCL     14761<<ASSIGN
WRITE_FPT.BUF_.BUF$
     14498**DCL     14762<<ASSIGN
WRITE_FPT.STATION_
     14498**DCL     14498--REDEF
WRITE_FPT.V
     14499**DCL     14496--DCLINIT
WRITE_FPT.V.DVBYTE.VFC#
     14505**DCL     14505--REDEF

PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:120  
      622        1        /*M* ASB$HLP - procedure to manage the :HLP file.     */
      623        2        /*T***********************************************************/
      624        3        /*T*                                                         */
      625        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      626        5        /*T*                                                         */
      627        6        /*T***********************************************************/
      628        7        ASB$HLP: PROC (BUF$, ARS, SEG_TYPE) ALTRET ;
      629        8        /***********************************************************/
      630        9
      631       10        /*P*    NAME:     ASB$HLP
      632       11                PURPOSE:  Manage the :HLP file.
      633       12                DESCRIPTION:
      634       13                  ASB$HLP has 11 entries:
      635       14
      636       15                      ASB$READ_HLP - reads a record from the :HLP file, by key.
      637       16                      ASB$WRITE_HLP - writes a record to the :HLP file.
      638       17                      ASB$DELREC_HLP - deletes a record from the :HLP file.
      639       18                      ASB$OPEN_HLP_CR - creates the :HLP file.
      640       19                      ASB$OPEN_HLP_UP - opens :HLP as an update file.
      641       20                      ASB$CLOSE_HLP - closes the :HLP file.
      642       21                      ASB$READ_HLP_SEQ - reads a record from the :HLP file sequentially.
      643       22                      ASB$BOF_HLP - positions to the beginning of the :HLP file.
      644       23                      ASB$PREC_HLP - positions to a record in the :HLP file.
      645       24                      ASB$PREC_AND_SKIP_HLP - positions to a record in the :HLP file
      646       25                                              and then skips to the next record.
      647       26        */
      648       27        /***********************************************************/
      649       28                                                                                      /**/
      650       29        %EJECT;
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:121  
      651       30        /*********************************************************************/
      652       31        /*   Include files   include files   include files   include files   */
      653       32        /*********************************************************************/
      654       33                                                                                      /**/
      655       34              %INCLUDE CP_6          ;
      656      115              %INCLUDE AS_ENTRIES_M  ;
      657     1165              %INCLUDE B_ERRORS_C    ;
      658     2292              %INCLUDE AS_PERR_C     ;
      659     2894              %INCLUDE AS_SUPER_C    ;
      660     3329              %INCLUDE AS_SUBS_C     ;
      661     4743              %INCLUDE XU_MACRO_C    ;
      662     7849              %INCLUDE KL_SUPER_C    ;
      663    10751              %INCLUDE XU_FORMAT_C   ;
      664    10913              %INCLUDE AS_SUPER_R    ;
      665    13929                                                                                      /**/
      666    13930        %EJECT;
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:122  
      667    13931        /*********************************************************************/
      668    13932        /*   Static data     static data     static data     static data     */
      669    13933        /*********************************************************************/
      670    13934                                                                                      /**/
      671    13935    1   DCL 1 FILE_NAME STATIC ,
      672    13936    1          2 COUNT UBIN(9) UNAL INIT(4) ,
      673    13937    1          2 TEXT CHAR(31) UNAL INIT(':HLP') ;
      674    13938    1   DCL HLP$ PTR STATIC ;
      675    13939                                                                                      /**/
      676    13940        %EJECT;
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:123  
      677    13941        /*********************************************************************/
      678    13942        /*   Local based     local based     local based     local based     */
      679    13943        /*********************************************************************/
      680    13944                                                              /**/
      681    13945        %LIST ;
      682    13946              %B$ALT ;
             13947        %B$FIXED(NAME=NAME,STCLASS=STCLASS);
             13948    1   DCL 1 NAME STCLASS ALIGNED,2 SSFRAME(0:63)UBIN,2 * UBIN(18)UNAL,2 CODE UBIN(18)UNAL,
             13948            2 FPT REDEF CODE,3 FCG UBIN(6)UNAL,3 PMME UBIN
             13949    1   (12)UNAL,2 EVSC REDEF CODE UBIN(18)UNAL,2 SUBC REDEF CODE UBIN(18)UNAL,2 EVID UBIN,2
             13949            DCB# REDEF EVID UBIN,2 BRKCNT REDEF EVID UBIN,2
             13950    1   ERR,3 FCG BIT(12),3 MID BIT(6),3 MON BIT(1),3 ERR# UBIN(14)UNAL,3 CODE REDEF ERR#
             13950            UBIN(14)UNAL,3 SEV UBIN(3)UNAL LAST
             13952    1   2 P# UBIN;
      683    13954              %B$TCB ;
             13955    1   DCL 1 NAME STCLASS ALIGNED,2 ALT$ PTR,2 STK$ PTR,2 TCBAVSZ UBIN(18)UNAL,2 CURRSZ
             13955            UBIN(18)UNAL,2 * BIT(36);
      684    13957        %PLIST ;
      685    13958        %EJECT ;
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:124  
      686    13959        /*********************************************************************/
      687    13960        /*   Symref's        symref's        symref's        symref's        */
      688    13961        /*********************************************************************/
      689    13962                                                              /**/
      690    13963    1   DCL B$TCB$ PTR SYMREF ;
      691    13964        %EJECT ;
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:125  
      692    13965        /*********************************************************************/
      693    13966        /*   Parameters      parameters      parameters      parameters      */
      694    13967        /*********************************************************************/
      695    13968                                                                                      /**/
      696    13969    1   DCL BUF$ PTR ;
      697    13970    1   DCL ARS UBIN WORD ;
      698    13971    1   DCL SEG_TYPE   UBIN;
      699    13972                                                                                      /**/
      700    13973        %EJECT;
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:126  
      701    13974        /*********************************************************************/
      702    13975        /*   Fpts            fpts            fpts            fpts            */
      703    13976        /*********************************************************************/
      704    13977                                                                                      /**/
      705    13978              %FPT_OPEN (FPTN=OPEN_CR_FPT ,
      706    13979                          NAME = FILE_NAME ,
      707    13980                          ACCT = FILE_ACCT ,
      708    13981                          ASN  = FILE ,
      709    13982                          DCB = M$HLP ,
      710    13983                          ACS = DIRECT ,
      711    13984                          ORG = KEYED ,
      712    13985                          ACSVEH = VLP_ATTR ,
      713    13986                          ACCESS = VLP_ATTR_ACC ,
      714    13987                          FUN = CREATE ,
      715    13988                          IXTNSIZE = 8 ,
      716    13989                          XTNSIZE = 8 ,
      717    13990                          EXIST = OLDFILE) ;
      718    14099              %FPT_OPEN (FPTN=OPEN_UP_FPT ,
      719    14100                          NAME = FILE_NAME ,
      720    14101                          ACCT = FILE_ACCT ,
      721    14102                          ASN  = FILE ,
      722    14103                          DCB = M$HLP ,
      723    14104                          ACS = DIRECT ,
      724    14105                          ORG = KEYED ,
      725    14106                          FUN = UPDATE ,
      726    14107                          SHARE = ALL) ;
      727    14216              %FPT_CLOSE  (FPTN = CLOSE_FPT ,
      728    14217                           DCB = M$HLP ,
      729    14218                           DISP = SAVE) ;
      730    14260              %FPT_READ  (FPTN = READ_FPT ,
      731    14261                          KEY = USERS_KEY ,
      732    14262                          DCB = M$HLP ,
      733    14263                          KEYS = YES) ;
      734    14302              %FPT_WRITE  (FPTN = WRITE_FPT ,
      735    14303                           ONEWKEY = YES ,
      736    14304                           KEY = USERS_KEY ,
      737    14305                           DCB = M$HLP) ;
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:127  
      738    14336              %FPT_DELREC  (FPTN = DELREC_FPT ,
      739    14337                            KEY = USERS_KEY ,
      740    14338                            DCB = M$HLP) ;
      741    14357              %FPT_READ    (FPTN = READ_SEQ_FPT ,
      742    14358                            KEY = USERS_KEY ,
      743    14359                            DCB = M$HLP ,
      744    14360                            KEYR = YES ,
      745    14361                            KEYS = NO ) ;
      746    14400              %FPT_PFIL    (FPTN = PFIL_FPT ,
      747    14401                            DCB  = M$HLP ,
      748    14402                            BOF  = YES ) ;
      749    14417              %FPT_PRECORD (FPTN = PREC_FPT ,
      750    14418                            DCB  = M$HLP ,
      751    14419                            KEY  = USERS_KEY ,
      752    14420                            KEYS = YES ,
      753    14421                            KEYR = YES ,
      754    14422                            N    = 0   );
      755    14443              %FPT_PRECORD (FPTN = PREC_AND_SKIP_FPT ,
      756    14444                            DCB  = M$HLP ,
      757    14445                            KEY  = USERS_KEY ,
      758    14446                            KEYS = YES ,
      759    14447                            KEYR = YES ,
      760    14448                            N    = 1   );
      761    14469                                                                                      /**/
      762    14470        %EJECT;
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:128  
      763    14471        /*********************************************************************/
      764    14472        /*   Vlps            vlps            vlps            vlps            */
      765    14473        /*********************************************************************/
      766    14474                                                                                      /**/
      767    14475              %VLP_ATTR ;
      768    14489              %VLP_ACSVEH(  UPD = YES ,
      769    14490                            READ = YES ,
      770    14491                            DELR = YES,
      771    14492                            WNEW = YES,
      772    14493                            VEHICLE = 'SUPER' ) ;
      773    14510              %VLP_ACSVEH(  UPD = YES ,
      774    14511                            READ = YES ,
      775    14512                            VEHICLE = 'IBEX' ) ;
      776    14529              %VLP_ACSVEH(  READ = YES ,
      777    14530                            VEHICLE = 'LOGON' ) ;
      778    14547              %VLP_ACSVEH(  READ = YES ,
      779    14548                            VEHICLE = 'NETCON' ) ;
      780    14565              %VLP_ACSVEH(  READ = YES ,
      781    14566                            VEHICLE = 'PIGETTE' ) ;
      782    14583              %VLP_ACSVEH(  UPD = YES ,
      783    14584                            READ = YES ,
      784    14585                            VEHICLE = 'TPCP' ) ;
      785    14602              %VLP_ACSVEH(  READ = YES ,
      786    14603                            VEHICLE = 'PRESCAN' );
      787    14620              %VLP_ACSVEH(  UPD = YES ,
      788    14621                            READ = YES ,
      789    14622                            VEHICLE = 'TPA' ,
      790    14623                            LAST=";") ;
      791    14640              %VLP_ATTR(  FPTN = VLP_ATTR_ACC ) ;
      792    14654              %VLP_ACCESS(  EXEC = YES ,
      793    14655                            ACCT = '?' ,
      794    14656                            LAST=";") ;
      795    14673        %EJECT ;
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:129  
      796    14674        /*********************************************************************/
      797    14675        /*   Based data      based data      based data      based data      */
      798    14676        /*********************************************************************/
      799    14677                                                              /**/
      800    14678              %F$DCB( DCBN = F$DCB ) ;
      801    14735        %EJECT ;
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:130  
      802    14736        /*********************************************************************/
      803    14737        /*   Dcbs            dcbs            dcbs            dcbs            */
      804    14738        /*********************************************************************/
      805    14739                                                                                      /**/
      806    14740    1   DCL M$HLP DCB ;                                      /*  Read-write :HLP record */
      807    14741                                                              /**/
      808    14742        %EJECT;
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:131  
      809    14743        /********************************************************************/
      810    14744        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      811    14745        /********************************************************************/
      812    14746
      813    14747        %ASB$GET_MORE_SEG ;
      814    14750        %EJECT;
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:132  
      815    14751
      816    14752        /********************************************************************/
      817    14753        /*   Procedure       procedure       procedure       procedure       */
      818    14754        /*********************************************************************/
      819    14755                                                              /**/
      820    14756    1   ASB$READ_HLP: ENTRY (BUF$, ARS, SEG_TYPE) ALTRET;
      821    14757                                                              /*
      822    14758                                                                   Set BUF$ in read fpt
      823    14759                                                              */
      824    14760    1   READ_FPT.BUF_.BUF$ = BUF$ ;
      825    14761    1   READ_REC:
      826    14762    1   IF ADDR(ARS) = ADDR(NIL)
      827    14763    1   THEN READ_FPT.BUF_.BOUND = SIZEV(KL_DREC);
      828    14764    1   ELSE READ_FPT.BUF_.BOUND = ARS - 1 ;
      829    14765    1   CALL M$READ (READ_FPT) ALTRET(READ_ERROR) ;
      830    14766    1   IF ADDR(ARS) ~= ADDR(NIL)
      831    14767    1   THEN ARS = DCBADDR( DCBNUM( M$HLP ) ) -> F$DCB.ARS# ;
      832    14768    1   RETURN ;
      833    14769                                                                                      /**/
      834    14770    1   READ_ERROR:
      835    14771    1   MERR_CODE = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR ;
      836    14772    1   IF MERR_CODE.CODE = %E$LD
      837    14773    2   THEN DO;
      838    14774    2      IF ADDR(SEG_TYPE) = ADDR(NIL) THEN RETURN;  /* Lost data is ok */
      839    14775    2      IF ADDR(ARS) = ADDR(NIL) THEN GOTO IO_ERROR;
      840    14776    2      CALL ASB$GET_MORE_SEG( SEG_TYPE, 4096 ) ALTRET(IO_ERROR);
      841    14777    2      ARS = ARS + 4096 ;
      842    14778    2      GOTO READ_REC ;
      843    14779    2      END;
      844    14780    1   AS_DCBNUM# = DCBNUM( M$HLP );
      845    14781    1   ALTRETURN ;
      846    14782                                                              /**/
      847    14783    1   ASB$WRITE_HLP: ENTRY (BUF$, ARS) ALTRET;
      848    14784                                                              /*
      849    14785                                                                   Set BUF$ in write fpt
      850    14786                                                              */
      851    14787    1   WRITE_FPT.BUF_.BUF$ = BUF$ ;
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:133  
      852    14788    1   WRITE_FPT.BUF_.BOUND = ARS - 1 ;
      853    14789    1   CALL M$WRITE (WRITE_FPT) ALTRET(IO_ERROR) ;
      854    14790    1   RETURN ;
      855    14791                                                                                      /**/
      856    14792    1   ASB$DELREC_HLP: ENTRY ALTRET;
      857    14793    1   CALL M$DELREC (DELREC_FPT) ALTRET(IO_ERROR) ;
      858    14794    1   RETURN ;
      859    14795                                                                                      /**/
      860    14796    1   ASB$OPEN_HLP_CR: ENTRY ALTRET;
      861    14797    1   CALL M$OPEN (OPEN_CR_FPT) ALTRET(IO_ERROR) ;
      862    14798    1   RETURN ;
      863    14799                                                                                      /**/
      864    14800    1   ASB$OPEN_HLP_UP: ENTRY ALTRET;
      865    14801    1   CALL M$OPEN (OPEN_UP_FPT) ALTRET(IO_ERROR) ;
      866    14802    1   RETURN ;
      867    14803                                                                                      /**/
      868    14804    1   ASB$CLOSE_HLP: ENTRY ALTRET;
      869    14805    1   CALL M$CLOSE (CLOSE_FPT) ;
      870    14806    1   RETURN ;
      871    14807                                                                  /**/
      872    14808    1   ASB$READ_HLP_SEQ: ENTRY (BUF$, ARS, SEG_TYPE) ALTRET;
      873    14809    1   USERS_KEY.TXTC = AS_BLANK ;
      874    14810    1   READ_SEQ_FPT.BUF_.BUF$ = BUF$ ;
      875    14811    1   READ_SEQ:
      876    14812    1   READ_SEQ_FPT.BUF_.BOUND = ARS - 1 ;
      877    14813    1   CALL M$READ(READ_SEQ_FPT) ALTRET (READ_SEQ_ERROR) ;
      878    14814    1   HLP$ = DCBADDR( DCBNUM( M$HLP )) ;
      879    14815    1   ARS = HLP$ -> F$DCB.ARS# ;
      880    14816    1   RETURN ;
      881    14817    1   READ_SEQ_ERROR:
      882    14818    1   MERR_CODE = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR ;
      883    14819    1   IF MERR_CODE.CODE = %E$LD
      884    14820    2   THEN DO;
      885    14821    2      IF ADDR(SEG_TYPE) = ADDR(NIL) THEN RETURN;  /* Lost data is ok */
      886    14822    2      CALL ASB$GET_MORE_SEG( SEG_TYPE, 4096 ) ALTRET(IO_ERROR);
      887    14823    2      ARS = ARS + 4096 ;
      888    14824                                                       /* setup for precord */
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:134  
      889    14825    2      PREC_FPT.V.KEYR# = AS_FALSE;
      890    14826    2      PREC_FPT.V.KEYS# = AS_FALSE;
      891    14827    2      PREC_FPT.V.N# = -1;
      892    14828    2      CALL M$PRECORD (PREC_FPT) ALTRET (IO_ERROR);
      893    14829                                                       /* reset PREC_FPT */
      894    14830    2      PREC_FPT.V.KEYR# = AS_TRUE;
      895    14831    2      PREC_FPT.V.KEYS# = AS_TRUE;
      896    14832    2      PREC_FPT.V.N# = 0;
      897    14833    2      GOTO READ_SEQ;
      898    14834    2      END;
      899    14835    1   AS_DCBNUM# = DCBNUM( M$HLP );
      900    14836    1   ALTRETURN ;
      901    14837                                                              /**/
      902    14838    1   ASB$BOF_HLP: ENTRY ALTRET;
      903    14839    1   CALL M$PFIL(PFIL_FPT) ALTRET(IO_ERROR) ;
      904    14840    1   RETURN ;
      905    14841                                                                                      /**/
      906    14842    1   ASB$PREC_HLP: ENTRY       ALTRET;
      907    14843
      908    14844    1   CALL M$PRECORD( PREC_FPT ) ALTRET(IO_ERROR);
      909    14845    1   RETURN;
      910    14846
      911    14847    1   ASB$PREC_AND_SKIP_HLP: ENTRY     ALTRET;
      912    14848
      913    14849    1   CALL M$PRECORD( PREC_AND_SKIP_FPT ) ALTRET(IO_ERROR);
      914    14850    1   RETURN;
      915    14851
      916    14852    1   IO_ERROR: ;
      917    14853    1   ERR_CODE = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR ;
      918    14854    1   AS_DCBNUM# = DCBNUM( M$HLP );
      919    14855    1   ALTRETURN ;
      920    14856
      921    14857
      922    14858    1   END   ASB$HLP ;
      923    14859        %EOD ;

PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:135  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASB$HLP.

   Procedure ASB$HLP requires 223 words for executable code.
   Procedure ASB$HLP requires 8 words of local(AUTO) storage.

PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:136  

 Object Unit name= ASB$HLP                                    File name= ASB$FILES.:E05TOU
 UTS= JUL 29 '97 09:16:02.56 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2   Data  even  none   252    374  ASB$HLP
    3   DCB   even  none     0      0  M$HLP
    4   Proc  even  none   223    337  ASB$HLP
    5  RoData even  none     4      4  ASB$HLP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        3  ASB$HLP
     4      3          yes     yes      Std        3  ASB$READ_HLP
     4    104          yes     yes      Std        2  ASB$WRITE_HLP
     4    125          yes     yes      Std        0  ASB$DELREC_HLP
     4    134          yes     yes      Std        0  ASB$OPEN_HLP_CR
     4    143          yes     yes      Std        0  ASB$OPEN_HLP_UP
     4    152          yes     yes      Std        0  ASB$CLOSE_HLP
     4    160          yes     yes      Std        3  ASB$READ_HLP_SEQ
     4    303          yes     yes      Std        0  ASB$BOF_HLP
     4    312          yes     yes      Std        0  ASB$PREC_HLP
     4    321          yes     yes      Std        0  ASB$PREC_AND_SKIP_HLP
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:137  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
 yes     yes           Std       2 ASB$GET_MORE_SEG
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    AS_BLANK                         r    AS_TRUE
r    AS_FALSE                         r    AS_MODE                          r    AS_FE_MODE
     M$LO                                  USERS_KEY                             ERR_CODE
     REMEM_VAR                             REM_FCMD                              ASA_BRKS_LOC
     FILE_ACCT                             AS_DCBNUM#                            KL_DREC
     B$TCB$                                M$HLP                                 B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:138  


      622        1        /*M* ASB$HLP - procedure to manage the :HLP file.     */
      623        2        /*T***********************************************************/
      624        3        /*T*                                                         */
      625        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      626        5        /*T*                                                         */
      627        6        /*T***********************************************************/
      628        7        ASB$HLP: PROC (BUF$, ARS, SEG_TYPE) ALTRET ;

      7  4 000000   000000 700200 xent  ASB$HLP      TSX0  ! X66_AUTO_3
         4 000001   000010 000003                    ZERO    8,3
         4 000002   000005 710000 4                  TRA     s:14760

      629        8        /***********************************************************/
      630        9
      631       10        /*P*    NAME:     ASB$HLP
      632       11                PURPOSE:  Manage the :HLP file.
      633       12                DESCRIPTION:
      634       13                  ASB$HLP has 11 entries:
      635       14
      636       15                      ASB$READ_HLP - reads a record from the :HLP file, by key.
      637       16                      ASB$WRITE_HLP - writes a record to the :HLP file.
      638       17                      ASB$DELREC_HLP - deletes a record from the :HLP file.
      639       18                      ASB$OPEN_HLP_CR - creates the :HLP file.
      640       19                      ASB$OPEN_HLP_UP - opens :HLP as an update file.
      641       20                      ASB$CLOSE_HLP - closes the :HLP file.
      642       21                      ASB$READ_HLP_SEQ - reads a record from the :HLP file sequentially.
      643       22                      ASB$BOF_HLP - positions to the beginning of the :HLP file.
      644       23                      ASB$PREC_HLP - positions to a record in the :HLP file.
      645       24                      ASB$PREC_AND_SKIP_HLP - positions to a record in the :HLP file
      646       25                                              and then skips to the next record.
      647       26        */
      648       27        /***********************************************************/
      649       28                                                                                      /**/
      650       29        %EJECT;
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:139  
      651       30        /*********************************************************************/
      652       31        /*   Include files   include files   include files   include files   */
      653       32        /*********************************************************************/
      654       33                                                                                      /**/
      655       34              %INCLUDE CP_6          ;
      656      115              %INCLUDE AS_ENTRIES_M  ;
      657     1165              %INCLUDE B_ERRORS_C    ;
      658     2292              %INCLUDE AS_PERR_C     ;
      659     2894              %INCLUDE AS_SUPER_C    ;
      660     3329              %INCLUDE AS_SUBS_C     ;
      661     4743              %INCLUDE XU_MACRO_C    ;
      662     7849              %INCLUDE KL_SUPER_C    ;
      663    10751              %INCLUDE XU_FORMAT_C   ;
      664    10913              %INCLUDE AS_SUPER_R    ;
      665    13929                                                                                      /**/
      666    13930        %EJECT;
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:140  
      667    13931        /*********************************************************************/
      668    13932        /*   Static data     static data     static data     static data     */
      669    13933        /*********************************************************************/
      670    13934                                                                                      /**/
      671    13935    1   DCL 1 FILE_NAME STATIC ,
      672    13936    1          2 COUNT UBIN(9) UNAL INIT(4) ,
      673    13937    1          2 TEXT CHAR(31) UNAL INIT(':HLP') ;
      674    13938    1   DCL HLP$ PTR STATIC ;
      675    13939                                                                                      /**/
      676    13940        %EJECT;
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:141  
      677    13941        /*********************************************************************/
      678    13942        /*   Local based     local based     local based     local based     */
      679    13943        /*********************************************************************/
      680    13944                                                              /**/
      681    13945        %LIST ;
      682    13946              %B$ALT ;
             13947        %B$FIXED(NAME=NAME,STCLASS=STCLASS);
             13948    1  DCL 1 NAME STCLASS ALIGNED,2 SSFRAME(0:63)UBIN,2 * UBIN(18)UNAL,2 CODE UBIN(18)UNAL,
             13948            2 FPT REDEF CODE,3 FCG UBIN(6)UNAL,3 PMME UBIN
             13949    1  (12)UNAL,2 EVSC REDEF CODE UBIN(18)UNAL,2 SUBC REDEF CODE UBIN(18)UNAL,2 EVID UBIN,2
             13949            DCB# REDEF EVID UBIN,2 BRKCNT REDEF EVID UBIN,2
             13950    1   ERR,3 FCG BIT(12),3 MID BIT(6),3 MON BIT(1),3 ERR# UBIN(14)UNAL,3 CODE REDEF ERR#
             13950            UBIN(14)UNAL,3 SEV UBIN(3)UNAL LAST
             13952    1   2 P# UBIN;
      683    13954              %B$TCB ;
             13955    1   DCL 1 NAME STCLASS ALIGNED,2 ALT$ PTR,2 STK$ PTR,2 TCBAVSZ UBIN(18)UNAL,2 CURRSZ
             13955            UBIN(18)UNAL,2 * BIT(36);
      684    13957        %PLIST ;
      685    13958        %EJECT ;
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:142  
      686    13959        /*********************************************************************/
      687    13960        /*   Symref's        symref's        symref's        symref's        */
      688    13961        /*********************************************************************/
      689    13962                                                              /**/
      690    13963    1   DCL B$TCB$ PTR SYMREF ;
      691    13964        %EJECT ;
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:143  
      692    13965        /*********************************************************************/
      693    13966        /*   Parameters      parameters      parameters      parameters      */
      694    13967        /*********************************************************************/
      695    13968                                                                                      /**/
      696    13969    1   DCL BUF$ PTR ;
      697    13970    1   DCL ARS UBIN WORD ;
      698    13971    1   DCL SEG_TYPE   UBIN;
      699    13972                                                                                      /**/
      700    13973        %EJECT;
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:144  
      701    13974        /*********************************************************************/
      702    13975        /*   Fpts            fpts            fpts            fpts            */
      703    13976        /*********************************************************************/
      704    13977                                                                                      /**/
      705    13978              %FPT_OPEN (FPTN=OPEN_CR_FPT ,
      706    13979                          NAME = FILE_NAME ,
      707    13980                          ACCT = FILE_ACCT ,
      708    13981                          ASN  = FILE ,
      709    13982                          DCB = M$HLP ,
      710    13983                          ACS = DIRECT ,
      711    13984                          ORG = KEYED ,
      712    13985                          ACSVEH = VLP_ATTR ,
      713    13986                          ACCESS = VLP_ATTR_ACC ,
      714    13987                          FUN = CREATE ,
      715    13988                          IXTNSIZE = 8 ,
      716    13989                          XTNSIZE = 8 ,
      717    13990                          EXIST = OLDFILE) ;
      718    14099              %FPT_OPEN (FPTN=OPEN_UP_FPT ,
      719    14100                          NAME = FILE_NAME ,
      720    14101                          ACCT = FILE_ACCT ,
      721    14102                          ASN  = FILE ,
      722    14103                          DCB = M$HLP ,
      723    14104                          ACS = DIRECT ,
      724    14105                          ORG = KEYED ,
      725    14106                          FUN = UPDATE ,
      726    14107                          SHARE = ALL) ;
      727    14216              %FPT_CLOSE  (FPTN = CLOSE_FPT ,
      728    14217                           DCB = M$HLP ,
      729    14218                           DISP = SAVE) ;
      730    14260              %FPT_READ  (FPTN = READ_FPT ,
      731    14261                          KEY = USERS_KEY ,
      732    14262                          DCB = M$HLP ,
      733    14263                          KEYS = YES) ;
      734    14302              %FPT_WRITE  (FPTN = WRITE_FPT ,
      735    14303                           ONEWKEY = YES ,
      736    14304                           KEY = USERS_KEY ,
      737    14305                           DCB = M$HLP) ;
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:145  
      738    14336              %FPT_DELREC  (FPTN = DELREC_FPT ,
      739    14337                            KEY = USERS_KEY ,
      740    14338                            DCB = M$HLP) ;
      741    14357              %FPT_READ    (FPTN = READ_SEQ_FPT ,
      742    14358                            KEY = USERS_KEY ,
      743    14359                            DCB = M$HLP ,
      744    14360                            KEYR = YES ,
      745    14361                            KEYS = NO ) ;
      746    14400              %FPT_PFIL    (FPTN = PFIL_FPT ,
      747    14401                            DCB  = M$HLP ,
      748    14402                            BOF  = YES ) ;
      749    14417              %FPT_PRECORD (FPTN = PREC_FPT ,
      750    14418                            DCB  = M$HLP ,
      751    14419                            KEY  = USERS_KEY ,
      752    14420                            KEYS = YES ,
      753    14421                            KEYR = YES ,
      754    14422                            N    = 0   );
      755    14443              %FPT_PRECORD (FPTN = PREC_AND_SKIP_FPT ,
      756    14444                            DCB  = M$HLP ,
      757    14445                            KEY  = USERS_KEY ,
      758    14446                            KEYS = YES ,
      759    14447                            KEYR = YES ,
      760    14448                            N    = 1   );
      761    14469                                                                                      /**/
      762    14470        %EJECT;
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:146  
      763    14471        /*********************************************************************/
      764    14472        /*   Vlps            vlps            vlps            vlps            */
      765    14473        /*********************************************************************/
      766    14474                                                                                      /**/
      767    14475              %VLP_ATTR ;
      768    14489              %VLP_ACSVEH(  UPD = YES ,
      769    14490                            READ = YES ,
      770    14491                            DELR = YES,
      771    14492                            WNEW = YES,
      772    14493                            VEHICLE = 'SUPER' ) ;
      773    14510              %VLP_ACSVEH(  UPD = YES ,
      774    14511                            READ = YES ,
      775    14512                            VEHICLE = 'IBEX' ) ;
      776    14529              %VLP_ACSVEH(  READ = YES ,
      777    14530                            VEHICLE = 'LOGON' ) ;
      778    14547              %VLP_ACSVEH(  READ = YES ,
      779    14548                            VEHICLE = 'NETCON' ) ;
      780    14565              %VLP_ACSVEH(  READ = YES ,
      781    14566                            VEHICLE = 'PIGETTE' ) ;
      782    14583              %VLP_ACSVEH(  UPD = YES ,
      783    14584                            READ = YES ,
      784    14585                            VEHICLE = 'TPCP' ) ;
      785    14602              %VLP_ACSVEH(  READ = YES ,
      786    14603                            VEHICLE = 'PRESCAN' );
      787    14620              %VLP_ACSVEH(  UPD = YES ,
      788    14621                            READ = YES ,
      789    14622                            VEHICLE = 'TPA' ,
      790    14623                            LAST=";") ;
      791    14640              %VLP_ATTR(  FPTN = VLP_ATTR_ACC ) ;
      792    14654              %VLP_ACCESS(  EXEC = YES ,
      793    14655                            ACCT = '?' ,
      794    14656                            LAST=";") ;
      795    14673        %EJECT ;
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:147  
      796    14674        /*********************************************************************/
      797    14675        /*   Based data      based data      based data      based data      */
      798    14676        /*********************************************************************/
      799    14677                                                              /**/
      800    14678              %F$DCB( DCBN = F$DCB ) ;
      801    14735        %EJECT ;
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:148  
      802    14736        /*********************************************************************/
      803    14737        /*   Dcbs            dcbs            dcbs            dcbs            */
      804    14738        /*********************************************************************/
      805    14739                                                                                      /**/
      806    14740    1   DCL M$HLP DCB ;                                      /*  Read-write :HLP record */
      807    14741                                                              /**/
      808    14742        %EJECT;
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:149  
      809    14743        /********************************************************************/
      810    14744        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      811    14745        /********************************************************************/
      812    14746
      813    14747        %ASB$GET_MORE_SEG ;
      814    14750        %EJECT;
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:150  
      815    14751
      816    14752        /********************************************************************/
      817    14753        /*   Procedure       procedure       procedure       procedure       */
      818    14754        /*********************************************************************/
      819    14755                                                              /**/
      820    14756    1   ASB$READ_HLP: ENTRY (BUF$, ARS, SEG_TYPE) ALTRET;

  14756  4 000003   000000 700200 xent  ASB$READ_HLP TSX0  ! X66_AUTO_3
         4 000004   000010 000003                    ZERO    8,3

      821    14757                                                              /*
      822    14758                                                                   Set BUF$ in read fpt
      823    14759                                                              */
      824    14760    1   READ_FPT.BUF_.BUF$ = BUF$ ;

  14760  4 000005   200003 470500                    LDP0    @BUF$,,AUTO
         4 000006   000000 236100                    LDQ     0,,PR0
         4 000007   000241 756000 2                  STQ     READ_FPT+5

      825    14761    1   READ_REC:
      826    14762    1   IF ADDR(ARS) = ADDR(NIL)

  14762  4 000010   200004 236100       READ_REC     LDQ     @ARS,,AUTO
         4 000011   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000012   000020 601000 4                  TNZ     s:14764

      827    14763    1   THEN READ_FPT.BUF_.BOUND = SIZEV(KL_DREC);

  14763  4 000013   000240 236000 2                  LDQ     READ_FPT+4
         4 000014   177777 376007                    ANQ     65535,DL
         4 000015   000000 276000 5                  ORQ     0
         4 000016   000240 756000 2                  STQ     READ_FPT+4
         4 000017   000027 710000 4                  TRA     s:14765

      828    14764    1   ELSE READ_FPT.BUF_.BOUND = ARS - 1 ;

  14764  4 000020   200004 470500                    LDP0    @ARS,,AUTO
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:151  
         4 000021   000000 236100                    LDQ     0,,PR0
         4 000022   000001 136007                    SBLQ    1,DL
         4 000023   000020 736000                    QLS     16
         4 000024   000240 676000 2                  ERQ     READ_FPT+4
         4 000025   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000026   000240 656000 2                  ERSQ    READ_FPT+4

      829    14765    1   CALL M$READ (READ_FPT) ALTRET(READ_ERROR) ;

  14765  4 000027   000234 630400 2                  EPPR0   READ_FPT
         4 000030   440000 713400                    CLIMB   alt,read
         4 000031   401400 401760                    pmme    nvectors=4
         4 000032   000046 702000 4                  TSX2    READ_ERROR

      830    14766    1   IF ADDR(ARS) ~= ADDR(NIL)

  14766  4 000033   200004 236100                    LDQ     @ARS,,AUTO
         4 000034   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000035   000045 600000 4                  TZE     s:14768

      831    14767    1   THEN ARS = DCBADDR( DCBNUM( M$HLP ) ) -> F$DCB.ARS# ;

  14767  4 000036   000000 236007 xsym               LDQ     M$HLP,DL
         4 000037   000001 470400 5                  LDP0    1
         4 000040   000000 471500                    LDP1    0,,PR0
         4 000041   100000 473506                    LDP3    0,QL,PR1
         4 000042   300000 235100                    LDA     0,,PR3
         4 000043   200004 473500                    LDP3    @ARS,,AUTO
         4 000044   300000 755100                    STA     0,,PR3

      832    14768    1   RETURN ;

  14768  4 000045   000000 702200 xent               TSX2  ! X66_ARET

      833    14769                                                                                      /**/
      834    14770    1   READ_ERROR:
      835    14771    1   MERR_CODE = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR ;
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:152  

  14771  4 000046   000000 470400 xsym  READ_ERROR   LDP0    B$TCB$
         4 000047   000000 471500                    LDP1    0,,PR0
         4 000050   100102 236100                    LDQ     66,,PR1
         4 000051   000000 756000 xsym               STQ     ERR_CODE

      836    14772    1   IF MERR_CODE.CODE = %E$LD

  14772  4 000052   000000 236000 xsym               LDQ     ERR_CODE
         4 000053   377770 376007                    ANQ     131064,DL
         4 000054   000070 116007                    CMPQ    56,DL
         4 000055   000101 601000 4                  TNZ     s:14780

      837    14773    2   THEN DO;

      838    14774    2      IF ADDR(SEG_TYPE) = ADDR(NIL) THEN RETURN;  /* Lost data is ok */

  14774  4 000056   200005 236100                    LDQ     @SEG_TYPE,,AUTO
         4 000057   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000060   000062 601000 4                  TNZ     s:14775

  14774  4 000061   000000 702200 xent               TSX2  ! X66_ARET

      839    14775    2      IF ADDR(ARS) = ADDR(NIL) THEN GOTO IO_ERROR;

  14775  4 000062   200004 236100                    LDQ     @ARS,,AUTO
         4 000063   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000064   000330 600000 4                  TZE     IO_ERROR

      840    14776    2      CALL ASB$GET_MORE_SEG( SEG_TYPE, 4096 ) ALTRET(IO_ERROR);

  14776  4 000065   000003 236000 5                  LDQ     3
         4 000066   200005 235100                    LDA     @SEG_TYPE,,AUTO
         4 000067   200006 757100                    STAQ    @SEG_TYPE+1,,AUTO
         4 000070   200006 630500                    EPPR0   @SEG_TYPE+1,,AUTO
         4 000071   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000072   000000 701000 xent               TSX1    ASB$GET_MORE_SEG
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:153  
         4 000073   000330 702000 4                  TSX2    IO_ERROR

      841    14777    2      ARS = ARS + 4096 ;

  14777  4 000074   200004 470500                    LDP0    @ARS,,AUTO
         4 000075   000000 235100                    LDA     0,,PR0
         4 000076   010000 035007                    ADLA    4096,DL
         4 000077   000000 755100                    STA     0,,PR0

      842    14778    2      GOTO READ_REC ;

  14778  4 000100   000010 710000 4                  TRA     READ_REC

      843    14779    2      END;
      844    14780    1   AS_DCBNUM# = DCBNUM( M$HLP );

  14780  4 000101   000000 236007 xsym               LDQ     M$HLP,DL
         4 000102   000000 756000 xsym               STQ     AS_DCBNUM#

      845    14781    1   ALTRETURN ;

  14781  4 000103   000000 702200 xent               TSX2  ! X66_AALT

      846    14782                                                              /**/
      847    14783    1   ASB$WRITE_HLP: ENTRY (BUF$, ARS) ALTRET;

  14783  4 000104   000000 700200 xent  ASB$WRITE_H* TSX0  ! X66_AUTO_3
         4 000105   000010 000003                    ZERO    8,3

      848    14784                                                              /*
      849    14785                                                                   Set BUF$ in write fpt
      850    14786                                                              */
      851    14787    1   WRITE_FPT.BUF_.BUF$ = BUF$ ;

  14787  4 000106   200003 470500                    LDP0    @BUF$,,AUTO
         4 000107   000000 236100                    LDQ     0,,PR0
         4 000110   000257 756000 2                  STQ     WRITE_FPT+5
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:154  

      852    14788    1   WRITE_FPT.BUF_.BOUND = ARS - 1 ;

  14788  4 000111   200004 471500                    LDP1    @ARS,,AUTO
         4 000112   100000 236100                    LDQ     0,,PR1
         4 000113   000001 136007                    SBLQ    1,DL
         4 000114   000020 736000                    QLS     16
         4 000115   000256 676000 2                  ERQ     WRITE_FPT+4
         4 000116   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000117   000256 656000 2                  ERSQ    WRITE_FPT+4

      853    14789    1   CALL M$WRITE (WRITE_FPT) ALTRET(IO_ERROR) ;

  14789  4 000120   000252 630400 2                  EPPR0   WRITE_FPT
         4 000121   440001 713400                    CLIMB   alt,write
         4 000122   401400 401760                    pmme    nvectors=4
         4 000123   000330 702000 4                  TSX2    IO_ERROR

      854    14790    1   RETURN ;

  14790  4 000124   000000 702200 xent               TSX2  ! X66_ARET

      855    14791                                                                                      /**/
      856    14792    1   ASB$DELREC_HLP: ENTRY ALTRET;

  14792  4 000125   000000 700200 xent  ASB$DELREC_* TSX0  ! X66_AUTO_3
         4 000126   000010 000003                    ZERO    8,3

      857    14793    1   CALL M$DELREC (DELREC_FPT) ALTRET(IO_ERROR) ;

  14793  4 000127   000266 630400 2                  EPPR0   DELREC_FPT
         4 000130   440002 713400                    CLIMB   alt,+16386
         4 000131   401400 401760                    pmme    nvectors=4
         4 000132   000330 702000 4                  TSX2    IO_ERROR

      858    14794    1   RETURN ;

PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:155  
  14794  4 000133   000000 702200 xent               TSX2  ! X66_ARET

      859    14795                                                                                      /**/
      860    14796    1   ASB$OPEN_HLP_CR: ENTRY ALTRET;

  14796  4 000134   000000 700200 xent  ASB$OPEN_HL* TSX0  ! X66_AUTO_3
         4 000135   000010 000003                    ZERO    8,3

      861    14797    1   CALL M$OPEN (OPEN_CR_FPT) ALTRET(IO_ERROR) ;

  14797  4 000136   000012 630400 2                  EPPR0   OPEN_CR_FPT
         4 000137   450000 713400                    CLIMB   alt,open
         4 000140   410400 401760                    pmme    nvectors=18
         4 000141   000330 702000 4                  TSX2    IO_ERROR

      862    14798    1   RETURN ;

  14798  4 000142   000000 702200 xent               TSX2  ! X66_ARET

      863    14799                                                                                      /**/
      864    14800    1   ASB$OPEN_HLP_UP: ENTRY ALTRET;

  14800  4 000143   000000 700200 xent  ASB$OPEN_HL* TSX0  ! X66_AUTO_3
         4 000144   000010 000003                    ZERO    8,3

      865    14801    1   CALL M$OPEN (OPEN_UP_FPT) ALTRET(IO_ERROR) ;

  14801  4 000145   000104 630400 2                  EPPR0   OPEN_UP_FPT
         4 000146   450000 713400                    CLIMB   alt,open
         4 000147   410400 401760                    pmme    nvectors=18
         4 000150   000330 702000 4                  TSX2    IO_ERROR

      866    14802    1   RETURN ;

  14802  4 000151   000000 702200 xent               TSX2  ! X66_ARET

      867    14803                                                                                      /**/
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:156  
      868    14804    1   ASB$CLOSE_HLP: ENTRY ALTRET;

  14804  4 000152   000000 700200 xent  ASB$CLOSE_H* TSX0  ! X66_AUTO_3
         4 000153   000010 000003                    ZERO    8,3

      869    14805    1   CALL M$CLOSE (CLOSE_FPT) ;

  14805  4 000154   000176 630400 2                  EPPR0   CLOSE_FPT
         4 000155   050001 713400                    CLIMB   close
         4 000156   406000 401760                    pmme    nvectors=13

      870    14806    1   RETURN ;

  14806  4 000157   000000 702200 xent               TSX2  ! X66_ARET

      871    14807                                                                  /**/
      872    14808    1   ASB$READ_HLP_SEQ: ENTRY (BUF$, ARS, SEG_TYPE) ALTRET;

  14808  4 000160   000000 700200 xent  ASB$READ_HL* TSX0  ! X66_AUTO_3
         4 000161   000010 000003                    ZERO    8,3

      873    14809    1   USERS_KEY.TXTC = AS_BLANK ;

  14809  4 000162   040000 100400                    MLR     fill='040'O
         4 000163   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 000164   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41

      874    14810    1   READ_SEQ_FPT.BUF_.BUF$ = BUF$ ;

  14810  4 000165   200003 470500                    LDP0    @BUF$,,AUTO
         4 000166   000000 236100                    LDQ     0,,PR0
         4 000167   000305 756000 2                  STQ     READ_SEQ_FPT+5

      875    14811    1   READ_SEQ:
      876    14812    1   READ_SEQ_FPT.BUF_.BOUND = ARS - 1 ;

  14812  4 000170   200004 470500       READ_SEQ     LDP0    @ARS,,AUTO
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:157  
         4 000171   000000 236100                    LDQ     0,,PR0
         4 000172   000001 136007                    SBLQ    1,DL
         4 000173   000020 736000                    QLS     16
         4 000174   000304 676000 2                  ERQ     READ_SEQ_FPT+4
         4 000175   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000176   000304 656000 2                  ERSQ    READ_SEQ_FPT+4

      877    14813    1   CALL M$READ(READ_SEQ_FPT) ALTRET (READ_SEQ_ERROR) ;

  14813  4 000177   000300 630400 2                  EPPR0   READ_SEQ_FPT
         4 000200   440000 713400                    CLIMB   alt,read
         4 000201   401400 401760                    pmme    nvectors=4
         4 000202   000215 702000 4                  TSX2    READ_SEQ_ERROR

      878    14814    1   HLP$ = DCBADDR( DCBNUM( M$HLP )) ;

  14814  4 000203   000000 236007 xsym               LDQ     M$HLP,DL
         4 000204   000001 470400 5                  LDP0    1
         4 000205   000000 471500                    LDP1    0,,PR0
         4 000206   100000 236106                    LDQ     0,QL,PR1
         4 000207   000010 756000 2                  STQ     HLP$

      879    14815    1   ARS = HLP$ -> F$DCB.ARS# ;

  14815  4 000210   000010 473400 2                  LDP3    HLP$
         4 000211   300000 235100                    LDA     0,,PR3
         4 000212   200004 474500                    LDP4    @ARS,,AUTO
         4 000213   400000 755100                    STA     0,,PR4

      880    14816    1   RETURN ;

  14816  4 000214   000000 702200 xent               TSX2  ! X66_ARET

      881    14817    1   READ_SEQ_ERROR:
      882    14818    1   MERR_CODE = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR ;

  14818  4 000215   000000 470400 xsym  READ_SEQ_ER* LDP0    B$TCB$
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:158  
         4 000216   000000 471500                    LDP1    0,,PR0
         4 000217   100102 236100                    LDQ     66,,PR1
         4 000220   000000 756000 xsym               STQ     ERR_CODE

      883    14819    1   IF MERR_CODE.CODE = %E$LD

  14819  4 000221   000000 236000 xsym               LDQ     ERR_CODE
         4 000222   377770 376007                    ANQ     131064,DL
         4 000223   000070 116007                    CMPQ    56,DL
         4 000224   000300 601000 4                  TNZ     s:14835

      884    14820    2   THEN DO;

      885    14821    2      IF ADDR(SEG_TYPE) = ADDR(NIL) THEN RETURN;  /* Lost data is ok */

  14821  4 000225   200005 236100                    LDQ     @SEG_TYPE,,AUTO
         4 000226   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000227   000231 601000 4                  TNZ     s:14822

  14821  4 000230   000000 702200 xent               TSX2  ! X66_ARET

      886    14822    2      CALL ASB$GET_MORE_SEG( SEG_TYPE, 4096 ) ALTRET(IO_ERROR);

  14822  4 000231   000003 236000 5                  LDQ     3
         4 000232   200005 235100                    LDA     @SEG_TYPE,,AUTO
         4 000233   200006 757100                    STAQ    @SEG_TYPE+1,,AUTO
         4 000234   200006 630500                    EPPR0   @SEG_TYPE+1,,AUTO
         4 000235   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000236   000000 701000 xent               TSX1    ASB$GET_MORE_SEG
         4 000237   000330 702000 4                  TSX2    IO_ERROR

      887    14823    2      ARS = ARS + 4096 ;

  14823  4 000240   200004 470500                    LDP0    @ARS,,AUTO
         4 000241   000000 235100                    LDA     0,,PR0
         4 000242   010000 035007                    ADLA    4096,DL
         4 000243   000000 755100                    STA     0,,PR0
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:159  

      888    14824                                                       /* setup for precord */
      889    14825    2      PREC_FPT.V.KEYR# = AS_FALSE;

  14825  4 000244   000000 236000 xsym               LDQ     AS_FALSE
         4 000245   000023 772000                    QRL     19
         4 000246   000330 676000 2                  ERQ     PREC_FPT+6
         4 000247   200000 376007                    ANQ     65536,DL
         4 000250   000330 656000 2                  ERSQ    PREC_FPT+6

      890    14826    2      PREC_FPT.V.KEYS# = AS_FALSE;

  14826  4 000251   000000 236000 xsym               LDQ     AS_FALSE
         4 000252   000022 772000                    QRL     18
         4 000253   000330 676000 2                  ERQ     PREC_FPT+6
         4 000254   400000 376007                    ANQ     -131072,DL
         4 000255   000330 656000 2                  ERSQ    PREC_FPT+6

      891    14827    2      PREC_FPT.V.N# = -1;

  14827  4 000256   000001 335007                    LCA     1,DL
         4 000257   000331 755000 2                  STA     PREC_FPT+7

      892    14828    2      CALL M$PRECORD (PREC_FPT) ALTRET (IO_ERROR);

  14828  4 000260   000322 630400 2                  EPPR0   PREC_FPT
         4 000261   440003 713400                    CLIMB   alt,+16387
         4 000262   401000 401760                    pmme    nvectors=3
         4 000263   000330 702000 4                  TSX2    IO_ERROR

      893    14829                                                       /* reset PREC_FPT */
      894    14830    2      PREC_FPT.V.KEYR# = AS_TRUE;

  14830  4 000264   000000 236000 xsym               LDQ     AS_TRUE
         4 000265   000023 772000                    QRL     19
         4 000266   000330 676000 2                  ERQ     PREC_FPT+6
         4 000267   200000 376007                    ANQ     65536,DL
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:160  
         4 000270   000330 656000 2                  ERSQ    PREC_FPT+6

      895    14831    2      PREC_FPT.V.KEYS# = AS_TRUE;

  14831  4 000271   000000 236000 xsym               LDQ     AS_TRUE
         4 000272   000022 772000                    QRL     18
         4 000273   000330 676000 2                  ERQ     PREC_FPT+6
         4 000274   400000 376007                    ANQ     -131072,DL
         4 000275   000330 656000 2                  ERSQ    PREC_FPT+6

      896    14832    2      PREC_FPT.V.N# = 0;

  14832  4 000276   000331 450000 2                  STZ     PREC_FPT+7

      897    14833    2      GOTO READ_SEQ;

  14833  4 000277   000170 710000 4                  TRA     READ_SEQ

      898    14834    2      END;
      899    14835    1   AS_DCBNUM# = DCBNUM( M$HLP );

  14835  4 000300   000000 236007 xsym               LDQ     M$HLP,DL
         4 000301   000000 756000 xsym               STQ     AS_DCBNUM#

      900    14836    1   ALTRETURN ;

  14836  4 000302   000000 702200 xent               TSX2  ! X66_AALT

      901    14837                                                              /**/
      902    14838    1   ASB$BOF_HLP: ENTRY ALTRET;

  14838  4 000303   000000 700200 xent  ASB$BOF_HLP  TSX0  ! X66_AUTO_3
         4 000304   000010 000003                    ZERO    8,3

      903    14839    1   CALL M$PFIL(PFIL_FPT) ALTRET(IO_ERROR) ;

  14839  4 000305   000316 630400 2                  EPPR0   PFIL_FPT
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:161  
         4 000306   440004 713400                    CLIMB   alt,+16388
         4 000307   400000 401760                    pmme    nvectors=1
         4 000310   000330 702000 4                  TSX2    IO_ERROR

      904    14840    1   RETURN ;

  14840  4 000311   000000 702200 xent               TSX2  ! X66_ARET

      905    14841                                                                                      /**/
      906    14842    1   ASB$PREC_HLP: ENTRY       ALTRET;

  14842  4 000312   000000 700200 xent  ASB$PREC_HLP TSX0  ! X66_AUTO_3
         4 000313   000010 000003                    ZERO    8,3

      907    14843
      908    14844    1   CALL M$PRECORD( PREC_FPT ) ALTRET(IO_ERROR);

  14844  4 000314   000322 630400 2                  EPPR0   PREC_FPT
         4 000315   440003 713400                    CLIMB   alt,+16387
         4 000316   401000 401760                    pmme    nvectors=3
         4 000317   000330 702000 4                  TSX2    IO_ERROR

      909    14845    1   RETURN;

  14845  4 000320   000000 702200 xent               TSX2  ! X66_ARET

      910    14846
      911    14847    1   ASB$PREC_AND_SKIP_HLP: ENTRY     ALTRET;

  14847  4 000321   000000 700200 xent  ASB$PREC_AN* TSX0  ! X66_AUTO_3
         4 000322   000010 000003                    ZERO    8,3

      912    14848
      913    14849    1   CALL M$PRECORD( PREC_AND_SKIP_FPT ) ALTRET(IO_ERROR);

  14849  4 000323   000334 630400 2                  EPPR0   PREC_AND_SKIP_FPT
         4 000324   440003 713400                    CLIMB   alt,+16387
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:162  
         4 000325   401000 401760                    pmme    nvectors=3
         4 000326   000330 702000 4                  TSX2    IO_ERROR

      914    14850    1   RETURN;

  14850  4 000327   000000 702200 xent               TSX2  ! X66_ARET

  14849  4 000330                       IO_ERROR     null
      915    14851
      916    14852    1   IO_ERROR: ;
      917    14853    1   ERR_CODE = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR ;

  14853  4 000330   000000 470400 xsym               LDP0    B$TCB$
         4 000331   000000 471500                    LDP1    0,,PR0
         4 000332   100102 236100                    LDQ     66,,PR1
         4 000333   000000 756000 xsym               STQ     ERR_CODE

      918    14854    1   AS_DCBNUM# = DCBNUM( M$HLP );

  14854  4 000334   000000 236007 xsym               LDQ     M$HLP,DL
         4 000335   000000 756000 xsym               STQ     AS_DCBNUM#

      919    14855    1   ALTRETURN ;

  14855  4 000336   000000 702200 xent               TSX2  ! X66_AALT
      920    14856
      921    14857
      922    14858    1   END   ASB$HLP ;
      923    14859        %EOD ;

PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:163  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASB$HLP.
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:164  

 **** Variables and constants ****

  ****  Section 002  Data  ASB$HLP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   176-0-0/d STRC(1080)  r     1 CLOSE_FPT                266-0-0/d STRC(360)   r     1 DELREC_FPT
     0-0-0/c STRC(288)   r     1 FILE_NAME                 10-0-0/w PTR         r     1 HLP$
    12-0-0/d STRC(2088)  r     1 OPEN_CR_FPT              104-0-0/d STRC(2088)  r     1 OPEN_UP_FPT
   316-0-0/d STRC(144)   r     1 PFIL_FPT                 334-0-0/d STRC(360)   r     1 PREC_AND_SKIP_FPT
   322-0-0/d STRC(360)   r     1 PREC_FPT                 234-0-0/d STRC(504)   r     1 READ_FPT
   300-0-0/d STRC(504)   r     1 READ_SEQ_FPT             346-0-0/w STRC(621)   r     1 VLP_ATTR
   370-0-0/w STRC(126)   r     1 VLP_ATTR_ACC             252-0-0/d STRC(432)   r     1 WRITE_FPT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @ARS                       3-0-0/w PTR         r     1 @BUF$
     5-0-0/w PTR         r     1 @SEG_TYPE                 *0-0-0/w UBIN        r     1 ARS
    *0-0-0/w PTR         r     1 BUF$                      *0-0-0/w UBIN        r     1 SEG_TYPE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/w UBIN        r     1 AS_DCBNUM#
     0-0-0/b BIT         r     1 AS_FALSE                   0-0-0/b BIT         r     1 AS_TRUE
     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/b STRC        r     1 ERR_CODE
     0-0-0/c STRC(72)    r     1 FILE_ACCT                  0-0-0/w STRC(6084)  r     1 KL_DREC
     0-0-0/b STRC        r     1 MERR_CODE                  0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:165  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$HLP


   Procedure ASB$HLP requires 223 words for executable code.
   Procedure ASB$HLP requires 8 words of local(AUTO) storage.
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:166  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:167  
          MINI XREF LISTING

ARS
     13970**DCL         7--PROC    14756--ENTRY   14762--IF      14764>>ASSIGN  14766--IF      14767<<ASSIGN
     14775--IF      14777<<ASSIGN  14777>>ASSIGN  14783--ENTRY   14788>>ASSIGN  14808--ENTRY   14812>>ASSIGN
     14815<<ASSIGN  14823<<ASSIGN  14823>>ASSIGN
ASA_BRKS_LOC
     11077**DCL     11077--REDEF
ASB$GET_MORE_SEG
     14748**DCL-ENT 14776--CALL    14822--CALL
AS_BLANK
     10937**DCL     14809>>ASSIGN
AS_DCBNUM#
     11084**DCL     14780<<ASSIGN  14835<<ASSIGN  14854<<ASSIGN
AS_DEFAULT.BANNER_PERM
     11770**DCL     11771--REDEF
AS_DEFAULT.BUDGET.MACCT
     11675**DCL     11679--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     11688**DCL     11691--REDEF
AS_DEFAULT.BUDGET.PACCUM
     11671**DCL     11673--REDEF
AS_DEFAULT.BUDGET.PMAXC
     11666**DCL     11668--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     11786**DCL     11787--REDEF   11788--REDEF
AS_DEFAULT_DREC.PASSWORD
     13040**DCL     13044--REDEF
AS_DEFAULT_DREC.RENAME
     13063**DCL     13064--REDEF
AS_DFLT.BANNER_PERM
     11592**DCL     11593--REDEF
AS_DFLT.BUDGET.MACCT
     11497**DCL     11501--REDEF
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:168  
AS_DFLT.BUDGET.MAX_PROJECTS
     11510**DCL     11513--REDEF
AS_DFLT.BUDGET.PACCUM
     11493**DCL     11495--REDEF
AS_DFLT.BUDGET.PMAXC
     11488**DCL     11490--REDEF
AS_DFLT.SETUP_CHRA.TXT
     11608**DCL     11609--REDEF   11610--REDEF
AS_FALSE
     10937**DCL     14825>>ASSIGN  14826>>ASSIGN
AS_FE_MODE
     10943**DCL     10944--REDEF
AS_MODE
     10940**DCL     10942--REDEF
AS_MOD_USER.ACCESS
     13805**DCL     13806--REDEF
AS_MOD_USER.BANNER
     13792**DCL     13793--REDEF
AS_MOD_USER.BANNER_PERM
     13794**DCL     13795--REDEF
AS_MOD_USER.BILL
     13800**DCL     13801--REDEF
AS_MOD_USER.CPROC
     13796**DCL     13797--REDEF
AS_MOD_USER.FEBILL
     13876**DCL     13877--REDEF
AS_MOD_USER.FECXTMEM
     13893**DCL     13894--REDEF
AS_MOD_USER.FEMINTS
     13878**DCL     13879--REDEF
AS_MOD_USER.FEMMEM
     13889**DCL     13890--REDEF
AS_MOD_USER.FEMTIME
     13887**DCL     13888--REDEF
AS_MOD_USER.FEPPRIV
     13884**DCL     13886--REDEF
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:169  
AS_MOD_USER.FEPRIV
     13881**DCL     13883--REDEF
AS_MOD_USER.FORCE_BIT
     13790**DCL     13791--REDEF
AS_MOD_USER.KEY
     13872**DCL     13874--REDEF
AS_MOD_USER.LASTCPROC
     13798**DCL     13799--REDEF
AS_MOD_USER.LIMITS.DO_
     13846**DCL     13847--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     13862**DCL     13863--REDEF
AS_MOD_USER.LIMITS.LO
     13842**DCL     13843--REDEF
AS_MOD_USER.LIMITS.MEM
     13838**DCL     13839--REDEF
AS_MOD_USER.LIMITS.MPRIO
     13866**DCL     13867--REDEF
AS_MOD_USER.LIMITS.PDIS
     13854**DCL     13855--REDEF
AS_MOD_USER.LIMITS.PO
     13850**DCL     13851--REDEF
AS_MOD_USER.LIMITS.TDIS
     13858**DCL     13859--REDEF
AS_MOD_USER.LIMITS.TIME
     13834**DCL     13835--REDEF
AS_MOD_USER.MAXENQ
     13815**DCL     13816--REDEF
AS_MOD_USER.PERM_BIT
     13788**DCL     13789--REDEF
AS_MOD_USER.PPRIV
     13810**DCL     13812--REDEF
AS_MOD_USER.PRIOB
     13817**DCL     13818--REDEF
AS_MOD_USER.PRIV
     13807**DCL     13809--REDEF
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:170  
AS_MOD_USER.QUAN
     13813**DCL     13814--REDEF
AS_MOD_USER.SETUP
     13786**DCL     13787--REDEF
AS_PROJECT.BANNER_PERM
     12126**DCL     12127--REDEF
AS_PROJECT.BUDGET.MACCT
     12031**DCL     12035--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     12044**DCL     12047--REDEF
AS_PROJECT.BUDGET.PACCUM
     12027**DCL     12029--REDEF
AS_PROJECT.BUDGET.PMAXC
     12022**DCL     12024--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12142**DCL     12143--REDEF   12144--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     12304**DCL     12305--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     12209**DCL     12213--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     12222**DCL     12225--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     12205**DCL     12207--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     12200**DCL     12202--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     12320**DCL     12321--REDEF   12322--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     13526**DCL     13530--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     13549**DCL     13550--REDEF
AS_PROJECT_DREC.PASSWORD
     13364**DCL     13368--REDEF
AS_PROJECT_DREC.RENAME
     13387**DCL     13388--REDEF
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:171  
AS_PROJ_ADMIN.BANNER_PERM
     11948**DCL     11949--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     11853**DCL     11857--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     11866**DCL     11869--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     11849**DCL     11851--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     11844**DCL     11846--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     11964**DCL     11965--REDEF   11966--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     13202**DCL     13206--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     13225**DCL     13226--REDEF
AS_TRUE
     10937**DCL     14830>>ASSIGN  14831>>ASSIGN
AS_USERS.BANNER_PERM
     11414**DCL     11415--REDEF
AS_USERS.BUDGET.MACCT
     11319**DCL     11323--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     11332**DCL     11335--REDEF
AS_USERS.BUDGET.PACCUM
     11315**DCL     11317--REDEF
AS_USERS.BUDGET.PMAXC
     11310**DCL     11312--REDEF
AS_USERS.SETUP_CHRA.TXT
     11430**DCL     11431--REDEF   11432--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     12482**DCL     12483--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     12387**DCL     12391--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     12400**DCL     12403--REDEF
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:172  
AS_USERS_CONSTANT.BUDGET.PACCUM
     12383**DCL     12385--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     12378**DCL     12380--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     12498**DCL     12499--REDEF   12500--REDEF
B$ALT.CODE
     13948**DCL     13948--REDEF   13949--REDEF   13949--REDEF
B$ALT.ERR
     13949**DCL     14771>>ASSIGN  14818>>ASSIGN  14853>>ASSIGN
B$ALT.ERR.ERR#
     13950**DCL     13950--REDEF
B$ALT.EVID
     13949**DCL     13949--REDEF   13949--REDEF
B$TCB.ALT$
     13955**DCL     14771>>ASSIGN  14818>>ASSIGN  14853>>ASSIGN
B$TCB$
     13963**DCL     14771>>ASSIGN  14818>>ASSIGN  14853>>ASSIGN
BUF$
     13969**DCL         7--PROC    14756--ENTRY   14760>>ASSIGN  14783--ENTRY   14787>>ASSIGN  14808--ENTRY
     14810>>ASSIGN
CLOSE_FPT
     14241**DCL     14805<>CALL
CLOSE_FPT.SN_
     14241**DCL     14241--REDEF
CLOSE_FPT.UTL_
     14242**DCL     14242--REDEF
CLOSE_FPT.V
     14246**DCL     14241--DCLINIT
CLOSE_FPT.V.EXPIRE#
     14256**DCL     14256--REDEF
CLOSE_FPT.V.TYPE#
     14254**DCL     14254--REDEF
CLOSE_FPT.V.XTNSIZE#
     14251**DCL     14251--REDEF   14253--REDEF
DELREC_FPT
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:173  
     14349**DCL     14793<>CALL
DELREC_FPT.V
     14352**DCL     14349--DCLINIT
ERR_CODE
     11072**DCL     11073--REDEF   14853<<ASSIGN
F$DCB.ACTPOS
     14711**DCL     14711--REDEF
F$DCB.ARS#
     14685**DCL     14685--REDEF   14767>>ASSIGN  14815>>ASSIGN
F$DCB.ATTR
     14704**DCL     14705--REDEF
F$DCB.BORROW
     14719**DCL     14719--REDEF   14719--REDEF   14719--REDEF
F$DCB.DCBNAME.L
     14733**DCL     14733--IMP-SIZ
F$DCB.EOMCHAR#
     14689**DCL     14689--REDEF
F$DCB.FLDID
     14714**DCL     14714--REDEF
F$DCB.FORM$
     14708**DCL     14708--REDEF
F$DCB.FSECT
     14724**DCL     14724--REDEF
F$DCB.FSN#
     14701**DCL     14701--REDEF   14701--REDEF   14702--REDEF
F$DCB.HEADER$
     14707**DCL     14707--REDEF
F$DCB.IXTNSIZE#
     14705**DCL     14705--REDEF
F$DCB.LASTSTA$
     14694**DCL     14694--REDEF
F$DCB.LVL
     14720**DCL     14720--REDEF
F$DCB.NAME#.C
     14695**DCL     14695--REDEF
F$DCB.NOEOF
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:174  
     14717**DCL     14717--REDEF
F$DCB.NRECS#
     14706**DCL     14706--REDEF
F$DCB.NRECX
     14725**DCL     14725--REDEF
F$DCB.OHDR
     14717**DCL     14717--REDEF
F$DCB.ORG#
     14700**DCL     14700--REDEF
F$DCB.PRECNO
     14723**DCL     14723--REDEF
F$DCB.RCSZ
     14729**DCL     14729--REDEF
F$DCB.RES#
     14696**DCL     14696--REDEF
F$DCB.SETX
     14708**DCL     14708--REDEF
F$DCB.TAB$
     14708**DCL     14708--REDEF
F$DCB.TDA
     14722**DCL     14723--REDEF
F$DCB.WSN#
     14696**DCL     14696--REDEF
FILE_ACCT
     11080**DCL     14060--DCLINIT 14177--DCLINIT
FILE_NAME
     13935**DCL     14056--DCLINIT 14173--DCLINIT
HLP$
     13938**DCL     14814<<ASSIGN  14815>>ASSIGN
IO_ERROR
     14849**LABEL   14775--GOTO    14776--CALLALT 14789--CALLALT 14793--CALLALT 14797--CALLALT 14801--CALLALT
     14822--CALLALT 14828--CALLALT 14839--CALLALT 14844--CALLALT 14849--CALLALT
KL_DEFAULT.PASSWORD
     13688**DCL     13692--REDEF
KL_DEFAULT.RENAME
     13711**DCL     13712--REDEF
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:175  
KL_DFLT.PASSWORD
     12878**DCL     12882--REDEF
KL_DFLT.RENAME
     12901**DCL     12902--REDEF
KL_DREC
     12658**DCL     14763--ASSIGN
KL_DREC.PASSWORD
     12716**DCL     12720--REDEF
KL_DREC.RENAME
     12739**DCL     12740--REDEF
KL_DREC_CNT.PASSWORD
     12603**DCL     12607--REDEF
KL_DREC_CNT.RENAME
     12626**DCL     12627--REDEF
M$CLOSE
        43**DCL-ENT 14805--CALL
M$DELREC
        45**DCL-ENT 14793--CALL
M$HLP
     14740**DCL     14767--ASSIGN  14780>>ASSIGN  14814--ASSIGN  14835>>ASSIGN  14854>>ASSIGN
M$OPEN
        43**DCL-ENT 14797--CALL    14801--CALL
M$PFIL
        45**DCL-ENT 14839--CALL
M$PRECORD
        47**DCL-ENT 14828--CALL    14844--CALL    14849--CALL
M$READ
        44**DCL-ENT 14765--CALL    14813--CALL
M$WRITE
        44**DCL-ENT 14789--CALL
MERR_CODE
     11073**DCL     14771<<ASSIGN  14818<<ASSIGN
MERR_CODE.CODE
     11073**DCL     14772>>IF      14819>>IF
OPEN_CR_FPT
     14055**DCL     14797<>CALL
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:176  
OPEN_CR_FPT.ACSVEH_
     14057**DCL     14058--REDEF
OPEN_CR_FPT.ALTKEYS_
     14063**DCL     14064--REDEF   14064--REDEF
OPEN_CR_FPT.HDR_
     14062**DCL     14063--REDEF
OPEN_CR_FPT.TAB_
     14061**DCL     14062--REDEF
OPEN_CR_FPT.UHL_
     14055**DCL     14056--REDEF   14056--REDEF
OPEN_CR_FPT.V
     14064**DCL     14055--DCLINIT
OPEN_CR_FPT.V.FSN#
     14095**DCL     14095--REDEF   14095--REDEF
OPEN_CR_FPT.WSN_
     14061**DCL     14061--REDEF
OPEN_UP_FPT
     14172**DCL     14801<>CALL
OPEN_UP_FPT.ACSVEH_
     14174**DCL     14175--REDEF
OPEN_UP_FPT.ALTKEYS_
     14180**DCL     14181--REDEF   14181--REDEF
OPEN_UP_FPT.HDR_
     14179**DCL     14180--REDEF
OPEN_UP_FPT.TAB_
     14178**DCL     14179--REDEF
OPEN_UP_FPT.UHL_
     14172**DCL     14173--REDEF   14173--REDEF
OPEN_UP_FPT.V
     14181**DCL     14172--DCLINIT
OPEN_UP_FPT.V.FSN#
     14212**DCL     14212--REDEF   14212--REDEF
OPEN_UP_FPT.WSN_
     14178**DCL     14178--REDEF
PFIL_FPT
     14413**DCL     14839<>CALL
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:177  
PFIL_FPT.V
     14413**DCL     14413--DCLINIT
PREC_AND_SKIP_FPT
     14459**DCL     14849<>CALL
PREC_AND_SKIP_FPT.V
     14461**DCL     14459--DCLINIT
PREC_FPT
     14433**DCL     14828<>CALL    14844<>CALL
PREC_FPT.V
     14435**DCL     14433--DCLINIT
PREC_FPT.V.KEYR#
     14436**DCL     14825<<ASSIGN  14830<<ASSIGN
PREC_FPT.V.KEYS#
     14436**DCL     14826<<ASSIGN  14831<<ASSIGN
PREC_FPT.V.N#
     14439**DCL     14827<<ASSIGN  14832<<ASSIGN
PROJ_KEY.TEXT
     10950**DCL     10950--REDEF
PROJ_KEY.TXT.PROJECT
     10950**DCL     10950--REDEF
READ_ERROR
     14771**LABEL   14765--CALLALT
READ_FPT
     14280**DCL     14765<>CALL
READ_FPT.BUF_.BOUND
     14282**DCL     14763<<ASSIGN  14764<<ASSIGN
READ_FPT.BUF_.BUF$
     14283**DCL     14760<<ASSIGN
READ_FPT.STATION_
     14283**DCL     14284--REDEF
READ_FPT.V
     14284**DCL     14280--DCLINIT
READ_FPT.V.DVBYTE.REREAD#
     14295**DCL     14295--REDEF
READ_FPT.V.INDX#
     14293**DCL     14293--REDEF
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:178  
READ_REC
     14762**LABEL   14778--GOTO
READ_SEQ
     14812**LABEL   14833--GOTO
READ_SEQ_ERROR
     14818**LABEL   14813--CALLALT
READ_SEQ_FPT
     14378**DCL     14813<>CALL
READ_SEQ_FPT.BUF_.BOUND
     14380**DCL     14812<<ASSIGN
READ_SEQ_FPT.BUF_.BUF$
     14381**DCL     14810<<ASSIGN
READ_SEQ_FPT.STATION_
     14381**DCL     14382--REDEF
READ_SEQ_FPT.V
     14382**DCL     14378--DCLINIT
READ_SEQ_FPT.V.DVBYTE.REREAD#
     14393**DCL     14393--REDEF
READ_SEQ_FPT.V.INDX#
     14391**DCL     14391--REDEF
REMEM_VAR
     11076**DCL     11076--REDEF
REM_FCMD
     11076**DCL     11077--REDEF
SEG_TYPE
     13971**DCL         7--PROC    14756--ENTRY   14774--IF      14776<>CALL    14808--ENTRY   14821--IF
     14822<>CALL
USERS_KEY
     10947**DCL     14280--DCLINIT 14281--DCLINIT 14322--DCLINIT 14349--DCLINIT 14350--DCLINIT 14378--DCLINIT
     14379--DCLINIT 14433--DCLINIT 14434--DCLINIT 14459--DCLINIT 14460--DCLINIT
USERS_KEY.TEXT
     10947**DCL     10948--REDEF   10948--REDEF   10948--REDEF   10949--REDEF
USERS_KEY.TXTC
     10948**DCL     14809<<ASSIGN
VLP_ATTR
     14486**DCL     14058--DCLINIT
PL6.E3A0      #003=ASB$HLP File=ASB$FILES.:E05TSI                                TUE 07/29/97 09:16 Page:179  
VLP_ATTR.Q
     14487**DCL     14486--DCLINIT
VLP_ATTR_ACC
     14651**DCL     14057--DCLINIT
VLP_ATTR_ACC.Q
     14652**DCL     14651--DCLINIT
WRITE_FPT
     14322**DCL     14789<>CALL
WRITE_FPT.BUF_.BOUND
     14322**DCL     14788<<ASSIGN
WRITE_FPT.BUF_.BUF$
     14324**DCL     14787<<ASSIGN
WRITE_FPT.STATION_
     14324**DCL     14324--REDEF
WRITE_FPT.V
     14325**DCL     14322--DCLINIT
WRITE_FPT.V.DVBYTE.VFC#
     14331**DCL     14331--REDEF

PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:180  
      924        1        /*M* ASB$NETCON - entry points to READ/WRITE etc. :NETCON */
      925        2        /*T***********************************************************/
      926        3        /*T*                                                         */
      927        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      928        5        /*T*                                                         */
      929        6        /*T***********************************************************/
      930        7        ASB$NETCON: PROC(KEY_,BUF_,BOUND) ALTRET;
      931        8        /**/
      932        9        %INCLUDE F$DCB                ;
      933       58              %INCLUDE AS_ENTRIES_M   ;
      934     1108              %INCLUDE CP_6           ;
      935     1189              %INCLUDE AS_PERR_C      ;
      936     1791              %INCLUDE B_ERRORS_C     ;
      937     2918              %INCLUDE AS_SUPER_C     ;
      938     3353              %INCLUDE AS_SUBS_C      ;
      939     4767              %INCLUDE XU_MACRO_C     ;
      940     7873              %INCLUDE KL_SUPER_C     ;
      941    10775              %INCLUDE XU_FORMAT_C    ;
      942    10937              %INCLUDE AS_SUPER_R     ;
      943    13953        /**/
      944    13954    1   DCL KEY_ VECTOR;
      945    13955    1   DCL BUF_ VECTOR;
      946    13956    1   DCL BOUND UBIN;
      947    13957        /**/
      948    13958    1   DCL M$NETCON DCB;
      949    13959    1   DCL B$TCB$ PTR SYMREF;
      950    13960        %B$TCB;
      951    13963        %B$ALT;
      952    13971        /**/
      953    13972        %FPT_OPEN (FPTN=OPEN_NETCON,
      954    13973                   DCB=M$NETCON,
      955    13974                   NAME=NETCON,
      956    13975                   ACCT=FILE_ACCT,
      957    13976                   ORG=KEYED,
      958    13977                   FUN=UPDATE,
      959    13978                   SHARE=ALL,
      960    13979                   ASN=FILE,
PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:181  
      961    13980                   ACS=DIRECT);
      962    14089        %FPT_READ (FPTN=READ_NETCON,
      963    14090                   DCB=M$NETCON,
      964    14091                   KEYS=YES);
      965    14130        %FPT_WRITE (FPTN=WRITE_NETCON,
      966    14131                    DCB=M$NETCON);
      967    14162        %FPT_CLOSE (FPTN=CLOSE_NETCON,
      968    14163                    DCB=M$NETCON);
      969    14205        %FPT_DELREC (FPTN=DELREC_NETCON,
      970    14206                     DCB=M$NETCON);
      971    14225        %VLP_NAME (FPTN=NETCON,
      972    14226                   NAME=':NETCON');
      973    14253        /**/
      974    14254        %EJECT;
PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:182  
      975    14255    1   ASB$READ_NETCON: ENTRY(KEY_,BUF_,BOUND) ALTRET;
      976    14256    1   IF NOT DCBADDR(DCBNUM(M$NETCON))->F$DCB.FCD
      977    14257    1   THEN CALL M$OPEN(OPEN_NETCON)
      978    14258    2      WHENALTRETURN DO;
      979    14259    2         AS_DCBNUM# = DCBNUM (M$NETCON) ;
      980    14260    2         ERR_CODE = B$TCB$-> B$TCB.ALT$-> B$ALT.ERR;
      981    14261    2         ALTRETURN;
      982    14262    2         END; /* Whenaltreturn */
      983    14263    1   READ_NETCON.KEY_ = KEY_;
      984    14264    1   READ_NETCON.BUF_ = BUF_;
      985    14265    1   CALL M$READ(READ_NETCON)
      986    14266    2   WHENALTRETURN DO;
      987    14267    2      AS_DCBNUM# = DCBNUM (M$NETCON) ;
      988    14268    2      ERR_CODE = B$TCB$-> B$TCB.ALT$-> B$ALT.ERR;
      989    14269    2      ALTRETURN;
      990    14270    2      END; /* Whenaltreturn */
      991    14271    1   IF ADDR(BOUND) ~= ADDR(NIL)
      992    14272    1   THEN BOUND = DCBADDR(DCBNUM(M$NETCON))->F$DCB.ARS;
      993    14273    1   RETURN;
      994    14274    1   ASB$WRITE_NETCON: ENTRY(KEY_,BUF_,BOUND) ALTRET;
      995    14275    1   IF NOT DCBADDR(DCBNUM(M$NETCON))->F$DCB.FCD
      996    14276    1   THEN CALL M$OPEN(OPEN_NETCON)
      997    14277    2      WHENALTRETURN DO;
      998    14278    2         AS_DCBNUM# = DCBNUM (M$NETCON) ;
      999    14279    2         ERR_CODE = B$TCB$-> B$TCB.ALT$-> B$ALT.ERR;
     1000    14280    2         ALTRETURN;
     1001    14281    2         END; /* Whenaltreturn */
     1002    14282    1   WRITE_NETCON.KEY_ = KEY_;
     1003    14283    1   WRITE_NETCON.BUF_ = BUF_;
     1004    14284    1   IF ADDR(BOUND) ~= ADDR(NIL)
     1005    14285    1   THEN WRITE_NETCON.BUF_.BOUND = BOUND;
     1006    14286    1   CALL M$WRITE(WRITE_NETCON)
     1007    14287    2   WHENALTRETURN DO;
     1008    14288    2      AS_DCBNUM# = DCBNUM (M$NETCON) ;
     1009    14289    2      ERR_CODE = B$TCB$-> B$TCB.ALT$-> B$ALT.ERR;
     1010    14290    2      ALTRETURN;
     1011    14291    2      END; /* Whenaltreturn */
PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:183  
     1012    14292    1   RETURN;
     1013    14293    1   ASB$CLOSE_NETCON: ENTRY ALTRET;
     1014    14294    1   IF DCBADDR(DCBNUM(M$NETCON))->F$DCB.FCD
     1015    14295    1   THEN CALL M$CLOSE(CLOSE_NETCON);
     1016    14296    1   RETURN;
     1017    14297    1   ASB$OPEN_NETCON: ENTRY ALTRET;
     1018    14298    1   IF NOT DCBADDR(DCBNUM(M$NETCON))->F$DCB.FCD
     1019    14299    1   THEN CALL M$OPEN(OPEN_NETCON)
     1020    14300    2      WHENALTRETURN DO;
     1021    14301    2         AS_DCBNUM# = DCBNUM (M$NETCON) ;
     1022    14302    2         ERR_CODE = B$TCB$-> B$TCB.ALT$-> B$ALT.ERR;
     1023    14303    2         ALTRETURN;
     1024    14304    2         END; /* Whenaltreturn */
     1025    14305    1   RETURN;
     1026    14306    1   ASB$DELREC_NETCON: ENTRY(KEY_) ALTRET;
     1027    14307    1   IF NOT DCBADDR(DCBNUM(M$NETCON))->F$DCB.FCD
     1028    14308    1   THEN CALL M$OPEN(OPEN_NETCON)
     1029    14309    2      WHENALTRETURN DO;
     1030    14310    2         AS_DCBNUM# = DCBNUM (M$NETCON) ;
     1031    14311    2         ERR_CODE = B$TCB$-> B$TCB.ALT$-> B$ALT.ERR;
     1032    14312    2         ALTRETURN;
     1033    14313    2         END; /* Whenaltreturn */
     1034    14314    1   DELREC_NETCON.KEY_ = KEY_;
     1035    14315    1   CALL M$DELREC(DELREC_NETCON)
     1036    14316    2   WHENALTRETURN DO;
     1037    14317    2      AS_DCBNUM# = DCBNUM (M$NETCON) ;
     1038    14318    2      ERR_CODE = B$TCB$-> B$TCB.ALT$-> B$ALT.ERR;
     1039    14319    2      ALTRETURN;
     1040    14320    2      END; /* Whenaltreturn */
     1041    14321    1   RETURN;
     1042    14322    1   END ASB$NETCON;
     1043    14323        %EOD;

PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:184  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASB$NETCON.

   Procedure ASB$NETCON requires 174 words for executable code.
   Procedure ASB$NETCON requires 6 words of local(AUTO) storage.

PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:185  

 Object Unit name= ASB$NETCON                                 File name= ASB$FILES.:E05TOU
 UTS= JUL 29 '97 09:17:27.16 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2   DCB   even  none     0      0  M$NETCON
    3   Data  even  none   126    176  ASB$NETCON
    4   Proc  even  none   174    256  ASB$NETCON
    5  RoData even  none     1      1  ASB$NETCON

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        3  ASB$NETCON
     4      3          yes     yes      Std        3  ASB$READ_NETCON
     4     65          yes     yes      Std        3  ASB$WRITE_NETCON
     4    146          yes     yes      Std        0  ASB$CLOSE_NETCON
     4    163          yes     yes      Std        0  ASB$OPEN_NETCON
     4    211          yes     yes      Std        1  ASB$DELREC_NETCON

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_AALT
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:186  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    AS_MODE                          r    AS_FE_MODE
     M$LO                                  ERR_CODE                              REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          FILE_ACCT
     AS_DCBNUM#                            M$NETCON                              B$TCB$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:187  


      924        1        /*M* ASB$NETCON - entry points to READ/WRITE etc. :NETCON */
      925        2        /*T***********************************************************/
      926        3        /*T*                                                         */
      927        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      928        5        /*T*                                                         */
      929        6        /*T***********************************************************/
      930        7        ASB$NETCON: PROC(KEY_,BUF_,BOUND) ALTRET;

      7  4 000000   000000 700200 xent  ASB$NETCON   TSX0  ! X66_AUTO_3
         4 000001   000006 000003                    ZERO    6,3
         4 000002   000005 710000 4                  TRA     s:14256

      931        8        /**/
      932        9        %INCLUDE F$DCB                ;
      933       58              %INCLUDE AS_ENTRIES_M   ;
      934     1108              %INCLUDE CP_6           ;
      935     1189              %INCLUDE AS_PERR_C      ;
      936     1791              %INCLUDE B_ERRORS_C     ;
      937     2918              %INCLUDE AS_SUPER_C     ;
      938     3353              %INCLUDE AS_SUBS_C      ;
      939     4767              %INCLUDE XU_MACRO_C     ;
      940     7873              %INCLUDE KL_SUPER_C     ;
      941    10775              %INCLUDE XU_FORMAT_C    ;
      942    10937              %INCLUDE AS_SUPER_R     ;
      943    13953        /**/
      944    13954    1   DCL KEY_ VECTOR;
      945    13955    1   DCL BUF_ VECTOR;
      946    13956    1   DCL BOUND UBIN;
      947    13957        /**/
      948    13958    1   DCL M$NETCON DCB;
      949    13959    1   DCL B$TCB$ PTR SYMREF;
      950    13960        %B$TCB;
      951    13963        %B$ALT;
      952    13971        /**/
      953    13972        %FPT_OPEN (FPTN=OPEN_NETCON,
      954    13973                   DCB=M$NETCON,
PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:188  
      955    13974                   NAME=NETCON,
      956    13975                   ACCT=FILE_ACCT,
      957    13976                   ORG=KEYED,
      958    13977                   FUN=UPDATE,
      959    13978                   SHARE=ALL,
      960    13979                   ASN=FILE,
      961    13980                   ACS=DIRECT);
      962    14089        %FPT_READ (FPTN=READ_NETCON,
      963    14090                   DCB=M$NETCON,
      964    14091                   KEYS=YES);
      965    14130        %FPT_WRITE (FPTN=WRITE_NETCON,
      966    14131                    DCB=M$NETCON);
      967    14162        %FPT_CLOSE (FPTN=CLOSE_NETCON,
      968    14163                    DCB=M$NETCON);
      969    14205        %FPT_DELREC (FPTN=DELREC_NETCON,
      970    14206                     DCB=M$NETCON);
      971    14225        %VLP_NAME (FPTN=NETCON,
      972    14226                   NAME=':NETCON');
      973    14253        /**/
      974    14254        %EJECT;
PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:189  
      975    14255    1   ASB$READ_NETCON: ENTRY(KEY_,BUF_,BOUND) ALTRET;

  14255  4 000003   000000 700200 xent  ASB$READ_NE* TSX0  ! X66_AUTO_3
         4 000004   000006 000003                    ZERO    6,3

      976    14256    1   IF NOT DCBADDR(DCBNUM(M$NETCON))->F$DCB.FCD

  14256  4 000005   000000 236007 xsym               LDQ     M$NETCON,DL
         4 000006   000000 470400 5                  LDP0    0
         4 000007   000000 471500                    LDP1    0,,PR0
         4 000010   100000 473506                    LDP3    0,QL,PR1
         4 000011   300031 236100                    LDQ     25,,PR3
         4 000012   020000 316007                    CANQ    8192,DL
         4 000013   000030 601000 4                  TNZ     s:14263

      977    14257    1   THEN CALL M$OPEN(OPEN_NETCON)

  14257  4 000014   000000 630400 3                  EPPR0   OPEN_NETCON
         4 000015   450000 713400                    CLIMB   alt,open
         4 000016   410400 401760                    pmme    nvectors=18
         4 000017   000021 702000 4                  TSX2    s:14259
         4 000020   000030 710000 4                  TRA     s:14263

      978    14258    2      WHENALTRETURN DO;

      979    14259    2         AS_DCBNUM# = DCBNUM (M$NETCON) ;

  14259  4 000021   000000 236007 xsym               LDQ     M$NETCON,DL
         4 000022   000000 756000 xsym               STQ     AS_DCBNUM#

      980    14260    2         ERR_CODE = B$TCB$-> B$TCB.ALT$-> B$ALT.ERR;

  14260  4 000023   000000 470400 xsym               LDP0    B$TCB$
         4 000024   000000 471500                    LDP1    0,,PR0
         4 000025   100102 236100                    LDQ     66,,PR1
         4 000026   000000 756000 xsym               STQ     ERR_CODE

PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:190  
      981    14261    2         ALTRETURN;

  14261  4 000027   000000 702200 xent               TSX2  ! X66_AALT

      982    14262    2         END; /* Whenaltreturn */
      983    14263    1   READ_NETCON.KEY_ = KEY_;

  14263  4 000030   200003 470500                    LDP0    @KEY_,,AUTO
         4 000031   000000 237100                    LDAQ    0,,PR0
         4 000032   000074 757000 3                  STAQ    READ_NETCON+2

      984    14264    1   READ_NETCON.BUF_ = BUF_;

  14264  4 000033   200004 471500                    LDP1    @BUF_,,AUTO
         4 000034   100000 237100                    LDAQ    0,,PR1
         4 000035   000076 757000 3                  STAQ    READ_NETCON+4

      985    14265    1   CALL M$READ(READ_NETCON)

  14265  4 000036   000072 630400 3                  EPPR0   READ_NETCON
         4 000037   440000 713400                    CLIMB   alt,read
         4 000040   401400 401760                    pmme    nvectors=4
         4 000041   000043 702000 4                  TSX2    s:14267
         4 000042   000052 710000 4                  TRA     s:14271

      986    14266    2   WHENALTRETURN DO;

      987    14267    2      AS_DCBNUM# = DCBNUM (M$NETCON) ;

  14267  4 000043   000000 236007 xsym               LDQ     M$NETCON,DL
         4 000044   000000 756000 xsym               STQ     AS_DCBNUM#

      988    14268    2      ERR_CODE = B$TCB$-> B$TCB.ALT$-> B$ALT.ERR;

  14268  4 000045   000000 470400 xsym               LDP0    B$TCB$
         4 000046   000000 471500                    LDP1    0,,PR0
         4 000047   100102 236100                    LDQ     66,,PR1
PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:191  
         4 000050   000000 756000 xsym               STQ     ERR_CODE

      989    14269    2      ALTRETURN;

  14269  4 000051   000000 702200 xent               TSX2  ! X66_AALT

      990    14270    2      END; /* Whenaltreturn */
      991    14271    1   IF ADDR(BOUND) ~= ADDR(NIL)

  14271  4 000052   200005 236100                    LDQ     @BOUND,,AUTO
         4 000053   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000054   000064 600000 4                  TZE     s:14273

      992    14272    1   THEN BOUND = DCBADDR(DCBNUM(M$NETCON))->F$DCB.ARS;

  14272  4 000055   000000 236007 xsym               LDQ     M$NETCON,DL
         4 000056   000000 470400 5                  LDP0    0
         4 000057   000000 471500                    LDP1    0,,PR0
         4 000060   100000 473506                    LDP3    0,QL,PR1
         4 000061   300000 235100                    LDA     0,,PR3
         4 000062   200005 473500                    LDP3    @BOUND,,AUTO
         4 000063   300000 755100                    STA     0,,PR3

      993    14273    1   RETURN;

  14273  4 000064   000000 702200 xent               TSX2  ! X66_ARET

      994    14274    1   ASB$WRITE_NETCON: ENTRY(KEY_,BUF_,BOUND) ALTRET;

  14274  4 000065   000000 700200 xent  ASB$WRITE_N* TSX0  ! X66_AUTO_3
         4 000066   000006 000003                    ZERO    6,3

      995    14275    1   IF NOT DCBADDR(DCBNUM(M$NETCON))->F$DCB.FCD

  14275  4 000067   000000 236007 xsym               LDQ     M$NETCON,DL
         4 000070   000000 470400 5                  LDP0    0
         4 000071   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:192  
         4 000072   100000 473506                    LDP3    0,QL,PR1
         4 000073   300031 236100                    LDQ     25,,PR3
         4 000074   020000 316007                    CANQ    8192,DL
         4 000075   000112 601000 4                  TNZ     s:14282

      996    14276    1   THEN CALL M$OPEN(OPEN_NETCON)

  14276  4 000076   000000 630400 3                  EPPR0   OPEN_NETCON
         4 000077   450000 713400                    CLIMB   alt,open
         4 000100   410400 401760                    pmme    nvectors=18
         4 000101   000103 702000 4                  TSX2    s:14278
         4 000102   000112 710000 4                  TRA     s:14282

      997    14277    2      WHENALTRETURN DO;

      998    14278    2         AS_DCBNUM# = DCBNUM (M$NETCON) ;

  14278  4 000103   000000 236007 xsym               LDQ     M$NETCON,DL
         4 000104   000000 756000 xsym               STQ     AS_DCBNUM#

      999    14279    2         ERR_CODE = B$TCB$-> B$TCB.ALT$-> B$ALT.ERR;

  14279  4 000105   000000 470400 xsym               LDP0    B$TCB$
         4 000106   000000 471500                    LDP1    0,,PR0
         4 000107   100102 236100                    LDQ     66,,PR1
         4 000110   000000 756000 xsym               STQ     ERR_CODE

     1000    14280    2         ALTRETURN;

  14280  4 000111   000000 702200 xent               TSX2  ! X66_AALT

     1001    14281    2         END; /* Whenaltreturn */
     1002    14282    1   WRITE_NETCON.KEY_ = KEY_;

  14282  4 000112   200003 470500                    LDP0    @KEY_,,AUTO
         4 000113   000000 237100                    LDAQ    0,,PR0
         4 000114   000112 757000 3                  STAQ    WRITE_NETCON+2
PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:193  

     1003    14283    1   WRITE_NETCON.BUF_ = BUF_;

  14283  4 000115   200004 471500                    LDP1    @BUF_,,AUTO
         4 000116   100000 237100                    LDAQ    0,,PR1
         4 000117   000114 757000 3                  STAQ    WRITE_NETCON+4

     1004    14284    1   IF ADDR(BOUND) ~= ADDR(NIL)

  14284  4 000120   200005 236100                    LDQ     @BOUND,,AUTO
         4 000121   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000122   000131 600000 4                  TZE     s:14286

     1005    14285    1   THEN WRITE_NETCON.BUF_.BOUND = BOUND;

  14285  4 000123   200005 473500                    LDP3    @BOUND,,AUTO
         4 000124   300000 236100                    LDQ     0,,PR3
         4 000125   000020 736000                    QLS     16
         4 000126   000114 676000 3                  ERQ     WRITE_NETCON+4
         4 000127   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000130   000114 656000 3                  ERSQ    WRITE_NETCON+4

     1006    14286    1   CALL M$WRITE(WRITE_NETCON)

  14286  4 000131   000110 630400 3                  EPPR0   WRITE_NETCON
         4 000132   440001 713400                    CLIMB   alt,write
         4 000133   401400 401760                    pmme    nvectors=4
         4 000134   000136 702000 4                  TSX2    s:14288
         4 000135   000145 710000 4                  TRA     s:14292

     1007    14287    2   WHENALTRETURN DO;

     1008    14288    2      AS_DCBNUM# = DCBNUM (M$NETCON) ;

  14288  4 000136   000000 236007 xsym               LDQ     M$NETCON,DL
         4 000137   000000 756000 xsym               STQ     AS_DCBNUM#

PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:194  
     1009    14289    2      ERR_CODE = B$TCB$-> B$TCB.ALT$-> B$ALT.ERR;

  14289  4 000140   000000 470400 xsym               LDP0    B$TCB$
         4 000141   000000 471500                    LDP1    0,,PR0
         4 000142   100102 236100                    LDQ     66,,PR1
         4 000143   000000 756000 xsym               STQ     ERR_CODE

     1010    14290    2      ALTRETURN;

  14290  4 000144   000000 702200 xent               TSX2  ! X66_AALT

     1011    14291    2      END; /* Whenaltreturn */
     1012    14292    1   RETURN;

  14292  4 000145   000000 702200 xent               TSX2  ! X66_ARET

     1013    14293    1   ASB$CLOSE_NETCON: ENTRY ALTRET;

  14293  4 000146   000000 700200 xent  ASB$CLOSE_N* TSX0  ! X66_AUTO_3
         4 000147   000006 000003                    ZERO    6,3

     1014    14294    1   IF DCBADDR(DCBNUM(M$NETCON))->F$DCB.FCD

  14294  4 000150   000000 236007 xsym               LDQ     M$NETCON,DL
         4 000151   000000 470400 5                  LDP0    0
         4 000152   000000 471500                    LDP1    0,,PR0
         4 000153   100000 473506                    LDP3    0,QL,PR1
         4 000154   300031 236100                    LDQ     25,,PR3
         4 000155   020000 316007                    CANQ    8192,DL
         4 000156   000162 600000 4                  TZE     s:14296

     1015    14295    1   THEN CALL M$CLOSE(CLOSE_NETCON);

  14295  4 000157   000124 630400 3                  EPPR0   CLOSE_NETCON
         4 000160   050001 713400                    CLIMB   close
         4 000161   406000 401760                    pmme    nvectors=13

PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:195  
     1016    14296    1   RETURN;

  14296  4 000162   000000 702200 xent               TSX2  ! X66_ARET

     1017    14297    1   ASB$OPEN_NETCON: ENTRY ALTRET;

  14297  4 000163   000000 700200 xent  ASB$OPEN_NE* TSX0  ! X66_AUTO_3
         4 000164   000006 000003                    ZERO    6,3

     1018    14298    1   IF NOT DCBADDR(DCBNUM(M$NETCON))->F$DCB.FCD

  14298  4 000165   000000 236007 xsym               LDQ     M$NETCON,DL
         4 000166   000000 470400 5                  LDP0    0
         4 000167   000000 471500                    LDP1    0,,PR0
         4 000170   100000 473506                    LDP3    0,QL,PR1
         4 000171   300031 236100                    LDQ     25,,PR3
         4 000172   020000 316007                    CANQ    8192,DL
         4 000173   000210 601000 4                  TNZ     s:14305

     1019    14299    1   THEN CALL M$OPEN(OPEN_NETCON)

  14299  4 000174   000000 630400 3                  EPPR0   OPEN_NETCON
         4 000175   450000 713400                    CLIMB   alt,open
         4 000176   410400 401760                    pmme    nvectors=18
         4 000177   000201 702000 4                  TSX2    s:14301
         4 000200   000210 710000 4                  TRA     s:14305

     1020    14300    2      WHENALTRETURN DO;

     1021    14301    2         AS_DCBNUM# = DCBNUM (M$NETCON) ;

  14301  4 000201   000000 236007 xsym               LDQ     M$NETCON,DL
         4 000202   000000 756000 xsym               STQ     AS_DCBNUM#

     1022    14302    2         ERR_CODE = B$TCB$-> B$TCB.ALT$-> B$ALT.ERR;

  14302  4 000203   000000 470400 xsym               LDP0    B$TCB$
PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:196  
         4 000204   000000 471500                    LDP1    0,,PR0
         4 000205   100102 236100                    LDQ     66,,PR1
         4 000206   000000 756000 xsym               STQ     ERR_CODE

     1023    14303    2         ALTRETURN;

  14303  4 000207   000000 702200 xent               TSX2  ! X66_AALT

     1024    14304    2         END; /* Whenaltreturn */
     1025    14305    1   RETURN;

  14305  4 000210   000000 702200 xent               TSX2  ! X66_ARET

     1026    14306    1   ASB$DELREC_NETCON: ENTRY(KEY_) ALTRET;

  14306  4 000211   000000 700200 xent  ASB$DELREC_* TSX0  ! X66_AUTO_3
         4 000212   000006 000003                    ZERO    6,3

     1027    14307    1   IF NOT DCBADDR(DCBNUM(M$NETCON))->F$DCB.FCD

  14307  4 000213   000000 236007 xsym               LDQ     M$NETCON,DL
         4 000214   000000 470400 5                  LDP0    0
         4 000215   000000 471500                    LDP1    0,,PR0
         4 000216   100000 473506                    LDP3    0,QL,PR1
         4 000217   300031 236100                    LDQ     25,,PR3
         4 000220   020000 316007                    CANQ    8192,DL
         4 000221   000236 601000 4                  TNZ     s:14314

     1028    14308    1   THEN CALL M$OPEN(OPEN_NETCON)

  14308  4 000222   000000 630400 3                  EPPR0   OPEN_NETCON
         4 000223   450000 713400                    CLIMB   alt,open
         4 000224   410400 401760                    pmme    nvectors=18
         4 000225   000227 702000 4                  TSX2    s:14310
         4 000226   000236 710000 4                  TRA     s:14314

     1029    14309    2      WHENALTRETURN DO;
PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:197  

     1030    14310    2         AS_DCBNUM# = DCBNUM (M$NETCON) ;

  14310  4 000227   000000 236007 xsym               LDQ     M$NETCON,DL
         4 000230   000000 756000 xsym               STQ     AS_DCBNUM#

     1031    14311    2         ERR_CODE = B$TCB$-> B$TCB.ALT$-> B$ALT.ERR;

  14311  4 000231   000000 470400 xsym               LDP0    B$TCB$
         4 000232   000000 471500                    LDP1    0,,PR0
         4 000233   100102 236100                    LDQ     66,,PR1
         4 000234   000000 756000 xsym               STQ     ERR_CODE

     1032    14312    2         ALTRETURN;

  14312  4 000235   000000 702200 xent               TSX2  ! X66_AALT

     1033    14313    2         END; /* Whenaltreturn */
     1034    14314    1   DELREC_NETCON.KEY_ = KEY_;

  14314  4 000236   200003 470500                    LDP0    @KEY_,,AUTO
         4 000237   000000 237100                    LDAQ    0,,PR0
         4 000240   000164 757000 3                  STAQ    DELREC_NETCON+2

     1035    14315    1   CALL M$DELREC(DELREC_NETCON)

  14315  4 000241   000162 630400 3                  EPPR0   DELREC_NETCON
         4 000242   440002 713400                    CLIMB   alt,+16386
         4 000243   401400 401760                    pmme    nvectors=4
         4 000244   000246 702000 4                  TSX2    s:14317
         4 000245   000255 710000 4                  TRA     s:14321

     1036    14316    2   WHENALTRETURN DO;

     1037    14317    2      AS_DCBNUM# = DCBNUM (M$NETCON) ;

  14317  4 000246   000000 236007 xsym               LDQ     M$NETCON,DL
PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:198  
         4 000247   000000 756000 xsym               STQ     AS_DCBNUM#

     1038    14318    2      ERR_CODE = B$TCB$-> B$TCB.ALT$-> B$ALT.ERR;

  14318  4 000250   000000 470400 xsym               LDP0    B$TCB$
         4 000251   000000 471500                    LDP1    0,,PR0
         4 000252   100102 236100                    LDQ     66,,PR1
         4 000253   000000 756000 xsym               STQ     ERR_CODE

     1039    14319    2      ALTRETURN;

  14319  4 000254   000000 702200 xent               TSX2  ! X66_AALT

     1040    14320    2      END; /* Whenaltreturn */
     1041    14321    1   RETURN;

  14321  4 000255   000000 702200 xent               TSX2  ! X66_ARET
     1042    14322    1   END ASB$NETCON;
     1043    14323        %EOD;

PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:199  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASB$NETCON.
PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:200  

 **** Variables and constants ****

  ****  Section 003  Data  ASB$NETCON

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   124-0-0/d STRC(1080)  r     1 CLOSE_NETCON             162-0-0/d STRC(360)   r     1 DELREC_NETCON
   174-0-0/c STRC(72)    r     1 NETCON                     0-0-0/d STRC(2088)  r     1 OPEN_NETCON
    72-0-0/d STRC(504)   r     1 READ_NETCON              110-0-0/d STRC(432)   r     1 WRITE_NETCON

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w PTR         r     1 @BOUND                     4-0-0/w PTR         r     1 @BUF_
     3-0-0/w PTR         r     1 @KEY_                     *0-0-0/w UBIN        r     1 BOUND
    *0-0-0/d VECT        r     1 BUF_                      *0-0-0/d VECT        r     1 KEY_

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 AS_DCBNUM#                 0-0-0/w PTR         r     1 B$TCB$
     0-0-0/b STRC        r     1 ERR_CODE                   0-0-0/c STRC(72)    r     1 FILE_ACCT

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$NETCON

PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:201  

   Procedure ASB$NETCON requires 174 words for executable code.
   Procedure ASB$NETCON requires 6 words of local(AUTO) storage.
PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:202  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:203  
          MINI XREF LISTING

ASA_BRKS_LOC
     11101**DCL     11101--REDEF
AS_DCBNUM#
     11108**DCL     14259<<ASSIGN  14267<<ASSIGN  14278<<ASSIGN  14288<<ASSIGN  14301<<ASSIGN  14310<<ASSIGN
     14317<<ASSIGN
AS_DEFAULT.BANNER_PERM
     11794**DCL     11795--REDEF
AS_DEFAULT.BUDGET.MACCT
     11699**DCL     11703--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     11712**DCL     11715--REDEF
AS_DEFAULT.BUDGET.PACCUM
     11695**DCL     11697--REDEF
AS_DEFAULT.BUDGET.PMAXC
     11690**DCL     11692--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     11810**DCL     11811--REDEF   11812--REDEF
AS_DEFAULT_DREC.PASSWORD
     13064**DCL     13068--REDEF
AS_DEFAULT_DREC.RENAME
     13087**DCL     13088--REDEF
AS_DFLT.BANNER_PERM
     11616**DCL     11617--REDEF
AS_DFLT.BUDGET.MACCT
     11521**DCL     11525--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     11534**DCL     11537--REDEF
AS_DFLT.BUDGET.PACCUM
     11517**DCL     11519--REDEF
AS_DFLT.BUDGET.PMAXC
     11512**DCL     11514--REDEF
AS_DFLT.SETUP_CHRA.TXT
PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:204  
     11632**DCL     11633--REDEF   11634--REDEF
AS_FE_MODE
     10967**DCL     10968--REDEF
AS_MODE
     10964**DCL     10966--REDEF
AS_MOD_USER.ACCESS
     13829**DCL     13830--REDEF
AS_MOD_USER.BANNER
     13816**DCL     13817--REDEF
AS_MOD_USER.BANNER_PERM
     13818**DCL     13819--REDEF
AS_MOD_USER.BILL
     13824**DCL     13825--REDEF
AS_MOD_USER.CPROC
     13820**DCL     13821--REDEF
AS_MOD_USER.FEBILL
     13900**DCL     13901--REDEF
AS_MOD_USER.FECXTMEM
     13917**DCL     13918--REDEF
AS_MOD_USER.FEMINTS
     13902**DCL     13903--REDEF
AS_MOD_USER.FEMMEM
     13913**DCL     13914--REDEF
AS_MOD_USER.FEMTIME
     13911**DCL     13912--REDEF
AS_MOD_USER.FEPPRIV
     13908**DCL     13910--REDEF
AS_MOD_USER.FEPRIV
     13905**DCL     13907--REDEF
AS_MOD_USER.FORCE_BIT
     13814**DCL     13815--REDEF
AS_MOD_USER.KEY
     13896**DCL     13898--REDEF
AS_MOD_USER.LASTCPROC
     13822**DCL     13823--REDEF
AS_MOD_USER.LIMITS.DO_
PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:205  
     13870**DCL     13871--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     13886**DCL     13887--REDEF
AS_MOD_USER.LIMITS.LO
     13866**DCL     13867--REDEF
AS_MOD_USER.LIMITS.MEM
     13862**DCL     13863--REDEF
AS_MOD_USER.LIMITS.MPRIO
     13890**DCL     13891--REDEF
AS_MOD_USER.LIMITS.PDIS
     13878**DCL     13879--REDEF
AS_MOD_USER.LIMITS.PO
     13874**DCL     13875--REDEF
AS_MOD_USER.LIMITS.TDIS
     13882**DCL     13883--REDEF
AS_MOD_USER.LIMITS.TIME
     13858**DCL     13859--REDEF
AS_MOD_USER.MAXENQ
     13839**DCL     13840--REDEF
AS_MOD_USER.PERM_BIT
     13812**DCL     13813--REDEF
AS_MOD_USER.PPRIV
     13834**DCL     13836--REDEF
AS_MOD_USER.PRIOB
     13841**DCL     13842--REDEF
AS_MOD_USER.PRIV
     13831**DCL     13833--REDEF
AS_MOD_USER.QUAN
     13837**DCL     13838--REDEF
AS_MOD_USER.SETUP
     13810**DCL     13811--REDEF
AS_PROJECT.BANNER_PERM
     12150**DCL     12151--REDEF
AS_PROJECT.BUDGET.MACCT
     12055**DCL     12059--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:206  
     12068**DCL     12071--REDEF
AS_PROJECT.BUDGET.PACCUM
     12051**DCL     12053--REDEF
AS_PROJECT.BUDGET.PMAXC
     12046**DCL     12048--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12166**DCL     12167--REDEF   12168--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     12328**DCL     12329--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     12233**DCL     12237--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     12246**DCL     12249--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     12229**DCL     12231--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     12224**DCL     12226--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     12344**DCL     12345--REDEF   12346--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     13550**DCL     13554--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     13573**DCL     13574--REDEF
AS_PROJECT_DREC.PASSWORD
     13388**DCL     13392--REDEF
AS_PROJECT_DREC.RENAME
     13411**DCL     13412--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     11972**DCL     11973--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     11877**DCL     11881--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     11890**DCL     11893--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     11873**DCL     11875--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:207  
     11868**DCL     11870--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     11988**DCL     11989--REDEF   11990--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     13226**DCL     13230--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     13249**DCL     13250--REDEF
AS_USERS.BANNER_PERM
     11438**DCL     11439--REDEF
AS_USERS.BUDGET.MACCT
     11343**DCL     11347--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     11356**DCL     11359--REDEF
AS_USERS.BUDGET.PACCUM
     11339**DCL     11341--REDEF
AS_USERS.BUDGET.PMAXC
     11334**DCL     11336--REDEF
AS_USERS.SETUP_CHRA.TXT
     11454**DCL     11455--REDEF   11456--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     12506**DCL     12507--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     12411**DCL     12415--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     12424**DCL     12427--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     12407**DCL     12409--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     12402**DCL     12404--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     12522**DCL     12523--REDEF   12524--REDEF
B$ALT.CODE
     13965**DCL     13965--REDEF   13966--REDEF   13966--REDEF
B$ALT.ERR
     13966**DCL     14260>>ASSIGN  14268>>ASSIGN  14279>>ASSIGN  14289>>ASSIGN  14302>>ASSIGN  14311>>ASSIGN
     14318>>ASSIGN
PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:208  
B$ALT.ERR.ERR#
     13967**DCL     13967--REDEF
B$ALT.EVID
     13966**DCL     13966--REDEF   13966--REDEF
B$TCB.ALT$
     13961**DCL     14260>>ASSIGN  14268>>ASSIGN  14279>>ASSIGN  14289>>ASSIGN  14302>>ASSIGN  14311>>ASSIGN
     14318>>ASSIGN
B$TCB$
     13959**DCL     14260>>ASSIGN  14268>>ASSIGN  14279>>ASSIGN  14289>>ASSIGN  14302>>ASSIGN  14311>>ASSIGN
     14318>>ASSIGN
BOUND
     13956**DCL         7--PROC    14255--ENTRY   14271--IF      14272<<ASSIGN  14274--ENTRY   14284--IF
     14285>>ASSIGN
BUF_
     13955**DCL         7--PROC    14255--ENTRY   14264>>ASSIGN  14274--ENTRY   14283>>ASSIGN
CLOSE_NETCON
     14186**DCL     14295<>CALL
CLOSE_NETCON.SN_
     14186**DCL     14186--REDEF
CLOSE_NETCON.UTL_
     14187**DCL     14187--REDEF
CLOSE_NETCON.V
     14191**DCL     14186--DCLINIT
CLOSE_NETCON.V.EXPIRE#
     14201**DCL     14201--REDEF
CLOSE_NETCON.V.TYPE#
     14199**DCL     14199--REDEF
CLOSE_NETCON.V.XTNSIZE#
     14196**DCL     14196--REDEF   14198--REDEF
DELREC_NETCON
     14217**DCL     14315<>CALL
DELREC_NETCON.KEY_
     14217**DCL     14314<<ASSIGN
DELREC_NETCON.V
     14220**DCL     14217--DCLINIT
ERR_CODE
PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:209  
     11096**DCL     11097--REDEF   14260<<ASSIGN  14268<<ASSIGN  14279<<ASSIGN  14289<<ASSIGN  14302<<ASSIGN
     14311<<ASSIGN  14318<<ASSIGN
F$DCB.ACTPOS
        35**DCL        35--REDEF
F$DCB.ARS
        10**DCL        10--REDEF   14272>>ASSIGN
F$DCB.ATTR
        28**DCL        29--REDEF
F$DCB.BORROW
        43**DCL        43--REDEF      43--REDEF      43--REDEF
F$DCB.DCBNAME.L
        57**DCL        57--IMP-SIZ
F$DCB.EOMCHAR
        14**DCL        14--REDEF
F$DCB.FCD
        23**DCL     14256>>IF      14275>>IF      14294>>IF      14298>>IF      14307>>IF
F$DCB.FLDID
        38**DCL        38--REDEF
F$DCB.FORM$
        32**DCL        32--REDEF
F$DCB.FSECT
        48**DCL        48--REDEF
F$DCB.FSN
        25**DCL        25--REDEF      25--REDEF      26--REDEF
F$DCB.HEADER$
        31**DCL        31--REDEF
F$DCB.IXTNSIZE
        29**DCL        29--REDEF
F$DCB.LASTSTA$
        19**DCL        19--REDEF
F$DCB.LVL
        44**DCL        44--REDEF
F$DCB.NAME.C
        19**DCL        19--REDEF
F$DCB.NOEOF
        40**DCL        40--REDEF
PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:210  
F$DCB.NRECS
        30**DCL        30--REDEF
F$DCB.NRECX
        49**DCL        49--REDEF
F$DCB.OHDR
        41**DCL        41--REDEF
F$DCB.ORG
        24**DCL        24--REDEF
F$DCB.PRECNO
        47**DCL        47--REDEF
F$DCB.RCSZ
        52**DCL        52--REDEF
F$DCB.RES
        20**DCL        20--REDEF
F$DCB.SETX
        32**DCL        32--REDEF
F$DCB.TAB$
        31**DCL        32--REDEF
F$DCB.TDA
        46**DCL        46--REDEF
F$DCB.WSN
        21**DCL        21--REDEF
FILE_ACCT
     11104**DCL     14050--DCLINIT
KEY_
     13954**DCL         7--PROC    14255--ENTRY   14263>>ASSIGN  14274--ENTRY   14282>>ASSIGN  14306--ENTRY
     14314>>ASSIGN
KL_DEFAULT.PASSWORD
     13712**DCL     13716--REDEF
KL_DEFAULT.RENAME
     13735**DCL     13736--REDEF
KL_DFLT.PASSWORD
     12902**DCL     12906--REDEF
KL_DFLT.RENAME
     12925**DCL     12926--REDEF
KL_DREC.PASSWORD
PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:211  
     12740**DCL     12744--REDEF
KL_DREC.RENAME
     12763**DCL     12764--REDEF
KL_DREC_CNT.PASSWORD
     12627**DCL     12631--REDEF
KL_DREC_CNT.RENAME
     12650**DCL     12651--REDEF
M$CLOSE
      1117**DCL-ENT 14295--CALL
M$DELREC
      1119**DCL-ENT 14315--CALL
M$NETCON
     13958**DCL     14256--IF      14259>>ASSIGN  14267>>ASSIGN  14272--ASSIGN  14275--IF      14278>>ASSIGN
     14288>>ASSIGN  14294--IF      14298--IF      14301>>ASSIGN  14307--IF      14310>>ASSIGN  14317>>ASSIGN
M$OPEN
      1117**DCL-ENT 14257--CALL    14276--CALL    14299--CALL    14308--CALL
M$READ
      1118**DCL-ENT 14265--CALL
M$WRITE
      1118**DCL-ENT 14286--CALL
NETCON
     14251**DCL     14046--DCLINIT
OPEN_NETCON
     14045**DCL     14257<>CALL    14276<>CALL    14299<>CALL    14308<>CALL
OPEN_NETCON.ACSVEH_
     14047**DCL     14048--REDEF
OPEN_NETCON.ALTKEYS_
     14053**DCL     14054--REDEF   14054--REDEF
OPEN_NETCON.HDR_
     14052**DCL     14053--REDEF
OPEN_NETCON.TAB_
     14051**DCL     14052--REDEF
OPEN_NETCON.UHL_
     14045**DCL     14046--REDEF   14046--REDEF
OPEN_NETCON.V
     14054**DCL     14045--DCLINIT
PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:212  
OPEN_NETCON.V.FSN#
     14085**DCL     14085--REDEF   14085--REDEF
OPEN_NETCON.WSN_
     14051**DCL     14051--REDEF
PROJ_KEY.TEXT
     10974**DCL     10974--REDEF
PROJ_KEY.TXT.PROJECT
     10974**DCL     10974--REDEF
READ_NETCON
     14108**DCL     14265<>CALL
READ_NETCON.BUF_
     14110**DCL     14264<<ASSIGN
READ_NETCON.KEY_
     14108**DCL     14263<<ASSIGN
READ_NETCON.STATION_
     14111**DCL     14112--REDEF
READ_NETCON.V
     14112**DCL     14108--DCLINIT
READ_NETCON.V.DVBYTE.REREAD#
     14123**DCL     14123--REDEF
READ_NETCON.V.INDX#
     14121**DCL     14121--REDEF
REMEM_VAR
     11100**DCL     11100--REDEF
REM_FCMD
     11100**DCL     11101--REDEF
USERS_KEY.TEXT
     10971**DCL     10972--REDEF   10972--REDEF   10972--REDEF   10973--REDEF
WRITE_NETCON
     14148**DCL     14286<>CALL
WRITE_NETCON.BUF_
     14148**DCL     14283<<ASSIGN
WRITE_NETCON.BUF_.BOUND
     14148**DCL     14285<<ASSIGN
WRITE_NETCON.KEY_
     14148**DCL     14282<<ASSIGN
PL6.E3A0      #004=ASB$NETCON File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:17 Page:213  
WRITE_NETCON.STATION_
     14150**DCL     14150--REDEF
WRITE_NETCON.V
     14151**DCL     14148--DCLINIT
WRITE_NETCON.V.DVBYTE.VFC#
     14157**DCL     14157--REDEF

PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:214  
     1044        1        /*T***********************************************************/
     1045        2        /*T*                                                         */
     1046        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1047        4        /*T*                                                         */
     1048        5        /*T***********************************************************/
     1049        6        %EJECT;
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:215  
     1050        7        ASF$READ_FORM: PROC (KEY, BUF$, ARS) ALTRET;
     1051        8    1   DCL 1 KEY ALIGNED,
     1052        9    1          2 CNT UBIN BYTE UNAL,
     1053       10    1          2 TEXT CHAR(KEY.CNT) UNAL;
     1054       11    1   DCL BUF$ PTR;
     1055       12    1   DCL ARS UBIN WORD;
     1056       13        %INCLUDE CP_6;
     1057       94        %INCLUDE F$DCB;
     1058      143        %INCLUDE AS_SUPER_C;
     1059      578        %INCLUDE KL_SUPER_C;
     1060     3480        %INCLUDE AS_SUBS_C;
     1061     4894        %INCLUDE AS_MAC_C;
     1062     4974        %INCLUDE XU_MACRO_C;
     1063     8080        %INCLUDE XU_FORMAT_C;
     1064     8242        %INCLUDE AS_SUPER_R;
     1065    11258    1   DCL B$TCB$ PTR SYMREF;
     1066    11259        %B$TCB;
     1067    11262        %B$ALT;
     1068    11270    1   DCL M$FORM DCB;
     1069    11271        %VLP_NAME (FPTN=FORM_FILE,STCLASS=CONSTANT,NAME=':FORM');
     1070    11298        %FPT_READ (FPTN=READ_FPT,
     1071    11299                   DCB=M$FORM,
     1072    11300                   KEYS=YES);
     1073    11339        %FPT_READ(FPTN = READ_FPT_SEQ,STCLASS = STATIC,
     1074    11340                DCB = M$FORM,
     1075    11341                KEY = USERS_KEY,
     1076    11342                KEYR = YES,
     1077    11343                KEYS = NO);
     1078    11382        %FPT_PRECORD(FPTN = PREC_FPT,STCLASS = STATIC,
     1079    11383                DCB = M$FORM,
     1080    11384                KEYS = YES,
     1081    11385                KEYR = YES,
     1082    11386                N = 0);
     1083    11407        %FPT_PRECORD(FPTN = PREC_SKIP_FPT,STCLASS = STATIC,
     1084    11408                DCB = M$FORM,
     1085    11409                KEYS = YES,
     1086    11410                KEYR = YES,
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:216  
     1087    11411                N = 1);
     1088    11432        %FPT_WRITE (FPTN=WRITE_FPT,
     1089    11433                   DCB=M$FORM,
     1090    11434                   ONEWKEY=YES);
     1091    11465        %FPT_OPEN (FPTN=OPEN_CR_FPT,
     1092    11466                   NAME=FORM_FILE,
     1093    11467                   ACCT=FILE_ACCT,
     1094    11468                   ASN=FILE,
     1095    11469                   DCB=M$FORM,
     1096    11470                   ACS=DIRECT,
     1097    11471                   ORG=KEYED,
     1098    11472                   ACSVEH = VLP_ATTR ,
     1099    11473                   ACCESS=VLP_ATTR_ACC,
     1100    11474                   EXIST=OLDFILE,
     1101    11475                   SHARE=ALL,
     1102    11476                   CTG=YES,
     1103    11477                   IXTNSIZE = 8 ,
     1104    11478                   XTNSIZE = 8 ,
     1105    11479                   FUN=CREATE);
     1106    11588        %FPT_OPEN (FPTN=OPEN_UP_FPT,
     1107    11589                   NAME=FORM_FILE,
     1108    11590                   ACCT=FILE_ACCT,
     1109    11591                   ASN=FILE,
     1110    11592                   DCB=M$FORM,
     1111    11593                   ACS=DIRECT,
     1112    11594                   ORG=KEYED,
     1113    11595                   FUN=UPDATE,
     1114    11596                   SHARE=ALL);
     1115    11705        %FPT_ENQ  (FPTN=ENQ_FORM,
     1116    11706                   DCB=M$FORM,
     1117    11707                   SHARE=NONE);
     1118    11725        %FPT_DEQ  (FPTN=DEQ_FORM,
     1119    11726                   DCB=M$FORM,
     1120    11727                   RELRES=YES);
     1121    11744        %FPT_CLOSE(FPTN=CLOSE_FORM,
     1122    11745                   DCB=M$FORM,
     1123    11746                   DISP=SAVE);
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:217  
     1124    11788        %FPT_DELREC (FPTN=DELREC_FPT,
     1125    11789                     KEY=USERS_KEY,
     1126    11790                     DCB=M$FORM);
     1127    11809        %VLP_ATTR (FPTN=VLP_ATTR_ACC);
     1128    11823        %VLP_ACCESS (READ=YES, EXEC=YES, ACCT='?', LAST=";");
     1129    11840        %VLP_ATTR ;
     1130    11854        %VLP_ACSVEH ( DELR = YES ,
     1131    11855                      READ = YES ,
     1132    11856                      UPD  = YES ,
     1133    11857                      WNEW = YES ,
     1134    11858                      VEHICLE = 'SUPER' ,
     1135    11859                      LAST = ";" ) ;
     1136    11876        %EJECT;
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:218  
     1137    11877    1   READ_FPT.BUF_.BUF$ = BUF$;
     1138    11878    1   READ_FPT.BUF_.BOUND = ARS - 1;
     1139    11879    1   READ_FPT.KEY_ = VECTOR(KEY);
     1140    11880    1   CALL M$READ (READ_FPT) ALTRET (IO_ERROR);
     1141    11881    1   ARS = DCBADDR(DCBNUM(M$FORM))->F$DCB.ARS;
     1142    11882    1   RETURN;
     1143    11883
     1144    11884    1   ASF$WRITE_FORM: ENTRY (KEY, BUF$, ARS) ALTRET;
     1145    11885    1   WRITE_FPT.BUF_.BUF$ = BUF$;
     1146    11886    1   WRITE_FPT.BUF_.BOUND = ARS - 1;
     1147    11887    1   WRITE_FPT.KEY_ = VECTOR (KEY);
     1148    11888    1   ENQ_FORM.RNAME_ = VECTOR(KEY);
     1149    11889    1   DEQ_FORM.RNAME_ = VECTOR(KEY);
     1150    11890    1   CALL M$ENQ( ENQ_FORM ) ALTRET(ENQ_ERR);
     1151    11891    1   ENQ_ERR:
     1152    11892    1   CALL M$WRITE(WRITE_FPT) ALTRET(WRITE_ERR);
     1153    11893    1   CALL M$DEQ(DEQ_FORM) ALTRET(DEQ_ERR);
     1154    11894    1   DEQ_ERR:
     1155    11895    1   RETURN;
     1156    11896    1   WRITE_ERR:
     1157    11897    1   ERR_CODE = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1158    11898    1   AS_DCBNUM# = DCBNUM( M$FORM );
     1159    11899    1   CALL M$DEQ(DEQ_FORM) ALTRET(DEQ_ERR2);
     1160    11900    1   DEQ_ERR2:
     1161    11901    1   ALTRETURN;
     1162    11902
     1163    11903
     1164    11904    1   ASF$OPEN_FORM_CR: ENTRY ALTRET;
     1165    11905    1   CALL M$OPEN(OPEN_CR_FPT) ALTRET (IO_ERROR);
     1166    11906    1   RETURN;
     1167    11907
     1168    11908    1   ASF$OPEN_FORM_UP: ENTRY ALTRET;
     1169    11909    1   CALL M$OPEN(OPEN_UP_FPT) ALTRET (IO_ERROR);
     1170    11910    1   RETURN;
     1171    11911
     1172    11912
     1173    11913    1   ASF$CLOSE_FORM: ENTRY ALTRET;
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:219  
     1174    11914    1   IF FAST_FLAG = AS_TRUE
     1175    11915    1   THEN RETURN;
     1176    11916    1   CALL M$CLOSE(CLOSE_FORM) ALTRET( IO_ERROR);
     1177    11917    1   RETURN;
     1178    11918
     1179    11919    1   ASF$READ_FORM_SEQ: ENTRY(KEY,BUF$,ARS) ALTRET;
     1180    11920    1   READ_FPT_SEQ.BUF_.BUF$ = BUF$;
     1181    11921    1   READ_FPT_SEQ.BUF_.BOUND = ARS-1;
     1182    11922    1   CALL M$READ(READ_FPT_SEQ) ALTRET(IO_ERROR);
     1183    11923    1   ARS = DCBADDR(DCBNUM(M$FORM))->F$DCB.ARS;
     1184    11924    1   RETURN;
     1185    11925
     1186    11926
     1187    11927    1   ASF$PREC_FORM: ENTRY(KEY) ALTRET;
     1188    11928    1   PREC_FPT.KEY_ = VECTOR(KEY);
     1189    11929    1   CALL M$PRECORD(PREC_FPT) ALTRET(IO_ERROR);
     1190    11930    1   RETURN;
     1191    11931    1   ASF$PREC_SKIP_FORM: ENTRY(KEY) ALTRET;
     1192    11932    1   PREC_SKIP_FPT.KEY_ = VECTOR(KEY);
     1193    11933    1   CALL M$PRECORD(PREC_SKIP_FPT) ALTRET(IO_ERROR);
     1194    11934    1   RETURN;
     1195    11935
     1196    11936
     1197    11937    1   ASF$DELREC_FORM: ENTRY ALTRET;
     1198    11938    1   CALL M$DELREC(DELREC_FPT) ALTRET(IO_ERROR);
     1199    11939    1   RETURN;
     1200    11940
     1201    11941
     1202    11942    1   IO_ERROR:
     1203    11943    1   ERR_CODE = B$TCB$->B$TCB.ALT$->B$ALT.ERR;
     1204    11944    1   AS_DCBNUM# = DCBNUM( M$FORM );
     1205    11945    1   ALTRETURN;
     1206    11946
     1207    11947
     1208    11948    1   END ASF$READ_FORM;
     1209    11949        %EOD;

PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:220  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASF$READ_FORM.

   Procedure ASF$READ_FORM requires 190 words for executable code.
   Procedure ASF$READ_FORM requires 6 words of local(AUTO) storage.

PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:221  

 Object Unit name= ASF$READ_FORM                              File name= ASB$FILES.:E05TOU
 UTS= JUL 29 '97 09:18:41.72 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2   DCB   even  none     0      0  M$FORM
    3  RoData even  UTS      2      2  ASF$READ_FORM
    4   Data  even  none   241    361  ASF$READ_FORM
    5   Proc  even  none   190    276  ASF$READ_FORM
    6  RoData even  none     1      1  ASF$READ_FORM

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes    yes     yes      Std        3  ASF$READ_FORM
     5     41          yes     yes      Std        3  ASF$WRITE_FORM
     5    136          yes     yes      Std        0  ASF$OPEN_FORM_CR
     5    145          yes     yes      Std        0  ASF$OPEN_FORM_UP
     5    154          yes     yes      Std        0  ASF$CLOSE_FORM
     5    170          yes     yes      Std        3  ASF$READ_FORM_SEQ
     5    220          yes     yes      Std        1  ASF$PREC_FORM
     5    240          yes     yes      Std        1  ASF$PREC_SKIP_FORM
     5    260          yes     yes      Std        0  ASF$DELREC_FORM
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:222  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    AS_TRUE                          r    AS_MODE
r    AS_FE_MODE                            M$LO                                  USERS_KEY
     FAST_FLAG                             ERR_CODE                              REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          FILE_ACCT
     AS_DCBNUM#                            B$TCB$                                M$FORM
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:223  


     1044        1        /*T***********************************************************/
     1045        2        /*T*                                                         */
     1046        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1047        4        /*T*                                                         */
     1048        5        /*T***********************************************************/
     1049        6        %EJECT;
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:224  
     1050        7        ASF$READ_FORM: PROC (KEY, BUF$, ARS) ALTRET;

      7  5 000000   000000 700200 xent  ASF$READ_FO* TSX0  ! X66_AUTO_3
         5 000001   000006 000003                    ZERO    6,3

     1051        8    1   DCL 1 KEY ALIGNED,
     1052        9    1          2 CNT UBIN BYTE UNAL,
     1053       10    1          2 TEXT CHAR(KEY.CNT) UNAL;
     1054       11    1   DCL BUF$ PTR;
     1055       12    1   DCL ARS UBIN WORD;
     1056       13        %INCLUDE CP_6;
     1057       94        %INCLUDE F$DCB;
     1058      143        %INCLUDE AS_SUPER_C;
     1059      578        %INCLUDE KL_SUPER_C;
     1060     3480        %INCLUDE AS_SUBS_C;
     1061     4894        %INCLUDE AS_MAC_C;
     1062     4974        %INCLUDE XU_MACRO_C;
     1063     8080        %INCLUDE XU_FORMAT_C;
     1064     8242        %INCLUDE AS_SUPER_R;
     1065    11258    1   DCL B$TCB$ PTR SYMREF;
     1066    11259        %B$TCB;
     1067    11262        %B$ALT;
     1068    11270    1   DCL M$FORM DCB;
     1069    11271        %VLP_NAME (FPTN=FORM_FILE,STCLASS=CONSTANT,NAME=':FORM');
     1070    11298        %FPT_READ (FPTN=READ_FPT,
     1071    11299                   DCB=M$FORM,
     1072    11300                   KEYS=YES);
     1073    11339        %FPT_READ(FPTN = READ_FPT_SEQ,STCLASS = STATIC,
     1074    11340                DCB = M$FORM,
     1075    11341                KEY = USERS_KEY,
     1076    11342                KEYR = YES,
     1077    11343                KEYS = NO);
     1078    11382        %FPT_PRECORD(FPTN = PREC_FPT,STCLASS = STATIC,
     1079    11383                DCB = M$FORM,
     1080    11384                KEYS = YES,
     1081    11385                KEYR = YES,
     1082    11386                N = 0);
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:225  
     1083    11407        %FPT_PRECORD(FPTN = PREC_SKIP_FPT,STCLASS = STATIC,
     1084    11408                DCB = M$FORM,
     1085    11409                KEYS = YES,
     1086    11410                KEYR = YES,
     1087    11411                N = 1);
     1088    11432        %FPT_WRITE (FPTN=WRITE_FPT,
     1089    11433                   DCB=M$FORM,
     1090    11434                   ONEWKEY=YES);
     1091    11465        %FPT_OPEN (FPTN=OPEN_CR_FPT,
     1092    11466                   NAME=FORM_FILE,
     1093    11467                   ACCT=FILE_ACCT,
     1094    11468                   ASN=FILE,
     1095    11469                   DCB=M$FORM,
     1096    11470                   ACS=DIRECT,
     1097    11471                   ORG=KEYED,
     1098    11472                   ACSVEH = VLP_ATTR ,
     1099    11473                   ACCESS=VLP_ATTR_ACC,
     1100    11474                   EXIST=OLDFILE,
     1101    11475                   SHARE=ALL,
     1102    11476                   CTG=YES,
     1103    11477                   IXTNSIZE = 8 ,
     1104    11478                   XTNSIZE = 8 ,
     1105    11479                   FUN=CREATE);
     1106    11588        %FPT_OPEN (FPTN=OPEN_UP_FPT,
     1107    11589                   NAME=FORM_FILE,
     1108    11590                   ACCT=FILE_ACCT,
     1109    11591                   ASN=FILE,
     1110    11592                   DCB=M$FORM,
     1111    11593                   ACS=DIRECT,
     1112    11594                   ORG=KEYED,
     1113    11595                   FUN=UPDATE,
     1114    11596                   SHARE=ALL);
     1115    11705        %FPT_ENQ  (FPTN=ENQ_FORM,
     1116    11706                   DCB=M$FORM,
     1117    11707                   SHARE=NONE);
     1118    11725        %FPT_DEQ  (FPTN=DEQ_FORM,
     1119    11726                   DCB=M$FORM,
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:226  
     1120    11727                   RELRES=YES);
     1121    11744        %FPT_CLOSE(FPTN=CLOSE_FORM,
     1122    11745                   DCB=M$FORM,
     1123    11746                   DISP=SAVE);
     1124    11788        %FPT_DELREC (FPTN=DELREC_FPT,
     1125    11789                     KEY=USERS_KEY,
     1126    11790                     DCB=M$FORM);
     1127    11809        %VLP_ATTR (FPTN=VLP_ATTR_ACC);
     1128    11823        %VLP_ACCESS (READ=YES, EXEC=YES, ACCT='?', LAST=";");
     1129    11840        %VLP_ATTR ;
     1130    11854        %VLP_ACSVEH ( DELR = YES ,
     1131    11855                      READ = YES ,
     1132    11856                      UPD  = YES ,
     1133    11857                      WNEW = YES ,
     1134    11858                      VEHICLE = 'SUPER' ,
     1135    11859                      LAST = ";" ) ;
     1136    11876        %EJECT;
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:227  
     1137    11877    1   READ_FPT.BUF_.BUF$ = BUF$;

  11877  5 000002   200004 470500                    LDP0    @BUF$,,AUTO
         5 000003   000000 236100                    LDQ     0,,PR0
         5 000004   000005 756000 4                  STQ     READ_FPT+5

     1138    11878    1   READ_FPT.BUF_.BOUND = ARS - 1;

  11878  5 000005   200005 471500                    LDP1    @ARS,,AUTO
         5 000006   100000 236100                    LDQ     0,,PR1
         5 000007   000001 136007                    SBLQ    1,DL
         5 000010   000020 736000                    QLS     16
         5 000011   000004 676000 4                  ERQ     READ_FPT+4
         5 000012   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 000013   000004 656000 4                  ERSQ    READ_FPT+4

     1139    11879    1   READ_FPT.KEY_ = VECTOR(KEY);

  11879  5 000014   200003 473500                    LDP3    @KEY,,AUTO
         5 000015   300000 236100                    LDQ     0,,PR3
         5 000016   000033 772000                    QRL     27
         5 000017   000001 620006                    EAX0    1,QL
         5 000020   000000 635010                    EAA     0,X0
         5 000021   000002 771000                    ARL     2
         5 000022   000140 135007                    SBLA    96,DL
         5 000023   200003 236100                    LDQ     @KEY,,AUTO
         5 000024   000002 757000 4                  STAQ    READ_FPT+2

     1140    11880    1   CALL M$READ (READ_FPT) ALTRET (IO_ERROR);

  11880  5 000025   000000 630400 4                  EPPR0   READ_FPT
         5 000026   440000 713400                    CLIMB   alt,read
         5 000027   401400 401760                    pmme    nvectors=4
         5 000030   000267 702000 5                  TSX2    IO_ERROR

     1141    11881    1   ARS = DCBADDR(DCBNUM(M$FORM))->F$DCB.ARS;

PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:228  
  11881  5 000031   000000 236007 xsym               LDQ     M$FORM,DL
         5 000032   000000 470400 6                  LDP0    0
         5 000033   000000 471500                    LDP1    0,,PR0
         5 000034   100000 473506                    LDP3    0,QL,PR1
         5 000035   300000 235100                    LDA     0,,PR3
         5 000036   200005 473500                    LDP3    @ARS,,AUTO
         5 000037   300000 755100                    STA     0,,PR3

     1142    11882    1   RETURN;

  11882  5 000040   000000 702200 xent               TSX2  ! X66_ARET

     1143    11883
     1144    11884    1   ASF$WRITE_FORM: ENTRY (KEY, BUF$, ARS) ALTRET;

  11884  5 000041   000000 700200 xent  ASF$WRITE_F* TSX0  ! X66_AUTO_3
         5 000042   000006 000003                    ZERO    6,3

     1145    11885    1   WRITE_FPT.BUF_.BUF$ = BUF$;

  11885  5 000043   200004 470500                    LDP0    @BUF$,,AUTO
         5 000044   000000 236100                    LDQ     0,,PR0
         5 000045   000065 756000 4                  STQ     WRITE_FPT+5

     1146    11886    1   WRITE_FPT.BUF_.BOUND = ARS - 1;

  11886  5 000046   200005 471500                    LDP1    @ARS,,AUTO
         5 000047   100000 236100                    LDQ     0,,PR1
         5 000050   000001 136007                    SBLQ    1,DL
         5 000051   000020 736000                    QLS     16
         5 000052   000064 676000 4                  ERQ     WRITE_FPT+4
         5 000053   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 000054   000064 656000 4                  ERSQ    WRITE_FPT+4

     1147    11887    1   WRITE_FPT.KEY_ = VECTOR (KEY);

  11887  5 000055   200003 473500                    LDP3    @KEY,,AUTO
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:229  
         5 000056   300000 236100                    LDQ     0,,PR3
         5 000057   000033 772000                    QRL     27
         5 000060   000001 620006                    EAX0    1,QL
         5 000061   000000 635010                    EAA     0,X0
         5 000062   000002 771000                    ARL     2
         5 000063   000140 135007                    SBLA    96,DL
         5 000064   200003 236100                    LDQ     @KEY,,AUTO
         5 000065   000062 757000 4                  STAQ    WRITE_FPT+2

     1148    11888    1   ENQ_FORM.RNAME_ = VECTOR(KEY);

  11888  5 000066   300000 236100                    LDQ     0,,PR3
         5 000067   000033 772000                    QRL     27
         5 000070   000001 620006                    EAX0    1,QL
         5 000071   000000 635010                    EAA     0,X0
         5 000072   000002 771000                    ARL     2
         5 000073   000140 135007                    SBLA    96,DL
         5 000074   200003 236100                    LDQ     @KEY,,AUTO
         5 000075   000262 757000 4                  STAQ    ENQ_FORM+2

     1149    11889    1   DEQ_FORM.RNAME_ = VECTOR(KEY);

  11889  5 000076   300000 236100                    LDQ     0,,PR3
         5 000077   000033 772000                    QRL     27
         5 000100   000001 620006                    EAX0    1,QL
         5 000101   000000 635010                    EAA     0,X0
         5 000102   000002 771000                    ARL     2
         5 000103   000140 135007                    SBLA    96,DL
         5 000104   200003 236100                    LDQ     @KEY,,AUTO
         5 000105   000274 757000 4                  STAQ    DEQ_FORM+2

     1150    11890    1   CALL M$ENQ( ENQ_FORM ) ALTRET(ENQ_ERR);

  11890  5 000106   000260 630400 4                  EPPR0   ENQ_FORM
         5 000107   420002 713400                    CLIMB   alt,+8194
         5 000110   401000 401760                    pmme    nvectors=3
         5 000111   000112 702000 5                  TSX2    ENQ_ERR
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:230  

     1151    11891    1   ENQ_ERR:
     1152    11892    1   CALL M$WRITE(WRITE_FPT) ALTRET(WRITE_ERR);

  11892  5 000112   000060 630400 4     ENQ_ERR      EPPR0   WRITE_FPT
         5 000113   440001 713400                    CLIMB   alt,write
         5 000114   401400 401760                    pmme    nvectors=4
         5 000115   000123 702000 5                  TSX2    WRITE_ERR

     1153    11893    1   CALL M$DEQ(DEQ_FORM) ALTRET(DEQ_ERR);

  11893  5 000116   000272 630400 4                  EPPR0   DEQ_FORM
         5 000117   420003 713400                    CLIMB   alt,+8195
         5 000120   401000 401760                    pmme    nvectors=3
         5 000121   000122 702000 5                  TSX2    DEQ_ERR

     1154    11894    1   DEQ_ERR:
     1155    11895    1   RETURN;

  11895  5 000122   000000 702200 xent  DEQ_ERR      TSX2  ! X66_ARET

     1156    11896    1   WRITE_ERR:
     1157    11897    1   ERR_CODE = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  11897  5 000123   000000 470400 xsym  WRITE_ERR    LDP0    B$TCB$
         5 000124   000000 471500                    LDP1    0,,PR0
         5 000125   100102 236100                    LDQ     66,,PR1
         5 000126   000000 756000 xsym               STQ     ERR_CODE

     1158    11898    1   AS_DCBNUM# = DCBNUM( M$FORM );

  11898  5 000127   000000 236007 xsym               LDQ     M$FORM,DL
         5 000130   000000 756000 xsym               STQ     AS_DCBNUM#

     1159    11899    1   CALL M$DEQ(DEQ_FORM) ALTRET(DEQ_ERR2);

  11899  5 000131   000272 630400 4                  EPPR0   DEQ_FORM
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:231  
         5 000132   420003 713400                    CLIMB   alt,+8195
         5 000133   401000 401760                    pmme    nvectors=3
         5 000134   000135 702000 5                  TSX2    DEQ_ERR2

     1160    11900    1   DEQ_ERR2:
     1161    11901    1   ALTRETURN;

  11901  5 000135   000000 702200 xent  DEQ_ERR2     TSX2  ! X66_AALT

     1162    11902
     1163    11903
     1164    11904    1   ASF$OPEN_FORM_CR: ENTRY ALTRET;

  11904  5 000136   000000 700200 xent  ASF$OPEN_FO* TSX0  ! X66_AUTO_3
         5 000137   000006 000003                    ZERO    6,3

     1165    11905    1   CALL M$OPEN(OPEN_CR_FPT) ALTRET (IO_ERROR);

  11905  5 000140   000074 630400 4                  EPPR0   OPEN_CR_FPT
         5 000141   450000 713400                    CLIMB   alt,open
         5 000142   410400 401760                    pmme    nvectors=18
         5 000143   000267 702000 5                  TSX2    IO_ERROR

     1166    11906    1   RETURN;

  11906  5 000144   000000 702200 xent               TSX2  ! X66_ARET

     1167    11907
     1168    11908    1   ASF$OPEN_FORM_UP: ENTRY ALTRET;

  11908  5 000145   000000 700200 xent  ASF$OPEN_FO* TSX0  ! X66_AUTO_3
         5 000146   000006 000003                    ZERO    6,3

     1169    11909    1   CALL M$OPEN(OPEN_UP_FPT) ALTRET (IO_ERROR);

  11909  5 000147   000166 630400 4                  EPPR0   OPEN_UP_FPT
         5 000150   450000 713400                    CLIMB   alt,open
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:232  
         5 000151   410400 401760                    pmme    nvectors=18
         5 000152   000267 702000 5                  TSX2    IO_ERROR

     1170    11910    1   RETURN;

  11910  5 000153   000000 702200 xent               TSX2  ! X66_ARET

     1171    11911
     1172    11912
     1173    11913    1   ASF$CLOSE_FORM: ENTRY ALTRET;

  11913  5 000154   000000 700200 xent  ASF$CLOSE_F* TSX0  ! X66_AUTO_3
         5 000155   000006 000003                    ZERO    6,3

     1174    11914    1   IF FAST_FLAG = AS_TRUE

  11914  5 000156   000000 236000 xsym               LDQ     FAST_FLAG
         5 000157   000000 676000 xsym               ERQ     AS_TRUE
         5 000160   400000 376003                    ANQ     -131072,DU
         5 000161   000163 601000 5                  TNZ     s:11916

     1175    11915    1   THEN RETURN;

  11915  5 000162   000000 702200 xent               TSX2  ! X66_ARET

     1176    11916    1   CALL M$CLOSE(CLOSE_FORM) ALTRET( IO_ERROR);

  11916  5 000163   000302 630400 4                  EPPR0   CLOSE_FORM
         5 000164   450001 713400                    CLIMB   alt,close
         5 000165   406000 401760                    pmme    nvectors=13
         5 000166   000267 702000 5                  TSX2    IO_ERROR

     1177    11917    1   RETURN;

  11917  5 000167   000000 702200 xent               TSX2  ! X66_ARET

     1178    11918
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:233  
     1179    11919    1   ASF$READ_FORM_SEQ: ENTRY(KEY,BUF$,ARS) ALTRET;

  11919  5 000170   000000 700200 xent  ASF$READ_FO* TSX0  ! X66_AUTO_3
         5 000171   000006 000003                    ZERO    6,3

     1180    11920    1   READ_FPT_SEQ.BUF_.BUF$ = BUF$;

  11920  5 000172   200004 470500                    LDP0    @BUF$,,AUTO
         5 000173   000000 236100                    LDQ     0,,PR0
         5 000174   000023 756000 4                  STQ     READ_FPT_SEQ+5

     1181    11921    1   READ_FPT_SEQ.BUF_.BOUND = ARS-1;

  11921  5 000175   200005 471500                    LDP1    @ARS,,AUTO
         5 000176   100000 236100                    LDQ     0,,PR1
         5 000177   000001 136007                    SBLQ    1,DL
         5 000200   000020 736000                    QLS     16
         5 000201   000022 676000 4                  ERQ     READ_FPT_SEQ+4
         5 000202   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 000203   000022 656000 4                  ERSQ    READ_FPT_SEQ+4

     1182    11922    1   CALL M$READ(READ_FPT_SEQ) ALTRET(IO_ERROR);

  11922  5 000204   000016 630400 4                  EPPR0   READ_FPT_SEQ
         5 000205   440000 713400                    CLIMB   alt,read
         5 000206   401400 401760                    pmme    nvectors=4
         5 000207   000267 702000 5                  TSX2    IO_ERROR

     1183    11923    1   ARS = DCBADDR(DCBNUM(M$FORM))->F$DCB.ARS;

  11923  5 000210   000000 236007 xsym               LDQ     M$FORM,DL
         5 000211   000000 470400 6                  LDP0    0
         5 000212   000000 471500                    LDP1    0,,PR0
         5 000213   100000 473506                    LDP3    0,QL,PR1
         5 000214   300000 235100                    LDA     0,,PR3
         5 000215   200005 473500                    LDP3    @ARS,,AUTO
         5 000216   300000 755100                    STA     0,,PR3
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:234  

     1184    11924    1   RETURN;

  11924  5 000217   000000 702200 xent               TSX2  ! X66_ARET

     1185    11925
     1186    11926
     1187    11927    1   ASF$PREC_FORM: ENTRY(KEY) ALTRET;

  11927  5 000220   000000 700200 xent  ASF$PREC_FO* TSX0  ! X66_AUTO_3
         5 000221   000006 000003                    ZERO    6,3

     1188    11928    1   PREC_FPT.KEY_ = VECTOR(KEY);

  11928  5 000222   200003 470500                    LDP0    @KEY,,AUTO
         5 000223   000000 236100                    LDQ     0,,PR0
         5 000224   000033 772000                    QRL     27
         5 000225   000001 620006                    EAX0    1,QL
         5 000226   000000 635010                    EAA     0,X0
         5 000227   000002 771000                    ARL     2
         5 000230   000140 135007                    SBLA    96,DL
         5 000231   200003 236100                    LDQ     @KEY,,AUTO
         5 000232   000036 757000 4                  STAQ    PREC_FPT+2

     1189    11929    1   CALL M$PRECORD(PREC_FPT) ALTRET(IO_ERROR);

  11929  5 000233   000034 630400 4                  EPPR0   PREC_FPT
         5 000234   440003 713400                    CLIMB   alt,+16387
         5 000235   401000 401760                    pmme    nvectors=3
         5 000236   000267 702000 5                  TSX2    IO_ERROR

     1190    11930    1   RETURN;

  11930  5 000237   000000 702200 xent               TSX2  ! X66_ARET

     1191    11931    1   ASF$PREC_SKIP_FORM: ENTRY(KEY) ALTRET;

PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:235  
  11931  5 000240   000000 700200 xent  ASF$PREC_SK* TSX0  ! X66_AUTO_3
         5 000241   000006 000003                    ZERO    6,3

     1192    11932    1   PREC_SKIP_FPT.KEY_ = VECTOR(KEY);

  11932  5 000242   200003 470500                    LDP0    @KEY,,AUTO
         5 000243   000000 236100                    LDQ     0,,PR0
         5 000244   000033 772000                    QRL     27
         5 000245   000001 620006                    EAX0    1,QL
         5 000246   000000 635010                    EAA     0,X0
         5 000247   000002 771000                    ARL     2
         5 000250   000140 135007                    SBLA    96,DL
         5 000251   200003 236100                    LDQ     @KEY,,AUTO
         5 000252   000050 757000 4                  STAQ    PREC_SKIP_FPT+2

     1193    11933    1   CALL M$PRECORD(PREC_SKIP_FPT) ALTRET(IO_ERROR);

  11933  5 000253   000046 630400 4                  EPPR0   PREC_SKIP_FPT
         5 000254   440003 713400                    CLIMB   alt,+16387
         5 000255   401000 401760                    pmme    nvectors=3
         5 000256   000267 702000 5                  TSX2    IO_ERROR

     1194    11934    1   RETURN;

  11934  5 000257   000000 702200 xent               TSX2  ! X66_ARET

     1195    11935
     1196    11936
     1197    11937    1   ASF$DELREC_FORM: ENTRY ALTRET;

  11937  5 000260   000000 700200 xent  ASF$DELREC_* TSX0  ! X66_AUTO_3
         5 000261   000006 000003                    ZERO    6,3

     1198    11938    1   CALL M$DELREC(DELREC_FPT) ALTRET(IO_ERROR);

  11938  5 000262   000340 630400 4                  EPPR0   DELREC_FPT
         5 000263   440002 713400                    CLIMB   alt,+16386
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:236  
         5 000264   401400 401760                    pmme    nvectors=4
         5 000265   000267 702000 5                  TSX2    IO_ERROR

     1199    11939    1   RETURN;

  11939  5 000266   000000 702200 xent               TSX2  ! X66_ARET

     1200    11940
     1201    11941
     1202    11942    1   IO_ERROR:
     1203    11943    1   ERR_CODE = B$TCB$->B$TCB.ALT$->B$ALT.ERR;

  11943  5 000267   000000 470400 xsym  IO_ERROR     LDP0    B$TCB$
         5 000270   000000 471500                    LDP1    0,,PR0
         5 000271   100102 236100                    LDQ     66,,PR1
         5 000272   000000 756000 xsym               STQ     ERR_CODE

     1204    11944    1   AS_DCBNUM# = DCBNUM( M$FORM );

  11944  5 000273   000000 236007 xsym               LDQ     M$FORM,DL
         5 000274   000000 756000 xsym               STQ     AS_DCBNUM#

     1205    11945    1   ALTRETURN;

  11945  5 000275   000000 702200 xent               TSX2  ! X66_AALT
     1206    11946
     1207    11947
     1208    11948    1   END ASF$READ_FORM;
     1209    11949        %EOD;

PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:237  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASF$READ_FORM.
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:238  

 **** Variables and constants ****

  ****  Section 003 RoData ASF$READ_FORM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(54)    r     1 FORM_FILE

  ****  Section 004  Data  ASF$READ_FORM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   302-0-0/d STRC(1080)  r     1 CLOSE_FORM               340-0-0/d STRC(360)   r     1 DELREC_FPT
   272-0-0/d STRC(288)   r     1 DEQ_FORM                 260-0-0/d STRC(360)   r     1 ENQ_FORM
    74-0-0/d STRC(2088)  r     1 OPEN_CR_FPT              166-0-0/d STRC(2088)  r     1 OPEN_UP_FPT
    34-0-0/d STRC(360)   r     1 PREC_FPT                  46-0-0/d STRC(360)   r     1 PREC_SKIP_FPT
     0-0-0/d STRC(504)   r     1 READ_FPT                  16-0-0/d STRC(504)   r     1 READ_FPT_SEQ
   356-0-0/w STRC(108)   r     1 VLP_ATTR                 352-0-0/w STRC(126)   r     1 VLP_ATTR_ACC
    60-0-0/d STRC(432)   r     1 WRITE_FPT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w PTR         r     1 @ARS                       4-0-0/w PTR         r     1 @BUF$
     3-0-0/w PTR         r     1 @KEY                      *0-0-0/w UBIN        r     1 ARS
    *0-0-0/w PTR         r     1 BUF$                      *0-0-0/w ASTR(9)     r     1 KEY

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 AS_DCBNUM#                 0-0-0/b BIT         r     1 AS_TRUE
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:239  
     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/b STRC        r     1 ERR_CODE
     0-0-0/b BIT         r     1 FAST_FLAG                  0-0-0/c STRC(72)    r     1 FILE_ACCT
     0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$FORM


   Procedure ASF$READ_FORM requires 190 words for executable code.
   Procedure ASF$READ_FORM requires 6 words of local(AUTO) storage.
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:240  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:241  
          MINI XREF LISTING

ARS
        12**DCL         7--PROC    11878>>ASSIGN  11881<<ASSIGN  11884--ENTRY   11886>>ASSIGN  11919--ENTRY
     11921>>ASSIGN  11923<<ASSIGN
ASA_BRKS_LOC
      8406**DCL      8406--REDEF
AS_DCBNUM#
      8413**DCL     11898<<ASSIGN  11944<<ASSIGN
AS_DEFAULT.BANNER_PERM
      9099**DCL      9100--REDEF
AS_DEFAULT.BUDGET.MACCT
      9004**DCL      9008--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
      9017**DCL      9020--REDEF
AS_DEFAULT.BUDGET.PACCUM
      9000**DCL      9002--REDEF
AS_DEFAULT.BUDGET.PMAXC
      8995**DCL      8997--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
      9115**DCL      9116--REDEF    9117--REDEF
AS_DEFAULT_DREC.PASSWORD
     10369**DCL     10373--REDEF
AS_DEFAULT_DREC.RENAME
     10392**DCL     10393--REDEF
AS_DFLT.BANNER_PERM
      8921**DCL      8922--REDEF
AS_DFLT.BUDGET.MACCT
      8826**DCL      8830--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
      8839**DCL      8842--REDEF
AS_DFLT.BUDGET.PACCUM
      8822**DCL      8824--REDEF
AS_DFLT.BUDGET.PMAXC
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:242  
      8817**DCL      8819--REDEF
AS_DFLT.SETUP_CHRA.TXT
      8937**DCL      8938--REDEF    8939--REDEF
AS_FE_MODE
      8272**DCL      8273--REDEF
AS_MODE
      8269**DCL      8271--REDEF
AS_MOD_USER.ACCESS
     11134**DCL     11135--REDEF
AS_MOD_USER.BANNER
     11121**DCL     11122--REDEF
AS_MOD_USER.BANNER_PERM
     11123**DCL     11124--REDEF
AS_MOD_USER.BILL
     11129**DCL     11130--REDEF
AS_MOD_USER.CPROC
     11125**DCL     11126--REDEF
AS_MOD_USER.FEBILL
     11205**DCL     11206--REDEF
AS_MOD_USER.FECXTMEM
     11222**DCL     11223--REDEF
AS_MOD_USER.FEMINTS
     11207**DCL     11208--REDEF
AS_MOD_USER.FEMMEM
     11218**DCL     11219--REDEF
AS_MOD_USER.FEMTIME
     11216**DCL     11217--REDEF
AS_MOD_USER.FEPPRIV
     11213**DCL     11215--REDEF
AS_MOD_USER.FEPRIV
     11210**DCL     11212--REDEF
AS_MOD_USER.FORCE_BIT
     11119**DCL     11120--REDEF
AS_MOD_USER.KEY
     11201**DCL     11203--REDEF
AS_MOD_USER.LASTCPROC
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:243  
     11127**DCL     11128--REDEF
AS_MOD_USER.LIMITS.DO_
     11175**DCL     11176--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     11191**DCL     11192--REDEF
AS_MOD_USER.LIMITS.LO
     11171**DCL     11172--REDEF
AS_MOD_USER.LIMITS.MEM
     11167**DCL     11168--REDEF
AS_MOD_USER.LIMITS.MPRIO
     11195**DCL     11196--REDEF
AS_MOD_USER.LIMITS.PDIS
     11183**DCL     11184--REDEF
AS_MOD_USER.LIMITS.PO
     11179**DCL     11180--REDEF
AS_MOD_USER.LIMITS.TDIS
     11187**DCL     11188--REDEF
AS_MOD_USER.LIMITS.TIME
     11163**DCL     11164--REDEF
AS_MOD_USER.MAXENQ
     11144**DCL     11145--REDEF
AS_MOD_USER.PERM_BIT
     11117**DCL     11118--REDEF
AS_MOD_USER.PPRIV
     11139**DCL     11141--REDEF
AS_MOD_USER.PRIOB
     11146**DCL     11147--REDEF
AS_MOD_USER.PRIV
     11136**DCL     11138--REDEF
AS_MOD_USER.QUAN
     11142**DCL     11143--REDEF
AS_MOD_USER.SETUP
     11115**DCL     11116--REDEF
AS_PROJECT.BANNER_PERM
      9455**DCL      9456--REDEF
AS_PROJECT.BUDGET.MACCT
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:244  
      9360**DCL      9364--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
      9373**DCL      9376--REDEF
AS_PROJECT.BUDGET.PACCUM
      9356**DCL      9358--REDEF
AS_PROJECT.BUDGET.PMAXC
      9351**DCL      9353--REDEF
AS_PROJECT.SETUP_CHRA.TXT
      9471**DCL      9472--REDEF    9473--REDEF
AS_PROJECT_DFLT.BANNER_PERM
      9633**DCL      9634--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
      9538**DCL      9542--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
      9551**DCL      9554--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
      9534**DCL      9536--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
      9529**DCL      9531--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
      9649**DCL      9650--REDEF    9651--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     10855**DCL     10859--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     10878**DCL     10879--REDEF
AS_PROJECT_DREC.PASSWORD
     10693**DCL     10697--REDEF
AS_PROJECT_DREC.RENAME
     10716**DCL     10717--REDEF
AS_PROJ_ADMIN.BANNER_PERM
      9277**DCL      9278--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
      9182**DCL      9186--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
      9195**DCL      9198--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:245  
      9178**DCL      9180--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
      9173**DCL      9175--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
      9293**DCL      9294--REDEF    9295--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     10531**DCL     10535--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     10554**DCL     10555--REDEF
AS_TRUE
      8266**DCL     11914>>IF
AS_USERS.BANNER_PERM
      8743**DCL      8744--REDEF
AS_USERS.BUDGET.MACCT
      8648**DCL      8652--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
      8661**DCL      8664--REDEF
AS_USERS.BUDGET.PACCUM
      8644**DCL      8646--REDEF
AS_USERS.BUDGET.PMAXC
      8639**DCL      8641--REDEF
AS_USERS.SETUP_CHRA.TXT
      8759**DCL      8760--REDEF    8761--REDEF
AS_USERS_CONSTANT.BANNER_PERM
      9811**DCL      9812--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
      9716**DCL      9720--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
      9729**DCL      9732--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
      9712**DCL      9714--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
      9707**DCL      9709--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
      9827**DCL      9828--REDEF    9829--REDEF
B$ALT.CODE
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:246  
     11264**DCL     11264--REDEF   11265--REDEF   11265--REDEF
B$ALT.ERR
     11265**DCL     11897>>ASSIGN  11943>>ASSIGN
B$ALT.ERR.ERR#
     11266**DCL     11266--REDEF
B$ALT.EVID
     11265**DCL     11265--REDEF   11265--REDEF
B$TCB.ALT$
     11260**DCL     11897>>ASSIGN  11943>>ASSIGN
B$TCB$
     11258**DCL     11897>>ASSIGN  11943>>ASSIGN
BUF$
        11**DCL         7--PROC    11877>>ASSIGN  11884--ENTRY   11885>>ASSIGN  11919--ENTRY   11920>>ASSIGN
CLOSE_FORM
     11769**DCL     11916<>CALL
CLOSE_FORM.SN_
     11769**DCL     11769--REDEF
CLOSE_FORM.UTL_
     11770**DCL     11770--REDEF
CLOSE_FORM.V
     11774**DCL     11769--DCLINIT
CLOSE_FORM.V.EXPIRE#
     11784**DCL     11784--REDEF
CLOSE_FORM.V.TYPE#
     11782**DCL     11782--REDEF
CLOSE_FORM.V.XTNSIZE#
     11779**DCL     11779--REDEF   11781--REDEF
DELREC_FPT
     11801**DCL     11938<>CALL
DELREC_FPT.V
     11804**DCL     11801--DCLINIT
DEQ_ERR
     11895**LABEL   11893--CALLALT
DEQ_ERR2
     11901**LABEL   11899--CALLALT
DEQ_FORM
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:247  
     11738**DCL     11893<>CALL    11899<>CALL
DEQ_FORM.RNAME_
     11738**DCL     11889<<ASSIGN
DEQ_FORM.V
     11739**DCL     11738--DCLINIT
ENQ_ERR
     11892**LABEL   11890--CALLALT
ENQ_FORM
     11718**DCL     11890<>CALL
ENQ_FORM.RNAME_
     11718**DCL     11888<<ASSIGN
ENQ_FORM.V
     11719**DCL     11718--DCLINIT
ERR_CODE
      8401**DCL      8402--REDEF   11897<<ASSIGN  11943<<ASSIGN
F$DCB.ACTPOS
       120**DCL       120--REDEF
F$DCB.ARS
        95**DCL        95--REDEF   11881>>ASSIGN  11923>>ASSIGN
F$DCB.ATTR
       113**DCL       114--REDEF
F$DCB.BORROW
       128**DCL       128--REDEF     128--REDEF     128--REDEF
F$DCB.DCBNAME.L
       142**DCL       142--IMP-SIZ
F$DCB.EOMCHAR
        99**DCL        99--REDEF
F$DCB.FLDID
       123**DCL       123--REDEF
F$DCB.FORM$
       117**DCL       117--REDEF
F$DCB.FSECT
       133**DCL       133--REDEF
F$DCB.FSN
       110**DCL       110--REDEF     110--REDEF     111--REDEF
F$DCB.HEADER$
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:248  
       116**DCL       116--REDEF
F$DCB.IXTNSIZE
       114**DCL       114--REDEF
F$DCB.LASTSTA$
       104**DCL       104--REDEF
F$DCB.LVL
       129**DCL       129--REDEF
F$DCB.NAME.C
       104**DCL       104--REDEF
F$DCB.NOEOF
       125**DCL       125--REDEF
F$DCB.NRECS
       115**DCL       115--REDEF
F$DCB.NRECX
       134**DCL       134--REDEF
F$DCB.OHDR
       126**DCL       126--REDEF
F$DCB.ORG
       109**DCL       109--REDEF
F$DCB.PRECNO
       132**DCL       132--REDEF
F$DCB.RCSZ
       137**DCL       137--REDEF
F$DCB.RES
       105**DCL       105--REDEF
F$DCB.SETX
       117**DCL       117--REDEF
F$DCB.TAB$
       116**DCL       117--REDEF
F$DCB.TDA
       131**DCL       131--REDEF
F$DCB.WSN
       106**DCL       106--REDEF
FAST_FLAG
      8399**DCL     11914>>IF
FILE_ACCT
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:249  
      8409**DCL     11549--DCLINIT 11666--DCLINIT
FORM_FILE
     11296**DCL     11545--DCLINIT 11662--DCLINIT
IO_ERROR
     11943**LABEL   11880--CALLALT 11905--CALLALT 11909--CALLALT 11916--CALLALT 11922--CALLALT 11929--CALLALT
     11933--CALLALT 11938--CALLALT
KEY
         8**DCL         7--PROC    11879--ASSIGN  11884--ENTRY   11887--ASSIGN  11888--ASSIGN  11889--ASSIGN
     11919--ENTRY   11927--ENTRY   11928--ASSIGN  11931--ENTRY   11932--ASSIGN
KEY.CNT
         9**DCL        10--IMP-SIZ 11879>>ASSIGN  11887>>ASSIGN  11888>>ASSIGN  11889>>ASSIGN  11928>>ASSIGN
     11932>>ASSIGN
KL_DEFAULT.PASSWORD
     11017**DCL     11021--REDEF
KL_DEFAULT.RENAME
     11040**DCL     11041--REDEF
KL_DFLT.PASSWORD
     10207**DCL     10211--REDEF
KL_DFLT.RENAME
     10230**DCL     10231--REDEF
KL_DREC.PASSWORD
     10045**DCL     10049--REDEF
KL_DREC.RENAME
     10068**DCL     10069--REDEF
KL_DREC_CNT.PASSWORD
      9932**DCL      9936--REDEF
KL_DREC_CNT.RENAME
      9955**DCL      9956--REDEF
M$CLOSE
        22**DCL-ENT 11916--CALL
M$DELREC
        24**DCL-ENT 11938--CALL
M$DEQ
        89**DCL-ENT 11893--CALL    11899--CALL
M$ENQ
        88**DCL-ENT 11890--CALL
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:250  
M$FORM
     11270**DCL     11881--ASSIGN  11898>>ASSIGN  11923--ASSIGN  11944>>ASSIGN
M$OPEN
        22**DCL-ENT 11905--CALL    11909--CALL
M$PRECORD
        26**DCL-ENT 11929--CALL    11933--CALL
M$READ
        23**DCL-ENT 11880--CALL    11922--CALL
M$WRITE
        23**DCL-ENT 11892--CALL
OPEN_CR_FPT
     11544**DCL     11905<>CALL
OPEN_CR_FPT.ACSVEH_
     11546**DCL     11547--REDEF
OPEN_CR_FPT.ALTKEYS_
     11552**DCL     11553--REDEF   11553--REDEF
OPEN_CR_FPT.HDR_
     11551**DCL     11552--REDEF
OPEN_CR_FPT.TAB_
     11550**DCL     11551--REDEF
OPEN_CR_FPT.UHL_
     11544**DCL     11545--REDEF   11545--REDEF
OPEN_CR_FPT.V
     11553**DCL     11544--DCLINIT
OPEN_CR_FPT.V.FSN#
     11584**DCL     11584--REDEF   11584--REDEF
OPEN_CR_FPT.WSN_
     11550**DCL     11550--REDEF
OPEN_UP_FPT
     11661**DCL     11909<>CALL
OPEN_UP_FPT.ACSVEH_
     11663**DCL     11664--REDEF
OPEN_UP_FPT.ALTKEYS_
     11669**DCL     11670--REDEF   11670--REDEF
OPEN_UP_FPT.HDR_
     11668**DCL     11669--REDEF
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:251  
OPEN_UP_FPT.TAB_
     11667**DCL     11668--REDEF
OPEN_UP_FPT.UHL_
     11661**DCL     11662--REDEF   11662--REDEF
OPEN_UP_FPT.V
     11670**DCL     11661--DCLINIT
OPEN_UP_FPT.V.FSN#
     11701**DCL     11701--REDEF   11701--REDEF
OPEN_UP_FPT.WSN_
     11667**DCL     11667--REDEF
PREC_FPT
     11397**DCL     11929<>CALL
PREC_FPT.KEY_
     11397**DCL     11928<<ASSIGN
PREC_FPT.V
     11399**DCL     11397--DCLINIT
PREC_SKIP_FPT
     11422**DCL     11933<>CALL
PREC_SKIP_FPT.KEY_
     11422**DCL     11932<<ASSIGN
PREC_SKIP_FPT.V
     11424**DCL     11422--DCLINIT
PROJ_KEY.TEXT
      8279**DCL      8279--REDEF
PROJ_KEY.TXT.PROJECT
      8279**DCL      8279--REDEF
READ_FPT
     11317**DCL     11880<>CALL
READ_FPT.BUF_.BOUND
     11319**DCL     11878<<ASSIGN
READ_FPT.BUF_.BUF$
     11320**DCL     11877<<ASSIGN
READ_FPT.KEY_
     11317**DCL     11879<<ASSIGN
READ_FPT.STATION_
     11320**DCL     11321--REDEF
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:252  
READ_FPT.V
     11321**DCL     11317--DCLINIT
READ_FPT.V.DVBYTE.REREAD#
     11332**DCL     11332--REDEF
READ_FPT.V.INDX#
     11330**DCL     11330--REDEF
READ_FPT_SEQ
     11360**DCL     11922<>CALL
READ_FPT_SEQ.BUF_.BOUND
     11362**DCL     11921<<ASSIGN
READ_FPT_SEQ.BUF_.BUF$
     11363**DCL     11920<<ASSIGN
READ_FPT_SEQ.STATION_
     11363**DCL     11364--REDEF
READ_FPT_SEQ.V
     11364**DCL     11360--DCLINIT
READ_FPT_SEQ.V.DVBYTE.REREAD#
     11375**DCL     11375--REDEF
READ_FPT_SEQ.V.INDX#
     11373**DCL     11373--REDEF
REMEM_VAR
      8405**DCL      8405--REDEF
REM_FCMD
      8405**DCL      8406--REDEF
USERS_KEY
      8276**DCL     11360--DCLINIT 11361--DCLINIT 11801--DCLINIT 11802--DCLINIT
USERS_KEY.TEXT
      8276**DCL      8277--REDEF    8277--REDEF    8277--REDEF    8278--REDEF
VLP_ATTR
     11851**DCL     11547--DCLINIT
VLP_ATTR.Q
     11852**DCL     11851--DCLINIT
VLP_ATTR_ACC
     11820**DCL     11546--DCLINIT
VLP_ATTR_ACC.Q
     11821**DCL     11820--DCLINIT
PL6.E3A0      #005=ASF$READ_FORM File=ASB$FILES.:E05TSI                          TUE 07/29/97 09:18 Page:253  
WRITE_ERR
     11897**LABEL   11892--CALLALT
WRITE_FPT
     11451**DCL     11892<>CALL
WRITE_FPT.BUF_.BOUND
     11451**DCL     11886<<ASSIGN
WRITE_FPT.BUF_.BUF$
     11453**DCL     11885<<ASSIGN
WRITE_FPT.KEY_
     11451**DCL     11887<<ASSIGN
WRITE_FPT.STATION_
     11453**DCL     11453--REDEF
WRITE_FPT.V
     11454**DCL     11451--DCLINIT
WRITE_FPT.V.DVBYTE.VFC#
     11460**DCL     11460--REDEF

PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:254  
     1210        1        /*T***********************************************************/
     1211        2        /*T*                                                         */
     1212        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1213        4        /*T*                                                         */
     1214        5        /*T***********************************************************/
     1215        6        %EJECT;
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:255  
     1216        7        /*P*  NAME:       ASW$WSN_IO
     1217        8              PURPOSE:    Manage the :WSN file.
     1218        9              DESCRIPTION:
     1219       10                  This procedure has 11 entries:
     1220       11
     1221       12                  ASW$READ_WSN            - reads a record from :WSN by key.
     1222       13                  ASW$WRITE_WSN           - writes a record to :WSN.
     1223       14                  ASW$DELREC_WSN          - deletes a record from :WSN.
     1224       15                  ASW$PREC_WSN            - positions to a record in :WSN.
     1225       16                  ASW$OPEN_WSN_CR         - creates :WSN
     1226       17                  ASW$OPEN_WSN_UP         - opens :WSN update
     1227       18                  ASW$CLOSE_WSN           - closes :WSN
     1228       19                  ASW$READ_WSN_SEQ        - reads a record from :WSN sequentially.
     1229       20                  ASW$BOF_WSN             - postions to the beginning of :WSN
     1230       21                  ASW$ENQ_WSN             - enques a record in :WSN
     1231       22                  ASW$DEQ_WSN             - deques a record in :WSN
     1232       23        */
     1233       24
     1234       25
     1235       26        ASW$WSN_IO: PROC ( BUF$, ARS) ALTRET ;
     1236       27
     1237       28
     1238       29        /*********************************************************************/
     1239       30        /*   Include files   include files   include files   include files   */
     1240       31        /*********************************************************************/
     1241       32
     1242       33        %INCLUDE CP_6 ;
     1243      114              %INCLUDE AS_ENTRIES_M ;
     1244     1164              %INCLUDE AS_SUPER_C ;
     1245     1599              %INCLUDE AS_SUBS_C ;
     1246     3013              %INCLUDE AS_MAC_C ;
     1247     3093              %INCLUDE KL_SUPER_C ;
     1248     5995              %INCLUDE XU_MACRO_C ;
     1249     9101              %INCLUDE XU_FORMAT_C ;
     1250     9263              %INCLUDE AS_SUPER_R ;
     1251    12279
     1252    12280        /*********************************************************************/
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:256  
     1253    12281        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
     1254    12282        /*********************************************************************/
     1255    12283        %ASH$ERROR;
     1256    12286        /*********************************************************************/
     1257    12287        /*   Local based     local based     local based     local based     */
     1258    12288        /*********************************************************************/
     1259    12289
     1260    12290              %B$ALT ;
     1261    12298              %B$TCB ;
     1262    12301
     1263    12302        /*********************************************************************/
     1264    12303        /*   Symref's        symref's        symref's        symref's        */
     1265    12304        /*********************************************************************/
     1266    12305
     1267    12306    1   DCL B$TCB$ PTR SYMREF ;
     1268    12307
     1269    12308        /*********************************************************************/
     1270    12309        /*   Parameters      parameters      parameters      parameters      */
     1271    12310        /*********************************************************************/
     1272    12311
     1273    12312    1   DCL 1 KEY,
     1274    12313    1          2 CNT UBIN BYTE UNAL,
     1275    12314    1          2 TEXT CHAR(9);
     1276    12315    1   DCL BUF$ PTR ;
     1277    12316    1   DCL ARS UBIN WORD ;
     1278    12317
     1279    12318
     1280    12319        /*********************************************************************/
     1281    12320        /*   Fpts            fpts            fpts            fpts            */
     1282    12321        /*********************************************************************/
     1283    12322
     1284    12323              %FPT_OPEN (FPTN=OPEN_CR_FPT ,
     1285    12324                          NAME = FILE_NAME ,
     1286    12325                          ACCT = FILE_ACCT ,
     1287    12326                          ASN  = FILE ,
     1288    12327                          DCB = M$WSN ,
     1289    12328                          ACS = DIRECT ,
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:257  
     1290    12329                          ORG = KEYED ,
     1291    12330                          ACSVEH = VLP_ATTR ,
     1292    12331                          ACCESS = VLP_ATTR_ACC ,
     1293    12332                          FUN = CREATE ,
     1294    12333                          IXTNSIZE = 8 ,
     1295    12334                          XTNSIZE = 8 ,
     1296    12335                          EXIST = OLDFILE) ;
     1297    12444              %FPT_OPEN (FPTN=OPEN_UP_FPT ,
     1298    12445                          NAME = FILE_NAME ,
     1299    12446                          ACCT = FILE_ACCT ,
     1300    12447                          ASN  = FILE ,
     1301    12448                          DCB = M$WSN ,
     1302    12449                          ACS = DIRECT ,
     1303    12450                          ORG = KEYED ,
     1304    12451                          FUN = UPDATE ,
     1305    12452                          SHARE = ALL) ;
     1306    12561              %FPT_CLOSE  (FPTN = CLOSE_FPT ,
     1307    12562                           DCB = M$WSN ,
     1308    12563                           DISP = SAVE) ;
     1309    12605              %FPT_ENQ (  FPTN = FPT_ENQ ,
     1310    12606                          DCB = M$WSN ,
     1311    12607                          SHARE = NONE ) ;
     1312    12625              %FPT_DEQ (  FPTN = FPT_DEQ ,
     1313    12626                          DCB = M$WSN ) ;
     1314    12643              %FPT_READ  (FPTN = READ_FPT ,
     1315    12644                          DCB = M$WSN ,
     1316    12645                          KEYS = YES) ;
     1317    12684              %FPT_WRITE  (FPTN = WRITE_FPT ,
     1318    12685                           ONEWKEY = YES ,
     1319    12686                           DCB = M$WSN) ;
     1320    12717              %FPT_DELREC  (FPTN = DELREC_FPT ,
     1321    12718                            DCB = M$WSN) ;
     1322    12737              %FPT_PRECORD  (FPTN = PREC_FPT ,
     1323    12738                             DCB = M$WSN ,
     1324    12739                             KEYS = YES ,
     1325    12740                             N = 0 ) ;
     1326    12761              %FPT_READ    (FPTN = READ_SEQ_FPT ,
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:258  
     1327    12762                            DCB = M$WSN ,
     1328    12763                            KEYR = YES ,
     1329    12764                            KEYS = NO ) ;
     1330    12803              %FPT_PFIL    (FPTN = PFIL_FPT ,
     1331    12804                            DCB = M$WSN ,
     1332    12805                            BOF = YES ) ;
     1333    12820              %FPT_PRECORD (FPTN = PREC_AND_SKIP_FPT ,
     1334    12821                            DCB  = M$WSN,
     1335    12822                            KEY  = USERS_KEY,
     1336    12823                            KEYS = YES,
     1337    12824                            KEYR = YES,
     1338    12825                            N    = 1 ) ;
     1339    12846
     1340    12847
     1341    12848        /*********************************************************************/
     1342    12849        /*   Vlps            vlps            vlps            vlps            */
     1343    12850        /*********************************************************************/
     1344    12851
     1345    12852              %VLP_NAME( FPTN=FILE_NAME, NAME=':WSN' );
     1346    12879              %VLP_ATTR ;
     1347    12893              %VLP_ACSVEH(  UPD = YES ,
     1348    12894                            READ = YES ,
     1349    12895                            DELR = YES ,
     1350    12896                            WNEW = YES ,
     1351    12897                            VEHICLE = 'SUPER' ) ;
     1352    12914              %VLP_ACSVEH(  UPD = YES ,
     1353    12915                            READ = YES ,
     1354    12916                            VEHICLE = 'IBEX' ) ;
     1355    12933              %VLP_ACSVEH(  READ = YES ,
     1356    12934                            VEHICLE = 'LOGON' ) ;
     1357    12951              %VLP_ACSVEH(  READ = YES ,
     1358    12952                            VEHICLE = 'PRESCAN' ,
     1359    12953                            LAST=";") ;
     1360    12970              %VLP_ATTR(  FPTN = VLP_ATTR_ACC ) ;
     1361    12984              %VLP_ACCESS(  EXEC = YES ,
     1362    12985                            READ = YES ,
     1363    12986                            ACCT = '?' ,
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:259  
     1364    12987                            LAST=";") ;
     1365    13004
     1366    13005        /*********************************************************************/
     1367    13006        /*   Based data      based data      based data      based data      */
     1368    13007        /*********************************************************************/
     1369    13008
     1370    13009              %F$DCB( DCBN = F$DCB ) ;
     1371    13066
     1372    13067        /*********************************************************************/
     1373    13068        /*   Dcbs            dcbs            dcbs            dcbs            */
     1374    13069        /*********************************************************************/
     1375    13070
     1376    13071    1   DCL M$WSN DCB ;                                      /*  Read-write :WSN record */
     1377    13072
     1378    13073        %EJECT;
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:260  
     1379    13074        /********************************************************************/
     1380    13075        /*   Procedure       procedure       procedure       procedure       */
     1381    13076        /*********************************************************************/
     1382    13077
     1383    13078
     1384    13079    1   ASW$READ_WSN: ENTRY( BUF$, ARS ) ALTRET;
     1385    13080
     1386    13081    1   READ_FPT.BUF_.BUF$ = BUF$ ;
     1387    13082    1   READ_FPT.BUF_.BOUND = ARS - 1 ;
     1388    13083    1   READ_FPT.KEY_ = VECTOR( USERS_KEY ) ;
     1389    13084    1   CALL M$READ (READ_FPT) ALTRET(IO_ERR) ;
     1390    13085    1   ARS = DCBADDR(DCBNUM(M$WSN)) -> F$DCB.ARS# ;
     1391    13086    1   RETURN ;
     1392    13087
     1393    13088
     1394    13089    1   ASW$WRITE_WSN: ENTRY ( BUF$, ARS) ALTRET ;
     1395    13090
     1396    13091    1   WRITE_FPT.BUF_.BUF$ = BUF$ ;
     1397    13092    1   WRITE_FPT.BUF_.BOUND = ARS - 1 ;
     1398    13093    1   WRITE_FPT.KEY_ = VECTOR( USERS_KEY ) ;
     1399    13094    1   CALL M$WRITE (WRITE_FPT) ALTRET(IO_ERR) ;
     1400    13095    1   RETURN ;
     1401    13096
     1402    13097
     1403    13098    1   ASW$DELREC_WSN: ENTRY   ALTRET ;
     1404    13099
     1405    13100    1   DELREC_FPT.KEY_ = VECTOR( USERS_KEY ) ;
     1406    13101    1   CALL M$DELREC (DELREC_FPT) ALTRET(IO_ERR) ;
     1407    13102    1   RETURN ;
     1408    13103
     1409    13104
     1410    13105    1   ASW$PREC_WSN: ENTRY  ALTRET ;
     1411    13106
     1412    13107    1   PREC_FPT.KEY_ = VECTOR( USERS_KEY ) ;
     1413    13108    1   CALL M$PRECORD (PREC_FPT) ALTRET(IO_ERR) ;
     1414    13109    1   RETURN ;
     1415    13110
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:261  
     1416    13111
     1417    13112    1   ASW$PREC_AND_SKIP_WSN: ENTRY  ALTRET ;
     1418    13113
     1419    13114    1   CALL M$PRECORD( PREC_AND_SKIP_FPT ) ALTRET( IO_ERR ) ;
     1420    13115    1   RETURN ;
     1421    13116
     1422    13117    1   ASW$OPEN_WSN_CR: ENTRY ALTRET;
     1423    13118
     1424    13119    1   CALL M$OPEN (OPEN_CR_FPT) ALTRET(IO_ERR) ;
     1425    13120    1   RETURN ;
     1426    13121
     1427    13122
     1428    13123    1   ASW$OPEN_WSN_UP: ENTRY ALTRET;
     1429    13124
     1430    13125    1   CALL M$OPEN (OPEN_UP_FPT) ALTRET(IO_ERR) ;
     1431    13126    1   RETURN ;
     1432    13127
     1433    13128
     1434    13129    1   ASW$CLOSE_WSN: ENTRY ALTRET;
     1435    13130
     1436    13131    1   CALL M$CLOSE (CLOSE_FPT) ;
     1437    13132    1   RETURN ;
     1438    13133
     1439    13134
     1440    13135    1   ASW$READ_WSN_SEQ: ENTRY ( BUF$, ARS) ALTRET ;
     1441    13136
     1442    13137    1   READ_SEQ_FPT.BUF_.BUF$ = BUF$ ;
     1443    13138    1   READ_SEQ_FPT.BUF_.BOUND = ARS - 1 ;
     1444    13139    1   READ_SEQ_FPT.KEY_ = VECTOR( USERS_KEY ) ;
     1445    13140    1   CALL M$READ(READ_SEQ_FPT) ALTRET (IO_ERR) ;
     1446    13141    1   ARS = DCBADDR(DCBNUM(M$WSN)) -> F$DCB.ARS# ;
     1447    13142    1   RETURN ;
     1448    13143
     1449    13144
     1450    13145    1   ASW$BOF_WSN: ENTRY ALTRET;
     1451    13146
     1452    13147    1   CALL M$PFIL(PFIL_FPT) ALTRET(IO_ERR) ;
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:262  
     1453    13148    1   RETURN ;
     1454    13149
     1455    13150
     1456    13151    1   ASW$ENQ_WSN: ENTRY ALTRET ;
     1457    13152
     1458    13153    1   FPT_ENQ.RNAME_ = VECTOR( USERS_KEY ) ;
     1459    13154    1   CALL M$ENQ( FPT_ENQ ) ALTRET( IO_ERR ) ;
     1460    13155    1   RETURN ;
     1461    13156
     1462    13157
     1463    13158    1   ASW$DEQ_WSN: ENTRY ALTRET ;
     1464    13159
     1465    13160    1   CALL M$DEQ( FPT_DEQ ) ALTRET( IO_ERR ) ;
     1466    13161    1   RETURN ;
     1467    13162
     1468    13163    1   IO_ERR:
     1469    13164    1   ERR_CODE = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR ;
     1470    13165    1   AS_DCBNUM# = DCBNUM( M$WSN );
     1471    13166    1   ALTRETURN ;
     1472    13167
     1473    13168    1   END   ASW$WSN_IO ;

PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:263  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASW$WSN_IO.

   Procedure ASW$WSN_IO requires 149 words for executable code.
   Procedure ASW$WSN_IO requires 8 words of local(AUTO) storage.

    No errors detected in file ASB$FILES.:E05TSI    .

PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:264  

 Object Unit name= ASW$WSN_IO                                 File name= ASB$FILES.:E05TOU
 UTS= JUL 29 '97 09:20:08.04 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2   Data  even  none   254    376  ASW$WSN_IO
    3   DCB   even  none     0      0  M$WSN
    4   Proc  even  none   149    225  ASW$WSN_IO
    5  RoData even  none     3      3  ASW$WSN_IO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        2  ASW$WSN_IO
     4      3          yes     yes      Std        2  ASW$READ_WSN
     4     35          yes     yes      Std        2  ASW$WRITE_WSN
     4     60          yes     yes      Std        0  ASW$DELREC_WSN
     4     71          yes     yes      Std        0  ASW$PREC_WSN
     4    102          yes     yes      Std        0  ASW$PREC_AND_SKIP_WSN
     4    111          yes     yes      Std        0  ASW$OPEN_WSN_CR
     4    120          yes     yes      Std        0  ASW$OPEN_WSN_UP
     4    127          yes     yes      Std        0  ASW$CLOSE_WSN
     4    135          yes     yes      Std        2  ASW$READ_WSN_SEQ
     4    167          yes     yes      Std        0  ASW$BOF_WSN
     4    176          yes     yes      Std        0  ASW$ENQ_WSN
     4    207          yes     yes      Std        0  ASW$DEQ_WSN
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:265  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    AS_MODE                          r    AS_FE_MODE
     M$LO                                  USERS_KEY                             ERR_CODE
     REMEM_VAR                             REM_FCMD                              ASA_BRKS_LOC
     FILE_ACCT                             AS_DCBNUM#                            B$TCB$
     M$WSN                                 B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:266  


     1210        1        /*T***********************************************************/
     1211        2        /*T*                                                         */
     1212        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1213        4        /*T*                                                         */
     1214        5        /*T***********************************************************/
     1215        6        %EJECT;
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:267  
     1216        7        /*P*  NAME:       ASW$WSN_IO
     1217        8              PURPOSE:    Manage the :WSN file.
     1218        9              DESCRIPTION:
     1219       10                  This procedure has 11 entries:
     1220       11
     1221       12                  ASW$READ_WSN            - reads a record from :WSN by key.
     1222       13                  ASW$WRITE_WSN           - writes a record to :WSN.
     1223       14                  ASW$DELREC_WSN          - deletes a record from :WSN.
     1224       15                  ASW$PREC_WSN            - positions to a record in :WSN.
     1225       16                  ASW$OPEN_WSN_CR         - creates :WSN
     1226       17                  ASW$OPEN_WSN_UP         - opens :WSN update
     1227       18                  ASW$CLOSE_WSN           - closes :WSN
     1228       19                  ASW$READ_WSN_SEQ        - reads a record from :WSN sequentially.
     1229       20                  ASW$BOF_WSN             - postions to the beginning of :WSN
     1230       21                  ASW$ENQ_WSN             - enques a record in :WSN
     1231       22                  ASW$DEQ_WSN             - deques a record in :WSN
     1232       23        */
     1233       24
     1234       25
     1235       26        ASW$WSN_IO: PROC ( BUF$, ARS) ALTRET ;

     26  4 000000   000000 700200 xent  ASW$WSN_IO   TSX0  ! X66_AUTO_2
         4 000001   000010 000002                    ZERO    8,2
         4 000002   000005 710000 4                  TRA     s:13081

     1236       27
     1237       28
     1238       29        /*********************************************************************/
     1239       30        /*   Include files   include files   include files   include files   */
     1240       31        /*********************************************************************/
     1241       32
     1242       33        %INCLUDE CP_6 ;
     1243      114              %INCLUDE AS_ENTRIES_M ;
     1244     1164              %INCLUDE AS_SUPER_C ;
     1245     1599              %INCLUDE AS_SUBS_C ;
     1246     3013              %INCLUDE AS_MAC_C ;
     1247     3093              %INCLUDE KL_SUPER_C ;
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:268  
     1248     5995              %INCLUDE XU_MACRO_C ;
     1249     9101              %INCLUDE XU_FORMAT_C ;
     1250     9263              %INCLUDE AS_SUPER_R ;
     1251    12279
     1252    12280        /*********************************************************************/
     1253    12281        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
     1254    12282        /*********************************************************************/
     1255    12283        %ASH$ERROR;
     1256    12286        /*********************************************************************/
     1257    12287        /*   Local based     local based     local based     local based     */
     1258    12288        /*********************************************************************/
     1259    12289
     1260    12290              %B$ALT ;
     1261    12298              %B$TCB ;
     1262    12301
     1263    12302        /*********************************************************************/
     1264    12303        /*   Symref's        symref's        symref's        symref's        */
     1265    12304        /*********************************************************************/
     1266    12305
     1267    12306    1   DCL B$TCB$ PTR SYMREF ;
     1268    12307
     1269    12308        /*********************************************************************/
     1270    12309        /*   Parameters      parameters      parameters      parameters      */
     1271    12310        /*********************************************************************/
     1272    12311
     1273    12312    1   DCL 1 KEY,
     1274    12313    1          2 CNT UBIN BYTE UNAL,
     1275    12314    1          2 TEXT CHAR(9);
     1276    12315    1   DCL BUF$ PTR ;
     1277    12316    1   DCL ARS UBIN WORD ;
     1278    12317
     1279    12318
     1280    12319        /*********************************************************************/
     1281    12320        /*   Fpts            fpts            fpts            fpts            */
     1282    12321        /*********************************************************************/
     1283    12322
     1284    12323              %FPT_OPEN (FPTN=OPEN_CR_FPT ,
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:269  
     1285    12324                          NAME = FILE_NAME ,
     1286    12325                          ACCT = FILE_ACCT ,
     1287    12326                          ASN  = FILE ,
     1288    12327                          DCB = M$WSN ,
     1289    12328                          ACS = DIRECT ,
     1290    12329                          ORG = KEYED ,
     1291    12330                          ACSVEH = VLP_ATTR ,
     1292    12331                          ACCESS = VLP_ATTR_ACC ,
     1293    12332                          FUN = CREATE ,
     1294    12333                          IXTNSIZE = 8 ,
     1295    12334                          XTNSIZE = 8 ,
     1296    12335                          EXIST = OLDFILE) ;
     1297    12444              %FPT_OPEN (FPTN=OPEN_UP_FPT ,
     1298    12445                          NAME = FILE_NAME ,
     1299    12446                          ACCT = FILE_ACCT ,
     1300    12447                          ASN  = FILE ,
     1301    12448                          DCB = M$WSN ,
     1302    12449                          ACS = DIRECT ,
     1303    12450                          ORG = KEYED ,
     1304    12451                          FUN = UPDATE ,
     1305    12452                          SHARE = ALL) ;
     1306    12561              %FPT_CLOSE  (FPTN = CLOSE_FPT ,
     1307    12562                           DCB = M$WSN ,
     1308    12563                           DISP = SAVE) ;
     1309    12605              %FPT_ENQ (  FPTN = FPT_ENQ ,
     1310    12606                          DCB = M$WSN ,
     1311    12607                          SHARE = NONE ) ;
     1312    12625              %FPT_DEQ (  FPTN = FPT_DEQ ,
     1313    12626                          DCB = M$WSN ) ;
     1314    12643              %FPT_READ  (FPTN = READ_FPT ,
     1315    12644                          DCB = M$WSN ,
     1316    12645                          KEYS = YES) ;
     1317    12684              %FPT_WRITE  (FPTN = WRITE_FPT ,
     1318    12685                           ONEWKEY = YES ,
     1319    12686                           DCB = M$WSN) ;
     1320    12717              %FPT_DELREC  (FPTN = DELREC_FPT ,
     1321    12718                            DCB = M$WSN) ;
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:270  
     1322    12737              %FPT_PRECORD  (FPTN = PREC_FPT ,
     1323    12738                             DCB = M$WSN ,
     1324    12739                             KEYS = YES ,
     1325    12740                             N = 0 ) ;
     1326    12761              %FPT_READ    (FPTN = READ_SEQ_FPT ,
     1327    12762                            DCB = M$WSN ,
     1328    12763                            KEYR = YES ,
     1329    12764                            KEYS = NO ) ;
     1330    12803              %FPT_PFIL    (FPTN = PFIL_FPT ,
     1331    12804                            DCB = M$WSN ,
     1332    12805                            BOF = YES ) ;
     1333    12820              %FPT_PRECORD (FPTN = PREC_AND_SKIP_FPT ,
     1334    12821                            DCB  = M$WSN,
     1335    12822                            KEY  = USERS_KEY,
     1336    12823                            KEYS = YES,
     1337    12824                            KEYR = YES,
     1338    12825                            N    = 1 ) ;
     1339    12846
     1340    12847
     1341    12848        /*********************************************************************/
     1342    12849        /*   Vlps            vlps            vlps            vlps            */
     1343    12850        /*********************************************************************/
     1344    12851
     1345    12852              %VLP_NAME( FPTN=FILE_NAME, NAME=':WSN' );
     1346    12879              %VLP_ATTR ;
     1347    12893              %VLP_ACSVEH(  UPD = YES ,
     1348    12894                            READ = YES ,
     1349    12895                            DELR = YES ,
     1350    12896                            WNEW = YES ,
     1351    12897                            VEHICLE = 'SUPER' ) ;
     1352    12914              %VLP_ACSVEH(  UPD = YES ,
     1353    12915                            READ = YES ,
     1354    12916                            VEHICLE = 'IBEX' ) ;
     1355    12933              %VLP_ACSVEH(  READ = YES ,
     1356    12934                            VEHICLE = 'LOGON' ) ;
     1357    12951              %VLP_ACSVEH(  READ = YES ,
     1358    12952                            VEHICLE = 'PRESCAN' ,
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:271  
     1359    12953                            LAST=";") ;
     1360    12970              %VLP_ATTR(  FPTN = VLP_ATTR_ACC ) ;
     1361    12984              %VLP_ACCESS(  EXEC = YES ,
     1362    12985                            READ = YES ,
     1363    12986                            ACCT = '?' ,
     1364    12987                            LAST=";") ;
     1365    13004
     1366    13005        /*********************************************************************/
     1367    13006        /*   Based data      based data      based data      based data      */
     1368    13007        /*********************************************************************/
     1369    13008
     1370    13009              %F$DCB( DCBN = F$DCB ) ;
     1371    13066
     1372    13067        /*********************************************************************/
     1373    13068        /*   Dcbs            dcbs            dcbs            dcbs            */
     1374    13069        /*********************************************************************/
     1375    13070
     1376    13071    1   DCL M$WSN DCB ;                                      /*  Read-write :WSN record */
     1377    13072
     1378    13073        %EJECT;
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:272  
     1379    13074        /********************************************************************/
     1380    13075        /*   Procedure       procedure       procedure       procedure       */
     1381    13076        /*********************************************************************/
     1382    13077
     1383    13078
     1384    13079    1   ASW$READ_WSN: ENTRY( BUF$, ARS ) ALTRET;

  13079  4 000003   000000 700200 xent  ASW$READ_WSN TSX0  ! X66_AUTO_2
         4 000004   000010 000002                    ZERO    8,2

     1385    13080
     1386    13081    1   READ_FPT.BUF_.BUF$ = BUF$ ;

  13081  4 000005   200003 470500                    LDP0    @BUF$,,AUTO
         4 000006   000000 236100                    LDQ     0,,PR0
         4 000007   000251 756000 2                  STQ     READ_FPT+5

     1387    13082    1   READ_FPT.BUF_.BOUND = ARS - 1 ;

  13082  4 000010   200004 471500                    LDP1    @ARS,,AUTO
         4 000011   100000 236100                    LDQ     0,,PR1
         4 000012   000001 136007                    SBLQ    1,DL
         4 000013   000020 736000                    QLS     16
         4 000014   000250 676000 2                  ERQ     READ_FPT+4
         4 000015   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000016   000250 656000 2                  ERSQ    READ_FPT+4

     1388    13083    1   READ_FPT.KEY_ = VECTOR( USERS_KEY ) ;

  13083  4 000017   000000 237000 5                  LDAQ    0
         4 000020   000246 757000 2                  STAQ    READ_FPT+2

     1389    13084    1   CALL M$READ (READ_FPT) ALTRET(IO_ERR) ;

  13084  4 000021   000244 630400 2                  EPPR0   READ_FPT
         4 000022   440000 713400                    CLIMB   alt,read
         4 000023   401400 401760                    pmme    nvectors=4
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:273  
         4 000024   000216 702000 4                  TSX2    IO_ERR

     1390    13085    1   ARS = DCBADDR(DCBNUM(M$WSN)) -> F$DCB.ARS# ;

  13085  4 000025   000000 236007 xsym               LDQ     M$WSN,DL
         4 000026   000002 470400 5                  LDP0    2
         4 000027   000000 471500                    LDP1    0,,PR0
         4 000030   100000 473506                    LDP3    0,QL,PR1
         4 000031   300000 235100                    LDA     0,,PR3
         4 000032   200004 473500                    LDP3    @ARS,,AUTO
         4 000033   300000 755100                    STA     0,,PR3

     1391    13086    1   RETURN ;

  13086  4 000034   000000 702200 xent               TSX2  ! X66_ARET

     1392    13087
     1393    13088
     1394    13089    1   ASW$WRITE_WSN: ENTRY ( BUF$, ARS) ALTRET ;

  13089  4 000035   000000 700200 xent  ASW$WRITE_W* TSX0  ! X66_AUTO_2
         4 000036   000010 000002                    ZERO    8,2

     1395    13090
     1396    13091    1   WRITE_FPT.BUF_.BUF$ = BUF$ ;

  13091  4 000037   200003 470500                    LDP0    @BUF$,,AUTO
         4 000040   000000 236100                    LDQ     0,,PR0
         4 000041   000267 756000 2                  STQ     WRITE_FPT+5

     1397    13092    1   WRITE_FPT.BUF_.BOUND = ARS - 1 ;

  13092  4 000042   200004 471500                    LDP1    @ARS,,AUTO
         4 000043   100000 236100                    LDQ     0,,PR1
         4 000044   000001 136007                    SBLQ    1,DL
         4 000045   000020 736000                    QLS     16
         4 000046   000266 676000 2                  ERQ     WRITE_FPT+4
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:274  
         4 000047   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000050   000266 656000 2                  ERSQ    WRITE_FPT+4

     1398    13093    1   WRITE_FPT.KEY_ = VECTOR( USERS_KEY ) ;

  13093  4 000051   000000 237000 5                  LDAQ    0
         4 000052   000264 757000 2                  STAQ    WRITE_FPT+2

     1399    13094    1   CALL M$WRITE (WRITE_FPT) ALTRET(IO_ERR) ;

  13094  4 000053   000262 630400 2                  EPPR0   WRITE_FPT
         4 000054   440001 713400                    CLIMB   alt,write
         4 000055   401400 401760                    pmme    nvectors=4
         4 000056   000216 702000 4                  TSX2    IO_ERR

     1400    13095    1   RETURN ;

  13095  4 000057   000000 702200 xent               TSX2  ! X66_ARET

     1401    13096
     1402    13097
     1403    13098    1   ASW$DELREC_WSN: ENTRY   ALTRET ;

  13098  4 000060   000000 700200 xent  ASW$DELREC_* TSX0  ! X66_AUTO_2
         4 000061   000010 000002                    ZERO    8,2

     1404    13099
     1405    13100    1   DELREC_FPT.KEY_ = VECTOR( USERS_KEY ) ;

  13100  4 000062   000000 237000 5                  LDAQ    0
         4 000063   000300 757000 2                  STAQ    DELREC_FPT+2

     1406    13101    1   CALL M$DELREC (DELREC_FPT) ALTRET(IO_ERR) ;

  13101  4 000064   000276 630400 2                  EPPR0   DELREC_FPT
         4 000065   440002 713400                    CLIMB   alt,+16386
         4 000066   401400 401760                    pmme    nvectors=4
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:275  
         4 000067   000216 702000 4                  TSX2    IO_ERR

     1407    13102    1   RETURN ;

  13102  4 000070   000000 702200 xent               TSX2  ! X66_ARET

     1408    13103
     1409    13104
     1410    13105    1   ASW$PREC_WSN: ENTRY  ALTRET ;

  13105  4 000071   000000 700200 xent  ASW$PREC_WSN TSX0  ! X66_AUTO_2
         4 000072   000010 000002                    ZERO    8,2

     1411    13106
     1412    13107    1   PREC_FPT.KEY_ = VECTOR( USERS_KEY ) ;

  13107  4 000073   000000 237000 5                  LDAQ    0
         4 000074   000312 757000 2                  STAQ    PREC_FPT+2

     1413    13108    1   CALL M$PRECORD (PREC_FPT) ALTRET(IO_ERR) ;

  13108  4 000075   000310 630400 2                  EPPR0   PREC_FPT
         4 000076   440003 713400                    CLIMB   alt,+16387
         4 000077   401000 401760                    pmme    nvectors=3
         4 000100   000216 702000 4                  TSX2    IO_ERR

     1414    13109    1   RETURN ;

  13109  4 000101   000000 702200 xent               TSX2  ! X66_ARET

     1415    13110
     1416    13111
     1417    13112    1   ASW$PREC_AND_SKIP_WSN: ENTRY  ALTRET ;

  13112  4 000102   000000 700200 xent  ASW$PREC_AN* TSX0  ! X66_AUTO_2
         4 000103   000010 000002                    ZERO    8,2

PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:276  
     1418    13113
     1419    13114    1   CALL M$PRECORD( PREC_AND_SKIP_FPT ) ALTRET( IO_ERR ) ;

  13114  4 000104   000344 630400 2                  EPPR0   PREC_AND_SKIP_FPT
         4 000105   440003 713400                    CLIMB   alt,+16387
         4 000106   401000 401760                    pmme    nvectors=3
         4 000107   000216 702000 4                  TSX2    IO_ERR

     1420    13115    1   RETURN ;

  13115  4 000110   000000 702200 xent               TSX2  ! X66_ARET

     1421    13116
     1422    13117    1   ASW$OPEN_WSN_CR: ENTRY ALTRET;

  13117  4 000111   000000 700200 xent  ASW$OPEN_WS* TSX0  ! X66_AUTO_2
         4 000112   000010 000002                    ZERO    8,2

     1423    13118
     1424    13119    1   CALL M$OPEN (OPEN_CR_FPT) ALTRET(IO_ERR) ;

  13119  4 000113   000000 630400 2                  EPPR0   OPEN_CR_FPT
         4 000114   450000 713400                    CLIMB   alt,open
         4 000115   410400 401760                    pmme    nvectors=18
         4 000116   000216 702000 4                  TSX2    IO_ERR

     1425    13120    1   RETURN ;

  13120  4 000117   000000 702200 xent               TSX2  ! X66_ARET

     1426    13121
     1427    13122
     1428    13123    1   ASW$OPEN_WSN_UP: ENTRY ALTRET;

  13123  4 000120   000000 700200 xent  ASW$OPEN_WS* TSX0  ! X66_AUTO_2
         4 000121   000010 000002                    ZERO    8,2

PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:277  
     1429    13124
     1430    13125    1   CALL M$OPEN (OPEN_UP_FPT) ALTRET(IO_ERR) ;

  13125  4 000122   000072 630400 2                  EPPR0   OPEN_UP_FPT
         4 000123   450000 713400                    CLIMB   alt,open
         4 000124   410400 401760                    pmme    nvectors=18
         4 000125   000216 702000 4                  TSX2    IO_ERR

     1431    13126    1   RETURN ;

  13126  4 000126   000000 702200 xent               TSX2  ! X66_ARET

     1432    13127
     1433    13128
     1434    13129    1   ASW$CLOSE_WSN: ENTRY ALTRET;

  13129  4 000127   000000 700200 xent  ASW$CLOSE_W* TSX0  ! X66_AUTO_2
         4 000130   000010 000002                    ZERO    8,2

     1435    13130
     1436    13131    1   CALL M$CLOSE (CLOSE_FPT) ;

  13131  4 000131   000164 630400 2                  EPPR0   CLOSE_FPT
         4 000132   050001 713400                    CLIMB   close
         4 000133   406000 401760                    pmme    nvectors=13

     1437    13132    1   RETURN ;

  13132  4 000134   000000 702200 xent               TSX2  ! X66_ARET

     1438    13133
     1439    13134
     1440    13135    1   ASW$READ_WSN_SEQ: ENTRY ( BUF$, ARS) ALTRET ;

  13135  4 000135   000000 700200 xent  ASW$READ_WS* TSX0  ! X66_AUTO_2
         4 000136   000010 000002                    ZERO    8,2

PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:278  
     1441    13136
     1442    13137    1   READ_SEQ_FPT.BUF_.BUF$ = BUF$ ;

  13137  4 000137   200003 470500                    LDP0    @BUF$,,AUTO
         4 000140   000000 236100                    LDQ     0,,PR0
         4 000141   000327 756000 2                  STQ     READ_SEQ_FPT+5

     1443    13138    1   READ_SEQ_FPT.BUF_.BOUND = ARS - 1 ;

  13138  4 000142   200004 471500                    LDP1    @ARS,,AUTO
         4 000143   100000 236100                    LDQ     0,,PR1
         4 000144   000001 136007                    SBLQ    1,DL
         4 000145   000020 736000                    QLS     16
         4 000146   000326 676000 2                  ERQ     READ_SEQ_FPT+4
         4 000147   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000150   000326 656000 2                  ERSQ    READ_SEQ_FPT+4

     1444    13139    1   READ_SEQ_FPT.KEY_ = VECTOR( USERS_KEY ) ;

  13139  4 000151   000000 237000 5                  LDAQ    0
         4 000152   000324 757000 2                  STAQ    READ_SEQ_FPT+2

     1445    13140    1   CALL M$READ(READ_SEQ_FPT) ALTRET (IO_ERR) ;

  13140  4 000153   000322 630400 2                  EPPR0   READ_SEQ_FPT
         4 000154   440000 713400                    CLIMB   alt,read
         4 000155   401400 401760                    pmme    nvectors=4
         4 000156   000216 702000 4                  TSX2    IO_ERR

     1446    13141    1   ARS = DCBADDR(DCBNUM(M$WSN)) -> F$DCB.ARS# ;

  13141  4 000157   000000 236007 xsym               LDQ     M$WSN,DL
         4 000160   000002 470400 5                  LDP0    2
         4 000161   000000 471500                    LDP1    0,,PR0
         4 000162   100000 473506                    LDP3    0,QL,PR1
         4 000163   300000 235100                    LDA     0,,PR3
         4 000164   200004 473500                    LDP3    @ARS,,AUTO
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:279  
         4 000165   300000 755100                    STA     0,,PR3

     1447    13142    1   RETURN ;

  13142  4 000166   000000 702200 xent               TSX2  ! X66_ARET

     1448    13143
     1449    13144
     1450    13145    1   ASW$BOF_WSN: ENTRY ALTRET;

  13145  4 000167   000000 700200 xent  ASW$BOF_WSN  TSX0  ! X66_AUTO_2
         4 000170   000010 000002                    ZERO    8,2

     1451    13146
     1452    13147    1   CALL M$PFIL(PFIL_FPT) ALTRET(IO_ERR) ;

  13147  4 000171   000340 630400 2                  EPPR0   PFIL_FPT
         4 000172   440004 713400                    CLIMB   alt,+16388
         4 000173   400000 401760                    pmme    nvectors=1
         4 000174   000216 702000 4                  TSX2    IO_ERR

     1453    13148    1   RETURN ;

  13148  4 000175   000000 702200 xent               TSX2  ! X66_ARET

     1454    13149
     1455    13150
     1456    13151    1   ASW$ENQ_WSN: ENTRY ALTRET ;

  13151  4 000176   000000 700200 xent  ASW$ENQ_WSN  TSX0  ! X66_AUTO_2
         4 000177   000010 000002                    ZERO    8,2

     1457    13152
     1458    13153    1   FPT_ENQ.RNAME_ = VECTOR( USERS_KEY ) ;

  13153  4 000200   000000 237000 5                  LDAQ    0
         4 000201   000224 757000 2                  STAQ    FPT_ENQ+2
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:280  

     1459    13154    1   CALL M$ENQ( FPT_ENQ ) ALTRET( IO_ERR ) ;

  13154  4 000202   000222 630400 2                  EPPR0   FPT_ENQ
         4 000203   420002 713400                    CLIMB   alt,+8194
         4 000204   401000 401760                    pmme    nvectors=3
         4 000205   000216 702000 4                  TSX2    IO_ERR

     1460    13155    1   RETURN ;

  13155  4 000206   000000 702200 xent               TSX2  ! X66_ARET

     1461    13156
     1462    13157
     1463    13158    1   ASW$DEQ_WSN: ENTRY ALTRET ;

  13158  4 000207   000000 700200 xent  ASW$DEQ_WSN  TSX0  ! X66_AUTO_2
         4 000210   000010 000002                    ZERO    8,2

     1464    13159
     1465    13160    1   CALL M$DEQ( FPT_DEQ ) ALTRET( IO_ERR ) ;

  13160  4 000211   000234 630400 2                  EPPR0   FPT_DEQ
         4 000212   420003 713400                    CLIMB   alt,+8195
         4 000213   401000 401760                    pmme    nvectors=3
         4 000214   000216 702000 4                  TSX2    IO_ERR

     1466    13161    1   RETURN ;

  13161  4 000215   000000 702200 xent               TSX2  ! X66_ARET

     1467    13162
     1468    13163    1   IO_ERR:
     1469    13164    1   ERR_CODE = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR ;

  13164  4 000216   000000 470400 xsym  IO_ERR       LDP0    B$TCB$
         4 000217   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:281  
         4 000220   100102 236100                    LDQ     66,,PR1
         4 000221   000000 756000 xsym               STQ     ERR_CODE

     1470    13165    1   AS_DCBNUM# = DCBNUM( M$WSN );

  13165  4 000222   000000 236007 xsym               LDQ     M$WSN,DL
         4 000223   000000 756000 xsym               STQ     AS_DCBNUM#

     1471    13166    1   ALTRETURN ;

  13166  4 000224   000000 702200 xent               TSX2  ! X66_AALT
     1472    13167
     1473    13168    1   END   ASW$WSN_IO ;

PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:282  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASW$WSN_IO.
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:283  

 **** Variables and constants ****

  ****  Section 002  Data  ASW$WSN_IO

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   164-0-0/d STRC(1080)  r     1 CLOSE_FPT                276-0-0/d STRC(360)   r     1 DELREC_FPT
   356-0-0/c STRC(45)    r     1 FILE_NAME                234-0-0/d STRC(288)   r     1 FPT_DEQ
   222-0-0/d STRC(360)   r     1 FPT_ENQ                    0-0-0/d STRC(2088)  r     1 OPEN_CR_FPT
    72-0-0/d STRC(2088)  r     1 OPEN_UP_FPT              340-0-0/d STRC(144)   r     1 PFIL_FPT
   344-0-0/d STRC(360)   r     1 PREC_AND_SKIP_FPT        310-0-0/d STRC(360)   r     1 PREC_FPT
   244-0-0/d STRC(504)   r     1 READ_FPT                 322-0-0/d STRC(504)   r     1 READ_SEQ_FPT
   360-0-0/w STRC(333)   r     1 VLP_ATTR                 372-0-0/w STRC(126)   r     1 VLP_ATTR_ACC
   262-0-0/d STRC(432)   r     1 WRITE_FPT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @ARS                       3-0-0/w PTR         r     1 @BUF$
    *0-0-0/w UBIN        r     1 ARS                       *0-0-0/w PTR         r     1 BUF$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 AS_DCBNUM#                 0-0-0/w PTR         r     1 B$TCB$
     0-0-0/b STRC        r     1 ERR_CODE                   0-0-0/c STRC(72)    r     1 FILE_ACCT
     0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:284  

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$WSN


   Procedure ASW$WSN_IO requires 149 words for executable code.
   Procedure ASW$WSN_IO requires 8 words of local(AUTO) storage.

    No errors detected in file ASB$FILES.:E05TSI    .
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:285  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:286  
          MINI XREF LISTING

ARS
     12316**DCL        26--PROC    13079--ENTRY   13082>>ASSIGN  13085<<ASSIGN  13089--ENTRY   13092>>ASSIGN
     13135--ENTRY   13138>>ASSIGN  13141<<ASSIGN
ASA_BRKS_LOC
      9427**DCL      9427--REDEF
AS_DCBNUM#
      9434**DCL     13165<<ASSIGN
AS_DEFAULT.BANNER_PERM
     10120**DCL     10121--REDEF
AS_DEFAULT.BUDGET.MACCT
     10025**DCL     10029--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     10038**DCL     10041--REDEF
AS_DEFAULT.BUDGET.PACCUM
     10021**DCL     10023--REDEF
AS_DEFAULT.BUDGET.PMAXC
     10016**DCL     10018--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     10136**DCL     10137--REDEF   10138--REDEF
AS_DEFAULT_DREC.PASSWORD
     11390**DCL     11394--REDEF
AS_DEFAULT_DREC.RENAME
     11413**DCL     11414--REDEF
AS_DFLT.BANNER_PERM
      9942**DCL      9943--REDEF
AS_DFLT.BUDGET.MACCT
      9847**DCL      9851--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
      9860**DCL      9863--REDEF
AS_DFLT.BUDGET.PACCUM
      9843**DCL      9845--REDEF
AS_DFLT.BUDGET.PMAXC
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:287  
      9838**DCL      9840--REDEF
AS_DFLT.SETUP_CHRA.TXT
      9958**DCL      9959--REDEF    9960--REDEF
AS_FE_MODE
      9293**DCL      9294--REDEF
AS_MODE
      9290**DCL      9292--REDEF
AS_MOD_USER.ACCESS
     12155**DCL     12156--REDEF
AS_MOD_USER.BANNER
     12142**DCL     12143--REDEF
AS_MOD_USER.BANNER_PERM
     12144**DCL     12145--REDEF
AS_MOD_USER.BILL
     12150**DCL     12151--REDEF
AS_MOD_USER.CPROC
     12146**DCL     12147--REDEF
AS_MOD_USER.FEBILL
     12226**DCL     12227--REDEF
AS_MOD_USER.FECXTMEM
     12243**DCL     12244--REDEF
AS_MOD_USER.FEMINTS
     12228**DCL     12229--REDEF
AS_MOD_USER.FEMMEM
     12239**DCL     12240--REDEF
AS_MOD_USER.FEMTIME
     12237**DCL     12238--REDEF
AS_MOD_USER.FEPPRIV
     12234**DCL     12236--REDEF
AS_MOD_USER.FEPRIV
     12231**DCL     12233--REDEF
AS_MOD_USER.FORCE_BIT
     12140**DCL     12141--REDEF
AS_MOD_USER.KEY
     12222**DCL     12224--REDEF
AS_MOD_USER.LASTCPROC
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:288  
     12148**DCL     12149--REDEF
AS_MOD_USER.LIMITS.DO_
     12196**DCL     12197--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     12212**DCL     12213--REDEF
AS_MOD_USER.LIMITS.LO
     12192**DCL     12193--REDEF
AS_MOD_USER.LIMITS.MEM
     12188**DCL     12189--REDEF
AS_MOD_USER.LIMITS.MPRIO
     12216**DCL     12217--REDEF
AS_MOD_USER.LIMITS.PDIS
     12204**DCL     12205--REDEF
AS_MOD_USER.LIMITS.PO
     12200**DCL     12201--REDEF
AS_MOD_USER.LIMITS.TDIS
     12208**DCL     12209--REDEF
AS_MOD_USER.LIMITS.TIME
     12184**DCL     12185--REDEF
AS_MOD_USER.MAXENQ
     12165**DCL     12166--REDEF
AS_MOD_USER.PERM_BIT
     12138**DCL     12139--REDEF
AS_MOD_USER.PPRIV
     12160**DCL     12162--REDEF
AS_MOD_USER.PRIOB
     12167**DCL     12168--REDEF
AS_MOD_USER.PRIV
     12157**DCL     12159--REDEF
AS_MOD_USER.QUAN
     12163**DCL     12164--REDEF
AS_MOD_USER.SETUP
     12136**DCL     12137--REDEF
AS_PROJECT.BANNER_PERM
     10476**DCL     10477--REDEF
AS_PROJECT.BUDGET.MACCT
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:289  
     10381**DCL     10385--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     10394**DCL     10397--REDEF
AS_PROJECT.BUDGET.PACCUM
     10377**DCL     10379--REDEF
AS_PROJECT.BUDGET.PMAXC
     10372**DCL     10374--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     10492**DCL     10493--REDEF   10494--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     10654**DCL     10655--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     10559**DCL     10563--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     10572**DCL     10575--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     10555**DCL     10557--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     10550**DCL     10552--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     10670**DCL     10671--REDEF   10672--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     11876**DCL     11880--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     11899**DCL     11900--REDEF
AS_PROJECT_DREC.PASSWORD
     11714**DCL     11718--REDEF
AS_PROJECT_DREC.RENAME
     11737**DCL     11738--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     10298**DCL     10299--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     10203**DCL     10207--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     10216**DCL     10219--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:290  
     10199**DCL     10201--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     10194**DCL     10196--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     10314**DCL     10315--REDEF   10316--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     11552**DCL     11556--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     11575**DCL     11576--REDEF
AS_USERS.BANNER_PERM
      9764**DCL      9765--REDEF
AS_USERS.BUDGET.MACCT
      9669**DCL      9673--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
      9682**DCL      9685--REDEF
AS_USERS.BUDGET.PACCUM
      9665**DCL      9667--REDEF
AS_USERS.BUDGET.PMAXC
      9660**DCL      9662--REDEF
AS_USERS.SETUP_CHRA.TXT
      9780**DCL      9781--REDEF    9782--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     10832**DCL     10833--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     10737**DCL     10741--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     10750**DCL     10753--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     10733**DCL     10735--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     10728**DCL     10730--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     10848**DCL     10849--REDEF   10850--REDEF
B$ALT.CODE
     12292**DCL     12292--REDEF   12293--REDEF   12293--REDEF
B$ALT.ERR
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:291  
     12293**DCL     13164>>ASSIGN
B$ALT.ERR.ERR#
     12294**DCL     12294--REDEF
B$ALT.EVID
     12293**DCL     12293--REDEF   12293--REDEF
B$TCB.ALT$
     12299**DCL     13164>>ASSIGN
B$TCB$
     12306**DCL     13164>>ASSIGN
BUF$
     12315**DCL        26--PROC    13079--ENTRY   13081>>ASSIGN  13089--ENTRY   13091>>ASSIGN  13135--ENTRY
     13137>>ASSIGN
CLOSE_FPT
     12586**DCL     13131<>CALL
CLOSE_FPT.SN_
     12586**DCL     12586--REDEF
CLOSE_FPT.UTL_
     12587**DCL     12587--REDEF
CLOSE_FPT.V
     12591**DCL     12586--DCLINIT
CLOSE_FPT.V.EXPIRE#
     12601**DCL     12601--REDEF
CLOSE_FPT.V.TYPE#
     12599**DCL     12599--REDEF
CLOSE_FPT.V.XTNSIZE#
     12596**DCL     12596--REDEF   12598--REDEF
DELREC_FPT
     12729**DCL     13101<>CALL
DELREC_FPT.KEY_
     12729**DCL     13100<<ASSIGN
DELREC_FPT.V
     12732**DCL     12729--DCLINIT
ERR_CODE
      9422**DCL      9423--REDEF   13164<<ASSIGN
F$DCB.ACTPOS
     13042**DCL     13042--REDEF
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:292  
F$DCB.ARS#
     13016**DCL     13016--REDEF   13085>>ASSIGN  13141>>ASSIGN
F$DCB.ATTR
     13035**DCL     13036--REDEF
F$DCB.BORROW
     13050**DCL     13050--REDEF   13050--REDEF   13050--REDEF
F$DCB.DCBNAME.L
     13064**DCL     13064--IMP-SIZ
F$DCB.EOMCHAR#
     13020**DCL     13020--REDEF
F$DCB.FLDID
     13045**DCL     13045--REDEF
F$DCB.FORM$
     13039**DCL     13039--REDEF
F$DCB.FSECT
     13055**DCL     13055--REDEF
F$DCB.FSN#
     13032**DCL     13032--REDEF   13032--REDEF   13033--REDEF
F$DCB.HEADER$
     13038**DCL     13038--REDEF
F$DCB.IXTNSIZE#
     13036**DCL     13036--REDEF
F$DCB.LASTSTA$
     13025**DCL     13025--REDEF
F$DCB.LVL
     13051**DCL     13051--REDEF
F$DCB.NAME#.C
     13026**DCL     13026--REDEF
F$DCB.NOEOF
     13048**DCL     13048--REDEF
F$DCB.NRECS#
     13037**DCL     13037--REDEF
F$DCB.NRECX
     13056**DCL     13056--REDEF
F$DCB.OHDR
     13048**DCL     13048--REDEF
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:293  
F$DCB.ORG#
     13031**DCL     13031--REDEF
F$DCB.PRECNO
     13054**DCL     13054--REDEF
F$DCB.RCSZ
     13060**DCL     13060--REDEF
F$DCB.RES#
     13027**DCL     13027--REDEF
F$DCB.SETX
     13039**DCL     13039--REDEF
F$DCB.TAB$
     13039**DCL     13039--REDEF
F$DCB.TDA
     13053**DCL     13054--REDEF
F$DCB.WSN#
     13027**DCL     13027--REDEF
FILE_ACCT
      9430**DCL     12405--DCLINIT 12522--DCLINIT
FILE_NAME
     12877**DCL     12401--DCLINIT 12518--DCLINIT
FPT_DEQ
     12637**DCL     13160<>CALL
FPT_DEQ.V
     12638**DCL     12637--DCLINIT
FPT_ENQ
     12618**DCL     13154<>CALL
FPT_ENQ.RNAME_
     12618**DCL     13153<<ASSIGN
FPT_ENQ.V
     12619**DCL     12618--DCLINIT
IO_ERR
     13164**LABEL   13084--CALLALT 13094--CALLALT 13101--CALLALT 13108--CALLALT 13114--CALLALT 13119--CALLALT
     13125--CALLALT 13140--CALLALT 13147--CALLALT 13154--CALLALT 13160--CALLALT
KL_DEFAULT.PASSWORD
     12038**DCL     12042--REDEF
KL_DEFAULT.RENAME
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:294  
     12061**DCL     12062--REDEF
KL_DFLT.PASSWORD
     11228**DCL     11232--REDEF
KL_DFLT.RENAME
     11251**DCL     11252--REDEF
KL_DREC.PASSWORD
     11066**DCL     11070--REDEF
KL_DREC.RENAME
     11089**DCL     11090--REDEF
KL_DREC_CNT.PASSWORD
     10953**DCL     10957--REDEF
KL_DREC_CNT.RENAME
     10976**DCL     10977--REDEF
M$CLOSE
        42**DCL-ENT 13131--CALL
M$DELREC
        44**DCL-ENT 13101--CALL
M$DEQ
       109**DCL-ENT 13160--CALL
M$ENQ
       108**DCL-ENT 13154--CALL
M$OPEN
        42**DCL-ENT 13119--CALL    13125--CALL
M$PFIL
        44**DCL-ENT 13147--CALL
M$PRECORD
        46**DCL-ENT 13108--CALL    13114--CALL
M$READ
        43**DCL-ENT 13084--CALL    13140--CALL
M$WRITE
        43**DCL-ENT 13094--CALL
M$WSN
     13071**DCL     13085--ASSIGN  13141--ASSIGN  13165>>ASSIGN
OPEN_CR_FPT
     12400**DCL     13119<>CALL
OPEN_CR_FPT.ACSVEH_
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:295  
     12402**DCL     12403--REDEF
OPEN_CR_FPT.ALTKEYS_
     12408**DCL     12409--REDEF   12409--REDEF
OPEN_CR_FPT.HDR_
     12407**DCL     12408--REDEF
OPEN_CR_FPT.TAB_
     12406**DCL     12407--REDEF
OPEN_CR_FPT.UHL_
     12400**DCL     12401--REDEF   12401--REDEF
OPEN_CR_FPT.V
     12409**DCL     12400--DCLINIT
OPEN_CR_FPT.V.FSN#
     12440**DCL     12440--REDEF   12440--REDEF
OPEN_CR_FPT.WSN_
     12406**DCL     12406--REDEF
OPEN_UP_FPT
     12517**DCL     13125<>CALL
OPEN_UP_FPT.ACSVEH_
     12519**DCL     12520--REDEF
OPEN_UP_FPT.ALTKEYS_
     12525**DCL     12526--REDEF   12526--REDEF
OPEN_UP_FPT.HDR_
     12524**DCL     12525--REDEF
OPEN_UP_FPT.TAB_
     12523**DCL     12524--REDEF
OPEN_UP_FPT.UHL_
     12517**DCL     12518--REDEF   12518--REDEF
OPEN_UP_FPT.V
     12526**DCL     12517--DCLINIT
OPEN_UP_FPT.V.FSN#
     12557**DCL     12557--REDEF   12557--REDEF
OPEN_UP_FPT.WSN_
     12523**DCL     12523--REDEF
PFIL_FPT
     12816**DCL     13147<>CALL
PFIL_FPT.V
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:296  
     12816**DCL     12816--DCLINIT
PREC_AND_SKIP_FPT
     12836**DCL     13114<>CALL
PREC_AND_SKIP_FPT.V
     12838**DCL     12836--DCLINIT
PREC_FPT
     12751**DCL     13108<>CALL
PREC_FPT.KEY_
     12751**DCL     13107<<ASSIGN
PREC_FPT.V
     12753**DCL     12751--DCLINIT
PROJ_KEY.TEXT
      9300**DCL      9300--REDEF
PROJ_KEY.TXT.PROJECT
      9300**DCL      9300--REDEF
READ_FPT
     12662**DCL     13084<>CALL
READ_FPT.BUF_.BOUND
     12664**DCL     13082<<ASSIGN
READ_FPT.BUF_.BUF$
     12665**DCL     13081<<ASSIGN
READ_FPT.KEY_
     12662**DCL     13083<<ASSIGN
READ_FPT.STATION_
     12665**DCL     12666--REDEF
READ_FPT.V
     12666**DCL     12662--DCLINIT
READ_FPT.V.DVBYTE.REREAD#
     12677**DCL     12677--REDEF
READ_FPT.V.INDX#
     12675**DCL     12675--REDEF
READ_SEQ_FPT
     12781**DCL     13140<>CALL
READ_SEQ_FPT.BUF_.BOUND
     12783**DCL     13138<<ASSIGN
READ_SEQ_FPT.BUF_.BUF$
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:297  
     12784**DCL     13137<<ASSIGN
READ_SEQ_FPT.KEY_
     12781**DCL     13139<<ASSIGN
READ_SEQ_FPT.STATION_
     12784**DCL     12785--REDEF
READ_SEQ_FPT.V
     12785**DCL     12781--DCLINIT
READ_SEQ_FPT.V.DVBYTE.REREAD#
     12796**DCL     12796--REDEF
READ_SEQ_FPT.V.INDX#
     12794**DCL     12794--REDEF
REMEM_VAR
      9426**DCL      9426--REDEF
REM_FCMD
      9426**DCL      9427--REDEF
USERS_KEY
      9297**DCL     12836--DCLINIT 12837--DCLINIT 13083--ASSIGN  13093--ASSIGN  13100--ASSIGN  13107--ASSIGN
     13139--ASSIGN  13153--ASSIGN
USERS_KEY.TEXT
      9297**DCL      9298--REDEF    9298--REDEF    9298--REDEF    9299--REDEF
VLP_ATTR
     12890**DCL     12403--DCLINIT
VLP_ATTR.Q
     12891**DCL     12890--DCLINIT
VLP_ATTR_ACC
     12981**DCL     12402--DCLINIT
VLP_ATTR_ACC.Q
     12982**DCL     12981--DCLINIT
WRITE_FPT
     12703**DCL     13094<>CALL
WRITE_FPT.BUF_.BOUND
     12703**DCL     13092<<ASSIGN
WRITE_FPT.BUF_.BUF$
     12705**DCL     13091<<ASSIGN
WRITE_FPT.KEY_
     12703**DCL     13093<<ASSIGN
PL6.E3A0      #006=ASW$WSN_IO File=ASB$FILES.:E05TSI                             TUE 07/29/97 09:20 Page:298  
WRITE_FPT.STATION_
     12705**DCL     12705--REDEF
WRITE_FPT.V
     12706**DCL     12703--DCLINIT
WRITE_FPT.V.DVBYTE.VFC#
     12712**DCL     12712--REDEF
