VERSION E05

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:1    
        1        1        /*M*  DDD$VREF - builds complete data descriptor  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*P*  NAME: DDD$VREF
       10       10              PURPOSE: Builds data descriptor for the display variable
       11       11                       at PQLIST$ in the X$PARSE output tree.
       12       12              DESCRIPTION: Operates on X$PARSE output tree (pointed
       13       13                       into by PQLIST$) to produce a possibly pointer
       14       14                       qualified, possibly subscripted display reference.
       15       15                       The result is a data descriptor in the form of a
       16       16                       set of descriptor items built at the location
       17       17                       pointed to by the global S_D.D$.  DDD$VREF
       18       18                       calls on DDD$PQLIST to build the string of pointer
       19       19                       qualifiers (if any), then, if the reference is
       20       20                       subscripted, it calls DDD$SUBREF to build the index
       21       21                       descriptor items.  If the reference is further modified
       22       22                       by a constant expression (I.E. +10), DDD$ADDREXP
       23       23                       is called to build a descriptor item for the expression
       24       24                       modifier.  The actual variable to be displayed is then
       25       25                       entered into the data descriptor and DDD$VREF returns.
       26       26                       If any semantic error is found while proccessing
       27       27                       the variable reference, the global variable S_D.ERROR
       28       28                       is set to the appropriate error code, and the ALTRETURN
       29       29                       is taken.
       30       30                                                               */
       31       31        DDD$VREF: PROC(PQLIST$) ALTRET;
       32       32                                                /* Params */
       33       33    1   DCL PQLIST$ PTR;
       34       34                                                /* Local temps */
       35       35    1   DCL TEMP$ PTR;
       36       36    1   DCL ROOT$ PTR;
       37       37    1   DCL SYM$ PTR;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:2    
       38       38    1   DCL SYM2$ PTR;
       39       39    1   DCL ENTRY$ PTR;
       40       40    1   DCL HIGH_ENTRY# UBIN;
       41       41    1   DCL NQFLAG BIT(1);
       42       42    1   DCL BASED_FLAG BIT(1) ALIGNED;
       43       43    1   DCL ARRAY_FLAG BIT(1);
       44       44    1   DCL RANGE_FLAG BIT(1) ALIGNED;
       45       45    1   DCL ADDREXP_FLAG BIT(1);
       46       46    1   DCL STATUS_EXISTS BIT(1) ALIGNED;
       47       47    1   DCL XQUAL BIT(1);
       48       48    1   DCL DIM_CNT SBIN;
       49       49    1   DCL DIMS UBIN;
       50       50    1   DCL TEMP1 SBIN;
       51       51    1   DCL 1 SITEM_VAL REDEF TEMP1,
       52       52    1         2 ID UBIN(9) UNAL,
       53       53    1         2 * BIT(15),
       54       54    1         2 FLAGS BIT(6) UNAL,
       55       55    1         2 FMT UBIN(6) UNAL;
       56       56    1   DCL 1 SDITEM_VAL REDEF TEMP1,
       57       57    1         2 TYPE UBIN(6) UNAL,
       58       58    1         2 ID UBIN(9) UNAL,
       59       59    1         2 DISP UBIN(9) UNAL,
       60       60    1         2 * BIT(12) UNAL;
       61       61    1   DCL ATYP REDEF TEMP1 SBIN;
       62       62    1   DCL TEMP2 SBIN;
       63       63    1   DCL DTYP REDEF TEMP2 SBIN;
       64       64    1   DCL TDTYP SBIN;
       65       65    1   DCL MULT(0:6) PTR;
       66       66    1   DCL ARRAYTYP UBIN;
       67       67    1   DCL I SBIN;
       68       68    1   DCL STRUCT UBIN;
       69       69    1   DCL ILB SBIN;
       70       70    1   DCL IUB SBIN;
       71       71    1   DCL LEVELDIMS UBIN;
       72       72    1   DCL IENTRY# SBIN;
       73       73    1   DCL T$ PTR;
       74       74    1   DCL IPTR$ PTR;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:3    
       75       75    1   DCL IENTRY$ PTR;
       76       76    1   DCL JENTRY$ PTR;
       77       77    1   DCL JENTRY# UBIN;
       78       78    1   DCL KENTRY# UBIN;
       79       79    1   DCL VALUE UBIN;
       80       80    1   DCL ADDRESS UBIN;
       81       81    1   DCL SEG UBIN;
       82       82    1   DCL DESC# UBIN;
       83       83    1   DCL NOT_IS BIT(1) ALIGNED;
       84       84    1   DCL TATYP UBIN;
       85       85    1   DCL TBITS BIT(36);
       86       86    1   DCL 1 TEXTC BASED,
       87       87    1         2 SZ UBIN(9) UNAL,
       88       88    1         2 TXT CHAR(TEXTC.SZ);
       89       89    1   DCL EXPR_IDX SBIN;
       90       90    1   DCL IMPLF4 BIT(1) ALIGNED;
       91       91    1   DCL NCHARS UBIN;
       92       92                                                /* Misc */
       93       93    1   DCL UBIN36 UBIN(36) BASED ALIGNED;
       94       94             %INCLUDE CP_6;
       95      175             %B$TCB;
       96      178             %INCLUDE B$SS;
       97      357    1   DCL B$TCB$ PTR SYMREF;
       98      358             %INCLUDE XU_MACRO_C;
       99     3464             %PARSE$OUT(NAME=O,SCRITCH=SCRATCH,STCLASS=BASED);
      100     3509             %INCLUDE XUH_MACRO_C;
      101     3593             %INCLUDE DD_SD_M;
      102     4929             %S_D;
      103     6247             %INCLUDE DD_ERR_C;
      104     6644             %INCLUDE DD_PSUBS_C;
      105     7119             %INCLUDE B$OBJECT_C;
      106    10549             %B$VREBL(STCLASS="BASED(ENTRY$)");
      107    10713             %B$VREBLC(STCLASS="BASED(ENTRY$)");
      108    10786             %B$VREBLCA(STCLASS="BASED(ENTRY$)");
      109    10874             %B$VREBLCSET(STCLASS="BASED(IENTRY$)");
      110    10917             %VREBLSUBS;
      111    10925             %VREBL_DATATYPES;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:4    
      112    11000             %B$SDEF(STCLASS="BASED(ENTRY$)");
      113    11054             %B$EDEF(STCLASS="BASED(ENTRY$)");
      114    11124             %B$LBNTRY0;
      115    11160             %COMPILERIDSUBS;
      116    11176             %INCLUDE DD$DITEM;
       12+   11279             %LIST;
       13+   11280    1        DCL SDD$ PTR;
       14+   11281    1        DCL ZITEM$ PTR;
       15+   11282    1        DCL SDD_L6$ PTR;
       16+   11283    1        DCL ZITEM_L6$ PTR;
      117    11857             %ZITEM;
      118    11929             %DITEM;
      119    12009             %MITEM;
      120    12057             %INCLUDE DD$BASED;
      121    13360             %DD$VENTRY;
      122    13365             %INCLUDE DD_DESC_R;
      123    13415    1   DCL 1 DUMPTR CONSTANT,
      124    13416    1         2 * UBIN(18) UNAL INIT(0),
      125    13417    1         2 * UBIN(9) UNAL INIT(0),
      126    13418    1         2 * UBIN(9) UNAL INIT(%PTR_ICODE), /* PTR_ICODE */
      127    13419    1         2 * UBIN(36) UNAL INIT(0);
      128    13420             %INCLUDE DD_DTYP_R;
      129    13431             %FMT;
      130    13434    1   DCL 1 DUMSIZE CONSTANT,
      131    13435    1         2 * UBIN(9) UNAL INIT(1),         /* Multiplier for constant size */
      132    13436    1         2 * UBIN(9) UNAL INIT(0),
      133    13437    1         2 * UBIN(9) UNAL INIT(%CONST_ACODE), /* CONST_ACODE */
      134    13438    1         2 * UBIN(9) UNAL INIT(%SIZE_ICODE), /* SIZE_ICODE */
      135    13439    1         2 * UBIN(36) UNAL INIT(36);
      136    13440    1   DCL 1 DUMSIZE_L6 CONSTANT,
      137    13441    1         2 * UBIN(9) UNAL INIT(1),         /* Multiplier for constant size */
      138    13442    1         2 * UBIN(9) UNAL INIT(0),
      139    13443    1         2 * UBIN(9) UNAL INIT(%CONST_ACODE), /* CONST_ACODE */
      140    13444    1         2 * UBIN(9) UNAL INIT(%SIZE_ICODE), /* SIZE_ICODE */
      141    13445    1         2 * UBIN(36) UNAL INIT(16);
      142    13446    1   DCL 1 DUMILBINDEX CONSTANT,             /* Implicit lower bound */
      143    13447    1         2 * UBIN(18) UNAL INIT(0),
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:5    
      144    13448    1         2 * UBIN(9) UNAL INIT(%CONST_ACODE), /* CONST_ACODE */
      145    13449    1         2 * UBIN(9) UNAL INIT(%LIDX_ICODE), /* LIDX_ICODE */
      146    13450    1         2 * UBIN(36) UNAL INIT(0);
      147    13451    1   DCL 1 DUMIUBINDEX CONSTANT,             /* Implicit upper bound */
      148    13452    1         2 * BIT(18) UNAL INIT('000000000001'B), /* LFLAG */
      149    13453    1         2 * UBIN(9) UNAL INIT(%CONST_ACODE), /* CONST_ACODE */
      150    13454    1         2 * UBIN(9) UNAL INIT(%UIDX_ICODE), /* UIDX_ICODE */
      151    13455    1         2 * UBIN(36) UNAL INIT(0);
      152    13456    1   DCL TYPESIZE_MULT(0:63) UBIN CONSTANT SYMDEF INIT(
      153    13457    1        0,                                 /* 0 */
      154    13458    1        1,                            /* 1      REAL BINARY FIXED SINGLE (SBIN) */
      155    13459    1        0,                                 /* 2 */
      156    13460    1        1,                                 /* 3      Real bin float single */
      157    13461    1        1,                                 /* 4      Real bin float double */
      158    13462    1        0*2,                               /* 5 - 6 */
      159    13463    1        1,                                 /* 7      Complex float single */
      160    13464    1        1,                                 /* 8      Complex float double */
      161    13465    1        1,                                 /* 9      Packed, leading ASCII */
      162    13466    1        0*3,                               /* 10 - 12 */
      163    13467    1        36,                                /* 13     POINTER */
      164    13468    1        0*3,                               /* 14 - 16 */
      165    13469    1        1,                                 /* 17     STRUCTURE */
      166    13470    1        0,                                 /* 18 */
      167    13471    1        1,                                 /* 19     BIT STRING */
      168    13472    1        0,                                 /* 20     VARYING BIT STRING */
      169    13473    1        9,                                 /* 21     CHAR STRING */
      170    13474    1        0,                                 /* 22     VARYING CHAR STRING */
      171    13475    1        0,                                 /* 23 */
      172    13476    1        1,                                 /* 24     UBIN */
      173    13477    1        1,                                 /* 25     Packed, trailing ASCII */
      174    13478    1        9,                                 /* 26     ADJ CHAR STRING */
      175    13479    1        1,                                 /* 27     ADJ STRUCTURE/BIT STRING */
      176    13480    1        36,                                /* 28     EPTR */
      177    13481    1        1,                                 /* 29 */
      178    13482    1        1,                                 /* 30 */
      179    13483    1        1,                                 /* 31     Packed, trailing EBCDIC */
      180    13484    1        0*3,                               /* 32 - 34 */
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:6    
      181    13485    1        1,                                 /* 35     FORTRAN logical */
      182    13486    1        0*4,                               /* 36 - 39 */
      183    13487    1        1,                                 /* 40     Packed, unsigned */
      184    13488    1        9,                                 /* 41     Unpacked, unsigned */
      185    13489    1        9,                                 /* 42     Unpacked, leading sign */
      186    13490    1        9,                                 /* 43     Unpacked, trailing sign */
      187    13491    1        9,                            /* 44     Unpacked, leading overpunched */
      188    13492    1        9,                            /* 45     Unpacked, trailing overpunched */
      189    13493    1        0,                                 /* 46 */
      190    13494    1        72,                                /* 47 */
      191    13495    1        72,                                /* 48 */
      192    13496    1        72,                                /* 49 DESCRIPTOR */
      193    13497    1        0*14);                             /* 50 - 63 */
      194    13498    1   DCL TYPESIZE_MULT_FEP(0:63) UBIN CONSTANT SYMDEF INIT(
      195    13499    1        0,                                 /* 0 */
      196    13500    1        1,                            /* 1      REAL BINARY FIXED SINGLE (SBIN) */
      197    13501    1        0,                                 /* 2 */
      198    13502    1        1,                                 /* 3      Real bin float single */
      199    13503    1        1,                                 /* 4      Real bin float double */
      200    13504    1        0*2,                               /* 5 - 6 */
      201    13505    1        1,                                 /* 7      Complex float single */
      202    13506    1        1,                                 /* 8      Complex float double */
      203    13507    1        1,                                 /* 9      Packed, leading ASCII */
      204    13508    1        0*3,                               /* 10 - 12 */
      205    13509    1        32,                                /* 13     POINTER */
      206    13510    1        0*3,                               /* 14 - 16 */
      207    13511    1        1,                                 /* 17     STRUCTURE */
      208    13512    1        0,                                 /* 18 */
      209    13513    1        1,                                 /* 19     BIT STRING */
      210    13514    1        0,                                 /* 20     VARYING BIT STRING */
      211    13515    1        8,                                 /* 21     CHAR STRING */
      212    13516    1        0,                                 /* 22     VARYING CHAR STRING */
      213    13517    1        0,                                 /* 23 */
      214    13518    1        1,                                 /* 24     UBIN */
      215    13519    1        1,                                 /* 25     Packed, trailing ASCII */
      216    13520    1        8,                                 /* 26     ADJ CHAR STRING */
      217    13521    1        1,                                 /* 27     ADJ STRUCTURE/BIT STRING */
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:7    
      218    13522    1        32,                                /* 28     EPTR */
      219    13523    1        1,                                 /* 29 */
      220    13524    1        1,                                 /* 30 */
      221    13525    1        1,                                 /* 31     Packed, trailing EBCDIC */
      222    13526    1        0*3,                               /* 32 - 34 */
      223    13527    1        1,                                 /* 35     FORTRAN logical */
      224    13528    1        0*4,                               /* 36 - 39 */
      225    13529    1        1,                                 /* 40     Packed, unsigned */
      226    13530    1        8,                                 /* 41     Unpacked, unsigned */
      227    13531    1        8,                                 /* 42     Unpacked, leading sign */
      228    13532    1        8,                                 /* 43     Unpacked, trailing sign */
      229    13533    1        8,                            /* 44     Unpacked, leading overpunched */
      230    13534    1        8,                            /* 45     Unpacked, trailing overpunched */
      231    13535    1        0,                                 /* 46 */
      232    13536    1        48,                                /* 47 - Vector */
      233    13537    1        64,                                /* 48 - Remember */
      234    13538    1        0*15);                             /* 49 - 63 */
      235    13539                                                /* External routines */
      236    13540    1   DCL DDD$PQLIST ENTRY(2) ALTRET;         /* Bld ptr qualification list */
      237    13541    1   DCL DDD$ADDREXP ENTRY(2) ALTRET;        /* Build address expression */
      238    13542    1   DCL DDD$SUBREF ENTRY(4) ALTRET;         /* Build subscript reference */
      239    13543    1   DCL DDD$SIMEXP ENTRY(3) ALTRET;         /* Build simple expression */
      240    13544    1   DCL DDD$MULT ENTRY(4) ALTRET;           /* Calculate index multipliers */
      241    13545    1   DCL DDK$GETMVAL ENTRY(5) ALTRET;
      242    13546    1   DCL DDS$SP_SRCH ENTRY(2) ALTRET;        /* Special symbol search */
      243    13547    1   DCL DDS$D_SRCH ENTRY(2) ALTRET;         /* Special desc/ptr search */
      244    13548    1   DCL DDS$SD_SRCH ENTRY(2) ALTRET;        /* SYMDEF search */
      245    13549    1   DCL DDS$ED_SRCH ENTRY(2) ALTRET;        /* ENTDEF search */
      246    13550    1   DCL DDS$V_SRCH ENTRY(3) ALTRET;         /* Variable search */
      247    13551    1   DCL DDS$UD_SRCH ENTRY(2) ALTRET;        /* User defined symbols */
      248    13552    1   DCL DDS$SET_Q2T ENTRY ALTRET;
      249    13553    1   DCL DDS$SET_X2Q ENTRY ALTRET;
      250    13554    1   DCL DDS$SET_T2Q ENTRY ALTRET;
      251    13555    1   DCL DDF$VREBL_# ENTRY(2) ALTRET;
      252    13556    1   DCL DDE$ERROR ENTRY;
      253    13557    1   DCL DFK$GETMVAL ENTRY(6) ALTRET;
      254    13558                                                /**/
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:8    
      255    13559    1        STATUS_EXISTS = '0'B;
      256    13560    1        SDD$ = S_D.D$;
      257    13561    1        S_D.DESC$ = SDD$;
      258    13562    1        ZITEM$ = S_D.DESC$;
      259    13563    1        CALL BUMPD$(SIZEW(ZITEM)) ALTRET(VERR);
      260    13564    1        ZITEM = '0'B;
      261    13565    1        ZITEM.DTYP = %SIM_DTYP;            /* SIM_DTYP */
      262    13566    1        ZITEM.FLAGS = %MDE_FLAGS;          /* MDE_FLAGS */
      263    13567    1        CALL DDD$PQLIST(PQLIST$,BASED_FLAG) ALTRET(VERR);
      264    13568                                      /* Set up pointer to beginning of text and size */
      265    13569    1        ZITEM.TEXTSTART$ = PINCRC(ADDR(S_D.INPUT), S_D.SAVE_TEXT_STPOS);
      266    13570    1        ZITEM.TEXTSZ = PQLIST$ -> O.CPOS - S_D.SAVE_TEXT_STPOS;
      267    13571    1        SDD$ = S_D.D$;
      268    13572    1        ROOT$ = PQLIST$ -> O.SUBLK$(PQLIST$ -> O.NSUBLKS -1);
      269    13573                                                /**/
      270    13574    1        IF ROOT$ -> O.CODE = 40   /* VAREXP_CODE */
      271    13575    2        THEN DO;                           /* Build variable reference */
      272    13576    2             ADDREXP_FLAG = '0'B;
      273    13577    2             ARRAY_FLAG = '0'B;
      274    13578    2             S_D.RANGE_CNT = 0;
      275    13579    2             DIM_CNT = 0;
      276    13580    2             IPTR$ = S_D.D$;               /* Remember this in case implied PTR */
      277    13581    2             IF ROOT$ -> O.NSUBLKS > 1
      278    13582    3             THEN DO;                      /* Process subref / addrexp */
      279    13583    3                  TEMP$ = ROOT$ -> O.SUBLK$(1);
      280    13584    3                  IF TEMP$ -> O.CODE = 44 /* SUBREF_CODE */
      281    13585    4                  THEN DO;                 /* Build subscript reference */
      282    13586    4                       ARRAY_FLAG = '1'B;
      283    13587    4                       CALL DDD$SUBREF(TEMP$, RANGE_FLAG, DIM_CNT, MULT)
      284    13588    4                         ALTRET(VERR);
      285    13589    4                       IF RANGE_FLAG
      286    13590    5                       THEN DO; /* Set up pointer to beginning of subscript and size */
      287    13591    6                            DO I = 0 TO TEMP$ -> O.NSUBLKS-1;
      288    13592    6                                 IF TEMP$ -> O.SUBLK$(I) -> O.NSUBLKS > 1
      289    13593    7                                 THEN DO;
      290    13594    7                                      ZITEM.SUBSTART$ = PINCRC(ADDR(S_D.INPUT), TEMP$
             13594                                               -> O.SUBLK$(I) -> O.CPOS);
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:9    
      291    13595    7                                      IF I < TEMP$ -> O.NSUBLKS - 1
      292    13596    7                                      THEN ZITEM.SUBSZ = (TEMP$ -> O.SUBLK$(I+1) -> O.
             13596                                               CPOS - TEMP$ -> O.SUBLK$(I) -> O.CPOS) -1;
      293    13597    7                                      ELSE ZITEM.SUBSZ = (TEMP$ -> O.CPOS - TEMP$ -> O.
             13597                                               SUBLK$(I) -> O.CPOS) ;
      294    13598    7                                    END;
      295    13599    6                               END;
      296    13600    5                          END;
      297    13601    5                       ELSE DO;
      298    13602    5                            ZITEM.SUBSTART$ = ADDR(NIL);
      299    13603    5                            ZITEM.SUBSZ = 0;
      300    13604    5                          END;
      301    13605    4                       SDD$ = S_D.D$;
      302    13606    4                     END;                  /* Build subscript reference */
      303    13607    3                  EXPR_IDX = 1 + BITBIN(ARRAY_FLAG);
      304    13608    3                  IF ROOT$ -> O.NSUBLKS > EXPR_IDX
      305    13609    4                  THEN DO;                 /* Build address expression modifier */
      306    13610    4                       CALL DDD$ADDREXP(ROOT$,EXPR_IDX) ALTRET(VERR);
      307    13611    4                       SDD$ = S_D.D$;
      308    13612    4                       ADDREXP_FLAG = '1'B;
      309    13613    4                       ZITEM.FLAGS.ADDREXP = '1'B;
      310    13614    4                     END;                  /* Build address expression modifier */
      311    13615    3                END;                       /* Process subref / addrexp */
      312    13616                                                /**/
      313    13617    2             TEMP$ = ROOT$ -> O.SUBLK$(0);
      314    13618    2             IF TEMP$ -> O.NSUBLKS = 1
      315    13619    2             THEN NQFLAG = '1'B;
      316    13620    2             ELSE NQFLAG = '0'B;
      317    13621    2             SYM2$ = TEMP$ -> O.SUBLK$(0); /* 1st sym or qtstring of list */
      318    13622    2             SYM$ = SYM2$ -> O.SUBLK$(0);  /* Actual textc */
      319    13623    2             IF NQFLAG
      320    13624    3             THEN DO;
      321    13625    3                  CALL DDS$UD_SRCH(SYM$,TEMP1) ALTRET(GOT_UDEF);
      322    13626    3                  IF (S_D.PATCH OR S_D.RUM)
      323    13627    4                  THEN DO;  /* Speed up patching, by searching for ENTDEFs first */
      324    13628    4                       CALL DDS$ED_SRCH(SYM$, ENTRY$) ALTRET(GOT_EDEF);
      325    13629    4                       CALL DDS$SD_SRCH (SYM$,ENTRY$) ALTRET (GOT_SDEF);
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:10   
      326    13630    4                     END;
      327    13631    3                  IF SYM2$ -> O.CODE ~= 15 /* QTSTRING_CODE */
      328    13632    4                  THEN DO;
      329    13633    4                       CALL DDS$D_SRCH(SYM$, SITEM_VAL)
      330    13634    4                         ALTRET(GOT_DESC);
      331    13635    4                       CALL DDS$SP_SRCH(SYM$, SITEM_VAL)
      332    13636    4                         ALTRET(GOT_SPEC);
      333    13637    4                     END;
      334    13638    3                END;
      335    13639    2             XQUAL = '0'B;
      336    13640    2             CALL DDS$V_SRCH(TEMP$,ENTRY$,ENTRY#) ALTRET(GOT_VAR);
      337    13641    2             HIGH_ENTRY# = ENTRY#.C;
      338    13642    2             IF S_D.XSCH.OK
      339    13643    3             THEN DO;
      340    13644    3                  CALL DDS$SET_Q2T;        /* REMEMBER Q'S */
      341    13645    3                  CALL DDS$SET_X2Q ALTRET( BADSCHEMA ); /* ESTABL. SPECIAL'S */
      342    13646    3                  XQUAL = '1'B;
      343    13647    3                  CALL DDS$V_SRCH(TEMP$, ENTRY$, ENTRY#) ALTRET(GOT_VAR);
      344    13648    3                  IF ENTRY#.C > HIGH_ENTRY#
      345    13649    3                  THEN HIGH_ENTRY# = ENTRY#.C;
      346    13650    3                  CALL DDS$SET_T2Q ALTRET( BADSCHEMA ); /* RESTORE Q'S */
      347    13651    3                END;
      348    13652    2             IF NQFLAG
      349    13653    3             THEN DO;
      350    13654    3                  CALL DDS$SD_SRCH(SYM$,ENTRY$) ALTRET(GOT_SDEF);
      351    13655    3                  CALL DDS$ED_SRCH(SYM$,ENTRY$) ALTRET(GOT_EDEF);
      352    13656    3                END;
      353    13657    2             ELSE SYM$ = TEMP$ -> O.SUBLK$(HIGH_ENTRY#) -> O.SUBLK$(0);
      354    13658                                                /* Not found, must be an error */
      355    13659    2             S_D.ERROR = 3;   /* E@SYM_NOTFOUND */
      356    13660    2             S_D.ERROR_SYM$ = SYM$;
      357    13661    2             ALTRETURN;
      358    13662    2           END;                            /* Build variable reference */
      359    13663                                                /**/
      360    13664    2        ELSE DO;                           /* Build simple expression item */
      361    13665    2             IF S_D.QUALIFIED
      362    13666    3             THEN DO;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:11   
      363    13667    3                  S_D.ERROR = 52; /* E@INVLDQUAL */
      364    13668    3                  ALTRETURN;
      365    13669    3                END;
      366    13670    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      367    13671    2             THEN DITEM = DUMSIZE;
      368    13672    2             ELSE DITEM = DUMSIZE_L6;
      369    13673    2             CALL DDD$SIMEXP(ROOT$, TEMP1, DITEM.FLAGS.OFLAG) ALTRET(VERR);
      370    13674    2             ZITEM.VALUE = TEMP1;
      371    13675    2             IF BASED_FLAG
      372    13676    2             THEN ZITEM.ADDR_TYPE = %BIGBASED_ACODE; /* BIGBASED_ACODE */
      373    13677    2             ELSE ZITEM.ADDR_TYPE = %BIGSTATIC_ACODE; /* BIGSTATIC_ACODE */
      374    13678    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      375    13679    2             THEN ZITEM.DATA_TYPE = %OCT_DATATYPE; /* OCT_DATATYPE */
      376    13680    2             ELSE ZITEM.DATA_TYPE = %X_DATATYPE; /* X_DATATYPE */
      377    13681    2           END;
      378    13682    1        GOTO DONE;
      379    13683                                                /*
      380    13684                                                Come here to build desc / ptr  entry
      381    13685                                                */
      382    13686    1   GOT_DESC:
      383    13687    1        ZITEM.ADDR_TYPE = %DESC_ACODE;     /* DESC_ACODE */
      384    13688    1        IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6 AND
      385    13689    1          SDITEM_VAL.TYPE = 3 AND
      386    13690    1          SDITEM_VAL.ID = 3
      387    13691    2        THEN DO;
      388    13692    2             S_D.ERROR = 41;         /* E@NODISP */
      389    13693    2             ALTRETURN;
      390    13694    2           END;
      391    13695    1        GOTO SPEC_DESC;
      392    13696                                                /*   Come here to build spec entry */
      393    13697    1   GOT_SPEC:
      394    13698    1        ZITEM.ADDR_TYPE = %SPEC_ACODE;     /* SPEC_ACODE */
      395    13699    1        IF ADDREXP_FLAG AND NOT
             13699                 /* Address expression and not $O, $I, $L, @, @@, #, ##, $NA */
      396    13700    1          (SITEM_VAL.ID = %O_RTN OR        /* O_RTN */
      397    13701    1          SITEM_VAL.ID = %I_RTN OR         /* I_RTN */
      398    13702    1          SITEM_VAL.ID = %L_RTN OR         /* L_RTN */
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:12   
      399    13703    1          SITEM_VAL.ID = %@_RTN OR         /* @_RTN */
      400    13704    1          SITEM_VAL.ID = %@@_RTN OR        /* @@_RTN */
      401    13705    1          SITEM_VAL.ID = %#_RTN OR         /* #_RTN */
      402    13706    1          SITEM_VAL.ID = %##_RTN OR        /* ##_RTN */
      403    13707    1          SITEM_VAL.ID = %N_RTN OR         /* N_RTN */
      404    13708    1          SITEM_VAL.ID = %NA_RTN)          /* NA_RTN */
      405    13709    2        THEN DO;
      406    13710    2             S_D.ERROR = 87;    /* E@EXPNOTVALID */
      407    13711    2             ALTRETURN;
      408    13712    2           END;
      409    13713    1   SPEC_DESC:
      410    13714    1        IF BASED_FLAG OR ARRAY_FLAG
      411    13715    2        THEN DO;
      412    13716    2             S_D.ERROR = 4;     /* E@INVLD_SPEC */
      413    13717    2             S_D.ERROR_SYM$ = SYM$;
      414    13718    2             ALTRETURN;
      415    13719    2           END;
      416    13720    1        ZITEM.VALUEB = SITEM_VAL;
      417    13721    1        ZITEM.FMT_SPEC = SITEM_VAL.FMT;
      418    13722    1        ZITEM.DTYP = %SPEC_DTYP;           /* SPEC_DTYP */
      419    13723    1        ZITEM.FLAGS = SITEM_VAL.FLAGS;
      420    13724    1        IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      421    13725    1        THEN DITEM = DUMSIZE;
      422    13726    2        ELSE DO;
      423    13727    2             DITEM = DUMSIZE_L6;
      424    13728    2             IF ZITEM.SP.VS.SZ ~= 0 AND ZITEM.ADDR_TYPE = %SPEC_ACODE
      425    13729    2             THEN DITEM.VALUE = ZITEM.SP.VS.SZ;
      426    13730    2           END;
      427    13731    1        GOTO DONE;
      428    13732                                                /*
      429    13733                                                 Come here to build user defined symbol
      430    13734                                                 */
      431    13735    1   GOT_UDEF:
      432    13736    1        IF ARRAY_FLAG
      433    13737    2        THEN DO;
      434    13738    2             S_D.ERROR = 6;      /* E@SUBSCRIPT */
      435    13739    2             S_D.ERROR_SYM$ = SYM$;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:13   
      436    13740    2             ALTRETURN;
      437    13741    2           END;
      438    13742    1        ZITEM.DATA_TYPE = %INST_DATATYPE;  /* INST_DATATYPE */
      439    13743    1        IF BASED_FLAG
      440    13744    1        THEN ZITEM.ADDR_TYPE = %BIGBASED_ACODE; /* BIGBASED_ACODE */
      441    13745    1        ELSE ZITEM.ADDR_TYPE = %BIGSTATIC_ACODE; /* BIGSTATIC_ACODE */
      442    13746    1        ZITEM.VALUE = TEMP1;
      443    13747    1        IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      444    13748    1        THEN DITEM = DUMSIZE;
      445    13749    1        ELSE DITEM = DUMSIZE_L6;
      446    13750    1        GOTO DONE;
      447    13751                                                /*
      448    13752                                                 Come here to build SYMDEF entry
      449    13753                                                 */
      450    13754    1   GOT_SDEF:
      451    13755    1        IF ARRAY_FLAG
      452    13756    2        THEN DO;
      453    13757    2             S_D.ERROR = 6;      /* E@SUBSCRIPT */
      454    13758    2             S_D.ERROR_SYM$ = SYM$;
      455    13759    2             ALTRETURN;
      456    13760    2           END;
      457    13761    1        IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      458    13762    1        THEN DITEM = DUMSIZE;
      459    13763    1        ELSE DITEM = DUMSIZE_L6;
      460    13764    1        IF B$SDEF.CONSTNT
      461    13765    2        THEN DO;
      462    13766    2             IF BASED_FLAG
      463    13767    3             THEN DO;
      464    13768    3                  S_D.ERROR = 5;      /* E@SDEF */
      465    13769    3                  S_D.ERROR_SYM$ = SYM$;
      466    13770    3                  ALTRETURN;
      467    13771    3                END;
      468    13772    3             ELSE DO;
      469    13773                                                /* Build implicit $DCB ptr to DCB */
      470    13774    3                  T$ = SDD$;
      471    13775    3                  CALL BUMPD$ ALTRET(VERR);
      472    13776    4                  DO WHILE(T$ >= IPTR$);
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:14   
      473    13777    4                       PINCRW(T$, SIZEW(DITEM)) -> UBIN36 = T$ -> UBIN36;
      474    13778    4                       T$ = PINCRW(T$, -1);
      475    13779    4                     END;                  /* DO WHILE (T$ >= SDD$) */
      476    13780    3                  SITEM_VAL = DESC.ITEM(%DCB_DESC);
      477    13781    3                  IPTR$ -> DITEM.VALUEB = SITEM_VAL;
      478    13782    3                  IPTR$ -> DITEM.SP.VD.DISP = B$SDEF.VALUE;
      479    13783    3                  IPTR$ -> DITEM.ADDR_TYPE = %DESC_ACODE; /* DESC_ACODE */
      480    13784    3                  IPTR$ -> DITEM.TYPE_CODE = %PTR_ICODE; /* PTR_ICODE */
      481    13785    3                  ZITEM.ADDR_TYPE = %BASED_ACODE; /* BASED_ACODE */
      482    13786    3                END;                       /* Build implicit $DCB pointer */
      483    13787    2           END;
      484    13788    1        ELSE IF BASED_FLAG
      485    13789    2             THEN DO;
      486    13790    2                  S_D.ERROR = 5;      /* E@SDEF */
      487    13791    2                  S_D.ERROR_SYM$ = SYM$;
      488    13792    2                  ALTRETURN;
      489    13793    2                END;
      490    13794    2             ELSE DO;                 /* Build normal SYMREF address reference */
      491    13795    2                  ZITEM.ADDR_TYPE = %STATIC_ACODE; /* STATIC_ACODE */
      492    13796    2                  ZITEM.ADDRESS.W = B$SDEF.AD.ISADDR;
      493    13797    2                END;
      494    13798    1        ZITEM.DATA_TYPE = %OCT_DATATYPE;   /* OCT_DATATYPE  */
      495    13799    1        GOTO DONE;
      496    13800                                                /*
      497    13801                                                 Come here to build ENTDEF entry
      498    13802                                                 */
      499    13803    1   GOT_EDEF:
      500    13804    1        IF ARRAY_FLAG
      501    13805    1          OR BASED_FLAG
      502    13806    2        THEN DO;
      503    13807    2             S_D.ERROR = 32;           /* E@EDEF */
      504    13808    2             S_D.ERROR_SYM$ = SYM$;
      505    13809    2             ALTRETURN;
      506    13810    2           END;
      507    13811    1        IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      508    13812    1        THEN DITEM = DUMSIZE;
      509    13813    1        ELSE DITEM = DUMSIZE_L6;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:15   
      510    13814    1        ZITEM.ADDR_TYPE = %STATIC_ACODE;   /* STATIC_ACODE */
      511    13815    1        ZITEM.ADDRESS.W = B$EDEF.ISADDR;
      512    13816    1        ZITEM.DATA_TYPE = %INST_DATATYPE;  /* INST_DATATYPE */
      513    13817    1        GOTO DONE;
      514    13818                                                /*
      515    13819                                                 Come here to build variable entry
      516    13820                                                 */
      517    13821    1   GOT_VAR:
      518    13822                                                /*
      519    13823                                                 Make various consistency checks
      520    13824                                                 */
      521    13825    1        DIMS = 0;
      522    13826    1        LEVELDIMS = 0;
      523    13827    1        IMPLF4 = '0'B;
      524    13828    2        DO I = 1 TO ENTRY#.C;
      525    13829    2             STRUCT = ENTRY#.C - I +1;
      526    13830    2             IF ENTRY#.C ~= 1
      527    13831    2             THEN CALL DDF$VREBL_#(ENTRY#.E(STRUCT), ENTRY$) ALTRET(BADSCHEMA);
      528    13832    2             ARRAYTYP = B$VREBL.ARRAYTYP;
      529    13833    3             DO CASE( ARRAYTYP );
      530    13834    3               CASE( %SCALAR_ARRAY );
      531    13835                                                /* Do nothing */
      532    13836    3               CASE( %VECTOR0_ARRAY, %VECTOR1_ARRAY );
      533    13837    3                  DIMS = DIMS + 1;
      534    13838    3                  LEVELDIMS = LEVELDIMS + 1;
      535    13839    3                  IUB = B$VREBL.DIMS + ARRAYTYP - 2;
      536    13840    3                  ILB = ARRAYTYP -1;
      537    13841    3               CASE( %REAL_ARRAY, %VIRTUAL_ARRAY, %ADJUSTABLE_ARRAY );
      538    13842    3                  DIMS = DIMS + B$VREBL.DIMS ;
      539    13843    3                  LEVELDIMS = LEVELDIMS + 1;
      540    13844    3                  IF DIMS = 1
      541    13845    4                  THEN DO;
      542    13846    4                       IF ARRAYTYP = %ADJUSTABLE_ARRAY
      543    13847    5                       THEN DO;
      544    13848    5                            IF PINCRW(ENTRY$, SIZEW(B$VREBL)) -> B$VREBLCA.IOFFSET
      545    13849    6                            THEN DO;
      546    13850    6                                 JENTRY# = PINCRW(ENTRY$, SIZEW(B$VREBL)) -> B$VREBLCA.
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:16   
             13850                                          OFF_V#;
      547    13851    6                                 CALL DDF$VREBL_# (JENTRY#, JENTRY$) ALTRET(BADSCHEMA);
      548    13852    6                                 CALL GETVAL ALTRET(TRAP_ADJ_DIM);
      549    13853    6                                 ILB = VALUE;
      550    13854    6                                 CALL DDF$VREBL_# (ENTRY#.E(STRUCT), ENTRY$) ALTRET(
             13854                                          BADSCHEMA);
      551    13855    6                               END;
      552    13856    5                            ELSE ILB = PINCRW(ENTRY$, SIZEW(B$VREBL)) -> B$VREBLCA.
             13856                                     OFFSET;
      553    13857    5                            IF PINCRW(ENTRY$, SIZEW(B$VREBL)) -> B$VREBLCA.IELEMENTS
      554    13858    6                            THEN DO;
      555    13859    6                                 KENTRY# = PINCRW(ENTRY$, SIZEW(B$VREBL)) -> B$VREBLCA.
             13859                                          ELEM_V#;
      556    13860    6                                 CALL DDF$VREBL_# (KENTRY#, JENTRY$) ALTRET(BADSCHEMA);
      557    13861    6                                 CALL GETVAL ALTRET(TRAP_ADJ_DIM);
      558    13862    6                                 IUB = VALUE + ILB - 1;
      559    13863    6                                 CALL DDF$VREBL_# (ENTRY#.E(STRUCT), ENTRY$) ALTRET(
             13863                                          BADSCHEMA);
      560    13864    6                               END;
      561    13865    5                            ELSE IUB = PINCRW(ENTRY$, SIZEW(B$VREBL)) -> B$VREBLCA.
             13865                                     ELEMENTS + ILB - 1;
      562    13866    5                          END;
      563    13867    5                       ELSE DO;
      564    13868    5                            ILB = PINCRW(ENTRY$, SIZEW(B$VREBL)) -> B$VREBLC.OFFSET;
      565    13869    5                            IUB = PINCRW(ENTRY$, SIZEW(B$VREBL)) -> B$VREBLC.ELEMENTS +
             13869                                     ILB - 1;
      566    13870    5                          END;
      567    13871    4                     END;
      568    13872    3                  ELSE IF S_D.LB0$ -> B$LBNTRY0.COMPILER = %FORTRANID
      569    13873    4                       THEN DO;
      570    13874    4                            IMPLF4 = '1'B;
      571    13875    4                            ILB = 1;
      572    13876    4                            IF ARRAYTYP = %ADJUSTABLE_ARRAY
      573    13877    5                            THEN DO;
      574    13878    5                                 IF PINCRW(ENTRY$, SIZEW(B$VREBL)) -> B$VREBLCA.
             13878                                          IELEMENTS
      575    13879    6                                 THEN DO;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:17   
      576    13880    6                                      JENTRY# = PINCRW(ENTRY$, SIZEW(B$VREBL)) ->
             13880                                               B$VREBLCA.ELEM_V#;
      577    13881    6                                      CALL DDF$VREBL_# (JENTRY#, JENTRY$) ALTRET(
             13881                                               BADSCHEMA);
      578    13882    6                                      CALL GETVAL ALTRET(TRAP_ADJ_DIM);
      579    13883    6                                      IUB = VALUE;
      580    13884    6                                      CALL DDF$VREBL_# (ENTRY#.E(STRUCT), ENTRY$)
             13884                                               ALTRET(BADSCHEMA);
      581    13885    6                                    END;
      582    13886    5                                 ELSE IUB = PINCRW(ENTRY$, SIZEW(B$VREBL)) -> B$VREBLCA
             13886                                          .ELEMENTS;
      583    13887    5                               END;
      584    13888    4                            ELSE IUB = PINCRW(ENTRY$, SIZEW(B$VREBL)) -> B$VREBLC.
             13888                                     ELEMENTS;
      585    13889    4                          END;
      586    13890    4                       ELSE DO;
      587    13891    4                            ILB = 0;
      588    13892    4                            IUB = PINCRW(ENTRY$, SIZEW(B$VREBL)) -> B$VREBLC.ELEMENTS -
             13892                                     1;
      589    13893    4                          END;
      590    13894    3               CASE( ELSE );
      591    13895    3                  ZITEM.FLAGS.MDSE.D = '0'B;
      592    13896    3                  ZITEM.DTYP = 1;          /* This won't allow LET of adjustable
      593    13897                                                   dimension arrays work, when LET of
      594    13898                                                   arrays is allowed this won't work
      595    13899                                                   anymore */
      596    13900    3               END;                        /* DO CASE( ARRAYTYP ) */
      597    13901    2           END;                            /* DO I = 1 TO ENTRY#.C */
      598    13902    1        IF ENTRY#.C > 1
      599    13903    1        THEN CALL DDF$VREBL_#(ENTRY#.E(ENTRY#.C), ENTRY$) ALTRET(BADSCHEMA);
      600    13904    1        IF DIM_CNT ~= DIMS
      601    13905    1        THEN IF DIM_CNT > 0 OR LEVELDIMS > 1
      602    13906    2             THEN DO;
      603    13907    2                  S_D.ERROR_HICHAR = DIMS;
      604    13908    2                  S_D.ERROR = 188; /* E@WRONG#SUBS */
      605    13909    2                  S_D.ERROR_SYM$ = SYM$;
      606    13910    2                  ALTRETURN;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:18   
      607    13911    2                END;
      608    13912    2             ELSE DO;
      609    13913    2                  S_D.RANGE_CNT = 1;
      610    13914    2                  DITEM = DUMILBINDEX;
      611    13915    2                  DITEM.VALUE = ILB;
      612    13916    2                  CALL BUMPD$ ALTRET(VERR);
      613    13917    2                  MULT(0) = SDD$;
      614    13918    2                  MULT(0) -> MITEM = '0'B;
      615    13919    2                  ARRAY_FLAG = '1'B;
      616    13920    2                  CALL BUMPD$(SIZEW(MITEM)) ALTRET(VERR);
      617    13921    2                  DIM_CNT = 1;
      618    13922    2                  DITEM = DUMIUBINDEX;
      619    13923    2                  DITEM.VALUE = IUB;
      620    13924    2                  CALL BUMPD$ ALTRET(VERR);
      621    13925    2                END;
      622    13926    1        ELSE IMPLF4 = '0'B;
      623    13927    1        STATUS_EXISTS = B$VREBL.STATUS_EXISTS;
      624    13928    1        ATYP = B$VREBL.ADDRTYP - 1;
      625    13929    1        IF BASED_FLAG AND NOT (ATYP = %BASED_ACODE OR ATYP = %DCB_ACODE OR ATYP = %
             13929                 PARM_ACODE OR
      626    13930    1          ATYP = %SPARM_ACODE OR ATYP = %AREADEF_ACODE)
      627    13931         /* BASED_ACODE OR DCB_ACODE OR PARM_ACODE OR SPARM_ACODE OR AREADEF_ACODE */
      628    13932    2        THEN DO;
      629    13933    2             S_D.ERROR = 9;        /* E@VAR_REF */
      630    13934    2             S_D.ERROR_SYM$ = SYM$;
      631    13935    2             ALTRETURN;
      632    13936    2           END;
      633    13937    1        IF NOT BASED_FLAG AND (ATYP = %BASED_ACODE OR ATYP = %DCB_ACODE OR ATYP = %
             13937                 PARM_ACODE OR
      634    13938    1          ATYP = %SPARM_ACODE OR ATYP = %AREADEF_ACODE)
      635    13939         /* BASED_ACODE OR DCB_ACODE OR PARM_ACODE OR SPARM_ACODE OR AREADEF_ACODE */
      636    13940    2        THEN DO;
      637    13941    2             IENTRY# = B$VREBL.IMPTR;
      638    13942    2             IF ATYP = %BASED_ACODE  /* BASED_ACODE */ AND IENTRY# < 0
      639    13943    3             THEN DO;
      640    13944    3                  S_D.ERROR = 99;     /* E@NOPTR */
      641    13945    3                  S_D.ERROR_SYM$ = SYM$;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:19   
      642    13946    3                  ALTRETURN;
      643    13947    3                END;
      644    13948    2             T$ = SDD$;
      645    13949    2             CALL BUMPD$ ALTRET(VERR);
      646    13950    3             DO WHILE( T$ >= IPTR$ );
      647    13951    3                  PINCRW(T$,SIZEW(DITEM)) -> UBIN36 = T$ -> UBIN36;
      648    13952    3                  T$ = PINCRW(T$, -1);
      649    13953    3                END;                       /* DO WHILE (T$ >= IPTR$ ) */
      650    13954    3             DO I = 0 TO DIM_CNT - 1;
      651    13955    3                  MULT( I ) = PINCRW(MULT( I ), SIZEW(DITEM));
      652    13956    3                END;
      653    13957    2             IF ATYP = %BASED_ACODE        /* BASED_ACODE */
      654    13958    3             THEN DO;                      /* Based variable */
      655    13959    3                  IPTR$ -> DITEM = DUMPTR;
      656    13960    3                  CALL DDF$VREBL_#(IENTRY#, IENTRY$) ALTRET(BADSCHEMA);
      657    13961    4                  DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);
      658    13962    4                    CASE (%HOST);
      659    13963    4                       IPTR$ -> DITEM.ADDRESS.W = IENTRY$ -> B$VREBL.ADR.W;
      660    13964    4                       IPTR$ -> DITEM.ADDRESS.C = IENTRY$ -> B$VREBL.ADR.C;
      661    13965    4                       IPTR$ -> DITEM.ADDRESS.B = IENTRY$ -> B$VREBL.ADR.B;
      662    13966    4                    CASE (%L6);
      663    13967    4                       IPTR$ -> DITEM.ADDRESS.W = IENTRY$ -> B$VREBL.ADR6.W;
      664    13968    4                       IPTR$ -> DITEM.ADDRESS.C = IENTRY$ -> B$VREBL.ADR6.C;
      665    13969    4                       IPTR$ -> DITEM.ADDRESS.B = IENTRY$ -> B$VREBL.ADR6.B;
      666    13970    4                    CASE (ELSE);
      667    13971    4                       S_D.ERROR = 502; /* E@DELBUG  */
      668    13972    4                       ALTRETURN;
      669    13973    4                    END;
      670    13974    3                  TATYP = IENTRY$ -> B$VREBL.ADDRTYP - 1;
      671    13975    3                  IF TATYP = %PARM_ACODE OR TATYP = %SPARM_ACODE OR TATYP = %
             13975                           AREADEF_ACODE /* PARM_ACODE OR SPARM_ACODE OR AREADEF_ACODE*/
      672    13976    4                  THEN DO;       /* Implicit pointer is a parameter or areadef */
      673    13977    4                       IPTR$ -> DITEM.ADDR_TYPE = %PARM_ACODE; /* PARM_ACODE */
      674    13978    4                       T$ = SDD$;
      675    13979    4                       CALL BUMPD$ ALTRET(VERR);
      676    13980    5                       DO WHILE (T$ >= IPTR$ );
      677    13981    5                            PINCRW(T$, SIZEW(DITEM)) -> UBIN36 = T$ -> UBIN36;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:20   
      678    13982    5                            T$ = PINCRW(T$, -1);
      679    13983    5                          END;             /* DO WHILE (T$ >= IPTR$) */
      680    13984    5                       DO I = 0 TO DIM_CNT - 1;
      681    13985    5                            MULT(I) = PINCRW(MULT(I), SIZEW(DITEM));
      682    13986    5                          END;
      683    13987    4                       IF TATYP = %PARM_ACODE /* PARM_ACODE */
      684    13988    5                       THEN DO;            /* Auto parameter */
      685    13989    5                            IPTR$ -> DITEM.VALUEB = DESC.ITEM(%PARM_DESC);
             13989                                     /* PARM_DESC */
      686    13990    5                            IPTR$ -> DITEM.ADDR_TYPE = %DESC_ACODE; /* DESC_ACODE */
      687    13991    5                            IPTR$ -> DITEM.SP.VP.N = IENTRY$ -> B$VREBL.IMPTR - 2;
      688    13992    5                            ZITEM.FLAGS.MDSE.S = '1'B;
      689    13993    5                          END;             /* Auto parameter */
      690    13994    4                       ELSE IF TATYP = %SPARM_ACODE
             13994                                /* SPARM_ACODE - Static parameter */
      691    13995    5                            THEN DO;
      692    13996    5                                 IPTR$ -> DITEM.ADDRESS.W = IENTRY$ -> B$VREBL.IMPTR;
      693    13997    5                                 IPTR$ -> DITEM.ADDR_TYPE = %SPARM_ACODE;
             13997                                          /* SPARM_ACODE */
      694    13998    5                               END;        /* Static parameter */
      695    13999    5                            ELSE DO;       /* TATYP = AREADEF_ACODE */
      696    14000    5                                 IPTR$ -> DITEM.ADDR_TYPE = %CONST_ACODE;
             14000                                          /* CONST_ACODE */
      697    14001    5                                 IPTR$ -> DITEM.VALUE = PINCRW(IENTRY$, POFFW(ADDR(
             14001                                          B$VREBL.IMPTR), ADDR(B$VREBL))) -> UBIN36;
      698    14002    5                               END;
      699    14003    4                     END;        /* Implicit pointer is a parameter or areadef */
      700    14004    3                  ELSE IPTR$ -> DITEM.ADDR_TYPE = TATYP;
      701    14005    3                  CALL DDF$VREBL_#(ENTRY#.E(ENTRY#.C), ENTRY$) ALTRET(BADSCHEMA);
             14005                           /* RE-ESTAB. VAR */
      702    14006    3                END;                       /* Based variable */
      703    14007    2             ELSE IF ATYP = %PARM_ACODE    /* PARM_ACODE - auto parameter */
      704    14008    3                  THEN DO;
      705    14009    3                       IPTR$ -> DITEM = DUMPTR;
      706    14010    3                       IPTR$ -> DITEM.VALUEB = DESC.ITEM(%PARM_DESC); /* PARM_DESC */
      707    14011    3                       IPTR$ -> DITEM.ADDR_TYPE = %DESC_ACODE; /* DESC_ACODE */
      708    14012    3                       IPTR$ -> DITEM.SP.VP.N = IENTRY# - 2;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:21   
      709    14013    3                       ZITEM.FLAGS.MDSE.S = '1'B;
      710    14014    3                     END;                  /* Parameter */
      711    14015    2                  ELSE IF ATYP = %SPARM_ACODE /* SPARM_ACODE - static parameter */
      712    14016    3                       THEN DO;
      713    14017    3                            IPTR$ -> DITEM = DUMPTR;
      714    14018    3                            IPTR$ -> DITEM.ADDRESS.W = IENTRY#;
      715    14019    3                            IPTR$ -> DITEM.ADDR_TYPE = %SPARM_ACODE; /* SPARM_ACODE */
      716    14020    3                          END;             /* Static parameter */
      717    14021    2                       ELSE IF ATYP = %DCB_ACODE /* DCB_ACODE */
      718    14022    3                            THEN DO;
      719    14023    3                                 IPTR$ -> DITEM = DUMPTR;
      720    14024    3                                 IPTR$ -> DITEM.VALUEB = DESC.ITEM(%DCB_DESC);
             14024                                          /* DCB_DESC */
      721    14025    3                                 IPTR$ -> DITEM.ADDR_TYPE = %DESC_ACODE;
             14025                                          /* DESC_ACODE */
      722    14026    3                                 IPTR$ -> DITEM.SP.VD.DISP = IENTRY#;
      723    14027    3                               END;        /* ATYP = 3 (DCB) */
      724    14028    3                            ELSE DO;       /* ATYP = AREADEF_ACODE */
      725    14029    3                                 IPTR$ -> DITEM = DUMPTR;
      726    14030    3                                 IPTR$ -> DITEM.ADDR_TYPE = %CONST_ACODE;
             14030                                          /* CONST_ACODE */
      727    14031    3                                 IPTR$ -> DITEM.VALUE = PINCRW(ENTRY$, POFFW(ADDR(
             14031                                          B$VREBL.IMPTR), ADDR(B$VREBL))) -> UBIN36;
      728    14032    3                               END;        /* ATYP = AREADEF_ACODE */
      729    14033    2             ATYP = %BASED_ACODE;          /* BASED_ACODE */
      730    14034    2           END;
             14034         /* NOT BASED_FLAG AND (ATYP = 2 OR ATYP = 3 OR ATYP = 4 OR ATYP = 6 OR ATYP = 7) */
      731    14035    1        IF BASED_FLAG
      732    14036    1        THEN ATYP = %BASED_ACODE;          /* BASED_ACODE */
      733    14037    1        IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      734    14038    1        THEN DITEM = DUMSIZE;
      735    14039    1        ELSE DITEM = DUMSIZE_L6;
      736    14040    1        IF ARRAY_FLAG
      737    14041    2        THEN DO;
      738    14042    2             CALL DDD$MULT(DIM_CNT, MULT, ENTRY$, ENTRY#) ALTRET(VERR);
      739    14043    2             ZITEM.DTYP = S_D.RANGE_CNT;
      740    14044    2           END;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:22   
      741    14045    1        IF NOT B$VREBL.SZTYP
      742    14046    1          AND B$VREBL.LOGSIZ = 0
      743    14047    1        THEN ZITEM.FLAGS.MDSE.D = '0'B;
      744    14048    1        DTYP = B$VREBL.DATATYP;
      745    14049    1        IF NOT B$VREBL.SZTYP
      746    14050    2        THEN DO;
      747    14051    2             IF DTYP = %INDEX1_DATATYPE OR /* %INDEX1_DATATYPE */
      748    14052    2               DTYP = %INDEX2_DATATYPE     /* %INDEX2_DATATYPE */
      749    14053    2             THEN DITEM.VALUE = 18;
      750    14054    3             ELSE DO;
      751    14055    3                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      752    14056    3                  THEN DITEM.VALUE = B$VREBL.LOGSIZ * TYPESIZE_MULT(DTYP);
      753    14057    3                  ELSE DITEM.VALUE = B$VREBL.LOGSIZ * TYPESIZE_MULT_FEP(DTYP);
      754    14058    3                  IF B$VREBL.ADDRTYP = 4   /* It's a DCB */
      755    14059    3                    AND B$VREBL.LEVEL = 1  /* and this is level one entry */
      756    14060    3                    AND B$VREBL.LOGSIZ = 1 /* and schema says its one bit */
      757    14061    3                  THEN DITEM.VALUE = 36;   /* Then don't believe it !! */
      758    14062    3                END;
      759    14063    2           END;
      760    14064    2        ELSE DO;                           /* Adjustable size item */
      761    14065    2             IENTRY# = B$VREBL.LOGSIZ;
      762    14066    2             CALL DDF$VREBL_#(IENTRY#, IENTRY$) ALTRET(BADSCHEMA);
      763    14067    2             TATYP = IENTRY$ -> B$VREBL.ADDRTYP - 1;
      764    14068    2             DITEM.ADDR_TYPE = TATYP;      /* Set up DITEM for size of item */
      765    14069    3             DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);
      766    14070    3               CASE (%HOST);
      767    14071    3                  DITEM.ADDRESS.W = IENTRY$ -> B$VREBL.ADR.W;
      768    14072    3                  DITEM.ADDRESS.C = IENTRY$ -> B$VREBL.ADR.C;
      769    14073    3                  DITEM.ADDRESS.B = IENTRY$ -> B$VREBL.ADR.B;
      770    14074    3               CASE (%L6);
      771    14075    3                  DITEM.ADDRESS.W = IENTRY$ -> B$VREBL.ADR6.W;
      772    14076    3                  DITEM.ADDRESS.C = IENTRY$ -> B$VREBL.ADR6.C;
      773    14077    3                  DITEM.ADDRESS.B = IENTRY$ -> B$VREBL.ADR6.B;
      774    14078    3               CASE (ELSE);
      775    14079    3                  S_D.ERROR = 502;    /* E@DELBUG */
      776    14080    3                  ALTRETURN;
      777    14081    3               END;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:23   
      778    14082    2             TDTYP = IENTRY$ -> B$VREBL.DATATYP;
      779    14083    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      780    14084    3             THEN DO;
      781    14085    3                  DITEM.SMULT = TYPESIZE_MULT(DTYP);
      782    14086    3                  DITEM.PUP.SIZE = IENTRY$ -> B$VREBL.LOGSIZ * TYPESIZE_MULT(TDTYP);
      783    14087    3                END;
      784    14088    3             ELSE DO;
      785    14089    3                  DITEM.SMULT = TYPESIZE_MULT_FEP(DTYP);
      786    14090    3                  DITEM.PUP.SIZE = IENTRY$ -> B$VREBL.LOGSIZ * TYPESIZE_MULT_FEP(TDTYP)
             14090                           ;
      787    14091    3                END;
      788    14092    2             IF FMT(TDTYP) = %PUP_FMT      /* PUP_FMT */
      789    14093    3             THEN DO;
      790    14094    3                  S_D.ERROR = 502;    /* E@DELBUG */
      791    14095    3                  CALL DDE$ERROR;
      792    14096    3                  ALTRETURN;
      793    14097    3                END;
      794    14098    2             IF TATYP = %BASED_ACODE OR TATYP = %DCB_ACODE OR TATYP = %PARM_ACODE OR
             14098                      TATYP = %SPARM_ACODE OR TATYP = %AREADEF_ACODE
      795    14099         /* BASED_ACODE OR DCB_ACODE OR PARM_ACODE OR SPARM_ACODE OR AREADEF_ACODE */
      796    14100    3             THEN DO;
             14100                     /* Address type of size of item is based, paramater, DCB, or areadef */
      797    14101    3                  IF TATYP = %BASED_ACODE  /* BASED_ACODE */
      798    14102    4                  THEN DO;       /* Size of item is based - implied ptr required */
      799    14103    4                       DITEM.ADDR_TYPE = %BASED_ACODE; /* BASED_ACODE */
      800    14104    4                     END;                  /* Size of item is based */
      801    14105    4                  ELSE DO;
      802    14106    4                       DITEM.ADDR_TYPE = %PARM_ACODE; /* PARM_ACODE */
      803    14107    4                       CALL BUMPD$ ALTRET(VERR);
      804    14108    4                       DITEM = DUMPTR;
      805    14109    4                       IF TATYP = %DCB_ACODE /* DCB_ACODE */
      806    14110    5                       THEN DO;            /* Size of item is DCB */
      807    14111    5                            DITEM.VALUEB = DESC.ITEM(%DCB_DESC); /* DCB_DESC */
      808    14112    5                            DITEM.ADDR_TYPE = %DESC_ACODE; /* DESC_ACODE */
      809    14113    5                            DITEM.SP.VD.DISP = IENTRY$ -> B$VREBL.IMPTR;
      810    14114    5                          END;             /* DCB */
      811    14115    4                       ELSE IF TATYP = %PARM_ACODE /* PARM_ACODE */
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:24   
      812    14116    5                            THEN DO;       /* Size of item is auto parameter */
      813    14117    5                                 DITEM.VALUEB = DESC.ITEM(%PARM_DESC); /* PARM_DESC */
      814    14118    5                                 DITEM.ADDR_TYPE = %DESC_ACODE; /* DESC_ACODE */
      815    14119    5                                 DITEM.SP.VP.N = IENTRY$ -> B$VREBL.IMPTR - 2;
      816    14120    5                                 ZITEM.FLAGS.MDSE.S = '1'B;
      817    14121    5                               END;        /* Auto parameter */
      818    14122    4                            ELSE IF TATYP = %SPARM_ACODE /* SPARM_ACODE */
      819    14123    5                                 THEN DO;  /* Size of item is static parameter */
      820    14124    5                                      DITEM.ADDRESS.W = IENTRY$ -> B$VREBL.IMPTR;
      821    14125    5                                      DITEM.ADDR_TYPE = %SPARM_ACODE; /* SPARM_ACODE */
      822    14126    5                                    END;   /* Static parameter */
      823    14127    5                                 ELSE DO;  /* Size of item is areadef */
      824    14128    5                                      DITEM.ADDR_TYPE = %CONST_ACODE; /* CONST_ACODE */
      825    14129    5                                      DITEM.VALUE = PINCRW(IENTRY$, POFFW(ADDR(B$VREBL.
             14129                                               IMPTR), ADDR(B$VREBL))) -> UBIN36;
      826    14130    5                                    END;   /* Areadef */
      827    14131    4                     END;                  /* NOT BASED_ACODE */
      828    14132    3                END;
             14132                      /* Address type of size of item is based, parameter, DCB or areadef */
      829    14133    2             CALL DDF$VREBL_#(ENTRY#.E(ENTRY#.C), ENTRY$) ALTRET(BADSCHEMA);
             14133                      /* RE-ESTAB. VAR */
      830    14134    2           END;                            /* Adjustable size item */
      831    14135    1        IF DTYP = %STRUCTURE_DATATYPE      /* STRUCTURE_DATATYPE */
      832    14136    1          AND DITEM.VALUE < 73
      833    14137    1        THEN DTYP = %BIT_DATATYPE;         /* %BIT_DATATYPE */
      834    14138    1        IF DTYP = %BIT_DATATYPE            /* %BIT_DATATYPE */
      835    14139    1          AND DITEM.VALUE > 3
      836    14140    2        THEN DO;
      837    14141    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      838    14142    2             THEN DTYP = %OCT_DATATYPE;    /* OCT_DATATYPE */
      839    14143    2             ELSE DTYP = %X_DATATYPE;      /* OCT_DATATYPE */
      840    14144    2           END;
      841    14145    1        ZITEM.ADDR_TYPE = ATYP;
      842    14146    1        IF DTYP = %INDEX1_DATATYPE OR      /* %INDEX1_DATATYPE */
      843    14147    1          DTYP = %INDEX2_DATATYPE          /* %INDEX2_DATATYPE */
      844    14148    2        THEN DO;
      845    14149    2             ZITEM.DATA_TYPE = %SBIN_DATATYPE; /* %SBIN_DATATYPE */
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:25   
      846    14150    3             DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);
      847    14151    3               CASE (%HOST);
      848    14152    3                  ZITEM.ADDRESS.W = B$VREBL.ADR.W + 1;
      849    14153    3               CASE (%L6);
      850    14154    3                  ZITEM.ADDRESS.W = B$VREBL.ADR6.W + 1;
      851    14155    3               CASE (ELSE);
      852    14156    3                  S_D.ERROR = 502;    /* E@DELBUG */
      853    14157    3                  ALTRETURN;
      854    14158    3               END;
      855    14159    2             IF DTYP = %INDEX1_DATATYPE    /* %INDEX1_DATATYPE */
      856    14160    2             THEN
      857    14161    3             DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);
      858    14162    3               CASE (%HOST);
      859    14163    3                  ZITEM.ADDRESS.C = B$VREBL.ADR.C + 2;
      860    14164    3                  ZITEM.ADDRESS.B = B$VREBL.ADR.B;
      861    14165    3               CASE (%L6);
      862    14166    3                  ZITEM.ADDRESS.C = B$VREBL.ADR6.C + 2;
      863    14167    3                  ZITEM.ADDRESS.B = B$VREBL.ADR6.B;
      864    14168    3               CASE (ELSE);
      865    14169    3                  S_D.ERROR = 502;    /* E@DELBUG */
      866    14170    3                  ALTRETURN;
      867    14171    3               END;
      868    14172    2             ELSE
      869    14173    3             DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);
      870    14174    3               CASE (%HOST);
      871    14175    3                  ZITEM.ADDRESS.C = B$VREBL.ADR.C;
      872    14176    3                  ZITEM.ADDRESS.B = B$VREBL.ADR.B;
      873    14177    3               CASE (%L6);
      874    14178    3                  ZITEM.ADDRESS.C = B$VREBL.ADR6.C;
      875    14179    3                  ZITEM.ADDRESS.B = B$VREBL.ADR6.B;
      876    14180    3               CASE (ELSE);
      877    14181    3                  S_D.ERROR = 502;    /* E@DELBUG */
      878    14182    3                  ALTRETURN;
      879    14183    3               END;
      880    14184    2           END;
      881    14185    2        ELSE DO;
      882    14186    2             ZITEM.DATA_TYPE = DTYP;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:26   
      883    14187    3             DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);
      884    14188    3               CASE (%HOST);
      885    14189    3                  ZITEM.ADDRESS.W = B$VREBL.ADR.W;
      886    14190    3                  ZITEM.ADDRESS.C = B$VREBL.ADR.C;
      887    14191    3                  ZITEM.ADDRESS.B = B$VREBL.ADR.B;
      888    14192    3               CASE (%L6);
      889    14193    3                  ZITEM.ADDRESS.W = B$VREBL.ADR6.W;
      890    14194    3                  ZITEM.ADDRESS.C = B$VREBL.ADR6.C;
      891    14195    3                  ZITEM.ADDRESS.B = B$VREBL.ADR6.B;
      892    14196    3               CASE (ELSE);
      893    14197    3                  S_D.ERROR = 502;    /* E@DELBUG */
      894    14198    3                  ALTRETURN;
      895    14199    3               END;
      896    14200    2           END;
      897    14201    1        IF IMPLF4
      898    14202    2        THEN DO;
      899    14203    2             NCHARS = ZITEM.ADDRESS.W * 4 + ZITEM.ADDRESS.C - B$VREBL.ELMNTSIZ / 9;
      900    14204    2             ZITEM.ADDRESS.W = NCHARS / 4;
      901    14205    2             ZITEM.ADDRESS.C = MOD(NCHARS , 4);
      902    14206    2           END;
      903    14207    1        IF FMT(DTYP) = %CANT_FMT           /* CANT_FMT */
      904    14208    1        THEN ZITEM.FLAGS.MDSE.D = '0'B;
      905    14209    1        IF FMT( DTYP ) = %PUP_FMT          /* PUP_FMT */
      906    14210    2        THEN DO;                           /* Packed - Unpacked formats */
      907    14211    3             DO CASE( DTYP );
      908    14212    3               CASE( 9 );                  /* Packed, leading, ASCII */
      909    14213    3                  TBITS = '010100'B;
      910    14214    3               CASE( 25 );                 /* Packed, trailing, ASCII */
      911    14215    3                  TBITS = '011000'B;
      912    14216    3               CASE( 31 );                 /* Packed, trailing, EBCDIC */
      913    14217    3                  TBITS = '011010'B;
      914    14218    3               CASE( 40 );                 /* Packed, unsigned */
      915    14219    3                  TBITS = '010000'B;
      916    14220    3               CASE( 41 );                 /* Unpacked, unsigned */
      917    14221    3                  TBITS = '100000'B;
      918    14222    3               CASE( 42 );                 /* Unpacked, leading, separate */
      919    14223    3                  TBITS = '100100'B;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:27   
      920    14224    3               CASE( 43 );                 /* Unpacked, trailing, separate */
      921    14225    3                  TBITS = '101000'B;
      922    14226    3               CASE( 44 );                 /* Unpacked, leading, overpunched */
      923    14227    3                  TBITS = '100101'B;
      924    14228    3               CASE( 45 );                 /* Unpacked, trailing, overpunched */
      925    14229    3                  TBITS = '101001'B;
      926    14230    3               CASE(ELSE);
      927    14231    3                  S_D.ERROR = 502;    /* E@DELBUG */
      928    14232    3                  CALL DDE$ERROR;
      929    14233    3               END;                        /* DO CASE( DTYP ) */
      930    14234    2             ZITEM.PUP.BITS = TBITS;
      931    14235    2             ZITEM.PUP.SCALE = B$VREBL.SCALE;
      932    14236    2           END;                            /* Packed - Unpacked formats */
      933    14237    1        ELSE ZITEM.PUP = '0'B;             /* Binary, no scale */
      934    14238    1   DONE:
      935    14239    1        IF ADDREXP_FLAG
      936    14240    1          AND ZITEM.DTYP ~= %SPEC_DTYP     /* SPEC_DTYP */
      937    14241    1          AND ZITEM.DATA_TYPE ~= %INST_DATATYPE /* INST_DATATYPE */
      938    14242    1        THEN ZITEM.DATA_TYPE = %OCT_DATATYPE; /* OCT_DATATYPE */
      939    14243    1        CALL BUMPD$ ALTRET(VERR);
      940    14244    1        ZITEM.SIZE = POFFW(SDD$, S_D.DESC$);
      941    14245    1        TEMP1 = ZITEM.SIZE;
      942    14246    1        IF STATUS_EXISTS
      943    14247    2        THEN DO;
      944    14248    2             ZITEM.NAMEFLAGS.STATUS_EXISTS = '1'B;
      945    14249    3             DO I = 0 TO TEMP1 - 1;
      946    14250    3                  SDD$ -> UBIN36 = ZITEM$ -> UBIN36;
      947    14251    3                  SDD$ = PINCRW(SDD$, 1);
      948    14252    3                  ZITEM$ = PINCRW(ZITEM$, 1);
      949    14253    3                END;
      950    14254    2             S_D.D$ = SDD$;
      951    14255    2             ZITEM.SIZE = POFFW(SDD$, ZITEM$);
      952    14256    2             SDD$ = PINCRW(SDD$, -3);
      953    14257    2             KENTRY# = ENTRY#.E(ENTRY#.C) + 1;
      954    14258    2             CALL DDF$VREBL_#(KENTRY#, ENTRY$) ALTRET(BADSCHEMA);
      955    14259    2             IENTRY# = KENTRY# + 1;
      956    14260    2             CALL DDF$VREBL_#(IENTRY#, IENTRY$) ALTRET(BADSCHEMA);
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:28   
      957    14261    2             ZITEM.ADDRESS.W = B$VREBL.ADR6.W;
      958    14262    2             ZITEM.ADDRESS.C = B$VREBL.ADR6.C;
      959    14263    2             ZITEM.ADDRESS.B = B$VREBL.ADR6.B;
      960    14264    2             DTYP = %BIT_DATATYPE;
      961    14265    2             ZITEM.DTYP = DTYP;
      962    14266    2             ZITEM.NAMEFLAGS.STATUS_EXISTS = '0'B;
      963    14267    2             ZITEM.ADDR_TYPE = B$VREBL.ADDRTYP - 1;
      964    14268    2             ZITEM.DATA_TYPE = DTYP;
      965    14269    2             ZITEM.FMT_SPEC = FMT(DTYP);
      966    14270    2             DITEM.VALUE = B$VREBLCSET.SIG_BITS;
      967    14271    2             ZITEM.SET_DATATYP = B$VREBLCSET.DATATYP;
      968    14272    2             ZITEM.NPOINTER_TRUE = B$VREBLCSET.NPOINTER_TRUE;
      969    14273    2             ZITEM.NPOINTER_FALSE = B$VREBLCSET.NPOINTER_FALSE;
      970    14274    2           END;
      971    14275    1        IF XQUAL
      972    14276    1        THEN CALL DDS$SET_T2Q ALTRET( BADSCHEMA );
      973    14277    1        RETURN;
      974    14278    1   BADSCHEMA:
      975    14279    1        S_D.ERROR = 22;              /* E@UERR11 */
      976    14280    1   VERR:
      977    14281    1        ALTRETURN;
      978    14282    1   TRAP_ADJ_DIM: ;
      979    14283    1        S_D.ERROR = 263;        /*  E@TRAP_ADJ_DIM */
      980    14284    1        ALTRETURN;
      981    14285        %EJECT;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:29   
      982    14286    1   GETVAL: PROC ALTRET;
      983    14287    2   DCL L6_AUTO UBIN CONSTANT INIT(10485760); /* 'A00000'X = AUTO base for LCP6 user */
      984    14288    3        DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);
      985    14289    3          CASE (%HOST);
      986    14290    3             ADDRESS = JENTRY$ -> B$VREBL.ADR.W;
      987    14291    3          CASE (%L6);
      988    14292    3             ADDRESS = JENTRY$ -> B$VREBL.ADR6.W;
      989    14293    3          CASE (ELSE);
      990    14294    3             S_D.ERROR = 502;         /* E@DELBUG */
      991    14295    3             ALTRETURN;
      992    14296    3          END;
      993    14297    2        SEG = 3;
      994    14298    2        DESC# = 0;
      995    14299    2        NOT_IS = '0'B;
      996    14300    2        IF JENTRY$ -> B$VREBL.ADDRTYP = %AUTO_ACODE + 1
      997    14301    3        THEN DO;
      998    14302    3             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      999    14303    4             THEN DO;
     1000    14304    4                  DESC# = 4;
     1001    14305    4                  NOT_IS = '1'B;
     1002    14306    4                  ADDRESS = ADDRESS + (B$TCB$ -> B$TCB.STK$ -> B$SS.PR2.AR2 / 64);
     1003    14307    4                  CALL DDK$GETMVAL (VALUE, ADDRESS, SEG, DESC#, NOT_IS) ALTRET(ALT);
     1004    14308    4                END;
     1005    14309    3             ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
     1006    14310    4                  THEN DO;
     1007    14311    4                       ADDRESS = ADDRESS + L6_AUTO;
     1008    14312    4                       CALL DFK$GETMVAL (VALUE, ADDRESS, SEG, DESC#, NOT_IS, '0'B)
             14312                                ALTRET(ALT);
     1009    14313    4                     END;
     1010    14314    4                  ELSE DO;
     1011    14315    4                       S_D.ERROR = 502; /* E@DELBUG */
     1012    14316    4                       CALL DDE$ERROR;
     1013    14317    4                       GOTO ALT;
     1014    14318    4                     END;
     1015    14319    3           END;
     1016    14320    2        RETURN;
     1017    14321    2   ALT: ;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:30   
     1018    14322    2        ALTRETURN;
     1019    14323    2   END GETVAL;
     1020    14324             %EJECT;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:31   
     1021    14325             %BUMPD$;
             14326             %LIST;
             14327    1   BUMPD$: PROC(PCNT) ALTRET;
             14328    2   DCL PCNT UBIN;
             14329    2   DCL CNT UBIN;
             14330    2   DCL DD_VARCOM$ PTR SYMREF;
             14331    2   DCL DDM$GETMEM ENTRY(3) ALTRET;
             14332    2        IF ADDR(PCNT) = ADDR(NIL)
             14333    2        THEN CNT = SIZEW(DITEM);
             14334    2        ELSE CNT = PCNT;
             14335    2        SDD$ = PINCRW(SDD$,CNT);
             14336    2        IF SDD$ > S_D.DESCL$
             14337    3        THEN DO;
             14338    3             IF S_D.STORED ~= 0
             14339    4             THEN DO;
             14340    5                  DO WHILE (SDD$ > PINCRW(S_D.DESCL$, 1));
             14341    5                       CALL DDM$GETMEM(DD_VARCOM$, 1024);
             14342    5                       S_D.VARCOM_HIGH$ = PINCRW(S_D.VARCOM_HIGH$, 1024);
             14343    5                       S_D.DESCL$ = S_D.VARCOM_HIGH$;
             14344    5                     END;
             14345    4                END;
             14346    4             ELSE DO;
             14347    4                  S_D.ERROR = 8; /* E@NOROOM */
             14348    4                  ALTRETURN;
             14349    4                END;
             14350    3           END;
             14351    2        S_D.D$ = SDD$;
             14352    2        RETURN;
             14353    2        END BUMPD$;
     1022    14356    1   END DDD$VREF;

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:32   
--  Include file information  --

   DD_DTYP_R.:E05TOU  is referenced.
   DD_DESC_R.:E05TOU  cannot be made into a system file and is referenced.
   DD$BASED.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   DD_PSUBS_C.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B$SS.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure DDD$VREF.

   Procedure DDD$VREF requires 2034 words for executable code.
   Procedure DDD$VREF requires 118 words of local(AUTO) storage.

    No errors detected in file DDD$VREF.:E05TSI    .

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:33   

 Object Unit name= DDD$VREF                                   File name= DDD$VREF.:E05TOU
 UTS= JUL 29 '97 13:55:52.20 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    139    213  DDD$VREF
    2   Proc  even  none  2034   3762  DDD$VREF
    3  RoData even  none    12     14  DDD$VREF

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        1  DDD$VREF

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1     12  TYPESIZE_MULT                      1    112  TYPESIZE_MULT_FEP
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:34   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 DDD$PQLIST
 yes     yes           Std       2 DDD$ADDREXP
 yes     yes           Std       3 DDS$V_SRCH
 yes     yes           Std       4 DDD$MULT
 yes     yes           Std       2 DDS$UD_SRCH
 yes     yes           Std       2 DDS$SD_SRCH
 yes     yes           Std       2 DDS$SP_SRCH
 yes     yes           Std       0 DDS$SET_T2Q
 yes     yes           Std       4 DDD$SUBREF
 yes     yes           Std       2 DDS$ED_SRCH
 yes     yes           Std       2 DDS$D_SRCH
 yes     yes           Std       0 DDS$SET_X2Q
 yes     yes           Std       3 DDD$SIMEXP
 yes     yes           Std       0 DDS$SET_Q2T
 yes     yes           Std       2 DDF$VREBL_#
         yes           Std       0 DDE$ERROR
 yes     yes           Std       5 DDK$GETMVAL
 yes     yes           Std       6 DFK$GETMVAL
 yes     yes           Std       3 DDM$GETMEM
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B$TCB$                           r    S_D$
     DESC                                  FMT                                   DD_VARCOM$
     B_VECTNIL
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:35   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:36   


        1        1        /*M*  DDD$VREF - builds complete data descriptor  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*P*  NAME: DDD$VREF
       10       10              PURPOSE: Builds data descriptor for the display variable
       11       11                       at PQLIST$ in the X$PARSE output tree.
       12       12              DESCRIPTION: Operates on X$PARSE output tree (pointed
       13       13                       into by PQLIST$) to produce a possibly pointer
       14       14                       qualified, possibly subscripted display reference.
       15       15                       The result is a data descriptor in the form of a
       16       16                       set of descriptor items built at the location
       17       17                       pointed to by the global S_D.D$.  DDD$VREF
       18       18                       calls on DDD$PQLIST to build the string of pointer
       19       19                       qualifiers (if any), then, if the reference is
       20       20                       subscripted, it calls DDD$SUBREF to build the index
       21       21                       descriptor items.  If the reference is further modified
       22       22                       by a constant expression (I.E. +10), DDD$ADDREXP
       23       23                       is called to build a descriptor item for the expression
       24       24                       modifier.  The actual variable to be displayed is then
       25       25                       entered into the data descriptor and DDD$VREF returns.
       26       26                       If any semantic error is found while proccessing
       27       27                       the variable reference, the global variable S_D.ERROR
       28       28                       is set to the appropriate error code, and the ALTRETURN
       29       29                       is taken.
       30       30                                                               */
       31       31        DDD$VREF: PROC(PQLIST$) ALTRET;

     31  2 000000   000000 700200 xent  DDD$VREF     TSX0  ! X66_AUTO_1
         2 000001   000166 000001                    ZERO    118,1

       32       32                                                /* Params */
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:37   
       33       33    1   DCL PQLIST$ PTR;
       34       34                                                /* Local temps */
       35       35    1   DCL TEMP$ PTR;
       36       36    1   DCL ROOT$ PTR;
       37       37    1   DCL SYM$ PTR;
       38       38    1   DCL SYM2$ PTR;
       39       39    1   DCL ENTRY$ PTR;
       40       40    1   DCL HIGH_ENTRY# UBIN;
       41       41    1   DCL NQFLAG BIT(1);
       42       42    1   DCL BASED_FLAG BIT(1) ALIGNED;
       43       43    1   DCL ARRAY_FLAG BIT(1);
       44       44    1   DCL RANGE_FLAG BIT(1) ALIGNED;
       45       45    1   DCL ADDREXP_FLAG BIT(1);
       46       46    1   DCL STATUS_EXISTS BIT(1) ALIGNED;
       47       47    1   DCL XQUAL BIT(1);
       48       48    1   DCL DIM_CNT SBIN;
       49       49    1   DCL DIMS UBIN;
       50       50    1   DCL TEMP1 SBIN;
       51       51    1   DCL 1 SITEM_VAL REDEF TEMP1,
       52       52    1         2 ID UBIN(9) UNAL,
       53       53    1         2 * BIT(15),
       54       54    1         2 FLAGS BIT(6) UNAL,
       55       55    1         2 FMT UBIN(6) UNAL;
       56       56    1   DCL 1 SDITEM_VAL REDEF TEMP1,
       57       57    1         2 TYPE UBIN(6) UNAL,
       58       58    1         2 ID UBIN(9) UNAL,
       59       59    1         2 DISP UBIN(9) UNAL,
       60       60    1         2 * BIT(12) UNAL;
       61       61    1   DCL ATYP REDEF TEMP1 SBIN;
       62       62    1   DCL TEMP2 SBIN;
       63       63    1   DCL DTYP REDEF TEMP2 SBIN;
       64       64    1   DCL TDTYP SBIN;
       65       65    1   DCL MULT(0:6) PTR;
       66       66    1   DCL ARRAYTYP UBIN;
       67       67    1   DCL I SBIN;
       68       68    1   DCL STRUCT UBIN;
       69       69    1   DCL ILB SBIN;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:38   
       70       70    1   DCL IUB SBIN;
       71       71    1   DCL LEVELDIMS UBIN;
       72       72    1   DCL IENTRY# SBIN;
       73       73    1   DCL T$ PTR;
       74       74    1   DCL IPTR$ PTR;
       75       75    1   DCL IENTRY$ PTR;
       76       76    1   DCL JENTRY$ PTR;
       77       77    1   DCL JENTRY# UBIN;
       78       78    1   DCL KENTRY# UBIN;
       79       79    1   DCL VALUE UBIN;
       80       80    1   DCL ADDRESS UBIN;
       81       81    1   DCL SEG UBIN;
       82       82    1   DCL DESC# UBIN;
       83       83    1   DCL NOT_IS BIT(1) ALIGNED;
       84       84    1   DCL TATYP UBIN;
       85       85    1   DCL TBITS BIT(36);
       86       86    1   DCL 1 TEXTC BASED,
       87       87    1         2 SZ UBIN(9) UNAL,
       88       88    1         2 TXT CHAR(TEXTC.SZ);
       89       89    1   DCL EXPR_IDX SBIN;
       90       90    1   DCL IMPLF4 BIT(1) ALIGNED;
       91       91    1   DCL NCHARS UBIN;
       92       92                                                /* Misc */
       93       93    1   DCL UBIN36 UBIN(36) BASED ALIGNED;
       94       94             %INCLUDE CP_6;
       95      175             %B$TCB;
       96      178             %INCLUDE B$SS;
       97      357    1   DCL B$TCB$ PTR SYMREF;
       98      358             %INCLUDE XU_MACRO_C;
       99     3464             %PARSE$OUT(NAME=O,SCRITCH=SCRATCH,STCLASS=BASED);
      100     3509             %INCLUDE XUH_MACRO_C;
      101     3593             %INCLUDE DD_SD_M;
      102     4929             %S_D;
      103     6247             %INCLUDE DD_ERR_C;
      104     6644             %INCLUDE DD_PSUBS_C;
      105     7119             %INCLUDE B$OBJECT_C;
      106    10549             %B$VREBL(STCLASS="BASED(ENTRY$)");
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:39   
      107    10713             %B$VREBLC(STCLASS="BASED(ENTRY$)");
      108    10786             %B$VREBLCA(STCLASS="BASED(ENTRY$)");
      109    10874             %B$VREBLCSET(STCLASS="BASED(IENTRY$)");
      110    10917             %VREBLSUBS;
      111    10925             %VREBL_DATATYPES;
      112    11000             %B$SDEF(STCLASS="BASED(ENTRY$)");
      113    11054             %B$EDEF(STCLASS="BASED(ENTRY$)");
      114    11124             %B$LBNTRY0;
      115    11160             %COMPILERIDSUBS;
      116    11176             %INCLUDE DD$DITEM;
       12+   11279             %LIST;
       13+   11280    1        DCL SDD$ PTR;
       14+   11281    1        DCL ZITEM$ PTR;
       15+   11282    1        DCL SDD_L6$ PTR;
       16+   11283    1        DCL ZITEM_L6$ PTR;
      117    11857             %ZITEM;
      118    11929             %DITEM;
      119    12009             %MITEM;
      120    12057             %INCLUDE DD$BASED;
      121    13360             %DD$VENTRY;
      122    13365             %INCLUDE DD_DESC_R;
      123    13415    1   DCL 1 DUMPTR CONSTANT,
      124    13416    1         2 * UBIN(18) UNAL INIT(0),
      125    13417    1         2 * UBIN(9) UNAL INIT(0),
      126    13418    1         2 * UBIN(9) UNAL INIT(%PTR_ICODE), /* PTR_ICODE */
      127    13419    1         2 * UBIN(36) UNAL INIT(0);
      128    13420             %INCLUDE DD_DTYP_R;
      129    13431             %FMT;
      130    13434    1   DCL 1 DUMSIZE CONSTANT,
      131    13435    1         2 * UBIN(9) UNAL INIT(1),         /* Multiplier for constant size */
      132    13436    1         2 * UBIN(9) UNAL INIT(0),
      133    13437    1         2 * UBIN(9) UNAL INIT(%CONST_ACODE), /* CONST_ACODE */
      134    13438    1         2 * UBIN(9) UNAL INIT(%SIZE_ICODE), /* SIZE_ICODE */
      135    13439    1         2 * UBIN(36) UNAL INIT(36);
      136    13440    1   DCL 1 DUMSIZE_L6 CONSTANT,
      137    13441    1         2 * UBIN(9) UNAL INIT(1),         /* Multiplier for constant size */
      138    13442    1         2 * UBIN(9) UNAL INIT(0),
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:40   
      139    13443    1         2 * UBIN(9) UNAL INIT(%CONST_ACODE), /* CONST_ACODE */
      140    13444    1         2 * UBIN(9) UNAL INIT(%SIZE_ICODE), /* SIZE_ICODE */
      141    13445    1         2 * UBIN(36) UNAL INIT(16);
      142    13446    1   DCL 1 DUMILBINDEX CONSTANT,             /* Implicit lower bound */
      143    13447    1         2 * UBIN(18) UNAL INIT(0),
      144    13448    1         2 * UBIN(9) UNAL INIT(%CONST_ACODE), /* CONST_ACODE */
      145    13449    1         2 * UBIN(9) UNAL INIT(%LIDX_ICODE), /* LIDX_ICODE */
      146    13450    1         2 * UBIN(36) UNAL INIT(0);
      147    13451    1   DCL 1 DUMIUBINDEX CONSTANT,             /* Implicit upper bound */
      148    13452    1         2 * BIT(18) UNAL INIT('000000000001'B), /* LFLAG */
      149    13453    1         2 * UBIN(9) UNAL INIT(%CONST_ACODE), /* CONST_ACODE */
      150    13454    1         2 * UBIN(9) UNAL INIT(%UIDX_ICODE), /* UIDX_ICODE */
      151    13455    1         2 * UBIN(36) UNAL INIT(0);
      152    13456    1   DCL TYPESIZE_MULT(0:63) UBIN CONSTANT SYMDEF INIT(
      153    13457    1        0,                                 /* 0 */
      154    13458    1        1,                            /* 1      REAL BINARY FIXED SINGLE (SBIN) */
      155    13459    1        0,                                 /* 2 */
      156    13460    1        1,                                 /* 3      Real bin float single */
      157    13461    1        1,                                 /* 4      Real bin float double */
      158    13462    1        0*2,                               /* 5 - 6 */
      159    13463    1        1,                                 /* 7      Complex float single */
      160    13464    1        1,                                 /* 8      Complex float double */
      161    13465    1        1,                                 /* 9      Packed, leading ASCII */
      162    13466    1        0*3,                               /* 10 - 12 */
      163    13467    1        36,                                /* 13     POINTER */
      164    13468    1        0*3,                               /* 14 - 16 */
      165    13469    1        1,                                 /* 17     STRUCTURE */
      166    13470    1        0,                                 /* 18 */
      167    13471    1        1,                                 /* 19     BIT STRING */
      168    13472    1        0,                                 /* 20     VARYING BIT STRING */
      169    13473    1        9,                                 /* 21     CHAR STRING */
      170    13474    1        0,                                 /* 22     VARYING CHAR STRING */
      171    13475    1        0,                                 /* 23 */
      172    13476    1        1,                                 /* 24     UBIN */
      173    13477    1        1,                                 /* 25     Packed, trailing ASCII */
      174    13478    1        9,                                 /* 26     ADJ CHAR STRING */
      175    13479    1        1,                                 /* 27     ADJ STRUCTURE/BIT STRING */
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:41   
      176    13480    1        36,                                /* 28     EPTR */
      177    13481    1        1,                                 /* 29 */
      178    13482    1        1,                                 /* 30 */
      179    13483    1        1,                                 /* 31     Packed, trailing EBCDIC */
      180    13484    1        0*3,                               /* 32 - 34 */
      181    13485    1        1,                                 /* 35     FORTRAN logical */
      182    13486    1        0*4,                               /* 36 - 39 */
      183    13487    1        1,                                 /* 40     Packed, unsigned */
      184    13488    1        9,                                 /* 41     Unpacked, unsigned */
      185    13489    1        9,                                 /* 42     Unpacked, leading sign */
      186    13490    1        9,                                 /* 43     Unpacked, trailing sign */
      187    13491    1        9,                            /* 44     Unpacked, leading overpunched */
      188    13492    1        9,                            /* 45     Unpacked, trailing overpunched */
      189    13493    1        0,                                 /* 46 */
      190    13494    1        72,                                /* 47 */
      191    13495    1        72,                                /* 48 */
      192    13496    1        72,                                /* 49 DESCRIPTOR */
      193    13497    1        0*14);                             /* 50 - 63 */
      194    13498    1   DCL TYPESIZE_MULT_FEP(0:63) UBIN CONSTANT SYMDEF INIT(
      195    13499    1        0,                                 /* 0 */
      196    13500    1        1,                            /* 1      REAL BINARY FIXED SINGLE (SBIN) */
      197    13501    1        0,                                 /* 2 */
      198    13502    1        1,                                 /* 3      Real bin float single */
      199    13503    1        1,                                 /* 4      Real bin float double */
      200    13504    1        0*2,                               /* 5 - 6 */
      201    13505    1        1,                                 /* 7      Complex float single */
      202    13506    1        1,                                 /* 8      Complex float double */
      203    13507    1        1,                                 /* 9      Packed, leading ASCII */
      204    13508    1        0*3,                               /* 10 - 12 */
      205    13509    1        32,                                /* 13     POINTER */
      206    13510    1        0*3,                               /* 14 - 16 */
      207    13511    1        1,                                 /* 17     STRUCTURE */
      208    13512    1        0,                                 /* 18 */
      209    13513    1        1,                                 /* 19     BIT STRING */
      210    13514    1        0,                                 /* 20     VARYING BIT STRING */
      211    13515    1        8,                                 /* 21     CHAR STRING */
      212    13516    1        0,                                 /* 22     VARYING CHAR STRING */
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:42   
      213    13517    1        0,                                 /* 23 */
      214    13518    1        1,                                 /* 24     UBIN */
      215    13519    1        1,                                 /* 25     Packed, trailing ASCII */
      216    13520    1        8,                                 /* 26     ADJ CHAR STRING */
      217    13521    1        1,                                 /* 27     ADJ STRUCTURE/BIT STRING */
      218    13522    1        32,                                /* 28     EPTR */
      219    13523    1        1,                                 /* 29 */
      220    13524    1        1,                                 /* 30 */
      221    13525    1        1,                                 /* 31     Packed, trailing EBCDIC */
      222    13526    1        0*3,                               /* 32 - 34 */
      223    13527    1        1,                                 /* 35     FORTRAN logical */
      224    13528    1        0*4,                               /* 36 - 39 */
      225    13529    1        1,                                 /* 40     Packed, unsigned */
      226    13530    1        8,                                 /* 41     Unpacked, unsigned */
      227    13531    1        8,                                 /* 42     Unpacked, leading sign */
      228    13532    1        8,                                 /* 43     Unpacked, trailing sign */
      229    13533    1        8,                            /* 44     Unpacked, leading overpunched */
      230    13534    1        8,                            /* 45     Unpacked, trailing overpunched */
      231    13535    1        0,                                 /* 46 */
      232    13536    1        48,                                /* 47 - Vector */
      233    13537    1        64,                                /* 48 - Remember */
      234    13538    1        0*15);                             /* 49 - 63 */
      235    13539                                                /* External routines */
      236    13540    1   DCL DDD$PQLIST ENTRY(2) ALTRET;         /* Bld ptr qualification list */
      237    13541    1   DCL DDD$ADDREXP ENTRY(2) ALTRET;        /* Build address expression */
      238    13542    1   DCL DDD$SUBREF ENTRY(4) ALTRET;         /* Build subscript reference */
      239    13543    1   DCL DDD$SIMEXP ENTRY(3) ALTRET;         /* Build simple expression */
      240    13544    1   DCL DDD$MULT ENTRY(4) ALTRET;           /* Calculate index multipliers */
      241    13545    1   DCL DDK$GETMVAL ENTRY(5) ALTRET;
      242    13546    1   DCL DDS$SP_SRCH ENTRY(2) ALTRET;        /* Special symbol search */
      243    13547    1   DCL DDS$D_SRCH ENTRY(2) ALTRET;         /* Special desc/ptr search */
      244    13548    1   DCL DDS$SD_SRCH ENTRY(2) ALTRET;        /* SYMDEF search */
      245    13549    1   DCL DDS$ED_SRCH ENTRY(2) ALTRET;        /* ENTDEF search */
      246    13550    1   DCL DDS$V_SRCH ENTRY(3) ALTRET;         /* Variable search */
      247    13551    1   DCL DDS$UD_SRCH ENTRY(2) ALTRET;        /* User defined symbols */
      248    13552    1   DCL DDS$SET_Q2T ENTRY ALTRET;
      249    13553    1   DCL DDS$SET_X2Q ENTRY ALTRET;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:43   
      250    13554    1   DCL DDS$SET_T2Q ENTRY ALTRET;
      251    13555    1   DCL DDF$VREBL_# ENTRY(2) ALTRET;
      252    13556    1   DCL DDE$ERROR ENTRY;
      253    13557    1   DCL DFK$GETMVAL ENTRY(6) ALTRET;
      254    13558                                                /**/
      255    13559    1        STATUS_EXISTS = '0'B;

  13559  2 000002   200017 450100                    STZ     STATUS_EXISTS,,AUTO

      256    13560    1        SDD$ = S_D.D$;

  13560  2 000003   000000 470400 xsym               LDP0    S_D$
         2 000004   000044 236100                    LDQ     36,,PR0
         2 000005   200064 756100                    STQ     SDD$,,AUTO

      257    13561    1        S_D.DESC$ = SDD$;

  13561  2 000006   000041 756100                    STQ     33,,PR0

      258    13562    1        ZITEM$ = S_D.DESC$;

  13562  2 000007   200065 756100                    STQ     ZITEM$,,AUTO

      259    13563    1        CALL BUMPD$(SIZEW(ZITEM)) ALTRET(VERR);

  13563  2 000010   000001 236000 3                  LDQ     1
         2 000011   200155 756100                    STQ     ENTRY#+53,,AUTO
         2 000012   003707 701000 2                  TSX1    BUMPD$
         2 000013   003546 702000 2                  TSX2    VERR

      260    13564    1        ZITEM = '0'B;

  13564  2 000014   200065 470500                    LDP0    ZITEM$,,AUTO
         2 000015   000100 100400                    MLR     fill='000'O
         2 000016   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 000017   000000 000064                    ADSC9   0,,PR0                   cn=0,n=52

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:44   
      261    13565    1        ZITEM.DTYP = %SIM_DTYP;            /* SIM_DTYP */

  13565  2 000020   000000 236003                    LDQ     0,DU
         2 000021   000001 552120                    STBQ    1,'20'O,PR0

      262    13566    1        ZITEM.FLAGS = %MDE_FLAGS;          /* MDE_FLAGS */

  13566  2 000022   640000 236003                    LDQ     -49152,DU
         2 000023   000001 552140                    STBQ    1,'40'O,PR0

      263    13567    1        CALL DDD$PQLIST(PQLIST$,BASED_FLAG) ALTRET(VERR);

  13567  2 000024   200013 631500                    EPPR1   BASED_FLAG,,AUTO
         2 000025   200161 451500                    STP1    CNT+3,,AUTO
         2 000026   200003 236100                    LDQ     @PQLIST$,,AUTO
         2 000027   200160 756100                    STQ     CNT+2,,AUTO
         2 000030   200160 630500                    EPPR0   CNT+2,,AUTO
         2 000031   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000032   000000 701000 xent               TSX1    DDD$PQLIST
         2 000033   003546 702000 2                  TSX2    VERR

      264    13568                                      /* Set up pointer to beginning of text and size */
      265    13569    1        ZITEM.TEXTSTART$ = PINCRC(ADDR(S_D.INPUT), S_D.SAVE_TEXT_STPOS);

  13569  2 000034   000000 470400 xsym               LDP0    S_D$
         2 000035   000066 236100                    LDQ     54,,PR0
         2 000036   000020 736000                    QLS     16
         2 000037   000610 036003                    ADLQ    392,DU
         2 000040   000000 036000 xsym               ADLQ    S_D$
         2 000041   200065 471500                    LDP1    ZITEM$,,AUTO
         2 000042   100002 756100                    STQ     2,,PR1

      266    13570    1        ZITEM.TEXTSZ = PQLIST$ -> O.CPOS - S_D.SAVE_TEXT_STPOS;

  13570  2 000043   200003 473500                    LDP3    @PQLIST$,,AUTO
         2 000044   300000 474500                    LDP4    0,,PR3
         2 000045   400002 236100                    LDQ     2,,PR4
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:45   
         2 000046   000066 136100                    SBLQ    54,,PR0
         2 000047   000000 620006                    EAX0    0,QL
         2 000050   100003 440100                    SXL0    3,,PR1

      267    13571    1        SDD$ = S_D.D$;

  13571  2 000051   000044 236100                    LDQ     36,,PR0
         2 000052   200064 756100                    STQ     SDD$,,AUTO

      268    13572    1        ROOT$ = PQLIST$ -> O.SUBLK$(PQLIST$ -> O.NSUBLKS -1);

  13572  2 000053   300000 474500                    LDP4    0,,PR3
         2 000054   400001 221100                    LDX1    1,,PR4
         2 000055   400002 236111                    LDQ     2,X1,PR4
         2 000056   200005 756100                    STQ     ROOT$,,AUTO

      269    13573                                                /**/
      270    13574    1        IF ROOT$ -> O.CODE = 40   /* VAREXP_CODE */

  13574  2 000057   200005 474500                    LDP4    ROOT$,,AUTO
         2 000060   400000 720100                    LXL0    0,,PR4
         2 000061   000050 100003                    CMPX0   40,DU
         2 000062   000443 601000 2                  TNZ     s:13665

      271    13575    2        THEN DO;                           /* Build variable reference */

      272    13576    2             ADDREXP_FLAG = '0'B;

  13576  2 000063   200016 450100                    STZ     ADDREXP_FLAG,,AUTO

      273    13577    2             ARRAY_FLAG = '0'B;

  13577  2 000064   200014 450100                    STZ     ARRAY_FLAG,,AUTO

      274    13578    2             S_D.RANGE_CNT = 0;

  13578  2 000065   000062 450100                    STZ     50,,PR0
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:46   

      275    13579    2             DIM_CNT = 0;

  13579  2 000066   200021 450100                    STZ     DIM_CNT,,AUTO

      276    13580    2             IPTR$ = S_D.D$;               /* Remember this in case implied PTR */

  13580  2 000067   000044 236100                    LDQ     36,,PR0
         2 000070   200045 756100                    STQ     IPTR$,,AUTO

      277    13581    2             IF ROOT$ -> O.NSUBLKS > 1

  13581  2 000071   400001 220100                    LDX0    1,,PR4
         2 000072   000002 100003                    CMPX0   2,DU
         2 000073   000230 602000 2                  TNC     s:13617

      278    13582    3             THEN DO;                      /* Process subref / addrexp */

      279    13583    3                  TEMP$ = ROOT$ -> O.SUBLK$(1);

  13583  2 000074   400004 236100                    LDQ     4,,PR4
         2 000075   200004 756100                    STQ     TEMP$,,AUTO

      280    13584    3                  IF TEMP$ -> O.CODE = 44 /* SUBREF_CODE */

  13584  2 000076   200004 475500                    LDP5    TEMP$,,AUTO
         2 000077   500000 720100                    LXL0    0,,PR5
         2 000100   000054 100003                    CMPX0   44,DU
         2 000101   000177 601000 2                  TNZ     s:13607

      281    13585    4                  THEN DO;                 /* Build subscript reference */

      282    13586    4                       ARRAY_FLAG = '1'B;

  13586  2 000102   400000 236003                    LDQ     -131072,DU
         2 000103   200014 756100                    STQ     ARRAY_FLAG,,AUTO

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:47   
      283    13587    4                       CALL DDD$SUBREF(TEMP$, RANGE_FLAG, DIM_CNT, MULT)

  13587  2 000104   200026 636500                    EPPR6   MULT,,AUTO
         2 000105   200163 456500                    STP6    CNT+5,,AUTO
         2 000106   200021 637500                    EPPR7   DIM_CNT,,AUTO
         2 000107   200162 457500                    STP7    CNT+4,,AUTO
         2 000110   200015 630500                    EPPR0   RANGE_FLAG,,AUTO
         2 000111   200161 450500                    STP0    CNT+3,,AUTO
         2 000112   200004 630500                    EPPR0   TEMP$,,AUTO
         2 000113   200160 450500                    STP0    CNT+2,,AUTO
         2 000114   200160 630500                    EPPR0   CNT+2,,AUTO
         2 000115   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000116   000000 701000 xent               TSX1    DDD$SUBREF
         2 000117   003546 702000 2                  TSX2    VERR

      284    13588    4                         ALTRET(VERR);
      285    13589    4                       IF RANGE_FLAG

  13589  2 000120   200015 234100                    SZN     RANGE_FLAG,,AUTO
         2 000121   000170 605000 2                  TPL     s:13602

      286    13590    5                      THEN DO; /* Set up pointer to beginning of subscript and size */

      287    13591    6                            DO I = 0 TO TEMP$ -> O.NSUBLKS-1;

  13591  2 000122   200036 450100                    STZ     I,,AUTO
         2 000123   000162 710000 2                  TRA     s:13599+1

      288    13592    6                                 IF TEMP$ -> O.SUBLK$(I) -> O.NSUBLKS > 1

  13592  2 000124   200004 470500                    LDP0    TEMP$,,AUTO
         2 000125   200036 720100                    LXL0    I,,AUTO
         2 000126   000003 471510                    LDP1    3,X0,PR0
         2 000127   100001 221100                    LDX1    1,,PR1
         2 000130   000002 101003                    CMPX1   2,DU
         2 000131   000161 602000 2                  TNC     s:13599

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:48   
      289    13593    7                                 THEN DO;

      290    13594    7                                      ZITEM.SUBSTART$ = PINCRC(ADDR(S_D.INPUT), TEMP$
             13594                                               -> O.SUBLK$(I) -> O.CPOS);

  13594  2 000132   100002 236100                    LDQ     2,,PR1
         2 000133   000020 736000                    QLS     16
         2 000134   000610 036003                    ADLQ    392,DU
         2 000135   000000 036000 xsym               ADLQ    S_D$
         2 000136   200065 473500                    LDP3    ZITEM$,,AUTO
         2 000137   300004 756100                    STQ     4,,PR3

      291    13595    7                                      IF I < TEMP$ -> O.NSUBLKS - 1

  13595  2 000140   200004 470500                    LDP0    TEMP$,,AUTO
         2 000141   000001 236100                    LDQ     1,,PR0
         2 000142   000022 772000                    QRL     18
         2 000143   000001 136007                    SBLQ    1,DL
         2 000144   200036 116100                    CMPQ    I,,AUTO
         2 000145   000155 604400 2                  TMOZ    s:13597

      292    13596    7                                      THEN ZITEM.SUBSZ = (TEMP$ -> O.SUBLK$(I+1) -> O.
             13596                                               CPOS - TEMP$ -> O.SUBLK$(I) -> O.CPOS) -1;

  13596  2 000146   000004 471510                    LDP1    4,X0,PR0
         2 000147   000003 474510                    LDP4    3,X0,PR0
         2 000150   100002 236100                    LDQ     2,,PR1
         2 000151   400002 136100                    SBLQ    2,,PR4
         2 000152   000001 136007                    SBLQ    1,DL
         2 000153   300005 756100                    STQ     5,,PR3
         2 000154   000161 710000 2                  TRA     s:13599

      293    13597    7                                     ELSE ZITEM.SUBSZ = (TEMP$ -> O.CPOS - TEMP$ -> O.
             13597                                               SUBLK$(I) -> O.CPOS) ;

  13597  2 000155   000003 471510                    LDP1    3,X0,PR0
         2 000156   000002 236100                    LDQ     2,,PR0
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:49   
         2 000157   100002 136100                    SBLQ    2,,PR1
         2 000160   300005 756100                    STQ     5,,PR3

      294    13598    7                                    END;

      295    13599    6                               END;

  13599  2 000161   200036 054100                    AOS     I,,AUTO
         2 000162   200004 470500                    LDP0    TEMP$,,AUTO
         2 000163   000001 236100                    LDQ     1,,PR0
         2 000164   000022 772000                    QRL     18
         2 000165   200036 116100                    CMPQ    I,,AUTO
         2 000166   000124 605400 2                  TPNZ    s:13592

      296    13600    5                          END;

  13600  2 000167   000174 710000 2                  TRA     s:13605

      297    13601    5                       ELSE DO;

      298    13602    5                            ZITEM.SUBSTART$ = ADDR(NIL);

  13602  2 000170   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000171   200065 470500                    LDP0    ZITEM$,,AUTO
         2 000172   000004 756100                    STQ     4,,PR0

      299    13603    5                            ZITEM.SUBSZ = 0;

  13603  2 000173   000005 450100                    STZ     5,,PR0

      300    13604    5                          END;

      301    13605    4                       SDD$ = S_D.D$;

  13605  2 000174   000000 470400 xsym               LDP0    S_D$
         2 000175   000044 236100                    LDQ     36,,PR0
         2 000176   200064 756100                    STQ     SDD$,,AUTO
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:50   

      302    13606    4                     END;                  /* Build subscript reference */

      303    13607    3                  EXPR_IDX = 1 + BITBIN(ARRAY_FLAG);

  13607  2 000177   200014 236100                    LDQ     ARRAY_FLAG,,AUTO
         2 000200   000043 772000                    QRL     35
         2 000201   000001 036007                    ADLQ    1,DL
         2 000202   200061 756100                    STQ     EXPR_IDX,,AUTO

      304    13608    3                  IF ROOT$ -> O.NSUBLKS > EXPR_IDX

  13608  2 000203   200005 471500                    LDP1    ROOT$,,AUTO
         2 000204   100001 236100                    LDQ     1,,PR1
         2 000205   000022 772000                    QRL     18
         2 000206   200061 116100                    CMPQ    EXPR_IDX,,AUTO
         2 000207   000230 604400 2                  TMOZ    s:13617

      305    13609    4                  THEN DO;                 /* Build address expression modifier */

      306    13610    4                       CALL DDD$ADDREXP(ROOT$,EXPR_IDX) ALTRET(VERR);

  13610  2 000210   200061 633500                    EPPR3   EXPR_IDX,,AUTO
         2 000211   200161 453500                    STP3    CNT+3,,AUTO
         2 000212   200005 634500                    EPPR4   ROOT$,,AUTO
         2 000213   200160 454500                    STP4    CNT+2,,AUTO
         2 000214   200160 630500                    EPPR0   CNT+2,,AUTO
         2 000215   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000216   000000 701000 xent               TSX1    DDD$ADDREXP
         2 000217   003546 702000 2                  TSX2    VERR

      307    13611    4                       SDD$ = S_D.D$;

  13611  2 000220   000000 470400 xsym               LDP0    S_D$
         2 000221   000044 236100                    LDQ     36,,PR0
         2 000222   200064 756100                    STQ     SDD$,,AUTO

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:51   
      308    13612    4                       ADDREXP_FLAG = '1'B;

  13612  2 000223   400000 236003                    LDQ     -131072,DU
         2 000224   200016 756100                    STQ     ADDREXP_FLAG,,AUTO

      309    13613    4                       ZITEM.FLAGS.ADDREXP = '1'B;

  13613  2 000225   200065 471500                    LDP1    ZITEM$,,AUTO
         2 000226   020000 236003                    LDQ     8192,DU
         2 000227   100001 256100                    ORSQ    1,,PR1

      310    13614    4                     END;                  /* Build address expression modifier */

      311    13615    3                END;                       /* Process subref / addrexp */

      312    13616                                                /**/
      313    13617    2             TEMP$ = ROOT$ -> O.SUBLK$(0);

  13617  2 000230   200005 471500                    LDP1    ROOT$,,AUTO
         2 000231   100003 236100                    LDQ     3,,PR1
         2 000232   200004 756100                    STQ     TEMP$,,AUTO

      314    13618    2             IF TEMP$ -> O.NSUBLKS = 1

  13618  2 000233   200004 473500                    LDP3    TEMP$,,AUTO
         2 000234   300001 220100                    LDX0    1,,PR3
         2 000235   000001 100003                    CMPX0   1,DU
         2 000236   000242 601000 2                  TNZ     s:13620

      315    13619    2             THEN NQFLAG = '1'B;

  13619  2 000237   400000 236003                    LDQ     -131072,DU
         2 000240   200012 756100                    STQ     NQFLAG,,AUTO
         2 000241   000243 710000 2                  TRA     s:13621

      316    13620    2             ELSE NQFLAG = '0'B;

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:52   
  13620  2 000242   200012 450100                    STZ     NQFLAG,,AUTO

      317    13621    2             SYM2$ = TEMP$ -> O.SUBLK$(0); /* 1st sym or qtstring of list */

  13621  2 000243   300003 236100                    LDQ     3,,PR3
         2 000244   200007 756100                    STQ     SYM2$,,AUTO

      318    13622    2             SYM$ = SYM2$ -> O.SUBLK$(0);  /* Actual textc */

  13622  2 000245   200007 474500                    LDP4    SYM2$,,AUTO
         2 000246   400003 236100                    LDQ     3,,PR4
         2 000247   200006 756100                    STQ     SYM$,,AUTO

      319    13623    2             IF NQFLAG

  13623  2 000250   200012 234100                    SZN     NQFLAG,,AUTO
         2 000251   000333 605000 2                  TPL     s:13639

      320    13624    3             THEN DO;

      321    13625    3                  CALL DDS$UD_SRCH(SYM$,TEMP1) ALTRET(GOT_UDEF);

  13625  2 000252   200023 635500                    EPPR5   TEMP1,,AUTO
         2 000253   200161 455500                    STP5    CNT+3,,AUTO
         2 000254   200006 636500                    EPPR6   SYM$,,AUTO
         2 000255   200160 456500                    STP6    CNT+2,,AUTO
         2 000256   200160 630500                    EPPR0   CNT+2,,AUTO
         2 000257   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000260   000000 701000 xent               TSX1    DDS$UD_SRCH
         2 000261   000663 702000 2                  TSX2    GOT_UDEF

      322    13626    3                  IF (S_D.PATCH OR S_D.RUM)

  13626  2 000262   000000 470400 xsym               LDP0    S_D$
         2 000263   004754 234100                    SZN     2540,,PR0
         2 000264   000267 604000 2                  TMI     s:13628
         2 000265   004755 234100                    SZN     2541,,PR0
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:53   
         2 000266   000307 605000 2                  TPL     s:13631

      323    13627    4                  THEN DO;  /* Speed up patching, by searching for ENTDEFs first */

      324    13628    4                       CALL DDS$ED_SRCH(SYM$, ENTRY$) ALTRET(GOT_EDEF);

  13628  2 000267   200010 631500                    EPPR1   ENTRY$,,AUTO
         2 000270   200161 451500                    STP1    CNT+3,,AUTO
         2 000271   200006 633500                    EPPR3   SYM$,,AUTO
         2 000272   200160 453500                    STP3    CNT+2,,AUTO
         2 000273   200160 630500                    EPPR0   CNT+2,,AUTO
         2 000274   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000275   000000 701000 xent               TSX1    DDS$ED_SRCH
         2 000276   001052 702000 2                  TSX2    GOT_EDEF

      325    13629    4                       CALL DDS$SD_SRCH (SYM$,ENTRY$) ALTRET (GOT_SDEF);

  13629  2 000277   200010 630500                    EPPR0   ENTRY$,,AUTO
         2 000300   200161 450500                    STP0    CNT+3,,AUTO
         2 000301   200006 631500                    EPPR1   SYM$,,AUTO
         2 000302   200160 451500                    STP1    CNT+2,,AUTO
         2 000303   200160 630500                    EPPR0   CNT+2,,AUTO
         2 000304   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000305   000000 701000 xent               TSX1    DDS$SD_SRCH
         2 000306   000725 702000 2                  TSX2    GOT_SDEF

      326    13630    4                     END;

      327    13631    3                  IF SYM2$ -> O.CODE ~= 15 /* QTSTRING_CODE */

  13631  2 000307   200007 470500                    LDP0    SYM2$,,AUTO
         2 000310   000000 720100                    LXL0    0,,PR0
         2 000311   000017 100003                    CMPX0   15,DU
         2 000312   000333 600000 2                  TZE     s:13639

      328    13632    4                  THEN DO;

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:54   
      329    13633    4                       CALL DDS$D_SRCH(SYM$, SITEM_VAL)

  13633  2 000313   200023 631500                    EPPR1   TEMP1,,AUTO
         2 000314   200161 451500                    STP1    CNT+3,,AUTO
         2 000315   200006 633500                    EPPR3   SYM$,,AUTO
         2 000316   200160 453500                    STP3    CNT+2,,AUTO
         2 000317   200160 630500                    EPPR0   CNT+2,,AUTO
         2 000320   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000321   000000 701000 xent               TSX1    DDS$D_SRCH
         2 000322   000523 702000 2                  TSX2    GOT_DESC

      330    13634    4                         ALTRET(GOT_DESC);
      331    13635    4                       CALL DDS$SP_SRCH(SYM$, SITEM_VAL)

  13635  2 000323   200023 630500                    EPPR0   TEMP1,,AUTO
         2 000324   200161 450500                    STP0    CNT+3,,AUTO
         2 000325   200006 631500                    EPPR1   SYM$,,AUTO
         2 000326   200160 451500                    STP1    CNT+2,,AUTO
         2 000327   200160 630500                    EPPR0   CNT+2,,AUTO
         2 000330   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000331   000000 701000 xent               TSX1    DDS$SP_SRCH
         2 000332   000546 702000 2                  TSX2    GOT_SPEC

      332    13636    4                         ALTRET(GOT_SPEC);
      333    13637    4                     END;

      334    13638    3                END;

      335    13639    2             XQUAL = '0'B;

  13639  2 000333   200020 450100                    STZ     XQUAL,,AUTO

      336    13640    2             CALL DDS$V_SRCH(TEMP$,ENTRY$,ENTRY#) ALTRET(GOT_VAR);

  13640  2 000334   200070 630500                    EPPR0   ENTRY#,,AUTO
         2 000335   200162 450500                    STP0    CNT+4,,AUTO
         2 000336   200010 631500                    EPPR1   ENTRY$,,AUTO
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:55   
         2 000337   200161 451500                    STP1    CNT+3,,AUTO
         2 000340   200004 633500                    EPPR3   TEMP$,,AUTO
         2 000341   200160 453500                    STP3    CNT+2,,AUTO
         2 000342   200160 630500                    EPPR0   CNT+2,,AUTO
         2 000343   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000344   000000 701000 xent               TSX1    DDS$V_SRCH
         2 000345   001113 702000 2                  TSX2    GOT_VAR

      337    13641    2             HIGH_ENTRY# = ENTRY#.C;

  13641  2 000346   200070 235100                    LDA     ENTRY#,,AUTO
         2 000347   200011 755100                    STA     HIGH_ENTRY#,,AUTO

      338    13642    2             IF S_D.XSCH.OK

  13642  2 000350   000000 470400 xsym               LDP0    S_D$
         2 000351   000751 234100                    SZN     489,,PR0
         2 000352   000405 605000 2                  TPL     s:13652

      339    13643    3             THEN DO;

      340    13644    3                  CALL DDS$SET_Q2T;        /* REMEMBER Q'S */

  13644  2 000353   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000354   000000 701000 xent               TSX1    DDS$SET_Q2T
         2 000355   000000 011000                    NOP     0

      341    13645    3                  CALL DDS$SET_X2Q ALTRET( BADSCHEMA ); /* ESTABL. SPECIAL'S */

  13645  2 000356   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000357   000000 701000 xent               TSX1    DDS$SET_X2Q
         2 000360   003543 702000 2                  TSX2    BADSCHEMA

      342    13646    3                  XQUAL = '1'B;

  13646  2 000361   400000 236003                    LDQ     -131072,DU
         2 000362   200020 756100                    STQ     XQUAL,,AUTO
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:56   

      343    13647    3                  CALL DDS$V_SRCH(TEMP$, ENTRY$, ENTRY#) ALTRET(GOT_VAR);

  13647  2 000363   200070 630500                    EPPR0   ENTRY#,,AUTO
         2 000364   200162 450500                    STP0    CNT+4,,AUTO
         2 000365   200010 631500                    EPPR1   ENTRY$,,AUTO
         2 000366   200161 451500                    STP1    CNT+3,,AUTO
         2 000367   200004 633500                    EPPR3   TEMP$,,AUTO
         2 000370   200160 453500                    STP3    CNT+2,,AUTO
         2 000371   200160 630500                    EPPR0   CNT+2,,AUTO
         2 000372   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000373   000000 701000 xent               TSX1    DDS$V_SRCH
         2 000374   001113 702000 2                  TSX2    GOT_VAR

      344    13648    3                  IF ENTRY#.C > HIGH_ENTRY#

  13648  2 000375   200011 236100                    LDQ     HIGH_ENTRY#,,AUTO
         2 000376   200070 116100                    CMPQ    ENTRY#,,AUTO
         2 000377   000402 603000 2                  TRC     s:13650

      345    13649    3                  THEN HIGH_ENTRY# = ENTRY#.C;

  13649  2 000400   200070 235100                    LDA     ENTRY#,,AUTO
         2 000401   200011 755100                    STA     HIGH_ENTRY#,,AUTO

      346    13650    3                  CALL DDS$SET_T2Q ALTRET( BADSCHEMA ); /* RESTORE Q'S */

  13650  2 000402   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000403   000000 701000 xent               TSX1    DDS$SET_T2Q
         2 000404   003543 702000 2                  TSX2    BADSCHEMA

      347    13651    3                END;

      348    13652    2             IF NQFLAG

  13652  2 000405   200012 234100                    SZN     NQFLAG,,AUTO
         2 000406   000430 605000 2                  TPL     s:13657
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:57   

      349    13653    3             THEN DO;

      350    13654    3                  CALL DDS$SD_SRCH(SYM$,ENTRY$) ALTRET(GOT_SDEF);

  13654  2 000407   200010 630500                    EPPR0   ENTRY$,,AUTO
         2 000410   200161 450500                    STP0    CNT+3,,AUTO
         2 000411   200006 631500                    EPPR1   SYM$,,AUTO
         2 000412   200160 451500                    STP1    CNT+2,,AUTO
         2 000413   200160 630500                    EPPR0   CNT+2,,AUTO
         2 000414   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000415   000000 701000 xent               TSX1    DDS$SD_SRCH
         2 000416   000725 702000 2                  TSX2    GOT_SDEF

      351    13655    3                  CALL DDS$ED_SRCH(SYM$,ENTRY$) ALTRET(GOT_EDEF);

  13655  2 000417   200010 630500                    EPPR0   ENTRY$,,AUTO
         2 000420   200161 450500                    STP0    CNT+3,,AUTO
         2 000421   200006 631500                    EPPR1   SYM$,,AUTO
         2 000422   200160 451500                    STP1    CNT+2,,AUTO
         2 000423   200160 630500                    EPPR0   CNT+2,,AUTO
         2 000424   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000425   000000 701000 xent               TSX1    DDS$ED_SRCH
         2 000426   001052 702000 2                  TSX2    GOT_EDEF

      352    13656    3                END;

  13656  2 000427   000435 710000 2                  TRA     s:13659

      353    13657    2             ELSE SYM$ = TEMP$ -> O.SUBLK$(HIGH_ENTRY#) -> O.SUBLK$(0);

  13657  2 000430   200004 470500                    LDP0    TEMP$,,AUTO
         2 000431   200011 720100                    LXL0    HIGH_ENTRY#,,AUTO
         2 000432   000003 471510                    LDP1    3,X0,PR0
         2 000433   100003 236100                    LDQ     3,,PR1
         2 000434   200006 756100                    STQ     SYM$,,AUTO

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:58   
      354    13658                                                /* Not found, must be an error */
      355    13659    2             S_D.ERROR = 3;   /* E@SYM_NOTFOUND */

  13659  2 000435   000003 235007                    LDA     3,DL
         2 000436   000000 470400 xsym               LDP0    S_D$
         2 000437   000013 755100                    STA     11,,PR0

      356    13660    2             S_D.ERROR_SYM$ = SYM$;

  13660  2 000440   200006 236100                    LDQ     SYM$,,AUTO
         2 000441   000032 756100                    STQ     26,,PR0

      357    13661    2             ALTRETURN;

  13661  2 000442   000000 702200 xent               TSX2  ! X66_AALT

      358    13662    2           END;                            /* Build variable reference */
      359    13663                                                /**/
      360    13664    2        ELSE DO;                           /* Build simple expression item */

      361    13665    2             IF S_D.QUALIFIED

  13665  2 000443   000712 234100                    SZN     458,,PR0
         2 000444   000450 605000 2                  TPL     s:13670

      362    13666    3             THEN DO;

      363    13667    3                  S_D.ERROR = 52; /* E@INVLDQUAL */

  13667  2 000445   000064 235007                    LDA     52,DL
         2 000446   000013 755100                    STA     11,,PR0

      364    13668    3                  ALTRETURN;

  13668  2 000447   000000 702200 xent               TSX2  ! X66_AALT

      365    13669    3                END;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:59   
      366    13670    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  13670  2 000450   006714 235100                    LDA     3532,,PR0
         2 000451   000001 115007                    CMPA    1,DL
         2 000452   000460 601000 2                  TNZ     s:13672

      367    13671    2             THEN DITEM = DUMSIZE;

  13671  2 000453   200064 475500                    LDP5    SDD$,,AUTO
         2 000454   000100 100400                    MLR     fill='000'O
         2 000455   000002 000010 1                  ADSC9   DUMSIZE                  cn=0,n=8
         2 000456   500000 000014                    ADSC9   0,,PR5                   cn=0,n=12
         2 000457   000464 710000 2                  TRA     s:13673

      368    13672    2             ELSE DITEM = DUMSIZE_L6;

  13672  2 000460   200064 475500                    LDP5    SDD$,,AUTO
         2 000461   000100 100400                    MLR     fill='000'O
         2 000462   000004 000010 1                  ADSC9   DUMSIZE_L6               cn=0,n=8
         2 000463   500000 000014                    ADSC9   0,,PR5                   cn=0,n=12

      369    13673    2             CALL DDD$SIMEXP(ROOT$, TEMP1, DITEM.FLAGS.OFLAG) ALTRET(VERR);

  13673  2 000464   200064 236100                    LDQ     SDD$,,AUTO
         2 000465   200000 036007                    ADLQ    65536,DL
         2 000466   200162 756100                    STQ     CNT+4,,AUTO
         2 000467   200023 634500                    EPPR4   TEMP1,,AUTO
         2 000470   200161 454500                    STP4    CNT+3,,AUTO
         2 000471   200005 636500                    EPPR6   ROOT$,,AUTO
         2 000472   200160 456500                    STP6    CNT+2,,AUTO
         2 000473   200160 630500                    EPPR0   CNT+2,,AUTO
         2 000474   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000475   000000 701000 xent               TSX1    DDD$SIMEXP
         2 000476   003546 702000 2                  TSX2    VERR

      370    13674    2             ZITEM.VALUE = TEMP1;

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:60   
  13674  2 000477   200023 235100                    LDA     TEMP1,,AUTO
         2 000500   200065 470500                    LDP0    ZITEM$,,AUTO
         2 000501   000007 755100                    STA     7,,PR0

      371    13675    2             IF BASED_FLAG

  13675  2 000502   200013 234100                    SZN     BASED_FLAG,,AUTO
         2 000503   000507 605000 2                  TPL     s:13677

      372    13676    2             THEN ZITEM.ADDR_TYPE = %BIGBASED_ACODE; /* BIGBASED_ACODE */

  13676  2 000504   000103 236003                    LDQ     67,DU
         2 000505   000006 552120                    STBQ    6,'20'O,PR0
         2 000506   000511 710000 2                  TRA     s:13678

      373    13677    2             ELSE ZITEM.ADDR_TYPE = %BIGSTATIC_ACODE; /* BIGSTATIC_ACODE */

  13677  2 000507   000104 236003                    LDQ     68,DU
         2 000510   000006 552120                    STBQ    6,'20'O,PR0

      374    13678    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  13678  2 000511   000000 471400 xsym               LDP1    S_D$
         2 000512   106714 235100                    LDA     3532,,PR1
         2 000513   000001 115007                    CMPA    1,DL
         2 000514   000520 601000 2                  TNZ     s:13680

      375    13679    2             THEN ZITEM.DATA_TYPE = %OCT_DATATYPE; /* OCT_DATATYPE */

  13679  2 000515   000070 236007                    LDQ     56,DL
         2 000516   000006 552104                    STBQ    6,'04'O,PR0
         2 000517   000522 710000 2                  TRA     s:13682

      376    13680    2             ELSE ZITEM.DATA_TYPE = %X_DATATYPE; /* X_DATATYPE */

  13680  2 000520   000071 236007                    LDQ     57,DL
         2 000521   000006 552104                    STBQ    6,'04'O,PR0
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:61   

      377    13681    2           END;

      378    13682    1        GOTO DONE;

  13682  2 000522   003325 710000 2                  TRA     DONE

      379    13683                                                /*
      380    13684                                                Come here to build desc / ptr  entry
      381    13685                                                */
      382    13686    1   GOT_DESC:
      383    13687    1        ZITEM.ADDR_TYPE = %DESC_ACODE;     /* DESC_ACODE */

  13687  2 000523   200065 470500       GOT_DESC     LDP0    ZITEM$,,AUTO
         2 000524   000100 236003                    LDQ     64,DU
         2 000525   000006 552120                    STBQ    6,'20'O,PR0

      384    13688    1        IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6 AND

  13688  2 000526   000000 471400 xsym               LDP1    S_D$
         2 000527   106714 235100                    LDA     3532,,PR1
         2 000530   000002 115007                    CMPA    2,DL
         2 000531   000545 601000 2                  TNZ     s:13695
         2 000532   200023 236100                    LDQ     TEMP1,,AUTO
         2 000533   770000 376003                    ANQ     -4096,DU
         2 000534   030000 116003                    CMPQ    12288,DU
         2 000535   000545 601000 2                  TNZ     s:13695
         2 000536   200023 236100                    LDQ     TEMP1,,AUTO
         2 000537   007770 376003                    ANQ     4088,DU
         2 000540   000030 116003                    CMPQ    24,DU
         2 000541   000545 601000 2                  TNZ     s:13695

      385    13689    1          SDITEM_VAL.TYPE = 3 AND
      386    13690    1          SDITEM_VAL.ID = 3
      387    13691    2        THEN DO;

      388    13692    2             S_D.ERROR = 41;         /* E@NODISP */
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:62   

  13692  2 000542   000051 235007                    LDA     41,DL
         2 000543   100013 755100                    STA     11,,PR1

      389    13693    2             ALTRETURN;

  13693  2 000544   000000 702200 xent               TSX2  ! X66_AALT

      390    13694    2           END;
      391    13695    1        GOTO SPEC_DESC;

  13695  2 000545   000604 710000 2                  TRA     SPEC_DESC

      392    13696                                                /*   Come here to build spec entry */
      393    13697    1   GOT_SPEC:
      394    13698    1        ZITEM.ADDR_TYPE = %SPEC_ACODE;     /* SPEC_ACODE */

  13698  2 000546   200065 470500       GOT_SPEC     LDP0    ZITEM$,,AUTO
         2 000547   000101 236003                    LDQ     65,DU
         2 000550   000006 552120                    STBQ    6,'20'O,PR0

      395    13699    1        IF ADDREXP_FLAG AND NOT
             13699                 /* Address expression and not $O, $I, $L, @, @@, #, ##, $NA */

  13699  2 000551   200016 234100                    SZN     ADDREXP_FLAG,,AUTO
         2 000552   000604 605000 2                  TPL     SPEC_DESC
         2 000553   200023 236100                    LDQ     TEMP1,,AUTO
         2 000554   777000 316003                    CANQ    -512,DU
         2 000555   000604 600000 2                  TZE     SPEC_DESC
         2 000556   200023 236100                    LDQ     TEMP1,,AUTO
         2 000557   777000 376003                    ANQ     -512,DU
         2 000560   001000 116003                    CMPQ    512,DU
         2 000561   000604 600000 2                  TZE     SPEC_DESC
         2 000562   002000 116003                    CMPQ    1024,DU
         2 000563   000604 600000 2                  TZE     SPEC_DESC
         2 000564   040000 116003                    CMPQ    16384,DU
         2 000565   000604 600000 2                  TZE     SPEC_DESC
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:63   
         2 000566   041000 116003                    CMPQ    16896,DU
         2 000567   000604 600000 2                  TZE     SPEC_DESC
         2 000570   042000 116003                    CMPQ    17408,DU
         2 000571   000604 600000 2                  TZE     SPEC_DESC
         2 000572   043000 116003                    CMPQ    17920,DU
         2 000573   000604 600000 2                  TZE     SPEC_DESC
         2 000574   060000 116003                    CMPQ    24576,DU
         2 000575   000604 600000 2                  TZE     SPEC_DESC
         2 000576   037000 116003                    CMPQ    15872,DU
         2 000577   000604 600000 2                  TZE     SPEC_DESC

      396    13700    1          (SITEM_VAL.ID = %O_RTN OR        /* O_RTN */
      397    13701    1          SITEM_VAL.ID = %I_RTN OR         /* I_RTN */
      398    13702    1          SITEM_VAL.ID = %L_RTN OR         /* L_RTN */
      399    13703    1          SITEM_VAL.ID = %@_RTN OR         /* @_RTN */
      400    13704    1          SITEM_VAL.ID = %@@_RTN OR        /* @@_RTN */
      401    13705    1          SITEM_VAL.ID = %#_RTN OR         /* #_RTN */
      402    13706    1          SITEM_VAL.ID = %##_RTN OR        /* ##_RTN */
      403    13707    1          SITEM_VAL.ID = %N_RTN OR         /* N_RTN */
      404    13708    1          SITEM_VAL.ID = %NA_RTN)          /* NA_RTN */
      405    13709    2        THEN DO;

      406    13710    2             S_D.ERROR = 87;    /* E@EXPNOTVALID */

  13710  2 000600   000127 235007                    LDA     87,DL
         2 000601   000000 471400 xsym               LDP1    S_D$
         2 000602   100013 755100                    STA     11,,PR1

      407    13711    2             ALTRETURN;

  13711  2 000603   000000 702200 xent               TSX2  ! X66_AALT

      408    13712    2           END;
      409    13713    1   SPEC_DESC:
      410    13714    1        IF BASED_FLAG OR ARRAY_FLAG

  13714  2 000604   200013 234100       SPEC_DESC    SZN     BASED_FLAG,,AUTO
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:64   
         2 000605   000610 604000 2                  TMI     s:13716
         2 000606   200014 234100                    SZN     ARRAY_FLAG,,AUTO
         2 000607   000616 605000 2                  TPL     s:13720

      411    13715    2        THEN DO;

      412    13716    2             S_D.ERROR = 4;     /* E@INVLD_SPEC */

  13716  2 000610   000004 235007                    LDA     4,DL
         2 000611   000000 471400 xsym               LDP1    S_D$
         2 000612   100013 755100                    STA     11,,PR1

      413    13717    2             S_D.ERROR_SYM$ = SYM$;

  13717  2 000613   200006 236100                    LDQ     SYM$,,AUTO
         2 000614   100032 756100                    STQ     26,,PR1

      414    13718    2             ALTRETURN;

  13718  2 000615   000000 702200 xent               TSX2  ! X66_AALT

      415    13719    2           END;
      416    13720    1        ZITEM.VALUEB = SITEM_VAL;

  13720  2 000616   200023 236100                    LDQ     TEMP1,,AUTO
         2 000617   000007 756100                    STQ     7,,PR0

      417    13721    1        ZITEM.FMT_SPEC = SITEM_VAL.FMT;

  13721  2 000620   200023 236100                    LDQ     TEMP1,,AUTO
         2 000621   000077 376007                    ANQ     63,DL
         2 000622   000011 736000                    QLS     9
         2 000623   000006 552110                    STBQ    6,'10'O,PR0

      418    13722    1        ZITEM.DTYP = %SPEC_DTYP;           /* SPEC_DTYP */

  13722  2 000624   000003 236003                    LDQ     3,DU
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:65   
         2 000625   000001 552120                    STBQ    1,'20'O,PR0

      419    13723    1        ZITEM.FLAGS = SITEM_VAL.FLAGS;

  13723  2 000626   200023 236100                    LDQ     TEMP1,,AUTO
         2 000627   007700 376007                    ANQ     4032,DL
         2 000630   000030 736000                    QLS     24
         2 000631   000001 552140                    STBQ    1,'40'O,PR0

      420    13724    1        IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  13724  2 000632   000000 471400 xsym               LDP1    S_D$
         2 000633   106714 235100                    LDA     3532,,PR1
         2 000634   000001 115007                    CMPA    1,DL
         2 000635   000643 601000 2                  TNZ     s:13727

      421    13725    1        THEN DITEM = DUMSIZE;

  13725  2 000636   200064 473500                    LDP3    SDD$,,AUTO
         2 000637   000100 100400                    MLR     fill='000'O
         2 000640   000002 000010 1                  ADSC9   DUMSIZE                  cn=0,n=8
         2 000641   300000 000014                    ADSC9   0,,PR3                   cn=0,n=12
         2 000642   000662 710000 2                  TRA     s:13731

      422    13726    2        ELSE DO;

      423    13727    2             DITEM = DUMSIZE_L6;

  13727  2 000643   200064 473500                    LDP3    SDD$,,AUTO
         2 000644   000100 100400                    MLR     fill='000'O
         2 000645   000004 000010 1                  ADSC9   DUMSIZE_L6               cn=0,n=8
         2 000646   300000 000014                    ADSC9   0,,PR3                   cn=0,n=12

      424    13728    2             IF ZITEM.SP.VS.SZ ~= 0 AND ZITEM.ADDR_TYPE = %SPEC_ACODE

  13728  2 000647   000007 236100                    LDQ     7,,PR0
         2 000650   000777 316003                    CANQ    511,DU
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:66   
         2 000651   000662 600000 2                  TZE     s:13731
         2 000652   000006 236100                    LDQ     6,,PR0
         2 000653   000777 376003                    ANQ     511,DU
         2 000654   000101 116003                    CMPQ    65,DU
         2 000655   000662 601000 2                  TNZ     s:13731

      425    13729    2             THEN DITEM.VALUE = ZITEM.SP.VS.SZ;

  13729  2 000656   000007 236100                    LDQ     7,,PR0
         2 000657   000022 772000                    QRL     18
         2 000660   000777 376007                    ANQ     511,DL
         2 000661   300001 756100                    STQ     1,,PR3

      426    13730    2           END;

      427    13731    1        GOTO DONE;

  13731  2 000662   003325 710000 2                  TRA     DONE

      428    13732                                                /*
      429    13733                                                 Come here to build user defined symbol
      430    13734                                                 */
      431    13735    1   GOT_UDEF:
      432    13736    1        IF ARRAY_FLAG

  13736  2 000663   200014 234100       GOT_UDEF     SZN     ARRAY_FLAG,,AUTO
         2 000664   000673 605000 2                  TPL     s:13742

      433    13737    2        THEN DO;

      434    13738    2             S_D.ERROR = 6;      /* E@SUBSCRIPT */

  13738  2 000665   000006 235007                    LDA     6,DL
         2 000666   000000 470400 xsym               LDP0    S_D$
         2 000667   000013 755100                    STA     11,,PR0

      435    13739    2             S_D.ERROR_SYM$ = SYM$;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:67   

  13739  2 000670   200006 236100                    LDQ     SYM$,,AUTO
         2 000671   000032 756100                    STQ     26,,PR0

      436    13740    2             ALTRETURN;

  13740  2 000672   000000 702200 xent               TSX2  ! X66_AALT

      437    13741    2           END;
      438    13742    1        ZITEM.DATA_TYPE = %INST_DATATYPE;  /* INST_DATATYPE */

  13742  2 000673   200065 470500                    LDP0    ZITEM$,,AUTO
         2 000674   000067 236007                    LDQ     55,DL
         2 000675   000006 552104                    STBQ    6,'04'O,PR0

      439    13743    1        IF BASED_FLAG

  13743  2 000676   200013 234100                    SZN     BASED_FLAG,,AUTO
         2 000677   000703 605000 2                  TPL     s:13745

      440    13744    1        THEN ZITEM.ADDR_TYPE = %BIGBASED_ACODE; /* BIGBASED_ACODE */

  13744  2 000700   000103 236003                    LDQ     67,DU
         2 000701   000006 552120                    STBQ    6,'20'O,PR0
         2 000702   000705 710000 2                  TRA     s:13746

      441    13745    1        ELSE ZITEM.ADDR_TYPE = %BIGSTATIC_ACODE; /* BIGSTATIC_ACODE */

  13745  2 000703   000104 236003                    LDQ     68,DU
         2 000704   000006 552120                    STBQ    6,'20'O,PR0

      442    13746    1        ZITEM.VALUE = TEMP1;

  13746  2 000705   200023 235100                    LDA     TEMP1,,AUTO
         2 000706   000007 755100                    STA     7,,PR0

      443    13747    1        IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:68   

  13747  2 000707   000000 471400 xsym               LDP1    S_D$
         2 000710   106714 235100                    LDA     3532,,PR1
         2 000711   000001 115007                    CMPA    1,DL
         2 000712   000720 601000 2                  TNZ     s:13749

      444    13748    1        THEN DITEM = DUMSIZE;

  13748  2 000713   200064 473500                    LDP3    SDD$,,AUTO
         2 000714   000100 100400                    MLR     fill='000'O
         2 000715   000002 000010 1                  ADSC9   DUMSIZE                  cn=0,n=8
         2 000716   300000 000014                    ADSC9   0,,PR3                   cn=0,n=12
         2 000717   000724 710000 2                  TRA     s:13750

      445    13749    1        ELSE DITEM = DUMSIZE_L6;

  13749  2 000720   200064 473500                    LDP3    SDD$,,AUTO
         2 000721   000100 100400                    MLR     fill='000'O
         2 000722   000004 000010 1                  ADSC9   DUMSIZE_L6               cn=0,n=8
         2 000723   300000 000014                    ADSC9   0,,PR3                   cn=0,n=12

      446    13750    1        GOTO DONE;

  13750  2 000724   003325 710000 2                  TRA     DONE

      447    13751                                                /*
      448    13752                                                 Come here to build SYMDEF entry
      449    13753                                                 */
      450    13754    1   GOT_SDEF:
      451    13755    1        IF ARRAY_FLAG

  13755  2 000725   200014 234100       GOT_SDEF     SZN     ARRAY_FLAG,,AUTO
         2 000726   000735 605000 2                  TPL     s:13761

      452    13756    2        THEN DO;

      453    13757    2             S_D.ERROR = 6;      /* E@SUBSCRIPT */
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:69   

  13757  2 000727   000006 235007                    LDA     6,DL
         2 000730   000000 470400 xsym               LDP0    S_D$
         2 000731   000013 755100                    STA     11,,PR0

      454    13758    2             S_D.ERROR_SYM$ = SYM$;

  13758  2 000732   200006 236100                    LDQ     SYM$,,AUTO
         2 000733   000032 756100                    STQ     26,,PR0

      455    13759    2             ALTRETURN;

  13759  2 000734   000000 702200 xent               TSX2  ! X66_AALT

      456    13760    2           END;
      457    13761    1        IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  13761  2 000735   000000 470400 xsym               LDP0    S_D$
         2 000736   006714 235100                    LDA     3532,,PR0
         2 000737   000001 115007                    CMPA    1,DL
         2 000740   000746 601000 2                  TNZ     s:13763

      458    13762    1        THEN DITEM = DUMSIZE;

  13762  2 000741   200064 471500                    LDP1    SDD$,,AUTO
         2 000742   000100 100400                    MLR     fill='000'O
         2 000743   000002 000010 1                  ADSC9   DUMSIZE                  cn=0,n=8
         2 000744   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12
         2 000745   000752 710000 2                  TRA     s:13764

      459    13763    1        ELSE DITEM = DUMSIZE_L6;

  13763  2 000746   200064 471500                    LDP1    SDD$,,AUTO
         2 000747   000100 100400                    MLR     fill='000'O
         2 000750   000004 000010 1                  ADSC9   DUMSIZE_L6               cn=0,n=8
         2 000751   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:70   
      460    13764    1        IF B$SDEF.CONSTNT

  13764  2 000752   200010 473500                    LDP3    ENTRY$,,AUTO
         2 000753   300001 236100                    LDQ     1,,PR3
         2 000754   400000 316007                    CANQ    -131072,DL
         2 000755   001030 600000 2                  TZE     s:13788

      461    13765    2        THEN DO;

      462    13766    2             IF BASED_FLAG

  13766  2 000756   200013 234100                    SZN     BASED_FLAG,,AUTO
         2 000757   000765 605000 2                  TPL     s:13774

      463    13767    3             THEN DO;

      464    13768    3                  S_D.ERROR = 5;      /* E@SDEF */

  13768  2 000760   000005 235007                    LDA     5,DL
         2 000761   000013 755100                    STA     11,,PR0

      465    13769    3                  S_D.ERROR_SYM$ = SYM$;

  13769  2 000762   200006 236100                    LDQ     SYM$,,AUTO
         2 000763   000032 756100                    STQ     26,,PR0

      466    13770    3                  ALTRETURN;

  13770  2 000764   000000 702200 xent               TSX2  ! X66_AALT

      467    13771    3                END;
      468    13772    3             ELSE DO;

      469    13773                                                /* Build implicit $DCB ptr to DCB */
      470    13774    3                  T$ = SDD$;

  13774  2 000765   200064 236100                    LDQ     SDD$,,AUTO
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:71   
         2 000766   200044 756100                    STQ     T$,,AUTO

      471    13775    3                  CALL BUMPD$ ALTRET(VERR);

  13775  2 000767   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000770   200155 756100                    STQ     ENTRY#+53,,AUTO
         2 000771   003707 701000 2                  TSX1    BUMPD$
         2 000772   003546 702000 2                  TSX2    VERR

      472    13776    4                  DO WHILE(T$ >= IPTR$);

  13776  2 000773   200044 236100                    LDQ     T$,,AUTO
         2 000774   200045 116100                    CMPQ    IPTR$,,AUTO
         2 000775   001006 602000 2                  TNC     s:13780

      473    13777    4                       PINCRW(T$, SIZEW(DITEM)) -> UBIN36 = T$ -> UBIN36;

  13777  2 000776   200044 470500                    LDP0    T$,,AUTO
         2 000777   000000 235100                    LDA     0,,PR0
         2 001000   000003 755100                    STA     3,,PR0

      474    13778    4                       T$ = PINCRW(T$, -1);

  13778  2 001001   200044 236100                    LDQ     T$,,AUTO
         2 001002   777777 036003                    ADLQ    -1,DU
         2 001003   200044 756100                    STQ     T$,,AUTO

      475    13779    4                     END;                  /* DO WHILE (T$ >= SDD$) */

  13779  2 001004   200045 116100                    CMPQ    IPTR$,,AUTO
         2 001005   000776 603000 2                  TRC     s:13777

      476    13780    3                  SITEM_VAL = DESC.ITEM(%DCB_DESC);

  13780  2 001006   000071 236000 xsym               LDQ     DESC+57
         2 001007   200023 756100                    STQ     TEMP1,,AUTO

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:72   
      477    13781    3                  IPTR$ -> DITEM.VALUEB = SITEM_VAL;

  13781  2 001010   200045 470500                    LDP0    IPTR$,,AUTO
         2 001011   000001 756100                    STQ     1,,PR0

      478    13782    3                  IPTR$ -> DITEM.SP.VD.DISP = B$SDEF.VALUE;

  13782  2 001012   200010 471500                    LDP1    ENTRY$,,AUTO
         2 001013   100000 236100                    LDQ     0,,PR1
         2 001014   000014 736000                    QLS     12
         2 001015   000001 676100                    ERQ     1,,PR0
         2 001016   000002 376000 3                  ANQ     2
         2 001017   000001 656100                    ERSQ    1,,PR0

      479    13783    3                  IPTR$ -> DITEM.ADDR_TYPE = %DESC_ACODE; /* DESC_ACODE */

  13783  2 001020   100000 236007                    LDQ     32768,DL
         2 001021   000000 552110                    STBQ    0,'10'O,PR0

      480    13784    3                  IPTR$ -> DITEM.TYPE_CODE = %PTR_ICODE; /* PTR_ICODE */

  13784  2 001022   000001 236007                    LDQ     1,DL
         2 001023   000000 552104                    STBQ    0,'04'O,PR0

      481    13785    3                  ZITEM.ADDR_TYPE = %BASED_ACODE; /* BASED_ACODE */

  13785  2 001024   200065 471500                    LDP1    ZITEM$,,AUTO
         2 001025   000002 236003                    LDQ     2,DU
         2 001026   100006 552120                    STBQ    6,'20'O,PR1

      482    13786    3                END;                       /* Build implicit $DCB pointer */

      483    13787    2           END;

  13787  2 001027   001046 710000 2                  TRA     s:13798

      484    13788    1        ELSE IF BASED_FLAG
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:73   

  13788  2 001030   200013 234100                    SZN     BASED_FLAG,,AUTO
         2 001031   001037 605000 2                  TPL     s:13795

      485    13789    2             THEN DO;

      486    13790    2                  S_D.ERROR = 5;      /* E@SDEF */

  13790  2 001032   000005 235007                    LDA     5,DL
         2 001033   000013 755100                    STA     11,,PR0

      487    13791    2                  S_D.ERROR_SYM$ = SYM$;

  13791  2 001034   200006 236100                    LDQ     SYM$,,AUTO
         2 001035   000032 756100                    STQ     26,,PR0

      488    13792    2                  ALTRETURN;

  13792  2 001036   000000 702200 xent               TSX2  ! X66_AALT

      489    13793    2                END;
      490    13794    2             ELSE DO;                 /* Build normal SYMREF address reference */

      491    13795    2                  ZITEM.ADDR_TYPE = %STATIC_ACODE; /* STATIC_ACODE */

  13795  2 001037   200065 474500                    LDP4    ZITEM$,,AUTO
         2 001040   000000 236003                    LDQ     0,DU
         2 001041   400006 552120                    STBQ    6,'20'O,PR4

      492    13796    2                  ZITEM.ADDRESS.W = B$SDEF.AD.ISADDR;

  13796  2 001042   200010 473500                    LDP3    ENTRY$,,AUTO
         2 001043   300000 236100                    LDQ     0,,PR3
         2 001044   000014 736000                    QLS     12
         2 001045   400007 752174                    STCQ    7,'74'O,PR4

      493    13797    2                END;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:74   

      494    13798    1        ZITEM.DATA_TYPE = %OCT_DATATYPE;   /* OCT_DATATYPE  */

  13798  2 001046   200065 470500                    LDP0    ZITEM$,,AUTO
         2 001047   000070 236007                    LDQ     56,DL
         2 001050   000006 552104                    STBQ    6,'04'O,PR0

      495    13799    1        GOTO DONE;

  13799  2 001051   003325 710000 2                  TRA     DONE

      496    13800                                                /*
      497    13801                                                 Come here to build ENTDEF entry
      498    13802                                                 */
      499    13803    1   GOT_EDEF:
      500    13804    1        IF ARRAY_FLAG

  13804  2 001052   200014 234100       GOT_EDEF     SZN     ARRAY_FLAG,,AUTO
         2 001053   001056 604000 2                  TMI     s:13807
         2 001054   200013 234100                    SZN     BASED_FLAG,,AUTO
         2 001055   001064 605000 2                  TPL     s:13811

      501    13805    1          OR BASED_FLAG
      502    13806    2        THEN DO;

      503    13807    2             S_D.ERROR = 32;           /* E@EDEF */

  13807  2 001056   000040 235007                    LDA     32,DL
         2 001057   000000 470400 xsym               LDP0    S_D$
         2 001060   000013 755100                    STA     11,,PR0

      504    13808    2             S_D.ERROR_SYM$ = SYM$;

  13808  2 001061   200006 236100                    LDQ     SYM$,,AUTO
         2 001062   000032 756100                    STQ     26,,PR0

      505    13809    2             ALTRETURN;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:75   

  13809  2 001063   000000 702200 xent               TSX2  ! X66_AALT

      506    13810    2           END;
      507    13811    1        IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  13811  2 001064   000000 470400 xsym               LDP0    S_D$
         2 001065   006714 235100                    LDA     3532,,PR0
         2 001066   000001 115007                    CMPA    1,DL
         2 001067   001075 601000 2                  TNZ     s:13813

      508    13812    1        THEN DITEM = DUMSIZE;

  13812  2 001070   200064 471500                    LDP1    SDD$,,AUTO
         2 001071   000100 100400                    MLR     fill='000'O
         2 001072   000002 000010 1                  ADSC9   DUMSIZE                  cn=0,n=8
         2 001073   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12
         2 001074   001101 710000 2                  TRA     s:13814

      509    13813    1        ELSE DITEM = DUMSIZE_L6;

  13813  2 001075   200064 471500                    LDP1    SDD$,,AUTO
         2 001076   000100 100400                    MLR     fill='000'O
         2 001077   000004 000010 1                  ADSC9   DUMSIZE_L6               cn=0,n=8
         2 001100   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

      510    13814    1        ZITEM.ADDR_TYPE = %STATIC_ACODE;   /* STATIC_ACODE */

  13814  2 001101   200065 473500                    LDP3    ZITEM$,,AUTO
         2 001102   000000 236003                    LDQ     0,DU
         2 001103   300006 552120                    STBQ    6,'20'O,PR3

      511    13815    1        ZITEM.ADDRESS.W = B$EDEF.ISADDR;

  13815  2 001104   200010 474500                    LDP4    ENTRY$,,AUTO
         2 001105   400000 236100                    LDQ     0,,PR4
         2 001106   000014 736000                    QLS     12
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:76   
         2 001107   300007 752174                    STCQ    7,'74'O,PR3

      512    13816    1        ZITEM.DATA_TYPE = %INST_DATATYPE;  /* INST_DATATYPE */

  13816  2 001110   000067 236007                    LDQ     55,DL
         2 001111   300006 552104                    STBQ    6,'04'O,PR3

      513    13817    1        GOTO DONE;

  13817  2 001112   003325 710000 2                  TRA     DONE

      514    13818                                                /*
      515    13819                                                 Come here to build variable entry
      516    13820                                                 */
      517    13821    1   GOT_VAR:
      518    13822                                                /*
      519    13823                                                 Make various consistency checks
      520    13824                                                 */
      521    13825    1        DIMS = 0;

  13825  2 001113   200022 450100       GOT_VAR      STZ     DIMS,,AUTO

      522    13826    1        LEVELDIMS = 0;

  13826  2 001114   200042 450100                    STZ     LEVELDIMS,,AUTO

      523    13827    1        IMPLF4 = '0'B;

  13827  2 001115   200062 450100                    STZ     IMPLF4,,AUTO

      524    13828    2        DO I = 1 TO ENTRY#.C;

  13828  2 001116   000001 235007                    LDA     1,DL
         2 001117   200036 755100                    STA     I,,AUTO
         2 001120   001426 710000 2                  TRA     s:13901+1

      525    13829    2             STRUCT = ENTRY#.C - I +1;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:77   

  13829  2 001121   200070 236100                    LDQ     ENTRY#,,AUTO
         2 001122   200036 136100                    SBLQ    I,,AUTO
         2 001123   000001 036007                    ADLQ    1,DL
         2 001124   200037 756100                    STQ     STRUCT,,AUTO

      526    13830    2             IF ENTRY#.C ~= 1

  13830  2 001125   200070 235100                    LDA     ENTRY#,,AUTO
         2 001126   000001 115007                    CMPA    1,DL
         2 001127   001140 600000 2                  TZE     s:13832

      527    13831    2             THEN CALL DDF$VREBL_#(ENTRY#.E(STRUCT), ENTRY$) ALTRET(BADSCHEMA);

  13831  2 001130   200010 630500                    EPPR0   ENTRY$,,AUTO
         2 001131   200161 450500                    STP0    CNT+3,,AUTO
         2 001132   200071 631506                    EPPR1   ENTRY#+1,QL,AUTO
         2 001133   200160 451500                    STP1    CNT+2,,AUTO
         2 001134   200160 630500                    EPPR0   CNT+2,,AUTO
         2 001135   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001136   000000 701000 xent               TSX1    DDF$VREBL_#
         2 001137   003543 702000 2                  TSX2    BADSCHEMA

      528    13832    2             ARRAYTYP = B$VREBL.ARRAYTYP;

  13832  2 001140   200010 470500                    LDP0    ENTRY$,,AUTO
         2 001141   000001 236100                    LDQ     1,,PR0
         2 001142   000004 772000                    QRL     4
         2 001143   000017 376007                    ANQ     15,DL
         2 001144   200035 756100                    STQ     ARRAYTYP,,AUTO

      529    13833    3             DO CASE( ARRAYTYP );

  13833  2 001145   000006 116007                    CMPQ    6,DL
         2 001146   001150 602006 2                  TNC     s:13833+3,QL
         2 001147   001420 710000 2                  TRA     s:13895
         2 001150   001425 710000 2                  TRA     s:13901
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:78   
         2 001151   001156 710000 2                  TRA     s:13837
         2 001152   001156 710000 2                  TRA     s:13837
         2 001153   001175 710000 2                  TRA     s:13842
         2 001154   001175 710000 2                  TRA     s:13842
         2 001155   001175 710000 2                  TRA     s:13842

      530    13834    3               CASE( %SCALAR_ARRAY );

      531    13835                                                /* Do nothing */
      532    13836    3               CASE( %VECTOR0_ARRAY, %VECTOR1_ARRAY );

      533    13837    3                  DIMS = DIMS + 1;

  13837  2 001156   200022 235100                    LDA     DIMS,,AUTO
         2 001157   000001 035007                    ADLA    1,DL
         2 001160   200022 755100                    STA     DIMS,,AUTO

      534    13838    3                  LEVELDIMS = LEVELDIMS + 1;

  13838  2 001161   200042 235100                    LDA     LEVELDIMS,,AUTO
         2 001162   000001 035007                    ADLA    1,DL
         2 001163   200042 755100                    STA     LEVELDIMS,,AUTO

      535    13839    3                  IUB = B$VREBL.DIMS + ARRAYTYP - 2;

  13839  2 001164   000004 236100                    LDQ     4,,PR0
         2 001165   000022 772000                    QRL     18
         2 001166   200035 036100                    ADLQ    ARRAYTYP,,AUTO
         2 001167   000002 136007                    SBLQ    2,DL
         2 001170   200041 756100                    STQ     IUB,,AUTO

      536    13840    3                  ILB = ARRAYTYP -1;

  13840  2 001171   200035 235100                    LDA     ARRAYTYP,,AUTO
         2 001172   000001 135007                    SBLA    1,DL
         2 001173   200040 755100                    STA     ILB,,AUTO
         2 001174   001425 710000 2                  TRA     s:13901
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:79   

      537    13841    3               CASE( %REAL_ARRAY, %VIRTUAL_ARRAY, %ADJUSTABLE_ARRAY );

      538    13842    3                  DIMS = DIMS + B$VREBL.DIMS ;

  13842  2 001175   000004 236100                    LDQ     4,,PR0
         2 001176   000022 772000                    QRL     18
         2 001177   200022 036100                    ADLQ    DIMS,,AUTO
         2 001200   200022 756100                    STQ     DIMS,,AUTO

      539    13843    3                  LEVELDIMS = LEVELDIMS + 1;

  13843  2 001201   200042 235100                    LDA     LEVELDIMS,,AUTO
         2 001202   000001 035007                    ADLA    1,DL
         2 001203   200042 755100                    STA     LEVELDIMS,,AUTO

      540    13844    3                  IF DIMS = 1

  13844  2 001204   000001 116007                    CMPQ    1,DL
         2 001205   001330 601000 2                  TNZ     s:13872

      541    13845    4                  THEN DO;

      542    13846    4                       IF ARRAYTYP = %ADJUSTABLE_ARRAY

  13846  2 001206   200035 235100                    LDA     ARRAYTYP,,AUTO
         2 001207   000005 115007                    CMPA    5,DL
         2 001210   001317 601000 2                  TNZ     s:13868

      543    13847    5                       THEN DO;

      544    13848    5                            IF PINCRW(ENTRY$, SIZEW(B$VREBL)) -> B$VREBLCA.IOFFSET

  13848  2 001211   000005 234100                    SZN     5,,PR0
         2 001212   001245 605000 2                  TPL     s:13856

      545    13849    6                            THEN DO;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:80   

      546    13850    6                                JENTRY# = PINCRW(ENTRY$, SIZEW(B$VREBL)) -> B$VREBLCA.
             13850                                          OFF_V#;

  13850  2 001213   000005 236100                    LDQ     5,,PR0
         2 001214   000010 772000                    QRL     8
         2 001215   000032 376000 xsym               ANQ     B_VECTNIL+26
         2 001216   200050 756100                    STQ     JENTRY#,,AUTO

      547    13851    6                                CALL DDF$VREBL_# (JENTRY#, JENTRY$) ALTRET(BADSCHEMA);

  13851  2 001217   200047 631500                    EPPR1   JENTRY$,,AUTO
         2 001220   200161 451500                    STP1    CNT+3,,AUTO
         2 001221   200050 633500                    EPPR3   JENTRY#,,AUTO
         2 001222   200160 453500                    STP3    CNT+2,,AUTO
         2 001223   200160 630500                    EPPR0   CNT+2,,AUTO
         2 001224   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001225   000000 701000 xent               TSX1    DDF$VREBL_#
         2 001226   003543 702000 2                  TSX2    BADSCHEMA

      548    13852    6                                 CALL GETVAL ALTRET(TRAP_ADJ_DIM);

  13852  2 001227   003553 701000 2                  TSX1    GETVAL
         2 001230   003547 702000 2                  TSX2    TRAP_ADJ_DIM

      549    13853    6                                 ILB = VALUE;

  13853  2 001231   200052 235100                    LDA     VALUE,,AUTO
         2 001232   200040 755100                    STA     ILB,,AUTO

      550    13854    6                                 CALL DDF$VREBL_# (ENTRY#.E(STRUCT), ENTRY$) ALTRET(
             13854                                          BADSCHEMA);

  13854  2 001233   200010 630500                    EPPR0   ENTRY$,,AUTO
         2 001234   200161 450500                    STP0    CNT+3,,AUTO
         2 001235   200037 720100                    LXL0    STRUCT,,AUTO
         2 001236   200071 631510                    EPPR1   ENTRY#+1,X0,AUTO
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:81   
         2 001237   200160 451500                    STP1    CNT+2,,AUTO
         2 001240   200160 630500                    EPPR0   CNT+2,,AUTO
         2 001241   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001242   000000 701000 xent               TSX1    DDF$VREBL_#
         2 001243   003543 702000 2                  TSX2    BADSCHEMA

      551    13855    6                               END;

  13855  2 001244   001251 710000 2                  TRA     s:13857

      552    13856    5                            ELSE ILB = PINCRW(ENTRY$, SIZEW(B$VREBL)) -> B$VREBLCA.
             13856                                     OFFSET;

  13856  2 001245   000005 236100                    LDQ     5,,PR0
         2 001246   000001 736000                    QLS     1
         2 001247   000011 732000                    QRS     9
         2 001250   200040 756100                    STQ     ILB,,AUTO

      553    13857    5                            IF PINCRW(ENTRY$, SIZEW(B$VREBL)) -> B$VREBLCA.IELEMENTS

  13857  2 001251   200010 470500                    LDP0    ENTRY$,,AUTO
         2 001252   000006 234100                    SZN     6,,PR0
         2 001253   001310 605000 2                  TPL     s:13865

      554    13858    6                            THEN DO;

      555    13859    6                                KENTRY# = PINCRW(ENTRY$, SIZEW(B$VREBL)) -> B$VREBLCA.
             13859                                          ELEM_V#;

  13859  2 001254   000006 236100                    LDQ     6,,PR0
         2 001255   000004 772000                    QRL     4
         2 001256   000003 376000 3                  ANQ     3
         2 001257   200051 756100                    STQ     KENTRY#,,AUTO

      556    13860    6                                CALL DDF$VREBL_# (KENTRY#, JENTRY$) ALTRET(BADSCHEMA);

  13860  2 001260   200047 631500                    EPPR1   JENTRY$,,AUTO
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:82   
         2 001261   200161 451500                    STP1    CNT+3,,AUTO
         2 001262   200051 633500                    EPPR3   KENTRY#,,AUTO
         2 001263   200160 453500                    STP3    CNT+2,,AUTO
         2 001264   200160 630500                    EPPR0   CNT+2,,AUTO
         2 001265   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001266   000000 701000 xent               TSX1    DDF$VREBL_#
         2 001267   003543 702000 2                  TSX2    BADSCHEMA

      557    13861    6                                 CALL GETVAL ALTRET(TRAP_ADJ_DIM);

  13861  2 001270   003553 701000 2                  TSX1    GETVAL
         2 001271   003547 702000 2                  TSX2    TRAP_ADJ_DIM

      558    13862    6                                 IUB = VALUE + ILB - 1;

  13862  2 001272   200052 236100                    LDQ     VALUE,,AUTO
         2 001273   200040 036100                    ADLQ    ILB,,AUTO
         2 001274   000001 136007                    SBLQ    1,DL
         2 001275   200041 756100                    STQ     IUB,,AUTO

      559    13863    6                                 CALL DDF$VREBL_# (ENTRY#.E(STRUCT), ENTRY$) ALTRET(
             13863                                          BADSCHEMA);

  13863  2 001276   200010 630500                    EPPR0   ENTRY$,,AUTO
         2 001277   200161 450500                    STP0    CNT+3,,AUTO
         2 001300   200037 720100                    LXL0    STRUCT,,AUTO
         2 001301   200071 631510                    EPPR1   ENTRY#+1,X0,AUTO
         2 001302   200160 451500                    STP1    CNT+2,,AUTO
         2 001303   200160 630500                    EPPR0   CNT+2,,AUTO
         2 001304   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001305   000000 701000 xent               TSX1    DDF$VREBL_#
         2 001306   003543 702000 2                  TSX2    BADSCHEMA

      560    13864    6                               END;

  13864  2 001307   001425 710000 2                  TRA     s:13901

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:83   
      561    13865    5                            ELSE IUB = PINCRW(ENTRY$, SIZEW(B$VREBL)) -> B$VREBLCA.
             13865                                     ELEMENTS + ILB - 1;

  13865  2 001310   000006 236100                    LDQ     6,,PR0
         2 001311   000004 772000                    QRL     4
         2 001312   000003 376000 3                  ANQ     3
         2 001313   200040 036100                    ADLQ    ILB,,AUTO
         2 001314   000001 136007                    SBLQ    1,DL
         2 001315   200041 756100                    STQ     IUB,,AUTO

      562    13866    5                          END;

  13866  2 001316   001425 710000 2                  TRA     s:13901

      563    13867    5                       ELSE DO;

      564    13868    5                            ILB = PINCRW(ENTRY$, SIZEW(B$VREBL)) -> B$VREBLC.OFFSET;

  13868  2 001317   000005 236100                    LDQ     5,,PR0
         2 001320   000010 732000                    QRS     8
         2 001321   200040 756100                    STQ     ILB,,AUTO

      565    13869    5                           IUB = PINCRW(ENTRY$, SIZEW(B$VREBL)) -> B$VREBLC.ELEMENTS +
             13869                                     ILB - 1;

  13869  2 001322   000006 236100                    LDQ     6,,PR0
         2 001323   000004 772000                    QRL     4
         2 001324   200040 036100                    ADLQ    ILB,,AUTO
         2 001325   000001 136007                    SBLQ    1,DL
         2 001326   200041 756100                    STQ     IUB,,AUTO

      566    13870    5                          END;

      567    13871    4                     END;

  13871  2 001327   001425 710000 2                  TRA     s:13901

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:84   
      568    13872    3                  ELSE IF S_D.LB0$ -> B$LBNTRY0.COMPILER = %FORTRANID

  13872  2 001330   000000 471400 xsym               LDP1    S_D$
         2 001331   101035 473500                    LDP3    541,,PR1
         2 001332   300000 236100                    LDQ     0,,PR3
         2 001333   000777 376003                    ANQ     511,DU
         2 001334   000002 116003                    CMPQ    2,DU
         2 001335   001412 601000 2                  TNZ     s:13891

      569    13873    4                       THEN DO;

      570    13874    4                            IMPLF4 = '1'B;

  13874  2 001336   400000 236003                    LDQ     -131072,DU
         2 001337   200062 756100                    STQ     IMPLF4,,AUTO

      571    13875    4                            ILB = 1;

  13875  2 001340   000001 235007                    LDA     1,DL
         2 001341   200040 755100                    STA     ILB,,AUTO

      572    13876    4                            IF ARRAYTYP = %ADJUSTABLE_ARRAY

  13876  2 001342   200035 235100                    LDA     ARRAYTYP,,AUTO
         2 001343   000005 115007                    CMPA    5,DL
         2 001344   001406 601000 2                  TNZ     s:13888

      573    13877    5                            THEN DO;

      574    13878    5                                 IF PINCRW(ENTRY$, SIZEW(B$VREBL)) -> B$VREBLCA.
             13878                                          IELEMENTS

  13878  2 001345   000006 234100                    SZN     6,,PR0
         2 001346   001401 605000 2                  TPL     s:13886

      575    13879    6                                 THEN DO;

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:85   
      576    13880    6                                      JENTRY# = PINCRW(ENTRY$, SIZEW(B$VREBL)) ->
             13880                                               B$VREBLCA.ELEM_V#;

  13880  2 001347   000006 236100                    LDQ     6,,PR0
         2 001350   000004 772000                    QRL     4
         2 001351   000003 376000 3                  ANQ     3
         2 001352   200050 756100                    STQ     JENTRY#,,AUTO

      577    13881    6                                      CALL DDF$VREBL_# (JENTRY#, JENTRY$) ALTRET(
             13881                                               BADSCHEMA);

  13881  2 001353   200047 634500                    EPPR4   JENTRY$,,AUTO
         2 001354   200161 454500                    STP4    CNT+3,,AUTO
         2 001355   200050 635500                    EPPR5   JENTRY#,,AUTO
         2 001356   200160 455500                    STP5    CNT+2,,AUTO
         2 001357   200160 630500                    EPPR0   CNT+2,,AUTO
         2 001360   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001361   000000 701000 xent               TSX1    DDF$VREBL_#
         2 001362   003543 702000 2                  TSX2    BADSCHEMA

      578    13882    6                                      CALL GETVAL ALTRET(TRAP_ADJ_DIM);

  13882  2 001363   003553 701000 2                  TSX1    GETVAL
         2 001364   003547 702000 2                  TSX2    TRAP_ADJ_DIM

      579    13883    6                                      IUB = VALUE;

  13883  2 001365   200052 235100                    LDA     VALUE,,AUTO
         2 001366   200041 755100                    STA     IUB,,AUTO

      580    13884    6                                      CALL DDF$VREBL_# (ENTRY#.E(STRUCT), ENTRY$)
             13884                                               ALTRET(BADSCHEMA);

  13884  2 001367   200010 630500                    EPPR0   ENTRY$,,AUTO
         2 001370   200161 450500                    STP0    CNT+3,,AUTO
         2 001371   200037 720100                    LXL0    STRUCT,,AUTO
         2 001372   200071 631510                    EPPR1   ENTRY#+1,X0,AUTO
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:86   
         2 001373   200160 451500                    STP1    CNT+2,,AUTO
         2 001374   200160 630500                    EPPR0   CNT+2,,AUTO
         2 001375   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001376   000000 701000 xent               TSX1    DDF$VREBL_#
         2 001377   003543 702000 2                  TSX2    BADSCHEMA

      581    13885    6                                    END;

  13885  2 001400   001425 710000 2                  TRA     s:13901

      582    13886    5                                ELSE IUB = PINCRW(ENTRY$, SIZEW(B$VREBL)) -> B$VREBLCA
             13886                                          .ELEMENTS;

  13886  2 001401   000006 236100                    LDQ     6,,PR0
         2 001402   000004 772000                    QRL     4
         2 001403   000003 376000 3                  ANQ     3
         2 001404   200041 756100                    STQ     IUB,,AUTO

      583    13887    5                               END;

  13887  2 001405   001425 710000 2                  TRA     s:13901

      584    13888    4                            ELSE IUB = PINCRW(ENTRY$, SIZEW(B$VREBL)) -> B$VREBLC.
             13888                                     ELEMENTS;

  13888  2 001406   000006 236100                    LDQ     6,,PR0
         2 001407   000004 772000                    QRL     4
         2 001410   200041 756100                    STQ     IUB,,AUTO

      585    13889    4                          END;

  13889  2 001411   001425 710000 2                  TRA     s:13901

      586    13890    4                       ELSE DO;

      587    13891    4                            ILB = 0;

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:87   
  13891  2 001412   200040 450100                    STZ     ILB,,AUTO

      588    13892    4                           IUB = PINCRW(ENTRY$, SIZEW(B$VREBL)) -> B$VREBLC.ELEMENTS -
             13892                                     1;

  13892  2 001413   000006 236100                    LDQ     6,,PR0
         2 001414   000004 772000                    QRL     4
         2 001415   000001 136007                    SBLQ    1,DL
         2 001416   200041 756100                    STQ     IUB,,AUTO

      589    13893    4                          END;

  13893  2 001417   001425 710000 2                  TRA     s:13901

      590    13894    3               CASE( ELSE );

      591    13895    3                  ZITEM.FLAGS.MDSE.D = '0'B;

  13895  2 001420   200065 471500                    LDP1    ZITEM$,,AUTO
         2 001421   000004 236000 3                  LDQ     4
         2 001422   100001 356100                    ANSQ    1,,PR1

      592    13896    3                  ZITEM.DTYP = 1;          /* This won't allow LET of adjustable

  13896  2 001423   000001 236003                    LDQ     1,DU
         2 001424   100001 552120                    STBQ    1,'20'O,PR1

      593    13897                                                   dimension arrays work, when LET of
      594    13898                                                   arrays is allowed this won't work
      595    13899                                                   anymore */
      596    13900    3               END;                        /* DO CASE( ARRAYTYP ) */

      597    13901    2           END;                            /* DO I = 1 TO ENTRY#.C */

  13901  2 001425   200036 054100                    AOS     I,,AUTO
         2 001426   200070 236100                    LDQ     ENTRY#,,AUTO
         2 001427   001121 604000 2                  TMI     s:13829
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:88   
         2 001430   200036 116100                    CMPQ    I,,AUTO
         2 001431   001121 605000 2                  TPL     s:13829

      598    13902    1        IF ENTRY#.C > 1

  13902  2 001432   000002 116007                    CMPQ    2,DL
         2 001433   001444 602000 2                  TNC     s:13904

      599    13903    1        THEN CALL DDF$VREBL_#(ENTRY#.E(ENTRY#.C), ENTRY$) ALTRET(BADSCHEMA);

  13903  2 001434   200010 630500                    EPPR0   ENTRY$,,AUTO
         2 001435   200161 450500                    STP0    CNT+3,,AUTO
         2 001436   200071 631506                    EPPR1   ENTRY#+1,QL,AUTO
         2 001437   200160 451500                    STP1    CNT+2,,AUTO
         2 001440   200160 630500                    EPPR0   CNT+2,,AUTO
         2 001441   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001442   000000 701000 xent               TSX1    DDF$VREBL_#
         2 001443   003543 702000 2                  TSX2    BADSCHEMA

      600    13904    1        IF DIM_CNT ~= DIMS

  13904  2 001444   200021 236100                    LDQ     DIM_CNT,,AUTO
         2 001445   001450 604000 2                  TMI     s:13905
         2 001446   200022 116100                    CMPQ    DIMS,,AUTO
         2 001447   001533 600000 2                  TZE     s:13926

      601    13905    1        THEN IF DIM_CNT > 0 OR LEVELDIMS > 1

  13905  2 001450   000000 116003                    CMPQ    0,DU
         2 001451   001455 605400 2                  TPNZ    s:13907
         2 001452   200042 235100                    LDA     LEVELDIMS,,AUTO
         2 001453   000002 115007                    CMPA    2,DL
         2 001454   001465 602000 2                  TNC     s:13913

      602    13906    2             THEN DO;

      603    13907    2                  S_D.ERROR_HICHAR = DIMS;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:89   

  13907  2 001455   000000 470400 xsym               LDP0    S_D$
         2 001456   200022 235100                    LDA     DIMS,,AUTO
         2 001457   004753 755100                    STA     2539,,PR0

      604    13908    2                  S_D.ERROR = 188; /* E@WRONG#SUBS */

  13908  2 001460   000274 235007                    LDA     188,DL
         2 001461   000013 755100                    STA     11,,PR0

      605    13909    2                  S_D.ERROR_SYM$ = SYM$;

  13909  2 001462   200006 236100                    LDQ     SYM$,,AUTO
         2 001463   000032 756100                    STQ     26,,PR0

      606    13910    2                  ALTRETURN;

  13910  2 001464   000000 702200 xent               TSX2  ! X66_AALT

      607    13911    2                END;
      608    13912    2             ELSE DO;

      609    13913    2                  S_D.RANGE_CNT = 1;

  13913  2 001465   000001 235007                    LDA     1,DL
         2 001466   000000 470400 xsym               LDP0    S_D$
         2 001467   000062 755100                    STA     50,,PR0

      610    13914    2                  DITEM = DUMILBINDEX;

  13914  2 001470   200064 471500                    LDP1    SDD$,,AUTO
         2 001471   000100 100400                    MLR     fill='000'O
         2 001472   000006 000010 1                  ADSC9   DUMILBINDEX              cn=0,n=8
         2 001473   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

      611    13915    2                  DITEM.VALUE = ILB;

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:90   
  13915  2 001474   200040 236100                    LDQ     ILB,,AUTO
         2 001475   100001 756100                    STQ     1,,PR1

      612    13916    2                  CALL BUMPD$ ALTRET(VERR);

  13916  2 001476   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001477   200155 756100                    STQ     ENTRY#+53,,AUTO
         2 001500   003707 701000 2                  TSX1    BUMPD$
         2 001501   003546 702000 2                  TSX2    VERR

      613    13917    2                  MULT(0) = SDD$;

  13917  2 001502   200064 236100                    LDQ     SDD$,,AUTO
         2 001503   200026 756100                    STQ     MULT,,AUTO

      614    13918    2                  MULT(0) -> MITEM = '0'B;

  13918  2 001504   200026 470500                    LDP0    MULT,,AUTO
         2 001505   000100 100400                    MLR     fill='000'O
         2 001506   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 001507   000000 000020                    ADSC9   0,,PR0                   cn=0,n=16

      615    13919    2                  ARRAY_FLAG = '1'B;

  13919  2 001510   400000 236003                    LDQ     -131072,DU
         2 001511   200014 756100                    STQ     ARRAY_FLAG,,AUTO

      616    13920    2                  CALL BUMPD$(SIZEW(MITEM)) ALTRET(VERR);

  13920  2 001512   000005 236000 3                  LDQ     5
         2 001513   200155 756100                    STQ     ENTRY#+53,,AUTO
         2 001514   003707 701000 2                  TSX1    BUMPD$
         2 001515   003546 702000 2                  TSX2    VERR

      617    13921    2                  DIM_CNT = 1;

  13921  2 001516   000001 235007                    LDA     1,DL
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:91   
         2 001517   200021 755100                    STA     DIM_CNT,,AUTO

      618    13922    2                  DITEM = DUMIUBINDEX;

  13922  2 001520   200064 470500                    LDP0    SDD$,,AUTO
         2 001521   000100 100400                    MLR     fill='000'O
         2 001522   000010 000010 1                  ADSC9   DUMIUBINDEX              cn=0,n=8
         2 001523   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

      619    13923    2                  DITEM.VALUE = IUB;

  13923  2 001524   200041 236100                    LDQ     IUB,,AUTO
         2 001525   000001 756100                    STQ     1,,PR0

      620    13924    2                  CALL BUMPD$ ALTRET(VERR);

  13924  2 001526   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001527   200155 756100                    STQ     ENTRY#+53,,AUTO
         2 001530   003707 701000 2                  TSX1    BUMPD$
         2 001531   003546 702000 2                  TSX2    VERR

      621    13925    2                END;

  13925  2 001532   001534 710000 2                  TRA     s:13927

      622    13926    1        ELSE IMPLF4 = '0'B;

  13926  2 001533   200062 450100                    STZ     IMPLF4,,AUTO

      623    13927    1        STATUS_EXISTS = B$VREBL.STATUS_EXISTS;

  13927  2 001534   200010 470500                    LDP0    ENTRY$,,AUTO
         2 001535   000003 236100                    LDQ     3,,PR0
         2 001536   000030 736000                    QLS     24
         2 001537   400000 376003                    ANQ     -131072,DU
         2 001540   200017 756100                    STQ     STATUS_EXISTS,,AUTO

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:92   
      624    13928    1        ATYP = B$VREBL.ADDRTYP - 1;

  13928  2 001541   000000 236100                    LDQ     0,,PR0
         2 001542   000010 772000                    QRL     8
         2 001543   000017 376007                    ANQ     15,DL
         2 001544   000001 136007                    SBLQ    1,DL
         2 001545   200023 756100                    STQ     TEMP1,,AUTO

      625    13929    1        IF BASED_FLAG AND NOT (ATYP = %BASED_ACODE OR ATYP = %DCB_ACODE OR ATYP = %
             13929                 PARM_ACODE OR

  13929  2 001546   200013 234100                    SZN     BASED_FLAG,,AUTO
         2 001547   001570 605000 2                  TPL     s:13937
         2 001550   000002 116007                    CMPQ    2,DL
         2 001551   001570 600000 2                  TZE     s:13937
         2 001552   000003 116007                    CMPQ    3,DL
         2 001553   001570 600000 2                  TZE     s:13937
         2 001554   000004 116007                    CMPQ    4,DL
         2 001555   001570 600000 2                  TZE     s:13937
         2 001556   000006 116007                    CMPQ    6,DL
         2 001557   001570 600000 2                  TZE     s:13937
         2 001560   000007 116007                    CMPQ    7,DL
         2 001561   001570 600000 2                  TZE     s:13937

      626    13930    1          ATYP = %SPARM_ACODE OR ATYP = %AREADEF_ACODE)
      627    13931         /* BASED_ACODE OR DCB_ACODE OR PARM_ACODE OR SPARM_ACODE OR AREADEF_ACODE */
      628    13932    2        THEN DO;

      629    13933    2             S_D.ERROR = 9;        /* E@VAR_REF */

  13933  2 001562   000011 235007                    LDA     9,DL
         2 001563   000000 471400 xsym               LDP1    S_D$
         2 001564   100013 755100                    STA     11,,PR1

      630    13934    2             S_D.ERROR_SYM$ = SYM$;

  13934  2 001565   200006 236100                    LDQ     SYM$,,AUTO
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:93   
         2 001566   100032 756100                    STQ     26,,PR1

      631    13935    2             ALTRETURN;

  13935  2 001567   000000 702200 xent               TSX2  ! X66_AALT

      632    13936    2           END;
      633    13937    1        IF NOT BASED_FLAG AND (ATYP = %BASED_ACODE OR ATYP = %DCB_ACODE OR ATYP = %
             13937                 PARM_ACODE OR

  13937  2 001570   200013 234100                    SZN     BASED_FLAG,,AUTO
         2 001571   002213 604000 2                  TMI     s:14035
         2 001572   000002 116007                    CMPQ    2,DL
         2 001573   001604 600000 2                  TZE     s:13941
         2 001574   000003 116007                    CMPQ    3,DL
         2 001575   001604 600000 2                  TZE     s:13941
         2 001576   000004 116007                    CMPQ    4,DL
         2 001577   001604 600000 2                  TZE     s:13941
         2 001600   000006 116007                    CMPQ    6,DL
         2 001601   001604 600000 2                  TZE     s:13941
         2 001602   000007 116007                    CMPQ    7,DL
         2 001603   002213 601000 2                  TNZ     s:14035

      634    13938    1          ATYP = %SPARM_ACODE OR ATYP = %AREADEF_ACODE)
      635    13939         /* BASED_ACODE OR DCB_ACODE OR PARM_ACODE OR SPARM_ACODE OR AREADEF_ACODE */
      636    13940    2        THEN DO;

      637    13941    2             IENTRY# = B$VREBL.IMPTR;

  13941  2 001604   000002 236100                    LDQ     2,,PR0
         2 001605   000022 732000                    QRS     18
         2 001606   200043 756100                    STQ     IENTRY#,,AUTO

      638    13942    2             IF ATYP = %BASED_ACODE  /* BASED_ACODE */ AND IENTRY# < 0

  13942  2 001607   200023 235100                    LDA     TEMP1,,AUTO
         2 001610   000002 115007                    CMPA    2,DL
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:94   
         2 001611   001622 601000 2                  TNZ     s:13948
         2 001612   000000 116003                    CMPQ    0,DU
         2 001613   001622 605000 2                  TPL     s:13948

      639    13943    3             THEN DO;

      640    13944    3                  S_D.ERROR = 99;     /* E@NOPTR */

  13944  2 001614   000143 235007                    LDA     99,DL
         2 001615   000000 471400 xsym               LDP1    S_D$
         2 001616   100013 755100                    STA     11,,PR1

      641    13945    3                  S_D.ERROR_SYM$ = SYM$;

  13945  2 001617   200006 236100                    LDQ     SYM$,,AUTO
         2 001620   100032 756100                    STQ     26,,PR1

      642    13946    3                  ALTRETURN;

  13946  2 001621   000000 702200 xent               TSX2  ! X66_AALT

      643    13947    3                END;
      644    13948    2             T$ = SDD$;

  13948  2 001622   200064 236100                    LDQ     SDD$,,AUTO
         2 001623   200044 756100                    STQ     T$,,AUTO

      645    13949    2             CALL BUMPD$ ALTRET(VERR);

  13949  2 001624   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001625   200155 756100                    STQ     ENTRY#+53,,AUTO
         2 001626   003707 701000 2                  TSX1    BUMPD$
         2 001627   003546 702000 2                  TSX2    VERR

      646    13950    3             DO WHILE( T$ >= IPTR$ );

  13950  2 001630   200044 236100                    LDQ     T$,,AUTO
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:95   
         2 001631   200045 116100                    CMPQ    IPTR$,,AUTO
         2 001632   001643 602000 2                  TNC     s:13954

      647    13951    3                  PINCRW(T$,SIZEW(DITEM)) -> UBIN36 = T$ -> UBIN36;

  13951  2 001633   200044 470500                    LDP0    T$,,AUTO
         2 001634   000000 235100                    LDA     0,,PR0
         2 001635   000003 755100                    STA     3,,PR0

      648    13952    3                  T$ = PINCRW(T$, -1);

  13952  2 001636   200044 236100                    LDQ     T$,,AUTO
         2 001637   777777 036003                    ADLQ    -1,DU
         2 001640   200044 756100                    STQ     T$,,AUTO

      649    13953    3                END;                       /* DO WHILE (T$ >= IPTR$ ) */

  13953  2 001641   200045 116100                    CMPQ    IPTR$,,AUTO
         2 001642   001633 603000 2                  TRC     s:13951

      650    13954    3             DO I = 0 TO DIM_CNT - 1;

  13954  2 001643   200036 450100                    STZ     I,,AUTO
         2 001644   001652 710000 2                  TRA     s:13956+1

      651    13955    3                  MULT( I ) = PINCRW(MULT( I ), SIZEW(DITEM));

  13955  2 001645   200036 720100                    LXL0    I,,AUTO
         2 001646   200026 236110                    LDQ     MULT,X0,AUTO
         2 001647   000003 036003                    ADLQ    3,DU
         2 001650   200026 756110                    STQ     MULT,X0,AUTO

      652    13956    3                END;

  13956  2 001651   200036 054100                    AOS     I,,AUTO
         2 001652   200036 236100                    LDQ     I,,AUTO
         2 001653   200021 116100                    CMPQ    DIM_CNT,,AUTO
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:96   
         2 001654   001645 604000 2                  TMI     s:13955

      653    13957    2             IF ATYP = %BASED_ACODE        /* BASED_ACODE */

  13957  2 001655   200023 235100                    LDA     TEMP1,,AUTO
         2 001656   000002 115007                    CMPA    2,DL
         2 001657   002113 601000 2                  TNZ     s:14007

      654    13958    3             THEN DO;                      /* Based variable */

      655    13959    3                  IPTR$ -> DITEM = DUMPTR;

  13959  2 001660   200045 470500                    LDP0    IPTR$,,AUTO
         2 001661   000100 100400                    MLR     fill='000'O
         2 001662   000000 000010 1                  ADSC9   DUMPTR                   cn=0,n=8
         2 001663   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

      656    13960    3                  CALL DDF$VREBL_#(IENTRY#, IENTRY$) ALTRET(BADSCHEMA);

  13960  2 001664   200046 631500                    EPPR1   IENTRY$,,AUTO
         2 001665   200161 451500                    STP1    CNT+3,,AUTO
         2 001666   200043 633500                    EPPR3   IENTRY#,,AUTO
         2 001667   200160 453500                    STP3    CNT+2,,AUTO
         2 001670   200160 630500                    EPPR0   CNT+2,,AUTO
         2 001671   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001672   000000 701000 xent               TSX1    DDF$VREBL_#
         2 001673   003543 702000 2                  TSX2    BADSCHEMA

      657    13961    4                  DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);

  13961  2 001674   000000 470400 xsym               LDP0    S_D$
         2 001675   006714 235100                    LDA     3532,,PR0
         2 001676   000003 115007                    CMPA    3,DL
         2 001677   001701 602005 2                  TNC     s:13961+5,AL
         2 001700   001746 710000 2                  TRA     s:13971
         2 001701   001746 710000 2                  TRA     s:13971
         2 001702   001704 710000 2                  TRA     s:13963
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:97   
         2 001703   001725 710000 2                  TRA     s:13967

      658    13962    4                    CASE (%HOST);

      659    13963    4                       IPTR$ -> DITEM.ADDRESS.W = IENTRY$ -> B$VREBL.ADR.W;

  13963  2 001704   200045 471500                    LDP1    IPTR$,,AUTO
         2 001705   200046 473500                    LDP3    IENTRY$,,AUTO
         2 001706   300000 236100                    LDQ     0,,PR3
         2 001707   777777 376003                    ANQ     -1,DU
         2 001710   000006 772000                    QRL     6
         2 001711   100001 752174                    STCQ    1,'74'O,PR1

      660    13964    4                       IPTR$ -> DITEM.ADDRESS.C = IENTRY$ -> B$VREBL.ADR.C;

  13964  2 001712   200046 473500                    LDP3    IENTRY$,,AUTO
         2 001713   300000 236100                    LDQ     0,,PR3
         2 001714   600000 376007                    ANQ     -65536,DL
         2 001715   000012 772000                    QRL     10
         2 001716   100001 752102                    STCQ    1,'02'O,PR1

      661    13965    4                       IPTR$ -> DITEM.ADDRESS.B = IENTRY$ -> B$VREBL.ADR.B;

  13965  2 001717   200046 473500                    LDP3    IENTRY$,,AUTO
         2 001720   300000 236100                    LDQ     0,,PR3
         2 001721   170000 376007                    ANQ     61440,DL
         2 001722   000014 772000                    QRL     12
         2 001723   100001 752101                    STCQ    1,'01'O,PR1
         2 001724   001751 710000 2                  TRA     s:13974

      662    13966    4                    CASE (%L6);

      663    13967    4                       IPTR$ -> DITEM.ADDRESS.W = IENTRY$ -> B$VREBL.ADR6.W;

  13967  2 001725   200046 471500                    LDP1    IENTRY$,,AUTO
         2 001726   200045 473500                    LDP3    IPTR$,,AUTO
         2 001727   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:98   
         2 001730   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 001731   000004 772000                    QRL     4
         2 001732   300001 752174                    STCQ    1,'74'O,PR3

      664    13968    4                       IPTR$ -> DITEM.ADDRESS.C = IENTRY$ -> B$VREBL.ADR6.C;

  13968  2 001733   200046 471500                    LDP1    IENTRY$,,AUTO
         2 001734   100000 236100                    LDQ     0,,PR1
         2 001735   100000 376007                    ANQ     32768,DL
         2 001736   000011 772000                    QRL     9
         2 001737   300001 752102                    STCQ    1,'02'O,PR3

      665    13969    4                       IPTR$ -> DITEM.ADDRESS.B = IENTRY$ -> B$VREBL.ADR6.B;

  13969  2 001740   200046 471500                    LDP1    IENTRY$,,AUTO
         2 001741   100000 236100                    LDQ     0,,PR1
         2 001742   070000 376007                    ANQ     28672,DL
         2 001743   000014 772000                    QRL     12
         2 001744   300001 752101                    STCQ    1,'01'O,PR3
         2 001745   001751 710000 2                  TRA     s:13974

      666    13970    4                    CASE (ELSE);

      667    13971    4                       S_D.ERROR = 502; /* E@DELBUG  */

  13971  2 001746   000766 236007                    LDQ     502,DL
         2 001747   000013 756100                    STQ     11,,PR0

      668    13972    4                       ALTRETURN;

  13972  2 001750   000000 702200 xent               TSX2  ! X66_AALT

      669    13973    4                    END;

      670    13974    3                  TATYP = IENTRY$ -> B$VREBL.ADDRTYP - 1;

  13974  2 001751   200046 471500                    LDP1    IENTRY$,,AUTO
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:99   
         2 001752   100000 236100                    LDQ     0,,PR1
         2 001753   000010 772000                    QRL     8
         2 001754   000017 376007                    ANQ     15,DL
         2 001755   000001 136007                    SBLQ    1,DL
         2 001756   200057 756100                    STQ     TATYP,,AUTO

      671    13975    3                  IF TATYP = %PARM_ACODE OR TATYP = %SPARM_ACODE OR TATYP = %
             13975                           AREADEF_ACODE /* PARM_ACODE OR SPARM_ACODE OR AREADEF_ACODE*/

  13975  2 001757   000004 116007                    CMPQ    4,DL
         2 001760   001765 600000 2                  TZE     s:13977
         2 001761   000006 116007                    CMPQ    6,DL
         2 001762   001765 600000 2                  TZE     s:13977
         2 001763   000007 116007                    CMPQ    7,DL
         2 001764   002076 601000 2                  TNZ     s:14004

      672    13976    4                  THEN DO;       /* Implicit pointer is a parameter or areadef */

      673    13977    4                       IPTR$ -> DITEM.ADDR_TYPE = %PARM_ACODE; /* PARM_ACODE */

  13977  2 001765   200045 473500                    LDP3    IPTR$,,AUTO
         2 001766   004000 236007                    LDQ     2048,DL
         2 001767   300000 552110                    STBQ    0,'10'O,PR3

      674    13978    4                       T$ = SDD$;

  13978  2 001770   200064 236100                    LDQ     SDD$,,AUTO
         2 001771   200044 756100                    STQ     T$,,AUTO

      675    13979    4                       CALL BUMPD$ ALTRET(VERR);

  13979  2 001772   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001773   200155 756100                    STQ     ENTRY#+53,,AUTO
         2 001774   003707 701000 2                  TSX1    BUMPD$
         2 001775   003546 702000 2                  TSX2    VERR

      676    13980    5                       DO WHILE (T$ >= IPTR$ );
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:100  

  13980  2 001776   200044 236100                    LDQ     T$,,AUTO
         2 001777   200045 116100                    CMPQ    IPTR$,,AUTO
         2 002000   002011 602000 2                  TNC     s:13984

      677    13981    5                            PINCRW(T$, SIZEW(DITEM)) -> UBIN36 = T$ -> UBIN36;

  13981  2 002001   200044 470500                    LDP0    T$,,AUTO
         2 002002   000000 235100                    LDA     0,,PR0
         2 002003   000003 755100                    STA     3,,PR0

      678    13982    5                            T$ = PINCRW(T$, -1);

  13982  2 002004   200044 236100                    LDQ     T$,,AUTO
         2 002005   777777 036003                    ADLQ    -1,DU
         2 002006   200044 756100                    STQ     T$,,AUTO

      679    13983    5                          END;             /* DO WHILE (T$ >= IPTR$) */

  13983  2 002007   200045 116100                    CMPQ    IPTR$,,AUTO
         2 002010   002001 603000 2                  TRC     s:13981

      680    13984    5                       DO I = 0 TO DIM_CNT - 1;

  13984  2 002011   200036 450100                    STZ     I,,AUTO
         2 002012   002020 710000 2                  TRA     s:13986+1

      681    13985    5                            MULT(I) = PINCRW(MULT(I), SIZEW(DITEM));

  13985  2 002013   200036 720100                    LXL0    I,,AUTO
         2 002014   200026 236110                    LDQ     MULT,X0,AUTO
         2 002015   000003 036003                    ADLQ    3,DU
         2 002016   200026 756110                    STQ     MULT,X0,AUTO

      682    13986    5                          END;

  13986  2 002017   200036 054100                    AOS     I,,AUTO
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:101  
         2 002020   200036 236100                    LDQ     I,,AUTO
         2 002021   200021 116100                    CMPQ    DIM_CNT,,AUTO
         2 002022   002013 604000 2                  TMI     s:13985

      683    13987    4                       IF TATYP = %PARM_ACODE /* PARM_ACODE */

  13987  2 002023   200057 235100                    LDA     TATYP,,AUTO
         2 002024   000004 115007                    CMPA    4,DL
         2 002025   002045 601000 2                  TNZ     s:13994

      684    13988    5                       THEN DO;            /* Auto parameter */

      685    13989    5                            IPTR$ -> DITEM.VALUEB = DESC.ITEM(%PARM_DESC);
             13989                                     /* PARM_DESC */

  13989  2 002026   000067 236000 xsym               LDQ     DESC+55
         2 002027   200045 470500                    LDP0    IPTR$,,AUTO
         2 002030   000001 756100                    STQ     1,,PR0

      686    13990    5                            IPTR$ -> DITEM.ADDR_TYPE = %DESC_ACODE; /* DESC_ACODE */

  13990  2 002031   100000 236007                    LDQ     32768,DL
         2 002032   000000 552110                    STBQ    0,'10'O,PR0

      687    13991    5                            IPTR$ -> DITEM.SP.VP.N = IENTRY$ -> B$VREBL.IMPTR - 2;

  13991  2 002033   200046 471500                    LDP1    IENTRY$,,AUTO
         2 002034   100002 236100                    LDQ     2,,PR1
         2 002035   000022 732000                    QRS     18
         2 002036   000002 136007                    SBLQ    2,DL
         2 002037   000014 736000                    QLS     12
         2 002040   000001 752134                    STCQ    1,'34'O,PR0

      688    13992    5                            ZITEM.FLAGS.MDSE.S = '1'B;

  13992  2 002041   200065 471500                    LDP1    ZITEM$,,AUTO
         2 002042   100000 236003                    LDQ     32768,DU
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:102  
         2 002043   100001 256100                    ORSQ    1,,PR1

      689    13993    5                          END;             /* Auto parameter */

  13993  2 002044   002101 710000 2                  TRA     s:14005

      690    13994    4                       ELSE IF TATYP = %SPARM_ACODE
             13994                                /* SPARM_ACODE - Static parameter */

  13994  2 002045   000006 115007                    CMPA    6,DL
         2 002046   002060 601000 2                  TNZ     s:14000

      691    13995    5                            THEN DO;

      692    13996    5                                 IPTR$ -> DITEM.ADDRESS.W = IENTRY$ -> B$VREBL.IMPTR;

  13996  2 002047   200045 470500                    LDP0    IPTR$,,AUTO
         2 002050   200046 471500                    LDP1    IENTRY$,,AUTO
         2 002051   100002 236100                    LDQ     2,,PR1
         2 002052   000022 732000                    QRS     18
         2 002053   000014 736000                    QLS     12
         2 002054   000001 752174                    STCQ    1,'74'O,PR0

      693    13997    5                                 IPTR$ -> DITEM.ADDR_TYPE = %SPARM_ACODE;
             13997                                          /* SPARM_ACODE */

  13997  2 002055   006000 236007                    LDQ     3072,DL
         2 002056   000000 552110                    STBQ    0,'10'O,PR0

      694    13998    5                               END;        /* Static parameter */

  13998  2 002057   002101 710000 2                  TRA     s:14005

      695    13999    5                            ELSE DO;       /* TATYP = AREADEF_ACODE */

      696    14000    5                                 IPTR$ -> DITEM.ADDR_TYPE = %CONST_ACODE;
             14000                                          /* CONST_ACODE */
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:103  

  14000  2 002060   200045 470500                    LDP0    IPTR$,,AUTO
         2 002061   102000 236007                    LDQ     33792,DL
         2 002062   000000 552110                    STBQ    0,'10'O,PR0

      697    14001    5                                 IPTR$ -> DITEM.VALUE = PINCRW(IENTRY$, POFFW(ADDR(
             14001                                          B$VREBL.IMPTR), ADDR(B$VREBL))) -> UBIN36;

  14001  2 002063   200010 236100                    LDQ     ENTRY$,,AUTO
         2 002064   000022 772000                    QRL     18
         2 002065   200160 756100                    STQ     CNT+2,,AUTO
         2 002066   200010 236100                    LDQ     ENTRY$,,AUTO
         2 002067   000002 036003                    ADLQ    2,DU
         2 002070   000022 772000                    QRL     18
         2 002071   200160 136100                    SBLQ    CNT+2,,AUTO
         2 002072   200046 471500                    LDP1    IENTRY$,,AUTO
         2 002073   100000 235106                    LDA     0,QL,PR1
         2 002074   000001 755100                    STA     1,,PR0

      698    14002    5                               END;

      699    14003    4                     END;        /* Implicit pointer is a parameter or areadef */

  14003  2 002075   002101 710000 2                  TRA     s:14005

      700    14004    3                  ELSE IPTR$ -> DITEM.ADDR_TYPE = TATYP;

  14004  2 002076   200045 473500                    LDP3    IPTR$,,AUTO
         2 002077   000011 736000                    QLS     9
         2 002100   300000 552110                    STBQ    0,'10'O,PR3

      701    14005    3                  CALL DDF$VREBL_#(ENTRY#.E(ENTRY#.C), ENTRY$) ALTRET(BADSCHEMA);
             14005                           /* RE-ESTAB. VAR */

  14005  2 002101   200010 630500                    EPPR0   ENTRY$,,AUTO
         2 002102   200161 450500                    STP0    CNT+3,,AUTO
         2 002103   200070 720100                    LXL0    ENTRY#,,AUTO
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:104  
         2 002104   200071 631510                    EPPR1   ENTRY#+1,X0,AUTO
         2 002105   200160 451500                    STP1    CNT+2,,AUTO
         2 002106   200160 630500                    EPPR0   CNT+2,,AUTO
         2 002107   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002110   000000 701000 xent               TSX1    DDF$VREBL_#
         2 002111   003543 702000 2                  TSX2    BADSCHEMA

      702    14006    3                END;                       /* Based variable */

  14006  2 002112   002211 710000 2                  TRA     s:14033

      703    14007    2             ELSE IF ATYP = %PARM_ACODE    /* PARM_ACODE - auto parameter */

  14007  2 002113   000004 115007                    CMPA    4,DL
         2 002114   002135 601000 2                  TNZ     s:14015

      704    14008    3                  THEN DO;

      705    14009    3                       IPTR$ -> DITEM = DUMPTR;

  14009  2 002115   200045 470500                    LDP0    IPTR$,,AUTO
         2 002116   000100 100400                    MLR     fill='000'O
         2 002117   000000 000010 1                  ADSC9   DUMPTR                   cn=0,n=8
         2 002120   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

      706    14010    3                       IPTR$ -> DITEM.VALUEB = DESC.ITEM(%PARM_DESC); /* PARM_DESC */

  14010  2 002121   000067 236000 xsym               LDQ     DESC+55
         2 002122   000001 756100                    STQ     1,,PR0

      707    14011    3                       IPTR$ -> DITEM.ADDR_TYPE = %DESC_ACODE; /* DESC_ACODE */

  14011  2 002123   100000 236007                    LDQ     32768,DL
         2 002124   000000 552110                    STBQ    0,'10'O,PR0

      708    14012    3                       IPTR$ -> DITEM.SP.VP.N = IENTRY# - 2;

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:105  
  14012  2 002125   200043 236100                    LDQ     IENTRY#,,AUTO
         2 002126   000002 136007                    SBLQ    2,DL
         2 002127   000014 736000                    QLS     12
         2 002130   000001 752134                    STCQ    1,'34'O,PR0

      709    14013    3                       ZITEM.FLAGS.MDSE.S = '1'B;

  14013  2 002131   200065 471500                    LDP1    ZITEM$,,AUTO
         2 002132   100000 236003                    LDQ     32768,DU
         2 002133   100001 256100                    ORSQ    1,,PR1

      710    14014    3                     END;                  /* Parameter */

  14014  2 002134   002211 710000 2                  TRA     s:14033

      711    14015    2                  ELSE IF ATYP = %SPARM_ACODE /* SPARM_ACODE - static parameter */

  14015  2 002135   000006 115007                    CMPA    6,DL
         2 002136   002151 601000 2                  TNZ     s:14021

      712    14016    3                       THEN DO;

      713    14017    3                            IPTR$ -> DITEM = DUMPTR;

  14017  2 002137   200045 470500                    LDP0    IPTR$,,AUTO
         2 002140   000100 100400                    MLR     fill='000'O
         2 002141   000000 000010 1                  ADSC9   DUMPTR                   cn=0,n=8
         2 002142   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

      714    14018    3                            IPTR$ -> DITEM.ADDRESS.W = IENTRY#;

  14018  2 002143   200043 236100                    LDQ     IENTRY#,,AUTO
         2 002144   000014 736000                    QLS     12
         2 002145   000001 752174                    STCQ    1,'74'O,PR0

      715    14019    3                            IPTR$ -> DITEM.ADDR_TYPE = %SPARM_ACODE; /* SPARM_ACODE */

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:106  
  14019  2 002146   006000 236007                    LDQ     3072,DL
         2 002147   000000 552110                    STBQ    0,'10'O,PR0

      716    14020    3                          END;             /* Static parameter */

  14020  2 002150   002211 710000 2                  TRA     s:14033

      717    14021    2                       ELSE IF ATYP = %DCB_ACODE /* DCB_ACODE */

  14021  2 002151   000003 115007                    CMPA    3,DL
         2 002152   002171 601000 2                  TNZ     s:14029

      718    14022    3                            THEN DO;

      719    14023    3                                 IPTR$ -> DITEM = DUMPTR;

  14023  2 002153   200045 470500                    LDP0    IPTR$,,AUTO
         2 002154   000100 100400                    MLR     fill='000'O
         2 002155   000000 000010 1                  ADSC9   DUMPTR                   cn=0,n=8
         2 002156   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

      720    14024    3                                 IPTR$ -> DITEM.VALUEB = DESC.ITEM(%DCB_DESC);
             14024                                          /* DCB_DESC */

  14024  2 002157   000071 236000 xsym               LDQ     DESC+57
         2 002160   000001 756100                    STQ     1,,PR0

      721    14025    3                                 IPTR$ -> DITEM.ADDR_TYPE = %DESC_ACODE;
             14025                                          /* DESC_ACODE */

  14025  2 002161   100000 236007                    LDQ     32768,DL
         2 002162   000000 552110                    STBQ    0,'10'O,PR0

      722    14026    3                                 IPTR$ -> DITEM.SP.VD.DISP = IENTRY#;

  14026  2 002163   200043 236100                    LDQ     IENTRY#,,AUTO
         2 002164   000014 736000                    QLS     12
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:107  
         2 002165   000001 676100                    ERQ     1,,PR0
         2 002166   000002 376000 3                  ANQ     2
         2 002167   000001 656100                    ERSQ    1,,PR0

      723    14027    3                               END;        /* ATYP = 3 (DCB) */

  14027  2 002170   002211 710000 2                  TRA     s:14033

      724    14028    3                            ELSE DO;       /* ATYP = AREADEF_ACODE */

      725    14029    3                                 IPTR$ -> DITEM = DUMPTR;

  14029  2 002171   200045 470500                    LDP0    IPTR$,,AUTO
         2 002172   000100 100400                    MLR     fill='000'O
         2 002173   000000 000010 1                  ADSC9   DUMPTR                   cn=0,n=8
         2 002174   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

      726    14030    3                                 IPTR$ -> DITEM.ADDR_TYPE = %CONST_ACODE;
             14030                                          /* CONST_ACODE */

  14030  2 002175   102000 236007                    LDQ     33792,DL
         2 002176   000000 552110                    STBQ    0,'10'O,PR0

      727    14031    3                                 IPTR$ -> DITEM.VALUE = PINCRW(ENTRY$, POFFW(ADDR(
             14031                                          B$VREBL.IMPTR), ADDR(B$VREBL))) -> UBIN36;

  14031  2 002177   200010 236100                    LDQ     ENTRY$,,AUTO
         2 002200   000022 772000                    QRL     18
         2 002201   200160 756100                    STQ     CNT+2,,AUTO
         2 002202   200010 236100                    LDQ     ENTRY$,,AUTO
         2 002203   000002 036003                    ADLQ    2,DU
         2 002204   000022 772000                    QRL     18
         2 002205   200160 136100                    SBLQ    CNT+2,,AUTO
         2 002206   200010 471500                    LDP1    ENTRY$,,AUTO
         2 002207   100000 235106                    LDA     0,QL,PR1
         2 002210   000001 755100                    STA     1,,PR0

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:108  
      728    14032    3                               END;        /* ATYP = AREADEF_ACODE */

      729    14033    2             ATYP = %BASED_ACODE;          /* BASED_ACODE */

  14033  2 002211   000002 235007                    LDA     2,DL
         2 002212   200023 755100                    STA     TEMP1,,AUTO

      730    14034    2           END;
             14034        /* NOT BASED_FLAG AND (ATYP = 2 OR ATYP = 3 OR ATYP = 4 OR ATYP = 6 OR ATYP = 7) */

      731    14035    1        IF BASED_FLAG

  14035  2 002213   200013 234100                    SZN     BASED_FLAG,,AUTO
         2 002214   002217 605000 2                  TPL     s:14037

      732    14036    1        THEN ATYP = %BASED_ACODE;          /* BASED_ACODE */

  14036  2 002215   000002 235007                    LDA     2,DL
         2 002216   200023 755100                    STA     TEMP1,,AUTO

      733    14037    1        IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  14037  2 002217   000000 470400 xsym               LDP0    S_D$
         2 002220   006714 235100                    LDA     3532,,PR0
         2 002221   000001 115007                    CMPA    1,DL
         2 002222   002230 601000 2                  TNZ     s:14039

      734    14038    1        THEN DITEM = DUMSIZE;

  14038  2 002223   200064 471500                    LDP1    SDD$,,AUTO
         2 002224   000100 100400                    MLR     fill='000'O
         2 002225   000002 000010 1                  ADSC9   DUMSIZE                  cn=0,n=8
         2 002226   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12
         2 002227   002234 710000 2                  TRA     s:14040

      735    14039    1        ELSE DITEM = DUMSIZE_L6;

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:109  
  14039  2 002230   200064 471500                    LDP1    SDD$,,AUTO
         2 002231   000100 100400                    MLR     fill='000'O
         2 002232   000004 000010 1                  ADSC9   DUMSIZE_L6               cn=0,n=8
         2 002233   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

      736    14040    1        IF ARRAY_FLAG

  14040  2 002234   200014 234100                    SZN     ARRAY_FLAG,,AUTO
         2 002235   002257 605000 2                  TPL     s:14045

      737    14041    2        THEN DO;

      738    14042    2             CALL DDD$MULT(DIM_CNT, MULT, ENTRY$, ENTRY#) ALTRET(VERR);

  14042  2 002236   200070 633500                    EPPR3   ENTRY#,,AUTO
         2 002237   200163 453500                    STP3    CNT+5,,AUTO
         2 002240   200010 634500                    EPPR4   ENTRY$,,AUTO
         2 002241   200162 454500                    STP4    CNT+4,,AUTO
         2 002242   200026 635500                    EPPR5   MULT,,AUTO
         2 002243   200161 455500                    STP5    CNT+3,,AUTO
         2 002244   200021 636500                    EPPR6   DIM_CNT,,AUTO
         2 002245   200160 456500                    STP6    CNT+2,,AUTO
         2 002246   200160 630500                    EPPR0   CNT+2,,AUTO
         2 002247   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 002250   000000 701000 xent               TSX1    DDD$MULT
         2 002251   003546 702000 2                  TSX2    VERR

      739    14043    2             ZITEM.DTYP = S_D.RANGE_CNT;

  14043  2 002252   200065 470500                    LDP0    ZITEM$,,AUTO
         2 002253   000000 471400 xsym               LDP1    S_D$
         2 002254   100062 236100                    LDQ     50,,PR1
         2 002255   000022 736000                    QLS     18
         2 002256   000001 552120                    STBQ    1,'20'O,PR0

      740    14044    2           END;

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:110  
      741    14045    1        IF NOT B$VREBL.SZTYP

  14045  2 002257   200010 470500                    LDP0    ENTRY$,,AUTO
         2 002260   000001 236100                    LDQ     1,,PR0
         2 002261   000400 316007                    CANQ    256,DL
         2 002262   002270 601000 2                  TNZ     s:14048
         2 002263   000001 220100                    LDX0    1,,PR0
         2 002264   002270 601000 2                  TNZ     s:14048

      742    14046    1          AND B$VREBL.LOGSIZ = 0
      743    14047    1        THEN ZITEM.FLAGS.MDSE.D = '0'B;

  14047  2 002265   200065 471500                    LDP1    ZITEM$,,AUTO
         2 002266   000004 236000 3                  LDQ     4
         2 002267   100001 356100                    ANSQ    1,,PR1

      744    14048    1        DTYP = B$VREBL.DATATYP;

  14048  2 002270   200010 470500                    LDP0    ENTRY$,,AUTO
         2 002271   000000 236100                    LDQ     0,,PR0
         2 002272   000002 772000                    QRL     2
         2 002273   000077 376007                    ANQ     63,DL
         2 002274   200024 756100                    STQ     TEMP2,,AUTO

      745    14049    1        IF NOT B$VREBL.SZTYP

  14049  2 002275   000001 236100                    LDQ     1,,PR0
         2 002276   000400 316007                    CANQ    256,DL
         2 002277   002351 601000 2                  TNZ     s:14065

      746    14050    2        THEN DO;

      747    14051    2             IF DTYP = %INDEX1_DATATYPE OR /* %INDEX1_DATATYPE */

  14051  2 002300   200024 235100                    LDA     TEMP2,,AUTO
         2 002301   000040 115007                    CMPA    32,DL
         2 002302   002305 600000 2                  TZE     s:14053
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:111  
         2 002303   000041 115007                    CMPA    33,DL
         2 002304   002311 601000 2                  TNZ     s:14055

      748    14052    2               DTYP = %INDEX2_DATATYPE     /* %INDEX2_DATATYPE */
      749    14053    2             THEN DITEM.VALUE = 18;

  14053  2 002305   000022 235007                    LDA     18,DL
         2 002306   200064 471500                    LDP1    SDD$,,AUTO
         2 002307   100001 755100                    STA     1,,PR1
         2 002310   002653 710000 2                  TRA     s:14135

      750    14054    3             ELSE DO;

      751    14055    3                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  14055  2 002311   000000 471400 xsym               LDP1    S_D$
         2 002312   106714 235100                    LDA     3532,,PR1
         2 002313   000001 115007                    CMPA    1,DL
         2 002314   002324 601000 2                  TNZ     s:14057

      752    14056    3                  THEN DITEM.VALUE = B$VREBL.LOGSIZ * TYPESIZE_MULT(DTYP);

  14056  2 002315   200024 720100                    LXL0    TEMP2,,AUTO
         2 002316   000001 236100                    LDQ     1,,PR0
         2 002317   000022 772000                    QRL     18
         2 002320   000012 402010 1                  MPY     TYPESIZE_MULT,X0
         2 002321   200064 473500                    LDP3    SDD$,,AUTO
         2 002322   300001 756100                    STQ     1,,PR3
         2 002323   002332 710000 2                  TRA     s:14058

      753    14057    3                  ELSE DITEM.VALUE = B$VREBL.LOGSIZ * TYPESIZE_MULT_FEP(DTYP);

  14057  2 002324   200024 720100                    LXL0    TEMP2,,AUTO
         2 002325   000001 236100                    LDQ     1,,PR0
         2 002326   000022 772000                    QRL     18
         2 002327   000112 402010 1                  MPY     TYPESIZE_MULT_FEP,X0
         2 002330   200064 473500                    LDP3    SDD$,,AUTO
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:112  
         2 002331   300001 756100                    STQ     1,,PR3

      754    14058    3                  IF B$VREBL.ADDRTYP = 4   /* It's a DCB */

  14058  2 002332   200010 470500                    LDP0    ENTRY$,,AUTO
         2 002333   000000 236100                    LDQ     0,,PR0
         2 002334   007400 376007                    ANQ     3840,DL
         2 002335   002000 116007                    CMPQ    1024,DL
         2 002336   002653 601000 2                  TNZ     s:14135
         2 002337   000001 236100                    LDQ     1,,PR0
         2 002340   770000 376007                    ANQ     -4096,DL
         2 002341   010000 116007                    CMPQ    4096,DL
         2 002342   002653 601000 2                  TNZ     s:14135
         2 002343   000001 221100                    LDX1    1,,PR0
         2 002344   000001 101003                    CMPX1   1,DU
         2 002345   002653 601000 2                  TNZ     s:14135

      755    14059    3                    AND B$VREBL.LEVEL = 1  /* and this is level one entry */
      756    14060    3                    AND B$VREBL.LOGSIZ = 1 /* and schema says its one bit */
      757    14061    3                  THEN DITEM.VALUE = 36;   /* Then don't believe it !! */

  14061  2 002346   000044 235007                    LDA     36,DL
         2 002347   300001 755100                    STA     1,,PR3

      758    14062    3                END;

      759    14063    2           END;

  14063  2 002350   002653 710000 2                  TRA     s:14135

      760    14064    2        ELSE DO;                           /* Adjustable size item */

      761    14065    2             IENTRY# = B$VREBL.LOGSIZ;

  14065  2 002351   000001 236100                    LDQ     1,,PR0
         2 002352   000022 772000                    QRL     18
         2 002353   200043 756100                    STQ     IENTRY#,,AUTO
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:113  

      762    14066    2             CALL DDF$VREBL_#(IENTRY#, IENTRY$) ALTRET(BADSCHEMA);

  14066  2 002354   200046 631500                    EPPR1   IENTRY$,,AUTO
         2 002355   200161 451500                    STP1    CNT+3,,AUTO
         2 002356   200043 633500                    EPPR3   IENTRY#,,AUTO
         2 002357   200160 453500                    STP3    CNT+2,,AUTO
         2 002360   200160 630500                    EPPR0   CNT+2,,AUTO
         2 002361   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002362   000000 701000 xent               TSX1    DDF$VREBL_#
         2 002363   003543 702000 2                  TSX2    BADSCHEMA

      763    14067    2             TATYP = IENTRY$ -> B$VREBL.ADDRTYP - 1;

  14067  2 002364   200046 470500                    LDP0    IENTRY$,,AUTO
         2 002365   000000 236100                    LDQ     0,,PR0
         2 002366   000010 772000                    QRL     8
         2 002367   000017 376007                    ANQ     15,DL
         2 002370   000001 136007                    SBLQ    1,DL
         2 002371   200057 756100                    STQ     TATYP,,AUTO

      764    14068    2             DITEM.ADDR_TYPE = TATYP;      /* Set up DITEM for size of item */

  14068  2 002372   200064 471500                    LDP1    SDD$,,AUTO
         2 002373   000011 736000                    QLS     9
         2 002374   100000 552110                    STBQ    0,'10'O,PR1

      765    14069    3             DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);

  14069  2 002375   000000 470400 xsym               LDP0    S_D$
         2 002376   006714 235100                    LDA     3532,,PR0
         2 002377   000003 115007                    CMPA    3,DL
         2 002400   002402 602005 2                  TNC     s:14069+5,AL
         2 002401   002445 710000 2                  TRA     s:14079
         2 002402   002445 710000 2                  TRA     s:14079
         2 002403   002405 710000 2                  TRA     s:14071
         2 002404   002425 710000 2                  TRA     s:14075
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:114  

      766    14070    3               CASE (%HOST);

      767    14071    3                  DITEM.ADDRESS.W = IENTRY$ -> B$VREBL.ADR.W;

  14071  2 002405   200046 473500                    LDP3    IENTRY$,,AUTO
         2 002406   300000 236100                    LDQ     0,,PR3
         2 002407   777777 376003                    ANQ     -1,DU
         2 002410   000006 772000                    QRL     6
         2 002411   100001 752174                    STCQ    1,'74'O,PR1

      768    14072    3                  DITEM.ADDRESS.C = IENTRY$ -> B$VREBL.ADR.C;

  14072  2 002412   200046 473500                    LDP3    IENTRY$,,AUTO
         2 002413   300000 236100                    LDQ     0,,PR3
         2 002414   600000 376007                    ANQ     -65536,DL
         2 002415   000012 772000                    QRL     10
         2 002416   100001 752102                    STCQ    1,'02'O,PR1

      769    14073    3                  DITEM.ADDRESS.B = IENTRY$ -> B$VREBL.ADR.B;

  14073  2 002417   200046 473500                    LDP3    IENTRY$,,AUTO
         2 002420   300000 236100                    LDQ     0,,PR3
         2 002421   170000 376007                    ANQ     61440,DL
         2 002422   000014 772000                    QRL     12
         2 002423   100001 752101                    STCQ    1,'01'O,PR1
         2 002424   002450 710000 2                  TRA     s:14082

      770    14074    3               CASE (%L6);

      771    14075    3                  DITEM.ADDRESS.W = IENTRY$ -> B$VREBL.ADR6.W;

  14075  2 002425   200046 473500                    LDP3    IENTRY$,,AUTO
         2 002426   300000 236100                    LDQ     0,,PR3
         2 002427   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 002430   000004 772000                    QRL     4
         2 002431   100001 752174                    STCQ    1,'74'O,PR1
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:115  

      772    14076    3                  DITEM.ADDRESS.C = IENTRY$ -> B$VREBL.ADR6.C;

  14076  2 002432   200046 473500                    LDP3    IENTRY$,,AUTO
         2 002433   300000 236100                    LDQ     0,,PR3
         2 002434   100000 376007                    ANQ     32768,DL
         2 002435   000011 772000                    QRL     9
         2 002436   100001 752102                    STCQ    1,'02'O,PR1

      773    14077    3                  DITEM.ADDRESS.B = IENTRY$ -> B$VREBL.ADR6.B;

  14077  2 002437   200046 473500                    LDP3    IENTRY$,,AUTO
         2 002440   300000 236100                    LDQ     0,,PR3
         2 002441   070000 376007                    ANQ     28672,DL
         2 002442   000014 772000                    QRL     12
         2 002443   100001 752101                    STCQ    1,'01'O,PR1
         2 002444   002450 710000 2                  TRA     s:14082

      774    14078    3               CASE (ELSE);

      775    14079    3                  S_D.ERROR = 502;    /* E@DELBUG */

  14079  2 002445   000766 236007                    LDQ     502,DL
         2 002446   000013 756100                    STQ     11,,PR0

      776    14080    3                  ALTRETURN;

  14080  2 002447   000000 702200 xent               TSX2  ! X66_AALT

      777    14081    3               END;

      778    14082    2             TDTYP = IENTRY$ -> B$VREBL.DATATYP;

  14082  2 002450   200046 473500                    LDP3    IENTRY$,,AUTO
         2 002451   300000 236100                    LDQ     0,,PR3
         2 002452   000002 772000                    QRL     2
         2 002453   000077 376007                    ANQ     63,DL
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:116  
         2 002454   200025 756100                    STQ     TDTYP,,AUTO

      779    14083    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  14083  2 002455   006714 235100                    LDA     3532,,PR0
         2 002456   000001 115007                    CMPA    1,DL
         2 002457   002476 601000 2                  TNZ     s:14089

      780    14084    3             THEN DO;

      781    14085    3                  DITEM.SMULT = TYPESIZE_MULT(DTYP);

  14085  2 002460   200024 720100                    LXL0    TEMP2,,AUTO
         2 002461   000012 236010 1                  LDQ     TYPESIZE_MULT,X0
         2 002462   000033 736000                    QLS     27
         2 002463   100000 552140                    STBQ    0,'40'O,PR1

      782    14086    3                  DITEM.PUP.SIZE = IENTRY$ -> B$VREBL.LOGSIZ * TYPESIZE_MULT(TDTYP);

  14086  2 002464   200025 721100                    LXL1    TDTYP,,AUTO
         2 002465   200046 473500                    LDP3    IENTRY$,,AUTO
         2 002466   300001 236100                    LDQ     1,,PR3
         2 002467   000022 772000                    QRL     18
         2 002470   000012 402011 1                  MPY     TYPESIZE_MULT,X1
         2 002471   000016 736000                    QLS     14
         2 002472   100002 676100                    ERQ     2,,PR1
         2 002473   000006 376000 3                  ANQ     6
         2 002474   100002 656100                    ERSQ    2,,PR1

      783    14087    3                END;

  14087  2 002475   002513 710000 2                  TRA     s:14092

      784    14088    3             ELSE DO;

      785    14089    3                  DITEM.SMULT = TYPESIZE_MULT_FEP(DTYP);

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:117  
  14089  2 002476   200024 720100                    LXL0    TEMP2,,AUTO
         2 002477   000112 236010 1                  LDQ     TYPESIZE_MULT_FEP,X0
         2 002500   000033 736000                    QLS     27
         2 002501   100000 552140                    STBQ    0,'40'O,PR1

      786    14090    3                 DITEM.PUP.SIZE = IENTRY$ -> B$VREBL.LOGSIZ * TYPESIZE_MULT_FEP(TDTYP)
             14090                           ;

  14090  2 002502   200025 721100                    LXL1    TDTYP,,AUTO
         2 002503   200046 473500                    LDP3    IENTRY$,,AUTO
         2 002504   300001 236100                    LDQ     1,,PR3
         2 002505   000022 772000                    QRL     18
         2 002506   000112 402011 1                  MPY     TYPESIZE_MULT_FEP,X1
         2 002507   000016 736000                    QLS     14
         2 002510   100002 676100                    ERQ     2,,PR1
         2 002511   000006 376000 3                  ANQ     6
         2 002512   100002 656100                    ERSQ    2,,PR1

      787    14091    3                END;

      788    14092    2             IF FMT(TDTYP) = %PUP_FMT      /* PUP_FMT */

  14092  2 002513   000000 235011 xsym               LDA     FMT,X1
         2 002514   000035 115007                    CMPA    29,DL
         2 002515   002524 601000 2                  TNZ     s:14098

      789    14093    3             THEN DO;

      790    14094    3                  S_D.ERROR = 502;    /* E@DELBUG */

  14094  2 002516   000766 236007                    LDQ     502,DL
         2 002517   000013 756100                    STQ     11,,PR0

      791    14095    3                  CALL DDE$ERROR;

  14095  2 002520   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002521   000000 701000 xent               TSX1    DDE$ERROR
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:118  
         2 002522   000000 011000                    NOP     0

      792    14096    3                  ALTRETURN;

  14096  2 002523   000000 702200 xent               TSX2  ! X66_AALT

      793    14097    3                END;
      794    14098    2             IF TATYP = %BASED_ACODE OR TATYP = %DCB_ACODE OR TATYP = %PARM_ACODE OR
             14098                      TATYP = %SPARM_ACODE OR TATYP = %AREADEF_ACODE

  14098  2 002524   200057 236100                    LDQ     TATYP,,AUTO
         2 002525   000002 116007                    CMPQ    2,DL
         2 002526   002537 600000 2                  TZE     s:14101
         2 002527   000003 116007                    CMPQ    3,DL
         2 002530   002537 600000 2                  TZE     s:14101
         2 002531   000004 116007                    CMPQ    4,DL
         2 002532   002537 600000 2                  TZE     s:14101
         2 002533   000006 116007                    CMPQ    6,DL
         2 002534   002537 600000 2                  TZE     s:14101
         2 002535   000007 116007                    CMPQ    7,DL
         2 002536   002642 601000 2                  TNZ     s:14133

      795    14099         /* BASED_ACODE OR DCB_ACODE OR PARM_ACODE OR SPARM_ACODE OR AREADEF_ACODE */
      796    14100    3             THEN DO;
             14100                    /* Address type of size of item is based, paramater, DCB, or areadef */

      797    14101    3                  IF TATYP = %BASED_ACODE  /* BASED_ACODE */

  14101  2 002537   000002 116007                    CMPQ    2,DL
         2 002540   002544 601000 2                  TNZ     s:14106

      798    14102    4                  THEN DO;       /* Size of item is based - implied ptr required */

      799    14103    4                       DITEM.ADDR_TYPE = %BASED_ACODE; /* BASED_ACODE */

  14103  2 002541   002000 236007                    LDQ     1024,DL
         2 002542   100000 552110                    STBQ    0,'10'O,PR1
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:119  

      800    14104    4                     END;                  /* Size of item is based */

  14104  2 002543   002642 710000 2                  TRA     s:14133

      801    14105    4                  ELSE DO;

      802    14106    4                       DITEM.ADDR_TYPE = %PARM_ACODE; /* PARM_ACODE */

  14106  2 002544   004000 236007                    LDQ     2048,DL
         2 002545   100000 552110                    STBQ    0,'10'O,PR1

      803    14107    4                       CALL BUMPD$ ALTRET(VERR);

  14107  2 002546   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 002547   200155 756100                    STQ     ENTRY#+53,,AUTO
         2 002550   003707 701000 2                  TSX1    BUMPD$
         2 002551   003546 702000 2                  TSX2    VERR

      804    14108    4                       DITEM = DUMPTR;

  14108  2 002552   200064 470500                    LDP0    SDD$,,AUTO
         2 002553   000100 100400                    MLR     fill='000'O
         2 002554   000000 000010 1                  ADSC9   DUMPTR                   cn=0,n=8
         2 002555   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

      805    14109    4                       IF TATYP = %DCB_ACODE /* DCB_ACODE */

  14109  2 002556   200057 235100                    LDA     TATYP,,AUTO
         2 002557   000003 115007                    CMPA    3,DL
         2 002560   002574 601000 2                  TNZ     s:14115

      806    14110    5                       THEN DO;            /* Size of item is DCB */

      807    14111    5                            DITEM.VALUEB = DESC.ITEM(%DCB_DESC); /* DCB_DESC */

  14111  2 002561   000071 236000 xsym               LDQ     DESC+57
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:120  
         2 002562   000001 756100                    STQ     1,,PR0

      808    14112    5                            DITEM.ADDR_TYPE = %DESC_ACODE; /* DESC_ACODE */

  14112  2 002563   100000 236007                    LDQ     32768,DL
         2 002564   000000 552110                    STBQ    0,'10'O,PR0

      809    14113    5                            DITEM.SP.VD.DISP = IENTRY$ -> B$VREBL.IMPTR;

  14113  2 002565   200046 471500                    LDP1    IENTRY$,,AUTO
         2 002566   100002 236100                    LDQ     2,,PR1
         2 002567   000006 772000                    QRL     6
         2 002570   000001 676100                    ERQ     1,,PR0
         2 002571   000002 376000 3                  ANQ     2
         2 002572   000001 656100                    ERSQ    1,,PR0

      810    14114    5                          END;             /* DCB */

  14114  2 002573   002642 710000 2                  TRA     s:14133

      811    14115    4                       ELSE IF TATYP = %PARM_ACODE /* PARM_ACODE */

  14115  2 002574   000004 115007                    CMPA    4,DL
         2 002575   002614 601000 2                  TNZ     s:14122

      812    14116    5                            THEN DO;       /* Size of item is auto parameter */

      813    14117    5                                 DITEM.VALUEB = DESC.ITEM(%PARM_DESC); /* PARM_DESC */

  14117  2 002576   000067 236000 xsym               LDQ     DESC+55
         2 002577   000001 756100                    STQ     1,,PR0

      814    14118    5                                 DITEM.ADDR_TYPE = %DESC_ACODE; /* DESC_ACODE */

  14118  2 002600   100000 236007                    LDQ     32768,DL
         2 002601   000000 552110                    STBQ    0,'10'O,PR0

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:121  
      815    14119    5                                 DITEM.SP.VP.N = IENTRY$ -> B$VREBL.IMPTR - 2;

  14119  2 002602   200046 471500                    LDP1    IENTRY$,,AUTO
         2 002603   100002 236100                    LDQ     2,,PR1
         2 002604   000022 732000                    QRS     18
         2 002605   000002 136007                    SBLQ    2,DL
         2 002606   000014 736000                    QLS     12
         2 002607   000001 752134                    STCQ    1,'34'O,PR0

      816    14120    5                                 ZITEM.FLAGS.MDSE.S = '1'B;

  14120  2 002610   200065 471500                    LDP1    ZITEM$,,AUTO
         2 002611   100000 236003                    LDQ     32768,DU
         2 002612   100001 256100                    ORSQ    1,,PR1

      817    14121    5                               END;        /* Auto parameter */

  14121  2 002613   002642 710000 2                  TRA     s:14133

      818    14122    4                            ELSE IF TATYP = %SPARM_ACODE /* SPARM_ACODE */

  14122  2 002614   000006 115007                    CMPA    6,DL
         2 002615   002626 601000 2                  TNZ     s:14128

      819    14123    5                                 THEN DO;  /* Size of item is static parameter */

      820    14124    5                                      DITEM.ADDRESS.W = IENTRY$ -> B$VREBL.IMPTR;

  14124  2 002616   200046 471500                    LDP1    IENTRY$,,AUTO
         2 002617   100002 236100                    LDQ     2,,PR1
         2 002620   000022 732000                    QRS     18
         2 002621   000014 736000                    QLS     12
         2 002622   000001 752174                    STCQ    1,'74'O,PR0

      821    14125    5                                     DITEM.ADDR_TYPE = %SPARM_ACODE; /* SPARM_ACODE */

  14125  2 002623   006000 236007                    LDQ     3072,DL
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:122  
         2 002624   000000 552110                    STBQ    0,'10'O,PR0

      822    14126    5                                    END;   /* Static parameter */

  14126  2 002625   002642 710000 2                  TRA     s:14133

      823    14127    5                                 ELSE DO;  /* Size of item is areadef */

      824    14128    5                                     DITEM.ADDR_TYPE = %CONST_ACODE; /* CONST_ACODE */

  14128  2 002626   102000 236007                    LDQ     33792,DL
         2 002627   000000 552110                    STBQ    0,'10'O,PR0

      825    14129    5                                     DITEM.VALUE = PINCRW(IENTRY$, POFFW(ADDR(B$VREBL.
             14129                                               IMPTR), ADDR(B$VREBL))) -> UBIN36;

  14129  2 002630   200010 236100                    LDQ     ENTRY$,,AUTO
         2 002631   000022 772000                    QRL     18
         2 002632   200160 756100                    STQ     CNT+2,,AUTO
         2 002633   200010 236100                    LDQ     ENTRY$,,AUTO
         2 002634   000002 036003                    ADLQ    2,DU
         2 002635   000022 772000                    QRL     18
         2 002636   200160 136100                    SBLQ    CNT+2,,AUTO
         2 002637   200046 471500                    LDP1    IENTRY$,,AUTO
         2 002640   100000 235106                    LDA     0,QL,PR1
         2 002641   000001 755100                    STA     1,,PR0

      826    14130    5                                    END;   /* Areadef */

      827    14131    4                     END;                  /* NOT BASED_ACODE */

      828    14132    3                END;
             14132                     /* Address type of size of item is based, parameter, DCB or areadef */

      829    14133    2             CALL DDF$VREBL_#(ENTRY#.E(ENTRY#.C), ENTRY$) ALTRET(BADSCHEMA);
             14133                      /* RE-ESTAB. VAR */

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:123  
  14133  2 002642   200010 630500                    EPPR0   ENTRY$,,AUTO
         2 002643   200161 450500                    STP0    CNT+3,,AUTO
         2 002644   200070 720100                    LXL0    ENTRY#,,AUTO
         2 002645   200071 631510                    EPPR1   ENTRY#+1,X0,AUTO
         2 002646   200160 451500                    STP1    CNT+2,,AUTO
         2 002647   200160 630500                    EPPR0   CNT+2,,AUTO
         2 002650   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002651   000000 701000 xent               TSX1    DDF$VREBL_#
         2 002652   003543 702000 2                  TSX2    BADSCHEMA

      830    14134    2           END;                            /* Adjustable size item */

      831    14135    1        IF DTYP = %STRUCTURE_DATATYPE      /* STRUCTURE_DATATYPE */

  14135  2 002653   200024 235100                    LDA     TEMP2,,AUTO
         2 002654   000021 115007                    CMPA    17,DL
         2 002655   002664 601000 2                  TNZ     s:14138
         2 002656   200064 470500                    LDP0    SDD$,,AUTO
         2 002657   000001 235100                    LDA     1,,PR0
         2 002660   000111 115007                    CMPA    73,DL
         2 002661   002664 603000 2                  TRC     s:14138

      832    14136    1          AND DITEM.VALUE < 73
      833    14137    1        THEN DTYP = %BIT_DATATYPE;         /* %BIT_DATATYPE */

  14137  2 002662   000023 236007                    LDQ     19,DL
         2 002663   200024 756100                    STQ     TEMP2,,AUTO

      834    14138    1        IF DTYP = %BIT_DATATYPE            /* %BIT_DATATYPE */

  14138  2 002664   200024 235100                    LDA     TEMP2,,AUTO
         2 002665   000023 115007                    CMPA    19,DL
         2 002666   002704 601000 2                  TNZ     s:14145
         2 002667   200064 470500                    LDP0    SDD$,,AUTO
         2 002670   000001 235100                    LDA     1,,PR0
         2 002671   000004 115007                    CMPA    4,DL
         2 002672   002704 602000 2                  TNC     s:14145
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:124  

      835    14139    1          AND DITEM.VALUE > 3
      836    14140    2        THEN DO;

      837    14141    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  14141  2 002673   000000 471400 xsym               LDP1    S_D$
         2 002674   106714 235100                    LDA     3532,,PR1
         2 002675   000001 115007                    CMPA    1,DL
         2 002676   002702 601000 2                  TNZ     s:14143

      838    14142    2             THEN DTYP = %OCT_DATATYPE;    /* OCT_DATATYPE */

  14142  2 002677   000070 236007                    LDQ     56,DL
         2 002700   200024 756100                    STQ     TEMP2,,AUTO
         2 002701   002704 710000 2                  TRA     s:14145

      839    14143    2             ELSE DTYP = %X_DATATYPE;      /* OCT_DATATYPE */

  14143  2 002702   000071 236007                    LDQ     57,DL
         2 002703   200024 756100                    STQ     TEMP2,,AUTO

      840    14144    2           END;

      841    14145    1        ZITEM.ADDR_TYPE = ATYP;

  14145  2 002704   200065 470500                    LDP0    ZITEM$,,AUTO
         2 002705   200023 236100                    LDQ     TEMP1,,AUTO
         2 002706   000022 736000                    QLS     18
         2 002707   000006 552120                    STBQ    6,'20'O,PR0

      842    14146    1        IF DTYP = %INDEX1_DATATYPE OR      /* %INDEX1_DATATYPE */

  14146  2 002710   200024 235100                    LDA     TEMP2,,AUTO
         2 002711   000040 115007                    CMPA    32,DL
         2 002712   002715 600000 2                  TZE     s:14149
         2 002713   000041 115007                    CMPA    33,DL
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:125  
         2 002714   003057 601000 2                  TNZ     s:14186

      843    14147    1          DTYP = %INDEX2_DATATYPE          /* %INDEX2_DATATYPE */
      844    14148    2        THEN DO;

      845    14149    2             ZITEM.DATA_TYPE = %SBIN_DATATYPE; /* %SBIN_DATATYPE */

  14149  2 002715   000001 236007                    LDQ     1,DL
         2 002716   000006 552104                    STBQ    6,'04'O,PR0

      846    14150    3             DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);

  14150  2 002717   000000 471400 xsym               LDP1    S_D$
         2 002720   106714 235100                    LDA     3532,,PR1
         2 002721   000003 115007                    CMPA    3,DL
         2 002722   002724 602005 2                  TNC     s:14150+5,AL
         2 002723   002745 710000 2                  TRA     s:14156
         2 002724   002745 710000 2                  TRA     s:14156
         2 002725   002727 710000 2                  TRA     s:14152
         2 002726   002736 710000 2                  TRA     s:14154

      847    14151    3               CASE (%HOST);

      848    14152    3                  ZITEM.ADDRESS.W = B$VREBL.ADR.W + 1;

  14152  2 002727   200010 473500                    LDP3    ENTRY$,,AUTO
         2 002730   300000 236100                    LDQ     0,,PR3
         2 002731   000022 772000                    QRL     18
         2 002732   000001 036007                    ADLQ    1,DL
         2 002733   000014 736000                    QLS     12
         2 002734   000007 752174                    STCQ    7,'74'O,PR0
         2 002735   002750 710000 2                  TRA     s:14159

      849    14153    3               CASE (%L6);

      850    14154    3                  ZITEM.ADDRESS.W = B$VREBL.ADR6.W + 1;

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:126  
  14154  2 002736   200010 473500                    LDP3    ENTRY$,,AUTO
         2 002737   300000 236100                    LDQ     0,,PR3
         2 002740   000020 772000                    QRL     16
         2 002741   000001 036007                    ADLQ    1,DL
         2 002742   000014 736000                    QLS     12
         2 002743   000007 752174                    STCQ    7,'74'O,PR0
         2 002744   002750 710000 2                  TRA     s:14159

      851    14155    3               CASE (ELSE);

      852    14156    3                  S_D.ERROR = 502;    /* E@DELBUG */

  14156  2 002745   000766 235007                    LDA     502,DL
         2 002746   100013 755100                    STA     11,,PR1

      853    14157    3                  ALTRETURN;

  14157  2 002747   000000 702200 xent               TSX2  ! X66_AALT

      854    14158    3               END;

      855    14159    2             IF DTYP = %INDEX1_DATATYPE    /* %INDEX1_DATATYPE */

  14159  2 002750   200024 235100                    LDA     TEMP2,,AUTO
         2 002751   000040 115007                    CMPA    32,DL
         2 002752   003017 601000 2                  TNZ     s:14173

      856    14160    2             THEN
      857    14161    3             DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);

  14161  2 002753   106714 235100                    LDA     3532,,PR1
         2 002754   000003 115007                    CMPA    3,DL
         2 002755   002757 602005 2                  TNC     s:14161+4,AL
         2 002756   003014 710000 2                  TRA     s:14169
         2 002757   003014 710000 2                  TRA     s:14169
         2 002760   002762 710000 2                  TRA     s:14163
         2 002761   002777 710000 2                  TRA     s:14166
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:127  

      858    14162    3               CASE (%HOST);

      859    14163    3                  ZITEM.ADDRESS.C = B$VREBL.ADR.C + 2;

  14163  2 002762   200010 473500                    LDP3    ENTRY$,,AUTO
         2 002763   300000 236100                    LDQ     0,,PR3
         2 002764   000020 772000                    QRL     16
         2 002765   000003 376007                    ANQ     3,DL
         2 002766   000002 036007                    ADLQ    2,DL
         2 002767   000006 736000                    QLS     6
         2 002770   000007 752102                    STCQ    7,'02'O,PR0

      860    14164    3                  ZITEM.ADDRESS.B = B$VREBL.ADR.B;

  14164  2 002771   200010 473500                    LDP3    ENTRY$,,AUTO
         2 002772   300000 236100                    LDQ     0,,PR3
         2 002773   170000 376007                    ANQ     61440,DL
         2 002774   000014 772000                    QRL     12
         2 002775   000007 752101                    STCQ    7,'01'O,PR0
         2 002776   003134 710000 2                  TRA     s:14201

      861    14165    3               CASE (%L6);

      862    14166    3                  ZITEM.ADDRESS.C = B$VREBL.ADR6.C + 2;

  14166  2 002777   200010 473500                    LDP3    ENTRY$,,AUTO
         2 003000   300000 236100                    LDQ     0,,PR3
         2 003001   000017 772000                    QRL     15
         2 003002   000001 376007                    ANQ     1,DL
         2 003003   000002 036007                    ADLQ    2,DL
         2 003004   000006 736000                    QLS     6
         2 003005   000007 752102                    STCQ    7,'02'O,PR0

      863    14167    3                  ZITEM.ADDRESS.B = B$VREBL.ADR6.B;

  14167  2 003006   200010 473500                    LDP3    ENTRY$,,AUTO
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:128  
         2 003007   300000 236100                    LDQ     0,,PR3
         2 003010   070000 376007                    ANQ     28672,DL
         2 003011   000014 772000                    QRL     12
         2 003012   000007 752101                    STCQ    7,'01'O,PR0
         2 003013   003134 710000 2                  TRA     s:14201

      864    14168    3               CASE (ELSE);

      865    14169    3                  S_D.ERROR = 502;    /* E@DELBUG */

  14169  2 003014   000766 236007                    LDQ     502,DL
         2 003015   100013 756100                    STQ     11,,PR1

      866    14170    3                  ALTRETURN;

  14170  2 003016   000000 702200 xent               TSX2  ! X66_AALT

      867    14171    3               END;

      868    14172    2             ELSE
      869    14173    3             DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);

  14173  2 003017   106714 235100                    LDA     3532,,PR1
         2 003020   000003 115007                    CMPA    3,DL
         2 003021   003023 602005 2                  TNC     s:14173+4,AL
         2 003022   003054 710000 2                  TRA     s:14181
         2 003023   003054 710000 2                  TRA     s:14181
         2 003024   003026 710000 2                  TRA     s:14175
         2 003025   003041 710000 2                  TRA     s:14178

      870    14174    3               CASE (%HOST);

      871    14175    3                  ZITEM.ADDRESS.C = B$VREBL.ADR.C;

  14175  2 003026   200010 473500                    LDP3    ENTRY$,,AUTO
         2 003027   300000 236100                    LDQ     0,,PR3
         2 003030   600000 376007                    ANQ     -65536,DL
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:129  
         2 003031   000012 772000                    QRL     10
         2 003032   000007 752102                    STCQ    7,'02'O,PR0

      872    14176    3                  ZITEM.ADDRESS.B = B$VREBL.ADR.B;

  14176  2 003033   200010 473500                    LDP3    ENTRY$,,AUTO
         2 003034   300000 236100                    LDQ     0,,PR3
         2 003035   170000 376007                    ANQ     61440,DL
         2 003036   000014 772000                    QRL     12
         2 003037   000007 752101                    STCQ    7,'01'O,PR0
         2 003040   003134 710000 2                  TRA     s:14201

      873    14177    3               CASE (%L6);

      874    14178    3                  ZITEM.ADDRESS.C = B$VREBL.ADR6.C;

  14178  2 003041   200010 473500                    LDP3    ENTRY$,,AUTO
         2 003042   300000 236100                    LDQ     0,,PR3
         2 003043   100000 376007                    ANQ     32768,DL
         2 003044   000011 772000                    QRL     9
         2 003045   000007 752102                    STCQ    7,'02'O,PR0

      875    14179    3                  ZITEM.ADDRESS.B = B$VREBL.ADR6.B;

  14179  2 003046   200010 473500                    LDP3    ENTRY$,,AUTO
         2 003047   300000 236100                    LDQ     0,,PR3
         2 003050   070000 376007                    ANQ     28672,DL
         2 003051   000014 772000                    QRL     12
         2 003052   000007 752101                    STCQ    7,'01'O,PR0
         2 003053   003134 710000 2                  TRA     s:14201

      876    14180    3               CASE (ELSE);

      877    14181    3                  S_D.ERROR = 502;    /* E@DELBUG */

  14181  2 003054   000766 236007                    LDQ     502,DL
         2 003055   100013 756100                    STQ     11,,PR1
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:130  

      878    14182    3                  ALTRETURN;

  14182  2 003056   000000 702200 xent               TSX2  ! X66_AALT

      879    14183    3               END;

      880    14184    2           END;
      881    14185    2        ELSE DO;

      882    14186    2             ZITEM.DATA_TYPE = DTYP;

  14186  2 003057   200024 236100                    LDQ     TEMP2,,AUTO
         2 003060   000006 552104                    STBQ    6,'04'O,PR0

      883    14187    3             DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);

  14187  2 003061   000000 471400 xsym               LDP1    S_D$
         2 003062   106714 235100                    LDA     3532,,PR1
         2 003063   000003 115007                    CMPA    3,DL
         2 003064   003066 602005 2                  TNC     s:14187+5,AL
         2 003065   003131 710000 2                  TRA     s:14197
         2 003066   003131 710000 2                  TRA     s:14197
         2 003067   003071 710000 2                  TRA     s:14189
         2 003070   003111 710000 2                  TRA     s:14193

      884    14188    3               CASE (%HOST);

      885    14189    3                  ZITEM.ADDRESS.W = B$VREBL.ADR.W;

  14189  2 003071   200010 473500                    LDP3    ENTRY$,,AUTO
         2 003072   300000 236100                    LDQ     0,,PR3
         2 003073   777777 376003                    ANQ     -1,DU
         2 003074   000006 772000                    QRL     6
         2 003075   000007 752174                    STCQ    7,'74'O,PR0

      886    14190    3                  ZITEM.ADDRESS.C = B$VREBL.ADR.C;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:131  

  14190  2 003076   200010 473500                    LDP3    ENTRY$,,AUTO
         2 003077   300000 236100                    LDQ     0,,PR3
         2 003100   600000 376007                    ANQ     -65536,DL
         2 003101   000012 772000                    QRL     10
         2 003102   000007 752102                    STCQ    7,'02'O,PR0

      887    14191    3                  ZITEM.ADDRESS.B = B$VREBL.ADR.B;

  14191  2 003103   200010 473500                    LDP3    ENTRY$,,AUTO
         2 003104   300000 236100                    LDQ     0,,PR3
         2 003105   170000 376007                    ANQ     61440,DL
         2 003106   000014 772000                    QRL     12
         2 003107   000007 752101                    STCQ    7,'01'O,PR0
         2 003110   003134 710000 2                  TRA     s:14201

      888    14192    3               CASE (%L6);

      889    14193    3                  ZITEM.ADDRESS.W = B$VREBL.ADR6.W;

  14193  2 003111   200010 473500                    LDP3    ENTRY$,,AUTO
         2 003112   300000 236100                    LDQ     0,,PR3
         2 003113   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 003114   000004 772000                    QRL     4
         2 003115   000007 752174                    STCQ    7,'74'O,PR0

      890    14194    3                  ZITEM.ADDRESS.C = B$VREBL.ADR6.C;

  14194  2 003116   200010 473500                    LDP3    ENTRY$,,AUTO
         2 003117   300000 236100                    LDQ     0,,PR3
         2 003120   100000 376007                    ANQ     32768,DL
         2 003121   000011 772000                    QRL     9
         2 003122   000007 752102                    STCQ    7,'02'O,PR0

      891    14195    3                  ZITEM.ADDRESS.B = B$VREBL.ADR6.B;

  14195  2 003123   200010 473500                    LDP3    ENTRY$,,AUTO
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:132  
         2 003124   300000 236100                    LDQ     0,,PR3
         2 003125   070000 376007                    ANQ     28672,DL
         2 003126   000014 772000                    QRL     12
         2 003127   000007 752101                    STCQ    7,'01'O,PR0
         2 003130   003134 710000 2                  TRA     s:14201

      892    14196    3               CASE (ELSE);

      893    14197    3                  S_D.ERROR = 502;    /* E@DELBUG */

  14197  2 003131   000766 235007                    LDA     502,DL
         2 003132   100013 755100                    STA     11,,PR1

      894    14198    3                  ALTRETURN;

  14198  2 003133   000000 702200 xent               TSX2  ! X66_AALT

      895    14199    3               END;

      896    14200    2           END;
      897    14201    1        IF IMPLF4

  14201  2 003134   200062 234100                    SZN     IMPLF4,,AUTO
         2 003135   003166 605000 2                  TPL     s:14207

      898    14202    2        THEN DO;

      899    14203    2             NCHARS = ZITEM.ADDRESS.W * 4 + ZITEM.ADDRESS.C - B$VREBL.ELMNTSIZ / 9;

  14203  2 003136   000007 236100                    LDQ     7,,PR0
         2 003137   000006 772000                    QRL     6
         2 003140   000077 376007                    ANQ     63,DL
         2 003141   200160 756100                    STQ     CNT+2,,AUTO
         2 003142   000007 236100                    LDQ     7,,PR0
         2 003143   000012 772000                    QRL     10
         2 003144   000007 376000 3                  ANQ     7
         2 003145   200160 036100                    ADLQ    CNT+2,,AUTO
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:133  
         2 003146   200010 473500                    LDP3    ENTRY$,,AUTO
         2 003147   200161 756100                    STQ     CNT+3,,AUTO
         2 003150   300003 236100                    LDQ     3,,PR3
         2 003151   000014 772000                    QRL     12
         2 003152   000011 506007                    DIV     9,DL
         2 003153   200162 756100                    STQ     CNT+4,,AUTO
         2 003154   200161 236100                    LDQ     CNT+3,,AUTO
         2 003155   200162 136100                    SBLQ    CNT+4,,AUTO
         2 003156   200063 756100                    STQ     NCHARS,,AUTO

      900    14204    2             ZITEM.ADDRESS.W = NCHARS / 4;

  14204  2 003157   000002 772000                    QRL     2
         2 003160   000014 736000                    QLS     12
         2 003161   000007 752174                    STCQ    7,'74'O,PR0

      901    14205    2             ZITEM.ADDRESS.C = MOD(NCHARS , 4);

  14205  2 003162   200063 236100                    LDQ     NCHARS,,AUTO
         2 003163   000003 376007                    ANQ     3,DL
         2 003164   000006 736000                    QLS     6
         2 003165   000007 752102                    STCQ    7,'02'O,PR0

      902    14206    2           END;

      903    14207    1        IF FMT(DTYP) = %CANT_FMT           /* CANT_FMT */

  14207  2 003166   200024 720100                    LXL0    TEMP2,,AUTO
         2 003167   000000 235010 xsym               LDA     FMT,X0
         2 003170   000036 115007                    CMPA    30,DL
         2 003171   003174 601000 2                  TNZ     s:14209

      904    14208    1        THEN ZITEM.FLAGS.MDSE.D = '0'B;

  14208  2 003172   000004 236000 3                  LDQ     4
         2 003173   000001 356100                    ANSQ    1,,PR0

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:134  
      905    14209    1        IF FMT( DTYP ) = %PUP_FMT          /* PUP_FMT */

  14209  2 003174   000000 235010 xsym               LDA     FMT,X0
         2 003175   000035 115007                    CMPA    29,DL
         2 003176   003324 601000 2                  TNZ     s:14237

      906    14210    2        THEN DO;                           /* Packed - Unpacked formats */

      907    14211    3             DO CASE( DTYP );

  14211  2 003177   200024 236100                    LDQ     TEMP2,,AUTO
         2 003200   000011 136007                    SBLQ    9,DL
         2 003201   000045 116007                    CMPQ    37,DL
         2 003202   003204 602006 2                  TNC     s:14211+5,QL
         2 003203   003304 710000 2                  TRA     s:14231
         2 003204   003251 710000 2                  TRA     s:14213
         2 003205   003304 710000 2                  TRA     s:14231
         2 003206   003304 710000 2                  TRA     s:14231
         2 003207   003304 710000 2                  TRA     s:14231
         2 003210   003304 710000 2                  TRA     s:14231
         2 003211   003304 710000 2                  TRA     s:14231
         2 003212   003304 710000 2                  TRA     s:14231
         2 003213   003304 710000 2                  TRA     s:14231
         2 003214   003304 710000 2                  TRA     s:14231
         2 003215   003304 710000 2                  TRA     s:14231
         2 003216   003304 710000 2                  TRA     s:14231
         2 003217   003304 710000 2                  TRA     s:14231
         2 003220   003304 710000 2                  TRA     s:14231
         2 003221   003304 710000 2                  TRA     s:14231
         2 003222   003304 710000 2                  TRA     s:14231
         2 003223   003304 710000 2                  TRA     s:14231
         2 003224   003254 710000 2                  TRA     s:14215
         2 003225   003304 710000 2                  TRA     s:14231
         2 003226   003304 710000 2                  TRA     s:14231
         2 003227   003304 710000 2                  TRA     s:14231
         2 003230   003304 710000 2                  TRA     s:14231
         2 003231   003304 710000 2                  TRA     s:14231
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:135  
         2 003232   003257 710000 2                  TRA     s:14217
         2 003233   003304 710000 2                  TRA     s:14231
         2 003234   003304 710000 2                  TRA     s:14231
         2 003235   003304 710000 2                  TRA     s:14231
         2 003236   003304 710000 2                  TRA     s:14231
         2 003237   003304 710000 2                  TRA     s:14231
         2 003240   003304 710000 2                  TRA     s:14231
         2 003241   003304 710000 2                  TRA     s:14231
         2 003242   003304 710000 2                  TRA     s:14231
         2 003243   003262 710000 2                  TRA     s:14219
         2 003244   003265 710000 2                  TRA     s:14221
         2 003245   003270 710000 2                  TRA     s:14223
         2 003246   003273 710000 2                  TRA     s:14225
         2 003247   003276 710000 2                  TRA     s:14227
         2 003250   003301 710000 2                  TRA     s:14229

      908    14212    3               CASE( 9 );                  /* Packed, leading, ASCII */

      909    14213    3                  TBITS = '010100'B;

  14213  2 003251   240000 236003                    LDQ     81920,DU
         2 003252   200060 756100                    STQ     TBITS,,AUTO
         2 003253   003311 710000 2                  TRA     s:14234

      910    14214    3               CASE( 25 );                 /* Packed, trailing, ASCII */

      911    14215    3                  TBITS = '011000'B;

  14215  2 003254   300000 236003                    LDQ     98304,DU
         2 003255   200060 756100                    STQ     TBITS,,AUTO
         2 003256   003311 710000 2                  TRA     s:14234

      912    14216    3               CASE( 31 );                 /* Packed, trailing, EBCDIC */

      913    14217    3                  TBITS = '011010'B;

  14217  2 003257   320000 236003                    LDQ     106496,DU
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:136  
         2 003260   200060 756100                    STQ     TBITS,,AUTO
         2 003261   003311 710000 2                  TRA     s:14234

      914    14218    3               CASE( 40 );                 /* Packed, unsigned */

      915    14219    3                  TBITS = '010000'B;

  14219  2 003262   200000 236003                    LDQ     65536,DU
         2 003263   200060 756100                    STQ     TBITS,,AUTO
         2 003264   003311 710000 2                  TRA     s:14234

      916    14220    3               CASE( 41 );                 /* Unpacked, unsigned */

      917    14221    3                  TBITS = '100000'B;

  14221  2 003265   400000 236003                    LDQ     -131072,DU
         2 003266   200060 756100                    STQ     TBITS,,AUTO
         2 003267   003311 710000 2                  TRA     s:14234

      918    14222    3               CASE( 42 );                 /* Unpacked, leading, separate */

      919    14223    3                  TBITS = '100100'B;

  14223  2 003270   440000 236003                    LDQ     -114688,DU
         2 003271   200060 756100                    STQ     TBITS,,AUTO
         2 003272   003311 710000 2                  TRA     s:14234

      920    14224    3               CASE( 43 );                 /* Unpacked, trailing, separate */

      921    14225    3                  TBITS = '101000'B;

  14225  2 003273   500000 236003                    LDQ     -98304,DU
         2 003274   200060 756100                    STQ     TBITS,,AUTO
         2 003275   003311 710000 2                  TRA     s:14234

      922    14226    3               CASE( 44 );                 /* Unpacked, leading, overpunched */

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:137  
      923    14227    3                  TBITS = '100101'B;

  14227  2 003276   450000 236003                    LDQ     -110592,DU
         2 003277   200060 756100                    STQ     TBITS,,AUTO
         2 003300   003311 710000 2                  TRA     s:14234

      924    14228    3               CASE( 45 );                 /* Unpacked, trailing, overpunched */

      925    14229    3                  TBITS = '101001'B;

  14229  2 003301   510000 236003                    LDQ     -94208,DU
         2 003302   200060 756100                    STQ     TBITS,,AUTO
         2 003303   003311 710000 2                  TRA     s:14234

      926    14230    3               CASE(ELSE);

      927    14231    3                  S_D.ERROR = 502;    /* E@DELBUG */

  14231  2 003304   000766 235007                    LDA     502,DL
         2 003305   100013 755100                    STA     11,,PR1

      928    14232    3                  CALL DDE$ERROR;

  14232  2 003306   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 003307   000000 701000 xent               TSX1    DDE$ERROR
         2 003310   000000 011000                    NOP     0

      929    14233    3               END;                        /* DO CASE( DTYP ) */

      930    14234    2             ZITEM.PUP.BITS = TBITS;

  14234  2 003311   200065 470500                    LDP0    ZITEM$,,AUTO
         2 003312   200060 236100                    LDQ     TBITS,,AUTO
         2 003313   000036 772000                    QRL     30
         2 003314   000010 752101                    STCQ    8,'01'O,PR0

      931    14235    2             ZITEM.PUP.SCALE = B$VREBL.SCALE;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:138  

  14235  2 003315   200010 471500                    LDP1    ENTRY$,,AUTO
         2 003316   100003 236100                    LDQ     3,,PR1
         2 003317   000006 736000                    QLS     6
         2 003320   000010 676100                    ERQ     8,,PR0
         2 003321   037700 376007                    ANQ     16320,DL
         2 003322   000010 656100                    ERSQ    8,,PR0

      932    14236    2           END;                            /* Packed - Unpacked formats */

  14236  2 003323   003325 710000 2                  TRA     DONE

      933    14237    1        ELSE ZITEM.PUP = '0'B;             /* Binary, no scale */

  14237  2 003324   000010 450100                    STZ     8,,PR0

      934    14238    1   DONE:
      935    14239    1        IF ADDREXP_FLAG

  14239  2 003325   200016 234100       DONE         SZN     ADDREXP_FLAG,,AUTO
         2 003326   003342 605000 2                  TPL     s:14243
         2 003327   200065 470500                    LDP0    ZITEM$,,AUTO
         2 003330   000001 236100                    LDQ     1,,PR0
         2 003331   000777 376003                    ANQ     511,DU
         2 003332   000003 116003                    CMPQ    3,DU
         2 003333   003342 600000 2                  TZE     s:14243
         2 003334   000006 236100                    LDQ     6,,PR0
         2 003335   000777 376007                    ANQ     511,DL
         2 003336   000067 116007                    CMPQ    55,DL
         2 003337   003342 600000 2                  TZE     s:14243

      936    14240    1          AND ZITEM.DTYP ~= %SPEC_DTYP     /* SPEC_DTYP */
      937    14241    1          AND ZITEM.DATA_TYPE ~= %INST_DATATYPE /* INST_DATATYPE */
      938    14242    1        THEN ZITEM.DATA_TYPE = %OCT_DATATYPE; /* OCT_DATATYPE */

  14242  2 003340   000070 236007                    LDQ     56,DL
         2 003341   000006 552104                    STBQ    6,'04'O,PR0
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:139  

      939    14243    1        CALL BUMPD$ ALTRET(VERR);

  14243  2 003342   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 003343   200155 756100                    STQ     ENTRY#+53,,AUTO
         2 003344   003707 701000 2                  TSX1    BUMPD$
         2 003345   003546 702000 2                  TSX2    VERR

      940    14244    1        ZITEM.SIZE = POFFW(SDD$, S_D.DESC$);

  14244  2 003346   000000 470400 xsym               LDP0    S_D$
         2 003347   000041 236100                    LDQ     33,,PR0
         2 003350   000022 772000                    QRL     18
         2 003351   200160 756100                    STQ     CNT+2,,AUTO
         2 003352   200064 236100                    LDQ     SDD$,,AUTO
         2 003353   000022 772000                    QRL     18
         2 003354   200160 136100                    SBLQ    CNT+2,,AUTO
         2 003355   200065 471500                    LDP1    ZITEM$,,AUTO
         2 003356   100000 756100                    STQ     0,,PR1

      941    14245    1        TEMP1 = ZITEM.SIZE;

  14245  2 003357   200023 756100                    STQ     TEMP1,,AUTO

      942    14246    1        IF STATUS_EXISTS

  14246  2 003360   200017 234100                    SZN     STATUS_EXISTS,,AUTO
         2 003361   003535 605000 2                  TPL     s:14275

      943    14247    2        THEN DO;

      944    14248    2             ZITEM.NAMEFLAGS.STATUS_EXISTS = '1'B;

  14248  2 003362   200000 236003                    LDQ     65536,DU
         2 003363   100003 256100                    ORSQ    3,,PR1

      945    14249    3             DO I = 0 TO TEMP1 - 1;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:140  

  14249  2 003364   200036 450100                    STZ     I,,AUTO
         2 003365   003401 710000 2                  TRA     s:14253+1

      946    14250    3                  SDD$ -> UBIN36 = ZITEM$ -> UBIN36;

  14250  2 003366   200065 470500                    LDP0    ZITEM$,,AUTO
         2 003367   200064 471500                    LDP1    SDD$,,AUTO
         2 003370   000000 235100                    LDA     0,,PR0
         2 003371   100000 755100                    STA     0,,PR1

      947    14251    3                  SDD$ = PINCRW(SDD$, 1);

  14251  2 003372   200064 236100                    LDQ     SDD$,,AUTO
         2 003373   000001 036003                    ADLQ    1,DU
         2 003374   200064 756100                    STQ     SDD$,,AUTO

      948    14252    3                  ZITEM$ = PINCRW(ZITEM$, 1);

  14252  2 003375   200065 236100                    LDQ     ZITEM$,,AUTO
         2 003376   000001 036003                    ADLQ    1,DU
         2 003377   200065 756100                    STQ     ZITEM$,,AUTO

      949    14253    3                END;

  14253  2 003400   200036 054100                    AOS     I,,AUTO
         2 003401   200036 236100                    LDQ     I,,AUTO
         2 003402   200023 116100                    CMPQ    TEMP1,,AUTO
         2 003403   003366 604000 2                  TMI     s:14250

      950    14254    2             S_D.D$ = SDD$;

  14254  2 003404   200064 236100                    LDQ     SDD$,,AUTO
         2 003405   000000 470400 xsym               LDP0    S_D$
         2 003406   000044 756100                    STQ     36,,PR0

      951    14255    2             ZITEM.SIZE = POFFW(SDD$, ZITEM$);
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:141  

  14255  2 003407   200065 235100                    LDA     ZITEM$,,AUTO
         2 003410   000022 771000                    ARL     18
         2 003411   200160 755100                    STA     CNT+2,,AUTO
         2 003412   200064 236100                    LDQ     SDD$,,AUTO
         2 003413   000022 772000                    QRL     18
         2 003414   200160 136100                    SBLQ    CNT+2,,AUTO
         2 003415   200065 471500                    LDP1    ZITEM$,,AUTO
         2 003416   100000 756100                    STQ     0,,PR1

      952    14256    2             SDD$ = PINCRW(SDD$, -3);

  14256  2 003417   200064 236100                    LDQ     SDD$,,AUTO
         2 003420   777775 036003                    ADLQ    -3,DU
         2 003421   200064 756100                    STQ     SDD$,,AUTO

      953    14257    2             KENTRY# = ENTRY#.E(ENTRY#.C) + 1;

  14257  2 003422   200070 720100                    LXL0    ENTRY#,,AUTO
         2 003423   200071 235110                    LDA     ENTRY#+1,X0,AUTO
         2 003424   000001 035007                    ADLA    1,DL
         2 003425   200051 755100                    STA     KENTRY#,,AUTO

      954    14258    2             CALL DDF$VREBL_#(KENTRY#, ENTRY$) ALTRET(BADSCHEMA);

  14258  2 003426   200010 633500                    EPPR3   ENTRY$,,AUTO
         2 003427   200161 453500                    STP3    CNT+3,,AUTO
         2 003430   200051 634500                    EPPR4   KENTRY#,,AUTO
         2 003431   200160 454500                    STP4    CNT+2,,AUTO
         2 003432   200160 630500                    EPPR0   CNT+2,,AUTO
         2 003433   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 003434   000000 701000 xent               TSX1    DDF$VREBL_#
         2 003435   003543 702000 2                  TSX2    BADSCHEMA

      955    14259    2             IENTRY# = KENTRY# + 1;

  14259  2 003436   200051 235100                    LDA     KENTRY#,,AUTO
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:142  
         2 003437   000001 035007                    ADLA    1,DL
         2 003440   200043 755100                    STA     IENTRY#,,AUTO

      956    14260    2             CALL DDF$VREBL_#(IENTRY#, IENTRY$) ALTRET(BADSCHEMA);

  14260  2 003441   200046 630500                    EPPR0   IENTRY$,,AUTO
         2 003442   200161 450500                    STP0    CNT+3,,AUTO
         2 003443   200043 631500                    EPPR1   IENTRY#,,AUTO
         2 003444   200160 451500                    STP1    CNT+2,,AUTO
         2 003445   200160 630500                    EPPR0   CNT+2,,AUTO
         2 003446   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 003447   000000 701000 xent               TSX1    DDF$VREBL_#
         2 003450   003543 702000 2                  TSX2    BADSCHEMA

      957    14261    2             ZITEM.ADDRESS.W = B$VREBL.ADR6.W;

  14261  2 003451   200010 470500                    LDP0    ENTRY$,,AUTO
         2 003452   200065 471500                    LDP1    ZITEM$,,AUTO
         2 003453   000000 236100                    LDQ     0,,PR0
         2 003454   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 003455   000004 772000                    QRL     4
         2 003456   100007 752174                    STCQ    7,'74'O,PR1

      958    14262    2             ZITEM.ADDRESS.C = B$VREBL.ADR6.C;

  14262  2 003457   200010 470500                    LDP0    ENTRY$,,AUTO
         2 003460   000000 236100                    LDQ     0,,PR0
         2 003461   100000 376007                    ANQ     32768,DL
         2 003462   000011 772000                    QRL     9
         2 003463   100007 752102                    STCQ    7,'02'O,PR1

      959    14263    2             ZITEM.ADDRESS.B = B$VREBL.ADR6.B;

  14263  2 003464   200010 470500                    LDP0    ENTRY$,,AUTO
         2 003465   000000 236100                    LDQ     0,,PR0
         2 003466   070000 376007                    ANQ     28672,DL
         2 003467   000014 772000                    QRL     12
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:143  
         2 003470   100007 752101                    STCQ    7,'01'O,PR1

      960    14264    2             DTYP = %BIT_DATATYPE;

  14264  2 003471   000023 235007                    LDA     19,DL
         2 003472   200024 755100                    STA     TEMP2,,AUTO

      961    14265    2             ZITEM.DTYP = DTYP;

  14265  2 003473   200024 236100                    LDQ     TEMP2,,AUTO
         2 003474   000022 736000                    QLS     18
         2 003475   100001 552120                    STBQ    1,'20'O,PR1

      962    14266    2             ZITEM.NAMEFLAGS.STATUS_EXISTS = '0'B;

  14266  2 003476   000004 236000 3                  LDQ     4
         2 003477   100003 356100                    ANSQ    3,,PR1

      963    14267    2             ZITEM.ADDR_TYPE = B$VREBL.ADDRTYP - 1;

  14267  2 003500   200010 470500                    LDP0    ENTRY$,,AUTO
         2 003501   000000 236100                    LDQ     0,,PR0
         2 003502   000010 772000                    QRL     8
         2 003503   000017 376007                    ANQ     15,DL
         2 003504   000001 136007                    SBLQ    1,DL
         2 003505   000022 736000                    QLS     18
         2 003506   100006 552120                    STBQ    6,'20'O,PR1

      964    14268    2             ZITEM.DATA_TYPE = DTYP;

  14268  2 003507   200024 236100                    LDQ     TEMP2,,AUTO
         2 003510   100006 552104                    STBQ    6,'04'O,PR1

      965    14269    2             ZITEM.FMT_SPEC = FMT(DTYP);

  14269  2 003511   000000 236006 xsym               LDQ     FMT,QL
         2 003512   000011 736000                    QLS     9
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:144  
         2 003513   100006 552110                    STBQ    6,'10'O,PR1

      966    14270    2             DITEM.VALUE = B$VREBLCSET.SIG_BITS;

  14270  2 003514   200046 470500                    LDP0    IENTRY$,,AUTO
         2 003515   000000 236100                    LDQ     0,,PR0
         2 003516   000022 772000                    QRL     18
         2 003517   200064 473500                    LDP3    SDD$,,AUTO
         2 003520   300001 756100                    STQ     1,,PR3

      967    14271    2             ZITEM.SET_DATATYP = B$VREBLCSET.DATATYP;

  14271  2 003521   200046 470500                    LDP0    IENTRY$,,AUTO
         2 003522   000000 236100                    LDQ     0,,PR0
         2 003523   000002 772000                    QRL     2
         2 003524   000077 376007                    ANQ     63,DL
         2 003525   000000 620006                    EAX0    0,QL
         2 003526   100001 440100                    SXL0    1,,PR1

      968    14272    2             ZITEM.NPOINTER_TRUE = B$VREBLCSET.NPOINTER_TRUE;

  14272  2 003527   200046 470500                    LDP0    IENTRY$,,AUTO
         2 003530   000002 221100                    LDX1    2,,PR0
         2 003531   100014 741100                    STX1    12,,PR1

      969    14273    2             ZITEM.NPOINTER_FALSE = B$VREBLCSET.NPOINTER_FALSE;

  14273  2 003532   200046 470500                    LDP0    IENTRY$,,AUTO
         2 003533   000002 722100                    LXL2    2,,PR0
         2 003534   100014 442100                    SXL2    12,,PR1

      970    14274    2           END;

      971    14275    1        IF XQUAL

  14275  2 003535   200020 234100                    SZN     XQUAL,,AUTO
         2 003536   003542 605000 2                  TPL     s:14277
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:145  

      972    14276    1        THEN CALL DDS$SET_T2Q ALTRET( BADSCHEMA );

  14276  2 003537   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 003540   000000 701000 xent               TSX1    DDS$SET_T2Q
         2 003541   003543 702000 2                  TSX2    BADSCHEMA

      973    14277    1        RETURN;

  14277  2 003542   000000 702200 xent               TSX2  ! X66_ARET

      974    14278    1   BADSCHEMA:
      975    14279    1        S_D.ERROR = 22;              /* E@UERR11 */

  14279  2 003543   000026 235007       BADSCHEMA    LDA     22,DL
         2 003544   000000 470400 xsym               LDP0    S_D$
         2 003545   000013 755100                    STA     11,,PR0

      976    14280    1   VERR:
      977    14281    1        ALTRETURN;

  14281  2 003546   000000 702200 xent  VERR         TSX2  ! X66_AALT

  14275  2 003547                       TRAP_ADJ_DIM null
      978    14282    1   TRAP_ADJ_DIM: ;
      979    14283    1        S_D.ERROR = 263;        /*  E@TRAP_ADJ_DIM */

  14283  2 003547   000407 235007                    LDA     263,DL
         2 003550   000000 470400 xsym               LDP0    S_D$
         2 003551   000013 755100                    STA     11,,PR0

      980    14284    1        ALTRETURN;

  14284  2 003552   000000 702200 xent               TSX2  ! X66_AALT

      981    14285        %EJECT;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:146  
      982    14286    1   GETVAL: PROC ALTRET;

  14286  2 003553   200154 741300       GETVAL       STX1  ! ENTRY#+52,,AUTO

      983    14287    2   DCL L6_AUTO UBIN CONSTANT INIT(10485760); /* 'A00000'X = AUTO base for LCP6 user */
      984    14288    3        DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);

  14288  2 003554   000000 470400 xsym               LDP0    S_D$
         2 003555   006714 235100                    LDA     3532,,PR0
         2 003556   000003 115007                    CMPA    3,DL
         2 003557   003561 602005 2                  TNC     s:14288+5,AL
         2 003560   003576 710000 2                  TRA     s:14294
         2 003561   003576 710000 2                  TRA     s:14294
         2 003562   003564 710000 2                  TRA     s:14290
         2 003563   003571 710000 2                  TRA     s:14292

      985    14289    3          CASE (%HOST);

      986    14290    3             ADDRESS = JENTRY$ -> B$VREBL.ADR.W;

  14290  2 003564   200047 471500                    LDP1    JENTRY$,,AUTO
         2 003565   100000 236100                    LDQ     0,,PR1
         2 003566   000022 772000                    QRL     18
         2 003567   200053 756100                    STQ     ADDRESS,,AUTO
         2 003570   003602 710000 2                  TRA     s:14297

      987    14291    3          CASE (%L6);

      988    14292    3             ADDRESS = JENTRY$ -> B$VREBL.ADR6.W;

  14292  2 003571   200047 471500                    LDP1    JENTRY$,,AUTO
         2 003572   100000 236100                    LDQ     0,,PR1
         2 003573   000020 772000                    QRL     16
         2 003574   200053 756100                    STQ     ADDRESS,,AUTO
         2 003575   003602 710000 2                  TRA     s:14297

      989    14293    3          CASE (ELSE);
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:147  

      990    14294    3             S_D.ERROR = 502;         /* E@DELBUG */

  14294  2 003576   000766 236007                    LDQ     502,DL
         2 003577   000013 756100                    STQ     11,,PR0

      991    14295    3             ALTRETURN;

  14295  2 003600   200154 221300                    LDX1  ! ENTRY#+52,,AUTO
         2 003601   000000 702211                    TSX2  ! 0,X1

      992    14296    3          END;

      993    14297    2        SEG = 3;

  14297  2 003602   000003 235007                    LDA     3,DL
         2 003603   200054 755100                    STA     SEG,,AUTO

      994    14298    2        DESC# = 0;

  14298  2 003604   200055 450100                    STZ     DESC#,,AUTO

      995    14299    2        NOT_IS = '0'B;

  14299  2 003605   200056 450100                    STZ     NOT_IS,,AUTO

      996    14300    2        IF JENTRY$ -> B$VREBL.ADDRTYP = %AUTO_ACODE + 1

  14300  2 003606   100000 236100                    LDQ     0,,PR1
         2 003607   007400 376007                    ANQ     3840,DL
         2 003610   001000 116007                    CMPQ    512,DL
         2 003611   003703 601000 2                  TNZ     s:14320

      997    14301    3        THEN DO;

      998    14302    3             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:148  
  14302  2 003612   006714 235100                    LDA     3532,,PR0
         2 003613   000001 115007                    CMPA    1,DL
         2 003614   003647 601000 2                  TNZ     s:14309

      999    14303    4             THEN DO;

     1000    14304    4                  DESC# = 4;

  14304  2 003615   000004 235007                    LDA     4,DL
         2 003616   200055 755100                    STA     DESC#,,AUTO

     1001    14305    4                  NOT_IS = '1'B;

  14305  2 003617   400000 236003                    LDQ     -131072,DU
         2 003620   200056 756100                    STQ     NOT_IS,,AUTO

     1002    14306    4                  ADDRESS = ADDRESS + (B$TCB$ -> B$TCB.STK$ -> B$SS.PR2.AR2 / 64);

  14306  2 003621   000000 473400 xsym               LDP3    B$TCB$
         2 003622   300001 474500                    LDP4    1,,PR3
         2 003623   400022 236100                    LDQ     18,,PR4
         2 003624   000014 772000                    QRL     12
         2 003625   000006 772000                    QRL     6
         2 003626   200053 036100                    ADLQ    ADDRESS,,AUTO
         2 003627   200053 756100                    STQ     ADDRESS,,AUTO

     1003    14307    4                  CALL DDK$GETMVAL (VALUE, ADDRESS, SEG, DESC#, NOT_IS) ALTRET(ALT);

  14307  2 003630   200056 634500                    EPPR4   NOT_IS,,AUTO
         2 003631   200164 454500                    STP4    CNT+6,,AUTO
         2 003632   200055 635500                    EPPR5   DESC#,,AUTO
         2 003633   200163 455500                    STP5    CNT+5,,AUTO
         2 003634   200054 636500                    EPPR6   SEG,,AUTO
         2 003635   200162 456500                    STP6    CNT+4,,AUTO
         2 003636   200053 637500                    EPPR7   ADDRESS,,AUTO
         2 003637   200161 457500                    STP7    CNT+3,,AUTO
         2 003640   200052 630500                    EPPR0   VALUE,,AUTO
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:149  
         2 003641   200160 450500                    STP0    CNT+2,,AUTO
         2 003642   200160 630500                    EPPR0   CNT+2,,AUTO
         2 003643   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 003644   000000 701000 xent               TSX1    DDK$GETMVAL
         2 003645   003705 702000 2                  TSX2    ALT

     1004    14308    4                END;

  14308  2 003646   003703 710000 2                  TRA     s:14320

     1005    14309    3             ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  14309  2 003647   000002 115007                    CMPA    2,DL
         2 003650   003675 601000 2                  TNZ     s:14315

     1006    14310    4                  THEN DO;

     1007    14311    4                       ADDRESS = ADDRESS + L6_AUTO;

  14311  2 003651   200053 236100                    LDQ     ADDRESS,,AUTO
         2 003652   000212 036000 1                  ADLQ    L6_AUTO
         2 003653   200053 756100                    STQ     ADDRESS,,AUTO

     1008    14312    4                       CALL DFK$GETMVAL (VALUE, ADDRESS, SEG, DESC#, NOT_IS, '0'B)
             14312                                ALTRET(ALT);

  14312  2 003654   000010 236000 3                  LDQ     8
         2 003655   200165 756100                    STQ     CNT+7,,AUTO
         2 003656   200056 633500                    EPPR3   NOT_IS,,AUTO
         2 003657   200164 453500                    STP3    CNT+6,,AUTO
         2 003660   200055 634500                    EPPR4   DESC#,,AUTO
         2 003661   200163 454500                    STP4    CNT+5,,AUTO
         2 003662   200054 635500                    EPPR5   SEG,,AUTO
         2 003663   200162 455500                    STP5    CNT+4,,AUTO
         2 003664   200053 636500                    EPPR6   ADDRESS,,AUTO
         2 003665   200161 456500                    STP6    CNT+3,,AUTO
         2 003666   200052 637500                    EPPR7   VALUE,,AUTO
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:150  
         2 003667   200160 457500                    STP7    CNT+2,,AUTO
         2 003670   200160 630500                    EPPR0   CNT+2,,AUTO
         2 003671   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 003672   000000 701000 xent               TSX1    DFK$GETMVAL
         2 003673   003705 702000 2                  TSX2    ALT

     1009    14313    4                     END;

  14313  2 003674   003703 710000 2                  TRA     s:14320

     1010    14314    4                  ELSE DO;

     1011    14315    4                       S_D.ERROR = 502; /* E@DELBUG */

  14315  2 003675   000766 235007                    LDA     502,DL
         2 003676   000013 755100                    STA     11,,PR0

     1012    14316    4                       CALL DDE$ERROR;

  14316  2 003677   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 003700   000000 701000 xent               TSX1    DDE$ERROR
         2 003701   000000 011000                    NOP     0

     1013    14317    4                       GOTO ALT;

  14317  2 003702   003705 710000 2                  TRA     ALT

     1014    14318    4                     END;
     1015    14319    3           END;
     1016    14320    2        RETURN;

  14320  2 003703   200154 221300                    LDX1  ! ENTRY#+52,,AUTO
         2 003704   000001 702211                    TSX2  ! 1,X1

  14312  2 003705                       ALT          null
     1017    14321    2   ALT: ;
     1018    14322    2        ALTRETURN;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:151  

  14322  2 003705   200154 221300                    LDX1  ! ENTRY#+52,,AUTO
         2 003706   000000 702211                    TSX2  ! 0,X1

     1019    14323    2   END GETVAL;
     1020    14324             %EJECT;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:152  
     1021    14325             %BUMPD$;
             14326             %LIST;
             14327    1   BUMPD$: PROC(PCNT) ALTRET;

  14327  2 003707   200154 741300       BUMPD$       STX1  ! ENTRY#+52,,AUTO

             14328    2   DCL PCNT UBIN;
             14329    2   DCL CNT UBIN;
             14330    2   DCL DD_VARCOM$ PTR SYMREF;
             14331    2   DCL DDM$GETMEM ENTRY(3) ALTRET;
             14332    2        IF ADDR(PCNT) = ADDR(NIL)

  14332  2 003710   200155 236100                    LDQ     @PCNT,,AUTO
         2 003711   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 003712   003716 601000 2                  TNZ     s:14334

             14333    2        THEN CNT = SIZEW(DITEM);

  14333  2 003713   000003 235007                    LDA     3,DL
         2 003714   200156 755100                    STA     CNT,,AUTO
         2 003715   003721 710000 2                  TRA     s:14335

             14334    2        ELSE CNT = PCNT;

  14334  2 003716   200155 470500                    LDP0    @PCNT,,AUTO
         2 003717   000000 235100                    LDA     0,,PR0
         2 003720   200156 755100                    STA     CNT,,AUTO

             14335    2        SDD$ = PINCRW(SDD$,CNT);

  14335  2 003721   200156 236100                    LDQ     CNT,,AUTO
         2 003722   000022 736000                    QLS     18
         2 003723   200064 036100                    ADLQ    SDD$,,AUTO
         2 003724   200064 756100                    STQ     SDD$,,AUTO

             14336    2        IF SDD$ > S_D.DESCL$

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:153  
  14336  2 003725   000000 470400 xsym               LDP0    S_D$
         2 003726   000042 116100                    CMPQ    34,,PR0
         2 003727   003756 602000 2                  TNC     s:14351
         2 003730   003756 600000 2                  TZE     s:14351

             14337    3        THEN DO;

             14338    3             IF S_D.STORED ~= 0

  14338  2 003731   000135 235100                    LDA     93,,PR0
         2 003732   003752 600000 2                  TZE     s:14347

             14339    4             THEN DO;

             14340    5                  DO WHILE (SDD$ > PINCRW(S_D.DESCL$, 1));

  14340  2 003733   003745 710000 2                  TRA     s:14344

             14341    5                       CALL DDM$GETMEM(DD_VARCOM$, 1024);

  14341  2 003734   000012 630400 3                  EPPR0   10
         2 003735   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 003736   000000 701000 xent               TSX1    DDM$GETMEM
         2 003737   000000 011000                    NOP     0

             14342    5                       S_D.VARCOM_HIGH$ = PINCRW(S_D.VARCOM_HIGH$, 1024);

  14342  2 003740   000000 470400 xsym               LDP0    S_D$
         2 003741   004623 236100                    LDQ     2451,,PR0
         2 003742   002000 036003                    ADLQ    1024,DU
         2 003743   004623 756100                    STQ     2451,,PR0

             14343    5                       S_D.DESCL$ = S_D.VARCOM_HIGH$;

  14343  2 003744   000042 756100                    STQ     34,,PR0

             14344    5                     END;
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:154  

  14344  2 003745   000042 236100                    LDQ     34,,PR0
         2 003746   000001 036003                    ADLQ    1,DU
         2 003747   200064 116100                    CMPQ    SDD$,,AUTO
         2 003750   003734 602000 2                  TNC     s:14341

             14345    4                END;

  14345  2 003751   003756 710000 2                  TRA     s:14351

             14346    4             ELSE DO;

             14347    4                  S_D.ERROR = 8; /* E@NOROOM */

  14347  2 003752   000010 235007                    LDA     8,DL
         2 003753   000013 755100                    STA     11,,PR0

             14348    4                  ALTRETURN;

  14348  2 003754   200154 221300                    LDX1  ! ENTRY#+52,,AUTO
         2 003755   000000 702211                    TSX2  ! 0,X1

             14349    4                END;
             14350    3           END;
             14351    2        S_D.D$ = SDD$;

  14351  2 003756   200064 236100                    LDQ     SDD$,,AUTO
         2 003757   000044 756100                    STQ     36,,PR0

             14352    2        RETURN;

  14352  2 003760   200154 221300                    LDX1  ! ENTRY#+52,,AUTO
         2 003761   000001 702211                    TSX2  ! 1,X1

DUMPTR
 Sect OctLoc
   1     000   000000 000001   000000 000000                                    ........
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:155  

DUMSIZE
 Sect OctLoc
   1     002   001000 102011   000000 000044                                    ..B....$

DUMSIZE_L6
 Sect OctLoc
   1     004   001000 102011   000000 000020                                    ..B.....

DUMILBINDEX
 Sect OctLoc
   1     006   000000 102003   000000 000000                                    ..B.....

DUMIUBINDEX
 Sect OctLoc
   1     010   000100 102004   000000 000000                                    .@B.....

TYPESIZE_MULT
 Sect OctLoc
   1     012   000000 000000   000000 000001   000000 000000   000000 000001    ................
   1     016   000000 000001   000000 000000   000000 000000   000000 000001    ................
   1     022   000000 000001   000000 000001   000000 000000   000000 000000    ................
   1     026   000000 000000   000000 000044   000000 000000   000000 000000    .......$........
   1     032   000000 000000   000000 000001   000000 000000   000000 000001    ................
   1     036   000000 000000   000000 000011   000000 000000   000000 000000    ................
   1     042   000000 000001   000000 000001   000000 000011   000000 000001    ................
   1     046   000000 000044   000000 000001   000000 000001   000000 000001    ...$............
   1     052   000000 000000   000000 000000   000000 000000   000000 000001    ................
   1     056   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     062   000000 000001   000000 000011   000000 000011   000000 000011    ................
   1     066   000000 000011   000000 000011   000000 000000   000000 000110    ...............H
   1     072   000000 000110   000000 000110   000000 000000   000000 000000    ...H...H........
   1     076   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     106*  000000 000000   000000 000000   000000 000000   000000 000000    ................

TYPESIZE_MULT_FEP
 Sect OctLoc
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:156  
   1     112   000000 000000   000000 000001   000000 000000   000000 000001    ................
   1     116   000000 000001   000000 000000   000000 000000   000000 000001    ................
   1     122   000000 000001   000000 000001   000000 000000   000000 000000    ................
   1     126   000000 000000   000000 000040   000000 000000   000000 000000    ....... ........
   1     132   000000 000000   000000 000001   000000 000000   000000 000001    ................
   1     136   000000 000000   000000 000010   000000 000000   000000 000000    ................
   1     142   000000 000001   000000 000001   000000 000010   000000 000001    ................
   1     146   000000 000040   000000 000001   000000 000001   000000 000001    ... ............
   1     152   000000 000000   000000 000000   000000 000000   000000 000001    ................
   1     156   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     162   000000 000001   000000 000010   000000 000010   000000 000010    ................
   1     166   000000 000010   000000 000010   000000 000000   000000 000060    ...............0
   1     172   000000 000100   000000 000000   000000 000000   000000 000000    ...@............
   1     176   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     206*  000000 000000   000000 000000   000000 000000   000000 000000    ................

L6_AUTO
 Sect OctLoc
   1     212   000050 000000                                                    .(..

(unnamed)
 Sect OctLoc
   3     000   000000 000015   000000 006000   000007 770000   017777 777777    ................
   3     004   577777 777777   000006 006000   777777 740000   000377 777774    ................
   3     010   000002 006000   000000 002000   000000 006000   000011 006000    ................
             14353    2        END BUMPD$;
     1022    14356    1   END DDD$VREF;

PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:157  
--  Include file information  --

   DD_DTYP_R.:E05TOU  is referenced.
   DD_DESC_R.:E05TOU  cannot be made into a system file and is referenced.
   DD$BASED.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   DD_PSUBS_C.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B$SS.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure DDD$VREF.

   Procedure DDD$VREF requires 2034 words for executable code.
   Procedure DDD$VREF requires 118 words of local(AUTO) storage.

    No errors detected in file DDD$VREF.:E05TSI    .
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:158  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:159  
          MINI XREF LISTING

ADDRESS
        80**DCL     14290<<ASSIGN  14292<<ASSIGN  14306<<ASSIGN  14306>>ASSIGN  14307<>CALL    14311<<ASSIGN
     14311>>ASSIGN  14312<>CALL
ADDREXP_FLAG
        45**DCL     13576<<ASSIGN  13612<<ASSIGN  13699>>IF      14239>>IF
ALT IN PROCEDURE GETVAL
     14312**LABEL   14307--CALLALT 14312--CALLALT 14317--GOTO
ARRAYTYP
        66**DCL     13832<<ASSIGN  13833>>DOCASE  13839>>ASSIGN  13840>>ASSIGN  13846>>IF      13876>>IF
ARRAY_FLAG
        43**DCL     13577<<ASSIGN  13586<<ASSIGN  13607>>ASSIGN  13714>>IF      13736>>IF      13755>>IF
     13804>>IF      13919<<ASSIGN  14040>>IF
ATYP
        61**DCL     13928<<ASSIGN  13929>>IF      13929>>IF      13929>>IF      13929>>IF      13929>>IF
     13937>>IF      13937>>IF      13937>>IF      13937>>IF      13937>>IF      13942>>IF      13957>>IF
     14007>>IF      14015>>IF      14021>>IF      14033<<ASSIGN  14036<<ASSIGN  14145>>ASSIGN
B$EDEF.ISADDR
     11078**DCL     13815>>ASSIGN
B$EDEF.OU
     11072**DCL     11078--REDEF
B$LBNTRY0.COMPILER
     11128**DCL     13872>>IF
B$LBNTRY0.NO_AUTO
     11151**DCL     11156--REDEF
B$LBNTRY0.VERSION
     11140**DCL     11142--REDEF
B$SDEF.AD.ISADDR
     11027**DCL     13796>>ASSIGN
B$SDEF.AD.OU
     11021**DCL     11027--REDEF
B$SDEF.CONSTNT
     11032**DCL     13764>>IF
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:160  
B$SDEF.VALUE
     11002**DCL     11005--REDEF   13782>>ASSIGN
B$SS.PR2.AR2
       263**DCL     14306>>ASSIGN
B$SS.RVA
       230**DCL       231--REDEF
B$TCB.STK$
       176**DCL     14306>>ASSIGN
B$TCB$
       357**DCL     14306>>ASSIGN
B$VREBL
     10550**DCL     13848--IF      13850--ASSIGN  13856--ASSIGN  13857--IF      13859--ASSIGN  13865--ASSIGN
     13868--ASSIGN  13869--ASSIGN  13878--IF      13880--ASSIGN  13886--ASSIGN  13888--ASSIGN  13892--ASSIGN
     14001--ASSIGN  14031--ASSIGN  14129--ASSIGN
B$VREBL.ADDRTYP
     10577**DCL     13928>>ASSIGN  13974>>ASSIGN  14058>>IF      14067>>ASSIGN  14267>>ASSIGN  14300>>IF
B$VREBL.ADR
     10551**DCL     10563--REDEF
B$VREBL.ADR.B
     10561**DCL     13965>>ASSIGN  14073>>ASSIGN  14164>>ASSIGN  14176>>ASSIGN  14191>>ASSIGN
B$VREBL.ADR.C
     10559**DCL     13964>>ASSIGN  14072>>ASSIGN  14163>>ASSIGN  14175>>ASSIGN  14190>>ASSIGN
B$VREBL.ADR.W
     10557**DCL     13963>>ASSIGN  14071>>ASSIGN  14152>>ASSIGN  14189>>ASSIGN  14290>>ASSIGN
B$VREBL.ADR6.B
     10575**DCL     13969>>ASSIGN  14077>>ASSIGN  14167>>ASSIGN  14179>>ASSIGN  14195>>ASSIGN  14263>>ASSIGN
B$VREBL.ADR6.C
     10573**DCL     13968>>ASSIGN  14076>>ASSIGN  14166>>ASSIGN  14178>>ASSIGN  14194>>ASSIGN  14262>>ASSIGN
B$VREBL.ADR6.W
     10571**DCL     13967>>ASSIGN  14075>>ASSIGN  14154>>ASSIGN  14193>>ASSIGN  14261>>ASSIGN  14292>>ASSIGN
B$VREBL.ARRAYTYP
     10638**DCL     13832>>ASSIGN
B$VREBL.DATATYP
     10601**DCL     14048>>ASSIGN  14082>>ASSIGN
B$VREBL.DIMS
     10704**DCL     13839>>ASSIGN  13842>>ASSIGN
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:161  
B$VREBL.ELMNTSIZ
     10686**DCL     14203>>ASSIGN
B$VREBL.IMPTR
     10668**DCL     13941>>ASSIGN  13991>>ASSIGN  13996>>ASSIGN  14001--ASSIGN  14031--ASSIGN  14113>>ASSIGN
     14119>>ASSIGN  14124>>ASSIGN  14129--ASSIGN
B$VREBL.LEVEL
     10620**DCL     14058>>IF
B$VREBL.LOGSIZ
     10612**DCL     14045>>IF      14056>>ASSIGN  14057>>ASSIGN  14058>>IF      14065>>ASSIGN  14086>>ASSIGN
     14090>>ASSIGN
B$VREBL.SCALE
     10696**DCL     14235>>ASSIGN
B$VREBL.STATUS_EXISTS
     10692**DCL     13927>>ASSIGN
B$VREBL.SZTYP
     10632**DCL     14045>>IF      14049>>IF
B$VREBLC.ELEMENTS
     10726**DCL     13869>>ASSIGN  13888>>ASSIGN  13892>>ASSIGN
B$VREBLC.MULT_61
     10737**DCL     10761--REDEF
B$VREBLC.OFFSET
     10715**DCL     13868>>ASSIGN
B$VREBLCA.ELEMENTS
     10824**DCL     10827--REDEF   13865>>ASSIGN  13886>>ASSIGN
B$VREBLCA.ELEM_V#
     10827**DCL     13859>>ASSIGN  13880>>ASSIGN
B$VREBLCA.IELEMENTS
     10816**DCL     13857>>IF      13878>>IF
B$VREBLCA.IOFFSET
     10788**DCL     13848>>IF
B$VREBLCA.OFFSET
     10800**DCL     10804--REDEF   13856>>ASSIGN
B$VREBLCA.OFF_V#
     10804**DCL     13850>>ASSIGN
B$VREBLCSET.DATATYP
     10886**DCL     14271>>ASSIGN
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:162  
B$VREBLCSET.NPOINTER_FALSE
     10904**DCL     14273>>ASSIGN
B$VREBLCSET.NPOINTER_TRUE
     10894**DCL     14272>>ASSIGN
B$VREBLCSET.SIG_BITS
     10876**DCL     14270>>ASSIGN
BADSCHEMA
     14279**LABEL   13645--CALLALT 13650--CALLALT 13831--CALLALT 13851--CALLALT 13854--CALLALT 13860--CALLALT
     13863--CALLALT 13881--CALLALT 13884--CALLALT 13903--CALLALT 13960--CALLALT 14005--CALLALT 14066--CALLALT
     14133--CALLALT 14258--CALLALT 14260--CALLALT 14276--CALLALT
BASED_FLAG
        42**DCL     13567<>CALL    13675>>IF      13714>>IF      13743>>IF      13766>>IF      13788>>IF
     13804>>IF      13929>>IF      13937>>IF      14035>>IF
BUMPD$
     14327**PROC    13563--CALL    13775--CALL    13916--CALL    13920--CALL    13924--CALL    13949--CALL
     13979--CALL    14107--CALL    14243--CALL
CNT IN PROCEDURE BUMPD$
     14329**DCL     14333<<ASSIGN  14334<<ASSIGN  14335>>ASSIGN
DDD$ADDREXP
     13541**DCL-ENT 13610--CALL
DDD$MULT
     13544**DCL-ENT 14042--CALL
DDD$PQLIST
     13540**DCL-ENT 13567--CALL
DDD$SIMEXP
     13543**DCL-ENT 13673--CALL
DDD$SUBREF
     13542**DCL-ENT 13587--CALL
DDE$ERROR
     13556**DCL-ENT 14095--CALL    14232--CALL    14316--CALL
DDF$VREBL_#
     13555**DCL-ENT 13831--CALL    13851--CALL    13854--CALL    13860--CALL    13863--CALL    13881--CALL
     13884--CALL    13903--CALL    13960--CALL    14005--CALL    14066--CALL    14133--CALL    14258--CALL
     14260--CALL
DDK$GETMVAL
     13545**DCL-ENT 14307--CALL
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:163  
DDM$GETMEM IN PROCEDURE BUMPD$
     14331**DCL-ENT 14341--CALL
DDS$D_SRCH
     13547**DCL-ENT 13633--CALL
DDS$ED_SRCH
     13549**DCL-ENT 13628--CALL    13655--CALL
DDS$SD_SRCH
     13548**DCL-ENT 13629--CALL    13654--CALL
DDS$SET_Q2T
     13552**DCL-ENT 13644--CALL
DDS$SET_T2Q
     13554**DCL-ENT 13650--CALL    14276--CALL
DDS$SET_X2Q
     13553**DCL-ENT 13645--CALL
DDS$SP_SRCH
     13546**DCL-ENT 13635--CALL
DDS$UD_SRCH
     13551**DCL-ENT 13625--CALL
DDS$V_SRCH
     13550**DCL-ENT 13640--CALL    13647--CALL
DD_VARCOM$ IN PROCEDURE BUMPD$
     14330**DCL     14341<>CALL
DESC.ITEM
     13414**DCL     13780>>ASSIGN  13989>>ASSIGN  14010>>ASSIGN  14024>>ASSIGN  14111>>ASSIGN  14117>>ASSIGN
DESC#
        82**DCL     14298<<ASSIGN  14304<<ASSIGN  14307<>CALL    14312<>CALL
DFK$GETMVAL
     13557**DCL-ENT 14312--CALL
DIMS
        49**DCL     13825<<ASSIGN  13837<<ASSIGN  13837>>ASSIGN  13842<<ASSIGN  13842>>ASSIGN  13844>>IF
     13904>>IF      13907>>ASSIGN
DIM_CNT
        48**DCL     13579<<ASSIGN  13587<>CALL    13904>>IF      13905>>IF      13921<<ASSIGN  13954>>DOINDEX
     13984>>DOINDEX 14042<>CALL
DITEM
     11930**DCL     13671<<ASSIGN  13672<<ASSIGN  13725<<ASSIGN  13727<<ASSIGN  13748<<ASSIGN  13749<<ASSIGN
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:164  
     13762<<ASSIGN  13763<<ASSIGN  13777--ASSIGN  13812<<ASSIGN  13813<<ASSIGN  13914<<ASSIGN  13922<<ASSIGN
     13951--ASSIGN  13955--ASSIGN  13959<<ASSIGN  13981--ASSIGN  13985--ASSIGN  14009<<ASSIGN  14017<<ASSIGN
     14023<<ASSIGN  14029<<ASSIGN  14038<<ASSIGN  14039<<ASSIGN  14108<<ASSIGN  14333--ASSIGN
DITEM.ADDRESS
     11951**DCL     11956--REDEF   11957--REDEF   11958--REDEF
DITEM.ADDRESS.B
     11955**DCL     13965<<ASSIGN  13969<<ASSIGN  14073<<ASSIGN  14077<<ASSIGN
DITEM.ADDRESS.C
     11954**DCL     13964<<ASSIGN  13968<<ASSIGN  14072<<ASSIGN  14076<<ASSIGN
DITEM.ADDRESS.W
     11953**DCL     13963<<ASSIGN  13967<<ASSIGN  13996<<ASSIGN  14018<<ASSIGN  14071<<ASSIGN  14075<<ASSIGN
     14124<<ASSIGN
DITEM.ADDR_TYPE
     11946**DCL     13783<<ASSIGN  13977<<ASSIGN  13990<<ASSIGN  13997<<ASSIGN  14000<<ASSIGN  14004<<ASSIGN
     14011<<ASSIGN  14019<<ASSIGN  14025<<ASSIGN  14030<<ASSIGN  14068<<ASSIGN  14103<<ASSIGN  14106<<ASSIGN
     14112<<ASSIGN  14118<<ASSIGN  14125<<ASSIGN  14128<<ASSIGN
DITEM.FLAGS.OFLAG
     11934**DCL     13673<>CALL
DITEM.PUP.SIZE
     11984**DCL     14086<<ASSIGN  14090<<ASSIGN
DITEM.SMULT
     11931**DCL     14085<<ASSIGN  14089<<ASSIGN
DITEM.SP.VD
     11959**DCL     11963--REDEF   11966--REDEF
DITEM.SP.VD.DISP
     11962**DCL     13782<<ASSIGN  14026<<ASSIGN  14113<<ASSIGN
DITEM.SP.VP.N
     11965**DCL     13991<<ASSIGN  14012<<ASSIGN  14119<<ASSIGN
DITEM.TYPE_CODE
     11949**DCL     13784<<ASSIGN
DITEM.VALUE
     11956**DCL     13729<<ASSIGN  13915<<ASSIGN  13923<<ASSIGN  14001<<ASSIGN  14031<<ASSIGN  14053<<ASSIGN
     14056<<ASSIGN  14057<<ASSIGN  14061<<ASSIGN  14129<<ASSIGN  14135>>IF      14138>>IF      14270<<ASSIGN
DITEM.VALUEB
     11957**DCL     13781<<ASSIGN  13989<<ASSIGN  14010<<ASSIGN  14024<<ASSIGN  14111<<ASSIGN  14117<<ASSIGN
DONE
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:165  
     14239**LABEL   13682--GOTO    13731--GOTO    13750--GOTO    13799--GOTO    13817--GOTO
DTYP
        63**DCL     14048<<ASSIGN  14051>>IF      14051>>IF      14056>>ASSIGN  14057>>ASSIGN  14085>>ASSIGN
     14089>>ASSIGN  14135>>IF      14137<<ASSIGN  14138>>IF      14142<<ASSIGN  14143<<ASSIGN  14146>>IF
     14146>>IF      14159>>IF      14186>>ASSIGN  14207>>IF      14209>>IF      14211>>DOCASE  14264<<ASSIGN
     14265>>ASSIGN  14268>>ASSIGN  14269>>ASSIGN
DUMILBINDEX
     13446**DCL     13914>>ASSIGN
DUMIUBINDEX
     13451**DCL     13922>>ASSIGN
DUMPTR
     13415**DCL     13959>>ASSIGN  14009>>ASSIGN  14017>>ASSIGN  14023>>ASSIGN  14029>>ASSIGN  14108>>ASSIGN
DUMSIZE
     13434**DCL     13671>>ASSIGN  13725>>ASSIGN  13748>>ASSIGN  13762>>ASSIGN  13812>>ASSIGN  14038>>ASSIGN
DUMSIZE_L6
     13440**DCL     13672>>ASSIGN  13727>>ASSIGN  13749>>ASSIGN  13763>>ASSIGN  13813>>ASSIGN  14039>>ASSIGN
ENTRY#
     13361**DCL     13640<>CALL    13647<>CALL    14042<>CALL
ENTRY#.C
     13362**DCL     13641>>ASSIGN  13648>>IF      13649>>ASSIGN  13828>>DOINDEX 13829>>ASSIGN  13830>>IF
     13902>>IF      13903>>CALL    14005>>CALL    14133>>CALL    14257>>ASSIGN
ENTRY#.E
     13363**DCL     13831<>CALL    13854<>CALL    13863<>CALL    13884<>CALL    13903<>CALL    14005<>CALL
     14133<>CALL    14257>>ASSIGN
ENTRY$
        39**DCL     10550--IMP-PTR 10714--IMP-PTR 10787--IMP-PTR 11001--IMP-PTR 11055--IMP-PTR 13628<>CALL
     13629<>CALL    13640<>CALL    13647<>CALL    13654<>CALL    13655<>CALL    13764>>IF      13782>>ASSIGN
     13796>>ASSIGN  13815>>ASSIGN  13831<>CALL    13832>>ASSIGN  13839>>ASSIGN  13842>>ASSIGN  13848>>IF
     13850>>ASSIGN  13854<>CALL    13856>>ASSIGN  13857>>IF      13859>>ASSIGN  13863<>CALL    13865>>ASSIGN
     13868>>ASSIGN  13869>>ASSIGN  13878>>IF      13880>>ASSIGN  13884<>CALL    13886>>ASSIGN  13888>>ASSIGN
     13892>>ASSIGN  13903<>CALL    13927>>ASSIGN  13928>>ASSIGN  13941>>ASSIGN  14001>>ASSIGN  14001>>ASSIGN
     14005<>CALL    14031>>ASSIGN  14031>>ASSIGN  14031>>ASSIGN  14042<>CALL    14045>>IF      14045>>IF
     14048>>ASSIGN  14049>>IF      14056>>ASSIGN  14057>>ASSIGN  14058>>IF      14058>>IF      14058>>IF
     14065>>ASSIGN  14129>>ASSIGN  14129>>ASSIGN  14133<>CALL    14152>>ASSIGN  14154>>ASSIGN  14163>>ASSIGN
     14164>>ASSIGN  14166>>ASSIGN  14167>>ASSIGN  14175>>ASSIGN  14176>>ASSIGN  14178>>ASSIGN  14179>>ASSIGN
     14189>>ASSIGN  14190>>ASSIGN  14191>>ASSIGN  14193>>ASSIGN  14194>>ASSIGN  14195>>ASSIGN  14203>>ASSIGN
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:166  
     14235>>ASSIGN  14258<>CALL    14261>>ASSIGN  14262>>ASSIGN  14263>>ASSIGN  14267>>ASSIGN
EXPR_IDX
        89**DCL     13607<<ASSIGN  13608>>IF      13610<>CALL
FMT
     13432**DCL     14092>>IF      14207>>IF      14209>>IF      14269>>ASSIGN
GETVAL
     14286**PROC    13852--CALL    13861--CALL    13882--CALL
GOT_DESC
     13687**LABEL   13633--CALLALT
GOT_EDEF
     13804**LABEL   13628--CALLALT 13655--CALLALT
GOT_SDEF
     13755**LABEL   13629--CALLALT 13654--CALLALT
GOT_SPEC
     13698**LABEL   13635--CALLALT
GOT_UDEF
     13736**LABEL   13625--CALLALT
GOT_VAR
     13825**LABEL   13640--CALLALT 13647--CALLALT
HIGH_ENTRY#
        40**DCL     13641<<ASSIGN  13648>>IF      13649<<ASSIGN  13657>>ASSIGN
I
        67**DCL     13591<<DOINDEX 13592>>IF      13594>>ASSIGN  13595>>IF      13596>>ASSIGN  13596>>ASSIGN
     13597>>ASSIGN  13828<<DOINDEX 13829>>ASSIGN  13954<<DOINDEX 13955>>ASSIGN  13955>>ASSIGN  13984<<DOINDEX
     13985>>ASSIGN  13985>>ASSIGN  14249<<DOINDEX
IENTRY#
        72**DCL     13941<<ASSIGN  13942>>IF      13960<>CALL    14012>>ASSIGN  14018>>ASSIGN  14026>>ASSIGN
     14065<<ASSIGN  14066<>CALL    14259<<ASSIGN  14260<>CALL
IENTRY$
        75**DCL     10875--IMP-PTR 13960<>CALL    13963>>ASSIGN  13964>>ASSIGN  13965>>ASSIGN  13967>>ASSIGN
     13968>>ASSIGN  13969>>ASSIGN  13974>>ASSIGN  13991>>ASSIGN  13996>>ASSIGN  14001>>ASSIGN  14066<>CALL
     14067>>ASSIGN  14071>>ASSIGN  14072>>ASSIGN  14073>>ASSIGN  14075>>ASSIGN  14076>>ASSIGN  14077>>ASSIGN
     14082>>ASSIGN  14086>>ASSIGN  14090>>ASSIGN  14113>>ASSIGN  14119>>ASSIGN  14124>>ASSIGN  14129>>ASSIGN
     14260<>CALL    14270>>ASSIGN  14271>>ASSIGN  14272>>ASSIGN  14273>>ASSIGN
ILB
        69**DCL     13840<<ASSIGN  13853<<ASSIGN  13856<<ASSIGN  13862>>ASSIGN  13865>>ASSIGN  13868<<ASSIGN
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:167  
     13869>>ASSIGN  13875<<ASSIGN  13891<<ASSIGN  13915>>ASSIGN
IMPLF4
        90**DCL     13827<<ASSIGN  13874<<ASSIGN  13926<<ASSIGN  14201>>IF
IPTR$
        74**DCL     13580<<ASSIGN  13776>>DOWHILE 13781>>ASSIGN  13782>>ASSIGN  13783>>ASSIGN  13784>>ASSIGN
     13950>>DOWHILE 13959>>ASSIGN  13963>>ASSIGN  13964>>ASSIGN  13965>>ASSIGN  13967>>ASSIGN  13968>>ASSIGN
     13969>>ASSIGN  13977>>ASSIGN  13980>>DOWHILE 13989>>ASSIGN  13990>>ASSIGN  13991>>ASSIGN  13996>>ASSIGN
     13997>>ASSIGN  14000>>ASSIGN  14001>>ASSIGN  14004>>ASSIGN  14009>>ASSIGN  14010>>ASSIGN  14011>>ASSIGN
     14012>>ASSIGN  14017>>ASSIGN  14018>>ASSIGN  14019>>ASSIGN  14023>>ASSIGN  14024>>ASSIGN  14025>>ASSIGN
     14026>>ASSIGN  14029>>ASSIGN  14030>>ASSIGN  14031>>ASSIGN
IUB
        70**DCL     13839<<ASSIGN  13862<<ASSIGN  13865<<ASSIGN  13869<<ASSIGN  13883<<ASSIGN  13886<<ASSIGN
     13888<<ASSIGN  13892<<ASSIGN  13923>>ASSIGN
JENTRY#
        77**DCL     13850<<ASSIGN  13851<>CALL    13880<<ASSIGN  13881<>CALL
JENTRY$
        76**DCL     13851<>CALL    13860<>CALL    13881<>CALL    14290>>ASSIGN  14292>>ASSIGN  14300>>IF
KENTRY#
        78**DCL     13859<<ASSIGN  13860<>CALL    14257<<ASSIGN  14258<>CALL    14259>>ASSIGN
L6_AUTO IN PROCEDURE GETVAL
     14287**DCL     14311>>ASSIGN
LEVELDIMS
        71**DCL     13826<<ASSIGN  13838<<ASSIGN  13838>>ASSIGN  13843<<ASSIGN  13843>>ASSIGN  13905>>IF
MITEM
     12010**DCL     13918<<ASSIGN  13920--CALL
MITEM.AMULT.ADR
     12028**DCL     12032--REDEF
MITEM.AOFS.ADR
     12043**DCL     12047--REDEF
MITEM.MULT
     12024**DCL     12026--REDEF
MITEM.OFS
     12039**DCL     12041--REDEF
MULT
        65**DCL     13587<>CALL    13917<<ASSIGN  13918>>ASSIGN  13955<<ASSIGN  13955>>ASSIGN  13985<<ASSIGN
     13985>>ASSIGN  14042<>CALL
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:168  
NCHARS
        91**DCL     14203<<ASSIGN  14204>>ASSIGN  14205>>ASSIGN
NOT_IS
        83**DCL     14299<<ASSIGN  14305<<ASSIGN  14307<>CALL    14312<>CALL
NQFLAG
        41**DCL     13619<<ASSIGN  13620<<ASSIGN  13623>>IF      13652>>IF
O.CODE
      3478**DCL     13574>>IF      13584>>IF      13631>>IF
O.CPOS
      3496**DCL     13570>>ASSIGN  13594>>ASSIGN  13596>>ASSIGN  13596>>ASSIGN  13597>>ASSIGN  13597>>ASSIGN
O.NSUBLKS
      3482**DCL     13572>>ASSIGN  13581>>IF      13591>>DOINDEX 13592>>IF      13595>>IF      13608>>IF
     13618>>IF
O.SUBLK$
      3503**DCL     13572>>ASSIGN  13583>>ASSIGN  13592>>IF      13594>>ASSIGN  13596>>ASSIGN  13596>>ASSIGN
     13597>>ASSIGN  13617>>ASSIGN  13621>>ASSIGN  13622>>ASSIGN  13657>>ASSIGN  13657>>ASSIGN
PCNT IN PROCEDURE BUMPD$
     14328**DCL     14327--PROC    14332--IF      14334>>ASSIGN
PQLIST$
        33**DCL        31--PROC    13567<>CALL    13570>>ASSIGN  13572>>ASSIGN  13572>>ASSIGN
RANGE_FLAG
        44**DCL     13587<>CALL    13589>>IF
ROOT$
        36**DCL     13572<<ASSIGN  13574>>IF      13581>>IF      13583>>ASSIGN  13608>>IF      13610<>CALL
     13617>>ASSIGN  13673<>CALL
SDD$
     11280**DCL     11930--IMP-PTR 13560<<ASSIGN  13561>>ASSIGN  13571<<ASSIGN  13605<<ASSIGN  13611<<ASSIGN
     13671>>ASSIGN  13672>>ASSIGN  13673>>CALL    13725>>ASSIGN  13727>>ASSIGN  13729>>ASSIGN  13748>>ASSIGN
     13749>>ASSIGN  13762>>ASSIGN  13763>>ASSIGN  13774>>ASSIGN  13812>>ASSIGN  13813>>ASSIGN  13914>>ASSIGN
     13915>>ASSIGN  13917>>ASSIGN  13922>>ASSIGN  13923>>ASSIGN  13948>>ASSIGN  13978>>ASSIGN  14038>>ASSIGN
     14039>>ASSIGN  14053>>ASSIGN  14056>>ASSIGN  14057>>ASSIGN  14061>>ASSIGN  14068>>ASSIGN  14071>>ASSIGN
     14072>>ASSIGN  14073>>ASSIGN  14075>>ASSIGN  14076>>ASSIGN  14077>>ASSIGN  14085>>ASSIGN  14086>>ASSIGN
     14089>>ASSIGN  14090>>ASSIGN  14103>>ASSIGN  14106>>ASSIGN  14108>>ASSIGN  14111>>ASSIGN  14112>>ASSIGN
     14113>>ASSIGN  14117>>ASSIGN  14118>>ASSIGN  14119>>ASSIGN  14124>>ASSIGN  14125>>ASSIGN  14128>>ASSIGN
     14129>>ASSIGN  14135>>IF      14138>>IF      14244>>ASSIGN  14250>>ASSIGN  14251<<ASSIGN  14251>>ASSIGN
     14254>>ASSIGN  14255>>ASSIGN  14256<<ASSIGN  14256>>ASSIGN  14270>>ASSIGN  14335<<ASSIGN  14335>>ASSIGN
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:169  
     14336>>IF      14340>>DOWHILE 14351>>ASSIGN
SDITEM_VAL.ID
        58**DCL     13688>>IF
SDITEM_VAL.TYPE
        57**DCL     13688>>IF
SEG
        81**DCL     14297<<ASSIGN  14307<>CALL    14312<>CALL
SITEM_VAL
        51**DCL     13633<>CALL    13635<>CALL    13720>>ASSIGN  13780<<ASSIGN  13781>>ASSIGN
SITEM_VAL.FLAGS
        54**DCL     13723>>ASSIGN
SITEM_VAL.FMT
        55**DCL     13721>>ASSIGN
SITEM_VAL.ID
        52**DCL     13699>>IF      13699>>IF      13699>>IF      13699>>IF      13699>>IF      13699>>IF
     13699>>IF      13699>>IF      13699>>IF
SPEC_DESC
     13714**LABEL   13695--GOTO
STATUS_EXISTS
        46**DCL     13559<<ASSIGN  13927<<ASSIGN  14246>>IF
STRUCT
        68**DCL     13829<<ASSIGN  13831>>CALL    13854>>CALL    13863>>CALL    13884>>CALL
SYM$
        37**DCL     13622<<ASSIGN  13625<>CALL    13628<>CALL    13629<>CALL    13633<>CALL    13635<>CALL
     13654<>CALL    13655<>CALL    13657<<ASSIGN  13660>>ASSIGN  13717>>ASSIGN  13739>>ASSIGN  13758>>ASSIGN
     13769>>ASSIGN  13791>>ASSIGN  13808>>ASSIGN  13909>>ASSIGN  13934>>ASSIGN  13945>>ASSIGN
SYM2$
        38**DCL     13621<<ASSIGN  13622>>ASSIGN  13631>>IF
S_D.CURRENT_CHANNEL
      5881**DCL      5883--REDEF
S_D.D$
      5019**DCL     13560>>ASSIGN  13571>>ASSIGN  13580>>ASSIGN  13605>>ASSIGN  13611>>ASSIGN  14254<<ASSIGN
     14351<<ASSIGN
S_D.DEBUGA
      5033**DCL      5035--REDEF
S_D.DESC$
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:170  
      5013**DCL     13561<<ASSIGN  13562>>ASSIGN  14244>>ASSIGN
S_D.DESCL$
      5015**DCL     14336>>IF      14340>>DOWHILE 14343<<ASSIGN
S_D.EIS
      5991**DCL      6020--REDEF
S_D.ERROR
      4962**DCL     13659<<ASSIGN  13667<<ASSIGN  13692<<ASSIGN  13710<<ASSIGN  13716<<ASSIGN  13738<<ASSIGN
     13757<<ASSIGN  13768<<ASSIGN  13790<<ASSIGN  13807<<ASSIGN  13908<<ASSIGN  13933<<ASSIGN  13944<<ASSIGN
     13971<<ASSIGN  14079<<ASSIGN  14094<<ASSIGN  14156<<ASSIGN  14169<<ASSIGN  14181<<ASSIGN  14197<<ASSIGN
     14231<<ASSIGN  14279<<ASSIGN  14283<<ASSIGN  14294<<ASSIGN  14315<<ASSIGN  14347<<ASSIGN
S_D.ERROR_HICHAR
      5575**DCL     13907<<ASSIGN
S_D.ERROR_SYM$
      4986**DCL     13660<<ASSIGN  13717<<ASSIGN  13739<<ASSIGN  13758<<ASSIGN  13769<<ASSIGN  13791<<ASSIGN
     13808<<ASSIGN  13909<<ASSIGN  13934<<ASSIGN  13945<<ASSIGN
S_D.HOST_MESSAGE_BUF_REMOTE
      5924**DCL      5925--REDEF    5939--REDEF
S_D.INPUT
      5196**DCL     13569--ASSIGN  13594--ASSIGN
S_D.JDE
      5538**DCL      5539--REDEF
S_D.L$.VALUE
      5091**DCL      5097--REDEF    5105--REDEF    5108--REDEF    5111--REDEF    5114--REDEF
S_D.L$.VALUE.L
      5092**DCL      5093--REDEF    5094--REDEF
S_D.L6_MESSAGE_BUF
      5945**DCL      5947--REDEF
S_D.LB0$
      5367**DCL     13872>>IF
S_D.ONE_TO_TWO.EXEC_DOMAIN
      5956**DCL     13670>>IF      13678>>IF      13688>>IF      13724>>IF      13747>>IF      13761>>IF
     13811>>IF      13961>>DOCASE  14037>>IF      14055>>IF      14069>>DOCASE  14083>>IF      14141>>IF
     14150>>DOCASE  14161>>DOCASE  14173>>DOCASE  14187>>DOCASE  14288>>DOCASE  14302>>IF      14309>>IF
S_D.OUTPUT
      5911**DCL      5913--REDEF
S_D.PATCH
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:171  
      5577**DCL     13626>>IF
S_D.QUALIFIED
      5200**DCL     13665>>IF
S_D.RANGE_CNT
      5049**DCL     13578<<ASSIGN  13913<<ASSIGN  14043>>ASSIGN
S_D.REMOTE_MSG.FNCC
      5930**DCL      5931--REDEF
S_D.REMOTE_MSG.STXC
      5926**DCL      5927--REDEF
S_D.REMOTE_MSG.SUBFNCC
      5934**DCL      5935--REDEF
S_D.RUM
      5579**DCL     13626>>IF
S_D.SAVE_TEXT_STPOS
      5057**DCL     13569>>ASSIGN  13570>>ASSIGN
S_D.STORED
      5127**DCL     14338>>IF
S_D.SV
      4990**DCL      5011--REDEF
S_D.VARCOM_HIGH$
      5404**DCL     14342<<ASSIGN  14342>>ASSIGN  14343>>ASSIGN
S_D.XSCH.OK
      5269**DCL     13642>>IF
S_D$
      6242**DCL      4938--IMP-PTR 13560>>ASSIGN  13561>>ASSIGN  13562>>ASSIGN  13569>>ASSIGN  13569>>ASSIGN
     13570>>ASSIGN  13571>>ASSIGN  13578>>ASSIGN  13580>>ASSIGN  13594>>ASSIGN  13605>>ASSIGN  13611>>ASSIGN
     13626>>IF      13626>>IF      13642>>IF      13659>>ASSIGN  13660>>ASSIGN  13665>>IF      13667>>ASSIGN
     13670>>IF      13678>>IF      13688>>IF      13692>>ASSIGN  13710>>ASSIGN  13716>>ASSIGN  13717>>ASSIGN
     13724>>IF      13738>>ASSIGN  13739>>ASSIGN  13747>>IF      13757>>ASSIGN  13758>>ASSIGN  13761>>IF
     13768>>ASSIGN  13769>>ASSIGN  13790>>ASSIGN  13791>>ASSIGN  13807>>ASSIGN  13808>>ASSIGN  13811>>IF
     13872>>IF      13907>>ASSIGN  13908>>ASSIGN  13909>>ASSIGN  13913>>ASSIGN  13933>>ASSIGN  13934>>ASSIGN
     13944>>ASSIGN  13945>>ASSIGN  13961>>DOCASE  13971>>ASSIGN  14037>>IF      14043>>ASSIGN  14055>>IF
     14069>>DOCASE  14079>>ASSIGN  14083>>IF      14094>>ASSIGN  14141>>IF      14150>>DOCASE  14156>>ASSIGN
     14161>>DOCASE  14169>>ASSIGN  14173>>DOCASE  14181>>ASSIGN  14187>>DOCASE  14197>>ASSIGN  14231>>ASSIGN
     14244>>ASSIGN  14254>>ASSIGN  14279>>ASSIGN  14283>>ASSIGN  14288>>DOCASE  14294>>ASSIGN  14302>>IF
     14309>>IF      14315>>ASSIGN  14336>>IF      14338>>IF      14340>>DOWHILE 14342>>ASSIGN  14342>>ASSIGN
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:172  
     14343>>ASSIGN  14343>>ASSIGN  14347>>ASSIGN  14351>>ASSIGN
T$
        73**DCL     13774<<ASSIGN  13776>>DOWHILE 13777>>ASSIGN  13777>>ASSIGN  13778<<ASSIGN  13778>>ASSIGN
     13948<<ASSIGN  13950>>DOWHILE 13951>>ASSIGN  13951>>ASSIGN  13952<<ASSIGN  13952>>ASSIGN  13978<<ASSIGN
     13980>>DOWHILE 13981>>ASSIGN  13981>>ASSIGN  13982<<ASSIGN  13982>>ASSIGN
TATYP
        84**DCL     13974<<ASSIGN  13975>>IF      13975>>IF      13975>>IF      13987>>IF      13994>>IF
     14004>>ASSIGN  14067<<ASSIGN  14068>>ASSIGN  14098>>IF      14098>>IF      14098>>IF      14098>>IF
     14098>>IF      14101>>IF      14109>>IF      14115>>IF      14122>>IF
TBITS
        85**DCL     14213<<ASSIGN  14215<<ASSIGN  14217<<ASSIGN  14219<<ASSIGN  14221<<ASSIGN  14223<<ASSIGN
     14225<<ASSIGN  14227<<ASSIGN  14229<<ASSIGN  14234>>ASSIGN
TDTYP
        64**DCL     14082<<ASSIGN  14086>>ASSIGN  14090>>ASSIGN  14092>>IF
TEMP$
        35**DCL     13583<<ASSIGN  13584>>IF      13587<>CALL    13591>>DOINDEX 13592>>IF      13594>>ASSIGN
     13595>>IF      13596>>ASSIGN  13596>>ASSIGN  13597>>ASSIGN  13597>>ASSIGN  13617<<ASSIGN  13618>>IF
     13621>>ASSIGN  13640<>CALL    13647<>CALL    13657>>ASSIGN
TEMP1
        50**DCL        51--REDEF      56--REDEF      61--REDEF   13625<>CALL    13673<>CALL    13674>>ASSIGN
     13746>>ASSIGN  14245<<ASSIGN  14249>>DOINDEX
TEMP2
        62**DCL        63--REDEF
TEXTC.SZ
        87**DCL        88--IMP-SIZ
TRAP_ADJ_DIM
     14275**LABEL   13852--CALLALT 13861--CALLALT 13882--CALLALT
TYPESIZE_MULT
     13456**DCL     14056>>ASSIGN  14085>>ASSIGN  14086>>ASSIGN
TYPESIZE_MULT_FEP
     13498**DCL     14057>>ASSIGN  14089>>ASSIGN  14090>>ASSIGN
UBIN36
        93**DCL     13777<<ASSIGN  13777>>ASSIGN  13951<<ASSIGN  13951>>ASSIGN  13981<<ASSIGN  13981>>ASSIGN
     14001>>ASSIGN  14031>>ASSIGN  14129>>ASSIGN  14250<<ASSIGN  14250>>ASSIGN
VALUE
        79**DCL     13853>>ASSIGN  13862>>ASSIGN  13883>>ASSIGN  14307<>CALL    14312<>CALL
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:173  
VERR
     14281**LABEL   13563--CALLALT 13567--CALLALT 13587--CALLALT 13610--CALLALT 13673--CALLALT 13775--CALLALT
     13916--CALLALT 13920--CALLALT 13924--CALLALT 13949--CALLALT 13979--CALLALT 14042--CALLALT 14107--CALLALT
     14243--CALLALT
XQUAL
        47**DCL     13639<<ASSIGN  13646<<ASSIGN  14275>>IF
ZITEM
     11858**DCL     13563--CALL    13564<<ASSIGN
ZITEM.ADDRESS
     11892**DCL     11897--REDEF   11898--REDEF   11899--REDEF
ZITEM.ADDRESS.B
     11896**DCL     14164<<ASSIGN  14167<<ASSIGN  14176<<ASSIGN  14179<<ASSIGN  14191<<ASSIGN  14195<<ASSIGN
     14263<<ASSIGN
ZITEM.ADDRESS.C
     11895**DCL     14163<<ASSIGN  14166<<ASSIGN  14175<<ASSIGN  14178<<ASSIGN  14190<<ASSIGN  14194<<ASSIGN
     14203>>ASSIGN  14205<<ASSIGN  14262<<ASSIGN
ZITEM.ADDRESS.W
     11894**DCL     13796<<ASSIGN  13815<<ASSIGN  14152<<ASSIGN  14154<<ASSIGN  14189<<ASSIGN  14193<<ASSIGN
     14203>>ASSIGN  14204<<ASSIGN  14261<<ASSIGN
ZITEM.ADDR_TYPE
     11886**DCL     13676<<ASSIGN  13677<<ASSIGN  13687<<ASSIGN  13698<<ASSIGN  13728>>IF      13744<<ASSIGN
     13745<<ASSIGN  13785<<ASSIGN  13795<<ASSIGN  13814<<ASSIGN  14145<<ASSIGN  14267<<ASSIGN
ZITEM.DATA_TYPE
     11890**DCL     13679<<ASSIGN  13680<<ASSIGN  13742<<ASSIGN  13798<<ASSIGN  13816<<ASSIGN  14149<<ASSIGN
     14186<<ASSIGN  14239>>IF      14242<<ASSIGN  14268<<ASSIGN
ZITEM.DTYP
     11874**DCL     13565<<ASSIGN  13722<<ASSIGN  13896<<ASSIGN  14043<<ASSIGN  14239>>IF      14265<<ASSIGN
ZITEM.FLAGS
     11861**DCL     13566<<ASSIGN  13723<<ASSIGN
ZITEM.FLAGS.ADDREXP
     11871**DCL     13613<<ASSIGN
ZITEM.FLAGS.MDSE.D
     11865**DCL     13895<<ASSIGN  14047<<ASSIGN  14208<<ASSIGN
ZITEM.FLAGS.MDSE.S
     11867**DCL     13992<<ASSIGN  14013<<ASSIGN  14120<<ASSIGN
ZITEM.FMT_SPEC
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:174  
     11888**DCL     13721<<ASSIGN  14269<<ASSIGN
ZITEM.NAMEFLAGS.STATUS_EXISTS
     11879**DCL     14248<<ASSIGN  14266<<ASSIGN
ZITEM.NPOINTER_FALSE
     11926**DCL     14273<<ASSIGN
ZITEM.NPOINTER_TRUE
     11925**DCL     14272<<ASSIGN
ZITEM.PUP
     11913**DCL     14237<<ASSIGN
ZITEM.PUP.BITS
     11916**DCL     14234<<ASSIGN
ZITEM.PUP.SCALE
     11915**DCL     14235<<ASSIGN
ZITEM.SET_DATATYP
     11875**DCL     14271<<ASSIGN
ZITEM.SIZE
     11859**DCL     14244<<ASSIGN  14245>>ASSIGN  14255<<ASSIGN
ZITEM.SP.VD
     11900**DCL     11904--REDEF   11907--REDEF
ZITEM.SP.VS.SZ
     11909**DCL     13728>>IF      13729>>ASSIGN
ZITEM.SUBSTART$
     11883**DCL     13594<<ASSIGN  13602<<ASSIGN
ZITEM.SUBSZ
     11884**DCL     13596<<ASSIGN  13597<<ASSIGN  13603<<ASSIGN
ZITEM.TEXTSTART$
     11876**DCL     13569<<ASSIGN
ZITEM.TEXTSZ
     11882**DCL     13570<<ASSIGN
ZITEM.VALUE
     11897**DCL     13674<<ASSIGN  13746<<ASSIGN
ZITEM.VALUEB
     11898**DCL     13720<<ASSIGN
ZITEM$
     11281**DCL     11858--IMP-PTR 13562<<ASSIGN  13564>>ASSIGN  13565>>ASSIGN  13566>>ASSIGN  13569>>ASSIGN
     13570>>ASSIGN  13594>>ASSIGN  13596>>ASSIGN  13597>>ASSIGN  13602>>ASSIGN  13603>>ASSIGN  13613>>ASSIGN
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:175  
     13674>>ASSIGN  13676>>ASSIGN  13677>>ASSIGN  13679>>ASSIGN  13680>>ASSIGN  13687>>ASSIGN  13698>>ASSIGN
     13720>>ASSIGN  13721>>ASSIGN  13722>>ASSIGN  13723>>ASSIGN  13728>>IF      13728>>IF      13729>>ASSIGN
     13742>>ASSIGN  13744>>ASSIGN  13745>>ASSIGN  13746>>ASSIGN  13785>>ASSIGN  13795>>ASSIGN  13796>>ASSIGN
     13798>>ASSIGN  13814>>ASSIGN  13815>>ASSIGN  13816>>ASSIGN  13895>>ASSIGN  13896>>ASSIGN  13992>>ASSIGN
     14013>>ASSIGN  14043>>ASSIGN  14047>>ASSIGN  14120>>ASSIGN  14145>>ASSIGN  14149>>ASSIGN  14152>>ASSIGN
     14154>>ASSIGN  14163>>ASSIGN  14164>>ASSIGN  14166>>ASSIGN  14167>>ASSIGN  14175>>ASSIGN  14176>>ASSIGN
     14178>>ASSIGN  14179>>ASSIGN  14186>>ASSIGN  14189>>ASSIGN  14190>>ASSIGN  14191>>ASSIGN  14193>>ASSIGN
     14194>>ASSIGN  14195>>ASSIGN  14203>>ASSIGN  14203>>ASSIGN  14204>>ASSIGN  14205>>ASSIGN  14208>>ASSIGN
     14234>>ASSIGN  14235>>ASSIGN  14237>>ASSIGN  14239>>IF      14239>>IF      14242>>ASSIGN  14244>>ASSIGN
     14245>>ASSIGN  14248>>ASSIGN  14250>>ASSIGN  14252<<ASSIGN  14252>>ASSIGN  14255>>ASSIGN  14255>>ASSIGN
     14261>>ASSIGN  14262>>ASSIGN  14263>>ASSIGN  14265>>ASSIGN  14266>>ASSIGN  14267>>ASSIGN  14268>>ASSIGN
     14269>>ASSIGN  14271>>ASSIGN  14272>>ASSIGN  14273>>ASSIGN
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:176  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:177  
              MINI UREF LISTING

DDD$VREF      31**PROC
M$ACCT     120**DCL-ENT
M$ACTIVATE     123**DCL-ENT
M$ALIB     116**DCL-ENT
M$ASUSER     118**DCL-ENT
M$ATTACH     125**DCL-ENT
M$BADPP     143**DCL-ENT
M$CGCTL     124**DCL-ENT
M$CGINFO     124**DCL-ENT
M$CHECK     105**DCL-ENT
M$CHGUNIT     163**DCL-ENT
M$CLOSE     103**DCL-ENT
M$CLRSTK     161**DCL-ENT
M$CMDVAR     172**DCL-ENT
M$CONFIG     133**DCL-ENT
M$CORRES     108**DCL-ENT
M$CPEXIT     117**DCL-ENT
M$CVM     141**DCL-ENT
M$CVOL     106**DCL-ENT
M$DCLFLD     133**DCL-ENT
M$DEACTIVATE     123**DCL-ENT
M$DELREC     105**DCL-ENT
M$DEQ     170**DCL-ENT
M$DETACH     125**DCL-ENT
M$DEVICE     107**DCL-ENT
M$DISPLAY     170**DCL-ENT
M$DISPRES     110**DCL-ENT
M$DLIB     116**DCL-ENT
M$DRIBBLE     133**DCL-ENT
M$DRTN     161**DCL-ENT
M$DSUSER     118**DCL-ENT
M$ENQ     169**DCL-ENT
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:178  
M$EOM     128**DCL-ENT
M$ERASE     134**DCL-ENT
M$ERR     115**DCL-ENT
M$ERRMSG     166**DCL-ENT
M$EVENT     158**DCL-ENT
M$EXHUME     167**DCL-ENT
M$EXIT     115**DCL-ENT
M$EXTEND     107**DCL-ENT
M$FDP     139**DCL-ENT
M$FDS     138**DCL-ENT
M$FEBOOT     131**DCL-ENT
M$FECTL     132**DCL-ENT
M$FEDUMP     131**DCL-ENT
M$FID     166**DCL-ENT
M$FINDPROC     120**DCL-ENT
M$FSUSER     118**DCL-ENT
M$FVP     140**DCL-ENT
M$FWCG     124**DCL-ENT
M$GBPL     144**DCL-ENT
M$GDDL     140**DCL-ENT
M$GDP     139**DCL-ENT
M$GDS     138**DCL-ENT
M$GETDCB     109**DCL-ENT
M$GETMOUSE     149**DCL-ENT
M$GETPM     150**DCL-ENT
M$GJOB     168**DCL-ENT
M$GLINEATTR     128**DCL-ENT
M$GOODPP     143**DCL-ENT
M$GPLATEN     136**DCL-ENT
M$GPROMPT     135**DCL-ENT
M$GTRMATTR     129**DCL-ENT
M$GTRMCTL     127**DCL-ENT
M$GTRMTAB     130**DCL-ENT
M$GVP     139**DCL-ENT
M$HELP     166**DCL-ENT
M$INT     158**DCL-ENT
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:179  
M$INTRTN     119**DCL-ENT
M$IOQ     154**DCL-ENT
M$JOBSTATS     168**DCL-ENT
M$KEYIN     108**DCL-ENT
M$LDEV     103**DCL-ENT
M$LDTRC     116**DCL-ENT
M$LIMIT     109**DCL-ENT
M$LINES     108**DCL-ENT
M$LINK     115**DCL-ENT
M$MADMUCK     111**DCL-ENT
M$MAKUSER     142**DCL-ENT
M$MBS     110**DCL-ENT
M$MDFFLD     134**DCL-ENT
M$MERC     159**DCL-ENT
M$MERCS     160**DCL-ENT
M$MIRROR     154**DCL-ENT
M$MONINFO     171**DCL-ENT
M$MPL     144**DCL-ENT
M$NODEINFO     135**DCL-ENT
M$NXTUSR     169**DCL-ENT
M$OCMSG     167**DCL-ENT
M$OLAY     115**DCL-ENT
M$OPEN     103**DCL-ENT
M$PAS     144**DCL-ENT
M$PATHCON     167**DCL-ENT
M$PDS     138**DCL-ENT
M$PFIL     105**DCL-ENT
M$PLATEN     129**DCL-ENT
M$PRECORD     107**DCL-ENT
M$PROCNAME     120**DCL-ENT
M$PROFILE     131**DCL-ENT
M$PROMPT     127**DCL-ENT
M$RACST     111**DCL-ENT
M$RDSYSLOG     152**DCL-ENT
M$READ     104**DCL-ENT
M$RELDCB     109**DCL-ENT
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:180  
M$RELRES     110**DCL-ENT
M$RELSTARF     112**DCL-ENT
M$REM     112**DCL-ENT
M$RENV     159**DCL-ENT
M$REQUIRE     111**DCL-ENT
M$RETRY     160**DCL-ENT
M$RETRYS     160**DCL-ENT
M$REW     106**DCL-ENT
M$RLSFLD     134**DCL-ENT
M$RPRIV     162**DCL-ENT
M$RSPP     141**DCL-ENT
M$RSWITCH     163**DCL-ENT
M$RUE     169**DCL-ENT
M$SAD     142**DCL-ENT
M$SAVE     118**DCL-ENT
M$SCON     119**DCL-ENT
M$SCREECH     117**DCL-ENT
M$SENV     159**DCL-ENT
M$SETFMA     103**DCL-ENT
M$SETFP     132**DCL-ENT
M$SINPUT     130**DCL-ENT
M$SLCFLD     135**DCL-ENT
M$SMOUSE     149**DCL-ENT
M$SMPRT     141**DCL-ENT
M$SPRIV     162**DCL-ENT
M$SSC     142**DCL-ENT
M$SSWITCH     162**DCL-ENT
M$STATE     171**DCL-ENT
M$STD     143**DCL-ENT
M$STIMER     157**DCL-ENT
M$STLPP     140**DCL-ENT
M$STRAP     157**DCL-ENT
M$STRMATTR     129**DCL-ENT
M$STRMCTL     127**DCL-ENT
M$STRMTAB     130**DCL-ENT
M$SYMBIO     168**DCL-ENT
PL6.E3A0      #001=DDD$VREF File=DDD$VREF.:E05TSI                                TUE 07/29/97 13:55 Page:181  
M$SYSCON     154**DCL-ENT
M$SYSID     172**DCL-ENT
M$TDCLOSE     153**DCL-ENT
M$TDIO     153**DCL-ENT
M$TDOPEN     152**DCL-ENT
M$TDREQCPU     153**DCL-ENT
M$TEMPWROC     147**DCL-ENT
M$TIME     170**DCL-ENT
M$TRAP     157**DCL-ENT
M$TRMISC     132**DCL-ENT
M$TRMPRG     128**DCL-ENT
M$TRTN     161**DCL-ENT
M$TRUNC     104**DCL-ENT
M$TTIMER     157**DCL-ENT
M$UC     127**DCL
M$UMPL     144**DCL-ENT
M$UNFID     166**DCL-ENT
M$UNLATCH     123**DCL-ENT
M$UNSHARE     120**DCL-ENT
M$USRFIELD     163**DCL-ENT
M$VIRTUAL     138**DCL-ENT
M$WAIT     161**DCL-ENT
M$WEOF     106**DCL-ENT
M$WRITE     104**DCL-ENT
M$WRSYSLOG     152**DCL-ENT
M$XCON     158**DCL-ENT
M$XCONRTN     119**DCL-ENT
M$XEQTIME     171**DCL-ENT
M$XFLUSH     112**DCL-ENT
M$XMOUSE     149**DCL-ENT
M$XXX     115**DCL-ENT
M$YC     117**DCL-ENT
SDD_L6$   11282**DCL
ZITEM_L6$   11283**DCL
