VERSION E05

PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:1    
        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6
        7        7        /*M* OCK$KEYIN  KEYIN main program */
        8        8        %SET LISTSUB='1'B;
        9        9        /*X* DMR,PLM=5,IND=5,CTI=5,SDI=5,MCL=10,CSI=0,ECI=0 */
       10       10        /* ****************************************************************
       11       11             ###     ###    #   #     #     #   #   #####   #   #    ###    #   #
       12       12            #   #   #   #   #  #     ###    #  #    #       #   #     #     #   #
       13       13            #   #   #       # #     # #     # #     #        # #      #     ##  #
       14       14            #   #   #       ##       ###    ##      ####      #       #     # # #
       15       15            #   #   #       # #       # #   # #     #         #       #     #  ##
       16       16            #   #   #   #   #  #     ###    #  #    #         #       #     #   #
       17       17             ###     ###    #   #     #     #   #   #####     #      ###    #   #
       18       18           **************************************************************** */
       19       19        /*P* NAME:  OCK$KEYIN
       20       20             PURPOSE:  To perform various initializations, dcb opens,
       21       21                       and comgroup reads.
       22       22             DESCRIPTION:  After initializations are performed, a wait-
       23       23                           for-event idle loop is entered.  When thirty
       24       24                           seconds have expired, KEYIN wakes up, prints
       25       25                           any pending TIMED WRITES, and reenters the
       26       26                           idle loop.
       27       27                                                                       */
       28       28        /*D* NAME:  OCK$KEYIN
       29       29             CALL: None -- main program
       30       30             INTERFACE:  OCP$ADDSTATION, OCP$DOLIST, OCE$ EVENT, OCW$WRITE
       31       31             DESCRIPTION:  Event control is taken with OCE$EVENT
       32       32                           specified as the event-processing routine.
       33       33                           The Operator's Console COMGROUP (OCCG) is
       34       34                           opened and any consoles which are already
       35       35                           connected are added to the list of connected
       36       36                           consoles.
       37       37                           The Central System COMGROUP (CSCG) is then opened,
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:2    
       38       38                           and currently any connected stations are ignored.
       39       39                           When the message-template file (:OCMSG) exists,
       40       40                           both comgroups are read and the idle loop entered.
       41       41                           Upon wake-up due to a thirty-second expiration of
       42       42                           time, OCP$DOLIST is called to print any pending
       43       43                           TIMED WRITES and the idle loop is reentered
       44       44                                                                            */
       45       45                                                /**/
       46       46                                                /**/
       47       47        OCK$KEYIN: PROC MAIN;                   /* KEYIN main program */
       48       48
       49       49                                           /* This assembly flag allows
       50       50                                                selective compilation for
       51       51                                                LADC test mode operations */
       52       52        %SET FORREAL='1'B;
       53       53
       54       54                                                /**/
       55       55                                                /**/
       56       56        %INCLUDE B_SEGIDS_C;
       57      595                                                /**/
       58      596    1   DCL LOCAL_TIME CHAR(11) UNAL STATIC;
       59      597    1   DCL LOCAL_DATE CHAR(8) UNAL STATIC;
       60      598    1   DCL UTS UBIN WORD ALIGNED STATIC SYMDEF;
       61      599    1   DCL NEW_UTS UBIN WORD ALIGNED STATIC SYMDEF;
       62      600    1   DCL OC_GOOSE_STA CHAR(8) SYMREF;
       63      601                                                /**/
       64      602                                                /**/
       65      603        %INCLUDE OCI_SUBS_C;
       66      701                                                /**/
       67      702        %INCLUDE OC_SUBS_C;
       68     1433                                                /**/
       69     1434        %INCLUDE CP_6;
       70     1515        %INCLUDE OC_DAT_R;
       71     1676        %INCLUDE OC_SCODE_C;
       72     1701
       73     1702        %INCLUDE JG_GHOSTS_C;
       74     1792 S      %INCLUDE B$JIT_C;
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:3    
       75     1793             %B$JIT0;
       76     1882             %A$JIT6X;
       77     1885        %INCLUDE XUD_UTS_M;
       78     1967
       79     1968        %XUD$UTS_ENTRIES;                       /* expand routine dcls */
       80     2000        %XUD_UTS_EQU;                           /* expand constant EQUates */
       81     2011
       82     2012
       83     2013    1   DCL B$JIT$ PTR SYMREF;
       84     2014
       85     2015                                                /**/
       86     2016             %FPT_SCREECH   (FPTN=OCK_SCREECH,
       87     2017                                 SCODE=OCK$SCODE);
       88     2031                                                /**/
       89     2032                                                /**/
       90     2033             %VLP_SCREECH (FPTN=OCK$SCODE,
       91     2034                                 STCLASS=STATIC SYMDEF,
       92     2035                                 FCG=OC,
       93     2036                                 MID=K,
       94     2037                                 MON='0'B,
       95     2038                                 CODE=999);
       96     2108                                                /**/
       97     2109                                                /**/
       98     2110                                                /**/
       99     2111             %FPT_GDS       (FPTN=GET_COMMON,
      100     2112                                 STCLASS=STATIC,
      101     2113                                 RESULTS=GET_COM_RESULTS,
      102     2114                                 SEGSIZE=999,
      103     2115                                 COMMON=YES );
      104     2131
      105     2132                  %FPT_GDS  (FPTN=FREE_XS,
      106     2133                                 STCLASS=STATIC,
      107     2134                                 COMMON=YES,
      108     2135                                 RESULTS=GET_COM_RESULTS,
      109     2136                                 SEGSIZE=999);
      110     2152
      111     2153                                                /*
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:4    
      112     2154                                                     Actual size to release
      113     2155                                                     is dynamically calculated
      114     2156                                                     and dumped in FPT */
      115     2157
      116     2158
      117     2159            %FPT_EVENT      (UENTRY=OCE$EVENT);
      118     2173                                                /**/
      119     2174             %FPT_OPEN      (FPTN=OC_OPEN,
      120     2175                                   DCB=M$OCCG,
      121     2176                                   ASN=COMGROUP,
      122     2177                                   SETSTA=KSST,
      123     2178                                   FUN=CREATE,
      124     2179                                   EXIST=NEWFILE,
      125     2180                                   CTG=YES,
      126     2181                                   SHARE=ALL,
      127     2182                                   AU=YES,
      128     2183                                 ACCT=TACCT,
      129     2184                                   IXTNSIZE=100,
      130     2185                                   NAME=OCCGNM);
      131     2294             %VLP_NAME      (FPTN=OCCGNM,
      132     2295                                  NAME='OCCG');
      133     2322              %VLP_SETSTA      (FPTN=KSST,
      134     2323                                STCLASS=CONSTANT,
      135     2324                                MYSTATION='KEYIN');
      136     2352             %FPT_OPEN      (FPTN=CS_OPEN,
      137     2353                                 DCB=M$CSCG,
      138     2354                                 ASN=COMGROUP,
      139     2355                                 SETSTA=KSST,
      140     2356                                 FUN=UPDATE,
      141     2357                                 SHARE=ALL,
      142     2358                                 AU=YES,
      143     2359                            IXTNSIZE=200,
      144     2360                                 ACCT=TACCT,
      145     2361                                 NAME=CSCGNM );
      146     2470                  %VLP_NAME (FPTN=CSCGNM,
      147     2471                                 NAME='CSCG');
      148     2498                                                /**/
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:5    
      149     2499             %FPT_CGCTL     (FPTN=OC_CGCTL,
      150     2500                                 DCB=M$OCCG,
      151     2501                                 CGCP=VLP_CGCP,
      152     2502                                 STCLASS=CONSTANT);
      153     2525                                                /**/
      154     2526             %VLP_CGCP      (FPTN=VLP_CGCP,
      155     2527                                 MINPG=2,
      156     2528                                 TERMCONAU=YES,
      157     2529                                 TERMCONNAU=NO,
      158     2530                                 AUCONTERM=ACTIVATE,
      159     2531                                 AUDCONTERM=DEACTIVATE,
      160     2532                                 WAS=NO,
      161     2533                                 RAS=NO,
      162     2534                                 SMD=NO,
      163     2535                                 MAXMC=200,
      164     2536                            MAXPG=50,
      165     2537                            MEMWARN=25,
      166     2538                            DISKWARN=25,
      167     2539                            DATAPGS=10,
      168     2540                                 TRMRDSIZ=140,
      169     2541                                 DCBCONLGL=NO,
      170     2542                                 TERMCONLGL=YES,
      171     2543                                 SECURE=NO,
      172     2544                                 XSTALGL=YES,
      173     2545                                 XTYPLGL=YES);
      174     2588                                                /**/
      175     2589             %FPT_OPEN      (FPTN=MSGF_OPEN,
      176     2590                                 DCB=F$TEMPLATE,
      177     2591                                 ASN=FILE,
      178     2592                                 NAME=MNAME,
      179     2593                                 ACCT=TACCT,
      180     2594                                 ORG=KEYED,
      181     2595                                 ACS=DIRECT,
      182     2596                                 FUN=IN,
      183     2597                                 DISP=NAMED,
      184     2598                                 SHARE=ALL,
      185     2599                                 SETDCB=NO);
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:6    
      186     2708             %VLP_NAME      (FPTN=MNAME,
      187     2709                                 NAME=':OCMSG');
      188     2736             %VLP_ACCT      (FPTN=TACCT,
      189     2737                                 ACCT=':SYS');
      190     2750                                                /**/
      191     2751             %FPT_OPEN      (FPTN=KEYF_OPEN,
      192     2752                                 DCB=F$KEYIN,
      193     2753                                 ASN=FILE,
      194     2754                                 NAME=KNAME,
      195     2755                                 ACCT=TACCT,
      196     2756                                 ORG=KEYED,
      197     2757                                 ACS=SEQUEN,
      198     2758                                 FUN=IN,
      199     2759                                 DISP=NAMED,
      200     2760                                 SHARE=ALL,
      201     2761                                 SETDCB=YES );
      202     2870                  %VLP_NAME (FPTN=KNAME,
      203     2871                                 NAME=':OCKEY');
      204     2898                                                /**/
      205     2899             %FPT_READ      (FPTN=OC_READ,
      206     2900                                 DCB=M$OCCG,
      207     2901                                 WAIT=NO,
      208     2902                                 EVENT=OC_RDDN_O,
      209     2903                                 BUF=OC_KEYINBUF);
      210     2942                                                /**/
      211     2943             %FPT_READ      (FPTN=CS_READ,
      212     2944                                 DCB=M$CSCG,
      213     2945                                 WAIT=NO,
      214     2946                                 EVENT=OC_RDDN_C,
      215     2947                                 BUF=OC_MSGBUFFER);
      216     2986                                                /**/
      217     2987             %FPT_READ      (FPTN=KEYF_READ,
      218     2988                                 DCB=F$KEYIN,
      219     2989                                 WAIT=YES,
      220     2990                                 KEYS=NO );
      221     3029                                                /**/
      222     3030             %FPT_CLOSE     (FPTN=KEYF_CLOSE,
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:7    
      223     3031                                 DCB=F$KEYIN,
      224     3032                                 DISP=SAVE );
      225     3074                                                /**/
      226     3075             %FPT_LINK      (FPTN=LINK_2_PARTRGE,
      227     3076                                 NAME=PARTRGE,
      228     3077                                 ACCT=PARTACC);
      229     3095                                                /**/
      230     3096                  %VLP_NAME (FPTN=PARTRGE,
      231     3097                                 NAME='PARTRGE');
      232     3124                                                /**/
      233     3125                  %VLP_ACCT (FPTN=PARTACC,
      234     3126                                 ACCT=':SYS    ');
      235     3139                                                /**/
      236     3140             %FPT_WAIT      (FPTN=WAIT_20SECS,
      237     3141                                 UNITS=20);
      238     3155                                                /**/
      239     3156             %FPT_WAIT      (FPTN=MAIN_WAIT,
      240     3157                                 UNITS=NUM_SECS#,
      241     3158                                 UETIME=OC_REMAIN );
      242     3172                                                /**/
      243     3173             %FPT_WAIT      (FPTN=FIVE_SECOND,
      244     3174                                 UNITS=5);
      245     3188                                                /**/
      246     3189             %FPT_XCON      (FPTN=GET_XCON,
      247     3190                                 UENTRY=OCK$XCON);
      248     3204                                                /**/
      249     3205                                                /**/
      250     3206             %FPT_TIME      (FPTN=GET_UTS,
      251     3207                                 SOURCE=CLOCK,
      252     3208                                 DEST=UTS,
      253     3209                                 TSTAMP=NEW_UTS);
      254     3228             %FPT_GDS       (FPTN=GET_CONS_SEG,
      255     3229                                 FREE=YES,
      256     3230                                 RESULTS=CONS_SEG,
      257     3231                                 SEGSIZE="SIZEW(OC_CONSOLE(0))");
      258     3247
      259     3248                  %VLP_VECTOR(FPTN=CONS_SEG,
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:8    
      260     3249                                 SEGID=%DS5SID);
      261     3264
      262     3265             %FPT_PRIV      (FPTN=RESET_FMSEC,
      263     3266                                 PRIV="%(%PR_FMSEC#|%PR_FMREAD#)");
      264     3281
      265     3282
      266     3283                                                /**/
      267     3284                                                /**/
      268     3285                                                /**/
      269     3286             %F$DCB;
      270     3343                                                /**/
      271     3344    1   DCL OCP$ADDSTA ENTRY(1);
      272     3345    1   DCL OCE$EVENT           ENTRY ASYNC;
      273     3346    1   DCL OCE$MAKEDO ENTRY(2);
      274     3347    1   DCL OCE$PEVENT ENTRY;
      275     3348    1   DCL OCL$STATUS ENTRY(1);
      276     3349    1   DCL OCW$WRITE ENTRY(5);
      277     3350    1   DCL OCL$INIT ENTRY(1);
      278     3351    1   DCL OCP$INITCONSOLE ENTRY(1);
      279     3352                                                /**/
      280     3353    1   DCL OCK$XCON ENTRY ASYNC;
      281     3354                                                /**/
      282     3355    1   DCL  I              UBIN WORD;
      283     3356    1   DCL  J              UBIN WORD;
      284     3357    1   DCL K SBIN WORD STATIC;
      285     3358    1   DCL L SBIN WORD STATIC;
      286     3359    1   DCL  TRIES          UBIN WORD;
      287     3360    1   DCL  GET_COM_RESULTS     DALIGNED STATIC BIT(72);
      288     3361    1   DCL NO_STATION CHAR(8) STATIC INIT (' ');
      289     3362    1   DCL  NO_OPENM       CHAR(0)   STATIC    INIT
      290     3363    1             (' KEYIN trying to start: Can''t open :OCMSG template file');
      291     3364    1   DCL  NO_OPENK       CHAR(0)   STATIC    INIT
      292     3365    1             (' KEYIN trying to start: Can''t open :OCKEY.:SYS');
      293     3366    1   DCL  NO_MEMK CHAR(0) STATIC INIT
      294     3367    1         (' KEYIN aborting: Can''t get COMMON pages for input templates');
      295     3368    1   DCL NO_READK CHAR(0) STATIC INIT
      296     3369    1             (' KEYIN aborting: Unable to read :OCKEY.:SYS file');
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:9    
      297     3370                                                /**/
      298     3371    1   DCL  M$OCCG    DCB;
      299     3372    1   DCL  M$CSCG    DCB;
      300     3373    1   DCL  F$TEMPLATE     DCB;
      301     3374    1   DCL  F$KEYIN        DCB;
      302     3375                                                /**/
      303     3376    1   DCL  F$KEYIN$ PTR STATIC;
      304     3377                                                /**/
      305     3378        /*
      306     3379                  Begin Main
      307     3380                                                                          */
      308     3381
      309     3382        %IF FORREAL;
      310     3383
      311     3384    1        IF B$JIT$ -> B$JIT.SYSID ~= 02/*JG_KEYIN#   */
      312     3385    1        THEN
      313     3386    1             CALL M$EXIT;
      314     3387
      315     3388        %ENDIF;
      316     3389
      317     3390                                           /*  Initialize KEYIN's
      318     3391                                                internal queues  */
      319     3392    1        OC_QDEPTH = 0;
      320     3393    1        OC_QPOSN = 0;
      321     3394    1        OC_QHEAD = 0;
      322     3395                                                /* Make DCB pointers */
      323     3396    1        M$OCCG$ = DCBADDR (DCBNUM (M$OCCG));
      324     3397    1        M$CSCG$ = DCBADDR (DCBNUM (M$CSCG));
      325     3398    1        F$KEYIN$ = DCBADDR (DCBNUM (F$KEYIN));
      326     3399    1        CALL M$GDS(GET_CONS_SEG) ALTRET(OCK$SCREECH8);
      327     3400    1        OC_CONSOLE$ = CONS_SEG.PTR$;
      328     3401    1        OC_MAXCONSOLE = 0;                 /* SET MAX CONSOLE NUMBER */
      329     3402    1        CALL OCP$INITCONSOLE (0);
      330     3403                                                /* SET UP INDEX 0 FOR KEYIN USE */
      331     3404                                                /**/
      332     3405                                           /* The following assignments are those
      333     3406                                                of a "pseudo console" which
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:10   
      334     3407                                                will allow ghosts to communicate
      335     3408                                                with keyin. Console 0 (zero) is
      336     3409                                                not the first console to logon. */
      337     3410                                                /**/
      338     3411    1        OC_CONSOLE.STATION(0) = OC_GOOSE_STA;
      339     3412    1        OC_CONSOLE.TERM_NAME(0) = 'LOCAL';
      340     3413    1        OC_CONSOLE.WSN(0) = '? ';
      341     3414    1        OC_CONSOLE.LOGON(0) = 'GOOSE   ';
      342     3415    1        OC_CONSOLE.CID_O(0) = OC_INTBIT;
      343     3416    1        OC_CONSOLE.SYSID (0) = 0;
      344     3417    1        OC_CONSOLE.ATTR_INPUT(0) = '000400'O /* M_GOOSE */;
      345     3418    1        OC_CONSOLE.ATTR_INPUT_SAVE(0) = '000400'O /* M_GOOSE */;
      346     3419    1        OC_CONSOLE.ATTR_OUTPUT_SAVE(0) = '200000'O /* M_SYS  */;
      347     3420    1        OC_CONSOLE.ATTR_OUTPUT(0) = '200000'O /* M_SYS  */;
      348     3421    1        OC_CONSOLE.ACTIVE(0) = '1'B /*TRUE#*/;
      349     3422    1        OC_CONSOLE.MXPRIO(0) = 99;
      350     3423    1        OC_CONSOLE.FLAGS.INPT(0) = '1'B /*TRUE#*/;
      351     3424    1        OC_CONSOLE.FLAGS.OUTP(0) = '0'B /*FALSE#*/;
      352     3425                                                /* Set event entry point */
      353     3426    1        CALL M$EVENT (FPT_EVENT) ALTRET (OCK$SCREECH7);
      354     3427                                           /* Open OC ComGroup (If KEYIN cannot
      355     3428                                              open OCCG, something is very
      356     3429                                              wrong.) */
      357     3430    1        CALL M$OPEN (OC_OPEN) ALTRET (OCK$SCREECH4);
      358     3431                                                /**/
      359     3432    1        CALL M$CGCTL (OC_CGCTL) ALTRET(OCK$SCREECH4);
      360     3433                                                /**/
      361     3434                                                /**/
      362     3435                                           /* Get Exit Control  (Upon any
      363     3436                                                Exit condition, KEYIN will
      364     3437                                                screech) */
      365     3438    1        CALL M$XCON (GET_XCON);
      366     3439                                                /**/
      367     3440                                           /* Open the Central System ComGroup.
      368     3441                                              as with OCCG, an ALTRET means
      369     3442                                              real trouble */
      370     3443    1        CALL M$OPEN (CS_OPEN) ALTRET (OCK$SCREECH3);
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:11   
      371     3444                                                /**/
      372     3445                                           /* Open the template files here.
      373     3446                                                The output template file,
      374     3447                                                :OCMSG, is kept open, as KEYIN
      375     3448                                                reads the file whenever it
      376     3449                                                needs an output template.  The
      377     3450                                                key-in templates are an in-core
      378     3451                                                image of PARSENODER output, and
      379     3452                                                are read into a set of COMMON
      380     3453                                                pages, and once read in, the
      381     3454                                                file is closed. */
      382     3455    1        CALL OPEN$MSG ALTRET (WHO_CARES1);
      383     3456    1   WHO_CARES1: ;
      384     3457                                           /* Open the :OCKEY file, examine the
      385     3458                                                FPARAMs and put the PARTRGE
      386     3459                                                core-image into COMMON data */
      387     3460    1        CALL OPEN$KEY ALTRET (WHO_CARES2);
      388     3461    1   WHO_CARES2: ;
      389     3462    1        OC_FIRST_CONSOLE = '1'B;           /* Indicate that first console
      390     3463                                                     has yet to logon */
      391     3464                                                /**/
      392     3465                                                /**/
      393     3466    1        CALL M$TIME (GET_UTS);
      394     3467                                                /**/
      395     3468    1        CALL XUD$UTS_DIFF_SEC (K, NEW_UTS, 0); /* get time in secs */
      396     3469    1        OC_REMAIN = MOD (K, 60);           /* secs into this minute */
      397     3470                                                /**/
      398     3471    1        IF OC_REMAIN < 5
      399     3472    1        THEN
      400     3473    1             OC_REMAIN = OC_REMAIN + 60;
      401     3474    1        OC_REMAIN = 65 - OC_REMAIN;
      402     3475    1        CALL XUD$UTS_ADJUST (UTS, NEW_UTS, OC_REMAIN * %UTS_CSEC_SEC#);
              3475                 /* add OC_REMAIN seconds */
      403     3476                                                /**/
      404     3477    1        MAIN_WAIT.V.UNITS# = OC_REMAIN;
      405     3478                                                /**/
      406     3479    1        OC_NEXT_PEND = OC_NEXT_PENDX -
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:12   
      407     3480    1             MOD (K/60, 60);               /* minutes into this hour */
      408     3481                                                /**/
      409     3482                                                /**/
      410     3483    1        CALL M$RPRIV (RESET_FMSEC) ALTRET (O_NO);
      411     3484    1   O_NO: ;
      412     3485
      413     3486                                           /* Read the ComGroups...
      414     3487                                                if there are events outstanding
      415     3488                                                they will be processed and we
      416     3489                                                will fall into wait loop...
      417     3490                                                if none, just wait for one */
      418     3491    1        CALL M$READ (OC_READ) ALTRET (OCK$SCREECH5);
      419     3492        %EJECT;
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:13   
      420     3493                                           /*
      421     3494             MAIN WAIT LOOP
      422     3495                                           */
      423     3496    2        DO WHILE ('1'B)  /* FOREVER */;
      424     3497                                                /**/
      425     3498
      426     3499    3             DO INHIBIT;                   /* ENTIRE LOOP IS INHIBITED */
      427     3500
      428     3501    4                  DO WHILE (OC_QDEPTH ~= 0);
      429     3502                                                /**/
      430     3503    4                       CALL OCE$PEVENT;    /* Process the events */
      431     3504                                                /**/
      432     3505                                                /**/
      433     3506    4                       CALL M$TIME (GET_UTS);
      434     3507                                                /**/
      435     3508    4                       IF NEW_UTS > UTS    /* past old UTS? */
      436     3509    4                       THEN
      437     3510    4                            MAIN_WAIT.V.UNITS# = 0;
      438     3511    4                       ELSE
      439     3512    4                            CALL XUD$UTS_DIFF_SEC (MAIN_WAIT.V.UNITS#,
      440     3513    4                                 UTS, NEW_UTS);
      441     3514    4                       IF MAIN_WAIT.V.UNITS# > 61
      442     3515    4                       THEN
      443     3516    4                            MAIN_WAIT.V.UNITS# = 0;
      444     3517    4                     END;                  /* DO WHILE MORE TO DO */
      445     3518                                                /**/
      446     3519
      447     3520    3                  OC_REMAIN = MAIN_WAIT.V.UNITS#;
      448     3521
      449     3522    3                  IF OC_QDEPTH = 0
      450     3523    3                  THEN
      451     3524    3                       CALL M$WAIT (MAIN_WAIT);
      452     3525                                                /**/
      453     3526    3                  IF OC_REMAIN = 0
      454     3527    3                  THEN
      455     3528    4                  DO;
      456     3529    4                       CALL OCE$MAKEDO(5 /* OC_DOLIST_C */,0);
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:14   
      457     3530    4                       CALL M$TIME (GET_UTS);
      458     3531    4                       CALL XUD$UTS_DIFF_SEC (K, NEW_UTS, 0);
      459     3532    4                       OC_REMAIN = MOD (K, 60); /* secs into minute */
      460     3533    4                       IF OC_REMAIN < 5
      461     3534    4                       THEN
      462     3535    4                            OC_REMAIN = OC_REMAIN + 60;
      463     3536    4                       OC_REMAIN = 65 - OC_REMAIN;
      464     3537                                                /**/
      465     3538    4                       CALL XUD$UTS_ADJUST (UTS, NEW_UTS, OC_REMAIN * %UTS_CSEC_SEC#);
      466     3539    4                       OC_NEXT_PEND = OC_NEXT_PENDX -
      467     3540    4                            MOD (K/60, OC_NEXT_PENDX); /* min into next interval */
      468     3541    4                     END;                  /* DO IF EXPIRED */
      469     3542                                                /**/
      470     3543    3                  MAIN_WAIT.V.UNITS# = OC_REMAIN;
      471     3544                                                /**/
      472     3545    3                END;                       /* DO FOREVER */
      473     3546                                                /**/
      474     3547
      475     3548    2           END;                            /* DO INHIBIT */
      476     3549
      477     3550                                                /**/
      478     3551                                                /**/
      479     3552                  /*S*
      480     3553                            SCREECH_CODE: OCK-S$NOOPENCSCG
      481     3554                            TYPE: SCREECH
      482     3555                            MESSAGE: KEYIN failed to open CSCG
      483     3556                            REMARKS: KEYIN requires use of the Central System
      484     3557                                      ComGroup to perform its inter-task
      485     3558                                      communication.
      486     3559                                      console log */
      487     3560    1   OCK$SCREECH3:
      488     3561    1        OCK$SCODE.CODE# = %S$NOOPENCSCG;
      489     3562    1        GOTO OCK$SCREECH;
      490     3563                                                /**/
      491     3564                                                /**/
      492     3565                  /*S*
      493     3566                            SCREECH_CODE: OCK-S$NOOPENOCCG
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:15   
      494     3567                            TYPE: SCREECH
      495     3568                                 MESSAGE: KEYIN failed to open OCCG
      496     3569                            REMARKS: If KEYIN cant open the ComGroup, no consoles
      497     3570                                      can be activated
      498     3571                                                                          */
      499     3572    1   OCK$SCREECH4:
      500     3573    1        OCK$SCODE.CODE# = %S$NOOPENOCCG;
      501     3574    1        GOTO OCK$SCREECH;
      502     3575                       /*S*
      503     3576                            SCREECH_CODE: OCK-S$NOREADOCCG
      504     3577                            TYPE: SCREECH
      505     3578                            MESSAGE: KEYIN cannot read the OC ComGroup
      506     3579                            REMARKS:
      507     3580                                                                          */
      508     3581    1   OCK$SCREECH5:
      509     3582    1        OCK$SCODE.CODE# = %S$NOREADOCCG;
      510     3583    1        GOTO OCK$SCREECH;
      511     3584                       /*S*
      512     3585                            SCREECH_CODE: OCK-S$NOREADCSCG
      513     3586                            TYPE: SCREECH
      514     3587                            MESSAGE: KEYIN could not read the Central System
      515     3588                                      ComGroup
      516     3589                            REMARKS:
      517     3590                                                                          */
      518     3591        /*
      519     3592        OCK$SCREECH6:
      520     3593             OCK$SCODE.CODE# = %S$NOREADCSCG;
      521     3594             GOTO OCK$SCREECH;
      522     3595        */
      523     3596                       /*S*
      524     3597                            SCREECH_CODE: OCK-S$OCCANTEVENT
      525     3598                            TYPE: SCREECH
      526     3599                            MESSAGE: KEYIN could not perform M$EVENT PMME
      527     3600                            REMARKS:
      528     3601                                                                          */
      529     3602    1   OCK$SCREECH7:
      530     3603    1        OCK$SCODE.CODE# = %S$OCCANTEVENT;
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:16   
      531     3604    1        GOTO OCK$SCREECH;
      532     3605                       /*S*
      533     3606                            SCREECH_CODE: OCK-S$OCCANTGDS
      534     3607                            TYPE: SCREECH
      535     3608                            MESSAGE: KEYIN could not acquire memory to perform
      536     3609                                      internal table builds
      537     3610                            REMARKS:
      538     3611                                                                          */
      539     3612    1   OCK$SCREECH8:
      540     3613    1        OCK$SCODE.CODE# = %S$OCCANTGDS;
      541     3614    1        GOTO OCK$SCREECH;
      542     3615                                                /**/
      543     3616                                                /**/
      544     3617    1   OCK$SCREECH:
      545     3618    1        CALL M$SCREECH (OCK_SCREECH);
      546     3619        %EJECT;
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:17   
      547     3620                                                /**/
      548     3621                                           /* OPEN$MSG will attempt to
      549     3622                                                open the output template file.
      550     3623                                                If it cant be opened after
      551     3624                                                30 seconds, SCREECH */
      552     3625    1   OPEN$MSG: PROC ALTRET;
      553     3626    2        OC_MSG_GOOD = '0'B /*FALSE#*/;
      554     3627    3        DO TRIES = 1 TO 36 /* NUM_ATTEMPTS# */;
      555     3628    3             CALL M$OPEN (MSGF_OPEN) ALTRET (OPEN$MSG_ALT);
      556     3629    3             OC_MSG_GOOD = '1'B /*TRUE#*/;
      557     3630    3             RETURN;
      558     3631    3   OPEN$MSG_ALT:
      559     3632    3             CALL M$WAIT(FIVE_SECOND);
      560     3633    3           END;
      561     3634    2        CALL OCW$WRITE (NO_OPENM, SIZEC(NO_OPENM),
      562     3635    2             '020000'O /* M_DLTA  */, NO_STATION);
      563     3636    2        ALTRETURN;
      564     3637    2   END OPEN$MSG;
      565     3638                                                /**/
      566     3639        %EJECT;
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:18   
      567     3640                                                /**/
      568     3641                                           /* OPEN$KEY will open the input tem-
      569     3642                                                plate file (PARTRGE output) and
      570     3643                                                read the composed X$PARSE table
      571     3644                                                into a COMMON data segment */
      572     3645                                                /**/
      573     3646    1   OPEN$KEY: PROC ALTRET;
      574     3647    2        OC_KEY_GOOD = '0'B /*FALSE#*/;
      575     3648    3        DO TRIES = 1 TO 36 /* NUM_ATTEMPTS# */;
      576     3649    3             CALL M$OPEN (KEYF_OPEN) ALTRET (OPEN$KEY_ALT);
      577     3650                                           /*
      578     3651                                                Upon successful open, check the
      579     3652                                                DCB for largest record length
      580     3653                                                and allocate a COMMON segment
      581     3654                                                that large */
      582     3655    3             GET_COMMON.V.SEGSIZE# =
      583     3656    3                  10240;                   /* Start with 10K */
      584     3657    3             CALL M$GDS (GET_COMMON) ALTRET (OPEN$KEY_MEM);
      585     3658                                           /*
      586     3659                                                Read the PARTRGE core-image into
      587     3660                                                the COMMON pages   */
      588     3661    3             KEYF_READ.BUF_ = GET_COM_RESULTS;
      589     3662    3             CALL M$READ (KEYF_READ) ALTRET (OPEN$KEY_READ);
      590     3663    3             CALL M$CLOSE (KEYF_CLOSE);
      591     3664    3             OC_KEY_GOOD = '1'B /*TRUE#*/;
      592     3665    3             J = (DCBADDR(DCBNUM(F$KEYIN)) -> F$DCB.ARS# + 3) / 4;
      593     3666    3             K = J / 1024;
      594     3667    3             L = MOD (J, 1024);
      595     3668    3             IF L ~= 0
      596     3669    3             THEN
      597     3670    3                  K = K + 1;
      598     3671
      599     3672    3             FREE_XS.V.SEGSIZE# = 10240 - (K * 1024);
      600     3673
      601     3674    3             CALL M$FDS (FREE_XS) ALTRET (OH_NO_NOT_AGAIN);
      602     3675
      603     3676    3   OH_NO_NOT_AGAIN: ;
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:19   
      604     3677
      605     3678    3             RETURN;
      606     3679                                                /**/
      607     3680    3   OPEN$KEY_ALT:
      608     3681                                                /**/
      609     3682                                           /* IF NO KEYIN template file, M$LINK
      610     3683                                                to PARTRGE to ask him to build
      611     3684                                                it for me */
      612     3685    3             CALL M$LINK (LINK_2_PARTRGE) ALTRET (OPEN$KEY_READ);
      613     3686                                                /**/
      614     3687    3             CALL M$WAIT (FIVE_SECOND);
      615     3688    3           END;
      616     3689    2        CALL OCW$WRITE (NO_OPENK, SIZEC(NO_OPENK),
      617     3690    2             '020000'O /* M_DLTA  */, NO_STATION);
      618     3691    2        ALTRETURN;
      619     3692                                                /**/
      620     3693    2   OPEN$KEY_MEM:
      621     3694    2        CALL OCW$WRITE (NO_MEMK, SIZEC(NO_MEMK),
      622     3695    2             '020000'O /* M_DLTA  */, NO_STATION);
      623     3696    2        CALL M$WAIT (WAIT_20SECS);
      624     3697    2        ALTRETURN;
      625     3698                                                /**/
      626     3699    2   OPEN$KEY_READ:
      627     3700    2        CALL OCW$WRITE (NO_READK, SIZEC(NO_READK),
      628     3701    2             '020000'O /* M_DLTA  */, NO_STATION);
      629     3702    2        CALL M$WAIT (WAIT_20SECS);
      630     3703    2        ALTRETURN;
      631     3704    2   END OPEN$KEY;
      632     3705    1   END OCK$KEYIN;
      633     3706        %EOD;

PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:20   
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   OC_SCODE_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCK$KEYIN.

   Procedure OCK$KEYIN requires 361 words for executable code.
   Procedure OCK$KEYIN requires 12 words of local(AUTO) storage.

PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:21   

 Object Unit name= OCK$KEYIN                                  File name= OCK$KEYIN.:E05TOU
 UTS= JUL 30 '97 03:58:11.24 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none   494    756  OCK$KEYIN
    1   DCB   even  none     0      0  M$UC
    2  RoData even  UTS     69    105  OCK$KEYIN
    3   DCB   even  none     0      0  M$OCCG
    4   DCB   even  none     0      0  M$CSCG
    5   DCB   even  none     0      0  F$TEMPLATE
    6   DCB   even  none     0      0  F$KEYIN
    7   Proc  even  none   361    551  OCK$KEYIN
    8  RoData even  none    34     42  OCK$KEYIN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     7      0   yes            yes      Main       0  OCK$KEYIN

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      5  UTS                                0      6  NEW_UTS
    0     16  OCK$SCODE
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:22   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          Async      0 OCE$EVENT
 yes     yes           Std       3 XUD$UTS_DIFF_SEC
         yes           Std       0 OCE$PEVENT
         yes           Std       1 OCP$INITCONSOLE
         yes          Async      0 OCK$XCON
         yes           Std       2 OCE$MAKEDO
 yes     yes           Std       3 XUD$UTS_ADJUST
         yes           Std       5 OCW$WRITE
                       nStd      0 X66_MAUTO
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_MARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     OC_GOOSE_STA                          M$UC                                  OC_INTMSG
     OC_MESSBUF                            OC_MSGBUFFER                          OC_QDEPTH
     OC_QHEAD                              OC_QPOSN                              OC_REMAIN
     OC_NEXT_PEND                          OC_NEXT_PENDX                         OC_KEYINBUF
     OC_PARAM                              OC_CONSOLE$                           OC_MAXCONSOLE
     M$OCCG$                               M$CSCG$                               OC_DIR
     OC_INTBIT                             OC_MASK                               OC_MSG_GOOD
     OC_KEY_GOOD                           OC_FIRST_CONSOLE                      B$JIT$
     M$OCCG                                M$CSCG                                F$TEMPLATE
     F$KEYIN                               B_VECTNIL
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:23   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:24   


        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6
        7        7        /*M* OCK$KEYIN  KEYIN main program */
        8        8        %SET LISTSUB='1'B;
        9        9        /*X* DMR,PLM=5,IND=5,CTI=5,SDI=5,MCL=10,CSI=0,ECI=0 */
       10       10        /* ****************************************************************
       11       11             ###     ###    #   #     #     #   #   #####   #   #    ###    #   #
       12       12            #   #   #   #   #  #     ###    #  #    #       #   #     #     #   #
       13       13            #   #   #       # #     # #     # #     #        # #      #     ##  #
       14       14            #   #   #       ##       ###    ##      ####      #       #     # # #
       15       15            #   #   #       # #       # #   # #     #         #       #     #  ##
       16       16            #   #   #   #   #  #     ###    #  #    #         #       #     #   #
       17       17             ###     ###    #   #     #     #   #   #####     #      ###    #   #
       18       18           **************************************************************** */
       19       19        /*P* NAME:  OCK$KEYIN
       20       20             PURPOSE:  To perform various initializations, dcb opens,
       21       21                       and comgroup reads.
       22       22             DESCRIPTION:  After initializations are performed, a wait-
       23       23                           for-event idle loop is entered.  When thirty
       24       24                           seconds have expired, KEYIN wakes up, prints
       25       25                           any pending TIMED WRITES, and reenters the
       26       26                           idle loop.
       27       27                                                                       */
       28       28        /*D* NAME:  OCK$KEYIN
       29       29             CALL: None -- main program
       30       30             INTERFACE:  OCP$ADDSTATION, OCP$DOLIST, OCE$ EVENT, OCW$WRITE
       31       31             DESCRIPTION:  Event control is taken with OCE$EVENT
       32       32                           specified as the event-processing routine.
       33       33                           The Operator's Console COMGROUP (OCCG) is
       34       34                           opened and any consoles which are already
       35       35                           connected are added to the list of connected
       36       36                           consoles.
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:25   
       37       37                           The Central System COMGROUP (CSCG) is then opened,
       38       38                           and currently any connected stations are ignored.
       39       39                           When the message-template file (:OCMSG) exists,
       40       40                           both comgroups are read and the idle loop entered.
       41       41                           Upon wake-up due to a thirty-second expiration of
       42       42                           time, OCP$DOLIST is called to print any pending
       43       43                           TIMED WRITES and the idle loop is reentered
       44       44                                                                            */
       45       45                                                /**/
       46       46                                                /**/
       47       47        OCK$KEYIN: PROC MAIN;                   /* KEYIN main program */

     47  7 000000   000000 700200 xent  OCK$KEYIN    TSX0  ! X66_MAUTO
         7 000001   000014 000000                    ZERO    12,0

       48       48
       49       49                                           /* This assembly flag allows
       50       50                                                selective compilation for
       51       51                                                LADC test mode operations */
       52       52        %SET FORREAL='1'B;
       53       53
       54       54                                                /**/
       55       55                                                /**/
       56       56        %INCLUDE B_SEGIDS_C;
       57      595                                                /**/
       58      596    1   DCL LOCAL_TIME CHAR(11) UNAL STATIC;
       59      597    1   DCL LOCAL_DATE CHAR(8) UNAL STATIC;
       60      598    1   DCL UTS UBIN WORD ALIGNED STATIC SYMDEF;
       61      599    1   DCL NEW_UTS UBIN WORD ALIGNED STATIC SYMDEF;
       62      600    1   DCL OC_GOOSE_STA CHAR(8) SYMREF;
       63      601                                                /**/
       64      602                                                /**/
       65      603        %INCLUDE OCI_SUBS_C;
       66      701                                                /**/
       67      702        %INCLUDE OC_SUBS_C;
       68     1433                                                /**/
       69     1434        %INCLUDE CP_6;
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:26   
       70     1515        %INCLUDE OC_DAT_R;
       71     1676        %INCLUDE OC_SCODE_C;
       72     1701
       73     1702        %INCLUDE JG_GHOSTS_C;
       74     1792 S      %INCLUDE B$JIT_C;
       75     1793             %B$JIT0;
       76     1882             %A$JIT6X;
       77     1885        %INCLUDE XUD_UTS_M;
       78     1967
       79     1968        %XUD$UTS_ENTRIES;                       /* expand routine dcls */
       80     2000        %XUD_UTS_EQU;                           /* expand constant EQUates */
       81     2011
       82     2012
       83     2013    1   DCL B$JIT$ PTR SYMREF;
       84     2014
       85     2015                                                /**/
       86     2016             %FPT_SCREECH   (FPTN=OCK_SCREECH,
       87     2017                                 SCODE=OCK$SCODE);
       88     2031                                                /**/
       89     2032                                                /**/
       90     2033             %VLP_SCREECH (FPTN=OCK$SCODE,
       91     2034                                 STCLASS=STATIC SYMDEF,
       92     2035                                 FCG=OC,
       93     2036                                 MID=K,
       94     2037                                 MON='0'B,
       95     2038                                 CODE=999);
       96     2108                                                /**/
       97     2109                                                /**/
       98     2110                                                /**/
       99     2111             %FPT_GDS       (FPTN=GET_COMMON,
      100     2112                                 STCLASS=STATIC,
      101     2113                                 RESULTS=GET_COM_RESULTS,
      102     2114                                 SEGSIZE=999,
      103     2115                                 COMMON=YES );
      104     2131
      105     2132                  %FPT_GDS  (FPTN=FREE_XS,
      106     2133                                 STCLASS=STATIC,
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:27   
      107     2134                                 COMMON=YES,
      108     2135                                 RESULTS=GET_COM_RESULTS,
      109     2136                                 SEGSIZE=999);
      110     2152
      111     2153                                                /*
      112     2154                                                     Actual size to release
      113     2155                                                     is dynamically calculated
      114     2156                                                     and dumped in FPT */
      115     2157
      116     2158
      117     2159            %FPT_EVENT      (UENTRY=OCE$EVENT);
      118     2173                                                /**/
      119     2174             %FPT_OPEN      (FPTN=OC_OPEN,
      120     2175                                   DCB=M$OCCG,
      121     2176                                   ASN=COMGROUP,
      122     2177                                   SETSTA=KSST,
      123     2178                                   FUN=CREATE,
      124     2179                                   EXIST=NEWFILE,
      125     2180                                   CTG=YES,
      126     2181                                   SHARE=ALL,
      127     2182                                   AU=YES,
      128     2183                                 ACCT=TACCT,
      129     2184                                   IXTNSIZE=100,
      130     2185                                   NAME=OCCGNM);
      131     2294             %VLP_NAME      (FPTN=OCCGNM,
      132     2295                                  NAME='OCCG');
      133     2322              %VLP_SETSTA      (FPTN=KSST,
      134     2323                                STCLASS=CONSTANT,
      135     2324                                MYSTATION='KEYIN');
      136     2352             %FPT_OPEN      (FPTN=CS_OPEN,
      137     2353                                 DCB=M$CSCG,
      138     2354                                 ASN=COMGROUP,
      139     2355                                 SETSTA=KSST,
      140     2356                                 FUN=UPDATE,
      141     2357                                 SHARE=ALL,
      142     2358                                 AU=YES,
      143     2359                            IXTNSIZE=200,
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:28   
      144     2360                                 ACCT=TACCT,
      145     2361                                 NAME=CSCGNM );
      146     2470                  %VLP_NAME (FPTN=CSCGNM,
      147     2471                                 NAME='CSCG');
      148     2498                                                /**/
      149     2499             %FPT_CGCTL     (FPTN=OC_CGCTL,
      150     2500                                 DCB=M$OCCG,
      151     2501                                 CGCP=VLP_CGCP,
      152     2502                                 STCLASS=CONSTANT);
      153     2525                                                /**/
      154     2526             %VLP_CGCP      (FPTN=VLP_CGCP,
      155     2527                                 MINPG=2,
      156     2528                                 TERMCONAU=YES,
      157     2529                                 TERMCONNAU=NO,
      158     2530                                 AUCONTERM=ACTIVATE,
      159     2531                                 AUDCONTERM=DEACTIVATE,
      160     2532                                 WAS=NO,
      161     2533                                 RAS=NO,
      162     2534                                 SMD=NO,
      163     2535                                 MAXMC=200,
      164     2536                            MAXPG=50,
      165     2537                            MEMWARN=25,
      166     2538                            DISKWARN=25,
      167     2539                            DATAPGS=10,
      168     2540                                 TRMRDSIZ=140,
      169     2541                                 DCBCONLGL=NO,
      170     2542                                 TERMCONLGL=YES,
      171     2543                                 SECURE=NO,
      172     2544                                 XSTALGL=YES,
      173     2545                                 XTYPLGL=YES);
      174     2588                                                /**/
      175     2589             %FPT_OPEN      (FPTN=MSGF_OPEN,
      176     2590                                 DCB=F$TEMPLATE,
      177     2591                                 ASN=FILE,
      178     2592                                 NAME=MNAME,
      179     2593                                 ACCT=TACCT,
      180     2594                                 ORG=KEYED,
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:29   
      181     2595                                 ACS=DIRECT,
      182     2596                                 FUN=IN,
      183     2597                                 DISP=NAMED,
      184     2598                                 SHARE=ALL,
      185     2599                                 SETDCB=NO);
      186     2708             %VLP_NAME      (FPTN=MNAME,
      187     2709                                 NAME=':OCMSG');
      188     2736             %VLP_ACCT      (FPTN=TACCT,
      189     2737                                 ACCT=':SYS');
      190     2750                                                /**/
      191     2751             %FPT_OPEN      (FPTN=KEYF_OPEN,
      192     2752                                 DCB=F$KEYIN,
      193     2753                                 ASN=FILE,
      194     2754                                 NAME=KNAME,
      195     2755                                 ACCT=TACCT,
      196     2756                                 ORG=KEYED,
      197     2757                                 ACS=SEQUEN,
      198     2758                                 FUN=IN,
      199     2759                                 DISP=NAMED,
      200     2760                                 SHARE=ALL,
      201     2761                                 SETDCB=YES );
      202     2870                  %VLP_NAME (FPTN=KNAME,
      203     2871                                 NAME=':OCKEY');
      204     2898                                                /**/
      205     2899             %FPT_READ      (FPTN=OC_READ,
      206     2900                                 DCB=M$OCCG,
      207     2901                                 WAIT=NO,
      208     2902                                 EVENT=OC_RDDN_O,
      209     2903                                 BUF=OC_KEYINBUF);
      210     2942                                                /**/
      211     2943             %FPT_READ      (FPTN=CS_READ,
      212     2944                                 DCB=M$CSCG,
      213     2945                                 WAIT=NO,
      214     2946                                 EVENT=OC_RDDN_C,
      215     2947                                 BUF=OC_MSGBUFFER);
      216     2986                                                /**/
      217     2987             %FPT_READ      (FPTN=KEYF_READ,
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:30   
      218     2988                                 DCB=F$KEYIN,
      219     2989                                 WAIT=YES,
      220     2990                                 KEYS=NO );
      221     3029                                                /**/
      222     3030             %FPT_CLOSE     (FPTN=KEYF_CLOSE,
      223     3031                                 DCB=F$KEYIN,
      224     3032                                 DISP=SAVE );
      225     3074                                                /**/
      226     3075             %FPT_LINK      (FPTN=LINK_2_PARTRGE,
      227     3076                                 NAME=PARTRGE,
      228     3077                                 ACCT=PARTACC);
      229     3095                                                /**/
      230     3096                  %VLP_NAME (FPTN=PARTRGE,
      231     3097                                 NAME='PARTRGE');
      232     3124                                                /**/
      233     3125                  %VLP_ACCT (FPTN=PARTACC,
      234     3126                                 ACCT=':SYS    ');
      235     3139                                                /**/
      236     3140             %FPT_WAIT      (FPTN=WAIT_20SECS,
      237     3141                                 UNITS=20);
      238     3155                                                /**/
      239     3156             %FPT_WAIT      (FPTN=MAIN_WAIT,
      240     3157                                 UNITS=NUM_SECS#,
      241     3158                                 UETIME=OC_REMAIN );
      242     3172                                                /**/
      243     3173             %FPT_WAIT      (FPTN=FIVE_SECOND,
      244     3174                                 UNITS=5);
      245     3188                                                /**/
      246     3189             %FPT_XCON      (FPTN=GET_XCON,
      247     3190                                 UENTRY=OCK$XCON);
      248     3204                                                /**/
      249     3205                                                /**/
      250     3206             %FPT_TIME      (FPTN=GET_UTS,
      251     3207                                 SOURCE=CLOCK,
      252     3208                                 DEST=UTS,
      253     3209                                 TSTAMP=NEW_UTS);
      254     3228             %FPT_GDS       (FPTN=GET_CONS_SEG,
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:31   
      255     3229                                 FREE=YES,
      256     3230                                 RESULTS=CONS_SEG,
      257     3231                                 SEGSIZE="SIZEW(OC_CONSOLE(0))");
      258     3247
      259     3248                  %VLP_VECTOR(FPTN=CONS_SEG,
      260     3249                                 SEGID=%DS5SID);
      261     3264
      262     3265             %FPT_PRIV      (FPTN=RESET_FMSEC,
      263     3266                                 PRIV="%(%PR_FMSEC#|%PR_FMREAD#)");
      264     3281
      265     3282
      266     3283                                                /**/
      267     3284                                                /**/
      268     3285                                                /**/
      269     3286             %F$DCB;
      270     3343                                                /**/
      271     3344    1   DCL OCP$ADDSTA ENTRY(1);
      272     3345    1   DCL OCE$EVENT           ENTRY ASYNC;
      273     3346    1   DCL OCE$MAKEDO ENTRY(2);
      274     3347    1   DCL OCE$PEVENT ENTRY;
      275     3348    1   DCL OCL$STATUS ENTRY(1);
      276     3349    1   DCL OCW$WRITE ENTRY(5);
      277     3350    1   DCL OCL$INIT ENTRY(1);
      278     3351    1   DCL OCP$INITCONSOLE ENTRY(1);
      279     3352                                                /**/
      280     3353    1   DCL OCK$XCON ENTRY ASYNC;
      281     3354                                                /**/
      282     3355    1   DCL  I              UBIN WORD;
      283     3356    1   DCL  J              UBIN WORD;
      284     3357    1   DCL K SBIN WORD STATIC;
      285     3358    1   DCL L SBIN WORD STATIC;
      286     3359    1   DCL  TRIES          UBIN WORD;
      287     3360    1   DCL  GET_COM_RESULTS     DALIGNED STATIC BIT(72);
      288     3361    1   DCL NO_STATION CHAR(8) STATIC INIT (' ');
      289     3362    1   DCL  NO_OPENM       CHAR(0)   STATIC    INIT
      290     3363    1             (' KEYIN trying to start: Can''t open :OCMSG template file');
      291     3364    1   DCL  NO_OPENK       CHAR(0)   STATIC    INIT
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:32   
      292     3365    1             (' KEYIN trying to start: Can''t open :OCKEY.:SYS');
      293     3366    1   DCL  NO_MEMK CHAR(0) STATIC INIT
      294     3367    1         (' KEYIN aborting: Can''t get COMMON pages for input templates');
      295     3368    1   DCL NO_READK CHAR(0) STATIC INIT
      296     3369    1             (' KEYIN aborting: Unable to read :OCKEY.:SYS file');
      297     3370                                                /**/
      298     3371    1   DCL  M$OCCG    DCB;
      299     3372    1   DCL  M$CSCG    DCB;
      300     3373    1   DCL  F$TEMPLATE     DCB;
      301     3374    1   DCL  F$KEYIN        DCB;
      302     3375                                                /**/
      303     3376    1   DCL  F$KEYIN$ PTR STATIC;
      304     3377                                                /**/
      305     3378        /*
      306     3379                  Begin Main
      307     3380                                                                          */
      308     3381
      309     3382        %IF FORREAL;
      310     3383
      311     3384    1        IF B$JIT$ -> B$JIT.SYSID ~= 02/*JG_KEYIN#   */

   3384  7 000002   000000 470400 xsym               LDP0    B$JIT$
         7 000003   000000 720100                    LXL0    0,,PR0
         7 000004   000002 100003                    CMPX0   2,DU
         7 000005   000010 600000 7                  TZE     s:3392

      312     3385    1        THEN
      313     3386    1             CALL M$EXIT;

   3386  7 000006   000001 713400                    CLIMB   exit
         7 000007   000000 401760                    pmme    nvectors=0

      314     3387
      315     3388        %ENDIF;
      316     3389
      317     3390                                           /*  Initialize KEYIN's
      318     3391                                                internal queues  */
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:33   
      319     3392    1        OC_QDEPTH = 0;

   3392  7 000010   000000 450000 xsym               STZ     OC_QDEPTH

      320     3393    1        OC_QPOSN = 0;

   3393  7 000011   000000 450000 xsym               STZ     OC_QPOSN

      321     3394    1        OC_QHEAD = 0;

   3394  7 000012   000000 450000 xsym               STZ     OC_QHEAD

      322     3395                                                /* Make DCB pointers */
      323     3396    1        M$OCCG$ = DCBADDR (DCBNUM (M$OCCG));

   3396  7 000013   000000 236007 xsym               LDQ     M$OCCG,DL
         7 000014   000000 470400 8                  LDP0    0
         7 000015   000000 471500                    LDP1    0,,PR0
         7 000016   100000 236106                    LDQ     0,QL,PR1
         7 000017   000000 756000 xsym               STQ     M$OCCG$

      324     3397    1        M$CSCG$ = DCBADDR (DCBNUM (M$CSCG));

   3397  7 000020   000000 236007 xsym               LDQ     M$CSCG,DL
         7 000021   100000 236106                    LDQ     0,QL,PR1
         7 000022   000000 756000 xsym               STQ     M$CSCG$

      325     3398    1        F$KEYIN$ = DCBADDR (DCBNUM (F$KEYIN));

   3398  7 000023   000000 236007 xsym               LDQ     F$KEYIN,DL
         7 000024   100000 236106                    LDQ     0,QL,PR1
         7 000025   000755 756000 0                  STQ     F$KEYIN$

      326     3399    1        CALL M$GDS(GET_CONS_SEG) ALTRET(OCK$SCREECH8);

   3399  7 000026   000646 630400 0                  EPPR0   GET_CONS_SEG
         7 000027   430001 713400                    CLIMB   alt,gds
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:34   
         7 000030   400400 401760                    pmme    nvectors=2
         7 000031   000356 702000 7                  TSX2    OCK$SCREECH8

      327     3400    1        OC_CONSOLE$ = CONS_SEG.PTR$;

   3400  7 000032   000655 236000 0                  LDQ     CONS_SEG+1
         7 000033   000000 756000 xsym               STQ     OC_CONSOLE$

      328     3401    1        OC_MAXCONSOLE = 0;                 /* SET MAX CONSOLE NUMBER */

   3401  7 000034   000000 220003                    LDX0    0,DU
         7 000035   000000 740000 xsym               STX0    OC_MAXCONSOLE

      329     3402    1        CALL OCP$INITCONSOLE (0);

   3402  7 000036   000001 630400 8                  EPPR0   1
         7 000037   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 000040   000000 701000 xent               TSX1    OCP$INITCONSOLE
         7 000041   000000 011000                    NOP     0

      330     3403                                                /* SET UP INDEX 0 FOR KEYIN USE */
      331     3404                                                /**/
      332     3405                                           /* The following assignments are those
      333     3406                                                of a "pseudo console" which
      334     3407                                                will allow ghosts to communicate
      335     3408                                                with keyin. Console 0 (zero) is
      336     3409                                                not the first console to logon. */
      337     3410                                                /**/
      338     3411    1        OC_CONSOLE.STATION(0) = OC_GOOSE_STA;

   3411  7 000042   000000 470400 xsym               LDP0    OC_CONSOLE$
         7 000043   040100 100400                    MLR     fill='040'O
         7 000044   000000 000010 xsym               ADSC9   OC_GOOSE_STA             cn=0,n=8
         7 000045   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8

      339     3412    1        OC_CONSOLE.TERM_NAME(0) = 'LOCAL';

PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:35   
   3412  7 000046   000000 470400 xsym               LDP0    OC_CONSOLE$
         7 000047   040100 100400                    MLR     fill='040'O
         7 000050   000100 000005 2                  ADSC9   OC_CGCTL+52              cn=0,n=5
         7 000051   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8

      340     3413    1        OC_CONSOLE.WSN(0) = '? ';

   3413  7 000052   040100 100400                    MLR     fill='040'O
         7 000053   000102 000002 2                  ADSC9   OC_CGCTL+54              cn=0,n=2
         7 000054   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8

      341     3414    1        OC_CONSOLE.LOGON(0) = 'GOOSE   ';

   3414  7 000055   040100 100400                    MLR     fill='040'O
         7 000056   000103 000010 2                  ADSC9   OC_CGCTL+55              cn=0,n=8
         7 000057   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8

      342     3415    1        OC_CONSOLE.CID_O(0) = OC_INTBIT;

   3415  7 000060   000000 220000 xsym               LDX0    OC_INTBIT
         7 000061   000012 740100                    STX0    10,,PR0

      343     3416    1        OC_CONSOLE.SYSID (0) = 0;

   3416  7 000062   000000 221003                    LDX1    0,DU
         7 000063   000012 441100                    SXL1    10,,PR0

      344     3417    1        OC_CONSOLE.ATTR_INPUT(0) = '000400'O /* M_GOOSE */;

   3417  7 000064   000400 222003                    LDX2    256,DU
         7 000065   000013 742100                    STX2    11,,PR0

      345     3418    1        OC_CONSOLE.ATTR_INPUT_SAVE(0) = '000400'O /* M_GOOSE */;

   3418  7 000066   000013 442100                    SXL2    11,,PR0

      346     3419    1        OC_CONSOLE.ATTR_OUTPUT_SAVE(0) = '200000'O /* M_SYS  */;
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:36   

   3419  7 000067   200000 223003                    LDX3    65536,DU
         7 000070   000014 443100                    SXL3    12,,PR0

      347     3420    1        OC_CONSOLE.ATTR_OUTPUT(0) = '200000'O /* M_SYS  */;

   3420  7 000071   000014 743100                    STX3    12,,PR0

      348     3421    1        OC_CONSOLE.ACTIVE(0) = '1'B /*TRUE#*/;

   3421  7 000072   010000 236007                    LDQ     4096,DL
         7 000073   000017 256100                    ORSQ    15,,PR0

      349     3422    1        OC_CONSOLE.MXPRIO(0) = 99;

   3422  7 000074   143000 236003                    LDQ     50688,DU
         7 000075   000075 756100                    STQ     61,,PR0

      350     3423    1        OC_CONSOLE.FLAGS.INPT(0) = '1'B /*TRUE#*/;

   3423  7 000076   400000 236003                    LDQ     -131072,DU
         7 000077   000017 256100                    ORSQ    15,,PR0

      351     3424    1        OC_CONSOLE.FLAGS.OUTP(0) = '0'B /*FALSE#*/;

   3424  7 000100   000002 236000 8                  LDQ     2
         7 000101   000017 356100                    ANSQ    15,,PR0

      352     3425                                                /* Set event entry point */
      353     3426    1        CALL M$EVENT (FPT_EVENT) ALTRET (OCK$SCREECH7);

   3426  7 000102   000034 630400 0                  EPPR0   FPT_EVENT
         7 000103   410001 713400                    CLIMB   alt,+4097
         7 000104   400000 401760                    pmme    nvectors=1
         7 000105   000351 702000 7                  TSX2    OCK$SCREECH7

      354     3427                                           /* Open OC ComGroup (If KEYIN cannot
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:37   
      355     3428                                              open OCCG, something is very
      356     3429                                              wrong.) */
      357     3430    1        CALL M$OPEN (OC_OPEN) ALTRET (OCK$SCREECH4);

   3430  7 000106   000040 630400 0                  EPPR0   OC_OPEN
         7 000107   450000 713400                    CLIMB   alt,open
         7 000110   410400 401760                    pmme    nvectors=18
         7 000111   000337 702000 7                  TSX2    OCK$SCREECH4

      358     3431                                                /**/
      359     3432    1        CALL M$CGCTL (OC_CGCTL) ALTRET(OCK$SCREECH4);

   3432  7 000112   000014 630400 2                  EPPR0   OC_CGCTL
         7 000113   500003 713400                    CLIMB   alt,+32771
         7 000114   411400 401760                    pmme    nvectors=20
         7 000115   000337 702000 7                  TSX2    OCK$SCREECH4

      360     3433                                                /**/
      361     3434                                                /**/
      362     3435                                           /* Get Exit Control  (Upon any
      363     3436                                                Exit condition, KEYIN will
      364     3437                                                screech) */
      365     3438    1        CALL M$XCON (GET_XCON);

   3438  7 000116   000624 630400 0                  EPPR0   GET_XCON
         7 000117   010003 713400                    CLIMB   4099
         7 000120   400400 401760                    pmme    nvectors=2

      366     3439                                                /**/
      367     3440                                           /* Open the Central System ComGroup.
      368     3441                                              as with OCCG, an ALTRET means
      369     3442                                              real trouble */
      370     3443    1        CALL M$OPEN (CS_OPEN) ALTRET (OCK$SCREECH3);

   3443  7 000121   000134 630400 0                  EPPR0   CS_OPEN
         7 000122   450000 713400                    CLIMB   alt,open
         7 000123   410400 401760                    pmme    nvectors=18
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:38   
         7 000124   000332 702000 7                  TSX2    OCK$SCREECH3

      371     3444                                                /**/
      372     3445                                           /* Open the template files here.
      373     3446                                                The output template file,
      374     3447                                                :OCMSG, is kept open, as KEYIN
      375     3448                                                reads the file whenever it
      376     3449                                                needs an output template.  The
      377     3450                                                key-in templates are an in-core
      378     3451                                                image of PARSENODER output, and
      379     3452                                                are read into a set of COMMON
      380     3453                                                pages, and once read in, the
      381     3454                                                file is closed. */
      382     3455    1        CALL OPEN$MSG ALTRET (WHO_CARES1);

   3455  7 000125   000367 701000 7                  TSX1    OPEN$MSG
         7 000126   000127 702000 7                  TSX2    WHO_CARES1

   3455  7 000127                       WHO_CARES1   null
      383     3456    1   WHO_CARES1: ;
      384     3457                                           /* Open the :OCKEY file, examine the
      385     3458                                                FPARAMs and put the PARTRGE
      386     3459                                                core-image into COMMON data */
      387     3460    1        CALL OPEN$KEY ALTRET (WHO_CARES2);

   3460  7 000127   000421 701000 7                  TSX1    OPEN$KEY
         7 000130   000131 702000 7                  TSX2    WHO_CARES2

   3455  7 000131                       WHO_CARES2   null
      388     3461    1   WHO_CARES2: ;
      389     3462    1        OC_FIRST_CONSOLE = '1'B;           /* Indicate that first console

   3462  7 000131   400000 236003                    LDQ     -131072,DU
         7 000132   000000 756000 xsym               STQ     OC_FIRST_CONSOLE

      390     3463                                                     has yet to logon */
      391     3464                                                /**/
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:39   
      392     3465                                                /**/
      393     3466    1        CALL M$TIME (GET_UTS);

   3466  7 000133   000632 630400 0                  EPPR0   GET_UTS
         7 000134   020004 713400                    CLIMB   8196
         7 000135   402000 401760                    pmme    nvectors=5

      394     3467                                                /**/
      395     3468    1        CALL XUD$UTS_DIFF_SEC (K, NEW_UTS, 0); /* get time in secs */

   3468  7 000136   000003 630400 8                  EPPR0   3
         7 000137   000021 631400 xsym               EPPR1   B_VECTNIL+17
         7 000140   000000 701000 xent               TSX1    XUD$UTS_DIFF_SEC
         7 000141   000000 011000                    NOP     0

      396     3469    1        OC_REMAIN = MOD (K, 60);           /* secs into this minute */

   3469  7 000142   000662 236000 0                  LDQ     K
         7 000143   000074 506007                    DIV     60,DL
         7 000144   000000 755000 xsym               STA     OC_REMAIN

      397     3470                                                /**/
      398     3471    1        IF OC_REMAIN < 5

   3471  7 000145   000005 115007                    CMPA    5,DL
         7 000146   000151 603000 7                  TRC     s:3474

      399     3472    1        THEN
      400     3473    1             OC_REMAIN = OC_REMAIN + 60;

   3473  7 000147   000074 035007                    ADLA    60,DL
         7 000150   000000 755000 xsym               STA     OC_REMAIN

      401     3474    1        OC_REMAIN = 65 - OC_REMAIN;

   3474  7 000151   000027 675000 xsym               ERA     B_VECTNIL+23
         7 000152   000102 035007                    ADLA    66,DL
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:40   
         7 000153   000000 755000 xsym               STA     OC_REMAIN

      402     3475    1        CALL XUD$UTS_ADJUST (UTS, NEW_UTS, OC_REMAIN * %UTS_CSEC_SEC#);
              3475                 /* add OC_REMAIN seconds */

   3475  7 000154   000000 236000 xsym               LDQ     OC_REMAIN
         7 000155   000144 402007                    MPY     100,DL
         7 000156   200010 756100                    STQ     TRIES+3,,AUTO
         7 000157   200010 630500                    EPPR0   TRIES+3,,AUTO
         7 000160   200013 450500                    STP0    TRIES+6,,AUTO
         7 000161   000004 236000 8                  LDQ     4
         7 000162   200012 756100                    STQ     TRIES+5,,AUTO
         7 000163   000006 236000 8                  LDQ     6
         7 000164   200011 756100                    STQ     TRIES+4,,AUTO
         7 000165   200011 630500                    EPPR0   TRIES+4,,AUTO
         7 000166   000021 631400 xsym               EPPR1   B_VECTNIL+17
         7 000167   000000 701000 xent               TSX1    XUD$UTS_ADJUST
         7 000170   000000 011000                    NOP     0

      403     3476                                                /**/
      404     3477    1        MAIN_WAIT.V.UNITS# = OC_REMAIN;

   3477  7 000171   000000 235000 xsym               LDA     OC_REMAIN
         7 000172   000614 755000 0                  STA     MAIN_WAIT+4

      405     3478                                                /**/
      406     3479    1        OC_NEXT_PEND = OC_NEXT_PENDX -

   3479  7 000173   000662 236000 0                  LDQ     K
         7 000174   000074 506007                    DIV     60,DL
         7 000175   000074 506007                    DIV     60,DL
         7 000176   200010 755100                    STA     TRIES+3,,AUTO
         7 000177   000000 236000 xsym               LDQ     OC_NEXT_PENDX
         7 000200   200010 136100                    SBLQ    TRIES+3,,AUTO
         7 000201   000000 756000 xsym               STQ     OC_NEXT_PEND

      407     3480    1             MOD (K/60, 60);               /* minutes into this hour */
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:41   
      408     3481                                                /**/
      409     3482                                                /**/
      410     3483    1        CALL M$RPRIV (RESET_FMSEC) ALTRET (O_NO);

   3483  7 000202   000656 630400 0                  EPPR0   RESET_FMSEC
         7 000203   420013 713400                    CLIMB   alt,+8203
         7 000204   400000 401760                    pmme    nvectors=1
         7 000205   000206 702000 7                  TSX2    O_NO

   3479  7 000206                       O_NO         null
      411     3484    1   O_NO: ;
      412     3485
      413     3486                                           /* Read the ComGroups...
      414     3487                                                if there are events outstanding
      415     3488                                                they will be processed and we
      416     3489                                                will fall into wait loop...
      417     3490                                                if none, just wait for one */
      418     3491    1        CALL M$READ (OC_READ) ALTRET (OCK$SCREECH5);

   3491  7 000206   000446 630400 0                  EPPR0   OC_READ
         7 000207   440000 713400                    CLIMB   alt,read
         7 000210   401400 401760                    pmme    nvectors=4
         7 000211   000344 702000 7                  TSX2    OCK$SCREECH5

      419     3492        %EJECT;
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:42   
      420     3493                                           /*
      421     3494             MAIN WAIT LOOP
      422     3495                                           */
      423     3496    2        DO WHILE ('1'B)  /* FOREVER */;

      424     3497                                                /**/
      425     3498
      426     3499    3             DO INHIBIT;                   /* ENTIRE LOOP IS INHIBITED */

      427     3500
      428     3501    4                  DO WHILE (OC_QDEPTH ~= 0);

   3501  7 000212   000000 235200 xsym               LDA   ! OC_QDEPTH
         7 000213   000241 600200 7                  TZE   ! s:3520

      429     3502                                                /**/
      430     3503    4                       CALL OCE$PEVENT;    /* Process the events */

   3503  7 000214   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         7 000215   000000 701200 xent               TSX1  ! OCE$PEVENT
         7 000216   000000 011200                    NOP   ! 0

      431     3504                                                /**/
      432     3505                                                /**/
      433     3506    4                       CALL M$TIME (GET_UTS);

   3506  7 000217   000632 630600 0                  EPPR0 ! GET_UTS
         7 000220   020004 713600                    CLIMB ! 8196
         7 000221   402000 401760                    pmme    nvectors=5

      434     3507                                                /**/
      435     3508    4                       IF NEW_UTS > UTS    /* past old UTS? */

   3508  7 000222   000005 236200 0                  LDQ   ! UTS
         7 000223   000006 116200 0                  CMPQ  ! NEW_UTS
         7 000224   000227 603200 7                  TRC   ! s:3512

PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:43   
      436     3509    4                       THEN
      437     3510    4                            MAIN_WAIT.V.UNITS# = 0;

   3510  7 000225   000614 450200 0                  STZ   ! MAIN_WAIT+4
         7 000226   000233 710200 7                  TRA   ! s:3514

      438     3511    4                       ELSE
      439     3512    4                            CALL XUD$UTS_DIFF_SEC (MAIN_WAIT.V.UNITS#,

   3512  7 000227   000007 630600 8                  EPPR0 ! 7
         7 000230   000021 631600 xsym               EPPR1 ! B_VECTNIL+17
         7 000231   000000 701200 xent               TSX1  ! XUD$UTS_DIFF_SEC
         7 000232   000000 011200                    NOP   ! 0

      440     3513    4                                 UTS, NEW_UTS);
      441     3514    4                       IF MAIN_WAIT.V.UNITS# > 61

   3514  7 000233   000614 235200 0                  LDA   ! MAIN_WAIT+4
         7 000234   000076 115207                    CMPA  ! 62,DL
         7 000235   000237 602200 7                  TNC   ! s:3517

      442     3515    4                       THEN
      443     3516    4                            MAIN_WAIT.V.UNITS# = 0;

   3516  7 000236   000614 450200 0                  STZ   ! MAIN_WAIT+4

      444     3517    4                     END;                  /* DO WHILE MORE TO DO */

   3517  7 000237   000000 235200 xsym               LDA   ! OC_QDEPTH
         7 000240   000214 601200 7                  TNZ   ! s:3503

      445     3518                                                /**/
      446     3519
      447     3520    3                  OC_REMAIN = MAIN_WAIT.V.UNITS#;

   3520  7 000241   000614 236200 0                  LDQ   ! MAIN_WAIT+4
         7 000242   000000 756200 xsym               STQ   ! OC_REMAIN
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:44   

      448     3521
      449     3522    3                  IF OC_QDEPTH = 0

   3522  7 000243   000000 115203                    CMPA  ! 0,DU
         7 000244   000250 601200 7                  TNZ   ! s:3526

      450     3523    3                  THEN
      451     3524    3                       CALL M$WAIT (MAIN_WAIT);

   3524  7 000245   000610 630600 0                  EPPR0 ! MAIN_WAIT
         7 000246   020006 713600                    CLIMB ! 8198
         7 000247   400400 401760                    pmme    nvectors=2

      452     3525                                                /**/
      453     3526    3                  IF OC_REMAIN = 0

   3526  7 000250   000000 235200 xsym               LDA   ! OC_REMAIN
         7 000251   000327 601200 7                  TNZ   ! s:3543

      454     3527    3                  THEN
      455     3528    4                  DO;

      456     3529    4                       CALL OCE$MAKEDO(5 /* OC_DOLIST_C */,0);

   3529  7 000252   000012 630600 8                  EPPR0 ! 10
         7 000253   000020 631600 xsym               EPPR1 ! B_VECTNIL+16
         7 000254   000000 701200 xent               TSX1  ! OCE$MAKEDO
         7 000255   000000 011200                    NOP   ! 0

      457     3530    4                       CALL M$TIME (GET_UTS);

   3530  7 000256   000632 630600 0                  EPPR0 ! GET_UTS
         7 000257   020004 713600                    CLIMB ! 8196
         7 000260   402000 401760                    pmme    nvectors=5

      458     3531    4                       CALL XUD$UTS_DIFF_SEC (K, NEW_UTS, 0);
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:45   

   3531  7 000261   000003 630600 8                  EPPR0 ! 3
         7 000262   000021 631600 xsym               EPPR1 ! B_VECTNIL+17
         7 000263   000000 701200 xent               TSX1  ! XUD$UTS_DIFF_SEC
         7 000264   000000 011200                    NOP   ! 0

      459     3532    4                       OC_REMAIN = MOD (K, 60); /* secs into minute */

   3532  7 000265   000662 236200 0                  LDQ   ! K
         7 000266   000074 506207                    DIV   ! 60,DL
         7 000267   000000 755200 xsym               STA   ! OC_REMAIN

      460     3533    4                       IF OC_REMAIN < 5

   3533  7 000270   000005 115207                    CMPA  ! 5,DL
         7 000271   000274 603200 7                  TRC   ! s:3536

      461     3534    4                       THEN
      462     3535    4                            OC_REMAIN = OC_REMAIN + 60;

   3535  7 000272   000074 035207                    ADLA  ! 60,DL
         7 000273   000000 755200 xsym               STA   ! OC_REMAIN

      463     3536    4                       OC_REMAIN = 65 - OC_REMAIN;

   3536  7 000274   000027 675200 xsym               ERA   ! B_VECTNIL+23
         7 000275   000102 035207                    ADLA  ! 66,DL
         7 000276   000000 755200 xsym               STA   ! OC_REMAIN

      464     3537                                                /**/
      465     3538    4                       CALL XUD$UTS_ADJUST (UTS, NEW_UTS, OC_REMAIN * %UTS_CSEC_SEC#);

   3538  7 000277   000000 236200 xsym               LDQ   ! OC_REMAIN
         7 000300   000144 402207                    MPY   ! 100,DL
         7 000301   200010 756300                    STQ   ! TRIES+3,,AUTO
         7 000302   200010 630700                    EPPR0 ! TRIES+3,,AUTO
         7 000303   200013 450700                    STP0  ! TRIES+6,,AUTO
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:46   
         7 000304   000004 236200 8                  LDQ   ! 4
         7 000305   200012 756300                    STQ   ! TRIES+5,,AUTO
         7 000306   000006 236200 8                  LDQ   ! 6
         7 000307   200011 756300                    STQ   ! TRIES+4,,AUTO
         7 000310   200011 630700                    EPPR0 ! TRIES+4,,AUTO
         7 000311   000021 631600 xsym               EPPR1 ! B_VECTNIL+17
         7 000312   000000 701200 xent               TSX1  ! XUD$UTS_ADJUST
         7 000313   000000 011200                    NOP   ! 0

      466     3539    4                       OC_NEXT_PEND = OC_NEXT_PENDX -

   3539  7 000314   000662 236200 0                  LDQ   ! K
         7 000315   000074 506207                    DIV   ! 60,DL
         7 000316   000000 235200 xsym               LDA   ! OC_NEXT_PENDX
         7 000317   000322 605200 7                  TPL   ! s:3539+6
         7 000320   000044 737200                    LLS   ! 36
         7 000321   000323 710200 7                  TRA   ! s:3539+7
         7 000322   000000 506200 xsym               DIV   ! OC_NEXT_PENDX
         7 000323   200010 755300                    STA   ! TRIES+3,,AUTO
         7 000324   000000 236200 xsym               LDQ   ! OC_NEXT_PENDX
         7 000325   200010 136300                    SBLQ  ! TRIES+3,,AUTO
         7 000326   000000 756200 xsym               STQ   ! OC_NEXT_PEND

      467     3540    4                            MOD (K/60, OC_NEXT_PENDX); /* min into next interval */
      468     3541    4                     END;                  /* DO IF EXPIRED */

      469     3542                                                /**/
      470     3543    3                  MAIN_WAIT.V.UNITS# = OC_REMAIN;

   3543  7 000327   000000 235200 xsym               LDA   ! OC_REMAIN
         7 000330   000614 755200 0                  STA   ! MAIN_WAIT+4

      471     3544                                                /**/
      472     3545    3                END;                       /* DO FOREVER */

      473     3546                                                /**/
      474     3547
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:47   
      475     3548    2           END;                            /* DO INHIBIT */

   3548  7 000331   000212 710000 7                  TRA     s:3501

      476     3549
      477     3550                                                /**/
      478     3551                                                /**/
      479     3552                  /*S*
      480     3553                            SCREECH_CODE: OCK-S$NOOPENCSCG
      481     3554                            TYPE: SCREECH
      482     3555                            MESSAGE: KEYIN failed to open CSCG
      483     3556                            REMARKS: KEYIN requires use of the Central System
      484     3557                                      ComGroup to perform its inter-task
      485     3558                                      communication.
      486     3559                                      console log */
      487     3560    1   OCK$SCREECH3:
      488     3561    1        OCK$SCODE.CODE# = %S$NOOPENCSCG;

   3561  7 000332   000016 236000 0     OCK$SCREECH3 LDQ     OCK$SCODE
         7 000333   000014 376000 8                  ANQ     12
         7 000334   004600 276007                    ORQ     2432,DL
         7 000335   000016 756000 0                  STQ     OCK$SCODE

      489     3562    1        GOTO OCK$SCREECH;

   3562  7 000336   000363 710000 7                  TRA     OCK$SCREECH

      490     3563                                                /**/
      491     3564                                                /**/
      492     3565                  /*S*
      493     3566                            SCREECH_CODE: OCK-S$NOOPENOCCG
      494     3567                            TYPE: SCREECH
      495     3568                                 MESSAGE: KEYIN failed to open OCCG
      496     3569                            REMARKS: If KEYIN cant open the ComGroup, no consoles
      497     3570                                      can be activated
      498     3571                                                                          */
      499     3572    1   OCK$SCREECH4:
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:48   
      500     3573    1        OCK$SCODE.CODE# = %S$NOOPENOCCG;

   3573  7 000337   000016 236000 0     OCK$SCREECH4 LDQ     OCK$SCODE
         7 000340   000014 376000 8                  ANQ     12
         7 000341   004610 276007                    ORQ     2440,DL
         7 000342   000016 756000 0                  STQ     OCK$SCODE

      501     3574    1        GOTO OCK$SCREECH;

   3574  7 000343   000363 710000 7                  TRA     OCK$SCREECH

      502     3575                       /*S*
      503     3576                            SCREECH_CODE: OCK-S$NOREADOCCG
      504     3577                            TYPE: SCREECH
      505     3578                            MESSAGE: KEYIN cannot read the OC ComGroup
      506     3579                            REMARKS:
      507     3580                                                                          */
      508     3581    1   OCK$SCREECH5:
      509     3582    1        OCK$SCODE.CODE# = %S$NOREADOCCG;

   3582  7 000344   000016 236000 0     OCK$SCREECH5 LDQ     OCK$SCODE
         7 000345   000014 376000 8                  ANQ     12
         7 000346   004620 276007                    ORQ     2448,DL
         7 000347   000016 756000 0                  STQ     OCK$SCODE

      510     3583    1        GOTO OCK$SCREECH;

   3583  7 000350   000363 710000 7                  TRA     OCK$SCREECH

      511     3584                       /*S*
      512     3585                            SCREECH_CODE: OCK-S$NOREADCSCG
      513     3586                            TYPE: SCREECH
      514     3587                            MESSAGE: KEYIN could not read the Central System
      515     3588                                      ComGroup
      516     3589                            REMARKS:
      517     3590                                                                          */
      518     3591        /*
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:49   
      519     3592        OCK$SCREECH6:
      520     3593             OCK$SCODE.CODE# = %S$NOREADCSCG;
      521     3594             GOTO OCK$SCREECH;
      522     3595        */
      523     3596                       /*S*
      524     3597                            SCREECH_CODE: OCK-S$OCCANTEVENT
      525     3598                            TYPE: SCREECH
      526     3599                            MESSAGE: KEYIN could not perform M$EVENT PMME
      527     3600                            REMARKS:
      528     3601                                                                          */
      529     3602    1   OCK$SCREECH7:
      530     3603    1        OCK$SCODE.CODE# = %S$OCCANTEVENT;

   3603  7 000351   000016 236000 0     OCK$SCREECH7 LDQ     OCK$SCODE
         7 000352   000014 376000 8                  ANQ     12
         7 000353   004640 276007                    ORQ     2464,DL
         7 000354   000016 756000 0                  STQ     OCK$SCODE

      531     3604    1        GOTO OCK$SCREECH;

   3604  7 000355   000363 710000 7                  TRA     OCK$SCREECH

      532     3605                       /*S*
      533     3606                            SCREECH_CODE: OCK-S$OCCANTGDS
      534     3607                            TYPE: SCREECH
      535     3608                            MESSAGE: KEYIN could not acquire memory to perform
      536     3609                                      internal table builds
      537     3610                            REMARKS:
      538     3611                                                                          */
      539     3612    1   OCK$SCREECH8:
      540     3613    1        OCK$SCODE.CODE# = %S$OCCANTGDS;

   3613  7 000356   000016 236000 0     OCK$SCREECH8 LDQ     OCK$SCODE
         7 000357   000014 376000 8                  ANQ     12
         7 000360   004650 276007                    ORQ     2472,DL
         7 000361   000016 756000 0                  STQ     OCK$SCODE

PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:50   
      541     3614    1        GOTO OCK$SCREECH;

   3614  7 000362   000363 710000 7                  TRA     OCK$SCREECH

      542     3615                                                /**/
      543     3616                                                /**/
      544     3617    1   OCK$SCREECH:
      545     3618    1        CALL M$SCREECH (OCK_SCREECH);

   3618  7 000363   000010 630400 0     OCK$SCREECH  EPPR0   OCK_SCREECH
         7 000364   000013 713400                    CLIMB   11
         7 000365   401000 401760                    pmme    nvectors=3
         7 000366   000550 710000 7                  TRA     s:3705

      546     3619        %EJECT;
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:51   
      547     3620                                                /**/
      548     3621                                           /* OPEN$MSG will attempt to
      549     3622                                                open the output template file.
      550     3623                                                If it cant be opened after
      551     3624                                                30 seconds, SCREECH */
      552     3625    1   OPEN$MSG: PROC ALTRET;

   3625  7 000367   200006 741300       OPEN$MSG     STX1  ! TRIES+1,,AUTO

      553     3626    2        OC_MSG_GOOD = '0'B /*FALSE#*/;

   3626  7 000370   000000 450000 xsym               STZ     OC_MSG_GOOD

      554     3627    3        DO TRIES = 1 TO 36 /* NUM_ATTEMPTS# */;

   3627  7 000371   000001 235007                    LDA     1,DL
         7 000372   200005 755100                    STA     TRIES,,AUTO

      555     3628    3             CALL M$OPEN (MSGF_OPEN) ALTRET (OPEN$MSG_ALT);

   3628  7 000373   000254 630400 0                  EPPR0   MSGF_OPEN
         7 000374   450000 713400                    CLIMB   alt,open
         7 000375   410400 401760                    pmme    nvectors=18
         7 000376   000403 702000 7                  TSX2    OPEN$MSG_ALT

      556     3629    3             OC_MSG_GOOD = '1'B /*TRUE#*/;

   3629  7 000377   400000 236003                    LDQ     -131072,DU
         7 000400   000000 756000 xsym               STQ     OC_MSG_GOOD

      557     3630    3             RETURN;

   3630  7 000401   200006 221300                    LDX1  ! TRIES+1,,AUTO
         7 000402   000001 702211                    TSX2  ! 1,X1

      558     3631    3   OPEN$MSG_ALT:
      559     3632    3             CALL M$WAIT(FIVE_SECOND);
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:52   

   3632  7 000403   000616 630400 0     OPEN$MSG_ALT EPPR0   FIVE_SECOND
         7 000404   020006 713400                    CLIMB   8198
         7 000405   400400 401760                    pmme    nvectors=2

      560     3633    3           END;

   3633  7 000406   200005 235100                    LDA     TRIES,,AUTO
         7 000407   000001 035007                    ADLA    1,DL
         7 000410   200005 755100                    STA     TRIES,,AUTO
         7 000411   000045 115007                    CMPA    37,DL
         7 000412   000373 602000 7                  TNC     s:3628

      561     3634    2        CALL OCW$WRITE (NO_OPENM, SIZEC(NO_OPENM),

   3634  7 000413   000017 630400 8                  EPPR0   15
         7 000414   000022 631400 xsym               EPPR1   B_VECTNIL+18
         7 000415   000000 701000 xent               TSX1    OCW$WRITE
         7 000416   000000 011000                    NOP     0

      562     3635    2             '020000'O /* M_DLTA  */, NO_STATION);
      563     3636    2        ALTRETURN;

   3636  7 000417   200006 221300                    LDX1  ! TRIES+1,,AUTO
         7 000420   000000 702211                    TSX2  ! 0,X1

      564     3637    2   END OPEN$MSG;
      565     3638                                                /**/
      566     3639        %EJECT;
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:53   
      567     3640                                                /**/
      568     3641                                           /* OPEN$KEY will open the input tem-
      569     3642                                                plate file (PARTRGE output) and
      570     3643                                                read the composed X$PARSE table
      571     3644                                                into a COMMON data segment */
      572     3645                                                /**/
      573     3646    1   OPEN$KEY: PROC ALTRET;

   3646  7 000421   200006 741300       OPEN$KEY     STX1  ! TRIES+1,,AUTO

      574     3647    2        OC_KEY_GOOD = '0'B /*FALSE#*/;

   3647  7 000422   000000 450000 xsym               STZ     OC_KEY_GOOD

      575     3648    3        DO TRIES = 1 TO 36 /* NUM_ATTEMPTS# */;

   3648  7 000423   000001 235007                    LDA     1,DL
         7 000424   200005 755100                    STA     TRIES,,AUTO

      576     3649    3             CALL M$OPEN (KEYF_OPEN) ALTRET (OPEN$KEY_ALT);

   3649  7 000425   000352 630400 0                  EPPR0   KEYF_OPEN
         7 000426   450000 713400                    CLIMB   alt,open
         7 000427   410400 401760                    pmme    nvectors=18
         7 000430   000504 702000 7                  TSX2    OPEN$KEY_ALT

      577     3650                                           /*
      578     3651                                                Upon successful open, check the
      579     3652                                                DCB for largest record length
      580     3653                                                and allocate a COMMON segment
      581     3654                                                that large */
      582     3655    3             GET_COMMON.V.SEGSIZE# =

   3655  7 000431   024000 220003                    LDX0    10240,DU
         7 000432   000024 440000 0                  SXL0    GET_COMMON+4

      583     3656    3                  10240;                   /* Start with 10K */
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:54   
      584     3657    3             CALL M$GDS (GET_COMMON) ALTRET (OPEN$KEY_MEM);

   3657  7 000433   000020 630400 0                  EPPR0   GET_COMMON
         7 000434   430001 713400                    CLIMB   alt,gds
         7 000435   400400 401760                    pmme    nvectors=2
         7 000436   000526 702000 7                  TSX2    OPEN$KEY_MEM

      585     3658                                           /*
      586     3659                                                Read the PARTRGE core-image into
      587     3660                                                the COMMON pages   */
      588     3661    3             KEYF_READ.BUF_ = GET_COM_RESULTS;

   3661  7 000437   000664 237000 0                  LDAQ    GET_COM_RESULTS
         7 000440   000506 757000 0                  STAQ    KEYF_READ+4

      589     3662    3             CALL M$READ (KEYF_READ) ALTRET (OPEN$KEY_READ);

   3662  7 000441   000502 630400 0                  EPPR0   KEYF_READ
         7 000442   440000 713400                    CLIMB   alt,read
         7 000443   401400 401760                    pmme    nvectors=4
         7 000444   000537 702000 7                  TSX2    OPEN$KEY_READ

      590     3663    3             CALL M$CLOSE (KEYF_CLOSE);

   3663  7 000445   000520 630400 0                  EPPR0   KEYF_CLOSE
         7 000446   050001 713400                    CLIMB   close
         7 000447   406000 401760                    pmme    nvectors=13

      591     3664    3             OC_KEY_GOOD = '1'B /*TRUE#*/;

   3664  7 000450   400000 236003                    LDQ     -131072,DU
         7 000451   000000 756000 xsym               STQ     OC_KEY_GOOD

      592     3665    3             J = (DCBADDR(DCBNUM(F$KEYIN)) -> F$DCB.ARS# + 3) / 4;

   3665  7 000452   000000 236007 xsym               LDQ     F$KEYIN,DL
         7 000453   000000 470400 8                  LDP0    0
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:55   
         7 000454   000000 471500                    LDP1    0,,PR0
         7 000455   100000 473506                    LDP3    0,QL,PR1
         7 000456   300000 236100                    LDQ     0,,PR3
         7 000457   000003 036007                    ADLQ    3,DL
         7 000460   000004 506007                    DIV     4,DL
         7 000461   200004 756100                    STQ     J,,AUTO

      593     3666    3             K = J / 1024;

   3666  7 000462   000012 772000                    QRL     10
         7 000463   000662 756000 0                  STQ     K

      594     3667    3             L = MOD (J, 1024);

   3667  7 000464   200004 236100                    LDQ     J,,AUTO
         7 000465   001777 376007                    ANQ     1023,DL
         7 000466   000663 756000 0                  STQ     L

      595     3668    3             IF L ~= 0

   3668  7 000467   000471 600000 7                  TZE     s:3672

      596     3669    3             THEN
      597     3670    3                  K = K + 1;

   3670  7 000470   000662 054000 0                  AOS     K

      598     3671
      599     3672    3             FREE_XS.V.SEGSIZE# = 10240 - (K * 1024);

   3672  7 000471   000662 235000 0                  LDA     K
         7 000472   000012 735000                    ALS     10
         7 000473   753777 620005                    EAX0    -10241,AL
         7 000474   777777 660003                    ERX0    -1,DU
         7 000475   000032 440000 0                  SXL0    FREE_XS+4

      600     3673
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:56   
      601     3674    3             CALL M$FDS (FREE_XS) ALTRET (OH_NO_NOT_AGAIN);

   3674  7 000476   000026 630400 0                  EPPR0   FREE_XS
         7 000477   430002 713400                    CLIMB   alt,fds
         7 000500   400400 401760                    pmme    nvectors=2
         7 000501   000502 702000 7                  TSX2    OH_NO_NOT_AGAIN

   3672  7 000502                       OH_NO_NOT_A* null
      602     3675
      603     3676    3   OH_NO_NOT_AGAIN: ;
      604     3677
      605     3678    3             RETURN;

   3678  7 000502   200006 221300                    LDX1  ! TRIES+1,,AUTO
         7 000503   000001 702211                    TSX2  ! 1,X1

      606     3679                                                /**/
      607     3680    3   OPEN$KEY_ALT:
      608     3681                                                /**/
      609     3682                                           /* IF NO KEYIN template file, M$LINK
      610     3683                                                to PARTRGE to ask him to build
      611     3684                                                it for me */
      612     3685    3             CALL M$LINK (LINK_2_PARTRGE) ALTRET (OPEN$KEY_READ);

   3685  7 000504   000556 630400 0     OPEN$KEY_ALT EPPR0   LINK_2_PARTRGE
         7 000505   400005 713400                    CLIMB   alt,+5
         7 000506   403000 401760                    pmme    nvectors=7
         7 000507   000537 702000 7                  TSX2    OPEN$KEY_READ

      613     3686                                                /**/
      614     3687    3             CALL M$WAIT (FIVE_SECOND);

   3687  7 000510   000616 630400 0                  EPPR0   FIVE_SECOND
         7 000511   020006 713400                    CLIMB   8198
         7 000512   400400 401760                    pmme    nvectors=2

      615     3688    3           END;
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:57   

   3688  7 000513   200005 235100                    LDA     TRIES,,AUTO
         7 000514   000001 035007                    ADLA    1,DL
         7 000515   200005 755100                    STA     TRIES,,AUTO
         7 000516   000045 115007                    CMPA    37,DL
         7 000517   000425 602000 7                  TNC     s:3649

      616     3689    2        CALL OCW$WRITE (NO_OPENK, SIZEC(NO_OPENK),

   3689  7 000520   000024 630400 8                  EPPR0   20
         7 000521   000022 631400 xsym               EPPR1   B_VECTNIL+18
         7 000522   000000 701000 xent               TSX1    OCW$WRITE
         7 000523   000000 011000                    NOP     0

      617     3690    2             '020000'O /* M_DLTA  */, NO_STATION);
      618     3691    2        ALTRETURN;

   3691  7 000524   200006 221300                    LDX1  ! TRIES+1,,AUTO
         7 000525   000000 702211                    TSX2  ! 0,X1

      619     3692                                                /**/
      620     3693    2   OPEN$KEY_MEM:
      621     3694    2        CALL OCW$WRITE (NO_MEMK, SIZEC(NO_MEMK),

   3694  7 000526   000031 630400 8     OPEN$KEY_MEM EPPR0   25
         7 000527   000022 631400 xsym               EPPR1   B_VECTNIL+18
         7 000530   000000 701000 xent               TSX1    OCW$WRITE
         7 000531   000000 011000                    NOP     0

      622     3695    2             '020000'O /* M_DLTA  */, NO_STATION);
      623     3696    2        CALL M$WAIT (WAIT_20SECS);

   3696  7 000532   000602 630400 0                  EPPR0   WAIT_20SECS
         7 000533   020006 713400                    CLIMB   8198
         7 000534   400400 401760                    pmme    nvectors=2

      624     3697    2        ALTRETURN;
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:58   

   3697  7 000535   200006 221300                    LDX1  ! TRIES+1,,AUTO
         7 000536   000000 702211                    TSX2  ! 0,X1

      625     3698                                                /**/
      626     3699    2   OPEN$KEY_READ:
      627     3700    2        CALL OCW$WRITE (NO_READK, SIZEC(NO_READK),

   3700  7 000537   000036 630400 8     OPEN$KEY_RE* EPPR0   30
         7 000540   000022 631400 xsym               EPPR1   B_VECTNIL+18
         7 000541   000000 701000 xent               TSX1    OCW$WRITE
         7 000542   000000 011000                    NOP     0

      628     3701    2             '020000'O /* M_DLTA  */, NO_STATION);
      629     3702    2        CALL M$WAIT (WAIT_20SECS);

   3702  7 000543   000602 630400 0                  EPPR0   WAIT_20SECS
         7 000544   020006 713400                    CLIMB   8198
         7 000545   400400 401760                    pmme    nvectors=2

      630     3703    2        ALTRETURN;

   3703  7 000546   200006 221300                    LDX1  ! TRIES+1,,AUTO
         7 000547   000000 702211                    TSX2  ! 0,X1

      631     3704    2   END OPEN$KEY;
      632     3705    1   END OCK$KEYIN;

   3705  7 000550   000000 702200 xent               TSX2  ! X66_MARET
      633     3706        %EOD;

PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:59   
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   OC_SCODE_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCK$KEYIN.
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:60   

 **** Variables and constants ****

  ****  Section 000  Data  OCK$KEYIN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   654-0-0/d STRC(72)    r     1 CONS_SEG                 226-0-0/c STRC(45)    r     1 CSCGNM
   134-0-0/d STRC(2088)  r     1 CS_OPEN                  464-0-0/d STRC(504)   r     1 CS_READ
   755-0-0/w PTR         r     1 F$KEYIN$                 616-0-0/d STRC(216)   r     1 FIVE_SECOND
    34-0-0/d STRC(144)   r     1 FPT_EVENT                 26-0-0/d STRC(216)   r     1 FREE_XS
    20-0-0/d STRC(216)   r     1 GET_COMMON               664-0-0/d BIT (72)    r     1 GET_COM_RESULTS
   646-0-0/d STRC(216)   r     1 GET_CONS_SEG             632-0-0/d STRC(432)   r     1 GET_UTS
   624-0-0/d STRC(216)   r     1 GET_XCON                 662-0-0/w SBIN        r     1 K
   520-0-0/d STRC(1080)  r     1 KEYF_CLOSE               352-0-0/d STRC(2088)  r     1 KEYF_OPEN
   502-0-0/d STRC(504)   r     1 KEYF_READ                444-0-0/c STRC(63)    r     1 KNAME
   663-0-0/w SBIN        r     1 L                        556-0-0/d STRC(576)   r     1 LINK_2_PARTRGE
   610-0-0/d STRC(216)   r     1 MAIN_WAIT                346-0-0/c STRC(63)    r     1 MNAME
   254-0-0/d STRC(2088)  r     1 MSGF_OPEN                  6-0-0/w UBIN        r     1 NEW_UTS
   722-0-0/c CHAR(59)    r     1 NO_MEMK                  706-0-0/c CHAR(46)    r     1 NO_OPENK
   670-0-0/c CHAR(55)    r     1 NO_OPENM                 741-0-0/c CHAR(48)    r     1 NO_READK
   666-0-0/c CHAR(8)     r     1 NO_STATION               132-0-0/c STRC(45)    r     1 OCCGNM
    16-0-0/d STRC(72)    r     1 OCK$SCODE                 10-0-0/d STRC(216)   r     1 OCK_SCREECH
    40-0-0/d STRC(2088)  r     1 OC_OPEN                  446-0-0/d STRC(504)   r     1 OC_READ
   600-0-0/c STRC(72)    r     1 PARTACC                  576-0-0/c STRC(72)    r     1 PARTRGE
   656-0-0/d STRC(144)   r     1 RESET_FMSEC              350-0-0/c STRC(72)    r     1 TACCT
     5-0-0/w UBIN        r     1 UTS                      230-0-0/d STRC(720)   r     1 VLP_CGCP
   602-0-0/d STRC(216)   r     1 WAIT_20SECS

  ****  Section 002 RoData OCK$KEYIN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(432)   r     1 KSST                      14-0-0/d STRC(1872)  r     1 OC_CGCTL

  ****  Auto variables  ****
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:61   

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w UBIN        r     1 J                          5-0-0/w UBIN        r     1 TRIES

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 M$CSCG$
     0-0-0/w PTR         r     1 M$OCCG$                    0-0-0/w PTR         r     1 OC_CONSOLE$
     0-0-0/w BIT         r     1 OC_FIRST_CONSOLE           0-0-0/c CHAR(8)     r     1 OC_GOOSE_STA
     0-0-0/w BIT (18)    r     1 OC_INTBIT                  0-0-0/c CHAR(256)   r     1 OC_KEYINBUF
     0-0-0/w BIT         r     1 OC_KEY_GOOD                0-0-0/w UBIN(18)    r     1 OC_MAXCONSOLE
     0-0-0/c STRC(1800)  r     1 OC_MSGBUFFER               0-0-0/w BIT         r     1 OC_MSG_GOOD
     0-0-0/w UBIN        r     1 OC_NEXT_PEND               0-0-0/w UBIN        r     1 OC_NEXT_PENDX
     0-0-0/w SBIN        r     1 OC_QDEPTH                  0-0-0/w UBIN        r     1 OC_QHEAD
     0-0-0/w UBIN        r     1 OC_QPOSN                   0-0-0/w UBIN        r     1 OC_REMAIN

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(2088)  r     1 B$JIT                      0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 F$KEYIN                    0-0-0N  NULL        r     1 F$TEMPLATE
     0-0-0N  NULL        r     1 M$CSCG                     0-0-0N  NULL        r     1 M$OCCG
     0-0-0/w STRC(2205)  r     1 OC_CONSOLE(0:0)


   Procedure OCK$KEYIN requires 361 words for executable code.
   Procedure OCK$KEYIN requires 12 words of local(AUTO) storage.
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:62   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:63   
          MINI XREF LISTING

B$JIT.ERR.MID
      1800**DCL      1800--REDEF
B$JIT.SYSID
      1799**DCL      3384>>IF
B$JIT$
      2013**DCL      1794--IMP-PTR  3384>>IF
CONS_SEG
      3260**DCL      3242--DCLINIT
CONS_SEG.PTR$
      3262**DCL      3400>>ASSIGN
CONS_SEG.W2
      3261**DCL      3262--REDEF
CSCGNM
      2496**DCL      2427--DCLINIT
CS_OPEN
      2426**DCL      3443<>CALL
CS_OPEN.ACSVEH_
      2428**DCL      2429--REDEF
CS_OPEN.ALTKEYS_
      2434**DCL      2435--REDEF    2435--REDEF
CS_OPEN.HDR_
      2433**DCL      2434--REDEF
CS_OPEN.TAB_
      2432**DCL      2433--REDEF
CS_OPEN.UHL_
      2426**DCL      2427--REDEF    2427--REDEF
CS_OPEN.V
      2435**DCL      2426--DCLINIT
CS_OPEN.V.FSN#
      2466**DCL      2466--REDEF    2466--REDEF
CS_OPEN.WSN_
      2432**DCL      2432--REDEF
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:64   
CS_READ.STATION_
      2967**DCL      2968--REDEF
CS_READ.V
      2968**DCL      2964--DCLINIT
CS_READ.V.DVBYTE.REREAD#
      2979**DCL      2979--REDEF
CS_READ.V.INDX#
      2977**DCL      2977--REDEF
F$DCB.ACTPOS
      3319**DCL      3319--REDEF
F$DCB.ARS#
      3293**DCL      3293--REDEF    3665>>ASSIGN
F$DCB.ATTR
      3312**DCL      3313--REDEF
F$DCB.BORROW
      3327**DCL      3327--REDEF    3327--REDEF    3327--REDEF
F$DCB.DCBNAME.L
      3341**DCL      3341--IMP-SIZ
F$DCB.EOMCHAR#
      3297**DCL      3297--REDEF
F$DCB.FLDID
      3322**DCL      3322--REDEF
F$DCB.FORM$
      3316**DCL      3316--REDEF
F$DCB.FSECT
      3332**DCL      3332--REDEF
F$DCB.FSN#
      3309**DCL      3309--REDEF    3309--REDEF    3310--REDEF
F$DCB.HEADER$
      3315**DCL      3315--REDEF
F$DCB.IXTNSIZE#
      3313**DCL      3313--REDEF
F$DCB.LASTSTA$
      3302**DCL      3302--REDEF
F$DCB.LVL
      3328**DCL      3328--REDEF
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:65   
F$DCB.NAME#.C
      3303**DCL      3303--REDEF
F$DCB.NOEOF
      3325**DCL      3325--REDEF
F$DCB.NRECS#
      3314**DCL      3314--REDEF
F$DCB.NRECX
      3333**DCL      3333--REDEF
F$DCB.OHDR
      3325**DCL      3325--REDEF
F$DCB.ORG#
      3308**DCL      3308--REDEF
F$DCB.PRECNO
      3331**DCL      3331--REDEF
F$DCB.RCSZ
      3337**DCL      3337--REDEF
F$DCB.RES#
      3304**DCL      3304--REDEF
F$DCB.SETX
      3316**DCL      3316--REDEF
F$DCB.TAB$
      3316**DCL      3316--REDEF
F$DCB.TDA
      3330**DCL      3331--REDEF
F$DCB.WSN#
      3304**DCL      3304--REDEF
F$KEYIN
      3374**DCL      3398--ASSIGN   3665--ASSIGN
F$KEYIN$
      3376**DCL      3398<<ASSIGN
FIVE_SECOND
      3185**DCL      3632<>CALL     3687<>CALL
FIVE_SECOND.V
      3186**DCL      3185--DCLINIT
FPT_EVENT
      2170**DCL      3426<>CALL
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:66   
FPT_EVENT.V
      2170**DCL      2170--DCLINIT
FREE_XS
      2147**DCL      3674<>CALL
FREE_XS.V
      2147**DCL      2147--DCLINIT
FREE_XS.V.SEGSIZE#
      2150**DCL      3672<<ASSIGN
GET_COMMON
      2126**DCL      3657<>CALL
GET_COMMON.V
      2126**DCL      2126--DCLINIT
GET_COMMON.V.SEGSIZE#
      2129**DCL      3655<<ASSIGN
GET_COM_RESULTS
      3360**DCL      2126--DCLINIT  2147--DCLINIT  3661>>ASSIGN
GET_CONS_SEG
      3242**DCL      3399<>CALL
GET_CONS_SEG.V
      3242**DCL      3242--DCLINIT
GET_UTS
      3220**DCL      3466<>CALL     3506<>CALL     3530<>CALL
GET_UTS.V
      3224**DCL      3220--DCLINIT
GET_XCON
      3201**DCL      3438<>CALL
GET_XCON.V
      3202**DCL      3201--DCLINIT
J
      3356**DCL      3665<<ASSIGN   3666>>ASSIGN   3667>>ASSIGN
K
      3357**DCL      3468<>CALL     3469>>ASSIGN   3479>>ASSIGN   3531<>CALL     3532>>ASSIGN   3539>>ASSIGN
      3666<<ASSIGN   3670<<ASSIGN   3670>>ASSIGN   3672>>ASSIGN
KEYF_CLOSE
      3055**DCL      3663<>CALL
KEYF_CLOSE.SN_
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:67   
      3055**DCL      3055--REDEF
KEYF_CLOSE.UTL_
      3056**DCL      3056--REDEF
KEYF_CLOSE.V
      3060**DCL      3055--DCLINIT
KEYF_CLOSE.V.EXPIRE#
      3070**DCL      3070--REDEF
KEYF_CLOSE.V.TYPE#
      3068**DCL      3068--REDEF
KEYF_CLOSE.V.XTNSIZE#
      3065**DCL      3065--REDEF    3067--REDEF
KEYF_OPEN
      2826**DCL      3649<>CALL
KEYF_OPEN.ACSVEH_
      2828**DCL      2829--REDEF
KEYF_OPEN.ALTKEYS_
      2834**DCL      2835--REDEF    2835--REDEF
KEYF_OPEN.HDR_
      2833**DCL      2834--REDEF
KEYF_OPEN.TAB_
      2832**DCL      2833--REDEF
KEYF_OPEN.UHL_
      2826**DCL      2827--REDEF    2827--REDEF
KEYF_OPEN.V
      2835**DCL      2826--DCLINIT
KEYF_OPEN.V.FSN#
      2866**DCL      2866--REDEF    2866--REDEF
KEYF_OPEN.WSN_
      2832**DCL      2832--REDEF
KEYF_READ
      3007**DCL      3662<>CALL
KEYF_READ.BUF_
      3009**DCL      3661<<ASSIGN
KEYF_READ.STATION_
      3010**DCL      3011--REDEF
KEYF_READ.V
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:68   
      3011**DCL      3007--DCLINIT
KEYF_READ.V.DVBYTE.REREAD#
      3022**DCL      3022--REDEF
KEYF_READ.V.INDX#
      3020**DCL      3020--REDEF
KNAME
      2896**DCL      2827--DCLINIT
KSST
      2336**DCL      2251--DCLINIT  2427--DCLINIT
L
      3358**DCL      3667<<ASSIGN   3668>>IF
LINK_2_PARTRGE
      3090**DCL      3685<>CALL
LINK_2_PARTRGE.V
      3092**DCL      3092--DCLINIT
M$CGCTL
      1464**DCL-ENT  3432--CALL
M$CLOSE
      1443**DCL-ENT  3663--CALL
M$CSCG
      3372**DCL      3397--ASSIGN
M$CSCG$
      1668**DCL      3397<<ASSIGN
M$EVENT
      1498**DCL-ENT  3426--CALL
M$EXIT
      1455**DCL-ENT  3386--CALL
M$FDS
      1478**DCL-ENT  3674--CALL
M$GDS
      1478**DCL-ENT  3399--CALL     3657--CALL
M$LINK
      1455**DCL-ENT  3685--CALL
M$OCCG
      3371**DCL      3396--ASSIGN
M$OCCG$
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:69   
      1668**DCL      3396<<ASSIGN
M$OPEN
      1443**DCL-ENT  3430--CALL     3443--CALL     3628--CALL     3649--CALL
M$READ
      1444**DCL-ENT  3491--CALL     3662--CALL
M$RPRIV
      1502**DCL-ENT  3483--CALL
M$SCREECH
      1457**DCL-ENT  3618--CALL
M$TIME
      1510**DCL-ENT  3466--CALL     3506--CALL     3530--CALL
M$WAIT
      1501**DCL-ENT  3524--CALL     3632--CALL     3687--CALL     3696--CALL     3702--CALL
M$XCON
      1498**DCL-ENT  3438--CALL
MAIN_WAIT
      3169**DCL      3524<>CALL
MAIN_WAIT.V
      3170**DCL      3169--DCLINIT
MAIN_WAIT.V.UNITS#
      3170**DCL      3477<<ASSIGN   3510<<ASSIGN   3512<>CALL     3514>>IF       3516<<ASSIGN   3520>>ASSIGN
      3543<<ASSIGN
MNAME
      2734**DCL      2665--DCLINIT
MSGF_OPEN
      2664**DCL      3628<>CALL
MSGF_OPEN.ACSVEH_
      2666**DCL      2667--REDEF
MSGF_OPEN.ALTKEYS_
      2672**DCL      2673--REDEF    2673--REDEF
MSGF_OPEN.HDR_
      2671**DCL      2672--REDEF
MSGF_OPEN.TAB_
      2670**DCL      2671--REDEF
MSGF_OPEN.UHL_
      2664**DCL      2665--REDEF    2665--REDEF
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:70   
MSGF_OPEN.V
      2673**DCL      2664--DCLINIT
MSGF_OPEN.V.FSN#
      2704**DCL      2704--REDEF    2704--REDEF
MSGF_OPEN.WSN_
      2670**DCL      2670--REDEF
NEW_UTS
       599**DCL      3224--DCLINIT  3468<>CALL     3475<>CALL     3508>>IF       3512<>CALL     3531<>CALL
      3538<>CALL
NO_MEMK
      3366**DCL      3694<>CALL     3694--CALL
NO_OPENK
      3364**DCL      3689<>CALL     3689--CALL
NO_OPENM
      3362**DCL      3634<>CALL     3634--CALL
NO_READK
      3368**DCL      3700<>CALL     3700--CALL
NO_STATION
      3361**DCL      3634<>CALL     3689<>CALL     3694<>CALL     3700<>CALL
OCCGNM
      2320**DCL      2251--DCLINIT
OCE$EVENT
      3345**DCL-ENT  2170--DCLINIT
OCE$MAKEDO
      3346**DCL-ENT  3529--CALL
OCE$PEVENT
      3347**DCL-ENT  3503--CALL
OCK$SCODE
      2061**DCL      2028--DCLINIT
OCK$SCODE.CODE#
      2087**DCL      3561<<ASSIGN   3573<<ASSIGN   3582<<ASSIGN   3603<<ASSIGN   3613<<ASSIGN
OCK$SCREECH
      3618**LABEL    3562--GOTO     3574--GOTO     3583--GOTO     3604--GOTO     3614--GOTO
OCK$SCREECH3
      3561**LABEL    3443--CALLALT
OCK$SCREECH4
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:71   
      3573**LABEL    3430--CALLALT  3432--CALLALT
OCK$SCREECH5
      3582**LABEL    3491--CALLALT
OCK$SCREECH7
      3603**LABEL    3426--CALLALT
OCK$SCREECH8
      3613**LABEL    3399--CALLALT
OCK$XCON
      3353**DCL-ENT  3202--DCLINIT
OCK_SCREECH
      2028**DCL      3618<>CALL
OCP$INITCONSOLE
      3351**DCL-ENT  3402--CALL
OCW$WRITE
      3349**DCL-ENT  3634--CALL     3689--CALL     3694--CALL     3700--CALL
OC_CGCTL
      2513**DCL      3432<>CALL
OC_CGCTL.V
      2518**DCL      2513--DCLINIT
OC_CONSOLE
      1627**DCL      3245--DCLINIT
OC_CONSOLE.ACTIVE
      1632**DCL      3421<<ASSIGN
OC_CONSOLE.ATTR
      1629**DCL      1629--REDEF
OC_CONSOLE.ATTRO
      1630**DCL      1630--REDEF
OC_CONSOLE.ATTR_INPUT
      1629**DCL      3417<<ASSIGN
OC_CONSOLE.ATTR_INPUT_SAVE
      1630**DCL      3418<<ASSIGN
OC_CONSOLE.ATTR_OUTPUT
      1630**DCL      3420<<ASSIGN
OC_CONSOLE.ATTR_OUTPUT_SAVE
      1630**DCL      3419<<ASSIGN
OC_CONSOLE.CID
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:72   
      1628**DCL      1629--REDEF
OC_CONSOLE.CID_O
      1629**DCL      3415<<ASSIGN
OC_CONSOLE.FLAGS.INPT
      1631**DCL      3423<<ASSIGN
OC_CONSOLE.FLAGS.OUTP
      1632**DCL      3424<<ASSIGN
OC_CONSOLE.LOGON
      1628**DCL      3414<<ASSIGN
OC_CONSOLE.MXPRIO
      1666**DCL      3422<<ASSIGN
OC_CONSOLE.STATION
      1627**DCL      1627--REDEF    3411<<ASSIGN
OC_CONSOLE.SYSID
      1629**DCL      3416<<ASSIGN
OC_CONSOLE.TERM_NAME
      1628**DCL      3412<<ASSIGN
OC_CONSOLE.WSN
      1628**DCL      3413<<ASSIGN
OC_CONSOLE$
      1626**DCL      1627--IMP-PTR  3400<<ASSIGN   3411>>ASSIGN   3412>>ASSIGN   3413>>ASSIGN   3414>>ASSIGN
      3415>>ASSIGN   3416>>ASSIGN   3417>>ASSIGN   3418>>ASSIGN   3419>>ASSIGN   3420>>ASSIGN   3421>>ASSIGN
      3422>>ASSIGN   3423>>ASSIGN   3424>>ASSIGN
OC_DIR
      1669**DCL      1669--REDEF
OC_FIRST_CONSOLE
      1675**DCL      3462<<ASSIGN
OC_GOOSE_STA
       600**DCL      3411>>ASSIGN
OC_INTBIT
      1669**DCL      1670--REDEF    3415>>ASSIGN
OC_INTMSG
      1546**DCL      1559--REDEF
OC_INTMSG.FLAGS
      1553**DCL      1554--REDEF
OC_INTMSG.MESS
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:73   
      1559**DCL      1559--REDEF
OC_INTMSG.MSGID
      1549**DCL      1550--REDEF
OC_INTMSG.WSN
      1556**DCL      1557--REDEF
OC_KEYINBUF
      1623**DCL      2922--DCLINIT  2923--DCLINIT
OC_KEY_GOOD
      1671**DCL      3647<<ASSIGN   3664<<ASSIGN
OC_MASK
      1670**DCL      1670--REDEF
OC_MAXCONSOLE
      1626**DCL      3401<<ASSIGN
OC_MESSBUF
      1561**DCL      1576--REDEF    1590--REDEF
OC_MESSBUF.FLAGS
      1568**DCL      1569--REDEF
OC_MESSBUF.MESS
      1574**DCL      1574--REDEF
OC_MESSBUF.MSGID
      1564**DCL      1565--REDEF
OC_MESSBUF.WSN
      1571**DCL      1572--REDEF
OC_MESSBUF1.FLAGS
      1583**DCL      1584--REDEF
OC_MESSBUF1.LEN
      1589**DCL      1589--REDEF
OC_MESSBUF1.MSGID
      1579**DCL      1580--REDEF
OC_MESSBUF1.WSN
      1586**DCL      1587--REDEF
OC_MSGBUFFER
      1592**DCL      1607--REDEF    2966--DCLINIT  2967--DCLINIT
OC_MSGBUFFER.FLAGS
      1599**DCL      1600--REDEF
OC_MSGBUFFER.MESS
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:74   
      1605**DCL      1605--REDEF
OC_MSGBUFFER.MSGID
      1595**DCL      1596--REDEF
OC_MSGBUFFER.WSN
      1602**DCL      1603--REDEF
OC_MSGBUFFER2.FLAGS
      1614**DCL      1615--REDEF
OC_MSGBUFFER2.MSGID
      1610**DCL      1611--REDEF
OC_MSGBUFFER2.WSN
      1617**DCL      1618--REDEF
OC_MSG_GOOD
      1670**DCL      3626<<ASSIGN   3629<<ASSIGN
OC_NEXT_PEND
      1622**DCL      3479<<ASSIGN   3539<<ASSIGN
OC_NEXT_PENDX
      1623**DCL      3479>>ASSIGN   3539>>ASSIGN   3539>>ASSIGN
OC_OPEN
      2250**DCL      3430<>CALL
OC_OPEN.ACSVEH_
      2252**DCL      2253--REDEF
OC_OPEN.ALTKEYS_
      2258**DCL      2259--REDEF    2259--REDEF
OC_OPEN.HDR_
      2257**DCL      2258--REDEF
OC_OPEN.TAB_
      2256**DCL      2257--REDEF
OC_OPEN.UHL_
      2250**DCL      2251--REDEF    2251--REDEF
OC_OPEN.V
      2259**DCL      2250--DCLINIT
OC_OPEN.V.FSN#
      2290**DCL      2290--REDEF    2290--REDEF
OC_OPEN.WSN_
      2256**DCL      2256--REDEF
OC_PARAM
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:75   
      1625**DCL      1625--REDEF
OC_QDEPTH
      1620**DCL      3392<<ASSIGN   3501>>DOWHILE  3522>>IF
OC_QHEAD
      1621**DCL      3394<<ASSIGN
OC_QPOSN
      1621**DCL      3393<<ASSIGN
OC_QUEUE.PARMC
      1624**DCL      1624--REDEF
OC_READ
      2920**DCL      3491<>CALL
OC_READ.STATION_
      2923**DCL      2924--REDEF
OC_READ.V
      2924**DCL      2920--DCLINIT
OC_READ.V.DVBYTE.REREAD#
      2935**DCL      2935--REDEF
OC_READ.V.INDX#
      2933**DCL      2933--REDEF
OC_REMAIN
      1621**DCL      3169--DCLINIT  3469<<ASSIGN   3471>>IF       3473<<ASSIGN   3473>>ASSIGN   3474<<ASSIGN
      3474>>ASSIGN   3475>>CALL     3477>>ASSIGN   3520<<ASSIGN   3526>>IF       3532<<ASSIGN   3533>>IF
      3535<<ASSIGN   3535>>ASSIGN   3536<<ASSIGN   3536>>ASSIGN   3538>>CALL     3543>>ASSIGN
OH_NO_NOT_AGAIN IN PROCEDURE OPEN$KEY
      3672**LABEL    3674--CALLALT
OPEN$KEY
      3646**PROC     3460--CALL
OPEN$KEY_ALT IN PROCEDURE OPEN$KEY
      3685**LABEL    3649--CALLALT
OPEN$KEY_MEM IN PROCEDURE OPEN$KEY
      3694**LABEL    3657--CALLALT
OPEN$KEY_READ IN PROCEDURE OPEN$KEY
      3700**LABEL    3662--CALLALT  3685--CALLALT
OPEN$MSG
      3625**PROC     3455--CALL
OPEN$MSG_ALT IN PROCEDURE OPEN$MSG
PL6.E3A0      #001=OCK$KEYIN File=OCK$KEYIN.:E05TSI                              WED 07/30/97 03:58 Page:76   
      3632**LABEL    3628--CALLALT
O_NO
      3479**LABEL    3483--CALLALT
PARTACC
      3137**DCL      3090--DCLINIT
PARTRGE
      3122**DCL      3090--DCLINIT
RESET_FMSEC
      3277**DCL      3483<>CALL
RESET_FMSEC.V
      3277**DCL      3277--DCLINIT
TACCT
      2748**DCL      2255--DCLINIT  2431--DCLINIT  2669--DCLINIT  2831--DCLINIT
TRIES
      3359**DCL      3627<<DOINDEX  3648<<DOINDEX
UTS
       598**DCL      3475<>CALL     3508>>IF       3512<>CALL     3538<>CALL
VLP_CGCP
      2557**DCL      2514--DCLINIT
VLP_CGCP.DVBYTE.REREAD#
      2571**DCL      2572--REDEF
WAIT_20SECS
      3152**DCL      3696<>CALL     3702<>CALL
WAIT_20SECS.V
      3153**DCL      3152--DCLINIT
WHO_CARES1
      3455**LABEL    3455--CALLALT
WHO_CARES2
      3455**LABEL    3460--CALLALT
XUD$UTS_ADJUST
      1987**DCL-ENT  3475--CALL     3538--CALL
XUD$UTS_DIFF_SEC
      1975**DCL-ENT  3468--CALL     3512--CALL     3531--CALL

PL6.E3A0      #002=OCK$XCON File=OCK$KEYIN.:E05TSI                               WED 07/30/97 03:59 Page:77   
      634        1        /*M* OCK$XCON Keyins abort handler      */
      635        2        /*T***********************************************************/
      636        3        /*T*                                                         */
      637        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      638        5        /*T*                                                         */
      639        6        /*T***********************************************************/
      640        7        %SET LISTSUB='1'B;
      641        8        /*
      642        9             ###     ###    #   #     #     #   #    ###     ###    #   #
      643       10            #   #   #   #   #  #     ###    #   #   #   #   #   #   #   #
      644       11            #   #   #       # #     # #      # #    #       #   #   ##  #
      645       12            #   #   #       ##       ###      #     #       #   #   # # #
      646       13            #   #   #       # #       # #    # #    #       #   #   #  ##
      647       14            #   #   #   #   #  #     ###    #   #   #   #   #   #   #   #
      648       15             ###     ###    #   #     #     #   #    ###     ###    #   #
      649       16                                                                          */
      650       17        OCK$XCON: PROC ASYNC;
      651       18                                                /**/
      652       19    1   DCL OCW$WRITE ENTRY(5);
      653       20    1   DCL OCK$TRTN ENTRY ASYNC;
      654       21    1   DCL B$TCB$ PTR SYMREF;
      655       22                                                /**/
      656       23        %INCLUDE OCI_SUBS_C;
      657      121                                                /**/
      658      122        %INCLUDE OC_SCODE_C;
      659      147        %INCLUDE OC_SUBS_C;
      660      878                                                /**/
      661      879        %INCLUDE CP_6;
      662      960        %INCLUDE OC_DAT_R;
      663     1121                                                /**/
      664     1122             %FPT_SCREECH   (FPTN=OCK_EXITED,
      665     1123                                 SCODE=OCK$ARRGH);
      666     1137                  %VLP_SUA      (FPTN=OCK$ARRGH,
      667     1138                                 STCLASS=CONSTANT SYMDEF,
      668     1139                                 FCG=OC,
      669     1140                                 MID=K,
      670     1141                                 MON='0'B,
PL6.E3A0      #002=OCK$XCON File=OCK$KEYIN.:E05TSI                               WED 07/30/97 03:59 Page:78   
      671     1142                                 SEV=SEV_SCREECH,
      672     1143                                 CODE=%S$KEYINTRAP);
      673     1213                                                /**/
      674     1214                                                /**/
      675     1215    1   DCL ARRGH_MSG CHAR(0) STATIC INIT
      676     1216    1        (' KEYIN IS ABOUT TO SCREECH .... AUUUUUUGGGGGH!!!!!');
      677     1217    1   DCL NO_STA CHAR(8) STATIC INIT (' ');
      678     1218                                                /**/
      679     1219             %FPT_WAIT      (FPTN=WAIT_IT_OUT,
      680     1220                                 UNITS=20);
      681     1234                                                /**/
      682     1235             %FPT_EVENT     (FPTN=CHANGE_EVENT_ADDR,
      683     1236                                 UENTRY=OCK$TRTN);
      684     1250                                                /**/
      685     1251        /*
      686     1252                  Begin O C K $ X C O N main
      687     1253                                                */
      688     1254    1        CALL M$EVENT (CHANGE_EVENT_ADDR) ALTRET (TRY_ANYWAY);
      689     1255    1   TRY_ANYWAY: ;
      690     1256    1        CALL OCW$WRITE (ARRGH_MSG, SIZEC(ARRGH_MSG), '200000'O /* M_SYS  */, NO_STA);
      691     1257                                                /**/
      692     1258    1        CALL M$WAIT (WAIT_IT_OUT);
      693     1259                                                /**/
      694     1260        /*S*
      695     1261             SCREECH_CODE: OCK-S$KEYINTRAP
      696     1262                  TYPE:     SCREECH
      697     1263             MESSAGE:       KEYIN is exiting, probably for unexpected trap.
      698     1264             REMARKS:       KEYIN must screech instead of exiting, as noone
      699     1265                            can access CSCG without him.                                */
      700     1266    1        CALL M$SCREECH (OCK_EXITED);
      701     1267                                                /**/
      702     1268    1   END OCK$XCON;
      703     1269        %EOD;

PL6.E3A0      #002=OCK$XCON File=OCK$KEYIN.:E05TSI                               WED 07/30/97 03:59 Page:79   
--  Include file information  --

   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OC_SCODE_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCK$XCON.

   Procedure OCK$XCON requires 17 words for executable code.
   Procedure OCK$XCON requires 4 words of local(AUTO) storage.

PL6.E3A0      #002=OCK$XCON File=OCK$KEYIN.:E05TSI                               WED 07/30/97 03:59 Page:80   

 Object Unit name= OCK$XCON                                   File name= OCK$KEYIN.:E05TOU
 UTS= JUL 30 '97 03:59:27.76 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    32     40  OCK$XCON
    2  RoData even  UTS      2      2  OCK$XCON
    3   Proc  even  none    17     21  OCK$XCON
    4  RoData even  none     6      6  OCK$XCON

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes     Async       0  OCK$XCON

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    2      0  OCK$ARRGH

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          Async      0 OCK$TRTN
         yes           Std       5 OCW$WRITE
                       nStd      0 X66_AAUTO
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AARET
PL6.E3A0      #002=OCK$XCON File=OCK$KEYIN.:E05TSI                               WED 07/30/97 03:59 Page:81   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  OC_INTMSG                             OC_MESSBUF
     OC_MSGBUFFER                          OC_PARAM                              OC_CONSOLE$
     OC_DIR                                OC_INTBIT                             OC_MASK
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #002=OCK$XCON File=OCK$KEYIN.:E05TSI                               WED 07/30/97 03:59 Page:82   


      634        1        /*M* OCK$XCON Keyins abort handler      */
      635        2        /*T***********************************************************/
      636        3        /*T*                                                         */
      637        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      638        5        /*T*                                                         */
      639        6        /*T***********************************************************/
      640        7        %SET LISTSUB='1'B;
      641        8        /*
      642        9             ###     ###    #   #     #     #   #    ###     ###    #   #
      643       10            #   #   #   #   #  #     ###    #   #   #   #   #   #   #   #
      644       11            #   #   #       # #     # #      # #    #       #   #   ##  #
      645       12            #   #   #       ##       ###      #     #       #   #   # # #
      646       13            #   #   #       # #       # #    # #    #       #   #   #  ##
      647       14            #   #   #   #   #  #     ###    #   #   #   #   #   #   #   #
      648       15             ###     ###    #   #     #     #   #    ###     ###    #   #
      649       16                                                                          */
      650       17        OCK$XCON: PROC ASYNC;

     17  3 000000   000000 700200 xent  OCK$XCON     TSX0  ! X66_AAUTO
         3 000001   000004 000000                    ZERO    4,0

      651       18                                                /**/
      652       19    1   DCL OCW$WRITE ENTRY(5);
      653       20    1   DCL OCK$TRTN ENTRY ASYNC;
      654       21    1   DCL B$TCB$ PTR SYMREF;
      655       22                                                /**/
      656       23        %INCLUDE OCI_SUBS_C;
      657      121                                                /**/
      658      122        %INCLUDE OC_SCODE_C;
      659      147        %INCLUDE OC_SUBS_C;
      660      878                                                /**/
      661      879        %INCLUDE CP_6;
      662      960        %INCLUDE OC_DAT_R;
      663     1121                                                /**/
      664     1122             %FPT_SCREECH   (FPTN=OCK_EXITED,
      665     1123                                 SCODE=OCK$ARRGH);
PL6.E3A0      #002=OCK$XCON File=OCK$KEYIN.:E05TSI                               WED 07/30/97 03:59 Page:83   
      666     1137                  %VLP_SUA      (FPTN=OCK$ARRGH,
      667     1138                                 STCLASS=CONSTANT SYMDEF,
      668     1139                                 FCG=OC,
      669     1140                                 MID=K,
      670     1141                                 MON='0'B,
      671     1142                                 SEV=SEV_SCREECH,
      672     1143                                 CODE=%S$KEYINTRAP);
      673     1213                                                /**/
      674     1214                                                /**/
      675     1215    1   DCL ARRGH_MSG CHAR(0) STATIC INIT
      676     1216    1        (' KEYIN IS ABOUT TO SCREECH .... AUUUUUUGGGGGH!!!!!');
      677     1217    1   DCL NO_STA CHAR(8) STATIC INIT (' ');
      678     1218                                                /**/
      679     1219             %FPT_WAIT      (FPTN=WAIT_IT_OUT,
      680     1220                                 UNITS=20);
      681     1234                                                /**/
      682     1235             %FPT_EVENT     (FPTN=CHANGE_EVENT_ADDR,
      683     1236                                 UENTRY=OCK$TRTN);
      684     1250                                                /**/
      685     1251        /*
      686     1252                  Begin O C K $ X C O N main
      687     1253                                                */
      688     1254    1        CALL M$EVENT (CHANGE_EVENT_ADDR) ALTRET (TRY_ANYWAY);

   1254  3 000002   000034 630400 1                  EPPR0   CHANGE_EVENT_ADDR
         3 000003   410001 713400                    CLIMB   alt,+4097
         3 000004   400000 401760                    pmme    nvectors=1
         3 000005   000006 702000 3                  TSX2    TRY_ANYWAY

   1254  3 000006                       TRY_ANYWAY   null
      689     1255    1   TRY_ANYWAY: ;
      690     1256    1        CALL OCW$WRITE (ARRGH_MSG, SIZEC(ARRGH_MSG), '200000'O /* M_SYS  */, NO_STA);

   1256  3 000006   000002 630400 4                  EPPR0   2
         3 000007   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000010   000000 701000 xent               TSX1    OCW$WRITE
         3 000011   000000 011000                    NOP     0
PL6.E3A0      #002=OCK$XCON File=OCK$KEYIN.:E05TSI                               WED 07/30/97 03:59 Page:84   

      691     1257                                                /**/
      692     1258    1        CALL M$WAIT (WAIT_IT_OUT);

   1258  3 000012   000026 630400 1                  EPPR0   WAIT_IT_OUT
         3 000013   020006 713400                    CLIMB   8198
         3 000014   400400 401760                    pmme    nvectors=2

      693     1259                                                /**/
      694     1260        /*S*
      695     1261             SCREECH_CODE: OCK-S$KEYINTRAP
      696     1262                  TYPE:     SCREECH
      697     1263             MESSAGE:       KEYIN is exiting, probably for unexpected trap.
      698     1264             REMARKS:       KEYIN must screech instead of exiting, as noone
      699     1265                            can access CSCG without him.                                */
      700     1266    1        CALL M$SCREECH (OCK_EXITED);

   1266  3 000015   000000 630400 1                  EPPR0   OCK_EXITED
         3 000016   000013 713400                    CLIMB   11
         3 000017   401000 401760                    pmme    nvectors=3

      701     1267                                                /**/
      702     1268    1   END OCK$XCON;

   1268  3 000020   000000 702200 xent               TSX2  ! X66_AARET
      703     1269        %EOD;

PL6.E3A0      #002=OCK$XCON File=OCK$KEYIN.:E05TSI                               WED 07/30/97 03:59 Page:85   
--  Include file information  --

   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OC_SCODE_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCK$XCON.
PL6.E3A0      #002=OCK$XCON File=OCK$KEYIN.:E05TSI                               WED 07/30/97 03:59 Page:86   

 **** Variables and constants ****

  ****  Section 001  Data  OCK$XCON

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/c CHAR(50)    r     1 ARRGH_MSG                 34-0-0/d STRC(144)   r     1 CHANGE_EVENT_ADDR
    23-0-0/c CHAR(8)     r     1 NO_STA                     0-0-0/d STRC(216)   r     1 OCK_EXITED
    26-0-0/d STRC(216)   r     1 WAIT_IT_OUT

  ****  Section 002 RoData OCK$XCON

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(72)    r     1 OCK$ARRGH

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 OC_CONSOLE$


   Procedure OCK$XCON requires 17 words for executable code.
   Procedure OCK$XCON requires 4 words of local(AUTO) storage.
PL6.E3A0      #002=OCK$XCON File=OCK$KEYIN.:E05TSI                               WED 07/30/97 03:59 Page:87   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=OCK$XCON File=OCK$KEYIN.:E05TSI                               WED 07/30/97 03:59 Page:88   
          MINI XREF LISTING

ARRGH_MSG
      1215**DCL      1256<>CALL     1256--CALL
CHANGE_EVENT_ADDR
      1247**DCL      1254<>CALL
CHANGE_EVENT_ADDR.V
      1247**DCL      1247--DCLINIT
M$EVENT
       943**DCL-ENT  1254--CALL
M$SCREECH
       902**DCL-ENT  1266--CALL
M$WAIT
       946**DCL-ENT  1258--CALL
NO_STA
      1217**DCL      1256<>CALL
OCK$ARRGH
      1166**DCL      1134--DCLINIT
OCK$TRTN
        20**DCL-ENT  1247--DCLINIT
OCK_EXITED
      1134**DCL      1266<>CALL
OCW$WRITE
        19**DCL-ENT  1256--CALL
OC_CONSOLE.ATTR
      1074**DCL      1074--REDEF
OC_CONSOLE.ATTRO
      1075**DCL      1075--REDEF
OC_CONSOLE.CID
      1073**DCL      1074--REDEF
OC_CONSOLE.STATION
      1072**DCL      1072--REDEF
OC_CONSOLE$
      1071**DCL      1072--IMP-PTR
PL6.E3A0      #002=OCK$XCON File=OCK$KEYIN.:E05TSI                               WED 07/30/97 03:59 Page:89   
OC_DIR
      1114**DCL      1114--REDEF
OC_INTBIT
      1114**DCL      1115--REDEF
OC_INTMSG
       991**DCL      1004--REDEF
OC_INTMSG.FLAGS
       998**DCL       999--REDEF
OC_INTMSG.MESS
      1004**DCL      1004--REDEF
OC_INTMSG.MSGID
       994**DCL       995--REDEF
OC_INTMSG.WSN
      1001**DCL      1002--REDEF
OC_MASK
      1115**DCL      1115--REDEF
OC_MESSBUF
      1006**DCL      1021--REDEF    1035--REDEF
OC_MESSBUF.FLAGS
      1013**DCL      1014--REDEF
OC_MESSBUF.MESS
      1019**DCL      1019--REDEF
OC_MESSBUF.MSGID
      1009**DCL      1010--REDEF
OC_MESSBUF.WSN
      1016**DCL      1017--REDEF
OC_MESSBUF1.FLAGS
      1028**DCL      1029--REDEF
OC_MESSBUF1.LEN
      1034**DCL      1034--REDEF
OC_MESSBUF1.MSGID
      1024**DCL      1025--REDEF
OC_MESSBUF1.WSN
      1031**DCL      1032--REDEF
OC_MSGBUFFER
      1037**DCL      1052--REDEF
PL6.E3A0      #002=OCK$XCON File=OCK$KEYIN.:E05TSI                               WED 07/30/97 03:59 Page:90   
OC_MSGBUFFER.FLAGS
      1044**DCL      1045--REDEF
OC_MSGBUFFER.MESS
      1050**DCL      1050--REDEF
OC_MSGBUFFER.MSGID
      1040**DCL      1041--REDEF
OC_MSGBUFFER.WSN
      1047**DCL      1048--REDEF
OC_MSGBUFFER2.FLAGS
      1059**DCL      1060--REDEF
OC_MSGBUFFER2.MSGID
      1055**DCL      1056--REDEF
OC_MSGBUFFER2.WSN
      1062**DCL      1063--REDEF
OC_PARAM
      1070**DCL      1070--REDEF
OC_QUEUE.PARMC
      1069**DCL      1069--REDEF
TRY_ANYWAY
      1254**LABEL    1254--CALLALT
WAIT_IT_OUT
      1231**DCL      1258<>CALL
WAIT_IT_OUT.V
      1232**DCL      1231--DCLINIT

PL6.E3A0      #003=OCK$TRTN File=OCK$KEYIN.:E05TSI                               WED 07/30/97 03:59 Page:91   
      704        1        /*M* OCK$TRTN KEYINs dummy event handler */
      705        2        /*T***********************************************************/
      706        3        /*T*                                                         */
      707        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      708        5        /*T*                                                         */
      709        6        /*T***********************************************************/
      710        7        %SET LISTSUB='1'B;
      711        8        /*
      712        9         ###    ###   #   #   #   #####  ####   #####  #   #
      713       10        #   #  #   #  #  #   ###    #    #   #    #    #   #
      714       11        #   #  #      # #   # #     #    #   #    #    ##  #
      715       12        #   #  #      ##     ###    #    ####     #    # # #
      716       13        #   #  #      # #     # #   #    # #      #    #  ##
      717       14        #   #  #   #  #  #   ###    #    #  #     #    #   #
      718       15         ###    ###   #   #   #     #    #   #    #    #   #
      719       16                                                                   */
      720       17                                                /**/
      721       18        OCK$TRTN: PROC ASYNC;
      722       19                                                /**/
      723       20        %INCLUDE CP_6;
      724      101                                                /**/
      725      102                                                /**/
      726      103                                           /* In B00, a normal RETURN
      727      104                                              will pop the exceptional
      728      105                                              condition stack.  A M$TRTN
      729      106                                              should no longer be used. */
      730      107                                                /**/
      731      108    1        RETURN;
      732      109                                                /**/
      733      110    1   END OCK$TRTN;

PL6.E3A0      #003=OCK$TRTN File=OCK$KEYIN.:E05TSI                               WED 07/30/97 03:59 Page:92   
--  Include file information  --

   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCK$TRTN.

   Procedure OCK$TRTN requires 3 words for executable code.
   Procedure OCK$TRTN requires 4 words of local(AUTO) storage.

    No errors detected in file OCK$KEYIN.:E05TSI    .

PL6.E3A0      #003=OCK$TRTN File=OCK$KEYIN.:E05TSI                               WED 07/30/97 03:59 Page:93   

 Object Unit name= OCK$TRTN                                   File name= OCK$KEYIN.:E05TOU
 UTS= JUL 30 '97 03:59:41.52 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none     3      3  OCK$TRTN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes     Async       0  OCK$TRTN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AAUTO
                       nStd      0 X66_AARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC
PL6.E3A0      #003=OCK$TRTN File=OCK$KEYIN.:E05TSI                               WED 07/30/97 03:59 Page:94   


      704        1        /*M* OCK$TRTN KEYINs dummy event handler */
      705        2        /*T***********************************************************/
      706        3        /*T*                                                         */
      707        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      708        5        /*T*                                                         */
      709        6        /*T***********************************************************/
      710        7        %SET LISTSUB='1'B;
      711        8        /*
      712        9         ###    ###   #   #   #   #####  ####   #####  #   #
      713       10        #   #  #   #  #  #   ###    #    #   #    #    #   #
      714       11        #   #  #      # #   # #     #    #   #    #    ##  #
      715       12        #   #  #      ##     ###    #    ####     #    # # #
      716       13        #   #  #      # #     # #   #    # #      #    #  ##
      717       14        #   #  #   #  #  #   ###    #    #  #     #    #   #
      718       15         ###    ###   #   #   #     #    #   #    #    #   #
      719       16                                                                   */
      720       17                                                /**/
      721       18        OCK$TRTN: PROC ASYNC;

     18  1 000000   000000 700200 xent  OCK$TRTN     TSX0  ! X66_AAUTO
         1 000001   000004 000000                    ZERO    4,0

      722       19                                                /**/
      723       20        %INCLUDE CP_6;
      724      101                                                /**/
      725      102                                                /**/
      726      103                                           /* In B00, a normal RETURN
      727      104                                              will pop the exceptional
      728      105                                              condition stack.  A M$TRTN
      729      106                                              should no longer be used. */
      730      107                                                /**/
      731      108    1        RETURN;

    108  1 000002   000000 702200 xent               TSX2  ! X66_AARET
      732      109                                                /**/
      733      110    1   END OCK$TRTN;
PL6.E3A0      #003=OCK$TRTN File=OCK$KEYIN.:E05TSI                               WED 07/30/97 03:59 Page:95   

PL6.E3A0      #003=OCK$TRTN File=OCK$KEYIN.:E05TSI                               WED 07/30/97 03:59 Page:96   
--  Include file information  --

   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCK$TRTN.
PL6.E3A0      #003=OCK$TRTN File=OCK$KEYIN.:E05TSI                               WED 07/30/97 03:59 Page:97   

 **** Variables and constants ****


   Procedure OCK$TRTN requires 3 words for executable code.
   Procedure OCK$TRTN requires 4 words of local(AUTO) storage.

    No errors detected in file OCK$KEYIN.:E05TSI    .
PL6.E3A0      #003=OCK$TRTN File=OCK$KEYIN.:E05TSI                               WED 07/30/97 03:59 Page:98   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=OCK$TRTN File=OCK$KEYIN.:E05TSI                               WED 07/30/97 03:59 Page:99   
          MINI XREF LISTING

