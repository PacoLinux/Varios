VERSION E05

PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:1    
        1        1        /*M* DUU$GETMVAL Access RU program records for User DELTA */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*P* NAME: DUU$GETMVAL
       10       10             PURPOSE: This module contains routines to access the program
       11       11                      image from the RU file, rather than from memory.
       12       12             DESCRIPTION: This module contains routines to access the program
       13       13                          image from the RU file currently being RUMed. The buffer
       14       14                          pointed to by S_D.PROG_BUF$ is used to read/write the
       15       15                          programs records. */
       16       16        %EJECT;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:2    
       17       17        /*F* NAME: DUU$GETMVAL
       18       18             PURPOSE: To obtain the specified word from the RU file.
       19       19             DESCRIPTION: A cache controlled by S_D.RCBC structure is used to access
       20       20                          the program records. The desired program record is
       21       21                          determined from the input parameters. If the record
       22       22                          is already in memory then the desired value is obtained
       23       23                          from it. Otherwise, the desired program record is read
       24       24                          into the program record buffer, and then its value is
       25       25                          obtained. Note that the HEAD record, and the read-only-
       26       26                          segment records are always in memory, having been setup
       27       27                          at RUM command time. */
       28       28        /*D* NAME: DUU$GETMVAL
       29       29             ENTRY: DUU$GETMVAL
       30       30             CALL: CALL DUU$GETMVAL(VALUE, NODE, ADDRESS, SEG, DESC, NOT_IS) ALTRET(err);
       31       31             INPUT: NODE - Overlay node number.
       32       32                    ADDRESS - Address in ISR or offset requested.
       33       33                    SEG - Meaningful only if NOT_IS.
       34       34                          5 - $DCBn.
       35       35                              DESC=n.
       36       36                          7 - HEAD record.
       37       37                              DESC=0, $SA.
       38       38                              DESC=1, $PRIV.
       39       39                              DESC=2, $HEAD.
       40       40                    DESC - Function of SEG.
       41       41             OUTPUT: VALUE - Value of word at requested address.
       42       42             SCRATCH: Local AUTO only.
       43       43             DESCRIPTION: A cache controlled by S_D.RCBC structure is used to access
       44       44                          the program records. The desired program record is
       45       45                          determined from the input parameters. If the record
       46       46                          is already in memory then the desired value is obtained
       47       47                          from it. Otherwise, the desired program record is read
       48       48                          into the program record buffer, and then its value is
       49       49                          obtained. Note that the HEAD record, and the read-only-
       50       50                          segment records are always in memory, having been setup
       51       51                          at RUM command time. RETURNs if successful, else ALTRETURNs */
       52       52                                                /**/
       53       53        DUU$GETMVAL: PROC( VALUE, NODE, ADDRESS, SEG, DESC, NOT_IS ) ALTRET;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:3    
       54       54                                                /**/
       55       55        /* Parm */
       56       56    1   DCL 1 VALUE ALIGNED,
       57       57    1         2 SIZE UBIN,
       58       58    1         2 OPS(0:15) UBIN,
       59       59    1         2 OPSB(0:15) REDEF OPS,
       60       60    1           3 * UBIN(20) UNAL,
       61       61    1           3 UBYTE UBIN(8) UNAL,
       62       62    1           3 LBYTE UBIN(8) UNAL,
       63       63    1         2 OPSBITS(0:15) REDEF OPS BIT(36);
       64       64    1   DCL NODE UBIN;
       65       65    1   DCL ADDRESS SBIN;
       66       66    1   DCL SEG UBIN;
       67       67    1   DCL DESC UBIN;
       68       68    1   DCL NOT_IS BIT(1) ALIGNED;
       69       69        /* Auto */
       70       70    1   DCL READ BIT(1) ALIGNED;
       71       71    1   DCL CBX UBIN;
       72       72    1   DCL TNODE UBIN;
       73       73    1   DCL VSIZE UBIN;
       74       74    1   DCL 1 NWORD_L6 ALIGNED,
       75       75    1         2 * UBIN(16) UNAL,
       76       76    1         2 ADDR1 UBIN(4) UNAL,
       77       77    1         2 ADDR2 UBIN(16) UNAL;
       78       78    1   DCL NWORD_L6V REDEF NWORD_L6 UBIN(36) ALIGNED;
       79       79        /* Based */
       80       80        %INCLUDE B$OBJECT_C;
       81     3510        %B$HEAD;
       82     3710        %B$TREE_TABLE (HDR_NAME=B$TREEHDR,NODE_NAME="B$NODE(0:0)");
       83     3768        %B$RUBIRTH (STCLASS=BASED,
       84     3769                    COUNTINIT=);
       85     3778        %INCLUDE B$ROSEG;
       86     3841        %INCLUDE F$DCB;
       87     3890        /* Constant */
       88     3891        %INCLUDE F_DCB_D;
       89     3979        %M$MDCB (DCBN=M$MDCB,
       90     3980                 STCLASS=CONSTANT);
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:4    
       91     4054    1   DCL DCBSIZEC UBIN CONSTANT INIT( SIZEC( M$MDCB ) );
       92     4055        /* Symref */
       93     4056    1   DCL B$ROS$ PTR SYMREF;
       94     4057        /* DELTA's "Static" data */
       95     4058        %INCLUDE XUH_MACRO_C;
       96     4142        %INCLUDE DD_SD_M;
       97     5478        %S_D;
       98     6796        /* Entry */
       99     6797    1   DCL DDE$ERROR ENTRY;
      100     6798    1   DCL DDQ$READLM ENTRY(7) ALTRET;
      101     6799    1   DCL DDQ$WRITELM ENTRY(5) ALTRET;
      102     6800        /* Misc */
      103     6801        %B$RECORDSUBS;
      104     6829        %INCLUDE DD_ERR_C;
      105     7226        %INCLUDE CP_6_SUBS;
      106     7766        %INCLUDE G_LCP6_E;
      107     8024        %INCLUDE GF_DCB_E;
      108     8063                                                /**/
      109     8064    1        READ = '1'B;
      110     8065    1        VSIZE = 16;
      111     8066    1        CALL ACCESS ALTRET( ARET );
      112     8067                                                /**/
      113     8068    1        RETURN;
      114     8069                                                /**/
      115     8070    1   ARET:
      116     8071    1        ALTRETURN;
      117     8072                                                /**/
      118     8073        %EJECT;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:5    
      119     8074        /*F* NAME: DUU$PUTMVAL
      120     8075             PURPOSE: To obtain and update the specified word from the RU file.
      121     8076             DESCRIPTION: A cache controlled by S_D.RCBC structure is used to access
      122     8077                          the program records. The desired program record is
      123     8078                          determined from the input parameters. If the record
      124     8079                          is already in memory then the desired value is updated
      125     8080                          into it. Otherwise, the desired program record is read
      126     8081                          into the program record buffer, and then its value is
      127     8082                          updated. Note that the HEAD record, and the read-only-
      128     8083                          segment records are always in memory, having been setup
      129     8084                          at RUM command time. */
      130     8085        /*D* NAME: DUU$PUTMVAL
      131     8086             ENTRY: DUU$PUTMVAL
      132     8087             CALL: CALL DUU$PUTMVAL(VALUE, NODE, ADDRESS, SEG, DESC, NOT_IS) ALTRET(err);
      133     8088             INPUT: VALUE - Value to be updated into ADDRESS.
      134     8089                    NODE - Overlay node number.
      135     8090                    ADDRESS - Address in ISR or offset requested.
      136     8091                    SEG - Meaningful only if NOT_IS.
      137     8092                          5 - $DCBn.
      138     8093                              DESC=n.
      139     8094                          7 - HEAD record.
      140     8095                              DESC=0, $SA.
      141     8096                              DESC=1, $PRIV.
      142     8097                              DESC=2, $HEAD.
      143     8098                    DESC - Function of SEG.
      144     8099                    NOT_IS - Set if requested value is not in ISR, see SEG & DESC.
      145     8100             OUTPUT: None.
      146     8101             SCRATCH: Local AUTO only.
      147     8102             DESCRIPTION: A cache controlled by S_D.RCBC structure is used to access
      148     8103                          the program records. The desired program record is
      149     8104                          determined from the input parameters. If the record
      150     8105                          is already in memory then the desired value is updated
      151     8106                          into it. Otherwise, the desired program record is read
      152     8107                          into the program record buffer, and then its value is
      153     8108                          updated.  Note that the HEAD record, and the read-only-
      154     8109                          segment records are always in memory, having been setup
      155     8110                           at RUM command time. RETURNs if successful, else ALTRETs. */
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:6    
      156     8111                                                /**/
      157     8112    1   DUU$PUTMVAL: ENTRY( VALUE, NODE, ADDRESS, SEG, DESC, NOT_IS ) ALTRET;
      158     8113                                                /**/
      159     8114    1        IF S_D.PROTECT
      160     8115    2        THEN DO;
      161     8116    2             S_D.ERROR = 185;        /* E@PROTECT */
      162     8117    2             GOTO ARET;
      163     8118    2           END;
      164     8119    1        READ = '0'B;
      165     8120    1        VSIZE = VALUE.SIZE;
      166     8121    1        CALL ACCESS ALTRET( ARET );
      167     8122                                                /**/
      168     8123    1        RETURN;
      169     8124                                                /**/
      170     8125        %EJECT;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:7    
      171     8126
      172     8127    1   DUU$TRUNC: ENTRY ALTRET;
      173     8128
      174     8129    2        DO CBX = 0 TO S_D.RCBC.BUFSM1;
      175     8130    2             IF ( S_D.RCBC.PAGE( CBX ) ~= -1 ) AND
      176     8131    2               ( NOT S_D.RCBC.WRITTEN( CBX ) )
      177     8132    3             THEN DO;
      178     8133    3                  S_D.RCBC.WRITTEN( CBX ) = '1'B;
      179     8134    3                  TNODE = S_D.RCBC.NODE( CBX );
      180     8135    3                  CALL DDQ$WRITELM( %TYPPROG, S_D.RCBC.PAGE(CBX), TNODE,
      181     8136    3                    S_D.RCBC.BUF$(CBX), S_D.RCBC.SIZE(CBX) ) ALTRET( NOWREC );
      182     8137    3                END;
      183     8138    2           END;
      184     8139
      185     8140    1        RETURN;
      186     8141
      187     8142    1   NOWREC: ;
      188     8143    1        S_D.RCBC.PAGE( CBX ) = -1;
      189     8144    1        S_D.ERROR = 132;           /* E@NOPROGREC */
      190     8145    1        CALL DDE$ERROR;
      191     8146
      192     8147    1        RETURN;
      193     8148
      194     8149        %EJECT;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:8    
      195     8150                                                /**/
      196     8151    1   ACCESS: PROC ALTRET;
      197     8152                                                /**/
      198     8153    2   DCL BUF$ PTR;
      199     8154    2   DCL TBUF$ PTR;
      200     8155    2   DCL TADDRESS UBIN;
      201     8156    2   DCL TSIZE UBIN;
      202     8157    2   DCL IXX UBIN;
      203     8158    2   DCL PSTART SBIN;
      204     8159    2   DCL PSIZE SBIN;
      205     8160    2   DCL SIZE UBIN;
      206     8161    2   DCL PAGE UBIN;
      207     8162    2   DCL DCB$ PTR;
      208     8163    2   DCL IX UBIN;
      209     8164    2   DCL TEMP$ PTR;
      210     8165    2   DCL UDCB$ PTR;
      211     8166    2   DCL TREEHDR$ PTR;
      212     8167    2   DCL TREE$ PTR;
      213     8168    2   DCL UDCBNUM UBIN;
      214     8169    2   DCL NODENUM UBIN;
      215     8170    2   DCL ROSIZE UBIN;
      216     8171    2   DCL DCBOFF SBIN;
      217     8172    2   DCL DCBPG$ PTR;
      218     8173    2   DCL DCBPGSZ UBIN;
      219     8174    2   DCL PAGE1 UBIN;
      220     8175    2   DCL SEQ UBIN;
      221     8176    2   DCL LRU UBIN;
      222     8177    2   DCL DCB$ADDR$(0:0) PTR BASED ALIGNED;
      223     8178    2   DCL BUF$WORD UBIN BASED ALIGNED;
      224     8179    2   DCL 1 BUF$L6B BASED HALIGNED,
      225     8180    2         2 * BIT(1) UNAL,
      226     8181    2         2 UBYTE UBIN(8) UNAL,
      227     8182    2         2 * BIT(1) UNAL,
      228     8183    2         2 LBYTE UBIN(8) UNAL;
      229     8184    2   DCL 1 DCB$CHAR BASED( DCB$ ) ALIGNED,
      230     8185    2         2 * CHAR( DCBSIZEC ) UNAL;
      231     8186    2   DCL BUF$PTR$ PTR BASED ALIGNED;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:9    
      232     8187    2   DCL 1 PTR$WORD BASED ALIGNED,
      233     8188    2         2 LH UBIN HALF UNAL,
      234     8189    2         2 RH UBIN HALF UNAL,
      235     8190    2         2 RHB REDEF RH,
      236     8191    2           3 * BIT(1) UNAL,
      237     8192    2           3 UBYTE UBIN(8) UNAL,
      238     8193    2           3 * BIT(1) UNAL,
      239     8194    2           3 LBYTE UBIN(8) UNAL;
      240     8195    2   DCL 1 TEMP$WORD ALIGNED,
      241     8196    2         2 * UBIN(20) UNAL,
      242     8197    2         2 UBYTE UBIN(8) UNAL,
      243     8198    2         2 LBYTE UBIN(8) UNAL;
      244     8199    2   DCL TEMPWORD REDEF TEMP$WORD UBIN WORD ALIGNED;
      245     8200    2   DCL L6_DATA_START UBIN WORD CONSTANT INIT(BITBIN('10000'X));
      246     8201                                                /**/
      247     8202    2        IF NOT_IS
      248     8203    2        THEN IF SEG = 5
      249     8204    3             THEN DO;                      /* $DCBn, where n=DESC */
      250     8205    3                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      251     8206    4                  THEN DO;
      252     8207    4                       IF S_D.B$ROS$ = ADDR( NIL )
      253     8208    4                       THEN GOTO NODCBS;
      254     8209    4                       IF DESC > S_D.B$ROS$ -> B$ROSEG.NUMDCBS
      255     8210    4                       THEN GOTO NODCB;
      256     8211    4                       DCB$ = S_D.B$ROS$ -> B$ROSEG.DCBPTR$ -> DCB$ADDR$( DESC );
      257     8212    4                       IF DCB$ = ADDR( NIL )
      258     8213    4                       THEN GOTO NILDCB;
      259     8214    4                       SIZE = SIZEW( DCB$ -> F$DCB );
      260     8215    4                       IF ADDRESS >= SIZE
      261     8216    4                       THEN GOTO NOTINDCB;
      262     8217    4                       BUF$ = PINCRW( DCB$, ADDRESS );
      263     8218    4                       IF READ
      264     8219    4                       THEN VALUE.OPS(0) = BUF$ -> BUF$WORD;
      265     8220    5                       ELSE DO;
      266     8221    5                            IF DCB$ -> F$DCB.DCBNAME.S
      267     8222    6                            THEN DO;       /* Scrub it */
      268     8223    6                                 DCB$CHAR = M$MDCB;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:10   
      269     8224    6                                 DCB$ -> F$DCB.DCBNAME.S = '0'B;
      270     8225    6                               END;
      271     8226    5                            CALL CHKBIRTH ALTRET( NOWBIR );
      272     8227    5                            BUF$ -> BUF$WORD = VALUE.OPS(0);
      273     8228    5                            UDCB$ = PINCRW( S_D.B$ROS$ -> B$ROSEG.DCBPTR$, %M$1STDCB# )
              8228                                     ;
      274     8229    5                            UDCBNUM = S_D.RUM_HEAD$ -> B$HEAD.UDCBNUM;
      275     8230    5                            TREEHDR$ = PINCRW( UDCB$, S_D.RUM_HEAD$ -> B$HEAD.TREEDISP
              8230                                     );
      276     8231    5                            NODENUM = TREEHDR$ -> B$TREEHDR.NODES;
      277     8232    5                            TREE$ = PINCRW( TREEHDR$, SIZEW( B$TREEHDR ) );
      278     8233                                      /* Un-relocate DCB and tree table NAME pointers */
      279     8234    5                            TEMP$ = UDCB$;
      280     8235    6                            DO IX = 1 TO UDCBNUM;
      281     8236    6                                 TEMP$ -> BUF$PTR$ = PINCRW( B$ROS$, POFFW( TEMP$ ->
              8236                                          BUF$PTR$, UDCB$ ) );
      282     8237    6                                 TEMP$ = PINCRW( TEMP$, SIZEW( BUF$PTR$ ) );
      283     8238    6                               END;
      284     8239    5                            TREE$ -> B$NODE.FLGS.NOW_IN( 0 ) = '0'B;
      285     8240    5                            TEMP$ = TREE$;
      286     8241    6                            DO IX = 1 TO NODENUM;
      287     8242    6                                 TEMP$ -> B$NODE.NAME$( 0 ) = PINCRW( B$ROS$, POFFW(
              8242                                          TEMP$ -> B$NODE.NAME$( 0 ), TREEHDR$ ) );
      288     8243    6                                 TEMP$ = PINCRW( TEMP$, SIZEW( B$NODE ) );
      289     8244    6                               END;
      290     8245                                           /* Re-write ROS pages that contain DCB */
      291     8246    5                            ROSIZE = S_D.RUM_HEAD$ -> B$HEAD.ROSIZE;
      292     8247    5                            PSIZE = S_D.RUM_HEAD$ -> B$HEAD.PRECSIZE;
      293     8248    5                            DCBOFF = POFFW( DCB$, UDCB$ );
      294     8249    5                            PAGE = ( DCBOFF / PSIZE ) * PSIZE;
      295     8250    5                            DCBPG$ = PINCRW( UDCB$, PAGE );
      296     8251    5                            DCBPGSZ = ROSIZE - PAGE;
      297     8252    5                            IF DCBPGSZ >= PSIZE
      298     8253    5                            THEN DCBPGSZ = PSIZE;
      299     8254    5                            DCBPGSZ = DCBPGSZ * SIZEC( DCBPGSZ );
      300     8255    5                            IF NOT S_D.RUM_TEST
      301     8256    5                            THEN CALL DDQ$WRITELM( %TYPROS, PAGE, 0, DCBPG$, DCBPGSZ )
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:11   
              8256                                     ALTRET( NOWROS );
      302     8257    5                            PAGE1 = ( ( DCBOFF - 1 + SIZE ) / PSIZE ) * PSIZE;
      303     8258    5                            IF PAGE ~= PAGE1
      304     8259    6                            THEN DO;       /* Update 2nd page */
      305     8260    6                                 DCBPG$ = PINCRW( UDCB$, PAGE1 );
      306     8261    6                                 DCBPGSZ = ROSIZE - PAGE1;
      307     8262    6                                 IF DCBPGSZ >= PSIZE
      308     8263    6                                 THEN DCBPGSZ = PSIZE;
      309     8264    6                                 DCBPGSZ = DCBPGSZ * SIZEC( DCBPGSZ );
      310     8265    6                                 IF NOT S_D.RUM_TEST
      311     8266    6                                 THEN CALL DDQ$WRITELM( %TYPROS, PAGE1, 0, DCBPG$,
              8266                                          DCBPGSZ ) ALTRET( NOWROS );
      312     8267    6                               END;
      313     8268                                      /* Re-relocate DCB and tree table NAME pointers */
      314     8269    5                            TEMP$ = UDCB$;
      315     8270    6                            DO IX = 1 TO UDCBNUM;
      316     8271    6                                 TEMP$ -> BUF$PTR$ = PINCRW( UDCB$, TEMP$ -> PTR$WORD.
              8271                                          LH );
      317     8272    6                                 TEMP$ = PINCRW( TEMP$, SIZEW( BUF$PTR$ ) );
      318     8273    6                               END;
      319     8274    5                            TREE$ -> B$NODE.FLGS.NOW_IN( 0 ) = '1'B;
      320     8275    5                            TEMP$ = TREE$;
      321     8276    6                            DO IX = 1 TO NODENUM;
      322     8277    6                                 TEMP$ -> B$NODE.NAME$( 0 ) = PINCRW( TREEHDR$, TEMP$
              8277                                          -> PTR$WORD.LH );
      323     8278    6                                 TEMP$ = PINCRW( TEMP$, SIZEW( B$NODE ) );
      324     8279    6                               END;
      325     8280    5                          END;
      326     8281    4                     END;
      327     8282    3                  ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      328     8283    4                       THEN DO;
      329     8284    4                            IF S_D.B$ROS$ = ADDR( NIL )
      330     8285    4                            THEN GOTO NODCBS;
      331     8286    4                            IF DESC > S_D.B$ROS$ -> B$ROSEG.NUMDCBS
      332     8287    4                            THEN GOTO NODCB;
      333     8288    4                            DCB$ = S_D.B$ROS$ -> B$ROSEG.DCBPTR$ -> DCB$ADDR$( DESC );
      334     8289    4                            IF DCB$ = ADDR( NIL )
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:12   
      335     8290    4                            THEN GOTO NILDCB;
      336     8291    4                            SIZE = %L6_DCB_DCBNAME#;
      337     8292    4                            IF ADDRESS >= SIZE
      338     8293    4                            THEN GOTO NOTINDCB;
      339     8294    4                            BUF$ = PINCRC( DCB$, ADDRESS * 2 );
      340     8295    4                            IF READ
      341     8296    5                            THEN DO;
      342     8297    5                                 TBUF$ = BUF$;
      343     8298    6                                 DO IX = 0 TO 15;
      344     8299    6                                      VALUE.OPS(IX) = 0;
      345     8300    6                                      VALUE.OPSB.UBYTE(IX) = TBUF$ -> BUF$L6B.UBYTE;
      346     8301    6                                      VALUE.OPSB.LBYTE(IX) = TBUF$ -> BUF$L6B.LBYTE;
      347     8302    6                                      TBUF$ = PINCRC(TBUF$, 2);
      348     8303    6                                    END;
      349     8304    5                                 VALUE.SIZE = 16;
      350     8305    5                               END;
      351     8306    5                            ELSE DO;
      352     8307    5                                 CALL CHKBIRTH ALTRET( NOWBIR );
      353     8308    5                                 TBUF$ = BUF$;
      354     8309    6                                 DO IX = 0 TO VALUE.SIZE;
      355     8310    6                                      TBUF$ -> BUF$L6B = '0'B;
      356     8311    6                                      TBUF$ -> BUF$L6B.UBYTE = VALUE.OPSB.UBYTE(IX);
      357     8312    6                                      TBUF$ -> BUF$L6B.LBYTE = VALUE.OPSB.LBYTE(IX);
      358     8313    6                                      TBUF$ = PINCRC(TBUF$, 2);
      359     8314    6                                    END;
      360     8315    5                                 UDCB$ = PINCRW( S_D.B$ROS$ -> B$ROSEG.DCBPTR$, %
              8315                                          G_FRST_USR_DCB# );
      361     8316                                      /* Un-relocate DCB and tree table NAME pointers */
      362     8317    5                                 TEMP$ = UDCB$;
      363     8318    6                                 DO IX = 1 TO UDCBNUM;
      364     8319    6                                      TEMP$ -> BUF$PTR$ = PINCRW( B$ROS$, POFFC( TEMP$
              8319                                               -> BUF$PTR$, UDCB$ ) / 2 );
      365     8320    6                                      TEMP$ = PINCRW( TEMP$, SIZEW( BUF$PTR$ ) );
      366     8321    6                                    END;
      367     8322                                           /* Re-write ROS pages that contain DCB */
      368     8323    5                                 ROSIZE = S_D.RUM_HEAD$ -> B$HEAD.ROSIZE;
      369     8324    5                                 PSIZE = S_D.RUM_HEAD$ -> B$HEAD.PRECSIZE;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:13   
      370     8325    5                                 DCBOFF = POFFC( DCB$, UDCB$ ) / 2;
      371     8326    5                                 PAGE = ( DCBOFF / PSIZE ) * PSIZE;
      372     8327    5                                 DCBPG$ = PINCRC( UDCB$, PAGE * 2 );
      373     8328    5                                 DCBPGSZ = ROSIZE - PAGE;
      374     8329    5                                 IF DCBPGSZ >= PSIZE
      375     8330    5                                 THEN DCBPGSZ = PSIZE;
      376     8331    5                                 DCBPGSZ = DCBPGSZ * 2;
      377     8332    5                                 IF NOT S_D.RUM_TEST
      378     8333    5                                 THEN CALL DDQ$WRITELM( %TYPPROG, PAGE + BITBIN('1000'X
              8333                                          ), 0, DCBPG$, DCBPGSZ ) ALTRET( NOWROS );
      379     8334    5                                 PAGE1 = ( ( DCBOFF - 1 + SIZE ) / PSIZE ) * PSIZE;
      380     8335    5                                 IF PAGE ~= PAGE1
      381     8336    6                                 THEN DO;  /* Update 2nd page */
      382     8337    6                                      DCBPG$ = PINCRC( UDCB$, PAGE1 * 2 );
      383     8338    6                                      DCBPGSZ = ROSIZE - PAGE1;
      384     8339    6                                      IF DCBPGSZ >= PSIZE
      385     8340    6                                      THEN DCBPGSZ = PSIZE;
      386     8341    6                                      DCBPGSZ = DCBPGSZ * 2;
      387     8342    6                                      IF NOT S_D.RUM_TEST
      388     8343    6                                      THEN CALL DDQ$WRITELM( %TYPPROG, PAGE1 + BITBIN(
              8343                                               '1000'X), 0, DCBPG$, DCBPGSZ ) ALTRET( NOWROS
              8343                                               );
      389     8344    6                                    END;
      390     8345                                      /* Re-relocate DCB and tree table NAME pointers */
      391     8346    5                                 TEMP$ = UDCB$;
      392     8347    6                                 DO IX = 1 TO UDCBNUM;
      393     8348    6                                      TEMP$WORD.UBYTE = TEMP$ -> PTR$WORD.RHB.UBYTE;
      394     8349    6                                      TEMP$WORD.LBYTE = TEMP$ -> PTR$WORD.RHB.LBYTE;
      395     8350    6                                      TEMP$ -> BUF$PTR$ = PINCRC( UDCB$, TEMPWORD * 2 )
              8350                                               ;
      396     8351    6                                      TEMP$ = PINCRW( TEMP$, SIZEW( BUF$PTR$ ) );
      397     8352    6                                    END;
      398     8353    5                               END;
      399     8354    4                          END;
      400     8355    3                       ELSE GOTO DELBUG;
      401     8356    3                END;                       /* $DCBn */
      402     8357    2             ELSE IF SEG = 7
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:14   
      403     8358    3                  THEN DO;                 /* HEAD record fields */
      404     8359    3                       IF NOT READ
      405     8360    4                       THEN DO;
      406     8361    4                            CALL CHKBIRTH ALTRET( NOWBIR );
      407     8362    4                            VALUE.SIZE = 1;
      408     8363    4                          END;
      409     8364    4                       DO CASE ( DESC );
      410     8365    4                         CASE ( 0 );       /* $SA */
      411     8366    4                            IF ADDRESS > 0
      412     8367    4                            THEN ALTRETURN;
      413     8368    4                            IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      414     8369    5                            THEN DO;
      415     8370    5                                 IF READ
      416     8371    5                                 THEN VALUE.OPS(0) = S_D.RUM_HEAD$ -> B$HEAD.START;
      417     8372    5                                 ELSE S_D.RUM_HEAD$ -> B$HEAD.START = VALUE.OPS(0);
      418     8373    5                                 VALUE.SIZE = 1;
      419     8374    5                               END;
      420     8375    5                            ELSE DO;
      421     8376    5                                 IF READ
      422     8377    6                                 THEN DO;
      423     8378    6                                      NWORD_L6V = S_D.RUM_HEAD$ -> B$HEAD.START;
      424     8379    6                                      VALUE.OPS(0) = NWORD_L6.ADDR1;
      425     8380    6                                      VALUE.OPS(1) = NWORD_L6.ADDR2;
      426     8381    6                                      VALUE.SIZE = 2;
      427     8382    6                                    END;
      428     8383    6                                 ELSE DO;
      429     8384    6                                      NWORD_L6V = 0;
      430     8385    6                                      NWORD_L6.ADDR1 = VALUE.OPS(0);
      431     8386    6                                      NWORD_L6.ADDR2 = VALUE.OPS(1);
      432     8387    6                                      S_D.RUM_HEAD$ -> B$HEAD.START = NWORD_L6V;
      433     8388    6                                      VALUE.SIZE = 1;
      434     8389    6                                    END;
      435     8390    5                               END;
      436     8391    4                         CASE ( 1 );       /* $PRIV */
      437     8392    4                            IF ADDRESS > 0
      438     8393    4                            THEN ALTRETURN;
      439     8394    4                            IF READ
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:15   
      440     8395    4                            THEN VALUE.OPSBITS(0) = S_D.RUM_HEAD$ -> B$HEAD.PRIV;
      441     8396    4                            ELSE S_D.RUM_HEAD$ -> B$HEAD.PRIV = VALUE.OPSBITS(0);
      442     8397    4                            VALUE.SIZE = 1;
      443     8398    4                         CASE ( 2 );       /* $HEAD */
      444     8399    4                            IF ADDRESS >= SIZEW( B$HEAD )
      445     8400    4                            THEN GOTO NOTINHEAD;
      446     8401    4                            BUF$ = PINCRW( S_D.RUM_HEAD$, ADDRESS );
      447     8402    4                            IF READ
      448     8403    4                            THEN VALUE.OPS(0) = BUF$ -> BUF$WORD;
      449     8404    4                            ELSE BUF$ -> BUF$WORD = VALUE.OPS(0);
      450     8405    4                            VALUE.SIZE = 1;
      451     8406    4                         CASE ( ELSE );
      452     8407    4                            GOTO DELBUG;
      453     8408    4                         END;              /* "DO CASE ( DESC ) */
      454     8409    3                       IF NOT READ AND NOT S_D.RUM_TEST
      455     8410    3                       THEN CALL DDQ$WRITELM( %TYPHEAD, 0, 0, S_D.RUM_HEAD$, LENGTHC(
              8410                                B$HEAD ) ) ALTRET( NOWWH );
      456     8411    3                     END;                  /* HEAD record fields */
      457     8412    2                  ELSE GOTO NOTINRUM;
      458     8413    3        ELSE DO;
      459     8414    3             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST OR
      460     8415    3               (S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6 AND
      461     8416    3               ((((ADDRESS + VSIZE) / S_D.RCBC.BUFSIZE) * S_D.RCBC.BUFSIZE) =
      462     8417    3               ((ADDRESS / S_D.RCBC.BUFSIZE) * S_D.RCBC.BUFSIZE)))
      463     8418    4             THEN DO;
      464     8419    4   ONE_WORD:
      465     8420    4                  IF S_D.OVERLAID
      466     8421    5                  THEN DO;
      467     8422    5                       BUF$ = PINCRW( S_D.B$TREE$, SIZEW( B$NODE ) * NODE );
      468     8423    5                       IF ADDRESS < S_D.PADDR
      469     8424    6                       THEN DO;
      470     8425    6                            PSTART = BUF$ -> B$NODE.DADDR( 0 );
      471     8426    6                            PSIZE = BUF$ -> B$NODE.DSIZE( 0 );
      472     8427    6                          END;
      473     8428    6                       ELSE DO;
      474     8429    6                            PSTART = BUF$ -> B$NODE.PADDR( 0 );
      475     8430    6                            PSIZE = BUF$ -> B$NODE.PSIZE( 0 );
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:16   
      476     8431    6                          END;
      477     8432    5                     END;
      478     8433    5                  ELSE DO;
      479     8434    5                       IF ADDRESS < S_D.PADDR
      480     8435    6                       THEN DO;
      481     8436    6                            IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      482     8437    6                            THEN PSTART = S_D.RUM_HEAD$ -> B$HEAD.BIAS;
      483     8438    6                            ELSE PSTART = L6_DATA_START;
      484     8439    6                            PSIZE = S_D.RUM_HEAD$ -> B$HEAD.RDATA;
      485     8440    6                          END;
      486     8441    6                       ELSE DO;
      487     8442    6                            PSTART = S_D.PADDR;
      488     8443    6                            PSIZE = S_D.RUM_HEAD$ -> B$HEAD.RPROC;
      489     8444    6                          END;
      490     8445    5                     END;
      491     8446    4                  IF (ADDRESS < 0 OR ADDRESS >= PSTART + PSIZE) AND NOT S_D.RUM_FEP
      492     8447    5                  THEN DO;
      493     8448    5                       S_D.ERROR = 131; /* E@NOTYOURS */
      494     8449    5                       IF S_D.FIND_RUM
      495     8450    5                       THEN S_D.ERROR = 131; /* E@NOTYOURS */
      496     8451    5                       GOTO ARET;
      497     8452    5                     END;
      498     8453    4                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      499     8454    5                  THEN DO;
      500     8455    5                       PAGE = ( ( PSTART / S_D.RCBC.BUFSIZE ) * S_D.RCBC.BUFSIZE )
      501     8456    5                         + S_D.RCBC.BUFSIZE;
      502     8457    5                       IF ADDRESS < PAGE
      503     8458    5                       THEN PAGE = PSTART;
      504     8459    5                       ELSE PAGE = ( ADDRESS / S_D.RCBC.BUFSIZE ) * S_D.RCBC.BUFSIZE;
      505     8460    5                     END;
      506     8461    5                  ELSE DO;
      507     8462    5                       PAGE = (ADDRESS / 2048) * 2048;
      508     8463    5                     END;
      509     8464    4                  LRU = 0;
      510     8465    4                  SEQ = S_D.RCBC.SEQ( 0 );
      511     8466    4                  S_D.RCBC.CUR_SEQ = S_D.RCBC.CUR_SEQ + 1;
      512     8467    5                  DO CBX = 0 TO S_D.RCBC.BUFSM1;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:17   
      513     8468    5                       IF ( S_D.RCBC.PAGE( CBX ) = PAGE ) AND
      514     8469    5                         ( S_D.RCBC.NODE( CBX ) = NODE )
      515     8470    5                       THEN GOTO INBUF;
      516     8471    5                       IF S_D.RCBC.SEQ( CBX ) < SEQ
      517     8472    6                       THEN DO;
      518     8473    6                            LRU = CBX;
      519     8474    6                            SEQ = S_D.RCBC.SEQ( CBX );
      520     8475    6                          END;
      521     8476    5                     END;
      522     8477    4                  CBX = LRU;
      523     8478    4                  IF NOT S_D.RCBC.WRITTEN( CBX ) AND
      524     8479    4                    S_D.RCBC.PAGE( CBX ) ~= -1
      525     8480    5                  THEN DO;
      526     8481    5                       TNODE = S_D.RCBC.NODE( CBX );
      527     8482    5                       CALL DDQ$WRITELM( %TYPPROG, S_D.RCBC.PAGE(CBX), TNODE,
      528     8483    5                         S_D.RCBC.BUF$(CBX), S_D.RCBC.SIZE(CBX) ) ALTRET( NOWREC );
      529     8484    5                     END;
      530     8485    4                  SIZE = S_D.RCBC.BUFSIZE * SIZEC( SIZE );
      531     8486    4                  S_D.RCBC.SIZE( CBX ) = 0; /* Positive */
      532     8487    4                  CALL DDQ$READLM( %TYPPROG, PAGE, NODE, S_D.RCBC.BUF$(CBX), SIZE, S_D.
              8487                           RCBC.SIZE(CBX) ) ALTRET( NORREC );
      533     8488    4                  S_D.RCBC.PAGE( CBX ) = PAGE;
      534     8489    4                  S_D.RCBC.NODE( CBX ) = NODE;
      535     8490    4                  S_D.RCBC.WRITTEN( CBX ) = '1'B;
      536     8491    4   INBUF:         ;
      537     8492    4                  S_D.RCBC.SEQ( CBX ) = S_D.RCBC.CUR_SEQ;
      538     8493    4                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      539     8494    4                  THEN BUF$ = PINCRW( S_D.RCBC.BUF$(CBX), ADDRESS - PAGE );
      540     8495    4                  ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      541     8496    4                       THEN BUF$ = PINCRC(S_D.RCBC.BUF$(CBX), (ADDRESS - PAGE) * 2);
      542     8497    4                       ELSE GOTO DELBUG;
      543     8498    4                  IF READ
      544     8499    5                  THEN DO;
      545     8500    5                       IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      546     8501    6                       THEN DO;
      547     8502    6                            VALUE.SIZE = 1;
      548     8503    6                            VALUE.OPS(0) = BUF$ -> BUF$WORD;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:18   
      549     8504    6                          END;
      550     8505    6                       ELSE DO;
      551     8506    6                            TBUF$ = BUF$;
      552     8507    7                            DO IX = 0 TO 15;
      553     8508    7                                 VALUE.OPS(IX) = 0;
      554     8509    7                                 VALUE.OPSB.UBYTE(IX) = TBUF$ -> BUF$L6B.UBYTE;
      555     8510    7                                 VALUE.OPSB.LBYTE(IX) = TBUF$ -> BUF$L6B.LBYTE;
      556     8511    7                                 TBUF$ = PINCRC(TBUF$, 2);
      557     8512    7                               END;
      558     8513    6                            VALUE.SIZE = 16;
      559     8514    6                          END;
      560     8515    5                     END;
      561     8516    5                  ELSE DO;
      562     8517    5                       CALL CHKBIRTH ALTRET( NOWBIR );
      563     8518    5                       IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      564     8519    5                       THEN BUF$ -> BUF$WORD = VALUE.OPS(0);
      565     8520    6                       ELSE DO;
      566     8521    6                            TBUF$ = BUF$;
      567     8522    7                            DO IX = 0 TO VALUE.SIZE - 1;
      568     8523    7                                 TBUF$ -> BUF$L6B = '0'B;
      569     8524    7                                 TBUF$ -> BUF$L6B.UBYTE = VALUE.OPSB.UBYTE(IX);
      570     8525    7                                 TBUF$ -> BUF$L6B.LBYTE = VALUE.OPSB.LBYTE(IX);
      571     8526    7                                 TBUF$ = PINCRC(TBUF$, 2);
      572     8527    7                               END;
      573     8528    6                          END;
      574     8529    5                       IF NOT S_D.RUM_TEST
      575     8530    5                       THEN IF S_D.RCBC.WRITE_THRU
      576     8531    6                            THEN DO;
      577     8532    6                                 S_D.RCBC.WRITTEN( CBX ) = '1'B;
      578     8533    6                                 CALL DDQ$WRITELM( %TYPPROG, PAGE, NODE, S_D.RCBC.BUF$(
              8533                                          CBX), S_D.RCBC.SIZE(CBX) ) ALTRET( NOWREC );
      579     8534    6                               END;
      580     8535    5                            ELSE S_D.RCBC.WRITTEN( CBX ) ='0'B;
      581     8536    5                     END;
      582     8537    4                END;
      583     8538    4             ELSE DO;
      584     8539    4                  TADDRESS = ADDRESS;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:19   
      585     8540    4                  IF READ
      586     8541    4                  THEN TSIZE = 16;
      587     8542    4                  ELSE TSIZE = VALUE.SIZE;
      588     8543    5                  DO IXX = 0 TO TSIZE - 1;
      589     8544    5                       IF S_D.OVERLAID
      590     8545    6                       THEN DO;
      591     8546    6                            BUF$ = PINCRW( S_D.B$TREE$, SIZEW( B$NODE ) * NODE );
      592     8547    6                            IF TADDRESS < S_D.PADDR
      593     8548    7                            THEN DO;
      594     8549    7                                 PSTART = BUF$ -> B$NODE.DADDR( 0 );
      595     8550    7                                 PSIZE = BUF$ -> B$NODE.DSIZE( 0 );
      596     8551    7                               END;
      597     8552    7                            ELSE DO;
      598     8553    7                                 PSTART = BUF$ -> B$NODE.PADDR( 0 );
      599     8554    7                                 PSIZE = BUF$ -> B$NODE.PSIZE( 0 );
      600     8555    7                               END;
      601     8556    6                          END;
      602     8557    6                       ELSE DO;
      603     8558    6                            IF TADDRESS < S_D.PADDR
      604     8559    7                            THEN DO;
      605     8560    7                                 PSTART = L6_DATA_START;
      606     8561    7                                 PSIZE = S_D.RUM_HEAD$ -> B$HEAD.RDATA;
      607     8562    7                               END;
      608     8563    7                            ELSE DO;
      609     8564    7                                 PSTART = S_D.PADDR;
      610     8565    7                                 PSIZE = S_D.RUM_HEAD$ -> B$HEAD.RPROC;
      611     8566    7                               END;
      612     8567    6                          END;
      613     8568    5                       IF TADDRESS >= PSTART + PSIZE AND NOT S_D.RUM_FEP
      614     8569    6                       THEN DO;
      615     8570    6                            IF IXX > 0
      616     8571    6                            THEN GOTO ONE_WORD;
      617     8572    6                            S_D.ERROR = 131; /* E@NOTYOURS */
      618     8573    6                            IF S_D.FIND_RUM
      619     8574    6                            THEN S_D.ERROR = 131; /* E@NOTYOURS */
      620     8575    6                            GOTO ARET;
      621     8576    6                          END;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:20   
      622     8577    5                       PAGE = (TADDRESS / 2048) * 2048;
      623     8578    5                       LRU = 0;
      624     8579    5                       SEQ = S_D.RCBC.SEQ( 0 );
      625     8580    5                       S_D.RCBC.CUR_SEQ = S_D.RCBC.CUR_SEQ + 1;
      626     8581    6                       DO CBX = 0 TO S_D.RCBC.BUFSM1;
      627     8582    6                            IF ( S_D.RCBC.PAGE( CBX ) = PAGE ) AND
      628     8583    6                              ( S_D.RCBC.NODE( CBX ) = NODE )
      629     8584    6                            THEN GOTO INBUF1;
      630     8585    6                            IF S_D.RCBC.SEQ( CBX ) < SEQ
      631     8586    7                            THEN DO;
      632     8587    7                                 LRU = CBX;
      633     8588    7                                 SEQ = S_D.RCBC.SEQ( CBX );
      634     8589    7                               END;
      635     8590    6                          END;
      636     8591    5                       CBX = LRU;
      637     8592    5                       IF NOT S_D.RCBC.WRITTEN( CBX ) AND
      638     8593    5                         S_D.RCBC.PAGE( CBX ) ~= -1
      639     8594    6                       THEN DO;
      640     8595    6                            TNODE = S_D.RCBC.NODE( CBX );
      641     8596    6                            CALL DDQ$WRITELM( %TYPPROG, S_D.RCBC.PAGE(CBX), TNODE,
      642     8597    6                              S_D.RCBC.BUF$(CBX), S_D.RCBC.SIZE(CBX) ) ALTRET( NOWREC )
              8597                                       ;
      643     8598    6                          END;
      644     8599    5                       SIZE = S_D.RCBC.BUFSIZE * SIZEC( SIZE );
      645     8600    5                       S_D.RCBC.SIZE( CBX ) = 0; /* Positive */
      646     8601    5                       CALL DDQ$READLM( %TYPPROG, PAGE, NODE, S_D.RCBC.BUF$(CBX), SIZE,
              8601                                S_D.RCBC.SIZE(CBX) ) ALTRET( NORREC );
      647     8602    5                       S_D.RCBC.PAGE( CBX ) = PAGE;
      648     8603    5                       S_D.RCBC.NODE( CBX ) = NODE;
      649     8604    5                       S_D.RCBC.WRITTEN( CBX ) = '1'B;
      650     8605    5   INBUF1:             ;
      651     8606    5                       S_D.RCBC.SEQ( CBX ) = S_D.RCBC.CUR_SEQ;
      652     8607    5                       BUF$ = PINCRC( S_D.RCBC.BUF$(CBX), (TADDRESS - PAGE) * 2);
      653     8608    5                       IF READ
      654     8609    6                       THEN DO;
      655     8610    6                            VALUE.OPS(IXX) = 0;
      656     8611    6                            VALUE.OPSB.UBYTE(IXX) = BUF$ -> BUF$L6B.UBYTE;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:21   
      657     8612    6                            VALUE.OPSB.LBYTE(IXX) = BUF$ -> BUF$L6B.LBYTE;
      658     8613    6                          END;
      659     8614    6                       ELSE DO;
      660     8615    6                            CALL CHKBIRTH ALTRET( NOWBIR );
      661     8616    6                            BUF$ -> BUF$L6B = '0'B;
      662     8617    6                            BUF$ -> BUF$L6B.UBYTE = VALUE.OPSB.UBYTE(IXX);
      663     8618    6                            BUF$ -> BUF$L6B.LBYTE = VALUE.OPSB.LBYTE(IXX);
      664     8619    6                            IF NOT S_D.RUM_TEST
      665     8620    6                            THEN IF S_D.RCBC.WRITE_THRU
      666     8621    7                                 THEN DO;
      667     8622    7                                      S_D.RCBC.WRITTEN( CBX ) = '1'B;
      668     8623    7                                      CALL DDQ$WRITELM( %TYPPROG, PAGE, NODE, S_D.RCBC.
              8623                                               BUF$(CBX), S_D.RCBC.SIZE(CBX) ) ALTRET(
              8623                                               NOWREC );
      669     8624    7                                    END;
      670     8625    6                                 ELSE S_D.RCBC.WRITTEN( CBX ) ='0'B;
      671     8626    6                          END;
      672     8627    5                       TADDRESS = TADDRESS + 1;
      673     8628    5                     END;
      674     8629    4                  IF READ
      675     8630    4                  THEN VALUE.SIZE = 16;
      676     8631    4                END;
      677     8632    3           END;
      678     8633    2        RETURN;
      679     8634                                                /**/
      680     8635    2   NORREC: ;
      681     8636    2   NOWREC: ;
      682     8637    2        S_D.RCBC.PAGE( CBX ) = -1;
      683     8638    2        S_D.ERROR = 132;           /* E@NOPROGREC */
      684     8639    2        GOTO ARET;
      685     8640
      686     8641    2   NOWBIR: ;
      687     8642    2        S_D.ERROR = 194;            /* E@NOWBIRTH */
      688     8643    2        GOTO ARET;
      689     8644
      690     8645    2   NOWWH: ;
      691     8646    2        S_D.ERROR = 203;             /* E@NOWHEAD */
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:22   
      692     8647    2        GOTO ARET;
      693     8648
      694     8649    2   NOWROS: ;
      695     8650    2        S_D.ERROR = 204;              /* E@NOWROS */
      696     8651    2        GOTO ARET;
      697     8652
      698     8653    2   NODCBS: ;
      699     8654    2        S_D.ERROR = 130;             /* E@WARNROS */
      700     8655    2        GOTO ARET;
      701     8656
      702     8657    2   NODCB: ;
      703     8658    2        S_D.ERROR = 183;               /* E@NODCB */
      704     8659    2        GOTO ARET;
      705     8660
      706     8661    2   NOTINDCB: ;
      707     8662    2        S_D.ERROR = 209;             /* E@DCBOUND */
      708     8663    2        GOTO ARET;
      709     8664
      710     8665    2   NOTINHEAD: ;
      711     8666    2        S_D.ERROR = 213;              /* E@NIHEAD */
      712     8667    2        GOTO ARET;
      713     8668
      714     8669    2   NOTINRUM: ;
      715     8670    2        S_D.ERROR = 232;             /* E@NOSSRUM */
      716     8671    2        GOTO ARET;
      717     8672
      718     8673    2   NILDCB: ;
      719     8674    2        S_D.ERROR = 184;              /* E@DCBNIL */
      720     8675    2        GOTO ARET;
      721     8676
      722     8677    2   DELBUG: ;
      723     8678    2        S_D.ERROR = 502;              /* E@DELBUG */
      724     8679    2        CALL DDE$ERROR;
      725     8680        /****GOTO ARET;****/
      726     8681                                                /**/
      727     8682    2   ARET: ;
      728     8683    2        ALTRETURN;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:23   
      729     8684        %EJECT;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:24   
      730     8685                                                /**/
      731     8686    2   CHKBIRTH: PROC ALTRET;
      732     8687                                                /**/
      733     8688    3        IF ( S_D.RUMSEQ = 0 ) AND ( S_D.RUM_BIRTH$ ~= ADDR( NIL ) ) AND (NOT S_D.
              8688                 RUM_TEST)
      734     8689    4        THEN DO;
      735     8690    4             S_D.RUM_BIRTH$ -> B$RUBIRTH.RUMED_UTS = S_D.RUMUTS;
      736     8691    4             S_D.RUM_BIRTH$ -> B$RUBIRTH.COUNT = S_D.RUM_BIRTH$ -> B$RUBIRTH.COUNT + 1;
      737     8692    4             CALL DDQ$WRITELM( %TYPBIRTH, 0, 0, S_D.RUM_BIRTH$, SIZEC( B$RUBIRTH ) )
              8692                      ALTRET( ARET );
      738     8693    4           END;
      739     8694                                                /**/
      740     8695    3        RETURN;
      741     8696                                                /**/
      742     8697    3   ARET: ;
      743     8698    3        ALTRETURN;
      744     8699                                                /**/
      745     8700    3   END CHKBIRTH;
      746     8701                                                /**/
      747     8702    2   END ACCESS;
      748     8703                                                /**/
      749     8704    1   END DUU$GETMVAL;

PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:25   
--  Include file information  --

   GF_DCB_E.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   F_DCB_D.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DUU$GETMVAL.

   Procedure DUU$GETMVAL requires 1456 words for executable code.
   Procedure DUU$GETMVAL requires 48 words of local(AUTO) storage.

    No errors detected in file DUU$GETMVAL.:E05TSI    .

PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:26   

 Object Unit name= DUU$GETMVAL                                File name= DUU$GETMVAL.:E05TOU
 UTS= JUL 29 '97 15:02:53.60 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     98    142  DUU$GETMVAL
    1   Proc  even  none  1456   2660  DUU$GETMVAL
    2  RoData even  none    18     22  DUU$GETMVAL

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        6  DUU$GETMVAL
     1     12          yes     yes      Std        6  DUU$PUTMVAL
     1     31          yes     yes      Std        0  DUU$TRUNC

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       5 DDQ$WRITELM
         yes           Std       0 DDE$ERROR
 yes     yes           Std       7 DDQ$READLM
                       nStd      0 X66_AUTO_N
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
                       Std       0 B_CONSPOOL_D
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:27   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$ROS$                           r    S_D$                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:28   


        1        1        /*M* DUU$GETMVAL Access RU program records for User DELTA */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*P* NAME: DUU$GETMVAL
       10       10             PURPOSE: This module contains routines to access the program
       11       11                      image from the RU file, rather than from memory.
       12       12             DESCRIPTION: This module contains routines to access the program
       13       13                          image from the RU file currently being RUMed. The buffer
       14       14                          pointed to by S_D.PROG_BUF$ is used to read/write the
       15       15                          programs records. */
       16       16        %EJECT;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:29   
       17       17        /*F* NAME: DUU$GETMVAL
       18       18             PURPOSE: To obtain the specified word from the RU file.
       19       19             DESCRIPTION: A cache controlled by S_D.RCBC structure is used to access
       20       20                          the program records. The desired program record is
       21       21                          determined from the input parameters. If the record
       22       22                          is already in memory then the desired value is obtained
       23       23                          from it. Otherwise, the desired program record is read
       24       24                          into the program record buffer, and then its value is
       25       25                          obtained. Note that the HEAD record, and the read-only-
       26       26                          segment records are always in memory, having been setup
       27       27                          at RUM command time. */
       28       28        /*D* NAME: DUU$GETMVAL
       29       29             ENTRY: DUU$GETMVAL
       30       30             CALL: CALL DUU$GETMVAL(VALUE, NODE, ADDRESS, SEG, DESC, NOT_IS) ALTRET(err);
       31       31             INPUT: NODE - Overlay node number.
       32       32                    ADDRESS - Address in ISR or offset requested.
       33       33                    SEG - Meaningful only if NOT_IS.
       34       34                          5 - $DCBn.
       35       35                              DESC=n.
       36       36                          7 - HEAD record.
       37       37                              DESC=0, $SA.
       38       38                              DESC=1, $PRIV.
       39       39                              DESC=2, $HEAD.
       40       40                    DESC - Function of SEG.
       41       41             OUTPUT: VALUE - Value of word at requested address.
       42       42             SCRATCH: Local AUTO only.
       43       43             DESCRIPTION: A cache controlled by S_D.RCBC structure is used to access
       44       44                          the program records. The desired program record is
       45       45                          determined from the input parameters. If the record
       46       46                          is already in memory then the desired value is obtained
       47       47                          from it. Otherwise, the desired program record is read
       48       48                          into the program record buffer, and then its value is
       49       49                          obtained. Note that the HEAD record, and the read-only-
       50       50                          segment records are always in memory, having been setup
       51       51                          at RUM command time. RETURNs if successful, else ALTRETURNs */
       52       52                                                /**/
       53       53        DUU$GETMVAL: PROC( VALUE, NODE, ADDRESS, SEG, DESC, NOT_IS ) ALTRET;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:30   

     53  1 000000   000000 700200 xent  DUU$GETMVAL  TSX0  ! X66_AUTO_N
         1 000001   000060 000006                    ZERO    48,6

       54       54                                                /**/
       55       55        /* Parm */
       56       56    1   DCL 1 VALUE ALIGNED,
       57       57    1         2 SIZE UBIN,
       58       58    1         2 OPS(0:15) UBIN,
       59       59    1         2 OPSB(0:15) REDEF OPS,
       60       60    1           3 * UBIN(20) UNAL,
       61       61    1           3 UBYTE UBIN(8) UNAL,
       62       62    1           3 LBYTE UBIN(8) UNAL,
       63       63    1         2 OPSBITS(0:15) REDEF OPS BIT(36);
       64       64    1   DCL NODE UBIN;
       65       65    1   DCL ADDRESS SBIN;
       66       66    1   DCL SEG UBIN;
       67       67    1   DCL DESC UBIN;
       68       68    1   DCL NOT_IS BIT(1) ALIGNED;
       69       69        /* Auto */
       70       70    1   DCL READ BIT(1) ALIGNED;
       71       71    1   DCL CBX UBIN;
       72       72    1   DCL TNODE UBIN;
       73       73    1   DCL VSIZE UBIN;
       74       74    1   DCL 1 NWORD_L6 ALIGNED,
       75       75    1         2 * UBIN(16) UNAL,
       76       76    1         2 ADDR1 UBIN(4) UNAL,
       77       77    1         2 ADDR2 UBIN(16) UNAL;
       78       78    1   DCL NWORD_L6V REDEF NWORD_L6 UBIN(36) ALIGNED;
       79       79        /* Based */
       80       80        %INCLUDE B$OBJECT_C;
       81     3510        %B$HEAD;
       82     3710        %B$TREE_TABLE (HDR_NAME=B$TREEHDR,NODE_NAME="B$NODE(0:0)");
       83     3768        %B$RUBIRTH (STCLASS=BASED,
       84     3769                    COUNTINIT=);
       85     3778        %INCLUDE B$ROSEG;
       86     3841        %INCLUDE F$DCB;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:31   
       87     3890        /* Constant */
       88     3891        %INCLUDE F_DCB_D;
       89     3979        %M$MDCB (DCBN=M$MDCB,
       90     3980                 STCLASS=CONSTANT);
       91     4054    1   DCL DCBSIZEC UBIN CONSTANT INIT( SIZEC( M$MDCB ) );
       92     4055        /* Symref */
       93     4056    1   DCL B$ROS$ PTR SYMREF;
       94     4057        /* DELTA's "Static" data */
       95     4058        %INCLUDE XUH_MACRO_C;
       96     4142        %INCLUDE DD_SD_M;
       97     5478        %S_D;
       98     6796        /* Entry */
       99     6797    1   DCL DDE$ERROR ENTRY;
      100     6798    1   DCL DDQ$READLM ENTRY(7) ALTRET;
      101     6799    1   DCL DDQ$WRITELM ENTRY(5) ALTRET;
      102     6800        /* Misc */
      103     6801        %B$RECORDSUBS;
      104     6829        %INCLUDE DD_ERR_C;
      105     7226        %INCLUDE CP_6_SUBS;
      106     7766        %INCLUDE G_LCP6_E;
      107     8024        %INCLUDE GF_DCB_E;
      108     8063                                                /**/
      109     8064    1        READ = '1'B;

   8064  1 000002   400000 236003                    LDQ     -131072,DU
         1 000003   200011 756100                    STQ     READ,,AUTO

      110     8065    1        VSIZE = 16;

   8065  1 000004   000020 235007                    LDA     16,DL
         1 000005   200014 755100                    STA     VSIZE,,AUTO

      111     8066    1        CALL ACCESS ALTRET( ARET );

   8066  1 000006   000130 701000 1                  TSX1    ACCESS
         1 000007   000011 702000 1                  TSX2    ARET

PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:32   
      112     8067                                                /**/
      113     8068    1        RETURN;

   8068  1 000010   000000 702200 xent               TSX2  ! X66_ARET

      114     8069                                                /**/
      115     8070    1   ARET:
      116     8071    1        ALTRETURN;

   8071  1 000011   000000 702200 xent  ARET         TSX2  ! X66_AALT

      117     8072                                                /**/
      118     8073        %EJECT;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:33   
      119     8074        /*F* NAME: DUU$PUTMVAL
      120     8075             PURPOSE: To obtain and update the specified word from the RU file.
      121     8076             DESCRIPTION: A cache controlled by S_D.RCBC structure is used to access
      122     8077                          the program records. The desired program record is
      123     8078                          determined from the input parameters. If the record
      124     8079                          is already in memory then the desired value is updated
      125     8080                          into it. Otherwise, the desired program record is read
      126     8081                          into the program record buffer, and then its value is
      127     8082                          updated. Note that the HEAD record, and the read-only-
      128     8083                          segment records are always in memory, having been setup
      129     8084                          at RUM command time. */
      130     8085        /*D* NAME: DUU$PUTMVAL
      131     8086             ENTRY: DUU$PUTMVAL
      132     8087             CALL: CALL DUU$PUTMVAL(VALUE, NODE, ADDRESS, SEG, DESC, NOT_IS) ALTRET(err);
      133     8088             INPUT: VALUE - Value to be updated into ADDRESS.
      134     8089                    NODE - Overlay node number.
      135     8090                    ADDRESS - Address in ISR or offset requested.
      136     8091                    SEG - Meaningful only if NOT_IS.
      137     8092                          5 - $DCBn.
      138     8093                              DESC=n.
      139     8094                          7 - HEAD record.
      140     8095                              DESC=0, $SA.
      141     8096                              DESC=1, $PRIV.
      142     8097                              DESC=2, $HEAD.
      143     8098                    DESC - Function of SEG.
      144     8099                    NOT_IS - Set if requested value is not in ISR, see SEG & DESC.
      145     8100             OUTPUT: None.
      146     8101             SCRATCH: Local AUTO only.
      147     8102             DESCRIPTION: A cache controlled by S_D.RCBC structure is used to access
      148     8103                          the program records. The desired program record is
      149     8104                          determined from the input parameters. If the record
      150     8105                          is already in memory then the desired value is updated
      151     8106                          into it. Otherwise, the desired program record is read
      152     8107                          into the program record buffer, and then its value is
      153     8108                          updated.  Note that the HEAD record, and the read-only-
      154     8109                          segment records are always in memory, having been setup
      155     8110                           at RUM command time. RETURNs if successful, else ALTRETs. */
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:34   
      156     8111                                                /**/
      157     8112    1   DUU$PUTMVAL: ENTRY( VALUE, NODE, ADDRESS, SEG, DESC, NOT_IS ) ALTRET;

   8112  1 000012   000000 700200 xent  DUU$PUTMVAL  TSX0  ! X66_AUTO_N
         1 000013   000060 000006                    ZERO    48,6

      158     8113                                                /**/
      159     8114    1        IF S_D.PROTECT

   8114  1 000014   000000 470400 xsym               LDP0    S_D$
         1 000015   005254 234100                    SZN     2732,,PR0
         1 000016   000022 605000 1                  TPL     s:8119

      160     8115    2        THEN DO;

      161     8116    2             S_D.ERROR = 185;        /* E@PROTECT */

   8116  1 000017   000271 235007                    LDA     185,DL
         1 000020   000013 755100                    STA     11,,PR0

      162     8117    2             GOTO ARET;

   8117  1 000021   000011 710000 1                  TRA     ARET

      163     8118    2           END;
      164     8119    1        READ = '0'B;

   8119  1 000022   200011 450100                    STZ     READ,,AUTO

      165     8120    1        VSIZE = VALUE.SIZE;

   8120  1 000023   200003 471500                    LDP1    @VALUE,,AUTO
         1 000024   100000 235100                    LDA     0,,PR1
         1 000025   200014 755100                    STA     VSIZE,,AUTO

      166     8121    1        CALL ACCESS ALTRET( ARET );

PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:35   
   8121  1 000026   000130 701000 1                  TSX1    ACCESS
         1 000027   000011 702000 1                  TSX2    ARET

      167     8122                                                /**/
      168     8123    1        RETURN;

   8123  1 000030   000000 702200 xent               TSX2  ! X66_ARET

      169     8124                                                /**/
      170     8125        %EJECT;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:36   
      171     8126
      172     8127    1   DUU$TRUNC: ENTRY ALTRET;

   8127  1 000031   000000 700200 xent  DUU$TRUNC    TSX0  ! X66_AUTO_N
         1 000032   000060 000006                    ZERO    48,6

      173     8128
      174     8129    2        DO CBX = 0 TO S_D.RCBC.BUFSM1;

   8129  1 000033   200012 450100                    STZ     CBX,,AUTO
         1 000034   000111 710000 1                  TRA     s:8138+3

      175     8130    2             IF ( S_D.RCBC.PAGE( CBX ) ~= -1 ) AND

   8130  1 000035   000000 470400 xsym               LDP0    S_D$
         1 000036   200012 720100                    LXL0    CBX,,AUTO
         1 000037   000534 235110                    LDA     348,X0,PR0
         1 000040   000027 115000 xsym               CMPA    B_VECTNIL+23
         1 000041   000106 600000 1                  TZE     s:8138
         1 000042   200012 236100                    LDQ     CBX,,AUTO
         1 000043   000022 402007                    MPY     18,DL
         1 000044   000000 066506                    CMPB    filb='0'B
         1 000045   000560 000001                    BDSC    368,Q,PR0                by=0,bit=0,n=1
         1 000046   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 000047   000106 601000 1                  TNZ     s:8138

      176     8131    2               ( NOT S_D.RCBC.WRITTEN( CBX ) )
      177     8132    3             THEN DO;

      178     8133    3                  S_D.RCBC.WRITTEN( CBX ) = '1'B;

   8133  1 000050   003106 060400                    CSL     bolr='003'O
         1 000051   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         1 000052   000560 000001                    BDSC    368,Q,PR0                by=0,bit=0,n=1

      179     8134    3                  TNODE = S_D.RCBC.NODE( CBX );

PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:37   
   8134  1 000053   200012 235100                    LDA     CBX,,AUTO
         1 000054   000001 735000                    ALS     1
         1 000055   000100 101505                    MRL     fill='000'O
         1 000056   000565 000002                    ADSC9   373,A,PR0                cn=0,n=2
         1 000057   200013 000004                    ADSC9   TNODE,,AUTO              cn=0,n=4

      180     8135    3                  CALL DDQ$WRITELM( %TYPPROG, S_D.RCBC.PAGE(CBX), TNODE,

   8135  1 000060   200012 236100                    LDQ     CBX,,AUTO
         1 000061   000022 736000                    QLS     18
         1 000062   000546 036003                    ADLQ    358,DU
         1 000063   000000 036000 xsym               ADLQ    S_D$
         1 000064   200056 756100                    STQ     TEMP$WORD+7,,AUTO
         1 000065   200012 236100                    LDQ     CBX,,AUTO
         1 000066   000022 736000                    QLS     18
         1 000067   000522 036003                    ADLQ    338,DU
         1 000070   000000 036000 xsym               ADLQ    S_D$
         1 000071   200055 756100                    STQ     TEMP$WORD+6,,AUTO
         1 000072   200013 631500                    EPPR1   TNODE,,AUTO
         1 000073   200054 451500                    STP1    TEMP$WORD+5,,AUTO
         1 000074   200012 236100                    LDQ     CBX,,AUTO
         1 000075   000022 736000                    QLS     18
         1 000076   000534 036003                    ADLQ    348,DU
         1 000077   000000 036000 xsym               ADLQ    S_D$
         1 000100   000000 235000 2                  LDA     0
         1 000101   200052 757100                    STAQ    TEMP$WORD+3,,AUTO
         1 000102   200052 630500                    EPPR0   TEMP$WORD+3,,AUTO
         1 000103   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 000104   000000 701000 xent               TSX1    DDQ$WRITELM
         1 000105   000116 702000 1                  TSX2    NOWREC

      181     8136    3                    S_D.RCBC.BUF$(CBX), S_D.RCBC.SIZE(CBX) ) ALTRET( NOWREC );
      182     8137    3                END;

      183     8138    2           END;

   8138  1 000106   200012 235100                    LDA     CBX,,AUTO
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:38   
         1 000107   000001 035007                    ADLA    1,DL
         1 000110   200012 755100                    STA     CBX,,AUTO
         1 000111   000000 470400 xsym               LDP0    S_D$
         1 000112   000521 236100                    LDQ     337,,PR0
         1 000113   200012 116100                    CMPQ    CBX,,AUTO
         1 000114   000035 603000 1                  TRC     s:8130

      184     8139
      185     8140    1        RETURN;

   8140  1 000115   000000 702200 xent               TSX2  ! X66_ARET

   8138  1 000116                       NOWREC       null
      186     8141
      187     8142    1   NOWREC: ;
      188     8143    1        S_D.RCBC.PAGE( CBX ) = -1;

   8143  1 000116   000001 335007                    LCA     1,DL
         1 000117   000000 470400 xsym               LDP0    S_D$
         1 000120   200012 720100                    LXL0    CBX,,AUTO
         1 000121   000534 755110                    STA     348,X0,PR0

      189     8144    1        S_D.ERROR = 132;           /* E@NOPROGREC */

   8144  1 000122   000204 236007                    LDQ     132,DL
         1 000123   000013 756100                    STQ     11,,PR0

      190     8145    1        CALL DDE$ERROR;

   8145  1 000124   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000125   000000 701000 xent               TSX1    DDE$ERROR
         1 000126   000000 011000                    NOP     0

      191     8146
      192     8147    1        RETURN;

   8147  1 000127   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:39   

      193     8148
      194     8149        %EJECT;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:40   
      195     8150                                                /**/
      196     8151    1   ACCESS: PROC ALTRET;

   8151  1 000130   200016 741300       ACCESS       STX1  ! NWORD_L6+1,,AUTO

      197     8152                                                /**/
      198     8153    2   DCL BUF$ PTR;
      199     8154    2   DCL TBUF$ PTR;
      200     8155    2   DCL TADDRESS UBIN;
      201     8156    2   DCL TSIZE UBIN;
      202     8157    2   DCL IXX UBIN;
      203     8158    2   DCL PSTART SBIN;
      204     8159    2   DCL PSIZE SBIN;
      205     8160    2   DCL SIZE UBIN;
      206     8161    2   DCL PAGE UBIN;
      207     8162    2   DCL DCB$ PTR;
      208     8163    2   DCL IX UBIN;
      209     8164    2   DCL TEMP$ PTR;
      210     8165    2   DCL UDCB$ PTR;
      211     8166    2   DCL TREEHDR$ PTR;
      212     8167    2   DCL TREE$ PTR;
      213     8168    2   DCL UDCBNUM UBIN;
      214     8169    2   DCL NODENUM UBIN;
      215     8170    2   DCL ROSIZE UBIN;
      216     8171    2   DCL DCBOFF SBIN;
      217     8172    2   DCL DCBPG$ PTR;
      218     8173    2   DCL DCBPGSZ UBIN;
      219     8174    2   DCL PAGE1 UBIN;
      220     8175    2   DCL SEQ UBIN;
      221     8176    2   DCL LRU UBIN;
      222     8177    2   DCL DCB$ADDR$(0:0) PTR BASED ALIGNED;
      223     8178    2   DCL BUF$WORD UBIN BASED ALIGNED;
      224     8179    2   DCL 1 BUF$L6B BASED HALIGNED,
      225     8180    2         2 * BIT(1) UNAL,
      226     8181    2         2 UBYTE UBIN(8) UNAL,
      227     8182    2         2 * BIT(1) UNAL,
      228     8183    2         2 LBYTE UBIN(8) UNAL;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:41   
      229     8184    2   DCL 1 DCB$CHAR BASED( DCB$ ) ALIGNED,
      230     8185    2         2 * CHAR( DCBSIZEC ) UNAL;
      231     8186    2   DCL BUF$PTR$ PTR BASED ALIGNED;
      232     8187    2   DCL 1 PTR$WORD BASED ALIGNED,
      233     8188    2         2 LH UBIN HALF UNAL,
      234     8189    2         2 RH UBIN HALF UNAL,
      235     8190    2         2 RHB REDEF RH,
      236     8191    2           3 * BIT(1) UNAL,
      237     8192    2           3 UBYTE UBIN(8) UNAL,
      238     8193    2           3 * BIT(1) UNAL,
      239     8194    2           3 LBYTE UBIN(8) UNAL;
      240     8195    2   DCL 1 TEMP$WORD ALIGNED,
      241     8196    2         2 * UBIN(20) UNAL,
      242     8197    2         2 UBYTE UBIN(8) UNAL,
      243     8198    2         2 LBYTE UBIN(8) UNAL;
      244     8199    2   DCL TEMPWORD REDEF TEMP$WORD UBIN WORD ALIGNED;
      245     8200    2   DCL L6_DATA_START UBIN WORD CONSTANT INIT(BITBIN('10000'X));
      246     8201                                                /**/
      247     8202    2        IF NOT_IS

   8202  1 000131   200010 470500                    LDP0    @NOT_IS,,AUTO
         1 000132   000000 234100                    SZN     0,,PR0
         1 000133   001333 605000 1                  TPL     s:8414

      248     8203    2        THEN IF SEG = 5

   8203  1 000134   200006 471500                    LDP1    @SEG,,AUTO
         1 000135   100000 235100                    LDA     0,,PR1
         1 000136   000005 115007                    CMPA    5,DL
         1 000137   001120 601000 1                  TNZ     s:8357

      249     8204    3             THEN DO;                      /* $DCBn, where n=DESC */

      250     8205    3                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

   8205  1 000140   000000 473400 xsym               LDP3    S_D$
         1 000141   306714 235100                    LDA     3532,,PR3
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:42   
         1 000142   000001 115007                    CMPA    1,DL
         1 000143   000545 601000 1                  TNZ     s:8282

      251     8206    4                  THEN DO;

      252     8207    4                       IF S_D.B$ROS$ = ADDR( NIL )

   8207  1 000144   304775 236100                    LDQ     2557,,PR3
         1 000145   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000146   002564 600000 1                  TZE     NODCBS

      253     8208    4                       THEN GOTO NODCBS;
      254     8209    4                       IF DESC > S_D.B$ROS$ -> B$ROSEG.NUMDCBS

   8209  1 000147   304775 474500                    LDP4    2557,,PR3
         1 000150   200007 475500                    LDP5    @DESC,,AUTO
         1 000151   400002 236100                    LDQ     2,,PR4
         1 000152   000022 772000                    QRL     18
         1 000153   500000 116100                    CMPQ    0,,PR5
         1 000154   002567 602000 1                  TNC     NODCB

      255     8210    4                       THEN GOTO NODCB;
      256     8211    4                       DCB$ = S_D.B$ROS$ -> B$ROSEG.DCBPTR$ -> DCB$ADDR$( DESC );

   8211  1 000155   400000 476500                    LDP6    0,,PR4
         1 000156   500000 720100                    LXL0    0,,PR5
         1 000157   600000 236110                    LDQ     0,X0,PR6
         1 000160   200030 756100                    STQ     DCB$,,AUTO

      257     8212    4                       IF DCB$ = ADDR( NIL )

   8212  1 000161   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000162   002605 600000 1                  TZE     NILDCB

      258     8213    4                       THEN GOTO NILDCB;
      259     8214    4                       SIZE = SIZEW( DCB$ -> F$DCB );

PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:43   
   8214  1 000163   200030 477500                    LDP7    DCB$,,AUTO
         1 000164   700140 236100                    LDQ     96,,PR7
         1 000165   000033 772000                    QRL     27
         1 000166   000037 376007                    ANQ     31,DL
         1 000167   000601 622006                    EAX2    385,QL
         1 000170   000000 636012                    EAQ     0,X2
         1 000171   000022 772000                    QRL     18
         1 000172   000011 402007                    MPY     9,DL
         1 000173   000043 036007                    ADLQ    35,DL
         1 000174   000044 506007                    DIV     36,DL
         1 000175   200026 756100                    STQ     SIZE,,AUTO

      260     8215    4                       IF ADDRESS >= SIZE

   8215  1 000176   200005 476500                    LDP6    @ADDRESS,,AUTO
         1 000177   000000 116003                    CMPQ    0,DU
         1 000200   000203 604000 1                  TMI     s:8217
         1 000201   600000 116100                    CMPQ    0,,PR6
         1 000202   002572 604400 1                  TMOZ    NOTINDCB

      261     8216    4                       THEN GOTO NOTINDCB;
      262     8217    4                       BUF$ = PINCRW( DCB$, ADDRESS );

   8217  1 000203   600000 236100                    LDQ     0,,PR6
         1 000204   000022 736000                    QLS     18
         1 000205   200030 036100                    ADLQ    DCB$,,AUTO
         1 000206   200017 756100                    STQ     BUF$,,AUTO

      263     8218    4                       IF READ

   8218  1 000207   200011 234100                    SZN     READ,,AUTO
         1 000210   000216 605000 1                  TPL     s:8221

      264     8219    4                       THEN VALUE.OPS(0) = BUF$ -> BUF$WORD;

   8219  1 000211   200017 470500                    LDP0    BUF$,,AUTO
         1 000212   200003 471500                    LDP1    @VALUE,,AUTO
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:44   
         1 000213   000000 235100                    LDA     0,,PR0
         1 000214   100001 755100                    STA     1,,PR1
         1 000215   002537 710000 1                  TRA     s:8633

      265     8220    5                       ELSE DO;

      266     8221    5                            IF DCB$ -> F$DCB.DCBNAME.S

   8221  1 000216   700140 236100                    LDQ     96,,PR7
         1 000217   040000 316003                    CANQ    16384,DU
         1 000220   000227 600000 1                  TZE     s:8226

      267     8222    6                            THEN DO;       /* Scrub it */

      268     8223    6                                 DCB$CHAR = M$MDCB;

   8223  1 000221   000140 720000 0                  LXL0    DCBSIZEC
         1 000222   000140 100400                    MLR     fill='000'O
         1 000223   000000 000600 0                  ADSC9   M$MDCB                   cn=0,n=384
         1 000224   700000 000010                    ADSC9   0,,PR7                   cn=0,n=*X0

      269     8224    6                                 DCB$ -> F$DCB.DCBNAME.S = '0'B;

   8224  1 000225   000001 236000 2                  LDQ     1
         1 000226   700140 356100                    ANSQ    96,,PR7

      270     8225    6                               END;

      271     8226    5                            CALL CHKBIRTH ALTRET( NOWBIR );

   8226  1 000227   002620 701000 1                  TSX1    CHKBIRTH
         1 000230   002550 702000 1                  TSX2    NOWBIR

      272     8227    5                            BUF$ -> BUF$WORD = VALUE.OPS(0);

   8227  1 000231   200003 470500                    LDP0    @VALUE,,AUTO
         1 000232   200017 471500                    LDP1    BUF$,,AUTO
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:45   
         1 000233   000001 235100                    LDA     1,,PR0
         1 000234   100000 755100                    STA     0,,PR1

      273     8228    5                           UDCB$ = PINCRW( S_D.B$ROS$ -> B$ROSEG.DCBPTR$, %M$1STDCB# )
              8228                                     ;

   8228  1 000235   000000 473400 xsym               LDP3    S_D$
         1 000236   304775 474500                    LDP4    2557,,PR3
         1 000237   400000 236100                    LDQ     0,,PR4
         1 000240   000012 036003                    ADLQ    10,DU
         1 000241   200033 756100                    STQ     UDCB$,,AUTO

      274     8229    5                            UDCBNUM = S_D.RUM_HEAD$ -> B$HEAD.UDCBNUM;

   8229  1 000242   305001 475500                    LDP5    2561,,PR3
         1 000243   500004 236100                    LDQ     4,,PR5
         1 000244   000022 772000                    QRL     18
         1 000245   200036 756100                    STQ     UDCBNUM,,AUTO

      275     8230    5                            TREEHDR$ = PINCRW( UDCB$, S_D.RUM_HEAD$ -> B$HEAD.TREEDISP
              8230                                     );

   8230  1 000246   500005 220100                    LDX0    5,,PR5
         1 000247   000000 636010                    EAQ     0,X0
         1 000250   200033 036100                    ADLQ    UDCB$,,AUTO
         1 000251   200034 756100                    STQ     TREEHDR$,,AUTO

      276     8231    5                            NODENUM = TREEHDR$ -> B$TREEHDR.NODES;

   8231  1 000252   200034 476500                    LDP6    TREEHDR$,,AUTO
         1 000253   600000 236100                    LDQ     0,,PR6
         1 000254   000022 772000                    QRL     18
         1 000255   200037 756100                    STQ     NODENUM,,AUTO

      277     8232    5                            TREE$ = PINCRW( TREEHDR$, SIZEW( B$TREEHDR ) );

   8232  1 000256   200034 236100                    LDQ     TREEHDR$,,AUTO
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:46   
         1 000257   000003 036003                    ADLQ    3,DU
         1 000260   200035 756100                    STQ     TREE$,,AUTO

      278     8233                                      /* Un-relocate DCB and tree table NAME pointers */
      279     8234    5                            TEMP$ = UDCB$;

   8234  1 000261   200033 236100                    LDQ     UDCB$,,AUTO
         1 000262   200032 756100                    STQ     TEMP$,,AUTO

      280     8235    6                            DO IX = 1 TO UDCBNUM;

   8235  1 000263   000001 235007                    LDA     1,DL
         1 000264   200031 755100                    STA     IX,,AUTO
         1 000265   000306 710000 1                  TRA     s:8238+3

      281     8236    6                                 TEMP$ -> BUF$PTR$ = PINCRW( B$ROS$, POFFW( TEMP$ ->
              8236                                          BUF$PTR$, UDCB$ ) );

   8236  1 000266   200033 235100                    LDA     UDCB$,,AUTO
         1 000267   000022 771000                    ARL     18
         1 000270   200052 755100                    STA     TEMP$WORD+3,,AUTO
         1 000271   200032 470500                    LDP0    TEMP$,,AUTO
         1 000272   000000 236100                    LDQ     0,,PR0
         1 000273   000022 772000                    QRL     18
         1 000274   200052 136100                    SBLQ    TEMP$WORD+3,,AUTO
         1 000275   000022 736000                    QLS     18
         1 000276   000000 036000 xsym               ADLQ    B$ROS$
         1 000277   000000 756100                    STQ     0,,PR0

      282     8237    6                                 TEMP$ = PINCRW( TEMP$, SIZEW( BUF$PTR$ ) );

   8237  1 000300   200032 236100                    LDQ     TEMP$,,AUTO
         1 000301   000001 036003                    ADLQ    1,DU
         1 000302   200032 756100                    STQ     TEMP$,,AUTO

      283     8238    6                               END;

PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:47   
   8238  1 000303   200031 235100                    LDA     IX,,AUTO
         1 000304   000001 035007                    ADLA    1,DL
         1 000305   200031 755100                    STA     IX,,AUTO
         1 000306   200036 236100                    LDQ     UDCBNUM,,AUTO
         1 000307   200031 116100                    CMPQ    IX,,AUTO
         1 000310   000266 603000 1                  TRC     s:8236

      284     8239    5                            TREE$ -> B$NODE.FLGS.NOW_IN( 0 ) = '0'B;

   8239  1 000311   200035 470500                    LDP0    TREE$,,AUTO
         1 000312   000031 236000 xsym               LDQ     B_VECTNIL+25
         1 000313   000001 356100                    ANSQ    1,,PR0

      285     8240    5                            TEMP$ = TREE$;

   8240  1 000314   200035 236100                    LDQ     TREE$,,AUTO
         1 000315   200032 756100                    STQ     TEMP$,,AUTO

      286     8241    6                            DO IX = 1 TO NODENUM;

   8241  1 000316   000001 235007                    LDA     1,DL
         1 000317   200031 755100                    STA     IX,,AUTO
         1 000320   000341 710000 1                  TRA     s:8244+3

      287     8242    6                                 TEMP$ -> B$NODE.NAME$( 0 ) = PINCRW( B$ROS$, POFFW(
              8242                                          TEMP$ -> B$NODE.NAME$( 0 ), TREEHDR$ ) );

   8242  1 000321   200034 235100                    LDA     TREEHDR$,,AUTO
         1 000322   000022 771000                    ARL     18
         1 000323   200052 755100                    STA     TEMP$WORD+3,,AUTO
         1 000324   200032 470500                    LDP0    TEMP$,,AUTO
         1 000325   000000 236100                    LDQ     0,,PR0
         1 000326   000022 772000                    QRL     18
         1 000327   200052 136100                    SBLQ    TEMP$WORD+3,,AUTO
         1 000330   000022 736000                    QLS     18
         1 000331   000000 036000 xsym               ADLQ    B$ROS$
         1 000332   000000 756100                    STQ     0,,PR0
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:48   

      288     8243    6                                 TEMP$ = PINCRW( TEMP$, SIZEW( B$NODE ) );

   8243  1 000333   200032 236100                    LDQ     TEMP$,,AUTO
         1 000334   000006 036003                    ADLQ    6,DU
         1 000335   200032 756100                    STQ     TEMP$,,AUTO

      289     8244    6                               END;

   8244  1 000336   200031 235100                    LDA     IX,,AUTO
         1 000337   000001 035007                    ADLA    1,DL
         1 000340   200031 755100                    STA     IX,,AUTO
         1 000341   200037 236100                    LDQ     NODENUM,,AUTO
         1 000342   200031 116100                    CMPQ    IX,,AUTO
         1 000343   000321 603000 1                  TRC     s:8242

      290     8245                                           /* Re-write ROS pages that contain DCB */
      291     8246    5                            ROSIZE = S_D.RUM_HEAD$ -> B$HEAD.ROSIZE;

   8246  1 000344   000000 470400 xsym               LDP0    S_D$
         1 000345   005001 471500                    LDP1    2561,,PR0
         1 000346   100010 236100                    LDQ     8,,PR1
         1 000347   777777 376007                    ANQ     -1,DL
         1 000350   200040 756100                    STQ     ROSIZE,,AUTO

      292     8247    5                            PSIZE = S_D.RUM_HEAD$ -> B$HEAD.PRECSIZE;

   8247  1 000351   100006 236100                    LDQ     6,,PR1
         1 000352   000022 772000                    QRL     18
         1 000353   200025 756100                    STQ     PSIZE,,AUTO

      293     8248    5                            DCBOFF = POFFW( DCB$, UDCB$ );

   8248  1 000354   200033 235100                    LDA     UDCB$,,AUTO
         1 000355   000022 771000                    ARL     18
         1 000356   200052 755100                    STA     TEMP$WORD+3,,AUTO
         1 000357   200030 236100                    LDQ     DCB$,,AUTO
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:49   
         1 000360   000022 772000                    QRL     18
         1 000361   200052 136100                    SBLQ    TEMP$WORD+3,,AUTO
         1 000362   200041 756100                    STQ     DCBOFF,,AUTO

      294     8249    5                            PAGE = ( DCBOFF / PSIZE ) * PSIZE;

   8249  1 000363   200025 506100                    DIV     PSIZE,,AUTO
         1 000364   200025 402100                    MPY     PSIZE,,AUTO
         1 000365   200027 756100                    STQ     PAGE,,AUTO

      295     8250    5                            DCBPG$ = PINCRW( UDCB$, PAGE );

   8250  1 000366   000022 736000                    QLS     18
         1 000367   200033 036100                    ADLQ    UDCB$,,AUTO
         1 000370   200042 756100                    STQ     DCBPG$,,AUTO

      296     8251    5                            DCBPGSZ = ROSIZE - PAGE;

   8251  1 000371   200040 236100                    LDQ     ROSIZE,,AUTO
         1 000372   200027 136100                    SBLQ    PAGE,,AUTO
         1 000373   200043 756100                    STQ     DCBPGSZ,,AUTO

      297     8252    5                            IF DCBPGSZ >= PSIZE

   8252  1 000374   000377 604000 1                  TMI     s:8253
         1 000375   200025 116100                    CMPQ    PSIZE,,AUTO
         1 000376   000401 604000 1                  TMI     s:8254

      298     8253    5                            THEN DCBPGSZ = PSIZE;

   8253  1 000377   200025 235100                    LDA     PSIZE,,AUTO
         1 000400   200043 755100                    STA     DCBPGSZ,,AUTO

      299     8254    5                            DCBPGSZ = DCBPGSZ * SIZEC( DCBPGSZ );

   8254  1 000401   200043 235100                    LDA     DCBPGSZ,,AUTO
         1 000402   000002 735000                    ALS     2
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:50   
         1 000403   200043 755100                    STA     DCBPGSZ,,AUTO

      300     8255    5                            IF NOT S_D.RUM_TEST

   8255  1 000404   005004 234100                    SZN     2564,,PR0
         1 000405   000424 604000 1                  TMI     s:8257

      301     8256    5                            THEN CALL DDQ$WRITELM( %TYPROS, PAGE, 0, DCBPG$, DCBPGSZ )
              8256                                     ALTRET( NOWROS );

   8256  1 000406   200043 633500                    EPPR3   DCBPGSZ,,AUTO
         1 000407   200056 453500                    STP3    TEMP$WORD+7,,AUTO
         1 000410   200042 634500                    EPPR4   DCBPG$,,AUTO
         1 000411   200055 454500                    STP4    TEMP$WORD+6,,AUTO
         1 000412   000003 236000 2                  LDQ     3
         1 000413   200054 756100                    STQ     TEMP$WORD+5,,AUTO
         1 000414   200027 635500                    EPPR5   PAGE,,AUTO
         1 000415   200053 455500                    STP5    TEMP$WORD+4,,AUTO
         1 000416   000004 236000 2                  LDQ     4
         1 000417   200052 756100                    STQ     TEMP$WORD+3,,AUTO
         1 000420   200052 630500                    EPPR0   TEMP$WORD+3,,AUTO
         1 000421   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 000422   000000 701000 xent               TSX1    DDQ$WRITELM
         1 000423   002560 702000 1                  TSX2    NOWROS

      302     8257    5                            PAGE1 = ( ( DCBOFF - 1 + SIZE ) / PSIZE ) * PSIZE;

   8257  1 000424   200041 236100                    LDQ     DCBOFF,,AUTO
         1 000425   200026 036100                    ADLQ    SIZE,,AUTO
         1 000426   000001 136007                    SBLQ    1,DL
         1 000427   200025 506100                    DIV     PSIZE,,AUTO
         1 000430   200025 402100                    MPY     PSIZE,,AUTO
         1 000431   200044 756100                    STQ     PAGE1,,AUTO

      303     8258    5                            IF PAGE ~= PAGE1

   8258  1 000432   200027 116100                    CMPQ    PAGE,,AUTO
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:51   
         1 000433   000473 600000 1                  TZE     s:8269

      304     8259    6                            THEN DO;       /* Update 2nd page */

      305     8260    6                                 DCBPG$ = PINCRW( UDCB$, PAGE1 );

   8260  1 000434   000022 736000                    QLS     18
         1 000435   200033 036100                    ADLQ    UDCB$,,AUTO
         1 000436   200042 756100                    STQ     DCBPG$,,AUTO

      306     8261    6                                 DCBPGSZ = ROSIZE - PAGE1;

   8261  1 000437   200040 236100                    LDQ     ROSIZE,,AUTO
         1 000440   200044 136100                    SBLQ    PAGE1,,AUTO
         1 000441   200043 756100                    STQ     DCBPGSZ,,AUTO

      307     8262    6                                 IF DCBPGSZ >= PSIZE

   8262  1 000442   000445 604000 1                  TMI     s:8263
         1 000443   200025 116100                    CMPQ    PSIZE,,AUTO
         1 000444   000447 604000 1                  TMI     s:8264

      308     8263    6                                 THEN DCBPGSZ = PSIZE;

   8263  1 000445   200025 235100                    LDA     PSIZE,,AUTO
         1 000446   200043 755100                    STA     DCBPGSZ,,AUTO

      309     8264    6                                 DCBPGSZ = DCBPGSZ * SIZEC( DCBPGSZ );

   8264  1 000447   200043 235100                    LDA     DCBPGSZ,,AUTO
         1 000450   000002 735000                    ALS     2
         1 000451   200043 755100                    STA     DCBPGSZ,,AUTO

      310     8265    6                                 IF NOT S_D.RUM_TEST

   8265  1 000452   000000 470400 xsym               LDP0    S_D$
         1 000453   005004 234100                    SZN     2564,,PR0
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:52   
         1 000454   000473 604000 1                  TMI     s:8269

      311     8266    6                                 THEN CALL DDQ$WRITELM( %TYPROS, PAGE1, 0, DCBPG$,
              8266                                          DCBPGSZ ) ALTRET( NOWROS );

   8266  1 000455   200043 631500                    EPPR1   DCBPGSZ,,AUTO
         1 000456   200056 451500                    STP1    TEMP$WORD+7,,AUTO
         1 000457   200042 633500                    EPPR3   DCBPG$,,AUTO
         1 000460   200055 453500                    STP3    TEMP$WORD+6,,AUTO
         1 000461   000003 236000 2                  LDQ     3
         1 000462   200054 756100                    STQ     TEMP$WORD+5,,AUTO
         1 000463   200044 634500                    EPPR4   PAGE1,,AUTO
         1 000464   200053 454500                    STP4    TEMP$WORD+4,,AUTO
         1 000465   000004 236000 2                  LDQ     4
         1 000466   200052 756100                    STQ     TEMP$WORD+3,,AUTO
         1 000467   200052 630500                    EPPR0   TEMP$WORD+3,,AUTO
         1 000470   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 000471   000000 701000 xent               TSX1    DDQ$WRITELM
         1 000472   002560 702000 1                  TSX2    NOWROS

      312     8267    6                               END;

      313     8268                                      /* Re-relocate DCB and tree table NAME pointers */
      314     8269    5                            TEMP$ = UDCB$;

   8269  1 000473   200033 236100                    LDQ     UDCB$,,AUTO
         1 000474   200032 756100                    STQ     TEMP$,,AUTO

      315     8270    6                            DO IX = 1 TO UDCBNUM;

   8270  1 000475   000001 235007                    LDA     1,DL
         1 000476   200031 755100                    STA     IX,,AUTO
         1 000477   000513 710000 1                  TRA     s:8273+3

      316     8271    6                                 TEMP$ -> BUF$PTR$ = PINCRW( UDCB$, TEMP$ -> PTR$WORD.
              8271                                          LH );

PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:53   
   8271  1 000500   200032 470500                    LDP0    TEMP$,,AUTO
         1 000501   000000 220100                    LDX0    0,,PR0
         1 000502   000000 636010                    EAQ     0,X0
         1 000503   200033 036100                    ADLQ    UDCB$,,AUTO
         1 000504   000000 756100                    STQ     0,,PR0

      317     8272    6                                 TEMP$ = PINCRW( TEMP$, SIZEW( BUF$PTR$ ) );

   8272  1 000505   200032 236100                    LDQ     TEMP$,,AUTO
         1 000506   000001 036003                    ADLQ    1,DU
         1 000507   200032 756100                    STQ     TEMP$,,AUTO

      318     8273    6                               END;

   8273  1 000510   200031 235100                    LDA     IX,,AUTO
         1 000511   000001 035007                    ADLA    1,DL
         1 000512   200031 755100                    STA     IX,,AUTO
         1 000513   200036 236100                    LDQ     UDCBNUM,,AUTO
         1 000514   200031 116100                    CMPQ    IX,,AUTO
         1 000515   000500 603000 1                  TRC     s:8271

      319     8274    5                            TREE$ -> B$NODE.FLGS.NOW_IN( 0 ) = '1'B;

   8274  1 000516   200035 470500                    LDP0    TREE$,,AUTO
         1 000517   400000 236003                    LDQ     -131072,DU
         1 000520   000001 256100                    ORSQ    1,,PR0

      320     8275    5                            TEMP$ = TREE$;

   8275  1 000521   200035 236100                    LDQ     TREE$,,AUTO
         1 000522   200032 756100                    STQ     TEMP$,,AUTO

      321     8276    6                            DO IX = 1 TO NODENUM;

   8276  1 000523   000001 235007                    LDA     1,DL
         1 000524   200031 755100                    STA     IX,,AUTO
         1 000525   000541 710000 1                  TRA     s:8279+3
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:54   

      322     8277    6                                 TEMP$ -> B$NODE.NAME$( 0 ) = PINCRW( TREEHDR$, TEMP$
              8277                                          -> PTR$WORD.LH );

   8277  1 000526   200032 470500                    LDP0    TEMP$,,AUTO
         1 000527   000000 220100                    LDX0    0,,PR0
         1 000530   000000 636010                    EAQ     0,X0
         1 000531   200034 036100                    ADLQ    TREEHDR$,,AUTO
         1 000532   000000 756100                    STQ     0,,PR0

      323     8278    6                                 TEMP$ = PINCRW( TEMP$, SIZEW( B$NODE ) );

   8278  1 000533   200032 236100                    LDQ     TEMP$,,AUTO
         1 000534   000006 036003                    ADLQ    6,DU
         1 000535   200032 756100                    STQ     TEMP$,,AUTO

      324     8279    6                               END;

   8279  1 000536   200031 235100                    LDA     IX,,AUTO
         1 000537   000001 035007                    ADLA    1,DL
         1 000540   200031 755100                    STA     IX,,AUTO
         1 000541   200037 236100                    LDQ     NODENUM,,AUTO
         1 000542   200031 116100                    CMPQ    IX,,AUTO
         1 000543   000526 603000 1                  TRC     s:8277

      325     8280    5                          END;

      326     8281    4                     END;

   8281  1 000544   002537 710000 1                  TRA     s:8633

      327     8282    3                  ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

   8282  1 000545   000002 115007                    CMPA    2,DL
         1 000546   002610 601000 1                  TNZ     DELBUG

      328     8283    4                       THEN DO;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:55   

      329     8284    4                            IF S_D.B$ROS$ = ADDR( NIL )

   8284  1 000547   304775 236100                    LDQ     2557,,PR3
         1 000550   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000551   002564 600000 1                  TZE     NODCBS

      330     8285    4                            THEN GOTO NODCBS;
      331     8286    4                            IF DESC > S_D.B$ROS$ -> B$ROSEG.NUMDCBS

   8286  1 000552   304775 474500                    LDP4    2557,,PR3
         1 000553   200007 475500                    LDP5    @DESC,,AUTO
         1 000554   400002 236100                    LDQ     2,,PR4
         1 000555   000022 772000                    QRL     18
         1 000556   500000 116100                    CMPQ    0,,PR5
         1 000557   002567 602000 1                  TNC     NODCB

      332     8287    4                            THEN GOTO NODCB;
      333     8288    4                            DCB$ = S_D.B$ROS$ -> B$ROSEG.DCBPTR$ -> DCB$ADDR$( DESC );

   8288  1 000560   400000 476500                    LDP6    0,,PR4
         1 000561   500000 720100                    LXL0    0,,PR5
         1 000562   600000 236110                    LDQ     0,X0,PR6
         1 000563   200030 756100                    STQ     DCB$,,AUTO

      334     8289    4                            IF DCB$ = ADDR( NIL )

   8289  1 000564   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000565   002605 600000 1                  TZE     NILDCB

      335     8290    4                            THEN GOTO NILDCB;
      336     8291    4                            SIZE = %L6_DCB_DCBNAME#;

   8291  1 000566   000062 235007                    LDA     50,DL
         1 000567   200026 755100                    STA     SIZE,,AUTO

      337     8292    4                            IF ADDRESS >= SIZE
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:56   

   8292  1 000570   200005 476500                    LDP6    @ADDRESS,,AUTO
         1 000571   600000 236100                    LDQ     0,,PR6
         1 000572   000575 604000 1                  TMI     s:8294
         1 000573   200026 116100                    CMPQ    SIZE,,AUTO
         1 000574   002572 603000 1                  TRC     NOTINDCB

      338     8293    4                            THEN GOTO NOTINDCB;
      339     8294    4                            BUF$ = PINCRC( DCB$, ADDRESS * 2 );

   8294  1 000575   000021 736000                    QLS     17
         1 000576   200030 036100                    ADLQ    DCB$,,AUTO
         1 000577   200017 756100                    STQ     BUF$,,AUTO

      340     8295    4                            IF READ

   8295  1 000600   200011 234100                    SZN     READ,,AUTO
         1 000601   000633 605000 1                  TPL     s:8307

      341     8296    5                            THEN DO;

      342     8297    5                                 TBUF$ = BUF$;

   8297  1 000602   200020 756100                    STQ     TBUF$,,AUTO

      343     8298    6                                 DO IX = 0 TO 15;

   8298  1 000603   200031 450100                    STZ     IX,,AUTO

      344     8299    6                                      VALUE.OPS(IX) = 0;

   8299  1 000604   200003 470500                    LDP0    @VALUE,,AUTO
         1 000605   200031 720100                    LXL0    IX,,AUTO
         1 000606   000001 450110                    STZ     1,X0,PR0

      345     8300    6                                      VALUE.OPSB.UBYTE(IX) = TBUF$ -> BUF$L6B.UBYTE;

PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:57   
   8300  1 000607   200031 236100                    LDQ     IX,,AUTO
         1 000610   000044 402007                    MPY     36,DL
         1 000611   200020 471500                    LDP1    TBUF$,,AUTO
         1 000612   003106 060500                    CSL     bolr='003'O
         1 000613   100000 010010                    BDSC    0,,PR1                   by=0,bit=1,n=8
         1 000614   000001 420010                    BDSC    1,Q,PR0                  by=2,bit=2,n=8

      346     8301    6                                      VALUE.OPSB.LBYTE(IX) = TBUF$ -> BUF$L6B.LBYTE;

   8301  1 000615   003106 060500                    CSL     bolr='003'O
         1 000616   100000 210010                    BDSC    0,,PR1                   by=1,bit=1,n=8
         1 000617   000001 610010                    BDSC    1,Q,PR0                  by=3,bit=1,n=8

      347     8302    6                                      TBUF$ = PINCRC(TBUF$, 2);

   8302  1 000620   200020 236100                    LDQ     TBUF$,,AUTO
         1 000621   400000 036007                    ADLQ    -131072,DL
         1 000622   200020 756100                    STQ     TBUF$,,AUTO

      348     8303    6                                    END;

   8303  1 000623   200031 235100                    LDA     IX,,AUTO
         1 000624   000001 035007                    ADLA    1,DL
         1 000625   200031 755100                    STA     IX,,AUTO
         1 000626   000020 115007                    CMPA    16,DL
         1 000627   000604 602000 1                  TNC     s:8299

      349     8304    5                                 VALUE.SIZE = 16;

   8304  1 000630   000020 235007                    LDA     16,DL
         1 000631   000000 755100                    STA     0,,PR0

      350     8305    5                               END;

   8305  1 000632   002537 710000 1                  TRA     s:8633

      351     8306    5                            ELSE DO;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:58   

      352     8307    5                                 CALL CHKBIRTH ALTRET( NOWBIR );

   8307  1 000633   002620 701000 1                  TSX1    CHKBIRTH
         1 000634   002550 702000 1                  TSX2    NOWBIR

      353     8308    5                                 TBUF$ = BUF$;

   8308  1 000635   200017 236100                    LDQ     BUF$,,AUTO
         1 000636   200020 756100                    STQ     TBUF$,,AUTO

      354     8309    6                                 DO IX = 0 TO VALUE.SIZE;

   8309  1 000637   200031 450100                    STZ     IX,,AUTO
         1 000640   000664 710000 1                  TRA     s:8314+3

      355     8310    6                                      TBUF$ -> BUF$L6B = '0'B;

   8310  1 000641   200020 470500                    LDP0    TBUF$,,AUTO
         1 000642   000100 100400                    MLR     fill='000'O
         1 000643   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000644   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2

      356     8311    6                                      TBUF$ -> BUF$L6B.UBYTE = VALUE.OPSB.UBYTE(IX);

   8311  1 000645   200031 236100                    LDQ     IX,,AUTO
         1 000646   000044 402007                    MPY     36,DL
         1 000647   200003 471500                    LDP1    @VALUE,,AUTO
         1 000650   003100 060506                    CSL     bolr='003'O
         1 000651   100001 420010                    BDSC    1,Q,PR1                  by=2,bit=2,n=8
         1 000652   000000 010010                    BDSC    0,,PR0                   by=0,bit=1,n=8

      357     8312    6                                      TBUF$ -> BUF$L6B.LBYTE = VALUE.OPSB.LBYTE(IX);

   8312  1 000653   003100 060506                    CSL     bolr='003'O
         1 000654   100001 610010                    BDSC    1,Q,PR1                  by=3,bit=1,n=8
         1 000655   000000 210010                    BDSC    0,,PR0                   by=1,bit=1,n=8
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:59   

      358     8313    6                                      TBUF$ = PINCRC(TBUF$, 2);

   8313  1 000656   200020 236100                    LDQ     TBUF$,,AUTO
         1 000657   400000 036007                    ADLQ    -131072,DL
         1 000660   200020 756100                    STQ     TBUF$,,AUTO

      359     8314    6                                    END;

   8314  1 000661   200031 235100                    LDA     IX,,AUTO
         1 000662   000001 035007                    ADLA    1,DL
         1 000663   200031 755100                    STA     IX,,AUTO
         1 000664   200003 470500                    LDP0    @VALUE,,AUTO
         1 000665   000000 236100                    LDQ     0,,PR0
         1 000666   200031 116100                    CMPQ    IX,,AUTO
         1 000667   000641 603000 1                  TRC     s:8310

      360     8315    5                                 UDCB$ = PINCRW( S_D.B$ROS$ -> B$ROSEG.DCBPTR$, %
              8315                                          G_FRST_USR_DCB# );

   8315  1 000670   000000 471400 xsym               LDP1    S_D$
         1 000671   104775 473500                    LDP3    2557,,PR1
         1 000672   300000 236100                    LDQ     0,,PR3
         1 000673   000012 036003                    ADLQ    10,DU
         1 000674   200033 756100                    STQ     UDCB$,,AUTO

      361     8316                                      /* Un-relocate DCB and tree table NAME pointers */
      362     8317    5                                 TEMP$ = UDCB$;

   8317  1 000675   200032 756100                    STQ     TEMP$,,AUTO

      363     8318    6                                 DO IX = 1 TO UDCBNUM;

   8318  1 000676   000001 235007                    LDA     1,DL
         1 000677   200031 755100                    STA     IX,,AUTO
         1 000700   000722 710000 1                  TRA     s:8321+3

PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:60   
      364     8319    6                                      TEMP$ -> BUF$PTR$ = PINCRW( B$ROS$, POFFC( TEMP$
              8319                                               -> BUF$PTR$, UDCB$ ) / 2 );

   8319  1 000701   200033 236100                    LDQ     UDCB$,,AUTO
         1 000702   000020 772000                    QRL     16
         1 000703   200052 756100                    STQ     TEMP$WORD+3,,AUTO
         1 000704   200032 470500                    LDP0    TEMP$,,AUTO
         1 000705   000000 236100                    LDQ     0,,PR0
         1 000706   000020 772000                    QRL     16
         1 000707   200052 136100                    SBLQ    TEMP$WORD+3,,AUTO
         1 000710   000002 506007                    DIV     2,DL
         1 000711   000022 736000                    QLS     18
         1 000712   000000 036000 xsym               ADLQ    B$ROS$
         1 000713   000000 756100                    STQ     0,,PR0

      365     8320    6                                      TEMP$ = PINCRW( TEMP$, SIZEW( BUF$PTR$ ) );

   8320  1 000714   200032 236100                    LDQ     TEMP$,,AUTO
         1 000715   000001 036003                    ADLQ    1,DU
         1 000716   200032 756100                    STQ     TEMP$,,AUTO

      366     8321    6                                    END;

   8321  1 000717   200031 235100                    LDA     IX,,AUTO
         1 000720   000001 035007                    ADLA    1,DL
         1 000721   200031 755100                    STA     IX,,AUTO
         1 000722   200036 236100                    LDQ     UDCBNUM,,AUTO
         1 000723   200031 116100                    CMPQ    IX,,AUTO
         1 000724   000701 603000 1                  TRC     s:8319

      367     8322                                           /* Re-write ROS pages that contain DCB */
      368     8323    5                                 ROSIZE = S_D.RUM_HEAD$ -> B$HEAD.ROSIZE;

   8323  1 000725   000000 470400 xsym               LDP0    S_D$
         1 000726   005001 471500                    LDP1    2561,,PR0
         1 000727   100010 236100                    LDQ     8,,PR1
         1 000730   777777 376007                    ANQ     -1,DL
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:61   
         1 000731   200040 756100                    STQ     ROSIZE,,AUTO

      369     8324    5                                 PSIZE = S_D.RUM_HEAD$ -> B$HEAD.PRECSIZE;

   8324  1 000732   100006 236100                    LDQ     6,,PR1
         1 000733   000022 772000                    QRL     18
         1 000734   200025 756100                    STQ     PSIZE,,AUTO

      370     8325    5                                 DCBOFF = POFFC( DCB$, UDCB$ ) / 2;

   8325  1 000735   200033 236100                    LDQ     UDCB$,,AUTO
         1 000736   000020 772000                    QRL     16
         1 000737   200052 756100                    STQ     TEMP$WORD+3,,AUTO
         1 000740   200030 236100                    LDQ     DCB$,,AUTO
         1 000741   000020 772000                    QRL     16
         1 000742   200052 136100                    SBLQ    TEMP$WORD+3,,AUTO
         1 000743   000002 506007                    DIV     2,DL
         1 000744   200041 756100                    STQ     DCBOFF,,AUTO

      371     8326    5                                 PAGE = ( DCBOFF / PSIZE ) * PSIZE;

   8326  1 000745   200025 506100                    DIV     PSIZE,,AUTO
         1 000746   200025 402100                    MPY     PSIZE,,AUTO
         1 000747   200027 756100                    STQ     PAGE,,AUTO

      372     8327    5                                 DCBPG$ = PINCRC( UDCB$, PAGE * 2 );

   8327  1 000750   000021 736000                    QLS     17
         1 000751   200033 036100                    ADLQ    UDCB$,,AUTO
         1 000752   200042 756100                    STQ     DCBPG$,,AUTO

      373     8328    5                                 DCBPGSZ = ROSIZE - PAGE;

   8328  1 000753   200040 236100                    LDQ     ROSIZE,,AUTO
         1 000754   200027 136100                    SBLQ    PAGE,,AUTO
         1 000755   200043 756100                    STQ     DCBPGSZ,,AUTO

PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:62   
      374     8329    5                                 IF DCBPGSZ >= PSIZE

   8329  1 000756   000761 604000 1                  TMI     s:8330
         1 000757   200025 116100                    CMPQ    PSIZE,,AUTO
         1 000760   000763 604000 1                  TMI     s:8331

      375     8330    5                                 THEN DCBPGSZ = PSIZE;

   8330  1 000761   200025 235100                    LDA     PSIZE,,AUTO
         1 000762   200043 755100                    STA     DCBPGSZ,,AUTO

      376     8331    5                                 DCBPGSZ = DCBPGSZ * 2;

   8331  1 000763   200043 235100                    LDA     DCBPGSZ,,AUTO
         1 000764   000001 735000                    ALS     1
         1 000765   200043 755100                    STA     DCBPGSZ,,AUTO

      377     8332    5                                 IF NOT S_D.RUM_TEST

   8332  1 000766   005004 234100                    SZN     2564,,PR0
         1 000767   001011 604000 1                  TMI     s:8334

      378     8333    5                                THEN CALL DDQ$WRITELM( %TYPPROG, PAGE + BITBIN('1000'X
              8333                                          ), 0, DCBPG$, DCBPGSZ ) ALTRET( NOWROS );

   8333  1 000770   200027 236100                    LDQ     PAGE,,AUTO
         1 000771   010000 036007                    ADLQ    4096,DL
         1 000772   200052 756100                    STQ     TEMP$WORD+3,,AUTO
         1 000773   200043 633500                    EPPR3   DCBPGSZ,,AUTO
         1 000774   200057 453500                    STP3    TEMP$WORD+8,,AUTO
         1 000775   200042 634500                    EPPR4   DCBPG$,,AUTO
         1 000776   200056 454500                    STP4    TEMP$WORD+7,,AUTO
         1 000777   000003 236000 2                  LDQ     3
         1 001000   200055 756100                    STQ     TEMP$WORD+6,,AUTO
         1 001001   200052 635500                    EPPR5   TEMP$WORD+3,,AUTO
         1 001002   200054 455500                    STP5    TEMP$WORD+5,,AUTO
         1 001003   000000 236000 2                  LDQ     0
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:63   
         1 001004   200053 756100                    STQ     TEMP$WORD+4,,AUTO
         1 001005   200053 630500                    EPPR0   TEMP$WORD+4,,AUTO
         1 001006   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 001007   000000 701000 xent               TSX1    DDQ$WRITELM
         1 001010   002560 702000 1                  TSX2    NOWROS

      379     8334    5                                 PAGE1 = ( ( DCBOFF - 1 + SIZE ) / PSIZE ) * PSIZE;

   8334  1 001011   200041 236100                    LDQ     DCBOFF,,AUTO
         1 001012   200026 036100                    ADLQ    SIZE,,AUTO
         1 001013   000001 136007                    SBLQ    1,DL
         1 001014   200025 506100                    DIV     PSIZE,,AUTO
         1 001015   200025 402100                    MPY     PSIZE,,AUTO
         1 001016   200044 756100                    STQ     PAGE1,,AUTO

      380     8335    5                                 IF PAGE ~= PAGE1

   8335  1 001017   200027 116100                    CMPQ    PAGE,,AUTO
         1 001020   001063 600000 1                  TZE     s:8346

      381     8336    6                                 THEN DO;  /* Update 2nd page */

      382     8337    6                                      DCBPG$ = PINCRC( UDCB$, PAGE1 * 2 );

   8337  1 001021   000021 736000                    QLS     17
         1 001022   200033 036100                    ADLQ    UDCB$,,AUTO
         1 001023   200042 756100                    STQ     DCBPG$,,AUTO

      383     8338    6                                      DCBPGSZ = ROSIZE - PAGE1;

   8338  1 001024   200040 236100                    LDQ     ROSIZE,,AUTO
         1 001025   200044 136100                    SBLQ    PAGE1,,AUTO
         1 001026   200043 756100                    STQ     DCBPGSZ,,AUTO

      384     8339    6                                      IF DCBPGSZ >= PSIZE

   8339  1 001027   001032 604000 1                  TMI     s:8340
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:64   
         1 001030   200025 116100                    CMPQ    PSIZE,,AUTO
         1 001031   001034 604000 1                  TMI     s:8341

      385     8340    6                                      THEN DCBPGSZ = PSIZE;

   8340  1 001032   200025 235100                    LDA     PSIZE,,AUTO
         1 001033   200043 755100                    STA     DCBPGSZ,,AUTO

      386     8341    6                                      DCBPGSZ = DCBPGSZ * 2;

   8341  1 001034   200043 235100                    LDA     DCBPGSZ,,AUTO
         1 001035   000001 735000                    ALS     1
         1 001036   200043 755100                    STA     DCBPGSZ,,AUTO

      387     8342    6                                      IF NOT S_D.RUM_TEST

   8342  1 001037   000000 470400 xsym               LDP0    S_D$
         1 001040   005004 234100                    SZN     2564,,PR0
         1 001041   001063 604000 1                  TMI     s:8346

      388     8343    6                                      THEN CALL DDQ$WRITELM( %TYPPROG, PAGE1 + BITBIN(
              8343                                              '1000'X), 0, DCBPG$, DCBPGSZ ) ALTRET( NOWROS
              8343                                               );

   8343  1 001042   200044 236100                    LDQ     PAGE1,,AUTO
         1 001043   010000 036007                    ADLQ    4096,DL
         1 001044   200052 756100                    STQ     TEMP$WORD+3,,AUTO
         1 001045   200043 631500                    EPPR1   DCBPGSZ,,AUTO
         1 001046   200057 451500                    STP1    TEMP$WORD+8,,AUTO
         1 001047   200042 633500                    EPPR3   DCBPG$,,AUTO
         1 001050   200056 453500                    STP3    TEMP$WORD+7,,AUTO
         1 001051   000003 236000 2                  LDQ     3
         1 001052   200055 756100                    STQ     TEMP$WORD+6,,AUTO
         1 001053   200052 634500                    EPPR4   TEMP$WORD+3,,AUTO
         1 001054   200054 454500                    STP4    TEMP$WORD+5,,AUTO
         1 001055   000000 236000 2                  LDQ     0
         1 001056   200053 756100                    STQ     TEMP$WORD+4,,AUTO
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:65   
         1 001057   200053 630500                    EPPR0   TEMP$WORD+4,,AUTO
         1 001060   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 001061   000000 701000 xent               TSX1    DDQ$WRITELM
         1 001062   002560 702000 1                  TSX2    NOWROS

      389     8344    6                                    END;

      390     8345                                      /* Re-relocate DCB and tree table NAME pointers */
      391     8346    5                                 TEMP$ = UDCB$;

   8346  1 001063   200033 236100                    LDQ     UDCB$,,AUTO
         1 001064   200032 756100                    STQ     TEMP$,,AUTO

      392     8347    6                                 DO IX = 1 TO UDCBNUM;

   8347  1 001065   000001 235007                    LDA     1,DL
         1 001066   200031 755100                    STA     IX,,AUTO
         1 001067   001114 710000 1                  TRA     s:8352+3

      393     8348    6                                      TEMP$WORD.UBYTE = TEMP$ -> PTR$WORD.RHB.UBYTE;

   8348  1 001070   200032 470500                    LDP0    TEMP$,,AUTO
         1 001071   000000 236100                    LDQ     0,,PR0
         1 001072   000001 772000                    QRL     1
         1 001073   200047 676100                    ERQ     TEMP$WORD,,AUTO
         1 001074   177400 376007                    ANQ     65280,DL
         1 001075   200047 656100                    ERSQ    TEMP$WORD,,AUTO

      394     8349    6                                      TEMP$WORD.LBYTE = TEMP$ -> PTR$WORD.RHB.LBYTE;

   8349  1 001076   000000 236100                    LDQ     0,,PR0
         1 001077   200047 676100                    ERQ     TEMP$WORD,,AUTO
         1 001100   000377 376007                    ANQ     255,DL
         1 001101   200047 656100                    ERSQ    TEMP$WORD,,AUTO

      395     8350    6                                     TEMP$ -> BUF$PTR$ = PINCRC( UDCB$, TEMPWORD * 2 )
              8350                                               ;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:66   

   8350  1 001102   200047 236100                    LDQ     TEMP$WORD,,AUTO
         1 001103   000021 736000                    QLS     17
         1 001104   200033 036100                    ADLQ    UDCB$,,AUTO
         1 001105   000000 756100                    STQ     0,,PR0

      396     8351    6                                      TEMP$ = PINCRW( TEMP$, SIZEW( BUF$PTR$ ) );

   8351  1 001106   200032 236100                    LDQ     TEMP$,,AUTO
         1 001107   000001 036003                    ADLQ    1,DU
         1 001110   200032 756100                    STQ     TEMP$,,AUTO

      397     8352    6                                    END;

   8352  1 001111   200031 235100                    LDA     IX,,AUTO
         1 001112   000001 035007                    ADLA    1,DL
         1 001113   200031 755100                    STA     IX,,AUTO
         1 001114   200036 236100                    LDQ     UDCBNUM,,AUTO
         1 001115   200031 116100                    CMPQ    IX,,AUTO
         1 001116   001070 603000 1                  TRC     s:8348

      398     8353    5                               END;

      399     8354    4                          END;

   8354  1 001117   002537 710000 1                  TRA     s:8633

      400     8355    3                       ELSE GOTO DELBUG;
      401     8356    3                END;                       /* $DCBn */
      402     8357    2             ELSE IF SEG = 7

   8357  1 001120   000007 115007                    CMPA    7,DL
         1 001121   002601 601000 1                  TNZ     NOTINRUM

      403     8358    3                  THEN DO;                 /* HEAD record fields */

      404     8359    3                       IF NOT READ
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:67   

   8359  1 001122   200011 234100                    SZN     READ,,AUTO
         1 001123   001131 604000 1                  TMI     s:8364

      405     8360    4                       THEN DO;

      406     8361    4                            CALL CHKBIRTH ALTRET( NOWBIR );

   8361  1 001124   002620 701000 1                  TSX1    CHKBIRTH
         1 001125   002550 702000 1                  TSX2    NOWBIR

      407     8362    4                            VALUE.SIZE = 1;

   8362  1 001126   000001 235007                    LDA     1,DL
         1 001127   200003 470500                    LDP0    @VALUE,,AUTO
         1 001130   000000 755100                    STA     0,,PR0

      408     8363    4                          END;

      409     8364    4                       DO CASE ( DESC );

   8364  1 001131   200007 470500                    LDP0    @DESC,,AUTO
         1 001132   000000 235100                    LDA     0,,PR0
         1 001133   000003 115007                    CMPA    3,DL
         1 001134   001136 602005 1                  TNC     s:8364+5,AL
         1 001135   001311 710000 1                  TRA     s:8407
         1 001136   001141 710000 1                  TRA     s:8366
         1 001137   001237 710000 1                  TRA     s:8392
         1 001140   001264 710000 1                  TRA     s:8399

      410     8365    4                         CASE ( 0 );       /* $SA */

      411     8366    4                            IF ADDRESS > 0

   8366  1 001141   200005 471500                    LDP1    @ADDRESS,,AUTO
         1 001142   100000 235100                    LDA     0,,PR1
         1 001143   001146 604400 1                  TMOZ    s:8368
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:68   

      412     8367    4                            THEN ALTRETURN;

   8367  1 001144   200016 221300                    LDX1  ! NWORD_L6+1,,AUTO
         1 001145   000000 702211                    TSX2  ! 0,X1

      413     8368    4                            IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

   8368  1 001146   000000 473400 xsym               LDP3    S_D$
         1 001147   306714 235100                    LDA     3532,,PR3
         1 001150   000001 115007                    CMPA    1,DL
         1 001151   001173 601000 1                  TNZ     s:8376

      414     8369    5                            THEN DO;

      415     8370    5                                 IF READ

   8370  1 001152   200011 234100                    SZN     READ,,AUTO
         1 001153   001162 605000 1                  TPL     s:8372

      416     8371    5                                 THEN VALUE.OPS(0) = S_D.RUM_HEAD$ -> B$HEAD.START;

   8371  1 001154   305001 474500                    LDP4    2561,,PR3
         1 001155   200003 475500                    LDP5    @VALUE,,AUTO
         1 001156   400003 236100                    LDQ     3,,PR4
         1 001157   000005 376000 2                  ANQ     5
         1 001160   500001 756100                    STQ     1,,PR5
         1 001161   001170 710000 1                  TRA     s:8373

      417     8372    5                                 ELSE S_D.RUM_HEAD$ -> B$HEAD.START = VALUE.OPS(0);

   8372  1 001162   305001 474500                    LDP4    2561,,PR3
         1 001163   200003 475500                    LDP5    @VALUE,,AUTO
         1 001164   500001 236100                    LDQ     1,,PR5
         1 001165   400003 676100                    ERQ     3,,PR4
         1 001166   000005 376000 2                  ANQ     5
         1 001167   400003 656100                    ERSQ    3,,PR4
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:69   

      418     8373    5                                 VALUE.SIZE = 1;

   8373  1 001170   000001 235007                    LDA     1,DL
         1 001171   500000 755100                    STA     0,,PR5

      419     8374    5                               END;

   8374  1 001172   001312 710000 1                  TRA     s:8409

      420     8375    5                            ELSE DO;

      421     8376    5                                 IF READ

   8376  1 001173   200011 234100                    SZN     READ,,AUTO
         1 001174   001214 605000 1                  TPL     s:8384

      422     8377    6                                 THEN DO;

      423     8378    6                                      NWORD_L6V = S_D.RUM_HEAD$ -> B$HEAD.START;

   8378  1 001175   305001 474500                    LDP4    2561,,PR3
         1 001176   400003 236100                    LDQ     3,,PR4
         1 001177   000005 376000 2                  ANQ     5
         1 001200   200015 756100                    STQ     NWORD_L6,,AUTO

      424     8379    6                                      VALUE.OPS(0) = NWORD_L6.ADDR1;

   8379  1 001201   200003 475500                    LDP5    @VALUE,,AUTO
         1 001202   200015 236100                    LDQ     NWORD_L6,,AUTO
         1 001203   000020 772000                    QRL     16
         1 001204   000017 376007                    ANQ     15,DL
         1 001205   500001 756100                    STQ     1,,PR5

      425     8380    6                                      VALUE.OPS(1) = NWORD_L6.ADDR2;

   8380  1 001206   200015 236100                    LDQ     NWORD_L6,,AUTO
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:70   
         1 001207   177777 376007                    ANQ     65535,DL
         1 001210   500002 756100                    STQ     2,,PR5

      426     8381    6                                      VALUE.SIZE = 2;

   8381  1 001211   000002 235007                    LDA     2,DL
         1 001212   500000 755100                    STA     0,,PR5

      427     8382    6                                    END;

   8382  1 001213   001312 710000 1                  TRA     s:8409

      428     8383    6                                 ELSE DO;

      429     8384    6                                      NWORD_L6V = 0;

   8384  1 001214   200015 450100                    STZ     NWORD_L6,,AUTO

      430     8385    6                                      NWORD_L6.ADDR1 = VALUE.OPS(0);

   8385  1 001215   200003 474500                    LDP4    @VALUE,,AUTO
         1 001216   400001 236100                    LDQ     1,,PR4
         1 001217   000020 736000                    QLS     16
         1 001220   200015 676100                    ERQ     NWORD_L6,,AUTO
         1 001221   000006 376000 2                  ANQ     6
         1 001222   200015 656100                    ERSQ    NWORD_L6,,AUTO

      431     8386    6                                      NWORD_L6.ADDR2 = VALUE.OPS(1);

   8386  1 001223   400002 236100                    LDQ     2,,PR4
         1 001224   200015 676100                    ERQ     NWORD_L6,,AUTO
         1 001225   177777 376007                    ANQ     65535,DL
         1 001226   200015 656100                    ERSQ    NWORD_L6,,AUTO

      432     8387    6                                      S_D.RUM_HEAD$ -> B$HEAD.START = NWORD_L6V;

   8387  1 001227   305001 475500                    LDP5    2561,,PR3
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:71   
         1 001230   200015 236100                    LDQ     NWORD_L6,,AUTO
         1 001231   500003 676100                    ERQ     3,,PR5
         1 001232   000005 376000 2                  ANQ     5
         1 001233   500003 656100                    ERSQ    3,,PR5

      433     8388    6                                      VALUE.SIZE = 1;

   8388  1 001234   000001 235007                    LDA     1,DL
         1 001235   400000 755100                    STA     0,,PR4

      434     8389    6                                    END;

      435     8390    5                               END;

   8390  1 001236   001312 710000 1                  TRA     s:8409

      436     8391    4                         CASE ( 1 );       /* $PRIV */

      437     8392    4                            IF ADDRESS > 0

   8392  1 001237   200005 471500                    LDP1    @ADDRESS,,AUTO
         1 001240   100000 235100                    LDA     0,,PR1
         1 001241   001244 604400 1                  TMOZ    s:8394

      438     8393    4                            THEN ALTRETURN;

   8393  1 001242   200016 221300                    LDX1  ! NWORD_L6+1,,AUTO
         1 001243   000000 702211                    TSX2  ! 0,X1

      439     8394    4                            IF READ

   8394  1 001244   200011 234100                    SZN     READ,,AUTO
         1 001245   001254 605000 1                  TPL     s:8396

      440     8395    4                            THEN VALUE.OPSBITS(0) = S_D.RUM_HEAD$ -> B$HEAD.PRIV;

   8395  1 001246   000000 473400 xsym               LDP3    S_D$
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:72   
         1 001247   305001 474500                    LDP4    2561,,PR3
         1 001250   400000 236100                    LDQ     0,,PR4
         1 001251   200003 475500                    LDP5    @VALUE,,AUTO
         1 001252   500001 756100                    STQ     1,,PR5
         1 001253   001261 710000 1                  TRA     s:8397

      441     8396    4                            ELSE S_D.RUM_HEAD$ -> B$HEAD.PRIV = VALUE.OPSBITS(0);

   8396  1 001254   000000 473400 xsym               LDP3    S_D$
         1 001255   305001 474500                    LDP4    2561,,PR3
         1 001256   200003 475500                    LDP5    @VALUE,,AUTO
         1 001257   500001 236100                    LDQ     1,,PR5
         1 001260   400000 756100                    STQ     0,,PR4

      442     8397    4                            VALUE.SIZE = 1;

   8397  1 001261   000001 235007                    LDA     1,DL
         1 001262   500000 755100                    STA     0,,PR5
         1 001263   001312 710000 1                  TRA     s:8409

      443     8398    4                         CASE ( 2 );       /* $HEAD */

      444     8399    4                            IF ADDRESS >= SIZEW( B$HEAD )

   8399  1 001264   200005 471500                    LDP1    @ADDRESS,,AUTO
         1 001265   100000 235100                    LDA     0,,PR1
         1 001266   000050 115007                    CMPA    40,DL
         1 001267   002575 605000 1                  TPL     NOTINHEAD

      445     8400    4                            THEN GOTO NOTINHEAD;
      446     8401    4                            BUF$ = PINCRW( S_D.RUM_HEAD$, ADDRESS );

   8401  1 001270   100000 236100                    LDQ     0,,PR1
         1 001271   000000 473400 xsym               LDP3    S_D$
         1 001272   305001 474500                    LDP4    2561,,PR3
         1 001273   400000 635506                    EPPR5   0,QL,PR4
         1 001274   200017 455500                    STP5    BUF$,,AUTO
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:73   

      447     8402    4                            IF READ

   8402  1 001275   200011 234100                    SZN     READ,,AUTO
         1 001276   001303 605000 1                  TPL     s:8404

      448     8403    4                            THEN VALUE.OPS(0) = BUF$ -> BUF$WORD;

   8403  1 001277   200003 476500                    LDP6    @VALUE,,AUTO
         1 001300   500000 235100                    LDA     0,,PR5
         1 001301   600001 755100                    STA     1,,PR6
         1 001302   001306 710000 1                  TRA     s:8405

      449     8404    4                            ELSE BUF$ -> BUF$WORD = VALUE.OPS(0);

   8404  1 001303   200003 476500                    LDP6    @VALUE,,AUTO
         1 001304   600001 235100                    LDA     1,,PR6
         1 001305   500000 755100                    STA     0,,PR5

      450     8405    4                            VALUE.SIZE = 1;

   8405  1 001306   000001 235007                    LDA     1,DL
         1 001307   600000 755100                    STA     0,,PR6
         1 001310   001312 710000 1                  TRA     s:8409

      451     8406    4                         CASE ( ELSE );

      452     8407    4                            GOTO DELBUG;

   8407  1 001311   002610 710000 1                  TRA     DELBUG

      453     8408    4                         END;              /* "DO CASE ( DESC ) */

      454     8409    3                       IF NOT READ AND NOT S_D.RUM_TEST

   8409  1 001312   200011 234100                    SZN     READ,,AUTO
         1 001313   002537 604000 1                  TMI     s:8633
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:74   
         1 001314   305004 234100                    SZN     2564,,PR3
         1 001315   002537 604000 1                  TMI     s:8633

      455     8410    3                       THEN CALL DDQ$WRITELM( %TYPHEAD, 0, 0, S_D.RUM_HEAD$, LENGTHC(
              8410                                B$HEAD ) ) ALTRET( NOWWH );

   8410  1 001316   000010 236000 2                  LDQ     8
         1 001317   200056 756100                    STQ     TEMP$WORD+7,,AUTO
         1 001320   000000 236000 xsym               LDQ     S_D$
         1 001321   005001 036003                    ADLQ    2561,DU
         1 001322   000003 235000 2                  LDA     3
         1 001323   200054 757100                    STAQ    TEMP$WORD+5,,AUTO
         1 001324   000012 237000 2                  LDAQ    10
         1 001325   200052 757100                    STAQ    TEMP$WORD+3,,AUTO
         1 001326   200052 630500                    EPPR0   TEMP$WORD+3,,AUTO
         1 001327   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 001330   000000 701000 xent               TSX1    DDQ$WRITELM
         1 001331   002554 702000 1                  TSX2    NOWWH

      456     8411    3                     END;                  /* HEAD record fields */

   8411  1 001332   002537 710000 1                  TRA     s:8633

      457     8412    2                  ELSE GOTO NOTINRUM;
      458     8413    3        ELSE DO;

      459     8414    3             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST OR

   8414  1 001333   000000 471400 xsym               LDP1    S_D$
         1 001334   106714 235100                    LDA     3532,,PR1
         1 001335   000001 115007                    CMPA    1,DL
         1 001336   001354 600000 1                  TZE     ONE_WORD
         1 001337   000002 115007                    CMPA    2,DL
         1 001340   002106 601000 1                  TNZ     s:8539
         1 001341   200005 473500                    LDP3    @ADDRESS,,AUTO
         1 001342   300000 236100                    LDQ     0,,PR3
         1 001343   200014 036100                    ADLQ    VSIZE,,AUTO
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:75   
         1 001344   100520 506100                    DIV     336,,PR1
         1 001345   100520 402100                    MPY     336,,PR1
         1 001346   200052 756100                    STQ     TEMP$WORD+3,,AUTO
         1 001347   300000 236100                    LDQ     0,,PR3
         1 001350   100520 506100                    DIV     336,,PR1
         1 001351   100520 402100                    MPY     336,,PR1
         1 001352   200052 116100                    CMPQ    TEMP$WORD+3,,AUTO
         1 001353   002106 601000 1                  TNZ     s:8539

      460     8415    3               (S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6 AND
      461     8416    3               ((((ADDRESS + VSIZE) / S_D.RCBC.BUFSIZE) * S_D.RCBC.BUFSIZE) =
      462     8417    3               ((ADDRESS / S_D.RCBC.BUFSIZE) * S_D.RCBC.BUFSIZE)))
      463     8418    4             THEN DO;

      464     8419    4   ONE_WORD:
      465     8420    4                  IF S_D.OVERLAID

   8420  1 001354   000000 470400 xsym  ONE_WORD     LDP0    S_D$
         1 001355   004764 234100                    SZN     2548,,PR0
         1 001356   001412 605000 1                  TPL     s:8434

      466     8421    5                  THEN DO;

      467     8422    5                       BUF$ = PINCRW( S_D.B$TREE$, SIZEW( B$NODE ) * NODE );

   8422  1 001357   200004 471500                    LDP1    @NODE,,AUTO
         1 001360   100000 720100                    LXL0    0,,PR1
         1 001361   004767 473500                    LDP3    2551,,PR0
         1 001362   000000 636010                    EAQ     0,X0
         1 001363   000022 772000                    QRL     18
         1 001364   000006 402007                    MPY     6,DL
         1 001365   300000 634506                    EPPR4   0,QL,PR3
         1 001366   200017 454500                    STP4    BUF$,,AUTO

      468     8423    5                       IF ADDRESS < S_D.PADDR

   8423  1 001367   200005 475500                    LDP5    @ADDRESS,,AUTO
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:76   
         1 001370   500000 236100                    LDQ     0,,PR5
         1 001371   001374 604000 1                  TMI     s:8425
         1 001372   004765 116100                    CMPQ    2549,,PR0
         1 001373   001403 603000 1                  TRC     s:8429

      469     8424    6                       THEN DO;

      470     8425    6                            PSTART = BUF$ -> B$NODE.DADDR( 0 );

   8425  1 001374   400004 236100                    LDQ     4,,PR4
         1 001375   000022 772000                    QRL     18
         1 001376   200024 756100                    STQ     PSTART,,AUTO

      471     8426    6                            PSIZE = BUF$ -> B$NODE.DSIZE( 0 );

   8426  1 001377   400004 236100                    LDQ     4,,PR4
         1 001400   777777 376007                    ANQ     -1,DL
         1 001401   200025 756100                    STQ     PSIZE,,AUTO

      472     8427    6                          END;

   8427  1 001402   001444 710000 1                  TRA     s:8446

      473     8428    6                       ELSE DO;

      474     8429    6                            PSTART = BUF$ -> B$NODE.PADDR( 0 );

   8429  1 001403   400003 236100                    LDQ     3,,PR4
         1 001404   000022 772000                    QRL     18
         1 001405   200024 756100                    STQ     PSTART,,AUTO

      475     8430    6                            PSIZE = BUF$ -> B$NODE.PSIZE( 0 );

   8430  1 001406   400003 236100                    LDQ     3,,PR4
         1 001407   777777 376007                    ANQ     -1,DL
         1 001410   200025 756100                    STQ     PSIZE,,AUTO

PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:77   
      476     8431    6                          END;

      477     8432    5                     END;

   8432  1 001411   001444 710000 1                  TRA     s:8446

      478     8433    5                  ELSE DO;

      479     8434    5                       IF ADDRESS < S_D.PADDR

   8434  1 001412   200005 471500                    LDP1    @ADDRESS,,AUTO
         1 001413   100000 236100                    LDQ     0,,PR1
         1 001414   001417 604000 1                  TMI     s:8436
         1 001415   004765 116100                    CMPQ    2549,,PR0
         1 001416   001436 603000 1                  TRC     s:8442

      480     8435    6                       THEN DO;

      481     8436    6                            IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

   8436  1 001417   006714 235100                    LDA     3532,,PR0
         1 001420   000001 115007                    CMPA    1,DL
         1 001421   001427 601000 1                  TNZ     s:8438

      482     8437    6                            THEN PSTART = S_D.RUM_HEAD$ -> B$HEAD.BIAS;

   8437  1 001422   005001 473500                    LDP3    2561,,PR0
         1 001423   300023 236100                    LDQ     19,,PR3
         1 001424   000005 376000 2                  ANQ     5
         1 001425   200024 756100                    STQ     PSTART,,AUTO
         1 001426   001431 710000 1                  TRA     s:8439

      483     8438    6                            ELSE PSTART = L6_DATA_START;

   8438  1 001427   000141 235000 0                  LDA     L6_DATA_START
         1 001430   200024 755100                    STA     PSTART,,AUTO

PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:78   
      484     8439    6                            PSIZE = S_D.RUM_HEAD$ -> B$HEAD.RDATA;

   8439  1 001431   005001 473500                    LDP3    2561,,PR0
         1 001432   300002 236100                    LDQ     2,,PR3
         1 001433   000005 376000 2                  ANQ     5
         1 001434   200025 756100                    STQ     PSIZE,,AUTO

      485     8440    6                          END;

   8440  1 001435   001444 710000 1                  TRA     s:8446

      486     8441    6                       ELSE DO;

      487     8442    6                            PSTART = S_D.PADDR;

   8442  1 001436   004765 235100                    LDA     2549,,PR0
         1 001437   200024 755100                    STA     PSTART,,AUTO

      488     8443    6                            PSIZE = S_D.RUM_HEAD$ -> B$HEAD.RPROC;

   8443  1 001440   005001 473500                    LDP3    2561,,PR0
         1 001441   300001 236100                    LDQ     1,,PR3
         1 001442   000005 376000 2                  ANQ     5
         1 001443   200025 756100                    STQ     PSIZE,,AUTO

      489     8444    6                          END;

      490     8445    5                     END;

      491     8446    4                  IF (ADDRESS < 0 OR ADDRESS >= PSTART + PSIZE) AND NOT S_D.RUM_FEP

   8446  1 001444   200005 471500                    LDP1    @ADDRESS,,AUTO
         1 001445   100000 235100                    LDA     0,,PR1
         1 001446   001452 604000 1                  TMI     s:8446+6
         1 001447   200024 036100                    ADLQ    PSTART,,AUTO
         1 001450   100000 116100                    CMPQ    0,,PR1
         1 001451   001462 605400 1                  TPNZ    s:8453
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:79   
         1 001452   007017 234100                    SZN     3599,,PR0
         1 001453   001462 604000 1                  TMI     s:8453

      492     8447    5                  THEN DO;

      493     8448    5                       S_D.ERROR = 131; /* E@NOTYOURS */

   8448  1 001454   000203 236007                    LDQ     131,DL
         1 001455   000013 756100                    STQ     11,,PR0

      494     8449    5                       IF S_D.FIND_RUM

   8449  1 001456   000073 234100                    SZN     59,,PR0
         1 001457   001461 605000 1                  TPL     s:8451

      495     8450    5                       THEN S_D.ERROR = 131; /* E@NOTYOURS */

   8450  1 001460   000013 756100                    STQ     11,,PR0

      496     8451    5                       GOTO ARET;

   8451  1 001461   002616 710000 1                  TRA     ARET

      497     8452    5                     END;
      498     8453    4                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

   8453  1 001462   006714 235100                    LDA     3532,,PR0
         1 001463   000001 115007                    CMPA    1,DL
         1 001464   001505 601000 1                  TNZ     s:8462

      499     8454    5                  THEN DO;

      500     8455    5                       PAGE = ( ( PSTART / S_D.RCBC.BUFSIZE ) * S_D.RCBC.BUFSIZE )

   8455  1 001465   200024 236100                    LDQ     PSTART,,AUTO
         1 001466   000520 506100                    DIV     336,,PR0
         1 001467   000520 402100                    MPY     336,,PR0
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:80   
         1 001470   000520 036100                    ADLQ    336,,PR0
         1 001471   200027 756100                    STQ     PAGE,,AUTO

      501     8456    5                         + S_D.RCBC.BUFSIZE;
      502     8457    5                       IF ADDRESS < PAGE

   8457  1 001472   001475 604000 1                  TMI     s:8458
         1 001473   100000 116100                    CMPQ    0,,PR1
         1 001474   001500 604400 1                  TMOZ    s:8459

      503     8458    5                       THEN PAGE = PSTART;

   8458  1 001475   200024 235100                    LDA     PSTART,,AUTO
         1 001476   200027 755100                    STA     PAGE,,AUTO
         1 001477   001511 710000 1                  TRA     s:8464

      504     8459    5                       ELSE PAGE = ( ADDRESS / S_D.RCBC.BUFSIZE ) * S_D.RCBC.BUFSIZE;

   8459  1 001500   100000 236100                    LDQ     0,,PR1
         1 001501   000520 506100                    DIV     336,,PR0
         1 001502   000520 402100                    MPY     336,,PR0
         1 001503   200027 756100                    STQ     PAGE,,AUTO

      505     8460    5                     END;

   8460  1 001504   001511 710000 1                  TRA     s:8464

      506     8461    5                  ELSE DO;

      507     8462    5                       PAGE = (ADDRESS / 2048) * 2048;

   8462  1 001505   100000 236100                    LDQ     0,,PR1
         1 001506   004000 506007                    DIV     2048,DL
         1 001507   000013 736000                    QLS     11
         1 001510   200027 756100                    STQ     PAGE,,AUTO

      508     8463    5                     END;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:81   

      509     8464    4                  LRU = 0;

   8464  1 001511   200046 450100                    STZ     LRU,,AUTO

      510     8465    4                  SEQ = S_D.RCBC.SEQ( 0 );

   8465  1 001512   000572 235100                    LDA     378,,PR0
         1 001513   200045 755100                    STA     SEQ,,AUTO

      511     8466    4                  S_D.RCBC.CUR_SEQ = S_D.RCBC.CUR_SEQ + 1;

   8466  1 001514   000517 235100                    LDA     335,,PR0
         1 001515   000001 035007                    ADLA    1,DL
         1 001516   000517 755100                    STA     335,,PR0

      512     8467    5                  DO CBX = 0 TO S_D.RCBC.BUFSM1;

   8467  1 001517   200012 450100                    STZ     CBX,,AUTO
         1 001520   001551 710000 1                  TRA     s:8476+3

      513     8468    5                       IF ( S_D.RCBC.PAGE( CBX ) = PAGE ) AND

   8468  1 001521   000000 470400 xsym               LDP0    S_D$
         1 001522   200012 720100                    LXL0    CBX,,AUTO
         1 001523   000534 236110                    LDQ     348,X0,PR0
         1 001524   001540 604000 1                  TMI     s:8471
         1 001525   200027 116100                    CMPQ    PAGE,,AUTO
         1 001526   001540 601000 1                  TNZ     s:8471
         1 001527   200004 471500                    LDP1    @NODE,,AUTO
         1 001530   200012 235100                    LDA     CBX,,AUTO
         1 001531   000001 735000                    ALS     1
         1 001532   000100 101505                    MRL     fill='000'O
         1 001533   000565 000002                    ADSC9   373,A,PR0                cn=0,n=2
         1 001534   200052 000004                    ADSC9   TEMP$WORD+3,,AUTO        cn=0,n=4
         1 001535   200052 236100                    LDQ     TEMP$WORD+3,,AUTO
         1 001536   100000 116100                    CMPQ    0,,PR1
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:82   
         1 001537   001675 600000 1                  TZE     INBUF

      514     8469    5                         ( S_D.RCBC.NODE( CBX ) = NODE )
      515     8470    5                       THEN GOTO INBUF;
      516     8471    5                       IF S_D.RCBC.SEQ( CBX ) < SEQ

   8471  1 001540   000572 236110                    LDQ     378,X0,PR0
         1 001541   200045 116100                    CMPQ    SEQ,,AUTO
         1 001542   001546 603000 1                  TRC     s:8476

      517     8472    6                       THEN DO;

      518     8473    6                            LRU = CBX;

   8473  1 001543   200012 235100                    LDA     CBX,,AUTO
         1 001544   200046 755100                    STA     LRU,,AUTO

      519     8474    6                            SEQ = S_D.RCBC.SEQ( CBX );

   8474  1 001545   200045 756100                    STQ     SEQ,,AUTO

      520     8475    6                          END;

      521     8476    5                     END;

   8476  1 001546   200012 235100                    LDA     CBX,,AUTO
         1 001547   000001 035007                    ADLA    1,DL
         1 001550   200012 755100                    STA     CBX,,AUTO
         1 001551   000521 236100                    LDQ     337,,PR0
         1 001552   200012 116100                    CMPQ    CBX,,AUTO
         1 001553   001521 603000 1                  TRC     s:8468

      522     8477    4                  CBX = LRU;

   8477  1 001554   200046 235100                    LDA     LRU,,AUTO
         1 001555   200012 755100                    STA     CBX,,AUTO

PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:83   
      523     8478    4                  IF NOT S_D.RCBC.WRITTEN( CBX ) AND

   8478  1 001556   200012 236100                    LDQ     CBX,,AUTO
         1 001557   000022 402007                    MPY     18,DL
         1 001560   000000 066506                    CMPB    filb='0'B
         1 001561   000560 000001                    BDSC    368,Q,PR0                by=0,bit=0,n=1
         1 001562   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 001563   001623 601000 1                  TNZ     s:8485
         1 001564   200012 720100                    LXL0    CBX,,AUTO
         1 001565   000534 235110                    LDA     348,X0,PR0
         1 001566   000027 115000 xsym               CMPA    B_VECTNIL+23
         1 001567   001623 600000 1                  TZE     s:8485

      524     8479    4                    S_D.RCBC.PAGE( CBX ) ~= -1
      525     8480    5                  THEN DO;

      526     8481    5                       TNODE = S_D.RCBC.NODE( CBX );

   8481  1 001570   200012 235100                    LDA     CBX,,AUTO
         1 001571   000001 735000                    ALS     1
         1 001572   000100 101505                    MRL     fill='000'O
         1 001573   000565 000002                    ADSC9   373,A,PR0                cn=0,n=2
         1 001574   200013 000004                    ADSC9   TNODE,,AUTO              cn=0,n=4

      527     8482    5                       CALL DDQ$WRITELM( %TYPPROG, S_D.RCBC.PAGE(CBX), TNODE,

   8482  1 001575   200012 236100                    LDQ     CBX,,AUTO
         1 001576   000022 736000                    QLS     18
         1 001577   000546 036003                    ADLQ    358,DU
         1 001600   000000 036000 xsym               ADLQ    S_D$
         1 001601   200056 756100                    STQ     TEMP$WORD+7,,AUTO
         1 001602   200012 236100                    LDQ     CBX,,AUTO
         1 001603   000022 736000                    QLS     18
         1 001604   000522 036003                    ADLQ    338,DU
         1 001605   000000 036000 xsym               ADLQ    S_D$
         1 001606   200055 756100                    STQ     TEMP$WORD+6,,AUTO
         1 001607   200013 631500                    EPPR1   TNODE,,AUTO
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:84   
         1 001610   200054 451500                    STP1    TEMP$WORD+5,,AUTO
         1 001611   200012 236100                    LDQ     CBX,,AUTO
         1 001612   000022 736000                    QLS     18
         1 001613   000534 036003                    ADLQ    348,DU
         1 001614   000000 036000 xsym               ADLQ    S_D$
         1 001615   000000 235000 2                  LDA     0
         1 001616   200052 757100                    STAQ    TEMP$WORD+3,,AUTO
         1 001617   200052 630500                    EPPR0   TEMP$WORD+3,,AUTO
         1 001620   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 001621   000000 701000 xent               TSX1    DDQ$WRITELM
         1 001622   002541 702000 1                  TSX2    NORREC

      528     8483    5                         S_D.RCBC.BUF$(CBX), S_D.RCBC.SIZE(CBX) ) ALTRET( NOWREC );
      529     8484    5                     END;

      530     8485    4                  SIZE = S_D.RCBC.BUFSIZE * SIZEC( SIZE );

   8485  1 001623   000000 470400 xsym               LDP0    S_D$
         1 001624   000520 235100                    LDA     336,,PR0
         1 001625   000002 735000                    ALS     2
         1 001626   200026 755100                    STA     SIZE,,AUTO

      531     8486    4                  S_D.RCBC.SIZE( CBX ) = 0; /* Positive */

   8486  1 001627   200012 720100                    LXL0    CBX,,AUTO
         1 001630   000546 450110                    STZ     358,X0,PR0

      532     8487    4                 CALL DDQ$READLM( %TYPPROG, PAGE, NODE, S_D.RCBC.BUF$(CBX), SIZE, S_D.
              8487                           RCBC.SIZE(CBX) ) ALTRET( NORREC );

   8487  1 001631   200012 236100                    LDQ     CBX,,AUTO
         1 001632   000022 736000                    QLS     18
         1 001633   000546 036003                    ADLQ    358,DU
         1 001634   000000 036000 xsym               ADLQ    S_D$
         1 001635   200057 756100                    STQ     TEMP$WORD+8,,AUTO
         1 001636   200026 631500                    EPPR1   SIZE,,AUTO
         1 001637   200056 451500                    STP1    TEMP$WORD+7,,AUTO
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:85   
         1 001640   200012 236100                    LDQ     CBX,,AUTO
         1 001641   000022 736000                    QLS     18
         1 001642   000522 036003                    ADLQ    338,DU
         1 001643   000000 036000 xsym               ADLQ    S_D$
         1 001644   200004 235100                    LDA     @NODE,,AUTO
         1 001645   200054 757100                    STAQ    TEMP$WORD+5,,AUTO
         1 001646   200027 633500                    EPPR3   PAGE,,AUTO
         1 001647   200053 453500                    STP3    TEMP$WORD+4,,AUTO
         1 001650   000000 236000 2                  LDQ     0
         1 001651   200052 756100                    STQ     TEMP$WORD+3,,AUTO
         1 001652   200052 630500                    EPPR0   TEMP$WORD+3,,AUTO
         1 001653   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 001654   000000 701000 xent               TSX1    DDQ$READLM
         1 001655   002541 702000 1                  TSX2    NORREC

      533     8488    4                  S_D.RCBC.PAGE( CBX ) = PAGE;

   8488  1 001656   200027 235100                    LDA     PAGE,,AUTO
         1 001657   000000 470400 xsym               LDP0    S_D$
         1 001660   200012 720100                    LXL0    CBX,,AUTO
         1 001661   000534 755110                    STA     348,X0,PR0

      534     8489    4                  S_D.RCBC.NODE( CBX ) = NODE;

   8489  1 001662   200012 236100                    LDQ     CBX,,AUTO
         1 001663   000001 736000                    QLS     1
         1 001664   200004 471500                    LDP1    @NODE,,AUTO
         1 001665   000106 101500                    MRL     fill='000'O
         1 001666   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         1 001667   000565 000002                    ADSC9   373,Q,PR0                cn=0,n=2

      535     8490    4                  S_D.RCBC.WRITTEN( CBX ) = '1'B;

   8490  1 001670   200012 236100                    LDQ     CBX,,AUTO
         1 001671   000022 402007                    MPY     18,DL
         1 001672   003106 060400                    CSL     bolr='003'O
         1 001673   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:86   
         1 001674   000560 000001                    BDSC    368,Q,PR0                by=0,bit=0,n=1

   8490  1 001675                       INBUF        null
      536     8491    4   INBUF:         ;
      537     8492    4                  S_D.RCBC.SEQ( CBX ) = S_D.RCBC.CUR_SEQ;

   8492  1 001675   000517 235100                    LDA     335,,PR0
         1 001676   000572 755110                    STA     378,X0,PR0

      538     8493    4                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

   8493  1 001677   006714 235100                    LDA     3532,,PR0
         1 001700   000001 115007                    CMPA    1,DL
         1 001701   001711 601000 1                  TNZ     s:8495

      539     8494    4                  THEN BUF$ = PINCRW( S_D.RCBC.BUF$(CBX), ADDRESS - PAGE );

   8494  1 001702   200005 473500                    LDP3    @ADDRESS,,AUTO
         1 001703   300000 236100                    LDQ     0,,PR3
         1 001704   200027 136100                    SBLQ    PAGE,,AUTO
         1 001705   000522 474510                    LDP4    338,X0,PR0
         1 001706   400000 635506                    EPPR5   0,QL,PR4
         1 001707   200017 455500                    STP5    BUF$,,AUTO
         1 001710   001726 710000 1                  TRA     s:8498

      540     8495    4                  ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

   8495  1 001711   000002 115007                    CMPA    2,DL
         1 001712   002610 601000 1                  TNZ     DELBUG

      541     8496    4                       THEN BUF$ = PINCRC(S_D.RCBC.BUF$(CBX), (ADDRESS - PAGE) * 2);

   8496  1 001713   200005 473500                    LDP3    @ADDRESS,,AUTO
         1 001714   300000 236100                    LDQ     0,,PR3
         1 001715   200027 136100                    SBLQ    PAGE,,AUTO
         1 001716   000522 474510                    LDP4    338,X0,PR0
         1 001717   000022 402007                    MPY     18,DL
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:87   
         1 001720   000000 116003                    CMPQ    0,DU
         1 001721   001723 605000 1                  TPL     s:8496+8
         1 001722   000044 036003                    ADLQ    36,DU
         1 001723   400000 503506                    ABD     0,QL,PR4
         1 001724   200017 454500                    STP4    BUF$,,AUTO
         1 001725   001726 710000 1                  TRA     s:8498

      542     8497    4                       ELSE GOTO DELBUG;
      543     8498    4                  IF READ

   8498  1 001726   200011 234100                    SZN     READ,,AUTO
         1 001727   001774 605000 1                  TPL     s:8517

      544     8499    5                  THEN DO;

      545     8500    5                       IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

   8500  1 001730   006714 235100                    LDA     3532,,PR0
         1 001731   000001 115007                    CMPA    1,DL
         1 001732   001742 601000 1                  TNZ     s:8506

      546     8501    6                       THEN DO;

      547     8502    6                            VALUE.SIZE = 1;

   8502  1 001733   000001 236007                    LDQ     1,DL
         1 001734   200003 474500                    LDP4    @VALUE,,AUTO
         1 001735   400000 756100                    STQ     0,,PR4

      548     8503    6                            VALUE.OPS(0) = BUF$ -> BUF$WORD;

   8503  1 001736   200017 475500                    LDP5    BUF$,,AUTO
         1 001737   500000 235100                    LDA     0,,PR5
         1 001740   400001 755100                    STA     1,,PR4

      549     8504    6                          END;

PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:88   
   8504  1 001741   002537 710000 1                  TRA     s:8633

      550     8505    6                       ELSE DO;

      551     8506    6                            TBUF$ = BUF$;

   8506  1 001742   200017 236100                    LDQ     BUF$,,AUTO
         1 001743   200020 756100                    STQ     TBUF$,,AUTO

      552     8507    7                            DO IX = 0 TO 15;

   8507  1 001744   200031 450100                    STZ     IX,,AUTO

      553     8508    7                                 VALUE.OPS(IX) = 0;

   8508  1 001745   200003 470500                    LDP0    @VALUE,,AUTO
         1 001746   200031 720100                    LXL0    IX,,AUTO
         1 001747   000001 450110                    STZ     1,X0,PR0

      554     8509    7                                 VALUE.OPSB.UBYTE(IX) = TBUF$ -> BUF$L6B.UBYTE;

   8509  1 001750   200031 236100                    LDQ     IX,,AUTO
         1 001751   000044 402007                    MPY     36,DL
         1 001752   200020 471500                    LDP1    TBUF$,,AUTO
         1 001753   003106 060500                    CSL     bolr='003'O
         1 001754   100000 010010                    BDSC    0,,PR1                   by=0,bit=1,n=8
         1 001755   000001 420010                    BDSC    1,Q,PR0                  by=2,bit=2,n=8

      555     8510    7                                 VALUE.OPSB.LBYTE(IX) = TBUF$ -> BUF$L6B.LBYTE;

   8510  1 001756   003106 060500                    CSL     bolr='003'O
         1 001757   100000 210010                    BDSC    0,,PR1                   by=1,bit=1,n=8
         1 001760   000001 610010                    BDSC    1,Q,PR0                  by=3,bit=1,n=8

      556     8511    7                                 TBUF$ = PINCRC(TBUF$, 2);

   8511  1 001761   200020 236100                    LDQ     TBUF$,,AUTO
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:89   
         1 001762   400000 036007                    ADLQ    -131072,DL
         1 001763   200020 756100                    STQ     TBUF$,,AUTO

      557     8512    7                               END;

   8512  1 001764   200031 235100                    LDA     IX,,AUTO
         1 001765   000001 035007                    ADLA    1,DL
         1 001766   200031 755100                    STA     IX,,AUTO
         1 001767   000020 115007                    CMPA    16,DL
         1 001770   001745 602000 1                  TNC     s:8508

      558     8513    6                            VALUE.SIZE = 16;

   8513  1 001771   000020 235007                    LDA     16,DL
         1 001772   000000 755100                    STA     0,,PR0

      559     8514    6                          END;

      560     8515    5                     END;

   8515  1 001773   002537 710000 1                  TRA     s:8633

      561     8516    5                  ELSE DO;

      562     8517    5                       CALL CHKBIRTH ALTRET( NOWBIR );

   8517  1 001774   002620 701000 1                  TSX1    CHKBIRTH
         1 001775   002550 702000 1                  TSX2    NOWBIR

      563     8518    5                       IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

   8518  1 001776   000000 470400 xsym               LDP0    S_D$
         1 001777   006714 235100                    LDA     3532,,PR0
         1 002000   000001 115007                    CMPA    1,DL
         1 002001   002007 601000 1                  TNZ     s:8521

      564     8519    5                       THEN BUF$ -> BUF$WORD = VALUE.OPS(0);
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:90   

   8519  1 002002   200003 471500                    LDP1    @VALUE,,AUTO
         1 002003   200017 473500                    LDP3    BUF$,,AUTO
         1 002004   100001 235100                    LDA     1,,PR1
         1 002005   300000 755100                    STA     0,,PR3
         1 002006   002042 710000 1                  TRA     s:8529

      565     8520    6                       ELSE DO;

      566     8521    6                            TBUF$ = BUF$;

   8521  1 002007   200017 236100                    LDQ     BUF$,,AUTO
         1 002010   200020 756100                    STQ     TBUF$,,AUTO

      567     8522    7                            DO IX = 0 TO VALUE.SIZE - 1;

   8522  1 002011   200031 450100                    STZ     IX,,AUTO
         1 002012   002036 710000 1                  TRA     s:8527+3

      568     8523    7                                 TBUF$ -> BUF$L6B = '0'B;

   8523  1 002013   200020 470500                    LDP0    TBUF$,,AUTO
         1 002014   000100 100400                    MLR     fill='000'O
         1 002015   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 002016   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2

      569     8524    7                                 TBUF$ -> BUF$L6B.UBYTE = VALUE.OPSB.UBYTE(IX);

   8524  1 002017   200031 236100                    LDQ     IX,,AUTO
         1 002020   000044 402007                    MPY     36,DL
         1 002021   200003 471500                    LDP1    @VALUE,,AUTO
         1 002022   003100 060506                    CSL     bolr='003'O
         1 002023   100001 420010                    BDSC    1,Q,PR1                  by=2,bit=2,n=8
         1 002024   000000 010010                    BDSC    0,,PR0                   by=0,bit=1,n=8

      570     8525    7                                 TBUF$ -> BUF$L6B.LBYTE = VALUE.OPSB.LBYTE(IX);

PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:91   
   8525  1 002025   003100 060506                    CSL     bolr='003'O
         1 002026   100001 610010                    BDSC    1,Q,PR1                  by=3,bit=1,n=8
         1 002027   000000 210010                    BDSC    0,,PR0                   by=1,bit=1,n=8

      571     8526    7                                 TBUF$ = PINCRC(TBUF$, 2);

   8526  1 002030   200020 236100                    LDQ     TBUF$,,AUTO
         1 002031   400000 036007                    ADLQ    -131072,DL
         1 002032   200020 756100                    STQ     TBUF$,,AUTO

      572     8527    7                               END;

   8527  1 002033   200031 235100                    LDA     IX,,AUTO
         1 002034   000001 035007                    ADLA    1,DL
         1 002035   200031 755100                    STA     IX,,AUTO
         1 002036   200003 470500                    LDP0    @VALUE,,AUTO
         1 002037   200031 236100                    LDQ     IX,,AUTO
         1 002040   000000 116100                    CMPQ    0,,PR0
         1 002041   002013 602000 1                  TNC     s:8523

      573     8528    6                          END;

      574     8529    5                       IF NOT S_D.RUM_TEST

   8529  1 002042   000000 470400 xsym               LDP0    S_D$
         1 002043   005004 234100                    SZN     2564,,PR0
         1 002044   002537 604000 1                  TMI     s:8633

      575     8530    5                       THEN IF S_D.RCBC.WRITE_THRU

   8530  1 002045   000516 234100                    SZN     334,,PR0
         1 002046   002100 605000 1                  TPL     s:8535

      576     8531    6                            THEN DO;

      577     8532    6                                 S_D.RCBC.WRITTEN( CBX ) = '1'B;

PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:92   
   8532  1 002047   200012 236100                    LDQ     CBX,,AUTO
         1 002050   000022 402007                    MPY     18,DL
         1 002051   003106 060400                    CSL     bolr='003'O
         1 002052   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         1 002053   000560 000001                    BDSC    368,Q,PR0                by=0,bit=0,n=1

      578     8533    6                                CALL DDQ$WRITELM( %TYPPROG, PAGE, NODE, S_D.RCBC.BUF$(
              8533                                          CBX), S_D.RCBC.SIZE(CBX) ) ALTRET( NOWREC );

   8533  1 002054   200012 236100                    LDQ     CBX,,AUTO
         1 002055   000022 736000                    QLS     18
         1 002056   000546 036003                    ADLQ    358,DU
         1 002057   000000 036000 xsym               ADLQ    S_D$
         1 002060   200056 756100                    STQ     TEMP$WORD+7,,AUTO
         1 002061   200012 236100                    LDQ     CBX,,AUTO
         1 002062   000022 736000                    QLS     18
         1 002063   000522 036003                    ADLQ    338,DU
         1 002064   000000 036000 xsym               ADLQ    S_D$
         1 002065   200004 235100                    LDA     @NODE,,AUTO
         1 002066   200054 757100                    STAQ    TEMP$WORD+5,,AUTO
         1 002067   200027 631500                    EPPR1   PAGE,,AUTO
         1 002070   200053 451500                    STP1    TEMP$WORD+4,,AUTO
         1 002071   000000 236000 2                  LDQ     0
         1 002072   200052 756100                    STQ     TEMP$WORD+3,,AUTO
         1 002073   200052 630500                    EPPR0   TEMP$WORD+3,,AUTO
         1 002074   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 002075   000000 701000 xent               TSX1    DDQ$WRITELM
         1 002076   002541 702000 1                  TSX2    NORREC

      579     8534    6                               END;

   8534  1 002077   002537 710000 1                  TRA     s:8633

      580     8535    5                            ELSE S_D.RCBC.WRITTEN( CBX ) ='0'B;

   8535  1 002100   200012 236100                    LDQ     CBX,,AUTO
         1 002101   000022 402007                    MPY     18,DL
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:93   
         1 002102   003106 060400                    CSL     bolr='003'O
         1 002103   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         1 002104   000560 000001                    BDSC    368,Q,PR0                by=0,bit=0,n=1

      581     8536    5                     END;

      582     8537    4                END;

   8537  1 002105   002537 710000 1                  TRA     s:8633

      583     8538    4             ELSE DO;

      584     8539    4                  TADDRESS = ADDRESS;

   8539  1 002106   200005 473500                    LDP3    @ADDRESS,,AUTO
         1 002107   300000 235100                    LDA     0,,PR3
         1 002110   200021 755100                    STA     TADDRESS,,AUTO

      585     8540    4                  IF READ

   8540  1 002111   200011 234100                    SZN     READ,,AUTO
         1 002112   002116 605000 1                  TPL     s:8542

      586     8541    4                  THEN TSIZE = 16;

   8541  1 002113   000020 236007                    LDQ     16,DL
         1 002114   200022 756100                    STQ     TSIZE,,AUTO
         1 002115   002121 710000 1                  TRA     s:8543

      587     8542    4                  ELSE TSIZE = VALUE.SIZE;

   8542  1 002116   200003 474500                    LDP4    @VALUE,,AUTO
         1 002117   400000 235100                    LDA     0,,PR4
         1 002120   200022 755100                    STA     TSIZE,,AUTO

      588     8543    5                  DO IXX = 0 TO TSIZE - 1;

PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:94   
   8543  1 002121   200023 450100                    STZ     IXX,,AUTO
         1 002122   002527 710000 1                  TRA     s:8628+3

      589     8544    5                       IF S_D.OVERLAID

   8544  1 002123   000000 470400 xsym               LDP0    S_D$
         1 002124   004764 234100                    SZN     2548,,PR0
         1 002125   002157 605000 1                  TPL     s:8558

      590     8545    6                       THEN DO;

      591     8546    6                            BUF$ = PINCRW( S_D.B$TREE$, SIZEW( B$NODE ) * NODE );

   8546  1 002126   200004 471500                    LDP1    @NODE,,AUTO
         1 002127   100000 720100                    LXL0    0,,PR1
         1 002130   004767 473500                    LDP3    2551,,PR0
         1 002131   000000 636010                    EAQ     0,X0
         1 002132   000022 772000                    QRL     18
         1 002133   000006 402007                    MPY     6,DL
         1 002134   300000 634506                    EPPR4   0,QL,PR3
         1 002135   200017 454500                    STP4    BUF$,,AUTO

      592     8547    6                            IF TADDRESS < S_D.PADDR

   8547  1 002136   200021 236100                    LDQ     TADDRESS,,AUTO
         1 002137   004765 116100                    CMPQ    2549,,PR0
         1 002140   002150 603000 1                  TRC     s:8553

      593     8548    7                            THEN DO;

      594     8549    7                                 PSTART = BUF$ -> B$NODE.DADDR( 0 );

   8549  1 002141   400004 236100                    LDQ     4,,PR4
         1 002142   000022 772000                    QRL     18
         1 002143   200024 756100                    STQ     PSTART,,AUTO

      595     8550    7                                 PSIZE = BUF$ -> B$NODE.DSIZE( 0 );
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:95   

   8550  1 002144   400004 236100                    LDQ     4,,PR4
         1 002145   777777 376007                    ANQ     -1,DL
         1 002146   200025 756100                    STQ     PSIZE,,AUTO

      596     8551    7                               END;

   8551  1 002147   002177 710000 1                  TRA     s:8568

      597     8552    7                            ELSE DO;

      598     8553    7                                 PSTART = BUF$ -> B$NODE.PADDR( 0 );

   8553  1 002150   400003 236100                    LDQ     3,,PR4
         1 002151   000022 772000                    QRL     18
         1 002152   200024 756100                    STQ     PSTART,,AUTO

      599     8554    7                                 PSIZE = BUF$ -> B$NODE.PSIZE( 0 );

   8554  1 002153   400003 236100                    LDQ     3,,PR4
         1 002154   777777 376007                    ANQ     -1,DL
         1 002155   200025 756100                    STQ     PSIZE,,AUTO

      600     8555    7                               END;

      601     8556    6                          END;

   8556  1 002156   002177 710000 1                  TRA     s:8568

      602     8557    6                       ELSE DO;

      603     8558    6                            IF TADDRESS < S_D.PADDR

   8558  1 002157   200021 236100                    LDQ     TADDRESS,,AUTO
         1 002160   004765 116100                    CMPQ    2549,,PR0
         1 002161   002171 603000 1                  TRC     s:8564

PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:96   
      604     8559    7                            THEN DO;

      605     8560    7                                 PSTART = L6_DATA_START;

   8560  1 002162   000141 235000 0                  LDA     L6_DATA_START
         1 002163   200024 755100                    STA     PSTART,,AUTO

      606     8561    7                                 PSIZE = S_D.RUM_HEAD$ -> B$HEAD.RDATA;

   8561  1 002164   005001 471500                    LDP1    2561,,PR0
         1 002165   100002 236100                    LDQ     2,,PR1
         1 002166   000005 376000 2                  ANQ     5
         1 002167   200025 756100                    STQ     PSIZE,,AUTO

      607     8562    7                               END;

   8562  1 002170   002177 710000 1                  TRA     s:8568

      608     8563    7                            ELSE DO;

      609     8564    7                                 PSTART = S_D.PADDR;

   8564  1 002171   004765 235100                    LDA     2549,,PR0
         1 002172   200024 755100                    STA     PSTART,,AUTO

      610     8565    7                                 PSIZE = S_D.RUM_HEAD$ -> B$HEAD.RPROC;

   8565  1 002173   005001 471500                    LDP1    2561,,PR0
         1 002174   100001 236100                    LDQ     1,,PR1
         1 002175   000005 376000 2                  ANQ     5
         1 002176   200025 756100                    STQ     PSIZE,,AUTO

      611     8566    7                               END;

      612     8567    6                          END;

      613     8568    5                       IF TADDRESS >= PSTART + PSIZE AND NOT S_D.RUM_FEP
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:97   

   8568  1 002177   200024 036100                    ADLQ    PSTART,,AUTO
         1 002200   002204 604000 1                  TMI     s:8568+5
         1 002201   200021 116100                    CMPQ    TADDRESS,,AUTO
         1 002202   002204 600000 1                  TZE     s:8568+5
         1 002203   002216 603000 1                  TRC     s:8577
         1 002204   007017 234100                    SZN     3599,,PR0
         1 002205   002216 604000 1                  TMI     s:8577

      614     8569    6                       THEN DO;

      615     8570    6                            IF IXX > 0

   8570  1 002206   200023 235100                    LDA     IXX,,AUTO
         1 002207   001354 601000 1                  TNZ     ONE_WORD

      616     8571    6                            THEN GOTO ONE_WORD;
      617     8572    6                            S_D.ERROR = 131; /* E@NOTYOURS */

   8572  1 002210   000203 236007                    LDQ     131,DL
         1 002211   000013 756100                    STQ     11,,PR0

      618     8573    6                            IF S_D.FIND_RUM

   8573  1 002212   000073 234100                    SZN     59,,PR0
         1 002213   002215 605000 1                  TPL     s:8575

      619     8574    6                            THEN S_D.ERROR = 131; /* E@NOTYOURS */

   8574  1 002214   000013 756100                    STQ     11,,PR0

      620     8575    6                            GOTO ARET;

   8575  1 002215   002616 710000 1                  TRA     ARET

      621     8576    6                          END;
      622     8577    5                       PAGE = (TADDRESS / 2048) * 2048;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:98   

   8577  1 002216   200021 236100                    LDQ     TADDRESS,,AUTO
         1 002217   000013 772000                    QRL     11
         1 002220   000013 736000                    QLS     11
         1 002221   200027 756100                    STQ     PAGE,,AUTO

      623     8578    5                       LRU = 0;

   8578  1 002222   200046 450100                    STZ     LRU,,AUTO

      624     8579    5                       SEQ = S_D.RCBC.SEQ( 0 );

   8579  1 002223   000572 235100                    LDA     378,,PR0
         1 002224   200045 755100                    STA     SEQ,,AUTO

      625     8580    5                       S_D.RCBC.CUR_SEQ = S_D.RCBC.CUR_SEQ + 1;

   8580  1 002225   000517 235100                    LDA     335,,PR0
         1 002226   000001 035007                    ADLA    1,DL
         1 002227   000517 755100                    STA     335,,PR0

      626     8581    6                       DO CBX = 0 TO S_D.RCBC.BUFSM1;

   8581  1 002230   200012 450100                    STZ     CBX,,AUTO
         1 002231   002262 710000 1                  TRA     s:8590+3

      627     8582    6                            IF ( S_D.RCBC.PAGE( CBX ) = PAGE ) AND

   8582  1 002232   000000 470400 xsym               LDP0    S_D$
         1 002233   200012 720100                    LXL0    CBX,,AUTO
         1 002234   000534 236110                    LDQ     348,X0,PR0
         1 002235   002251 604000 1                  TMI     s:8585
         1 002236   200027 116100                    CMPQ    PAGE,,AUTO
         1 002237   002251 601000 1                  TNZ     s:8585
         1 002240   200004 471500                    LDP1    @NODE,,AUTO
         1 002241   200012 235100                    LDA     CBX,,AUTO
         1 002242   000001 735000                    ALS     1
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:99   
         1 002243   000100 101505                    MRL     fill='000'O
         1 002244   000565 000002                    ADSC9   373,A,PR0                cn=0,n=2
         1 002245   200052 000004                    ADSC9   TEMP$WORD+3,,AUTO        cn=0,n=4
         1 002246   200052 236100                    LDQ     TEMP$WORD+3,,AUTO
         1 002247   100000 116100                    CMPQ    0,,PR1
         1 002250   002406 600000 1                  TZE     INBUF1

      628     8583    6                              ( S_D.RCBC.NODE( CBX ) = NODE )
      629     8584    6                            THEN GOTO INBUF1;
      630     8585    6                            IF S_D.RCBC.SEQ( CBX ) < SEQ

   8585  1 002251   000572 236110                    LDQ     378,X0,PR0
         1 002252   200045 116100                    CMPQ    SEQ,,AUTO
         1 002253   002257 603000 1                  TRC     s:8590

      631     8586    7                            THEN DO;

      632     8587    7                                 LRU = CBX;

   8587  1 002254   200012 235100                    LDA     CBX,,AUTO
         1 002255   200046 755100                    STA     LRU,,AUTO

      633     8588    7                                 SEQ = S_D.RCBC.SEQ( CBX );

   8588  1 002256   200045 756100                    STQ     SEQ,,AUTO

      634     8589    7                               END;

      635     8590    6                          END;

   8590  1 002257   200012 235100                    LDA     CBX,,AUTO
         1 002260   000001 035007                    ADLA    1,DL
         1 002261   200012 755100                    STA     CBX,,AUTO
         1 002262   000521 236100                    LDQ     337,,PR0
         1 002263   200012 116100                    CMPQ    CBX,,AUTO
         1 002264   002232 603000 1                  TRC     s:8582

PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:100  
      636     8591    5                       CBX = LRU;

   8591  1 002265   200046 235100                    LDA     LRU,,AUTO
         1 002266   200012 755100                    STA     CBX,,AUTO

      637     8592    5                       IF NOT S_D.RCBC.WRITTEN( CBX ) AND

   8592  1 002267   200012 236100                    LDQ     CBX,,AUTO
         1 002270   000022 402007                    MPY     18,DL
         1 002271   000000 066506                    CMPB    filb='0'B
         1 002272   000560 000001                    BDSC    368,Q,PR0                by=0,bit=0,n=1
         1 002273   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 002274   002334 601000 1                  TNZ     s:8599
         1 002275   200012 720100                    LXL0    CBX,,AUTO
         1 002276   000534 235110                    LDA     348,X0,PR0
         1 002277   000027 115000 xsym               CMPA    B_VECTNIL+23
         1 002300   002334 600000 1                  TZE     s:8599

      638     8593    5                         S_D.RCBC.PAGE( CBX ) ~= -1
      639     8594    6                       THEN DO;

      640     8595    6                            TNODE = S_D.RCBC.NODE( CBX );

   8595  1 002301   200012 235100                    LDA     CBX,,AUTO
         1 002302   000001 735000                    ALS     1
         1 002303   000100 101505                    MRL     fill='000'O
         1 002304   000565 000002                    ADSC9   373,A,PR0                cn=0,n=2
         1 002305   200013 000004                    ADSC9   TNODE,,AUTO              cn=0,n=4

      641     8596    6                            CALL DDQ$WRITELM( %TYPPROG, S_D.RCBC.PAGE(CBX), TNODE,

   8596  1 002306   200012 236100                    LDQ     CBX,,AUTO
         1 002307   000022 736000                    QLS     18
         1 002310   000546 036003                    ADLQ    358,DU
         1 002311   000000 036000 xsym               ADLQ    S_D$
         1 002312   200056 756100                    STQ     TEMP$WORD+7,,AUTO
         1 002313   200012 236100                    LDQ     CBX,,AUTO
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:101  
         1 002314   000022 736000                    QLS     18
         1 002315   000522 036003                    ADLQ    338,DU
         1 002316   000000 036000 xsym               ADLQ    S_D$
         1 002317   200055 756100                    STQ     TEMP$WORD+6,,AUTO
         1 002320   200013 631500                    EPPR1   TNODE,,AUTO
         1 002321   200054 451500                    STP1    TEMP$WORD+5,,AUTO
         1 002322   200012 236100                    LDQ     CBX,,AUTO
         1 002323   000022 736000                    QLS     18
         1 002324   000534 036003                    ADLQ    348,DU
         1 002325   000000 036000 xsym               ADLQ    S_D$
         1 002326   000000 235000 2                  LDA     0
         1 002327   200052 757100                    STAQ    TEMP$WORD+3,,AUTO
         1 002330   200052 630500                    EPPR0   TEMP$WORD+3,,AUTO
         1 002331   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 002332   000000 701000 xent               TSX1    DDQ$WRITELM
         1 002333   002541 702000 1                  TSX2    NORREC

      642     8597    6                             S_D.RCBC.BUF$(CBX), S_D.RCBC.SIZE(CBX) ) ALTRET( NOWREC )
              8597                                       ;
      643     8598    6                          END;

      644     8599    5                       SIZE = S_D.RCBC.BUFSIZE * SIZEC( SIZE );

   8599  1 002334   000000 470400 xsym               LDP0    S_D$
         1 002335   000520 235100                    LDA     336,,PR0
         1 002336   000002 735000                    ALS     2
         1 002337   200026 755100                    STA     SIZE,,AUTO

      645     8600    5                       S_D.RCBC.SIZE( CBX ) = 0; /* Positive */

   8600  1 002340   200012 720100                    LXL0    CBX,,AUTO
         1 002341   000546 450110                    STZ     358,X0,PR0

      646     8601    5                      CALL DDQ$READLM( %TYPPROG, PAGE, NODE, S_D.RCBC.BUF$(CBX), SIZE,
              8601                                S_D.RCBC.SIZE(CBX) ) ALTRET( NORREC );

   8601  1 002342   200012 236100                    LDQ     CBX,,AUTO
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:102  
         1 002343   000022 736000                    QLS     18
         1 002344   000546 036003                    ADLQ    358,DU
         1 002345   000000 036000 xsym               ADLQ    S_D$
         1 002346   200057 756100                    STQ     TEMP$WORD+8,,AUTO
         1 002347   200026 631500                    EPPR1   SIZE,,AUTO
         1 002350   200056 451500                    STP1    TEMP$WORD+7,,AUTO
         1 002351   200012 236100                    LDQ     CBX,,AUTO
         1 002352   000022 736000                    QLS     18
         1 002353   000522 036003                    ADLQ    338,DU
         1 002354   000000 036000 xsym               ADLQ    S_D$
         1 002355   200004 235100                    LDA     @NODE,,AUTO
         1 002356   200054 757100                    STAQ    TEMP$WORD+5,,AUTO
         1 002357   200027 633500                    EPPR3   PAGE,,AUTO
         1 002360   200053 453500                    STP3    TEMP$WORD+4,,AUTO
         1 002361   000000 236000 2                  LDQ     0
         1 002362   200052 756100                    STQ     TEMP$WORD+3,,AUTO
         1 002363   200052 630500                    EPPR0   TEMP$WORD+3,,AUTO
         1 002364   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 002365   000000 701000 xent               TSX1    DDQ$READLM
         1 002366   002541 702000 1                  TSX2    NORREC

      647     8602    5                       S_D.RCBC.PAGE( CBX ) = PAGE;

   8602  1 002367   200027 235100                    LDA     PAGE,,AUTO
         1 002370   000000 470400 xsym               LDP0    S_D$
         1 002371   200012 720100                    LXL0    CBX,,AUTO
         1 002372   000534 755110                    STA     348,X0,PR0

      648     8603    5                       S_D.RCBC.NODE( CBX ) = NODE;

   8603  1 002373   200012 236100                    LDQ     CBX,,AUTO
         1 002374   000001 736000                    QLS     1
         1 002375   200004 471500                    LDP1    @NODE,,AUTO
         1 002376   000106 101500                    MRL     fill='000'O
         1 002377   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         1 002400   000565 000002                    ADSC9   373,Q,PR0                cn=0,n=2

PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:103  
      649     8604    5                       S_D.RCBC.WRITTEN( CBX ) = '1'B;

   8604  1 002401   200012 236100                    LDQ     CBX,,AUTO
         1 002402   000022 402007                    MPY     18,DL
         1 002403   003106 060400                    CSL     bolr='003'O
         1 002404   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         1 002405   000560 000001                    BDSC    368,Q,PR0                by=0,bit=0,n=1

   8604  1 002406                       INBUF1       null
      650     8605    5   INBUF1:             ;
      651     8606    5                       S_D.RCBC.SEQ( CBX ) = S_D.RCBC.CUR_SEQ;

   8606  1 002406   000517 235100                    LDA     335,,PR0
         1 002407   000572 755110                    STA     378,X0,PR0

      652     8607    5                       BUF$ = PINCRC( S_D.RCBC.BUF$(CBX), (TADDRESS - PAGE) * 2);

   8607  1 002410   200021 236100                    LDQ     TADDRESS,,AUTO
         1 002411   200027 136100                    SBLQ    PAGE,,AUTO
         1 002412   000522 473510                    LDP3    338,X0,PR0
         1 002413   000022 402007                    MPY     18,DL
         1 002414   000000 116003                    CMPQ    0,DU
         1 002415   002417 605000 1                  TPL     s:8607+7
         1 002416   000044 036003                    ADLQ    36,DU
         1 002417   300000 503506                    ABD     0,QL,PR3
         1 002420   200017 453500                    STP3    BUF$,,AUTO

      653     8608    5                       IF READ

   8608  1 002421   200011 234100                    SZN     READ,,AUTO
         1 002422   002437 605000 1                  TPL     s:8615

      654     8609    6                       THEN DO;

      655     8610    6                            VALUE.OPS(IXX) = 0;

   8610  1 002423   200003 474500                    LDP4    @VALUE,,AUTO
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:104  
         1 002424   200023 721100                    LXL1    IXX,,AUTO
         1 002425   400001 450111                    STZ     1,X1,PR4

      656     8611    6                            VALUE.OPSB.UBYTE(IXX) = BUF$ -> BUF$L6B.UBYTE;

   8611  1 002426   200023 236100                    LDQ     IXX,,AUTO
         1 002427   000044 402007                    MPY     36,DL
         1 002430   003106 060500                    CSL     bolr='003'O
         1 002431   300000 010010                    BDSC    0,,PR3                   by=0,bit=1,n=8
         1 002432   400001 420010                    BDSC    1,Q,PR4                  by=2,bit=2,n=8

      657     8612    6                            VALUE.OPSB.LBYTE(IXX) = BUF$ -> BUF$L6B.LBYTE;

   8612  1 002433   003106 060500                    CSL     bolr='003'O
         1 002434   300000 210010                    BDSC    0,,PR3                   by=1,bit=1,n=8
         1 002435   400001 610010                    BDSC    1,Q,PR4                  by=3,bit=1,n=8

      658     8613    6                          END;

   8613  1 002436   002521 710000 1                  TRA     s:8627

      659     8614    6                       ELSE DO;

      660     8615    6                            CALL CHKBIRTH ALTRET( NOWBIR );

   8615  1 002437   002620 701000 1                  TSX1    CHKBIRTH
         1 002440   002550 702000 1                  TSX2    NOWBIR

      661     8616    6                            BUF$ -> BUF$L6B = '0'B;

   8616  1 002441   200017 470500                    LDP0    BUF$,,AUTO
         1 002442   000100 100400                    MLR     fill='000'O
         1 002443   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 002444   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2

      662     8617    6                            BUF$ -> BUF$L6B.UBYTE = VALUE.OPSB.UBYTE(IXX);

PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:105  
   8617  1 002445   200023 236100                    LDQ     IXX,,AUTO
         1 002446   000044 402007                    MPY     36,DL
         1 002447   200003 471500                    LDP1    @VALUE,,AUTO
         1 002450   003100 060506                    CSL     bolr='003'O
         1 002451   100001 420010                    BDSC    1,Q,PR1                  by=2,bit=2,n=8
         1 002452   000000 010010                    BDSC    0,,PR0                   by=0,bit=1,n=8

      663     8618    6                            BUF$ -> BUF$L6B.LBYTE = VALUE.OPSB.LBYTE(IXX);

   8618  1 002453   003100 060506                    CSL     bolr='003'O
         1 002454   100001 610010                    BDSC    1,Q,PR1                  by=3,bit=1,n=8
         1 002455   000000 210010                    BDSC    0,,PR0                   by=1,bit=1,n=8

      664     8619    6                            IF NOT S_D.RUM_TEST

   8619  1 002456   000000 473400 xsym               LDP3    S_D$
         1 002457   305004 234100                    SZN     2564,,PR3
         1 002460   002521 604000 1                  TMI     s:8627

      665     8620    6                            THEN IF S_D.RCBC.WRITE_THRU

   8620  1 002461   300516 234100                    SZN     334,,PR3
         1 002462   002514 605000 1                  TPL     s:8625

      666     8621    7                                 THEN DO;

      667     8622    7                                      S_D.RCBC.WRITTEN( CBX ) = '1'B;

   8622  1 002463   200012 236100                    LDQ     CBX,,AUTO
         1 002464   000022 402007                    MPY     18,DL
         1 002465   003106 060400                    CSL     bolr='003'O
         1 002466   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         1 002467   300560 000001                    BDSC    368,Q,PR3                by=0,bit=0,n=1

      668     8623    7                                     CALL DDQ$WRITELM( %TYPPROG, PAGE, NODE, S_D.RCBC.
              8623                                               BUF$(CBX), S_D.RCBC.SIZE(CBX) ) ALTRET(
              8623                                               NOWREC );
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:106  

   8623  1 002470   200012 236100                    LDQ     CBX,,AUTO
         1 002471   000022 736000                    QLS     18
         1 002472   000546 036003                    ADLQ    358,DU
         1 002473   000000 036000 xsym               ADLQ    S_D$
         1 002474   200056 756100                    STQ     TEMP$WORD+7,,AUTO
         1 002475   200012 236100                    LDQ     CBX,,AUTO
         1 002476   000022 736000                    QLS     18
         1 002477   000522 036003                    ADLQ    338,DU
         1 002500   000000 036000 xsym               ADLQ    S_D$
         1 002501   200004 235100                    LDA     @NODE,,AUTO
         1 002502   200054 757100                    STAQ    TEMP$WORD+5,,AUTO
         1 002503   200027 634500                    EPPR4   PAGE,,AUTO
         1 002504   200053 454500                    STP4    TEMP$WORD+4,,AUTO
         1 002505   000000 236000 2                  LDQ     0
         1 002506   200052 756100                    STQ     TEMP$WORD+3,,AUTO
         1 002507   200052 630500                    EPPR0   TEMP$WORD+3,,AUTO
         1 002510   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 002511   000000 701000 xent               TSX1    DDQ$WRITELM
         1 002512   002541 702000 1                  TSX2    NORREC

      669     8624    7                                    END;

   8624  1 002513   002521 710000 1                  TRA     s:8627

      670     8625    6                                 ELSE S_D.RCBC.WRITTEN( CBX ) ='0'B;

   8625  1 002514   200012 236100                    LDQ     CBX,,AUTO
         1 002515   000022 402007                    MPY     18,DL
         1 002516   003106 060400                    CSL     bolr='003'O
         1 002517   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         1 002520   300560 000001                    BDSC    368,Q,PR3                by=0,bit=0,n=1

      671     8626    6                          END;

      672     8627    5                       TADDRESS = TADDRESS + 1;

PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:107  
   8627  1 002521   200021 235100                    LDA     TADDRESS,,AUTO
         1 002522   000001 035007                    ADLA    1,DL
         1 002523   200021 755100                    STA     TADDRESS,,AUTO

      673     8628    5                     END;

   8628  1 002524   200023 236100                    LDQ     IXX,,AUTO
         1 002525   000001 036007                    ADLQ    1,DL
         1 002526   200023 756100                    STQ     IXX,,AUTO
         1 002527   200023 236100                    LDQ     IXX,,AUTO
         1 002530   200022 116100                    CMPQ    TSIZE,,AUTO
         1 002531   002123 602000 1                  TNC     s:8544

      674     8629    4                  IF READ

   8629  1 002532   200011 234100                    SZN     READ,,AUTO
         1 002533   002537 605000 1                  TPL     s:8633

      675     8630    4                  THEN VALUE.SIZE = 16;

   8630  1 002534   000020 235007                    LDA     16,DL
         1 002535   200003 470500                    LDP0    @VALUE,,AUTO
         1 002536   000000 755100                    STA     0,,PR0

      676     8631    4                END;

      677     8632    3           END;

      678     8633    2        RETURN;

   8633  1 002537   200016 221300                    LDX1  ! NWORD_L6+1,,AUTO
         1 002540   000001 702211                    TSX2  ! 1,X1

   8629  1 002541                       NORREC       null
   8629  1 002541                       NOWREC       null
      679     8634                                                /**/
      680     8635    2   NORREC: ;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:108  
      681     8636    2   NOWREC: ;
      682     8637    2        S_D.RCBC.PAGE( CBX ) = -1;

   8637  1 002541   000001 335007                    LCA     1,DL
         1 002542   000000 470400 xsym               LDP0    S_D$
         1 002543   200012 720100                    LXL0    CBX,,AUTO
         1 002544   000534 755110                    STA     348,X0,PR0

      683     8638    2        S_D.ERROR = 132;           /* E@NOPROGREC */

   8638  1 002545   000204 236007                    LDQ     132,DL
         1 002546   000013 756100                    STQ     11,,PR0

      684     8639    2        GOTO ARET;

   8639  1 002547   002616 710000 1                  TRA     ARET

   8638  1 002550                       NOWBIR       null
      685     8640
      686     8641    2   NOWBIR: ;
      687     8642    2        S_D.ERROR = 194;            /* E@NOWBIRTH */

   8642  1 002550   000302 235007                    LDA     194,DL
         1 002551   000000 470400 xsym               LDP0    S_D$
         1 002552   000013 755100                    STA     11,,PR0

      688     8643    2        GOTO ARET;

   8643  1 002553   002616 710000 1                  TRA     ARET

   8642  1 002554                       NOWWH        null
      689     8644
      690     8645    2   NOWWH: ;
      691     8646    2        S_D.ERROR = 203;             /* E@NOWHEAD */

   8646  1 002554   000313 235007                    LDA     203,DL
         1 002555   000000 470400 xsym               LDP0    S_D$
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:109  
         1 002556   000013 755100                    STA     11,,PR0

      692     8647    2        GOTO ARET;

   8647  1 002557   002616 710000 1                  TRA     ARET

   8646  1 002560                       NOWROS       null
      693     8648
      694     8649    2   NOWROS: ;
      695     8650    2        S_D.ERROR = 204;              /* E@NOWROS */

   8650  1 002560   000314 235007                    LDA     204,DL
         1 002561   000000 470400 xsym               LDP0    S_D$
         1 002562   000013 755100                    STA     11,,PR0

      696     8651    2        GOTO ARET;

   8651  1 002563   002616 710000 1                  TRA     ARET

   8650  1 002564                       NODCBS       null
      697     8652
      698     8653    2   NODCBS: ;
      699     8654    2        S_D.ERROR = 130;             /* E@WARNROS */

   8654  1 002564   000202 235007                    LDA     130,DL
         1 002565   300013 755100                    STA     11,,PR3

      700     8655    2        GOTO ARET;

   8655  1 002566   002616 710000 1                  TRA     ARET

   8654  1 002567                       NODCB        null
      701     8656
      702     8657    2   NODCB: ;
      703     8658    2        S_D.ERROR = 183;               /* E@NODCB */

   8658  1 002567   000267 235007                    LDA     183,DL
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:110  
         1 002570   300013 755100                    STA     11,,PR3

      704     8659    2        GOTO ARET;

   8659  1 002571   002616 710000 1                  TRA     ARET

   8658  1 002572                       NOTINDCB     null
      705     8660
      706     8661    2   NOTINDCB: ;
      707     8662    2        S_D.ERROR = 209;             /* E@DCBOUND */

   8662  1 002572   000321 235007                    LDA     209,DL
         1 002573   300013 755100                    STA     11,,PR3

      708     8663    2        GOTO ARET;

   8663  1 002574   002616 710000 1                  TRA     ARET

   8662  1 002575                       NOTINHEAD    null
      709     8664
      710     8665    2   NOTINHEAD: ;
      711     8666    2        S_D.ERROR = 213;              /* E@NIHEAD */

   8666  1 002575   000325 236007                    LDQ     213,DL
         1 002576   000000 473400 xsym               LDP3    S_D$
         1 002577   300013 756100                    STQ     11,,PR3

      712     8667    2        GOTO ARET;

   8667  1 002600   002616 710000 1                  TRA     ARET

   8666  1 002601                       NOTINRUM     null
      713     8668
      714     8669    2   NOTINRUM: ;
      715     8670    2        S_D.ERROR = 232;             /* E@NOSSRUM */

   8670  1 002601   000350 236007                    LDQ     232,DL
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:111  
         1 002602   000000 473400 xsym               LDP3    S_D$
         1 002603   300013 756100                    STQ     11,,PR3

      716     8671    2        GOTO ARET;

   8671  1 002604   002616 710000 1                  TRA     ARET

   8670  1 002605                       NILDCB       null
      717     8672
      718     8673    2   NILDCB: ;
      719     8674    2        S_D.ERROR = 184;              /* E@DCBNIL */

   8674  1 002605   000270 235007                    LDA     184,DL
         1 002606   300013 755100                    STA     11,,PR3

      720     8675    2        GOTO ARET;

   8675  1 002607   002616 710000 1                  TRA     ARET

   8674  1 002610                       DELBUG       null
      721     8676
      722     8677    2   DELBUG: ;
      723     8678    2        S_D.ERROR = 502;              /* E@DELBUG */

   8678  1 002610   000766 235007                    LDA     502,DL
         1 002611   000000 470400 xsym               LDP0    S_D$
         1 002612   000013 755100                    STA     11,,PR0

      724     8679    2        CALL DDE$ERROR;

   8679  1 002613   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 002614   000000 701000 xent               TSX1    DDE$ERROR
         1 002615   000000 011000                    NOP     0

   8678  1 002616                       ARET         null
      725     8680        /****GOTO ARET;****/
      726     8681                                                /**/
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:112  
      727     8682    2   ARET: ;
      728     8683    2        ALTRETURN;

   8683  1 002616   200016 221300                    LDX1  ! NWORD_L6+1,,AUTO
         1 002617   000000 702211                    TSX2  ! 0,X1

      729     8684        %EJECT;
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:113  
      730     8685                                                /**/
      731     8686    2   CHKBIRTH: PROC ALTRET;

   8686  1 002620   200050 741300       CHKBIRTH     STX1  ! TEMP$WORD+1,,AUTO

      732     8687                                                /**/
      733     8688    3        IF ( S_D.RUMSEQ = 0 ) AND ( S_D.RUM_BIRTH$ ~= ADDR( NIL ) ) AND (NOT S_D.
              8688                 RUM_TEST)

   8688  1 002621   000000 470400 xsym               LDP0    S_D$
         1 002622   005000 235100                    LDA     2560,,PR0
         1 002623   002654 601000 1                  TNZ     s:8695
         1 002624   000502 236100                    LDQ     322,,PR0
         1 002625   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002626   002654 600000 1                  TZE     s:8695
         1 002627   005004 234100                    SZN     2564,,PR0
         1 002630   002654 604000 1                  TMI     s:8695

      734     8689    4        THEN DO;

      735     8690    4             S_D.RUM_BIRTH$ -> B$RUBIRTH.RUMED_UTS = S_D.RUMUTS;

   8690  1 002631   000502 471500                    LDP1    322,,PR0
         1 002632   004777 235100                    LDA     2559,,PR0
         1 002633   100001 755100                    STA     1,,PR1

      736     8691    4            S_D.RUM_BIRTH$ -> B$RUBIRTH.COUNT = S_D.RUM_BIRTH$ -> B$RUBIRTH.COUNT + 1;

   8691  1 002634   000502 471500                    LDP1    322,,PR0
         1 002635   100002 235100                    LDA     2,,PR1
         1 002636   000001 035007                    ADLA    1,DL
         1 002637   100002 755100                    STA     2,,PR1

      737     8692    4             CALL DDQ$WRITELM( %TYPBIRTH, 0, 0, S_D.RUM_BIRTH$, SIZEC( B$RUBIRTH ) )
              8692                      ALTRET( ARET );

   8692  1 002640   000016 236000 2                  LDQ     14
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:114  
         1 002641   200056 756100                    STQ     TEMP$WORD+7,,AUTO
         1 002642   000000 236000 xsym               LDQ     S_D$
         1 002643   000502 036003                    ADLQ    322,DU
         1 002644   000003 235000 2                  LDA     3
         1 002645   200054 757100                    STAQ    TEMP$WORD+5,,AUTO
         1 002646   000020 237000 2                  LDAQ    16
         1 002647   200052 757100                    STAQ    TEMP$WORD+3,,AUTO
         1 002650   200052 630500                    EPPR0   TEMP$WORD+3,,AUTO
         1 002651   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 002652   000000 701000 xent               TSX1    DDQ$WRITELM
         1 002653   002656 702000 1                  TSX2    ARET

      738     8693    4           END;

      739     8694                                                /**/
      740     8695    3        RETURN;

   8695  1 002654   200050 221300                    LDX1  ! TEMP$WORD+1,,AUTO
         1 002655   000001 702211                    TSX2  ! 1,X1

   8692  1 002656                       ARET         null
      741     8696                                                /**/
      742     8697    3   ARET: ;
      743     8698    3        ALTRETURN;

   8698  1 002656   200050 221300                    LDX1  ! TEMP$WORD+1,,AUTO
         1 002657   000000 702211                    TSX2  ! 0,X1

M$MDCB
 Sect OctLoc
   0     000   000000 000000   000000 000000   000000 000000   000000 000501    ................
   0     004   000000 000000   000000 000000   000000 006014   000000 006014    ................
   0     010   001040 040040   040040 040040   040040 040040   040040 040040    .
   0     014   040040 040040   040040 040040   040040 040040   040040 040040
   0     024*  040040 040040   040040 040040   115105 040040   040040 040040            ME
   0     030   040040 040040   000000 203015   000000 003000   000000 000000        ............
   0     034   000000 000000   000000 000000   000000 000000   000002 776003    ................
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:115  
   0     040   001000 000000   000000 000002   000000 000000   000000 000000    ................
   0     044   000000 000111   040040 040040   000000 006014   000000 006014    ...I    ........
   0     050   000000 006014   000000 000000   000000 000000   000000 006014    ................
   0     054   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     060   000000 010000   000000 000000   000000 000000   000000 000000    ................
   0     064   000000 000020   000000 000000   000000 006014   000000 000000    ................
   0     070   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     074   000000 000000   000000 006014   000000 000000   000000 000000    ................
   0     100   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     104   ****** ******   ****** ******   000000 000000   ****** ******    ................
   0     110   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     124*  000000 000000   000000 000000   000000 000000   ****** ******    ................
   0     134*  ****** ******   ****** ******   ****** ******   000000 070707    ..............8.

DCBSIZEC
 Sect OctLoc
   0     140   000000 000600                                                    ....

L6_DATA_START
 Sect OctLoc
   0     141   000000 200000                                                    ....

(unnamed)
 Sect OctLoc
   2     000   000014 006000   737777 777777   000000 000036   000002 006000    ................
   2     004   000002 006000   000003 777777   000003 600000   000000 000240    ................
   2     010   000007 006000   000000 000000   000002 006000   000002 006000    ................
   2     014   000000 000025   000000 000014   000015 006000   000000 000000    ................
   2     020   000014 006000   000002 006000                                    ........
      744     8699                                                /**/
      745     8700    3   END CHKBIRTH;
      746     8701                                                /**/
      747     8702    2   END ACCESS;
      748     8703                                                /**/
      749     8704    1   END DUU$GETMVAL;

PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:116  
--  Include file information  --

   GF_DCB_E.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   F_DCB_D.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DUU$GETMVAL.

   Procedure DUU$GETMVAL requires 1456 words for executable code.
   Procedure DUU$GETMVAL requires 48 words of local(AUTO) storage.

    No errors detected in file DUU$GETMVAL.:E05TSI    .
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:117  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:118  
          MINI XREF LISTING

ACCESS
      8151**PROC     8066--CALL     8121--CALL
ADDRESS
        65**DCL        53--PROC     8112--ENTRY    8215>>IF       8217>>ASSIGN   8292>>IF       8294>>ASSIGN
      8366>>IF       8392>>IF       8399>>IF       8401>>ASSIGN   8414>>IF       8414>>IF       8423>>IF
      8434>>IF       8446>>IF       8446>>IF       8457>>IF       8459>>ASSIGN   8462>>ASSIGN   8494>>ASSIGN
      8496>>ASSIGN   8539>>ASSIGN
ARET
      8071**LABEL    8066--CALLALT  8117--GOTO     8121--CALLALT
ARET IN PROCEDURE ACCESS
      8678**LABEL    8451--GOTO     8575--GOTO     8639--GOTO     8643--GOTO     8647--GOTO     8651--GOTO
      8655--GOTO     8659--GOTO     8663--GOTO     8667--GOTO     8671--GOTO     8675--GOTO
ARET IN PROCEDURE CHKBIRTH
      8692**LABEL    8692--CALLALT
B$HEAD
      3511**DCL      8399--IF       8410--CALL
B$HEAD.BIAS
      3675**DCL      8437>>ASSIGN
B$HEAD.PRECSIZE
      3573**DCL      8247>>ASSIGN   8324>>ASSIGN
B$HEAD.PRIV
      3512**DCL      8395>>ASSIGN   8396<<ASSIGN
B$HEAD.RDATA
      3530**DCL      8439>>ASSIGN   8561>>ASSIGN
B$HEAD.ROSIZE
      3589**DCL      8246>>ASSIGN   8323>>ASSIGN
B$HEAD.RPROC
      3520**DCL      8443>>ASSIGN   8565>>ASSIGN
B$HEAD.START
      3556**DCL      8371>>ASSIGN   8372<<ASSIGN   8378>>ASSIGN   8387<<ASSIGN
B$HEAD.TREEDISP
      3565**DCL      8230>>ASSIGN
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:119  
B$HEAD.UDCBNUM
      3559**DCL      8229>>ASSIGN
B$NODE
      3727**DCL      8243--ASSIGN   8278--ASSIGN   8422--ASSIGN   8546--ASSIGN
B$NODE.DADDR
      3761**DCL      8425>>ASSIGN   8549>>ASSIGN
B$NODE.DSIZE
      3763**DCL      8426>>ASSIGN   8550>>ASSIGN
B$NODE.FLGS.NOW_IN
      3733**DCL      8239<<ASSIGN   8274<<ASSIGN
B$NODE.NAME$
      3729**DCL      8242<<ASSIGN   8242>>ASSIGN   8277<<ASSIGN
B$NODE.PADDR
      3757**DCL      8429>>ASSIGN   8553>>ASSIGN
B$NODE.PSIZE
      3759**DCL      8430>>ASSIGN   8554>>ASSIGN
B$ROS$
      4056**DCL      8236>>ASSIGN   8242>>ASSIGN   8319>>ASSIGN
B$ROSEG.DCBPTR$
      3789**DCL      8211>>ASSIGN   8228>>ASSIGN   8288>>ASSIGN   8315>>ASSIGN
B$ROSEG.NUMDCBS
      3791**DCL      8209>>IF       8286>>IF
B$RUBIRTH
      3770**DCL      8692--CALL
B$RUBIRTH.COUNT
      3775**DCL      8691<<ASSIGN   8691>>ASSIGN
B$RUBIRTH.RUMED_UTS
      3773**DCL      8690<<ASSIGN
B$TREEHDR
      3711**DCL      8232--ASSIGN
B$TREEHDR.NODES
      3713**DCL      8231>>ASSIGN
BUF$ IN PROCEDURE ACCESS
      8153**DCL      8217<<ASSIGN   8219>>ASSIGN   8227>>ASSIGN   8294<<ASSIGN   8297>>ASSIGN   8308>>ASSIGN
      8401<<ASSIGN   8403>>ASSIGN   8404>>ASSIGN   8422<<ASSIGN   8425>>ASSIGN   8426>>ASSIGN   8429>>ASSIGN
      8430>>ASSIGN   8494<<ASSIGN   8496<<ASSIGN   8503>>ASSIGN   8506>>ASSIGN   8519>>ASSIGN   8521>>ASSIGN
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:120  
      8546<<ASSIGN   8549>>ASSIGN   8550>>ASSIGN   8553>>ASSIGN   8554>>ASSIGN   8607<<ASSIGN   8611>>ASSIGN
      8612>>ASSIGN   8616>>ASSIGN   8617>>ASSIGN   8618>>ASSIGN
BUF$L6B IN PROCEDURE ACCESS
      8179**DCL      8310<<ASSIGN   8523<<ASSIGN   8616<<ASSIGN
BUF$L6B.LBYTE IN PROCEDURE ACCESS
      8183**DCL      8301>>ASSIGN   8312<<ASSIGN   8510>>ASSIGN   8525<<ASSIGN   8612>>ASSIGN   8618<<ASSIGN
BUF$L6B.UBYTE IN PROCEDURE ACCESS
      8181**DCL      8300>>ASSIGN   8311<<ASSIGN   8509>>ASSIGN   8524<<ASSIGN   8611>>ASSIGN   8617<<ASSIGN
BUF$PTR$ IN PROCEDURE ACCESS
      8186**DCL      8236<<ASSIGN   8236>>ASSIGN   8237--ASSIGN   8271<<ASSIGN   8272--ASSIGN   8319<<ASSIGN
      8319>>ASSIGN   8320--ASSIGN   8350<<ASSIGN   8351--ASSIGN
BUF$WORD IN PROCEDURE ACCESS
      8178**DCL      8219>>ASSIGN   8227<<ASSIGN   8403>>ASSIGN   8404<<ASSIGN   8503>>ASSIGN   8519<<ASSIGN
CBX
        71**DCL      8129<<DOINDEX  8130>>IF       8130>>IF       8133>>ASSIGN   8134>>ASSIGN   8135>>CALL
      8135>>CALL     8135>>CALL     8143>>ASSIGN   8467<<DOINDEX  8468>>IF       8468>>IF       8471>>IF
      8473>>ASSIGN   8474>>ASSIGN   8477<<ASSIGN   8478>>IF       8478>>IF       8481>>ASSIGN   8482>>CALL
      8482>>CALL     8482>>CALL     8486>>ASSIGN   8487>>CALL     8487>>CALL     8488>>ASSIGN   8489>>ASSIGN
      8490>>ASSIGN   8492>>ASSIGN   8494>>ASSIGN   8496>>ASSIGN   8532>>ASSIGN   8533>>CALL     8533>>CALL
      8535>>ASSIGN   8581<<DOINDEX  8582>>IF       8582>>IF       8585>>IF       8587>>ASSIGN   8588>>ASSIGN
      8591<<ASSIGN   8592>>IF       8592>>IF       8595>>ASSIGN   8596>>CALL     8596>>CALL     8596>>CALL
      8600>>ASSIGN   8601>>CALL     8601>>CALL     8602>>ASSIGN   8603>>ASSIGN   8604>>ASSIGN   8606>>ASSIGN
      8607>>ASSIGN   8622>>ASSIGN   8623>>CALL     8623>>CALL     8625>>ASSIGN   8637>>ASSIGN
CHKBIRTH IN PROCEDURE ACCESS
      8686**PROC     8226--CALL     8307--CALL     8361--CALL     8517--CALL     8615--CALL
DCB$ IN PROCEDURE ACCESS
      8162**DCL      8184--IMP-PTR  8211<<ASSIGN   8212>>IF       8214>>ASSIGN   8214>>ASSIGN   8217>>ASSIGN
      8221>>IF       8223>>ASSIGN   8224>>ASSIGN   8248>>ASSIGN   8288<<ASSIGN   8289>>IF       8294>>ASSIGN
      8325>>ASSIGN
DCB$ADDR$ IN PROCEDURE ACCESS
      8177**DCL      8211>>ASSIGN   8288>>ASSIGN
DCB$CHAR IN PROCEDURE ACCESS
      8184**DCL      8223<<ASSIGN
DCBOFF IN PROCEDURE ACCESS
      8171**DCL      8248<<ASSIGN   8249>>ASSIGN   8257>>ASSIGN   8325<<ASSIGN   8326>>ASSIGN   8334>>ASSIGN
DCBPG$ IN PROCEDURE ACCESS
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:121  
      8172**DCL      8250<<ASSIGN   8256<>CALL     8260<<ASSIGN   8266<>CALL     8327<<ASSIGN   8333<>CALL
      8337<<ASSIGN   8343<>CALL
DCBPGSZ IN PROCEDURE ACCESS
      8173**DCL      8251<<ASSIGN   8252>>IF       8253<<ASSIGN   8254<<ASSIGN   8254>>ASSIGN   8254--ASSIGN
      8256<>CALL     8261<<ASSIGN   8262>>IF       8263<<ASSIGN   8264<<ASSIGN   8264>>ASSIGN   8264--ASSIGN
      8266<>CALL     8328<<ASSIGN   8329>>IF       8330<<ASSIGN   8331<<ASSIGN   8331>>ASSIGN   8333<>CALL
      8338<<ASSIGN   8339>>IF       8340<<ASSIGN   8341<<ASSIGN   8341>>ASSIGN   8343<>CALL
DCBSIZEC
      4054**DCL      8185--IMP-SIZ  8223>>ASSIGN
DDE$ERROR
      6797**DCL-ENT  8145--CALL     8679--CALL
DDQ$READLM
      6798**DCL-ENT  8487--CALL     8601--CALL
DDQ$WRITELM
      6799**DCL-ENT  8135--CALL     8256--CALL     8266--CALL     8333--CALL     8343--CALL     8410--CALL
      8482--CALL     8533--CALL     8596--CALL     8623--CALL     8692--CALL
DELBUG IN PROCEDURE ACCESS
      8674**LABEL    8355--GOTO     8407--GOTO     8497--GOTO
DESC
        67**DCL        53--PROC     8112--ENTRY    8209>>IF       8211>>ASSIGN   8286>>IF       8288>>ASSIGN
      8364>>DOCASE
F$DCB
      3842**DCL      8214--ASSIGN
F$DCB.ACTPOS
      3867**DCL      3867--REDEF
F$DCB.ARS
      3842**DCL      3842--REDEF
F$DCB.ATTR
      3860**DCL      3861--REDEF
F$DCB.BORROW
      3875**DCL      3875--REDEF    3875--REDEF    3875--REDEF
F$DCB.DCBNAME.L
      3889**DCL      3889--IMP-SIZ  8214>>ASSIGN
F$DCB.DCBNAME.S
      3888**DCL      8221>>IF       8224<<ASSIGN
F$DCB.EOMCHAR
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:122  
      3846**DCL      3846--REDEF
F$DCB.FLDID
      3870**DCL      3870--REDEF
F$DCB.FORM$
      3864**DCL      3864--REDEF
F$DCB.FSECT
      3880**DCL      3880--REDEF
F$DCB.FSN
      3857**DCL      3857--REDEF    3857--REDEF    3858--REDEF
F$DCB.HEADER$
      3863**DCL      3863--REDEF
F$DCB.IXTNSIZE
      3861**DCL      3861--REDEF
F$DCB.LASTSTA$
      3851**DCL      3851--REDEF
F$DCB.LVL
      3876**DCL      3876--REDEF
F$DCB.NAME.C
      3851**DCL      3851--REDEF
F$DCB.NOEOF
      3872**DCL      3872--REDEF
F$DCB.NRECS
      3862**DCL      3862--REDEF
F$DCB.NRECX
      3881**DCL      3881--REDEF
F$DCB.OHDR
      3873**DCL      3873--REDEF
F$DCB.ORG
      3856**DCL      3856--REDEF
F$DCB.PRECNO
      3879**DCL      3879--REDEF
F$DCB.RCSZ
      3884**DCL      3884--REDEF
F$DCB.RES
      3852**DCL      3852--REDEF
F$DCB.SETX
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:123  
      3864**DCL      3864--REDEF
F$DCB.TAB$
      3863**DCL      3864--REDEF
F$DCB.TDA
      3878**DCL      3878--REDEF
F$DCB.WSN
      3853**DCL      3853--REDEF
INBUF IN PROCEDURE ACCESS
      8490**LABEL    8470--GOTO
INBUF1 IN PROCEDURE ACCESS
      8604**LABEL    8584--GOTO
IX IN PROCEDURE ACCESS
      8163**DCL      8235<<DOINDEX  8241<<DOINDEX  8270<<DOINDEX  8276<<DOINDEX  8298<<DOINDEX  8299>>ASSIGN
      8300>>ASSIGN   8301>>ASSIGN   8309<<DOINDEX  8311>>ASSIGN   8312>>ASSIGN   8318<<DOINDEX  8347<<DOINDEX
      8507<<DOINDEX  8508>>ASSIGN   8509>>ASSIGN   8510>>ASSIGN   8522<<DOINDEX  8524>>ASSIGN   8525>>ASSIGN
IXX IN PROCEDURE ACCESS
      8157**DCL      8543<<DOINDEX  8570>>IF       8610>>ASSIGN   8611>>ASSIGN   8612>>ASSIGN   8617>>ASSIGN
      8618>>ASSIGN
L6_DATA_START IN PROCEDURE ACCESS
      8200**DCL      8438>>ASSIGN   8560>>ASSIGN
LRU IN PROCEDURE ACCESS
      8176**DCL      8464<<ASSIGN   8473<<ASSIGN   8477>>ASSIGN   8578<<ASSIGN   8587<<ASSIGN   8591>>ASSIGN
M$MDCB
      3981**DCL      4054--DCLINIT  8223>>ASSIGN
M$MDCB.ACTPOS
      4022**DCL      4022--REDEF
M$MDCB.ARS#
      3981**DCL      3981--REDEF
M$MDCB.ATTR#
      4011**DCL      4011--REDEF    4013--REDEF
M$MDCB.BORROW
      4033**DCL      4033--REDEF    4033--REDEF    4033--REDEF
M$MDCB.EOMCHAR#
      3988**DCL      3989--REDEF
M$MDCB.FLDID
      4025**DCL      4026--REDEF
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:124  
M$MDCB.FORM$
      4017**DCL      4017--REDEF
M$MDCB.FSECT
      4040**DCL      4040--REDEF
M$MDCB.FSN#
      4007**DCL      4007--REDEF    4007--REDEF    4008--REDEF
M$MDCB.HEADER$
      4016**DCL      4017--REDEF
M$MDCB.IXTNSIZE#
      4013**DCL      4014--REDEF
M$MDCB.LASTSTA$
      3997**DCL      3997--REDEF
M$MDCB.LVL
      4034**DCL      4034--REDEF
M$MDCB.NAME#.C
      3997**DCL      3998--REDEF
M$MDCB.NOEOF
      4029**DCL      4029--REDEF
M$MDCB.NRECS#
      4014**DCL      4014--REDEF
M$MDCB.NRECX
      4041**DCL      4041--REDEF
M$MDCB.OHDR
      4030**DCL      4030--REDEF
M$MDCB.ORG#
      4005**DCL      4006--REDEF
M$MDCB.PRECNO
      4038**DCL      4038--REDEF
M$MDCB.RCSZ
      4046**DCL      4046--REDEF
M$MDCB.RES#
      3999**DCL      3999--REDEF
M$MDCB.SETX
      4018**DCL      4018--REDEF
M$MDCB.TAB$
      4017**DCL      4017--REDEF
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:125  
M$MDCB.TDA
      4037**DCL      4038--REDEF
M$MDCB.WSN#
      3999**DCL      4000--REDEF
NILDCB IN PROCEDURE ACCESS
      8670**LABEL    8213--GOTO     8290--GOTO
NODCB IN PROCEDURE ACCESS
      8654**LABEL    8210--GOTO     8287--GOTO
NODCBS IN PROCEDURE ACCESS
      8650**LABEL    8208--GOTO     8285--GOTO
NODE
        64**DCL        53--PROC     8112--ENTRY    8422>>ASSIGN   8468>>IF       8487<>CALL     8489>>ASSIGN
      8533<>CALL     8546>>ASSIGN   8582>>IF       8601<>CALL     8603>>ASSIGN   8623<>CALL
NODENUM IN PROCEDURE ACCESS
      8169**DCL      8231<<ASSIGN   8241>>DOINDEX  8276>>DOINDEX
NORREC IN PROCEDURE ACCESS
      8629**LABEL    8487--CALLALT  8601--CALLALT
NOTINDCB IN PROCEDURE ACCESS
      8658**LABEL    8216--GOTO     8293--GOTO
NOTINHEAD IN PROCEDURE ACCESS
      8662**LABEL    8400--GOTO
NOTINRUM IN PROCEDURE ACCESS
      8666**LABEL    8412--GOTO
NOT_IS
        68**DCL        53--PROC     8112--ENTRY    8202>>IF
NOWBIR IN PROCEDURE ACCESS
      8638**LABEL    8226--CALLALT  8307--CALLALT  8361--CALLALT  8517--CALLALT  8615--CALLALT
NOWREC
      8138**LABEL    8135--CALLALT
NOWREC IN PROCEDURE ACCESS
      8629**LABEL    8482--CALLALT  8533--CALLALT  8596--CALLALT  8623--CALLALT
NOWROS IN PROCEDURE ACCESS
      8646**LABEL    8256--CALLALT  8266--CALLALT  8333--CALLALT  8343--CALLALT
NOWWH IN PROCEDURE ACCESS
      8642**LABEL    8410--CALLALT
NWORD_L6
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:126  
        74**DCL        78--REDEF
NWORD_L6.ADDR1
        76**DCL      8379>>ASSIGN   8385<<ASSIGN
NWORD_L6.ADDR2
        77**DCL      8380>>ASSIGN   8386<<ASSIGN
NWORD_L6V
        78**DCL      8378<<ASSIGN   8384<<ASSIGN   8387>>ASSIGN
ONE_WORD IN PROCEDURE ACCESS
      8420**LABEL    8571--GOTO
PAGE IN PROCEDURE ACCESS
      8161**DCL      8249<<ASSIGN   8250>>ASSIGN   8251>>ASSIGN   8256<>CALL     8258>>IF       8326<<ASSIGN
      8327>>ASSIGN   8328>>ASSIGN   8333>>CALL     8335>>IF       8455<<ASSIGN   8457>>IF       8458<<ASSIGN
      8459<<ASSIGN   8462<<ASSIGN   8468>>IF       8487<>CALL     8488>>ASSIGN   8494>>ASSIGN   8496>>ASSIGN
      8533<>CALL     8577<<ASSIGN   8582>>IF       8601<>CALL     8602>>ASSIGN   8607>>ASSIGN   8623<>CALL
PAGE1 IN PROCEDURE ACCESS
      8174**DCL      8257<<ASSIGN   8258>>IF       8260>>ASSIGN   8261>>ASSIGN   8266<>CALL     8334<<ASSIGN
      8335>>IF       8337>>ASSIGN   8338>>ASSIGN   8343>>CALL
PSIZE IN PROCEDURE ACCESS
      8159**DCL      8247<<ASSIGN   8249>>ASSIGN   8249>>ASSIGN   8252>>IF       8253>>ASSIGN   8257>>ASSIGN
      8257>>ASSIGN   8262>>IF       8263>>ASSIGN   8324<<ASSIGN   8326>>ASSIGN   8326>>ASSIGN   8329>>IF
      8330>>ASSIGN   8334>>ASSIGN   8334>>ASSIGN   8339>>IF       8340>>ASSIGN   8426<<ASSIGN   8430<<ASSIGN
      8439<<ASSIGN   8443<<ASSIGN   8446>>IF       8550<<ASSIGN   8554<<ASSIGN   8561<<ASSIGN   8565<<ASSIGN
      8568>>IF
PSTART IN PROCEDURE ACCESS
      8158**DCL      8425<<ASSIGN   8429<<ASSIGN   8437<<ASSIGN   8438<<ASSIGN   8442<<ASSIGN   8446>>IF
      8455>>ASSIGN   8458>>ASSIGN   8549<<ASSIGN   8553<<ASSIGN   8560<<ASSIGN   8564<<ASSIGN   8568>>IF
PTR$WORD.LH IN PROCEDURE ACCESS
      8188**DCL      8271>>ASSIGN   8277>>ASSIGN
PTR$WORD.RH IN PROCEDURE ACCESS
      8189**DCL      8190--REDEF
PTR$WORD.RHB.LBYTE IN PROCEDURE ACCESS
      8194**DCL      8349>>ASSIGN
PTR$WORD.RHB.UBYTE IN PROCEDURE ACCESS
      8192**DCL      8348>>ASSIGN
READ
        70**DCL      8064<<ASSIGN   8119<<ASSIGN   8218>>IF       8295>>IF       8359>>IF       8370>>IF
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:127  
      8376>>IF       8394>>IF       8402>>IF       8409>>IF       8498>>IF       8540>>IF       8608>>IF
      8629>>IF
ROSIZE IN PROCEDURE ACCESS
      8170**DCL      8246<<ASSIGN   8251>>ASSIGN   8261>>ASSIGN   8323<<ASSIGN   8328>>ASSIGN   8338>>ASSIGN
SEG
        66**DCL        53--PROC     8112--ENTRY    8203>>IF       8357>>IF
SEQ IN PROCEDURE ACCESS
      8175**DCL      8465<<ASSIGN   8471>>IF       8474<<ASSIGN   8579<<ASSIGN   8585>>IF       8588<<ASSIGN
SIZE IN PROCEDURE ACCESS
      8160**DCL      8214<<ASSIGN   8215>>IF       8257>>ASSIGN   8291<<ASSIGN   8292>>IF       8334>>ASSIGN
      8485<<ASSIGN   8485--ASSIGN   8487<>CALL     8599<<ASSIGN   8599--ASSIGN   8601<>CALL
S_D.B$ROS$
      6162**DCL      8207>>IF       8209>>IF       8211>>ASSIGN   8228>>ASSIGN   8284>>IF       8286>>IF
      8288>>ASSIGN   8315>>ASSIGN
S_D.B$TREE$
      6150**DCL      8422>>ASSIGN   8546>>ASSIGN
S_D.CURRENT_CHANNEL
      6430**DCL      6432--REDEF
S_D.DEBUGA
      5582**DCL      5584--REDEF
S_D.EIS
      6540**DCL      6569--REDEF
S_D.ERROR
      5511**DCL      8116<<ASSIGN   8144<<ASSIGN   8448<<ASSIGN   8450<<ASSIGN   8572<<ASSIGN   8574<<ASSIGN
      8638<<ASSIGN   8642<<ASSIGN   8646<<ASSIGN   8650<<ASSIGN   8654<<ASSIGN   8658<<ASSIGN   8662<<ASSIGN
      8666<<ASSIGN   8670<<ASSIGN   8674<<ASSIGN   8678<<ASSIGN
S_D.FIND_RUM
      5616**DCL      8449>>IF       8573>>IF
S_D.HOST_MESSAGE_BUF_REMOTE
      6473**DCL      6474--REDEF    6488--REDEF
S_D.JDE
      6087**DCL      6088--REDEF
S_D.L$.VALUE
      5640**DCL      5646--REDEF    5654--REDEF    5657--REDEF    5660--REDEF    5663--REDEF
S_D.L$.VALUE.L
      5641**DCL      5642--REDEF    5643--REDEF
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:128  
S_D.L6_MESSAGE_BUF
      6494**DCL      6496--REDEF
S_D.ONE_TO_TWO.EXEC_DOMAIN
      6505**DCL      8205>>IF       8282>>IF       8368>>IF       8414>>IF       8414>>IF       8436>>IF
      8453>>IF       8493>>IF       8495>>IF       8500>>IF       8518>>IF
S_D.OUTPUT
      6460**DCL      6462--REDEF
S_D.OVERLAID
      6144**DCL      8420>>IF       8544>>IF
S_D.PADDR
      6146**DCL      8423>>IF       8434>>IF       8442>>ASSIGN   8547>>IF       8558>>IF       8564>>ASSIGN
S_D.PROTECT
      6337**DCL      8114>>IF
S_D.RCBC.BUF$
      5723**DCL      8135<>CALL     8482<>CALL     8487<>CALL     8494>>ASSIGN   8496>>ASSIGN   8533<>CALL
      8596<>CALL     8601<>CALL     8607>>ASSIGN   8623<>CALL
S_D.RCBC.BUFSIZE
      5719**DCL      8414>>IF       8414>>IF       8414>>IF       8414>>IF       8455>>ASSIGN   8455>>ASSIGN
      8455>>ASSIGN   8459>>ASSIGN   8459>>ASSIGN   8485>>ASSIGN   8599>>ASSIGN
S_D.RCBC.BUFSM1
      5721**DCL      8129>>DOINDEX  8467>>DOINDEX  8581>>DOINDEX
S_D.RCBC.CUR_SEQ
      5717**DCL      8466<<ASSIGN   8466>>ASSIGN   8492>>ASSIGN   8580<<ASSIGN   8580>>ASSIGN   8606>>ASSIGN
S_D.RCBC.NODE
      5731**DCL      8134>>ASSIGN   8468>>IF       8481>>ASSIGN   8489<<ASSIGN   8582>>IF       8595>>ASSIGN
      8603<<ASSIGN
S_D.RCBC.PAGE
      5725**DCL      8130>>IF       8135<>CALL     8143<<ASSIGN   8468>>IF       8478>>IF       8482<>CALL
      8488<<ASSIGN   8582>>IF       8592>>IF       8596<>CALL     8602<<ASSIGN   8637<<ASSIGN
S_D.RCBC.SEQ
      5733**DCL      8465>>ASSIGN   8471>>IF       8474>>ASSIGN   8492<<ASSIGN   8579>>ASSIGN   8585>>IF
      8588>>ASSIGN   8606<<ASSIGN
S_D.RCBC.SIZE
      5727**DCL      8135<>CALL     8482<>CALL     8486<<ASSIGN   8487<>CALL     8533<>CALL     8596<>CALL
      8600<<ASSIGN   8601<>CALL     8623<>CALL
S_D.RCBC.WRITE_THRU
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:129  
      5715**DCL      8530>>IF       8620>>IF
S_D.RCBC.WRITTEN
      5729**DCL      8130>>IF       8133<<ASSIGN   8478>>IF       8490<<ASSIGN   8532<<ASSIGN   8535<<ASSIGN
      8592>>IF       8604<<ASSIGN   8622<<ASSIGN   8625<<ASSIGN
S_D.REMOTE_MSG.FNCC
      6479**DCL      6480--REDEF
S_D.REMOTE_MSG.STXC
      6475**DCL      6476--REDEF
S_D.REMOTE_MSG.SUBFNCC
      6483**DCL      6484--REDEF
S_D.RUMSEQ
      6168**DCL      8688>>IF
S_D.RUMUTS
      6166**DCL      8690>>ASSIGN
S_D.RUM_BIRTH$
      5689**DCL      8688>>IF       8690>>ASSIGN   8691>>ASSIGN   8691>>ASSIGN   8692<>CALL
S_D.RUM_FEP
      6610**DCL      8446>>IF       8568>>IF
S_D.RUM_HEAD$
      6170**DCL      8229>>ASSIGN   8230>>ASSIGN   8246>>ASSIGN   8247>>ASSIGN   8323>>ASSIGN   8324>>ASSIGN
      8371>>ASSIGN   8372>>ASSIGN   8378>>ASSIGN   8387>>ASSIGN   8395>>ASSIGN   8396>>ASSIGN   8401>>ASSIGN
      8410<>CALL     8437>>ASSIGN   8439>>ASSIGN   8443>>ASSIGN   8561>>ASSIGN   8565>>ASSIGN
S_D.RUM_TEST
      6176**DCL      8255>>IF       8265>>IF       8332>>IF       8342>>IF       8409>>IF       8529>>IF
      8619>>IF       8688>>IF
S_D.SV
      5539**DCL      5560--REDEF
S_D$
      6791**DCL      5487--IMP-PTR  8114>>IF       8116>>ASSIGN   8129>>DOINDEX  8130>>IF       8130>>IF
      8133>>ASSIGN   8134>>ASSIGN   8135>>CALL     8135>>CALL     8135>>CALL     8143>>ASSIGN   8144>>ASSIGN
      8205>>IF       8207>>IF       8209>>IF       8211>>ASSIGN   8228>>ASSIGN   8229>>ASSIGN   8230>>ASSIGN
      8246>>ASSIGN   8247>>ASSIGN   8255>>IF       8265>>IF       8282>>IF       8284>>IF       8286>>IF
      8288>>ASSIGN   8315>>ASSIGN   8323>>ASSIGN   8324>>ASSIGN   8332>>IF       8342>>IF       8368>>IF
      8371>>ASSIGN   8372>>ASSIGN   8378>>ASSIGN   8387>>ASSIGN   8395>>ASSIGN   8396>>ASSIGN   8401>>ASSIGN
      8409>>IF       8410>>CALL     8414>>IF       8414>>IF       8414>>IF       8414>>IF       8414>>IF
      8414>>IF       8420>>IF       8422>>ASSIGN   8423>>IF       8434>>IF       8436>>IF       8437>>ASSIGN
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:130  
      8439>>ASSIGN   8442>>ASSIGN   8443>>ASSIGN   8446>>IF       8448>>ASSIGN   8449>>IF       8450>>ASSIGN
      8453>>IF       8455>>ASSIGN   8455>>ASSIGN   8455>>ASSIGN   8459>>ASSIGN   8459>>ASSIGN   8465>>ASSIGN
      8466>>ASSIGN   8466>>ASSIGN   8467>>DOINDEX  8468>>IF       8468>>IF       8471>>IF       8474>>ASSIGN
      8478>>IF       8478>>IF       8481>>ASSIGN   8482>>CALL     8482>>CALL     8482>>CALL     8485>>ASSIGN
      8486>>ASSIGN   8487>>CALL     8487>>CALL     8488>>ASSIGN   8489>>ASSIGN   8490>>ASSIGN   8492>>ASSIGN
      8492>>ASSIGN   8493>>IF       8494>>ASSIGN   8495>>IF       8496>>ASSIGN   8500>>IF       8518>>IF
      8529>>IF       8530>>IF       8532>>ASSIGN   8533>>CALL     8533>>CALL     8535>>ASSIGN   8544>>IF
      8546>>ASSIGN   8547>>IF       8558>>IF       8561>>ASSIGN   8564>>ASSIGN   8565>>ASSIGN   8568>>IF
      8572>>ASSIGN   8573>>IF       8574>>ASSIGN   8579>>ASSIGN   8580>>ASSIGN   8580>>ASSIGN   8581>>DOINDEX
      8582>>IF       8582>>IF       8585>>IF       8588>>ASSIGN   8592>>IF       8592>>IF       8595>>ASSIGN
      8596>>CALL     8596>>CALL     8596>>CALL     8599>>ASSIGN   8600>>ASSIGN   8601>>CALL     8601>>CALL
      8602>>ASSIGN   8603>>ASSIGN   8604>>ASSIGN   8606>>ASSIGN   8606>>ASSIGN   8607>>ASSIGN   8619>>IF
      8620>>IF       8622>>ASSIGN   8623>>CALL     8623>>CALL     8625>>ASSIGN   8637>>ASSIGN   8638>>ASSIGN
      8642>>ASSIGN   8646>>ASSIGN   8650>>ASSIGN   8654>>ASSIGN   8658>>ASSIGN   8662>>ASSIGN   8666>>ASSIGN
      8670>>ASSIGN   8674>>ASSIGN   8678>>ASSIGN   8688>>IF       8688>>IF       8688>>IF       8690>>ASSIGN
      8690>>ASSIGN   8691>>ASSIGN   8691>>ASSIGN   8692>>CALL
TADDRESS IN PROCEDURE ACCESS
      8155**DCL      8539<<ASSIGN   8547>>IF       8558>>IF       8568>>IF       8577>>ASSIGN   8607>>ASSIGN
      8627<<ASSIGN   8627>>ASSIGN
TBUF$ IN PROCEDURE ACCESS
      8154**DCL      8297<<ASSIGN   8300>>ASSIGN   8301>>ASSIGN   8302<<ASSIGN   8302>>ASSIGN   8308<<ASSIGN
      8310>>ASSIGN   8311>>ASSIGN   8312>>ASSIGN   8313<<ASSIGN   8313>>ASSIGN   8506<<ASSIGN   8509>>ASSIGN
      8510>>ASSIGN   8511<<ASSIGN   8511>>ASSIGN   8521<<ASSIGN   8523>>ASSIGN   8524>>ASSIGN   8525>>ASSIGN
      8526<<ASSIGN   8526>>ASSIGN
TEMP$ IN PROCEDURE ACCESS
      8164**DCL      8234<<ASSIGN   8236>>ASSIGN   8236>>ASSIGN   8237<<ASSIGN   8237>>ASSIGN   8240<<ASSIGN
      8242>>ASSIGN   8242>>ASSIGN   8243<<ASSIGN   8243>>ASSIGN   8269<<ASSIGN   8271>>ASSIGN   8271>>ASSIGN
      8272<<ASSIGN   8272>>ASSIGN   8275<<ASSIGN   8277>>ASSIGN   8277>>ASSIGN   8278<<ASSIGN   8278>>ASSIGN
      8317<<ASSIGN   8319>>ASSIGN   8319>>ASSIGN   8320<<ASSIGN   8320>>ASSIGN   8346<<ASSIGN   8348>>ASSIGN
      8349>>ASSIGN   8350>>ASSIGN   8351<<ASSIGN   8351>>ASSIGN
TEMP$WORD IN PROCEDURE ACCESS
      8195**DCL      8199--REDEF
TEMP$WORD.LBYTE IN PROCEDURE ACCESS
      8198**DCL      8349<<ASSIGN
TEMP$WORD.UBYTE IN PROCEDURE ACCESS
      8197**DCL      8348<<ASSIGN
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:131  
TEMPWORD IN PROCEDURE ACCESS
      8199**DCL      8350>>ASSIGN
TNODE
        72**DCL      8134<<ASSIGN   8135<>CALL     8481<<ASSIGN   8482<>CALL     8595<<ASSIGN   8596<>CALL
TREE$ IN PROCEDURE ACCESS
      8167**DCL      8232<<ASSIGN   8239>>ASSIGN   8240>>ASSIGN   8274>>ASSIGN   8275>>ASSIGN
TREEHDR$ IN PROCEDURE ACCESS
      8166**DCL      8230<<ASSIGN   8231>>ASSIGN   8232>>ASSIGN   8242>>ASSIGN   8277>>ASSIGN
TSIZE IN PROCEDURE ACCESS
      8156**DCL      8541<<ASSIGN   8542<<ASSIGN   8543>>DOINDEX
UDCB$ IN PROCEDURE ACCESS
      8165**DCL      8228<<ASSIGN   8230>>ASSIGN   8234>>ASSIGN   8236>>ASSIGN   8248>>ASSIGN   8250>>ASSIGN
      8260>>ASSIGN   8269>>ASSIGN   8271>>ASSIGN   8315<<ASSIGN   8317>>ASSIGN   8319>>ASSIGN   8325>>ASSIGN
      8327>>ASSIGN   8337>>ASSIGN   8346>>ASSIGN   8350>>ASSIGN
UDCBNUM IN PROCEDURE ACCESS
      8168**DCL      8229<<ASSIGN   8235>>DOINDEX  8270>>DOINDEX  8318>>DOINDEX  8347>>DOINDEX
VALUE
        56**DCL        53--PROC     8112--ENTRY
VALUE.OPS
        58**DCL        59--REDEF      63--REDEF    8219<<ASSIGN   8227>>ASSIGN   8299<<ASSIGN   8371<<ASSIGN
      8372>>ASSIGN   8379<<ASSIGN   8380<<ASSIGN   8385>>ASSIGN   8386>>ASSIGN   8403<<ASSIGN   8404>>ASSIGN
      8503<<ASSIGN   8508<<ASSIGN   8519>>ASSIGN   8610<<ASSIGN
VALUE.OPSB.LBYTE
        62**DCL      8301<<ASSIGN   8312>>ASSIGN   8510<<ASSIGN   8525>>ASSIGN   8612<<ASSIGN   8618>>ASSIGN
VALUE.OPSB.UBYTE
        61**DCL      8300<<ASSIGN   8311>>ASSIGN   8509<<ASSIGN   8524>>ASSIGN   8611<<ASSIGN   8617>>ASSIGN
VALUE.OPSBITS
        63**DCL      8395<<ASSIGN   8396>>ASSIGN
VALUE.SIZE
        57**DCL      8120>>ASSIGN   8304<<ASSIGN   8309>>DOINDEX  8362<<ASSIGN   8373<<ASSIGN   8381<<ASSIGN
      8388<<ASSIGN   8397<<ASSIGN   8405<<ASSIGN   8502<<ASSIGN   8513<<ASSIGN   8522>>DOINDEX  8542>>ASSIGN
      8630<<ASSIGN
VSIZE
        73**DCL      8065<<ASSIGN   8120<<ASSIGN   8414>>IF
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:132  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DUU$GETMVAL File=DUU$GETMVAL.:E05TSI                          TUE 07/29/97 15:02 Page:133  
              MINI UREF LISTING

B$ROAVAIL    3828**DCL
B$RODCB$    3825**DCL
DUU$GETMVAL      53**PROC
DUU$PUTMVAL    8112**ENTRY
DUU$TRUNC    8127**ENTRY
