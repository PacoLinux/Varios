VERSION E05

PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:1    
        1        1        /*M* IPC$PROCS - SPIDER routines for updating the processor tables. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=8,IND=2,THI=2,ENU=2,CSU=2,DTI=4,DCI=4,ECU=4,AND */
        8        8        IPC$PROCS: PROC(PCNTRL,SLOT,ERR) ALTRET;
        9        9    1   DCL 1 PCNTRL,                           /* Process control block              */
       10       10    1         2 CMD# UBIN WORD,                 /* Command number                     */
       11       11    1         2 PNAME$ PTR,                     /* PTR to processor name              */
       12       12    1         2 PACCT$ PTR,                     /* PTR to account name (LIST)         */
       13       13    1         2 PTYPE UBIN HALF UNAL,           /* Processor type (internal code)     */
       14       14    1         2 PERM BIT(1) UNAL,
       15       15    1         2 * UBIN(8) UNAL,
       16       16    1         2 * UBIN BYTE UNAL,
       17       17    1         2 FID$ PTR,                       /* PTR to FID for processor           */
       18       18    1         2 MODTIME UBIN WORD,              /* Modification time from RU          */
       19       19    1         2 PNUM UBIN HALF UNAL,            /* Processor number                   */
       20       20    1         2 * UBIN(18) UNAL,
       21       21    1         2 PFLGS BIT(36) UNAL;             /* Processor type flags               */
       22       22    1   DCL SLOT SBIN;                          /* Where to install new processor     */
       23       23    1   DCL 1 ERR ALIGNED,
       24       24    1         2 FCG BIT(12) UNAL,
       25       25    1         2 MID BIT(6) UNAL,
       26       26    1         2 M BIT(1) UNAL,
       27       27    1         2 CODE UBIN(14) UNAL,
       28       28    1         2 SEV UBIN(3) UNAL;
       29       29        /**/
       30       30        %INCLUDE B$MAP;
       31      129        %INCLUDE B$OBJECT_C;
       32     3559        %INCLUDE B$P;
       33     3643        %INCLUDE B_SEGIDS_C;
       34     4182        %INCLUDE CP_6;
       35     4263        %INCLUDE IP_PERR_C;
       36     4291        %INCLUDE IPS_SUBS_C;
       37     4328        %INCLUDE MM_DATA_R;
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:2    
       38     4848        %INCLUDE S$WSPTD;
       39     4857        %INCLUDE U$JIT_C;
       40     5043        /**/
       41     5044        %EJECT;
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:3    
       42     5045        /**/
       43     5046        %B$HEAD;
       44     5246        %B$TREE_TABLE(HDR_NAME=B$TREEHDR,
       45     5247                      NODE_NAME=B$NODE);
       46     5305        %B$RECORDSUBS;
       47     5333        %EQU_TCB_SZ;
       48     5337        %FPT_CVM;
       49     5353        %FPT_STLPP(RESULTS=STLVEC);
       50     5366        %FPT_ERRMSG(BUF=ERRMSGBUF,
       51     5367                     DCB=M$EI,
       52     5368                      OUTDCB1=M$LO);
       53     5395        %FPT_TEMPWROC(FPTN=WRITE_OC,
       54     5396                      BUFW=ERRMSGBUF);
       55     5412        %FPT_TEMPWROC(FPTN=OC_CRLF,
       56     5413                      BUFW=T_CRLF);
       57     5429        %FPT_TIME(SOURCE=CLOCK,
       58     5430                  DEST=UTS,
       59     5431                  TSTAMP=CUTS);
       60     5450        /**/
       61     5451        /**/
       62     5452
       63     5453    1   DCL NPROCS UBIN SYMREF;
       64     5454
       65     5455
       66     5456    1   DCL PGTBLSZ SBIN;
       67     5457    1   DCL PGTBLNEEDED SBIN;
       68     5458    1   DCL LIBNUM SBIN;
       69     5459    1   DCL PWSQ SBIN;
       70     5460    1   DCL NXTWSQPG SBIN;
       71     5461    1   DCL PFLGS BIT(36);
       72     5462    1   DCL BIAS SBIN;
       73     5463    1   DCL TOTSZ SBIN;
       74     5464    1   DCL PGSZ SBIN;
       75     5465    1   DCL HEAD SBIN;
       76     5466    1   DCL TAIL SBIN;
       77     5467    1   DCL COUNT SBIN;
       78     5468    1   DCL PROC$ PTR;
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:4    
       79     5469    1   DCL I SBIN;
       80     5470    1   DCL SEGID UBIN;
       81     5471    1   DCL ERRTEMP BIT(36);
       82     5472    1   DCL CUTS UBIN STATIC DALIGNED;
       83     5473    1   DCL T_CRLF(0:1) CHAR(1) STATIC UNAL INIT(BITASC('015'O),BITASC('012'O));
       84     5474        %VLP_ERRCODE (FPTN=ERR_NOPGTBL,FCG=IP,MID=C,ERR#=E$IP_NOPGTBL,SEV=3);
       85     5519        %VLP_ERRCODE (FPTN=ERR_NOLIB,FCG=IP,MID=C,ERR#=E$IP_NOLIB,SEV=3);
       86     5564    1   DCL 1 STLVEC STATIC DALIGNED,
       87     5565    1         2 * UBIN WORD,
       88     5566    1         2 PNO UBIN WORD;
       89     5567    1   DCL M$LO DCB;
       90     5568    1   DCL M$EI DCB;
       91     5569        /**/
       92     5570    1   DCL 1 B$TEXTC BASED DALIGNED,
       93     5571    1         2 COUNT UBIN(9) UNAL,
       94     5572    1         2 TEXT CHAR(B$TEXTC.COUNT) UNAL;
       95     5573        /**/
       96     5574        %EJECT;
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:5    
       97     5575        /**/
       98     5576    1   DCL BUF$ PTR SYMREF;
       99     5577    1   DCL PPUT$ PTR SYMREF;
      100     5578    1   DCL WSPTD$ PTR SYMREF;
      101     5579    1   DCL PGTBL$ PTR SYMREF;
      102     5580    1   DCL SCPUWSPTD(0:3) UBIN SYMREF;
      103     5581    1   DCL NSCPU UBIN SYMREF;
      104     5582    1   DCL P$ PTR SYMREF;
      105     5583    1   DCL HEAD$ PTR SYMREF;
      106     5584    1   DCL B$JIT$ PTR SYMREF;
      107     5585    1   DCL B$IS$ PTR SYMREF;
      108     5586    1   DCL B$SPCL3$ PTR SYMREF;
      109     5587    1   DCL B$WSQ0PT$ PTR SYMREF;
      110     5588    1   DCL IP_PTB_UNITS SBIN WORD SYMREF;
      111     5589    1   DCL IP_WSQ0PT BIT(1) ALIGNED SYMREF;
      112     5590    1   DCL TMP SBIN;
      113     5591    1   DCL TMP1 SBIN;
      114     5592    1   DCL ERRMSGBUF CHAR(120) SYMREF;
      115     5593        /**/
      116     5594    1   DCL IPB$READ ENTRY(14) ALTRET;
      117     5595    1   DCL IPD$SETSEG ENTRY(2);
      118     5596    1   DCL IPD$MON_STORE ENTRY(2);
      119     5597    1   DCL IPD$MON_HSTORE ENTRY(2);
      120     5598    1   DCL IPD$MON_VALUE ENTRY(2);
      121     5599    1   DCL IPD$MON_HVAL ENTRY(2);
      122     5600    1   DCL IPD$GET_SLOT ENTRY(1) ALTRET;
      123     5601    1   DCL IPD$FREE_PROC ENTRY(2) ALTRET;
      124     5602    1   DCL IPD$REAL_TO_PHYS ENTRY(2);
      125     5603    1   DCL IPD$PHYS_TO_REAL ENTRY(2);
      126     5604        /**/
      127     5605        %SUB B$P=P$->B$P;
      128     5606        %SUB S$WSPTD=WSPTD$->S$WSPTD;
      129     5607        %SUB B$HEAD=HEAD$->B$HEAD;
      130     5608        %SUB B$PT=PGTBL$->B$MAP;
      131     5609        %SUB B$TREEHDR=TREEHDR$->B$TREEHDR;
      132     5610        %SUB B$NODE=TNODE$->B$NODE;
      133     5611        %SUB MM$PPUT=PPUT$->MM$PPUT;
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:6    
      134     5612        /**/
      135     5613        %EJECT;
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:7    
      136     5614        /**/
      137     5615        /*F*    NAME:   IPC$ADD_SPCL                                       */
      138     5616        /*F*    PURPOSE: To install a special shared processor in the      */
      139     5617        /*,*            processor tables.                                  */
      140     5618    1   IPC$ADD_SPCL: ENTRY(PCNTRL,SLOT,ERR) ALTRET;
      141     5619        /* Get processor's home WSQ */
      142     5620    1           IF PCNTRL.PTYPE = I_CP
      143     5621    1             THEN PWSQ = %CPWSQ;
      144     5622    1             ELSE IF PCNTRL.PTYPE = I_DB
      145     5623    1               THEN PWSQ = %DBWSQ;
      146     5624    1               ELSE PWSQ = %ASLWSQ;
      147     5625        /* Allocate a page table for this WSQ if this is the 1st processor */
      148     5626        /* of a given type.                                                */
      149     5627    1           CALL IPD$MON_HVAL(MM_PWSQPGS(PWSQ-%CPWSQ),NXTWSQPG);
      150     5628
      151     5629        /* If this program has a lib find it. */
      152     5630    1           LIBNUM = 0;
      153     5631    1           PGTBLNEEDED = B$HEAD.VPPGS;
      154     5632    1           IF B$HEAD.LIBNAME.CNT ~= 0
      155     5633    2             THEN DO;
      156     5634    3                 DO LIBNUM = 1 TO NPROCS;
      157     5635    3                   IF B$HEAD.LIBNAME = B$P.NAME(LIBNUM) AND NOT B$P.FLGS(LIBNUM) & %
              5635                            P_OLDPROC
      158     5636    3                     THEN
      159     5637    3                     GOTO GOT_LIB;
      160     5638    3                 END;
      161     5639    2                 ERR = ERR_NOLIB;
      162     5640                    /*E* ERROR: IPC-E$IP_NOLIB-3
      163     5641                         MESSAGE: The library specified in the head record does
      164     5642                                  not exist.
      165     5643                        */
      166     5644    2                 GOTO GOT_ERR;
      167     5645    2   GOT_LIB:      ;
      168     5646    2                 PGTBLNEEDED = B$P.HVA (LIBNUM) - %ISEGLO;
      169     5647    2                 IF B$P.PPC (LIBNUM) = 0 OR NOT (B$P.FLGS(LIBNUM) & %P_LIB)
      170     5648    3                   THEN DO;
      171     5649    3                       ERR = ERR_NOLIB;
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:8    
      172     5650    3                       GOTO GOT_ERR;
      173     5651    3                     END;
      174     5652    2               END;
      175     5653
      176     5654
      177     5655        /* Map onto master CPU WSPTD and page table for this WSQ. */
      178     5656    1           FPT_CVM.V.PHYSICAL# = '0'B;     /* WE WANT WSQ0 REL ON 90S            */
      179     5657    1           FPT_CVM.V.PPNO# = SCPUWSPTD(0);
      180     5658    1           FPT_CVM.V.VPNO# = VP_WSPTD;
      181     5659    1           CALL M$CVM(FPT_CVM) ALTRET(SET_ERR);
      182     5660    1           PGTBLSZ = S$WSPTD.NBLKS(PWSQ) * 64;
      183     5661    1           FPT_CVM.V.PHYSICAL# = '1'B;     /* NOW WE WANT TO MAP PHYS            */
      184     5662    1           FPT_CVM.V.PPNO# = S$WSPTD.BLKNO(PWSQ)/(1024/IP_PTB_UNITS);
      185     5663    1           FPT_CVM.V.VPNO# = VP_PGTBL;
      186     5664    1           CALL M$CVM(FPT_CVM) ALTRET(SET_ERR);
      187     5665    1           IF PGTBLSZ > 1024
      188     5666    2             THEN DO;
      189     5667    2                 FPT_CVM.V.PPNO# = FPT_CVM.V.PPNO# + 1;
      190     5668    2                 FPT_CVM.V.VPNO# = FPT_CVM.V.VPNO# + 1;
      191     5669    2                 CALL M$CVM(FPT_CVM) ALTRET(SET_ERR);
      192     5670    2               END;
      193     5671        /* Prepare for call to IPB$READ */
      194     5672    1           PFLGS = PCNTRL.PFLGS;
      195     5673    1           BIAS = B$HEAD.BIAS;
      196     5674    1           TOTSZ = B$HEAD.RPROC;
      197     5675    1           PGSZ = B$HEAD.PRECSIZE;
      198     5676        /* Make sure we're not going to go off the end of the special      */
      199     5677        /* shared processor WSQ page table.                                */
      200     5678    1           IF NXTWSQPG + PGTBLNEEDED > PGTBLSZ
      201     5679    2             THEN DO;
      202     5680    2                 ERR = ERR_NOPGTBL;
      203     5681                       /*E* ERROR: IPC-E$IP_NOPGTBL-3
      204     5682                            MESSAGE: No room left in the WSQ's page table for
      205     5683                                     this processor.
      206     5684                        */
      207     5685    2                 GOTO GOT_ERR;
      208     5686    2               END;
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:9    
      209     5687    1           CALL IPB$READ(PFLGS,%TYPPROG,BIAS,TOTSZ,PGSZ,0,HEAD,TAIL,COUNT,
      210     5688    1             PGTBL$,NXTWSQPG,BUF$,ERR,SLOT) ALTRET(GOT_ERR);
      211     5689        /* We've got it all in now.  Set up the processor tables, storing   */
      212     5690        /* the name last, as this enables users to associate the processor. */
      213     5691    1           CALL COMMON_SETUP;              /* Fill in common values              */
      214     5692    1           B$P.DADDR(SLOT) = 0;
      215     5693    1           B$P.DSZ(SLOT) = 0;
      216     5694    1           B$P.PVA(SLOT) = NXTWSQPG;
      217     5695    1           B$P.DVA(SLOT) = 0;
      218     5696    1           B$P.HVA(SLOT) = NXTWSQPG + PGTBLNEEDED;
      219     5697    1           B$P.SA(SLOT) = B$HEAD.START;
      220     5698    1           CALL IPD$MON_HSTORE(MM_PWSQPGS(PWSQ-%CPWSQ),NXTWSQPG + PGTBLNEEDED);
      221     5699        /* Read in any initialized data segments & fill in B$P entries */
      222     5700    1           PROC$ = ADDR(B$P.DSDATA(SLOT));
      223     5701    1           PROC$->B$PROCDS = '0'B;
      224     5702    1           SEGID = BITBIN(%DS3SID);        /* DS3 is 1st init-able one           */
      225     5703    1           BIAS = 0;
      226     5704    2           DO I = 0 TO 5;
      227     5705    2             IF B$HEAD.DATA_SEG.SIZ(I) > 0 THEN
      228     5706    3                 DO;
      229     5707    3                   TOTSZ = B$HEAD.DATA_SEG.SIZ(I);
      230     5708    3                   CALL IPB$READ(PFLGS,%TYPDATASEG,BIAS,TOTSZ,PGSZ,SEGID,
      231     5709    3                     HEAD,TAIL,COUNT,,,BUF$,ERR,SLOT) ALTRET(GOT_ERR);
      232     5710    3                   PROC$->B$PROCDS.DSPH(I) = HEAD;
      233     5711    3                   PROC$->B$PROCDS.DSSIZE(I) = TOTSZ;
      234     5712    3                   PROC$->B$PROCDS.DSPROT(I) = B$HEAD.DATA_SEG.PROTECTION(I);
      235     5713    3                 END;
      236     5714    2             SEGID = SEGID + 1;
      237     5715    2           END;
      238     5716
      239     5717
      240     5718        /* If there is a library map that in now */
      241     5719    1           IF LIBNUM ~= 0
      242     5720    2             THEN DO;
      243     5721    2                 HEAD = B$P.HPP(LIBNUM);
      244     5722    2                 TAIL = B$P.PVA(LIBNUM) + B$P.PPC(LIBNUM) - 1 - %ISEGLO;
      245     5723    3                 DO I = B$P.PVA(LIBNUM)-%ISEGLO TO TAIL;
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:10   
      246     5724    4                   IF IP_WSQ0PT THEN DO;
      247     5725    4                         CALL IPD$REAL_TO_PHYS(HEAD,TMP);
      248     5726    4                         B$PT.RPN(I+NXTWSQPG)=TMP;
      249     5727    4                       END;
      250     5728    3                     ELSE
      251     5729    3                     B$PT.RPN(I+NXTWSQPG) = HEAD;
      252     5730    3                   B$PT.CTRL(I+NXTWSQPG) = %PGINMEM | %PGIOM;
      253     5731    3                   HEAD = MM$PPUT.PPNO(HEAD);
      254     5732    3                 END;
      255     5733    2                 B$P.UC(LIBNUM) = B$P.UC(LIBNUM) + 1;
      256     5734    2                 B$P.LIB_LNK(SLOT) = LIBNUM;
      257     5735    2               END;
      258     5736
      259     5737
      260     5738        /* Finally, make this processor visible to the world... */
      261     5739    1           B$P.NAME.COUNT(SLOT) = PCNTRL.PNAME$->B$TEXTC.COUNT;
      262     5740    1           B$P.NAME.TEXT(SLOT) = PCNTRL.PNAME$->B$TEXTC.TEXT;
      263     5741    1           B$P.ACCT(SLOT) = ':SYS';
      264     5742        /**/
      265     5743    1           RETURN;
      266     5744        /**/
      267     5745        %EJECT;
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:11   
      268     5746    1   IPC$DEL_SPCL: ENTRY(PCNTRL,SLOT,ERR) ALTRET;
      269     5747        /* Get processor's home WSQ */
      270     5748    1           IF PCNTRL.PTYPE = I_CP
      271     5749    1             THEN PWSQ = %CPWSQ;
      272     5750    1             ELSE IF PCNTRL.PTYPE = I_DB
      273     5751    1               THEN PWSQ = %DBWSQ;
      274     5752    1               ELSE IF PCNTRL.PTYPE = I_LIB
      275     5753    1                 THEN RETURN;
      276     5754    1                 ELSE PWSQ = %ASLWSQ;
      277     5755    2           IF B$P.LIB_LNK(SLOT) ~= 0 THEN DO;
      278     5756    2                 B$P.UC(B$P.LIB_LNK(SLOT)) = B$P.UC(B$P.LIB_LNK(SLOT)) -1;
      279     5757    2                 B$P.LIB_LNK(SLOT) = 0;
      280     5758    2               END;
      281     5759    1           CALL IPD$MON_HVAL(MM_PWSQPGS(PWSQ-%CPWSQ),NXTWSQPG);
      282     5760    1           IF NXTWSQPG = B$P.HVA (SLOT)
      283     5761    1             THEN
      284     5762    1             NXTWSQPG = B$P.PVA (SLOT);
      285     5763    1           CALL IPD$MON_HSTORE(MM_PWSQPGS(PWSQ-%CPWSQ),NXTWSQPG);
      286     5764    1           RETURN;
      287     5765        %EJECT;
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:12   
      288     5766        /**/
      289     5767        /*F*    NAME:   IPC$ADD_LIB
      290     5768                PURPOSE: To install a shared library in the processor tables. */
      291     5769    1   IPC$ADD_LIB: ENTRY(PCNTRL,SLOT,ERR) ALTRET;
      292     5770        /* Setup call to IPB$READ to bring in the processor's procedure */
      293     5771    1           PFLGS = PCNTRL.PFLGS;
      294     5772    1           BIAS = (B$HEAD.BIAS/1024 + B$HEAD.VDPGS)*1024;
      295     5773    1           TOTSZ = B$HEAD.RPROC;
      296     5774    1           PGSZ = B$HEAD.PRECSIZE;
      297     5775    1           CALL IPB$READ(PFLGS,%TYPPROG,BIAS,TOTSZ,PGSZ,0,HEAD,TAIL,COUNT,
      298     5776    1             ,,BUF$,ERR,SLOT) ALTRET(GOT_ERR);
      299     5777        /* Set up the processor table data for this processor */
      300     5778    1           CALL COMMON_SETUP;              /* Fill in common values              */
      301     5779    1           B$P.DADDR(SLOT) = B$HEAD.BIAS;
      302     5780    1           B$P.DSZ(SLOT) = B$HEAD.RDATA;
      303     5781    1           B$P.PVA(SLOT) = %ISEGLO + BIAS/1024;
      304     5782    1           B$P.DVA(SLOT) = %ISEGLO + B$HEAD.BIAS/1024;
      305     5783    1           B$P.HVA(SLOT) = %ISEGLO + BIAS/1024 + COUNT;
      306     5784    1           B$P.SA(SLOT) = 0;
      307     5785    1           B$P.TCBSZ(SLOT) = 0;
      308     5786        /* READ LIBRARY DATA INTO MEMORY FOR RUN TIME INITIALIZATION */
      309     5787
      310     5788    1           PROC$ = ADDR(B$P.DSDATA(SLOT));
      311     5789    1           PROC$->B$PROCDS = '0'B;
      312     5790    1           BIAS= B$HEAD.BIAS;
      313     5791    1           TOTSZ = B$HEAD.RDATA;
      314     5792    1           CALL IPB$READ(PFLGS,%TYPPROG,BIAS,TOTSZ,PGSZ,0,HEAD,TAIL,COUNT,
      315     5793    1             ,,BUF$,ERR,SLOT) ALTRET(GOT_ERR);
      316     5794    1           PROC$->B$PROCDS.DSPH(0) = HEAD;
      317     5795    1           PROC$->B$PROCDS.DSSIZE(0) = TOTSZ;
      318     5796        /* Finally, make this processor visible to the world... */
      319     5797    1           B$P.NAME.COUNT(SLOT) = PCNTRL.PNAME$->B$TEXTC.COUNT;
      320     5798    1           B$P.NAME.TEXT(SLOT) = PCNTRL.PNAME$->B$TEXTC.TEXT;
      321     5799    1           B$P.ACCT(SLOT) = ':SYS';
      322     5800        /**/
      323     5801    1           RETURN;
      324     5802        /**/
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:13   
      325     5803    1   SET_ERR:
      326     5804    1           ERR = B$JIT.ERR;
      327     5805    1   GOT_ERR:
      328     5806    1           CALL IPD$FREE_PROC(SLOT) ALTRET(DBL_ERR);
      329     5807    1           ALTRETURN;
      330     5808    1   DBL_ERR:
      331     5809    1           ERRTEMP = B$JIT.ERR;            /* Remember secondary error           */
      332     5810    1           FPT_ERRMSG.CODE_ = VECTOR(ERR);
      333     5811    1           IF B$JIT.USER = 1 THEN FPT_ERRMSG.V.OUTDCB1# = DCBNUM(NIL);
      334     5812    1           CALL M$ERRMSG(FPT_ERRMSG) ALTRET(SOWHAT);
      335     5813    1           IF B$JIT.USER = 1 THEN
      336     5814    2               DO;
      337     5815    2                 CALL M$TEMPWROC(WRITE_OC);
      338     5816    2                 CALL M$TEMPWROC(OC_CRLF);
      339     5817    2               END;
      340     5818    1   SOWHAT: ERR = ERRTEMP;
      341     5819    1           ALTRETURN;
      342     5820        /**/
      343     5821        %EJECT;
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:14   
      344     5822        /**/
      345     5823        /**********************************/
      346     5824        /*   Internal Procedures          */
      347     5825        /**********************************/
      348     5826        /**/
      349     5827        /* This routine initializes portions of the processor tables common */
      350     5828        /* to all types of shared processor.                                */
      351     5829    1   COMMON_SETUP: PROC;
      352     5830        /**/
      353     5831    2           B$P.UC(SLOT) = 0;
      354     5832    2           B$P.LNK(SLOT) = 0;
      355     5833    2           B$P.FRQ(SLOT) = 0;
      356     5834    2           B$P.HPP(SLOT) = HEAD;
      357     5835    2           B$P.TPP(SLOT) = TAIL;
      358     5836    2           B$P.PPC(SLOT) = COUNT;
      359     5837    2           B$P.CRDATE(SLOT) = PCNTRL.MODTIME;
      360     5838    2           B$P.XEQTIME(SLOT) = 0;
      361     5839    2           B$P.SRVTIME(SLOT) = 0;
      362     5840    2           B$P.PRIV(SLOT) = B$HEAD.PRIV;
      363     5841    2           B$P.FLGS(SLOT) = PCNTRL.PFLGS;
      364     5842    2           B$P.LIB_LNK(SLOT) = 0;
      365     5843    2           IF B$HEAD.TCBSIZE = 0
      366     5844    2             THEN B$P.TCBSZ(SLOT) = 0;
      367     5845    2             ELSE B$P.TCBSZ(SLOT) = B$HEAD.TCBSIZE * %UE_AV_TCBSZ# + %UE_FX_TCBSZ#;
      368     5846    2           CALL M$TIME(FPT_TIME);
      369     5847    2           B$P.INSTDATE(SLOT) = CUTS;
      370     5848    2           RETURN;
      371     5849    2   END COMMON_SETUP;
      372     5850        /**/
      373     5851        /**/
      374     5852        /**/
      375     5853    1   END IPC$PROCS;

PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:15   
--  Include file information  --

   U$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
   S$WSPTD.:E05TOU  cannot be made into a system file and is referenced.
   MM_MACRO_M.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   MM$SYSGEN.:E05TOU  is referenced.
   M_INFO_C.:E05TOU  is referenced.
   MM_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   IPS_SUBS_C.:E05TOU  is referenced.
   IP_PERR_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   B$P.:E05TOU  cannot be made into a system file and is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   B$MAP.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure IPC$PROCS.

   Procedure IPC$PROCS requires 830 words for executable code.
   Procedure IPC$PROCS requires 40 words of local(AUTO) storage.

    No errors detected in file IPC$PROCS.:E05TSI    .

PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:16   

 Object Unit name= IPC$PROCS                                  File name= IPC$PROCS.:E05TOU
 UTS= JUL 29 '97 22:40:27.40 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    70    106  IPC$PROCS
    2   DCB   even  none     0      0  M$LO
    3   DCB   even  none     0      0  M$EI
    4  RoData even  UTS      1      1  IPC$PROCS
    5   Proc  even  none   830   1476  IPC$PROCS
    6  RoData even  none    11     13  IPC$PROCS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes    yes     yes      Std        3  IPC$PROCS
     5      3          yes     yes      Std        3  IPC$ADD_SPCL
     5    622          yes     yes      Std        3  IPC$DEL_SPCL
     5    750          yes     yes      Std        3  IPC$ADD_LIB
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:17   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 IPD$MON_HVAL
 yes     yes           Std      14 IPB$READ
         yes           Std       2 IPD$MON_HSTORE
         yes           Std       2 IPD$REAL_TO_PHYS
 yes     yes           Std       2 IPD$FREE_PROC
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    MM_BYP$                               MM_PWSQPGS
     NPROCS                                M$LO                                  M$EI
     BUF$                                  PPUT$                                 WSPTD$
     PGTBL$                                SCPUWSPTD                             P$
     HEAD$                                 B$JIT$                                IP_PTB_UNITS
     IP_WSQ0PT                             ERRMSGBUF                             B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:18   


        1        1        /*M* IPC$PROCS - SPIDER routines for updating the processor tables. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=8,IND=2,THI=2,ENU=2,CSU=2,DTI=4,DCI=4,ECU=4,AND */
        8        8        IPC$PROCS: PROC(PCNTRL,SLOT,ERR) ALTRET;

      8  5 000000   000000 700200 xent  IPC$PROCS    TSX0  ! X66_AUTO_3
         5 000001   000050 000003                    ZERO    40,3
         5 000002   000005 710000 5                  TRA     s:5620

        9        9    1   DCL 1 PCNTRL,                           /* Process control block              */
       10       10    1         2 CMD# UBIN WORD,                 /* Command number                     */
       11       11    1         2 PNAME$ PTR,                     /* PTR to processor name              */
       12       12    1         2 PACCT$ PTR,                     /* PTR to account name (LIST)         */
       13       13    1         2 PTYPE UBIN HALF UNAL,           /* Processor type (internal code)     */
       14       14    1         2 PERM BIT(1) UNAL,
       15       15    1         2 * UBIN(8) UNAL,
       16       16    1         2 * UBIN BYTE UNAL,
       17       17    1         2 FID$ PTR,                       /* PTR to FID for processor           */
       18       18    1         2 MODTIME UBIN WORD,              /* Modification time from RU          */
       19       19    1         2 PNUM UBIN HALF UNAL,            /* Processor number                   */
       20       20    1         2 * UBIN(18) UNAL,
       21       21    1         2 PFLGS BIT(36) UNAL;             /* Processor type flags               */
       22       22    1   DCL SLOT SBIN;                          /* Where to install new processor     */
       23       23    1   DCL 1 ERR ALIGNED,
       24       24    1         2 FCG BIT(12) UNAL,
       25       25    1         2 MID BIT(6) UNAL,
       26       26    1         2 M BIT(1) UNAL,
       27       27    1         2 CODE UBIN(14) UNAL,
       28       28    1         2 SEV UBIN(3) UNAL;
       29       29        /**/
       30       30        %INCLUDE B$MAP;
       31      129        %INCLUDE B$OBJECT_C;
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:19   
       32     3559        %INCLUDE B$P;
       33     3643        %INCLUDE B_SEGIDS_C;
       34     4182        %INCLUDE CP_6;
       35     4263        %INCLUDE IP_PERR_C;
       36     4291        %INCLUDE IPS_SUBS_C;
       37     4328        %INCLUDE MM_DATA_R;
       38     4848        %INCLUDE S$WSPTD;
       39     4857        %INCLUDE U$JIT_C;
       40     5043        /**/
       41     5044        %EJECT;
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:20   
       42     5045        /**/
       43     5046        %B$HEAD;
       44     5246        %B$TREE_TABLE(HDR_NAME=B$TREEHDR,
       45     5247                      NODE_NAME=B$NODE);
       46     5305        %B$RECORDSUBS;
       47     5333        %EQU_TCB_SZ;
       48     5337        %FPT_CVM;
       49     5353        %FPT_STLPP(RESULTS=STLVEC);
       50     5366        %FPT_ERRMSG(BUF=ERRMSGBUF,
       51     5367                     DCB=M$EI,
       52     5368                      OUTDCB1=M$LO);
       53     5395        %FPT_TEMPWROC(FPTN=WRITE_OC,
       54     5396                      BUFW=ERRMSGBUF);
       55     5412        %FPT_TEMPWROC(FPTN=OC_CRLF,
       56     5413                      BUFW=T_CRLF);
       57     5429        %FPT_TIME(SOURCE=CLOCK,
       58     5430                  DEST=UTS,
       59     5431                  TSTAMP=CUTS);
       60     5450        /**/
       61     5451        /**/
       62     5452
       63     5453    1   DCL NPROCS UBIN SYMREF;
       64     5454
       65     5455
       66     5456    1   DCL PGTBLSZ SBIN;
       67     5457    1   DCL PGTBLNEEDED SBIN;
       68     5458    1   DCL LIBNUM SBIN;
       69     5459    1   DCL PWSQ SBIN;
       70     5460    1   DCL NXTWSQPG SBIN;
       71     5461    1   DCL PFLGS BIT(36);
       72     5462    1   DCL BIAS SBIN;
       73     5463    1   DCL TOTSZ SBIN;
       74     5464    1   DCL PGSZ SBIN;
       75     5465    1   DCL HEAD SBIN;
       76     5466    1   DCL TAIL SBIN;
       77     5467    1   DCL COUNT SBIN;
       78     5468    1   DCL PROC$ PTR;
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:21   
       79     5469    1   DCL I SBIN;
       80     5470    1   DCL SEGID UBIN;
       81     5471    1   DCL ERRTEMP BIT(36);
       82     5472    1   DCL CUTS UBIN STATIC DALIGNED;
       83     5473    1   DCL T_CRLF(0:1) CHAR(1) STATIC UNAL INIT(BITASC('015'O),BITASC('012'O));
       84     5474        %VLP_ERRCODE (FPTN=ERR_NOPGTBL,FCG=IP,MID=C,ERR#=E$IP_NOPGTBL,SEV=3);
       85     5519        %VLP_ERRCODE (FPTN=ERR_NOLIB,FCG=IP,MID=C,ERR#=E$IP_NOLIB,SEV=3);
       86     5564    1   DCL 1 STLVEC STATIC DALIGNED,
       87     5565    1         2 * UBIN WORD,
       88     5566    1         2 PNO UBIN WORD;
       89     5567    1   DCL M$LO DCB;
       90     5568    1   DCL M$EI DCB;
       91     5569        /**/
       92     5570    1   DCL 1 B$TEXTC BASED DALIGNED,
       93     5571    1         2 COUNT UBIN(9) UNAL,
       94     5572    1         2 TEXT CHAR(B$TEXTC.COUNT) UNAL;
       95     5573        /**/
       96     5574        %EJECT;
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:22   
       97     5575        /**/
       98     5576    1   DCL BUF$ PTR SYMREF;
       99     5577    1   DCL PPUT$ PTR SYMREF;
      100     5578    1   DCL WSPTD$ PTR SYMREF;
      101     5579    1   DCL PGTBL$ PTR SYMREF;
      102     5580    1   DCL SCPUWSPTD(0:3) UBIN SYMREF;
      103     5581    1   DCL NSCPU UBIN SYMREF;
      104     5582    1   DCL P$ PTR SYMREF;
      105     5583    1   DCL HEAD$ PTR SYMREF;
      106     5584    1   DCL B$JIT$ PTR SYMREF;
      107     5585    1   DCL B$IS$ PTR SYMREF;
      108     5586    1   DCL B$SPCL3$ PTR SYMREF;
      109     5587    1   DCL B$WSQ0PT$ PTR SYMREF;
      110     5588    1   DCL IP_PTB_UNITS SBIN WORD SYMREF;
      111     5589    1   DCL IP_WSQ0PT BIT(1) ALIGNED SYMREF;
      112     5590    1   DCL TMP SBIN;
      113     5591    1   DCL TMP1 SBIN;
      114     5592    1   DCL ERRMSGBUF CHAR(120) SYMREF;
      115     5593        /**/
      116     5594    1   DCL IPB$READ ENTRY(14) ALTRET;
      117     5595    1   DCL IPD$SETSEG ENTRY(2);
      118     5596    1   DCL IPD$MON_STORE ENTRY(2);
      119     5597    1   DCL IPD$MON_HSTORE ENTRY(2);
      120     5598    1   DCL IPD$MON_VALUE ENTRY(2);
      121     5599    1   DCL IPD$MON_HVAL ENTRY(2);
      122     5600    1   DCL IPD$GET_SLOT ENTRY(1) ALTRET;
      123     5601    1   DCL IPD$FREE_PROC ENTRY(2) ALTRET;
      124     5602    1   DCL IPD$REAL_TO_PHYS ENTRY(2);
      125     5603    1   DCL IPD$PHYS_TO_REAL ENTRY(2);
      126     5604        /**/
      127     5605        %SUB B$P=P$->B$P;
      128     5606        %SUB S$WSPTD=WSPTD$->S$WSPTD;
      129     5607        %SUB B$HEAD=HEAD$->B$HEAD;
      130     5608        %SUB B$PT=PGTBL$->B$MAP;
      131     5609        %SUB B$TREEHDR=TREEHDR$->B$TREEHDR;
      132     5610        %SUB B$NODE=TNODE$->B$NODE;
      133     5611        %SUB MM$PPUT=PPUT$->MM$PPUT;
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:23   
      134     5612        /**/
      135     5613        %EJECT;
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:24   
      136     5614        /**/
      137     5615        /*F*    NAME:   IPC$ADD_SPCL                                       */
      138     5616        /*F*    PURPOSE: To install a special shared processor in the      */
      139     5617        /*,*            processor tables.                                  */
      140     5618    1   IPC$ADD_SPCL: ENTRY(PCNTRL,SLOT,ERR) ALTRET;

   5618  5 000003   000000 700200 xent  IPC$ADD_SPCL TSX0  ! X66_AUTO_3
         5 000004   000050 000003                    ZERO    40,3

      141     5619        /* Get processor's home WSQ */
      142     5620    1           IF PCNTRL.PTYPE = I_CP

   5620  5 000005   200003 470500                    LDP0    @PCNTRL,,AUTO
         5 000006   000003 220100                    LDX0    3,,PR0
         5 000007   000024 100003                    CMPX0   20,DU
         5 000010   000014 601000 5                  TNZ     s:5622

      143     5621    1             THEN PWSQ = %CPWSQ;

   5621  5 000011   000004 235007                    LDA     4,DL
         5 000012   200011 755100                    STA     PWSQ,,AUTO
         5 000013   000023 710000 5                  TRA     s:5627

      144     5622    1             ELSE IF PCNTRL.PTYPE = I_DB

   5622  5 000014   000025 100003                    CMPX0   21,DU
         5 000015   000021 601000 5                  TNZ     s:5624

      145     5623    1               THEN PWSQ = %DBWSQ;

   5623  5 000016   000005 235007                    LDA     5,DL
         5 000017   200011 755100                    STA     PWSQ,,AUTO
         5 000020   000023 710000 5                  TRA     s:5627

      146     5624    1               ELSE PWSQ = %ASLWSQ;

   5624  5 000021   000006 235007                    LDA     6,DL
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:25   
         5 000022   200011 755100                    STA     PWSQ,,AUTO

      147     5625        /* Allocate a page table for this WSQ if this is the 1st processor */
      148     5626        /* of a given type.                                                */
      149     5627    1           CALL IPD$MON_HVAL(MM_PWSQPGS(PWSQ-%CPWSQ),NXTWSQPG);

   5627  5 000023   200012 631500                    EPPR1   NXTWSQPG,,AUTO
         5 000024   200033 451500                    STP1    TMP+5,,AUTO
         5 000025   200011 236100                    LDQ     PWSQ,,AUTO
         5 000026   000021 736000                    QLS     17
         5 000027   000000 036000 6                  ADLQ    0
         5 000030   200032 756100                    STQ     TMP+4,,AUTO
         5 000031   200032 630500                    EPPR0   TMP+4,,AUTO
         5 000032   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000033   000000 701000 xent               TSX1    IPD$MON_HVAL
         5 000034   000000 011000                    NOP     0

      150     5628
      151     5629        /* If this program has a lib find it. */
      152     5630    1           LIBNUM = 0;

   5630  5 000035   200010 450100                    STZ     LIBNUM,,AUTO

      153     5631    1           PGTBLNEEDED = B$HEAD.VPPGS;

   5631  5 000036   000000 470400 xsym               LDP0    HEAD$
         5 000037   000001 236100                    LDQ     1,,PR0
         5 000040   000026 772000                    QRL     22
         5 000041   200007 756100                    STQ     PGTBLNEEDED,,AUTO

      154     5632    1           IF B$HEAD.LIBNAME.CNT ~= 0

   5632  5 000042   000030 236100                    LDQ     24,,PR0
         5 000043   777000 316003                    CANQ    -512,DU
         5 000044   000115 600000 5                  TZE     s:5656

      155     5633    2             THEN DO;
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:26   

      156     5634    3                 DO LIBNUM = 1 TO NPROCS;

   5634  5 000045   000001 235007                    LDA     1,DL
         5 000046   200010 755100                    STA     LIBNUM,,AUTO
         5 000047   000066 710000 5                  TRA     s:5638+1

      157     5635    3                   IF B$HEAD.LIBNAME = B$P.NAME(LIBNUM) AND NOT B$P.FLGS(LIBNUM) & %
              5635                            P_OLDPROC

   5635  5 000050   200010 236100                    LDQ     LIBNUM,,AUTO
         5 000051   000210 402007                    MPY     136,DL
         5 000052   000000 470400 xsym               LDP0    HEAD$
         5 000053   000000 471400 xsym               LDP1    P$
         5 000054   000106 106500                    CMPC    fill='000'O
         5 000055   000030 000040                    ADSC9   24,,PR0                  cn=0,n=32
         5 000056   100032 000040                    ADSC9   26,Q,PR1                 cn=0,n=32
         5 000057   000065 601000 5                  TNZ     s:5638
         5 000060   200010 236100                    LDQ     LIBNUM,,AUTO
         5 000061   000042 402007                    MPY     34,DL
         5 000062   100027 220106                    LDX0    23,QL,PR1
         5 000063   001000 360003                    ANX0    512,DU
         5 000064   000076 600000 5                  TZE     GOT_LIB

      158     5636    3                     THEN
      159     5637    3                     GOTO GOT_LIB;
      160     5638    3                 END;

   5638  5 000065   200010 054100                    AOS     LIBNUM,,AUTO
         5 000066   000000 236000 xsym               LDQ     NPROCS
         5 000067   000050 604000 5                  TMI     s:5635
         5 000070   200010 116100                    CMPQ    LIBNUM,,AUTO
         5 000071   000050 605000 5                  TPL     s:5635

      161     5639    2                 ERR = ERR_NOLIB;

   5639  5 000072   000102 236000 1                  LDQ     ERR_NOLIB
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:27   
         5 000073   200005 471500                    LDP1    @ERR,,AUTO
         5 000074   100000 756100                    STQ     0,,PR1

      162     5640                    /*E* ERROR: IPC-E$IP_NOLIB-3
      163     5641                         MESSAGE: The library specified in the head record does
      164     5642                                  not exist.
      165     5643                        */
      166     5644    2                 GOTO GOT_ERR;

   5644  5 000075   001263 710000 5                  TRA     GOT_ERR

   5639  5 000076                       GOT_LIB      null
      167     5645    2   GOT_LIB:      ;
      168     5646    2                 PGTBLNEEDED = B$P.HVA (LIBNUM) - %ISEGLO;

   5646  5 000076   100026 236106                    LDQ     22,QL,PR1
         5 000077   000022 772000                    QRL     18
         5 000100   000100 136007                    SBLQ    64,DL
         5 000101   200007 756100                    STQ     PGTBLNEEDED,,AUTO

      169     5647    2                 IF B$P.PPC (LIBNUM) = 0 OR NOT (B$P.FLGS(LIBNUM) & %P_LIB)

   5647  5 000102   200010 236100                    LDQ     LIBNUM,,AUTO
         5 000103   000042 402007                    MPY     34,DL
         5 000104   100003 235106                    LDA     3,QL,PR1
         5 000105   000111 600000 5                  TZE     s:5649
         5 000106   100027 220106                    LDX0    23,QL,PR1
         5 000107   100000 360003                    ANX0    32768,DU
         5 000110   000115 601000 5                  TNZ     s:5656

      170     5648    3                   THEN DO;

      171     5649    3                       ERR = ERR_NOLIB;

   5649  5 000111   000102 236000 1                  LDQ     ERR_NOLIB
         5 000112   200005 473500                    LDP3    @ERR,,AUTO
         5 000113   300000 756100                    STQ     0,,PR3
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:28   

      172     5650    3                       GOTO GOT_ERR;

   5650  5 000114   001263 710000 5                  TRA     GOT_ERR

      173     5651    3                     END;
      174     5652    2               END;
      175     5653
      176     5654
      177     5655        /* Map onto master CPU WSPTD and page table for this WSQ. */
      178     5656    1           FPT_CVM.V.PHYSICAL# = '0'B;     /* WE WANT WSQ0 REL ON 90S            */

   5656  5 000115   000001 236000 6                  LDQ     1
         5 000116   000002 356000 1                  ANSQ    FPT_CVM+2

      179     5657    1           FPT_CVM.V.PPNO# = SCPUWSPTD(0);

   5657  5 000117   000000 235000 xsym               LDA     SCPUWSPTD
         5 000120   000003 755000 1                  STA     FPT_CVM+3

      180     5658    1           FPT_CVM.V.VPNO# = VP_WSPTD;

   5658  5 000121   000166 220003                    LDX0    118,DU
         5 000122   000004 440000 1                  SXL0    FPT_CVM+4

      181     5659    1           CALL M$CVM(FPT_CVM) ALTRET(SET_ERR);

   5659  5 000123   000000 630400 1                  EPPR0   FPT_CVM
         5 000124   430011 713400                    CLIMB   alt,+12297
         5 000125   400000 401760                    pmme    nvectors=1
         5 000126   001257 702000 5                  TSX2    SET_ERR

      182     5660    1           PGTBLSZ = S$WSPTD.NBLKS(PWSQ) * 64;

   5660  5 000127   000000 470400 xsym               LDP0    WSPTD$
         5 000130   200011 720100                    LXL0    PWSQ,,AUTO
         5 000131   000000 236110                    LDQ     0,X0,PR0
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:29   
         5 000132   000006 736000                    QLS     6
         5 000133   777700 376007                    ANQ     -64,DL
         5 000134   200006 756100                    STQ     PGTBLSZ,,AUTO

      183     5661    1           FPT_CVM.V.PHYSICAL# = '1'B;     /* NOW WE WANT TO MAP PHYS            */

   5661  5 000135   200000 236003                    LDQ     65536,DU
         5 000136   000002 256000 1                  ORSQ    FPT_CVM+2

      184     5662    1           FPT_CVM.V.PPNO# = S$WSPTD.BLKNO(PWSQ)/(1024/IP_PTB_UNITS);

   5662  5 000137   002000 236007                    LDQ     1024,DL
         5 000140   000000 506000 xsym               DIV     IP_PTB_UNITS
         5 000141   200032 756100                    STQ     TMP+4,,AUTO
         5 000142   000000 236110                    LDQ     0,X0,PR0
         5 000143   000022 772000                    QRL     18
         5 000144   200032 506100                    DIV     TMP+4,,AUTO
         5 000145   000003 756000 1                  STQ     FPT_CVM+3

      185     5663    1           FPT_CVM.V.VPNO# = VP_PGTBL;

   5663  5 000146   000144 221003                    LDX1    100,DU
         5 000147   000004 441000 1                  SXL1    FPT_CVM+4

      186     5664    1           CALL M$CVM(FPT_CVM) ALTRET(SET_ERR);

   5664  5 000150   000000 630400 1                  EPPR0   FPT_CVM
         5 000151   430011 713400                    CLIMB   alt,+12297
         5 000152   400000 401760                    pmme    nvectors=1
         5 000153   001257 702000 5                  TSX2    SET_ERR

      187     5665    1           IF PGTBLSZ > 1024

   5665  5 000154   200006 235100                    LDA     PGTBLSZ,,AUTO
         5 000155   002000 115007                    CMPA    1024,DL
         5 000156   000167 604400 5                  TMOZ    s:5672

PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:30   
      188     5666    2             THEN DO;

      189     5667    2                 FPT_CVM.V.PPNO# = FPT_CVM.V.PPNO# + 1;

   5667  5 000157   000003 054000 1                  AOS     FPT_CVM+3

      190     5668    2                 FPT_CVM.V.VPNO# = FPT_CVM.V.VPNO# + 1;

   5668  5 000160   000004 720000 1                  LXL0    FPT_CVM+4
         5 000161   000001 621010                    EAX1    1,X0
         5 000162   000004 441000 1                  SXL1    FPT_CVM+4

      191     5669    2                 CALL M$CVM(FPT_CVM) ALTRET(SET_ERR);

   5669  5 000163   000000 630400 1                  EPPR0   FPT_CVM
         5 000164   430011 713400                    CLIMB   alt,+12297
         5 000165   400000 401760                    pmme    nvectors=1
         5 000166   001257 702000 5                  TSX2    SET_ERR

      192     5670    2               END;

      193     5671        /* Prepare for call to IPB$READ */
      194     5672    1           PFLGS = PCNTRL.PFLGS;

   5672  5 000167   200003 470500                    LDP0    @PCNTRL,,AUTO
         5 000170   000007 236100                    LDQ     7,,PR0
         5 000171   200013 756100                    STQ     PFLGS,,AUTO

      195     5673    1           BIAS = B$HEAD.BIAS;

   5673  5 000172   000000 471400 xsym               LDP1    HEAD$
         5 000173   100023 236100                    LDQ     19,,PR1
         5 000174   000002 376000 6                  ANQ     2
         5 000175   200014 756100                    STQ     BIAS,,AUTO

      196     5674    1           TOTSZ = B$HEAD.RPROC;

PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:31   
   5674  5 000176   100001 236100                    LDQ     1,,PR1
         5 000177   000002 376000 6                  ANQ     2
         5 000200   200015 756100                    STQ     TOTSZ,,AUTO

      197     5675    1           PGSZ = B$HEAD.PRECSIZE;

   5675  5 000201   100006 236100                    LDQ     6,,PR1
         5 000202   000022 772000                    QRL     18
         5 000203   200016 756100                    STQ     PGSZ,,AUTO

      198     5676        /* Make sure we're not going to go off the end of the special      */
      199     5677        /* shared processor WSQ page table.                                */
      200     5678    1           IF NXTWSQPG + PGTBLNEEDED > PGTBLSZ

   5678  5 000204   200012 236100                    LDQ     NXTWSQPG,,AUTO
         5 000205   200007 036100                    ADLQ    PGTBLNEEDED,,AUTO
         5 000206   200006 116100                    CMPQ    PGTBLSZ,,AUTO
         5 000207   000214 604400 5                  TMOZ    s:5687

      201     5679    2             THEN DO;

      202     5680    2                 ERR = ERR_NOPGTBL;

   5680  5 000210   000101 236000 1                  LDQ     ERR_NOPGTBL
         5 000211   200005 473500                    LDP3    @ERR,,AUTO
         5 000212   300000 756100                    STQ     0,,PR3

      203     5681                       /*E* ERROR: IPC-E$IP_NOPGTBL-3
      204     5682                            MESSAGE: No room left in the WSQ's page table for
      205     5683                                     this processor.
      206     5684                        */
      207     5685    2                 GOTO GOT_ERR;

   5685  5 000213   001263 710000 5                  TRA     GOT_ERR

      208     5686    2               END;
      209     5687    1           CALL IPB$READ(PFLGS,%TYPPROG,BIAS,TOTSZ,PGSZ,0,HEAD,TAIL,COUNT,
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:32   

   5687  5 000214   200004 236100                    LDQ     @SLOT,,AUTO
         5 000215   200005 235100                    LDA     @ERR,,AUTO
         5 000216   200046 757100                    STAQ    TMP+16,,AUTO
         5 000217   000004 236000 6                  LDQ     4
         5 000220   200045 756100                    STQ     TMP+15,,AUTO
         5 000221   200012 633500                    EPPR3   NXTWSQPG,,AUTO
         5 000222   200044 453500                    STP3    TMP+14,,AUTO
         5 000223   000005 236000 6                  LDQ     5
         5 000224   200043 756100                    STQ     TMP+13,,AUTO
         5 000225   200021 634500                    EPPR4   COUNT,,AUTO
         5 000226   200042 454500                    STP4    TMP+12,,AUTO
         5 000227   200020 635500                    EPPR5   TAIL,,AUTO
         5 000230   200041 455500                    STP5    TMP+11,,AUTO
         5 000231   200017 636500                    EPPR6   HEAD,,AUTO
         5 000232   200040 456500                    STP6    TMP+10,,AUTO
         5 000233   000006 236000 6                  LDQ     6
         5 000234   200037 756100                    STQ     TMP+9,,AUTO
         5 000235   200016 637500                    EPPR7   PGSZ,,AUTO
         5 000236   200036 457500                    STP7    TMP+8,,AUTO
         5 000237   200015 630500                    EPPR0   TOTSZ,,AUTO
         5 000240   200035 450500                    STP0    TMP+7,,AUTO
         5 000241   200014 630500                    EPPR0   BIAS,,AUTO
         5 000242   200034 450500                    STP0    TMP+6,,AUTO
         5 000243   000007 236000 6                  LDQ     7
         5 000244   200033 756100                    STQ     TMP+5,,AUTO
         5 000245   200013 630500                    EPPR0   PFLGS,,AUTO
         5 000246   200032 450500                    STP0    TMP+4,,AUTO
         5 000247   200032 630500                    EPPR0   TMP+4,,AUTO
         5 000250   000003 631400 6                  EPPR1   3
         5 000251   000000 701000 xent               TSX1    IPB$READ
         5 000252   001263 702000 5                  TSX2    GOT_ERR

      210     5688    1             PGTBL$,NXTWSQPG,BUF$,ERR,SLOT) ALTRET(GOT_ERR);
      211     5689        /* We've got it all in now.  Set up the processor tables, storing   */
      212     5690        /* the name last, as this enables users to associate the processor. */
      213     5691    1           CALL COMMON_SETUP;              /* Fill in common values              */
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:33   

   5691  5 000253   001327 701000 5                  TSX1    COMMON_SETUP
         5 000254   000000 011000                    NOP     0

      214     5692    1           B$P.DADDR(SLOT) = 0;

   5692  5 000255   200004 470500                    LDP0    @SLOT,,AUTO
         5 000256   000000 236100                    LDQ     0,,PR0
         5 000257   000021 402007                    MPY     17,DL
         5 000260   000001 736000                    QLS     1
         5 000261   000000 220003                    LDX0    0,DU
         5 000262   000000 471400 xsym               LDP1    P$
         5 000263   100024 740106                    STX0    20,QL,PR1

      215     5693    1           B$P.DSZ(SLOT) = 0;

   5693  5 000264   000000 236100                    LDQ     0,,PR0
         5 000265   000021 402007                    MPY     17,DL
         5 000266   000001 736000                    QLS     1
         5 000267   000000 471400 xsym               LDP1    P$
         5 000270   100024 440106                    SXL0    20,QL,PR1

      216     5694    1           B$P.PVA(SLOT) = NXTWSQPG;

   5694  5 000271   000000 236100                    LDQ     0,,PR0
         5 000272   000021 402007                    MPY     17,DL
         5 000273   000001 736000                    QLS     1
         5 000274   200012 721100                    LXL1    NXTWSQPG,,AUTO
         5 000275   000000 471400 xsym               LDP1    P$
         5 000276   100025 741106                    STX1    21,QL,PR1

      217     5695    1           B$P.DVA(SLOT) = 0;

   5695  5 000277   000000 236100                    LDQ     0,,PR0
         5 000300   000021 402007                    MPY     17,DL
         5 000301   000001 736000                    QLS     1
         5 000302   000000 471400 xsym               LDP1    P$
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:34   
         5 000303   100025 440106                    SXL0    21,QL,PR1

      218     5696    1           B$P.HVA(SLOT) = NXTWSQPG + PGTBLNEEDED;

   5696  5 000304   000000 236100                    LDQ     0,,PR0
         5 000305   000021 402007                    MPY     17,DL
         5 000306   000001 736000                    QLS     1
         5 000307   000000 621006                    EAX1    0,QL
         5 000310   200012 236100                    LDQ     NXTWSQPG,,AUTO
         5 000311   200007 036100                    ADLQ    PGTBLNEEDED,,AUTO
         5 000312   000000 622006                    EAX2    0,QL
         5 000313   000000 471400 xsym               LDP1    P$
         5 000314   100026 742111                    STX2    22,X1,PR1

      219     5697    1           B$P.SA(SLOT) = B$HEAD.START;

   5697  5 000315   000000 236100                    LDQ     0,,PR0
         5 000316   000021 402007                    MPY     17,DL
         5 000317   000001 736000                    QLS     1
         5 000320   000000 471400 xsym               LDP1    HEAD$
         5 000321   100003 721100                    LXL1    3,,PR1
         5 000322   777777 361003                    ANX1    -1,DU
         5 000323   000000 473400 xsym               LDP3    P$
         5 000324   300026 441106                    SXL1    22,QL,PR3

      220     5698    1           CALL IPD$MON_HSTORE(MM_PWSQPGS(PWSQ-%CPWSQ),NXTWSQPG + PGTBLNEEDED);

   5698  5 000325   200012 236100                    LDQ     NXTWSQPG,,AUTO
         5 000326   200007 036100                    ADLQ    PGTBLNEEDED,,AUTO
         5 000327   200032 756100                    STQ     TMP+4,,AUTO
         5 000330   200032 631500                    EPPR1   TMP+4,,AUTO
         5 000331   200035 451500                    STP1    TMP+7,,AUTO
         5 000332   200011 236100                    LDQ     PWSQ,,AUTO
         5 000333   000021 736000                    QLS     17
         5 000334   000000 036000 6                  ADLQ    0
         5 000335   200034 756100                    STQ     TMP+6,,AUTO
         5 000336   200034 630500                    EPPR0   TMP+6,,AUTO
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:35   
         5 000337   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000340   000000 701000 xent               TSX1    IPD$MON_HSTORE
         5 000341   000000 011000                    NOP     0

      221     5699        /* Read in any initialized data segments & fill in B$P entries */
      222     5700    1           PROC$ = ADDR(B$P.DSDATA(SLOT));

   5700  5 000342   200004 470500                    LDP0    @SLOT,,AUTO
         5 000343   000000 236100                    LDQ     0,,PR0
         5 000344   000021 402007                    MPY     17,DL
         5 000345   000023 736000                    QLS     19
         5 000346   000011 036003                    ADLQ    9,DU
         5 000347   000000 036000 xsym               ADLQ    P$
         5 000350   200022 756100                    STQ     PROC$,,AUTO

      223     5701    1           PROC$->B$PROCDS = '0'B;

   5701  5 000351   200022 471500                    LDP1    PROC$,,AUTO
         5 000352   000100 100400                    MLR     fill='000'O
         5 000353   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         5 000354   100000 000036                    ADSC9   0,,PR1                   cn=0,n=30

      224     5702    1           SEGID = BITBIN(%DS3SID);        /* DS3 is 1st init-able one           */

   5702  5 000355   006006 235007                    LDA     3078,DL
         5 000356   200024 755100                    STA     SEGID,,AUTO

      225     5703    1           BIAS = 0;

   5703  5 000357   200014 450100                    STZ     BIAS,,AUTO

      226     5704    2           DO I = 0 TO 5;

   5704  5 000360   200023 450100                    STZ     I,,AUTO

      227     5705    2             IF B$HEAD.DATA_SEG.SIZ(I) > 0 THEN

PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:36   
   5705  5 000361   000000 470400 xsym               LDP0    HEAD$
         5 000362   200023 720100                    LXL0    I,,AUTO
         5 000363   000012 221110                    LDX1    10,X0,PR0
         5 000364   000446 600000 5                  TZE     s:5714

      228     5706    3                 DO;

      229     5707    3                   TOTSZ = B$HEAD.DATA_SEG.SIZ(I);

   5707  5 000365   000012 236110                    LDQ     10,X0,PR0
         5 000366   000022 772000                    QRL     18
         5 000367   200015 756100                    STQ     TOTSZ,,AUTO

      230     5708    3                   CALL IPB$READ(PFLGS,%TYPDATASEG,BIAS,TOTSZ,PGSZ,SEGID,

   5708  5 000370   200004 236100                    LDQ     @SLOT,,AUTO
         5 000371   200005 235100                    LDA     @ERR,,AUTO
         5 000372   200046 757100                    STAQ    TMP+16,,AUTO
         5 000373   000004 236000 6                  LDQ     4
         5 000374   000001 235000 xsym               LDA     B_VECTNIL+1
         5 000375   200044 757100                    STAQ    TMP+14,,AUTO
         5 000376   000001 236000 xsym               LDQ     B_VECTNIL+1
         5 000377   200043 756100                    STQ     TMP+13,,AUTO
         5 000400   200021 631500                    EPPR1   COUNT,,AUTO
         5 000401   200042 451500                    STP1    TMP+12,,AUTO
         5 000402   200020 633500                    EPPR3   TAIL,,AUTO
         5 000403   200041 453500                    STP3    TMP+11,,AUTO
         5 000404   200017 634500                    EPPR4   HEAD,,AUTO
         5 000405   200040 454500                    STP4    TMP+10,,AUTO
         5 000406   200024 635500                    EPPR5   SEGID,,AUTO
         5 000407   200037 455500                    STP5    TMP+9,,AUTO
         5 000410   200016 636500                    EPPR6   PGSZ,,AUTO
         5 000411   200036 456500                    STP6    TMP+8,,AUTO
         5 000412   200015 637500                    EPPR7   TOTSZ,,AUTO
         5 000413   200035 457500                    STP7    TMP+7,,AUTO
         5 000414   200014 630500                    EPPR0   BIAS,,AUTO
         5 000415   200034 450500                    STP0    TMP+6,,AUTO
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:37   
         5 000416   000011 236000 6                  LDQ     9
         5 000417   200033 756100                    STQ     TMP+5,,AUTO
         5 000420   200013 630500                    EPPR0   PFLGS,,AUTO
         5 000421   200032 450500                    STP0    TMP+4,,AUTO
         5 000422   200032 630500                    EPPR0   TMP+4,,AUTO
         5 000423   000003 631400 6                  EPPR1   3
         5 000424   000000 701000 xent               TSX1    IPB$READ
         5 000425   001263 702000 5                  TSX2    GOT_ERR

      231     5709    3                     HEAD,TAIL,COUNT,,,BUF$,ERR,SLOT) ALTRET(GOT_ERR);
      232     5710    3                   PROC$->B$PROCDS.DSPH(I) = HEAD;

   5710  5 000426   200023 235100                    LDA     I,,AUTO
         5 000427   000001 735000                    ALS     1
         5 000430   200022 470500                    LDP0    PROC$,,AUTO
         5 000431   000105 101500                    MRL     fill='000'O
         5 000432   200017 000004                    ADSC9   HEAD,,AUTO               cn=0,n=4
         5 000433   000000 000002                    ADSC9   0,A,PR0                  cn=0,n=2

      233     5711    3                   PROC$->B$PROCDS.DSSIZE(I) = TOTSZ;

   5711  5 000434   000105 101500                    MRL     fill='000'O
         5 000435   200015 000004                    ADSC9   TOTSZ,,AUTO              cn=0,n=4
         5 000436   000003 000002                    ADSC9   3,A,PR0                  cn=0,n=2

      234     5712    3                   PROC$->B$PROCDS.DSPROT(I) = B$HEAD.DATA_SEG.PROTECTION(I);

   5712  5 000437   200023 236100                    LDQ     I,,AUTO
         5 000440   000002 736000                    QLS     2
         5 000441   000000 471400 xsym               LDP1    HEAD$
         5 000442   200023 235100                    LDA     I,,AUTO
         5 000443   000105 100506                    MLR     fill='000'O
         5 000444   100012 600001                    ADSC9   10,Q,PR1                 cn=3,n=1
         5 000445   000006 000001                    ADSC9   6,A,PR0                  cn=0,n=1

      235     5713    3                 END;

PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:38   
      236     5714    2             SEGID = SEGID + 1;

   5714  5 000446   200024 235100                    LDA     SEGID,,AUTO
         5 000447   000001 035007                    ADLA    1,DL
         5 000450   200024 755100                    STA     SEGID,,AUTO

      237     5715    2           END;

   5715  5 000451   200023 054100                    AOS     I,,AUTO
         5 000452   200023 236100                    LDQ     I,,AUTO
         5 000453   000005 116007                    CMPQ    5,DL
         5 000454   000361 604400 5                  TMOZ    s:5705

      238     5716
      239     5717
      240     5718        /* If there is a library map that in now */
      241     5719    1           IF LIBNUM ~= 0

   5719  5 000455   200010 235100                    LDA     LIBNUM,,AUTO
         5 000456   000560 600000 5                  TZE     s:5739

      242     5720    2             THEN DO;

      243     5721    2                 HEAD = B$P.HPP(LIBNUM);

   5721  5 000457   200010 236100                    LDQ     LIBNUM,,AUTO
         5 000460   000042 402007                    MPY     34,DL
         5 000461   000000 470400 xsym               LDP0    P$
         5 000462   000002 235106                    LDA     2,QL,PR0
         5 000463   200017 755100                    STA     HEAD,,AUTO

      244     5722    2                 TAIL = B$P.PVA(LIBNUM) + B$P.PPC(LIBNUM) - 1 - %ISEGLO;

   5722  5 000464   000000 620006                    EAX0    0,QL
         5 000465   000025 236110                    LDQ     21,X0,PR0
         5 000466   000022 772000                    QRL     18
         5 000467   000003 036110                    ADLQ    3,X0,PR0
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:39   
         5 000470   000101 136007                    SBLQ    65,DL
         5 000471   200020 756100                    STQ     TAIL,,AUTO

      245     5723    3                 DO I = B$P.PVA(LIBNUM)-%ISEGLO TO TAIL;

   5723  5 000472   000025 236110                    LDQ     21,X0,PR0
         5 000473   000022 772000                    QRL     18
         5 000474   000100 136007                    SBLQ    64,DL
         5 000475   200023 756100                    STQ     I,,AUTO
         5 000476   000542 710000 5                  TRA     s:5732+1

      246     5724    4                   IF IP_WSQ0PT THEN DO;

   5724  5 000477   000000 234000 xsym               SZN     IP_WSQ0PT
         5 000500   000517 605000 5                  TPL     s:5729

      247     5725    4                         CALL IPD$REAL_TO_PHYS(HEAD,TMP);

   5725  5 000501   200026 630500                    EPPR0   TMP,,AUTO
         5 000502   200033 450500                    STP0    TMP+5,,AUTO
         5 000503   200017 631500                    EPPR1   HEAD,,AUTO
         5 000504   200032 451500                    STP1    TMP+4,,AUTO
         5 000505   200032 630500                    EPPR0   TMP+4,,AUTO
         5 000506   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000507   000000 701000 xent               TSX1    IPD$REAL_TO_PHYS
         5 000510   000000 011000                    NOP     0

      248     5726    4                         B$PT.RPN(I+NXTWSQPG)=TMP;

   5726  5 000511   200023 236100                    LDQ     I,,AUTO
         5 000512   200012 036100                    ADLQ    NXTWSQPG,,AUTO
         5 000513   200026 720100                    LXL0    TMP,,AUTO
         5 000514   000000 470400 xsym               LDP0    PGTBL$
         5 000515   000000 740106                    STX0    0,QL,PR0

      249     5727    4                       END;

PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:40   
   5727  5 000516   000524 710000 5                  TRA     s:5730

      250     5728    3                     ELSE
      251     5729    3                     B$PT.RPN(I+NXTWSQPG) = HEAD;

   5729  5 000517   200023 236100                    LDQ     I,,AUTO
         5 000520   200012 036100                    ADLQ    NXTWSQPG,,AUTO
         5 000521   200017 720100                    LXL0    HEAD,,AUTO
         5 000522   000000 470400 xsym               LDP0    PGTBL$
         5 000523   000000 740106                    STX0    0,QL,PR0

      252     5730    3                   B$PT.CTRL(I+NXTWSQPG) = %PGINMEM | %PGIOM;

   5730  5 000524   200023 236100                    LDQ     I,,AUTO
         5 000525   200012 036100                    ADLQ    NXTWSQPG,,AUTO
         5 000526   000000 470400 xsym               LDP0    PGTBL$
         5 000527   000000 620006                    EAX0    0,QL
         5 000530   000000 236106                    LDQ     0,QL,PR0
         5 000531   000012 376000 6                  ANQ     10
         5 000532   000044 276007                    ORQ     36,DL
         5 000533   000000 756110                    STQ     0,X0,PR0

      253     5731    3                   HEAD = MM$PPUT.PPNO(HEAD);

   5731  5 000534   000000 470400 xsym               LDP0    PPUT$
         5 000535   200017 720100                    LXL0    HEAD,,AUTO
         5 000536   000000 236110                    LDQ     0,X0,PR0
         5 000537   777777 376007                    ANQ     -1,DL
         5 000540   200017 756100                    STQ     HEAD,,AUTO

      254     5732    3                 END;

   5732  5 000541   200023 054100                    AOS     I,,AUTO
         5 000542   200023 236100                    LDQ     I,,AUTO
         5 000543   200020 116100                    CMPQ    TAIL,,AUTO
         5 000544   000477 604400 5                  TMOZ    s:5724

PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:41   
      255     5733    2                 B$P.UC(LIBNUM) = B$P.UC(LIBNUM) + 1;

   5733  5 000545   200010 236100                    LDQ     LIBNUM,,AUTO
         5 000546   000042 402007                    MPY     34,DL
         5 000547   000000 470400 xsym               LDP0    P$
         5 000550   000000 054106                    AOS     0,QL,PR0

      256     5734    2                 B$P.LIB_LNK(SLOT) = LIBNUM;

   5734  5 000551   200004 470500                    LDP0    @SLOT,,AUTO
         5 000552   000000 236100                    LDQ     0,,PR0
         5 000553   000021 402007                    MPY     17,DL
         5 000554   000001 736000                    QLS     1
         5 000555   200010 720100                    LXL0    LIBNUM,,AUTO
         5 000556   000000 471400 xsym               LDP1    P$
         5 000557   100022 740106                    STX0    18,QL,PR1

      257     5735    2               END;

      258     5736
      259     5737
      260     5738        /* Finally, make this processor visible to the world... */
      261     5739    1           B$P.NAME.COUNT(SLOT) = PCNTRL.PNAME$->B$TEXTC.COUNT;

   5739  5 000560   200004 470500                    LDP0    @SLOT,,AUTO
         5 000561   000000 236100                    LDQ     0,,PR0
         5 000562   000021 402007                    MPY     17,DL
         5 000563   000001 736000                    QLS     1
         5 000564   200003 471500                    LDP1    @PCNTRL,,AUTO
         5 000565   100001 473500                    LDP3    1,,PR1
         5 000566   000000 474400 xsym               LDP4    P$
         5 000567   000000 620006                    EAX0    0,QL
         5 000570   300000 236100                    LDQ     0,,PR3
         5 000571   400032 676110                    ERQ     26,X0,PR4
         5 000572   777000 376003                    ANQ     -512,DU
         5 000573   400032 656110                    ERSQ    26,X0,PR4

PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:42   
      262     5740    1           B$P.NAME.TEXT(SLOT) = PCNTRL.PNAME$->B$TEXTC.TEXT;

   5740  5 000574   000000 236100                    LDQ     0,,PR0
         5 000575   000021 402007                    MPY     17,DL
         5 000576   100001 473500                    LDP3    1,,PR1
         5 000577   200032 756100                    STQ     TMP+4,,AUTO
         5 000600   300000 236100                    LDQ     0,,PR3
         5 000601   000033 772000                    QRL     27
         5 000602   200032 235100                    LDA     TMP+4,,AUTO
         5 000603   000003 735000                    ALS     3
         5 000604   000000 620006                    EAX0    0,QL
         5 000605   000000 474400 xsym               LDP4    P$
         5 000606   040105 100540                    MLR     fill='040'O
         5 000607   300000 200010                    ADSC9   0,,PR3                   cn=1,n=*X0
         5 000610   400032 200037                    ADSC9   26,A,PR4                 cn=1,n=31

      263     5741    1           B$P.ACCT(SLOT) = ':SYS';

   5741  5 000611   000000 236100                    LDQ     0,,PR0
         5 000612   000021 402007                    MPY     17,DL
         5 000613   000001 736000                    QLS     1
         5 000614   000000 235000 4                  LDA     0
         5 000615   000000 620006                    EAX0    0,QL
         5 000616   000035 236000 xsym               LDQ     B_VECTNIL+29
         5 000617   000000 473400 xsym               LDP3    P$
         5 000620   300030 757110                    STAQ    24,X0,PR3

      264     5742        /**/
      265     5743    1           RETURN;

   5743  5 000621   000000 702200 xent               TSX2  ! X66_ARET

      266     5744        /**/
      267     5745        %EJECT;
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:43   
      268     5746    1   IPC$DEL_SPCL: ENTRY(PCNTRL,SLOT,ERR) ALTRET;

   5746  5 000622   000000 700200 xent  IPC$DEL_SPCL TSX0  ! X66_AUTO_3
         5 000623   000050 000003                    ZERO    40,3

      269     5747        /* Get processor's home WSQ */
      270     5748    1           IF PCNTRL.PTYPE = I_CP

   5748  5 000624   200003 470500                    LDP0    @PCNTRL,,AUTO
         5 000625   000003 220100                    LDX0    3,,PR0
         5 000626   000024 100003                    CMPX0   20,DU
         5 000627   000633 601000 5                  TNZ     s:5750

      271     5749    1             THEN PWSQ = %CPWSQ;

   5749  5 000630   000004 235007                    LDA     4,DL
         5 000631   200011 755100                    STA     PWSQ,,AUTO
         5 000632   000645 710000 5                  TRA     s:5755

      272     5750    1             ELSE IF PCNTRL.PTYPE = I_DB

   5750  5 000633   000025 100003                    CMPX0   21,DU
         5 000634   000640 601000 5                  TNZ     s:5752

      273     5751    1               THEN PWSQ = %DBWSQ;

   5751  5 000635   000005 235007                    LDA     5,DL
         5 000636   200011 755100                    STA     PWSQ,,AUTO
         5 000637   000645 710000 5                  TRA     s:5755

      274     5752    1               ELSE IF PCNTRL.PTYPE = I_LIB

   5752  5 000640   000027 100003                    CMPX0   23,DU
         5 000641   000643 601000 5                  TNZ     s:5754

      275     5753    1                 THEN RETURN;

PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:44   
   5753  5 000642   000000 702200 xent               TSX2  ! X66_ARET

      276     5754    1                 ELSE PWSQ = %ASLWSQ;

   5754  5 000643   000006 235007                    LDA     6,DL
         5 000644   200011 755100                    STA     PWSQ,,AUTO

      277     5755    2           IF B$P.LIB_LNK(SLOT) ~= 0 THEN DO;

   5755  5 000645   200004 471500                    LDP1    @SLOT,,AUTO
         5 000646   100000 236100                    LDQ     0,,PR1
         5 000647   000021 402007                    MPY     17,DL
         5 000650   000001 736000                    QLS     1
         5 000651   000000 473400 xsym               LDP3    P$
         5 000652   300022 221106                    LDX1    18,QL,PR3
         5 000653   000704 600000 5                  TZE     s:5759

      278     5756    2                 B$P.UC(B$P.LIB_LNK(SLOT)) = B$P.UC(B$P.LIB_LNK(SLOT)) -1;

   5756  5 000654   100000 236100                    LDQ     0,,PR1
         5 000655   000021 402007                    MPY     17,DL
         5 000656   000001 736000                    QLS     1
         5 000657   300022 236106                    LDQ     18,QL,PR3
         5 000660   000022 772000                    QRL     18
         5 000661   000021 402007                    MPY     17,DL
         5 000662   000001 736000                    QLS     1
         5 000663   000000 621006                    EAX1    0,QL
         5 000664   100000 236100                    LDQ     0,,PR1
         5 000665   000021 402007                    MPY     17,DL
         5 000666   000001 736000                    QLS     1
         5 000667   300022 236106                    LDQ     18,QL,PR3
         5 000670   000022 772000                    QRL     18
         5 000671   000021 402007                    MPY     17,DL
         5 000672   000001 736000                    QLS     1
         5 000673   300000 235106                    LDA     0,QL,PR3
         5 000674   000001 135007                    SBLA    1,DL
         5 000675   300000 755111                    STA     0,X1,PR3
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:45   

      279     5757    2                 B$P.LIB_LNK(SLOT) = 0;

   5757  5 000676   100000 236100                    LDQ     0,,PR1
         5 000677   000021 402007                    MPY     17,DL
         5 000700   000001 736000                    QLS     1
         5 000701   000000 220003                    LDX0    0,DU
         5 000702   000000 473400 xsym               LDP3    P$
         5 000703   300022 740106                    STX0    18,QL,PR3

      280     5758    2               END;

      281     5759    1           CALL IPD$MON_HVAL(MM_PWSQPGS(PWSQ-%CPWSQ),NXTWSQPG);

   5759  5 000704   200012 633500                    EPPR3   NXTWSQPG,,AUTO
         5 000705   200033 453500                    STP3    TMP+5,,AUTO
         5 000706   200011 236100                    LDQ     PWSQ,,AUTO
         5 000707   000021 736000                    QLS     17
         5 000710   000000 036000 6                  ADLQ    0
         5 000711   200032 756100                    STQ     TMP+4,,AUTO
         5 000712   200032 630500                    EPPR0   TMP+4,,AUTO
         5 000713   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000714   000000 701000 xent               TSX1    IPD$MON_HVAL
         5 000715   000000 011000                    NOP     0

      282     5760    1           IF NXTWSQPG = B$P.HVA (SLOT)

   5760  5 000716   200004 470500                    LDP0    @SLOT,,AUTO
         5 000717   000000 236100                    LDQ     0,,PR0
         5 000720   000021 402007                    MPY     17,DL
         5 000721   000001 736000                    QLS     1
         5 000722   000000 471400 xsym               LDP1    P$
         5 000723   100026 236106                    LDQ     22,QL,PR1
         5 000724   000022 772000                    QRL     18
         5 000725   200012 116100                    CMPQ    NXTWSQPG,,AUTO
         5 000726   000735 601000 5                  TNZ     s:5763

PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:46   
      283     5761    1             THEN
      284     5762    1             NXTWSQPG = B$P.PVA (SLOT);

   5762  5 000727   000000 236100                    LDQ     0,,PR0
         5 000730   000021 402007                    MPY     17,DL
         5 000731   000001 736000                    QLS     1
         5 000732   100025 236106                    LDQ     21,QL,PR1
         5 000733   000022 772000                    QRL     18
         5 000734   200012 756100                    STQ     NXTWSQPG,,AUTO

      285     5763    1           CALL IPD$MON_HSTORE(MM_PWSQPGS(PWSQ-%CPWSQ),NXTWSQPG);

   5763  5 000735   200012 633500                    EPPR3   NXTWSQPG,,AUTO
         5 000736   200033 453500                    STP3    TMP+5,,AUTO
         5 000737   200011 236100                    LDQ     PWSQ,,AUTO
         5 000740   000021 736000                    QLS     17
         5 000741   000000 036000 6                  ADLQ    0
         5 000742   200032 756100                    STQ     TMP+4,,AUTO
         5 000743   200032 630500                    EPPR0   TMP+4,,AUTO
         5 000744   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000745   000000 701000 xent               TSX1    IPD$MON_HSTORE
         5 000746   000000 011000                    NOP     0

      286     5764    1           RETURN;

   5764  5 000747   000000 702200 xent               TSX2  ! X66_ARET

      287     5765        %EJECT;
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:47   
      288     5766        /**/
      289     5767        /*F*    NAME:   IPC$ADD_LIB
      290     5768                PURPOSE: To install a shared library in the processor tables. */
      291     5769    1   IPC$ADD_LIB: ENTRY(PCNTRL,SLOT,ERR) ALTRET;

   5769  5 000750   000000 700200 xent  IPC$ADD_LIB  TSX0  ! X66_AUTO_3
         5 000751   000050 000003                    ZERO    40,3

      292     5770        /* Setup call to IPB$READ to bring in the processor's procedure */
      293     5771    1           PFLGS = PCNTRL.PFLGS;

   5771  5 000752   200003 470500                    LDP0    @PCNTRL,,AUTO
         5 000753   000007 236100                    LDQ     7,,PR0
         5 000754   200013 756100                    STQ     PFLGS,,AUTO

      294     5772    1           BIAS = (B$HEAD.BIAS/1024 + B$HEAD.VDPGS)*1024;

   5772  5 000755   000000 471400 xsym               LDP1    HEAD$
         5 000756   100023 236100                    LDQ     19,,PR1
         5 000757   000002 376000 6                  ANQ     2
         5 000760   000012 772000                    QRL     10
         5 000761   200032 756100                    STQ     TMP+4,,AUTO
         5 000762   100002 236100                    LDQ     2,,PR1
         5 000763   000026 772000                    QRL     22
         5 000764   200033 756100                    STQ     TMP+5,,AUTO
         5 000765   200032 236100                    LDQ     TMP+4,,AUTO
         5 000766   200033 036100                    ADLQ    TMP+5,,AUTO
         5 000767   000012 736000                    QLS     10
         5 000770   200014 756100                    STQ     BIAS,,AUTO

      295     5773    1           TOTSZ = B$HEAD.RPROC;

   5773  5 000771   100001 236100                    LDQ     1,,PR1
         5 000772   000002 376000 6                  ANQ     2
         5 000773   200015 756100                    STQ     TOTSZ,,AUTO

      296     5774    1           PGSZ = B$HEAD.PRECSIZE;
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:48   

   5774  5 000774   100006 236100                    LDQ     6,,PR1
         5 000775   000022 772000                    QRL     18
         5 000776   200016 756100                    STQ     PGSZ,,AUTO

      297     5775    1           CALL IPB$READ(PFLGS,%TYPPROG,BIAS,TOTSZ,PGSZ,0,HEAD,TAIL,COUNT,

   5775  5 000777   200004 236100                    LDQ     @SLOT,,AUTO
         5 001000   200005 235100                    LDA     @ERR,,AUTO
         5 001001   200046 757100                    STAQ    TMP+16,,AUTO
         5 001002   000004 236000 6                  LDQ     4
         5 001003   000001 235000 xsym               LDA     B_VECTNIL+1
         5 001004   200044 757100                    STAQ    TMP+14,,AUTO
         5 001005   000001 236000 xsym               LDQ     B_VECTNIL+1
         5 001006   200043 756100                    STQ     TMP+13,,AUTO
         5 001007   200021 633500                    EPPR3   COUNT,,AUTO
         5 001010   200042 453500                    STP3    TMP+12,,AUTO
         5 001011   200020 634500                    EPPR4   TAIL,,AUTO
         5 001012   200041 454500                    STP4    TMP+11,,AUTO
         5 001013   200017 635500                    EPPR5   HEAD,,AUTO
         5 001014   200040 455500                    STP5    TMP+10,,AUTO
         5 001015   000006 236000 6                  LDQ     6
         5 001016   200037 756100                    STQ     TMP+9,,AUTO
         5 001017   200016 636500                    EPPR6   PGSZ,,AUTO
         5 001020   200036 456500                    STP6    TMP+8,,AUTO
         5 001021   200015 637500                    EPPR7   TOTSZ,,AUTO
         5 001022   200035 457500                    STP7    TMP+7,,AUTO
         5 001023   200014 630500                    EPPR0   BIAS,,AUTO
         5 001024   200034 450500                    STP0    TMP+6,,AUTO
         5 001025   000007 236000 6                  LDQ     7
         5 001026   200033 756100                    STQ     TMP+5,,AUTO
         5 001027   200013 630500                    EPPR0   PFLGS,,AUTO
         5 001030   200032 450500                    STP0    TMP+4,,AUTO
         5 001031   200032 630500                    EPPR0   TMP+4,,AUTO
         5 001032   000003 631400 6                  EPPR1   3
         5 001033   000000 701000 xent               TSX1    IPB$READ
         5 001034   001263 702000 5                  TSX2    GOT_ERR
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:49   

      298     5776    1             ,,BUF$,ERR,SLOT) ALTRET(GOT_ERR);
      299     5777        /* Set up the processor table data for this processor */
      300     5778    1           CALL COMMON_SETUP;              /* Fill in common values              */

   5778  5 001035   001327 701000 5                  TSX1    COMMON_SETUP
         5 001036   000000 011000                    NOP     0

      301     5779    1           B$P.DADDR(SLOT) = B$HEAD.BIAS;

   5779  5 001037   200004 470500                    LDP0    @SLOT,,AUTO
         5 001040   000000 236100                    LDQ     0,,PR0
         5 001041   000021 402007                    MPY     17,DL
         5 001042   000001 736000                    QLS     1
         5 001043   000000 471400 xsym               LDP1    HEAD$
         5 001044   100023 720100                    LXL0    19,,PR1
         5 001045   777777 360003                    ANX0    -1,DU
         5 001046   000000 473400 xsym               LDP3    P$
         5 001047   300024 740106                    STX0    20,QL,PR3

      302     5780    1           B$P.DSZ(SLOT) = B$HEAD.RDATA;

   5780  5 001050   000000 236100                    LDQ     0,,PR0
         5 001051   000021 402007                    MPY     17,DL
         5 001052   000001 736000                    QLS     1
         5 001053   000000 471400 xsym               LDP1    HEAD$
         5 001054   100002 720100                    LXL0    2,,PR1
         5 001055   777777 360003                    ANX0    -1,DU
         5 001056   000000 473400 xsym               LDP3    P$
         5 001057   300024 440106                    SXL0    20,QL,PR3

      303     5781    1           B$P.PVA(SLOT) = %ISEGLO + BIAS/1024;

   5781  5 001060   000000 236100                    LDQ     0,,PR0
         5 001061   000021 402007                    MPY     17,DL
         5 001062   000001 736000                    QLS     1
         5 001063   000000 620006                    EAX0    0,QL
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:50   
         5 001064   200014 236100                    LDQ     BIAS,,AUTO
         5 001065   002000 506007                    DIV     1024,DL
         5 001066   000100 621006                    EAX1    64,QL
         5 001067   000000 471400 xsym               LDP1    P$
         5 001070   100025 741110                    STX1    21,X0,PR1

      304     5782    1           B$P.DVA(SLOT) = %ISEGLO + B$HEAD.BIAS/1024;

   5782  5 001071   000000 236100                    LDQ     0,,PR0
         5 001072   000021 402007                    MPY     17,DL
         5 001073   000001 736000                    QLS     1
         5 001074   000000 471400 xsym               LDP1    HEAD$
         5 001075   000000 620006                    EAX0    0,QL
         5 001076   100023 236100                    LDQ     19,,PR1
         5 001077   000002 376000 6                  ANQ     2
         5 001100   000012 772000                    QRL     10
         5 001101   000100 621006                    EAX1    64,QL
         5 001102   000000 473400 xsym               LDP3    P$
         5 001103   300025 441110                    SXL1    21,X0,PR3

      305     5783    1           B$P.HVA(SLOT) = %ISEGLO + BIAS/1024 + COUNT;

   5783  5 001104   000000 236100                    LDQ     0,,PR0
         5 001105   000021 402007                    MPY     17,DL
         5 001106   000001 736000                    QLS     1
         5 001107   000000 620006                    EAX0    0,QL
         5 001110   200014 236100                    LDQ     BIAS,,AUTO
         5 001111   002000 506007                    DIV     1024,DL
         5 001112   200021 036100                    ADLQ    COUNT,,AUTO
         5 001113   000100 621006                    EAX1    64,QL
         5 001114   000000 471400 xsym               LDP1    P$
         5 001115   100026 741110                    STX1    22,X0,PR1

      306     5784    1           B$P.SA(SLOT) = 0;

   5784  5 001116   000000 236100                    LDQ     0,,PR0
         5 001117   000021 402007                    MPY     17,DL
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:51   
         5 001120   000001 736000                    QLS     1
         5 001121   000000 220003                    LDX0    0,DU
         5 001122   000000 471400 xsym               LDP1    P$
         5 001123   100026 440106                    SXL0    22,QL,PR1

      307     5785    1           B$P.TCBSZ(SLOT) = 0;

   5785  5 001124   000000 236100                    LDQ     0,,PR0
         5 001125   000021 402007                    MPY     17,DL
         5 001126   000001 736000                    QLS     1
         5 001127   000000 471400 xsym               LDP1    P$
         5 001130   100027 440106                    SXL0    23,QL,PR1

      308     5786        /* READ LIBRARY DATA INTO MEMORY FOR RUN TIME INITIALIZATION */
      309     5787
      310     5788    1           PROC$ = ADDR(B$P.DSDATA(SLOT));

   5788  5 001131   000000 236100                    LDQ     0,,PR0
         5 001132   000021 402007                    MPY     17,DL
         5 001133   000023 736000                    QLS     19
         5 001134   000011 036003                    ADLQ    9,DU
         5 001135   000000 036000 xsym               ADLQ    P$
         5 001136   200022 756100                    STQ     PROC$,,AUTO

      311     5789    1           PROC$->B$PROCDS = '0'B;

   5789  5 001137   200022 471500                    LDP1    PROC$,,AUTO
         5 001140   000100 100400                    MLR     fill='000'O
         5 001141   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         5 001142   100000 000036                    ADSC9   0,,PR1                   cn=0,n=30

      312     5790    1           BIAS= B$HEAD.BIAS;

   5790  5 001143   000000 473400 xsym               LDP3    HEAD$
         5 001144   300023 236100                    LDQ     19,,PR3
         5 001145   000002 376000 6                  ANQ     2
         5 001146   200014 756100                    STQ     BIAS,,AUTO
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:52   

      313     5791    1           TOTSZ = B$HEAD.RDATA;

   5791  5 001147   300002 236100                    LDQ     2,,PR3
         5 001150   000002 376000 6                  ANQ     2
         5 001151   200015 756100                    STQ     TOTSZ,,AUTO

      314     5792    1           CALL IPB$READ(PFLGS,%TYPPROG,BIAS,TOTSZ,PGSZ,0,HEAD,TAIL,COUNT,

   5792  5 001152   200004 236100                    LDQ     @SLOT,,AUTO
         5 001153   200005 235100                    LDA     @ERR,,AUTO
         5 001154   200046 757100                    STAQ    TMP+16,,AUTO
         5 001155   000004 236000 6                  LDQ     4
         5 001156   000001 235000 xsym               LDA     B_VECTNIL+1
         5 001157   200044 757100                    STAQ    TMP+14,,AUTO
         5 001160   000001 236000 xsym               LDQ     B_VECTNIL+1
         5 001161   200043 756100                    STQ     TMP+13,,AUTO
         5 001162   200021 634500                    EPPR4   COUNT,,AUTO
         5 001163   200042 454500                    STP4    TMP+12,,AUTO
         5 001164   200020 635500                    EPPR5   TAIL,,AUTO
         5 001165   200041 455500                    STP5    TMP+11,,AUTO
         5 001166   200017 636500                    EPPR6   HEAD,,AUTO
         5 001167   200040 456500                    STP6    TMP+10,,AUTO
         5 001170   000006 236000 6                  LDQ     6
         5 001171   200037 756100                    STQ     TMP+9,,AUTO
         5 001172   200016 637500                    EPPR7   PGSZ,,AUTO
         5 001173   200036 457500                    STP7    TMP+8,,AUTO
         5 001174   200015 630500                    EPPR0   TOTSZ,,AUTO
         5 001175   200035 450500                    STP0    TMP+7,,AUTO
         5 001176   200014 630500                    EPPR0   BIAS,,AUTO
         5 001177   200034 450500                    STP0    TMP+6,,AUTO
         5 001200   000007 236000 6                  LDQ     7
         5 001201   200033 756100                    STQ     TMP+5,,AUTO
         5 001202   200013 630500                    EPPR0   PFLGS,,AUTO
         5 001203   200032 450500                    STP0    TMP+4,,AUTO
         5 001204   200032 630500                    EPPR0   TMP+4,,AUTO
         5 001205   000003 631400 6                  EPPR1   3
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:53   
         5 001206   000000 701000 xent               TSX1    IPB$READ
         5 001207   001263 702000 5                  TSX2    GOT_ERR

      315     5793    1             ,,BUF$,ERR,SLOT) ALTRET(GOT_ERR);
      316     5794    1           PROC$->B$PROCDS.DSPH(0) = HEAD;

   5794  5 001210   200017 720100                    LXL0    HEAD,,AUTO
         5 001211   200022 470500                    LDP0    PROC$,,AUTO
         5 001212   000000 740100                    STX0    0,,PR0

      317     5795    1           PROC$->B$PROCDS.DSSIZE(0) = TOTSZ;

   5795  5 001213   200015 721100                    LXL1    TOTSZ,,AUTO
         5 001214   000003 741100                    STX1    3,,PR0

      318     5796        /* Finally, make this processor visible to the world... */
      319     5797    1           B$P.NAME.COUNT(SLOT) = PCNTRL.PNAME$->B$TEXTC.COUNT;

   5797  5 001215   200004 471500                    LDP1    @SLOT,,AUTO
         5 001216   100000 236100                    LDQ     0,,PR1
         5 001217   000021 402007                    MPY     17,DL
         5 001220   000001 736000                    QLS     1
         5 001221   200003 473500                    LDP3    @PCNTRL,,AUTO
         5 001222   300001 474500                    LDP4    1,,PR3
         5 001223   000000 475400 xsym               LDP5    P$
         5 001224   000000 622006                    EAX2    0,QL
         5 001225   400000 236100                    LDQ     0,,PR4
         5 001226   500032 676112                    ERQ     26,X2,PR5
         5 001227   777000 376003                    ANQ     -512,DU
         5 001230   500032 656112                    ERSQ    26,X2,PR5

      320     5798    1           B$P.NAME.TEXT(SLOT) = PCNTRL.PNAME$->B$TEXTC.TEXT;

   5798  5 001231   100000 236100                    LDQ     0,,PR1
         5 001232   000021 402007                    MPY     17,DL
         5 001233   300001 474500                    LDP4    1,,PR3
         5 001234   200032 756100                    STQ     TMP+4,,AUTO
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:54   
         5 001235   400000 236100                    LDQ     0,,PR4
         5 001236   000033 772000                    QRL     27
         5 001237   200032 235100                    LDA     TMP+4,,AUTO
         5 001240   000003 735000                    ALS     3
         5 001241   000000 620006                    EAX0    0,QL
         5 001242   000000 475400 xsym               LDP5    P$
         5 001243   040105 100540                    MLR     fill='040'O
         5 001244   400000 200010                    ADSC9   0,,PR4                   cn=1,n=*X0
         5 001245   500032 200037                    ADSC9   26,A,PR5                 cn=1,n=31

      321     5799    1           B$P.ACCT(SLOT) = ':SYS';

   5799  5 001246   100000 236100                    LDQ     0,,PR1
         5 001247   000021 402007                    MPY     17,DL
         5 001250   000001 736000                    QLS     1
         5 001251   000000 235000 4                  LDA     0
         5 001252   000000 620006                    EAX0    0,QL
         5 001253   000035 236000 xsym               LDQ     B_VECTNIL+29
         5 001254   000000 474400 xsym               LDP4    P$
         5 001255   400030 757110                    STAQ    24,X0,PR4

      322     5800        /**/
      323     5801    1           RETURN;

   5801  5 001256   000000 702200 xent               TSX2  ! X66_ARET

      324     5802        /**/
      325     5803    1   SET_ERR:
      326     5804    1           ERR = B$JIT.ERR;

   5804  5 001257   000000 470400 xsym  SET_ERR      LDP0    B$JIT$
         5 001260   000012 236100                    LDQ     10,,PR0
         5 001261   200005 471500                    LDP1    @ERR,,AUTO
         5 001262   100000 756100                    STQ     0,,PR1

      327     5805    1   GOT_ERR:
      328     5806    1           CALL IPD$FREE_PROC(SLOT) ALTRET(DBL_ERR);
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:55   

   5806  5 001263   200004 630500       GOT_ERR      EPPR0   @SLOT,,AUTO
         5 001264   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 001265   000000 701000 xent               TSX1    IPD$FREE_PROC
         5 001266   001270 702000 5                  TSX2    DBL_ERR

      329     5807    1           ALTRETURN;

   5807  5 001267   000000 702200 xent               TSX2  ! X66_AALT

      330     5808    1   DBL_ERR:
      331     5809    1           ERRTEMP = B$JIT.ERR;            /* Remember secondary error           */

   5809  5 001270   000000 470400 xsym  DBL_ERR      LDP0    B$JIT$
         5 001271   000012 236100                    LDQ     10,,PR0
         5 001272   200025 756100                    STQ     ERRTEMP,,AUTO

      332     5810    1           FPT_ERRMSG.CODE_ = VECTOR(ERR);

   5810  5 001273   777640 235007                    LDA     -96,DL
         5 001274   200005 236100                    LDQ     @ERR,,AUTO
         5 001275   000012 757000 1                  STAQ    FPT_ERRMSG+2

      333     5811    1           IF B$JIT.USER = 1 THEN FPT_ERRMSG.V.OUTDCB1# = DCBNUM(NIL);

   5811  5 001276   000000 236100                    LDQ     0,,PR0
         5 001277   000777 376003                    ANQ     511,DU
         5 001300   000001 116003                    CMPQ    1,DU
         5 001301   001304 601000 5                  TNZ     s:5812

   5811  5 001302   000000 220003                    LDX0    0,DU
         5 001303   000036 440000 1                  SXL0    FPT_ERRMSG+22

      334     5812    1           CALL M$ERRMSG(FPT_ERRMSG) ALTRET(SOWHAT);

   5812  5 001304   000010 630400 1                  EPPR0   FPT_ERRMSG
         5 001305   420000 713400                    CLIMB   alt,+8192
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:56   
         5 001306   405000 401760                    pmme    nvectors=11
         5 001307   001323 702000 5                  TSX2    SOWHAT

      335     5813    1           IF B$JIT.USER = 1 THEN

   5813  5 001310   000000 470400 xsym               LDP0    B$JIT$
         5 001311   000000 236100                    LDQ     0,,PR0
         5 001312   000777 376003                    ANQ     511,DU
         5 001313   000001 116003                    CMPQ    1,DU
         5 001314   001323 601000 5                  TNZ     SOWHAT

      336     5814    2               DO;

      337     5815    2                 CALL M$TEMPWROC(WRITE_OC);

   5815  5 001315   000042 630400 1                  EPPR0   WRITE_OC
         5 001316   110000 713400                    CLIMB   36864
         5 001317   401000 401760                    pmme    nvectors=3

      338     5816    2                 CALL M$TEMPWROC(OC_CRLF);

   5816  5 001320   000052 630400 1                  EPPR0   OC_CRLF
         5 001321   110000 713400                    CLIMB   36864
         5 001322   401000 401760                    pmme    nvectors=3

      339     5817    2               END;

      340     5818    1   SOWHAT: ERR = ERRTEMP;

   5818  5 001323   200025 236100       SOWHAT       LDQ     ERRTEMP,,AUTO
         5 001324   200005 470500                    LDP0    @ERR,,AUTO
         5 001325   000000 756100                    STQ     0,,PR0

      341     5819    1           ALTRETURN;

   5819  5 001326   000000 702200 xent               TSX2  ! X66_AALT

PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:57   
      342     5820        /**/
      343     5821        %EJECT;
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:58   
      344     5822        /**/
      345     5823        /**********************************/
      346     5824        /*   Internal Procedures          */
      347     5825        /**********************************/
      348     5826        /**/
      349     5827        /* This routine initializes portions of the processor tables common */
      350     5828        /* to all types of shared processor.                                */
      351     5829    1   COMMON_SETUP: PROC;

   5829  5 001327   200030 741300       COMMON_SETUP STX1  ! TMP+2,,AUTO

      352     5830        /**/
      353     5831    2           B$P.UC(SLOT) = 0;

   5831  5 001330   200004 470500                    LDP0    @SLOT,,AUTO
         5 001331   000000 236100                    LDQ     0,,PR0
         5 001332   000021 402007                    MPY     17,DL
         5 001333   000001 736000                    QLS     1
         5 001334   000000 471400 xsym               LDP1    P$
         5 001335   100000 450106                    STZ     0,QL,PR1

      354     5832    2           B$P.LNK(SLOT) = 0;

   5832  5 001336   000000 236100                    LDQ     0,,PR0
         5 001337   000021 402007                    MPY     17,DL
         5 001340   000001 736000                    QLS     1
         5 001341   000000 220003                    LDX0    0,DU
         5 001342   000000 471400 xsym               LDP1    P$
         5 001343   100022 440106                    SXL0    18,QL,PR1

      355     5833    2           B$P.FRQ(SLOT) = 0;

   5833  5 001344   000000 236100                    LDQ     0,,PR0
         5 001345   000021 402007                    MPY     17,DL
         5 001346   000001 736000                    QLS     1
         5 001347   000000 471400 xsym               LDP1    P$
         5 001350   100001 450106                    STZ     1,QL,PR1
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:59   

      356     5834    2           B$P.HPP(SLOT) = HEAD;

   5834  5 001351   000000 236100                    LDQ     0,,PR0
         5 001352   000021 402007                    MPY     17,DL
         5 001353   000001 736000                    QLS     1
         5 001354   200017 235100                    LDA     HEAD,,AUTO
         5 001355   000000 471400 xsym               LDP1    P$
         5 001356   100002 755106                    STA     2,QL,PR1

      357     5835    2           B$P.TPP(SLOT) = TAIL;

   5835  5 001357   000000 236100                    LDQ     0,,PR0
         5 001360   000021 402007                    MPY     17,DL
         5 001361   000001 736000                    QLS     1
         5 001362   200020 721100                    LXL1    TAIL,,AUTO
         5 001363   000000 471400 xsym               LDP1    P$
         5 001364   100023 741106                    STX1    19,QL,PR1

      358     5836    2           B$P.PPC(SLOT) = COUNT;

   5836  5 001365   000000 236100                    LDQ     0,,PR0
         5 001366   000021 402007                    MPY     17,DL
         5 001367   000001 736000                    QLS     1
         5 001370   200021 235100                    LDA     COUNT,,AUTO
         5 001371   000000 471400 xsym               LDP1    P$
         5 001372   100003 755106                    STA     3,QL,PR1

      359     5837    2           B$P.CRDATE(SLOT) = PCNTRL.MODTIME;

   5837  5 001373   000000 236100                    LDQ     0,,PR0
         5 001374   000021 402007                    MPY     17,DL
         5 001375   000001 736000                    QLS     1
         5 001376   200003 471500                    LDP1    @PCNTRL,,AUTO
         5 001377   000000 473400 xsym               LDP3    P$
         5 001400   100005 235100                    LDA     5,,PR1
         5 001401   300004 755106                    STA     4,QL,PR3
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:60   

      360     5838    2           B$P.XEQTIME(SLOT) = 0;

   5838  5 001402   000000 236100                    LDQ     0,,PR0
         5 001403   000021 402007                    MPY     17,DL
         5 001404   000001 736000                    QLS     1
         5 001405   000000 473400 xsym               LDP3    P$
         5 001406   300006 450106                    STZ     6,QL,PR3

      361     5839    2           B$P.SRVTIME(SLOT) = 0;

   5839  5 001407   000000 236100                    LDQ     0,,PR0
         5 001410   000021 402007                    MPY     17,DL
         5 001411   000001 736000                    QLS     1
         5 001412   000000 473400 xsym               LDP3    P$
         5 001413   300007 450106                    STZ     7,QL,PR3

      362     5840    2           B$P.PRIV(SLOT) = B$HEAD.PRIV;

   5840  5 001414   000000 236100                    LDQ     0,,PR0
         5 001415   000021 402007                    MPY     17,DL
         5 001416   000001 736000                    QLS     1
         5 001417   000000 473400 xsym               LDP3    HEAD$
         5 001420   000000 621006                    EAX1    0,QL
         5 001421   300000 236100                    LDQ     0,,PR3
         5 001422   000000 474400 xsym               LDP4    P$
         5 001423   400010 756111                    STQ     8,X1,PR4

      363     5841    2           B$P.FLGS(SLOT) = PCNTRL.PFLGS;

   5841  5 001424   000000 236100                    LDQ     0,,PR0
         5 001425   000021 402007                    MPY     17,DL
         5 001426   000001 736000                    QLS     1
         5 001427   100007 221100                    LDX1    7,,PR1
         5 001430   000000 473400 xsym               LDP3    P$
         5 001431   300027 741106                    STX1    23,QL,PR3

PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:61   
      364     5842    2           B$P.LIB_LNK(SLOT) = 0;

   5842  5 001432   000000 236100                    LDQ     0,,PR0
         5 001433   000021 402007                    MPY     17,DL
         5 001434   000001 736000                    QLS     1
         5 001435   000000 473400 xsym               LDP3    P$
         5 001436   300022 740106                    STX0    18,QL,PR3

      365     5843    2           IF B$HEAD.TCBSIZE = 0

   5843  5 001437   000000 473400 xsym               LDP3    HEAD$
         5 001440   300005 721100                    LXL1    5,,PR3
         5 001441   001450 601000 5                  TNZ     s:5845

      366     5844    2             THEN B$P.TCBSZ(SLOT) = 0;

   5844  5 001442   000000 236100                    LDQ     0,,PR0
         5 001443   000021 402007                    MPY     17,DL
         5 001444   000001 736000                    QLS     1
         5 001445   000000 474400 xsym               LDP4    P$
         5 001446   400027 440106                    SXL0    23,QL,PR4
         5 001447   001462 710000 5                  TRA     s:5846

      367     5845    2             ELSE B$P.TCBSZ(SLOT) = B$HEAD.TCBSIZE * %UE_AV_TCBSZ# + %UE_FX_TCBSZ#;

   5845  5 001450   000000 236100                    LDQ     0,,PR0
         5 001451   000021 402007                    MPY     17,DL
         5 001452   000001 736000                    QLS     1
         5 001453   000000 622006                    EAX2    0,QL
         5 001454   300005 236100                    LDQ     5,,PR3
         5 001455   777777 376007                    ANQ     -1,DL
         5 001456   000112 402007                    MPY     74,DL
         5 001457   000110 623006                    EAX3    72,QL
         5 001460   000000 474400 xsym               LDP4    P$
         5 001461   400027 443112                    SXL3    23,X2,PR4

      368     5846    2           CALL M$TIME(FPT_TIME);
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:62   

   5846  5 001462   000062 630400 1                  EPPR0   FPT_TIME
         5 001463   020004 713400                    CLIMB   8196
         5 001464   402000 401760                    pmme    nvectors=5

      369     5847    2           B$P.INSTDATE(SLOT) = CUTS;

   5847  5 001465   200004 470500                    LDP0    @SLOT,,AUTO
         5 001466   000000 236100                    LDQ     0,,PR0
         5 001467   000021 402007                    MPY     17,DL
         5 001470   000001 736000                    QLS     1
         5 001471   000000 471400 xsym               LDP1    P$
         5 001472   000076 235000 1                  LDA     CUTS
         5 001473   100005 755106                    STA     5,QL,PR1

      370     5848    2           RETURN;

   5848  5 001474   200030 221300                    LDX1  ! TMP+2,,AUTO
         5 001475   000001 702211                    TSX2  ! 1,X1
      371     5849    2   END COMMON_SETUP;
      372     5850        /**/
      373     5851        /**/
      374     5852        /**/
      375     5853    1   END IPC$PROCS;

PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:63   
--  Include file information  --

   U$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
   S$WSPTD.:E05TOU  cannot be made into a system file and is referenced.
   MM_MACRO_M.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   MM$SYSGEN.:E05TOU  is referenced.
   M_INFO_C.:E05TOU  is referenced.
   MM_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   IPS_SUBS_C.:E05TOU  is referenced.
   IP_PERR_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   B$P.:E05TOU  cannot be made into a system file and is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   B$MAP.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure IPC$PROCS.
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:64   

 **** Variables and constants ****

  ****  Section 001  Data  IPC$PROCS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    76-0-0/d UBIN        r     1 CUTS                     102-0-0/w STRC        r     1 ERR_NOLIB
   101-0-0/w STRC        r     1 ERR_NOPGTBL                0-0-0/d STRC(216)   r     1 FPT_CVM
    10-0-0/d STRC(936)   r     1 FPT_ERRMSG                62-0-0/d STRC(432)   r     1 FPT_TIME
    52-0-0/d STRC(288)   r     1 OC_CRLF                  104-0-0/d STRC(72)    r     1 STLVEC
   100-0-0/c CHAR        r     1 T_CRLF(0:1)               42-0-0/d STRC(288)   r     1 WRITE_OC

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w PTR         r     1 @ERR                       3-0-0/w PTR         r     1 @PCNTRL
     4-0-0/w PTR         r     1 @SLOT                     14-0-0/w SBIN        r     1 BIAS
    21-0-0/w SBIN        r     1 COUNT                     *0-0-0/w STRC        r     1 ERR
    25-0-0/b BIT         r     1 ERRTEMP                   17-0-0/w SBIN        r     1 HEAD
    23-0-0/w SBIN        r     1 I                         10-0-0/w SBIN        r     1 LIBNUM
    12-0-0/w SBIN        r     1 NXTWSQPG                  *0-0-0/w STRC(288)   r     1 PCNTRL
    13-0-0/b BIT         r     1 PFLGS                     16-0-0/w SBIN        r     1 PGSZ
     7-0-0/w SBIN        r     1 PGTBLNEEDED                6-0-0/w SBIN        r     1 PGTBLSZ
    22-0-0/w PTR         r     1 PROC$                     11-0-0/w SBIN        r     1 PWSQ
    24-0-0/w UBIN        r     1 SEGID                     *0-0-0/w SBIN        r     1 SLOT
    20-0-0/w SBIN        r     1 TAIL                      26-0-0/w SBIN        r     1 TMP
    15-0-0/w SBIN        r     1 TOTSZ

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 BUF$
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:65   
     0-0-0/c CHAR(120)   r     1 ERRMSGBUF                  0-0-0/w PTR         r     1 HEAD$
     0-0-0/w SBIN        r     1 IP_PTB_UNITS               0-0-0/w BIT         r     1 IP_WSQ0PT
     0-0-0/w PTR         r     1 MM_BYP$
     0-0-0/b UBIN(18)    r     1 MM_PWSQPGS(0:2)
     0-0-0/w UBIN        r     1 NPROCS                     0-0-0/w PTR         r     1 P$
     0-0-0/w PTR         r     1 PGTBL$                     0-0-0/w PTR         r     1 PPUT$
     0-0-0/w UBIN        r     1 SCPUWSPTD(0:3)
     0-0-0/w PTR         r     1 WSPTD$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1440)  r     1 B$HEAD                     0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w STRC        r     1 B$MAP(0:1023)              0-0-0/d STRC(1224)  r     1 B$P(0:0)
     0-0-0/w STRC(270)   r     1 B$PROCDS                   0-0-0/d ASTR(9)     r     1 B$TEXTC
     0-0-0N  NULL        r     1 M$EI                       0-0-0N  NULL        r     1 M$LO
     0-0-0/w STRC        r     1 MM$PPUT(0:0)
     0-0-0/w STRC        r     1 S$WSPTD(0:28)


   Procedure IPC$PROCS requires 830 words for executable code.
   Procedure IPC$PROCS requires 40 words of local(AUTO) storage.

    No errors detected in file IPC$PROCS.:E05TSI    .
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:66   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:67   
          MINI XREF LISTING

B$HEAD.BIAS
      5211**DCL      5673>>ASSIGN   5772>>ASSIGN   5779>>ASSIGN   5782>>ASSIGN   5790>>ASSIGN
B$HEAD.DATA_SEG.PROTECTION
      5167**DCL      5712>>ASSIGN
B$HEAD.DATA_SEG.SIZ
      5163**DCL      5705>>IF       5707>>ASSIGN
B$HEAD.LIBNAME
      5219**DCL      5635>>IF
B$HEAD.LIBNAME.CNT
      5224**DCL      5632>>IF
B$HEAD.PRECSIZE
      5109**DCL      5675>>ASSIGN   5774>>ASSIGN
B$HEAD.PRIV
      5048**DCL      5840>>ASSIGN
B$HEAD.RDATA
      5066**DCL      5780>>ASSIGN   5791>>ASSIGN
B$HEAD.RPROC
      5056**DCL      5674>>ASSIGN   5773>>ASSIGN
B$HEAD.START
      5092**DCL      5697>>ASSIGN
B$HEAD.TCBSIZE
      5105**DCL      5843>>IF       5845>>ASSIGN
B$HEAD.VDPGS
      5058**DCL      5772>>ASSIGN
B$HEAD.VPPGS
      5050**DCL      5631>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
      4965**DCL      4965--REDEF
B$JIT.ERR
      4871**DCL      5804>>ASSIGN   5809>>ASSIGN
B$JIT.ERR.MID
      4872**DCL      4872--REDEF
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:68   
B$JIT.USER
      4871**DCL      5811>>IF       5813>>IF
B$JIT$
      5584**DCL      4866--IMP-PTR  5804>>ASSIGN   5809>>ASSIGN   5811>>IF       5813>>IF
B$MAP.CTRL
        76**DCL      5730<<ASSIGN
B$MAP.RPN
        72**DCL      5726<<ASSIGN   5729<<ASSIGN
B$MAP.SCTRL
        73**DCL        74--REDEF
B$P.ACCT
      3590**DCL      5741<<ASSIGN   5799<<ASSIGN
B$P.CRDATE
      3572**DCL      5837<<ASSIGN
B$P.DADDR
      3582**DCL      5692<<ASSIGN   5779<<ASSIGN
B$P.DSDATA
      3577**DCL      5700--ASSIGN   5788--ASSIGN
B$P.DSZ
      3583**DCL      5693<<ASSIGN   5780<<ASSIGN
B$P.DVA
      3585**DCL      5695<<ASSIGN   5782<<ASSIGN
B$P.FLGS
      3588**DCL      5635>>IF       5647>>IF       5841<<ASSIGN
B$P.FRQ
      3569**DCL      5833<<ASSIGN
B$P.HPP
      3570**DCL      5721>>ASSIGN   5834<<ASSIGN
B$P.HVA
      3586**DCL      5646>>ASSIGN   5696<<ASSIGN   5760>>IF       5783<<ASSIGN
B$P.INSTDATE
      3573**DCL      5847<<ASSIGN
B$P.LIB_LNK
      3578**DCL      5734<<ASSIGN   5755>>IF       5756>>ASSIGN   5756>>ASSIGN   5757<<ASSIGN   5842<<ASSIGN
B$P.LNK
      3579**DCL      5832<<ASSIGN
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:69   
B$P.NAME
      3591**DCL      5635>>IF
B$P.NAME.COUNT
      3592**DCL      5739<<ASSIGN   5797<<ASSIGN
B$P.NAME.TEXT
      3593**DCL      5740<<ASSIGN   5798<<ASSIGN
B$P.PPC
      3571**DCL      5647>>IF       5722>>ASSIGN   5836<<ASSIGN
B$P.PRIV
      3576**DCL      5840<<ASSIGN
B$P.PVA
      3584**DCL      5694<<ASSIGN   5722>>ASSIGN   5723>>DOINDEX  5762>>ASSIGN   5781<<ASSIGN
B$P.SA
      3587**DCL      5697<<ASSIGN   5784<<ASSIGN
B$P.SRVTIME
      3575**DCL      5839<<ASSIGN
B$P.TCBSZ
      3589**DCL      5785<<ASSIGN   5844<<ASSIGN   5845<<ASSIGN
B$P.TPP
      3580**DCL      5835<<ASSIGN
B$P.UC
      3568**DCL      5733<<ASSIGN   5733>>ASSIGN   5756<<ASSIGN   5756>>ASSIGN   5831<<ASSIGN
B$P.XEQTIME
      3574**DCL      5838<<ASSIGN
B$PROCDS
      3607**DCL      5701<<ASSIGN   5789<<ASSIGN
B$PROCDS.DSPH
      3608**DCL      5710<<ASSIGN   5794<<ASSIGN
B$PROCDS.DSPROT
      3610**DCL      5712<<ASSIGN
B$PROCDS.DSSIZE
      3609**DCL      5711<<ASSIGN   5795<<ASSIGN
B$TEXTC.COUNT
      5571**DCL      5572--IMP-SIZ  5739>>ASSIGN   5740>>ASSIGN   5797>>ASSIGN   5798>>ASSIGN
B$TEXTC.TEXT
      5572**DCL      5740>>ASSIGN   5798>>ASSIGN
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:70   
BIAS
      5462**DCL      5673<<ASSIGN   5687<>CALL     5703<<ASSIGN   5708<>CALL     5772<<ASSIGN   5775<>CALL
      5781>>ASSIGN   5783>>ASSIGN   5790<<ASSIGN   5792<>CALL
BUF$
      5576**DCL      5687<>CALL     5708<>CALL     5775<>CALL     5792<>CALL
COMMON_SETUP
      5829**PROC     5691--CALL     5778--CALL
COUNT
      5467**DCL      5687<>CALL     5708<>CALL     5775<>CALL     5783>>ASSIGN   5792<>CALL     5836>>ASSIGN
CUTS
      5472**DCL      5446--DCLINIT  5847>>ASSIGN
DBL_ERR
      5809**LABEL    5806--CALLALT
ERR
        23**DCL         8--PROC     5618--ENTRY    5639<<ASSIGN   5649<<ASSIGN   5680<<ASSIGN   5687<>CALL
      5708<>CALL     5746--ENTRY    5769--ENTRY    5775<>CALL     5792<>CALL     5804<<ASSIGN   5810--ASSIGN
      5818<<ASSIGN
ERRMSGBUF
      5592**DCL      5380--DCLINIT  5407--DCLINIT  5408--DCLINIT
ERRTEMP
      5471**DCL      5809<<ASSIGN   5818>>ASSIGN
ERR_NOLIB
      5531**DCL      5639>>ASSIGN   5649>>ASSIGN
ERR_NOPGTBL
      5486**DCL      5680>>ASSIGN
FPT_CVM
      5348**DCL      5659<>CALL     5664<>CALL     5669<>CALL
FPT_CVM.V
      5348**DCL      5348--DCLINIT
FPT_CVM.V.PHYSICAL#
      5348**DCL      5656<<ASSIGN   5661<<ASSIGN
FPT_CVM.V.PPNO#
      5349**DCL      5657<<ASSIGN   5662<<ASSIGN   5667<<ASSIGN   5667>>ASSIGN
FPT_CVM.V.VPNO#
      5350**DCL      5658<<ASSIGN   5663<<ASSIGN   5668<<ASSIGN   5668>>ASSIGN
FPT_ERRMSG
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:71   
      5379**DCL      5812<>CALL
FPT_ERRMSG.CODE_
      5379**DCL      5810<<ASSIGN
FPT_ERRMSG.V
      5383**DCL      5379--DCLINIT
FPT_ERRMSG.V.OUTDCB1#
      5384**DCL      5811<<ASSIGN
FPT_TIME
      5442**DCL      5846<>CALL
FPT_TIME.V
      5446**DCL      5442--DCLINIT
GOT_ERR
      5806**LABEL    5644--GOTO     5650--GOTO     5685--GOTO     5687--CALLALT  5708--CALLALT  5775--CALLALT
      5792--CALLALT
GOT_LIB
      5639**LABEL    5637--GOTO
HEAD
      5465**DCL      5687<>CALL     5708<>CALL     5710>>ASSIGN   5721<<ASSIGN   5725<>CALL     5729>>ASSIGN
      5731<<ASSIGN   5731>>ASSIGN   5775<>CALL     5792<>CALL     5794>>ASSIGN   5834>>ASSIGN
HEAD$
      5583**DCL      5631>>ASSIGN   5632>>IF       5635>>IF       5673>>ASSIGN   5674>>ASSIGN   5675>>ASSIGN
      5697>>ASSIGN   5705>>IF       5707>>ASSIGN   5712>>ASSIGN   5772>>ASSIGN   5772>>ASSIGN   5773>>ASSIGN
      5774>>ASSIGN   5779>>ASSIGN   5780>>ASSIGN   5782>>ASSIGN   5790>>ASSIGN   5791>>ASSIGN   5840>>ASSIGN
      5843>>IF       5845>>ASSIGN
I
      5469**DCL      5704<<DOINDEX  5705>>IF       5707>>ASSIGN   5710>>ASSIGN   5711>>ASSIGN   5712>>ASSIGN
      5712>>ASSIGN   5723<<DOINDEX  5726>>ASSIGN   5729>>ASSIGN   5730>>ASSIGN
IPB$READ
      5594**DCL-ENT  5687--CALL     5708--CALL     5775--CALL     5792--CALL
IPD$FREE_PROC
      5601**DCL-ENT  5806--CALL
IPD$MON_HSTORE
      5597**DCL-ENT  5698--CALL     5763--CALL
IPD$MON_HVAL
      5599**DCL-ENT  5627--CALL     5759--CALL
IPD$REAL_TO_PHYS
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:72   
      5602**DCL-ENT  5725--CALL
IP_PTB_UNITS
      5588**DCL      5662>>ASSIGN
IP_WSQ0PT
      5589**DCL      5724>>IF
LIBNUM
      5458**DCL      5630<<ASSIGN   5634<<DOINDEX  5635>>IF       5635>>IF       5646>>ASSIGN   5647>>IF
      5647>>IF       5719>>IF       5721>>ASSIGN   5722>>ASSIGN   5722>>ASSIGN   5723>>DOINDEX  5733>>ASSIGN
      5733>>ASSIGN   5734>>ASSIGN
M$CVM
      4229**DCL-ENT  5659--CALL     5664--CALL     5669--CALL
M$ERRMSG
      4254**DCL-ENT  5812--CALL
M$TEMPWROC
      4235**DCL-ENT  5815--CALL     5816--CALL
M$TIME
      4258**DCL-ENT  5846--CALL
MM$DESC.BOUND
      4799**DCL      4800--REDEF
MM$DESC.FLGS
      4800**DCL      4800--REDEF
MM$PPUT.PPNO
      4788**DCL      5731>>ASSIGN
MM$PPUT.USER#
      4788**DCL      4788--REDEF
MM_BYP$
      4719**DCL      4719--IMP-PTR
MM_PWSQPGS
      4724**DCL      5627<>CALL     5698<>CALL     5759<>CALL     5763<>CALL
NPROCS
      5453**DCL      5634>>DOINDEX
NXTWSQPG
      5460**DCL      5627<>CALL     5678>>IF       5687<>CALL     5694>>ASSIGN   5696>>ASSIGN   5698>>CALL
      5726>>ASSIGN   5729>>ASSIGN   5730>>ASSIGN   5759<>CALL     5760>>IF       5762<<ASSIGN   5763<>CALL
OC_CRLF
      5424**DCL      5816<>CALL
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:73   
OC_CRLF.V
      5427**DCL      5424--DCLINIT
P$
      5582**DCL      5635>>IF       5635>>IF       5646>>ASSIGN   5647>>IF       5647>>IF       5692>>ASSIGN
      5693>>ASSIGN   5694>>ASSIGN   5695>>ASSIGN   5696>>ASSIGN   5697>>ASSIGN   5700>>ASSIGN   5721>>ASSIGN
      5722>>ASSIGN   5722>>ASSIGN   5723>>DOINDEX  5733>>ASSIGN   5733>>ASSIGN   5734>>ASSIGN   5739>>ASSIGN
      5740>>ASSIGN   5741>>ASSIGN   5755>>IF       5756>>ASSIGN   5756>>ASSIGN   5756>>ASSIGN   5756>>ASSIGN
      5757>>ASSIGN   5760>>IF       5762>>ASSIGN   5779>>ASSIGN   5780>>ASSIGN   5781>>ASSIGN   5782>>ASSIGN
      5783>>ASSIGN   5784>>ASSIGN   5785>>ASSIGN   5788>>ASSIGN   5797>>ASSIGN   5798>>ASSIGN   5799>>ASSIGN
      5831>>ASSIGN   5832>>ASSIGN   5833>>ASSIGN   5834>>ASSIGN   5835>>ASSIGN   5836>>ASSIGN   5837>>ASSIGN
      5838>>ASSIGN   5839>>ASSIGN   5840>>ASSIGN   5841>>ASSIGN   5842>>ASSIGN   5844>>ASSIGN   5845>>ASSIGN
      5847>>ASSIGN
PCNTRL
         9**DCL         8--PROC     5618--ENTRY    5746--ENTRY    5769--ENTRY
PCNTRL.MODTIME
        18**DCL      5837>>ASSIGN
PCNTRL.PFLGS
        21**DCL      5672>>ASSIGN   5771>>ASSIGN   5841>>ASSIGN
PCNTRL.PNAME$
        11**DCL      5739>>ASSIGN   5740>>ASSIGN   5740>>ASSIGN   5797>>ASSIGN   5798>>ASSIGN   5798>>ASSIGN
PCNTRL.PTYPE
        13**DCL      5620>>IF       5622>>IF       5748>>IF       5750>>IF       5752>>IF
PFLGS
      5461**DCL      5672<<ASSIGN   5687<>CALL     5708<>CALL     5771<<ASSIGN   5775<>CALL     5792<>CALL
PGSZ
      5464**DCL      5675<<ASSIGN   5687<>CALL     5708<>CALL     5774<<ASSIGN   5775<>CALL     5792<>CALL
PGTBL$
      5579**DCL      5687<>CALL     5726>>ASSIGN   5729>>ASSIGN   5730>>ASSIGN
PGTBLNEEDED
      5457**DCL      5631<<ASSIGN   5646<<ASSIGN   5678>>IF       5696>>ASSIGN   5698>>CALL
PGTBLSZ
      5456**DCL      5660<<ASSIGN   5665>>IF       5678>>IF
PPUT$
      5577**DCL      5731>>ASSIGN
PROC$
      5468**DCL      5700<<ASSIGN   5701>>ASSIGN   5710>>ASSIGN   5711>>ASSIGN   5712>>ASSIGN   5788<<ASSIGN
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:74   
      5789>>ASSIGN   5794>>ASSIGN   5795>>ASSIGN
PWSQ
      5459**DCL      5621<<ASSIGN   5623<<ASSIGN   5624<<ASSIGN   5627>>CALL     5660>>ASSIGN   5662>>ASSIGN
      5698>>CALL     5749<<ASSIGN   5751<<ASSIGN   5754<<ASSIGN   5759>>CALL     5763>>CALL
S$WSPTD.BLKNO
      4856**DCL      5662>>ASSIGN
S$WSPTD.NBLKS
      4856**DCL      5660>>ASSIGN
SCPUWSPTD
      5580**DCL      5657>>ASSIGN
SEGID
      5470**DCL      5702<<ASSIGN   5708<>CALL     5714<<ASSIGN   5714>>ASSIGN
SET_ERR
      5804**LABEL    5659--CALLALT  5664--CALLALT  5669--CALLALT
SLOT
        22**DCL         8--PROC     5618--ENTRY    5687<>CALL     5692>>ASSIGN   5693>>ASSIGN   5694>>ASSIGN
      5695>>ASSIGN   5696>>ASSIGN   5697>>ASSIGN   5700>>ASSIGN   5708<>CALL     5734>>ASSIGN   5739>>ASSIGN
      5740>>ASSIGN   5741>>ASSIGN   5746--ENTRY    5755>>IF       5756>>ASSIGN   5756>>ASSIGN   5757>>ASSIGN
      5760>>IF       5762>>ASSIGN   5769--ENTRY    5775<>CALL     5779>>ASSIGN   5780>>ASSIGN   5781>>ASSIGN
      5782>>ASSIGN   5783>>ASSIGN   5784>>ASSIGN   5785>>ASSIGN   5788>>ASSIGN   5792<>CALL     5797>>ASSIGN
      5798>>ASSIGN   5799>>ASSIGN   5806<>CALL     5831>>ASSIGN   5832>>ASSIGN   5833>>ASSIGN   5834>>ASSIGN
      5835>>ASSIGN   5836>>ASSIGN   5837>>ASSIGN   5838>>ASSIGN   5839>>ASSIGN   5840>>ASSIGN   5841>>ASSIGN
      5842>>ASSIGN   5844>>ASSIGN   5845>>ASSIGN   5847>>ASSIGN
SOWHAT
      5818**LABEL    5812--CALLALT
STLVEC
      5564**DCL      5364--DCLINIT
TAIL
      5466**DCL      5687<>CALL     5708<>CALL     5722<<ASSIGN   5723>>DOINDEX  5775<>CALL     5792<>CALL
      5835>>ASSIGN
TMP
      5590**DCL      5725<>CALL     5726>>ASSIGN
TOTSZ
      5463**DCL      5674<<ASSIGN   5687<>CALL     5707<<ASSIGN   5708<>CALL     5711>>ASSIGN   5773<<ASSIGN
      5775<>CALL     5791<<ASSIGN   5792<>CALL     5795>>ASSIGN
T_CRLF
PL6.E3A0      #001=IPC$PROCS File=IPC$PROCS.:E05TSI                              TUE 07/29/97 22:40 Page:75   
      5473**DCL      5424--DCLINIT  5425--DCLINIT
WRITE_OC
      5407**DCL      5815<>CALL
WRITE_OC.V
      5410**DCL      5407--DCLINIT
WSPTD$
      5578**DCL      5660>>ASSIGN   5662>>ASSIGN
