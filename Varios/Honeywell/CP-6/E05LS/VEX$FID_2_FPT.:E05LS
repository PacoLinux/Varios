VERSION E05

PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:1    
        1        1        /*M*    VEX$FID_2_FPT - TURN PARSED FID INTO FPT FOR EDIT */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*/
        8        8        VEX$FID_2_FPT: PROC(PTR$,OPEN_FPT,DEVICE_OK) ALTRET;
        9        9        /**/
       10       10        /*********************************************************************/
       11       11        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
       12       12        /*********************************************************************/
       13       13        %INCLUDE CP_6;
       14       94        %INCLUDE VE_SUBS_C;
       15      288        %INCLUDE VE_PERR_C;
       16      505        %INCLUDE CP_6_SUBS;
       17     1045        %INCLUDE B$JIT ;
       18     1335        /**/
       19     1336        /**********************************************************************/
       20     1337        /*   PARAMETERS   PARAMETERS   PARAMETERS   PARAMETERS   PARAMETERS   */
       21     1338        /**********************************************************************/
       22     1339    1   DCL PTR$ PTR;
       23     1340    1   DCL DEVICE_OK UBIN WORD; /* 0 IF DEVICE FID NOT OKAY, 1 IF OKAY */
       24     1341        %FPT_OPEN (FPTN = OPEN_FPT ,
       25     1342                  STCLASS=" ") ;
       26     1451        /**/
       27     1452        /*****************************************************************/
       28     1453        /*   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   */
       29     1454        /*****************************************************************/
       30     1455    1   DCL M$FILE_NUM UBIN WORD SYMREF;
       31     1456    1   DCL 1 CURR_FILE_NAME SYMREF,            /* Remember the FID being edited from*/
       32     1457    1          2 COUNT UBIN(9) CALIGNED,        /* before the COMMAND was executed   */
       33     1458    1          2 TEXT CHAR(CURR_FILE_NAME.COUNT) CALIGNED;     /* that changed it.   */
       34     1459    1   DCL   CURR_FILE_ACCT CHAR(8) SYMREF ;
       35     1460    1   DCL   CURR_FILE_PASS CHAR(8) SYMREF ;
       36     1461    1   DCL 1 CURR_FILE_SN  SYMREF,
       37     1462    1          2 COUNT SBIN WORD,
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:2    
       38     1463    1          2 SN CHAR(6) UNAL;
       39     1464    1   DCL 1 OPEN_FILE_NAME SYMREF,
       40     1465    1         2 COUNT UBIN(9) UNAL,
       41     1466    1         2 TEXT CHAR(31) UNAL;
       42     1467    1   DCL OPEN_FILE_ACCT CHAR(8) SYMREF;
       43     1468    1   DCL OPEN_FILE_PASS CHAR(8) SYMREF;
       44     1469    1   DCL 1 OPEN_FILE_SN SYMREF,
       45     1470    1         2 COUNT SBIN WORD,
       46     1471    1         2 SN CHAR(6) UNAL;
       47     1472    1   DCL 1 SUB_BUF_1 SYMREF,
       48     1473    1         2 COUNT UBIN(9) UNAL,
       49     1474    1         2 TEXT CHAR(31) UNAL;
       50     1475    1   DCL 1 SUB_BUF_2 SYMREF,
       51     1476    1         2 COUNT UBIN(9) UNAL,
       52     1477    1         2 TEXT CHAR(31) UNAL;
       53     1478    1   DCL 1 SUB_BUF_3 SYMREF,
       54     1479    1         2 COUNT UBIN(9) UNAL,
       55     1480    1         2 TEXT CHAR(31) UNAL;
       56     1481    1   DCL VEX$ERROR ENTRY(2) ALTRET;
       57     1482    1   DCL B$JIT$ PTR SYMREF ;
       58     1483        /**/
       59     1484        /***************************************************************************/
       60     1485        /*   STATIC DATA   STATIC DATA   STATIC DATA   STATIC DATA   STATIC DATA   */
       61     1486        /***************************************************************************/
       62     1487    1   DCL FID_ASN UBIN(9) STATIC;
       63     1488    1   DCL FID_RES CHAR(4) STATIC;
       64     1489    1   DCL SPACE CHAR(60) STATIC;
       65     1490        /********************************************************************/
       66     1491        /*   AUTO   AUTO   AUTO   AUTO   AUTO   AUTO   AUTO   AUTO   AUTO   */
       67     1492        /********************************************************************/
       68     1493    1   DCL SPACE2 CHAR(60) AUTO;
       69     1494    1   DCL I SBIN AUTO;  /* POSITION OF THE = */
       70     1495    1   DCL STRLEN SBIN AUTO;  /* Length of the incoming FID */
       71     1496    1   DCL J SBIN AUTO;  /* Position of the '/' or the '.'  */
       72     1497    1   DCL PASS BIT(1) AUTO;
       73     1498    1   DCL ACCT BIT(1) AUTO;
       74     1499    1   DCL LEN SBIN AUTO;
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:3    
       75     1500    1   DCL TEMP CHAR(8) AUTO;
       76     1501    1   DCL EQUAL_ONLY BIT(1) ALIGNED AUTO;
       77     1502        /********************************************************************/
       78     1503        /*   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   */
       79     1504        /********************************************************************/
       80     1505        %FPT_FID (FPTN = FID_FPT, STCLASS = "");
       81     1528        %FPT_FID (FPTN = FID_FPT_C, STCLASS = CONSTANT,
       82     1529                  NAME = OPEN_FILE_NAME,
       83     1530                  ACCT = OPEN_FILE_ACCT,
       84     1531                  PASS = OPEN_FILE_PASS,
       85     1532                  SN = OPEN_FILE_SN,
       86     1533                  TEXTFID = SPACE,
       87     1534                  RES = FID_RES,
       88     1535                  ASN = FID_ASN,
       89     1536                  RESULTS = FID_RESULTS);
       90     1559        %VLR_FID     (FPTN = FID_RESULTS);
       91     1578        /**/
       92     1579        /**********************************************************************/
       93     1580        /*   BASED DATA   BASED DATA   BASED DATA   BASED DATA   BASED DATA   */
       94     1581        /**********************************************************************/
       95     1582    1   DCL 1 TEXTC BASED ALIGNED,
       96     1583    1         2 COUNT UBIN(9) UNAL,
       97     1584    1         2 TEXT CHAR(TEXTC.COUNT) UNAL;
       98     1585        /*****************************************************************************/
       99     1586        /*   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   */
      100     1587        /*****************************************************************************/
      101     1588        /**/
      102     1589    1            SPACE = PTR$ -> TEXTC.TEXT;
      103     1590    1            SPACE2 = SPACE ;
      104     1591    1            LEN = PTR$ -> TEXTC.COUNT;
      105     1592    1            STRLEN = LEN ;
      106     1593    1            CALL INDEX (I,'=',SPACE2)
      107     1594    2               WHENRETURN DO;   /* AN '=' HAS BEEN FOUND */
      108     1595    2               IF (SUBSTR(SPACE2,I,2) = '==') THEN /* Name of first fid */
      109     1596    3                  DO;
      110     1597                       /* Make it looks like an = substitution but move the
      111     1598                          OPEN_FILE stuff(which is the FID from the first
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:4    
      112     1599                          FID on the line) to the CURR_FILE stuff          */
      113     1600    3                  CURR_FILE_NAME = OPEN_FILE_NAME;
      114     1601    3                  CURR_FILE_SN.COUNT = 6;
      115     1602    3                  CURR_FILE_SN = OPEN_FILE_SN;
      116     1603    3                  CURR_FILE_ACCT = OPEN_FILE_ACCT;
      117     1604    3                  CURR_FILE_PASS = OPEN_FILE_PASS;
      118     1605    3                  CALL CONCAT(SPACE,SUBSTR(SPACE2,0,I),'=',
      119     1606    3                                    SUBSTR(SPACE2,I+2) );
      120     1607    3                  SPACE2 = SPACE;
      121     1608    3                  END;
      122     1609
      123     1610    2               IF (CURR_FILE_NAME.TEXT = '..........') THEN
      124     1611    3                  DO; /* using = before it is defined */
      125     1612    3                  CALL VEX$ERROR(E$E_EQUALUNDEF,3);
      126     1613    3                  ALTRETURN;
      127     1614    3                  END;
      128     1615        /**/
      129     1616        /*E*       ERROR:  VEE-E$E_EQUALUNDEF-0
      130     1617                   MESSAGE: The Value '=' represents is undefined.
      131     1618                   DESCRIPTION: The user used the '=' in a Command before
      132     1619                                Opening a File with EDIT.
      133     1620
      134     1621        */
      135     1622
      136     1623                    /* now to find the ACCOUNT and Password */
      137     1624    2               PASS= '1'B; ACCT = '1'B; /* Assume they are Present */
      138     1625    2               CALL INDEX1R(J,'.',SPACE2) ;
      139     1626    3               IF (J >= STRLEN) THEN DO;
      140     1627    3                 PASS = '0'B; /* Neither of them are Present */
      141     1628    3                 ACCT = '0'B; /* Neither of them are Present */
      142     1629    3                 END;
      143     1630    2               IF (I+1 = J) THEN PASS = '0'B; /* =.ACCT  No Password Present    */
      144     1631    2               IF (I+2 = J) THEN ACCT ='0'B;  /* =..PASS No Account Present     */
      145     1632
      146     1633    2               IF (I=0) AND (NOT ACCT) AND (NOT PASS)
      147     1634    2                  THEN EQUAL_ONLY = '1'B;
      148     1635    2                  ELSE EQUAL_ONLY = '0'B;
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:5    
      149     1636    2               SPACE = SUBSTR(SPACE2,0,I) ;
      150     1637    2               LEN = I; /* if I=0 then user Didn't specify a PSN */
      151     1638
      152     1639    2               IF (I=0) AND (NOT ACCT) /* User wants CURR ACCT */ AND
      153     1640    2   /* We have a PSN */ (CURR_FILE_SN.SN ~= ' ') THEN /* Must MERGE PSN */
      154     1641    3                  DO;
      155     1642    3                  TEMP = CURR_FILE_SN.SN; /* Move to an 8 char var */
      156     1643    3                  CALL STR_TO_TEXTC(SUB_BUF_1,TEMP);
      157     1644    3                  CALL CONCAT(SPACE,'DP#',
      158     1645    3                              SUBSTR(SUB_BUF_1.TEXT,0,SUB_BUF_1.COUNT),
      159     1646    3                              '/');
      160     1647    3                  LEN = 4+SUB_BUF_1.COUNT;
      161     1648    3                  END;
      162     1649
      163     1650                    /* Now move the current file name */
      164     1651    2               CALL INSERT(SPACE,LEN,,CURR_FILE_NAME.TEXT) ;
      165     1652    2               LEN = LEN + CURR_FILE_NAME.COUNT;
      166     1653
      167     1654    3               IF (~ ACCT) THEN DO;/* We have to specify it for them */
      168     1655    3                  CALL STR_TO_TEXTC(SUB_BUF_1,CURR_FILE_ACCT);
      169     1656    3                  CALL INSERT(SPACE,LEN,,'.',
      170     1657    3                              SUBSTR(SUB_BUF_1.TEXT,0,SUB_BUF_1.COUNT));
      171     1658    3                  LEN = LEN + SUB_BUF_1.COUNT + 1 ;
      172     1659    4                  IF (PASS) THEN DO;  /* We must merge in there password  */
      173     1660    4                     CALL INSERT (SPACE,LEN,,SUBSTR(SPACE2,J,STRLEN - J)) ;
      174     1661    4                     LEN = LEN + STRLEN - J ;
      175     1662    4                     END;
      176     1663    3                  END;
      177     1664    3               ELSE DO;/* User specified the ACCOUNT go merge it in          */
      178     1665                     /* This also Merges the password in if the user specified one */
      179     1666    3                  CALL INSERT (SPACE,LEN,,SUBSTR(SPACE2,I+1,STRLEN-I-1)) ;
      180     1667    3                  LEN = LEN + STRLEN - I - 1  ;
      181     1668    3                  END;
      182     1669
      183     1670    3               IF (EQUAL_ONLY) THEN DO;/* The only time we assume PASSWORD */
      184     1671    3                  CALL STR_TO_TEXTC(SUB_BUF_1,CURR_FILE_PASS);
      185     1672    4                  IF (SUB_BUF_1.COUNT > 0) THEN DO; /* If Pass ~=' ' merge */
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:6    
      186     1673    4                     CALL INSERT(SPACE,LEN,,'.',
      187     1674    4                                 SUBSTR(SUB_BUF_1.TEXT,0,SUB_BUF_1.COUNT));
      188     1675    4                     LEN = LEN + SUB_BUF_1.COUNT + 1 ;
      189     1676    4                     END;
      190     1677    3                  END;
      191     1678
      192     1679    2               SPACE2 = SPACE;
      193     1680    2               CALL FILL_SUB_BUF;
      194     1681    2               CALL VEX$ERROR(E$TELLFIDNAME,1) ;
      195     1682        /**/
      196     1683        /*E*      ERROR:        VEE-E$TELLFIDNAME-0
      197     1684                  MESSAGE:      %U1%U2 used as %U3 file.
      198     1685                  DESCRIPTION:  Tell the user what EDIT thinks the = meant.
      199     1686        */
      200     1687    2               END;   /* WHENRETURN */
      201     1688    1            FID_FPT = FID_FPT_C;
      202     1689    1           CALL M$FID(FID_FPT) ALTRET (FID_ERR);
      203     1690        /**/
      204     1691    1           IF (FID_RESULTS.ACCT)
      205     1692    1               THEN OPEN_FPT.ACCT_ = VECTOR(OPEN_FILE_ACCT) ;
      206     1693    1               ELSE OPEN_FPT.ACCT_ = VECTOR(NIL) ;
      207     1694    1           IF (FID_RESULTS.PASS)
      208     1695    1               THEN OPEN_FPT.PASS_ = VECTOR(OPEN_FILE_PASS) ;
      209     1696    1               ELSE OPEN_FPT.PASS_ = VECTOR(ERASE) ;
      210     1697    1           IF (FID_RESULTS.SN)
      211     1698    1               THEN OPEN_FPT.SN_ = VECTOR(OPEN_FILE_SN) ;
      212     1699    1               ELSE OPEN_FPT.SN_ = VECTOR(NIL) ;
      213     1700    1           IF (FID_ASN = %FILE#) THEN RETURN;
      214     1701    1            IF FID_ASN = %DEVICE# AND
      215     1702    1                  FID_RESULTS.RES AND
      216     1703    1                  (FID_RES = 'UC' OR FID_RES = 'ME') AND
      217     1704    1                  DEVICE_OK ~=0
      218     1705    1             THEN
      219     1706    2             DO;
      220     1707    2                  OPEN_FPT.V.RES# = FID_RES;
      221     1708    2                  OPEN_FPT.V.ASN# = %DEVICE#;
      222     1709    2                  RETURN;
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:7    
      223     1710    2                  END;
      224     1711    1   FID_ERR:
      225     1712    1           CALL FILL_SUB_BUF;
      226     1713    1           CALL VEX$ERROR(E$E_BADFID,3);
      227     1714    1           ALTRETURN;
      228     1715        /**/
      229     1716        /*E*     ERROR:    VEE-E$E_BADFID-0
      230     1717                 MESSAGE:  Illegal file identifier
      231     1718                 MESSAGE1: %U1%U2 is not a legal file identifier for %U3
      232     1719                 DESCRIPTION: An illegal file identifier was input.
      233     1720        */
      234     1721    1   FILL_SUB_BUF: PROC;
      235     1722
      236     1723    2   DCL X UBIN AUTO;
      237     1724
      238     1725    3       CALL INDEX(X,'.',SPACE2) WHENRETURN DO;
      239     1726    4          CALL INDEX (X,'.',SPACE2,X+1)  WHENRETURN DO; /* Blank Password */
      240     1727    4              SUBSTR(SPACE2,X+1,LEN-X-1) = '********';
      241     1728    4              END;
      242     1729    3          END;
      243     1730
      244     1731    3       IF (LEN < 31) THEN DO;
      245     1732    3         SUB_BUF_1.TEXT = SUBSTR(SPACE2,0,LEN) ;
      246     1733    3         SUB_BUF_1.COUNT = LEN ;
      247     1734    3         SUB_BUF_2.TEXT = ' ' ;
      248     1735    3         SUB_BUF_2.COUNT = 1 ;
      249     1736    3         END;
      250     1737    3       ELSE DO;
      251     1738    3         SUB_BUF_1.TEXT = SUBSTR(SPACE2,0,31) ;
      252     1739    3         SUB_BUF_1.COUNT = 31 ;
      253     1740    3         SUB_BUF_2.TEXT = SUBSTR(SPACE2,31,LEN-31) ;
      254     1741    3         SUB_BUF_2.COUNT = LEN - 31 ;
      255     1742    3         END;
      256     1743
      257     1744
      258     1745    2       IF  OPEN_FPT.V.DCB# = M$FILE_NUM THEN
      259     1746    3       DO;
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:8    
      260     1747    3         SUB_BUF_3.COUNT = 4;
      261     1748    3         SUB_BUF_3.TEXT = 'edit';
      262     1749    3         END;
      263     1750    3       ELSE DO;
      264     1751    3         SUB_BUF_3.COUNT = 6;
      265     1752    3         SUB_BUF_3.TEXT = 'output';
      266     1753    3         END;
      267     1754    2   END FILL_SUB_BUF;
      268     1755
      269     1756    1   STR_TO_TEXTC: PROC (TEXTC,STR) ;
      270     1757
      271     1758    2   DCL 1 TEXTC PARAM,
      272     1759    2         2  COUNT UBIN(9) UNAL,
      273     1760    2         2  TEXT  CHAR(TEXTC.COUNT) UNAL ;
      274     1761
      275     1762    2   DCL STR CHAR(8) PARAM;
      276     1763
      277     1764    2   DCL X UBIN AUTO;
      278     1765
      279     1766    2       CALL INDEX (X,' ',STR) ;
      280     1767    2       TEXTC.COUNT = X;
      281     1768    2       TEXTC.TEXT = STR ;
      282     1769
      283     1770    2   END STR_TO_TEXTC;
      284     1771    1   END;

PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:9    
--  Include file information  --

   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   VE_PERR_C.:E05TOU  is referenced.
   VE_SUBS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VEX$FID_2_FPT.

   Procedure VEX$FID_2_FPT requires 441 words for executable code.
   Procedure VEX$FID_2_FPT requires 60 words of local(AUTO) storage.

    No errors detected in file VEX$FID_2_FPT.:E05TSI    .

PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:10   

 Object Unit name= VEX$FID_2_FPT                              File name= VEX$FID_2_FPT.:E05TOU
 UTS= JUL 30 '97 07:12:12.92 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    28     34  VEX$FID_2_FPT
    2  RoData even  UTS     36     44  VEX$FID_2_FPT
    3   Proc  even  none   441    671  VEX$FID_2_FPT
    4  RoData even  none    27     33  VEX$FID_2_FPT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        3  VEX$FID_2_FPT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 VEX$ERROR
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:11   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$FILE_NUM                            CURR_FILE_NAME
     CURR_FILE_ACCT                        CURR_FILE_PASS                        CURR_FILE_SN
     OPEN_FILE_NAME                        OPEN_FILE_ACCT                        OPEN_FILE_PASS
     OPEN_FILE_SN                          SUB_BUF_1                             SUB_BUF_2
     SUB_BUF_3                             B$JIT$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:12   


        1        1        /*M*    VEX$FID_2_FPT - TURN PARSED FID INTO FPT FOR EDIT */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*/
        8        8        VEX$FID_2_FPT: PROC(PTR$,OPEN_FPT,DEVICE_OK) ALTRET;

      8  3 000000   000000 700200 xent  VEX$FID_2_F* TSX0  ! X66_AUTO_3
         3 000001   000074 000003                    ZERO    60,3

        9        9        /**/
       10       10        /*********************************************************************/
       11       11        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
       12       12        /*********************************************************************/
       13       13        %INCLUDE CP_6;
       14       94        %INCLUDE VE_SUBS_C;
       15      288        %INCLUDE VE_PERR_C;
       16      505        %INCLUDE CP_6_SUBS;
       17     1045        %INCLUDE B$JIT ;
       18     1335        /**/
       19     1336        /**********************************************************************/
       20     1337        /*   PARAMETERS   PARAMETERS   PARAMETERS   PARAMETERS   PARAMETERS   */
       21     1338        /**********************************************************************/
       22     1339    1   DCL PTR$ PTR;
       23     1340    1   DCL DEVICE_OK UBIN WORD; /* 0 IF DEVICE FID NOT OKAY, 1 IF OKAY */
       24     1341        %FPT_OPEN (FPTN = OPEN_FPT ,
       25     1342                  STCLASS=" ") ;
       26     1451        /**/
       27     1452        /*****************************************************************/
       28     1453        /*   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   */
       29     1454        /*****************************************************************/
       30     1455    1   DCL M$FILE_NUM UBIN WORD SYMREF;
       31     1456    1   DCL 1 CURR_FILE_NAME SYMREF,            /* Remember the FID being edited from*/
       32     1457    1          2 COUNT UBIN(9) CALIGNED,        /* before the COMMAND was executed   */
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:13   
       33     1458    1          2 TEXT CHAR(CURR_FILE_NAME.COUNT) CALIGNED;     /* that changed it.   */
       34     1459    1   DCL   CURR_FILE_ACCT CHAR(8) SYMREF ;
       35     1460    1   DCL   CURR_FILE_PASS CHAR(8) SYMREF ;
       36     1461    1   DCL 1 CURR_FILE_SN  SYMREF,
       37     1462    1          2 COUNT SBIN WORD,
       38     1463    1          2 SN CHAR(6) UNAL;
       39     1464    1   DCL 1 OPEN_FILE_NAME SYMREF,
       40     1465    1         2 COUNT UBIN(9) UNAL,
       41     1466    1         2 TEXT CHAR(31) UNAL;
       42     1467    1   DCL OPEN_FILE_ACCT CHAR(8) SYMREF;
       43     1468    1   DCL OPEN_FILE_PASS CHAR(8) SYMREF;
       44     1469    1   DCL 1 OPEN_FILE_SN SYMREF,
       45     1470    1         2 COUNT SBIN WORD,
       46     1471    1         2 SN CHAR(6) UNAL;
       47     1472    1   DCL 1 SUB_BUF_1 SYMREF,
       48     1473    1         2 COUNT UBIN(9) UNAL,
       49     1474    1         2 TEXT CHAR(31) UNAL;
       50     1475    1   DCL 1 SUB_BUF_2 SYMREF,
       51     1476    1         2 COUNT UBIN(9) UNAL,
       52     1477    1         2 TEXT CHAR(31) UNAL;
       53     1478    1   DCL 1 SUB_BUF_3 SYMREF,
       54     1479    1         2 COUNT UBIN(9) UNAL,
       55     1480    1         2 TEXT CHAR(31) UNAL;
       56     1481    1   DCL VEX$ERROR ENTRY(2) ALTRET;
       57     1482    1   DCL B$JIT$ PTR SYMREF ;
       58     1483        /**/
       59     1484        /***************************************************************************/
       60     1485        /*   STATIC DATA   STATIC DATA   STATIC DATA   STATIC DATA   STATIC DATA   */
       61     1486        /***************************************************************************/
       62     1487    1   DCL FID_ASN UBIN(9) STATIC;
       63     1488    1   DCL FID_RES CHAR(4) STATIC;
       64     1489    1   DCL SPACE CHAR(60) STATIC;
       65     1490        /********************************************************************/
       66     1491        /*   AUTO   AUTO   AUTO   AUTO   AUTO   AUTO   AUTO   AUTO   AUTO   */
       67     1492        /********************************************************************/
       68     1493    1   DCL SPACE2 CHAR(60) AUTO;
       69     1494    1   DCL I SBIN AUTO;  /* POSITION OF THE = */
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:14   
       70     1495    1   DCL STRLEN SBIN AUTO;  /* Length of the incoming FID */
       71     1496    1   DCL J SBIN AUTO;  /* Position of the '/' or the '.'  */
       72     1497    1   DCL PASS BIT(1) AUTO;
       73     1498    1   DCL ACCT BIT(1) AUTO;
       74     1499    1   DCL LEN SBIN AUTO;
       75     1500    1   DCL TEMP CHAR(8) AUTO;
       76     1501    1   DCL EQUAL_ONLY BIT(1) ALIGNED AUTO;
       77     1502        /********************************************************************/
       78     1503        /*   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   */
       79     1504        /********************************************************************/
       80     1505        %FPT_FID (FPTN = FID_FPT, STCLASS = "");
       81     1528        %FPT_FID (FPTN = FID_FPT_C, STCLASS = CONSTANT,
       82     1529                  NAME = OPEN_FILE_NAME,
       83     1530                  ACCT = OPEN_FILE_ACCT,
       84     1531                  PASS = OPEN_FILE_PASS,
       85     1532                  SN = OPEN_FILE_SN,
       86     1533                  TEXTFID = SPACE,
       87     1534                  RES = FID_RES,
       88     1535                  ASN = FID_ASN,
       89     1536                  RESULTS = FID_RESULTS);
       90     1559        %VLR_FID     (FPTN = FID_RESULTS);
       91     1578        /**/
       92     1579        /**********************************************************************/
       93     1580        /*   BASED DATA   BASED DATA   BASED DATA   BASED DATA   BASED DATA   */
       94     1581        /**********************************************************************/
       95     1582    1   DCL 1 TEXTC BASED ALIGNED,
       96     1583    1         2 COUNT UBIN(9) UNAL,
       97     1584    1         2 TEXT CHAR(TEXTC.COUNT) UNAL;
       98     1585        /*****************************************************************************/
       99     1586        /*   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   */
      100     1587        /*****************************************************************************/
      101     1588        /**/
      102     1589    1            SPACE = PTR$ -> TEXTC.TEXT;

   1589  3 000002   200003 470500                    LDP0    @PTR$,,AUTO
         3 000003   000000 471500                    LDP1    0,,PR0
         3 000004   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:15   
         3 000005   000033 772000                    QRL     27
         3 000006   000000 620006                    EAX0    0,QL
         3 000007   040000 100540                    MLR     fill='040'O
         3 000010   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0
         3 000011   000002 000074 1                  ADSC9   SPACE                    cn=0,n=60

      103     1590    1            SPACE2 = SPACE ;

   1590  3 000012   040100 100400                    MLR     fill='040'O
         3 000013   000002 000074 1                  ADSC9   SPACE                    cn=0,n=60
         3 000014   200006 000074                    ADSC9   SPACE2,,AUTO             cn=0,n=60

      104     1591    1            LEN = PTR$ -> TEXTC.COUNT;

   1591  3 000015   000000 471500                    LDP1    0,,PR0
         3 000016   100000 236100                    LDQ     0,,PR1
         3 000017   000033 772000                    QRL     27
         3 000020   200032 756100                    STQ     LEN,,AUTO

      105     1592    1            STRLEN = LEN ;

   1592  3 000021   200026 756100                    STQ     STRLEN,,AUTO

      106     1593    1            CALL INDEX (I,'=',SPACE2)

   1593  3 000022   000000 124500                    SCM     mask='000'O
         3 000023   200006 000074                    ADSC9   SPACE2,,AUTO             cn=0,n=60
         3 000024   000000 000001 4                  ADSC9   0                        cn=0,n=1
         3 000025   200025 000100                    ARG     I,,AUTO
         3 000026   000434 606400 3                  TTN     s:1688

      107     1594    2               WHENRETURN DO;   /* AN '=' HAS BEEN FOUND */

      108     1595    2               IF (SUBSTR(SPACE2,I,2) = '==') THEN /* Name of first fid */

   1595  3 000027   200025 235100                    LDA     I,,AUTO
         3 000030   040000 106505                    CMPC    fill='040'O
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:16   
         3 000031   200006 000002                    ADSC9   SPACE2,A,AUTO            cn=0,n=2
         3 000032   000030 000002 2                  ADSC9   FID_FPT_C+24             cn=0,n=2
         3 000033   000105 601000 3                  TNZ     s:1610

      109     1596    3                  DO;

      110     1597                       /* Make it looks like an = substitution but move the
      111     1598                          OPEN_FILE stuff(which is the FID from the first
      112     1599                          FID on the line) to the CURR_FILE stuff          */
      113     1600    3                  CURR_FILE_NAME = OPEN_FILE_NAME;

   1600  3 000034   000000 236000 xsym               LDQ     CURR_FILE_NAME
         3 000035   000033 772000                    QRL     27
         3 000036   000001 620006                    EAX0    1,QL
         3 000037   000040 100400                    MLR     fill='000'O
         3 000040   000000 000040 xsym               ADSC9   OPEN_FILE_NAME           cn=0,n=32
         3 000041   000000 000010 xsym               ADSC9   CURR_FILE_NAME           cn=0,n=*X0

      114     1601    3                  CURR_FILE_SN.COUNT = 6;

   1601  3 000042   000006 236007                    LDQ     6,DL
         3 000043   000000 756000 xsym               STQ     CURR_FILE_SN

      115     1602    3                  CURR_FILE_SN = OPEN_FILE_SN;

   1602  3 000044   000000 100400                    MLR     fill='000'O
         3 000045   000000 000012 xsym               ADSC9   OPEN_FILE_SN             cn=0,n=10
         3 000046   000000 000012 xsym               ADSC9   CURR_FILE_SN             cn=0,n=10

      116     1603    3                  CURR_FILE_ACCT = OPEN_FILE_ACCT;

   1603  3 000047   040000 100400                    MLR     fill='040'O
         3 000050   000000 000010 xsym               ADSC9   OPEN_FILE_ACCT           cn=0,n=8
         3 000051   000000 000010 xsym               ADSC9   CURR_FILE_ACCT           cn=0,n=8

      117     1604    3                  CURR_FILE_PASS = OPEN_FILE_PASS;

PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:17   
   1604  3 000052   040000 100400                    MLR     fill='040'O
         3 000053   000000 000010 xsym               ADSC9   OPEN_FILE_PASS           cn=0,n=8
         3 000054   000000 000010 xsym               ADSC9   CURR_FILE_PASS           cn=0,n=8

      118     1605    3                  CALL CONCAT(SPACE,SUBSTR(SPACE2,0,I),'=',

   1605  3 000055   000000 620005                    EAX0    0,AL
         3 000056   040000 100540                    MLR     fill='040'O
         3 000057   200006 000010                    ADSC9   SPACE2,,AUTO             cn=0,n=*X0
         3 000060   000002 000074 1                  ADSC9   SPACE                    cn=0,n=60
         3 000061   200025 236100                    LDQ     I,,AUTO
         3 000062   000074 116007                    CMPQ    60,DL
         3 000063   000102 605000 3                  TPL     s:1607
         3 000064   777703 620006                    EAX0    -61,QL
         3 000065   777777 660003                    ERX0    -1,DU
         3 000066   040046 100400                    MLR     fill='040'O
         3 000067   000000 000001 4                  ADSC9   0                        cn=0,n=1
         3 000070   000002 000010 1                  ADSC9   SPACE,Q                  cn=0,n=*X0
         3 000071   000073 116007                    CMPQ    59,DL
         3 000072   000102 605000 3                  TPL     s:1607
         3 000073   777705 621006                    EAX1    -59,QL
         3 000074   777777 661003                    ERX1    -1,DU
         3 000075   777704 622006                    EAX2    -60,QL
         3 000076   777777 662003                    ERX2    -1,DU
         3 000077   040046 100546                    MLR     fill='040'O
         3 000100   200006 400011                    ADSC9   SPACE2,Q,AUTO            cn=2,n=*X1
         3 000101   000002 200012 1                  ADSC9   SPACE,Q                  cn=1,n=*X2

      119     1606    3                                    SUBSTR(SPACE2,I+2) );
      120     1607    3                  SPACE2 = SPACE;

   1607  3 000102   040100 100400                    MLR     fill='040'O
         3 000103   000002 000074 1                  ADSC9   SPACE                    cn=0,n=60
         3 000104   200006 000074                    ADSC9   SPACE2,,AUTO             cn=0,n=60

      121     1608    3                  END;

PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:18   
      122     1609
      123     1610    2               IF (CURR_FILE_NAME.TEXT = '..........') THEN

   1610  3 000105   000000 236000 xsym               LDQ     CURR_FILE_NAME
         3 000106   000033 772000                    QRL     27
         3 000107   000000 620006                    EAX0    0,QL
         3 000110   040000 106440                    CMPC    fill='040'O
         3 000111   000000 200010 xsym               ADSC9   CURR_FILE_NAME           cn=1,n=*X0
         3 000112   000031 000012 2                  ADSC9   FID_FPT_C+25             cn=0,n=10
         3 000113   000121 601000 3                  TNZ     s:1624

      124     1611    3                  DO; /* using = before it is defined */

      125     1612    3                  CALL VEX$ERROR(E$E_EQUALUNDEF,3);

   1612  3 000114   000002 630400 4                  EPPR0   2
         3 000115   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000116   000000 701000 xent               TSX1    VEX$ERROR
         3 000117   000000 011000                    NOP     0

      126     1613    3                  ALTRETURN;

   1613  3 000120   000000 702200 xent               TSX2  ! X66_AALT

      127     1614    3                  END;
      128     1615        /**/
      129     1616        /*E*       ERROR:  VEE-E$E_EQUALUNDEF-0
      130     1617                   MESSAGE: The Value '=' represents is undefined.
      131     1618                   DESCRIPTION: The user used the '=' in a Command before
      132     1619                                Opening a File with EDIT.
      133     1620
      134     1621        */
      135     1622
      136     1623                    /* now to find the ACCOUNT and Password */
      137     1624    2               PASS= '1'B; ACCT = '1'B; /* Assume they are Present */

   1624  3 000121   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:19   
         3 000122   200030 756100                    STQ     PASS,,AUTO

   1624  3 000123   200031 756100                    STQ     ACCT,,AUTO

      138     1625    2               CALL INDEX1R(J,'.',SPACE2) ;

   1625  3 000124   000000 125500                    SCMR    mask='000'O
         3 000125   200006 000074                    ADSC9   SPACE2,,AUTO             cn=0,n=60
         3 000126   000004 000001 4                  ADSC9   4                        cn=0,n=1
         3 000127   200027 000100                    ARG     J,,AUTO
         3 000130   000133 606400 3                  TTN     s:1626
         3 000131   000073 236007                    LDQ     59,DL
         3 000132   200027 156100                    SSQ     J,,AUTO

      139     1626    3               IF (J >= STRLEN) THEN DO;

   1626  3 000133   200027 236100                    LDQ     J,,AUTO
         3 000134   200026 116100                    CMPQ    STRLEN,,AUTO
         3 000135   000140 604000 3                  TMI     s:1630

      140     1627    3                 PASS = '0'B; /* Neither of them are Present */

   1627  3 000136   200030 450100                    STZ     PASS,,AUTO

      141     1628    3                 ACCT = '0'B; /* Neither of them are Present */

   1628  3 000137   200031 450100                    STZ     ACCT,,AUTO

      142     1629    3                 END;

      143     1630    2               IF (I+1 = J) THEN PASS = '0'B; /* =.ACCT  No Password Present    */

   1630  3 000140   200025 236100                    LDQ     I,,AUTO
         3 000141   000001 036007                    ADLQ    1,DL
         3 000142   200027 116100                    CMPQ    J,,AUTO
         3 000143   000145 601000 3                  TNZ     s:1631

PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:20   
   1630  3 000144   200030 450100                    STZ     PASS,,AUTO

      144     1631    2               IF (I+2 = J) THEN ACCT ='0'B;  /* =..PASS No Account Present     */

   1631  3 000145   200025 236100                    LDQ     I,,AUTO
         3 000146   000002 036007                    ADLQ    2,DL
         3 000147   200027 116100                    CMPQ    J,,AUTO
         3 000150   000152 601000 3                  TNZ     s:1633

   1631  3 000151   200031 450100                    STZ     ACCT,,AUTO

      145     1632
      146     1633    2               IF (I=0) AND (NOT ACCT) AND (NOT PASS)

   1633  3 000152   200025 235100                    LDA     I,,AUTO
         3 000153   000163 601000 3                  TNZ     s:1635
         3 000154   200031 234100                    SZN     ACCT,,AUTO
         3 000155   000163 604000 3                  TMI     s:1635
         3 000156   200030 234100                    SZN     PASS,,AUTO
         3 000157   000163 604000 3                  TMI     s:1635

      147     1634    2                  THEN EQUAL_ONLY = '1'B;

   1634  3 000160   400000 236003                    LDQ     -131072,DU
         3 000161   200035 756100                    STQ     EQUAL_ONLY,,AUTO
         3 000162   000164 710000 3                  TRA     s:1636

      148     1635    2                  ELSE EQUAL_ONLY = '0'B;

   1635  3 000163   200035 450100                    STZ     EQUAL_ONLY,,AUTO

      149     1636    2               SPACE = SUBSTR(SPACE2,0,I) ;

   1636  3 000164   000000 621005                    EAX1    0,AL
         3 000165   040000 100540                    MLR     fill='040'O
         3 000166   200006 000011                    ADSC9   SPACE2,,AUTO             cn=0,n=*X1
         3 000167   000002 000074 1                  ADSC9   SPACE                    cn=0,n=60
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:21   

      150     1637    2               LEN = I; /* if I=0 then user Didn't specify a PSN */

   1637  3 000170   200025 235100                    LDA     I,,AUTO
         3 000171   200032 755100                    STA     LEN,,AUTO

      151     1638
      152     1639    2               IF (I=0) AND (NOT ACCT) /* User wants CURR ACCT */ AND

   1639  3 000172   000244 601000 3                  TNZ     s:1651
         3 000173   200031 234100                    SZN     ACCT,,AUTO
         3 000174   000244 604000 3                  TMI     s:1651
         3 000175   040000 106400                    CMPC    fill='040'O
         3 000176   000001 000006 xsym               ADSC9   CURR_FILE_SN+1           cn=0,n=6
         3 000177   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000200   000244 600000 3                  TZE     s:1651

      153     1640    2   /* We have a PSN */ (CURR_FILE_SN.SN ~= ' ') THEN /* Must MERGE PSN */
      154     1641    3                  DO;

      155     1642    3                  TEMP = CURR_FILE_SN.SN; /* Move to an 8 char var */

   1642  3 000201   040100 100400                    MLR     fill='040'O
         3 000202   000001 000006 xsym               ADSC9   CURR_FILE_SN+1           cn=0,n=6
         3 000203   200033 000010                    ADSC9   TEMP,,AUTO               cn=0,n=8

      156     1643    3                  CALL STR_TO_TEXTC(SUB_BUF_1,TEMP);

   1643  3 000204   200033 631500                    EPPR1   TEMP,,AUTO
         3 000205   200070 451500                    STP1    @TEXTC+1,,AUTO
         3 000206   000005 236000 4                  LDQ     5
         3 000207   200067 756100                    STQ     FID_FPT+25,,AUTO
         3 000210   000646 701000 3                  TSX1    STR_TO_TEXTC
         3 000211   000000 011000                    NOP     0

      157     1644    3                  CALL CONCAT(SPACE,'DP#',

PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:22   
   1644  3 000212   000000 236000 xsym               LDQ     SUB_BUF_1
         3 000213   000033 772000                    QRL     27
         3 000214   000000 620006                    EAX0    0,QL
         3 000215   000034 236000 2                  LDQ     FID_FPT_C+28
         3 000216   000006 376000 4                  ANQ     6
         3 000217   000040 276007                    ORQ     32,DL
         3 000220   000002 756000 1                  STQ     SPACE
         3 000221   040000 100440                    MLR     fill='040'O
         3 000222   000000 200010 xsym               ADSC9   SUB_BUF_1                cn=1,n=*X0
         3 000223   000002 600071 1                  ADSC9   SPACE                    cn=3,n=57
         3 000224   000000 636010                    EAQ     0,X0
         3 000225   000022 772000                    QRL     18
         3 000226   000071 116007                    CMPQ    57,DL
         3 000227   000240 603000 3                  TRC     s:1647
         3 000230   200072 740100                    STX0    X+1,,AUTO
         3 000231   777706 620010                    EAX0    -58,X0
         3 000232   777777 660003                    ERX0    -1,DU
         3 000233   200072 235100                    LDA     X+1,,AUTO
         3 000234   000022 771000                    ARL     18
         3 000235   040045 100400                    MLR     fill='040'O
         3 000236   000007 000001 4                  ADSC9   7                        cn=0,n=1
         3 000237   000002 600010 1                  ADSC9   SPACE,A                  cn=3,n=*X0

      158     1645    3                              SUBSTR(SUB_BUF_1.TEXT,0,SUB_BUF_1.COUNT),
      159     1646    3                              '/');
      160     1647    3                  LEN = 4+SUB_BUF_1.COUNT;

   1647  3 000240   000000 236000 xsym               LDQ     SUB_BUF_1
         3 000241   000033 772000                    QRL     27
         3 000242   000004 036007                    ADLQ    4,DL
         3 000243   200032 756100                    STQ     LEN,,AUTO

      161     1648    3                  END;

      162     1649
      163     1650                    /* Now move the current file name */
      164     1651    2               CALL INSERT(SPACE,LEN,,CURR_FILE_NAME.TEXT) ;
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:23   

   1651  3 000244   000000 236000 xsym               LDQ     CURR_FILE_NAME
         3 000245   000033 772000                    QRL     27
         3 000246   200032 720100                    LXL0    LEN,,AUTO
         3 000247   777703 620010                    EAX0    -61,X0
         3 000250   777777 660003                    ERX0    -1,DU
         3 000251   000000 621006                    EAX1    0,QL
         3 000252   200032 235100                    LDA     LEN,,AUTO
         3 000253   040045 100440                    MLR     fill='040'O
         3 000254   000000 200011 xsym               ADSC9   CURR_FILE_NAME           cn=1,n=*X1
         3 000255   000002 000010 1                  ADSC9   SPACE,A                  cn=0,n=*X0

      165     1652    2               LEN = LEN + CURR_FILE_NAME.COUNT;

   1652  3 000256   200032 036100                    ADLQ    LEN,,AUTO
         3 000257   200032 756100                    STQ     LEN,,AUTO

      166     1653
      167     1654    3               IF (~ ACCT) THEN DO;/* We have to specify it for them */

   1654  3 000260   200031 236100                    LDQ     ACCT,,AUTO
         3 000261   400000 376003                    ANQ     -131072,DU
         3 000262   400000 676003                    ERQ     -131072,DU
         3 000263   000342 600000 3                  TZE     s:1666

      168     1655    3                  CALL STR_TO_TEXTC(SUB_BUF_1,CURR_FILE_ACCT);

   1655  3 000264   000010 236000 4                  LDQ     8
         3 000265   200070 756100                    STQ     @TEXTC+1,,AUTO
         3 000266   000005 236000 4                  LDQ     5
         3 000267   200067 756100                    STQ     FID_FPT+25,,AUTO
         3 000270   000646 701000 3                  TSX1    STR_TO_TEXTC
         3 000271   000000 011000                    NOP     0

      169     1656    3                  CALL INSERT(SPACE,LEN,,'.',

   1656  3 000272   000000 236000 xsym               LDQ     SUB_BUF_1
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:24   
         3 000273   000033 772000                    QRL     27
         3 000274   200032 720100                    LXL0    LEN,,AUTO
         3 000275   777703 620010                    EAX0    -61,X0
         3 000276   777777 660003                    ERX0    -1,DU
         3 000277   200032 235100                    LDA     LEN,,AUTO
         3 000300   040045 100400                    MLR     fill='040'O
         3 000301   000004 000001 4                  ADSC9   4                        cn=0,n=1
         3 000302   000002 000010 1                  ADSC9   SPACE,A                  cn=0,n=*X0
         3 000303   000000 621006                    EAX1    0,QL
         3 000304   200032 236100                    LDQ     LEN,,AUTO
         3 000305   000073 116007                    CMPQ    59,DL
         3 000306   000314 605000 3                  TPL     s:1658
         3 000307   777704 622006                    EAX2    -60,QL
         3 000310   777777 662003                    ERX2    -1,DU
         3 000311   040046 100440                    MLR     fill='040'O
         3 000312   000000 200011 xsym               ADSC9   SUB_BUF_1                cn=1,n=*X1
         3 000313   000002 200012 1                  ADSC9   SPACE,Q                  cn=1,n=*X2

      170     1657    3                              SUBSTR(SUB_BUF_1.TEXT,0,SUB_BUF_1.COUNT));
      171     1658    3                  LEN = LEN + SUB_BUF_1.COUNT + 1 ;

   1658  3 000314   000000 236000 xsym               LDQ     SUB_BUF_1
         3 000315   000033 772000                    QRL     27
         3 000316   200032 036100                    ADLQ    LEN,,AUTO
         3 000317   000001 036007                    ADLQ    1,DL
         3 000320   200032 756100                    STQ     LEN,,AUTO

      172     1659    4                  IF (PASS) THEN DO;  /* We must merge in there password  */

   1659  3 000321   200030 234100                    SZN     PASS,,AUTO
         3 000322   000361 605000 3                  TPL     s:1670

      173     1660    4                     CALL INSERT (SPACE,LEN,,SUBSTR(SPACE2,J,STRLEN - J)) ;

   1660  3 000323   200026 236100                    LDQ     STRLEN,,AUTO
         3 000324   200027 136100                    SBLQ    J,,AUTO
         3 000325   200032 720100                    LXL0    LEN,,AUTO
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:25   
         3 000326   777703 620010                    EAX0    -61,X0
         3 000327   777777 660003                    ERX0    -1,DU
         3 000330   000000 621006                    EAX1    0,QL
         3 000331   200027 235100                    LDA     J,,AUTO
         3 000332   200032 236100                    LDQ     LEN,,AUTO
         3 000333   040046 100545                    MLR     fill='040'O
         3 000334   200006 000011                    ADSC9   SPACE2,A,AUTO            cn=0,n=*X1
         3 000335   000002 000010 1                  ADSC9   SPACE,Q                  cn=0,n=*X0

      174     1661    4                     LEN = LEN + STRLEN - J ;

   1661  3 000336   200026 036100                    ADLQ    STRLEN,,AUTO
         3 000337   200027 136100                    SBLQ    J,,AUTO
         3 000340   200032 756100                    STQ     LEN,,AUTO

      175     1662    4                     END;

      176     1663    3                  END;

   1663  3 000341   000361 710000 3                  TRA     s:1670

      177     1664    3               ELSE DO;/* User specified the ACCOUNT go merge it in          */

      178     1665                     /* This also Merges the password in if the user specified one */
      179     1666    3                  CALL INSERT (SPACE,LEN,,SUBSTR(SPACE2,I+1,STRLEN-I-1)) ;

   1666  3 000342   200026 236100                    LDQ     STRLEN,,AUTO
         3 000343   200025 136100                    SBLQ    I,,AUTO
         3 000344   777777 620006                    EAX0    -1,QL
         3 000345   200032 722100                    LXL2    LEN,,AUTO
         3 000346   777703 622012                    EAX2    -61,X2
         3 000347   777777 662003                    ERX2    -1,DU
         3 000350   200025 235100                    LDA     I,,AUTO
         3 000351   200032 236100                    LDQ     LEN,,AUTO
         3 000352   040046 100545                    MLR     fill='040'O
         3 000353   200006 200010                    ADSC9   SPACE2,A,AUTO            cn=1,n=*X0
         3 000354   000002 000012 1                  ADSC9   SPACE,Q                  cn=0,n=*X2
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:26   

      180     1667    3                  LEN = LEN + STRLEN - I - 1  ;

   1667  3 000355   200026 036100                    ADLQ    STRLEN,,AUTO
         3 000356   200025 136100                    SBLQ    I,,AUTO
         3 000357   000001 136007                    SBLQ    1,DL
         3 000360   200032 756100                    STQ     LEN,,AUTO

      181     1668    3                  END;

      182     1669
      183     1670    3               IF (EQUAL_ONLY) THEN DO;/* The only time we assume PASSWORD */

   1670  3 000361   200035 234100                    SZN     EQUAL_ONLY,,AUTO
         3 000362   000423 605000 3                  TPL     s:1679

      184     1671    3                  CALL STR_TO_TEXTC(SUB_BUF_1,CURR_FILE_PASS);

   1671  3 000363   000011 236000 4                  LDQ     9
         3 000364   200070 756100                    STQ     @TEXTC+1,,AUTO
         3 000365   000005 236000 4                  LDQ     5
         3 000366   200067 756100                    STQ     FID_FPT+25,,AUTO
         3 000367   000646 701000 3                  TSX1    STR_TO_TEXTC
         3 000370   000000 011000                    NOP     0

      185     1672    4                  IF (SUB_BUF_1.COUNT > 0) THEN DO; /* If Pass ~=' ' merge */

   1672  3 000371   000000 236000 xsym               LDQ     SUB_BUF_1
         3 000372   777000 316003                    CANQ    -512,DU
         3 000373   000423 600000 3                  TZE     s:1679

      186     1673    4                     CALL INSERT(SPACE,LEN,,'.',

   1673  3 000374   000000 236000 xsym               LDQ     SUB_BUF_1
         3 000375   000033 772000                    QRL     27
         3 000376   200032 720100                    LXL0    LEN,,AUTO
         3 000377   777703 620010                    EAX0    -61,X0
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:27   
         3 000400   777777 660003                    ERX0    -1,DU
         3 000401   200032 235100                    LDA     LEN,,AUTO
         3 000402   040045 100400                    MLR     fill='040'O
         3 000403   000004 000001 4                  ADSC9   4                        cn=0,n=1
         3 000404   000002 000010 1                  ADSC9   SPACE,A                  cn=0,n=*X0
         3 000405   000000 621006                    EAX1    0,QL
         3 000406   200032 236100                    LDQ     LEN,,AUTO
         3 000407   000073 116007                    CMPQ    59,DL
         3 000410   000416 605000 3                  TPL     s:1675
         3 000411   777704 622006                    EAX2    -60,QL
         3 000412   777777 662003                    ERX2    -1,DU
         3 000413   040046 100440                    MLR     fill='040'O
         3 000414   000000 200011 xsym               ADSC9   SUB_BUF_1                cn=1,n=*X1
         3 000415   000002 200012 1                  ADSC9   SPACE,Q                  cn=1,n=*X2

      187     1674    4                                 SUBSTR(SUB_BUF_1.TEXT,0,SUB_BUF_1.COUNT));
      188     1675    4                     LEN = LEN + SUB_BUF_1.COUNT + 1 ;

   1675  3 000416   000000 236000 xsym               LDQ     SUB_BUF_1
         3 000417   000033 772000                    QRL     27
         3 000420   200032 036100                    ADLQ    LEN,,AUTO
         3 000421   000001 036007                    ADLQ    1,DL
         3 000422   200032 756100                    STQ     LEN,,AUTO

      189     1676    4                     END;

      190     1677    3                  END;

      191     1678
      192     1679    2               SPACE2 = SPACE;

   1679  3 000423   040100 100400                    MLR     fill='040'O
         3 000424   000002 000074 1                  ADSC9   SPACE                    cn=0,n=60
         3 000425   200006 000074                    ADSC9   SPACE2,,AUTO             cn=0,n=60

      193     1680    2               CALL FILL_SUB_BUF;

PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:28   
   1680  3 000426   000536 701000 3                  TSX1    FILL_SUB_BUF
         3 000427   000000 011000                    NOP     0

      194     1681    2               CALL VEX$ERROR(E$TELLFIDNAME,1) ;

   1681  3 000430   000013 630400 4                  EPPR0   11
         3 000431   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000432   000000 701000 xent               TSX1    VEX$ERROR
         3 000433   000000 011000                    NOP     0

      195     1682        /**/
      196     1683        /*E*      ERROR:        VEE-E$TELLFIDNAME-0
      197     1684                  MESSAGE:      %U1%U2 used as %U3 file.
      198     1685                  DESCRIPTION:  Tell the user what EDIT thinks the = meant.
      199     1686        */
      200     1687    2               END;   /* WHENRETURN */

      201     1688    1            FID_FPT = FID_FPT_C;

   1688  3 000434   000100 100400                    MLR     fill='000'O
         3 000435   000000 000140 2                  ADSC9   FID_FPT_C                cn=0,n=96
         3 000436   200036 000140                    ADSC9   FID_FPT,,AUTO            cn=0,n=96

      202     1689    1           CALL M$FID(FID_FPT) ALTRET (FID_ERR);

   1689  3 000437   200036 630500                    EPPR0   FID_FPT,,AUTO
         3 000440   420001 713400                    CLIMB   alt,+8193
         3 000441   404400 401760                    pmme    nvectors=10
         3 000442   000527 702000 3                  TSX2    FID_ERR

      203     1690        /**/
      204     1691    1           IF (FID_RESULTS.ACCT)

   1691  3 000443   000022 236000 1                  LDQ     FID_RESULTS
         3 000444   200000 316003                    CANQ    65536,DU
         3 000445   000452 600000 3                  TZE     s:1693

PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:29   
      205     1692    1               THEN OPEN_FPT.ACCT_ = VECTOR(OPEN_FILE_ACCT) ;

   1692  3 000446   000016 237000 4                  LDAQ    14
         3 000447   200004 470500                    LDP0    @OPEN_FPT,,AUTO
         3 000450   000024 757100                    STAQ    20,,PR0
         3 000451   000455 710000 3                  TRA     s:1694

      206     1693    1               ELSE OPEN_FPT.ACCT_ = VECTOR(NIL) ;

   1693  3 000452   000020 237000 4                  LDAQ    16
         3 000453   200004 470500                    LDP0    @OPEN_FPT,,AUTO
         3 000454   000024 757100                    STAQ    20,,PR0

      207     1694    1           IF (FID_RESULTS.PASS)

   1694  3 000455   000022 236000 1                  LDQ     FID_RESULTS
         3 000456   100000 316003                    CANQ    32768,DU
         3 000457   000463 600000 3                  TZE     s:1696

      208     1695    1               THEN OPEN_FPT.PASS_ = VECTOR(OPEN_FILE_PASS) ;

   1695  3 000460   000022 237000 4                  LDAQ    18
         3 000461   000010 757100                    STAQ    8,,PR0
         3 000462   000465 710000 3                  TRA     s:1697

      209     1696    1               ELSE OPEN_FPT.PASS_ = VECTOR(ERASE) ;

   1696  3 000463   000024 237000 4                  LDAQ    20
         3 000464   000010 757100                    STAQ    8,,PR0

      210     1697    1           IF (FID_RESULTS.SN)

   1697  3 000465   000022 236000 1                  LDQ     FID_RESULTS
         3 000466   040000 316003                    CANQ    16384,DU
         3 000467   000473 600000 3                  TZE     s:1699

      211     1698    1               THEN OPEN_FPT.SN_ = VECTOR(OPEN_FILE_SN) ;
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:30   

   1698  3 000470   000026 237000 4                  LDAQ    22
         3 000471   000002 757100                    STAQ    2,,PR0
         3 000472   000475 710000 3                  TRA     s:1700

      212     1699    1               ELSE OPEN_FPT.SN_ = VECTOR(NIL) ;

   1699  3 000473   000020 237000 4                  LDAQ    16
         3 000474   000002 757100                    STAQ    2,,PR0

      213     1700    1           IF (FID_ASN = %FILE#) THEN RETURN;

   1700  3 000475   000000 236000 1                  LDQ     FID_ASN
         3 000476   777000 376003                    ANQ     -512,DU
         3 000477   001000 116003                    CMPQ    512,DU
         3 000500   000502 601000 3                  TNZ     s:1701

   1700  3 000501   000000 702200 xent               TSX2  ! X66_ARET

      214     1701    1            IF FID_ASN = %DEVICE# AND

   1701  3 000502   003000 116003                    CMPQ    1536,DU
         3 000503   000527 601000 3                  TNZ     FID_ERR
         3 000504   000022 236000 1                  LDQ     FID_RESULTS
         3 000505   004000 316003                    CANQ    2048,DU
         3 000506   000527 600000 3                  TZE     FID_ERR
         3 000507   040000 106400                    CMPC    fill='040'O
         3 000510   000001 000004 1                  ADSC9   FID_RES                  cn=0,n=4
         3 000511   000035 000002 2                  ADSC9   FID_FPT_C+29             cn=0,n=2
         3 000512   000517 600000 3                  TZE     s:1701+13
         3 000513   040000 106400                    CMPC    fill='040'O
         3 000514   000001 000004 1                  ADSC9   FID_RES                  cn=0,n=4
         3 000515   000036 000002 2                  ADSC9   FID_FPT_C+30             cn=0,n=2
         3 000516   000527 601000 3                  TNZ     FID_ERR
         3 000517   200005 471500                    LDP1    @DEVICE_OK,,AUTO
         3 000520   100000 235100                    LDA     0,,PR1
         3 000521   000527 600000 3                  TZE     FID_ERR
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:31   

      215     1702    1                  FID_RESULTS.RES AND
      216     1703    1                  (FID_RES = 'UC' OR FID_RES = 'ME') AND
      217     1704    1                  DEVICE_OK ~=0
      218     1705    1             THEN
      219     1706    2             DO;

      220     1707    2                  OPEN_FPT.V.RES# = FID_RES;

   1707  3 000522   000001 236000 1                  LDQ     FID_RES
         3 000523   000050 756100                    STQ     40,,PR0

      221     1708    2                  OPEN_FPT.V.ASN# = %DEVICE#;

   1708  3 000524   000003 236007                    LDQ     3,DL
         3 000525   000045 552104                    STBQ    37,'04'O,PR0

      222     1709    2                  RETURN;

   1709  3 000526   000000 702200 xent               TSX2  ! X66_ARET

      223     1710    2                  END;
      224     1711    1   FID_ERR:
      225     1712    1           CALL FILL_SUB_BUF;

   1712  3 000527   000536 701000 3     FID_ERR      TSX1    FILL_SUB_BUF
         3 000530   000000 011000                    NOP     0

      226     1713    1           CALL VEX$ERROR(E$E_BADFID,3);

   1713  3 000531   000031 630400 4                  EPPR0   25
         3 000532   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000533   000000 701000 xent               TSX1    VEX$ERROR
         3 000534   000000 011000                    NOP     0

      227     1714    1           ALTRETURN;

PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:32   
   1714  3 000535   000000 702200 xent               TSX2  ! X66_AALT

      228     1715        /**/
      229     1716        /*E*     ERROR:    VEE-E$E_BADFID-0
      230     1717                 MESSAGE:  Illegal file identifier
      231     1718                 MESSAGE1: %U1%U2 is not a legal file identifier for %U3
      232     1719                 DESCRIPTION: An illegal file identifier was input.
      233     1720        */
      234     1721    1   FILL_SUB_BUF: PROC;

   1721  3 000536   200066 741300       FILL_SUB_BUF STX1  ! FID_FPT+24,,AUTO

      235     1722
      236     1723    2   DCL X UBIN AUTO;
      237     1724
      238     1725    3       CALL INDEX(X,'.',SPACE2) WHENRETURN DO;

   1725  3 000537   000000 124500                    SCM     mask='000'O
         3 000540   200006 000074                    ADSC9   SPACE2,,AUTO             cn=0,n=60
         3 000541   000004 000001 4                  ADSC9   4                        cn=0,n=1
         3 000542   200067 000100                    ARG     X,,AUTO
         3 000543   000567 606400 3                  TTN     s:1731

      239     1726    4          CALL INDEX (X,'.',SPACE2,X+1)  WHENRETURN DO; /* Blank Password */

   1726  3 000544   200067 720100                    LXL0    X,,AUTO
         3 000545   777704 620010                    EAX0    -60,X0
         3 000546   777777 660003                    ERX0    -1,DU
         3 000547   200067 236100                    LDQ     X,,AUTO
         3 000550   000001 036007                    ADLQ    1,DL
         3 000551   200067 235100                    LDA     X,,AUTO
         3 000552   000000 124545                    SCM     mask='000'O
         3 000553   200006 200010                    ADSC9   SPACE2,A,AUTO            cn=1,n=*X0
         3 000554   000004 000001 4                  ADSC9   4                        cn=0,n=1
         3 000555   200067 000100                    ARG     X,,AUTO
         3 000556   200067 056100                    ASQ     X,,AUTO
         3 000557   000567 606400 3                  TTN     s:1731
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:33   

      240     1727    4              SUBSTR(SPACE2,X+1,LEN-X-1) = '********';

   1727  3 000560   200032 236100                    LDQ     LEN,,AUTO
         3 000561   200067 136100                    SBLQ    X,,AUTO
         3 000562   777777 620006                    EAX0    -1,QL
         3 000563   200067 235100                    LDA     X,,AUTO
         3 000564   040145 100400                    MLR     fill='040'O
         3 000565   000037 000010 2                  ADSC9   FID_FPT_C+31             cn=0,n=8
         3 000566   200006 200010                    ADSC9   SPACE2,A,AUTO            cn=1,n=*X0

      241     1728    4              END;

      242     1729    3          END;

      243     1730
      244     1731    3       IF (LEN < 31) THEN DO;

   1731  3 000567   200032 235100                    LDA     LEN,,AUTO
         3 000570   000037 115007                    CMPA    31,DL
         3 000571   000607 605000 3                  TPL     s:1738

      245     1732    3         SUB_BUF_1.TEXT = SUBSTR(SPACE2,0,LEN) ;

   1732  3 000572   000000 620005                    EAX0    0,AL
         3 000573   040000 100540                    MLR     fill='040'O
         3 000574   200006 000010                    ADSC9   SPACE2,,AUTO             cn=0,n=*X0
         3 000575   000000 200037 xsym               ADSC9   SUB_BUF_1                cn=1,n=31

      246     1733    3         SUB_BUF_1.COUNT = LEN ;

   1733  3 000576   200032 236100                    LDQ     LEN,,AUTO
         3 000577   000033 736000                    QLS     27
         3 000600   000000 552040 xsym               STBQ    SUB_BUF_1,'40'O

      247     1734    3         SUB_BUF_2.TEXT = ' ' ;

PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:34   
   1734  3 000601   040000 100400                    MLR     fill='040'O
         3 000602   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000603   000000 200037 xsym               ADSC9   SUB_BUF_2                cn=1,n=31

      248     1735    3         SUB_BUF_2.COUNT = 1 ;

   1735  3 000604   001000 236003                    LDQ     512,DU
         3 000605   000000 552040 xsym               STBQ    SUB_BUF_2,'40'O

      249     1736    3         END;

   1736  3 000606   000624 710000 3                  TRA     s:1745

      250     1737    3       ELSE DO;

      251     1738    3         SUB_BUF_1.TEXT = SUBSTR(SPACE2,0,31) ;

   1738  3 000607   040000 100500                    MLR     fill='040'O
         3 000610   200006 000037                    ADSC9   SPACE2,,AUTO             cn=0,n=31
         3 000611   000000 200037 xsym               ADSC9   SUB_BUF_1                cn=1,n=31

      252     1739    3         SUB_BUF_1.COUNT = 31 ;

   1739  3 000612   037000 236003                    LDQ     15872,DU
         3 000613   000000 552040 xsym               STBQ    SUB_BUF_1,'40'O

      253     1740    3         SUB_BUF_2.TEXT = SUBSTR(SPACE2,31,LEN-31) ;

   1740  3 000614   777741 620005                    EAX0    -31,AL
         3 000615   040000 100540                    MLR     fill='040'O
         3 000616   200015 600010                    ADSC9   SPACE2+7,,AUTO           cn=3,n=*X0
         3 000617   000000 200037 xsym               ADSC9   SUB_BUF_2                cn=1,n=31

      254     1741    3         SUB_BUF_2.COUNT = LEN - 31 ;

   1741  3 000620   200032 236100                    LDQ     LEN,,AUTO
         3 000621   000037 136007                    SBLQ    31,DL
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:35   
         3 000622   000033 736000                    QLS     27
         3 000623   000000 552040 xsym               STBQ    SUB_BUF_2,'40'O

      255     1742    3         END;

      256     1743
      257     1744
      258     1745    2       IF  OPEN_FPT.V.DCB# = M$FILE_NUM THEN

   1745  3 000624   200004 470500                    LDP0    @OPEN_FPT,,AUTO
         3 000625   000044 236100                    LDQ     36,,PR0
         3 000626   000022 772000                    QRL     18
         3 000627   000000 116000 xsym               CMPQ    M$FILE_NUM
         3 000630   000637 601000 3                  TNZ     s:1751

      259     1746    3       DO;

      260     1747    3         SUB_BUF_3.COUNT = 4;

   1747  3 000631   004000 236003                    LDQ     2048,DU
         3 000632   000000 552040 xsym               STBQ    SUB_BUF_3,'40'O

      261     1748    3         SUB_BUF_3.TEXT = 'edit';

   1748  3 000633   040000 100400                    MLR     fill='040'O
         3 000634   000041 000004 2                  ADSC9   FID_FPT_C+33             cn=0,n=4
         3 000635   000000 200037 xsym               ADSC9   SUB_BUF_3                cn=1,n=31

      262     1749    3         END;

   1749  3 000636   000644 710000 3                  TRA     s:1754

      263     1750    3       ELSE DO;

      264     1751    3         SUB_BUF_3.COUNT = 6;

   1751  3 000637   006000 236003                    LDQ     3072,DU
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:36   
         3 000640   000000 552040 xsym               STBQ    SUB_BUF_3,'40'O

      265     1752    3         SUB_BUF_3.TEXT = 'output';

   1752  3 000641   040000 100400                    MLR     fill='040'O
         3 000642   000042 000006 2                  ADSC9   FID_FPT_C+34             cn=0,n=6
         3 000643   000000 200037 xsym               ADSC9   SUB_BUF_3                cn=1,n=31

      266     1753    3         END;

      267     1754    2   END FILL_SUB_BUF;

   1754  3 000644   200066 221300                    LDX1  ! FID_FPT+24,,AUTO
         3 000645   000001 702211                    TSX2  ! 1,X1

      268     1755
      269     1756    1   STR_TO_TEXTC: PROC (TEXTC,STR) ;

   1756  3 000646   200066 741300       STR_TO_TEXTC STX1  ! FID_FPT+24,,AUTO

      270     1757
      271     1758    2   DCL 1 TEXTC PARAM,
      272     1759    2         2  COUNT UBIN(9) UNAL,
      273     1760    2         2  TEXT  CHAR(TEXTC.COUNT) UNAL ;
      274     1761
      275     1762    2   DCL STR CHAR(8) PARAM;
      276     1763
      277     1764    2   DCL X UBIN AUTO;
      278     1765
      279     1766    2       CALL INDEX (X,' ',STR) ;

   1766  3 000647   200070 470500                    LDP0    @STR,,AUTO
         3 000650   000000 124500                    SCM     mask='000'O
         3 000651   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         3 000652   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000653   200071 000100                    ARG     X,,AUTO

PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:37   
      280     1767    2       TEXTC.COUNT = X;

   1767  3 000654   200067 471500                    LDP1    @TEXTC,,AUTO
         3 000655   000100 101500                    MRL     fill='000'O
         3 000656   200071 000004                    ADSC9   X,,AUTO                  cn=0,n=4
         3 000657   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

      281     1768    2       TEXTC.TEXT = STR ;

   1768  3 000660   000100 101500                    MRL     fill='000'O
         3 000661   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         3 000662   200072 000002                    ADSC9   X+1,,AUTO                cn=0,n=2
         3 000663   200072 220100                    LDX0    X+1,,AUTO
         3 000664   040140 100500                    MLR     fill='040'O
         3 000665   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         3 000666   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0

      282     1769
      283     1770    2   END STR_TO_TEXTC;

   1770  3 000667   200066 221300                    LDX1  ! FID_FPT+24,,AUTO
         3 000670   000001 702211                    TSX2  ! 1,X1
      284     1771    1   END;

PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:38   
--  Include file information  --

   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   VE_PERR_C.:E05TOU  is referenced.
   VE_SUBS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VEX$FID_2_FPT.
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:39   

 **** Variables and constants ****

  ****  Section 001  Data  VEX$FID_2_FPT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN(9)     r     1 FID_ASN                    1-0-0/c CHAR(4)     r     1 FID_RES
    22-0-0/d STRC(324)   r     1 FID_RESULTS                2-0-0/c CHAR(60)    r     1 SPACE

  ****  Section 002 RoData VEX$FID_2_FPT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(864)   r     1 FID_FPT_C

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w PTR         r     1 @DEVICE_OK                 4-0-0/w PTR         r     1 @OPEN_FPT
     3-0-0/w PTR         r     1 @PTR$                     70-0-0/w PTR         r     1 @STR
    67-0-0/w PTR         r     1 @TEXTC                    31-0-0/b BIT         r     1 ACCT
    *0-0-0/w UBIN        r     1 DEVICE_OK                 35-0-0/w BIT         r     1 EQUAL_ONLY
    36-0-0/d STRC(864)   r     1 FID_FPT                   25-0-0/w SBIN        r     1 I
    27-0-0/w SBIN        r     1 J                         32-0-0/w SBIN        r     1 LEN
    *0-0-0/d STRC(2088)  r     1 OPEN_FPT                  30-0-0/b BIT         r     1 PASS
    *0-0-0/w PTR         r     1 PTR$                       6-0-0/c CHAR(60)    r     1 SPACE2
    *0-0-0/c CHAR(8)     r     1 STR                       26-0-0/w SBIN        r     1 STRLEN
    33-0-0/c CHAR(8)     r     1 TEMP                      *0-0-0/c ASTR(9)     r     1 TEXTC
    67-0-0/w UBIN        r     1 X                         71-0-0/w UBIN        r     1 X

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:40   
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/c CHAR(8)     r     1 CURR_FILE_ACCT
     0-0-0/c ASTR(9)     r     1 CURR_FILE_NAME             0-0-0/c CHAR(8)     r     1 CURR_FILE_PASS
     0-0-0/w STRC(90)    r     1 CURR_FILE_SN               0-0-0/w UBIN        r     1 M$FILE_NUM
     0-0-0/c CHAR(8)     r     1 OPEN_FILE_ACCT             0-0-0/c STRC(288)   r     1 OPEN_FILE_NAME
     0-0-0/c CHAR(8)     r     1 OPEN_FILE_PASS             0-0-0/w STRC(90)    r     1 OPEN_FILE_SN
     0-0-0/c STRC(288)   r     1 SUB_BUF_1                  0-0-0/c STRC(288)   r     1 SUB_BUF_2
     0-0-0/c STRC(288)   r     1 SUB_BUF_3

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w ASTR(9)     r     1 TEXTC


   Procedure VEX$FID_2_FPT requires 441 words for executable code.
   Procedure VEX$FID_2_FPT requires 60 words of local(AUTO) storage.

    No errors detected in file VEX$FID_2_FPT.:E05TSI    .
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:41   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:42   
          MINI XREF LISTING

ACCT
      1498**DCL      1624<<ASSIGN   1628<<ASSIGN   1631<<ASSIGN   1633>>IF       1639>>IF       1654>>IF
B$JIT.CPFLAGS1.SLEAZE
      1153**DCL      1153--REDEF
B$JIT.ERR.MID
      1060**DCL      1060--REDEF
B$JIT.JRESPEAK
      1221**DCL      1222--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      1330**DCL      1330--REDEF    1331--REDEF
B$JIT.PNR
      1234**DCL      1234--REDEF
B$JIT.TSLINE
      1328**DCL      1329--REDEF
B$JIT$
      1482**DCL      1054--IMP-PTR
CURR_FILE_ACCT
      1459**DCL      1603<<ASSIGN   1655<>CALL
CURR_FILE_NAME
      1456**DCL      1600<<ASSIGN
CURR_FILE_NAME.COUNT
      1457**DCL      1458--IMP-SIZ  1600>>ASSIGN   1610>>IF       1651>>CALLBLT  1652>>ASSIGN
CURR_FILE_NAME.TEXT
      1458**DCL      1610>>IF       1651>>CALLBLT
CURR_FILE_PASS
      1460**DCL      1604<<ASSIGN   1671<>CALL
CURR_FILE_SN
      1461**DCL      1602<<ASSIGN
CURR_FILE_SN.COUNT
      1462**DCL      1601<<ASSIGN
CURR_FILE_SN.SN
      1463**DCL      1639>>IF       1642>>ASSIGN
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:43   
DEVICE_OK
      1340**DCL         8--PROC     1701>>IF
EQUAL_ONLY
      1501**DCL      1634<<ASSIGN   1635<<ASSIGN   1670>>IF
FID_ASN
      1487**DCL      1550--DCLINIT  1700>>IF       1701>>IF
FID_ERR
      1712**LABEL    1689--CALLALT
FID_FPT
      1516**DCL      1688<<ASSIGN   1689<>CALL
FID_FPT_C
      1547**DCL      1688>>ASSIGN
FID_FPT_C.V
      1551**DCL      1547--DCLINIT
FID_RES
      1488**DCL      1550--DCLINIT  1701>>IF       1701>>IF       1707>>ASSIGN
FID_RESULTS
      1570**DCL      1551--DCLINIT
FID_RESULTS.ACCT
      1570**DCL      1691>>IF
FID_RESULTS.PASS
      1570**DCL      1694>>IF
FID_RESULTS.RES
      1570**DCL      1701>>IF
FID_RESULTS.SN
      1570**DCL      1697>>IF
FILL_SUB_BUF
      1721**PROC     1680--CALL     1712--CALL
I
      1494**DCL      1593<<CALLBLT  1595>>IF       1605>>CALLBLT  1605>>CALLBLT  1630>>IF       1631>>IF
      1633>>IF       1636>>ASSIGN   1637>>ASSIGN   1639>>IF       1666>>CALLBLT  1666>>CALLBLT  1667>>ASSIGN
J
      1496**DCL      1625<<CALLBLT  1626>>IF       1630>>IF       1631>>IF       1660>>CALLBLT  1660>>CALLBLT
      1661>>ASSIGN
LEN
      1499**DCL      1591<<ASSIGN   1592>>ASSIGN   1637<<ASSIGN   1647<<ASSIGN   1651>>CALLBLT  1652<<ASSIGN
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:44   
      1652>>ASSIGN   1656>>CALLBLT  1658<<ASSIGN   1658>>ASSIGN   1660>>CALLBLT  1661<<ASSIGN   1661>>ASSIGN
      1666>>CALLBLT  1667<<ASSIGN   1667>>ASSIGN   1673>>CALLBLT  1675<<ASSIGN   1675>>ASSIGN   1727>>ASSIGN
      1731>>IF       1732>>ASSIGN   1733>>ASSIGN   1740>>ASSIGN   1741>>ASSIGN
M$FID
        85**DCL-ENT  1689--CALL
M$FILE_NUM
      1455**DCL      1745>>IF
OPEN_FILE_ACCT
      1467**DCL      1548--DCLINIT  1603>>ASSIGN   1692--ASSIGN
OPEN_FILE_NAME
      1464**DCL      1548--DCLINIT  1600>>ASSIGN
OPEN_FILE_PASS
      1468**DCL      1549--DCLINIT  1604>>ASSIGN   1695--ASSIGN
OPEN_FILE_SN
      1469**DCL      1549--DCLINIT  1602>>ASSIGN   1698--ASSIGN
OPEN_FPT
      1407**DCL         8--PROC
OPEN_FPT.ACCT_
      1411**DCL      1692<<ASSIGN   1693<<ASSIGN
OPEN_FPT.ACSVEH_
      1409**DCL      1410--REDEF
OPEN_FPT.ALTKEYS_
      1415**DCL      1416--REDEF    1416--REDEF
OPEN_FPT.HDR_
      1414**DCL      1415--REDEF
OPEN_FPT.PASS_
      1409**DCL      1695<<ASSIGN   1696<<ASSIGN
OPEN_FPT.SN_
      1407**DCL      1698<<ASSIGN   1699<<ASSIGN
OPEN_FPT.TAB_
      1413**DCL      1414--REDEF
OPEN_FPT.UHL_
      1407**DCL      1408--REDEF    1408--REDEF
OPEN_FPT.V.ASN#
      1426**DCL      1708<<ASSIGN
OPEN_FPT.V.DCB#
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:45   
      1416**DCL      1745>>IF
OPEN_FPT.V.FSN#
      1447**DCL      1447--REDEF    1447--REDEF
OPEN_FPT.V.RES#
      1431**DCL      1707<<ASSIGN
OPEN_FPT.WSN_
      1413**DCL      1413--REDEF
PASS
      1497**DCL      1624<<ASSIGN   1627<<ASSIGN   1630<<ASSIGN   1633>>IF       1659>>IF
PTR$
      1339**DCL         8--PROC     1589>>ASSIGN   1589>>ASSIGN   1591>>ASSIGN
SPACE
      1489**DCL      1547--DCLINIT  1589<<ASSIGN   1590>>ASSIGN   1605<<CALLBLT  1607>>ASSIGN   1636<<ASSIGN
      1644<<CALLBLT  1651<<CALLBLT  1656<<CALLBLT  1660<<CALLBLT  1666<<CALLBLT  1673<<CALLBLT  1679>>ASSIGN
SPACE2
      1493**DCL      1590<<ASSIGN   1593>>CALLBLT  1595>>IF       1605>>CALLBLT  1605>>CALLBLT  1607<<ASSIGN
      1625>>CALLBLT  1636>>ASSIGN   1660>>CALLBLT  1666>>CALLBLT  1679<<ASSIGN   1725>>CALLBLT  1726>>CALLBLT
      1727<<ASSIGN   1732>>ASSIGN   1738>>ASSIGN   1740>>ASSIGN
STR IN PROCEDURE STR_TO_TEXTC
      1762**DCL      1756--PROC     1766>>CALLBLT  1768>>ASSIGN
STRLEN
      1495**DCL      1592<<ASSIGN   1626>>IF       1660>>CALLBLT  1661>>ASSIGN   1666>>CALLBLT  1667>>ASSIGN
STR_TO_TEXTC
      1756**PROC     1643--CALL     1655--CALL     1671--CALL
SUB_BUF_1
      1472**DCL      1643<>CALL     1655<>CALL     1671<>CALL
SUB_BUF_1.COUNT
      1473**DCL      1644>>CALLBLT  1647>>ASSIGN   1656>>CALLBLT  1658>>ASSIGN   1672>>IF       1673>>CALLBLT
      1675>>ASSIGN   1733<<ASSIGN   1739<<ASSIGN
SUB_BUF_1.TEXT
      1474**DCL      1644>>CALLBLT  1656>>CALLBLT  1673>>CALLBLT  1732<<ASSIGN   1738<<ASSIGN
SUB_BUF_2.COUNT
      1476**DCL      1735<<ASSIGN   1741<<ASSIGN
SUB_BUF_2.TEXT
      1477**DCL      1734<<ASSIGN   1740<<ASSIGN
SUB_BUF_3.COUNT
PL6.E3A0      #001=VEX$FID_2_FPT File=VEX$FID_2_FPT.:E05TSI                      WED 07/30/97 07:12 Page:46   
      1479**DCL      1747<<ASSIGN   1751<<ASSIGN
SUB_BUF_3.TEXT
      1480**DCL      1748<<ASSIGN   1752<<ASSIGN
TEMP
      1500**DCL      1642<<ASSIGN   1643<>CALL
TEXTC.COUNT
      1583**DCL      1584--IMP-SIZ  1589>>ASSIGN   1591>>ASSIGN
TEXTC.TEXT
      1584**DCL      1589>>ASSIGN
TEXTC IN PROCEDURE STR_TO_TEXTC
      1758**DCL      1756--PROC
TEXTC.COUNT IN PROCEDURE STR_TO_TEXTC
      1759**DCL      1760--IMP-SIZ  1767<<ASSIGN   1768>>ASSIGN
TEXTC.TEXT IN PROCEDURE STR_TO_TEXTC
      1760**DCL      1768<<ASSIGN
VEX$ERROR
      1481**DCL-ENT  1612--CALL     1681--CALL     1713--CALL
X IN PROCEDURE FILL_SUB_BUF
      1723**DCL      1725<<CALLBLT  1726<<CALLBLT  1726>>CALLBLT  1727>>ASSIGN   1727>>ASSIGN
X IN PROCEDURE STR_TO_TEXTC
      1764**DCL      1766<<CALLBLT  1767>>ASSIGN
