VERSION E05

PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:1    
        1        1        /*M*     PCT$TABLES - Displays CONTROL parameters in tabular format */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*/
        8        8        PCT$TABLES: PROC(PCT_PARAM) ALTRET;
        9        9        /**/
       10       10    1   DCL PCT_PARAM UBIN WORD;
       11       11        /**/
       12       12        /*********************************************************************/
       13       13        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
       14       14        /*********************************************************************/
       15       15        /**/
       16       16        %INCLUDE PC_SUBS_C;
       17      348        %INCLUDE PC_PERR_C;
       18      381        %INCLUDE CP_6;
       19      462        %INCLUDE CP_6_SUBS;
       20     1002        %INCLUDE JM$STRUCT;
       21     1747        %INCLUDE B_SEGIDS_C;
       22     2286        /**/
       23     2287        %SUB PSURES_OFFSET = 4;
       24     2288        %SUB MMINDX = 0;
       25     2289        %EJECT;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:2    
       26     2290        /***************************************************************************/
       27     2291        /*   STATIC DATA   STATIC DATA   STATIC DATA   STATIC DATA   STATIC DATA   */
       28     2292        /***************************************************************************/
       29     2293        /**/
       30     2294    1   DCL MODEFLGS(0:%PC_MAXMODE) BIT(1) STATIC UNAL INIT(NO*0);
       31     2295    1   DCL PART#FLGS(0:15) BIT(1) STATIC UNAL INIT(NO*0);
       32     2296    1   DCL DOMAINFLGS(0:%PC_MAXDOMAIN) BIT(1) STATIC UNAL INIT(NO*0);
       33     2297        /**/
       34     2298    1   DCL FIRST_TIME BIT(1) STATIC;
       35     2299        /**/
       36     2300    1   DCL I SBIN WORD STATIC;
       37     2301    1   DCL J SBIN WORD STATIC;
       38     2302    1   DCL K SBIN WORD STATIC;
       39     2303        /**/
       40     2304    1   DCL TEMP$ PTR STATIC;
       41     2305        /**/
       42     2306    1   DCL CUR_MODE SBIN WORD STATIC;
       43     2307    1   DCL MAX_MODE SBIN WORD STATIC;
       44     2308    1   DCL CUR_DOMAIN SBIN WORD STATIC;
       45     2309    1   DCL MAX_DOMAIN SBIN WORD STATIC;
       46     2310    1   DCL CUR_TABLE SBIN WORD STATIC;
       47     2311    1   DCL MAX_TABLE SBIN WORD STATIC;
       48     2312    1   DCL RES_INDX SBIN WORD STATIC;
       49     2313    1   DCL CUR_RESINDX SBIN WORD STATIC;
       50     2314    1   DCL MAX_RESINDX SBIN WORD STATIC;
       51     2315    1   DCL RESLO SBIN WORD STATIC;
       52     2316    1   DCL RESHI SBIN WORD STATIC;
       53     2317    1   DCL MAX_CLMN SBIN WORD STATIC;
       54     2318    1   DCL PLATEN SBIN WORD STATIC;
       55     2319    1   DCL VALUE SBIN WORD STATIC;
       56     2320        /**/
       57     2321    1   DCL 1 TBL_PRBUF STATIC,
       58     2322    1         2 NAME CHAR(12) UNAL INIT(' '),
       59     2323    1         2 CLMN(0:11) CHAR(10) UNAL INIT(' '*0);
       60     2324    1   DCL TBL_PRBUFCHAR REDEF TBL_PRBUF CHAR(132);
       61     2325    1   DCL 1 DISP_TBL STATIC,
       62     2326    1         2 INDX UBIN WORD,
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:3    
       63     2327    1         2 PARM(0:99) ALIGNED,
       64     2328    1           3 CAT UBIN(9) UNAL,
       65     2329    1           3 PARM UBIN(9) UNAL,
       66     2330    1           3 INDEXLO UBIN(9) UNAL,
       67     2331    1           3 INDEXHI UBIN(9) UNAL,
       68     2332    1           3 RESINDX SBIN HALF UNAL;
       69     2333    1   DCL 1 XLATE_TBL STATIC,
       70     2334    1         2 DASH1(0:31) CHAR(1) UNAL INIT('-'*0),
       71     2335    1         2 SPACE CHAR(1) UNAL INIT(' '),
       72     2336    1         2 DASH2(0:94) CHAR(1) UNAL INIT('-'*0);
       73     2337        %EJECT;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:4    
       74     2338        /**********************************************************************/
       75     2339        /*   BASED DATA   BASED DATA   BASED DATA   BASED DATA   BASED DATA   */
       76     2340        /**********************************************************************/
       77     2341        /**/
       78     2342        %F$DCB;
       79     2399        %JM_PART (FPTN=JM$PT,STCLASS=BASED);
       80     2454        /**/
       81     2455    1   DCL 1 P$TBL(0:0) BASED ALIGNED,
       82     2456    1         2 FLAGS,
       83     2457    1           3 PRINT BIT(1) UNAL,
       84     2458    1           3 DISPONLY BIT(1) UNAL,
       85     2459    1           3 INDX BIT(1) UNAL,
       86     2460    1           3 RES BIT(1) UNAL,
       87     2461    1           3 MAXCONST BIT(1) UNAL,
       88     2462    1           3 MINCONST BIT(1) UNAL,
       89     2463    1           3 VALTEXT BIT(1) UNAL,
       90     2464    1           3 VALTEXTLIST BIT(1) UNAL,
       91     2465    1           3 INTINDX BIT(1) UNAL,
       92     2466    1           3 * BIT(9) UNAL,
       93     2467    1         2 VALCODE UBIN(18) UNAL,
       94     2468    1         2 RESPTR$ PTR ALIGNED,
       95     2469    1         2 TEXT ALIGNED,
       96     2470    1           3 COUNT UBIN(9) UNAL,
       97     2471    1           3 TEXT CHAR(19) UNAL,
       98     2472    1         2 PTR$ PTR,
       99     2473    1         2 REPTR$ REDEF PTR$,
      100     2474    1           3 ADDRESS UBIN(24) UNAL,
      101     2475    1           3 SEGID UBIN(12) UNAL,
      102     2476    1         2 PSUPTR$ PTR,
      103     2477    1         2 REPSUPTR$ REDEF PSUPTR$,
      104     2478    1           3 ADDRESS UBIN(24) UNAL,
      105     2479    1           3 SEGID UBIN(12) UNAL,
      106     2480    1         2 MAX UBIN WORD UNAL,
      107     2481    1         2 MIN UBIN WORD UNAL,
      108     2482    1         2 MULT UBIN WORD UNAL;
      109     2483        /**/
      110     2484    1   DCL 1 CAT$TBL(0:0) BASED ALIGNED,
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:5    
      111     2485    1         2 FLAGS,
      112     2486    1           3 PRINT BIT(1) UNAL,
      113     2487    1           3 * BIT(17) UNAL,
      114     2488    1         2 MAXPARAM UBIN(18) UNAL,
      115     2489    1         2 PARAM$ PTR;
      116     2490        /**/
      117     2491    1   DCL RES$FLGS(0:15) BIT(1) BASED UNAL;
      118     2492    1   DCL B$TABLE(0:0) UBIN WORD BASED ALIGNED;
      119     2493    1   DCL 1 B$PTR(0:0) BASED ALIGNED,
      120     2494    1         2 ADDRESS UBIN(24) UNAL,
      121     2495    1         2 SEGID UBIN(12) UNAL;
      122     2496        /**/
      123     2497        %EJECT;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:6    
      124     2498        /***********************************************************************/
      125     2499        /*    ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   */
      126     2500        /**********************************************************************/
      127     2501        /**/
      128     2502    1   DCL PCE$ERROR ENTRY(2) ALTRET;
      129     2503    1   DCL PCW$WRITE ENTRY(2) ALTRET;
      130     2504    1   DCL PCP$PDISP ENTRY(1) ALTRET;
      131     2505    1   DCL PCR$RESTEXT ENTRY(2);
      132     2506        /**/
      133     2507        /********************************************************************/
      134     2508        /*   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   */
      135     2509        /********************************************************************/
      136     2510        /**/
      137     2511    1   DCL M$LO DCB;                           /* ALL OUTPUT                         */
      138     2512        /**/
      139     2513        /*****************************************************************/
      140     2514        /*   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   */
      141     2515        /*****************************************************************/
      142     2516        /**/
      143     2517    1   DCL CAT$ PTR SYMREF;
      144     2518    1   DCL SYSTEM$ PTR SYMREF;
      145     2519    1   DCL PART$ PTR SYMREF;
      146     2520    1   DCL RES$ PTR SYMREF;
      147     2521    1   DCL EX$ PTR SYMREF;
      148     2522        /**/
      149     2523    1   DCL NUM_PSURES SBIN WORD SYMREF;
      150     2524    1   DCL RES_TEXT(0:3) CHAR(2) SYMREF;
      151     2525    1   DCL PSURES_TEXT(0:7) CHAR(8) SYMREF;
      152     2526        /**/
      153     2527    1   DCL MONPTR$ PTR SYMREF;
      154     2528    1   DCL 1 MONPTR REDEF MONPTR$,
      155     2529    1         2 ADDRESS UBIN(24) UNAL,
      156     2530    1         2 SEGID UBIN(12) UNAL;
      157     2531    1   DCL MONPART$ PTR SYMREF;
      158     2532        /**/
      159     2533    1   DCL 1 INDEX_FLGS SYMREF,
      160     2534    1         2 MODE(0:%PC_MAXMODE) BIT(1) UNAL,
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:7    
      161     2535    1         2 PART#(0:15) BIT(1) UNAL,
      162     2536    1         2 DOMAINE(0:%PC_MAXDOMAIN) BIT(1) UNAL;
      163     2537        /**/
      164     2538    1   DCL PART#_FLGS(0:15) BIT(1) SYMREF;
      165     2539        /**/
      166     2540    1   DCL 1 TEXTC_PART#X(0:15) SYMREF,
      167     2541    1         2 COUNT UBIN(9) UNAL,
      168     2542    1         2 TEXT CHAR(3) UNAL;
      169     2543        /**/
      170     2544    1   DCL 1 TEXTC_MODE(0:%PC_MAXMODE) SYMREF,
      171     2545    1         2 COUNT UBIN(9) UNAL,
      172     2546    1         2 TEXT CHAR(11) UNAL;
      173     2547        /**/
      174     2548    1   DCL 1 TEXTC_DOMAIN(0:%PC_MAXDOMAIN) SYMREF,
      175     2549    1         2 COUNT UBIN(9) UNAL,
      176     2550    1         2 TEXT CHAR(7) UNAL;
      177     2551        /**/
      178     2552    1   DCL 1 RESTEXT_C SYMREF,
      179     2553    1         2 COUNT UBIN(9) UNAL,
      180     2554    1         2 TEXT CHAR(12) UNAL;
      181     2555        /**/
      182     2556    1   DCL TPSYS BIT(1) SYMREF;                /* TP SYSTEM FLAG                     */
      183     2557        /**/
      184     2558        /*  MONITOR SYMREFS  */
      185     2559        /**/
      186     2560    1   DCL FR_MEMC UBIN WORD SYMREF;
      187     2561    1   DCL FR_MEMM UBIN WORD SYMREF;
      188     2562        %EJECT;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:8    
      189     2563        /*****************************************************************************/
      190     2564        /*   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   */
      191     2565        /*****************************************************************************/
      192     2566        /**/
      193     2567    1   PCT$SYSTEM: ENTRY(PCT_PARAM) ALTRET;
      194     2568        /**/
      195     2569    2           IF (PCT_PARAM = %PC_PCTALL) THEN DO I = 1 TO %PC_MAXMODE;
      196     2570    2              MODEFLGS(I) = YES;
      197     2571    2              END;
      198     2572        /**/
      199     2573    1           ELSE MODEFLGS = INDEX_FLGS.MODE;
      200     2574        /**/
      201     2575    1           IF (MODEFLGS = NO) THEN RETURN;
      202     2576        /**/
      203     2577    1           CALL SET_MAXCLMN ALTRET(PCT_ERR);
      204     2578        /**/
      205     2579    1           CUR_MODE = 1;
      206     2580        /**/
      207     2581    1   NEXT_TABLE:
      208     2582    1           I = CUR_MODE;
      209     2583    1           J = 0;
      210     2584    1           TBL_PRBUFCHAR = ' ';
      211     2585        /**/
      212     2586    2           DO WHILE (J <= MAX_CLMN);
      213     2587    3              IF (MODEFLGS(I)) THEN DO;
      214     2588    3                 K = (SIZEC(TBL_PRBUF.CLMN(0)) - TEXTC_MODE.COUNT(I))/2;
      215     2589    3                 CALL INSERT(TBL_PRBUF.CLMN(J),K,TEXTC_MODE.COUNT(I),
      216     2590    3                   TEXTC_MODE.TEXT(I));
      217     2591    3                 J = J+1;
      218     2592    3                 END;
      219     2593    2              I = I+1;
      220     2594    2              IF ((TPSYS)AND(I > %PC_MAXMODE))OR
      221     2595    3                ((~TPSYS)AND(I > %PC_MAXMODE-1)) THEN DO;
      222     2596    3                 IF (TPSYS) THEN MAX_MODE = %PC_MAXMODE;
      223     2597    3                 ELSE MAX_MODE = %PC_MAXMODE-1;
      224     2598    3                 GOTO TABLE_PRINT;
      225     2599    3                 END;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:9    
      226     2600        /**/
      227     2601    2              END;
      228     2602    2           IF (J > MAX_CLMN) THEN DO;
      229     2603    2              MAX_MODE = I - 1;
      230     2604    2              GOTO TABLE_PRINT;
      231     2605    2              END;
      232     2606        /**/
      233     2607    1           IF (TPSYS) THEN MAX_MODE = %PC_MAXMODE;
      234     2608    1           ELSE MAX_MODE = %PC_MAXMODE - 1;
      235     2609        /**/
      236     2610    1   TABLE_PRINT:
      237     2611        /**/
      238     2612    1           IF (J = 0) THEN GOTO NONTABLE_PRINT;
      239     2613    1           FIRST_TIME = YES;
      240     2614        /**/
      241     2615    2           DO I = 1 TO %PC_SYSTEMHI;
      242     2616    2              IF ((SYSTEM$ -> P$TBL.FLAGS.INDX(I))AND((PCT_PARAM = %PC_PCTALL)OR
      243     2617    3                (SYSTEM$ -> P$TBL.FLAGS.PRINT(I)))) THEN DO;
      244     2618    4                 IF (FIRST_TIME) THEN DO;
      245     2619    4                    FIRST_TIME = NO;
      246     2620    4                    CALL PCW$WRITE(TBL_PRBUF,SIZEC(TBL_PRBUF.NAME)+
      247     2621    4                      SIZEC(TBL_PRBUF.CLMN(0))*(MAX_CLMN+1))
      248     2622    4                      ALTRET(PCT_ERR);
      249     2623    4                    CALL XLATE(TBL_PRBUFCHAR,XLATE_TBL,TBL_PRBUFCHAR);
      250     2624                                                /* TRANSLATE TO DASHES                */
      251     2625    4                    CALL PCW$WRITE(TBL_PRBUF,SIZEC(TBL_PRBUF.NAME)+
      252     2626    4                      SIZEC(TBL_PRBUF.CLMN(0))*(MAX_CLMN+1))
      253     2627    4                      ALTRET(PCT_ERR);
      254     2628    4                    TBL_PRBUFCHAR = ' ';
      255     2629    4                    END;
      256     2630    3                 CALL INSERT(TBL_PRBUF.NAME,(SIZEC(TBL_PRBUF.NAME) -
      257     2631    3                   SYSTEM$ ->P$TBL.TEXT.COUNT(I)),SYSTEM$ -> P$TBL.TEXT.COUNT(I),
      258     2632    3                   SYSTEM$ -> P$TBL.TEXT.TEXT(I));
      259     2633        /**/
      260     2634    3                 K = 0;                    /* CLMN NUMBER                        */
      261     2635    4                 DO J = CUR_MODE TO MAX_MODE;
      262     2636    5                    IF (MODEFLGS(J)) THEN DO; /* SELECTED MODE                   */
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:10   
      263     2637    5                       MONPTR.ADDRESS = SYSTEM$ -> P$TBL.REPTR$.ADDRESS(I);
      264     2638        /**/
      265     2639    5                       VALUE = MONPTR$ -> B$TABLE(J);
      266     2640    5                       VALUE = VALUE/(SYSTEM$ -> P$TBL.MULT(I));
      267     2641    5                       CALL TABLE_ENTRY(K,VALUE);
      268     2642        /**/
      269     2643    5                       K = K + 1;
      270     2644    5                       END;
      271     2645    4                    END;
      272     2646    3                 CALL PCW$WRITE(TBL_PRBUF,SIZEC(TBL_PRBUF.NAME)+
      273     2647    3                   SIZEC(TBL_PRBUF.CLMN(0))*(MAX_CLMN+1)) ALTRET(PCT_ERR);
      274     2648    3                 TBL_PRBUFCHAR = ' ';
      275     2649    3                 END;
      276     2650    2              END;
      277     2651        /**/
      278     2652    1           CALL PCW$WRITE(TEXTC_MODE.TEXT(0),1) ALTRET(PCT_ERR); /* BLANK LINE   */
      279     2653        /**/
      280     2654    1           IF ((TPSYS)AND(MAX_MODE < %PC_MAXMODE))OR /* SEE IF NEW TABLE NEEDED   */
      281     2655    2             ((~TPSYS)AND(MAX_MODE < %PC_MAXMODE-1)) THEN DO;
      282     2656    2              CUR_MODE = MAX_MODE + 1;
      283     2657    3              DO I = CUR_MODE TO %PC_MAXMODE;
      284     2658    3                 IF (MODEFLGS(I)) THEN GOTO NEXT_TABLE;
      285     2659    3                 END;
      286     2660    2              END;
      287     2661        /**/
      288     2662    1   NONTABLE_PRINT:
      289     2663    1           DISP_TBL = NO;
      290     2664    1           J = 0;
      291     2665        /**/
      292     2666    2           DO I = 1 TO %PC_SYSTEMHI;
      293     2667    2              IF (~ SYSTEM$ -> P$TBL.FLAGS.INDX(I))AND
      294     2668    2                ((PCT_PARAM = %PC_PCTALL)OR
      295     2669    3                (SYSTEM$ -> P$TBL.FLAGS.PRINT(I))) THEN DO;
      296     2670    3                 DISP_TBL.PARM.CAT(J) = %PC_SYSTEM;
      297     2671    3                 DISP_TBL.PARM.PARM(J) = I;
      298     2672    3                 DISP_TBL.PARM.RESINDX(J) = -1;
      299     2673    3                 J = J+1;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:11   
      300     2674    3                 END;
      301     2675    2              END;
      302     2676        /**/
      303     2677    2           IF (J ~= 0) THEN DO;            /* SOMETHING TO DISPLAY               */
      304     2678    2              DISP_TBL.INDX = J-1;
      305     2679    2              CALL PCP$PDISP(DISP_TBL) ALTRET(PCT_ERR);
      306     2680    2              END;
      307     2681    1           RETURN;
      308     2682        %EJECT;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:12   
      309     2683        /**/
      310     2684    1   PCT$PARTITION: ENTRY(PCT_PARAM) ALTRET;
      311     2685        /**/
      312     2686    2           IF (PCT_PARAM = %PC_PCTALL) THEN DO I = 0 TO 15; /* ALL                */
      313     2687    2              PART#FLGS(I) = YES;
      314     2688    2              END;
      315     2689        /**/
      316     2690    1           ELSE IF (PCT_PARAM = %PC_PCTFLAGS) THEN PART#FLGS = INDEX_FLGS.PART#;
      317     2691        /**/
      318     2692    1              ELSE PART#FLGS = PART#_FLGS;
      319     2693        /**/
      320     2694    1           CALL SET_MAXCLMN ALTRET (PCT_ERR);
      321     2695        /**/
      322     2696    1           CUR_TABLE = 1;
      323     2697    1           RES_INDX = 0;
      324     2698    1           CUR_RESINDX = 0;
      325     2699        /**/
      326     2700    1   NEXT_PTBL:
      327     2701    1           TBL_PRBUFCHAR = ' ';            /* BLANK OUT BUFFER                   */
      328     2702    1           I = CUR_TABLE;
      329     2703    1           J = 0;                          /* CLMN INDEX                         */
      330     2704    2           DO WHILE (J <= MAX_CLMN);       /* BUILD HEADING                      */
      331     2705        /**/
      332     2706    3              DO CASE (I);                 /* RESTYPE OR NOT                     */
      333     2707        /**/
      334     2708    3               CASE (%PC_PMINRES);
      335     2709    3                 IF (I = CUR_TABLE) THEN RESLO = CUR_RESINDX;
      336     2710    3                 ELSE RESLO = 0;
      337     2711    4                 DO RES_INDX = RESLO TO NUM_PSURES+PSURES_OFFSET-1;
      338     2712    4                    IF (PCT_PARAM = %PC_PCTALL)OR
      339     2713    4                      (PCT_PARAM = %PC_PCTPART#)OR
      340     2714    4                      (PART$ -> P$TBL.RESPTR$(I) -> RES$FLGS(RES_INDX))
      341     2715    5                    THEN DO;
      342     2716    5                       CALL PCR$RESTEXT(RES_INDX,RESTEXT_C);
      343     2717    5                       K = (SIZEC(TBL_PRBUF.CLMN(0)) -
      344     2718    5                         RESTEXT_C.COUNT)/2;
      345     2719    5                       CALL INSERT(TBL_PRBUF.CLMN(J),K,,
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:13   
      346     2720    5                         SUBSTR(RESTEXT_C.TEXT,0,RESTEXT_C.COUNT));
      347     2721    5                       J = J+1;
      348     2722        /**/
      349     2723    6                       IF (J > MAX_CLMN) THEN DO; /* FILLED TABLE                */
      350     2724    6                          MAX_TABLE = I;
      351     2725    6                          MAX_RESINDX = RES_INDX;
      352     2726    6                          GOTO PTBL_PRINT;
      353     2727    6                          END;
      354     2728    5                       END;
      355     2729    4                    END;
      356     2730    3               CASE(%PC_PMAXRES);
      357     2731        /**/
      358     2732    3               CASE(ELSE);
      359     2733    3                 IF (PCT_PARAM = %PC_PCTALL)OR /* NON RESOURCE                    */
      360     2734    3                   (PCT_PARAM = %PC_PCTPART#)OR
      361     2735    4                   (PART$ -> P$TBL.FLAGS.PRINT(I)) THEN DO;
      362     2736    4                    K = (SIZEC(TBL_PRBUF.CLMN(0)) -
      363     2737    4                      PART$ -> P$TBL.TEXT.COUNT(I))/2;
      364     2738    4                    CALL INSERT (TBL_PRBUF.CLMN(J),K,,
      365     2739    4                      SUBSTR(PART$ -> P$TBL.TEXT.TEXT(I),0,
      366     2740    4                      PART$ -> P$TBL.TEXT.COUNT(I)));
      367     2741    4                    J = J+1;
      368     2742    4                    END;
      369     2743    3               END;
      370     2744    2              I = I + 1;
      371     2745    3              IF (I > %PC_PARTITIONHI) THEN DO;
      372     2746    3                 MAX_TABLE = %PC_PARTITIONHI;
      373     2747    3                 MAX_RESINDX = -1;
      374     2748    3                 GOTO PTBL_PRINT;
      375     2749    3                 END;
      376     2750        /**/
      377     2751    2              END;
      378     2752        /**/
      379     2753    2           IF (J > MAX_CLMN) THEN DO;
      380     2754    2              MAX_TABLE = I - 1;
      381     2755    2              MAX_RESINDX = -1;
      382     2756    2              GOTO PTBL_PRINT;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:14   
      383     2757    2              END;
      384     2758        /**/
      385     2759    1           MAX_TABLE = %PC_PARTITIONHI;
      386     2760        /**/
      387     2761    1   PTBL_PRINT:
      388     2762    1           IF (J=0) THEN RETURN;           /* NO PARAMETERS                      */
      389     2763    1           FIRST_TIME = YES;
      390     2764        /**/
      391     2765    2           DO I = 0 TO 15;                 /* DO ALL PARTITIONS                  */
      392     2766    2              MONPTR$ = PINCRW(MONPART$,SIZEW(JM$PT)*I); /* POINT TO THIS PARTITION */
      393     2767        /**/
      394     2768    3              IF (PART#FLGS(I)) THEN DO;
      395     2769    4                 IF (FIRST_TIME) THEN DO;  /* PRINT HEADER                       */
      396     2770    4                    FIRST_TIME = NO;
      397     2771    4                    CALL PCW$WRITE(TBL_PRBUF,SIZEC(TBL_PRBUF.NAME)+
      398     2772    4                      SIZEC(TBL_PRBUF.CLMN(0))*(MAX_CLMN+1))
      399     2773    4                      ALTRET(PCT_ERR);
      400     2774    4                    CALL XLATE(TBL_PRBUFCHAR,XLATE_TBL,TBL_PRBUFCHAR);
      401     2775                                                /* TRANSLATE TO DASHES                */
      402     2776    4                    CALL PCW$WRITE(TBL_PRBUF,SIZEC(TBL_PRBUF.NAME)+
      403     2777    4                      SIZEC(TBL_PRBUF.CLMN(0))*(MAX_CLMN+1))
      404     2778    4                      ALTRET(PCT_ERR);
      405     2779    4                    TBL_PRBUFCHAR = ' ';
      406     2780    4                    END;
      407     2781        /**/
      408     2782    3                 CALL INSERT(TBL_PRBUF.NAME,(SIZEC(TBL_PRBUF.NAME) - TEXTC_PART#X.COUNT
              2782                          (I)),
      409     2783    3                   TEXTC_PART#X.COUNT(I),TEXTC_PART#X.TEXT(I));
      410     2784        /**/
      411     2785    3                 K = 0;                    /* CLMN NUMBER                        */
      412     2786    4                 DO J = CUR_TABLE TO MAX_TABLE; /* FILL IN TABLE                 */
      413     2787        /**/
      414     2788    4                    IF ((PCT_PARAM = %PC_PCTALL)OR
      415     2789    4                      (PCT_PARAM = %PC_PCTPART#)OR
      416     2790    4                      (~(PART$ -> P$TBL.FLAGS.RES(J))AND(PART$ -> P$TBL.FLAGS.PRINT(J))
              2790                               )OR
      417     2791    5                      (PART$ -> P$TBL.FLAGS.RES(J))) THEN DO CASE(J);
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:15   
      418     2792        /**/
      419     2793    5                     CASE (%PC_PMINTI);
      420     2794    5                       VALUE = MONPTR$ -> JM$PT.TL;
      421     2795    5                       VALUE = VALUE/(PART$ -> P$TBL.MULT(%PC_PMINTI));
      422     2796    5                       CALL TABLE_ENTRY(K,VALUE);
      423     2797    5                       K = K+1;
      424     2798        /**/
      425     2799    5                     CASE (%PC_PMAXTI);
      426     2800    5                       VALUE = MONPTR$ -> JM$PT.TU;
      427     2801    5                       VALUE = VALUE/(PART$ -> P$TBL.MULT(%PC_PMAXTI));
      428     2802    5                       CALL TABLE_ENTRY(K,VALUE);
      429     2803    5                       K = K+1;
      430     2804        /**/
      431     2805    5                     CASE (%PC_PMINRES);
      432     2806    6                       IF (J = MAX_TABLE) THEN DO; /* END OF LINE                */
      433     2807    6                          RESHI = MAX_RESINDX;
      434     2808    6                          IF (J = CUR_TABLE) THEN RESLO = CUR_RESINDX;
      435     2809    6                          ELSE RESLO = 0;
      436     2810    6                          END;
      437     2811        /**/
      438     2812    6                       ELSE IF (J = CUR_TABLE) THEN DO; /* START OF LINE         */
      439     2813    6                             RESLO = CUR_RESINDX;
      440     2814    6                             RESHI = NUM_PSURES + PSURES_OFFSET-1;
      441     2815    6                             END;
      442     2816        /**/
      443     2817    6                          ELSE DO;
      444     2818    6                             RESLO = 0;
      445     2819    6                             RESHI = NUM_PSURES + PSURES_OFFSET-1;
      446     2820    6                             END;
      447     2821        /**/
      448     2822    6                       DO RES_INDX = RESLO TO RESHI;
      449     2823    6                          IF (PART$ -> P$TBL.RESPTR$(J) -> RES$FLGS(RES_INDX))
      450     2824    6                            OR(PCT_PARAM = %PC_PCTPART#)
      451     2825    7                            OR(PCT_PARAM=%PC_PCTALL) THEN DO;
      452     2826    7                             VALUE = MONPTR$ -> JM$PT.RMIN(RES_INDX);
      453     2827    7                             CALL TABLE_ENTRY(K,VALUE);
      454     2828        /**/
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:16   
      455     2829    7                             CALL INDEX(VALUE,BITASC('020'O),TBL_PRBUF.CLMN(K),
      456     2830    7                               0,'757'O);  /* FIND FIRST NON BLANK               */
      457     2831        /**/
      458     2832    7                             RESTEXT_C.COUNT = 0;
      459     2833    8                             DO WHILE (SUBSTR(TBL_PRBUF.CLMN(K),VALUE,1) ~= ' ');
      460     2834    8                                CALL INSERT(RESTEXT_C.TEXT,RESTEXT_C.COUNT,1,
      461     2835    8                                  SUBSTR(TBL_PRBUF.CLMN(K),VALUE,1));
      462     2836    8                                RESTEXT_C.COUNT = RESTEXT_C.COUNT + 1;
      463     2837    8                                VALUE = VALUE + 1;
      464     2838    8                                END;
      465     2839        /**/
      466     2840    7                             CALL INSERT(RESTEXT_C.TEXT,RESTEXT_C.COUNT,1,'-');
      467     2841    7                             RESTEXT_C.COUNT = RESTEXT_C.COUNT + 1;
      468     2842        /**/
      469     2843    7                             VALUE = MONPTR$ -> JM$PT.RMAX(RES_INDX);
      470     2844    7                             CALL TABLE_ENTRY(K,VALUE);
      471     2845        /**/
      472     2846    7                             CALL INDEX(VALUE,BITASC('020'O),TBL_PRBUF.CLMN(K),
      473     2847    7                               0,'757'O);  /* FIND FIRST NON BLANK               */
      474     2848        /**/
      475     2849    8                             DO WHILE (SUBSTR(TBL_PRBUF.CLMN(K),VALUE,1) ~= ' ');
      476     2850    8                                CALL INSERT(RESTEXT_C.TEXT,RESTEXT_C.COUNT,1,
      477     2851    8                                  SUBSTR(TBL_PRBUF.CLMN(K),VALUE,1));
      478     2852    8                                RESTEXT_C.COUNT = RESTEXT_C.COUNT + 1;
      479     2853    8                                VALUE = VALUE + 1;
      480     2854    8                                END;
      481     2855        /**/
      482     2856    7                             VALUE = (SIZEC(TBL_PRBUF.CLMN(0))-RESTEXT_C.COUNT)/2;
      483     2857    7                             CALL INSERT(TBL_PRBUF.CLMN(K),VALUE,,
      484     2858    7                               SUBSTR(RESTEXT_C.TEXT,0,RESTEXT_C.COUNT));
      485     2859        /**/
      486     2860    7                             K = K+1;
      487     2861    7                             END;
      488     2862    6                          END;
      489     2863        /**/
      490     2864    5                     CASE (%PC_PLOCK);
      491     2865    5                       IF (MONPTR$ -> JM$PT.FLG.LOCK) THEN VALUE = 1;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:17   
      492     2866    5                       ELSE VALUE = 0;
      493     2867    5                       IF VALUE = 0
      494     2868    5                          THEN CALL INSERT(TBL_PRBUF.CLMN(K),4,,'NO');
      495     2869    5                          ELSE CALL INSERT(TBL_PRBUF.CLMN(K),3,,'YES');
      496     2870    5                       K = K+1;
      497     2871        /**/
      498     2872    5                     CASE (%PC_PQUAN);
      499     2873    5                       VALUE = MONPTR$ -> JM$PT.QUAN;
      500     2874    5                       VALUE = VALUE/(PART$ -> P$TBL.MULT(%PC_PQUAN));
      501     2875    5                       CALL TABLE_ENTRY(K,VALUE);
      502     2876    5                       K = K+1;
      503     2877        /**/
      504     2878    5                     CASE (%PC_PPRIO);
      505     2879    5                       VALUE = MONPTR$ -> JM$PT.XPRIO;
      506     2880    5                       CALL TABLE_ENTRY(K,VALUE);
      507     2881    5                       K = K+1;
      508     2882        /**/
      509     2883    5                     CASE (%PC_PMAXACCT);
      510     2884    5                       VALUE = MONPTR$ -> JM$PT.MAX1ACCT;
      511     2885    5                       CALL TABLE_ENTRY(K,VALUE);
      512     2886    5                       K = K+1;
      513     2887        /**/
      514     2888    5                     CASE (%PC_PJMAX);
      515     2889    5                       VALUE = MONPTR$ -> JM$PT.MAX;
      516     2890    5                       CALL TABLE_ENTRY(K,VALUE);
      517     2891    5                       K = K+1;
      518     2892        /**/
      519     2893    5                     CASE (%PC_PJCUR);
      520     2894    5                       VALUE = MONPTR$ -> JM$PT.CUR;
      521     2895    5                       CALL TABLE_ENTRY(K,VALUE);
      522     2896    5                       K = K+1;
      523     2897        /**/
      524     2898    5                     CASE (%PC_PJCTOT);
      525     2899    5                       VALUE = MONPTR$ -> JM$PT.CPTOT;
      526     2900    5                       CALL TABLE_ENTRY(K,VALUE);
      527     2901    5                       K = K+1;
      528     2902        /**/
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:18   
      529     2903    5                     CASE (%PC_PJTOT);
      530     2904    5                       VALUE = MONPTR$ -> JM$PT.TOT;
      531     2905    5                       CALL TABLE_ENTRY(K,VALUE);
      532     2906    5                       K = K+1;
      533     2907        /**/
      534     2908    5                     END;
      535     2909    4                    END;
      536     2910    3                 CALL PCW$WRITE(TBL_PRBUF,SIZEC(TBL_PRBUF.NAME)+
      537     2911    3                   SIZEC(TBL_PRBUF.CLMN(0))*(MAX_CLMN+1)) ALTRET(PCT_ERR);
      538     2912    3                 TBL_PRBUFCHAR = ' ';
      539     2913    3                 END;
      540     2914        /**/
      541     2915    2              END;
      542     2916        /**/
      543     2917    1           CALL PCW$WRITE(TEXTC_MODE.TEXT(0),1) ALTRET(PCT_ERR); /* BLANK LINE   */
      544     2918        /**/
      545     2919    2           IF (MAX_TABLE < %PC_PARTITIONHI) THEN DO;
      546     2920    3              IF (MAX_RESINDX ~= -1) THEN DO;
      547     2921    3                 CUR_RESINDX = MAX_RESINDX + 1;
      548     2922    3                 CUR_TABLE = MAX_TABLE;
      549     2923    3                 GOTO NEXT_PTBL;
      550     2924    3                 END;
      551     2925    2              CUR_TABLE = MAX_TABLE + 1;
      552     2926    2              GOTO NEXT_PTBL;
      553     2927    2              END;
      554     2928        /**/
      555     2929    1           RETURN;
      556     2930        %EJECT;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:19   
      557     2931        /**/
      558     2932    1   PCT$RESOURCE: ENTRY (PCT_PARAM) ALTRET;
      559     2933        /**/
      560     2934    2           IF (PCT_PARAM = %PC_PCTALL) THEN DO I = 1 TO %PC_MAXMODE;
      561     2935    2              MODEFLGS(I) = YES;
      562     2936    2              END;
      563     2937        /**/
      564     2938    1           ELSE MODEFLGS = INDEX_FLGS.MODE;
      565     2939        /**/
      566     2940    1           IF (MODEFLGS = NO) THEN RETURN;
      567     2941        /**/
      568     2942    1           CALL SET_MAXCLMN ALTRET(PCT_ERR);
      569     2943        /**/
      570     2944    1           CUR_MODE = 1;
      571     2945        /**/
      572     2946    1   NEXT_RESTBL:
      573     2947    1           I = CUR_MODE;
      574     2948    1           J = 0;
      575     2949    1           TBL_PRBUFCHAR = ' ';
      576     2950        /**/
      577     2951    2           DO WHILE (J <= MAX_CLMN);
      578     2952    3              IF (MODEFLGS(I)) THEN DO;
      579     2953    3                 K = (SIZEC(TBL_PRBUF.CLMN(0)) - TEXTC_MODE.COUNT(I))/2;
      580     2954    3                 CALL INSERT(TBL_PRBUF.CLMN(J),K,TEXTC_MODE.COUNT(I),
      581     2955    3                   TEXTC_MODE.TEXT(I));
      582     2956    3                 J = J+1;
      583     2957    3                 END;
      584     2958    2              I = I+1;
      585     2959    2              IF ((TPSYS)AND(I > %PC_MAXMODE))OR
      586     2960    3                ((~TPSYS)AND(I > %PC_MAXMODE-1)) THEN DO;
      587     2961    3                 IF (TPSYS) THEN MAX_MODE = %PC_MAXMODE;
      588     2962    3                 ELSE MAX_MODE = %PC_MAXMODE-1;
      589     2963    3                 GOTO RESTBL_PRINT;
      590     2964    3                 END;
      591     2965        /**/
      592     2966    2              END;
      593     2967    2           IF (J > MAX_CLMN) THEN DO;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:20   
      594     2968    2              MAX_MODE = I - 1;
      595     2969    2              GOTO RESTBL_PRINT;
      596     2970    2              END;
      597     2971        /**/
      598     2972    1           IF (TPSYS) THEN MAX_MODE = %PC_MAXMODE;
      599     2973    1           ELSE MAX_MODE = %PC_MAXMODE - 1;
      600     2974        /**/
      601     2975    1   RESTBL_PRINT:
      602     2976        /**/
      603     2977    1           IF (J = 0) THEN GOTO RESNONTBL_PRINT;
      604     2978    1           FIRST_TIME = YES;
      605     2979        /**/
      606     2980    2           DO I = 1 TO %PC_RESOURCEHI;
      607     2981    3              DO RES_INDX = 0 TO NUM_PSURES + PSURES_OFFSET-1;
      608     2982    3                 IF (RES$ -> P$TBL.FLAGS.INDX(I)AND
      609     2983    3                   ((PCT_PARAM = %PC_PCTALL)OR
      610     2984    4                   (RES$ -> P$TBL.RESPTR$(I) -> RES$FLGS(RES_INDX)))) THEN DO;
      611     2985    5                    IF (FIRST_TIME) THEN DO;
      612     2986    5                       FIRST_TIME = NO;
      613     2987    5                       CALL PCW$WRITE(TBL_PRBUF,SIZEC(TBL_PRBUF.NAME)+
      614     2988    5                         SIZEC(TBL_PRBUF.CLMN(0))*(MAX_CLMN+1))
      615     2989    5                         ALTRET(PCT_ERR);
      616     2990    5                       CALL XLATE(TBL_PRBUFCHAR,XLATE_TBL,TBL_PRBUFCHAR);
      617     2991                                                /* TRANSLATE TO DASHES                */
      618     2992    5                       CALL PCW$WRITE(TBL_PRBUF,SIZEC(TBL_PRBUF.NAME)+
      619     2993    5                         SIZEC(TBL_PRBUF.CLMN(0))*(MAX_CLMN+1))
      620     2994    5                         ALTRET(PCT_ERR);
      621     2995    5                       TBL_PRBUFCHAR = ' ';
      622     2996    5                       END;
      623     2997        /**/
      624     2998    4                    CALL PCR$RESTEXT(RES_INDX,RESTEXT_C);
      625     2999    4                    CALL INSERT(TBL_PRBUF.NAME,(SIZEC(TBL_PRBUF.NAME) - RESTEXT_C.COUNT
              2999                             ),
      626     3000    4                      RESTEXT_C.COUNT,RESTEXT_C.TEXT);
      627     3001    4                    CALL INSERT(TBL_PRBUF.NAME,(SIZEC(TBL_PRBUF.NAME)  - RESTEXT_C.
              3001                             COUNT -
      628     3002    4                      RES$ -> P$TBL.TEXT.COUNT(I)),RES$ -> P$TBL.TEXT.COUNT(I),
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:21   
      629     3003    4                      RES$ -> P$TBL.TEXT.TEXT(I));
      630     3004        /**/
      631     3005    4                    K = 0;                 /* CLMN NUMBER                        */
      632     3006    5                    DO J = CUR_MODE TO MAX_MODE;
      633     3007    6                       IF (MODEFLGS(J)) THEN DO;
      634     3008        /**/
      635     3009    7                          IF (RES_INDX = MMINDX) THEN DO; /* MEMORY IS SPECIAL   */
      636     3010    7                             IF (I = %PC_MAXRES) THEN MONPTR$ = ADDR(FR_MEMM);
      637     3011    7                             ELSE MONPTR$ = ADDR(FR_MEMC);
      638     3012    7                             MONPTR.SEGID = BITBIN(%SPCL1SID);
      639     3013    7                             VALUE = MONPTR$ -> B$TABLE(J);
      640     3014    7                             END;
      641     3015        /**/
      642     3016    7                          ELSE IF (RES_INDX < PSURES_OFFSET) THEN DO;
      643     3017    7                                MONPTR.ADDRESS = RES$ -> P$TBL.REPTR$.ADDRESS(I);
      644     3018    7                                MONPTR.ADDRESS = MONPTR$ -> B$PTR.ADDRESS(J);
      645     3019    7                                VALUE = MONPTR$ -> B$TABLE(RES_INDX-1);
      646     3020    7                                END;
      647     3021        /**/
      648     3022    7                             ELSE DO;
      649     3023    7                                MONPTR.ADDRESS = RES$ -> P$TBL.REPSUPTR$.ADDRESS(I);
      650     3024    7                                MONPTR.ADDRESS = MONPTR$ -> B$PTR.ADDRESS(J);
      651     3025    7                                VALUE = MONPTR$ -> B$TABLE(RES_INDX - PSURES_OFFSET);
      652     3026    7                                END;
      653     3027    6                          CALL TABLE_ENTRY(K,VALUE);
      654     3028    6                          K = K+1;
      655     3029    6                          END;
      656     3030        /**/
      657     3031    5                       END;
      658     3032    4                    CALL PCW$WRITE(TBL_PRBUF,SIZEC(TBL_PRBUF.NAME)+
      659     3033    4                      SIZEC(TBL_PRBUF.CLMN(0))*(MAX_CLMN+1)) ALTRET(PCT_ERR);
      660     3034    4                    TBL_PRBUFCHAR = ' ';
      661     3035    4                    END;
      662     3036    3                 END;
      663     3037    2              END;
      664     3038        /**/
      665     3039    1           CALL PCW$WRITE(TEXTC_MODE.TEXT(0),1) ALTRET(PCT_ERR); /* BLANK LINE   */
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:22   
      666     3040        /**/
      667     3041    1           IF ((TPSYS)AND(MAX_MODE < %PC_MAXMODE))OR /* SEE IF NEW TABLE NEEDED   */
      668     3042    2             ((~TPSYS)AND(MAX_MODE < %PC_MAXMODE-1)) THEN DO;
      669     3043    2              CUR_MODE = MAX_MODE + 1;
      670     3044    3              DO I = CUR_MODE TO %PC_MAXMODE;
      671     3045    3                 IF (MODEFLGS(I)) THEN GOTO NEXT_RESTBL;
      672     3046    3                 END;
      673     3047    2              END;
      674     3048        /**/
      675     3049    1   RESNONTBL_PRINT:
      676     3050    1           DISP_TBL = NO;
      677     3051    1           J = 0;
      678     3052        /**/
      679     3053    2           DO I = 1 TO %PC_RESOURCEHI;
      680     3054    3              DO RES_INDX = 0 TO NUM_PSURES + PSURES_OFFSET -1;
      681     3055    3                 IF (~(RES$ -> P$TBL.FLAGS.INDX(I))AND
      682     3056    3                   ((PCT_PARAM = %PC_PCTALL)OR
      683     3057    4                   (RES$ -> P$TBL.RESPTR$(I) -> RES$FLGS(RES_INDX)))) THEN DO;
      684     3058    4                    DISP_TBL.PARM.CAT(J) = %PC_RESOURCE;
      685     3059    4                    DISP_TBL.PARM.PARM(J) = I;
      686     3060    4                    DISP_TBL.PARM.RESINDX(J) = RES_INDX;
      687     3061    4                    J = J+1;
      688     3062    4                    END;
      689     3063    3                 END;
      690     3064    2              END;
      691     3065        /**/
      692     3066    2           IF (J ~= 0) THEN DO;
      693     3067    2              DISP_TBL.INDX = J-1;
      694     3068    2              CALL PCP$PDISP(DISP_TBL) ALTRET(PCT_ERR);
      695     3069    2              END;
      696     3070        /**/
      697     3071    1           RETURN;
      698     3072        %EJECT;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:23   
      699     3073        /**/
      700     3074    1   PCT$EXCEPTION: ENTRY (PCT_PARAM) ALTRET;
      701     3075        /**/
      702     3076    2           IF (PCT_PARAM = %PC_PCTALL) THEN DO I = 0 TO %PC_MAXDOMAIN;
      703     3077    2              DOMAINFLGS(I) = YES;
      704     3078    2              END;
      705     3079        /**/
      706     3080    1           ELSE DOMAINFLGS = INDEX_FLGS.DOMAINE;
      707     3081        /**/
      708     3082    1           IF (DOMAINFLGS = NO) THEN RETURN;
      709     3083        /**/
      710     3084    1           CALL SET_MAXCLMN ALTRET(PCT_ERR);
      711     3085        /**/
      712     3086    1           CUR_DOMAIN = 0;
      713     3087    1   NEXT_ETBL:
      714     3088    1           I = CUR_DOMAIN;
      715     3089    1           J = 0;
      716     3090    1           TBL_PRBUFCHAR = ' ';
      717     3091        /**/
      718     3092    2           DO WHILE (J <= MAX_CLMN);
      719     3093    3              IF (DOMAINFLGS(I)) THEN DO;
      720     3094    3                 K = (SIZEC(TBL_PRBUF.CLMN(0)) - TEXTC_DOMAIN.COUNT(I))/2;
      721     3095    3                 CALL INSERT(TBL_PRBUF.CLMN(J),K,TEXTC_DOMAIN.COUNT(I),
      722     3096    3                   TEXTC_DOMAIN.TEXT(I));
      723     3097    3                 J = J+1;
      724     3098    3                 END;
      725     3099    2              I = I+1;
      726     3100    3              IF (I > %PC_MAXDOMAIN) THEN DO;
      727     3101    3                 MAX_DOMAIN = %PC_MAXDOMAIN;
      728     3102    3                 GOTO ETBL_PRINT;
      729     3103    3                 END;
      730     3104        /**/
      731     3105    2              END;
      732     3106    2           IF (J > MAX_CLMN) THEN DO;
      733     3107    2              MAX_DOMAIN = I - 1;
      734     3108    2              GOTO ETBL_PRINT;
      735     3109    2              END;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:24   
      736     3110        /**/
      737     3111    1           MAX_DOMAIN = %PC_MAXDOMAIN;
      738     3112        /**/
      739     3113    1   ETBL_PRINT:
      740     3114        /**/
      741     3115    1           FIRST_TIME = YES;
      742     3116        /**/
      743     3117    2           DO I = 1 TO %PC_EXCEPTIONHI;
      744     3118    2              IF (PCT_PARAM = %PC_PCTALL)OR
      745     3119    3                (EX$ -> P$TBL.FLAGS.PRINT(I)) THEN DO;
      746     3120    4                 IF (FIRST_TIME) THEN DO;
      747     3121    4                    FIRST_TIME = NO;
      748     3122    4                    CALL PCW$WRITE(TBL_PRBUF,SIZEC(TBL_PRBUF.NAME)+
      749     3123    4                      SIZEC(TBL_PRBUF.CLMN(0))*(MAX_CLMN+1))
      750     3124    4                      ALTRET(PCT_ERR);
      751     3125    4                    CALL XLATE(TBL_PRBUFCHAR,XLATE_TBL,TBL_PRBUFCHAR);
      752     3126                                                /* TRANSLATE TO DASHES                */
      753     3127    4                    CALL PCW$WRITE(TBL_PRBUF,SIZEC(TBL_PRBUF.NAME)+
      754     3128    4                      SIZEC(TBL_PRBUF.CLMN(0))*(MAX_CLMN+1))
      755     3129    4                      ALTRET(PCT_ERR);
      756     3130    4                    TBL_PRBUFCHAR = ' ';
      757     3131    4                    END;
      758     3132    3                 CALL INSERT(TBL_PRBUF.NAME,(SIZEC(TBL_PRBUF.NAME) -
      759     3133    3                   EX$ ->P$TBL.TEXT.COUNT(I)),EX$ -> P$TBL.TEXT.COUNT(I),
      760     3134    3                   EX$ -> P$TBL.TEXT.TEXT(I));
      761     3135        /**/
      762     3136    3                 K = 0;                    /* CLMN NUMBER                        */
      763     3137    4                 DO J = CUR_DOMAIN TO MAX_DOMAIN;
      764     3138    5                    IF (DOMAINFLGS(J)) THEN DO; /* SELECTED DOMAIN               */
      765     3139    5                       MONPTR.ADDRESS = EX$ -> P$TBL.REPTR$.ADDRESS(I);
      766     3140        /**/
      767     3141    5                       VALUE = MONPTR$ -> B$TABLE(J);
      768     3142    5                       VALUE = VALUE/(EX$ -> P$TBL.MULT(I));
      769     3143    5                       CALL TABLE_ENTRY(K,VALUE);
      770     3144        /**/
      771     3145    5                       K = K + 1;
      772     3146    5                       END;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:25   
      773     3147    4                    END;
      774     3148    3                 CALL PCW$WRITE(TBL_PRBUF,SIZEC(TBL_PRBUF.NAME)+
      775     3149    3                   SIZEC(TBL_PRBUF.CLMN(0))*(MAX_CLMN+1)) ALTRET(PCT_ERR);
      776     3150    3                 TBL_PRBUFCHAR = ' ';
      777     3151    3                 END;
      778     3152    2              END;
      779     3153        /**/
      780     3154    1           CALL PCW$WRITE(TEXTC_MODE.TEXT(0),1) ALTRET(PCT_ERR); /* BLANK LINE   */
      781     3155        /**/
      782     3156    2           IF (MAX_DOMAIN < %PC_MAXDOMAIN) THEN DO; /* SEE IF ANOTHER TABLE NEEDED */
      783     3157    2              CUR_DOMAIN = MAX_DOMAIN + 1;
      784     3158    3              DO I = CUR_DOMAIN TO %PC_MAXDOMAIN;
      785     3159    3                 IF (DOMAINFLGS(I)) THEN GOTO NEXT_TABLE;
      786     3160    3                 END;
      787     3161    2              END;
      788     3162        /**/
      789     3163    1           RETURN;
      790     3164        %EJECT;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:26   
      791     3165        /**/
      792     3166    1   SET_MAXCLMN: PROC ALTRET;
      793     3167        /**/
      794     3168    2           TEMP$ = DCBADDR(DCBNUM(M$LO));
      795     3169    2           IF (TEMP$ -> F$DCB.ASN# = %DEVICE#) THEN I = TEMP$ -> F$DCB.WIDTH#;
      796     3170    2           ELSE I = 80;
      797     3171        /**/
      798     3172    3           IF (I < SIZEC(TBL_PRBUF.NAME) + SIZEC(TBL_PRBUF.CLMN(0))) THEN DO;
      799     3173    3              CALL PCE$ERROR(%E$P_PLATEN2SMALL,2);
      800     3174    3              ALTRETURN;
      801     3175    3              END;
      802     3176        /**/
      803     3177    2           MAX_CLMN = 0;
      804     3178    3           DO WHILE ((MAX_CLMN<11)AND(SIZEC(TBL_PRBUF.NAME)
      805     3179    3                + SIZEC(TBL_PRBUF.CLMN(0))*(MAX_CLMN+1) <= I));
      806     3180    3              MAX_CLMN = MAX_CLMN + 1;
      807     3181    3              END;
      808     3182    2           MAX_CLMN = MAX_CLMN - 1;
      809     3183        /**/
      810     3184    2           RETURN;
      811     3185        /**/
      812     3186    2   END SET_MAXCLMN;
      813     3187        /**/
      814     3188        %EJECT;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:27   
      815     3189        /**/
      816     3190    1   TABLE_ENTRY: PROC(INDX,VALUE);
      817     3191        /**/
      818     3192    2   DCL INDX SBIN WORD;
      819     3193    2   DCL VALUE SBIN WORD;
      820     3194        /**/
      821     3195    2   DCL TEMP_TEXT CHAR(12) AUTO;
      822     3196    2   DCL TEMP_INDEX SBIN AUTO;
      823     3197    2   DCL VALUE_INDEX SBIN AUTO;
      824     3198        /**/
      825     3199    2           CALL BINCHAR(TEMP_TEXT,VALUE);
      826     3200        /**/
      827     3201    2           TEMP_INDEX = 0;                 /* STRIP LEADING ZEROS                */
      828     3202    3           DO WHILE ('1'B);
      829     3203    3              IF (TEMP_INDEX = SIZEC(TEMP_TEXT)-1)OR
      830     3204    3                (SUBSTR(TEMP_TEXT,TEMP_INDEX,1) ~= '0') THEN GOTO ZEROS_GONE;
      831     3205    3              TEMP_INDEX = TEMP_INDEX+1;
      832     3206    3              END;
      833     3207        /**/
      834     3208    2   ZEROS_GONE:
      835     3209    2           VALUE_INDEX = (SIZEC(TBL_PRBUF.CLMN(0)) -
      836     3210    2             (SIZEC(TEMP_TEXT) - TEMP_INDEX))/2;
      837     3211    2           CALL INSERT(TBL_PRBUF.CLMN(INDX),VALUE_INDEX,,
      838     3212    2             SUBSTR(TEMP_TEXT,TEMP_INDEX,(SIZEC(TEMP_TEXT)-TEMP_INDEX)));
      839     3213    2           RETURN;
      840     3214    2   END;
      841     3215        /**/
      842     3216    1   PCT_ERR:
      843     3217    1           ALTRETURN;
      844     3218    1   END PCT$TABLES;
      845     3219        %EOD;

PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:28   
--  Include file information  --

   B_SEGIDS_C.:E05TOU  is referenced.
   JM$STRUCT.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   PC_PERR_C.:E05TOU  is referenced.
   PC_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure PCT$TABLES.

   Procedure PCT$TABLES requires 1663 words for executable code.
   Procedure PCT$TABLES requires 16 words of local(AUTO) storage.

PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:29   

 Object Unit name= PCT$TABLES                                 File name= PCT$TABLES.:E05TOU
 UTS= JUL 30 '97 04:21:53.52 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none   288    440  PCT$TABLES
    2   DCB   even  none     0      0  M$LO
    3  RoData even  UTS      2      2  PCT$TABLES
    4   Proc  even  none  1663   3177  PCT$TABLES
    5  RoData even  none    17     21  PCT$TABLES

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        1  PCT$TABLES
     4      3          yes     yes      Std        1  PCT$SYSTEM
     4    502          yes     yes      Std        1  PCT$PARTITION
     4   1702          yes     yes      Std        1  PCT$RESOURCE
     4   2507          yes     yes      Std        1  PCT$EXCEPTION
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:30   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 PCW$WRITE
 yes     yes           Std       1 PCP$PDISP
         yes           Std       2 PCR$RESTEXT
 yes     yes           Std       2 PCE$ERROR
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$LO                                  SYSTEM$
     PART$                                 RES$                                  EX$
     NUM_PSURES                            MONPTR$                               MONPART$
     INDEX_FLGS                            PART#_FLGS                            TEXTC_PART#X
     TEXTC_MODE                            TEXTC_DOMAIN                          RESTEXT_C
     TPSYS                                 FR_MEMC                               FR_MEMM
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ROSID                                 ISSID
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:31   


        1        1        /*M*     PCT$TABLES - Displays CONTROL parameters in tabular format */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*/
        8        8        PCT$TABLES: PROC(PCT_PARAM) ALTRET;

      8  4 000000   000000 700200 xent  PCT$TABLES   TSX0  ! X66_AUTO_1
         4 000001   000020 000001                    ZERO    16,1
         4 000002   000005 710000 4                  TRA     s:2569

        9        9        /**/
       10       10    1   DCL PCT_PARAM UBIN WORD;
       11       11        /**/
       12       12        /*********************************************************************/
       13       13        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
       14       14        /*********************************************************************/
       15       15        /**/
       16       16        %INCLUDE PC_SUBS_C;
       17      348        %INCLUDE PC_PERR_C;
       18      381        %INCLUDE CP_6;
       19      462        %INCLUDE CP_6_SUBS;
       20     1002        %INCLUDE JM$STRUCT;
       21     1747        %INCLUDE B_SEGIDS_C;
       22     2286        /**/
       23     2287        %SUB PSURES_OFFSET = 4;
       24     2288        %SUB MMINDX = 0;
       25     2289        %EJECT;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:32   
       26     2290        /***************************************************************************/
       27     2291        /*   STATIC DATA   STATIC DATA   STATIC DATA   STATIC DATA   STATIC DATA   */
       28     2292        /***************************************************************************/
       29     2293        /**/
       30     2294    1   DCL MODEFLGS(0:%PC_MAXMODE) BIT(1) STATIC UNAL INIT(NO*0);
       31     2295    1   DCL PART#FLGS(0:15) BIT(1) STATIC UNAL INIT(NO*0);
       32     2296    1   DCL DOMAINFLGS(0:%PC_MAXDOMAIN) BIT(1) STATIC UNAL INIT(NO*0);
       33     2297        /**/
       34     2298    1   DCL FIRST_TIME BIT(1) STATIC;
       35     2299        /**/
       36     2300    1   DCL I SBIN WORD STATIC;
       37     2301    1   DCL J SBIN WORD STATIC;
       38     2302    1   DCL K SBIN WORD STATIC;
       39     2303        /**/
       40     2304    1   DCL TEMP$ PTR STATIC;
       41     2305        /**/
       42     2306    1   DCL CUR_MODE SBIN WORD STATIC;
       43     2307    1   DCL MAX_MODE SBIN WORD STATIC;
       44     2308    1   DCL CUR_DOMAIN SBIN WORD STATIC;
       45     2309    1   DCL MAX_DOMAIN SBIN WORD STATIC;
       46     2310    1   DCL CUR_TABLE SBIN WORD STATIC;
       47     2311    1   DCL MAX_TABLE SBIN WORD STATIC;
       48     2312    1   DCL RES_INDX SBIN WORD STATIC;
       49     2313    1   DCL CUR_RESINDX SBIN WORD STATIC;
       50     2314    1   DCL MAX_RESINDX SBIN WORD STATIC;
       51     2315    1   DCL RESLO SBIN WORD STATIC;
       52     2316    1   DCL RESHI SBIN WORD STATIC;
       53     2317    1   DCL MAX_CLMN SBIN WORD STATIC;
       54     2318    1   DCL PLATEN SBIN WORD STATIC;
       55     2319    1   DCL VALUE SBIN WORD STATIC;
       56     2320        /**/
       57     2321    1   DCL 1 TBL_PRBUF STATIC,
       58     2322    1         2 NAME CHAR(12) UNAL INIT(' '),
       59     2323    1         2 CLMN(0:11) CHAR(10) UNAL INIT(' '*0);
       60     2324    1   DCL TBL_PRBUFCHAR REDEF TBL_PRBUF CHAR(132);
       61     2325    1   DCL 1 DISP_TBL STATIC,
       62     2326    1         2 INDX UBIN WORD,
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:33   
       63     2327    1         2 PARM(0:99) ALIGNED,
       64     2328    1           3 CAT UBIN(9) UNAL,
       65     2329    1           3 PARM UBIN(9) UNAL,
       66     2330    1           3 INDEXLO UBIN(9) UNAL,
       67     2331    1           3 INDEXHI UBIN(9) UNAL,
       68     2332    1           3 RESINDX SBIN HALF UNAL;
       69     2333    1   DCL 1 XLATE_TBL STATIC,
       70     2334    1         2 DASH1(0:31) CHAR(1) UNAL INIT('-'*0),
       71     2335    1         2 SPACE CHAR(1) UNAL INIT(' '),
       72     2336    1         2 DASH2(0:94) CHAR(1) UNAL INIT('-'*0);
       73     2337        %EJECT;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:34   
       74     2338        /**********************************************************************/
       75     2339        /*   BASED DATA   BASED DATA   BASED DATA   BASED DATA   BASED DATA   */
       76     2340        /**********************************************************************/
       77     2341        /**/
       78     2342        %F$DCB;
       79     2399        %JM_PART (FPTN=JM$PT,STCLASS=BASED);
       80     2454        /**/
       81     2455    1   DCL 1 P$TBL(0:0) BASED ALIGNED,
       82     2456    1         2 FLAGS,
       83     2457    1           3 PRINT BIT(1) UNAL,
       84     2458    1           3 DISPONLY BIT(1) UNAL,
       85     2459    1           3 INDX BIT(1) UNAL,
       86     2460    1           3 RES BIT(1) UNAL,
       87     2461    1           3 MAXCONST BIT(1) UNAL,
       88     2462    1           3 MINCONST BIT(1) UNAL,
       89     2463    1           3 VALTEXT BIT(1) UNAL,
       90     2464    1           3 VALTEXTLIST BIT(1) UNAL,
       91     2465    1           3 INTINDX BIT(1) UNAL,
       92     2466    1           3 * BIT(9) UNAL,
       93     2467    1         2 VALCODE UBIN(18) UNAL,
       94     2468    1         2 RESPTR$ PTR ALIGNED,
       95     2469    1         2 TEXT ALIGNED,
       96     2470    1           3 COUNT UBIN(9) UNAL,
       97     2471    1           3 TEXT CHAR(19) UNAL,
       98     2472    1         2 PTR$ PTR,
       99     2473    1         2 REPTR$ REDEF PTR$,
      100     2474    1           3 ADDRESS UBIN(24) UNAL,
      101     2475    1           3 SEGID UBIN(12) UNAL,
      102     2476    1         2 PSUPTR$ PTR,
      103     2477    1         2 REPSUPTR$ REDEF PSUPTR$,
      104     2478    1           3 ADDRESS UBIN(24) UNAL,
      105     2479    1           3 SEGID UBIN(12) UNAL,
      106     2480    1         2 MAX UBIN WORD UNAL,
      107     2481    1         2 MIN UBIN WORD UNAL,
      108     2482    1         2 MULT UBIN WORD UNAL;
      109     2483        /**/
      110     2484    1   DCL 1 CAT$TBL(0:0) BASED ALIGNED,
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:35   
      111     2485    1         2 FLAGS,
      112     2486    1           3 PRINT BIT(1) UNAL,
      113     2487    1           3 * BIT(17) UNAL,
      114     2488    1         2 MAXPARAM UBIN(18) UNAL,
      115     2489    1         2 PARAM$ PTR;
      116     2490        /**/
      117     2491    1   DCL RES$FLGS(0:15) BIT(1) BASED UNAL;
      118     2492    1   DCL B$TABLE(0:0) UBIN WORD BASED ALIGNED;
      119     2493    1   DCL 1 B$PTR(0:0) BASED ALIGNED,
      120     2494    1         2 ADDRESS UBIN(24) UNAL,
      121     2495    1         2 SEGID UBIN(12) UNAL;
      122     2496        /**/
      123     2497        %EJECT;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:36   
      124     2498        /***********************************************************************/
      125     2499        /*    ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   */
      126     2500        /**********************************************************************/
      127     2501        /**/
      128     2502    1   DCL PCE$ERROR ENTRY(2) ALTRET;
      129     2503    1   DCL PCW$WRITE ENTRY(2) ALTRET;
      130     2504    1   DCL PCP$PDISP ENTRY(1) ALTRET;
      131     2505    1   DCL PCR$RESTEXT ENTRY(2);
      132     2506        /**/
      133     2507        /********************************************************************/
      134     2508        /*   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   */
      135     2509        /********************************************************************/
      136     2510        /**/
      137     2511    1   DCL M$LO DCB;                           /* ALL OUTPUT                         */
      138     2512        /**/
      139     2513        /*****************************************************************/
      140     2514        /*   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   */
      141     2515        /*****************************************************************/
      142     2516        /**/
      143     2517    1   DCL CAT$ PTR SYMREF;
      144     2518    1   DCL SYSTEM$ PTR SYMREF;
      145     2519    1   DCL PART$ PTR SYMREF;
      146     2520    1   DCL RES$ PTR SYMREF;
      147     2521    1   DCL EX$ PTR SYMREF;
      148     2522        /**/
      149     2523    1   DCL NUM_PSURES SBIN WORD SYMREF;
      150     2524    1   DCL RES_TEXT(0:3) CHAR(2) SYMREF;
      151     2525    1   DCL PSURES_TEXT(0:7) CHAR(8) SYMREF;
      152     2526        /**/
      153     2527    1   DCL MONPTR$ PTR SYMREF;
      154     2528    1   DCL 1 MONPTR REDEF MONPTR$,
      155     2529    1         2 ADDRESS UBIN(24) UNAL,
      156     2530    1         2 SEGID UBIN(12) UNAL;
      157     2531    1   DCL MONPART$ PTR SYMREF;
      158     2532        /**/
      159     2533    1   DCL 1 INDEX_FLGS SYMREF,
      160     2534    1         2 MODE(0:%PC_MAXMODE) BIT(1) UNAL,
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:37   
      161     2535    1         2 PART#(0:15) BIT(1) UNAL,
      162     2536    1         2 DOMAINE(0:%PC_MAXDOMAIN) BIT(1) UNAL;
      163     2537        /**/
      164     2538    1   DCL PART#_FLGS(0:15) BIT(1) SYMREF;
      165     2539        /**/
      166     2540    1   DCL 1 TEXTC_PART#X(0:15) SYMREF,
      167     2541    1         2 COUNT UBIN(9) UNAL,
      168     2542    1         2 TEXT CHAR(3) UNAL;
      169     2543        /**/
      170     2544    1   DCL 1 TEXTC_MODE(0:%PC_MAXMODE) SYMREF,
      171     2545    1         2 COUNT UBIN(9) UNAL,
      172     2546    1         2 TEXT CHAR(11) UNAL;
      173     2547        /**/
      174     2548    1   DCL 1 TEXTC_DOMAIN(0:%PC_MAXDOMAIN) SYMREF,
      175     2549    1         2 COUNT UBIN(9) UNAL,
      176     2550    1         2 TEXT CHAR(7) UNAL;
      177     2551        /**/
      178     2552    1   DCL 1 RESTEXT_C SYMREF,
      179     2553    1         2 COUNT UBIN(9) UNAL,
      180     2554    1         2 TEXT CHAR(12) UNAL;
      181     2555        /**/
      182     2556    1   DCL TPSYS BIT(1) SYMREF;                /* TP SYSTEM FLAG                     */
      183     2557        /**/
      184     2558        /*  MONITOR SYMREFS  */
      185     2559        /**/
      186     2560    1   DCL FR_MEMC UBIN WORD SYMREF;
      187     2561    1   DCL FR_MEMM UBIN WORD SYMREF;
      188     2562        %EJECT;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:38   
      189     2563        /*****************************************************************************/
      190     2564        /*   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   */
      191     2565        /*****************************************************************************/
      192     2566        /**/
      193     2567    1   PCT$SYSTEM: ENTRY(PCT_PARAM) ALTRET;

   2567  4 000003   000000 700200 xent  PCT$SYSTEM   TSX0  ! X66_AUTO_1
         4 000004   000020 000001                    ZERO    16,1

      194     2568        /**/
      195     2569    2           IF (PCT_PARAM = %PC_PCTALL) THEN DO I = 1 TO %PC_MAXMODE;

   2569  4 000005   200003 470500                    LDP0    @PCT_PARAM,,AUTO
         4 000006   000000 235100                    LDA     0,,PR0
         4 000007   000001 115007                    CMPA    1,DL
         4 000010   000026 601000 4                  TNZ     s:2573

   2569  4 000011   000001 236007                    LDQ     1,DL
         4 000012   000004 756000 1                  STQ     I

      196     2570    2              MODEFLGS(I) = YES;

   2570  4 000013   000004 235000 1                  LDA     I
         4 000014   000016 605000 4                  TPL     s:2570+3
         4 000015   000044 035003                    ADLA    36,DU
         4 000016   003005 060400                    CSL     bolr='003'O
         4 000017   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         4 000020   000000 000001 1                  BDSC    MODEFLGS,A               by=0,bit=0,n=1

      197     2571    2              END;

   2571  4 000021   000004 054000 1                  AOS     I
         4 000022   000004 235000 1                  LDA     I
         4 000023   000004 115007                    CMPA    4,DL
         4 000024   000013 604400 4                  TMOZ    s:2570
         4 000025   000032 710000 4                  TRA     s:2575

PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:39   
      198     2572        /**/
      199     2573    1           ELSE MODEFLGS = INDEX_FLGS.MODE;

   2573  4 000026   000000 236000 xsym               LDQ     INDEX_FLGS
         4 000027   000000 676000 1                  ERQ     MODEFLGS
         4 000030   760000 376003                    ANQ     -8192,DU
         4 000031   000000 656000 1                  ERSQ    MODEFLGS

      200     2574        /**/
      201     2575    1           IF (MODEFLGS = NO) THEN RETURN;

   2575  4 000032   000000 236000 1                  LDQ     MODEFLGS
         4 000033   760000 316003                    CANQ    -8192,DU
         4 000034   000036 601000 4                  TNZ     s:2577

   2575  4 000035   000000 702200 xent               TSX2  ! X66_ARET

      202     2576        /**/
      203     2577    1           CALL SET_MAXCLMN ALTRET(PCT_ERR);

   2577  4 000036   003061 701000 4                  TSX1    SET_MAXCLMN
         4 000037   003176 702000 4                  TSX2    PCT_ERR

      204     2578        /**/
      205     2579    1           CUR_MODE = 1;

   2579  4 000040   000001 235007                    LDA     1,DL
         4 000041   000010 755000 1                  STA     CUR_MODE

      206     2580        /**/
      207     2581    1   NEXT_TABLE:
      208     2582    1           I = CUR_MODE;

   2582  4 000042   000010 235000 1     NEXT_TABLE   LDA     CUR_MODE
         4 000043   000004 755000 1                  STA     I

      209     2583    1           J = 0;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:40   

   2583  4 000044   000005 450000 1                  STZ     J

      210     2584    1           TBL_PRBUFCHAR = ' ';

   2584  4 000045   040000 100400                    MLR     fill='040'O
         4 000046   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000047   000026 000204 1                  ADSC9   TBL_PRBUF                cn=0,n=132

      211     2585        /**/
      212     2586    2           DO WHILE (J <= MAX_CLMN);

   2586  4 000050   000005 236000 1                  LDQ     J
         4 000051   000023 116000 1                  CMPQ    MAX_CLMN
         4 000052   000142 605400 4                  TPNZ    s:2602

      213     2587    3              IF (MODEFLGS(I)) THEN DO;

   2587  4 000053   000004 235000 1                  LDA     I
         4 000054   000056 605000 4                  TPL     s:2587+3
         4 000055   000044 035003                    ADLA    36,DU
         4 000056   000000 066405                    CMPB    filb='0'B
         4 000057   000000 000001 1                  BDSC    MODEFLGS,A               by=0,bit=0,n=1
         4 000060   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 000061   000112 600000 4                  TZE     s:2593

      214     2588    3                 K = (SIZEC(TBL_PRBUF.CLMN(0)) - TEXTC_MODE.COUNT(I))/2;

   2588  4 000062   000004 236000 1                  LDQ     I
         4 000063   000003 402007                    MPY     3,DL
         4 000064   000000 236006 xsym               LDQ     TEXTC_MODE,QL
         4 000065   000033 772000                    QRL     27
         4 000066   000027 676000 xsym               ERQ     B_VECTNIL+23
         4 000067   000013 036007                    ADLQ    11,DL
         4 000070   000002 506007                    DIV     2,DL
         4 000071   000006 756000 1                  STQ     K

PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:41   
      215     2589    3                 CALL INSERT(TBL_PRBUF.CLMN(J),K,TEXTC_MODE.COUNT(I),

   2589  4 000072   000005 236000 1                  LDQ     J
         4 000073   000012 402007                    MPY     10,DL
         4 000074   000006 036000 1                  ADLQ    K
         4 000075   200014 756100                    STQ     VALUE_INDEX+1,,AUTO
         4 000076   000004 236000 1                  LDQ     I
         4 000077   000003 402007                    MPY     3,DL
         4 000100   000000 236006 xsym               LDQ     TEXTC_MODE,QL
         4 000101   000033 772000                    QRL     27
         4 000102   000000 620006                    EAX0    0,QL
         4 000103   000004 236000 1                  LDQ     I
         4 000104   000014 402007                    MPY     12,DL
         4 000105   200014 235100                    LDA     VALUE_INDEX+1,,AUTO
         4 000106   040045 100406                    MLR     fill='040'O
         4 000107   000000 200013 xsym               ADSC9   TEXTC_MODE,Q             cn=1,n=11
         4 000110   000031 000010 1                  ADSC9   TBL_PRBUF+3,A            cn=0,n=*X0

      216     2590    3                   TEXTC_MODE.TEXT(I));
      217     2591    3                 J = J+1;

   2591  4 000111   000005 054000 1                  AOS     J

      218     2592    3                 END;

      219     2593    2              I = I+1;

   2593  4 000112   000004 054000 1                  AOS     I

      220     2594    2              IF ((TPSYS)AND(I > %PC_MAXMODE))OR

   2594  4 000113   000000 234000 xsym               SZN     TPSYS
         4 000114   000120 605000 4                  TPL     s:2594+5
         4 000115   000004 235000 1                  LDA     I
         4 000116   000004 115007                    CMPA    4,DL
         4 000117   000127 605400 4                  TPNZ    s:2596
         4 000120   000000 236000 xsym               LDQ     TPSYS
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:42   
         4 000121   400000 376003                    ANQ     -131072,DU
         4 000122   400000 676003                    ERQ     -131072,DU
         4 000123   000137 600000 4                  TZE     s:2601
         4 000124   000004 235000 1                  LDA     I
         4 000125   000003 115007                    CMPA    3,DL
         4 000126   000137 604400 4                  TMOZ    s:2601

      221     2595    3                ((~TPSYS)AND(I > %PC_MAXMODE-1)) THEN DO;

      222     2596    3                 IF (TPSYS) THEN MAX_MODE = %PC_MAXMODE;

   2596  4 000127   000000 234000 xsym               SZN     TPSYS
         4 000130   000134 605000 4                  TPL     s:2597

   2596  4 000131   000004 236007                    LDQ     4,DL
         4 000132   000011 756000 1                  STQ     MAX_MODE
         4 000133   000136 710000 4                  TRA     s:2598

      223     2597    3                 ELSE MAX_MODE = %PC_MAXMODE-1;

   2597  4 000134   000003 236007                    LDQ     3,DL
         4 000135   000011 756000 1                  STQ     MAX_MODE

      224     2598    3                 GOTO TABLE_PRINT;

   2598  4 000136   000156 710000 4                  TRA     TABLE_PRINT

      225     2599    3                 END;
      226     2600        /**/
      227     2601    2              END;

   2601  4 000137   000005 236000 1                  LDQ     J
         4 000140   000023 116000 1                  CMPQ    MAX_CLMN
         4 000141   000053 604400 4                  TMOZ    s:2587

      228     2602    2           IF (J > MAX_CLMN) THEN DO;

PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:43   
   2602  4 000142   000147 604400 4                  TMOZ    s:2607

      229     2603    2              MAX_MODE = I - 1;

   2603  4 000143   000004 235000 1                  LDA     I
         4 000144   000001 135007                    SBLA    1,DL
         4 000145   000011 755000 1                  STA     MAX_MODE

      230     2604    2              GOTO TABLE_PRINT;

   2604  4 000146   000156 710000 4                  TRA     TABLE_PRINT

      231     2605    2              END;
      232     2606        /**/
      233     2607    1           IF (TPSYS) THEN MAX_MODE = %PC_MAXMODE;

   2607  4 000147   000000 234000 xsym               SZN     TPSYS
         4 000150   000154 605000 4                  TPL     s:2608

   2607  4 000151   000004 235007                    LDA     4,DL
         4 000152   000011 755000 1                  STA     MAX_MODE
         4 000153   000156 710000 4                  TRA     TABLE_PRINT

      234     2608    1           ELSE MAX_MODE = %PC_MAXMODE - 1;

   2608  4 000154   000003 235007                    LDA     3,DL
         4 000155   000011 755000 1                  STA     MAX_MODE

      235     2609        /**/
      236     2610    1   TABLE_PRINT:
      237     2611        /**/
      238     2612    1           IF (J = 0) THEN GOTO NONTABLE_PRINT;

   2612  4 000156   000005 235000 1     TABLE_PRINT  LDA     J
         4 000157   000421 600000 4                  TZE     NONTABLE_PRINT

      239     2613    1           FIRST_TIME = YES;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:44   

   2613  4 000160   400000 236003                    LDQ     -131072,DU
         4 000161   000003 756000 1                  STQ     FIRST_TIME

      240     2614        /**/
      241     2615    2           DO I = 1 TO %PC_SYSTEMHI;

   2615  4 000162   000001 235007                    LDA     1,DL
         4 000163   000004 755000 1                  STA     I

      242     2616    2              IF ((SYSTEM$ -> P$TBL.FLAGS.INDX(I))AND((PCT_PARAM = %PC_PCTALL)OR

   2616  4 000164   000004 236000 1                  LDQ     I
         4 000165   000014 402007                    MPY     12,DL
         4 000166   000000 470400 xsym               LDP0    SYSTEM$
         4 000167   000000 236106                    LDQ     0,QL,PR0
         4 000170   100000 316003                    CANQ    32768,DU
         4 000171   000356 600000 4                  TZE     s:2650
         4 000172   200003 471500                    LDP1    @PCT_PARAM,,AUTO
         4 000173   100000 235100                    LDA     0,,PR1
         4 000174   000001 115007                    CMPA    1,DL
         4 000175   000202 600000 4                  TZE     s:2618
         4 000176   000004 236000 1                  LDQ     I
         4 000177   000014 402007                    MPY     12,DL
         4 000200   000000 234106                    SZN     0,QL,PR0
         4 000201   000356 605000 4                  TPL     s:2650

      243     2617    3                (SYSTEM$ -> P$TBL.FLAGS.PRINT(I)))) THEN DO;

      244     2618    4                 IF (FIRST_TIME) THEN DO;

   2618  4 000202   000003 234000 1                  SZN     FIRST_TIME
         4 000203   000244 605000 4                  TPL     s:2630

      245     2619    4                    FIRST_TIME = NO;

   2619  4 000204   000003 450000 1                  STZ     FIRST_TIME
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:45   

      246     2620    4                    CALL PCW$WRITE(TBL_PRBUF,SIZEC(TBL_PRBUF.NAME)+

   2620  4 000205   000023 236000 1                  LDQ     MAX_CLMN
         4 000206   000012 402007                    MPY     10,DL
         4 000207   000026 036007                    ADLQ    22,DL
         4 000210   200014 756100                    STQ     VALUE_INDEX+1,,AUTO
         4 000211   200014 633500                    EPPR3   VALUE_INDEX+1,,AUTO
         4 000212   200017 453500                    STP3    VALUE_INDEX+4,,AUTO
         4 000213   000000 236000 5                  LDQ     0
         4 000214   200016 756100                    STQ     VALUE_INDEX+3,,AUTO
         4 000215   200016 630500                    EPPR0   VALUE_INDEX+3,,AUTO
         4 000216   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000217   000000 701000 xent               TSX1    PCW$WRITE
         4 000220   003176 702000 4                  TSX2    PCT_ERR

      247     2621    4                      SIZEC(TBL_PRBUF.CLMN(0))*(MAX_CLMN+1))
      248     2622    4                      ALTRET(PCT_ERR);
      249     2623    4                    CALL XLATE(TBL_PRBUFCHAR,XLATE_TBL,TBL_PRBUFCHAR);

   2623  4 000221   040000 160400                    MVT     fill='040'O
         4 000222   000026 000204 1                  ADSC9   TBL_PRBUF                cn=0,n=132
         4 000223   000026 000204 1                  ADSC9   TBL_PRBUF                cn=0,n=132
         4 000224   000400 000000 1                  ARG     XLATE_TBL

      250     2624                                                /* TRANSLATE TO DASHES                */
      251     2625    4                    CALL PCW$WRITE(TBL_PRBUF,SIZEC(TBL_PRBUF.NAME)+

   2625  4 000225   000023 236000 1                  LDQ     MAX_CLMN
         4 000226   000012 402007                    MPY     10,DL
         4 000227   000026 036007                    ADLQ    22,DL
         4 000230   200014 756100                    STQ     VALUE_INDEX+1,,AUTO
         4 000231   200014 630500                    EPPR0   VALUE_INDEX+1,,AUTO
         4 000232   200017 450500                    STP0    VALUE_INDEX+4,,AUTO
         4 000233   000000 236000 5                  LDQ     0
         4 000234   200016 756100                    STQ     VALUE_INDEX+3,,AUTO
         4 000235   200016 630500                    EPPR0   VALUE_INDEX+3,,AUTO
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:46   
         4 000236   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000237   000000 701000 xent               TSX1    PCW$WRITE
         4 000240   003176 702000 4                  TSX2    PCT_ERR

      252     2626    4                      SIZEC(TBL_PRBUF.CLMN(0))*(MAX_CLMN+1))
      253     2627    4                      ALTRET(PCT_ERR);
      254     2628    4                    TBL_PRBUFCHAR = ' ';

   2628  4 000241   040000 100400                    MLR     fill='040'O
         4 000242   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000243   000026 000204 1                  ADSC9   TBL_PRBUF                cn=0,n=132

      255     2629    4                    END;

      256     2630    3                 CALL INSERT(TBL_PRBUF.NAME,(SIZEC(TBL_PRBUF.NAME) -

   2630  4 000244   000004 236000 1                  LDQ     I
         4 000245   000014 402007                    MPY     12,DL
         4 000246   000000 470400 xsym               LDP0    SYSTEM$
         4 000247   000002 236106                    LDQ     2,QL,PR0
         4 000250   000033 772000                    QRL     27
         4 000251   200014 756100                    STQ     VALUE_INDEX+1,,AUTO
         4 000252   000004 236000 1                  LDQ     I
         4 000253   000014 402007                    MPY     12,DL
         4 000254   000002 236106                    LDQ     2,QL,PR0
         4 000255   000033 772000                    QRL     27
         4 000256   000000 620006                    EAX0    0,QL
         4 000257   000004 236000 1                  LDQ     I
         4 000260   000060 402007                    MPY     48,DL
         4 000261   000000 235003                    LDA     0,DU
         4 000262   200014 135100                    SBLA    VALUE_INDEX+1,,AUTO
         4 000263   040045 100506                    MLR     fill='040'O
         4 000264   000002 200023                    ADSC9   2,Q,PR0                  cn=1,n=19
         4 000265   000031 000010 1                  ADSC9   TBL_PRBUF+3,A            cn=0,n=*X0

      257     2631    3                   SYSTEM$ ->P$TBL.TEXT.COUNT(I)),SYSTEM$ -> P$TBL.TEXT.COUNT(I),
      258     2632    3                   SYSTEM$ -> P$TBL.TEXT.TEXT(I));
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:47   
      259     2633        /**/
      260     2634    3                 K = 0;                    /* CLMN NUMBER                        */

   2634  4 000266   000006 450000 1                  STZ     K

      261     2635    4                 DO J = CUR_MODE TO MAX_MODE;

   2635  4 000267   000010 235000 1                  LDA     CUR_MODE
         4 000270   000005 755000 1                  STA     J
         4 000271   000334 710000 4                  TRA     s:2645+1

      262     2636    5                    IF (MODEFLGS(J)) THEN DO; /* SELECTED MODE                   */

   2636  4 000272   000005 235000 1                  LDA     J
         4 000273   000275 605000 4                  TPL     s:2636+3
         4 000274   000044 035003                    ADLA    36,DU
         4 000275   000000 066405                    CMPB    filb='0'B
         4 000276   000000 000001 1                  BDSC    MODEFLGS,A               by=0,bit=0,n=1
         4 000277   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 000300   000333 600000 4                  TZE     s:2645

      263     2637    5                       MONPTR.ADDRESS = SYSTEM$ -> P$TBL.REPTR$.ADDRESS(I);

   2637  4 000301   000004 236000 1                  LDQ     I
         4 000302   000014 402007                    MPY     12,DL
         4 000303   000000 470400 xsym               LDP0    SYSTEM$
         4 000304   000007 236106                    LDQ     7,QL,PR0
         4 000305   000000 752074 xsym               STCQ    MONPTR$,'74'O

      264     2638        /**/
      265     2639    5                       VALUE = MONPTR$ -> B$TABLE(J);

   2639  4 000306   000000 471400 xsym               LDP1    MONPTR$
         4 000307   000005 720000 1                  LXL0    J
         4 000310   100000 235110                    LDA     0,X0,PR1
         4 000311   000025 755000 1                  STA     VALUE

PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:48   
      266     2640    5                       VALUE = VALUE/(SYSTEM$ -> P$TBL.MULT(I));

   2640  4 000312   000004 236000 1                  LDQ     I
         4 000313   000014 402007                    MPY     12,DL
         4 000314   000000 621006                    EAX1    0,QL
         4 000315   000025 236000 1                  LDQ     VALUE
         4 000316   000013 235111                    LDA     11,X1,PR0
         4 000317   000322 605000 4                  TPL     s:2640+8
         4 000320   000000 236003                    LDQ     0,DU
         4 000321   000323 710000 4                  TRA     s:2640+9
         4 000322   000013 506111                    DIV     11,X1,PR0
         4 000323   000025 756000 1                  STQ     VALUE

      267     2641    5                       CALL TABLE_ENTRY(K,VALUE);

   2641  4 000324   000001 236000 5                  LDQ     1
         4 000325   200006 756100                    STQ     @INDX+1,,AUTO
         4 000326   000002 236000 5                  LDQ     2
         4 000327   200005 756100                    STQ     @PCT_PARAM+2,,AUTO
         4 000330   003132 701000 4                  TSX1    TABLE_ENTRY
         4 000331   000000 011000                    NOP     0

      268     2642        /**/
      269     2643    5                       K = K + 1;

   2643  4 000332   000006 054000 1                  AOS     K

      270     2644    5                       END;

      271     2645    4                    END;

   2645  4 000333   000005 054000 1                  AOS     J
         4 000334   000005 236000 1                  LDQ     J
         4 000335   000011 116000 1                  CMPQ    MAX_MODE
         4 000336   000272 604400 4                  TMOZ    s:2636

      272     2646    3                 CALL PCW$WRITE(TBL_PRBUF,SIZEC(TBL_PRBUF.NAME)+
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:49   

   2646  4 000337   000023 236000 1                  LDQ     MAX_CLMN
         4 000340   000012 402007                    MPY     10,DL
         4 000341   000026 036007                    ADLQ    22,DL
         4 000342   200014 756100                    STQ     VALUE_INDEX+1,,AUTO
         4 000343   200014 630500                    EPPR0   VALUE_INDEX+1,,AUTO
         4 000344   200017 450500                    STP0    VALUE_INDEX+4,,AUTO
         4 000345   000000 236000 5                  LDQ     0
         4 000346   200016 756100                    STQ     VALUE_INDEX+3,,AUTO
         4 000347   200016 630500                    EPPR0   VALUE_INDEX+3,,AUTO
         4 000350   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000351   000000 701000 xent               TSX1    PCW$WRITE
         4 000352   003176 702000 4                  TSX2    PCT_ERR

      273     2647    3                   SIZEC(TBL_PRBUF.CLMN(0))*(MAX_CLMN+1)) ALTRET(PCT_ERR);
      274     2648    3                 TBL_PRBUFCHAR = ' ';

   2648  4 000353   040000 100400                    MLR     fill='040'O
         4 000354   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000355   000026 000204 1                  ADSC9   TBL_PRBUF                cn=0,n=132

      275     2649    3                 END;

      276     2650    2              END;

   2650  4 000356   000004 054000 1                  AOS     I
         4 000357   000004 235000 1                  LDA     I
         4 000360   000070 115007                    CMPA    56,DL
         4 000361   000164 604400 4                  TMOZ    s:2616

      277     2651        /**/
      278     2652    1           CALL PCW$WRITE(TEXTC_MODE.TEXT(0),1) ALTRET(PCT_ERR); /* BLANK LINE   */

   2652  4 000362   000003 630400 5                  EPPR0   3
         4 000363   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000364   000000 701000 xent               TSX1    PCW$WRITE
         4 000365   003176 702000 4                  TSX2    PCT_ERR
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:50   

      279     2653        /**/
      280     2654    1           IF ((TPSYS)AND(MAX_MODE < %PC_MAXMODE))OR /* SEE IF NEW TABLE NEEDED   */

   2654  4 000366   000000 234000 xsym               SZN     TPSYS
         4 000367   000373 605000 4                  TPL     s:2654+5
         4 000370   000011 235000 1                  LDA     MAX_MODE
         4 000371   000004 115007                    CMPA    4,DL
         4 000372   000402 604000 4                  TMI     s:2656
         4 000373   000000 236000 xsym               LDQ     TPSYS
         4 000374   400000 376003                    ANQ     -131072,DU
         4 000375   400000 676003                    ERQ     -131072,DU
         4 000376   000421 600000 4                  TZE     NONTABLE_PRINT
         4 000377   000011 235000 1                  LDA     MAX_MODE
         4 000400   000003 115007                    CMPA    3,DL
         4 000401   000421 605000 4                  TPL     NONTABLE_PRINT

      281     2655    2             ((~TPSYS)AND(MAX_MODE < %PC_MAXMODE-1)) THEN DO;

      282     2656    2              CUR_MODE = MAX_MODE + 1;

   2656  4 000402   000001 035007                    ADLA    1,DL
         4 000403   000010 755000 1                  STA     CUR_MODE

      283     2657    3              DO I = CUR_MODE TO %PC_MAXMODE;

   2657  4 000404   000004 755000 1                  STA     I
         4 000405   000416 710000 4                  TRA     s:2659+1

      284     2658    3                 IF (MODEFLGS(I)) THEN GOTO NEXT_TABLE;

   2658  4 000406   000004 235000 1                  LDA     I
         4 000407   000411 605000 4                  TPL     s:2658+3
         4 000410   000044 035003                    ADLA    36,DU
         4 000411   000000 066405                    CMPB    filb='0'B
         4 000412   000000 000001 1                  BDSC    MODEFLGS,A               by=0,bit=0,n=1
         4 000413   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:51   
         4 000414   000042 601000 4                  TNZ     NEXT_TABLE

      285     2659    3                 END;

   2659  4 000415   000004 054000 1                  AOS     I
         4 000416   000004 235000 1                  LDA     I
         4 000417   000004 115007                    CMPA    4,DL
         4 000420   000406 604400 4                  TMOZ    s:2658

      286     2660    2              END;

      287     2661        /**/
      288     2662    1   NONTABLE_PRINT:
      289     2663    1           DISP_TBL = NO;

   2663  4 000421   000000 100400       NONTABLE_PR* MLR     fill='000'O
         4 000422   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 000423   000067 001444 1                  ADSC9   DISP_TBL                 cn=0,n=804

      290     2664    1           J = 0;

   2664  4 000424   000005 450000 1                  STZ     J

      291     2665        /**/
      292     2666    2           DO I = 1 TO %PC_SYSTEMHI;

   2666  4 000425   000001 235007                    LDA     1,DL
         4 000426   000004 755000 1                  STA     I

      293     2667    2              IF (~ SYSTEM$ -> P$TBL.FLAGS.INDX(I))AND

   2667  4 000427   000004 236000 1                  LDQ     I
         4 000430   000014 402007                    MPY     12,DL
         4 000431   000000 470400 xsym               LDP0    SYSTEM$
         4 000432   000000 236106                    LDQ     0,QL,PR0
         4 000433   000002 736000                    QLS     2
         4 000434   400000 376003                    ANQ     -131072,DU
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:52   
         4 000435   400000 676003                    ERQ     -131072,DU
         4 000436   000465 600000 4                  TZE     s:2675
         4 000437   200003 471500                    LDP1    @PCT_PARAM,,AUTO
         4 000440   100000 235100                    LDA     0,,PR1
         4 000441   000001 115007                    CMPA    1,DL
         4 000442   000447 600000 4                  TZE     s:2670
         4 000443   000004 236000 1                  LDQ     I
         4 000444   000014 402007                    MPY     12,DL
         4 000445   000000 234106                    SZN     0,QL,PR0
         4 000446   000465 605000 4                  TPL     s:2675

      294     2668    2                ((PCT_PARAM = %PC_PCTALL)OR
      295     2669    3                (SYSTEM$ -> P$TBL.FLAGS.PRINT(I))) THEN DO;

      296     2670    3                 DISP_TBL.PARM.CAT(J) = %PC_SYSTEM;

   2670  4 000447   000005 235000 1                  LDA     J
         4 000450   000001 735000                    ALS     1
         4 000451   000070 236005 1                  LDQ     DISP_TBL+1,AL
         4 000452   000032 376000 xsym               ANQ     B_VECTNIL+26
         4 000453   001000 276003                    ORQ     512,DU
         4 000454   000070 756005 1                  STQ     DISP_TBL+1,AL

      297     2671    3                 DISP_TBL.PARM.PARM(J) = I;

   2671  4 000455   000004 236000 1                  LDQ     I
         4 000456   000022 736000                    QLS     18
         4 000457   000070 676005 1                  ERQ     DISP_TBL+1,AL
         4 000460   000777 376003                    ANQ     511,DU
         4 000461   000070 656005 1                  ERSQ    DISP_TBL+1,AL

      298     2672    3                 DISP_TBL.PARM.RESINDX(J) = -1;

   2672  4 000462   777777 220003                    LDX0    -1,DU
         4 000463   000071 740005 1                  STX0    DISP_TBL+2,AL

      299     2673    3                 J = J+1;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:53   

   2673  4 000464   000005 054000 1                  AOS     J

      300     2674    3                 END;

      301     2675    2              END;

   2675  4 000465   000004 054000 1                  AOS     I
         4 000466   000004 235000 1                  LDA     I
         4 000467   000070 115007                    CMPA    56,DL
         4 000470   000427 604400 4                  TMOZ    s:2667

      302     2676        /**/
      303     2677    2           IF (J ~= 0) THEN DO;            /* SOMETHING TO DISPLAY               */

   2677  4 000471   000005 236000 1                  LDQ     J
         4 000472   000501 600000 4                  TZE     s:2681

      304     2678    2              DISP_TBL.INDX = J-1;

   2678  4 000473   000001 136007                    SBLQ    1,DL
         4 000474   000067 756000 1                  STQ     DISP_TBL

      305     2679    2              CALL PCP$PDISP(DISP_TBL) ALTRET(PCT_ERR);

   2679  4 000475   000005 630400 5                  EPPR0   5
         4 000476   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000477   000000 701000 xent               TSX1    PCP$PDISP
         4 000500   003176 702000 4                  TSX2    PCT_ERR

      306     2680    2              END;

      307     2681    1           RETURN;

   2681  4 000501   000000 702200 xent               TSX2  ! X66_ARET

      308     2682        %EJECT;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:54   
      309     2683        /**/
      310     2684    1   PCT$PARTITION: ENTRY(PCT_PARAM) ALTRET;

   2684  4 000502   000000 700200 xent  PCT$PARTITI* TSX0  ! X66_AUTO_1
         4 000503   000020 000001                    ZERO    16,1

      311     2685        /**/
      312     2686    2           IF (PCT_PARAM = %PC_PCTALL) THEN DO I = 0 TO 15; /* ALL                */

   2686  4 000504   200003 470500                    LDP0    @PCT_PARAM,,AUTO
         4 000505   000000 235100                    LDA     0,,PR0
         4 000506   000001 115007                    CMPA    1,DL
         4 000507   000524 601000 4                  TNZ     s:2690

   2686  4 000510   000004 450000 1                  STZ     I

      313     2687    2              PART#FLGS(I) = YES;

   2687  4 000511   000004 235000 1                  LDA     I
         4 000512   000514 605000 4                  TPL     s:2687+3
         4 000513   000044 035003                    ADLA    36,DU
         4 000514   003005 060400                    CSL     bolr='003'O
         4 000515   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         4 000516   000001 000001 1                  BDSC    PART#FLGS,A              by=0,bit=0,n=1

      314     2688    2              END;

   2688  4 000517   000004 054000 1                  AOS     I
         4 000520   000004 235000 1                  LDA     I
         4 000521   000017 115007                    CMPA    15,DL
         4 000522   000511 604400 4                  TMOZ    s:2687
         4 000523   000540 710000 4                  TRA     s:2694

      315     2689        /**/
      316     2690    1           ELSE IF (PCT_PARAM = %PC_PCTFLAGS) THEN PART#FLGS = INDEX_FLGS.PART#;

   2690  4 000524   000002 115007                    CMPA    2,DL
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:55   
         4 000525   000534 601000 4                  TNZ     s:2692

   2690  4 000526   000000 236000 xsym               LDQ     INDEX_FLGS
         4 000527   000005 736000                    QLS     5
         4 000530   000001 676000 1                  ERQ     PART#FLGS
         4 000531   777774 376003                    ANQ     -4,DU
         4 000532   000001 656000 1                  ERSQ    PART#FLGS
         4 000533   000540 710000 4                  TRA     s:2694

      317     2691        /**/
      318     2692    1              ELSE PART#FLGS = PART#_FLGS;

   2692  4 000534   000000 236000 xsym               LDQ     PART#_FLGS
         4 000535   000001 676000 1                  ERQ     PART#FLGS
         4 000536   777774 376003                    ANQ     -4,DU
         4 000537   000001 656000 1                  ERSQ    PART#FLGS

      319     2693        /**/
      320     2694    1           CALL SET_MAXCLMN ALTRET (PCT_ERR);

   2694  4 000540   003061 701000 4                  TSX1    SET_MAXCLMN
         4 000541   003176 702000 4                  TSX2    PCT_ERR

      321     2695        /**/
      322     2696    1           CUR_TABLE = 1;

   2696  4 000542   000001 235007                    LDA     1,DL
         4 000543   000014 755000 1                  STA     CUR_TABLE

      323     2697    1           RES_INDX = 0;

   2697  4 000544   000016 450000 1                  STZ     RES_INDX

      324     2698    1           CUR_RESINDX = 0;

   2698  4 000545   000017 450000 1                  STZ     CUR_RESINDX

PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:56   
      325     2699        /**/
      326     2700    1   NEXT_PTBL:
      327     2701    1           TBL_PRBUFCHAR = ' ';            /* BLANK OUT BUFFER                   */

   2701  4 000546   040000 100400       NEXT_PTBL    MLR     fill='040'O
         4 000547   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000550   000026 000204 1                  ADSC9   TBL_PRBUF                cn=0,n=132

      328     2702    1           I = CUR_TABLE;

   2702  4 000551   000014 235000 1                  LDA     CUR_TABLE
         4 000552   000004 755000 1                  STA     I

      329     2703    1           J = 0;                          /* CLMN INDEX                         */

   2703  4 000553   000005 450000 1                  STZ     J

      330     2704    2           DO WHILE (J <= MAX_CLMN);       /* BUILD HEADING                      */

   2704  4 000554   000005 236000 1                  LDQ     J
         4 000555   000023 116000 1                  CMPQ    MAX_CLMN
         4 000556   000753 605400 4                  TPNZ    s:2753

      331     2705        /**/
      332     2706    3              DO CASE (I);                 /* RESTYPE OR NOT                     */

   2706  4 000557   000004 235000 1                  LDA     I
         4 000560   000005 115007                    CMPA    5,DL
         4 000561   000563 602005 4                  TNC     s:2706+4,AL
         4 000562   000670 710000 4                  TRA     s:2733
         4 000563   000670 710000 4                  TRA     s:2733
         4 000564   000670 710000 4                  TRA     s:2733
         4 000565   000670 710000 4                  TRA     s:2733
         4 000566   000570 710000 4                  TRA     s:2709
         4 000567   000737 710000 4                  TRA     s:2744

      333     2707        /**/
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:57   
      334     2708    3               CASE (%PC_PMINRES);

      335     2709    3                 IF (I = CUR_TABLE) THEN RESLO = CUR_RESINDX;

   2709  4 000570   000004 236000 1                  LDQ     I
         4 000571   000014 116000 1                  CMPQ    CUR_TABLE
         4 000572   000576 601000 4                  TNZ     s:2710

   2709  4 000573   000017 235000 1                  LDA     CUR_RESINDX
         4 000574   000021 755000 1                  STA     RESLO
         4 000575   000577 710000 4                  TRA     s:2711

      336     2710    3                 ELSE RESLO = 0;

   2710  4 000576   000021 450000 1                  STZ     RESLO

      337     2711    4                 DO RES_INDX = RESLO TO NUM_PSURES+PSURES_OFFSET-1;

   2711  4 000577   000021 235000 1                  LDA     RESLO
         4 000600   000016 755000 1                  STA     RES_INDX
         4 000601   000663 710000 4                  TRA     s:2729+1

      338     2712    4                    IF (PCT_PARAM = %PC_PCTALL)OR

   2712  4 000602   200003 470500                    LDP0    @PCT_PARAM,,AUTO
         4 000603   000000 235100                    LDA     0,,PR0
         4 000604   000001 115007                    CMPA    1,DL
         4 000605   000623 600000 4                  TZE     s:2716
         4 000606   000003 115007                    CMPA    3,DL
         4 000607   000623 600000 4                  TZE     s:2716
         4 000610   000004 236000 1                  LDQ     I
         4 000611   000014 402007                    MPY     12,DL
         4 000612   000000 471400 xsym               LDP1    PART$
         4 000613   100001 473506                    LDP3    1,QL,PR1
         4 000614   000016 235000 1                  LDA     RES_INDX
         4 000615   000617 605000 4                  TPL     s:2712+13
         4 000616   000044 035003                    ADLA    36,DU
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:58   
         4 000617   000000 066505                    CMPB    filb='0'B
         4 000620   300000 000001                    BDSC    0,A,PR3                  by=0,bit=0,n=1
         4 000621   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 000622   000662 600000 4                  TZE     s:2729

      339     2713    4                      (PCT_PARAM = %PC_PCTPART#)OR
      340     2714    4                      (PART$ -> P$TBL.RESPTR$(I) -> RES$FLGS(RES_INDX))
      341     2715    5                    THEN DO;

      342     2716    5                       CALL PCR$RESTEXT(RES_INDX,RESTEXT_C);

   2716  4 000623   000006 630400 5                  EPPR0   6
         4 000624   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000625   000000 701000 xent               TSX1    PCR$RESTEXT
         4 000626   000000 011000                    NOP     0

      343     2717    5                       K = (SIZEC(TBL_PRBUF.CLMN(0)) -

   2717  4 000627   000000 236000 xsym               LDQ     RESTEXT_C
         4 000630   000033 772000                    QRL     27
         4 000631   000027 676000 xsym               ERQ     B_VECTNIL+23
         4 000632   000013 036007                    ADLQ    11,DL
         4 000633   000002 506007                    DIV     2,DL
         4 000634   000006 756000 1                  STQ     K

      344     2718    5                         RESTEXT_C.COUNT)/2;
      345     2719    5                       CALL INSERT(TBL_PRBUF.CLMN(J),K,,

   2719  4 000635   000000 236000 xsym               LDQ     RESTEXT_C
         4 000636   000033 772000                    QRL     27
         4 000637   000000 620006                    EAX0    0,QL
         4 000640   000005 236000 1                  LDQ     J
         4 000641   000012 402007                    MPY     10,DL
         4 000642   000006 036000 1                  ADLQ    K
         4 000643   000006 721000 1                  LXL1    K
         4 000644   777765 621011                    EAX1    -11,X1
         4 000645   777777 661003                    ERX1    -1,DU
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:59   
         4 000646   040046 100440                    MLR     fill='040'O
         4 000647   000000 200010 xsym               ADSC9   RESTEXT_C                cn=1,n=*X0
         4 000650   000031 000011 1                  ADSC9   TBL_PRBUF+3,Q            cn=0,n=*X1

      346     2720    5                         SUBSTR(RESTEXT_C.TEXT,0,RESTEXT_C.COUNT));
      347     2721    5                       J = J+1;

   2721  4 000651   000005 054000 1                  AOS     J

      348     2722        /**/
      349     2723    6                       IF (J > MAX_CLMN) THEN DO; /* FILLED TABLE                */

   2723  4 000652   000005 236000 1                  LDQ     J
         4 000653   000023 116000 1                  CMPQ    MAX_CLMN
         4 000654   000662 604400 4                  TMOZ    s:2729

      350     2724    6                          MAX_TABLE = I;

   2724  4 000655   000004 235000 1                  LDA     I
         4 000656   000015 755000 1                  STA     MAX_TABLE

      351     2725    6                          MAX_RESINDX = RES_INDX;

   2725  4 000657   000016 235000 1                  LDA     RES_INDX
         4 000660   000020 755000 1                  STA     MAX_RESINDX

      352     2726    6                          GOTO PTBL_PRINT;

   2726  4 000661   000763 710000 4                  TRA     PTBL_PRINT

      353     2727    6                          END;
      354     2728    5                       END;
      355     2729    4                    END;

   2729  4 000662   000016 054000 1                  AOS     RES_INDX
         4 000663   000000 236000 xsym               LDQ     NUM_PSURES
         4 000664   000003 036007                    ADLQ    3,DL
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:60   
         4 000665   000016 116000 1                  CMPQ    RES_INDX
         4 000666   000602 605000 4                  TPL     s:2712
         4 000667   000737 710000 4                  TRA     s:2744

      356     2730    3               CASE(%PC_PMAXRES);

      357     2731        /**/
      358     2732    3               CASE(ELSE);

      359     2733    3                 IF (PCT_PARAM = %PC_PCTALL)OR /* NON RESOURCE                    */

   2733  4 000670   200003 470500                    LDP0    @PCT_PARAM,,AUTO
         4 000671   000000 235100                    LDA     0,,PR0
         4 000672   000001 115007                    CMPA    1,DL
         4 000673   000703 600000 4                  TZE     s:2736
         4 000674   000003 115007                    CMPA    3,DL
         4 000675   000703 600000 4                  TZE     s:2736
         4 000676   000004 236000 1                  LDQ     I
         4 000677   000014 402007                    MPY     12,DL
         4 000700   000000 471400 xsym               LDP1    PART$
         4 000701   100000 234106                    SZN     0,QL,PR1
         4 000702   000737 605000 4                  TPL     s:2744

      360     2734    3                   (PCT_PARAM = %PC_PCTPART#)OR
      361     2735    4                   (PART$ -> P$TBL.FLAGS.PRINT(I)) THEN DO;

      362     2736    4                    K = (SIZEC(TBL_PRBUF.CLMN(0)) -

   2736  4 000703   000004 236000 1                  LDQ     I
         4 000704   000014 402007                    MPY     12,DL
         4 000705   000000 471400 xsym               LDP1    PART$
         4 000706   100002 236106                    LDQ     2,QL,PR1
         4 000707   000033 772000                    QRL     27
         4 000710   000027 676000 xsym               ERQ     B_VECTNIL+23
         4 000711   000013 036007                    ADLQ    11,DL
         4 000712   000002 506007                    DIV     2,DL
         4 000713   000006 756000 1                  STQ     K
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:61   

      363     2737    4                      PART$ -> P$TBL.TEXT.COUNT(I))/2;
      364     2738    4                    CALL INSERT (TBL_PRBUF.CLMN(J),K,,

   2738  4 000714   000004 236000 1                  LDQ     I
         4 000715   000014 402007                    MPY     12,DL
         4 000716   100002 236106                    LDQ     2,QL,PR1
         4 000717   000033 772000                    QRL     27
         4 000720   000000 620006                    EAX0    0,QL
         4 000721   000005 236000 1                  LDQ     J
         4 000722   000012 402007                    MPY     10,DL
         4 000723   000006 036000 1                  ADLQ    K
         4 000724   200014 756100                    STQ     VALUE_INDEX+1,,AUTO
         4 000725   000004 236000 1                  LDQ     I
         4 000726   000060 402007                    MPY     48,DL
         4 000727   000006 721000 1                  LXL1    K
         4 000730   777765 621011                    EAX1    -11,X1
         4 000731   777777 661003                    ERX1    -1,DU
         4 000732   200014 235100                    LDA     VALUE_INDEX+1,,AUTO
         4 000733   040045 100546                    MLR     fill='040'O
         4 000734   100002 200010                    ADSC9   2,Q,PR1                  cn=1,n=*X0
         4 000735   000031 000011 1                  ADSC9   TBL_PRBUF+3,A            cn=0,n=*X1

      365     2739    4                      SUBSTR(PART$ -> P$TBL.TEXT.TEXT(I),0,
      366     2740    4                      PART$ -> P$TBL.TEXT.COUNT(I)));
      367     2741    4                    J = J+1;

   2741  4 000736   000005 054000 1                  AOS     J

      368     2742    4                    END;

      369     2743    3               END;

      370     2744    2              I = I + 1;

   2744  4 000737   000004 054000 1                  AOS     I

PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:62   
      371     2745    3              IF (I > %PC_PARTITIONHI) THEN DO;

   2745  4 000740   000004 235000 1                  LDA     I
         4 000741   000014 115007                    CMPA    12,DL
         4 000742   000750 604400 4                  TMOZ    s:2751

      372     2746    3                 MAX_TABLE = %PC_PARTITIONHI;

   2746  4 000743   000014 236007                    LDQ     12,DL
         4 000744   000015 756000 1                  STQ     MAX_TABLE

      373     2747    3                 MAX_RESINDX = -1;

   2747  4 000745   000001 335007                    LCA     1,DL
         4 000746   000020 755000 1                  STA     MAX_RESINDX

      374     2748    3                 GOTO PTBL_PRINT;

   2748  4 000747   000763 710000 4                  TRA     PTBL_PRINT

      375     2749    3                 END;
      376     2750        /**/
      377     2751    2              END;

   2751  4 000750   000005 236000 1                  LDQ     J
         4 000751   000023 116000 1                  CMPQ    MAX_CLMN
         4 000752   000557 604400 4                  TMOZ    s:2706

      378     2752        /**/
      379     2753    2           IF (J > MAX_CLMN) THEN DO;

   2753  4 000753   000761 604400 4                  TMOZ    s:2759

      380     2754    2              MAX_TABLE = I - 1;

   2754  4 000754   000001 135007                    SBLA    1,DL
         4 000755   000015 755000 1                  STA     MAX_TABLE
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:63   

      381     2755    2              MAX_RESINDX = -1;

   2755  4 000756   000001 335007                    LCA     1,DL
         4 000757   000020 755000 1                  STA     MAX_RESINDX

      382     2756    2              GOTO PTBL_PRINT;

   2756  4 000760   000763 710000 4                  TRA     PTBL_PRINT

      383     2757    2              END;
      384     2758        /**/
      385     2759    1           MAX_TABLE = %PC_PARTITIONHI;

   2759  4 000761   000014 235007                    LDA     12,DL
         4 000762   000015 755000 1                  STA     MAX_TABLE

      386     2760        /**/
      387     2761    1   PTBL_PRINT:
      388     2762    1           IF (J=0) THEN RETURN;           /* NO PARAMETERS                      */

   2762  4 000763   000005 235000 1     PTBL_PRINT   LDA     J
         4 000764   000766 601000 4                  TNZ     s:2763

   2762  4 000765   000000 702200 xent               TSX2  ! X66_ARET

      389     2763    1           FIRST_TIME = YES;

   2763  4 000766   400000 236003                    LDQ     -131072,DU
         4 000767   000003 756000 1                  STQ     FIRST_TIME

      390     2764        /**/
      391     2765    2           DO I = 0 TO 15;                 /* DO ALL PARTITIONS                  */

   2765  4 000770   000004 450000 1                  STZ     I

      392     2766    2              MONPTR$ = PINCRW(MONPART$,SIZEW(JM$PT)*I); /* POINT TO THIS PARTITION */
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:64   

   2766  4 000771   000004 236000 1                  LDQ     I
         4 000772   000023 402003                    MPY     19,DU
         4 000773   000000 036000 xsym               ADLQ    MONPART$
         4 000774   000000 756000 xsym               STQ     MONPTR$

      393     2767        /**/
      394     2768    3              IF (PART#FLGS(I)) THEN DO;

   2768  4 000775   000004 235000 1                  LDA     I
         4 000776   001000 605000 4                  TPL     s:2768+3
         4 000777   000044 035003                    ADLA    36,DU
         4 001000   000000 066405                    CMPB    filb='0'B
         4 001001   000001 000001 1                  BDSC    PART#FLGS,A              by=0,bit=0,n=1
         4 001002   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 001003   001654 600000 4                  TZE     s:2915

      395     2769    4                 IF (FIRST_TIME) THEN DO;  /* PRINT HEADER                       */

   2769  4 001004   000003 234000 1                  SZN     FIRST_TIME
         4 001005   001046 605000 4                  TPL     s:2782

      396     2770    4                    FIRST_TIME = NO;

   2770  4 001006   000003 450000 1                  STZ     FIRST_TIME

      397     2771    4                    CALL PCW$WRITE(TBL_PRBUF,SIZEC(TBL_PRBUF.NAME)+

   2771  4 001007   000023 236000 1                  LDQ     MAX_CLMN
         4 001010   000012 402007                    MPY     10,DL
         4 001011   000026 036007                    ADLQ    22,DL
         4 001012   200014 756100                    STQ     VALUE_INDEX+1,,AUTO
         4 001013   200014 630500                    EPPR0   VALUE_INDEX+1,,AUTO
         4 001014   200017 450500                    STP0    VALUE_INDEX+4,,AUTO
         4 001015   000000 236000 5                  LDQ     0
         4 001016   200016 756100                    STQ     VALUE_INDEX+3,,AUTO
         4 001017   200016 630500                    EPPR0   VALUE_INDEX+3,,AUTO
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:65   
         4 001020   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001021   000000 701000 xent               TSX1    PCW$WRITE
         4 001022   003176 702000 4                  TSX2    PCT_ERR

      398     2772    4                      SIZEC(TBL_PRBUF.CLMN(0))*(MAX_CLMN+1))
      399     2773    4                      ALTRET(PCT_ERR);
      400     2774    4                    CALL XLATE(TBL_PRBUFCHAR,XLATE_TBL,TBL_PRBUFCHAR);

   2774  4 001023   040000 160400                    MVT     fill='040'O
         4 001024   000026 000204 1                  ADSC9   TBL_PRBUF                cn=0,n=132
         4 001025   000026 000204 1                  ADSC9   TBL_PRBUF                cn=0,n=132
         4 001026   000400 000000 1                  ARG     XLATE_TBL

      401     2775                                                /* TRANSLATE TO DASHES                */
      402     2776    4                    CALL PCW$WRITE(TBL_PRBUF,SIZEC(TBL_PRBUF.NAME)+

   2776  4 001027   000023 236000 1                  LDQ     MAX_CLMN
         4 001030   000012 402007                    MPY     10,DL
         4 001031   000026 036007                    ADLQ    22,DL
         4 001032   200014 756100                    STQ     VALUE_INDEX+1,,AUTO
         4 001033   200014 630500                    EPPR0   VALUE_INDEX+1,,AUTO
         4 001034   200017 450500                    STP0    VALUE_INDEX+4,,AUTO
         4 001035   000000 236000 5                  LDQ     0
         4 001036   200016 756100                    STQ     VALUE_INDEX+3,,AUTO
         4 001037   200016 630500                    EPPR0   VALUE_INDEX+3,,AUTO
         4 001040   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001041   000000 701000 xent               TSX1    PCW$WRITE
         4 001042   003176 702000 4                  TSX2    PCT_ERR

      403     2777    4                      SIZEC(TBL_PRBUF.CLMN(0))*(MAX_CLMN+1))
      404     2778    4                      ALTRET(PCT_ERR);
      405     2779    4                    TBL_PRBUFCHAR = ' ';

   2779  4 001043   040000 100400                    MLR     fill='040'O
         4 001044   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001045   000026 000204 1                  ADSC9   TBL_PRBUF                cn=0,n=132

PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:66   
      406     2780    4                    END;

      407     2781        /**/
      408     2782    3                CALL INSERT(TBL_PRBUF.NAME,(SIZEC(TBL_PRBUF.NAME) - TEXTC_PART#X.COUNT
              2782                          (I)),

   2782  4 001046   000004 720000 1                  LXL0    I
         4 001047   000000 236010 xsym               LDQ     TEXTC_PART#X,X0
         4 001050   000033 772000                    QRL     27
         4 001051   200014 756100                    STQ     VALUE_INDEX+1,,AUTO
         4 001052   000004 235000 1                  LDA     I
         4 001053   000002 735000                    ALS     2
         4 001054   200015 755100                    STA     VALUE_INDEX+2,,AUTO
         4 001055   000000 235003                    LDA     0,DU
         4 001056   200014 135100                    SBLA    VALUE_INDEX+1,,AUTO
         4 001057   200016 755100                    STA     VALUE_INDEX+3,,AUTO
         4 001060   200015 235100                    LDA     VALUE_INDEX+2,,AUTO
         4 001061   000000 621006                    EAX1    0,QL
         4 001062   200016 236100                    LDQ     VALUE_INDEX+3,,AUTO
         4 001063   040046 100405                    MLR     fill='040'O
         4 001064   000000 200003 xsym               ADSC9   TEXTC_PART#X,A           cn=1,n=3
         4 001065   000031 000011 1                  ADSC9   TBL_PRBUF+3,Q            cn=0,n=*X1

      409     2783    3                   TEXTC_PART#X.COUNT(I),TEXTC_PART#X.TEXT(I));
      410     2784        /**/
      411     2785    3                 K = 0;                    /* CLMN NUMBER                        */

   2785  4 001066   000006 450000 1                  STZ     K

      412     2786    4                 DO J = CUR_TABLE TO MAX_TABLE; /* FILL IN TABLE                 */

   2786  4 001067   000014 235000 1                  LDA     CUR_TABLE
         4 001070   000005 755000 1                  STA     J
         4 001071   001632 710000 4                  TRA     s:2909+1

      413     2787        /**/
      414     2788    4                    IF ((PCT_PARAM = %PC_PCTALL)OR
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:67   

   2788  4 001072   200003 470500                    LDP0    @PCT_PARAM,,AUTO
         4 001073   000000 235100                    LDA     0,,PR0
         4 001074   000001 115007                    CMPA    1,DL
         4 001075   001121 600000 4                  TZE     s:2791
         4 001076   000003 115007                    CMPA    3,DL
         4 001077   001121 600000 4                  TZE     s:2791
         4 001100   000005 236000 1                  LDQ     J
         4 001101   000014 402007                    MPY     12,DL
         4 001102   000000 471400 xsym               LDP1    PART$
         4 001103   100000 236106                    LDQ     0,QL,PR1
         4 001104   000003 736000                    QLS     3
         4 001105   400000 376003                    ANQ     -131072,DU
         4 001106   400000 676003                    ERQ     -131072,DU
         4 001107   001114 600000 4                  TZE     s:2788+18
         4 001110   000005 236000 1                  LDQ     J
         4 001111   000014 402007                    MPY     12,DL
         4 001112   100000 234106                    SZN     0,QL,PR1
         4 001113   001121 604000 4                  TMI     s:2791
         4 001114   000005 236000 1                  LDQ     J
         4 001115   000014 402007                    MPY     12,DL
         4 001116   100000 236106                    LDQ     0,QL,PR1
         4 001117   040000 316003                    CANQ    16384,DU
         4 001120   001631 600000 4                  TZE     s:2909

      415     2789    4                      (PCT_PARAM = %PC_PCTPART#)OR
      416     2790    4                     (~(PART$ -> P$TBL.FLAGS.RES(J))AND(PART$ -> P$TBL.FLAGS.PRINT(J))
              2790                               )OR
      417     2791    5                      (PART$ -> P$TBL.FLAGS.RES(J))) THEN DO CASE(J);

   2791  4 001121   000005 235000 1                  LDA     J
         4 001122   000015 115007                    CMPA    13,DL
         4 001123   001125 602005 4                  TNC     s:2791+4,AL
         4 001124   001631 710000 4                  TRA     s:2909
         4 001125   001631 710000 4                  TRA     s:2909
         4 001126   001142 710000 4                  TRA     s:2794
         4 001127   001165 710000 4                  TRA     s:2800
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:68   
         4 001130   001210 710000 4                  TRA     s:2806
         4 001131   001631 710000 4                  TRA     s:2909
         4 001132   001446 710000 4                  TRA     s:2865
         4 001133   001475 710000 4                  TRA     s:2873
         4 001134   001520 710000 4                  TRA     s:2879
         4 001135   001535 710000 4                  TRA     s:2884
         4 001136   001551 710000 4                  TRA     s:2889
         4 001137   001565 710000 4                  TRA     s:2894
         4 001140   001602 710000 4                  TRA     s:2899
         4 001141   001616 710000 4                  TRA     s:2904

      418     2792        /**/
      419     2793    5                     CASE (%PC_PMINTI);

      420     2794    5                       VALUE = MONPTR$ -> JM$PT.TL;

   2794  4 001142   000000 471400 xsym               LDP1    MONPTR$
         4 001143   100000 235100                    LDA     0,,PR1
         4 001144   000025 755000 1                  STA     VALUE

      421     2795    5                       VALUE = VALUE/(PART$ -> P$TBL.MULT(%PC_PMINTI));

   2795  4 001145   000000 473400 xsym               LDP3    PART$
         4 001146   000025 236000 1                  LDQ     VALUE
         4 001147   300027 235100                    LDA     23,,PR3
         4 001150   001153 605000 4                  TPL     s:2795+6
         4 001151   000000 236003                    LDQ     0,DU
         4 001152   001154 710000 4                  TRA     s:2795+7
         4 001153   300027 506100                    DIV     23,,PR3
         4 001154   000025 756000 1                  STQ     VALUE

      422     2796    5                       CALL TABLE_ENTRY(K,VALUE);

   2796  4 001155   000001 236000 5                  LDQ     1
         4 001156   200006 756100                    STQ     @INDX+1,,AUTO
         4 001157   000002 236000 5                  LDQ     2
         4 001160   200005 756100                    STQ     @PCT_PARAM+2,,AUTO
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:69   
         4 001161   003132 701000 4                  TSX1    TABLE_ENTRY
         4 001162   000000 011000                    NOP     0

      423     2797    5                       K = K+1;

   2797  4 001163   000006 054000 1                  AOS     K
         4 001164   001631 710000 4                  TRA     s:2909

      424     2798        /**/
      425     2799    5                     CASE (%PC_PMAXTI);

      426     2800    5                       VALUE = MONPTR$ -> JM$PT.TU;

   2800  4 001165   000000 471400 xsym               LDP1    MONPTR$
         4 001166   100001 235100                    LDA     1,,PR1
         4 001167   000025 755000 1                  STA     VALUE

      427     2801    5                       VALUE = VALUE/(PART$ -> P$TBL.MULT(%PC_PMAXTI));

   2801  4 001170   000000 473400 xsym               LDP3    PART$
         4 001171   000025 236000 1                  LDQ     VALUE
         4 001172   300043 235100                    LDA     35,,PR3
         4 001173   001176 605000 4                  TPL     s:2801+6
         4 001174   000000 236003                    LDQ     0,DU
         4 001175   001177 710000 4                  TRA     s:2801+7
         4 001176   300043 506100                    DIV     35,,PR3
         4 001177   000025 756000 1                  STQ     VALUE

      428     2802    5                       CALL TABLE_ENTRY(K,VALUE);

   2802  4 001200   000001 236000 5                  LDQ     1
         4 001201   200006 756100                    STQ     @INDX+1,,AUTO
         4 001202   000002 236000 5                  LDQ     2
         4 001203   200005 756100                    STQ     @PCT_PARAM+2,,AUTO
         4 001204   003132 701000 4                  TSX1    TABLE_ENTRY
         4 001205   000000 011000                    NOP     0

PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:70   
      429     2803    5                       K = K+1;

   2803  4 001206   000006 054000 1                  AOS     K
         4 001207   001631 710000 4                  TRA     s:2909

      430     2804        /**/
      431     2805    5                     CASE (%PC_PMINRES);

      432     2806    6                       IF (J = MAX_TABLE) THEN DO; /* END OF LINE                */

   2806  4 001210   000005 236000 1                  LDQ     J
         4 001211   000015 116000 1                  CMPQ    MAX_TABLE
         4 001212   001224 601000 4                  TNZ     s:2812

      433     2807    6                          RESHI = MAX_RESINDX;

   2807  4 001213   000020 235000 1                  LDA     MAX_RESINDX
         4 001214   000022 755000 1                  STA     RESHI

      434     2808    6                          IF (J = CUR_TABLE) THEN RESLO = CUR_RESINDX;

   2808  4 001215   000014 116000 1                  CMPQ    CUR_TABLE
         4 001216   001222 601000 4                  TNZ     s:2809

   2808  4 001217   000017 235000 1                  LDA     CUR_RESINDX
         4 001220   000021 755000 1                  STA     RESLO
         4 001221   001240 710000 4                  TRA     s:2822

      435     2809    6                          ELSE RESLO = 0;

   2809  4 001222   000021 450000 1                  STZ     RESLO

      436     2810    6                          END;

   2810  4 001223   001240 710000 4                  TRA     s:2822

      437     2811        /**/
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:71   
      438     2812    6                       ELSE IF (J = CUR_TABLE) THEN DO; /* START OF LINE         */

   2812  4 001224   000014 116000 1                  CMPQ    CUR_TABLE
         4 001225   001234 601000 4                  TNZ     s:2818

      439     2813    6                             RESLO = CUR_RESINDX;

   2813  4 001226   000017 235000 1                  LDA     CUR_RESINDX
         4 001227   000021 755000 1                  STA     RESLO

      440     2814    6                             RESHI = NUM_PSURES + PSURES_OFFSET-1;

   2814  4 001230   000000 235000 xsym               LDA     NUM_PSURES
         4 001231   000003 035007                    ADLA    3,DL
         4 001232   000022 755000 1                  STA     RESHI

      441     2815    6                             END;

   2815  4 001233   001240 710000 4                  TRA     s:2822

      442     2816        /**/
      443     2817    6                          ELSE DO;

      444     2818    6                             RESLO = 0;

   2818  4 001234   000021 450000 1                  STZ     RESLO

      445     2819    6                             RESHI = NUM_PSURES + PSURES_OFFSET-1;

   2819  4 001235   000000 235000 xsym               LDA     NUM_PSURES
         4 001236   000003 035007                    ADLA    3,DL
         4 001237   000022 755000 1                  STA     RESHI

      446     2820    6                             END;

      447     2821        /**/
      448     2822    6                       DO RES_INDX = RESLO TO RESHI;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:72   

   2822  4 001240   000021 235000 1                  LDA     RESLO
         4 001241   000016 755000 1                  STA     RES_INDX
         4 001242   001442 710000 4                  TRA     s:2862+1

      449     2823    6                          IF (PART$ -> P$TBL.RESPTR$(J) -> RES$FLGS(RES_INDX))

   2823  4 001243   000005 236000 1                  LDQ     J
         4 001244   000014 402007                    MPY     12,DL
         4 001245   000000 470400 xsym               LDP0    PART$
         4 001246   000001 471506                    LDP1    1,QL,PR0
         4 001247   000016 235000 1                  LDA     RES_INDX
         4 001250   001252 605000 4                  TPL     s:2823+7
         4 001251   000044 035003                    ADLA    36,DU
         4 001252   000000 066505                    CMPB    filb='0'B
         4 001253   100000 000001                    BDSC    0,A,PR1                  by=0,bit=0,n=1
         4 001254   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 001255   001264 601000 4                  TNZ     s:2826
         4 001256   200003 473500                    LDP3    @PCT_PARAM,,AUTO
         4 001257   300000 235100                    LDA     0,,PR3
         4 001260   000003 115007                    CMPA    3,DL
         4 001261   001264 600000 4                  TZE     s:2826
         4 001262   000001 115007                    CMPA    1,DL
         4 001263   001441 601000 4                  TNZ     s:2862

      450     2824    6                            OR(PCT_PARAM = %PC_PCTPART#)
      451     2825    7                            OR(PCT_PARAM=%PC_PCTALL) THEN DO;

      452     2826    7                             VALUE = MONPTR$ -> JM$PT.RMIN(RES_INDX);

   2826  4 001264   000016 235000 1                  LDA     RES_INDX
         4 001265   000001 735000                    ALS     1
         4 001266   000000 473400 xsym               LDP3    MONPTR$
         4 001267   000000 101505                    MRL     fill='000'O
         4 001270   300015 000002                    ADSC9   13,A,PR3                 cn=0,n=2
         4 001271   000025 000004 1                  ADSC9   VALUE                    cn=0,n=4

PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:73   
      453     2827    7                             CALL TABLE_ENTRY(K,VALUE);

   2827  4 001272   000001 236000 5                  LDQ     1
         4 001273   200006 756100                    STQ     @INDX+1,,AUTO
         4 001274   000002 236000 5                  LDQ     2
         4 001275   200005 756100                    STQ     @PCT_PARAM+2,,AUTO
         4 001276   003132 701000 4                  TSX1    TABLE_ENTRY
         4 001277   000000 011000                    NOP     0

      454     2828        /**/
      455     2829    7                             CALL INDEX(VALUE,BITASC('020'O),TBL_PRBUF.CLMN(K),

   2829  4 001300   000006 236000 1                  LDQ     K
         4 001301   000012 402007                    MPY     10,DL
         4 001302   757000 124406                    SCM     mask='757'O
         4 001303   000031 000012 1                  ADSC9   TBL_PRBUF+3,Q            cn=0,n=10
         4 001304   000010 000001 5                  ADSC9   8                        cn=0,n=1
         4 001305   000025 000000 1                  ARG     VALUE

      456     2830    7                               0,'757'O);  /* FIND FIRST NON BLANK               */
      457     2831        /**/
      458     2832    7                             RESTEXT_C.COUNT = 0;

   2832  4 001306   000000 236003                    LDQ     0,DU
         4 001307   000000 552040 xsym               STBQ    RESTEXT_C,'40'O

      459     2833    8                             DO WHILE (SUBSTR(TBL_PRBUF.CLMN(K),VALUE,1) ~= ' ');

   2833  4 001310   001327 710000 4                  TRA     s:2838

      460     2834    8                                CALL INSERT(RESTEXT_C.TEXT,RESTEXT_C.COUNT,1,

   2834  4 001311   000006 236000 1                  LDQ     K
         4 001312   000012 402007                    MPY     10,DL
         4 001313   000025 036000 1                  ADLQ    VALUE
         4 001314   200014 756100                    STQ     VALUE_INDEX+1,,AUTO
         4 001315   000000 236000 xsym               LDQ     RESTEXT_C
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:74   
         4 001316   000033 772000                    QRL     27
         4 001317   200014 235100                    LDA     VALUE_INDEX+1,,AUTO
         4 001320   040006 100405                    MLR     fill='040'O
         4 001321   000031 000001 1                  ADSC9   TBL_PRBUF+3,A            cn=0,n=1
         4 001322   000000 200001 xsym               ADSC9   RESTEXT_C,Q              cn=1,n=1

      461     2835    8                                  SUBSTR(TBL_PRBUF.CLMN(K),VALUE,1));
      462     2836    8                                RESTEXT_C.COUNT = RESTEXT_C.COUNT + 1;

   2836  4 001323   000000 236000 xsym               LDQ     RESTEXT_C
         4 001324   001000 036003                    ADLQ    512,DU
         4 001325   000000 552040 xsym               STBQ    RESTEXT_C,'40'O

      463     2837    8                                VALUE = VALUE + 1;

   2837  4 001326   000025 054000 1                  AOS     VALUE

      464     2838    8                                END;

   2838  4 001327   000006 236000 1                  LDQ     K
         4 001330   000012 402007                    MPY     10,DL
         4 001331   000025 036000 1                  ADLQ    VALUE
         4 001332   040000 106406                    CMPC    fill='040'O
         4 001333   000031 000001 1                  ADSC9   TBL_PRBUF+3,Q            cn=0,n=1
         4 001334   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001335   001311 601000 4                  TNZ     s:2834

      465     2839        /**/
      466     2840    7                             CALL INSERT(RESTEXT_C.TEXT,RESTEXT_C.COUNT,1,'-');

   2840  4 001336   000000 236000 xsym               LDQ     RESTEXT_C
         4 001337   000033 772000                    QRL     27
         4 001340   040006 100400                    MLR     fill='040'O
         4 001341   000011 000001 5                  ADSC9   9                        cn=0,n=1
         4 001342   000000 200001 xsym               ADSC9   RESTEXT_C,Q              cn=1,n=1

      467     2841    7                             RESTEXT_C.COUNT = RESTEXT_C.COUNT + 1;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:75   

   2841  4 001343   000000 236000 xsym               LDQ     RESTEXT_C
         4 001344   001000 036003                    ADLQ    512,DU
         4 001345   000000 552040 xsym               STBQ    RESTEXT_C,'40'O

      468     2842        /**/
      469     2843    7                             VALUE = MONPTR$ -> JM$PT.RMAX(RES_INDX);

   2843  4 001346   000016 235000 1                  LDA     RES_INDX
         4 001347   000001 735000                    ALS     1
         4 001350   000000 470400 xsym               LDP0    MONPTR$
         4 001351   000000 101505                    MRL     fill='000'O
         4 001352   000007 000002                    ADSC9   7,A,PR0                  cn=0,n=2
         4 001353   000025 000004 1                  ADSC9   VALUE                    cn=0,n=4

      470     2844    7                             CALL TABLE_ENTRY(K,VALUE);

   2844  4 001354   000001 236000 5                  LDQ     1
         4 001355   200006 756100                    STQ     @INDX+1,,AUTO
         4 001356   000002 236000 5                  LDQ     2
         4 001357   200005 756100                    STQ     @PCT_PARAM+2,,AUTO
         4 001360   003132 701000 4                  TSX1    TABLE_ENTRY
         4 001361   000000 011000                    NOP     0

      471     2845        /**/
      472     2846    7                             CALL INDEX(VALUE,BITASC('020'O),TBL_PRBUF.CLMN(K),

   2846  4 001362   000006 236000 1                  LDQ     K
         4 001363   000012 402007                    MPY     10,DL
         4 001364   757000 124406                    SCM     mask='757'O
         4 001365   000031 000012 1                  ADSC9   TBL_PRBUF+3,Q            cn=0,n=10
         4 001366   000010 000001 5                  ADSC9   8                        cn=0,n=1
         4 001367   000025 000000 1                  ARG     VALUE

      473     2847    7                               0,'757'O);  /* FIND FIRST NON BLANK               */
      474     2848        /**/
      475     2849    8                             DO WHILE (SUBSTR(TBL_PRBUF.CLMN(K),VALUE,1) ~= ' ');
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:76   

   2849  4 001370   001407 710000 4                  TRA     s:2854

      476     2850    8                                CALL INSERT(RESTEXT_C.TEXT,RESTEXT_C.COUNT,1,

   2850  4 001371   000006 236000 1                  LDQ     K
         4 001372   000012 402007                    MPY     10,DL
         4 001373   000025 036000 1                  ADLQ    VALUE
         4 001374   200014 756100                    STQ     VALUE_INDEX+1,,AUTO
         4 001375   000000 236000 xsym               LDQ     RESTEXT_C
         4 001376   000033 772000                    QRL     27
         4 001377   200014 235100                    LDA     VALUE_INDEX+1,,AUTO
         4 001400   040006 100405                    MLR     fill='040'O
         4 001401   000031 000001 1                  ADSC9   TBL_PRBUF+3,A            cn=0,n=1
         4 001402   000000 200001 xsym               ADSC9   RESTEXT_C,Q              cn=1,n=1

      477     2851    8                                  SUBSTR(TBL_PRBUF.CLMN(K),VALUE,1));
      478     2852    8                                RESTEXT_C.COUNT = RESTEXT_C.COUNT + 1;

   2852  4 001403   000000 236000 xsym               LDQ     RESTEXT_C
         4 001404   001000 036003                    ADLQ    512,DU
         4 001405   000000 552040 xsym               STBQ    RESTEXT_C,'40'O

      479     2853    8                                VALUE = VALUE + 1;

   2853  4 001406   000025 054000 1                  AOS     VALUE

      480     2854    8                                END;

   2854  4 001407   000006 236000 1                  LDQ     K
         4 001410   000012 402007                    MPY     10,DL
         4 001411   000025 036000 1                  ADLQ    VALUE
         4 001412   040000 106406                    CMPC    fill='040'O
         4 001413   000031 000001 1                  ADSC9   TBL_PRBUF+3,Q            cn=0,n=1
         4 001414   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001415   001371 601000 4                  TNZ     s:2850

PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:77   
      481     2855        /**/
      482     2856    7                             VALUE = (SIZEC(TBL_PRBUF.CLMN(0))-RESTEXT_C.COUNT)/2;

   2856  4 001416   000000 236000 xsym               LDQ     RESTEXT_C
         4 001417   000033 772000                    QRL     27
         4 001420   000027 676000 xsym               ERQ     B_VECTNIL+23
         4 001421   000013 036007                    ADLQ    11,DL
         4 001422   000002 506007                    DIV     2,DL
         4 001423   000025 756000 1                  STQ     VALUE

      483     2857    7                             CALL INSERT(TBL_PRBUF.CLMN(K),VALUE,,

   2857  4 001424   000000 236000 xsym               LDQ     RESTEXT_C
         4 001425   000033 772000                    QRL     27
         4 001426   000000 620006                    EAX0    0,QL
         4 001427   000006 236000 1                  LDQ     K
         4 001430   000012 402007                    MPY     10,DL
         4 001431   000025 036000 1                  ADLQ    VALUE
         4 001432   000025 721000 1                  LXL1    VALUE
         4 001433   777765 621011                    EAX1    -11,X1
         4 001434   777777 661003                    ERX1    -1,DU
         4 001435   040046 100440                    MLR     fill='040'O
         4 001436   000000 200010 xsym               ADSC9   RESTEXT_C                cn=1,n=*X0
         4 001437   000031 000011 1                  ADSC9   TBL_PRBUF+3,Q            cn=0,n=*X1

      484     2858    7                               SUBSTR(RESTEXT_C.TEXT,0,RESTEXT_C.COUNT));
      485     2859        /**/
      486     2860    7                             K = K+1;

   2860  4 001440   000006 054000 1                  AOS     K

      487     2861    7                             END;

      488     2862    6                          END;

   2862  4 001441   000016 054000 1                  AOS     RES_INDX
         4 001442   000016 236000 1                  LDQ     RES_INDX
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:78   
         4 001443   000022 116000 1                  CMPQ    RESHI
         4 001444   001243 604400 4                  TMOZ    s:2823
         4 001445   001631 710000 4                  TRA     s:2909

      489     2863        /**/
      490     2864    5                     CASE (%PC_PLOCK);

      491     2865    5                       IF (MONPTR$ -> JM$PT.FLG.LOCK) THEN VALUE = 1;

   2865  4 001446   000000 471400 xsym               LDP1    MONPTR$
         4 001447   100004 236100                    LDQ     4,,PR1
         4 001450   000001 316007                    CANQ    1,DL
         4 001451   001455 600000 4                  TZE     s:2866

   2865  4 001452   000001 235007                    LDA     1,DL
         4 001453   000025 755000 1                  STA     VALUE
         4 001454   001456 710000 4                  TRA     s:2867

      492     2866    5                       ELSE VALUE = 0;

   2866  4 001455   000025 450000 1                  STZ     VALUE

      493     2867    5                       IF VALUE = 0

   2867  4 001456   000025 235000 1                  LDA     VALUE
         4 001457   001466 601000 4                  TNZ     s:2869

      494     2868    5                          THEN CALL INSERT(TBL_PRBUF.CLMN(K),4,,'NO');

   2868  4 001460   000006 236000 1                  LDQ     K
         4 001461   000012 402007                    MPY     10,DL
         4 001462   040006 100400                    MLR     fill='040'O
         4 001463   000000 000002 3                  ADSC9   0                        cn=0,n=2
         4 001464   000032 000006 1                  ADSC9   TBL_PRBUF+4,Q            cn=0,n=6
         4 001465   001473 710000 4                  TRA     s:2870

      495     2869    5                          ELSE CALL INSERT(TBL_PRBUF.CLMN(K),3,,'YES');
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:79   

   2869  4 001466   000006 236000 1                  LDQ     K
         4 001467   000012 402007                    MPY     10,DL
         4 001470   040006 100400                    MLR     fill='040'O
         4 001471   000001 000003 3                  ADSC9   1                        cn=0,n=3
         4 001472   000031 600007 1                  ADSC9   TBL_PRBUF+3,Q            cn=3,n=7

      496     2870    5                       K = K+1;

   2870  4 001473   000006 054000 1                  AOS     K
         4 001474   001631 710000 4                  TRA     s:2909

      497     2871        /**/
      498     2872    5                     CASE (%PC_PQUAN);

      499     2873    5                       VALUE = MONPTR$ -> JM$PT.QUAN;

   2873  4 001475   000000 471400 xsym               LDP1    MONPTR$
         4 001476   100002 235100                    LDA     2,,PR1
         4 001477   000025 755000 1                  STA     VALUE

      500     2874    5                       VALUE = VALUE/(PART$ -> P$TBL.MULT(%PC_PQUAN));

   2874  4 001500   000000 473400 xsym               LDP3    PART$
         4 001501   000025 236000 1                  LDQ     VALUE
         4 001502   300123 235100                    LDA     83,,PR3
         4 001503   001506 605000 4                  TPL     s:2874+6
         4 001504   000000 236003                    LDQ     0,DU
         4 001505   001507 710000 4                  TRA     s:2874+7
         4 001506   300123 506100                    DIV     83,,PR3
         4 001507   000025 756000 1                  STQ     VALUE

      501     2875    5                       CALL TABLE_ENTRY(K,VALUE);

   2875  4 001510   000001 236000 5                  LDQ     1
         4 001511   200006 756100                    STQ     @INDX+1,,AUTO
         4 001512   000002 236000 5                  LDQ     2
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:80   
         4 001513   200005 756100                    STQ     @PCT_PARAM+2,,AUTO
         4 001514   003132 701000 4                  TSX1    TABLE_ENTRY
         4 001515   000000 011000                    NOP     0

      502     2876    5                       K = K+1;

   2876  4 001516   000006 054000 1                  AOS     K
         4 001517   001631 710000 4                  TRA     s:2909

      503     2877        /**/
      504     2878    5                     CASE (%PC_PPRIO);

      505     2879    5                       VALUE = MONPTR$ -> JM$PT.XPRIO;

   2879  4 001520   000000 471400 xsym               LDP1    MONPTR$
         4 001521   100004 236100                    LDQ     4,,PR1
         4 001522   000011 772000                    QRL     9
         4 001523   000777 376007                    ANQ     511,DL
         4 001524   000025 756000 1                  STQ     VALUE

      506     2880    5                       CALL TABLE_ENTRY(K,VALUE);

   2880  4 001525   000001 236000 5                  LDQ     1
         4 001526   200006 756100                    STQ     @INDX+1,,AUTO
         4 001527   000002 236000 5                  LDQ     2
         4 001530   200005 756100                    STQ     @PCT_PARAM+2,,AUTO
         4 001531   003132 701000 4                  TSX1    TABLE_ENTRY
         4 001532   000000 011000                    NOP     0

      507     2881    5                       K = K+1;

   2881  4 001533   000006 054000 1                  AOS     K
         4 001534   001631 710000 4                  TRA     s:2909

      508     2882        /**/
      509     2883    5                     CASE (%PC_PMAXACCT);

PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:81   
      510     2884    5                       VALUE = MONPTR$ -> JM$PT.MAX1ACCT;

   2884  4 001535   000000 471400 xsym               LDP1    MONPTR$
         4 001536   100005 236100                    LDQ     5,,PR1
         4 001537   000777 376007                    ANQ     511,DL
         4 001540   000025 756000 1                  STQ     VALUE

      511     2885    5                       CALL TABLE_ENTRY(K,VALUE);

   2885  4 001541   000001 236000 5                  LDQ     1
         4 001542   200006 756100                    STQ     @INDX+1,,AUTO
         4 001543   000002 236000 5                  LDQ     2
         4 001544   200005 756100                    STQ     @PCT_PARAM+2,,AUTO
         4 001545   003132 701000 4                  TSX1    TABLE_ENTRY
         4 001546   000000 011000                    NOP     0

      512     2886    5                       K = K+1;

   2886  4 001547   000006 054000 1                  AOS     K
         4 001550   001631 710000 4                  TRA     s:2909

      513     2887        /**/
      514     2888    5                     CASE (%PC_PJMAX);

      515     2889    5                       VALUE = MONPTR$ -> JM$PT.MAX;

   2889  4 001551   000000 471400 xsym               LDP1    MONPTR$
         4 001552   100003 236100                    LDQ     3,,PR1
         4 001553   000033 772000                    QRL     27
         4 001554   000025 756000 1                  STQ     VALUE

      516     2890    5                       CALL TABLE_ENTRY(K,VALUE);

   2890  4 001555   000001 236000 5                  LDQ     1
         4 001556   200006 756100                    STQ     @INDX+1,,AUTO
         4 001557   000002 236000 5                  LDQ     2
         4 001560   200005 756100                    STQ     @PCT_PARAM+2,,AUTO
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:82   
         4 001561   003132 701000 4                  TSX1    TABLE_ENTRY
         4 001562   000000 011000                    NOP     0

      517     2891    5                       K = K+1;

   2891  4 001563   000006 054000 1                  AOS     K
         4 001564   001631 710000 4                  TRA     s:2909

      518     2892        /**/
      519     2893    5                     CASE (%PC_PJCUR);

      520     2894    5                       VALUE = MONPTR$ -> JM$PT.CUR;

   2894  4 001565   000000 471400 xsym               LDP1    MONPTR$
         4 001566   100003 236100                    LDQ     3,,PR1
         4 001567   000022 772000                    QRL     18
         4 001570   000777 376007                    ANQ     511,DL
         4 001571   000025 756000 1                  STQ     VALUE

      521     2895    5                       CALL TABLE_ENTRY(K,VALUE);

   2895  4 001572   000001 236000 5                  LDQ     1
         4 001573   200006 756100                    STQ     @INDX+1,,AUTO
         4 001574   000002 236000 5                  LDQ     2
         4 001575   200005 756100                    STQ     @PCT_PARAM+2,,AUTO
         4 001576   003132 701000 4                  TSX1    TABLE_ENTRY
         4 001577   000000 011000                    NOP     0

      522     2896    5                       K = K+1;

   2896  4 001600   000006 054000 1                  AOS     K
         4 001601   001631 710000 4                  TRA     s:2909

      523     2897        /**/
      524     2898    5                     CASE (%PC_PJCTOT);

      525     2899    5                       VALUE = MONPTR$ -> JM$PT.CPTOT;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:83   

   2899  4 001602   000000 471400 xsym               LDP1    MONPTR$
         4 001603   100003 236100                    LDQ     3,,PR1
         4 001604   777777 376007                    ANQ     -1,DL
         4 001605   000025 756000 1                  STQ     VALUE

      526     2900    5                       CALL TABLE_ENTRY(K,VALUE);

   2900  4 001606   000001 236000 5                  LDQ     1
         4 001607   200006 756100                    STQ     @INDX+1,,AUTO
         4 001610   000002 236000 5                  LDQ     2
         4 001611   200005 756100                    STQ     @PCT_PARAM+2,,AUTO
         4 001612   003132 701000 4                  TSX1    TABLE_ENTRY
         4 001613   000000 011000                    NOP     0

      527     2901    5                       K = K+1;

   2901  4 001614   000006 054000 1                  AOS     K
         4 001615   001631 710000 4                  TRA     s:2909

      528     2902        /**/
      529     2903    5                     CASE (%PC_PJTOT);

      530     2904    5                       VALUE = MONPTR$ -> JM$PT.TOT;

   2904  4 001616   000000 471400 xsym               LDP1    MONPTR$
         4 001617   100004 236100                    LDQ     4,,PR1
         4 001620   000022 772000                    QRL     18
         4 001621   000025 756000 1                  STQ     VALUE

      531     2905    5                       CALL TABLE_ENTRY(K,VALUE);

   2905  4 001622   000001 236000 5                  LDQ     1
         4 001623   200006 756100                    STQ     @INDX+1,,AUTO
         4 001624   000002 236000 5                  LDQ     2
         4 001625   200005 756100                    STQ     @PCT_PARAM+2,,AUTO
         4 001626   003132 701000 4                  TSX1    TABLE_ENTRY
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:84   
         4 001627   000000 011000                    NOP     0

      532     2906    5                       K = K+1;

   2906  4 001630   000006 054000 1                  AOS     K

      533     2907        /**/
      534     2908    5                     END;

      535     2909    4                    END;

   2909  4 001631   000005 054000 1                  AOS     J
         4 001632   000005 236000 1                  LDQ     J
         4 001633   000015 116000 1                  CMPQ    MAX_TABLE
         4 001634   001072 604400 4                  TMOZ    s:2788

      536     2910    3                 CALL PCW$WRITE(TBL_PRBUF,SIZEC(TBL_PRBUF.NAME)+

   2910  4 001635   000023 236000 1                  LDQ     MAX_CLMN
         4 001636   000012 402007                    MPY     10,DL
         4 001637   000026 036007                    ADLQ    22,DL
         4 001640   200014 756100                    STQ     VALUE_INDEX+1,,AUTO
         4 001641   200014 630500                    EPPR0   VALUE_INDEX+1,,AUTO
         4 001642   200017 450500                    STP0    VALUE_INDEX+4,,AUTO
         4 001643   000000 236000 5                  LDQ     0
         4 001644   200016 756100                    STQ     VALUE_INDEX+3,,AUTO
         4 001645   200016 630500                    EPPR0   VALUE_INDEX+3,,AUTO
         4 001646   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001647   000000 701000 xent               TSX1    PCW$WRITE
         4 001650   003176 702000 4                  TSX2    PCT_ERR

      537     2911    3                   SIZEC(TBL_PRBUF.CLMN(0))*(MAX_CLMN+1)) ALTRET(PCT_ERR);
      538     2912    3                 TBL_PRBUFCHAR = ' ';

   2912  4 001651   040000 100400                    MLR     fill='040'O
         4 001652   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001653   000026 000204 1                  ADSC9   TBL_PRBUF                cn=0,n=132
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:85   

      539     2913    3                 END;

      540     2914        /**/
      541     2915    2              END;

   2915  4 001654   000004 054000 1                  AOS     I
         4 001655   000004 235000 1                  LDA     I
         4 001656   000017 115007                    CMPA    15,DL
         4 001657   000771 604400 4                  TMOZ    s:2766

      542     2916        /**/
      543     2917    1           CALL PCW$WRITE(TEXTC_MODE.TEXT(0),1) ALTRET(PCT_ERR); /* BLANK LINE   */

   2917  4 001660   000003 630400 5                  EPPR0   3
         4 001661   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001662   000000 701000 xent               TSX1    PCW$WRITE
         4 001663   003176 702000 4                  TSX2    PCT_ERR

      544     2918        /**/
      545     2919    2           IF (MAX_TABLE < %PC_PARTITIONHI) THEN DO;

   2919  4 001664   000015 235000 1                  LDA     MAX_TABLE
         4 001665   000014 115007                    CMPA    12,DL
         4 001666   001701 605000 4                  TPL     s:2929

      546     2920    3              IF (MAX_RESINDX ~= -1) THEN DO;

   2920  4 001667   000020 236000 1                  LDQ     MAX_RESINDX
         4 001670   000027 116000 xsym               CMPQ    B_VECTNIL+23
         4 001671   001676 600000 4                  TZE     s:2925

      547     2921    3                 CUR_RESINDX = MAX_RESINDX + 1;

   2921  4 001672   000001 036007                    ADLQ    1,DL
         4 001673   000017 756000 1                  STQ     CUR_RESINDX

PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:86   
      548     2922    3                 CUR_TABLE = MAX_TABLE;

   2922  4 001674   000014 755000 1                  STA     CUR_TABLE

      549     2923    3                 GOTO NEXT_PTBL;

   2923  4 001675   000546 710000 4                  TRA     NEXT_PTBL

      550     2924    3                 END;
      551     2925    2              CUR_TABLE = MAX_TABLE + 1;

   2925  4 001676   000001 035007                    ADLA    1,DL
         4 001677   000014 755000 1                  STA     CUR_TABLE

      552     2926    2              GOTO NEXT_PTBL;

   2926  4 001700   000546 710000 4                  TRA     NEXT_PTBL

      553     2927    2              END;
      554     2928        /**/
      555     2929    1           RETURN;

   2929  4 001701   000000 702200 xent               TSX2  ! X66_ARET

      556     2930        %EJECT;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:87   
      557     2931        /**/
      558     2932    1   PCT$RESOURCE: ENTRY (PCT_PARAM) ALTRET;

   2932  4 001702   000000 700200 xent  PCT$RESOURCE TSX0  ! X66_AUTO_1
         4 001703   000020 000001                    ZERO    16,1

      559     2933        /**/
      560     2934    2           IF (PCT_PARAM = %PC_PCTALL) THEN DO I = 1 TO %PC_MAXMODE;

   2934  4 001704   200003 470500                    LDP0    @PCT_PARAM,,AUTO
         4 001705   000000 235100                    LDA     0,,PR0
         4 001706   000001 115007                    CMPA    1,DL
         4 001707   001725 601000 4                  TNZ     s:2938

   2934  4 001710   000001 236007                    LDQ     1,DL
         4 001711   000004 756000 1                  STQ     I

      561     2935    2              MODEFLGS(I) = YES;

   2935  4 001712   000004 235000 1                  LDA     I
         4 001713   001715 605000 4                  TPL     s:2935+3
         4 001714   000044 035003                    ADLA    36,DU
         4 001715   003005 060400                    CSL     bolr='003'O
         4 001716   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         4 001717   000000 000001 1                  BDSC    MODEFLGS,A               by=0,bit=0,n=1

      562     2936    2              END;

   2936  4 001720   000004 054000 1                  AOS     I
         4 001721   000004 235000 1                  LDA     I
         4 001722   000004 115007                    CMPA    4,DL
         4 001723   001712 604400 4                  TMOZ    s:2935
         4 001724   001731 710000 4                  TRA     s:2940

      563     2937        /**/
      564     2938    1           ELSE MODEFLGS = INDEX_FLGS.MODE;

PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:88   
   2938  4 001725   000000 236000 xsym               LDQ     INDEX_FLGS
         4 001726   000000 676000 1                  ERQ     MODEFLGS
         4 001727   760000 376003                    ANQ     -8192,DU
         4 001730   000000 656000 1                  ERSQ    MODEFLGS

      565     2939        /**/
      566     2940    1           IF (MODEFLGS = NO) THEN RETURN;

   2940  4 001731   000000 236000 1                  LDQ     MODEFLGS
         4 001732   760000 316003                    CANQ    -8192,DU
         4 001733   001735 601000 4                  TNZ     s:2942

   2940  4 001734   000000 702200 xent               TSX2  ! X66_ARET

      567     2941        /**/
      568     2942    1           CALL SET_MAXCLMN ALTRET(PCT_ERR);

   2942  4 001735   003061 701000 4                  TSX1    SET_MAXCLMN
         4 001736   003176 702000 4                  TSX2    PCT_ERR

      569     2943        /**/
      570     2944    1           CUR_MODE = 1;

   2944  4 001737   000001 235007                    LDA     1,DL
         4 001740   000010 755000 1                  STA     CUR_MODE

      571     2945        /**/
      572     2946    1   NEXT_RESTBL:
      573     2947    1           I = CUR_MODE;

   2947  4 001741   000010 235000 1     NEXT_RESTBL  LDA     CUR_MODE
         4 001742   000004 755000 1                  STA     I

      574     2948    1           J = 0;

   2948  4 001743   000005 450000 1                  STZ     J

PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:89   
      575     2949    1           TBL_PRBUFCHAR = ' ';

   2949  4 001744   040000 100400                    MLR     fill='040'O
         4 001745   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001746   000026 000204 1                  ADSC9   TBL_PRBUF                cn=0,n=132

      576     2950        /**/
      577     2951    2           DO WHILE (J <= MAX_CLMN);

   2951  4 001747   000005 236000 1                  LDQ     J
         4 001750   000023 116000 1                  CMPQ    MAX_CLMN
         4 001751   002041 605400 4                  TPNZ    s:2967

      578     2952    3              IF (MODEFLGS(I)) THEN DO;

   2952  4 001752   000004 235000 1                  LDA     I
         4 001753   001755 605000 4                  TPL     s:2952+3
         4 001754   000044 035003                    ADLA    36,DU
         4 001755   000000 066405                    CMPB    filb='0'B
         4 001756   000000 000001 1                  BDSC    MODEFLGS,A               by=0,bit=0,n=1
         4 001757   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 001760   002011 600000 4                  TZE     s:2958

      579     2953    3                 K = (SIZEC(TBL_PRBUF.CLMN(0)) - TEXTC_MODE.COUNT(I))/2;

   2953  4 001761   000004 236000 1                  LDQ     I
         4 001762   000003 402007                    MPY     3,DL
         4 001763   000000 236006 xsym               LDQ     TEXTC_MODE,QL
         4 001764   000033 772000                    QRL     27
         4 001765   000027 676000 xsym               ERQ     B_VECTNIL+23
         4 001766   000013 036007                    ADLQ    11,DL
         4 001767   000002 506007                    DIV     2,DL
         4 001770   000006 756000 1                  STQ     K

      580     2954    3                 CALL INSERT(TBL_PRBUF.CLMN(J),K,TEXTC_MODE.COUNT(I),

   2954  4 001771   000005 236000 1                  LDQ     J
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:90   
         4 001772   000012 402007                    MPY     10,DL
         4 001773   000006 036000 1                  ADLQ    K
         4 001774   200014 756100                    STQ     VALUE_INDEX+1,,AUTO
         4 001775   000004 236000 1                  LDQ     I
         4 001776   000003 402007                    MPY     3,DL
         4 001777   000000 236006 xsym               LDQ     TEXTC_MODE,QL
         4 002000   000033 772000                    QRL     27
         4 002001   000000 620006                    EAX0    0,QL
         4 002002   000004 236000 1                  LDQ     I
         4 002003   000014 402007                    MPY     12,DL
         4 002004   200014 235100                    LDA     VALUE_INDEX+1,,AUTO
         4 002005   040045 100406                    MLR     fill='040'O
         4 002006   000000 200013 xsym               ADSC9   TEXTC_MODE,Q             cn=1,n=11
         4 002007   000031 000010 1                  ADSC9   TBL_PRBUF+3,A            cn=0,n=*X0

      581     2955    3                   TEXTC_MODE.TEXT(I));
      582     2956    3                 J = J+1;

   2956  4 002010   000005 054000 1                  AOS     J

      583     2957    3                 END;

      584     2958    2              I = I+1;

   2958  4 002011   000004 054000 1                  AOS     I

      585     2959    2              IF ((TPSYS)AND(I > %PC_MAXMODE))OR

   2959  4 002012   000000 234000 xsym               SZN     TPSYS
         4 002013   002017 605000 4                  TPL     s:2959+5
         4 002014   000004 235000 1                  LDA     I
         4 002015   000004 115007                    CMPA    4,DL
         4 002016   002026 605400 4                  TPNZ    s:2961
         4 002017   000000 236000 xsym               LDQ     TPSYS
         4 002020   400000 376003                    ANQ     -131072,DU
         4 002021   400000 676003                    ERQ     -131072,DU
         4 002022   002036 600000 4                  TZE     s:2966
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:91   
         4 002023   000004 235000 1                  LDA     I
         4 002024   000003 115007                    CMPA    3,DL
         4 002025   002036 604400 4                  TMOZ    s:2966

      586     2960    3                ((~TPSYS)AND(I > %PC_MAXMODE-1)) THEN DO;

      587     2961    3                 IF (TPSYS) THEN MAX_MODE = %PC_MAXMODE;

   2961  4 002026   000000 234000 xsym               SZN     TPSYS
         4 002027   002033 605000 4                  TPL     s:2962

   2961  4 002030   000004 236007                    LDQ     4,DL
         4 002031   000011 756000 1                  STQ     MAX_MODE
         4 002032   002035 710000 4                  TRA     s:2963

      588     2962    3                 ELSE MAX_MODE = %PC_MAXMODE-1;

   2962  4 002033   000003 236007                    LDQ     3,DL
         4 002034   000011 756000 1                  STQ     MAX_MODE

      589     2963    3                 GOTO RESTBL_PRINT;

   2963  4 002035   002055 710000 4                  TRA     RESTBL_PRINT

      590     2964    3                 END;
      591     2965        /**/
      592     2966    2              END;

   2966  4 002036   000005 236000 1                  LDQ     J
         4 002037   000023 116000 1                  CMPQ    MAX_CLMN
         4 002040   001752 604400 4                  TMOZ    s:2952

      593     2967    2           IF (J > MAX_CLMN) THEN DO;

   2967  4 002041   002046 604400 4                  TMOZ    s:2972

      594     2968    2              MAX_MODE = I - 1;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:92   

   2968  4 002042   000004 235000 1                  LDA     I
         4 002043   000001 135007                    SBLA    1,DL
         4 002044   000011 755000 1                  STA     MAX_MODE

      595     2969    2              GOTO RESTBL_PRINT;

   2969  4 002045   002055 710000 4                  TRA     RESTBL_PRINT

      596     2970    2              END;
      597     2971        /**/
      598     2972    1           IF (TPSYS) THEN MAX_MODE = %PC_MAXMODE;

   2972  4 002046   000000 234000 xsym               SZN     TPSYS
         4 002047   002053 605000 4                  TPL     s:2973

   2972  4 002050   000004 235007                    LDA     4,DL
         4 002051   000011 755000 1                  STA     MAX_MODE
         4 002052   002055 710000 4                  TRA     RESTBL_PRINT

      599     2973    1           ELSE MAX_MODE = %PC_MAXMODE - 1;

   2973  4 002053   000003 235007                    LDA     3,DL
         4 002054   000011 755000 1                  STA     MAX_MODE

      600     2974        /**/
      601     2975    1   RESTBL_PRINT:
      602     2976        /**/
      603     2977    1           IF (J = 0) THEN GOTO RESNONTBL_PRINT;

   2977  4 002055   000005 235000 1     RESTBL_PRINT LDA     J
         4 002056   002411 600000 4                  TZE     RESNONTBL_PRINT

      604     2978    1           FIRST_TIME = YES;

   2978  4 002057   400000 236003                    LDQ     -131072,DU
         4 002060   000003 756000 1                  STQ     FIRST_TIME
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:93   

      605     2979        /**/
      606     2980    2           DO I = 1 TO %PC_RESOURCEHI;

   2980  4 002061   000001 235007                    LDA     1,DL
         4 002062   000004 755000 1                  STA     I

      607     2981    3              DO RES_INDX = 0 TO NUM_PSURES + PSURES_OFFSET-1;

   2981  4 002063   000016 450000 1                  STZ     RES_INDX
         4 002064   002342 710000 4                  TRA     s:3036+1

      608     2982    3                 IF (RES$ -> P$TBL.FLAGS.INDX(I)AND

   2982  4 002065   000004 236000 1                  LDQ     I
         4 002066   000014 402007                    MPY     12,DL
         4 002067   000000 470400 xsym               LDP0    RES$
         4 002070   000000 236106                    LDQ     0,QL,PR0
         4 002071   100000 316003                    CANQ    32768,DU
         4 002072   002341 600000 4                  TZE     s:3036
         4 002073   200003 471500                    LDP1    @PCT_PARAM,,AUTO
         4 002074   100000 235100                    LDA     0,,PR1
         4 002075   000001 115007                    CMPA    1,DL
         4 002076   002111 600000 4                  TZE     s:2985
         4 002077   000004 236000 1                  LDQ     I
         4 002100   000014 402007                    MPY     12,DL
         4 002101   000001 473506                    LDP3    1,QL,PR0
         4 002102   000016 235000 1                  LDA     RES_INDX
         4 002103   002105 605000 4                  TPL     s:2982+16
         4 002104   000044 035003                    ADLA    36,DU
         4 002105   000000 066505                    CMPB    filb='0'B
         4 002106   300000 000001                    BDSC    0,A,PR3                  by=0,bit=0,n=1
         4 002107   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 002110   002341 600000 4                  TZE     s:3036

      609     2983    3                   ((PCT_PARAM = %PC_PCTALL)OR
      610     2984    4                   (RES$ -> P$TBL.RESPTR$(I) -> RES$FLGS(RES_INDX)))) THEN DO;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:94   

      611     2985    5                    IF (FIRST_TIME) THEN DO;

   2985  4 002111   000003 234000 1                  SZN     FIRST_TIME
         4 002112   002153 605000 4                  TPL     s:2998

      612     2986    5                       FIRST_TIME = NO;

   2986  4 002113   000003 450000 1                  STZ     FIRST_TIME

      613     2987    5                       CALL PCW$WRITE(TBL_PRBUF,SIZEC(TBL_PRBUF.NAME)+

   2987  4 002114   000023 236000 1                  LDQ     MAX_CLMN
         4 002115   000012 402007                    MPY     10,DL
         4 002116   000026 036007                    ADLQ    22,DL
         4 002117   200014 756100                    STQ     VALUE_INDEX+1,,AUTO
         4 002120   200014 633500                    EPPR3   VALUE_INDEX+1,,AUTO
         4 002121   200017 453500                    STP3    VALUE_INDEX+4,,AUTO
         4 002122   000000 236000 5                  LDQ     0
         4 002123   200016 756100                    STQ     VALUE_INDEX+3,,AUTO
         4 002124   200016 630500                    EPPR0   VALUE_INDEX+3,,AUTO
         4 002125   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002126   000000 701000 xent               TSX1    PCW$WRITE
         4 002127   003176 702000 4                  TSX2    PCT_ERR

      614     2988    5                         SIZEC(TBL_PRBUF.CLMN(0))*(MAX_CLMN+1))
      615     2989    5                         ALTRET(PCT_ERR);
      616     2990    5                       CALL XLATE(TBL_PRBUFCHAR,XLATE_TBL,TBL_PRBUFCHAR);

   2990  4 002130   040000 160400                    MVT     fill='040'O
         4 002131   000026 000204 1                  ADSC9   TBL_PRBUF                cn=0,n=132
         4 002132   000026 000204 1                  ADSC9   TBL_PRBUF                cn=0,n=132
         4 002133   000400 000000 1                  ARG     XLATE_TBL

      617     2991                                                /* TRANSLATE TO DASHES                */
      618     2992    5                       CALL PCW$WRITE(TBL_PRBUF,SIZEC(TBL_PRBUF.NAME)+

PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:95   
   2992  4 002134   000023 236000 1                  LDQ     MAX_CLMN
         4 002135   000012 402007                    MPY     10,DL
         4 002136   000026 036007                    ADLQ    22,DL
         4 002137   200014 756100                    STQ     VALUE_INDEX+1,,AUTO
         4 002140   200014 630500                    EPPR0   VALUE_INDEX+1,,AUTO
         4 002141   200017 450500                    STP0    VALUE_INDEX+4,,AUTO
         4 002142   000000 236000 5                  LDQ     0
         4 002143   200016 756100                    STQ     VALUE_INDEX+3,,AUTO
         4 002144   200016 630500                    EPPR0   VALUE_INDEX+3,,AUTO
         4 002145   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002146   000000 701000 xent               TSX1    PCW$WRITE
         4 002147   003176 702000 4                  TSX2    PCT_ERR

      619     2993    5                         SIZEC(TBL_PRBUF.CLMN(0))*(MAX_CLMN+1))
      620     2994    5                         ALTRET(PCT_ERR);
      621     2995    5                       TBL_PRBUFCHAR = ' ';

   2995  4 002150   040000 100400                    MLR     fill='040'O
         4 002151   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 002152   000026 000204 1                  ADSC9   TBL_PRBUF                cn=0,n=132

      622     2996    5                       END;

      623     2997        /**/
      624     2998    4                    CALL PCR$RESTEXT(RES_INDX,RESTEXT_C);

   2998  4 002153   000006 630400 5                  EPPR0   6
         4 002154   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002155   000000 701000 xent               TSX1    PCR$RESTEXT
         4 002156   000000 011000                    NOP     0

      625     2999    4                   CALL INSERT(TBL_PRBUF.NAME,(SIZEC(TBL_PRBUF.NAME) - RESTEXT_C.COUNT
              2999                             ),

   2999  4 002157   000000 236000 xsym               LDQ     RESTEXT_C
         4 002160   000033 772000                    QRL     27
         4 002161   200014 756100                    STQ     VALUE_INDEX+1,,AUTO
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:96   
         4 002162   000000 235003                    LDA     0,DU
         4 002163   200014 135100                    SBLA    VALUE_INDEX+1,,AUTO
         4 002164   000000 620006                    EAX0    0,QL
         4 002165   040045 100400                    MLR     fill='040'O
         4 002166   000000 200014 xsym               ADSC9   RESTEXT_C                cn=1,n=12
         4 002167   000031 000010 1                  ADSC9   TBL_PRBUF+3,A            cn=0,n=*X0

      626     3000    4                      RESTEXT_C.COUNT,RESTEXT_C.TEXT);
      627     3001    4                    CALL INSERT(TBL_PRBUF.NAME,(SIZEC(TBL_PRBUF.NAME)  - RESTEXT_C.
              3001                             COUNT -

   3001  4 002170   000004 236000 1                  LDQ     I
         4 002171   000014 402007                    MPY     12,DL
         4 002172   000000 470400 xsym               LDP0    RES$
         4 002173   000002 236106                    LDQ     2,QL,PR0
         4 002174   000033 772000                    QRL     27
         4 002175   200014 756100                    STQ     VALUE_INDEX+1,,AUTO
         4 002176   000000 236000 xsym               LDQ     RESTEXT_C
         4 002177   000033 772000                    QRL     27
         4 002200   200014 036100                    ADLQ    VALUE_INDEX+1,,AUTO
         4 002201   200015 756100                    STQ     VALUE_INDEX+2,,AUTO
         4 002202   000004 236000 1                  LDQ     I
         4 002203   000014 402007                    MPY     12,DL
         4 002204   000002 236106                    LDQ     2,QL,PR0
         4 002205   000033 772000                    QRL     27
         4 002206   000000 620006                    EAX0    0,QL
         4 002207   000004 236000 1                  LDQ     I
         4 002210   000060 402007                    MPY     48,DL
         4 002211   000000 235003                    LDA     0,DU
         4 002212   200015 135100                    SBLA    VALUE_INDEX+2,,AUTO
         4 002213   040045 100506                    MLR     fill='040'O
         4 002214   000002 200023                    ADSC9   2,Q,PR0                  cn=1,n=19
         4 002215   000031 000010 1                  ADSC9   TBL_PRBUF+3,A            cn=0,n=*X0

      628     3002    4                      RES$ -> P$TBL.TEXT.COUNT(I)),RES$ -> P$TBL.TEXT.COUNT(I),
      629     3003    4                      RES$ -> P$TBL.TEXT.TEXT(I));
      630     3004        /**/
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:97   
      631     3005    4                    K = 0;                 /* CLMN NUMBER                        */

   3005  4 002216   000006 450000 1                  STZ     K

      632     3006    5                    DO J = CUR_MODE TO MAX_MODE;

   3006  4 002217   000010 235000 1                  LDA     CUR_MODE
         4 002220   000005 755000 1                  STA     J
         4 002221   002317 710000 4                  TRA     s:3031+1

      633     3007    6                       IF (MODEFLGS(J)) THEN DO;

   3007  4 002222   000005 235000 1                  LDA     J
         4 002223   002225 605000 4                  TPL     s:3007+3
         4 002224   000044 035003                    ADLA    36,DU
         4 002225   000000 066405                    CMPB    filb='0'B
         4 002226   000000 000001 1                  BDSC    MODEFLGS,A               by=0,bit=0,n=1
         4 002227   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 002230   002316 600000 4                  TZE     s:3031

      634     3008        /**/
      635     3009    7                          IF (RES_INDX = MMINDX) THEN DO; /* MEMORY IS SPECIAL   */

   3009  4 002231   000016 235000 1                  LDA     RES_INDX
         4 002232   002252 601000 4                  TNZ     s:3016

      636     3010    7                             IF (I = %PC_MAXRES) THEN MONPTR$ = ADDR(FR_MEMM);

   3010  4 002233   000004 236000 1                  LDQ     I
         4 002234   000001 116007                    CMPQ    1,DL
         4 002235   002241 601000 4                  TNZ     s:3011

   3010  4 002236   000012 236000 5                  LDQ     10
         4 002237   000000 756000 xsym               STQ     MONPTR$
         4 002240   002243 710000 4                  TRA     s:3012

      637     3011    7                             ELSE MONPTR$ = ADDR(FR_MEMC);
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:98   

   3011  4 002241   000013 236000 5                  LDQ     11
         4 002242   000000 756000 xsym               STQ     MONPTR$

      638     3012    7                             MONPTR.SEGID = BITBIN(%SPCL1SID);

   3012  4 002243   006021 236007                    LDQ     3089,DL
         4 002244   000000 752003 xsym               STCQ    MONPTR$,'03'O

      639     3013    7                             VALUE = MONPTR$ -> B$TABLE(J);

   3013  4 002245   000000 470400 xsym               LDP0    MONPTR$
         4 002246   000005 720000 1                  LXL0    J
         4 002247   000000 235110                    LDA     0,X0,PR0
         4 002250   000025 755000 1                  STA     VALUE

      640     3014    7                             END;

   3014  4 002251   002307 710000 4                  TRA     s:3027

      641     3015        /**/
      642     3016    7                          ELSE IF (RES_INDX < PSURES_OFFSET) THEN DO;

   3016  4 002252   000004 115007                    CMPA    4,DL
         4 002253   002272 605000 4                  TPL     s:3023

      643     3017    7                                MONPTR.ADDRESS = RES$ -> P$TBL.REPTR$.ADDRESS(I);

   3017  4 002254   000004 236000 1                  LDQ     I
         4 002255   000014 402007                    MPY     12,DL
         4 002256   000000 470400 xsym               LDP0    RES$
         4 002257   000007 236106                    LDQ     7,QL,PR0
         4 002260   000000 752074 xsym               STCQ    MONPTR$,'74'O

      644     3018    7                                MONPTR.ADDRESS = MONPTR$ -> B$PTR.ADDRESS(J);

   3018  4 002261   000000 471400 xsym               LDP1    MONPTR$
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:99   
         4 002262   000005 720000 1                  LXL0    J
         4 002263   100000 236110                    LDQ     0,X0,PR1
         4 002264   000000 752074 xsym               STCQ    MONPTR$,'74'O

      645     3019    7                                VALUE = MONPTR$ -> B$TABLE(RES_INDX-1);

   3019  4 002265   000000 471400 xsym               LDP1    MONPTR$
         4 002266   000016 721000 1                  LXL1    RES_INDX
         4 002267   177777 235111                    LDA     -1,X1,PR1
         4 002270   000025 755000 1                  STA     VALUE

      646     3020    7                                END;

   3020  4 002271   002307 710000 4                  TRA     s:3027

      647     3021        /**/
      648     3022    7                             ELSE DO;

      649     3023    7                                MONPTR.ADDRESS = RES$ -> P$TBL.REPSUPTR$.ADDRESS(I);

   3023  4 002272   000004 236000 1                  LDQ     I
         4 002273   000014 402007                    MPY     12,DL
         4 002274   000000 470400 xsym               LDP0    RES$
         4 002275   000010 236106                    LDQ     8,QL,PR0
         4 002276   000000 752074 xsym               STCQ    MONPTR$,'74'O

      650     3024    7                                MONPTR.ADDRESS = MONPTR$ -> B$PTR.ADDRESS(J);

   3024  4 002277   000000 471400 xsym               LDP1    MONPTR$
         4 002300   000005 720000 1                  LXL0    J
         4 002301   100000 236110                    LDQ     0,X0,PR1
         4 002302   000000 752074 xsym               STCQ    MONPTR$,'74'O

      651     3025    7                                VALUE = MONPTR$ -> B$TABLE(RES_INDX - PSURES_OFFSET);

   3025  4 002303   000000 471400 xsym               LDP1    MONPTR$
         4 002304   000016 721000 1                  LXL1    RES_INDX
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:100  
         4 002305   177774 235111                    LDA     -4,X1,PR1
         4 002306   000025 755000 1                  STA     VALUE

      652     3026    7                                END;

      653     3027    6                          CALL TABLE_ENTRY(K,VALUE);

   3027  4 002307   000001 236000 5                  LDQ     1
         4 002310   200006 756100                    STQ     @INDX+1,,AUTO
         4 002311   000002 236000 5                  LDQ     2
         4 002312   200005 756100                    STQ     @PCT_PARAM+2,,AUTO
         4 002313   003132 701000 4                  TSX1    TABLE_ENTRY
         4 002314   000000 011000                    NOP     0

      654     3028    6                          K = K+1;

   3028  4 002315   000006 054000 1                  AOS     K

      655     3029    6                          END;

      656     3030        /**/
      657     3031    5                       END;

   3031  4 002316   000005 054000 1                  AOS     J
         4 002317   000005 236000 1                  LDQ     J
         4 002320   000011 116000 1                  CMPQ    MAX_MODE
         4 002321   002222 604400 4                  TMOZ    s:3007

      658     3032    4                    CALL PCW$WRITE(TBL_PRBUF,SIZEC(TBL_PRBUF.NAME)+

   3032  4 002322   000023 236000 1                  LDQ     MAX_CLMN
         4 002323   000012 402007                    MPY     10,DL
         4 002324   000026 036007                    ADLQ    22,DL
         4 002325   200014 756100                    STQ     VALUE_INDEX+1,,AUTO
         4 002326   200014 630500                    EPPR0   VALUE_INDEX+1,,AUTO
         4 002327   200017 450500                    STP0    VALUE_INDEX+4,,AUTO
         4 002330   000000 236000 5                  LDQ     0
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:101  
         4 002331   200016 756100                    STQ     VALUE_INDEX+3,,AUTO
         4 002332   200016 630500                    EPPR0   VALUE_INDEX+3,,AUTO
         4 002333   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002334   000000 701000 xent               TSX1    PCW$WRITE
         4 002335   003176 702000 4                  TSX2    PCT_ERR

      659     3033    4                      SIZEC(TBL_PRBUF.CLMN(0))*(MAX_CLMN+1)) ALTRET(PCT_ERR);
      660     3034    4                    TBL_PRBUFCHAR = ' ';

   3034  4 002336   040000 100400                    MLR     fill='040'O
         4 002337   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 002340   000026 000204 1                  ADSC9   TBL_PRBUF                cn=0,n=132

      661     3035    4                    END;

      662     3036    3                 END;

   3036  4 002341   000016 054000 1                  AOS     RES_INDX
         4 002342   000000 236000 xsym               LDQ     NUM_PSURES
         4 002343   000003 036007                    ADLQ    3,DL
         4 002344   000016 116000 1                  CMPQ    RES_INDX
         4 002345   002065 605000 4                  TPL     s:2982

      663     3037    2              END;

   3037  4 002346   000004 054000 1                  AOS     I
         4 002347   000004 235000 1                  LDA     I
         4 002350   000003 115007                    CMPA    3,DL
         4 002351   002063 604400 4                  TMOZ    s:2981

      664     3038        /**/
      665     3039    1           CALL PCW$WRITE(TEXTC_MODE.TEXT(0),1) ALTRET(PCT_ERR); /* BLANK LINE   */

   3039  4 002352   000003 630400 5                  EPPR0   3
         4 002353   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002354   000000 701000 xent               TSX1    PCW$WRITE
         4 002355   003176 702000 4                  TSX2    PCT_ERR
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:102  

      666     3040        /**/
      667     3041    1           IF ((TPSYS)AND(MAX_MODE < %PC_MAXMODE))OR /* SEE IF NEW TABLE NEEDED   */

   3041  4 002356   000000 234000 xsym               SZN     TPSYS
         4 002357   002363 605000 4                  TPL     s:3041+5
         4 002360   000011 235000 1                  LDA     MAX_MODE
         4 002361   000004 115007                    CMPA    4,DL
         4 002362   002372 604000 4                  TMI     s:3043
         4 002363   000000 236000 xsym               LDQ     TPSYS
         4 002364   400000 376003                    ANQ     -131072,DU
         4 002365   400000 676003                    ERQ     -131072,DU
         4 002366   002411 600000 4                  TZE     RESNONTBL_PRINT
         4 002367   000011 235000 1                  LDA     MAX_MODE
         4 002370   000003 115007                    CMPA    3,DL
         4 002371   002411 605000 4                  TPL     RESNONTBL_PRINT

      668     3042    2             ((~TPSYS)AND(MAX_MODE < %PC_MAXMODE-1)) THEN DO;

      669     3043    2              CUR_MODE = MAX_MODE + 1;

   3043  4 002372   000001 035007                    ADLA    1,DL
         4 002373   000010 755000 1                  STA     CUR_MODE

      670     3044    3              DO I = CUR_MODE TO %PC_MAXMODE;

   3044  4 002374   000004 755000 1                  STA     I
         4 002375   002406 710000 4                  TRA     s:3046+1

      671     3045    3                 IF (MODEFLGS(I)) THEN GOTO NEXT_RESTBL;

   3045  4 002376   000004 235000 1                  LDA     I
         4 002377   002401 605000 4                  TPL     s:3045+3
         4 002400   000044 035003                    ADLA    36,DU
         4 002401   000000 066405                    CMPB    filb='0'B
         4 002402   000000 000001 1                  BDSC    MODEFLGS,A               by=0,bit=0,n=1
         4 002403   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:103  
         4 002404   001741 601000 4                  TNZ     NEXT_RESTBL

      672     3046    3                 END;

   3046  4 002405   000004 054000 1                  AOS     I
         4 002406   000004 235000 1                  LDA     I
         4 002407   000004 115007                    CMPA    4,DL
         4 002410   002376 604400 4                  TMOZ    s:3045

      673     3047    2              END;

      674     3048        /**/
      675     3049    1   RESNONTBL_PRINT:
      676     3050    1           DISP_TBL = NO;

   3050  4 002411   000000 100400       RESNONTBL_P* MLR     fill='000'O
         4 002412   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 002413   000067 001444 1                  ADSC9   DISP_TBL                 cn=0,n=804

      677     3051    1           J = 0;

   3051  4 002414   000005 450000 1                  STZ     J

      678     3052        /**/
      679     3053    2           DO I = 1 TO %PC_RESOURCEHI;

   3053  4 002415   000001 235007                    LDA     1,DL
         4 002416   000004 755000 1                  STA     I

      680     3054    3              DO RES_INDX = 0 TO NUM_PSURES + PSURES_OFFSET -1;

   3054  4 002417   000016 450000 1                  STZ     RES_INDX
         4 002420   002466 710000 4                  TRA     s:3063+1

      681     3055    3                 IF (~(RES$ -> P$TBL.FLAGS.INDX(I))AND

   3055  4 002421   000004 236000 1                  LDQ     I
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:104  
         4 002422   000014 402007                    MPY     12,DL
         4 002423   000000 470400 xsym               LDP0    RES$
         4 002424   000000 236106                    LDQ     0,QL,PR0
         4 002425   000002 736000                    QLS     2
         4 002426   400000 376003                    ANQ     -131072,DU
         4 002427   400000 676003                    ERQ     -131072,DU
         4 002430   002465 600000 4                  TZE     s:3063
         4 002431   200003 471500                    LDP1    @PCT_PARAM,,AUTO
         4 002432   100000 235100                    LDA     0,,PR1
         4 002433   000001 115007                    CMPA    1,DL
         4 002434   002447 600000 4                  TZE     s:3058
         4 002435   000004 236000 1                  LDQ     I
         4 002436   000014 402007                    MPY     12,DL
         4 002437   000001 473506                    LDP3    1,QL,PR0
         4 002440   000016 235000 1                  LDA     RES_INDX
         4 002441   002443 605000 4                  TPL     s:3055+18
         4 002442   000044 035003                    ADLA    36,DU
         4 002443   000000 066505                    CMPB    filb='0'B
         4 002444   300000 000001                    BDSC    0,A,PR3                  by=0,bit=0,n=1
         4 002445   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 002446   002465 600000 4                  TZE     s:3063

      682     3056    3                   ((PCT_PARAM = %PC_PCTALL)OR
      683     3057    4                   (RES$ -> P$TBL.RESPTR$(I) -> RES$FLGS(RES_INDX)))) THEN DO;

      684     3058    4                    DISP_TBL.PARM.CAT(J) = %PC_RESOURCE;

   3058  4 002447   000005 235000 1                  LDA     J
         4 002450   000001 735000                    ALS     1
         4 002451   000070 236005 1                  LDQ     DISP_TBL+1,AL
         4 002452   000032 376000 xsym               ANQ     B_VECTNIL+26
         4 002453   002000 276003                    ORQ     1024,DU
         4 002454   000070 756005 1                  STQ     DISP_TBL+1,AL

      685     3059    4                    DISP_TBL.PARM.PARM(J) = I;

   3059  4 002455   000004 236000 1                  LDQ     I
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:105  
         4 002456   000022 736000                    QLS     18
         4 002457   000070 676005 1                  ERQ     DISP_TBL+1,AL
         4 002460   000777 376003                    ANQ     511,DU
         4 002461   000070 656005 1                  ERSQ    DISP_TBL+1,AL

      686     3060    4                    DISP_TBL.PARM.RESINDX(J) = RES_INDX;

   3060  4 002462   000016 720000 1                  LXL0    RES_INDX
         4 002463   000071 740005 1                  STX0    DISP_TBL+2,AL

      687     3061    4                    J = J+1;

   3061  4 002464   000005 054000 1                  AOS     J

      688     3062    4                    END;

      689     3063    3                 END;

   3063  4 002465   000016 054000 1                  AOS     RES_INDX
         4 002466   000000 236000 xsym               LDQ     NUM_PSURES
         4 002467   000003 036007                    ADLQ    3,DL
         4 002470   000016 116000 1                  CMPQ    RES_INDX
         4 002471   002421 605000 4                  TPL     s:3055

      690     3064    2              END;

   3064  4 002472   000004 054000 1                  AOS     I
         4 002473   000004 235000 1                  LDA     I
         4 002474   000003 115007                    CMPA    3,DL
         4 002475   002417 604400 4                  TMOZ    s:3054

      691     3065        /**/
      692     3066    2           IF (J ~= 0) THEN DO;

   3066  4 002476   000005 235000 1                  LDA     J
         4 002477   002506 600000 4                  TZE     s:3071

PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:106  
      693     3067    2              DISP_TBL.INDX = J-1;

   3067  4 002500   000001 135007                    SBLA    1,DL
         4 002501   000067 755000 1                  STA     DISP_TBL

      694     3068    2              CALL PCP$PDISP(DISP_TBL) ALTRET(PCT_ERR);

   3068  4 002502   000005 630400 5                  EPPR0   5
         4 002503   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002504   000000 701000 xent               TSX1    PCP$PDISP
         4 002505   003176 702000 4                  TSX2    PCT_ERR

      695     3069    2              END;

      696     3070        /**/
      697     3071    1           RETURN;

   3071  4 002506   000000 702200 xent               TSX2  ! X66_ARET

      698     3072        %EJECT;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:107  
      699     3073        /**/
      700     3074    1   PCT$EXCEPTION: ENTRY (PCT_PARAM) ALTRET;

   3074  4 002507   000000 700200 xent  PCT$EXCEPTI* TSX0  ! X66_AUTO_1
         4 002510   000020 000001                    ZERO    16,1

      701     3075        /**/
      702     3076    2           IF (PCT_PARAM = %PC_PCTALL) THEN DO I = 0 TO %PC_MAXDOMAIN;

   3076  4 002511   200003 470500                    LDP0    @PCT_PARAM,,AUTO
         4 002512   000000 235100                    LDA     0,,PR0
         4 002513   000001 115007                    CMPA    1,DL
         4 002514   002531 601000 4                  TNZ     s:3080

   3076  4 002515   000004 450000 1                  STZ     I

      703     3077    2              DOMAINFLGS(I) = YES;

   3077  4 002516   000004 235000 1                  LDA     I
         4 002517   002521 605000 4                  TPL     s:3077+3
         4 002520   000044 035003                    ADLA    36,DU
         4 002521   003005 060400                    CSL     bolr='003'O
         4 002522   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         4 002523   000002 000001 1                  BDSC    DOMAINFLGS,A             by=0,bit=0,n=1

      704     3078    2              END;

   3078  4 002524   000004 054000 1                  AOS     I
         4 002525   000004 235000 1                  LDA     I
         4 002526   000003 115007                    CMPA    3,DL
         4 002527   002516 604400 4                  TMOZ    s:3077
         4 002530   002536 710000 4                  TRA     s:3082

      705     3079        /**/
      706     3080    1           ELSE DOMAINFLGS = INDEX_FLGS.DOMAINE;

   3080  4 002531   000000 236000 xsym               LDQ     INDEX_FLGS
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:108  
         4 002532   000025 736000                    QLS     21
         4 002533   000002 676000 1                  ERQ     DOMAINFLGS
         4 002534   740000 376003                    ANQ     -16384,DU
         4 002535   000002 656000 1                  ERSQ    DOMAINFLGS

      707     3081        /**/
      708     3082    1           IF (DOMAINFLGS = NO) THEN RETURN;

   3082  4 002536   000002 236000 1                  LDQ     DOMAINFLGS
         4 002537   740000 316003                    CANQ    -16384,DU
         4 002540   002542 601000 4                  TNZ     s:3084

   3082  4 002541   000000 702200 xent               TSX2  ! X66_ARET

      709     3083        /**/
      710     3084    1           CALL SET_MAXCLMN ALTRET(PCT_ERR);

   3084  4 002542   003061 701000 4                  TSX1    SET_MAXCLMN
         4 002543   003176 702000 4                  TSX2    PCT_ERR

      711     3085        /**/
      712     3086    1           CUR_DOMAIN = 0;

   3086  4 002544   000012 450000 1                  STZ     CUR_DOMAIN

      713     3087    1   NEXT_ETBL:
      714     3088    1           I = CUR_DOMAIN;

   3088  4 002545   000012 235000 1     NEXT_ETBL    LDA     CUR_DOMAIN
         4 002546   000004 755000 1                  STA     I

      715     3089    1           J = 0;

   3089  4 002547   000005 450000 1                  STZ     J

      716     3090    1           TBL_PRBUFCHAR = ' ';

PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:109  
   3090  4 002550   040000 100400                    MLR     fill='040'O
         4 002551   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 002552   000026 000204 1                  ADSC9   TBL_PRBUF                cn=0,n=132

      717     3091        /**/
      718     3092    2           DO WHILE (J <= MAX_CLMN);

   3092  4 002553   000005 236000 1                  LDQ     J
         4 002554   000023 116000 1                  CMPQ    MAX_CLMN
         4 002555   002627 605400 4                  TPNZ    s:3106

      719     3093    3              IF (DOMAINFLGS(I)) THEN DO;

   3093  4 002556   000004 235000 1                  LDA     I
         4 002557   002561 605000 4                  TPL     s:3093+3
         4 002560   000044 035003                    ADLA    36,DU
         4 002561   000000 066405                    CMPB    filb='0'B
         4 002562   000002 000001 1                  BDSC    DOMAINFLGS,A             by=0,bit=0,n=1
         4 002563   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 002564   002615 600000 4                  TZE     s:3099

      720     3094    3                 K = (SIZEC(TBL_PRBUF.CLMN(0)) - TEXTC_DOMAIN.COUNT(I))/2;

   3094  4 002565   000004 235000 1                  LDA     I
         4 002566   000001 735000                    ALS     1
         4 002567   000000 236005 xsym               LDQ     TEXTC_DOMAIN,AL
         4 002570   000033 772000                    QRL     27
         4 002571   000027 676000 xsym               ERQ     B_VECTNIL+23
         4 002572   000013 036007                    ADLQ    11,DL
         4 002573   000002 506007                    DIV     2,DL
         4 002574   000006 756000 1                  STQ     K

      721     3095    3                 CALL INSERT(TBL_PRBUF.CLMN(J),K,TEXTC_DOMAIN.COUNT(I),

   3095  4 002575   000005 236000 1                  LDQ     J
         4 002576   000012 402007                    MPY     10,DL
         4 002577   000006 036000 1                  ADLQ    K
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:110  
         4 002600   000004 235000 1                  LDA     I
         4 002601   000001 735000                    ALS     1
         4 002602   200014 756100                    STQ     VALUE_INDEX+1,,AUTO
         4 002603   000000 236005 xsym               LDQ     TEXTC_DOMAIN,AL
         4 002604   000033 772000                    QRL     27
         4 002605   000004 235000 1                  LDA     I
         4 002606   000003 735000                    ALS     3
         4 002607   000000 620006                    EAX0    0,QL
         4 002610   200014 236100                    LDQ     VALUE_INDEX+1,,AUTO
         4 002611   040046 100405                    MLR     fill='040'O
         4 002612   000000 200007 xsym               ADSC9   TEXTC_DOMAIN,A           cn=1,n=7
         4 002613   000031 000010 1                  ADSC9   TBL_PRBUF+3,Q            cn=0,n=*X0

      722     3096    3                   TEXTC_DOMAIN.TEXT(I));
      723     3097    3                 J = J+1;

   3097  4 002614   000005 054000 1                  AOS     J

      724     3098    3                 END;

      725     3099    2              I = I+1;

   3099  4 002615   000004 054000 1                  AOS     I

      726     3100    3              IF (I > %PC_MAXDOMAIN) THEN DO;

   3100  4 002616   000004 235000 1                  LDA     I
         4 002617   000003 115007                    CMPA    3,DL
         4 002620   002624 604400 4                  TMOZ    s:3105

      727     3101    3                 MAX_DOMAIN = %PC_MAXDOMAIN;

   3101  4 002621   000003 236007                    LDQ     3,DL
         4 002622   000013 756000 1                  STQ     MAX_DOMAIN

      728     3102    3                 GOTO ETBL_PRINT;

PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:111  
   3102  4 002623   002635 710000 4                  TRA     ETBL_PRINT

      729     3103    3                 END;
      730     3104        /**/
      731     3105    2              END;

   3105  4 002624   000005 236000 1                  LDQ     J
         4 002625   000023 116000 1                  CMPQ    MAX_CLMN
         4 002626   002556 604400 4                  TMOZ    s:3093

      732     3106    2           IF (J > MAX_CLMN) THEN DO;

   3106  4 002627   002633 604400 4                  TMOZ    s:3111

      733     3107    2              MAX_DOMAIN = I - 1;

   3107  4 002630   000001 135007                    SBLA    1,DL
         4 002631   000013 755000 1                  STA     MAX_DOMAIN

      734     3108    2              GOTO ETBL_PRINT;

   3108  4 002632   002635 710000 4                  TRA     ETBL_PRINT

      735     3109    2              END;
      736     3110        /**/
      737     3111    1           MAX_DOMAIN = %PC_MAXDOMAIN;

   3111  4 002633   000003 235007                    LDA     3,DL
         4 002634   000013 755000 1                  STA     MAX_DOMAIN

      738     3112        /**/
      739     3113    1   ETBL_PRINT:
      740     3114        /**/
      741     3115    1           FIRST_TIME = YES;

   3115  4 002635   400000 236003       ETBL_PRINT   LDQ     -131072,DU
         4 002636   000003 756000 1                  STQ     FIRST_TIME
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:112  

      742     3116        /**/
      743     3117    2           DO I = 1 TO %PC_EXCEPTIONHI;

   3117  4 002637   000001 235007                    LDA     1,DL
         4 002640   000004 755000 1                  STA     I

      744     3118    2              IF (PCT_PARAM = %PC_PCTALL)OR

   3118  4 002641   200003 470500                    LDP0    @PCT_PARAM,,AUTO
         4 002642   000000 235100                    LDA     0,,PR0
         4 002643   000001 115007                    CMPA    1,DL
         4 002644   002652 600000 4                  TZE     s:3120
         4 002645   000004 236000 1                  LDQ     I
         4 002646   000014 402007                    MPY     12,DL
         4 002647   000000 471400 xsym               LDP1    EX$
         4 002650   100000 234106                    SZN     0,QL,PR1
         4 002651   003026 605000 4                  TPL     s:3152

      745     3119    3                (EX$ -> P$TBL.FLAGS.PRINT(I)) THEN DO;

      746     3120    4                 IF (FIRST_TIME) THEN DO;

   3120  4 002652   000003 234000 1                  SZN     FIRST_TIME
         4 002653   002714 605000 4                  TPL     s:3132

      747     3121    4                    FIRST_TIME = NO;

   3121  4 002654   000003 450000 1                  STZ     FIRST_TIME

      748     3122    4                    CALL PCW$WRITE(TBL_PRBUF,SIZEC(TBL_PRBUF.NAME)+

   3122  4 002655   000023 236000 1                  LDQ     MAX_CLMN
         4 002656   000012 402007                    MPY     10,DL
         4 002657   000026 036007                    ADLQ    22,DL
         4 002660   200014 756100                    STQ     VALUE_INDEX+1,,AUTO
         4 002661   200014 631500                    EPPR1   VALUE_INDEX+1,,AUTO
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:113  
         4 002662   200017 451500                    STP1    VALUE_INDEX+4,,AUTO
         4 002663   000000 236000 5                  LDQ     0
         4 002664   200016 756100                    STQ     VALUE_INDEX+3,,AUTO
         4 002665   200016 630500                    EPPR0   VALUE_INDEX+3,,AUTO
         4 002666   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002667   000000 701000 xent               TSX1    PCW$WRITE
         4 002670   003176 702000 4                  TSX2    PCT_ERR

      749     3123    4                      SIZEC(TBL_PRBUF.CLMN(0))*(MAX_CLMN+1))
      750     3124    4                      ALTRET(PCT_ERR);
      751     3125    4                    CALL XLATE(TBL_PRBUFCHAR,XLATE_TBL,TBL_PRBUFCHAR);

   3125  4 002671   040000 160400                    MVT     fill='040'O
         4 002672   000026 000204 1                  ADSC9   TBL_PRBUF                cn=0,n=132
         4 002673   000026 000204 1                  ADSC9   TBL_PRBUF                cn=0,n=132
         4 002674   000400 000000 1                  ARG     XLATE_TBL

      752     3126                                                /* TRANSLATE TO DASHES                */
      753     3127    4                    CALL PCW$WRITE(TBL_PRBUF,SIZEC(TBL_PRBUF.NAME)+

   3127  4 002675   000023 236000 1                  LDQ     MAX_CLMN
         4 002676   000012 402007                    MPY     10,DL
         4 002677   000026 036007                    ADLQ    22,DL
         4 002700   200014 756100                    STQ     VALUE_INDEX+1,,AUTO
         4 002701   200014 630500                    EPPR0   VALUE_INDEX+1,,AUTO
         4 002702   200017 450500                    STP0    VALUE_INDEX+4,,AUTO
         4 002703   000000 236000 5                  LDQ     0
         4 002704   200016 756100                    STQ     VALUE_INDEX+3,,AUTO
         4 002705   200016 630500                    EPPR0   VALUE_INDEX+3,,AUTO
         4 002706   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002707   000000 701000 xent               TSX1    PCW$WRITE
         4 002710   003176 702000 4                  TSX2    PCT_ERR

      754     3128    4                      SIZEC(TBL_PRBUF.CLMN(0))*(MAX_CLMN+1))
      755     3129    4                      ALTRET(PCT_ERR);
      756     3130    4                    TBL_PRBUFCHAR = ' ';

PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:114  
   3130  4 002711   040000 100400                    MLR     fill='040'O
         4 002712   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 002713   000026 000204 1                  ADSC9   TBL_PRBUF                cn=0,n=132

      757     3131    4                    END;

      758     3132    3                 CALL INSERT(TBL_PRBUF.NAME,(SIZEC(TBL_PRBUF.NAME) -

   3132  4 002714   000004 236000 1                  LDQ     I
         4 002715   000014 402007                    MPY     12,DL
         4 002716   000000 470400 xsym               LDP0    EX$
         4 002717   000002 236106                    LDQ     2,QL,PR0
         4 002720   000033 772000                    QRL     27
         4 002721   200014 756100                    STQ     VALUE_INDEX+1,,AUTO
         4 002722   000004 236000 1                  LDQ     I
         4 002723   000014 402007                    MPY     12,DL
         4 002724   000002 236106                    LDQ     2,QL,PR0
         4 002725   000033 772000                    QRL     27
         4 002726   000000 620006                    EAX0    0,QL
         4 002727   000004 236000 1                  LDQ     I
         4 002730   000060 402007                    MPY     48,DL
         4 002731   000000 235003                    LDA     0,DU
         4 002732   200014 135100                    SBLA    VALUE_INDEX+1,,AUTO
         4 002733   040045 100506                    MLR     fill='040'O
         4 002734   000002 200023                    ADSC9   2,Q,PR0                  cn=1,n=19
         4 002735   000031 000010 1                  ADSC9   TBL_PRBUF+3,A            cn=0,n=*X0

      759     3133    3                   EX$ ->P$TBL.TEXT.COUNT(I)),EX$ -> P$TBL.TEXT.COUNT(I),
      760     3134    3                   EX$ -> P$TBL.TEXT.TEXT(I));
      761     3135        /**/
      762     3136    3                 K = 0;                    /* CLMN NUMBER                        */

   3136  4 002736   000006 450000 1                  STZ     K

      763     3137    4                 DO J = CUR_DOMAIN TO MAX_DOMAIN;

   3137  4 002737   000012 235000 1                  LDA     CUR_DOMAIN
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:115  
         4 002740   000005 755000 1                  STA     J
         4 002741   003004 710000 4                  TRA     s:3147+1

      764     3138    5                    IF (DOMAINFLGS(J)) THEN DO; /* SELECTED DOMAIN               */

   3138  4 002742   000005 235000 1                  LDA     J
         4 002743   002745 605000 4                  TPL     s:3138+3
         4 002744   000044 035003                    ADLA    36,DU
         4 002745   000000 066405                    CMPB    filb='0'B
         4 002746   000002 000001 1                  BDSC    DOMAINFLGS,A             by=0,bit=0,n=1
         4 002747   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 002750   003003 600000 4                  TZE     s:3147

      765     3139    5                       MONPTR.ADDRESS = EX$ -> P$TBL.REPTR$.ADDRESS(I);

   3139  4 002751   000004 236000 1                  LDQ     I
         4 002752   000014 402007                    MPY     12,DL
         4 002753   000000 470400 xsym               LDP0    EX$
         4 002754   000007 236106                    LDQ     7,QL,PR0
         4 002755   000000 752074 xsym               STCQ    MONPTR$,'74'O

      766     3140        /**/
      767     3141    5                       VALUE = MONPTR$ -> B$TABLE(J);

   3141  4 002756   000000 471400 xsym               LDP1    MONPTR$
         4 002757   000005 720000 1                  LXL0    J
         4 002760   100000 235110                    LDA     0,X0,PR1
         4 002761   000025 755000 1                  STA     VALUE

      768     3142    5                       VALUE = VALUE/(EX$ -> P$TBL.MULT(I));

   3142  4 002762   000004 236000 1                  LDQ     I
         4 002763   000014 402007                    MPY     12,DL
         4 002764   000000 621006                    EAX1    0,QL
         4 002765   000025 236000 1                  LDQ     VALUE
         4 002766   000013 235111                    LDA     11,X1,PR0
         4 002767   002772 605000 4                  TPL     s:3142+8
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:116  
         4 002770   000000 236003                    LDQ     0,DU
         4 002771   002773 710000 4                  TRA     s:3142+9
         4 002772   000013 506111                    DIV     11,X1,PR0
         4 002773   000025 756000 1                  STQ     VALUE

      769     3143    5                       CALL TABLE_ENTRY(K,VALUE);

   3143  4 002774   000001 236000 5                  LDQ     1
         4 002775   200006 756100                    STQ     @INDX+1,,AUTO
         4 002776   000002 236000 5                  LDQ     2
         4 002777   200005 756100                    STQ     @PCT_PARAM+2,,AUTO
         4 003000   003132 701000 4                  TSX1    TABLE_ENTRY
         4 003001   000000 011000                    NOP     0

      770     3144        /**/
      771     3145    5                       K = K + 1;

   3145  4 003002   000006 054000 1                  AOS     K

      772     3146    5                       END;

      773     3147    4                    END;

   3147  4 003003   000005 054000 1                  AOS     J
         4 003004   000005 236000 1                  LDQ     J
         4 003005   000013 116000 1                  CMPQ    MAX_DOMAIN
         4 003006   002742 604400 4                  TMOZ    s:3138

      774     3148    3                 CALL PCW$WRITE(TBL_PRBUF,SIZEC(TBL_PRBUF.NAME)+

   3148  4 003007   000023 236000 1                  LDQ     MAX_CLMN
         4 003010   000012 402007                    MPY     10,DL
         4 003011   000026 036007                    ADLQ    22,DL
         4 003012   200014 756100                    STQ     VALUE_INDEX+1,,AUTO
         4 003013   200014 630500                    EPPR0   VALUE_INDEX+1,,AUTO
         4 003014   200017 450500                    STP0    VALUE_INDEX+4,,AUTO
         4 003015   000000 236000 5                  LDQ     0
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:117  
         4 003016   200016 756100                    STQ     VALUE_INDEX+3,,AUTO
         4 003017   200016 630500                    EPPR0   VALUE_INDEX+3,,AUTO
         4 003020   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003021   000000 701000 xent               TSX1    PCW$WRITE
         4 003022   003176 702000 4                  TSX2    PCT_ERR

      775     3149    3                   SIZEC(TBL_PRBUF.CLMN(0))*(MAX_CLMN+1)) ALTRET(PCT_ERR);
      776     3150    3                 TBL_PRBUFCHAR = ' ';

   3150  4 003023   040000 100400                    MLR     fill='040'O
         4 003024   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 003025   000026 000204 1                  ADSC9   TBL_PRBUF                cn=0,n=132

      777     3151    3                 END;

      778     3152    2              END;

   3152  4 003026   000004 054000 1                  AOS     I
         4 003027   000004 235000 1                  LDA     I
         4 003030   000006 115007                    CMPA    6,DL
         4 003031   002641 604400 4                  TMOZ    s:3118

      779     3153        /**/
      780     3154    1           CALL PCW$WRITE(TEXTC_MODE.TEXT(0),1) ALTRET(PCT_ERR); /* BLANK LINE   */

   3154  4 003032   000003 630400 5                  EPPR0   3
         4 003033   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003034   000000 701000 xent               TSX1    PCW$WRITE
         4 003035   003176 702000 4                  TSX2    PCT_ERR

      781     3155        /**/
      782     3156    2           IF (MAX_DOMAIN < %PC_MAXDOMAIN) THEN DO; /* SEE IF ANOTHER TABLE NEEDED */

   3156  4 003036   000013 235000 1                  LDA     MAX_DOMAIN
         4 003037   000003 115007                    CMPA    3,DL
         4 003040   003060 605000 4                  TPL     s:3163

PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:118  
      783     3157    2              CUR_DOMAIN = MAX_DOMAIN + 1;

   3157  4 003041   000001 035007                    ADLA    1,DL
         4 003042   000012 755000 1                  STA     CUR_DOMAIN

      784     3158    3              DO I = CUR_DOMAIN TO %PC_MAXDOMAIN;

   3158  4 003043   000004 755000 1                  STA     I
         4 003044   003055 710000 4                  TRA     s:3160+1

      785     3159    3                 IF (DOMAINFLGS(I)) THEN GOTO NEXT_TABLE;

   3159  4 003045   000004 235000 1                  LDA     I
         4 003046   003050 605000 4                  TPL     s:3159+3
         4 003047   000044 035003                    ADLA    36,DU
         4 003050   000000 066405                    CMPB    filb='0'B
         4 003051   000002 000001 1                  BDSC    DOMAINFLGS,A             by=0,bit=0,n=1
         4 003052   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 003053   000042 601000 4                  TNZ     NEXT_TABLE

      786     3160    3                 END;

   3160  4 003054   000004 054000 1                  AOS     I
         4 003055   000004 235000 1                  LDA     I
         4 003056   000003 115007                    CMPA    3,DL
         4 003057   003045 604400 4                  TMOZ    s:3159

      787     3161    2              END;

      788     3162        /**/
      789     3163    1           RETURN;

   3163  4 003060   000000 702200 xent               TSX2  ! X66_ARET

      790     3164        %EJECT;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:119  
      791     3165        /**/
      792     3166    1   SET_MAXCLMN: PROC ALTRET;

   3166  4 003061   200004 741300       SET_MAXCLMN  STX1  ! @PCT_PARAM+1,,AUTO

      793     3167        /**/
      794     3168    2           TEMP$ = DCBADDR(DCBNUM(M$LO));

   3168  4 003062   000000 236007 xsym               LDQ     M$LO,DL
         4 003063   000014 470400 5                  LDP0    12
         4 003064   000000 471500                    LDP1    0,,PR0
         4 003065   100000 236106                    LDQ     0,QL,PR1
         4 003066   000007 756000 1                  STQ     TEMP$

      795     3169    2           IF (TEMP$ -> F$DCB.ASN# = %DEVICE#) THEN I = TEMP$ -> F$DCB.WIDTH#;

   3169  4 003067   000007 473400 1                  LDP3    TEMP$
         4 003070   300032 236100                    LDQ     26,,PR3
         4 003071   777000 376007                    ANQ     -512,DL
         4 003072   003000 116007                    CMPQ    1536,DL
         4 003073   003100 601000 4                  TNZ     s:3170

   3169  4 003074   300004 236100                    LDQ     4,,PR3
         4 003075   000777 376007                    ANQ     511,DL
         4 003076   000004 756000 1                  STQ     I
         4 003077   003102 710000 4                  TRA     s:3172

      796     3170    2           ELSE I = 80;

   3170  4 003100   000120 235007                    LDA     80,DL
         4 003101   000004 755000 1                  STA     I

      797     3171        /**/
      798     3172    3           IF (I < SIZEC(TBL_PRBUF.NAME) + SIZEC(TBL_PRBUF.CLMN(0))) THEN DO;

   3172  4 003102   000004 235000 1                  LDA     I
         4 003103   000026 115007                    CMPA    22,DL
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:120  
         4 003104   003113 605000 4                  TPL     s:3177

      799     3173    3              CALL PCE$ERROR(%E$P_PLATEN2SMALL,2);

   3173  4 003105   000016 630400 5                  EPPR0   14
         4 003106   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003107   000000 701000 xent               TSX1    PCE$ERROR
         4 003110   000000 011000                    NOP     0

      800     3174    3              ALTRETURN;

   3174  4 003111   200004 221300                    LDX1  ! @PCT_PARAM+1,,AUTO
         4 003112   000000 702211                    TSX2  ! 0,X1

      801     3175    3              END;
      802     3176        /**/
      803     3177    2           MAX_CLMN = 0;

   3177  4 003113   000023 450000 1                  STZ     MAX_CLMN

      804     3178    3           DO WHILE ((MAX_CLMN<11)AND(SIZEC(TBL_PRBUF.NAME)

   3178  4 003114   003116 710000 4                  TRA     s:3181

      805     3179    3                + SIZEC(TBL_PRBUF.CLMN(0))*(MAX_CLMN+1) <= I));
      806     3180    3              MAX_CLMN = MAX_CLMN + 1;

   3180  4 003115   000023 054000 1                  AOS     MAX_CLMN

      807     3181    3              END;

   3181  4 003116   000023 235000 1                  LDA     MAX_CLMN
         4 003117   000013 115007                    CMPA    11,DL
         4 003120   003126 605000 4                  TPL     s:3182
         4 003121   000023 236000 1                  LDQ     MAX_CLMN
         4 003122   000012 402007                    MPY     10,DL
         4 003123   000026 036007                    ADLQ    22,DL
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:121  
         4 003124   000004 116000 1                  CMPQ    I
         4 003125   003115 604400 4                  TMOZ    s:3180

      808     3182    2           MAX_CLMN = MAX_CLMN - 1;

   3182  4 003126   000001 336007                    LCQ     1,DL
         4 003127   000023 056000 1                  ASQ     MAX_CLMN

      809     3183        /**/
      810     3184    2           RETURN;

   3184  4 003130   200004 221300                    LDX1  ! @PCT_PARAM+1,,AUTO
         4 003131   000001 702211                    TSX2  ! 1,X1

      811     3185        /**/
      812     3186    2   END SET_MAXCLMN;
      813     3187        /**/
      814     3188        %EJECT;
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:122  
      815     3189        /**/
      816     3190    1   TABLE_ENTRY: PROC(INDX,VALUE);

   3190  4 003132   200004 741300       TABLE_ENTRY  STX1  ! @PCT_PARAM+1,,AUTO

      817     3191        /**/
      818     3192    2   DCL INDX SBIN WORD;
      819     3193    2   DCL VALUE SBIN WORD;
      820     3194        /**/
      821     3195    2   DCL TEMP_TEXT CHAR(12) AUTO;
      822     3196    2   DCL TEMP_INDEX SBIN AUTO;
      823     3197    2   DCL VALUE_INDEX SBIN AUTO;
      824     3198        /**/
      825     3199    2           CALL BINCHAR(TEMP_TEXT,VALUE);

   3199  4 003133   200006 470500                    LDP0    @VALUE,,AUTO
         4 003134   000100 301500                    BTD
         4 003135   000000 000004                    NDSC9   0,,PR0                   cn=0,s=lsgnf,sf=0,n=4
         4 003136   200007 030014                    NDSC9   TEMP_TEXT,,AUTO          cn=0,s=nosgn,sf=0,n=12

      826     3200        /**/
      827     3201    2           TEMP_INDEX = 0;                 /* STRIP LEADING ZEROS                */

   3201  4 003137   200012 450100                    STZ     TEMP_INDEX,,AUTO

      828     3202    3           DO WHILE ('1'B);

      829     3203    3              IF (TEMP_INDEX = SIZEC(TEMP_TEXT)-1)OR

   3203  4 003140   200012 235100                    LDA     TEMP_INDEX,,AUTO
         4 003141   000013 115007                    CMPA    11,DL
         4 003142   003151 600000 4                  TZE     ZEROS_GONE
         4 003143   040000 106505                    CMPC    fill='040'O
         4 003144   200007 000001                    ADSC9   TEMP_TEXT,A,AUTO         cn=0,n=1
         4 003145   000020 000001 5                  ADSC9   16                       cn=0,n=1
         4 003146   003151 601000 4                  TNZ     ZEROS_GONE

PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:123  
      830     3204    3                (SUBSTR(TEMP_TEXT,TEMP_INDEX,1) ~= '0') THEN GOTO ZEROS_GONE;
      831     3205    3              TEMP_INDEX = TEMP_INDEX+1;

   3205  4 003147   200012 054100                    AOS     TEMP_INDEX,,AUTO

      832     3206    3              END;

   3206  4 003150   003140 710000 4                  TRA     s:3203

      833     3207        /**/
      834     3208    2   ZEROS_GONE:
      835     3209    2           VALUE_INDEX = (SIZEC(TBL_PRBUF.CLMN(0)) -

   3209  4 003151   200012 236100       ZEROS_GONE   LDQ     TEMP_INDEX,,AUTO
         4 003152   000002 136007                    SBLQ    2,DL
         4 003153   000002 506007                    DIV     2,DL
         4 003154   200013 756100                    STQ     VALUE_INDEX,,AUTO

      836     3210    2             (SIZEC(TEMP_TEXT) - TEMP_INDEX))/2;
      837     3211    2           CALL INSERT(TBL_PRBUF.CLMN(INDX),VALUE_INDEX,,

   3211  4 003155   200005 470500                    LDP0    @INDX,,AUTO
         4 003156   000000 235100                    LDA     0,,PR0
         4 003157   000044 733000                    LRS     36
         4 003160   000012 402007                    MPY     10,DL
         4 003161   200013 036100                    ADLQ    VALUE_INDEX,,AUTO
         4 003162   200012 720100                    LXL0    TEMP_INDEX,,AUTO
         4 003163   777763 620010                    EAX0    -13,X0
         4 003164   777777 660003                    ERX0    -1,DU
         4 003165   200013 721100                    LXL1    VALUE_INDEX,,AUTO
         4 003166   777765 621011                    EAX1    -11,X1
         4 003167   777777 661003                    ERX1    -1,DU
         4 003170   200012 235100                    LDA     TEMP_INDEX,,AUTO
         4 003171   040046 100545                    MLR     fill='040'O
         4 003172   200007 000010                    ADSC9   TEMP_TEXT,A,AUTO         cn=0,n=*X0
         4 003173   000031 000011 1                  ADSC9   TBL_PRBUF+3,Q            cn=0,n=*X1

PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:124  
      838     3212    2             SUBSTR(TEMP_TEXT,TEMP_INDEX,(SIZEC(TEMP_TEXT)-TEMP_INDEX)));
      839     3213    2           RETURN;

   3213  4 003174   200004 221300                    LDX1  ! @PCT_PARAM+1,,AUTO
         4 003175   000001 702211                    TSX2  ! 1,X1

      840     3214    2   END;
      841     3215        /**/
      842     3216    1   PCT_ERR:
      843     3217    1           ALTRETURN;

   3217  4 003176   000000 702200 xent  PCT_ERR      TSX2  ! X66_AALT
      844     3218    1   END PCT$TABLES;
      845     3219        %EOD;

PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:125  
--  Include file information  --

   B_SEGIDS_C.:E05TOU  is referenced.
   JM$STRUCT.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   PC_PERR_C.:E05TOU  is referenced.
   PC_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure PCT$TABLES.
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:126  

 **** Variables and constants ****

  ****  Section 001  Data  PCT$TABLES

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    12-0-0/w SBIN        r     1 CUR_DOMAIN                10-0-0/w SBIN        r     1 CUR_MODE
    17-0-0/w SBIN        r     1 CUR_RESINDX               14-0-0/w SBIN        r     1 CUR_TABLE
    67-0-0/w STRC(7236)  r     1 DISP_TBL
     2-0-0/b BIT         r     1 DOMAINFLGS(0:3)
     3-0-0/b BIT         r     1 FIRST_TIME                 4-0-0/w SBIN        r     1 I
     5-0-0/w SBIN        r     1 J                          6-0-0/w SBIN        r     1 K
    23-0-0/w SBIN        r     1 MAX_CLMN                  13-0-0/w SBIN        r     1 MAX_DOMAIN
    11-0-0/w SBIN        r     1 MAX_MODE                  20-0-0/w SBIN        r     1 MAX_RESINDX
    15-0-0/w SBIN        r     1 MAX_TABLE
     0-0-0/b BIT         r     1 MODEFLGS(0:4)
     1-0-0/b BIT         r     1 PART#FLGS(0:15)
    22-0-0/w SBIN        r     1 RESHI                     21-0-0/w SBIN        r     1 RESLO
    16-0-0/w SBIN        r     1 RES_INDX                  26-0-0/c STRC(1188)  r     1 TBL_PRBUF
    26-0-0/c CHAR(132)   r     1 TBL_PRBUFCHAR              7-0-0/w PTR         r     1 TEMP$
    25-0-0/w SBIN        r     1 VALUE                    400-0-0/c STRC(1152)  r     1 XLATE_TBL

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w PTR         r     1 @INDX                      3-0-0/w PTR         r     1 @PCT_PARAM
     6-0-0/w PTR         r     1 @VALUE                    *0-0-0/w SBIN        r     1 INDX
    *0-0-0/w UBIN        r     1 PCT_PARAM                 12-0-0/w SBIN        r     1 TEMP_INDEX
     7-0-0/c CHAR(12)    r     1 TEMP_TEXT                 *0-0-0/w SBIN        r     1 VALUE
    13-0-0/w SBIN        r     1 VALUE_INDEX

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:127  
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 EX$                        0-0-0/w UBIN        r     1 FR_MEMC
     0-0-0/w UBIN        r     1 FR_MEMM                    0-0-0/b STRC(25)    r     1 INDEX_FLGS
     0-0-0/w PTR         r     1 MONPART$                   0-0-0/w STRC        r     1 MONPTR
     0-0-0/w PTR         r     1 MONPTR$                    0-0-0/w SBIN        r     1 NUM_PSURES
     0-0-0/b BIT         r     1 PART#_FLGS(0:15)
     0-0-0/w PTR         r     1 PART$                      0-0-0/w PTR         r     1 RES$
     0-0-0/c STRC(117)   r     1 RESTEXT_C                  0-0-0/w PTR         r     1 SYSTEM$
     0-0-0/c STRC(72)    r     1 TEXTC_DOMAIN(0:3)
     0-0-0/c STRC(108)   r     1 TEXTC_MODE(0:4)
     0-0-0/c STRC        r     1 TEXTC_PART#X(0:15)
     0-0-0/b BIT         r     1 TPSYS

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 B$PTR(0:0)
     0-0-0/w UBIN        r     1 B$TABLE(0:0)
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(684)   r     1 JM$PT
     0-0-0N  NULL        r     1 M$LO                       0-0-0/w STRC(432)   r     1 P$TBL(0:0)
     0-0-0/b BIT         r     1 RES$FLGS(0:15)


   Procedure PCT$TABLES requires 1663 words for executable code.
   Procedure PCT$TABLES requires 16 words of local(AUTO) storage.
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:128  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:129  
          MINI XREF LISTING

B$PTR.ADDRESS
      2494**DCL      3018>>ASSIGN   3024>>ASSIGN
B$TABLE
      2492**DCL      2639>>ASSIGN   3013>>ASSIGN   3019>>ASSIGN   3025>>ASSIGN   3141>>ASSIGN
CUR_DOMAIN
      2308**DCL      3086<<ASSIGN   3088>>ASSIGN   3137>>DOINDEX  3157<<ASSIGN   3158>>DOINDEX
CUR_MODE
      2306**DCL      2579<<ASSIGN   2582>>ASSIGN   2635>>DOINDEX  2656<<ASSIGN   2657>>DOINDEX  2944<<ASSIGN
      2947>>ASSIGN   3006>>DOINDEX  3043<<ASSIGN   3044>>DOINDEX
CUR_RESINDX
      2313**DCL      2698<<ASSIGN   2709>>ASSIGN   2808>>ASSIGN   2813>>ASSIGN   2921<<ASSIGN
CUR_TABLE
      2310**DCL      2696<<ASSIGN   2702>>ASSIGN   2709>>IF       2786>>DOINDEX  2808>>IF       2812>>IF
      2922<<ASSIGN   2925<<ASSIGN
DISP_TBL
      2325**DCL      2663<<ASSIGN   2679<>CALL     3050<<ASSIGN   3068<>CALL
DISP_TBL.INDX
      2326**DCL      2678<<ASSIGN   3067<<ASSIGN
DISP_TBL.PARM.CAT
      2328**DCL      2670<<ASSIGN   3058<<ASSIGN
DISP_TBL.PARM.PARM
      2329**DCL      2671<<ASSIGN   3059<<ASSIGN
DISP_TBL.PARM.RESINDX
      2332**DCL      2672<<ASSIGN   3060<<ASSIGN
DOMAINFLGS
      2296**DCL      3077<<ASSIGN   3080<<ASSIGN   3082>>IF       3093>>IF       3138>>IF       3159>>IF
ETBL_PRINT
      3115**LABEL    3102--GOTO     3108--GOTO
EX$
      2521**DCL      3118>>IF       3132>>CALLBLT  3132>>CALLBLT  3132>>CALLBLT  3139>>ASSIGN   3142>>ASSIGN
F$DCB.ACTPOS
      2375**DCL      2375--REDEF
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:130  
F$DCB.ARS#
      2349**DCL      2349--REDEF
F$DCB.ASN#
      2364**DCL      3169>>IF
F$DCB.ATTR
      2368**DCL      2369--REDEF
F$DCB.BORROW
      2383**DCL      2383--REDEF    2383--REDEF    2383--REDEF
F$DCB.DCBNAME.L
      2397**DCL      2397--IMP-SIZ
F$DCB.EOMCHAR#
      2353**DCL      2353--REDEF
F$DCB.FLDID
      2378**DCL      2378--REDEF
F$DCB.FORM$
      2372**DCL      2372--REDEF
F$DCB.FSECT
      2388**DCL      2388--REDEF
F$DCB.FSN#
      2365**DCL      2365--REDEF    2365--REDEF    2366--REDEF
F$DCB.HEADER$
      2371**DCL      2371--REDEF
F$DCB.IXTNSIZE#
      2369**DCL      2369--REDEF
F$DCB.LASTSTA$
      2358**DCL      2358--REDEF
F$DCB.LVL
      2384**DCL      2384--REDEF
F$DCB.NAME#.C
      2359**DCL      2359--REDEF
F$DCB.NOEOF
      2381**DCL      2381--REDEF
F$DCB.NRECS#
      2370**DCL      2370--REDEF
F$DCB.NRECX
      2389**DCL      2389--REDEF
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:131  
F$DCB.OHDR
      2381**DCL      2381--REDEF
F$DCB.ORG#
      2364**DCL      2364--REDEF
F$DCB.PRECNO
      2387**DCL      2387--REDEF
F$DCB.RCSZ
      2393**DCL      2393--REDEF
F$DCB.RES#
      2360**DCL      2360--REDEF
F$DCB.SETX
      2372**DCL      2372--REDEF
F$DCB.TAB$
      2372**DCL      2372--REDEF
F$DCB.TDA
      2386**DCL      2387--REDEF
F$DCB.WIDTH#
      2356**DCL      3169>>ASSIGN
F$DCB.WSN#
      2360**DCL      2360--REDEF
FIRST_TIME
      2298**DCL      2613<<ASSIGN   2618>>IF       2619<<ASSIGN   2763<<ASSIGN   2769>>IF       2770<<ASSIGN
      2978<<ASSIGN   2985>>IF       2986<<ASSIGN   3115<<ASSIGN   3120>>IF       3121<<ASSIGN
FR_MEMC
      2560**DCL      3011--ASSIGN
FR_MEMM
      2561**DCL      3010--ASSIGN
I
      2300**DCL      2569<<DOINDEX  2570>>ASSIGN   2582<<ASSIGN   2587>>IF       2588>>ASSIGN   2589>>CALLBLT
      2589>>CALLBLT  2593<<ASSIGN   2593>>ASSIGN   2594>>IF       2594>>IF       2603>>ASSIGN   2615<<DOINDEX
      2616>>IF       2616>>IF       2630>>CALLBLT  2630>>CALLBLT  2630>>CALLBLT  2637>>ASSIGN   2640>>ASSIGN
      2657<<DOINDEX  2658>>IF       2666<<DOINDEX  2667>>IF       2667>>IF       2671>>ASSIGN   2686<<DOINDEX
      2687>>ASSIGN   2702<<ASSIGN   2706>>DOCASE   2709>>IF       2712>>IF       2724>>ASSIGN   2733>>IF
      2736>>ASSIGN   2738>>CALLBLT  2738>>CALLBLT  2744<<ASSIGN   2744>>ASSIGN   2745>>IF       2754>>ASSIGN
      2765<<DOINDEX  2766>>ASSIGN   2768>>IF       2782>>CALLBLT  2782>>CALLBLT  2782>>CALLBLT  2934<<DOINDEX
      2935>>ASSIGN   2947<<ASSIGN   2952>>IF       2953>>ASSIGN   2954>>CALLBLT  2954>>CALLBLT  2958<<ASSIGN
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:132  
      2958>>ASSIGN   2959>>IF       2959>>IF       2968>>ASSIGN   2980<<DOINDEX  2982>>IF       2982>>IF
      3001>>CALLBLT  3001>>CALLBLT  3001>>CALLBLT  3010>>IF       3017>>ASSIGN   3023>>ASSIGN   3044<<DOINDEX
      3045>>IF       3053<<DOINDEX  3055>>IF       3055>>IF       3059>>ASSIGN   3076<<DOINDEX  3077>>ASSIGN
      3088<<ASSIGN   3093>>IF       3094>>ASSIGN   3095>>CALLBLT  3095>>CALLBLT  3099<<ASSIGN   3099>>ASSIGN
      3100>>IF       3107>>ASSIGN   3117<<DOINDEX  3118>>IF       3132>>CALLBLT  3132>>CALLBLT  3132>>CALLBLT
      3139>>ASSIGN   3142>>ASSIGN   3158<<DOINDEX  3159>>IF       3169<<ASSIGN   3170<<ASSIGN   3172>>IF
      3178>>DOWHILE
INDEX_FLGS.DOMAINE
      2536**DCL      3080>>ASSIGN
INDEX_FLGS.MODE
      2534**DCL      2573>>ASSIGN   2938>>ASSIGN
INDEX_FLGS.PART#
      2535**DCL      2690>>ASSIGN
INDX IN PROCEDURE TABLE_ENTRY
      3192**DCL      3190--PROC     3211>>CALLBLT
J
      2301**DCL      2583<<ASSIGN   2586>>DOWHILE  2589>>CALLBLT  2591<<ASSIGN   2591>>ASSIGN   2602>>IF
      2612>>IF       2635<<DOINDEX  2636>>IF       2639>>ASSIGN   2664<<ASSIGN   2670>>ASSIGN   2671>>ASSIGN
      2672>>ASSIGN   2673<<ASSIGN   2673>>ASSIGN   2677>>IF       2678>>ASSIGN   2703<<ASSIGN   2704>>DOWHILE
      2719>>CALLBLT  2721<<ASSIGN   2721>>ASSIGN   2723>>IF       2738>>CALLBLT  2741<<ASSIGN   2741>>ASSIGN
      2753>>IF       2762>>IF       2786<<DOINDEX  2788>>IF       2788>>IF       2788>>IF       2791>>DOCASE
      2806>>IF       2808>>IF       2812>>IF       2823>>IF       2948<<ASSIGN   2951>>DOWHILE  2954>>CALLBLT
      2956<<ASSIGN   2956>>ASSIGN   2967>>IF       2977>>IF       3006<<DOINDEX  3007>>IF       3013>>ASSIGN
      3018>>ASSIGN   3024>>ASSIGN   3051<<ASSIGN   3058>>ASSIGN   3059>>ASSIGN   3060>>ASSIGN   3061<<ASSIGN
      3061>>ASSIGN   3066>>IF       3067>>ASSIGN   3089<<ASSIGN   3092>>DOWHILE  3095>>CALLBLT  3097<<ASSIGN
      3097>>ASSIGN   3106>>IF       3137<<DOINDEX  3138>>IF       3141>>ASSIGN
JM$PT
      2414**DCL      2766--ASSIGN
JM$PT.CPTOT
      2429**DCL      2899>>ASSIGN
JM$PT.CUR
      2427**DCL      2894>>ASSIGN
JM$PT.FLG.LOCK
      2439**DCL      2865>>IF
JM$PT.MAX
      2425**DCL      2889>>ASSIGN
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:133  
JM$PT.MAX1ACCT
      2442**DCL      2884>>ASSIGN
JM$PT.QUAN
      2423**DCL      2873>>ASSIGN
JM$PT.RMAX
      2448**DCL      2843>>ASSIGN
JM$PT.RMIN
      2451**DCL      2826>>ASSIGN
JM$PT.TL
      2419**DCL      2794>>ASSIGN
JM$PT.TOT
      2432**DCL      2904>>ASSIGN
JM$PT.TU
      2421**DCL      2800>>ASSIGN
JM$PT.XPRIO
      2434**DCL      2879>>ASSIGN
K
      2302**DCL      2588<<ASSIGN   2589>>CALLBLT  2634<<ASSIGN   2641<>CALL     2643<<ASSIGN   2643>>ASSIGN
      2717<<ASSIGN   2719>>CALLBLT  2736<<ASSIGN   2738>>CALLBLT  2785<<ASSIGN   2796<>CALL     2797<<ASSIGN
      2797>>ASSIGN   2802<>CALL     2803<<ASSIGN   2803>>ASSIGN   2827<>CALL     2829>>CALLBLT  2833>>DOWHILE
      2834>>CALLBLT  2844<>CALL     2846>>CALLBLT  2849>>DOWHILE  2850>>CALLBLT  2857>>CALLBLT  2860<<ASSIGN
      2860>>ASSIGN   2868>>CALLBLT  2869>>CALLBLT  2870<<ASSIGN   2870>>ASSIGN   2875<>CALL     2876<<ASSIGN
      2876>>ASSIGN   2880<>CALL     2881<<ASSIGN   2881>>ASSIGN   2885<>CALL     2886<<ASSIGN   2886>>ASSIGN
      2890<>CALL     2891<<ASSIGN   2891>>ASSIGN   2895<>CALL     2896<<ASSIGN   2896>>ASSIGN   2900<>CALL
      2901<<ASSIGN   2901>>ASSIGN   2905<>CALL     2906<<ASSIGN   2906>>ASSIGN   2953<<ASSIGN   2954>>CALLBLT
      3005<<ASSIGN   3027<>CALL     3028<<ASSIGN   3028>>ASSIGN   3094<<ASSIGN   3095>>CALLBLT  3136<<ASSIGN
      3143<>CALL     3145<<ASSIGN   3145>>ASSIGN
M$LO
      2511**DCL      3168--ASSIGN
MAX_CLMN
      2317**DCL      2586>>DOWHILE  2602>>IF       2620>>CALL     2625>>CALL     2646>>CALL     2704>>DOWHILE
      2723>>IF       2753>>IF       2771>>CALL     2776>>CALL     2910>>CALL     2951>>DOWHILE  2967>>IF
      2987>>CALL     2992>>CALL     3032>>CALL     3092>>DOWHILE  3106>>IF       3122>>CALL     3127>>CALL
      3148>>CALL     3177<<ASSIGN   3178>>DOWHILE  3178>>DOWHILE  3180<<ASSIGN   3180>>ASSIGN   3182<<ASSIGN
      3182>>ASSIGN
MAX_DOMAIN
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:134  
      2309**DCL      3101<<ASSIGN   3107<<ASSIGN   3111<<ASSIGN   3137>>DOINDEX  3156>>IF       3157>>ASSIGN
MAX_MODE
      2307**DCL      2596<<ASSIGN   2597<<ASSIGN   2603<<ASSIGN   2607<<ASSIGN   2608<<ASSIGN   2635>>DOINDEX
      2654>>IF       2654>>IF       2656>>ASSIGN   2961<<ASSIGN   2962<<ASSIGN   2968<<ASSIGN   2972<<ASSIGN
      2973<<ASSIGN   3006>>DOINDEX  3041>>IF       3041>>IF       3043>>ASSIGN
MAX_RESINDX
      2314**DCL      2725<<ASSIGN   2747<<ASSIGN   2755<<ASSIGN   2807>>ASSIGN   2920>>IF       2921>>ASSIGN
MAX_TABLE
      2311**DCL      2724<<ASSIGN   2746<<ASSIGN   2754<<ASSIGN   2759<<ASSIGN   2786>>DOINDEX  2806>>IF
      2919>>IF       2922>>ASSIGN   2925>>ASSIGN
MODEFLGS
      2294**DCL      2570<<ASSIGN   2573<<ASSIGN   2575>>IF       2587>>IF       2636>>IF       2658>>IF
      2935<<ASSIGN   2938<<ASSIGN   2940>>IF       2952>>IF       3007>>IF       3045>>IF
MONPART$
      2531**DCL      2766>>ASSIGN
MONPTR.ADDRESS
      2529**DCL      2637<<ASSIGN   3017<<ASSIGN   3018<<ASSIGN   3023<<ASSIGN   3024<<ASSIGN   3139<<ASSIGN
MONPTR.SEGID
      2530**DCL      3012<<ASSIGN
MONPTR$
      2527**DCL      2528--REDEF    2639>>ASSIGN   2766<<ASSIGN   2794>>ASSIGN   2800>>ASSIGN   2826>>ASSIGN
      2843>>ASSIGN   2865>>IF       2873>>ASSIGN   2879>>ASSIGN   2884>>ASSIGN   2889>>ASSIGN   2894>>ASSIGN
      2899>>ASSIGN   2904>>ASSIGN   3010<<ASSIGN   3011<<ASSIGN   3013>>ASSIGN   3018>>ASSIGN   3019>>ASSIGN
      3024>>ASSIGN   3025>>ASSIGN   3141>>ASSIGN
NEXT_PTBL
      2701**LABEL    2923--GOTO     2926--GOTO
NEXT_RESTBL
      2947**LABEL    3045--GOTO
NEXT_TABLE
      2582**LABEL    2658--GOTO     3159--GOTO
NONTABLE_PRINT
      2663**LABEL    2612--GOTO
NUM_PSURES
      2523**DCL      2711>>DOINDEX  2814>>ASSIGN   2819>>ASSIGN   2981>>DOINDEX  3054>>DOINDEX
P$TBL.FLAGS.INDX
      2459**DCL      2616>>IF       2667>>IF       2982>>IF       3055>>IF
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:135  
P$TBL.FLAGS.PRINT
      2457**DCL      2616>>IF       2667>>IF       2733>>IF       2788>>IF       3118>>IF
P$TBL.FLAGS.RES
      2460**DCL      2788>>IF       2788>>IF
P$TBL.MULT
      2482**DCL      2640>>ASSIGN   2795>>ASSIGN   2801>>ASSIGN   2874>>ASSIGN   3142>>ASSIGN
P$TBL.PSUPTR$
      2476**DCL      2477--REDEF
P$TBL.PTR$
      2472**DCL      2473--REDEF
P$TBL.REPSUPTR$.ADDRESS
      2478**DCL      3023>>ASSIGN
P$TBL.REPTR$.ADDRESS
      2474**DCL      2637>>ASSIGN   3017>>ASSIGN   3139>>ASSIGN
P$TBL.RESPTR$
      2468**DCL      2712>>IF       2823>>IF       2982>>IF       3055>>IF
P$TBL.TEXT.COUNT
      2470**DCL      2630>>CALLBLT  2630>>CALLBLT  2736>>ASSIGN   2738>>CALLBLT  3001>>CALLBLT  3001>>CALLBLT
      3132>>CALLBLT  3132>>CALLBLT
P$TBL.TEXT.TEXT
      2471**DCL      2630>>CALLBLT  2738>>CALLBLT  3001>>CALLBLT  3132>>CALLBLT
PART#FLGS
      2295**DCL      2687<<ASSIGN   2690<<ASSIGN   2692<<ASSIGN   2768>>IF
PART#_FLGS
      2538**DCL      2692>>ASSIGN
PART$
      2519**DCL      2712>>IF       2733>>IF       2736>>ASSIGN   2738>>CALLBLT  2738>>CALLBLT  2788>>IF
      2788>>IF       2788>>IF       2795>>ASSIGN   2801>>ASSIGN   2823>>IF       2874>>ASSIGN
PCE$ERROR
      2502**DCL-ENT  3173--CALL
PCP$PDISP
      2504**DCL-ENT  2679--CALL     3068--CALL
PCR$RESTEXT
      2505**DCL-ENT  2716--CALL     2998--CALL
PCT_ERR
      3217**LABEL    2577--CALLALT  2620--CALLALT  2625--CALLALT  2646--CALLALT  2652--CALLALT  2679--CALLALT
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:136  
      2694--CALLALT  2771--CALLALT  2776--CALLALT  2910--CALLALT  2917--CALLALT  2942--CALLALT  2987--CALLALT
      2992--CALLALT  3032--CALLALT  3039--CALLALT  3068--CALLALT  3084--CALLALT  3122--CALLALT  3127--CALLALT
      3148--CALLALT  3154--CALLALT
PCT_PARAM
        10**DCL         8--PROC     2567--ENTRY    2569>>IF       2616>>IF       2667>>IF       2684--ENTRY
      2686>>IF       2690>>IF       2712>>IF       2712>>IF       2733>>IF       2733>>IF       2788>>IF
      2788>>IF       2823>>IF       2823>>IF       2932--ENTRY    2934>>IF       2982>>IF       3055>>IF
      3074--ENTRY    3076>>IF       3118>>IF
PCW$WRITE
      2503**DCL-ENT  2620--CALL     2625--CALL     2646--CALL     2652--CALL     2771--CALL     2776--CALL
      2910--CALL     2917--CALL     2987--CALL     2992--CALL     3032--CALL     3039--CALL     3122--CALL
      3127--CALL     3148--CALL     3154--CALL
PTBL_PRINT
      2762**LABEL    2726--GOTO     2748--GOTO     2756--GOTO
RES$
      2520**DCL      2982>>IF       2982>>IF       3001>>CALLBLT  3001>>CALLBLT  3001>>CALLBLT  3017>>ASSIGN
      3023>>ASSIGN   3055>>IF       3055>>IF
RES$FLGS
      2491**DCL      2712>>IF       2823>>IF       2982>>IF       3055>>IF
RESHI
      2316**DCL      2807<<ASSIGN   2814<<ASSIGN   2819<<ASSIGN   2822>>DOINDEX
RESLO
      2315**DCL      2709<<ASSIGN   2710<<ASSIGN   2711>>DOINDEX  2808<<ASSIGN   2809<<ASSIGN   2813<<ASSIGN
      2818<<ASSIGN   2822>>DOINDEX
RESNONTBL_PRINT
      3050**LABEL    2977--GOTO
RESTBL_PRINT
      2977**LABEL    2963--GOTO     2969--GOTO
RESTEXT_C
      2552**DCL      2716<>CALL     2998<>CALL
RESTEXT_C.COUNT
      2553**DCL      2717>>ASSIGN   2719>>CALLBLT  2832<<ASSIGN   2834>>CALLBLT  2836<<ASSIGN   2836>>ASSIGN
      2840>>CALLBLT  2841<<ASSIGN   2841>>ASSIGN   2850>>CALLBLT  2852<<ASSIGN   2852>>ASSIGN   2856>>ASSIGN
      2857>>CALLBLT  2999>>CALLBLT  2999>>CALLBLT  3001>>CALLBLT
RESTEXT_C.TEXT
      2554**DCL      2719>>CALLBLT  2834<<CALLBLT  2840<<CALLBLT  2850<<CALLBLT  2857>>CALLBLT  2999>>CALLBLT
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:137  
RES_INDX
      2312**DCL      2697<<ASSIGN   2711<<DOINDEX  2712>>IF       2716<>CALL     2725>>ASSIGN   2822<<DOINDEX
      2823>>IF       2826>>ASSIGN   2843>>ASSIGN   2981<<DOINDEX  2982>>IF       2998<>CALL     3009>>IF
      3016>>IF       3019>>ASSIGN   3025>>ASSIGN   3054<<DOINDEX  3055>>IF       3060>>ASSIGN
SET_MAXCLMN
      3166**PROC     2577--CALL     2694--CALL     2942--CALL     3084--CALL
SYSTEM$
      2518**DCL      2616>>IF       2616>>IF       2630>>CALLBLT  2630>>CALLBLT  2630>>CALLBLT  2637>>ASSIGN
      2640>>ASSIGN   2667>>IF       2667>>IF
TABLE_ENTRY
      3190**PROC     2641--CALL     2796--CALL     2802--CALL     2827--CALL     2844--CALL     2875--CALL
      2880--CALL     2885--CALL     2890--CALL     2895--CALL     2900--CALL     2905--CALL     3027--CALL
      3143--CALL
TABLE_PRINT
      2612**LABEL    2598--GOTO     2604--GOTO
TBL_PRBUF
      2321**DCL      2324--REDEF    2620<>CALL     2625<>CALL     2646<>CALL     2771<>CALL     2776<>CALL
      2910<>CALL     2987<>CALL     2992<>CALL     3032<>CALL     3122<>CALL     3127<>CALL     3148<>CALL
TBL_PRBUF.CLMN
      2323**DCL      2588--ASSIGN   2589<<CALLBLT  2620--CALL     2625--CALL     2646--CALL     2717--ASSIGN
      2719<<CALLBLT  2736--ASSIGN   2738<<CALLBLT  2771--CALL     2776--CALL     2829>>CALLBLT  2833>>DOWHILE
      2834>>CALLBLT  2846>>CALLBLT  2849>>DOWHILE  2850>>CALLBLT  2856--ASSIGN   2857<<CALLBLT  2868<<CALLBLT
      2869<<CALLBLT  2910--CALL     2953--ASSIGN   2954<<CALLBLT  2987--CALL     2992--CALL     3032--CALL
      3094--ASSIGN   3095<<CALLBLT  3122--CALL     3127--CALL     3148--CALL     3172--IF       3178--DOWHILE
      3209--ASSIGN   3211<<CALLBLT
TBL_PRBUF.NAME
      2322**DCL      2620--CALL     2625--CALL     2630<<CALLBLT  2630--CALLBLT  2646--CALL     2771--CALL
      2776--CALL     2782<<CALLBLT  2782--CALLBLT  2910--CALL     2987--CALL     2992--CALL     2999<<CALLBLT
      2999--CALLBLT  3001<<CALLBLT  3001--CALLBLT  3032--CALL     3122--CALL     3127--CALL     3132<<CALLBLT
      3132--CALLBLT  3148--CALL     3172--IF       3178--DOWHILE
TBL_PRBUFCHAR
      2324**DCL      2584<<ASSIGN   2623<<CALLBLT  2623>>CALLBLT  2628<<ASSIGN   2648<<ASSIGN   2701<<ASSIGN
      2774<<CALLBLT  2774>>CALLBLT  2779<<ASSIGN   2912<<ASSIGN   2949<<ASSIGN   2990<<CALLBLT  2990>>CALLBLT
      2995<<ASSIGN   3034<<ASSIGN   3090<<ASSIGN   3125<<CALLBLT  3125>>CALLBLT  3130<<ASSIGN   3150<<ASSIGN
TEMP$
      2304**DCL      3168<<ASSIGN   3169>>IF       3169>>ASSIGN
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:138  
TEMP_INDEX IN PROCEDURE TABLE_ENTRY
      3196**DCL      3201<<ASSIGN   3203>>IF       3203>>IF       3205<<ASSIGN   3205>>ASSIGN   3209>>ASSIGN
      3211>>CALLBLT  3211>>CALLBLT
TEMP_TEXT IN PROCEDURE TABLE_ENTRY
      3195**DCL      3199<<CALLBLT  3203--IF       3203>>IF       3209--ASSIGN   3211>>CALLBLT  3211--CALLBLT
TEXTC_DOMAIN.COUNT
      2549**DCL      3094>>ASSIGN   3095>>CALLBLT
TEXTC_DOMAIN.TEXT
      2550**DCL      3095>>CALLBLT
TEXTC_MODE.COUNT
      2545**DCL      2588>>ASSIGN   2589>>CALLBLT  2953>>ASSIGN   2954>>CALLBLT
TEXTC_MODE.TEXT
      2546**DCL      2589>>CALLBLT  2652<>CALL     2917<>CALL     2954>>CALLBLT  3039<>CALL     3154<>CALL
TEXTC_PART#X.COUNT
      2541**DCL      2782>>CALLBLT  2782>>CALLBLT
TEXTC_PART#X.TEXT
      2542**DCL      2782>>CALLBLT
TPSYS
      2556**DCL      2594>>IF       2594>>IF       2596>>IF       2607>>IF       2654>>IF       2654>>IF
      2959>>IF       2959>>IF       2961>>IF       2972>>IF       3041>>IF       3041>>IF
VALUE
      2319**DCL      2639<<ASSIGN   2640<<ASSIGN   2640>>ASSIGN   2641<>CALL     2794<<ASSIGN   2795<<ASSIGN
      2795>>ASSIGN   2796<>CALL     2800<<ASSIGN   2801<<ASSIGN   2801>>ASSIGN   2802<>CALL     2826<<ASSIGN
      2827<>CALL     2829<<CALLBLT  2833>>DOWHILE  2834>>CALLBLT  2837<<ASSIGN   2837>>ASSIGN   2843<<ASSIGN
      2844<>CALL     2846<<CALLBLT  2849>>DOWHILE  2850>>CALLBLT  2853<<ASSIGN   2853>>ASSIGN   2856<<ASSIGN
      2857>>CALLBLT  2865<<ASSIGN   2866<<ASSIGN   2867>>IF       2873<<ASSIGN   2874<<ASSIGN   2874>>ASSIGN
      2875<>CALL     2879<<ASSIGN   2880<>CALL     2884<<ASSIGN   2885<>CALL     2889<<ASSIGN   2890<>CALL
      2894<<ASSIGN   2895<>CALL     2899<<ASSIGN   2900<>CALL     2904<<ASSIGN   2905<>CALL     3013<<ASSIGN
      3019<<ASSIGN   3025<<ASSIGN   3027<>CALL     3141<<ASSIGN   3142<<ASSIGN   3142>>ASSIGN   3143<>CALL
VALUE IN PROCEDURE TABLE_ENTRY
      3193**DCL      3190--PROC     3199>>CALLBLT
VALUE_INDEX IN PROCEDURE TABLE_ENTRY
      3197**DCL      3209<<ASSIGN   3211>>CALLBLT
XLATE_TBL
      2333**DCL      2623>>CALLBLT  2774>>CALLBLT  2990>>CALLBLT  3125>>CALLBLT
ZEROS_GONE IN PROCEDURE TABLE_ENTRY
PL6.E3A0      #001=PCT$TABLES File=PCT$TABLES.:E05TSI                            WED 07/30/97 04:21 Page:139  
      3209**LABEL    3204--GOTO

PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:140  
      846        1        /*M* PCT$TPCAT - DISPLAY TP PARAMS FOR CONTROL */
      847        2        /*T***********************************************************/
      848        3        /*T*                                                         */
      849        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      850        5        /*T*                                                         */
      851        6        /*T***********************************************************/
      852        7        PCT$TPCAT: PROC(CODE,NAME) ALTRET;
      853        8        /**/
      854        9        /* PARAMS */
      855       10    1   DCL CODE SBIN WORD;
      856       11    1   DCL NAME CHAR(8);
      857       12        /**/
      858       13        /* INCLUDE FILES */
      859       14        %INCLUDE CP_6;
      860       95        %INCLUDE PC_SUBS_C;
      861      427        %INCLUDE PC_PERR_C;
      862      460        %INCLUDE F$DCB;
      863      509        %INCLUDE XU_FORMAT_C;
      864      671        %INCLUDE XUF_ENTRY;
      865      679        /**/
      866      680        /* DCBS */
      867      681    1   DCL M$LO DCB;
      868      682        /**/
      869      683        /* ENTRY DCLS */
      870      684    1   DCL PCE$ERROR ENTRY(2) ALTRET;
      871      685        /**/
      872      686        /* VARS */
      873      687    1   DCL TP$ PTR SYMREF;
      874      688    1   DCL CURINSTANCES SBIN WORD SYMREF;
      875      689    1   DCL TBLINSTANCES SBIN WORD SYMREF;
      876      690    1   DCL 1 MAXTPU_TBL(0:71) ALIGNED SYMREF,
      877      691    1         2 NAME CHAR(8),
      878      692    1         2 MAXTPU UBIN WORD,
      879      693    1         2 COUNT UBIN HALF UNAL,
      880      694    1         2 FLAGS UNAL,
      881      695    1           3 PRINT BIT(1) UNAL,
      882      696    1           3 DELETED BIT(1) UNAL,
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:141  
      883      697    1           3 * BIT(16) UNAL;
      884      698    1   DCL 1 TPHDR_TBL(0:71) ALIGNED SYMREF,
      885      699    1    2 HDR,
      886      700    1           3 CNT UBIN BYTE UNAL,
      887      701    1           3 MSG CHAR(80)  UNAL,
      888      702    1    2 FLAGS UNAL,
      889      703    1           3 PRINT BIT(1) UNAL,
      890      704    1           3 PRESENT BIT(1) UNAL,
      891      705    1           3 * BIT(16) UNAL;
      892      706        /**/
      893      707    1   DCL 1 SUB_BUF_1 SYMREF,
      894      708    1         2 COUNT UBIN BYTE UNAL,
      895      709    1         2 TEXT CHAR(31) UNAL;
      896      710    1   DCL I SBIN WORD;
      897      711    1   DCL J SBIN WORD;
      898      712    1   DCL K SBIN WORD;
      899      713    1   DCL OUTBUF CHAR(132) STATIC INIT(' ');
      900      714    1   DCL MAXTPUBUF CHAR(32) STATIC INIT('MAXTPU(');
      901      715    1   DCL TPHDRBUF CHAR(132) STATIC INIT('HEADER(');
      902      716    1   DCL DCB_WIDTH SBIN WORD;
      903      717    1   DCL 1 TPBUF STATIC ALIGNED,
      904      718    1         2 COUNT UBIN BYTE UNAL INIT(0),
      905      719    1         2 TEXT CHAR(132) UNAL INIT(' ');
      906      720         %F_FDS (NAME=FDS,DCB=M$LO,BUF=OUTBUF);
      907      833    1   DCL TPIHDR CHAR(0) CONSTANT INIT('Currently defined TP instances:%10P');
      908      834    1   DCL DUMPBUF CHAR(0) CONSTANT INIT('%T%10P');
      909      835    1   DCL TEMP CHAR(8);
      910      836    1   DCL LEN SBIN WORD;
      911      837    1   DCL TEMPLEN SBIN WORD;
      912      838    1   DCL 1 P$TBL(0:0) BASED ALIGNED,
      913      839    1         2 FLAGS,
      914      840    1           3 PRINT BIT(1) UNAL,
      915      841    1           3 DISPONLY BIT(1) UNAL,
      916      842    1           3 INDX BIT(1) UNAL,
      917      843    1           3 RES BIT(1) UNAL,
      918      844    1           3 MAXCONST BIT(1) UNAL,
      919      845    1           3 MINCONST BIT(1) UNAL,
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:142  
      920      846    1           3 VALTEXT BIT(1) UNAL,
      921      847    1             3 VALTEXTLIST BIT(1) UNAL,
      922      848    1             3 * BIT(10) UNAL,
      923      849    1         2 VALCODE UBIN(18) UNAL,
      924      850    1         2 RESPTR$ PTR ALIGNED,
      925      851    1         2 TEXT ALIGNED,
      926      852    1           3 COUNT UBIN(9) UNAL,
      927      853    1           3 TEXT CHAR(19) UNAL,
      928      854    1         2 PTR$ PTR,
      929      855    1         2 REPTR$ REDEF PTR$,
      930      856    1           3 ADDRESS UBIN(24) UNAL,
      931      857    1           3 SEGID UBIN(12) UNAL,
      932      858    1         2 PSUPTR$ PTR,
      933      859    1         2 REPSUPTR$ REDEF PSUPTR$,
      934      860    1           3 ADDRESS UBIN(24) UNAL,
      935      861    1           3 SEGID UBIN(12) UNAL,
      936      862    1         2 MAX UBIN WORD UNAL,
      937      863    1         2 MIN UBIN WORD UNAL,
      938      864    1         2 MULT UBIN WORD UNAL;
      939      865        %EJECT;
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:143  
      940      866    1        TPBUF.COUNT = 0;
      941      867    1        TPBUF.TEXT = ' ';
      942      868    1        DCB_WIDTH = DCBADDR(DCBNUM(M$LO))->F$DCB.WIDTH;
      943      869    1        IF DCB_WIDTH = 0 THEN DCB_WIDTH = 80;
      944      870    2        DO CASE(CODE);
      945      871    2           CASE(%PC_PCTFLAGS);
      946      872    3              IF TP$->P$TBL.FLAGS.PRINT(%PC_TPINSTANCE) THEN DO;
      947      873    4                 IF CURINSTANCES > 0 THEN DO;
      948      874    4                    CALL X$WRITE(FDS,VECTOR(TPIHDR));
      949      875    5                    DO I = 0 TO TBLINSTANCES - 1;
      950      876    6                       IF NOT MAXTPU_TBL.FLAGS.DELETED(I) THEN DO;
      951      877    7                          IF TPBUF.COUNT + MAXTPU_TBL.COUNT(I) > DCB_WIDTH THEN DO;
      952      878    7                             CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));
      953      879    7                             TPBUF.TEXT = ' ';
      954      880    7                             TPBUF.COUNT = 0;
      955      881    7                             END;  /* IF */
      956      882    6                          CALL INSERT(TPBUF.TEXT,TPBUF.COUNT,MAXTPU_TBL.COUNT(I)+1,
      957      883    6                          SUBSTR(MAXTPU_TBL.NAME(I),0,MAXTPU_TBL.COUNT(I)),' ');
      958      884    6                          TPBUF.COUNT = TPBUF.COUNT + MAXTPU_TBL.COUNT(I) + 1;
      959      885    6                          END;  /* IF NOT DELETED */
      960      886    5                       END;  /* DO I */
      961      887    4                    CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));
      962      888    4                    END;  /* IF CURINSTANCES > 0 */
      963      889    4                 ELSE DO;
      964      890    4                    CALL PCE$ERROR(%E$P_NOTPI,0);
      965      891    4                    RETURN;
      966      892    4                    END;  /* ELSE */
      967      893    3                 END;  /* IF PRINT(%PC_TPINSTANCE) */
      968      894    2              TPBUF.COUNT = 0;
      969      895    2              TPBUF.TEXT = ' ';
      970      896    3              IF TP$->P$TBL.MAX(%PC_MAXTPU) ~= 0 THEN DO;
      971      897    4                 DO I = 0 TO TBLINSTANCES - 1;
      972      898    5                    IF MAXTPU_TBL.FLAGS.PRINT(I) AND NOT MAXTPU_TBL.FLAGS.DELETED(I)
               898                             THEN DO;
      973      899    5                       TEMPLEN = MAXTPU_TBL.COUNT(I) + 2;
      974      900    5                       CALL INSERT(MAXTPUBUF,7,TEMPLEN,SUBSTR(MAXTPU_TBL.NAME(I),0,
               900                                MAXTPU_TBL.COUNT(I)),')=');
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:144  
      975      901    5                       TEMPLEN = TEMPLEN + 7;
      976      902    5                       CALL BINCHAR(TEMP,MAXTPU_TBL.MAXTPU(I));
      977      903    5                       K = 0;
      978      904    6                       DO WHILE(SUBSTR(TEMP,K,1) = '0' AND K < 8);
      979      905    6                          K = K + 1;
      980      906    6                          END;  /* DO WHILE */
      981      907    5                       LEN = 8 - K;
      982      908    6                       IF LEN = 0 THEN DO;
      983      909    6                          LEN = 1;
      984      910    6                          K = 0;
      985      911    6                          END;  /* IF LEN = 0 */
      986      912    5                       CALL INSERT(MAXTPUBUF,TEMPLEN,LEN,SUBSTR(TEMP,K,LEN));
      987      913    5                       TEMPLEN = TEMPLEN + LEN;
      988      914    6                       IF TPBUF.COUNT + TEMPLEN > DCB_WIDTH THEN DO;
      989      915    6                          CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));
      990      916    6                          TPBUF.COUNT = 0;
      991      917    6                          TPBUF.TEXT = ' ';
      992      918    6                          END;  /* IF */
      993      919    5                       CALL INSERT(TPBUF.TEXT,TPBUF.COUNT,TEMPLEN+1,SUBSTR(MAXTPUBUF,0,
               919                                TEMPLEN),' ');
      994      920    5                       TPBUF.COUNT = TPBUF.COUNT + TEMPLEN + 1;
      995      921    5                       END;  /* IF PRINT */
      996      922    4                    END;  /* DO I */
      997      923    3                 CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));
      998      924    3                 END;  /* IF */
      999      925    3              IF TP$->P$TBL.MAX(%PC_TPHDR) ~= 0 THEN DO;
     1000      926    4                 DO I = 0 TO TBLINSTANCES - 1;
     1001      927    5                    IF TPHDR_TBL.FLAGS.PRINT(I) AND NOT MAXTPU_TBL.FLAGS.DELETED(I)
               927                             THEN DO;
     1002      928    5                       TEMPLEN = MAXTPU_TBL.COUNT(I) + 2;
     1003      929    5                       CALL INSERT(TPHDRBUF,7,TEMPLEN,SUBSTR(MAXTPU_TBL.NAME(I),0,
               929                                MAXTPU_TBL.COUNT(I)),')=');
     1004      930    5                       TEMPLEN = TEMPLEN + 7;
     1005      931    5                       IF (TPHDR_TBL.HDR.CNT(I) > 0)
     1006      932    6                         THEN DO;
     1007      933    6                            LEN = MINIMUM(TPHDR_TBL.HDR.CNT(I),100);
     1008      934    6                            CALL INSERT(TPHDRBUF,TEMPLEN,LEN,
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:145  
     1009      935    6                                        SUBSTR(TPHDR_TBL.HDR.MSG(I),0,LEN));
     1010      936    6                            END;
     1011      937    6                          ELSE DO;
     1012      938    6                            CALL INSERT(TPHDRBUF,TEMPLEN,4,'NONE');
     1013      939    6                            LEN = 4;
     1014      940    6                            END;  /* IF PRESENT */
     1015      941    5                       TEMPLEN = TEMPLEN + LEN;
     1016      942    6                       IF TPBUF.COUNT + TEMPLEN > DCB_WIDTH THEN DO;
     1017      943    6                          CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));
     1018      944    6                          TPBUF.COUNT = 0;
     1019      945    6                          TPBUF.TEXT = ' ';
     1020      946    6                          END;  /* IF */
     1021      947    5                       CALL INSERT(TPBUF.TEXT,TPBUF.COUNT,TEMPLEN+1,SUBSTR(TPHDRBUF,0,
               947                                TEMPLEN),' ');
     1022      948    5                       TPBUF.COUNT = TPBUF.COUNT + TEMPLEN + 1;
     1023      949    5                       END;  /* IF PRINT */
     1024      950    4                    END;  /* DO I */
     1025      951    3                 CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));
     1026      952    3                 END;  /* IF */
     1027      953    2           CASE(%PC_DITPI,%PC_PCTALL);
     1028      954    3              IF CURINSTANCES > 0 THEN DO;
     1029      955    3                 CALL X$WRITE(FDS,VECTOR(TPIHDR));
     1030      956    4                 DO I = 0 TO TBLINSTANCES - 1;
     1031      957    5                    IF NOT MAXTPU_TBL.FLAGS.DELETED(I) THEN DO;
     1032      958    6                       IF TPBUF.COUNT + MAXTPU_TBL.COUNT(I) > DCB_WIDTH THEN DO;
     1033      959    6                          CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));
     1034      960    6                          TPBUF.TEXT = ' ';
     1035      961    6                          TPBUF.COUNT = 0;
     1036      962    6                          END;  /* IF */
     1037      963    5                       CALL INSERT(TPBUF.TEXT,TPBUF.COUNT,MAXTPU_TBL.COUNT(I)+1,
     1038      964    5                       SUBSTR(MAXTPU_TBL.NAME(I),0,MAXTPU_TBL.COUNT(I)),' ');
     1039      965    5                       TPBUF.COUNT = TPBUF.COUNT + MAXTPU_TBL.COUNT(I) + 1;
     1040      966    5                       END;  /* IF NOT DELETED */
     1041      967    4                    END;  /* DO I */
     1042      968    3                 CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));
     1043      969    3                 END;  /* IF CURINSTANCES > 0 */
     1044      970    3              ELSE DO;
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:146  
     1045      971    3                 CALL PCE$ERROR(%E$P_NOTPI,0);
     1046      972    3                 RETURN;
     1047      973    3                 END;  /* ELSE */
     1048      974    2              IF CODE = %PC_PCTALL THEN GOTO DISP_MAXTPU;
     1049      975    2           CASE(%PC_DIMAXTPU);
     1050      976    2   DISP_MAXTPU:
     1051      977    2              TPBUF.COUNT = 0;
     1052      978    2              TPBUF.TEXT = ' ';
     1053      979    3              IF ADDR(NAME) = ADDR(NIL) THEN DO;
     1054      980    3                 IF CURINSTANCES = 0
     1055      981    3                    THEN CALL PCE$ERROR(%E$P_NOTPI,0);
     1056      982    4                 ELSE DO;
     1057      983    5                    DO I = 0 TO TBLINSTANCES - 1;
     1058      984    6                       IF NOT MAXTPU_TBL.FLAGS.DELETED(I) THEN DO;
     1059      985    6                          TEMPLEN = MAXTPU_TBL.COUNT(I) + 2;
     1060      986    6                          CALL INSERT(MAXTPUBUF,7,TEMPLEN,SUBSTR(MAXTPU_TBL.NAME(I),0,
               986                                   MAXTPU_TBL.COUNT(I)),')=');
     1061      987    6                          TEMPLEN = TEMPLEN + 7;
     1062      988    6                          CALL BINCHAR(TEMP,MAXTPU_TBL.MAXTPU(I));
     1063      989    6                          K = 0;
     1064      990    7                          DO WHILE(SUBSTR(TEMP,K,1) = '0' AND K < 8);
     1065      991    7                             K = K + 1;
     1066      992    7                             END;  /* DO WHILE */
     1067      993    6                          LEN = 8 - K;
     1068      994    7                          IF LEN = 0 THEN DO;
     1069      995    7                             LEN = 1;
     1070      996    7                             K = 0;
     1071      997    7                             END;  /* IF */
     1072      998    6                          CALL INSERT(MAXTPUBUF,TEMPLEN,LEN,SUBSTR(TEMP,K,LEN));
     1073      999    6                          TEMPLEN = TEMPLEN + LEN;
     1074     1000    7                          IF TPBUF.COUNT + TEMPLEN > DCB_WIDTH THEN DO;
     1075     1001    7                             CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));
     1076     1002    7                             TPBUF.COUNT = 0;
     1077     1003    7                             TPBUF.TEXT = ' ';
     1078     1004    7                             END;  /* IF */
     1079     1005    6                          CALL INSERT(TPBUF.TEXT,TPBUF.COUNT,TEMPLEN+1,SUBSTR(MAXTPUBUF
              1005                                   ,0,TEMPLEN),' ');
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:147  
     1080     1006    6                          TPBUF.COUNT = TPBUF.COUNT + TEMPLEN + 1;
     1081     1007    6                          END;  /* IF NOT DELETED */
     1082     1008    5                       END;  /* DO I */
     1083     1009    4                    CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));
     1084     1010    4                    END;  /* ELSE */
     1085     1011    3                 END;  /* IF ADDR(NAME) = ADDR(NIL) */
     1086     1012    3              ELSE DO;  /* NAME SPECIFIED */
     1087     1013    4                 DO I = 0 TO TBLINSTANCES - 1;
     1088     1014    4                    IF NAME = MAXTPU_TBL.NAME(I) AND NOT MAXTPU_TBL.FLAGS.DELETED(I)
     1089     1015    4                       THEN GOTO FOUND_IT;
     1090     1016    4                    END;  /* DO I */
     1091     1017    3                 K = 0;
     1092     1018    4                 DO WHILE(SUBSTR(NAME,K,1) ~= ' ' AND K < 8);
     1093     1019    4                    K = K + 1;
     1094     1020    4                    END;  /* DO WHILE */
     1095     1021    3                 SUB_BUF_1.COUNT = K;
     1096     1022    3                 SUB_BUF_1.TEXT = NAME;
     1097     1023    3                 CALL PCE$ERROR(%E$P_BAD_INSTANCE_NAME,3);
     1098     1024    3                 RETURN;
     1099     1025    3   FOUND_IT:     TEMPLEN = MAXTPU_TBL.COUNT(I) + 2;
     1100     1026    3                 CALL INSERT(MAXTPUBUF,7,TEMPLEN,SUBSTR(MAXTPU_TBL.NAME(I),0,MAXTPU_TBL
              1026                          .COUNT(I)),')=');
     1101     1027    3                 TEMPLEN = TEMPLEN + 7;
     1102     1028    3                 CALL BINCHAR(TEMP,MAXTPU_TBL.MAXTPU(I));
     1103     1029    3                 K = 0;
     1104     1030    4                 DO WHILE(SUBSTR(TEMP,K,1) = '0' AND K < 8);
     1105     1031    4                    K = K + 1;
     1106     1032    4                    END;  /* DO WHILE */
     1107     1033    3                 LEN = 8 - K;
     1108     1034    4                 IF LEN = 0 THEN DO;
     1109     1035    4                    LEN = 1;
     1110     1036    4                    K = 0;
     1111     1037    4                    END;  /* IF */
     1112     1038    3                 CALL INSERT(MAXTPUBUF,TEMPLEN,LEN,SUBSTR(TEMP,K,LEN));
     1113     1039    3                 TPBUF.TEXT = MAXTPUBUF;
     1114     1040    3                 TPBUF.COUNT = TEMPLEN + LEN;
     1115     1041    3                 CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:148  
     1116     1042    3                 END;  /* ELSE NAME SPECIFIED */
     1117     1043    2              IF CODE = %PC_PCTALL THEN GOTO DISP_TPHDR;
     1118     1044    2           CASE(%PC_DITPHDR);
     1119     1045    2   DISP_TPHDR:
     1120     1046    2              TPBUF.COUNT = 0;
     1121     1047    2              TPBUF.TEXT = ' ';
     1122     1048    3              IF ADDR(NAME) = ADDR(NIL) THEN DO;
     1123     1049    3                 IF CURINSTANCES = 0
     1124     1050    3                    THEN CALL PCE$ERROR(%E$P_NOTPI,0);
     1125     1051    4                 ELSE DO;
     1126     1052    5                    DO I = 0 TO TBLINSTANCES - 1;
     1127     1053    6                       IF NOT MAXTPU_TBL.FLAGS.DELETED(I) THEN DO;
     1128     1054    6                          TEMPLEN = MAXTPU_TBL.COUNT(I) + 2;
     1129     1055    6                          CALL INSERT(TPHDRBUF,7,TEMPLEN,SUBSTR(MAXTPU_TBL.NAME(I),0,
              1055                                   MAXTPU_TBL.COUNT(I)),')=');
     1130     1056    6                          TEMPLEN = TEMPLEN + 7;
     1131     1057    6                          IF (TPHDR_TBL.HDR.CNT(I) > 0)
     1132     1058    7                            THEN DO;
     1133     1059    7                               LEN = MINIMUM(TPHDR_TBL.HDR.CNT(I),100);
     1134     1060    7                               CALL INSERT(TPHDRBUF,TEMPLEN,LEN,
     1135     1061    7                                           SUBSTR(TPHDR_TBL.HDR.MSG(I),0,LEN));
     1136     1062    7                               END;
     1137     1063    7                             ELSE DO;
     1138     1064    7                               CALL INSERT(TPHDRBUF,TEMPLEN,4,'NONE');
     1139     1065    7                               LEN = 4;
     1140     1066    7                               END;  /* IF PRESENT */
     1141     1067    6                          TEMPLEN = TEMPLEN + LEN;
     1142     1068    7                          IF TPBUF.COUNT + TEMPLEN > DCB_WIDTH THEN DO;
     1143     1069    7                             CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));
     1144     1070    7                             TPBUF.COUNT = 0;
     1145     1071    7                             TPBUF.TEXT = ' ';
     1146     1072    7                             END;  /* IF */
     1147     1073    6                          CALL INSERT(TPBUF.TEXT,TPBUF.COUNT,TEMPLEN+1,SUBSTR(TPHDRBUF,
              1073                                   0,TEMPLEN),' ');
     1148     1074    6                          TPBUF.COUNT = TPBUF.COUNT + TEMPLEN + 1;
     1149     1075    6                          END;  /* IF NOT DELETED */
     1150     1076    5                       END;  /* DO I */
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:149  
     1151     1077    4                    CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));
     1152     1078    4                    END;  /* ELSE */
     1153     1079    3                 END;  /* IF ADDR(NAME) = ADDR(NIL) */
     1154     1080    3              ELSE DO;  /* NAME SPECIFIED */
     1155     1081    4                 DO I = 0 TO TBLINSTANCES - 1;
     1156     1082    4                    IF NAME = MAXTPU_TBL.NAME(I) AND NOT MAXTPU_TBL.FLAGS.DELETED(I)
     1157     1083    4                       THEN GOTO FOUND_IT2;
     1158     1084    4                    END;  /* DO I */
     1159     1085    3                 K = 0;
     1160     1086    4                 DO WHILE(SUBSTR(NAME,K,1) ~= ' ' AND K < 8);
     1161     1087    4                    K = K + 1;
     1162     1088    4                    END;  /* DO WHILE */
     1163     1089    3                 SUB_BUF_1.COUNT = K;
     1164     1090    3                 SUB_BUF_1.TEXT = NAME;
     1165     1091    3                 CALL PCE$ERROR(%E$P_BAD_INSTANCE_NAME,3);
     1166     1092    3                 RETURN;
     1167     1093    3   FOUND_IT2:    TEMPLEN = MAXTPU_TBL.COUNT(I) + 2;
     1168     1094    3                 CALL INSERT(TPHDRBUF,7,TEMPLEN,SUBSTR(MAXTPU_TBL.NAME(I),0,MAXTPU_TBL.
              1094                          COUNT(I)),')=');
     1169     1095    3                 TEMPLEN = TEMPLEN + 7;
     1170     1096    3                 IF (TPHDR_TBL.HDR.CNT(I) > 0)
     1171     1097    4                   THEN DO;
     1172     1098    4                      LEN = MINIMUM(TPHDR_TBL.HDR.CNT(I),100);
     1173     1099    4                      CALL INSERT(TPHDRBUF,TEMPLEN,LEN,
     1174     1100    4                                  SUBSTR(TPHDR_TBL.HDR.MSG(I),0,LEN));
     1175     1101    4                      END;
     1176     1102    4                    ELSE DO;
     1177     1103    4                      CALL INSERT(TPHDRBUF,TEMPLEN,4,'NONE');
     1178     1104    4                      LEN = 4;
     1179     1105    4                      END;  /* IF PRESENT */
     1180     1106    3                 TPBUF.TEXT = TPHDRBUF;
     1181     1107    3                 TPBUF.COUNT = TEMPLEN + LEN;
     1182     1108    3                 CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));
     1183     1109    3                 END;  /* ELSE NAME SPECIFIED */
     1184     1110    2           END;  /* DO CASE(CODE) */
     1185     1111    1           RETURN;
     1186     1112    1   END PCT$TPCAT;
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:150  

PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:151  
--  Include file information  --

   XUF_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   PC_PERR_C.:E05TOU  is referenced.
   PC_SUBS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure PCT$TPCAT.

   Procedure PCT$TPCAT requires 932 words for executable code.
   Procedure PCT$TPCAT requires 18 words of local(AUTO) storage.

    No errors detected in file PCT$TABLES.:E05TSI    .

PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:152  

 Object Unit name= PCT$TPCAT                                  File name= PCT$TABLES.:E05TOU
 UTS= JUL 30 '97 04:23:06.84 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2   Data  even  none   138    212  PCT$TPCAT
    3  RoData even  UTS     13     15  PCT$TPCAT
    4   Proc  even  none   932   1644  PCT$TPCAT
    5  RoData even  none    20     24  PCT$TPCAT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        2  PCT$TPCAT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std      22 X$WRITE
 yes     yes           Std       2 PCE$ERROR
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:153  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$LO                                  TP$
     CURINSTANCES                          TBLINSTANCES                          MAXTPU_TBL
     TPHDR_TBL                             SUB_BUF_1                             B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID                                 ROSID
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:154  


      846        1        /*M* PCT$TPCAT - DISPLAY TP PARAMS FOR CONTROL */
      847        2        /*T***********************************************************/
      848        3        /*T*                                                         */
      849        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      850        5        /*T*                                                         */
      851        6        /*T***********************************************************/
      852        7        PCT$TPCAT: PROC(CODE,NAME) ALTRET;

      7  4 000000   000000 700200 xent  PCT$TPCAT    TSX0  ! X66_AUTO_2
         4 000001   000022 000002                    ZERO    18,2

      853        8        /**/
      854        9        /* PARAMS */
      855       10    1   DCL CODE SBIN WORD;
      856       11    1   DCL NAME CHAR(8);
      857       12        /**/
      858       13        /* INCLUDE FILES */
      859       14        %INCLUDE CP_6;
      860       95        %INCLUDE PC_SUBS_C;
      861      427        %INCLUDE PC_PERR_C;
      862      460        %INCLUDE F$DCB;
      863      509        %INCLUDE XU_FORMAT_C;
      864      671        %INCLUDE XUF_ENTRY;
      865      679        /**/
      866      680        /* DCBS */
      867      681    1   DCL M$LO DCB;
      868      682        /**/
      869      683        /* ENTRY DCLS */
      870      684    1   DCL PCE$ERROR ENTRY(2) ALTRET;
      871      685        /**/
      872      686        /* VARS */
      873      687    1   DCL TP$ PTR SYMREF;
      874      688    1   DCL CURINSTANCES SBIN WORD SYMREF;
      875      689    1   DCL TBLINSTANCES SBIN WORD SYMREF;
      876      690    1   DCL 1 MAXTPU_TBL(0:71) ALIGNED SYMREF,
      877      691    1         2 NAME CHAR(8),
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:155  
      878      692    1         2 MAXTPU UBIN WORD,
      879      693    1         2 COUNT UBIN HALF UNAL,
      880      694    1         2 FLAGS UNAL,
      881      695    1           3 PRINT BIT(1) UNAL,
      882      696    1           3 DELETED BIT(1) UNAL,
      883      697    1           3 * BIT(16) UNAL;
      884      698    1   DCL 1 TPHDR_TBL(0:71) ALIGNED SYMREF,
      885      699    1    2 HDR,
      886      700    1           3 CNT UBIN BYTE UNAL,
      887      701    1           3 MSG CHAR(80)  UNAL,
      888      702    1    2 FLAGS UNAL,
      889      703    1           3 PRINT BIT(1) UNAL,
      890      704    1           3 PRESENT BIT(1) UNAL,
      891      705    1           3 * BIT(16) UNAL;
      892      706        /**/
      893      707    1   DCL 1 SUB_BUF_1 SYMREF,
      894      708    1         2 COUNT UBIN BYTE UNAL,
      895      709    1         2 TEXT CHAR(31) UNAL;
      896      710    1   DCL I SBIN WORD;
      897      711    1   DCL J SBIN WORD;
      898      712    1   DCL K SBIN WORD;
      899      713    1   DCL OUTBUF CHAR(132) STATIC INIT(' ');
      900      714    1   DCL MAXTPUBUF CHAR(32) STATIC INIT('MAXTPU(');
      901      715    1   DCL TPHDRBUF CHAR(132) STATIC INIT('HEADER(');
      902      716    1   DCL DCB_WIDTH SBIN WORD;
      903      717    1   DCL 1 TPBUF STATIC ALIGNED,
      904      718    1         2 COUNT UBIN BYTE UNAL INIT(0),
      905      719    1         2 TEXT CHAR(132) UNAL INIT(' ');
      906      720         %F_FDS (NAME=FDS,DCB=M$LO,BUF=OUTBUF);
      907      833    1   DCL TPIHDR CHAR(0) CONSTANT INIT('Currently defined TP instances:%10P');
      908      834    1   DCL DUMPBUF CHAR(0) CONSTANT INIT('%T%10P');
      909      835    1   DCL TEMP CHAR(8);
      910      836    1   DCL LEN SBIN WORD;
      911      837    1   DCL TEMPLEN SBIN WORD;
      912      838    1   DCL 1 P$TBL(0:0) BASED ALIGNED,
      913      839    1         2 FLAGS,
      914      840    1           3 PRINT BIT(1) UNAL,
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:156  
      915      841    1           3 DISPONLY BIT(1) UNAL,
      916      842    1           3 INDX BIT(1) UNAL,
      917      843    1           3 RES BIT(1) UNAL,
      918      844    1           3 MAXCONST BIT(1) UNAL,
      919      845    1           3 MINCONST BIT(1) UNAL,
      920      846    1           3 VALTEXT BIT(1) UNAL,
      921      847    1             3 VALTEXTLIST BIT(1) UNAL,
      922      848    1             3 * BIT(10) UNAL,
      923      849    1         2 VALCODE UBIN(18) UNAL,
      924      850    1         2 RESPTR$ PTR ALIGNED,
      925      851    1         2 TEXT ALIGNED,
      926      852    1           3 COUNT UBIN(9) UNAL,
      927      853    1           3 TEXT CHAR(19) UNAL,
      928      854    1         2 PTR$ PTR,
      929      855    1         2 REPTR$ REDEF PTR$,
      930      856    1           3 ADDRESS UBIN(24) UNAL,
      931      857    1           3 SEGID UBIN(12) UNAL,
      932      858    1         2 PSUPTR$ PTR,
      933      859    1         2 REPSUPTR$ REDEF PSUPTR$,
      934      860    1           3 ADDRESS UBIN(24) UNAL,
      935      861    1           3 SEGID UBIN(12) UNAL,
      936      862    1         2 MAX UBIN WORD UNAL,
      937      863    1         2 MIN UBIN WORD UNAL,
      938      864    1         2 MULT UBIN WORD UNAL;
      939      865        %EJECT;
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:157  
      940      866    1        TPBUF.COUNT = 0;

    866  4 000002   000000 236003                    LDQ     0,DU
         4 000003   000112 552040 2                  STBQ    TPBUF,'40'O

      941      867    1        TPBUF.TEXT = ' ';

    867  4 000004   040000 100400                    MLR     fill='040'O
         4 000005   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000006   000112 200204 2                  ADSC9   TPBUF                    cn=1,n=132

      942      868    1        DCB_WIDTH = DCBADDR(DCBNUM(M$LO))->F$DCB.WIDTH;

    868  4 000007   000000 236007 xsym               LDQ     M$LO,DL
         4 000010   000000 470400 5                  LDP0    0
         4 000011   000000 471500                    LDP1    0,,PR0
         4 000012   100000 473506                    LDP3    0,QL,PR1
         4 000013   300004 236100                    LDQ     4,,PR3
         4 000014   000777 376007                    ANQ     511,DL
         4 000015   200010 756100                    STQ     DCB_WIDTH,,AUTO

      943      869    1        IF DCB_WIDTH = 0 THEN DCB_WIDTH = 80;

    869  4 000016   000021 601000 4                  TNZ     s:870

    869  4 000017   000120 235007                    LDA     80,DL
         4 000020   200010 755100                    STA     DCB_WIDTH,,AUTO

      944      870    2        DO CASE(CODE);

    870  4 000021   200003 473500                    LDP3    @CODE,,AUTO
         4 000022   300000 235100                    LDA     0,,PR3
         4 000023   000007 115007                    CMPA    7,DL
         4 000024   000026 602005 4                  TNC     s:870+5,AL
         4 000025   001643 710000 4                  TRA     s:1111
         4 000026   001643 710000 4                  TRA     s:1111
         4 000027   000551 710000 4                  TRA     s:954
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:158  
         4 000030   000035 710000 4                  TRA     s:872
         4 000031   001643 710000 4                  TRA     s:1111
         4 000032   000551 710000 4                  TRA     s:954
         4 000033   000702 710000 4                  TRA     DISP_MAXTPU
         4 000034   001267 710000 4                  TRA     DISP_TPHDR

      945      871    2           CASE(%PC_PCTFLAGS);

      946      872    3              IF TP$->P$TBL.FLAGS.PRINT(%PC_TPINSTANCE) THEN DO;

    872  4 000035   000000 474400 xsym               LDP4    TP$
         4 000036   400014 234100                    SZN     12,,PR4
         4 000037   000164 605000 4                  TPL     s:894

      947      873    4                 IF CURINSTANCES > 0 THEN DO;

    873  4 000040   000000 236000 xsym               LDQ     CURINSTANCES
         4 000041   000157 604400 4                  TMOZ    s:890

      948      874    4                    CALL X$WRITE(FDS,VECTOR(TPIHDR));

    874  4 000042   000004 630400 5                  EPPR0   4
         4 000043   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000044   000000 701000 xent               TSX1    X$WRITE
         4 000045   000000 011000                    NOP     0

      949      875    5                    DO I = 0 TO TBLINSTANCES - 1;

    875  4 000046   200005 450100                    STZ     I,,AUTO
         4 000047   000147 710000 4                  TRA     s:886+1

      950      876    6                       IF NOT MAXTPU_TBL.FLAGS.DELETED(I) THEN DO;

    876  4 000050   200005 235100                    LDA     I,,AUTO
         4 000051   000002 735000                    ALS     2
         4 000052   000003 236005 xsym               LDQ     MAXTPU_TBL+3,AL
         4 000053   200000 316007                    CANQ    65536,DL
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:159  
         4 000054   000146 601000 4                  TNZ     s:886

      951      877    7                          IF TPBUF.COUNT + MAXTPU_TBL.COUNT(I) > DCB_WIDTH THEN DO;

    877  4 000055   000003 236005 xsym               LDQ     MAXTPU_TBL+3,AL
         4 000056   000022 772000                    QRL     18
         4 000057   200016 756100                    STQ     TEMPLEN+2,,AUTO
         4 000060   000112 236000 2                  LDQ     TPBUF
         4 000061   000033 772000                    QRL     27
         4 000062   200016 036100                    ADLQ    TEMPLEN+2,,AUTO
         4 000063   000066 604000 4                  TMI     s:878
         4 000064   200010 116100                    CMPQ    DCB_WIDTH,,AUTO
         4 000065   000077 604400 4                  TMOZ    s:882

      952      878    7                             CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));

    878  4 000066   000012 630400 5                  EPPR0   10
         4 000067   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000070   000000 701000 xent               TSX1    X$WRITE
         4 000071   000000 011000                    NOP     0

      953      879    7                             TPBUF.TEXT = ' ';

    879  4 000072   040000 100400                    MLR     fill='040'O
         4 000073   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000074   000112 200204 2                  ADSC9   TPBUF                    cn=1,n=132

      954      880    7                             TPBUF.COUNT = 0;

    880  4 000075   000000 236003                    LDQ     0,DU
         4 000076   000112 552040 2                  STBQ    TPBUF,'40'O

      955      881    7                             END;  /* IF */

      956      882    6                          CALL INSERT(TPBUF.TEXT,TPBUF.COUNT,MAXTPU_TBL.COUNT(I)+1,

    882  4 000077   200005 235100                    LDA     I,,AUTO
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:160  
         4 000100   000002 735000                    ALS     2
         4 000101   000003 220005 xsym               LDX0    MAXTPU_TBL+3,AL
         4 000102   000112 236000 2                  LDQ     TPBUF
         4 000103   000033 772000                    QRL     27
         4 000104   000003 221005 xsym               LDX1    MAXTPU_TBL+3,AL
         4 000105   000001 622011                    EAX2    1,X1
         4 000106   200005 235100                    LDA     I,,AUTO
         4 000107   000004 735000                    ALS     4
         4 000110   040046 100445                    MLR     fill='040'O
         4 000111   000000 000010 xsym               ADSC9   MAXTPU_TBL,A             cn=0,n=*X0
         4 000112   000112 200012 2                  ADSC9   TPBUF,Q                  cn=1,n=*X2
         4 000113   000000 635010                    EAA     0,X0
         4 000114   000022 771000                    ARL     18
         4 000115   200016 755100                    STA     TEMPLEN+2,,AUTO
         4 000116   200017 756100                    STQ     TEMPLEN+3,,AUTO
         4 000117   000000 636012                    EAQ     0,X2
         4 000120   000022 772000                    QRL     18
         4 000121   200016 136100                    SBLQ    TEMPLEN+2,,AUTO
         4 000122   000133 604400 4                  TMOZ    s:884
         4 000123   200020 756100                    STQ     TEMPLEN+4,,AUTO
         4 000124   000000 636010                    EAQ     0,X0
         4 000125   000022 772000                    QRL     18
         4 000126   200017 036100                    ADLQ    TEMPLEN+3,,AUTO
         4 000127   200020 720100                    LXL0    TEMPLEN+4,,AUTO
         4 000130   040046 100400                    MLR     fill='040'O
         4 000131   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000132   000112 200010 2                  ADSC9   TPBUF,Q                  cn=1,n=*X0

      957      883    6                          SUBSTR(MAXTPU_TBL.NAME(I),0,MAXTPU_TBL.COUNT(I)),' ');
      958      884    6                          TPBUF.COUNT = TPBUF.COUNT + MAXTPU_TBL.COUNT(I) + 1;

    884  4 000133   200005 235100                    LDA     I,,AUTO
         4 000134   000002 735000                    ALS     2
         4 000135   000003 236005 xsym               LDQ     MAXTPU_TBL+3,AL
         4 000136   000022 772000                    QRL     18
         4 000137   200016 756100                    STQ     TEMPLEN+2,,AUTO
         4 000140   000112 236000 2                  LDQ     TPBUF
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:161  
         4 000141   000033 772000                    QRL     27
         4 000142   200016 036100                    ADLQ    TEMPLEN+2,,AUTO
         4 000143   000001 036007                    ADLQ    1,DL
         4 000144   000033 736000                    QLS     27
         4 000145   000112 552040 2                  STBQ    TPBUF,'40'O

      959      885    6                          END;  /* IF NOT DELETED */

      960      886    5                       END;  /* DO I */

    886  4 000146   200005 054100                    AOS     I,,AUTO
         4 000147   200005 236100                    LDQ     I,,AUTO
         4 000150   000000 116000 xsym               CMPQ    TBLINSTANCES
         4 000151   000050 604000 4                  TMI     s:876

      961      887    4                    CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));

    887  4 000152   000012 630400 5                  EPPR0   10
         4 000153   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000154   000000 701000 xent               TSX1    X$WRITE
         4 000155   000000 011000                    NOP     0

      962      888    4                    END;  /* IF CURINSTANCES > 0 */

    888  4 000156   000164 710000 4                  TRA     s:894

      963      889    4                 ELSE DO;

      964      890    4                    CALL PCE$ERROR(%E$P_NOTPI,0);

    890  4 000157   000016 630400 5                  EPPR0   14
         4 000160   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000161   000000 701000 xent               TSX1    PCE$ERROR
         4 000162   000000 011000                    NOP     0

      965      891    4                    RETURN;

PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:162  
    891  4 000163   000000 702200 xent               TSX2  ! X66_ARET

      966      892    4                    END;  /* ELSE */
      967      893    3                 END;  /* IF PRINT(%PC_TPINSTANCE) */
      968      894    2              TPBUF.COUNT = 0;

    894  4 000164   000000 236003                    LDQ     0,DU
         4 000165   000112 552040 2                  STBQ    TPBUF,'40'O

      969      895    2              TPBUF.TEXT = ' ';

    895  4 000166   040000 100400                    MLR     fill='040'O
         4 000167   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000170   000112 200204 2                  ADSC9   TPBUF                    cn=1,n=132

      970      896    3              IF TP$->P$TBL.MAX(%PC_MAXTPU) ~= 0 THEN DO;

    896  4 000171   000000 470400 xsym               LDP0    TP$
         4 000172   000055 235100                    LDA     45,,PR0
         4 000173   000360 600000 4                  TZE     s:925

      971      897    4                 DO I = 0 TO TBLINSTANCES - 1;

    897  4 000174   200005 450100                    STZ     I,,AUTO
         4 000175   000351 710000 4                  TRA     s:922+1

      972      898    5                    IF MAXTPU_TBL.FLAGS.PRINT(I) AND NOT MAXTPU_TBL.FLAGS.DELETED(I)
               898                             THEN DO;

    898  4 000176   200005 235100                    LDA     I,,AUTO
         4 000177   000002 735000                    ALS     2
         4 000200   000003 236005 xsym               LDQ     MAXTPU_TBL+3,AL
         4 000201   400000 316007                    CANQ    -131072,DL
         4 000202   000350 600000 4                  TZE     s:922
         4 000203   200000 316007                    CANQ    65536,DL
         4 000204   000350 601000 4                  TNZ     s:922

PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:163  
      973      899    5                       TEMPLEN = MAXTPU_TBL.COUNT(I) + 2;

    899  4 000205   000003 236005 xsym               LDQ     MAXTPU_TBL+3,AL
         4 000206   000022 772000                    QRL     18
         4 000207   000002 036007                    ADLQ    2,DL
         4 000210   200014 756100                    STQ     TEMPLEN,,AUTO

      974      900    5                       CALL INSERT(MAXTPUBUF,7,TEMPLEN,SUBSTR(MAXTPU_TBL.NAME(I),0,
               900                                MAXTPU_TBL.COUNT(I)),')=');

    900  4 000211   000003 220005 xsym               LDX0    MAXTPU_TBL+3,AL
         4 000212   200005 235100                    LDA     I,,AUTO
         4 000213   000004 735000                    ALS     4
         4 000214   000000 621006                    EAX1    0,QL
         4 000215   040040 100445                    MLR     fill='040'O
         4 000216   000000 000010 xsym               ADSC9   MAXTPU_TBL,A             cn=0,n=*X0
         4 000217   000042 600011 2                  ADSC9   MAXTPUBUF+1              cn=3,n=*X1
         4 000220   000000 636010                    EAQ     0,X0
         4 000221   000022 772000                    QRL     18
         4 000222   200016 756100                    STQ     TEMPLEN+2,,AUTO
         4 000223   200014 236100                    LDQ     TEMPLEN,,AUTO
         4 000224   200016 136100                    SBLQ    TEMPLEN+2,,AUTO
         4 000225   000234 604400 4                  TMOZ    s:901
         4 000226   000000 621006                    EAX1    0,QL
         4 000227   000000 636010                    EAQ     0,X0
         4 000230   000022 772000                    QRL     18
         4 000231   040046 100400                    MLR     fill='040'O
         4 000232   000013 000002 3                  ADSC9   DUMPBUF+2                cn=0,n=2
         4 000233   000042 600011 2                  ADSC9   MAXTPUBUF+1,Q            cn=3,n=*X1

      975      901    5                       TEMPLEN = TEMPLEN + 7;

    901  4 000234   000007 236007                    LDQ     7,DL
         4 000235   200014 056100                    ASQ     TEMPLEN,,AUTO

      976      902    5                       CALL BINCHAR(TEMP,MAXTPU_TBL.MAXTPU(I));

PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:164  
    902  4 000236   200005 235100                    LDA     I,,AUTO
         4 000237   000002 735000                    ALS     2
         4 000240   000002 235005 xsym               LDA     MAXTPU_TBL+2,AL
         4 000241   000044 773000                    LRL     36
         4 000242   200016 757100                    STAQ    TEMPLEN+2,,AUTO
         4 000243   000100 301500                    BTD
         4 000244   200016 000010                    NDSC9   TEMPLEN+2,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         4 000245   200011 030010                    NDSC9   TEMP,,AUTO               cn=0,s=nosgn,sf=0,n=8

      977      903    5                       K = 0;

    903  4 000246   200007 450100                    STZ     K,,AUTO

      978      904    6                       DO WHILE(SUBSTR(TEMP,K,1) = '0' AND K < 8);

    904  4 000247   000251 710000 4                  TRA     s:906

      979      905    6                          K = K + 1;

    905  4 000250   200007 054100                    AOS     K,,AUTO

      980      906    6                          END;  /* DO WHILE */

    906  4 000251   200007 235100                    LDA     K,,AUTO
         4 000252   040000 106505                    CMPC    fill='040'O
         4 000253   200011 000001                    ADSC9   TEMP,A,AUTO              cn=0,n=1
         4 000254   000020 000001 5                  ADSC9   16                       cn=0,n=1
         4 000255   000260 601000 4                  TNZ     s:907
         4 000256   000010 115007                    CMPA    8,DL
         4 000257   000250 604000 4                  TMI     s:905

      981      907    5                       LEN = 8 - K;

    907  4 000260   000027 675000 xsym               ERA     B_VECTNIL+23
         4 000261   000011 035007                    ADLA    9,DL
         4 000262   200013 755100                    STA     LEN,,AUTO

PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:165  
      982      908    6                       IF LEN = 0 THEN DO;

    908  4 000263   000267 601000 4                  TNZ     s:912

      983      909    6                          LEN = 1;

    909  4 000264   000001 236007                    LDQ     1,DL
         4 000265   200013 756100                    STQ     LEN,,AUTO

      984      910    6                          K = 0;

    910  4 000266   200007 450100                    STZ     K,,AUTO

      985      911    6                          END;  /* IF LEN = 0 */

      986      912    5                       CALL INSERT(MAXTPUBUF,TEMPLEN,LEN,SUBSTR(TEMP,K,LEN));

    912  4 000267   200013 720100                    LXL0    LEN,,AUTO
         4 000270   200007 235100                    LDA     K,,AUTO
         4 000271   200014 236100                    LDQ     TEMPLEN,,AUTO
         4 000272   040046 100545                    MLR     fill='040'O
         4 000273   200011 000010                    ADSC9   TEMP,A,AUTO              cn=0,n=*X0
         4 000274   000041 000010 2                  ADSC9   MAXTPUBUF,Q              cn=0,n=*X0

      987      913    5                       TEMPLEN = TEMPLEN + LEN;

    913  4 000275   200013 036100                    ADLQ    LEN,,AUTO
         4 000276   200014 756100                    STQ     TEMPLEN,,AUTO

      988      914    6                       IF TPBUF.COUNT + TEMPLEN > DCB_WIDTH THEN DO;

    914  4 000277   000112 236000 2                  LDQ     TPBUF
         4 000300   000033 772000                    QRL     27
         4 000301   200014 036100                    ADLQ    TEMPLEN,,AUTO
         4 000302   200010 116100                    CMPQ    DCB_WIDTH,,AUTO
         4 000303   000315 604400 4                  TMOZ    s:919

PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:166  
      989      915    6                          CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));

    915  4 000304   000012 630400 5                  EPPR0   10
         4 000305   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000306   000000 701000 xent               TSX1    X$WRITE
         4 000307   000000 011000                    NOP     0

      990      916    6                          TPBUF.COUNT = 0;

    916  4 000310   000000 236003                    LDQ     0,DU
         4 000311   000112 552040 2                  STBQ    TPBUF,'40'O

      991      917    6                          TPBUF.TEXT = ' ';

    917  4 000312   040000 100400                    MLR     fill='040'O
         4 000313   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000314   000112 200204 2                  ADSC9   TPBUF                    cn=1,n=132

      992      918    6                          END;  /* IF */

      993      919    5                      CALL INSERT(TPBUF.TEXT,TPBUF.COUNT,TEMPLEN+1,SUBSTR(MAXTPUBUF,0,
               919                                TEMPLEN),' ');

    919  4 000315   000112 236000 2                  LDQ     TPBUF
         4 000316   000033 772000                    QRL     27
         4 000317   200014 720100                    LXL0    TEMPLEN,,AUTO
         4 000320   000001 621010                    EAX1    1,X0
         4 000321   200014 722100                    LXL2    TEMPLEN,,AUTO
         4 000322   040046 100440                    MLR     fill='040'O
         4 000323   000041 000012 2                  ADSC9   MAXTPUBUF                cn=0,n=*X2
         4 000324   000112 200011 2                  ADSC9   TPBUF,Q                  cn=1,n=*X1
         4 000325   200016 756100                    STQ     TEMPLEN+2,,AUTO
         4 000326   200014 236100                    LDQ     TEMPLEN,,AUTO
         4 000327   200014 136100                    SBLQ    TEMPLEN,,AUTO
         4 000330   000027 116000 xsym               CMPQ    B_VECTNIL+23
         4 000331   000342 604400 4                  TMOZ    s:920
         4 000332   200017 756100                    STQ     TEMPLEN+3,,AUTO
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:167  
         4 000333   200016 236100                    LDQ     TEMPLEN+2,,AUTO
         4 000334   200014 036100                    ADLQ    TEMPLEN,,AUTO
         4 000335   200017 723100                    LXL3    TEMPLEN+3,,AUTO
         4 000336   000001 624013                    EAX4    1,X3
         4 000337   040046 100400                    MLR     fill='040'O
         4 000340   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000341   000112 200014 2                  ADSC9   TPBUF,Q                  cn=1,n=*X4

      994      920    5                       TPBUF.COUNT = TPBUF.COUNT + TEMPLEN + 1;

    920  4 000342   000112 236000 2                  LDQ     TPBUF
         4 000343   000033 772000                    QRL     27
         4 000344   200014 036100                    ADLQ    TEMPLEN,,AUTO
         4 000345   000001 036007                    ADLQ    1,DL
         4 000346   000033 736000                    QLS     27
         4 000347   000112 552040 2                  STBQ    TPBUF,'40'O

      995      921    5                       END;  /* IF PRINT */

      996      922    4                    END;  /* DO I */

    922  4 000350   200005 054100                    AOS     I,,AUTO
         4 000351   200005 236100                    LDQ     I,,AUTO
         4 000352   000000 116000 xsym               CMPQ    TBLINSTANCES
         4 000353   000176 604000 4                  TMI     s:898

      997      923    3                 CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));

    923  4 000354   000012 630400 5                  EPPR0   10
         4 000355   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000356   000000 701000 xent               TSX1    X$WRITE
         4 000357   000000 011000                    NOP     0

      998      924    3                 END;  /* IF */

      999      925    3              IF TP$->P$TBL.MAX(%PC_TPHDR) ~= 0 THEN DO;

PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:168  
    925  4 000360   000000 470400 xsym               LDP0    TP$
         4 000361   000041 235100                    LDA     33,,PR0
         4 000362   001643 600000 4                  TZE     s:1111

     1000      926    4                 DO I = 0 TO TBLINSTANCES - 1;

    926  4 000363   200005 450100                    STZ     I,,AUTO
         4 000364   000541 710000 4                  TRA     s:950+1

     1001      927    5                    IF TPHDR_TBL.FLAGS.PRINT(I) AND NOT MAXTPU_TBL.FLAGS.DELETED(I)
               927                             THEN DO;

    927  4 000365   200005 236100                    LDQ     I,,AUTO
         4 000366   000025 402007                    MPY     21,DL
         4 000367   000024 236006 xsym               LDQ     TPHDR_TBL+20,QL
         4 000370   000400 316003                    CANQ    256,DU
         4 000371   000540 600000 4                  TZE     s:950
         4 000372   200005 235100                    LDA     I,,AUTO
         4 000373   000002 735000                    ALS     2
         4 000374   000003 236005 xsym               LDQ     MAXTPU_TBL+3,AL
         4 000375   200000 316007                    CANQ    65536,DL
         4 000376   000540 601000 4                  TNZ     s:950

     1002      928    5                       TEMPLEN = MAXTPU_TBL.COUNT(I) + 2;

    928  4 000377   000003 236005 xsym               LDQ     MAXTPU_TBL+3,AL
         4 000400   000022 772000                    QRL     18
         4 000401   000002 036007                    ADLQ    2,DL
         4 000402   200014 756100                    STQ     TEMPLEN,,AUTO

     1003      929    5                       CALL INSERT(TPHDRBUF,7,TEMPLEN,SUBSTR(MAXTPU_TBL.NAME(I),0,
               929                                MAXTPU_TBL.COUNT(I)),')=');

    929  4 000403   000003 220005 xsym               LDX0    MAXTPU_TBL+3,AL
         4 000404   200005 235100                    LDA     I,,AUTO
         4 000405   000004 735000                    ALS     4
         4 000406   000000 621006                    EAX1    0,QL
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:169  
         4 000407   040040 100445                    MLR     fill='040'O
         4 000410   000000 000010 xsym               ADSC9   MAXTPU_TBL,A             cn=0,n=*X0
         4 000411   000052 600011 2                  ADSC9   TPHDRBUF+1               cn=3,n=*X1
         4 000412   000000 636010                    EAQ     0,X0
         4 000413   000022 772000                    QRL     18
         4 000414   200016 756100                    STQ     TEMPLEN+2,,AUTO
         4 000415   200014 236100                    LDQ     TEMPLEN,,AUTO
         4 000416   200016 136100                    SBLQ    TEMPLEN+2,,AUTO
         4 000417   000426 604400 4                  TMOZ    s:930
         4 000420   000000 621006                    EAX1    0,QL
         4 000421   000000 636010                    EAQ     0,X0
         4 000422   000022 772000                    QRL     18
         4 000423   040046 100400                    MLR     fill='040'O
         4 000424   000013 000002 3                  ADSC9   DUMPBUF+2                cn=0,n=2
         4 000425   000052 600011 2                  ADSC9   TPHDRBUF+1,Q             cn=3,n=*X1

     1004      930    5                       TEMPLEN = TEMPLEN + 7;

    930  4 000426   000007 236007                    LDQ     7,DL
         4 000427   200014 056100                    ASQ     TEMPLEN,,AUTO

     1005      931    5                       IF (TPHDR_TBL.HDR.CNT(I) > 0)

    931  4 000430   200005 236100                    LDQ     I,,AUTO
         4 000431   000025 402007                    MPY     21,DL
         4 000432   000000 236006 xsym               LDQ     TPHDR_TBL,QL
         4 000433   777000 316003                    CANQ    -512,DU
         4 000434   000456 600000 4                  TZE     s:938

     1006      932    6                         THEN DO;

     1007      933    6                            LEN = MINIMUM(TPHDR_TBL.HDR.CNT(I),100);

    933  4 000435   200005 236100                    LDQ     I,,AUTO
         4 000436   000025 402007                    MPY     21,DL
         4 000437   000000 236006 xsym               LDQ     TPHDR_TBL,QL
         4 000440   000033 772000                    QRL     27
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:170  
         4 000441   000144 116007                    CMPQ    100,DL
         4 000442   000445 602000 4                  TNC     s:933+8
         4 000443   000445 600000 4                  TZE     s:933+8
         4 000444   000144 236007                    LDQ     100,DL
         4 000445   200013 756100                    STQ     LEN,,AUTO

     1008      934    6                            CALL INSERT(TPHDRBUF,TEMPLEN,LEN,

    934  4 000446   200005 236100                    LDQ     I,,AUTO
         4 000447   000124 402007                    MPY     84,DL
         4 000450   200013 720100                    LXL0    LEN,,AUTO
         4 000451   200014 235100                    LDA     TEMPLEN,,AUTO
         4 000452   040045 100446                    MLR     fill='040'O
         4 000453   000000 200010 xsym               ADSC9   TPHDR_TBL,Q              cn=1,n=*X0
         4 000454   000051 000010 2                  ADSC9   TPHDRBUF,A               cn=0,n=*X0

     1009      935    6                                        SUBSTR(TPHDR_TBL.HDR.MSG(I),0,LEN));
     1010      936    6                            END;

    936  4 000455   000464 710000 4                  TRA     s:941

     1011      937    6                          ELSE DO;

     1012      938    6                            CALL INSERT(TPHDRBUF,TEMPLEN,4,'NONE');

    938  4 000456   200014 235100                    LDA     TEMPLEN,,AUTO
         4 000457   040005 100400                    MLR     fill='040'O
         4 000460   000014 000004 3                  ADSC9   DUMPBUF+3                cn=0,n=4
         4 000461   000051 000004 2                  ADSC9   TPHDRBUF,A               cn=0,n=4

     1013      939    6                            LEN = 4;

    939  4 000462   000004 236007                    LDQ     4,DL
         4 000463   200013 756100                    STQ     LEN,,AUTO

     1014      940    6                            END;  /* IF PRESENT */

PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:171  
     1015      941    5                       TEMPLEN = TEMPLEN + LEN;

    941  4 000464   200014 236100                    LDQ     TEMPLEN,,AUTO
         4 000465   200013 036100                    ADLQ    LEN,,AUTO
         4 000466   200014 756100                    STQ     TEMPLEN,,AUTO

     1016      942    6                       IF TPBUF.COUNT + TEMPLEN > DCB_WIDTH THEN DO;

    942  4 000467   000112 236000 2                  LDQ     TPBUF
         4 000470   000033 772000                    QRL     27
         4 000471   200014 036100                    ADLQ    TEMPLEN,,AUTO
         4 000472   200010 116100                    CMPQ    DCB_WIDTH,,AUTO
         4 000473   000505 604400 4                  TMOZ    s:947

     1017      943    6                          CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));

    943  4 000474   000012 630400 5                  EPPR0   10
         4 000475   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000476   000000 701000 xent               TSX1    X$WRITE
         4 000477   000000 011000                    NOP     0

     1018      944    6                          TPBUF.COUNT = 0;

    944  4 000500   000000 236003                    LDQ     0,DU
         4 000501   000112 552040 2                  STBQ    TPBUF,'40'O

     1019      945    6                          TPBUF.TEXT = ' ';

    945  4 000502   040000 100400                    MLR     fill='040'O
         4 000503   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000504   000112 200204 2                  ADSC9   TPBUF                    cn=1,n=132

     1020      946    6                          END;  /* IF */

     1021      947    5                       CALL INSERT(TPBUF.TEXT,TPBUF.COUNT,TEMPLEN+1,SUBSTR(TPHDRBUF,0,
               947                                TEMPLEN),' ');

PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:172  
    947  4 000505   000112 236000 2                  LDQ     TPBUF
         4 000506   000033 772000                    QRL     27
         4 000507   200014 720100                    LXL0    TEMPLEN,,AUTO
         4 000510   000001 621010                    EAX1    1,X0
         4 000511   200014 722100                    LXL2    TEMPLEN,,AUTO
         4 000512   040046 100440                    MLR     fill='040'O
         4 000513   000051 000012 2                  ADSC9   TPHDRBUF                 cn=0,n=*X2
         4 000514   000112 200011 2                  ADSC9   TPBUF,Q                  cn=1,n=*X1
         4 000515   200016 756100                    STQ     TEMPLEN+2,,AUTO
         4 000516   200014 236100                    LDQ     TEMPLEN,,AUTO
         4 000517   200014 136100                    SBLQ    TEMPLEN,,AUTO
         4 000520   000027 116000 xsym               CMPQ    B_VECTNIL+23
         4 000521   000532 604400 4                  TMOZ    s:948
         4 000522   200017 756100                    STQ     TEMPLEN+3,,AUTO
         4 000523   200016 236100                    LDQ     TEMPLEN+2,,AUTO
         4 000524   200014 036100                    ADLQ    TEMPLEN,,AUTO
         4 000525   200017 723100                    LXL3    TEMPLEN+3,,AUTO
         4 000526   000001 624013                    EAX4    1,X3
         4 000527   040046 100400                    MLR     fill='040'O
         4 000530   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000531   000112 200014 2                  ADSC9   TPBUF,Q                  cn=1,n=*X4

     1022      948    5                       TPBUF.COUNT = TPBUF.COUNT + TEMPLEN + 1;

    948  4 000532   000112 236000 2                  LDQ     TPBUF
         4 000533   000033 772000                    QRL     27
         4 000534   200014 036100                    ADLQ    TEMPLEN,,AUTO
         4 000535   000001 036007                    ADLQ    1,DL
         4 000536   000033 736000                    QLS     27
         4 000537   000112 552040 2                  STBQ    TPBUF,'40'O

     1023      949    5                       END;  /* IF PRINT */

     1024      950    4                    END;  /* DO I */

    950  4 000540   200005 054100                    AOS     I,,AUTO
         4 000541   200005 236100                    LDQ     I,,AUTO
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:173  
         4 000542   000000 116000 xsym               CMPQ    TBLINSTANCES
         4 000543   000365 604000 4                  TMI     s:927

     1025      951    3                 CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));

    951  4 000544   000012 630400 5                  EPPR0   10
         4 000545   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000546   000000 701000 xent               TSX1    X$WRITE
         4 000547   000000 011000                    NOP     0

     1026      952    3                 END;  /* IF */

    952  4 000550   001643 710000 4                  TRA     s:1111

     1027      953    2           CASE(%PC_DITPI,%PC_PCTALL);

     1028      954    3              IF CURINSTANCES > 0 THEN DO;

    954  4 000551   000000 236000 xsym               LDQ     CURINSTANCES
         4 000552   000670 604400 4                  TMOZ    s:971

     1029      955    3                 CALL X$WRITE(FDS,VECTOR(TPIHDR));

    955  4 000553   000004 630400 5                  EPPR0   4
         4 000554   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000555   000000 701000 xent               TSX1    X$WRITE
         4 000556   000000 011000                    NOP     0

     1030      956    4                 DO I = 0 TO TBLINSTANCES - 1;

    956  4 000557   200005 450100                    STZ     I,,AUTO
         4 000560   000660 710000 4                  TRA     s:967+1

     1031      957    5                    IF NOT MAXTPU_TBL.FLAGS.DELETED(I) THEN DO;

    957  4 000561   200005 235100                    LDA     I,,AUTO
         4 000562   000002 735000                    ALS     2
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:174  
         4 000563   000003 236005 xsym               LDQ     MAXTPU_TBL+3,AL
         4 000564   200000 316007                    CANQ    65536,DL
         4 000565   000657 601000 4                  TNZ     s:967

     1032      958    6                       IF TPBUF.COUNT + MAXTPU_TBL.COUNT(I) > DCB_WIDTH THEN DO;

    958  4 000566   000003 236005 xsym               LDQ     MAXTPU_TBL+3,AL
         4 000567   000022 772000                    QRL     18
         4 000570   200016 756100                    STQ     TEMPLEN+2,,AUTO
         4 000571   000112 236000 2                  LDQ     TPBUF
         4 000572   000033 772000                    QRL     27
         4 000573   200016 036100                    ADLQ    TEMPLEN+2,,AUTO
         4 000574   000577 604000 4                  TMI     s:959
         4 000575   200010 116100                    CMPQ    DCB_WIDTH,,AUTO
         4 000576   000610 604400 4                  TMOZ    s:963

     1033      959    6                          CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));

    959  4 000577   000012 630400 5                  EPPR0   10
         4 000600   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000601   000000 701000 xent               TSX1    X$WRITE
         4 000602   000000 011000                    NOP     0

     1034      960    6                          TPBUF.TEXT = ' ';

    960  4 000603   040000 100400                    MLR     fill='040'O
         4 000604   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000605   000112 200204 2                  ADSC9   TPBUF                    cn=1,n=132

     1035      961    6                          TPBUF.COUNT = 0;

    961  4 000606   000000 236003                    LDQ     0,DU
         4 000607   000112 552040 2                  STBQ    TPBUF,'40'O

     1036      962    6                          END;  /* IF */

     1037      963    5                       CALL INSERT(TPBUF.TEXT,TPBUF.COUNT,MAXTPU_TBL.COUNT(I)+1,
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:175  

    963  4 000610   200005 235100                    LDA     I,,AUTO
         4 000611   000002 735000                    ALS     2
         4 000612   000003 220005 xsym               LDX0    MAXTPU_TBL+3,AL
         4 000613   000112 236000 2                  LDQ     TPBUF
         4 000614   000033 772000                    QRL     27
         4 000615   000003 221005 xsym               LDX1    MAXTPU_TBL+3,AL
         4 000616   000001 622011                    EAX2    1,X1
         4 000617   200005 235100                    LDA     I,,AUTO
         4 000620   000004 735000                    ALS     4
         4 000621   040046 100445                    MLR     fill='040'O
         4 000622   000000 000010 xsym               ADSC9   MAXTPU_TBL,A             cn=0,n=*X0
         4 000623   000112 200012 2                  ADSC9   TPBUF,Q                  cn=1,n=*X2
         4 000624   000000 635010                    EAA     0,X0
         4 000625   000022 771000                    ARL     18
         4 000626   200016 755100                    STA     TEMPLEN+2,,AUTO
         4 000627   200017 756100                    STQ     TEMPLEN+3,,AUTO
         4 000630   000000 636012                    EAQ     0,X2
         4 000631   000022 772000                    QRL     18
         4 000632   200016 136100                    SBLQ    TEMPLEN+2,,AUTO
         4 000633   000644 604400 4                  TMOZ    s:965
         4 000634   200020 756100                    STQ     TEMPLEN+4,,AUTO
         4 000635   000000 636010                    EAQ     0,X0
         4 000636   000022 772000                    QRL     18
         4 000637   200017 036100                    ADLQ    TEMPLEN+3,,AUTO
         4 000640   200020 720100                    LXL0    TEMPLEN+4,,AUTO
         4 000641   040046 100400                    MLR     fill='040'O
         4 000642   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000643   000112 200010 2                  ADSC9   TPBUF,Q                  cn=1,n=*X0

     1038      964    5                       SUBSTR(MAXTPU_TBL.NAME(I),0,MAXTPU_TBL.COUNT(I)),' ');
     1039      965    5                       TPBUF.COUNT = TPBUF.COUNT + MAXTPU_TBL.COUNT(I) + 1;

    965  4 000644   200005 235100                    LDA     I,,AUTO
         4 000645   000002 735000                    ALS     2
         4 000646   000003 236005 xsym               LDQ     MAXTPU_TBL+3,AL
         4 000647   000022 772000                    QRL     18
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:176  
         4 000650   200016 756100                    STQ     TEMPLEN+2,,AUTO
         4 000651   000112 236000 2                  LDQ     TPBUF
         4 000652   000033 772000                    QRL     27
         4 000653   200016 036100                    ADLQ    TEMPLEN+2,,AUTO
         4 000654   000001 036007                    ADLQ    1,DL
         4 000655   000033 736000                    QLS     27
         4 000656   000112 552040 2                  STBQ    TPBUF,'40'O

     1040      966    5                       END;  /* IF NOT DELETED */

     1041      967    4                    END;  /* DO I */

    967  4 000657   200005 054100                    AOS     I,,AUTO
         4 000660   200005 236100                    LDQ     I,,AUTO
         4 000661   000000 116000 xsym               CMPQ    TBLINSTANCES
         4 000662   000561 604000 4                  TMI     s:957

     1042      968    3                 CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));

    968  4 000663   000012 630400 5                  EPPR0   10
         4 000664   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000665   000000 701000 xent               TSX1    X$WRITE
         4 000666   000000 011000                    NOP     0

     1043      969    3                 END;  /* IF CURINSTANCES > 0 */

    969  4 000667   000675 710000 4                  TRA     s:974

     1044      970    3              ELSE DO;

     1045      971    3                 CALL PCE$ERROR(%E$P_NOTPI,0);

    971  4 000670   000016 630400 5                  EPPR0   14
         4 000671   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000672   000000 701000 xent               TSX1    PCE$ERROR
         4 000673   000000 011000                    NOP     0

PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:177  
     1046      972    3                 RETURN;

    972  4 000674   000000 702200 xent               TSX2  ! X66_ARET

     1047      973    3                 END;  /* ELSE */
     1048      974    2              IF CODE = %PC_PCTALL THEN GOTO DISP_MAXTPU;

    974  4 000675   200003 470500                    LDP0    @CODE,,AUTO
         4 000676   000000 235100                    LDA     0,,PR0
         4 000677   000001 115007                    CMPA    1,DL
         4 000700   000702 600000 4                  TZE     DISP_MAXTPU
         4 000701   001643 710000 4                  TRA     s:1111

     1049      975    2           CASE(%PC_DIMAXTPU);

     1050      976    2   DISP_MAXTPU:
     1051      977    2              TPBUF.COUNT = 0;

    977  4 000702   000000 236003       DISP_MAXTPU  LDQ     0,DU
         4 000703   000112 552040 2                  STBQ    TPBUF,'40'O

     1052      978    2              TPBUF.TEXT = ' ';

    978  4 000704   040000 100400                    MLR     fill='040'O
         4 000705   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000706   000112 200204 2                  ADSC9   TPBUF                    cn=1,n=132

     1053      979    3              IF ADDR(NAME) = ADDR(NIL) THEN DO;

    979  4 000707   200004 236100                    LDQ     @NAME,,AUTO
         4 000710   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000711   001104 601000 4                  TNZ     s:1013

     1054      980    3                 IF CURINSTANCES = 0

    980  4 000712   000000 235000 xsym               LDA     CURINSTANCES
         4 000713   000721 601000 4                  TNZ     s:983
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:178  

     1055      981    3                    THEN CALL PCE$ERROR(%E$P_NOTPI,0);

    981  4 000714   000016 630400 5                  EPPR0   14
         4 000715   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000716   000000 701000 xent               TSX1    PCE$ERROR
         4 000717   000000 011000                    NOP     0
         4 000720   001262 710000 4                  TRA     s:1043

     1056      982    4                 ELSE DO;

     1057      983    5                    DO I = 0 TO TBLINSTANCES - 1;

    983  4 000721   200005 450100                    STZ     I,,AUTO
         4 000722   001074 710000 4                  TRA     s:1008+1

     1058      984    6                       IF NOT MAXTPU_TBL.FLAGS.DELETED(I) THEN DO;

    984  4 000723   200005 235100                    LDA     I,,AUTO
         4 000724   000002 735000                    ALS     2
         4 000725   000003 236005 xsym               LDQ     MAXTPU_TBL+3,AL
         4 000726   200000 316007                    CANQ    65536,DL
         4 000727   001073 601000 4                  TNZ     s:1008

     1059      985    6                          TEMPLEN = MAXTPU_TBL.COUNT(I) + 2;

    985  4 000730   000003 236005 xsym               LDQ     MAXTPU_TBL+3,AL
         4 000731   000022 772000                    QRL     18
         4 000732   000002 036007                    ADLQ    2,DL
         4 000733   200014 756100                    STQ     TEMPLEN,,AUTO

     1060      986    6                          CALL INSERT(MAXTPUBUF,7,TEMPLEN,SUBSTR(MAXTPU_TBL.NAME(I),0,
               986                                   MAXTPU_TBL.COUNT(I)),')=');

    986  4 000734   000003 220005 xsym               LDX0    MAXTPU_TBL+3,AL
         4 000735   200005 235100                    LDA     I,,AUTO
         4 000736   000004 735000                    ALS     4
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:179  
         4 000737   000000 621006                    EAX1    0,QL
         4 000740   040040 100445                    MLR     fill='040'O
         4 000741   000000 000010 xsym               ADSC9   MAXTPU_TBL,A             cn=0,n=*X0
         4 000742   000042 600011 2                  ADSC9   MAXTPUBUF+1              cn=3,n=*X1
         4 000743   000000 636010                    EAQ     0,X0
         4 000744   000022 772000                    QRL     18
         4 000745   200016 756100                    STQ     TEMPLEN+2,,AUTO
         4 000746   200014 236100                    LDQ     TEMPLEN,,AUTO
         4 000747   200016 136100                    SBLQ    TEMPLEN+2,,AUTO
         4 000750   000757 604400 4                  TMOZ    s:987
         4 000751   000000 621006                    EAX1    0,QL
         4 000752   000000 636010                    EAQ     0,X0
         4 000753   000022 772000                    QRL     18
         4 000754   040046 100400                    MLR     fill='040'O
         4 000755   000013 000002 3                  ADSC9   DUMPBUF+2                cn=0,n=2
         4 000756   000042 600011 2                  ADSC9   MAXTPUBUF+1,Q            cn=3,n=*X1

     1061      987    6                          TEMPLEN = TEMPLEN + 7;

    987  4 000757   000007 236007                    LDQ     7,DL
         4 000760   200014 056100                    ASQ     TEMPLEN,,AUTO

     1062      988    6                          CALL BINCHAR(TEMP,MAXTPU_TBL.MAXTPU(I));

    988  4 000761   200005 235100                    LDA     I,,AUTO
         4 000762   000002 735000                    ALS     2
         4 000763   000002 235005 xsym               LDA     MAXTPU_TBL+2,AL
         4 000764   000044 773000                    LRL     36
         4 000765   200016 757100                    STAQ    TEMPLEN+2,,AUTO
         4 000766   000100 301500                    BTD
         4 000767   200016 000010                    NDSC9   TEMPLEN+2,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         4 000770   200011 030010                    NDSC9   TEMP,,AUTO               cn=0,s=nosgn,sf=0,n=8

     1063      989    6                          K = 0;

    989  4 000771   200007 450100                    STZ     K,,AUTO

PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:180  
     1064      990    7                          DO WHILE(SUBSTR(TEMP,K,1) = '0' AND K < 8);

    990  4 000772   000774 710000 4                  TRA     s:992

     1065      991    7                             K = K + 1;

    991  4 000773   200007 054100                    AOS     K,,AUTO

     1066      992    7                             END;  /* DO WHILE */

    992  4 000774   200007 235100                    LDA     K,,AUTO
         4 000775   040000 106505                    CMPC    fill='040'O
         4 000776   200011 000001                    ADSC9   TEMP,A,AUTO              cn=0,n=1
         4 000777   000020 000001 5                  ADSC9   16                       cn=0,n=1
         4 001000   001003 601000 4                  TNZ     s:993
         4 001001   000010 115007                    CMPA    8,DL
         4 001002   000773 604000 4                  TMI     s:991

     1067      993    6                          LEN = 8 - K;

    993  4 001003   000027 675000 xsym               ERA     B_VECTNIL+23
         4 001004   000011 035007                    ADLA    9,DL
         4 001005   200013 755100                    STA     LEN,,AUTO

     1068      994    7                          IF LEN = 0 THEN DO;

    994  4 001006   001012 601000 4                  TNZ     s:998

     1069      995    7                             LEN = 1;

    995  4 001007   000001 236007                    LDQ     1,DL
         4 001010   200013 756100                    STQ     LEN,,AUTO

     1070      996    7                             K = 0;

    996  4 001011   200007 450100                    STZ     K,,AUTO

PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:181  
     1071      997    7                             END;  /* IF */

     1072      998    6                          CALL INSERT(MAXTPUBUF,TEMPLEN,LEN,SUBSTR(TEMP,K,LEN));

    998  4 001012   200013 720100                    LXL0    LEN,,AUTO
         4 001013   200007 235100                    LDA     K,,AUTO
         4 001014   200014 236100                    LDQ     TEMPLEN,,AUTO
         4 001015   040046 100545                    MLR     fill='040'O
         4 001016   200011 000010                    ADSC9   TEMP,A,AUTO              cn=0,n=*X0
         4 001017   000041 000010 2                  ADSC9   MAXTPUBUF,Q              cn=0,n=*X0

     1073      999    6                          TEMPLEN = TEMPLEN + LEN;

    999  4 001020   200013 036100                    ADLQ    LEN,,AUTO
         4 001021   200014 756100                    STQ     TEMPLEN,,AUTO

     1074     1000    7                          IF TPBUF.COUNT + TEMPLEN > DCB_WIDTH THEN DO;

   1000  4 001022   000112 236000 2                  LDQ     TPBUF
         4 001023   000033 772000                    QRL     27
         4 001024   200014 036100                    ADLQ    TEMPLEN,,AUTO
         4 001025   200010 116100                    CMPQ    DCB_WIDTH,,AUTO
         4 001026   001040 604400 4                  TMOZ    s:1005

     1075     1001    7                             CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));

   1001  4 001027   000012 630400 5                  EPPR0   10
         4 001030   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001031   000000 701000 xent               TSX1    X$WRITE
         4 001032   000000 011000                    NOP     0

     1076     1002    7                             TPBUF.COUNT = 0;

   1002  4 001033   000000 236003                    LDQ     0,DU
         4 001034   000112 552040 2                  STBQ    TPBUF,'40'O

     1077     1003    7                             TPBUF.TEXT = ' ';
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:182  

   1003  4 001035   040000 100400                    MLR     fill='040'O
         4 001036   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001037   000112 200204 2                  ADSC9   TPBUF                    cn=1,n=132

     1078     1004    7                             END;  /* IF */

     1079     1005    6                         CALL INSERT(TPBUF.TEXT,TPBUF.COUNT,TEMPLEN+1,SUBSTR(MAXTPUBUF
              1005                                   ,0,TEMPLEN),' ');

   1005  4 001040   000112 236000 2                  LDQ     TPBUF
         4 001041   000033 772000                    QRL     27
         4 001042   200014 720100                    LXL0    TEMPLEN,,AUTO
         4 001043   000001 621010                    EAX1    1,X0
         4 001044   200014 722100                    LXL2    TEMPLEN,,AUTO
         4 001045   040046 100440                    MLR     fill='040'O
         4 001046   000041 000012 2                  ADSC9   MAXTPUBUF                cn=0,n=*X2
         4 001047   000112 200011 2                  ADSC9   TPBUF,Q                  cn=1,n=*X1
         4 001050   200016 756100                    STQ     TEMPLEN+2,,AUTO
         4 001051   200014 236100                    LDQ     TEMPLEN,,AUTO
         4 001052   200014 136100                    SBLQ    TEMPLEN,,AUTO
         4 001053   000027 116000 xsym               CMPQ    B_VECTNIL+23
         4 001054   001065 604400 4                  TMOZ    s:1006
         4 001055   200017 756100                    STQ     TEMPLEN+3,,AUTO
         4 001056   200016 236100                    LDQ     TEMPLEN+2,,AUTO
         4 001057   200014 036100                    ADLQ    TEMPLEN,,AUTO
         4 001060   200017 723100                    LXL3    TEMPLEN+3,,AUTO
         4 001061   000001 624013                    EAX4    1,X3
         4 001062   040046 100400                    MLR     fill='040'O
         4 001063   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001064   000112 200014 2                  ADSC9   TPBUF,Q                  cn=1,n=*X4

     1080     1006    6                          TPBUF.COUNT = TPBUF.COUNT + TEMPLEN + 1;

   1006  4 001065   000112 236000 2                  LDQ     TPBUF
         4 001066   000033 772000                    QRL     27
         4 001067   200014 036100                    ADLQ    TEMPLEN,,AUTO
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:183  
         4 001070   000001 036007                    ADLQ    1,DL
         4 001071   000033 736000                    QLS     27
         4 001072   000112 552040 2                  STBQ    TPBUF,'40'O

     1081     1007    6                          END;  /* IF NOT DELETED */

     1082     1008    5                       END;  /* DO I */

   1008  4 001073   200005 054100                    AOS     I,,AUTO
         4 001074   200005 236100                    LDQ     I,,AUTO
         4 001075   000000 116000 xsym               CMPQ    TBLINSTANCES
         4 001076   000723 604000 4                  TMI     s:984

     1083     1009    4                    CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));

   1009  4 001077   000012 630400 5                  EPPR0   10
         4 001100   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001101   000000 701000 xent               TSX1    X$WRITE
         4 001102   000000 011000                    NOP     0

     1084     1010    4                    END;  /* ELSE */

     1085     1011    3                 END;  /* IF ADDR(NAME) = ADDR(NIL) */

   1011  4 001103   001262 710000 4                  TRA     s:1043

     1086     1012    3              ELSE DO;  /* NAME SPECIFIED */

     1087     1013    4                 DO I = 0 TO TBLINSTANCES - 1;

   1013  4 001104   200005 450100                    STZ     I,,AUTO
         4 001105   001123 710000 4                  TRA     s:1016+1

     1088     1014    4                    IF NAME = MAXTPU_TBL.NAME(I) AND NOT MAXTPU_TBL.FLAGS.DELETED(I)

   1014  4 001106   200005 235100                    LDA     I,,AUTO
         4 001107   000004 735000                    ALS     4
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:184  
         4 001110   200004 470500                    LDP0    @NAME,,AUTO
         4 001111   040005 106500                    CMPC    fill='040'O
         4 001112   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         4 001113   000000 000010 xsym               ADSC9   MAXTPU_TBL,A             cn=0,n=8
         4 001114   001122 601000 4                  TNZ     s:1016
         4 001115   200005 236100                    LDQ     I,,AUTO
         4 001116   000002 736000                    QLS     2
         4 001117   000003 236006 xsym               LDQ     MAXTPU_TBL+3,QL
         4 001120   200000 316007                    CANQ    65536,DL
         4 001121   001154 600000 4                  TZE     FOUND_IT

     1089     1015    4                       THEN GOTO FOUND_IT;
     1090     1016    4                    END;  /* DO I */

   1016  4 001122   200005 054100                    AOS     I,,AUTO
         4 001123   200005 236100                    LDQ     I,,AUTO
         4 001124   000000 116000 xsym               CMPQ    TBLINSTANCES
         4 001125   001106 604000 4                  TMI     s:1014

     1091     1017    3                 K = 0;

   1017  4 001126   200007 450100                    STZ     K,,AUTO

     1092     1018    4                 DO WHILE(SUBSTR(NAME,K,1) ~= ' ' AND K < 8);

   1018  4 001127   001131 710000 4                  TRA     s:1020

     1093     1019    4                    K = K + 1;

   1019  4 001130   200007 054100                    AOS     K,,AUTO

     1094     1020    4                    END;  /* DO WHILE */

   1020  4 001131   200004 470500                    LDP0    @NAME,,AUTO
         4 001132   200007 235100                    LDA     K,,AUTO
         4 001133   040000 106505                    CMPC    fill='040'O
         4 001134   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:185  
         4 001135   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001136   001141 600000 4                  TZE     s:1021
         4 001137   000010 115007                    CMPA    8,DL
         4 001140   001130 604000 4                  TMI     s:1019

     1095     1021    3                 SUB_BUF_1.COUNT = K;

   1021  4 001141   200007 236100                    LDQ     K,,AUTO
         4 001142   000033 736000                    QLS     27
         4 001143   000000 552040 xsym               STBQ    SUB_BUF_1,'40'O

     1096     1022    3                 SUB_BUF_1.TEXT = NAME;

   1022  4 001144   040000 100500                    MLR     fill='040'O
         4 001145   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         4 001146   000000 200037 xsym               ADSC9   SUB_BUF_1                cn=1,n=31

     1097     1023    3                 CALL PCE$ERROR(%E$P_BAD_INSTANCE_NAME,3);

   1023  4 001147   000022 630400 5                  EPPR0   18
         4 001150   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001151   000000 701000 xent               TSX1    PCE$ERROR
         4 001152   000000 011000                    NOP     0

     1098     1024    3                 RETURN;

   1024  4 001153   000000 702200 xent               TSX2  ! X66_ARET

     1099     1025    3   FOUND_IT:     TEMPLEN = MAXTPU_TBL.COUNT(I) + 2;

   1025  4 001154   200005 236100       FOUND_IT     LDQ     I,,AUTO
         4 001155   000002 736000                    QLS     2
         4 001156   000003 236006 xsym               LDQ     MAXTPU_TBL+3,QL
         4 001157   000022 772000                    QRL     18
         4 001160   000002 036007                    ADLQ    2,DL
         4 001161   200014 756100                    STQ     TEMPLEN,,AUTO

PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:186  
     1100     1026    3                CALL INSERT(MAXTPUBUF,7,TEMPLEN,SUBSTR(MAXTPU_TBL.NAME(I),0,MAXTPU_TBL
              1026                          .COUNT(I)),')=');

   1026  4 001162   200005 235100                    LDA     I,,AUTO
         4 001163   000002 735000                    ALS     2
         4 001164   000003 220005 xsym               LDX0    MAXTPU_TBL+3,AL
         4 001165   200005 235100                    LDA     I,,AUTO
         4 001166   000004 735000                    ALS     4
         4 001167   000000 621006                    EAX1    0,QL
         4 001170   040040 100445                    MLR     fill='040'O
         4 001171   000000 000010 xsym               ADSC9   MAXTPU_TBL,A             cn=0,n=*X0
         4 001172   000042 600011 2                  ADSC9   MAXTPUBUF+1              cn=3,n=*X1
         4 001173   000000 636010                    EAQ     0,X0
         4 001174   000022 772000                    QRL     18
         4 001175   200016 756100                    STQ     TEMPLEN+2,,AUTO
         4 001176   200014 236100                    LDQ     TEMPLEN,,AUTO
         4 001177   200016 136100                    SBLQ    TEMPLEN+2,,AUTO
         4 001200   001207 604400 4                  TMOZ    s:1027
         4 001201   000000 621006                    EAX1    0,QL
         4 001202   000000 636010                    EAQ     0,X0
         4 001203   000022 772000                    QRL     18
         4 001204   040046 100400                    MLR     fill='040'O
         4 001205   000013 000002 3                  ADSC9   DUMPBUF+2                cn=0,n=2
         4 001206   000042 600011 2                  ADSC9   MAXTPUBUF+1,Q            cn=3,n=*X1

     1101     1027    3                 TEMPLEN = TEMPLEN + 7;

   1027  4 001207   000007 236007                    LDQ     7,DL
         4 001210   200014 056100                    ASQ     TEMPLEN,,AUTO

     1102     1028    3                 CALL BINCHAR(TEMP,MAXTPU_TBL.MAXTPU(I));

   1028  4 001211   200005 235100                    LDA     I,,AUTO
         4 001212   000002 735000                    ALS     2
         4 001213   000002 235005 xsym               LDA     MAXTPU_TBL+2,AL
         4 001214   000044 773000                    LRL     36
         4 001215   200016 757100                    STAQ    TEMPLEN+2,,AUTO
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:187  
         4 001216   000100 301500                    BTD
         4 001217   200016 000010                    NDSC9   TEMPLEN+2,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         4 001220   200011 030010                    NDSC9   TEMP,,AUTO               cn=0,s=nosgn,sf=0,n=8

     1103     1029    3                 K = 0;

   1029  4 001221   200007 450100                    STZ     K,,AUTO

     1104     1030    4                 DO WHILE(SUBSTR(TEMP,K,1) = '0' AND K < 8);

   1030  4 001222   001224 710000 4                  TRA     s:1032

     1105     1031    4                    K = K + 1;

   1031  4 001223   200007 054100                    AOS     K,,AUTO

     1106     1032    4                    END;  /* DO WHILE */

   1032  4 001224   200007 235100                    LDA     K,,AUTO
         4 001225   040000 106505                    CMPC    fill='040'O
         4 001226   200011 000001                    ADSC9   TEMP,A,AUTO              cn=0,n=1
         4 001227   000020 000001 5                  ADSC9   16                       cn=0,n=1
         4 001230   001233 601000 4                  TNZ     s:1033
         4 001231   000010 115007                    CMPA    8,DL
         4 001232   001223 604000 4                  TMI     s:1031

     1107     1033    3                 LEN = 8 - K;

   1033  4 001233   000027 675000 xsym               ERA     B_VECTNIL+23
         4 001234   000011 035007                    ADLA    9,DL
         4 001235   200013 755100                    STA     LEN,,AUTO

     1108     1034    4                 IF LEN = 0 THEN DO;

   1034  4 001236   001242 601000 4                  TNZ     s:1038

     1109     1035    4                    LEN = 1;
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:188  

   1035  4 001237   000001 236007                    LDQ     1,DL
         4 001240   200013 756100                    STQ     LEN,,AUTO

     1110     1036    4                    K = 0;

   1036  4 001241   200007 450100                    STZ     K,,AUTO

     1111     1037    4                    END;  /* IF */

     1112     1038    3                 CALL INSERT(MAXTPUBUF,TEMPLEN,LEN,SUBSTR(TEMP,K,LEN));

   1038  4 001242   200013 720100                    LXL0    LEN,,AUTO
         4 001243   200007 235100                    LDA     K,,AUTO
         4 001244   200014 236100                    LDQ     TEMPLEN,,AUTO
         4 001245   040046 100545                    MLR     fill='040'O
         4 001246   200011 000010                    ADSC9   TEMP,A,AUTO              cn=0,n=*X0
         4 001247   000041 000010 2                  ADSC9   MAXTPUBUF,Q              cn=0,n=*X0

     1113     1039    3                 TPBUF.TEXT = MAXTPUBUF;

   1039  4 001250   040000 100400                    MLR     fill='040'O
         4 001251   000041 000040 2                  ADSC9   MAXTPUBUF                cn=0,n=32
         4 001252   000112 200204 2                  ADSC9   TPBUF                    cn=1,n=132

     1114     1040    3                 TPBUF.COUNT = TEMPLEN + LEN;

   1040  4 001253   200013 036100                    ADLQ    LEN,,AUTO
         4 001254   000033 736000                    QLS     27
         4 001255   000112 552040 2                  STBQ    TPBUF,'40'O

     1115     1041    3                 CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));

   1041  4 001256   000012 630400 5                  EPPR0   10
         4 001257   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001260   000000 701000 xent               TSX1    X$WRITE
         4 001261   000000 011000                    NOP     0
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:189  

     1116     1042    3                 END;  /* ELSE NAME SPECIFIED */

     1117     1043    2              IF CODE = %PC_PCTALL THEN GOTO DISP_TPHDR;

   1043  4 001262   200003 470500                    LDP0    @CODE,,AUTO
         4 001263   000000 235100                    LDA     0,,PR0
         4 001264   000001 115007                    CMPA    1,DL
         4 001265   001267 600000 4                  TZE     DISP_TPHDR
         4 001266   001643 710000 4                  TRA     s:1111

     1118     1044    2           CASE(%PC_DITPHDR);

     1119     1045    2   DISP_TPHDR:
     1120     1046    2              TPBUF.COUNT = 0;

   1046  4 001267   000000 236003       DISP_TPHDR   LDQ     0,DU
         4 001270   000112 552040 2                  STBQ    TPBUF,'40'O

     1121     1047    2              TPBUF.TEXT = ' ';

   1047  4 001271   040000 100400                    MLR     fill='040'O
         4 001272   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001273   000112 200204 2                  ADSC9   TPBUF                    cn=1,n=132

     1122     1048    3              IF ADDR(NAME) = ADDR(NIL) THEN DO;

   1048  4 001274   200004 236100                    LDQ     @NAME,,AUTO
         4 001275   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 001276   001467 601000 4                  TNZ     s:1081

     1123     1049    3                 IF CURINSTANCES = 0

   1049  4 001277   000000 235000 xsym               LDA     CURINSTANCES
         4 001300   001306 601000 4                  TNZ     s:1052

     1124     1050    3                    THEN CALL PCE$ERROR(%E$P_NOTPI,0);
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:190  

   1050  4 001301   000016 630400 5                  EPPR0   14
         4 001302   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001303   000000 701000 xent               TSX1    PCE$ERROR
         4 001304   000000 011000                    NOP     0
         4 001305   001643 710000 4                  TRA     s:1111

     1125     1051    4                 ELSE DO;

     1126     1052    5                    DO I = 0 TO TBLINSTANCES - 1;

   1052  4 001306   200005 450100                    STZ     I,,AUTO
         4 001307   001457 710000 4                  TRA     s:1076+1

     1127     1053    6                       IF NOT MAXTPU_TBL.FLAGS.DELETED(I) THEN DO;

   1053  4 001310   200005 235100                    LDA     I,,AUTO
         4 001311   000002 735000                    ALS     2
         4 001312   000003 236005 xsym               LDQ     MAXTPU_TBL+3,AL
         4 001313   200000 316007                    CANQ    65536,DL
         4 001314   001456 601000 4                  TNZ     s:1076

     1128     1054    6                          TEMPLEN = MAXTPU_TBL.COUNT(I) + 2;

   1054  4 001315   000003 236005 xsym               LDQ     MAXTPU_TBL+3,AL
         4 001316   000022 772000                    QRL     18
         4 001317   000002 036007                    ADLQ    2,DL
         4 001320   200014 756100                    STQ     TEMPLEN,,AUTO

     1129     1055    6                          CALL INSERT(TPHDRBUF,7,TEMPLEN,SUBSTR(MAXTPU_TBL.NAME(I),0,
              1055                                   MAXTPU_TBL.COUNT(I)),')=');

   1055  4 001321   000003 220005 xsym               LDX0    MAXTPU_TBL+3,AL
         4 001322   200005 235100                    LDA     I,,AUTO
         4 001323   000004 735000                    ALS     4
         4 001324   000000 621006                    EAX1    0,QL
         4 001325   040040 100445                    MLR     fill='040'O
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:191  
         4 001326   000000 000010 xsym               ADSC9   MAXTPU_TBL,A             cn=0,n=*X0
         4 001327   000052 600011 2                  ADSC9   TPHDRBUF+1               cn=3,n=*X1
         4 001330   000000 636010                    EAQ     0,X0
         4 001331   000022 772000                    QRL     18
         4 001332   200016 756100                    STQ     TEMPLEN+2,,AUTO
         4 001333   200014 236100                    LDQ     TEMPLEN,,AUTO
         4 001334   200016 136100                    SBLQ    TEMPLEN+2,,AUTO
         4 001335   001344 604400 4                  TMOZ    s:1056
         4 001336   000000 621006                    EAX1    0,QL
         4 001337   000000 636010                    EAQ     0,X0
         4 001340   000022 772000                    QRL     18
         4 001341   040046 100400                    MLR     fill='040'O
         4 001342   000013 000002 3                  ADSC9   DUMPBUF+2                cn=0,n=2
         4 001343   000052 600011 2                  ADSC9   TPHDRBUF+1,Q             cn=3,n=*X1

     1130     1056    6                          TEMPLEN = TEMPLEN + 7;

   1056  4 001344   000007 236007                    LDQ     7,DL
         4 001345   200014 056100                    ASQ     TEMPLEN,,AUTO

     1131     1057    6                          IF (TPHDR_TBL.HDR.CNT(I) > 0)

   1057  4 001346   200005 236100                    LDQ     I,,AUTO
         4 001347   000025 402007                    MPY     21,DL
         4 001350   000000 236006 xsym               LDQ     TPHDR_TBL,QL
         4 001351   777000 316003                    CANQ    -512,DU
         4 001352   001374 600000 4                  TZE     s:1064

     1132     1058    7                            THEN DO;

     1133     1059    7                               LEN = MINIMUM(TPHDR_TBL.HDR.CNT(I),100);

   1059  4 001353   200005 236100                    LDQ     I,,AUTO
         4 001354   000025 402007                    MPY     21,DL
         4 001355   000000 236006 xsym               LDQ     TPHDR_TBL,QL
         4 001356   000033 772000                    QRL     27
         4 001357   000144 116007                    CMPQ    100,DL
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:192  
         4 001360   001363 602000 4                  TNC     s:1059+8
         4 001361   001363 600000 4                  TZE     s:1059+8
         4 001362   000144 236007                    LDQ     100,DL
         4 001363   200013 756100                    STQ     LEN,,AUTO

     1134     1060    7                               CALL INSERT(TPHDRBUF,TEMPLEN,LEN,

   1060  4 001364   200005 236100                    LDQ     I,,AUTO
         4 001365   000124 402007                    MPY     84,DL
         4 001366   200013 720100                    LXL0    LEN,,AUTO
         4 001367   200014 235100                    LDA     TEMPLEN,,AUTO
         4 001370   040045 100446                    MLR     fill='040'O
         4 001371   000000 200010 xsym               ADSC9   TPHDR_TBL,Q              cn=1,n=*X0
         4 001372   000051 000010 2                  ADSC9   TPHDRBUF,A               cn=0,n=*X0

     1135     1061    7                                           SUBSTR(TPHDR_TBL.HDR.MSG(I),0,LEN));
     1136     1062    7                               END;

   1062  4 001373   001402 710000 4                  TRA     s:1067

     1137     1063    7                             ELSE DO;

     1138     1064    7                               CALL INSERT(TPHDRBUF,TEMPLEN,4,'NONE');

   1064  4 001374   200014 235100                    LDA     TEMPLEN,,AUTO
         4 001375   040005 100400                    MLR     fill='040'O
         4 001376   000014 000004 3                  ADSC9   DUMPBUF+3                cn=0,n=4
         4 001377   000051 000004 2                  ADSC9   TPHDRBUF,A               cn=0,n=4

     1139     1065    7                               LEN = 4;

   1065  4 001400   000004 236007                    LDQ     4,DL
         4 001401   200013 756100                    STQ     LEN,,AUTO

     1140     1066    7                               END;  /* IF PRESENT */

     1141     1067    6                          TEMPLEN = TEMPLEN + LEN;
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:193  

   1067  4 001402   200014 236100                    LDQ     TEMPLEN,,AUTO
         4 001403   200013 036100                    ADLQ    LEN,,AUTO
         4 001404   200014 756100                    STQ     TEMPLEN,,AUTO

     1142     1068    7                          IF TPBUF.COUNT + TEMPLEN > DCB_WIDTH THEN DO;

   1068  4 001405   000112 236000 2                  LDQ     TPBUF
         4 001406   000033 772000                    QRL     27
         4 001407   200014 036100                    ADLQ    TEMPLEN,,AUTO
         4 001410   200010 116100                    CMPQ    DCB_WIDTH,,AUTO
         4 001411   001423 604400 4                  TMOZ    s:1073

     1143     1069    7                             CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));

   1069  4 001412   000012 630400 5                  EPPR0   10
         4 001413   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001414   000000 701000 xent               TSX1    X$WRITE
         4 001415   000000 011000                    NOP     0

     1144     1070    7                             TPBUF.COUNT = 0;

   1070  4 001416   000000 236003                    LDQ     0,DU
         4 001417   000112 552040 2                  STBQ    TPBUF,'40'O

     1145     1071    7                             TPBUF.TEXT = ' ';

   1071  4 001420   040000 100400                    MLR     fill='040'O
         4 001421   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001422   000112 200204 2                  ADSC9   TPBUF                    cn=1,n=132

     1146     1072    7                             END;  /* IF */

     1147     1073    6                         CALL INSERT(TPBUF.TEXT,TPBUF.COUNT,TEMPLEN+1,SUBSTR(TPHDRBUF,
              1073                                   0,TEMPLEN),' ');

   1073  4 001423   000112 236000 2                  LDQ     TPBUF
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:194  
         4 001424   000033 772000                    QRL     27
         4 001425   200014 720100                    LXL0    TEMPLEN,,AUTO
         4 001426   000001 621010                    EAX1    1,X0
         4 001427   200014 722100                    LXL2    TEMPLEN,,AUTO
         4 001430   040046 100440                    MLR     fill='040'O
         4 001431   000051 000012 2                  ADSC9   TPHDRBUF                 cn=0,n=*X2
         4 001432   000112 200011 2                  ADSC9   TPBUF,Q                  cn=1,n=*X1
         4 001433   200016 756100                    STQ     TEMPLEN+2,,AUTO
         4 001434   200014 236100                    LDQ     TEMPLEN,,AUTO
         4 001435   200014 136100                    SBLQ    TEMPLEN,,AUTO
         4 001436   000027 116000 xsym               CMPQ    B_VECTNIL+23
         4 001437   001450 604400 4                  TMOZ    s:1074
         4 001440   200017 756100                    STQ     TEMPLEN+3,,AUTO
         4 001441   200016 236100                    LDQ     TEMPLEN+2,,AUTO
         4 001442   200014 036100                    ADLQ    TEMPLEN,,AUTO
         4 001443   200017 723100                    LXL3    TEMPLEN+3,,AUTO
         4 001444   000001 624013                    EAX4    1,X3
         4 001445   040046 100400                    MLR     fill='040'O
         4 001446   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001447   000112 200014 2                  ADSC9   TPBUF,Q                  cn=1,n=*X4

     1148     1074    6                          TPBUF.COUNT = TPBUF.COUNT + TEMPLEN + 1;

   1074  4 001450   000112 236000 2                  LDQ     TPBUF
         4 001451   000033 772000                    QRL     27
         4 001452   200014 036100                    ADLQ    TEMPLEN,,AUTO
         4 001453   000001 036007                    ADLQ    1,DL
         4 001454   000033 736000                    QLS     27
         4 001455   000112 552040 2                  STBQ    TPBUF,'40'O

     1149     1075    6                          END;  /* IF NOT DELETED */

     1150     1076    5                       END;  /* DO I */

   1076  4 001456   200005 054100                    AOS     I,,AUTO
         4 001457   200005 236100                    LDQ     I,,AUTO
         4 001460   000000 116000 xsym               CMPQ    TBLINSTANCES
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:195  
         4 001461   001310 604000 4                  TMI     s:1053

     1151     1077    4                    CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));

   1077  4 001462   000012 630400 5                  EPPR0   10
         4 001463   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001464   000000 701000 xent               TSX1    X$WRITE
         4 001465   000000 011000                    NOP     0

     1152     1078    4                    END;  /* ELSE */

     1153     1079    3                 END;  /* IF ADDR(NAME) = ADDR(NIL) */

   1079  4 001466   001643 710000 4                  TRA     s:1111

     1154     1080    3              ELSE DO;  /* NAME SPECIFIED */

     1155     1081    4                 DO I = 0 TO TBLINSTANCES - 1;

   1081  4 001467   200005 450100                    STZ     I,,AUTO
         4 001470   001506 710000 4                  TRA     s:1084+1

     1156     1082    4                    IF NAME = MAXTPU_TBL.NAME(I) AND NOT MAXTPU_TBL.FLAGS.DELETED(I)

   1082  4 001471   200005 235100                    LDA     I,,AUTO
         4 001472   000004 735000                    ALS     4
         4 001473   200004 470500                    LDP0    @NAME,,AUTO
         4 001474   040005 106500                    CMPC    fill='040'O
         4 001475   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         4 001476   000000 000010 xsym               ADSC9   MAXTPU_TBL,A             cn=0,n=8
         4 001477   001505 601000 4                  TNZ     s:1084
         4 001500   200005 236100                    LDQ     I,,AUTO
         4 001501   000002 736000                    QLS     2
         4 001502   000003 236006 xsym               LDQ     MAXTPU_TBL+3,QL
         4 001503   200000 316007                    CANQ    65536,DL
         4 001504   001537 600000 4                  TZE     FOUND_IT2

PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:196  
     1157     1083    4                       THEN GOTO FOUND_IT2;
     1158     1084    4                    END;  /* DO I */

   1084  4 001505   200005 054100                    AOS     I,,AUTO
         4 001506   200005 236100                    LDQ     I,,AUTO
         4 001507   000000 116000 xsym               CMPQ    TBLINSTANCES
         4 001510   001471 604000 4                  TMI     s:1082

     1159     1085    3                 K = 0;

   1085  4 001511   200007 450100                    STZ     K,,AUTO

     1160     1086    4                 DO WHILE(SUBSTR(NAME,K,1) ~= ' ' AND K < 8);

   1086  4 001512   001514 710000 4                  TRA     s:1088

     1161     1087    4                    K = K + 1;

   1087  4 001513   200007 054100                    AOS     K,,AUTO

     1162     1088    4                    END;  /* DO WHILE */

   1088  4 001514   200004 470500                    LDP0    @NAME,,AUTO
         4 001515   200007 235100                    LDA     K,,AUTO
         4 001516   040000 106505                    CMPC    fill='040'O
         4 001517   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         4 001520   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001521   001524 600000 4                  TZE     s:1089
         4 001522   000010 115007                    CMPA    8,DL
         4 001523   001513 604000 4                  TMI     s:1087

     1163     1089    3                 SUB_BUF_1.COUNT = K;

   1089  4 001524   200007 236100                    LDQ     K,,AUTO
         4 001525   000033 736000                    QLS     27
         4 001526   000000 552040 xsym               STBQ    SUB_BUF_1,'40'O

PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:197  
     1164     1090    3                 SUB_BUF_1.TEXT = NAME;

   1090  4 001527   040000 100500                    MLR     fill='040'O
         4 001530   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         4 001531   000000 200037 xsym               ADSC9   SUB_BUF_1                cn=1,n=31

     1165     1091    3                 CALL PCE$ERROR(%E$P_BAD_INSTANCE_NAME,3);

   1091  4 001532   000022 630400 5                  EPPR0   18
         4 001533   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001534   000000 701000 xent               TSX1    PCE$ERROR
         4 001535   000000 011000                    NOP     0

     1166     1092    3                 RETURN;

   1092  4 001536   000000 702200 xent               TSX2  ! X66_ARET

     1167     1093    3   FOUND_IT2:    TEMPLEN = MAXTPU_TBL.COUNT(I) + 2;

   1093  4 001537   200005 236100       FOUND_IT2    LDQ     I,,AUTO
         4 001540   000002 736000                    QLS     2
         4 001541   000003 236006 xsym               LDQ     MAXTPU_TBL+3,QL
         4 001542   000022 772000                    QRL     18
         4 001543   000002 036007                    ADLQ    2,DL
         4 001544   200014 756100                    STQ     TEMPLEN,,AUTO

     1168     1094    3                CALL INSERT(TPHDRBUF,7,TEMPLEN,SUBSTR(MAXTPU_TBL.NAME(I),0,MAXTPU_TBL.
              1094                          COUNT(I)),')=');

   1094  4 001545   200005 235100                    LDA     I,,AUTO
         4 001546   000002 735000                    ALS     2
         4 001547   000003 220005 xsym               LDX0    MAXTPU_TBL+3,AL
         4 001550   200005 235100                    LDA     I,,AUTO
         4 001551   000004 735000                    ALS     4
         4 001552   000000 621006                    EAX1    0,QL
         4 001553   040040 100445                    MLR     fill='040'O
         4 001554   000000 000010 xsym               ADSC9   MAXTPU_TBL,A             cn=0,n=*X0
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:198  
         4 001555   000052 600011 2                  ADSC9   TPHDRBUF+1               cn=3,n=*X1
         4 001556   000000 636010                    EAQ     0,X0
         4 001557   000022 772000                    QRL     18
         4 001560   200016 756100                    STQ     TEMPLEN+2,,AUTO
         4 001561   200014 236100                    LDQ     TEMPLEN,,AUTO
         4 001562   200016 136100                    SBLQ    TEMPLEN+2,,AUTO
         4 001563   001572 604400 4                  TMOZ    s:1095
         4 001564   000000 621006                    EAX1    0,QL
         4 001565   000000 636010                    EAQ     0,X0
         4 001566   000022 772000                    QRL     18
         4 001567   040046 100400                    MLR     fill='040'O
         4 001570   000013 000002 3                  ADSC9   DUMPBUF+2                cn=0,n=2
         4 001571   000052 600011 2                  ADSC9   TPHDRBUF+1,Q             cn=3,n=*X1

     1169     1095    3                 TEMPLEN = TEMPLEN + 7;

   1095  4 001572   000007 236007                    LDQ     7,DL
         4 001573   200014 056100                    ASQ     TEMPLEN,,AUTO

     1170     1096    3                 IF (TPHDR_TBL.HDR.CNT(I) > 0)

   1096  4 001574   200005 236100                    LDQ     I,,AUTO
         4 001575   000025 402007                    MPY     21,DL
         4 001576   000000 236006 xsym               LDQ     TPHDR_TBL,QL
         4 001577   777000 316003                    CANQ    -512,DU
         4 001600   001622 600000 4                  TZE     s:1103

     1171     1097    4                   THEN DO;

     1172     1098    4                      LEN = MINIMUM(TPHDR_TBL.HDR.CNT(I),100);

   1098  4 001601   200005 236100                    LDQ     I,,AUTO
         4 001602   000025 402007                    MPY     21,DL
         4 001603   000000 236006 xsym               LDQ     TPHDR_TBL,QL
         4 001604   000033 772000                    QRL     27
         4 001605   000144 116007                    CMPQ    100,DL
         4 001606   001611 602000 4                  TNC     s:1098+8
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:199  
         4 001607   001611 600000 4                  TZE     s:1098+8
         4 001610   000144 236007                    LDQ     100,DL
         4 001611   200013 756100                    STQ     LEN,,AUTO

     1173     1099    4                      CALL INSERT(TPHDRBUF,TEMPLEN,LEN,

   1099  4 001612   200005 236100                    LDQ     I,,AUTO
         4 001613   000124 402007                    MPY     84,DL
         4 001614   200013 720100                    LXL0    LEN,,AUTO
         4 001615   200014 235100                    LDA     TEMPLEN,,AUTO
         4 001616   040045 100446                    MLR     fill='040'O
         4 001617   000000 200010 xsym               ADSC9   TPHDR_TBL,Q              cn=1,n=*X0
         4 001620   000051 000010 2                  ADSC9   TPHDRBUF,A               cn=0,n=*X0

     1174     1100    4                                  SUBSTR(TPHDR_TBL.HDR.MSG(I),0,LEN));
     1175     1101    4                      END;

   1101  4 001621   001630 710000 4                  TRA     s:1106

     1176     1102    4                    ELSE DO;

     1177     1103    4                      CALL INSERT(TPHDRBUF,TEMPLEN,4,'NONE');

   1103  4 001622   200014 235100                    LDA     TEMPLEN,,AUTO
         4 001623   040005 100400                    MLR     fill='040'O
         4 001624   000014 000004 3                  ADSC9   DUMPBUF+3                cn=0,n=4
         4 001625   000051 000004 2                  ADSC9   TPHDRBUF,A               cn=0,n=4

     1178     1104    4                      LEN = 4;

   1104  4 001626   000004 236007                    LDQ     4,DL
         4 001627   200013 756100                    STQ     LEN,,AUTO

     1179     1105    4                      END;  /* IF PRESENT */

     1180     1106    3                 TPBUF.TEXT = TPHDRBUF;

PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:200  
   1106  4 001630   040000 100400                    MLR     fill='040'O
         4 001631   000051 000204 2                  ADSC9   TPHDRBUF                 cn=0,n=132
         4 001632   000112 200204 2                  ADSC9   TPBUF                    cn=1,n=132

     1181     1107    3                 TPBUF.COUNT = TEMPLEN + LEN;

   1107  4 001633   200014 236100                    LDQ     TEMPLEN,,AUTO
         4 001634   200013 036100                    ADLQ    LEN,,AUTO
         4 001635   000033 736000                    QLS     27
         4 001636   000112 552040 2                  STBQ    TPBUF,'40'O

     1182     1108    3                 CALL X$WRITE(FDS,VECTOR(DUMPBUF),VECTOR(TPBUF));

   1108  4 001637   000012 630400 5                  EPPR0   10
         4 001640   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001641   000000 701000 xent               TSX1    X$WRITE
         4 001642   000000 011000                    NOP     0

     1183     1109    3                 END;  /* ELSE NAME SPECIFIED */

     1184     1110    2           END;  /* DO CASE(CODE) */

     1185     1111    1           RETURN;

   1111  4 001643   000000 702200 xent               TSX2  ! X66_ARET
     1186     1112    1   END PCT$TPCAT;

PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:201  
--  Include file information  --

   XUF_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   PC_PERR_C.:E05TOU  is referenced.
   PC_SUBS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure PCT$TPCAT.
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:202  

 **** Variables and constants ****

  ****  Section 002  Data  PCT$TPCAT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   154-0-0/w STRC(1080)  r     1 FDS                       41-0-0/c CHAR(32)    r     1 MAXTPUBUF
     0-0-0/c CHAR(132)   r     1 OUTBUF                   112-0-0/w STRC(1197)  r     1 TPBUF
    51-0-0/c CHAR(132)   r     1 TPHDRBUF

  ****  Section 003 RoData PCT$TPCAT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    11-0-0/c CHAR(6)     r     1 DUMPBUF                    0-0-0/c CHAR(35)    r     1 TPIHDR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @CODE                      4-0-0/w PTR         r     1 @NAME
    *0-0-0/w SBIN        r     1 CODE                      10-0-0/w SBIN        r     1 DCB_WIDTH
     5-0-0/w SBIN        r     1 I                          7-0-0/w SBIN        r     1 K
    13-0-0/w SBIN        r     1 LEN                       *0-0-0/c CHAR(8)     r     1 NAME
    11-0-0/c CHAR(8)     r     1 TEMP                      14-0-0/w SBIN        r     1 TEMPLEN

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 CURINSTANCES
     0-0-0/w STRC(144)   r     1 MAXTPU_TBL(0:71)
     0-0-0/c STRC(288)   r     1 SUB_BUF_1                  0-0-0/w SBIN        r     1 TBLINSTANCES
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:203  
     0-0-0/w PTR         r     1 TP$
     0-0-0/w STRC(747)   r     1 TPHDR_TBL(0:71)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$LO
     0-0-0/w STRC(432)   r     1 P$TBL(0:0)


   Procedure PCT$TPCAT requires 932 words for executable code.
   Procedure PCT$TPCAT requires 18 words of local(AUTO) storage.

    No errors detected in file PCT$TABLES.:E05TSI    .
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:204  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:205  
          MINI XREF LISTING

CODE
        10**DCL         7--PROC      870>>DOCASE    974>>IF       1043>>IF
CURINSTANCES
       688**DCL       873>>IF        954>>IF        980>>IF       1049>>IF
DCB_WIDTH
       716**DCL       868<<ASSIGN    869>>IF        869<<ASSIGN    877>>IF        914>>IF        942>>IF
       958>>IF       1000>>IF       1068>>IF
DISP_MAXTPU
       977**LABEL     974--GOTO
DISP_TPHDR
      1046**LABEL    1043--GOTO
DUMPBUF
       834**DCL       878--CALL      887--CALL      915--CALL      923--CALL      943--CALL      951--CALL
       959--CALL      968--CALL     1001--CALL     1009--CALL     1041--CALL     1069--CALL     1077--CALL
      1108--CALL
F$DCB.ACTPOS
       486**DCL       486--REDEF
F$DCB.ARS
       461**DCL       461--REDEF
F$DCB.ATTR
       479**DCL       480--REDEF
F$DCB.BORROW
       494**DCL       494--REDEF     494--REDEF     494--REDEF
F$DCB.DCBNAME.L
       508**DCL       508--IMP-SIZ
F$DCB.EOMCHAR
       465**DCL       465--REDEF
F$DCB.FLDID
       489**DCL       489--REDEF
F$DCB.FORM$
       483**DCL       483--REDEF
F$DCB.FSECT
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:206  
       499**DCL       499--REDEF
F$DCB.FSN
       476**DCL       476--REDEF     476--REDEF     477--REDEF
F$DCB.HEADER$
       482**DCL       482--REDEF
F$DCB.IXTNSIZE
       480**DCL       480--REDEF
F$DCB.LASTSTA$
       470**DCL       470--REDEF
F$DCB.LVL
       495**DCL       495--REDEF
F$DCB.NAME.C
       470**DCL       470--REDEF
F$DCB.NOEOF
       491**DCL       491--REDEF
F$DCB.NRECS
       481**DCL       481--REDEF
F$DCB.NRECX
       500**DCL       500--REDEF
F$DCB.OHDR
       492**DCL       492--REDEF
F$DCB.ORG
       475**DCL       475--REDEF
F$DCB.PRECNO
       498**DCL       498--REDEF
F$DCB.RCSZ
       503**DCL       503--REDEF
F$DCB.RES
       471**DCL       471--REDEF
F$DCB.SETX
       483**DCL       483--REDEF
F$DCB.TAB$
       482**DCL       483--REDEF
F$DCB.TDA
       497**DCL       497--REDEF
F$DCB.WIDTH
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:207  
       468**DCL       868>>ASSIGN
F$DCB.WSN
       472**DCL       472--REDEF
FDS
       734**DCL       874<>CALL      878<>CALL      887<>CALL      915<>CALL      923<>CALL      943<>CALL
       951<>CALL      955<>CALL      959<>CALL      968<>CALL     1001<>CALL     1009<>CALL     1041<>CALL
      1069<>CALL     1077<>CALL     1108<>CALL
FOUND_IT
      1025**LABEL    1015--GOTO
FOUND_IT2
      1093**LABEL    1083--GOTO
I
       710**DCL       875<<DOINDEX   876>>IF        877>>IF        882>>CALLBLT   882>>CALLBLT   882>>CALLBLT
       884>>ASSIGN    897<<DOINDEX   898>>IF        898>>IF        899>>ASSIGN    900>>CALLBLT   900>>CALLBLT
       902>>CALLBLT   926<<DOINDEX   927>>IF        927>>IF        928>>ASSIGN    929>>CALLBLT   929>>CALLBLT
       931>>IF        933>>ASSIGN    934>>CALLBLT   956<<DOINDEX   957>>IF        958>>IF        963>>CALLBLT
       963>>CALLBLT   963>>CALLBLT   965>>ASSIGN    983<<DOINDEX   984>>IF        985>>ASSIGN    986>>CALLBLT
       986>>CALLBLT   988>>CALLBLT  1013<<DOINDEX  1014>>IF       1014>>IF       1025>>ASSIGN   1026>>CALLBLT
      1026>>CALLBLT  1028>>CALLBLT  1052<<DOINDEX  1053>>IF       1054>>ASSIGN   1055>>CALLBLT  1055>>CALLBLT
      1057>>IF       1059>>ASSIGN   1060>>CALLBLT  1081<<DOINDEX  1082>>IF       1082>>IF       1093>>ASSIGN
      1094>>CALLBLT  1094>>CALLBLT  1096>>IF       1098>>ASSIGN   1099>>CALLBLT
K
       712**DCL       903<<ASSIGN    904>>DOWHILE   904>>DOWHILE   905<<ASSIGN    905>>ASSIGN    907>>ASSIGN
       910<<ASSIGN    912>>CALLBLT   989<<ASSIGN    990>>DOWHILE   990>>DOWHILE   991<<ASSIGN    991>>ASSIGN
       993>>ASSIGN    996<<ASSIGN    998>>CALLBLT  1017<<ASSIGN   1018>>DOWHILE  1018>>DOWHILE  1019<<ASSIGN
      1019>>ASSIGN   1021>>ASSIGN   1029<<ASSIGN   1030>>DOWHILE  1030>>DOWHILE  1031<<ASSIGN   1031>>ASSIGN
      1033>>ASSIGN   1036<<ASSIGN   1038>>CALLBLT  1085<<ASSIGN   1086>>DOWHILE  1086>>DOWHILE  1087<<ASSIGN
      1087>>ASSIGN   1089>>ASSIGN
LEN
       836**DCL       907<<ASSIGN    908>>IF        909<<ASSIGN    912>>CALLBLT   912>>CALLBLT   913>>ASSIGN
       933<<ASSIGN    934>>CALLBLT   934>>CALLBLT   939<<ASSIGN    941>>ASSIGN    993<<ASSIGN    994>>IF
       995<<ASSIGN    998>>CALLBLT   998>>CALLBLT   999>>ASSIGN   1033<<ASSIGN   1034>>IF       1035<<ASSIGN
      1038>>CALLBLT  1038>>CALLBLT  1040>>ASSIGN   1059<<ASSIGN   1060>>CALLBLT  1060>>CALLBLT  1065<<ASSIGN
      1067>>ASSIGN   1098<<ASSIGN   1099>>CALLBLT  1099>>CALLBLT  1104<<ASSIGN   1107>>ASSIGN
M$LO
       681**DCL       868--ASSIGN
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:208  
MAXTPUBUF
       714**DCL       900<<CALLBLT   912<<CALLBLT   919>>CALLBLT   986<<CALLBLT   998<<CALLBLT  1005>>CALLBLT
      1026<<CALLBLT  1038<<CALLBLT  1039>>ASSIGN
MAXTPU_TBL.COUNT
       693**DCL       877>>IF        882>>CALLBLT   882>>CALLBLT   884>>ASSIGN    899>>ASSIGN    900>>CALLBLT
       928>>ASSIGN    929>>CALLBLT   958>>IF        963>>CALLBLT   963>>CALLBLT   965>>ASSIGN    985>>ASSIGN
       986>>CALLBLT  1025>>ASSIGN   1026>>CALLBLT  1054>>ASSIGN   1055>>CALLBLT  1093>>ASSIGN   1094>>CALLBLT
MAXTPU_TBL.FLAGS.DELETED
       696**DCL       876>>IF        898>>IF        927>>IF        957>>IF        984>>IF       1014>>IF
      1053>>IF       1082>>IF
MAXTPU_TBL.FLAGS.PRINT
       695**DCL       898>>IF
MAXTPU_TBL.MAXTPU
       692**DCL       902>>CALLBLT   988>>CALLBLT  1028>>CALLBLT
MAXTPU_TBL.NAME
       691**DCL       882>>CALLBLT   900>>CALLBLT   929>>CALLBLT   963>>CALLBLT   986>>CALLBLT  1014>>IF
      1026>>CALLBLT  1055>>CALLBLT  1082>>IF       1094>>CALLBLT
NAME
        11**DCL         7--PROC      979--IF       1014>>IF       1018>>DOWHILE  1022>>ASSIGN   1048--IF
      1082>>IF       1086>>DOWHILE  1090>>ASSIGN
OUTBUF
       713**DCL       752--DCLINIT   754--DCLINIT
P$TBL.FLAGS.PRINT
       840**DCL       872>>IF
P$TBL.MAX
       862**DCL       896>>IF        925>>IF
P$TBL.PSUPTR$
       858**DCL       859--REDEF
P$TBL.PTR$
       854**DCL       855--REDEF
PCE$ERROR
       684**DCL-ENT   890--CALL      971--CALL      981--CALL     1023--CALL     1050--CALL     1091--CALL
SUB_BUF_1.COUNT
       708**DCL      1021<<ASSIGN   1089<<ASSIGN
SUB_BUF_1.TEXT
       709**DCL      1022<<ASSIGN   1090<<ASSIGN
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:209  
TBLINSTANCES
       689**DCL       875>>DOINDEX   897>>DOINDEX   926>>DOINDEX   956>>DOINDEX   983>>DOINDEX  1013>>DOINDEX
      1052>>DOINDEX  1081>>DOINDEX
TEMP
       835**DCL       902<<CALLBLT   904>>DOWHILE   912>>CALLBLT   988<<CALLBLT   990>>DOWHILE   998>>CALLBLT
      1028<<CALLBLT  1030>>DOWHILE  1038>>CALLBLT
TEMPLEN
       837**DCL       899<<ASSIGN    900>>CALLBLT   901<<ASSIGN    901>>ASSIGN    912>>CALLBLT   913<<ASSIGN
       913>>ASSIGN    914>>IF        919>>CALLBLT   919>>CALLBLT   920>>ASSIGN    928<<ASSIGN    929>>CALLBLT
       930<<ASSIGN    930>>ASSIGN    934>>CALLBLT   938>>CALLBLT   941<<ASSIGN    941>>ASSIGN    942>>IF
       947>>CALLBLT   947>>CALLBLT   948>>ASSIGN    985<<ASSIGN    986>>CALLBLT   987<<ASSIGN    987>>ASSIGN
       998>>CALLBLT   999<<ASSIGN    999>>ASSIGN   1000>>IF       1005>>CALLBLT  1005>>CALLBLT  1006>>ASSIGN
      1025<<ASSIGN   1026>>CALLBLT  1027<<ASSIGN   1027>>ASSIGN   1038>>CALLBLT  1040>>ASSIGN   1054<<ASSIGN
      1055>>CALLBLT  1056<<ASSIGN   1056>>ASSIGN   1060>>CALLBLT  1064>>CALLBLT  1067<<ASSIGN   1067>>ASSIGN
      1068>>IF       1073>>CALLBLT  1073>>CALLBLT  1074>>ASSIGN   1093<<ASSIGN   1094>>CALLBLT  1095<<ASSIGN
      1095>>ASSIGN   1099>>CALLBLT  1103>>CALLBLT  1107>>ASSIGN
TP$
       687**DCL       872>>IF        896>>IF        925>>IF
TPBUF
       717**DCL       878--CALL      887--CALL      915--CALL      923--CALL      943--CALL      951--CALL
       959--CALL      968--CALL     1001--CALL     1009--CALL     1041--CALL     1069--CALL     1077--CALL
      1108--CALL
TPBUF.COUNT
       718**DCL       866<<ASSIGN    877>>IF        880<<ASSIGN    882>>CALLBLT   884<<ASSIGN    884>>ASSIGN
       894<<ASSIGN    914>>IF        916<<ASSIGN    919>>CALLBLT   920<<ASSIGN    920>>ASSIGN    942>>IF
       944<<ASSIGN    947>>CALLBLT   948<<ASSIGN    948>>ASSIGN    958>>IF        961<<ASSIGN    963>>CALLBLT
       965<<ASSIGN    965>>ASSIGN    977<<ASSIGN   1000>>IF       1002<<ASSIGN   1005>>CALLBLT  1006<<ASSIGN
      1006>>ASSIGN   1040<<ASSIGN   1046<<ASSIGN   1068>>IF       1070<<ASSIGN   1073>>CALLBLT  1074<<ASSIGN
      1074>>ASSIGN   1107<<ASSIGN
TPBUF.TEXT
       719**DCL       867<<ASSIGN    879<<ASSIGN    882<<CALLBLT   895<<ASSIGN    917<<ASSIGN    919<<CALLBLT
       945<<ASSIGN    947<<CALLBLT   960<<ASSIGN    963<<CALLBLT   978<<ASSIGN   1003<<ASSIGN   1005<<CALLBLT
      1039<<ASSIGN   1047<<ASSIGN   1071<<ASSIGN   1073<<CALLBLT  1106<<ASSIGN
TPHDRBUF
       715**DCL       929<<CALLBLT   934<<CALLBLT   938<<CALLBLT   947>>CALLBLT  1055<<CALLBLT  1060<<CALLBLT
      1064<<CALLBLT  1073>>CALLBLT  1094<<CALLBLT  1099<<CALLBLT  1103<<CALLBLT  1106>>ASSIGN
PL6.E3A0      #002=PCT$TPCAT File=PCT$TABLES.:E05TSI                             WED 07/30/97 04:23 Page:210  
TPHDR_TBL.FLAGS.PRINT
       703**DCL       927>>IF
TPHDR_TBL.HDR.CNT
       700**DCL       931>>IF        933>>ASSIGN   1057>>IF       1059>>ASSIGN   1096>>IF       1098>>ASSIGN
TPHDR_TBL.HDR.MSG
       701**DCL       934>>CALLBLT  1060>>CALLBLT  1099>>CALLBLT
TPIHDR
       833**DCL       874--CALL      955--CALL
X$WRITE
       677**DCL-ENT   874--CALL      878--CALL      887--CALL      915--CALL      923--CALL      943--CALL
       951--CALL      955--CALL      959--CALL      968--CALL     1001--CALL     1009--CALL     1041--CALL
      1069--CALL     1077--CALL     1108--CALL
