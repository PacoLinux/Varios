VERSION E05

PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:1    
        1        1        /*M* VYU$PREAD - To read page records of types 1 through 9 from object files and run
                 1         files*/
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=6,IND=4,CSU=2,EXM=0,ECU=2,MOC,DCI=4,CRT=4,CTI=8,CCC */
        8        8        /*F* NAME:        VYU$PREAD
        9        9         PURPOSE:     To read page records of types 1 through 9 from object files and run fi
                 9        les.
       10       10             Description:
       11       11            VYU$PREAD is passed eleven arguments of which the first two are returned
       12       12            variables while the remaining nine are value parameters. Npage is a returned
       13       13            variable which contains the number of pages read for the type of record.
       14       14            TSIZE_READ is a variable which returns the number of words read for the
       15       15            type of record.  File is a passed variable which indicates which dcb the
       16       16            read(s) are to be done through. FILE_TYPE is a passed variable which
       17       17            indicates which file organization is assumed either an object file or a run
       18       18            file. Rtype is the record type; RANGE: 0-9. START$ is the locator which
       19       19            points at the initial area in which the records are to be placed. PAGE_SIZE
       20       20            is the size in words of all records for this type except possibly the last.
       21       21            Tsize is the total size in words of all records for this type(rtype).
       22       22            Ds is the internal data segment identifier in which the records are
       23       23            are to be placed. CURR_P$ is a pointer to the node which owns these records.
       24       24            SOURCE_P is a variable which labels the records as to their origin(library,
       25       25            object, shared library, etc.).
       26       26            VYU$PREAD reads paged records for a given type and makes them suitable for
       27       27            further processing. This is accomplished by updating name pointers where
       28       28            appropriate (and doing some verification that indeed the name displacements
       29       29            locate valid name strings).  Definition entrys which are virgin(i.e. Not
       30       30            defined) are bound to their proper section declaration and all linker flags
       31       31            for them are reset. Various integrity and consistency checks are performed
       32       32            to ensure the soundness of the link process.      */
       33       33        VYU$PREAD:
       34       34              PROC(
       35       35                      NPAGE,                    /* # of pages read-inc by 1 each read */
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:2    
       36       36                      TSIZE_READ,               /* Total word size read */
       37       37                      FILE,                     /* Dcb to read thru */
       38       38                      FILE_TYPE,                /*  File type */
       39       39                      RTYPE,                    /* Record type */
       40       40                      START$,                   /* Beginning of area to read into */
       41       41                      PAGE_SIZE,                /* Page size */
       42       42                      TSIZE,                    /* Total size to read */
       43       43                      DS,                       /* Data SEGMENT/INTERNAL# */
       44       44                      AREA_SIZE,                /* Initial area size allocated */
       45       45                      CURR_P$,                  /* Current node */
       46       46                      SOURCE_P)   ALTRET;       /* From whence it came */
       47       47        /**/
       48       48        /**/
       49       49        /**/
       50       50        %INCLUDE VY_INC_C;
       51     9226              %VY$NODE;

              9238    1   /*******************************************************************************
              9239    1   *                                                                              *
              9240    1   *                          VY$NODE                                                 *
              9241    1   *                                                                              *
              9242    1   *******************************************************************************/

              9258    1   DCL 1 VY$NODE      ALIGNED    BASED,
              9259    1         2 SON$ PTR /*(ADDR(NIL))*/, /* Son pointer                      */
              9260    1         2 BROTHER$ PTR /*(ADDR(NIL))*/, /* Brother pointer              */
              9261    1         2 FATHER$ PTR /*(ADDR(NIL))*/, /* Father pointer                */
              9262    1         2 PATH$ PTR /*(ADDR(NIL))*/, /* Path   pointer                  */
              9263    1         2 HEAD$       PTR /*(ADDR(NIL))*/, /* Head pointer to
              9264                              to list of file nodes for this node            */
              9265    1         2 TAIL$ PTR /*(ADDR(NIL))*/, /* Tail pointer to list            */
              9266    1         2 SHARED_LIB_HEAD$ PTR /*(ADDR(NIL))*/,
              9266                  /* Head pointer to shared library list */
              9267    1         2 LIB_HEAD$         PTR /*(ADDR(NIL))*/,
              9267                  /* Head pointer to list of shared libraries
              9268                                          which have been mapped to included libraries */
              9269    1         2 NUM          UBIN(36)  UNAL,    /* Node number                        */
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:3    
              9270    1         2 DEPTH          UBIN(36)  UNAL,  /* Depth; ROOT=0*/
              9271    1         2 ADDR_START_A(0:2/*@ROS*/) SBIN WORD /*(0*3)*/, /* Array            */
              9272    1         2 ADDR_START REDEF  ADDR_START_A,
              9273    1           3 RDATA       SBIN WORD,   /* First address for this node in data     */
              9274    1           3 RPROC       SBIN WORD,   /* First address for this node in proc     */
              9275    1           3 ROS       SBIN WORD,          /* Last address for program in ros    */
              9276    1         2 ADDR_STOP_A(0:2/*@ROS*/) SBIN WORD /*(-1*3)*/, /* Array            */
              9277    1         2 ADDR_STOP  REDEF  ADDR_STOP_A,
              9278    1           3 RDATA       SBIN WORD,        /* Last address for this node in data */
              9279    1           3 RPROC       SBIN WORD,        /* Last address for this node in proc */
              9280    1           3 ROS       SBIN WORD,          /* Last address for program in ros    */
              9281    1         2 START_PAGE#_A(0:2/*@ROS*/) SBIN WORD /*(0*3)*/, /* Array           */
              9282    1         2 START_PAGE# REDEF START_PAGE#_A,
              9283    1           3 RDATA       SBIN WORD,   /* First page    for this node in data     */
              9284    1           3 RPROC       SBIN WORD,   /* First page    for this node in proc     */
              9285    1           3 ROS       SBIN WORD,          /* First page   for program in ros    */
              9286    1         2 STOP_PAGE#_A(0:2/*@ROS*/) SBIN WORD /*(-1*3)*/, /* Array*/
              9287    1         2 STOP_PAGE#  REDEF STOP_PAGE#_A,
              9288    1           3 RDATA       SBIN WORD,   /* Last  page    for this node in data     */
              9289    1           3 RPROC       SBIN WORD,   /* Last  page    for this node in proc     */
              9290    1           3 ROS       SBIN WORD,          /* Last  page   for program in ros    */
              9291    1         2 START_SC_ALL$ PTR /*(ADDR(NIL))*/,
              9291                  /* Starting pointer for common sections for this node */
              9292    1         2 STOP_SC_ALL$ PTR /*(ADDR(NIL))*/,
              9292                  /* Stopping pointer for common sections for this node */
              9293    1         2 L_START,
              9294    1           3 SN$ PTR /*(ADDR(NIL))*/, /* Segment definition names        */
              9295    1           3 DN$ PTR /*(ADDR(NIL))*/, /* Def names                       */
              9296    1           3 RN$ PTR /*(ADDR(NIL))*/, /* Ref names                       */
              9297    1           3 SC$ PTR /*(ADDR(NIL))*/, /* Sections                        */
              9298    1           3 ED$ PTR /*(ADDR(NIL))*/, /* Entry defs*/
              9299    1           3 ER$ PTR /*(ADDR(NIL))*/, /* Entry refs*/
              9300    1           3 DD$ PTR /*(ADDR(NIL))*/, /* Data defs                       */
              9301    1           3 DR$ PTR /*(ADDR(NIL))*/, /* Data refs                       */
              9302    1           3 SD$ PTR /*(ADDR(NIL))*/, /* Seg defs                        */
              9303    1           3 SR$ PTR /*(ADDR(NIL))*/, /* Seg refs                        */
              9304    1         2 L_START_A$(0:9)     REDEF L_START PTR,
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:4    
              9305    1         2 L_STOP,
              9306    1           3 SN$ PTR /*(ADDR(NIL))*/, /* Segment definition names        */
              9307    1           3 DN$ PTR /*(ADDR(NIL))*/, /* Def names                       */
              9308    1           3 RN$ PTR /*(ADDR(NIL))*/, /* Ref names                       */
              9309    1           3 SC$ PTR /*(ADDR(NIL))*/, /* Sections                        */
              9310    1           3 ED$ PTR /*(ADDR(NIL))*/, /* Entry defs*/
              9311    1           3 ER$ PTR /*(ADDR(NIL))*/, /* Entry refs*/
              9312    1           3 DD$ PTR /*(ADDR(NIL))*/, /* Data defs                       */
              9313    1           3 DR$ PTR /*(ADDR(NIL))*/, /* Data refs                       */
              9314    1           3 SD$ PTR /*(ADDR(NIL))*/, /* Seg defs                        */
              9315    1           3 SR$ PTR /*(ADDR(NIL))*/, /* Seg refs                        */
              9316    1         2 L_STOP_A$(0:9) REDEF   L_STOP    PTR,
              9317    1         2 L_SIZE,
              9318    1           3 SN      UBIN /*(0)*/, /* Segment definition names           */
              9319    1           3 DN      UBIN /*(0)*/, /* Def names                          */
              9320    1           3 RN      UBIN /*(0)*/, /* Ref names                          */
              9321    1           3 SC      UBIN /*(0)*/, /* Sections                           */
              9322    1           3 ED      UBIN /*(0)*/, /* Entry defs*/
              9323    1           3 ER      UBIN /*(0)*/, /* Entry refs*/
              9324    1           3 DD      UBIN /*(0)*/, /* Data defs                          */
              9325    1           3 DR      UBIN /*(0)*/, /* Data refs                          */
              9326    1           3 SD      UBIN /*(0)*/, /* Seg defs                           */
              9327    1           3 SR      UBIN /*(0)*/, /* Seg refs                           */
              9328    1         2 L_SIZE_A(0:9)  REDEF   L_SIZE    UBIN,
              9329    1         2 L_PREV_SIZE,
              9330    1           3 SN      UBIN /*(0)*/, /* Segment definition names           */
              9331    1           3 DN      UBIN /*(0)*/, /* Def names                          */
              9332    1           3 RN      UBIN /*(0)*/, /* Ref names                          */
              9333    1           3 SC      UBIN /*(0)*/, /* Sections                           */
              9334    1           3 ED      UBIN /*(0)*/, /* Entry defs*/
              9335    1           3 ER      UBIN /*(0)*/, /* Entry refs*/
              9336    1           3 DD      UBIN /*(0)*/, /* Data defs                          */
              9337    1           3 DR      UBIN /*(0)*/, /* Data refs                          */
              9338    1           3 SD      UBIN /*(0)*/, /* Seg defs                           */
              9339    1           3 SR      UBIN /*(0)*/, /* Seg refs                           */
              9340    1         2 L_PREV_SIZE_A(0:9)  REDEF   L_PREV_SIZE    UBIN,
              9341    1         2 BIT_MAP                ALIGNED,
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:5    
              9342    1           3 DATA                  ALIGNED,
              9343    1             4 BITS(0:255)          BIT(1)    UNAL /*('0'B*256)*/,
              9344    1           3 RPROC                 ALIGNED,
              9345    1             4 BITS(0:255)          BIT(1)    UNAL /*('0'B*256)*/,
              9346    1           3 ROS                   ALIGNED,
              9347    1             4 BITS(0:255)          BIT(1)    UNAL /*('0'B*256)*/,
              9348    1         2 L_SC_START,
              9349    1           3 SC_BLK_COM$ PTR /*(ADDR(NIL))*/, /* Blank common            */
              9350    1           3 SC_ROOT_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Root labelled common */
              9351    1           3 SC_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Labelled common         */
              9352    1           3 SC_DCB$ PTR /*(ADDR(NIL))*/, /* Dcbs                        */
              9353    1         2 L_SC_START_A$(0:3)  REDEF L_SC_START PTR,
              9354    1         2 L_SC_STOP,
              9355    1           3 SC_BLK_COM$ PTR /*(ADDR(NIL))*/, /* Blank common            */
              9356    1           3 SC_ROOT_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Root labelled common */
              9357    1           3 SC_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Labelled common         */
              9358    1           3 SC_DCB$ PTR /*(ADDR(NIL))*/, /* Dcbs                        */
              9359    1         2 L_SC_STOP_A$(0:3)   REDEF L_SC_STOP  PTR,
              9360    1         2 PROMOTE_HEAD,
              9361    1           3 BLK_COM$              PTR /*(ADDR(NIL))*/,
              9362    1           3 LBL_COM$              PTR /*(ADDR(NIL))*/,
              9363    1         2 PROMOTE_HEAD_A$(0:1) REDEF PROMOTE_HEAD     PTR,
              9364    1         2 PROMOTE_TAIL,
              9365    1           3 BLK_COM$              PTR /*(ADDR(NIL))*/,
              9366    1           3 LBL_COM$              PTR /*(ADDR(NIL))*/,
              9367    1         2 PROMOTE_TAIL_A$(0:1) REDEF PROMOTE_TAIL     PTR,
              9368    1         2 HAVE_ASL          BIT(1)    UNAL /*('0'B)*/,
              9369    1         2 ALL_BLK_COM          BIT(1)    UNAL /*('0'B)*/,
              9370    1         2 *                 BIT(34)   UNAL /*('0'B)*/,
              9371    1         2 BLANK_COMMON$     PTR       ALIGNED /*(ADDR(NIL))*/;

       52     9375              %VY$SC;

              9389    1   /*******************************************************************************
              9390    1   *                                                                              *
              9391    1   *                          VY$SC                                                 *
              9392    1   *                                                                              *
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:6    
              9393    1   *******************************************************************************/

              9397    1   DCL 1 VY$SC               BASED     ALIGNED,
              9398    1         2 TYPE              UBIN(9)   UNAL,
              9399    1         2 EMPTY             BIT (1)   UNAL,
              9400    1         2 ATTR                        UNAL,
              9401    1           3 INT              UBIN(2)   UNAL,
              9402    1           3 SEGMENT          BIT(1)    UNAL,
              9403    1           3 ALL              BIT(1)    UNAL,
              9404    1           3 PRE_DCB          BIT(1) UNAL, /* '1'B => true; '0'B => false        */
              9405    1           3 MES_INIT         BIT (1)   UNAL,
              9406    1           3 ALIGN            UBIN(2)   UNAL,
              9407    1         2 ADDRESS           UBIN(18)  UNAL,
              9408    1         2 NAME_DISP         SBIN HALF UNAL,
              9409    1         2 SIZE              UBIN(18)  UNAL,
              9410    1         2 NODE#             UBIN(18)  UNAL,
              9411    1         2 COM_LINK          UBIN(18)  UNAL;

              9420    1   /*******************************************************************************
              9421    1   *                                                                              *
              9422    1   *                          VY$SECT                                                 *
              9423    1   *                                                                              *
              9424    1   *******************************************************************************/

              9428    1   DCL 1 VY$SECT       BASED     ALIGNED,
              9429    1         2 TYPE              UBIN(9)   UNAL,
              9430    1         2 EMPTY             BIT (1)   UNAL,
              9431    1         2 ATTR                        UNAL,
              9432    1           3 INT              UBIN(2)  UNAL,
              9433    1           3 SEGMENT          BIT (1)  UNAL,
              9434    1           3 *                UBIN(3)  UNAL,
              9435    1           3 ALIGN            UBIN(2)  UNAL,
              9436    1         2 SIZE              UBIN(18)  UNAL,
              9437    1         2 NAME_DISP         SBIN HALF UNAL,
              9438    1         2 SEG_NPOINTER      UBIN(18)  UNAL;
       53     9441              %VYD$TMPLT;

PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:7    
              9453    1   /*******************************************************************************
              9454    1   *                                                                              *
              9455    1   *                          VYD$TMPLT                                               *
              9456    1   *                                                                              *
              9457    1   *******************************************************************************/

              9462    1   DCL 1 VYD$TMPLT          ALIGNED BASED, /* Template for defs                  */
              9463    1         2 A(0:3)       UBIN(18)  UNAL,    /* Array ...                          */
              9464    1         2 A_SBIN(0:3) REDEF A    SBIN HALF UNAL,
              9465    1         2 I       REDEF     A,            /* Items                              */
              9466    1           3 WHERE        UBIN( 3) UNAL,   /* Source of def                      */
              9467                                                                /* Value from
              9468                                                                     0   object
              9469                                                                     1   library */
              9470    1           3 DEFINED      BIT( 1) UNAL,    /* Defined or not                     */
              9471    1           3 B                      UNAL,
              9472    1             4 MULTIPLY    BIT(1) UNAL,    /* Multiply defined                   */
              9473    1           3 SC#          UBIN(13) UNAL,   /* Section #                          */
              9474    1           3 AFTER        REDEF SC#      UNAL,
              9475    1             4 USED        BIT(1) UNAL,    /* Used or not                        */
              9476    1             4 *           BIT(12) UNAL,
              9477    1           3 OFFSET      UBIN(18) UNAL,    /* Offset/address                     */
              9478    1           3 NAME_DISP   UBIN(18) UNAL,    /* Displacement to name(in words)     */
              9479    1           3 NAME_DISP_SBIN REDEF NAME_DISP   SBIN HALF UNAL,
              9480    1           3 P           UBIN( 1) UNAL,    /* Primary entdef                     */
              9481    1           3 C REDEF P   BIT(  1) UNAL,    /* Constant bit for symdefs           */
              9482    1           3 A           UBIN( 1) UNAL,    /* Altret specified                   */
              9483    1           3 MULTIPLY REDEF A BIT(1) UNAL, /* Multiply defined for constant sym defs */
              9484    1           3 I           BIT(  1) UNAL,    /* Argument/parameter check           */
              9485    1           3 USED    REDEF I  BIT(1) UNAL, /* Used or not for constant sym defs  */
              9486    1           3 CST         UBIN( 4) UNAL,    /* Calling sequence type              */
              9487    1           3 WHERE_C REDEF CST UBIN(4) UNAL, /* Source of def for constant sym defs */
              9488    1           3 NP          UBIN(11) UNAL,    /* # of parameters                    */
              9489    1           3 IS_DCB  REDEF     NP,
              9490    1             4 DCB_BIT     BIT(1)    UNAL,
              9491    1             4 *           BIT(10)   UNAL,
              9492    1         2 SEG REDEF A,
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:8    
              9493    1           3 *             UBIN      UNAL,
              9494    1           3 NPOINTER      UBIN(18)  UNAL,
              9495    1           3 CONSTNT       BIT(1)    UNAL,
              9496    1           3 TYPE          UBIN(5)   UNAL,
              9497    1           3 SEGID         UBIN(12)  UNAL,
              9498    1         2 V REDEF A,
              9499    1           3 VALUE       UBIN(36) UNAL,    /* Value if C=1                       */
              9500    1           3 *           UBIN(36) UNAL,
              9501    1         2 S  REDEF  A,                    /* Value if C=1                       */
              9502    1           3 *         UBIN(24) UNAL,
              9503    1           3 SEGID     UBIN(12) UNAL,
              9504    1           3 *         UBIN     UNAL;
       54     9507        %SET LISTMAC='1'B;
       55     9508        %SET LISTSUB='1'B;
       56     9509        %SET LISTEXP='1'B;
       57     9510              %B$DNAME( NAME=B$DNAME, STCLASS=BASED );
              9511            %LSET STR='BASED        ';
              9512            %IF
              9513                '0'B;
              9515            %ELSE;
              9516                %LSET INIT=/*;
              9517            %ENDIF;
              9518    1   DCL 1 B$DNAME BASED ALIGNED,
              9519    1         2 COUNT UBIN HALF UNAL /*(SIZEC(' ')) /**/,
              9520                /*K*  COUNT is the number of characters in the name */
              9521            %IF
              9522                '0'B;
              9525            %ELSE;
              9526    1         2 TEXT CHAR(B$DNAME.COUNT) UNAL;
              9527            %ENDIF;
       58     9529              %P;
              9530        %LSET LISTDIR='0'B;

              9537    1   /*******************************************************************************
              9538    1   *                                                                              *
              9539    1   *                          PARAMETERS                                              *
              9540    1   *                                                                              *
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:9    
              9541    1   *******************************************************************************/

       59     9545    1   DCL NPAGE           UBIN(36)  ALIGNED;
       60     9546    1   DCL TSIZE_READ      UBIN(36)  ALIGNED;
       61     9547    1   DCL FILE            UBIN(36)  ALIGNED;
       62     9548    1   DCL FILE_TYPE       UBIN(36)  ALIGNED;
       63     9549    1   DCL RTYPE           UBIN(36)  ALIGNED;
       64     9550    1   DCL START$          PTR       ALIGNED;
       65     9551    1   DCL PAGE_SIZE       SBIN(36)  ALIGNED;
       66     9552    1   DCL TSIZE           UBIN(36)  ALIGNED;
       67     9553    1   DCL DS              UBIN(36)  ALIGNED;
       68     9554    1   DCL AREA_SIZE       UBIN(36)  ALIGNED;
       69     9555    1   DCL CURR_P$         PTR  ALIGNED;
       70     9556    1   DCL SOURCE_P        SBIN WORD ALIGNED;
       71     9557        %E;
              9558        %LSET LISTDIR='0'B;

              9565    1   /*******************************************************************************
              9566    1   *                                                                              *
              9567    1   *                          ENTRY                                                 *
              9568    1   *                                                                              *
              9569    1   *******************************************************************************/

       72     9573        %ENTRIES;
              9574    1   DCL VYE$ERROR       ENTRY(4);
              9575    1   DCL VYE$ERR         ENTRY(3);
              9576    1   DCL VYE$MERC        ENTRY;
              9577    1   DCL VYE$ERRMSG      ENTRY(1);
              9578    1   DCL VYR$READ        ENTRY( 3 ) ALTRET;
              9579    1   DCL VYW$WRITE       ENTRY( 3 ) ALTRET;
              9580    1   DCL VYW$WRITE_DO    ENTRY( 2 ) ALTRET;
              9581    1   DCL VYD$B2C         ENTRY( 5 );
              9582    1   DCL VYD$C2B         ENTRY( 3 );
              9583    1   DCL VYA$GET         ENTRY( 3 );
              9584    1   DCL VYF$FREE        ENTRY( 3 );
              9585    1   DCL VYQ$SORT        ENTRY( 7 );
              9586    1   DCL VYY$YESNO       ENTRY( 1 );
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:10   
       73     9588    1   DCL VYK$KEY         ENTRY(4);
       74     9589    1   DCL VYI$READ        ENTRY(5)  ALTRET;
       75     9590    1   DCL VYI$WRITE        ENTRY(5)  ALTRET;
       76     9591        %PTR;
              9592        %LSET LISTDIR='0'B;

              9599    1   /*******************************************************************************
              9600    1   *                                                                              *
              9601    1   *                          PTR                                                 *
              9602    1   *                                                                              *
              9603    1   *******************************************************************************/

       77     9607        %POINTER;
              9608    1   DCL P$         PTR       ALIGNED STATIC/*AUTO*/;
              9609    1   DCL Q$         PTR       ALIGNED STATIC/*AUTO*/;
              9610    1   DCL R$         PTR       ALIGNED STATIC/*AUTO*/;
       78     9612    1   DCL WHERE$               PTR  ALIGNED   STATIC/*AUTO*/;
       79     9613    1   DCL CURR$                PTR  ALIGNED   STATIC/*AUTO*/;
       80     9614    1   DCL NAME$                PTR  ALIGNED   STATIC/*AUTO*/;
       81     9615    1   DCL SECT$                PTR  ALIGNED   STATIC/*AUTO*/;
       82     9616        %U;
              9617        %LSET LISTDIR='0'B;

              9624    1   /*******************************************************************************
              9625    1   *                                                                              *
              9626    1   *                          UBIN                                                 *
              9627    1   *                                                                              *
              9628    1   *******************************************************************************/

       83     9632        %INDEX;
              9633    1   DCL I          UBIN(36) ALIGNED STATIC/*AUTO*/;
              9634    1   DCL SI REDEF I SBIN WORD ALIGNED;
              9635    1   DCL J          UBIN(36) ALIGNED STATIC/*AUTO*/;
              9636    1   DCL SJ REDEF J SBIN WORD ALIGNED;
              9637    1   DCL K          UBIN(36) ALIGNED STATIC/*AUTO*/;
              9638    1   DCL SK REDEF K SBIN WORD ALIGNED;
              9639    1   DCL L          UBIN(36) ALIGNED STATIC/*AUTO*/;
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:11   
              9640    1   DCL SL REDEF L    SBIN WORD ALIGNED;
       84     9642    1   DCL LOOP            UBIN(36)  ALIGNED   STATIC/*AUTO*/;
       85     9643    1   DCL IN_PROG         UBIN(36)  ALIGNED   STATIC/*AUTO*/;
       86     9644    1   DCL SIZE            UBIN(36)  ALIGNED   STATIC/*AUTO*/;
       87     9645    1   DCL SIZE_READ       UBIN(36)  ALIGNED   STATIC/*AUTO*/;
       88     9646    1   DCL DUMMY           UBIN(36)  ALIGNED   STATIC/*AUTO*/;
       89     9647    1   DCL ENT_SIZE        UBIN(36)  ALIGNED   STATIC/*AUTO*/;
       90     9648    1   DCL NAME_X          UBIN(36)  ALIGNED   STATIC/*AUTO*/;
       91     9649    1   DCL SC##            UBIN(36)  ALIGNED   STATIC/*AUTO*/;
       92     9650    1   DCL CURR_SC_ENTRIES UBIN(36)  ALIGNED   STATIC/*AUTO*/;
       93     9651    1   DCL KEY             UBIN(36)  ALIGNED   STATIC/*AUTO*/;
       94     9652    1   DCL NAME_INX        UBIN(36)  ALIGNED   STATIC/*AUTO*/;
       95     9653    1   DCL CURR_NAME_SIZE  UBIN(36)  ALIGNED   STATIC/*AUTO*/;
       96     9654    1   DCL LAST_NAME_SIZE  UBIN(36)  ALIGNED   STATIC/*AUTO*/;
       97     9655        %S;
              9656        %LSET LISTDIR='0'B;

              9663    1   /*******************************************************************************
              9664    1   *                                                                              *
              9665    1   *                          SBIN                                                 *
              9666    1   *                                                                              *
              9667    1   *******************************************************************************/

       98     9671    1   DCL A_SIZE          SBIN WORD ALIGNED   STATIC/*AUTO*/;
       99     9672    1   DCL NAME_DISP       SBIN WORD ALIGNED   STATIC/*AUTO*/;
      100     9673    1   DCL SOURCE          SBIN WORD ALIGNED   STATIC/*AUTO*/;
      101     9674    1   DCL ARS             SBIN WORD ALIGNED   STATIC/*AUTO*/;
      102     9675    1   DCL DIFF            SBIN WORD ALIGNED   STATIC/*AUTO*/;
      103     9676        %PLIST;
      104     9677        %F$DCB;
      105     9734        %INCLUDE VY_PSUBS_C;
      106     9795        %EJECT;
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:12   
      107     9796    1         CURR$ = CURR_P$;
      108     9797    1         SOURCE = SOURCE_P;
      109     9798    1         KEY = FILE_TYPE;
      110     9799    1         IN_PROG = TSIZE;
      111     9800    1         NPAGE = 0;
      112     9801    1         TSIZE_READ = 0;
      113     9802    1         LOOP = ( IN_PROG + PAGE_SIZE - 1 ) / PAGE_SIZE - 1;
      114     9803    1         WHERE$ = START$;
      115     9804    1         A_SIZE = AREA_SIZE;
      116     9805    1         IF CURR$ -> VY$NODE.L_START_A$(RTYPE) = ADDR(NIL) THEN
      117     9806    1             CURR$ -> VY$NODE.L_START_A$(RTYPE) = WHERE$;
      118     9807    1         CURR$ -> VY$NODE.L_PREV_SIZE_A(RTYPE) = CURR$ -> VY$NODE.L_SIZE_A(RTYPE);
              9807                  /* Set previous size as current */
      119     9808    2         DO I = 0 TO LOOP;
      120     9809    2             CALL VYK$KEY( KEY, RTYPE, CURR$ -> VY$NODE.NUM, I );
      121     9810    2             SIZE = PAGE_SIZE;
      122     9811    2             IF IN_PROG < PAGE_SIZE THEN SIZE = IN_PROG;
      123     9812    2   RETRY:
      124     9813    3             IF A_SIZE < SIZE AND ( FILE_TYPE = 1/*@RF*/ OR ( FILE_TYPE = 0/*@OF*/ AND
              9813                      RTYPE = 3/*@SC*/ ) ) THEN DO;
      125     9814    3                 J = SIZE - A_SIZE;
      126     9815                      %ALLOCATE(
      127     9816                      PTR$=R$,
      128     9817                      TYPE=DS,
      129     9818                      SIZE=J);
      130     9825    3                 AREA_SIZE = AREA_SIZE + J;
      131     9826    3                 A_SIZE = A_SIZE + J;
      132     9827    3                END;
      133     9828    2             CALL VYI$READ( FILE, WHERE$, SIZE, KEY, '0'B ) ALTRET( IO_ERROR );
      134     9829    2             IF RTYPE <= 2/*@RN*/ AND FILE_TYPE ~= 1/*@RF*/ THEN SIZE_READ = SIZE;
      135     9830    2             ELSE SIZE_READ = VY_IO_SIZEW;
      136     9831    3             IF KEY ~= 1/*@RF*/ THEN DO;
      137     9832    4                 DO CASE( VY_COMMAND );
      138     9833    4                   CASE( 3/*@C_COPY_KEY_WORD*/,
      139     9834    4                         4/*@C_EXTRACT_KEY_WORD*/ );
      140     9835    4                     VY_OL_KEY_BUF = VY_O_KEY_BUF;
      141     9836    4                     VY_OL_KEY_BUF.FORM1.UTS = VY_OU_HEAD.UTS;
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:13   
      142     9837    4                     CALL VYI$WRITE( 1/*@RF*/, WHERE$, VY_IO_SIZEW, 3/*@NEW_KEY*/ );
      143     9838    4                   END;                    /* Do case( VY_COMMAND ); */
      144     9839    3                END;
      145     9840    3             IF SIZE_READ ~= SIZE THEN DO; /* Error */
      146     9841    4                 IF FILE ~= 1/*@RF*/ AND RTYPE ~= 3/*@SC*/ THEN DO;
      147     9842        /*E*  ERROR: VYU-E$SHORT_REC_VY-0
      148     9843              MESSAGE: Object language error. Record size < page size.
      149     9844              DESCRIPTION: Self-explanatory.
      150     9845        */
      151     9846                          %SCREAM( ERR#=%E$SHORT_REC_VY, MID="'U'", LEVEL=%@E$S_VY );
      152     9849
      153     9850        /*E*  ERROR: VYU-E$SHORT_REC_CONT_VY-0
      154     9851              MESSAGE: Page size(words) = %U1; Actual record size(words) = %U2.
      155     9852              DESCRIPTION: Self-explanatory.
      156     9853        */
      157     9854                          %NUMBER( NUM1=SIZE, NUM2=VY_IO_SIZEW );
      158     9871                          %SCREAM(ERR#=%E$SHORT_REC_CONT_VY, MID="'U'", LEVEL=%@E$S_VY);
      159     9874    4                     CALL TELL_PAGE_TYPE( I, 3 );
      160     9875    4                    END;
      161     9876    3                END;
      162     9877    2             WHERE$ = PINCRW( WHERE$, SIZE_READ   );
      163     9878    2             A_SIZE = A_SIZE - SIZE_READ;
      164     9879    2             IN_PROG = IN_PROG - SIZE;
      165     9880    2             TSIZE_READ = TSIZE_READ + SIZE_READ;
      166     9881    2             NPAGE = NPAGE + 1;
      167     9882    2            END;                           /* Do i = 0 to loop */
      168     9883
      169     9884        %EJECT;
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:14   
      170     9885    2         DO WHILE( '0'B );                 /* Read failed */
      171     9886                                        /* Code executed only by altret from VXI$READ */
      172     9887    2   IO_ERROR:
      173     9888    3             DO CASE( VY_IO_STATUS );
      174     9889    3               CASE( 0/*@IO_EOF*/ );
      175     9890        /*E*  ERROR: VYU-E$UNEXPECTED_EOF_VY-0
      176     9891              MESSAGE: Object language error. Unexpected end of file condition.
      177     9892              DESCRIPTION: Self-explanatory.
      178     9893        */
      179     9894                      %SCREAM( ERR#=%E$UNEXPECTED_EOF_VY, LEVEL=%@E$F_D_VY, MID="'U'" );
      180     9897    3                 CALL TELL_PAGE_TYPE( NPAGE, 4 );
      181     9898    3               CASE( 1/*@IO_NOKEY*/);
      182     9899    3                 IF FILE = 1/*@RF*/  AND  (RTYPE >= 1/*@DN*/  AND  RTYPE <= 9/*@SR*/ )
      183     9900    4                 THEN DO;
      184     9901    4                     IF TSIZE_READ = 0 THEN RETURN;
      185     9902    4                     ELSE ;                /* Read error is ok */
      186     9903    4                    END;
      187     9904    3                 ELSE
      188     9905    3                     IF FILE = 0/*@OF*/ AND RTYPE = 3/*@SC*/  AND  NPAGE > 0
      189     9906    3                     THEN ;                /* Read error is ok */
      190     9907    4                     ELSE DO;
      191     9908        /*E*  ERROR: VYU-E$UNEXPECTED_NOKEY_VY-0
      192     9909              MESSAGE: Object language error. Unexpected no such key condition.
      193     9910              DESCRIPTION: Self-explanatory.
      194     9911        */
      195     9912                              %SCREAM(
      196     9913                              ERR#=%E$UNEXPECTED_NOKEY_VY,
      197     9914                              MID="'U'", LEVEL=%@E$F_D_VY );
      198     9917    4                         CALL TELL_PAGE_TYPE( NPAGE, 4 );
      199     9918    4                        END;
      200     9919    3               CASE( 2/*@IO_LD*/ );
      201     9920    3                 IF ( FILE = 1/*@RF*/ AND
      202     9921    3                         ( RTYPE = 3/*@SC*/ OR RTYPE = 2/*@RN*/ OR RTYPE = 5/*@ER*/
      203     9922    3                         OR RTYPE = 7/*@DR*/ OR RTYPE = 9/*@SR*/ )  )
      204     9923    3                         OR
      205     9924    3                         ( FILE = 0/*@OF*/ AND RTYPE = 3/*@SC*/ )
      206     9925    4                 THEN DO;
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:15   
      207     9926    4                     SIZE = SIZE + SIZE;
      208     9927    4                     GOTO RETRY;
      209     9928    4                    END;
      210     9929    4                 ELSE DO;                  /* Error */
      211     9930        /*E*  ERROR: VYU-E$UNEXPECTED_LD_VY-0
      212     9931              MESSAGE: Object language error. Unexpected lost data condition.
      213     9932              DESCRIPTION: Self-explanatory.
      214     9933        */
      215     9934                          %SCREAM( ERR#=%E$UNEXPECTED_LD_VY, MID="'U'", LEVEL=%@E$F_D_VY);
      216     9937    4                     CALL TELL_PAGE_TYPE( NPAGE, 4 );
      217     9938    4                    END;
      218     9939    3               END;                        /* Do case( VX_IO_STATUS ); */
      219     9940    2            END;                           /* Do never */
      220     9941        %EJECT;
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:16   
      221     9942    1         ENT_SIZE = VY_REC_SIZE_A(RTYPE);
      222     9943    1         IF RTYPE = 3/*@SC*/ AND FILE_TYPE = 0/*@OF*/ THEN ENT_SIZE = 2;
      223     9944    1         CURR$ -> VY$NODE.L_SIZE_A(RTYPE) = CURR$ -> VY$NODE.L_SIZE_A(RTYPE) +
              9944                  TSIZE_READ; /* Accumulate total size read */
      224     9945    1         CURR$ -> VY$NODE.L_STOP_A$(RTYPE) =
      225     9946    1                 PINCRW( START$, TSIZE_READ - ENT_SIZE );
      226     9947
      227     9948    2         IF RTYPE >= 3/*@SC*/ AND RTYPE <= 9/*@SR*/ THEN DO;
      228     9949    2             NAME_X = VY_MATCH_NAME_A(RTYPE);
      229     9950    2             NAME$  = PINCRW( CURR$ -> VY$NODE.L_START_A$(NAME_X),
      230     9951    2                     CURR$ -> VY$NODE.L_PREV_SIZE_A(NAME_X) );
      231     9952    2             NAME_INX = VY_NAME_DISP_A(RTYPE);
      232     9953    2             CURR_NAME_SIZE = CURR$ -> VY$NODE.L_SIZE_A(NAME_X)
      233     9954    2                     -
      234     9955    2                     CURR$ -> VY$NODE.L_PREV_SIZE_A(NAME_X);
      235     9956    2             P$ = START$;
      236     9957    3             IF FILE = 1/*@RF*/ AND FILE_TYPE = 1/*@RF*/ THEN DO;
      237     9958    4                 DO WHILE( P$ < WHERE$ );
      238     9959    4                     NAME_DISP = P$ -> VYD$TMPLT.A_SBIN(NAME_INX);
      239     9960    5                     IF NAME_DISP >= 0 THEN DO;
      240     9961    5                         IF NAME_DISP > CURR_NAME_SIZE THEN CALL OUT_OF_RANGE;
      241     9962    5                        END;               /* If NAME_DISP >= 0 then do; */
      242     9963    4                     ELSE IF RTYPE ~= 3/*@SC*/ THEN CALL OUT_OF_RANGE;
      243     9964        /**/
      244     9965    4                     P$ = PINCRW( P$, ENT_SIZE );
      245     9966    4                    END;                   /* Do while( P$ < WHERE$ ); */
      246     9967        /**/
      247     9968    3                END;               /* If file = @RF and FILE_TYPE = @RF then do; */
      248     9969    3             ELSE DO;
      249     9970        /**/
      250     9971        /**/
      251     9972        /**/
      252     9973    3                 LAST_NAME_SIZE = CURR$ -> VY$NODE.L_PREV_SIZE_A(NAME_X);
      253     9974    4                 DO WHILE ( P$ <  WHERE$ );
      254     9975    4                     NAME_DISP = P$ -> VYD$TMPLT.A_SBIN(NAME_INX);
      255     9976    5                     IF NAME_DISP >= 0 THEN DO; /* A real name */
      256     9977    5                         IF NAME_DISP > CURR_NAME_SIZE THEN
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:17   
      257     9978    5                             CALL OUT_OF_RANGE; /* ERROR: Out of bounds */
      258     9979    5                         Q$ = PINCRW( NAME$, NAME_DISP );
      259     9980    5                         J = Q$ -> B$DNAME.COUNT; /* Get size */
      260     9981    5                         P$ -> VYD$TMPLT.A(NAME_INX)  = NAME_DISP + LAST_NAME_SIZE;
      261     9982    5                        END;
      262     9983    4                     ELSE IF RTYPE ~= 3/*@SC*/ THEN CALL OUT_OF_RANGE;
      263     9984    5                     IF SOURCE >= 0 THEN DO;
      264     9985    6                         DO CASE( RTYPE );
      265     9986    6                           CASE( 6/*@DD*/, 8/*@SD*/ );
      266     9987    7                             IF P$ -> VYD$TMPLT.I.C THEN DO;
      267     9988    7                                 P$ -> VYD$TMPLT.I.MULTIPLY = '0'B/*@NO_B*/;
      268     9989    7                                 P$ -> VYD$TMPLT.I.WHERE_C = SOURCE;
      269     9990    7                                 P$ -> VYD$TMPLT.I.IS_DCB.DCB_BIT = '0'B/*@FALSE_B*/;
      270     9991    7                                END;
      271     9992    6                             ELSE GOTO CHECK_DEFINED;
      272     9993    6                           CASE( 4/*@ED*/ );
      273     9994    6   CHECK_DEFINED:
      274     9995    6                             P$ -> VYD$TMPLT.I.WHERE = SOURCE;
      275     9996    6                             P$ -> VYD$TMPLT.I.B.MULTIPLY = '0'B/*@NO_B*/;
      276     9997    6                           END;
      277     9998
      278     9999    5                        END;
      279    10000    4                     P$ = PINCRW( P$, ENT_SIZE );
      280    10001    4                    END;
      281    10002    3                END;   /* Else do; - if file  = @RF and FILE_TYPE = @RF then do; */
      282    10003    2            END;
      283    10004        %EJECT;
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:18   
      284    10005    1   BAD_NAME_SIZE: PROC( NAME_SIZE );
      285    10006
      286    10007    2   DCL NAME_SIZE UBIN;
      287    10008
      288    10009        /*E*  ERROR: VYU-E$NAME_COUNT_VY-0
      289    10010              MESSAGE: Object language error. Range error on name size. Value = %U1.
      290    10011              DESCRIPTION: Self-explanatory.
      291    10012        */
      292    10013
      293    10014              %NUMBER( NUM1=NAME_SIZE, SIZE1=12, BASE1=10 );
      294    10031
      295    10032              %SCREAM( ERR#=%E$NAME_COUNT_VY, MID="'U'", LEVEL=%@E$F_D_VY );
      296    10035
      297    10036    2         K = POFFW( P$, START$ ) / PAGE_SIZE;
      298    10037
      299    10038    2         CALL TELL_PAGE_TYPE( K, 4 );
      300    10039
      301    10040    2   END BAD_NAME_SIZE;
      302    10041
      303    10042        %EJECT;
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:19   
      304    10043    1   OUT_OF_RANGE: PROC;
      305    10044
      306    10045        /*E*  ERROR: VYU-E$NAME_RANGE_VY-0
      307    10046              MESSAGE: Object language error. Name displacement is out of bounds.
      308    10047              DESCRIPTION: Self-explantory.
      309    10048        */
      310    10049
      311    10050              %SCREAM( ERR#=%E$NAME_RANGE_VY, MID="'U'", LEVEL=%@E$F_D_VY );
      312    10053
      313    10054    2         CALL DISPLAY_RANGE( CURR_NAME_SIZE, NAME_DISP );
      314    10055
      315    10056    2   END OUT_OF_RANGE;
      316    10057
      317    10058        %EJECT;
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:20   
      318    10059    1   DISPLAY_RANGE: PROC( RANGE#, ACCESS );
      319    10060
      320    10061    2   DCL RANGE# UBIN;
      321    10062    2   DCL ACCESS UBIN;
      322    10063
      323    10064        /*E*  ERROR: VYU-E$DISPLAY_NAME_RANGE_VY-0
      324    10065              MESSAGE: Permissible range: 0 - %U1. Attempted access = %U2.
      325    10066              DESCRIPTION: Self-explanatory.
      326    10067        */
      327    10068
      328    10069              %NUMBER(
      329    10070                      NUM1=RANGE#, SIZE1=6, BASE1=10,
      330    10071                      NUM2=ACCESS, SIZE2=6, BASE2=10 );
      331    10088
      332    10089              %SCREAM( ERR#=%E$DISPLAY_NAME_RANGE_VY, MID="'U'", LEVEL=%@E$F_D_VY );
      333    10092
      334    10093    2         K = POFFW( P$, START$ ) / PAGE_SIZE;
      335    10094
      336    10095    2         CALL TELL_PAGE_TYPE( K, 4 );
      337    10096
      338    10097    2   END DISPLAY_RANGE;
      339    10098
      340    10099        %EJECT;
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:21   
      341    10100    1   TELL_PAGE_TYPE: PROC( PAGE#, SEVERITY );
      342    10101
      343    10102    2   DCL PAGE#    UBIN;
      344    10103    2   DCL SEVERITY UBIN;
      345    10104
      346    10105        /*E*  ERROR: VYU-E$IN_PAGE_OF_REC_TYPE_VY-0
      347    10106              MESSAGE: The error occured in page %U1 of record type %U2.
      348    10107              DESCRIPTION: Self-explanatory.
      349    10108        */
      350    10109
      351    10110              %NUMBER(
      352    10111                      NUM1=PAGE#, SIZE1=3, BASE1=10,
      353    10112                      NUM2=RTYPE, SIZE2=3, BASE2=10 );
      354    10129
      355    10130              %SCREAM( ERR#=%E$IN_PAGE_OF_REC_TYPE_VY, MID="'U'", LEVEL=SEVERITY,
      356    10131                       AUX=%@E$OUOF_VY );
      357    10134        /*
      358    10135                       Note that if severity = 4 the above call to VYE$ERROR will
      359    10136                       cause VYE$ERROR to unwind to VYM$MAIN:RESTART
      360    10137        */
      361    10138    2   END TELL_PAGE_TYPE;
      362    10139
      363    10140
      364    10141    1   END VYU$PREAD;

PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:22   
--  Include file information  --

   VY_PSUBS_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   VY_DCB_R.:E05TOU  cannot be made into a system file and is referenced.
   VY_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VY_FIXED_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VY_MACRO_C.:E05TOU  is referenced.
   VY_PERR_C.:E05TOU  is referenced.
   VY_SUBS_C.:E05TOU  is referenced.
   VY_INC_NO_C.:E05TOU  is referenced.
   VY_SWITCH_C.:E05TOU  is referenced.
   VY_INC_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VYU$PREAD.

   Procedure VYU$PREAD requires 606 words for executable code.
   Procedure VYU$PREAD requires 32 words of local(AUTO) storage.

    No errors detected in file VYU$PREAD.:E05TSI    .

PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:23   

 Object Unit name= VYU$PREAD                                  File name= VYU$PREAD.:E05TOU
 UTS= JUL 30 '97 09:05:25.72 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    29     35  VYU$PREAD
    2   Proc  even  none   606   1136  VYU$PREAD
    3  RoData even  none    81    121  VYU$PREAD

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std       12  VYU$PREAD

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       4 VYK$KEY
         yes           Std       3 VYA$GET
 yes     yes           Std       5 VYI$READ
 yes     yes           Std       5 VYI$WRITE
         yes           Std       4 VYE$ERROR
         yes           Std       5 VYD$B2C
                       nStd      0 X66_AUTO_N
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:24   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  VY_O_KEY_BUF                          VY_OL_KEY_BUF
     VY_OU_HEAD                            VY_COMMAND                            VY_ERRORS
     VY_M_FREE                             VY_M_ALL                              VY_M_BASE_PTR
     VY_EFIELD1                            VY_EFIELD2                            VY_IO_STATUS
     VY_IO_SIZEW                      r    VY_REC_SIZE_A                    r    VY_MATCH_NAME_A
r    VY_NAME_DISP_A                        VY_PAR_UNWIND                         B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:25   


        1        1       /*M* VYU$PREAD - To read page records of types 1 through 9 from object files and run
                 1         files*/
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=6,IND=4,CSU=2,EXM=0,ECU=2,MOC,DCI=4,CRT=4,CTI=8,CCC */
        8        8        /*F* NAME:        VYU$PREAD
        9        9         PURPOSE:    To read page records of types 1 through 9 from object files and run fi
                 9        les.
       10       10             Description:
       11       11            VYU$PREAD is passed eleven arguments of which the first two are returned
       12       12            variables while the remaining nine are value parameters. Npage is a returned
       13       13            variable which contains the number of pages read for the type of record.
       14       14            TSIZE_READ is a variable which returns the number of words read for the
       15       15            type of record.  File is a passed variable which indicates which dcb the
       16       16            read(s) are to be done through. FILE_TYPE is a passed variable which
       17       17            indicates which file organization is assumed either an object file or a run
       18       18            file. Rtype is the record type; RANGE: 0-9. START$ is the locator which
       19       19            points at the initial area in which the records are to be placed. PAGE_SIZE
       20       20            is the size in words of all records for this type except possibly the last.
       21       21            Tsize is the total size in words of all records for this type(rtype).
       22       22            Ds is the internal data segment identifier in which the records are
       23       23            are to be placed. CURR_P$ is a pointer to the node which owns these records.
       24       24            SOURCE_P is a variable which labels the records as to their origin(library,
       25       25            object, shared library, etc.).
       26       26            VYU$PREAD reads paged records for a given type and makes them suitable for
       27       27            further processing. This is accomplished by updating name pointers where
       28       28            appropriate (and doing some verification that indeed the name displacements
       29       29            locate valid name strings).  Definition entrys which are virgin(i.e. Not
       30       30            defined) are bound to their proper section declaration and all linker flags
       31       31            for them are reset. Various integrity and consistency checks are performed
       32       32            to ensure the soundness of the link process.      */
       33       33        VYU$PREAD:
       34       34              PROC(
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:26   

     34  2 000000   000000 700200 xent  VYU$PREAD    TSX0  ! X66_AUTO_N
         2 000001   000040 000014                    ZERO    32,12

       35       35                      NPAGE,                    /* # of pages read-inc by 1 each read */
       36       36                      TSIZE_READ,               /* Total word size read */
       37       37                      FILE,                     /* Dcb to read thru */
       38       38                      FILE_TYPE,                /*  File type */
       39       39                      RTYPE,                    /* Record type */
       40       40                      START$,                   /* Beginning of area to read into */
       41       41                      PAGE_SIZE,                /* Page size */
       42       42                      TSIZE,                    /* Total size to read */
       43       43                      DS,                       /* Data SEGMENT/INTERNAL# */
       44       44                      AREA_SIZE,                /* Initial area size allocated */
       45       45                      CURR_P$,                  /* Current node */
       46       46                      SOURCE_P)   ALTRET;       /* From whence it came */
       47       47        /**/
       48       48        /**/
       49       49        /**/
       50       50        %INCLUDE VY_INC_C;
       51     9226              %VY$NODE;

              9238    1   /*******************************************************************************
              9239    1   *                                                                              *
              9240    1   *                          VY$NODE                                                *
              9241    1   *                                                                              *
              9242    1   *******************************************************************************/

              9258    1   DCL 1 VY$NODE      ALIGNED    BASED,
              9259    1         2 SON$ PTR /*(ADDR(NIL))*/, /* Son pointer                      */
              9260    1         2 BROTHER$ PTR /*(ADDR(NIL))*/, /* Brother pointer              */
              9261    1         2 FATHER$ PTR /*(ADDR(NIL))*/, /* Father pointer                */
              9262    1         2 PATH$ PTR /*(ADDR(NIL))*/, /* Path   pointer                  */
              9263    1         2 HEAD$       PTR /*(ADDR(NIL))*/, /* Head pointer to
              9264                              to list of file nodes for this node            */
              9265    1         2 TAIL$ PTR /*(ADDR(NIL))*/, /* Tail pointer to list            */
              9266    1         2 SHARED_LIB_HEAD$ PTR /*(ADDR(NIL))*/,
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:27   
              9266                  /* Head pointer to shared library list */
              9267    1         2 LIB_HEAD$         PTR /*(ADDR(NIL))*/,
              9267                  /* Head pointer to list of shared libraries
              9268                                          which have been mapped to included libraries */
              9269    1         2 NUM          UBIN(36)  UNAL,    /* Node number                        */
              9270    1         2 DEPTH          UBIN(36)  UNAL,  /* Depth; ROOT=0*/
              9271    1         2 ADDR_START_A(0:2/*@ROS*/) SBIN WORD /*(0*3)*/, /* Array            */
              9272    1         2 ADDR_START REDEF  ADDR_START_A,
              9273    1           3 RDATA       SBIN WORD,   /* First address for this node in data     */
              9274    1           3 RPROC       SBIN WORD,   /* First address for this node in proc     */
              9275    1           3 ROS       SBIN WORD,          /* Last address for program in ros    */
              9276    1         2 ADDR_STOP_A(0:2/*@ROS*/) SBIN WORD /*(-1*3)*/, /* Array            */
              9277    1         2 ADDR_STOP  REDEF  ADDR_STOP_A,
              9278    1           3 RDATA       SBIN WORD,        /* Last address for this node in data */
              9279    1           3 RPROC       SBIN WORD,        /* Last address for this node in proc */
              9280    1           3 ROS       SBIN WORD,          /* Last address for program in ros    */
              9281    1         2 START_PAGE#_A(0:2/*@ROS*/) SBIN WORD /*(0*3)*/, /* Array           */
              9282    1         2 START_PAGE# REDEF START_PAGE#_A,
              9283    1           3 RDATA       SBIN WORD,   /* First page    for this node in data     */
              9284    1           3 RPROC       SBIN WORD,   /* First page    for this node in proc     */
              9285    1           3 ROS       SBIN WORD,          /* First page   for program in ros    */
              9286    1         2 STOP_PAGE#_A(0:2/*@ROS*/) SBIN WORD /*(-1*3)*/, /* Array*/
              9287    1         2 STOP_PAGE#  REDEF STOP_PAGE#_A,
              9288    1           3 RDATA       SBIN WORD,   /* Last  page    for this node in data     */
              9289    1           3 RPROC       SBIN WORD,   /* Last  page    for this node in proc     */
              9290    1           3 ROS       SBIN WORD,          /* Last  page   for program in ros    */
              9291    1         2 START_SC_ALL$ PTR /*(ADDR(NIL))*/,
              9291                  /* Starting pointer for common sections for this node */
              9292    1         2 STOP_SC_ALL$ PTR /*(ADDR(NIL))*/,
              9292                  /* Stopping pointer for common sections for this node */
              9293    1         2 L_START,
              9294    1           3 SN$ PTR /*(ADDR(NIL))*/, /* Segment definition names        */
              9295    1           3 DN$ PTR /*(ADDR(NIL))*/, /* Def names                       */
              9296    1           3 RN$ PTR /*(ADDR(NIL))*/, /* Ref names                       */
              9297    1           3 SC$ PTR /*(ADDR(NIL))*/, /* Sections                        */
              9298    1           3 ED$ PTR /*(ADDR(NIL))*/, /* Entry defs*/
              9299    1           3 ER$ PTR /*(ADDR(NIL))*/, /* Entry refs*/
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:28   
              9300    1           3 DD$ PTR /*(ADDR(NIL))*/, /* Data defs                       */
              9301    1           3 DR$ PTR /*(ADDR(NIL))*/, /* Data refs                       */
              9302    1           3 SD$ PTR /*(ADDR(NIL))*/, /* Seg defs                        */
              9303    1           3 SR$ PTR /*(ADDR(NIL))*/, /* Seg refs                        */
              9304    1         2 L_START_A$(0:9)     REDEF L_START PTR,
              9305    1         2 L_STOP,
              9306    1           3 SN$ PTR /*(ADDR(NIL))*/, /* Segment definition names        */
              9307    1           3 DN$ PTR /*(ADDR(NIL))*/, /* Def names                       */
              9308    1           3 RN$ PTR /*(ADDR(NIL))*/, /* Ref names                       */
              9309    1           3 SC$ PTR /*(ADDR(NIL))*/, /* Sections                        */
              9310    1           3 ED$ PTR /*(ADDR(NIL))*/, /* Entry defs*/
              9311    1           3 ER$ PTR /*(ADDR(NIL))*/, /* Entry refs*/
              9312    1           3 DD$ PTR /*(ADDR(NIL))*/, /* Data defs                       */
              9313    1           3 DR$ PTR /*(ADDR(NIL))*/, /* Data refs                       */
              9314    1           3 SD$ PTR /*(ADDR(NIL))*/, /* Seg defs                        */
              9315    1           3 SR$ PTR /*(ADDR(NIL))*/, /* Seg refs                        */
              9316    1         2 L_STOP_A$(0:9) REDEF   L_STOP    PTR,
              9317    1         2 L_SIZE,
              9318    1           3 SN      UBIN /*(0)*/, /* Segment definition names           */
              9319    1           3 DN      UBIN /*(0)*/, /* Def names                          */
              9320    1           3 RN      UBIN /*(0)*/, /* Ref names                          */
              9321    1           3 SC      UBIN /*(0)*/, /* Sections                           */
              9322    1           3 ED      UBIN /*(0)*/, /* Entry defs*/
              9323    1           3 ER      UBIN /*(0)*/, /* Entry refs*/
              9324    1           3 DD      UBIN /*(0)*/, /* Data defs                          */
              9325    1           3 DR      UBIN /*(0)*/, /* Data refs                          */
              9326    1           3 SD      UBIN /*(0)*/, /* Seg defs                           */
              9327    1           3 SR      UBIN /*(0)*/, /* Seg refs                           */
              9328    1         2 L_SIZE_A(0:9)  REDEF   L_SIZE    UBIN,
              9329    1         2 L_PREV_SIZE,
              9330    1           3 SN      UBIN /*(0)*/, /* Segment definition names           */
              9331    1           3 DN      UBIN /*(0)*/, /* Def names                          */
              9332    1           3 RN      UBIN /*(0)*/, /* Ref names                          */
              9333    1           3 SC      UBIN /*(0)*/, /* Sections                           */
              9334    1           3 ED      UBIN /*(0)*/, /* Entry defs*/
              9335    1           3 ER      UBIN /*(0)*/, /* Entry refs*/
              9336    1           3 DD      UBIN /*(0)*/, /* Data defs                          */
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:29   
              9337    1           3 DR      UBIN /*(0)*/, /* Data refs                          */
              9338    1           3 SD      UBIN /*(0)*/, /* Seg defs                           */
              9339    1           3 SR      UBIN /*(0)*/, /* Seg refs                           */
              9340    1         2 L_PREV_SIZE_A(0:9)  REDEF   L_PREV_SIZE    UBIN,
              9341    1         2 BIT_MAP                ALIGNED,
              9342    1           3 DATA                  ALIGNED,
              9343    1             4 BITS(0:255)          BIT(1)    UNAL /*('0'B*256)*/,
              9344    1           3 RPROC                 ALIGNED,
              9345    1             4 BITS(0:255)          BIT(1)    UNAL /*('0'B*256)*/,
              9346    1           3 ROS                   ALIGNED,
              9347    1             4 BITS(0:255)          BIT(1)    UNAL /*('0'B*256)*/,
              9348    1         2 L_SC_START,
              9349    1           3 SC_BLK_COM$ PTR /*(ADDR(NIL))*/, /* Blank common            */
              9350    1           3 SC_ROOT_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Root labelled common */
              9351    1           3 SC_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Labelled common         */
              9352    1           3 SC_DCB$ PTR /*(ADDR(NIL))*/, /* Dcbs                        */
              9353    1         2 L_SC_START_A$(0:3)  REDEF L_SC_START PTR,
              9354    1         2 L_SC_STOP,
              9355    1           3 SC_BLK_COM$ PTR /*(ADDR(NIL))*/, /* Blank common            */
              9356    1           3 SC_ROOT_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Root labelled common */
              9357    1           3 SC_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Labelled common         */
              9358    1           3 SC_DCB$ PTR /*(ADDR(NIL))*/, /* Dcbs                        */
              9359    1         2 L_SC_STOP_A$(0:3)   REDEF L_SC_STOP  PTR,
              9360    1         2 PROMOTE_HEAD,
              9361    1           3 BLK_COM$              PTR /*(ADDR(NIL))*/,
              9362    1           3 LBL_COM$              PTR /*(ADDR(NIL))*/,
              9363    1         2 PROMOTE_HEAD_A$(0:1) REDEF PROMOTE_HEAD     PTR,
              9364    1         2 PROMOTE_TAIL,
              9365    1           3 BLK_COM$              PTR /*(ADDR(NIL))*/,
              9366    1           3 LBL_COM$              PTR /*(ADDR(NIL))*/,
              9367    1         2 PROMOTE_TAIL_A$(0:1) REDEF PROMOTE_TAIL     PTR,
              9368    1         2 HAVE_ASL          BIT(1)    UNAL /*('0'B)*/,
              9369    1         2 ALL_BLK_COM          BIT(1)    UNAL /*('0'B)*/,
              9370    1         2 *                 BIT(34)   UNAL /*('0'B)*/,
              9371    1         2 BLANK_COMMON$     PTR       ALIGNED /*(ADDR(NIL))*/;

       52     9375              %VY$SC;
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:30   

              9389    1   /*******************************************************************************
              9390    1   *                                                                              *
              9391    1   *                          VY$SC                                                 *
              9392    1   *                                                                              *
              9393    1   *******************************************************************************/

              9397    1   DCL 1 VY$SC               BASED     ALIGNED,
              9398    1         2 TYPE              UBIN(9)   UNAL,
              9399    1         2 EMPTY             BIT (1)   UNAL,
              9400    1         2 ATTR                        UNAL,
              9401    1           3 INT              UBIN(2)   UNAL,
              9402    1           3 SEGMENT          BIT(1)    UNAL,
              9403    1           3 ALL              BIT(1)    UNAL,
              9404    1           3 PRE_DCB          BIT(1) UNAL, /* '1'B => true; '0'B => false        */
              9405    1           3 MES_INIT         BIT (1)   UNAL,
              9406    1           3 ALIGN            UBIN(2)   UNAL,
              9407    1         2 ADDRESS           UBIN(18)  UNAL,
              9408    1         2 NAME_DISP         SBIN HALF UNAL,
              9409    1         2 SIZE              UBIN(18)  UNAL,
              9410    1         2 NODE#             UBIN(18)  UNAL,
              9411    1         2 COM_LINK          UBIN(18)  UNAL;

              9420    1   /*******************************************************************************
              9421    1   *                                                                              *
              9422    1   *                          VY$SECT                                                *
              9423    1   *                                                                              *
              9424    1   *******************************************************************************/

              9428    1   DCL 1 VY$SECT       BASED     ALIGNED,
              9429    1         2 TYPE              UBIN(9)   UNAL,
              9430    1         2 EMPTY             BIT (1)   UNAL,
              9431    1         2 ATTR                        UNAL,
              9432    1           3 INT              UBIN(2)  UNAL,
              9433    1           3 SEGMENT          BIT (1)  UNAL,
              9434    1           3 *                UBIN(3)  UNAL,
              9435    1           3 ALIGN            UBIN(2)  UNAL,
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:31   
              9436    1         2 SIZE              UBIN(18)  UNAL,
              9437    1         2 NAME_DISP         SBIN HALF UNAL,
              9438    1         2 SEG_NPOINTER      UBIN(18)  UNAL;
       53     9441              %VYD$TMPLT;

              9453    1   /*******************************************************************************
              9454    1   *                                                                              *
              9455    1   *                          VYD$TMPLT                                              *
              9456    1   *                                                                              *
              9457    1   *******************************************************************************/

              9462    1   DCL 1 VYD$TMPLT          ALIGNED BASED, /* Template for defs                  */
              9463    1         2 A(0:3)       UBIN(18)  UNAL,    /* Array ...                          */
              9464    1         2 A_SBIN(0:3) REDEF A    SBIN HALF UNAL,
              9465    1         2 I       REDEF     A,            /* Items                              */
              9466    1           3 WHERE        UBIN( 3) UNAL,   /* Source of def                      */
              9467                                                                /* Value from
              9468                                                                     0   object
              9469                                                                     1   library */
              9470    1           3 DEFINED      BIT( 1) UNAL,    /* Defined or not                     */
              9471    1           3 B                      UNAL,
              9472    1             4 MULTIPLY    BIT(1) UNAL,    /* Multiply defined                   */
              9473    1           3 SC#          UBIN(13) UNAL,   /* Section #                          */
              9474    1           3 AFTER        REDEF SC#      UNAL,
              9475    1             4 USED        BIT(1) UNAL,    /* Used or not                        */
              9476    1             4 *           BIT(12) UNAL,
              9477    1           3 OFFSET      UBIN(18) UNAL,    /* Offset/address                     */
              9478    1           3 NAME_DISP   UBIN(18) UNAL,    /* Displacement to name(in words)     */
              9479    1           3 NAME_DISP_SBIN REDEF NAME_DISP   SBIN HALF UNAL,
              9480    1           3 P           UBIN( 1) UNAL,    /* Primary entdef                     */
              9481    1           3 C REDEF P   BIT(  1) UNAL,    /* Constant bit for symdefs           */
              9482    1           3 A           UBIN( 1) UNAL,    /* Altret specified                   */
              9483    1          3 MULTIPLY REDEF A BIT(1) UNAL, /* Multiply defined for constant sym defs */
              9484    1           3 I           BIT(  1) UNAL,    /* Argument/parameter check           */
              9485    1           3 USED    REDEF I  BIT(1) UNAL, /* Used or not for constant sym defs  */
              9486    1           3 CST         UBIN( 4) UNAL,    /* Calling sequence type              */
              9487    1           3 WHERE_C REDEF CST UBIN(4) UNAL, /* Source of def for constant sym defs */
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:32   
              9488    1           3 NP          UBIN(11) UNAL,    /* # of parameters                    */
              9489    1           3 IS_DCB  REDEF     NP,
              9490    1             4 DCB_BIT     BIT(1)    UNAL,
              9491    1             4 *           BIT(10)   UNAL,
              9492    1         2 SEG REDEF A,
              9493    1           3 *             UBIN      UNAL,
              9494    1           3 NPOINTER      UBIN(18)  UNAL,
              9495    1           3 CONSTNT       BIT(1)    UNAL,
              9496    1           3 TYPE          UBIN(5)   UNAL,
              9497    1           3 SEGID         UBIN(12)  UNAL,
              9498    1         2 V REDEF A,
              9499    1           3 VALUE       UBIN(36) UNAL,    /* Value if C=1                       */
              9500    1           3 *           UBIN(36) UNAL,
              9501    1         2 S  REDEF  A,                    /* Value if C=1                       */
              9502    1           3 *         UBIN(24) UNAL,
              9503    1           3 SEGID     UBIN(12) UNAL,
              9504    1           3 *         UBIN     UNAL;
       54     9507        %SET LISTMAC='1'B;
       55     9508        %SET LISTSUB='1'B;
       56     9509        %SET LISTEXP='1'B;
       57     9510              %B$DNAME( NAME=B$DNAME, STCLASS=BASED );
              9511            %LSET STR='BASED        ';
              9512            %IF
              9513                '0'B;
              9515            %ELSE;
              9516                %LSET INIT=/*;
              9517            %ENDIF;
              9518    1   DCL 1 B$DNAME BASED ALIGNED,
              9519    1         2 COUNT UBIN HALF UNAL /*(SIZEC(' ')) /**/,
              9520                /*K*  COUNT is the number of characters in the name */
              9521            %IF
              9522                '0'B;
              9525            %ELSE;
              9526    1         2 TEXT CHAR(B$DNAME.COUNT) UNAL;
              9527            %ENDIF;
       58     9529              %P;
              9530        %LSET LISTDIR='0'B;
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:33   

              9537    1   /*******************************************************************************
              9538    1   *                                                                              *
              9539    1   *                          PARAMETERS                                             *
              9540    1   *                                                                              *
              9541    1   *******************************************************************************/

       59     9545    1   DCL NPAGE           UBIN(36)  ALIGNED;
       60     9546    1   DCL TSIZE_READ      UBIN(36)  ALIGNED;
       61     9547    1   DCL FILE            UBIN(36)  ALIGNED;
       62     9548    1   DCL FILE_TYPE       UBIN(36)  ALIGNED;
       63     9549    1   DCL RTYPE           UBIN(36)  ALIGNED;
       64     9550    1   DCL START$          PTR       ALIGNED;
       65     9551    1   DCL PAGE_SIZE       SBIN(36)  ALIGNED;
       66     9552    1   DCL TSIZE           UBIN(36)  ALIGNED;
       67     9553    1   DCL DS              UBIN(36)  ALIGNED;
       68     9554    1   DCL AREA_SIZE       UBIN(36)  ALIGNED;
       69     9555    1   DCL CURR_P$         PTR  ALIGNED;
       70     9556    1   DCL SOURCE_P        SBIN WORD ALIGNED;
       71     9557        %E;
              9558        %LSET LISTDIR='0'B;

              9565    1   /*******************************************************************************
              9566    1   *                                                                              *
              9567    1   *                          ENTRY                                                 *
              9568    1   *                                                                              *
              9569    1   *******************************************************************************/

       72     9573        %ENTRIES;
              9574    1   DCL VYE$ERROR       ENTRY(4);
              9575    1   DCL VYE$ERR         ENTRY(3);
              9576    1   DCL VYE$MERC        ENTRY;
              9577    1   DCL VYE$ERRMSG      ENTRY(1);
              9578    1   DCL VYR$READ        ENTRY( 3 ) ALTRET;
              9579    1   DCL VYW$WRITE       ENTRY( 3 ) ALTRET;
              9580    1   DCL VYW$WRITE_DO    ENTRY( 2 ) ALTRET;
              9581    1   DCL VYD$B2C         ENTRY( 5 );
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:34   
              9582    1   DCL VYD$C2B         ENTRY( 3 );
              9583    1   DCL VYA$GET         ENTRY( 3 );
              9584    1   DCL VYF$FREE        ENTRY( 3 );
              9585    1   DCL VYQ$SORT        ENTRY( 7 );
              9586    1   DCL VYY$YESNO       ENTRY( 1 );
       73     9588    1   DCL VYK$KEY         ENTRY(4);
       74     9589    1   DCL VYI$READ        ENTRY(5)  ALTRET;
       75     9590    1   DCL VYI$WRITE        ENTRY(5)  ALTRET;
       76     9591        %PTR;
              9592        %LSET LISTDIR='0'B;

              9599    1   /*******************************************************************************
              9600    1   *                                                                              *
              9601    1   *                          PTR                                                 *
              9602    1   *                                                                              *
              9603    1   *******************************************************************************/

       77     9607        %POINTER;
              9608    1   DCL P$         PTR       ALIGNED STATIC/*AUTO*/;
              9609    1   DCL Q$         PTR       ALIGNED STATIC/*AUTO*/;
              9610    1   DCL R$         PTR       ALIGNED STATIC/*AUTO*/;
       78     9612    1   DCL WHERE$               PTR  ALIGNED   STATIC/*AUTO*/;
       79     9613    1   DCL CURR$                PTR  ALIGNED   STATIC/*AUTO*/;
       80     9614    1   DCL NAME$                PTR  ALIGNED   STATIC/*AUTO*/;
       81     9615    1   DCL SECT$                PTR  ALIGNED   STATIC/*AUTO*/;
       82     9616        %U;
              9617        %LSET LISTDIR='0'B;

              9624    1   /*******************************************************************************
              9625    1   *                                                                              *
              9626    1   *                          UBIN                                                 *
              9627    1   *                                                                              *
              9628    1   *******************************************************************************/

       83     9632        %INDEX;
              9633    1   DCL I          UBIN(36) ALIGNED STATIC/*AUTO*/;
              9634    1   DCL SI REDEF I SBIN WORD ALIGNED;
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:35   
              9635    1   DCL J          UBIN(36) ALIGNED STATIC/*AUTO*/;
              9636    1   DCL SJ REDEF J SBIN WORD ALIGNED;
              9637    1   DCL K          UBIN(36) ALIGNED STATIC/*AUTO*/;
              9638    1   DCL SK REDEF K SBIN WORD ALIGNED;
              9639    1   DCL L          UBIN(36) ALIGNED STATIC/*AUTO*/;
              9640    1   DCL SL REDEF L    SBIN WORD ALIGNED;
       84     9642    1   DCL LOOP            UBIN(36)  ALIGNED   STATIC/*AUTO*/;
       85     9643    1   DCL IN_PROG         UBIN(36)  ALIGNED   STATIC/*AUTO*/;
       86     9644    1   DCL SIZE            UBIN(36)  ALIGNED   STATIC/*AUTO*/;
       87     9645    1   DCL SIZE_READ       UBIN(36)  ALIGNED   STATIC/*AUTO*/;
       88     9646    1   DCL DUMMY           UBIN(36)  ALIGNED   STATIC/*AUTO*/;
       89     9647    1   DCL ENT_SIZE        UBIN(36)  ALIGNED   STATIC/*AUTO*/;
       90     9648    1   DCL NAME_X          UBIN(36)  ALIGNED   STATIC/*AUTO*/;
       91     9649    1   DCL SC##            UBIN(36)  ALIGNED   STATIC/*AUTO*/;
       92     9650    1   DCL CURR_SC_ENTRIES UBIN(36)  ALIGNED   STATIC/*AUTO*/;
       93     9651    1   DCL KEY             UBIN(36)  ALIGNED   STATIC/*AUTO*/;
       94     9652    1   DCL NAME_INX        UBIN(36)  ALIGNED   STATIC/*AUTO*/;
       95     9653    1   DCL CURR_NAME_SIZE  UBIN(36)  ALIGNED   STATIC/*AUTO*/;
       96     9654    1   DCL LAST_NAME_SIZE  UBIN(36)  ALIGNED   STATIC/*AUTO*/;
       97     9655        %S;
              9656        %LSET LISTDIR='0'B;

              9663    1   /*******************************************************************************
              9664    1   *                                                                              *
              9665    1   *                          SBIN                                                 *
              9666    1   *                                                                              *
              9667    1   *******************************************************************************/

       98     9671    1   DCL A_SIZE          SBIN WORD ALIGNED   STATIC/*AUTO*/;
       99     9672    1   DCL NAME_DISP       SBIN WORD ALIGNED   STATIC/*AUTO*/;
      100     9673    1   DCL SOURCE          SBIN WORD ALIGNED   STATIC/*AUTO*/;
      101     9674    1   DCL ARS             SBIN WORD ALIGNED   STATIC/*AUTO*/;
      102     9675    1   DCL DIFF            SBIN WORD ALIGNED   STATIC/*AUTO*/;
      103     9676        %PLIST;
      104     9677        %F$DCB;
      105     9734        %INCLUDE VY_PSUBS_C;
      106     9795        %EJECT;
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:36   
      107     9796    1         CURR$ = CURR_P$;

   9796  2 000002   200015 470500                    LDP0    @CURR_P$,,AUTO
         2 000003   000000 236100                    LDQ     0,,PR0
         2 000004   000004 756000 1                  STQ     CURR$

      108     9797    1         SOURCE = SOURCE_P;

   9797  2 000005   200016 471500                    LDP1    @SOURCE_P,,AUTO
         2 000006   100000 235100                    LDA     0,,PR1
         2 000007   000032 755000 1                  STA     SOURCE

      109     9798    1         KEY = FILE_TYPE;

   9798  2 000010   200006 473500                    LDP3    @FILE_TYPE,,AUTO
         2 000011   300000 235100                    LDA     0,,PR3
         2 000012   000024 755000 1                  STA     KEY

      110     9799    1         IN_PROG = TSIZE;

   9799  2 000013   200012 474500                    LDP4    @TSIZE,,AUTO
         2 000014   400000 235100                    LDA     0,,PR4
         2 000015   000014 755000 1                  STA     IN_PROG

      111     9800    1         NPAGE = 0;

   9800  2 000016   200003 475500                    LDP5    @NPAGE,,AUTO
         2 000017   500000 450100                    STZ     0,,PR5

      112     9801    1         TSIZE_READ = 0;

   9801  2 000020   200004 476500                    LDP6    @TSIZE_READ,,AUTO
         2 000021   600000 450100                    STZ     0,,PR6

      113     9802    1         LOOP = ( IN_PROG + PAGE_SIZE - 1 ) / PAGE_SIZE - 1;

   9802  2 000022   200011 477500                    LDP7    @PAGE_SIZE,,AUTO
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:37   
         2 000023   000014 236000 1                  LDQ     IN_PROG
         2 000024   700000 036100                    ADLQ    0,,PR7
         2 000025   000001 136007                    SBLQ    1,DL
         2 000026   700000 506100                    DIV     0,,PR7
         2 000027   000001 136007                    SBLQ    1,DL
         2 000030   000013 756000 1                  STQ     LOOP

      114     9803    1         WHERE$ = START$;

   9803  2 000031   200010 470500                    LDP0    @START$,,AUTO
         2 000032   000000 236100                    LDQ     0,,PR0
         2 000033   000003 756000 1                  STQ     WHERE$

      115     9804    1         A_SIZE = AREA_SIZE;

   9804  2 000034   200014 470500                    LDP0    @AREA_SIZE,,AUTO
         2 000035   000000 235100                    LDA     0,,PR0
         2 000036   000030 755000 1                  STA     A_SIZE

      116     9805    1         IF CURR$ -> VY$NODE.L_START_A$(RTYPE) = ADDR(NIL) THEN

   9805  2 000037   200007 470500                    LDP0    @RTYPE,,AUTO
         2 000040   000000 720100                    LXL0    0,,PR0
         2 000041   000004 470400 1                  LDP0    CURR$
         2 000042   000030 236110                    LDQ     24,X0,PR0
         2 000043   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000044   000052 601000 2                  TNZ     s:9807

      117     9806    1             CURR$ -> VY$NODE.L_START_A$(RTYPE) = WHERE$;

   9806  2 000045   200007 470500                    LDP0    @RTYPE,,AUTO
         2 000046   000000 720100                    LXL0    0,,PR0
         2 000047   000003 236000 1                  LDQ     WHERE$
         2 000050   000004 470400 1                  LDP0    CURR$
         2 000051   000030 756110                    STQ     24,X0,PR0

      118     9807    1         CURR$ -> VY$NODE.L_PREV_SIZE_A(RTYPE) = CURR$ -> VY$NODE.L_SIZE_A(RTYPE);
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:38   
              9807                  /* Set previous size as current */

   9807  2 000052   200007 470500                    LDP0    @RTYPE,,AUTO
         2 000053   000000 720100                    LXL0    0,,PR0
         2 000054   000004 470400 1                  LDP0    CURR$
         2 000055   000054 235110                    LDA     44,X0,PR0
         2 000056   000066 755110                    STA     54,X0,PR0

      119     9808    2         DO I = 0 TO LOOP;

   9808  2 000057   000007 450000 1                  STZ     I
         2 000060   000332 710000 2                  TRA     s:9882+3

      120     9809    2             CALL VYK$KEY( KEY, RTYPE, CURR$ -> VY$NODE.NUM, I );

   9809  2 000061   000000 236000 3                  LDQ     0
         2 000062   200035 756100                    STQ     @SEVERITY+5,,AUTO
         2 000063   000004 236000 1                  LDQ     CURR$
         2 000064   000010 036003                    ADLQ    8,DU
         2 000065   200034 756100                    STQ     @SEVERITY+4,,AUTO
         2 000066   200007 236100                    LDQ     @RTYPE,,AUTO
         2 000067   000001 235000 3                  LDA     1
         2 000070   200032 757100                    STAQ    @SEVERITY+2,,AUTO
         2 000071   200032 630500                    EPPR0   @SEVERITY+2,,AUTO
         2 000072   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000073   000000 701000 xent               TSX1    VYK$KEY
         2 000074   000000 011000                    NOP     0

      121     9810    2             SIZE = PAGE_SIZE;

   9810  2 000075   200011 470500                    LDP0    @PAGE_SIZE,,AUTO
         2 000076   000000 235100                    LDA     0,,PR0
         2 000077   000015 755000 1                  STA     SIZE

      122     9811    2             IF IN_PROG < PAGE_SIZE THEN SIZE = IN_PROG;

   9811  2 000100   000014 236000 1                  LDQ     IN_PROG
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:39   
         2 000101   000105 604000 2                  TMI     RETRY
         2 000102   000000 116100                    CMPQ    0,,PR0
         2 000103   000105 605000 2                  TPL     RETRY

   9811  2 000104   000015 756000 1                  STQ     SIZE

      123     9812    2   RETRY:
      124     9813    3             IF A_SIZE < SIZE AND ( FILE_TYPE = 1/*@RF*/ OR ( FILE_TYPE = 0/*@OF*/ AND
              9813                      RTYPE = 3/*@SC*/ ) ) THEN DO;

   9813  2 000105   000030 236000 1     RETRY        LDQ     A_SIZE
         2 000106   000111 604000 2                  TMI     RETRY+4
         2 000107   000015 116000 1                  CMPQ    SIZE
         2 000110   000166 603000 2                  TRC     s:9828
         2 000111   200006 470500                    LDP0    @FILE_TYPE,,AUTO
         2 000112   000000 235100                    LDA     0,,PR0
         2 000113   000001 115007                    CMPA    1,DL
         2 000114   000123 600000 2                  TZE     s:9814
         2 000115   000000 115003                    CMPA    0,DU
         2 000116   000166 601000 2                  TNZ     s:9828
         2 000117   200007 471500                    LDP1    @RTYPE,,AUTO
         2 000120   100000 235100                    LDA     0,,PR1
         2 000121   000003 115007                    CMPA    3,DL
         2 000122   000166 601000 2                  TNZ     s:9828

      125     9814    3                 J = SIZE - A_SIZE;

   9814  2 000123   000015 236000 1                  LDQ     SIZE
         2 000124   000030 136000 1                  SBLQ    A_SIZE
         2 000125   000010 756000 1                  STQ     J

      126     9815                      %ALLOCATE(
      127     9816                      PTR$=R$,
      128     9817                      TYPE=DS,
      129     9818                      SIZE=J);

   9819  2 000126   200013 471500                    LDP1    @DS,,AUTO
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:40   
         2 000127   100000 720100                    LXL0    0,,PR1
         2 000130   000000 236010 xsym               LDQ     VY_M_ALL,X0
         2 000131   000000 136010 xsym               SBLQ    VY_M_FREE,X0
         2 000132   000146 604000 2                  TMI     s:9823
         2 000133   000010 116000 1                  CMPQ    J
         2 000134   000146 602000 2                  TNC     s:9823

   9820  2 000135   000000 236010 xsym               LDQ     VY_M_FREE,X0
         2 000136   000000 473410 xsym               LDP3    VY_M_BASE_PTR,X0
         2 000137   300000 634506                    EPPR4   0,QL,PR3
         2 000140   000002 454400 1                  STP4    R$

   9821  2 000141   100000 720100                    LXL0    0,,PR1
         2 000142   000000 236010 xsym               LDQ     VY_M_FREE,X0
         2 000143   000010 036000 1                  ADLQ    J
         2 000144   000000 756010 xsym               STQ     VY_M_FREE,X0

   9822  2 000145   000157 710000 2                  TRA     s:9825

   9823  2 000146   000002 236000 3                  LDQ     2
         2 000147   200034 756100                    STQ     @SEVERITY+4,,AUTO
         2 000150   200013 236100                    LDQ     @DS,,AUTO
         2 000151   000003 235000 3                  LDA     3
         2 000152   200032 757100                    STAQ    @SEVERITY+2,,AUTO
         2 000153   200032 630500                    EPPR0   @SEVERITY+2,,AUTO
         2 000154   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000155   000000 701000 xent               TSX1    VYA$GET
         2 000156   000000 011000                    NOP     0

      130     9825    3                 AREA_SIZE = AREA_SIZE + J;

   9825  2 000157   200014 470500                    LDP0    @AREA_SIZE,,AUTO
         2 000160   000000 236100                    LDQ     0,,PR0
         2 000161   000010 036000 1                  ADLQ    J
         2 000162   000000 756100                    STQ     0,,PR0

      131     9826    3                 A_SIZE = A_SIZE + J;
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:41   

   9826  2 000163   000030 236000 1                  LDQ     A_SIZE
         2 000164   000010 036000 1                  ADLQ    J
         2 000165   000030 756000 1                  STQ     A_SIZE

      132     9827    3                END;

      133     9828    2             CALL VYI$READ( FILE, WHERE$, SIZE, KEY, '0'B ) ALTRET( IO_ERROR );

   9828  2 000166   000004 236000 3                  LDQ     4
         2 000167   200036 756100                    STQ     @SEVERITY+6,,AUTO
         2 000170   000006 237000 3                  LDAQ    6
         2 000171   200034 757100                    STAQ    @SEVERITY+4,,AUTO
         2 000172   000010 236000 3                  LDQ     8
         2 000173   200005 235100                    LDA     @FILE,,AUTO
         2 000174   200032 757100                    STAQ    @SEVERITY+2,,AUTO
         2 000175   200032 630500                    EPPR0   @SEVERITY+2,,AUTO
         2 000176   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000177   000000 701000 xent               TSX1    VYI$READ
         2 000200   000336 702000 2                  TSX2    IO_ERROR

      134     9829    2             IF RTYPE <= 2/*@RN*/ AND FILE_TYPE ~= 1/*@RF*/ THEN SIZE_READ = SIZE;

   9829  2 000201   200007 470500                    LDP0    @RTYPE,,AUTO
         2 000202   000000 235100                    LDA     0,,PR0
         2 000203   000003 115007                    CMPA    3,DL
         2 000204   000214 603000 2                  TRC     s:9830
         2 000205   200006 471500                    LDP1    @FILE_TYPE,,AUTO
         2 000206   100000 235100                    LDA     0,,PR1
         2 000207   000001 115007                    CMPA    1,DL
         2 000210   000214 600000 2                  TZE     s:9830

   9829  2 000211   000015 236000 1                  LDQ     SIZE
         2 000212   000016 756000 1                  STQ     SIZE_READ
         2 000213   000216 710000 2                  TRA     s:9831

      135     9830    2             ELSE SIZE_READ = VY_IO_SIZEW;
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:42   

   9830  2 000214   000000 235000 xsym               LDA     VY_IO_SIZEW
         2 000215   000016 755000 1                  STA     SIZE_READ

      136     9831    3             IF KEY ~= 1/*@RF*/ THEN DO;

   9831  2 000216   000024 235000 1                  LDA     KEY
         2 000217   000001 115007                    CMPA    1,DL
         2 000220   000244 600000 2                  TZE     s:9840

      137     9832    4                 DO CASE( VY_COMMAND );

   9832  2 000221   000000 236000 xsym               LDQ     VY_COMMAND
         2 000222   000005 116007                    CMPQ    5,DL
         2 000223   000225 602006 2                  TNC     s:9832+4,QL
         2 000224   000244 710000 2                  TRA     s:9840
         2 000225   000244 710000 2                  TRA     s:9840
         2 000226   000244 710000 2                  TRA     s:9840
         2 000227   000244 710000 2                  TRA     s:9840
         2 000230   000232 710000 2                  TRA     s:9835
         2 000231   000232 710000 2                  TRA     s:9835

      138     9833    4                   CASE( 3/*@C_COPY_KEY_WORD*/,

      139     9834    4                         4/*@C_EXTRACT_KEY_WORD*/ );
      140     9835    4                     VY_OL_KEY_BUF = VY_O_KEY_BUF;

   9835  2 000232   000000 100400                    MLR     fill='000'O
         2 000233   000000 001001 xsym               ADSC9   VY_O_KEY_BUF             cn=0,n=513
         2 000234   000000 001001 xsym               ADSC9   VY_OL_KEY_BUF            cn=0,n=513

      141     9836    4                     VY_OL_KEY_BUF.FORM1.UTS = VY_OU_HEAD.UTS;

   9836  2 000235   000000 100400                    MLR     fill='000'O
         2 000236   000000 000004 xsym               ADSC9   VY_OU_HEAD               cn=0,n=4
         2 000237   000000 400004 xsym               ADSC9   VY_OL_KEY_BUF            cn=2,n=4

PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:43   
      142     9837    4                     CALL VYI$WRITE( 1/*@RF*/, WHERE$, VY_IO_SIZEW, 3/*@NEW_KEY*/ );

   9837  2 000240   000011 630400 3                  EPPR0   9
         2 000241   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000242   000000 701000 xent               TSX1    VYI$WRITE
         2 000243   000000 011000                    NOP     0

      143     9838    4                   END;                    /* Do case( VY_COMMAND ); */

      144     9839    3                END;

      145     9840    3             IF SIZE_READ ~= SIZE THEN DO; /* Error */

   9840  2 000244   000016 236000 1                  LDQ     SIZE_READ
         2 000245   000015 116000 1                  CMPQ    SIZE
         2 000246   000305 600000 2                  TZE     s:9877

      146     9841    4                 IF FILE ~= 1/*@RF*/ AND RTYPE ~= 3/*@SC*/ THEN DO;

   9841  2 000247   200005 470500                    LDP0    @FILE,,AUTO
         2 000250   000000 235100                    LDA     0,,PR0
         2 000251   000001 115007                    CMPA    1,DL
         2 000252   000305 600000 2                  TZE     s:9877
         2 000253   200007 471500                    LDP1    @RTYPE,,AUTO
         2 000254   100000 235100                    LDA     0,,PR1
         2 000255   000003 115007                    CMPA    3,DL
         2 000256   000305 600000 2                  TZE     s:9877

      147     9842        /*E*  ERROR: VYU-E$SHORT_REC_VY-0
      148     9843              MESSAGE: Object language error. Record size < page size.
      149     9844              DESCRIPTION: Self-explanatory.
      150     9845        */
      151     9846                          %SCREAM( ERR#=%E$SHORT_REC_VY, MID="'U'", LEVEL=%@E$S_VY );

   9847  2 000257   000017 630400 3                  EPPR0   15
         2 000260   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000261   000000 701000 xent               TSX1    VYE$ERROR
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:44   
         2 000262   000000 011000                    NOP     0

      152     9849
      153     9850        /*E*  ERROR: VYU-E$SHORT_REC_CONT_VY-0
      154     9851              MESSAGE: Page size(words) = %U1; Actual record size(words) = %U2.
      155     9852              DESCRIPTION: Self-explanatory.
      156     9853        */
      157     9854                          %NUMBER( NUM1=SIZE, NUM2=VY_IO_SIZEW );

   9860  2 000263   000023 630400 3                  EPPR0   19
         2 000264   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000265   000000 701000 xent               TSX1    VYD$B2C
         2 000266   000000 011000                    NOP     0

   9864  2 000267   000031 630400 3                  EPPR0   25
         2 000270   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000271   000000 701000 xent               TSX1    VYD$B2C
         2 000272   000000 011000                    NOP     0

      158     9871                          %SCREAM(ERR#=%E$SHORT_REC_CONT_VY, MID="'U'", LEVEL=%@E$S_VY);

   9872  2 000273   000037 630400 3                  EPPR0   31
         2 000274   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000275   000000 701000 xent               TSX1    VYE$ERROR
         2 000276   000000 011000                    NOP     0

      159     9874    4                     CALL TELL_PAGE_TYPE( I, 3 );

   9874  2 000277   000014 236000 3                  LDQ     12
         2 000300   200030 756100                    STQ     @PAGE#+1,,AUTO
         2 000301   000000 236000 3                  LDQ     0
         2 000302   200027 756100                    STQ     @ACCESS+3,,AUTO
         2 000303   001073 701000 2                  TSX1    TELL_PAGE_TYPE
         2 000304   000000 011000                    NOP     0

      160     9875    4                    END;

PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:45   
      161     9876    3                END;

      162     9877    2             WHERE$ = PINCRW( WHERE$, SIZE_READ   );

   9877  2 000305   000016 236000 1                  LDQ     SIZE_READ
         2 000306   000022 736000                    QLS     18
         2 000307   000003 036000 1                  ADLQ    WHERE$
         2 000310   000003 756000 1                  STQ     WHERE$

      163     9878    2             A_SIZE = A_SIZE - SIZE_READ;

   9878  2 000311   000030 236000 1                  LDQ     A_SIZE
         2 000312   000016 136000 1                  SBLQ    SIZE_READ
         2 000313   000030 756000 1                  STQ     A_SIZE

      164     9879    2             IN_PROG = IN_PROG - SIZE;

   9879  2 000314   000014 236000 1                  LDQ     IN_PROG
         2 000315   000015 136000 1                  SBLQ    SIZE
         2 000316   000014 756000 1                  STQ     IN_PROG

      165     9880    2             TSIZE_READ = TSIZE_READ + SIZE_READ;

   9880  2 000317   200004 470500                    LDP0    @TSIZE_READ,,AUTO
         2 000320   000000 236100                    LDQ     0,,PR0
         2 000321   000016 036000 1                  ADLQ    SIZE_READ
         2 000322   000000 756100                    STQ     0,,PR0

      166     9881    2             NPAGE = NPAGE + 1;

   9881  2 000323   200003 471500                    LDP1    @NPAGE,,AUTO
         2 000324   100000 235100                    LDA     0,,PR1
         2 000325   000001 035007                    ADLA    1,DL
         2 000326   100000 755100                    STA     0,,PR1

      167     9882    2            END;                           /* Do i = 0 to loop */

PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:46   
   9882  2 000327   000007 236000 1                  LDQ     I
         2 000330   000001 036007                    ADLQ    1,DL
         2 000331   000007 756000 1                  STQ     I
         2 000332   000013 236000 1                  LDQ     LOOP
         2 000333   000007 116000 1                  CMPQ    I
         2 000334   000061 603000 2                  TRC     s:9809

      168     9883
      169     9884        %EJECT;
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:47   
      170     9885    2         DO WHILE( '0'B );                 /* Read failed */

   9885  2 000335   000465 710000 2                  TRA     s:9942

      171     9886                                        /* Code executed only by altret from VXI$READ */
      172     9887    2   IO_ERROR:
      173     9888    3             DO CASE( VY_IO_STATUS );

   9888  2 000336   000000 235000 xsym  IO_ERROR     LDA     VY_IO_STATUS
         2 000337   000003 115007                    CMPA    3,DL
         2 000340   000342 602005 2                  TNC     IO_ERROR+4,AL
         2 000341   000465 710000 2                  TRA     s:9942
         2 000342   000345 710000 2                  TRA     s:9895
         2 000343   000360 710000 2                  TRA     s:9899
         2 000344   000421 710000 2                  TRA     s:9920

      174     9889    3               CASE( 0/*@IO_EOF*/ );

      175     9890        /*E*  ERROR: VYU-E$UNEXPECTED_EOF_VY-0
      176     9891              MESSAGE: Object language error. Unexpected end of file condition.
      177     9892              DESCRIPTION: Self-explanatory.
      178     9893        */
      179     9894                      %SCREAM( ERR#=%E$UNEXPECTED_EOF_VY, LEVEL=%@E$F_D_VY, MID="'U'" );

   9895  2 000345   000045 630400 3                  EPPR0   37
         2 000346   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000347   000000 701000 xent               TSX1    VYE$ERROR
         2 000350   000000 011000                    NOP     0

      180     9897    3                 CALL TELL_PAGE_TYPE( NPAGE, 4 );

   9897  2 000351   000051 236000 3                  LDQ     41
         2 000352   200030 756100                    STQ     @PAGE#+1,,AUTO
         2 000353   200003 236100                    LDQ     @NPAGE,,AUTO
         2 000354   200027 756100                    STQ     @ACCESS+3,,AUTO
         2 000355   001073 701000 2                  TSX1    TELL_PAGE_TYPE
         2 000356   000000 011000                    NOP     0
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:48   
         2 000357   000465 710000 2                  TRA     s:9942

      181     9898    3               CASE( 1/*@IO_NOKEY*/);

      182     9899    3                 IF FILE = 1/*@RF*/  AND  (RTYPE >= 1/*@DN*/  AND  RTYPE <= 9/*@SR*/ )

   9899  2 000360   200005 470500                    LDP0    @FILE,,AUTO
         2 000361   000000 235100                    LDA     0,,PR0
         2 000362   000001 115007                    CMPA    1,DL
         2 000363   000375 601000 2                  TNZ     s:9905
         2 000364   200007 471500                    LDP1    @RTYPE,,AUTO
         2 000365   100000 235100                    LDA     0,,PR1
         2 000366   000375 600000 2                  TZE     s:9905
         2 000367   000012 115007                    CMPA    10,DL
         2 000370   000375 603000 2                  TRC     s:9905

      183     9900    4                 THEN DO;

      184     9901    4                     IF TSIZE_READ = 0 THEN RETURN;

   9901  2 000371   200004 473500                    LDP3    @TSIZE_READ,,AUTO
         2 000372   300000 235100                    LDA     0,,PR3
         2 000373   000465 601000 2                  TNZ     s:9942

   9901  2 000374   000000 702200 xent               TSX2  ! X66_ARET

      185     9902    4                     ELSE ;                /* Read error is ok */
      186     9903    4                    END;
      187     9904    3                 ELSE
      188     9905    3                     IF FILE = 0/*@OF*/ AND RTYPE = 3/*@SC*/  AND  NPAGE > 0

   9905  2 000375   000000 235100                    LDA     0,,PR0
         2 000376   000406 601000 2                  TNZ     s:9915
         2 000377   200007 471500                    LDP1    @RTYPE,,AUTO
         2 000400   100000 235100                    LDA     0,,PR1
         2 000401   000003 115007                    CMPA    3,DL
         2 000402   000406 601000 2                  TNZ     s:9915
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:49   
         2 000403   200003 473500                    LDP3    @NPAGE,,AUTO
         2 000404   300000 235100                    LDA     0,,PR3
         2 000405   000465 601000 2                  TNZ     s:9942

      189     9906    3                     THEN ;                /* Read error is ok */
      190     9907    4                     ELSE DO;

      191     9908        /*E*  ERROR: VYU-E$UNEXPECTED_NOKEY_VY-0
      192     9909              MESSAGE: Object language error. Unexpected no such key condition.
      193     9910              DESCRIPTION: Self-explanatory.
      194     9911        */
      195     9912                              %SCREAM(
      196     9913                              ERR#=%E$UNEXPECTED_NOKEY_VY,
      197     9914                              MID="'U'", LEVEL=%@E$F_D_VY );

   9915  2 000406   000053 630400 3                  EPPR0   43
         2 000407   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000410   000000 701000 xent               TSX1    VYE$ERROR
         2 000411   000000 011000                    NOP     0

      198     9917    4                         CALL TELL_PAGE_TYPE( NPAGE, 4 );

   9917  2 000412   000051 236000 3                  LDQ     41
         2 000413   200030 756100                    STQ     @PAGE#+1,,AUTO
         2 000414   200003 236100                    LDQ     @NPAGE,,AUTO
         2 000415   200027 756100                    STQ     @ACCESS+3,,AUTO
         2 000416   001073 701000 2                  TSX1    TELL_PAGE_TYPE
         2 000417   000000 011000                    NOP     0

      199     9918    4                        END;

   9918  2 000420   000465 710000 2                  TRA     s:9942

      200     9919    3               CASE( 2/*@IO_LD*/ );

      201     9920    3                 IF ( FILE = 1/*@RF*/ AND

PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:50   
   9920  2 000421   200005 470500                    LDP0    @FILE,,AUTO
         2 000422   000000 235100                    LDA     0,,PR0
         2 000423   000001 115007                    CMPA    1,DL
         2 000424   000441 601000 2                  TNZ     s:9920+16
         2 000425   200007 471500                    LDP1    @RTYPE,,AUTO
         2 000426   100000 235100                    LDA     0,,PR1
         2 000427   000003 115007                    CMPA    3,DL
         2 000430   000447 600000 2                  TZE     s:9926
         2 000431   000002 115007                    CMPA    2,DL
         2 000432   000447 600000 2                  TZE     s:9926
         2 000433   000005 115007                    CMPA    5,DL
         2 000434   000447 600000 2                  TZE     s:9926
         2 000435   000007 115007                    CMPA    7,DL
         2 000436   000447 600000 2                  TZE     s:9926
         2 000437   000011 115007                    CMPA    9,DL
         2 000440   000447 600000 2                  TZE     s:9926
         2 000441   000000 235100                    LDA     0,,PR0
         2 000442   000453 601000 2                  TNZ     s:9935
         2 000443   200007 471500                    LDP1    @RTYPE,,AUTO
         2 000444   100000 235100                    LDA     0,,PR1
         2 000445   000003 115007                    CMPA    3,DL
         2 000446   000453 601000 2                  TNZ     s:9935

      202     9921    3                         ( RTYPE = 3/*@SC*/ OR RTYPE = 2/*@RN*/ OR RTYPE = 5/*@ER*/
      203     9922    3                         OR RTYPE = 7/*@DR*/ OR RTYPE = 9/*@SR*/ )  )
      204     9923    3                         OR
      205     9924    3                         ( FILE = 0/*@OF*/ AND RTYPE = 3/*@SC*/ )
      206     9925    4                 THEN DO;

      207     9926    4                     SIZE = SIZE + SIZE;

   9926  2 000447   000015 236000 1                  LDQ     SIZE
         2 000450   000015 036000 1                  ADLQ    SIZE
         2 000451   000015 756000 1                  STQ     SIZE

      208     9927    4                     GOTO RETRY;

PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:51   
   9927  2 000452   000105 710000 2                  TRA     RETRY

      209     9928    4                    END;
      210     9929    4                 ELSE DO;                  /* Error */

      211     9930        /*E*  ERROR: VYU-E$UNEXPECTED_LD_VY-0
      212     9931              MESSAGE: Object language error. Unexpected lost data condition.
      213     9932              DESCRIPTION: Self-explanatory.
      214     9933        */
      215     9934                          %SCREAM( ERR#=%E$UNEXPECTED_LD_VY, MID="'U'", LEVEL=%@E$F_D_VY);

   9935  2 000453   000060 630400 3                  EPPR0   48
         2 000454   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000455   000000 701000 xent               TSX1    VYE$ERROR
         2 000456   000000 011000                    NOP     0

      216     9937    4                     CALL TELL_PAGE_TYPE( NPAGE, 4 );

   9937  2 000457   000051 236000 3                  LDQ     41
         2 000460   200030 756100                    STQ     @PAGE#+1,,AUTO
         2 000461   200003 236100                    LDQ     @NPAGE,,AUTO
         2 000462   200027 756100                    STQ     @ACCESS+3,,AUTO
         2 000463   001073 701000 2                  TSX1    TELL_PAGE_TYPE
         2 000464   000000 011000                    NOP     0

      217     9938    4                    END;

      218     9939    3               END;                        /* Do case( VX_IO_STATUS ); */

      219     9940    2            END;                           /* Do never */

      220     9941        %EJECT;
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:52   
      221     9942    1         ENT_SIZE = VY_REC_SIZE_A(RTYPE);

   9942  2 000465   200007 470500                    LDP0    @RTYPE,,AUTO
         2 000466   000000 720100                    LXL0    0,,PR0
         2 000467   000000 235010 xsym               LDA     VY_REC_SIZE_A,X0
         2 000470   000020 755000 1                  STA     ENT_SIZE

      222     9943    1         IF RTYPE = 3/*@SC*/ AND FILE_TYPE = 0/*@OF*/ THEN ENT_SIZE = 2;

   9943  2 000471   000000 235100                    LDA     0,,PR0
         2 000472   000003 115007                    CMPA    3,DL
         2 000473   000501 601000 2                  TNZ     s:9944
         2 000474   200006 471500                    LDP1    @FILE_TYPE,,AUTO
         2 000475   100000 235100                    LDA     0,,PR1
         2 000476   000501 601000 2                  TNZ     s:9944

   9943  2 000477   000002 236007                    LDQ     2,DL
         2 000500   000020 756000 1                  STQ     ENT_SIZE

      223     9944    1         CURR$ -> VY$NODE.L_SIZE_A(RTYPE) = CURR$ -> VY$NODE.L_SIZE_A(RTYPE) +
              9944                  TSIZE_READ; /* Accumulate total size read */

   9944  2 000501   200004 471500                    LDP1    @TSIZE_READ,,AUTO
         2 000502   000004 473400 1                  LDP3    CURR$
         2 000503   300054 236110                    LDQ     44,X0,PR3
         2 000504   100000 036100                    ADLQ    0,,PR1
         2 000505   300054 756110                    STQ     44,X0,PR3

      224     9945    1         CURR$ -> VY$NODE.L_STOP_A$(RTYPE) =

   9945  2 000506   000000 720100                    LXL0    0,,PR0
         2 000507   100000 236100                    LDQ     0,,PR1
         2 000510   000020 136000 1                  SBLQ    ENT_SIZE
         2 000511   200010 474500                    LDP4    @START$,,AUTO
         2 000512   400000 475500                    LDP5    0,,PR4
         2 000513   500000 636506                    EPPR6   0,QL,PR5
         2 000514   300042 456510                    STP6    34,X0,PR3
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:53   

      225     9946    1                 PINCRW( START$, TSIZE_READ - ENT_SIZE );
      226     9947
      227     9948    2         IF RTYPE >= 3/*@SC*/ AND RTYPE <= 9/*@SR*/ THEN DO;

   9948  2 000515   000000 235100                    LDA     0,,PR0
         2 000516   000003 115007                    CMPA    3,DL
         2 000517   000736 602000 2                  TNC     s:10003
         2 000520   000012 115007                    CMPA    10,DL
         2 000521   000736 603000 2                  TRC     s:10003

      228     9949    2             NAME_X = VY_MATCH_NAME_A(RTYPE);

   9949  2 000522   000000 720100                    LXL0    0,,PR0
         2 000523   000000 235010 xsym               LDA     VY_MATCH_NAME_A,X0
         2 000524   000021 755000 1                  STA     NAME_X

      229     9950    2             NAME$  = PINCRW( CURR$ -> VY$NODE.L_START_A$(NAME_X),

   9950  2 000525   300066 721105                    LXL1    54,AL,PR3
         2 000526   000021 722000 1                  LXL2    NAME_X
         2 000527   300030 475512                    LDP5    24,X2,PR3
         2 000530   500000 636511                    EPPR6   0,X1,PR5
         2 000531   000005 456400 1                  STP6    NAME$

      230     9951    2                     CURR$ -> VY$NODE.L_PREV_SIZE_A(NAME_X) );
      231     9952    2             NAME_INX = VY_NAME_DISP_A(RTYPE);

   9952  2 000532   000000 235010 xsym               LDA     VY_NAME_DISP_A,X0
         2 000533   000025 755000 1                  STA     NAME_INX

      232     9953    2             CURR_NAME_SIZE = CURR$ -> VY$NODE.L_SIZE_A(NAME_X)

   9953  2 000534   300054 236112                    LDQ     44,X2,PR3
         2 000535   300066 136112                    SBLQ    54,X2,PR3
         2 000536   000026 756000 1                  STQ     CURR_NAME_SIZE

PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:54   
      233     9954    2                     -
      234     9955    2                     CURR$ -> VY$NODE.L_PREV_SIZE_A(NAME_X);
      235     9956    2             P$ = START$;

   9956  2 000537   400000 236100                    LDQ     0,,PR4
         2 000540   000000 756000 1                  STQ     P$

      236     9957    3             IF FILE = 1/*@RF*/ AND FILE_TYPE = 1/*@RF*/ THEN DO;

   9957  2 000541   200005 475500                    LDP5    @FILE,,AUTO
         2 000542   500000 235100                    LDA     0,,PR5
         2 000543   000001 115007                    CMPA    1,DL
         2 000544   000611 601000 2                  TNZ     s:9973
         2 000545   200006 477500                    LDP7    @FILE_TYPE,,AUTO
         2 000546   700000 235100                    LDA     0,,PR7
         2 000547   000001 115007                    CMPA    1,DL
         2 000550   000611 601000 2                  TNZ     s:9973

      237     9958    4                 DO WHILE( P$ < WHERE$ );

   9958  2 000551   000003 116000 1                  CMPQ    WHERE$
         2 000552   000736 603000 2                  TRC     s:10003

      238     9959    4                     NAME_DISP = P$ -> VYD$TMPLT.A_SBIN(NAME_INX);

   9959  2 000553   000025 235000 1                  LDA     NAME_INX
         2 000554   000001 735000                    ALS     1
         2 000555   000000 470400 1                  LDP0    P$
         2 000556   000100 100505                    MLR     fill='000'O
         2 000557   000000 000002                    ADSC9   0,A,PR0                  cn=0,n=2
         2 000560   200032 000004                    ADSC9   @SEVERITY+2,,AUTO        cn=0,n=4
         2 000561   200032 236100                    LDQ     @SEVERITY+2,,AUTO
         2 000562   000022 732000                    QRS     18
         2 000563   000031 756000 1                  STQ     NAME_DISP

      239     9960    5                     IF NAME_DISP >= 0 THEN DO;

PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:55   
   9960  2 000564   000574 604000 2                  TMI     s:9963

      240     9961    5                         IF NAME_DISP > CURR_NAME_SIZE THEN CALL OUT_OF_RANGE;

   9961  2 000565   000602 604000 2                  TMI     s:9965
         2 000566   000026 116000 1                  CMPQ    CURR_NAME_SIZE
         2 000567   000602 602000 2                  TNC     s:9965
         2 000570   000602 600000 2                  TZE     s:9965

   9961  2 000571   001001 701000 2                  TSX1    OUT_OF_RANGE
         2 000572   000000 011000                    NOP     0

      241     9962    5                        END;               /* If NAME_DISP >= 0 then do; */

   9962  2 000573   000602 710000 2                  TRA     s:9965

      242     9963    4                     ELSE IF RTYPE ~= 3/*@SC*/ THEN CALL OUT_OF_RANGE;

   9963  2 000574   200007 471500                    LDP1    @RTYPE,,AUTO
         2 000575   100000 235100                    LDA     0,,PR1
         2 000576   000003 115007                    CMPA    3,DL
         2 000577   000602 600000 2                  TZE     s:9965

   9963  2 000600   001001 701000 2                  TSX1    OUT_OF_RANGE
         2 000601   000000 011000                    NOP     0

      243     9964        /**/
      244     9965    4                     P$ = PINCRW( P$, ENT_SIZE );

   9965  2 000602   000020 236000 1                  LDQ     ENT_SIZE
         2 000603   000022 736000                    QLS     18
         2 000604   000000 036000 1                  ADLQ    P$
         2 000605   000000 756000 1                  STQ     P$

      245     9966    4                    END;                   /* Do while( P$ < WHERE$ ); */

   9966  2 000606   000003 116000 1                  CMPQ    WHERE$
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:56   
         2 000607   000553 602000 2                  TNC     s:9959

      246     9967        /**/
      247     9968    3                END;               /* If file = @RF and FILE_TYPE = @RF then do; */

   9968  2 000610   000736 710000 2                  TRA     s:10003

      248     9969    3             ELSE DO;

      249     9970        /**/
      250     9971        /**/
      251     9972        /**/
      252     9973    3                 LAST_NAME_SIZE = CURR$ -> VY$NODE.L_PREV_SIZE_A(NAME_X);

   9973  2 000611   300066 235112                    LDA     54,X2,PR3
         2 000612   000027 755000 1                  STA     LAST_NAME_SIZE

      253     9974    4                 DO WHILE ( P$ <  WHERE$ );

   9974  2 000613   000003 116000 1                  CMPQ    WHERE$
         2 000614   000736 603000 2                  TRC     s:10003

      254     9975    4                     NAME_DISP = P$ -> VYD$TMPLT.A_SBIN(NAME_INX);

   9975  2 000615   000025 235000 1                  LDA     NAME_INX
         2 000616   000001 735000                    ALS     1
         2 000617   000000 470400 1                  LDP0    P$
         2 000620   000100 100505                    MLR     fill='000'O
         2 000621   000000 000002                    ADSC9   0,A,PR0                  cn=0,n=2
         2 000622   200032 000004                    ADSC9   @SEVERITY+2,,AUTO        cn=0,n=4
         2 000623   200032 236100                    LDQ     @SEVERITY+2,,AUTO
         2 000624   000022 732000                    QRS     18
         2 000625   000031 756000 1                  STQ     NAME_DISP

      255     9976    5                     IF NAME_DISP >= 0 THEN DO; /* A real name */

   9976  2 000626   000657 604000 2                  TMI     s:9983
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:57   

      256     9977    5                         IF NAME_DISP > CURR_NAME_SIZE THEN

   9977  2 000627   000635 604000 2                  TMI     s:9979
         2 000630   000026 116000 1                  CMPQ    CURR_NAME_SIZE
         2 000631   000635 602000 2                  TNC     s:9979
         2 000632   000635 600000 2                  TZE     s:9979

      257     9978    5                             CALL OUT_OF_RANGE; /* ERROR: Out of bounds */

   9978  2 000633   001001 701000 2                  TSX1    OUT_OF_RANGE
         2 000634   000000 011000                    NOP     0

      258     9979    5                         Q$ = PINCRW( NAME$, NAME_DISP );

   9979  2 000635   000031 236000 1                  LDQ     NAME_DISP
         2 000636   000022 736000                    QLS     18
         2 000637   000005 036000 1                  ADLQ    NAME$
         2 000640   000001 756000 1                  STQ     Q$

      259     9980    5                         J = Q$ -> B$DNAME.COUNT; /* Get size */

   9980  2 000641   000001 470400 1                  LDP0    Q$
         2 000642   000000 236100                    LDQ     0,,PR0
         2 000643   000022 772000                    QRL     18
         2 000644   000010 756000 1                  STQ     J

      260     9981    5                         P$ -> VYD$TMPLT.A(NAME_INX)  = NAME_DISP + LAST_NAME_SIZE;

   9981  2 000645   000031 236000 1                  LDQ     NAME_DISP
         2 000646   000027 036000 1                  ADLQ    LAST_NAME_SIZE
         2 000647   200032 756100                    STQ     @SEVERITY+2,,AUTO
         2 000650   000025 235000 1                  LDA     NAME_INX
         2 000651   000001 735000                    ALS     1
         2 000652   000000 471400 1                  LDP1    P$
         2 000653   000105 101500                    MRL     fill='000'O
         2 000654   200032 000004                    ADSC9   @SEVERITY+2,,AUTO        cn=0,n=4
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:58   
         2 000655   100000 000002                    ADSC9   0,A,PR1                  cn=0,n=2

      261     9982    5                        END;

   9982  2 000656   000665 710000 2                  TRA     s:9984

      262     9983    4                     ELSE IF RTYPE ~= 3/*@SC*/ THEN CALL OUT_OF_RANGE;

   9983  2 000657   200007 471500                    LDP1    @RTYPE,,AUTO
         2 000660   100000 235100                    LDA     0,,PR1
         2 000661   000003 115007                    CMPA    3,DL
         2 000662   000665 600000 2                  TZE     s:9984

   9983  2 000663   001001 701000 2                  TSX1    OUT_OF_RANGE
         2 000664   000000 011000                    NOP     0

      263     9984    5                     IF SOURCE >= 0 THEN DO;

   9984  2 000665   000032 235000 1                  LDA     SOURCE
         2 000666   000730 604000 2                  TMI     s:10000

      264     9985    6                         DO CASE( RTYPE );

   9985  2 000667   200007 470500                    LDP0    @RTYPE,,AUTO
         2 000670   000000 235100                    LDA     0,,PR0
         2 000671   000004 135007                    SBLA    4,DL
         2 000672   000005 115007                    CMPA    5,DL
         2 000673   000675 602005 2                  TNC     s:9985+6,AL
         2 000674   000730 710000 2                  TRA     s:10000
         2 000675   000720 710000 2                  TRA     CHECK_DEFINED
         2 000676   000730 710000 2                  TRA     s:10000
         2 000677   000702 710000 2                  TRA     s:9987
         2 000700   000730 710000 2                  TRA     s:10000
         2 000701   000702 710000 2                  TRA     s:9987

      265     9986    6                           CASE( 6/*@DD*/, 8/*@SD*/ );

PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:59   
      266     9987    7                             IF P$ -> VYD$TMPLT.I.C THEN DO;

   9987  2 000702   000000 471400 1                  LDP1    P$
         2 000703   100001 236100                    LDQ     1,,PR1
         2 000704   400000 316007                    CANQ    -131072,DL
         2 000705   000720 600000 2                  TZE     CHECK_DEFINED

      267     9988    7                                 P$ -> VYD$TMPLT.I.MULTIPLY = '0'B/*@NO_B*/;

   9988  2 000706   000064 236000 3                  LDQ     52
         2 000707   100001 356100                    ANSQ    1,,PR1

      268     9989    7                                 P$ -> VYD$TMPLT.I.WHERE_C = SOURCE;

   9989  2 000710   000032 236000 1                  LDQ     SOURCE
         2 000711   000013 736000                    QLS     11
         2 000712   100001 676100                    ERQ     1,,PR1
         2 000713   074000 376007                    ANQ     30720,DL
         2 000714   100001 656100                    ERSQ    1,,PR1

      269     9990    7                                 P$ -> VYD$TMPLT.I.IS_DCB.DCB_BIT = '0'B/*@FALSE_B*/;

   9990  2 000715   000065 236000 3                  LDQ     53
         2 000716   100001 356100                    ANSQ    1,,PR1

      270     9991    7                                END;

   9991  2 000717   000730 710000 2                  TRA     s:10000

      271     9992    6                             ELSE GOTO CHECK_DEFINED;
      272     9993    6                           CASE( 4/*@ED*/ );

      273     9994    6   CHECK_DEFINED:
      274     9995    6                             P$ -> VYD$TMPLT.I.WHERE = SOURCE;

   9995  2 000720   000000 471400 1     CHECK_DEFIN* LDP1    P$
         2 000721   000032 236000 1                  LDQ     SOURCE
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:60   
         2 000722   000041 736000                    QLS     33
         2 000723   100000 676100                    ERQ     0,,PR1
         2 000724   700000 376003                    ANQ     -32768,DU
         2 000725   100000 656100                    ERSQ    0,,PR1

      275     9996    6                             P$ -> VYD$TMPLT.I.B.MULTIPLY = '0'B/*@NO_B*/;

   9996  2 000726   000066 236000 3                  LDQ     54
         2 000727   100000 356100                    ANSQ    0,,PR1

      276     9997    6                           END;

      277     9998
      278     9999    5                        END;

      279    10000    4                     P$ = PINCRW( P$, ENT_SIZE );

  10000  2 000730   000020 236000 1                  LDQ     ENT_SIZE
         2 000731   000022 736000                    QLS     18
         2 000732   000000 036000 1                  ADLQ    P$
         2 000733   000000 756000 1                  STQ     P$

      280    10001    4                    END;

  10001  2 000734   000003 116000 1                  CMPQ    WHERE$
         2 000735   000615 602000 2                  TNC     s:9975

      281    10002    3                END;   /* Else do; - if file  = @RF and FILE_TYPE = @RF then do; */

      282    10003    2            END;

  10003  2 000736   001135 710000 2                  TRA     s:10141

      283    10004        %EJECT;
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:61   
      284    10005    1   BAD_NAME_SIZE: PROC( NAME_SIZE );

  10005  2 000737   200020 741300       BAD_NAME_SI* STX1  ! @SOURCE_P+2,,AUTO

      285    10006
      286    10007    2   DCL NAME_SIZE UBIN;

      287    10008
      288    10009        /*E*  ERROR: VYU-E$NAME_COUNT_VY-0
      289    10010              MESSAGE: Object language error. Range error on name size. Value = %U1.
      290    10011              DESCRIPTION: Self-explanatory.
      291    10012        */
      292    10013
      293    10014              %NUMBER( NUM1=NAME_SIZE, SIZE1=12, BASE1=10 );

  10020  2 000740   000027 236000 3                  LDQ     23
         2 000741   200036 756100                    STQ     @SEVERITY+6,,AUTO
         2 000742   200021 236100                    LDQ     @NAME_SIZE,,AUTO
         2 000743   000025 235000 3                  LDA     21
         2 000744   200034 757100                    STAQ    @SEVERITY+4,,AUTO
         2 000745   000070 237000 3                  LDAQ    56
         2 000746   200032 757100                    STAQ    @SEVERITY+2,,AUTO
         2 000747   200032 630500                    EPPR0   @SEVERITY+2,,AUTO
         2 000750   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000751   000000 701000 xent               TSX1    VYD$B2C
         2 000752   000000 011000                    NOP     0

      294    10031
      295    10032              %SCREAM( ERR#=%E$NAME_COUNT_VY, MID="'U'", LEVEL=%@E$F_D_VY );

  10033  2 000753   000072 630400 3                  EPPR0   58
         2 000754   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000755   000000 701000 xent               TSX1    VYE$ERROR
         2 000756   000000 011000                    NOP     0

      296    10035
      297    10036    2         K = POFFW( P$, START$ ) / PAGE_SIZE;
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:62   

  10036  2 000757   200010 470500                    LDP0    @START$,,AUTO
         2 000760   000000 236100                    LDQ     0,,PR0
         2 000761   000022 772000                    QRL     18
         2 000762   200032 756100                    STQ     @SEVERITY+2,,AUTO
         2 000763   000000 236000 1                  LDQ     P$
         2 000764   000022 772000                    QRL     18
         2 000765   200032 136100                    SBLQ    @SEVERITY+2,,AUTO
         2 000766   200011 471500                    LDP1    @PAGE_SIZE,,AUTO
         2 000767   100000 506100                    DIV     0,,PR1
         2 000770   000011 756000 1                  STQ     K

      298    10037
      299    10038    2         CALL TELL_PAGE_TYPE( K, 4 );

  10038  2 000771   000051 236000 3                  LDQ     41
         2 000772   200030 756100                    STQ     @PAGE#+1,,AUTO
         2 000773   000076 236000 3                  LDQ     62
         2 000774   200027 756100                    STQ     @ACCESS+3,,AUTO
         2 000775   001073 701000 2                  TSX1    TELL_PAGE_TYPE
         2 000776   000000 011000                    NOP     0

      300    10039
      301    10040    2   END BAD_NAME_SIZE;

  10040  2 000777   200020 221300                    LDX1  ! @SOURCE_P+2,,AUTO
         2 001000   000001 702211                    TSX2  ! 1,X1

      302    10041
      303    10042        %EJECT;
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:63   
      304    10043    1   OUT_OF_RANGE: PROC;

  10043  2 001001   200020 741300       OUT_OF_RANGE STX1  ! @SOURCE_P+2,,AUTO

      305    10044
      306    10045        /*E*  ERROR: VYU-E$NAME_RANGE_VY-0
      307    10046              MESSAGE: Object language error. Name displacement is out of bounds.
      308    10047              DESCRIPTION: Self-explantory.
      309    10048        */
      310    10049
      311    10050              %SCREAM( ERR#=%E$NAME_RANGE_VY, MID="'U'", LEVEL=%@E$F_D_VY );

  10051  2 001002   000100 630400 3                  EPPR0   64
         2 001003   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 001004   000000 701000 xent               TSX1    VYE$ERROR
         2 001005   000000 011000                    NOP     0

      312    10053
      313    10054    2         CALL DISPLAY_RANGE( CURR_NAME_SIZE, NAME_DISP );

  10054  2 001006   000104 236000 3                  LDQ     68
         2 001007   200024 756100                    STQ     @RANGE#+1,,AUTO
         2 001010   000105 236000 3                  LDQ     69
         2 001011   200023 756100                    STQ     @NAME_SIZE+2,,AUTO
         2 001012   001016 701000 2                  TSX1    DISPLAY_RANGE
         2 001013   000000 011000                    NOP     0

      314    10055
      315    10056    2   END OUT_OF_RANGE;

  10056  2 001014   200020 221300                    LDX1  ! @SOURCE_P+2,,AUTO
         2 001015   000001 702211                    TSX2  ! 1,X1

      316    10057
      317    10058        %EJECT;
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:64   
      318    10059    1   DISPLAY_RANGE: PROC( RANGE#, ACCESS );

  10059  2 001016   200022 741300       DISPLAY_RAN* STX1  ! @NAME_SIZE+1,,AUTO

      319    10060
      320    10061    2   DCL RANGE# UBIN;

      321    10062    2   DCL ACCESS UBIN;
      322    10063
      323    10064        /*E*  ERROR: VYU-E$DISPLAY_NAME_RANGE_VY-0
      324    10065              MESSAGE: Permissible range: 0 - %U1. Attempted access = %U2.
      325    10066              DESCRIPTION: Self-explanatory.
      326    10067        */
      327    10068
      328    10069              %NUMBER(
      329    10070                      NUM1=RANGE#, SIZE1=6, BASE1=10,
      330    10071                      NUM2=ACCESS, SIZE2=6, BASE2=10 );

  10077  2 001017   000027 236000 3                  LDQ     23
         2 001020   200036 756100                    STQ     @SEVERITY+6,,AUTO
         2 001021   200023 236100                    LDQ     @RANGE#,,AUTO
         2 001022   000025 235000 3                  LDA     21
         2 001023   200034 757100                    STAQ    @SEVERITY+4,,AUTO
         2 001024   000070 237000 3                  LDAQ    56
         2 001025   200032 757100                    STAQ    @SEVERITY+2,,AUTO
         2 001026   200032 630500                    EPPR0   @SEVERITY+2,,AUTO
         2 001027   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 001030   000000 701000 xent               TSX1    VYD$B2C
         2 001031   000000 011000                    NOP     0

  10081  2 001032   000027 236000 3                  LDQ     23
         2 001033   200036 756100                    STQ     @SEVERITY+6,,AUTO
         2 001034   200024 236100                    LDQ     @ACCESS,,AUTO
         2 001035   000033 235000 3                  LDA     27
         2 001036   200034 757100                    STAQ    @SEVERITY+4,,AUTO
         2 001037   000106 237000 3                  LDAQ    70
         2 001040   200032 757100                    STAQ    @SEVERITY+2,,AUTO
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:65   
         2 001041   200032 630500                    EPPR0   @SEVERITY+2,,AUTO
         2 001042   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 001043   000000 701000 xent               TSX1    VYD$B2C
         2 001044   000000 011000                    NOP     0

      331    10088
      332    10089              %SCREAM( ERR#=%E$DISPLAY_NAME_RANGE_VY, MID="'U'", LEVEL=%@E$F_D_VY );

  10090  2 001045   000111 630400 3                  EPPR0   73
         2 001046   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 001047   000000 701000 xent               TSX1    VYE$ERROR
         2 001050   000000 011000                    NOP     0

      333    10092
      334    10093    2         K = POFFW( P$, START$ ) / PAGE_SIZE;

  10093  2 001051   200010 470500                    LDP0    @START$,,AUTO
         2 001052   000000 236100                    LDQ     0,,PR0
         2 001053   000022 772000                    QRL     18
         2 001054   200032 756100                    STQ     @SEVERITY+2,,AUTO
         2 001055   000000 236000 1                  LDQ     P$
         2 001056   000022 772000                    QRL     18
         2 001057   200032 136100                    SBLQ    @SEVERITY+2,,AUTO
         2 001060   200011 471500                    LDP1    @PAGE_SIZE,,AUTO
         2 001061   100000 506100                    DIV     0,,PR1
         2 001062   000011 756000 1                  STQ     K

      335    10094
      336    10095    2         CALL TELL_PAGE_TYPE( K, 4 );

  10095  2 001063   000051 236000 3                  LDQ     41
         2 001064   200030 756100                    STQ     @PAGE#+1,,AUTO
         2 001065   000076 236000 3                  LDQ     62
         2 001066   200027 756100                    STQ     @ACCESS+3,,AUTO
         2 001067   001073 701000 2                  TSX1    TELL_PAGE_TYPE
         2 001070   000000 011000                    NOP     0

PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:66   
      337    10096
      338    10097    2   END DISPLAY_RANGE;

  10097  2 001071   200022 221300                    LDX1  ! @NAME_SIZE+1,,AUTO
         2 001072   000001 702211                    TSX2  ! 1,X1

      339    10098
      340    10099        %EJECT;
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:67   
      341    10100    1   TELL_PAGE_TYPE: PROC( PAGE#, SEVERITY );

  10100  2 001073   200026 741300       TELL_PAGE_T* STX1  ! @ACCESS+2,,AUTO

      342    10101
      343    10102    2   DCL PAGE#    UBIN;

      344    10103    2   DCL SEVERITY UBIN;
      345    10104
      346    10105        /*E*  ERROR: VYU-E$IN_PAGE_OF_REC_TYPE_VY-0
      347    10106              MESSAGE: The error occured in page %U1 of record type %U2.
      348    10107              DESCRIPTION: Self-explanatory.
      349    10108        */
      350    10109
      351    10110              %NUMBER(
      352    10111                      NUM1=PAGE#, SIZE1=3, BASE1=10,
      353    10112                      NUM2=RTYPE, SIZE2=3, BASE2=10 );

  10118  2 001074   000027 236000 3                  LDQ     23
         2 001075   200036 756100                    STQ     @SEVERITY+6,,AUTO
         2 001076   200027 236100                    LDQ     @PAGE#,,AUTO
         2 001077   000025 235000 3                  LDA     21
         2 001100   200034 757100                    STAQ    @SEVERITY+4,,AUTO
         2 001101   000070 237000 3                  LDAQ    56
         2 001102   200032 757100                    STAQ    @SEVERITY+2,,AUTO
         2 001103   200032 630500                    EPPR0   @SEVERITY+2,,AUTO
         2 001104   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 001105   000000 701000 xent               TSX1    VYD$B2C
         2 001106   000000 011000                    NOP     0

  10122  2 001107   000027 236000 3                  LDQ     23
         2 001110   200036 756100                    STQ     @SEVERITY+6,,AUTO
         2 001111   200007 236100                    LDQ     @RTYPE,,AUTO
         2 001112   000033 235000 3                  LDA     27
         2 001113   200034 757100                    STAQ    @SEVERITY+4,,AUTO
         2 001114   000106 237000 3                  LDAQ    70
         2 001115   200032 757100                    STAQ    @SEVERITY+2,,AUTO
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:68   
         2 001116   200032 630500                    EPPR0   @SEVERITY+2,,AUTO
         2 001117   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 001120   000000 701000 xent               TSX1    VYD$B2C
         2 001121   000000 011000                    NOP     0

      354    10129
      355    10130              %SCREAM( ERR#=%E$IN_PAGE_OF_REC_TYPE_VY, MID="'U'", LEVEL=SEVERITY,
      356    10131                       AUX=%@E$OUOF_VY );

  10132  2 001122   000116 237000 3                  LDAQ    78
         2 001123   200034 757100                    STAQ    @SEVERITY+4,,AUTO
         2 001124   200030 236100                    LDQ     @SEVERITY,,AUTO
         2 001125   000120 235000 3                  LDA     80
         2 001126   200032 757100                    STAQ    @SEVERITY+2,,AUTO
         2 001127   200032 630500                    EPPR0   @SEVERITY+2,,AUTO
         2 001130   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 001131   000000 701000 xent               TSX1    VYE$ERROR
         2 001132   000000 011000                    NOP     0

      357    10134        /*
      358    10135                       Note that if severity = 4 the above call to VYE$ERROR will
      359    10136                       cause VYE$ERROR to unwind to VYM$MAIN:RESTART
      360    10137        */
      361    10138    2   END TELL_PAGE_TYPE;

  10138  2 001133   200026 221300                    LDX1  ! @ACCESS+2,,AUTO
         2 001134   000001 702211                    TSX2  ! 1,X1

      362    10139
      363    10140
      364    10141    1   END VYU$PREAD;

  10141  2 001135   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:69   
--  Include file information  --

   VY_PSUBS_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   VY_DCB_R.:E05TOU  cannot be made into a system file and is referenced.
   VY_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VY_FIXED_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VY_MACRO_C.:E05TOU  is referenced.
   VY_PERR_C.:E05TOU  is referenced.
   VY_SUBS_C.:E05TOU  is referenced.
   VY_INC_NO_C.:E05TOU  is referenced.
   VY_SWITCH_C.:E05TOU  is referenced.
   VY_INC_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VYU$PREAD.
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:70   

 **** Variables and constants ****

  ****  Section 001  Data  VYU$PREAD

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    30-0-0/w SBIN        r     1 A_SIZE                     4-0-0/w PTR         r     1 CURR$
    26-0-0/w UBIN        r     1 CURR_NAME_SIZE            20-0-0/w UBIN        r     1 ENT_SIZE
     7-0-0/w UBIN        r     1 I                         14-0-0/w UBIN        r     1 IN_PROG
    10-0-0/w UBIN        r     1 J                         11-0-0/w UBIN        r     1 K
    24-0-0/w UBIN        r     1 KEY                       27-0-0/w UBIN        r     1 LAST_NAME_SIZE
    13-0-0/w UBIN        r     1 LOOP                       5-0-0/w PTR         r     1 NAME$
    31-0-0/w SBIN        r     1 NAME_DISP                 25-0-0/w UBIN        r     1 NAME_INX
    21-0-0/w UBIN        r     1 NAME_X                     0-0-0/w PTR         r     1 P$
     1-0-0/w PTR         r     1 Q$                         2-0-0/w PTR         r     1 R$
    15-0-0/w UBIN        r     1 SIZE                      16-0-0/w UBIN        r     1 SIZE_READ
    32-0-0/w SBIN        r     1 SOURCE                     3-0-0/w PTR         r     1 WHERE$

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    24-0-0/w PTR         r     1 @ACCESS                   14-0-0/w PTR         r     1 @AREA_SIZE
    15-0-0/w PTR         r     1 @CURR_P$                  13-0-0/w PTR         r     1 @DS
     5-0-0/w PTR         r     1 @FILE                      6-0-0/w PTR         r     1 @FILE_TYPE
    21-0-0/w PTR         r     1 @NAME_SIZE                 3-0-0/w PTR         r     1 @NPAGE
    27-0-0/w PTR         r     1 @PAGE#                    11-0-0/w PTR         r     1 @PAGE_SIZE
    23-0-0/w PTR         r     1 @RANGE#                    7-0-0/w PTR         r     1 @RTYPE
    30-0-0/w PTR         r     1 @SEVERITY                 16-0-0/w PTR         r     1 @SOURCE_P
    10-0-0/w PTR         r     1 @START$                   12-0-0/w PTR         r     1 @TSIZE
     4-0-0/w PTR         r     1 @TSIZE_READ               *0-0-0/w UBIN        r     1 ACCESS
    *0-0-0/w UBIN        r     1 AREA_SIZE                 *0-0-0/w PTR         r     1 CURR_P$
    *0-0-0/w UBIN        r     1 DS                        *0-0-0/w UBIN        r     1 FILE
    *0-0-0/w UBIN        r     1 FILE_TYPE                 *0-0-0/w UBIN        r     1 NAME_SIZE
    *0-0-0/w UBIN        r     1 NPAGE                     *0-0-0/w UBIN        r     1 PAGE#
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:71   
    *0-0-0/w SBIN        r     1 PAGE_SIZE                 *0-0-0/w UBIN        r     1 RANGE#
    *0-0-0/w UBIN        r     1 RTYPE                     *0-0-0/w UBIN        r     1 SEVERITY
    *0-0-0/w SBIN        r     1 SOURCE_P                  *0-0-0/w PTR         r     1 START$
    *0-0-0/w UBIN        r     1 TSIZE                     *0-0-0/w UBIN        r     1 TSIZE_READ

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 VY_COMMAND                 0-0-0/w STRC(720)   r     1 VY_EFIELD1
     0-0-0/w STRC(720)   r     1 VY_EFIELD2                 0-0-0/w SBIN        r     1 VY_IO_SIZEW
     0-0-0/w SBIN        r     1 VY_IO_STATUS
     0-0-0/w UBIN        r     1 VY_MATCH_NAME_A(0:9)
     0-0-0/w SBIN        r     1 VY_M_ALL(0:8)
     0-0-0/w PTR         r     1 VY_M_BASE_PTR(0:8)
     0-0-0/w SBIN        r     1 VY_M_FREE(0:8)
     0-0-0/w UBIN        r     1 VY_NAME_DISP_A(0:9)
     0-0-0/w STRC(4617)  r     1 VY_OL_KEY_BUF              0-0-0/c STRC(1044)  r     1 VY_OU_HEAD
     0-0-0/w STRC(4617)  r     1 VY_O_KEY_BUF
     0-0-0/w SBIN        r     1 VY_REC_SIZE_A(0:15)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w ASTR(18)    r     1 B$DNAME                    0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/w STRC(3672)  r     1 VY$NODE                    0-0-0/w STRC(72)    r     1 VYD$TMPLT


   Procedure VYU$PREAD requires 606 words for executable code.
   Procedure VYU$PREAD requires 32 words of local(AUTO) storage.

    No errors detected in file VYU$PREAD.:E05TSI    .
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:72   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:73   
          MINI XREF LISTING

ACCESS IN PROCEDURE DISPLAY_RANGE
     10062**DCL     10059--PROC    10081<>CALL
AREA_SIZE
      9554**DCL        33--PROC     9804>>ASSIGN   9825<<ASSIGN   9825>>ASSIGN
A_SIZE
      9671**DCL      9804<<ASSIGN   9813>>IF       9814>>ASSIGN   9826<<ASSIGN   9826>>ASSIGN   9878<<ASSIGN
      9878>>ASSIGN
B$DNAME.COUNT
      9519**DCL      9526--IMP-SIZ  9980>>ASSIGN
CHECK_DEFINED
      9995**LABEL    9992--GOTO
CURR$
      9613**DCL      9796<<ASSIGN   9805>>IF       9806>>ASSIGN   9807>>ASSIGN   9807>>ASSIGN   9809>>CALL
      9944>>ASSIGN   9944>>ASSIGN   9945>>ASSIGN   9950>>ASSIGN   9950>>ASSIGN   9953>>ASSIGN   9953>>ASSIGN
      9973>>ASSIGN
CURR_NAME_SIZE
      9653**DCL      9953<<ASSIGN   9961>>IF       9977>>IF      10054<>CALL
CURR_P$
      9555**DCL        33--PROC     9796>>ASSIGN
DISPLAY_RANGE
     10059**PROC    10054--CALL
DS
      9553**DCL        33--PROC     9819>>IF       9819>>IF       9820>>ASSIGN   9820>>ASSIGN   9821>>ASSIGN
      9821>>ASSIGN   9823<>CALL
ENT_SIZE
      9647**DCL      9942<<ASSIGN   9943<<ASSIGN   9945>>ASSIGN   9965>>ASSIGN  10000>>ASSIGN
F$DCB.ACTPOS
      9710**DCL      9710--REDEF
F$DCB.ARS#
      9684**DCL      9684--REDEF
F$DCB.ATTR
      9703**DCL      9704--REDEF
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:74   
F$DCB.BORROW
      9718**DCL      9718--REDEF    9718--REDEF    9718--REDEF
F$DCB.DCBNAME.L
      9732**DCL      9732--IMP-SIZ
F$DCB.EOMCHAR#
      9688**DCL      9688--REDEF
F$DCB.FLDID
      9713**DCL      9713--REDEF
F$DCB.FORM$
      9707**DCL      9707--REDEF
F$DCB.FSECT
      9723**DCL      9723--REDEF
F$DCB.FSN#
      9700**DCL      9700--REDEF    9700--REDEF    9701--REDEF
F$DCB.HEADER$
      9706**DCL      9706--REDEF
F$DCB.IXTNSIZE#
      9704**DCL      9704--REDEF
F$DCB.LASTSTA$
      9693**DCL      9693--REDEF
F$DCB.LVL
      9719**DCL      9719--REDEF
F$DCB.NAME#.C
      9694**DCL      9694--REDEF
F$DCB.NOEOF
      9716**DCL      9716--REDEF
F$DCB.NRECS#
      9705**DCL      9705--REDEF
F$DCB.NRECX
      9724**DCL      9724--REDEF
F$DCB.OHDR
      9716**DCL      9716--REDEF
F$DCB.ORG#
      9699**DCL      9699--REDEF
F$DCB.PRECNO
      9722**DCL      9722--REDEF
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:75   
F$DCB.RCSZ
      9728**DCL      9728--REDEF
F$DCB.RES#
      9695**DCL      9695--REDEF
F$DCB.SETX
      9707**DCL      9707--REDEF
F$DCB.TAB$
      9707**DCL      9707--REDEF
F$DCB.TDA
      9721**DCL      9722--REDEF
F$DCB.WSN#
      9695**DCL      9695--REDEF
FILE
      9547**DCL        33--PROC     9828<>CALL     9841>>IF       9899>>IF       9905>>IF       9920>>IF
      9920>>IF       9957>>IF
FILE_TYPE
      9548**DCL        33--PROC     9798>>ASSIGN   9813>>IF       9813>>IF       9829>>IF       9943>>IF
      9957>>IF
I
      9633**DCL      9634--REDEF    9808<<DOINDEX  9809<>CALL     9874<>CALL
IN_PROG
      9643**DCL      9799<<ASSIGN   9802>>ASSIGN   9811>>IF       9811>>ASSIGN   9879<<ASSIGN   9879>>ASSIGN
IO_ERROR
      9888**LABEL    9828--CALLALT
J
      9635**DCL      9636--REDEF    9814<<ASSIGN   9819>>IF       9821>>ASSIGN   9823<>CALL     9825>>ASSIGN
      9826>>ASSIGN   9980<<ASSIGN
K
      9637**DCL      9638--REDEF   10036<<ASSIGN  10038<>CALL    10093<<ASSIGN  10095<>CALL
KEY
      9651**DCL      9798<<ASSIGN   9809<>CALL     9828<>CALL     9831>>IF
L
      9639**DCL      9640--REDEF
LAST_NAME_SIZE
      9654**DCL      9973<<ASSIGN   9981>>ASSIGN
LOOP
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:76   
      9642**DCL      9802<<ASSIGN   9808>>DOINDEX
NAME$
      9614**DCL      9950<<ASSIGN   9979>>ASSIGN
NAME_DISP
      9672**DCL      9959<<ASSIGN   9960>>IF       9961>>IF       9975<<ASSIGN   9976>>IF       9977>>IF
      9979>>ASSIGN   9981>>ASSIGN  10054<>CALL
NAME_INX
      9652**DCL      9952<<ASSIGN   9959>>ASSIGN   9975>>ASSIGN   9981>>ASSIGN
NAME_SIZE IN PROCEDURE BAD_NAME_SIZE
     10007**DCL     10005--PROC    10020<>CALL
NAME_X
      9648**DCL      9949<<ASSIGN   9950>>ASSIGN   9950>>ASSIGN   9953>>ASSIGN   9953>>ASSIGN   9973>>ASSIGN
NPAGE
      9545**DCL        33--PROC     9800<<ASSIGN   9881<<ASSIGN   9881>>ASSIGN   9897<>CALL     9905>>IF
      9917<>CALL     9937<>CALL
OUT_OF_RANGE
     10043**PROC     9961--CALL     9963--CALL     9978--CALL     9983--CALL
P$
      9608**DCL      9956<<ASSIGN   9958>>DOWHILE  9959>>ASSIGN   9965<<ASSIGN   9965>>ASSIGN   9974>>DOWHILE
      9975>>ASSIGN   9981>>ASSIGN   9987>>IF       9988>>ASSIGN   9989>>ASSIGN   9990>>ASSIGN   9995>>ASSIGN
      9996>>ASSIGN  10000<<ASSIGN  10000>>ASSIGN  10036>>ASSIGN  10093>>ASSIGN
PAGE# IN PROCEDURE TELL_PAGE_TYPE
     10102**DCL     10100--PROC    10118<>CALL
PAGE_SIZE
      9551**DCL        33--PROC     9802>>ASSIGN   9802>>ASSIGN   9810>>ASSIGN   9811>>IF      10036>>ASSIGN
     10093>>ASSIGN
Q$
      9609**DCL      9979<<ASSIGN   9980>>ASSIGN
R$
      9610**DCL      9820<<ASSIGN   9823<>CALL
RANGE# IN PROCEDURE DISPLAY_RANGE
     10061**DCL     10059--PROC    10077<>CALL
RETRY
      9813**LABEL    9927--GOTO
RTYPE
      9549**DCL        33--PROC     9805>>IF       9806>>ASSIGN   9807>>ASSIGN   9807>>ASSIGN   9809<>CALL
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:77   
      9813>>IF       9829>>IF       9841>>IF       9899>>IF       9899>>IF       9905>>IF       9920>>IF
      9920>>IF       9920>>IF       9920>>IF       9920>>IF       9920>>IF       9942>>ASSIGN   9943>>IF
      9944>>ASSIGN   9944>>ASSIGN   9945>>ASSIGN   9948>>IF       9948>>IF       9949>>ASSIGN   9952>>ASSIGN
      9963>>IF       9983>>IF       9985>>DOCASE  10122<>CALL
SEVERITY IN PROCEDURE TELL_PAGE_TYPE
     10103**DCL     10100--PROC    10132<>CALL
SIZE
      9644**DCL      9810<<ASSIGN   9811<<ASSIGN   9813>>IF       9814>>ASSIGN   9828<>CALL     9829>>ASSIGN
      9840>>IF       9860<>CALL     9879>>ASSIGN   9926<<ASSIGN   9926>>ASSIGN   9926>>ASSIGN
SIZE_READ
      9645**DCL      9829<<ASSIGN   9830<<ASSIGN   9840>>IF       9877>>ASSIGN   9878>>ASSIGN   9880>>ASSIGN
SOURCE
      9673**DCL      9797<<ASSIGN   9984>>IF       9989>>ASSIGN   9995>>ASSIGN
SOURCE_P
      9556**DCL        33--PROC     9797>>ASSIGN
START$
      9550**DCL        33--PROC     9803>>ASSIGN   9945>>ASSIGN   9956>>ASSIGN  10036>>ASSIGN  10093>>ASSIGN
TELL_PAGE_TYPE
     10100**PROC     9874--CALL     9897--CALL     9917--CALL     9937--CALL    10038--CALL    10095--CALL
TSIZE
      9552**DCL        33--PROC     9799>>ASSIGN
TSIZE_READ
      9546**DCL        33--PROC     9801<<ASSIGN   9880<<ASSIGN   9880>>ASSIGN   9901>>IF       9944>>ASSIGN
      9945>>ASSIGN
VY$NODE.ADDR_START_A
      9271**DCL      9272--REDEF
VY$NODE.ADDR_STOP_A
      9276**DCL      9277--REDEF
VY$NODE.L_PREV_SIZE
      9329**DCL      9340--REDEF
VY$NODE.L_PREV_SIZE_A
      9340**DCL      9807<<ASSIGN   9950>>ASSIGN   9953>>ASSIGN   9973>>ASSIGN
VY$NODE.L_SC_START
      9348**DCL      9353--REDEF
VY$NODE.L_SC_STOP
      9354**DCL      9359--REDEF
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:78   
VY$NODE.L_SIZE
      9317**DCL      9328--REDEF
VY$NODE.L_SIZE_A
      9328**DCL      9807>>ASSIGN   9944<<ASSIGN   9944>>ASSIGN   9953>>ASSIGN
VY$NODE.L_START
      9293**DCL      9304--REDEF
VY$NODE.L_START_A$
      9304**DCL      9805>>IF       9806<<ASSIGN   9950>>ASSIGN
VY$NODE.L_STOP
      9305**DCL      9316--REDEF
VY$NODE.L_STOP_A$
      9316**DCL      9945<<ASSIGN
VY$NODE.NUM
      9269**DCL      9809<>CALL
VY$NODE.PROMOTE_HEAD
      9360**DCL      9363--REDEF
VY$NODE.PROMOTE_TAIL
      9364**DCL      9367--REDEF
VY$NODE.START_PAGE#_A
      9281**DCL      9282--REDEF
VY$NODE.STOP_PAGE#_A
      9286**DCL      9287--REDEF
VYA$GET
      9583**DCL-ENT  9823--CALL
VYD$B2C
      9581**DCL-ENT  9860--CALL     9864--CALL    10020--CALL    10077--CALL    10081--CALL    10118--CALL
     10122--CALL
VYD$TMPLT.A
      9463**DCL      9464--REDEF    9465--REDEF    9492--REDEF    9498--REDEF    9501--REDEF    9981<<ASSIGN
VYD$TMPLT.A_SBIN
      9464**DCL      9959>>ASSIGN   9975>>ASSIGN
VYD$TMPLT.I.A
      9482**DCL      9483--REDEF
VYD$TMPLT.I.B.MULTIPLY
      9472**DCL      9996<<ASSIGN
VYD$TMPLT.I.C
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:79   
      9481**DCL      9987>>IF
VYD$TMPLT.I.CST
      9486**DCL      9487--REDEF
VYD$TMPLT.I.I
      9484**DCL      9485--REDEF
VYD$TMPLT.I.IS_DCB.DCB_BIT
      9490**DCL      9990<<ASSIGN
VYD$TMPLT.I.MULTIPLY
      9483**DCL      9988<<ASSIGN
VYD$TMPLT.I.NAME_DISP
      9478**DCL      9479--REDEF
VYD$TMPLT.I.NP
      9488**DCL      9489--REDEF
VYD$TMPLT.I.P
      9480**DCL      9481--REDEF
VYD$TMPLT.I.SC#
      9473**DCL      9474--REDEF
VYD$TMPLT.I.WHERE
      9466**DCL      9995<<ASSIGN
VYD$TMPLT.I.WHERE_C
      9487**DCL      9989<<ASSIGN
VYE$ERROR
      9574**DCL-ENT  9847--CALL     9872--CALL     9895--CALL     9915--CALL     9935--CALL    10033--CALL
     10051--CALL    10090--CALL    10132--CALL
VYI$READ
      9589**DCL-ENT  9828--CALL
VYI$WRITE
      9590**DCL-ENT  9837--CALL
VYK$KEY
      9588**DCL-ENT  9809--CALL
VY_BIAS.A
      5426**DCL      5426--REDEF
VY_CBUF.CHARS_A
      5417**DCL      5417--REDEF
VY_COMMAND
      5417**DCL      9832>>DOCASE
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:80   
VY_EBUF.CHARS_A
      5718**DCL      5719--REDEF
VY_EFIELD1.CHARS
      5719**DCL      5719--REDEF
VY_EFIELD1.CHARS_A
      5719**DCL      9860<>CALL    10020<>CALL    10077<>CALL    10118<>CALL
VY_EFIELD2.CHARS
      5720**DCL      5720--REDEF
VY_EFIELD2.CHARS_A
      5720**DCL      9864<>CALL    10081<>CALL    10122<>CALL
VY_EFIELD3.CHARS
      5721**DCL      5721--REDEF
VY_ERRORS
      5422**DCL      5424--REDEF
VY_ERRORS.CONFLICT_A
      5423**DCL      5424--REDEF
VY_ERRORS.UNSAT_A
      5422**DCL      5423--REDEF
VY_IMAGE_DATA.CPAGE#_A
      5310**DCL      5311--REDEF
VY_IMAGE_DATA.NODE_A$
      5322**DCL      5323--REDEF
VY_IMAGE_DATA.START_A$
      5314**DCL      5315--REDEF
VY_IMAGE_DATA.STOP_A$
      5318**DCL      5319--REDEF
VY_IMAGE_PROC.CPAGE#_A
      5333**DCL      5334--REDEF
VY_IMAGE_PROC.NODE_A$
      5345**DCL      5346--REDEF
VY_IMAGE_PROC.START_A$
      5337**DCL      5338--REDEF
VY_IMAGE_PROC.STOP_A$
      5341**DCL      5342--REDEF
VY_IMAGE_ROS.CPAGE#_A
      5356**DCL      5357--REDEF
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:81   
VY_IMAGE_ROS.NODE_A$
      5368**DCL      5369--REDEF
VY_IMAGE_ROS.START_A$
      5360**DCL      5361--REDEF
VY_IMAGE_ROS.STOP_A$
      5364**DCL      5365--REDEF
VY_IO_SIZEW
      5724**DCL      9830>>ASSIGN   9837<>CALL     9864<>CALL
VY_IO_STATUS
      5724**DCL      9888>>DOCASE
VY_MAP_HDR.CHARS
      5783**DCL      5784--REDEF    5784--REDEF
VY_MAP_LIT_LO_FPT_WRITE.STATION_
      5112**DCL      5112--REDEF
VY_MAP_LIT_LO_FPT_WRITE.V.DVBYTE.VFC#
      5119**DCL      5119--REDEF
VY_MAP_LO_FPT_WRITE.STATION_
      5081**DCL      5081--REDEF
VY_MAP_LO_FPT_WRITE.V.DVBYTE.VFC#
      5088**DCL      5088--REDEF
VY_MATCH_NAME_A
      5740**DCL      9949>>ASSIGN
VY_MBUF.CHARS
      5782**DCL      5783--REDEF    5783--REDEF
VY_M_ALL
      5427**DCL      9819>>IF
VY_M_BASE_PTR
      5428**DCL      9820>>ASSIGN
VY_M_FREE
      5427**DCL      9819>>IF       9820>>ASSIGN   9821<<ASSIGN   9821>>ASSIGN
VY_M_VECTOR.F
      5151**DCL      5155--REDEF
VY_M_VECTOR_DP.F
      5186**DCL      5190--REDEF
VY_NAME_DISP_A
      5741**DCL      9952>>ASSIGN
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:82   
VY_O.DUPL_ATTCH
      5564**DCL      5568--REDEF
VY_O.MAP_ATTCH
      5552**DCL      5563--REDEF
VY_O.PRIMARY_OPTION
      5546**DCL      5551--REDEF
VY_O.SEV_ATTCH
      5569**DCL      5571--REDEF
VY_OD.DUPL_ATTCH
      5708**DCL      5712--REDEF
VY_OD.MAP_ATTCH
      5696**DCL      5707--REDEF
VY_OD.PRIMARY_OPTION
      5690**DCL      5695--REDEF
VY_OD.SEV_ATTCH
      5713**DCL      5715--REDEF
VY_OL_KEY_BUF
      5218**DCL      9835<<ASSIGN
VY_OL_KEY_BUF.FORM0
      5219**DCL      5222--REDEF    5229--REDEF
VY_OL_KEY_BUF.FORM1.UTS
      5225**DCL      9836<<ASSIGN
VY_OU_HEAD.REC_A
      5407**DCL      5408--REDEF
VY_OU_HEAD.UTS
      5405**DCL      9836>>ASSIGN
VY_O_KEY_BUF
      5195**DCL      9835>>ASSIGN
VY_O_KEY_BUF.FORM0
      5196**DCL      5199--REDEF    5206--REDEF
VY_O_KEY_BUF_L.FORM0
      5242**DCL      5245--REDEF    5252--REDEF
VY_PAR_UNWIND
      5777**DCL      5777--REDEF
VY_PASS2_REF.OU.L_START
      5744**DCL      5745--REDEF
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:83   
VY_PASS2_REF.OU.L_STOP
      5745**DCL      5746--REDEF
VY_PASS2_REF.OU.MAX
      5743**DCL      5744--REDEF
VY_PASS2_REF.OU.SIZE
      5746**DCL      5747--REDEF
VY_PASS2_REF.SAT.COUNT
      5750**DCL      5751--REDEF
VY_PASS2_REF.SAT.ENT_SIZE
      5752**DCL      5753--REDEF
VY_PASS2_REF.SAT.L_START
      5748**DCL      5749--REDEF
VY_PASS2_REF.SAT.L_STOP
      5749**DCL      5750--REDEF
VY_PASS2_REF.SAT.MAX
      5747**DCL      5748--REDEF
VY_PASS2_REF.UNSAT.L_START
      5754**DCL      5755--REDEF
VY_PASS2_REF.UNSAT.L_STOP
      5755**DCL      5756--REDEF
VY_PASS2_REF.UNSAT.L_WHERE
      5756**DCL      5757--REDEF
VY_PASS2_REF.UNSAT.MAX
      5753**DCL      5754--REDEF
VY_PASS2_REF.UNSAT.PAGE#
      5758**DCL      5759--REDEF
VY_PASS2_REF.UNSAT.SIZE
      5757**DCL      5758--REDEF
VY_PROGRAM_BIAS.A
      5425**DCL      5425--REDEF
VY_REC_SIZE_A
      5739**DCL      9942>>ASSIGN
VY_RU_HEAD.DATA_SEGMENT
      5393**DCL      5393--REDEF
VY_RU_HEAD.L
      5389**DCL      5390--REDEF
PL6.E3A0      #001=VYU$PREAD File=VYU$PREAD.:E05TSI                              WED 07/30/97 09:05 Page:84   
VY_RU_HEAD.MAP_BITS
      5390**DCL      5392--REDEF
VY_RU_HEAD.PBIT
      5386**DCL      5386--REDEF
VY_RU_HEAD_BUF.DATA_SEGMENT
      5403**DCL      5403--REDEF
VY_RU_HEAD_BUF.L
      5398**DCL      5399--REDEF
VY_RU_HEAD_BUF.MAP_BITS
      5400**DCL      5402--REDEF
VY_RU_HEAD_BUF.PBIT
      5395**DCL      5396--REDEF
VY_R_KEY_BUF.FORM0
      5265**DCL      5269--REDEF    5275--REDEF
VY_SI_KEY_BUF.KEY
      5773**DCL      5773--REDEF
VY_SPC.B$.MINE
      5768**DCL      5769--REDEF
VY_SPC.B$.NAME
      5765**DCL      5765--REDEF
VY_SPC.B$.SKIP
      5767**DCL      5768--REDEF
VY_SPC.B$.VALUE
      5766**DCL      5767--REDEF
VY_SPC.SEG.NAME
      5760**DCL      5761--REDEF
VY_SPC.SEG.VALUE
      5761**DCL      5762--REDEF
VY_TSX0_OVERLAY.H
      5732**DCL      5733--REDEF
WHERE$
      9612**DCL      9803<<ASSIGN   9806>>ASSIGN   9828<>CALL     9837<>CALL     9877<<ASSIGN   9877>>ASSIGN
      9958>>DOWHILE  9974>>DOWHILE
