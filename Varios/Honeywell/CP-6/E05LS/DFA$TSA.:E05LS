VERSION E05

PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:1    
        1        1        /*M* DFA$TSA - FORMAT L6 ISA/TSA */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,IND=5,ENU=0,ECU=0    */
        8        8
        9        9        DFA$TSA: PROC ALTRET;
       10       10
       11       11    1   DCL DFA$WRITE EPTR SYMREF;
       12       12    1   DCL D_M$DO# UBIN SYMREF;
       13       13
       14       14    1   DCL ISM1 UBIN;
       15       15    1   DCL ISM2 UBIN;
       16       16
       17       17    1   DCL 1 REGS(0:6),
       18       18    1         2 CONTENTS SBIN WORD;
       19       19
       20       20    1   DCL ASV SBIN;
       21       21    1   DCL TSAP SBIN;
       22       22    1   DCL NATSAP SBIN;
       23       23    1   DCL IREG SBIN;
       24       24    1   DCL TREG SBIN;
       25       25
       26       26    1   DCL PREG SBIN;
       27       27    1   DCL SREG SBIN;
       28       28    1   DCL CHN SBIN;
       29       29
       30       30    1   DCL CIREG SBIN;
       31       31    1   DCL RDBR SBIN;
       32       32
       33       33    1   DCL I SBIN;
       34       34    1   DCL R$ PTR;
       35       35    1   DCL R32 UBIN(32) BASED(R$) UNAL;
       36       36    1   DCL R16 UBIN(16) BASED(R$) UNAL;
       37       37
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:2    
       38       38    1   DCL NATSAP_WHO CHAR(24);
       39       39
       40       40        /* FORMATS */
       41       41
       42       42    1   DCL F_REG2 CHAR(0) CONSTANT INIT(
       43       43    1    '%/              _____1 _____2 _____3 _____4 _____5 _____6 _____7');
       44       44    1   DCL F_REG3 CHAR(0) CONSTANT INIT(
       45       45    1   '%A Registers:  %7(%6*H %)');
       46       46        /**/
       47       47    1   DCL C_BREGS CHAR(1) CONSTANT INIT('B');
       48       48    1   DCL C_RREGS CHAR(1) CONSTANT INIT('R');
       49       49    1   DCL C_MREGS CHAR(1) CONSTANT INIT('M');
       50       50        /**/
       51       51    1   DCL F_INFO1 CHAR(0) CONSTANT INIT(
       52       52    1   '%/ISA - P: .%8LH S: .%4ZH CHN: .%4ZH ISM1: .%4ZH ISM2: .%4ZH');
       53       53
       54       54    1   DCL ICBUF CHAR(45);
       55       55    1   DCL ASIZE SBIN;
       56       56    1   DCL ICTEXT CHAR(0) CONSTANT INIT('      Interrupted address: %>A');
       57       57    1   DCL F_INFO2 CHAR(0) CONSTANT INIT(
       58       58    1   '%/TSAP$: .%8L*H I: .%4Z*H T$: .%8L*H CI: .%4ZH RDBR$: .%8LH');
       59       59
       60       60    1   DCL F_INFO3 CHAR(0) CONSTANT INIT(
       61       61    1   '      NATSAP: %A  ASV$: .%8L*H');
       62       62
       63       63    1   DCL NATSAP_TEXT(0:2) CHAR(24) CONSTANT INIT(
       64       64    1      '0 - Monitor/Scheduler',
       65       65    1      '1 - User/User Service',
       66       66    1      '2 - Handler at Int Level');
       67       67
       68       68        %INCLUDE GD$MSG_M;
       69      232        %GD$MSG(FPTN=GD$MSG,STCLASS="BASED(S_D_L6_MESSAGE$)",L6=YES,L6PTR="UBIN(32) UNAL");
       70      388        %INCLUDE DD$BASED;
       71     1691        %INCLUDE XUH_MACRO_C;
       72     1775        %INCLUDE DD_SD_M;
       73     3111        %S_D;
       74     4429        %S_D_PTRS;
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:3    
       75     4466        %TSA$CMD;
       76     4477        %FPRG$CONTEXT;
       77     4540        %INCLUDE GD_EQUS_E;
       78     4701        %INCLUDE DD_ERR_C;
       79     5098        %INCLUDE DU_SCODE_C;
       80     5111    1   DCL DFQ$WRITE_FD ENTRY(1) ALTRET;
       81     5112    1   DCL DFQ$READ_FD ENTRY(2) ALTRET;
       82     5113    1   DCL DUE$ERRMSG ENTRY;
       83     5114    1   DCL DDE$ERROR ENTRY;
       84     5115    1   DCL DDR$POSIT ENTRY(5) ALTRET;
       85     5116        %EJECT;
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:4    
       86     5117        %INCLUDE CP_6;
       87     5198
       88     5199        %FPT_SCREECH(FPTN=SNAP_MESSAGE,STCLASS=CONSTANT,SCODE=SC_MESSAGE);
       89     5213        %VLP_SCODE(FPTN=SC_MESSAGE, STCLASS=CONSTANT, FCG=DU, MID=X, MON=NO,
       90     5214                   CODE=%S$DUMESSAGE, SEV=SEV_SNAP, CUSR=YES, ROSEG=YES,
       91     5215                   ISEG=YES, DDSEG=YES, DBSEG=YES, ASLSEG=YES);
       92     5276        %VLP_ERRCODE (FCG=GH,MID=B,MON='1'B,STCLASS=CONSTANT);
       93     5321        %VLP_ERRCODE (FPTN=VLP$ERRCODE,STCLASS=AUTO);
       94     5366        %FPT_ERRMSG (INCLCODE=NO,STCLASS=CONSTANT);
       95     5393        %FPT_ERRMSG (FPTN=FPT$ERRMSG,STCLASS=AUTO);
       96     5420    1   DCL ERRBUF CHAR(120);
       97     5421
       98     5422    1   DCL TSAL SBIN;
       99     5423    1   DCL INST SBIN;
      100     5424    1   DCL ZREG SBIN;
      101     5425    1   DCL TRAPNO SBIN;
      102     5426
      103     5427    1   DCL LEVEL UBIN;
      104     5428    1   DCL RING_WHO CHAR(16);
      105     5429
      106     5430    1   DCL A$ SBIN;
      107     5431    1   DCL P SBIN;
      108     5432    1   DCL B3$ SBIN;
      109     5433    1   DCL R3 SBIN;
      110     5434
      111     5435                                                /* Formats                            */
      112     5436    1   DCL F_TSA1 CHAR(0) CONSTANT INIT(
      113     5437    1   'TRAP: %D TSAL$: .%8LH I: .%4ZH INST: .%4ZH Z: .%4ZH A$: .%8LH');
      114     5438
      115     5439    1   DCL F_TSA2 CHAR(0) CONSTANT INIT(
      116     5440    1   'P: .%8LH  B3: .%8LH  R3: .%4LH');
      117     5441
      118     5442    1   DCL F_TSA21 CHAR(0) CONSTANT INIT(
      119     5443    1   'S: .%4ZH   Ring: %A   Level: %D');
      120     5444
      121     5445
      122     5446    1   DCL RING_TXT(0:3) CHAR(16) CONSTANT INIT(
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:5    
      123     5447    1      '3 - User',
      124     5448    1      '2 - Debugger',
      125     5449    1      '1 - Mon/Handler',
      126     5450    1      '0 - Mon/Handler');
      127     5451        %EJECT;
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:6    
      128     5452    1      GD$MSG = '0'B;
      129     5453    1      GD$MSG.FNC = %GD#RQSTSA;
      130     5454    1      GD$MSG.TSA.ADDRESS$ = S_D.DO$->TSA$CMD.ADDRESS;
      131     5455    1      CALL DFQ$WRITE_FD (S_D.CURRENT_FPRG_CONTEXT$) ALTRET(ERR);
      132     5456    1      CALL DFQ$READ_FD (S_D.CURRENT_FPRG_CONTEXT$, '0'B) ALTRET(ERR);
      133     5457    1      IF GD$MSG.FNC ~= %GD#RSPTSA
      134     5458    2      THEN DO;
      135     5459    3           DO CASE (GD$MSG.FNC);
      136     5460    3            CASE (%GD#RSPBADADR);
      137     5461    3              S_D.ERROR = E@BADADDR;       /* E@BADADDR                          */
      138     5462    3            CASE (ELSE);
      139     5463    3              IF S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.XDELTA AND
      140     5464    3                GD$MSG.FNC = %GD#RSPBADMSG
      141     5465    4              THEN DO;
      142     5466    4                   S_D.ERROR = E@BADMSG;   /* E@BADMSG                           */
      143     5467    4                   GOTO ARET;
      144     5468    4                   END;
      145     5469    3              REMEMBER NEVER IN S_D.SCREECH_IC;
      146     5470    3              CALL M$SCREECH (SNAP_MESSAGE) ALTRET(NEVER);
      147     5471    3   NEVER:
      148     5472    3              S_D.ERROR = E@BADMESSAGE;    /* E@BADMESSAGE                       */
      149     5473    3              CALL DDE$ERROR;
      150     5474    3              S_D.ERROR = E@DELBUG;        /* E@DELBUG                           */
      151     5475    3              CALL DDE$ERROR;
      152     5476    3              END;
      153     5477    2           GOTO ARET;
      154     5478    2           END;
      155     5479
      156     5480    1      TSAL=GD$MSG.TSA.TSAL$;
      157     5481    1      IREG=GD$MSG.TSA.I;
      158     5482    1      TRAPNO=GD$MSG.TSA.IREG.TRAPNO;
      159     5483    1      R3=GD$MSG.TSA.R3;
      160     5484    1      INST=GD$MSG.TSA.INST;
      161     5485    1      ZREG=GD$MSG.TSA.Z;
      162     5486    1      A$=GD$MSG.TSA.A$;
      163     5487    1      PREG=GD$MSG.TSA.P$$;
      164     5488    1      B3$=GD$MSG.TSA.B3$;
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:7    
      165     5489    1      SREG=GD$MSG.TSA.S;
      166     5490
      167     5491    1      CALL DFA$WRITE(VECTOR(F_TSA1),
      168     5492    1        VECTOR(TRAPNO),
      169     5493    1        VECTOR(TSAL),
      170     5494    1        VECTOR(IREG),
      171     5495    1        VECTOR(INST),
      172     5496    1        VECTOR(ZREG),
      173     5497    1        VECTOR(A$));
      174     5498
      175     5499    1      IF TRAPNO ~= 0
      176     5500    2      THEN DO;
      177     5501    2           VLP$ERRCODE = VLP_ERRCODE;
      178     5502    2           FPT$ERRMSG = FPT_ERRMSG;
      179     5503    2           FPT$ERRMSG.V_ = VECTOR(FPT$ERRMSG.V);
      180     5504    2           FPT$ERRMSG.BUF_ = VECTOR(ERRBUF);
      181     5505    2           FPT$ERRMSG.V.OUTDCB1# = D_M$DO#;
      182     5506    2           FPT$ERRMSG.CODE_ = VECTOR(VLP$ERRCODE);
      183     5507    2           VLP$ERRCODE.ERR# = 1300+TRAPNO;
      184     5508    2           CALL M$ERRMSG(FPT$ERRMSG);
      185     5509    2           END;
      186     5510
      187     5511    1      RING_WHO = RING_TXT(GD$MSG.TSA.S1.RING);
      188     5512    1      LEVEL = GD$MSG.TSA.S1.LEVEL;
      189     5513    1      CALL DFA$WRITE(VECTOR(F_TSA21),
      190     5514    1        VECTOR(SREG),
      191     5515    1        VECTOR(RING_WHO),
      192     5516    1        VECTOR(LEVEL));
      193     5517
      194     5518    1      ASV=-1;
      195     5519    1      TSAP=-1;
      196     5520    1      NATSAP=-1;
      197     5521    1      IREG=-1;
      198     5522    1      TREG=-1;
      199     5523
      200     5524    1      SREG=GD$MSG.TSA.ISA.S;
      201     5525    1      ISM1 = BITBIN(GD$MSG.TSA.ISA.ISM1);
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:8    
      202     5526    1      ISM2 = BITBIN(GD$MSG.TSA.ISA.ISM2);
      203     5527    1      CHN=GD$MSG.TSA.ISA.DEV;
      204     5528
      205     5529    1      CALL DFA$WRITE(VECTOR(F_INFO1),
      206     5530    1        VECTOR(PREG),
      207     5531    1        VECTOR(SREG),
      208     5532    1        VECTOR(CHN),
      209     5533    1        VECTOR(ISM1),
      210     5534    1        VECTOR(ISM2));
      211     5535
      212     5536    1      NATSAP=GD$MSG.TSA.ISA.ISM2.NATSAP;
      213     5537    1      IF NATSAP <=3
      214     5538    1      THEN NATSAP_WHO = NATSAP_TEXT(NATSAP);
      215     5539    1      ELSE CALL BINCHAR(NATSAP_WHO,NATSAP);
      216     5540
      217     5541    1      IF GD$MSG.TSA.ISA.ISM2.MMU
      218     5542    2      THEN DO;
      219     5543    2           ASV=GD$MSG.TSA.ISA.ASV$;
      220     5544    2           END;
      221     5545
      222     5546    1      CALL DFA$WRITE(VECTOR(F_INFO3),
      223     5547    1        VECTOR(NATSAP_WHO), VECTOR(ASV));
      224     5548
      225     5549    1      ICBUF = ' ';
      226     5550    1      CALL DDR$POSIT (PREG, ADDR(ICBUF), 45, ASIZE);
      227     5551    1      CALL DFA$WRITE(VECTOR(ICTEXT),VECTOR(ICBUF));
      228     5552
      229     5553    1      CALL DFA$WRITE(VECTOR(F_REG2));
      230     5554
      231     5555    1      R$=ADDR(GD$MSG.TSA.ISA.REGS);
      232     5556    2      DO I=6 DOWNTO 0;
      233     5557    3           IF GD$MSG.TSA.ISA.ISM1.BREG(I) THEN DO;
      234     5558    3                REGS.CONTENTS(I)=R32;
      235     5559    3                R$=PINCRB(R$,32);
      236     5560    3                END;
      237     5561    3           ELSE DO;
      238     5562    3                REGS.CONTENTS(I)=-1;
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:9    
      239     5563    3                END;
      240     5564    2           IF I=2 THEN REGS.CONTENTS(2)=B3$;
      241     5565    2           END;
      242     5566    1      CALL DFA$WRITE(VECTOR(F_REG3),VECTOR(C_BREGS),VECTOR(REGS));
      243     5567
      244     5568    2      IF GD$MSG.TSA.ISA.ISM1.I THEN DO;
      245     5569    2           IREG=R16;
      246     5570    2           R$=PINCRB(R$,16);
      247     5571    2           END;
      248     5572
      249     5573    2      DO I=6 DOWNTO 0;
      250     5574    2           CALL RREG(GD$MSG.TSA.ISA.ISM1.RREG(I),I);
      251     5575    2           IF I=2 THEN REGS.CONTENTS(2) = R3;
      252     5576    2           END;
      253     5577    1      CALL DFA$WRITE(VECTOR(F_REG3),VECTOR(C_RREGS),VECTOR(REGS));
      254     5578
      255     5579    1      CALL RREG(GD$MSG.TSA.ISA.ISM1.M1,0);
      256     5580    2      DO I=1 TO 6;
      257     5581    2           CALL RREG(GD$MSG.TSA.ISA.ISM2.M2_M7,I);
      258     5582    2           END;
      259     5583    1      CALL DFA$WRITE(VECTOR(F_REG3),VECTOR(C_MREGS),VECTOR(REGS));
      260     5584
      261     5585    2      IF GD$MSG.TSA.ISA.ISM2.T THEN DO;
      262     5586    2           TREG=R32;
      263     5587    2           R$=PINCRB(R$,32);
      264     5588    2           END;
      265     5589    1      TSAP=GD$MSG.TSA.ISA.TSAP$;
      266     5590
      267     5591    1      IF GD$MSG.TSA.ISA.ISM2.CIP
      268     5592    2      THEN DO;
      269     5593    2           CIREG=R16;
      270     5594    2           R$=PINCRB(R$,16);
      271     5595    2           RDBR=R32;
      272     5596    2           R$=PINCRC(R$,32);
      273     5597    2           END;
      274     5598
      275     5599    1      CALL DFA$WRITE(VECTOR(F_INFO2),
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:10   
      276     5600    1        VECTOR(TSAP),
      277     5601    1        VECTOR(IREG),
      278     5602    1        VECTOR(TREG),
      279     5603    1        VECTOR(CIREG),
      280     5604    1        VECTOR(RDBR));
      281     5605
      282     5606    1   RET:
      283     5607    1      RETURN;
      284     5608
      285     5609    1   ERR:
      286     5610    1      CALL DUE$ERRMSG;
      287     5611    1      RETURN;
      288     5612
      289     5613    1   ARET:
      290     5614    1      ALTRETURN;
      291     5615
      292     5616        %EJECT;
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:11   
      293     5617
      294     5618    1   RREG: PROC(MASKBIT,I);
      295     5619
      296     5620    2   DCL MASKBIT BIT(1) UNAL;
      297     5621    2   DCL I SBIN;
      298     5622
      299     5623    3      IF MASKBIT THEN DO;
      300     5624    3           REGS.CONTENTS(I)=R16;
      301     5625    3           R$=PINCRB(R$,16);
      302     5626    3           END;
      303     5627    3      ELSE DO;
      304     5628    3           REGS.CONTENTS(I)=-1;
      305     5629    3           END;
      306     5630    2      RETURN;
      307     5631
      308     5632    2   END RREG;
      309     5633
      310     5634    1   END DFA$TSA;
      311     5635
      312     5636        %EOD;

PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:12   
--  Include file information  --

   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   DU_SCODE_C.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   GD_EQUS_E.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   DD$BASED.:E05TOU  is referenced.
   GD$MSG_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure DFA$TSA.

   Procedure DFA$TSA requires 666 words for executable code.
   Procedure DFA$TSA requires 162 words of local(AUTO) storage.

PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:13   

 Object Unit name= DFA$TSA                                    File name= DFA$TSA.:E05TOU
 UTS= JUL 29 '97 14:37:15.64 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS    174    256  DFA$TSA
    1   DCB   even  none     0      0  M$UC
    2   Proc  even  none   666   1232  DFA$TSA
    3  RoData even  none    50     62  DFA$TSA

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        0  DFA$TSA

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 DFQ$WRITE_FD
 yes     yes           Std       2 DFQ$READ_FD
 yes     yes           Std       5 DDR$POSIT
         yes           Std       0 DUE$ERRMSG
         yes           Std       0 DDE$ERROR
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:14   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     DFA$WRITE                             D_M$DO#                          r    S_D$
r    S_D_L6_MESSAGE$                       M$UC                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:15   


        1        1        /*M* DFA$TSA - FORMAT L6 ISA/TSA */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,IND=5,ENU=0,ECU=0    */
        8        8
        9        9        DFA$TSA: PROC ALTRET;

      9  2 000000   000000 700200 xent  DFA$TSA      TSX0  ! X66_AUTO_0
         2 000001   000242 000000                    ZERO    162,0

       10       10
       11       11    1   DCL DFA$WRITE EPTR SYMREF;
       12       12    1   DCL D_M$DO# UBIN SYMREF;
       13       13
       14       14    1   DCL ISM1 UBIN;
       15       15    1   DCL ISM2 UBIN;
       16       16
       17       17    1   DCL 1 REGS(0:6),
       18       18    1         2 CONTENTS SBIN WORD;
       19       19
       20       20    1   DCL ASV SBIN;
       21       21    1   DCL TSAP SBIN;
       22       22    1   DCL NATSAP SBIN;
       23       23    1   DCL IREG SBIN;
       24       24    1   DCL TREG SBIN;
       25       25
       26       26    1   DCL PREG SBIN;
       27       27    1   DCL SREG SBIN;
       28       28    1   DCL CHN SBIN;
       29       29
       30       30    1   DCL CIREG SBIN;
       31       31    1   DCL RDBR SBIN;
       32       32
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:16   
       33       33    1   DCL I SBIN;
       34       34    1   DCL R$ PTR;
       35       35    1   DCL R32 UBIN(32) BASED(R$) UNAL;
       36       36    1   DCL R16 UBIN(16) BASED(R$) UNAL;
       37       37
       38       38    1   DCL NATSAP_WHO CHAR(24);
       39       39
       40       40        /* FORMATS */
       41       41
       42       42    1   DCL F_REG2 CHAR(0) CONSTANT INIT(
       43       43    1    '%/              _____1 _____2 _____3 _____4 _____5 _____6 _____7');
       44       44    1   DCL F_REG3 CHAR(0) CONSTANT INIT(
       45       45    1   '%A Registers:  %7(%6*H %)');
       46       46        /**/
       47       47    1   DCL C_BREGS CHAR(1) CONSTANT INIT('B');
       48       48    1   DCL C_RREGS CHAR(1) CONSTANT INIT('R');
       49       49    1   DCL C_MREGS CHAR(1) CONSTANT INIT('M');
       50       50        /**/
       51       51    1   DCL F_INFO1 CHAR(0) CONSTANT INIT(
       52       52    1   '%/ISA - P: .%8LH S: .%4ZH CHN: .%4ZH ISM1: .%4ZH ISM2: .%4ZH');
       53       53
       54       54    1   DCL ICBUF CHAR(45);
       55       55    1   DCL ASIZE SBIN;
       56       56    1   DCL ICTEXT CHAR(0) CONSTANT INIT('      Interrupted address: %>A');
       57       57    1   DCL F_INFO2 CHAR(0) CONSTANT INIT(
       58       58    1   '%/TSAP$: .%8L*H I: .%4Z*H T$: .%8L*H CI: .%4ZH RDBR$: .%8LH');
       59       59
       60       60    1   DCL F_INFO3 CHAR(0) CONSTANT INIT(
       61       61    1   '      NATSAP: %A  ASV$: .%8L*H');
       62       62
       63       63    1   DCL NATSAP_TEXT(0:2) CHAR(24) CONSTANT INIT(
       64       64    1      '0 - Monitor/Scheduler',
       65       65    1      '1 - User/User Service',
       66       66    1      '2 - Handler at Int Level');
       67       67
       68       68        %INCLUDE GD$MSG_M;
       69      232        %GD$MSG(FPTN=GD$MSG,STCLASS="BASED(S_D_L6_MESSAGE$)",L6=YES,L6PTR="UBIN(32) UNAL");
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:17   
       70      388        %INCLUDE DD$BASED;
       71     1691        %INCLUDE XUH_MACRO_C;
       72     1775        %INCLUDE DD_SD_M;
       73     3111        %S_D;
       74     4429        %S_D_PTRS;
       75     4466        %TSA$CMD;
       76     4477        %FPRG$CONTEXT;
       77     4540        %INCLUDE GD_EQUS_E;
       78     4701        %INCLUDE DD_ERR_C;
       79     5098        %INCLUDE DU_SCODE_C;
       80     5111    1   DCL DFQ$WRITE_FD ENTRY(1) ALTRET;
       81     5112    1   DCL DFQ$READ_FD ENTRY(2) ALTRET;
       82     5113    1   DCL DUE$ERRMSG ENTRY;
       83     5114    1   DCL DDE$ERROR ENTRY;
       84     5115    1   DCL DDR$POSIT ENTRY(5) ALTRET;
       85     5116        %EJECT;
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:18   
       86     5117        %INCLUDE CP_6;
       87     5198
       88     5199        %FPT_SCREECH(FPTN=SNAP_MESSAGE,STCLASS=CONSTANT,SCODE=SC_MESSAGE);
       89     5213        %VLP_SCODE(FPTN=SC_MESSAGE, STCLASS=CONSTANT, FCG=DU, MID=X, MON=NO,
       90     5214                   CODE=%S$DUMESSAGE, SEV=SEV_SNAP, CUSR=YES, ROSEG=YES,
       91     5215                   ISEG=YES, DDSEG=YES, DBSEG=YES, ASLSEG=YES);
       92     5276        %VLP_ERRCODE (FCG=GH,MID=B,MON='1'B,STCLASS=CONSTANT);
       93     5321        %VLP_ERRCODE (FPTN=VLP$ERRCODE,STCLASS=AUTO);
       94     5366        %FPT_ERRMSG (INCLCODE=NO,STCLASS=CONSTANT);
       95     5393        %FPT_ERRMSG (FPTN=FPT$ERRMSG,STCLASS=AUTO);
       96     5420    1   DCL ERRBUF CHAR(120);
       97     5421
       98     5422    1   DCL TSAL SBIN;
       99     5423    1   DCL INST SBIN;
      100     5424    1   DCL ZREG SBIN;
      101     5425    1   DCL TRAPNO SBIN;
      102     5426
      103     5427    1   DCL LEVEL UBIN;
      104     5428    1   DCL RING_WHO CHAR(16);
      105     5429
      106     5430    1   DCL A$ SBIN;
      107     5431    1   DCL P SBIN;
      108     5432    1   DCL B3$ SBIN;
      109     5433    1   DCL R3 SBIN;
      110     5434
      111     5435                                                /* Formats                            */
      112     5436    1   DCL F_TSA1 CHAR(0) CONSTANT INIT(
      113     5437    1   'TRAP: %D TSAL$: .%8LH I: .%4ZH INST: .%4ZH Z: .%4ZH A$: .%8LH');
      114     5438
      115     5439    1   DCL F_TSA2 CHAR(0) CONSTANT INIT(
      116     5440    1   'P: .%8LH  B3: .%8LH  R3: .%4LH');
      117     5441
      118     5442    1   DCL F_TSA21 CHAR(0) CONSTANT INIT(
      119     5443    1   'S: .%4ZH   Ring: %A   Level: %D');
      120     5444
      121     5445
      122     5446    1   DCL RING_TXT(0:3) CHAR(16) CONSTANT INIT(
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:19   
      123     5447    1      '3 - User',
      124     5448    1      '2 - Debugger',
      125     5449    1      '1 - Mon/Handler',
      126     5450    1      '0 - Mon/Handler');
      127     5451        %EJECT;
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:20   
      128     5452    1      GD$MSG = '0'B;

   5452  2 000002   000000 470400 xsym               LDP0    S_D_L6_MESSAGE$
         2 000003   003100 060400                    CSL     bolr='003'O
         2 000004   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         2 000005   000000 004720                    BDSC    0,,PR0                   by=0,bit=0,n=2512

      129     5453    1      GD$MSG.FNC = %GD#RQSTSA;

   5453  2 000006   000000 236100                    LDQ     0,,PR0
         2 000007   000000 376000 3                  ANQ     0
         2 000010   064000 276003                    ORQ     26624,DU
         2 000011   000000 756100                    STQ     0,,PR0

      130     5454    1      GD$MSG.TSA.ADDRESS$ = S_D.DO$->TSA$CMD.ADDRESS;

   5454  2 000012   000000 471400 xsym               LDP1    S_D$
         2 000013   100031 473500                    LDP3    25,,PR1
         2 000014   003100 061500                    CSR     bolr='003'O
         2 000015   300002 000044                    BDSC    2,,PR3                   by=0,bit=0,n=36
         2 000016   000000 270040                    BDSC    0,,PR0                   by=1,bit=7,n=32

      131     5455    1      CALL DFQ$WRITE_FD (S_D.CURRENT_FPRG_CONTEXT$) ALTRET(ERR);

   5455  2 000017   000000 236000 xsym               LDQ     S_D$
         2 000020   000102 036003                    ADLQ    66,DU
         2 000021   200166 756100                    STQ     @I+2,,AUTO
         2 000022   200166 630500                    EPPR0   @I+2,,AUTO
         2 000023   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000024   000000 701000 xent               TSX1    DFQ$WRITE_FD
         2 000025   001172 702000 2                  TSX2    ERR

      132     5456    1      CALL DFQ$READ_FD (S_D.CURRENT_FPRG_CONTEXT$, '0'B) ALTRET(ERR);

   5456  2 000026   000001 236000 3                  LDQ     1
         2 000027   200167 756100                    STQ     @I+3,,AUTO
         2 000030   000000 236000 xsym               LDQ     S_D$
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:21   
         2 000031   000102 036003                    ADLQ    66,DU
         2 000032   200166 756100                    STQ     @I+2,,AUTO
         2 000033   200166 630500                    EPPR0   @I+2,,AUTO
         2 000034   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000035   000000 701000 xent               TSX1    DFQ$READ_FD
         2 000036   001172 702000 2                  TSX2    ERR

      133     5457    1      IF GD$MSG.FNC ~= %GD#RSPTSA

   5457  2 000037   000000 470400 xsym               LDP0    S_D_L6_MESSAGE$
         2 000040   000000 236100                    LDQ     0,,PR0
         2 000041   776000 376003                    ANQ     -1024,DU
         2 000042   174000 116003                    CMPQ    63488,DU
         2 000043   000117 600000 2                  TZE     s:5480

      134     5458    2      THEN DO;

      135     5459    3           DO CASE (GD$MSG.FNC);

   5459  2 000044   000000 236100                    LDQ     0,,PR0
         2 000045   000034 772000                    QRL     28
         2 000046   000067 136007                    SBLQ    55,DL
         2 000047   000001 116007                    CMPQ    1,DL
         2 000050   000052 602006 2                  TNC     s:5459+6,QL
         2 000051   000057 710000 2                  TRA     s:5463
         2 000052   000053 710000 2                  TRA     s:5461

      136     5460    3            CASE (%GD#RSPBADADR);

      137     5461    3              S_D.ERROR = E@BADADDR;       /* E@BADADDR                          */

   5461  2 000053   000123 235007                    LDA     83,DL
         2 000054   000000 471400 xsym               LDP1    S_D$
         2 000055   100013 755100                    STA     11,,PR1
         2 000056   000116 710000 2                  TRA     s:5477

      138     5462    3            CASE (ELSE);
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:22   

      139     5463    3              IF S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.XDELTA AND

   5463  2 000057   000000 471400 xsym               LDP1    S_D$
         2 000060   100102 473500                    LDP3    66,,PR1
         2 000061   300001 236100                    LDQ     1,,PR3
         2 000062   002000 316003                    CANQ    1024,DU
         2 000063   000073 600000 2                  TZE     s:5469
         2 000064   000000 236100                    LDQ     0,,PR0
         2 000065   776000 376003                    ANQ     -1024,DU
         2 000066   140000 116003                    CMPQ    49152,DU
         2 000067   000073 601000 2                  TNZ     s:5469

      140     5464    3                GD$MSG.FNC = %GD#RSPBADMSG
      141     5465    4              THEN DO;

      142     5466    4                   S_D.ERROR = E@BADMSG;   /* E@BADMSG                           */

   5466  2 000070   000512 235007                    LDA     330,DL
         2 000071   100013 755100                    STA     11,,PR1

      143     5467    4                   GOTO ARET;

   5467  2 000072   001176 710000 2                  TRA     ARET

      144     5468    4                   END;
      145     5469    3              REMEMBER NEVER IN S_D.SCREECH_IC;

   5469  2 000073   000102 635000 2                  EAA     NEVER
         2 000074   105250 452500                    STP2    2728,,PR1
         2 000075   105251 755100                    STA     2729,,PR1

      146     5470    3              CALL M$SCREECH (SNAP_MESSAGE) ALTRET(NEVER);

   5470  2 000076   000132 630400 0                  EPPR0   SNAP_MESSAGE
         2 000077   400013 713400                    CLIMB   alt,+11
         2 000100   401000 401760                    pmme    nvectors=3
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:23   
         2 000101   000102 702000 2                  TSX2    NEVER

      147     5471    3   NEVER:
      148     5472    3              S_D.ERROR = E@BADMESSAGE;    /* E@BADMESSAGE                       */

   5472  2 000102   001014 235007       NEVER        LDA     524,DL
         2 000103   000000 470400 xsym               LDP0    S_D$
         2 000104   000013 755100                    STA     11,,PR0

      149     5473    3              CALL DDE$ERROR;

   5473  2 000105   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000106   000000 701000 xent               TSX1    DDE$ERROR
         2 000107   000000 011000                    NOP     0

      150     5474    3              S_D.ERROR = E@DELBUG;        /* E@DELBUG                           */

   5474  2 000110   000766 235007                    LDA     502,DL
         2 000111   000000 470400 xsym               LDP0    S_D$
         2 000112   000013 755100                    STA     11,,PR0

      151     5475    3              CALL DDE$ERROR;

   5475  2 000113   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000114   000000 701000 xent               TSX1    DDE$ERROR
         2 000115   000000 011000                    NOP     0

      152     5476    3              END;

      153     5477    2           GOTO ARET;

   5477  2 000116   001176 710000 2                  TRA     ARET

      154     5478    2           END;
      155     5479
      156     5480    1      TSAL=GD$MSG.TSA.TSAL$;

PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:24   
   5480  2 000117   000001 235100                    LDA     1,,PR0
         2 000120   000002 236100                    LDQ     2,,PR0
         2 000121   000034 773000                    LRL     28
         2 000122   000002 376000 3                  ANQ     2
         2 000123   200144 756100                    STQ     TSAL,,AUTO

      157     5481    1      IREG=GD$MSG.TSA.I;

   5481  2 000124   000002 236100                    LDQ     2,,PR0
         2 000125   000014 772000                    QRL     12
         2 000126   177777 376007                    ANQ     65535,DL
         2 000127   200017 756100                    STQ     IREG,,AUTO

      158     5482    1      TRAPNO=GD$MSG.TSA.IREG.TRAPNO;

   5482  2 000130   000002 236100                    LDQ     2,,PR0
         2 000131   000024 772000                    QRL     20
         2 000132   000377 376007                    ANQ     255,DL
         2 000133   200147 756100                    STQ     TRAPNO,,AUTO

      159     5483    1      R3=GD$MSG.TSA.R3;

   5483  2 000134   000002 235100                    LDA     2,,PR0
         2 000135   000003 236100                    LDQ     3,,PR0
         2 000136   000040 773000                    LRL     32
         2 000137   177777 376007                    ANQ     65535,DL
         2 000140   200160 756100                    STQ     R3,,AUTO

      160     5484    1      INST=GD$MSG.TSA.INST;

   5484  2 000141   000003 236100                    LDQ     3,,PR0
         2 000142   000020 772000                    QRL     16
         2 000143   177777 376007                    ANQ     65535,DL
         2 000144   200145 756100                    STQ     INST,,AUTO

      161     5485    1      ZREG=GD$MSG.TSA.Z;

PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:25   
   5485  2 000145   000003 236100                    LDQ     3,,PR0
         2 000146   177777 376007                    ANQ     65535,DL
         2 000147   200146 756100                    STQ     ZREG,,AUTO

      162     5486    1      A$=GD$MSG.TSA.A$;

   5486  2 000150   000004 236100                    LDQ     4,,PR0
         2 000151   000004 772000                    QRL     4
         2 000152   200155 756100                    STQ     A$,,AUTO

      163     5487    1      PREG=GD$MSG.TSA.P$$;

   5487  2 000153   000004 235100                    LDA     4,,PR0
         2 000154   000005 236100                    LDQ     5,,PR0
         2 000155   000010 773000                    LRL     8
         2 000156   000002 376000 3                  ANQ     2
         2 000157   200021 756100                    STQ     PREG,,AUTO

      164     5488    1      B3$=GD$MSG.TSA.B3$;

   5488  2 000160   000005 235100                    LDA     5,,PR0
         2 000161   000006 236100                    LDQ     6,,PR0
         2 000162   000014 773000                    LRL     12
         2 000163   000002 376000 3                  ANQ     2
         2 000164   200157 756100                    STQ     B3$,,AUTO

      165     5489    1      SREG=GD$MSG.TSA.S;

   5489  2 000165   000006 235100                    LDA     6,,PR0
         2 000166   000007 236100                    LDQ     7,,PR0
         2 000167   000040 773000                    LRL     32
         2 000170   177777 376007                    ANQ     65535,DL
         2 000171   200022 756100                    STQ     SREG,,AUTO

      166     5490
      167     5491    1      CALL DFA$WRITE(VECTOR(F_TSA1),

PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:26   
   5491  2 000172   777640 235007                    LDA     -96,DL
         2 000173   200166 452500                    STP2    @I+2,,AUTO
         2 000174   200166 236100                    LDQ     @I+2,,AUTO
         2 000175   000147 036003                    ADLQ    103,DU
         2 000176   200170 757100                    STAQ    @I+4,,AUTO
         2 000177   777640 235007                    LDA     -96,DL
         2 000200   200172 452500                    STP2    @I+6,,AUTO
         2 000201   200172 236100                    LDQ     @I+6,,AUTO
         2 000202   000144 036003                    ADLQ    100,DU
         2 000203   200174 757100                    STAQ    @I+8,,AUTO
         2 000204   777640 235007                    LDA     -96,DL
         2 000205   200176 452500                    STP2    @I+10,,AUTO
         2 000206   200176 236100                    LDQ     @I+10,,AUTO
         2 000207   000017 036003                    ADLQ    15,DU
         2 000210   200200 757100                    STAQ    @I+12,,AUTO
         2 000211   777640 235007                    LDA     -96,DL
         2 000212   200202 452500                    STP2    @I+14,,AUTO
         2 000213   200202 236100                    LDQ     @I+14,,AUTO
         2 000214   000145 036003                    ADLQ    101,DU
         2 000215   200204 757100                    STAQ    @I+16,,AUTO
         2 000216   777640 235007                    LDA     -96,DL
         2 000217   200206 452500                    STP2    @I+18,,AUTO
         2 000220   200206 236100                    LDQ     @I+18,,AUTO
         2 000221   000146 036003                    ADLQ    102,DU
         2 000222   200210 757100                    STAQ    @I+20,,AUTO
         2 000223   777640 235007                    LDA     -96,DL
         2 000224   200212 452500                    STP2    @I+22,,AUTO
         2 000225   200212 236100                    LDQ     @I+22,,AUTO
         2 000226   000155 036003                    ADLQ    109,DU
         2 000227   200216 757100                    STAQ    @I+26,,AUTO
         2 000230   200170 237100                    LDAQ    @I+4,,AUTO
         2 000231   200214 757100                    STAQ    @I+24,,AUTO
         2 000232   200174 237100                    LDAQ    @I+8,,AUTO
         2 000233   200220 757100                    STAQ    @I+28,,AUTO
         2 000234   200200 237100                    LDAQ    @I+12,,AUTO
         2 000235   200222 757100                    STAQ    @I+30,,AUTO
         2 000236   200204 237100                    LDAQ    @I+16,,AUTO
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:27   
         2 000237   200224 757100                    STAQ    @I+32,,AUTO
         2 000240   200210 237100                    LDAQ    @I+20,,AUTO
         2 000241   200226 757100                    STAQ    @I+34,,AUTO
         2 000242   200216 237100                    LDAQ    @I+26,,AUTO
         2 000243   200230 757100                    STAQ    @I+36,,AUTO
         2 000244   200230 631500                    EPPR1   @I+36,,AUTO
         2 000245   200240 451500                    STP1    @I+44,,AUTO
         2 000246   200226 633500                    EPPR3   @I+34,,AUTO
         2 000247   200237 453500                    STP3    @I+43,,AUTO
         2 000250   200224 634500                    EPPR4   @I+32,,AUTO
         2 000251   200236 454500                    STP4    @I+42,,AUTO
         2 000252   200222 635500                    EPPR5   @I+30,,AUTO
         2 000253   200235 455500                    STP5    @I+41,,AUTO
         2 000254   200220 636500                    EPPR6   @I+28,,AUTO
         2 000255   200234 456500                    STP6    @I+40,,AUTO
         2 000256   200214 637500                    EPPR7   @I+24,,AUTO
         2 000257   200233 457500                    STP7    @I+39,,AUTO
         2 000260   000003 236000 3                  LDQ     3
         2 000261   200232 756100                    STQ     @I+38,,AUTO
         2 000262   200232 630500                    EPPR0   @I+38,,AUTO
         2 000263   000000 220000 xsym               LDX0    DFA$WRITE
         2 000264   000025 631400 xsym               EPPR1   B_VECTNIL+21
         2 000265   000000 701010                    TSX1    0,X0
         2 000266   000000 011000                    NOP     0

      168     5492    1        VECTOR(TRAPNO),
      169     5493    1        VECTOR(TSAL),
      170     5494    1        VECTOR(IREG),
      171     5495    1        VECTOR(INST),
      172     5496    1        VECTOR(ZREG),
      173     5497    1        VECTOR(A$));
      174     5498
      175     5499    1      IF TRAPNO ~= 0

   5499  2 000267   200147 235100                    LDA     TRAPNO,,AUTO
         2 000270   000330 600000 2                  TZE     s:5511

PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:28   
      176     5500    2      THEN DO;

      177     5501    2           VLP$ERRCODE = VLP_ERRCODE;

   5501  2 000271   000142 236000 0                  LDQ     VLP_ERRCODE
         2 000272   200053 756100                    STQ     VLP$ERRCODE,,AUTO

      178     5502    2           FPT$ERRMSG = FPT_ERRMSG;

   5502  2 000273   000100 100400                    MLR     fill='000'O
         2 000274   000144 000150 0                  ADSC9   FPT_ERRMSG               cn=0,n=104
         2 000275   200054 000150                    ADSC9   FPT$ERRMSG,,AUTO         cn=0,n=104

      179     5503    2           FPT$ERRMSG.V_ = VECTOR(FPT$ERRMSG.V);

   5503  2 000276   000006 235000 3                  LDA     6
         2 000277   200166 452500                    STP2    @I+2,,AUTO
         2 000300   200166 236100                    LDQ     @I+2,,AUTO
         2 000301   000102 036003                    ADLQ    66,DU
         2 000302   200054 757100                    STAQ    FPT$ERRMSG,,AUTO

      180     5504    2           FPT$ERRMSG.BUF_ = VECTOR(ERRBUF);

   5504  2 000303   000007 235000 3                  LDA     7
         2 000304   200166 452500                    STP2    @I+2,,AUTO
         2 000305   200166 236100                    LDQ     @I+2,,AUTO
         2 000306   000106 036003                    ADLQ    70,DU
         2 000307   200060 757100                    STAQ    FPT$ERRMSG+4,,AUTO

      181     5505    2           FPT$ERRMSG.V.OUTDCB1# = D_M$DO#;

   5505  2 000310   000000 720000 xsym               LXL0    D_M$DO#
         2 000311   200102 440100                    SXL0    FPT$ERRMSG+22,,AUTO

      182     5506    2           FPT$ERRMSG.CODE_ = VECTOR(VLP$ERRCODE);

   5506  2 000312   777640 235007                    LDA     -96,DL
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:29   
         2 000313   200166 452500                    STP2    @I+2,,AUTO
         2 000314   200166 236100                    LDQ     @I+2,,AUTO
         2 000315   000053 036003                    ADLQ    43,DU
         2 000316   200056 757100                    STAQ    FPT$ERRMSG+2,,AUTO

      183     5507    2           VLP$ERRCODE.ERR# = 1300+TRAPNO;

   5507  2 000317   200147 236100                    LDQ     TRAPNO,,AUTO
         2 000320   002424 036007                    ADLQ    1300,DL
         2 000321   000003 736000                    QLS     3
         2 000322   200053 676100                    ERQ     VLP$ERRCODE,,AUTO
         2 000323   377770 376007                    ANQ     131064,DL
         2 000324   200053 656100                    ERSQ    VLP$ERRCODE,,AUTO

      184     5508    2           CALL M$ERRMSG(FPT$ERRMSG);

   5508  2 000325   200054 630500                    EPPR0   FPT$ERRMSG,,AUTO
         2 000326   020000 713400                    CLIMB   8192
         2 000327   405000 401760                    pmme    nvectors=11

      185     5509    2           END;

      186     5510
      187     5511    1      RING_WHO = RING_TXT(GD$MSG.TSA.S1.RING);

   5511  2 000330   000000 470400 xsym               LDP0    S_D_L6_MESSAGE$
         2 000331   000006 236100                    LDQ     6,,PR0
         2 000332   000010 772000                    QRL     8
         2 000333   000006 376007                    ANQ     6,DL
         2 000334   000003 736000                    QLS     3
         2 000335   040100 100406                    MLR     fill='040'O
         2 000336   000236 000020 0                  ADSC9   RING_TXT,Q               cn=0,n=16
         2 000337   200151 000020                    ADSC9   RING_WHO,,AUTO           cn=0,n=16

      188     5512    1      LEVEL = GD$MSG.TSA.S1.LEVEL;

   5512  2 000340   000006 235100                    LDA     6,,PR0
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:30   
         2 000341   000007 236100                    LDQ     7,,PR0
         2 000342   000040 773000                    LRL     32
         2 000343   000077 376007                    ANQ     63,DL
         2 000344   200150 756100                    STQ     LEVEL,,AUTO

      189     5513    1      CALL DFA$WRITE(VECTOR(F_TSA21),

   5513  2 000345   777640 235007                    LDA     -96,DL
         2 000346   200166 452500                    STP2    @I+2,,AUTO
         2 000347   200166 236100                    LDQ     @I+2,,AUTO
         2 000350   000022 036003                    ADLQ    18,DU
         2 000351   200170 757100                    STAQ    @I+4,,AUTO
         2 000352   000006 235000 3                  LDA     6
         2 000353   200172 452500                    STP2    @I+6,,AUTO
         2 000354   200172 236100                    LDQ     @I+6,,AUTO
         2 000355   000151 036003                    ADLQ    105,DU
         2 000356   200174 757100                    STAQ    @I+8,,AUTO
         2 000357   777640 235007                    LDA     -96,DL
         2 000360   200176 452500                    STP2    @I+10,,AUTO
         2 000361   200176 236100                    LDQ     @I+10,,AUTO
         2 000362   000150 036003                    ADLQ    104,DU
         2 000363   200202 757100                    STAQ    @I+14,,AUTO
         2 000364   200170 237100                    LDAQ    @I+4,,AUTO
         2 000365   200200 757100                    STAQ    @I+12,,AUTO
         2 000366   200174 237100                    LDAQ    @I+8,,AUTO
         2 000367   200204 757100                    STAQ    @I+16,,AUTO
         2 000370   200202 237100                    LDAQ    @I+14,,AUTO
         2 000371   200206 757100                    STAQ    @I+18,,AUTO
         2 000372   200206 631500                    EPPR1   @I+18,,AUTO
         2 000373   200213 451500                    STP1    @I+23,,AUTO
         2 000374   200204 633500                    EPPR3   @I+16,,AUTO
         2 000375   200212 453500                    STP3    @I+22,,AUTO
         2 000376   200200 634500                    EPPR4   @I+12,,AUTO
         2 000377   200211 454500                    STP4    @I+21,,AUTO
         2 000400   000012 236000 3                  LDQ     10
         2 000401   200210 756100                    STQ     @I+20,,AUTO
         2 000402   200210 630500                    EPPR0   @I+20,,AUTO
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:31   
         2 000403   000000 220000 xsym               LDX0    DFA$WRITE
         2 000404   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000405   000000 701010                    TSX1    0,X0
         2 000406   000000 011000                    NOP     0

      190     5514    1        VECTOR(SREG),
      191     5515    1        VECTOR(RING_WHO),
      192     5516    1        VECTOR(LEVEL));
      193     5517
      194     5518    1      ASV=-1;

   5518  2 000407   000001 335007                    LCA     1,DL
         2 000410   200014 755100                    STA     ASV,,AUTO

      195     5519    1      TSAP=-1;

   5519  2 000411   200015 755100                    STA     TSAP,,AUTO

      196     5520    1      NATSAP=-1;

   5520  2 000412   200016 755100                    STA     NATSAP,,AUTO

      197     5521    1      IREG=-1;

   5521  2 000413   200017 755100                    STA     IREG,,AUTO

      198     5522    1      TREG=-1;

   5522  2 000414   200020 755100                    STA     TREG,,AUTO

      199     5523
      200     5524    1      SREG=GD$MSG.TSA.ISA.S;

   5524  2 000415   000000 470400 xsym               LDP0    S_D_L6_MESSAGE$
         2 000416   000013 236100                    LDQ     11,,PR0
         2 000417   177777 376007                    ANQ     65535,DL
         2 000420   200022 756100                    STQ     SREG,,AUTO
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:32   

      201     5525    1      ISM1 = BITBIN(GD$MSG.TSA.ISA.ISM1);

   5525  2 000421   000011 235100                    LDA     9,,PR0
         2 000422   000012 236100                    LDQ     10,,PR0
         2 000423   000034 773000                    LRL     28
         2 000424   177777 376007                    ANQ     65535,DL
         2 000425   200003 756100                    STQ     ISM1,,AUTO

      202     5526    1      ISM2 = BITBIN(GD$MSG.TSA.ISA.ISM2);

   5526  2 000426   000012 236100                    LDQ     10,,PR0
         2 000427   000014 772000                    QRL     12
         2 000430   177777 376007                    ANQ     65535,DL
         2 000431   200004 756100                    STQ     ISM2,,AUTO

      203     5527    1      CHN=GD$MSG.TSA.ISA.DEV;

   5527  2 000432   000011 236100                    LDQ     9,,PR0
         2 000433   000010 772000                    QRL     8
         2 000434   177777 376007                    ANQ     65535,DL
         2 000435   200023 756100                    STQ     CHN,,AUTO

      204     5528
      205     5529    1      CALL DFA$WRITE(VECTOR(F_INFO1),

   5529  2 000436   777640 235007                    LDA     -96,DL
         2 000437   200166 452500                    STP2    @I+2,,AUTO
         2 000440   200166 236100                    LDQ     @I+2,,AUTO
         2 000441   000021 036003                    ADLQ    17,DU
         2 000442   200170 757100                    STAQ    @I+4,,AUTO
         2 000443   777640 235007                    LDA     -96,DL
         2 000444   200172 452500                    STP2    @I+6,,AUTO
         2 000445   200172 236100                    LDQ     @I+6,,AUTO
         2 000446   000022 036003                    ADLQ    18,DU
         2 000447   200174 757100                    STAQ    @I+8,,AUTO
         2 000450   777640 235007                    LDA     -96,DL
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:33   
         2 000451   200176 452500                    STP2    @I+10,,AUTO
         2 000452   200176 236100                    LDQ     @I+10,,AUTO
         2 000453   000023 036003                    ADLQ    19,DU
         2 000454   200200 757100                    STAQ    @I+12,,AUTO
         2 000455   777640 235007                    LDA     -96,DL
         2 000456   200202 452500                    STP2    @I+14,,AUTO
         2 000457   200202 236100                    LDQ     @I+14,,AUTO
         2 000460   000003 036003                    ADLQ    3,DU
         2 000461   200204 757100                    STAQ    @I+16,,AUTO
         2 000462   777640 235007                    LDA     -96,DL
         2 000463   200206 452500                    STP2    @I+18,,AUTO
         2 000464   200206 236100                    LDQ     @I+18,,AUTO
         2 000465   000004 036003                    ADLQ    4,DU
         2 000466   200212 757100                    STAQ    @I+22,,AUTO
         2 000467   200170 237100                    LDAQ    @I+4,,AUTO
         2 000470   200210 757100                    STAQ    @I+20,,AUTO
         2 000471   200174 237100                    LDAQ    @I+8,,AUTO
         2 000472   200214 757100                    STAQ    @I+24,,AUTO
         2 000473   200200 237100                    LDAQ    @I+12,,AUTO
         2 000474   200216 757100                    STAQ    @I+26,,AUTO
         2 000475   200204 237100                    LDAQ    @I+16,,AUTO
         2 000476   200220 757100                    STAQ    @I+28,,AUTO
         2 000477   200212 237100                    LDAQ    @I+22,,AUTO
         2 000500   200222 757100                    STAQ    @I+30,,AUTO
         2 000501   200222 631500                    EPPR1   @I+30,,AUTO
         2 000502   200231 451500                    STP1    @I+37,,AUTO
         2 000503   200220 633500                    EPPR3   @I+28,,AUTO
         2 000504   200230 453500                    STP3    @I+36,,AUTO
         2 000505   200216 634500                    EPPR4   @I+26,,AUTO
         2 000506   200227 454500                    STP4    @I+35,,AUTO
         2 000507   200214 635500                    EPPR5   @I+24,,AUTO
         2 000510   200226 455500                    STP5    @I+34,,AUTO
         2 000511   200210 636500                    EPPR6   @I+20,,AUTO
         2 000512   200225 456500                    STP6    @I+33,,AUTO
         2 000513   000016 236000 3                  LDQ     14
         2 000514   200224 756100                    STQ     @I+32,,AUTO
         2 000515   200224 630500                    EPPR0   @I+32,,AUTO
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:34   
         2 000516   000000 220000 xsym               LDX0    DFA$WRITE
         2 000517   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 000520   000000 701010                    TSX1    0,X0
         2 000521   000000 011000                    NOP     0

      206     5530    1        VECTOR(PREG),
      207     5531    1        VECTOR(SREG),
      208     5532    1        VECTOR(CHN),
      209     5533    1        VECTOR(ISM1),
      210     5534    1        VECTOR(ISM2));
      211     5535
      212     5536    1      NATSAP=GD$MSG.TSA.ISA.ISM2.NATSAP;

   5536  2 000522   000000 470400 xsym               LDP0    S_D_L6_MESSAGE$
         2 000523   000012 236100                    LDQ     10,,PR0
         2 000524   000030 772000                    QRL     24
         2 000525   000007 376007                    ANQ     7,DL
         2 000526   200016 756100                    STQ     NATSAP,,AUTO

      213     5537    1      IF NATSAP <=3

   5537  2 000527   000003 116007                    CMPQ    3,DL
         2 000530   000536 605400 2                  TPNZ    s:5539

      214     5538    1      THEN NATSAP_WHO = NATSAP_TEXT(NATSAP);

   5538  2 000531   000030 402007                    MPY     24,DL
         2 000532   040100 100406                    MLR     fill='040'O
         2 000533   000110 000030 0                  ADSC9   NATSAP_TEXT,Q            cn=0,n=24
         2 000534   200030 000030                    ADSC9   NATSAP_WHO,,AUTO         cn=0,n=24
         2 000535   000541 710000 2                  TRA     s:5541

      215     5539    1      ELSE CALL BINCHAR(NATSAP_WHO,NATSAP);

   5539  2 000536   000100 301500                    BTD
         2 000537   200016 000004                    NDSC9   NATSAP,,AUTO             cn=0,s=lsgnf,sf=0,n=4
         2 000540   200030 030030                    NDSC9   NATSAP_WHO,,AUTO         cn=0,s=nosgn,sf=0,n=24
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:35   

      216     5540
      217     5541    1      IF GD$MSG.TSA.ISA.ISM2.MMU

   5541  2 000541   000012 430100                    FSZN    10,,PR0
         2 000542   000546 605000 2                  TPL     s:5546

      218     5542    2      THEN DO;

      219     5543    2           ASV=GD$MSG.TSA.ISA.ASV$;

   5543  2 000543   000007 236100                    LDQ     7,,PR0
         2 000544   000002 376000 3                  ANQ     2
         2 000545   200014 756100                    STQ     ASV,,AUTO

      220     5544    2           END;

      221     5545
      222     5546    1      CALL DFA$WRITE(VECTOR(F_INFO3),

   5546  2 000546   000022 235000 3                  LDA     18
         2 000547   200166 452500                    STP2    @I+2,,AUTO
         2 000550   200166 236100                    LDQ     @I+2,,AUTO
         2 000551   000030 036003                    ADLQ    24,DU
         2 000552   200170 757100                    STAQ    @I+4,,AUTO
         2 000553   777640 235007                    LDA     -96,DL
         2 000554   200172 452500                    STP2    @I+6,,AUTO
         2 000555   200172 236100                    LDQ     @I+6,,AUTO
         2 000556   000014 036003                    ADLQ    12,DU
         2 000557   200176 757100                    STAQ    @I+10,,AUTO
         2 000560   200170 237100                    LDAQ    @I+4,,AUTO
         2 000561   200174 757100                    STAQ    @I+8,,AUTO
         2 000562   200176 237100                    LDAQ    @I+10,,AUTO
         2 000563   200200 757100                    STAQ    @I+12,,AUTO
         2 000564   200200 631500                    EPPR1   @I+12,,AUTO
         2 000565   200204 451500                    STP1    @I+16,,AUTO
         2 000566   200174 633500                    EPPR3   @I+8,,AUTO
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:36   
         2 000567   200203 453500                    STP3    @I+15,,AUTO
         2 000570   000023 236000 3                  LDQ     19
         2 000571   200202 756100                    STQ     @I+14,,AUTO
         2 000572   200202 630500                    EPPR0   @I+14,,AUTO
         2 000573   000000 220000 xsym               LDX0    DFA$WRITE
         2 000574   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000575   000000 701010                    TSX1    0,X0
         2 000576   000000 011000                    NOP     0

      223     5547    1        VECTOR(NATSAP_WHO), VECTOR(ASV));
      224     5548
      225     5549    1      ICBUF = ' ';

   5549  2 000577   040100 100400                    MLR     fill='040'O
         2 000600   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000601   200036 000055                    ADSC9   ICBUF,,AUTO              cn=0,n=45

      226     5550    1      CALL DDR$POSIT (PREG, ADDR(ICBUF), 45, ASIZE);

   5550  2 000602   200036 630500                    EPPR0   ICBUF,,AUTO
         2 000603   200166 450500                    STP0    @I+2,,AUTO
         2 000604   200052 631500                    EPPR1   ASIZE,,AUTO
         2 000605   200173 451500                    STP1    @I+7,,AUTO
         2 000606   000025 236000 3                  LDQ     21
         2 000607   200172 756100                    STQ     @I+6,,AUTO
         2 000610   200166 633500                    EPPR3   @I+2,,AUTO
         2 000611   200171 453500                    STP3    @I+5,,AUTO
         2 000612   200021 634500                    EPPR4   PREG,,AUTO
         2 000613   200170 454500                    STP4    @I+4,,AUTO
         2 000614   200170 630500                    EPPR0   @I+4,,AUTO
         2 000615   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000616   000000 701000 xent               TSX1    DDR$POSIT
         2 000617   000000 011000                    NOP     0

      227     5551    1      CALL DFA$WRITE(VECTOR(ICTEXT),VECTOR(ICBUF));

   5551  2 000620   000030 235000 3                  LDA     24
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:37   
         2 000621   200166 452500                    STP2    @I+2,,AUTO
         2 000622   200166 236100                    LDQ     @I+2,,AUTO
         2 000623   000036 036003                    ADLQ    30,DU
         2 000624   200170 757100                    STAQ    @I+4,,AUTO
         2 000625   200170 630500                    EPPR0   @I+4,,AUTO
         2 000626   200173 450500                    STP0    @I+7,,AUTO
         2 000627   000031 236000 3                  LDQ     25
         2 000630   200172 756100                    STQ     @I+6,,AUTO
         2 000631   200172 630500                    EPPR0   @I+6,,AUTO
         2 000632   000000 220000 xsym               LDX0    DFA$WRITE
         2 000633   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000634   000000 701010                    TSX1    0,X0
         2 000635   000000 011000                    NOP     0

      228     5552
      229     5553    1      CALL DFA$WRITE(VECTOR(F_REG2));

   5553  2 000636   000034 630400 3                  EPPR0   28
         2 000637   000000 220000 xsym               LDX0    DFA$WRITE
         2 000640   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000641   000000 701010                    TSX1    0,X0
         2 000642   000000 011000                    NOP     0

      230     5554
      231     5555    1      R$=ADDR(GD$MSG.TSA.ISA.REGS);

   5555  2 000643   000000 236000 xsym               LDQ     S_D_L6_MESSAGE$
         2 000644   000014 036003                    ADLQ    12,DU
         2 000645   200027 756100                    STQ     R$,,AUTO

      232     5556    2      DO I=6 DOWNTO 0;

   5556  2 000646   000006 235007                    LDA     6,DL
         2 000647   200026 755100                    STA     I,,AUTO

      233     5557    3           IF GD$MSG.TSA.ISA.ISM1.BREG(I) THEN DO;

PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:38   
   5557  2 000650   200026 235100                    LDA     I,,AUTO
         2 000651   000653 605000 2                  TPL     s:5557+3
         2 000652   000044 035003                    ADLA    36,DU
         2 000653   000000 470400 xsym               LDP0    S_D_L6_MESSAGE$
         2 000654   000000 066505                    CMPB    filb='0'B
         2 000655   000012 010001                    BDSC    10,A,PR0                 by=0,bit=1,n=1
         2 000656   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 000657   000675 600000 2                  TZE     s:5562

      234     5558    3                REGS.CONTENTS(I)=R32;

   5558  2 000660   200026 236100                    LDQ     I,,AUTO
         2 000661   000044 402007                    MPY     36,DL
         2 000662   000000 116003                    CMPQ    0,DU
         2 000663   000665 605000 2                  TPL     s:5558+5
         2 000664   000044 036003                    ADLQ    36,DU
         2 000665   200027 471500                    LDP1    R$,,AUTO
         2 000666   003106 061500                    CSR     bolr='003'O
         2 000667   100000 000040                    BDSC    0,,PR1                   by=0,bit=0,n=32
         2 000670   200005 000044                    BDSC    REGS,Q,AUTO              by=0,bit=0,n=36

      235     5559    3                R$=PINCRB(R$,32);

   5559  2 000671   000040 220003                    LDX0    32,DU
         2 000672   100000 503510                    ABD     0,X0,PR1
         2 000673   200027 451500                    STP1    R$,,AUTO

      236     5560    3                END;

   5560  2 000674   000700 710000 2                  TRA     s:5564

      237     5561    3           ELSE DO;

      238     5562    3                REGS.CONTENTS(I)=-1;

   5562  2 000675   000001 335007                    LCA     1,DL
         2 000676   200026 720100                    LXL0    I,,AUTO
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:39   
         2 000677   200005 755110                    STA     REGS,X0,AUTO

      239     5563    3                END;

      240     5564    2           IF I=2 THEN REGS.CONTENTS(2)=B3$;

   5564  2 000700   200026 235100                    LDA     I,,AUTO
         2 000701   000002 115007                    CMPA    2,DL
         2 000702   000705 601000 2                  TNZ     s:5565

   5564  2 000703   200157 236100                    LDQ     B3$,,AUTO
         2 000704   200007 756100                    STQ     REGS+2,,AUTO

      241     5565    2           END;

   5565  2 000705   000001 336007                    LCQ     1,DL
         2 000706   200026 056100                    ASQ     I,,AUTO
         2 000707   000650 605000 2                  TPL     s:5557

      242     5566    1      CALL DFA$WRITE(VECTOR(F_REG3),VECTOR(C_BREGS),VECTOR(REGS));

   5566  2 000710   000042 235000 3                  LDA     34
         2 000711   200166 452500                    STP2    @I+2,,AUTO
         2 000712   200166 236100                    LDQ     @I+2,,AUTO
         2 000713   000005 036003                    ADLQ    5,DU
         2 000714   200170 757100                    STAQ    @I+4,,AUTO
         2 000715   200170 631500                    EPPR1   @I+4,,AUTO
         2 000716   200174 451500                    STP1    @I+8,,AUTO
         2 000717   000044 237000 3                  LDAQ    36
         2 000720   200172 757100                    STAQ    @I+6,,AUTO
         2 000721   200172 630500                    EPPR0   @I+6,,AUTO
         2 000722   000000 220000 xsym               LDX0    DFA$WRITE
         2 000723   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000724   000000 701010                    TSX1    0,X0
         2 000725   000000 011000                    NOP     0

      243     5567
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:40   
      244     5568    2      IF GD$MSG.TSA.ISA.ISM1.I THEN DO;

   5568  2 000726   000000 470400 xsym               LDP0    S_D_L6_MESSAGE$
         2 000727   000012 234100                    SZN     10,,PR0
         2 000730   000740 605000 2                  TPL     s:5573

      245     5569    2           IREG=R16;

   5569  2 000731   200027 471500                    LDP1    R$,,AUTO
         2 000732   003100 061500                    CSR     bolr='003'O
         2 000733   100000 000020                    BDSC    0,,PR1                   by=0,bit=0,n=16
         2 000734   200017 000044                    BDSC    IREG,,AUTO               by=0,bit=0,n=36

      246     5570    2           R$=PINCRB(R$,16);

   5570  2 000735   000020 220003                    LDX0    16,DU
         2 000736   100000 503510                    ABD     0,X0,PR1
         2 000737   200027 451500                    STP1    R$,,AUTO

      247     5571    2           END;

      248     5572
      249     5573    2      DO I=6 DOWNTO 0;

   5573  2 000740   000006 235007                    LDA     6,DL
         2 000741   200026 755100                    STA     I,,AUTO

      250     5574    2           CALL RREG(GD$MSG.TSA.ISA.ISM1.RREG(I),I);

   5574  2 000742   200026 630500                    EPPR0   I,,AUTO
         2 000743   200164 450500                    STP0    @MASKBIT+1,,AUTO
         2 000744   000000 471400 xsym               LDP1    S_D_L6_MESSAGE$
         2 000745   200026 235100                    LDA     I,,AUTO
         2 000746   000541 035007                    ADLA    353,DL
         2 000747   000751 605000 2                  TPL     s:5574+7
         2 000750   000044 035003                    ADLA    36,DU
         2 000751   100000 503505                    ABD     0,AL,PR1
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:41   
         2 000752   200163 451500                    STP1    R3+3,,AUTO
         2 000753   001177 701000 2                  TSX1    RREG
         2 000754   000000 011000                    NOP     0

      251     5575    2           IF I=2 THEN REGS.CONTENTS(2) = R3;

   5575  2 000755   200026 235100                    LDA     I,,AUTO
         2 000756   000002 115007                    CMPA    2,DL
         2 000757   000762 601000 2                  TNZ     s:5576

   5575  2 000760   200160 236100                    LDQ     R3,,AUTO
         2 000761   200007 756100                    STQ     REGS+2,,AUTO

      252     5576    2           END;

   5576  2 000762   000001 336007                    LCQ     1,DL
         2 000763   200026 056100                    ASQ     I,,AUTO
         2 000764   000742 605000 2                  TPL     s:5574

      253     5577    1      CALL DFA$WRITE(VECTOR(F_REG3),VECTOR(C_RREGS),VECTOR(REGS));

   5577  2 000765   000042 235000 3                  LDA     34
         2 000766   200166 452500                    STP2    @I+2,,AUTO
         2 000767   200166 236100                    LDQ     @I+2,,AUTO
         2 000770   000005 036003                    ADLQ    5,DU
         2 000771   200170 757100                    STAQ    @I+4,,AUTO
         2 000772   200170 630500                    EPPR0   @I+4,,AUTO
         2 000773   200174 450500                    STP0    @I+8,,AUTO
         2 000774   000050 237000 3                  LDAQ    40
         2 000775   200172 757100                    STAQ    @I+6,,AUTO
         2 000776   200172 630500                    EPPR0   @I+6,,AUTO
         2 000777   000000 220000 xsym               LDX0    DFA$WRITE
         2 001000   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001001   000000 701010                    TSX1    0,X0
         2 001002   000000 011000                    NOP     0

      254     5578
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:42   
      255     5579    1      CALL RREG(GD$MSG.TSA.ISA.ISM1.M1,0);

   5579  2 001003   000001 236000 3                  LDQ     1
         2 001004   200164 756100                    STQ     @MASKBIT+1,,AUTO
         2 001005   000000 236000 xsym               LDQ     S_D_L6_MESSAGE$
         2 001006   000043 036000 3                  ADLQ    35
         2 001007   200163 756100                    STQ     R3+3,,AUTO
         2 001010   001177 701000 2                  TSX1    RREG
         2 001011   000000 011000                    NOP     0

      256     5580    2      DO I=1 TO 6;

   5580  2 001012   000001 235007                    LDA     1,DL
         2 001013   200026 755100                    STA     I,,AUTO

      257     5581    2           CALL RREG(GD$MSG.TSA.ISA.ISM2.M2_M7,I);

   5581  2 001014   200026 630500                    EPPR0   I,,AUTO
         2 001015   200164 450500                    STP0    @MASKBIT+1,,AUTO
         2 001016   000000 236000 xsym               LDQ     S_D_L6_MESSAGE$
         2 001017   000052 036000 3                  ADLQ    42
         2 001020   200163 756100                    STQ     R3+3,,AUTO
         2 001021   001177 701000 2                  TSX1    RREG
         2 001022   000000 011000                    NOP     0

      258     5582    2           END;

   5582  2 001023   200026 054100                    AOS     I,,AUTO
         2 001024   200026 235100                    LDA     I,,AUTO
         2 001025   000006 115007                    CMPA    6,DL
         2 001026   001014 604400 2                  TMOZ    s:5581

      259     5583    1      CALL DFA$WRITE(VECTOR(F_REG3),VECTOR(C_MREGS),VECTOR(REGS));

   5583  2 001027   000042 235000 3                  LDA     34
         2 001030   200166 452500                    STP2    @I+2,,AUTO
         2 001031   200166 236100                    LDQ     @I+2,,AUTO
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:43   
         2 001032   000005 036003                    ADLQ    5,DU
         2 001033   200170 757100                    STAQ    @I+4,,AUTO
         2 001034   200170 630500                    EPPR0   @I+4,,AUTO
         2 001035   200174 450500                    STP0    @I+8,,AUTO
         2 001036   000056 237000 3                  LDAQ    46
         2 001037   200172 757100                    STAQ    @I+6,,AUTO
         2 001040   200172 630500                    EPPR0   @I+6,,AUTO
         2 001041   000000 220000 xsym               LDX0    DFA$WRITE
         2 001042   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001043   000000 701010                    TSX1    0,X0
         2 001044   000000 011000                    NOP     0

      260     5584
      261     5585    2      IF GD$MSG.TSA.ISA.ISM2.T THEN DO;

   5585  2 001045   000000 470400 xsym               LDP0    S_D_L6_MESSAGE$
         2 001046   000012 236100                    LDQ     10,,PR0
         2 001047   020000 316007                    CANQ    8192,DL
         2 001050   001060 600000 2                  TZE     s:5589

      262     5586    2           TREG=R32;

   5586  2 001051   200027 471500                    LDP1    R$,,AUTO
         2 001052   003100 061500                    CSR     bolr='003'O
         2 001053   100000 000040                    BDSC    0,,PR1                   by=0,bit=0,n=32
         2 001054   200020 000044                    BDSC    TREG,,AUTO               by=0,bit=0,n=36

      263     5587    2           R$=PINCRB(R$,32);

   5587  2 001055   000040 220003                    LDX0    32,DU
         2 001056   100000 503510                    ABD     0,X0,PR1
         2 001057   200027 451500                    STP1    R$,,AUTO

      264     5588    2           END;

      265     5589    1      TSAP=GD$MSG.TSA.ISA.TSAP$;

PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:44   
   5589  2 001060   000010 235100                    LDA     8,,PR0
         2 001061   000011 236100                    LDQ     9,,PR0
         2 001062   000030 773000                    LRL     24
         2 001063   000002 376000 3                  ANQ     2
         2 001064   200015 756100                    STQ     TSAP,,AUTO

      266     5590
      267     5591    1      IF GD$MSG.TSA.ISA.ISM2.CIP

   5591  2 001065   000012 236100                    LDQ     10,,PR0
         2 001066   000004 316003                    CANQ    4,DU
         2 001067   001105 600000 2                  TZE     s:5599

      268     5592    2      THEN DO;

      269     5593    2           CIREG=R16;

   5593  2 001070   200027 471500                    LDP1    R$,,AUTO
         2 001071   003100 061500                    CSR     bolr='003'O
         2 001072   100000 000020                    BDSC    0,,PR1                   by=0,bit=0,n=16
         2 001073   200024 000044                    BDSC    CIREG,,AUTO              by=0,bit=0,n=36

      270     5594    2           R$=PINCRB(R$,16);

   5594  2 001074   000020 220003                    LDX0    16,DU
         2 001075   100000 503510                    ABD     0,X0,PR1
         2 001076   200027 451500                    STP1    R$,,AUTO

      271     5595    2           RDBR=R32;

   5595  2 001077   003100 061500                    CSR     bolr='003'O
         2 001100   100000 000040                    BDSC    0,,PR1                   by=0,bit=0,n=32
         2 001101   200025 000044                    BDSC    RDBR,,AUTO               by=0,bit=0,n=36

      272     5596    2           R$=PINCRC(R$,32);

   5596  2 001102   200027 236100                    LDQ     R$,,AUTO
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:45   
         2 001103   000010 036003                    ADLQ    8,DU
         2 001104   200027 756100                    STQ     R$,,AUTO

      273     5597    2           END;

      274     5598
      275     5599    1      CALL DFA$WRITE(VECTOR(F_INFO2),

   5599  2 001105   777640 235007                    LDA     -96,DL
         2 001106   200166 452500                    STP2    @I+2,,AUTO
         2 001107   200166 236100                    LDQ     @I+2,,AUTO
         2 001110   000015 036003                    ADLQ    13,DU
         2 001111   200170 757100                    STAQ    @I+4,,AUTO
         2 001112   777640 235007                    LDA     -96,DL
         2 001113   200172 452500                    STP2    @I+6,,AUTO
         2 001114   200172 236100                    LDQ     @I+6,,AUTO
         2 001115   000017 036003                    ADLQ    15,DU
         2 001116   200174 757100                    STAQ    @I+8,,AUTO
         2 001117   777640 235007                    LDA     -96,DL
         2 001120   200176 452500                    STP2    @I+10,,AUTO
         2 001121   200176 236100                    LDQ     @I+10,,AUTO
         2 001122   000020 036003                    ADLQ    16,DU
         2 001123   200200 757100                    STAQ    @I+12,,AUTO
         2 001124   777640 235007                    LDA     -96,DL
         2 001125   200202 452500                    STP2    @I+14,,AUTO
         2 001126   200202 236100                    LDQ     @I+14,,AUTO
         2 001127   000024 036003                    ADLQ    20,DU
         2 001130   200204 757100                    STAQ    @I+16,,AUTO
         2 001131   777640 235007                    LDA     -96,DL
         2 001132   200206 452500                    STP2    @I+18,,AUTO
         2 001133   200206 236100                    LDQ     @I+18,,AUTO
         2 001134   000025 036003                    ADLQ    21,DU
         2 001135   200212 757100                    STAQ    @I+22,,AUTO
         2 001136   200170 237100                    LDAQ    @I+4,,AUTO
         2 001137   200210 757100                    STAQ    @I+20,,AUTO
         2 001140   200174 237100                    LDAQ    @I+8,,AUTO
         2 001141   200214 757100                    STAQ    @I+24,,AUTO
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:46   
         2 001142   200200 237100                    LDAQ    @I+12,,AUTO
         2 001143   200216 757100                    STAQ    @I+26,,AUTO
         2 001144   200204 237100                    LDAQ    @I+16,,AUTO
         2 001145   200220 757100                    STAQ    @I+28,,AUTO
         2 001146   200212 237100                    LDAQ    @I+22,,AUTO
         2 001147   200222 757100                    STAQ    @I+30,,AUTO
         2 001150   200222 631500                    EPPR1   @I+30,,AUTO
         2 001151   200231 451500                    STP1    @I+37,,AUTO
         2 001152   200220 633500                    EPPR3   @I+28,,AUTO
         2 001153   200230 453500                    STP3    @I+36,,AUTO
         2 001154   200216 634500                    EPPR4   @I+26,,AUTO
         2 001155   200227 454500                    STP4    @I+35,,AUTO
         2 001156   200214 635500                    EPPR5   @I+24,,AUTO
         2 001157   200226 455500                    STP5    @I+34,,AUTO
         2 001160   200210 636500                    EPPR6   @I+20,,AUTO
         2 001161   200225 456500                    STP6    @I+33,,AUTO
         2 001162   000053 236000 3                  LDQ     43
         2 001163   200224 756100                    STQ     @I+32,,AUTO
         2 001164   200224 630500                    EPPR0   @I+32,,AUTO
         2 001165   000000 220000 xsym               LDX0    DFA$WRITE
         2 001166   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 001167   000000 701010                    TSX1    0,X0
         2 001170   000000 011000                    NOP     0

      276     5600    1        VECTOR(TSAP),
      277     5601    1        VECTOR(IREG),
      278     5602    1        VECTOR(TREG),
      279     5603    1        VECTOR(CIREG),
      280     5604    1        VECTOR(RDBR));
      281     5605
      282     5606    1   RET:
      283     5607    1      RETURN;

   5607  2 001171   000000 702200 xent  RET          TSX2  ! X66_ARET

      284     5608
      285     5609    1   ERR:
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:47   
      286     5610    1      CALL DUE$ERRMSG;

   5610  2 001172   000002 631400 xsym  ERR          EPPR1   B_VECTNIL+2
         2 001173   000000 701000 xent               TSX1    DUE$ERRMSG
         2 001174   000000 011000                    NOP     0

      287     5611    1      RETURN;

   5611  2 001175   000000 702200 xent               TSX2  ! X66_ARET

      288     5612
      289     5613    1   ARET:
      290     5614    1      ALTRETURN;

   5614  2 001176   000000 702200 xent  ARET         TSX2  ! X66_AALT

      291     5615
      292     5616        %EJECT;
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:48   
      293     5617
      294     5618    1   RREG: PROC(MASKBIT,I);

   5618  2 001177   200162 741300       RREG         STX1  ! R3+2,,AUTO

      295     5619
      296     5620    2   DCL MASKBIT BIT(1) UNAL;
      297     5621    2   DCL I SBIN;
      298     5622
      299     5623    3      IF MASKBIT THEN DO;

   5623  2 001200   200163 470500                    LDP0    @MASKBIT,,AUTO
         2 001201   000000 066500                    CMPB    filb='0'B
         2 001202   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         2 001203   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 001204   001224 600000 2                  TZE     s:5628

      300     5624    3           REGS.CONTENTS(I)=R16;

   5624  2 001205   200164 471500                    LDP1    @I,,AUTO
         2 001206   100000 235100                    LDA     0,,PR1
         2 001207   000044 733000                    LRS     36
         2 001210   000044 402007                    MPY     36,DL
         2 001211   000000 116003                    CMPQ    0,DU
         2 001212   001214 605000 2                  TPL     s:5624+7
         2 001213   000044 036003                    ADLQ    36,DU
         2 001214   200027 473500                    LDP3    R$,,AUTO
         2 001215   003106 061500                    CSR     bolr='003'O
         2 001216   300000 000020                    BDSC    0,,PR3                   by=0,bit=0,n=16
         2 001217   200005 000044                    BDSC    REGS,Q,AUTO              by=0,bit=0,n=36

      301     5625    3           R$=PINCRB(R$,16);

   5625  2 001220   000020 220003                    LDX0    16,DU
         2 001221   300000 503510                    ABD     0,X0,PR3
         2 001222   200027 453500                    STP3    R$,,AUTO

PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:49   
      302     5626    3           END;

   5626  2 001223   001230 710000 2                  TRA     s:5630

      303     5627    3      ELSE DO;

      304     5628    3           REGS.CONTENTS(I)=-1;

   5628  2 001224   200164 471500                    LDP1    @I,,AUTO
         2 001225   100000 235100                    LDA     0,,PR1
         2 001226   000001 336007                    LCQ     1,DL
         2 001227   200005 756105                    STQ     REGS,AL,AUTO

      305     5629    3           END;

      306     5630    2      RETURN;

   5630  2 001230   200162 221300                    LDX1  ! R3+2,,AUTO
         2 001231   000001 702211                    TSX2  ! 1,X1

F_REG2
 Sect OctLoc
   0     000   045057 040040   040040 040040   040040 040040   040040 040040    %/
   0     004   137137 137137   137061 040137   137137 137137   062040 137137    _____1 _____2 __
   0     010   137137 137063   040137 137137   137137 064040   137137 137137    ___3 _____4 ____
   0     014   137065 040137   137137 137137   066040 137137   137137 137067    _5 _____6 _____7

F_REG3
 Sect OctLoc
   0     020   045101 040122   145147 151163   164145 162163   072040 040045    %A Registers:  %
   0     024   067050 045066   052110 040045   051*** ******                    7(%6*H %)...

C_BREGS
 Sect OctLoc
   0     027   102*** ******                                                    B...

C_RREGS
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:50   
 Sect OctLoc
   0     030   122*** ******                                                    R...

C_MREGS
 Sect OctLoc
   0     031   115*** ******                                                    M...

F_INFO1
 Sect OctLoc
   0     032   045057 111123   101040 055040   120072 040056   045070 114110    %/ISA - P: .%8LH
   0     036   040123 072040   056045 064132   110040 103110   116072 040056     S: .%4ZH CHN: .
   0     042   045064 132110   040111 123115   061072 040056   045064 132110    %4ZH ISM1: .%4ZH
   0     046   040111 123115   062072 040056   045064 132110                     ISM2: .%4ZH

ICTEXT
 Sect OctLoc
   0     051   040040 040040   040040 111156   164145 162162   165160 164145          Interrupte
   0     055   144040 141144   144162 145163   163072 040045   076101 ******    d address: %>A..

F_INFO2
 Sect OctLoc
   0     061   045057 124123   101120 044072   040056 045070   114052 110040    %/TSAP$: .%8L*H
   0     065   111072 040056   045064 132052   110040 124044   072040 056045    I: .%4Z*H T$: .%
   0     071   070114 052110   040103 111072   040056 045064   132110 040122    8L*H CI: .%4ZH R
   0     075   104102 122044   072040 056045   070114 110***                    DBR$: .%8LH.

F_INFO3
 Sect OctLoc
   0     100   040040 040040   040040 116101   124123 101120   072040 045101          NATSAP: %A
   0     104   040040 101123   126044 072040   056045 070114   052110 ******      ASV$: .%8L*H..

NATSAP_TEXT
 Sect OctLoc
   0     110   060040 055040   115157 156151   164157 162057   123143 150145    0 - Monitor/Sche
   0     114   144165 154145   162040 040040   061040 055040   125163 145162    duler   1 - User
   0     120   057125 163145   162040 123145   162166 151143   145040 040040    /User Service
   0     124   062040 055040   110141 156144   154145 162040   141164 040111    2 - Handler at I
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:51   
   0     130   156164 040114   145166 145154                                    nt Level

SNAP_MESSAGE
 Sect OctLoc
   0     132   000001 777640   000140 006000   000000 177640   000000 006014    .....`..........
   0     136   000000 177640   000000 006014                                    ........

SC_MESSAGE
 Sect OctLoc
   0     140   042530 013325   000000 101740                                    ".....A.

VLP_ERRCODE
 Sect OctLoc
   0     142   071002 400000                                                    9...

FPT_ERRMSG
 Sect OctLoc
   0     144   000003 777640   000172 006000   000000 177640   000000 006014    .....z..........
   0     150   000000 177640   000000 006014   000000 177640   000000 006014    ................
   0     170*  000000 177640   000000 006014   000000 000000   000000 000000    ................
   0     174   371000 030001   040000 000000                                    .... ...

F_TSA1
 Sect OctLoc
   0     176   124122 101120   072040 045104   040124 123101   114044 072040    TRAP: %D TSAL$:
   0     202   056045 070114   110040 111072   040056 045064   132110 040111    .%8LH I: .%4ZH I
   0     206   116123 124072   040056 045064   132110 040132   072040 056045    NST: .%4ZH Z: .%
   0     212   064132 110040   101044 072040   056045 070114   110*** ******    4ZH A$: .%8LH...

(unnamed)
 Sect OctLoc
   0     216   120072 040056   045070 114110   040040 102063   072040 056045    P: .%8LH  B3: .%
   0     222   070114 110040   040122 063072   040056 045064   114110 ******    8LH  R3: .%4LH..

F_TSA21
 Sect OctLoc
   0     226   123072 040056   045064 132110   040040 040122   151156 147072    S: .%4ZH   Ring:
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:52   
   0     232   040045 101040   040040 114145   166145 154072   040045 104***     %A   Level: %D.

RING_TXT
 Sect OctLoc
   0     236   063040 055040   125163 145162   040040 040040   040040 040040    3 - User
   0     242   062040 055040   104145 142165   147147 145162   040040 040040    2 - Debugger
   0     246   061040 055040   115157 156057   110141 156144   154145 162040    1 - Mon/Handler
   0     252   060040 055040   115157 156057   110141 156144   154145 162040    0 - Mon/Handler

(unnamed)
 Sect OctLoc
   3     000   001777 777777   000002 006000   037777 777777   000004 006000    ................
   3     004   000017 177640   000176 006000   000003 777640   000035 777640    .....~..........
   3     010   000007 577640   000226 006000   000010 006000   000000 000000    ................
   3     014   000016 777640   000032 006000   000014 006000   000000 000000    ................
   3     020   000007 377640   000100 006000   000005 777640   000020 006000    .....@..........
   3     024   000000 000055   000024 006000   000007 377640   000051 006000    ...-.........)..
   3     030   000013 177640   000026 006000   000017 777640   000000 006000    ................
   3     034   000032 006000   000000 000000   000006 177640   000020 006000    ................
   3     040   000000 177640   000027 006000   000006 777640   000011 610000    ................
   3     044   000036 006000   000040 006000   000000 177640   000030 006000    ..... ..........
   3     050   000036 006000   000046 006000   000012 450000   000060 006000    .....&.......0..
   3     054   000000 177640   000031 006000   000036 006000   000054 006000    .............,..
   3     060   000016 577640   000061 006000                                    .....1..
      307     5631
      308     5632    2   END RREG;
      309     5633
      310     5634    1   END DFA$TSA;
      311     5635
      312     5636        %EOD;

PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:53   
--  Include file information  --

   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   DU_SCODE_C.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   GD_EQUS_E.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   DD$BASED.:E05TOU  is referenced.
   GD$MSG_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure DFA$TSA.

   Procedure DFA$TSA requires 666 words for executable code.
   Procedure DFA$TSA requires 162 words of local(AUTO) storage.
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:54   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:55   
          MINI XREF LISTING

A$
      5430**DCL      5486<<ASSIGN   5491--CALL
ARET
      5614**LABEL    5467--GOTO     5477--GOTO
ASIZE
        55**DCL      5550<>CALL
ASV
        20**DCL      5518<<ASSIGN   5543<<ASSIGN   5546--CALL
B3$
      5432**DCL      5488<<ASSIGN   5564>>ASSIGN
CHN
        28**DCL      5527<<ASSIGN   5529--CALL
CIREG
        30**DCL      5593<<ASSIGN   5599--CALL
C_BREGS
        47**DCL      5566--CALL
C_MREGS
        49**DCL      5583--CALL
C_RREGS
        48**DCL      5577--CALL
DDE$ERROR
      5114**DCL-ENT  5473--CALL     5475--CALL
DDR$POSIT
      5115**DCL-ENT  5550--CALL
DFA$WRITE
        11**DCL      5491>>CALL     5513>>CALL     5529>>CALL     5546>>CALL     5551>>CALL     5553>>CALL
      5566>>CALL     5577>>CALL     5583>>CALL     5599>>CALL
DFQ$READ_FD
      5112**DCL-ENT  5456--CALL
DFQ$WRITE_FD
      5111**DCL-ENT  5455--CALL
DUE$ERRMSG
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:56   
      5113**DCL-ENT  5610--CALL
D_M$DO#
        12**DCL      5505>>ASSIGN
ERR
      5610**LABEL    5455--CALLALT  5456--CALLALT
ERRBUF
      5420**DCL      5504--ASSIGN
FPRG$CONTEXT.XDELTA
      4491**DCL      5463>>IF
FPT$ERRMSG
      5404**DCL      5502<<ASSIGN   5508<>CALL
FPT$ERRMSG.BUF_
      5404**DCL      5504<<ASSIGN
FPT$ERRMSG.CODE_
      5404**DCL      5506<<ASSIGN
FPT$ERRMSG.V
      5408**DCL      5503--ASSIGN
FPT$ERRMSG.V.OUTDCB1#
      5409**DCL      5505<<ASSIGN
FPT$ERRMSG.V_
      5404**DCL      5503<<ASSIGN
FPT_ERRMSG
      5377**DCL      5502>>ASSIGN
FPT_ERRMSG.V
      5381**DCL      5377--DCLINIT
F_INFO1
        51**DCL      5529--CALL
F_INFO2
        57**DCL      5599--CALL
F_INFO3
        60**DCL      5546--CALL
F_REG2
        42**DCL      5553--CALL
F_REG3
        44**DCL      5566--CALL     5577--CALL     5583--CALL
F_TSA1
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:57   
      5436**DCL      5491--CALL
F_TSA21
      5442**DCL      5513--CALL
GD$MSG
       249**DCL      5452<<ASSIGN
GD$MSG.BRKRQS.IF$CONST.SIZE
       300**DCL       300--REDEF
GD$MSG.BRKRQS.IF$CONST.TEXT
       300**DCL       301--REDEF     301--REDEF     302--REDEF     303--REDEF
GD$MSG.BRKRSP.BRK#
       314**DCL       314--REDEF
GD$MSG.BRKRSP.USER#
       314**DCL       314--REDEF
GD$MSG.FNC
       249**DCL      5453<<ASSIGN   5457>>IF       5459>>DOCASE   5463>>IF
GD$MSG.LETMEM_D.VALUE.SIZE
       272**DCL       272--REDEF
GD$MSG.LETMEM_D.VALUE.TEXT
       273**DCL       273--REDEF     273--REDEF     274--REDEF     275--REDEF
GD$MSG.MESSAGE
       254**DCL       254--REDEF     255--REDEF     255--REDEF     256--REDEF     267--REDEF     280--REDEF
       285--REDEF     292--REDEF     308--REDEF     313--REDEF     319--REDEF     320--REDEF     349--REDEF
       351--REDEF     362--REDEF     369--REDEF     381--REDEF
GD$MSG.SUBFNC
       249**DCL       249--REDEF     253--REDEF
GD$MSG.TSA.A$
       322**DCL      5486>>ASSIGN
GD$MSG.TSA.ADDRESS$
       320**DCL      5454<<ASSIGN
GD$MSG.TSA.B3$
       323**DCL      5488>>ASSIGN
GD$MSG.TSA.I
       321**DCL       321--REDEF    5481>>ASSIGN
GD$MSG.TSA.INST
       322**DCL      5484>>ASSIGN
GD$MSG.TSA.IREG.TRAPNO
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:58   
       321**DCL      5482>>ASSIGN
GD$MSG.TSA.ISA.ASV$
       331**DCL      5543>>ASSIGN
GD$MSG.TSA.ISA.DEV
       331**DCL      5527>>ASSIGN
GD$MSG.TSA.ISA.ISM1
       332**DCL      5525>>ASSIGN
GD$MSG.TSA.ISA.ISM1.BREG
       340**DCL      5557>>IF
GD$MSG.TSA.ISA.ISM1.I
       340**DCL      5568>>IF
GD$MSG.TSA.ISA.ISM1.M1
       336**DCL      5579<>CALL
GD$MSG.TSA.ISA.ISM1.RREG
       336**DCL      5574<>CALL
GD$MSG.TSA.ISA.ISM2
       340**DCL      5526>>ASSIGN
GD$MSG.TSA.ISA.ISM2.CIP
       344**DCL      5591>>IF
GD$MSG.TSA.ISA.ISM2.M2_M7
       348**DCL      5581<>CALL
GD$MSG.TSA.ISA.ISM2.MMU
       344**DCL      5541>>IF
GD$MSG.TSA.ISA.ISM2.NATSAP
       344**DCL      5536>>ASSIGN
GD$MSG.TSA.ISA.ISM2.T
       348**DCL      5585>>IF
GD$MSG.TSA.ISA.REGS
       348**DCL      5555--ASSIGN
GD$MSG.TSA.ISA.S
       348**DCL      5524>>ASSIGN
GD$MSG.TSA.ISA.TSAP$
       331**DCL      5589>>ASSIGN
GD$MSG.TSA.P$$
       322**DCL      5487>>ASSIGN
GD$MSG.TSA.R3
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:59   
       321**DCL      5483>>ASSIGN
GD$MSG.TSA.S
       323**DCL       323--REDEF    5489>>ASSIGN
GD$MSG.TSA.S1.LEVEL
       331**DCL      5512>>ASSIGN
GD$MSG.TSA.S1.RING
       327**DCL      5511>>ASSIGN
GD$MSG.TSA.TSAL$
       320**DCL      5480>>ASSIGN
GD$MSG.TSA.Z
       322**DCL      5485>>ASSIGN
GD$MSG.USERQS.ASDT$
       349**DCL       349--REDEF     350--REDEF
I
        33**DCL      5556<<DOINDEX  5557>>IF       5558>>ASSIGN   5562>>ASSIGN   5564>>IF       5573<<DOINDEX
      5574>>CALL     5574<>CALL     5575>>IF       5580<<DOINDEX  5581<>CALL
I IN PROCEDURE RREG
      5621**DCL      5618--PROC     5624>>ASSIGN   5628>>ASSIGN
ICBUF
        54**DCL      5549<<ASSIGN   5550--CALL     5551--CALL
ICTEXT
        56**DCL      5551--CALL
INST
      5423**DCL      5484<<ASSIGN   5491--CALL
IREG
        23**DCL      5481<<ASSIGN   5491--CALL     5521<<ASSIGN   5569<<ASSIGN   5599--CALL
ISM1
        14**DCL      5525<<ASSIGN   5529--CALL
ISM2
        15**DCL      5526<<ASSIGN   5529--CALL
LEVEL
      5427**DCL      5512<<ASSIGN   5513--CALL
M$ERRMSG
      5189**DCL-ENT  5508--CALL
M$SCREECH
      5140**DCL-ENT  5470--CALL
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:60   
MASKBIT IN PROCEDURE RREG
      5620**DCL      5618--PROC     5623>>IF
NATSAP
        22**DCL      5520<<ASSIGN   5536<<ASSIGN   5537>>IF       5538>>ASSIGN   5539>>CALLBLT
NATSAP_TEXT
        63**DCL      5538>>ASSIGN
NATSAP_WHO
        38**DCL      5538<<ASSIGN   5539<<CALLBLT  5546--CALL
NEVER
      5472**LABEL    5469--REMEMBR  5470--CALLALT
PREG
        26**DCL      5487<<ASSIGN   5529--CALL     5550<>CALL
R$
        34**DCL        35--IMP-PTR    36--IMP-PTR  5555<<ASSIGN   5558>>ASSIGN   5559<<ASSIGN   5559>>ASSIGN
      5569>>ASSIGN   5570<<ASSIGN   5570>>ASSIGN   5586>>ASSIGN   5587<<ASSIGN   5587>>ASSIGN   5593>>ASSIGN
      5594<<ASSIGN   5594>>ASSIGN   5595>>ASSIGN   5596<<ASSIGN   5596>>ASSIGN   5624>>ASSIGN   5625<<ASSIGN
      5625>>ASSIGN
R16
        36**DCL      5569>>ASSIGN   5593>>ASSIGN   5624>>ASSIGN
R3
      5433**DCL      5483<<ASSIGN   5575>>ASSIGN
R32
        35**DCL      5558>>ASSIGN   5586>>ASSIGN   5595>>ASSIGN
RDBR
        31**DCL      5595<<ASSIGN   5599--CALL
REGS
        17**DCL      5566--CALL     5577--CALL     5583--CALL
REGS.CONTENTS
        18**DCL      5558<<ASSIGN   5562<<ASSIGN   5564<<ASSIGN   5575<<ASSIGN   5624<<ASSIGN   5628<<ASSIGN
RING_TXT
      5446**DCL      5511>>ASSIGN
RING_WHO
      5428**DCL      5511<<ASSIGN   5513--CALL
RREG
      5618**PROC     5574--CALL     5579--CALL     5581--CALL
SC_MESSAGE
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:61   
      5230**DCL      5210--DCLINIT
SNAP_MESSAGE
      5210**DCL      5470<>CALL
SREG
        27**DCL      5489<<ASSIGN   5513--CALL     5524<<ASSIGN   5529--CALL
S_D.CURRENT_CHANNEL
      4063**DCL      4065--REDEF
S_D.CURRENT_FPRG_CONTEXT$
      3263**DCL      5455<>CALL     5456<>CALL     5463>>IF
S_D.DEBUGA
      3215**DCL      3217--REDEF
S_D.DO$
      3166**DCL      5454>>ASSIGN
S_D.EIS
      4173**DCL      4202--REDEF
S_D.ERROR
      3144**DCL      5461<<ASSIGN   5466<<ASSIGN   5472<<ASSIGN   5474<<ASSIGN
S_D.HOST_MESSAGE_BUF_REMOTE
      4106**DCL      4107--REDEF    4121--REDEF
S_D.JDE
      3720**DCL      3721--REDEF
S_D.L$.VALUE
      3273**DCL      3279--REDEF    3287--REDEF    3290--REDEF    3293--REDEF    3296--REDEF
S_D.L$.VALUE.L
      3274**DCL      3275--REDEF    3276--REDEF
S_D.L6_MESSAGE_BUF
      4127**DCL      4129--REDEF
S_D.OUTPUT
      4093**DCL      4095--REDEF
S_D.REMOTE_MSG.FNCC
      4112**DCL      4113--REDEF
S_D.REMOTE_MSG.STXC
      4108**DCL      4109--REDEF
S_D.REMOTE_MSG.SUBFNCC
      4116**DCL      4117--REDEF
S_D.SCREECH_IC
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:62   
      3964**DCL      5469<<REMEMBR
S_D.SV
      3172**DCL      3193--REDEF
S_D$
      4424**DCL      3120--IMP-PTR  5454>>ASSIGN   5455>>CALL     5456>>CALL     5461>>ASSIGN   5463>>IF
      5466>>ASSIGN   5469>>REMEMBR  5472>>ASSIGN   5474>>ASSIGN
S_D_L6_MESSAGE$
      4461**DCL       249--IMP-PTR  5452>>ASSIGN   5453>>ASSIGN   5454>>ASSIGN   5457>>IF       5459>>DOCASE
      5463>>IF       5480>>ASSIGN   5481>>ASSIGN   5482>>ASSIGN   5483>>ASSIGN   5484>>ASSIGN   5485>>ASSIGN
      5486>>ASSIGN   5487>>ASSIGN   5488>>ASSIGN   5489>>ASSIGN   5511>>ASSIGN   5512>>ASSIGN   5524>>ASSIGN
      5525>>ASSIGN   5526>>ASSIGN   5527>>ASSIGN   5536>>ASSIGN   5541>>IF       5543>>ASSIGN   5555>>ASSIGN
      5557>>IF       5568>>IF       5574>>CALL     5579>>CALL     5581>>CALL     5585>>IF       5589>>ASSIGN
      5591>>IF
TRAPNO
      5425**DCL      5482<<ASSIGN   5491--CALL     5499>>IF       5507>>ASSIGN
TREG
        24**DCL      5522<<ASSIGN   5586<<ASSIGN   5599--CALL
TSA$CMD.ADDRESS
      4475**DCL      5454>>ASSIGN
TSAL
      5422**DCL      5480<<ASSIGN   5491--CALL
TSAP
        21**DCL      5519<<ASSIGN   5589<<ASSIGN   5599--CALL
VLP$ERRCODE
      5333**DCL      5501<<ASSIGN   5506--ASSIGN
VLP$ERRCODE.ERR#
      5363**DCL      5507<<ASSIGN
VLP_ERRCODE
      5288**DCL      5501>>ASSIGN
ZREG
      5424**DCL      5485<<ASSIGN   5491--CALL
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:63   
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:64   
              MINI UREF LISTING

DFA$TSA       9**PROC
F_TSA2    5439**DCL
M$ACCT    5143**DCL-ENT
M$ACTIVATE    5146**DCL-ENT
M$ALIB    5139**DCL-ENT
M$ASUSER    5141**DCL-ENT
M$ATTACH    5148**DCL-ENT
M$BADPP    5166**DCL-ENT
M$CGCTL    5147**DCL-ENT
M$CGINFO    5147**DCL-ENT
M$CHECK    5128**DCL-ENT
M$CHGUNIT    5186**DCL-ENT
M$CLOSE    5126**DCL-ENT
M$CLRSTK    5184**DCL-ENT
M$CMDVAR    5195**DCL-ENT
M$CONFIG    5156**DCL-ENT
M$CORRES    5131**DCL-ENT
M$CPEXIT    5140**DCL-ENT
M$CVM    5164**DCL-ENT
M$CVOL    5129**DCL-ENT
M$DCLFLD    5156**DCL-ENT
M$DEACTIVATE    5146**DCL-ENT
M$DELREC    5128**DCL-ENT
M$DEQ    5193**DCL-ENT
M$DETACH    5148**DCL-ENT
M$DEVICE    5130**DCL-ENT
M$DISPLAY    5193**DCL-ENT
M$DISPRES    5133**DCL-ENT
M$DLIB    5139**DCL-ENT
M$DRIBBLE    5156**DCL-ENT
M$DRTN    5184**DCL-ENT
M$DSUSER    5141**DCL-ENT
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:65   
M$ENQ    5192**DCL-ENT
M$EOM    5151**DCL-ENT
M$ERASE    5157**DCL-ENT
M$ERR    5138**DCL-ENT
M$EVENT    5181**DCL-ENT
M$EXHUME    5190**DCL-ENT
M$EXIT    5138**DCL-ENT
M$EXTEND    5130**DCL-ENT
M$FDP    5162**DCL-ENT
M$FDS    5161**DCL-ENT
M$FEBOOT    5154**DCL-ENT
M$FECTL    5155**DCL-ENT
M$FEDUMP    5154**DCL-ENT
M$FID    5189**DCL-ENT
M$FINDPROC    5143**DCL-ENT
M$FSUSER    5141**DCL-ENT
M$FVP    5163**DCL-ENT
M$FWCG    5147**DCL-ENT
M$GBPL    5167**DCL-ENT
M$GDDL    5163**DCL-ENT
M$GDP    5162**DCL-ENT
M$GDS    5161**DCL-ENT
M$GETDCB    5132**DCL-ENT
M$GETMOUSE    5172**DCL-ENT
M$GETPM    5173**DCL-ENT
M$GJOB    5191**DCL-ENT
M$GLINEATTR    5151**DCL-ENT
M$GOODPP    5166**DCL-ENT
M$GPLATEN    5159**DCL-ENT
M$GPROMPT    5158**DCL-ENT
M$GTRMATTR    5152**DCL-ENT
M$GTRMCTL    5150**DCL-ENT
M$GTRMTAB    5153**DCL-ENT
M$GVP    5162**DCL-ENT
M$HELP    5189**DCL-ENT
M$INT    5181**DCL-ENT
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:66   
M$INTRTN    5142**DCL-ENT
M$IOQ    5177**DCL-ENT
M$JOBSTATS    5191**DCL-ENT
M$KEYIN    5131**DCL-ENT
M$LDEV    5126**DCL-ENT
M$LDTRC    5139**DCL-ENT
M$LIMIT    5132**DCL-ENT
M$LINES    5131**DCL-ENT
M$LINK    5138**DCL-ENT
M$MADMUCK    5134**DCL-ENT
M$MAKUSER    5165**DCL-ENT
M$MBS    5133**DCL-ENT
M$MDFFLD    5157**DCL-ENT
M$MERC    5182**DCL-ENT
M$MERCS    5183**DCL-ENT
M$MIRROR    5177**DCL-ENT
M$MONINFO    5194**DCL-ENT
M$MPL    5167**DCL-ENT
M$NODEINFO    5158**DCL-ENT
M$NXTUSR    5192**DCL-ENT
M$OCMSG    5190**DCL-ENT
M$OLAY    5138**DCL-ENT
M$OPEN    5126**DCL-ENT
M$PAS    5167**DCL-ENT
M$PATHCON    5190**DCL-ENT
M$PDS    5161**DCL-ENT
M$PFIL    5128**DCL-ENT
M$PLATEN    5152**DCL-ENT
M$PRECORD    5130**DCL-ENT
M$PROCNAME    5143**DCL-ENT
M$PROFILE    5154**DCL-ENT
M$PROMPT    5150**DCL-ENT
M$RACST    5134**DCL-ENT
M$RDSYSLOG    5175**DCL-ENT
M$READ    5127**DCL-ENT
M$RELDCB    5132**DCL-ENT
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:67   
M$RELRES    5133**DCL-ENT
M$RELSTARF    5135**DCL-ENT
M$REM    5135**DCL-ENT
M$RENV    5182**DCL-ENT
M$REQUIRE    5134**DCL-ENT
M$RETRY    5183**DCL-ENT
M$RETRYS    5183**DCL-ENT
M$REW    5129**DCL-ENT
M$RLSFLD    5157**DCL-ENT
M$RPRIV    5185**DCL-ENT
M$RSPP    5164**DCL-ENT
M$RSWITCH    5186**DCL-ENT
M$RUE    5192**DCL-ENT
M$SAD    5165**DCL-ENT
M$SAVE    5141**DCL-ENT
M$SCON    5142**DCL-ENT
M$SENV    5182**DCL-ENT
M$SETFMA    5126**DCL-ENT
M$SETFP    5155**DCL-ENT
M$SINPUT    5153**DCL-ENT
M$SLCFLD    5158**DCL-ENT
M$SMOUSE    5172**DCL-ENT
M$SMPRT    5164**DCL-ENT
M$SPRIV    5185**DCL-ENT
M$SSC    5165**DCL-ENT
M$SSWITCH    5185**DCL-ENT
M$STATE    5194**DCL-ENT
M$STD    5166**DCL-ENT
M$STIMER    5180**DCL-ENT
M$STLPP    5163**DCL-ENT
M$STRAP    5180**DCL-ENT
M$STRMATTR    5152**DCL-ENT
M$STRMCTL    5150**DCL-ENT
M$STRMTAB    5153**DCL-ENT
M$SYMBIO    5191**DCL-ENT
M$SYSCON    5177**DCL-ENT
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:68   
M$SYSID    5195**DCL-ENT
M$TDCLOSE    5176**DCL-ENT
M$TDIO    5176**DCL-ENT
M$TDOPEN    5175**DCL-ENT
M$TDREQCPU    5176**DCL-ENT
M$TEMPWROC    5170**DCL-ENT
M$TIME    5193**DCL-ENT
M$TRAP    5180**DCL-ENT
M$TRMISC    5155**DCL-ENT
M$TRMPRG    5151**DCL-ENT
M$TRTN    5184**DCL-ENT
M$TRUNC    5127**DCL-ENT
M$TTIMER    5180**DCL-ENT
M$UC    5150**DCL
M$UMPL    5167**DCL-ENT
M$UNFID    5189**DCL-ENT
M$UNLATCH    5146**DCL-ENT
M$UNSHARE    5143**DCL-ENT
M$USRFIELD    5186**DCL-ENT
M$VIRTUAL    5161**DCL-ENT
M$WAIT    5184**DCL-ENT
M$WEOF    5129**DCL-ENT
M$WRITE    5127**DCL-ENT
M$WRSYSLOG    5175**DCL-ENT
M$XCON    5181**DCL-ENT
M$XCONRTN    5142**DCL-ENT
M$XEQTIME    5194**DCL-ENT
M$XFLUSH    5135**DCL-ENT
M$XMOUSE    5172**DCL-ENT
M$XXX    5138**DCL-ENT
M$YC    5140**DCL-ENT
P    5431**DCL
RET    5607**LABEL
S_D_ACCESS$    4439**DCL
S_D_ANLZ$    4441**DCL
S_D_ASTACKOFF$    4440**DCL
PL6.E3A0      #001=DFA$TSA File=DFA$TSA.:E05TSI                                  TUE 07/29/97 14:37 Page:69   
S_D_BREAK$    4442**DCL
S_D_DO_SCAN$    4443**DCL
S_D_ERROR$    4444**DCL
S_D_FAULTCMD$$    4445**DCL
S_D_FAULTINS$$    4446**DCL
S_D_GOIC$    4447**DCL
S_D_GO_MODE$    4448**DCL
S_D_HOST_MESSAGE$    4460**DCL
S_D_HW_PTB_UNITS$    4464**DCL
S_D_HW_RES_MEM$    4462**DCL
S_D_HW_WSQ0PT$    4463**DCL
S_D_IPRFLT$    4450**DCL
S_D_IXFIX$    4449**DCL
S_D_REM_ACCESS$    4451**DCL
S_D_REM_DISKBOOT$    4453**DCL
S_D_REM_DO_SCAN$    4452**DCL
S_D_RETURNN$    4454**DCL
S_D_SAD$    4455**DCL
S_D_SAVEIC$    4456**DCL
S_D_SEG$    4438**DCL
S_D_TCB$$    4457**DCL
S_D_UREG$$    4458**DCL
S_D_USS$$    4459**DCL

PL6.E3A0      #002=DFA$FORMAT File=DFA$TSA.:E05TSI                               TUE 07/29/97 14:37 Page:70   
      313        1        /*T***********************************************************/
      314        2        /*T*                                                         */
      315        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      316        4        /*T*                                                         */
      317        5        /*T***********************************************************/
      318        6        DFA$FORMAT: PROC(FMT,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18,
                 6            V19,V20);
      319        7    1   DCL FMT BIT(72) ALIGNED;
      320        8    1   DCL V1 BIT(72) ALIGNED;
      321        9    1   DCL V2 BIT(72) ALIGNED;
      322       10    1   DCL V3 BIT(72) ALIGNED;
      323       11    1   DCL V4 BIT(72) ALIGNED;
      324       12    1   DCL V5 BIT(72) ALIGNED;
      325       13    1   DCL V6 BIT(72) ALIGNED;
      326       14    1   DCL V7 BIT(72) ALIGNED;
      327       15    1   DCL V8 BIT(72) ALIGNED;
      328       16    1   DCL V9 BIT(72) ALIGNED;
      329       17    1   DCL V10 BIT(72) ALIGNED;
      330       18    1   DCL V11 BIT(72) ALIGNED;
      331       19    1   DCL V12 BIT(72) ALIGNED;
      332       20    1   DCL V13 BIT(72) ALIGNED;
      333       21    1   DCL V14 BIT(72) ALIGNED;
      334       22    1   DCL V15 BIT(72) ALIGNED;
      335       23    1   DCL V16 BIT(72) ALIGNED;
      336       24    1   DCL V17 BIT(72) ALIGNED;
      337       25    1   DCL V18 BIT(72) ALIGNED;
      338       26    1   DCL V19 BIT(72) ALIGNED;
      339       27    1   DCL V20 BIT(72) ALIGNED;
      340       28        /**/
      341       29    1   DCL DFA$WRITE EPTR CONSTANT SYMDEF INIT(ENTADDR(DFA$FORMAT));
      342       30        %INCLUDE XU_FORMAT_C;
      343      192        %F_FDS (NAME=F_FDS,STCLASS=CONSTANT,EDIT=DFA$EDIT,TRUNC=NO);
      344      305    1   DCL DFA$EDIT ENTRY(2) ALTRET;
      345      306        %INCLUDE F$DCB;
      346      355        %F_FDS (NAME=F$FDS,STCLASS=AUTO);
      347      468    1   DCL X$FORMAT ENTRY(1);
      348      469        %INCLUDE B_SEGIDS_C;
PL6.E3A0      #002=DFA$FORMAT File=DFA$TSA.:E05TSI                               TUE 07/29/97 14:37 Page:71   
      349     1008    1   DCL 1 X1 CONSTANT ALIGNED,
      350     1009    1         2 * UBIN(24) UNAL INIT(0),
      351     1010    1         2 * BIT(12) INIT(%AUTOSID);
      352     1011    1   DCL AUTO$ REDEF X1 PTR;
      353     1012    1   DCL ARG$ PTR;
      354     1013    1   DCL 1 AFRAME BASED(ARG$),
      355     1014    1         2 *(0:2) SBIN,
      356     1015    1         2 FMT$ PTR,
      357     1016    1         2 VEC$(0:19) PTR;
      358     1017    1   DCL DATAVEC BIT(72) ALIGNED BASED;
      359     1018    1   DCL 1 STACK BASED(AUTO$),
      360     1019    1         2 * SBIN HALF HALIGNED,
      361     1020    1         2 OFFSET SBIN HALF HALIGNED;
      362     1021    1   DCL I SBIN;
      363     1022    1   DCL BUFFER CHAR(120);
      364     1023    1   DCL VECTR(0:19) BIT(72);
      365     1024    1   DCL D_M$DO# UBIN SYMREF;
      366     1025        %EJECT;
PL6.E3A0      #002=DFA$FORMAT File=DFA$TSA.:E05TSI                               TUE 07/29/97 14:37 Page:72   
      367     1026    1      F$FDS = F_FDS;
      368     1027    1      ARG$=PINCRW(AUTO$,-1-STACK.OFFSET);
      369     1028    1      F$FDS.FMT_=FMT;
      370     1029    1      I=0;
      371     1030    2      DO WHILE(I<20 AND AFRAME.VEC$(I)~=ADDR(NIL));
      372     1031    2           VECTR(I)=AFRAME.VEC$(I)->DATAVEC;
      373     1032    2           I=I+1;
      374     1033    2           END;
      375     1034    1      F$FDS.VECTR$=ADDR(VECTR);
      376     1035    1      F$FDS.NVECS#=I;
      377     1036    1      I = DCBADDR(D_M$DO#)->F$DCB.WIDTH;
      378     1037    1      IF I<60 OR I>120 THEN I=80;
      379     1038    1      F$FDS.BUF_ = VECTOR(SUBSTR(BUFFER,0,I));
      380     1039    1      F$FDS.DCB# = D_M$DO#;
      381     1040    1      CALL X$FORMAT(F$FDS);
      382     1041    1      RETURN;
      383     1042    1   END DFA$FORMAT;
      384     1043        %EOD;

PL6.E3A0      #002=DFA$FORMAT File=DFA$TSA.:E05TSI                               TUE 07/29/97 14:37 Page:73   
--  Include file information  --

   B_SEGIDS_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DFA$FORMAT.

   Procedure DFA$FORMAT requires 72 words for executable code.
   Procedure DFA$FORMAT requires 128 words of local(AUTO) storage.

PL6.E3A0      #002=DFA$FORMAT File=DFA$TSA.:E05TSI                               TUE 07/29/97 14:37 Page:74   

 Object Unit name= DFA$FORMAT                                 File name= DFA$TSA.:E05TOU
 UTS= JUL 29 '97 14:37:35.80 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     32     40  DFA$FORMAT
    1   Proc  even  none    72    110  DFA$FORMAT
    2  RoData even  none     1      1  DFA$FORMAT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std       21  DFA$FORMAT

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  DFA$WRITE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 DFA$EDIT
         yes           Std       1 X$FORMAT
         yes           Std      21 DFA$FORMAT
                       nStd      0 X66_AUTO_N
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #002=DFA$FORMAT File=DFA$TSA.:E05TSI                               TUE 07/29/97 14:37 Page:75   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     D_M$DO#                               B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ROSID
PL6.E3A0      #002=DFA$FORMAT File=DFA$TSA.:E05TSI                               TUE 07/29/97 14:37 Page:76   


      313        1        /*T***********************************************************/
      314        2        /*T*                                                         */
      315        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      316        4        /*T*                                                         */
      317        5        /*T***********************************************************/
      318        6       DFA$FORMAT: PROC(FMT,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18,
                 6            V19,V20);

      6  1 000000   000000 700200 xent  DFA$FORMAT   TSX0  ! X66_AUTO_N
         1 000001   000200 000025                    ZERO    128,21

      319        7    1   DCL FMT BIT(72) ALIGNED;
      320        8    1   DCL V1 BIT(72) ALIGNED;
      321        9    1   DCL V2 BIT(72) ALIGNED;
      322       10    1   DCL V3 BIT(72) ALIGNED;
      323       11    1   DCL V4 BIT(72) ALIGNED;
      324       12    1   DCL V5 BIT(72) ALIGNED;
      325       13    1   DCL V6 BIT(72) ALIGNED;
      326       14    1   DCL V7 BIT(72) ALIGNED;
      327       15    1   DCL V8 BIT(72) ALIGNED;
      328       16    1   DCL V9 BIT(72) ALIGNED;
      329       17    1   DCL V10 BIT(72) ALIGNED;
      330       18    1   DCL V11 BIT(72) ALIGNED;
      331       19    1   DCL V12 BIT(72) ALIGNED;
      332       20    1   DCL V13 BIT(72) ALIGNED;
      333       21    1   DCL V14 BIT(72) ALIGNED;
      334       22    1   DCL V15 BIT(72) ALIGNED;
      335       23    1   DCL V16 BIT(72) ALIGNED;
      336       24    1   DCL V17 BIT(72) ALIGNED;
      337       25    1   DCL V18 BIT(72) ALIGNED;
      338       26    1   DCL V19 BIT(72) ALIGNED;
      339       27    1   DCL V20 BIT(72) ALIGNED;
      340       28        /**/
      341       29    1   DCL DFA$WRITE EPTR CONSTANT SYMDEF INIT(ENTADDR(DFA$FORMAT));
      342       30        %INCLUDE XU_FORMAT_C;
      343      192        %F_FDS (NAME=F_FDS,STCLASS=CONSTANT,EDIT=DFA$EDIT,TRUNC=NO);
PL6.E3A0      #002=DFA$FORMAT File=DFA$TSA.:E05TSI                               TUE 07/29/97 14:37 Page:77   
      344      305    1   DCL DFA$EDIT ENTRY(2) ALTRET;
      345      306        %INCLUDE F$DCB;
      346      355        %F_FDS (NAME=F$FDS,STCLASS=AUTO);
      347      468    1   DCL X$FORMAT ENTRY(1);
      348      469        %INCLUDE B_SEGIDS_C;
      349     1008    1   DCL 1 X1 CONSTANT ALIGNED,
      350     1009    1         2 * UBIN(24) UNAL INIT(0),
      351     1010    1         2 * BIT(12) INIT(%AUTOSID);
      352     1011    1   DCL AUTO$ REDEF X1 PTR;
      353     1012    1   DCL ARG$ PTR;
      354     1013    1   DCL 1 AFRAME BASED(ARG$),
      355     1014    1         2 *(0:2) SBIN,
      356     1015    1         2 FMT$ PTR,
      357     1016    1         2 VEC$(0:19) PTR;
      358     1017    1   DCL DATAVEC BIT(72) ALIGNED BASED;
      359     1018    1   DCL 1 STACK BASED(AUTO$),
      360     1019    1         2 * SBIN HALF HALIGNED,
      361     1020    1         2 OFFSET SBIN HALF HALIGNED;
      362     1021    1   DCL I SBIN;
      363     1022    1   DCL BUFFER CHAR(120);
      364     1023    1   DCL VECTR(0:19) BIT(72);
      365     1024    1   DCL D_M$DO# UBIN SYMREF;
      366     1025        %EJECT;
PL6.E3A0      #002=DFA$FORMAT File=DFA$TSA.:E05TSI                               TUE 07/29/97 14:37 Page:78   
      367     1026    1      F$FDS = F_FDS;

   1026  1 000002   000100 100400                    MLR     fill='000'O
         1 000003   000001 000170 0                  ADSC9   F_FDS                    cn=0,n=120
         1 000004   200030 000170                    ADSC9   F$FDS,,AUTO              cn=0,n=120

      368     1027    1      ARG$=PINCRW(AUTO$,-1-STACK.OFFSET);

   1027  1 000005   000037 470400 0                  LDP0    X1
         1 000006   000100 100500                    MLR     fill='000'O
         1 000007   000000 400002                    ADSC9   0,,PR0                   cn=2,n=2
         1 000010   200176 000004                    ADSC9   VECTR+40,,AUTO           cn=0,n=4
         1 000011   200176 236100                    LDQ     VECTR+40,,AUTO
         1 000012   000022 732000                    QRS     18
         1 000013   000022 736000                    QLS     18
         1 000014   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 000015   777777 136007                    SBLQ    -1,DL
         1 000016   000037 036000 0                  ADLQ    X1
         1 000017   200066 756100                    STQ     ARG$,,AUTO

      369     1028    1      F$FDS.FMT_=FMT;

   1028  1 000020   200003 471500                    LDP1    @FMT,,AUTO
         1 000021   000100 100500                    MLR     fill='000'O
         1 000022   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         1 000023   200030 000010                    ADSC9   F$FDS,,AUTO              cn=0,n=8

      370     1029    1      I=0;

   1029  1 000024   200067 450100                    STZ     I,,AUTO

      371     1030    2      DO WHILE(I<20 AND AFRAME.VEC$(I)~=ADDR(NIL));

   1030  1 000025   000040 710000 1                  TRA     s:1033

      372     1031    2           VECTR(I)=AFRAME.VEC$(I)->DATAVEC;

PL6.E3A0      #002=DFA$FORMAT File=DFA$TSA.:E05TSI                               TUE 07/29/97 14:37 Page:79   
   1031  1 000026   200067 235100                    LDA     I,,AUTO
         1 000027   000001 735000                    ALS     1
         1 000030   200066 470500                    LDP0    ARG$,,AUTO
         1 000031   200067 720100                    LXL0    I,,AUTO
         1 000032   000004 471510                    LDP1    4,X0,PR0
         1 000033   000002 735000                    ALS     2
         1 000034   000105 100500                    MLR     fill='000'O
         1 000035   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         1 000036   200126 000010                    ADSC9   VECTR,A,AUTO             cn=0,n=8

      373     1032    2           I=I+1;

   1032  1 000037   200067 054100                    AOS     I,,AUTO

      374     1033    2           END;

   1033  1 000040   200067 235100                    LDA     I,,AUTO
         1 000041   000024 115007                    CMPA    20,DL
         1 000042   000047 605000 1                  TPL     s:1034
         1 000043   200066 470500                    LDP0    ARG$,,AUTO
         1 000044   000004 236105                    LDQ     4,AL,PR0
         1 000045   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000046   000026 601000 1                  TNZ     s:1031

      375     1034    1      F$FDS.VECTR$=ADDR(VECTR);

   1034  1 000047   200126 630500                    EPPR0   VECTR,,AUTO
         1 000050   200042 450500                    STP0    F$FDS+10,,AUTO

      376     1035    1      F$FDS.NVECS#=I;

   1035  1 000051   200067 235100                    LDA     I,,AUTO
         1 000052   200041 755100                    STA     F$FDS+9,,AUTO

      377     1036    1      I = DCBADDR(D_M$DO#)->F$DCB.WIDTH;

   1036  1 000053   000000 471400 2                  LDP1    0
PL6.E3A0      #002=DFA$FORMAT File=DFA$TSA.:E05TSI                               TUE 07/29/97 14:37 Page:80   
         1 000054   100000 473500                    LDP3    0,,PR1
         1 000055   000000 720000 xsym               LXL0    D_M$DO#
         1 000056   300000 474510                    LDP4    0,X0,PR3
         1 000057   400004 236100                    LDQ     4,,PR4
         1 000060   000777 376007                    ANQ     511,DL
         1 000061   200067 756100                    STQ     I,,AUTO

      378     1037    1      IF I<60 OR I>120 THEN I=80;

   1037  1 000062   000074 116007                    CMPQ    60,DL
         1 000063   000066 604000 1                  TMI     s:1037+4
         1 000064   000170 116007                    CMPQ    120,DL
         1 000065   000070 604400 1                  TMOZ    s:1038

   1037  1 000066   000120 235007                    LDA     80,DL
         1 000067   200067 755100                    STA     I,,AUTO

      379     1038    1      F$FDS.BUF_ = VECTOR(SUBSTR(BUFFER,0,I));

   1038  1 000070   200067 235100                    LDA     I,,AUTO
         1 000071   000020 735000                    ALS     16
         1 000072   000140 135007                    SBLA    96,DL
         1 000073   200176 452500                    STP2    VECTR+40,,AUTO
         1 000074   200176 236100                    LDQ     VECTR+40,,AUTO
         1 000075   000070 036003                    ADLQ    56,DU
         1 000076   200035 755100                    STA     F$FDS+5,,AUTO
         1 000077   200036 756100                    STQ     F$FDS+6,,AUTO

      380     1039    1      F$FDS.DCB# = D_M$DO#;

   1039  1 000100   200043 740100                    STX0    F$FDS+11,,AUTO

      381     1040    1      CALL X$FORMAT(F$FDS);

   1040  1 000101   200030 635500                    EPPR5   F$FDS,,AUTO
         1 000102   200176 455500                    STP5    VECTR+40,,AUTO
         1 000103   200176 630500                    EPPR0   VECTR+40,,AUTO
PL6.E3A0      #002=DFA$FORMAT File=DFA$TSA.:E05TSI                               TUE 07/29/97 14:37 Page:81   
         1 000104   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000105   000000 701000 xent               TSX1    X$FORMAT
         1 000106   000000 011000                    NOP     0

      382     1041    1      RETURN;

   1041  1 000107   000000 702200 xent               TSX2  ! X66_ARET

DFA$WRITE
 Sect OctLoc
   0     000   000000 000000                                                    ....

F_FDS
 Sect OctLoc
   0     001   000000 177640   000000 006014   000000 000000   000000 000000    ................
   0     005   000000 000000   000000 177640   000000 006014   000000 000001    ................
   0     011   000000 000000   000000 000000   000000 006014   000000 101100    ..............A@
   0     015   000000 000000   000000 000000   000000 000001   000000 000012    ................
   0     021   000000 000000   ****** ******   ****** ******   000000 000000    ................
   0     025   000000 000000   000000 000000   000000 000000   000000 006014    ................
   0     031   000000 006014   000000 006014   000000 006014   000000 000000    ................
   0     035   000000 000000   000000 000000                                    ........

X1
 Sect OctLoc
   0     037   000000 006004                                                    ....

(unnamed)
 Sect OctLoc
   2     000   000000 006003                                                    ....
      383     1042    1   END DFA$FORMAT;
      384     1043        %EOD;

PL6.E3A0      #002=DFA$FORMAT File=DFA$TSA.:E05TSI                               TUE 07/29/97 14:37 Page:82   
--  Include file information  --

   B_SEGIDS_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DFA$FORMAT.

   Procedure DFA$FORMAT requires 72 words for executable code.
   Procedure DFA$FORMAT requires 128 words of local(AUTO) storage.
PL6.E3A0      #002=DFA$FORMAT File=DFA$TSA.:E05TSI                               TUE 07/29/97 14:37 Page:83   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=DFA$FORMAT File=DFA$TSA.:E05TSI                               TUE 07/29/97 14:37 Page:84   
          MINI XREF LISTING

AFRAME.VEC$
      1016**DCL      1030>>DOWHILE  1031>>ASSIGN
ARG$
      1012**DCL      1013--IMP-PTR  1027<<ASSIGN   1030>>DOWHILE  1031>>ASSIGN
AUTO$
      1011**DCL      1018--IMP-PTR  1027>>ASSIGN   1027>>ASSIGN
BUFFER
      1022**DCL      1038--ASSIGN
DATAVEC
      1017**DCL      1031>>ASSIGN
DFA$EDIT
       305**DCL-ENT   265--DCLINIT
DFA$FORMAT
         6**PROC       29--DCLINIT
D_M$DO#
      1024**DCL      1036--ASSIGN   1039>>ASSIGN
F$DCB.ACTPOS
       332**DCL       332--REDEF
F$DCB.ARS
       307**DCL       307--REDEF
F$DCB.ATTR
       325**DCL       326--REDEF
F$DCB.BORROW
       340**DCL       340--REDEF     340--REDEF     340--REDEF
F$DCB.DCBNAME.L
       354**DCL       354--IMP-SIZ
F$DCB.EOMCHAR
       311**DCL       311--REDEF
F$DCB.FLDID
       335**DCL       335--REDEF
F$DCB.FORM$
       329**DCL       329--REDEF
PL6.E3A0      #002=DFA$FORMAT File=DFA$TSA.:E05TSI                               TUE 07/29/97 14:37 Page:85   
F$DCB.FSECT
       345**DCL       345--REDEF
F$DCB.FSN
       322**DCL       322--REDEF     322--REDEF     323--REDEF
F$DCB.HEADER$
       328**DCL       328--REDEF
F$DCB.IXTNSIZE
       326**DCL       326--REDEF
F$DCB.LASTSTA$
       316**DCL       316--REDEF
F$DCB.LVL
       341**DCL       341--REDEF
F$DCB.NAME.C
       316**DCL       316--REDEF
F$DCB.NOEOF
       337**DCL       337--REDEF
F$DCB.NRECS
       327**DCL       327--REDEF
F$DCB.NRECX
       346**DCL       346--REDEF
F$DCB.OHDR
       338**DCL       338--REDEF
F$DCB.ORG
       321**DCL       321--REDEF
F$DCB.PRECNO
       344**DCL       344--REDEF
F$DCB.RCSZ
       349**DCL       349--REDEF
F$DCB.RES
       317**DCL       317--REDEF
F$DCB.SETX
       329**DCL       329--REDEF
F$DCB.TAB$
       328**DCL       329--REDEF
F$DCB.TDA
       343**DCL       343--REDEF
PL6.E3A0      #002=DFA$FORMAT File=DFA$TSA.:E05TSI                               TUE 07/29/97 14:37 Page:86   
F$DCB.WIDTH
       314**DCL      1036>>ASSIGN
F$DCB.WSN
       318**DCL       318--REDEF
F$FDS
       369**DCL      1026<<ASSIGN   1040<>CALL
F$FDS.BUF_
       386**DCL      1038<<ASSIGN
F$FDS.DCB#
       402**DCL      1039<<ASSIGN
F$FDS.FMT_
       373**DCL      1028<<ASSIGN
F$FDS.NVECS#
       397**DCL      1035<<ASSIGN
F$FDS.VECTR$
       399**DCL      1034<<ASSIGN
FMT
         7**DCL         6--PROC     1028>>ASSIGN
F_FDS
       206**DCL      1026>>ASSIGN
I
      1021**DCL      1029<<ASSIGN   1030>>DOWHILE  1030>>DOWHILE  1031>>ASSIGN   1031>>ASSIGN   1032<<ASSIGN
      1032>>ASSIGN   1035>>ASSIGN   1036<<ASSIGN   1037>>IF       1037>>IF       1037<<ASSIGN   1038>>ASSIGN
STACK.OFFSET
      1020**DCL      1027>>ASSIGN
V1
         8**DCL         6--PROC
V10
        17**DCL         6--PROC
V11
        18**DCL         6--PROC
V12
        19**DCL         6--PROC
V13
        20**DCL         6--PROC
V14
PL6.E3A0      #002=DFA$FORMAT File=DFA$TSA.:E05TSI                               TUE 07/29/97 14:37 Page:87   
        21**DCL         6--PROC
V15
        22**DCL         6--PROC
V16
        23**DCL         6--PROC
V17
        24**DCL         6--PROC
V18
        25**DCL         6--PROC
V19
        26**DCL         6--PROC
V2
         9**DCL         6--PROC
V20
        27**DCL         6--PROC
V3
        10**DCL         6--PROC
V4
        11**DCL         6--PROC
V5
        12**DCL         6--PROC
V6
        13**DCL         6--PROC
V7
        14**DCL         6--PROC
V8
        15**DCL         6--PROC
V9
        16**DCL         6--PROC
VECTR
      1023**DCL      1031<<ASSIGN   1034--ASSIGN
X$FORMAT
       468**DCL-ENT  1040--CALL
X1
      1008**DCL      1011--REDEF
PL6.E3A0      #002=DFA$FORMAT File=DFA$TSA.:E05TSI                               TUE 07/29/97 14:37 Page:88   
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #002=DFA$FORMAT File=DFA$TSA.:E05TSI                               TUE 07/29/97 14:37 Page:89   
              MINI UREF LISTING

DFA$WRITE      29**DCL

PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:90   
      385        1        /*T***********************************************************/
      386        2        /*T*                                                         */
      387        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      388        4        /*T*                                                         */
      389        5        /*T***********************************************************/
      390        6        DFA$EDIT: PROC(FDS,CNT) ALTRET;
      391        7
      392        8        %INCLUDE CP_6;
      393       89        %INCLUDE XU_FORMAT_C;
      394      251
      395      252        %FPT_GETDCB (STCLASS=CONSTANT, FPTN=CGETDCB, DCBNAME=DCB_NAME, MERGE=YES,
      396      253                     DCBNUM=COPNFMT.V.DCB#);
      397      268        %FPT_GETDCB (FPTN=GETDCB, STCLASS=AUTO);
      398      283        %VLP_NAME (STCLASS=CONSTANT, FPTN=DCB_NAME, NAME='M$DELTA_FMT');
      399      310        %FPT_OPEN (STCLASS=CONSTANT, FPTN=COPNFMT, ASN=FILE, NAME=FMT_NAME, SETDCB=YES,
      400      311                   FUN=IN, REASSIGN=YES, SCRUB=YES, UOPT1=NO, ACS=DIRECT);
      401      420        %FPT_OPEN (FPTN=OPNFMT, STCLASS=AUTO);
      402      529    1   DCL 1 OPNCLS BASED ALIGNED,
      403      530    1         2 * BIT(18),2 CTL BIT(18);
      404      531        %VLP_NAME (FPTN=FMT_NAME, NAME=':FORMAT', STCLASS=CONSTANT);
      405      558        %VLP_ACCT (FPTN=SYSACCT, ACCT=':SYS', STCLASS=CONSTANT);
      406      571
      407      572        %F$DCB;
      408      629        %EQU M$FMT=CHARTEXT('DCBADDR(OPNFMT.V.DCB#)->F$DCB');
      409      630
      410      631        %FPT_READ (FPTN=CREDFMT, STCLASS=CONSTANT, KEY=CREDFMT, KEYS=YES);
      411      670        %FPT_READ (FPTN=REDFMT, STCLASS=AUTO);
      412      709    1   DCL 1 FMTKEY BASED(VEC0$) ALIGNED,
      413      710    1         2 DATSIZ UBIN,
      414      711    1         2 L UBIN(9) UNAL,
      415      712    1         2 T CHAR(31);
      416      713
      417      714        %F_FDS (NAME=FDS, STCLASS=PARAM);
      418      827    1   DCL CNT(0:4) SBIN PARAM;
      419      828
      420      829    1   DCL 1 MEMVEC(0:0) BASED(FDS.VECTR$),
      421      830    1         2 BOUND UBIN(20) UNAL,
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:91   
      422      831    1         2 * BIT(16),
      423      832    1         2 PTR$ PTR;
      424      833    1   DCL FMT CHAR(FDS.FMTSIZE) BASED(FDS.FMT_.FMT$);
      425      834    1   DCL BUF CHAR(FDS.BUFSIZE) BASED(FDS.BUF_.BUF$);
      426      835    1   DCL VEC0$ PTR;
      427      836    1   DCL I UBIN;
      428      837    1   DCL I$ REDEF I PTR;
      429      838    1   DCL 1 SYM,
      430      839    1         2 L UBIN(9) UNAL,
      431      840    1         2 T CHAR(63);
      432      841    1   DCL X UBIN;
      433      842    1   DCL ADDRESS SBIN;
      434      843    1   DCL SEG SBIN;
      435      844    1   DCL NODE SBIN;
      436      845    1   DCL DESC# SBIN;
      437      846    1   DCL NOT_IS BIT(1);
      438      847    1   DCL DATSIZ SBIN BASED(VEC0$) ALIGNED;
      439      848    1   DCL DIRECT EPTR;
      440      849    1   DCL 1 CMEM,
      441      850    1         2 * UBIN,
      442      851    1         2 VAL(0:15) UBIN,
      443      852    1         2 VALB(0:15) REDEF VAL BIT(36);
      444      853    1   DCL BUBIN UBIN BASED ALIGNED;
      445      854    1   DCL BHBIN UBIN HALF BASED ALIGNED;
      446      855    1   DCL 1 B$EDEF BASED ALIGNED,2 * BIT(9),2 ISADDR UBIN(27) UNAL;
      447      856    1   DCL 1 BPTR BASED ALIGNED,
      448      857    1         2 OFFSET UBIN HALF UNAL,
      449      858    1         2 SEGTYP UBIN(8) UNAL,
      450      859    1         2 SEGNUM UBIN(10) UNAL;
      451      860    1   DCL 1 TEXTH BASED ALIGNED,
      452      861    1         2 C UBIN HALF CALIGNED,
      453      862    1         2 T CHAR(TEXTH.C) CALIGNED;
      454      863
      455      864    1   DCL DDB$BREAK ENTRY ALTRET;
      456      865    1   DCL DDK$GETMVAL ENTRY(5) ALTRET;
      457      866    1   DCL DDS$IC2NODE ENTRY(2) ALTRET;
      458      867    1   DCL DDR$POSIT ENTRY(5) ALTRET;
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:92   
      459      868    1   DCL DUU$GETMVAL ENTRY(6) ALTRET;
      460      869    1   DCL DFK$GETMVAL ENTRY(6) ALTRET;
      461      870    1   DCL DUL$GETMVAL ENTRY(5) ALTRET;
      462      871    1   DCL DDS$ED_SRCH ENTRY(2) ALTRET;
      463      872    1   DCL DDS$SD_SRCH ENTRY(2) ALTRET;
      464      873        %INCLUDE DD_SD_M;
      465     2209        %INCLUDE XUH_MACRO_C;
      466     2293        %S_D;
      467     3611        %EJECT;
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:93   
      468     3612    1      VEC0$=PINCRW(MEMVEC.PTR$(0),-SIZEW(FMTKEY));
      469     3613    2      CALL DDB$BREAK WHENALTRETURN DO;
      470     3614    2           UNWIND TO FDS.BAILOUT;
      471     3615    2           END;
      472     3616    2      IF SUBSTR(FMT,0,4)~='%(%)' THEN DO;
      473     3617    2           FMTKEY.L=0;
      474     3618    2           DATSIZ=0;
      475     3619    2           END;
      476     3620    2      DO CASE(CNT(0));
      477     3621    2       CASE(0);                            /* DOT PREV FIELD                     */
      478     3622    3         CALL INDEX1R(I,' ',BUF,FDS.BUFX) WHENRETURN DO;
      479     3623    3              SUBSTR(BUF,I,1)='.';
      480     3624    3              END;
      481     3625    2       CASE(1);                  /* Next to format: addr in CNT(1), FMT follows  */
      482     3626                                                /* Ignore in DELTA                    */
      483     3627    2       CASE (2, 10);                       /* Fix size                           */
      484     3628    2         DATSIZ=CNT(1);
      485     3629    3         IF DATSIZ>512 THEN DO;
      486     3630    3              IF S_D.ONE_TO_TWO.EXEC_DOMAIN~=%HOST AND DATSIZ<=1024 THEN EXIT;
      487     3631    3              CALL BADSIZE;
      488     3632    3              RETURN;
      489     3633    3              END;
      490     3634    2         IF CNT(4)>1
      491     3635    2         THEN IF S_D.ONE_TO_TWO.EXEC_DOMAIN=%HOST
      492     3636    2                AND CNT(2)<=BITBIN('777777'O) AND CNT(0)=2
      493     3637    2              THEN MEMVEC.PTR$(0)->BHBIN=CNT(2);
      494     3638    2              ELSE MEMVEC.PTR$(0)->BUBIN=CNT(2);
      495     3639    2         IF DATSIZ~=0 THEN CALL FIXSIZ;
      496     3640    2       CASE (3, 11);                       /* New data, keep FMT                 */
      497     3641    2         CALL GETMEM;
      498     3642    2       CASE (4, 12);
      499     3643    2         CALL GETFMT;
      500     3644    2         IF CNT(4)>0 THEN CALL GETMEM;
      501     3645    2       CASE(5);
              3645             /* Abort if no MEMVEC.PTR$(0)->CND.FLG flags set (CNT(1), CNT(2), or CNT(3)) */
      502     3646                                                /* Ignore for DELTA                   */
      503     3647    2       CASE(6);                            /* Display ENTDEF name                */
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:94   
      504     3648    2         CALL DDR$POSIT (CNT(2),
      505     3649    2           ADDR(SUBSTR(BUF,FDS.BUFX)),FDS.BUFSIZE-FDS.BUFX,I,'1'B);
      506     3650    2         FDS.BUFX=MINIMUM(FDS.BUFX+I, FDS.BUFSIZE);
      507     3651    2         CNT(0)=0;
      508     3652    2         ALTRETURN;
      509     3653    2       CASE(7);                            /* Symbol lookup                      */
      510     3654    2         CALL INDEX(I,'%',SUBSTR(FMT,FDS.FMTX+2));
      511     3655    2         SYM.L = I;
      512     3656    2         SYM.T = SUBSTR(FMT,FDS.FMTX+2,I);
      513     3657    2         CALL DDS$SD_SRCH (ADDR(SYM), I$) ALTRET (GOT_SYM);
      514     3658    2         CALL DDS$ED_SRCH (ADDR(SYM), I$) ALTRET (GOT_SYM);
      515     3659    2         CALL NOSYMBOL ALTRET (NO_SYM);;
      516     3660    2   GOT_SYM: FDS.USERDAT1# = I$->B$EDEF.ISADDR;
      517     3661    2   NO_SYM: ;
      518     3662    2         END;
      519     3663    1      RETURN;
      520     3664        %EJECT;
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:95   
      521     3665        /* Subroutines */
      522     3666    1   GETFMT: PROC ALTRET;
      523     3667
      524     3668    2   DCL CHAR4 CHAR(4) BASED CALIGNED;
      525     3669    2   DCL CHAR1 CHAR(1) BASED CALIGNED;
      526     3670    2   DCL CHARI CHAR(I) BASED CALIGNED;
      527     3671    2      CALL INDEX(I,'%)',SUBSTR(FMT,FDS.FMTX+2)) ALTRET(BADFMT);
      528     3672    3      IF I~=FMTKEY.L OR SUBSTR(FMT,FDS.FMTX+2,I)~=FMTKEY.T THEN DO;
      529     3673    3           FMTKEY.L=I;
      530     3674    3           FMTKEY.T=SUBSTR(FMT,FDS.FMTX+2,I);
      531     3675    3           GETDCB=CGETDCB;
      532     3676    3           ADDR(GETDCB.V_)->MEMVEC.PTR$(0)=ADDR(GETDCB.V);
      533     3677    3           ADDR(GETDCB.DCBNUM_)->MEMVEC.PTR$(0)=ADDR(OPNFMT.V.DCB#);
      534     3678    3           OPNFMT=COPNFMT;
      535     3679    3           ADDR(OPNFMT.V_)->MEMVEC.PTR$(0)=ADDR(OPNFMT.V);
      536     3680    3           REDFMT=CREDFMT;
      537     3681    3           ADDR(REDFMT.V_)->MEMVEC.PTR$(0)=ADDR(REDFMT.V);
      538     3682    3           ADDR(REDFMT.KEY_)->MEMVEC.PTR$(0)=ADDR(FMTKEY.L);
      539     3683
      540     3684    3           CALL M$GETDCB (GETDCB) ALTRET (NOFMT);
      541     3685    4           IF NOT %M$FMT.UOPT#(2) THEN DO;
      542     3686    4                IF %M$FMT.AMR# THEN OPNFMT.NAME_=OPNFMT.UATTR_;
      543     3687    4   REOPN:       ADDR(OPNFMT.V)->OPNCLS.CTL = '0'B;
      544     3688    4                IF %M$FMT.UOPT#(1) OR OPNFMT.V.UOPT#(1) THEN CALL M$CLOSE (OPNFMT)
      545     3689    5                     WHENALTRETURN DO; END;
      546     3690    4                ADDR(OPNFMT.V)->OPNCLS.CTL = ADDR(COPNFMT.V)->OPNCLS.CTL;
      547     3691    4                CALL M$OPEN (OPNFMT);
      548     3692    4                END;
      549     3693    3           REDFMT.V.DCB#=OPNFMT.V.DCB#;
      550     3694    3           REDFMT.BUF_.BUF$=FDS.FMT_.FMT$;
      551     3695    3           REDFMT.BUF_.BOUND=2047;
      552     3696    4           CALL M$READ(REDFMT) WHENALTRETURN DO;
      553     3697    4                IF %M$FMT.UOPT#(1) THEN GOTO NOFMT;
      554     3698    4                IF NOT %M$FMT.FCD# THEN OPNFMT.V.UOPT#(2) = '1'B;
      555     3699    4                OPNFMT.V.UOPT#(1) = '1'B;
      556     3700    4                OPNFMT.ACCT_=VECTOR(SYSACCT);
      557     3701    4                OPNFMT.NAME_=COPNFMT.NAME_;
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:96   
      558     3702    4                GOTO REOPN;
      559     3703    4                END;
      560     3704    3           FDS.FMTSIZE=%M$FMT.ARS#;
      561     3705    3           IF FDS.FMTSIZE<6 THEN GOTO NOFMT;
      562     3706    3           IF ADDR(FMT)->BUBIN~=0 OR CNT(1)~=0
      563     3707    3           THEN DATSIZ=ADDR(FMT)->BUBIN;
      564     3708    3           IF DATSIZ>1024 OR DATSIZ>512 AND S_D.ONE_TO_TWO.EXEC_DOMAIN=%HOST
      565     3709    3           THEN GOTO BADSIZ;
      566     3710    3           SUBSTR(FMT,0,4)='%(%)';
      567     3711    3           END;
      568     3712    2      FDS.FMTX=4;                          /* Start at the beginning             */
      569     3713    2      RETURN;
      570     3714    2   NOFMT: SUBSTR(FMT,0,30)='%/FMT not found in FMT file:';
      571     3715    2      GOTO NOFMT1;
      572     3716    2   BADFMT: SUBSTR(FMT,0,30)='%/No new FMT name found in ';
      573     3717    2   NOFMT1: SUBSTR(FMT,30,30)=FMTKEY.T;
      574     3718    2   NOFMT2: FDS.FMTX=0;
      575     3719    2      FDS.FMTSIZE=63;
      576     3720    2      SUBSTR(FMT,60,3)='%1Q';
      577     3721    2      DATSIZ=0;
      578     3722    2      ALTRETURN;
      579     3723    2   BADSIZE: ENTRY ALTRET;
      580     3724    2   BADSIZ: SUBSTR(FMT,0,60) = '%/Data request exceeds maximum (2048 bytes)';
      581     3725    2      GOTO NOFMT2;
      582     3726    2   NOSYMBOL: ENTRY ALTRET;
      583     3727    2      SUBSTR(FMT,0,20) = '%/Symbol not found:';
      584     3728    2      SUBSTR(FMT,20,40) = SYM.T;
      585     3729    2      GOTO NOFMT2;
      586     3730    2   END GETFMT;
      587     3731        %EJECT;
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:97   
      588     3732    1   GETMEM: PROC ALTRET;
      589     3733    2      IF S_D.ONE_TO_TWO.EXEC_DOMAIN=%HOST
      590     3734    2        AND CNT(1)<=BITBIN('777777'O) AND CNT(0)<8
      591     3735    2      THEN MEMVEC.PTR$(0)->BHBIN=CNT(1);
      592     3736    2      ELSE MEMVEC.PTR$(0)->BUBIN=CNT(1);
      593     3737    2      IF DATSIZ=0 THEN RETURN;
      594     3738    2   FIXSIZ: ENTRY ALTRET;
      595     3739
      596     3740    2      I=DATSIZ*2;
      597     3741    2      NODE=0;
      598     3742    2      NOT_IS='0'B;
      599     3743    3      IF S_D.ONE_TO_TWO.EXEC_DOMAIN=%HOST THEN DO;
      600     3744    3           ADDRESS=MEMVEC.PTR$(0)->BPTR.OFFSET;
      601     3745    3           SEG=MEMVEC.PTR$(0)->BPTR.SEGTYP;
      602     3746    3           DESC#=MEMVEC.PTR$(0)->BPTR.SEGNUM;
      603     3747    3           I=I*2;
      604     3748    3           END;
      605     3749    3      ELSE DO;
      606     3750    3           SEG=3;
      607     3751    3           DESC#=0;
      608     3752    3           ADDRESS=MEMVEC.PTR$(0)->BUBIN;
      609     3753    3           END;
      610     3754    2      IF SEG~=3 OR DESC#~=0 THEN NOT_IS='1'B;
      611     3755    2      IF S_D.RUM AND S_D.OVERLAID THEN CALL DDS$IC2NODE (ADDRESS,NODE);
      612     3756    2      DIRECT=ENTADDR(DDK$GETMVAL);
      613     3757    2      IF S_D.ANLZ_FILE THEN DIRECT=ENTADDR(DUL$GETMVAL);
      614     3758
      615     3759    2      MEMVEC.BOUND(1)=I-1;
      616     3760    3      DO I=0 TO MEMVEC.BOUND(1)/4;
      617     3761    3           IF S_D.RUM THEN CALL DUU$GETMVAL (CMEM, NODE, ADDRESS, SEG, DESC#,
      618     3762    3                  NOT_IS) ALTRET (NOMEM);
      619     3763    3           ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN=%HOST
      620     3764    3                THEN CALL DIRECT (PINCRW(MEMVEC.PTR$(1),I)->BUBIN, ADDRESS, SEG,
      621     3765    3                       DESC#, NOT_IS) ALTRET (NOMEM);
      622     3766    3                ELSE CALL DFK$GETMVAL (CMEM, ADDRESS, SEG, DESC#, NOT_IS, '0'B)
      623     3767    3                       ALTRET(NOMEM);
      624     3768    4           IF S_D.ONE_TO_TWO.EXEC_DOMAIN~=%HOST THEN DO;
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:98   
      625     3769    5                DO X=0 TO 15;
      626     3770    5                     CMEM.VAL(X)=CMEM.VAL(X)+BITBIN(CMEM.VALB(X)&'0000001774'O);
      627     3771    6                     IF BINBIT(X,1) THEN DO;
      628     3772    6                          PINCRW(MEMVEC.PTR$(1),I)->BUBIN=
      629     3773    6                            CMEM.VAL(X-1)*262144+CMEM.VAL(X);
      630     3774    6                          I=I+1;
      631     3775    6                          END;
      632     3776    5                     END;
      633     3777    4                I=I-1;
      634     3778    4                ADDRESS=ADDRESS+15;
      635     3779    4                END;
      636     3780    3           ELSE IF S_D.RUM THEN PINCRW(MEMVEC.PTR$(1),I)->BUBIN=CMEM.VAL(0);
      637     3781    3           ADDRESS = ADDRESS+1;
      638     3782    3           END;
      639     3783    2      RETURN;
      640     3784    2   NOMEM: ;
      641     3785    2      UNWIND TO FDS.BAILOUT;
      642     3786    2   END GETMEM;
      643     3787    1   END;
      644     3788        %EOD;

PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:99   
--  Include file information  --

   XUH_MACRO_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure DFA$EDIT.

   Procedure DFA$EDIT requires 654 words for executable code.
   Procedure DFA$EDIT requires 138 words of local(AUTO) storage.

PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:100  

 Object Unit name= DFA$EDIT                                   File name= DFA$TSA.:E05TOU
 UTS= JUL 29 '97 14:37:41.28 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    122    172  DFA$EDIT
    2   Proc  even  none   654   1216  DFA$EDIT
    3  RoData even  none    10     12  DFA$EDIT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        2  DFA$EDIT
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:101  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 DDB$BREAK
 yes     yes           Std       5 DDR$POSIT
 yes     yes           Std       2 DDS$SD_SRCH
 yes     yes           Std       2 DDS$ED_SRCH
 yes     yes           Std       2 DDS$IC2NODE
 yes     yes           Std       5 DDK$GETMVAL
 yes     yes           Std       5 DUL$GETMVAL
 yes     yes           Std       6 DUU$GETMVAL
 yes     yes           Std       6 DFK$GETMVAL
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUNWIND
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    S_D$                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:102  


      385        1        /*T***********************************************************/
      386        2        /*T*                                                         */
      387        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      388        4        /*T*                                                         */
      389        5        /*T***********************************************************/
      390        6        DFA$EDIT: PROC(FDS,CNT) ALTRET;

      6  2 000000   000000 700200 xent  DFA$EDIT     TSX0  ! X66_AUTO_2
         2 000001   000212 000002                    ZERO    138,2

      391        7
      392        8        %INCLUDE CP_6;
      393       89        %INCLUDE XU_FORMAT_C;
      394      251
      395      252        %FPT_GETDCB (STCLASS=CONSTANT, FPTN=CGETDCB, DCBNAME=DCB_NAME, MERGE=YES,
      396      253                     DCBNUM=COPNFMT.V.DCB#);
      397      268        %FPT_GETDCB (FPTN=GETDCB, STCLASS=AUTO);
      398      283        %VLP_NAME (STCLASS=CONSTANT, FPTN=DCB_NAME, NAME='M$DELTA_FMT');
      399      310        %FPT_OPEN (STCLASS=CONSTANT, FPTN=COPNFMT, ASN=FILE, NAME=FMT_NAME, SETDCB=YES,
      400      311                   FUN=IN, REASSIGN=YES, SCRUB=YES, UOPT1=NO, ACS=DIRECT);
      401      420        %FPT_OPEN (FPTN=OPNFMT, STCLASS=AUTO);
      402      529    1   DCL 1 OPNCLS BASED ALIGNED,
      403      530    1         2 * BIT(18),2 CTL BIT(18);
      404      531        %VLP_NAME (FPTN=FMT_NAME, NAME=':FORMAT', STCLASS=CONSTANT);
      405      558        %VLP_ACCT (FPTN=SYSACCT, ACCT=':SYS', STCLASS=CONSTANT);
      406      571
      407      572        %F$DCB;
      408      629        %EQU M$FMT=CHARTEXT('DCBADDR(OPNFMT.V.DCB#)->F$DCB');
      409      630
      410      631        %FPT_READ (FPTN=CREDFMT, STCLASS=CONSTANT, KEY=CREDFMT, KEYS=YES);
      411      670        %FPT_READ (FPTN=REDFMT, STCLASS=AUTO);
      412      709    1   DCL 1 FMTKEY BASED(VEC0$) ALIGNED,
      413      710    1         2 DATSIZ UBIN,
      414      711    1         2 L UBIN(9) UNAL,
      415      712    1         2 T CHAR(31);
      416      713
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:103  
      417      714        %F_FDS (NAME=FDS, STCLASS=PARAM);
      418      827    1   DCL CNT(0:4) SBIN PARAM;
      419      828
      420      829    1   DCL 1 MEMVEC(0:0) BASED(FDS.VECTR$),
      421      830    1         2 BOUND UBIN(20) UNAL,
      422      831    1         2 * BIT(16),
      423      832    1         2 PTR$ PTR;
      424      833    1   DCL FMT CHAR(FDS.FMTSIZE) BASED(FDS.FMT_.FMT$);
      425      834    1   DCL BUF CHAR(FDS.BUFSIZE) BASED(FDS.BUF_.BUF$);
      426      835    1   DCL VEC0$ PTR;
      427      836    1   DCL I UBIN;
      428      837    1   DCL I$ REDEF I PTR;
      429      838    1   DCL 1 SYM,
      430      839    1         2 L UBIN(9) UNAL,
      431      840    1         2 T CHAR(63);
      432      841    1   DCL X UBIN;
      433      842    1   DCL ADDRESS SBIN;
      434      843    1   DCL SEG SBIN;
      435      844    1   DCL NODE SBIN;
      436      845    1   DCL DESC# SBIN;
      437      846    1   DCL NOT_IS BIT(1);
      438      847    1   DCL DATSIZ SBIN BASED(VEC0$) ALIGNED;
      439      848    1   DCL DIRECT EPTR;
      440      849    1   DCL 1 CMEM,
      441      850    1         2 * UBIN,
      442      851    1         2 VAL(0:15) UBIN,
      443      852    1         2 VALB(0:15) REDEF VAL BIT(36);
      444      853    1   DCL BUBIN UBIN BASED ALIGNED;
      445      854    1   DCL BHBIN UBIN HALF BASED ALIGNED;
      446      855    1   DCL 1 B$EDEF BASED ALIGNED,2 * BIT(9),2 ISADDR UBIN(27) UNAL;
      447      856    1   DCL 1 BPTR BASED ALIGNED,
      448      857    1         2 OFFSET UBIN HALF UNAL,
      449      858    1         2 SEGTYP UBIN(8) UNAL,
      450      859    1         2 SEGNUM UBIN(10) UNAL;
      451      860    1   DCL 1 TEXTH BASED ALIGNED,
      452      861    1         2 C UBIN HALF CALIGNED,
      453      862    1         2 T CHAR(TEXTH.C) CALIGNED;
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:104  
      454      863
      455      864    1   DCL DDB$BREAK ENTRY ALTRET;
      456      865    1   DCL DDK$GETMVAL ENTRY(5) ALTRET;
      457      866    1   DCL DDS$IC2NODE ENTRY(2) ALTRET;
      458      867    1   DCL DDR$POSIT ENTRY(5) ALTRET;
      459      868    1   DCL DUU$GETMVAL ENTRY(6) ALTRET;
      460      869    1   DCL DFK$GETMVAL ENTRY(6) ALTRET;
      461      870    1   DCL DUL$GETMVAL ENTRY(5) ALTRET;
      462      871    1   DCL DDS$ED_SRCH ENTRY(2) ALTRET;
      463      872    1   DCL DDS$SD_SRCH ENTRY(2) ALTRET;
      464      873        %INCLUDE DD_SD_M;
      465     2209        %INCLUDE XUH_MACRO_C;
      466     2293        %S_D;
      467     3611        %EJECT;
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:105  
      468     3612    1      VEC0$=PINCRW(MEMVEC.PTR$(0),-SIZEW(FMTKEY));

   3612  2 000002   200003 470500                    LDP0    @FDS,,AUTO
         2 000003   000012 471500                    LDP1    10,,PR0
         2 000004   100001 236100                    LDQ     1,,PR1
         2 000005   777767 036003                    ADLQ    -9,DU
         2 000006   200126 756100                    STQ     VEC0$,,AUTO

      469     3613    2      CALL DDB$BREAK WHENALTRETURN DO;

   3613  2 000007   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000010   000000 701000 xent               TSX1    DDB$BREAK
         2 000011   000013 702000 2                  TSX2    s:3614
         2 000012   000022 710000 2                  TRA     s:3616

      470     3614    2           UNWIND TO FDS.BAILOUT;

   3614  2 000013   200003 470700                    LDP0  ! @FDS,,AUTO
         2 000014   000100 100700                    MLR   ! fill='000'O
         2 000015   000021 000010                    ADSC9   17,,PR0                  cn=0,n=8
         2 000016   200202 000010                    ADSC9   CMEM+19,,AUTO            cn=0,n=8
         2 000017   200202 237300                    LDAQ  ! CMEM+19,,AUTO
         2 000020   000000 700200 xent               TSX0  ! X66_AUNWIND
         2 000021   000000 000200                    ZERO    0,128

      471     3615    2           END;
      472     3616    2      IF SUBSTR(FMT,0,4)~='%(%)' THEN DO;

   3616  2 000022   200003 470500                    LDP0    @FDS,,AUTO
         2 000023   000001 471500                    LDP1    1,,PR0
         2 000024   000004 720100                    LXL0    4,,PR0
         2 000025   040000 106500                    CMPC    fill='040'O
         2 000026   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         2 000027   000130 000004 1                  ADSC9   CREDFMT+14               cn=0,n=4
         2 000030   000035 600000 2                  TZE     s:3620

      473     3617    2           FMTKEY.L=0;
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:106  

   3617  2 000031   200126 473500                    LDP3    VEC0$,,AUTO
         2 000032   000000 236003                    LDQ     0,DU
         2 000033   300001 552140                    STBQ    1,'40'O,PR3

      474     3618    2           DATSIZ=0;

   3618  2 000034   300000 450100                    STZ     0,,PR3

      475     3619    2           END;

      476     3620    2      DO CASE(CNT(0));

   3620  2 000035   200004 471500                    LDP1    @CNT,,AUTO
         2 000036   100000 235100                    LDA     0,,PR1
         2 000037   000015 115007                    CMPA    13,DL
         2 000040   000042 602005 2                  TNC     s:3620+5,AL
         2 000041   000312 710000 2                  TRA     NO_SYM
         2 000042   000057 710000 2                  TRA     s:3622
         2 000043   000312 710000 2                  TRA     NO_SYM
         2 000044   000101 710000 2                  TRA     s:3628
         2 000045   000153 710000 2                  TRA     s:3641
         2 000046   000156 710000 2                  TRA     s:3643
         2 000047   000312 710000 2                  TRA     NO_SYM
         2 000050   000166 710000 2                  TRA     s:3648
         2 000051   000232 710000 2                  TRA     s:3654
         2 000052   000312 710000 2                  TRA     NO_SYM
         2 000053   000312 710000 2                  TRA     NO_SYM
         2 000054   000101 710000 2                  TRA     s:3628
         2 000055   000153 710000 2                  TRA     s:3641
         2 000056   000156 710000 2                  TRA     s:3643

      477     3621    2       CASE(0);                            /* DOT PREV FIELD                     */

      478     3622    3         CALL INDEX1R(I,' ',BUF,FDS.BUFX) WHENRETURN DO;

   3622  2 000057   000006 473500                    LDP3    6,,PR0
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:107  
         2 000060   000010 720100                    LXL0    8,,PR0
         2 000061   000007 721100                    LXL1    7,,PR0
         2 000062   000007 236100                    LDQ     7,,PR0
         2 000063   000000 125540                    SCMR    mask='000'O
         2 000064   300000 000011                    ADSC9   0,,PR3                   cn=0,n=*X1
         2 000065   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000066   200127 000100                    ARG     I,,AUTO
         2 000067   000100 606400 2                  TTN     s:3624
         2 000070   200127 054100                    AOS     I,,AUTO
         2 000071   200127 156100                    SSQ     I,,AUTO

      479     3623    3              SUBSTR(BUF,I,1)='.';

   3623  2 000072   000006 473500                    LDP3    6,,PR0
         2 000073   000010 720100                    LXL0    8,,PR0
         2 000074   200127 235100                    LDA     I,,AUTO
         2 000075   040105 100400                    MLR     fill='040'O
         2 000076   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000077   300000 000001                    ADSC9   0,A,PR3                  cn=0,n=1

      480     3624    3              END;

   3624  2 000100   000312 710000 2                  TRA     NO_SYM

      481     3625    2       CASE(1);                  /* Next to format: addr in CNT(1), FMT follows  */

      482     3626                                                /* Ignore in DELTA                    */
      483     3627    2       CASE (2, 10);                       /* Fix size                           */

      484     3628    2         DATSIZ=CNT(1);

   3628  2 000101   200126 473500                    LDP3    VEC0$,,AUTO
         2 000102   100001 235100                    LDA     1,,PR1
         2 000103   300000 755100                    STA     0,,PR3

      485     3629    3         IF DATSIZ>512 THEN DO;

PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:108  
   3629  2 000104   001000 115007                    CMPA    512,DL
         2 000105   000120 604400 2                  TMOZ    s:3634

      486     3630    3              IF S_D.ONE_TO_TWO.EXEC_DOMAIN~=%HOST AND DATSIZ<=1024 THEN EXIT;

   3630  2 000106   000000 474400 xsym               LDP4    S_D$
         2 000107   406714 235100                    LDA     3532,,PR4
         2 000110   000001 115007                    CMPA    1,DL
         2 000111   000115 600000 2                  TZE     s:3631
         2 000112   300000 235100                    LDA     0,,PR3
         2 000113   002000 115007                    CMPA    1024,DL
         2 000114   000120 604400 2                  TMOZ    s:3634

      487     3631    3              CALL BADSIZE;

   3631  2 000115   000625 701000 2                  TSX1    BADSIZE
         2 000116   000000 011000                    NOP     0

      488     3632    3              RETURN;

   3632  2 000117   000000 702200 xent               TSX2  ! X66_ARET

      489     3633    3              END;
      490     3634    2         IF CNT(4)>1

   3634  2 000120   100004 235100                    LDA     4,,PR1
         2 000121   000001 115007                    CMPA    1,DL
         2 000122   000146 604400 2                  TMOZ    s:3639

      491     3635    2         THEN IF S_D.ONE_TO_TWO.EXEC_DOMAIN=%HOST

   3635  2 000123   000000 474400 xsym               LDP4    S_D$
         2 000124   406714 235100                    LDA     3532,,PR4
         2 000125   000001 115007                    CMPA    1,DL
         2 000126   000142 601000 2                  TNZ     s:3638
         2 000127   100002 235100                    LDA     2,,PR1
         2 000130   777777 115007                    CMPA    -1,DL
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:109  
         2 000131   000142 605400 2                  TPNZ    s:3638
         2 000132   100000 235100                    LDA     0,,PR1
         2 000133   000002 115007                    CMPA    2,DL
         2 000134   000142 601000 2                  TNZ     s:3638

      492     3636    2                AND CNT(2)<=BITBIN('777777'O) AND CNT(0)=2
      493     3637    2              THEN MEMVEC.PTR$(0)->BHBIN=CNT(2);

   3637  2 000135   000012 475500                    LDP5    10,,PR0
         2 000136   500001 476500                    LDP6    1,,PR5
         2 000137   100002 720100                    LXL0    2,,PR1
         2 000140   600000 740100                    STX0    0,,PR6
         2 000141   000146 710000 2                  TRA     s:3639

      494     3638    2              ELSE MEMVEC.PTR$(0)->BUBIN=CNT(2);

   3638  2 000142   000012 475500                    LDP5    10,,PR0
         2 000143   500001 476500                    LDP6    1,,PR5
         2 000144   100002 235100                    LDA     2,,PR1
         2 000145   600000 755100                    STA     0,,PR6

      495     3639    2         IF DATSIZ~=0 THEN CALL FIXSIZ;

   3639  2 000146   300000 235100                    LDA     0,,PR3
         2 000147   000312 600000 2                  TZE     NO_SYM

   3639  2 000150   000710 701000 2                  TSX1    FIXSIZ
         2 000151   000000 011000                    NOP     0
         2 000152   000312 710000 2                  TRA     NO_SYM

      496     3640    2       CASE (3, 11);                       /* New data, keep FMT                 */

      497     3641    2         CALL GETMEM;

   3641  2 000153   000652 701000 2                  TSX1    GETMEM
         2 000154   000000 011000                    NOP     0
         2 000155   000312 710000 2                  TRA     NO_SYM
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:110  

      498     3642    2       CASE (4, 12);

      499     3643    2         CALL GETFMT;

   3643  2 000156   000313 701000 2                  TSX1    GETFMT
         2 000157   000000 011000                    NOP     0

      500     3644    2         IF CNT(4)>0 THEN CALL GETMEM;

   3644  2 000160   200004 470500                    LDP0    @CNT,,AUTO
         2 000161   000004 235100                    LDA     4,,PR0
         2 000162   000312 604400 2                  TMOZ    NO_SYM

   3644  2 000163   000652 701000 2                  TSX1    GETMEM
         2 000164   000000 011000                    NOP     0
         2 000165   000312 710000 2                  TRA     NO_SYM

      501     3645    2       CASE(5);
              3645            /* Abort if no MEMVEC.PTR$(0)->CND.FLG flags set (CNT(1), CNT(2), or CNT(3)) */

      502     3646                                                /* Ignore for DELTA                   */
      503     3647    2       CASE(6);                            /* Display ENTDEF name                */

      504     3648    2         CALL DDR$POSIT (CNT(2),

   3648  2 000166   000006 473500                    LDP3    6,,PR0
         2 000167   000010 720100                    LXL0    8,,PR0
         2 000170   000000 636010                    EAQ     0,X0
         2 000171   000022 732000                    QRS     18
         2 000172   000007 136100                    SBLQ    7,,PR0
         2 000173   000007 235100                    LDA     7,,PR0
         2 000174   000010 236100                    LDQ     8,,PR0
         2 000175   000007 136100                    SBLQ    7,,PR0
         2 000176   300000 500505                    A9BD    0,AL,PR3
         2 000177   200202 453500                    STP3    CMEM+19,,AUTO
         2 000200   200203 756100                    STQ     CMEM+20,,AUTO
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:111  
         2 000201   000001 236000 3                  LDQ     1
         2 000202   200210 756100                    STQ     CMEM+25,,AUTO
         2 000203   200127 634500                    EPPR4   I,,AUTO
         2 000204   200207 454500                    STP4    CMEM+24,,AUTO
         2 000205   200203 635500                    EPPR5   CMEM+20,,AUTO
         2 000206   200206 455500                    STP5    CMEM+23,,AUTO
         2 000207   200202 636500                    EPPR6   CMEM+19,,AUTO
         2 000210   200205 456500                    STP6    CMEM+22,,AUTO
         2 000211   200004 236100                    LDQ     @CNT,,AUTO
         2 000212   000002 036003                    ADLQ    2,DU
         2 000213   200204 756100                    STQ     CMEM+21,,AUTO
         2 000214   200204 630500                    EPPR0   CMEM+21,,AUTO
         2 000215   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000216   000000 701000 xent               TSX1    DDR$POSIT
         2 000217   000000 011000                    NOP     0

      505     3649    2           ADDR(SUBSTR(BUF,FDS.BUFX)),FDS.BUFSIZE-FDS.BUFX,I,'1'B);
      506     3650    2         FDS.BUFX=MINIMUM(FDS.BUFX+I, FDS.BUFSIZE);

   3650  2 000220   200003 470500                    LDP0    @FDS,,AUTO
         2 000221   000007 236100                    LDQ     7,,PR0
         2 000222   200127 036100                    ADLQ    I,,AUTO
         2 000223   000010 116100                    CMPQ    8,,PR0
         2 000224   000226 604400 2                  TMOZ    s:3650+6
         2 000225   000010 236100                    LDQ     8,,PR0
         2 000226   000007 756100                    STQ     7,,PR0

      507     3651    2         CNT(0)=0;

   3651  2 000227   200004 471500                    LDP1    @CNT,,AUTO
         2 000230   100000 450100                    STZ     0,,PR1

      508     3652    2         ALTRETURN;

   3652  2 000231   000000 702200 xent               TSX2  ! X66_AALT

      509     3653    2       CASE(7);                            /* Symbol lookup                      */
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:112  

      510     3654    2         CALL INDEX(I,'%',SUBSTR(FMT,FDS.FMTX+2));

   3654  2 000232   000001 473500                    LDP3    1,,PR0
         2 000233   000004 720100                    LXL0    4,,PR0
         2 000234   000000 636010                    EAQ     0,X0
         2 000235   000022 732000                    QRS     18
         2 000236   000002 136100                    SBLQ    2,,PR0
         2 000237   000002 235100                    LDA     2,,PR0
         2 000240   777776 621006                    EAX1    -2,QL
         2 000241   000000 124545                    SCM     mask='000'O
         2 000242   300000 400011                    ADSC9   0,A,PR3                  cn=2,n=*X1
         2 000243   000002 000001 3                  ADSC9   2                        cn=0,n=1
         2 000244   200127 000100                    ARG     I,,AUTO

      511     3655    2         SYM.L = I;

   3655  2 000245   200127 236100                    LDQ     I,,AUTO
         2 000246   000033 736000                    QLS     27
         2 000247   200130 552140                    STBQ    SYM,'40'O,AUTO

      512     3656    2         SYM.T = SUBSTR(FMT,FDS.FMTX+2,I);

   3656  2 000250   000001 473500                    LDP3    1,,PR0
         2 000251   000004 720100                    LXL0    4,,PR0
         2 000252   000002 235100                    LDA     2,,PR0
         2 000253   200127 721100                    LXL1    I,,AUTO
         2 000254   040100 100545                    MLR     fill='040'O
         2 000255   300000 400011                    ADSC9   0,A,PR3                  cn=2,n=*X1
         2 000256   200130 200077                    ADSC9   SYM,,AUTO                cn=1,n=63

      513     3657    2         CALL DDS$SD_SRCH (ADDR(SYM), I$) ALTRET (GOT_SYM);

   3657  2 000257   200130 633500                    EPPR3   SYM,,AUTO
         2 000260   200202 453500                    STP3    CMEM+19,,AUTO
         2 000261   200127 634500                    EPPR4   I,,AUTO
         2 000262   200205 454500                    STP4    CMEM+22,,AUTO
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:113  
         2 000263   200202 635500                    EPPR5   CMEM+19,,AUTO
         2 000264   200204 455500                    STP5    CMEM+21,,AUTO
         2 000265   200204 630500                    EPPR0   CMEM+21,,AUTO
         2 000266   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000267   000000 701000 xent               TSX1    DDS$SD_SRCH
         2 000270   000305 702000 2                  TSX2    GOT_SYM

      514     3658    2         CALL DDS$ED_SRCH (ADDR(SYM), I$) ALTRET (GOT_SYM);

   3658  2 000271   200130 630500                    EPPR0   SYM,,AUTO
         2 000272   200202 450500                    STP0    CMEM+19,,AUTO
         2 000273   200127 631500                    EPPR1   I,,AUTO
         2 000274   200205 451500                    STP1    CMEM+22,,AUTO
         2 000275   200202 633500                    EPPR3   CMEM+19,,AUTO
         2 000276   200204 453500                    STP3    CMEM+21,,AUTO
         2 000277   200204 630500                    EPPR0   CMEM+21,,AUTO
         2 000300   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000301   000000 701000 xent               TSX1    DDS$ED_SRCH
         2 000302   000305 702000 2                  TSX2    GOT_SYM

      515     3659    2         CALL NOSYMBOL ALTRET (NO_SYM);;

   3659  2 000303   000635 701000 2                  TSX1    NOSYMBOL
         2 000304   000312 702000 2                  TSX2    NO_SYM

      516     3660    2   GOT_SYM: FDS.USERDAT1# = I$->B$EDEF.ISADDR;

   3660  2 000305   200127 470500       GOT_SYM      LDP0    I,,AUTO
         2 000306   000000 236100                    LDQ     0,,PR0
         2 000307   000032 376000 xsym               ANQ     B_VECTNIL+26
         2 000310   200003 471500                    LDP1    @FDS,,AUTO
         2 000311   100033 756100                    STQ     27,,PR1

   3660  2 000312                       NO_SYM       null
      517     3661    2   NO_SYM: ;
      518     3662    2         END;

PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:114  
      519     3663    1      RETURN;

   3663  2 000312   000000 702200 xent               TSX2  ! X66_ARET

      520     3664        %EJECT;
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:115  
      521     3665        /* Subroutines */
      522     3666    1   GETFMT: PROC ALTRET;

   3666  2 000313   200200 741300       GETFMT       STX1  ! CMEM+17,,AUTO

      523     3667
      524     3668    2   DCL CHAR4 CHAR(4) BASED CALIGNED;
      525     3669    2   DCL CHAR1 CHAR(1) BASED CALIGNED;
      526     3670    2   DCL CHARI CHAR(I) BASED CALIGNED;
      527     3671    2      CALL INDEX(I,'%)',SUBSTR(FMT,FDS.FMTX+2)) ALTRET(BADFMT);

   3671  2 000314   200003 470500                    LDP0    @FDS,,AUTO
         2 000315   000001 471500                    LDP1    1,,PR0
         2 000316   000004 720100                    LXL0    4,,PR0
         2 000317   000000 636010                    EAQ     0,X0
         2 000320   000022 732000                    QRS     18
         2 000321   000002 136100                    SBLQ    2,,PR0
         2 000322   000002 235100                    LDA     2,,PR0
         2 000323   777776 622006                    EAX2    -2,QL
         2 000324   000000 120545                    SCD
         2 000325   100000 400012                    ADSC9   0,A,PR1                  cn=2,n=*X2
         2 000326   000131 000002 1                  ADSC9   CREDFMT+15               cn=0,n=2
         2 000327   200127 000100                    ARG     I,,AUTO
         2 000330   000333 607000 2                  TTF     s:3672
         2 000331   200127 054100                    AOS     I,,AUTO
         2 000332   000574 710000 2                  TRA     BADFMT

      528     3672    3      IF I~=FMTKEY.L OR SUBSTR(FMT,FDS.FMTX+2,I)~=FMTKEY.T THEN DO;

   3672  2 000333   200126 471500                    LDP1    VEC0$,,AUTO
         2 000334   100001 236100                    LDQ     1,,PR1
         2 000335   000033 772000                    QRL     27
         2 000336   200127 116100                    CMPQ    I,,AUTO
         2 000337   000350 601000 2                  TNZ     s:3673
         2 000340   000001 473500                    LDP3    1,,PR0
         2 000341   000004 720100                    LXL0    4,,PR0
         2 000342   000002 235100                    LDA     2,,PR0
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:116  
         2 000343   200127 722100                    LXL2    I,,AUTO
         2 000344   040100 106545                    CMPC    fill='040'O
         2 000345   300000 400012                    ADSC9   0,A,PR3                  cn=2,n=*X2
         2 000346   100001 200037                    ADSC9   1,,PR1                   cn=1,n=31
         2 000347   000560 600000 2                  TZE     s:3712

      529     3673    3           FMTKEY.L=I;

   3673  2 000350   200127 236100                    LDQ     I,,AUTO
         2 000351   000033 736000                    QLS     27
         2 000352   100001 552140                    STBQ    1,'40'O,PR1

      530     3674    3           FMTKEY.T=SUBSTR(FMT,FDS.FMTX+2,I);

   3674  2 000353   000001 473500                    LDP3    1,,PR0
         2 000354   000004 720100                    LXL0    4,,PR0
         2 000355   000002 235100                    LDA     2,,PR0
         2 000356   200127 721100                    LXL1    I,,AUTO
         2 000357   040100 100545                    MLR     fill='040'O
         2 000360   300000 400011                    ADSC9   0,A,PR3                  cn=2,n=*X1
         2 000361   100001 200037                    ADSC9   1,,PR1                   cn=1,n=31

      531     3675    3           GETDCB=CGETDCB;

   3675  2 000362   000100 100400                    MLR     fill='000'O
         2 000363   000000 000040 1                  ADSC9   CGETDCB                  cn=0,n=32
         2 000364   200006 000040                    ADSC9   GETDCB,,AUTO             cn=0,n=32

      532     3676    3           ADDR(GETDCB.V_)->MEMVEC.PTR$(0)=ADDR(GETDCB.V);

   3676  2 000365   200014 633500                    EPPR3   GETDCB+6,,AUTO
         2 000366   200007 453500                    STP3    GETDCB+1,,AUTO

      533     3677    3           ADDR(GETDCB.DCBNUM_)->MEMVEC.PTR$(0)=ADDR(OPNFMT.V.DCB#);

   3677  2 000367   200062 634500                    EPPR4   OPNFMT+36,,AUTO
         2 000370   200013 454500                    STP4    GETDCB+5,,AUTO
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:117  

      534     3678    3           OPNFMT=COPNFMT;

   3678  2 000371   000100 100400                    MLR     fill='000'O
         2 000372   000014 000350 1                  ADSC9   COPNFMT                  cn=0,n=232
         2 000373   200016 000350                    ADSC9   OPNFMT,,AUTO             cn=0,n=232

      535     3679    3           ADDR(OPNFMT.V_)->MEMVEC.PTR$(0)=ADDR(OPNFMT.V);

   3679  2 000374   200062 635500                    EPPR5   OPNFMT+36,,AUTO
         2 000375   200017 455500                    STP5    OPNFMT+1,,AUTO

      536     3680    3           REDFMT=CREDFMT;

   3680  2 000376   000100 100400                    MLR     fill='000'O
         2 000377   000112 000070 1                  ADSC9   CREDFMT                  cn=0,n=56
         2 000400   200110 000070                    ADSC9   REDFMT,,AUTO             cn=0,n=56

      537     3681    3           ADDR(REDFMT.V_)->MEMVEC.PTR$(0)=ADDR(REDFMT.V);

   3681  2 000401   200120 636500                    EPPR6   REDFMT+8,,AUTO
         2 000402   200111 456500                    STP6    REDFMT+1,,AUTO

      538     3682    3           ADDR(REDFMT.KEY_)->MEMVEC.PTR$(0)=ADDR(FMTKEY.L);

   3682  2 000403   200126 236100                    LDQ     VEC0$,,AUTO
         2 000404   000001 036003                    ADLQ    1,DU
         2 000405   200113 756100                    STQ     REDFMT+3,,AUTO

      539     3683
      540     3684    3           CALL M$GETDCB (GETDCB) ALTRET (NOFMT);

   3684  2 000406   200006 630500                    EPPR0   GETDCB,,AUTO
         2 000407   460002 713400                    CLIMB   alt,+24578
         2 000410   401000 401760                    pmme    nvectors=3
         2 000411   000565 702000 2                  TSX2    NOFMT

PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:118  
      541     3685    4           IF NOT %M$FMT.UOPT#(2) THEN DO;

   3685  2 000412   000003 470400 3                  LDP0    3
         2 000413   000000 471500                    LDP1    0,,PR0
         2 000414   200062 220100                    LDX0    OPNFMT+36,,AUTO
         2 000415   100000 473510                    LDP3    0,X0,PR1
         2 000416   300031 236100                    LDQ     25,,PR3
         2 000417   000100 316003                    CANQ    64,DU
         2 000420   000453 601000 2                  TNZ     s:3693

      542     3686    4                IF %M$FMT.AMR# THEN OPNFMT.NAME_=OPNFMT.UATTR_;

   3686  2 000421   010000 316007                    CANQ    4096,DL
         2 000422   000425 600000 2                  TZE     REOPN

   3686  2 000423   200034 237100                    LDAQ    OPNFMT+14,,AUTO
         2 000424   200024 757100                    STAQ    OPNFMT+6,,AUTO

      543     3687    4   REOPN:       ADDR(OPNFMT.V)->OPNCLS.CTL = '0'B;

   3687  2 000425   000000 220003       REOPN        LDX0    0,DU
         2 000426   200062 440100                    SXL0    OPNFMT+36,,AUTO

      544     3688    4                IF %M$FMT.UOPT#(1) OR OPNFMT.V.UOPT#(1) THEN CALL M$CLOSE (OPNFMT)

   3688  2 000427   000003 470400 3                  LDP0    3
         2 000430   000000 471500                    LDP1    0,,PR0
         2 000431   200062 221100                    LDX1    OPNFMT+36,,AUTO
         2 000432   100000 473511                    LDP3    0,X1,PR1
         2 000433   300031 236100                    LDQ     25,,PR3
         2 000434   000200 316003                    CANQ    128,DU
         2 000435   000441 601000 2                  TNZ     s:3688+10
         2 000436   200064 236100                    LDQ     OPNFMT+38,,AUTO
         2 000437   140000 316003                    CANQ    49152,DU
         2 000440   000446 600000 2                  TZE     s:3690

   3688  2 000441   200016 630500                    EPPR0   OPNFMT,,AUTO
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:119  
         2 000442   450001 713400                    CLIMB   alt,close
         2 000443   406000 401760                    pmme    nvectors=13
         2 000444   000446 702000 2                  TSX2    s:3690
         2 000445   000446 710000 2                  TRA     s:3690

      545     3689    5                     WHENALTRETURN DO; END;

      546     3690    4                ADDR(OPNFMT.V)->OPNCLS.CTL = ADDR(COPNFMT.V)->OPNCLS.CTL;

   3690  2 000446   000060 720000 1                  LXL0    COPNFMT+36
         2 000447   200062 440100                    SXL0    OPNFMT+36,,AUTO

      547     3691    4                CALL M$OPEN (OPNFMT);

   3691  2 000450   200016 630500                    EPPR0   OPNFMT,,AUTO
         2 000451   050000 713400                    CLIMB   open
         2 000452   410400 401760                    pmme    nvectors=18

      548     3692    4                END;

      549     3693    3           REDFMT.V.DCB#=OPNFMT.V.DCB#;

   3693  2 000453   200062 220100                    LDX0    OPNFMT+36,,AUTO
         2 000454   200120 740100                    STX0    REDFMT+8,,AUTO

      550     3694    3           REDFMT.BUF_.BUF$=FDS.FMT_.FMT$;

   3694  2 000455   200003 470500                    LDP0    @FDS,,AUTO
         2 000456   000001 236100                    LDQ     1,,PR0
         2 000457   200115 756100                    STQ     REDFMT+5,,AUTO

      551     3695    3           REDFMT.BUF_.BOUND=2047;

   3695  2 000460   200114 236100                    LDQ     REDFMT+4,,AUTO
         2 000461   177777 376007                    ANQ     65535,DL
         2 000462   000004 276000 3                  ORQ     4
         2 000463   200114 756100                    STQ     REDFMT+4,,AUTO
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:120  

      552     3696    4           CALL M$READ(REDFMT) WHENALTRETURN DO;

   3696  2 000464   200110 630500                    EPPR0   REDFMT,,AUTO
         2 000465   440000 713400                    CLIMB   alt,read
         2 000466   401400 401760                    pmme    nvectors=4
         2 000467   000471 702000 2                  TSX2    s:3697
         2 000470   000517 710000 2                  TRA     s:3704

      553     3697    4                IF %M$FMT.UOPT#(1) THEN GOTO NOFMT;

   3697  2 000471   000003 470400 3                  LDP0    3
         2 000472   000000 471500                    LDP1    0,,PR0
         2 000473   200062 220100                    LDX0    OPNFMT+36,,AUTO
         2 000474   100000 473510                    LDP3    0,X0,PR1
         2 000475   300031 236100                    LDQ     25,,PR3
         2 000476   000200 316003                    CANQ    128,DU
         2 000477   000565 601000 2                  TNZ     NOFMT

      554     3698    4                IF NOT %M$FMT.FCD# THEN OPNFMT.V.UOPT#(2) = '1'B;

   3698  2 000500   020000 316007                    CANQ    8192,DL
         2 000501   000506 601000 2                  TNZ     s:3699

   3698  2 000502   200064 236100                    LDQ     OPNFMT+38,,AUTO
         2 000503   000005 376000 3                  ANQ     5
         2 000504   020000 276003                    ORQ     8192,DU
         2 000505   200064 756100                    STQ     OPNFMT+38,,AUTO

      555     3699    4                OPNFMT.V.UOPT#(1) = '1'B;

   3699  2 000506   200064 236100                    LDQ     OPNFMT+38,,AUTO
         2 000507   000006 376000 3                  ANQ     6
         2 000510   100000 276003                    ORQ     32768,DU
         2 000511   200064 756100                    STQ     OPNFMT+38,,AUTO

      556     3700    4                OPNFMT.ACCT_=VECTOR(SYSACCT);
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:121  

   3700  2 000512   000010 237000 3                  LDAQ    8
         2 000513   200042 757100                    STAQ    OPNFMT+20,,AUTO

      557     3701    4                OPNFMT.NAME_=COPNFMT.NAME_;

   3701  2 000514   000022 237000 1                  LDAQ    COPNFMT+6
         2 000515   200024 757100                    STAQ    OPNFMT+6,,AUTO

      558     3702    4                GOTO REOPN;

   3702  2 000516   000425 710000 2                  TRA     REOPN

      559     3703    4                END;
      560     3704    3           FDS.FMTSIZE=%M$FMT.ARS#;

   3704  2 000517   000003 470400 3                  LDP0    3
         2 000520   000000 471500                    LDP1    0,,PR0
         2 000521   200062 220100                    LDX0    OPNFMT+36,,AUTO
         2 000522   100000 473510                    LDP3    0,X0,PR1
         2 000523   200003 474500                    LDP4    @FDS,,AUTO
         2 000524   300000 235100                    LDA     0,,PR3
         2 000525   400004 755100                    STA     4,,PR4

      561     3705    3           IF FDS.FMTSIZE<6 THEN GOTO NOFMT;

   3705  2 000526   000006 115007                    CMPA    6,DL
         2 000527   000565 604000 2                  TMI     NOFMT

      562     3706    3           IF ADDR(FMT)->BUBIN~=0 OR CNT(1)~=0

   3706  2 000530   400001 473500                    LDP3    1,,PR4
         2 000531   300000 235100                    LDA     0,,PR3
         2 000532   000536 601000 2                  TNZ     s:3707
         2 000533   200004 475500                    LDP5    @CNT,,AUTO
         2 000534   500001 235100                    LDA     1,,PR5
         2 000535   000541 600000 2                  TZE     s:3708
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:122  

      563     3707    3           THEN DATSIZ=ADDR(FMT)->BUBIN;

   3707  2 000536   300000 235100                    LDA     0,,PR3
         2 000537   200126 475500                    LDP5    VEC0$,,AUTO
         2 000540   500000 755100                    STA     0,,PR5

      564     3708    3           IF DATSIZ>1024 OR DATSIZ>512 AND S_D.ONE_TO_TWO.EXEC_DOMAIN=%HOST

   3708  2 000541   200126 473500                    LDP3    VEC0$,,AUTO
         2 000542   300000 235100                    LDA     0,,PR3
         2 000543   002000 115007                    CMPA    1024,DL
         2 000544   000626 605400 2                  TPNZ    BADSIZ
         2 000545   001000 115007                    CMPA    512,DL
         2 000546   000553 604400 2                  TMOZ    s:3710
         2 000547   000000 475400 xsym               LDP5    S_D$
         2 000550   506714 235100                    LDA     3532,,PR5
         2 000551   000001 115007                    CMPA    1,DL
         2 000552   000626 600000 2                  TZE     BADSIZ

      565     3709    3           THEN GOTO BADSIZ;
      566     3710    3           SUBSTR(FMT,0,4)='%(%)';

   3710  2 000553   400001 475500                    LDP5    1,,PR4
         2 000554   400004 720100                    LXL0    4,,PR4
         2 000555   040100 100400                    MLR     fill='040'O
         2 000556   000130 000004 1                  ADSC9   CREDFMT+14               cn=0,n=4
         2 000557   500000 000004                    ADSC9   0,,PR5                   cn=0,n=4

      567     3711    3           END;

      568     3712    2      FDS.FMTX=4;                          /* Start at the beginning             */

   3712  2 000560   000004 235007                    LDA     4,DL
         2 000561   200003 470500                    LDP0    @FDS,,AUTO
         2 000562   000002 755100                    STA     2,,PR0

PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:123  
      569     3713    2      RETURN;

   3713  2 000563   200200 221300                    LDX1  ! CMEM+17,,AUTO
         2 000564   000001 702211                    TSX2  ! 1,X1

      570     3714    2   NOFMT: SUBSTR(FMT,0,30)='%/FMT not found in FMT file:';

   3714  2 000565   200003 470500       NOFMT        LDP0    @FDS,,AUTO
         2 000566   000001 471500                    LDP1    1,,PR0
         2 000567   000004 720100                    LXL0    4,,PR0
         2 000570   040100 100400                    MLR     fill='040'O
         2 000571   000132 000034 1                  ADSC9   CREDFMT+16               cn=0,n=28
         2 000572   100000 000036                    ADSC9   0,,PR1                   cn=0,n=30

      571     3715    2      GOTO NOFMT1;

   3715  2 000573   000602 710000 2                  TRA     NOFMT1

      572     3716    2   BADFMT: SUBSTR(FMT,0,30)='%/No new FMT name found in ';

   3716  2 000574   200003 470500       BADFMT       LDP0    @FDS,,AUTO
         2 000575   000001 471500                    LDP1    1,,PR0
         2 000576   000004 720100                    LXL0    4,,PR0
         2 000577   040100 100400                    MLR     fill='040'O
         2 000600   000141 000033 1                  ADSC9   CREDFMT+23               cn=0,n=27
         2 000601   100000 000036                    ADSC9   0,,PR1                   cn=0,n=30

      573     3717    2   NOFMT1: SUBSTR(FMT,30,30)=FMTKEY.T;

   3717  2 000602   000001 471500       NOFMT1       LDP1    1,,PR0
         2 000603   000004 720100                    LXL0    4,,PR0
         2 000604   200126 473500                    LDP3    VEC0$,,AUTO
         2 000605   040100 100500                    MLR     fill='040'O
         2 000606   300001 200036                    ADSC9   1,,PR3                   cn=1,n=30
         2 000607   100007 400036                    ADSC9   7,,PR1                   cn=2,n=30

      574     3718    2   NOFMT2: FDS.FMTX=0;
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:124  

   3718  2 000610   200003 470500       NOFMT2       LDP0    @FDS,,AUTO
         2 000611   000002 450100                    STZ     2,,PR0

      575     3719    2      FDS.FMTSIZE=63;

   3719  2 000612   000077 235007                    LDA     63,DL
         2 000613   000004 755100                    STA     4,,PR0

      576     3720    2      SUBSTR(FMT,60,3)='%1Q';

   3720  2 000614   000001 471500                    LDP1    1,,PR0
         2 000615   000004 720100                    LXL0    4,,PR0
         2 000616   040100 100400                    MLR     fill='040'O
         2 000617   000150 000003 1                  ADSC9   CREDFMT+30               cn=0,n=3
         2 000620   100017 000003                    ADSC9   15,,PR1                  cn=0,n=3

      577     3721    2      DATSIZ=0;

   3721  2 000621   200126 471500                    LDP1    VEC0$,,AUTO
         2 000622   100000 450100                    STZ     0,,PR1

      578     3722    2      ALTRETURN;

   3722  2 000623   200200 221300                    LDX1  ! CMEM+17,,AUTO
         2 000624   000000 702211                    TSX2  ! 0,X1

      579     3723    2   BADSIZE: ENTRY ALTRET;

   3723  2 000625   200200 741300       BADSIZE      STX1  ! CMEM+17,,AUTO

      580     3724    2   BADSIZ: SUBSTR(FMT,0,60) = '%/Data request exceeds maximum (2048 bytes)';

   3724  2 000626   200003 470500       BADSIZ       LDP0    @FDS,,AUTO
         2 000627   000001 471500                    LDP1    1,,PR0
         2 000630   000004 720100                    LXL0    4,,PR0
         2 000631   040100 100400                    MLR     fill='040'O
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:125  
         2 000632   000151 000053 1                  ADSC9   CREDFMT+31               cn=0,n=43
         2 000633   100000 000074                    ADSC9   0,,PR1                   cn=0,n=60

      581     3725    2      GOTO NOFMT2;

   3725  2 000634   000610 710000 2                  TRA     NOFMT2

      582     3726    2   NOSYMBOL: ENTRY ALTRET;

   3726  2 000635   200200 741300       NOSYMBOL     STX1  ! CMEM+17,,AUTO

      583     3727    2      SUBSTR(FMT,0,20) = '%/Symbol not found:';

   3727  2 000636   200003 470500                    LDP0    @FDS,,AUTO
         2 000637   000001 471500                    LDP1    1,,PR0
         2 000640   000004 720100                    LXL0    4,,PR0
         2 000641   040100 100400                    MLR     fill='040'O
         2 000642   000164 000023 1                  ADSC9   CREDFMT+42               cn=0,n=19
         2 000643   100000 000024                    ADSC9   0,,PR1                   cn=0,n=20

      584     3728    2      SUBSTR(FMT,20,40) = SYM.T;

   3728  2 000644   000001 471500                    LDP1    1,,PR0
         2 000645   000004 720100                    LXL0    4,,PR0
         2 000646   040100 100500                    MLR     fill='040'O
         2 000647   200130 200050                    ADSC9   SYM,,AUTO                cn=1,n=40
         2 000650   100005 000050                    ADSC9   5,,PR1                   cn=0,n=40

      585     3729    2      GOTO NOFMT2;

   3729  2 000651   000610 710000 2                  TRA     NOFMT2

      586     3730    2   END GETFMT;
      587     3731        %EJECT;
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:126  
      588     3732    1   GETMEM: PROC ALTRET;

   3732  2 000652   200200 741300       GETMEM       STX1  ! CMEM+17,,AUTO

      589     3733    2      IF S_D.ONE_TO_TWO.EXEC_DOMAIN=%HOST

   3733  2 000653   000000 470400 xsym               LDP0    S_D$
         2 000654   006714 235100                    LDA     3532,,PR0
         2 000655   000001 115007                    CMPA    1,DL
         2 000656   000674 601000 2                  TNZ     s:3736
         2 000657   200004 471500                    LDP1    @CNT,,AUTO
         2 000660   100001 235100                    LDA     1,,PR1
         2 000661   777777 115007                    CMPA    -1,DL
         2 000662   000674 605400 2                  TPNZ    s:3736
         2 000663   100000 235100                    LDA     0,,PR1
         2 000664   000010 115007                    CMPA    8,DL
         2 000665   000674 605000 2                  TPL     s:3736

      590     3734    2        AND CNT(1)<=BITBIN('777777'O) AND CNT(0)<8
      591     3735    2      THEN MEMVEC.PTR$(0)->BHBIN=CNT(1);

   3735  2 000666   200003 473500                    LDP3    @FDS,,AUTO
         2 000667   300012 474500                    LDP4    10,,PR3
         2 000670   400001 475500                    LDP5    1,,PR4
         2 000671   100001 720100                    LXL0    1,,PR1
         2 000672   500000 740100                    STX0    0,,PR5
         2 000673   000702 710000 2                  TRA     s:3737

      592     3736    2      ELSE MEMVEC.PTR$(0)->BUBIN=CNT(1);

   3736  2 000674   200003 471500                    LDP1    @FDS,,AUTO
         2 000675   100012 473500                    LDP3    10,,PR1
         2 000676   300001 474500                    LDP4    1,,PR3
         2 000677   200004 475500                    LDP5    @CNT,,AUTO
         2 000700   500001 235100                    LDA     1,,PR5
         2 000701   400000 755100                    STA     0,,PR4

PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:127  
      593     3737    2      IF DATSIZ=0 THEN RETURN;

   3737  2 000702   200126 471500                    LDP1    VEC0$,,AUTO
         2 000703   100000 235100                    LDA     0,,PR1
         2 000704   000707 601000 2                  TNZ     s:3737+5

   3737  2 000705   200200 221300                    LDX1  ! CMEM+17,,AUTO
         2 000706   000001 702211                    TSX2  ! 1,X1
         2 000707   000711 710000 2                  TRA     s:3740

      594     3738    2   FIXSIZ: ENTRY ALTRET;

   3738  2 000710   200200 741300       FIXSIZ       STX1  ! CMEM+17,,AUTO

      595     3739
      596     3740    2      I=DATSIZ*2;

   3740  2 000711   200126 470500                    LDP0    VEC0$,,AUTO
         2 000712   000000 235100                    LDA     0,,PR0
         2 000713   000001 735000                    ALS     1
         2 000714   200127 755100                    STA     I,,AUTO

      597     3741    2      NODE=0;

   3741  2 000715   200153 450100                    STZ     NODE,,AUTO

      598     3742    2      NOT_IS='0'B;

   3742  2 000716   200155 450100                    STZ     NOT_IS,,AUTO

      599     3743    3      IF S_D.ONE_TO_TWO.EXEC_DOMAIN=%HOST THEN DO;

   3743  2 000717   000000 471400 xsym               LDP1    S_D$
         2 000720   106714 235100                    LDA     3532,,PR1
         2 000721   000001 115007                    CMPA    1,DL
         2 000722   000750 601000 2                  TNZ     s:3750

PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:128  
      600     3744    3           ADDRESS=MEMVEC.PTR$(0)->BPTR.OFFSET;

   3744  2 000723   200003 473500                    LDP3    @FDS,,AUTO
         2 000724   300012 474500                    LDP4    10,,PR3
         2 000725   400001 475500                    LDP5    1,,PR4
         2 000726   500000 236100                    LDQ     0,,PR5
         2 000727   000022 772000                    QRL     18
         2 000730   200151 756100                    STQ     ADDRESS,,AUTO

      601     3745    3           SEG=MEMVEC.PTR$(0)->BPTR.SEGTYP;

   3745  2 000731   300012 474500                    LDP4    10,,PR3
         2 000732   400001 475500                    LDP5    1,,PR4
         2 000733   500000 236100                    LDQ     0,,PR5
         2 000734   000012 772000                    QRL     10
         2 000735   000377 376007                    ANQ     255,DL
         2 000736   200152 756100                    STQ     SEG,,AUTO

      602     3746    3           DESC#=MEMVEC.PTR$(0)->BPTR.SEGNUM;

   3746  2 000737   300012 474500                    LDP4    10,,PR3
         2 000740   400001 475500                    LDP5    1,,PR4
         2 000741   500000 236100                    LDQ     0,,PR5
         2 000742   001777 376007                    ANQ     1023,DL
         2 000743   200154 756100                    STQ     DESC#,,AUTO

      603     3747    3           I=I*2;

   3747  2 000744   200127 235100                    LDA     I,,AUTO
         2 000745   000001 735000                    ALS     1
         2 000746   200127 755100                    STA     I,,AUTO

      604     3748    3           END;

   3748  2 000747   000760 710000 2                  TRA     s:3754

      605     3749    3      ELSE DO;
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:129  

      606     3750    3           SEG=3;

   3750  2 000750   000003 236007                    LDQ     3,DL
         2 000751   200152 756100                    STQ     SEG,,AUTO

      607     3751    3           DESC#=0;

   3751  2 000752   200154 450100                    STZ     DESC#,,AUTO

      608     3752    3           ADDRESS=MEMVEC.PTR$(0)->BUBIN;

   3752  2 000753   200003 473500                    LDP3    @FDS,,AUTO
         2 000754   300012 474500                    LDP4    10,,PR3
         2 000755   400001 475500                    LDP5    1,,PR4
         2 000756   500000 235100                    LDA     0,,PR5
         2 000757   200151 755100                    STA     ADDRESS,,AUTO

      609     3753    3           END;

      610     3754    2      IF SEG~=3 OR DESC#~=0 THEN NOT_IS='1'B;

   3754  2 000760   200152 235100                    LDA     SEG,,AUTO
         2 000761   000003 115007                    CMPA    3,DL
         2 000762   000765 601000 2                  TNZ     s:3754+5
         2 000763   200154 236100                    LDQ     DESC#,,AUTO
         2 000764   000767 600000 2                  TZE     s:3755

   3754  2 000765   400000 236003                    LDQ     -131072,DU
         2 000766   200155 756100                    STQ     NOT_IS,,AUTO

      611     3755    2      IF S_D.RUM AND S_D.OVERLAID THEN CALL DDS$IC2NODE (ADDRESS,NODE);

   3755  2 000767   104755 234100                    SZN     2541,,PR1
         2 000770   001003 605000 2                  TPL     s:3756
         2 000771   104764 234100                    SZN     2548,,PR1
         2 000772   001003 605000 2                  TPL     s:3756
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:130  

   3755  2 000773   200153 634500                    EPPR4   NODE,,AUTO
         2 000774   200203 454500                    STP4    CMEM+20,,AUTO
         2 000775   200151 635500                    EPPR5   ADDRESS,,AUTO
         2 000776   200202 455500                    STP5    CMEM+19,,AUTO
         2 000777   200202 630500                    EPPR0   CMEM+19,,AUTO
         2 001000   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001001   000000 701000 xent               TSX1    DDS$IC2NODE
         2 001002   000000 011000                    NOP     0

      612     3756    2      DIRECT=ENTADDR(DDK$GETMVAL);

   3756  2 001003   000000 636000 xent               EAQ     DDK$GETMVAL
         2 001004   200156 756100                    STQ     DIRECT,,AUTO

      613     3757    2      IF S_D.ANLZ_FILE THEN DIRECT=ENTADDR(DUL$GETMVAL);

   3757  2 001005   000000 470400 xsym               LDP0    S_D$
         2 001006   005052 234100                    SZN     2602,,PR0
         2 001007   001012 605000 2                  TPL     s:3759

   3757  2 001010   000000 636000 xent               EAQ     DUL$GETMVAL
         2 001011   200156 756100                    STQ     DIRECT,,AUTO

      614     3758
      615     3759    2      MEMVEC.BOUND(1)=I-1;

   3759  2 001012   200003 471500                    LDP1    @FDS,,AUTO
         2 001013   100012 473500                    LDP3    10,,PR1
         2 001014   200127 236100                    LDQ     I,,AUTO
         2 001015   000001 136007                    SBLQ    1,DL
         2 001016   000020 736000                    QLS     16
         2 001017   300002 676100                    ERQ     2,,PR3
         2 001020   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 001021   300002 656100                    ERSQ    2,,PR3

      616     3760    3      DO I=0 TO MEMVEC.BOUND(1)/4;
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:131  

   3760  2 001022   200127 450100                    STZ     I,,AUTO
         2 001023   001176 710000 2                  TRA     s:3782+3

      617     3761    3           IF S_D.RUM THEN CALL DUU$GETMVAL (CMEM, NODE, ADDRESS, SEG, DESC#,

   3761  2 001024   000000 470400 xsym               LDP0    S_D$
         2 001025   004755 234100                    SZN     2541,,PR0
         2 001026   001050 605000 2                  TPL     s:3763

   3761  2 001027   200155 631500                    EPPR1   NOT_IS,,AUTO
         2 001030   200207 451500                    STP1    CMEM+24,,AUTO
         2 001031   200154 633500                    EPPR3   DESC#,,AUTO
         2 001032   200206 453500                    STP3    CMEM+23,,AUTO
         2 001033   200152 634500                    EPPR4   SEG,,AUTO
         2 001034   200205 454500                    STP4    CMEM+22,,AUTO
         2 001035   200151 635500                    EPPR5   ADDRESS,,AUTO
         2 001036   200204 455500                    STP5    CMEM+21,,AUTO
         2 001037   200153 636500                    EPPR6   NODE,,AUTO
         2 001040   200203 456500                    STP6    CMEM+20,,AUTO
         2 001041   200157 637500                    EPPR7   CMEM,,AUTO
         2 001042   200202 457500                    STP7    CMEM+19,,AUTO
         2 001043   200202 630500                    EPPR0   CMEM+19,,AUTO
         2 001044   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 001045   000000 701000 xent               TSX1    DUU$GETMVAL
         2 001046   001207 702000 2                  TSX2    NOMEM
         2 001047   001117 710000 2                  TRA     s:3768

      618     3762    3                  NOT_IS) ALTRET (NOMEM);
      619     3763    3           ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN=%HOST

   3763  2 001050   006714 235100                    LDA     3532,,PR0
         2 001051   000001 115007                    CMPA    1,DL
         2 001052   001077 601000 2                  TNZ     s:3766

      620     3764    3                THEN CALL DIRECT (PINCRW(MEMVEC.PTR$(1),I)->BUBIN, ADDRESS, SEG,

PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:132  
   3764  2 001053   200003 471500                    LDP1    @FDS,,AUTO
         2 001054   100012 473500                    LDP3    10,,PR1
         2 001055   300003 474500                    LDP4    3,,PR3
         2 001056   200155 635500                    EPPR5   NOT_IS,,AUTO
         2 001057   200206 455500                    STP5    CMEM+23,,AUTO
         2 001060   200154 633500                    EPPR3   DESC#,,AUTO
         2 001061   200205 453500                    STP3    CMEM+22,,AUTO
         2 001062   200152 636500                    EPPR6   SEG,,AUTO
         2 001063   200204 456500                    STP6    CMEM+21,,AUTO
         2 001064   200151 637500                    EPPR7   ADDRESS,,AUTO
         2 001065   200203 457500                    STP7    CMEM+20,,AUTO
         2 001066   200127 720100                    LXL0    I,,AUTO
         2 001067   400000 630510                    EPPR0   0,X0,PR4
         2 001070   200202 450500                    STP0    CMEM+19,,AUTO
         2 001071   200202 630500                    EPPR0   CMEM+19,,AUTO
         2 001072   200156 221100                    LDX1    DIRECT,,AUTO
         2 001073   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 001074   000000 701011                    TSX1    0,X1
         2 001075   001207 702000 2                  TSX2    NOMEM
         2 001076   001117 710000 2                  TRA     s:3768

      621     3765    3                       DESC#, NOT_IS) ALTRET (NOMEM);
      622     3766    3                ELSE CALL DFK$GETMVAL (CMEM, ADDRESS, SEG, DESC#, NOT_IS, '0'B)

   3766  2 001077   000007 236000 3                  LDQ     7
         2 001100   200207 756100                    STQ     CMEM+24,,AUTO
         2 001101   200155 631500                    EPPR1   NOT_IS,,AUTO
         2 001102   200206 451500                    STP1    CMEM+23,,AUTO
         2 001103   200154 633500                    EPPR3   DESC#,,AUTO
         2 001104   200205 453500                    STP3    CMEM+22,,AUTO
         2 001105   200152 634500                    EPPR4   SEG,,AUTO
         2 001106   200204 454500                    STP4    CMEM+21,,AUTO
         2 001107   200151 635500                    EPPR5   ADDRESS,,AUTO
         2 001110   200203 455500                    STP5    CMEM+20,,AUTO
         2 001111   200157 636500                    EPPR6   CMEM,,AUTO
         2 001112   200202 456500                    STP6    CMEM+19,,AUTO
         2 001113   200202 630500                    EPPR0   CMEM+19,,AUTO
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:133  
         2 001114   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 001115   000000 701000 xent               TSX1    DFK$GETMVAL
         2 001116   001207 702000 2                  TSX2    NOMEM

      623     3767    3                       ALTRET(NOMEM);
      624     3768    4           IF S_D.ONE_TO_TWO.EXEC_DOMAIN~=%HOST THEN DO;

   3768  2 001117   000000 470400 xsym               LDP0    S_D$
         2 001120   006714 235100                    LDA     3532,,PR0
         2 001121   000001 115007                    CMPA    1,DL
         2 001122   001162 600000 2                  TZE     s:3780

      625     3769    5                DO X=0 TO 15;

   3769  2 001123   200150 450100                    STZ     X,,AUTO

      626     3770    5                     CMEM.VAL(X)=CMEM.VAL(X)+BITBIN(CMEM.VALB(X)&'0000001774'O);

   3770  2 001124   200150 720100                    LXL0    X,,AUTO
         2 001125   000171 236000 1                  LDQ     CREDFMT+47
         2 001126   200160 376110                    ANQ     CMEM+1,X0,AUTO
         2 001127   200160 036110                    ADLQ    CMEM+1,X0,AUTO
         2 001130   200160 756110                    STQ     CMEM+1,X0,AUTO

      627     3771    6                     IF BINBIT(X,1) THEN DO;

   3771  2 001131   200150 236100                    LDQ     X,,AUTO
         2 001132   000043 736000                    QLS     35
         2 001133   001147 600000 2                  TZE     s:3776

      628     3772    6                          PINCRW(MEMVEC.PTR$(1),I)->BUBIN=

   3772  2 001134   200003 470500                    LDP0    @FDS,,AUTO
         2 001135   000012 471500                    LDP1    10,,PR0
         2 001136   100003 473500                    LDP3    3,,PR1
         2 001137   200157 236110                    LDQ     CMEM,X0,AUTO
         2 001140   000022 736000                    QLS     18
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:134  
         2 001141   200160 036110                    ADLQ    CMEM+1,X0,AUTO
         2 001142   200127 721100                    LXL1    I,,AUTO
         2 001143   300000 756111                    STQ     0,X1,PR3

      629     3773    6                            CMEM.VAL(X-1)*262144+CMEM.VAL(X);
      630     3774    6                          I=I+1;

   3774  2 001144   200127 235100                    LDA     I,,AUTO
         2 001145   000001 035007                    ADLA    1,DL
         2 001146   200127 755100                    STA     I,,AUTO

      631     3775    6                          END;

      632     3776    5                     END;

   3776  2 001147   200150 235100                    LDA     X,,AUTO
         2 001150   000001 035007                    ADLA    1,DL
         2 001151   200150 755100                    STA     X,,AUTO
         2 001152   000020 115007                    CMPA    16,DL
         2 001153   001124 602000 2                  TNC     s:3770

      633     3777    4                I=I-1;

   3777  2 001154   200127 236100                    LDQ     I,,AUTO
         2 001155   000001 136007                    SBLQ    1,DL
         2 001156   200127 756100                    STQ     I,,AUTO

      634     3778    4                ADDRESS=ADDRESS+15;

   3778  2 001157   000017 236007                    LDQ     15,DL
         2 001160   200151 056100                    ASQ     ADDRESS,,AUTO

      635     3779    4                END;

   3779  2 001161   001172 710000 2                  TRA     s:3781

      636     3780    3           ELSE IF S_D.RUM THEN PINCRW(MEMVEC.PTR$(1),I)->BUBIN=CMEM.VAL(0);
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:135  

   3780  2 001162   004755 234100                    SZN     2541,,PR0
         2 001163   001172 605000 2                  TPL     s:3781

   3780  2 001164   200003 471500                    LDP1    @FDS,,AUTO
         2 001165   100012 473500                    LDP3    10,,PR1
         2 001166   300003 474500                    LDP4    3,,PR3
         2 001167   200127 720100                    LXL0    I,,AUTO
         2 001170   200160 236100                    LDQ     CMEM+1,,AUTO
         2 001171   400000 756110                    STQ     0,X0,PR4

      637     3781    3           ADDRESS = ADDRESS+1;

   3781  2 001172   200151 054100                    AOS     ADDRESS,,AUTO

      638     3782    3           END;

   3782  2 001173   200127 235100                    LDA     I,,AUTO
         2 001174   000001 035007                    ADLA    1,DL
         2 001175   200127 755100                    STA     I,,AUTO
         2 001176   200003 470500                    LDP0    @FDS,,AUTO
         2 001177   000012 471500                    LDP1    10,,PR0
         2 001200   100002 236100                    LDQ     2,,PR1
         2 001201   000020 772000                    QRL     16
         2 001202   000002 772000                    QRL     2
         2 001203   200127 116100                    CMPQ    I,,AUTO
         2 001204   001024 603000 2                  TRC     s:3761

      639     3783    2      RETURN;

   3783  2 001205   200200 221300                    LDX1  ! CMEM+17,,AUTO
         2 001206   000001 702211                    TSX2  ! 1,X1

   3778  2 001207                       NOMEM        null
      640     3784    2   NOMEM: ;
      641     3785    2      UNWIND TO FDS.BAILOUT;

PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:136  
   3785  2 001207   200003 470700                    LDP0  ! @FDS,,AUTO
         2 001210   000100 100700                    MLR   ! fill='000'O
         2 001211   000021 000010                    ADSC9   17,,PR0                  cn=0,n=8
         2 001212   200202 000010                    ADSC9   CMEM+19,,AUTO            cn=0,n=8
         2 001213   200202 237300                    LDAQ  ! CMEM+19,,AUTO
         2 001214   000000 700200 xent               TSX0  ! X66_AUNWIND
         2 001215   000000 000200                    ZERO    0,128

CGETDCB
 Sect OctLoc
   1     000   000001 777640   000006 006000   000002 777640   000010 006000    ................
   1     004   000000 377640   000060 006000   000000 400000   000000 000000    .....0..........

DCB_NAME
 Sect OctLoc
   1     010   013115 044104   105114 124101   137106 115124                    .M$DELTA_FMT

COPNFMT
 Sect OctLoc
   1     014   000025 777640   000060 006000   000000 177640   000000 006014    .....0..........
   1     020   000000 177640   000000 006014   000001 777640   000106 006000    .............F..
   1     024   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     060*  000000 700042   000000 002001   212525 000002   000040 252520    ..."......... ..
   1     064   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   1     070   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     074   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   1     100   040040 040040   000000 000000   000000 000000   000000 000000        ............
   1     104   000000 000000   ****** ******                                    ........

FMT_NAME
 Sect OctLoc
   1     106   007072 106117   122115 101124                                    .:FORMAT

SYSACCT
 Sect OctLoc
   1     110   072123 131123   040040 040040                                    :SYS

PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:137  
CREDFMT
 Sect OctLoc
   1     112   000005 777640   000122 006000   000015 777640   000112 006000    .....R.......J..
   1     116   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     122   000000 600000   000000 000000   000000 000000   000000 000000    ................
   1     126   000000 000000   000000 000000                                    ........

(unnamed)
 Sect OctLoc
   1     130   045050 045051   045051 040040   045057 106115   124040 156157    %(%)%)  %/FMT no
   1     134   164040 146157   165156 144040   151156 040106   115124 040146    t found in FMT f
   1     140   151154 145072   045057 116157   040156 145167   040106 115124    ile:%/No new FMT
   1     144   040156 141155   145040 146157   165156 144040   151156 040040     name found in
   1     150   045061 121040   045057 104141   164141 040162   145161 165145    %1Q %/Data reque
   1     154   163164 040145   170143 145145   144163 040155   141170 151155    st exceeds maxim
   1     160   165155 040050   062060 064070   040142 171164   145163 051040    um (2048 bytes)
   1     164   045057 123171   155142 157154   040156 157164   040146 157165    %/Symbol not fou
   1     170   156144 072040   000000 177400                                    nd: ....

(unnamed)
 Sect OctLoc
   3     000   056040 040040   000030 006000   045040 040040   000000 006003    .   ....%   ....
   3     004   000777 600000   747777 777777   637777 777777   000002 006000    ................
   3     010   000001 777640   000110 006000                                    .....H..
      642     3786    2   END GETMEM;
      643     3787    1   END;
      644     3788        %EOD;

PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:138  
--  Include file information  --

   XUH_MACRO_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure DFA$EDIT.

   Procedure DFA$EDIT requires 654 words for executable code.
   Procedure DFA$EDIT requires 138 words of local(AUTO) storage.
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:139  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:140  
          MINI XREF LISTING

ADDRESS
       842**DCL      3744<<ASSIGN   3752<<ASSIGN   3755<>CALL     3761<>CALL     3764<>CALL     3766<>CALL
      3778<<ASSIGN   3778>>ASSIGN   3781<<ASSIGN   3781>>ASSIGN
B$EDEF.ISADDR
       855**DCL      3660>>ASSIGN
BADFMT IN PROCEDURE GETFMT
      3716**LABEL    3671--CALLALT
BADSIZ IN PROCEDURE GETFMT
      3724**LABEL    3709--GOTO
BADSIZE IN PROCEDURE GETFMT
      3723**ENTRY    3631--CALL
BHBIN
       854**DCL      3637<<ASSIGN   3735<<ASSIGN
BPTR.OFFSET
       857**DCL      3744>>ASSIGN
BPTR.SEGNUM
       859**DCL      3746>>ASSIGN
BPTR.SEGTYP
       858**DCL      3745>>ASSIGN
BUBIN
       853**DCL      3638<<ASSIGN   3706>>IF       3707>>ASSIGN   3736<<ASSIGN   3752>>ASSIGN   3764<>CALL
      3772<<ASSIGN   3780<<ASSIGN
BUF
       834**DCL      3622>>CALLBLT  3623<<ASSIGN   3648--CALL
CGETDCB
       264**DCL      3675>>ASSIGN
CGETDCB.V
       265**DCL       264--DCLINIT
CMEM
       849**DCL      3761<>CALL     3766<>CALL
CMEM.VAL
       851**DCL       852--REDEF    3770<<ASSIGN   3770>>ASSIGN   3772>>ASSIGN   3772>>ASSIGN   3780>>ASSIGN
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:141  
CMEM.VALB
       852**DCL      3770>>ASSIGN
CNT
       827**DCL         6--PROC     3620>>DOCASE   3628>>ASSIGN   3634>>IF       3635>>IF       3635>>IF
      3637>>ASSIGN   3638>>ASSIGN   3644>>IF       3648<>CALL     3651<<ASSIGN   3706>>IF       3733>>IF
      3733>>IF       3735>>ASSIGN   3736>>ASSIGN
COPNFMT
       376**DCL      3678>>ASSIGN
COPNFMT.ACSVEH_
       378**DCL       379--REDEF
COPNFMT.ALTKEYS_
       384**DCL       385--REDEF     385--REDEF
COPNFMT.HDR_
       383**DCL       384--REDEF
COPNFMT.NAME_
       377**DCL      3701>>ASSIGN
COPNFMT.TAB_
       382**DCL       383--REDEF
COPNFMT.UHL_
       376**DCL       377--REDEF     377--REDEF
COPNFMT.V
       385**DCL       376--DCLINIT  3690--ASSIGN
COPNFMT.V.DCB#
       385**DCL       265--DCLINIT
COPNFMT.V.FSN#
       416**DCL       416--REDEF     416--REDEF
COPNFMT.WSN_
       382**DCL       382--REDEF
CREDFMT
       648**DCL       648--DCLINIT   649--DCLINIT  3680>>ASSIGN
CREDFMT.STATION_
       651**DCL       652--REDEF
CREDFMT.V
       652**DCL       648--DCLINIT
CREDFMT.V.DVBYTE.REREAD#
       663**DCL       663--REDEF
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:142  
CREDFMT.V.INDX#
       661**DCL       661--REDEF
DATSIZ
       847**DCL      3618<<ASSIGN   3628<<ASSIGN   3629>>IF       3630>>IF       3639>>IF       3707<<ASSIGN
      3708>>IF       3708>>IF       3721<<ASSIGN   3737>>IF       3740>>ASSIGN
DCB_NAME
       308**DCL       264--DCLINIT
DDB$BREAK
       864**DCL-ENT  3613--CALL
DDK$GETMVAL
       865**DCL-ENT  3756--ASSIGN
DDR$POSIT
       867**DCL-ENT  3648--CALL
DDS$ED_SRCH
       871**DCL-ENT  3658--CALL
DDS$IC2NODE
       866**DCL-ENT  3755--CALL
DDS$SD_SRCH
       872**DCL-ENT  3657--CALL
DESC#
       845**DCL      3746<<ASSIGN   3751<<ASSIGN   3754>>IF       3761<>CALL     3764<>CALL     3766<>CALL
DFK$GETMVAL
       869**DCL-ENT  3766--CALL
DIRECT
       848**DCL      3756<<ASSIGN   3757<<ASSIGN   3764>>CALL
DUL$GETMVAL
       870**DCL-ENT  3757--ASSIGN
DUU$GETMVAL
       868**DCL-ENT  3761--CALL
F$DCB.ACTPOS
       605**DCL       605--REDEF
F$DCB.AMR#
       592**DCL      3686>>IF
F$DCB.ARS#
       579**DCL       579--REDEF    3704>>ASSIGN
F$DCB.ATTR
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:143  
       598**DCL       599--REDEF
F$DCB.BORROW
       613**DCL       613--REDEF     613--REDEF     613--REDEF
F$DCB.DCBNAME.L
       627**DCL       627--IMP-SIZ
F$DCB.EOMCHAR#
       583**DCL       583--REDEF
F$DCB.FCD#
       592**DCL      3698>>IF
F$DCB.FLDID
       608**DCL       608--REDEF
F$DCB.FORM$
       602**DCL       602--REDEF
F$DCB.FSECT
       618**DCL       618--REDEF
F$DCB.FSN#
       595**DCL       595--REDEF     595--REDEF     596--REDEF
F$DCB.HEADER$
       601**DCL       601--REDEF
F$DCB.IXTNSIZE#
       599**DCL       599--REDEF
F$DCB.LASTSTA$
       588**DCL       588--REDEF
F$DCB.LVL
       614**DCL       614--REDEF
F$DCB.NAME#.C
       589**DCL       589--REDEF
F$DCB.NOEOF
       611**DCL       611--REDEF
F$DCB.NRECS#
       600**DCL       600--REDEF
F$DCB.NRECX
       619**DCL       619--REDEF
F$DCB.OHDR
       611**DCL       611--REDEF
F$DCB.ORG#
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:144  
       594**DCL       594--REDEF
F$DCB.PRECNO
       617**DCL       617--REDEF
F$DCB.RCSZ
       623**DCL       623--REDEF
F$DCB.RES#
       590**DCL       590--REDEF
F$DCB.SETX
       602**DCL       602--REDEF
F$DCB.TAB$
       602**DCL       602--REDEF
F$DCB.TDA
       616**DCL       617--REDEF
F$DCB.UOPT#
       592**DCL      3685>>IF       3688>>IF       3697>>IF
F$DCB.WSN#
       590**DCL       590--REDEF
FDS
       728**DCL         6--PROC
FDS.BAILOUT
       800**DCL      3614>>UNWIND   3785>>UNWIND
FDS.BUFSIZE
       754**DCL       834--IMP-SIZ  3622>>CALLBLT  3623>>ASSIGN   3648>>CALL     3648>>CALL     3650>>ASSIGN
FDS.BUFX
       752**DCL      3622>>CALLBLT  3648>>CALL     3648>>CALL     3650<<ASSIGN   3650>>ASSIGN
FDS.BUF_.BUF$
       748**DCL       834--IMP-PTR  3622>>CALLBLT  3623>>ASSIGN   3648>>CALL
FDS.FMTSIZE
       743**DCL       833--IMP-SIZ  3616>>IF       3654>>CALLBLT  3656>>ASSIGN   3671>>CALLBLT  3672>>IF
      3674>>ASSIGN   3704<<ASSIGN   3705>>IF       3710>>ASSIGN   3714>>ASSIGN   3716>>ASSIGN   3717>>ASSIGN
      3719<<ASSIGN   3720>>ASSIGN   3724>>ASSIGN   3727>>ASSIGN   3728>>ASSIGN
FDS.FMTX
       739**DCL      3654>>CALLBLT  3656>>ASSIGN   3671>>CALLBLT  3672>>IF       3674>>ASSIGN   3712<<ASSIGN
      3718<<ASSIGN
FDS.FMT_.FMT$
       735**DCL       833--IMP-PTR  3616>>IF       3654>>CALLBLT  3656>>ASSIGN   3671>>CALLBLT  3672>>IF
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:145  
      3674>>ASSIGN   3694>>ASSIGN   3706>>IF       3707>>ASSIGN   3710>>ASSIGN   3714>>ASSIGN   3716>>ASSIGN
      3717>>ASSIGN   3720>>ASSIGN   3724>>ASSIGN   3727>>ASSIGN   3728>>ASSIGN
FDS.USERDAT1#
       823**DCL      3660<<ASSIGN
FDS.VECTR$
       758**DCL       829--IMP-PTR  3612>>ASSIGN   3637>>ASSIGN   3638>>ASSIGN   3735>>ASSIGN   3736>>ASSIGN
      3744>>ASSIGN   3745>>ASSIGN   3746>>ASSIGN   3752>>ASSIGN   3759>>ASSIGN   3760>>DOINDEX  3764>>CALL
      3772>>ASSIGN   3780>>ASSIGN
FIXSIZ IN PROCEDURE GETMEM
      3738**ENTRY    3639--CALL
FMT
       833**DCL      3616>>IF       3654>>CALLBLT  3656>>ASSIGN   3671>>CALLBLT  3672>>IF       3674>>ASSIGN
      3706--IF       3707--ASSIGN   3710<<ASSIGN   3714<<ASSIGN   3716<<ASSIGN   3717<<ASSIGN   3720<<ASSIGN
      3724<<ASSIGN   3727<<ASSIGN   3728<<ASSIGN
FMTKEY
       709**DCL      3612--ASSIGN
FMTKEY.L
       711**DCL      3617<<ASSIGN   3672>>IF       3673<<ASSIGN   3682--ASSIGN
FMTKEY.T
       712**DCL      3672>>IF       3674<<ASSIGN   3717>>ASSIGN
FMT_NAME
       556**DCL       377--DCLINIT
GETDCB
       279**DCL      3675<<ASSIGN   3684<>CALL
GETDCB.DCBNUM_
       279**DCL      3677--ASSIGN
GETDCB.V
       280**DCL      3676--ASSIGN
GETDCB.V_
       279**DCL      3676--ASSIGN
GETFMT
      3666**PROC     3643--CALL
GETMEM
      3732**PROC     3641--CALL     3644--CALL
GOT_SYM
      3660**LABEL    3657--CALLALT  3658--CALLALT
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:146  
I
       836**DCL       837--REDEF    3622<<CALLBLT  3623>>ASSIGN   3648<>CALL     3650>>ASSIGN   3654<<CALLBLT
      3655>>ASSIGN   3656>>ASSIGN   3670--IMP-SIZ  3671<<CALLBLT  3672>>IF       3672>>IF       3673>>ASSIGN
      3674>>ASSIGN   3740<<ASSIGN   3747<<ASSIGN   3747>>ASSIGN   3759>>ASSIGN   3760<<DOINDEX  3764>>CALL
      3772>>ASSIGN   3774<<ASSIGN   3774>>ASSIGN   3777<<ASSIGN   3777>>ASSIGN   3780>>ASSIGN
I$
       837**DCL      3657<>CALL     3658<>CALL     3660>>ASSIGN
M$CLOSE
        17**DCL-ENT  3688--CALL
M$GETDCB
        23**DCL-ENT  3684--CALL
M$OPEN
        17**DCL-ENT  3691--CALL
M$READ
        18**DCL-ENT  3696--CALL
MEMVEC.BOUND
       830**DCL      3759<<ASSIGN   3760>>DOINDEX
MEMVEC.PTR$
       832**DCL      3612>>ASSIGN   3637>>ASSIGN   3638>>ASSIGN   3676<<ASSIGN   3677<<ASSIGN   3679<<ASSIGN
      3681<<ASSIGN   3682<<ASSIGN   3735>>ASSIGN   3736>>ASSIGN   3744>>ASSIGN   3745>>ASSIGN   3746>>ASSIGN
      3752>>ASSIGN   3764>>CALL     3772>>ASSIGN   3780>>ASSIGN
NODE
       844**DCL      3741<<ASSIGN   3755<>CALL     3761<>CALL
NOFMT IN PROCEDURE GETFMT
      3714**LABEL    3684--CALLALT  3697--GOTO     3705--GOTO
NOFMT1 IN PROCEDURE GETFMT
      3717**LABEL    3715--GOTO
NOFMT2 IN PROCEDURE GETFMT
      3718**LABEL    3725--GOTO     3729--GOTO
NOMEM IN PROCEDURE GETMEM
      3778**LABEL    3761--CALLALT  3764--CALLALT  3766--CALLALT
NOSYMBOL IN PROCEDURE GETFMT
      3726**ENTRY    3659--CALL
NOT_IS
       846**DCL      3742<<ASSIGN   3754<<ASSIGN   3761<>CALL     3764<>CALL     3766<>CALL
NO_SYM
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:147  
      3660**LABEL    3659--CALLALT
OPNCLS.CTL
       530**DCL      3687<<ASSIGN   3690<<ASSIGN   3690>>ASSIGN
OPNFMT
       485**DCL      3678<<ASSIGN   3688<>CALL     3691<>CALL
OPNFMT.ACCT_
       489**DCL      3700<<ASSIGN
OPNFMT.ACSVEH_
       487**DCL       488--REDEF
OPNFMT.ALTKEYS_
       493**DCL       494--REDEF     494--REDEF
OPNFMT.HDR_
       492**DCL       493--REDEF
OPNFMT.NAME_
       486**DCL      3686<<ASSIGN   3701<<ASSIGN
OPNFMT.TAB_
       491**DCL       492--REDEF
OPNFMT.UATTR_
       488**DCL      3686>>ASSIGN
OPNFMT.UHL_
       485**DCL       486--REDEF     486--REDEF
OPNFMT.V
       494**DCL      3679--ASSIGN   3687--ASSIGN   3690--ASSIGN
OPNFMT.V.DCB#
       494**DCL      3677--ASSIGN   3685--IF       3686--IF       3688--IF       3693>>ASSIGN   3697--IF
      3698--IF       3704--ASSIGN
OPNFMT.V.FSN#
       525**DCL       525--REDEF     525--REDEF
OPNFMT.V.UOPT#
       504**DCL      3688>>IF       3698<<ASSIGN   3699<<ASSIGN
OPNFMT.V_
       485**DCL      3679--ASSIGN
OPNFMT.WSN_
       491**DCL       491--REDEF
REDFMT
       687**DCL      3680<<ASSIGN   3696<>CALL
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:148  
REDFMT.BUF_.BOUND
       689**DCL      3695<<ASSIGN
REDFMT.BUF_.BUF$
       690**DCL      3694<<ASSIGN
REDFMT.KEY_
       687**DCL      3682--ASSIGN
REDFMT.STATION_
       690**DCL       691--REDEF
REDFMT.V
       691**DCL      3681--ASSIGN
REDFMT.V.DCB#
       691**DCL      3693<<ASSIGN
REDFMT.V.DVBYTE.REREAD#
       702**DCL       702--REDEF
REDFMT.V.INDX#
       700**DCL       700--REDEF
REDFMT.V_
       687**DCL      3681--ASSIGN
REOPN IN PROCEDURE GETFMT
      3687**LABEL    3702--GOTO
SEG
       843**DCL      3745<<ASSIGN   3750<<ASSIGN   3754>>IF       3761<>CALL     3764<>CALL     3766<>CALL
SYM
       838**DCL      3657--CALL     3658--CALL
SYM.L
       839**DCL      3655<<ASSIGN
SYM.T
       840**DCL      3656<<ASSIGN   3728>>ASSIGN
SYSACCT
       569**DCL      3700--ASSIGN
S_D.ANLZ_FILE
      3009**DCL      3757>>IF
S_D.CURRENT_CHANNEL
      3245**DCL      3247--REDEF
S_D.DEBUGA
      2397**DCL      2399--REDEF
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:149  
S_D.EIS
      3355**DCL      3384--REDEF
S_D.HOST_MESSAGE_BUF_REMOTE
      3288**DCL      3289--REDEF    3303--REDEF
S_D.JDE
      2902**DCL      2903--REDEF
S_D.L$.VALUE
      2455**DCL      2461--REDEF    2469--REDEF    2472--REDEF    2475--REDEF    2478--REDEF
S_D.L$.VALUE.L
      2456**DCL      2457--REDEF    2458--REDEF
S_D.L6_MESSAGE_BUF
      3309**DCL      3311--REDEF
S_D.ONE_TO_TWO.EXEC_DOMAIN
      3320**DCL      3630>>IF       3635>>IF       3708>>IF       3733>>IF       3743>>IF       3763>>IF
      3768>>IF
S_D.OUTPUT
      3275**DCL      3277--REDEF
S_D.OVERLAID
      2959**DCL      3755>>IF
S_D.REMOTE_MSG.FNCC
      3294**DCL      3295--REDEF
S_D.REMOTE_MSG.STXC
      3290**DCL      3291--REDEF
S_D.REMOTE_MSG.SUBFNCC
      3298**DCL      3299--REDEF
S_D.RUM
      2943**DCL      3755>>IF       3761>>IF       3780>>IF
S_D.SV
      2354**DCL      2375--REDEF
S_D$
      3606**DCL      2302--IMP-PTR  3630>>IF       3635>>IF       3708>>IF       3733>>IF       3743>>IF
      3755>>IF       3755>>IF       3757>>IF       3761>>IF       3763>>IF       3768>>IF       3780>>IF
TEXTH.C
       861**DCL       862--IMP-SIZ
VEC0$
       835**DCL       709--IMP-PTR   847--IMP-PTR  3612<<ASSIGN   3617>>ASSIGN   3618>>ASSIGN   3628>>ASSIGN
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:150  
      3629>>IF       3630>>IF       3639>>IF       3672>>IF       3672>>IF       3673>>ASSIGN   3674>>ASSIGN
      3682>>ASSIGN   3707>>ASSIGN   3708>>IF       3708>>IF       3717>>ASSIGN   3721>>ASSIGN   3737>>IF
      3740>>ASSIGN
X
       841**DCL      3769<<DOINDEX  3770>>ASSIGN   3770>>ASSIGN   3770>>ASSIGN   3771>>IF       3772>>ASSIGN
      3772>>ASSIGN
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:151  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:152  
              MINI UREF LISTING

CHAR1 IN PROCEDURE GETFMT   3669**DCL
CHAR4 IN PROCEDURE GETFMT   3668**DCL
CHARI IN PROCEDURE GETFMT   3670**DCL
DFA$EDIT       6**PROC
M$ACCT      34**DCL-ENT
M$ACTIVATE      37**DCL-ENT
M$ALIB      30**DCL-ENT
M$ASUSER      32**DCL-ENT
M$ATTACH      39**DCL-ENT
M$BADPP      57**DCL-ENT
M$CGCTL      38**DCL-ENT
M$CGINFO      38**DCL-ENT
M$CHECK      19**DCL-ENT
M$CHGUNIT      77**DCL-ENT
M$CLRSTK      75**DCL-ENT
M$CMDVAR      86**DCL-ENT
M$CONFIG      47**DCL-ENT
M$CORRES      22**DCL-ENT
M$CPEXIT      31**DCL-ENT
M$CVM      55**DCL-ENT
M$CVOL      20**DCL-ENT
M$DCLFLD      47**DCL-ENT
M$DEACTIVATE      37**DCL-ENT
M$DELREC      19**DCL-ENT
M$DEQ      84**DCL-ENT
M$DETACH      39**DCL-ENT
M$DEVICE      21**DCL-ENT
M$DISPLAY      84**DCL-ENT
M$DISPRES      24**DCL-ENT
M$DLIB      30**DCL-ENT
M$DRIBBLE      47**DCL-ENT
M$DRTN      75**DCL-ENT
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:153  
M$DSUSER      32**DCL-ENT
M$ENQ      83**DCL-ENT
M$EOM      42**DCL-ENT
M$ERASE      48**DCL-ENT
M$ERR      29**DCL-ENT
M$ERRMSG      80**DCL-ENT
M$EVENT      72**DCL-ENT
M$EXHUME      81**DCL-ENT
M$EXIT      29**DCL-ENT
M$EXTEND      21**DCL-ENT
M$FDP      53**DCL-ENT
M$FDS      52**DCL-ENT
M$FEBOOT      45**DCL-ENT
M$FECTL      46**DCL-ENT
M$FEDUMP      45**DCL-ENT
M$FID      80**DCL-ENT
M$FINDPROC      34**DCL-ENT
M$FSUSER      32**DCL-ENT
M$FVP      54**DCL-ENT
M$FWCG      38**DCL-ENT
M$GBPL      58**DCL-ENT
M$GDDL      54**DCL-ENT
M$GDP      53**DCL-ENT
M$GDS      52**DCL-ENT
M$GETMOUSE      63**DCL-ENT
M$GETPM      64**DCL-ENT
M$GJOB      82**DCL-ENT
M$GLINEATTR      42**DCL-ENT
M$GOODPP      57**DCL-ENT
M$GPLATEN      50**DCL-ENT
M$GPROMPT      49**DCL-ENT
M$GTRMATTR      43**DCL-ENT
M$GTRMCTL      41**DCL-ENT
M$GTRMTAB      44**DCL-ENT
M$GVP      53**DCL-ENT
M$HELP      80**DCL-ENT
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:154  
M$INT      72**DCL-ENT
M$INTRTN      33**DCL-ENT
M$IOQ      68**DCL-ENT
M$JOBSTATS      82**DCL-ENT
M$KEYIN      22**DCL-ENT
M$LDEV      17**DCL-ENT
M$LDTRC      30**DCL-ENT
M$LIMIT      23**DCL-ENT
M$LINES      22**DCL-ENT
M$LINK      29**DCL-ENT
M$MADMUCK      25**DCL-ENT
M$MAKUSER      56**DCL-ENT
M$MBS      24**DCL-ENT
M$MDFFLD      48**DCL-ENT
M$MERC      73**DCL-ENT
M$MERCS      74**DCL-ENT
M$MIRROR      68**DCL-ENT
M$MONINFO      85**DCL-ENT
M$MPL      58**DCL-ENT
M$NODEINFO      49**DCL-ENT
M$NXTUSR      83**DCL-ENT
M$OCMSG      81**DCL-ENT
M$OLAY      29**DCL-ENT
M$PAS      58**DCL-ENT
M$PATHCON      81**DCL-ENT
M$PDS      52**DCL-ENT
M$PFIL      19**DCL-ENT
M$PLATEN      43**DCL-ENT
M$PRECORD      21**DCL-ENT
M$PROCNAME      34**DCL-ENT
M$PROFILE      45**DCL-ENT
M$PROMPT      41**DCL-ENT
M$RACST      25**DCL-ENT
M$RDSYSLOG      66**DCL-ENT
M$RELDCB      23**DCL-ENT
M$RELRES      24**DCL-ENT
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:155  
M$RELSTARF      26**DCL-ENT
M$REM      26**DCL-ENT
M$RENV      73**DCL-ENT
M$REQUIRE      25**DCL-ENT
M$RETRY      74**DCL-ENT
M$RETRYS      74**DCL-ENT
M$REW      20**DCL-ENT
M$RLSFLD      48**DCL-ENT
M$RPRIV      76**DCL-ENT
M$RSPP      55**DCL-ENT
M$RSWITCH      77**DCL-ENT
M$RUE      83**DCL-ENT
M$SAD      56**DCL-ENT
M$SAVE      32**DCL-ENT
M$SCON      33**DCL-ENT
M$SCREECH      31**DCL-ENT
M$SENV      73**DCL-ENT
M$SETFMA      17**DCL-ENT
M$SETFP      46**DCL-ENT
M$SINPUT      44**DCL-ENT
M$SLCFLD      49**DCL-ENT
M$SMOUSE      63**DCL-ENT
M$SMPRT      55**DCL-ENT
M$SPRIV      76**DCL-ENT
M$SSC      56**DCL-ENT
M$SSWITCH      76**DCL-ENT
M$STATE      85**DCL-ENT
M$STD      57**DCL-ENT
M$STIMER      71**DCL-ENT
M$STLPP      54**DCL-ENT
M$STRAP      71**DCL-ENT
M$STRMATTR      43**DCL-ENT
M$STRMCTL      41**DCL-ENT
M$STRMTAB      44**DCL-ENT
M$SYMBIO      82**DCL-ENT
M$SYSCON      68**DCL-ENT
PL6.E3A0      #003=DFA$EDIT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:37 Page:156  
M$SYSID      86**DCL-ENT
M$TDCLOSE      67**DCL-ENT
M$TDIO      67**DCL-ENT
M$TDOPEN      66**DCL-ENT
M$TDREQCPU      67**DCL-ENT
M$TEMPWROC      61**DCL-ENT
M$TIME      84**DCL-ENT
M$TRAP      71**DCL-ENT
M$TRMISC      46**DCL-ENT
M$TRMPRG      42**DCL-ENT
M$TRTN      75**DCL-ENT
M$TRUNC      18**DCL-ENT
M$TTIMER      71**DCL-ENT
M$UC      41**DCL
M$UMPL      58**DCL-ENT
M$UNFID      80**DCL-ENT
M$UNLATCH      37**DCL-ENT
M$UNSHARE      34**DCL-ENT
M$USRFIELD      77**DCL-ENT
M$VIRTUAL      52**DCL-ENT
M$WAIT      75**DCL-ENT
M$WEOF      20**DCL-ENT
M$WRITE      18**DCL-ENT
M$WRSYSLOG      66**DCL-ENT
M$XCON      72**DCL-ENT
M$XCONRTN      33**DCL-ENT
M$XEQTIME      85**DCL-ENT
M$XFLUSH      26**DCL-ENT
M$XMOUSE      63**DCL-ENT
M$XXX      29**DCL-ENT
M$YC      31**DCL-ENT

PL6.E3A0      #004=DFA$DFMT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:38 Page:157  
      645        1        /*T***********************************************************/
      646        2        /*T*                                                         */
      647        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      648        4        /*T*                                                         */
      649        5        /*T***********************************************************/
      650        6        /*X* CCC,DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
      651        7        %SET LISTSUB='1'B;
      652        8        /*P* NAME: DFA$DFMT
      653        9             PURPOSE:  To provide formatted displays via CRAWDAD FMT records.
      654       10        */
      655       11        /*D* NAME: DFA$DFMT
      656       12             DESCRIPTION: This routine is called by DDA$DO to perform the DFMT
      657       13                  function.  The data_descriptor is decoded, and the parameter
      658       14                  word and FMT name are passed to X$FORMAT for display.
      659       15        */
      660       16        DFA$DFMT: PROC ALTRET;
      661       17        %INCLUDE DD$BASED;
      662     1320        %DUMP$CMD;
      663     1350        %INCLUDE DD_SUBS_C;
      664     1621        %INCLUDE DD$DITEM;
       12+    1724             %LIST;
       13+    1725    1        DCL SDD$ PTR;
       14+    1726    1        DCL ZITEM$ PTR;
       15+    1727    1        DCL SDD_L6$ PTR;
       16+    1728    1        DCL ZITEM_L6$ PTR;
      665     2302        %ZITEM;
      666     2374        %INCLUDE DD_ERR_C;
      667     2771        %INCLUDE DD_SD_M;
      668     4107        %INCLUDE XUH_MACRO_C;
      669     4191        %S_D;
      670     5509        %INCLUDE DD_PSUBS_C;
      671     5984    1   DCL DDK$EVAL ENTRY(6) ALTRET;
      672     5985    1   DCL DFK$EVAL ENTRY(8) ALTRET;
      673     5986    1   DCL DFA$WRITE EPTR SYMREF;
      674     5987
      675     5988    1   DCL DATSIZ SBIN;
      676     5989    1   DCL FMTKEY CHAR(32);
PL6.E3A0      #004=DFA$DFMT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:38 Page:158  
      677     5990    1   DCL 1 VEC0,
      678     5991    1         2 ADDRESS UBIN,
      679     5992    1         2 COUNT SBIN,
      680     5993    1         2 FLAGS SBIN,
      681     5994    1         2 PARMS(0:0) SBIN;
      682     5995    1   DCL ADDRESS UBIN;
      683     5996    1   DCL SEG UBIN;
      684     5997    1   DCL DESC# UBIN;
      685     5998    1   DCL NOT_IS BIT(1);
      686     5999    1   DCL 1 BFR,
      687     6000    1         2 DAT(0:511) UBIN,
      688     6001    1         2 FMT CHAR(2048);
      689     6002        %EJECT;
PL6.E3A0      #004=DFA$DFMT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:38 Page:159  
      690     6003    1        S_D.ERROR = 0;                     /* Clear error flag for later testing */
      691     6004    1        DATSIZ=0;                          /* Set up format name */
      692     6005    1        FMTKEY=BINASC(0);
      693     6006    1        SUBSTR(BFR.FMT,0,13)='%4.xxxxxxxE%(';
      694     6007    1        SEG=S_D.DO$->DUMP$CMD.FID.SIZE;
      695     6008    1        SUBSTR(BFR.FMT,13,SEG)=S_D.DO$->DUMP$CMD.FID.TEXT;
      696     6009    1        SUBSTR(BFR.FMT,13+SEG,2)='%)';
      697     6010    1        S_D.DESC$ = S_D.D$;                /* Point to descriptor */
      698     6011    1        ZITEM$ = S_D.D$;
      699     6012
      700     6013                                                /* Decode address descriptor */
      701     6014
      702     6015    1        IF S_D.DO$->DUMP$CMD.VREF
      703     6016    1        THEN IF S_D.RUM OR S_D.ONE_TO_TWO.EXEC_DOMAIN=%HOST
      704     6017    1               OR ZITEM.ADDR_TYPE = %SPEC_ACODE AND
      705     6018    1               (ZITEM.SP.VS.ID = %O_RTN OR
      706     6019    1               ZITEM.SP.VS.ID = %I_RTN OR
      707     6020    1               ZITEM.SP.VS.ID = %L_RTN OR
      708     6021    1               ZITEM.SP.VS.ID = %@_RTN OR
      709     6022    1               ZITEM.SP.VS.ID = %@@_RTN OR
      710     6023    1               ZITEM.SP.VS.ID = %#_RTN OR
      711     6024    1               ZITEM.SP.VS.ID = %##_RTN OR
      712     6025    1               ZITEM.SP.VS.ID = %RI_RTN OR
      713     6026    1               ZITEM.SP.VS.ID = %NA_RTN OR
      714     6027    1               ZITEM.SP.VS.ID = %IC_RTN OR
      715     6028    1               ZITEM.SP.VS.ID = %N_RTN OR
      716     6029    1               ZITEM.SP.VS.ID = %FMASK_RTN OR
      717     6030    1               ZITEM.SP.VS.ID = %FRANGE_RTN)
      718     6031    2             THEN DO;
      719     6032    2                  CALL DDK$EVAL(ADDRESS, SEG, DESC#, NOT_IS) ALTRET(CLEAN_RETURN);
      720     6033    2                END;
      721     6034    1             ELSE CALL DFK$EVAL(BFR, ADDRESS, SEG, DESC#, NOT_IS, BFR, BFR, '1'B )
      722     6035    1                    ALTRET ( CLEAN_RETURN );
      723     6036
      724     6037    2        IF S_D.ONE_TO_TWO.EXEC_DOMAIN=%HOST THEN DO;
      725     6038    2             VEC0.ADDRESS=ADDRESS*262144+SEG*1024+DESC#;
      726     6039    2           END;
PL6.E3A0      #004=DFA$DFMT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:38 Page:160  
      727     6040    2        ELSE DO;
      728     6041    2             VEC0.ADDRESS=ADDRESS;
      729     6042        /* do something about seg and DESC# */
      730     6043    2           END;
      731     6044    1        CALL BINCHAR(SUBSTR(BFR.FMT,3,7),ADDRESS);
      732     6045    1        VEC0.FLAGS=-1;
      733     6046    1        VEC0.COUNT=0;
      734     6047    1        CALL DFA$WRITE (VECTOR(BFR.FMT),VECTOR(VEC0),VECTOR(BFR.DAT));
      735     6048    1   CLEAN_RETURN:;
      736     6049    1        RETURN;
      737     6050    1   END;

PL6.E3A0      #004=DFA$DFMT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:38 Page:161  
--  Include file information  --

   DD_PSUBS_C.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   DD_SUBS_C.:E05TOU  is referenced.
   DD$BASED.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DFA$DFMT.

   Procedure DFA$DFMT requires 157 words for executable code.
   Procedure DFA$DFMT requires 1070 words of local(AUTO) storage.

    No errors detected in file DFA$TSA.:E05TSI    .

PL6.E3A0      #004=DFA$DFMT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:38 Page:162  

 Object Unit name= DFA$DFMT                                   File name= DFA$TSA.:E05TOU
 UTS= JUL 29 '97 14:38:02.96 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      5      5  DFA$DFMT
    1   Proc  even  none   157    235  DFA$DFMT
    2  RoData even  none     4      4  DFA$DFMT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        0  DFA$DFMT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       6 DDK$EVAL
 yes     yes           Std       8 DFK$EVAL
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    S_D$                                  DFA$WRITE                             B_VECTNIL
PL6.E3A0      #004=DFA$DFMT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:38 Page:163  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #004=DFA$DFMT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:38 Page:164  


      645        1        /*T***********************************************************/
      646        2        /*T*                                                         */
      647        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      648        4        /*T*                                                         */
      649        5        /*T***********************************************************/
      650        6        /*X* CCC,DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
      651        7        %SET LISTSUB='1'B;
      652        8        /*P* NAME: DFA$DFMT
      653        9             PURPOSE:  To provide formatted displays via CRAWDAD FMT records.
      654       10        */
      655       11        /*D* NAME: DFA$DFMT
      656       12             DESCRIPTION: This routine is called by DDA$DO to perform the DFMT
      657       13                  function.  The data_descriptor is decoded, and the parameter
      658       14                  word and FMT name are passed to X$FORMAT for display.
      659       15        */
      660       16        DFA$DFMT: PROC ALTRET;

     16  1 000000   000000 700200 xent  DFA$DFMT     TSX0  ! X66_AUTO_0
         1 000001   002056 000000                    ZERO    1070,0

      661       17        %INCLUDE DD$BASED;
      662     1320        %DUMP$CMD;
      663     1350        %INCLUDE DD_SUBS_C;
      664     1621        %INCLUDE DD$DITEM;
       12+    1724             %LIST;
       13+    1725    1        DCL SDD$ PTR;
       14+    1726    1        DCL ZITEM$ PTR;
       15+    1727    1        DCL SDD_L6$ PTR;
       16+    1728    1        DCL ZITEM_L6$ PTR;
      665     2302        %ZITEM;
      666     2374        %INCLUDE DD_ERR_C;
      667     2771        %INCLUDE DD_SD_M;
      668     4107        %INCLUDE XUH_MACRO_C;
      669     4191        %S_D;
      670     5509        %INCLUDE DD_PSUBS_C;
      671     5984    1   DCL DDK$EVAL ENTRY(6) ALTRET;
PL6.E3A0      #004=DFA$DFMT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:38 Page:165  
      672     5985    1   DCL DFK$EVAL ENTRY(8) ALTRET;
      673     5986    1   DCL DFA$WRITE EPTR SYMREF;
      674     5987
      675     5988    1   DCL DATSIZ SBIN;
      676     5989    1   DCL FMTKEY CHAR(32);
      677     5990    1   DCL 1 VEC0,
      678     5991    1         2 ADDRESS UBIN,
      679     5992    1         2 COUNT SBIN,
      680     5993    1         2 FLAGS SBIN,
      681     5994    1         2 PARMS(0:0) SBIN;
      682     5995    1   DCL ADDRESS UBIN;
      683     5996    1   DCL SEG UBIN;
      684     5997    1   DCL DESC# UBIN;
      685     5998    1   DCL NOT_IS BIT(1);
      686     5999    1   DCL 1 BFR,
      687     6000    1         2 DAT(0:511) UBIN,
      688     6001    1         2 FMT CHAR(2048);
      689     6002        %EJECT;
PL6.E3A0      #004=DFA$DFMT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:38 Page:166  
      690     6003    1        S_D.ERROR = 0;                     /* Clear error flag for later testing */

   6003  1 000002   000000 470400 xsym               LDP0    S_D$
         1 000003   000013 450100                    STZ     11,,PR0

      691     6004    1        DATSIZ=0;                          /* Set up format name */

   6004  1 000004   200007 450100                    STZ     DATSIZ,,AUTO

      692     6005    1        FMTKEY=BINASC(0);

   6005  1 000005   040100 100400                    MLR     fill='040'O
         1 000006   000000 000001 2                  ADSC9   0                        cn=0,n=1
         1 000007   200010 000040                    ADSC9   FMTKEY,,AUTO             cn=0,n=32

      693     6006    1        SUBSTR(BFR.FMT,0,13)='%4.xxxxxxxE%(';

   6006  1 000010   040100 100400                    MLR     fill='040'O
         1 000011   000000 000015 0                  ADSC9   0                        cn=0,n=13
         1 000012   201030 000015                    ADSC9   BFR+512,,AUTO            cn=0,n=13

      694     6007    1        SEG=S_D.DO$->DUMP$CMD.FID.SIZE;

   6007  1 000013   000031 471500                    LDP1    25,,PR0
         1 000014   100004 236100                    LDQ     4,,PR1
         1 000015   000033 772000                    QRL     27
         1 000016   200025 756100                    STQ     SEG,,AUTO

      695     6008    1        SUBSTR(BFR.FMT,13,SEG)=S_D.DO$->DUMP$CMD.FID.TEXT;

   6008  1 000017   000000 620006                    EAX0    0,QL
         1 000020   040140 100500                    MLR     fill='040'O
         1 000021   100004 200077                    ADSC9   4,,PR1                   cn=1,n=63
         1 000022   201033 200010                    ADSC9   BFR+515,,AUTO            cn=1,n=*X0

      696     6009    1        SUBSTR(BFR.FMT,13+SEG,2)='%)';

PL6.E3A0      #004=DFA$DFMT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:38 Page:167  
   6009  1 000023   200025 235100                    LDA     SEG,,AUTO
         1 000024   040105 100400                    MLR     fill='040'O
         1 000025   000004 000002 0                  ADSC9   4                        cn=0,n=2
         1 000026   201033 200002                    ADSC9   BFR+515,A,AUTO           cn=1,n=2

      697     6010    1        S_D.DESC$ = S_D.D$;                /* Point to descriptor */

   6010  1 000027   000044 236100                    LDQ     36,,PR0
         1 000030   000041 756100                    STQ     33,,PR0

      698     6011    1        ZITEM$ = S_D.D$;

   6011  1 000031   200004 756100                    STQ     ZITEM$,,AUTO

      699     6012
      700     6013                                                /* Decode address descriptor */
      701     6014
      702     6015    1        IF S_D.DO$->DUMP$CMD.VREF

   6015  1 000032   000031 471500                    LDP1    25,,PR0
         1 000033   100001 236100                    LDQ     1,,PR1
         1 000034   002000 316003                    CANQ    1024,DU
         1 000035   000146 600000 1                  TZE     s:6037

      703     6016    1        THEN IF S_D.RUM OR S_D.ONE_TO_TWO.EXEC_DOMAIN=%HOST

   6016  1 000036   004755 234100                    SZN     2541,,PR0
         1 000037   000105 604000 1                  TMI     s:6032
         1 000040   006714 235100                    LDA     3532,,PR0
         1 000041   000001 115007                    CMPA    1,DL
         1 000042   000105 600000 1                  TZE     s:6032
         1 000043   200004 473500                    LDP3    ZITEM$,,AUTO
         1 000044   300006 236100                    LDQ     6,,PR3
         1 000045   000777 376003                    ANQ     511,DU
         1 000046   000101 116003                    CMPQ    65,DU
         1 000047   000122 601000 1                  TNZ     s:6034
         1 000050   300007 236100                    LDQ     7,,PR3
PL6.E3A0      #004=DFA$DFMT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:38 Page:168  
         1 000051   777000 316003                    CANQ    -512,DU
         1 000052   000105 600000 1                  TZE     s:6032
         1 000053   300007 236100                    LDQ     7,,PR3
         1 000054   777000 376003                    ANQ     -512,DU
         1 000055   001000 116003                    CMPQ    512,DU
         1 000056   000105 600000 1                  TZE     s:6032
         1 000057   002000 116003                    CMPQ    1024,DU
         1 000060   000105 600000 1                  TZE     s:6032
         1 000061   040000 116003                    CMPQ    16384,DU
         1 000062   000105 600000 1                  TZE     s:6032
         1 000063   041000 116003                    CMPQ    16896,DU
         1 000064   000105 600000 1                  TZE     s:6032
         1 000065   042000 116003                    CMPQ    17408,DU
         1 000066   000105 600000 1                  TZE     s:6032
         1 000067   043000 116003                    CMPQ    17920,DU
         1 000070   000105 600000 1                  TZE     s:6032
         1 000071   036000 116003                    CMPQ    15360,DU
         1 000072   000105 600000 1                  TZE     s:6032
         1 000073   037000 116003                    CMPQ    15872,DU
         1 000074   000105 600000 1                  TZE     s:6032
         1 000075   016000 116003                    CMPQ    7168,DU
         1 000076   000105 600000 1                  TZE     s:6032
         1 000077   060000 116003                    CMPQ    24576,DU
         1 000100   000105 600000 1                  TZE     s:6032
         1 000101   030000 116003                    CMPQ    12288,DU
         1 000102   000105 600000 1                  TZE     s:6032
         1 000103   027000 116003                    CMPQ    11776,DU
         1 000104   000122 601000 1                  TNZ     s:6034

      704     6017    1               OR ZITEM.ADDR_TYPE = %SPEC_ACODE AND
      705     6018    1               (ZITEM.SP.VS.ID = %O_RTN OR
      706     6019    1               ZITEM.SP.VS.ID = %I_RTN OR
      707     6020    1               ZITEM.SP.VS.ID = %L_RTN OR
      708     6021    1               ZITEM.SP.VS.ID = %@_RTN OR
      709     6022    1               ZITEM.SP.VS.ID = %@@_RTN OR
      710     6023    1               ZITEM.SP.VS.ID = %#_RTN OR
      711     6024    1               ZITEM.SP.VS.ID = %##_RTN OR
PL6.E3A0      #004=DFA$DFMT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:38 Page:169  
      712     6025    1               ZITEM.SP.VS.ID = %RI_RTN OR
      713     6026    1               ZITEM.SP.VS.ID = %NA_RTN OR
      714     6027    1               ZITEM.SP.VS.ID = %IC_RTN OR
      715     6028    1               ZITEM.SP.VS.ID = %N_RTN OR
      716     6029    1               ZITEM.SP.VS.ID = %FMASK_RTN OR
      717     6030    1               ZITEM.SP.VS.ID = %FRANGE_RTN)
      718     6031    2             THEN DO;

      719     6032    2                  CALL DDK$EVAL(ADDRESS, SEG, DESC#, NOT_IS) ALTRET(CLEAN_RETURN);

   6032  1 000105   200027 633500                    EPPR3   NOT_IS,,AUTO
         1 000106   202033 453500                    STP3    BFR+1027,,AUTO
         1 000107   200026 631500                    EPPR1   DESC#,,AUTO
         1 000110   202032 451500                    STP1    BFR+1026,,AUTO
         1 000111   200025 634500                    EPPR4   SEG,,AUTO
         1 000112   202031 454500                    STP4    BFR+1025,,AUTO
         1 000113   200024 635500                    EPPR5   ADDRESS,,AUTO
         1 000114   202030 455500                    STP5    BFR+1024,,AUTO
         1 000115   202030 630500                    EPPR0   BFR+1024,,AUTO
         1 000116   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000117   000000 701000 xent               TSX1    DDK$EVAL
         1 000120   000234 702000 1                  TSX2    CLEAN_RETURN

      720     6033    2                END;

   6033  1 000121   000146 710000 1                  TRA     s:6037

      721     6034    1             ELSE CALL DFK$EVAL(BFR, ADDRESS, SEG, DESC#, NOT_IS, BFR, BFR, '1'B )

   6034  1 000122   000001 236000 2                  LDQ     1
         1 000123   202037 756100                    STQ     BFR+1031,,AUTO
         1 000124   200030 631500                    EPPR1   BFR,,AUTO
         1 000125   202036 451500                    STP1    BFR+1030,,AUTO
         1 000126   200030 634500                    EPPR4   BFR,,AUTO
         1 000127   202035 454500                    STP4    BFR+1029,,AUTO
         1 000130   200027 635500                    EPPR5   NOT_IS,,AUTO
         1 000131   202034 455500                    STP5    BFR+1028,,AUTO
PL6.E3A0      #004=DFA$DFMT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:38 Page:170  
         1 000132   200026 636500                    EPPR6   DESC#,,AUTO
         1 000133   202033 456500                    STP6    BFR+1027,,AUTO
         1 000134   200025 637500                    EPPR7   SEG,,AUTO
         1 000135   202032 457500                    STP7    BFR+1026,,AUTO
         1 000136   200024 630500                    EPPR0   ADDRESS,,AUTO
         1 000137   202031 450500                    STP0    BFR+1025,,AUTO
         1 000140   200030 630500                    EPPR0   BFR,,AUTO
         1 000141   202030 450500                    STP0    BFR+1024,,AUTO
         1 000142   202030 630500                    EPPR0   BFR+1024,,AUTO
         1 000143   000026 631400 xsym               EPPR1   B_VECTNIL+22
         1 000144   000000 701000 xent               TSX1    DFK$EVAL
         1 000145   000234 702000 1                  TSX2    CLEAN_RETURN

      722     6035    1                    ALTRET ( CLEAN_RETURN );
      723     6036
      724     6037    2        IF S_D.ONE_TO_TWO.EXEC_DOMAIN=%HOST THEN DO;

   6037  1 000146   000000 470400 xsym               LDP0    S_D$
         1 000147   006714 235100                    LDA     3532,,PR0
         1 000150   000001 115007                    CMPA    1,DL
         1 000151   000161 601000 1                  TNZ     s:6041

      725     6038    2             VEC0.ADDRESS=ADDRESS*262144+SEG*1024+DESC#;

   6038  1 000152   200024 236100                    LDQ     ADDRESS,,AUTO
         1 000153   000010 736000                    QLS     8
         1 000154   200025 036100                    ADLQ    SEG,,AUTO
         1 000155   000012 736000                    QLS     10
         1 000156   200026 036100                    ADLQ    DESC#,,AUTO
         1 000157   200020 756100                    STQ     VEC0,,AUTO

      726     6039    2           END;

   6039  1 000160   000163 710000 1                  TRA     s:6044

      727     6040    2        ELSE DO;

PL6.E3A0      #004=DFA$DFMT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:38 Page:171  
      728     6041    2             VEC0.ADDRESS=ADDRESS;

   6041  1 000161   200024 236100                    LDQ     ADDRESS,,AUTO
         1 000162   200020 756100                    STQ     VEC0,,AUTO

      729     6042        /* do something about seg and DESC# */
      730     6043    2           END;

      731     6044    1        CALL BINCHAR(SUBSTR(BFR.FMT,3,7),ADDRESS);

   6044  1 000163   200024 235100                    LDA     ADDRESS,,AUTO
         1 000164   000044 773000                    LRL     36
         1 000165   202030 757100                    STAQ    BFR+1024,,AUTO
         1 000166   000100 301500                    BTD
         1 000167   202030 000010                    NDSC9   BFR+1024,,AUTO           cn=0,s=lsgnf,sf=0,n=8
         1 000170   201030 630007                    NDSC9   BFR+512,,AUTO            cn=3,s=nosgn,sf=0,n=7

      732     6045    1        VEC0.FLAGS=-1;

   6045  1 000171   000001 335007                    LCA     1,DL
         1 000172   200022 755100                    STA     VEC0+2,,AUTO

      733     6046    1        VEC0.COUNT=0;

   6046  1 000173   200021 450100                    STZ     VEC0+1,,AUTO

      734     6047    1        CALL DFA$WRITE (VECTOR(BFR.FMT),VECTOR(VEC0),VECTOR(BFR.DAT));

   6047  1 000174   000002 235000 2                  LDA     2
         1 000175   202030 452500                    STP2    BFR+1024,,AUTO
         1 000176   202030 236100                    LDQ     BFR+1024,,AUTO
         1 000177   001030 036003                    ADLQ    536,DU
         1 000200   202032 757100                    STAQ    BFR+1026,,AUTO
         1 000201   000003 235000 2                  LDA     3
         1 000202   202034 452500                    STP2    BFR+1028,,AUTO
         1 000203   202034 236100                    LDQ     BFR+1028,,AUTO
         1 000204   000020 036003                    ADLQ    16,DU
PL6.E3A0      #004=DFA$DFMT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:38 Page:172  
         1 000205   202036 757100                    STAQ    BFR+1030,,AUTO
         1 000206   000002 235000 2                  LDA     2
         1 000207   202040 452500                    STP2    BFR+1032,,AUTO
         1 000210   202040 236100                    LDQ     BFR+1032,,AUTO
         1 000211   000030 036003                    ADLQ    24,DU
         1 000212   202044 757100                    STAQ    BFR+1036,,AUTO
         1 000213   202032 237100                    LDAQ    BFR+1026,,AUTO
         1 000214   202042 757100                    STAQ    BFR+1034,,AUTO
         1 000215   202036 237100                    LDAQ    BFR+1030,,AUTO
         1 000216   202046 757100                    STAQ    BFR+1038,,AUTO
         1 000217   202044 237100                    LDAQ    BFR+1036,,AUTO
         1 000220   202050 757100                    STAQ    BFR+1040,,AUTO
         1 000221   202050 631500                    EPPR1   BFR+1040,,AUTO
         1 000222   202054 451500                    STP1    BFR+1044,,AUTO
         1 000223   202046 633500                    EPPR3   BFR+1038,,AUTO
         1 000224   202053 453500                    STP3    BFR+1043,,AUTO
         1 000225   202042 634500                    EPPR4   BFR+1034,,AUTO
         1 000226   202052 454500                    STP4    BFR+1042,,AUTO
         1 000227   202052 630500                    EPPR0   BFR+1042,,AUTO
         1 000230   000000 220000 xsym               LDX0    DFA$WRITE
         1 000231   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000232   000000 701010                    TSX1    0,X0
         1 000233   000000 011000                    NOP     0

   6046  1 000234                       CLEAN_RETURN null
      735     6048    1   CLEAN_RETURN:;
      736     6049    1        RETURN;

   6049  1 000234   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   0     000   045064 056170   170170 170170   170170 105045   050040 040040    %4.xxxxxxxE%(
   0     004   045051 040040                                                    %)

(unnamed)
 Sect OctLoc
PL6.E3A0      #004=DFA$DFMT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:38 Page:173  
   2     000   000040 040040   000030 006000   000777 777640   000003 777640    .   ............
      737     6050    1   END;

PL6.E3A0      #004=DFA$DFMT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:38 Page:174  
--  Include file information  --

   DD_PSUBS_C.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   DD_SUBS_C.:E05TOU  is referenced.
   DD$BASED.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DFA$DFMT.

   Procedure DFA$DFMT requires 157 words for executable code.
   Procedure DFA$DFMT requires 1070 words of local(AUTO) storage.

    No errors detected in file DFA$TSA.:E05TSI    .
PL6.E3A0      #004=DFA$DFMT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:38 Page:175  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=DFA$DFMT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:38 Page:176  
          MINI XREF LISTING

ADDRESS
      5995**DCL      6032<>CALL     6034<>CALL     6038>>ASSIGN   6041>>ASSIGN   6044>>CALLBLT
BFR
      5999**DCL      6034<>CALL     6034<>CALL     6034<>CALL
BFR.DAT
      6000**DCL      6047--CALL
BFR.FMT
      6001**DCL      6006<<ASSIGN   6008<<ASSIGN   6009<<ASSIGN   6044<<CALLBLT  6047--CALL
CLEAN_RETURN
      6046**LABEL    6032--CALLALT  6034--CALLALT
DATSIZ
      5988**DCL      6004<<ASSIGN
DDK$EVAL
      5984**DCL-ENT  6032--CALL
DESC#
      5997**DCL      6032<>CALL     6034<>CALL     6038>>ASSIGN
DFA$WRITE
      5986**DCL      6047>>CALL
DFK$EVAL
      5985**DCL-ENT  6034--CALL
DUMP$CMD.FID.SIZE
      1342**DCL      6007>>ASSIGN
DUMP$CMD.FID.TEXT
      1343**DCL      6008>>ASSIGN
DUMP$CMD.VREF
      1332**DCL      6015>>IF
FMTKEY
      5989**DCL      6005<<ASSIGN
NOT_IS
      5998**DCL      6032<>CALL     6034<>CALL
SEG
      5996**DCL      6007<<ASSIGN   6008>>ASSIGN   6009>>ASSIGN   6032<>CALL     6034<>CALL     6038>>ASSIGN
PL6.E3A0      #004=DFA$DFMT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:38 Page:177  
S_D.CURRENT_CHANNEL
      5143**DCL      5145--REDEF
S_D.D$
      4281**DCL      6010>>ASSIGN   6011>>ASSIGN
S_D.DEBUGA
      4295**DCL      4297--REDEF
S_D.DESC$
      4275**DCL      6010<<ASSIGN
S_D.DO$
      4246**DCL      6007>>ASSIGN   6008>>ASSIGN   6015>>IF
S_D.EIS
      5253**DCL      5282--REDEF
S_D.ERROR
      4224**DCL      6003<<ASSIGN
S_D.HOST_MESSAGE_BUF_REMOTE
      5186**DCL      5187--REDEF    5201--REDEF
S_D.JDE
      4800**DCL      4801--REDEF
S_D.L$.VALUE
      4353**DCL      4359--REDEF    4367--REDEF    4370--REDEF    4373--REDEF    4376--REDEF
S_D.L$.VALUE.L
      4354**DCL      4355--REDEF    4356--REDEF
S_D.L6_MESSAGE_BUF
      5207**DCL      5209--REDEF
S_D.ONE_TO_TWO.EXEC_DOMAIN
      5218**DCL      6016>>IF       6037>>IF
S_D.OUTPUT
      5173**DCL      5175--REDEF
S_D.REMOTE_MSG.FNCC
      5192**DCL      5193--REDEF
S_D.REMOTE_MSG.STXC
      5188**DCL      5189--REDEF
S_D.REMOTE_MSG.SUBFNCC
      5196**DCL      5197--REDEF
S_D.RUM
      4841**DCL      6016>>IF
PL6.E3A0      #004=DFA$DFMT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:38 Page:178  
S_D.SV
      4252**DCL      4273--REDEF
S_D$
      5504**DCL      4200--IMP-PTR  6003>>ASSIGN   6007>>ASSIGN   6008>>ASSIGN   6010>>ASSIGN   6010>>ASSIGN
      6011>>ASSIGN   6015>>IF       6016>>IF       6016>>IF       6037>>IF
VEC0
      5990**DCL      6047--CALL
VEC0.ADDRESS
      5991**DCL      6038<<ASSIGN   6041<<ASSIGN
VEC0.COUNT
      5992**DCL      6046<<ASSIGN
VEC0.FLAGS
      5993**DCL      6045<<ASSIGN
ZITEM.ADDRESS
      2337**DCL      2342--REDEF    2343--REDEF    2344--REDEF
ZITEM.ADDR_TYPE
      2331**DCL      6016>>IF
ZITEM.SP.VD
      2345**DCL      2349--REDEF    2352--REDEF
ZITEM.SP.VS.ID
      2353**DCL      6016>>IF       6016>>IF       6016>>IF       6016>>IF       6016>>IF       6016>>IF
      6016>>IF       6016>>IF       6016>>IF       6016>>IF       6016>>IF       6016>>IF       6016>>IF
ZITEM$
      1726**DCL      2303--IMP-PTR  6011<<ASSIGN   6016>>IF       6016>>IF       6016>>IF       6016>>IF
      6016>>IF       6016>>IF       6016>>IF       6016>>IF       6016>>IF       6016>>IF       6016>>IF
      6016>>IF       6016>>IF       6016>>IF
PL6.E3A0      #004=DFA$DFMT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:38 Page:179  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #004=DFA$DFMT File=DFA$TSA.:E05TSI                                 TUE 07/29/97 14:38 Page:180  
              MINI UREF LISTING

DFA$DFMT      16**PROC
SDD$    1725**DCL
SDD_L6$    1727**DCL
ZITEM_L6$    1728**DCL
