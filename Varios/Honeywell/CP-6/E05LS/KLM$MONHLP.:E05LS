VERSION E05

PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:1    
        1        1        /*M* KLM$MONHLP The monitor part of HOST LOGON */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8
        9        9        /*P* NAME:         KLM$MONHLP
       10       10             PURPOSE:      To provide the functions of the HOST LOGON
       11       11                           process that must reside in the monitor. */
       12       12
       13       13        KLM$MONHLP: PROC (PARM) ALTRET;
       14       14
       15       15
       16       16
       17       17
       18       18
       19       19        /* INCLUDES */
       20       20
       21       21        %INCLUDE UD_ERRORS_C;
       22       63        %INCLUDE UD_SEV_C;
       23       77        %INCLUDE B$JIT_C;
       24      391        %INCLUDE NK$LDCT;
       25      493        %INCLUDE KC$CGBLK;
       26      541        %INCLUDE KV$VDO;
       27     1556        %INCLUDE KL_MACRO_C;
       28     4908        %INCLUDE KL_AFCN_C;
       29     5009        %INCLUDE KC_CP6;
       30     5569        %INCLUDE EL_MACRO_C;
       31     5738        %INCLUDE JG_GHOSTS_C;
       32     5828        %INCLUDE KC_DATA_R;
       33     5841        %INCLUDE NK_SUBS;
       34     5866        %INCLUDE NK_LDCT_R;
       35     5875        %INCLUDE KL_SUPER_C;
       36     8777        %INCLUDE SS_SCHED_C;
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:2    
       37     9010        %INCLUDE EL_SUBS_C;
       38     9094        %INCLUDE HF_LOCK_C;
       39     9108        %INCLUDE KI_DATA_R;
       40     9134        %INCLUDE KI_MACROS_C;
       41     9742        %INCLUDE KL_SUBS_C;
       42     9796        %INCLUDE KI_ERRORS_C;
       43     9881        %INCLUDE KC_ERRORS_C;
       44     9928        %INCLUDE UM_CP6;
       45    10780        %INCLUDE KL_ERRORS_C;
       46    10822        %INCLUDE K_DATA_R;
       47    11533
       48    11534
       49    11535
       50    11536        /* Equates */
       51    11537        %KV_VDO_E;
       52    11573
       53    11574
       54    11575
       55    11576        /* PARAMETERS */
       56    11577
       57    11578    1   DCL PARM UBIN WORD;
       58    11579
       59    11580
       60    11581
       61    11582
       62    11583        /* MACROS */
       63    11584
       64    11585        %MACRO $ERROR (NAME=GORGO,CODE=0,SEV=SEV_ERROR#);
       65    11586        DCL 1 NAME CONSTANT ALIGNED,
       66    11587              2 * BIT(18) UNAL INIT('131415'O),
       67    11588              2 * UBIN(15) UNAL INIT(CODE),
       68    11589              2 * UBIN(3) UNAL INIT(SEV);
       69    11590        %MEND;
       70    11591
       71    11592
       72    11593
       73    11594
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:3    
       74    11595        /* BASED STRUCTURES */
       75    11596
       76    11597        %B$JIT0;
       77    11686        %A$JIT6X;
       78    11689        %NK$LDCT (STCLASS="BASED(LDCT$)");
       79    11735        %KL_PCD (FPTN=KL$PCD,CG=1,STCLASS="BASED(B$PS2$)");
       80    11900        %EL$RENT (FPTN=EL$RENT,STCLASS="BASED(B$PS1$)",ALIGNED=DALIGNED);
       81    11957        %VLR_PATHCON (FPTN=VLR$PATHCON,STCLASS="BASED(B$PS1$)");
       82    11971        %KC$CGID (FPTN=KC$CGID,STCLASS="BASED(B$PS2$)");
       83    11997        %KI$ROUTE(STCLASS=BASED);
       84    12051    1   DCL KI$ROUTE$(0:0) PTR BASED(KI_ROUTE$$);
       85    12052
       86    12053
       87    12054
       88    12055
       89    12056        /* AUTO */
       90    12057
       91    12058        %K$RWPARM (NAME=K$RWPARM,STCLASS=AUTO);
       92    12374    1   DCL LDCT$ PTR;
       93    12375    1   DCL CGX UBIN WORD;
       94    12376    1   DCL TPASS UBIN WORD;
       95    12377    1   DCL NMLDCT$ REDEF TPASS PTR;
       96    12378    1   DCL 1 FEPNM CALIGNED,
       97    12379    1         2 NAME CHAR(6) CALIGNED,
       98    12380    1         2 NODE CHAR(2) CALIGNED;
       99    12381    1   DCL FEPNM_C REDEF FEPNM CHAR(8);
      100    12382    1   DCL PSIZ UBIN WORD;
      101    12383    1   DCL FEX UBIN WORD;
      102    12384    1   DCL ERROR UBIN;
      103    12385
      104    12386
      105    12387
      106    12388        /* CONSTANT */
      107    12389
      108    12390    1   DCL NCGACM CHAR(0) CONSTANT INIT('*** YOUR COMGROUP DOES NOT ACCEPT YOUR LOGON! ***'
             12390            );
      109    12391        %$ERROR (NAME=E_NOTAUTH,CODE=%E$NOTAUTH,SEV=SEV_ABORT#);
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:4    
      110    12397        %$ERROR (NAME=E_REMCON ,CODE=%E$REMCON ,SEV=SEV_ERROR#);
      111    12403        %$ERROR (NAME=E_ANY    ,CODE=0         ,SEV=SEV_ERROR#);
      112    12409        %$ERROR (NAME=E_PCNLDCT,CODE=%E$PCNLDCT);
      113    12415        %$ERROR (NAME=E_PCFEPDN,CODE=%E$PCFEPDN);
      114    12421        %$ERROR (NAME=E_EXHBDS ,CODE=%E$EXHBDS );
      115    12427
      116    12428
      117    12429
      118    12430
      119    12431        /* REFS */
      120    12432
      121    12433    1   DCL ELA$SYSLOG    ENTRY(6) ALTRET;
      122    12434    1   DCL FRF$ADDRES ENTRY(2) ALTRET;
      123    12435    1   DCL HFF$DSIZ      ENTRY(2) ALTRET;
      124    12436    1   DCL KCD$PREL      ENTRY(1);
      125    12437    1   DCL KCF$EXHUME    ENTRY(1);
      126    12438    1   DCL KCO$TRMCON    ENTRY(4) ALTRET;
      127    12439    1   DCL KCO$TRMGO     ENTRY(1) ALTRET;
      128    12440    1   DCL KIA$FCNOU     ENTRY(3) ALTRET;
      129    12441    1   DCL KIA$DSCU     ENTRY(3) ALTRET;
      130    12442    1   DCL KQP$EVNT      ENTRY(2) ALTRET;
      131    12443    1   DCL NKL$GETDCT    ENTRY(1) ALTRET;
      132    12444    1   DCL NKL$RELDCT    ENTRY(1) ALTRET;
      133    12445    1   DCL SC_NTRMCN     ENTRY    CONV(2,0);
      134    12446    1   DCL SSR$REG       ENTRY(3) ALTRET;
      135    12447
      136    12448    1   DCL B$JIT$ PTR SYMREF;
      137    12449    1   DCL S_CUN UBIN SYMREF;
      138    12450    1   DCL B$PS1$ PTR SYMREF;
      139    12451    1   DCL B$PS2$ PTR SYMREF;
      140    12452        %KC$CGID (FPTN=KC_HLPID,STCLASS=SYMREF);
      141    12478        %EJECT;
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:5    
      142    12479
      143    12480        /*F* NAME:         KLM$PATHCON
      144    12481             PURPOSE:      To connect a path to the host
      145    12482             ENVIRONMENT:  On behalf of user; master CPU only.
      146    12483             INPUT:        PS1 -  VLR_PATHCON results area
      147    12484                           PS2 -  KL_PCD definition of the path
      148    12485             DESCRIPTION:  Services the M$PATHCON PMME.  Called from
      149    12486                           UDA$PMMENT.
      150    12487
      151    12488                           The issuer of the PMME must be the SLUG
      152    12489                           ghost.
      153    12490        */
      154    12491    1   KLM$PATHCON: ENTRY ALTRET; /* !!Doesn't ALTRET!! */
      155    12492
      156    12493    1         IF S_CUN ~= JG_SLUG# THEN
      157    12494    2           DO;
      158    12495    2   NAUTH:  B$JIT$->B$JIT.ERR=E_NOTAUTH;
      159    12496        /*E* ERROR:   KLM-E$NOTAUTH-A
      160    12497             MESSAGE: Users are not allowed to use M$PATHCON and M$EXHUME
      161    12498             DESCRIPTION: Only SLUG may use M$PATHCON; only ELF may
      162    12499                          use M$EXHUME. */
      163    12500    2           RETURN;
      164    12501    2           END;
      165    12502
      166    12503    1         IF KL$PCD.ADDD.TERMID.TTYP=%KLTY_FEP#
      167    12504    2         THEN DO;
      168    12505    2           LDCT$=NK$LDCT$(KL$PCD.ADDD.LDCTX);
      169    12506    2           IF LDCT$ = ADDR(NIL) OR NK$LDCT.RESCOD ~= NK_LOGON
      170    12507    3           THEN DO;
      171    12508    3             B$JIT$->B$JIT.ERR = E_PCFEPDN;
      172    12509        /*E* ERROR:        KLM-E$PCFEPDN-E
      173    12510             MESSAGE:      The FEP just crashed
      174    12511             DESCRIPTION:  The FEP on which the subject device lives isn't
      175    12512                           up.  Caused by the inevitable timing window in
      176    12513                           SLUG/ELF. */
      177    12514    3             RETURN;
      178    12515    3             END;
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:6    
      179    12516    2           END;
      180    12517    2         ELSE CALL NKL$GETDCT(LDCT$) WHENALTRETURN DO;
      181    12518    2            B$JIT$->B$JIT.ERR=E_PCNLDCT;
      182    12519        /*E* ERROR:        KLM-E$PCNLDCT-E
      183    12520             MESSAGE:      No LDCTs available for connection.
      184    12521             DESCRIPTION:  The connection requires a new LDCT but none are
      185    12522                           available. */
      186    12523    2            RETURN;
      187    12524    2            END;
      188    12525
      189    12526              %LOCK (G=KI_LOCK);
      190    12529    1         IF KI$ROUTE$(KL$PCD.ADDD.FEX)->KI$ROUTE.FEI# = 0     /* No route available */
      191    12530    2         THEN DO;
      192    12531                %UNLOCK (G=KI_LOCK);
      193    12534    2           B$JIT.ERR = E_PCFEPDN;
      194    12535        /*
      195    12536                If this is a fep let kub$ea(IGA_SGNRSP) get rid of the
      196    12537                ldct.
      197    12538        */
      198    12539    2           IF (KL$PCD.ADDD.TERMID.TTYP ~= %KLTY_FEP#) THEN
      199    12540    2            CALL NKL$RELDCT(LDCT$);
      200    12541    2           RETURN;
      201    12542    2           END;
      202    12543    1         VLR$PATHCON.RLCID.NODE=K_NODE#;
      203    12544    1         VLR$PATHCON.RLCID.GENERATION=NK$LDCT.GENERATION;
      204    12545    1         VLR$PATHCON.RLCID.LDCTX=NK$LDCT.LDCTX;
      205    12546
      206    12547    1         NK$LDCT.DFLG.CM='1'B;
      207    12548    1         NK$LDCT.RLCID.NODE=KL$PCD.ADDD.FEX;
      208    12549    1         NK$LDCT.DFLG.INPUT=KL$PCD.ADDD.IO.INPUT;
      209    12550    1         NK$LDCT.DFLG.OUTPUT=KL$PCD.ADDD.IO.OUTPUT;
      210    12551    1         NK$LDCT.DEVNM=KL$PCD.ADDD.DEVNM;
      211    12552    1         NK$LDCT.TERMID = KL$PCD.ADDD.TERMID;
      212    12553    1         NK$LDCT.LOGON_ACCT = KL$PCD.ADDD.ASSOCTRM;
      213    12554    1         CALL SETTCTX(NK$LDCT);
      214    12555    2           DO CASE (KL$PCD.ADDD.ATYP);
      215    12556    2             CASE (%KLAT_TS#);
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:7    
      216    12557    2               NK$LDCT.USER=KL$PCD.ADDD.CINFO.USER;
      217    12558    2               NK$LDCT.RESCOD=NK_TSTRM;
      218    12559    2               NK$LDCT.LKFLG.ACTIVE='1'B;
      219    12560    2             CASE (%KLAT_CG#);
      220    12561    2               IF NK$LDCT.TERMID.TTYP ~= %KLTY_FEP#
      221    12562    2               THEN
      222    12563    2                NK$LDCT.ACCTNG='1'B;
      223    12564    2               NK$LDCT.RESCOD=NK_CGTRM;
      224    12565    2               NK$LDCT.NOCGREJ=KL$PCD.ADDD.NOCGREJ;
      225    12566    2               NK$LDCT.NOCGINF=KL$PCD.ADDD.NOCGINF;
      226    12567                    %UNLOCK (G=KI_LOCK);
      227    12570    2               CALL KCO$TRMCON (LDCT$,KL$PCD.CGID,KL$PCD.CGINFO,ERROR)
      228    12571    3               WHENALTRETURN DO;
      229    12572    3                 B$JIT$->B$JIT.ERR=E_ANY;
      230    12573    3                 B$JIT$->B$JIT.ERR.CODE=ERROR;
      231    12574        /*E* ERROR:        KLM-E$NOCG-E
      232    12575             MESSAGE:      Your comgroup is not currently available
      233    12576             DESCRIPTION:  The comgroup we're trying to connect the thing
      234    12577                           to isn't active. */
      235    12578
      236    12579        /*E* ERROR:        KLM-E$DUPNM-E
      237    12580             MESSAGE:      That station already connected to the comgroup
      238    12581             DESCRIPTION:  The target comgroup already has a connected
      239    12582                           station under the given name.  This error also
      240    12583                           occurs when SLUG tries to connect a %KLAT_TRM#
      241    12584                           and something of the same name is already on
      242    12585                           the NOCG chain. */
      243    12586
      244    12587        /*E* ERROR:        KLM-E$STAILLGL-E
      245    12588             MESSAGE:      That station is illegal for the comgroup
      246    12589             DESCRIPTION:  The target comgroup doesn't allow the use of
      247    12590                           the given station name. */
      248    12591
      249    12592        /*E* ERROR:        KLM-E$CGCXT-E
      250    12593             MESSAGE:      No space in the comgroup to connect
      251    12594             DESCRIPTION:  The comgroup doesn't have space to perform the
      252    12595                           requested connection. */
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:8    
      253    12596
      254    12597        /*E* ERROR:        KLM-E$NTRMSTA-E
      255    12598             MESSAGE:      The comgroup doesn't allow terminals under that name
      256    12599             DESCRIPTION:  The target comgroup doesn't allow terminals to
      257    12600                           connect with the supplied name. */
      258    12601
      259    12602    3                 IF ERROR = %E$NOCG AND NK$LDCT.NOCGREJ='0'B
      260    12603    3                 AND NK$LDCT.TERMID.TTYP ~= %KLTY_PROG#
      261    12604    4                 THEN DO;
      262    12605    4                   NK$LDCT.RESCOD=NK_NOCG;
      263    12606    5                     DO INHIBIT;
      264    12607    5                     NK$LDCT.LNK$=KC_NOCG$;
      265    12608    5                     KC_NOCG$=LDCT$;
      266    12609    5                     END;
      267    12610    4                   IF NK$LDCT.NOCGINF
      268    12611    4                   THEN B$JIT$->B$JIT.ERR.SEV=0;  /* Meaning its OK, just  */
      269    12612                                                            /* tell him.             */
      270    12613    4                   ELSE B$JIT$->B$JIT.ERR='0'B;
      271    12614    4                   END;
      272    12615    3                 END;
      273    12616    2               IF KL$PCD.ADDD.USETP AND
      274    12617    2               B$JIT$->B$JIT.ERR.CODE = %E$NOCG THEN
      275    12618    2                B$JIT$->B$JIT.ERR.CODE = %E$NOTP;
      276    12619
      277    12620        /*E* ERROR:        KLM-E$NOTP-E
      278    12621             MESSAGE:      Your TP instance is not currently running
      279    12622             DESCRIPTION:  The TP instance you we're trying to connect
      280    12623                           to isn't running. */
      281    12624
      282    12625    2               IF KL$PCD.ADDD.USETP AND
      283    12626    2               KL$PCD.CGINFO.WHO.NAME = '*' AND
      284    12627    2               KL$PCD.ADDD.DEVNM ~= ' ' THEN
      285    12628    2                NK$LDCT.LOGON_ACCT = KL$PCD.ADDD.DEVNM;
      286    12629                    %LOCK (G=KI_LOCK);
      287    12632
      288    12633    2             CASE (%KLAT_RES#);
      289    12634    2               NK$LDCT.ACCTNG = '1'B;
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:9    
      290    12635    2               NK$LDCT.RESCOD = NK_RES;
      291    12636    2               CALL FRF$ADDRES(NK$LDCT,KL$PCD);
      292    12637
      293    12638    2             CASE (ELSE);
      294    12639    2               CALL SC_NTRMCN;
      295    12640        /*S*  SCREECH_CODE:  KLM-S$NTRMCN
      296    12641              TYPE:          Screech
      297    12642              MESSAGE:       Bad terminal type passed on M$PATHCON
      298    12643              REMARKS:       KLM$PATHCON is called as a result of an M$PATHCON PMME
      299    12644                             issued by SLUG (HLP).  This screech occurs when the
      300    12645                             information passed claims that the terminal being
      301    12646                             connected is not a terminal at all.  The problem is
      302    12647                             almost certainly in SLUG.                               */
      303    12648    2           END; /* CASE */
      304    12649              %UNLOCK (G=KI_LOCK);
      305    12652    1         IF B$JIT$->B$JIT.ERR.SEV~=0
      306    12653    2         THEN DO;                       /* A real error, not just a warning   */
      307    12654    2           IF NK$LDCT.TERMID.TTYP=%KLTY_FEP#
      308    12655    2           THEN NK$LDCT.RESCOD=NK_LOGON;
      309    12656    2           ELSE CALL NKL$RELDCT(LDCT$);
      310    12657    2           END;
      311    12658    1         ELSE IF NK$LDCT.ACCTNG THEN
      312    12659    2            DO;
      313    12660    2            KL$PCD.ADDD.LDINFO.LDCTX=NK$LDCT.LDCTX;
      314    12661    2            KL$PCD.ADDD.LDINFO.LDCTKEY=0;
      315    12662    2            CALL HFF$DSIZ (B$PS2$,PSIZ);
      316    12663    2            PSIZ=(PSIZ+3)/4;
      317    12664    2   TELLELF: CALL ELA$SYSLOG (EL_CONN,KL$PCD,PSIZ,'0'B,2,LDCT$)
      318    12665    3            WHENALTRETURN DO;
      319    12666    3              CALL SSR$REG (%SS_SL,ADDR(NIL),3);
      320    12667    3              GOTO TELLELF;
      321    12668    3              END;
      322    12669    2            END;
      323    12670    1         RETURN;
      324    12671
      325    12672        %EJECT;
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:10   
      326    12673    1   KLM$SETTCTX: ENTRY;
      327    12674    1         CALL SETTCTX(PARM);
      328    12675    1         RETURN;
      329    12676        %EJECT;
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:11   
      330    12677
      331    12678    1   SETTCTX: PROC(PARM);
      332    12679    2   DCL PARM UBIN;
      333    12680    2         LDCT$ = ADDR(PARM);
      334    12681    2         FEX = NK$LDCT.RLCID.NODE;
      335    12682    2         FEPNM.NAME = 'FEPA00';
      336    12683    2         CALL BINCHAR(FEPNM.NODE,FEX);
      337    12684    3           DO CGX=NK_MXLOCAL+1 TO NK_MXTOTAL;
      338    12685    3           NMLDCT$=NK$LDCT$(CGX);
      339    12686    3           IF NMLDCT$ ~= ADDR(NIL) THEN
      340    12687    4            IF (FEPNM_C = NMLDCT$->NK$LDCT.DEVNM) THEN DO;
      341    12688    4              LDCT$->NK$LDCT.LKFLG.QDPPATH =
      342    12689    4              NMLDCT$->NK$LDCT.LKFLG.QDPPATH;
      343    12690    4              LDCT$->NK$LDCT.TCTX# = NMLDCT$->NK$LDCT.TCTX#;
      344    12691    4              RETURN;
      345    12692    4              END;
      346    12693    3           END;
      347    12694    2         RETURN;  /* DIDN'T FIND ONE */
      348    12695    2   END SETTCTX;
      349    12696
      350    12697        /*F* NAME:         KLM$EXHUME
      351    12698             PURPOSE:      To service the M$EXHUME PMME
      352    12699             ENVIRONMENT:  On behalf of user; master CPU only.
      353    12700             INPUT:        PS1 - EL$RENT contains LDCTX, DEVNM, and AU INFO
      354    12701                           PS2 - KC$CGID the name of the comgroup
      355    12702             DESCRIPTION:  M$EXHUME is used by ELF to cause reconnect
      356    12703                           of a comgroup terminal to its comgroup.
      357    12704                           The device is on the NOCG chain, waiting for
      358    12705                           the comgroup to become available.  ELF has
      359    12706                           been told that it is indeed available, so
      360    12707                           the device will be plucked off the chain
      361    12708                           and attached to the comgroup via KCO$TRMCON.
      362    12709        */
      363    12710    1   KLM$EXHUME: ENTRY ALTRET; /* !!Doesn't ALTRET!! */
      364    12711
      365    12712    1         IF S_CUN ~= JG_ELF# THEN GOTO NAUTH;
      366    12713    2           DO INHIBIT;
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:12   
      367    12714    2           LDCT$=NK$LDCT$(EL$RENT.DKEY.LDX);
      368    12715    2           IF LDCT$=ADDR(NIL) THEN GOTO XIT;
      369    12716    2           IF NK$LDCT.DFLG.OLDSC
      370    12717    2           OR NK$LDCT.DEVNM~=EL$RENT.DKEY.DEVNM
      371    12718    2           OR NK$LDCT.RESCOD~=NK_NOCG THEN GOTO XIT;
      372    12719    2           NK$LDCT.RESCOD=NK_CGTRM;
      373    12720    2           CALL KCF$EXHUME (NK$LDCT);
      374    12721    2           END;
      375    12722    1         CALL KCO$TRMCON (LDCT$,KC$CGID,EL$RENT.CGINF,ERROR)
      376    12723    2         WHENALTRETURN DO;
      377    12724    2           B$JIT$->B$JIT.ERR=E_ANY;
      378    12725    2           B$JIT$->B$JIT.ERR.CODE=ERROR;
      379    12726    3             DO INHIBIT;
      380    12727    4             IF NK$LDCT.DFLG.OLDSC THEN DO;
      381    12728    4               CALL KCD$PREL(NK$LDCT);
      382    12729    4               RETURN;
      383    12730    4               END;
      384    12731    3             NK$LDCT.RESCOD=NK_NOCG;
      385    12732    3             NK$LDCT.LNK$=KC_NOCG$;
      386    12733    3             KC_NOCG$=LDCT$;
      387    12734    4             IF ERROR ~= %E$NOCG THEN DO;
      388    12735    5               IF NK$LDCT.DFLG.LOCAL = '0'B THEN DO;
      389    12736    5                 IF NK$LDCT.NOCGINF
      390    12737    6                 THEN DO;
      391    12738    6                   K$RWPARM = K_RWPARM_CON;
      392    12739    6                   K$RWPARM.MSG$ = ADDR(NCGACM);
      393    12740    6                   K$RWPARM.MSGSZ = LENGTHC(NCGACM);
      394    12741    6                   K$RWPARM.DVE.VFC = 'd';
      395    12742    6                   K$RWPARM.DVE.DVBYTE.VFC = '1'B;
      396    12743    6                   CALL KIA$FCNOU(NK$LDCT,%KV_VDO_FNC_DAT_IMD,K$RWPARM);
      397    12744    6                   END;
      398    12745    5                 IF NK$LDCT.DFLG.OLDSC='0'B
      399    12746    6                 THEN DO;
      400    12747    6                   K$RWPARM = K_RWPARM_CON;
      401    12748    6                   CALL KIA$DSCU(NK$LDCT,%KV_VDO_FNC_DSC_RQS,K$RWPARM) ALTRET(XIT);
      402    12749    6                   END;
      403    12750    5                 END;
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:13   
      404    12751    4               END;
      405    12752    3             END;
      406    12753    2           RETURN;
      407    12754    2           END;
      408    12755    1         CALL KCO$TRMGO (LDCT$);
      409    12756    1         IF NK$LDCT.BKPND~=0 THEN
      410    12757    2           DO;
      411    12758    2           TPASS=NK$LDCT.BKPND;
      412    12759    2           NK$LDCT.BKPND=0;
      413    12760    2           CALL KQP$EVNT (NK$LDCT,TPASS);
      414    12761    2           END;
      415    12762    1   XIT:  RETURN;
      416    12763    1   END KLM$MONHLP;

PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:14   
--  Include file information  --

   K$RWPARM.:E05TOU  is referenced.
   K_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KL_ERRORS_C.:E05TOU  is referenced.
   UM_CP6.:E05TOU  is referenced.
   KC_ERRORS_C.:E05TOU  is referenced.
   KI_ERRORS_C.:E05TOU  is referenced.
   KL_SUBS_C.:E05TOU  is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   KI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   NK_LDCT_R.:E05TOU  cannot be made into a system file and is referenced.
   NK_SUBS.:E05TOU  is referenced.
   KC_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   EL_MACRO_C.:E05TOU  is referenced.
   KC_CP6.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KV$VDO.:E05TOU  is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   UD_SEV_C.:E05TOU  is referenced.
   UD_ERRORS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure KLM$MONHLP.

   Procedure KLM$MONHLP requires 553 words for executable code.
   Procedure KLM$MONHLP requires 60 words of local(AUTO) storage.

    No errors detected in file KLM$MONHLP.:E05TSI    .
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:15   

PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:16   

 Object Unit name= KLM$MONHLP                                 File name= KLM$MONHLP.:E05TOU
 UTS= JUL 30 '97 00:53:14.96 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     21     25  KLM$MONHLP
    1   Proc  even  none   553   1051  KLM$MONHLP
    2  RoData even  none    15     17  KLM$MONHLP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        1  KLM$MONHLP
     1      3          yes     yes      Std        0  KLM$PATHCON
     1    540          yes     yes      Std        0  KLM$SETTCTX
     1    630          yes     yes      Std        0  KLM$EXHUME
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:17   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 NKL$GETDCT
         yes           Std       1 HFC$UNLOCK
 yes     yes           Std       3 SSR$REG
 yes     yes           Std       2 KQP$EVNT
         yes           Std       1 HFC$LOCK
 yes     yes           Std       4 KCO$TRMCON
 yes     yes           Std       2 FRF$ADDRES
         yes           Std       1 KCF$EXHUME
 yes     yes           Std       2 HFF$DSIZ
 yes     yes           Std       1 KCO$TRMGO
 yes     yes           Std       6 ELA$SYSLOG
 yes     yes           Std       3 KIA$FCNOU
 yes     yes           Std       1 NKL$RELDCT
         yes           Std       1 KCD$PREL
 yes     yes           Std       3 KIA$DSCU
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     SC_NTRMCN                             KC_NOCG$                              N$DCT$$
     NK_MXLOCAL                            NK_MXTOTAL                            KI_FEI$$
     KI_ROUTE$$                            KI_LOCK                          r    K_RWPARM_CON
     K_NODE#                               B$JIT$                                S_CUN
     B$PS1$                                B$PS2$                                B_VECTNIL
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:18   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ASLENTSID                             ISSID
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:19   


        1        1        /*M* KLM$MONHLP The monitor part of HOST LOGON */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7       /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8
        9        9        /*P* NAME:         KLM$MONHLP
       10       10             PURPOSE:      To provide the functions of the HOST LOGON
       11       11                           process that must reside in the monitor. */
       12       12
       13       13        KLM$MONHLP: PROC (PARM) ALTRET;

     13  1 000000   000000 700200 xent  KLM$MONHLP   TSX0  ! X66_AUTO_1
         1 000001   000074 000001                    ZERO    60,1
         1 000002   000005 710000 1                  TRA     s:12493

       14       14
       15       15
       16       16
       17       17
       18       18
       19       19        /* INCLUDES */
       20       20
       21       21        %INCLUDE UD_ERRORS_C;
       22       63        %INCLUDE UD_SEV_C;
       23       77        %INCLUDE B$JIT_C;
       24      391        %INCLUDE NK$LDCT;
       25      493        %INCLUDE KC$CGBLK;
       26      541        %INCLUDE KV$VDO;
       27     1556        %INCLUDE KL_MACRO_C;
       28     4908        %INCLUDE KL_AFCN_C;
       29     5009        %INCLUDE KC_CP6;
       30     5569        %INCLUDE EL_MACRO_C;
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:20   
       31     5738        %INCLUDE JG_GHOSTS_C;
       32     5828        %INCLUDE KC_DATA_R;
       33     5841        %INCLUDE NK_SUBS;
       34     5866        %INCLUDE NK_LDCT_R;
       35     5875        %INCLUDE KL_SUPER_C;
       36     8777        %INCLUDE SS_SCHED_C;
       37     9010        %INCLUDE EL_SUBS_C;
       38     9094        %INCLUDE HF_LOCK_C;
       39     9108        %INCLUDE KI_DATA_R;
       40     9134        %INCLUDE KI_MACROS_C;
       41     9742        %INCLUDE KL_SUBS_C;
       42     9796        %INCLUDE KI_ERRORS_C;
       43     9881        %INCLUDE KC_ERRORS_C;
       44     9928        %INCLUDE UM_CP6;
       45    10780        %INCLUDE KL_ERRORS_C;
       46    10822        %INCLUDE K_DATA_R;
       47    11533
       48    11534
       49    11535
       50    11536        /* Equates */
       51    11537        %KV_VDO_E;
       52    11573
       53    11574
       54    11575
       55    11576        /* PARAMETERS */
       56    11577
       57    11578    1   DCL PARM UBIN WORD;
       58    11579
       59    11580
       60    11581
       61    11582
       62    11583        /* MACROS */
       63    11584
       64    11585        %MACRO $ERROR (NAME=GORGO,CODE=0,SEV=SEV_ERROR#);
       65    11586        DCL 1 NAME CONSTANT ALIGNED,
       66    11587              2 * BIT(18) UNAL INIT('131415'O),
       67    11588              2 * UBIN(15) UNAL INIT(CODE),
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:21   
       68    11589              2 * UBIN(3) UNAL INIT(SEV);
       69    11590        %MEND;
       70    11591
       71    11592
       72    11593
       73    11594
       74    11595        /* BASED STRUCTURES */
       75    11596
       76    11597        %B$JIT0;
       77    11686        %A$JIT6X;
       78    11689        %NK$LDCT (STCLASS="BASED(LDCT$)");
       79    11735        %KL_PCD (FPTN=KL$PCD,CG=1,STCLASS="BASED(B$PS2$)");
       80    11900        %EL$RENT (FPTN=EL$RENT,STCLASS="BASED(B$PS1$)",ALIGNED=DALIGNED);
       81    11957        %VLR_PATHCON (FPTN=VLR$PATHCON,STCLASS="BASED(B$PS1$)");
       82    11971        %KC$CGID (FPTN=KC$CGID,STCLASS="BASED(B$PS2$)");
       83    11997        %KI$ROUTE(STCLASS=BASED);
       84    12051    1   DCL KI$ROUTE$(0:0) PTR BASED(KI_ROUTE$$);
       85    12052
       86    12053
       87    12054
       88    12055
       89    12056        /* AUTO */
       90    12057
       91    12058        %K$RWPARM (NAME=K$RWPARM,STCLASS=AUTO);
       92    12374    1   DCL LDCT$ PTR;
       93    12375    1   DCL CGX UBIN WORD;
       94    12376    1   DCL TPASS UBIN WORD;
       95    12377    1   DCL NMLDCT$ REDEF TPASS PTR;
       96    12378    1   DCL 1 FEPNM CALIGNED,
       97    12379    1         2 NAME CHAR(6) CALIGNED,
       98    12380    1         2 NODE CHAR(2) CALIGNED;
       99    12381    1   DCL FEPNM_C REDEF FEPNM CHAR(8);
      100    12382    1   DCL PSIZ UBIN WORD;
      101    12383    1   DCL FEX UBIN WORD;
      102    12384    1   DCL ERROR UBIN;
      103    12385
      104    12386
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:22   
      105    12387
      106    12388        /* CONSTANT */
      107    12389
      108    12390    1  DCL NCGACM CHAR(0) CONSTANT INIT('*** YOUR COMGROUP DOES NOT ACCEPT YOUR LOGON! ***'
             12390            );
      109    12391        %$ERROR (NAME=E_NOTAUTH,CODE=%E$NOTAUTH,SEV=SEV_ABORT#);
      110    12397        %$ERROR (NAME=E_REMCON ,CODE=%E$REMCON ,SEV=SEV_ERROR#);
      111    12403        %$ERROR (NAME=E_ANY    ,CODE=0         ,SEV=SEV_ERROR#);
      112    12409        %$ERROR (NAME=E_PCNLDCT,CODE=%E$PCNLDCT);
      113    12415        %$ERROR (NAME=E_PCFEPDN,CODE=%E$PCFEPDN);
      114    12421        %$ERROR (NAME=E_EXHBDS ,CODE=%E$EXHBDS );
      115    12427
      116    12428
      117    12429
      118    12430
      119    12431        /* REFS */
      120    12432
      121    12433    1   DCL ELA$SYSLOG    ENTRY(6) ALTRET;
      122    12434    1   DCL FRF$ADDRES ENTRY(2) ALTRET;
      123    12435    1   DCL HFF$DSIZ      ENTRY(2) ALTRET;
      124    12436    1   DCL KCD$PREL      ENTRY(1);
      125    12437    1   DCL KCF$EXHUME    ENTRY(1);
      126    12438    1   DCL KCO$TRMCON    ENTRY(4) ALTRET;
      127    12439    1   DCL KCO$TRMGO     ENTRY(1) ALTRET;
      128    12440    1   DCL KIA$FCNOU     ENTRY(3) ALTRET;
      129    12441    1   DCL KIA$DSCU     ENTRY(3) ALTRET;
      130    12442    1   DCL KQP$EVNT      ENTRY(2) ALTRET;
      131    12443    1   DCL NKL$GETDCT    ENTRY(1) ALTRET;
      132    12444    1   DCL NKL$RELDCT    ENTRY(1) ALTRET;
      133    12445    1   DCL SC_NTRMCN     ENTRY    CONV(2,0);
      134    12446    1   DCL SSR$REG       ENTRY(3) ALTRET;
      135    12447
      136    12448    1   DCL B$JIT$ PTR SYMREF;
      137    12449    1   DCL S_CUN UBIN SYMREF;
      138    12450    1   DCL B$PS1$ PTR SYMREF;
      139    12451    1   DCL B$PS2$ PTR SYMREF;
      140    12452        %KC$CGID (FPTN=KC_HLPID,STCLASS=SYMREF);
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:23   
      141    12478        %EJECT;
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:24   
      142    12479
      143    12480        /*F* NAME:         KLM$PATHCON
      144    12481             PURPOSE:      To connect a path to the host
      145    12482             ENVIRONMENT:  On behalf of user; master CPU only.
      146    12483             INPUT:        PS1 -  VLR_PATHCON results area
      147    12484                           PS2 -  KL_PCD definition of the path
      148    12485             DESCRIPTION:  Services the M$PATHCON PMME.  Called from
      149    12486                           UDA$PMMENT.
      150    12487
      151    12488                           The issuer of the PMME must be the SLUG
      152    12489                           ghost.
      153    12490        */
      154    12491    1   KLM$PATHCON: ENTRY ALTRET; /* !!Doesn't ALTRET!! */

  12491  1 000003   000000 700200 xent  KLM$PATHCON  TSX0  ! X66_AUTO_1
         1 000004   000074 000001                    ZERO    60,1

      155    12492
      156    12493    1         IF S_CUN ~= JG_SLUG# THEN

  12493  1 000005   000000 235000 xsym               LDA     S_CUN
         1 000006   000001 115007                    CMPA    1,DL
         1 000007   000014 600000 1                  TZE     s:12503

      157    12494    2           DO;

      158    12495    2   NAUTH:  B$JIT$->B$JIT.ERR=E_NOTAUTH;

  12495  1 000010   000015 236000 0     NAUTH        LDQ     E_NOTAUTH
         1 000011   000000 470400 xsym               LDP0    B$JIT$
         1 000012   000012 756100                    STQ     10,,PR0

      159    12496        /*E* ERROR:   KLM-E$NOTAUTH-A
      160    12497             MESSAGE: Users are not allowed to use M$PATHCON and M$EXHUME
      161    12498             DESCRIPTION: Only SLUG may use M$PATHCON; only ELF may
      162    12499                          use M$EXHUME. */
      163    12500    2           RETURN;
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:25   

  12500  1 000013   000000 702200 xent               TSX2  ! X66_ARET

      164    12501    2           END;
      165    12502
      166    12503    1         IF KL$PCD.ADDD.TERMID.TTYP=%KLTY_FEP#

  12503  1 000014   000000 470400 xsym               LDP0    B$PS2$
         1 000015   000003 236100                    LDQ     3,,PR0
         1 000016   000777 376007                    ANQ     511,DL
         1 000017   000005 116007                    CMPQ    5,DL
         1 000020   000042 601000 1                  TNZ     s:12517

      167    12504    2         THEN DO;

      168    12505    2           LDCT$=NK$LDCT$(KL$PCD.ADDD.LDCTX);

  12505  1 000021   000015 235100                    LDA     13,,PR0
         1 000022   000016 236100                    LDQ     14,,PR0
         1 000023   000022 773000                    LRL     18
         1 000024   000000 471400 xsym               LDP1    N$DCT$$
         1 000025   100000 236106                    LDQ     0,QL,PR1
         1 000026   200054 756100                    STQ     LDCT$,,AUTO

      169    12506    2           IF LDCT$ = ADDR(NIL) OR NK$LDCT.RESCOD ~= NK_LOGON

  12506  1 000027   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000030   000036 600000 1                  TZE     s:12508
         1 000031   200054 473500                    LDP3    LDCT$,,AUTO
         1 000032   300006 236100                    LDQ     6,,PR3
         1 000033   000017 376007                    ANQ     15,DL
         1 000034   000012 116007                    CMPQ    10,DL
         1 000035   000055 600000 1                  TZE     s:12527

      170    12507    3           THEN DO;

      171    12508    3             B$JIT$->B$JIT.ERR = E_PCFEPDN;
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:26   

  12508  1 000036   000021 236000 0                  LDQ     E_PCFEPDN
         1 000037   000000 473400 xsym               LDP3    B$JIT$
         1 000040   300012 756100                    STQ     10,,PR3

      172    12509        /*E* ERROR:        KLM-E$PCFEPDN-E
      173    12510             MESSAGE:      The FEP just crashed
      174    12511             DESCRIPTION:  The FEP on which the subject device lives isn't
      175    12512                           up.  Caused by the inevitable timing window in
      176    12513                           SLUG/ELF. */
      177    12514    3             RETURN;

  12514  1 000041   000000 702200 xent               TSX2  ! X66_ARET

      178    12515    3             END;
      179    12516    2           END;
      180    12517    2         ELSE CALL NKL$GETDCT(LDCT$) WHENALTRETURN DO;

  12517  1 000042   200054 631500                    EPPR1   LDCT$,,AUTO
         1 000043   200066 451500                    STP1    @PARM+1,,AUTO
         1 000044   200066 630500                    EPPR0   @PARM+1,,AUTO
         1 000045   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000046   000000 701000 xent               TSX1    NKL$GETDCT
         1 000047   000051 702000 1                  TSX2    s:12518
         1 000050   000055 710000 1                  TRA     s:12527

      181    12518    2            B$JIT$->B$JIT.ERR=E_PCNLDCT;

  12518  1 000051   000020 236000 0                  LDQ     E_PCNLDCT
         1 000052   000000 470400 xsym               LDP0    B$JIT$
         1 000053   000012 756100                    STQ     10,,PR0

      182    12519        /*E* ERROR:        KLM-E$PCNLDCT-E
      183    12520             MESSAGE:      No LDCTs available for connection.
      184    12521             DESCRIPTION:  The connection requires a new LDCT but none are
      185    12522                           available. */
      186    12523    2            RETURN;
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:27   

  12523  1 000054   000000 702200 xent               TSX2  ! X66_ARET

      187    12524    2            END;
      188    12525
      189    12526              %LOCK (G=KI_LOCK);

  12527  1 000055   000000 630400 2                  EPPR0   0
         1 000056   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000057   000000 701000 xent               TSX1    HFC$LOCK
         1 000060   000000 011000                    NOP     0

      190    12529    1         IF KI$ROUTE$(KL$PCD.ADDD.FEX)->KI$ROUTE.FEI# = 0     /* No route available */

  12529  1 000061   000000 470400 xsym               LDP0    B$PS2$
         1 000062   000000 720100                    LXL0    0,,PR0
         1 000063   000777 360003                    ANX0    511,DU
         1 000064   000000 471400 xsym               LDP1    KI_ROUTE$$
         1 000065   100000 473510                    LDP3    0,X0,PR1
         1 000066   300002 236100                    LDQ     2,,PR3
         1 000067   777000 316003                    CANQ    -512,DU
         1 000070   000114 601000 1                  TNZ     s:12543

      191    12530    2         THEN DO;

      192    12531                %UNLOCK (G=KI_LOCK);

  12532  1 000071   000000 630400 2                  EPPR0   0
         1 000072   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000073   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000074   000000 011000                    NOP     0

      193    12534    2           B$JIT.ERR = E_PCFEPDN;

  12534  1 000075   000021 236000 0                  LDQ     E_PCFEPDN
         1 000076   000000 470400 xsym               LDP0    B$JIT$
         1 000077   000012 756100                    STQ     10,,PR0
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:28   

      194    12535        /*
      195    12536                If this is a fep let kub$ea(IGA_SGNRSP) get rid of the
      196    12537                ldct.
      197    12538        */
      198    12539    2           IF (KL$PCD.ADDD.TERMID.TTYP ~= %KLTY_FEP#) THEN

  12539  1 000100   000000 471400 xsym               LDP1    B$PS2$
         1 000101   100003 236100                    LDQ     3,,PR1
         1 000102   000777 376007                    ANQ     511,DL
         1 000103   000005 116007                    CMPQ    5,DL
         1 000104   000113 600000 1                  TZE     s:12541

      199    12540    2            CALL NKL$RELDCT(LDCT$);

  12540  1 000105   200054 633500                    EPPR3   LDCT$,,AUTO
         1 000106   200066 453500                    STP3    @PARM+1,,AUTO
         1 000107   200066 630500                    EPPR0   @PARM+1,,AUTO
         1 000110   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000111   000000 701000 xent               TSX1    NKL$RELDCT
         1 000112   000000 011000                    NOP     0

      200    12541    2           RETURN;

  12541  1 000113   000000 702200 xent               TSX2  ! X66_ARET

      201    12542    2           END;
      202    12543    1         VLR$PATHCON.RLCID.NODE=K_NODE#;

  12543  1 000114   000000 474400 xsym               LDP4    B$PS1$
         1 000115   000000 236000 xsym               LDQ     K_NODE#
         1 000116   000033 736000                    QLS     27
         1 000117   400000 552140                    STBQ    0,'40'O,PR4

      203    12544    1         VLR$PATHCON.RLCID.GENERATION=NK$LDCT.GENERATION;

  12544  1 000120   200054 470500                    LDP0    LDCT$,,AUTO
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:29   
         1 000121   000000 471400 xsym               LDP1    B$PS1$
         1 000122   000014 236100                    LDQ     12,,PR0
         1 000123   000377 376003                    ANQ     255,DU
         1 000124   100000 552120                    STBQ    0,'20'O,PR1

      204    12545    1         VLR$PATHCON.RLCID.LDCTX=NK$LDCT.LDCTX;

  12545  1 000125   200054 470500                    LDP0    LDCT$,,AUTO
         1 000126   000006 220100                    LDX0    6,,PR0
         1 000127   000000 471400 xsym               LDP1    B$PS1$
         1 000130   100000 440100                    SXL0    0,,PR1

      205    12546
      206    12547    1         NK$LDCT.DFLG.CM='1'B;

  12547  1 000131   200054 470500                    LDP0    LDCT$,,AUTO
         1 000132   100000 236007                    LDQ     32768,DL
         1 000133   000006 256100                    ORSQ    6,,PR0

      207    12548    1         NK$LDCT.RLCID.NODE=KL$PCD.ADDD.FEX;

  12548  1 000134   000000 470400 xsym               LDP0    B$PS2$
         1 000135   200054 471500                    LDP1    LDCT$,,AUTO
         1 000136   000000 236100                    LDQ     0,,PR0
         1 000137   000033 736000                    QLS     27
         1 000140   100015 552140                    STBQ    13,'40'O,PR1

      208    12549    1         NK$LDCT.DFLG.INPUT=KL$PCD.ADDD.IO.INPUT;

  12549  1 000141   200054 471500                    LDP1    LDCT$,,AUTO
         1 000142   000003 236100                    LDQ     3,,PR0
         1 000143   000022 772000                    QRL     18
         1 000144   100006 676100                    ERQ     6,,PR1
         1 000145   400000 376007                    ANQ     -131072,DL
         1 000146   100006 656100                    ERSQ    6,,PR1

      209    12550    1         NK$LDCT.DFLG.OUTPUT=KL$PCD.ADDD.IO.OUTPUT;
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:30   

  12550  1 000147   200054 471500                    LDP1    LDCT$,,AUTO
         1 000150   000003 236100                    LDQ     3,,PR0
         1 000151   000022 772000                    QRL     18
         1 000152   100006 676100                    ERQ     6,,PR1
         1 000153   200000 376007                    ANQ     65536,DL
         1 000154   100006 656100                    ERSQ    6,,PR1

      210    12551    1         NK$LDCT.DEVNM=KL$PCD.ADDD.DEVNM;

  12551  1 000155   200054 471500                    LDP1    LDCT$,,AUTO
         1 000156   040100 100500                    MLR     fill='040'O
         1 000157   000005 400010                    ADSC9   5,,PR0                   cn=2,n=8
         1 000160   100002 000010                    ADSC9   2,,PR1                   cn=0,n=8

      211    12552    1         NK$LDCT.TERMID = KL$PCD.ADDD.TERMID;

  12552  1 000161   200054 471500                    LDP1    LDCT$,,AUTO
         1 000162   000100 100500                    MLR     fill='000'O
         1 000163   000003 400010                    ADSC9   3,,PR0                   cn=2,n=8
         1 000164   100022 000010                    ADSC9   18,,PR1                  cn=0,n=8

      212    12553    1         NK$LDCT.LOGON_ACCT = KL$PCD.ADDD.ASSOCTRM;

  12553  1 000165   200054 471500                    LDP1    LDCT$,,AUTO
         1 000166   040100 100500                    MLR     fill='040'O
         1 000167   000011 400010                    ADSC9   9,,PR0                   cn=2,n=8
         1 000170   100024 000010                    ADSC9   20,,PR1                  cn=0,n=8

      213    12554    1         CALL SETTCTX(NK$LDCT);

  12554  1 000171   200054 236100                    LDQ     LDCT$,,AUTO
         1 000172   200065 756100                    STQ     ERROR+2,,AUTO
         1 000173   000547 701000 1                  TSX1    SETTCTX
         1 000174   000000 011000                    NOP     0

      214    12555    2           DO CASE (KL$PCD.ADDD.ATYP);
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:31   

  12555  1 000175   000000 470400 xsym               LDP0    B$PS2$
         1 000176   000000 220100                    LDX0    0,,PR0
         1 000177   000777 360003                    ANX0    511,DU
         1 000200   000004 100003                    CMPX0   4,DU
         1 000201   000203 602010 1                  TNC     s:12555+6,X0
         1 000202   000423 710000 1                  TRA     s:12639
         1 000203   000423 710000 1                  TRA     s:12639
         1 000204   000207 710000 1                  TRA     s:12557
         1 000205   000224 710000 1                  TRA     s:12561
         1 000206   000403 710000 1                  TRA     s:12634

      215    12556    2             CASE (%KLAT_TS#);

      216    12557    2               NK$LDCT.USER=KL$PCD.ADDD.CINFO.USER;

  12557  1 000207   200054 471500                    LDP1    LDCT$,,AUTO
         1 000210   000014 236100                    LDQ     12,,PR0
         1 000211   000011 736000                    QLS     9
         1 000212   100007 552120                    STBQ    7,'20'O,PR1

      217    12558    2               NK$LDCT.RESCOD=NK_TSTRM;

  12558  1 000213   200054 471500                    LDP1    LDCT$,,AUTO
         1 000214   100006 236100                    LDQ     6,,PR1
         1 000215   000001 376000 2                  ANQ     1
         1 000216   000001 276007                    ORQ     1,DL
         1 000217   100006 756100                    STQ     6,,PR1

      218    12559    2               NK$LDCT.LKFLG.ACTIVE='1'B;

  12559  1 000220   200054 471500                    LDP1    LDCT$,,AUTO
         1 000221   000040 236003                    LDQ     32,DU
         1 000222   100011 256100                    ORSQ    9,,PR1
         1 000223   000425 710000 1                  TRA     s:12650

      219    12560    2             CASE (%KLAT_CG#);
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:32   

      220    12561    2               IF NK$LDCT.TERMID.TTYP ~= %KLTY_FEP#

  12561  1 000224   200054 471500                    LDP1    LDCT$,,AUTO
         1 000225   100022 236100                    LDQ     18,,PR1
         1 000226   000777 376003                    ANQ     511,DU
         1 000227   000005 116003                    CMPQ    5,DU
         1 000230   000233 600000 1                  TZE     s:12564

      221    12562    2               THEN
      222    12563    2                NK$LDCT.ACCTNG='1'B;

  12563  1 000231   001000 236003                    LDQ     512,DU
         1 000232   100007 256100                    ORSQ    7,,PR1

      223    12564    2               NK$LDCT.RESCOD=NK_CGTRM;

  12564  1 000233   200054 471500                    LDP1    LDCT$,,AUTO
         1 000234   100006 236100                    LDQ     6,,PR1
         1 000235   000001 376000 2                  ANQ     1
         1 000236   000002 276007                    ORQ     2,DL
         1 000237   100006 756100                    STQ     6,,PR1

      224    12565    2               NK$LDCT.NOCGREJ=KL$PCD.ADDD.NOCGREJ;

  12565  1 000240   200054 471500                    LDP1    LDCT$,,AUTO
         1 000241   000003 236100                    LDQ     3,,PR0
         1 000242   000001 736000                    QLS     1
         1 000243   100007 676100                    ERQ     7,,PR1
         1 000244   004000 376003                    ANQ     2048,DU
         1 000245   100007 656100                    ERSQ    7,,PR1

      225    12566    2               NK$LDCT.NOCGINF=KL$PCD.ADDD.NOCGINF;

  12566  1 000246   200054 471500                    LDP1    LDCT$,,AUTO
         1 000247   000003 236100                    LDQ     3,,PR0
         1 000250   000001 736000                    QLS     1
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:33   
         1 000251   100007 676100                    ERQ     7,,PR1
         1 000252   002000 376003                    ANQ     1024,DU
         1 000253   100007 656100                    ERSQ    7,,PR1

      226    12567                    %UNLOCK (G=KI_LOCK);

  12568  1 000254   000000 630400 2                  EPPR0   0
         1 000255   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000256   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000257   000000 011000                    NOP     0

      227    12570    2               CALL KCO$TRMCON (LDCT$,KL$PCD.CGID,KL$PCD.CGINFO,ERROR)

  12570  1 000260   200063 630500                    EPPR0   ERROR,,AUTO
         1 000261   200071 450500                    STP0    @PARM+4,,AUTO
         1 000262   000000 236000 xsym               LDQ     B$PS2$
         1 000263   000033 036003                    ADLQ    27,DU
         1 000264   200070 756100                    STQ     @PARM+3,,AUTO
         1 000265   000000 236000 xsym               LDQ     B$PS2$
         1 000266   000017 036003                    ADLQ    15,DU
         1 000267   200067 756100                    STQ     @PARM+2,,AUTO
         1 000270   200054 631500                    EPPR1   LDCT$,,AUTO
         1 000271   200066 451500                    STP1    @PARM+1,,AUTO
         1 000272   200066 630500                    EPPR0   @PARM+1,,AUTO
         1 000273   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000274   000000 701000 xent               TSX1    KCO$TRMCON
         1 000275   000277 702000 1                  TSX2    s:12572
         1 000276   000342 710000 1                  TRA     s:12616

      228    12571    3               WHENALTRETURN DO;

      229    12572    3                 B$JIT$->B$JIT.ERR=E_ANY;

  12572  1 000277   000017 236000 0                  LDQ     E_ANY
         1 000300   000000 470400 xsym               LDP0    B$JIT$
         1 000301   000012 756100                    STQ     10,,PR0

PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:34   
      230    12573    3                 B$JIT$->B$JIT.ERR.CODE=ERROR;

  12573  1 000302   200063 236100                    LDQ     ERROR,,AUTO
         1 000303   000003 736000                    QLS     3
         1 000304   000012 676100                    ERQ     10,,PR0
         1 000305   377770 376007                    ANQ     131064,DL
         1 000306   000012 656100                    ERSQ    10,,PR0

      231    12574        /*E* ERROR:        KLM-E$NOCG-E
      232    12575             MESSAGE:      Your comgroup is not currently available
      233    12576             DESCRIPTION:  The comgroup we're trying to connect the thing
      234    12577                           to isn't active. */
      235    12578
      236    12579        /*E* ERROR:        KLM-E$DUPNM-E
      237    12580             MESSAGE:      That station already connected to the comgroup
      238    12581             DESCRIPTION:  The target comgroup already has a connected
      239    12582                           station under the given name.  This error also
      240    12583                           occurs when SLUG tries to connect a %KLAT_TRM#
      241    12584                           and something of the same name is already on
      242    12585                           the NOCG chain. */
      243    12586
      244    12587        /*E* ERROR:        KLM-E$STAILLGL-E
      245    12588             MESSAGE:      That station is illegal for the comgroup
      246    12589             DESCRIPTION:  The target comgroup doesn't allow the use of
      247    12590                           the given station name. */
      248    12591
      249    12592        /*E* ERROR:        KLM-E$CGCXT-E
      250    12593             MESSAGE:      No space in the comgroup to connect
      251    12594             DESCRIPTION:  The comgroup doesn't have space to perform the
      252    12595                           requested connection. */
      253    12596
      254    12597        /*E* ERROR:        KLM-E$NTRMSTA-E
      255    12598             MESSAGE:      The comgroup doesn't allow terminals under that name
      256    12599             DESCRIPTION:  The target comgroup doesn't allow terminals to
      257    12600                           connect with the supplied name. */
      258    12601
      259    12602    3                 IF ERROR = %E$NOCG AND NK$LDCT.NOCGREJ='0'B
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:35   

  12602  1 000307   200063 235100                    LDA     ERROR,,AUTO
         1 000310   001540 115007                    CMPA    864,DL
         1 000311   000342 601000 1                  TNZ     s:12616
         1 000312   200054 471500                    LDP1    LDCT$,,AUTO
         1 000313   100007 236100                    LDQ     7,,PR1
         1 000314   004000 316003                    CANQ    2048,DU
         1 000315   000342 601000 1                  TNZ     s:12616
         1 000316   100022 236100                    LDQ     18,,PR1
         1 000317   000777 316003                    CANQ    511,DU
         1 000320   000342 600000 1                  TZE     s:12616

      260    12603    3                 AND NK$LDCT.TERMID.TTYP ~= %KLTY_PROG#
      261    12604    4                 THEN DO;

      262    12605    4                   NK$LDCT.RESCOD=NK_NOCG;

  12605  1 000321   100006 236100                    LDQ     6,,PR1
         1 000322   000001 376000 2                  ANQ     1
         1 000323   000006 276007                    ORQ     6,DL
         1 000324   100006 756100                    STQ     6,,PR1

      263    12606    5                     DO INHIBIT;

      264    12607    5                     NK$LDCT.LNK$=KC_NOCG$;

  12607  1 000325   000000 236200 xsym               LDQ   ! KC_NOCG$
         1 000326   200054 471700                    LDP1  ! LDCT$,,AUTO
         1 000327   100004 756300                    STQ   ! 4,,PR1

      265    12608    5                     KC_NOCG$=LDCT$;

  12608  1 000330   200054 236300                    LDQ   ! LDCT$,,AUTO
         1 000331   000000 756200 xsym               STQ   ! KC_NOCG$

      266    12609    5                     END;

PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:36   
      267    12610    4                   IF NK$LDCT.NOCGINF

  12610  1 000332   200054 471500                    LDP1    LDCT$,,AUTO
         1 000333   100007 236100                    LDQ     7,,PR1
         1 000334   002000 316003                    CANQ    1024,DU
         1 000335   000341 600000 1                  TZE     s:12613

      268    12611    4                   THEN B$JIT$->B$JIT.ERR.SEV=0;  /* Meaning its OK, just  */

  12611  1 000336   000002 236000 2                  LDQ     2
         1 000337   000012 356100                    ANSQ    10,,PR0
         1 000340   000342 710000 1                  TRA     s:12616

      269    12612                                                            /* tell him.             */
      270    12613    4                   ELSE B$JIT$->B$JIT.ERR='0'B;

  12613  1 000341   000012 450100                    STZ     10,,PR0

      271    12614    4                   END;

      272    12615    3                 END;

      273    12616    2               IF KL$PCD.ADDD.USETP AND

  12616  1 000342   000000 470400 xsym               LDP0    B$PS2$
         1 000343   000003 236100                    LDQ     3,,PR0
         1 000344   004000 316003                    CANQ    2048,DU
         1 000345   000357 600000 1                  TZE     s:12625
         1 000346   000000 471400 xsym               LDP1    B$JIT$
         1 000347   100012 236100                    LDQ     10,,PR1
         1 000350   377770 376007                    ANQ     131064,DL
         1 000351   015400 116007                    CMPQ    6912,DL
         1 000352   000357 601000 1                  TNZ     s:12625

      274    12617    2               B$JIT$->B$JIT.ERR.CODE = %E$NOCG THEN
      275    12618    2                B$JIT$->B$JIT.ERR.CODE = %E$NOTP;

PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:37   
  12618  1 000353   100012 236100                    LDQ     10,,PR1
         1 000354   000003 376000 2                  ANQ     3
         1 000355   016030 276007                    ORQ     7192,DL
         1 000356   100012 756100                    STQ     10,,PR1

      276    12619
      277    12620        /*E* ERROR:        KLM-E$NOTP-E
      278    12621             MESSAGE:      Your TP instance is not currently running
      279    12622             DESCRIPTION:  The TP instance you we're trying to connect
      280    12623                           to isn't running. */
      281    12624
      282    12625    2               IF KL$PCD.ADDD.USETP AND

  12625  1 000357   000003 236100                    LDQ     3,,PR0
         1 000360   004000 316003                    CANQ    2048,DU
         1 000361   000376 600000 1                  TZE     s:12630
         1 000362   040000 106500                    CMPC    fill='040'O
         1 000363   000040 000014                    ADSC9   32,,PR0                  cn=0,n=12
         1 000364   000004 000001 2                  ADSC9   4                        cn=0,n=1
         1 000365   000376 601000 1                  TNZ     s:12630
         1 000366   040000 106500                    CMPC    fill='040'O
         1 000367   000005 400010                    ADSC9   5,,PR0                   cn=2,n=8
         1 000370   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000371   000376 600000 1                  TZE     s:12630

      283    12626    2               KL$PCD.CGINFO.WHO.NAME = '*' AND
      284    12627    2               KL$PCD.ADDD.DEVNM ~= ' ' THEN
      285    12628    2                NK$LDCT.LOGON_ACCT = KL$PCD.ADDD.DEVNM;

  12628  1 000372   200054 471500                    LDP1    LDCT$,,AUTO
         1 000373   040100 100500                    MLR     fill='040'O
         1 000374   000005 400010                    ADSC9   5,,PR0                   cn=2,n=8
         1 000375   100024 000010                    ADSC9   20,,PR1                  cn=0,n=8

      286    12629                    %LOCK (G=KI_LOCK);

  12630  1 000376   000000 630400 2                  EPPR0   0
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:38   
         1 000377   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000400   000000 701000 xent               TSX1    HFC$LOCK
         1 000401   000000 011000                    NOP     0
         1 000402   000425 710000 1                  TRA     s:12650

      287    12632
      288    12633    2             CASE (%KLAT_RES#);

      289    12634    2               NK$LDCT.ACCTNG = '1'B;

  12634  1 000403   200054 471500                    LDP1    LDCT$,,AUTO
         1 000404   001000 236003                    LDQ     512,DU
         1 000405   100007 256100                    ORSQ    7,,PR1

      290    12635    2               NK$LDCT.RESCOD = NK_RES;

  12635  1 000406   200054 471500                    LDP1    LDCT$,,AUTO
         1 000407   100006 236100                    LDQ     6,,PR1
         1 000410   000001 376000 2                  ANQ     1
         1 000411   000013 276007                    ORQ     11,DL
         1 000412   100006 756100                    STQ     6,,PR1

      291    12636    2               CALL FRF$ADDRES(NK$LDCT,KL$PCD);

  12636  1 000413   000000 236000 xsym               LDQ     B$PS2$
         1 000414   200054 235100                    LDA     LDCT$,,AUTO
         1 000415   200066 757100                    STAQ    @PARM+1,,AUTO
         1 000416   200066 630500                    EPPR0   @PARM+1,,AUTO
         1 000417   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000420   000000 701000 xent               TSX1    FRF$ADDRES
         1 000421   000000 011000                    NOP     0
         1 000422   000425 710000 1                  TRA     s:12650

      292    12637
      293    12638    2             CASE (ELSE);

      294    12639    2               CALL SC_NTRMCN;
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:39   

  12639  1 000423   000000 713400 xsym               CLIMB   SC_NTRMCN
         1 000424   000000 600000 xsid               climb   nvectors=         0

      295    12640        /*S*  SCREECH_CODE:  KLM-S$NTRMCN
      296    12641              TYPE:          Screech
      297    12642              MESSAGE:       Bad terminal type passed on M$PATHCON
      298    12643              REMARKS:       KLM$PATHCON is called as a result of an M$PATHCON PMME
      299    12644                             issued by SLUG (HLP).  This screech occurs when the
      300    12645                             information passed claims that the terminal being
      301    12646                             connected is not a terminal at all.  The problem is
      302    12647                             almost certainly in SLUG.                               */
      303    12648    2           END; /* CASE */

      304    12649              %UNLOCK (G=KI_LOCK);

  12650  1 000425   000000 630400 2                  EPPR0   0
         1 000426   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000427   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000430   000000 011000                    NOP     0

      305    12652    1         IF B$JIT$->B$JIT.ERR.SEV~=0

  12652  1 000431   000000 470400 xsym               LDP0    B$JIT$
         1 000432   000012 236100                    LDQ     10,,PR0
         1 000433   000007 316007                    CANQ    7,DL
         1 000434   000456 600000 1                  TZE     s:12658

      306    12653    2         THEN DO;                       /* A real error, not just a warning   */

      307    12654    2           IF NK$LDCT.TERMID.TTYP=%KLTY_FEP#

  12654  1 000435   200054 471500                    LDP1    LDCT$,,AUTO
         1 000436   100022 236100                    LDQ     18,,PR1
         1 000437   000777 376003                    ANQ     511,DU
         1 000440   000005 116003                    CMPQ    5,DU
         1 000441   000447 601000 1                  TNZ     s:12656
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:40   

      308    12655    2           THEN NK$LDCT.RESCOD=NK_LOGON;

  12655  1 000442   100006 236100                    LDQ     6,,PR1
         1 000443   000001 376000 2                  ANQ     1
         1 000444   000012 276007                    ORQ     10,DL
         1 000445   100006 756100                    STQ     6,,PR1
         1 000446   000537 710000 1                  TRA     s:12670

      309    12656    2           ELSE CALL NKL$RELDCT(LDCT$);

  12656  1 000447   200054 633500                    EPPR3   LDCT$,,AUTO
         1 000450   200066 453500                    STP3    @PARM+1,,AUTO
         1 000451   200066 630500                    EPPR0   @PARM+1,,AUTO
         1 000452   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000453   000000 701000 xent               TSX1    NKL$RELDCT
         1 000454   000000 011000                    NOP     0

      310    12657    2           END;

  12657  1 000455   000537 710000 1                  TRA     s:12670

      311    12658    1         ELSE IF NK$LDCT.ACCTNG THEN

  12658  1 000456   200054 471500                    LDP1    LDCT$,,AUTO
         1 000457   100007 430100                    FSZN    7,,PR1
         1 000460   000537 605000 1                  TPL     s:12670

      312    12659    2            DO;

      313    12660    2            KL$PCD.ADDD.LDINFO.LDCTX=NK$LDCT.LDCTX;

  12660  1 000461   100006 220100                    LDX0    6,,PR1
         1 000462   000000 473400 xsym               LDP3    B$PS2$
         1 000463   300014 440100                    SXL0    12,,PR3

      314    12661    2            KL$PCD.ADDD.LDINFO.LDCTKEY=0;
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:41   

  12661  1 000464   000000 221003                    LDX1    0,DU
         1 000465   300015 741100                    STX1    13,,PR3

      315    12662    2            CALL HFF$DSIZ (B$PS2$,PSIZ);

  12662  1 000466   200061 631500                    EPPR1   PSIZ,,AUTO
         1 000467   200067 451500                    STP1    @PARM+2,,AUTO
         1 000470   000005 236000 2                  LDQ     5
         1 000471   200066 756100                    STQ     @PARM+1,,AUTO
         1 000472   200066 630500                    EPPR0   @PARM+1,,AUTO
         1 000473   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000474   000000 701000 xent               TSX1    HFF$DSIZ
         1 000475   000000 011000                    NOP     0

      316    12663    2            PSIZ=(PSIZ+3)/4;

  12663  1 000476   200061 236100                    LDQ     PSIZ,,AUTO
         1 000477   000003 036007                    ADLQ    3,DL
         1 000500   000002 772000                    QRL     2
         1 000501   200061 756100                    STQ     PSIZ,,AUTO

      317    12664    2   TELLELF: CALL ELA$SYSLOG (EL_CONN,KL$PCD,PSIZ,'0'B,2,LDCT$)

  12664  1 000502   200054 630500       TELLELF      EPPR0   LDCT$,,AUTO
         1 000503   200073 450500                    STP0    @PARM+6,,AUTO
         1 000504   000006 236000 2                  LDQ     6
         1 000505   200072 756100                    STQ     @PARM+5,,AUTO
         1 000506   000007 236000 2                  LDQ     7
         1 000507   200071 756100                    STQ     @PARM+4,,AUTO
         1 000510   200061 631500                    EPPR1   PSIZ,,AUTO
         1 000511   200070 451500                    STP1    @PARM+3,,AUTO
         1 000512   000000 236000 xsym               LDQ     B$PS2$
         1 000513   000010 235000 2                  LDA     8
         1 000514   200066 757100                    STAQ    @PARM+1,,AUTO
         1 000515   200066 630500                    EPPR0   @PARM+1,,AUTO
         1 000516   000024 631400 xsym               EPPR1   B_VECTNIL+20
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:42   
         1 000517   000000 701000 xent               TSX1    ELA$SYSLOG
         1 000520   000522 702000 1                  TSX2    s:12666
         1 000521   000537 710000 1                  TRA     s:12670

      318    12665    3            WHENALTRETURN DO;

      319    12666    3              CALL SSR$REG (%SS_SL,ADDR(NIL),3);

  12666  1 000522   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000523   200066 756100                    STQ     @PARM+1,,AUTO
         1 000524   000012 236000 2                  LDQ     10
         1 000525   200071 756100                    STQ     @PARM+4,,AUTO
         1 000526   200066 630500                    EPPR0   @PARM+1,,AUTO
         1 000527   200070 450500                    STP0    @PARM+3,,AUTO
         1 000530   000013 236000 2                  LDQ     11
         1 000531   200067 756100                    STQ     @PARM+2,,AUTO
         1 000532   200067 630500                    EPPR0   @PARM+2,,AUTO
         1 000533   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000534   000000 701000 xent               TSX1    SSR$REG
         1 000535   000000 011000                    NOP     0

      320    12667    3              GOTO TELLELF;

  12667  1 000536   000502 710000 1                  TRA     TELLELF

      321    12668    3              END;
      322    12669    2            END;

      323    12670    1         RETURN;

  12670  1 000537   000000 702200 xent               TSX2  ! X66_ARET

      324    12671
      325    12672        %EJECT;
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:43   
      326    12673    1   KLM$SETTCTX: ENTRY;

  12673  1 000540   000000 700200 xent  KLM$SETTCTX  TSX0  ! X66_AUTO_1
         1 000541   000074 000001                    ZERO    60,1

      327    12674    1         CALL SETTCTX(PARM);

  12674  1 000542   200003 236100                    LDQ     @PARM,,AUTO
         1 000543   200065 756100                    STQ     ERROR+2,,AUTO
         1 000544   000547 701000 1                  TSX1    SETTCTX
         1 000545   000000 011000                    NOP     0

      328    12675    1         RETURN;

  12675  1 000546   000000 702200 xent               TSX2  ! X66_ARET

      329    12676        %EJECT;
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:44   
      330    12677
      331    12678    1   SETTCTX: PROC(PARM);

  12678  1 000547   200064 741300       SETTCTX      STX1  ! ERROR+1,,AUTO

      332    12679    2   DCL PARM UBIN;
      333    12680    2         LDCT$ = ADDR(PARM);

  12680  1 000550   200065 236100                    LDQ     @PARM,,AUTO
         1 000551   200054 756100                    STQ     LDCT$,,AUTO

      334    12681    2         FEX = NK$LDCT.RLCID.NODE;

  12681  1 000552   200054 470500                    LDP0    LDCT$,,AUTO
         1 000553   000015 236100                    LDQ     13,,PR0
         1 000554   000033 772000                    QRL     27
         1 000555   200062 756100                    STQ     FEX,,AUTO

      335    12682    2         FEPNM.NAME = 'FEPA00';

  12682  1 000556   040100 100400                    MLR     fill='040'O
         1 000557   000023 000006 0                  ADSC9   E_PCFEPDN+2              cn=0,n=6
         1 000560   200057 000006                    ADSC9   FEPNM,,AUTO              cn=0,n=6

      336    12683    2         CALL BINCHAR(FEPNM.NODE,FEX);

  12683  1 000561   000000 235003                    LDA     0,DU
         1 000562   200066 757100                    STAQ    @PARM+1,,AUTO
         1 000563   000100 301500                    BTD
         1 000564   200066 000010                    NDSC9   @PARM+1,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         1 000565   200060 430002                    NDSC9   FEPNM+1,,AUTO            cn=2,s=nosgn,sf=0,n=2

      337    12684    3           DO CGX=NK_MXLOCAL+1 TO NK_MXTOTAL;

  12684  1 000566   000000 236000 xsym               LDQ     NK_MXLOCAL
         1 000567   000001 036007                    ADLQ    1,DL
         1 000570   200055 756100                    STQ     CGX,,AUTO
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:45   
         1 000571   000623 710000 1                  TRA     s:12693+3

      338    12685    3           NMLDCT$=NK$LDCT$(CGX);

  12685  1 000572   000000 470400 xsym               LDP0    N$DCT$$
         1 000573   200055 720100                    LXL0    CGX,,AUTO
         1 000574   000000 236110                    LDQ     0,X0,PR0
         1 000575   200056 756100                    STQ     TPASS,,AUTO

      339    12686    3           IF NMLDCT$ ~= ADDR(NIL) THEN

  12686  1 000576   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000577   000620 600000 1                  TZE     s:12693

      340    12687    4            IF (FEPNM_C = NMLDCT$->NK$LDCT.DEVNM) THEN DO;

  12687  1 000600   200056 471500                    LDP1    TPASS,,AUTO
         1 000601   040100 106500                    CMPC    fill='040'O
         1 000602   200057 000010                    ADSC9   FEPNM,,AUTO              cn=0,n=8
         1 000603   100002 000010                    ADSC9   2,,PR1                   cn=0,n=8
         1 000604   000620 601000 1                  TNZ     s:12693

      341    12688    4              LDCT$->NK$LDCT.LKFLG.QDPPATH =

  12688  1 000605   200054 473500                    LDP3    LDCT$,,AUTO
         1 000606   100011 236100                    LDQ     9,,PR1
         1 000607   300011 676100                    ERQ     9,,PR3
         1 000610   002000 376003                    ANQ     1024,DU
         1 000611   300011 656100                    ERSQ    9,,PR3

      342    12689    4              NMLDCT$->NK$LDCT.LKFLG.QDPPATH;
      343    12690    4              LDCT$->NK$LDCT.TCTX# = NMLDCT$->NK$LDCT.TCTX#;

  12690  1 000612   200056 471500                    LDP1    TPASS,,AUTO
         1 000613   100007 721100                    LXL1    7,,PR1
         1 000614   200054 473500                    LDP3    LDCT$,,AUTO
         1 000615   300007 441100                    SXL1    7,,PR3
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:46   

      344    12691    4              RETURN;

  12691  1 000616   200064 221300                    LDX1  ! ERROR+1,,AUTO
         1 000617   000001 702211                    TSX2  ! 1,X1

      345    12692    4              END;
      346    12693    3           END;

  12693  1 000620   200055 235100                    LDA     CGX,,AUTO
         1 000621   000001 035007                    ADLA    1,DL
         1 000622   200055 755100                    STA     CGX,,AUTO
         1 000623   000000 236000 xsym               LDQ     NK_MXTOTAL
         1 000624   200055 116100                    CMPQ    CGX,,AUTO
         1 000625   000572 603000 1                  TRC     s:12685

      347    12694    2         RETURN;  /* DIDN'T FIND ONE */

  12694  1 000626   200064 221300                    LDX1  ! ERROR+1,,AUTO
         1 000627   000001 702211                    TSX2  ! 1,X1

      348    12695    2   END SETTCTX;
      349    12696
      350    12697        /*F* NAME:         KLM$EXHUME
      351    12698             PURPOSE:      To service the M$EXHUME PMME
      352    12699             ENVIRONMENT:  On behalf of user; master CPU only.
      353    12700             INPUT:        PS1 - EL$RENT contains LDCTX, DEVNM, and AU INFO
      354    12701                           PS2 - KC$CGID the name of the comgroup
      355    12702             DESCRIPTION:  M$EXHUME is used by ELF to cause reconnect
      356    12703                           of a comgroup terminal to its comgroup.
      357    12704                           The device is on the NOCG chain, waiting for
      358    12705                           the comgroup to become available.  ELF has
      359    12706                           been told that it is indeed available, so
      360    12707                           the device will be plucked off the chain
      361    12708                           and attached to the comgroup via KCO$TRMCON.
      362    12709        */
      363    12710    1   KLM$EXHUME: ENTRY ALTRET; /* !!Doesn't ALTRET!! */
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:47   

  12710  1 000630   000000 700200 xent  KLM$EXHUME   TSX0  ! X66_AUTO_1
         1 000631   000074 000001                    ZERO    60,1

      364    12711
      365    12712    1         IF S_CUN ~= JG_ELF# THEN GOTO NAUTH;

  12712  1 000632   000000 235000 xsym               LDA     S_CUN
         1 000633   000006 115007                    CMPA    6,DL
         1 000634   000010 601000 1                  TNZ     NAUTH

      366    12713    2           DO INHIBIT;

      367    12714    2           LDCT$=NK$LDCT$(EL$RENT.DKEY.LDX);

  12714  1 000635   000000 470600 xsym               LDP0  ! B$PS1$
         1 000636   000002 235300                    LDA   ! 2,,PR0
         1 000637   000003 236300                    LDQ   ! 3,,PR0
         1 000640   000033 773200                    LRL   ! 27
         1 000641   777777 376207                    ANQ   ! -1,DL
         1 000642   000000 471600 xsym               LDP1  ! N$DCT$$
         1 000643   100000 236306                    LDQ   ! 0,QL,PR1
         1 000644   200054 756300                    STQ   ! LDCT$,,AUTO

      368    12715    2           IF LDCT$=ADDR(NIL) THEN GOTO XIT;

  12715  1 000645   000001 116200 xsym               CMPQ  ! B_VECTNIL+1
         1 000646   001050 600200 1                  TZE   ! XIT

      369    12716    2           IF NK$LDCT.DFLG.OLDSC

  12716  1 000647   200054 473700                    LDP3  ! LDCT$,,AUTO
         1 000650   300006 236300                    LDQ   ! 6,,PR3
         1 000651   010000 316207                    CANQ  ! 4096,DL
         1 000652   001050 601200 1                  TNZ   ! XIT
         1 000653   040100 106700                    CMPC  ! fill='040'O
         1 000654   300002 000010                    ADSC9   2,,PR3                   cn=0,n=8
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:48   
         1 000655   000000 600010                    ADSC9   0,,PR0                   cn=3,n=8
         1 000656   001050 601200 1                  TNZ   ! XIT
         1 000657   300006 236300                    LDQ   ! 6,,PR3
         1 000660   000017 376207                    ANQ   ! 15,DL
         1 000661   000006 116207                    CMPQ  ! 6,DL
         1 000662   001050 601200 1                  TNZ   ! XIT

      370    12717    2           OR NK$LDCT.DEVNM~=EL$RENT.DKEY.DEVNM
      371    12718    2           OR NK$LDCT.RESCOD~=NK_NOCG THEN GOTO XIT;
      372    12719    2           NK$LDCT.RESCOD=NK_CGTRM;

  12719  1 000663   300006 236300                    LDQ   ! 6,,PR3
         1 000664   000001 376200 2                  ANQ   ! 1
         1 000665   000002 276207                    ORQ   ! 2,DL
         1 000666   300006 756300                    STQ   ! 6,,PR3

      373    12720    2           CALL KCF$EXHUME (NK$LDCT);

  12720  1 000667   200054 630700                    EPPR0 ! LDCT$,,AUTO
         1 000670   000017 631600 xsym               EPPR1 ! B_VECTNIL+15
         1 000671   000000 701200 xent               TSX1  ! KCF$EXHUME
         1 000672   000000 011200                    NOP   ! 0

      374    12721    2           END;

      375    12722    1         CALL KCO$TRMCON (LDCT$,KC$CGID,EL$RENT.CGINF,ERROR)

  12722  1 000673   200063 630500                    EPPR0   ERROR,,AUTO
         1 000674   200071 450500                    STP0    @PARM+4,,AUTO
         1 000675   000000 236000 xsym               LDQ     B$PS1$
         1 000676   000004 036003                    ADLQ    4,DU
         1 000677   200070 756100                    STQ     @PARM+3,,AUTO
         1 000700   000000 236000 xsym               LDQ     B$PS2$
         1 000701   200067 756100                    STQ     @PARM+2,,AUTO
         1 000702   200054 631500                    EPPR1   LDCT$,,AUTO
         1 000703   200066 451500                    STP1    @PARM+1,,AUTO
         1 000704   200066 630500                    EPPR0   @PARM+1,,AUTO
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:49   
         1 000705   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000706   000000 701000 xent               TSX1    KCO$TRMCON
         1 000707   000711 702000 1                  TSX2    s:12724
         1 000710   001021 710000 1                  TRA     s:12755

      376    12723    2         WHENALTRETURN DO;

      377    12724    2           B$JIT$->B$JIT.ERR=E_ANY;

  12724  1 000711   000017 236000 0                  LDQ     E_ANY
         1 000712   000000 470400 xsym               LDP0    B$JIT$
         1 000713   000012 756100                    STQ     10,,PR0

      378    12725    2           B$JIT$->B$JIT.ERR.CODE=ERROR;

  12725  1 000714   200063 236100                    LDQ     ERROR,,AUTO
         1 000715   000003 736000                    QLS     3
         1 000716   000012 676100                    ERQ     10,,PR0
         1 000717   377770 376007                    ANQ     131064,DL
         1 000720   000012 656100                    ERSQ    10,,PR0

      379    12726    3             DO INHIBIT;

      380    12727    4             IF NK$LDCT.DFLG.OLDSC THEN DO;

  12727  1 000721   200054 471700                    LDP1  ! LDCT$,,AUTO
         1 000722   100006 236300                    LDQ   ! 6,,PR1
         1 000723   010000 316207                    CANQ  ! 4096,DL
         1 000724   000732 600200 1                  TZE   ! s:12731

      381    12728    4               CALL KCD$PREL(NK$LDCT);

  12728  1 000725   200054 630700                    EPPR0 ! LDCT$,,AUTO
         1 000726   000017 631600 xsym               EPPR1 ! B_VECTNIL+15
         1 000727   000000 701200 xent               TSX1  ! KCD$PREL
         1 000730   000000 011200                    NOP   ! 0

PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:50   
      382    12729    4               RETURN;

  12729  1 000731   000000 702200 xent               TSX2  ! X66_ARET

      383    12730    4               END;
      384    12731    3             NK$LDCT.RESCOD=NK_NOCG;

  12731  1 000732   000001 376200 2                  ANQ   ! 1
         1 000733   000006 276207                    ORQ   ! 6,DL
         1 000734   100006 756300                    STQ   ! 6,,PR1

      385    12732    3             NK$LDCT.LNK$=KC_NOCG$;

  12732  1 000735   000000 236200 xsym               LDQ   ! KC_NOCG$
         1 000736   200054 471700                    LDP1  ! LDCT$,,AUTO
         1 000737   100004 756300                    STQ   ! 4,,PR1

      386    12733    3             KC_NOCG$=LDCT$;

  12733  1 000740   200054 236300                    LDQ   ! LDCT$,,AUTO
         1 000741   000000 756200 xsym               STQ   ! KC_NOCG$

      387    12734    4             IF ERROR ~= %E$NOCG THEN DO;

  12734  1 000742   200063 235300                    LDA   ! ERROR,,AUTO
         1 000743   001540 115207                    CMPA  ! 864,DL
         1 000744   001020 600200 1                  TZE   ! s:12753

      388    12735    5               IF NK$LDCT.DFLG.LOCAL = '0'B THEN DO;

  12735  1 000745   200054 471700                    LDP1  ! LDCT$,,AUTO
         1 000746   100006 236300                    LDQ   ! 6,,PR1
         1 000747   002000 316207                    CANQ  ! 1024,DL
         1 000750   001020 601200 1                  TNZ   ! s:12753

      389    12736    5                 IF NK$LDCT.NOCGINF

PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:51   
  12736  1 000751   100007 236300                    LDQ   ! 7,,PR1
         1 000752   002000 316203                    CANQ  ! 1024,DU
         1 000753   001000 600200 1                  TZE   ! s:12745

      390    12737    6                 THEN DO;

      391    12738    6                   K$RWPARM = K_RWPARM_CON;

  12738  1 000754   000100 100600                    MLR   ! fill='000'O
         1 000755   000000 000234 xsym               ADSC9   K_RWPARM_CON             cn=0,n=156
         1 000756   200004 000234                    ADSC9   K$RWPARM,,AUTO           cn=0,n=156

      392    12739    6                   K$RWPARM.MSG$ = ADDR(NCGACM);

  12739  1 000757   000014 236200 2                  LDQ   ! 12
         1 000760   200004 756300                    STQ   ! K$RWPARM,,AUTO

      393    12740    6                   K$RWPARM.MSGSZ = LENGTHC(NCGACM);

  12740  1 000761   000061 235207                    LDA   ! 49,DL
         1 000762   200005 755300                    STA   ! K$RWPARM+1,,AUTO

      394    12741    6                   K$RWPARM.DVE.VFC = 'd';

  12741  1 000763   000144 236203                    LDQ   ! 100,DU
         1 000764   200014 552320                    STBQ  ! K$RWPARM+8,'20'O,AUTO

      395    12742    6                   K$RWPARM.DVE.DVBYTE.VFC = '1'B;

  12742  1 000765   100000 236203                    LDQ   ! 32768,DU
         1 000766   200014 256300                    ORSQ  ! K$RWPARM+8,,AUTO

      396    12743    6                   CALL KIA$FCNOU(NK$LDCT,%KV_VDO_FNC_DAT_IMD,K$RWPARM);

  12743  1 000767   200004 633700                    EPPR3 ! K$RWPARM,,AUTO
         1 000770   200070 453700                    STP3  ! @PARM+3,,AUTO
         1 000771   000015 236200 2                  LDQ   ! 13
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:52   
         1 000772   200054 235300                    LDA   ! LDCT$,,AUTO
         1 000773   200066 757300                    STAQ  ! @PARM+1,,AUTO
         1 000774   200066 630700                    EPPR0 ! @PARM+1,,AUTO
         1 000775   000021 631600 xsym               EPPR1 ! B_VECTNIL+17
         1 000776   000000 701200 xent               TSX1  ! KIA$FCNOU
         1 000777   000000 011200                    NOP   ! 0

      397    12744    6                   END;

      398    12745    5                 IF NK$LDCT.DFLG.OLDSC='0'B

  12745  1 001000   200054 470700                    LDP0  ! LDCT$,,AUTO
         1 001001   000006 236300                    LDQ   ! 6,,PR0
         1 001002   010000 316207                    CANQ  ! 4096,DL
         1 001003   001020 601200 1                  TNZ   ! s:12753

      399    12746    6                 THEN DO;

      400    12747    6                   K$RWPARM = K_RWPARM_CON;

  12747  1 001004   000100 100600                    MLR   ! fill='000'O
         1 001005   000000 000234 xsym               ADSC9   K_RWPARM_CON             cn=0,n=156
         1 001006   200004 000234                    ADSC9   K$RWPARM,,AUTO           cn=0,n=156

      401    12748    6                   CALL KIA$DSCU(NK$LDCT,%KV_VDO_FNC_DSC_RQS,K$RWPARM) ALTRET(XIT);

  12748  1 001007   200004 631700                    EPPR1 ! K$RWPARM,,AUTO
         1 001010   200070 451700                    STP1  ! @PARM+3,,AUTO
         1 001011   000016 236200 2                  LDQ   ! 14
         1 001012   200054 235300                    LDA   ! LDCT$,,AUTO
         1 001013   200066 757300                    STAQ  ! @PARM+1,,AUTO
         1 001014   200066 630700                    EPPR0 ! @PARM+1,,AUTO
         1 001015   000021 631600 xsym               EPPR1 ! B_VECTNIL+17
         1 001016   000000 701200 xent               TSX1  ! KIA$DSCU
         1 001017   001050 702200 1                  TSX2  ! XIT

      402    12749    6                   END;
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:53   

      403    12750    5                 END;

      404    12751    4               END;

      405    12752    3             END;

      406    12753    2           RETURN;

  12753  1 001020   000000 702200 xent               TSX2  ! X66_ARET

      407    12754    2           END;
      408    12755    1         CALL KCO$TRMGO (LDCT$);

  12755  1 001021   200054 630500                    EPPR0   LDCT$,,AUTO
         1 001022   200066 450500                    STP0    @PARM+1,,AUTO
         1 001023   200066 630500                    EPPR0   @PARM+1,,AUTO
         1 001024   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001025   000000 701000 xent               TSX1    KCO$TRMGO
         1 001026   000000 011000                    NOP     0

      409    12756    1         IF NK$LDCT.BKPND~=0 THEN

  12756  1 001027   200054 470500                    LDP0    LDCT$,,AUTO
         1 001030   000014 236100                    LDQ     12,,PR0
         1 001031   777000 316003                    CANQ    -512,DU
         1 001032   001050 600000 1                  TZE     XIT

      410    12757    2           DO;

      411    12758    2           TPASS=NK$LDCT.BKPND;

  12758  1 001033   000014 236100                    LDQ     12,,PR0
         1 001034   000033 772000                    QRL     27
         1 001035   200056 756100                    STQ     TPASS,,AUTO

      412    12759    2           NK$LDCT.BKPND=0;
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:54   

  12759  1 001036   000000 236003                    LDQ     0,DU
         1 001037   000014 552140                    STBQ    12,'40'O,PR0

      413    12760    2           CALL KQP$EVNT (NK$LDCT,TPASS);

  12760  1 001040   200056 630500                    EPPR0   TPASS,,AUTO
         1 001041   200067 450500                    STP0    @PARM+2,,AUTO
         1 001042   200054 236100                    LDQ     LDCT$,,AUTO
         1 001043   200066 756100                    STQ     @PARM+1,,AUTO
         1 001044   200066 630500                    EPPR0   @PARM+1,,AUTO
         1 001045   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001046   000000 701000 xent               TSX1    KQP$EVNT
         1 001047   000000 011000                    NOP     0

      414    12761    2           END;

      415    12762    1   XIT:  RETURN;

  12762  1 001050   000000 702200 xent  XIT          TSX2  ! X66_ARET

NCGACM
 Sect OctLoc
   0     000   052052 052040   131117 125122   040103 117115   107122 117125    *** YOUR COMGROU
   0     004   120040 104117   105123 040116   117124 040101   103103 105120    P DOES NOT ACCEP
   0     010   124040 131117   125122 040114   117107 117116   041040 052052    T YOUR LOGON! **
   0     014   052*** ******                                                    *...

E_NOTAUTH
 Sect OctLoc
   0     015   131415 006256                                                    Y...

(unnamed)
 Sect OctLoc
   0     016   131415 020604                                                    Y...

E_ANY
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:55   
 Sect OctLoc
   0     017   131415 000004                                                    Y...

E_PCNLDCT
 Sect OctLoc
   0     020   131415 022614                                                    Y...

E_PCFEPDN
 Sect OctLoc
   0     021   131415 022604                                                    Y...

(unnamed)
 Sect OctLoc
   0     022   131415 022624   106105 120101   060060 040040                    Y...FEPA00

(unnamed)
 Sect OctLoc
   2     000   000000 006000   777777 777760   777777 777770   777777 400007    ................
   2     004   052040 040040   000000 006000   000004 006000   000002 006000    *   ............
   2     010   000003 006000   000000 000031   000005 006000   000011 006000    ................
   2     014   000000 006000   000010 006000   000014 006000                    ............
      416    12763    1   END KLM$MONHLP;

PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:56   
--  Include file information  --

   K$RWPARM.:E05TOU  is referenced.
   K_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KL_ERRORS_C.:E05TOU  is referenced.
   UM_CP6.:E05TOU  is referenced.
   KC_ERRORS_C.:E05TOU  is referenced.
   KI_ERRORS_C.:E05TOU  is referenced.
   KL_SUBS_C.:E05TOU  is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   KI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   NK_LDCT_R.:E05TOU  cannot be made into a system file and is referenced.
   NK_SUBS.:E05TOU  is referenced.
   KC_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   EL_MACRO_C.:E05TOU  is referenced.
   KC_CP6.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KV$VDO.:E05TOU  is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   UD_SEV_C.:E05TOU  is referenced.
   UD_ERRORS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure KLM$MONHLP.
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:57   

 **** Variables and constants ****

  ****  Section 000 RoData KLM$MONHLP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    17-0-0/w STRC        r     1 E_ANY                     15-0-0/w STRC        r     1 E_NOTAUTH
    21-0-0/w STRC        r     1 E_PCFEPDN                 20-0-0/w STRC        r     1 E_PCNLDCT
     0-0-0/c CHAR(49)    r     1 NCGACM

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @PARM                     65-0-0/w PTR         r     1 @PARM
    55-0-0/w UBIN        r     1 CGX                       63-0-0/w UBIN        r     1 ERROR
    57-0-0/c STRC(72)    r     1 FEPNM                     57-0-0/c CHAR(8)     r     1 FEPNM_C
    62-0-0/w UBIN        r     1 FEX                        4-0-0/d STRC(1404)  r     1 K$RWPARM
    54-0-0/w PTR         r     1 LDCT$                     56-0-0/w PTR         r     1 NMLDCT$
    *0-0-0/w UBIN        r     1 PARM                      *0-0-0/w UBIN        r     1 PARM
    61-0-0/w UBIN        r     1 PSIZ                      56-0-0/w UBIN        r     1 TPASS

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$PS1$
     0-0-0/w PTR         r     1 B$PS2$                     0-0-0/w PTR         r     1 KC_NOCG$
     0-0-0/w PTR         r     1 KI_FEI$$                   0-0-0/b BIT (72)    r     1 KI_LOCK
     0-0-0/w PTR         r     1 KI_ROUTE$$                 0-0-0/w UBIN        r     1 K_NODE#
     0-0-0/d STRC(1404)  r     1 K_RWPARM_CON               0-0-0/w PTR         r     1 N$DCT$$
     0-0-0/w UBIN        r     1 NK_MXLOCAL                 0-0-0/w UBIN        r     1 NK_MXTOTAL
     0-0-0/w UBIN        r     1 S_CUN

PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:58   
  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(2088)  r     1 B$JIT                      0-0-0/d STRC(1620)  r     1 EL$RENT
     0-0-0/w STRC(432)   r     1 KC$CGID                    0-0-0/w STRC(216)   r     1 KI$ROUTE
     0-0-0/w PTR         r     1 KI$ROUTE$(0:0)
     0-0-0/w STRC(2448)  r     1 KL$PCD                     0-0-0/d STRC(864)   r     1 NK$LDCT
     0-0-0/w PTR         r     1 NK$LDCT$(0:0)
     0-0-0/d STRC        r     1 VLR$PATHCON


   Procedure KLM$MONHLP requires 553 words for executable code.
   Procedure KLM$MONHLP requires 60 words of local(AUTO) storage.

    No errors detected in file KLM$MONHLP.:E05TSI    .
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:59   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:60   
          MINI XREF LISTING

B$JIT.ERR
     11603**DCL     12495<<ASSIGN  12508<<ASSIGN  12518<<ASSIGN  12534<<ASSIGN  12572<<ASSIGN  12613<<ASSIGN
     12724<<ASSIGN
B$JIT.ERR.CODE
     11604**DCL     12573<<ASSIGN  12616>>IF      12618<<ASSIGN  12725<<ASSIGN
B$JIT.ERR.MID
     11604**DCL     11604--REDEF
B$JIT.ERR.SEV
     11604**DCL     12611<<ASSIGN  12652>>IF
B$JIT$
     12448**DCL     11598--IMP-PTR 12495>>ASSIGN  12508>>ASSIGN  12518>>ASSIGN  12534>>ASSIGN  12572>>ASSIGN
     12573>>ASSIGN  12611>>ASSIGN  12613>>ASSIGN  12616>>IF      12618>>ASSIGN  12652>>IF      12724>>ASSIGN
     12725>>ASSIGN
B$PS1$
     12450**DCL     11901--IMP-PTR 11968--IMP-PTR 12543>>ASSIGN  12544>>ASSIGN  12545>>ASSIGN  12714>>ASSIGN
     12716>>IF      12722>>CALL
B$PS2$
     12451**DCL     11750--IMP-PTR 11986--IMP-PTR 12503>>IF      12505>>ASSIGN  12529>>IF      12539>>IF
     12548>>ASSIGN  12549>>ASSIGN  12550>>ASSIGN  12551>>ASSIGN  12552>>ASSIGN  12553>>ASSIGN  12555>>DOCASE
     12557>>ASSIGN  12565>>ASSIGN  12566>>ASSIGN  12570>>CALL    12570>>CALL    12616>>IF      12625>>IF
     12625>>IF      12625>>IF      12628>>ASSIGN  12636>>CALL    12660>>ASSIGN  12661>>ASSIGN  12662<>CALL
     12664>>CALL    12722>>CALL
CGX
     12375**DCL     12684<<DOINDEX 12685>>ASSIGN
EL$RENT.CGINF
     11947**DCL     12722<>CALL
EL$RENT.CGINF.ATTR
     11952**DCL     11952--REDEF
EL$RENT.DKEY.DEVNM
     11929**DCL     12716>>IF
EL$RENT.DKEY.LDX
     11930**DCL     12714>>ASSIGN
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:61   
ELA$SYSLOG
     12433**DCL-ENT 12664--CALL
ERROR
     12384**DCL     12570<>CALL    12573>>ASSIGN  12602>>IF      12722<>CALL    12725>>ASSIGN  12734>>IF
E_ANY
     12404**DCL     12572>>ASSIGN  12724>>ASSIGN
E_NOTAUTH
     12392**DCL     12495>>ASSIGN
E_PCFEPDN
     12416**DCL     12508>>ASSIGN  12534>>ASSIGN
E_PCNLDCT
     12410**DCL     12518>>ASSIGN
FEPNM
     12378**DCL     12381--REDEF
FEPNM.NAME
     12379**DCL     12682<<ASSIGN
FEPNM.NODE
     12380**DCL     12683<<CALLBLT
FEPNM_C
     12381**DCL     12687>>IF
FEX
     12383**DCL     12681<<ASSIGN  12683>>CALLBLT
FRF$ADDRES
     12434**DCL-ENT 12636--CALL
HFC$LOCK
      9107**DCL-ENT 12527--CALL    12630--CALL
HFC$UNLOCK
      9107**DCL-ENT 12532--CALL    12568--CALL    12650--CALL
HFF$DSIZ
     12435**DCL-ENT 12662--CALL
K$RWPARM
     12079**DCL     12738<<ASSIGN  12743<>CALL    12747<<ASSIGN  12748<>CALL
K$RWPARM.BLKREC
     12105**DCL     12130--REDEF
K$RWPARM.BLKREC.BLKU#
     12106**DCL     12108--REDEF
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:62   
K$RWPARM.BLKREC.RECU#
     12118**DCL     12120--REDEF
K$RWPARM.DVE.DVBYTE.VFC
     12145**DCL     12146--REDEF   12742<<ASSIGN
K$RWPARM.DVE.EOMCHAR
     12153**DCL     12157--REDEF
K$RWPARM.DVE.VFC
     12157**DCL     12741<<ASSIGN
K$RWPARM.ERR
     12217**DCL     12222--REDEF
K$RWPARM.FC
     12181**DCL     12182--REDEF
K$RWPARM.FLDID
     12363**DCL     12364--REDEF
K$RWPARM.FPT$
     12244**DCL     12251--REDEF
K$RWPARM.KEYTYPE
     12370**DCL     12371--REDEF
K$RWPARM.MSG$
     12080**DCL     12086--REDEF   12739<<ASSIGN
K$RWPARM.MSGID
     12192**DCL     12197--REDEF
K$RWPARM.MSGIDXT
     12205**DCL     12209--REDEF
K$RWPARM.MSGSZ
     12087**DCL     12740<<ASSIGN
K$RWPARM.ORG
     12341**DCL     12342--REDEF
K$RWPARM.THDRSZ
     12285**DCL     12289--REDEF
K$RWPARM.VDOFLGS
     12343**DCL     12354--REDEF
KC$CGID
     11986**DCL     12722<>CALL
KCD$PREL
     12436**DCL-ENT 12728--CALL
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:63   
KCF$EXHUME
     12437**DCL-ENT 12720--CALL
KCO$TRMCON
     12438**DCL-ENT 12570--CALL    12722--CALL
KCO$TRMGO
     12439**DCL-ENT 12755--CALL
KC_NOCG$
      5839**DCL     12607>>ASSIGN  12608<<ASSIGN  12732>>ASSIGN  12733<<ASSIGN
KI$ROUTE.FEI#
     12009**DCL     12529>>IF
KI$ROUTE$
     12051**DCL     12529>>IF
KIA$DSCU
     12441**DCL-ENT 12748--CALL
KIA$FCNOU
     12440**DCL-ENT 12743--CALL
KI_FEI$$
      9119**DCL      9120--IMP-PTR
KI_LOCK
      9132**DCL     12527<>CALL    12532<>CALL    12568<>CALL    12630<>CALL    12650<>CALL
KI_ROUTE$$
      9121**DCL     12051--IMP-PTR 12529>>IF
KL$PCD
     11750**DCL     12636<>CALL    12664<>CALL
KL$PCD.ADDD.ASSOCTRM
     11798**DCL     12553>>ASSIGN
KL$PCD.ADDD.ATYP
     11775**DCL     12555>>DOCASE
KL$PCD.ADDD.CINFO
     11800**DCL     11804--REDEF
KL$PCD.ADDD.CINFO.USER
     11801**DCL     12557>>ASSIGN
KL$PCD.ADDD.DEVNM
     11793**DCL     11794--REDEF   12551>>ASSIGN  12625>>IF      12628>>ASSIGN
KL$PCD.ADDD.FEX
     11777**DCL     12529>>IF      12548>>ASSIGN
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:64   
KL$PCD.ADDD.IO.INPUT
     11780**DCL     12549>>ASSIGN
KL$PCD.ADDD.IO.OUTPUT
     11781**DCL     12550>>ASSIGN
KL$PCD.ADDD.LDCTX
     11808**DCL     12505>>ASSIGN
KL$PCD.ADDD.LDINFO.LDCTKEY
     11806**DCL     12661<<ASSIGN
KL$PCD.ADDD.LDINFO.LDCTX
     11805**DCL     12660<<ASSIGN
KL$PCD.ADDD.NMID
     11807**DCL     11808--REDEF
KL$PCD.ADDD.NOCGINF
     11785**DCL     12566>>ASSIGN
KL$PCD.ADDD.NOCGREJ
     11784**DCL     12565>>ASSIGN
KL$PCD.ADDD.TERMID
     11787**DCL     12552>>ASSIGN
KL$PCD.ADDD.TERMID.TTYP
     11789**DCL     12503>>IF      12539>>IF
KL$PCD.ADDD.USETP
     11783**DCL     12616>>IF      12625>>IF
KL$PCD.CGID
     11831**DCL     12570<>CALL
KL$PCD.CGINFO
     11854**DCL     12570<>CALL
KL$PCD.CGINFO.ATTR
     11859**DCL     11859--REDEF
KL$PCD.CGINFO.WHO.NAME
     11857**DCL     12625>>IF
KL$PCD.CGINFO.XTRAINFO
     11862**DCL     11864--REDEF
KQP$EVNT
     12442**DCL-ENT 12760--CALL
K_NODE#
     11532**DCL     12543>>ASSIGN
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:65   
K_RWPARM_CON
     11237**DCL     12738>>ASSIGN  12747>>ASSIGN
K_RWPARM_CON.BLKREC
     11263**DCL     11288--REDEF
K_RWPARM_CON.BLKREC.BLKU#
     11264**DCL     11266--REDEF
K_RWPARM_CON.BLKREC.RECU#
     11276**DCL     11278--REDEF
K_RWPARM_CON.DVE.DVBYTE.VFC
     11303**DCL     11304--REDEF
K_RWPARM_CON.DVE.EOMCHAR
     11311**DCL     11315--REDEF
K_RWPARM_CON.ERR
     11375**DCL     11380--REDEF
K_RWPARM_CON.FC
     11339**DCL     11340--REDEF
K_RWPARM_CON.FLDID
     11521**DCL     11522--REDEF
K_RWPARM_CON.FPT$
     11402**DCL     11409--REDEF
K_RWPARM_CON.KEYTYPE
     11528**DCL     11529--REDEF
K_RWPARM_CON.MSG$
     11238**DCL     11244--REDEF
K_RWPARM_CON.MSGID
     11350**DCL     11355--REDEF
K_RWPARM_CON.MSGIDXT
     11363**DCL     11367--REDEF
K_RWPARM_CON.ORG
     11499**DCL     11500--REDEF
K_RWPARM_CON.THDRSZ
     11443**DCL     11447--REDEF
K_RWPARM_CON.VDOFLGS
     11501**DCL     11512--REDEF
LDCT$
     12374**DCL     11702--IMP-PTR 12505<<ASSIGN  12506>>IF      12506>>IF      12517<>CALL    12540<>CALL
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:66   
     12544>>ASSIGN  12545>>ASSIGN  12547>>ASSIGN  12548>>ASSIGN  12549>>ASSIGN  12550>>ASSIGN  12551>>ASSIGN
     12552>>ASSIGN  12553>>ASSIGN  12554>>CALL    12557>>ASSIGN  12558>>ASSIGN  12559>>ASSIGN  12561>>IF
     12563>>ASSIGN  12564>>ASSIGN  12565>>ASSIGN  12566>>ASSIGN  12570<>CALL    12602>>IF      12602>>IF
     12605>>ASSIGN  12607>>ASSIGN  12608>>ASSIGN  12610>>IF      12628>>ASSIGN  12634>>ASSIGN  12635>>ASSIGN
     12636>>CALL    12654>>IF      12655>>ASSIGN  12656<>CALL    12658>>IF      12660>>ASSIGN  12664<>CALL
     12680<<ASSIGN  12681>>ASSIGN  12688>>ASSIGN  12690>>ASSIGN  12714<<ASSIGN  12715>>IF      12716>>IF
     12716>>IF      12716>>IF      12719>>ASSIGN  12720>>CALL    12722<>CALL    12727>>IF      12728>>CALL
     12731>>ASSIGN  12732>>ASSIGN  12733>>ASSIGN  12735>>IF      12736>>IF      12743>>CALL    12745>>IF
     12748>>CALL    12755<>CALL    12756>>IF      12758>>ASSIGN  12759>>ASSIGN  12760>>CALL
N$DCT$$
      5873**DCL      5873--IMP-PTR 12505>>ASSIGN  12685>>ASSIGN  12714>>ASSIGN
NAUTH
     12495**LABEL   12712--GOTO
NCGACM
     12390**DCL     12739--ASSIGN  12740--ASSIGN
NK$LDCT
     11702**DCL     12554<>CALL    12636<>CALL    12720<>CALL    12728<>CALL    12743<>CALL    12748<>CALL
     12760<>CALL
NK$LDCT.ACCTNG
     11712**DCL     12563<<ASSIGN  12634<<ASSIGN  12658>>IF
NK$LDCT.BKPND
     11724**DCL     12756>>IF      12758>>ASSIGN  12759<<ASSIGN
NK$LDCT.DDT$
     11704**DCL     11704--REDEF
NK$LDCT.DEVNM
     11704**DCL     12551<<ASSIGN  12687>>IF      12716>>IF
NK$LDCT.DFLG.CM
     11706**DCL     12547<<ASSIGN
NK$LDCT.DFLG.INPUT
     11706**DCL     12549<<ASSIGN
NK$LDCT.DFLG.LOCAL
     11708**DCL     12735>>IF
NK$LDCT.DFLG.OLDSC
     11707**DCL     12716>>IF      12727>>IF      12745>>IF
NK$LDCT.DFLG.OUTPUT
     11706**DCL     12550<<ASSIGN
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:67   
NK$LDCT.GENERATION
     11725**DCL     12544>>ASSIGN
NK$LDCT.IOQ$
     11703**DCL     11704--REDEF
NK$LDCT.LDCTX
     11705**DCL     11705--REDEF   12545>>ASSIGN  12660>>ASSIGN
NK$LDCT.LKFLG.ABORTED
     11717**DCL     11718--REDEF
NK$LDCT.LKFLG.ACTIVE
     11721**DCL     12559<<ASSIGN
NK$LDCT.LKFLG.QDPPATH
     11719**DCL     12688<<ASSIGN  12688>>ASSIGN
NK$LDCT.LNK$
     11704**DCL     12607<<ASSIGN  12732<<ASSIGN
NK$LDCT.LOGON_ACCT
     11732**DCL     12553<<ASSIGN  12628<<ASSIGN
NK$LDCT.NOCGINF
     11711**DCL     12566<<ASSIGN  12610>>IF      12736>>IF
NK$LDCT.NOCGREJ
     11711**DCL     12565<<ASSIGN  12602>>IF
NK$LDCT.RESCOD
     11710**DCL     12506>>IF      12558<<ASSIGN  12564<<ASSIGN  12605<<ASSIGN  12635<<ASSIGN  12655<<ASSIGN
     12716>>IF      12719<<ASSIGN  12731<<ASSIGN
NK$LDCT.RLCID.LDCTX
     11727**DCL     11727--REDEF
NK$LDCT.RLCID.NODE
     11726**DCL     12548<<ASSIGN  12681>>ASSIGN
NK$LDCT.STA$
     11723**DCL     11724--REDEF
NK$LDCT.SYMB$
     11702**DCL     11702--REDEF   11702--REDEF   11703--REDEF
NK$LDCT.TCTX#
     11712**DCL     12690<<ASSIGN  12690>>ASSIGN
NK$LDCT.TERMID
     11730**DCL     12552<<ASSIGN
NK$LDCT.TERMID.TTYP
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:68   
     11730**DCL     12561>>IF      12602>>IF      12654>>IF
NK$LDCT.USER
     11712**DCL     12557<<ASSIGN
NK$LDCT$
      5873**DCL     12505>>ASSIGN  12685>>ASSIGN  12714>>ASSIGN
NKL$GETDCT
     12443**DCL-ENT 12517--CALL
NKL$RELDCT
     12444**DCL-ENT 12540--CALL    12656--CALL
NK_MXLOCAL
      5873**DCL     12684>>DOINDEX
NK_MXTOTAL
      5873**DCL     12684>>DOINDEX
NMLDCT$
     12377**DCL     12685<<ASSIGN  12686>>IF      12687>>IF      12688>>ASSIGN  12690>>ASSIGN
PARM
     11578**DCL        13--PROC    12674<>CALL
PARM IN PROCEDURE SETTCTX
     12679**DCL     12678--PROC    12680--ASSIGN
PSIZ
     12382**DCL     12662<>CALL    12663<<ASSIGN  12663>>ASSIGN  12664<>CALL
SC_NTRMCN
     12445**DCL-ENT 12639--CALL
SETTCTX
     12678**PROC    12554--CALL    12674--CALL
SSR$REG
     12446**DCL-ENT 12666--CALL
S_CUN
     12449**DCL     12493>>IF      12712>>IF
TELLELF
     12664**LABEL   12667--GOTO
TPASS
     12376**DCL     12377--REDEF   12758<<ASSIGN  12760<>CALL
VLR$PATHCON.RLCID.GENERATION
     11968**DCL     12544<<ASSIGN
VLR$PATHCON.RLCID.LDCTX
PL6.E3A0      #001=KLM$MONHLP File=KLM$MONHLP.:E05TSI                            WED 07/30/97 00:53 Page:69   
     11969**DCL     12545<<ASSIGN
VLR$PATHCON.RLCID.NODE
     11968**DCL     12543<<ASSIGN
XIT
     12762**LABEL   12715--GOTO    12718--GOTO    12748--CALLALT
