VERSION E05

PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:1    
        1        1        /*M* QTB$CREMOD_E - Perform  CREATE / MODIFY ENTRY  commands */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QTB$CREMOD_E:
        9        9                PROC;
       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE B$JIT;
       16      440        %INCLUDE QT_DATA_R;
       17      454        %INCLUDE CP_6_SUBS;
       18      994        %INCLUDE QT_PERR_C;
       19     1045        %INCLUDE Q_ERRCODE_C;
       20     1068        %INCLUDE QT_MACROS_C;
       21     1226        %INCLUDE QT_SUBS_C;
       22     1310        %INCLUDE XU_MACRO_C;
       23     4416        %PAGE(ARG="Externally defined routines");

              4433    1   /***************************************************************************
              4434    1    *                                                                         *
              4435    1    *                        Externally defined routines                      *
              4436    1    *                                                                         *
              4437    1    ***************************************************************************/

PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:2    
       24     4441    1   DCL QTA$READ_SET ENTRY(1);
       25     4442    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
       26     4443    1   DCL QTC$READ_TRADER ENTRY(3) ALTRET;
       27     4444    1   DCL QTC$WRITE_TRADER ENTRY(2);
       28     4445    1   DCL XUR$ERRPTR ENTRY(2) ALTRET;
       29     4446        %PAGE(ARG="Symrefs");

              4463    1   /***************************************************************************
              4464    1    *                                                                         *
              4465    1    *                                  Symrefs                                *
              4466    1    *                                                                         *
              4467    1    ***************************************************************************/

       30     4471    1   DCL B$JIT$ PTR SYMREF;
       31     4472        %PAGE(ARG="Based");

              4489    1   /***************************************************************************
              4490    1    *                                                                         *
              4491    1    *                                   Based                                 *
              4492    1    *                                                                         *
              4493    1    ***************************************************************************/

       32     4497        %QT$ENTRY;
       33     4551        %PARSE$SYM(STCLASS=BASED);
       34     4589        %PARSE$OUT(STCLASS=BASED);
       35     4634        %PAGE(ARG="Static");

              4651    1   /***************************************************************************
              4652    1    *                                                                         *
              4653    1    *                                   Static                                *
              4654    1    *                                                                         *
              4655    1    ***************************************************************************/

       36     4659    1   DCL FID CHAR(100) STATIC;
       37     4660        %PAGE(ARG="Constant");

              4677    1   /***************************************************************************
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:3    
              4678    1    *                                                                         *
              4679    1    *                                  Constant                               *
              4680    1    *                                                                         *
              4681    1    ***************************************************************************/

       38     4685        %VLP_CGCP(FPTN=VLP_CGCP_C, MXACT=9999, STCLASS=CONSTANT);
       39     4728        %VLP_CGTYPL(FPTN=VLP_CGTYPL_C, STCLASS=CONSTANT);
       40     4753        %QT$ENTRY(FPTN=QT_ENTRY_C, STCLASS=CONSTANT);
       41     4807        %PAGE(ARG="Auto");

              4824    1   /***************************************************************************
              4825    1    *                                                                         *
              4826    1    *                                    Auto                                 *
              4827    1    *                                                                         *
              4828    1    ***************************************************************************/

       42     4832    1   DCL MSGTYP CHAR(8);
       43     4833    1   DCL FOUND_MSGTYP CHAR(8);
       44     4834
       45     4835    1   DCL REC_OK_FLAG BIT(1) ALIGNED;
       46     4836    1   DCL SETS_FLAG BIT(1) ALIGNED;
       47     4837
       48     4838    1   DCL SUBLK$ PTR;
       49     4839
       50     4840    1   DCL NSUBLKS UBIN WORD;
       51     4841    1   DCL I UBIN WORD;
       52     4842    1   DCL SUB_CODE UBIN WORD;
       53     4843    1   DCL POS UBIN WORD;
       54     4844    1   DCL TEMP UBIN WORD;
       55     4845    1   DCL CPOS UBIN WORD;
       56     4846
       57     4847    1   DCL OPTIONS_USED(0:35) BIT(1) UNAL;
       58     4848    1   DCL ALL_OPTIONS REDEF OPTIONS_USED BIT(36);
       59     4849        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:4    
              4866    1   /***************************************************************************
              4867    1    *                                                                         *
              4868    1    *                                Error codes                              *
              4869    1    *                                                                         *
              4870    1    ***************************************************************************/

       60     4874        %ERRCODE(NAME=CODE_NWH, CODE#=%E$NWH, FCG#=%FCG_QT, MID#=%MID_B);
       61     4881        %ERRCODE(NAME=CODE_AE, CODE#=%E$AE, FCG#=%FCG_QT, MID#=%MID_B);
       62     4888        %ERRCODE(NAME=CODE_CMNF, CODE#=%E$CMNF, FCG#=%FCG_QT, MID#=%MID_B);
       63     4895        %ERRCODE(NAME=CODE_AUSED, CODE#=%E$AUSED, FCG#=%FCG_QT, MID#=%MID_B);
       64     4902        %ERRCODE(NAME=CODE_DTL, CODE#=%E$DTL, FCG#=%FCG_QT, MID#=%MID_B);
       65     4909        %ERRCODE(NAME=CODE_ON, CODE#=%E$ON, FCG#=%FCG_QT, MID#=%MID_B);
       66     4916        %ERRCODE(NAME=CODE_IDN, CODE#=%E$IDN, FCG#=%FCG_QT, MID#=%MID_B);
       67     4923        %ERRCODE(NAME=CODE_PTS, CODE#=%E$PTS, FCG#=%FCG_QT, MID#=%MID_B);
       68     4930        %ERRCODE(NAME=CODE_PTB, CODE#=%E$PTB, FCG#=%FCG_QT, MID#=%MID_B);
       69     4937        %ERRCODE(NAME=CODE_TMBOD, CODE#=%E$TMBOD, FCG#=%FCG_QT, MID#=%MID_B);
       70     4944        %ERRCODE(NAME=CODE_BFFT, CODE#=%E$BFFT, FCG#=%FCG_QT, MID#=%MID_B);
       71     4951        %ERRCODE(NAME=CODE_NTPAP, CODE#=%E$NTPAP, FCG#=%FCG_QT, MID#=%MID_B);
       72     4958        %ERRCODE(NAME=CODE_BAD_MAXACTIVE, CODE#=%E$BAD_MAXACTIVE, FCG#=%FCG_QT,
       73     4959        MID#=%MID_B);
       74     4966        /*E*       ERROR: QTB-E$AE-C
       75     4967
       76     4968                 MESSAGE: Can't create; that type already exists.
       77     4969             DESCRIPTION: An attempt was made to create a type that
       78     4970                          already exists.
       79     4971        */
       80     4972        /*E*       ERROR: QTB-E$CMNF-C
       81     4973
       82     4974                 MESSAGE: Can't modify; that type does not exist.
       83     4975             DESCRIPTION: An attempt has been made to modify a type
       84     4976                          that does not exist
       85     4977        */
       86     4978        /*E*       ERROR: QTB-E$AUSED-C
       87     4979
       88     4980                 MESSAGE: This option has been used more than once.
       89     4981                          The most recent value specified has been used.
       90     4982             DESCRIPTION: There should be no reason to use the same
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:5    
       91     4983                          option more than once.
       92     4984        */
       93     4985        /*E*       ERROR: QTB-E$DTL-C
       94     4986
       95     4987                 MESSAGE: Debugger name too long.  Debugger names are
       96     4988                          limited to 11 characters.
       97     4989             DESCRIPTION: The debugger name is too long to be legal.
       98     4990        */
       99     4991        /*E*       ERROR: QTB-E$ON-C
      100     4992
      101     4993                 MESSAGE: A DEBUGGER name is not a FID; you may only
      102     4994                          specify a name.
      103     4995             DESCRIPTION: Some other piece of a FID in addition to
      104     4996                          a name was found.  Only a name may be used.
      105     4997        */
      106     4998        /*E*       ERROR: QTB-E$IDN-C
      107     4999
      108     5000                 MESSAGE: Invalid debugger name
      109     5001             DESCRIPTION: Invalid name was specified for the debugger
      110     5002        */
      111     5003        /*E*       ERROR: QTB-E$PTS-C
      112     5004
      113     5005                 MESSAGE: Priority is less than the minimum (1).  The
      114     5006                          minimum has been substituted.
      115     5007             DESCRIPTION: A priority must be > 1 & < 501
      116     5008        */
      117     5009        /*E*       ERROR: QTB-E$PTB-C
      118     5010
      119     5011                 MESSAGE: Priority is greater than the maximum (500).
      120     5012                          The maximum has been substituted.
      121     5013             DESCRIPTION: A priority must be > 1 & < 501
      122     5014        */
      123     5015        /*E*       ERROR: QTB-E$BFFT-C
      124     5016
      125     5017                 MESSAGE: Invalid FID for the TPAP
      126     5018             DESCRIPTION: The FID for the TPAP is not a valid FID
      127     5019        */
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:6    
      128     5020        /*E*       ERROR: QTB-E$NTPAP-C
      129     5021
      130     5022                 MESSAGE: A TPAP must be specified.
      131     5023             DESCRIPTION: The TPAP is required.  Please specify a
      132     5024                          valid run unit FID for the TPAP.
      133     5025        */
      134     5026        /*E*       ERROR: QTB-E$TMBOD-C
      135     5027
      136     5028                 MESSAGE: TPAPs must be on disk.
      137     5029             DESCRIPTION: The FID for a TPAP must be a file that resides
      138     5030                          on disk.
      139     5031        */
      140     5032        /*E*       ERROR: QTB-E$BAD_MAXACTIVE-C
      141     5033
      142     5034                 MESSAGE: MAXACTIVE must be between 0 and 9999
      143     5035             DESCRIPTION: The value for MAXACTIVE was out of range.
      144     5036        */
      145     5037        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:7    
              5054    1   /***************************************************************************
              5055    1    *                                                                         *
              5056    1    *                                    FPTs                                 *
              5057    1    *                                                                         *
              5058    1    ***************************************************************************/

      146     5062        %FPT_OPEN;
      147     5171
      148     5172        %FPT_FID(NAME=VLP_NAME, PASS=VLP_PASS, RESULTS=VLR_FID,
      149     5173        ACCT=VLP_ACCT, ASN="FPT_OPEN.V.ASN#", SN=VLP_SN,
      150     5174        RES="FPT_OPEN.V.RES#", WSN=VLP_WSN, TEXTFID=FID);
      151     5197        %PAGE(ARG="VLPs");

              5214    1   /***************************************************************************
              5215    1    *                                                                         *
              5216    1    *                                    VLPs                                 *
              5217    1    *                                                                         *
              5218    1    ***************************************************************************/

      152     5222        %VLP_NAME;
      153     5249        %VLP_PASS;
      154     5262        %VLP_ACCT;
      155     5275        %VLP_SN;
      156     5288        %VLP_WSN;
      157     5301        %PAGE(ARG="VLRs");

              5318    1   /***************************************************************************
              5319    1    *                                                                         *
              5320    1    *                                    VLRs                                 *
              5321    1    *                                                                         *
              5322    1    ***************************************************************************/

      158     5326        %VLR_FID;
      159     5345        %PAGE(ARG="QTB$CREMOD_E", PAGE=YES);

PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:8    
              5362    1   /***************************************************************************
              5363    1    *                                                                         *
              5364    1    *                                QTB$CREMOD_E                             *
              5365    1    *                                                                         *
              5366    1    ***************************************************************************/

      160     5370    1           SETS_FLAG = '0'B;
      161     5371    1           REC_OK_FLAG = '1'B;
      162     5372    1           NSUBLKS = QT_CMDBLK.OUT$ -> OUT$BLK.NSUBLKS - 1;
      163     5373    1           ALL_OPTIONS = '0'B;
      164     5374
      165     5375    1           MSGTYP = QT_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT;
      166     5376
      167     5377    1           CALL INDEX(POS, '?', MSGTYP) ALTRET(NO_Q);
      168     5378    1           QT_CMDBLK.MINOR_ERR = CODE_NWH;
      169     5379    1           CALL XUR$ERRMSG(CODE_NWH);
      170     5380    1           REC_OK_FLAG = '0'B;
      171     5381
      172     5382    1   NO_Q:
      173     5383    1           CALL QTC$READ_TRADER(MSGTYP, 1 /* TYPE_E */, FOUND_MSGTYP)
      174     5384    1               ALTRET(NOT_FOUND);
      175     5385
      176     5386    1           IF QT_CMDBLK.CODE = 2 /* CREATE_ENTRY */ THEN
      177     5387    2             DO;
      178     5388    2               QT_CMDBLK.MINOR_ERR = CODE_AE;
      179     5389    2               CALL XUR$ERRMSG(CODE_AE);
      180     5390    2               REC_OK_FLAG = '0'B;
      181     5391
      182     5392    2               QT$ENTRY = QT_ENTRY_C;
      183     5393    2               QT$ENTRY.MAXACTIVE = VLP_CGCP_C.MXACT#;
      184     5394    2               QT$ENTRY.PRIO = VLP_CGTYPL_C.LIST.PRIO#(0);
      185     5395    2             END;
      186     5396
      187     5397    2           DO WHILE('0'B);
      188     5398
      189     5399    2   NOT_FOUND:
      190     5400    2             IF QT_CMDBLK.CODE = 12 /* MODIFY_ENTRY */ THEN
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:9    
      191     5401    3               DO;
      192     5402    3                 QT_CMDBLK.MINOR_ERR = CODE_CMNF;
      193     5403    3                 CALL XUR$ERRMSG(CODE_CMNF);
      194     5404    3                 REC_OK_FLAG = '0'B;
      195     5405    3               END;
      196     5406
      197     5407    2             QT$ENTRY = QT_ENTRY_C;
      198     5408    2             QT$ENTRY.MAXACTIVE = VLP_CGCP_C.MXACT#;
      199     5409    2             QT$ENTRY.PRIO = VLP_CGTYPL_C.LIST.PRIO#(0);
      200     5410    2           END /* NEVER */;
      201     5411
      202     5412    2           DO I = 1 TO NSUBLKS;
      203     5413    2             SUBLK$ = QT_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(I);
      204     5414    2             SUB_CODE = SUBLK$ -> OUT$SYM.CODE;
      205     5415    2             IF OPTIONS_USED(SUB_CODE) THEN
      206     5416    3               DO;
      207     5417    3                 CPOS = SUBLK$ -> OUT$SYM.CPOS;
      208     5418    3                 CALL XUR$ERRPTR(CPOS, QT_GLOBAL.M$DO#);
      209     5419    3                 QT_CMDBLK.MINOR_ERR = CODE_AUSED;
      210     5420    3                 CALL XUR$ERRMSG(CODE_AUSED);
      211     5421    3               END;
      212     5422
      213     5423    2             OPTIONS_USED(SUB_CODE) = '1'B;
      214     5424
      215     5425    3             DO CASE(SUB_CODE);
      216     5426
      217     5427    3               CASE(7 /* OPT_DEBUGGER */);
      218     5428    3                 SUBLK$ = SUBLK$ -> OUT$BLK.SUBLK$(0);
      219     5429    3                 IF SUBLK$ -> OUT$SYM.COUNT = 0 THEN
      220     5430    4                   DO;
      221     5431    4                     QT$ENTRY.DEBUGGER.COUNT = 0;
      222     5432    4                     QT$ENTRY.DEBUGGER.TEXT = ' ';
      223     5433    4                     GOTO LOOP;
      224     5434    4                   END;
      225     5435
      226     5436    3                 FID = SUBLK$ -> OUT$SYM.TEXT;
      227     5437    3                 CALL M$FID(FPT_FID) ALTRET(DEBUGGER_ERR);
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:10   
      228     5438
      229     5439    3                 IF VLP_NAME.L# > 11 THEN
      230     5440    4                   DO;
      231     5441    4                     QT_CMDBLK.MINOR_ERR = CODE_DTL;
      232     5442    4                     CALL XUR$ERRMSG(CODE_DTL);
      233     5443    4                     REC_OK_FLAG = '0'B;
      234     5444    4                   END;
      235     5445
      236     5446    3                 IF VLR_FID.ACCT OR
      237     5447    3                     VLR_FID.PASS OR
      238     5448    3                     VLR_FID.SN OR
      239     5449    3                     VLR_FID.WSN OR
      240     5450    3                     VLR_FID.RES THEN
      241     5451    4                   DO;
      242     5452    4                     QT_CMDBLK.MINOR_ERR = CODE_ON;
      243     5453    4                     CALL XUR$ERRMSG(CODE_ON);
      244     5454    4                     REC_OK_FLAG = '0'B;
      245     5455    4                   END;
      246     5456
      247     5457    4                 DO WHILE('0'B);
      248     5458
      249     5459    4   DEBUGGER_ERR:
      250     5460    4                   QT_CMDBLK.MINOR_ERR = CODE_IDN;
      251     5461    4                   CALL XUR$ERRMSG(CODE_IDN);
      252     5462    4                   REC_OK_FLAG = '0'B;
      253     5463    4                 END /* NEVER */;
      254     5464
      255     5465    3                 QT$ENTRY.DEBUGGER = VLP_NAME;
      256     5466
      257     5467    3               CASE(4 /* OPT_LOCK */);
      258     5468    3                 SUBLK$ = SUBLK$ -> OUT$BLK.SUBLK$(0);
      259     5469    3                 IF SUBLK$ -> OUT$SYM.CODE = 1 /* NO */ THEN
      260     5470    4                   DO;
      261     5471    4                     QT$ENTRY.FLAGS.NEW_LOCK = '0'B;
      262     5472    4                   END;
      263     5473    3                 ELSE
      264     5474    4                   DO;
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:11   
      265     5475    4                     QT$ENTRY.FLAGS.NEW_LOCK = '1'B;
      266     5476    4                   END;
      267     5477
      268     5478    3               CASE(5 /* OPT_MESSAGE */);
      269     5479    3                 SUBLK$ = SUBLK$ -> OUT$BLK.SUBLK$(0);
      270     5480    3                 IF SUBLK$ -> OUT$SYM.CODE = 1 /* NO */ THEN
      271     5481    4                   DO;
      272     5482    4                     QT$ENTRY.FLAGS.MESSAGE = '0'B;
      273     5483    4                   END;
      274     5484    3                 ELSE
      275     5485    4                   DO;
      276     5486    4                     QT$ENTRY.FLAGS.MESSAGE = '1'B;
      277     5487    4                   END;
      278     5488
      279     5489    3               CASE(6 /* OPT_MAXACTIVE */);
      280     5490    3                 SUBLK$ = SUBLK$ -> OUT$BLK.SUBLK$(0);
      281     5491    3                 CALL CHARBIN(TEMP, SUBLK$ -> OUT$SYM.TEXT);
      282     5492    3                 IF TEMP <= 9999 THEN
      283     5493    4                   DO;
      284     5494    4                     QT$ENTRY.MAXACTIVE = TEMP;
      285     5495    4                   END;
      286     5496    3                 ELSE
      287     5497    4                   DO;
      288     5498    4                     QT_CMDBLK.MINOR_ERR = CODE_BAD_MAXACTIVE;
      289     5499    4                     CALL XUR$ERRMSG(CODE_BAD_MAXACTIVE);
      290     5500    4                     REC_OK_FLAG = '0'B;
      291     5501    4                   END;
      292     5502
      293     5503    3               CASE(3 /* OPT_PRIO */);
      294     5504    3                 SUBLK$ = SUBLK$ -> OUT$BLK.SUBLK$(0);
      295     5505    3                 CALL CHARBIN(TEMP, SUBLK$ -> OUT$SYM.TEXT);
      296     5506
      297     5507    3                 IF TEMP < 1 THEN
      298     5508    4                   DO;
      299     5509    4                     QT_CMDBLK.MINOR_ERR = CODE_PTS;
      300     5510    4                     CALL XUR$ERRMSG(CODE_PTS);
      301     5511    4                     TEMP = 1;
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:12   
      302     5512    4                   END;
      303     5513
      304     5514    3                 IF TEMP > 500 THEN
      305     5515    4                   DO;
      306     5516    4                     QT_CMDBLK.MINOR_ERR = CODE_PTB;
      307     5517    4                     CALL XUR$ERRMSG(CODE_PTB);
      308     5518    4                     TEMP = 500;
      309     5519    4                   END;
      310     5520
      311     5521    3                 QT$ENTRY.PRIO = TEMP;
      312     5522
      313     5523    3               CASE(8 /* OPT_SETS */);
      314     5524    3                 SUBLK$ = SUBLK$ -> OUT$BLK.SUBLK$(0);
      315     5525    3                 IF SUBLK$ -> OUT$SYM.CODE = 1 /* NO */ THEN
      316     5526    4                   DO;
      317     5527    4                     SETS_FLAG = '0'B;
      318     5528    4                   END;
      319     5529    3                 ELSE
      320     5530    4                   DO;
      321     5531    4                     SETS_FLAG = '1'B;
      322     5532    4                   END;
      323     5533
      324     5534    3               CASE(9 /* OPT_JOURNAL */);
      325     5535    3                 SUBLK$ = SUBLK$ -> OUT$BLK.SUBLK$(0);
      326     5536    3                 IF SUBLK$ -> OUT$SYM.CODE = 1 /* NO */ THEN
      327     5537    4                   DO;
      328     5538    4                     QT$ENTRY.FLAGS.JOURNAL = '0'B;
      329     5539    4                   END;
      330     5540    3                 ELSE
      331     5541    4                   DO;
      332     5542    4                     QT$ENTRY.FLAGS.JOURNAL = '1'B;
      333     5543    4                   END;
      334     5544
      335     5545    3               CASE(2 /* OPT_TPAP */);
      336     5546    3                 SUBLK$ = SUBLK$ -> OUT$BLK.SUBLK$(0);
      337     5547    3                 FID = SUBLK$ -> OUT$SYM.TEXT;
      338     5548    3                 CALL M$FID(FPT_FID) ALTRET(TPAP_ERR);
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:13   
      339     5549
      340     5550    3                 IF FPT_OPEN.V.ASN# ~= 1 /* FILE# */THEN
      341     5551    4                   DO;
      342     5552    4                     QT_CMDBLK.MINOR_ERR = CODE_TMBOD;
      343     5553    4                     CALL XUR$ERRMSG(CODE_TMBOD);
      344     5554    4                     REC_OK_FLAG = '0'B;
      345     5555    4                   END;
      346     5556
      347     5557    4                 DO WHILE('0'B);
      348     5558
      349     5559    4   TPAP_ERR:
      350     5560    4                   QT_CMDBLK.MINOR_ERR = CODE_BFFT;
      351     5561    4                   CALL XUR$ERRMSG(CODE_BFFT);
      352     5562    4                   REC_OK_FLAG = '0'B;
      353     5563    4                 END /* NEVER */;
      354     5564
      355     5565    3                 QT$ENTRY.TPAP.NAME = VLP_NAME;
      356     5566    3                 QT$ENTRY.TPAP.ACCT = VLP_ACCT.ACCT#;
      357     5567    3                 QT$ENTRY.TPAP.PASS = VLP_PASS.PASS#;
      358     5568    3                 QT$ENTRY.TPAP.SN = VLP_SN.SN#(0);
      359     5569
      360     5570    3             END /* CASE */;
      361     5571
      362     5572    2   LOOP:
      363     5573    2           END /* Do for each sub option */;
      364     5574
      365     5575    1           IF QT$ENTRY.TPAP.NAME.COUNT = 0 THEN
      366     5576    2             DO;
      367     5577    2               QT_CMDBLK.MINOR_ERR = CODE_NTPAP;
      368     5578    2               CALL XUR$ERRMSG(CODE_NTPAP);
      369     5579    2               REC_OK_FLAG = '0'B;
      370     5580    2             END;
      371     5581
      372     5582    1           IF (SETS_FLAG AND REC_OK_FLAG) OR
      373     5583    1               (SETS_FLAG AND B$JIT.MODE = 1) THEN
      374     5584    2             DO;
      375     5585    2               CALL QTA$READ_SET(MSGTYP);
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:14   
      376     5586    2             END;
      377     5587
      378     5588    1           IF REC_OK_FLAG THEN
      379     5589    2             DO;
      380     5590    2               CALL QTC$WRITE_TRADER(MSGTYP, 1 /* TYPE_E */);
      381     5591    2             END;
      382     5592
      383     5593    1           RETURN;
      384     5594
      385     5595    1   END QTB$CREMOD_E;

PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:15   
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   QT_SUBS_C.:E05TOU  is referenced.
   QT_MACROS_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QT_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   QT_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QTB$CREMOD_E.

   Procedure QTB$CREMOD_E requires 410 words for executable code.
   Procedure QTB$CREMOD_E requires 22 words of local(AUTO) storage.

    No errors detected in file QTB$CREMOD_E.:E05TSI    .

PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:16   

 Object Unit name= QTB$CREMOD_E                               File name= QTB$CREMOD_E.:E05TOU
 UTS= JUL 30 '97 05:46:39.76 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none   136    210  QTB$CREMOD_E
    2  RoData even  UTS     67    103  QTB$CREMOD_E
    3   Proc  even  none   410    632  QTB$CREMOD_E
    4  RoData even  none    19     23  QTB$CREMOD_E

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        0  QTB$CREMOD_E

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       7 XUR$ERRMSG
 yes     yes           Std       3 QTC$READ_TRADER
 yes     yes           Std       2 XUR$ERRPTR
         yes           Std       2 QTC$WRITE_TRADER
         yes           Std       1 QTA$READ_SET
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:17   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  QT_GLOBAL                             QT_CMDBLK
     B$JIT$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:18   


        1        1        /*M* QTB$CREMOD_E - Perform  CREATE / MODIFY ENTRY  commands */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QTB$CREMOD_E:
        9        9                PROC;

      9  3 000000   000000 700200 xent  QTB$CREMOD_E TSX0  ! X66_AUTO_0
         3 000001   000026 000000                    ZERO    22,0

       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE B$JIT;
       16      440        %INCLUDE QT_DATA_R;
       17      454        %INCLUDE CP_6_SUBS;
       18      994        %INCLUDE QT_PERR_C;
       19     1045        %INCLUDE Q_ERRCODE_C;
       20     1068        %INCLUDE QT_MACROS_C;
       21     1226        %INCLUDE QT_SUBS_C;
       22     1310        %INCLUDE XU_MACRO_C;
       23     4416        %PAGE(ARG="Externally defined routines");

              4433    1   /***************************************************************************
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:19   
              4434    1    *                                                                         *
              4435    1    *                        Externally defined routines                      *
              4436    1    *                                                                         *
              4437    1    ***************************************************************************/

       24     4441    1   DCL QTA$READ_SET ENTRY(1);
       25     4442    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
       26     4443    1   DCL QTC$READ_TRADER ENTRY(3) ALTRET;
       27     4444    1   DCL QTC$WRITE_TRADER ENTRY(2);
       28     4445    1   DCL XUR$ERRPTR ENTRY(2) ALTRET;
       29     4446        %PAGE(ARG="Symrefs");

              4463    1   /***************************************************************************
              4464    1    *                                                                         *
              4465    1    *                                  Symrefs                                *
              4466    1    *                                                                         *
              4467    1    ***************************************************************************/

       30     4471    1   DCL B$JIT$ PTR SYMREF;
       31     4472        %PAGE(ARG="Based");

              4489    1   /***************************************************************************
              4490    1    *                                                                         *
              4491    1    *                                   Based                                 *
              4492    1    *                                                                         *
              4493    1    ***************************************************************************/

       32     4497        %QT$ENTRY;
       33     4551        %PARSE$SYM(STCLASS=BASED);
       34     4589        %PARSE$OUT(STCLASS=BASED);
       35     4634        %PAGE(ARG="Static");

              4651    1   /***************************************************************************
              4652    1    *                                                                         *
              4653    1    *                                   Static                                *
              4654    1    *                                                                         *
              4655    1    ***************************************************************************/
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:20   

       36     4659    1   DCL FID CHAR(100) STATIC;
       37     4660        %PAGE(ARG="Constant");

              4677    1   /***************************************************************************
              4678    1    *                                                                         *
              4679    1    *                                  Constant                               *
              4680    1    *                                                                         *
              4681    1    ***************************************************************************/

       38     4685        %VLP_CGCP(FPTN=VLP_CGCP_C, MXACT=9999, STCLASS=CONSTANT);
       39     4728        %VLP_CGTYPL(FPTN=VLP_CGTYPL_C, STCLASS=CONSTANT);
       40     4753        %QT$ENTRY(FPTN=QT_ENTRY_C, STCLASS=CONSTANT);
       41     4807        %PAGE(ARG="Auto");

              4824    1   /***************************************************************************
              4825    1    *                                                                         *
              4826    1    *                                    Auto                                 *
              4827    1    *                                                                         *
              4828    1    ***************************************************************************/

       42     4832    1   DCL MSGTYP CHAR(8);
       43     4833    1   DCL FOUND_MSGTYP CHAR(8);
       44     4834
       45     4835    1   DCL REC_OK_FLAG BIT(1) ALIGNED;
       46     4836    1   DCL SETS_FLAG BIT(1) ALIGNED;
       47     4837
       48     4838    1   DCL SUBLK$ PTR;
       49     4839
       50     4840    1   DCL NSUBLKS UBIN WORD;
       51     4841    1   DCL I UBIN WORD;
       52     4842    1   DCL SUB_CODE UBIN WORD;
       53     4843    1   DCL POS UBIN WORD;
       54     4844    1   DCL TEMP UBIN WORD;
       55     4845    1   DCL CPOS UBIN WORD;
       56     4846
       57     4847    1   DCL OPTIONS_USED(0:35) BIT(1) UNAL;
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:21   
       58     4848    1   DCL ALL_OPTIONS REDEF OPTIONS_USED BIT(36);
       59     4849        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:22   
              4866    1   /***************************************************************************
              4867    1    *                                                                         *
              4868    1    *                                Error codes                              *
              4869    1    *                                                                         *
              4870    1    ***************************************************************************/

       60     4874        %ERRCODE(NAME=CODE_NWH, CODE#=%E$NWH, FCG#=%FCG_QT, MID#=%MID_B);
       61     4881        %ERRCODE(NAME=CODE_AE, CODE#=%E$AE, FCG#=%FCG_QT, MID#=%MID_B);
       62     4888        %ERRCODE(NAME=CODE_CMNF, CODE#=%E$CMNF, FCG#=%FCG_QT, MID#=%MID_B);
       63     4895        %ERRCODE(NAME=CODE_AUSED, CODE#=%E$AUSED, FCG#=%FCG_QT, MID#=%MID_B);
       64     4902        %ERRCODE(NAME=CODE_DTL, CODE#=%E$DTL, FCG#=%FCG_QT, MID#=%MID_B);
       65     4909        %ERRCODE(NAME=CODE_ON, CODE#=%E$ON, FCG#=%FCG_QT, MID#=%MID_B);
       66     4916        %ERRCODE(NAME=CODE_IDN, CODE#=%E$IDN, FCG#=%FCG_QT, MID#=%MID_B);
       67     4923        %ERRCODE(NAME=CODE_PTS, CODE#=%E$PTS, FCG#=%FCG_QT, MID#=%MID_B);
       68     4930        %ERRCODE(NAME=CODE_PTB, CODE#=%E$PTB, FCG#=%FCG_QT, MID#=%MID_B);
       69     4937        %ERRCODE(NAME=CODE_TMBOD, CODE#=%E$TMBOD, FCG#=%FCG_QT, MID#=%MID_B);
       70     4944        %ERRCODE(NAME=CODE_BFFT, CODE#=%E$BFFT, FCG#=%FCG_QT, MID#=%MID_B);
       71     4951        %ERRCODE(NAME=CODE_NTPAP, CODE#=%E$NTPAP, FCG#=%FCG_QT, MID#=%MID_B);
       72     4958        %ERRCODE(NAME=CODE_BAD_MAXACTIVE, CODE#=%E$BAD_MAXACTIVE, FCG#=%FCG_QT,
       73     4959        MID#=%MID_B);
       74     4966        /*E*       ERROR: QTB-E$AE-C
       75     4967
       76     4968                 MESSAGE: Can't create; that type already exists.
       77     4969             DESCRIPTION: An attempt was made to create a type that
       78     4970                          already exists.
       79     4971        */
       80     4972        /*E*       ERROR: QTB-E$CMNF-C
       81     4973
       82     4974                 MESSAGE: Can't modify; that type does not exist.
       83     4975             DESCRIPTION: An attempt has been made to modify a type
       84     4976                          that does not exist
       85     4977        */
       86     4978        /*E*       ERROR: QTB-E$AUSED-C
       87     4979
       88     4980                 MESSAGE: This option has been used more than once.
       89     4981                          The most recent value specified has been used.
       90     4982             DESCRIPTION: There should be no reason to use the same
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:23   
       91     4983                          option more than once.
       92     4984        */
       93     4985        /*E*       ERROR: QTB-E$DTL-C
       94     4986
       95     4987                 MESSAGE: Debugger name too long.  Debugger names are
       96     4988                          limited to 11 characters.
       97     4989             DESCRIPTION: The debugger name is too long to be legal.
       98     4990        */
       99     4991        /*E*       ERROR: QTB-E$ON-C
      100     4992
      101     4993                 MESSAGE: A DEBUGGER name is not a FID; you may only
      102     4994                          specify a name.
      103     4995             DESCRIPTION: Some other piece of a FID in addition to
      104     4996                          a name was found.  Only a name may be used.
      105     4997        */
      106     4998        /*E*       ERROR: QTB-E$IDN-C
      107     4999
      108     5000                 MESSAGE: Invalid debugger name
      109     5001             DESCRIPTION: Invalid name was specified for the debugger
      110     5002        */
      111     5003        /*E*       ERROR: QTB-E$PTS-C
      112     5004
      113     5005                 MESSAGE: Priority is less than the minimum (1).  The
      114     5006                          minimum has been substituted.
      115     5007             DESCRIPTION: A priority must be > 1 & < 501
      116     5008        */
      117     5009        /*E*       ERROR: QTB-E$PTB-C
      118     5010
      119     5011                 MESSAGE: Priority is greater than the maximum (500).
      120     5012                          The maximum has been substituted.
      121     5013             DESCRIPTION: A priority must be > 1 & < 501
      122     5014        */
      123     5015        /*E*       ERROR: QTB-E$BFFT-C
      124     5016
      125     5017                 MESSAGE: Invalid FID for the TPAP
      126     5018             DESCRIPTION: The FID for the TPAP is not a valid FID
      127     5019        */
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:24   
      128     5020        /*E*       ERROR: QTB-E$NTPAP-C
      129     5021
      130     5022                 MESSAGE: A TPAP must be specified.
      131     5023             DESCRIPTION: The TPAP is required.  Please specify a
      132     5024                          valid run unit FID for the TPAP.
      133     5025        */
      134     5026        /*E*       ERROR: QTB-E$TMBOD-C
      135     5027
      136     5028                 MESSAGE: TPAPs must be on disk.
      137     5029             DESCRIPTION: The FID for a TPAP must be a file that resides
      138     5030                          on disk.
      139     5031        */
      140     5032        /*E*       ERROR: QTB-E$BAD_MAXACTIVE-C
      141     5033
      142     5034                 MESSAGE: MAXACTIVE must be between 0 and 9999
      143     5035             DESCRIPTION: The value for MAXACTIVE was out of range.
      144     5036        */
      145     5037        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:25   
              5054    1   /***************************************************************************
              5055    1    *                                                                         *
              5056    1    *                                    FPTs                                 *
              5057    1    *                                                                         *
              5058    1    ***************************************************************************/

      146     5062        %FPT_OPEN;
      147     5171
      148     5172        %FPT_FID(NAME=VLP_NAME, PASS=VLP_PASS, RESULTS=VLR_FID,
      149     5173        ACCT=VLP_ACCT, ASN="FPT_OPEN.V.ASN#", SN=VLP_SN,
      150     5174        RES="FPT_OPEN.V.RES#", WSN=VLP_WSN, TEXTFID=FID);
      151     5197        %PAGE(ARG="VLPs");

              5214    1   /***************************************************************************
              5215    1    *                                                                         *
              5216    1    *                                    VLPs                                 *
              5217    1    *                                                                         *
              5218    1    ***************************************************************************/

      152     5222        %VLP_NAME;
      153     5249        %VLP_PASS;
      154     5262        %VLP_ACCT;
      155     5275        %VLP_SN;
      156     5288        %VLP_WSN;
      157     5301        %PAGE(ARG="VLRs");

              5318    1   /***************************************************************************
              5319    1    *                                                                         *
              5320    1    *                                    VLRs                                 *
              5321    1    *                                                                         *
              5322    1    ***************************************************************************/

      158     5326        %VLR_FID;
      159     5345        %PAGE(ARG="QTB$CREMOD_E", PAGE=YES);

PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:26   
              5362    1   /***************************************************************************
              5363    1    *                                                                         *
              5364    1    *                                QTB$CREMOD_E                             *
              5365    1    *                                                                         *
              5366    1    ***************************************************************************/

      160     5370    1           SETS_FLAG = '0'B;

   5370  3 000002   200010 450100                    STZ     SETS_FLAG,,AUTO

      161     5371    1           REC_OK_FLAG = '1'B;

   5371  3 000003   400000 236003                    LDQ     -131072,DU
         3 000004   200007 756100                    STQ     REC_OK_FLAG,,AUTO

      162     5372    1           NSUBLKS = QT_CMDBLK.OUT$ -> OUT$BLK.NSUBLKS - 1;

   5372  3 000005   000004 470400 xsym               LDP0    QT_CMDBLK+4
         3 000006   000001 236100                    LDQ     1,,PR0
         3 000007   000022 772000                    QRL     18
         3 000010   000001 136007                    SBLQ    1,DL
         3 000011   200012 756100                    STQ     NSUBLKS,,AUTO

      163     5373    1           ALL_OPTIONS = '0'B;

   5373  3 000012   200020 450100                    STZ     OPTIONS_USED,,AUTO

      164     5374
      165     5375    1           MSGTYP = QT_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT;

   5375  3 000013   000003 471500                    LDP1    3,,PR0
         3 000014   100004 236100                    LDQ     4,,PR1
         3 000015   000033 772000                    QRL     27
         3 000016   000000 620006                    EAX0    0,QL
         3 000017   040100 100540                    MLR     fill='040'O
         3 000020   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         3 000021   200003 000010                    ADSC9   MSGTYP,,AUTO             cn=0,n=8
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:27   

      166     5376
      167     5377    1           CALL INDEX(POS, '?', MSGTYP) ALTRET(NO_Q);

   5377  3 000022   000000 124500                    SCM     mask='000'O
         3 000023   200003 000010                    ADSC9   MSGTYP,,AUTO             cn=0,n=8
         3 000024   000000 000001 4                  ADSC9   0                        cn=0,n=1
         3 000025   200015 000100                    ARG     POS,,AUTO
         3 000026   000036 606400 3                  TTN     NO_Q

      168     5378    1           QT_CMDBLK.MINOR_ERR = CODE_NWH;

   5378  3 000027   000066 236000 2                  LDQ     CODE_NWH
         3 000030   000001 756000 xsym               STQ     QT_CMDBLK+1

      169     5379    1           CALL XUR$ERRMSG(CODE_NWH);

   5379  3 000031   000001 630400 4                  EPPR0   1
         3 000032   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000033   000000 701000 xent               TSX1    XUR$ERRMSG
         3 000034   000000 011000                    NOP     0

      170     5380    1           REC_OK_FLAG = '0'B;

   5380  3 000035   200007 450100                    STZ     REC_OK_FLAG,,AUTO

      171     5381
      172     5382    1   NO_Q:
      173     5383    1           CALL QTC$READ_TRADER(MSGTYP, 1 /* TYPE_E */, FOUND_MSGTYP)

   5383  3 000036   200005 630500       NO_Q         EPPR0   FOUND_MSGTYP,,AUTO
         3 000037   200024 450500                    STP0    OPTIONS_USED+4,,AUTO
         3 000040   000002 236000 4                  LDQ     2
         3 000041   200023 756100                    STQ     OPTIONS_USED+3,,AUTO
         3 000042   200003 631500                    EPPR1   MSGTYP,,AUTO
         3 000043   200022 451500                    STP1    OPTIONS_USED+2,,AUTO
         3 000044   200022 630500                    EPPR0   OPTIONS_USED+2,,AUTO
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:28   
         3 000045   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000046   000000 701000 xent               TSX1    QTC$READ_TRADER
         3 000047   000076 702000 3                  TSX2    NOT_FOUND

      174     5384    1               ALTRET(NOT_FOUND);
      175     5385
      176     5386    1           IF QT_CMDBLK.CODE = 2 /* CREATE_ENTRY */ THEN

   5386  3 000050   000005 235000 xsym               LDA     QT_CMDBLK+5
         3 000051   000002 115007                    CMPA    2,DL
         3 000052   000075 601000 3                  TNZ     s:5397

      177     5387    2             DO;

      178     5388    2               QT_CMDBLK.MINOR_ERR = CODE_AE;

   5388  3 000053   000067 236000 2                  LDQ     CODE_AE
         3 000054   000001 756000 xsym               STQ     QT_CMDBLK+1

      179     5389    2               CALL XUR$ERRMSG(CODE_AE);

   5389  3 000055   000003 630400 4                  EPPR0   3
         3 000056   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000057   000000 701000 xent               TSX1    XUR$ERRMSG
         3 000060   000000 011000                    NOP     0

      180     5390    2               REC_OK_FLAG = '0'B;

   5390  3 000061   200007 450100                    STZ     REC_OK_FLAG,,AUTO

      181     5391
      182     5392    2               QT$ENTRY = QT_ENTRY_C;

   5392  3 000062   000031 470400 xsym               LDP0    QT_GLOBAL+25
         3 000063   000100 100400                    MLR     fill='000'O
         3 000064   000034 000150 2                  ADSC9   QT_ENTRY_C               cn=0,n=104
         3 000065   000000 000150                    ADSC9   0,,PR0                   cn=0,n=104
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:29   

      183     5393    2               QT$ENTRY.MAXACTIVE = VLP_CGCP_C.MXACT#;

   5393  3 000066   000031 470400 xsym               LDP0    QT_GLOBAL+25
         3 000067   000005 235000 2                  LDA     VLP_CGCP_C+5
         3 000070   000002 755100                    STA     2,,PR0

      184     5394    2               QT$ENTRY.PRIO = VLP_CGTYPL_C.LIST.PRIO#(0);

   5394  3 000071   000031 470400 xsym               LDP0    QT_GLOBAL+25
         3 000072   000027 236000 2                  LDQ     VLP_CGTYPL_C+3
         3 000073   000033 772000                    QRL     27
         3 000074   000023 552104                    STBQ    19,'04'O,PR0

      185     5395    2             END;

      186     5396
      187     5397    2           DO WHILE('0'B);

   5397  3 000075   000123 710000 3                  TRA     s:5412

      188     5398
      189     5399    2   NOT_FOUND:
      190     5400    2             IF QT_CMDBLK.CODE = 12 /* MODIFY_ENTRY */ THEN

   5400  3 000076   000005 235000 xsym  NOT_FOUND    LDA     QT_CMDBLK+5
         3 000077   000014 115007                    CMPA    12,DL
         3 000100   000110 601000 3                  TNZ     s:5407

      191     5401    3               DO;

      192     5402    3                 QT_CMDBLK.MINOR_ERR = CODE_CMNF;

   5402  3 000101   000070 236000 2                  LDQ     CODE_CMNF
         3 000102   000001 756000 xsym               STQ     QT_CMDBLK+1

      193     5403    3                 CALL XUR$ERRMSG(CODE_CMNF);
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:30   

   5403  3 000103   000004 630400 4                  EPPR0   4
         3 000104   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000105   000000 701000 xent               TSX1    XUR$ERRMSG
         3 000106   000000 011000                    NOP     0

      194     5404    3                 REC_OK_FLAG = '0'B;

   5404  3 000107   200007 450100                    STZ     REC_OK_FLAG,,AUTO

      195     5405    3               END;

      196     5406
      197     5407    2             QT$ENTRY = QT_ENTRY_C;

   5407  3 000110   000031 470400 xsym               LDP0    QT_GLOBAL+25
         3 000111   000100 100400                    MLR     fill='000'O
         3 000112   000034 000150 2                  ADSC9   QT_ENTRY_C               cn=0,n=104
         3 000113   000000 000150                    ADSC9   0,,PR0                   cn=0,n=104

      198     5408    2             QT$ENTRY.MAXACTIVE = VLP_CGCP_C.MXACT#;

   5408  3 000114   000031 470400 xsym               LDP0    QT_GLOBAL+25
         3 000115   000005 235000 2                  LDA     VLP_CGCP_C+5
         3 000116   000002 755100                    STA     2,,PR0

      199     5409    2             QT$ENTRY.PRIO = VLP_CGTYPL_C.LIST.PRIO#(0);

   5409  3 000117   000031 470400 xsym               LDP0    QT_GLOBAL+25
         3 000120   000027 236000 2                  LDQ     VLP_CGTYPL_C+3
         3 000121   000033 772000                    QRL     27
         3 000122   000023 552104                    STBQ    19,'04'O,PR0

      200     5410    2           END /* NEVER */;

      201     5411
      202     5412    2           DO I = 1 TO NSUBLKS;
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:31   

   5412  3 000123   000001 235007                    LDA     1,DL
         3 000124   200013 755100                    STA     I,,AUTO
         3 000125   000560 710000 3                  TRA     LOOP+3

      203     5413    2             SUBLK$ = QT_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(I);

   5413  3 000126   000004 470400 xsym               LDP0    QT_CMDBLK+4
         3 000127   200013 720100                    LXL0    I,,AUTO
         3 000130   000003 236110                    LDQ     3,X0,PR0
         3 000131   200011 756100                    STQ     SUBLK$,,AUTO

      204     5414    2             SUB_CODE = SUBLK$ -> OUT$SYM.CODE;

   5414  3 000132   200011 471500                    LDP1    SUBLK$,,AUTO
         3 000133   100000 236100                    LDQ     0,,PR1
         3 000134   777777 376007                    ANQ     -1,DL
         3 000135   200014 756100                    STQ     SUB_CODE,,AUTO

      205     5415    2             IF OPTIONS_USED(SUB_CODE) THEN

   5415  3 000136   000000 066506                    CMPB    filb='0'B
         3 000137   200020 000001                    BDSC    OPTIONS_USED,Q,AUTO      by=0,bit=0,n=1
         3 000140   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000141   000162 600000 3                  TZE     s:5423

      206     5416    3               DO;

      207     5417    3                 CPOS = SUBLK$ -> OUT$SYM.CPOS;

   5417  3 000142   100002 235100                    LDA     2,,PR1
         3 000143   200017 755100                    STA     CPOS,,AUTO

      208     5418    3                 CALL XUR$ERRPTR(CPOS, QT_GLOBAL.M$DO#);

   5418  3 000144   000005 236000 4                  LDQ     5
         3 000145   200023 756100                    STQ     OPTIONS_USED+3,,AUTO
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:32   
         3 000146   200017 633500                    EPPR3   CPOS,,AUTO
         3 000147   200022 453500                    STP3    OPTIONS_USED+2,,AUTO
         3 000150   200022 630500                    EPPR0   OPTIONS_USED+2,,AUTO
         3 000151   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000152   000000 701000 xent               TSX1    XUR$ERRPTR
         3 000153   000000 011000                    NOP     0

      209     5419    3                 QT_CMDBLK.MINOR_ERR = CODE_AUSED;

   5419  3 000154   000071 236000 2                  LDQ     CODE_AUSED
         3 000155   000001 756000 xsym               STQ     QT_CMDBLK+1

      210     5420    3                 CALL XUR$ERRMSG(CODE_AUSED);

   5420  3 000156   000006 630400 4                  EPPR0   6
         3 000157   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000160   000000 701000 xent               TSX1    XUR$ERRMSG
         3 000161   000000 011000                    NOP     0

      211     5421    3               END;

      212     5422
      213     5423    2             OPTIONS_USED(SUB_CODE) = '1'B;

   5423  3 000162   200014 235100                    LDA     SUB_CODE,,AUTO
         3 000163   003105 060400                    CSL     bolr='003'O
         3 000164   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         3 000165   200020 000001                    BDSC    OPTIONS_USED,A,AUTO      by=0,bit=0,n=1

      214     5424
      215     5425    3             DO CASE(SUB_CODE);

   5425  3 000166   000012 115007                    CMPA    10,DL
         3 000167   000171 602005 3                  TNC     s:5425+3,AL
         3 000170   000555 710000 3                  TRA     LOOP
         3 000171   000555 710000 3                  TRA     LOOP
         3 000172   000555 710000 3                  TRA     LOOP
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:33   
         3 000173   000474 710000 3                  TRA     s:5546
         3 000174   000375 710000 3                  TRA     s:5504
         3 000175   000306 710000 3                  TRA     s:5468
         3 000176   000325 710000 3                  TRA     s:5479
         3 000177   000344 710000 3                  TRA     s:5490
         3 000200   000203 710000 3                  TRA     s:5428
         3 000201   000441 710000 3                  TRA     s:5524
         3 000202   000455 710000 3                  TRA     s:5535

      216     5426
      217     5427    3               CASE(7 /* OPT_DEBUGGER */);

      218     5428    3                 SUBLK$ = SUBLK$ -> OUT$BLK.SUBLK$(0);

   5428  3 000203   200011 470500                    LDP0    SUBLK$,,AUTO
         3 000204   000003 236100                    LDQ     3,,PR0
         3 000205   200011 756100                    STQ     SUBLK$,,AUTO

      219     5429    3                 IF SUBLK$ -> OUT$SYM.COUNT = 0 THEN

   5429  3 000206   200011 470500                    LDP0    SUBLK$,,AUTO
         3 000207   000004 236100                    LDQ     4,,PR0
         3 000210   777000 316003                    CANQ    -512,DU
         3 000211   000222 601000 3                  TNZ     s:5436

      220     5430    4                   DO;

      221     5431    4                     QT$ENTRY.DEBUGGER.COUNT = 0;

   5431  3 000212   000031 471400 xsym               LDP1    QT_GLOBAL+25
         3 000213   000000 236003                    LDQ     0,DU
         3 000214   100020 552110                    STBQ    16,'10'O,PR1

      222     5432    4                     QT$ENTRY.DEBUGGER.TEXT = ' ';

   5432  3 000215   000031 471400 xsym               LDP1    QT_GLOBAL+25
         3 000216   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:34   
         3 000217   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000220   100020 600013                    ADSC9   16,,PR1                  cn=3,n=11

      223     5433    4                     GOTO LOOP;

   5433  3 000221   000555 710000 3                  TRA     LOOP

      224     5434    4                   END;
      225     5435
      226     5436    3                 FID = SUBLK$ -> OUT$SYM.TEXT;

   5436  3 000222   000004 236100                    LDQ     4,,PR0
         3 000223   000033 772000                    QRL     27
         3 000224   000000 620006                    EAX0    0,QL
         3 000225   040000 100540                    MLR     fill='040'O
         3 000226   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         3 000227   000000 000144 1                  ADSC9   FID                      cn=0,n=100

      227     5437    3                 CALL M$FID(FPT_FID) ALTRET(DEBUGGER_ERR);

   5437  3 000230   000124 630400 1                  EPPR0   FPT_FID
         3 000231   420001 713400                    CLIMB   alt,+8193
         3 000232   404400 401760                    pmme    nvectors=10
         3 000233   000272 702000 3                  TSX2    DEBUGGER_ERR

      228     5438
      229     5439    3                 IF VLP_NAME.L# > 11 THEN

   5439  3 000234   000154 236000 1                  LDQ     VLP_NAME
         3 000235   777000 376003                    ANQ     -512,DU
         3 000236   014000 116003                    CMPQ    6144,DU
         3 000237   000247 602000 3                  TNC     s:5446

      230     5440    4                   DO;

      231     5441    4                     QT_CMDBLK.MINOR_ERR = CODE_DTL;

PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:35   
   5441  3 000240   000072 236000 2                  LDQ     CODE_DTL
         3 000241   000001 756000 xsym               STQ     QT_CMDBLK+1

      232     5442    4                     CALL XUR$ERRMSG(CODE_DTL);

   5442  3 000242   000007 630400 4                  EPPR0   7
         3 000243   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000244   000000 701000 xent               TSX1    XUR$ERRMSG
         3 000245   000000 011000                    NOP     0

      233     5443    4                     REC_OK_FLAG = '0'B;

   5443  3 000246   200007 450100                    STZ     REC_OK_FLAG,,AUTO

      234     5444    4                   END;

      235     5445
      236     5446    3                 IF VLR_FID.ACCT OR

   5446  3 000247   000176 236000 1                  LDQ     VLR_FID
         3 000250   200000 316003                    CANQ    65536,DU
         3 000251   000262 601000 3                  TNZ     s:5452
         3 000252   100000 316003                    CANQ    32768,DU
         3 000253   000262 601000 3                  TNZ     s:5452
         3 000254   040000 316003                    CANQ    16384,DU
         3 000255   000262 601000 3                  TNZ     s:5452
         3 000256   020000 316003                    CANQ    8192,DU
         3 000257   000262 601000 3                  TNZ     s:5452
         3 000260   004000 316003                    CANQ    2048,DU
         3 000261   000271 600000 3                  TZE     s:5457

      237     5447    3                     VLR_FID.PASS OR
      238     5448    3                     VLR_FID.SN OR
      239     5449    3                     VLR_FID.WSN OR
      240     5450    3                     VLR_FID.RES THEN
      241     5451    4                   DO;

PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:36   
      242     5452    4                     QT_CMDBLK.MINOR_ERR = CODE_ON;

   5452  3 000262   000073 236000 2                  LDQ     CODE_ON
         3 000263   000001 756000 xsym               STQ     QT_CMDBLK+1

      243     5453    4                     CALL XUR$ERRMSG(CODE_ON);

   5453  3 000264   000010 630400 4                  EPPR0   8
         3 000265   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000266   000000 701000 xent               TSX1    XUR$ERRMSG
         3 000267   000000 011000                    NOP     0

      244     5454    4                     REC_OK_FLAG = '0'B;

   5454  3 000270   200007 450100                    STZ     REC_OK_FLAG,,AUTO

      245     5455    4                   END;

      246     5456
      247     5457    4                 DO WHILE('0'B);

   5457  3 000271   000301 710000 3                  TRA     s:5465

      248     5458
      249     5459    4   DEBUGGER_ERR:
      250     5460    4                   QT_CMDBLK.MINOR_ERR = CODE_IDN;

   5460  3 000272   000074 236000 2     DEBUGGER_ERR LDQ     CODE_IDN
         3 000273   000001 756000 xsym               STQ     QT_CMDBLK+1

      251     5461    4                   CALL XUR$ERRMSG(CODE_IDN);

   5461  3 000274   000011 630400 4                  EPPR0   9
         3 000275   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000276   000000 701000 xent               TSX1    XUR$ERRMSG
         3 000277   000000 011000                    NOP     0

PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:37   
      252     5462    4                   REC_OK_FLAG = '0'B;

   5462  3 000300   200007 450100                    STZ     REC_OK_FLAG,,AUTO

      253     5463    4                 END /* NEVER */;

      254     5464
      255     5465    3                 QT$ENTRY.DEBUGGER = VLP_NAME;

   5465  3 000301   000031 470400 xsym               LDP0    QT_GLOBAL+25
         3 000302   000100 100400                    MLR     fill='000'O
         3 000303   000154 000014 1                  ADSC9   VLP_NAME                 cn=0,n=12
         3 000304   000020 400014                    ADSC9   16,,PR0                  cn=2,n=12
         3 000305   000555 710000 3                  TRA     LOOP

      256     5466
      257     5467    3               CASE(4 /* OPT_LOCK */);

      258     5468    3                 SUBLK$ = SUBLK$ -> OUT$BLK.SUBLK$(0);

   5468  3 000306   200011 470500                    LDP0    SUBLK$,,AUTO
         3 000307   000003 236100                    LDQ     3,,PR0
         3 000310   200011 756100                    STQ     SUBLK$,,AUTO

      259     5469    3                 IF SUBLK$ -> OUT$SYM.CODE = 1 /* NO */ THEN

   5469  3 000311   200011 470500                    LDP0    SUBLK$,,AUTO
         3 000312   000000 720100                    LXL0    0,,PR0
         3 000313   000001 100003                    CMPX0   1,DU
         3 000314   000321 601000 3                  TNZ     s:5475

      260     5470    4                   DO;

      261     5471    4                     QT$ENTRY.FLAGS.NEW_LOCK = '0'B;

   5471  3 000315   000031 471400 xsym               LDP1    QT_GLOBAL+25
         3 000316   000012 236000 4                  LDQ     10
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:38   
         3 000317   100000 356100                    ANSQ    0,,PR1

      262     5472    4                   END;

   5472  3 000320   000555 710000 3                  TRA     LOOP

      263     5473    3                 ELSE
      264     5474    4                   DO;

      265     5475    4                     QT$ENTRY.FLAGS.NEW_LOCK = '1'B;

   5475  3 000321   000031 471400 xsym               LDP1    QT_GLOBAL+25
         3 000322   100000 236003                    LDQ     32768,DU
         3 000323   100000 256100                    ORSQ    0,,PR1

      266     5476    4                   END;

   5476  3 000324   000555 710000 3                  TRA     LOOP

      267     5477
      268     5478    3               CASE(5 /* OPT_MESSAGE */);

      269     5479    3                 SUBLK$ = SUBLK$ -> OUT$BLK.SUBLK$(0);

   5479  3 000325   200011 470500                    LDP0    SUBLK$,,AUTO
         3 000326   000003 236100                    LDQ     3,,PR0
         3 000327   200011 756100                    STQ     SUBLK$,,AUTO

      270     5480    3                 IF SUBLK$ -> OUT$SYM.CODE = 1 /* NO */ THEN

   5480  3 000330   200011 470500                    LDP0    SUBLK$,,AUTO
         3 000331   000000 720100                    LXL0    0,,PR0
         3 000332   000001 100003                    CMPX0   1,DU
         3 000333   000340 601000 3                  TNZ     s:5486

      271     5481    4                   DO;

PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:39   
      272     5482    4                     QT$ENTRY.FLAGS.MESSAGE = '0'B;

   5482  3 000334   000031 471400 xsym               LDP1    QT_GLOBAL+25
         3 000335   000013 236000 4                  LDQ     11
         3 000336   100000 356100                    ANSQ    0,,PR1

      273     5483    4                   END;

   5483  3 000337   000555 710000 3                  TRA     LOOP

      274     5484    3                 ELSE
      275     5485    4                   DO;

      276     5486    4                     QT$ENTRY.FLAGS.MESSAGE = '1'B;

   5486  3 000340   000031 471400 xsym               LDP1    QT_GLOBAL+25
         3 000341   040000 236003                    LDQ     16384,DU
         3 000342   100000 256100                    ORSQ    0,,PR1

      277     5487    4                   END;

   5487  3 000343   000555 710000 3                  TRA     LOOP

      278     5488
      279     5489    3               CASE(6 /* OPT_MAXACTIVE */);

      280     5490    3                 SUBLK$ = SUBLK$ -> OUT$BLK.SUBLK$(0);

   5490  3 000344   200011 470500                    LDP0    SUBLK$,,AUTO
         3 000345   000003 236100                    LDQ     3,,PR0
         3 000346   200011 756100                    STQ     SUBLK$,,AUTO

      281     5491    3                 CALL CHARBIN(TEMP, SUBLK$ -> OUT$SYM.TEXT);

   5491  3 000347   200011 470500                    LDP0    SUBLK$,,AUTO
         3 000350   000004 236100                    LDQ     4,,PR0
         3 000351   000033 772000                    QRL     27
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:40   
         3 000352   000000 620006                    EAX0    0,QL
         3 000353   000100 305540                    DTB
         3 000354   000004 230010                    NDSC9   4,,PR0                   cn=1,s=nosgn,sf=0,n=*X0
         3 000355   200022 000010                    NDSC9   OPTIONS_USED+2,,AUTO     cn=0,s=lsgnf,sf=0,n=8
         3 000356   200023 236100                    LDQ     OPTIONS_USED+3,,AUTO
         3 000357   200016 756100                    STQ     TEMP,,AUTO

      282     5492    3                 IF TEMP <= 9999 THEN

   5492  3 000360   023420 116007                    CMPQ    10000,DL
         3 000361   000365 603000 3                  TRC     s:5498

      283     5493    4                   DO;

      284     5494    4                     QT$ENTRY.MAXACTIVE = TEMP;

   5494  3 000362   000031 471400 xsym               LDP1    QT_GLOBAL+25
         3 000363   100002 756100                    STQ     2,,PR1

      285     5495    4                   END;

   5495  3 000364   000555 710000 3                  TRA     LOOP

      286     5496    3                 ELSE
      287     5497    4                   DO;

      288     5498    4                     QT_CMDBLK.MINOR_ERR = CODE_BAD_MAXACTIVE;

   5498  3 000365   000102 236000 2                  LDQ     CODE_BAD_MAXACTIVE
         3 000366   000001 756000 xsym               STQ     QT_CMDBLK+1

      289     5499    4                     CALL XUR$ERRMSG(CODE_BAD_MAXACTIVE);

   5499  3 000367   000014 630400 4                  EPPR0   12
         3 000370   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000371   000000 701000 xent               TSX1    XUR$ERRMSG
         3 000372   000000 011000                    NOP     0
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:41   

      290     5500    4                     REC_OK_FLAG = '0'B;

   5500  3 000373   200007 450100                    STZ     REC_OK_FLAG,,AUTO

      291     5501    4                   END;

   5501  3 000374   000555 710000 3                  TRA     LOOP

      292     5502
      293     5503    3               CASE(3 /* OPT_PRIO */);

      294     5504    3                 SUBLK$ = SUBLK$ -> OUT$BLK.SUBLK$(0);

   5504  3 000375   200011 470500                    LDP0    SUBLK$,,AUTO
         3 000376   000003 236100                    LDQ     3,,PR0
         3 000377   200011 756100                    STQ     SUBLK$,,AUTO

      295     5505    3                 CALL CHARBIN(TEMP, SUBLK$ -> OUT$SYM.TEXT);

   5505  3 000400   200011 470500                    LDP0    SUBLK$,,AUTO
         3 000401   000004 236100                    LDQ     4,,PR0
         3 000402   000033 772000                    QRL     27
         3 000403   000000 620006                    EAX0    0,QL
         3 000404   000100 305540                    DTB
         3 000405   000004 230010                    NDSC9   4,,PR0                   cn=1,s=nosgn,sf=0,n=*X0
         3 000406   200022 000010                    NDSC9   OPTIONS_USED+2,,AUTO     cn=0,s=lsgnf,sf=0,n=8
         3 000407   200023 236100                    LDQ     OPTIONS_USED+3,,AUTO
         3 000410   200016 756100                    STQ     TEMP,,AUTO

      296     5506
      297     5507    3                 IF TEMP < 1 THEN

   5507  3 000411   000422 601000 3                  TNZ     s:5514

      298     5508    4                   DO;

PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:42   
      299     5509    4                     QT_CMDBLK.MINOR_ERR = CODE_PTS;

   5509  3 000412   000075 236000 2                  LDQ     CODE_PTS
         3 000413   000001 756000 xsym               STQ     QT_CMDBLK+1

      300     5510    4                     CALL XUR$ERRMSG(CODE_PTS);

   5510  3 000414   000015 630400 4                  EPPR0   13
         3 000415   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000416   000000 701000 xent               TSX1    XUR$ERRMSG
         3 000417   000000 011000                    NOP     0

      301     5511    4                     TEMP = 1;

   5511  3 000420   000001 235007                    LDA     1,DL
         3 000421   200016 755100                    STA     TEMP,,AUTO

      302     5512    4                   END;

      303     5513
      304     5514    3                 IF TEMP > 500 THEN

   5514  3 000422   200016 235100                    LDA     TEMP,,AUTO
         3 000423   000765 115007                    CMPA    501,DL
         3 000424   000435 602000 3                  TNC     s:5521

      305     5515    4                   DO;

      306     5516    4                     QT_CMDBLK.MINOR_ERR = CODE_PTB;

   5516  3 000425   000076 236000 2                  LDQ     CODE_PTB
         3 000426   000001 756000 xsym               STQ     QT_CMDBLK+1

      307     5517    4                     CALL XUR$ERRMSG(CODE_PTB);

   5517  3 000427   000016 630400 4                  EPPR0   14
         3 000430   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:43   
         3 000431   000000 701000 xent               TSX1    XUR$ERRMSG
         3 000432   000000 011000                    NOP     0

      308     5518    4                     TEMP = 500;

   5518  3 000433   000764 235007                    LDA     500,DL
         3 000434   200016 755100                    STA     TEMP,,AUTO

      309     5519    4                   END;

      310     5520
      311     5521    3                 QT$ENTRY.PRIO = TEMP;

   5521  3 000435   000031 470400 xsym               LDP0    QT_GLOBAL+25
         3 000436   200016 236100                    LDQ     TEMP,,AUTO
         3 000437   000023 552104                    STBQ    19,'04'O,PR0
         3 000440   000555 710000 3                  TRA     LOOP

      312     5522
      313     5523    3               CASE(8 /* OPT_SETS */);

      314     5524    3                 SUBLK$ = SUBLK$ -> OUT$BLK.SUBLK$(0);

   5524  3 000441   200011 470500                    LDP0    SUBLK$,,AUTO
         3 000442   000003 236100                    LDQ     3,,PR0
         3 000443   200011 756100                    STQ     SUBLK$,,AUTO

      315     5525    3                 IF SUBLK$ -> OUT$SYM.CODE = 1 /* NO */ THEN

   5525  3 000444   200011 470500                    LDP0    SUBLK$,,AUTO
         3 000445   000000 720100                    LXL0    0,,PR0
         3 000446   000001 100003                    CMPX0   1,DU
         3 000447   000452 601000 3                  TNZ     s:5531

      316     5526    4                   DO;

      317     5527    4                     SETS_FLAG = '0'B;
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:44   

   5527  3 000450   200010 450100                    STZ     SETS_FLAG,,AUTO

      318     5528    4                   END;

   5528  3 000451   000555 710000 3                  TRA     LOOP

      319     5529    3                 ELSE
      320     5530    4                   DO;

      321     5531    4                     SETS_FLAG = '1'B;

   5531  3 000452   400000 236003                    LDQ     -131072,DU
         3 000453   200010 756100                    STQ     SETS_FLAG,,AUTO

      322     5532    4                   END;

   5532  3 000454   000555 710000 3                  TRA     LOOP

      323     5533
      324     5534    3               CASE(9 /* OPT_JOURNAL */);

      325     5535    3                 SUBLK$ = SUBLK$ -> OUT$BLK.SUBLK$(0);

   5535  3 000455   200011 470500                    LDP0    SUBLK$,,AUTO
         3 000456   000003 236100                    LDQ     3,,PR0
         3 000457   200011 756100                    STQ     SUBLK$,,AUTO

      326     5536    3                 IF SUBLK$ -> OUT$SYM.CODE = 1 /* NO */ THEN

   5536  3 000460   200011 470500                    LDP0    SUBLK$,,AUTO
         3 000461   000000 720100                    LXL0    0,,PR0
         3 000462   000001 100003                    CMPX0   1,DU
         3 000463   000470 601000 3                  TNZ     s:5542

      327     5537    4                   DO;

PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:45   
      328     5538    4                     QT$ENTRY.FLAGS.JOURNAL = '0'B;

   5538  3 000464   000031 471400 xsym               LDP1    QT_GLOBAL+25
         3 000465   000017 236000 4                  LDQ     15
         3 000466   100000 356100                    ANSQ    0,,PR1

      329     5539    4                   END;

   5539  3 000467   000555 710000 3                  TRA     LOOP

      330     5540    3                 ELSE
      331     5541    4                   DO;

      332     5542    4                     QT$ENTRY.FLAGS.JOURNAL = '1'B;

   5542  3 000470   000031 471400 xsym               LDP1    QT_GLOBAL+25
         3 000471   020000 236003                    LDQ     8192,DU
         3 000472   100000 256100                    ORSQ    0,,PR1

      333     5543    4                   END;

   5543  3 000473   000555 710000 3                  TRA     LOOP

      334     5544
      335     5545    3               CASE(2 /* OPT_TPAP */);

      336     5546    3                 SUBLK$ = SUBLK$ -> OUT$BLK.SUBLK$(0);

   5546  3 000474   200011 470500                    LDP0    SUBLK$,,AUTO
         3 000475   000003 236100                    LDQ     3,,PR0
         3 000476   200011 756100                    STQ     SUBLK$,,AUTO

      337     5547    3                 FID = SUBLK$ -> OUT$SYM.TEXT;

   5547  3 000477   200011 470500                    LDP0    SUBLK$,,AUTO
         3 000500   000004 236100                    LDQ     4,,PR0
         3 000501   000033 772000                    QRL     27
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:46   
         3 000502   000000 620006                    EAX0    0,QL
         3 000503   040000 100540                    MLR     fill='040'O
         3 000504   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         3 000505   000000 000144 1                  ADSC9   FID                      cn=0,n=100

      338     5548    3                 CALL M$FID(FPT_FID) ALTRET(TPAP_ERR);

   5548  3 000506   000124 630400 1                  EPPR0   FPT_FID
         3 000507   420001 713400                    CLIMB   alt,+8193
         3 000510   404400 401760                    pmme    nvectors=10
         3 000511   000526 702000 3                  TSX2    TPAP_ERR

      339     5549
      340     5550    3                 IF FPT_OPEN.V.ASN# ~= 1 /* FILE# */THEN

   5550  3 000512   000077 236000 1                  LDQ     FPT_OPEN+37
         3 000513   000777 376007                    ANQ     511,DL
         3 000514   000001 116007                    CMPQ    1,DL
         3 000515   000525 600000 3                  TZE     s:5557

      341     5551    4                   DO;

      342     5552    4                     QT_CMDBLK.MINOR_ERR = CODE_TMBOD;

   5552  3 000516   000077 236000 2                  LDQ     CODE_TMBOD
         3 000517   000001 756000 xsym               STQ     QT_CMDBLK+1

      343     5553    4                     CALL XUR$ERRMSG(CODE_TMBOD);

   5553  3 000520   000020 630400 4                  EPPR0   16
         3 000521   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000522   000000 701000 xent               TSX1    XUR$ERRMSG
         3 000523   000000 011000                    NOP     0

      344     5554    4                     REC_OK_FLAG = '0'B;

   5554  3 000524   200007 450100                    STZ     REC_OK_FLAG,,AUTO
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:47   

      345     5555    4                   END;

      346     5556
      347     5557    4                 DO WHILE('0'B);

   5557  3 000525   000535 710000 3                  TRA     s:5565

      348     5558
      349     5559    4   TPAP_ERR:
      350     5560    4                   QT_CMDBLK.MINOR_ERR = CODE_BFFT;

   5560  3 000526   000100 236000 2     TPAP_ERR     LDQ     CODE_BFFT
         3 000527   000001 756000 xsym               STQ     QT_CMDBLK+1

      351     5561    4                   CALL XUR$ERRMSG(CODE_BFFT);

   5561  3 000530   000021 630400 4                  EPPR0   17
         3 000531   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000532   000000 701000 xent               TSX1    XUR$ERRMSG
         3 000533   000000 011000                    NOP     0

      352     5562    4                   REC_OK_FLAG = '0'B;

   5562  3 000534   200007 450100                    STZ     REC_OK_FLAG,,AUTO

      353     5563    4                 END /* NEVER */;

      354     5564
      355     5565    3                 QT$ENTRY.TPAP.NAME = VLP_NAME;

   5565  3 000535   000031 470400 xsym               LDP0    QT_GLOBAL+25
         3 000536   000100 100400                    MLR     fill='000'O
         3 000537   000154 000040 1                  ADSC9   VLP_NAME                 cn=0,n=32
         3 000540   000003 000040                    ADSC9   3,,PR0                   cn=0,n=32

      356     5566    3                 QT$ENTRY.TPAP.ACCT = VLP_ACCT.ACCT#;
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:48   

   5566  3 000541   000031 470400 xsym               LDP0    QT_GLOBAL+25
         3 000542   000166 237000 1                  LDAQ    VLP_ACCT
         3 000543   000013 755100                    STA     11,,PR0
         3 000544   000014 756100                    STQ     12,,PR0

      357     5567    3                 QT$ENTRY.TPAP.PASS = VLP_PASS.PASS#;

   5567  3 000545   000031 470400 xsym               LDP0    QT_GLOBAL+25
         3 000546   000164 237000 1                  LDAQ    VLP_PASS
         3 000547   000015 755100                    STA     13,,PR0
         3 000550   000016 756100                    STQ     14,,PR0

      358     5568    3                 QT$ENTRY.TPAP.SN = VLP_SN.SN#(0);

   5568  3 000551   000031 470400 xsym               LDP0    QT_GLOBAL+25
         3 000552   040100 100400                    MLR     fill='040'O
         3 000553   000171 000006 1                  ADSC9   VLP_SN+1                 cn=0,n=6
         3 000554   000017 000006                    ADSC9   15,,PR0                  cn=0,n=6

      359     5569
      360     5570    3             END /* CASE */;

      361     5571
      362     5572    2   LOOP:
      363     5573    2           END /* Do for each sub option */;

   5573  3 000555   200013 235100       LOOP         LDA     I,,AUTO
         3 000556   000001 035007                    ADLA    1,DL
         3 000557   200013 755100                    STA     I,,AUTO
         3 000560   200012 236100                    LDQ     NSUBLKS,,AUTO
         3 000561   200013 116100                    CMPQ    I,,AUTO
         3 000562   000126 603000 3                  TRC     s:5413

      364     5574
      365     5575    1           IF QT$ENTRY.TPAP.NAME.COUNT = 0 THEN

PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:49   
   5575  3 000563   000031 470400 xsym               LDP0    QT_GLOBAL+25
         3 000564   000003 236100                    LDQ     3,,PR0
         3 000565   777000 316003                    CANQ    -512,DU
         3 000566   000576 601000 3                  TNZ     s:5582

      366     5576    2             DO;

      367     5577    2               QT_CMDBLK.MINOR_ERR = CODE_NTPAP;

   5577  3 000567   000101 236000 2                  LDQ     CODE_NTPAP
         3 000570   000001 756000 xsym               STQ     QT_CMDBLK+1

      368     5578    2               CALL XUR$ERRMSG(CODE_NTPAP);

   5578  3 000571   000022 630400 4                  EPPR0   18
         3 000572   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000573   000000 701000 xent               TSX1    XUR$ERRMSG
         3 000574   000000 011000                    NOP     0

      369     5579    2               REC_OK_FLAG = '0'B;

   5579  3 000575   200007 450100                    STZ     REC_OK_FLAG,,AUTO

      370     5580    2             END;

      371     5581
      372     5582    1           IF (SETS_FLAG AND REC_OK_FLAG) OR

   5582  3 000576   200010 234100                    SZN     SETS_FLAG,,AUTO
         3 000577   000602 605000 3                  TPL     s:5582+4
         3 000600   200007 234100                    SZN     REC_OK_FLAG,,AUTO
         3 000601   000611 604000 3                  TMI     s:5585
         3 000602   200010 234100                    SZN     SETS_FLAG,,AUTO
         3 000603   000617 605000 3                  TPL     s:5588
         3 000604   000000 470400 xsym               LDP0    B$JIT$
         3 000605   000000 236100                    LDQ     0,,PR0
         3 000606   740000 376003                    ANQ     -16384,DU
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:50   
         3 000607   040000 116003                    CMPQ    16384,DU
         3 000610   000617 601000 3                  TNZ     s:5588

      373     5583    1               (SETS_FLAG AND B$JIT.MODE = 1) THEN
      374     5584    2             DO;

      375     5585    2               CALL QTA$READ_SET(MSGTYP);

   5585  3 000611   200003 630500                    EPPR0   MSGTYP,,AUTO
         3 000612   200022 450500                    STP0    OPTIONS_USED+2,,AUTO
         3 000613   200022 630500                    EPPR0   OPTIONS_USED+2,,AUTO
         3 000614   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000615   000000 701000 xent               TSX1    QTA$READ_SET
         3 000616   000000 011000                    NOP     0

      376     5586    2             END;

      377     5587
      378     5588    1           IF REC_OK_FLAG THEN

   5588  3 000617   200007 234100                    SZN     REC_OK_FLAG,,AUTO
         3 000620   000631 605000 3                  TPL     s:5593

      379     5589    2             DO;

      380     5590    2               CALL QTC$WRITE_TRADER(MSGTYP, 1 /* TYPE_E */);

   5590  3 000621   000002 236000 4                  LDQ     2
         3 000622   200023 756100                    STQ     OPTIONS_USED+3,,AUTO
         3 000623   200003 630500                    EPPR0   MSGTYP,,AUTO
         3 000624   200022 450500                    STP0    OPTIONS_USED+2,,AUTO
         3 000625   200022 630500                    EPPR0   OPTIONS_USED+2,,AUTO
         3 000626   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000627   000000 701000 xent               TSX1    QTC$WRITE_TRADER
         3 000630   000000 011000                    NOP     0

      381     5591    2             END;
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:51   

      382     5592
      383     5593    1           RETURN;

   5593  3 000631   000000 702200 xent               TSX2  ! X66_ARET
      384     5594
      385     5595    1   END QTB$CREMOD_E;

PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:52   
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   QT_SUBS_C.:E05TOU  is referenced.
   QT_MACROS_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QT_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   QT_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QTB$CREMOD_E.
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:53   

 **** Variables and constants ****

  ****  Section 001  Data  QTB$CREMOD_E

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(100)   r     1 FID                      124-0-0/d STRC(864)   r     1 FPT_FID
    32-0-0/d STRC(2088)  r     1 FPT_OPEN                 166-0-0/c STRC(72)    r     1 VLP_ACCT
   154-0-0/c STRC(288)   r     1 VLP_NAME                 164-0-0/c STRC(72)    r     1 VLP_PASS
   170-0-0/d STRC(90)    r     1 VLP_SN                   174-0-0/c STRC(72)    r     1 VLP_WSN
   176-0-0/d STRC(324)   r     1 VLR_FID

  ****  Section 002 RoData QTB$CREMOD_E

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    67-0-0/b STRC        r     1 CODE_AE                   71-0-0/b STRC        r     1 CODE_AUSED
   102-0-0/b STRC        r     1 CODE_BAD_MAXACTIVE       100-0-0/b STRC        r     1 CODE_BFFT
    70-0-0/b STRC        r     1 CODE_CMNF                 72-0-0/b STRC        r     1 CODE_DTL
    74-0-0/b STRC        r     1 CODE_IDN                 101-0-0/b STRC        r     1 CODE_NTPAP
    66-0-0/b STRC        r     1 CODE_NWH                  73-0-0/b STRC        r     1 CODE_ON
    76-0-0/b STRC        r     1 CODE_PTB                  75-0-0/b STRC        r     1 CODE_PTS
    77-0-0/b STRC        r     1 CODE_TMBOD                34-0-0/w STRC(936)   r     1 QT_ENTRY_C
     0-0-0/d STRC(720)   r     1 VLP_CGCP_C                24-0-0/d STRC(288)   r     1 VLP_CGTYPL_C

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    20-0-0/b BIT         r     1 ALL_OPTIONS               17-0-0/w UBIN        r     1 CPOS
     5-0-0/c CHAR(8)     r     1 FOUND_MSGTYP              13-0-0/w UBIN        r     1 I
     3-0-0/c CHAR(8)     r     1 MSGTYP                    12-0-0/w UBIN        r     1 NSUBLKS
    20-0-0/b BIT         r     1 OPTIONS_USED(0:35)
    15-0-0/w UBIN        r     1 POS                        7-0-0/w BIT         r     1 REC_OK_FLAG
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:54   
    10-0-0/w BIT         r     1 SETS_FLAG                 11-0-0/w PTR         r     1 SUBLK$
    14-0-0/w UBIN        r     1 SUB_CODE                  16-0-0/w UBIN        r     1 TEMP

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w STRC(261)   r     1 QT_CMDBLK
     0-0-0/w STRC(1872)  r     1 QT_GLOBAL

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/w STRC(144)   r     1 OUT$BLK
     0-0-0/w ASTR(153)   r     1 OUT$SYM                    0-0-0/w STRC(936)   r     1 QT$ENTRY


   Procedure QTB$CREMOD_E requires 410 words for executable code.
   Procedure QTB$CREMOD_E requires 22 words of local(AUTO) storage.

    No errors detected in file QTB$CREMOD_E.:E05TSI    .
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:55   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:56   
          MINI XREF LISTING

ALL_OPTIONS
      4848**DCL      5373<<ASSIGN
B$JIT.CPFLAGS1.SLEAZE
       258**DCL       258--REDEF
B$JIT.ERR.MID
       165**DCL       165--REDEF
B$JIT.JRESPEAK
       326**DCL       327--REDEF
B$JIT.MODE
       159**DCL      5582>>IF
B$JIT.ORIGINATOR_PORT.FROM_CR
       435**DCL       435--REDEF     436--REDEF
B$JIT.PNR
       339**DCL       339--REDEF
B$JIT.TSLINE
       433**DCL       434--REDEF
B$JIT$
      4471**DCL       159--IMP-PTR  5582>>IF
CODE_AE
      4882**DCL      5388>>ASSIGN   5389<>CALL
CODE_AUSED
      4896**DCL      5419>>ASSIGN   5420<>CALL
CODE_BAD_MAXACTIVE
      4960**DCL      5498>>ASSIGN   5499<>CALL
CODE_BFFT
      4945**DCL      5560>>ASSIGN   5561<>CALL
CODE_CMNF
      4889**DCL      5402>>ASSIGN   5403<>CALL
CODE_DTL
      4903**DCL      5441>>ASSIGN   5442<>CALL
CODE_IDN
      4917**DCL      5460>>ASSIGN   5461<>CALL
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:57   
CODE_NTPAP
      4952**DCL      5577>>ASSIGN   5578<>CALL
CODE_NWH
      4875**DCL      5378>>ASSIGN   5379<>CALL
CODE_ON
      4910**DCL      5452>>ASSIGN   5453<>CALL
CODE_PTB
      4931**DCL      5516>>ASSIGN   5517<>CALL
CODE_PTS
      4924**DCL      5509>>ASSIGN   5510<>CALL
CODE_TMBOD
      4938**DCL      5552>>ASSIGN   5553<>CALL
CPOS
      4845**DCL      5417<<ASSIGN   5418<>CALL
DEBUGGER_ERR
      5460**LABEL    5437--CALLALT
FID
      4659**DCL      5185--DCLINIT  5436<<ASSIGN   5547<<ASSIGN
FOUND_MSGTYP
      4833**DCL      5383<>CALL
FPT_FID
      5185**DCL      5437<>CALL     5548<>CALL
FPT_FID.V
      5189**DCL      5185--DCLINIT
FPT_OPEN.ACSVEH_
      5129**DCL      5130--REDEF
FPT_OPEN.ALTKEYS_
      5135**DCL      5136--REDEF    5136--REDEF
FPT_OPEN.HDR_
      5134**DCL      5135--REDEF
FPT_OPEN.TAB_
      5133**DCL      5134--REDEF
FPT_OPEN.UHL_
      5127**DCL      5128--REDEF    5128--REDEF
FPT_OPEN.V
      5136**DCL      5127--DCLINIT
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:58   
FPT_OPEN.V.ASN#
      5146**DCL      5188--DCLINIT  5550>>IF
FPT_OPEN.V.FSN#
      5167**DCL      5167--REDEF    5167--REDEF
FPT_OPEN.V.RES#
      5151**DCL      5188--DCLINIT
FPT_OPEN.WSN_
      5133**DCL      5133--REDEF
I
      4841**DCL      5412<<DOINDEX  5413>>ASSIGN
LOOP
      5573**LABEL    5433--GOTO
M$FID
       141**DCL-ENT  5437--CALL     5548--CALL
MSGTYP
      4832**DCL      5375<<ASSIGN   5377>>CALLBLT  5383<>CALL     5585<>CALL     5590<>CALL
NOT_FOUND
      5400**LABEL    5383--CALLALT
NO_Q
      5383**LABEL    5377--CALLALT
NSUBLKS
      4840**DCL      5372<<ASSIGN   5412>>DOINDEX
OPTIONS_USED
      4847**DCL      4848--REDEF    5415>>IF       5423<<ASSIGN
OUT$BLK.NSUBLKS
      4607**DCL      5372>>ASSIGN
OUT$BLK.SUBLK$
      4628**DCL      5375>>ASSIGN   5375>>ASSIGN   5413>>ASSIGN   5428>>ASSIGN   5468>>ASSIGN   5479>>ASSIGN
      5490>>ASSIGN   5504>>ASSIGN   5524>>ASSIGN   5535>>ASSIGN   5546>>ASSIGN
OUT$SYM.CODE
      4564**DCL      5414>>ASSIGN   5469>>IF       5480>>IF       5525>>IF       5536>>IF
OUT$SYM.COUNT
      4581**DCL      4584--IMP-SIZ  5375>>ASSIGN   5429>>IF       5436>>ASSIGN   5491>>CALLBLT  5505>>CALLBLT
      5547>>ASSIGN
OUT$SYM.CPOS
      4573**DCL      5417>>ASSIGN
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:59   
OUT$SYM.TEXT
      4584**DCL      5375>>ASSIGN   5436>>ASSIGN   5491>>CALLBLT  5505>>CALLBLT  5547>>ASSIGN
POS
      4843**DCL      5377<<CALLBLT
QT$ENTRY
      4508**DCL      5392<<ASSIGN   5407<<ASSIGN
QT$ENTRY.DEBUGGER
      4539**DCL      5465<<ASSIGN
QT$ENTRY.DEBUGGER.COUNT
      4541**DCL      5431<<ASSIGN
QT$ENTRY.DEBUGGER.TEXT
      4543**DCL      5432<<ASSIGN
QT$ENTRY.FLAGS.JOURNAL
      4519**DCL      5538<<ASSIGN   5542<<ASSIGN
QT$ENTRY.FLAGS.MESSAGE
      4517**DCL      5482<<ASSIGN   5486<<ASSIGN
QT$ENTRY.FLAGS.NEW_LOCK
      4515**DCL      5471<<ASSIGN   5475<<ASSIGN
QT$ENTRY.MAXACTIVE
      4525**DCL      5393<<ASSIGN   5408<<ASSIGN   5494<<ASSIGN
QT$ENTRY.PRIO
      4546**DCL      5394<<ASSIGN   5409<<ASSIGN   5521<<ASSIGN
QT$ENTRY.TPAP.ACCT
      4533**DCL      5566<<ASSIGN
QT$ENTRY.TPAP.NAME
      4529**DCL      5565<<ASSIGN
QT$ENTRY.TPAP.NAME.COUNT
      4531**DCL      5575>>IF
QT$ENTRY.TPAP.PASS
      4535**DCL      5567<<ASSIGN
QT$ENTRY.TPAP.SN
      4537**DCL      5568<<ASSIGN
QTA$READ_SET
      4441**DCL-ENT  5585--CALL
QTC$READ_TRADER
      4443**DCL-ENT  5383--CALL
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:60   
QTC$WRITE_TRADER
      4444**DCL-ENT  5590--CALL
QT_CMDBLK.CODE
       452**DCL      5386>>IF       5400>>IF
QT_CMDBLK.MINOR_ERR
       451**DCL      5378<<ASSIGN   5388<<ASSIGN   5402<<ASSIGN   5419<<ASSIGN   5441<<ASSIGN   5452<<ASSIGN
      5460<<ASSIGN   5498<<ASSIGN   5509<<ASSIGN   5516<<ASSIGN   5552<<ASSIGN   5560<<ASSIGN   5577<<ASSIGN
QT_CMDBLK.OUT$
       451**DCL       452--REDEF    5372>>ASSIGN   5375>>ASSIGN   5375>>ASSIGN   5413>>ASSIGN
QT_ENTRY_C
      4764**DCL      5392>>ASSIGN   5407>>ASSIGN
QT_GLOBAL.M$DO#
       450**DCL      5418<>CALL
QT_GLOBAL.QT$ENTRY$
       449**DCL      4508--IMP-PTR  5392>>ASSIGN   5393>>ASSIGN   5394>>ASSIGN   5407>>ASSIGN   5408>>ASSIGN
      5409>>ASSIGN   5431>>ASSIGN   5432>>ASSIGN   5465>>ASSIGN   5471>>ASSIGN   5475>>ASSIGN   5482>>ASSIGN
      5486>>ASSIGN   5494>>ASSIGN   5521>>ASSIGN   5538>>ASSIGN   5542>>ASSIGN   5565>>ASSIGN   5566>>ASSIGN
      5567>>ASSIGN   5568>>ASSIGN   5575>>IF
REC_OK_FLAG
      4835**DCL      5371<<ASSIGN   5380<<ASSIGN   5390<<ASSIGN   5404<<ASSIGN   5443<<ASSIGN   5454<<ASSIGN
      5462<<ASSIGN   5500<<ASSIGN   5554<<ASSIGN   5562<<ASSIGN   5579<<ASSIGN   5582>>IF       5588>>IF
SETS_FLAG
      4836**DCL      5370<<ASSIGN   5527<<ASSIGN   5531<<ASSIGN   5582>>IF       5582>>IF
SUBLK$
      4838**DCL      5413<<ASSIGN   5414>>ASSIGN   5417>>ASSIGN   5428<<ASSIGN   5428>>ASSIGN   5429>>IF
      5436>>ASSIGN   5436>>ASSIGN   5468<<ASSIGN   5468>>ASSIGN   5469>>IF       5479<<ASSIGN   5479>>ASSIGN
      5480>>IF       5490<<ASSIGN   5490>>ASSIGN   5491>>CALLBLT  5491>>CALLBLT  5504<<ASSIGN   5504>>ASSIGN
      5505>>CALLBLT  5505>>CALLBLT  5524<<ASSIGN   5524>>ASSIGN   5525>>IF       5535<<ASSIGN   5535>>ASSIGN
      5536>>IF       5546<<ASSIGN   5546>>ASSIGN   5547>>ASSIGN   5547>>ASSIGN
SUB_CODE
      4842**DCL      5414<<ASSIGN   5415>>IF       5423>>ASSIGN   5425>>DOCASE
TEMP
      4844**DCL      5491<<CALLBLT  5492>>IF       5494>>ASSIGN   5505<<CALLBLT  5507>>IF       5511<<ASSIGN
      5514>>IF       5518<<ASSIGN   5521>>ASSIGN
TPAP_ERR
      5560**LABEL    5548--CALLALT
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:61   
VLP_ACCT
      5273**DCL      5186--DCLINIT
VLP_ACCT.ACCT#
      5273**DCL      5566>>ASSIGN
VLP_CGCP_C.DVBYTE.REREAD#
      4711**DCL      4712--REDEF
VLP_CGCP_C.MXACT#
      4703**DCL      5393>>ASSIGN   5408>>ASSIGN
VLP_CGTYPL_C.LIST.PRIO#
      4747**DCL      5394>>ASSIGN   5409>>ASSIGN
VLP_NAME
      5247**DCL      5186--DCLINIT  5465>>ASSIGN   5565>>ASSIGN
VLP_NAME.L#
      5247**DCL      5439>>IF
VLP_PASS
      5260**DCL      5187--DCLINIT
VLP_PASS.PASS#
      5260**DCL      5567>>ASSIGN
VLP_SN
      5286**DCL      5187--DCLINIT
VLP_SN.SN#
      5286**DCL      5568>>ASSIGN
VLP_WSN
      5299**DCL      5187--DCLINIT
VLR_FID
      5337**DCL      5189--DCLINIT
VLR_FID.ACCT
      5337**DCL      5446>>IF
VLR_FID.PASS
      5337**DCL      5446>>IF
VLR_FID.RES
      5337**DCL      5446>>IF
VLR_FID.SN
      5337**DCL      5446>>IF
VLR_FID.WSN
      5337**DCL      5446>>IF
PL6.E3A0      #001=QTB$CREMOD_E File=QTB$CREMOD_E.:E05TSI                        WED 07/30/97 05:46 Page:62   
XUR$ERRMSG
      4442**DCL-ENT  5379--CALL     5389--CALL     5403--CALL     5420--CALL     5442--CALL     5453--CALL
      5461--CALL     5499--CALL     5510--CALL     5517--CALL     5553--CALL     5561--CALL     5578--CALL
XUR$ERRPTR
      4445**DCL-ENT  5418--CALL
