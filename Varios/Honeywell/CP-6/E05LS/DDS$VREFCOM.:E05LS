VERSION E05

PL6.E3A0      #001=DDS$VREFCOM File=DDS$VREFCOM.:E05TSI                          TUE 07/29/97 14:24 Page:1    
        1        1        /*M* DDS$VREFCOM VREF COMMON BUILD ROUTINE DRIVER */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*F* NAME: DDS$VREFCOM
       10       10             PURPOSE: TO BUILD A DATA DESCRIPTOR.
       11       11             DESCRIPTION: THE DATA DESCRIPTOR IS BUILT IN PLACE IF THE SPECIFIED
       12       12             NODE IS "POS11", ELSE IT IS "VREF11", & IT IS BUILT BY CALLING DCD$VREF.
       13       13             IN EITHER CASE, THE FORMAT CODE IS EITHER OBTAINED BY DEFAULT, OR
       14       14             IS OBTAINED FROM THE EXPLICITLY SPECIFIED FORMAT CODE. IF NO ERRORS
       15       15             WERE ENCOUNTERED THEN RETURNS, ELSE ALTRETURNS */
       16       16        /*D* NAME: DDS$VREFCOM
       17       17             CALL: CALL DDS$VREFCOM( VREF$, GOTFMT ) ALTRET( ERROR );
       18       18             INTERFACE: DDS$POS11
       19       19                        DDD$VREF
       20       20                        DDD$BUMP_D$
       21       21                        DDS$QUAL_SRCH
       22       22             ENVIRONMENT: DDS$SCAN ACTIVE.
       23       23             INPUT: VREF$ - POINTER TO NODE "VREF"
       24       24                    S_D.D$ - POINTER TO WHERE TO BEGIN BUILDING DATA DESCRIPTOR
       25       25             OUTPUT: S_D.D$ - POINTER TO NEXT AVAILABLE WORD AFTER DESCRIPTOR
       26       26                     GOTFMT - SET IF EXPLICIT FORMAT CODE FOUND, ELSE RESET.
       27       27             SCRATCH: S_D.DESC$
       28       28             DESCRIPTION: THE DATA DESCRIPTOR IS BUILT IN PLACE IF THE SPECIFIED
       29       29             NODE IS "POS11", ELSE IT IS "VREF11", & IT IS BUILT BY CALLING DDD$VREF.
       30       30             IN EITHER CASE, THE FORMAT CODE IS EITHER OBTAINED BY DEFAULT, OR
       31       31             IS OBTAINED FROM THE EXPLICITLY SPECIFIED FORMAT CODE. IF NO ERRORS
       32       32             WERE ENCOUNTERED THEN RETURNS, ELSE ALTRETURNS */
       33       33                                                /**/
       34       34        DDS$VREFCOM: PROC( VREF$, GOTFMT ) ALTRET;
       35       35                                                /**/
       36       36    1   DCL DDS$POSITION ENTRY(2) ALTRET;
       37       37    1   DCL DDD$VREF ENTRY(1) ALTRET;
PL6.E3A0      #001=DDS$VREFCOM File=DDS$VREFCOM.:E05TSI                          TUE 07/29/97 14:24 Page:2    
       38       38    1   DCL DDD$BUMP_D$ ENTRY(1) ALTRET;
       39       39    1   DCL DDS$QUAL_SRCH ENTRY(1) ALTRET;
       40       40    1   DCL VREF$ PTR;
       41       41    1   DCL GOTFMT BIT(1) ALIGNED;              /* FORMAT FOUND FLAG */
       42       42    1   DCL VALUE UBIN;
       43       43    1   DCL I SBIN;
       44       44    1   DCL ITEM$ PTR;
       45       45    1   DCL TEMP$ PTR;
       46       46    1   DCL TEMP SBIN;
       47       47             %INCLUDE DD_PSUBS_C;
       48      522             %INCLUDE XU_MACRO_C;
       49     3628             %PARSE$OUT (NAME=POB,STCLASS=BASED,NSUBLKS=NSB);
       50     3673             %INCLUDE DD_DTYP_R;
       51     3684             %FMT;
       52     3687             %INCLUDE DD$DITEM;
       12+    3790             %LIST;
       13+    3791    1        DCL SDD$ PTR;
       14+    3792    1        DCL ZITEM$ PTR;
       15+    3793    1        DCL SDD_L6$ PTR;
       16+    3794    1        DCL ZITEM_L6$ PTR;
       53     4368             %ZITEM;
       54     4440    1   DCL 1 DUMICITEM CONSTANT,
       55     4441    1         2 * UBIN UNAL INIT(SIZEW(DUMICITEM)),
       56     4442    1         2 * BIT(9) UNAL INIT(%MDE_FLAGS), /* MDE_FLAGS */
       57     4443    1         2 * UBIN(27) UNAL INIT(0),
       58     4444    1         2 * UBIN(18) UNAL INIT(0),
       59     4445    1         2 * BIT(18) UNAL INIT('1'B),      /* NAMEFLAGS.POSITION */
       60     4446    1         2 * UBIN UNAL INIT(0),
       61     4447    1         2 * UBIN UNAL INIT(0),
       62     4448    1         2 * UBIN UNAL INIT(0),
       63     4449    1         2 * UBIN(9) UNAL INIT(0),
       64     4450    1         2 * UBIN(9) UNAL INIT(%BIGSTATIC_ACODE), /* BIGSTATIC_ACODE */
       65     4451    1         2 * UBIN(9) UNAL INIT(%INST_FMT), /* INST_FMT */
       66     4452    1         2 * UBIN(9) UNAL INIT(%INST_DATATYPE), /* INST_DATATYPE */
       67     4453    1         2 * UBIN UNAL INIT(0),
       68     4454    1         2 * UBIN UNAL INIT(0),
       69     4455    1         2 * UBIN UNAL INIT(0),
PL6.E3A0      #001=DDS$VREFCOM File=DDS$VREFCOM.:E05TSI                          TUE 07/29/97 14:24 Page:3    
       70     4456    1         2 * UBIN UNAL INIT(0),
       71     4457    1         2 * UBIN UNAL INIT(0),
       72     4458    1         2 * UBIN UNAL INIT(0),
       73     4459    1         2 * UBIN(9) UNAL INIT(1),
       74     4460    1         2 * UBIN(9) UNAL INIT(0),
       75     4461    1         2 * UBIN(9) UNAL INIT(%CONST_ACODE), /* CONST_ACODE */
       76     4462    1         2 * UBIN(9) UNAL INIT(%SIZE_ICODE), /* SIZE_ICODE */
       77     4463    1         2 * UBIN UNAL INIT(36),
       78     4464    1         2 * UBIN UNAL INIT(0);
       79     4465    1   DCL 1 ICITEM BASED ALIGNED,
       80     4466    1         2 * UBIN UNAL,
       81     4467    1         2 * UBIN UNAL,
       82     4468    1         2 * UBIN UNAL,
       83     4469    1         2 * UBIN UNAL,
       84     4470    1         2 * UBIN UNAL,
       85     4471    1         2 * UBIN UNAL,
       86     4472    1         2 * UBIN UNAL,
       87     4473    1         2 VALUE UBIN UNAL,
       88     4474    1         2 * UBIN UNAL,
       89     4475    1         2 * UBIN UNAL,
       90     4476    1         2 * UBIN UNAL,
       91     4477    1         2 * UBIN UNAL,
       92     4478    1         2 * UBIN UNAL,
       93     4479    1         2 * UBIN UNAL,
       94     4480    1         2 * UBIN UNAL,
       95     4481    1         2 * UBIN UNAL;
       96     4482             %INCLUDE XUH_MACRO_C;
       97     4566             %INCLUDE DD_SD_M;
       98     5902             %S_D;
       99     7220                                                /**/
      100     7221    1        ITEM$ = VREF$ -> POB.SUBLK$( 0 );  /* C@POS11 OR C@VREF11 */
      101     7222    1        S_D.SAVE_TEXT_STPOS = ITEM$ -> POB.CPOS;
      102     7223    1        IF ITEM$ -> POB.CODE = 24  /* C@POSITION */
      103     7224    2        THEN DO;                           /* PROCEDURE RELATED POSITION */
      104     7225    2             S_D.DESC$ = S_D.D$;
      105     7226    2             CALL DDS$POSITION(ITEM$, VALUE) ALTRET(ARET);
      106     7227    2             CALL DDD$BUMP_D$(SIZEW(DUMICITEM)) ALTRET(ARET);
PL6.E3A0      #001=DDS$VREFCOM File=DDS$VREFCOM.:E05TSI                          TUE 07/29/97 14:24 Page:4    
      107     7228    2             S_D.DESC$ -> ICITEM = DUMICITEM;
      108     7229    2             S_D.DESC$ -> ICITEM.VALUE = VALUE;
      109     7230    2             ZITEM$ = S_D.DESC$;
      110     7231    2             ZITEM.NAMEFLAGS.POSITION = '1'B;
      111     7232    2           END;
      112     7233    2        ELSE DO I = 0 TO ITEM$ -> POB.NSB - 1; /* QUAL/PQLIST */
      113     7234    2             TEMP$ = ITEM$ -> POB.SUBLK$(I);
      114     7235    2             IF TEMP$ -> POB.CODE = 23 /* C@QUAL */
      115     7236    3             THEN DO;                      /* SET UP QUAL INFO */
      116     7237    3                  CALL DDS$QUAL_SRCH(TEMP$) ALTRET(ARET);
      117     7238    3                END;
      118     7239    3             ELSE DO;                      /* ITS A PQLIST */
      119     7240    3                  CALL DDD$VREF(TEMP$) ALTRET(ARET); /* BUILD DATA DESCRIPTOR */
      120     7241    3                  ZITEM$ = S_D.DESC$;
      121     7242    3                END;                       /* DO (ITS A PQLIST) */
      122     7243    2           END;                            /* DO I = 0 TO ITEM$ ... */
      123     7244    1        IF ADDR( GOTFMT ) ~= ADDR( NIL )
      124     7245    1        THEN GOTFMT = '0'B;                /* ASSUME NOT FOUND */
      125     7246    1        IF VREF$ -> POB.NSB > 1
      126     7247    2        THEN DO;
      127     7248    2             TEMP$ = VREF$ -> POB.SUBLK$(1); /* FMTSPEC_CODE */
      128     7249    2             ZITEM.FMT_SPEC =
      129     7250    2               TEMP$ -> POB.SUBLK$(0) -> POB.CODE - 340; /* FMTFIRST_CODE */
      130     7251    2             IF ADDR( GOTFMT ) ~= ADDR( NIL )
      131     7252    2             THEN GOTFMT = '1'B;           /* FORMAT SPEC ENCOUNTERED */
      132     7253    2           END;
      133     7254    1        ELSE IF ZITEM.DTYP ~= %SPEC_DTYP   /* SPEC_DTYP */
      134     7255    2             THEN DO;
      135     7256    2                  ZITEM.FMT_SPEC = FMT( ZITEM.DATA_TYPE );
      136     7257    2                END;
      137     7258    1             ELSE ;
      138     7259                                                /**/
      139     7260    1        S_D.QUALIFIED = '0'B;
      140     7261    1        RETURN;
      141     7262                                                /**/
      142     7263        %EJECT;
PL6.E3A0      #001=DDS$VREFCOM File=DDS$VREFCOM.:E05TSI                          TUE 07/29/97 14:24 Page:5    
      143     7264        /*D* NAME: DDS$VREFCOMD
      144     7265             CALL: CALL DDS$VREFCOMD( DUMMY$, DUMMY ) ALTRET( ERROR );
      145     7266             INTERFACE: DDD$BUMP_D$
      146     7267             ENVIRONMENT: DDS$SCAN ACTIVE.
      147     7268             INPUT: DUMMY$ - POINTER, NOT USED.
      148     7269                  DUMMY - BIT, NOT USED.
      149     7270                    S_D.ACCUM - VALUE OF ITEM TO BE VREF'ED.
      150     7271                    S_D.D$ - POINTER WHERE TO BEGIN BUILDING DATA DESCRIPTOR.
      151     7272             OUTPUT: S_D.D$ - POINTER TO NEXT AVAILABLE WORD AFTER DESCRIPTOR.
      152     7273             SCRATCH: S_D.DESC$
      153     7274             DESCRIPTION: WORKS JUST LIKE "DDS$VREFCOM" WHEN A POSITION IS ENCOUNTERED,
      154     7275             EXCEPT THAT THE VALUE IS OBTAINED FROM "S_D.ACCUM". */
      155     7276                                                /**/
      156     7277    1   DDS$VREFCOMD: ENTRY( VREF$, GOTFMT ) ALTRET;
      157     7278                                                /**/
      158     7279    1        S_D.DESC$ = S_D.D$;
      159     7280    1        CALL DDD$BUMP_D$( SIZEW( DUMICITEM ) ) ALTRET( ARET );
      160     7281    1        S_D.DESC$ -> ICITEM = DUMICITEM;
      161     7282    1        S_D.DESC$ -> ICITEM.VALUE = S_D.ACCUM;
      162     7283                                                /**/
      163     7284    1        S_D.QUALIFIED = '0'B;
      164     7285    1        RETURN;
      165     7286    1   ARET:
      166     7287    1        ALTRETURN;
      167     7288                                                /**/
      168     7289    1   END DDS$VREFCOM;

PL6.E3A0      #001=DDS$VREFCOM File=DDS$VREFCOM.:E05TSI                          TUE 07/29/97 14:24 Page:6    
--  Include file information  --

   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   DD_DTYP_R.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   DD_PSUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDS$VREFCOM.

   Procedure DDS$VREFCOM requires 133 words for executable code.
   Procedure DDS$VREFCOM requires 16 words of local(AUTO) storage.

    No errors detected in file DDS$VREFCOM.:E05TSI    .

PL6.E3A0      #001=DDS$VREFCOM File=DDS$VREFCOM.:E05TSI                          TUE 07/29/97 14:24 Page:7    

 Object Unit name= DDS$VREFCOM                                File name= DDS$VREFCOM.:E05TOU
 UTS= JUL 29 '97 14:24:16.36 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     16     20  DDS$VREFCOM
    1   Proc  even  none   133    205  DDS$VREFCOM
    2  RoData even  none     2      2  DDS$VREFCOM

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        2  DDS$VREFCOM
     1    161          yes     yes      Std        2  DDS$VREFCOMD

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 DDS$POSITION
 yes     yes           Std       1 DDS$QUAL_SRCH
 yes     yes           Std       1 DDD$BUMP_D$
 yes     yes           Std       1 DDD$VREF
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=DDS$VREFCOM File=DDS$VREFCOM.:E05TSI                          TUE 07/29/97 14:24 Page:8    

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     FMT                              r    S_D$                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=DDS$VREFCOM File=DDS$VREFCOM.:E05TSI                          TUE 07/29/97 14:24 Page:9    


        1        1        /*M* DDS$VREFCOM VREF COMMON BUILD ROUTINE DRIVER */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*F* NAME: DDS$VREFCOM
       10       10             PURPOSE: TO BUILD A DATA DESCRIPTOR.
       11       11             DESCRIPTION: THE DATA DESCRIPTOR IS BUILT IN PLACE IF THE SPECIFIED
       12       12             NODE IS "POS11", ELSE IT IS "VREF11", & IT IS BUILT BY CALLING DCD$VREF.
       13       13             IN EITHER CASE, THE FORMAT CODE IS EITHER OBTAINED BY DEFAULT, OR
       14       14             IS OBTAINED FROM THE EXPLICITLY SPECIFIED FORMAT CODE. IF NO ERRORS
       15       15             WERE ENCOUNTERED THEN RETURNS, ELSE ALTRETURNS */
       16       16        /*D* NAME: DDS$VREFCOM
       17       17             CALL: CALL DDS$VREFCOM( VREF$, GOTFMT ) ALTRET( ERROR );
       18       18             INTERFACE: DDS$POS11
       19       19                        DDD$VREF
       20       20                        DDD$BUMP_D$
       21       21                        DDS$QUAL_SRCH
       22       22             ENVIRONMENT: DDS$SCAN ACTIVE.
       23       23             INPUT: VREF$ - POINTER TO NODE "VREF"
       24       24                    S_D.D$ - POINTER TO WHERE TO BEGIN BUILDING DATA DESCRIPTOR
       25       25             OUTPUT: S_D.D$ - POINTER TO NEXT AVAILABLE WORD AFTER DESCRIPTOR
       26       26                     GOTFMT - SET IF EXPLICIT FORMAT CODE FOUND, ELSE RESET.
       27       27             SCRATCH: S_D.DESC$
       28       28             DESCRIPTION: THE DATA DESCRIPTOR IS BUILT IN PLACE IF THE SPECIFIED
       29       29             NODE IS "POS11", ELSE IT IS "VREF11", & IT IS BUILT BY CALLING DDD$VREF.
       30       30             IN EITHER CASE, THE FORMAT CODE IS EITHER OBTAINED BY DEFAULT, OR
       31       31             IS OBTAINED FROM THE EXPLICITLY SPECIFIED FORMAT CODE. IF NO ERRORS
       32       32             WERE ENCOUNTERED THEN RETURNS, ELSE ALTRETURNS */
       33       33                                                /**/
       34       34        DDS$VREFCOM: PROC( VREF$, GOTFMT ) ALTRET;

     34  1 000000   000000 700200 xent  DDS$VREFCOM  TSX0  ! X66_AUTO_2
PL6.E3A0      #001=DDS$VREFCOM File=DDS$VREFCOM.:E05TSI                          TUE 07/29/97 14:24 Page:10   
         1 000001   000020 000002                    ZERO    16,2

       35       35                                                /**/
       36       36    1   DCL DDS$POSITION ENTRY(2) ALTRET;
       37       37    1   DCL DDD$VREF ENTRY(1) ALTRET;
       38       38    1   DCL DDD$BUMP_D$ ENTRY(1) ALTRET;
       39       39    1   DCL DDS$QUAL_SRCH ENTRY(1) ALTRET;
       40       40    1   DCL VREF$ PTR;
       41       41    1   DCL GOTFMT BIT(1) ALIGNED;              /* FORMAT FOUND FLAG */
       42       42    1   DCL VALUE UBIN;
       43       43    1   DCL I SBIN;
       44       44    1   DCL ITEM$ PTR;
       45       45    1   DCL TEMP$ PTR;
       46       46    1   DCL TEMP SBIN;
       47       47             %INCLUDE DD_PSUBS_C;
       48      522             %INCLUDE XU_MACRO_C;
       49     3628             %PARSE$OUT (NAME=POB,STCLASS=BASED,NSUBLKS=NSB);
       50     3673             %INCLUDE DD_DTYP_R;
       51     3684             %FMT;
       52     3687             %INCLUDE DD$DITEM;
       12+    3790             %LIST;
       13+    3791    1        DCL SDD$ PTR;
       14+    3792    1        DCL ZITEM$ PTR;
       15+    3793    1        DCL SDD_L6$ PTR;
       16+    3794    1        DCL ZITEM_L6$ PTR;
       53     4368             %ZITEM;
       54     4440    1   DCL 1 DUMICITEM CONSTANT,
       55     4441    1         2 * UBIN UNAL INIT(SIZEW(DUMICITEM)),
       56     4442    1         2 * BIT(9) UNAL INIT(%MDE_FLAGS), /* MDE_FLAGS */
       57     4443    1         2 * UBIN(27) UNAL INIT(0),
       58     4444    1         2 * UBIN(18) UNAL INIT(0),
       59     4445    1         2 * BIT(18) UNAL INIT('1'B),      /* NAMEFLAGS.POSITION */
       60     4446    1         2 * UBIN UNAL INIT(0),
       61     4447    1         2 * UBIN UNAL INIT(0),
       62     4448    1         2 * UBIN UNAL INIT(0),
       63     4449    1         2 * UBIN(9) UNAL INIT(0),
       64     4450    1         2 * UBIN(9) UNAL INIT(%BIGSTATIC_ACODE), /* BIGSTATIC_ACODE */
PL6.E3A0      #001=DDS$VREFCOM File=DDS$VREFCOM.:E05TSI                          TUE 07/29/97 14:24 Page:11   
       65     4451    1         2 * UBIN(9) UNAL INIT(%INST_FMT), /* INST_FMT */
       66     4452    1         2 * UBIN(9) UNAL INIT(%INST_DATATYPE), /* INST_DATATYPE */
       67     4453    1         2 * UBIN UNAL INIT(0),
       68     4454    1         2 * UBIN UNAL INIT(0),
       69     4455    1         2 * UBIN UNAL INIT(0),
       70     4456    1         2 * UBIN UNAL INIT(0),
       71     4457    1         2 * UBIN UNAL INIT(0),
       72     4458    1         2 * UBIN UNAL INIT(0),
       73     4459    1         2 * UBIN(9) UNAL INIT(1),
       74     4460    1         2 * UBIN(9) UNAL INIT(0),
       75     4461    1         2 * UBIN(9) UNAL INIT(%CONST_ACODE), /* CONST_ACODE */
       76     4462    1         2 * UBIN(9) UNAL INIT(%SIZE_ICODE), /* SIZE_ICODE */
       77     4463    1         2 * UBIN UNAL INIT(36),
       78     4464    1         2 * UBIN UNAL INIT(0);
       79     4465    1   DCL 1 ICITEM BASED ALIGNED,
       80     4466    1         2 * UBIN UNAL,
       81     4467    1         2 * UBIN UNAL,
       82     4468    1         2 * UBIN UNAL,
       83     4469    1         2 * UBIN UNAL,
       84     4470    1         2 * UBIN UNAL,
       85     4471    1         2 * UBIN UNAL,
       86     4472    1         2 * UBIN UNAL,
       87     4473    1         2 VALUE UBIN UNAL,
       88     4474    1         2 * UBIN UNAL,
       89     4475    1         2 * UBIN UNAL,
       90     4476    1         2 * UBIN UNAL,
       91     4477    1         2 * UBIN UNAL,
       92     4478    1         2 * UBIN UNAL,
       93     4479    1         2 * UBIN UNAL,
       94     4480    1         2 * UBIN UNAL,
       95     4481    1         2 * UBIN UNAL;
       96     4482             %INCLUDE XUH_MACRO_C;
       97     4566             %INCLUDE DD_SD_M;
       98     5902             %S_D;
       99     7220                                                /**/
      100     7221    1        ITEM$ = VREF$ -> POB.SUBLK$( 0 );  /* C@POS11 OR C@VREF11 */

PL6.E3A0      #001=DDS$VREFCOM File=DDS$VREFCOM.:E05TSI                          TUE 07/29/97 14:24 Page:12   
   7221  1 000002   200003 470500                    LDP0    @VREF$,,AUTO
         1 000003   000000 471500                    LDP1    0,,PR0
         1 000004   100003 236100                    LDQ     3,,PR1
         1 000005   200007 756100                    STQ     ITEM$,,AUTO

      101     7222    1        S_D.SAVE_TEXT_STPOS = ITEM$ -> POB.CPOS;

   7222  1 000006   200007 471500                    LDP1    ITEM$,,AUTO
         1 000007   000000 473400 xsym               LDP3    S_D$
         1 000010   100002 235100                    LDA     2,,PR1
         1 000011   300066 755100                    STA     54,,PR3

      102     7223    1        IF ITEM$ -> POB.CODE = 24  /* C@POSITION */

   7223  1 000012   100000 720100                    LXL0    0,,PR1
         1 000013   000030 100003                    CMPX0   24,DU
         1 000014   000051 601000 1                  TNZ     s:7233

      103     7224    2        THEN DO;                           /* PROCEDURE RELATED POSITION */

      104     7225    2             S_D.DESC$ = S_D.D$;

   7225  1 000015   300044 236100                    LDQ     36,,PR3
         1 000016   300041 756100                    STQ     33,,PR3

      105     7226    2             CALL DDS$POSITION(ITEM$, VALUE) ALTRET(ARET);

   7226  1 000017   200005 634500                    EPPR4   VALUE,,AUTO
         1 000020   200017 454500                    STP4    ZITEM$+4,,AUTO
         1 000021   200007 635500                    EPPR5   ITEM$,,AUTO
         1 000022   200016 455500                    STP5    ZITEM$+3,,AUTO
         1 000023   200016 630500                    EPPR0   ZITEM$+3,,AUTO
         1 000024   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000025   000000 701000 xent               TSX1    DDS$POSITION
         1 000026   000204 702000 1                  TSX2    ARET

      106     7227    2             CALL DDD$BUMP_D$(SIZEW(DUMICITEM)) ALTRET(ARET);
PL6.E3A0      #001=DDS$VREFCOM File=DDS$VREFCOM.:E05TSI                          TUE 07/29/97 14:24 Page:13   

   7227  1 000027   000001 630400 2                  EPPR0   1
         1 000030   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000031   000000 701000 xent               TSX1    DDD$BUMP_D$
         1 000032   000204 702000 1                  TSX2    ARET

      107     7228    2             S_D.DESC$ -> ICITEM = DUMICITEM;

   7228  1 000033   000000 470400 xsym               LDP0    S_D$
         1 000034   000041 471500                    LDP1    33,,PR0
         1 000035   000100 100400                    MLR     fill='000'O
         1 000036   000000 000100 0                  ADSC9   DUMICITEM                cn=0,n=64
         1 000037   100000 000100                    ADSC9   0,,PR1                   cn=0,n=64

      108     7229    2             S_D.DESC$ -> ICITEM.VALUE = VALUE;

   7229  1 000040   000041 471500                    LDP1    33,,PR0
         1 000041   200005 235100                    LDA     VALUE,,AUTO
         1 000042   100007 755100                    STA     7,,PR1

      109     7230    2             ZITEM$ = S_D.DESC$;

   7230  1 000043   000041 236100                    LDQ     33,,PR0
         1 000044   200013 756100                    STQ     ZITEM$,,AUTO

      110     7231    2             ZITEM.NAMEFLAGS.POSITION = '1'B;

   7231  1 000045   200013 471500                    LDP1    ZITEM$,,AUTO
         1 000046   400000 236003                    LDQ     -131072,DU
         1 000047   100003 256100                    ORSQ    3,,PR1

      111     7232    2           END;

   7232  1 000050   000111 710000 1                  TRA     s:7244

      112     7233    2        ELSE DO I = 0 TO ITEM$ -> POB.NSB - 1; /* QUAL/PQLIST */

PL6.E3A0      #001=DDS$VREFCOM File=DDS$VREFCOM.:E05TSI                          TUE 07/29/97 14:24 Page:14   
   7233  1 000051   200006 450100                    STZ     I,,AUTO
         1 000052   000104 710000 1                  TRA     s:7243+1

      113     7234    2             TEMP$ = ITEM$ -> POB.SUBLK$(I);

   7234  1 000053   200007 470500                    LDP0    ITEM$,,AUTO
         1 000054   200006 720100                    LXL0    I,,AUTO
         1 000055   000003 236110                    LDQ     3,X0,PR0
         1 000056   200010 756100                    STQ     TEMP$,,AUTO

      114     7235    2             IF TEMP$ -> POB.CODE = 23 /* C@QUAL */

   7235  1 000057   200010 471500                    LDP1    TEMP$,,AUTO
         1 000060   100000 721100                    LXL1    0,,PR1
         1 000061   000027 101003                    CMPX1   23,DU
         1 000062   000072 601000 1                  TNZ     s:7240

      115     7236    3             THEN DO;                      /* SET UP QUAL INFO */

      116     7237    3                  CALL DDS$QUAL_SRCH(TEMP$) ALTRET(ARET);

   7237  1 000063   200010 633500                    EPPR3   TEMP$,,AUTO
         1 000064   200016 453500                    STP3    ZITEM$+3,,AUTO
         1 000065   200016 630500                    EPPR0   ZITEM$+3,,AUTO
         1 000066   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000067   000000 701000 xent               TSX1    DDS$QUAL_SRCH
         1 000070   000204 702000 1                  TSX2    ARET

      117     7238    3                END;

   7238  1 000071   000103 710000 1                  TRA     s:7243

      118     7239    3             ELSE DO;                      /* ITS A PQLIST */

      119     7240    3                  CALL DDD$VREF(TEMP$) ALTRET(ARET); /* BUILD DATA DESCRIPTOR */

   7240  1 000072   200010 633500                    EPPR3   TEMP$,,AUTO
PL6.E3A0      #001=DDS$VREFCOM File=DDS$VREFCOM.:E05TSI                          TUE 07/29/97 14:24 Page:15   
         1 000073   200016 453500                    STP3    ZITEM$+3,,AUTO
         1 000074   200016 630500                    EPPR0   ZITEM$+3,,AUTO
         1 000075   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000076   000000 701000 xent               TSX1    DDD$VREF
         1 000077   000204 702000 1                  TSX2    ARET

      120     7241    3                  ZITEM$ = S_D.DESC$;

   7241  1 000100   000000 470400 xsym               LDP0    S_D$
         1 000101   000041 236100                    LDQ     33,,PR0
         1 000102   200013 756100                    STQ     ZITEM$,,AUTO

      121     7242    3                END;                       /* DO (ITS A PQLIST) */

      122     7243    2           END;                            /* DO I = 0 TO ITEM$ ... */

   7243  1 000103   200006 054100                    AOS     I,,AUTO
         1 000104   200007 470500                    LDP0    ITEM$,,AUTO
         1 000105   000001 236100                    LDQ     1,,PR0
         1 000106   000022 772000                    QRL     18
         1 000107   200006 116100                    CMPQ    I,,AUTO
         1 000110   000053 605400 1                  TPNZ    s:7234

      123     7244    1        IF ADDR( GOTFMT ) ~= ADDR( NIL )

   7244  1 000111   200004 236100                    LDQ     @GOTFMT,,AUTO
         1 000112   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000113   000116 600000 1                  TZE     s:7246

      124     7245    1        THEN GOTFMT = '0'B;                /* ASSUME NOT FOUND */

   7245  1 000114   200004 470500                    LDP0    @GOTFMT,,AUTO
         1 000115   000000 450100                    STZ     0,,PR0

      125     7246    1        IF VREF$ -> POB.NSB > 1

   7246  1 000116   200003 470500                    LDP0    @VREF$,,AUTO
PL6.E3A0      #001=DDS$VREFCOM File=DDS$VREFCOM.:E05TSI                          TUE 07/29/97 14:24 Page:16   
         1 000117   000000 471500                    LDP1    0,,PR0
         1 000120   100001 220100                    LDX0    1,,PR1
         1 000121   000002 100003                    CMPX0   2,DU
         1 000122   000144 602000 1                  TNC     s:7254

      126     7247    2        THEN DO;

      127     7248    2             TEMP$ = VREF$ -> POB.SUBLK$(1); /* FMTSPEC_CODE */

   7248  1 000123   100004 236100                    LDQ     4,,PR1
         1 000124   200010 756100                    STQ     TEMP$,,AUTO

      128     7249    2             ZITEM.FMT_SPEC =

   7249  1 000125   200010 471500                    LDP1    TEMP$,,AUTO
         1 000126   100003 473500                    LDP3    3,,PR1
         1 000127   200013 474500                    LDP4    ZITEM$,,AUTO
         1 000130   300000 236100                    LDQ     0,,PR3
         1 000131   777777 376007                    ANQ     -1,DL
         1 000132   000524 136007                    SBLQ    340,DL
         1 000133   000011 736000                    QLS     9
         1 000134   400006 552110                    STBQ    6,'10'O,PR4

      129     7250    2               TEMP$ -> POB.SUBLK$(0) -> POB.CODE - 340; /* FMTFIRST_CODE */
      130     7251    2             IF ADDR( GOTFMT ) ~= ADDR( NIL )

   7251  1 000135   200004 236100                    LDQ     @GOTFMT,,AUTO
         1 000136   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000137   000156 600000 1                  TZE     s:7260

      131     7252    2             THEN GOTFMT = '1'B;           /* FORMAT SPEC ENCOUNTERED */

   7252  1 000140   400000 236003                    LDQ     -131072,DU
         1 000141   200004 471500                    LDP1    @GOTFMT,,AUTO
         1 000142   100000 756100                    STQ     0,,PR1

      132     7253    2           END;
PL6.E3A0      #001=DDS$VREFCOM File=DDS$VREFCOM.:E05TSI                          TUE 07/29/97 14:24 Page:17   

   7253  1 000143   000156 710000 1                  TRA     s:7260

      133     7254    1        ELSE IF ZITEM.DTYP ~= %SPEC_DTYP   /* SPEC_DTYP */

   7254  1 000144   200013 473500                    LDP3    ZITEM$,,AUTO
         1 000145   300001 236100                    LDQ     1,,PR3
         1 000146   000777 376003                    ANQ     511,DU
         1 000147   000003 116003                    CMPQ    3,DU
         1 000150   000156 600000 1                  TZE     s:7260

      134     7255    2             THEN DO;

      135     7256    2                  ZITEM.FMT_SPEC = FMT( ZITEM.DATA_TYPE );

   7256  1 000151   300006 721100                    LXL1    6,,PR3
         1 000152   000777 361003                    ANX1    511,DU
         1 000153   000000 236011 xsym               LDQ     FMT,X1
         1 000154   000011 736000                    QLS     9
         1 000155   300006 552110                    STBQ    6,'10'O,PR3

      136     7257    2                END;

      137     7258    1             ELSE ;
      138     7259                                                /**/
      139     7260    1        S_D.QUALIFIED = '0'B;

   7260  1 000156   000000 471400 xsym               LDP1    S_D$
         1 000157   100712 450100                    STZ     458,,PR1

      140     7261    1        RETURN;

   7261  1 000160   000000 702200 xent               TSX2  ! X66_ARET

      141     7262                                                /**/
      142     7263        %EJECT;
PL6.E3A0      #001=DDS$VREFCOM File=DDS$VREFCOM.:E05TSI                          TUE 07/29/97 14:24 Page:18   
      143     7264        /*D* NAME: DDS$VREFCOMD
      144     7265             CALL: CALL DDS$VREFCOMD( DUMMY$, DUMMY ) ALTRET( ERROR );
      145     7266             INTERFACE: DDD$BUMP_D$
      146     7267             ENVIRONMENT: DDS$SCAN ACTIVE.
      147     7268             INPUT: DUMMY$ - POINTER, NOT USED.
      148     7269                  DUMMY - BIT, NOT USED.
      149     7270                    S_D.ACCUM - VALUE OF ITEM TO BE VREF'ED.
      150     7271                    S_D.D$ - POINTER WHERE TO BEGIN BUILDING DATA DESCRIPTOR.
      151     7272             OUTPUT: S_D.D$ - POINTER TO NEXT AVAILABLE WORD AFTER DESCRIPTOR.
      152     7273             SCRATCH: S_D.DESC$
      153     7274             DESCRIPTION: WORKS JUST LIKE "DDS$VREFCOM" WHEN A POSITION IS ENCOUNTERED,
      154     7275             EXCEPT THAT THE VALUE IS OBTAINED FROM "S_D.ACCUM". */
      155     7276                                                /**/
      156     7277    1   DDS$VREFCOMD: ENTRY( VREF$, GOTFMT ) ALTRET;

   7277  1 000161   000000 700200 xent  DDS$VREFCOMD TSX0  ! X66_AUTO_2
         1 000162   000020 000002                    ZERO    16,2

      157     7278                                                /**/
      158     7279    1        S_D.DESC$ = S_D.D$;

   7279  1 000163   000000 470400 xsym               LDP0    S_D$
         1 000164   000044 236100                    LDQ     36,,PR0
         1 000165   000041 756100                    STQ     33,,PR0

      159     7280    1        CALL DDD$BUMP_D$( SIZEW( DUMICITEM ) ) ALTRET( ARET );

   7280  1 000166   000001 630400 2                  EPPR0   1
         1 000167   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000170   000000 701000 xent               TSX1    DDD$BUMP_D$
         1 000171   000204 702000 1                  TSX2    ARET

      160     7281    1        S_D.DESC$ -> ICITEM = DUMICITEM;

   7281  1 000172   000000 470400 xsym               LDP0    S_D$
         1 000173   000041 471500                    LDP1    33,,PR0
         1 000174   000100 100400                    MLR     fill='000'O
PL6.E3A0      #001=DDS$VREFCOM File=DDS$VREFCOM.:E05TSI                          TUE 07/29/97 14:24 Page:19   
         1 000175   000000 000100 0                  ADSC9   DUMICITEM                cn=0,n=64
         1 000176   100000 000100                    ADSC9   0,,PR1                   cn=0,n=64

      161     7282    1        S_D.DESC$ -> ICITEM.VALUE = S_D.ACCUM;

   7282  1 000177   000041 471500                    LDP1    33,,PR0
         1 000200   000137 235100                    LDA     95,,PR0
         1 000201   100007 755100                    STA     7,,PR1

      162     7283                                                /**/
      163     7284    1        S_D.QUALIFIED = '0'B;

   7284  1 000202   000712 450100                    STZ     458,,PR0

      164     7285    1        RETURN;

   7285  1 000203   000000 702200 xent               TSX2  ! X66_ARET

      165     7286    1   ARET:
      166     7287    1        ALTRETURN;

   7287  1 000204   000000 702200 xent  ARET         TSX2  ! X66_AALT

DUMICITEM
 Sect OctLoc
   0     000   000000 000020   640000 000000   000000 400000   000000 000000    ................
   0     004   000000 000000   000000 000000   000104 006067   000000 000000    .........D.7....
   0     010   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     014   000000 000000   001000 102011   000000 000044   000000 000000    ......B....$....

(unnamed)
 Sect OctLoc
   2     000   000000 000020   000000 006000                                    ........
      167     7288                                                /**/
      168     7289    1   END DDS$VREFCOM;

PL6.E3A0      #001=DDS$VREFCOM File=DDS$VREFCOM.:E05TSI                          TUE 07/29/97 14:24 Page:20   
--  Include file information  --

   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   DD_DTYP_R.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   DD_PSUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDS$VREFCOM.

   Procedure DDS$VREFCOM requires 133 words for executable code.
   Procedure DDS$VREFCOM requires 16 words of local(AUTO) storage.

    No errors detected in file DDS$VREFCOM.:E05TSI    .
PL6.E3A0      #001=DDS$VREFCOM File=DDS$VREFCOM.:E05TSI                          TUE 07/29/97 14:24 Page:21   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDS$VREFCOM File=DDS$VREFCOM.:E05TSI                          TUE 07/29/97 14:24 Page:22   
          MINI XREF LISTING

ARET
      7287**LABEL    7226--CALLALT  7227--CALLALT  7237--CALLALT  7240--CALLALT  7280--CALLALT
DDD$BUMP_D$
        38**DCL-ENT  7227--CALL     7280--CALL
DDD$VREF
        37**DCL-ENT  7240--CALL
DDS$POSITION
        36**DCL-ENT  7226--CALL
DDS$QUAL_SRCH
        39**DCL-ENT  7237--CALL
DUMICITEM
      4440**DCL      4441--DCLINIT  7227--CALL     7228>>ASSIGN   7280--CALL     7281>>ASSIGN
FMT
      3685**DCL      7256>>ASSIGN
GOTFMT
        41**DCL        34--PROC     7244--IF       7245<<ASSIGN   7251--IF       7252<<ASSIGN   7277--ENTRY
I
        43**DCL      7233<<DOINDEX  7234>>ASSIGN
ICITEM
      4465**DCL      7228<<ASSIGN   7281<<ASSIGN
ICITEM.VALUE
      4473**DCL      7229<<ASSIGN   7282<<ASSIGN
ITEM$
        44**DCL      7221<<ASSIGN   7222>>ASSIGN   7223>>IF       7226<>CALL     7233>>DOINDEX  7234>>ASSIGN
POB.CODE
      3642**DCL      7223>>IF       7235>>IF       7249>>ASSIGN
POB.CPOS
      3660**DCL      7222>>ASSIGN
POB.NSB
      3646**DCL      7233>>DOINDEX  7246>>IF
POB.SUBLK$
      3667**DCL      7221>>ASSIGN   7234>>ASSIGN   7248>>ASSIGN   7249>>ASSIGN
PL6.E3A0      #001=DDS$VREFCOM File=DDS$VREFCOM.:E05TSI                          TUE 07/29/97 14:24 Page:23   
S_D.ACCUM
      6104**DCL      7282>>ASSIGN
S_D.CURRENT_CHANNEL
      6854**DCL      6856--REDEF
S_D.D$
      5992**DCL      7225>>ASSIGN   7279>>ASSIGN
S_D.DEBUGA
      6006**DCL      6008--REDEF
S_D.DESC$
      5986**DCL      7225<<ASSIGN   7228>>ASSIGN   7229>>ASSIGN   7230>>ASSIGN   7241>>ASSIGN   7279<<ASSIGN
      7281>>ASSIGN   7282>>ASSIGN
S_D.EIS
      6964**DCL      6993--REDEF
S_D.HOST_MESSAGE_BUF_REMOTE
      6897**DCL      6898--REDEF    6912--REDEF
S_D.JDE
      6511**DCL      6512--REDEF
S_D.L$.VALUE
      6064**DCL      6070--REDEF    6078--REDEF    6081--REDEF    6084--REDEF    6087--REDEF
S_D.L$.VALUE.L
      6065**DCL      6066--REDEF    6067--REDEF
S_D.L6_MESSAGE_BUF
      6918**DCL      6920--REDEF
S_D.OUTPUT
      6884**DCL      6886--REDEF
S_D.QUALIFIED
      6173**DCL      7260<<ASSIGN   7284<<ASSIGN
S_D.REMOTE_MSG.FNCC
      6903**DCL      6904--REDEF
S_D.REMOTE_MSG.STXC
      6899**DCL      6900--REDEF
S_D.REMOTE_MSG.SUBFNCC
      6907**DCL      6908--REDEF
S_D.SAVE_TEXT_STPOS
      6030**DCL      7222<<ASSIGN
S_D.SV
PL6.E3A0      #001=DDS$VREFCOM File=DDS$VREFCOM.:E05TSI                          TUE 07/29/97 14:24 Page:24   
      5963**DCL      5984--REDEF
S_D$
      7215**DCL      5911--IMP-PTR  7222>>ASSIGN   7225>>ASSIGN   7225>>ASSIGN   7228>>ASSIGN   7229>>ASSIGN
      7230>>ASSIGN   7241>>ASSIGN   7260>>ASSIGN   7279>>ASSIGN   7279>>ASSIGN   7281>>ASSIGN   7282>>ASSIGN
      7282>>ASSIGN   7284>>ASSIGN
TEMP$
        45**DCL      7234<<ASSIGN   7235>>IF       7237<>CALL     7240<>CALL     7248<<ASSIGN   7249>>ASSIGN
VALUE
        42**DCL      7226<>CALL     7229>>ASSIGN
VREF$
        40**DCL        34--PROC     7221>>ASSIGN   7246>>IF       7248>>ASSIGN   7277--ENTRY
ZITEM.ADDRESS
      4403**DCL      4408--REDEF    4409--REDEF    4410--REDEF
ZITEM.DATA_TYPE
      4401**DCL      7256>>ASSIGN
ZITEM.DTYP
      4385**DCL      7254>>IF
ZITEM.FMT_SPEC
      4399**DCL      7249<<ASSIGN   7256<<ASSIGN
ZITEM.NAMEFLAGS.POSITION
      4389**DCL      7231<<ASSIGN
ZITEM.SP.VD
      4411**DCL      4415--REDEF    4418--REDEF
ZITEM$
      3792**DCL      4369--IMP-PTR  7230<<ASSIGN   7231>>ASSIGN   7241<<ASSIGN   7249>>ASSIGN   7254>>IF
      7256>>ASSIGN   7256>>ASSIGN
PL6.E3A0      #001=DDS$VREFCOM File=DDS$VREFCOM.:E05TSI                          TUE 07/29/97 14:24 Page:25   
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDS$VREFCOM File=DDS$VREFCOM.:E05TSI                          TUE 07/29/97 14:24 Page:26   
              MINI UREF LISTING

DDS$VREFCOM      34**PROC
DDS$VREFCOMD    7277**ENTRY
SDD$    3791**DCL
SDD_L6$    3793**DCL
TEMP      46**DCL
ZITEM_L6$    3794**DCL
