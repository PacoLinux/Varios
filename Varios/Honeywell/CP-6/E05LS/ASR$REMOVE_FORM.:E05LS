VERSION E05

PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:1    
        1        1        /*M* ASR$R_FORM - processes REMOVE FORM command.     */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9                                                              /**/
       10       10        ASR$R_FORM: PROC;
       11       11        %INCLUDE    CP_6;
       12     5570        %INCLUDE    B_ERRORS_C;
       13     6697        %INCLUDE    FS_SUPER_C;
       14     7460        %INCLUDE    AS_ENTRIES_M ;
       15     8510        %INCLUDE    AS_SUPER_C ;
       16     8945        %INCLUDE    AS_SUBS_C  ;
       17    10359        %INCLUDE    AS_MAC_C   ;
       18    10439        %INCLUDE    KL_SUPER_C ;
       19    13341        %INCLUDE    XU_MACRO_C ;
       20    16447        %INCLUDE    XU_FORMAT_C ;
       21    16609        %INCLUDE    AS_PERR_C ;
       22    17211        %INCLUDE    AS_SUPER_R ;
       23    20227    1   DCL BLK$ PTR;
       24    20228    1   DCL 1 FORM_KEY,
       25    20229    1          2 CNT UBIN BYTE UNAL,
       26    20230    1          2 TEXT CHAR(6) UNAL;
       27    20231    1   DCL 1 PSEUDO_FORM_KEY,
       28    20232    1          2 CNT UBIN BYTE UNAL,
       29    20233    1          2 TEXT CHAR(12) UNAL;
       30    20234    1   DCL PSEUDO_FORMS BIT(1);
       31    20235    1   DCL ARS UBIN;
       32    20236    1   DCL 1 SAVED_FORM_KEY,
       33    20237    1          2 CNT UBIN BYTE UNAL,
       34    20238    1          2 TEXT CHAR (20) UNAL;
       35    20239    1   DCL I UBIN;
       36    20240    1   DCL J UBIN;
       37    20241    1   DCL FNAME CHAR (8) ALIGNED;
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:2    
       38    20242    1   DCL REBUILT CHAR (0) CONSTANT INIT
       39    20243    1      (' --- STDLP, STDGR, and STD** have been rebuilt. ---');
       40    20244        %ASB$WILD_MATCH ;
       41    20247        %ASB$WRITE_LO ;
       42    20250        %ASF$BUILD_FORM ;
       43    20253        %ASF$READ_FORM ;
       44    20256        %ASF$READ_FORM_SEQ ;
       45    20259        %ASF$QUERY_PSEUDO_FORMS ;
       46    20262        %ASR$R_PSEUDO_FORMS ;
       47    20265        %ASB$GETSEG ;
       48    20268        %ASF$DELREC_FORM ;
       49    20271        %ASH$ERROR ;
       50    20274        %ASH$WARN ;
       51    20277        %ASH$INFO ;
       52    20280        %PARSE$SYM(NAME=OUT$SYM,STCLASS="BASED(BLK$)");
       53    20318        %PARSE$OUT(NAME=P$NODE,STCLASS="BASED(NODE$)",
       54    20319              NDTYPE=TYPE,NSUBLKS=SUBNODES);
       55    20364        %FS$FORMREC( NAME=FS$FORMREC, STCLASS="BASED(DSEG2$)" );
       56    20435        /*
       57    20436            ***            Begin procedure                    ***
       58    20437        */
       59    20438    1   BLK$ = P$NODE.SUBLK$(0)->P$NODE.SUBLK$(0);
       60    20439    2   IF OUT$SYM.COUNT > 6 THEN DO;
       61    20440        /*E* ERROR: ASR-E$FNAMETOOBIG-0
       62    20441             MESSAGE: FORM name too long.
       63    20442             MESSAGE1: Form names are from 1 to 6 characters long.
       64    20443        */
       65    20444           %SCREAM( ERR#=E$FNAMETOOBIG, LEVEL=ERROR, MID='R' );
       66    20459    2      RETURN;
       67    20460    2      END;
       68    20461    1   IF OUT$SYM.TEXT = 'STDGR'
       69    20462    1        OR
       70    20463    1        OUT$SYM.TEXT = 'STDLP'
       71    20464    1        OR
       72    20465    2        OUT$SYM.TEXT = 'STD**' THEN DO;
       73    20466        /*E* ERROR:  ASR-E$CANT_REM_STD-0
       74    20467             MESSAGE: You cannot remove this form.
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:3    
       75    20468             MESSAGE1: This form is a standard form.  It is used as the
       76    20469                       base form for creating other forms.
       77    20470             MESSAGE2: If this form were to be removed, you would have
       78    20471                       problems later on trying to create other forms.
       79    20472        */
       80    20473           %SCREAM (ERR#=%E$CANT_REM_STD, LEVEL=ERROR, MID='R');
       81    20488    2      RETURN;
       82    20489    2      END;  /*  If text = 'STD'  */
       83    20490    1   USERS_KEY.COUNT = 6;
       84    20491    1   USERS_KEY.TXTC = OUT$SYM.TEXT;
       85    20492    1   AS_FIELD1.COUNT = OUT$SYM.COUNT;
       86    20493    1   AS_FIELD1.TEXT  = OUT$SYM.TEXT;
       87    20494    1   IF NOT DSEG_FLG THEN
       88    20495    1      CALL ASB$GETSEG
       89    20496    2      WHENALTRETURN DO;
       90    20497              %SCREAM (ERR#=%E$GETSEGERR, LEVEL=ERROR, MID='R' );
       91    20512    2         RETURN;
       92    20513    2         END;  /*  Whenaltreturn from ASB$GETSEG  */
       93    20514    1   FNAME = USERS_KEY.TXTC;
       94    20515    1   CALL INDEX (I, '?', FNAME)
       95    20516    2   WHENRETURN DO;
       96    20517    2      END;  /* We'll do wildcard later */
       97    20518    2   WHENALTRETURN DO;   /* Handle single remove first. */
       98    20519    2      ARS = 2048 * 4;
       99    20520    2      CALL ASF$READ_FORM( USERS_KEY, DSEG2$, ARS ) ALTRET(READ_ERR);
      100    20521    2      CALL ASF$DELREC_FORM;
      101    20522        /*E* ERROR: ASR-E$FORMREMOVED-0
      102    20523             MESSAGE: Form %%U1 %removed.
      103    20524        */
      104    20525    2      AS_FIELD1 = USERS_KEY;
      105    20526           %SCREAM( ERR#=E$FORMREMOVED, LEVEL=INFO, MID='R' );
      106    20541    2      FORM_KEY = USERS_KEY;
      107    20542    3      IF FS$FORMREC.FNAME ~= FORM_KEY.TEXT THEN DO;
      108    20543    3         USERS_KEY.COUNT = 12;
      109    20544    3         CALL CONCAT( USERS_KEY.TXTC, FS$FORMREC.FNAME, FORM_KEY.TEXT );
      110    20545    3         CALL ASF$DELREC_FORM;
      111    20546    3         END;
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:4    
      112    20547    3      ELSE DO;
      113    20548    3         CALL ASF$QUERY_PSEUDO_FORMS( FORM_KEY, PSEUDO_FORM_KEY, PSEUDO_FORMS);
      114    20549    4         IF PSEUDO_FORMS THEN DO;
      115    20550        /*E*  ERROR:  ASR-E$PSEUDOS_REMOVED-C
      116    20551              MESSAGE: The following pseudo forms were also removed:
      117    20552        */
      118    20553                 %SCREAM( ERR#=E$PSEUDOS_REMOVED, LEVEL=INFO, MID='R' );
      119    20568    4            CALL ASR$R_PSEUDO_FORMS( PSEUDO_FORM_KEY );
      120    20569    4            END;
      121    20570    3         END;
      122    20571    2      RETURN;
      123    20572    2      END;  /* That finishes the nonwildcard case */
      124    20573
      125    20574        /* Now handle the wildcard CASE... */
      126    20575    1   USERS_KEY = '014000'O;           /* To get to bof */
      127    20576    1   SAVED_FORM_KEY = USERS_KEY;
      128    20577    2   DO WHILE (USERS_KEY.TEXT(0) ~= '~');  /* Chartext records */
      129    20578    3      DO UNTIL( USERS_KEY.COUNT <= 6 );
      130    20579    3         I = DSEG2SIZE;
      131    20580    3         USERS_KEY = SAVED_FORM_KEY;
      132    20581    3         CALL ASF$READ_FORM (USERS_KEY, DSEG2$, I);/*get repositioned*/
      133    20582    3         I = DSEG2SIZE;
      134    20583    3         CALL ASF$READ_FORM_SEQ(, DSEG2$, I)
      135    20584    4         WHENALTRETURN DO;
      136    20585    4            IF MERR_CODE.CODE ~= %E$EOF
      137    20586    5            THEN DO;
      138    20587    5               CALL ASH$ERROR(MERR_CODE);
      139    20588    5               END;
      140    20589    4            IF (FNAME = '?')
      141    20590    5            THEN DO;   /* Always keep the defaults */
      142    20591    5               CALL ASF$BUILD_FORM;
      143    20592    5               CALL ASB$WRITE_LO (' ', 1);
      144    20593    5               CALL ASB$WRITE_LO (REBUILT, LENGTHC (REBUILT) );
      145    20594    5               CALL ASB$WRITE_LO (' ', 1);
      146    20595    5               END;
      147    20596    4            RETURN;
      148    20597    4            END;
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:5    
      149    20598    3         SAVED_FORM_KEY = USERS_KEY;
      150    20599    3         END;
      151    20600    2      CALL INDEX (I, ' ', FNAME)
      152    20601    3      WHENALTRETURN DO;
      153    20602    3         END;
      154    20603    2      IF I = 0 THEN I = 1;
      155    20604    2      CALL INDEX (J, ' ', FS$FORMREC.FNAME)
      156    20605    3      WHENALTRETURN DO;
      157    20606    3         END;
      158    20607    2      IF J = 0 THEN J = 1;
      159    20608    2      CALL ASB$WILD_MATCH (J, FS$FORMREC.FNAME, I, FNAME)
      160    20609    3      WHENRETURN DO;
      161    20610    3         CALL ASF$DELREC_FORM;
      162    20611    3         AS_FIELD1 = USERS_KEY;
      163    20612    3         CALL ASB$WRITE_LO (' ', 1);
      164    20613              %SCREAM( ERR#=E$FORMREMOVED, LEVEL=INFO, MID='R' );
      165    20628    3         FORM_KEY = USERS_KEY;
      166    20629    4         IF FS$FORMREC.FNAME ~= FORM_KEY.TEXT THEN DO;
      167    20630    4            USERS_KEY.COUNT = 12;
      168    20631    4            CALL CONCAT( USERS_KEY.TXTC, FS$FORMREC.FNAME, FORM_KEY.TEXT );
      169    20632    4            CALL ASF$DELREC_FORM;
      170    20633    4            END;
      171    20634    4         ELSE DO;
      172    20635    4            CALL ASF$QUERY_PSEUDO_FORMS( FORM_KEY, PSEUDO_FORM_KEY, PSEUDO_FORMS);
      173    20636    5            IF PSEUDO_FORMS THEN DO;
      174    20637                    %SCREAM( ERR#=E$PSEUDOS_REMOVED, LEVEL=INFO, MID='R' );
      175    20652    5               CALL ASR$R_PSEUDO_FORMS( PSEUDO_FORM_KEY );
      176    20653    5               END;
      177    20654    4            END;
      178    20655    3         END;
      179    20656    3      WHENALTRETURN DO;
      180    20657    3         END;
      181    20658    2      END;
      182    20659    1   READ_ERR:
      183    20660    2   IF MERR_CODE.CODE= %E$NOKEY THEN DO;
      184    20661        /*E* ERROR: ASR-E$FNOEXIST-0
      185    20662             MESSAGE: Form %%U1 %does not exist.
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:6    
      186    20663        */
      187    20664           %SCREAM( ERR#=E$FNOEXIST, LEVEL=WARN, MID='R' );
      188    20679    2      END;
      189    20680    1   ELSE
      190    20681    1      CALL ASH$ERROR( ERR_CODE );
      191    20682    1   RETURN;
      192    20683    1   END ASR$R_FORM;

PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:7    
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   FS_SUPER_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure ASR$R_FORM.

   Procedure ASR$R_FORM requires 309 words for executable code.
   Procedure ASR$R_FORM requires 26 words of local(AUTO) storage.

    No errors detected in file ASR$REMOVE_FORM.:E05TSI    .

PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:8    

 Object Unit name= ASR$R_FORM                                 File name= ASR$REMOVE_FORM.:E05TOU
 UTS= JUL 29 '97 10:49:06.04 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2  RoData even  UTS     25     31  ASR$R_FORM
    3   Proc  even  none   309    465  ASR$R_FORM
    4  RoData even  none    18     22  ASR$R_FORM

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        0  ASR$R_FORM
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:9    

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
 yes     yes           Std       3 ASF$READ_FORM
 yes     yes           Std       0 ASF$DELREC_FORM
         yes           Std       1 ASR$R_PSEUDO_FORMS
         yes           Std       2 ASB$WRITE_LO
         yes           Std       2 ASH$ERROR
         yes           Std       2 ASH$INFO
 yes     yes           Std       3 ASF$READ_FORM_SEQ
         yes           Std       0 ASF$BUILD_FORM
         yes           Std       3 ASF$QUERY_PSEUDO_FORMS
 yes     yes           Std       4 ASB$WILD_MATCH
 yes     yes           Std       0 ASB$GETSEG
         yes           Std       2 ASH$WARN
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    AS_MODE                          r    AS_FE_MODE
     M$LO                                  USERS_KEY                             NODE$
     ERR_CODE                              AS_FIELD1                             REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          DSEG_FLG
     DSEG2$                                DSEG2SIZE                             B_VECTNIL
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:10   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:11   


        1        1        /*M* ASR$R_FORM - processes REMOVE FORM command.     */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9                                                              /**/
       10       10        ASR$R_FORM: PROC;

     10  3 000000   000000 700200 xent  ASR$R_FORM   TSX0  ! X66_AUTO_0
         3 000001   000032 000000                    ZERO    26,0

       11       11        %INCLUDE    CP_6;
       12     5570        %INCLUDE    B_ERRORS_C;
       13     6697        %INCLUDE    FS_SUPER_C;
       14     7460        %INCLUDE    AS_ENTRIES_M ;
       15     8510        %INCLUDE    AS_SUPER_C ;
       16     8945        %INCLUDE    AS_SUBS_C  ;
       17    10359        %INCLUDE    AS_MAC_C   ;
       18    10439        %INCLUDE    KL_SUPER_C ;
       19    13341        %INCLUDE    XU_MACRO_C ;
       20    16447        %INCLUDE    XU_FORMAT_C ;
       21    16609        %INCLUDE    AS_PERR_C ;
       22    17211        %INCLUDE    AS_SUPER_R ;
       23    20227    1   DCL BLK$ PTR;
       24    20228    1   DCL 1 FORM_KEY,
       25    20229    1          2 CNT UBIN BYTE UNAL,
       26    20230    1          2 TEXT CHAR(6) UNAL;
       27    20231    1   DCL 1 PSEUDO_FORM_KEY,
       28    20232    1          2 CNT UBIN BYTE UNAL,
       29    20233    1          2 TEXT CHAR(12) UNAL;
       30    20234    1   DCL PSEUDO_FORMS BIT(1);
       31    20235    1   DCL ARS UBIN;
       32    20236    1   DCL 1 SAVED_FORM_KEY,
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:12   
       33    20237    1          2 CNT UBIN BYTE UNAL,
       34    20238    1          2 TEXT CHAR (20) UNAL;
       35    20239    1   DCL I UBIN;
       36    20240    1   DCL J UBIN;
       37    20241    1   DCL FNAME CHAR (8) ALIGNED;
       38    20242    1   DCL REBUILT CHAR (0) CONSTANT INIT
       39    20243    1      (' --- STDLP, STDGR, and STD** have been rebuilt. ---');
       40    20244        %ASB$WILD_MATCH ;
       41    20247        %ASB$WRITE_LO ;
       42    20250        %ASF$BUILD_FORM ;
       43    20253        %ASF$READ_FORM ;
       44    20256        %ASF$READ_FORM_SEQ ;
       45    20259        %ASF$QUERY_PSEUDO_FORMS ;
       46    20262        %ASR$R_PSEUDO_FORMS ;
       47    20265        %ASB$GETSEG ;
       48    20268        %ASF$DELREC_FORM ;
       49    20271        %ASH$ERROR ;
       50    20274        %ASH$WARN ;
       51    20277        %ASH$INFO ;
       52    20280        %PARSE$SYM(NAME=OUT$SYM,STCLASS="BASED(BLK$)");
       53    20318        %PARSE$OUT(NAME=P$NODE,STCLASS="BASED(NODE$)",
       54    20319              NDTYPE=TYPE,NSUBLKS=SUBNODES);
       55    20364        %FS$FORMREC( NAME=FS$FORMREC, STCLASS="BASED(DSEG2$)" );
       56    20435        /*
       57    20436            ***            Begin procedure                    ***
       58    20437        */
       59    20438    1   BLK$ = P$NODE.SUBLK$(0)->P$NODE.SUBLK$(0);

  20438  3 000002   000000 470400 xsym               LDP0    NODE$
         3 000003   000003 471500                    LDP1    3,,PR0
         3 000004   100003 236100                    LDQ     3,,PR1
         3 000005   200003 756100                    STQ     BLK$,,AUTO

       60    20439    2   IF OUT$SYM.COUNT > 6 THEN DO;

  20439  3 000006   200003 473500                    LDP3    BLK$,,AUTO
         3 000007   300004 236100                    LDQ     4,,PR3
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:13   
         3 000010   777000 376003                    ANQ     -512,DU
         3 000011   007000 116003                    CMPQ    3584,DU
         3 000012   000020 602000 3                  TNC     s:20461

       61    20440        /*E* ERROR: ASR-E$FNAMETOOBIG-0
       62    20441             MESSAGE: FORM name too long.
       63    20442             MESSAGE1: Form names are from 1 to 6 characters long.
       64    20443        */
       65    20444           %SCREAM( ERR#=E$FNAMETOOBIG, LEVEL=ERROR, MID='R' );

  20456  3 000013   000000 630400 4                  EPPR0   0
         3 000014   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000015   000000 701000 xent               TSX1    ASH$ERROR
         3 000016   000000 011000                    NOP     0

       66    20459    2      RETURN;

  20459  3 000017   000000 702200 xent               TSX2  ! X66_ARET

       67    20460    2      END;
       68    20461    1   IF OUT$SYM.TEXT = 'STDGR'

  20461  3 000020   300004 236100                    LDQ     4,,PR3
         3 000021   000033 772000                    QRL     27
         3 000022   000000 620006                    EAX0    0,QL
         3 000023   040000 106540                    CMPC    fill='040'O
         3 000024   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         3 000025   000016 000005 2                  ADSC9   REBUILT+14               cn=0,n=5
         3 000026   000037 600000 3                  TZE     s:20485
         3 000027   040000 106540                    CMPC    fill='040'O
         3 000030   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         3 000031   000020 000005 2                  ADSC9   REBUILT+16               cn=0,n=5
         3 000032   000037 600000 3                  TZE     s:20485
         3 000033   040000 106540                    CMPC    fill='040'O
         3 000034   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         3 000035   000022 000005 2                  ADSC9   REBUILT+18               cn=0,n=5
         3 000036   000044 601000 3                  TNZ     s:20490
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:14   

       69    20462    1        OR
       70    20463    1        OUT$SYM.TEXT = 'STDLP'
       71    20464    1        OR
       72    20465    2        OUT$SYM.TEXT = 'STD**' THEN DO;

       73    20466        /*E* ERROR:  ASR-E$CANT_REM_STD-0
       74    20467             MESSAGE: You cannot remove this form.
       75    20468             MESSAGE1: This form is a standard form.  It is used as the
       76    20469                       base form for creating other forms.
       77    20470             MESSAGE2: If this form were to be removed, you would have
       78    20471                       problems later on trying to create other forms.
       79    20472        */
       80    20473           %SCREAM (ERR#=%E$CANT_REM_STD, LEVEL=ERROR, MID='R');

  20485  3 000037   000001 630400 4                  EPPR0   1
         3 000040   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000041   000000 701000 xent               TSX1    ASH$ERROR
         3 000042   000000 011000                    NOP     0

       81    20488    2      RETURN;

  20488  3 000043   000000 702200 xent               TSX2  ! X66_ARET

       82    20489    2      END;  /*  If text = 'STD'  */
       83    20490    1   USERS_KEY.COUNT = 6;

  20490  3 000044   006000 236003                    LDQ     3072,DU
         3 000045   000000 552040 xsym               STBQ    USERS_KEY,'40'O

       84    20491    1   USERS_KEY.TXTC = OUT$SYM.TEXT;

  20491  3 000046   040000 100540                    MLR     fill='040'O
         3 000047   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         3 000050   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41

       85    20492    1   AS_FIELD1.COUNT = OUT$SYM.COUNT;
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:15   

  20492  3 000051   300004 236100                    LDQ     4,,PR3
         3 000052   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

       86    20493    1   AS_FIELD1.TEXT  = OUT$SYM.TEXT;

  20493  3 000053   300004 236100                    LDQ     4,,PR3
         3 000054   000033 772000                    QRL     27
         3 000055   000000 620006                    EAX0    0,QL
         3 000056   040000 100540                    MLR     fill='040'O
         3 000057   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         3 000060   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

       87    20494    1   IF NOT DSEG_FLG THEN

  20494  3 000061   000000 234000 xsym               SZN     DSEG_FLG
         3 000062   000074 604000 3                  TMI     s:20514

       88    20495    1      CALL ASB$GETSEG

  20495  3 000063   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000064   000000 701000 xent               TSX1    ASB$GETSEG
         3 000065   000067 702000 3                  TSX2    s:20509
         3 000066   000074 710000 3                  TRA     s:20514

       89    20496    2      WHENALTRETURN DO;

       90    20497              %SCREAM (ERR#=%E$GETSEGERR, LEVEL=ERROR, MID='R' );

  20509  3 000067   000002 630400 4                  EPPR0   2
         3 000070   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000071   000000 701000 xent               TSX1    ASH$ERROR
         3 000072   000000 011000                    NOP     0

       91    20512    2         RETURN;

  20512  3 000073   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:16   

       92    20513    2         END;  /*  Whenaltreturn from ASB$GETSEG  */
       93    20514    1   FNAME = USERS_KEY.TXTC;

  20514  3 000074   040100 100400                    MLR     fill='040'O
         3 000075   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         3 000076   200024 000010                    ADSC9   FNAME,,AUTO              cn=0,n=8

       94    20515    1   CALL INDEX (I, '?', FNAME)

  20515  3 000077   000000 124500                    SCM     mask='000'O
         3 000100   200024 000010                    ADSC9   FNAME,,AUTO              cn=0,n=8
         3 000101   000003 000001 4                  ADSC9   3                        cn=0,n=1
         3 000102   200022 000100                    ARG     I,,AUTO
         3 000103   000105 606400 3                  TTN     s:20519

       95    20516    2   WHENRETURN DO;

       96    20517    2      END;  /* We'll do wildcard later */

  20517  3 000104   000204 710000 3                  TRA     s:20575

       97    20518    2   WHENALTRETURN DO;   /* Handle single remove first. */

       98    20519    2      ARS = 2048 * 4;

  20519  3 000105   020000 235007                    LDA     8192,DL
         3 000106   200013 755100                    STA     ARS,,AUTO

       99    20520    2      CALL ASF$READ_FORM( USERS_KEY, DSEG2$, ARS ) ALTRET(READ_ERR);

  20520  3 000107   200013 630500                    EPPR0   ARS,,AUTO
         3 000110   200030 450500                    STP0    FNAME+4,,AUTO
         3 000111   000004 237000 4                  LDAQ    4
         3 000112   200026 757100                    STAQ    FNAME+2,,AUTO
         3 000113   200026 630500                    EPPR0   FNAME+2,,AUTO
         3 000114   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:17   
         3 000115   000000 701000 xent               TSX1    ASF$READ_FORM
         3 000116   000447 702000 3                  TSX2    READ_ERR

      100    20521    2      CALL ASF$DELREC_FORM;

  20521  3 000117   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000120   000000 701000 xent               TSX1    ASF$DELREC_FORM
         3 000121   000000 011000                    NOP     0

      101    20522        /*E* ERROR: ASR-E$FORMREMOVED-0
      102    20523             MESSAGE: Form %%U1 %removed.
      103    20524        */
      104    20525    2      AS_FIELD1 = USERS_KEY;

  20525  3 000122   000000 100400                    MLR     fill='000'O
         3 000123   000000 000051 xsym               ADSC9   USERS_KEY                cn=0,n=41
         3 000124   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      105    20526           %SCREAM( ERR#=E$FORMREMOVED, LEVEL=INFO, MID='R' );

  20534  3 000125   000006 630400 4                  EPPR0   6
         3 000126   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000127   000000 701000 xent               TSX1    ASH$INFO
         3 000130   000000 011000                    NOP     0

      106    20541    2      FORM_KEY = USERS_KEY;

  20541  3 000131   000100 100400                    MLR     fill='000'O
         3 000132   000000 000007 xsym               ADSC9   USERS_KEY                cn=0,n=7
         3 000133   200004 000007                    ADSC9   FORM_KEY,,AUTO           cn=0,n=7

      107    20542    3      IF FS$FORMREC.FNAME ~= FORM_KEY.TEXT THEN DO;

  20542  3 000134   000000 470400 xsym               LDP0    DSEG2$
         3 000135   040100 106500                    CMPC    fill='040'O
         3 000136   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6
         3 000137   200004 200006                    ADSC9   FORM_KEY,,AUTO           cn=1,n=6
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:18   
         3 000140   000155 600000 3                  TZE     s:20548

      108    20543    3         USERS_KEY.COUNT = 12;

  20543  3 000141   014000 236003                    LDQ     6144,DU
         3 000142   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      109    20544    3         CALL CONCAT( USERS_KEY.TXTC, FS$FORMREC.FNAME, FORM_KEY.TEXT );

  20544  3 000143   040000 100500                    MLR     fill='040'O
         3 000144   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6
         3 000145   000000 200006 xsym               ADSC9   USERS_KEY                cn=1,n=6
         3 000146   040000 100500                    MLR     fill='040'O
         3 000147   200004 200006                    ADSC9   FORM_KEY,,AUTO           cn=1,n=6
         3 000150   000001 600043 xsym               ADSC9   USERS_KEY+1              cn=3,n=35

      110    20545    3         CALL ASF$DELREC_FORM;

  20545  3 000151   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000152   000000 701000 xent               TSX1    ASF$DELREC_FORM
         3 000153   000000 011000                    NOP     0

      111    20546    3         END;

  20546  3 000154   000203 710000 3                  TRA     s:20571

      112    20547    3      ELSE DO;

      113    20548    3         CALL ASF$QUERY_PSEUDO_FORMS( FORM_KEY, PSEUDO_FORM_KEY, PSEUDO_FORMS);

  20548  3 000155   200012 631500                    EPPR1   PSEUDO_FORMS,,AUTO
         3 000156   200030 451500                    STP1    FNAME+4,,AUTO
         3 000157   200006 633500                    EPPR3   PSEUDO_FORM_KEY,,AUTO
         3 000160   200027 453500                    STP3    FNAME+3,,AUTO
         3 000161   200004 634500                    EPPR4   FORM_KEY,,AUTO
         3 000162   200026 454500                    STP4    FNAME+2,,AUTO
         3 000163   200026 630500                    EPPR0   FNAME+2,,AUTO
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:19   
         3 000164   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000165   000000 701000 xent               TSX1    ASF$QUERY_PSEUDO_FORMS
         3 000166   000000 011000                    NOP     0

      114    20549    4         IF PSEUDO_FORMS THEN DO;

  20549  3 000167   200012 234100                    SZN     PSEUDO_FORMS,,AUTO
         3 000170   000203 605000 3                  TPL     s:20571

      115    20550        /*E*  ERROR:  ASR-E$PSEUDOS_REMOVED-C
      116    20551              MESSAGE: The following pseudo forms were also removed:
      117    20552        */
      118    20553                 %SCREAM( ERR#=E$PSEUDOS_REMOVED, LEVEL=INFO, MID='R' );

  20561  3 000171   000007 630400 4                  EPPR0   7
         3 000172   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000173   000000 701000 xent               TSX1    ASH$INFO
         3 000174   000000 011000                    NOP     0

      119    20568    4            CALL ASR$R_PSEUDO_FORMS( PSEUDO_FORM_KEY );

  20568  3 000175   200006 630500                    EPPR0   PSEUDO_FORM_KEY,,AUTO
         3 000176   200026 450500                    STP0    FNAME+2,,AUTO
         3 000177   200026 630500                    EPPR0   FNAME+2,,AUTO
         3 000200   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000201   000000 701000 xent               TSX1    ASR$R_PSEUDO_FORMS
         3 000202   000000 011000                    NOP     0

      120    20569    4            END;

      121    20570    3         END;

      122    20571    2      RETURN;

  20571  3 000203   000000 702200 xent               TSX2  ! X66_ARET

      123    20572    2      END;  /* That finishes the nonwildcard case */
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:20   
      124    20573
      125    20574        /* Now handle the wildcard CASE... */
      126    20575    1   USERS_KEY = '014000'O;           /* To get to bof */

  20575  3 000204   000000 100400                    MLR     fill='000'O
         3 000205   000010 000002 4                  ADSC9   8                        cn=0,n=2
         3 000206   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      127    20576    1   SAVED_FORM_KEY = USERS_KEY;

  20576  3 000207   000100 100400                    MLR     fill='000'O
         3 000210   000000 000025 xsym               ADSC9   USERS_KEY                cn=0,n=21
         3 000211   200014 000025                    ADSC9   SAVED_FORM_KEY,,AUTO     cn=0,n=21

      128    20577    2   DO WHILE (USERS_KEY.TEXT(0) ~= '~');  /* Chartext records */

  20577  3 000212   000000 236000 xsym               LDQ     USERS_KEY
         3 000213   000777 376003                    ANQ     511,DU
         3 000214   000176 116003                    CMPQ    126,DU
         3 000215   000447 600000 3                  TZE     READ_ERR

      129    20578    3      DO UNTIL( USERS_KEY.COUNT <= 6 );

      130    20579    3         I = DSEG2SIZE;

  20579  3 000216   000000 235000 xsym               LDA     DSEG2SIZE
         3 000217   200022 755100                    STA     I,,AUTO

      131    20580    3         USERS_KEY = SAVED_FORM_KEY;

  20580  3 000220   000000 100500                    MLR     fill='000'O
         3 000221   200014 000025                    ADSC9   SAVED_FORM_KEY,,AUTO     cn=0,n=21
         3 000222   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      132    20581    3         CALL ASF$READ_FORM (USERS_KEY, DSEG2$, I);/*get repositioned*/

  20581  3 000223   200022 630500                    EPPR0   I,,AUTO
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:21   
         3 000224   200030 450500                    STP0    FNAME+4,,AUTO
         3 000225   000004 237000 4                  LDAQ    4
         3 000226   200026 757100                    STAQ    FNAME+2,,AUTO
         3 000227   200026 630500                    EPPR0   FNAME+2,,AUTO
         3 000230   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000231   000000 701000 xent               TSX1    ASF$READ_FORM
         3 000232   000000 011000                    NOP     0

      133    20582    3         I = DSEG2SIZE;

  20582  3 000233   000000 235000 xsym               LDA     DSEG2SIZE
         3 000234   200022 755100                    STA     I,,AUTO

      134    20583    3         CALL ASF$READ_FORM_SEQ(, DSEG2$, I)

  20583  3 000235   200022 630500                    EPPR0   I,,AUTO
         3 000236   200030 450500                    STP0    FNAME+4,,AUTO
         3 000237   000005 236000 4                  LDQ     5
         3 000240   000001 235000 xsym               LDA     B_VECTNIL+1
         3 000241   200026 757100                    STAQ    FNAME+2,,AUTO
         3 000242   200026 630500                    EPPR0   FNAME+2,,AUTO
         3 000243   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000244   000000 701000 xent               TSX1    ASF$READ_FORM_SEQ
         3 000245   000247 702000 3                  TSX2    s:20585
         3 000246   000302 710000 3                  TRA     s:20598

      135    20584    4         WHENALTRETURN DO;

      136    20585    4            IF MERR_CODE.CODE ~= %E$EOF

  20585  3 000247   000000 236000 xsym               LDQ     ERR_CODE
         3 000250   377770 376007                    ANQ     131064,DL
         3 000251   000060 116007                    CMPQ    48,DL
         3 000252   000257 600000 3                  TZE     s:20589

      137    20586    5            THEN DO;

PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:22   
      138    20587    5               CALL ASH$ERROR(MERR_CODE);

  20587  3 000253   000011 630400 4                  EPPR0   9
         3 000254   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000255   000000 701000 xent               TSX1    ASH$ERROR
         3 000256   000000 011000                    NOP     0

      139    20588    5               END;

      140    20589    4            IF (FNAME = '?')

  20589  3 000257   200024 237100                    LDAQ    FNAME,,AUTO
         3 000260   000012 117000 4                  CMPAQ   10
         3 000261   000301 601000 3                  TNZ     s:20596

      141    20590    5            THEN DO;   /* Always keep the defaults */

      142    20591    5               CALL ASF$BUILD_FORM;

  20591  3 000262   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000263   000000 701000 xent               TSX1    ASF$BUILD_FORM
         3 000264   000000 011000                    NOP     0

      143    20592    5               CALL ASB$WRITE_LO (' ', 1);

  20592  3 000265   000014 630400 4                  EPPR0   12
         3 000266   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000267   000000 701000 xent               TSX1    ASB$WRITE_LO
         3 000270   000000 011000                    NOP     0

      144    20593    5               CALL ASB$WRITE_LO (REBUILT, LENGTHC (REBUILT) );

  20593  3 000271   000017 630400 4                  EPPR0   15
         3 000272   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000273   000000 701000 xent               TSX1    ASB$WRITE_LO
         3 000274   000000 011000                    NOP     0

PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:23   
      145    20594    5               CALL ASB$WRITE_LO (' ', 1);

  20594  3 000275   000014 630400 4                  EPPR0   12
         3 000276   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000277   000000 701000 xent               TSX1    ASB$WRITE_LO
         3 000300   000000 011000                    NOP     0

      146    20595    5               END;

      147    20596    4            RETURN;

  20596  3 000301   000000 702200 xent               TSX2  ! X66_ARET

      148    20597    4            END;
      149    20598    3         SAVED_FORM_KEY = USERS_KEY;

  20598  3 000302   000100 100400                    MLR     fill='000'O
         3 000303   000000 000025 xsym               ADSC9   USERS_KEY                cn=0,n=21
         3 000304   200014 000025                    ADSC9   SAVED_FORM_KEY,,AUTO     cn=0,n=21

      150    20599    3         END;

  20599  3 000305   000000 236000 xsym               LDQ     USERS_KEY
         3 000306   777000 376003                    ANQ     -512,DU
         3 000307   007000 116003                    CMPQ    3584,DU
         3 000310   000216 603000 3                  TRC     s:20579

      151    20600    2      CALL INDEX (I, ' ', FNAME)

  20600  3 000311   000000 124500                    SCM     mask='000'O
         3 000312   200024 000010                    ADSC9   FNAME,,AUTO              cn=0,n=8
         3 000313   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000314   200022 000100                    ARG     I,,AUTO
         3 000315   000317 606400 3                  TTN     s:20603
         3 000316   000317 710000 3                  TRA     s:20603

      152    20601    3      WHENALTRETURN DO;
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:24   

      153    20602    3         END;

      154    20603    2      IF I = 0 THEN I = 1;

  20603  3 000317   200022 235100                    LDA     I,,AUTO
         3 000320   000323 601000 3                  TNZ     s:20604

  20603  3 000321   000001 236007                    LDQ     1,DL
         3 000322   200022 756100                    STQ     I,,AUTO

      155    20604    2      CALL INDEX (J, ' ', FS$FORMREC.FNAME)

  20604  3 000323   000000 470400 xsym               LDP0    DSEG2$
         3 000324   000000 124500                    SCM     mask='000'O
         3 000325   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6
         3 000326   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000327   200023 000100                    ARG     J,,AUTO
         3 000330   000332 606400 3                  TTN     s:20607
         3 000331   000332 710000 3                  TRA     s:20607

      156    20605    3      WHENALTRETURN DO;

      157    20606    3         END;

      158    20607    2      IF J = 0 THEN J = 1;

  20607  3 000332   200023 235100                    LDA     J,,AUTO
         3 000333   000336 601000 3                  TNZ     s:20608

  20607  3 000334   000001 236007                    LDQ     1,DL
         3 000335   200023 756100                    STQ     J,,AUTO

      159    20608    2      CALL ASB$WILD_MATCH (J, FS$FORMREC.FNAME, I, FNAME)

  20608  3 000336   200024 630500                    EPPR0   FNAME,,AUTO
         3 000337   200031 450500                    STP0    FNAME+5,,AUTO
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:25   
         3 000340   200022 631500                    EPPR1   I,,AUTO
         3 000341   200030 451500                    STP1    FNAME+4,,AUTO
         3 000342   000000 236000 xsym               LDQ     DSEG2$
         3 000343   200027 756100                    STQ     FNAME+3,,AUTO
         3 000344   200023 633500                    EPPR3   J,,AUTO
         3 000345   200026 453500                    STP3    FNAME+2,,AUTO
         3 000346   200026 630500                    EPPR0   FNAME+2,,AUTO
         3 000347   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000350   000000 701000 xent               TSX1    ASB$WILD_MATCH
         3 000351   000443 702000 3                  TSX2    s:20658

      160    20609    3      WHENRETURN DO;

      161    20610    3         CALL ASF$DELREC_FORM;

  20610  3 000352   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000353   000000 701000 xent               TSX1    ASF$DELREC_FORM
         3 000354   000000 011000                    NOP     0

      162    20611    3         AS_FIELD1 = USERS_KEY;

  20611  3 000355   000000 100400                    MLR     fill='000'O
         3 000356   000000 000051 xsym               ADSC9   USERS_KEY                cn=0,n=41
         3 000357   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      163    20612    3         CALL ASB$WRITE_LO (' ', 1);

  20612  3 000360   000014 630400 4                  EPPR0   12
         3 000361   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000362   000000 701000 xent               TSX1    ASB$WRITE_LO
         3 000363   000000 011000                    NOP     0

      164    20613              %SCREAM( ERR#=E$FORMREMOVED, LEVEL=INFO, MID='R' );

  20621  3 000364   000006 630400 4                  EPPR0   6
         3 000365   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000366   000000 701000 xent               TSX1    ASH$INFO
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:26   
         3 000367   000000 011000                    NOP     0

      165    20628    3         FORM_KEY = USERS_KEY;

  20628  3 000370   000100 100400                    MLR     fill='000'O
         3 000371   000000 000007 xsym               ADSC9   USERS_KEY                cn=0,n=7
         3 000372   200004 000007                    ADSC9   FORM_KEY,,AUTO           cn=0,n=7

      166    20629    4         IF FS$FORMREC.FNAME ~= FORM_KEY.TEXT THEN DO;

  20629  3 000373   000000 470400 xsym               LDP0    DSEG2$
         3 000374   040100 106500                    CMPC    fill='040'O
         3 000375   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6
         3 000376   200004 200006                    ADSC9   FORM_KEY,,AUTO           cn=1,n=6
         3 000377   000414 600000 3                  TZE     s:20635

      167    20630    4            USERS_KEY.COUNT = 12;

  20630  3 000400   014000 236003                    LDQ     6144,DU
         3 000401   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      168    20631    4            CALL CONCAT( USERS_KEY.TXTC, FS$FORMREC.FNAME, FORM_KEY.TEXT );

  20631  3 000402   040000 100500                    MLR     fill='040'O
         3 000403   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6
         3 000404   000000 200006 xsym               ADSC9   USERS_KEY                cn=1,n=6
         3 000405   040000 100500                    MLR     fill='040'O
         3 000406   200004 200006                    ADSC9   FORM_KEY,,AUTO           cn=1,n=6
         3 000407   000001 600043 xsym               ADSC9   USERS_KEY+1              cn=3,n=35

      169    20632    4            CALL ASF$DELREC_FORM;

  20632  3 000410   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000411   000000 701000 xent               TSX1    ASF$DELREC_FORM
         3 000412   000000 011000                    NOP     0

      170    20633    4            END;
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:27   

  20633  3 000413   000442 710000 3                  TRA     s:20655

      171    20634    4         ELSE DO;

      172    20635    4            CALL ASF$QUERY_PSEUDO_FORMS( FORM_KEY, PSEUDO_FORM_KEY, PSEUDO_FORMS);

  20635  3 000414   200012 631500                    EPPR1   PSEUDO_FORMS,,AUTO
         3 000415   200030 451500                    STP1    FNAME+4,,AUTO
         3 000416   200006 633500                    EPPR3   PSEUDO_FORM_KEY,,AUTO
         3 000417   200027 453500                    STP3    FNAME+3,,AUTO
         3 000420   200004 634500                    EPPR4   FORM_KEY,,AUTO
         3 000421   200026 454500                    STP4    FNAME+2,,AUTO
         3 000422   200026 630500                    EPPR0   FNAME+2,,AUTO
         3 000423   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000424   000000 701000 xent               TSX1    ASF$QUERY_PSEUDO_FORMS
         3 000425   000000 011000                    NOP     0

      173    20636    5            IF PSEUDO_FORMS THEN DO;

  20636  3 000426   200012 234100                    SZN     PSEUDO_FORMS,,AUTO
         3 000427   000442 605000 3                  TPL     s:20655

      174    20637                    %SCREAM( ERR#=E$PSEUDOS_REMOVED, LEVEL=INFO, MID='R' );

  20645  3 000430   000007 630400 4                  EPPR0   7
         3 000431   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000432   000000 701000 xent               TSX1    ASH$INFO
         3 000433   000000 011000                    NOP     0

      175    20652    5               CALL ASR$R_PSEUDO_FORMS( PSEUDO_FORM_KEY );

  20652  3 000434   200006 630500                    EPPR0   PSEUDO_FORM_KEY,,AUTO
         3 000435   200026 450500                    STP0    FNAME+2,,AUTO
         3 000436   200026 630500                    EPPR0   FNAME+2,,AUTO
         3 000437   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000440   000000 701000 xent               TSX1    ASR$R_PSEUDO_FORMS
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:28   
         3 000441   000000 011000                    NOP     0

      176    20653    5               END;

      177    20654    4            END;

      178    20655    3         END;

  20655  3 000442   000443 710000 3                  TRA     s:20658

      179    20656    3      WHENALTRETURN DO;

      180    20657    3         END;

      181    20658    2      END;

  20658  3 000443   000000 236000 xsym               LDQ     USERS_KEY
         3 000444   000777 376003                    ANQ     511,DU
         3 000445   000176 116003                    CMPQ    126,DU
         3 000446   000216 601000 3                  TNZ     s:20579

      182    20659    1   READ_ERR:
      183    20660    2   IF MERR_CODE.CODE= %E$NOKEY THEN DO;

  20660  3 000447   000000 236000 xsym  READ_ERR     LDQ     ERR_CODE
         3 000450   377770 376007                    ANQ     131064,DL
         3 000451   001020 116007                    CMPQ    528,DL
         3 000452   000460 601000 3                  TNZ     s:20681

      184    20661        /*E* ERROR: ASR-E$FNOEXIST-0
      185    20662             MESSAGE: Form %%U1 %does not exist.
      186    20663        */
      187    20664           %SCREAM( ERR#=E$FNOEXIST, LEVEL=WARN, MID='R' );

  20674  3 000453   000021 630400 4                  EPPR0   17
         3 000454   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000455   000000 701000 xent               TSX1    ASH$WARN
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:29   
         3 000456   000000 011000                    NOP     0

      188    20679    2      END;

  20679  3 000457   000464 710000 3                  TRA     s:20682

      189    20680    1   ELSE
      190    20681    1      CALL ASH$ERROR( ERR_CODE );

  20681  3 000460   000011 630400 4                  EPPR0   9
         3 000461   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000462   000000 701000 xent               TSX1    ASH$ERROR
         3 000463   000000 011000                    NOP     0

      191    20682    1   RETURN;

  20682  3 000464   000000 702200 xent               TSX2  ! X66_ARET
      192    20683    1   END ASR$R_FORM;

PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:30   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   FS_SUPER_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure ASR$R_FORM.
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:31   

 **** Variables and constants ****

  ****  Section 002 RoData ASR$R_FORM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(51)    r     1 REBUILT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    13-0-0/w UBIN        r     1 ARS                        3-0-0/w PTR         r     1 BLK$
    24-0-0/w CHAR(8)     r     1 FNAME                      4-0-0/c STRC(63)    r     1 FORM_KEY
    22-0-0/w UBIN        r     1 I                         23-0-0/w UBIN        r     1 J
    12-0-0/b BIT         r     1 PSEUDO_FORMS               6-0-0/c STRC(117)   r     1 PSEUDO_FORM_KEY
    14-0-0/c STRC(189)   r     1 SAVED_FORM_KEY

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w PTR         r     1 DSEG2$
     0-0-0/w UBIN        r     1 DSEG2SIZE                  0-0-0/b BIT         r     1 DSEG_FLG
     0-0-0/b STRC        r     1 ERR_CODE                   0-0-0/b STRC        r     1 MERR_CODE
     0-0-0/w PTR         r     1 NODE$                      0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3186)  r     1 FS$FORMREC                 0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/w STRC(144)   r     1 P$NODE
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:32   


   Procedure ASR$R_FORM requires 309 words for executable code.
   Procedure ASR$R_FORM requires 26 words of local(AUTO) storage.

    No errors detected in file ASR$REMOVE_FORM.:E05TSI    .
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:33   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:34   
          MINI XREF LISTING

ARS
     20235**DCL     20519<<ASSIGN  20520<>CALL
ASA_BRKS_LOC
     17375**DCL     17375--REDEF
ASB$GETSEG
     20266**DCL-ENT 20495--CALL
ASB$WILD_MATCH
     20245**DCL-ENT 20608--CALL
ASB$WRITE_LO
     20248**DCL-ENT 20592--CALL    20593--CALL    20594--CALL    20612--CALL
ASF$BUILD_FORM
     20251**DCL-ENT 20591--CALL
ASF$DELREC_FORM
     20269**DCL-ENT 20521--CALL    20545--CALL    20610--CALL    20632--CALL
ASF$QUERY_PSEUDO_FORMS
     20260**DCL-ENT 20548--CALL    20635--CALL
ASF$READ_FORM
     20254**DCL-ENT 20520--CALL    20581--CALL
ASF$READ_FORM_SEQ
     20257**DCL-ENT 20583--CALL
ASH$ERROR
     20272**DCL-ENT 20456--CALL    20485--CALL    20509--CALL    20587--CALL    20681--CALL
ASH$INFO
     20278**DCL-ENT 20534--CALL    20561--CALL    20621--CALL    20645--CALL
ASH$WARN
     20275**DCL-ENT 20674--CALL
ASR$R_PSEUDO_FORMS
     20263**DCL-ENT 20568--CALL    20652--CALL
AS_DEFAULT.BANNER_PERM
     18068**DCL     18069--REDEF
AS_DEFAULT.BUDGET.MACCT
     17973**DCL     17977--REDEF
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:35   
AS_DEFAULT.BUDGET.MAX_PROJECTS
     17986**DCL     17989--REDEF
AS_DEFAULT.BUDGET.PACCUM
     17969**DCL     17971--REDEF
AS_DEFAULT.BUDGET.PMAXC
     17964**DCL     17966--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     18084**DCL     18085--REDEF   18086--REDEF
AS_DEFAULT_DREC.PASSWORD
     19338**DCL     19342--REDEF
AS_DEFAULT_DREC.RENAME
     19361**DCL     19362--REDEF
AS_DFLT.BANNER_PERM
     17890**DCL     17891--REDEF
AS_DFLT.BUDGET.MACCT
     17795**DCL     17799--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     17808**DCL     17811--REDEF
AS_DFLT.BUDGET.PACCUM
     17791**DCL     17793--REDEF
AS_DFLT.BUDGET.PMAXC
     17786**DCL     17788--REDEF
AS_DFLT.SETUP_CHRA.TXT
     17906**DCL     17907--REDEF   17908--REDEF
AS_FE_MODE
     17241**DCL     17242--REDEF
AS_FIELD1
     17371**DCL     20525<<ASSIGN  20611<<ASSIGN
AS_FIELD1.COUNT
     17372**DCL     20492<<ASSIGN
AS_FIELD1.TEXT
     17372**DCL     20493<<ASSIGN
AS_MODE
     17238**DCL     17240--REDEF
AS_MOD_USER.ACCESS
     20103**DCL     20104--REDEF
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:36   
AS_MOD_USER.BANNER
     20090**DCL     20091--REDEF
AS_MOD_USER.BANNER_PERM
     20092**DCL     20093--REDEF
AS_MOD_USER.BILL
     20098**DCL     20099--REDEF
AS_MOD_USER.CPROC
     20094**DCL     20095--REDEF
AS_MOD_USER.FEBILL
     20174**DCL     20175--REDEF
AS_MOD_USER.FECXTMEM
     20191**DCL     20192--REDEF
AS_MOD_USER.FEMINTS
     20176**DCL     20177--REDEF
AS_MOD_USER.FEMMEM
     20187**DCL     20188--REDEF
AS_MOD_USER.FEMTIME
     20185**DCL     20186--REDEF
AS_MOD_USER.FEPPRIV
     20182**DCL     20184--REDEF
AS_MOD_USER.FEPRIV
     20179**DCL     20181--REDEF
AS_MOD_USER.FORCE_BIT
     20088**DCL     20089--REDEF
AS_MOD_USER.KEY
     20170**DCL     20172--REDEF
AS_MOD_USER.LASTCPROC
     20096**DCL     20097--REDEF
AS_MOD_USER.LIMITS.DO_
     20144**DCL     20145--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     20160**DCL     20161--REDEF
AS_MOD_USER.LIMITS.LO
     20140**DCL     20141--REDEF
AS_MOD_USER.LIMITS.MEM
     20136**DCL     20137--REDEF
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:37   
AS_MOD_USER.LIMITS.MPRIO
     20164**DCL     20165--REDEF
AS_MOD_USER.LIMITS.PDIS
     20152**DCL     20153--REDEF
AS_MOD_USER.LIMITS.PO
     20148**DCL     20149--REDEF
AS_MOD_USER.LIMITS.TDIS
     20156**DCL     20157--REDEF
AS_MOD_USER.LIMITS.TIME
     20132**DCL     20133--REDEF
AS_MOD_USER.MAXENQ
     20113**DCL     20114--REDEF
AS_MOD_USER.PERM_BIT
     20086**DCL     20087--REDEF
AS_MOD_USER.PPRIV
     20108**DCL     20110--REDEF
AS_MOD_USER.PRIOB
     20115**DCL     20116--REDEF
AS_MOD_USER.PRIV
     20105**DCL     20107--REDEF
AS_MOD_USER.QUAN
     20111**DCL     20112--REDEF
AS_MOD_USER.SETUP
     20084**DCL     20085--REDEF
AS_PROJECT.BANNER_PERM
     18424**DCL     18425--REDEF
AS_PROJECT.BUDGET.MACCT
     18329**DCL     18333--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     18342**DCL     18345--REDEF
AS_PROJECT.BUDGET.PACCUM
     18325**DCL     18327--REDEF
AS_PROJECT.BUDGET.PMAXC
     18320**DCL     18322--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     18440**DCL     18441--REDEF   18442--REDEF
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:38   
AS_PROJECT_DFLT.BANNER_PERM
     18602**DCL     18603--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     18507**DCL     18511--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     18520**DCL     18523--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     18503**DCL     18505--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     18498**DCL     18500--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     18618**DCL     18619--REDEF   18620--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     19824**DCL     19828--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     19847**DCL     19848--REDEF
AS_PROJECT_DREC.PASSWORD
     19662**DCL     19666--REDEF
AS_PROJECT_DREC.RENAME
     19685**DCL     19686--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     18246**DCL     18247--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     18151**DCL     18155--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     18164**DCL     18167--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     18147**DCL     18149--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     18142**DCL     18144--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     18262**DCL     18263--REDEF   18264--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     19500**DCL     19504--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     19523**DCL     19524--REDEF
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:39   
AS_USERS.BANNER_PERM
     17712**DCL     17713--REDEF
AS_USERS.BUDGET.MACCT
     17617**DCL     17621--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     17630**DCL     17633--REDEF
AS_USERS.BUDGET.PACCUM
     17613**DCL     17615--REDEF
AS_USERS.BUDGET.PMAXC
     17608**DCL     17610--REDEF
AS_USERS.SETUP_CHRA.TXT
     17728**DCL     17729--REDEF   17730--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     18780**DCL     18781--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     18685**DCL     18689--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     18698**DCL     18701--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     18681**DCL     18683--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     18676**DCL     18678--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     18796**DCL     18797--REDEF   18798--REDEF
BLK$
     20227**DCL     20287--IMP-PTR 20438<<ASSIGN  20439>>IF      20461>>IF      20461>>IF      20461>>IF
     20461>>IF      20461>>IF      20461>>IF      20491>>ASSIGN  20491>>ASSIGN  20492>>ASSIGN  20493>>ASSIGN
     20493>>ASSIGN
DSEG2$
     17377**DCL     20375--IMP-PTR 20520<>CALL    20542>>IF      20544>>CALLBLT 20581<>CALL    20583<>CALL
     20604>>CALLBLT 20608>>CALL    20629>>IF      20631>>CALLBLT
DSEG2SIZE
     17377**DCL     20579>>ASSIGN  20582>>ASSIGN
DSEG_FLG
     17376**DCL     20494>>IF
ERR_CODE
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:40   
     17370**DCL     17371--REDEF   20681<>CALL
FNAME
     20241**DCL     20514<<ASSIGN  20515>>CALLBLT 20589>>IF      20600>>CALLBLT 20608<>CALL
FORM_KEY
     20228**DCL     20541<<ASSIGN  20548<>CALL    20628<<ASSIGN  20635<>CALL
FORM_KEY.TEXT
     20230**DCL     20542>>IF      20544>>CALLBLT 20629>>IF      20631>>CALLBLT
FS$FORMREC.CHAINS
     20423**DCL     20433--REDEF
FS$FORMREC.FNAME
     20376**DCL     20542>>IF      20544>>CALLBLT 20604>>CALLBLT 20608<>CALL    20629>>IF      20631>>CALLBLT
I
     20239**DCL     20515<<CALLBLT 20579<<ASSIGN  20581<>CALL    20582<<ASSIGN  20583<>CALL    20600<<CALLBLT
     20603>>IF      20603<<ASSIGN  20608<>CALL
J
     20240**DCL     20604<<CALLBLT 20607>>IF      20607<<ASSIGN  20608<>CALL
KL_DEFAULT.PASSWORD
     19986**DCL     19990--REDEF
KL_DEFAULT.RENAME
     20009**DCL     20010--REDEF
KL_DFLT.PASSWORD
     19176**DCL     19180--REDEF
KL_DFLT.RENAME
     19199**DCL     19200--REDEF
KL_DREC.PASSWORD
     19014**DCL     19018--REDEF
KL_DREC.RENAME
     19037**DCL     19038--REDEF
KL_DREC_CNT.PASSWORD
     18901**DCL     18905--REDEF
KL_DREC_CNT.RENAME
     18924**DCL     18925--REDEF
MERR_CODE
     17371**DCL     20587<>CALL
MERR_CODE.CODE
     17371**DCL     20585>>IF      20660>>IF
PL6.E3A0      #001=ASR$R_FORM File=ASR$REMOVE_FORM.:E05TSI                       TUE 07/29/97 10:49 Page:41   
NODE$
     17368**DCL     20325--IMP-PTR 20438>>ASSIGN
OUT$SYM.COUNT
     20310**DCL     20313--IMP-SIZ 20439>>IF      20461>>IF      20461>>IF      20461>>IF      20491>>ASSIGN
     20492>>ASSIGN  20493>>ASSIGN
OUT$SYM.TEXT
     20313**DCL     20461>>IF      20461>>IF      20461>>IF      20491>>ASSIGN  20493>>ASSIGN
P$NODE.SUBLK$
     20358**DCL     20438>>ASSIGN  20438>>ASSIGN
PROJ_KEY.TEXT
     17248**DCL     17248--REDEF
PROJ_KEY.TXT.PROJECT
     17248**DCL     17248--REDEF
PSEUDO_FORMS
     20234**DCL     20548<>CALL    20549>>IF      20635<>CALL    20636>>IF
PSEUDO_FORM_KEY
     20231**DCL     20548<>CALL    20568<>CALL    20635<>CALL    20652<>CALL
READ_ERR
     20660**LABEL   20520--CALLALT
REBUILT
     20242**DCL     20593<>CALL    20593--CALL
REMEM_VAR
     17374**DCL     17374--REDEF
REM_FCMD
     17374**DCL     17375--REDEF
SAVED_FORM_KEY
     20236**DCL     20576<<ASSIGN  20580>>ASSIGN  20598<<ASSIGN
USERS_KEY
     17245**DCL     20520<>CALL    20525>>ASSIGN  20541>>ASSIGN  20575<<ASSIGN  20576>>ASSIGN  20580<<ASSIGN
     20581<>CALL    20598>>ASSIGN  20611>>ASSIGN  20628>>ASSIGN
USERS_KEY.COUNT
     17245**DCL     20490<<ASSIGN  20543<<ASSIGN  20578>>DOUNTIL 20630<<ASSIGN
USERS_KEY.TEXT
     17245**DCL     17246--REDEF   17246--REDEF   17246--REDEF   17247--REDEF   20577>>DOWHILE
USERS_KEY.TXTC
     17246**DCL     20491<<ASSIGN  20514>>ASSIGN  20544<<CALLBLT 20631<<CALLBLT
