VERSION E05

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:1    
        1        1        /*M*  DDA$DISPFMT - formats up to 576 bit value into output buffer */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*F*  NAME:    DDA$DISPFMT
       10       10              PURPOSE: Output data up to 576 bits long, and format it, as
       11       11                       specified, into output buffer at S_D.D$.
       12       12
       13       13              DESCRIPTION: Depending on the system environment the user is in
       14       14                       ( either HOST or L6 ) and the format specified, this
       15       15                       module formats the input data accordingly to make the
       16       16                       best sense out of it.
       17       17
       18       18                                                                    *
       19       19              INPUT:   PFMT   - Format code.  See DD$DITEM for its value subs.
       20       20                       SIZE   - Number of bits to be formatted.  Some formats
       21       21                                require particular SIZE values.
       22       22
       23       23                       VALUEP - The input data to be formatted.  Generally, the
       24       24                                interpretation of it depends on the combination
       25       25                                of PFMT and the environment.  For the rest,
       26       26                                if the environment is HOST, then input is expected
       27       27                                to be left justified.  If the envoronment is L6,
       28       28                                then each L6 word ( 16 bits ) is expected to be
       29       29                                contained in one HOST word ( 36 bits ) left justified.
       30       30                                Within each L6 word, data is expected to be left
       31       31                                justified.  There are also a few special formats
       32       32                                which don't fall into either catagory. */
       33       33        %EJECT;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:2    
       34       34
       35       35        DDA$DISPFMT: PROC(PFMT, SIZE, VALUEP, PUP, PNO_UDEFS, PNPOINTERS) ALTRET;
       36       36                                                /* Parms */
       37       37    1   DCL PFMT UBIN;
       38       38    1   DCL SIZE SBIN;
       39       39    1   DCL VALUEP CHAR(64) DALIGNED;
       40       40    1   DCL 1 PUP ALIGNED,
       41       41    1         2 * UBIN(22) UNAL,
       42       42    1         2 SCALE SBIN(8) UNAL,
       43       43    1         2 PUB UBIN(2) UNAL,
       44       44    1         2 SIGNPOS UBIN(2) UNAL,
       45       45    1         2 SIGNTYP BIT(1),
       46       46    1         2 SIGNOVER BIT(1);
       47       47    1   DCL PNO_UDEFS BIT(1) ALIGNED; /* Set if DDR$POSIT not to search user defs */
       48       48    1   DCL 1 PNPOINTERS ALIGNED,
       49       49    1         2 TRUE SBIN HALF UNAL,
       50       50    1         2 FALSE SBIN HALF UNAL;
       51       51    1   DCL NO_UDEFS BIT(1) ALIGNED;
       52       52    1   DCL CVALUES CHAR(64) DALIGNED;
       53       53    1   DCL HOST_VAL (0:15) REDEF CVALUES BIT(36);
       54       54    1   DCL 1 L6_VAL (0:15) REDEF CVALUES,
       55       55    1         2 * BIT(20) UNAL,
       56       56    1         2 L6_WRD BIT(16) UNAL,
       57       57    1         2 BIT16 REDEF L6_WRD,
       58       58    1           3 SIGN BIT(1) UNAL,
       59       59    1           3 * BIT(15) UNAL;
       60       60    1   DCL CVALUE(0:63) REDEF CVALUES CHAR(1);
       61       61    1   DCL 1 VALUE REDEF CVALUES,
       62       62    1         2 L SBIN,
       63       63    1         2 E REDEF L UBIN(18),
       64       64    1         2 LBITS REDEF L BIT(36),
       65       65    1         2 CODE REDEF L,
       66       66    1           3 FCG(0:2) UBIN(6) UNAL,
       67       67    1           3 MON BIT(1) UNAL,
       68       68    1           3 ERROR UBIN(14) UNAL,
       69       69    1           3 SEV UBIN(3) UNAL,
       70       70    1         2 R SBIN,
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:3    
       71       71    1         2 * CHAR(56);
       72       72    1   DCL 1 PVALUE REDEF CVALUES,
       73       73    1         2 W UBIN(18) UNAL,
       74       74    1         2 C UBIN(2) UNAL,
       75       75    1         2 B UBIN(4) UNAL,
       76       76    1         2 SEG,
       77       77    1           3 S UBIN(2) UNAL,
       78       78    1           3 D UBIN(10) UNAL,
       79       79    1         2 * CHAR(60);
       80       80    1   DCL 1 VVALUE REDEF CVALUES,
       81       81    1         2 W1,
       82       82    1           3 BOUND,
       83       83    1             4 W UBIN(18) UNAL,
       84       84    1             4 C UBIN(2) UNAL,
       85       85    1           3 FLAGS UBIN(9) UNAL,
       86       86    1           3 FLGS REDEF FLAGS,
       87       87    1             4 * BIT(7) UNAL,
       88       88    1             4 NOTEMPTY BIT(1) UNAL,
       89       89    1             4 * BIT(1) UNAL,
       90       90    1           3 TYPE UBIN(2) UNAL,
       91       91    1           3 * UBIN(5) UNAL,
       92       92    1         2 W2,
       93       93    1           3 W UBIN(18) UNAL,
       94       94    1           3 C UBIN(2) UNAL,
       95       95    1           3 B UBIN(4) UNAL,
       96       96    1           3 SEG,
       97       97    1             4 S UBIN(2) UNAL,
       98       98    1             4 D UBIN(10) UNAL,
       99       99    1         2 * CHAR(56);
      100      100    1   DCL 1 RVALUE REDEF CVALUES,
      101      101    1         2 L SBIN,
      102      102    1         2 OFFSET REDEF L UBIN(18),
      103      103    1         2 R SBIN,
      104      104    1         2 E REDEF R UBIN(18),
      105      105    1         2 * CHAR(56);
      106      106    1   DCL VBITS(0:575) REDEF CVALUES UBIN(1) UNAL;
      107      107    1   DCL 1 DVALUE REDEF CVALUES,
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:4    
      108      108    1         2 BOUND,
      109      109    1           3 W UBIN(18) UNAL,
      110      110    1           3 C UBIN(2) UNAL,
      111      111    1         2 SUPER REDEF BOUND,
      112      112    1           3 BASE UBIN(10) UNAL,
      113      113    1           3 BOUND UBIN(10) UNAL,
      114      114    1         2 FWR,
      115      115    1           3 FLAGS UBIN(9) UNAL,
      116      116    1           3 FLGS REDEF FLAGS,
      117      117    1             4 * BIT(7) UNAL,
      118      118    1             4 NOTEMPTY BIT(1) UNAL,
      119      119    1             4 * BIT(1) UNAL,
      120      120    1           3 WSR UBIN(3) UNAL,
      121      121    1         2 FWQ REDEF FWR,
      122      122    1           3 FLAGS UBIN(3) UNAL,
      123      123    1           3 WSQ UBIN(9) UNAL,
      124      124    1         2 TYPE UBIN(4) UNAL,
      125      125    1         2 BASE,
      126      126    1           3 W UBIN(34) UNAL,
      127      127    1           3 C UBIN(2) UNAL,
      128      128    1         2 * CHAR(56);
      129      129    1   DCL 1 EDVALUE REDEF CVALUES,
      130      130    1         2 IC UBIN(18) UNAL,
      131      131    1         2 * UBIN(1) UNAL,
      132      132    1         2 ISEG UBIN(10) UNAL,
      133      133    1         2 WSR UBIN(3) UNAL,
      134      134    1         2 TYPE UBIN(4) UNAL,
      135      135    1         2 LSIZE UBIN(10) UNAL,
      136      136    1         2 LBASE UBIN(23) UNAL,
      137      137    1         2 * UBIN(3) UNAL,
      138      138    1         2 * CHAR(56);
      139      139    1   DCL 1 XVAL(0:63) REDEF CVALUES,
      140      140    1         2 * BIT(1) UNAL,
      141      141    1         2 L UBIN(4) UNAL,
      142      142    1         2 R UBIN(4) UNAL;
      143      143    1   DCL 1 HVAL(0:143) REDEF CVALUES,
      144      144    1         2 H UBIN(4) UNAL;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:5    
      145      145    1   DCL KVALUE(0:15) REDEF CVALUES UBIN;
      146      146    1   DCL DKVALUE(0:7) REDEF CVALUES BIT(72);
      147      147    1   DCL HOST_CHAR (0:63) REDEF CVALUES UBIN(9) UNAL;
      148      148    1   DCL 1 L6_PTR REDEF CVALUES,
      149      149    1         2 * BIT(20),
      150      150    1         2 BYTE_NUM BIT(1),
      151      151    1         2 UNUSED UBIN(11) UNAL,
      152      152    1         2 LEFT4 BIT(4),
      153      153    1         2 * BIT(20),
      154      154    1         2 RIGHT16 BIT(16),
      155      155    1         2 * (0:13) BIT(36);
      156      156    1   DCL 1 L6_AR REDEF CVALUES,
      157      157    1         2 * BIT(20),
      158      158    1         2 LEFT16 BIT(16),
      159      159    1         2 * BIT(20),
      160      160    1         2 RIGHT4 BIT(4),
      161      161    1         2 BYTE_NUM UBIN(1) UNAL,
      162      162    1         2 BIT_NUM UBIN(3) UNAL,
      163      163    1         2 * BIT(8),
      164      164    1         2 * (0:13) BIT(36);
      165      165    1   DCL 1 L6_VECTOR REDEF CVALUES,
      166      166    1         2 * BIT(20) UNAL,
      167      167    1         2 BD UBIN(16) UNAL,
      168      168    1         2 * BIT(20) UNAL,
      169      169    1         2 BYTE_NUM BIT(1) UNAL,
      170      170    1         2 * BIT(11) UNAL,
      171      171    1         2 LEFT4 BIT(4) UNAL,
      172      172    1         2 * BIT(20) UNAL,
      173      173    1         2 RIGHT16 BIT(16) UNAL,
      174      174    1         2 * (0:12) BIT(36) UNAL;
      175      175    1   DCL 1 L6_DESC REDEF CVALUES,
      176      176    1         2 * BIT(20) UNAL,
      177      177    1         2 VALID BIT(1) UNAL,
      178      178    1         2 * BIT(3) UNAL,
      179      179    1         2 BASE UBIN(12) UNAL,
      180      180    1         2 * BIT(20) UNAL,
      181      181    1         2 RD_PRIV BIT(2) UNAL,
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:6    
      182      182    1         2 WR_PRIV BIT(2) UNAL,
      183      183    1         2 EX_PRIV BIT(2) UNAL,
      184      184    1         2 * BIT(1) UNAL,
      185      185    1         2 SIZE UBIN(9) UNAL,
      186      186    1         2 * (0:13) BIT(36) UNAL;
      187      187    1   DCL 1 L6_REM REDEF CVALUES,
      188      188    1         2 * BIT(32) UNAL,
      189      189    1         2 AUTO_OFFSET_LEFT4 BIT(4) UNAL,  /* Address of remembered AUTO frame */
      190      190    1         2 * BIT(20) UNAL,
      191      191    1         2 AUTO_OFFSET_RIGHT16 BIT(16) UNAL,
      192      192    1         2 * BIT(32) UNAL,
      193      193    1         2 ADDR_LEFT4 BIT(4) UNAL,         /* Address of remembered statement */
      194      194    1         2 * BIT(20) UNAL,
      195      195    1         2 ADDR_RIGHT16 BIT(16) UNAL,
      196      196    1         2 * (0:11) BIT(36) UNAL;
      197      197    1   DCL 1 L6_CHAR (0:15) REDEF CVALUES,
      198      198    1         2 * BIT(21) UNAL,
      199      199    1         2 L UBIN(7) UNAL,
      200      200    1         2 * BIT(1) UNAL,
      201      201    1         2 R UBIN(7) UNAL;
      202      202    1   DCL 1 L6_EBCHAR (0:15) REDEF CVALUES,
      203      203    1         2 * BIT(20) UNAL,
      204      204    1         2 L UBIN (8) UNAL,
      205      205    1         2 R UBIN (8) UNAL;
      206      206    1   DCL 1 L6_EMSG REDEF CVALUES,
      207      207    1         2 * BIT(20) UNAL,
      208      208    1         2 F1 BIT(8) UNAL,
      209      209    1         2 F2 BIT(8) UNAL,
      210      210    1         2 * BIT(20) UNAL,
      211      211    1         2 E1 BIT(8) UNAL,
      212      212    1         2 E2 BIT(8) UNAL,
      213      213    1         2 * (0:13) BIT(36) UNAL;
      214      214    1   DCL 1 L6_UPDEC ( 0:15 ) REDEF CVALUES,
      215      215    1         2 * BIT(20) UNAL,
      216      216    1         2 L UBIN(8) UNAL,
      217      217    1         2 R UBIN(8) UNAL;
      218      218    1   DCL 1 L6_PDEC ( 0:15 ) REDEF CVALUES,
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:7    
      219      219    1         2 * BIT(20) UNAL,
      220      220    1         2 L1 UBIN(4) UNAL,
      221      221    1         2 L2 UBIN(4) UNAL,
      222      222    1         2 R1 UBIN(4) UNAL,
      223      223    1         2 R2 UBIN(4) UNAL;
      224      224    1   DCL HOST_NUVAL(0:15) BIT(36) ALIGNED;
      225      225    1   DCL HOST_NUCHARS REDEF HOST_NUVAL CHAR(64);
      226      226    1   DCL HOST_NUCHAR (0:63) REDEF HOST_NUVAL CHAR(1);
      227      227    1   DCL 1 PCHAR ( 0:63 ) REDEF HOST_NUVAL,
      228      228    1         2 LEFT5 UBIN ( 5 ) UNAL,
      229      229    1         2 RIGHT4 UBIN ( 4 ) UNAL;
      230      230    1   DCL NUVAL_BITS (0:575) REDEF HOST_NUVAL BIT(1);
      231      231    1   DCL 1 HOST_NUVAL1 REDEF HOST_NUVAL,
      232      232    1         2 * BIT(1) UNAL,
      233      233    1         2 HOST_WRD(0:14) BIT(36) UNAL,
      234      234    1         2 * BIT(35) UNAL;
      235      235    1   DCL 1 HOST_NUVAL2 REDEF HOST_NUVAL,
      236      236    1         2 * BIT(2) UNAL,
      237      237    1         2 HOST_WRD(0:14) BIT(36) UNAL,
      238      238    1         2 * BIT(34) UNAL;
      239      239    1   DCL 1 HOST_NUVAL3 REDEF HOST_NUVAL,
      240      240    1         2 * BIT(3) UNAL,
      241      241    1         2 HOST_WRD(0:14) BIT(36) UNAL,
      242      242    1         2 * BIT(33) UNAL;
      243      243    1   DCL L6_NUVAL(0:35) REDEF HOST_NUVAL BIT(16);
      244      244    1   DCL 1 L6_NUVAL1 REDEF HOST_NUVAL,
      245      245    1         2 * BIT(1) UNAL,
      246      246    1         2 L6_WRD(0:34) BIT(16) UNAL,
      247      247    1         2 * BIT(15) UNAL;
      248      248    1   DCL 1 L6_NUVAL2 REDEF HOST_NUVAL,
      249      249    1         2 * BIT(2) UNAL,
      250      250    1         2 L6_WRD (0:34) BIT(16) UNAL,
      251      251    1         2 * BIT(14) UNAL;
      252      252    1   DCL 1 L6_NUVAL3 REDEF HOST_NUVAL,
      253      253    1         2 * BIT(3) UNAL,
      254      254    1         2 L6_WRD(0:34) BIT(16) UNAL,
      255      255    1         2 * BIT(13) UNAL;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:8    
      256      256    1   DCL OCT_VAL (0:191) REDEF HOST_NUVAL UBIN(3) UNAL;
      257      257    1   DCL HEX_VAL (0:143) REDEF HOST_NUVAL UBIN(4) UNAL;
      258      258    1   DCL 1 ERR_VAL REDEF HOST_NUVAL,
      259      259    1         2 L ,
      260      260    1           3 * BIT(1) UNAL,
      261      261    1           3 F1 BIT(8) UNAL,
      262      262    1           3 * BIT(1) UNAL,
      263      263    1           3 F2 BIT(8) UNAL,
      264      264    1           3 * BIT(1) UNAL,
      265      265    1           3 E1 BIT(8) UNAL,
      266      266    1           3 * BIT(1) UNAL,
      267      267    1           3 E2 BIT(8) UNAL,
      268      268    1         2 * (0:14) BIT(36) UNAL;
      269      269                                                /* Locals */
      270      270    1   DCL TEXTR CHAR(NCHARS) BASED;
      271      271    1   DCL FMT UBIN;
      272      272    1   DCL NU_SIZE SBIN;
      273      273    1   DCL WRD_SIZE UBIN;
      274      274    1   DCL NCHARS UBIN;
      275      275    1   DCL PUB UBIN;
      276      276    1   DCL ACHARTEMP(0:63) CHAR(1);
      277      277    1   DCL CHARTEMP REDEF ACHARTEMP CHAR(64);
      278      278    1   DCL ZEROES(0:63) CHAR(1) CONSTANT INIT('0'*64);
      279      279    1   DCL ZERO REDEF ZEROES CHAR(64);
      280      280    1   DCL TEMP UBIN;
      281      281    1   DCL CHARS UBIN;
      282      282    1   DCL SCHAR CHAR(1);
      283      283    1   DCL SDIGIT CHAR(1);
      284      284    1   DCL SIGNPOS UBIN;
      285      285    1   DCL SIGNOVER BIT(1);
      286      286    1   DCL SIG BIT(1);
      287      287    1   DCL SCALE SBIN;
      288      288    1   DCL CTEMP CHAR(1);
      289      289    1   DCL SIZED9 UBIN;
      290      290    1   DCL I UBIN;
      291      291    1   DCL J UBIN;
      292      292    1   DCL NEG BIT(1);
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:9    
      293      293    1   DCL VALW UBIN;
      294      294    1   DCL VALWC CHAR(5);
      295      295    1   DCL TYPE UBIN;
      296      296    1   DCL TENTRY# UBIN;
      297      297    1   DCL FENTRY# UBIN;
      298      298    1   DCL TENTRY$ PTR;
      299      299    1   DCL FENTRY$ PTR;
      300      300    1   DCL BITCHAR(0:1) CONSTANT CHAR(1) INIT('0','1');
      301      301    1   DCL SEGID(0:3) CHAR(3) CONSTANT INIT(
      302      302    1             '$PS','$$$','$AS','$LS');
      303      303    1   DCL DIGITS CHAR(10) CONSTANT INIT('0123456789');
      304      304    1   DCL OCTCHARS(0:7) CHAR(1) CONSTANT INIT(
      305      305    1        '0','1','2','3','4','5','6','7');
      306      306    1   DCL HEXCHARS(0:15) CHAR(1) CONSTANT INIT(
      307      307    1        '0','1','2','3','4','5','6','7','8','9','A','B','C','D','E','F');
      308      308        /* The following table use a 9-bit EBCDIC character value as an index
      309      309           into an EBCDIC character.
      310      310               for the 9-bit EBCDIC character value -
      311      311                   the 9th bit has to be '0'B and 8 bits are needed to
      312      312                   distinguish a letter. */
      313      313
      314      314        %INCLUDE B$TABLES_C;
      315      422        %B$XL_EBC_DUMP(NAME=EBCDIC_XLATE_TBL);
      316      426    1   DCL AN CHAR(25);
      317      427    1   DCL POWER SBIN;
      318      428    1   DCL MYBUF CHAR(192);
      319      429    1   DCL MYBUF$ PTR;
      320      430    1   DCL OFFSET SBIN;
      321      431    1   DCL VAL SBIN;
      322      432    1   DCL VALBITS(0:35) REDEF VAL UBIN(1) UNAL;
      323      433    1   DCL 1 PWRD_VAL REDEF VAL,
      324      434    1         2 * BIT(16) UNAL,
      325      435    1         2 LEFT4 BIT(4) UNAL,
      326      436    1         2 RIGHT16 BIT(16) UNAL;
      327      437    1   DCL 1 AWRD_VAL REDEF VAL,
      328      438    1         2 * BIT(16) UNAL,
      329      439    1         2 LEFT16 BIT(16) UNAL,
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:10   
      330      440    1         2 RIGHT4 BIT(4) UNAL;
      331      441    1   DCL 1 DWRD_VAL REDEF VAL,
      332      442    1         2 * BIT(34) UNAL,
      333      443    1         2 RIGHT2 BIT(2) UNAL;
      334      444    1   DCL 1 L6TIME_VAL REDEF VAL,
      335      445    1         2 * BIT(4) UNAL,
      336      446    1         2 L BIT(16) UNAL,
      337      447    1         2 R BIT(16) UNAL,
      338      448    1         2 BITS(0:15) REDEF R BIT(1) UNAL;
      339      449    1   DCL TEXT$ PTR;
      340      450    1   DCL SAVE_EWSQ# UBIN;
      341      451                                                /* Misc */
      342      452    1   DCL CHAR1 CHAR(1) BASED;
      343      453    1   DCL CHAR2 CHAR(2) BASED;
      344      454    1   DCL CHAR3 CHAR(3) BASED;
      345      455    1   DCL CHAR4 CHAR(4) BASED;
      346      456    1   DCL CHAR5 CHAR(5) BASED;
      347      457    1   DCL CHAR6 CHAR(6) BASED;
      348      458    1   DCL CHAR7 CHAR(7) BASED;
      349      459    1   DCL CHAR8 CHAR(8) BASED;
      350      460    1   DCL CHAR9 CHAR(9) BASED;
      351      461    1   DCL CHAR11 CHAR(11) BASED;
      352      462    1   DCL CHAR13 CHAR(13) BASED;
      353      463    1   DCL CHAR15 CHAR(15) BASED;
      354      464    1   DCL CHAR16 CHAR(16) BASED;
      355      465    1   DCL CHAR62 CHAR(62) BASED;
      356      466    1   DCL UBIN9 UBIN BYTE BASED CALIGNED;
      357      467    1   DCL B$BITS(0:575) BIT(1) BASED UNAL;
      358      468             %INCLUDE DD$DITEM;
       12+     571             %LIST;
       13+     572    1        DCL SDD$ PTR;
       14+     573    1        DCL ZITEM$ PTR;
       15+     574    1        DCL SDD_L6$ PTR;
       16+     575    1        DCL ZITEM_L6$ PTR;
      359     1149             %INCLUDE XUH_MACRO_C;
      360     1233             %INCLUDE DD_SD_M;
      361     2569             % S_D;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:11   
      362     3887             %INCLUDE DD_ERR_C;
      363     4284    1   DCL D_XDELTA BIT(1) SYMREF;
      364     4285    1   DCL USE$ PTR SYMREF;
      365     4286             %INCLUDE DD$BASED;
      366     5589                %MODIFY$CMD;
      367     5605             %INCLUDE DD_SUBS_C;
      368     5876             %U$SE;
      369     5884             %INCLUDE B_STRINGS_C;
      370     6013             %INCLUDE B$OBJECT_C;
      371     9443             %B$DNAME;
      372     9462                                                /* External entries */
      373     9463    1   DCL DDR$BINOCT ENTRY(2) ALTRET;
      374     9464    1   DCL DDR$BINTXT ENTRY(4);
      375     9465    1   DCL DDE$ERROR ENTRY;
      376     9466    1   DCL DDR$BUMPC_D$ ENTRY(1) ALTRET;
      377     9467    1   DCL DDA$DISPUI ENTRY(2);
      378     9468    1   DCL DDR$INSTR ENTRY(1) ALTRET;
      379     9469    1   DCL DFR$INSTR ENTRY(4) ALTRET;
      380     9470    1   DCL DDR$POSIT ENTRY(5) ALTRET;
      381     9471    1   DCL DDQ$WRITE ENTRY(2);
      382     9472    1   DCL DDR$MOVE ENTRY(4) ALTRET;
      383     9473    1   DCL DDF$DBG_# ENTRY(2) ALTRET;
      384     9474    1   DCL DDS$IC2NODE ENTRY(2) ALTRET;
      385     9475    1   DCL DUE$JERRMSG ENTRY(0);
      386     9476    1   DCL DDA$UTSTIME ENTRY(2) ALTRET;
      387     9477    1   DCL DFR$UTSTIME ENTRY(2) ALTRET;
      388     9478    1   DCL DDK$COMP1 ENTRY(1);
      389     9479    1   DCL DDK$COMP2 ENTRY(1);
      390     9480                                                /* COMMON LIB ROUTINES */
      391     9481    1   DCL XPN_7RTOLSP ENTRY(5) ALTRET;        /* SINGLE FLOAT TO DIGITS & POWER */
      392     9482    1   DCL XPN_7DTOLSP ENTRY(5) ALTRET;        /* DOUBLE FLOAT TO DIGITS & POWER */
      393     9483    1   DCL XPN_7AQTOLSP ENTRY(5) ALTRET;       /* EA[Q] FLOAT TO DIGITS & POWER */
      394     9484    1   DCL XPN_7FLJ ENTRY(7) ALTRET;           /* DIGITS & POWER TO F FMT */
      395     9485    1   DCL XPN_7ELJE1 ENTRY(8) ALTRET;         /* DIGITS & POWER TO E FMT */
      396     9486    1   DCL DUE$L6JERRMSG ENTRY;
      397     9487        %EJECT;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:12   
      398     9488                                                /**/
      399     9489    1        IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      400     9490    1        THEN WRD_SIZE = 36;
      401     9491    1        ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      402     9492    1             THEN WRD_SIZE = 16;
      403     9493    2             ELSE DO;
      404     9494    2                  S_D.ERROR = 502;    /* E@DELBUG */
      405     9495    2                  CALL DDE$ERROR;
      406     9496    2                  ALTRETURN;
      407     9497    2                END;
      408     9498    1        IF SIZE > 16 * WRD_SIZE
      409     9499    2        THEN DO;
      410     9500    2             S_D.ERROR = 310;     /* E@CANTFORMAT */
      411     9501    2             ALTRETURN;
      412     9502    2           END;
      413     9503    1        MYBUF$ = ADDR(MYBUF);
      414     9504    1        TEXT$ = S_D.D$;
      415     9505    1        FMT = PFMT;                        /* SEPARATE PARMS FROM LOCAL DATA */
      416     9506    1        CVALUES = VALUEP;
      417     9507    1        IF ADDR(PNO_UDEFS) = ADDR(NIL)
      418     9508    1        THEN NO_UDEFS = '0'B;
      419     9509    1        ELSE NO_UDEFS = PNO_UDEFS;
      420     9510    1        HOST_NUVAL = '0'B;
      421     9511    1        NEG = '0'B;
      422     9512        /*   IF ADDR(PUP)~=ADDR(NIL) THEN
      423     9513                IF PUP.PUB=1  PACKED DECIMAL AND FMT~=%PUP_FMT THEN
      424     9514                   SIZE = (SIZE/2)*9 + MOD(SIZE,2)*4;*/
      425     9515
      426     9516                                                /**/
      427     9517    1   MAJORCASE:
      428     9518    2        DO CASE( FMT );
      429     9519                                                /*******************************
      430     9520                                                 ******* AR_FMT, PTR_FMT *******
      431     9521                                                 *******************************/
      432     9522    2          CASE( %AR_FMT, %PTR_FMT );
      433     9523
      434     9524    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:13   
      435     9525
      436     9526    3               CASE ( %HOST );
      437     9527
      438     9528    3                  IF SIZE ~= 36 THEN GOTO WRONG_SIZE;
      439     9529    3                  VAL = PVALUE.W;
      440     9530    3                  CALL DDR$BINTXT( MYBUF$, VAL, %OCT_FMT, NCHARS );
      441     9531    3                  CALL DDR$BUMPC_D$( NCHARS );
      442     9532    3                  TEXT$ -> TEXTR = MYBUF;
      443     9533    3                  TEXT$ = S_D.D$;
      444     9534    3                  VAL = PVALUE.C;
      445     9535    3                  CALL DDR$BUMPC_D$( 5 )  ALTRET(DERR);
      446     9536    3                  TEXT$ -> CHAR1 = '-';
      447     9537    3                  TEXT$ = PINCRC( TEXT$, 1 );
      448     9538    3                  CALL BINCHAR( TEXT$ -> CHAR1, VAL );
      449     9539    3                  PINCRC( TEXT$, 1 ) -> CHAR1 = '-';
      450     9540    3                  TEXT$ = PINCRC( TEXT$, 2 );
      451     9541    3                  VAL = PVALUE.B;
      452     9542    3                  CALL DDR$BINTXT(MYBUF$, VAL, %UINT_FMT, NCHARS);
      453     9543    3                  CALL DDR$BUMPC_D$(NCHARS - 1) ALTRET(DERR);
      454     9544    3                  TEXT$ -> TEXTR = MYBUF;
      455     9545    3                  TEXT$ = PINCRC(TEXT$, NCHARS - 1);
      456     9546    3                  IF FMT = %AR_FMT
      457     9547    4                  THEN DO;
      458     9548    4                       S_D.D$ = PINCRC(S_D.D$, -1);
      459     9549    4                       RETURN;
      460     9550    4                     END;
      461     9551    3                  PINCRC( TEXT$, 1 ) -> CHAR1 = ',';
      462     9552    3                  TEXT$ = PINCRC( TEXT$, 2 );
      463     9553    3                  VAL = PVALUE.SEG.S;
      464     9554    3                  IF VAL = 1               /* Segid of .2000  is strange */
      465     9555    4                  THEN DO;
      466     9556    4                       VAL = BITBIN( PVALUE.SEG );
      467     9557    4                       CALL DDR$BINTXT( MYBUF$, VAL, %OCT_FMT, NCHARS );
      468     9558    4                       CALL DDR$BUMPC_D$( NCHARS )  ALTRET(DERR);
      469     9559    4                       TEXT$ -> TEXTR = MYBUF;
      470     9560    4                     END;
      471     9561    4                  ELSE DO;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:14   
      472     9562    4                       CALL DDR$BUMPC_D$( 3 )  ALTRET(DERR);
      473     9563    4                       TEXT$ -> CHAR3 = SEGID( VAL ); /* $xS */
      474     9564    4                       TEXT$ = S_D.D$;
      475     9565    4                       VAL = PVALUE.SEG.D;
      476     9566    4                       CALL DDR$BINTXT( MYBUF$, VAL, %UINT_FMT, NCHARS );
      477     9567    4                       CALL DDR$BUMPC_D$( NCHARS ) ALTRET(DERR);
      478     9568    4                       TEXT$ -> TEXTR = MYBUF;
      479     9569    4                     END;
      480     9570    3                  RETURN;
      481     9571
      482     9572    3               CASE ( %L6 );
      483     9573
      484     9574    3                  VAL = 0;
      485     9575    4                  DO CASE ( FMT );
      486     9576
      487     9577    4                    CASE ( %PTR_FMT );
      488     9578
      489     9579    4                       IF SIZE ~= 32 THEN GOTO WRONG_SIZE;
      490     9580    4                       IF L6_PTR.UNUSED ~= 0
      491     9581    5                       THEN DO;
      492     9582    5                            FMT = %X_FMT;
      493     9583    5                            GOTO MAJORCASE;
      494     9584    5                          END;
      495     9585    4                       PWRD_VAL.LEFT4 = L6_PTR.LEFT4;
      496     9586    4                       PWRD_VAL.RIGHT16 = L6_PTR.RIGHT16;
      497     9587    4                       CALL DDR$BINTXT ( MYBUF$, VAL, %X_FMT, NCHARS );
      498     9588    4                       TEXT$ -> TEXTR = MYBUF;
      499     9589    4                       CALL DDR$BUMPC_D$ (NCHARS) ALTRET (DERR);
      500     9590    4                       TEXT$ = S_D.D$;
      501     9591    4                       IF FMT = %EPTR_FMT THEN RETURN;
              9591                                /* EPTR has to be  on word boundry */
      502     9592    4                       IF L6_PTR.BYTE_NUM  /* C PTR */
      503     9593    5                       THEN DO;
      504     9594    5                            TEXT$ -> CHAR2 = '-1';
      505     9595    5                            CALL DDR$BUMPC_D$ ( LENGTHC('-1')) ALTRET (DERR);
      506     9596    5                          END;
      507     9597
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:15   
      508     9598    4                    CASE ( %AR_FMT );
      509     9599
      510     9600    4                       S_D.ERROR = 311; /* E@WRONFEPFMT */
      511     9601    4                       GOTO DERR;
      512     9602
      513     9603    4                    END;
      514     9604    3                  RETURN;
      515     9605    3               END;
      516     9606                                                /***********************
      517     9607                                                 ******* BIT_FMT *******
      518     9608                                                 ***********************/
      519     9609    2          CASE( %BIT_FMT );
      520     9610    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      521     9611    3             THEN DO;
      522     9612    4                  DO I = 0 TO SIZE/16;
      523     9613    4                       L6_NUVAL(I) = L6_VAL.L6_WRD(I);
      524     9614    4                     END;
      525     9615    3                  VBITS = L6_NUVAL;
      526     9616    3                END;
      527     9617    2             CALL DDR$BUMPC_D$( SIZE + 3 ) ALTRET(DERR);
      528     9618    2             TEXT$ -> CHAR1 = '''';
      529     9619    2             TEXT$ = PINCRC(TEXT$, 1);
      530     9620    3             DO I = 0 TO SIZE - 1;
      531     9621    3                  TEXT$ -> CHAR1 = BITCHAR(VBITS(I));
      532     9622    3                  TEXT$ = PINCRC(TEXT$, 1);
      533     9623    3                END;
      534     9624    2             TEXT$ -> CHAR2 = '''B';
      535     9625    2             RETURN;
      536     9626                                                /************************
      537     9627                                                 ******* CHAR_FMT *******
      538     9628                                                 ************************/
      539     9629    2          CASE( %CHAR_FMT );
      540     9630
      541     9631    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );
      542     9632    3               CASE ( %HOST );
      543     9633    3                  NCHARS = SIZE / 9;
      544     9634    3                  CALL DDR$BUMPC_D$(NCHARS +1) ALTRET(DERR);
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:16   
      545     9635    3                  TEXT$ -> CHAR1 = '''';
      546     9636    3                  PINCRC(TEXT$, 1) -> TEXTR = CVALUES;
      547     9637    3                  S_D.D$ -> CHAR1 = '''';
      548     9638    3                  CALL DDR$BUMPC_D$(1) ALTRET(DERR);
      549     9639    3               CASE ( %L6 );
      550     9640    3                  TEXT$ -> CHAR1 = '''';
      551     9641    3                  CALL DDR$BUMPC_D$ ( 1 ) ALTRET ( DERR );
      552     9642    3                  TEXT$ = S_D.D$;
      553     9643    3                  J = 0;
      554     9644    4                  DO I = 0 TO SIZE / 16 ;
      555     9645    4                       HOST_CHAR ( J ) = L6_CHAR.L ( I );
      556     9646    4                       J = J + 1;
      557     9647    4                       HOST_CHAR ( J ) = L6_CHAR.R ( I );
      558     9648    4                       J = J + 1;
      559     9649    4                     END;
      560     9650    3                  NCHARS = SIZE / 8;
      561     9651    3                  TEXT$ -> TEXTR = CVALUES;
      562     9652    3                  CALL DDR$BUMPC_D$ ( NCHARS ) ALTRET ( DERR );
      563     9653    3                  TEXT$ = S_D.D$;
      564     9654    3                  TEXT$ -> CHAR1 = '''';
      565     9655    3                  CALL DDR$BUMPC_D$ ( 1 ) ALTRET ( DERR );
      566     9656    3               END;
      567     9657    2             RETURN;
      568     9658                                                /****************************
      569     9659                                                 ******* CMPXFORT_FMT *******
      570     9660                                                 ****************************/
      571     9661    2          CASE( %CMPXFORT_FMT );
      572     9662    2             CALL DDR$BUMPC_D$(1) ALTRET(DERR);
      573     9663    2             TEXT$ -> CHAR1 = '(';
      574     9664    2             TEXT$ = S_D.D$;
      575     9665    2             IF SIZE = 72
      576     9666    2             THEN CALL FLOAT(36, KVALUE(0)) ALTRET(BADLIB);
      577     9667    2             ELSE CALL FLOAT(72, DKVALUE(0)) ALTRET(BADLIB);
      578     9668    2             TEXT$ = S_D.D$;
      579     9669    2             CALL DDR$BUMPC_D$(2) ALTRET(DERR);
      580     9670    2             TEXT$ -> CHAR2 = ', ';
      581     9671    2             TEXT$ = S_D.D$;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:17   
      582     9672    2             IF SIZE = 72
      583     9673    2             THEN CALL FLOAT(36, KVALUE(1)) ALTRET(BADLIB);
      584     9674    2             ELSE CALL FLOAT(72, DKVALUE(1)) ALTRET(BADLIB);
      585     9675    2             TEXT$ = S_D.D$;
      586     9676    2             CALL DDR$BUMPC_D$(1) ALTRET(DERR);
      587     9677    2             TEXT$ -> CHAR1 = ')';
      588     9678    2             RETURN;
      589     9679                                                /*************************
      590     9680                                                 ******* COMP1_FMT *******
      591     9681                                                 *************************/
      592     9682    2          CASE( %COMP1_FMT );
      593     9683    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST THEN
      594     9684    3             DO;
      595     9685    3                  CALL DDK$COMP1 (VALUE.L);
      596     9686    3                  SIZE = 36;
      597     9687    3                END;
      598     9688    2             FMT = %SINT_FMT;
      599     9689    2             GOTO SINTFMT;
      600     9690                                                /*************************
      601     9691                                                 ******* COMP2_FMT *******
      602     9692                                                 *************************/
      603     9693    2          CASE( %COMP2_FMT );
      604     9694    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST THEN
      605     9695    2                  CALL DDK$COMP2( VALUE.L );
      606     9696    2             FMT = %SINT_FMT;
      607     9697    2             GOTO SINTFMT;
      608     9698                                                /************************
      609     9699                                                 ******* DESC_FMT *******
      610     9700                                                 ************************/
      611     9701    2          CASE( %DESC_FMT );
      612     9702
      613     9703    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );
      614     9704
      615     9705    3               CASE ( %HOST );
      616     9706
      617     9707    3                  IF SIZE ~= 72 AND SIZE ~= 36 THEN GOTO WRONG_SIZE;
      618     9708    3                  TEXT$ = S_D.D$;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:18   
      619     9709    3                  TYPE = DVALUE.TYPE;
      620     9710    4                  DO CASE( TYPE );
      621     9711    4                    CASE( 0, 1, 2, 3 );
      622     9712    4                       IF SIZE = 72
      623     9713    5                       THEN DO;
      624     9714    5                            VAL = DVALUE.BASE.W;
      625     9715    5                            CALL DDR$BINTXT(MYBUF$, VAL, %OCT_FMT, NCHARS);
      626     9716    5                            CALL DDR$BUMPC_D$(NCHARS) ALTRET(DERR);
      627     9717    5                            TEXT$ -> TEXTR = MYBUF;
      628     9718    5                            TEXT$ = S_D.D$;
      629     9719    5                            VAL = DVALUE.BASE.C;
      630     9720    5                            IF VAL > 0
      631     9721    6                            THEN DO;
      632     9722    6                                 CALL DDR$BUMPC_D$(2) ALTRET(DERR);
      633     9723    6                                 TEXT$ -> CHAR1 = '-';
      634     9724    6                                 CALL BINCHAR(PINCRC(TEXT$, 1) -> CHAR1, VAL);
      635     9725    6                                 TEXT$ = S_D.D$;
      636     9726    6                               END;
      637     9727    5                            CALL DDR$BUMPC_D$(1) ALTRET(DERR);
      638     9728    5                            TEXT$ -> CHAR1 = ',';
      639     9729    5                            TEXT$ = S_D.D$;
      640     9730    5                          END;
      641     9731    4                       CALL DDR$BUMPC_D$(3) ALTRET(DERR);
      642     9732    4                       TEXT$ -> CHAR3 = 'BD=';
      643     9733    4                       TEXT$ = S_D.D$;
      644     9734    4                       IF TYPE = 2 OR TYPE = 3
      645     9735    4                         OR DVALUE.FWR.FLGS.NOTEMPTY
      646     9736    5                       THEN DO;
      647     9737    5                            VAL = DVALUE.BOUND.W;
      648     9738    5                            CALL DDR$BINTXT(MYBUF$, VAL, %OCT_FMT, NCHARS);
      649     9739    5                            CALL DDR$BUMPC_D$(NCHARS+2) ALTRET(DERR);
      650     9740    5                            TEXT$ -> TEXTR = MYBUF;
      651     9741    5                            TEXT$ = PINCRC(TEXT$, NCHARS + 1);
      652     9742    5                            VAL = DVALUE.BOUND.C;
      653     9743    5                            PINCRC(TEXT$, -1) -> CHAR1 = '-';
      654     9744    5                            CALL BINCHAR(TEXT$ -> CHAR1, VAL);
      655     9745    5                          END;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:19   
      656     9746    5                       ELSE DO;
      657     9747    5                            CALL DDR$BUMPC_D$(5) ALTRET(DERR);
      658     9748    5                            TEXT$ -> CHAR5 = 'EMPTY';
      659     9749    5                          END;
      660     9750    4                       TEXT$ = S_D.D$;
      661     9751    5                       DO CASE( TYPE );
      662     9752    5                         CASE( 0, 1 );
      663     9753    5                            VAL = DVALUE.FWR.FLAGS;
      664     9754    5                            VALW = DVALUE.FWR.WSR;
      665     9755    5                            VALWC = ',WSR=';
      666     9756    5                         CASE( 2, 3 );
      667     9757    5                            VAL = DVALUE.FWQ.FLAGS * 64 + BITBIN('77'O);
      668     9758    5                            VALW = DVALUE.FWQ.WSQ;
      669     9759    5                            VALWC = ',WSQ=';
      670     9760    5                         END;              /* DO CASE( TYPE ) */
      671     9761    4                       CALL DDR$BUMPC_D$(13) ALTRET(DERR);
      672     9762    4                       TEXT$ -> CHAR5 = ',FL=.';
      673     9763    4                       CALL DDR$BINOCT(MYBUF, VAL);
      674     9764    4                       TEXT$ = PINCRC(TEXT$, 5);
      675     9765    4                       TEXT$ -> CHAR3 = PINCRC(MYBUF$, 9) -> CHAR3;
      676     9766    4                       TEXT$ = PINCRC(TEXT$, 3);
      677     9767    4                       TEXT$ -> CHAR5 = VALWC;
      678     9768    4                       TEXT$ = S_D.D$;
      679     9769    4                       CALL DDR$BINTXT(MYBUF$, VALW, %UINT_FMT, NCHARS);
      680     9770    4                       CALL DDR$BUMPC_D$(NCHARS + 5) ALTRET(DERR);
      681     9771    4                       TEXT$ -> TEXTR = MYBUF;
      682     9772    4                       TEXT$ = PINCRC(TEXT$, NCHARS);
      683     9773    4                       TEXT$ -> CHAR4 = ',TY=';
      684     9774    4                       TEXT$ = PINCRC(TEXT$, 4);
      685     9775    4                       CALL BINCHAR(TEXT$ -> CHAR1, TYPE);
      686     9776    4                       RETURN;
      687     9777    4                    CASE( 4, 6);
      688     9778    4                       VAL = DVALUE.SUPER.BASE;
      689     9779    4                       CALL DDR$BINTXT(MYBUF$, VAL, %OCT_FMT, NCHARS);
      690     9780    4                       CALL DDR$BUMPC_D$(NCHARS) ALTRET(DERR);
      691     9781    4                       TEXT$ -> TEXTR = MYBUF;
      692     9782    4                       TEXT$ = S_D.D$;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:20   
      693     9783    4                       CALL DDR$BUMPC_D$(1) ALTRET(DERR);
      694     9784    4                       TEXT$ -> CHAR1 = ',';
      695     9785    4                       TEXT$ = S_D.D$;
      696     9786    4                       CALL DDR$BUMPC_D$(3) ALTRET(DERR);
      697     9787    4                       TEXT$ -> CHAR3 = 'BD=';
      698     9788    4                       TEXT$ = S_D.D$;
      699     9789    4                       IF TYPE = 6
      700     9790    4                         OR DVALUE.FWR.FLGS.NOTEMPTY
      701     9791    5                       THEN DO;
      702     9792    5                            VAL = DVALUE.SUPER.BOUND;
      703     9793    5                            CALL DDR$BINTXT(MYBUF$, VAL, %OCT_FMT, NCHARS);
      704     9794    5                            CALL DDR$BUMPC_D$(NCHARS) ALTRET(DERR);
      705     9795    5                            TEXT$ -> TEXTR = MYBUF;
      706     9796    5                          END;
      707     9797    5                       ELSE DO;
      708     9798    5                            CALL DDR$BUMPC_D$(5) ALTRET(DERR);
      709     9799    5                            TEXT$ -> CHAR5 = 'EMPTY';
      710     9800    5                          END;
      711     9801    4                       TEXT$ = S_D.D$;
      712     9802    5                       DO CASE( TYPE );
      713     9803    5                         CASE( 4 );
      714     9804    5                            VAL = DVALUE.FWR.FLAGS;
      715     9805    5                            VALW = DVALUE.FWR.WSR;
      716     9806    5                            VALWC = ',WSR=';
      717     9807    5                         CASE( 6 );
      718     9808    5                            VAL = DVALUE.FWQ.FLAGS * 64 + BITBIN('77'O);
      719     9809    5                            VALW = DVALUE.FWQ.WSQ;
      720     9810    5                            VALWC = ',WSQ=';
      721     9811    5                         END;              /* DO CASE( TYPE ) */
      722     9812    4                       CALL DDR$BUMPC_D$(13) ALTRET(DERR);
      723     9813    4                       TEXT$ -> CHAR5 = ',FL=.';
      724     9814    4                       CALL DDR$BINOCT(MYBUF, VAL);
      725     9815    4                       TEXT$ = PINCRC(TEXT$, 5);
      726     9816    4                       TEXT$ -> CHAR3 = PINCRC(MYBUF$, 9) -> CHAR3;
      727     9817    4                       TEXT$ = PINCRC(TEXT$, 3);
      728     9818    4                       TEXT$ -> CHAR5 = VALWC;
      729     9819    4                       TEXT$ = S_D.D$;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:21   
      730     9820    4                       CALL DDR$BINTXT(MYBUF$, VALW, %UINT_FMT, NCHARS);
      731     9821    4                       CALL DDR$BUMPC_D$(NCHARS + 5) ALTRET(DERR);
      732     9822    4                       TEXT$ -> TEXTR = MYBUF;
      733     9823    4                       TEXT$ = PINCRC(TEXT$, NCHARS);
      734     9824    4                       TEXT$ -> CHAR4 = ',TY=';
      735     9825    4                       TEXT$ = PINCRC(TEXT$, 4);
      736     9826    4                       CALL BINCHAR(TEXT$ -> CHAR1, TYPE);
      737     9827    4                       TEXT$ = S_D.D$;
      738     9828    4                       IF SIZE = 72
      739     9829    5                       THEN DO;
      740     9830    5                            CALL DDR$BUMPC_D$(3) ALTRET(DERR);
      741     9831    5                            TEXT$ -> CHAR3 = ',L=';
      742     9832    5                            TEXT$ = S_D.D$;
      743     9833    5                            VAL = DVALUE.BASE.W;
      744     9834    5                            CALL DDR$BINTXT(MYBUF$, VAL, %OCT_FMT, NCHARS);
      745     9835    5                            CALL DDR$BUMPC_D$(NCHARS) ALTRET(DERR);
      746     9836    5                            TEXT$ -> TEXTR = MYBUF;
      747     9837    5                            TEXT$ = S_D.D$;
      748     9838    5                            VAL = DVALUE.BASE.C;
      749     9839    5                            IF VAL > 0
      750     9840    6                            THEN DO;
      751     9841    6                                 CALL DDR$BUMPC_D$(2) ALTRET(DERR);
      752     9842    6                                 TEXT$ -> CHAR1 = '-';
      753     9843    6                                 CALL BINCHAR(PINCRC(TEXT$, 1) -> CHAR1, VAL);
      754     9844    6                                 TEXT$ = S_D.D$;
      755     9845    6                               END;
      756     9846    5                          END;
      757     9847    4                       RETURN;
      758     9848    4                    CASE( 8, 9, 11 );
      759     9849    4                       VAL = EDVALUE.IC;
      760     9850    4                       CALL DDR$BINTXT(MYBUF$, VAL, %OCT_FMT, NCHARS);
      761     9851    4                       CALL DDR$BUMPC_D$(NCHARS + 7) ALTRET(DERR);
      762     9852
      763     9853    4                       TEXT$ -> CHAR3 = 'IC=';
      764     9854    4                       TEXT$ = PINCRC(TEXT$, 3);
      765     9855    4                       TEXT$ -> TEXTR = MYBUF;
      766     9856    4                       TEXT$ = PINCRC(TEXT$, NCHARS);
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:22   
      767     9857    4                       TEXT$ -> CHAR4 = ',$LS';
      768     9858    4                       TEXT$ = S_D.D$;
      769     9859    4                       VAL = EDVALUE.ISEG;
      770     9860    4                       CALL DDR$BINTXT(MYBUF$, VAL, %UINT_FMT, NCHARS);
      771     9861    4                       CALL DDR$BUMPC_D$(NCHARS);
      772     9862    4                       TEXT$ -> TEXTR = MYBUF;
      773     9863    4                       TEXT$ = S_D.D$;
      774     9864    4                       IF SIZE = 72
      775     9865    5                       THEN DO;
      776     9866    5                            CALL DDR$BUMPC_D$(7) ALTRET(DERR);
      777     9867    5                            TEXT$ -> CHAR7 = ',LBASE=';
      778     9868    5                            TEXT$ = S_D.D$;
      779     9869    5                            VAL = EDVALUE.LBASE * 2;
      780     9870    5                            CALL DDR$BINTXT(MYBUF$, VAL, %OCT_FMT, NCHARS);
      781     9871    5                            CALL DDR$BUMPC_D$(NCHARS + 7) ALTRET(DERR);
      782     9872    5                            TEXT$ -> TEXTR = MYBUF;
      783     9873    5                            TEXT$ = PINCRC(TEXT$, NCHARS);
      784     9874    5                            TEXT$ -> CHAR7 = ',LSIZE=';
      785     9875    5                            TEXT$ = S_D.D$;
      786     9876    5                            VAL = EDVALUE.LSIZE + 1;
      787     9877    5                            CALL DDR$BINTXT(MYBUF$, VAL, %UINT_FMT, NCHARS);
      788     9878    5                            CALL DDR$BUMPC_D$(NCHARS) ALTRET(DERR);
      789     9879    5                            TEXT$ -> TEXTR = MYBUF;
      790     9880    5                            TEXT$ = PINCRC(TEXT$, NCHARS);
      791     9881    5                          END;
      792     9882    4                       CALL DDR$BUMPC_D$(10) ALTRET(DERR);
      793     9883    4                       TEXT$ -> CHAR5 = ',WSR=';
      794     9884    4                       VAL = EDVALUE.WSR;
      795     9885    4                       TEXT$ = PINCRC(TEXT$, 5);
      796     9886    4                       CALL BINCHAR(TEXT$ -> CHAR1, VAL);
      797     9887    4                       PINCRC(TEXT$, 1) -> CHAR4 = ',TY=';
      798     9888    4                       TEXT$ = S_D.D$;
      799     9889    4                       CALL DDR$BINTXT(MYBUF$, TYPE, %UINT_FMT, NCHARS);
      800     9890    4                       CALL DDR$BUMPC_D$(NCHARS) ALTRET(DERR);
      801     9891    4                       TEXT$ -> TEXTR = MYBUF;
      802     9892    4                       RETURN;
      803     9893    4                    CASE( ELSE );
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:23   
      804     9894    4                       GOTO OCTAL;
      805     9895    4                    END;                   /* DO CASE( TYPE ) */
      806     9896
      807     9897    3               CASE ( %L6 );
      808     9898
      809     9899    3                  IF SIZE ~= 32 THEN GOTO WRONG_SIZE;
      810     9900    3                  VAL = 0;
      811     9901    3                  IF L6_DESC.VALID
      812     9902    3                  THEN TEXT$ -> CHAR11 = 'VALID=''1''B,';
      813     9903    3                  ELSE TEXT$ -> CHAR11 = 'VALID=''0''B,';
      814     9904    3                  CALL DDR$BUMPC_D$ ( 11 ) ALTRET ( DERR );
      815     9905    3                  TEXT$ = S_D.D$;
      816     9906    3                  TEXT$ -> CHAR5 = 'BASE=';
      817     9907    3                  CALL DDR$BUMPC_D$ ( LENGTHC ('BASE=') ) ALTRET ( DERR );
      818     9908    3                  TEXT$ = S_D.D$;
      819     9909    3                  VAL = L6_DESC.BASE;
      820     9910    3                  CALL DDR$BINTXT ( MYBUF$, VAL, %X_FMT, NCHARS );
      821     9911    3                  TEXT$ -> TEXTR = MYBUF;
      822     9912    3                  CALL DDR$BUMPC_D$ ( NCHARS ) ALTRET ( DERR );
      823     9913    3                  TEXT$ = S_D.D$;
      824     9914    3                  TEXT$ -> CHAR9 = ',RD_PRIV=';
      825     9915    3                  CALL DDR$BUMPC_D$ ( LENGTHC ( ',RD_PRIV=' ) ) ALTRET ( DERR );
      826     9916    3                  TEXT$ = S_D.D$;
      827     9917    3                  VAL = 0;
      828     9918    3                  DWRD_VAL.RIGHT2 = L6_DESC.RD_PRIV \ '11'B;
              9918                           /* Convert one's complement */
      829     9919    3                  CALL DDR$BINTXT ( MYBUF$, VAL, %UINT_FMT, NCHARS );
      830     9920    3                  TEXT$ -> TEXTR = MYBUF;
      831     9921    3                  CALL DDR$BUMPC_D$ ( NCHARS ) ALTRET ( DERR );
      832     9922    3                  TEXT$ = S_D.D$;
      833     9923    3                  TEXT$ -> CHAR9 = ',WR_PRIV=';
      834     9924    3                  CALL DDR$BUMPC_D$ ( LENGTHC ( ',WR_PRIV=' ) ) ALTRET ( DERR );
      835     9925    3                  TEXT$ = S_D.D$;
      836     9926    3                  VAL = 0;
      837     9927    3                  DWRD_VAL.RIGHT2 = L6_DESC.WR_PRIV \ '11'B;
      838     9928    3                  CALL DDR$BINTXT ( MYBUF$, VAL, %UINT_FMT, NCHARS );
      839     9929    3                  TEXT$ -> TEXTR = MYBUF;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:24   
      840     9930    3                  CALL DDR$BUMPC_D$ ( NCHARS ) ALTRET ( DERR );
      841     9931    3                  TEXT$ = S_D.D$;
      842     9932    3                  TEXT$ -> CHAR9 = ',EX_PRIV=';
      843     9933    3                  CALL DDR$BUMPC_D$ ( LENGTHC ( ',EX_PRIV=' ) ) ALTRET ( DERR );
      844     9934    3                  VAL = 0;
      845     9935    3                  DWRD_VAL.RIGHT2 = L6_DESC.EX_PRIV \ '11'B;
      846     9936    3                  CALL DDR$BINTXT ( MYBUF$, VAL, %UINT_FMT, NCHARS );
      847     9937    3                  TEXT$ = S_D.D$;
      848     9938    3                  TEXT$ -> TEXTR = MYBUF;
      849     9939    3                  CALL DDR$BUMPC_D$ ( NCHARS ) ALTRET ( DERR );
      850     9940    3                  TEXT$ = S_D.D$;
      851     9941    3                  TEXT$ -> CHAR6 = ',SIZE=';
      852     9942    3                  CALL DDR$BUMPC_D$ ( LENGTHC ( ',SIZE=' ) ) ALTRET ( DERR );
      853     9943    3                  TEXT$ = S_D.D$;
      854     9944    3                  VAL = L6_DESC.SIZE;
      855     9945    3                  CALL DDR$BINTXT ( MYBUF$, VAL, %UINT_FMT, NCHARS );
      856     9946    3                  TEXT$ -> TEXTR = MYBUF;
      857     9947    3                  CALL DDR$BUMPC_D$ ( NCHARS ) ALTRET ( DERR );
      858     9948    3                  RETURN;
      859     9949    3               END;
      860     9950                                                /**************************
      861     9951                                                 ******* EBCDIC_FMT *******
      862     9952                                                 **************************/
      863     9953    2          CASE ( %EBCDIC_FMT );
      864     9954
      865     9955    2             TEXT$ -> CHAR1 = '''';
      866     9956    2             CALL DDR$BUMPC_D$ ( 1 ) ALTRET ( DERR );
      867     9957    2             TEXT$ = S_D.D$;
      868     9958    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN ) ;
      869     9959    3               CASE ( %HOST );
      870     9960    4                  DO I = 0 TO SIZE / 9 - 1;
      871     9961    4                       TEXT$ -> CHAR1 = EBCDIC_XLATE_TBL.C ( HOST_CHAR ( I ) );
      872     9962    4                       CALL DDR$BUMPC_D$ ( 1 ) ALTRET ( DERR );
      873     9963    4                       TEXT$ = S_D.D$;
      874     9964    4                     END;
      875     9965    3               CASE ( %L6 );
      876     9966    3                  J = 0;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:25   
      877     9967    4                  DO I = 0 TO SIZE / 16 ;
      878     9968    4                       HOST_CHAR ( J ) = L6_EBCHAR.L ( I );
      879     9969    4                       J = J + 1;
      880     9970    4                       HOST_CHAR ( J ) = L6_EBCHAR.R ( I );
      881     9971    4                       J = J + 1;
      882     9972    4                     END;
      883     9973    4                  DO I = 0 TO SIZE / 8 - 1;
      884     9974    4                       TEXT$ -> CHAR1 = EBCDIC_XLATE_TBL.C ( HOST_CHAR ( I ) );
      885     9975    4                       CALL DDR$BUMPC_D$ ( 1 ) ALTRET ( DERR );
      886     9976    4                       TEXT$ = S_D.D$;
      887     9977    4                     END;
      888     9978    3               END;
      889     9979    2             TEXT$ -> CHAR3 = '''EB';
      890     9980    2             CALL DDR$BUMPC_D$ ( 3 ) ALTRET ( DERR );
      891     9981    2             RETURN;
      892     9982                                                /************************
      893     9983                                                 ******* EPTR_FMT *******
      894     9984                                                 ************************/
      895     9985    2          CASE ( %EPTR_FMT );
      896     9986
      897     9987    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );
      898     9988    3               CASE ( %HOST );
      899     9989    3                  VALUE.L = VALUE.E;
      900     9990    3                  GOTO REL;
      901     9991    3               CASE ( %L6 );
      902     9992    3                  IF SIZE ~= 32 THEN GOTO WRONG_SIZE;
      903     9993    3                  VAL = 0;
      904     9994    3                  PWRD_VAL.LEFT4 = L6_PTR.LEFT4;
      905     9995    3                  PWRD_VAL.RIGHT16 = L6_PTR.RIGHT16;
      906     9996    3                  GOTO REL6;
      907     9997    3               END;
      908     9998                                                /*************************
      909     9999                                                 ******* FLOAT_FMT *******
      910    10000                                                 *************************/
      911    10001    2          CASE( %FLOAT_FMT );
      912    10002    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );
      913    10003    3               CASE ( %HOST );
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:26   
      914    10004    3                  IF SIZE ~= 36 AND SIZE ~= 72 AND SIZE~=44 AND SIZE~=80
      915    10005    3                  THEN GOTO OCTAL;
      916    10006    3                  CALL FLOAT(SIZE,VALUE) ALTRET(BADLIB);
      917    10007    3               CASE ( %L6 );
      918    10008    3                  S_D.ERROR = 311; /* E@WRONFEPFMT */
      919    10009    3                  GOTO DERR;
      920    10010    3               END;
      921    10011    2             RETURN;
      922    10012    2   BADLIB:
      923    10013    2             S_D.ERROR = 502;         /* E@DELBUG */
      924    10014    2             CALL DDE$ERROR;
      925    10015    2             RETURN;
      926    10016                                                /************************
      927    10017                                                 ******* INST_FMT *******
      928    10018                                                 ************************/
      929    10019    2          CASE( %INST_FMT );
      930    10020    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );
      931    10021    3               CASE ( %HOST );
      932    10022    3                  IF SIZE ~= 36
      933    10023    3                  THEN GOTO OCTAL;
      934    10024    3                  CALL DDR$INSTR(VALUE.L) ALTRET(DERR);
      935    10025    3               CASE ( %L6 );
      936    10026    3                  CALL DFR$INSTR ( CVALUES, NCHARS, '1'B ) ALTRET (DERR);
      937    10027    3               END;
      938    10028    2             RETURN;
      939    10029                                                /***********************
      940    10030                                                 ******* JDE_FMT *******
      941    10031                                                 ***********************/
      942    10032    2          CASE (%JDE_FMT);
      943    10033    2             IF D_XDELTA
      944    10034    3             THEN DO;
      945    10035    3                  IF SIZE ~= 36 THEN GOTO WRONG_SIZE;
      946    10036    3                  CALL DDR$BUMPC_D$(12) ALTRET(DERR);
      947    10037    4                  DO I = 0 TO 2;
      948    10038    4                       IF VALUE.CODE.FCG(I) = 0 THEN TEXT$->CHAR1 = '0';
      949    10039    4                       ELSE IF VALUE.CODE.FCG(I) < 48 THEN TEXT$->UBIN9 = VALUE.CODE.
             10039                                FCG(I)+64;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:27   
      950    10040    4                            ELSE TEXT$->UBIN9 = VALUE.CODE.FCG(I);
      951    10041    4                       TEXT$ = PINCRC(TEXT$, 1);
      952    10042    4                     END;                  /* DO I */
      953    10043    4                  IF VALUE.CODE.MON THEN DO;
      954    10044    4                       TEXT$->CHAR2 = '-M';
      955    10045    4                       TEXT$ = PINCRC(TEXT$,2);
      956    10046    4                     END;
      957    10047    4                  ELSE DO;
      958    10048    4                       TEXT$->CHAR1 = '-';
      959    10049    4                       TEXT$ = PINCRC(TEXT$,1);
      960    10050    4                     END;
      961    10051    3                  CALL BINCHAR(TEXT$->CHAR5, VALUE.CODE.ERROR);
      962    10052    3                  TEXT$ = PINCRC(TEXT$,5);
      963    10053    3                  TEXT$->CHAR1 = '-';
      964    10054    3                  CALL BINCHAR(PINCRC(TEXT$,1)->CHAR1, VALUE.CODE.SEV);
      965    10055    3                END;
      966    10056    3             ELSE DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );
      967    10057    3               CASE ( %HOST );
      968    10058    3                  IF SIZE ~= 36 THEN GOTO WRONG_SIZE;
      969    10059    3                  S_D.JDE = VALUE.L;
      970    10060    3                  CALL DUE$JERRMSG;
      971    10061    3               CASE ( %L6 );
      972    10062    3                  IF SIZE ~= 32 THEN GOTO WRONG_SIZE;
      973    10063    3                  HOST_NUVAL = '0'B;
      974    10064    3                  ERR_VAL.L.F1 = L6_EMSG.F1;
      975    10065    3                  ERR_VAL.L.F2 = L6_EMSG.F2;
      976    10066    3                  ERR_VAL.L.E1 = L6_EMSG.E1;
      977    10067    3                  ERR_VAL.L.E2 = L6_EMSG.E2;
      978    10068    3                  S_D.JITERR = ERR_VAL.L;
      979    10069    3                  CALL DUE$L6JERRMSG;
      980    10070    3               END;
      981    10071    2             RETURN;
      982    10072                                                /***************************
      983    10073                                                 ******* LOGFORT_FMT *******
      984    10074                                                 ***************************/
      985    10075    2          CASE( %LOGFORT_FMT );
      986    10076
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:28   
      987    10077    2             CALL DDR$BUMPC_D$(1) ALTRET(DERR);
      988    10078    2             IF VBITS(0)=1
      989    10079    2             THEN TEXT$ -> CHAR1 = 'T';
      990    10080    2             ELSE TEXT$ -> CHAR1 = 'F';
      991    10081    2             RETURN;
      992    10082                                                /*********************************
      993    10083                                                 ******* OCT_FMT, ZERO_FMT *******
      994    10084                                                 *********************************/
      995    10085    2          CASE( %OCT_FMT, %ZERO_FMT );
      996    10086
      997    10087    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );
      998    10088
      999    10089    3               CASE ( %HOST );
     1000    10090
     1001    10091    3                  IF FMT = %ZERO_FMT AND MOD ( SIZE, 36 ) ~= 0
     1002    10092    4                  THEN DO;                 /* Result of star #6266 */
     1003    10093    4                       S_D.ERROR = 249; /* E@SIZE_NOT_WORD */
     1004    10094    4                       GOTO DERR;
     1005    10095    4                     END;
     1006    10096    3   OCTAL:
     1007    10097    3                  J=0;
     1008    10098    4                  DO CASE ( MOD(SIZE, 3) ); /* Reformat */
     1009    10099    4                    CASE (0);
     1010    10100    5                       DO I = 0 TO SIZE/36;
     1011    10101    5                            HOST_NUVAL(J) = HOST_VAL(I);
     1012    10102    5                            J = J+1;
     1013    10103    5                          END;
     1014    10104    4                       NU_SIZE = SIZE;
     1015    10105    4                    CASE (1);
     1016    10106    5                       DO I = 0 TO SIZE/36;
     1017    10107    5                            HOST_NUVAL2.HOST_WRD(J) = HOST_VAL(I);
     1018    10108    5                            J = J + 1;
     1019    10109    5                          END;
     1020    10110    4                       NU_SIZE = SIZE + 2;
     1021    10111    4                    CASE (2);
     1022    10112    5                       DO I = 0 TO SIZE/36;
     1023    10113    5                            HOST_NUVAL1.HOST_WRD(J) = HOST_VAL(I);
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:29   
     1024    10114    5                            J = J + 1;
     1025    10115    5                          END;
     1026    10116    4                       NU_SIZE = SIZE + 1;
     1027    10117    4                    END;
     1028    10118
     1029    10119    3                  TEXT$ -> CHAR1 = '.';
     1030    10120    3                  CALL DDR$BUMPC_D$(1) ALTRET (DERR);
     1031    10121    3                  TEXT$ = S_D.D$;
     1032    10122    3                  CALL BIN2OCT;
     1033    10123    3                  TEXT$-> TEXTR = MYBUF;
     1034    10124    3                  CALL DDR$BUMPC_D$(NCHARS) ALTRET (DERR);
     1035    10125
     1036    10126    3               CASE ( %L6 );
     1037    10127
     1038    10128    3                  IF FMT = %ZERO_FMT AND MOD ( SIZE, 16 ) ~= 0
     1039    10129    4                  THEN DO;                 /* Result of star #6266 */
     1040    10130    4                       S_D.ERROR = 249; /* E@SIZE_NOT_WORD */
     1041    10131    4                       GOTO DERR;
     1042    10132    4                     END;
     1043    10133
     1044    10134    3                  J = 0;
     1045    10135    4                  DO CASE ( MOD ( SIZE, 3 ) );
     1046    10136    4                    CASE(0);
     1047    10137    5                       DO I = 0 TO SIZE/16;
     1048    10138    5                            L6_NUVAL(J) = L6_VAL.L6_WRD(I);
     1049    10139    5                            J = J + 1;
     1050    10140    5                          END;
     1051    10141    4                       NU_SIZE = SIZE;
     1052    10142    4                    CASE(1);
     1053    10143    5                       DO I = 0 TO SIZE/16 ;
     1054    10144    5                            L6_NUVAL2.L6_WRD(J) = L6_VAL.L6_WRD(I);
     1055    10145    5                            J = J + 1;
     1056    10146    5                          END;
     1057    10147    4                       NU_SIZE = SIZE + 2;
     1058    10148    4                    CASE(2);
     1059    10149    5                       DO I = 0 TO SIZE/16;
     1060    10150    5                            L6_NUVAL1.L6_WRD(J) = L6_VAL.L6_WRD(I);
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:30   
     1061    10151    5                            J = J + 1;
     1062    10152    5                          END;
     1063    10153    4                       NU_SIZE = SIZE + 1;
     1064    10154    4                    END;
     1065    10155    3                  TEXT$ -> CHAR1 = '''';
     1066    10156    3                  CALL DDR$BUMPC_D$(1) ALTRET (DERR);
     1067    10157    3                  TEXT$ = S_D.D$;
     1068    10158    3                  CALL BIN2OCT;
     1069    10159    3                  TEXT$ -> TEXTR = MYBUF;
     1070    10160    3                  CALL DDR$BUMPC_D$(NCHARS) ALTRET (DERR);
     1071    10161    3                  TEXT$ = S_D.D$;
     1072    10162    3                  NCHARS = 2;
     1073    10163    3                  TEXT$ -> TEXTR = '''O';
     1074    10164    3                  CALL DDR$BUMPC_D$(NCHARS) ALTRET (DERR);
     1075    10165    3               END;
     1076    10166
     1077    10167    2             RETURN;
     1078    10168                                                /***********************
     1079    10169                                                 ******* PUP_FMT *******
     1080    10170                                                 ***********************/
     1081    10171    2          CASE( %PUP_FMT );
     1082    10172
     1083    10173    2             PUB = PUP.PUB;
     1084    10174    2             SCALE = PUP.SCALE;
     1085    10175    2             SIGNPOS = PUP.SIGNPOS;
     1086    10176    2             SIGNOVER = PUP.SIGNOVER;
     1087    10177    2             CHARTEMP = ZERO;
     1088    10178    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );
     1089    10179    3               CASE ( %HOST );
     1090    10180    3                  IF PUB = 2
     1091    10181    4                  THEN DO;                 /* Unpacked number */
     1092    10182    4                       CHARS = SIZE / 9;
     1093    10183    4                       IF SIGNOVER
     1094    10184    5                       THEN DO;            /* Overpunched sign */
     1095    10185    6                            DO CASE( SIGNPOS );
     1096    10186    6                              CASE( 0, 3 ); /* Not valid */
     1097    10187    6                              CASE( 1 );   /* Leading sign */
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:31   
     1098    10188    6                                 SCHAR = CVALUE( 0 );
     1099    10189    6                                 CALL INSERT(CHARTEMP, 64 - CHARS, CHARS - 1,
     1100    10190    6                                   SUBSTR(CVALUES, 1, CHARS - 1));
     1101    10191    6                              CASE( 2 );   /* Trailing sign */
     1102    10192    6                                 SCHAR  = CVALUE( CHARS - 1 );
     1103    10193    6                                 CALL INSERT(CHARTEMP, 63 - CHARS, CHARS - 1,
     1104    10194    6                                   SUBSTR(CVALUES, 0, CHARS - 1));
     1105    10195    6                              END;         /* DO CASE( SIGNPOS ) */
     1106    10196    5                            CALL INDEX(TEMP, SCHAR, DIGITS);
     1107    10197    5                            IF TEMP < LENGTHC(DIGITS)
     1108    10198    5                            THEN GOTO UNSIGNED1;
     1109    10199    5                            IF SCHAR = ' ' OR SCHAR = BITASC('173'O) /* '{' */
     1110    10200    6                            THEN DO;
     1111    10201    6                                 SCHAR = '+';
     1112    10202    6                                 SDIGIT = '0';
     1113    10203    6                               END;
     1114    10204    5                            ELSE IF SCHAR = BITASC('175'O) /* '}' */
     1115    10205    6                                 THEN DO;
     1116    10206    6                                      SCHAR = '-';
     1117    10207    6                                      SDIGIT = '0';
     1118    10208    6                                    END;
     1119    10209    6                                 ELSE DO;  /* Not ' ', '{' or '}' */
     1120    10210    6                                      TEMP = ASCBIN(SCHAR) - BITBIN('100'O);
     1121    10211    6                                      IF TEMP > 9
     1122    10212    7                                      THEN DO; /* Negative number */
     1123    10213    7                                           SCHAR = '-';
     1124    10214    7                                           SDIGIT = BITASC(ASCBIT('0') | BINBIT(TEMP -
             10214                                                    9, 9));
     1125    10215    7                                         END;
     1126    10216    7                                      ELSE DO; /* Positive number */
     1127    10217    7                                           SCHAR = '+';
     1128    10218    7                                           SDIGIT = BITASC(ASCBIT('0') | BINBIT(TEMP, 9
             10218                                                    ));
     1129    10219    7                                         END;
     1130    10220    6                                    END;   /* Not ' ', '{', or '}' */
     1131    10221    5                            ACHARTEMP( 0 ) = SCHAR;
     1132    10222    5                            IF SIGNPOS = 1
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:32   
     1133    10223    5                            THEN ACHARTEMP( 63 - CHARS ) = SDIGIT; /* Leading sign */
     1134    10224    5                            ELSE ACHARTEMP( 62 ) = SDIGIT; /* Trailing sign */
     1135    10225    5                          END;             /* DO (IF SIGNOVER) */
     1136    10226    5                       ELSE DO CASE( SIGNPOS ); /* Not overpunched sign */
     1137    10227    5                         CASE( 3 );        /* Not valid */
     1138    10228    5                         CASE( 0 );        /* Unsigned */
     1139    10229    5   UNSIGNED1:               ;
     1140    10230    5                            ACHARTEMP( 0 ) = '+';
     1141    10231    5                            CALL INSERT(CHARTEMP, 63 - CHARS, CHARS, CVALUES);
     1142    10232    5                         CASE( 1 );        /* Leading sign */
     1143    10233    5                            ACHARTEMP( 0 ) = CVALUE( 0 );
     1144    10234    5                            CALL INSERT(CHARTEMP, 64 - CHARS, CHARS - 1,
     1145    10235    5                              SUBSTR(CVALUES, 1));
     1146    10236    5                         CASE( 2 );        /* Trailing sign */
     1147    10237    5                            ACHARTEMP( 0 ) = CVALUE( CHARS - 1 );
     1148    10238    5                            CALL INSERT(CHARTEMP, 64 - CHARS, CHARS - 1,CVALUES);
     1149    10239    5                         END;         /* DO CASE( SIGNPOS ) - not overpunched */
     1150    10240    4                     END;                  /* PUB = 2 - unpacked number */
     1151    10241    4                  ELSE DO;                 /* Packed decimal number */
     1152    10242                                                /*
     1153    10243                                                Do nothing, all ready in unpacked form
     1154    10244                                                by DDK$GETV_A
     1155    10245                                                */
     1156    10246    4                       CHARTEMP = CVALUES;
     1157    10247    4                     END;                  /* DO - packed decimal number */
     1158    10248    3               CASE ( %L6 );
     1159    10249    3                  IF PUB = 2
     1160    10250    4                  THEN DO;                 /* Unpacked number */
     1161    10251    4                       IF SIZE > 8 * 31    /* Can have a maximum of 31 bytes*/
     1162    10252    5                       THEN DO;
     1163    10253    5                            S_D.ERROR = 46; /* E@TOOLARGE */
     1164    10254    5                            CALL DDE$ERROR;
     1165    10255    5                            ALTRETURN;
     1166    10256    5                          END;
     1167    10257    4                       CHARS = SIZE / 8;
     1168    10258    4                       J = 0;
     1169    10259    5                       DO I = 0 TO CHARS / 2; /* Reformat into 9 bits char */
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:33   
     1170    10260    5                            HOST_NUCHAR ( J ) = BINASC ( L6_UPDEC.L ( I ) );
     1171    10261    5                            J = J + 1;
     1172    10262    5                            HOST_NUCHAR ( J ) = BINASC ( L6_UPDEC.R ( I ) );
     1173    10263    5                            J = J + 1;
     1174    10264    5                          END;
     1175    10265    4                       IF SIGNOVER
     1176    10266    5                       THEN DO;            /* Overpunched sign */
     1177    10267    6                            DO CASE( SIGNPOS );
     1178    10268    6                              CASE( 0, 3 ); /* Not valid */
     1179    10269    6                              CASE( 1 );   /* Leading sign */
     1180    10270    6                                 SCHAR = HOST_NUCHAR( 0 );
     1181    10271    6                                 CALL INSERT(CHARTEMP, 64 - CHARS, CHARS - 1,
     1182    10272    6                                   SUBSTR(HOST_NUCHARS, 1, CHARS - 1));
     1183    10273    6                              CASE( 2 );   /* Trailing sign */
     1184    10274    6                                 SCHAR  = HOST_NUCHAR( CHARS - 1 );
     1185    10275    6                                 CALL INSERT(CHARTEMP, 63 - CHARS, CHARS - 1,
     1186    10276    6                                   SUBSTR(HOST_NUCHARS, 0, CHARS - 1));
     1187    10277    6                              END;         /* DO CASE( SIGNPOS ) */
     1188    10278    5                            CALL INDEX(TEMP, SCHAR, DIGITS);
     1189    10279    5                            IF TEMP < LENGTHC(DIGITS)
     1190    10280    5                            THEN GOTO UNSIGNED2;
     1191    10281    5                            IF SCHAR = ' ' OR SCHAR = BITASC('173'O) /* '{' */
     1192    10282    6                            THEN DO;
     1193    10283    6                                 SCHAR = '+';
     1194    10284    6                                 SDIGIT = '0';
     1195    10285    6                               END;
     1196    10286    5                            ELSE IF SCHAR = BITASC('175'O) /* '}' */
     1197    10287    6                                 THEN DO;
     1198    10288    6                                      SCHAR = '-';
     1199    10289    6                                      SDIGIT = '0';
     1200    10290    6                                    END;
     1201    10291    6                                 ELSE DO;  /* Not ' ', '{' or '}' */
     1202    10292    6                                      TEMP = ASCBIN(SCHAR) - BITBIN('100'O);
     1203    10293    6                                      IF TEMP > 9
     1204    10294    7                                      THEN DO; /* Negative number */
     1205    10295    7                                           SCHAR = '-';
     1206    10296    7                                           SDIGIT = BITASC(ASCBIT('0') | BINBIT(TEMP -
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:34   
             10296                                                    9, 9));
     1207    10297    7                                         END;
     1208    10298    7                                      ELSE DO; /* Positive number */
     1209    10299    7                                           SCHAR = '+';
     1210    10300    7                                           SDIGIT = BITASC(ASCBIT('0') | BINBIT(TEMP, 9
             10300                                                    ));
     1211    10301    7                                         END;
     1212    10302    6                                    END;   /* Not ' ', '{', or '}' */
     1213    10303    5                            ACHARTEMP( 0 ) = SCHAR;
     1214    10304    5                            IF SIGNPOS = 1
     1215    10305    5                            THEN ACHARTEMP( 63 - CHARS ) = SDIGIT; /* Leading sign */
     1216    10306    5                            ELSE ACHARTEMP( 62 ) = SDIGIT; /* Trailing sign */
     1217    10307    5                          END;             /* DO (IF SIGNOVER) */
     1218    10308    5                       ELSE DO CASE( SIGNPOS ); /* Not overpunched sign */
     1219    10309    5                         CASE( 3 );        /* Not valid */
     1220    10310    5                         CASE( 0 );        /* Unsigned */
     1221    10311    5   UNSIGNED2:               ;
     1222    10312    5                            ACHARTEMP( 0 ) = '+';
     1223    10313    5                            CALL INSERT(CHARTEMP, 63 - CHARS, CHARS, HOST_NUCHARS);
     1224    10314    5                         CASE( 1 );        /* Leading sign */
     1225    10315    5                            ACHARTEMP( 0 ) = HOST_NUCHAR( 0 );
     1226    10316    5                            CALL INSERT(CHARTEMP, 64 - CHARS, CHARS - 1,
     1227    10317    5                              SUBSTR(HOST_NUCHARS, 1));
     1228    10318    5                         CASE( 2 );        /* Trailing sign */
     1229    10319    5                            ACHARTEMP( 0 ) = HOST_NUCHAR( CHARS - 1 );
     1230    10320    5                            CALL INSERT(CHARTEMP, 64 - CHARS, CHARS - 1,HOST_NUCHARS);
     1231    10321    5                         END;         /* DO CASE( SIGNPOS ) - not overpunched */
     1232    10322    4                     END;                  /* PUB = 2 - unpacked number */
     1233    10323    4                  ELSE DO;                 /* Packed decimal number */
     1234    10324    4                       IF SIZE > 4 * 31 /* Can have a maximum of 31 half  bytes */
     1235    10325    5                       THEN DO;
     1236    10326    5                            S_D.ERROR = 46 ; /* E@TOOLARGE */
     1237    10327    5                            CALL DDE$ERROR;
     1238    10328    5                            ALTRETURN;
     1239    10329    5                          END;
     1240    10330    4                       CHARS = (SIZE+ 3) / 4;
     1241    10331    4                       J = 0;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:35   
     1242    10332    5                       DO I = 0 TO (CHARS -1); /* Reformat into 9 bits char */
     1243    10333    5                            PCHAR.LEFT5 ( J ) = 3;
     1244    10334    5                            PCHAR.RIGHT4 ( J ) = L6_PDEC.L1 ( I );
     1245    10335    5                            J = J + 1;
     1246    10336    5                            PCHAR.LEFT5 ( J ) = 3;
     1247    10337    5                            PCHAR.RIGHT4 ( J ) = L6_PDEC.L2 ( I );
     1248    10338    5                            J = J + 1;
     1249    10339    5                            PCHAR.LEFT5 ( J ) = 3;
     1250    10340    5                            PCHAR.RIGHT4 ( J ) = L6_PDEC.R1 ( I );
     1251    10341    5                            J = J + 1;
     1252    10342    5                            PCHAR.LEFT5 ( J ) = 3;
     1253    10343    5                            PCHAR.RIGHT4 ( J ) = L6_PDEC.R2 ( I );
     1254    10344    5                            J = J + 1;
     1255    10345    5                          END;
     1256    10346    5                       DO CASE ( SIGNPOS );
     1257    10347    5                         CASE ( 2 );
     1258    10348    5                            PCHAR.LEFT5 ( CHARS - 1 ) = 2;
     1259    10349    5                            ACHARTEMP ( 0 ) = HOST_NUCHAR ( CHARS - 1 );
     1260    10350    5                            CALL INSERT ( CHARTEMP, 64 - CHARS, CHARS - 1, HOST_NUCHARS
             10350                                     );
     1261    10351    5                         CASE ( 0 );
     1262    10352    5                            ACHARTEMP ( 0 ) = '+';
     1263    10353    5                            CALL INSERT ( CHARTEMP, 64 - CHARS, CHARS - 1,
     1264    10354    5                              SUBSTR ( HOST_NUCHARS, 1 ) );
     1265    10355    5                         CASE ( ELSE );
     1266    10356    5                         END;
     1267    10357    4                     END;                  /* DO - packed decimal number */
     1268    10358    3               END;
     1269    10359    2             TEXT$ = S_D.D$;
     1270    10360    2             IF ACHARTEMP( 0 ) = '-'
     1271    10361    3             THEN DO;
     1272    10362    3                  TEXT$ -> CHAR1 = '-';
     1273    10363    3                  CALL DDR$BUMPC_D$( 1 ) ALTRET(DERR);
     1274    10364    3                  TEXT$ = S_D.D$;
     1275    10365    3                END;
     1276    10366    2             IF SCALE >= 0
     1277    10367    3             THEN DO;                      /* Scale zero or positive */
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:36   
     1278    10368    3                  SIG = '0'B;
     1279    10369    4                  DO I = 1 TO 61;
     1280    10370    4                       CTEMP = ACHARTEMP( I );
     1281    10371    4                       IF CTEMP ~= '0' OR SIG
     1282    10372    5                       THEN DO;
     1283    10373    5                            SIG = '1'B;
     1284    10374    5                            TEXT$ -> CHAR1 = CTEMP;
     1285    10375    5                            CALL DDR$BUMPC_D$( 1 ) ALTRET(DERR);
     1286    10376    5                            TEXT$ = S_D.D$;
     1287    10377    5                          END;
     1288    10378    4                     END;                  /* DO I = 1 TO 61 */
     1289    10379    3                  TEXT$ -> CHAR1 = ACHARTEMP( 62 ); /* Always want last digit */
     1290    10380    3                  CALL DDR$BUMPC_D$( 1 ) ALTRET(DERR);
     1291    10381    3                  TEXT$ = S_D.D$;
     1292    10382    3                  CALL DDR$BUMPC_D$( SCALE ) ALTRET(DERR);
     1293    10383    4                  DO I = 1 TO SCALE;
     1294    10384    4                       TEXT$ -> CHAR1 = '0';
     1295    10385    4                       TEXT$ = PINCRC(TEXT$, 1);
     1296    10386    4                     END;
     1297    10387    3                END;                       /* Scale zero or positive */
     1298    10388    3             ELSE DO;                      /* Scale negative */
     1299    10389    3                  SCALE = - SCALE;
     1300    10390    3                  SIG = '0'B;
     1301    10391    3                  IF SCALE > 62
     1302    10392    4                  THEN DO;                 /* Need leading zeroes */
     1303    10393    4                       SIG = '1'B;
     1304    10394    4                       TEXT$ -> CHAR1 = '0';
     1305    10395    4                       CALL DDR$BUMPC_D$( 1 ) ALTRET(DERR);
     1306    10396    4                       TEXT$ = S_D.D$;
     1307    10397    4                       CALL PUTDECIMALPT ALTRET(DERR);
     1308    10398    4                       NCHARS = SCALE - 62;
     1309    10399    4                       CALL DDR$BUMPC_D$ ( NCHARS + 62 ) ALTRET(DERR);
     1310    10400    4                       TEXT$ -> TEXTR = ZERO;
     1311    10401    4                       TEXT$ = PINCRC(TEXT$, NCHARS);
     1312    10402    4                       TEXT$ -> CHAR62 = ADDR(ACHARTEMP(1)) -> CHAR62;
     1313    10403    4                     END;                  /* Need leading zeroes */
     1314    10404    4                  ELSE DO;                 /* No leading zeroes */
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:37   
     1315    10405    4                       TEMP = 62 - SCALE;
     1316    10406    5                       DO I = 1 TO TEMP;   /* Output digits before '.' */
     1317    10407    5                            CTEMP = ACHARTEMP( I );
     1318    10408    5                            IF CTEMP ~= '0' OR SIG
     1319    10409    6                            THEN DO;
     1320    10410    6                                 SIG ='1'B;
     1321    10411    6                                 TEXT$ -> CHAR1 = CTEMP;
     1322    10412    6                                 CALL DDR$BUMPC_D$( 1 ) ALTRET(DERR);
     1323    10413    6                                 TEXT$ = S_D.D$;
     1324    10414    6                               END;
     1325    10415    5                          END;             /* Output digits before '.' */
     1326    10416    4                       IF NOT SIG
     1327    10417    5                       THEN DO;            /* Force at least one leading zero */
     1328    10418    5                            TEXT$ -> CHAR1 = '0';
     1329    10419    5                            CALL DDR$BUMPC_D$( 1 ) ALTRET(DERR);
     1330    10420    5                            TEXT$ = S_D.D$;
     1331    10421    5                          END;             /* Force at least one leading zero */
     1332    10422    4                       CALL PUTDECIMALPT ALTRET(DERR);
     1333    10423    4                       NCHARS = 62 - TEMP;
     1334    10424    4                       CALL DDR$BUMPC_D$( NCHARS ) ALTRET(DERR);
     1335    10425    4                       TEXT$ -> TEXTR = ADDR(ACHARTEMP( TEMP + 1 )) -> CHAR62;
     1336    10426    4                     END;                  /* No leading zeroes */
     1337    10427    3                END;                       /* Scale negative */
     1338    10428    2             RETURN;
     1339    10429                                                /***********************
     1340    10430                                                 ******* REL_FMT *******
     1341    10431                                                 ***********************/
     1342    10432    2          CASE( %REL_FMT );
     1343    10433
     1344    10434    2   REL:      IF SIZE < 18
     1345    10435    2             THEN GOTO WRONG_SIZE;
     1346    10436    2             ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
     1347    10437    2                  THEN VAL = BITBIN( BINBIT( VALUE.L, 36 ) & '000000777777'O );
     1348    10438    2                  ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
     1349    10439    2                       THEN VAL = KVALUE(0) * 65536 + KVALUE(1);
     1350    10440    3                       ELSE DO;
     1351    10441    3                            S_D.ERROR = 502; /* E@DELBUG */
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:38   
     1352    10442    3                            GOTO DERR;
     1353    10443    3                          END;
     1354    10444    2   REL6:     SAVE_EWSQ# = S_D.EWSQ#;
     1355    10445    2             IF D_XDELTA
     1356    10446    2             THEN IF U$SE.TYPE = 0   /* USE_MON */
     1357    10447    2                  THEN S_D.EWSQ# = %MONWSQ; /* %MONWSQ */
     1358    10448    2                  ELSE S_D.EWSQ# = %REALWSQ;
             10448                           /* Don't use monitor symbols for others - %REALWSQ */
     1359    10449    2             ELSE S_D.EWSQ# = %MONWSQ;
             10449                      /* User is like monitor for user DELTA - %MONWSQ */
     1360    10450    2             CALL DDR$POSIT(VAL, S_D.D$, POFFC(S_D.DESCL$, S_D.D$), NCHARS, NO_UDEFS)
             10450                      ALTRET(DERR);
     1361    10451    2             S_D.EWSQ# = SAVE_EWSQ#;
     1362    10452    2             IF S_D.OVERLAID AND NOT S_D.RUM
     1363    10453    2             THEN CALL DDS$IC2NODE(S_D.SAVEIC);
     1364    10454    2             CALL DDR$BUMPC_D$(NCHARS) ALTRET(DERR);
     1365    10455    2             RETURN;
     1366    10456                                                /****************************
     1367    10457                                                 ******* REMEMBER_FMT *******
     1368    10458                                                 ****************************/
     1369    10459    2          CASE( %REMEMBER_FMT );
     1370    10460
     1371    10461    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );
     1372    10462    3               CASE ( %HOST );
     1373    10463    3                  IF SIZE ~= 72 THEN GOTO WRONG_SIZE;
     1374    10464    3                  OFFSET = RVALUE.OFFSET;
     1375    10465    3                  VALUE.L = RVALUE.E;
     1376    10466    3                  VAL = BITBIN( BINBIT(RVALUE.L, 36 ) & '000000777777'O);
     1377    10467    3               CASE ( %L6 );
     1378    10468    3                  IF SIZE ~= 64 THEN GOTO WRONG_SIZE;
     1379    10469    3                  VAL = 0;
     1380    10470    3                  PWRD_VAL.LEFT4 = L6_REM.AUTO_OFFSET_LEFT4;
     1381    10471    3                  PWRD_VAL.RIGHT16 = L6_REM.AUTO_OFFSET_RIGHT16;
     1382    10472    3                  OFFSET = VAL;
     1383    10473    3                  VAL = 0;
     1384    10474    3                  PWRD_VAL.LEFT4 = L6_REM.ADDR_LEFT4;
     1385    10475    3                  PWRD_VAL.RIGHT16 = L6_REM.ADDR_RIGHT16;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:39   
     1386    10476    3               END;
     1387    10477    2             SAVE_EWSQ# = S_D.EWSQ#;
     1388    10478    2             IF D_XDELTA
     1389    10479    2             THEN IF  U$SE.TYPE = 0  /* USE_MON */
     1390    10480    2                  THEN S_D.EWSQ# = %MONWSQ; /* %MONWSQ */
     1391    10481    2                  ELSE S_D.EWSQ# = %REALWSQ;
             10481                           /* %REALWSQ - Dont use monitor symbols for others */
     1392    10482    2             ELSE S_D.EWSQ# = %MONWSQ;
             10482                      /* %MONWSQ - User is like monitor for user DELTA */
     1393    10483    2             CALL DDR$POSIT(VAL, S_D.D$, POFFC(S_D.DESCL$, S_D.D$), NCHARS, NO_UDEFS)
             10483                      ALTRET( DERR ); /* Address of remembered statement */
     1394    10484    2             S_D.EWSQ# = SAVE_EWSQ#;
     1395    10485    2             IF S_D.OVERLAID AND NOT S_D.RUM
     1396    10486    2             THEN CALL DDS$IC2NODE(S_D.SAVEIC);
     1397    10487    2             CALL DDR$BUMPC_D$( NCHARS ) ALTRET( DERR );
     1398    10488    2             TEXT$ = S_D.D$;
     1399    10489    2             CALL DDR$BUMPC_D$( LENGTHC(' (+') );
     1400    10490    2             TEXT$ -> CHAR3 = ' (+';
     1401    10491    2             TEXT$ = PINCRC(TEXT$, LENGTHC(' (+'));
     1402    10492    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
             10492                      /* Address of remembered AUTO frame */
     1403    10493    2             THEN CALL DDR$BINTXT(MYBUF$, OFFSET, %OCT_FMT, NCHARS);
     1404    10494    2             ELSE CALL DDR$BINTXT ( MYBUF$, OFFSET, %X_FMT, NCHARS );
     1405    10495    2             CALL DDR$BUMPC_D$( NCHARS ) ALTRET( DERR );
     1406    10496    2             TEXT$ -> TEXTR = MYBUF;
     1407    10497    2             TEXT$ = PINCRC(TEXT$, NCHARS);
     1408    10498    2             TEXT$ -> CHAR1 = ')';
     1409    10499    2             CALL DDR$BUMPC_D$( LENGTHC(')') );
     1410    10500    2             RETURN;
     1411    10501                                                /**********************************
     1412    10502                                                 ******* SINT_FMT, UINT_FMT *******
     1413    10503                                                 **********************************/
     1414    10504    2          CASE( %SINT_FMT, %UINT_FMT);
     1415    10505    2   SINTFMT:  ;
     1416    10506    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );
     1417    10507    3               CASE ( %HOST );
     1418    10508    3                  IF SIZE > WRD_SIZE THEN GOTO WRONG_SIZE;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:40   
     1419    10509    3                  IF VBITS(0) = 1 THEN NEG = '1'B;
     1420    10510    3               CASE ( %L6 );
     1421    10511    3                  IF SIZE > 32 THEN GOTO WRONG_SIZE;
     1422    10512    3                  IF L6_VAL.BIT16.SIGN(0) = '1'B THEN NEG = '1'B;
     1423    10513    4                  DO I = 0 TO SIZE/16;
     1424    10514    4                       L6_NUVAL(I) = L6_VAL.L6_WRD(I);
     1425    10515    4                     END;
     1426    10516    3                  VBITS = NUVAL_BITS;
     1427    10517    3               END;
     1428    10518    2             IF NEG AND FMT = %SINT_FMT
     1429    10519    3             THEN DO;
     1430    10520    3                  TEXT$ -> CHAR1 = '-';
     1431    10521    3                  CALL DDR$BUMPC_D$(1) ALTRET (DERR);
     1432    10522    3                  TEXT$ = S_D.D$;
     1433    10523    3                  HOST_VAL(0) = HOST_VAL(0)\'777777777777'O;
             10523                           /* Convert into a positive value */
     1434    10524    3                  IF SIZE < 36
     1435    10525    3                  THEN CALL STRETCH;
     1436    10526    3                  ELSE VALBITS = HOST_VAL(0);
     1437    10527    3                  VAL = VAL + 1;
     1438    10528    3                END;
     1439    10529    2             ELSE IF SIZE < 36
     1440    10530    2                  THEN CALL STRETCH;
     1441    10531    2                  ELSE VALBITS = HOST_VAL(0);
     1442    10532    2             CALL DDR$BINTXT ( MYBUF$, VAL, %UINT_FMT, NCHARS );
     1443    10533    2             TEXT$ -> TEXTR = MYBUF;
     1444    10534    2             CALL DDR$BUMPC_D$(NCHARS) ALTRET (DERR);
     1445    10535    2             RETURN;
     1446    10536                                                /************************
     1447    10537                                                 ******* STATUS_FMT *****
     1448    10538                                                 ************************/
     1449    10539    2          CASE( %STATUS_FMT );
     1450    10540    2             S_D.D$ = ADDR(S_D.OUTPUT);
     1451    10541    2             S_D.OUTPUT = ' ';
     1452    10542    2             TEMP = LENGTHC( S_D.OUTPUT );
     1453    10543    2             CALL DDR$MOVE(' Status:', LENGTHC(' Status:'), S_D.D$, TEMP);
     1454    10544    2             CALL DDQ$WRITE(ADDR(S_D.OUTPUT), POFFC(S_D.D$, ADDR(S_D.OUTPUT)));
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:41   
     1455    10545    2             S_D.D$ = ADDR(S_D.OUTPUT);
     1456    10546    2             S_D.OUTPUT = ' ';
     1457    10547    2             CALL DDQ$WRITE(ADDR(S_D.OUTPUT), 2);
     1458    10548    2             WRD_SIZE = (SIZE + 15) / 16;
     1459    10549    2             TEMP = SIZE;
     1460    10550    2             TENTRY# = PNPOINTERS.TRUE;
     1461    10551    2             FENTRY# = PNPOINTERS.FALSE;
     1462    10552    3             DO I = 0 TO WRD_SIZE - 1;
     1463    10553    3                  VAL = BITBIN(L6_VAL.L6_WRD(I));
     1464    10554    4                  DO J = 0 TO 15;
     1465    10555    4                       CALL DDF$DBG_#(TENTRY#, TENTRY$) ALTRET(BADSCHEMA);
     1466    10556    4                       CALL DDF$DBG_#(FENTRY#, FENTRY$) ALTRET(BADSCHEMA);
     1467    10557    4                       IF L6TIME_VAL.BITS(J)
     1468    10558    4                       THEN MYBUF$ = TENTRY$;
     1469    10559    4                       ELSE MYBUF$ = FENTRY$;
     1470    10560    4                       NCHARS = MYBUF$ -> B$DNAME.COUNT;
     1471    10561    4                       MYBUF$ = PINCRC(MYBUF$, 2);
     1472    10562    4                       CALL DDR$MOVE('    ', LENGTHC('    '), S_D.D$, TEMP);
     1473    10563    4                       TEXT$ = S_D.D$;
     1474    10564    4                       TEXT$ -> TEXTR = MYBUF$ -> TEXTR;
     1475    10565    4                       CALL DDR$BUMPC_D$(NCHARS - 1);
     1476    10566    4                       CALL DDQ$WRITE(ADDR(S_D.OUTPUT), POFFC(S_D.D$, ADDR(S_D.OUTPUT))
             10566                                );
     1477    10567    4                       S_D.D$ = ADDR(S_D.OUTPUT);
     1478    10568    4                       TEMP = TEMP - 1;
     1479    10569    4                       TENTRY# = TENTRY# + (TENTRY$ -> B$DNAME.COUNT + 5)/4;
     1480    10570    4                       FENTRY# = FENTRY# + (FENTRY$ -> B$DNAME.COUNT + 5)/4;
     1481    10571    4                     END;
     1482    10572    3                END;
     1483    10573                                                /************************
     1484    10574                                                 ******* TIME_FMT *******
     1485    10575                                                 ************************/
     1486    10576    2          CASE( %TIME_FMT );
     1487    10577
     1488    10578    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );
     1489    10579
     1490    10580    3               CASE ( %HOST );
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:42   
     1491    10581    3                  IF SIZE > 36 THEN GOTO WRONG_SIZE;
     1492    10582    3                  IF SIZE < 36
     1493    10583    3                  THEN CALL STRETCH;
     1494    10584    3                  ELSE VAL = VALUE.L;
     1495    10585    3                  CALL DDR$BUMPC_D$ ( 20 ) ALTRET ( DERR );
     1496    10586    3                  CALL DDA$UTSTIME (VAL, TEXT$->CHAR1);
     1497    10587    3               CASE ( %L6 );
     1498    10588    3                  IF SIZE > 32 THEN GOTO WRONG_SIZE;
     1499    10589    3                  VAL = BITBIN(L6_VAL.L6_WRD(0));
     1500    10590    3                  IF SIZE > 16 THEN
     1501    10591    3                       VAL = VAL * BITBIN('10000'X) + BITBIN(L6_VAL.L6_WRD(1));
     1502    10592    3                  CALL DDR$BUMPC_D$ (20) ALTRET (DERR);
     1503    10593    3                  CALL DFR$UTSTIME (VAL, TEXT$->CHAR1);
     1504    10594    3               END;
     1505    10595    2             RETURN;
     1506    10596                                                /**************************
     1507    10597                                                 ******* VECTOR_FMT *******
     1508    10598                                                 **************************/
     1509    10599    2          CASE( %VECTOR_FMT );
     1510    10600
     1511    10601    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );
     1512    10602
     1513    10603    3               CASE ( %HOST );
     1514    10604
     1515    10605    3                  IF SIZE = 36 THEN GOTO ONLY36;
     1516    10606    3                  IF SIZE ~= 72 THEN GOTO WRONG_SIZE;
     1517    10607    3                  VAL = VVALUE.W2.W;
     1518    10608    3                  CALL DDR$BINTXT( MYBUF$, VAL, %OCT_FMT, NCHARS );
     1519    10609    3                  CALL DDR$BUMPC_D$( NCHARS );
     1520    10610    3                  TEXT$ -> TEXTR = MYBUF;
     1521    10611    3                  TEXT$ = S_D.D$;
     1522    10612    3                  VAL = VVALUE.W2.C;
     1523    10613    3                  CALL DDR$BUMPC_D$( 3 ) ALTRET( DERR );
     1524    10614    3                  TEXT$ -> CHAR1 = '-';
     1525    10615    3                  TEXT$ = PINCRC(TEXT$, LENGTHC('-'));
     1526    10616    3                  CALL BINCHAR(TEXT$ -> CHAR1, VAL);
     1527    10617    3                  PINCRC(TEXT$, 1) -> CHAR1 = '-';
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:43   
     1528    10618    3                  TEXT$ = PINCRC(TEXT$, LENGTHC('-')+1);
     1529    10619    3                  VAL = VVALUE.W2.B;
     1530    10620    3                  CALL DDR$BINTXT(MYBUF$, VAL, %UINT_FMT, NCHARS);
     1531    10621    3                  CALL DDR$BUMPC_D$( NCHARS ) ALTRET( DERR );
     1532    10622    3                  TEXT$ -> TEXTR = MYBUF;
     1533    10623    3                  TEXT$ = PINCRC(TEXT$, NCHARS);
     1534    10624    3                  TEXT$ -> CHAR1 = ',';
     1535    10625    3                  TEXT$ = PINCRC(TEXT$, LENGTHC(','));
     1536    10626    3                  CALL DDR$BUMPC_D$( LENGTHC(',') ) ALTRET( DERR );
     1537    10627    3                  VAL = VVALUE.W2.SEG.S;
     1538    10628    3                  IF VAL = 1               /* Segid of .2000 is strange */
     1539    10629    4                  THEN DO;
     1540    10630    4                       VAL = BITBIN( VVALUE.W2.SEG );
     1541    10631    4                       CALL DDR$BINTXT(MYBUF$, VAL, %OCT_FMT, NCHARS);
     1542    10632    4                       CALL DDR$BUMPC_D$( NCHARS ) ALTRET( DERR );
     1543    10633    4                       TEXT$ -> TEXTR = MYBUF;
     1544    10634    4                     END;
     1545    10635    4                  ELSE DO;
     1546    10636    4                       CALL DDR$BUMPC_D$( 3 );
     1547    10637    4                       TEXT$ -> CHAR3 = SEGID( VAL ); /* $xS */
     1548    10638    4                       TEXT$ = S_D.D$;
     1549    10639    4                       VAL = VVALUE.W2.SEG.D;
     1550    10640    4                       CALL DDR$BINTXT(MYBUF$, VAL, %UINT_FMT, NCHARS);
     1551    10641    4                       CALL DDR$BUMPC_D$( NCHARS ) ALTRET( DERR );
     1552    10642    4                       TEXT$ -> TEXTR = MYBUF;
     1553    10643    4                     END;
     1554    10644    3                  TEXT$ = S_D.D$;
     1555    10645    3                  CALL DDR$BUMPC_D$ (1) ALTRET (DERR);
     1556    10646    3                  TEXT$->CHAR1 = ',';
     1557    10647    3   ONLY36:        TEXT$ = S_D.D$;
     1558    10648    3                  CALL DDR$BUMPC_D$ (3) ALTRET (DERR);
     1559    10649    3                  TEXT$->CHAR3 = 'BD=';
     1560    10650    3                  TEXT$ = S_D.D$;
     1561    10651    3                  IF VVALUE.W1.FLGS.NOTEMPTY
     1562    10652    4                  THEN DO;
     1563    10653    4                       VAL = VVALUE.W1.BOUND.W;
     1564    10654    4                       CALL DDR$BINTXT(MYBUF$, VAL, %OCT_FMT, NCHARS);
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:44   
     1565    10655    4                       CALL DDR$BUMPC_D$( NCHARS+2 ) ALTRET( DERR );
     1566    10656    4                       TEXT$ -> TEXTR = MYBUF;
     1567    10657    4                       TEXT$ = PINCRC(TEXT$, NCHARS+1);
     1568    10658    4                       VAL = VVALUE.W1.BOUND.C;
     1569    10659    4                       PINCRC(TEXT$, -1) -> CHAR1 = '-';
     1570    10660    4                       CALL BINCHAR(TEXT$ -> CHAR1, VAL);
     1571    10661    4                     END;
     1572    10662    4                  ELSE DO;
     1573    10663    4                       CALL DDR$BUMPC_D$( LENGTHC('EMPTY') ) ALTRET( DERR );
     1574    10664    4                       TEXT$ -> CHAR5 = 'EMPTY';
     1575    10665    4                     END;
     1576    10666    3                  TEXT$ = S_D.D$;
     1577    10667    3                  VAL = VVALUE.W1.FLAGS;
     1578    10668    3                  CALL DDR$BUMPC_D$( 12 ) ALTRET( DERR );
     1579    10669    3                  TEXT$ -> CHAR5 = ',FL=.';
     1580    10670    3                  CALL DDR$BINOCT(MYBUF, VAL);
     1581    10671    3                  TEXT$ = PINCRC(TEXT$, LENGTHC(',FL=.'));
     1582    10672    3                  TEXT$ -> CHAR3 = PINCRC(MYBUF$, 9) -> CHAR3;
     1583    10673    3                  TEXT$ = PINCRC(TEXT$, 3);
     1584    10674    3                  TEXT$ -> CHAR4 = ',TY=';
     1585    10675    3                  TEXT$ = PINCRC(TEXT$, LENGTHC(',TY='));
     1586    10676    3                  TYPE = VVALUE.W1.TYPE;
     1587    10677    4                  DO CASE (TYPE);
     1588    10678    4                    CASE(0);               /* COPY */
     1589    10679    4                       TEXT$ -> CHAR4 = 'COPY';
     1590    10680    4                       TEXT$ = PINCRC(TEXT$, LENGTHC('COPY'));
     1591    10681    4                       CALL DDR$BUMPC_D$( LENGTHC('COPY') );
     1592    10682    4                    CASE(1);               /* NORMAL SHRINK */
     1593    10683    4                       TEXT$ -> CHAR13 = 'NORMAL SHRINK';
     1594    10684    4                       TEXT$ = PINCRC(TEXT$, LENGTHC('NORMAL SHRINK'));
     1595    10685    4                       CALL DDR$BUMPC_D$( LENGTHC('NORMAL SHRINK') );
     1596    10686    4                    CASE(2);               /* EXTENDED SHRINK */
     1597    10687    4                       TEXT$ -> CHAR15 = 'EXTENDED SHRINK';
     1598    10688    4                       TEXT$ = PINCRC(TEXT$, LENGTHC('EXTENDED SHRINK'));
     1599    10689    4                       CALL DDR$BUMPC_D$( LENGTHC('EXTENDED SHRINK') );
     1600    10690    4                    CASE(3);               /* DATASTACK SHRINK */
     1601    10691    4                       TEXT$ -> CHAR16 = 'DATASTACK SHRINK';
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:45   
     1602    10692    4                       TEXT$ = PINCRC(TEXT$, LENGTHC('DATASTACK SHRINK'));
     1603    10693    4                       CALL DDR$BUMPC_D$( LENGTHC('DATASTACK SHRINK') );
     1604    10694    4                    END;
     1605    10695
     1606    10696    3               CASE ( %L6 );
     1607    10697
     1608    10698    3                  IF SIZE ~= 48 THEN GOTO WRONG_SIZE;
     1609    10699    3                  VAL = 0;
     1610    10700    3                  PWRD_VAL.LEFT4 = L6_VECTOR.LEFT4;
     1611    10701    3                  PWRD_VAL.RIGHT16 = L6_VECTOR.RIGHT16;
     1612    10702    3                  CALL DDR$BINTXT ( MYBUF$, VAL, %X_FMT, NCHARS ); /* Base */
     1613    10703    3                  TEXT$ -> TEXTR = MYBUF;
     1614    10704    3                  CALL DDR$BUMPC_D$ ( NCHARS ) ALTRET ( DERR );
     1615    10705    3                  TEXT$ = S_D.D$;
     1616    10706    3                  IF L6_VECTOR.BYTE_NUM
     1617    10707    4                  THEN DO;
     1618    10708    4                       TEXT$ -> CHAR2 = '-1';
     1619    10709    4                       CALL DDR$BUMPC_D$ ( LENGTHC('-1') ) ALTRET ( DERR );
     1620    10710    4                     END;
     1621    10711    3                  TEXT$ = S_D.D$;
     1622    10712    3                  TEXT$ -> CHAR4 = ',BD=';
     1623    10713    3                  CALL DDR$BUMPC_D$ ( LENGTHC(',BD=') ) ALTRET ( DERR );
     1624    10714    3                  TEXT$ = S_D.D$;
     1625    10715    3                  VAL = L6_VECTOR.BD;
     1626    10716    3                  CALL DDR$BINTXT ( MYBUF$, VAL, %X_FMT, NCHARS ); /* Bound */
     1627    10717    3                  TEXT$ -> TEXTR = MYBUF;
     1628    10718    3                  CALL DDR$BUMPC_D$ ( NCHARS ) ALTRET ( DERR );
     1629    10719    3               END;
     1630    10720    2             RETURN;
     1631    10721                                                /*********************
     1632    10722                                                 ******* X_FMT *******
     1633    10723                                                 *********************/
     1634    10724    2          CASE( %X_FMT );
     1635    10725
     1636    10726    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );
     1637    10727
     1638    10728    3               CASE ( %HOST );
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:46   
     1639    10729
     1640    10730    3                  CALL DDR$BUMPC_D$(1) ALTRET(DERR);
     1641    10731    3                  TEXT$ -> CHAR1 = '''';
     1642    10732    3                  TEXT$ = S_D.D$;
     1643    10733    3                  J = 0;
     1644    10734    4                  DO CASE ( MOD(SIZE, 4) );
     1645    10735    4                    CASE (0);
     1646    10736    5                       DO I = 0 TO SIZE/36;
     1647    10737    5                            HOST_NUVAL(J) = HOST_VAL(I);
     1648    10738    5                            J = J + 1;
     1649    10739    5                          END;
     1650    10740    4                       NU_SIZE = SIZE;
     1651    10741    4                    CASE (1);
     1652    10742    5                       DO I = 0 TO SIZE/36;
     1653    10743    5                            HOST_NUVAL3.HOST_WRD(J) = HOST_VAL(I);
     1654    10744    5                            J = J + 1;
     1655    10745    5                          END;
     1656    10746    4                       NU_SIZE = SIZE + 3;
     1657    10747    4                    CASE (2);
     1658    10748    5                       DO I = 0 TO SIZE/36;
     1659    10749    5                            HOST_NUVAL2.HOST_WRD(J) = HOST_VAL(I);
     1660    10750    5                            J = J + 1;
     1661    10751    5                          END;
     1662    10752    4                       NU_SIZE = SIZE + 2;
     1663    10753    4                    CASE (3);
     1664    10754    5                       DO I = 0 TO SIZE/36;
     1665    10755    5                            HOST_NUVAL1.HOST_WRD(J) = HOST_VAL(I);
     1666    10756    5                            J = J + 1;
     1667    10757    5                          END;
     1668    10758    4                       NU_SIZE = SIZE + 1;
     1669    10759    4                    END;
     1670    10760    3                  CALL BIN2HEX;
     1671    10761    3                  TEXT$ -> TEXTR = MYBUF;
     1672    10762    3                  CALL DDR$BUMPC_D$(NCHARS) ALTRET (DERR);
     1673    10763    3                  TEXT$ = S_D.D$;
     1674    10764    3                  TEXT$ -> CHAR2 = '''X';
     1675    10765    3                  CALL DDR$BUMPC_D$( LENGTHC('''X') ) ALTRET (DERR);
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:47   
     1676    10766    3                  RETURN;
     1677    10767
     1678    10768    3               CASE ( %L6 );
     1679    10769
     1680    10770    3                  CALL DDR$BUMPC_D$(1) ALTRET (DERR);
     1681    10771    3                  TEXT$ -> CHAR1 = '.';
     1682    10772    3                  TEXT$ = S_D.D$;
     1683    10773    3                  J = 0;
     1684    10774    4                  DO CASE ( MOD (SIZE, 4) );
     1685    10775    4                    CASE (0);
     1686    10776    5                       DO I = 0 TO SIZE/16;
     1687    10777    5                            L6_NUVAL(J) = L6_VAL.L6_WRD(I);
     1688    10778    5                            J = J + 1;
     1689    10779    5                          END;
     1690    10780    4                       NU_SIZE = SIZE;
     1691    10781    4                    CASE (1);
     1692    10782    5                       DO I = 0 TO SIZE/16;
     1693    10783    5                            L6_NUVAL3.L6_WRD(J) = L6_VAL.L6_WRD(I);
     1694    10784    5                            J = J + 1;
     1695    10785    5                          END;
     1696    10786    4                       NU_SIZE = SIZE + 3;
     1697    10787    4                    CASE (2);
     1698    10788    5                       DO I = 0 TO SIZE/16;
     1699    10789    5                            L6_NUVAL2.L6_WRD(J) = L6_VAL.L6_WRD(I);
     1700    10790    5                            J = J + 1;
     1701    10791    5                          END;
     1702    10792    4                       NU_SIZE = SIZE + 2;
     1703    10793    4                    CASE (3);
     1704    10794    5                       DO I = 0 TO SIZE/16;
     1705    10795    5                            L6_NUVAL1.L6_WRD(J) = L6_VAL.L6_WRD(I);
     1706    10796    5                            J = J + 1;
     1707    10797    5                          END;
     1708    10798    4                       NU_SIZE = SIZE + 1;
     1709    10799    4                    END;
     1710    10800    3                  CALL BIN2HEX;
     1711    10801    3                  TEXT$ -> TEXTR = MYBUF;
     1712    10802    3                  CALL DDR$BUMPC_D$(NCHARS) ALTRET (DERR);
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:48   
     1713    10803    3                  RETURN;
     1714    10804    3               END;
     1715    10805                                                /**********************
     1716    10806                                                 ******* X1_FMT *******
     1717    10807                                                 **********************/
     1718    10808    2          CASE( %X1_FMT );
     1719    10809
     1720    10810    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );
     1721    10811
     1722    10812    3               CASE ( %HOST );
     1723    10813
     1724    10814    3                  CALL DDR$BUMPC_D$(1) ALTRET(DERR);
     1725    10815    3                  TEXT$ -> CHAR1 = '''';
     1726    10816    3                  TEXT$ = S_D.D$;
     1727    10817    4                  IF MOD(SIZE,9)~=0 THEN DO;
     1728    10818    4                       PINCRB(ADDR(CVALUES),9-MOD(SIZE,9))->B$BITS = ADDR(CVALUES)->
             10818                                B$BITS;
     1729    10819    4                       SIZE = (SIZE+9)/9*9;
     1730    10820    4                     END;
     1731    10821    3                  SIZED9 = SIZE / 9 - 1;
     1732    10822    3                  CALL DDR$BUMPC_D$( SIZED9 * 2 + 5 ) ALTRET(DERR);
     1733    10823    4                  DO I = 0 TO SIZED9;
     1734    10824    4                       TEXT$ -> CHAR1 = HEXCHARS(XVAL.L(I));
     1735    10825    4                       TEXT$ = PINCRC(TEXT$, 1);
     1736    10826    4                       TEXT$ -> CHAR1 = HEXCHARS(XVAL.R(I));
     1737    10827    4                       TEXT$ = PINCRC(TEXT$, 1);
     1738    10828    4                     END;                  /* DO I = 0 TO SIZED9 */
     1739    10829    3                  TEXT$ -> CHAR3 = '''X1';
     1740    10830    3                  RETURN;
     1741    10831
     1742    10832    3               CASE ( %L6 );
     1743    10833
     1744    10834    3                  S_D.ERROR = 311; /* E@WRONFEPFMT */
     1745    10835    3                  ALTRETURN;
     1746    10836
     1747    10837    3               END;
     1748    10838                                                /**********************
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:49   
     1749    10839                                                 ******* L$_FMT *******
     1750    10840                                                 **********************/
     1751    10841    2          CASE( %L$_FMT );
     1752    10842    2             FMT = S_D.L$.FMT;
     1753    10843    2             GOTO MAJORCASE;
     1754    10844    2          END;                             /* DO CASE( FMT ) */
     1755    10845    1        S_D.ERROR = 89;              /* E@UNKFMT */
     1756    10846    1        GOTO DERR;
     1757    10847    1   BADSCHEMA: ;
     1758    10848    1        S_D.ERROR = 22;              /* E@UERR11 */
     1759    10849    1        GOTO DERR;
     1760    10850    1   WRONG_SIZE: ;
     1761    10851    1        S_D.ERROR = 313;          /* E@SIZEMISFMT */
     1762    10852    1   DERR:
     1763    10853    1        ALTRETURN;
     1764    10854        %EJECT;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:50   
     1765    10855        /* Miscellaneous internal routines */
     1766    10856
     1767    10857    1   BIN2OCT: PROC;
     1768    10858
     1769    10859    2   DCL LEAD0 BIT(1);
     1770    10860    2        LEAD0 = '1'B;
     1771    10861    2        NCHARS = 0;
     1772    10862
     1773    10863    3        DO I = 0 TO NU_SIZE/3-1;
     1774    10864    3             IF OCT_VAL(I) ~= 0 THEN LEAD0 = '0'B;
     1775    10865    3             IF NOT( FMT=%OCT_FMT AND LEAD0='1'B AND OCT_VAL(I)=0 )
     1776    10866    4             THEN DO;
     1777    10867    4                  SUBSTR ( MYBUF, NCHARS, 1 ) = OCTCHARS ( OCT_VAL(I) );
     1778    10868    4                  NCHARS = NCHARS + 1;
     1779    10869    4                END;
     1780    10870    3           END;
     1781    10871    2        IF NCHARS = 0
     1782    10872    3        THEN DO;
     1783    10873    3             SUBSTR ( MYBUF, NCHARS, 1 ) = '0';
     1784    10874    3             NCHARS = NCHARS + 1;
     1785    10875    3           END;
     1786    10876    2        RETURN;
     1787    10877    2   END BIN2OCT;
     1788    10878        %EJECT;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:51   
     1789    10879    1   BIN2HEX: PROC;
     1790    10880    2   DCL LEAD0 BIT(1);
     1791    10881    2        LEAD0 = '1'B;
     1792    10882    2        NCHARS = 0;
     1793    10883
     1794    10884    3        DO I = 0 TO NU_SIZE/4-1;
     1795    10885    3             IF HEX_VAL(I) ~= 0 THEN LEAD0 = '0'B;
     1796    10886    3             IF NOT( FMT=%X_FMT AND LEAD0='1'B AND HEX_VAL(I)=0 )
     1797    10887    4             THEN DO;
     1798    10888    4                  SUBSTR ( MYBUF, NCHARS, 1 ) = HEXCHARS ( HEX_VAL(I) );
     1799    10889    4                  NCHARS = NCHARS + 1;
     1800    10890    4                END;
     1801    10891    3           END;
     1802    10892    2        IF NCHARS = 0
     1803    10893    3        THEN DO;
     1804    10894    3             SUBSTR ( MYBUF, NCHARS, 1 ) = '0';
     1805    10895    3             NCHARS = NCHARS + 1;
     1806    10896    3           END;
     1807    10897    2        RETURN;
     1808    10898    2   END BIN2HEX;
     1809    10899        %EJECT;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:52   
     1810    10900    1   STRETCH: PROC;
     1811    10901
     1812    10902    2   DCL J UBIN;
     1813    10903    2   DCL K UBIN;
     1814    10904    2   DCL SM1 UBIN;
     1815    10905    2        VAL = 0;
     1816    10906    2        SM1 = SIZE - 1;
     1817    10907    3        DO I = 0 TO SM1;
     1818    10908    3             J = SM1 - I;
     1819    10909    3             K = 35 - I;
     1820    10910    3             VALBITS(K) = VBITS(J);
     1821    10911    3           END;
     1822    10912    2        RETURN;
     1823    10913    2   END STRETCH;
     1824    10914        %EJECT;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:53   
     1825    10915    1   PUTDECIMALPT: PROC ALTRET;
     1826    10916    2        TEXT$ -> CHAR1 = '.';
     1827    10917    2        CALL DDR$BUMPC_D$( 1 ) ALTRET(DERR);
     1828    10918    2        TEXT$ = S_D.D$;
     1829    10919    2        RETURN;
     1830    10920    2   DERR: ALTRETURN;
     1831    10921    2   END PUTDECIMALPT;
     1832    10922        %EJECT;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:54   
     1833    10923    1   FLOAT: PROC(SIZE,VALUE) ALTRET;
     1834    10924    2   DCL SIZE UBIN;
     1835    10925    2   DCL VALUE BIT(72) DALIGNED;
     1836    10926    2   DCL DIG UBIN;
     1837    10927                                                /**/
     1838    10928    3        DO CASE (SIZE);
     1839    10929    3          CASE (36);
     1840    10930    3             DIG = 9;
     1841    10931    3             CALL XPN_7RTOLSP (VALUE, AN, DIG, POWER) ALTRET (BADLIB);
     1842    10932    3          CASE (72);
     1843    10933    3             DIG = 20;
     1844    10934    3             CALL XPN_7DTOLSP (VALUE, AN, DIG, POWER) ALTRET (BADLIB);
     1845    10935    3          CASE (44,80);
     1846    10936    3             IF SIZE = 44
     1847    10937    3             THEN DIG = 12;
     1848    10938    3             ELSE DIG = 22;
     1849    10939    3             POWER = KVALUE(2);            /* Need to pass $E for $EA[Q] */
     1850    10940    3             CALL XPN_7AQTOLSP (VALUE, AN, DIG, POWER) ALTRET (BADLIB);
     1851    10941    3          END;
     1852    10942
     1853    10943    2        IF (POWER < DIG AND POWER > 0)
     1854    10944    2        THEN CALL XPN_7FLJ(MYBUF, LENGTHC(MYBUF), AN, DIG, POWER-DIG, 0, NCHARS) ALTRET
             10944                 (BADLIB);
     1855    10945    2        ELSE CALL XPN_7ELJE1(MYBUF, LENGTHC(MYBUF), AN, DIG, POWER-DIG, 0, NCHARS, -2)
             10945                 ALTRET(BADLIB);
     1856    10946    2        CALL DDR$BUMPC_D$(NCHARS) ALTRET(DERR);
     1857    10947    2        TEXT$ -> TEXTR = MYBUF;
     1858    10948    2        RETURN;
     1859    10949    2   BADLIB:;
     1860    10950    2   DERR:;
     1861    10951    2        ALTRETURN;
     1862    10952    2   END FLOAT;
     1863    10953    1   END DDA$DISPFMT;

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:55   
--  Include file information  --

   B$OBJECT_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   DD_SUBS_C.:E05TOU  is referenced.
   DD$BASED.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDA$DISPFMT.

   Procedure DDA$DISPFMT requires 4795 words for executable code.
   Procedure DDA$DISPFMT requires 164 words of local(AUTO) storage.

    No errors detected in file DDA$DISPFMT.:E05TSI    .

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:56   

 Object Unit name= DDA$DISPFMT                                File name= DDA$DISPFMT.:E05TOU
 UTS= JUL 29 '97 13:21:06.40 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     93    135  DDA$DISPFMT
    1   Proc  even  none  4795  11273  DDA$DISPFMT
    2  RoData even  none    47     57  DDA$DISPFMT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        6  DDA$DISPFMT
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:57   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 B_POINTER
         yes           Std       1 DDK$COMP2
 yes     yes           Std       2 DDS$IC2NODE
 yes     yes           Std       4 DDR$MOVE
         yes           Std       0 DDE$ERROR
         yes           Std       4 DDR$BINTXT
 yes     yes           Std       1 DDR$BUMPC_D$
         yes           Std       0 DUE$L6JERRMSG
         yes           Std       1 DDK$COMP1
 yes     yes           Std       2 DDR$BINOCT
         yes           Std       0 DUE$JERRMSG
 yes     yes           Std       2 DDA$UTSTIME
 yes     yes           Std       2 DFR$UTSTIME
 yes     yes           Std       4 DFR$INSTR
 yes     yes           Std       5 DDR$POSIT
         yes           Std       2 DDQ$WRITE
 yes     yes           Std       2 DDF$DBG_#
 yes     yes           Std       1 DDR$INSTR
 yes     yes           Std       5 XPN_7RTOLSP
 yes     yes           Std       5 XPN_7DTOLSP
 yes     yes           Std       5 XPN_7AQTOLSP
 yes     yes           Std       7 XPN_7FLJ
 yes     yes           Std       8 XPN_7ELJE1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_N
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:58   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    B$XL_EBC_DUMP$                   r    S_D$                                  D_XDELTA
     USE$                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:59   


        1        1        /*M*  DDA$DISPFMT - formats up to 576 bit value into output buffer */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*F*  NAME:    DDA$DISPFMT
       10       10              PURPOSE: Output data up to 576 bits long, and format it, as
       11       11                       specified, into output buffer at S_D.D$.
       12       12
       13       13              DESCRIPTION: Depending on the system environment the user is in
       14       14                       ( either HOST or L6 ) and the format specified, this
       15       15                       module formats the input data accordingly to make the
       16       16                       best sense out of it.
       17       17
       18       18                                                                    *
       19       19              INPUT:   PFMT   - Format code.  See DD$DITEM for its value subs.
       20       20                       SIZE   - Number of bits to be formatted.  Some formats
       21       21                                require particular SIZE values.
       22       22
       23       23                       VALUEP - The input data to be formatted.  Generally, the
       24       24                                interpretation of it depends on the combination
       25       25                                of PFMT and the environment.  For the rest,
       26       26                                if the environment is HOST, then input is expected
       27       27                                to be left justified.  If the envoronment is L6,
       28       28                                then each L6 word ( 16 bits ) is expected to be
       29       29                                contained in one HOST word ( 36 bits ) left justified.
       30       30                                Within each L6 word, data is expected to be left
       31       31                                justified.  There are also a few special formats
       32       32                                which don't fall into either catagory. */
       33       33        %EJECT;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:60   
       34       34
       35       35        DDA$DISPFMT: PROC(PFMT, SIZE, VALUEP, PUP, PNO_UDEFS, PNPOINTERS) ALTRET;

     35  1 000000   000000 700200 xent  DDA$DISPFMT  TSX0  ! X66_AUTO_N
         1 000001   000244 000006                    ZERO    164,6

       36       36                                                /* Parms */
       37       37    1   DCL PFMT UBIN;
       38       38    1   DCL SIZE SBIN;
       39       39    1   DCL VALUEP CHAR(64) DALIGNED;
       40       40    1   DCL 1 PUP ALIGNED,
       41       41    1         2 * UBIN(22) UNAL,
       42       42    1         2 SCALE SBIN(8) UNAL,
       43       43    1         2 PUB UBIN(2) UNAL,
       44       44    1         2 SIGNPOS UBIN(2) UNAL,
       45       45    1         2 SIGNTYP BIT(1),
       46       46    1         2 SIGNOVER BIT(1);
       47       47    1   DCL PNO_UDEFS BIT(1) ALIGNED; /* Set if DDR$POSIT not to search user defs */
       48       48    1   DCL 1 PNPOINTERS ALIGNED,
       49       49    1         2 TRUE SBIN HALF UNAL,
       50       50    1         2 FALSE SBIN HALF UNAL;
       51       51    1   DCL NO_UDEFS BIT(1) ALIGNED;
       52       52    1   DCL CVALUES CHAR(64) DALIGNED;
       53       53    1   DCL HOST_VAL (0:15) REDEF CVALUES BIT(36);
       54       54    1   DCL 1 L6_VAL (0:15) REDEF CVALUES,
       55       55    1         2 * BIT(20) UNAL,
       56       56    1         2 L6_WRD BIT(16) UNAL,
       57       57    1         2 BIT16 REDEF L6_WRD,
       58       58    1           3 SIGN BIT(1) UNAL,
       59       59    1           3 * BIT(15) UNAL;
       60       60    1   DCL CVALUE(0:63) REDEF CVALUES CHAR(1);
       61       61    1   DCL 1 VALUE REDEF CVALUES,
       62       62    1         2 L SBIN,
       63       63    1         2 E REDEF L UBIN(18),
       64       64    1         2 LBITS REDEF L BIT(36),
       65       65    1         2 CODE REDEF L,
       66       66    1           3 FCG(0:2) UBIN(6) UNAL,
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:61   
       67       67    1           3 MON BIT(1) UNAL,
       68       68    1           3 ERROR UBIN(14) UNAL,
       69       69    1           3 SEV UBIN(3) UNAL,
       70       70    1         2 R SBIN,
       71       71    1         2 * CHAR(56);
       72       72    1   DCL 1 PVALUE REDEF CVALUES,
       73       73    1         2 W UBIN(18) UNAL,
       74       74    1         2 C UBIN(2) UNAL,
       75       75    1         2 B UBIN(4) UNAL,
       76       76    1         2 SEG,
       77       77    1           3 S UBIN(2) UNAL,
       78       78    1           3 D UBIN(10) UNAL,
       79       79    1         2 * CHAR(60);
       80       80    1   DCL 1 VVALUE REDEF CVALUES,
       81       81    1         2 W1,
       82       82    1           3 BOUND,
       83       83    1             4 W UBIN(18) UNAL,
       84       84    1             4 C UBIN(2) UNAL,
       85       85    1           3 FLAGS UBIN(9) UNAL,
       86       86    1           3 FLGS REDEF FLAGS,
       87       87    1             4 * BIT(7) UNAL,
       88       88    1             4 NOTEMPTY BIT(1) UNAL,
       89       89    1             4 * BIT(1) UNAL,
       90       90    1           3 TYPE UBIN(2) UNAL,
       91       91    1           3 * UBIN(5) UNAL,
       92       92    1         2 W2,
       93       93    1           3 W UBIN(18) UNAL,
       94       94    1           3 C UBIN(2) UNAL,
       95       95    1           3 B UBIN(4) UNAL,
       96       96    1           3 SEG,
       97       97    1             4 S UBIN(2) UNAL,
       98       98    1             4 D UBIN(10) UNAL,
       99       99    1         2 * CHAR(56);
      100      100    1   DCL 1 RVALUE REDEF CVALUES,
      101      101    1         2 L SBIN,
      102      102    1         2 OFFSET REDEF L UBIN(18),
      103      103    1         2 R SBIN,
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:62   
      104      104    1         2 E REDEF R UBIN(18),
      105      105    1         2 * CHAR(56);
      106      106    1   DCL VBITS(0:575) REDEF CVALUES UBIN(1) UNAL;
      107      107    1   DCL 1 DVALUE REDEF CVALUES,
      108      108    1         2 BOUND,
      109      109    1           3 W UBIN(18) UNAL,
      110      110    1           3 C UBIN(2) UNAL,
      111      111    1         2 SUPER REDEF BOUND,
      112      112    1           3 BASE UBIN(10) UNAL,
      113      113    1           3 BOUND UBIN(10) UNAL,
      114      114    1         2 FWR,
      115      115    1           3 FLAGS UBIN(9) UNAL,
      116      116    1           3 FLGS REDEF FLAGS,
      117      117    1             4 * BIT(7) UNAL,
      118      118    1             4 NOTEMPTY BIT(1) UNAL,
      119      119    1             4 * BIT(1) UNAL,
      120      120    1           3 WSR UBIN(3) UNAL,
      121      121    1         2 FWQ REDEF FWR,
      122      122    1           3 FLAGS UBIN(3) UNAL,
      123      123    1           3 WSQ UBIN(9) UNAL,
      124      124    1         2 TYPE UBIN(4) UNAL,
      125      125    1         2 BASE,
      126      126    1           3 W UBIN(34) UNAL,
      127      127    1           3 C UBIN(2) UNAL,
      128      128    1         2 * CHAR(56);
      129      129    1   DCL 1 EDVALUE REDEF CVALUES,
      130      130    1         2 IC UBIN(18) UNAL,
      131      131    1         2 * UBIN(1) UNAL,
      132      132    1         2 ISEG UBIN(10) UNAL,
      133      133    1         2 WSR UBIN(3) UNAL,
      134      134    1         2 TYPE UBIN(4) UNAL,
      135      135    1         2 LSIZE UBIN(10) UNAL,
      136      136    1         2 LBASE UBIN(23) UNAL,
      137      137    1         2 * UBIN(3) UNAL,
      138      138    1         2 * CHAR(56);
      139      139    1   DCL 1 XVAL(0:63) REDEF CVALUES,
      140      140    1         2 * BIT(1) UNAL,
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:63   
      141      141    1         2 L UBIN(4) UNAL,
      142      142    1         2 R UBIN(4) UNAL;
      143      143    1   DCL 1 HVAL(0:143) REDEF CVALUES,
      144      144    1         2 H UBIN(4) UNAL;
      145      145    1   DCL KVALUE(0:15) REDEF CVALUES UBIN;
      146      146    1   DCL DKVALUE(0:7) REDEF CVALUES BIT(72);
      147      147    1   DCL HOST_CHAR (0:63) REDEF CVALUES UBIN(9) UNAL;
      148      148    1   DCL 1 L6_PTR REDEF CVALUES,
      149      149    1         2 * BIT(20),
      150      150    1         2 BYTE_NUM BIT(1),
      151      151    1         2 UNUSED UBIN(11) UNAL,
      152      152    1         2 LEFT4 BIT(4),
      153      153    1         2 * BIT(20),
      154      154    1         2 RIGHT16 BIT(16),
      155      155    1         2 * (0:13) BIT(36);
      156      156    1   DCL 1 L6_AR REDEF CVALUES,
      157      157    1         2 * BIT(20),
      158      158    1         2 LEFT16 BIT(16),
      159      159    1         2 * BIT(20),
      160      160    1         2 RIGHT4 BIT(4),
      161      161    1         2 BYTE_NUM UBIN(1) UNAL,
      162      162    1         2 BIT_NUM UBIN(3) UNAL,
      163      163    1         2 * BIT(8),
      164      164    1         2 * (0:13) BIT(36);
      165      165    1   DCL 1 L6_VECTOR REDEF CVALUES,
      166      166    1         2 * BIT(20) UNAL,
      167      167    1         2 BD UBIN(16) UNAL,
      168      168    1         2 * BIT(20) UNAL,
      169      169    1         2 BYTE_NUM BIT(1) UNAL,
      170      170    1         2 * BIT(11) UNAL,
      171      171    1         2 LEFT4 BIT(4) UNAL,
      172      172    1         2 * BIT(20) UNAL,
      173      173    1         2 RIGHT16 BIT(16) UNAL,
      174      174    1         2 * (0:12) BIT(36) UNAL;
      175      175    1   DCL 1 L6_DESC REDEF CVALUES,
      176      176    1         2 * BIT(20) UNAL,
      177      177    1         2 VALID BIT(1) UNAL,
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:64   
      178      178    1         2 * BIT(3) UNAL,
      179      179    1         2 BASE UBIN(12) UNAL,
      180      180    1         2 * BIT(20) UNAL,
      181      181    1         2 RD_PRIV BIT(2) UNAL,
      182      182    1         2 WR_PRIV BIT(2) UNAL,
      183      183    1         2 EX_PRIV BIT(2) UNAL,
      184      184    1         2 * BIT(1) UNAL,
      185      185    1         2 SIZE UBIN(9) UNAL,
      186      186    1         2 * (0:13) BIT(36) UNAL;
      187      187    1   DCL 1 L6_REM REDEF CVALUES,
      188      188    1         2 * BIT(32) UNAL,
      189      189    1         2 AUTO_OFFSET_LEFT4 BIT(4) UNAL,  /* Address of remembered AUTO frame */
      190      190    1         2 * BIT(20) UNAL,
      191      191    1         2 AUTO_OFFSET_RIGHT16 BIT(16) UNAL,
      192      192    1         2 * BIT(32) UNAL,
      193      193    1         2 ADDR_LEFT4 BIT(4) UNAL,         /* Address of remembered statement */
      194      194    1         2 * BIT(20) UNAL,
      195      195    1         2 ADDR_RIGHT16 BIT(16) UNAL,
      196      196    1         2 * (0:11) BIT(36) UNAL;
      197      197    1   DCL 1 L6_CHAR (0:15) REDEF CVALUES,
      198      198    1         2 * BIT(21) UNAL,
      199      199    1         2 L UBIN(7) UNAL,
      200      200    1         2 * BIT(1) UNAL,
      201      201    1         2 R UBIN(7) UNAL;
      202      202    1   DCL 1 L6_EBCHAR (0:15) REDEF CVALUES,
      203      203    1         2 * BIT(20) UNAL,
      204      204    1         2 L UBIN (8) UNAL,
      205      205    1         2 R UBIN (8) UNAL;
      206      206    1   DCL 1 L6_EMSG REDEF CVALUES,
      207      207    1         2 * BIT(20) UNAL,
      208      208    1         2 F1 BIT(8) UNAL,
      209      209    1         2 F2 BIT(8) UNAL,
      210      210    1         2 * BIT(20) UNAL,
      211      211    1         2 E1 BIT(8) UNAL,
      212      212    1         2 E2 BIT(8) UNAL,
      213      213    1         2 * (0:13) BIT(36) UNAL;
      214      214    1   DCL 1 L6_UPDEC ( 0:15 ) REDEF CVALUES,
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:65   
      215      215    1         2 * BIT(20) UNAL,
      216      216    1         2 L UBIN(8) UNAL,
      217      217    1         2 R UBIN(8) UNAL;
      218      218    1   DCL 1 L6_PDEC ( 0:15 ) REDEF CVALUES,
      219      219    1         2 * BIT(20) UNAL,
      220      220    1         2 L1 UBIN(4) UNAL,
      221      221    1         2 L2 UBIN(4) UNAL,
      222      222    1         2 R1 UBIN(4) UNAL,
      223      223    1         2 R2 UBIN(4) UNAL;
      224      224    1   DCL HOST_NUVAL(0:15) BIT(36) ALIGNED;
      225      225    1   DCL HOST_NUCHARS REDEF HOST_NUVAL CHAR(64);
      226      226    1   DCL HOST_NUCHAR (0:63) REDEF HOST_NUVAL CHAR(1);
      227      227    1   DCL 1 PCHAR ( 0:63 ) REDEF HOST_NUVAL,
      228      228    1         2 LEFT5 UBIN ( 5 ) UNAL,
      229      229    1         2 RIGHT4 UBIN ( 4 ) UNAL;
      230      230    1   DCL NUVAL_BITS (0:575) REDEF HOST_NUVAL BIT(1);
      231      231    1   DCL 1 HOST_NUVAL1 REDEF HOST_NUVAL,
      232      232    1         2 * BIT(1) UNAL,
      233      233    1         2 HOST_WRD(0:14) BIT(36) UNAL,
      234      234    1         2 * BIT(35) UNAL;
      235      235    1   DCL 1 HOST_NUVAL2 REDEF HOST_NUVAL,
      236      236    1         2 * BIT(2) UNAL,
      237      237    1         2 HOST_WRD(0:14) BIT(36) UNAL,
      238      238    1         2 * BIT(34) UNAL;
      239      239    1   DCL 1 HOST_NUVAL3 REDEF HOST_NUVAL,
      240      240    1         2 * BIT(3) UNAL,
      241      241    1         2 HOST_WRD(0:14) BIT(36) UNAL,
      242      242    1         2 * BIT(33) UNAL;
      243      243    1   DCL L6_NUVAL(0:35) REDEF HOST_NUVAL BIT(16);
      244      244    1   DCL 1 L6_NUVAL1 REDEF HOST_NUVAL,
      245      245    1         2 * BIT(1) UNAL,
      246      246    1         2 L6_WRD(0:34) BIT(16) UNAL,
      247      247    1         2 * BIT(15) UNAL;
      248      248    1   DCL 1 L6_NUVAL2 REDEF HOST_NUVAL,
      249      249    1         2 * BIT(2) UNAL,
      250      250    1         2 L6_WRD (0:34) BIT(16) UNAL,
      251      251    1         2 * BIT(14) UNAL;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:66   
      252      252    1   DCL 1 L6_NUVAL3 REDEF HOST_NUVAL,
      253      253    1         2 * BIT(3) UNAL,
      254      254    1         2 L6_WRD(0:34) BIT(16) UNAL,
      255      255    1         2 * BIT(13) UNAL;
      256      256    1   DCL OCT_VAL (0:191) REDEF HOST_NUVAL UBIN(3) UNAL;
      257      257    1   DCL HEX_VAL (0:143) REDEF HOST_NUVAL UBIN(4) UNAL;
      258      258    1   DCL 1 ERR_VAL REDEF HOST_NUVAL,
      259      259    1         2 L ,
      260      260    1           3 * BIT(1) UNAL,
      261      261    1           3 F1 BIT(8) UNAL,
      262      262    1           3 * BIT(1) UNAL,
      263      263    1           3 F2 BIT(8) UNAL,
      264      264    1           3 * BIT(1) UNAL,
      265      265    1           3 E1 BIT(8) UNAL,
      266      266    1           3 * BIT(1) UNAL,
      267      267    1           3 E2 BIT(8) UNAL,
      268      268    1         2 * (0:14) BIT(36) UNAL;
      269      269                                                /* Locals */
      270      270    1   DCL TEXTR CHAR(NCHARS) BASED;
      271      271    1   DCL FMT UBIN;
      272      272    1   DCL NU_SIZE SBIN;
      273      273    1   DCL WRD_SIZE UBIN;
      274      274    1   DCL NCHARS UBIN;
      275      275    1   DCL PUB UBIN;
      276      276    1   DCL ACHARTEMP(0:63) CHAR(1);
      277      277    1   DCL CHARTEMP REDEF ACHARTEMP CHAR(64);
      278      278    1   DCL ZEROES(0:63) CHAR(1) CONSTANT INIT('0'*64);
      279      279    1   DCL ZERO REDEF ZEROES CHAR(64);
      280      280    1   DCL TEMP UBIN;
      281      281    1   DCL CHARS UBIN;
      282      282    1   DCL SCHAR CHAR(1);
      283      283    1   DCL SDIGIT CHAR(1);
      284      284    1   DCL SIGNPOS UBIN;
      285      285    1   DCL SIGNOVER BIT(1);
      286      286    1   DCL SIG BIT(1);
      287      287    1   DCL SCALE SBIN;
      288      288    1   DCL CTEMP CHAR(1);
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:67   
      289      289    1   DCL SIZED9 UBIN;
      290      290    1   DCL I UBIN;
      291      291    1   DCL J UBIN;
      292      292    1   DCL NEG BIT(1);
      293      293    1   DCL VALW UBIN;
      294      294    1   DCL VALWC CHAR(5);
      295      295    1   DCL TYPE UBIN;
      296      296    1   DCL TENTRY# UBIN;
      297      297    1   DCL FENTRY# UBIN;
      298      298    1   DCL TENTRY$ PTR;
      299      299    1   DCL FENTRY$ PTR;
      300      300    1   DCL BITCHAR(0:1) CONSTANT CHAR(1) INIT('0','1');
      301      301    1   DCL SEGID(0:3) CHAR(3) CONSTANT INIT(
      302      302    1             '$PS','$$$','$AS','$LS');
      303      303    1   DCL DIGITS CHAR(10) CONSTANT INIT('0123456789');
      304      304    1   DCL OCTCHARS(0:7) CHAR(1) CONSTANT INIT(
      305      305    1        '0','1','2','3','4','5','6','7');
      306      306    1   DCL HEXCHARS(0:15) CHAR(1) CONSTANT INIT(
      307      307    1        '0','1','2','3','4','5','6','7','8','9','A','B','C','D','E','F');
      308      308        /* The following table use a 9-bit EBCDIC character value as an index
      309      309           into an EBCDIC character.
      310      310               for the 9-bit EBCDIC character value -
      311      311                   the 9th bit has to be '0'B and 8 bits are needed to
      312      312                   distinguish a letter. */
      313      313
      314      314        %INCLUDE B$TABLES_C;
      315      422        %B$XL_EBC_DUMP(NAME=EBCDIC_XLATE_TBL);
      316      426    1   DCL AN CHAR(25);
      317      427    1   DCL POWER SBIN;
      318      428    1   DCL MYBUF CHAR(192);
      319      429    1   DCL MYBUF$ PTR;
      320      430    1   DCL OFFSET SBIN;
      321      431    1   DCL VAL SBIN;
      322      432    1   DCL VALBITS(0:35) REDEF VAL UBIN(1) UNAL;
      323      433    1   DCL 1 PWRD_VAL REDEF VAL,
      324      434    1         2 * BIT(16) UNAL,
      325      435    1         2 LEFT4 BIT(4) UNAL,
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:68   
      326      436    1         2 RIGHT16 BIT(16) UNAL;
      327      437    1   DCL 1 AWRD_VAL REDEF VAL,
      328      438    1         2 * BIT(16) UNAL,
      329      439    1         2 LEFT16 BIT(16) UNAL,
      330      440    1         2 RIGHT4 BIT(4) UNAL;
      331      441    1   DCL 1 DWRD_VAL REDEF VAL,
      332      442    1         2 * BIT(34) UNAL,
      333      443    1         2 RIGHT2 BIT(2) UNAL;
      334      444    1   DCL 1 L6TIME_VAL REDEF VAL,
      335      445    1         2 * BIT(4) UNAL,
      336      446    1         2 L BIT(16) UNAL,
      337      447    1         2 R BIT(16) UNAL,
      338      448    1         2 BITS(0:15) REDEF R BIT(1) UNAL;
      339      449    1   DCL TEXT$ PTR;
      340      450    1   DCL SAVE_EWSQ# UBIN;
      341      451                                                /* Misc */
      342      452    1   DCL CHAR1 CHAR(1) BASED;
      343      453    1   DCL CHAR2 CHAR(2) BASED;
      344      454    1   DCL CHAR3 CHAR(3) BASED;
      345      455    1   DCL CHAR4 CHAR(4) BASED;
      346      456    1   DCL CHAR5 CHAR(5) BASED;
      347      457    1   DCL CHAR6 CHAR(6) BASED;
      348      458    1   DCL CHAR7 CHAR(7) BASED;
      349      459    1   DCL CHAR8 CHAR(8) BASED;
      350      460    1   DCL CHAR9 CHAR(9) BASED;
      351      461    1   DCL CHAR11 CHAR(11) BASED;
      352      462    1   DCL CHAR13 CHAR(13) BASED;
      353      463    1   DCL CHAR15 CHAR(15) BASED;
      354      464    1   DCL CHAR16 CHAR(16) BASED;
      355      465    1   DCL CHAR62 CHAR(62) BASED;
      356      466    1   DCL UBIN9 UBIN BYTE BASED CALIGNED;
      357      467    1   DCL B$BITS(0:575) BIT(1) BASED UNAL;
      358      468             %INCLUDE DD$DITEM;
       12+     571             %LIST;
       13+     572    1        DCL SDD$ PTR;
       14+     573    1        DCL ZITEM$ PTR;
       15+     574    1        DCL SDD_L6$ PTR;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:69   
       16+     575    1        DCL ZITEM_L6$ PTR;
      359     1149             %INCLUDE XUH_MACRO_C;
      360     1233             %INCLUDE DD_SD_M;
      361     2569             % S_D;
      362     3887             %INCLUDE DD_ERR_C;
      363     4284    1   DCL D_XDELTA BIT(1) SYMREF;
      364     4285    1   DCL USE$ PTR SYMREF;
      365     4286             %INCLUDE DD$BASED;
      366     5589                %MODIFY$CMD;
      367     5605             %INCLUDE DD_SUBS_C;
      368     5876             %U$SE;
      369     5884             %INCLUDE B_STRINGS_C;
      370     6013             %INCLUDE B$OBJECT_C;
      371     9443             %B$DNAME;
      372     9462                                                /* External entries */
      373     9463    1   DCL DDR$BINOCT ENTRY(2) ALTRET;
      374     9464    1   DCL DDR$BINTXT ENTRY(4);
      375     9465    1   DCL DDE$ERROR ENTRY;
      376     9466    1   DCL DDR$BUMPC_D$ ENTRY(1) ALTRET;
      377     9467    1   DCL DDA$DISPUI ENTRY(2);
      378     9468    1   DCL DDR$INSTR ENTRY(1) ALTRET;
      379     9469    1   DCL DFR$INSTR ENTRY(4) ALTRET;
      380     9470    1   DCL DDR$POSIT ENTRY(5) ALTRET;
      381     9471    1   DCL DDQ$WRITE ENTRY(2);
      382     9472    1   DCL DDR$MOVE ENTRY(4) ALTRET;
      383     9473    1   DCL DDF$DBG_# ENTRY(2) ALTRET;
      384     9474    1   DCL DDS$IC2NODE ENTRY(2) ALTRET;
      385     9475    1   DCL DUE$JERRMSG ENTRY(0);
      386     9476    1   DCL DDA$UTSTIME ENTRY(2) ALTRET;
      387     9477    1   DCL DFR$UTSTIME ENTRY(2) ALTRET;
      388     9478    1   DCL DDK$COMP1 ENTRY(1);
      389     9479    1   DCL DDK$COMP2 ENTRY(1);
      390     9480                                                /* COMMON LIB ROUTINES */
      391     9481    1   DCL XPN_7RTOLSP ENTRY(5) ALTRET;        /* SINGLE FLOAT TO DIGITS & POWER */
      392     9482    1   DCL XPN_7DTOLSP ENTRY(5) ALTRET;        /* DOUBLE FLOAT TO DIGITS & POWER */
      393     9483    1   DCL XPN_7AQTOLSP ENTRY(5) ALTRET;       /* EA[Q] FLOAT TO DIGITS & POWER */
      394     9484    1   DCL XPN_7FLJ ENTRY(7) ALTRET;           /* DIGITS & POWER TO F FMT */
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:70   
      395     9485    1   DCL XPN_7ELJE1 ENTRY(8) ALTRET;         /* DIGITS & POWER TO E FMT */
      396     9486    1   DCL DUE$L6JERRMSG ENTRY;
      397     9487        %EJECT;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:71   
      398     9488                                                /**/
      399     9489    1        IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

   9489  1 000002   000000 470400 xsym               LDP0    S_D$
         1 000003   006714 235100                    LDA     3532,,PR0
         1 000004   000001 115007                    CMPA    1,DL
         1 000005   000011 601000 1                  TNZ     s:9491

      400     9490    1        THEN WRD_SIZE = 36;

   9490  1 000006   000044 236007                    LDQ     36,DL
         1 000007   200054 756100                    STQ     WRD_SIZE,,AUTO
         1 000010   000024 710000 1                  TRA     s:9498

      401     9491    1        ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

   9491  1 000011   000002 115007                    CMPA    2,DL
         1 000012   000016 601000 1                  TNZ     s:9494

      402     9492    1             THEN WRD_SIZE = 16;

   9492  1 000013   000020 236007                    LDQ     16,DL
         1 000014   200054 756100                    STQ     WRD_SIZE,,AUTO
         1 000015   000024 710000 1                  TRA     s:9498

      403     9493    2             ELSE DO;

      404     9494    2                  S_D.ERROR = 502;    /* E@DELBUG */

   9494  1 000016   000766 236007                    LDQ     502,DL
         1 000017   000013 756100                    STQ     11,,PR0

      405     9495    2                  CALL DDE$ERROR;

   9495  1 000020   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000021   000000 701000 xent               TSX1    DDE$ERROR
         1 000022   000000 011000                    NOP     0
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:72   

      406     9496    2                  ALTRETURN;

   9496  1 000023   000000 702200 xent               TSX2  ! X66_AALT

      407     9497    2                END;
      408     9498    1        IF SIZE > 16 * WRD_SIZE

   9498  1 000024   200004 471500                    LDP1    @SIZE,,AUTO
         1 000025   000004 736000                    QLS     4
         1 000026   000034 604000 1                  TMI     s:9503
         1 000027   100000 116100                    CMPQ    0,,PR1
         1 000030   000034 605000 1                  TPL     s:9503

      409     9499    2        THEN DO;

      410     9500    2             S_D.ERROR = 310;     /* E@CANTFORMAT */

   9500  1 000031   000466 235007                    LDA     310,DL
         1 000032   000013 755100                    STA     11,,PR0

      411     9501    2             ALTRETURN;

   9501  1 000033   000000 702200 xent               TSX2  ! X66_AALT

      412     9502    2           END;
      413     9503    1        MYBUF$ = ADDR(MYBUF);

   9503  1 000034   200134 633500                    EPPR3   MYBUF,,AUTO
         1 000035   200214 453500                    STP3    MYBUF$,,AUTO

      414     9504    1        TEXT$ = S_D.D$;

   9504  1 000036   000044 236100                    LDQ     36,,PR0
         1 000037   200217 756100                    STQ     TEXT$,,AUTO

      415     9505    1        FMT = PFMT;                        /* SEPARATE PARMS FROM LOCAL DATA */
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:73   

   9505  1 000040   200003 474500                    LDP4    @PFMT,,AUTO
         1 000041   400000 235100                    LDA     0,,PR4
         1 000042   200052 755100                    STA     FMT,,AUTO

      416     9506    1        CVALUES = VALUEP;

   9506  1 000043   200005 475500                    LDP5    @VALUEP,,AUTO
         1 000044   040100 100500                    MLR     fill='040'O
         1 000045   500000 000100                    ADSC9   0,,PR5                   cn=0,n=64
         1 000046   200012 000100                    ADSC9   CVALUES,,AUTO            cn=0,n=64

      417     9507    1        IF ADDR(PNO_UDEFS) = ADDR(NIL)

   9507  1 000047   200007 236100                    LDQ     @PNO_UDEFS,,AUTO
         1 000050   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000051   000054 601000 1                  TNZ     s:9509

      418     9508    1        THEN NO_UDEFS = '0'B;

   9508  1 000052   200011 450100                    STZ     NO_UDEFS,,AUTO
         1 000053   000060 710000 1                  TRA     s:9510

      419     9509    1        ELSE NO_UDEFS = PNO_UDEFS;

   9509  1 000054   200007 476500                    LDP6    @PNO_UDEFS,,AUTO
         1 000055   600000 236100                    LDQ     0,,PR6
         1 000056   400000 376003                    ANQ     -131072,DU
         1 000057   200011 756100                    STQ     NO_UDEFS,,AUTO

      420     9510    1        HOST_NUVAL = '0'B;

   9510  1 000060   000100 100400                    MLR     fill='000'O
         1 000061   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000062   200032 000100                    ADSC9   HOST_NUVAL,,AUTO         cn=0,n=64

      421     9511    1        NEG = '0'B;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:74   

   9511  1 000063   200113 450100                    STZ     NEG,,AUTO

      422     9512        /*   IF ADDR(PUP)~=ADDR(NIL) THEN
      423     9513                IF PUP.PUB=1  PACKED DECIMAL AND FMT~=%PUP_FMT THEN
      424     9514                   SIZE = (SIZE/2)*9 + MOD(SIZE,2)*4;*/
      425     9515
      426     9516                                                /**/
      427     9517    1   MAJORCASE:
      428     9518    2        DO CASE( FMT );

   9518  1 000064   200052 235100       MAJORCASE    LDA     FMT,,AUTO
         1 000065   000042 115007                    CMPA    34,DL
         1 000066   000070 602005 1                  TNC     MAJORCASE+4,AL
         1 000067   010550 710000 1                  TRA     s:10845
         1 000070   005765 710000 1                  TRA     s:10461
         1 000071   003750 710000 1                  TRA     s:10087
         1 000072   006240 710000 1                  TRA     SINTFMT
         1 000073   006240 710000 1                  TRA     SINTFMT
         1 000074   000646 710000 1                  TRA     s:9631
         1 000075   000541 710000 1                  TRA     s:9610
         1 000076   003444 710000 1                  TRA     s:10020
         1 000077   000132 710000 1                  TRA     s:9524
         1 000100   001172 710000 1                  TRA     s:9703
         1 000101   005645 710000 1                  TRA     REL
         1 000102   003344 710000 1                  TRA     s:9987
         1 000103   000132 710000 1                  TRA     s:9524
         1 000104   007026 710000 1                  TRA     s:10601
         1 000105   007732 710000 1                  TRA     s:10726
         1 000106   010550 710000 1                  TRA     s:10845
         1 000107   010544 710000 1                  TRA     s:10842
         1 000110   003400 710000 1                  TRA     s:10002
         1 000111   003502 710000 1                  TRA     s:10033
         1 000112   010405 710000 1                  TRA     s:10810
         1 000113   006730 710000 1                  TRA     s:10578
         1 000114   003750 710000 1                  TRA     s:10087
         1 000115   003147 710000 1                  TRA     s:9955
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:75   
         1 000116   001155 710000 1                  TRA     s:9694
         1 000117   010550 710000 1                  TRA     s:10845
         1 000120   010550 710000 1                  TRA     s:10845
         1 000121   003724 710000 1                  TRA     s:10077
         1 000122   001026 710000 1                  TRA     s:9662
         1 000123   010550 710000 1                  TRA     s:10845
         1 000124   010550 710000 1                  TRA     s:10845
         1 000125   004367 710000 1                  TRA     s:10173
         1 000126   010550 710000 1                  TRA     s:10845
         1 000127   010550 710000 1                  TRA     s:10845
         1 000130   001135 710000 1                  TRA     s:9683
         1 000131   006423 710000 1                  TRA     s:10540

      429     9519                                                /*******************************
      430     9520                                                 ******* AR_FMT, PTR_FMT *******
      431     9521                                                 *******************************/
      432     9522    2          CASE( %AR_FMT, %PTR_FMT );

      433     9523
      434     9524    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );

   9524  1 000132   000000 470400 xsym               LDP0    S_D$
         1 000133   006714 235100                    LDA     3532,,PR0
         1 000134   000003 115007                    CMPA    3,DL
         1 000135   000137 602005 1                  TNC     s:9524+5,AL
         1 000136   010550 710000 1                  TRA     s:10845
         1 000137   000540 710000 1                  TRA     s:9605
         1 000140   000142 710000 1                  TRA     s:9528
         1 000141   000425 710000 1                  TRA     s:9574

      435     9525
      436     9526    3               CASE ( %HOST );

      437     9527
      438     9528    3                  IF SIZE ~= 36 THEN GOTO WRONG_SIZE;

   9528  1 000142   200004 471500                    LDP1    @SIZE,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:76   
         1 000143   100000 235100                    LDA     0,,PR1
         1 000144   000044 115007                    CMPA    36,DL
         1 000145   010560 601000 1                  TNZ     WRONG_SIZE

      439     9529    3                  VAL = PVALUE.W;

   9529  1 000146   200012 236100                    LDQ     CVALUES,,AUTO
         1 000147   000022 772000                    QRL     18
         1 000150   200216 756100                    STQ     VAL,,AUTO

      440     9530    3                  CALL DDR$BINTXT( MYBUF$, VAL, %OCT_FMT, NCHARS );

   9530  1 000151   200055 633500                    EPPR3   NCHARS,,AUTO
         1 000152   200235 453500                    STP3    DIG+4,,AUTO
         1 000153   000000 236000 2                  LDQ     0
         1 000154   200234 756100                    STQ     DIG+3,,AUTO
         1 000155   200216 634500                    EPPR4   VAL,,AUTO
         1 000156   200233 454500                    STP4    DIG+2,,AUTO
         1 000157   200214 635500                    EPPR5   MYBUF$,,AUTO
         1 000160   200232 455500                    STP5    DIG+1,,AUTO
         1 000161   200232 630500                    EPPR0   DIG+1,,AUTO
         1 000162   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000163   000000 701000 xent               TSX1    DDR$BINTXT
         1 000164   000000 011000                    NOP     0

      441     9531    3                  CALL DDR$BUMPC_D$( NCHARS );

   9531  1 000165   200055 630500                    EPPR0   NCHARS,,AUTO
         1 000166   200232 450500                    STP0    DIG+1,,AUTO
         1 000167   200232 630500                    EPPR0   DIG+1,,AUTO
         1 000170   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000171   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 000172   000000 011000                    NOP     0

      442     9532    3                  TEXT$ -> TEXTR = MYBUF;

   9532  1 000173   200217 470500                    LDP0    TEXT$,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:77   
         1 000174   200055 720100                    LXL0    NCHARS,,AUTO
         1 000175   040140 100500                    MLR     fill='040'O
         1 000176   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 000177   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      443     9533    3                  TEXT$ = S_D.D$;

   9533  1 000200   000000 471400 xsym               LDP1    S_D$
         1 000201   100044 236100                    LDQ     36,,PR1
         1 000202   200217 756100                    STQ     TEXT$,,AUTO

      444     9534    3                  VAL = PVALUE.C;

   9534  1 000203   200012 236100                    LDQ     CVALUES,,AUTO
         1 000204   000020 772000                    QRL     16
         1 000205   000003 376007                    ANQ     3,DL
         1 000206   200216 756100                    STQ     VAL,,AUTO

      445     9535    3                  CALL DDR$BUMPC_D$( 5 )  ALTRET(DERR);

   9535  1 000207   000001 630400 2                  EPPR0   1
         1 000210   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000211   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 000212   010563 702000 1                  TSX2    DERR

      446     9536    3                  TEXT$ -> CHAR1 = '-';

   9536  1 000213   200217 470500                    LDP0    TEXT$,,AUTO
         1 000214   040100 100400                    MLR     fill='040'O
         1 000215   000002 000001 2                  ADSC9   2                        cn=0,n=1
         1 000216   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      447     9537    3                  TEXT$ = PINCRC( TEXT$, 1 );

   9537  1 000217   200217 236100                    LDQ     TEXT$,,AUTO
         1 000220   200000 036007                    ADLQ    65536,DL
         1 000221   200217 756100                    STQ     TEXT$,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:78   

      448     9538    3                  CALL BINCHAR( TEXT$ -> CHAR1, VAL );

   9538  1 000222   200217 470500                    LDP0    TEXT$,,AUTO
         1 000223   000100 301500                    BTD
         1 000224   200216 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         1 000225   000000 030001                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=1

      449     9539    3                  PINCRC( TEXT$, 1 ) -> CHAR1 = '-';

   9539  1 000226   040100 100400                    MLR     fill='040'O
         1 000227   000002 000001 2                  ADSC9   2                        cn=0,n=1
         1 000230   000000 200001                    ADSC9   0,,PR0                   cn=1,n=1

      450     9540    3                  TEXT$ = PINCRC( TEXT$, 2 );

   9540  1 000231   400000 036007                    ADLQ    -131072,DL
         1 000232   200217 756100                    STQ     TEXT$,,AUTO

      451     9541    3                  VAL = PVALUE.B;

   9541  1 000233   200012 236100                    LDQ     CVALUES,,AUTO
         1 000234   000014 772000                    QRL     12
         1 000235   000017 376007                    ANQ     15,DL
         1 000236   200216 756100                    STQ     VAL,,AUTO

      452     9542    3                  CALL DDR$BINTXT(MYBUF$, VAL, %UINT_FMT, NCHARS);

   9542  1 000237   200055 630500                    EPPR0   NCHARS,,AUTO
         1 000240   200235 450500                    STP0    DIG+4,,AUTO
         1 000241   000003 236000 2                  LDQ     3
         1 000242   200234 756100                    STQ     DIG+3,,AUTO
         1 000243   200216 631500                    EPPR1   VAL,,AUTO
         1 000244   200233 451500                    STP1    DIG+2,,AUTO
         1 000245   200214 633500                    EPPR3   MYBUF$,,AUTO
         1 000246   200232 453500                    STP3    DIG+1,,AUTO
         1 000247   200232 630500                    EPPR0   DIG+1,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:79   
         1 000250   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000251   000000 701000 xent               TSX1    DDR$BINTXT
         1 000252   000000 011000                    NOP     0

      453     9543    3                  CALL DDR$BUMPC_D$(NCHARS - 1) ALTRET(DERR);

   9543  1 000253   200055 235100                    LDA     NCHARS,,AUTO
         1 000254   000001 135007                    SBLA    1,DL
         1 000255   200232 755100                    STA     DIG+1,,AUTO
         1 000256   200232 630500                    EPPR0   DIG+1,,AUTO
         1 000257   200233 450500                    STP0    DIG+2,,AUTO
         1 000260   200233 630500                    EPPR0   DIG+2,,AUTO
         1 000261   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000262   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 000263   010563 702000 1                  TSX2    DERR

      454     9544    3                  TEXT$ -> TEXTR = MYBUF;

   9544  1 000264   200217 470500                    LDP0    TEXT$,,AUTO
         1 000265   200055 720100                    LXL0    NCHARS,,AUTO
         1 000266   040140 100500                    MLR     fill='040'O
         1 000267   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 000270   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      455     9545    3                  TEXT$ = PINCRC(TEXT$, NCHARS - 1);

   9545  1 000271   200055 236100                    LDQ     NCHARS,,AUTO
         1 000272   000020 736000                    QLS     16
         1 000273   200000 136007                    SBLQ    65536,DL
         1 000274   200217 036100                    ADLQ    TEXT$,,AUTO
         1 000275   200217 756100                    STQ     TEXT$,,AUTO

      456     9546    3                  IF FMT = %AR_FMT

   9546  1 000276   200052 235100                    LDA     FMT,,AUTO
         1 000277   000013 115007                    CMPA    11,DL
         1 000300   000306 601000 1                  TNZ     s:9551
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:80   

      457     9547    4                  THEN DO;

      458     9548    4                       S_D.D$ = PINCRC(S_D.D$, -1);

   9548  1 000301   000000 470400 xsym               LDP0    S_D$
         1 000302   000044 236100                    LDQ     36,,PR0
         1 000303   000034 036000 xsym               ADLQ    B_VECTNIL+28
         1 000304   000044 756100                    STQ     36,,PR0

      459     9549    4                       RETURN;

   9549  1 000305   000000 702200 xent               TSX2  ! X66_ARET

      460     9550    4                     END;
      461     9551    3                  PINCRC( TEXT$, 1 ) -> CHAR1 = ',';

   9551  1 000306   200217 470500                    LDP0    TEXT$,,AUTO
         1 000307   040100 100400                    MLR     fill='040'O
         1 000310   000004 000001 2                  ADSC9   4                        cn=0,n=1
         1 000311   000000 200001                    ADSC9   0,,PR0                   cn=1,n=1

      462     9552    3                  TEXT$ = PINCRC( TEXT$, 2 );

   9552  1 000312   400000 036007                    ADLQ    -131072,DL
         1 000313   200217 756100                    STQ     TEXT$,,AUTO

      463     9553    3                  VAL = PVALUE.SEG.S;

   9553  1 000314   200012 236100                    LDQ     CVALUES,,AUTO
         1 000315   000012 772000                    QRL     10
         1 000316   000003 376007                    ANQ     3,DL
         1 000317   200216 756100                    STQ     VAL,,AUTO

      464     9554    3                  IF VAL = 1               /* Segid of .2000  is strange */

   9554  1 000320   000001 116007                    CMPQ    1,DL
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:81   
         1 000321   000355 601000 1                  TNZ     s:9562

      465     9555    4                  THEN DO;

      466     9556    4                       VAL = BITBIN( PVALUE.SEG );

   9556  1 000322   200012 236100                    LDQ     CVALUES,,AUTO
         1 000323   007777 376007                    ANQ     4095,DL
         1 000324   200216 756100                    STQ     VAL,,AUTO

      467     9557    4                       CALL DDR$BINTXT( MYBUF$, VAL, %OCT_FMT, NCHARS );

   9557  1 000325   200055 630500                    EPPR0   NCHARS,,AUTO
         1 000326   200235 450500                    STP0    DIG+4,,AUTO
         1 000327   000000 236000 2                  LDQ     0
         1 000330   200234 756100                    STQ     DIG+3,,AUTO
         1 000331   200216 631500                    EPPR1   VAL,,AUTO
         1 000332   200233 451500                    STP1    DIG+2,,AUTO
         1 000333   200214 633500                    EPPR3   MYBUF$,,AUTO
         1 000334   200232 453500                    STP3    DIG+1,,AUTO
         1 000335   200232 630500                    EPPR0   DIG+1,,AUTO
         1 000336   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000337   000000 701000 xent               TSX1    DDR$BINTXT
         1 000340   000000 011000                    NOP     0

      468     9558    4                       CALL DDR$BUMPC_D$( NCHARS )  ALTRET(DERR);

   9558  1 000341   200055 630500                    EPPR0   NCHARS,,AUTO
         1 000342   200232 450500                    STP0    DIG+1,,AUTO
         1 000343   200232 630500                    EPPR0   DIG+1,,AUTO
         1 000344   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000345   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 000346   010563 702000 1                  TSX2    DERR

      469     9559    4                       TEXT$ -> TEXTR = MYBUF;

   9559  1 000347   200217 470500                    LDP0    TEXT$,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:82   
         1 000350   200055 720100                    LXL0    NCHARS,,AUTO
         1 000351   040140 100500                    MLR     fill='040'O
         1 000352   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 000353   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      470     9560    4                     END;

   9560  1 000354   000424 710000 1                  TRA     s:9570

      471     9561    4                  ELSE DO;

      472     9562    4                       CALL DDR$BUMPC_D$( 3 )  ALTRET(DERR);

   9562  1 000355   000005 630400 2                  EPPR0   5
         1 000356   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000357   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 000360   010563 702000 1                  TSX2    DERR

      473     9563    4                       TEXT$ -> CHAR3 = SEGID( VAL ); /* $xS */

   9563  1 000361   200216 236100                    LDQ     VAL,,AUTO
         1 000362   000003 402007                    MPY     3,DL
         1 000363   200217 470500                    LDP0    TEXT$,,AUTO
         1 000364   040100 100406                    MLR     fill='040'O
         1 000365   000021 000003 0                  ADSC9   SEGID,Q                  cn=0,n=3
         1 000366   000000 000003                    ADSC9   0,,PR0                   cn=0,n=3

      474     9564    4                       TEXT$ = S_D.D$;

   9564  1 000367   000000 471400 xsym               LDP1    S_D$
         1 000370   100044 236100                    LDQ     36,,PR1
         1 000371   200217 756100                    STQ     TEXT$,,AUTO

      475     9565    4                       VAL = PVALUE.SEG.D;

   9565  1 000372   200012 236100                    LDQ     CVALUES,,AUTO
         1 000373   001777 376007                    ANQ     1023,DL
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:83   
         1 000374   200216 756100                    STQ     VAL,,AUTO

      476     9566    4                       CALL DDR$BINTXT( MYBUF$, VAL, %UINT_FMT, NCHARS );

   9566  1 000375   200055 630500                    EPPR0   NCHARS,,AUTO
         1 000376   200235 450500                    STP0    DIG+4,,AUTO
         1 000377   000003 236000 2                  LDQ     3
         1 000400   200234 756100                    STQ     DIG+3,,AUTO
         1 000401   200216 633500                    EPPR3   VAL,,AUTO
         1 000402   200233 453500                    STP3    DIG+2,,AUTO
         1 000403   200214 634500                    EPPR4   MYBUF$,,AUTO
         1 000404   200232 454500                    STP4    DIG+1,,AUTO
         1 000405   200232 630500                    EPPR0   DIG+1,,AUTO
         1 000406   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000407   000000 701000 xent               TSX1    DDR$BINTXT
         1 000410   000000 011000                    NOP     0

      477     9567    4                       CALL DDR$BUMPC_D$( NCHARS ) ALTRET(DERR);

   9567  1 000411   200055 630500                    EPPR0   NCHARS,,AUTO
         1 000412   200232 450500                    STP0    DIG+1,,AUTO
         1 000413   200232 630500                    EPPR0   DIG+1,,AUTO
         1 000414   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000415   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 000416   010563 702000 1                  TSX2    DERR

      478     9568    4                       TEXT$ -> TEXTR = MYBUF;

   9568  1 000417   200217 470500                    LDP0    TEXT$,,AUTO
         1 000420   200055 720100                    LXL0    NCHARS,,AUTO
         1 000421   040140 100500                    MLR     fill='040'O
         1 000422   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 000423   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      479     9569    4                     END;

      480     9570    3                  RETURN;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:84   

   9570  1 000424   000000 702200 xent               TSX2  ! X66_ARET

      481     9571
      482     9572    3               CASE ( %L6 );

      483     9573
      484     9574    3                  VAL = 0;

   9574  1 000425   200216 450100                    STZ     VAL,,AUTO

      485     9575    4                  DO CASE ( FMT );

   9575  1 000426   200052 236100                    LDQ     FMT,,AUTO
         1 000427   000007 136007                    SBLQ    7,DL
         1 000430   000005 116007                    CMPQ    5,DL
         1 000431   000433 602006 1                  TNC     s:9575+5,QL
         1 000432   000537 710000 1                  TRA     s:9604
         1 000433   000440 710000 1                  TRA     s:9579
         1 000434   000537 710000 1                  TRA     s:9604
         1 000435   000537 710000 1                  TRA     s:9604
         1 000436   000537 710000 1                  TRA     s:9604
         1 000437   000534 710000 1                  TRA     s:9600

      486     9576
      487     9577    4                    CASE ( %PTR_FMT );

      488     9578
      489     9579    4                       IF SIZE ~= 32 THEN GOTO WRONG_SIZE;

   9579  1 000440   200004 471500                    LDP1    @SIZE,,AUTO
         1 000441   100000 235100                    LDA     0,,PR1
         1 000442   000040 115007                    CMPA    32,DL
         1 000443   010560 601000 1                  TNZ     WRONG_SIZE

      490     9580    4                       IF L6_PTR.UNUSED ~= 0

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:85   
   9580  1 000444   200012 236100                    LDQ     CVALUES,,AUTO
         1 000445   077760 316007                    CANQ    32752,DL
         1 000446   000452 600000 1                  TZE     s:9585

      491     9581    5                       THEN DO;

      492     9582    5                            FMT = %X_FMT;

   9582  1 000447   000015 235007                    LDA     13,DL
         1 000450   200052 755100                    STA     FMT,,AUTO

      493     9583    5                            GOTO MAJORCASE;

   9583  1 000451   000064 710000 1                  TRA     MAJORCASE

      494     9584    5                          END;
      495     9585    4                       PWRD_VAL.LEFT4 = L6_PTR.LEFT4;

   9585  1 000452   000020 736000                    QLS     16
         1 000453   200216 676100                    ERQ     VAL,,AUTO
         1 000454   000006 376000 2                  ANQ     6
         1 000455   200216 656100                    ERSQ    VAL,,AUTO

      496     9586    4                       PWRD_VAL.RIGHT16 = L6_PTR.RIGHT16;

   9586  1 000456   200013 236100                    LDQ     CVALUES+1,,AUTO
         1 000457   200216 676100                    ERQ     VAL,,AUTO
         1 000460   177777 376007                    ANQ     65535,DL
         1 000461   200216 656100                    ERSQ    VAL,,AUTO

      497     9587    4                       CALL DDR$BINTXT ( MYBUF$, VAL, %X_FMT, NCHARS );

   9587  1 000462   200055 633500                    EPPR3   NCHARS,,AUTO
         1 000463   200235 453500                    STP3    DIG+4,,AUTO
         1 000464   000010 236000 2                  LDQ     8
         1 000465   200234 756100                    STQ     DIG+3,,AUTO
         1 000466   200216 634500                    EPPR4   VAL,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:86   
         1 000467   200233 454500                    STP4    DIG+2,,AUTO
         1 000470   200214 635500                    EPPR5   MYBUF$,,AUTO
         1 000471   200232 455500                    STP5    DIG+1,,AUTO
         1 000472   200232 630500                    EPPR0   DIG+1,,AUTO
         1 000473   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000474   000000 701000 xent               TSX1    DDR$BINTXT
         1 000475   000000 011000                    NOP     0

      498     9588    4                       TEXT$ -> TEXTR = MYBUF;

   9588  1 000476   200217 470500                    LDP0    TEXT$,,AUTO
         1 000477   200055 720100                    LXL0    NCHARS,,AUTO
         1 000500   040140 100500                    MLR     fill='040'O
         1 000501   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 000502   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      499     9589    4                       CALL DDR$BUMPC_D$ (NCHARS) ALTRET (DERR);

   9589  1 000503   200055 631500                    EPPR1   NCHARS,,AUTO
         1 000504   200232 451500                    STP1    DIG+1,,AUTO
         1 000505   200232 630500                    EPPR0   DIG+1,,AUTO
         1 000506   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000507   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 000510   010563 702000 1                  TSX2    DERR

      500     9590    4                       TEXT$ = S_D.D$;

   9590  1 000511   000000 470400 xsym               LDP0    S_D$
         1 000512   000044 236100                    LDQ     36,,PR0
         1 000513   200217 756100                    STQ     TEXT$,,AUTO

      501     9591    4                       IF FMT = %EPTR_FMT THEN RETURN;
              9591                                /* EPTR has to be  on word boundry */

   9591  1 000514   200052 235100                    LDA     FMT,,AUTO
         1 000515   000012 115007                    CMPA    10,DL
         1 000516   000520 601000 1                  TNZ     s:9592
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:87   

   9591  1 000517   000000 702200 xent               TSX2  ! X66_ARET

      502     9592    4                       IF L6_PTR.BYTE_NUM  /* C PTR */

   9592  1 000520   200012 236100                    LDQ     CVALUES,,AUTO
         1 000521   100000 316007                    CANQ    32768,DL
         1 000522   000537 600000 1                  TZE     s:9604

      503     9593    5                       THEN DO;

      504     9594    5                            TEXT$ -> CHAR2 = '-1';

   9594  1 000523   200217 471500                    LDP1    TEXT$,,AUTO
         1 000524   040100 100400                    MLR     fill='040'O
         1 000525   000035 000002 0                  ADSC9   HEXCHARS+4               cn=0,n=2
         1 000526   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2

      505     9595    5                            CALL DDR$BUMPC_D$ ( LENGTHC('-1')) ALTRET (DERR);

   9595  1 000527   000003 630400 2                  EPPR0   3
         1 000530   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000531   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 000532   010563 702000 1                  TSX2    DERR

      506     9596    5                          END;

   9596  1 000533   000537 710000 1                  TRA     s:9604

      507     9597
      508     9598    4                    CASE ( %AR_FMT );

      509     9599
      510     9600    4                       S_D.ERROR = 311; /* E@WRONFEPFMT */

   9600  1 000534   000467 235007                    LDA     311,DL
         1 000535   000013 755100                    STA     11,,PR0
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:88   

      511     9601    4                       GOTO DERR;

   9601  1 000536   010563 710000 1                  TRA     DERR

      512     9602
      513     9603    4                    END;

      514     9604    3                  RETURN;

   9604  1 000537   000000 702200 xent               TSX2  ! X66_ARET

      515     9605    3               END;

   9605  1 000540   010550 710000 1                  TRA     s:10845

      516     9606                                                /***********************
      517     9607                                                 ******* BIT_FMT *******
      518     9608                                                 ***********************/
      519     9609    2          CASE( %BIT_FMT );

      520     9610    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

   9610  1 000541   000000 470400 xsym               LDP0    S_D$
         1 000542   006714 235100                    LDA     3532,,PR0
         1 000543   000002 115007                    CMPA    2,DL
         1 000544   000573 601000 1                  TNZ     s:9617

      521     9611    3             THEN DO;

      522     9612    4                  DO I = 0 TO SIZE/16;

   9612  1 000545   200111 450100                    STZ     I,,AUTO
         1 000546   000561 710000 1                  TRA     s:9614+3

      523     9613    4                       L6_NUVAL(I) = L6_VAL.L6_WRD(I);

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:89   
   9613  1 000547   200111 236100                    LDQ     I,,AUTO
         1 000550   000044 402007                    MPY     36,DL
         1 000551   200111 235100                    LDA     I,,AUTO
         1 000552   000004 735000                    ALS     4
         1 000553   003105 060506                    CSL     bolr='003'O
         1 000554   200012 420020                    BDSC    CVALUES,Q,AUTO           by=2,bit=2,n=16
         1 000555   200032 000020                    BDSC    HOST_NUVAL,A,AUTO        by=0,bit=0,n=16

      524     9614    4                     END;

   9614  1 000556   200111 235100                    LDA     I,,AUTO
         1 000557   000001 035007                    ADLA    1,DL
         1 000560   200111 755100                    STA     I,,AUTO
         1 000561   200004 470500                    LDP0    @SIZE,,AUTO
         1 000562   000000 236100                    LDQ     0,,PR0
         1 000563   000020 506007                    DIV     16,DL
         1 000564   000000 116003                    CMPQ    0,DU
         1 000565   000570 604000 1                  TMI     s:9615
         1 000566   200111 116100                    CMPQ    I,,AUTO
         1 000567   000547 603000 1                  TRC     s:9613

      525     9615    3                  VBITS = L6_NUVAL;

   9615  1 000570   000100 100500                    MLR     fill='000'O
         1 000571   200032 000100                    ADSC9   HOST_NUVAL,,AUTO         cn=0,n=64
         1 000572   200012 000100                    ADSC9   CVALUES,,AUTO            cn=0,n=64

      526     9616    3                END;

      527     9617    2             CALL DDR$BUMPC_D$( SIZE + 3 ) ALTRET(DERR);

   9617  1 000573   200004 470500                    LDP0    @SIZE,,AUTO
         1 000574   000000 235100                    LDA     0,,PR0
         1 000575   000003 035007                    ADLA    3,DL
         1 000576   200232 755100                    STA     DIG+1,,AUTO
         1 000577   200232 631500                    EPPR1   DIG+1,,AUTO
         1 000600   200233 451500                    STP1    DIG+2,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:90   
         1 000601   200233 630500                    EPPR0   DIG+2,,AUTO
         1 000602   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000603   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 000604   010563 702000 1                  TSX2    DERR

      528     9618    2             TEXT$ -> CHAR1 = '''';

   9618  1 000605   200217 470500                    LDP0    TEXT$,,AUTO
         1 000606   040100 100400                    MLR     fill='040'O
         1 000607   000011 000001 2                  ADSC9   9                        cn=0,n=1
         1 000610   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      529     9619    2             TEXT$ = PINCRC(TEXT$, 1);

   9619  1 000611   200217 236100                    LDQ     TEXT$,,AUTO
         1 000612   200000 036007                    ADLQ    65536,DL
         1 000613   200217 756100                    STQ     TEXT$,,AUTO

      530     9620    3             DO I = 0 TO SIZE - 1;

   9620  1 000614   200111 450100                    STZ     I,,AUTO
         1 000615   000634 710000 1                  TRA     s:9623+2

      531     9621    3                  TEXT$ -> CHAR1 = BITCHAR(VBITS(I));

   9621  1 000616   200111 235100                    LDA     I,,AUTO
         1 000617   003100 061505                    CSR     bolr='003'O
         1 000620   200012 000001                    BDSC    CVALUES,A,AUTO           by=0,bit=0,n=1
         1 000621   200232 000044                    BDSC    DIG+1,,AUTO              by=0,bit=0,n=36
         1 000622   200232 236100                    LDQ     DIG+1,,AUTO
         1 000623   200217 470500                    LDP0    TEXT$,,AUTO
         1 000624   040100 100406                    MLR     fill='040'O
         1 000625   000020 000001 0                  ADSC9   BITCHAR,Q                cn=0,n=1
         1 000626   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      532     9622    3                  TEXT$ = PINCRC(TEXT$, 1);

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:91   
   9622  1 000627   200217 236100                    LDQ     TEXT$,,AUTO
         1 000630   200000 036007                    ADLQ    65536,DL
         1 000631   200217 756100                    STQ     TEXT$,,AUTO

      533     9623    3                END;

   9623  1 000632   000001 035007                    ADLA    1,DL
         1 000633   200111 755100                    STA     I,,AUTO
         1 000634   200004 470500                    LDP0    @SIZE,,AUTO
         1 000635   200111 236100                    LDQ     I,,AUTO
         1 000636   000641 604000 1                  TMI     s:9624
         1 000637   000000 116100                    CMPQ    0,,PR0
         1 000640   000616 604000 1                  TMI     s:9621

      534     9624    2             TEXT$ -> CHAR2 = '''B';

   9624  1 000641   200217 471500                    LDP1    TEXT$,,AUTO
         1 000642   040100 100400                    MLR     fill='040'O
         1 000643   000036 000002 0                  ADSC9   HEXCHARS+5               cn=0,n=2
         1 000644   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2

      535     9625    2             RETURN;

   9625  1 000645   000000 702200 xent               TSX2  ! X66_ARET

      536     9626                                                /************************
      537     9627                                                 ******* CHAR_FMT *******
      538     9628                                                 ************************/
      539     9629    2          CASE( %CHAR_FMT );

      540     9630
      541     9631    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );

   9631  1 000646   000000 470400 xsym               LDP0    S_D$
         1 000647   006714 235100                    LDA     3532,,PR0
         1 000650   000003 115007                    CMPA    3,DL
         1 000651   000653 602005 1                  TNC     s:9631+5,AL
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:92   
         1 000652   001025 710000 1                  TRA     s:9657
         1 000653   001025 710000 1                  TRA     s:9657
         1 000654   000656 710000 1                  TRA     s:9633
         1 000655   000714 710000 1                  TRA     s:9640

      542     9632    3               CASE ( %HOST );

      543     9633    3                  NCHARS = SIZE / 9;

   9633  1 000656   200004 471500                    LDP1    @SIZE,,AUTO
         1 000657   100000 236100                    LDQ     0,,PR1
         1 000660   000011 506007                    DIV     9,DL
         1 000661   200055 756100                    STQ     NCHARS,,AUTO

      544     9634    3                  CALL DDR$BUMPC_D$(NCHARS +1) ALTRET(DERR);

   9634  1 000662   000001 036007                    ADLQ    1,DL
         1 000663   200232 756100                    STQ     DIG+1,,AUTO
         1 000664   200232 633500                    EPPR3   DIG+1,,AUTO
         1 000665   200233 453500                    STP3    DIG+2,,AUTO
         1 000666   200233 630500                    EPPR0   DIG+2,,AUTO
         1 000667   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000670   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 000671   010563 702000 1                  TSX2    DERR

      545     9635    3                  TEXT$ -> CHAR1 = '''';

   9635  1 000672   200217 470500                    LDP0    TEXT$,,AUTO
         1 000673   040100 100400                    MLR     fill='040'O
         1 000674   000011 000001 2                  ADSC9   9                        cn=0,n=1
         1 000675   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      546     9636    3                  PINCRC(TEXT$, 1) -> TEXTR = CVALUES;

   9636  1 000676   200055 720100                    LXL0    NCHARS,,AUTO
         1 000677   040140 100500                    MLR     fill='040'O
         1 000700   200012 000100                    ADSC9   CVALUES,,AUTO            cn=0,n=64
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:93   
         1 000701   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

      547     9637    3                  S_D.D$ -> CHAR1 = '''';

   9637  1 000702   000000 471400 xsym               LDP1    S_D$
         1 000703   100044 473500                    LDP3    36,,PR1
         1 000704   040100 100400                    MLR     fill='040'O
         1 000705   000011 000001 2                  ADSC9   9                        cn=0,n=1
         1 000706   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1

      548     9638    3                  CALL DDR$BUMPC_D$(1) ALTRET(DERR);

   9638  1 000707   000000 630400 2                  EPPR0   0
         1 000710   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000711   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 000712   010563 702000 1                  TSX2    DERR
         1 000713   001025 710000 1                  TRA     s:9657

      549     9639    3               CASE ( %L6 );

      550     9640    3                  TEXT$ -> CHAR1 = '''';

   9640  1 000714   200217 471500                    LDP1    TEXT$,,AUTO
         1 000715   040100 100400                    MLR     fill='040'O
         1 000716   000011 000001 2                  ADSC9   9                        cn=0,n=1
         1 000717   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

      551     9641    3                  CALL DDR$BUMPC_D$ ( 1 ) ALTRET ( DERR );

   9641  1 000720   000000 630400 2                  EPPR0   0
         1 000721   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000722   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 000723   010563 702000 1                  TSX2    DERR

      552     9642    3                  TEXT$ = S_D.D$;

   9642  1 000724   000000 470400 xsym               LDP0    S_D$
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:94   
         1 000725   000044 236100                    LDQ     36,,PR0
         1 000726   200217 756100                    STQ     TEXT$,,AUTO

      553     9643    3                  J = 0;

   9643  1 000727   200112 450100                    STZ     J,,AUTO

      554     9644    4                  DO I = 0 TO SIZE / 16 ;

   9644  1 000730   200111 450100                    STZ     I,,AUTO
         1 000731   000765 710000 1                  TRA     s:9649+3

      555     9645    4                       HOST_CHAR ( J ) = L6_CHAR.L ( I );

   9645  1 000732   200111 236100                    LDQ     I,,AUTO
         1 000733   000044 402007                    MPY     36,DL
         1 000734   200232 756100                    STQ     DIG+1,,AUTO
         1 000735   200112 236100                    LDQ     J,,AUTO
         1 000736   000011 402007                    MPY     9,DL
         1 000737   200232 235100                    LDA     DIG+1,,AUTO
         1 000740   003106 061505                    CSR     bolr='003'O
         1 000741   200012 430007                    BDSC    CVALUES,A,AUTO           by=2,bit=3,n=7
         1 000742   200012 000011                    BDSC    CVALUES,Q,AUTO           by=0,bit=0,n=9

      556     9646    4                       J = J + 1;

   9646  1 000743   200112 235100                    LDA     J,,AUTO
         1 000744   000001 035007                    ADLA    1,DL
         1 000745   200112 755100                    STA     J,,AUTO

      557     9647    4                       HOST_CHAR ( J ) = L6_CHAR.R ( I );

   9647  1 000746   200111 236100                    LDQ     I,,AUTO
         1 000747   000044 402007                    MPY     36,DL
         1 000750   200232 756100                    STQ     DIG+1,,AUTO
         1 000751   200112 236100                    LDQ     J,,AUTO
         1 000752   000011 402007                    MPY     9,DL
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:95   
         1 000753   200232 235100                    LDA     DIG+1,,AUTO
         1 000754   003106 061505                    CSR     bolr='003'O
         1 000755   200012 620007                    BDSC    CVALUES,A,AUTO           by=3,bit=2,n=7
         1 000756   200012 000011                    BDSC    CVALUES,Q,AUTO           by=0,bit=0,n=9

      558     9648    4                       J = J + 1;

   9648  1 000757   200112 235100                    LDA     J,,AUTO
         1 000760   000001 035007                    ADLA    1,DL
         1 000761   200112 755100                    STA     J,,AUTO

      559     9649    4                     END;

   9649  1 000762   200111 236100                    LDQ     I,,AUTO
         1 000763   000001 036007                    ADLQ    1,DL
         1 000764   200111 756100                    STQ     I,,AUTO
         1 000765   200004 470500                    LDP0    @SIZE,,AUTO
         1 000766   000000 236100                    LDQ     0,,PR0
         1 000767   000020 506007                    DIV     16,DL
         1 000770   000000 116003                    CMPQ    0,DU
         1 000771   000774 604000 1                  TMI     s:9650
         1 000772   200111 116100                    CMPQ    I,,AUTO
         1 000773   000732 603000 1                  TRC     s:9645

      560     9650    3                  NCHARS = SIZE / 8;

   9650  1 000774   000000 236100                    LDQ     0,,PR0
         1 000775   000010 506007                    DIV     8,DL
         1 000776   200055 756100                    STQ     NCHARS,,AUTO

      561     9651    3                  TEXT$ -> TEXTR = CVALUES;

   9651  1 000777   200217 471500                    LDP1    TEXT$,,AUTO
         1 001000   000000 620006                    EAX0    0,QL
         1 001001   040140 100500                    MLR     fill='040'O
         1 001002   200012 000100                    ADSC9   CVALUES,,AUTO            cn=0,n=64
         1 001003   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:96   

      562     9652    3                  CALL DDR$BUMPC_D$ ( NCHARS ) ALTRET ( DERR );

   9652  1 001004   200055 633500                    EPPR3   NCHARS,,AUTO
         1 001005   200232 453500                    STP3    DIG+1,,AUTO
         1 001006   200232 630500                    EPPR0   DIG+1,,AUTO
         1 001007   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001010   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 001011   010563 702000 1                  TSX2    DERR

      563     9653    3                  TEXT$ = S_D.D$;

   9653  1 001012   000000 470400 xsym               LDP0    S_D$
         1 001013   000044 236100                    LDQ     36,,PR0
         1 001014   200217 756100                    STQ     TEXT$,,AUTO

      564     9654    3                  TEXT$ -> CHAR1 = '''';

   9654  1 001015   200217 471500                    LDP1    TEXT$,,AUTO
         1 001016   040100 100400                    MLR     fill='040'O
         1 001017   000011 000001 2                  ADSC9   9                        cn=0,n=1
         1 001020   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

      565     9655    3                  CALL DDR$BUMPC_D$ ( 1 ) ALTRET ( DERR );

   9655  1 001021   000000 630400 2                  EPPR0   0
         1 001022   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001023   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 001024   010563 702000 1                  TSX2    DERR

      566     9656    3               END;

      567     9657    2             RETURN;

   9657  1 001025   000000 702200 xent               TSX2  ! X66_ARET

      568     9658                                                /****************************
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:97   
      569     9659                                                 ******* CMPXFORT_FMT *******
      570     9660                                                 ****************************/
      571     9661    2          CASE( %CMPXFORT_FMT );

      572     9662    2             CALL DDR$BUMPC_D$(1) ALTRET(DERR);

   9662  1 001026   000000 630400 2                  EPPR0   0
         1 001027   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001030   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 001031   010563 702000 1                  TSX2    DERR

      573     9663    2             TEXT$ -> CHAR1 = '(';

   9663  1 001032   200217 470500                    LDP0    TEXT$,,AUTO
         1 001033   040100 100400                    MLR     fill='040'O
         1 001034   000012 000001 2                  ADSC9   10                       cn=0,n=1
         1 001035   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      574     9664    2             TEXT$ = S_D.D$;

   9664  1 001036   000000 471400 xsym               LDP1    S_D$
         1 001037   100044 236100                    LDQ     36,,PR1
         1 001040   200217 756100                    STQ     TEXT$,,AUTO

      575     9665    2             IF SIZE = 72

   9665  1 001041   200004 470500                    LDP0    @SIZE,,AUTO
         1 001042   000000 235100                    LDA     0,,PR0
         1 001043   000110 115007                    CMPA    72,DL
         1 001044   001054 601000 1                  TNZ     s:9667

      576     9666    2             THEN CALL FLOAT(36, KVALUE(0)) ALTRET(BADLIB);

   9666  1 001045   200012 633500                    EPPR3   CVALUES,,AUTO
         1 001046   200230 453500                    STP3    @SIZE+1,,AUTO
         1 001047   000014 236000 2                  LDQ     12
         1 001050   200227 756100                    STQ     SAVE_EWSQ#+7,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:98   
         1 001051   011023 701000 1                  TSX1    FLOAT
         1 001052   003435 702000 1                  TSX2    BADLIB
         1 001053   001062 710000 1                  TRA     s:9668

      577     9667    2             ELSE CALL FLOAT(72, DKVALUE(0)) ALTRET(BADLIB);

   9667  1 001054   200012 633500                    EPPR3   CVALUES,,AUTO
         1 001055   200230 453500                    STP3    @SIZE+1,,AUTO
         1 001056   000016 236000 2                  LDQ     14
         1 001057   200227 756100                    STQ     SAVE_EWSQ#+7,,AUTO
         1 001060   011023 701000 1                  TSX1    FLOAT
         1 001061   003435 702000 1                  TSX2    BADLIB

      578     9668    2             TEXT$ = S_D.D$;

   9668  1 001062   000000 470400 xsym               LDP0    S_D$
         1 001063   000044 236100                    LDQ     36,,PR0
         1 001064   200217 756100                    STQ     TEXT$,,AUTO

      579     9669    2             CALL DDR$BUMPC_D$(2) ALTRET(DERR);

   9669  1 001065   000003 630400 2                  EPPR0   3
         1 001066   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001067   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 001070   010563 702000 1                  TSX2    DERR

      580     9670    2             TEXT$ -> CHAR2 = ', ';

   9670  1 001071   200217 470500                    LDP0    TEXT$,,AUTO
         1 001072   040100 100400                    MLR     fill='040'O
         1 001073   000037 000002 0                  ADSC9   HEXCHARS+6               cn=0,n=2
         1 001074   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2

      581     9671    2             TEXT$ = S_D.D$;

   9671  1 001075   000000 471400 xsym               LDP1    S_D$
         1 001076   100044 236100                    LDQ     36,,PR1
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:99   
         1 001077   200217 756100                    STQ     TEXT$,,AUTO

      582     9672    2             IF SIZE = 72

   9672  1 001100   200004 470500                    LDP0    @SIZE,,AUTO
         1 001101   000000 235100                    LDA     0,,PR0
         1 001102   000110 115007                    CMPA    72,DL
         1 001103   001113 601000 1                  TNZ     s:9674

      583     9673    2             THEN CALL FLOAT(36, KVALUE(1)) ALTRET(BADLIB);

   9673  1 001104   200013 633500                    EPPR3   CVALUES+1,,AUTO
         1 001105   200230 453500                    STP3    @SIZE+1,,AUTO
         1 001106   000014 236000 2                  LDQ     12
         1 001107   200227 756100                    STQ     SAVE_EWSQ#+7,,AUTO
         1 001110   011023 701000 1                  TSX1    FLOAT
         1 001111   003435 702000 1                  TSX2    BADLIB
         1 001112   001121 710000 1                  TRA     s:9675

      584     9674    2             ELSE CALL FLOAT(72, DKVALUE(1)) ALTRET(BADLIB);

   9674  1 001113   200014 633500                    EPPR3   CVALUES+2,,AUTO
         1 001114   200230 453500                    STP3    @SIZE+1,,AUTO
         1 001115   000016 236000 2                  LDQ     14
         1 001116   200227 756100                    STQ     SAVE_EWSQ#+7,,AUTO
         1 001117   011023 701000 1                  TSX1    FLOAT
         1 001120   003435 702000 1                  TSX2    BADLIB

      585     9675    2             TEXT$ = S_D.D$;

   9675  1 001121   000000 470400 xsym               LDP0    S_D$
         1 001122   000044 236100                    LDQ     36,,PR0
         1 001123   200217 756100                    STQ     TEXT$,,AUTO

      586     9676    2             CALL DDR$BUMPC_D$(1) ALTRET(DERR);

   9676  1 001124   000000 630400 2                  EPPR0   0
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:100  
         1 001125   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001126   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 001127   010563 702000 1                  TSX2    DERR

      587     9677    2             TEXT$ -> CHAR1 = ')';

   9677  1 001130   200217 470500                    LDP0    TEXT$,,AUTO
         1 001131   040100 100400                    MLR     fill='040'O
         1 001132   000017 000001 2                  ADSC9   15                       cn=0,n=1
         1 001133   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      588     9678    2             RETURN;

   9678  1 001134   000000 702200 xent               TSX2  ! X66_ARET

      589     9679                                                /*************************
      590     9680                                                 ******* COMP1_FMT *******
      591     9681                                                 *************************/
      592     9682    2          CASE( %COMP1_FMT );

      593     9683    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST THEN

   9683  1 001135   000000 470400 xsym               LDP0    S_D$
         1 001136   006714 235100                    LDA     3532,,PR0
         1 001137   000001 115007                    CMPA    1,DL
         1 001140   001152 601000 1                  TNZ     s:9688

      594     9684    3             DO;

      595     9685    3                  CALL DDK$COMP1 (VALUE.L);

   9685  1 001141   200012 631500                    EPPR1   CVALUES,,AUTO
         1 001142   200232 451500                    STP1    DIG+1,,AUTO
         1 001143   200232 630500                    EPPR0   DIG+1,,AUTO
         1 001144   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001145   000000 701000 xent               TSX1    DDK$COMP1
         1 001146   000000 011000                    NOP     0
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:101  

      596     9686    3                  SIZE = 36;

   9686  1 001147   000044 235007                    LDA     36,DL
         1 001150   200004 470500                    LDP0    @SIZE,,AUTO
         1 001151   000000 755100                    STA     0,,PR0

      597     9687    3                END;

      598     9688    2             FMT = %SINT_FMT;

   9688  1 001152   000003 235007                    LDA     3,DL
         1 001153   200052 755100                    STA     FMT,,AUTO

      599     9689    2             GOTO SINTFMT;

   9689  1 001154   006240 710000 1                  TRA     SINTFMT

      600     9690                                                /*************************
      601     9691                                                 ******* COMP2_FMT *******
      602     9692                                                 *************************/
      603     9693    2          CASE( %COMP2_FMT );

      604     9694    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST THEN

   9694  1 001155   000000 470400 xsym               LDP0    S_D$
         1 001156   006714 235100                    LDA     3532,,PR0
         1 001157   000001 115007                    CMPA    1,DL
         1 001160   001167 601000 1                  TNZ     s:9696

      605     9695    2                  CALL DDK$COMP2( VALUE.L );

   9695  1 001161   200012 631500                    EPPR1   CVALUES,,AUTO
         1 001162   200232 451500                    STP1    DIG+1,,AUTO
         1 001163   200232 630500                    EPPR0   DIG+1,,AUTO
         1 001164   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001165   000000 701000 xent               TSX1    DDK$COMP2
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:102  
         1 001166   000000 011000                    NOP     0

      606     9696    2             FMT = %SINT_FMT;

   9696  1 001167   000003 235007                    LDA     3,DL
         1 001170   200052 755100                    STA     FMT,,AUTO

      607     9697    2             GOTO SINTFMT;

   9697  1 001171   006240 710000 1                  TRA     SINTFMT

      608     9698                                                /************************
      609     9699                                                 ******* DESC_FMT *******
      610     9700                                                 ************************/
      611     9701    2          CASE( %DESC_FMT );

      612     9702
      613     9703    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );

   9703  1 001172   000000 470400 xsym               LDP0    S_D$
         1 001173   006714 235100                    LDA     3532,,PR0
         1 001174   000003 115007                    CMPA    3,DL
         1 001175   001177 602005 1                  TNC     s:9703+5,AL
         1 001176   010550 710000 1                  TRA     s:10845
         1 001177   003146 710000 1                  TRA     s:9949
         1 001200   001202 710000 1                  TRA     s:9707
         1 001201   002566 710000 1                  TRA     s:9899

      614     9704
      615     9705    3               CASE ( %HOST );

      616     9706
      617     9707    3                  IF SIZE ~= 72 AND SIZE ~= 36 THEN GOTO WRONG_SIZE;

   9707  1 001202   200004 471500                    LDP1    @SIZE,,AUTO
         1 001203   100000 235100                    LDA     0,,PR1
         1 001204   000110 115007                    CMPA    72,DL
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:103  
         1 001205   001210 600000 1                  TZE     s:9708
         1 001206   000044 115007                    CMPA    36,DL
         1 001207   010560 601000 1                  TNZ     WRONG_SIZE

      618     9708    3                  TEXT$ = S_D.D$;

   9708  1 001210   000044 236100                    LDQ     36,,PR0
         1 001211   200217 756100                    STQ     TEXT$,,AUTO

      619     9709    3                  TYPE = DVALUE.TYPE;

   9709  1 001212   200012 236100                    LDQ     CVALUES,,AUTO
         1 001213   000017 376007                    ANQ     15,DL
         1 001214   200117 756100                    STQ     TYPE,,AUTO

      620     9710    4                  DO CASE( TYPE );

   9710  1 001215   000014 116007                    CMPQ    12,DL
         1 001216   001220 602006 1                  TNC     s:9710+3,QL
         1 001217   002565 710000 1                  TRA     s:9894
         1 001220   001234 710000 1                  TRA     s:9712
         1 001221   001234 710000 1                  TRA     s:9712
         1 001222   001234 710000 1                  TRA     s:9712
         1 001223   001234 710000 1                  TRA     s:9712
         1 001224   001622 710000 1                  TRA     s:9778
         1 001225   002565 710000 1                  TRA     s:9894
         1 001226   001622 710000 1                  TRA     s:9778
         1 001227   002565 710000 1                  TRA     s:9894
         1 001230   002240 710000 1                  TRA     s:9849
         1 001231   002240 710000 1                  TRA     s:9849
         1 001232   002565 710000 1                  TRA     s:9894
         1 001233   002240 710000 1                  TRA     s:9849

      621     9711    4                    CASE( 0, 1, 2, 3 );

      622     9712    4                       IF SIZE = 72

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:104  
   9712  1 001234   100000 235100                    LDA     0,,PR1
         1 001235   000110 115007                    CMPA    72,DL
         1 001236   001331 601000 1                  TNZ     s:9731

      623     9713    5                       THEN DO;

      624     9714    5                            VAL = DVALUE.BASE.W;

   9714  1 001237   200013 236100                    LDQ     CVALUES+1,,AUTO
         1 001240   000002 772000                    QRL     2
         1 001241   200216 756100                    STQ     VAL,,AUTO

      625     9715    5                            CALL DDR$BINTXT(MYBUF$, VAL, %OCT_FMT, NCHARS);

   9715  1 001242   200055 633500                    EPPR3   NCHARS,,AUTO
         1 001243   200235 453500                    STP3    DIG+4,,AUTO
         1 001244   000000 236000 2                  LDQ     0
         1 001245   200234 756100                    STQ     DIG+3,,AUTO
         1 001246   200216 634500                    EPPR4   VAL,,AUTO
         1 001247   200233 454500                    STP4    DIG+2,,AUTO
         1 001250   200214 635500                    EPPR5   MYBUF$,,AUTO
         1 001251   200232 455500                    STP5    DIG+1,,AUTO
         1 001252   200232 630500                    EPPR0   DIG+1,,AUTO
         1 001253   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 001254   000000 701000 xent               TSX1    DDR$BINTXT
         1 001255   000000 011000                    NOP     0

      626     9716    5                            CALL DDR$BUMPC_D$(NCHARS) ALTRET(DERR);

   9716  1 001256   200055 630500                    EPPR0   NCHARS,,AUTO
         1 001257   200232 450500                    STP0    DIG+1,,AUTO
         1 001260   200232 630500                    EPPR0   DIG+1,,AUTO
         1 001261   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001262   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 001263   010563 702000 1                  TSX2    DERR

      627     9717    5                            TEXT$ -> TEXTR = MYBUF;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:105  

   9717  1 001264   200217 470500                    LDP0    TEXT$,,AUTO
         1 001265   200055 720100                    LXL0    NCHARS,,AUTO
         1 001266   040140 100500                    MLR     fill='040'O
         1 001267   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 001270   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      628     9718    5                            TEXT$ = S_D.D$;

   9718  1 001271   000000 471400 xsym               LDP1    S_D$
         1 001272   100044 236100                    LDQ     36,,PR1
         1 001273   200217 756100                    STQ     TEXT$,,AUTO

      629     9719    5                            VAL = DVALUE.BASE.C;

   9719  1 001274   200013 236100                    LDQ     CVALUES+1,,AUTO
         1 001275   000003 376007                    ANQ     3,DL
         1 001276   200216 756100                    STQ     VAL,,AUTO

      630     9720    5                            IF VAL > 0

   9720  1 001277   001316 604400 1                  TMOZ    s:9727

      631     9721    6                            THEN DO;

      632     9722    6                                 CALL DDR$BUMPC_D$(2) ALTRET(DERR);

   9722  1 001300   000003 630400 2                  EPPR0   3
         1 001301   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001302   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 001303   010563 702000 1                  TSX2    DERR

      633     9723    6                                 TEXT$ -> CHAR1 = '-';

   9723  1 001304   200217 470500                    LDP0    TEXT$,,AUTO
         1 001305   040100 100400                    MLR     fill='040'O
         1 001306   000002 000001 2                  ADSC9   2                        cn=0,n=1
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:106  
         1 001307   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      634     9724    6                                 CALL BINCHAR(PINCRC(TEXT$, 1) -> CHAR1, VAL);

   9724  1 001310   000100 301500                    BTD
         1 001311   200216 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         1 001312   000000 230001                    NDSC9   0,,PR0                   cn=1,s=nosgn,sf=0,n=1

      635     9725    6                                 TEXT$ = S_D.D$;

   9725  1 001313   000000 471400 xsym               LDP1    S_D$
         1 001314   100044 236100                    LDQ     36,,PR1
         1 001315   200217 756100                    STQ     TEXT$,,AUTO

      636     9726    6                               END;

      637     9727    5                            CALL DDR$BUMPC_D$(1) ALTRET(DERR);

   9727  1 001316   000000 630400 2                  EPPR0   0
         1 001317   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001320   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 001321   010563 702000 1                  TSX2    DERR

      638     9728    5                            TEXT$ -> CHAR1 = ',';

   9728  1 001322   200217 470500                    LDP0    TEXT$,,AUTO
         1 001323   040100 100400                    MLR     fill='040'O
         1 001324   000004 000001 2                  ADSC9   4                        cn=0,n=1
         1 001325   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      639     9729    5                            TEXT$ = S_D.D$;

   9729  1 001326   000000 471400 xsym               LDP1    S_D$
         1 001327   100044 236100                    LDQ     36,,PR1
         1 001330   200217 756100                    STQ     TEXT$,,AUTO

      640     9730    5                          END;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:107  

      641     9731    4                       CALL DDR$BUMPC_D$(3) ALTRET(DERR);

   9731  1 001331   000005 630400 2                  EPPR0   5
         1 001332   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001333   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 001334   010563 702000 1                  TSX2    DERR

      642     9732    4                       TEXT$ -> CHAR3 = 'BD=';

   9732  1 001335   200217 470500                    LDP0    TEXT$,,AUTO
         1 001336   040100 100400                    MLR     fill='040'O
         1 001337   000040 000003 0                  ADSC9   HEXCHARS+7               cn=0,n=3
         1 001340   000000 000003                    ADSC9   0,,PR0                   cn=0,n=3

      643     9733    4                       TEXT$ = S_D.D$;

   9733  1 001341   000000 471400 xsym               LDP1    S_D$
         1 001342   100044 236100                    LDQ     36,,PR1
         1 001343   200217 756100                    STQ     TEXT$,,AUTO

      644     9734    4                       IF TYPE = 2 OR TYPE = 3

   9734  1 001344   200117 235100                    LDA     TYPE,,AUTO
         1 001345   000002 115007                    CMPA    2,DL
         1 001346   001354 600000 1                  TZE     s:9737
         1 001347   000003 115007                    CMPA    3,DL
         1 001350   001354 600000 1                  TZE     s:9737
         1 001351   200012 236100                    LDQ     CVALUES,,AUTO
         1 001352   000400 316007                    CANQ    256,DL
         1 001353   001432 600000 1                  TZE     s:9747

      645     9735    4                         OR DVALUE.FWR.FLGS.NOTEMPTY
      646     9736    5                       THEN DO;

      647     9737    5                            VAL = DVALUE.BOUND.W;

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:108  
   9737  1 001354   200012 236100                    LDQ     CVALUES,,AUTO
         1 001355   000022 772000                    QRL     18
         1 001356   200216 756100                    STQ     VAL,,AUTO

      648     9738    5                            CALL DDR$BINTXT(MYBUF$, VAL, %OCT_FMT, NCHARS);

   9738  1 001357   200055 630500                    EPPR0   NCHARS,,AUTO
         1 001360   200235 450500                    STP0    DIG+4,,AUTO
         1 001361   000000 236000 2                  LDQ     0
         1 001362   200234 756100                    STQ     DIG+3,,AUTO
         1 001363   200216 633500                    EPPR3   VAL,,AUTO
         1 001364   200233 453500                    STP3    DIG+2,,AUTO
         1 001365   200214 634500                    EPPR4   MYBUF$,,AUTO
         1 001366   200232 454500                    STP4    DIG+1,,AUTO
         1 001367   200232 630500                    EPPR0   DIG+1,,AUTO
         1 001370   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 001371   000000 701000 xent               TSX1    DDR$BINTXT
         1 001372   000000 011000                    NOP     0

      649     9739    5                            CALL DDR$BUMPC_D$(NCHARS+2) ALTRET(DERR);

   9739  1 001373   200055 235100                    LDA     NCHARS,,AUTO
         1 001374   000002 035007                    ADLA    2,DL
         1 001375   200232 755100                    STA     DIG+1,,AUTO
         1 001376   200232 630500                    EPPR0   DIG+1,,AUTO
         1 001377   200233 450500                    STP0    DIG+2,,AUTO
         1 001400   200233 630500                    EPPR0   DIG+2,,AUTO
         1 001401   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001402   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 001403   010563 702000 1                  TSX2    DERR

      650     9740    5                            TEXT$ -> TEXTR = MYBUF;

   9740  1 001404   200217 470500                    LDP0    TEXT$,,AUTO
         1 001405   200055 720100                    LXL0    NCHARS,,AUTO
         1 001406   040140 100500                    MLR     fill='040'O
         1 001407   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:109  
         1 001410   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      651     9741    5                            TEXT$ = PINCRC(TEXT$, NCHARS + 1);

   9741  1 001411   200055 236100                    LDQ     NCHARS,,AUTO
         1 001412   000020 736000                    QLS     16
         1 001413   200000 036007                    ADLQ    65536,DL
         1 001414   200217 036100                    ADLQ    TEXT$,,AUTO
         1 001415   200217 756100                    STQ     TEXT$,,AUTO

      652     9742    5                            VAL = DVALUE.BOUND.C;

   9742  1 001416   200012 236100                    LDQ     CVALUES,,AUTO
         1 001417   000020 772000                    QRL     16
         1 001420   000003 376007                    ANQ     3,DL
         1 001421   200216 756100                    STQ     VAL,,AUTO

      653     9743    5                            PINCRC(TEXT$, -1) -> CHAR1 = '-';

   9743  1 001422   200217 470500                    LDP0    TEXT$,,AUTO
         1 001423   040100 100400                    MLR     fill='040'O
         1 001424   000002 000001 2                  ADSC9   2                        cn=0,n=1
         1 001425   077777 600001                    ADSC9   -1,,PR0                  cn=3,n=1

      654     9744    5                            CALL BINCHAR(TEXT$ -> CHAR1, VAL);

   9744  1 001426   000100 301500                    BTD
         1 001427   200216 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         1 001430   000000 030001                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=1

      655     9745    5                          END;

   9745  1 001431   001442 710000 1                  TRA     s:9750

      656     9746    5                       ELSE DO;

      657     9747    5                            CALL DDR$BUMPC_D$(5) ALTRET(DERR);
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:110  

   9747  1 001432   000001 630400 2                  EPPR0   1
         1 001433   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001434   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 001435   010563 702000 1                  TSX2    DERR

      658     9748    5                            TEXT$ -> CHAR5 = 'EMPTY';

   9748  1 001436   200217 470500                    LDP0    TEXT$,,AUTO
         1 001437   040100 100400                    MLR     fill='040'O
         1 001440   000041 000005 0                  ADSC9   HEXCHARS+8               cn=0,n=5
         1 001441   000000 000005                    ADSC9   0,,PR0                   cn=0,n=5

      659     9749    5                          END;

      660     9750    4                       TEXT$ = S_D.D$;

   9750  1 001442   000000 471400 xsym               LDP1    S_D$
         1 001443   100044 236100                    LDQ     36,,PR1
         1 001444   200217 756100                    STQ     TEXT$,,AUTO

      661     9751    5                       DO CASE( TYPE );

   9751  1 001445   200117 235100                    LDA     TYPE,,AUTO
         1 001446   000004 115007                    CMPA    4,DL
         1 001447   001451 602005 1                  TNC     s:9751+4,AL
         1 001450   001505 710000 1                  TRA     s:9761
         1 001451   001455 710000 1                  TRA     s:9753
         1 001452   001455 710000 1                  TRA     s:9753
         1 001453   001471 710000 1                  TRA     s:9757
         1 001454   001471 710000 1                  TRA     s:9757

      662     9752    5                         CASE( 0, 1 );

      663     9753    5                            VAL = DVALUE.FWR.FLAGS;

   9753  1 001455   200012 236100                    LDQ     CVALUES,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:111  
         1 001456   000007 772000                    QRL     7
         1 001457   000777 376007                    ANQ     511,DL
         1 001460   200216 756100                    STQ     VAL,,AUTO

      664     9754    5                            VALW = DVALUE.FWR.WSR;

   9754  1 001461   200012 236100                    LDQ     CVALUES,,AUTO
         1 001462   000004 772000                    QRL     4
         1 001463   000007 376007                    ANQ     7,DL
         1 001464   200114 756100                    STQ     VALW,,AUTO

      665     9755    5                            VALWC = ',WSR=';

   9755  1 001465   040100 100400                    MLR     fill='040'O
         1 001466   000043 000005 0                  ADSC9   HEXCHARS+10              cn=0,n=5
         1 001467   200115 000005                    ADSC9   VALWC,,AUTO              cn=0,n=5
         1 001470   001505 710000 1                  TRA     s:9761

      666     9756    5                         CASE( 2, 3 );

      667     9757    5                            VAL = DVALUE.FWQ.FLAGS * 64 + BITBIN('77'O);

   9757  1 001471   200012 236100                    LDQ     CVALUES,,AUTO
         1 001472   000007 772000                    QRL     7
         1 001473   000700 376007                    ANQ     448,DL
         1 001474   000077 036007                    ADLQ    63,DL
         1 001475   200216 756100                    STQ     VAL,,AUTO

      668     9758    5                            VALW = DVALUE.FWQ.WSQ;

   9758  1 001476   200012 236100                    LDQ     CVALUES,,AUTO
         1 001477   000004 772000                    QRL     4
         1 001500   000777 376007                    ANQ     511,DL
         1 001501   200114 756100                    STQ     VALW,,AUTO

      669     9759    5                            VALWC = ',WSQ=';

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:112  
   9759  1 001502   040100 100400                    MLR     fill='040'O
         1 001503   000045 000005 0                  ADSC9   HEXCHARS+12              cn=0,n=5
         1 001504   200115 000005                    ADSC9   VALWC,,AUTO              cn=0,n=5

      670     9760    5                         END;              /* DO CASE( TYPE ) */

      671     9761    4                       CALL DDR$BUMPC_D$(13) ALTRET(DERR);

   9761  1 001505   000010 630400 2                  EPPR0   8
         1 001506   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001507   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 001510   010563 702000 1                  TSX2    DERR

      672     9762    4                       TEXT$ -> CHAR5 = ',FL=.';

   9762  1 001511   200217 470500                    LDP0    TEXT$,,AUTO
         1 001512   040100 100400                    MLR     fill='040'O
         1 001513   000047 000005 0                  ADSC9   HEXCHARS+14              cn=0,n=5
         1 001514   000000 000005                    ADSC9   0,,PR0                   cn=0,n=5

      673     9763    4                       CALL DDR$BINOCT(MYBUF, VAL);

   9763  1 001515   200216 631500                    EPPR1   VAL,,AUTO
         1 001516   200233 451500                    STP1    DIG+2,,AUTO
         1 001517   200134 633500                    EPPR3   MYBUF,,AUTO
         1 001520   200232 453500                    STP3    DIG+1,,AUTO
         1 001521   200232 630500                    EPPR0   DIG+1,,AUTO
         1 001522   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001523   000000 701000 xent               TSX1    DDR$BINOCT
         1 001524   000000 011000                    NOP     0

      674     9764    4                       TEXT$ = PINCRC(TEXT$, 5);

   9764  1 001525   200217 236100                    LDQ     TEXT$,,AUTO
         1 001526   000020 036000 2                  ADLQ    16
         1 001527   200217 756100                    STQ     TEXT$,,AUTO

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:113  
      675     9765    4                       TEXT$ -> CHAR3 = PINCRC(MYBUF$, 9) -> CHAR3;

   9765  1 001530   200214 470500                    LDP0    MYBUF$,,AUTO
         1 001531   200217 471500                    LDP1    TEXT$,,AUTO
         1 001532   040100 100500                    MLR     fill='040'O
         1 001533   000002 200003                    ADSC9   2,,PR0                   cn=1,n=3
         1 001534   100000 000003                    ADSC9   0,,PR1                   cn=0,n=3

      676     9766    4                       TEXT$ = PINCRC(TEXT$, 3);

   9766  1 001535   600000 036007                    ADLQ    -65536,DL
         1 001536   200217 756100                    STQ     TEXT$,,AUTO

      677     9767    4                       TEXT$ -> CHAR5 = VALWC;

   9767  1 001537   200217 470500                    LDP0    TEXT$,,AUTO
         1 001540   040100 100500                    MLR     fill='040'O
         1 001541   200115 000005                    ADSC9   VALWC,,AUTO              cn=0,n=5
         1 001542   000000 000005                    ADSC9   0,,PR0                   cn=0,n=5

      678     9768    4                       TEXT$ = S_D.D$;

   9768  1 001543   000000 471400 xsym               LDP1    S_D$
         1 001544   100044 236100                    LDQ     36,,PR1
         1 001545   200217 756100                    STQ     TEXT$,,AUTO

      679     9769    4                       CALL DDR$BINTXT(MYBUF$, VALW, %UINT_FMT, NCHARS);

   9769  1 001546   200055 630500                    EPPR0   NCHARS,,AUTO
         1 001547   200235 450500                    STP0    DIG+4,,AUTO
         1 001550   000003 236000 2                  LDQ     3
         1 001551   200234 756100                    STQ     DIG+3,,AUTO
         1 001552   200114 633500                    EPPR3   VALW,,AUTO
         1 001553   200233 453500                    STP3    DIG+2,,AUTO
         1 001554   200214 634500                    EPPR4   MYBUF$,,AUTO
         1 001555   200232 454500                    STP4    DIG+1,,AUTO
         1 001556   200232 630500                    EPPR0   DIG+1,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:114  
         1 001557   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 001560   000000 701000 xent               TSX1    DDR$BINTXT
         1 001561   000000 011000                    NOP     0

      680     9770    4                       CALL DDR$BUMPC_D$(NCHARS + 5) ALTRET(DERR);

   9770  1 001562   200055 235100                    LDA     NCHARS,,AUTO
         1 001563   000005 035007                    ADLA    5,DL
         1 001564   200232 755100                    STA     DIG+1,,AUTO
         1 001565   200232 630500                    EPPR0   DIG+1,,AUTO
         1 001566   200233 450500                    STP0    DIG+2,,AUTO
         1 001567   200233 630500                    EPPR0   DIG+2,,AUTO
         1 001570   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001571   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 001572   010563 702000 1                  TSX2    DERR

      681     9771    4                       TEXT$ -> TEXTR = MYBUF;

   9771  1 001573   200217 470500                    LDP0    TEXT$,,AUTO
         1 001574   200055 720100                    LXL0    NCHARS,,AUTO
         1 001575   040140 100500                    MLR     fill='040'O
         1 001576   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 001577   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      682     9772    4                       TEXT$ = PINCRC(TEXT$, NCHARS);

   9772  1 001600   200055 236100                    LDQ     NCHARS,,AUTO
         1 001601   000020 736000                    QLS     16
         1 001602   200217 036100                    ADLQ    TEXT$,,AUTO
         1 001603   200217 756100                    STQ     TEXT$,,AUTO

      683     9773    4                       TEXT$ -> CHAR4 = ',TY=';

   9773  1 001604   200217 470500                    LDP0    TEXT$,,AUTO
         1 001605   040100 100400                    MLR     fill='040'O
         1 001606   000051 000004 0                  ADSC9   HEXCHARS+16              cn=0,n=4
         1 001607   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:115  

      684     9774    4                       TEXT$ = PINCRC(TEXT$, 4);

   9774  1 001610   000001 036003                    ADLQ    1,DU
         1 001611   200217 756100                    STQ     TEXT$,,AUTO

      685     9775    4                       CALL BINCHAR(TEXT$ -> CHAR1, TYPE);

   9775  1 001612   200117 235100                    LDA     TYPE,,AUTO
         1 001613   000044 773000                    LRL     36
         1 001614   200232 757100                    STAQ    DIG+1,,AUTO
         1 001615   200217 470500                    LDP0    TEXT$,,AUTO
         1 001616   000100 301500                    BTD
         1 001617   200232 000010                    NDSC9   DIG+1,,AUTO              cn=0,s=lsgnf,sf=0,n=8
         1 001620   000000 030001                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=1

      686     9776    4                       RETURN;

   9776  1 001621   000000 702200 xent               TSX2  ! X66_ARET

      687     9777    4                    CASE( 4, 6);

      688     9778    4                       VAL = DVALUE.SUPER.BASE;

   9778  1 001622   200012 236100                    LDQ     CVALUES,,AUTO
         1 001623   000032 772000                    QRL     26
         1 001624   200216 756100                    STQ     VAL,,AUTO

      689     9779    4                       CALL DDR$BINTXT(MYBUF$, VAL, %OCT_FMT, NCHARS);

   9779  1 001625   200055 633500                    EPPR3   NCHARS,,AUTO
         1 001626   200235 453500                    STP3    DIG+4,,AUTO
         1 001627   000000 236000 2                  LDQ     0
         1 001630   200234 756100                    STQ     DIG+3,,AUTO
         1 001631   200216 634500                    EPPR4   VAL,,AUTO
         1 001632   200233 454500                    STP4    DIG+2,,AUTO
         1 001633   200214 635500                    EPPR5   MYBUF$,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:116  
         1 001634   200232 455500                    STP5    DIG+1,,AUTO
         1 001635   200232 630500                    EPPR0   DIG+1,,AUTO
         1 001636   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 001637   000000 701000 xent               TSX1    DDR$BINTXT
         1 001640   000000 011000                    NOP     0

      690     9780    4                       CALL DDR$BUMPC_D$(NCHARS) ALTRET(DERR);

   9780  1 001641   200055 630500                    EPPR0   NCHARS,,AUTO
         1 001642   200232 450500                    STP0    DIG+1,,AUTO
         1 001643   200232 630500                    EPPR0   DIG+1,,AUTO
         1 001644   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001645   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 001646   010563 702000 1                  TSX2    DERR

      691     9781    4                       TEXT$ -> TEXTR = MYBUF;

   9781  1 001647   200217 470500                    LDP0    TEXT$,,AUTO
         1 001650   200055 720100                    LXL0    NCHARS,,AUTO
         1 001651   040140 100500                    MLR     fill='040'O
         1 001652   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 001653   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      692     9782    4                       TEXT$ = S_D.D$;

   9782  1 001654   000000 471400 xsym               LDP1    S_D$
         1 001655   100044 236100                    LDQ     36,,PR1
         1 001656   200217 756100                    STQ     TEXT$,,AUTO

      693     9783    4                       CALL DDR$BUMPC_D$(1) ALTRET(DERR);

   9783  1 001657   000000 630400 2                  EPPR0   0
         1 001660   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001661   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 001662   010563 702000 1                  TSX2    DERR

      694     9784    4                       TEXT$ -> CHAR1 = ',';
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:117  

   9784  1 001663   200217 470500                    LDP0    TEXT$,,AUTO
         1 001664   040100 100400                    MLR     fill='040'O
         1 001665   000004 000001 2                  ADSC9   4                        cn=0,n=1
         1 001666   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      695     9785    4                       TEXT$ = S_D.D$;

   9785  1 001667   000000 471400 xsym               LDP1    S_D$
         1 001670   100044 236100                    LDQ     36,,PR1
         1 001671   200217 756100                    STQ     TEXT$,,AUTO

      696     9786    4                       CALL DDR$BUMPC_D$(3) ALTRET(DERR);

   9786  1 001672   000005 630400 2                  EPPR0   5
         1 001673   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001674   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 001675   010563 702000 1                  TSX2    DERR

      697     9787    4                       TEXT$ -> CHAR3 = 'BD=';

   9787  1 001676   200217 470500                    LDP0    TEXT$,,AUTO
         1 001677   040100 100400                    MLR     fill='040'O
         1 001700   000040 000003 0                  ADSC9   HEXCHARS+7               cn=0,n=3
         1 001701   000000 000003                    ADSC9   0,,PR0                   cn=0,n=3

      698     9788    4                       TEXT$ = S_D.D$;

   9788  1 001702   000000 471400 xsym               LDP1    S_D$
         1 001703   100044 236100                    LDQ     36,,PR1
         1 001704   200217 756100                    STQ     TEXT$,,AUTO

      699     9789    4                       IF TYPE = 6

   9789  1 001705   200117 235100                    LDA     TYPE,,AUTO
         1 001706   000006 115007                    CMPA    6,DL
         1 001707   001713 600000 1                  TZE     s:9792
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:118  
         1 001710   200012 236100                    LDQ     CVALUES,,AUTO
         1 001711   000400 316007                    CANQ    256,DL
         1 001712   001747 600000 1                  TZE     s:9798

      700     9790    4                         OR DVALUE.FWR.FLGS.NOTEMPTY
      701     9791    5                       THEN DO;

      702     9792    5                            VAL = DVALUE.SUPER.BOUND;

   9792  1 001713   200012 236100                    LDQ     CVALUES,,AUTO
         1 001714   000020 772000                    QRL     16
         1 001715   001777 376007                    ANQ     1023,DL
         1 001716   200216 756100                    STQ     VAL,,AUTO

      703     9793    5                            CALL DDR$BINTXT(MYBUF$, VAL, %OCT_FMT, NCHARS);

   9793  1 001717   200055 630500                    EPPR0   NCHARS,,AUTO
         1 001720   200235 450500                    STP0    DIG+4,,AUTO
         1 001721   000000 236000 2                  LDQ     0
         1 001722   200234 756100                    STQ     DIG+3,,AUTO
         1 001723   200216 633500                    EPPR3   VAL,,AUTO
         1 001724   200233 453500                    STP3    DIG+2,,AUTO
         1 001725   200214 634500                    EPPR4   MYBUF$,,AUTO
         1 001726   200232 454500                    STP4    DIG+1,,AUTO
         1 001727   200232 630500                    EPPR0   DIG+1,,AUTO
         1 001730   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 001731   000000 701000 xent               TSX1    DDR$BINTXT
         1 001732   000000 011000                    NOP     0

      704     9794    5                            CALL DDR$BUMPC_D$(NCHARS) ALTRET(DERR);

   9794  1 001733   200055 630500                    EPPR0   NCHARS,,AUTO
         1 001734   200232 450500                    STP0    DIG+1,,AUTO
         1 001735   200232 630500                    EPPR0   DIG+1,,AUTO
         1 001736   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001737   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 001740   010563 702000 1                  TSX2    DERR
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:119  

      705     9795    5                            TEXT$ -> TEXTR = MYBUF;

   9795  1 001741   200217 470500                    LDP0    TEXT$,,AUTO
         1 001742   200055 720100                    LXL0    NCHARS,,AUTO
         1 001743   040140 100500                    MLR     fill='040'O
         1 001744   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 001745   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      706     9796    5                          END;

   9796  1 001746   001757 710000 1                  TRA     s:9801

      707     9797    5                       ELSE DO;

      708     9798    5                            CALL DDR$BUMPC_D$(5) ALTRET(DERR);

   9798  1 001747   000001 630400 2                  EPPR0   1
         1 001750   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001751   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 001752   010563 702000 1                  TSX2    DERR

      709     9799    5                            TEXT$ -> CHAR5 = 'EMPTY';

   9799  1 001753   200217 470500                    LDP0    TEXT$,,AUTO
         1 001754   040100 100400                    MLR     fill='040'O
         1 001755   000041 000005 0                  ADSC9   HEXCHARS+8               cn=0,n=5
         1 001756   000000 000005                    ADSC9   0,,PR0                   cn=0,n=5

      710     9800    5                          END;

      711     9801    4                       TEXT$ = S_D.D$;

   9801  1 001757   000000 471400 xsym               LDP1    S_D$
         1 001760   100044 236100                    LDQ     36,,PR1
         1 001761   200217 756100                    STQ     TEXT$,,AUTO

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:120  
      712     9802    5                       DO CASE( TYPE );

   9802  1 001762   200117 235100                    LDA     TYPE,,AUTO
         1 001763   000004 135007                    SBLA    4,DL
         1 001764   000003 115007                    CMPA    3,DL
         1 001765   001767 602005 1                  TNC     s:9802+5,AL
         1 001766   002022 710000 1                  TRA     s:9812
         1 001767   001772 710000 1                  TRA     s:9804
         1 001770   002022 710000 1                  TRA     s:9812
         1 001771   002006 710000 1                  TRA     s:9808

      713     9803    5                         CASE( 4 );

      714     9804    5                            VAL = DVALUE.FWR.FLAGS;

   9804  1 001772   200012 236100                    LDQ     CVALUES,,AUTO
         1 001773   000007 772000                    QRL     7
         1 001774   000777 376007                    ANQ     511,DL
         1 001775   200216 756100                    STQ     VAL,,AUTO

      715     9805    5                            VALW = DVALUE.FWR.WSR;

   9805  1 001776   200012 236100                    LDQ     CVALUES,,AUTO
         1 001777   000004 772000                    QRL     4
         1 002000   000007 376007                    ANQ     7,DL
         1 002001   200114 756100                    STQ     VALW,,AUTO

      716     9806    5                            VALWC = ',WSR=';

   9806  1 002002   040100 100400                    MLR     fill='040'O
         1 002003   000043 000005 0                  ADSC9   HEXCHARS+10              cn=0,n=5
         1 002004   200115 000005                    ADSC9   VALWC,,AUTO              cn=0,n=5
         1 002005   002022 710000 1                  TRA     s:9812

      717     9807    5                         CASE( 6 );

      718     9808    5                            VAL = DVALUE.FWQ.FLAGS * 64 + BITBIN('77'O);
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:121  

   9808  1 002006   200012 236100                    LDQ     CVALUES,,AUTO
         1 002007   000007 772000                    QRL     7
         1 002010   000700 376007                    ANQ     448,DL
         1 002011   000077 036007                    ADLQ    63,DL
         1 002012   200216 756100                    STQ     VAL,,AUTO

      719     9809    5                            VALW = DVALUE.FWQ.WSQ;

   9809  1 002013   200012 236100                    LDQ     CVALUES,,AUTO
         1 002014   000004 772000                    QRL     4
         1 002015   000777 376007                    ANQ     511,DL
         1 002016   200114 756100                    STQ     VALW,,AUTO

      720     9810    5                            VALWC = ',WSQ=';

   9810  1 002017   040100 100400                    MLR     fill='040'O
         1 002020   000045 000005 0                  ADSC9   HEXCHARS+12              cn=0,n=5
         1 002021   200115 000005                    ADSC9   VALWC,,AUTO              cn=0,n=5

      721     9811    5                         END;              /* DO CASE( TYPE ) */

      722     9812    4                       CALL DDR$BUMPC_D$(13) ALTRET(DERR);

   9812  1 002022   000010 630400 2                  EPPR0   8
         1 002023   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002024   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 002025   010563 702000 1                  TSX2    DERR

      723     9813    4                       TEXT$ -> CHAR5 = ',FL=.';

   9813  1 002026   200217 470500                    LDP0    TEXT$,,AUTO
         1 002027   040100 100400                    MLR     fill='040'O
         1 002030   000047 000005 0                  ADSC9   HEXCHARS+14              cn=0,n=5
         1 002031   000000 000005                    ADSC9   0,,PR0                   cn=0,n=5

      724     9814    4                       CALL DDR$BINOCT(MYBUF, VAL);
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:122  

   9814  1 002032   200216 631500                    EPPR1   VAL,,AUTO
         1 002033   200233 451500                    STP1    DIG+2,,AUTO
         1 002034   200134 633500                    EPPR3   MYBUF,,AUTO
         1 002035   200232 453500                    STP3    DIG+1,,AUTO
         1 002036   200232 630500                    EPPR0   DIG+1,,AUTO
         1 002037   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002040   000000 701000 xent               TSX1    DDR$BINOCT
         1 002041   000000 011000                    NOP     0

      725     9815    4                       TEXT$ = PINCRC(TEXT$, 5);

   9815  1 002042   200217 236100                    LDQ     TEXT$,,AUTO
         1 002043   000020 036000 2                  ADLQ    16
         1 002044   200217 756100                    STQ     TEXT$,,AUTO

      726     9816    4                       TEXT$ -> CHAR3 = PINCRC(MYBUF$, 9) -> CHAR3;

   9816  1 002045   200214 470500                    LDP0    MYBUF$,,AUTO
         1 002046   200217 471500                    LDP1    TEXT$,,AUTO
         1 002047   040100 100500                    MLR     fill='040'O
         1 002050   000002 200003                    ADSC9   2,,PR0                   cn=1,n=3
         1 002051   100000 000003                    ADSC9   0,,PR1                   cn=0,n=3

      727     9817    4                       TEXT$ = PINCRC(TEXT$, 3);

   9817  1 002052   600000 036007                    ADLQ    -65536,DL
         1 002053   200217 756100                    STQ     TEXT$,,AUTO

      728     9818    4                       TEXT$ -> CHAR5 = VALWC;

   9818  1 002054   200217 470500                    LDP0    TEXT$,,AUTO
         1 002055   040100 100500                    MLR     fill='040'O
         1 002056   200115 000005                    ADSC9   VALWC,,AUTO              cn=0,n=5
         1 002057   000000 000005                    ADSC9   0,,PR0                   cn=0,n=5

      729     9819    4                       TEXT$ = S_D.D$;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:123  

   9819  1 002060   000000 471400 xsym               LDP1    S_D$
         1 002061   100044 236100                    LDQ     36,,PR1
         1 002062   200217 756100                    STQ     TEXT$,,AUTO

      730     9820    4                       CALL DDR$BINTXT(MYBUF$, VALW, %UINT_FMT, NCHARS);

   9820  1 002063   200055 630500                    EPPR0   NCHARS,,AUTO
         1 002064   200235 450500                    STP0    DIG+4,,AUTO
         1 002065   000003 236000 2                  LDQ     3
         1 002066   200234 756100                    STQ     DIG+3,,AUTO
         1 002067   200114 633500                    EPPR3   VALW,,AUTO
         1 002070   200233 453500                    STP3    DIG+2,,AUTO
         1 002071   200214 634500                    EPPR4   MYBUF$,,AUTO
         1 002072   200232 454500                    STP4    DIG+1,,AUTO
         1 002073   200232 630500                    EPPR0   DIG+1,,AUTO
         1 002074   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 002075   000000 701000 xent               TSX1    DDR$BINTXT
         1 002076   000000 011000                    NOP     0

      731     9821    4                       CALL DDR$BUMPC_D$(NCHARS + 5) ALTRET(DERR);

   9821  1 002077   200055 235100                    LDA     NCHARS,,AUTO
         1 002100   000005 035007                    ADLA    5,DL
         1 002101   200232 755100                    STA     DIG+1,,AUTO
         1 002102   200232 630500                    EPPR0   DIG+1,,AUTO
         1 002103   200233 450500                    STP0    DIG+2,,AUTO
         1 002104   200233 630500                    EPPR0   DIG+2,,AUTO
         1 002105   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002106   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 002107   010563 702000 1                  TSX2    DERR

      732     9822    4                       TEXT$ -> TEXTR = MYBUF;

   9822  1 002110   200217 470500                    LDP0    TEXT$,,AUTO
         1 002111   200055 720100                    LXL0    NCHARS,,AUTO
         1 002112   040140 100500                    MLR     fill='040'O
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:124  
         1 002113   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 002114   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      733     9823    4                       TEXT$ = PINCRC(TEXT$, NCHARS);

   9823  1 002115   200055 236100                    LDQ     NCHARS,,AUTO
         1 002116   000020 736000                    QLS     16
         1 002117   200217 036100                    ADLQ    TEXT$,,AUTO
         1 002120   200217 756100                    STQ     TEXT$,,AUTO

      734     9824    4                       TEXT$ -> CHAR4 = ',TY=';

   9824  1 002121   200217 470500                    LDP0    TEXT$,,AUTO
         1 002122   040100 100400                    MLR     fill='040'O
         1 002123   000051 000004 0                  ADSC9   HEXCHARS+16              cn=0,n=4
         1 002124   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4

      735     9825    4                       TEXT$ = PINCRC(TEXT$, 4);

   9825  1 002125   000001 036003                    ADLQ    1,DU
         1 002126   200217 756100                    STQ     TEXT$,,AUTO

      736     9826    4                       CALL BINCHAR(TEXT$ -> CHAR1, TYPE);

   9826  1 002127   200117 235100                    LDA     TYPE,,AUTO
         1 002130   000044 773000                    LRL     36
         1 002131   200232 757100                    STAQ    DIG+1,,AUTO
         1 002132   200217 470500                    LDP0    TEXT$,,AUTO
         1 002133   000100 301500                    BTD
         1 002134   200232 000010                    NDSC9   DIG+1,,AUTO              cn=0,s=lsgnf,sf=0,n=8
         1 002135   000000 030001                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=1

      737     9827    4                       TEXT$ = S_D.D$;

   9827  1 002136   000000 471400 xsym               LDP1    S_D$
         1 002137   100044 236100                    LDQ     36,,PR1
         1 002140   200217 756100                    STQ     TEXT$,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:125  

      738     9828    4                       IF SIZE = 72

   9828  1 002141   200004 470500                    LDP0    @SIZE,,AUTO
         1 002142   000000 235100                    LDA     0,,PR0
         1 002143   000110 115007                    CMPA    72,DL
         1 002144   002237 601000 1                  TNZ     s:9847

      739     9829    5                       THEN DO;

      740     9830    5                            CALL DDR$BUMPC_D$(3) ALTRET(DERR);

   9830  1 002145   000005 630400 2                  EPPR0   5
         1 002146   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002147   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 002150   010563 702000 1                  TSX2    DERR

      741     9831    5                            TEXT$ -> CHAR3 = ',L=';

   9831  1 002151   200217 470500                    LDP0    TEXT$,,AUTO
         1 002152   040100 100400                    MLR     fill='040'O
         1 002153   000052 000003 0                  ADSC9   HEXCHARS+17              cn=0,n=3
         1 002154   000000 000003                    ADSC9   0,,PR0                   cn=0,n=3

      742     9832    5                            TEXT$ = S_D.D$;

   9832  1 002155   000000 471400 xsym               LDP1    S_D$
         1 002156   100044 236100                    LDQ     36,,PR1
         1 002157   200217 756100                    STQ     TEXT$,,AUTO

      743     9833    5                            VAL = DVALUE.BASE.W;

   9833  1 002160   200013 236100                    LDQ     CVALUES+1,,AUTO
         1 002161   000002 772000                    QRL     2
         1 002162   200216 756100                    STQ     VAL,,AUTO

      744     9834    5                            CALL DDR$BINTXT(MYBUF$, VAL, %OCT_FMT, NCHARS);
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:126  

   9834  1 002163   200055 630500                    EPPR0   NCHARS,,AUTO
         1 002164   200235 450500                    STP0    DIG+4,,AUTO
         1 002165   000000 236000 2                  LDQ     0
         1 002166   200234 756100                    STQ     DIG+3,,AUTO
         1 002167   200216 633500                    EPPR3   VAL,,AUTO
         1 002170   200233 453500                    STP3    DIG+2,,AUTO
         1 002171   200214 634500                    EPPR4   MYBUF$,,AUTO
         1 002172   200232 454500                    STP4    DIG+1,,AUTO
         1 002173   200232 630500                    EPPR0   DIG+1,,AUTO
         1 002174   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 002175   000000 701000 xent               TSX1    DDR$BINTXT
         1 002176   000000 011000                    NOP     0

      745     9835    5                            CALL DDR$BUMPC_D$(NCHARS) ALTRET(DERR);

   9835  1 002177   200055 630500                    EPPR0   NCHARS,,AUTO
         1 002200   200232 450500                    STP0    DIG+1,,AUTO
         1 002201   200232 630500                    EPPR0   DIG+1,,AUTO
         1 002202   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002203   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 002204   010563 702000 1                  TSX2    DERR

      746     9836    5                            TEXT$ -> TEXTR = MYBUF;

   9836  1 002205   200217 470500                    LDP0    TEXT$,,AUTO
         1 002206   200055 720100                    LXL0    NCHARS,,AUTO
         1 002207   040140 100500                    MLR     fill='040'O
         1 002210   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 002211   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      747     9837    5                            TEXT$ = S_D.D$;

   9837  1 002212   000000 471400 xsym               LDP1    S_D$
         1 002213   100044 236100                    LDQ     36,,PR1
         1 002214   200217 756100                    STQ     TEXT$,,AUTO

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:127  
      748     9838    5                            VAL = DVALUE.BASE.C;

   9838  1 002215   200013 236100                    LDQ     CVALUES+1,,AUTO
         1 002216   000003 376007                    ANQ     3,DL
         1 002217   200216 756100                    STQ     VAL,,AUTO

      749     9839    5                            IF VAL > 0

   9839  1 002220   002237 604400 1                  TMOZ    s:9847

      750     9840    6                            THEN DO;

      751     9841    6                                 CALL DDR$BUMPC_D$(2) ALTRET(DERR);

   9841  1 002221   000003 630400 2                  EPPR0   3
         1 002222   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002223   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 002224   010563 702000 1                  TSX2    DERR

      752     9842    6                                 TEXT$ -> CHAR1 = '-';

   9842  1 002225   200217 470500                    LDP0    TEXT$,,AUTO
         1 002226   040100 100400                    MLR     fill='040'O
         1 002227   000002 000001 2                  ADSC9   2                        cn=0,n=1
         1 002230   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      753     9843    6                                 CALL BINCHAR(PINCRC(TEXT$, 1) -> CHAR1, VAL);

   9843  1 002231   000100 301500                    BTD
         1 002232   200216 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         1 002233   000000 230001                    NDSC9   0,,PR0                   cn=1,s=nosgn,sf=0,n=1

      754     9844    6                                 TEXT$ = S_D.D$;

   9844  1 002234   000000 471400 xsym               LDP1    S_D$
         1 002235   100044 236100                    LDQ     36,,PR1
         1 002236   200217 756100                    STQ     TEXT$,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:128  

      755     9845    6                               END;

      756     9846    5                          END;

      757     9847    4                       RETURN;

   9847  1 002237   000000 702200 xent               TSX2  ! X66_ARET

      758     9848    4                    CASE( 8, 9, 11 );

      759     9849    4                       VAL = EDVALUE.IC;

   9849  1 002240   200012 235100                    LDA     CVALUES,,AUTO
         1 002241   000022 771000                    ARL     18
         1 002242   200216 755100                    STA     VAL,,AUTO

      760     9850    4                       CALL DDR$BINTXT(MYBUF$, VAL, %OCT_FMT, NCHARS);

   9850  1 002243   200055 633500                    EPPR3   NCHARS,,AUTO
         1 002244   200235 453500                    STP3    DIG+4,,AUTO
         1 002245   000000 236000 2                  LDQ     0
         1 002246   200234 756100                    STQ     DIG+3,,AUTO
         1 002247   200216 634500                    EPPR4   VAL,,AUTO
         1 002250   200233 454500                    STP4    DIG+2,,AUTO
         1 002251   200214 635500                    EPPR5   MYBUF$,,AUTO
         1 002252   200232 455500                    STP5    DIG+1,,AUTO
         1 002253   200232 630500                    EPPR0   DIG+1,,AUTO
         1 002254   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 002255   000000 701000 xent               TSX1    DDR$BINTXT
         1 002256   000000 011000                    NOP     0

      761     9851    4                       CALL DDR$BUMPC_D$(NCHARS + 7) ALTRET(DERR);

   9851  1 002257   200055 235100                    LDA     NCHARS,,AUTO
         1 002260   000007 035007                    ADLA    7,DL
         1 002261   200232 755100                    STA     DIG+1,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:129  
         1 002262   200232 630500                    EPPR0   DIG+1,,AUTO
         1 002263   200233 450500                    STP0    DIG+2,,AUTO
         1 002264   200233 630500                    EPPR0   DIG+2,,AUTO
         1 002265   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002266   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 002267   010563 702000 1                  TSX2    DERR

      762     9852
      763     9853    4                       TEXT$ -> CHAR3 = 'IC=';

   9853  1 002270   200217 470500                    LDP0    TEXT$,,AUTO
         1 002271   040100 100400                    MLR     fill='040'O
         1 002272   000053 000003 0                  ADSC9   HEXCHARS+18              cn=0,n=3
         1 002273   000000 000003                    ADSC9   0,,PR0                   cn=0,n=3

      764     9854    4                       TEXT$ = PINCRC(TEXT$, 3);

   9854  1 002274   200217 236100                    LDQ     TEXT$,,AUTO
         1 002275   600000 036007                    ADLQ    -65536,DL
         1 002276   200217 756100                    STQ     TEXT$,,AUTO

      765     9855    4                       TEXT$ -> TEXTR = MYBUF;

   9855  1 002277   200217 470500                    LDP0    TEXT$,,AUTO
         1 002300   200055 720100                    LXL0    NCHARS,,AUTO
         1 002301   040140 100500                    MLR     fill='040'O
         1 002302   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 002303   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      766     9856    4                       TEXT$ = PINCRC(TEXT$, NCHARS);

   9856  1 002304   200055 236100                    LDQ     NCHARS,,AUTO
         1 002305   000020 736000                    QLS     16
         1 002306   200217 036100                    ADLQ    TEXT$,,AUTO
         1 002307   200217 756100                    STQ     TEXT$,,AUTO

      767     9857    4                       TEXT$ -> CHAR4 = ',$LS';
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:130  

   9857  1 002310   200217 470500                    LDP0    TEXT$,,AUTO
         1 002311   040100 100400                    MLR     fill='040'O
         1 002312   000054 000004 0                  ADSC9   HEXCHARS+19              cn=0,n=4
         1 002313   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4

      768     9858    4                       TEXT$ = S_D.D$;

   9858  1 002314   000000 471400 xsym               LDP1    S_D$
         1 002315   100044 236100                    LDQ     36,,PR1
         1 002316   200217 756100                    STQ     TEXT$,,AUTO

      769     9859    4                       VAL = EDVALUE.ISEG;

   9859  1 002317   200012 236100                    LDQ     CVALUES,,AUTO
         1 002320   000007 772000                    QRL     7
         1 002321   001777 376007                    ANQ     1023,DL
         1 002322   200216 756100                    STQ     VAL,,AUTO

      770     9860    4                       CALL DDR$BINTXT(MYBUF$, VAL, %UINT_FMT, NCHARS);

   9860  1 002323   200055 630500                    EPPR0   NCHARS,,AUTO
         1 002324   200235 450500                    STP0    DIG+4,,AUTO
         1 002325   000003 236000 2                  LDQ     3
         1 002326   200234 756100                    STQ     DIG+3,,AUTO
         1 002327   200216 633500                    EPPR3   VAL,,AUTO
         1 002330   200233 453500                    STP3    DIG+2,,AUTO
         1 002331   200214 634500                    EPPR4   MYBUF$,,AUTO
         1 002332   200232 454500                    STP4    DIG+1,,AUTO
         1 002333   200232 630500                    EPPR0   DIG+1,,AUTO
         1 002334   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 002335   000000 701000 xent               TSX1    DDR$BINTXT
         1 002336   000000 011000                    NOP     0

      771     9861    4                       CALL DDR$BUMPC_D$(NCHARS);

   9861  1 002337   200055 630500                    EPPR0   NCHARS,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:131  
         1 002340   200232 450500                    STP0    DIG+1,,AUTO
         1 002341   200232 630500                    EPPR0   DIG+1,,AUTO
         1 002342   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002343   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 002344   000000 011000                    NOP     0

      772     9862    4                       TEXT$ -> TEXTR = MYBUF;

   9862  1 002345   200217 470500                    LDP0    TEXT$,,AUTO
         1 002346   200055 720100                    LXL0    NCHARS,,AUTO
         1 002347   040140 100500                    MLR     fill='040'O
         1 002350   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 002351   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      773     9863    4                       TEXT$ = S_D.D$;

   9863  1 002352   000000 471400 xsym               LDP1    S_D$
         1 002353   100044 236100                    LDQ     36,,PR1
         1 002354   200217 756100                    STQ     TEXT$,,AUTO

      774     9864    4                       IF SIZE = 72

   9864  1 002355   200004 470500                    LDP0    @SIZE,,AUTO
         1 002356   000000 235100                    LDA     0,,PR0
         1 002357   000110 115007                    CMPA    72,DL
         1 002360   002504 601000 1                  TNZ     s:9882

      775     9865    5                       THEN DO;

      776     9866    5                            CALL DDR$BUMPC_D$(7) ALTRET(DERR);

   9866  1 002361   000021 630400 2                  EPPR0   17
         1 002362   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002363   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 002364   010563 702000 1                  TSX2    DERR

      777     9867    5                            TEXT$ -> CHAR7 = ',LBASE=';
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:132  

   9867  1 002365   200217 470500                    LDP0    TEXT$,,AUTO
         1 002366   040100 100400                    MLR     fill='040'O
         1 002367   000055 000007 0                  ADSC9   HEXCHARS+20              cn=0,n=7
         1 002370   000000 000007                    ADSC9   0,,PR0                   cn=0,n=7

      778     9868    5                            TEXT$ = S_D.D$;

   9868  1 002371   000000 471400 xsym               LDP1    S_D$
         1 002372   100044 236100                    LDQ     36,,PR1
         1 002373   200217 756100                    STQ     TEXT$,,AUTO

      779     9869    5                            VAL = EDVALUE.LBASE * 2;

   9869  1 002374   200013 236100                    LDQ     CVALUES+1,,AUTO
         1 002375   000002 772000                    QRL     2
         1 002376   000022 376000 2                  ANQ     18
         1 002377   200216 756100                    STQ     VAL,,AUTO

      780     9870    5                            CALL DDR$BINTXT(MYBUF$, VAL, %OCT_FMT, NCHARS);

   9870  1 002400   200055 630500                    EPPR0   NCHARS,,AUTO
         1 002401   200235 450500                    STP0    DIG+4,,AUTO
         1 002402   000000 236000 2                  LDQ     0
         1 002403   200234 756100                    STQ     DIG+3,,AUTO
         1 002404   200216 633500                    EPPR3   VAL,,AUTO
         1 002405   200233 453500                    STP3    DIG+2,,AUTO
         1 002406   200214 634500                    EPPR4   MYBUF$,,AUTO
         1 002407   200232 454500                    STP4    DIG+1,,AUTO
         1 002410   200232 630500                    EPPR0   DIG+1,,AUTO
         1 002411   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 002412   000000 701000 xent               TSX1    DDR$BINTXT
         1 002413   000000 011000                    NOP     0

      781     9871    5                            CALL DDR$BUMPC_D$(NCHARS + 7) ALTRET(DERR);

   9871  1 002414   200055 235100                    LDA     NCHARS,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:133  
         1 002415   000007 035007                    ADLA    7,DL
         1 002416   200232 755100                    STA     DIG+1,,AUTO
         1 002417   200232 630500                    EPPR0   DIG+1,,AUTO
         1 002420   200233 450500                    STP0    DIG+2,,AUTO
         1 002421   200233 630500                    EPPR0   DIG+2,,AUTO
         1 002422   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002423   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 002424   010563 702000 1                  TSX2    DERR

      782     9872    5                            TEXT$ -> TEXTR = MYBUF;

   9872  1 002425   200217 470500                    LDP0    TEXT$,,AUTO
         1 002426   200055 720100                    LXL0    NCHARS,,AUTO
         1 002427   040140 100500                    MLR     fill='040'O
         1 002430   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 002431   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      783     9873    5                            TEXT$ = PINCRC(TEXT$, NCHARS);

   9873  1 002432   200055 236100                    LDQ     NCHARS,,AUTO
         1 002433   000020 736000                    QLS     16
         1 002434   200217 036100                    ADLQ    TEXT$,,AUTO
         1 002435   200217 756100                    STQ     TEXT$,,AUTO

      784     9874    5                            TEXT$ -> CHAR7 = ',LSIZE=';

   9874  1 002436   200217 470500                    LDP0    TEXT$,,AUTO
         1 002437   040100 100400                    MLR     fill='040'O
         1 002440   000057 000007 0                  ADSC9   HEXCHARS+22              cn=0,n=7
         1 002441   000000 000007                    ADSC9   0,,PR0                   cn=0,n=7

      785     9875    5                            TEXT$ = S_D.D$;

   9875  1 002442   000000 471400 xsym               LDP1    S_D$
         1 002443   100044 236100                    LDQ     36,,PR1
         1 002444   200217 756100                    STQ     TEXT$,,AUTO

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:134  
      786     9876    5                            VAL = EDVALUE.LSIZE + 1;

   9876  1 002445   200013 236100                    LDQ     CVALUES+1,,AUTO
         1 002446   000032 772000                    QRL     26
         1 002447   000001 036007                    ADLQ    1,DL
         1 002450   200216 756100                    STQ     VAL,,AUTO

      787     9877    5                            CALL DDR$BINTXT(MYBUF$, VAL, %UINT_FMT, NCHARS);

   9877  1 002451   200055 630500                    EPPR0   NCHARS,,AUTO
         1 002452   200235 450500                    STP0    DIG+4,,AUTO
         1 002453   000003 236000 2                  LDQ     3
         1 002454   200234 756100                    STQ     DIG+3,,AUTO
         1 002455   200216 633500                    EPPR3   VAL,,AUTO
         1 002456   200233 453500                    STP3    DIG+2,,AUTO
         1 002457   200214 634500                    EPPR4   MYBUF$,,AUTO
         1 002460   200232 454500                    STP4    DIG+1,,AUTO
         1 002461   200232 630500                    EPPR0   DIG+1,,AUTO
         1 002462   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 002463   000000 701000 xent               TSX1    DDR$BINTXT
         1 002464   000000 011000                    NOP     0

      788     9878    5                            CALL DDR$BUMPC_D$(NCHARS) ALTRET(DERR);

   9878  1 002465   200055 630500                    EPPR0   NCHARS,,AUTO
         1 002466   200232 450500                    STP0    DIG+1,,AUTO
         1 002467   200232 630500                    EPPR0   DIG+1,,AUTO
         1 002470   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002471   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 002472   010563 702000 1                  TSX2    DERR

      789     9879    5                            TEXT$ -> TEXTR = MYBUF;

   9879  1 002473   200217 470500                    LDP0    TEXT$,,AUTO
         1 002474   200055 720100                    LXL0    NCHARS,,AUTO
         1 002475   040140 100500                    MLR     fill='040'O
         1 002476   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:135  
         1 002477   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      790     9880    5                            TEXT$ = PINCRC(TEXT$, NCHARS);

   9880  1 002500   200055 236100                    LDQ     NCHARS,,AUTO
         1 002501   000020 736000                    QLS     16
         1 002502   200217 036100                    ADLQ    TEXT$,,AUTO
         1 002503   200217 756100                    STQ     TEXT$,,AUTO

      791     9881    5                          END;

      792     9882    4                       CALL DDR$BUMPC_D$(10) ALTRET(DERR);

   9882  1 002504   000023 630400 2                  EPPR0   19
         1 002505   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002506   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 002507   010563 702000 1                  TSX2    DERR

      793     9883    4                       TEXT$ -> CHAR5 = ',WSR=';

   9883  1 002510   200217 470500                    LDP0    TEXT$,,AUTO
         1 002511   040100 100400                    MLR     fill='040'O
         1 002512   000043 000005 0                  ADSC9   HEXCHARS+10              cn=0,n=5
         1 002513   000000 000005                    ADSC9   0,,PR0                   cn=0,n=5

      794     9884    4                       VAL = EDVALUE.WSR;

   9884  1 002514   200012 236100                    LDQ     CVALUES,,AUTO
         1 002515   000004 772000                    QRL     4
         1 002516   000007 376007                    ANQ     7,DL
         1 002517   200216 756100                    STQ     VAL,,AUTO

      795     9885    4                       TEXT$ = PINCRC(TEXT$, 5);

   9885  1 002520   200217 236100                    LDQ     TEXT$,,AUTO
         1 002521   000020 036000 2                  ADLQ    16
         1 002522   200217 756100                    STQ     TEXT$,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:136  

      796     9886    4                       CALL BINCHAR(TEXT$ -> CHAR1, VAL);

   9886  1 002523   200217 470500                    LDP0    TEXT$,,AUTO
         1 002524   000100 301500                    BTD
         1 002525   200216 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         1 002526   000000 030001                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=1

      797     9887    4                       PINCRC(TEXT$, 1) -> CHAR4 = ',TY=';

   9887  1 002527   040100 100400                    MLR     fill='040'O
         1 002530   000051 000004 0                  ADSC9   HEXCHARS+16              cn=0,n=4
         1 002531   000000 200004                    ADSC9   0,,PR0                   cn=1,n=4

      798     9888    4                       TEXT$ = S_D.D$;

   9888  1 002532   000000 471400 xsym               LDP1    S_D$
         1 002533   100044 236100                    LDQ     36,,PR1
         1 002534   200217 756100                    STQ     TEXT$,,AUTO

      799     9889    4                       CALL DDR$BINTXT(MYBUF$, TYPE, %UINT_FMT, NCHARS);

   9889  1 002535   200055 630500                    EPPR0   NCHARS,,AUTO
         1 002536   200235 450500                    STP0    DIG+4,,AUTO
         1 002537   000003 236000 2                  LDQ     3
         1 002540   200234 756100                    STQ     DIG+3,,AUTO
         1 002541   200117 633500                    EPPR3   TYPE,,AUTO
         1 002542   200233 453500                    STP3    DIG+2,,AUTO
         1 002543   200214 634500                    EPPR4   MYBUF$,,AUTO
         1 002544   200232 454500                    STP4    DIG+1,,AUTO
         1 002545   200232 630500                    EPPR0   DIG+1,,AUTO
         1 002546   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 002547   000000 701000 xent               TSX1    DDR$BINTXT
         1 002550   000000 011000                    NOP     0

      800     9890    4                       CALL DDR$BUMPC_D$(NCHARS) ALTRET(DERR);

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:137  
   9890  1 002551   200055 630500                    EPPR0   NCHARS,,AUTO
         1 002552   200232 450500                    STP0    DIG+1,,AUTO
         1 002553   200232 630500                    EPPR0   DIG+1,,AUTO
         1 002554   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002555   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 002556   010563 702000 1                  TSX2    DERR

      801     9891    4                       TEXT$ -> TEXTR = MYBUF;

   9891  1 002557   200217 470500                    LDP0    TEXT$,,AUTO
         1 002560   200055 720100                    LXL0    NCHARS,,AUTO
         1 002561   040140 100500                    MLR     fill='040'O
         1 002562   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 002563   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      802     9892    4                       RETURN;

   9892  1 002564   000000 702200 xent               TSX2  ! X66_ARET

      803     9893    4                    CASE( ELSE );

      804     9894    4                       GOTO OCTAL;

   9894  1 002565   003774 710000 1                  TRA     OCTAL

      805     9895    4                    END;                   /* DO CASE( TYPE ) */

      806     9896
      807     9897    3               CASE ( %L6 );

      808     9898
      809     9899    3                  IF SIZE ~= 32 THEN GOTO WRONG_SIZE;

   9899  1 002566   200004 471500                    LDP1    @SIZE,,AUTO
         1 002567   100000 235100                    LDA     0,,PR1
         1 002570   000040 115007                    CMPA    32,DL
         1 002571   010560 601000 1                  TNZ     WRONG_SIZE
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:138  

      810     9900    3                  VAL = 0;

   9900  1 002572   200216 450100                    STZ     VAL,,AUTO

      811     9901    3                  IF L6_DESC.VALID

   9901  1 002573   200012 236100                    LDQ     CVALUES,,AUTO
         1 002574   100000 316007                    CANQ    32768,DL
         1 002575   002603 600000 1                  TZE     s:9903

      812     9902    3                  THEN TEXT$ -> CHAR11 = 'VALID=''1''B,';

   9902  1 002576   200217 473500                    LDP3    TEXT$,,AUTO
         1 002577   040100 100400                    MLR     fill='040'O
         1 002600   000061 000013 0                  ADSC9   HEXCHARS+24              cn=0,n=11
         1 002601   300000 000013                    ADSC9   0,,PR3                   cn=0,n=11
         1 002602   002607 710000 1                  TRA     s:9904

      813     9903    3                  ELSE TEXT$ -> CHAR11 = 'VALID=''0''B,';

   9903  1 002603   200217 473500                    LDP3    TEXT$,,AUTO
         1 002604   040100 100400                    MLR     fill='040'O
         1 002605   000064 000013 0                  ADSC9   HEXCHARS+27              cn=0,n=11
         1 002606   300000 000013                    ADSC9   0,,PR3                   cn=0,n=11

      814     9904    3                  CALL DDR$BUMPC_D$ ( 11 ) ALTRET ( DERR );

   9904  1 002607   000024 630400 2                  EPPR0   20
         1 002610   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002611   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 002612   010563 702000 1                  TSX2    DERR

      815     9905    3                  TEXT$ = S_D.D$;

   9905  1 002613   000000 470400 xsym               LDP0    S_D$
         1 002614   000044 236100                    LDQ     36,,PR0
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:139  
         1 002615   200217 756100                    STQ     TEXT$,,AUTO

      816     9906    3                  TEXT$ -> CHAR5 = 'BASE=';

   9906  1 002616   200217 471500                    LDP1    TEXT$,,AUTO
         1 002617   040100 100400                    MLR     fill='040'O
         1 002620   000067 000005 0                  ADSC9   HEXCHARS+30              cn=0,n=5
         1 002621   100000 000005                    ADSC9   0,,PR1                   cn=0,n=5

      817     9907    3                  CALL DDR$BUMPC_D$ ( LENGTHC ('BASE=') ) ALTRET ( DERR );

   9907  1 002622   000001 630400 2                  EPPR0   1
         1 002623   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002624   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 002625   010563 702000 1                  TSX2    DERR

      818     9908    3                  TEXT$ = S_D.D$;

   9908  1 002626   000000 470400 xsym               LDP0    S_D$
         1 002627   000044 236100                    LDQ     36,,PR0
         1 002630   200217 756100                    STQ     TEXT$,,AUTO

      819     9909    3                  VAL = L6_DESC.BASE;

   9909  1 002631   200012 236100                    LDQ     CVALUES,,AUTO
         1 002632   007777 376007                    ANQ     4095,DL
         1 002633   200216 756100                    STQ     VAL,,AUTO

      820     9910    3                  CALL DDR$BINTXT ( MYBUF$, VAL, %X_FMT, NCHARS );

   9910  1 002634   200055 631500                    EPPR1   NCHARS,,AUTO
         1 002635   200235 451500                    STP1    DIG+4,,AUTO
         1 002636   000010 236000 2                  LDQ     8
         1 002637   200234 756100                    STQ     DIG+3,,AUTO
         1 002640   200216 633500                    EPPR3   VAL,,AUTO
         1 002641   200233 453500                    STP3    DIG+2,,AUTO
         1 002642   200214 634500                    EPPR4   MYBUF$,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:140  
         1 002643   200232 454500                    STP4    DIG+1,,AUTO
         1 002644   200232 630500                    EPPR0   DIG+1,,AUTO
         1 002645   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 002646   000000 701000 xent               TSX1    DDR$BINTXT
         1 002647   000000 011000                    NOP     0

      821     9911    3                  TEXT$ -> TEXTR = MYBUF;

   9911  1 002650   200217 470500                    LDP0    TEXT$,,AUTO
         1 002651   200055 720100                    LXL0    NCHARS,,AUTO
         1 002652   040140 100500                    MLR     fill='040'O
         1 002653   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 002654   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      822     9912    3                  CALL DDR$BUMPC_D$ ( NCHARS ) ALTRET ( DERR );

   9912  1 002655   200055 631500                    EPPR1   NCHARS,,AUTO
         1 002656   200232 451500                    STP1    DIG+1,,AUTO
         1 002657   200232 630500                    EPPR0   DIG+1,,AUTO
         1 002660   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002661   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 002662   010563 702000 1                  TSX2    DERR

      823     9913    3                  TEXT$ = S_D.D$;

   9913  1 002663   000000 470400 xsym               LDP0    S_D$
         1 002664   000044 236100                    LDQ     36,,PR0
         1 002665   200217 756100                    STQ     TEXT$,,AUTO

      824     9914    3                  TEXT$ -> CHAR9 = ',RD_PRIV=';

   9914  1 002666   200217 471500                    LDP1    TEXT$,,AUTO
         1 002667   040100 100400                    MLR     fill='040'O
         1 002670   000071 000011 0                  ADSC9   HEXCHARS+32              cn=0,n=9
         1 002671   100000 000011                    ADSC9   0,,PR1                   cn=0,n=9

      825     9915    3                  CALL DDR$BUMPC_D$ ( LENGTHC ( ',RD_PRIV=' ) ) ALTRET ( DERR );
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:141  

   9915  1 002672   000025 630400 2                  EPPR0   21
         1 002673   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002674   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 002675   010563 702000 1                  TSX2    DERR

      826     9916    3                  TEXT$ = S_D.D$;

   9916  1 002676   000000 470400 xsym               LDP0    S_D$
         1 002677   000044 236100                    LDQ     36,,PR0
         1 002700   200217 756100                    STQ     TEXT$,,AUTO

      827     9917    3                  VAL = 0;

   9917  1 002701   200216 450100                    STZ     VAL,,AUTO

      828     9918    3                  DWRD_VAL.RIGHT2 = L6_DESC.RD_PRIV \ '11'B;
              9918                           /* Convert one's complement */

   9918  1 002702   200013 236100                    LDQ     CVALUES+1,,AUTO
         1 002703   000024 736000                    QLS     20
         1 002704   600000 376003                    ANQ     -65536,DU
         1 002705   600000 676003                    ERQ     -65536,DU
         1 002706   000042 772000                    QRL     34
         1 002707   200216 676100                    ERQ     VAL,,AUTO
         1 002710   000003 376007                    ANQ     3,DL
         1 002711   200216 656100                    ERSQ    VAL,,AUTO

      829     9919    3                  CALL DDR$BINTXT ( MYBUF$, VAL, %UINT_FMT, NCHARS );

   9919  1 002712   200055 631500                    EPPR1   NCHARS,,AUTO
         1 002713   200235 451500                    STP1    DIG+4,,AUTO
         1 002714   000003 236000 2                  LDQ     3
         1 002715   200234 756100                    STQ     DIG+3,,AUTO
         1 002716   200216 633500                    EPPR3   VAL,,AUTO
         1 002717   200233 453500                    STP3    DIG+2,,AUTO
         1 002720   200214 634500                    EPPR4   MYBUF$,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:142  
         1 002721   200232 454500                    STP4    DIG+1,,AUTO
         1 002722   200232 630500                    EPPR0   DIG+1,,AUTO
         1 002723   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 002724   000000 701000 xent               TSX1    DDR$BINTXT
         1 002725   000000 011000                    NOP     0

      830     9920    3                  TEXT$ -> TEXTR = MYBUF;

   9920  1 002726   200217 470500                    LDP0    TEXT$,,AUTO
         1 002727   200055 720100                    LXL0    NCHARS,,AUTO
         1 002730   040140 100500                    MLR     fill='040'O
         1 002731   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 002732   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      831     9921    3                  CALL DDR$BUMPC_D$ ( NCHARS ) ALTRET ( DERR );

   9921  1 002733   200055 631500                    EPPR1   NCHARS,,AUTO
         1 002734   200232 451500                    STP1    DIG+1,,AUTO
         1 002735   200232 630500                    EPPR0   DIG+1,,AUTO
         1 002736   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002737   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 002740   010563 702000 1                  TSX2    DERR

      832     9922    3                  TEXT$ = S_D.D$;

   9922  1 002741   000000 470400 xsym               LDP0    S_D$
         1 002742   000044 236100                    LDQ     36,,PR0
         1 002743   200217 756100                    STQ     TEXT$,,AUTO

      833     9923    3                  TEXT$ -> CHAR9 = ',WR_PRIV=';

   9923  1 002744   200217 471500                    LDP1    TEXT$,,AUTO
         1 002745   040100 100400                    MLR     fill='040'O
         1 002746   000074 000011 0                  ADSC9   HEXCHARS+35              cn=0,n=9
         1 002747   100000 000011                    ADSC9   0,,PR1                   cn=0,n=9

      834     9924    3                  CALL DDR$BUMPC_D$ ( LENGTHC ( ',WR_PRIV=' ) ) ALTRET ( DERR );
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:143  

   9924  1 002750   000025 630400 2                  EPPR0   21
         1 002751   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002752   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 002753   010563 702000 1                  TSX2    DERR

      835     9925    3                  TEXT$ = S_D.D$;

   9925  1 002754   000000 470400 xsym               LDP0    S_D$
         1 002755   000044 236100                    LDQ     36,,PR0
         1 002756   200217 756100                    STQ     TEXT$,,AUTO

      836     9926    3                  VAL = 0;

   9926  1 002757   200216 450100                    STZ     VAL,,AUTO

      837     9927    3                  DWRD_VAL.RIGHT2 = L6_DESC.WR_PRIV \ '11'B;

   9927  1 002760   200013 236100                    LDQ     CVALUES+1,,AUTO
         1 002761   000026 736000                    QLS     22
         1 002762   600000 376003                    ANQ     -65536,DU
         1 002763   600000 676003                    ERQ     -65536,DU
         1 002764   000042 772000                    QRL     34
         1 002765   200216 676100                    ERQ     VAL,,AUTO
         1 002766   000003 376007                    ANQ     3,DL
         1 002767   200216 656100                    ERSQ    VAL,,AUTO

      838     9928    3                  CALL DDR$BINTXT ( MYBUF$, VAL, %UINT_FMT, NCHARS );

   9928  1 002770   200055 631500                    EPPR1   NCHARS,,AUTO
         1 002771   200235 451500                    STP1    DIG+4,,AUTO
         1 002772   000003 236000 2                  LDQ     3
         1 002773   200234 756100                    STQ     DIG+3,,AUTO
         1 002774   200216 633500                    EPPR3   VAL,,AUTO
         1 002775   200233 453500                    STP3    DIG+2,,AUTO
         1 002776   200214 634500                    EPPR4   MYBUF$,,AUTO
         1 002777   200232 454500                    STP4    DIG+1,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:144  
         1 003000   200232 630500                    EPPR0   DIG+1,,AUTO
         1 003001   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 003002   000000 701000 xent               TSX1    DDR$BINTXT
         1 003003   000000 011000                    NOP     0

      839     9929    3                  TEXT$ -> TEXTR = MYBUF;

   9929  1 003004   200217 470500                    LDP0    TEXT$,,AUTO
         1 003005   200055 720100                    LXL0    NCHARS,,AUTO
         1 003006   040140 100500                    MLR     fill='040'O
         1 003007   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 003010   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      840     9930    3                  CALL DDR$BUMPC_D$ ( NCHARS ) ALTRET ( DERR );

   9930  1 003011   200055 631500                    EPPR1   NCHARS,,AUTO
         1 003012   200232 451500                    STP1    DIG+1,,AUTO
         1 003013   200232 630500                    EPPR0   DIG+1,,AUTO
         1 003014   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 003015   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 003016   010563 702000 1                  TSX2    DERR

      841     9931    3                  TEXT$ = S_D.D$;

   9931  1 003017   000000 470400 xsym               LDP0    S_D$
         1 003020   000044 236100                    LDQ     36,,PR0
         1 003021   200217 756100                    STQ     TEXT$,,AUTO

      842     9932    3                  TEXT$ -> CHAR9 = ',EX_PRIV=';

   9932  1 003022   200217 471500                    LDP1    TEXT$,,AUTO
         1 003023   040100 100400                    MLR     fill='040'O
         1 003024   000077 000011 0                  ADSC9   HEXCHARS+38              cn=0,n=9
         1 003025   100000 000011                    ADSC9   0,,PR1                   cn=0,n=9

      843     9933    3                  CALL DDR$BUMPC_D$ ( LENGTHC ( ',EX_PRIV=' ) ) ALTRET ( DERR );

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:145  
   9933  1 003026   000025 630400 2                  EPPR0   21
         1 003027   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 003030   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 003031   010563 702000 1                  TSX2    DERR

      844     9934    3                  VAL = 0;

   9934  1 003032   200216 450100                    STZ     VAL,,AUTO

      845     9935    3                  DWRD_VAL.RIGHT2 = L6_DESC.EX_PRIV \ '11'B;

   9935  1 003033   200013 236100                    LDQ     CVALUES+1,,AUTO
         1 003034   000030 736000                    QLS     24
         1 003035   600000 376003                    ANQ     -65536,DU
         1 003036   600000 676003                    ERQ     -65536,DU
         1 003037   000042 772000                    QRL     34
         1 003040   200216 676100                    ERQ     VAL,,AUTO
         1 003041   000003 376007                    ANQ     3,DL
         1 003042   200216 656100                    ERSQ    VAL,,AUTO

      846     9936    3                  CALL DDR$BINTXT ( MYBUF$, VAL, %UINT_FMT, NCHARS );

   9936  1 003043   200055 630500                    EPPR0   NCHARS,,AUTO
         1 003044   200235 450500                    STP0    DIG+4,,AUTO
         1 003045   000003 236000 2                  LDQ     3
         1 003046   200234 756100                    STQ     DIG+3,,AUTO
         1 003047   200216 631500                    EPPR1   VAL,,AUTO
         1 003050   200233 451500                    STP1    DIG+2,,AUTO
         1 003051   200214 633500                    EPPR3   MYBUF$,,AUTO
         1 003052   200232 453500                    STP3    DIG+1,,AUTO
         1 003053   200232 630500                    EPPR0   DIG+1,,AUTO
         1 003054   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 003055   000000 701000 xent               TSX1    DDR$BINTXT
         1 003056   000000 011000                    NOP     0

      847     9937    3                  TEXT$ = S_D.D$;

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:146  
   9937  1 003057   000000 470400 xsym               LDP0    S_D$
         1 003060   000044 236100                    LDQ     36,,PR0
         1 003061   200217 756100                    STQ     TEXT$,,AUTO

      848     9938    3                  TEXT$ -> TEXTR = MYBUF;

   9938  1 003062   200217 471500                    LDP1    TEXT$,,AUTO
         1 003063   200055 720100                    LXL0    NCHARS,,AUTO
         1 003064   040140 100500                    MLR     fill='040'O
         1 003065   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 003066   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

      849     9939    3                  CALL DDR$BUMPC_D$ ( NCHARS ) ALTRET ( DERR );

   9939  1 003067   200055 633500                    EPPR3   NCHARS,,AUTO
         1 003070   200232 453500                    STP3    DIG+1,,AUTO
         1 003071   200232 630500                    EPPR0   DIG+1,,AUTO
         1 003072   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 003073   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 003074   010563 702000 1                  TSX2    DERR

      850     9940    3                  TEXT$ = S_D.D$;

   9940  1 003075   000000 470400 xsym               LDP0    S_D$
         1 003076   000044 236100                    LDQ     36,,PR0
         1 003077   200217 756100                    STQ     TEXT$,,AUTO

      851     9941    3                  TEXT$ -> CHAR6 = ',SIZE=';

   9941  1 003100   200217 471500                    LDP1    TEXT$,,AUTO
         1 003101   040100 100400                    MLR     fill='040'O
         1 003102   000102 000006 0                  ADSC9   HEXCHARS+41              cn=0,n=6
         1 003103   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6

      852     9942    3                  CALL DDR$BUMPC_D$ ( LENGTHC ( ',SIZE=' ) ) ALTRET ( DERR );

   9942  1 003104   000026 630400 2                  EPPR0   22
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:147  
         1 003105   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 003106   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 003107   010563 702000 1                  TSX2    DERR

      853     9943    3                  TEXT$ = S_D.D$;

   9943  1 003110   000000 470400 xsym               LDP0    S_D$
         1 003111   000044 236100                    LDQ     36,,PR0
         1 003112   200217 756100                    STQ     TEXT$,,AUTO

      854     9944    3                  VAL = L6_DESC.SIZE;

   9944  1 003113   200013 236100                    LDQ     CVALUES+1,,AUTO
         1 003114   000777 376007                    ANQ     511,DL
         1 003115   200216 756100                    STQ     VAL,,AUTO

      855     9945    3                  CALL DDR$BINTXT ( MYBUF$, VAL, %UINT_FMT, NCHARS );

   9945  1 003116   200055 631500                    EPPR1   NCHARS,,AUTO
         1 003117   200235 451500                    STP1    DIG+4,,AUTO
         1 003120   000003 236000 2                  LDQ     3
         1 003121   200234 756100                    STQ     DIG+3,,AUTO
         1 003122   200216 633500                    EPPR3   VAL,,AUTO
         1 003123   200233 453500                    STP3    DIG+2,,AUTO
         1 003124   200214 634500                    EPPR4   MYBUF$,,AUTO
         1 003125   200232 454500                    STP4    DIG+1,,AUTO
         1 003126   200232 630500                    EPPR0   DIG+1,,AUTO
         1 003127   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 003130   000000 701000 xent               TSX1    DDR$BINTXT
         1 003131   000000 011000                    NOP     0

      856     9946    3                  TEXT$ -> TEXTR = MYBUF;

   9946  1 003132   200217 470500                    LDP0    TEXT$,,AUTO
         1 003133   200055 720100                    LXL0    NCHARS,,AUTO
         1 003134   040140 100500                    MLR     fill='040'O
         1 003135   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:148  
         1 003136   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      857     9947    3                  CALL DDR$BUMPC_D$ ( NCHARS ) ALTRET ( DERR );

   9947  1 003137   200055 631500                    EPPR1   NCHARS,,AUTO
         1 003140   200232 451500                    STP1    DIG+1,,AUTO
         1 003141   200232 630500                    EPPR0   DIG+1,,AUTO
         1 003142   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 003143   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 003144   010563 702000 1                  TSX2    DERR

      858     9948    3                  RETURN;

   9948  1 003145   000000 702200 xent               TSX2  ! X66_ARET

      859     9949    3               END;

   9949  1 003146   010550 710000 1                  TRA     s:10845

      860     9950                                                /**************************
      861     9951                                                 ******* EBCDIC_FMT *******
      862     9952                                                 **************************/
      863     9953    2          CASE ( %EBCDIC_FMT );

      864     9954
      865     9955    2             TEXT$ -> CHAR1 = '''';

   9955  1 003147   200217 470500                    LDP0    TEXT$,,AUTO
         1 003150   040100 100400                    MLR     fill='040'O
         1 003151   000011 000001 2                  ADSC9   9                        cn=0,n=1
         1 003152   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      866     9956    2             CALL DDR$BUMPC_D$ ( 1 ) ALTRET ( DERR );

   9956  1 003153   000000 630400 2                  EPPR0   0
         1 003154   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 003155   000000 701000 xent               TSX1    DDR$BUMPC_D$
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:149  
         1 003156   010563 702000 1                  TSX2    DERR

      867     9957    2             TEXT$ = S_D.D$;

   9957  1 003157   000000 470400 xsym               LDP0    S_D$
         1 003160   000044 236100                    LDQ     36,,PR0
         1 003161   200217 756100                    STQ     TEXT$,,AUTO

      868     9958    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN ) ;

   9958  1 003162   006714 235100                    LDA     3532,,PR0
         1 003163   000003 115007                    CMPA    3,DL
         1 003164   003166 602005 1                  TNC     s:9958+4,AL
         1 003165   003333 710000 1                  TRA     s:9979
         1 003166   003333 710000 1                  TRA     s:9979
         1 003167   003171 710000 1                  TRA     s:9960
         1 003170   003230 710000 1                  TRA     s:9966

      869     9959    3               CASE ( %HOST );

      870     9960    4                  DO I = 0 TO SIZE / 9 - 1;

   9960  1 003171   200111 450100                    STZ     I,,AUTO
         1 003172   003217 710000 1                  TRA     s:9964+3

      871     9961    4                       TEXT$ -> CHAR1 = EBCDIC_XLATE_TBL.C ( HOST_CHAR ( I ) );

   9961  1 003173   200111 235100                    LDA     I,,AUTO
         1 003174   000100 101505                    MRL     fill='000'O
         1 003175   200012 000001                    ADSC9   CVALUES,A,AUTO           cn=0,n=1
         1 003176   200232 000004                    ADSC9   DIG+1,,AUTO              cn=0,n=4
         1 003177   200232 236100                    LDQ     DIG+1,,AUTO
         1 003200   000000 470400 xsym               LDP0    B$XL_EBC_DUMP$
         1 003201   200217 471500                    LDP1    TEXT$,,AUTO
         1 003202   040100 100506                    MLR     fill='040'O
         1 003203   000000 000001                    ADSC9   0,Q,PR0                  cn=0,n=1
         1 003204   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:150  

      872     9962    4                       CALL DDR$BUMPC_D$ ( 1 ) ALTRET ( DERR );

   9962  1 003205   000000 630400 2                  EPPR0   0
         1 003206   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 003207   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 003210   010563 702000 1                  TSX2    DERR

      873     9963    4                       TEXT$ = S_D.D$;

   9963  1 003211   000000 470400 xsym               LDP0    S_D$
         1 003212   000044 236100                    LDQ     36,,PR0
         1 003213   200217 756100                    STQ     TEXT$,,AUTO

      874     9964    4                     END;

   9964  1 003214   200111 235100                    LDA     I,,AUTO
         1 003215   000001 035007                    ADLA    1,DL
         1 003216   200111 755100                    STA     I,,AUTO
         1 003217   200004 471500                    LDP1    @SIZE,,AUTO
         1 003220   100000 236100                    LDQ     0,,PR1
         1 003221   000011 506007                    DIV     9,DL
         1 003222   000000 116003                    CMPQ    0,DU
         1 003223   003227 604000 1                  TMI     s:9964+11
         1 003224   200111 116100                    CMPQ    I,,AUTO
         1 003225   003227 600000 1                  TZE     s:9964+11
         1 003226   003173 603000 1                  TRC     s:9961
         1 003227   003333 710000 1                  TRA     s:9979

      875     9965    3               CASE ( %L6 );

      876     9966    3                  J = 0;

   9966  1 003230   200112 450100                    STZ     J,,AUTO

      877     9967    4                  DO I = 0 TO SIZE / 16 ;

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:151  
   9967  1 003231   200111 450100                    STZ     I,,AUTO
         1 003232   003266 710000 1                  TRA     s:9972+3

      878     9968    4                       HOST_CHAR ( J ) = L6_EBCHAR.L ( I );

   9968  1 003233   200111 236100                    LDQ     I,,AUTO
         1 003234   000044 402007                    MPY     36,DL
         1 003235   200232 756100                    STQ     DIG+1,,AUTO
         1 003236   200112 236100                    LDQ     J,,AUTO
         1 003237   000011 402007                    MPY     9,DL
         1 003240   200232 235100                    LDA     DIG+1,,AUTO
         1 003241   003106 061505                    CSR     bolr='003'O
         1 003242   200012 420010                    BDSC    CVALUES,A,AUTO           by=2,bit=2,n=8
         1 003243   200012 000011                    BDSC    CVALUES,Q,AUTO           by=0,bit=0,n=9

      879     9969    4                       J = J + 1;

   9969  1 003244   200112 235100                    LDA     J,,AUTO
         1 003245   000001 035007                    ADLA    1,DL
         1 003246   200112 755100                    STA     J,,AUTO

      880     9970    4                       HOST_CHAR ( J ) = L6_EBCHAR.R ( I );

   9970  1 003247   200111 236100                    LDQ     I,,AUTO
         1 003250   000044 402007                    MPY     36,DL
         1 003251   200232 756100                    STQ     DIG+1,,AUTO
         1 003252   200112 236100                    LDQ     J,,AUTO
         1 003253   000011 402007                    MPY     9,DL
         1 003254   200232 235100                    LDA     DIG+1,,AUTO
         1 003255   003106 061505                    CSR     bolr='003'O
         1 003256   200012 610010                    BDSC    CVALUES,A,AUTO           by=3,bit=1,n=8
         1 003257   200012 000011                    BDSC    CVALUES,Q,AUTO           by=0,bit=0,n=9

      881     9971    4                       J = J + 1;

   9971  1 003260   200112 235100                    LDA     J,,AUTO
         1 003261   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:152  
         1 003262   200112 755100                    STA     J,,AUTO

      882     9972    4                     END;

   9972  1 003263   200111 236100                    LDQ     I,,AUTO
         1 003264   000001 036007                    ADLQ    1,DL
         1 003265   200111 756100                    STQ     I,,AUTO
         1 003266   200004 470500                    LDP0    @SIZE,,AUTO
         1 003267   000000 236100                    LDQ     0,,PR0
         1 003270   000020 506007                    DIV     16,DL
         1 003271   000000 116003                    CMPQ    0,DU
         1 003272   003275 604000 1                  TMI     s:9973
         1 003273   200111 116100                    CMPQ    I,,AUTO
         1 003274   003233 603000 1                  TRC     s:9968

      883     9973    4                  DO I = 0 TO SIZE / 8 - 1;

   9973  1 003275   200111 450100                    STZ     I,,AUTO
         1 003276   003323 710000 1                  TRA     s:9977+3

      884     9974    4                       TEXT$ -> CHAR1 = EBCDIC_XLATE_TBL.C ( HOST_CHAR ( I ) );

   9974  1 003277   200111 235100                    LDA     I,,AUTO
         1 003300   000100 101505                    MRL     fill='000'O
         1 003301   200012 000001                    ADSC9   CVALUES,A,AUTO           cn=0,n=1
         1 003302   200232 000004                    ADSC9   DIG+1,,AUTO              cn=0,n=4
         1 003303   200232 236100                    LDQ     DIG+1,,AUTO
         1 003304   000000 470400 xsym               LDP0    B$XL_EBC_DUMP$
         1 003305   200217 471500                    LDP1    TEXT$,,AUTO
         1 003306   040100 100506                    MLR     fill='040'O
         1 003307   000000 000001                    ADSC9   0,Q,PR0                  cn=0,n=1
         1 003310   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

      885     9975    4                       CALL DDR$BUMPC_D$ ( 1 ) ALTRET ( DERR );

   9975  1 003311   000000 630400 2                  EPPR0   0
         1 003312   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:153  
         1 003313   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 003314   010563 702000 1                  TSX2    DERR

      886     9976    4                       TEXT$ = S_D.D$;

   9976  1 003315   000000 470400 xsym               LDP0    S_D$
         1 003316   000044 236100                    LDQ     36,,PR0
         1 003317   200217 756100                    STQ     TEXT$,,AUTO

      887     9977    4                     END;

   9977  1 003320   200111 235100                    LDA     I,,AUTO
         1 003321   000001 035007                    ADLA    1,DL
         1 003322   200111 755100                    STA     I,,AUTO
         1 003323   200004 470500                    LDP0    @SIZE,,AUTO
         1 003324   000000 236100                    LDQ     0,,PR0
         1 003325   000010 506007                    DIV     8,DL
         1 003326   000000 116003                    CMPQ    0,DU
         1 003327   003333 604000 1                  TMI     s:9979
         1 003330   200111 116100                    CMPQ    I,,AUTO
         1 003331   003333 600000 1                  TZE     s:9979
         1 003332   003277 603000 1                  TRC     s:9974

      888     9978    3               END;

      889     9979    2             TEXT$ -> CHAR3 = '''EB';

   9979  1 003333   200217 470500                    LDP0    TEXT$,,AUTO
         1 003334   040100 100400                    MLR     fill='040'O
         1 003335   000104 000003 0                  ADSC9   HEXCHARS+43              cn=0,n=3
         1 003336   000000 000003                    ADSC9   0,,PR0                   cn=0,n=3

      890     9980    2             CALL DDR$BUMPC_D$ ( 3 ) ALTRET ( DERR );

   9980  1 003337   000005 630400 2                  EPPR0   5
         1 003340   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 003341   000000 701000 xent               TSX1    DDR$BUMPC_D$
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:154  
         1 003342   010563 702000 1                  TSX2    DERR

      891     9981    2             RETURN;

   9981  1 003343   000000 702200 xent               TSX2  ! X66_ARET

      892     9982                                                /************************
      893     9983                                                 ******* EPTR_FMT *******
      894     9984                                                 ************************/
      895     9985    2          CASE ( %EPTR_FMT );

      896     9986
      897     9987    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );

   9987  1 003344   000000 470400 xsym               LDP0    S_D$
         1 003345   006714 235100                    LDA     3532,,PR0
         1 003346   000003 115007                    CMPA    3,DL
         1 003347   003351 602005 1                  TNC     s:9987+5,AL
         1 003350   010550 710000 1                  TRA     s:10845
         1 003351   003377 710000 1                  TRA     s:9997
         1 003352   003354 710000 1                  TRA     s:9989
         1 003353   003360 710000 1                  TRA     s:9992

      898     9988    3               CASE ( %HOST );

      899     9989    3                  VALUE.L = VALUE.E;

   9989  1 003354   200012 236100                    LDQ     CVALUES,,AUTO
         1 003355   000022 772000                    QRL     18
         1 003356   200012 756100                    STQ     CVALUES,,AUTO

      900     9990    3                  GOTO REL;

   9990  1 003357   005645 710000 1                  TRA     REL

      901     9991    3               CASE ( %L6 );

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:155  
      902     9992    3                  IF SIZE ~= 32 THEN GOTO WRONG_SIZE;

   9992  1 003360   200004 471500                    LDP1    @SIZE,,AUTO
         1 003361   100000 235100                    LDA     0,,PR1
         1 003362   000040 115007                    CMPA    32,DL
         1 003363   010560 601000 1                  TNZ     WRONG_SIZE

      903     9993    3                  VAL = 0;

   9993  1 003364   200216 450100                    STZ     VAL,,AUTO

      904     9994    3                  PWRD_VAL.LEFT4 = L6_PTR.LEFT4;

   9994  1 003365   200012 236100                    LDQ     CVALUES,,AUTO
         1 003366   000020 736000                    QLS     16
         1 003367   200216 676100                    ERQ     VAL,,AUTO
         1 003370   000006 376000 2                  ANQ     6
         1 003371   200216 656100                    ERSQ    VAL,,AUTO

      905     9995    3                  PWRD_VAL.RIGHT16 = L6_PTR.RIGHT16;

   9995  1 003372   200013 236100                    LDQ     CVALUES+1,,AUTO
         1 003373   200216 676100                    ERQ     VAL,,AUTO
         1 003374   177777 376007                    ANQ     65535,DL
         1 003375   200216 656100                    ERSQ    VAL,,AUTO

      906     9996    3                  GOTO REL6;

   9996  1 003376   005673 710000 1                  TRA     REL6

      907     9997    3               END;

   9997  1 003377   010550 710000 1                  TRA     s:10845

      908     9998                                                /*************************
      909     9999                                                 ******* FLOAT_FMT *******
      910    10000                                                 *************************/
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:156  
      911    10001    2          CASE( %FLOAT_FMT );

      912    10002    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );

  10002  1 003400   000000 470400 xsym               LDP0    S_D$
         1 003401   006714 235100                    LDA     3532,,PR0
         1 003402   000003 115007                    CMPA    3,DL
         1 003403   003405 602005 1                  TNC     s:10002+5,AL
         1 003404   003434 710000 1                  TRA     s:10011
         1 003405   003434 710000 1                  TRA     s:10011
         1 003406   003410 710000 1                  TRA     s:10004
         1 003407   003431 710000 1                  TRA     s:10008

      913    10003    3               CASE ( %HOST );

      914    10004    3                  IF SIZE ~= 36 AND SIZE ~= 72 AND SIZE~=44 AND SIZE~=80

  10004  1 003410   200004 471500                    LDP1    @SIZE,,AUTO
         1 003411   100000 235100                    LDA     0,,PR1
         1 003412   000044 115007                    CMPA    36,DL
         1 003413   003422 600000 1                  TZE     s:10006
         1 003414   000110 115007                    CMPA    72,DL
         1 003415   003422 600000 1                  TZE     s:10006
         1 003416   000054 115007                    CMPA    44,DL
         1 003417   003422 600000 1                  TZE     s:10006
         1 003420   000120 115007                    CMPA    80,DL
         1 003421   003774 601000 1                  TNZ     OCTAL

      915    10005    3                  THEN GOTO OCTAL;
      916    10006    3                  CALL FLOAT(SIZE,VALUE) ALTRET(BADLIB);

  10006  1 003422   200012 633500                    EPPR3   CVALUES,,AUTO
         1 003423   200230 453500                    STP3    @SIZE+1,,AUTO
         1 003424   200004 236100                    LDQ     @SIZE,,AUTO
         1 003425   200227 756100                    STQ     SAVE_EWSQ#+7,,AUTO
         1 003426   011023 701000 1                  TSX1    FLOAT
         1 003427   003435 702000 1                  TSX2    BADLIB
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:157  
         1 003430   003434 710000 1                  TRA     s:10011

      917    10007    3               CASE ( %L6 );

      918    10008    3                  S_D.ERROR = 311; /* E@WRONFEPFMT */

  10008  1 003431   000467 236007                    LDQ     311,DL
         1 003432   000013 756100                    STQ     11,,PR0

      919    10009    3                  GOTO DERR;

  10009  1 003433   010563 710000 1                  TRA     DERR

      920    10010    3               END;

      921    10011    2             RETURN;

  10011  1 003434   000000 702200 xent               TSX2  ! X66_ARET

      922    10012    2   BADLIB:
      923    10013    2             S_D.ERROR = 502;         /* E@DELBUG */

  10013  1 003435   000766 235007       BADLIB       LDA     502,DL
         1 003436   000000 470400 xsym               LDP0    S_D$
         1 003437   000013 755100                    STA     11,,PR0

      924    10014    2             CALL DDE$ERROR;

  10014  1 003440   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 003441   000000 701000 xent               TSX1    DDE$ERROR
         1 003442   000000 011000                    NOP     0

      925    10015    2             RETURN;

  10015  1 003443   000000 702200 xent               TSX2  ! X66_ARET

      926    10016                                                /************************
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:158  
      927    10017                                                 ******* INST_FMT *******
      928    10018                                                 ************************/
      929    10019    2          CASE( %INST_FMT );

      930    10020    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );

  10020  1 003444   000000 470400 xsym               LDP0    S_D$
         1 003445   006714 235100                    LDA     3532,,PR0
         1 003446   000003 115007                    CMPA    3,DL
         1 003447   003451 602005 1                  TNC     s:10020+5,AL
         1 003450   003501 710000 1                  TRA     s:10028
         1 003451   003501 710000 1                  TRA     s:10028
         1 003452   003454 710000 1                  TRA     s:10022
         1 003453   003467 710000 1                  TRA     s:10026

      931    10021    3               CASE ( %HOST );

      932    10022    3                  IF SIZE ~= 36

  10022  1 003454   200004 471500                    LDP1    @SIZE,,AUTO
         1 003455   100000 235100                    LDA     0,,PR1
         1 003456   000044 115007                    CMPA    36,DL
         1 003457   003774 601000 1                  TNZ     OCTAL

      933    10023    3                  THEN GOTO OCTAL;
      934    10024    3                  CALL DDR$INSTR(VALUE.L) ALTRET(DERR);

  10024  1 003460   200012 633500                    EPPR3   CVALUES,,AUTO
         1 003461   200232 453500                    STP3    DIG+1,,AUTO
         1 003462   200232 630500                    EPPR0   DIG+1,,AUTO
         1 003463   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 003464   000000 701000 xent               TSX1    DDR$INSTR
         1 003465   010563 702000 1                  TSX2    DERR
         1 003466   003501 710000 1                  TRA     s:10028

      935    10025    3               CASE ( %L6 );

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:159  
      936    10026    3                  CALL DFR$INSTR ( CVALUES, NCHARS, '1'B ) ALTRET (DERR);

  10026  1 003467   000027 236000 2                  LDQ     23
         1 003470   200234 756100                    STQ     DIG+3,,AUTO
         1 003471   200055 631500                    EPPR1   NCHARS,,AUTO
         1 003472   200233 451500                    STP1    DIG+2,,AUTO
         1 003473   200012 633500                    EPPR3   CVALUES,,AUTO
         1 003474   200232 453500                    STP3    DIG+1,,AUTO
         1 003475   200232 630500                    EPPR0   DIG+1,,AUTO
         1 003476   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 003477   000000 701000 xent               TSX1    DFR$INSTR
         1 003500   010563 702000 1                  TSX2    DERR

      937    10027    3               END;

      938    10028    2             RETURN;

  10028  1 003501   000000 702200 xent               TSX2  ! X66_ARET

      939    10029                                                /***********************
      940    10030                                                 ******* JDE_FMT *******
      941    10031                                                 ***********************/
      942    10032    2          CASE (%JDE_FMT);

      943    10033    2             IF D_XDELTA

  10033  1 003502   000000 234000 xsym               SZN     D_XDELTA
         1 003503   003642 605000 1                  TPL     s:10056

      944    10034    3             THEN DO;

      945    10035    3                  IF SIZE ~= 36 THEN GOTO WRONG_SIZE;

  10035  1 003504   200004 470500                    LDP0    @SIZE,,AUTO
         1 003505   000000 235100                    LDA     0,,PR0
         1 003506   000044 115007                    CMPA    36,DL
         1 003507   010560 601000 1                  TNZ     WRONG_SIZE
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:160  

      946    10036    3                  CALL DDR$BUMPC_D$(12) ALTRET(DERR);

  10036  1 003510   000031 630400 2                  EPPR0   25
         1 003511   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 003512   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 003513   010563 702000 1                  TSX2    DERR

      947    10037    4                  DO I = 0 TO 2;

  10037  1 003514   200111 450100                    STZ     I,,AUTO

      948    10038    4                       IF VALUE.CODE.FCG(I) = 0 THEN TEXT$->CHAR1 = '0';

  10038  1 003515   200111 235100                    LDA     I,,AUTO
         1 003516   000100 101505                    MRL     fill='000'O
         1 003517   200012 020001                    ADSC6   CVALUES,A,AUTO           cn=0,n=1
         1 003520   200232 020006                    ADSC6   DIG+1,,AUTO              cn=0,n=6
         1 003521   200232 236100                    LDQ     DIG+1,,AUTO
         1 003522   000000 116003                    CMPQ    0,DU
         1 003523   003531 601000 1                  TNZ     s:10039

  10038  1 003524   200217 470500                    LDP0    TEXT$,,AUTO
         1 003525   040100 100400                    MLR     fill='040'O
         1 003526   000032 000001 2                  ADSC9   26                       cn=0,n=1
         1 003527   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 003530   003560 710000 1                  TRA     s:10041

      949    10039    4                       ELSE IF VALUE.CODE.FCG(I) < 48 THEN TEXT$->UBIN9 = VALUE.CODE.
             10039                                FCG(I)+64;

  10039  1 003531   000100 101505                    MRL     fill='000'O
         1 003532   200012 020001                    ADSC6   CVALUES,A,AUTO           cn=0,n=1
         1 003533   200232 020006                    ADSC6   DIG+1,,AUTO              cn=0,n=6
         1 003534   200232 236100                    LDQ     DIG+1,,AUTO
         1 003535   000060 116007                    CMPQ    48,DL
         1 003536   003552 605000 1                  TPL     s:10040
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:161  

  10039  1 003537   000100 101505                    MRL     fill='000'O
         1 003540   200012 020001                    ADSC6   CVALUES,A,AUTO           cn=0,n=1
         1 003541   200233 020006                    ADSC6   DIG+2,,AUTO              cn=0,n=6
         1 003542   200233 236100                    LDQ     DIG+2,,AUTO
         1 003543   000100 036007                    ADLQ    64,DL
         1 003544   200232 756100                    STQ     DIG+1,,AUTO
         1 003545   200217 470500                    LDP0    TEXT$,,AUTO
         1 003546   000100 101500                    MRL     fill='000'O
         1 003547   200232 000004                    ADSC9   DIG+1,,AUTO              cn=0,n=4
         1 003550   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 003551   003560 710000 1                  TRA     s:10041

      950    10040    4                            ELSE TEXT$->UBIN9 = VALUE.CODE.FCG(I);

  10040  1 003552   200111 236100                    LDQ     I,,AUTO
         1 003553   000006 402007                    MPY     6,DL
         1 003554   200217 470500                    LDP0    TEXT$,,AUTO
         1 003555   003100 061506                    CSR     bolr='003'O
         1 003556   200012 000006                    BDSC    CVALUES,Q,AUTO           by=0,bit=0,n=6
         1 003557   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9

      951    10041    4                       TEXT$ = PINCRC(TEXT$, 1);

  10041  1 003560   200217 236100                    LDQ     TEXT$,,AUTO
         1 003561   200000 036007                    ADLQ    65536,DL
         1 003562   200217 756100                    STQ     TEXT$,,AUTO

      952    10042    4                     END;                  /* DO I */

  10042  1 003563   200111 235100                    LDA     I,,AUTO
         1 003564   000001 035007                    ADLA    1,DL
         1 003565   200111 755100                    STA     I,,AUTO
         1 003566   000003 115007                    CMPA    3,DL
         1 003567   003515 602000 1                  TNC     s:10038

      953    10043    4                  IF VALUE.CODE.MON THEN DO;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:162  

  10043  1 003570   200012 236100                    LDQ     CVALUES,,AUTO
         1 003571   400000 316007                    CANQ    -131072,DL
         1 003572   003603 600000 1                  TZE     s:10048

      954    10044    4                       TEXT$->CHAR2 = '-M';

  10044  1 003573   200217 470500                    LDP0    TEXT$,,AUTO
         1 003574   040100 100400                    MLR     fill='040'O
         1 003575   000105 000002 0                  ADSC9   HEXCHARS+44              cn=0,n=2
         1 003576   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2

      955    10045    4                       TEXT$ = PINCRC(TEXT$,2);

  10045  1 003577   200217 236100                    LDQ     TEXT$,,AUTO
         1 003600   400000 036007                    ADLQ    -131072,DL
         1 003601   200217 756100                    STQ     TEXT$,,AUTO

      956    10046    4                     END;

  10046  1 003602   003612 710000 1                  TRA     s:10051

      957    10047    4                  ELSE DO;

      958    10048    4                       TEXT$->CHAR1 = '-';

  10048  1 003603   200217 470500                    LDP0    TEXT$,,AUTO
         1 003604   040100 100400                    MLR     fill='040'O
         1 003605   000002 000001 2                  ADSC9   2                        cn=0,n=1
         1 003606   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      959    10049    4                       TEXT$ = PINCRC(TEXT$,1);

  10049  1 003607   200217 236100                    LDQ     TEXT$,,AUTO
         1 003610   200000 036007                    ADLQ    65536,DL
         1 003611   200217 756100                    STQ     TEXT$,,AUTO

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:163  
      960    10050    4                     END;

      961    10051    3                  CALL BINCHAR(TEXT$->CHAR5, VALUE.CODE.ERROR);

  10051  1 003612   200012 236100                    LDQ     CVALUES,,AUTO
         1 003613   000003 772000                    QRL     3
         1 003614   037777 376007                    ANQ     16383,DL
         1 003615   000000 235003                    LDA     0,DU
         1 003616   200232 757100                    STAQ    DIG+1,,AUTO
         1 003617   200217 470500                    LDP0    TEXT$,,AUTO
         1 003620   000100 301500                    BTD
         1 003621   200232 000010                    NDSC9   DIG+1,,AUTO              cn=0,s=lsgnf,sf=0,n=8
         1 003622   000000 030005                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=5

      962    10052    3                  TEXT$ = PINCRC(TEXT$,5);

  10052  1 003623   200217 236100                    LDQ     TEXT$,,AUTO
         1 003624   000020 036000 2                  ADLQ    16
         1 003625   200217 756100                    STQ     TEXT$,,AUTO

      963    10053    3                  TEXT$->CHAR1 = '-';

  10053  1 003626   200217 470500                    LDP0    TEXT$,,AUTO
         1 003627   040100 100400                    MLR     fill='040'O
         1 003630   000002 000001 2                  ADSC9   2                        cn=0,n=1
         1 003631   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      964    10054    3                  CALL BINCHAR(PINCRC(TEXT$,1)->CHAR1, VALUE.CODE.SEV);

  10054  1 003632   200012 236100                    LDQ     CVALUES,,AUTO
         1 003633   000007 376007                    ANQ     7,DL
         1 003634   000000 235003                    LDA     0,DU
         1 003635   200232 757100                    STAQ    DIG+1,,AUTO
         1 003636   000100 301500                    BTD
         1 003637   200232 000010                    NDSC9   DIG+1,,AUTO              cn=0,s=lsgnf,sf=0,n=8
         1 003640   000000 230001                    NDSC9   0,,PR0                   cn=1,s=nosgn,sf=0,n=1

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:164  
      965    10055    3                END;

  10055  1 003641   003723 710000 1                  TRA     s:10071

      966    10056    3             ELSE DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );

  10056  1 003642   000000 470400 xsym               LDP0    S_D$
         1 003643   006714 235100                    LDA     3532,,PR0
         1 003644   000003 115007                    CMPA    3,DL
         1 003645   003647 602005 1                  TNC     s:10056+5,AL
         1 003646   003723 710000 1                  TRA     s:10071
         1 003647   003723 710000 1                  TRA     s:10071
         1 003650   003652 710000 1                  TRA     s:10058
         1 003651   003664 710000 1                  TRA     s:10062

      967    10057    3               CASE ( %HOST );

      968    10058    3                  IF SIZE ~= 36 THEN GOTO WRONG_SIZE;

  10058  1 003652   200004 471500                    LDP1    @SIZE,,AUTO
         1 003653   100000 235100                    LDA     0,,PR1
         1 003654   000044 115007                    CMPA    36,DL
         1 003655   010560 601000 1                  TNZ     WRONG_SIZE

      969    10059    3                  S_D.JDE = VALUE.L;

  10059  1 003656   200012 236100                    LDQ     CVALUES,,AUTO
         1 003657   004733 756100                    STQ     2523,,PR0

      970    10060    3                  CALL DUE$JERRMSG;

  10060  1 003660   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 003661   000000 701000 xent               TSX1    DUE$JERRMSG
         1 003662   000000 011000                    NOP     0
         1 003663   003723 710000 1                  TRA     s:10071

      971    10061    3               CASE ( %L6 );
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:165  

      972    10062    3                  IF SIZE ~= 32 THEN GOTO WRONG_SIZE;

  10062  1 003664   200004 471500                    LDP1    @SIZE,,AUTO
         1 003665   100000 235100                    LDA     0,,PR1
         1 003666   000040 115007                    CMPA    32,DL
         1 003667   010560 601000 1                  TNZ     WRONG_SIZE

      973    10063    3                  HOST_NUVAL = '0'B;

  10063  1 003670   000100 100400                    MLR     fill='000'O
         1 003671   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 003672   200032 000100                    ADSC9   HOST_NUVAL,,AUTO         cn=0,n=64

      974    10064    3                  ERR_VAL.L.F1 = L6_EMSG.F1;

  10064  1 003673   200012 236100                    LDQ     CVALUES,,AUTO
         1 003674   000023 736000                    QLS     19
         1 003675   200032 676100                    ERQ     HOST_NUVAL,,AUTO
         1 003676   377000 376003                    ANQ     130560,DU
         1 003677   200032 656100                    ERSQ    HOST_NUVAL,,AUTO

      975    10065    3                  ERR_VAL.L.F2 = L6_EMSG.F2;

  10065  1 003700   200012 236100                    LDQ     CVALUES,,AUTO
         1 003701   000022 736000                    QLS     18
         1 003702   200032 676100                    ERQ     HOST_NUVAL,,AUTO
         1 003703   000377 376003                    ANQ     255,DU
         1 003704   200032 656100                    ERSQ    HOST_NUVAL,,AUTO

      976    10066    3                  ERR_VAL.L.E1 = L6_EMSG.E1;

  10066  1 003705   200013 236100                    LDQ     CVALUES+1,,AUTO
         1 003706   000001 736000                    QLS     1
         1 003707   200032 676100                    ERQ     HOST_NUVAL,,AUTO
         1 003710   377000 376007                    ANQ     130560,DL
         1 003711   200032 656100                    ERSQ    HOST_NUVAL,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:166  

      977    10067    3                  ERR_VAL.L.E2 = L6_EMSG.E2;

  10067  1 003712   200013 236100                    LDQ     CVALUES+1,,AUTO
         1 003713   200032 676100                    ERQ     HOST_NUVAL,,AUTO
         1 003714   000377 376007                    ANQ     255,DL
         1 003715   200032 656100                    ERSQ    HOST_NUVAL,,AUTO

      978    10068    3                  S_D.JITERR = ERR_VAL.L;

  10068  1 003716   200032 236100                    LDQ     HOST_NUVAL,,AUTO
         1 003717   004733 756100                    STQ     2523,,PR0

      979    10069    3                  CALL DUE$L6JERRMSG;

  10069  1 003720   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 003721   000000 701000 xent               TSX1    DUE$L6JERRMSG
         1 003722   000000 011000                    NOP     0

      980    10070    3               END;

      981    10071    2             RETURN;

  10071  1 003723   000000 702200 xent               TSX2  ! X66_ARET

      982    10072                                                /***************************
      983    10073                                                 ******* LOGFORT_FMT *******
      984    10074                                                 ***************************/
      985    10075    2          CASE( %LOGFORT_FMT );

      986    10076
      987    10077    2             CALL DDR$BUMPC_D$(1) ALTRET(DERR);

  10077  1 003724   000000 630400 2                  EPPR0   0
         1 003725   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 003726   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 003727   010563 702000 1                  TSX2    DERR
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:167  

      988    10078    2             IF VBITS(0)=1

  10078  1 003730   200012 236100                    LDQ     CVALUES,,AUTO
         1 003731   400000 376003                    ANQ     -131072,DU
         1 003732   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 003733   000001 036007                    ADLQ    1,DL
         1 003734   400000 116003                    CMPQ    -131072,DU
         1 003735   003743 601000 1                  TNZ     s:10080

      989    10079    2             THEN TEXT$ -> CHAR1 = 'T';

  10079  1 003736   200217 470500                    LDP0    TEXT$,,AUTO
         1 003737   040100 100400                    MLR     fill='040'O
         1 003740   000033 000001 2                  ADSC9   27                       cn=0,n=1
         1 003741   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 003742   003747 710000 1                  TRA     s:10081

      990    10080    2             ELSE TEXT$ -> CHAR1 = 'F';

  10080  1 003743   200217 470500                    LDP0    TEXT$,,AUTO
         1 003744   040100 100400                    MLR     fill='040'O
         1 003745   000034 000001 2                  ADSC9   28                       cn=0,n=1
         1 003746   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      991    10081    2             RETURN;

  10081  1 003747   000000 702200 xent               TSX2  ! X66_ARET

      992    10082                                                /*********************************
      993    10083                                                 ******* OCT_FMT, ZERO_FMT *******
      994    10084                                                 *********************************/
      995    10085    2          CASE( %OCT_FMT, %ZERO_FMT );

      996    10086
      997    10087    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:168  
  10087  1 003750   000000 470400 xsym               LDP0    S_D$
         1 003751   006714 235100                    LDA     3532,,PR0
         1 003752   000003 115007                    CMPA    3,DL
         1 003753   003755 602005 1                  TNC     s:10087+5,AL
         1 003754   004366 710000 1                  TRA     s:10167
         1 003755   004366 710000 1                  TRA     s:10167
         1 003756   003760 710000 1                  TRA     s:10091
         1 003757   004154 710000 1                  TRA     s:10128

      998    10088
      999    10089    3               CASE ( %HOST );

     1000    10090
     1001    10091    3                  IF FMT = %ZERO_FMT AND MOD ( SIZE, 36 ) ~= 0

  10091  1 003760   200052 236100                    LDQ     FMT,,AUTO
         1 003761   000024 116007                    CMPQ    20,DL
         1 003762   003774 601000 1                  TNZ     OCTAL
         1 003763   200004 471500                    LDP1    @SIZE,,AUTO
         1 003764   100000 236100                    LDQ     0,,PR1
         1 003765   000044 506007                    DIV     36,DL
         1 003766   000044 733000                    LRS     36
         1 003767   000000 116003                    CMPQ    0,DU
         1 003770   003774 600000 1                  TZE     OCTAL

     1002    10092    4                  THEN DO;                 /* Result of star #6266 */

     1003    10093    4                       S_D.ERROR = 249; /* E@SIZE_NOT_WORD */

  10093  1 003771   000371 235007                    LDA     249,DL
         1 003772   000013 755100                    STA     11,,PR0

     1004    10094    4                       GOTO DERR;

  10094  1 003773   010563 710000 1                  TRA     DERR

     1005    10095    4                     END;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:169  
     1006    10096    3   OCTAL:
     1007    10097    3                  J=0;

  10097  1 003774   200112 450100       OCTAL        STZ     J,,AUTO

     1008    10098    4                  DO CASE ( MOD(SIZE, 3) ); /* Reformat */

  10098  1 003775   200004 471500                    LDP1    @SIZE,,AUTO
         1 003776   100000 236100                    LDQ     0,,PR1
         1 003777   000003 506007                    DIV     3,DL
         1 004000   000003 115007                    CMPA    3,DL
         1 004001   004003 602005 1                  TNC     s:10098+6,AL
         1 004002   004123 710000 1                  TRA     s:10119
         1 004003   004006 710000 1                  TRA     s:10100
         1 004004   004034 710000 1                  TRA     s:10106
         1 004005   004070 710000 1                  TRA     s:10112

     1009    10099    4                    CASE (0);

     1010    10100    5                       DO I = 0 TO SIZE/36;

  10100  1 004006   200111 450100                    STZ     I,,AUTO
         1 004007   004022 710000 1                  TRA     s:10103+3

     1011    10101    5                            HOST_NUVAL(J) = HOST_VAL(I);

  10101  1 004010   200111 720100                    LXL0    I,,AUTO
         1 004011   200012 236110                    LDQ     CVALUES,X0,AUTO
         1 004012   200112 721100                    LXL1    J,,AUTO
         1 004013   200032 756111                    STQ     HOST_NUVAL,X1,AUTO

     1012    10102    5                            J = J+1;

  10102  1 004014   200112 235100                    LDA     J,,AUTO
         1 004015   000001 035007                    ADLA    1,DL
         1 004016   200112 755100                    STA     J,,AUTO

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:170  
     1013    10103    5                          END;

  10103  1 004017   200111 235100                    LDA     I,,AUTO
         1 004020   000001 035007                    ADLA    1,DL
         1 004021   200111 755100                    STA     I,,AUTO
         1 004022   200004 470500                    LDP0    @SIZE,,AUTO
         1 004023   000000 236100                    LDQ     0,,PR0
         1 004024   000044 506007                    DIV     36,DL
         1 004025   000000 116003                    CMPQ    0,DU
         1 004026   004031 604000 1                  TMI     s:10104
         1 004027   200111 116100                    CMPQ    I,,AUTO
         1 004030   004010 603000 1                  TRC     s:10101

     1014    10104    4                       NU_SIZE = SIZE;

  10104  1 004031   000000 235100                    LDA     0,,PR0
         1 004032   200053 755100                    STA     NU_SIZE,,AUTO
         1 004033   004123 710000 1                  TRA     s:10119

     1015    10105    4                    CASE (1);

     1016    10106    5                       DO I = 0 TO SIZE/36;

  10106  1 004034   200111 450100                    STZ     I,,AUTO
         1 004035   004055 710000 1                  TRA     s:10109+3

     1017    10107    5                            HOST_NUVAL2.HOST_WRD(J) = HOST_VAL(I);

  10107  1 004036   200111 236100                    LDQ     I,,AUTO
         1 004037   000044 402007                    MPY     36,DL
         1 004040   200232 756100                    STQ     DIG+1,,AUTO
         1 004041   200112 236100                    LDQ     J,,AUTO
         1 004042   000044 402007                    MPY     36,DL
         1 004043   200232 235100                    LDA     DIG+1,,AUTO
         1 004044   003106 060505                    CSL     bolr='003'O
         1 004045   200012 000044                    BDSC    CVALUES,A,AUTO           by=0,bit=0,n=36
         1 004046   200032 020044                    BDSC    HOST_NUVAL,Q,AUTO        by=0,bit=2,n=36
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:171  

     1018    10108    5                            J = J + 1;

  10108  1 004047   200112 235100                    LDA     J,,AUTO
         1 004050   000001 035007                    ADLA    1,DL
         1 004051   200112 755100                    STA     J,,AUTO

     1019    10109    5                          END;

  10109  1 004052   200111 236100                    LDQ     I,,AUTO
         1 004053   000001 036007                    ADLQ    1,DL
         1 004054   200111 756100                    STQ     I,,AUTO
         1 004055   200004 470500                    LDP0    @SIZE,,AUTO
         1 004056   000000 236100                    LDQ     0,,PR0
         1 004057   000044 506007                    DIV     36,DL
         1 004060   000000 116003                    CMPQ    0,DU
         1 004061   004064 604000 1                  TMI     s:10110
         1 004062   200111 116100                    CMPQ    I,,AUTO
         1 004063   004036 603000 1                  TRC     s:10107

     1020    10110    4                       NU_SIZE = SIZE + 2;

  10110  1 004064   000000 235100                    LDA     0,,PR0
         1 004065   000002 035007                    ADLA    2,DL
         1 004066   200053 755100                    STA     NU_SIZE,,AUTO
         1 004067   004123 710000 1                  TRA     s:10119

     1021    10111    4                    CASE (2);

     1022    10112    5                       DO I = 0 TO SIZE/36;

  10112  1 004070   200111 450100                    STZ     I,,AUTO
         1 004071   004111 710000 1                  TRA     s:10115+3

     1023    10113    5                            HOST_NUVAL1.HOST_WRD(J) = HOST_VAL(I);

  10113  1 004072   200111 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:172  
         1 004073   000044 402007                    MPY     36,DL
         1 004074   200232 756100                    STQ     DIG+1,,AUTO
         1 004075   200112 236100                    LDQ     J,,AUTO
         1 004076   000044 402007                    MPY     36,DL
         1 004077   200232 235100                    LDA     DIG+1,,AUTO
         1 004100   003106 060505                    CSL     bolr='003'O
         1 004101   200012 000044                    BDSC    CVALUES,A,AUTO           by=0,bit=0,n=36
         1 004102   200032 010044                    BDSC    HOST_NUVAL,Q,AUTO        by=0,bit=1,n=36

     1024    10114    5                            J = J + 1;

  10114  1 004103   200112 235100                    LDA     J,,AUTO
         1 004104   000001 035007                    ADLA    1,DL
         1 004105   200112 755100                    STA     J,,AUTO

     1025    10115    5                          END;

  10115  1 004106   200111 236100                    LDQ     I,,AUTO
         1 004107   000001 036007                    ADLQ    1,DL
         1 004110   200111 756100                    STQ     I,,AUTO
         1 004111   200004 470500                    LDP0    @SIZE,,AUTO
         1 004112   000000 236100                    LDQ     0,,PR0
         1 004113   000044 506007                    DIV     36,DL
         1 004114   000000 116003                    CMPQ    0,DU
         1 004115   004120 604000 1                  TMI     s:10116
         1 004116   200111 116100                    CMPQ    I,,AUTO
         1 004117   004072 603000 1                  TRC     s:10113

     1026    10116    4                       NU_SIZE = SIZE + 1;

  10116  1 004120   000000 235100                    LDA     0,,PR0
         1 004121   000001 035007                    ADLA    1,DL
         1 004122   200053 755100                    STA     NU_SIZE,,AUTO

     1027    10117    4                    END;

     1028    10118
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:173  
     1029    10119    3                  TEXT$ -> CHAR1 = '.';

  10119  1 004123   200217 470500                    LDP0    TEXT$,,AUTO
         1 004124   040100 100400                    MLR     fill='040'O
         1 004125   000035 000001 2                  ADSC9   29                       cn=0,n=1
         1 004126   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1030    10120    3                  CALL DDR$BUMPC_D$(1) ALTRET (DERR);

  10120  1 004127   000000 630400 2                  EPPR0   0
         1 004130   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 004131   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 004132   010563 702000 1                  TSX2    DERR

     1031    10121    3                  TEXT$ = S_D.D$;

  10121  1 004133   000000 470400 xsym               LDP0    S_D$
         1 004134   000044 236100                    LDQ     36,,PR0
         1 004135   200217 756100                    STQ     TEXT$,,AUTO

     1032    10122    3                  CALL BIN2OCT;

  10122  1 004136   010564 701000 1                  TSX1    BIN2OCT
         1 004137   000000 011000                    NOP     0

     1033    10123    3                  TEXT$-> TEXTR = MYBUF;

  10123  1 004140   200217 470500                    LDP0    TEXT$,,AUTO
         1 004141   200055 720100                    LXL0    NCHARS,,AUTO
         1 004142   040140 100500                    MLR     fill='040'O
         1 004143   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 004144   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

     1034    10124    3                  CALL DDR$BUMPC_D$(NCHARS) ALTRET (DERR);

  10124  1 004145   200055 631500                    EPPR1   NCHARS,,AUTO
         1 004146   200232 451500                    STP1    DIG+1,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:174  
         1 004147   200232 630500                    EPPR0   DIG+1,,AUTO
         1 004150   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 004151   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 004152   010563 702000 1                  TSX2    DERR
         1 004153   004366 710000 1                  TRA     s:10167

     1035    10125
     1036    10126    3               CASE ( %L6 );

     1037    10127
     1038    10128    3                  IF FMT = %ZERO_FMT AND MOD ( SIZE, 16 ) ~= 0

  10128  1 004154   200052 236100                    LDQ     FMT,,AUTO
         1 004155   000024 116007                    CMPQ    20,DL
         1 004156   004170 601000 1                  TNZ     s:10134
         1 004157   200004 471500                    LDP1    @SIZE,,AUTO
         1 004160   100000 236100                    LDQ     0,,PR1
         1 004161   000020 506007                    DIV     16,DL
         1 004162   000044 733000                    LRS     36
         1 004163   000000 116003                    CMPQ    0,DU
         1 004164   004170 600000 1                  TZE     s:10134

     1039    10129    4                  THEN DO;                 /* Result of star #6266 */

     1040    10130    4                       S_D.ERROR = 249; /* E@SIZE_NOT_WORD */

  10130  1 004165   000371 235007                    LDA     249,DL
         1 004166   000013 755100                    STA     11,,PR0

     1041    10131    4                       GOTO DERR;

  10131  1 004167   010563 710000 1                  TRA     DERR

     1042    10132    4                     END;
     1043    10133
     1044    10134    3                  J = 0;

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:175  
  10134  1 004170   200112 450100                    STZ     J,,AUTO

     1045    10135    4                  DO CASE ( MOD ( SIZE, 3 ) );

  10135  1 004171   200004 471500                    LDP1    @SIZE,,AUTO
         1 004172   100000 236100                    LDQ     0,,PR1
         1 004173   000003 506007                    DIV     3,DL
         1 004174   000003 115007                    CMPA    3,DL
         1 004175   004177 602005 1                  TNC     s:10135+6,AL
         1 004176   004316 710000 1                  TRA     s:10155
         1 004177   004202 710000 1                  TRA     s:10137
         1 004200   004233 710000 1                  TRA     s:10143
         1 004201   004265 710000 1                  TRA     s:10149

     1046    10136    4                    CASE(0);

     1047    10137    5                       DO I = 0 TO SIZE/16;

  10137  1 004202   200111 450100                    STZ     I,,AUTO
         1 004203   004221 710000 1                  TRA     s:10140+3

     1048    10138    5                            L6_NUVAL(J) = L6_VAL.L6_WRD(I);

  10138  1 004204   200111 236100                    LDQ     I,,AUTO
         1 004205   000044 402007                    MPY     36,DL
         1 004206   200112 235100                    LDA     J,,AUTO
         1 004207   000004 735000                    ALS     4
         1 004210   003105 060506                    CSL     bolr='003'O
         1 004211   200012 420020                    BDSC    CVALUES,Q,AUTO           by=2,bit=2,n=16
         1 004212   200032 000020                    BDSC    HOST_NUVAL,A,AUTO        by=0,bit=0,n=16

     1049    10139    5                            J = J + 1;

  10139  1 004213   200112 235100                    LDA     J,,AUTO
         1 004214   000001 035007                    ADLA    1,DL
         1 004215   200112 755100                    STA     J,,AUTO

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:176  
     1050    10140    5                          END;

  10140  1 004216   200111 235100                    LDA     I,,AUTO
         1 004217   000001 035007                    ADLA    1,DL
         1 004220   200111 755100                    STA     I,,AUTO
         1 004221   200004 470500                    LDP0    @SIZE,,AUTO
         1 004222   000000 236100                    LDQ     0,,PR0
         1 004223   000020 506007                    DIV     16,DL
         1 004224   000000 116003                    CMPQ    0,DU
         1 004225   004230 604000 1                  TMI     s:10141
         1 004226   200111 116100                    CMPQ    I,,AUTO
         1 004227   004204 603000 1                  TRC     s:10138

     1051    10141    4                       NU_SIZE = SIZE;

  10141  1 004230   000000 235100                    LDA     0,,PR0
         1 004231   200053 755100                    STA     NU_SIZE,,AUTO
         1 004232   004316 710000 1                  TRA     s:10155

     1052    10142    4                    CASE(1);

     1053    10143    5                       DO I = 0 TO SIZE/16 ;

  10143  1 004233   200111 450100                    STZ     I,,AUTO
         1 004234   004252 710000 1                  TRA     s:10146+3

     1054    10144    5                            L6_NUVAL2.L6_WRD(J) = L6_VAL.L6_WRD(I);

  10144  1 004235   200111 236100                    LDQ     I,,AUTO
         1 004236   000044 402007                    MPY     36,DL
         1 004237   200112 235100                    LDA     J,,AUTO
         1 004240   000004 735000                    ALS     4
         1 004241   003105 060506                    CSL     bolr='003'O
         1 004242   200012 420020                    BDSC    CVALUES,Q,AUTO           by=2,bit=2,n=16
         1 004243   200032 020020                    BDSC    HOST_NUVAL,A,AUTO        by=0,bit=2,n=16

     1055    10145    5                            J = J + 1;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:177  

  10145  1 004244   200112 235100                    LDA     J,,AUTO
         1 004245   000001 035007                    ADLA    1,DL
         1 004246   200112 755100                    STA     J,,AUTO

     1056    10146    5                          END;

  10146  1 004247   200111 235100                    LDA     I,,AUTO
         1 004250   000001 035007                    ADLA    1,DL
         1 004251   200111 755100                    STA     I,,AUTO
         1 004252   200004 470500                    LDP0    @SIZE,,AUTO
         1 004253   000000 236100                    LDQ     0,,PR0
         1 004254   000020 506007                    DIV     16,DL
         1 004255   000000 116003                    CMPQ    0,DU
         1 004256   004261 604000 1                  TMI     s:10147
         1 004257   200111 116100                    CMPQ    I,,AUTO
         1 004260   004235 603000 1                  TRC     s:10144

     1057    10147    4                       NU_SIZE = SIZE + 2;

  10147  1 004261   000000 235100                    LDA     0,,PR0
         1 004262   000002 035007                    ADLA    2,DL
         1 004263   200053 755100                    STA     NU_SIZE,,AUTO
         1 004264   004316 710000 1                  TRA     s:10155

     1058    10148    4                    CASE(2);

     1059    10149    5                       DO I = 0 TO SIZE/16;

  10149  1 004265   200111 450100                    STZ     I,,AUTO
         1 004266   004304 710000 1                  TRA     s:10152+3

     1060    10150    5                            L6_NUVAL1.L6_WRD(J) = L6_VAL.L6_WRD(I);

  10150  1 004267   200111 236100                    LDQ     I,,AUTO
         1 004270   000044 402007                    MPY     36,DL
         1 004271   200112 235100                    LDA     J,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:178  
         1 004272   000004 735000                    ALS     4
         1 004273   003105 060506                    CSL     bolr='003'O
         1 004274   200012 420020                    BDSC    CVALUES,Q,AUTO           by=2,bit=2,n=16
         1 004275   200032 010020                    BDSC    HOST_NUVAL,A,AUTO        by=0,bit=1,n=16

     1061    10151    5                            J = J + 1;

  10151  1 004276   200112 235100                    LDA     J,,AUTO
         1 004277   000001 035007                    ADLA    1,DL
         1 004300   200112 755100                    STA     J,,AUTO

     1062    10152    5                          END;

  10152  1 004301   200111 235100                    LDA     I,,AUTO
         1 004302   000001 035007                    ADLA    1,DL
         1 004303   200111 755100                    STA     I,,AUTO
         1 004304   200004 470500                    LDP0    @SIZE,,AUTO
         1 004305   000000 236100                    LDQ     0,,PR0
         1 004306   000020 506007                    DIV     16,DL
         1 004307   000000 116003                    CMPQ    0,DU
         1 004310   004313 604000 1                  TMI     s:10153
         1 004311   200111 116100                    CMPQ    I,,AUTO
         1 004312   004267 603000 1                  TRC     s:10150

     1063    10153    4                       NU_SIZE = SIZE + 1;

  10153  1 004313   000000 235100                    LDA     0,,PR0
         1 004314   000001 035007                    ADLA    1,DL
         1 004315   200053 755100                    STA     NU_SIZE,,AUTO

     1064    10154    4                    END;

     1065    10155    3                  TEXT$ -> CHAR1 = '''';

  10155  1 004316   200217 470500                    LDP0    TEXT$,,AUTO
         1 004317   040100 100400                    MLR     fill='040'O
         1 004320   000011 000001 2                  ADSC9   9                        cn=0,n=1
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:179  
         1 004321   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1066    10156    3                  CALL DDR$BUMPC_D$(1) ALTRET (DERR);

  10156  1 004322   000000 630400 2                  EPPR0   0
         1 004323   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 004324   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 004325   010563 702000 1                  TSX2    DERR

     1067    10157    3                  TEXT$ = S_D.D$;

  10157  1 004326   000000 470400 xsym               LDP0    S_D$
         1 004327   000044 236100                    LDQ     36,,PR0
         1 004330   200217 756100                    STQ     TEXT$,,AUTO

     1068    10158    3                  CALL BIN2OCT;

  10158  1 004331   010564 701000 1                  TSX1    BIN2OCT
         1 004332   000000 011000                    NOP     0

     1069    10159    3                  TEXT$ -> TEXTR = MYBUF;

  10159  1 004333   200217 470500                    LDP0    TEXT$,,AUTO
         1 004334   200055 720100                    LXL0    NCHARS,,AUTO
         1 004335   040140 100500                    MLR     fill='040'O
         1 004336   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 004337   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

     1070    10160    3                  CALL DDR$BUMPC_D$(NCHARS) ALTRET (DERR);

  10160  1 004340   200055 631500                    EPPR1   NCHARS,,AUTO
         1 004341   200232 451500                    STP1    DIG+1,,AUTO
         1 004342   200232 630500                    EPPR0   DIG+1,,AUTO
         1 004343   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 004344   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 004345   010563 702000 1                  TSX2    DERR

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:180  
     1071    10161    3                  TEXT$ = S_D.D$;

  10161  1 004346   000000 470400 xsym               LDP0    S_D$
         1 004347   000044 236100                    LDQ     36,,PR0
         1 004350   200217 756100                    STQ     TEXT$,,AUTO

     1072    10162    3                  NCHARS = 2;

  10162  1 004351   000002 235007                    LDA     2,DL
         1 004352   200055 755100                    STA     NCHARS,,AUTO

     1073    10163    3                  TEXT$ -> TEXTR = '''O';

  10163  1 004353   200217 471500                    LDP1    TEXT$,,AUTO
         1 004354   000000 620005                    EAX0    0,AL
         1 004355   040140 100400                    MLR     fill='040'O
         1 004356   000106 000002 0                  ADSC9   HEXCHARS+45              cn=0,n=2
         1 004357   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

     1074    10164    3                  CALL DDR$BUMPC_D$(NCHARS) ALTRET (DERR);

  10164  1 004360   200055 633500                    EPPR3   NCHARS,,AUTO
         1 004361   200232 453500                    STP3    DIG+1,,AUTO
         1 004362   200232 630500                    EPPR0   DIG+1,,AUTO
         1 004363   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 004364   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 004365   010563 702000 1                  TSX2    DERR

     1075    10165    3               END;

     1076    10166
     1077    10167    2             RETURN;

  10167  1 004366   000000 702200 xent               TSX2  ! X66_ARET

     1078    10168                                                /***********************
     1079    10169                                                 ******* PUP_FMT *******
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:181  
     1080    10170                                                 ***********************/
     1081    10171    2          CASE( %PUP_FMT );

     1082    10172
     1083    10173    2             PUB = PUP.PUB;

  10173  1 004367   200006 470500                    LDP0    @PUP,,AUTO
         1 004370   000000 236100                    LDQ     0,,PR0
         1 004371   000004 772000                    QRL     4
         1 004372   000003 376007                    ANQ     3,DL
         1 004373   200056 756100                    STQ     PUB,,AUTO

     1084    10174    2             SCALE = PUP.SCALE;

  10174  1 004374   000000 236100                    LDQ     0,,PR0
         1 004375   000026 736000                    QLS     22
         1 004376   000034 732000                    QRS     28
         1 004377   200106 756100                    STQ     SCALE,,AUTO

     1085    10175    2             SIGNPOS = PUP.SIGNPOS;

  10175  1 004400   000000 236100                    LDQ     0,,PR0
         1 004401   000002 772000                    QRL     2
         1 004402   000003 376007                    ANQ     3,DL
         1 004403   200103 756100                    STQ     SIGNPOS,,AUTO

     1086    10176    2             SIGNOVER = PUP.SIGNOVER;

  10176  1 004404   000000 236100                    LDQ     0,,PR0
         1 004405   000043 736000                    QLS     35
         1 004406   200104 756100                    STQ     SIGNOVER,,AUTO

     1087    10177    2             CHARTEMP = ZERO;

  10177  1 004407   040100 100400                    MLR     fill='040'O
         1 004410   000000 000100 0                  ADSC9   ZEROES                   cn=0,n=64
         1 004411   200057 000100                    ADSC9   ACHARTEMP,,AUTO          cn=0,n=64
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:182  

     1088    10178    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );

  10178  1 004412   000000 471400 xsym               LDP1    S_D$
         1 004413   106714 235100                    LDA     3532,,PR1
         1 004414   000003 115007                    CMPA    3,DL
         1 004415   004417 602005 1                  TNC     s:10178+5,AL
         1 004416   005340 710000 1                  TRA     s:10359
         1 004417   005340 710000 1                  TRA     s:10359
         1 004420   004422 710000 1                  TRA     s:10180
         1 004421   004647 710000 1                  TRA     s:10249

     1089    10179    3               CASE ( %HOST );

     1090    10180    3                  IF PUB = 2

  10180  1 004422   200056 235100                    LDA     PUB,,AUTO
         1 004423   000002 115007                    CMPA    2,DL
         1 004424   004643 601000 1                  TNZ     s:10246

     1091    10181    4                  THEN DO;                 /* Unpacked number */

     1092    10182    4                       CHARS = SIZE / 9;

  10182  1 004425   200004 473500                    LDP3    @SIZE,,AUTO
         1 004426   300000 236100                    LDQ     0,,PR3
         1 004427   000011 506007                    DIV     9,DL
         1 004430   200100 756100                    STQ     CHARS,,AUTO

     1093    10183    4                       IF SIGNOVER

  10183  1 004431   200104 234100                    SZN     SIGNOVER,,AUTO
         1 004432   004577 605000 1                  TPL     s:10226

     1094    10184    5                       THEN DO;            /* Overpunched sign */

     1095    10185    6                            DO CASE( SIGNPOS );
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:183  

  10185  1 004433   200103 235100                    LDA     SIGNPOS,,AUTO
         1 004434   000003 115007                    CMPA    3,DL
         1 004435   004437 602005 1                  TNC     s:10185+4,AL
         1 004436   004467 710000 1                  TRA     s:10196
         1 004437   004467 710000 1                  TRA     s:10196
         1 004440   004442 710000 1                  TRA     s:10188
         1 004441   004456 710000 1                  TRA     s:10192

     1096    10186    6                              CASE( 0, 3 ); /* Not valid */

     1097    10187    6                              CASE( 1 );   /* Leading sign */

     1098    10188    6                                 SCHAR = CVALUE( 0 );

  10188  1 004442   200012 236100                    LDQ     CVALUES,,AUTO
         1 004443   777000 376003                    ANQ     -512,DU
         1 004444   000036 276000 2                  ORQ     30
         1 004445   200101 756100                    STQ     SCHAR,,AUTO

     1099    10189    6                                 CALL INSERT(CHARTEMP, 64 - CHARS, CHARS - 1,

  10189  1 004446   200100 720100                    LXL0    CHARS,,AUTO
         1 004447   777777 621010                    EAX1    -1,X0
         1 004450   000000 235003                    LDA     0,DU
         1 004451   200100 135100                    SBLA    CHARS,,AUTO
         1 004452   040145 100540                    MLR     fill='040'O
         1 004453   200012 200011                    ADSC9   CVALUES,,AUTO            cn=1,n=*X1
         1 004454   200077 000011                    ADSC9   TEMP,A,AUTO              cn=0,n=*X1
         1 004455   004467 710000 1                  TRA     s:10196

     1100    10190    6                                   SUBSTR(CVALUES, 1, CHARS - 1));
     1101    10191    6                              CASE( 2 );   /* Trailing sign */

     1102    10192    6                                 SCHAR  = CVALUE( CHARS - 1 );

  10192  1 004456   040100 100506                    MLR     fill='040'O
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:184  
         1 004457   200011 600001                    ADSC9   NO_UDEFS,Q,AUTO          cn=3,n=1
         1 004460   200101 000001                    ADSC9   SCHAR,,AUTO              cn=0,n=1

     1103    10193    6                                 CALL INSERT(CHARTEMP, 63 - CHARS, CHARS - 1,

  10193  1 004461   777777 620006                    EAX0    -1,QL
         1 004462   000000 235003                    LDA     0,DU
         1 004463   200100 135100                    SBLA    CHARS,,AUTO
         1 004464   040145 100540                    MLR     fill='040'O
         1 004465   200012 000010                    ADSC9   CVALUES,,AUTO            cn=0,n=*X0
         1 004466   200076 600010                    ADSC9   ACHARTEMP+15,A,AUTO      cn=3,n=*X0

     1104    10194    6                                   SUBSTR(CVALUES, 0, CHARS - 1));
     1105    10195    6                              END;         /* DO CASE( SIGNPOS ) */

     1106    10196    5                            CALL INDEX(TEMP, SCHAR, DIGITS);

  10196  1 004467   000100 124400                    SCM     mask='000'O
         1 004470   000024 000012 0                  ADSC9   DIGITS                   cn=0,n=10
         1 004471   200101 000001                    ADSC9   SCHAR,,AUTO              cn=0,n=1
         1 004472   200077 000100                    ARG     TEMP,,AUTO

     1107    10197    5                            IF TEMP < LENGTHC(DIGITS)

  10197  1 004473   200077 235100                    LDA     TEMP,,AUTO
         1 004474   000012 115007                    CMPA    10,DL
         1 004475   004606 602000 1                  TNC     UNSIGNED1

     1108    10198    5                            THEN GOTO UNSIGNED1;
     1109    10199    5                            IF SCHAR = ' ' OR SCHAR = BITASC('173'O) /* '{' */

  10199  1 004476   200101 236100                    LDQ     SCHAR,,AUTO
         1 004477   777000 376003                    ANQ     -512,DU
         1 004500   040000 116003                    CMPQ    16384,DU
         1 004501   004506 600000 1                  TZE     s:10201
         1 004502   200101 236100                    LDQ     SCHAR,,AUTO
         1 004503   777000 376003                    ANQ     -512,DU
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:185  
         1 004504   173000 116003                    CMPQ    62976,DU
         1 004505   004513 601000 1                  TNZ     s:10204

     1110    10200    6                            THEN DO;

     1111    10201    6                                 SCHAR = '+';

  10201  1 004506   053000 236003                    LDQ     22016,DU
         1 004507   200101 756100                    STQ     SCHAR,,AUTO

     1112    10202    6                                 SDIGIT = '0';

  10202  1 004510   060000 236003                    LDQ     24576,DU
         1 004511   200102 756100                    STQ     SDIGIT,,AUTO

     1113    10203    6                               END;

  10203  1 004512   004560 710000 1                  TRA     s:10221

     1114    10204    5                            ELSE IF SCHAR = BITASC('175'O) /* '}' */

  10204  1 004513   200101 236100                    LDQ     SCHAR,,AUTO
         1 004514   777000 376003                    ANQ     -512,DU
         1 004515   175000 116003                    CMPQ    64000,DU
         1 004516   004524 601000 1                  TNZ     s:10210

     1115    10205    6                                 THEN DO;

     1116    10206    6                                      SCHAR = '-';

  10206  1 004517   055000 236003                    LDQ     23040,DU
         1 004520   200101 756100                    STQ     SCHAR,,AUTO

     1117    10207    6                                      SDIGIT = '0';

  10207  1 004521   060000 236003                    LDQ     24576,DU
         1 004522   200102 756100                    STQ     SDIGIT,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:186  

     1118    10208    6                                    END;

  10208  1 004523   004560 710000 1                  TRA     s:10221

     1119    10209    6                                 ELSE DO;  /* Not ' ', '{' or '}' */

     1120    10210    6                                      TEMP = ASCBIN(SCHAR) - BITBIN('100'O);

  10210  1 004524   200101 236100                    LDQ     SCHAR,,AUTO
         1 004525   000033 772000                    QRL     27
         1 004526   000100 136007                    SBLQ    64,DL
         1 004527   200077 756100                    STQ     TEMP,,AUTO

     1121    10211    6                                      IF TEMP > 9

  10211  1 004530   000012 116007                    CMPQ    10,DL
         1 004531   004546 602000 1                  TNC     s:10217

     1122    10212    7                                      THEN DO; /* Negative number */

     1123    10213    7                                           SCHAR = '-';

  10213  1 004532   055000 236003                    LDQ     23040,DU
         1 004533   200101 756100                    STQ     SCHAR,,AUTO

     1124    10214    7                                           SDIGIT = BITASC(ASCBIT('0') | BINBIT(TEMP -
             10214                                                    9, 9));

  10214  1 004534   200077 236100                    LDQ     TEMP,,AUTO
         1 004535   000011 136007                    SBLQ    9,DL
         1 004536   000033 736000                    QLS     27
         1 004537   000022 772000                    QRL     18
         1 004540   000000 620006                    EAX0    0,QL
         1 004541   060000 260003                    ORX0    24576,DU
         1 004542   000000 636010                    EAQ     0,X0
         1 004543   000036 276000 2                  ORQ     30
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:187  
         1 004544   200102 756100                    STQ     SDIGIT,,AUTO

     1125    10215    7                                         END;

  10215  1 004545   004560 710000 1                  TRA     s:10221

     1126    10216    7                                      ELSE DO; /* Positive number */

     1127    10217    7                                           SCHAR = '+';

  10217  1 004546   053000 236003                    LDQ     22016,DU
         1 004547   200101 756100                    STQ     SCHAR,,AUTO

     1128    10218    7                                          SDIGIT = BITASC(ASCBIT('0') | BINBIT(TEMP, 9
             10218                                                    ));

  10218  1 004550   200077 236100                    LDQ     TEMP,,AUTO
         1 004551   000033 736000                    QLS     27
         1 004552   000022 772000                    QRL     18
         1 004553   000000 620006                    EAX0    0,QL
         1 004554   060000 260003                    ORX0    24576,DU
         1 004555   000000 636010                    EAQ     0,X0
         1 004556   000036 276000 2                  ORQ     30
         1 004557   200102 756100                    STQ     SDIGIT,,AUTO

     1129    10219    7                                         END;

     1130    10220    6                                    END;   /* Not ' ', '{', or '}' */

     1131    10221    5                            ACHARTEMP( 0 ) = SCHAR;

  10221  1 004560   200101 236100                    LDQ     SCHAR,,AUTO
         1 004561   200057 552140                    STBQ    ACHARTEMP,'40'O,AUTO

     1132    10222    5                            IF SIGNPOS = 1

  10222  1 004562   200103 235100                    LDA     SIGNPOS,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:188  
         1 004563   000001 115007                    CMPA    1,DL
         1 004564   004573 601000 1                  TNZ     s:10224

     1133    10223    5                            THEN ACHARTEMP( 63 - CHARS ) = SDIGIT; /* Leading sign */

  10223  1 004565   000000 235003                    LDA     0,DU
         1 004566   200100 135100                    SBLA    CHARS,,AUTO
         1 004567   040105 100500                    MLR     fill='040'O
         1 004570   200102 000001                    ADSC9   SDIGIT,,AUTO             cn=0,n=1
         1 004571   200076 600001                    ADSC9   ACHARTEMP+15,A,AUTO      cn=3,n=1
         1 004572   005340 710000 1                  TRA     s:10359

     1134    10224    5                            ELSE ACHARTEMP( 62 ) = SDIGIT; /* Trailing sign */

  10224  1 004573   200102 236100                    LDQ     SDIGIT,,AUTO
         1 004574   000022 772000                    QRL     18
         1 004575   200076 552110                    STBQ    ACHARTEMP+15,'10'O,AUTO

     1135    10225    5                          END;             /* DO (IF SIGNOVER) */

  10225  1 004576   005340 710000 1                  TRA     s:10359

     1136    10226    5                       ELSE DO CASE( SIGNPOS ); /* Not overpunched sign */

  10226  1 004577   200103 235100                    LDA     SIGNPOS,,AUTO
         1 004600   000003 115007                    CMPA    3,DL
         1 004601   004603 602005 1                  TNC     s:10226+4,AL
         1 004602   005340 710000 1                  TRA     s:10359
         1 004603   004606 710000 1                  TRA     UNSIGNED1
         1 004604   004617 710000 1                  TRA     s:10233
         1 004605   004631 710000 1                  TRA     s:10237

     1137    10227    5                         CASE( 3 );        /* Not valid */

     1138    10228    5                         CASE( 0 );        /* Unsigned */

  10224  1 004606                       UNSIGNED1    null
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:189  
     1139    10229    5   UNSIGNED1:               ;
     1140    10230    5                            ACHARTEMP( 0 ) = '+';

  10230  1 004606   053000 236003                    LDQ     22016,DU
         1 004607   200057 552140                    STBQ    ACHARTEMP,'40'O,AUTO

     1141    10231    5                            CALL INSERT(CHARTEMP, 63 - CHARS, CHARS, CVALUES);

  10231  1 004610   000000 235003                    LDA     0,DU
         1 004611   200100 135100                    SBLA    CHARS,,AUTO
         1 004612   200100 720100                    LXL0    CHARS,,AUTO
         1 004613   040145 100500                    MLR     fill='040'O
         1 004614   200012 000100                    ADSC9   CVALUES,,AUTO            cn=0,n=64
         1 004615   200076 600010                    ADSC9   ACHARTEMP+15,A,AUTO      cn=3,n=*X0
         1 004616   005340 710000 1                  TRA     s:10359

     1142    10232    5                         CASE( 1 );        /* Leading sign */

     1143    10233    5                            ACHARTEMP( 0 ) = CVALUE( 0 );

  10233  1 004617   200012 236100                    LDQ     CVALUES,,AUTO
         1 004620   200057 552140                    STBQ    ACHARTEMP,'40'O,AUTO

     1144    10234    5                            CALL INSERT(CHARTEMP, 64 - CHARS, CHARS - 1,

  10234  1 004621   200100 720100                    LXL0    CHARS,,AUTO
         1 004622   777777 621010                    EAX1    -1,X0
         1 004623   000000 235003                    LDA     0,DU
         1 004624   200100 135100                    SBLA    CHARS,,AUTO
         1 004625   040145 100500                    MLR     fill='040'O
         1 004626   200012 200077                    ADSC9   CVALUES,,AUTO            cn=1,n=63
         1 004627   200077 000011                    ADSC9   TEMP,A,AUTO              cn=0,n=*X1
         1 004630   005340 710000 1                  TRA     s:10359

     1145    10235    5                              SUBSTR(CVALUES, 1));
     1146    10236    5                         CASE( 2 );        /* Trailing sign */

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:190  
     1147    10237    5                            ACHARTEMP( 0 ) = CVALUE( CHARS - 1 );

  10237  1 004631   040100 100506                    MLR     fill='040'O
         1 004632   200011 600001                    ADSC9   NO_UDEFS,Q,AUTO          cn=3,n=1
         1 004633   200057 000001                    ADSC9   ACHARTEMP,,AUTO          cn=0,n=1

     1148    10238    5                            CALL INSERT(CHARTEMP, 64 - CHARS, CHARS - 1,CVALUES);

  10238  1 004634   777777 620006                    EAX0    -1,QL
         1 004635   000000 235003                    LDA     0,DU
         1 004636   200100 135100                    SBLA    CHARS,,AUTO
         1 004637   040145 100500                    MLR     fill='040'O
         1 004640   200012 000100                    ADSC9   CVALUES,,AUTO            cn=0,n=64
         1 004641   200077 000010                    ADSC9   TEMP,A,AUTO              cn=0,n=*X0

     1149    10239    5                         END;         /* DO CASE( SIGNPOS ) - not overpunched */

     1150    10240    4                     END;                  /* PUB = 2 - unpacked number */

  10240  1 004642   005340 710000 1                  TRA     s:10359

     1151    10241    4                  ELSE DO;                 /* Packed decimal number */

     1152    10242                                                /*
     1153    10243                                                Do nothing, all ready in unpacked form
     1154    10244                                                by DDK$GETV_A
     1155    10245                                                */
     1156    10246    4                       CHARTEMP = CVALUES;

  10246  1 004643   040100 100500                    MLR     fill='040'O
         1 004644   200012 000100                    ADSC9   CVALUES,,AUTO            cn=0,n=64
         1 004645   200057 000100                    ADSC9   ACHARTEMP,,AUTO          cn=0,n=64

     1157    10247    4                     END;                  /* DO - packed decimal number */

  10247  1 004646   005340 710000 1                  TRA     s:10359

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:191  
     1158    10248    3               CASE ( %L6 );

     1159    10249    3                  IF PUB = 2

  10249  1 004647   200056 235100                    LDA     PUB,,AUTO
         1 004650   000002 115007                    CMPA    2,DL
         1 004651   005144 601000 1                  TNZ     s:10324

     1160    10250    4                  THEN DO;                 /* Unpacked number */

     1161    10251    4                       IF SIZE > 8 * 31    /* Can have a maximum of 31 bytes*/

  10251  1 004652   200004 473500                    LDP3    @SIZE,,AUTO
         1 004653   300000 235100                    LDA     0,,PR3
         1 004654   000370 115007                    CMPA    248,DL
         1 004655   004664 604400 1                  TMOZ    s:10257

     1162    10252    5                       THEN DO;

     1163    10253    5                            S_D.ERROR = 46; /* E@TOOLARGE */

  10253  1 004656   000056 235007                    LDA     46,DL
         1 004657   100013 755100                    STA     11,,PR1

     1164    10254    5                            CALL DDE$ERROR;

  10254  1 004660   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 004661   000000 701000 xent               TSX1    DDE$ERROR
         1 004662   000000 011000                    NOP     0

     1165    10255    5                            ALTRETURN;

  10255  1 004663   000000 702200 xent               TSX2  ! X66_AALT

     1166    10256    5                          END;
     1167    10257    4                       CHARS = SIZE / 8;

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:192  
  10257  1 004664   300000 236100                    LDQ     0,,PR3
         1 004665   000010 506007                    DIV     8,DL
         1 004666   200100 756100                    STQ     CHARS,,AUTO

     1168    10258    4                       J = 0;

  10258  1 004667   200112 450100                    STZ     J,,AUTO

     1169    10259    5                       DO I = 0 TO CHARS / 2; /* Reformat into 9 bits char */

  10259  1 004670   200111 450100                    STZ     I,,AUTO
         1 004671   004724 710000 1                  TRA     s:10264+3

     1170    10260    5                            HOST_NUCHAR ( J ) = BINASC ( L6_UPDEC.L ( I ) );

  10260  1 004672   200111 720100                    LXL0    I,,AUTO
         1 004673   200012 236110                    LDQ     CVALUES,X0,AUTO
         1 004674   000010 772000                    QRL     8
         1 004675   000377 376007                    ANQ     255,DL
         1 004676   000033 736000                    QLS     27
         1 004677   000036 276000 2                  ORQ     30
         1 004700   200232 756100                    STQ     DIG+1,,AUTO
         1 004701   200112 235100                    LDA     J,,AUTO
         1 004702   040105 100500                    MLR     fill='040'O
         1 004703   200232 000004                    ADSC9   DIG+1,,AUTO              cn=0,n=4
         1 004704   200032 000001                    ADSC9   HOST_NUVAL,A,AUTO        cn=0,n=1

     1171    10261    5                            J = J + 1;

  10261  1 004705   000001 035007                    ADLA    1,DL
         1 004706   200112 755100                    STA     J,,AUTO

     1172    10262    5                            HOST_NUCHAR ( J ) = BINASC ( L6_UPDEC.R ( I ) );

  10262  1 004707   200012 236110                    LDQ     CVALUES,X0,AUTO
         1 004710   000377 376007                    ANQ     255,DL
         1 004711   000033 736000                    QLS     27
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:193  
         1 004712   000036 276000 2                  ORQ     30
         1 004713   200232 756100                    STQ     DIG+1,,AUTO
         1 004714   040105 100500                    MLR     fill='040'O
         1 004715   200232 000004                    ADSC9   DIG+1,,AUTO              cn=0,n=4
         1 004716   200032 000001                    ADSC9   HOST_NUVAL,A,AUTO        cn=0,n=1

     1173    10263    5                            J = J + 1;

  10263  1 004717   000001 035007                    ADLA    1,DL
         1 004720   200112 755100                    STA     J,,AUTO

     1174    10264    5                          END;

  10264  1 004721   200111 236100                    LDQ     I,,AUTO
         1 004722   000001 036007                    ADLQ    1,DL
         1 004723   200111 756100                    STQ     I,,AUTO
         1 004724   200100 236100                    LDQ     CHARS,,AUTO
         1 004725   000001 772000                    QRL     1
         1 004726   200111 116100                    CMPQ    I,,AUTO
         1 004727   004672 603000 1                  TRC     s:10260

     1175    10265    4                       IF SIGNOVER

  10265  1 004730   200104 234100                    SZN     SIGNOVER,,AUTO
         1 004731   005077 605000 1                  TPL     s:10308

     1176    10266    5                       THEN DO;            /* Overpunched sign */

     1177    10267    6                            DO CASE( SIGNPOS );

  10267  1 004732   200103 235100                    LDA     SIGNPOS,,AUTO
         1 004733   000003 115007                    CMPA    3,DL
         1 004734   004736 602005 1                  TNC     s:10267+4,AL
         1 004735   004767 710000 1                  TRA     s:10278
         1 004736   004767 710000 1                  TRA     s:10278
         1 004737   004741 710000 1                  TRA     s:10270
         1 004740   004755 710000 1                  TRA     s:10274
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:194  

     1178    10268    6                              CASE( 0, 3 ); /* Not valid */

     1179    10269    6                              CASE( 1 );   /* Leading sign */

     1180    10270    6                                 SCHAR = HOST_NUCHAR( 0 );

  10270  1 004741   200032 236100                    LDQ     HOST_NUVAL,,AUTO
         1 004742   777000 376003                    ANQ     -512,DU
         1 004743   000036 276000 2                  ORQ     30
         1 004744   200101 756100                    STQ     SCHAR,,AUTO

     1181    10271    6                                 CALL INSERT(CHARTEMP, 64 - CHARS, CHARS - 1,

  10271  1 004745   200100 720100                    LXL0    CHARS,,AUTO
         1 004746   777777 621010                    EAX1    -1,X0
         1 004747   000000 235003                    LDA     0,DU
         1 004750   200100 135100                    SBLA    CHARS,,AUTO
         1 004751   040145 100540                    MLR     fill='040'O
         1 004752   200032 200011                    ADSC9   HOST_NUVAL,,AUTO         cn=1,n=*X1
         1 004753   200077 000011                    ADSC9   TEMP,A,AUTO              cn=0,n=*X1
         1 004754   004767 710000 1                  TRA     s:10278

     1182    10272    6                                   SUBSTR(HOST_NUCHARS, 1, CHARS - 1));
     1183    10273    6                              CASE( 2 );   /* Trailing sign */

     1184    10274    6                                 SCHAR  = HOST_NUCHAR( CHARS - 1 );

  10274  1 004755   200100 236100                    LDQ     CHARS,,AUTO
         1 004756   040100 100506                    MLR     fill='040'O
         1 004757   200031 600001                    ADSC9   CVALUES+15,Q,AUTO        cn=3,n=1
         1 004760   200101 000001                    ADSC9   SCHAR,,AUTO              cn=0,n=1

     1185    10275    6                                 CALL INSERT(CHARTEMP, 63 - CHARS, CHARS - 1,

  10275  1 004761   777777 620006                    EAX0    -1,QL
         1 004762   000000 235003                    LDA     0,DU
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:195  
         1 004763   200100 135100                    SBLA    CHARS,,AUTO
         1 004764   040145 100540                    MLR     fill='040'O
         1 004765   200032 000010                    ADSC9   HOST_NUVAL,,AUTO         cn=0,n=*X0
         1 004766   200076 600010                    ADSC9   ACHARTEMP+15,A,AUTO      cn=3,n=*X0

     1186    10276    6                                   SUBSTR(HOST_NUCHARS, 0, CHARS - 1));
     1187    10277    6                              END;         /* DO CASE( SIGNPOS ) */

     1188    10278    5                            CALL INDEX(TEMP, SCHAR, DIGITS);

  10278  1 004767   000100 124400                    SCM     mask='000'O
         1 004770   000024 000012 0                  ADSC9   DIGITS                   cn=0,n=10
         1 004771   200101 000001                    ADSC9   SCHAR,,AUTO              cn=0,n=1
         1 004772   200077 000100                    ARG     TEMP,,AUTO

     1189    10279    5                            IF TEMP < LENGTHC(DIGITS)

  10279  1 004773   200077 235100                    LDA     TEMP,,AUTO
         1 004774   000012 115007                    CMPA    10,DL
         1 004775   005106 602000 1                  TNC     UNSIGNED2

     1190    10280    5                            THEN GOTO UNSIGNED2;
     1191    10281    5                            IF SCHAR = ' ' OR SCHAR = BITASC('173'O) /* '{' */

  10281  1 004776   200101 236100                    LDQ     SCHAR,,AUTO
         1 004777   777000 376003                    ANQ     -512,DU
         1 005000   040000 116003                    CMPQ    16384,DU
         1 005001   005006 600000 1                  TZE     s:10283
         1 005002   200101 236100                    LDQ     SCHAR,,AUTO
         1 005003   777000 376003                    ANQ     -512,DU
         1 005004   173000 116003                    CMPQ    62976,DU
         1 005005   005013 601000 1                  TNZ     s:10286

     1192    10282    6                            THEN DO;

     1193    10283    6                                 SCHAR = '+';

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:196  
  10283  1 005006   053000 236003                    LDQ     22016,DU
         1 005007   200101 756100                    STQ     SCHAR,,AUTO

     1194    10284    6                                 SDIGIT = '0';

  10284  1 005010   060000 236003                    LDQ     24576,DU
         1 005011   200102 756100                    STQ     SDIGIT,,AUTO

     1195    10285    6                               END;

  10285  1 005012   005060 710000 1                  TRA     s:10303

     1196    10286    5                            ELSE IF SCHAR = BITASC('175'O) /* '}' */

  10286  1 005013   200101 236100                    LDQ     SCHAR,,AUTO
         1 005014   777000 376003                    ANQ     -512,DU
         1 005015   175000 116003                    CMPQ    64000,DU
         1 005016   005024 601000 1                  TNZ     s:10292

     1197    10287    6                                 THEN DO;

     1198    10288    6                                      SCHAR = '-';

  10288  1 005017   055000 236003                    LDQ     23040,DU
         1 005020   200101 756100                    STQ     SCHAR,,AUTO

     1199    10289    6                                      SDIGIT = '0';

  10289  1 005021   060000 236003                    LDQ     24576,DU
         1 005022   200102 756100                    STQ     SDIGIT,,AUTO

     1200    10290    6                                    END;

  10290  1 005023   005060 710000 1                  TRA     s:10303

     1201    10291    6                                 ELSE DO;  /* Not ' ', '{' or '}' */

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:197  
     1202    10292    6                                      TEMP = ASCBIN(SCHAR) - BITBIN('100'O);

  10292  1 005024   200101 236100                    LDQ     SCHAR,,AUTO
         1 005025   000033 772000                    QRL     27
         1 005026   000100 136007                    SBLQ    64,DL
         1 005027   200077 756100                    STQ     TEMP,,AUTO

     1203    10293    6                                      IF TEMP > 9

  10293  1 005030   000012 116007                    CMPQ    10,DL
         1 005031   005046 602000 1                  TNC     s:10299

     1204    10294    7                                      THEN DO; /* Negative number */

     1205    10295    7                                           SCHAR = '-';

  10295  1 005032   055000 236003                    LDQ     23040,DU
         1 005033   200101 756100                    STQ     SCHAR,,AUTO

     1206    10296    7                                           SDIGIT = BITASC(ASCBIT('0') | BINBIT(TEMP -
             10296                                                    9, 9));

  10296  1 005034   200077 236100                    LDQ     TEMP,,AUTO
         1 005035   000011 136007                    SBLQ    9,DL
         1 005036   000033 736000                    QLS     27
         1 005037   000022 772000                    QRL     18
         1 005040   000000 620006                    EAX0    0,QL
         1 005041   060000 260003                    ORX0    24576,DU
         1 005042   000000 636010                    EAQ     0,X0
         1 005043   000036 276000 2                  ORQ     30
         1 005044   200102 756100                    STQ     SDIGIT,,AUTO

     1207    10297    7                                         END;

  10297  1 005045   005060 710000 1                  TRA     s:10303

     1208    10298    7                                      ELSE DO; /* Positive number */
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:198  

     1209    10299    7                                           SCHAR = '+';

  10299  1 005046   053000 236003                    LDQ     22016,DU
         1 005047   200101 756100                    STQ     SCHAR,,AUTO

     1210    10300    7                                          SDIGIT = BITASC(ASCBIT('0') | BINBIT(TEMP, 9
             10300                                                    ));

  10300  1 005050   200077 236100                    LDQ     TEMP,,AUTO
         1 005051   000033 736000                    QLS     27
         1 005052   000022 772000                    QRL     18
         1 005053   000000 620006                    EAX0    0,QL
         1 005054   060000 260003                    ORX0    24576,DU
         1 005055   000000 636010                    EAQ     0,X0
         1 005056   000036 276000 2                  ORQ     30
         1 005057   200102 756100                    STQ     SDIGIT,,AUTO

     1211    10301    7                                         END;

     1212    10302    6                                    END;   /* Not ' ', '{', or '}' */

     1213    10303    5                            ACHARTEMP( 0 ) = SCHAR;

  10303  1 005060   200101 236100                    LDQ     SCHAR,,AUTO
         1 005061   200057 552140                    STBQ    ACHARTEMP,'40'O,AUTO

     1214    10304    5                            IF SIGNPOS = 1

  10304  1 005062   200103 235100                    LDA     SIGNPOS,,AUTO
         1 005063   000001 115007                    CMPA    1,DL
         1 005064   005073 601000 1                  TNZ     s:10306

     1215    10305    5                            THEN ACHARTEMP( 63 - CHARS ) = SDIGIT; /* Leading sign */

  10305  1 005065   000000 235003                    LDA     0,DU
         1 005066   200100 135100                    SBLA    CHARS,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:199  
         1 005067   040105 100500                    MLR     fill='040'O
         1 005070   200102 000001                    ADSC9   SDIGIT,,AUTO             cn=0,n=1
         1 005071   200076 600001                    ADSC9   ACHARTEMP+15,A,AUTO      cn=3,n=1
         1 005072   005340 710000 1                  TRA     s:10359

     1216    10306    5                            ELSE ACHARTEMP( 62 ) = SDIGIT; /* Trailing sign */

  10306  1 005073   200102 236100                    LDQ     SDIGIT,,AUTO
         1 005074   000022 772000                    QRL     18
         1 005075   200076 552110                    STBQ    ACHARTEMP+15,'10'O,AUTO

     1217    10307    5                          END;             /* DO (IF SIGNOVER) */

  10307  1 005076   005340 710000 1                  TRA     s:10359

     1218    10308    5                       ELSE DO CASE( SIGNPOS ); /* Not overpunched sign */

  10308  1 005077   200103 235100                    LDA     SIGNPOS,,AUTO
         1 005100   000003 115007                    CMPA    3,DL
         1 005101   005103 602005 1                  TNC     s:10308+4,AL
         1 005102   005340 710000 1                  TRA     s:10359
         1 005103   005106 710000 1                  TRA     UNSIGNED2
         1 005104   005117 710000 1                  TRA     s:10315
         1 005105   005131 710000 1                  TRA     s:10319

     1219    10309    5                         CASE( 3 );        /* Not valid */

     1220    10310    5                         CASE( 0 );        /* Unsigned */

  10306  1 005106                       UNSIGNED2    null
     1221    10311    5   UNSIGNED2:               ;
     1222    10312    5                            ACHARTEMP( 0 ) = '+';

  10312  1 005106   053000 236003                    LDQ     22016,DU
         1 005107   200057 552140                    STBQ    ACHARTEMP,'40'O,AUTO

     1223    10313    5                            CALL INSERT(CHARTEMP, 63 - CHARS, CHARS, HOST_NUCHARS);
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:200  

  10313  1 005110   000000 235003                    LDA     0,DU
         1 005111   200100 135100                    SBLA    CHARS,,AUTO
         1 005112   200100 720100                    LXL0    CHARS,,AUTO
         1 005113   040145 100500                    MLR     fill='040'O
         1 005114   200032 000100                    ADSC9   HOST_NUVAL,,AUTO         cn=0,n=64
         1 005115   200076 600010                    ADSC9   ACHARTEMP+15,A,AUTO      cn=3,n=*X0
         1 005116   005340 710000 1                  TRA     s:10359

     1224    10314    5                         CASE( 1 );        /* Leading sign */

     1225    10315    5                            ACHARTEMP( 0 ) = HOST_NUCHAR( 0 );

  10315  1 005117   200032 236100                    LDQ     HOST_NUVAL,,AUTO
         1 005120   200057 552140                    STBQ    ACHARTEMP,'40'O,AUTO

     1226    10316    5                            CALL INSERT(CHARTEMP, 64 - CHARS, CHARS - 1,

  10316  1 005121   200100 720100                    LXL0    CHARS,,AUTO
         1 005122   777777 621010                    EAX1    -1,X0
         1 005123   000000 235003                    LDA     0,DU
         1 005124   200100 135100                    SBLA    CHARS,,AUTO
         1 005125   040145 100500                    MLR     fill='040'O
         1 005126   200032 200077                    ADSC9   HOST_NUVAL,,AUTO         cn=1,n=63
         1 005127   200077 000011                    ADSC9   TEMP,A,AUTO              cn=0,n=*X1
         1 005130   005340 710000 1                  TRA     s:10359

     1227    10317    5                              SUBSTR(HOST_NUCHARS, 1));
     1228    10318    5                         CASE( 2 );        /* Trailing sign */

     1229    10319    5                            ACHARTEMP( 0 ) = HOST_NUCHAR( CHARS - 1 );

  10319  1 005131   200100 236100                    LDQ     CHARS,,AUTO
         1 005132   040100 100506                    MLR     fill='040'O
         1 005133   200031 600001                    ADSC9   CVALUES+15,Q,AUTO        cn=3,n=1
         1 005134   200057 000001                    ADSC9   ACHARTEMP,,AUTO          cn=0,n=1

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:201  
     1230    10320    5                            CALL INSERT(CHARTEMP, 64 - CHARS, CHARS - 1,HOST_NUCHARS);

  10320  1 005135   777777 620006                    EAX0    -1,QL
         1 005136   000000 235003                    LDA     0,DU
         1 005137   200100 135100                    SBLA    CHARS,,AUTO
         1 005140   040145 100500                    MLR     fill='040'O
         1 005141   200032 000100                    ADSC9   HOST_NUVAL,,AUTO         cn=0,n=64
         1 005142   200077 000010                    ADSC9   TEMP,A,AUTO              cn=0,n=*X0

     1231    10321    5                         END;         /* DO CASE( SIGNPOS ) - not overpunched */

     1232    10322    4                     END;                  /* PUB = 2 - unpacked number */

  10322  1 005143   005340 710000 1                  TRA     s:10359

     1233    10323    4                  ELSE DO;                 /* Packed decimal number */

     1234    10324    4                       IF SIZE > 4 * 31 /* Can have a maximum of 31 half  bytes */

  10324  1 005144   200004 473500                    LDP3    @SIZE,,AUTO
         1 005145   300000 235100                    LDA     0,,PR3
         1 005146   000174 115007                    CMPA    124,DL
         1 005147   005156 604400 1                  TMOZ    s:10330

     1235    10325    5                       THEN DO;

     1236    10326    5                            S_D.ERROR = 46 ; /* E@TOOLARGE */

  10326  1 005150   000056 235007                    LDA     46,DL
         1 005151   100013 755100                    STA     11,,PR1

     1237    10327    5                            CALL DDE$ERROR;

  10327  1 005152   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 005153   000000 701000 xent               TSX1    DDE$ERROR
         1 005154   000000 011000                    NOP     0

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:202  
     1238    10328    5                            ALTRETURN;

  10328  1 005155   000000 702200 xent               TSX2  ! X66_AALT

     1239    10329    5                          END;
     1240    10330    4                       CHARS = (SIZE+ 3) / 4;

  10330  1 005156   300000 236100                    LDQ     0,,PR3
         1 005157   000003 036007                    ADLQ    3,DL
         1 005160   000004 506007                    DIV     4,DL
         1 005161   200100 756100                    STQ     CHARS,,AUTO

     1241    10331    4                       J = 0;

  10331  1 005162   200112 450100                    STZ     J,,AUTO

     1242    10332    5                       DO I = 0 TO (CHARS -1); /* Reformat into 9 bits char */

  10332  1 005163   200111 450100                    STZ     I,,AUTO
         1 005164   005274 710000 1                  TRA     s:10345+3

     1243    10333    5                            PCHAR.LEFT5 ( J ) = 3;

  10333  1 005165   200112 236100                    LDQ     J,,AUTO
         1 005166   000011 402007                    MPY     9,DL
         1 005167   003106 061400                    CSR     bolr='003'O
         1 005170   000005 000044 xsym               BDSC    B_VECTNIL+5              by=0,bit=0,n=36
         1 005171   200032 000005                    BDSC    HOST_NUVAL,Q,AUTO        by=0,bit=0,n=5

     1244    10334    5                            PCHAR.RIGHT4 ( J ) = L6_PDEC.L1 ( I );

  10334  1 005172   200111 236100                    LDQ     I,,AUTO
         1 005173   000044 402007                    MPY     36,DL
         1 005174   200232 756100                    STQ     DIG+1,,AUTO
         1 005175   200112 236100                    LDQ     J,,AUTO
         1 005176   000011 402007                    MPY     9,DL
         1 005177   200232 235100                    LDA     DIG+1,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:203  
         1 005200   003106 060505                    CSL     bolr='003'O
         1 005201   200012 420004                    BDSC    CVALUES,A,AUTO           by=2,bit=2,n=4
         1 005202   200032 050004                    BDSC    HOST_NUVAL,Q,AUTO        by=0,bit=5,n=4

     1245    10335    5                            J = J + 1;

  10335  1 005203   200112 235100                    LDA     J,,AUTO
         1 005204   000001 035007                    ADLA    1,DL
         1 005205   200112 755100                    STA     J,,AUTO

     1246    10336    5                            PCHAR.LEFT5 ( J ) = 3;

  10336  1 005206   200112 236100                    LDQ     J,,AUTO
         1 005207   000011 402007                    MPY     9,DL
         1 005210   003106 061400                    CSR     bolr='003'O
         1 005211   000005 000044 xsym               BDSC    B_VECTNIL+5              by=0,bit=0,n=36
         1 005212   200032 000005                    BDSC    HOST_NUVAL,Q,AUTO        by=0,bit=0,n=5

     1247    10337    5                            PCHAR.RIGHT4 ( J ) = L6_PDEC.L2 ( I );

  10337  1 005213   200111 236100                    LDQ     I,,AUTO
         1 005214   000044 402007                    MPY     36,DL
         1 005215   200232 756100                    STQ     DIG+1,,AUTO
         1 005216   200112 236100                    LDQ     J,,AUTO
         1 005217   000011 402007                    MPY     9,DL
         1 005220   200232 235100                    LDA     DIG+1,,AUTO
         1 005221   003106 060505                    CSL     bolr='003'O
         1 005222   200012 460004                    BDSC    CVALUES,A,AUTO           by=2,bit=6,n=4
         1 005223   200032 050004                    BDSC    HOST_NUVAL,Q,AUTO        by=0,bit=5,n=4

     1248    10338    5                            J = J + 1;

  10338  1 005224   200112 235100                    LDA     J,,AUTO
         1 005225   000001 035007                    ADLA    1,DL
         1 005226   200112 755100                    STA     J,,AUTO

     1249    10339    5                            PCHAR.LEFT5 ( J ) = 3;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:204  

  10339  1 005227   200112 236100                    LDQ     J,,AUTO
         1 005230   000011 402007                    MPY     9,DL
         1 005231   003106 061400                    CSR     bolr='003'O
         1 005232   000005 000044 xsym               BDSC    B_VECTNIL+5              by=0,bit=0,n=36
         1 005233   200032 000005                    BDSC    HOST_NUVAL,Q,AUTO        by=0,bit=0,n=5

     1250    10340    5                            PCHAR.RIGHT4 ( J ) = L6_PDEC.R1 ( I );

  10340  1 005234   200111 236100                    LDQ     I,,AUTO
         1 005235   000044 402007                    MPY     36,DL
         1 005236   200232 756100                    STQ     DIG+1,,AUTO
         1 005237   200112 236100                    LDQ     J,,AUTO
         1 005240   000011 402007                    MPY     9,DL
         1 005241   200232 235100                    LDA     DIG+1,,AUTO
         1 005242   003106 060505                    CSL     bolr='003'O
         1 005243   200012 610004                    BDSC    CVALUES,A,AUTO           by=3,bit=1,n=4
         1 005244   200032 050004                    BDSC    HOST_NUVAL,Q,AUTO        by=0,bit=5,n=4

     1251    10341    5                            J = J + 1;

  10341  1 005245   200112 235100                    LDA     J,,AUTO
         1 005246   000001 035007                    ADLA    1,DL
         1 005247   200112 755100                    STA     J,,AUTO

     1252    10342    5                            PCHAR.LEFT5 ( J ) = 3;

  10342  1 005250   200112 236100                    LDQ     J,,AUTO
         1 005251   000011 402007                    MPY     9,DL
         1 005252   003106 061400                    CSR     bolr='003'O
         1 005253   000005 000044 xsym               BDSC    B_VECTNIL+5              by=0,bit=0,n=36
         1 005254   200032 000005                    BDSC    HOST_NUVAL,Q,AUTO        by=0,bit=0,n=5

     1253    10343    5                            PCHAR.RIGHT4 ( J ) = L6_PDEC.R2 ( I );

  10343  1 005255   200111 236100                    LDQ     I,,AUTO
         1 005256   000044 402007                    MPY     36,DL
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:205  
         1 005257   200232 756100                    STQ     DIG+1,,AUTO
         1 005260   200112 236100                    LDQ     J,,AUTO
         1 005261   000011 402007                    MPY     9,DL
         1 005262   200232 235100                    LDA     DIG+1,,AUTO
         1 005263   003106 060505                    CSL     bolr='003'O
         1 005264   200012 650004                    BDSC    CVALUES,A,AUTO           by=3,bit=5,n=4
         1 005265   200032 050004                    BDSC    HOST_NUVAL,Q,AUTO        by=0,bit=5,n=4

     1254    10344    5                            J = J + 1;

  10344  1 005266   200112 235100                    LDA     J,,AUTO
         1 005267   000001 035007                    ADLA    1,DL
         1 005270   200112 755100                    STA     J,,AUTO

     1255    10345    5                          END;

  10345  1 005271   200111 236100                    LDQ     I,,AUTO
         1 005272   000001 036007                    ADLQ    1,DL
         1 005273   200111 756100                    STQ     I,,AUTO
         1 005274   200111 236100                    LDQ     I,,AUTO
         1 005275   200100 116100                    CMPQ    CHARS,,AUTO
         1 005276   005165 602000 1                  TNC     s:10333

     1256    10346    5                       DO CASE ( SIGNPOS );

  10346  1 005277   200103 235100                    LDA     SIGNPOS,,AUTO
         1 005300   000003 115007                    CMPA    3,DL
         1 005301   005303 602005 1                  TNC     s:10346+4,AL
         1 005302   005340 710000 1                  TRA     s:10359
         1 005303   005326 710000 1                  TRA     s:10352
         1 005304   005340 710000 1                  TRA     s:10359
         1 005305   005306 710000 1                  TRA     s:10348

     1257    10347    5                         CASE ( 2 );

     1258    10348    5                            PCHAR.LEFT5 ( CHARS - 1 ) = 2;

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:206  
  10348  1 005306   200100 236100                    LDQ     CHARS,,AUTO
         1 005307   000011 402007                    MPY     9,DL
         1 005310   003106 061400                    CSR     bolr='003'O
         1 005311   000004 000044 xsym               BDSC    B_VECTNIL+4              by=0,bit=0,n=36
         1 005312   200031 600005                    BDSC    CVALUES+15,Q,AUTO        by=3,bit=0,n=5

     1259    10349    5                            ACHARTEMP ( 0 ) = HOST_NUCHAR ( CHARS - 1 );

  10349  1 005313   200100 235100                    LDA     CHARS,,AUTO
         1 005314   040100 100505                    MLR     fill='040'O
         1 005315   200031 600001                    ADSC9   CVALUES+15,A,AUTO        cn=3,n=1
         1 005316   200057 000001                    ADSC9   ACHARTEMP,,AUTO          cn=0,n=1

     1260    10350    5                           CALL INSERT ( CHARTEMP, 64 - CHARS, CHARS - 1, HOST_NUCHARS
             10350                                     );

  10350  1 005317   777777 620005                    EAX0    -1,AL
         1 005320   000027 675000 xsym               ERA     B_VECTNIL+23
         1 005321   000001 035007                    ADLA    1,DL
         1 005322   040145 100500                    MLR     fill='040'O
         1 005323   200032 000100                    ADSC9   HOST_NUVAL,,AUTO         cn=0,n=64
         1 005324   200077 000010                    ADSC9   TEMP,A,AUTO              cn=0,n=*X0
         1 005325   005340 710000 1                  TRA     s:10359

     1261    10351    5                         CASE ( 0 );

     1262    10352    5                            ACHARTEMP ( 0 ) = '+';

  10352  1 005326   053000 236003                    LDQ     22016,DU
         1 005327   200057 552140                    STBQ    ACHARTEMP,'40'O,AUTO

     1263    10353    5                            CALL INSERT ( CHARTEMP, 64 - CHARS, CHARS - 1,

  10353  1 005330   200100 720100                    LXL0    CHARS,,AUTO
         1 005331   777777 621010                    EAX1    -1,X0
         1 005332   000000 235003                    LDA     0,DU
         1 005333   200100 135100                    SBLA    CHARS,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:207  
         1 005334   040145 100500                    MLR     fill='040'O
         1 005335   200032 200077                    ADSC9   HOST_NUVAL,,AUTO         cn=1,n=63
         1 005336   200077 000011                    ADSC9   TEMP,A,AUTO              cn=0,n=*X1
         1 005337   005340 710000 1                  TRA     s:10359

     1264    10354    5                              SUBSTR ( HOST_NUCHARS, 1 ) );
     1265    10355    5                         CASE ( ELSE );

     1266    10356    5                         END;

     1267    10357    4                     END;                  /* DO - packed decimal number */

     1268    10358    3               END;

     1269    10359    2             TEXT$ = S_D.D$;

  10359  1 005340   000000 470400 xsym               LDP0    S_D$
         1 005341   000044 236100                    LDQ     36,,PR0
         1 005342   200217 756100                    STQ     TEXT$,,AUTO

     1270    10360    2             IF ACHARTEMP( 0 ) = '-'

  10360  1 005343   200057 236100                    LDQ     ACHARTEMP,,AUTO
         1 005344   777000 376003                    ANQ     -512,DU
         1 005345   055000 116003                    CMPQ    23040,DU
         1 005346   005362 601000 1                  TNZ     s:10366

     1271    10361    3             THEN DO;

     1272    10362    3                  TEXT$ -> CHAR1 = '-';

  10362  1 005347   200217 471500                    LDP1    TEXT$,,AUTO
         1 005350   040100 100400                    MLR     fill='040'O
         1 005351   000002 000001 2                  ADSC9   2                        cn=0,n=1
         1 005352   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

     1273    10363    3                  CALL DDR$BUMPC_D$( 1 ) ALTRET(DERR);
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:208  

  10363  1 005353   000000 630400 2                  EPPR0   0
         1 005354   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 005355   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 005356   010563 702000 1                  TSX2    DERR

     1274    10364    3                  TEXT$ = S_D.D$;

  10364  1 005357   000000 470400 xsym               LDP0    S_D$
         1 005360   000044 236100                    LDQ     36,,PR0
         1 005361   200217 756100                    STQ     TEXT$,,AUTO

     1275    10365    3                END;

     1276    10366    2             IF SCALE >= 0

  10366  1 005362   200106 235100                    LDA     SCALE,,AUTO
         1 005363   005466 604000 1                  TMI     s:10389

     1277    10367    3             THEN DO;                      /* Scale zero or positive */

     1278    10368    3                  SIG = '0'B;

  10368  1 005364   200105 450100                    STZ     SIG,,AUTO

     1279    10369    4                  DO I = 1 TO 61;

  10369  1 005365   000001 236007                    LDQ     1,DL
         1 005366   200111 756100                    STQ     I,,AUTO

     1280    10370    4                       CTEMP = ACHARTEMP( I );

  10370  1 005367   200111 235100                    LDA     I,,AUTO
         1 005370   040100 100505                    MLR     fill='040'O
         1 005371   200057 000001                    ADSC9   ACHARTEMP,A,AUTO         cn=0,n=1
         1 005372   200107 000001                    ADSC9   CTEMP,,AUTO              cn=0,n=1

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:209  
     1281    10371    4                       IF CTEMP ~= '0' OR SIG

  10371  1 005373   200107 236100                    LDQ     CTEMP,,AUTO
         1 005374   777000 376003                    ANQ     -512,DU
         1 005375   060000 116003                    CMPQ    24576,DU
         1 005376   005401 601000 1                  TNZ     s:10373
         1 005377   200105 234100                    SZN     SIG,,AUTO
         1 005400   005416 605000 1                  TPL     s:10378

     1282    10372    5                       THEN DO;

     1283    10373    5                            SIG = '1'B;

  10373  1 005401   400000 236003                    LDQ     -131072,DU
         1 005402   200105 756100                    STQ     SIG,,AUTO

     1284    10374    5                            TEXT$ -> CHAR1 = CTEMP;

  10374  1 005403   200217 470500                    LDP0    TEXT$,,AUTO
         1 005404   040100 100500                    MLR     fill='040'O
         1 005405   200107 000001                    ADSC9   CTEMP,,AUTO              cn=0,n=1
         1 005406   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1285    10375    5                            CALL DDR$BUMPC_D$( 1 ) ALTRET(DERR);

  10375  1 005407   000000 630400 2                  EPPR0   0
         1 005410   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 005411   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 005412   010563 702000 1                  TSX2    DERR

     1286    10376    5                            TEXT$ = S_D.D$;

  10376  1 005413   000000 470400 xsym               LDP0    S_D$
         1 005414   000044 236100                    LDQ     36,,PR0
         1 005415   200217 756100                    STQ     TEXT$,,AUTO

     1287    10377    5                          END;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:210  

     1288    10378    4                     END;                  /* DO I = 1 TO 61 */

  10378  1 005416   200111 235100                    LDA     I,,AUTO
         1 005417   000001 035007                    ADLA    1,DL
         1 005420   200111 755100                    STA     I,,AUTO
         1 005421   000076 115007                    CMPA    62,DL
         1 005422   005367 602000 1                  TNC     s:10370

     1289    10379    3                  TEXT$ -> CHAR1 = ACHARTEMP( 62 ); /* Always want last digit */

  10379  1 005423   200217 470500                    LDP0    TEXT$,,AUTO
         1 005424   040100 100500                    MLR     fill='040'O
         1 005425   200076 400001                    ADSC9   ACHARTEMP+15,,AUTO       cn=2,n=1
         1 005426   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1290    10380    3                  CALL DDR$BUMPC_D$( 1 ) ALTRET(DERR);

  10380  1 005427   000000 630400 2                  EPPR0   0
         1 005430   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 005431   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 005432   010563 702000 1                  TSX2    DERR

     1291    10381    3                  TEXT$ = S_D.D$;

  10381  1 005433   000000 470400 xsym               LDP0    S_D$
         1 005434   000044 236100                    LDQ     36,,PR0
         1 005435   200217 756100                    STQ     TEXT$,,AUTO

     1292    10382    3                  CALL DDR$BUMPC_D$( SCALE ) ALTRET(DERR);

  10382  1 005436   200106 631500                    EPPR1   SCALE,,AUTO
         1 005437   200232 451500                    STP1    DIG+1,,AUTO
         1 005440   200232 630500                    EPPR0   DIG+1,,AUTO
         1 005441   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 005442   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 005443   010563 702000 1                  TSX2    DERR
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:211  

     1293    10383    4                  DO I = 1 TO SCALE;

  10383  1 005444   000001 235007                    LDA     1,DL
         1 005445   200111 755100                    STA     I,,AUTO
         1 005446   005461 710000 1                  TRA     s:10386+3

     1294    10384    4                       TEXT$ -> CHAR1 = '0';

  10384  1 005447   200217 470500                    LDP0    TEXT$,,AUTO
         1 005450   040100 100400                    MLR     fill='040'O
         1 005451   000032 000001 2                  ADSC9   26                       cn=0,n=1
         1 005452   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1295    10385    4                       TEXT$ = PINCRC(TEXT$, 1);

  10385  1 005453   200217 236100                    LDQ     TEXT$,,AUTO
         1 005454   200000 036007                    ADLQ    65536,DL
         1 005455   200217 756100                    STQ     TEXT$,,AUTO

     1296    10386    4                     END;

  10386  1 005456   200111 235100                    LDA     I,,AUTO
         1 005457   000001 035007                    ADLA    1,DL
         1 005460   200111 755100                    STA     I,,AUTO
         1 005461   200111 236100                    LDQ     I,,AUTO
         1 005462   005465 604000 1                  TMI     s:10387
         1 005463   200106 116100                    CMPQ    SCALE,,AUTO
         1 005464   005447 604400 1                  TMOZ    s:10384

     1297    10387    3                END;                       /* Scale zero or positive */

  10387  1 005465   005644 710000 1                  TRA     s:10428

     1298    10388    3             ELSE DO;                      /* Scale negative */

     1299    10389    3                  SCALE = - SCALE;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:212  

  10389  1 005466   000000 531000                    NEG     0
         1 005467   200106 755100                    STA     SCALE,,AUTO

     1300    10390    3                  SIG = '0'B;

  10390  1 005470   200105 450100                    STZ     SIG,,AUTO

     1301    10391    3                  IF SCALE > 62

  10391  1 005471   000076 115007                    CMPA    62,DL
         1 005472   005543 604400 1                  TMOZ    s:10405

     1302    10392    4                  THEN DO;                 /* Need leading zeroes */

     1303    10393    4                       SIG = '1'B;

  10393  1 005473   400000 236003                    LDQ     -131072,DU
         1 005474   200105 756100                    STQ     SIG,,AUTO

     1304    10394    4                       TEXT$ -> CHAR1 = '0';

  10394  1 005475   200217 471500                    LDP1    TEXT$,,AUTO
         1 005476   040100 100400                    MLR     fill='040'O
         1 005477   000032 000001 2                  ADSC9   26                       cn=0,n=1
         1 005500   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

     1305    10395    4                       CALL DDR$BUMPC_D$( 1 ) ALTRET(DERR);

  10395  1 005501   000000 630400 2                  EPPR0   0
         1 005502   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 005503   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 005504   010563 702000 1                  TSX2    DERR

     1306    10396    4                       TEXT$ = S_D.D$;

  10396  1 005505   000000 470400 xsym               LDP0    S_D$
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:213  
         1 005506   000044 236100                    LDQ     36,,PR0
         1 005507   200217 756100                    STQ     TEXT$,,AUTO

     1307    10397    4                       CALL PUTDECIMALPT ALTRET(DERR);

  10397  1 005510   011003 701000 1                  TSX1    PUTDECIMALPT
         1 005511   010563 702000 1                  TSX2    DERR

     1308    10398    4                       NCHARS = SCALE - 62;

  10398  1 005512   200106 235100                    LDA     SCALE,,AUTO
         1 005513   000076 135007                    SBLA    62,DL
         1 005514   200055 755100                    STA     NCHARS,,AUTO

     1309    10399    4                       CALL DDR$BUMPC_D$ ( NCHARS + 62 ) ALTRET(DERR);

  10399  1 005515   000076 035007                    ADLA    62,DL
         1 005516   200232 755100                    STA     DIG+1,,AUTO
         1 005517   200232 630500                    EPPR0   DIG+1,,AUTO
         1 005520   200233 450500                    STP0    DIG+2,,AUTO
         1 005521   200233 630500                    EPPR0   DIG+2,,AUTO
         1 005522   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 005523   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 005524   010563 702000 1                  TSX2    DERR

     1310    10400    4                       TEXT$ -> TEXTR = ZERO;

  10400  1 005525   200217 470500                    LDP0    TEXT$,,AUTO
         1 005526   200055 720100                    LXL0    NCHARS,,AUTO
         1 005527   040140 100400                    MLR     fill='040'O
         1 005530   000000 000100 0                  ADSC9   ZEROES                   cn=0,n=64
         1 005531   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

     1311    10401    4                       TEXT$ = PINCRC(TEXT$, NCHARS);

  10401  1 005532   200055 236100                    LDQ     NCHARS,,AUTO
         1 005533   000020 736000                    QLS     16
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:214  
         1 005534   200217 036100                    ADLQ    TEXT$,,AUTO
         1 005535   200217 756100                    STQ     TEXT$,,AUTO

     1312    10402    4                       TEXT$ -> CHAR62 = ADDR(ACHARTEMP(1)) -> CHAR62;

  10402  1 005536   200217 470500                    LDP0    TEXT$,,AUTO
         1 005537   040100 100500                    MLR     fill='040'O
         1 005540   200057 200076                    ADSC9   ACHARTEMP,,AUTO          cn=1,n=62
         1 005541   000000 000076                    ADSC9   0,,PR0                   cn=0,n=62

     1313    10403    4                     END;                  /* Need leading zeroes */

  10403  1 005542   005644 710000 1                  TRA     s:10428

     1314    10404    4                  ELSE DO;                 /* No leading zeroes */

     1315    10405    4                       TEMP = 62 - SCALE;

  10405  1 005543   000027 675000 xsym               ERA     B_VECTNIL+23
         1 005544   000077 035007                    ADLA    63,DL
         1 005545   200077 755100                    STA     TEMP,,AUTO

     1316    10406    5                       DO I = 1 TO TEMP;   /* Output digits before '.' */

  10406  1 005546   000001 236007                    LDQ     1,DL
         1 005547   200111 756100                    STQ     I,,AUTO
         1 005550   005603 710000 1                  TRA     s:10415+3

     1317    10407    5                            CTEMP = ACHARTEMP( I );

  10407  1 005551   200111 235100                    LDA     I,,AUTO
         1 005552   040100 100505                    MLR     fill='040'O
         1 005553   200057 000001                    ADSC9   ACHARTEMP,A,AUTO         cn=0,n=1
         1 005554   200107 000001                    ADSC9   CTEMP,,AUTO              cn=0,n=1

     1318    10408    5                            IF CTEMP ~= '0' OR SIG

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:215  
  10408  1 005555   200107 236100                    LDQ     CTEMP,,AUTO
         1 005556   777000 376003                    ANQ     -512,DU
         1 005557   060000 116003                    CMPQ    24576,DU
         1 005560   005563 601000 1                  TNZ     s:10410
         1 005561   200105 234100                    SZN     SIG,,AUTO
         1 005562   005600 605000 1                  TPL     s:10415

     1319    10409    6                            THEN DO;

     1320    10410    6                                 SIG ='1'B;

  10410  1 005563   400000 236003                    LDQ     -131072,DU
         1 005564   200105 756100                    STQ     SIG,,AUTO

     1321    10411    6                                 TEXT$ -> CHAR1 = CTEMP;

  10411  1 005565   200217 470500                    LDP0    TEXT$,,AUTO
         1 005566   040100 100500                    MLR     fill='040'O
         1 005567   200107 000001                    ADSC9   CTEMP,,AUTO              cn=0,n=1
         1 005570   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1322    10412    6                                 CALL DDR$BUMPC_D$( 1 ) ALTRET(DERR);

  10412  1 005571   000000 630400 2                  EPPR0   0
         1 005572   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 005573   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 005574   010563 702000 1                  TSX2    DERR

     1323    10413    6                                 TEXT$ = S_D.D$;

  10413  1 005575   000000 470400 xsym               LDP0    S_D$
         1 005576   000044 236100                    LDQ     36,,PR0
         1 005577   200217 756100                    STQ     TEXT$,,AUTO

     1324    10414    6                               END;

     1325    10415    5                          END;             /* Output digits before '.' */
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:216  

  10415  1 005600   200111 235100                    LDA     I,,AUTO
         1 005601   000001 035007                    ADLA    1,DL
         1 005602   200111 755100                    STA     I,,AUTO
         1 005603   200077 236100                    LDQ     TEMP,,AUTO
         1 005604   200111 116100                    CMPQ    I,,AUTO
         1 005605   005551 603000 1                  TRC     s:10407

     1326    10416    4                       IF NOT SIG

  10416  1 005606   200105 234100                    SZN     SIG,,AUTO
         1 005607   005623 604000 1                  TMI     s:10422

     1327    10417    5                       THEN DO;            /* Force at least one leading zero */

     1328    10418    5                            TEXT$ -> CHAR1 = '0';

  10418  1 005610   200217 470500                    LDP0    TEXT$,,AUTO
         1 005611   040100 100400                    MLR     fill='040'O
         1 005612   000032 000001 2                  ADSC9   26                       cn=0,n=1
         1 005613   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1329    10419    5                            CALL DDR$BUMPC_D$( 1 ) ALTRET(DERR);

  10419  1 005614   000000 630400 2                  EPPR0   0
         1 005615   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 005616   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 005617   010563 702000 1                  TSX2    DERR

     1330    10420    5                            TEXT$ = S_D.D$;

  10420  1 005620   000000 470400 xsym               LDP0    S_D$
         1 005621   000044 236100                    LDQ     36,,PR0
         1 005622   200217 756100                    STQ     TEXT$,,AUTO

     1331    10421    5                          END;             /* Force at least one leading zero */

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:217  
     1332    10422    4                       CALL PUTDECIMALPT ALTRET(DERR);

  10422  1 005623   011003 701000 1                  TSX1    PUTDECIMALPT
         1 005624   010563 702000 1                  TSX2    DERR

     1333    10423    4                       NCHARS = 62 - TEMP;

  10423  1 005625   000076 235007                    LDA     62,DL
         1 005626   200077 135100                    SBLA    TEMP,,AUTO
         1 005627   200055 755100                    STA     NCHARS,,AUTO

     1334    10424    4                       CALL DDR$BUMPC_D$( NCHARS ) ALTRET(DERR);

  10424  1 005630   200055 630500                    EPPR0   NCHARS,,AUTO
         1 005631   200232 450500                    STP0    DIG+1,,AUTO
         1 005632   200232 630500                    EPPR0   DIG+1,,AUTO
         1 005633   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 005634   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 005635   010563 702000 1                  TSX2    DERR

     1335    10425    4                       TEXT$ -> TEXTR = ADDR(ACHARTEMP( TEMP + 1 )) -> CHAR62;

  10425  1 005636   200077 235100                    LDA     TEMP,,AUTO
         1 005637   200217 470500                    LDP0    TEXT$,,AUTO
         1 005640   200055 720100                    LXL0    NCHARS,,AUTO
         1 005641   040140 100505                    MLR     fill='040'O
         1 005642   200057 200076                    ADSC9   ACHARTEMP,A,AUTO         cn=1,n=62
         1 005643   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

     1336    10426    4                     END;                  /* No leading zeroes */

     1337    10427    3                END;                       /* Scale negative */

     1338    10428    2             RETURN;

  10428  1 005644   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:218  
     1339    10429                                                /***********************
     1340    10430                                                 ******* REL_FMT *******
     1341    10431                                                 ***********************/
     1342    10432    2          CASE( %REL_FMT );

     1343    10433
     1344    10434    2   REL:      IF SIZE < 18

  10434  1 005645   200004 470500       REL          LDP0    @SIZE,,AUTO
         1 005646   000000 235100                    LDA     0,,PR0
         1 005647   000022 115007                    CMPA    18,DL
         1 005650   010560 604000 1                  TMI     WRONG_SIZE

     1345    10435    2             THEN GOTO WRONG_SIZE;
     1346    10436    2             ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  10436  1 005651   000000 471400 xsym               LDP1    S_D$
         1 005652   106714 235100                    LDA     3532,,PR1
         1 005653   000001 115007                    CMPA    1,DL
         1 005654   005661 601000 1                  TNZ     s:10438

     1347    10437    2                  THEN VAL = BITBIN( BINBIT( VALUE.L, 36 ) & '000000777777'O );

  10437  1 005655   200012 236100                    LDQ     CVALUES,,AUTO
         1 005656   000107 376000 0                  ANQ     HEXCHARS+46
         1 005657   200216 756100                    STQ     VAL,,AUTO
         1 005660   005673 710000 1                  TRA     REL6

     1348    10438    2                  ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  10438  1 005661   000002 115007                    CMPA    2,DL
         1 005662   005670 601000 1                  TNZ     s:10441

     1349    10439    2                       THEN VAL = KVALUE(0) * 65536 + KVALUE(1);

  10439  1 005663   200012 236100                    LDQ     CVALUES,,AUTO
         1 005664   000020 736000                    QLS     16
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:219  
         1 005665   200013 036100                    ADLQ    CVALUES+1,,AUTO
         1 005666   200216 756100                    STQ     VAL,,AUTO
         1 005667   005673 710000 1                  TRA     REL6

     1350    10440    3                       ELSE DO;

     1351    10441    3                            S_D.ERROR = 502; /* E@DELBUG */

  10441  1 005670   000766 236007                    LDQ     502,DL
         1 005671   100013 756100                    STQ     11,,PR1

     1352    10442    3                            GOTO DERR;

  10442  1 005672   010563 710000 1                  TRA     DERR

     1353    10443    3                          END;
     1354    10444    2   REL6:     SAVE_EWSQ# = S_D.EWSQ#;

  10444  1 005673   000000 470400 xsym  REL6         LDP0    S_D$
         1 005674   000011 235100                    LDA     9,,PR0
         1 005675   200220 755100                    STA     SAVE_EWSQ#,,AUTO

     1355    10445    2             IF D_XDELTA

  10445  1 005676   000000 234000 xsym               SZN     D_XDELTA
         1 005677   005710 605000 1                  TPL     s:10449

     1356    10446    2             THEN IF U$SE.TYPE = 0   /* USE_MON */

  10446  1 005700   000000 471400 xsym               LDP1    USE$
         1 005701   100001 235100                    LDA     1,,PR1
         1 005702   005706 601000 1                  TNZ     s:10448

     1357    10447    2                  THEN S_D.EWSQ# = %MONWSQ; /* %MONWSQ */

  10447  1 005703   000001 236007                    LDQ     1,DL
         1 005704   000011 756100                    STQ     9,,PR0
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:220  
         1 005705   005712 710000 1                  TRA     s:10450

     1358    10448    2                  ELSE S_D.EWSQ# = %REALWSQ;
             10448                           /* Don't use monitor symbols for others - %REALWSQ */

  10448  1 005706   000011 450100                    STZ     9,,PR0
         1 005707   005712 710000 1                  TRA     s:10450

     1359    10449    2             ELSE S_D.EWSQ# = %MONWSQ;
             10449                      /* User is like monitor for user DELTA - %MONWSQ */

  10449  1 005710   000001 236007                    LDQ     1,DL
         1 005711   000011 756100                    STQ     9,,PR0

     1360    10450    2             CALL DDR$POSIT(VAL, S_D.D$, POFFC(S_D.DESCL$, S_D.D$), NCHARS, NO_UDEFS)
             10450                      ALTRET(DERR);

  10450  1 005712   000044 236100                    LDQ     36,,PR0
         1 005713   000020 772000                    QRL     16
         1 005714   200232 756100                    STQ     DIG+1,,AUTO
         1 005715   000042 236100                    LDQ     34,,PR0
         1 005716   000020 772000                    QRL     16
         1 005717   200232 136100                    SBLQ    DIG+1,,AUTO
         1 005720   200233 756100                    STQ     DIG+2,,AUTO
         1 005721   200011 631500                    EPPR1   NO_UDEFS,,AUTO
         1 005722   200240 451500                    STP1    DIG+7,,AUTO
         1 005723   200055 633500                    EPPR3   NCHARS,,AUTO
         1 005724   200237 453500                    STP3    DIG+6,,AUTO
         1 005725   200233 634500                    EPPR4   DIG+2,,AUTO
         1 005726   200236 454500                    STP4    DIG+5,,AUTO
         1 005727   000000 236000 xsym               LDQ     S_D$
         1 005730   000044 036003                    ADLQ    36,DU
         1 005731   200235 756100                    STQ     DIG+4,,AUTO
         1 005732   200216 635500                    EPPR5   VAL,,AUTO
         1 005733   200234 455500                    STP5    DIG+3,,AUTO
         1 005734   200234 630500                    EPPR0   DIG+3,,AUTO
         1 005735   000023 631400 xsym               EPPR1   B_VECTNIL+19
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:221  
         1 005736   000000 701000 xent               TSX1    DDR$POSIT
         1 005737   010563 702000 1                  TSX2    DERR

     1361    10451    2             S_D.EWSQ# = SAVE_EWSQ#;

  10451  1 005740   200220 235100                    LDA     SAVE_EWSQ#,,AUTO
         1 005741   000000 470400 xsym               LDP0    S_D$
         1 005742   000011 755100                    STA     9,,PR0

     1362    10452    2             IF S_D.OVERLAID AND NOT S_D.RUM

  10452  1 005743   004764 234100                    SZN     2548,,PR0
         1 005744   005756 605000 1                  TPL     s:10454
         1 005745   004755 234100                    SZN     2541,,PR0
         1 005746   005756 604000 1                  TMI     s:10454

     1363    10453    2             THEN CALL DDS$IC2NODE(S_D.SAVEIC);

  10453  1 005747   000000 236000 xsym               LDQ     S_D$
         1 005750   000002 036003                    ADLQ    2,DU
         1 005751   200232 756100                    STQ     DIG+1,,AUTO
         1 005752   200232 630500                    EPPR0   DIG+1,,AUTO
         1 005753   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 005754   000000 701000 xent               TSX1    DDS$IC2NODE
         1 005755   000000 011000                    NOP     0

     1364    10454    2             CALL DDR$BUMPC_D$(NCHARS) ALTRET(DERR);

  10454  1 005756   200055 630500                    EPPR0   NCHARS,,AUTO
         1 005757   200232 450500                    STP0    DIG+1,,AUTO
         1 005760   200232 630500                    EPPR0   DIG+1,,AUTO
         1 005761   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 005762   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 005763   010563 702000 1                  TSX2    DERR

     1365    10455    2             RETURN;

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:222  
  10455  1 005764   000000 702200 xent               TSX2  ! X66_ARET

     1366    10456                                                /****************************
     1367    10457                                                 ******* REMEMBER_FMT *******
     1368    10458                                                 ****************************/
     1369    10459    2          CASE( %REMEMBER_FMT );

     1370    10460
     1371    10461    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );

  10461  1 005765   000000 470400 xsym               LDP0    S_D$
         1 005766   006714 235100                    LDA     3532,,PR0
         1 005767   000003 115007                    CMPA    3,DL
         1 005770   005772 602005 1                  TNC     s:10461+5,AL
         1 005771   006045 710000 1                  TRA     s:10477
         1 005772   006045 710000 1                  TRA     s:10477
         1 005773   005775 710000 1                  TRA     s:10463
         1 005774   006013 710000 1                  TRA     s:10468

     1372    10462    3               CASE ( %HOST );

     1373    10463    3                  IF SIZE ~= 72 THEN GOTO WRONG_SIZE;

  10463  1 005775   200004 471500                    LDP1    @SIZE,,AUTO
         1 005776   100000 235100                    LDA     0,,PR1
         1 005777   000110 115007                    CMPA    72,DL
         1 006000   010560 601000 1                  TNZ     WRONG_SIZE

     1374    10464    3                  OFFSET = RVALUE.OFFSET;

  10464  1 006001   200012 236100                    LDQ     CVALUES,,AUTO
         1 006002   000022 772000                    QRL     18
         1 006003   200215 756100                    STQ     OFFSET,,AUTO

     1375    10465    3                  VALUE.L = RVALUE.E;

  10465  1 006004   200013 235100                    LDA     CVALUES+1,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:223  
         1 006005   000022 771000                    ARL     18
         1 006006   200012 755100                    STA     CVALUES,,AUTO

     1376    10466    3                  VAL = BITBIN( BINBIT(RVALUE.L, 36 ) & '000000777777'O);

  10466  1 006007   200012 236100                    LDQ     CVALUES,,AUTO
         1 006010   000107 376000 0                  ANQ     HEXCHARS+46
         1 006011   200216 756100                    STQ     VAL,,AUTO
         1 006012   006045 710000 1                  TRA     s:10477

     1377    10467    3               CASE ( %L6 );

     1378    10468    3                  IF SIZE ~= 64 THEN GOTO WRONG_SIZE;

  10468  1 006013   200004 471500                    LDP1    @SIZE,,AUTO
         1 006014   100000 235100                    LDA     0,,PR1
         1 006015   000100 115007                    CMPA    64,DL
         1 006016   010560 601000 1                  TNZ     WRONG_SIZE

     1379    10469    3                  VAL = 0;

  10469  1 006017   200216 450100                    STZ     VAL,,AUTO

     1380    10470    3                  PWRD_VAL.LEFT4 = L6_REM.AUTO_OFFSET_LEFT4;

  10470  1 006020   200012 236100                    LDQ     CVALUES,,AUTO
         1 006021   000020 736000                    QLS     16
         1 006022   200216 676100                    ERQ     VAL,,AUTO
         1 006023   000006 376000 2                  ANQ     6
         1 006024   200216 656100                    ERSQ    VAL,,AUTO

     1381    10471    3                  PWRD_VAL.RIGHT16 = L6_REM.AUTO_OFFSET_RIGHT16;

  10471  1 006025   200013 236100                    LDQ     CVALUES+1,,AUTO
         1 006026   200216 676100                    ERQ     VAL,,AUTO
         1 006027   177777 376007                    ANQ     65535,DL
         1 006030   200216 656100                    ERSQ    VAL,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:224  

     1382    10472    3                  OFFSET = VAL;

  10472  1 006031   200216 235100                    LDA     VAL,,AUTO
         1 006032   200215 755100                    STA     OFFSET,,AUTO

     1383    10473    3                  VAL = 0;

  10473  1 006033   200216 450100                    STZ     VAL,,AUTO

     1384    10474    3                  PWRD_VAL.LEFT4 = L6_REM.ADDR_LEFT4;

  10474  1 006034   200014 236100                    LDQ     CVALUES+2,,AUTO
         1 006035   000020 736000                    QLS     16
         1 006036   200216 676100                    ERQ     VAL,,AUTO
         1 006037   000006 376000 2                  ANQ     6
         1 006040   200216 656100                    ERSQ    VAL,,AUTO

     1385    10475    3                  PWRD_VAL.RIGHT16 = L6_REM.ADDR_RIGHT16;

  10475  1 006041   200015 236100                    LDQ     CVALUES+3,,AUTO
         1 006042   200216 676100                    ERQ     VAL,,AUTO
         1 006043   177777 376007                    ANQ     65535,DL
         1 006044   200216 656100                    ERSQ    VAL,,AUTO

     1386    10476    3               END;

     1387    10477    2             SAVE_EWSQ# = S_D.EWSQ#;

  10477  1 006045   000011 235100                    LDA     9,,PR0
         1 006046   200220 755100                    STA     SAVE_EWSQ#,,AUTO

     1388    10478    2             IF D_XDELTA

  10478  1 006047   000000 234000 xsym               SZN     D_XDELTA
         1 006050   006061 605000 1                  TPL     s:10482

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:225  
     1389    10479    2             THEN IF  U$SE.TYPE = 0  /* USE_MON */

  10479  1 006051   000000 471400 xsym               LDP1    USE$
         1 006052   100001 235100                    LDA     1,,PR1
         1 006053   006057 601000 1                  TNZ     s:10481

     1390    10480    2                  THEN S_D.EWSQ# = %MONWSQ; /* %MONWSQ */

  10480  1 006054   000001 236007                    LDQ     1,DL
         1 006055   000011 756100                    STQ     9,,PR0
         1 006056   006063 710000 1                  TRA     s:10483

     1391    10481    2                  ELSE S_D.EWSQ# = %REALWSQ;
             10481                           /* %REALWSQ - Dont use monitor symbols for others */

  10481  1 006057   000011 450100                    STZ     9,,PR0
         1 006060   006063 710000 1                  TRA     s:10483

     1392    10482    2             ELSE S_D.EWSQ# = %MONWSQ;
             10482                      /* %MONWSQ - User is like monitor for user DELTA */

  10482  1 006061   000001 236007                    LDQ     1,DL
         1 006062   000011 756100                    STQ     9,,PR0

     1393    10483    2             CALL DDR$POSIT(VAL, S_D.D$, POFFC(S_D.DESCL$, S_D.D$), NCHARS, NO_UDEFS)
             10483                      ALTRET( DERR ); /* Address of remembered statement */

  10483  1 006063   000044 236100                    LDQ     36,,PR0
         1 006064   000020 772000                    QRL     16
         1 006065   200232 756100                    STQ     DIG+1,,AUTO
         1 006066   000042 236100                    LDQ     34,,PR0
         1 006067   000020 772000                    QRL     16
         1 006070   200232 136100                    SBLQ    DIG+1,,AUTO
         1 006071   200233 756100                    STQ     DIG+2,,AUTO
         1 006072   200011 631500                    EPPR1   NO_UDEFS,,AUTO
         1 006073   200240 451500                    STP1    DIG+7,,AUTO
         1 006074   200055 633500                    EPPR3   NCHARS,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:226  
         1 006075   200237 453500                    STP3    DIG+6,,AUTO
         1 006076   200233 634500                    EPPR4   DIG+2,,AUTO
         1 006077   200236 454500                    STP4    DIG+5,,AUTO
         1 006100   000000 236000 xsym               LDQ     S_D$
         1 006101   000044 036003                    ADLQ    36,DU
         1 006102   200235 756100                    STQ     DIG+4,,AUTO
         1 006103   200216 635500                    EPPR5   VAL,,AUTO
         1 006104   200234 455500                    STP5    DIG+3,,AUTO
         1 006105   200234 630500                    EPPR0   DIG+3,,AUTO
         1 006106   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 006107   000000 701000 xent               TSX1    DDR$POSIT
         1 006110   010563 702000 1                  TSX2    DERR

     1394    10484    2             S_D.EWSQ# = SAVE_EWSQ#;

  10484  1 006111   200220 235100                    LDA     SAVE_EWSQ#,,AUTO
         1 006112   000000 470400 xsym               LDP0    S_D$
         1 006113   000011 755100                    STA     9,,PR0

     1395    10485    2             IF S_D.OVERLAID AND NOT S_D.RUM

  10485  1 006114   004764 234100                    SZN     2548,,PR0
         1 006115   006127 605000 1                  TPL     s:10487
         1 006116   004755 234100                    SZN     2541,,PR0
         1 006117   006127 604000 1                  TMI     s:10487

     1396    10486    2             THEN CALL DDS$IC2NODE(S_D.SAVEIC);

  10486  1 006120   000000 236000 xsym               LDQ     S_D$
         1 006121   000002 036003                    ADLQ    2,DU
         1 006122   200232 756100                    STQ     DIG+1,,AUTO
         1 006123   200232 630500                    EPPR0   DIG+1,,AUTO
         1 006124   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006125   000000 701000 xent               TSX1    DDS$IC2NODE
         1 006126   000000 011000                    NOP     0

     1397    10487    2             CALL DDR$BUMPC_D$( NCHARS ) ALTRET( DERR );
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:227  

  10487  1 006127   200055 630500                    EPPR0   NCHARS,,AUTO
         1 006130   200232 450500                    STP0    DIG+1,,AUTO
         1 006131   200232 630500                    EPPR0   DIG+1,,AUTO
         1 006132   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006133   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 006134   010563 702000 1                  TSX2    DERR

     1398    10488    2             TEXT$ = S_D.D$;

  10488  1 006135   000000 470400 xsym               LDP0    S_D$
         1 006136   000044 236100                    LDQ     36,,PR0
         1 006137   200217 756100                    STQ     TEXT$,,AUTO

     1399    10489    2             CALL DDR$BUMPC_D$( LENGTHC(' (+') );

  10489  1 006140   000005 630400 2                  EPPR0   5
         1 006141   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006142   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 006143   000000 011000                    NOP     0

     1400    10490    2             TEXT$ -> CHAR3 = ' (+';

  10490  1 006144   200217 470500                    LDP0    TEXT$,,AUTO
         1 006145   040100 100400                    MLR     fill='040'O
         1 006146   000110 000003 0                  ADSC9   HEXCHARS+47              cn=0,n=3
         1 006147   000000 000003                    ADSC9   0,,PR0                   cn=0,n=3

     1401    10491    2             TEXT$ = PINCRC(TEXT$, LENGTHC(' (+'));

  10491  1 006150   200217 236100                    LDQ     TEXT$,,AUTO
         1 006151   600000 036007                    ADLQ    -65536,DL
         1 006152   200217 756100                    STQ     TEXT$,,AUTO

     1402    10492    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
             10492                      /* Address of remembered AUTO frame */

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:228  
  10492  1 006153   000000 470400 xsym               LDP0    S_D$
         1 006154   006714 235100                    LDA     3532,,PR0
         1 006155   000001 115007                    CMPA    1,DL
         1 006156   006174 601000 1                  TNZ     s:10494

     1403    10493    2             THEN CALL DDR$BINTXT(MYBUF$, OFFSET, %OCT_FMT, NCHARS);

  10493  1 006157   200055 631500                    EPPR1   NCHARS,,AUTO
         1 006160   200235 451500                    STP1    DIG+4,,AUTO
         1 006161   000000 236000 2                  LDQ     0
         1 006162   200234 756100                    STQ     DIG+3,,AUTO
         1 006163   200215 633500                    EPPR3   OFFSET,,AUTO
         1 006164   200233 453500                    STP3    DIG+2,,AUTO
         1 006165   200214 634500                    EPPR4   MYBUF$,,AUTO
         1 006166   200232 454500                    STP4    DIG+1,,AUTO
         1 006167   200232 630500                    EPPR0   DIG+1,,AUTO
         1 006170   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 006171   000000 701000 xent               TSX1    DDR$BINTXT
         1 006172   000000 011000                    NOP     0
         1 006173   006210 710000 1                  TRA     s:10495

     1404    10494    2             ELSE CALL DDR$BINTXT ( MYBUF$, OFFSET, %X_FMT, NCHARS );

  10494  1 006174   200055 631500                    EPPR1   NCHARS,,AUTO
         1 006175   200235 451500                    STP1    DIG+4,,AUTO
         1 006176   000010 236000 2                  LDQ     8
         1 006177   200234 756100                    STQ     DIG+3,,AUTO
         1 006200   200215 633500                    EPPR3   OFFSET,,AUTO
         1 006201   200233 453500                    STP3    DIG+2,,AUTO
         1 006202   200214 634500                    EPPR4   MYBUF$,,AUTO
         1 006203   200232 454500                    STP4    DIG+1,,AUTO
         1 006204   200232 630500                    EPPR0   DIG+1,,AUTO
         1 006205   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 006206   000000 701000 xent               TSX1    DDR$BINTXT
         1 006207   000000 011000                    NOP     0

     1405    10495    2             CALL DDR$BUMPC_D$( NCHARS ) ALTRET( DERR );
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:229  

  10495  1 006210   200055 630500                    EPPR0   NCHARS,,AUTO
         1 006211   200232 450500                    STP0    DIG+1,,AUTO
         1 006212   200232 630500                    EPPR0   DIG+1,,AUTO
         1 006213   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006214   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 006215   010563 702000 1                  TSX2    DERR

     1406    10496    2             TEXT$ -> TEXTR = MYBUF;

  10496  1 006216   200217 470500                    LDP0    TEXT$,,AUTO
         1 006217   200055 720100                    LXL0    NCHARS,,AUTO
         1 006220   040140 100500                    MLR     fill='040'O
         1 006221   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 006222   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

     1407    10497    2             TEXT$ = PINCRC(TEXT$, NCHARS);

  10497  1 006223   200055 236100                    LDQ     NCHARS,,AUTO
         1 006224   000020 736000                    QLS     16
         1 006225   200217 036100                    ADLQ    TEXT$,,AUTO
         1 006226   200217 756100                    STQ     TEXT$,,AUTO

     1408    10498    2             TEXT$ -> CHAR1 = ')';

  10498  1 006227   200217 470500                    LDP0    TEXT$,,AUTO
         1 006230   040100 100400                    MLR     fill='040'O
         1 006231   000017 000001 2                  ADSC9   15                       cn=0,n=1
         1 006232   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1409    10499    2             CALL DDR$BUMPC_D$( LENGTHC(')') );

  10499  1 006233   000000 630400 2                  EPPR0   0
         1 006234   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006235   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 006236   000000 011000                    NOP     0

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:230  
     1410    10500    2             RETURN;

  10500  1 006237   000000 702200 xent               TSX2  ! X66_ARET

     1411    10501                                                /**********************************
     1412    10502                                                 ******* SINT_FMT, UINT_FMT *******
     1413    10503                                                 **********************************/
     1414    10504    2          CASE( %SINT_FMT, %UINT_FMT);

  10500  1 006240                       SINTFMT      null
     1415    10505    2   SINTFMT:  ;
     1416    10506    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );

  10506  1 006240   000000 470400 xsym               LDP0    S_D$
         1 006241   006714 235100                    LDA     3532,,PR0
         1 006242   000003 115007                    CMPA    3,DL
         1 006243   006245 602005 1                  TNC     SINTFMT+5,AL
         1 006244   006325 710000 1                  TRA     s:10518
         1 006245   006325 710000 1                  TRA     s:10518
         1 006246   006250 710000 1                  TRA     s:10508
         1 006247   006266 710000 1                  TRA     s:10511

     1417    10507    3               CASE ( %HOST );

     1418    10508    3                  IF SIZE > WRD_SIZE THEN GOTO WRONG_SIZE;

  10508  1 006250   200004 471500                    LDP1    @SIZE,,AUTO
         1 006251   200054 236100                    LDQ     WRD_SIZE,,AUTO
         1 006252   006255 604000 1                  TMI     s:10509
         1 006253   100000 116100                    CMPQ    0,,PR1
         1 006254   010560 604000 1                  TMI     WRONG_SIZE

     1419    10509    3                  IF VBITS(0) = 1 THEN NEG = '1'B;

  10509  1 006255   200012 236100                    LDQ     CVALUES,,AUTO
         1 006256   400000 376003                    ANQ     -131072,DU
         1 006257   000027 676000 xsym               ERQ     B_VECTNIL+23
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:231  
         1 006260   000001 036007                    ADLQ    1,DL
         1 006261   400000 116003                    CMPQ    -131072,DU
         1 006262   006325 601000 1                  TNZ     s:10518

  10509  1 006263   400000 236003                    LDQ     -131072,DU
         1 006264   200113 756100                    STQ     NEG,,AUTO
         1 006265   006325 710000 1                  TRA     s:10518

     1420    10510    3               CASE ( %L6 );

     1421    10511    3                  IF SIZE > 32 THEN GOTO WRONG_SIZE;

  10511  1 006266   200004 471500                    LDP1    @SIZE,,AUTO
         1 006267   100000 235100                    LDA     0,,PR1
         1 006270   000040 115007                    CMPA    32,DL
         1 006271   010560 605400 1                  TPNZ    WRONG_SIZE

     1422    10512    3                  IF L6_VAL.BIT16.SIGN(0) = '1'B THEN NEG = '1'B;

  10512  1 006272   200012 236100                    LDQ     CVALUES,,AUTO
         1 006273   100000 316007                    CANQ    32768,DL
         1 006274   006277 600000 1                  TZE     s:10513

  10512  1 006275   400000 236003                    LDQ     -131072,DU
         1 006276   200113 756100                    STQ     NEG,,AUTO

     1423    10513    4                  DO I = 0 TO SIZE/16;

  10513  1 006277   200111 450100                    STZ     I,,AUTO
         1 006300   006313 710000 1                  TRA     s:10515+3

     1424    10514    4                       L6_NUVAL(I) = L6_VAL.L6_WRD(I);

  10514  1 006301   200111 236100                    LDQ     I,,AUTO
         1 006302   000044 402007                    MPY     36,DL
         1 006303   200111 235100                    LDA     I,,AUTO
         1 006304   000004 735000                    ALS     4
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:232  
         1 006305   003105 060506                    CSL     bolr='003'O
         1 006306   200012 420020                    BDSC    CVALUES,Q,AUTO           by=2,bit=2,n=16
         1 006307   200032 000020                    BDSC    HOST_NUVAL,A,AUTO        by=0,bit=0,n=16

     1425    10515    4                     END;

  10515  1 006310   200111 235100                    LDA     I,,AUTO
         1 006311   000001 035007                    ADLA    1,DL
         1 006312   200111 755100                    STA     I,,AUTO
         1 006313   200004 470500                    LDP0    @SIZE,,AUTO
         1 006314   000000 236100                    LDQ     0,,PR0
         1 006315   000020 506007                    DIV     16,DL
         1 006316   000000 116003                    CMPQ    0,DU
         1 006317   006322 604000 1                  TMI     s:10516
         1 006320   200111 116100                    CMPQ    I,,AUTO
         1 006321   006301 603000 1                  TRC     s:10514

     1426    10516    3                  VBITS = NUVAL_BITS;

  10516  1 006322   000100 100500                    MLR     fill='000'O
         1 006323   200032 000100                    ADSC9   HOST_NUVAL,,AUTO         cn=0,n=64
         1 006324   200012 000100                    ADSC9   CVALUES,,AUTO            cn=0,n=64

     1427    10517    3               END;

     1428    10518    2             IF NEG AND FMT = %SINT_FMT

  10518  1 006325   200113 234100                    SZN     NEG,,AUTO
         1 006326   006362 605000 1                  TPL     s:10529
         1 006327   200052 235100                    LDA     FMT,,AUTO
         1 006330   000003 115007                    CMPA    3,DL
         1 006331   006362 601000 1                  TNZ     s:10529

     1429    10519    3             THEN DO;

     1430    10520    3                  TEXT$ -> CHAR1 = '-';

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:233  
  10520  1 006332   200217 470500                    LDP0    TEXT$,,AUTO
         1 006333   040100 100400                    MLR     fill='040'O
         1 006334   000002 000001 2                  ADSC9   2                        cn=0,n=1
         1 006335   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1431    10521    3                  CALL DDR$BUMPC_D$(1) ALTRET (DERR);

  10521  1 006336   000000 630400 2                  EPPR0   0
         1 006337   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006340   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 006341   010563 702000 1                  TSX2    DERR

     1432    10522    3                  TEXT$ = S_D.D$;

  10522  1 006342   000000 470400 xsym               LDP0    S_D$
         1 006343   000044 236100                    LDQ     36,,PR0
         1 006344   200217 756100                    STQ     TEXT$,,AUTO

     1433    10523    3                  HOST_VAL(0) = HOST_VAL(0)\'777777777777'O;
             10523                           /* Convert into a positive value */

  10523  1 006345   200012 236100                    LDQ     CVALUES,,AUTO
         1 006346   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 006347   200012 756100                    STQ     CVALUES,,AUTO

     1434    10524    3                  IF SIZE < 36

  10524  1 006350   200004 471500                    LDP1    @SIZE,,AUTO
         1 006351   100000 235100                    LDA     0,,PR1
         1 006352   000044 115007                    CMPA    36,DL
         1 006353   006357 605000 1                  TPL     s:10526

     1435    10525    3                  THEN CALL STRETCH;

  10525  1 006354   010752 701000 1                  TSX1    STRETCH
         1 006355   000000 011000                    NOP     0
         1 006356   006360 710000 1                  TRA     s:10527
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:234  

     1436    10526    3                  ELSE VALBITS = HOST_VAL(0);

  10526  1 006357   200216 756100                    STQ     VAL,,AUTO

     1437    10527    3                  VAL = VAL + 1;

  10527  1 006360   200216 054100                    AOS     VAL,,AUTO

     1438    10528    3                END;

  10528  1 006361   006373 710000 1                  TRA     s:10532

     1439    10529    2             ELSE IF SIZE < 36

  10529  1 006362   200004 470500                    LDP0    @SIZE,,AUTO
         1 006363   000000 235100                    LDA     0,,PR0
         1 006364   000044 115007                    CMPA    36,DL
         1 006365   006371 605000 1                  TPL     s:10531

     1440    10530    2                  THEN CALL STRETCH;

  10530  1 006366   010752 701000 1                  TSX1    STRETCH
         1 006367   000000 011000                    NOP     0
         1 006370   006373 710000 1                  TRA     s:10532

     1441    10531    2                  ELSE VALBITS = HOST_VAL(0);

  10531  1 006371   200012 236100                    LDQ     CVALUES,,AUTO
         1 006372   200216 756100                    STQ     VAL,,AUTO

     1442    10532    2             CALL DDR$BINTXT ( MYBUF$, VAL, %UINT_FMT, NCHARS );

  10532  1 006373   200055 630500                    EPPR0   NCHARS,,AUTO
         1 006374   200235 450500                    STP0    DIG+4,,AUTO
         1 006375   000003 236000 2                  LDQ     3
         1 006376   200234 756100                    STQ     DIG+3,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:235  
         1 006377   200216 631500                    EPPR1   VAL,,AUTO
         1 006400   200233 451500                    STP1    DIG+2,,AUTO
         1 006401   200214 633500                    EPPR3   MYBUF$,,AUTO
         1 006402   200232 453500                    STP3    DIG+1,,AUTO
         1 006403   200232 630500                    EPPR0   DIG+1,,AUTO
         1 006404   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 006405   000000 701000 xent               TSX1    DDR$BINTXT
         1 006406   000000 011000                    NOP     0

     1443    10533    2             TEXT$ -> TEXTR = MYBUF;

  10533  1 006407   200217 470500                    LDP0    TEXT$,,AUTO
         1 006410   200055 720100                    LXL0    NCHARS,,AUTO
         1 006411   040140 100500                    MLR     fill='040'O
         1 006412   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 006413   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

     1444    10534    2             CALL DDR$BUMPC_D$(NCHARS) ALTRET (DERR);

  10534  1 006414   200055 631500                    EPPR1   NCHARS,,AUTO
         1 006415   200232 451500                    STP1    DIG+1,,AUTO
         1 006416   200232 630500                    EPPR0   DIG+1,,AUTO
         1 006417   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006420   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 006421   010563 702000 1                  TSX2    DERR

     1445    10535    2             RETURN;

  10535  1 006422   000000 702200 xent               TSX2  ! X66_ARET

     1446    10536                                                /************************
     1447    10537                                                 ******* STATUS_FMT *****
     1448    10538                                                 ************************/
     1449    10539    2          CASE( %STATUS_FMT );

     1450    10540    2             S_D.D$ = ADDR(S_D.OUTPUT);

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:236  
  10540  1 006423   000000 236000 xsym               LDQ     S_D$
         1 006424   005335 036003                    ADLQ    2781,DU
         1 006425   000000 470400 xsym               LDP0    S_D$
         1 006426   000044 756100                    STQ     36,,PR0

     1451    10541    2             S_D.OUTPUT = ' ';

  10541  1 006427   040100 100400                    MLR     fill='040'O
         1 006430   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 006431   005335 004000                    ADSC9   2781,,PR0                cn=0,n=2048

     1452    10542    2             TEMP = LENGTHC( S_D.OUTPUT );

  10542  1 006432   004000 235007                    LDA     2048,DL
         1 006433   200077 755100                    STA     TEMP,,AUTO

     1453    10543    2             CALL DDR$MOVE(' Status:', LENGTHC(' Status:'), S_D.D$, TEMP);

  10543  1 006434   200077 631500                    EPPR1   TEMP,,AUTO
         1 006435   200235 451500                    STP1    DIG+4,,AUTO
         1 006436   000000 236000 xsym               LDQ     S_D$
         1 006437   000044 036003                    ADLQ    36,DU
         1 006440   200234 756100                    STQ     DIG+3,,AUTO
         1 006441   000040 237000 2                  LDAQ    32
         1 006442   200232 757100                    STAQ    DIG+1,,AUTO
         1 006443   200232 630500                    EPPR0   DIG+1,,AUTO
         1 006444   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 006445   000000 701000 xent               TSX1    DDR$MOVE
         1 006446   000000 011000                    NOP     0

     1454    10544    2             CALL DDQ$WRITE(ADDR(S_D.OUTPUT), POFFC(S_D.D$, ADDR(S_D.OUTPUT)));

  10544  1 006447   000000 236000 xsym               LDQ     S_D$
         1 006450   005335 036003                    ADLQ    2781,DU
         1 006451   000020 772000                    QRL     16
         1 006452   200232 756100                    STQ     DIG+1,,AUTO
         1 006453   000000 470400 xsym               LDP0    S_D$
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:237  
         1 006454   000044 236100                    LDQ     36,,PR0
         1 006455   000020 772000                    QRL     16
         1 006456   200232 136100                    SBLQ    DIG+1,,AUTO
         1 006457   200234 756100                    STQ     DIG+3,,AUTO
         1 006460   000000 236000 xsym               LDQ     S_D$
         1 006461   005335 036003                    ADLQ    2781,DU
         1 006462   200233 756100                    STQ     DIG+2,,AUTO
         1 006463   200234 235100                    LDA     DIG+3,,AUTO
         1 006464   200235 755100                    STA     DIG+4,,AUTO
         1 006465   200235 631500                    EPPR1   DIG+4,,AUTO
         1 006466   200237 451500                    STP1    DIG+6,,AUTO
         1 006467   200233 633500                    EPPR3   DIG+2,,AUTO
         1 006470   200236 453500                    STP3    DIG+5,,AUTO
         1 006471   200236 630500                    EPPR0   DIG+5,,AUTO
         1 006472   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 006473   000000 701000 xent               TSX1    DDQ$WRITE
         1 006474   000000 011000                    NOP     0

     1455    10545    2             S_D.D$ = ADDR(S_D.OUTPUT);

  10545  1 006475   000000 236000 xsym               LDQ     S_D$
         1 006476   005335 036003                    ADLQ    2781,DU
         1 006477   000000 470400 xsym               LDP0    S_D$
         1 006500   000044 756100                    STQ     36,,PR0

     1456    10546    2             S_D.OUTPUT = ' ';

  10546  1 006501   040100 100400                    MLR     fill='040'O
         1 006502   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 006503   005335 004000                    ADSC9   2781,,PR0                cn=0,n=2048

     1457    10547    2             CALL DDQ$WRITE(ADDR(S_D.OUTPUT), 2);

  10547  1 006504   200232 756100                    STQ     DIG+1,,AUTO
         1 006505   000003 236000 2                  LDQ     3
         1 006506   200235 756100                    STQ     DIG+4,,AUTO
         1 006507   200232 631500                    EPPR1   DIG+1,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:238  
         1 006510   200234 451500                    STP1    DIG+3,,AUTO
         1 006511   200234 630500                    EPPR0   DIG+3,,AUTO
         1 006512   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 006513   000000 701000 xent               TSX1    DDQ$WRITE
         1 006514   000000 011000                    NOP     0

     1458    10548    2             WRD_SIZE = (SIZE + 15) / 16;

  10548  1 006515   200004 470500                    LDP0    @SIZE,,AUTO
         1 006516   000000 236100                    LDQ     0,,PR0
         1 006517   000017 036007                    ADLQ    15,DL
         1 006520   000020 506007                    DIV     16,DL
         1 006521   200054 756100                    STQ     WRD_SIZE,,AUTO

     1459    10549    2             TEMP = SIZE;

  10549  1 006522   000000 235100                    LDA     0,,PR0
         1 006523   200077 755100                    STA     TEMP,,AUTO

     1460    10550    2             TENTRY# = PNPOINTERS.TRUE;

  10550  1 006524   200010 471500                    LDP1    @PNPOINTERS,,AUTO
         1 006525   100000 236100                    LDQ     0,,PR1
         1 006526   000022 732000                    QRS     18
         1 006527   200120 756100                    STQ     TENTRY#,,AUTO

     1461    10551    2             FENTRY# = PNPOINTERS.FALSE;

  10551  1 006530   100000 236100                    LDQ     0,,PR1
         1 006531   000022 736000                    QLS     18
         1 006532   000022 732000                    QRS     18
         1 006533   200121 756100                    STQ     FENTRY#,,AUTO

     1462    10552    3             DO I = 0 TO WRD_SIZE - 1;

  10552  1 006534   200111 450100                    STZ     I,,AUTO
         1 006535   006724 710000 1                  TRA     s:10572+3
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:239  

     1463    10553    3                  VAL = BITBIN(L6_VAL.L6_WRD(I));

  10553  1 006536   200111 720100                    LXL0    I,,AUTO
         1 006537   200012 236110                    LDQ     CVALUES,X0,AUTO
         1 006540   177777 376007                    ANQ     65535,DL
         1 006541   200216 756100                    STQ     VAL,,AUTO

     1464    10554    4                  DO J = 0 TO 15;

  10554  1 006542   200112 450100                    STZ     J,,AUTO

     1465    10555    4                       CALL DDF$DBG_#(TENTRY#, TENTRY$) ALTRET(BADSCHEMA);

  10555  1 006543   200122 630500                    EPPR0   TENTRY$,,AUTO
         1 006544   200233 450500                    STP0    DIG+2,,AUTO
         1 006545   200120 631500                    EPPR1   TENTRY#,,AUTO
         1 006546   200232 451500                    STP1    DIG+1,,AUTO
         1 006547   200232 630500                    EPPR0   DIG+1,,AUTO
         1 006550   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 006551   000000 701000 xent               TSX1    DDF$DBG_#
         1 006552   010554 702000 1                  TSX2    BADSCHEMA

     1466    10556    4                       CALL DDF$DBG_#(FENTRY#, FENTRY$) ALTRET(BADSCHEMA);

  10556  1 006553   200123 630500                    EPPR0   FENTRY$,,AUTO
         1 006554   200233 450500                    STP0    DIG+2,,AUTO
         1 006555   200121 631500                    EPPR1   FENTRY#,,AUTO
         1 006556   200232 451500                    STP1    DIG+1,,AUTO
         1 006557   200232 630500                    EPPR0   DIG+1,,AUTO
         1 006560   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 006561   000000 701000 xent               TSX1    DDF$DBG_#
         1 006562   010554 702000 1                  TSX2    BADSCHEMA

     1467    10557    4                       IF L6TIME_VAL.BITS(J)

  10557  1 006563   200112 235100                    LDA     J,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:240  
         1 006564   000000 066505                    CMPB    filb='0'B
         1 006565   200216 420001                    BDSC    VAL,A,AUTO               by=2,bit=2,n=1
         1 006566   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 006567   006573 600000 1                  TZE     s:10559

     1468    10558    4                       THEN MYBUF$ = TENTRY$;

  10558  1 006570   200122 236100                    LDQ     TENTRY$,,AUTO
         1 006571   200214 756100                    STQ     MYBUF$,,AUTO
         1 006572   006575 710000 1                  TRA     s:10560

     1469    10559    4                       ELSE MYBUF$ = FENTRY$;

  10559  1 006573   200123 236100                    LDQ     FENTRY$,,AUTO
         1 006574   200214 756100                    STQ     MYBUF$,,AUTO

     1470    10560    4                       NCHARS = MYBUF$ -> B$DNAME.COUNT;

  10560  1 006575   200214 470500                    LDP0    MYBUF$,,AUTO
         1 006576   000000 236100                    LDQ     0,,PR0
         1 006577   000022 772000                    QRL     18
         1 006600   200055 756100                    STQ     NCHARS,,AUTO

     1471    10561    4                       MYBUF$ = PINCRC(MYBUF$, 2);

  10561  1 006601   200214 236100                    LDQ     MYBUF$,,AUTO
         1 006602   400000 036007                    ADLQ    -131072,DL
         1 006603   200214 756100                    STQ     MYBUF$,,AUTO

     1472    10562    4                       CALL DDR$MOVE('    ', LENGTHC('    '), S_D.D$, TEMP);

  10562  1 006604   200077 630500                    EPPR0   TEMP,,AUTO
         1 006605   200235 450500                    STP0    DIG+4,,AUTO
         1 006606   000000 236000 xsym               LDQ     S_D$
         1 006607   000044 036003                    ADLQ    36,DU
         1 006610   200234 756100                    STQ     DIG+3,,AUTO
         1 006611   000042 237000 2                  LDAQ    34
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:241  
         1 006612   200232 757100                    STAQ    DIG+1,,AUTO
         1 006613   200232 630500                    EPPR0   DIG+1,,AUTO
         1 006614   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 006615   000000 701000 xent               TSX1    DDR$MOVE
         1 006616   000000 011000                    NOP     0

     1473    10563    4                       TEXT$ = S_D.D$;

  10563  1 006617   000000 470400 xsym               LDP0    S_D$
         1 006620   000044 236100                    LDQ     36,,PR0
         1 006621   200217 756100                    STQ     TEXT$,,AUTO

     1474    10564    4                       TEXT$ -> TEXTR = MYBUF$ -> TEXTR;

  10564  1 006622   200214 471500                    LDP1    MYBUF$,,AUTO
         1 006623   200055 720100                    LXL0    NCHARS,,AUTO
         1 006624   200217 473500                    LDP3    TEXT$,,AUTO
         1 006625   040140 100540                    MLR     fill='040'O
         1 006626   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         1 006627   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0

     1475    10565    4                       CALL DDR$BUMPC_D$(NCHARS - 1);

  10565  1 006630   200055 235100                    LDA     NCHARS,,AUTO
         1 006631   000001 135007                    SBLA    1,DL
         1 006632   200232 755100                    STA     DIG+1,,AUTO
         1 006633   200232 631500                    EPPR1   DIG+1,,AUTO
         1 006634   200233 451500                    STP1    DIG+2,,AUTO
         1 006635   200233 630500                    EPPR0   DIG+2,,AUTO
         1 006636   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006637   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 006640   000000 011000                    NOP     0

     1476    10566    4                      CALL DDQ$WRITE(ADDR(S_D.OUTPUT), POFFC(S_D.D$, ADDR(S_D.OUTPUT))
             10566                                );

  10566  1 006641   000000 236000 xsym               LDQ     S_D$
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:242  
         1 006642   005335 036003                    ADLQ    2781,DU
         1 006643   000020 772000                    QRL     16
         1 006644   200232 756100                    STQ     DIG+1,,AUTO
         1 006645   000000 470400 xsym               LDP0    S_D$
         1 006646   000044 236100                    LDQ     36,,PR0
         1 006647   000020 772000                    QRL     16
         1 006650   200232 136100                    SBLQ    DIG+1,,AUTO
         1 006651   200234 756100                    STQ     DIG+3,,AUTO
         1 006652   000000 236000 xsym               LDQ     S_D$
         1 006653   005335 036003                    ADLQ    2781,DU
         1 006654   200233 756100                    STQ     DIG+2,,AUTO
         1 006655   200234 235100                    LDA     DIG+3,,AUTO
         1 006656   200235 755100                    STA     DIG+4,,AUTO
         1 006657   200235 631500                    EPPR1   DIG+4,,AUTO
         1 006660   200237 451500                    STP1    DIG+6,,AUTO
         1 006661   200233 633500                    EPPR3   DIG+2,,AUTO
         1 006662   200236 453500                    STP3    DIG+5,,AUTO
         1 006663   200236 630500                    EPPR0   DIG+5,,AUTO
         1 006664   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 006665   000000 701000 xent               TSX1    DDQ$WRITE
         1 006666   000000 011000                    NOP     0

     1477    10567    4                       S_D.D$ = ADDR(S_D.OUTPUT);

  10567  1 006667   000000 236000 xsym               LDQ     S_D$
         1 006670   005335 036003                    ADLQ    2781,DU
         1 006671   000000 470400 xsym               LDP0    S_D$
         1 006672   000044 756100                    STQ     36,,PR0

     1478    10568    4                       TEMP = TEMP - 1;

  10568  1 006673   200077 235100                    LDA     TEMP,,AUTO
         1 006674   000001 135007                    SBLA    1,DL
         1 006675   200077 755100                    STA     TEMP,,AUTO

     1479    10569    4                       TENTRY# = TENTRY# + (TENTRY$ -> B$DNAME.COUNT + 5)/4;

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:243  
  10569  1 006676   200122 471500                    LDP1    TENTRY$,,AUTO
         1 006677   100000 236100                    LDQ     0,,PR1
         1 006700   000022 772000                    QRL     18
         1 006701   000005 036007                    ADLQ    5,DL
         1 006702   000002 772000                    QRL     2
         1 006703   200120 036100                    ADLQ    TENTRY#,,AUTO
         1 006704   200120 756100                    STQ     TENTRY#,,AUTO

     1480    10570    4                       FENTRY# = FENTRY# + (FENTRY$ -> B$DNAME.COUNT + 5)/4;

  10570  1 006705   200123 473500                    LDP3    FENTRY$,,AUTO
         1 006706   300000 236100                    LDQ     0,,PR3
         1 006707   000022 772000                    QRL     18
         1 006710   000005 036007                    ADLQ    5,DL
         1 006711   000002 772000                    QRL     2
         1 006712   200121 036100                    ADLQ    FENTRY#,,AUTO
         1 006713   200121 756100                    STQ     FENTRY#,,AUTO

     1481    10571    4                     END;

  10571  1 006714   200112 235100                    LDA     J,,AUTO
         1 006715   000001 035007                    ADLA    1,DL
         1 006716   200112 755100                    STA     J,,AUTO
         1 006717   000020 115007                    CMPA    16,DL
         1 006720   006543 602000 1                  TNC     s:10555

     1482    10572    3                END;

  10572  1 006721   200111 235100                    LDA     I,,AUTO
         1 006722   000001 035007                    ADLA    1,DL
         1 006723   200111 755100                    STA     I,,AUTO
         1 006724   200111 236100                    LDQ     I,,AUTO
         1 006725   200054 116100                    CMPQ    WRD_SIZE,,AUTO
         1 006726   006536 602000 1                  TNC     s:10553
         1 006727   010550 710000 1                  TRA     s:10845

     1483    10573                                                /************************
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:244  
     1484    10574                                                 ******* TIME_FMT *******
     1485    10575                                                 ************************/
     1486    10576    2          CASE( %TIME_FMT );

     1487    10577
     1488    10578    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );

  10578  1 006730   000000 470400 xsym               LDP0    S_D$
         1 006731   006714 235100                    LDA     3532,,PR0
         1 006732   000003 115007                    CMPA    3,DL
         1 006733   006735 602005 1                  TNC     s:10578+5,AL
         1 006734   007025 710000 1                  TRA     s:10595
         1 006735   007025 710000 1                  TRA     s:10595
         1 006736   006740 710000 1                  TRA     s:10581
         1 006737   006767 710000 1                  TRA     s:10588

     1489    10579
     1490    10580    3               CASE ( %HOST );

     1491    10581    3                  IF SIZE > 36 THEN GOTO WRONG_SIZE;

  10581  1 006740   200004 471500                    LDP1    @SIZE,,AUTO
         1 006741   100000 235100                    LDA     0,,PR1
         1 006742   000044 115007                    CMPA    36,DL
         1 006743   010560 605400 1                  TPNZ    WRONG_SIZE

     1492    10582    3                  IF SIZE < 36

  10582  1 006744   006750 605000 1                  TPL     s:10584

     1493    10583    3                  THEN CALL STRETCH;

  10583  1 006745   010752 701000 1                  TSX1    STRETCH
         1 006746   000000 011000                    NOP     0
         1 006747   006752 710000 1                  TRA     s:10585

     1494    10584    3                  ELSE VAL = VALUE.L;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:245  

  10584  1 006750   200012 236100                    LDQ     CVALUES,,AUTO
         1 006751   200216 756100                    STQ     VAL,,AUTO

     1495    10585    3                  CALL DDR$BUMPC_D$ ( 20 ) ALTRET ( DERR );

  10585  1 006752   000044 630400 2                  EPPR0   36
         1 006753   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006754   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 006755   010563 702000 1                  TSX2    DERR

     1496    10586    3                  CALL DDA$UTSTIME (VAL, TEXT$->CHAR1);

  10586  1 006756   200217 236100                    LDQ     TEXT$,,AUTO
         1 006757   200233 756100                    STQ     DIG+2,,AUTO
         1 006760   200216 630500                    EPPR0   VAL,,AUTO
         1 006761   200232 450500                    STP0    DIG+1,,AUTO
         1 006762   200232 630500                    EPPR0   DIG+1,,AUTO
         1 006763   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 006764   000000 701000 xent               TSX1    DDA$UTSTIME
         1 006765   000000 011000                    NOP     0
         1 006766   007025 710000 1                  TRA     s:10595

     1497    10587    3               CASE ( %L6 );

     1498    10588    3                  IF SIZE > 32 THEN GOTO WRONG_SIZE;

  10588  1 006767   200004 471500                    LDP1    @SIZE,,AUTO
         1 006770   100000 235100                    LDA     0,,PR1
         1 006771   000040 115007                    CMPA    32,DL
         1 006772   010560 605400 1                  TPNZ    WRONG_SIZE

     1499    10589    3                  VAL = BITBIN(L6_VAL.L6_WRD(0));

  10589  1 006773   200012 236100                    LDQ     CVALUES,,AUTO
         1 006774   177777 376007                    ANQ     65535,DL
         1 006775   200216 756100                    STQ     VAL,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:246  

     1500    10590    3                  IF SIZE > 16 THEN

  10590  1 006776   100000 235100                    LDA     0,,PR1
         1 006777   000020 115007                    CMPA    16,DL
         1 007000   007011 604400 1                  TMOZ    s:10592

     1501    10591    3                       VAL = VAL * BITBIN('10000'X) + BITBIN(L6_VAL.L6_WRD(1));

  10591  1 007001   000114 236000 0                  LDQ     HEXCHARS+51
         1 007002   000020 772000                    QRL     16
         1 007003   200216 402100                    MPY     VAL,,AUTO
         1 007004   200232 756100                    STQ     DIG+1,,AUTO
         1 007005   200013 236100                    LDQ     CVALUES+1,,AUTO
         1 007006   177777 376007                    ANQ     65535,DL
         1 007007   200232 036100                    ADLQ    DIG+1,,AUTO
         1 007010   200216 756100                    STQ     VAL,,AUTO

     1502    10592    3                  CALL DDR$BUMPC_D$ (20) ALTRET (DERR);

  10592  1 007011   000044 630400 2                  EPPR0   36
         1 007012   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 007013   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 007014   010563 702000 1                  TSX2    DERR

     1503    10593    3                  CALL DFR$UTSTIME (VAL, TEXT$->CHAR1);

  10593  1 007015   200217 236100                    LDQ     TEXT$,,AUTO
         1 007016   200233 756100                    STQ     DIG+2,,AUTO
         1 007017   200216 630500                    EPPR0   VAL,,AUTO
         1 007020   200232 450500                    STP0    DIG+1,,AUTO
         1 007021   200232 630500                    EPPR0   DIG+1,,AUTO
         1 007022   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 007023   000000 701000 xent               TSX1    DFR$UTSTIME
         1 007024   000000 011000                    NOP     0

     1504    10594    3               END;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:247  

     1505    10595    2             RETURN;

  10595  1 007025   000000 702200 xent               TSX2  ! X66_ARET

     1506    10596                                                /**************************
     1507    10597                                                 ******* VECTOR_FMT *******
     1508    10598                                                 **************************/
     1509    10599    2          CASE( %VECTOR_FMT );

     1510    10600
     1511    10601    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );

  10601  1 007026   000000 470400 xsym               LDP0    S_D$
         1 007027   006714 235100                    LDA     3532,,PR0
         1 007030   000003 115007                    CMPA    3,DL
         1 007031   007033 602005 1                  TNC     s:10601+5,AL
         1 007032   007731 710000 1                  TRA     s:10720
         1 007033   007731 710000 1                  TRA     s:10720
         1 007034   007036 710000 1                  TRA     s:10605
         1 007035   007576 710000 1                  TRA     s:10698

     1512    10602
     1513    10603    3               CASE ( %HOST );

     1514    10604
     1515    10605    3                  IF SIZE = 36 THEN GOTO ONLY36;

  10605  1 007036   200004 471500                    LDP1    @SIZE,,AUTO
         1 007037   100000 235100                    LDA     0,,PR1
         1 007040   000044 115007                    CMPA    36,DL
         1 007041   007325 600000 1                  TZE     ONLY36

     1516    10606    3                  IF SIZE ~= 72 THEN GOTO WRONG_SIZE;

  10606  1 007042   000110 115007                    CMPA    72,DL
         1 007043   010560 601000 1                  TNZ     WRONG_SIZE
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:248  

     1517    10607    3                  VAL = VVALUE.W2.W;

  10607  1 007044   200013 236100                    LDQ     CVALUES+1,,AUTO
         1 007045   000022 772000                    QRL     18
         1 007046   200216 756100                    STQ     VAL,,AUTO

     1518    10608    3                  CALL DDR$BINTXT( MYBUF$, VAL, %OCT_FMT, NCHARS );

  10608  1 007047   200055 633500                    EPPR3   NCHARS,,AUTO
         1 007050   200235 453500                    STP3    DIG+4,,AUTO
         1 007051   000000 236000 2                  LDQ     0
         1 007052   200234 756100                    STQ     DIG+3,,AUTO
         1 007053   200216 634500                    EPPR4   VAL,,AUTO
         1 007054   200233 454500                    STP4    DIG+2,,AUTO
         1 007055   200214 635500                    EPPR5   MYBUF$,,AUTO
         1 007056   200232 455500                    STP5    DIG+1,,AUTO
         1 007057   200232 630500                    EPPR0   DIG+1,,AUTO
         1 007060   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 007061   000000 701000 xent               TSX1    DDR$BINTXT
         1 007062   000000 011000                    NOP     0

     1519    10609    3                  CALL DDR$BUMPC_D$( NCHARS );

  10609  1 007063   200055 630500                    EPPR0   NCHARS,,AUTO
         1 007064   200232 450500                    STP0    DIG+1,,AUTO
         1 007065   200232 630500                    EPPR0   DIG+1,,AUTO
         1 007066   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 007067   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 007070   000000 011000                    NOP     0

     1520    10610    3                  TEXT$ -> TEXTR = MYBUF;

  10610  1 007071   200217 470500                    LDP0    TEXT$,,AUTO
         1 007072   200055 720100                    LXL0    NCHARS,,AUTO
         1 007073   040140 100500                    MLR     fill='040'O
         1 007074   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:249  
         1 007075   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

     1521    10611    3                  TEXT$ = S_D.D$;

  10611  1 007076   000000 471400 xsym               LDP1    S_D$
         1 007077   100044 236100                    LDQ     36,,PR1
         1 007100   200217 756100                    STQ     TEXT$,,AUTO

     1522    10612    3                  VAL = VVALUE.W2.C;

  10612  1 007101   200013 236100                    LDQ     CVALUES+1,,AUTO
         1 007102   000020 772000                    QRL     16
         1 007103   000003 376007                    ANQ     3,DL
         1 007104   200216 756100                    STQ     VAL,,AUTO

     1523    10613    3                  CALL DDR$BUMPC_D$( 3 ) ALTRET( DERR );

  10613  1 007105   000005 630400 2                  EPPR0   5
         1 007106   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 007107   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 007110   010563 702000 1                  TSX2    DERR

     1524    10614    3                  TEXT$ -> CHAR1 = '-';

  10614  1 007111   200217 470500                    LDP0    TEXT$,,AUTO
         1 007112   040100 100400                    MLR     fill='040'O
         1 007113   000002 000001 2                  ADSC9   2                        cn=0,n=1
         1 007114   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1525    10615    3                  TEXT$ = PINCRC(TEXT$, LENGTHC('-'));

  10615  1 007115   200217 236100                    LDQ     TEXT$,,AUTO
         1 007116   200000 036007                    ADLQ    65536,DL
         1 007117   200217 756100                    STQ     TEXT$,,AUTO

     1526    10616    3                  CALL BINCHAR(TEXT$ -> CHAR1, VAL);

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:250  
  10616  1 007120   200217 470500                    LDP0    TEXT$,,AUTO
         1 007121   000100 301500                    BTD
         1 007122   200216 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         1 007123   000000 030001                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=1

     1527    10617    3                  PINCRC(TEXT$, 1) -> CHAR1 = '-';

  10617  1 007124   040100 100400                    MLR     fill='040'O
         1 007125   000002 000001 2                  ADSC9   2                        cn=0,n=1
         1 007126   000000 200001                    ADSC9   0,,PR0                   cn=1,n=1

     1528    10618    3                  TEXT$ = PINCRC(TEXT$, LENGTHC('-')+1);

  10618  1 007127   400000 036007                    ADLQ    -131072,DL
         1 007130   200217 756100                    STQ     TEXT$,,AUTO

     1529    10619    3                  VAL = VVALUE.W2.B;

  10619  1 007131   200013 236100                    LDQ     CVALUES+1,,AUTO
         1 007132   000014 772000                    QRL     12
         1 007133   000017 376007                    ANQ     15,DL
         1 007134   200216 756100                    STQ     VAL,,AUTO

     1530    10620    3                  CALL DDR$BINTXT(MYBUF$, VAL, %UINT_FMT, NCHARS);

  10620  1 007135   200055 630500                    EPPR0   NCHARS,,AUTO
         1 007136   200235 450500                    STP0    DIG+4,,AUTO
         1 007137   000003 236000 2                  LDQ     3
         1 007140   200234 756100                    STQ     DIG+3,,AUTO
         1 007141   200216 631500                    EPPR1   VAL,,AUTO
         1 007142   200233 451500                    STP1    DIG+2,,AUTO
         1 007143   200214 633500                    EPPR3   MYBUF$,,AUTO
         1 007144   200232 453500                    STP3    DIG+1,,AUTO
         1 007145   200232 630500                    EPPR0   DIG+1,,AUTO
         1 007146   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 007147   000000 701000 xent               TSX1    DDR$BINTXT
         1 007150   000000 011000                    NOP     0
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:251  

     1531    10621    3                  CALL DDR$BUMPC_D$( NCHARS ) ALTRET( DERR );

  10621  1 007151   200055 630500                    EPPR0   NCHARS,,AUTO
         1 007152   200232 450500                    STP0    DIG+1,,AUTO
         1 007153   200232 630500                    EPPR0   DIG+1,,AUTO
         1 007154   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 007155   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 007156   010563 702000 1                  TSX2    DERR

     1532    10622    3                  TEXT$ -> TEXTR = MYBUF;

  10622  1 007157   200217 470500                    LDP0    TEXT$,,AUTO
         1 007160   200055 720100                    LXL0    NCHARS,,AUTO
         1 007161   040140 100500                    MLR     fill='040'O
         1 007162   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 007163   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

     1533    10623    3                  TEXT$ = PINCRC(TEXT$, NCHARS);

  10623  1 007164   200055 236100                    LDQ     NCHARS,,AUTO
         1 007165   000020 736000                    QLS     16
         1 007166   200217 036100                    ADLQ    TEXT$,,AUTO
         1 007167   200217 756100                    STQ     TEXT$,,AUTO

     1534    10624    3                  TEXT$ -> CHAR1 = ',';

  10624  1 007170   200217 470500                    LDP0    TEXT$,,AUTO
         1 007171   040100 100400                    MLR     fill='040'O
         1 007172   000004 000001 2                  ADSC9   4                        cn=0,n=1
         1 007173   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1535    10625    3                  TEXT$ = PINCRC(TEXT$, LENGTHC(','));

  10625  1 007174   200000 036007                    ADLQ    65536,DL
         1 007175   200217 756100                    STQ     TEXT$,,AUTO

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:252  
     1536    10626    3                  CALL DDR$BUMPC_D$( LENGTHC(',') ) ALTRET( DERR );

  10626  1 007176   000000 630400 2                  EPPR0   0
         1 007177   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 007200   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 007201   010563 702000 1                  TSX2    DERR

     1537    10627    3                  VAL = VVALUE.W2.SEG.S;

  10627  1 007202   200013 236100                    LDQ     CVALUES+1,,AUTO
         1 007203   000012 772000                    QRL     10
         1 007204   000003 376007                    ANQ     3,DL
         1 007205   200216 756100                    STQ     VAL,,AUTO

     1538    10628    3                  IF VAL = 1               /* Segid of .2000 is strange */

  10628  1 007206   000001 116007                    CMPQ    1,DL
         1 007207   007243 601000 1                  TNZ     s:10636

     1539    10629    4                  THEN DO;

     1540    10630    4                       VAL = BITBIN( VVALUE.W2.SEG );

  10630  1 007210   200013 236100                    LDQ     CVALUES+1,,AUTO
         1 007211   007777 376007                    ANQ     4095,DL
         1 007212   200216 756100                    STQ     VAL,,AUTO

     1541    10631    4                       CALL DDR$BINTXT(MYBUF$, VAL, %OCT_FMT, NCHARS);

  10631  1 007213   200055 630500                    EPPR0   NCHARS,,AUTO
         1 007214   200235 450500                    STP0    DIG+4,,AUTO
         1 007215   000000 236000 2                  LDQ     0
         1 007216   200234 756100                    STQ     DIG+3,,AUTO
         1 007217   200216 631500                    EPPR1   VAL,,AUTO
         1 007220   200233 451500                    STP1    DIG+2,,AUTO
         1 007221   200214 633500                    EPPR3   MYBUF$,,AUTO
         1 007222   200232 453500                    STP3    DIG+1,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:253  
         1 007223   200232 630500                    EPPR0   DIG+1,,AUTO
         1 007224   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 007225   000000 701000 xent               TSX1    DDR$BINTXT
         1 007226   000000 011000                    NOP     0

     1542    10632    4                       CALL DDR$BUMPC_D$( NCHARS ) ALTRET( DERR );

  10632  1 007227   200055 630500                    EPPR0   NCHARS,,AUTO
         1 007230   200232 450500                    STP0    DIG+1,,AUTO
         1 007231   200232 630500                    EPPR0   DIG+1,,AUTO
         1 007232   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 007233   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 007234   010563 702000 1                  TSX2    DERR

     1543    10633    4                       TEXT$ -> TEXTR = MYBUF;

  10633  1 007235   200217 470500                    LDP0    TEXT$,,AUTO
         1 007236   200055 720100                    LXL0    NCHARS,,AUTO
         1 007237   040140 100500                    MLR     fill='040'O
         1 007240   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 007241   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

     1544    10634    4                     END;

  10634  1 007242   007312 710000 1                  TRA     s:10644

     1545    10635    4                  ELSE DO;

     1546    10636    4                       CALL DDR$BUMPC_D$( 3 );

  10636  1 007243   000005 630400 2                  EPPR0   5
         1 007244   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 007245   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 007246   000000 011000                    NOP     0

     1547    10637    4                       TEXT$ -> CHAR3 = SEGID( VAL ); /* $xS */

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:254  
  10637  1 007247   200216 236100                    LDQ     VAL,,AUTO
         1 007250   000003 402007                    MPY     3,DL
         1 007251   200217 470500                    LDP0    TEXT$,,AUTO
         1 007252   040100 100406                    MLR     fill='040'O
         1 007253   000021 000003 0                  ADSC9   SEGID,Q                  cn=0,n=3
         1 007254   000000 000003                    ADSC9   0,,PR0                   cn=0,n=3

     1548    10638    4                       TEXT$ = S_D.D$;

  10638  1 007255   000000 471400 xsym               LDP1    S_D$
         1 007256   100044 236100                    LDQ     36,,PR1
         1 007257   200217 756100                    STQ     TEXT$,,AUTO

     1549    10639    4                       VAL = VVALUE.W2.SEG.D;

  10639  1 007260   200013 236100                    LDQ     CVALUES+1,,AUTO
         1 007261   001777 376007                    ANQ     1023,DL
         1 007262   200216 756100                    STQ     VAL,,AUTO

     1550    10640    4                       CALL DDR$BINTXT(MYBUF$, VAL, %UINT_FMT, NCHARS);

  10640  1 007263   200055 630500                    EPPR0   NCHARS,,AUTO
         1 007264   200235 450500                    STP0    DIG+4,,AUTO
         1 007265   000003 236000 2                  LDQ     3
         1 007266   200234 756100                    STQ     DIG+3,,AUTO
         1 007267   200216 633500                    EPPR3   VAL,,AUTO
         1 007270   200233 453500                    STP3    DIG+2,,AUTO
         1 007271   200214 634500                    EPPR4   MYBUF$,,AUTO
         1 007272   200232 454500                    STP4    DIG+1,,AUTO
         1 007273   200232 630500                    EPPR0   DIG+1,,AUTO
         1 007274   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 007275   000000 701000 xent               TSX1    DDR$BINTXT
         1 007276   000000 011000                    NOP     0

     1551    10641    4                       CALL DDR$BUMPC_D$( NCHARS ) ALTRET( DERR );

  10641  1 007277   200055 630500                    EPPR0   NCHARS,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:255  
         1 007300   200232 450500                    STP0    DIG+1,,AUTO
         1 007301   200232 630500                    EPPR0   DIG+1,,AUTO
         1 007302   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 007303   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 007304   010563 702000 1                  TSX2    DERR

     1552    10642    4                       TEXT$ -> TEXTR = MYBUF;

  10642  1 007305   200217 470500                    LDP0    TEXT$,,AUTO
         1 007306   200055 720100                    LXL0    NCHARS,,AUTO
         1 007307   040140 100500                    MLR     fill='040'O
         1 007310   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 007311   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

     1553    10643    4                     END;

     1554    10644    3                  TEXT$ = S_D.D$;

  10644  1 007312   000000 471400 xsym               LDP1    S_D$
         1 007313   100044 236100                    LDQ     36,,PR1
         1 007314   200217 756100                    STQ     TEXT$,,AUTO

     1555    10645    3                  CALL DDR$BUMPC_D$ (1) ALTRET (DERR);

  10645  1 007315   000000 630400 2                  EPPR0   0
         1 007316   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 007317   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 007320   010563 702000 1                  TSX2    DERR

     1556    10646    3                  TEXT$->CHAR1 = ',';

  10646  1 007321   200217 470500                    LDP0    TEXT$,,AUTO
         1 007322   040100 100400                    MLR     fill='040'O
         1 007323   000004 000001 2                  ADSC9   4                        cn=0,n=1
         1 007324   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1557    10647    3   ONLY36:        TEXT$ = S_D.D$;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:256  

  10647  1 007325   000000 470400 xsym  ONLY36       LDP0    S_D$
         1 007326   000044 236100                    LDQ     36,,PR0
         1 007327   200217 756100                    STQ     TEXT$,,AUTO

     1558    10648    3                  CALL DDR$BUMPC_D$ (3) ALTRET (DERR);

  10648  1 007330   000005 630400 2                  EPPR0   5
         1 007331   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 007332   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 007333   010563 702000 1                  TSX2    DERR

     1559    10649    3                  TEXT$->CHAR3 = 'BD=';

  10649  1 007334   200217 470500                    LDP0    TEXT$,,AUTO
         1 007335   040100 100400                    MLR     fill='040'O
         1 007336   000040 000003 0                  ADSC9   HEXCHARS+7               cn=0,n=3
         1 007337   000000 000003                    ADSC9   0,,PR0                   cn=0,n=3

     1560    10650    3                  TEXT$ = S_D.D$;

  10650  1 007340   000000 471400 xsym               LDP1    S_D$
         1 007341   100044 236100                    LDQ     36,,PR1
         1 007342   200217 756100                    STQ     TEXT$,,AUTO

     1561    10651    3                  IF VVALUE.W1.FLGS.NOTEMPTY

  10651  1 007343   200012 236100                    LDQ     CVALUES,,AUTO
         1 007344   000400 316007                    CANQ    256,DL
         1 007345   007424 600000 1                  TZE     s:10663

     1562    10652    4                  THEN DO;

     1563    10653    4                       VAL = VVALUE.W1.BOUND.W;

  10653  1 007346   200012 235100                    LDA     CVALUES,,AUTO
         1 007347   000022 771000                    ARL     18
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:257  
         1 007350   200216 755100                    STA     VAL,,AUTO

     1564    10654    4                       CALL DDR$BINTXT(MYBUF$, VAL, %OCT_FMT, NCHARS);

  10654  1 007351   200055 630500                    EPPR0   NCHARS,,AUTO
         1 007352   200235 450500                    STP0    DIG+4,,AUTO
         1 007353   000000 236000 2                  LDQ     0
         1 007354   200234 756100                    STQ     DIG+3,,AUTO
         1 007355   200216 633500                    EPPR3   VAL,,AUTO
         1 007356   200233 453500                    STP3    DIG+2,,AUTO
         1 007357   200214 634500                    EPPR4   MYBUF$,,AUTO
         1 007360   200232 454500                    STP4    DIG+1,,AUTO
         1 007361   200232 630500                    EPPR0   DIG+1,,AUTO
         1 007362   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 007363   000000 701000 xent               TSX1    DDR$BINTXT
         1 007364   000000 011000                    NOP     0

     1565    10655    4                       CALL DDR$BUMPC_D$( NCHARS+2 ) ALTRET( DERR );

  10655  1 007365   200055 235100                    LDA     NCHARS,,AUTO
         1 007366   000002 035007                    ADLA    2,DL
         1 007367   200232 755100                    STA     DIG+1,,AUTO
         1 007370   200232 630500                    EPPR0   DIG+1,,AUTO
         1 007371   200233 450500                    STP0    DIG+2,,AUTO
         1 007372   200233 630500                    EPPR0   DIG+2,,AUTO
         1 007373   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 007374   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 007375   010563 702000 1                  TSX2    DERR

     1566    10656    4                       TEXT$ -> TEXTR = MYBUF;

  10656  1 007376   200217 470500                    LDP0    TEXT$,,AUTO
         1 007377   200055 720100                    LXL0    NCHARS,,AUTO
         1 007400   040140 100500                    MLR     fill='040'O
         1 007401   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 007402   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:258  
     1567    10657    4                       TEXT$ = PINCRC(TEXT$, NCHARS+1);

  10657  1 007403   200055 236100                    LDQ     NCHARS,,AUTO
         1 007404   000020 736000                    QLS     16
         1 007405   200000 036007                    ADLQ    65536,DL
         1 007406   200217 036100                    ADLQ    TEXT$,,AUTO
         1 007407   200217 756100                    STQ     TEXT$,,AUTO

     1568    10658    4                       VAL = VVALUE.W1.BOUND.C;

  10658  1 007410   200012 236100                    LDQ     CVALUES,,AUTO
         1 007411   000020 772000                    QRL     16
         1 007412   000003 376007                    ANQ     3,DL
         1 007413   200216 756100                    STQ     VAL,,AUTO

     1569    10659    4                       PINCRC(TEXT$, -1) -> CHAR1 = '-';

  10659  1 007414   200217 470500                    LDP0    TEXT$,,AUTO
         1 007415   040100 100400                    MLR     fill='040'O
         1 007416   000002 000001 2                  ADSC9   2                        cn=0,n=1
         1 007417   077777 600001                    ADSC9   -1,,PR0                  cn=3,n=1

     1570    10660    4                       CALL BINCHAR(TEXT$ -> CHAR1, VAL);

  10660  1 007420   000100 301500                    BTD
         1 007421   200216 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         1 007422   000000 030001                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=1

     1571    10661    4                     END;

  10661  1 007423   007434 710000 1                  TRA     s:10666

     1572    10662    4                  ELSE DO;

     1573    10663    4                       CALL DDR$BUMPC_D$( LENGTHC('EMPTY') ) ALTRET( DERR );

  10663  1 007424   000001 630400 2                  EPPR0   1
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:259  
         1 007425   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 007426   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 007427   010563 702000 1                  TSX2    DERR

     1574    10664    4                       TEXT$ -> CHAR5 = 'EMPTY';

  10664  1 007430   200217 470500                    LDP0    TEXT$,,AUTO
         1 007431   040100 100400                    MLR     fill='040'O
         1 007432   000041 000005 0                  ADSC9   HEXCHARS+8               cn=0,n=5
         1 007433   000000 000005                    ADSC9   0,,PR0                   cn=0,n=5

     1575    10665    4                     END;

     1576    10666    3                  TEXT$ = S_D.D$;

  10666  1 007434   000000 471400 xsym               LDP1    S_D$
         1 007435   100044 236100                    LDQ     36,,PR1
         1 007436   200217 756100                    STQ     TEXT$,,AUTO

     1577    10667    3                  VAL = VVALUE.W1.FLAGS;

  10667  1 007437   200012 236100                    LDQ     CVALUES,,AUTO
         1 007440   000007 772000                    QRL     7
         1 007441   000777 376007                    ANQ     511,DL
         1 007442   200216 756100                    STQ     VAL,,AUTO

     1578    10668    3                  CALL DDR$BUMPC_D$( 12 ) ALTRET( DERR );

  10668  1 007443   000031 630400 2                  EPPR0   25
         1 007444   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 007445   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 007446   010563 702000 1                  TSX2    DERR

     1579    10669    3                  TEXT$ -> CHAR5 = ',FL=.';

  10669  1 007447   200217 470500                    LDP0    TEXT$,,AUTO
         1 007450   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:260  
         1 007451   000047 000005 0                  ADSC9   HEXCHARS+14              cn=0,n=5
         1 007452   000000 000005                    ADSC9   0,,PR0                   cn=0,n=5

     1580    10670    3                  CALL DDR$BINOCT(MYBUF, VAL);

  10670  1 007453   200216 631500                    EPPR1   VAL,,AUTO
         1 007454   200233 451500                    STP1    DIG+2,,AUTO
         1 007455   200134 633500                    EPPR3   MYBUF,,AUTO
         1 007456   200232 453500                    STP3    DIG+1,,AUTO
         1 007457   200232 630500                    EPPR0   DIG+1,,AUTO
         1 007460   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 007461   000000 701000 xent               TSX1    DDR$BINOCT
         1 007462   000000 011000                    NOP     0

     1581    10671    3                  TEXT$ = PINCRC(TEXT$, LENGTHC(',FL=.'));

  10671  1 007463   200217 236100                    LDQ     TEXT$,,AUTO
         1 007464   000020 036000 2                  ADLQ    16
         1 007465   200217 756100                    STQ     TEXT$,,AUTO

     1582    10672    3                  TEXT$ -> CHAR3 = PINCRC(MYBUF$, 9) -> CHAR3;

  10672  1 007466   200214 470500                    LDP0    MYBUF$,,AUTO
         1 007467   200217 471500                    LDP1    TEXT$,,AUTO
         1 007470   040100 100500                    MLR     fill='040'O
         1 007471   000002 200003                    ADSC9   2,,PR0                   cn=1,n=3
         1 007472   100000 000003                    ADSC9   0,,PR1                   cn=0,n=3

     1583    10673    3                  TEXT$ = PINCRC(TEXT$, 3);

  10673  1 007473   600000 036007                    ADLQ    -65536,DL
         1 007474   200217 756100                    STQ     TEXT$,,AUTO

     1584    10674    3                  TEXT$ -> CHAR4 = ',TY=';

  10674  1 007475   200217 470500                    LDP0    TEXT$,,AUTO
         1 007476   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:261  
         1 007477   000051 000004 0                  ADSC9   HEXCHARS+16              cn=0,n=4
         1 007500   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4

     1585    10675    3                  TEXT$ = PINCRC(TEXT$, LENGTHC(',TY='));

  10675  1 007501   000001 036003                    ADLQ    1,DU
         1 007502   200217 756100                    STQ     TEXT$,,AUTO

     1586    10676    3                  TYPE = VVALUE.W1.TYPE;

  10676  1 007503   200012 236100                    LDQ     CVALUES,,AUTO
         1 007504   000005 772000                    QRL     5
         1 007505   000003 376007                    ANQ     3,DL
         1 007506   200117 756100                    STQ     TYPE,,AUTO

     1587    10677    4                  DO CASE (TYPE);

  10677  1 007507   000004 116007                    CMPQ    4,DL
         1 007510   007512 602006 1                  TNC     s:10677+3,QL
         1 007511   007731 710000 1                  TRA     s:10720
         1 007512   007516 710000 1                  TRA     s:10679
         1 007513   007532 710000 1                  TRA     s:10683
         1 007514   007546 710000 1                  TRA     s:10687
         1 007515   007562 710000 1                  TRA     s:10691

     1588    10678    4                    CASE(0);               /* COPY */

     1589    10679    4                       TEXT$ -> CHAR4 = 'COPY';

  10679  1 007516   200217 470500                    LDP0    TEXT$,,AUTO
         1 007517   040100 100400                    MLR     fill='040'O
         1 007520   000115 000004 0                  ADSC9   HEXCHARS+52              cn=0,n=4
         1 007521   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4

     1590    10680    4                       TEXT$ = PINCRC(TEXT$, LENGTHC('COPY'));

  10680  1 007522   200217 236100                    LDQ     TEXT$,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:262  
         1 007523   000001 036003                    ADLQ    1,DU
         1 007524   200217 756100                    STQ     TEXT$,,AUTO

     1591    10681    4                       CALL DDR$BUMPC_D$( LENGTHC('COPY') );

  10681  1 007525   000043 630400 2                  EPPR0   35
         1 007526   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 007527   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 007530   000000 011000                    NOP     0
         1 007531   007731 710000 1                  TRA     s:10720

     1592    10682    4                    CASE(1);               /* NORMAL SHRINK */

     1593    10683    4                       TEXT$ -> CHAR13 = 'NORMAL SHRINK';

  10683  1 007532   200217 470500                    LDP0    TEXT$,,AUTO
         1 007533   040100 100400                    MLR     fill='040'O
         1 007534   000116 000015 0                  ADSC9   HEXCHARS+53              cn=0,n=13
         1 007535   000000 000015                    ADSC9   0,,PR0                   cn=0,n=13

     1594    10684    4                       TEXT$ = PINCRC(TEXT$, LENGTHC('NORMAL SHRINK'));

  10684  1 007536   200217 236100                    LDQ     TEXT$,,AUTO
         1 007537   000045 036000 2                  ADLQ    37
         1 007540   200217 756100                    STQ     TEXT$,,AUTO

     1595    10685    4                       CALL DDR$BUMPC_D$( LENGTHC('NORMAL SHRINK') );

  10685  1 007541   000010 630400 2                  EPPR0   8
         1 007542   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 007543   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 007544   000000 011000                    NOP     0
         1 007545   007731 710000 1                  TRA     s:10720

     1596    10686    4                    CASE(2);               /* EXTENDED SHRINK */

     1597    10687    4                       TEXT$ -> CHAR15 = 'EXTENDED SHRINK';
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:263  

  10687  1 007546   200217 470500                    LDP0    TEXT$,,AUTO
         1 007547   040100 100400                    MLR     fill='040'O
         1 007550   000122 000017 0                  ADSC9   HEXCHARS+57              cn=0,n=15
         1 007551   000000 000017                    ADSC9   0,,PR0                   cn=0,n=15

     1598    10688    4                       TEXT$ = PINCRC(TEXT$, LENGTHC('EXTENDED SHRINK'));

  10688  1 007552   200217 236100                    LDQ     TEXT$,,AUTO
         1 007553   000006 036000 2                  ADLQ    6
         1 007554   200217 756100                    STQ     TEXT$,,AUTO

     1599    10689    4                       CALL DDR$BUMPC_D$( LENGTHC('EXTENDED SHRINK') );

  10689  1 007555   000047 630400 2                  EPPR0   39
         1 007556   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 007557   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 007560   000000 011000                    NOP     0
         1 007561   007731 710000 1                  TRA     s:10720

     1600    10690    4                    CASE(3);               /* DATASTACK SHRINK */

     1601    10691    4                       TEXT$ -> CHAR16 = 'DATASTACK SHRINK';

  10691  1 007562   200217 470500                    LDP0    TEXT$,,AUTO
         1 007563   040100 100400                    MLR     fill='040'O
         1 007564   000126 000020 0                  ADSC9   HEXCHARS+61              cn=0,n=16
         1 007565   000000 000020                    ADSC9   0,,PR0                   cn=0,n=16

     1602    10692    4                       TEXT$ = PINCRC(TEXT$, LENGTHC('DATASTACK SHRINK'));

  10692  1 007566   200217 236100                    LDQ     TEXT$,,AUTO
         1 007567   000004 036003                    ADLQ    4,DU
         1 007570   200217 756100                    STQ     TEXT$,,AUTO

     1603    10693    4                       CALL DDR$BUMPC_D$( LENGTHC('DATASTACK SHRINK') );

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:264  
  10693  1 007571   000051 630400 2                  EPPR0   41
         1 007572   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 007573   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 007574   000000 011000                    NOP     0

     1604    10694    4                    END;

  10694  1 007575   007731 710000 1                  TRA     s:10720

     1605    10695
     1606    10696    3               CASE ( %L6 );

     1607    10697
     1608    10698    3                  IF SIZE ~= 48 THEN GOTO WRONG_SIZE;

  10698  1 007576   200004 471500                    LDP1    @SIZE,,AUTO
         1 007577   100000 235100                    LDA     0,,PR1
         1 007600   000060 115007                    CMPA    48,DL
         1 007601   010560 601000 1                  TNZ     WRONG_SIZE

     1609    10699    3                  VAL = 0;

  10699  1 007602   200216 450100                    STZ     VAL,,AUTO

     1610    10700    3                  PWRD_VAL.LEFT4 = L6_VECTOR.LEFT4;

  10700  1 007603   200013 236100                    LDQ     CVALUES+1,,AUTO
         1 007604   000020 736000                    QLS     16
         1 007605   200216 676100                    ERQ     VAL,,AUTO
         1 007606   000006 376000 2                  ANQ     6
         1 007607   200216 656100                    ERSQ    VAL,,AUTO

     1611    10701    3                  PWRD_VAL.RIGHT16 = L6_VECTOR.RIGHT16;

  10701  1 007610   200014 236100                    LDQ     CVALUES+2,,AUTO
         1 007611   200216 676100                    ERQ     VAL,,AUTO
         1 007612   177777 376007                    ANQ     65535,DL
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:265  
         1 007613   200216 656100                    ERSQ    VAL,,AUTO

     1612    10702    3                  CALL DDR$BINTXT ( MYBUF$, VAL, %X_FMT, NCHARS ); /* Base */

  10702  1 007614   200055 633500                    EPPR3   NCHARS,,AUTO
         1 007615   200235 453500                    STP3    DIG+4,,AUTO
         1 007616   000010 236000 2                  LDQ     8
         1 007617   200234 756100                    STQ     DIG+3,,AUTO
         1 007620   200216 634500                    EPPR4   VAL,,AUTO
         1 007621   200233 454500                    STP4    DIG+2,,AUTO
         1 007622   200214 635500                    EPPR5   MYBUF$,,AUTO
         1 007623   200232 455500                    STP5    DIG+1,,AUTO
         1 007624   200232 630500                    EPPR0   DIG+1,,AUTO
         1 007625   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 007626   000000 701000 xent               TSX1    DDR$BINTXT
         1 007627   000000 011000                    NOP     0

     1613    10703    3                  TEXT$ -> TEXTR = MYBUF;

  10703  1 007630   200217 470500                    LDP0    TEXT$,,AUTO
         1 007631   200055 720100                    LXL0    NCHARS,,AUTO
         1 007632   040140 100500                    MLR     fill='040'O
         1 007633   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 007634   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

     1614    10704    3                  CALL DDR$BUMPC_D$ ( NCHARS ) ALTRET ( DERR );

  10704  1 007635   200055 631500                    EPPR1   NCHARS,,AUTO
         1 007636   200232 451500                    STP1    DIG+1,,AUTO
         1 007637   200232 630500                    EPPR0   DIG+1,,AUTO
         1 007640   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 007641   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 007642   010563 702000 1                  TSX2    DERR

     1615    10705    3                  TEXT$ = S_D.D$;

  10705  1 007643   000000 470400 xsym               LDP0    S_D$
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:266  
         1 007644   000044 236100                    LDQ     36,,PR0
         1 007645   200217 756100                    STQ     TEXT$,,AUTO

     1616    10706    3                  IF L6_VECTOR.BYTE_NUM

  10706  1 007646   200013 236100                    LDQ     CVALUES+1,,AUTO
         1 007647   100000 316007                    CANQ    32768,DL
         1 007650   007661 600000 1                  TZE     s:10711

     1617    10707    4                  THEN DO;

     1618    10708    4                       TEXT$ -> CHAR2 = '-1';

  10708  1 007651   200217 471500                    LDP1    TEXT$,,AUTO
         1 007652   040100 100400                    MLR     fill='040'O
         1 007653   000035 000002 0                  ADSC9   HEXCHARS+4               cn=0,n=2
         1 007654   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2

     1619    10709    4                       CALL DDR$BUMPC_D$ ( LENGTHC('-1') ) ALTRET ( DERR );

  10709  1 007655   000003 630400 2                  EPPR0   3
         1 007656   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 007657   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 007660   010563 702000 1                  TSX2    DERR

     1620    10710    4                     END;

     1621    10711    3                  TEXT$ = S_D.D$;

  10711  1 007661   000000 470400 xsym               LDP0    S_D$
         1 007662   000044 236100                    LDQ     36,,PR0
         1 007663   200217 756100                    STQ     TEXT$,,AUTO

     1622    10712    3                  TEXT$ -> CHAR4 = ',BD=';

  10712  1 007664   200217 471500                    LDP1    TEXT$,,AUTO
         1 007665   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:267  
         1 007666   000132 000004 0                  ADSC9   HEXCHARS+65              cn=0,n=4
         1 007667   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4

     1623    10713    3                  CALL DDR$BUMPC_D$ ( LENGTHC(',BD=') ) ALTRET ( DERR );

  10713  1 007670   000043 630400 2                  EPPR0   35
         1 007671   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 007672   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 007673   010563 702000 1                  TSX2    DERR

     1624    10714    3                  TEXT$ = S_D.D$;

  10714  1 007674   000000 470400 xsym               LDP0    S_D$
         1 007675   000044 236100                    LDQ     36,,PR0
         1 007676   200217 756100                    STQ     TEXT$,,AUTO

     1625    10715    3                  VAL = L6_VECTOR.BD;

  10715  1 007677   200012 236100                    LDQ     CVALUES,,AUTO
         1 007700   177777 376007                    ANQ     65535,DL
         1 007701   200216 756100                    STQ     VAL,,AUTO

     1626    10716    3                  CALL DDR$BINTXT ( MYBUF$, VAL, %X_FMT, NCHARS ); /* Bound */

  10716  1 007702   200055 631500                    EPPR1   NCHARS,,AUTO
         1 007703   200235 451500                    STP1    DIG+4,,AUTO
         1 007704   000010 236000 2                  LDQ     8
         1 007705   200234 756100                    STQ     DIG+3,,AUTO
         1 007706   200216 633500                    EPPR3   VAL,,AUTO
         1 007707   200233 453500                    STP3    DIG+2,,AUTO
         1 007710   200214 634500                    EPPR4   MYBUF$,,AUTO
         1 007711   200232 454500                    STP4    DIG+1,,AUTO
         1 007712   200232 630500                    EPPR0   DIG+1,,AUTO
         1 007713   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 007714   000000 701000 xent               TSX1    DDR$BINTXT
         1 007715   000000 011000                    NOP     0

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:268  
     1627    10717    3                  TEXT$ -> TEXTR = MYBUF;

  10717  1 007716   200217 470500                    LDP0    TEXT$,,AUTO
         1 007717   200055 720100                    LXL0    NCHARS,,AUTO
         1 007720   040140 100500                    MLR     fill='040'O
         1 007721   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 007722   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

     1628    10718    3                  CALL DDR$BUMPC_D$ ( NCHARS ) ALTRET ( DERR );

  10718  1 007723   200055 631500                    EPPR1   NCHARS,,AUTO
         1 007724   200232 451500                    STP1    DIG+1,,AUTO
         1 007725   200232 630500                    EPPR0   DIG+1,,AUTO
         1 007726   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 007727   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 007730   010563 702000 1                  TSX2    DERR

     1629    10719    3               END;

     1630    10720    2             RETURN;

  10720  1 007731   000000 702200 xent               TSX2  ! X66_ARET

     1631    10721                                                /*********************
     1632    10722                                                 ******* X_FMT *******
     1633    10723                                                 *********************/
     1634    10724    2          CASE( %X_FMT );

     1635    10725
     1636    10726    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );

  10726  1 007732   000000 470400 xsym               LDP0    S_D$
         1 007733   006714 235100                    LDA     3532,,PR0
         1 007734   000003 115007                    CMPA    3,DL
         1 007735   007737 602005 1                  TNC     s:10726+5,AL
         1 007736   010550 710000 1                  TRA     s:10845
         1 007737   010404 710000 1                  TRA     s:10804
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:269  
         1 007740   007742 710000 1                  TRA     s:10730
         1 007741   010172 710000 1                  TRA     s:10770

     1637    10727
     1638    10728    3               CASE ( %HOST );

     1639    10729
     1640    10730    3                  CALL DDR$BUMPC_D$(1) ALTRET(DERR);

  10730  1 007742   000000 630400 2                  EPPR0   0
         1 007743   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 007744   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 007745   010563 702000 1                  TSX2    DERR

     1641    10731    3                  TEXT$ -> CHAR1 = '''';

  10731  1 007746   200217 470500                    LDP0    TEXT$,,AUTO
         1 007747   040100 100400                    MLR     fill='040'O
         1 007750   000011 000001 2                  ADSC9   9                        cn=0,n=1
         1 007751   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1642    10732    3                  TEXT$ = S_D.D$;

  10732  1 007752   000000 471400 xsym               LDP1    S_D$
         1 007753   100044 236100                    LDQ     36,,PR1
         1 007754   200217 756100                    STQ     TEXT$,,AUTO

     1643    10733    3                  J = 0;

  10733  1 007755   200112 450100                    STZ     J,,AUTO

     1644    10734    4                  DO CASE ( MOD(SIZE, 4) );

  10734  1 007756   200004 470500                    LDP0    @SIZE,,AUTO
         1 007757   000000 236100                    LDQ     0,,PR0
         1 007760   000004 506007                    DIV     4,DL
         1 007761   000004 115007                    CMPA    4,DL
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:270  
         1 007762   007764 602005 1                  TNC     s:10734+6,AL
         1 007763   010141 710000 1                  TRA     s:10760
         1 007764   007770 710000 1                  TRA     s:10736
         1 007765   010016 710000 1                  TRA     s:10742
         1 007766   010052 710000 1                  TRA     s:10748
         1 007767   010106 710000 1                  TRA     s:10754

     1645    10735    4                    CASE (0);

     1646    10736    5                       DO I = 0 TO SIZE/36;

  10736  1 007770   200111 450100                    STZ     I,,AUTO
         1 007771   010004 710000 1                  TRA     s:10739+3

     1647    10737    5                            HOST_NUVAL(J) = HOST_VAL(I);

  10737  1 007772   200111 720100                    LXL0    I,,AUTO
         1 007773   200012 236110                    LDQ     CVALUES,X0,AUTO
         1 007774   200112 721100                    LXL1    J,,AUTO
         1 007775   200032 756111                    STQ     HOST_NUVAL,X1,AUTO

     1648    10738    5                            J = J + 1;

  10738  1 007776   200112 235100                    LDA     J,,AUTO
         1 007777   000001 035007                    ADLA    1,DL
         1 010000   200112 755100                    STA     J,,AUTO

     1649    10739    5                          END;

  10739  1 010001   200111 235100                    LDA     I,,AUTO
         1 010002   000001 035007                    ADLA    1,DL
         1 010003   200111 755100                    STA     I,,AUTO
         1 010004   200004 470500                    LDP0    @SIZE,,AUTO
         1 010005   000000 236100                    LDQ     0,,PR0
         1 010006   000044 506007                    DIV     36,DL
         1 010007   000000 116003                    CMPQ    0,DU
         1 010010   010013 604000 1                  TMI     s:10740
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:271  
         1 010011   200111 116100                    CMPQ    I,,AUTO
         1 010012   007772 603000 1                  TRC     s:10737

     1650    10740    4                       NU_SIZE = SIZE;

  10740  1 010013   000000 235100                    LDA     0,,PR0
         1 010014   200053 755100                    STA     NU_SIZE,,AUTO
         1 010015   010141 710000 1                  TRA     s:10760

     1651    10741    4                    CASE (1);

     1652    10742    5                       DO I = 0 TO SIZE/36;

  10742  1 010016   200111 450100                    STZ     I,,AUTO
         1 010017   010037 710000 1                  TRA     s:10745+3

     1653    10743    5                            HOST_NUVAL3.HOST_WRD(J) = HOST_VAL(I);

  10743  1 010020   200111 236100                    LDQ     I,,AUTO
         1 010021   000044 402007                    MPY     36,DL
         1 010022   200232 756100                    STQ     DIG+1,,AUTO
         1 010023   200112 236100                    LDQ     J,,AUTO
         1 010024   000044 402007                    MPY     36,DL
         1 010025   200232 235100                    LDA     DIG+1,,AUTO
         1 010026   003106 060505                    CSL     bolr='003'O
         1 010027   200012 000044                    BDSC    CVALUES,A,AUTO           by=0,bit=0,n=36
         1 010030   200032 030044                    BDSC    HOST_NUVAL,Q,AUTO        by=0,bit=3,n=36

     1654    10744    5                            J = J + 1;

  10744  1 010031   200112 235100                    LDA     J,,AUTO
         1 010032   000001 035007                    ADLA    1,DL
         1 010033   200112 755100                    STA     J,,AUTO

     1655    10745    5                          END;

  10745  1 010034   200111 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:272  
         1 010035   000001 036007                    ADLQ    1,DL
         1 010036   200111 756100                    STQ     I,,AUTO
         1 010037   200004 470500                    LDP0    @SIZE,,AUTO
         1 010040   000000 236100                    LDQ     0,,PR0
         1 010041   000044 506007                    DIV     36,DL
         1 010042   000000 116003                    CMPQ    0,DU
         1 010043   010046 604000 1                  TMI     s:10746
         1 010044   200111 116100                    CMPQ    I,,AUTO
         1 010045   010020 603000 1                  TRC     s:10743

     1656    10746    4                       NU_SIZE = SIZE + 3;

  10746  1 010046   000000 235100                    LDA     0,,PR0
         1 010047   000003 035007                    ADLA    3,DL
         1 010050   200053 755100                    STA     NU_SIZE,,AUTO
         1 010051   010141 710000 1                  TRA     s:10760

     1657    10747    4                    CASE (2);

     1658    10748    5                       DO I = 0 TO SIZE/36;

  10748  1 010052   200111 450100                    STZ     I,,AUTO
         1 010053   010073 710000 1                  TRA     s:10751+3

     1659    10749    5                            HOST_NUVAL2.HOST_WRD(J) = HOST_VAL(I);

  10749  1 010054   200111 236100                    LDQ     I,,AUTO
         1 010055   000044 402007                    MPY     36,DL
         1 010056   200232 756100                    STQ     DIG+1,,AUTO
         1 010057   200112 236100                    LDQ     J,,AUTO
         1 010060   000044 402007                    MPY     36,DL
         1 010061   200232 235100                    LDA     DIG+1,,AUTO
         1 010062   003106 060505                    CSL     bolr='003'O
         1 010063   200012 000044                    BDSC    CVALUES,A,AUTO           by=0,bit=0,n=36
         1 010064   200032 020044                    BDSC    HOST_NUVAL,Q,AUTO        by=0,bit=2,n=36

     1660    10750    5                            J = J + 1;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:273  

  10750  1 010065   200112 235100                    LDA     J,,AUTO
         1 010066   000001 035007                    ADLA    1,DL
         1 010067   200112 755100                    STA     J,,AUTO

     1661    10751    5                          END;

  10751  1 010070   200111 236100                    LDQ     I,,AUTO
         1 010071   000001 036007                    ADLQ    1,DL
         1 010072   200111 756100                    STQ     I,,AUTO
         1 010073   200004 470500                    LDP0    @SIZE,,AUTO
         1 010074   000000 236100                    LDQ     0,,PR0
         1 010075   000044 506007                    DIV     36,DL
         1 010076   000000 116003                    CMPQ    0,DU
         1 010077   010102 604000 1                  TMI     s:10752
         1 010100   200111 116100                    CMPQ    I,,AUTO
         1 010101   010054 603000 1                  TRC     s:10749

     1662    10752    4                       NU_SIZE = SIZE + 2;

  10752  1 010102   000000 235100                    LDA     0,,PR0
         1 010103   000002 035007                    ADLA    2,DL
         1 010104   200053 755100                    STA     NU_SIZE,,AUTO
         1 010105   010141 710000 1                  TRA     s:10760

     1663    10753    4                    CASE (3);

     1664    10754    5                       DO I = 0 TO SIZE/36;

  10754  1 010106   200111 450100                    STZ     I,,AUTO
         1 010107   010127 710000 1                  TRA     s:10757+3

     1665    10755    5                            HOST_NUVAL1.HOST_WRD(J) = HOST_VAL(I);

  10755  1 010110   200111 236100                    LDQ     I,,AUTO
         1 010111   000044 402007                    MPY     36,DL
         1 010112   200232 756100                    STQ     DIG+1,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:274  
         1 010113   200112 236100                    LDQ     J,,AUTO
         1 010114   000044 402007                    MPY     36,DL
         1 010115   200232 235100                    LDA     DIG+1,,AUTO
         1 010116   003106 060505                    CSL     bolr='003'O
         1 010117   200012 000044                    BDSC    CVALUES,A,AUTO           by=0,bit=0,n=36
         1 010120   200032 010044                    BDSC    HOST_NUVAL,Q,AUTO        by=0,bit=1,n=36

     1666    10756    5                            J = J + 1;

  10756  1 010121   200112 235100                    LDA     J,,AUTO
         1 010122   000001 035007                    ADLA    1,DL
         1 010123   200112 755100                    STA     J,,AUTO

     1667    10757    5                          END;

  10757  1 010124   200111 236100                    LDQ     I,,AUTO
         1 010125   000001 036007                    ADLQ    1,DL
         1 010126   200111 756100                    STQ     I,,AUTO
         1 010127   200004 470500                    LDP0    @SIZE,,AUTO
         1 010130   000000 236100                    LDQ     0,,PR0
         1 010131   000044 506007                    DIV     36,DL
         1 010132   000000 116003                    CMPQ    0,DU
         1 010133   010136 604000 1                  TMI     s:10758
         1 010134   200111 116100                    CMPQ    I,,AUTO
         1 010135   010110 603000 1                  TRC     s:10755

     1668    10758    4                       NU_SIZE = SIZE + 1;

  10758  1 010136   000000 235100                    LDA     0,,PR0
         1 010137   000001 035007                    ADLA    1,DL
         1 010140   200053 755100                    STA     NU_SIZE,,AUTO

     1669    10759    4                    END;

     1670    10760    3                  CALL BIN2HEX;

  10760  1 010141   010661 701000 1                  TSX1    BIN2HEX
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:275  
         1 010142   000000 011000                    NOP     0

     1671    10761    3                  TEXT$ -> TEXTR = MYBUF;

  10761  1 010143   200217 470500                    LDP0    TEXT$,,AUTO
         1 010144   200055 720100                    LXL0    NCHARS,,AUTO
         1 010145   040140 100500                    MLR     fill='040'O
         1 010146   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 010147   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

     1672    10762    3                  CALL DDR$BUMPC_D$(NCHARS) ALTRET (DERR);

  10762  1 010150   200055 631500                    EPPR1   NCHARS,,AUTO
         1 010151   200232 451500                    STP1    DIG+1,,AUTO
         1 010152   200232 630500                    EPPR0   DIG+1,,AUTO
         1 010153   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 010154   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 010155   010563 702000 1                  TSX2    DERR

     1673    10763    3                  TEXT$ = S_D.D$;

  10763  1 010156   000000 470400 xsym               LDP0    S_D$
         1 010157   000044 236100                    LDQ     36,,PR0
         1 010160   200217 756100                    STQ     TEXT$,,AUTO

     1674    10764    3                  TEXT$ -> CHAR2 = '''X';

  10764  1 010161   200217 471500                    LDP1    TEXT$,,AUTO
         1 010162   040100 100400                    MLR     fill='040'O
         1 010163   000133 000002 0                  ADSC9   HEXCHARS+66              cn=0,n=2
         1 010164   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2

     1675    10765    3                  CALL DDR$BUMPC_D$( LENGTHC('''X') ) ALTRET (DERR);

  10765  1 010165   000003 630400 2                  EPPR0   3
         1 010166   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 010167   000000 701000 xent               TSX1    DDR$BUMPC_D$
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:276  
         1 010170   010563 702000 1                  TSX2    DERR

     1676    10766    3                  RETURN;

  10766  1 010171   000000 702200 xent               TSX2  ! X66_ARET

     1677    10767
     1678    10768    3               CASE ( %L6 );

     1679    10769
     1680    10770    3                  CALL DDR$BUMPC_D$(1) ALTRET (DERR);

  10770  1 010172   000000 630400 2                  EPPR0   0
         1 010173   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 010174   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 010175   010563 702000 1                  TSX2    DERR

     1681    10771    3                  TEXT$ -> CHAR1 = '.';

  10771  1 010176   200217 470500                    LDP0    TEXT$,,AUTO
         1 010177   040100 100400                    MLR     fill='040'O
         1 010200   000035 000001 2                  ADSC9   29                       cn=0,n=1
         1 010201   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1682    10772    3                  TEXT$ = S_D.D$;

  10772  1 010202   000000 471400 xsym               LDP1    S_D$
         1 010203   100044 236100                    LDQ     36,,PR1
         1 010204   200217 756100                    STQ     TEXT$,,AUTO

     1683    10773    3                  J = 0;

  10773  1 010205   200112 450100                    STZ     J,,AUTO

     1684    10774    4                  DO CASE ( MOD (SIZE, 4) );

  10774  1 010206   200004 470500                    LDP0    @SIZE,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:277  
         1 010207   000000 236100                    LDQ     0,,PR0
         1 010210   000004 506007                    DIV     4,DL
         1 010211   000004 115007                    CMPA    4,DL
         1 010212   010214 602005 1                  TNC     s:10774+6,AL
         1 010213   010366 710000 1                  TRA     s:10800
         1 010214   010220 710000 1                  TRA     s:10776
         1 010215   010251 710000 1                  TRA     s:10782
         1 010216   010303 710000 1                  TRA     s:10788
         1 010217   010335 710000 1                  TRA     s:10794

     1685    10775    4                    CASE (0);

     1686    10776    5                       DO I = 0 TO SIZE/16;

  10776  1 010220   200111 450100                    STZ     I,,AUTO
         1 010221   010237 710000 1                  TRA     s:10779+3

     1687    10777    5                            L6_NUVAL(J) = L6_VAL.L6_WRD(I);

  10777  1 010222   200111 236100                    LDQ     I,,AUTO
         1 010223   000044 402007                    MPY     36,DL
         1 010224   200112 235100                    LDA     J,,AUTO
         1 010225   000004 735000                    ALS     4
         1 010226   003105 060506                    CSL     bolr='003'O
         1 010227   200012 420020                    BDSC    CVALUES,Q,AUTO           by=2,bit=2,n=16
         1 010230   200032 000020                    BDSC    HOST_NUVAL,A,AUTO        by=0,bit=0,n=16

     1688    10778    5                            J = J + 1;

  10778  1 010231   200112 235100                    LDA     J,,AUTO
         1 010232   000001 035007                    ADLA    1,DL
         1 010233   200112 755100                    STA     J,,AUTO

     1689    10779    5                          END;

  10779  1 010234   200111 235100                    LDA     I,,AUTO
         1 010235   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:278  
         1 010236   200111 755100                    STA     I,,AUTO
         1 010237   200004 470500                    LDP0    @SIZE,,AUTO
         1 010240   000000 236100                    LDQ     0,,PR0
         1 010241   000020 506007                    DIV     16,DL
         1 010242   000000 116003                    CMPQ    0,DU
         1 010243   010246 604000 1                  TMI     s:10780
         1 010244   200111 116100                    CMPQ    I,,AUTO
         1 010245   010222 603000 1                  TRC     s:10777

     1690    10780    4                       NU_SIZE = SIZE;

  10780  1 010246   000000 235100                    LDA     0,,PR0
         1 010247   200053 755100                    STA     NU_SIZE,,AUTO
         1 010250   010366 710000 1                  TRA     s:10800

     1691    10781    4                    CASE (1);

     1692    10782    5                       DO I = 0 TO SIZE/16;

  10782  1 010251   200111 450100                    STZ     I,,AUTO
         1 010252   010270 710000 1                  TRA     s:10785+3

     1693    10783    5                            L6_NUVAL3.L6_WRD(J) = L6_VAL.L6_WRD(I);

  10783  1 010253   200111 236100                    LDQ     I,,AUTO
         1 010254   000044 402007                    MPY     36,DL
         1 010255   200112 235100                    LDA     J,,AUTO
         1 010256   000004 735000                    ALS     4
         1 010257   003105 060506                    CSL     bolr='003'O
         1 010260   200012 420020                    BDSC    CVALUES,Q,AUTO           by=2,bit=2,n=16
         1 010261   200032 030020                    BDSC    HOST_NUVAL,A,AUTO        by=0,bit=3,n=16

     1694    10784    5                            J = J + 1;

  10784  1 010262   200112 235100                    LDA     J,,AUTO
         1 010263   000001 035007                    ADLA    1,DL
         1 010264   200112 755100                    STA     J,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:279  

     1695    10785    5                          END;

  10785  1 010265   200111 235100                    LDA     I,,AUTO
         1 010266   000001 035007                    ADLA    1,DL
         1 010267   200111 755100                    STA     I,,AUTO
         1 010270   200004 470500                    LDP0    @SIZE,,AUTO
         1 010271   000000 236100                    LDQ     0,,PR0
         1 010272   000020 506007                    DIV     16,DL
         1 010273   000000 116003                    CMPQ    0,DU
         1 010274   010277 604000 1                  TMI     s:10786
         1 010275   200111 116100                    CMPQ    I,,AUTO
         1 010276   010253 603000 1                  TRC     s:10783

     1696    10786    4                       NU_SIZE = SIZE + 3;

  10786  1 010277   000000 235100                    LDA     0,,PR0
         1 010300   000003 035007                    ADLA    3,DL
         1 010301   200053 755100                    STA     NU_SIZE,,AUTO
         1 010302   010366 710000 1                  TRA     s:10800

     1697    10787    4                    CASE (2);

     1698    10788    5                       DO I = 0 TO SIZE/16;

  10788  1 010303   200111 450100                    STZ     I,,AUTO
         1 010304   010322 710000 1                  TRA     s:10791+3

     1699    10789    5                            L6_NUVAL2.L6_WRD(J) = L6_VAL.L6_WRD(I);

  10789  1 010305   200111 236100                    LDQ     I,,AUTO
         1 010306   000044 402007                    MPY     36,DL
         1 010307   200112 235100                    LDA     J,,AUTO
         1 010310   000004 735000                    ALS     4
         1 010311   003105 060506                    CSL     bolr='003'O
         1 010312   200012 420020                    BDSC    CVALUES,Q,AUTO           by=2,bit=2,n=16
         1 010313   200032 020020                    BDSC    HOST_NUVAL,A,AUTO        by=0,bit=2,n=16
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:280  

     1700    10790    5                            J = J + 1;

  10790  1 010314   200112 235100                    LDA     J,,AUTO
         1 010315   000001 035007                    ADLA    1,DL
         1 010316   200112 755100                    STA     J,,AUTO

     1701    10791    5                          END;

  10791  1 010317   200111 235100                    LDA     I,,AUTO
         1 010320   000001 035007                    ADLA    1,DL
         1 010321   200111 755100                    STA     I,,AUTO
         1 010322   200004 470500                    LDP0    @SIZE,,AUTO
         1 010323   000000 236100                    LDQ     0,,PR0
         1 010324   000020 506007                    DIV     16,DL
         1 010325   000000 116003                    CMPQ    0,DU
         1 010326   010331 604000 1                  TMI     s:10792
         1 010327   200111 116100                    CMPQ    I,,AUTO
         1 010330   010305 603000 1                  TRC     s:10789

     1702    10792    4                       NU_SIZE = SIZE + 2;

  10792  1 010331   000000 235100                    LDA     0,,PR0
         1 010332   000002 035007                    ADLA    2,DL
         1 010333   200053 755100                    STA     NU_SIZE,,AUTO
         1 010334   010366 710000 1                  TRA     s:10800

     1703    10793    4                    CASE (3);

     1704    10794    5                       DO I = 0 TO SIZE/16;

  10794  1 010335   200111 450100                    STZ     I,,AUTO
         1 010336   010354 710000 1                  TRA     s:10797+3

     1705    10795    5                            L6_NUVAL1.L6_WRD(J) = L6_VAL.L6_WRD(I);

  10795  1 010337   200111 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:281  
         1 010340   000044 402007                    MPY     36,DL
         1 010341   200112 235100                    LDA     J,,AUTO
         1 010342   000004 735000                    ALS     4
         1 010343   003105 060506                    CSL     bolr='003'O
         1 010344   200012 420020                    BDSC    CVALUES,Q,AUTO           by=2,bit=2,n=16
         1 010345   200032 010020                    BDSC    HOST_NUVAL,A,AUTO        by=0,bit=1,n=16

     1706    10796    5                            J = J + 1;

  10796  1 010346   200112 235100                    LDA     J,,AUTO
         1 010347   000001 035007                    ADLA    1,DL
         1 010350   200112 755100                    STA     J,,AUTO

     1707    10797    5                          END;

  10797  1 010351   200111 235100                    LDA     I,,AUTO
         1 010352   000001 035007                    ADLA    1,DL
         1 010353   200111 755100                    STA     I,,AUTO
         1 010354   200004 470500                    LDP0    @SIZE,,AUTO
         1 010355   000000 236100                    LDQ     0,,PR0
         1 010356   000020 506007                    DIV     16,DL
         1 010357   000000 116003                    CMPQ    0,DU
         1 010360   010363 604000 1                  TMI     s:10798
         1 010361   200111 116100                    CMPQ    I,,AUTO
         1 010362   010337 603000 1                  TRC     s:10795

     1708    10798    4                       NU_SIZE = SIZE + 1;

  10798  1 010363   000000 235100                    LDA     0,,PR0
         1 010364   000001 035007                    ADLA    1,DL
         1 010365   200053 755100                    STA     NU_SIZE,,AUTO

     1709    10799    4                    END;

     1710    10800    3                  CALL BIN2HEX;

  10800  1 010366   010661 701000 1                  TSX1    BIN2HEX
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:282  
         1 010367   000000 011000                    NOP     0

     1711    10801    3                  TEXT$ -> TEXTR = MYBUF;

  10801  1 010370   200217 470500                    LDP0    TEXT$,,AUTO
         1 010371   200055 720100                    LXL0    NCHARS,,AUTO
         1 010372   040140 100500                    MLR     fill='040'O
         1 010373   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 010374   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

     1712    10802    3                  CALL DDR$BUMPC_D$(NCHARS) ALTRET (DERR);

  10802  1 010375   200055 631500                    EPPR1   NCHARS,,AUTO
         1 010376   200232 451500                    STP1    DIG+1,,AUTO
         1 010377   200232 630500                    EPPR0   DIG+1,,AUTO
         1 010400   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 010401   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 010402   010563 702000 1                  TSX2    DERR

     1713    10803    3                  RETURN;

  10803  1 010403   000000 702200 xent               TSX2  ! X66_ARET

     1714    10804    3               END;

  10804  1 010404   010550 710000 1                  TRA     s:10845

     1715    10805                                                /**********************
     1716    10806                                                 ******* X1_FMT *******
     1717    10807                                                 **********************/
     1718    10808    2          CASE( %X1_FMT );

     1719    10809
     1720    10810    3             DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );

  10810  1 010405   000000 470400 xsym               LDP0    S_D$
         1 010406   006714 235100                    LDA     3532,,PR0
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:283  
         1 010407   000003 115007                    CMPA    3,DL
         1 010410   010412 602005 1                  TNC     s:10810+5,AL
         1 010411   010550 710000 1                  TRA     s:10845
         1 010412   010543 710000 1                  TRA     s:10837
         1 010413   010415 710000 1                  TRA     s:10814
         1 010414   010540 710000 1                  TRA     s:10834

     1721    10811
     1722    10812    3               CASE ( %HOST );

     1723    10813
     1724    10814    3                  CALL DDR$BUMPC_D$(1) ALTRET(DERR);

  10814  1 010415   000000 630400 2                  EPPR0   0
         1 010416   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 010417   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 010420   010563 702000 1                  TSX2    DERR

     1725    10815    3                  TEXT$ -> CHAR1 = '''';

  10815  1 010421   200217 470500                    LDP0    TEXT$,,AUTO
         1 010422   040100 100400                    MLR     fill='040'O
         1 010423   000011 000001 2                  ADSC9   9                        cn=0,n=1
         1 010424   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1726    10816    3                  TEXT$ = S_D.D$;

  10816  1 010425   000000 471400 xsym               LDP1    S_D$
         1 010426   100044 236100                    LDQ     36,,PR1
         1 010427   200217 756100                    STQ     TEXT$,,AUTO

     1727    10817    4                  IF MOD(SIZE,9)~=0 THEN DO;

  10817  1 010430   200004 470500                    LDP0    @SIZE,,AUTO
         1 010431   000000 236100                    LDQ     0,,PR0
         1 010432   000011 506007                    DIV     9,DL
         1 010433   000044 733000                    LRS     36
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:284  
         1 010434   000000 116003                    CMPQ    0,DU
         1 010435   010453 600000 1                  TZE     s:10821

     1728    10818    4                       PINCRB(ADDR(CVALUES),9-MOD(SIZE,9))->B$BITS = ADDR(CVALUES)->
             10818                                B$BITS;

  10818  1 010436   000000 236100                    LDQ     0,,PR0
         1 010437   000011 506007                    DIV     9,DL
         1 010440   000000 531000                    NEG     0
         1 010441   010443 605000 1                  TPL     s:10818+5
         1 010442   000044 035003                    ADLA    36,DU
         1 010443   003105 060500                    CSL     bolr='003'O
         1 010444   200012 001100                    BDSC    CVALUES,,AUTO            by=0,bit=0,n=576
         1 010445   200012 201100                    BDSC    CVALUES,A,AUTO           by=1,bit=0,n=576

     1729    10819    4                       SIZE = (SIZE+9)/9*9;

  10819  1 010446   000000 236100                    LDQ     0,,PR0
         1 010447   000011 036007                    ADLQ    9,DL
         1 010450   000011 506007                    DIV     9,DL
         1 010451   000011 402007                    MPY     9,DL
         1 010452   000000 756100                    STQ     0,,PR0

     1730    10820    4                     END;

     1731    10821    3                  SIZED9 = SIZE / 9 - 1;

  10821  1 010453   000000 236100                    LDQ     0,,PR0
         1 010454   000011 506007                    DIV     9,DL
         1 010455   000001 136007                    SBLQ    1,DL
         1 010456   200110 756100                    STQ     SIZED9,,AUTO

     1732    10822    3                  CALL DDR$BUMPC_D$( SIZED9 * 2 + 5 ) ALTRET(DERR);

  10822  1 010457   200110 235100                    LDA     SIZED9,,AUTO
         1 010460   000001 735000                    ALS     1
         1 010461   000005 035007                    ADLA    5,DL
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:285  
         1 010462   200232 755100                    STA     DIG+1,,AUTO
         1 010463   200232 633500                    EPPR3   DIG+1,,AUTO
         1 010464   200233 453500                    STP3    DIG+2,,AUTO
         1 010465   200233 630500                    EPPR0   DIG+2,,AUTO
         1 010466   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 010467   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 010470   010563 702000 1                  TSX2    DERR

     1733    10823    4                  DO I = 0 TO SIZED9;

  10823  1 010471   200111 450100                    STZ     I,,AUTO
         1 010472   010530 710000 1                  TRA     s:10828+3

     1734    10824    4                       TEXT$ -> CHAR1 = HEXCHARS(XVAL.L(I));

  10824  1 010473   200111 236100                    LDQ     I,,AUTO
         1 010474   000011 402007                    MPY     9,DL
         1 010475   003100 061506                    CSR     bolr='003'O
         1 010476   200012 010004                    BDSC    CVALUES,Q,AUTO           by=0,bit=1,n=4
         1 010477   200232 000044                    BDSC    DIG+1,,AUTO              by=0,bit=0,n=36
         1 010500   200232 236100                    LDQ     DIG+1,,AUTO
         1 010501   200217 470500                    LDP0    TEXT$,,AUTO
         1 010502   040100 100406                    MLR     fill='040'O
         1 010503   000031 000001 0                  ADSC9   HEXCHARS,Q               cn=0,n=1
         1 010504   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1735    10825    4                       TEXT$ = PINCRC(TEXT$, 1);

  10825  1 010505   200217 236100                    LDQ     TEXT$,,AUTO
         1 010506   200000 036007                    ADLQ    65536,DL
         1 010507   200217 756100                    STQ     TEXT$,,AUTO

     1736    10826    4                       TEXT$ -> CHAR1 = HEXCHARS(XVAL.R(I));

  10826  1 010510   200111 236100                    LDQ     I,,AUTO
         1 010511   000011 402007                    MPY     9,DL
         1 010512   003100 061506                    CSR     bolr='003'O
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:286  
         1 010513   200012 050004                    BDSC    CVALUES,Q,AUTO           by=0,bit=5,n=4
         1 010514   200232 000044                    BDSC    DIG+1,,AUTO              by=0,bit=0,n=36
         1 010515   200232 236100                    LDQ     DIG+1,,AUTO
         1 010516   200217 470500                    LDP0    TEXT$,,AUTO
         1 010517   040100 100406                    MLR     fill='040'O
         1 010520   000031 000001 0                  ADSC9   HEXCHARS,Q               cn=0,n=1
         1 010521   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1737    10827    4                       TEXT$ = PINCRC(TEXT$, 1);

  10827  1 010522   200217 236100                    LDQ     TEXT$,,AUTO
         1 010523   200000 036007                    ADLQ    65536,DL
         1 010524   200217 756100                    STQ     TEXT$,,AUTO

     1738    10828    4                     END;                  /* DO I = 0 TO SIZED9 */

  10828  1 010525   200111 235100                    LDA     I,,AUTO
         1 010526   000001 035007                    ADLA    1,DL
         1 010527   200111 755100                    STA     I,,AUTO
         1 010530   200110 236100                    LDQ     SIZED9,,AUTO
         1 010531   200111 116100                    CMPQ    I,,AUTO
         1 010532   010473 603000 1                  TRC     s:10824

     1739    10829    3                  TEXT$ -> CHAR3 = '''X1';

  10829  1 010533   200217 470500                    LDP0    TEXT$,,AUTO
         1 010534   040100 100400                    MLR     fill='040'O
         1 010535   000134 000003 0                  ADSC9   HEXCHARS+67              cn=0,n=3
         1 010536   000000 000003                    ADSC9   0,,PR0                   cn=0,n=3

     1740    10830    3                  RETURN;

  10830  1 010537   000000 702200 xent               TSX2  ! X66_ARET

     1741    10831
     1742    10832    3               CASE ( %L6 );

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:287  
     1743    10833
     1744    10834    3                  S_D.ERROR = 311; /* E@WRONFEPFMT */

  10834  1 010540   000467 236007                    LDQ     311,DL
         1 010541   000013 756100                    STQ     11,,PR0

     1745    10835    3                  ALTRETURN;

  10835  1 010542   000000 702200 xent               TSX2  ! X66_AALT

     1746    10836
     1747    10837    3               END;

  10837  1 010543   010550 710000 1                  TRA     s:10845

     1748    10838                                                /**********************
     1749    10839                                                 ******* L$_FMT *******
     1750    10840                                                 **********************/
     1751    10841    2          CASE( %L$_FMT );

     1752    10842    2             FMT = S_D.L$.FMT;

  10842  1 010544   000000 470400 xsym               LDP0    S_D$
         1 010545   000127 235100                    LDA     87,,PR0
         1 010546   200052 755100                    STA     FMT,,AUTO

     1753    10843    2             GOTO MAJORCASE;

  10843  1 010547   000064 710000 1                  TRA     MAJORCASE

     1754    10844    2          END;                             /* DO CASE( FMT ) */

     1755    10845    1        S_D.ERROR = 89;              /* E@UNKFMT */

  10845  1 010550   000131 235007                    LDA     89,DL
         1 010551   000000 470400 xsym               LDP0    S_D$
         1 010552   000013 755100                    STA     11,,PR0
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:288  

     1756    10846    1        GOTO DERR;

  10846  1 010553   010563 710000 1                  TRA     DERR

  10845  1 010554                       BADSCHEMA    null
     1757    10847    1   BADSCHEMA: ;
     1758    10848    1        S_D.ERROR = 22;              /* E@UERR11 */

  10848  1 010554   000026 235007                    LDA     22,DL
         1 010555   000000 470400 xsym               LDP0    S_D$
         1 010556   000013 755100                    STA     11,,PR0

     1759    10849    1        GOTO DERR;

  10849  1 010557   010563 710000 1                  TRA     DERR

  10848  1 010560                       WRONG_SIZE   null
     1760    10850    1   WRONG_SIZE: ;
     1761    10851    1        S_D.ERROR = 313;          /* E@SIZEMISFMT */

  10851  1 010560   000471 235007                    LDA     313,DL
         1 010561   000000 470400 xsym               LDP0    S_D$
         1 010562   000013 755100                    STA     11,,PR0

     1762    10852    1   DERR:
     1763    10853    1        ALTRETURN;

  10853  1 010563   000000 702200 xent  DERR         TSX2  ! X66_AALT

     1764    10854        %EJECT;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:289  
     1765    10855        /* Miscellaneous internal routines */
     1766    10856
     1767    10857    1   BIN2OCT: PROC;

  10857  1 010564   200226 741300       BIN2OCT      STX1  ! SAVE_EWSQ#+6,,AUTO

     1768    10858
     1769    10859    2   DCL LEAD0 BIT(1);
     1770    10860    2        LEAD0 = '1'B;

  10860  1 010565   400000 236003                    LDQ     -131072,DU
         1 010566   200227 756100                    STQ     LEAD0,,AUTO

     1771    10861    2        NCHARS = 0;

  10861  1 010567   200055 450100                    STZ     NCHARS,,AUTO

     1772    10862
     1773    10863    3        DO I = 0 TO NU_SIZE/3-1;

  10863  1 010570   200111 450100                    STZ     I,,AUTO
         1 010571   010640 710000 1                  TRA     s:10870+3

     1774    10864    3             IF OCT_VAL(I) ~= 0 THEN LEAD0 = '0'B;

  10864  1 010572   200111 236100                    LDQ     I,,AUTO
         1 010573   000003 402007                    MPY     3,DL
         1 010574   003100 061506                    CSR     bolr='003'O
         1 010575   200032 000003                    BDSC    HOST_NUVAL,Q,AUTO        by=0,bit=0,n=3
         1 010576   200232 000044                    BDSC    DIG+1,,AUTO              by=0,bit=0,n=36
         1 010577   200232 236100                    LDQ     DIG+1,,AUTO
         1 010600   000000 116003                    CMPQ    0,DU
         1 010601   010603 600000 1                  TZE     s:10865

  10864  1 010602   200227 450100                    STZ     LEAD0,,AUTO

     1775    10865    3             IF NOT( FMT=%OCT_FMT AND LEAD0='1'B AND OCT_VAL(I)=0 )
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:290  

  10865  1 010603   200052 235100                    LDA     FMT,,AUTO
         1 010604   000001 115007                    CMPA    1,DL
         1 010605   010620 601000 1                  TNZ     s:10867
         1 010606   200227 234100                    SZN     LEAD0,,AUTO
         1 010607   010620 605000 1                  TPL     s:10867
         1 010610   200111 236100                    LDQ     I,,AUTO
         1 010611   000003 402007                    MPY     3,DL
         1 010612   003100 061506                    CSR     bolr='003'O
         1 010613   200032 000003                    BDSC    HOST_NUVAL,Q,AUTO        by=0,bit=0,n=3
         1 010614   200232 000044                    BDSC    DIG+1,,AUTO              by=0,bit=0,n=36
         1 010615   200232 236100                    LDQ     DIG+1,,AUTO
         1 010616   000000 116003                    CMPQ    0,DU
         1 010617   010635 600000 1                  TZE     s:10870

     1776    10866    4             THEN DO;

     1777    10867    4                  SUBSTR ( MYBUF, NCHARS, 1 ) = OCTCHARS ( OCT_VAL(I) );

  10867  1 010620   200111 236100                    LDQ     I,,AUTO
         1 010621   000003 402007                    MPY     3,DL
         1 010622   003100 061506                    CSR     bolr='003'O
         1 010623   200032 000003                    BDSC    HOST_NUVAL,Q,AUTO        by=0,bit=0,n=3
         1 010624   200232 000044                    BDSC    DIG+1,,AUTO              by=0,bit=0,n=36
         1 010625   200232 236100                    LDQ     DIG+1,,AUTO
         1 010626   200055 235100                    LDA     NCHARS,,AUTO
         1 010627   040105 100406                    MLR     fill='040'O
         1 010630   000027 000001 0                  ADSC9   OCTCHARS,Q               cn=0,n=1
         1 010631   200134 000001                    ADSC9   MYBUF,A,AUTO             cn=0,n=1

     1778    10868    4                  NCHARS = NCHARS + 1;

  10868  1 010632   200055 235100                    LDA     NCHARS,,AUTO
         1 010633   000001 035007                    ADLA    1,DL
         1 010634   200055 755100                    STA     NCHARS,,AUTO

     1779    10869    4                END;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:291  

     1780    10870    3           END;

  10870  1 010635   200111 235100                    LDA     I,,AUTO
         1 010636   000001 035007                    ADLA    1,DL
         1 010637   200111 755100                    STA     I,,AUTO
         1 010640   200053 236100                    LDQ     NU_SIZE,,AUTO
         1 010641   000003 506007                    DIV     3,DL
         1 010642   000000 116003                    CMPQ    0,DU
         1 010643   010647 604000 1                  TMI     s:10871
         1 010644   200111 116100                    CMPQ    I,,AUTO
         1 010645   010647 600000 1                  TZE     s:10871
         1 010646   010572 603000 1                  TRC     s:10864

     1781    10871    2        IF NCHARS = 0

  10871  1 010647   200055 235100                    LDA     NCHARS,,AUTO
         1 010650   010657 601000 1                  TNZ     s:10876

     1782    10872    3        THEN DO;

     1783    10873    3             SUBSTR ( MYBUF, NCHARS, 1 ) = '0';

  10873  1 010651   040105 100400                    MLR     fill='040'O
         1 010652   000032 000001 2                  ADSC9   26                       cn=0,n=1
         1 010653   200134 000001                    ADSC9   MYBUF,A,AUTO             cn=0,n=1

     1784    10874    3             NCHARS = NCHARS + 1;

  10874  1 010654   200055 235100                    LDA     NCHARS,,AUTO
         1 010655   000001 035007                    ADLA    1,DL
         1 010656   200055 755100                    STA     NCHARS,,AUTO

     1785    10875    3           END;

     1786    10876    2        RETURN;

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:292  
  10876  1 010657   200226 221300                    LDX1  ! SAVE_EWSQ#+6,,AUTO
         1 010660   000001 702211                    TSX2  ! 1,X1

     1787    10877    2   END BIN2OCT;
     1788    10878        %EJECT;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:293  
     1789    10879    1   BIN2HEX: PROC;

  10879  1 010661   200226 741300       BIN2HEX      STX1  ! SAVE_EWSQ#+6,,AUTO

     1790    10880    2   DCL LEAD0 BIT(1);
     1791    10881    2        LEAD0 = '1'B;

  10881  1 010662   400000 236003                    LDQ     -131072,DU
         1 010663   200227 756100                    STQ     LEAD0,,AUTO

     1792    10882    2        NCHARS = 0;

  10882  1 010664   200055 450100                    STZ     NCHARS,,AUTO

     1793    10883
     1794    10884    3        DO I = 0 TO NU_SIZE/4-1;

  10884  1 010665   200111 450100                    STZ     I,,AUTO
         1 010666   010731 710000 1                  TRA     s:10891+3

     1795    10885    3             IF HEX_VAL(I) ~= 0 THEN LEAD0 = '0'B;

  10885  1 010667   200111 235100                    LDA     I,,AUTO
         1 010670   000002 735000                    ALS     2
         1 010671   003100 061505                    CSR     bolr='003'O
         1 010672   200032 000004                    BDSC    HOST_NUVAL,A,AUTO        by=0,bit=0,n=4
         1 010673   200232 000044                    BDSC    DIG+1,,AUTO              by=0,bit=0,n=36
         1 010674   200232 236100                    LDQ     DIG+1,,AUTO
         1 010675   000000 116003                    CMPQ    0,DU
         1 010676   010700 600000 1                  TZE     s:10886

  10885  1 010677   200227 450100                    STZ     LEAD0,,AUTO

     1796    10886    3             IF NOT( FMT=%X_FMT AND LEAD0='1'B AND HEX_VAL(I)=0 )

  10886  1 010700   200052 236100                    LDQ     FMT,,AUTO
         1 010701   000015 116007                    CMPQ    13,DL
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:294  
         1 010702   010713 601000 1                  TNZ     s:10888
         1 010703   200227 234100                    SZN     LEAD0,,AUTO
         1 010704   010713 605000 1                  TPL     s:10888
         1 010705   003100 061505                    CSR     bolr='003'O
         1 010706   200032 000004                    BDSC    HOST_NUVAL,A,AUTO        by=0,bit=0,n=4
         1 010707   200232 000044                    BDSC    DIG+1,,AUTO              by=0,bit=0,n=36
         1 010710   200232 236100                    LDQ     DIG+1,,AUTO
         1 010711   000000 116003                    CMPQ    0,DU
         1 010712   010726 600000 1                  TZE     s:10891

     1797    10887    4             THEN DO;

     1798    10888    4                  SUBSTR ( MYBUF, NCHARS, 1 ) = HEXCHARS ( HEX_VAL(I) );

  10888  1 010713   003100 061505                    CSR     bolr='003'O
         1 010714   200032 000004                    BDSC    HOST_NUVAL,A,AUTO        by=0,bit=0,n=4
         1 010715   200232 000044                    BDSC    DIG+1,,AUTO              by=0,bit=0,n=36
         1 010716   200232 236100                    LDQ     DIG+1,,AUTO
         1 010717   200055 235100                    LDA     NCHARS,,AUTO
         1 010720   040105 100406                    MLR     fill='040'O
         1 010721   000031 000001 0                  ADSC9   HEXCHARS,Q               cn=0,n=1
         1 010722   200134 000001                    ADSC9   MYBUF,A,AUTO             cn=0,n=1

     1799    10889    4                  NCHARS = NCHARS + 1;

  10889  1 010723   200055 235100                    LDA     NCHARS,,AUTO
         1 010724   000001 035007                    ADLA    1,DL
         1 010725   200055 755100                    STA     NCHARS,,AUTO

     1800    10890    4                END;

     1801    10891    3           END;

  10891  1 010726   200111 235100                    LDA     I,,AUTO
         1 010727   000001 035007                    ADLA    1,DL
         1 010730   200111 755100                    STA     I,,AUTO
         1 010731   200053 236100                    LDQ     NU_SIZE,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:295  
         1 010732   000004 506007                    DIV     4,DL
         1 010733   000000 116003                    CMPQ    0,DU
         1 010734   010740 604000 1                  TMI     s:10892
         1 010735   200111 116100                    CMPQ    I,,AUTO
         1 010736   010740 600000 1                  TZE     s:10892
         1 010737   010667 603000 1                  TRC     s:10885

     1802    10892    2        IF NCHARS = 0

  10892  1 010740   200055 235100                    LDA     NCHARS,,AUTO
         1 010741   010750 601000 1                  TNZ     s:10897

     1803    10893    3        THEN DO;

     1804    10894    3             SUBSTR ( MYBUF, NCHARS, 1 ) = '0';

  10894  1 010742   040105 100400                    MLR     fill='040'O
         1 010743   000032 000001 2                  ADSC9   26                       cn=0,n=1
         1 010744   200134 000001                    ADSC9   MYBUF,A,AUTO             cn=0,n=1

     1805    10895    3             NCHARS = NCHARS + 1;

  10895  1 010745   200055 235100                    LDA     NCHARS,,AUTO
         1 010746   000001 035007                    ADLA    1,DL
         1 010747   200055 755100                    STA     NCHARS,,AUTO

     1806    10896    3           END;

     1807    10897    2        RETURN;

  10897  1 010750   200226 221300                    LDX1  ! SAVE_EWSQ#+6,,AUTO
         1 010751   000001 702211                    TSX2  ! 1,X1

     1808    10898    2   END BIN2HEX;
     1809    10899        %EJECT;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:296  
     1810    10900    1   STRETCH: PROC;

  10900  1 010752   200226 741300       STRETCH      STX1  ! SAVE_EWSQ#+6,,AUTO

     1811    10901
     1812    10902    2   DCL J UBIN;
     1813    10903    2   DCL K UBIN;
     1814    10904    2   DCL SM1 UBIN;
     1815    10905    2        VAL = 0;

  10905  1 010753   200216 450100                    STZ     VAL,,AUTO

     1816    10906    2        SM1 = SIZE - 1;

  10906  1 010754   200004 470500                    LDP0    @SIZE,,AUTO
         1 010755   000000 235100                    LDA     0,,PR0
         1 010756   000001 135007                    SBLA    1,DL
         1 010757   200231 755100                    STA     SM1,,AUTO

     1817    10907    3        DO I = 0 TO SM1;

  10907  1 010760   200111 450100                    STZ     I,,AUTO
         1 010761   010776 710000 1                  TRA     s:10911+3

     1818    10908    3             J = SM1 - I;

  10908  1 010762   200231 236100                    LDQ     SM1,,AUTO
         1 010763   200111 136100                    SBLQ    I,,AUTO
         1 010764   200227 756100                    STQ     J,,AUTO

     1819    10909    3             K = 35 - I;

  10909  1 010765   000043 235007                    LDA     35,DL
         1 010766   200111 135100                    SBLA    I,,AUTO
         1 010767   200230 755100                    STA     K,,AUTO

     1820    10910    3             VALBITS(K) = VBITS(J);
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:297  

  10910  1 010770   003105 060506                    CSL     bolr='003'O
         1 010771   200012 000001                    BDSC    CVALUES,Q,AUTO           by=0,bit=0,n=1
         1 010772   200216 000001                    BDSC    VAL,A,AUTO               by=0,bit=0,n=1

     1821    10911    3           END;

  10911  1 010773   200111 235100                    LDA     I,,AUTO
         1 010774   000001 035007                    ADLA    1,DL
         1 010775   200111 755100                    STA     I,,AUTO
         1 010776   200231 236100                    LDQ     SM1,,AUTO
         1 010777   200111 116100                    CMPQ    I,,AUTO
         1 011000   010762 603000 1                  TRC     s:10908

     1822    10912    2        RETURN;

  10912  1 011001   200226 221300                    LDX1  ! SAVE_EWSQ#+6,,AUTO
         1 011002   000001 702211                    TSX2  ! 1,X1

     1823    10913    2   END STRETCH;
     1824    10914        %EJECT;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:298  
     1825    10915    1   PUTDECIMALPT: PROC ALTRET;

  10915  1 011003   200226 741300       PUTDECIMALPT STX1  ! SAVE_EWSQ#+6,,AUTO

     1826    10916    2        TEXT$ -> CHAR1 = '.';

  10916  1 011004   200217 470500                    LDP0    TEXT$,,AUTO
         1 011005   040100 100400                    MLR     fill='040'O
         1 011006   000035 000001 2                  ADSC9   29                       cn=0,n=1
         1 011007   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1827    10917    2        CALL DDR$BUMPC_D$( 1 ) ALTRET(DERR);

  10917  1 011010   000000 630400 2                  EPPR0   0
         1 011011   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 011012   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 011013   011021 702000 1                  TSX2    DERR

     1828    10918    2        TEXT$ = S_D.D$;

  10918  1 011014   000000 470400 xsym               LDP0    S_D$
         1 011015   000044 236100                    LDQ     36,,PR0
         1 011016   200217 756100                    STQ     TEXT$,,AUTO

     1829    10919    2        RETURN;

  10919  1 011017   200226 221300                    LDX1  ! SAVE_EWSQ#+6,,AUTO
         1 011020   000001 702211                    TSX2  ! 1,X1

     1830    10920    2   DERR: ALTRETURN;

  10920  1 011021   200226 221300       DERR         LDX1  ! SAVE_EWSQ#+6,,AUTO
         1 011022   000000 702211                    TSX2  ! 0,X1

     1831    10921    2   END PUTDECIMALPT;
     1832    10922        %EJECT;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:299  
     1833    10923    1   FLOAT: PROC(SIZE,VALUE) ALTRET;

  10923  1 011023   200226 741300       FLOAT        STX1  ! SAVE_EWSQ#+6,,AUTO

     1834    10924    2   DCL SIZE UBIN;
     1835    10925    2   DCL VALUE BIT(72) DALIGNED;
     1836    10926    2   DCL DIG UBIN;
     1837    10927                                                /**/
     1838    10928    3        DO CASE (SIZE);

  10928  1 011024   200227 470500                    LDP0    @SIZE,,AUTO
         1 011025   000000 235100                    LDA     0,,PR0
         1 011026   000044 135007                    SBLA    36,DL
         1 011027   000055 115007                    CMPA    45,DL
         1 011030   011032 602005 1                  TNC     s:10928+6,AL
         1 011031   011173 710000 1                  TRA     s:10943
         1 011032   011107 710000 1                  TRA     s:10930
         1 011033   011173 710000 1                  TRA     s:10943
         1 011034   011173 710000 1                  TRA     s:10943
         1 011035   011173 710000 1                  TRA     s:10943
         1 011036   011173 710000 1                  TRA     s:10943
         1 011037   011173 710000 1                  TRA     s:10943
         1 011040   011173 710000 1                  TRA     s:10943
         1 011041   011173 710000 1                  TRA     s:10943
         1 011042   011145 710000 1                  TRA     s:10936
         1 011043   011173 710000 1                  TRA     s:10943
         1 011044   011173 710000 1                  TRA     s:10943
         1 011045   011173 710000 1                  TRA     s:10943
         1 011046   011173 710000 1                  TRA     s:10943
         1 011047   011173 710000 1                  TRA     s:10943
         1 011050   011173 710000 1                  TRA     s:10943
         1 011051   011173 710000 1                  TRA     s:10943
         1 011052   011173 710000 1                  TRA     s:10943
         1 011053   011173 710000 1                  TRA     s:10943
         1 011054   011173 710000 1                  TRA     s:10943
         1 011055   011173 710000 1                  TRA     s:10943
         1 011056   011173 710000 1                  TRA     s:10943
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:300  
         1 011057   011173 710000 1                  TRA     s:10943
         1 011060   011173 710000 1                  TRA     s:10943
         1 011061   011173 710000 1                  TRA     s:10943
         1 011062   011173 710000 1                  TRA     s:10943
         1 011063   011173 710000 1                  TRA     s:10943
         1 011064   011173 710000 1                  TRA     s:10943
         1 011065   011173 710000 1                  TRA     s:10943
         1 011066   011173 710000 1                  TRA     s:10943
         1 011067   011173 710000 1                  TRA     s:10943
         1 011070   011173 710000 1                  TRA     s:10943
         1 011071   011173 710000 1                  TRA     s:10943
         1 011072   011173 710000 1                  TRA     s:10943
         1 011073   011173 710000 1                  TRA     s:10943
         1 011074   011173 710000 1                  TRA     s:10943
         1 011075   011173 710000 1                  TRA     s:10943
         1 011076   011126 710000 1                  TRA     s:10933
         1 011077   011173 710000 1                  TRA     s:10943
         1 011100   011173 710000 1                  TRA     s:10943
         1 011101   011173 710000 1                  TRA     s:10943
         1 011102   011173 710000 1                  TRA     s:10943
         1 011103   011173 710000 1                  TRA     s:10943
         1 011104   011173 710000 1                  TRA     s:10943
         1 011105   011173 710000 1                  TRA     s:10943
         1 011106   011145 710000 1                  TRA     s:10936

     1839    10929    3          CASE (36);

     1840    10930    3             DIG = 9;

  10930  1 011107   000011 236007                    LDQ     9,DL
         1 011110   200231 756100                    STQ     DIG,,AUTO

     1841    10931    3             CALL XPN_7RTOLSP (VALUE, AN, DIG, POWER) ALTRET (BADLIB);

  10931  1 011111   200133 631500                    EPPR1   POWER,,AUTO
         1 011112   200235 451500                    STP1    DIG+4,,AUTO
         1 011113   200231 633500                    EPPR3   DIG,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:301  
         1 011114   200234 453500                    STP3    DIG+3,,AUTO
         1 011115   200124 634500                    EPPR4   AN,,AUTO
         1 011116   200233 454500                    STP4    DIG+2,,AUTO
         1 011117   200230 236100                    LDQ     @VALUE,,AUTO
         1 011120   200232 756100                    STQ     DIG+1,,AUTO
         1 011121   200232 630500                    EPPR0   DIG+1,,AUTO
         1 011122   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 011123   000000 701000 xent               TSX1    XPN_7RTOLSP
         1 011124   011271 702000 1                  TSX2    BADLIB
         1 011125   011173 710000 1                  TRA     s:10943

     1842    10932    3          CASE (72);

     1843    10933    3             DIG = 20;

  10933  1 011126   000024 236007                    LDQ     20,DL
         1 011127   200231 756100                    STQ     DIG,,AUTO

     1844    10934    3             CALL XPN_7DTOLSP (VALUE, AN, DIG, POWER) ALTRET (BADLIB);

  10934  1 011130   200133 631500                    EPPR1   POWER,,AUTO
         1 011131   200235 451500                    STP1    DIG+4,,AUTO
         1 011132   200231 633500                    EPPR3   DIG,,AUTO
         1 011133   200234 453500                    STP3    DIG+3,,AUTO
         1 011134   200124 634500                    EPPR4   AN,,AUTO
         1 011135   200233 454500                    STP4    DIG+2,,AUTO
         1 011136   200230 236100                    LDQ     @VALUE,,AUTO
         1 011137   200232 756100                    STQ     DIG+1,,AUTO
         1 011140   200232 630500                    EPPR0   DIG+1,,AUTO
         1 011141   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 011142   000000 701000 xent               TSX1    XPN_7DTOLSP
         1 011143   011271 702000 1                  TSX2    BADLIB
         1 011144   011173 710000 1                  TRA     s:10943

     1845    10935    3          CASE (44,80);

     1846    10936    3             IF SIZE = 44
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:302  

  10936  1 011145   000000 235100                    LDA     0,,PR0
         1 011146   000054 115007                    CMPA    44,DL
         1 011147   011153 601000 1                  TNZ     s:10938

     1847    10937    3             THEN DIG = 12;

  10937  1 011150   000014 236007                    LDQ     12,DL
         1 011151   200231 756100                    STQ     DIG,,AUTO
         1 011152   011155 710000 1                  TRA     s:10939

     1848    10938    3             ELSE DIG = 22;

  10938  1 011153   000026 236007                    LDQ     22,DL
         1 011154   200231 756100                    STQ     DIG,,AUTO

     1849    10939    3             POWER = KVALUE(2);            /* Need to pass $E for $EA[Q] */

  10939  1 011155   200014 235100                    LDA     CVALUES+2,,AUTO
         1 011156   200133 755100                    STA     POWER,,AUTO

     1850    10940    3             CALL XPN_7AQTOLSP (VALUE, AN, DIG, POWER) ALTRET (BADLIB);

  10940  1 011157   200133 631500                    EPPR1   POWER,,AUTO
         1 011160   200235 451500                    STP1    DIG+4,,AUTO
         1 011161   200231 633500                    EPPR3   DIG,,AUTO
         1 011162   200234 453500                    STP3    DIG+3,,AUTO
         1 011163   200124 634500                    EPPR4   AN,,AUTO
         1 011164   200233 454500                    STP4    DIG+2,,AUTO
         1 011165   200230 236100                    LDQ     @VALUE,,AUTO
         1 011166   200232 756100                    STQ     DIG+1,,AUTO
         1 011167   200232 630500                    EPPR0   DIG+1,,AUTO
         1 011170   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 011171   000000 701000 xent               TSX1    XPN_7AQTOLSP
         1 011172   011271 702000 1                  TSX2    BADLIB

     1851    10941    3          END;
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:303  

     1852    10942
     1853    10943    2        IF (POWER < DIG AND POWER > 0)

  10943  1 011173   200133 236100                    LDQ     POWER,,AUTO
         1 011174   011177 604000 1                  TMI     s:10943+4
         1 011175   200231 116100                    CMPQ    DIG,,AUTO
         1 011176   011226 603000 1                  TRC     s:10945
         1 011177   000000 116003                    CMPQ    0,DU
         1 011200   011226 604400 1                  TMOZ    s:10945

     1854    10944    2       THEN CALL XPN_7FLJ(MYBUF, LENGTHC(MYBUF), AN, DIG, POWER-DIG, 0, NCHARS) ALTRET
             10944                 (BADLIB);

  10944  1 011201   200231 136100                    SBLQ    DIG,,AUTO
         1 011202   200232 756100                    STQ     DIG+1,,AUTO
         1 011203   200055 630500                    EPPR0   NCHARS,,AUTO
         1 011204   200241 450500                    STP0    DIG+8,,AUTO
         1 011205   000053 236000 2                  LDQ     43
         1 011206   200240 756100                    STQ     DIG+7,,AUTO
         1 011207   200232 631500                    EPPR1   DIG+1,,AUTO
         1 011210   200237 451500                    STP1    DIG+6,,AUTO
         1 011211   200231 633500                    EPPR3   DIG,,AUTO
         1 011212   200236 453500                    STP3    DIG+5,,AUTO
         1 011213   200124 634500                    EPPR4   AN,,AUTO
         1 011214   200235 454500                    STP4    DIG+4,,AUTO
         1 011215   000054 236000 2                  LDQ     44
         1 011216   200234 756100                    STQ     DIG+3,,AUTO
         1 011217   200134 635500                    EPPR5   MYBUF,,AUTO
         1 011220   200233 455500                    STP5    DIG+2,,AUTO
         1 011221   200233 630500                    EPPR0   DIG+2,,AUTO
         1 011222   000025 631400 xsym               EPPR1   B_VECTNIL+21
         1 011223   000000 701000 xent               TSX1    XPN_7FLJ
         1 011224   011271 702000 1                  TSX2    BADLIB
         1 011225   011254 710000 1                  TRA     s:10946

     1855    10945    2        ELSE CALL XPN_7ELJE1(MYBUF, LENGTHC(MYBUF), AN, DIG, POWER-DIG, 0, NCHARS, -2)
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:304  
             10945                 ALTRET(BADLIB);

  10945  1 011226   200231 136100                    SBLQ    DIG,,AUTO
         1 011227   200232 756100                    STQ     DIG+1,,AUTO
         1 011230   000056 236000 2                  LDQ     46
         1 011231   200243 756100                    STQ     DIG+10,,AUTO
         1 011232   200055 630500                    EPPR0   NCHARS,,AUTO
         1 011233   200242 450500                    STP0    DIG+9,,AUTO
         1 011234   000053 236000 2                  LDQ     43
         1 011235   200241 756100                    STQ     DIG+8,,AUTO
         1 011236   200232 631500                    EPPR1   DIG+1,,AUTO
         1 011237   200240 451500                    STP1    DIG+7,,AUTO
         1 011240   200231 633500                    EPPR3   DIG,,AUTO
         1 011241   200237 453500                    STP3    DIG+6,,AUTO
         1 011242   200124 634500                    EPPR4   AN,,AUTO
         1 011243   200236 454500                    STP4    DIG+5,,AUTO
         1 011244   000054 236000 2                  LDQ     44
         1 011245   200235 756100                    STQ     DIG+4,,AUTO
         1 011246   200134 635500                    EPPR5   MYBUF,,AUTO
         1 011247   200234 455500                    STP5    DIG+3,,AUTO
         1 011250   200234 630500                    EPPR0   DIG+3,,AUTO
         1 011251   000026 631400 xsym               EPPR1   B_VECTNIL+22
         1 011252   000000 701000 xent               TSX1    XPN_7ELJE1
         1 011253   011271 702000 1                  TSX2    BADLIB

     1856    10946    2        CALL DDR$BUMPC_D$(NCHARS) ALTRET(DERR);

  10946  1 011254   200055 630500                    EPPR0   NCHARS,,AUTO
         1 011255   200232 450500                    STP0    DIG+1,,AUTO
         1 011256   200232 630500                    EPPR0   DIG+1,,AUTO
         1 011257   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 011260   000000 701000 xent               TSX1    DDR$BUMPC_D$
         1 011261   011271 702000 1                  TSX2    BADLIB

     1857    10947    2        TEXT$ -> TEXTR = MYBUF;

  10947  1 011262   200217 470500                    LDP0    TEXT$,,AUTO
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:305  
         1 011263   200055 720100                    LXL0    NCHARS,,AUTO
         1 011264   040140 100500                    MLR     fill='040'O
         1 011265   200134 000300                    ADSC9   MYBUF,,AUTO              cn=0,n=192
         1 011266   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

     1858    10948    2        RETURN;

  10948  1 011267   200226 221300                    LDX1  ! SAVE_EWSQ#+6,,AUTO
         1 011270   000001 702211                    TSX2  ! 1,X1

  10947  1 011271                       BADLIB       null
  10947  1 011271                       DERR         null
     1859    10949    2   BADLIB:;
     1860    10950    2   DERR:;
     1861    10951    2        ALTRETURN;

  10951  1 011271   200226 221300                    LDX1  ! SAVE_EWSQ#+6,,AUTO
         1 011272   000000 702211                    TSX2  ! 0,X1

ZEROES
 Sect OctLoc
   0     000   060060 060060   060060 060060   060060 060060   060060 060060    0000000000000000
   0     014*  060060 060060   060060 060060   060060 060060   060060 060060    0000000000000000

BITCHAR
 Sect OctLoc
   0     020   060061 ******                                                    01..

SEGID
 Sect OctLoc
   0     021   044120 123044   044044 044101   123044 114123                    $PS$$$$AS$LS

DIGITS
 Sect OctLoc
   0     024   060061 062063   064065 066067   070071 ******                    0123456789..

OCTCHARS
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:306  
 Sect OctLoc
   0     027   060061 062063   064065 066067                                    01234567

HEXCHARS
 Sect OctLoc
   0     031   060061 062063   064065 066067   070071 101102   103104 105106    0123456789ABCDEF

(unnamed)
 Sect OctLoc
   0     035   055061 040040   047102 040040   054040 040040   102104 075040    -1  'B  ,   BD=
   0     041   105115 120124   131040 040040   054127 123122   075040 040040    EMPTY   ,WSR=
   0     045   054127 123121   075040 040040   054106 114075   056040 040040    ,WSQ=   ,FL=.
   0     051   054124 131075   054114 075040   111103 075040   054044 114123    ,TY=,L= IC= ,$LS
   0     055   054114 102101   123105 075040   054114 123111   132105 075040    ,LBASE= ,LSIZE=
   0     061   126101 114111   104075 047061   047102 054040   126101 114111    VALID='1'B, VALI
   0     065   104075 047060   047102 054040   102101 123105   075040 040040    D='0'B, BASE=
   0     071   054122 104137   120122 111126   075040 040040   054127 122137    ,RD_PRIV=   ,WR_
   0     075   120122 111126   075040 040040   054105 130137   120122 111126    PRIV=   ,EX_PRIV
   0     101   075040 040040   054123 111132   105075 040040   047105 102040    =   ,SIZE=  'EB
   0     105   055115 040040   047117 040040   000000 777777   040050 053040    -M  'O  .... (+
   0     111   040123 164141   164165 163072   040040 040040   040000 000000     Status:     ...
   0     115   103117 120131   116117 122115   101114 040123   110122 111116    COPYNORMAL SHRIN
   0     121   113040 040040   105130 124105   116104 105104   040123 110122    K   EXTENDED SHR
   0     125   111116 113040   104101 124101   123124 101103   113040 123110    INK DATASTACK SH
   0     131   122111 116113   054102 104075   047130 040040   047130 061040    RINK,BD='X  'X1

(unnamed)
 Sect OctLoc
   2     000   000003 006000   000007 006000   055040 040040   000004 006000    ........-   ....
   2     004   054040 040040   000005 006000   000003 600000   000000 000015    ,   ............
   2     010   000007 006000   047040 040040   050040 040040   000000 000044    ....'   (   ...$
   2     014   000013 006000   000000 000110   000015 006000   051040 040040    .......H....)
   2     020   000001 200000   000011 006000   000077 777776   000014 006000    .........?......
   2     024   000015 006000   000013 006000   000010 006000   000030 006000    ................
   2     030   000000 000014   000030 006000   060040 040040   124040 040040    ........0   T
   2     034   106040 040040   056040 040040   000040 040040   000000 000024    F   .   .   ....
   2     040   000111 006000   000012 006000   000113 006000   000006 006000    .I.......K......
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:307  
   2     044   000037 006000   000003 200000   000000 000017   000046 006000    .............&..
   2     050   000000 000020   000050 006000   000000 000300   000002 006000    .....(..........
   2     054   000052 006000   777777 777776   000055 006000                    .*.......-..
     1862    10952    2   END FLOAT;
     1863    10953    1   END DDA$DISPFMT;

PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:308  
--  Include file information  --

   B$OBJECT_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   DD_SUBS_C.:E05TOU  is referenced.
   DD$BASED.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDA$DISPFMT.

   Procedure DDA$DISPFMT requires 4795 words for executable code.
   Procedure DDA$DISPFMT requires 164 words of local(AUTO) storage.

    No errors detected in file DDA$DISPFMT.:E05TSI    .
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:309  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:310  
          MINI XREF LISTING

ACHARTEMP
       276**DCL       277--REDEF   10221<<ASSIGN  10223<<ASSIGN  10224<<ASSIGN  10230<<ASSIGN  10233<<ASSIGN
     10237<<ASSIGN  10303<<ASSIGN  10305<<ASSIGN  10306<<ASSIGN  10312<<ASSIGN  10315<<ASSIGN  10319<<ASSIGN
     10349<<ASSIGN  10352<<ASSIGN  10360>>IF      10370>>ASSIGN  10379>>ASSIGN  10402--ASSIGN  10407>>ASSIGN
     10425--ASSIGN
AN
       426**DCL     10931<>CALL    10934<>CALL    10940<>CALL    10944<>CALL    10945<>CALL
B$BITS
       467**DCL     10818<<ASSIGN  10818>>ASSIGN
B$DNAME.COUNT
      9452**DCL      9459--IMP-SIZ 10560>>ASSIGN  10569>>ASSIGN  10570>>ASSIGN
B$XL_EBC_DUMP$
       423**DCL       424--IMP-PTR  9961>>ASSIGN   9974>>ASSIGN
BADLIB
     10013**LABEL    9666--CALLALT  9667--CALLALT  9673--CALLALT  9674--CALLALT 10006--CALLALT
BADLIB IN PROCEDURE FLOAT
     10947**LABEL   10931--CALLALT 10934--CALLALT 10940--CALLALT 10944--CALLALT 10945--CALLALT
BADSCHEMA
     10845**LABEL   10555--CALLALT 10556--CALLALT
BIN2HEX
     10879**PROC    10760--CALL    10800--CALL
BIN2OCT
     10857**PROC    10122--CALL    10158--CALL
BITCHAR
       300**DCL      9621>>ASSIGN
CHAR1
       452**DCL      9536<<ASSIGN   9538<<CALLBLT  9539<<ASSIGN   9551<<ASSIGN   9618<<ASSIGN   9621<<ASSIGN
      9635<<ASSIGN   9637<<ASSIGN   9640<<ASSIGN   9654<<ASSIGN   9663<<ASSIGN   9677<<ASSIGN   9723<<ASSIGN
      9724<<CALLBLT  9728<<ASSIGN   9743<<ASSIGN   9744<<CALLBLT  9775<<CALLBLT  9784<<ASSIGN   9826<<CALLBLT
      9842<<ASSIGN   9843<<CALLBLT  9886<<CALLBLT  9955<<ASSIGN   9961<<ASSIGN   9974<<ASSIGN  10038<<ASSIGN
     10048<<ASSIGN  10053<<ASSIGN  10054<<CALLBLT 10079<<ASSIGN  10080<<ASSIGN  10119<<ASSIGN  10155<<ASSIGN
     10362<<ASSIGN  10374<<ASSIGN  10379<<ASSIGN  10384<<ASSIGN  10394<<ASSIGN  10411<<ASSIGN  10418<<ASSIGN
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:311  
     10498<<ASSIGN  10520<<ASSIGN  10586<>CALL    10593<>CALL    10614<<ASSIGN  10616<<CALLBLT 10617<<ASSIGN
     10624<<ASSIGN  10646<<ASSIGN  10659<<ASSIGN  10660<<CALLBLT 10731<<ASSIGN  10771<<ASSIGN  10815<<ASSIGN
     10824<<ASSIGN  10826<<ASSIGN  10916<<ASSIGN
CHAR11
       461**DCL      9902<<ASSIGN   9903<<ASSIGN
CHAR13
       462**DCL     10683<<ASSIGN
CHAR15
       463**DCL     10687<<ASSIGN
CHAR16
       464**DCL     10691<<ASSIGN
CHAR2
       453**DCL      9594<<ASSIGN   9624<<ASSIGN   9670<<ASSIGN  10044<<ASSIGN  10708<<ASSIGN  10764<<ASSIGN
CHAR3
       454**DCL      9563<<ASSIGN   9732<<ASSIGN   9765<<ASSIGN   9765>>ASSIGN   9787<<ASSIGN   9816<<ASSIGN
      9816>>ASSIGN   9831<<ASSIGN   9853<<ASSIGN   9979<<ASSIGN  10490<<ASSIGN  10637<<ASSIGN  10649<<ASSIGN
     10672<<ASSIGN  10672>>ASSIGN  10829<<ASSIGN
CHAR4
       455**DCL      9773<<ASSIGN   9824<<ASSIGN   9857<<ASSIGN   9887<<ASSIGN  10674<<ASSIGN  10679<<ASSIGN
     10712<<ASSIGN
CHAR5
       456**DCL      9748<<ASSIGN   9762<<ASSIGN   9767<<ASSIGN   9799<<ASSIGN   9813<<ASSIGN   9818<<ASSIGN
      9883<<ASSIGN   9906<<ASSIGN  10051<<CALLBLT 10664<<ASSIGN  10669<<ASSIGN
CHAR6
       457**DCL      9941<<ASSIGN
CHAR62
       465**DCL     10402<<ASSIGN  10402>>ASSIGN  10425>>ASSIGN
CHAR7
       458**DCL      9867<<ASSIGN   9874<<ASSIGN
CHAR9
       460**DCL      9914<<ASSIGN   9923<<ASSIGN   9932<<ASSIGN
CHARS
       281**DCL     10182<<ASSIGN  10189>>CALLBLT 10189>>CALLBLT 10189>>CALLBLT 10192>>ASSIGN  10193>>CALLBLT
     10193>>CALLBLT 10193>>CALLBLT 10223>>ASSIGN  10231>>CALLBLT 10231>>CALLBLT 10234>>CALLBLT 10234>>CALLBLT
     10237>>ASSIGN  10238>>CALLBLT 10238>>CALLBLT 10257<<ASSIGN  10259>>DOINDEX 10271>>CALLBLT 10271>>CALLBLT
     10271>>CALLBLT 10274>>ASSIGN  10275>>CALLBLT 10275>>CALLBLT 10275>>CALLBLT 10305>>ASSIGN  10313>>CALLBLT
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:312  
     10313>>CALLBLT 10316>>CALLBLT 10316>>CALLBLT 10319>>ASSIGN  10320>>CALLBLT 10320>>CALLBLT 10330<<ASSIGN
     10332>>DOINDEX 10348>>ASSIGN  10349>>ASSIGN  10350>>CALLBLT 10350>>CALLBLT 10353>>CALLBLT 10353>>CALLBLT
CHARTEMP
       277**DCL     10177<<ASSIGN  10189<<CALLBLT 10193<<CALLBLT 10231<<CALLBLT 10234<<CALLBLT 10238<<CALLBLT
     10246<<ASSIGN  10271<<CALLBLT 10275<<CALLBLT 10313<<CALLBLT 10316<<CALLBLT 10320<<CALLBLT 10350<<CALLBLT
     10353<<CALLBLT
CTEMP
       288**DCL     10370<<ASSIGN  10371>>IF      10374>>ASSIGN  10407<<ASSIGN  10408>>IF      10411>>ASSIGN
CVALUE
        60**DCL     10188>>ASSIGN  10192>>ASSIGN  10233>>ASSIGN  10237>>ASSIGN
CVALUES
        52**DCL        53--REDEF      54--REDEF      60--REDEF      61--REDEF      72--REDEF      80--REDEF
       100--REDEF     106--REDEF     107--REDEF     129--REDEF     139--REDEF     143--REDEF     145--REDEF
       146--REDEF     147--REDEF     148--REDEF     156--REDEF     165--REDEF     175--REDEF     187--REDEF
       197--REDEF     202--REDEF     206--REDEF     214--REDEF     218--REDEF    9506<<ASSIGN   9636>>ASSIGN
      9651>>ASSIGN  10026<>CALL    10189>>CALLBLT 10193>>CALLBLT 10231>>CALLBLT 10234>>CALLBLT 10238>>CALLBLT
     10246>>ASSIGN  10818--ASSIGN  10818--ASSIGN
DDA$UTSTIME
      9476**DCL-ENT 10586--CALL
DDE$ERROR
      9465**DCL-ENT  9495--CALL    10014--CALL    10254--CALL    10327--CALL
DDF$DBG_#
      9473**DCL-ENT 10555--CALL    10556--CALL
DDK$COMP1
      9478**DCL-ENT  9685--CALL
DDK$COMP2
      9479**DCL-ENT  9695--CALL
DDQ$WRITE
      9471**DCL-ENT 10544--CALL    10547--CALL    10566--CALL
DDR$BINOCT
      9463**DCL-ENT  9763--CALL     9814--CALL    10670--CALL
DDR$BINTXT
      9464**DCL-ENT  9530--CALL     9542--CALL     9557--CALL     9566--CALL     9587--CALL     9715--CALL
      9738--CALL     9769--CALL     9779--CALL     9793--CALL     9820--CALL     9834--CALL     9850--CALL
      9860--CALL     9870--CALL     9877--CALL     9889--CALL     9910--CALL     9919--CALL     9928--CALL
      9936--CALL     9945--CALL    10493--CALL    10494--CALL    10532--CALL    10608--CALL    10620--CALL
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:313  
     10631--CALL    10640--CALL    10654--CALL    10702--CALL    10716--CALL
DDR$BUMPC_D$
      9466**DCL-ENT  9531--CALL     9535--CALL     9543--CALL     9558--CALL     9562--CALL     9567--CALL
      9589--CALL     9595--CALL     9617--CALL     9634--CALL     9638--CALL     9641--CALL     9652--CALL
      9655--CALL     9662--CALL     9669--CALL     9676--CALL     9716--CALL     9722--CALL     9727--CALL
      9731--CALL     9739--CALL     9747--CALL     9761--CALL     9770--CALL     9780--CALL     9783--CALL
      9786--CALL     9794--CALL     9798--CALL     9812--CALL     9821--CALL     9830--CALL     9835--CALL
      9841--CALL     9851--CALL     9861--CALL     9866--CALL     9871--CALL     9878--CALL     9882--CALL
      9890--CALL     9904--CALL     9907--CALL     9912--CALL     9915--CALL     9921--CALL     9924--CALL
      9930--CALL     9933--CALL     9939--CALL     9942--CALL     9947--CALL     9956--CALL     9962--CALL
      9975--CALL     9980--CALL    10036--CALL    10077--CALL    10120--CALL    10124--CALL    10156--CALL
     10160--CALL    10164--CALL    10363--CALL    10375--CALL    10380--CALL    10382--CALL    10395--CALL
     10399--CALL    10412--CALL    10419--CALL    10424--CALL    10454--CALL    10487--CALL    10489--CALL
     10495--CALL    10499--CALL    10521--CALL    10534--CALL    10565--CALL    10585--CALL    10592--CALL
     10609--CALL    10613--CALL    10621--CALL    10626--CALL    10632--CALL    10636--CALL    10641--CALL
     10645--CALL    10648--CALL    10655--CALL    10663--CALL    10668--CALL    10681--CALL    10685--CALL
     10689--CALL    10693--CALL    10704--CALL    10709--CALL    10713--CALL    10718--CALL    10730--CALL
     10762--CALL    10765--CALL    10770--CALL    10802--CALL    10814--CALL    10822--CALL    10917--CALL
     10946--CALL
DDR$INSTR
      9468**DCL-ENT 10024--CALL
DDR$MOVE
      9472**DCL-ENT 10543--CALL    10562--CALL
DDR$POSIT
      9470**DCL-ENT 10450--CALL    10483--CALL
DDS$IC2NODE
      9474**DCL-ENT 10453--CALL    10486--CALL
DERR
     10853**LABEL    9535--CALLALT  9543--CALLALT  9558--CALLALT  9562--CALLALT  9567--CALLALT  9589--CALLALT
      9595--CALLALT  9601--GOTO     9617--CALLALT  9634--CALLALT  9638--CALLALT  9641--CALLALT  9652--CALLALT
      9655--CALLALT  9662--CALLALT  9669--CALLALT  9676--CALLALT  9716--CALLALT  9722--CALLALT  9727--CALLALT
      9731--CALLALT  9739--CALLALT  9747--CALLALT  9761--CALLALT  9770--CALLALT  9780--CALLALT  9783--CALLALT
      9786--CALLALT  9794--CALLALT  9798--CALLALT  9812--CALLALT  9821--CALLALT  9830--CALLALT  9835--CALLALT
      9841--CALLALT  9851--CALLALT  9866--CALLALT  9871--CALLALT  9878--CALLALT  9882--CALLALT  9890--CALLALT
      9904--CALLALT  9907--CALLALT  9912--CALLALT  9915--CALLALT  9921--CALLALT  9924--CALLALT  9930--CALLALT
      9933--CALLALT  9939--CALLALT  9942--CALLALT  9947--CALLALT  9956--CALLALT  9962--CALLALT  9975--CALLALT
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:314  
      9980--CALLALT 10009--GOTO    10024--CALLALT 10026--CALLALT 10036--CALLALT 10077--CALLALT 10094--GOTO
     10120--CALLALT 10124--CALLALT 10131--GOTO    10156--CALLALT 10160--CALLALT 10164--CALLALT 10363--CALLALT
     10375--CALLALT 10380--CALLALT 10382--CALLALT 10395--CALLALT 10397--CALLALT 10399--CALLALT 10412--CALLALT
     10419--CALLALT 10422--CALLALT 10424--CALLALT 10442--GOTO    10450--CALLALT 10454--CALLALT 10483--CALLALT
     10487--CALLALT 10495--CALLALT 10521--CALLALT 10534--CALLALT 10585--CALLALT 10592--CALLALT 10613--CALLALT
     10621--CALLALT 10626--CALLALT 10632--CALLALT 10641--CALLALT 10645--CALLALT 10648--CALLALT 10655--CALLALT
     10663--CALLALT 10668--CALLALT 10704--CALLALT 10709--CALLALT 10713--CALLALT 10718--CALLALT 10730--CALLALT
     10762--CALLALT 10765--CALLALT 10770--CALLALT 10802--CALLALT 10814--CALLALT 10822--CALLALT 10846--GOTO
     10849--GOTO
DERR IN PROCEDURE FLOAT
     10947**LABEL   10946--CALLALT
DERR IN PROCEDURE PUTDECIMALPT
     10920**LABEL   10917--CALLALT
DFR$INSTR
      9469**DCL-ENT 10026--CALL
DFR$UTSTIME
      9477**DCL-ENT 10593--CALL
DIG IN PROCEDURE FLOAT
     10926**DCL     10930<<ASSIGN  10931<>CALL    10933<<ASSIGN  10934<>CALL    10937<<ASSIGN  10938<<ASSIGN
     10940<>CALL    10943>>IF      10944<>CALL    10944>>CALL    10945<>CALL    10945>>CALL
DIGITS
       303**DCL     10196>>CALLBLT 10197--IF      10278>>CALLBLT 10279--IF
DKVALUE
       146**DCL      9667<>CALL     9674<>CALL
DUE$JERRMSG
      9475**DCL-ENT 10060--CALL
DUE$L6JERRMSG
      9486**DCL-ENT 10069--CALL
DVALUE.BASE.C
       127**DCL      9719>>ASSIGN   9838>>ASSIGN
DVALUE.BASE.W
       126**DCL      9714>>ASSIGN   9833>>ASSIGN
DVALUE.BOUND
       108**DCL       111--REDEF
DVALUE.BOUND.C
       110**DCL      9742>>ASSIGN
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:315  
DVALUE.BOUND.W
       109**DCL      9737>>ASSIGN
DVALUE.FWQ.FLAGS
       122**DCL      9757>>ASSIGN   9808>>ASSIGN
DVALUE.FWQ.WSQ
       123**DCL      9758>>ASSIGN   9809>>ASSIGN
DVALUE.FWR
       114**DCL       121--REDEF
DVALUE.FWR.FLAGS
       115**DCL       116--REDEF    9753>>ASSIGN   9804>>ASSIGN
DVALUE.FWR.FLGS.NOTEMPTY
       118**DCL      9734>>IF       9789>>IF
DVALUE.FWR.WSR
       120**DCL      9754>>ASSIGN   9805>>ASSIGN
DVALUE.SUPER.BASE
       112**DCL      9778>>ASSIGN
DVALUE.SUPER.BOUND
       113**DCL      9792>>ASSIGN
DVALUE.TYPE
       124**DCL      9709>>ASSIGN
DWRD_VAL.RIGHT2
       443**DCL      9918<<ASSIGN   9927<<ASSIGN   9935<<ASSIGN
D_XDELTA
      4284**DCL     10033>>IF      10445>>IF      10478>>IF
EBCDIC_XLATE_TBL.C
       424**DCL      9961>>ASSIGN   9974>>ASSIGN
EDVALUE.IC
       130**DCL      9849>>ASSIGN
EDVALUE.ISEG
       132**DCL      9859>>ASSIGN
EDVALUE.LBASE
       136**DCL      9869>>ASSIGN
EDVALUE.LSIZE
       135**DCL      9876>>ASSIGN
EDVALUE.WSR
       133**DCL      9884>>ASSIGN
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:316  
ERR_VAL.L
       259**DCL     10068>>ASSIGN
ERR_VAL.L.E1
       265**DCL     10066<<ASSIGN
ERR_VAL.L.E2
       267**DCL     10067<<ASSIGN
ERR_VAL.L.F1
       261**DCL     10064<<ASSIGN
ERR_VAL.L.F2
       263**DCL     10065<<ASSIGN
FENTRY#
       297**DCL     10551<<ASSIGN  10556<>CALL    10570<<ASSIGN  10570>>ASSIGN
FENTRY$
       299**DCL     10556<>CALL    10559>>ASSIGN  10570>>ASSIGN
FLOAT
     10923**PROC     9666--CALL     9667--CALL     9673--CALL     9674--CALL    10006--CALL
FMT
       271**DCL      9505<<ASSIGN   9518>>DOCASE   9546>>IF       9575>>DOCASE   9582<<ASSIGN   9591>>IF
      9688<<ASSIGN   9696<<ASSIGN  10091>>IF      10128>>IF      10518>>IF      10842<<ASSIGN  10865>>IF
     10886>>IF
HEXCHARS
       306**DCL     10824>>ASSIGN  10826>>ASSIGN  10888>>ASSIGN
HEX_VAL
       257**DCL     10885>>IF      10886>>IF      10888>>ASSIGN
HOST_CHAR
       147**DCL      9645<<ASSIGN   9647<<ASSIGN   9961>>ASSIGN   9968<<ASSIGN   9970<<ASSIGN   9974>>ASSIGN
HOST_NUCHAR
       226**DCL     10260<<ASSIGN  10262<<ASSIGN  10270>>ASSIGN  10274>>ASSIGN  10315>>ASSIGN  10319>>ASSIGN
     10349>>ASSIGN
HOST_NUCHARS
       225**DCL     10271>>CALLBLT 10275>>CALLBLT 10313>>CALLBLT 10316>>CALLBLT 10320>>CALLBLT 10350>>CALLBLT
     10353>>CALLBLT
HOST_NUVAL
       224**DCL       225--REDEF     226--REDEF     227--REDEF     230--REDEF     231--REDEF     235--REDEF
       239--REDEF     243--REDEF     244--REDEF     248--REDEF     252--REDEF     256--REDEF     257--REDEF
       258--REDEF    9510<<ASSIGN  10063<<ASSIGN  10101<<ASSIGN  10737<<ASSIGN
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:317  
HOST_NUVAL1.HOST_WRD
       233**DCL     10113<<ASSIGN  10755<<ASSIGN
HOST_NUVAL2.HOST_WRD
       237**DCL     10107<<ASSIGN  10749<<ASSIGN
HOST_NUVAL3.HOST_WRD
       241**DCL     10743<<ASSIGN
HOST_VAL
        53**DCL     10101>>ASSIGN  10107>>ASSIGN  10113>>ASSIGN  10523<<ASSIGN  10523>>ASSIGN  10526>>ASSIGN
     10531>>ASSIGN  10737>>ASSIGN  10743>>ASSIGN  10749>>ASSIGN  10755>>ASSIGN
I
       290**DCL      9612<<DOINDEX  9613>>ASSIGN   9613>>ASSIGN   9620<<DOINDEX  9621>>ASSIGN   9644<<DOINDEX
      9645>>ASSIGN   9647>>ASSIGN   9960<<DOINDEX  9961>>ASSIGN   9967<<DOINDEX  9968>>ASSIGN   9970>>ASSIGN
      9973<<DOINDEX  9974>>ASSIGN  10037<<DOINDEX 10038>>IF      10039>>IF      10039>>ASSIGN  10040>>ASSIGN
     10100<<DOINDEX 10101>>ASSIGN  10106<<DOINDEX 10107>>ASSIGN  10112<<DOINDEX 10113>>ASSIGN  10137<<DOINDEX
     10138>>ASSIGN  10143<<DOINDEX 10144>>ASSIGN  10149<<DOINDEX 10150>>ASSIGN  10259<<DOINDEX 10260>>ASSIGN
     10262>>ASSIGN  10332<<DOINDEX 10334>>ASSIGN  10337>>ASSIGN  10340>>ASSIGN  10343>>ASSIGN  10369<<DOINDEX
     10370>>ASSIGN  10383<<DOINDEX 10406<<DOINDEX 10407>>ASSIGN  10513<<DOINDEX 10514>>ASSIGN  10514>>ASSIGN
     10552<<DOINDEX 10553>>ASSIGN  10736<<DOINDEX 10737>>ASSIGN  10742<<DOINDEX 10743>>ASSIGN  10748<<DOINDEX
     10749>>ASSIGN  10754<<DOINDEX 10755>>ASSIGN  10776<<DOINDEX 10777>>ASSIGN  10782<<DOINDEX 10783>>ASSIGN
     10788<<DOINDEX 10789>>ASSIGN  10794<<DOINDEX 10795>>ASSIGN  10823<<DOINDEX 10824>>ASSIGN  10826>>ASSIGN
     10863<<DOINDEX 10864>>IF      10865>>IF      10867>>ASSIGN  10884<<DOINDEX 10885>>IF      10886>>IF
     10888>>ASSIGN  10907<<DOINDEX 10908>>ASSIGN  10909>>ASSIGN
J
       291**DCL      9643<<ASSIGN   9645>>ASSIGN   9646<<ASSIGN   9646>>ASSIGN   9647>>ASSIGN   9648<<ASSIGN
      9648>>ASSIGN   9966<<ASSIGN   9968>>ASSIGN   9969<<ASSIGN   9969>>ASSIGN   9970>>ASSIGN   9971<<ASSIGN
      9971>>ASSIGN  10097<<ASSIGN  10101>>ASSIGN  10102<<ASSIGN  10102>>ASSIGN  10107>>ASSIGN  10108<<ASSIGN
     10108>>ASSIGN  10113>>ASSIGN  10114<<ASSIGN  10114>>ASSIGN  10134<<ASSIGN  10138>>ASSIGN  10139<<ASSIGN
     10139>>ASSIGN  10144>>ASSIGN  10145<<ASSIGN  10145>>ASSIGN  10150>>ASSIGN  10151<<ASSIGN  10151>>ASSIGN
     10258<<ASSIGN  10260>>ASSIGN  10261<<ASSIGN  10261>>ASSIGN  10262>>ASSIGN  10263<<ASSIGN  10263>>ASSIGN
     10331<<ASSIGN  10333>>ASSIGN  10334>>ASSIGN  10335<<ASSIGN  10335>>ASSIGN  10336>>ASSIGN  10337>>ASSIGN
     10338<<ASSIGN  10338>>ASSIGN  10339>>ASSIGN  10340>>ASSIGN  10341<<ASSIGN  10341>>ASSIGN  10342>>ASSIGN
     10343>>ASSIGN  10344<<ASSIGN  10344>>ASSIGN  10554<<DOINDEX 10557>>IF      10733<<ASSIGN  10737>>ASSIGN
     10738<<ASSIGN  10738>>ASSIGN  10743>>ASSIGN  10744<<ASSIGN  10744>>ASSIGN  10749>>ASSIGN  10750<<ASSIGN
     10750>>ASSIGN  10755>>ASSIGN  10756<<ASSIGN  10756>>ASSIGN  10773<<ASSIGN  10777>>ASSIGN  10778<<ASSIGN
     10778>>ASSIGN  10783>>ASSIGN  10784<<ASSIGN  10784>>ASSIGN  10789>>ASSIGN  10790<<ASSIGN  10790>>ASSIGN
     10795>>ASSIGN  10796<<ASSIGN  10796>>ASSIGN
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:318  
J IN PROCEDURE STRETCH
     10902**DCL     10908<<ASSIGN  10910>>ASSIGN
K IN PROCEDURE STRETCH
     10903**DCL     10909<<ASSIGN  10910>>ASSIGN
KVALUE
       145**DCL      9666<>CALL     9673<>CALL    10439>>ASSIGN  10439>>ASSIGN  10939>>ASSIGN
L6TIME_VAL.BITS
       448**DCL     10557>>IF
L6TIME_VAL.R
       447**DCL       448--REDEF
L6_CHAR.L
       199**DCL      9645>>ASSIGN
L6_CHAR.R
       201**DCL      9647>>ASSIGN
L6_DESC.BASE
       179**DCL      9909>>ASSIGN
L6_DESC.EX_PRIV
       183**DCL      9935>>ASSIGN
L6_DESC.RD_PRIV
       181**DCL      9918>>ASSIGN
L6_DESC.SIZE
       185**DCL      9944>>ASSIGN
L6_DESC.VALID
       177**DCL      9901>>IF
L6_DESC.WR_PRIV
       182**DCL      9927>>ASSIGN
L6_EBCHAR.L
       204**DCL      9968>>ASSIGN
L6_EBCHAR.R
       205**DCL      9970>>ASSIGN
L6_EMSG.E1
       211**DCL     10066>>ASSIGN
L6_EMSG.E2
       212**DCL     10067>>ASSIGN
L6_EMSG.F1
       208**DCL     10064>>ASSIGN
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:319  
L6_EMSG.F2
       209**DCL     10065>>ASSIGN
L6_NUVAL
       243**DCL      9613<<ASSIGN   9615>>ASSIGN  10138<<ASSIGN  10514<<ASSIGN  10777<<ASSIGN
L6_NUVAL1.L6_WRD
       246**DCL     10150<<ASSIGN  10795<<ASSIGN
L6_NUVAL2.L6_WRD
       250**DCL     10144<<ASSIGN  10789<<ASSIGN
L6_NUVAL3.L6_WRD
       254**DCL     10783<<ASSIGN
L6_PDEC.L1
       220**DCL     10334>>ASSIGN
L6_PDEC.L2
       221**DCL     10337>>ASSIGN
L6_PDEC.R1
       222**DCL     10340>>ASSIGN
L6_PDEC.R2
       223**DCL     10343>>ASSIGN
L6_PTR.BYTE_NUM
       150**DCL      9592>>IF
L6_PTR.LEFT4
       152**DCL      9585>>ASSIGN   9994>>ASSIGN
L6_PTR.RIGHT16
       154**DCL      9586>>ASSIGN   9995>>ASSIGN
L6_PTR.UNUSED
       151**DCL      9580>>IF
L6_REM.ADDR_LEFT4
       193**DCL     10474>>ASSIGN
L6_REM.ADDR_RIGHT16
       195**DCL     10475>>ASSIGN
L6_REM.AUTO_OFFSET_LEFT4
       189**DCL     10470>>ASSIGN
L6_REM.AUTO_OFFSET_RIGHT16
       191**DCL     10471>>ASSIGN
L6_UPDEC.L
       216**DCL     10260>>ASSIGN
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:320  
L6_UPDEC.R
       217**DCL     10262>>ASSIGN
L6_VAL.BIT16.SIGN
        58**DCL     10512>>IF
L6_VAL.L6_WRD
        56**DCL        57--REDEF    9613>>ASSIGN  10138>>ASSIGN  10144>>ASSIGN  10150>>ASSIGN  10514>>ASSIGN
     10553>>ASSIGN  10589>>ASSIGN  10591>>ASSIGN  10777>>ASSIGN  10783>>ASSIGN  10789>>ASSIGN  10795>>ASSIGN
L6_VECTOR.BD
       167**DCL     10715>>ASSIGN
L6_VECTOR.BYTE_NUM
       169**DCL     10706>>IF
L6_VECTOR.LEFT4
       171**DCL     10700>>ASSIGN
L6_VECTOR.RIGHT16
       173**DCL     10701>>ASSIGN
LEAD0 IN PROCEDURE BIN2HEX
     10880**DCL     10881<<ASSIGN  10885<<ASSIGN  10886>>IF
LEAD0 IN PROCEDURE BIN2OCT
     10859**DCL     10860<<ASSIGN  10864<<ASSIGN  10865>>IF
MAJORCASE
      9518**LABEL    9583--GOTO    10843--GOTO
MYBUF
       428**DCL      9503--ASSIGN   9532>>ASSIGN   9544>>ASSIGN   9559>>ASSIGN   9568>>ASSIGN   9588>>ASSIGN
      9717>>ASSIGN   9740>>ASSIGN   9763<>CALL     9771>>ASSIGN   9781>>ASSIGN   9795>>ASSIGN   9814<>CALL
      9822>>ASSIGN   9836>>ASSIGN   9855>>ASSIGN   9862>>ASSIGN   9872>>ASSIGN   9879>>ASSIGN   9891>>ASSIGN
      9911>>ASSIGN   9920>>ASSIGN   9929>>ASSIGN   9938>>ASSIGN   9946>>ASSIGN  10123>>ASSIGN  10159>>ASSIGN
     10496>>ASSIGN  10533>>ASSIGN  10610>>ASSIGN  10622>>ASSIGN  10633>>ASSIGN  10642>>ASSIGN  10656>>ASSIGN
     10670<>CALL    10703>>ASSIGN  10717>>ASSIGN  10761>>ASSIGN  10801>>ASSIGN  10867<<ASSIGN  10873<<ASSIGN
     10888<<ASSIGN  10894<<ASSIGN  10944<>CALL    10944--CALL    10945<>CALL    10945--CALL    10947>>ASSIGN
MYBUF$
       429**DCL      9503<<ASSIGN   9530<>CALL     9542<>CALL     9557<>CALL     9566<>CALL     9587<>CALL
      9715<>CALL     9738<>CALL     9765>>ASSIGN   9769<>CALL     9779<>CALL     9793<>CALL     9816>>ASSIGN
      9820<>CALL     9834<>CALL     9850<>CALL     9860<>CALL     9870<>CALL     9877<>CALL     9889<>CALL
      9910<>CALL     9919<>CALL     9928<>CALL     9936<>CALL     9945<>CALL    10493<>CALL    10494<>CALL
     10532<>CALL    10558<<ASSIGN  10559<<ASSIGN  10560>>ASSIGN  10561<<ASSIGN  10561>>ASSIGN  10564>>ASSIGN
     10608<>CALL    10620<>CALL    10631<>CALL    10640<>CALL    10654<>CALL    10672>>ASSIGN  10702<>CALL
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:321  
     10716<>CALL
NCHARS
       274**DCL       270--IMP-SIZ  9530<>CALL     9531<>CALL     9532>>ASSIGN   9542<>CALL     9543>>CALL
      9544>>ASSIGN   9545>>ASSIGN   9557<>CALL     9558<>CALL     9559>>ASSIGN   9566<>CALL     9567<>CALL
      9568>>ASSIGN   9587<>CALL     9588>>ASSIGN   9589<>CALL     9633<<ASSIGN   9634>>CALL     9636>>ASSIGN
      9650<<ASSIGN   9651>>ASSIGN   9652<>CALL     9715<>CALL     9716<>CALL     9717>>ASSIGN   9738<>CALL
      9739>>CALL     9740>>ASSIGN   9741>>ASSIGN   9769<>CALL     9770>>CALL     9771>>ASSIGN   9772>>ASSIGN
      9779<>CALL     9780<>CALL     9781>>ASSIGN   9793<>CALL     9794<>CALL     9795>>ASSIGN   9820<>CALL
      9821>>CALL     9822>>ASSIGN   9823>>ASSIGN   9834<>CALL     9835<>CALL     9836>>ASSIGN   9850<>CALL
      9851>>CALL     9855>>ASSIGN   9856>>ASSIGN   9860<>CALL     9861<>CALL     9862>>ASSIGN   9870<>CALL
      9871>>CALL     9872>>ASSIGN   9873>>ASSIGN   9877<>CALL     9878<>CALL     9879>>ASSIGN   9880>>ASSIGN
      9889<>CALL     9890<>CALL     9891>>ASSIGN   9910<>CALL     9911>>ASSIGN   9912<>CALL     9919<>CALL
      9920>>ASSIGN   9921<>CALL     9928<>CALL     9929>>ASSIGN   9930<>CALL     9936<>CALL     9938>>ASSIGN
      9939<>CALL     9945<>CALL     9946>>ASSIGN   9947<>CALL    10026<>CALL    10123>>ASSIGN  10124<>CALL
     10159>>ASSIGN  10160<>CALL    10162<<ASSIGN  10163>>ASSIGN  10164<>CALL    10398<<ASSIGN  10399>>CALL
     10400>>ASSIGN  10401>>ASSIGN  10423<<ASSIGN  10424<>CALL    10425>>ASSIGN  10450<>CALL    10454<>CALL
     10483<>CALL    10487<>CALL    10493<>CALL    10494<>CALL    10495<>CALL    10496>>ASSIGN  10497>>ASSIGN
     10532<>CALL    10533>>ASSIGN  10534<>CALL    10560<<ASSIGN  10564>>ASSIGN  10564>>ASSIGN  10565>>CALL
     10608<>CALL    10609<>CALL    10610>>ASSIGN  10620<>CALL    10621<>CALL    10622>>ASSIGN  10623>>ASSIGN
     10631<>CALL    10632<>CALL    10633>>ASSIGN  10640<>CALL    10641<>CALL    10642>>ASSIGN  10654<>CALL
     10655>>CALL    10656>>ASSIGN  10657>>ASSIGN  10702<>CALL    10703>>ASSIGN  10704<>CALL    10716<>CALL
     10717>>ASSIGN  10718<>CALL    10761>>ASSIGN  10762<>CALL    10801>>ASSIGN  10802<>CALL    10861<<ASSIGN
     10867>>ASSIGN  10868<<ASSIGN  10868>>ASSIGN  10871>>IF      10873>>ASSIGN  10874<<ASSIGN  10874>>ASSIGN
     10882<<ASSIGN  10888>>ASSIGN  10889<<ASSIGN  10889>>ASSIGN  10892>>IF      10894>>ASSIGN  10895<<ASSIGN
     10895>>ASSIGN  10944<>CALL    10945<>CALL    10946<>CALL    10947>>ASSIGN
NEG
       292**DCL      9511<<ASSIGN  10509<<ASSIGN  10512<<ASSIGN  10518>>IF
NO_UDEFS
        51**DCL      9508<<ASSIGN   9509<<ASSIGN  10450<>CALL    10483<>CALL
NUVAL_BITS
       230**DCL     10516>>ASSIGN
NU_SIZE
       272**DCL     10104<<ASSIGN  10110<<ASSIGN  10116<<ASSIGN  10141<<ASSIGN  10147<<ASSIGN  10153<<ASSIGN
     10740<<ASSIGN  10746<<ASSIGN  10752<<ASSIGN  10758<<ASSIGN  10780<<ASSIGN  10786<<ASSIGN  10792<<ASSIGN
     10798<<ASSIGN  10863>>DOINDEX 10884>>DOINDEX
OCTAL
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:322  
     10097**LABEL    9894--GOTO    10005--GOTO    10023--GOTO
OCTCHARS
       304**DCL     10867>>ASSIGN
OCT_VAL
       256**DCL     10864>>IF      10865>>IF      10867>>ASSIGN
OFFSET
       430**DCL     10464<<ASSIGN  10472<<ASSIGN  10493<>CALL    10494<>CALL
ONLY36
     10647**LABEL   10605--GOTO
PCHAR.LEFT5
       228**DCL     10333<<ASSIGN  10336<<ASSIGN  10339<<ASSIGN  10342<<ASSIGN  10348<<ASSIGN
PCHAR.RIGHT4
       229**DCL     10334<<ASSIGN  10337<<ASSIGN  10340<<ASSIGN  10343<<ASSIGN
PFMT
        37**DCL        35--PROC     9505>>ASSIGN
PNO_UDEFS
        47**DCL        35--PROC     9507--IF       9509>>ASSIGN
PNPOINTERS
        48**DCL        35--PROC
PNPOINTERS.FALSE
        50**DCL     10551>>ASSIGN
PNPOINTERS.TRUE
        49**DCL     10550>>ASSIGN
POWER
       427**DCL     10931<>CALL    10934<>CALL    10939<<ASSIGN  10940<>CALL    10943>>IF      10943>>IF
     10944>>CALL    10945>>CALL
PUB
       275**DCL     10173<<ASSIGN  10180>>IF      10249>>IF
PUP
        40**DCL        35--PROC
PUP.PUB
        43**DCL     10173>>ASSIGN
PUP.SCALE
        42**DCL     10174>>ASSIGN
PUP.SIGNOVER
        46**DCL     10176>>ASSIGN
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:323  
PUP.SIGNPOS
        44**DCL     10175>>ASSIGN
PUTDECIMALPT
     10915**PROC    10397--CALL    10422--CALL
PVALUE.B
        75**DCL      9541>>ASSIGN
PVALUE.C
        74**DCL      9534>>ASSIGN
PVALUE.SEG
        76**DCL      9556>>ASSIGN
PVALUE.SEG.D
        78**DCL      9565>>ASSIGN
PVALUE.SEG.S
        77**DCL      9553>>ASSIGN
PVALUE.W
        73**DCL      9529>>ASSIGN
PWRD_VAL.LEFT4
       435**DCL      9585<<ASSIGN   9994<<ASSIGN  10470<<ASSIGN  10474<<ASSIGN  10700<<ASSIGN
PWRD_VAL.RIGHT16
       436**DCL      9586<<ASSIGN   9995<<ASSIGN  10471<<ASSIGN  10475<<ASSIGN  10701<<ASSIGN
REL
     10434**LABEL    9990--GOTO
REL6
     10444**LABEL    9996--GOTO
RVALUE.E
       104**DCL     10465>>ASSIGN
RVALUE.L
       101**DCL       102--REDEF   10466>>ASSIGN
RVALUE.OFFSET
       102**DCL     10464>>ASSIGN
RVALUE.R
       103**DCL       104--REDEF
SAVE_EWSQ#
       450**DCL     10444<<ASSIGN  10451>>ASSIGN  10477<<ASSIGN  10484>>ASSIGN
SCALE
       287**DCL     10174<<ASSIGN  10366>>IF      10382<>CALL    10383>>DOINDEX 10389<<ASSIGN  10389>>ASSIGN
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:324  
     10391>>IF      10398>>ASSIGN  10405>>ASSIGN
SCHAR
       282**DCL     10188<<ASSIGN  10192<<ASSIGN  10196>>CALLBLT 10199>>IF      10199>>IF      10201<<ASSIGN
     10204>>IF      10206<<ASSIGN  10210>>ASSIGN  10213<<ASSIGN  10217<<ASSIGN  10221>>ASSIGN  10270<<ASSIGN
     10274<<ASSIGN  10278>>CALLBLT 10281>>IF      10281>>IF      10283<<ASSIGN  10286>>IF      10288<<ASSIGN
     10292>>ASSIGN  10295<<ASSIGN  10299<<ASSIGN  10303>>ASSIGN
SDIGIT
       283**DCL     10202<<ASSIGN  10207<<ASSIGN  10214<<ASSIGN  10218<<ASSIGN  10223>>ASSIGN  10224>>ASSIGN
     10284<<ASSIGN  10289<<ASSIGN  10296<<ASSIGN  10300<<ASSIGN  10305>>ASSIGN  10306>>ASSIGN
SEGID
       301**DCL      9563>>ASSIGN  10637>>ASSIGN
SIG
       286**DCL     10368<<ASSIGN  10371>>IF      10373<<ASSIGN  10390<<ASSIGN  10393<<ASSIGN  10408>>IF
     10410<<ASSIGN  10416>>IF
SIGNOVER
       285**DCL     10176<<ASSIGN  10183>>IF      10265>>IF
SIGNPOS
       284**DCL     10175<<ASSIGN  10185>>DOCASE  10222>>IF      10226>>DOCASE  10267>>DOCASE  10304>>IF
     10308>>DOCASE  10346>>DOCASE
SINTFMT
     10500**LABEL    9689--GOTO     9697--GOTO
SIZE
        38**DCL        35--PROC     9498>>IF       9528>>IF       9579>>IF       9612>>DOINDEX  9617>>CALL
      9620>>DOINDEX  9633>>ASSIGN   9644>>DOINDEX  9650>>ASSIGN   9665>>IF       9672>>IF       9686<<ASSIGN
      9707>>IF       9707>>IF       9712>>IF       9828>>IF       9864>>IF       9899>>IF       9960>>DOINDEX
      9967>>DOINDEX  9973>>DOINDEX  9992>>IF      10004>>IF      10004>>IF      10004>>IF      10004>>IF
     10006<>CALL    10022>>IF      10035>>IF      10058>>IF      10062>>IF      10091>>IF      10098>>DOCASE
     10100>>DOINDEX 10104>>ASSIGN  10106>>DOINDEX 10110>>ASSIGN  10112>>DOINDEX 10116>>ASSIGN  10128>>IF
     10135>>DOCASE  10137>>DOINDEX 10141>>ASSIGN  10143>>DOINDEX 10147>>ASSIGN  10149>>DOINDEX 10153>>ASSIGN
     10182>>ASSIGN  10251>>IF      10257>>ASSIGN  10324>>IF      10330>>ASSIGN  10434>>IF      10463>>IF
     10468>>IF      10508>>IF      10511>>IF      10513>>DOINDEX 10524>>IF      10529>>IF      10548>>ASSIGN
     10549>>ASSIGN  10581>>IF      10582>>IF      10588>>IF      10590>>IF      10605>>IF      10606>>IF
     10698>>IF      10734>>DOCASE  10736>>DOINDEX 10740>>ASSIGN  10742>>DOINDEX 10746>>ASSIGN  10748>>DOINDEX
     10752>>ASSIGN  10754>>DOINDEX 10758>>ASSIGN  10774>>DOCASE  10776>>DOINDEX 10780>>ASSIGN  10782>>DOINDEX
     10786>>ASSIGN  10788>>DOINDEX 10792>>ASSIGN  10794>>DOINDEX 10798>>ASSIGN  10817>>IF      10818>>ASSIGN
     10819<<ASSIGN  10819>>ASSIGN  10821>>ASSIGN  10906>>ASSIGN
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:325  
SIZE IN PROCEDURE FLOAT
     10924**DCL     10923--PROC    10928>>DOCASE  10936>>IF
SIZED9
       289**DCL     10821<<ASSIGN  10822>>CALL    10823>>DOINDEX
SM1 IN PROCEDURE STRETCH
     10904**DCL     10906<<ASSIGN  10907>>DOINDEX 10908>>ASSIGN
STRETCH
     10900**PROC    10525--CALL    10530--CALL    10583--CALL
S_D.CURRENT_CHANNEL
      3521**DCL      3523--REDEF
S_D.D$
      2659**DCL      9504>>ASSIGN   9533>>ASSIGN   9548<<ASSIGN   9548>>ASSIGN   9564>>ASSIGN   9590>>ASSIGN
      9637>>ASSIGN   9642>>ASSIGN   9653>>ASSIGN   9664>>ASSIGN   9668>>ASSIGN   9671>>ASSIGN   9675>>ASSIGN
      9708>>ASSIGN   9718>>ASSIGN   9725>>ASSIGN   9729>>ASSIGN   9733>>ASSIGN   9750>>ASSIGN   9768>>ASSIGN
      9782>>ASSIGN   9785>>ASSIGN   9788>>ASSIGN   9801>>ASSIGN   9819>>ASSIGN   9827>>ASSIGN   9832>>ASSIGN
      9837>>ASSIGN   9844>>ASSIGN   9858>>ASSIGN   9863>>ASSIGN   9868>>ASSIGN   9875>>ASSIGN   9888>>ASSIGN
      9905>>ASSIGN   9908>>ASSIGN   9913>>ASSIGN   9916>>ASSIGN   9922>>ASSIGN   9925>>ASSIGN   9931>>ASSIGN
      9937>>ASSIGN   9940>>ASSIGN   9943>>ASSIGN   9957>>ASSIGN   9963>>ASSIGN   9976>>ASSIGN  10121>>ASSIGN
     10157>>ASSIGN  10161>>ASSIGN  10359>>ASSIGN  10364>>ASSIGN  10376>>ASSIGN  10381>>ASSIGN  10396>>ASSIGN
     10413>>ASSIGN  10420>>ASSIGN  10450<>CALL    10450>>CALL    10483<>CALL    10483>>CALL    10488>>ASSIGN
     10522>>ASSIGN  10540<<ASSIGN  10543<>CALL    10544>>CALL    10545<<ASSIGN  10562<>CALL    10563>>ASSIGN
     10566>>CALL    10567<<ASSIGN  10611>>ASSIGN  10638>>ASSIGN  10644>>ASSIGN  10647>>ASSIGN  10650>>ASSIGN
     10666>>ASSIGN  10705>>ASSIGN  10711>>ASSIGN  10714>>ASSIGN  10732>>ASSIGN  10763>>ASSIGN  10772>>ASSIGN
     10816>>ASSIGN  10918>>ASSIGN
S_D.DEBUGA
      2673**DCL      2675--REDEF
S_D.DESCL$
      2655**DCL     10450>>CALL    10483>>CALL
S_D.EIS
      3631**DCL      3660--REDEF
S_D.ERROR
      2602**DCL      9494<<ASSIGN   9500<<ASSIGN   9600<<ASSIGN  10008<<ASSIGN  10013<<ASSIGN  10093<<ASSIGN
     10130<<ASSIGN  10253<<ASSIGN  10326<<ASSIGN  10441<<ASSIGN  10834<<ASSIGN  10845<<ASSIGN  10848<<ASSIGN
     10851<<ASSIGN
S_D.EWSQ#
      2598**DCL     10444>>ASSIGN  10447<<ASSIGN  10448<<ASSIGN  10449<<ASSIGN  10451<<ASSIGN  10477>>ASSIGN
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:326  
     10480<<ASSIGN  10481<<ASSIGN  10482<<ASSIGN  10484<<ASSIGN
S_D.HOST_MESSAGE_BUF_REMOTE
      3564**DCL      3565--REDEF    3579--REDEF
S_D.JDE
      3178**DCL      3179--REDEF   10059<<ASSIGN
S_D.JITERR
      3179**DCL     10068<<ASSIGN
S_D.L$.FMT
      2757**DCL     10842>>ASSIGN
S_D.L$.VALUE
      2731**DCL      2737--REDEF    2745--REDEF    2748--REDEF    2751--REDEF    2754--REDEF
S_D.L$.VALUE.L
      2732**DCL      2733--REDEF    2734--REDEF
S_D.L6_MESSAGE_BUF
      3585**DCL      3587--REDEF
S_D.ONE_TO_TWO.EXEC_DOMAIN
      3596**DCL      9489>>IF       9491>>IF       9524>>DOCASE   9610>>IF       9631>>DOCASE   9683>>IF
      9694>>IF       9703>>DOCASE   9958>>DOCASE   9987>>DOCASE  10002>>DOCASE  10020>>DOCASE  10056>>DOCASE
     10087>>DOCASE  10178>>DOCASE  10436>>IF      10438>>IF      10461>>DOCASE  10492>>IF      10506>>DOCASE
     10578>>DOCASE  10601>>DOCASE  10726>>DOCASE  10810>>DOCASE
S_D.OUTPUT
      3551**DCL      3553--REDEF   10540--ASSIGN  10541<<ASSIGN  10542--ASSIGN  10544--CALL    10544--CALL
     10545--ASSIGN  10546<<ASSIGN  10547--CALL    10566--CALL    10566--CALL    10567--ASSIGN
S_D.OVERLAID
      3235**DCL     10452>>IF      10485>>IF
S_D.REMOTE_MSG.FNCC
      3570**DCL      3571--REDEF
S_D.REMOTE_MSG.STXC
      3566**DCL      3567--REDEF
S_D.REMOTE_MSG.SUBFNCC
      3574**DCL      3575--REDEF
S_D.RUM
      3219**DCL     10452>>IF      10485>>IF
S_D.SAVEIC
      2584**DCL     10453<>CALL    10486<>CALL
S_D.SV
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:327  
      2630**DCL      2651--REDEF
S_D$
      3882**DCL      2578--IMP-PTR  9489>>IF       9491>>IF       9494>>ASSIGN   9500>>ASSIGN   9504>>ASSIGN
      9524>>DOCASE   9533>>ASSIGN   9548>>ASSIGN   9548>>ASSIGN   9564>>ASSIGN   9590>>ASSIGN   9600>>ASSIGN
      9610>>IF       9631>>DOCASE   9637>>ASSIGN   9642>>ASSIGN   9653>>ASSIGN   9664>>ASSIGN   9668>>ASSIGN
      9671>>ASSIGN   9675>>ASSIGN   9683>>IF       9694>>IF       9703>>DOCASE   9708>>ASSIGN   9718>>ASSIGN
      9725>>ASSIGN   9729>>ASSIGN   9733>>ASSIGN   9750>>ASSIGN   9768>>ASSIGN   9782>>ASSIGN   9785>>ASSIGN
      9788>>ASSIGN   9801>>ASSIGN   9819>>ASSIGN   9827>>ASSIGN   9832>>ASSIGN   9837>>ASSIGN   9844>>ASSIGN
      9858>>ASSIGN   9863>>ASSIGN   9868>>ASSIGN   9875>>ASSIGN   9888>>ASSIGN   9905>>ASSIGN   9908>>ASSIGN
      9913>>ASSIGN   9916>>ASSIGN   9922>>ASSIGN   9925>>ASSIGN   9931>>ASSIGN   9937>>ASSIGN   9940>>ASSIGN
      9943>>ASSIGN   9957>>ASSIGN   9958>>DOCASE   9963>>ASSIGN   9976>>ASSIGN   9987>>DOCASE  10002>>DOCASE
     10008>>ASSIGN  10013>>ASSIGN  10020>>DOCASE  10056>>DOCASE  10059>>ASSIGN  10068>>ASSIGN  10087>>DOCASE
     10093>>ASSIGN  10121>>ASSIGN  10130>>ASSIGN  10157>>ASSIGN  10161>>ASSIGN  10178>>DOCASE  10253>>ASSIGN
     10326>>ASSIGN  10359>>ASSIGN  10364>>ASSIGN  10376>>ASSIGN  10381>>ASSIGN  10396>>ASSIGN  10413>>ASSIGN
     10420>>ASSIGN  10436>>IF      10438>>IF      10441>>ASSIGN  10444>>ASSIGN  10447>>ASSIGN  10448>>ASSIGN
     10449>>ASSIGN  10450>>CALL    10450>>CALL    10450>>CALL    10451>>ASSIGN  10452>>IF      10452>>IF
     10453>>CALL    10461>>DOCASE  10477>>ASSIGN  10480>>ASSIGN  10481>>ASSIGN  10482>>ASSIGN  10483>>CALL
     10483>>CALL    10483>>CALL    10484>>ASSIGN  10485>>IF      10485>>IF      10486>>CALL    10488>>ASSIGN
     10492>>IF      10506>>DOCASE  10522>>ASSIGN  10540>>ASSIGN  10540>>ASSIGN  10541>>ASSIGN  10543>>CALL
     10544>>CALL    10544>>CALL    10544>>CALL    10545>>ASSIGN  10545>>ASSIGN  10546>>ASSIGN  10547>>CALL
     10562>>CALL    10563>>ASSIGN  10566>>CALL    10566>>CALL    10566>>CALL    10567>>ASSIGN  10567>>ASSIGN
     10578>>DOCASE  10601>>DOCASE  10611>>ASSIGN  10638>>ASSIGN  10644>>ASSIGN  10647>>ASSIGN  10650>>ASSIGN
     10666>>ASSIGN  10705>>ASSIGN  10711>>ASSIGN  10714>>ASSIGN  10726>>DOCASE  10732>>ASSIGN  10763>>ASSIGN
     10772>>ASSIGN  10810>>DOCASE  10816>>ASSIGN  10834>>ASSIGN  10842>>ASSIGN  10845>>ASSIGN  10848>>ASSIGN
     10851>>ASSIGN  10918>>ASSIGN
TEMP
       280**DCL     10196<<CALLBLT 10197>>IF      10210<<ASSIGN  10211>>IF      10214>>ASSIGN  10218>>ASSIGN
     10278<<CALLBLT 10279>>IF      10292<<ASSIGN  10293>>IF      10296>>ASSIGN  10300>>ASSIGN  10405<<ASSIGN
     10406>>DOINDEX 10423>>ASSIGN  10425>>ASSIGN  10542<<ASSIGN  10543<>CALL    10549<<ASSIGN  10562<>CALL
     10568<<ASSIGN  10568>>ASSIGN
TENTRY#
       296**DCL     10550<<ASSIGN  10555<>CALL    10569<<ASSIGN  10569>>ASSIGN
TENTRY$
       298**DCL     10555<>CALL    10558>>ASSIGN  10569>>ASSIGN
TEXT$
       449**DCL      9504<<ASSIGN   9532>>ASSIGN   9533<<ASSIGN   9536>>ASSIGN   9537<<ASSIGN   9537>>ASSIGN
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:328  
      9538>>CALLBLT  9539>>ASSIGN   9540<<ASSIGN   9540>>ASSIGN   9544>>ASSIGN   9545<<ASSIGN   9545>>ASSIGN
      9551>>ASSIGN   9552<<ASSIGN   9552>>ASSIGN   9559>>ASSIGN   9563>>ASSIGN   9564<<ASSIGN   9568>>ASSIGN
      9588>>ASSIGN   9590<<ASSIGN   9594>>ASSIGN   9618>>ASSIGN   9619<<ASSIGN   9619>>ASSIGN   9621>>ASSIGN
      9622<<ASSIGN   9622>>ASSIGN   9624>>ASSIGN   9635>>ASSIGN   9636>>ASSIGN   9640>>ASSIGN   9642<<ASSIGN
      9651>>ASSIGN   9653<<ASSIGN   9654>>ASSIGN   9663>>ASSIGN   9664<<ASSIGN   9668<<ASSIGN   9670>>ASSIGN
      9671<<ASSIGN   9675<<ASSIGN   9677>>ASSIGN   9708<<ASSIGN   9717>>ASSIGN   9718<<ASSIGN   9723>>ASSIGN
      9724>>CALLBLT  9725<<ASSIGN   9728>>ASSIGN   9729<<ASSIGN   9732>>ASSIGN   9733<<ASSIGN   9740>>ASSIGN
      9741<<ASSIGN   9741>>ASSIGN   9743>>ASSIGN   9744>>CALLBLT  9748>>ASSIGN   9750<<ASSIGN   9762>>ASSIGN
      9764<<ASSIGN   9764>>ASSIGN   9765>>ASSIGN   9766<<ASSIGN   9766>>ASSIGN   9767>>ASSIGN   9768<<ASSIGN
      9771>>ASSIGN   9772<<ASSIGN   9772>>ASSIGN   9773>>ASSIGN   9774<<ASSIGN   9774>>ASSIGN   9775>>CALLBLT
      9781>>ASSIGN   9782<<ASSIGN   9784>>ASSIGN   9785<<ASSIGN   9787>>ASSIGN   9788<<ASSIGN   9795>>ASSIGN
      9799>>ASSIGN   9801<<ASSIGN   9813>>ASSIGN   9815<<ASSIGN   9815>>ASSIGN   9816>>ASSIGN   9817<<ASSIGN
      9817>>ASSIGN   9818>>ASSIGN   9819<<ASSIGN   9822>>ASSIGN   9823<<ASSIGN   9823>>ASSIGN   9824>>ASSIGN
      9825<<ASSIGN   9825>>ASSIGN   9826>>CALLBLT  9827<<ASSIGN   9831>>ASSIGN   9832<<ASSIGN   9836>>ASSIGN
      9837<<ASSIGN   9842>>ASSIGN   9843>>CALLBLT  9844<<ASSIGN   9853>>ASSIGN   9854<<ASSIGN   9854>>ASSIGN
      9855>>ASSIGN   9856<<ASSIGN   9856>>ASSIGN   9857>>ASSIGN   9858<<ASSIGN   9862>>ASSIGN   9863<<ASSIGN
      9867>>ASSIGN   9868<<ASSIGN   9872>>ASSIGN   9873<<ASSIGN   9873>>ASSIGN   9874>>ASSIGN   9875<<ASSIGN
      9879>>ASSIGN   9880<<ASSIGN   9880>>ASSIGN   9883>>ASSIGN   9885<<ASSIGN   9885>>ASSIGN   9886>>CALLBLT
      9887>>ASSIGN   9888<<ASSIGN   9891>>ASSIGN   9902>>ASSIGN   9903>>ASSIGN   9905<<ASSIGN   9906>>ASSIGN
      9908<<ASSIGN   9911>>ASSIGN   9913<<ASSIGN   9914>>ASSIGN   9916<<ASSIGN   9920>>ASSIGN   9922<<ASSIGN
      9923>>ASSIGN   9925<<ASSIGN   9929>>ASSIGN   9931<<ASSIGN   9932>>ASSIGN   9937<<ASSIGN   9938>>ASSIGN
      9940<<ASSIGN   9941>>ASSIGN   9943<<ASSIGN   9946>>ASSIGN   9955>>ASSIGN   9957<<ASSIGN   9961>>ASSIGN
      9963<<ASSIGN   9974>>ASSIGN   9976<<ASSIGN   9979>>ASSIGN  10038>>ASSIGN  10039>>ASSIGN  10040>>ASSIGN
     10041<<ASSIGN  10041>>ASSIGN  10044>>ASSIGN  10045<<ASSIGN  10045>>ASSIGN  10048>>ASSIGN  10049<<ASSIGN
     10049>>ASSIGN  10051>>CALLBLT 10052<<ASSIGN  10052>>ASSIGN  10053>>ASSIGN  10054>>CALLBLT 10079>>ASSIGN
     10080>>ASSIGN  10119>>ASSIGN  10121<<ASSIGN  10123>>ASSIGN  10155>>ASSIGN  10157<<ASSIGN  10159>>ASSIGN
     10161<<ASSIGN  10163>>ASSIGN  10359<<ASSIGN  10362>>ASSIGN  10364<<ASSIGN  10374>>ASSIGN  10376<<ASSIGN
     10379>>ASSIGN  10381<<ASSIGN  10384>>ASSIGN  10385<<ASSIGN  10385>>ASSIGN  10394>>ASSIGN  10396<<ASSIGN
     10400>>ASSIGN  10401<<ASSIGN  10401>>ASSIGN  10402>>ASSIGN  10411>>ASSIGN  10413<<ASSIGN  10418>>ASSIGN
     10420<<ASSIGN  10425>>ASSIGN  10488<<ASSIGN  10490>>ASSIGN  10491<<ASSIGN  10491>>ASSIGN  10496>>ASSIGN
     10497<<ASSIGN  10497>>ASSIGN  10498>>ASSIGN  10520>>ASSIGN  10522<<ASSIGN  10533>>ASSIGN  10563<<ASSIGN
     10564>>ASSIGN  10586>>CALL    10593>>CALL    10610>>ASSIGN  10611<<ASSIGN  10614>>ASSIGN  10615<<ASSIGN
     10615>>ASSIGN  10616>>CALLBLT 10617>>ASSIGN  10618<<ASSIGN  10618>>ASSIGN  10622>>ASSIGN  10623<<ASSIGN
     10623>>ASSIGN  10624>>ASSIGN  10625<<ASSIGN  10625>>ASSIGN  10633>>ASSIGN  10637>>ASSIGN  10638<<ASSIGN
     10642>>ASSIGN  10644<<ASSIGN  10646>>ASSIGN  10647<<ASSIGN  10649>>ASSIGN  10650<<ASSIGN  10656>>ASSIGN
     10657<<ASSIGN  10657>>ASSIGN  10659>>ASSIGN  10660>>CALLBLT 10664>>ASSIGN  10666<<ASSIGN  10669>>ASSIGN
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:329  
     10671<<ASSIGN  10671>>ASSIGN  10672>>ASSIGN  10673<<ASSIGN  10673>>ASSIGN  10674>>ASSIGN  10675<<ASSIGN
     10675>>ASSIGN  10679>>ASSIGN  10680<<ASSIGN  10680>>ASSIGN  10683>>ASSIGN  10684<<ASSIGN  10684>>ASSIGN
     10687>>ASSIGN  10688<<ASSIGN  10688>>ASSIGN  10691>>ASSIGN  10692<<ASSIGN  10692>>ASSIGN  10703>>ASSIGN
     10705<<ASSIGN  10708>>ASSIGN  10711<<ASSIGN  10712>>ASSIGN  10714<<ASSIGN  10717>>ASSIGN  10731>>ASSIGN
     10732<<ASSIGN  10761>>ASSIGN  10763<<ASSIGN  10764>>ASSIGN  10771>>ASSIGN  10772<<ASSIGN  10801>>ASSIGN
     10815>>ASSIGN  10816<<ASSIGN  10824>>ASSIGN  10825<<ASSIGN  10825>>ASSIGN  10826>>ASSIGN  10827<<ASSIGN
     10827>>ASSIGN  10829>>ASSIGN  10916>>ASSIGN  10918<<ASSIGN  10947>>ASSIGN
TEXTR
       270**DCL      9532<<ASSIGN   9544<<ASSIGN   9559<<ASSIGN   9568<<ASSIGN   9588<<ASSIGN   9636<<ASSIGN
      9651<<ASSIGN   9717<<ASSIGN   9740<<ASSIGN   9771<<ASSIGN   9781<<ASSIGN   9795<<ASSIGN   9822<<ASSIGN
      9836<<ASSIGN   9855<<ASSIGN   9862<<ASSIGN   9872<<ASSIGN   9879<<ASSIGN   9891<<ASSIGN   9911<<ASSIGN
      9920<<ASSIGN   9929<<ASSIGN   9938<<ASSIGN   9946<<ASSIGN  10123<<ASSIGN  10159<<ASSIGN  10163<<ASSIGN
     10400<<ASSIGN  10425<<ASSIGN  10496<<ASSIGN  10533<<ASSIGN  10564<<ASSIGN  10564>>ASSIGN  10610<<ASSIGN
     10622<<ASSIGN  10633<<ASSIGN  10642<<ASSIGN  10656<<ASSIGN  10703<<ASSIGN  10717<<ASSIGN  10761<<ASSIGN
     10801<<ASSIGN  10947<<ASSIGN
TYPE
       295**DCL      9709<<ASSIGN   9710>>DOCASE   9734>>IF       9734>>IF       9751>>DOCASE   9775>>CALLBLT
      9789>>IF       9802>>DOCASE   9826>>CALLBLT  9889<>CALL    10676<<ASSIGN  10677>>DOCASE
U$SE.TYPE
      5879**DCL     10446>>IF      10479>>IF
UBIN9
       466**DCL     10039<<ASSIGN  10040<<ASSIGN
UNSIGNED1
     10224**LABEL   10198--GOTO
UNSIGNED2
     10306**LABEL   10280--GOTO
USE$
      4285**DCL      5877--IMP-PTR 10446>>IF      10479>>IF
VAL
       431**DCL       432--REDEF     433--REDEF     437--REDEF     441--REDEF     444--REDEF    9529<<ASSIGN
      9530<>CALL     9534<<ASSIGN   9538>>CALLBLT  9541<<ASSIGN   9542<>CALL     9553<<ASSIGN   9554>>IF
      9556<<ASSIGN   9557<>CALL     9563>>ASSIGN   9565<<ASSIGN   9566<>CALL     9574<<ASSIGN   9587<>CALL
      9714<<ASSIGN   9715<>CALL     9719<<ASSIGN   9720>>IF       9724>>CALLBLT  9737<<ASSIGN   9738<>CALL
      9742<<ASSIGN   9744>>CALLBLT  9753<<ASSIGN   9757<<ASSIGN   9763<>CALL     9778<<ASSIGN   9779<>CALL
      9792<<ASSIGN   9793<>CALL     9804<<ASSIGN   9808<<ASSIGN   9814<>CALL     9833<<ASSIGN   9834<>CALL
      9838<<ASSIGN   9839>>IF       9843>>CALLBLT  9849<<ASSIGN   9850<>CALL     9859<<ASSIGN   9860<>CALL
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:330  
      9869<<ASSIGN   9870<>CALL     9876<<ASSIGN   9877<>CALL     9884<<ASSIGN   9886>>CALLBLT  9900<<ASSIGN
      9909<<ASSIGN   9910<>CALL     9917<<ASSIGN   9919<>CALL     9926<<ASSIGN   9928<>CALL     9934<<ASSIGN
      9936<>CALL     9944<<ASSIGN   9945<>CALL     9993<<ASSIGN  10437<<ASSIGN  10439<<ASSIGN  10450<>CALL
     10466<<ASSIGN  10469<<ASSIGN  10472>>ASSIGN  10473<<ASSIGN  10483<>CALL    10527<<ASSIGN  10527>>ASSIGN
     10532<>CALL    10553<<ASSIGN  10584<<ASSIGN  10586<>CALL    10589<<ASSIGN  10591<<ASSIGN  10591>>ASSIGN
     10593<>CALL    10607<<ASSIGN  10608<>CALL    10612<<ASSIGN  10616>>CALLBLT 10619<<ASSIGN  10620<>CALL
     10627<<ASSIGN  10628>>IF      10630<<ASSIGN  10631<>CALL    10637>>ASSIGN  10639<<ASSIGN  10640<>CALL
     10653<<ASSIGN  10654<>CALL    10658<<ASSIGN  10660>>CALLBLT 10667<<ASSIGN  10670<>CALL    10699<<ASSIGN
     10702<>CALL    10715<<ASSIGN  10716<>CALL    10905<<ASSIGN
VALBITS
       432**DCL     10526<<ASSIGN  10531<<ASSIGN  10910<<ASSIGN
VALUE
        61**DCL     10006<>CALL
VALUE.CODE.ERROR
        68**DCL     10051>>CALLBLT
VALUE.CODE.FCG
        66**DCL     10038>>IF      10039>>IF      10039>>ASSIGN  10040>>ASSIGN
VALUE.CODE.MON
        67**DCL     10043>>IF
VALUE.CODE.SEV
        69**DCL     10054>>CALLBLT
VALUE.E
        63**DCL      9989>>ASSIGN
VALUE.L
        62**DCL        63--REDEF      64--REDEF      65--REDEF    9685<>CALL     9695<>CALL     9989<<ASSIGN
     10024<>CALL    10059>>ASSIGN  10437>>ASSIGN  10465<<ASSIGN  10584>>ASSIGN
VALUE IN PROCEDURE FLOAT
     10925**DCL     10923--PROC    10931<>CALL    10934<>CALL    10940<>CALL
VALUEP
        39**DCL        35--PROC     9506>>ASSIGN
VALW
       293**DCL      9754<<ASSIGN   9758<<ASSIGN   9769<>CALL     9805<<ASSIGN   9809<<ASSIGN   9820<>CALL
VALWC
       294**DCL      9755<<ASSIGN   9759<<ASSIGN   9767>>ASSIGN   9806<<ASSIGN   9810<<ASSIGN   9818>>ASSIGN
VBITS
       106**DCL      9615<<ASSIGN   9621>>ASSIGN  10078>>IF      10509>>IF      10516<<ASSIGN  10910>>ASSIGN
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:331  
VVALUE.W1.BOUND.C
        84**DCL     10658>>ASSIGN
VVALUE.W1.BOUND.W
        83**DCL     10653>>ASSIGN
VVALUE.W1.FLAGS
        85**DCL        86--REDEF   10667>>ASSIGN
VVALUE.W1.FLGS.NOTEMPTY
        88**DCL     10651>>IF
VVALUE.W1.TYPE
        90**DCL     10676>>ASSIGN
VVALUE.W2.B
        95**DCL     10619>>ASSIGN
VVALUE.W2.C
        94**DCL     10612>>ASSIGN
VVALUE.W2.SEG
        96**DCL     10630>>ASSIGN
VVALUE.W2.SEG.D
        98**DCL     10639>>ASSIGN
VVALUE.W2.SEG.S
        97**DCL     10627>>ASSIGN
VVALUE.W2.W
        93**DCL     10607>>ASSIGN
WRD_SIZE
       273**DCL      9490<<ASSIGN   9492<<ASSIGN   9498>>IF      10508>>IF      10548<<ASSIGN  10552>>DOINDEX
WRONG_SIZE
     10848**LABEL    9528--GOTO     9579--GOTO     9707--GOTO     9899--GOTO     9992--GOTO    10035--GOTO
     10058--GOTO    10062--GOTO    10435--GOTO    10463--GOTO    10468--GOTO    10508--GOTO    10511--GOTO
     10581--GOTO    10588--GOTO    10606--GOTO    10698--GOTO
XPN_7AQTOLSP
      9483**DCL-ENT 10940--CALL
XPN_7DTOLSP
      9482**DCL-ENT 10934--CALL
XPN_7ELJE1
      9485**DCL-ENT 10945--CALL
XPN_7FLJ
      9484**DCL-ENT 10944--CALL
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:332  
XPN_7RTOLSP
      9481**DCL-ENT 10931--CALL
XVAL.L
       141**DCL     10824>>ASSIGN
XVAL.R
       142**DCL     10826>>ASSIGN
ZERO
       279**DCL     10177>>ASSIGN  10400>>ASSIGN
ZEROES
       278**DCL       279--REDEF
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:333  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDA$DISPFMT File=DDA$DISPFMT.:E05TSI                          TUE 07/29/97 13:21 Page:334  
              MINI UREF LISTING

AWRD_VAL     437**DCL
B_POINTER     364**DCL-ENT
CHAR8     459**DCL
DDA$DISPFMT      35**PROC
DDA$DISPUI    9467**DCL-ENT
HVAL     143**DCL
L6_AR     156**DCL
MODIFY$CMD    5590**DCL
SDD$     572**DCL
SDD_L6$     574**DCL
ZITEM$     573**DCL
ZITEM_L6$     575**DCL
