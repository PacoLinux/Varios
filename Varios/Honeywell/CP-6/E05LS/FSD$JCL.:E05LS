VERSION E05

PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:1    
        1        1        /*M* FSD$JCL Handle Read/Write PMME's for control command files */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* CLM=8,ICP,MOC,DMR */
        8        8        /*P*    NAME: FSD$JCL
        9        9         *      PURPOSE: FSD$JCL manages user interactions with control command
       10       10         *         files.  It contains four submodules:
       11       11         *            FSD$C1 handles control command reads.  It is called for
       12       12         *         user M$READ PMME's; its entry FSD$C1OPEN is called for
       13       13         *         user M$OPEN PMME's.
       14       14         *            FSD$JE handles control command file creation.  It is
       15       15         *         called for user M$WRITE PMME's to JE and JF.
       16       16         *            FSD$JEOPEN opens batch job files.  It is called for user
       17       17         *         M$OPEN PMME's to JE (Batching a job).
       18       18         *            FSD$JFOPEN opens XEQ files.  It is called for user M$OPEN
       19       19         *         PMME's to JF (Building an XEQ file).
       20       20         */
       21       21        /*F*    NAME: FSD$C1
       22       22         *      PURPOSE: FSD$C1 handles user M$READ PMME's which read control
       23       23         *         command files.  User DCB's for such reads are always
       24       24         *         connected to the control stream CR01; their user-visible
       25       25         *         assignments are to various device oplabels.
       26       26         *      DESCRIPTION:   The user DCB is always streamed to a "secret"
       27       27         *         DCB which is open to a control command file in the input
       28       28         *         symbiont account (:SYMI).  FSD$C1 peeks at the device byte
       29       29         *         (DVBYTE) of the next record in the file; if the record is
       30       30         *         a control command and it is not the command processor
       31       31         *         reading, an EOF condition is returned.  Otherwise, the next
       32       32         *         record is read into the user's buffer.  If the record is
       33       33         *         a !EOD record, an EOD condition is returned.
       34       34         *            If the record just read is the last record in the file,
       35       35         *         the control command place is switched to be the saved
       36       36         *         control command place which was preserved in the FIT of the
       37       37         *         file, and the file is deleted.
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:2    
       38       38         *            If the switched-to place is not another control command
       39       39         *         file (i.e., it is M$UC), all user DCB's which point to the
       40       40         *         "secret" DCB are marked closed (the next user PMME will
       41       41         *         reopen them to be streamed to M$UC) and the secret DCB's
       42       42         *         ROSEG space is freed.
       43       43         */
       44       44        /*D*    NAME: FSD$C1
       45       45         *      CALL: CALL FSD$C1(FPTCODE) ALTRET;
       46       46         *      INTERFACE:  FMH$LOOKAHD, FMH$CPMME, FSB$C1EOF.
       47       47         *
       48       48         *
       49       49         *
       50       50         *      ENVIRONMENT: Monitor (for user) LS.
       51       51         *      INPUT:   DCB (B$JIT.DCB$).
       52       52         *
       53       53         *      OUTPUT:  DCB.ARS, DCB.DVBYTE, JIT.ERR modified.
       54       54         *
       55       55         */
       56       56        FSD$C1: PROC ALTRET;
       57       57        /**/
       58       58    1   DCL FMH$LOOKAHD ENTRY ALTRET; /* Look ahead to next record's DVBYTE */
       59       59    1   DCL FMH$CPMME ENTRY(3) ALTRET; /* Perform PMME to Consec file        */
       60       60    1   DCL FMO$GETDOMAIN ENTRY(1); /* Get domain (WSR) of PMME'er        */
       61       61    1   DCL FMN$GETFIT ENTRY(2)ALTRET; /* Read FIT granule of file           */
       62       62    1   DCL FSD$C1GETDCB ENTRY ALTRET;
       63       63    1   DCL FMO$LOCCODP ENTRY(2)ALTRET; /* Find entry in FIT                  */
       64       64    1   DCL FMP$CLSF ENTRY(1); /* Close a file                       */
       65       65    1   DCL FSA$FDCB ENTRY(1); /* Free a DCB's ROSEG space */
       66       66    1   DCL FMM$DFLOPNP ENTRY; /* Default Privileged open of DCB */
       67       67    1   DCL FMH$PREC ENTRY(1)ALTRET; /* Internal entry to position file    */
       68       68    1   DCL FSA$GSP ENTRY(2)ALTRET; /* Get ROSEG space                    */
       69       69    1   DCL HFF$NILERASE ENTRY (1) ALTRET; /* Is vector NIL/ERASE? */
       70       70        /**/
       71       71    1   DCL B$JIT$ PTR SYMREF; /* NOTE: JIT is BASED (B$JIT$).       */
       72       72    1   DCL B$ROSEG$ PTR SYMREF;
       73       73    1   DCL B$PS0$ PTR SYMREF;
       74       74        %INCLUDE B$JIT_C;
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:3    
       75      388        %B$JIT0;
       76      477        %U$JIT1;
       77      551        %M$JIT2X;
       78      554        %F$JIT3;
       79      559        %S$JIT4X;
       80      562        %J$JIT5X;
       81      565        %A$JIT6X;
       82      568        %MACRO B$ROSEG(BASED=BASED);
       83      569        %INCLUDE B$ROSEG;
       84      632        %MEND;
       85      633        %B$ROSEG(BASED="BASED(B$ROSEG$)");
       86      693        %INCLUDE B_STRINGS_C;
       87      822        %INCLUDE F_ERRORS_C;
       88     1062        %INCLUDE F$DCB;
       89     1111        %INCLUDE F_FPTCODE_C;
       90     1147        %INCLUDE F_CP6;
       91     2172        %INCLUDE F$CP6V_C;
       92     2398        %INCLUDE CP_6_SUBS;
       93     2938        %INCLUDE F_FMTCODE_C;
       94     2972        %INCLUDE FS$FIT;
       95     3015        /**/
       96     3016        %FPT_READ(FPTN=MYFPT,STCLASS=CONSTANT,WAIT=YES);
       97     3055        %FPT_CLOSE(FPTN=MYPN$,PFMT=PTR,VECTOR=ADDR,STCLASS=CONSTANT,
       98     3056                   DISP=SCRATCH);
       99     3098        %FPT$XFLUSH_V (BASED = "BASED (B$PS0$)");
      100     3101        %SUB FCG#="'0623'O";
      101     3102        %SUB MID#="'04'O";
      102     3103        %INCLUDE FM$MACROS;
      103     3478        %FM$GRAN;
      104     3482        %ERRCODE(NAME=ERR$EOF,COD#=%E$EOF);
      105     3486        /*E*    ERROR:   FSD-E$EOF-2
      106     3487                MESSAGE: End of File.
      107     3488                MESSAGE1: End of File; you tried to read a control command.
      108     3489         */
      109     3490        /**** * * * * ****/
      110     3491    1   DCL JDCB$ PTR; /* Holds address of user DCB          */
      111     3492    1   DCL C1DCB$ PTR; /* Holds address of secret CR01 DCB   */
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:4    
      112     3493    1   DCL WSR UBIN; /* Holds domain of caller             */
      113     3494    1   DCL MYERROR BIT(36);
      114     3495    1   DCL FIT$ PTR;
      115     3496    1   DCL J SBIN;
      116     3497    1   DCL HIDEYHOLE BIT(36);
      117     3498    1   DCL 1 UATTRWORDS BASED, /* C1 POSN WORDS IN UATTR             */
      118     3499    1         2 *(0:1)SBIN;
      119     3500        %FS$XEQSAVE(STCLASS=);
      120     3503        %EJECT;
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:5    
      121     3504    1           JDCB$=B$JIT.DCB$;
      122     3505    1           C1DCB$=PINCRW(B$ROSEG$,B$ROSEG.CR01DCB);
      123     3506    1           B$JIT.DCB$=C1DCB$;
      124     3507    2           IF C1DCB$->F$DCB.IASN~=%FILE# THEN DO;
      125     3508    2   PREREADLOOKMORE:;
      126     3509    2              CALL OPENDCB ALTRET(ERROR_CR01);
      127     3510    2              CALL LOOKAHEAD ALTRET(ERROR_CR01);
      128     3511    2              IF J=4 THEN CALL ENDJLOOK ALTRET(ERROR_CR01);
      129     3512    3              DO CASE(J);
      130     3513    3               CASE(0); /* GOT RECORD                         */
      131     3514    3               CASE(1); /* NEW FILE                           */
      132     3515    3                 GOTO PREREADLOOKMORE;
      133     3516    3               CASE(2,3); /* M$UC OR ERROR                      */
      134     3517    3                 GOTO ERROR_CR01;
      135     3518    3               END;
      136     3519    2              END;
      137     3520    1           JDCB$->F$DCB.DDEV=(JDCB$->F$DCB.DDEV&~(%DDEV_IC#|%DDEV_XEQ#))
      138     3521    1             |(C1DCB$->F$DCB.DDEV&(%DDEV_XEQ#));
      139     3522    2           IF C1DCB$->F$DCB.DVBYTE & %DVBYTE_NODAT# THEN DO;
      140     3523    2              CALL FMO$GETDOMAIN(WSR);
      141     3524    3              IF WSR~=%CPWSR/*%CPWSR*/ THEN DO;
      142     3525    3                 MYERROR=ERR$EOF;
      143     3526    3                 GOTO USERRET;
      144     3527    3                 END;
      145     3528    2              END;
      146     3529    1           C1DCB$->F$DCB.UB$=JDCB$->F$DCB.UB$;
      147     3530    1           C1DCB$->F$DCB.UBYTES=JDCB$->F$DCB.UBYTES;
      148     3531    1           B$ROSEG.CR01ID.POSN=
      149     3532    1             B$ROSEG.CR01ID.POSN+1;
      150     3533    1           CALL FMH$CPMME(FPTREAD,MYFPT.V)ALTRET(USERERR);
      151     3534    1           B$JIT.ERR='0'B;
      152     3535    2           IF C1DCB$->F$DCB.DVBYTE & %DVBYTE_DCBHDR# THEN DO;
      153     3536    2              B$JIT.ERR=ERR$EOF;
      154     3537    2              JDCB$->F$DCB.TYC.EOD(JDCB$->F$DCB.WAIT)='1'B;
      155     3538    2              END;
      156     3539    1   USERERR:;
      157     3540    1           MYERROR= B$JIT.ERR;
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:6    
      158     3541    1           JDCB$->F$DCB.TYC(JDCB$->F$DCB.WAIT)=
      159     3542    1             JDCB$->F$DCB.TYC(JDCB$->F$DCB.WAIT)|C1DCB$->F$DCB.TYC(1);
      160     3543    1           JDCB$->F$DCB.ARS= C1DCB$->F$DCB.ARS;
      161     3544    1           JDCB$->F$DCB.DVBYTE= C1DCB$->F$DCB.DVBYTE;
      162     3545    1           JDCB$->F$DCB.EOMCHAR= C1DCB$->F$DCB.EOMCHAR;
      163     3546    1           CALL LOOKAHEAD ALTRET(ERROR_CR01);
      164     3547    2           DO CASE(J);
      165     3548    2            CASE(0); /* MORE IN FILE; DO NOTHING.*/
      166     3549    2            CASE(2); /* END OF BATCH JCL; SET TOP FLAG.*/
      167     3550    2              JDCB$->F$DCB.DVBYTE.TOP='1'B;
      168     3551    2            CASE(4); /*OFF END OF XEQ*/
      169     3552    2              HIDEYHOLE=B$ROSEG.CR01ID;
      170     3553    2              B$ROSEG.CR01ID=FS$XEQSAVE.CR01ID;
      171     3554    2              B$JIT.NEXTCC=B$ROSEG.CR01ID.NOWIS;
      172     3555    2              B$ROSEG.CR01ID=HIDEYHOLE;
      173     3556    2              B$ROSEG.CR01ID.NOWIS=%CC_FROMXEQEND#;
      174     3557    2              JDCB$->F$DCB.DVBYTE.TOP='1'B;
      175     3558    2            END;
      176     3559    1   USERRET:;
      177     3560    1           B$JIT.DCB$=JDCB$;
      178     3561    1           IF NOT MYERROR THEN RETURN;
      179     3562    1           B$JIT.ERR=MYERROR;
      180     3563    1           ALTRETURN;
      181     3564        /**/
      182     3565    1   FSD$C1END: ENTRY ALTRET;
      183     3566    1           JDCB$=B$JIT.DCB$;
      184     3567    1           C1DCB$=PINCRW(B$ROSEG$,B$ROSEG.CR01DCB);
      185     3568    1           B$JIT.DCB$=C1DCB$;
      186     3569    1           CALL ENDJLOOK ALTRET(ERROR_CR01);
      187     3570    1           MYERROR='0'B;
      188     3571    1           GOTO USERRET;
      189     3572        /**/
      190     3573    1   ERROR_CR01:;
      191     3574    1           MYERROR=B$JIT.ERR;
      192     3575    2           IF C1DCB$~=ADDR(NIL) THEN DO;
      193     3576    2              IF C1DCB$->F$DCB.IASN=%FILE# THEN
      194     3577    2                 CALL FMP$CLSF(MYPN$);
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:7    
      195     3578    3              IF C1DCB$~=DCBADDR(%M$UC#) THEN DO;
      196     3579    3                 J = B$ROSEG.NUMDCBS;
      197     3580    4                 DO WHILE (J >= %M$MAXNEG#);
      198     3581    4                    IF DCBADDR(J) ~= ADDR(NIL)
      199     3582    4                    THEN
      200     3583    4                       IF DCBADDR(J) -> F$DCB.CFU$ = C1DCB$
      201     3584    4                       THEN
      202     3585    4                          DCBADDR(J) -> F$DCB.CFU$ = DCBADDR(%M$UC#);
      203     3586    4                    J = J - 1;
      204     3587    4                    END;
      205     3588    3                 CALL FSA$FDCB(C1DCB$);
      206     3589    3                 B$ROSEG.CR01DCB = POFFW(DCBADDR(%M$UC#),B$ROSEG$);
      207     3590    3                 END;
      208     3591    3              ELSE DO;
      209     3592    3                 C1DCB$->F$DCB.FCD=%YES#;
      210     3593    3                 C1DCB$->F$DCB.IASN=0;
      211     3594    3                 END;
      212     3595    2              END;
      213     3596    1           IF B$ROSEG.CR01ID.INT THEN
      214     3597    1              B$JIT.NEXTCC=%CC_FROMUC#;
      215     3598    1           ELSE
      216     3599    1              B$JIT.NEXTCC=%CC_FROMNO#;
      217     3600    1           B$ROSEG.CR01ID.NOWIS=B$JIT.NEXTCC;
      218     3601    1           GOTO USERRET;
      219     3602        /**/
      220     3603    1   FSD$REW: ENTRY ALTRET;
      221     3604    2           DO CASE(B$ROSEG.CR01ID.NOWIS);
      222     3605    2            CASE(%CC_FROMUC#); /* REW TERMINAL IS NOP.*/
      223     3606    2              RETURN;
      224     3607    2            CASE(%CC_FROMNO#); /* NO IS NOP OR REW BATCH CC FILE.*/
      225     3608    2              IF NOT B$ROSEG.CR01ID.JCL THEN RETURN;
      226     3609    2              B$ROSEG.CR01ID.NOWIS=%CC_FROMJOB#;
      227     3610    2            CASE(%CC_FROMXEQEND#); /* XEQEND NEEDS TO BECOME XEQ.*/
      228     3611    2              B$ROSEG.CR01ID.NOWIS=%CC_FROMXEQ#;
      229     3612    2            END;
      230     3613    1           JDCB$=B$JIT.DCB$;
      231     3614    1           C1DCB$=PINCRW(B$ROSEG$,B$ROSEG.CR01DCB);
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:8    
      232     3615    1           B$JIT.DCB$=C1DCB$;
      233     3616    1           IF C1DCB$->F$DCB.IASN=%FILE# THEN
      234     3617    1              CALL FMP$CLSF;
      235     3618    1           C1DCB$->F$DCB.IASN=0;
      236     3619    1           IF C1DCB$=DCBADDR(%M$UC#) THEN
      237     3620    1              C1DCB$->F$DCB.FCD=%YES#;
      238     3621    1           B$ROSEG.CR01ID.POSN=0;
      239     3622    1           B$JIT.NEXTCC=B$ROSEG.CR01ID.NOWIS;
      240     3623    1           B$JIT.DCB$=JDCB$;
      241     3624    1           RETURN;
      242     3625        %EJECT;
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:9    
      243     3626    1   FSD$ENDJOB: ENTRY ALTRET;
      244     3627    2           IF B$ROSEG.CR01DCB=1 THEN DO;
      245     3628    2              B$ROSEG.CR01ID='0'B;
      246     3629    3              DO CASE(B$JIT.NEXTCC);
      247     3630    3               CASE(%CC_FROMJOB#);
      248     3631    3                 B$ROSEG.CR01ID.JCL='1'B;
      249     3632    3                 B$ROSEG.CR01ID.NOWIS=%CC_FROMJOB#;
      250     3633    3               CASE(ELSE);
      251     3634    3                 B$JIT.NEXTCC=%CC_FROMNO#;
      252     3635    3               END;
      253     3636    2              B$ROSEG.CR01DCB=POFFW(DCBADDR(%M$UC#),B$ROSEG$);
      254     3637    2              END;
      255     3638    1           B$ROSEG.CR01ID.POSN=0;
      256     3639    2           DO WHILE (B$ROSEG.CR01ID.NOWIS = %CC_FROMXEQ# AND
      257     3640    2             B$ROSEG.CR01ID.NOWIS=%CC_FROMXEQEND#);
      258     3641    2              IF B$ROSEG.CR01DCB=0 THEN
      259     3642    2                 CALL FSD$C1GETDCB ALTRET(ENDJALT2);
      260     3643    2              C1DCB$=PINCRW(B$ROSEG$,B$ROSEG.CR01DCB);
      261     3644    2              B$JIT.DCB$=C1DCB$;
      262     3645    2              IF C1DCB$->F$DCB.IASN~=%FILE# THEN
      263     3646    2                 CALL OPENDCB ALTRET(ENDJALTR);
      264     3647    2              CALL ENDJLOOK ALTRET(ERROR_CR01);
      265     3648    2              END;
      266     3649    1   ENDJJCL:;
      267     3650    2           IF B$ROSEG.CR01ID.JCL THEN DO;
      268     3651    2              C1DCB$=PINCRW(B$ROSEG$,B$ROSEG.CR01DCB);
      269     3652    2              B$JIT.DCB$=C1DCB$;
      270     3653    2              CALL OPENDCB ALTRET(ALTRETUR);
      271     3654    2              CALL FMP$CLSF(MYPN$);
      272     3655    2              B$JIT.NEXTCC=%CC_FROMNO#;
      273     3656    2              B$ROSEG.CR01ID.NOWIS=%CC_FROMNO#;
      274     3657    2              B$ROSEG.CR01ID.JCL=%NO#;
      275     3658    2              C1DCB$->F$DCB.FCD=%YES#;
      276     3659    2              C1DCB$->F$DCB.IASN=0;
      277     3660    2              END;
      278     3661    1           RETURN;
      279     3662    1   ALTRETUR: ALTRETURN;
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:10   
      280     3663    1   ENDJALTR:;
      281     3664    1           IF C1DCB$~=DCBADDR(%M$UC#) THEN
      282     3665    1              CALL FSA$FDCB(C1DCB$);
      283     3666    1   ENDJALT2:;
      284     3667    2           IF B$ROSEG.CR01ID.INT THEN DO;
      285     3668    2              B$ROSEG.CR01DCB=0;
      286     3669    2              B$ROSEG.CR01ID.NOWIS=%CC_FROMUC#;
      287     3670    2              END;
      288     3671    1           ELSE
      289     3672    1              B$ROSEG.CR01ID.NOWIS=%CC_FROMNO#;
      290     3673    1           B$JIT.NEXTCC=B$ROSEG.CR01ID.NOWIS;
      291     3674    1           GOTO ENDJJCL;
      292     3675    1   FSD$XFLUSH: ENTRY ALTRET;
      293     3676    2           DO WHILE (B$ROSEG.CR01ID.NOWIS=%CC_FROMXEQ# OR
      294     3677    2             B$ROSEG.CR01ID.NOWIS=%CC_FROMXEQEND#);
      295     3678    2              IF B$ROSEG.CR01DCB=0 THEN
      296     3679    2                 CALL FSD$C1GETDCB ALTRET(ALTRETUR);
      297     3680    2              C1DCB$=PINCRW(B$ROSEG$,B$ROSEG.CR01DCB);
      298     3681    2              B$JIT.DCB$=C1DCB$;
      299     3682    2              IF C1DCB$->F$DCB.IASN~=%FILE# THEN
      300     3683    2                 CALL OPENDCB ALTRET(ERROR_CR01);
      301     3684    2              CALL ENDJLOOK ALTRET(ERROR_CR01);
      302     3685    2              CALL HFF$NILERASE (B$PS0$)
      303     3686    3              WHENRETURN DO;
      304     3687    3                 IF FPT$XFLUSH_V.ONELEVEL
      305     3688    3                 THEN RETURN;
      306     3689    3                 END;
      307     3690    2              END;
      308     3691    1   CHKJ:
      309     3692    2           IF B$ROSEG.CR01ID.NOWIS=%CC_FROMJOB# THEN DO;
      310     3693    3              IF DCBADDR(%M$UC#)->F$DCB.IASN=%FILE# THEN DO;
      311     3694    3                 C1DCB$=PINCRW(B$ROSEG$,B$ROSEG.CR01DCB);
      312     3695    3                 B$JIT.DCB$=C1DCB$;
      313     3696    3                 CALL FMP$CLSF;
      314     3697    3                 C1DCB$->F$DCB.IASN=0;
      315     3698    3                 C1DCB$->F$DCB.FCD=%YES#;
      316     3699    3                 END;
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:11   
      317     3700    2              B$ROSEG.CR01ID.NOWIS=%CC_FROMNO#;
      318     3701    2              B$JIT.NEXTCC=%CC_FROMNO#;
      319     3702    2              END;
      320     3703    1           RETURN;
      321     3704        %EJECT;
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:12   
      322     3705        /**** * * * * ****/
      323     3706    1   OPENDCB:PROC ALTRET;
      324     3707        /*      OPENDCB opens the control command file DCB and positions it
      325     3708         *         to the right place for the next read.
      326     3709         */
      327     3710    2           B$JIT.ERR='0'B;
      328     3711    2           IF B$ROSEG.CR01ID.INT THEN
      329     3712    2              CALL FMM$DFLOPNP;
      330     3713    3           ELSE DO;
      331     3714    3              C1DCB$->F$DCB.ASN=%FILE#;
      332     3715    3              C1DCB$->F$DCB.RES=' ';
      333     3716    3              C1DCB$->F$DCB.PSN=' ';
      334     3717    4              IF B$ROSEG.CR01ID.NOWIS=%CC_FROMXEQ# THEN DO;
      335     3718    4                 C1DCB$->F$DCB.NAME.L=2;
      336     3719    4                 C1DCB$->F$DCB.NAME.C='*X';
      337     3720    4                 C1DCB$->F$DCB.ACCT=' ';
      338     3721    4                 END;
      339     3722    4              ELSE DO;
      340     3723    4                 C1DCB$->F$DCB.NAME.L=7;
      341     3724    4                 C1DCB$->F$DCB.NAME.C='xxxxxxS';
      342     3725    4                 J=B$JIT.SYSID;
      343     3726    4                 CALL BINCHAR(SUBSTR(C1DCB$->F$DCB.NAME.C,0,6),J);
      344     3727    4                 C1DCB$->F$DCB.ACCT=':SYMI';
      345     3728    4                 END;
      346     3729    3              C1DCB$->F$DCB.FUN=%UPDATE#;
      347     3730    3              CALL FMM$DFLOPNP;
      348     3731    4              IF NOT C1DCB$->F$DCB.FCD THEN DO;
      349     3732    4                 C1DCB$->F$DCB.IASN=0;
      350     3733    4                 C1DCB$->F$DCB.FCD=%YES#;
      351     3734    4                 END;
      352     3735    3              C1DCB$->F$DCB.ASN=%DEVICE#;
      353     3736    3              C1DCB$->F$DCB.RES='NO';
      354     3737    3              C1DCB$->F$DCB.IFMT=FMTNO#;
      355     3738    3              C1DCB$->F$DCB.FFLG=%FFLG_OWNER#;
      356     3739    3              END;
      357     3740    2           IF B$JIT.ERR.CODE~=0 THEN ALTRETURN;
      358     3741    2           C1DCB$->F$DCB.WAIT=1;
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:13   
      359     3742    2           IF B$ROSEG.CR01ID.NOWIS=%CC_FROMXEQ# THEN
      360     3743    2              C1DCB$->F$DCB.DDEV=%DDEV_XEQ#;
      361     3744    3           IF B$ROSEG.CR01ID.POSN~=0 THEN DO;
      362     3745    3              C1DCB$->F$DCB.UBYTES=B$ROSEG.CR01ID.POSN;
      363     3746    3              CALL FMH$PREC(FPTPREC) ALTRET(ALTRETUR);
      364     3747    3              END;
      365     3748    2           RETURN;
      366     3749    2   ALTRETUR:;
      367     3750    2           ALTRETURN;
      368     3751    2   END;
      369     3752        /**** * * * * ****/
      370     3753    1   LOOKAHEAD: PROC ALTRET;
      371     3754        /*      LOOKAHEAD gets next control command's DVBYTE into "secret" DCB.
      372     3755         *         If there is one, Return with J=0.
      373     3756         *         If no next record, get control command file's FIT.CODE11
      374     3757         *         which tells where to go back to to find next record to read,
      375     3758         *         and close "secret" DCB.
      376     3759         *         If next record is to come from another control command file,
      377     3760         *         set file's name into "secret" DCB filename and set record #
      378     3761         *         to position to into ROSEG, and Return with J=1.
      379     3762         *         If next record not from another control command file, mark
      380     3763         *         all user DCB's pointing to "secret" DCB closed and free
      381     3764         *         ROSEG space of "secret" DCB.  Then set identity of new place
      382     3765         *         into CR01 identity in ROSEG and set new place positioning
      383     3766         *         into ROSEG.  Then Return with J=2.
      384     3767         *         If errors occur during any of this processing, Return with
      385     3768         *         J=3.
      386     3769         */
      387     3770    2           C1DCB$->F$DCB.ARS=0;
      388     3771    2           C1DCB$->F$DCB.TYC(1)='0'B;
      389     3772    2           CALL FMH$LOOKAHD ALTRET(ENDOFFILE);
      390     3773    2           J=0;
      391     3774    2           RETURN;
      392     3775    2   ENDOFFILE:;
      393     3776    2           IF B$JIT.ERR.CODE~=%E$EOF THEN GOTO JIS2;
      394     3777    3           IF B$ROSEG.CR01ID.NOWIS~=%CC_FROMXEQ# THEN DO;
      395     3778    3              CALL FMP$CLSF;
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:14   
      396     3779    3              C1DCB$->F$DCB.IASN=0;
      397     3780    3              C1DCB$->F$DCB.FCD=%YES#;
      398     3781    3              B$ROSEG.CR01ID.NOWIS=%CC_FROMNO#;
      399     3782    3              B$JIT.NEXTCC=%CC_FROMNO#;
      400     3783    3              J=2;
      401     3784    3              RETURN;
      402     3785    3              END;
      403     3786    2           J=1;
      404     3787    2           CALL FMN$GETFIT(FIT$,J) ALTRET(JIS2);
      405     3788    2           FIT$=PINCRW(FIT$,SIZEW(FM$GRAN));
      406     3789    2           CALL FMO$LOCCODP(FIT$,11)ALTRET(JIS2);
      407     3790    2           FS$XEQSAVE=FIT$->UATTRWORDS;
      408     3791    2           J=4;
      409     3792    2           RETURN;
      410     3793    2   JIS2:   ALTRETURN;
      411     3794    2   END LOOKAHEAD;
      412     3795        /**/
      413     3796    1   ENDJLOOK: PROC ALTRET;
      414     3797    2           J=1;
      415     3798    2           CALL FMN$GETFIT(FIT$,J) ALTRET(JIS2);
      416     3799    2           FIT$=PINCRW(FIT$,SIZEW(FM$GRAN));
      417     3800    2           CALL FMO$LOCCODP(FIT$,11)ALTRET(JIS2);
      418     3801    2           FS$XEQSAVE=FIT$->UATTRWORDS;
      419     3802    2           CALL FMP$CLSF(MYPN$); /* Release file                       */
      420     3803    2           IF C1DCB$=DCBADDR(%M$UC#) THEN
      421     3804    2              C1DCB$->F$DCB.FCD=%YES#;
      422     3805    2           C1DCB$->F$DCB.IASN=0;
      423     3806    2           B$ROSEG.CR01ID=FS$XEQSAVE.CR01ID;
      424     3807                /* CSLEV is the count IBEX uses to know how many levels
      425     3808                   down he is is a nested XEQ type situation.  Whenever
      426     3809                   we are coming up a level in a nest we decrement CSLEV
      427     3810                   and make sure it is never less then 0.  When we go down
      428     3811                   a level, we just increment CSLEV one more.  CSLEV is
      429     3812                   initialized to 0 in LOGON.
      430     3813                */
      431     3814    2           B$JIT.CSLEV = B$JIT.CSLEV - 1;
      432     3815    2           B$JIT.NEXTCC=B$ROSEG.CR01ID.NOWIS;
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:15   
      433     3816    3           DO CASE(B$ROSEG.CR01ID.NOWIS);
      434     3817    3            CASE(%CC_FROMNO#);
      435     3818    3              J=2;
      436     3819    3              RETURN;
      437     3820    3            CASE(%CC_FROMUC#);
      438     3821    3              J=B$ROSEG.NUMDCBS;
      439     3822    4              DO WHILE (J>=%M$MAXNEG#);
      440     3823    4                 IF DCBADDR(J)~=ADDR(NIL) THEN
      441     3824    4                    IF DCBADDR(J)->F$DCB.CFU$=C1DCB$ THEN
      442     3825    4                       DCBADDR(J)->F$DCB.CFU$=DCBADDR(%M$UC#);
      443     3826    4                 J=J-1;
      444     3827    4                 END;
      445     3828    3              CALL FSA$FDCB(C1DCB$);
      446     3829    3              B$ROSEG.CR01DCB=POFFW(DCBADDR(%M$UC#),B$ROSEG$);
      447     3830    3              J=2;
      448     3831    3              RETURN;
      449     3832    3            CASE(%CC_FROMJOB#);
      450     3833    3            CASE(%CC_FROMXEQ#);
      451     3834    3              B$JIT.STAR.DA(6)=FS$XEQSAVE.STARDA;
      452     3835    3            END;
      453     3836    2           J=1;
      454     3837    2           RETURN;
      455     3838    2   JIS2:   ALTRETURN;
      456     3839    2   END ENDJLOOK;
      457     3840    1   END;
      458     3841        %EOD;

PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:16   
--  Include file information  --

   FM$MACROS.:E05TOU  is referenced.
   FS$FIT.:E05TOU  is referenced.
   F_FMTCODE_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   F$CP6V_C.:E05TOU  is referenced.
   F_CP6.:E05TOU  is referenced.
   F_FPTCODE_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   B$ROSEG.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
      No diagnostics issued in procedure FSD$C1.

   Procedure FSD$C1 requires 801 words for executable code.
   Procedure FSD$C1 requires 16 words of local(AUTO) storage.

PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:17   

 Object Unit name= FSD$C1                                     File name= FSD$JCL.:E05TOU
 UTS= JUL 29 '97 17:28:30.64 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     39     47  FSD$C1
    1   Proc  even  none   801   1441  FSD$C1
    2  RoData even  none    10     12  FSD$C1

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        0  FSD$C1
     1    240          yes     yes      Std        0  FSD$C1END
     1    400          yes     yes      Std        0  FSD$REW
     1    500          yes     yes      Std        0  FSD$ENDJOB
     1    676          yes     yes      Std        0  FSD$XFLUSH
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:18   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 FMO$GETDOMAIN
 yes     yes           Std       3 FMH$CPMME
         yes           Std       1 FMP$CLSF
 yes     yes           Std       0 FSD$C1GETDCB
 yes     yes           Std       1 HFF$NILERASE
         yes           Std       1 FSA$FDCB
         yes           Std       0 FMM$DFLOPNP
 yes     yes           Std       1 FMH$PREC
 yes     yes           Std       0 FMH$LOOKAHD
 yes     yes           Std       2 FMN$GETFIT
 yes     yes           Std       2 FMO$LOCCODP
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$JIT$                                B$ROSEG$                              B$PS0$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:19   


        1        1        /*M* FSD$JCL Handle Read/Write PMME's for control command files */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* CLM=8,ICP,MOC,DMR */
        8        8        /*P*    NAME: FSD$JCL
        9        9         *      PURPOSE: FSD$JCL manages user interactions with control command
       10       10         *         files.  It contains four submodules:
       11       11         *            FSD$C1 handles control command reads.  It is called for
       12       12         *         user M$READ PMME's; its entry FSD$C1OPEN is called for
       13       13         *         user M$OPEN PMME's.
       14       14         *            FSD$JE handles control command file creation.  It is
       15       15         *         called for user M$WRITE PMME's to JE and JF.
       16       16         *            FSD$JEOPEN opens batch job files.  It is called for user
       17       17         *         M$OPEN PMME's to JE (Batching a job).
       18       18         *            FSD$JFOPEN opens XEQ files.  It is called for user M$OPEN
       19       19         *         PMME's to JF (Building an XEQ file).
       20       20         */
       21       21        /*F*    NAME: FSD$C1
       22       22         *      PURPOSE: FSD$C1 handles user M$READ PMME's which read control
       23       23         *         command files.  User DCB's for such reads are always
       24       24         *         connected to the control stream CR01; their user-visible
       25       25         *         assignments are to various device oplabels.
       26       26         *      DESCRIPTION:   The user DCB is always streamed to a "secret"
       27       27         *         DCB which is open to a control command file in the input
       28       28         *         symbiont account (:SYMI).  FSD$C1 peeks at the device byte
       29       29         *         (DVBYTE) of the next record in the file; if the record is
       30       30         *         a control command and it is not the command processor
       31       31         *         reading, an EOF condition is returned.  Otherwise, the next
       32       32         *         record is read into the user's buffer.  If the record is
       33       33         *         a !EOD record, an EOD condition is returned.
       34       34         *            If the record just read is the last record in the file,
       35       35         *         the control command place is switched to be the saved
       36       36         *         control command place which was preserved in the FIT of the
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:20   
       37       37         *         file, and the file is deleted.
       38       38         *            If the switched-to place is not another control command
       39       39         *         file (i.e., it is M$UC), all user DCB's which point to the
       40       40         *         "secret" DCB are marked closed (the next user PMME will
       41       41         *         reopen them to be streamed to M$UC) and the secret DCB's
       42       42         *         ROSEG space is freed.
       43       43         */
       44       44        /*D*    NAME: FSD$C1
       45       45         *      CALL: CALL FSD$C1(FPTCODE) ALTRET;
       46       46         *      INTERFACE:  FMH$LOOKAHD, FMH$CPMME, FSB$C1EOF.
       47       47         *
       48       48         *
       49       49         *
       50       50         *      ENVIRONMENT: Monitor (for user) LS.
       51       51         *      INPUT:   DCB (B$JIT.DCB$).
       52       52         *
       53       53         *      OUTPUT:  DCB.ARS, DCB.DVBYTE, JIT.ERR modified.
       54       54         *
       55       55         */
       56       56        FSD$C1: PROC ALTRET;

     56  1 000000   000000 700200 xent  FSD$C1       TSX0  ! X66_AUTO_0
         1 000001   000020 000000                    ZERO    16,0

       57       57        /**/
       58       58    1   DCL FMH$LOOKAHD ENTRY ALTRET; /* Look ahead to next record's DVBYTE */
       59       59    1   DCL FMH$CPMME ENTRY(3) ALTRET; /* Perform PMME to Consec file        */
       60       60    1   DCL FMO$GETDOMAIN ENTRY(1); /* Get domain (WSR) of PMME'er        */
       61       61    1   DCL FMN$GETFIT ENTRY(2)ALTRET; /* Read FIT granule of file           */
       62       62    1   DCL FSD$C1GETDCB ENTRY ALTRET;
       63       63    1   DCL FMO$LOCCODP ENTRY(2)ALTRET; /* Find entry in FIT                  */
       64       64    1   DCL FMP$CLSF ENTRY(1); /* Close a file                       */
       65       65    1   DCL FSA$FDCB ENTRY(1); /* Free a DCB's ROSEG space */
       66       66    1   DCL FMM$DFLOPNP ENTRY; /* Default Privileged open of DCB */
       67       67    1   DCL FMH$PREC ENTRY(1)ALTRET; /* Internal entry to position file    */
       68       68    1   DCL FSA$GSP ENTRY(2)ALTRET; /* Get ROSEG space                    */
       69       69    1   DCL HFF$NILERASE ENTRY (1) ALTRET; /* Is vector NIL/ERASE? */
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:21   
       70       70        /**/
       71       71    1   DCL B$JIT$ PTR SYMREF; /* NOTE: JIT is BASED (B$JIT$).       */
       72       72    1   DCL B$ROSEG$ PTR SYMREF;
       73       73    1   DCL B$PS0$ PTR SYMREF;
       74       74        %INCLUDE B$JIT_C;
       75      388        %B$JIT0;
       76      477        %U$JIT1;
       77      551        %M$JIT2X;
       78      554        %F$JIT3;
       79      559        %S$JIT4X;
       80      562        %J$JIT5X;
       81      565        %A$JIT6X;
       82      568        %MACRO B$ROSEG(BASED=BASED);
       83      569        %INCLUDE B$ROSEG;
       84      632        %MEND;
       85      633        %B$ROSEG(BASED="BASED(B$ROSEG$)");
       86      693        %INCLUDE B_STRINGS_C;
       87      822        %INCLUDE F_ERRORS_C;
       88     1062        %INCLUDE F$DCB;
       89     1111        %INCLUDE F_FPTCODE_C;
       90     1147        %INCLUDE F_CP6;
       91     2172        %INCLUDE F$CP6V_C;
       92     2398        %INCLUDE CP_6_SUBS;
       93     2938        %INCLUDE F_FMTCODE_C;
       94     2972        %INCLUDE FS$FIT;
       95     3015        /**/
       96     3016        %FPT_READ(FPTN=MYFPT,STCLASS=CONSTANT,WAIT=YES);
       97     3055        %FPT_CLOSE(FPTN=MYPN$,PFMT=PTR,VECTOR=ADDR,STCLASS=CONSTANT,
       98     3056                   DISP=SCRATCH);
       99     3098        %FPT$XFLUSH_V (BASED = "BASED (B$PS0$)");
      100     3101        %SUB FCG#="'0623'O";
      101     3102        %SUB MID#="'04'O";
      102     3103        %INCLUDE FM$MACROS;
      103     3478        %FM$GRAN;
      104     3482        %ERRCODE(NAME=ERR$EOF,COD#=%E$EOF);
      105     3486        /*E*    ERROR:   FSD-E$EOF-2
      106     3487                MESSAGE: End of File.
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:22   
      107     3488                MESSAGE1: End of File; you tried to read a control command.
      108     3489         */
      109     3490        /**** * * * * ****/
      110     3491    1   DCL JDCB$ PTR; /* Holds address of user DCB          */
      111     3492    1   DCL C1DCB$ PTR; /* Holds address of secret CR01 DCB   */
      112     3493    1   DCL WSR UBIN; /* Holds domain of caller             */
      113     3494    1   DCL MYERROR BIT(36);
      114     3495    1   DCL FIT$ PTR;
      115     3496    1   DCL J SBIN;
      116     3497    1   DCL HIDEYHOLE BIT(36);
      117     3498    1   DCL 1 UATTRWORDS BASED, /* C1 POSN WORDS IN UATTR             */
      118     3499    1         2 *(0:1)SBIN;
      119     3500        %FS$XEQSAVE(STCLASS=);
      120     3503        %EJECT;
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:23   
      121     3504    1           JDCB$=B$JIT.DCB$;

   3504  1 000002   000000 470400 xsym               LDP0    B$JIT$
         1 000003   000232 236100                    LDQ     154,,PR0
         1 000004   200003 756100                    STQ     JDCB$,,AUTO

      122     3505    1           C1DCB$=PINCRW(B$ROSEG$,B$ROSEG.CR01DCB);

   3505  1 000005   000000 471400 xsym               LDP1    B$ROSEG$
         1 000006   100115 220100                    LDX0    77,,PR1
         1 000007   000000 636010                    EAQ     0,X0
         1 000010   000000 036000 xsym               ADLQ    B$ROSEG$
         1 000011   200004 756100                    STQ     C1DCB$,,AUTO

      123     3506    1           B$JIT.DCB$=C1DCB$;

   3506  1 000012   000232 756100                    STQ     154,,PR0

      124     3507    2           IF C1DCB$->F$DCB.IASN~=%FILE# THEN DO;

   3507  1 000013   200004 473500                    LDP3    C1DCB$,,AUTO
         1 000014   300103 236100                    LDQ     67,,PR3
         1 000015   000777 376007                    ANQ     511,DL
         1 000016   000001 116007                    CMPQ    1,DL
         1 000017   000043 600000 1                  TZE     s:3520

   3507  1 000020                       PREREADLOOK* null
      125     3508    2   PREREADLOOKMORE:;
      126     3509    2              CALL OPENDCB ALTRET(ERROR_CR01);

   3509  1 000020   001004 701000 1                  TSX1    OPENDCB
         1 000021   000257 702000 1                  TSX2    ERROR_CR01

      127     3510    2              CALL LOOKAHEAD ALTRET(ERROR_CR01);

   3510  1 000022   001147 701000 1                  TSX1    LOOKAHEAD
         1 000023   000257 702000 1                  TSX2    ERROR_CR01
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:24   

      128     3511    2              IF J=4 THEN CALL ENDJLOOK ALTRET(ERROR_CR01);

   3511  1 000024   200010 235100                    LDA     J,,AUTO
         1 000025   000004 115007                    CMPA    4,DL
         1 000026   000031 601000 1                  TNZ     s:3512

   3511  1 000027   001255 701000 1                  TSX1    ENDJLOOK
         1 000030   000257 702000 1                  TSX2    ERROR_CR01

      129     3512    3              DO CASE(J);

   3512  1 000031   200010 235100                    LDA     J,,AUTO
         1 000032   000004 115007                    CMPA    4,DL
         1 000033   000035 602005 1                  TNC     s:3512+4,AL
         1 000034   000043 710000 1                  TRA     s:3520
         1 000035   000043 710000 1                  TRA     s:3520
         1 000036   000041 710000 1                  TRA     s:3515
         1 000037   000042 710000 1                  TRA     s:3517
         1 000040   000042 710000 1                  TRA     s:3517

      130     3513    3               CASE(0); /* GOT RECORD                         */

      131     3514    3               CASE(1); /* NEW FILE                           */

      132     3515    3                 GOTO PREREADLOOKMORE;

   3515  1 000041   000020 710000 1                  TRA     PREREADLOOKMORE

      133     3516    3               CASE(2,3); /* M$UC OR ERROR                      */

      134     3517    3                 GOTO ERROR_CR01;

   3517  1 000042   000257 710000 1                  TRA     ERROR_CR01

      135     3518    3               END;

PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:25   
      136     3519    2              END;

      137     3520    1           JDCB$->F$DCB.DDEV=(JDCB$->F$DCB.DDEV&~(%DDEV_IC#|%DDEV_XEQ#))

   3520  1 000043   200003 470500                    LDP0    JDCB$,,AUTO
         1 000044   000004 236100                    LDQ     4,,PR0
         1 000045   000022 736000                    QLS     18
         1 000046   777000 376003                    ANQ     -512,DU
         1 000047   637000 376003                    ANQ     -49664,DU
         1 000050   200004 471500                    LDP1    C1DCB$,,AUTO
         1 000051   200016 756100                    STQ     FS$XEQSAVE+4,,AUTO
         1 000052   100004 236100                    LDQ     4,,PR1
         1 000053   000022 736000                    QLS     18
         1 000054   777000 376003                    ANQ     -512,DU
         1 000055   040000 376003                    ANQ     16384,DU
         1 000056   200016 276100                    ORQ     FS$XEQSAVE+4,,AUTO
         1 000057   000022 772000                    QRL     18
         1 000060   000004 552110                    STBQ    4,'10'O,PR0

      138     3521    1             |(C1DCB$->F$DCB.DDEV&(%DDEV_XEQ#));
      139     3522    2           IF C1DCB$->F$DCB.DVBYTE & %DVBYTE_NODAT# THEN DO;

   3522  1 000061   200004 471500                    LDP1    C1DCB$,,AUTO
         1 000062   100003 236100                    LDQ     3,,PR1
         1 000063   776000 376003                    ANQ     -1024,DU
         1 000064   004000 376003                    ANQ     2048,DU
         1 000065   000102 600000 1                  TZE     s:3529

      140     3523    2              CALL FMO$GETDOMAIN(WSR);

   3523  1 000066   200005 633500                    EPPR3   WSR,,AUTO
         1 000067   200016 453500                    STP3    FS$XEQSAVE+4,,AUTO
         1 000070   200016 630500                    EPPR0   FS$XEQSAVE+4,,AUTO
         1 000071   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000072   000000 701000 xent               TSX1    FMO$GETDOMAIN
         1 000073   000000 011000                    NOP     0

PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:26   
      141     3524    3              IF WSR~=%CPWSR/*%CPWSR*/ THEN DO;

   3524  1 000074   200005 235100                    LDA     WSR,,AUTO
         1 000075   000004 115007                    CMPA    4,DL
         1 000076   000102 600000 1                  TZE     s:3529

      142     3525    3                 MYERROR=ERR$EOF;

   3525  1 000077   000040 236000 0                  LDQ     ERR$EOF
         1 000100   200006 756100                    STQ     MYERROR,,AUTO

      143     3526    3                 GOTO USERRET;

   3526  1 000101   000227 710000 1                  TRA     USERRET

      144     3527    3                 END;
      145     3528    2              END;
      146     3529    1           C1DCB$->F$DCB.UB$=JDCB$->F$DCB.UB$;

   3529  1 000102   200003 470500                    LDP0    JDCB$,,AUTO
         1 000103   000075 236100                    LDQ     61,,PR0
         1 000104   200004 471500                    LDP1    C1DCB$,,AUTO
         1 000105   100075 756100                    STQ     61,,PR1

      147     3530    1           C1DCB$->F$DCB.UBYTES=JDCB$->F$DCB.UBYTES;

   3530  1 000106   000076 235100                    LDA     62,,PR0
         1 000107   100076 755100                    STA     62,,PR1

      148     3531    1           B$ROSEG.CR01ID.POSN=

   3531  1 000110   000000 473400 xsym               LDP3    B$ROSEG$
         1 000111   300114 236100                    LDQ     76,,PR3
         1 000112   000001 036007                    ADLQ    1,DL
         1 000113   300114 552134                    STBQ    76,'34'O,PR3

      149     3532    1             B$ROSEG.CR01ID.POSN+1;
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:27   
      150     3533    1           CALL FMH$CPMME(FPTREAD,MYFPT.V)ALTRET(USERERR);

   3533  1 000114   000000 630400 2                  EPPR0   0
         1 000115   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000116   000000 701000 xent               TSX1    FMH$CPMME
         1 000117   000140 702000 1                  TSX2    USERERR

      151     3534    1           B$JIT.ERR='0'B;

   3534  1 000120   000000 470400 xsym               LDP0    B$JIT$
         1 000121   000012 450100                    STZ     10,,PR0

      152     3535    2           IF C1DCB$->F$DCB.DVBYTE & %DVBYTE_DCBHDR# THEN DO;

   3535  1 000122   200004 471500                    LDP1    C1DCB$,,AUTO
         1 000123   100003 236100                    LDQ     3,,PR1
         1 000124   776000 376003                    ANQ     -1024,DU
         1 000125   002000 376003                    ANQ     1024,DU
         1 000126   000140 600000 1                  TZE     USERERR

      153     3536    2              B$JIT.ERR=ERR$EOF;

   3536  1 000127   000040 236000 0                  LDQ     ERR$EOF
         1 000130   000012 756100                    STQ     10,,PR0

      154     3537    2              JDCB$->F$DCB.TYC.EOD(JDCB$->F$DCB.WAIT)='1'B;

   3537  1 000131   200003 473500                    LDP3    JDCB$,,AUTO
         1 000132   300064 236100                    LDQ     52,,PR3
         1 000133   000004 772000                    QRL     4
         1 000134   000001 376007                    ANQ     1,DL
         1 000135   000000 620006                    EAX0    0,QL
         1 000136   000200 236003                    LDQ     128,DU
         1 000137   300001 256110                    ORSQ    1,X0,PR3

      155     3538    2              END;

PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:28   
   3535  1 000140                       USERERR      null
      156     3539    1   USERERR:;
      157     3540    1           MYERROR= B$JIT.ERR;

   3540  1 000140   000000 470400 xsym               LDP0    B$JIT$
         1 000141   000012 236100                    LDQ     10,,PR0
         1 000142   200006 756100                    STQ     MYERROR,,AUTO

      158     3541    1           JDCB$->F$DCB.TYC(JDCB$->F$DCB.WAIT)=

   3541  1 000143   200003 471500                    LDP1    JDCB$,,AUTO
         1 000144   100064 236100                    LDQ     52,,PR1
         1 000145   000004 772000                    QRL     4
         1 000146   000001 376007                    ANQ     1,DL
         1 000147   200004 473500                    LDP3    C1DCB$,,AUTO
         1 000150   000000 620006                    EAX0    0,QL
         1 000151   100001 236106                    LDQ     1,QL,PR1
         1 000152   300002 276100                    ORQ     2,,PR3
         1 000153   100001 756110                    STQ     1,X0,PR1

      159     3542    1             JDCB$->F$DCB.TYC(JDCB$->F$DCB.WAIT)|C1DCB$->F$DCB.TYC(1);
      160     3543    1           JDCB$->F$DCB.ARS= C1DCB$->F$DCB.ARS;

   3543  1 000154   200004 470500                    LDP0    C1DCB$,,AUTO
         1 000155   000000 235100                    LDA     0,,PR0
         1 000156   100000 755100                    STA     0,,PR1

      161     3544    1           JDCB$->F$DCB.DVBYTE= C1DCB$->F$DCB.DVBYTE;

   3544  1 000157   200004 470500                    LDP0    C1DCB$,,AUTO
         1 000160   000003 236100                    LDQ     3,,PR0
         1 000161   100003 676100                    ERQ     3,,PR1
         1 000162   776000 376003                    ANQ     -1024,DU
         1 000163   100003 656100                    ERSQ    3,,PR1

      162     3545    1           JDCB$->F$DCB.EOMCHAR= C1DCB$->F$DCB.EOMCHAR;

PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:29   
   3545  1 000164   200004 470500                    LDP0    C1DCB$,,AUTO
         1 000165   000003 236100                    LDQ     3,,PR0
         1 000166   100003 552104                    STBQ    3,'04'O,PR1

      163     3546    1           CALL LOOKAHEAD ALTRET(ERROR_CR01);

   3546  1 000167   001147 701000 1                  TSX1    LOOKAHEAD
         1 000170   000257 702000 1                  TSX2    ERROR_CR01

      164     3547    2           DO CASE(J);

   3547  1 000171   200010 235100                    LDA     J,,AUTO
         1 000172   000005 115007                    CMPA    5,DL
         1 000173   000175 602005 1                  TNC     s:3547+4,AL
         1 000174   000227 710000 1                  TRA     USERRET
         1 000175   000227 710000 1                  TRA     USERRET
         1 000176   000227 710000 1                  TRA     USERRET
         1 000177   000202 710000 1                  TRA     s:3550
         1 000200   000227 710000 1                  TRA     USERRET
         1 000201   000206 710000 1                  TRA     s:3552

      165     3548    2            CASE(0); /* MORE IN FILE; DO NOTHING.*/

      166     3549    2            CASE(2); /* END OF BATCH JCL; SET TOP FLAG.*/

      167     3550    2              JDCB$->F$DCB.DVBYTE.TOP='1'B;

   3550  1 000202   200003 470500                    LDP0    JDCB$,,AUTO
         1 000203   400000 236003                    LDQ     -131072,DU
         1 000204   000003 256100                    ORSQ    3,,PR0
         1 000205   000227 710000 1                  TRA     USERRET

      168     3551    2            CASE(4); /*OFF END OF XEQ*/

      169     3552    2              HIDEYHOLE=B$ROSEG.CR01ID;

   3552  1 000206   000000 470400 xsym               LDP0    B$ROSEG$
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:30   
         1 000207   000114 236100                    LDQ     76,,PR0
         1 000210   200011 756100                    STQ     HIDEYHOLE,,AUTO

      170     3553    2              B$ROSEG.CR01ID=FS$XEQSAVE.CR01ID;

   3553  1 000211   200012 236100                    LDQ     FS$XEQSAVE,,AUTO
         1 000212   000114 756100                    STQ     76,,PR0

      171     3554    2              B$JIT.NEXTCC=B$ROSEG.CR01ID.NOWIS;

   3554  1 000213   000000 471400 xsym               LDP1    B$JIT$
         1 000214   170000 376003                    ANQ     61440,DU
         1 000215   000014 772000                    QRL     12
         1 000216   100151 552120                    STBQ    105,'20'O,PR1

      172     3555    2              B$ROSEG.CR01ID=HIDEYHOLE;

   3555  1 000217   200011 236100                    LDQ     HIDEYHOLE,,AUTO
         1 000220   000114 756100                    STQ     76,,PR0

      173     3556    2              B$ROSEG.CR01ID.NOWIS=%CC_FROMXEQEND#;

   3556  1 000221   000002 376000 2                  ANQ     2
         1 000222   040000 276003                    ORQ     16384,DU
         1 000223   000114 756100                    STQ     76,,PR0

      174     3557    2              JDCB$->F$DCB.DVBYTE.TOP='1'B;

   3557  1 000224   200003 473500                    LDP3    JDCB$,,AUTO
         1 000225   400000 236003                    LDQ     -131072,DU
         1 000226   300003 256100                    ORSQ    3,,PR3

      175     3558    2            END;

   3554  1 000227                       USERRET      null
      176     3559    1   USERRET:;
      177     3560    1           B$JIT.DCB$=JDCB$;
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:31   

   3560  1 000227   200003 236100                    LDQ     JDCB$,,AUTO
         1 000230   000000 470400 xsym               LDP0    B$JIT$
         1 000231   000232 756100                    STQ     154,,PR0

      178     3561    1           IF NOT MYERROR THEN RETURN;

   3561  1 000232   200006 235100                    LDA     MYERROR,,AUTO
         1 000233   000235 601000 1                  TNZ     s:3562

   3561  1 000234   000000 702200 xent               TSX2  ! X66_ARET

      179     3562    1           B$JIT.ERR=MYERROR;

   3562  1 000235   200006 236100                    LDQ     MYERROR,,AUTO
         1 000236   000012 756100                    STQ     10,,PR0

      180     3563    1           ALTRETURN;

   3563  1 000237   000000 702200 xent               TSX2  ! X66_AALT

      181     3564        /**/
      182     3565    1   FSD$C1END: ENTRY ALTRET;

   3565  1 000240   000000 700200 xent  FSD$C1END    TSX0  ! X66_AUTO_0
         1 000241   000020 000000                    ZERO    16,0

      183     3566    1           JDCB$=B$JIT.DCB$;

   3566  1 000242   000000 470400 xsym               LDP0    B$JIT$
         1 000243   000232 236100                    LDQ     154,,PR0
         1 000244   200003 756100                    STQ     JDCB$,,AUTO

      184     3567    1           C1DCB$=PINCRW(B$ROSEG$,B$ROSEG.CR01DCB);

   3567  1 000245   000000 471400 xsym               LDP1    B$ROSEG$
         1 000246   100115 220100                    LDX0    77,,PR1
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:32   
         1 000247   000000 636010                    EAQ     0,X0
         1 000250   000000 036000 xsym               ADLQ    B$ROSEG$
         1 000251   200004 756100                    STQ     C1DCB$,,AUTO

      185     3568    1           B$JIT.DCB$=C1DCB$;

   3568  1 000252   000232 756100                    STQ     154,,PR0

      186     3569    1           CALL ENDJLOOK ALTRET(ERROR_CR01);

   3569  1 000253   001255 701000 1                  TSX1    ENDJLOOK
         1 000254   000257 702000 1                  TSX2    ERROR_CR01

      187     3570    1           MYERROR='0'B;

   3570  1 000255   200006 450100                    STZ     MYERROR,,AUTO

      188     3571    1           GOTO USERRET;

   3571  1 000256   000227 710000 1                  TRA     USERRET

   3570  1 000257                       ERROR_CR01   null
      189     3572        /**/
      190     3573    1   ERROR_CR01:;
      191     3574    1           MYERROR=B$JIT.ERR;

   3574  1 000257   000000 470400 xsym               LDP0    B$JIT$
         1 000260   000012 236100                    LDQ     10,,PR0
         1 000261   200006 756100                    STQ     MYERROR,,AUTO

      192     3575    2           IF C1DCB$~=ADDR(NIL) THEN DO;

   3575  1 000262   200004 236100                    LDQ     C1DCB$,,AUTO
         1 000263   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000264   000360 600000 1                  TZE     s:3596

      193     3576    2              IF C1DCB$->F$DCB.IASN=%FILE# THEN
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:33   

   3576  1 000265   200004 471500                    LDP1    C1DCB$,,AUTO
         1 000266   100103 236100                    LDQ     67,,PR1
         1 000267   000777 376007                    ANQ     511,DL
         1 000270   000001 116007                    CMPQ    1,DL
         1 000271   000276 601000 1                  TNZ     s:3578

      194     3577    2                 CALL FMP$CLSF(MYPN$);

   3577  1 000272   000003 630400 2                  EPPR0   3
         1 000273   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000274   000000 701000 xent               TSX1    FMP$CLSF
         1 000275   000000 011000                    NOP     0

      195     3578    3              IF C1DCB$~=DCBADDR(%M$UC#) THEN DO;

   3578  1 000276   000004 470400 2                  LDP0    4
         1 000277   000000 471500                    LDP1    0,,PR0
         1 000300   200004 236100                    LDQ     C1DCB$,,AUTO
         1 000301   100003 116100                    CMPQ    3,,PR1
         1 000302   000353 600000 1                  TZE     s:3592

      196     3579    3                 J = B$ROSEG.NUMDCBS;

   3579  1 000303   000000 473400 xsym               LDP3    B$ROSEG$
         1 000304   300002 236100                    LDQ     2,,PR3
         1 000305   000022 772000                    QRL     18
         1 000306   200010 756100                    STQ     J,,AUTO

      197     3580    4                 DO WHILE (J >= %M$MAXNEG#);

   3580  1 000307   000326 710000 1                  TRA     s:3587

      198     3581    4                    IF DCBADDR(J) ~= ADDR(NIL)

   3581  1 000310   000004 470400 2                  LDP0    4
         1 000311   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:34   
         1 000312   200010 720100                    LXL0    J,,AUTO
         1 000313   100000 236110                    LDQ     0,X0,PR1
         1 000314   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000315   000324 600000 1                  TZE     s:3586

      199     3582    4                    THEN
      200     3583    4                       IF DCBADDR(J) -> F$DCB.CFU$ = C1DCB$

   3583  1 000316   100000 473510                    LDP3    0,X0,PR1
         1 000317   300066 236100                    LDQ     54,,PR3
         1 000320   200004 116100                    CMPQ    C1DCB$,,AUTO
         1 000321   000324 601000 1                  TNZ     s:3586

      201     3584    4                       THEN
      202     3585    4                          DCBADDR(J) -> F$DCB.CFU$ = DCBADDR(%M$UC#);

   3585  1 000322   100003 236100                    LDQ     3,,PR1
         1 000323   300066 756100                    STQ     54,,PR3

      203     3586    4                    J = J - 1;

   3586  1 000324   000001 336007                    LCQ     1,DL
         1 000325   200010 056100                    ASQ     J,,AUTO

      204     3587    4                    END;

   3587  1 000326   200010 235100                    LDA     J,,AUTO
         1 000327   000005 115000 2                  CMPA    5
         1 000330   000310 605000 1                  TPL     s:3581

      205     3588    3                 CALL FSA$FDCB(C1DCB$);

   3588  1 000331   200004 633500                    EPPR3   C1DCB$,,AUTO
         1 000332   200016 453500                    STP3    FS$XEQSAVE+4,,AUTO
         1 000333   200016 630500                    EPPR0   FS$XEQSAVE+4,,AUTO
         1 000334   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000335   000000 701000 xent               TSX1    FSA$FDCB
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:35   
         1 000336   000000 011000                    NOP     0

      206     3589    3                 B$ROSEG.CR01DCB = POFFW(DCBADDR(%M$UC#),B$ROSEG$);

   3589  1 000337   000004 470400 2                  LDP0    4
         1 000340   000000 471500                    LDP1    0,,PR0
         1 000341   000000 235000 xsym               LDA     B$ROSEG$
         1 000342   000022 771000                    ARL     18
         1 000343   200016 755100                    STA     FS$XEQSAVE+4,,AUTO
         1 000344   100003 236100                    LDQ     3,,PR1
         1 000345   000022 772000                    QRL     18
         1 000346   200016 136100                    SBLQ    FS$XEQSAVE+4,,AUTO
         1 000347   000000 620006                    EAX0    0,QL
         1 000350   000000 473400 xsym               LDP3    B$ROSEG$
         1 000351   300115 740100                    STX0    77,,PR3

      207     3590    3                 END;

   3590  1 000352   000360 710000 1                  TRA     s:3596

      208     3591    3              ELSE DO;

      209     3592    3                 C1DCB$->F$DCB.FCD=%YES#;

   3592  1 000353   200004 473500                    LDP3    C1DCB$,,AUTO
         1 000354   020000 236007                    LDQ     8192,DL
         1 000355   300031 256100                    ORSQ    25,,PR3

      210     3593    3                 C1DCB$->F$DCB.IASN=0;

   3593  1 000356   000000 236003                    LDQ     0,DU
         1 000357   300103 552104                    STBQ    67,'04'O,PR3

      211     3594    3                 END;

      212     3595    2              END;

PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:36   
      213     3596    1           IF B$ROSEG.CR01ID.INT THEN

   3596  1 000360   000000 470400 xsym               LDP0    B$ROSEG$
         1 000361   000114 234100                    SZN     76,,PR0
         1 000362   000367 605000 1                  TPL     s:3599

      214     3597    1              B$JIT.NEXTCC=%CC_FROMUC#;

   3597  1 000363   000000 471400 xsym               LDP1    B$JIT$
         1 000364   000003 236003                    LDQ     3,DU
         1 000365   100151 552120                    STBQ    105,'20'O,PR1
         1 000366   000372 710000 1                  TRA     s:3600

      215     3598    1           ELSE
      216     3599    1              B$JIT.NEXTCC=%CC_FROMNO#;

   3599  1 000367   000000 471400 xsym               LDP1    B$JIT$
         1 000370   000000 236003                    LDQ     0,DU
         1 000371   100151 552120                    STBQ    105,'20'O,PR1

      217     3600    1           B$ROSEG.CR01ID.NOWIS=B$JIT.NEXTCC;

   3600  1 000372   100151 236100                    LDQ     105,,PR1
         1 000373   000014 736000                    QLS     12
         1 000374   000114 676100                    ERQ     76,,PR0
         1 000375   170000 376003                    ANQ     61440,DU
         1 000376   000114 656100                    ERSQ    76,,PR0

      218     3601    1           GOTO USERRET;

   3601  1 000377   000227 710000 1                  TRA     USERRET

      219     3602        /**/
      220     3603    1   FSD$REW: ENTRY ALTRET;

   3603  1 000400   000000 700200 xent  FSD$REW      TSX0  ! X66_AUTO_0
         1 000401   000020 000000                    ZERO    16,0
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:37   

      221     3604    2           DO CASE(B$ROSEG.CR01ID.NOWIS);

   3604  1 000402   000000 470400 xsym               LDP0    B$ROSEG$
         1 000403   000114 236100                    LDQ     76,,PR0
         1 000404   000036 772000                    QRL     30
         1 000405   000017 376007                    ANQ     15,DL
         1 000406   000005 116007                    CMPQ    5,DL
         1 000407   000411 602006 1                  TNC     s:3604+7,QL
         1 000410   000433 710000 1                  TRA     s:3613
         1 000411   000417 710000 1                  TRA     s:3608
         1 000412   000433 710000 1                  TRA     s:3613
         1 000413   000433 710000 1                  TRA     s:3613
         1 000414   000416 710000 1                  TRA     s:3606
         1 000415   000427 710000 1                  TRA     s:3611

      222     3605    2            CASE(%CC_FROMUC#); /* REW TERMINAL IS NOP.*/

      223     3606    2              RETURN;

   3606  1 000416   000000 702200 xent               TSX2  ! X66_ARET

      224     3607    2            CASE(%CC_FROMNO#); /* NO IS NOP OR REW BATCH CC FILE.*/

      225     3608    2              IF NOT B$ROSEG.CR01ID.JCL THEN RETURN;

   3608  1 000417   000114 236100                    LDQ     76,,PR0
         1 000420   200000 316003                    CANQ    65536,DU
         1 000421   000423 601000 1                  TNZ     s:3609

   3608  1 000422   000000 702200 xent               TSX2  ! X66_ARET

      226     3609    2              B$ROSEG.CR01ID.NOWIS=%CC_FROMJOB#;

   3609  1 000423   000002 376000 2                  ANQ     2
         1 000424   010000 276003                    ORQ     4096,DU
         1 000425   000114 756100                    STQ     76,,PR0
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:38   
         1 000426   000433 710000 1                  TRA     s:3613

      227     3610    2            CASE(%CC_FROMXEQEND#); /* XEQEND NEEDS TO BECOME XEQ.*/

      228     3611    2              B$ROSEG.CR01ID.NOWIS=%CC_FROMXEQ#;

   3611  1 000427   000114 236100                    LDQ     76,,PR0
         1 000430   000002 376000 2                  ANQ     2
         1 000431   020000 276003                    ORQ     8192,DU
         1 000432   000114 756100                    STQ     76,,PR0

      229     3612    2            END;

      230     3613    1           JDCB$=B$JIT.DCB$;

   3613  1 000433   000000 471400 xsym               LDP1    B$JIT$
         1 000434   100232 236100                    LDQ     154,,PR1
         1 000435   200003 756100                    STQ     JDCB$,,AUTO

      231     3614    1           C1DCB$=PINCRW(B$ROSEG$,B$ROSEG.CR01DCB);

   3614  1 000436   000115 220100                    LDX0    77,,PR0
         1 000437   000000 636010                    EAQ     0,X0
         1 000440   000000 036000 xsym               ADLQ    B$ROSEG$
         1 000441   200004 756100                    STQ     C1DCB$,,AUTO

      232     3615    1           B$JIT.DCB$=C1DCB$;

   3615  1 000442   100232 756100                    STQ     154,,PR1

      233     3616    1           IF C1DCB$->F$DCB.IASN=%FILE# THEN

   3616  1 000443   200004 473500                    LDP3    C1DCB$,,AUTO
         1 000444   300103 236100                    LDQ     67,,PR3
         1 000445   000777 376007                    ANQ     511,DL
         1 000446   000001 116007                    CMPQ    1,DL
         1 000447   000453 601000 1                  TNZ     s:3618
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:39   

      234     3617    1              CALL FMP$CLSF;

   3617  1 000450   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000451   000000 701000 xent               TSX1    FMP$CLSF
         1 000452   000000 011000                    NOP     0

      235     3618    1           C1DCB$->F$DCB.IASN=0;

   3618  1 000453   200004 470500                    LDP0    C1DCB$,,AUTO
         1 000454   000000 236003                    LDQ     0,DU
         1 000455   000103 552104                    STBQ    67,'04'O,PR0

      236     3619    1           IF C1DCB$=DCBADDR(%M$UC#) THEN

   3619  1 000456   000004 471400 2                  LDP1    4
         1 000457   100000 473500                    LDP3    0,,PR1
         1 000460   200004 236100                    LDQ     C1DCB$,,AUTO
         1 000461   300003 116100                    CMPQ    3,,PR3
         1 000462   000465 601000 1                  TNZ     s:3621

      237     3620    1              C1DCB$->F$DCB.FCD=%YES#;

   3620  1 000463   020000 236007                    LDQ     8192,DL
         1 000464   000031 256100                    ORSQ    25,,PR0

      238     3621    1           B$ROSEG.CR01ID.POSN=0;

   3621  1 000465   000000 474400 xsym               LDP4    B$ROSEG$
         1 000466   000000 236003                    LDQ     0,DU
         1 000467   400114 552134                    STBQ    76,'34'O,PR4

      239     3622    1           B$JIT.NEXTCC=B$ROSEG.CR01ID.NOWIS;

   3622  1 000470   000000 475400 xsym               LDP5    B$JIT$
         1 000471   400114 236100                    LDQ     76,,PR4
         1 000472   170000 376003                    ANQ     61440,DU
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:40   
         1 000473   000014 772000                    QRL     12
         1 000474   500151 552120                    STBQ    105,'20'O,PR5

      240     3623    1           B$JIT.DCB$=JDCB$;

   3623  1 000475   200003 236100                    LDQ     JDCB$,,AUTO
         1 000476   500232 756100                    STQ     154,,PR5

      241     3624    1           RETURN;

   3624  1 000477   000000 702200 xent               TSX2  ! X66_ARET

      242     3625        %EJECT;
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:41   
      243     3626    1   FSD$ENDJOB: ENTRY ALTRET;

   3626  1 000500   000000 700200 xent  FSD$ENDJOB   TSX0  ! X66_AUTO_0
         1 000501   000020 000000                    ZERO    16,0

      244     3627    2           IF B$ROSEG.CR01DCB=1 THEN DO;

   3627  1 000502   000000 470400 xsym               LDP0    B$ROSEG$
         1 000503   000115 220100                    LDX0    77,,PR0
         1 000504   000001 100003                    CMPX0   1,DU
         1 000505   000542 601000 1                  TNZ     s:3638

      245     3628    2              B$ROSEG.CR01ID='0'B;

   3628  1 000506   000114 450100                    STZ     76,,PR0

      246     3629    3              DO CASE(B$JIT.NEXTCC);

   3629  1 000507   000000 471400 xsym               LDP1    B$JIT$
         1 000510   100151 221100                    LDX1    105,,PR1
         1 000511   000777 361003                    ANX1    511,DU
         1 000512   000002 101003                    CMPX1   2,DU
         1 000513   000515 602011 1                  TNC     s:3629+6,X1
         1 000514   000526 710000 1                  TRA     s:3634
         1 000515   000526 710000 1                  TRA     s:3634
         1 000516   000517 710000 1                  TRA     s:3631

      247     3630    3               CASE(%CC_FROMJOB#);

      248     3631    3                 B$ROSEG.CR01ID.JCL='1'B;

   3631  1 000517   200000 236003                    LDQ     65536,DU
         1 000520   000114 256100                    ORSQ    76,,PR0

      249     3632    3                 B$ROSEG.CR01ID.NOWIS=%CC_FROMJOB#;

   3632  1 000521   000114 236100                    LDQ     76,,PR0
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:42   
         1 000522   000002 376000 2                  ANQ     2
         1 000523   010000 276003                    ORQ     4096,DU
         1 000524   000114 756100                    STQ     76,,PR0
         1 000525   000530 710000 1                  TRA     s:3636

      250     3633    3               CASE(ELSE);

      251     3634    3                 B$JIT.NEXTCC=%CC_FROMNO#;

   3634  1 000526   000000 236003                    LDQ     0,DU
         1 000527   100151 552120                    STBQ    105,'20'O,PR1

      252     3635    3               END;

      253     3636    2              B$ROSEG.CR01DCB=POFFW(DCBADDR(%M$UC#),B$ROSEG$);

   3636  1 000530   000004 473400 2                  LDP3    4
         1 000531   300000 474500                    LDP4    0,,PR3
         1 000532   000000 235000 xsym               LDA     B$ROSEG$
         1 000533   000022 771000                    ARL     18
         1 000534   200016 755100                    STA     FS$XEQSAVE+4,,AUTO
         1 000535   400003 236100                    LDQ     3,,PR4
         1 000536   000022 772000                    QRL     18
         1 000537   200016 136100                    SBLQ    FS$XEQSAVE+4,,AUTO
         1 000540   000000 620006                    EAX0    0,QL
         1 000541   000115 740100                    STX0    77,,PR0

      254     3637    2              END;

      255     3638    1           B$ROSEG.CR01ID.POSN=0;

   3638  1 000542   000000 236003                    LDQ     0,DU
         1 000543   000114 552134                    STBQ    76,'34'O,PR0

      256     3639    2           DO WHILE (B$ROSEG.CR01ID.NOWIS = %CC_FROMXEQ# AND

   3639  1 000544   000573 710000 1                  TRA     s:3648
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:43   

      257     3640    2             B$ROSEG.CR01ID.NOWIS=%CC_FROMXEQEND#);
      258     3641    2              IF B$ROSEG.CR01DCB=0 THEN

   3641  1 000545   000000 470400 xsym               LDP0    B$ROSEG$
         1 000546   000115 220100                    LDX0    77,,PR0
         1 000547   000553 601000 1                  TNZ     s:3643

      259     3642    2                 CALL FSD$C1GETDCB ALTRET(ENDJALT2);

   3642  1 000550   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000551   000000 701000 xent               TSX1    FSD$C1GETDCB
         1 000552   000654 702000 1                  TSX2    ENDJALT2

      260     3643    2              C1DCB$=PINCRW(B$ROSEG$,B$ROSEG.CR01DCB);

   3643  1 000553   000000 470400 xsym               LDP0    B$ROSEG$
         1 000554   000115 220100                    LDX0    77,,PR0
         1 000555   000000 636010                    EAQ     0,X0
         1 000556   000000 036000 xsym               ADLQ    B$ROSEG$
         1 000557   200004 756100                    STQ     C1DCB$,,AUTO

      261     3644    2              B$JIT.DCB$=C1DCB$;

   3644  1 000560   000000 471400 xsym               LDP1    B$JIT$
         1 000561   100232 756100                    STQ     154,,PR1

      262     3645    2              IF C1DCB$->F$DCB.IASN~=%FILE# THEN

   3645  1 000562   200004 473500                    LDP3    C1DCB$,,AUTO
         1 000563   300103 236100                    LDQ     67,,PR3
         1 000564   000777 376007                    ANQ     511,DL
         1 000565   000001 116007                    CMPQ    1,DL
         1 000566   000571 600000 1                  TZE     s:3647

      263     3646    2                 CALL OPENDCB ALTRET(ENDJALTR);

PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:44   
   3646  1 000567   001004 701000 1                  TSX1    OPENDCB
         1 000570   000641 702000 1                  TSX2    ENDJALTR

      264     3647    2              CALL ENDJLOOK ALTRET(ERROR_CR01);

   3647  1 000571   001255 701000 1                  TSX1    ENDJLOOK
         1 000572   000257 702000 1                  TSX2    ERROR_CR01

      265     3648    2              END;

   3648  1 000573   000000 470400 xsym               LDP0    B$ROSEG$
         1 000574   000114 236100                    LDQ     76,,PR0
         1 000575   170000 376003                    ANQ     61440,DU
         1 000576   020000 116003                    CMPQ    8192,DU
         1 000577   000602 601000 1                  TNZ     ENDJJCL
         1 000600   040000 116003                    CMPQ    16384,DU
         1 000601   000545 600000 1                  TZE     s:3641

   3645  1 000602                       ENDJJCL      null
      266     3649    1   ENDJJCL:;
      267     3650    2           IF B$ROSEG.CR01ID.JCL THEN DO;

   3650  1 000602   000000 470400 xsym               LDP0    B$ROSEG$
         1 000603   000114 236100                    LDQ     76,,PR0
         1 000604   200000 316003                    CANQ    65536,DU
         1 000605   000637 600000 1                  TZE     s:3661

      268     3651    2              C1DCB$=PINCRW(B$ROSEG$,B$ROSEG.CR01DCB);

   3651  1 000606   000115 220100                    LDX0    77,,PR0
         1 000607   000000 636010                    EAQ     0,X0
         1 000610   000000 036000 xsym               ADLQ    B$ROSEG$
         1 000611   200004 756100                    STQ     C1DCB$,,AUTO

      269     3652    2              B$JIT.DCB$=C1DCB$;

   3652  1 000612   000000 471400 xsym               LDP1    B$JIT$
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:45   
         1 000613   100232 756100                    STQ     154,,PR1

      270     3653    2              CALL OPENDCB ALTRET(ALTRETUR);

   3653  1 000614   001004 701000 1                  TSX1    OPENDCB
         1 000615   000640 702000 1                  TSX2    ALTRETUR

      271     3654    2              CALL FMP$CLSF(MYPN$);

   3654  1 000616   000003 630400 2                  EPPR0   3
         1 000617   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000620   000000 701000 xent               TSX1    FMP$CLSF
         1 000621   000000 011000                    NOP     0

      272     3655    2              B$JIT.NEXTCC=%CC_FROMNO#;

   3655  1 000622   000000 470400 xsym               LDP0    B$JIT$
         1 000623   000000 236003                    LDQ     0,DU
         1 000624   000151 552120                    STBQ    105,'20'O,PR0

      273     3656    2              B$ROSEG.CR01ID.NOWIS=%CC_FROMNO#;

   3656  1 000625   000000 471400 xsym               LDP1    B$ROSEG$
         1 000626   000002 236000 2                  LDQ     2
         1 000627   100114 356100                    ANSQ    76,,PR1

      274     3657    2              B$ROSEG.CR01ID.JCL=%NO#;

   3657  1 000630   000006 236000 2                  LDQ     6
         1 000631   100114 356100                    ANSQ    76,,PR1

      275     3658    2              C1DCB$->F$DCB.FCD=%YES#;

   3658  1 000632   200004 473500                    LDP3    C1DCB$,,AUTO
         1 000633   020000 236007                    LDQ     8192,DL
         1 000634   300031 256100                    ORSQ    25,,PR3

PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:46   
      276     3659    2              C1DCB$->F$DCB.IASN=0;

   3659  1 000635   000000 236003                    LDQ     0,DU
         1 000636   300103 552104                    STBQ    67,'04'O,PR3

      277     3660    2              END;

      278     3661    1           RETURN;

   3661  1 000637   000000 702200 xent               TSX2  ! X66_ARET

      279     3662    1   ALTRETUR: ALTRETURN;

   3662  1 000640   000000 702200 xent  ALTRETUR     TSX2  ! X66_AALT

   3656  1 000641                       ENDJALTR     null
      280     3663    1   ENDJALTR:;
      281     3664    1           IF C1DCB$~=DCBADDR(%M$UC#) THEN

   3664  1 000641   000004 470400 2                  LDP0    4
         1 000642   000000 471500                    LDP1    0,,PR0
         1 000643   200004 236100                    LDQ     C1DCB$,,AUTO
         1 000644   100003 116100                    CMPQ    3,,PR1
         1 000645   000654 600000 1                  TZE     ENDJALT2

      282     3665    1              CALL FSA$FDCB(C1DCB$);

   3665  1 000646   200004 633500                    EPPR3   C1DCB$,,AUTO
         1 000647   200016 453500                    STP3    FS$XEQSAVE+4,,AUTO
         1 000650   200016 630500                    EPPR0   FS$XEQSAVE+4,,AUTO
         1 000651   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000652   000000 701000 xent               TSX1    FSA$FDCB
         1 000653   000000 011000                    NOP     0

   3664  1 000654                       ENDJALT2     null
      283     3666    1   ENDJALT2:;
      284     3667    2           IF B$ROSEG.CR01ID.INT THEN DO;
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:47   

   3667  1 000654   000000 470400 xsym               LDP0    B$ROSEG$
         1 000655   000114 234100                    SZN     76,,PR0
         1 000656   000666 605000 1                  TPL     s:3672

      285     3668    2              B$ROSEG.CR01DCB=0;

   3668  1 000657   000000 220003                    LDX0    0,DU
         1 000660   000115 740100                    STX0    77,,PR0

      286     3669    2              B$ROSEG.CR01ID.NOWIS=%CC_FROMUC#;

   3669  1 000661   000114 236100                    LDQ     76,,PR0
         1 000662   000002 376000 2                  ANQ     2
         1 000663   030000 276003                    ORQ     12288,DU
         1 000664   000114 756100                    STQ     76,,PR0

      287     3670    2              END;

   3670  1 000665   000670 710000 1                  TRA     s:3673

      288     3671    1           ELSE
      289     3672    1              B$ROSEG.CR01ID.NOWIS=%CC_FROMNO#;

   3672  1 000666   000002 236000 2                  LDQ     2
         1 000667   000114 356100                    ANSQ    76,,PR0

      290     3673    1           B$JIT.NEXTCC=B$ROSEG.CR01ID.NOWIS;

   3673  1 000670   000000 471400 xsym               LDP1    B$JIT$
         1 000671   000114 236100                    LDQ     76,,PR0
         1 000672   170000 376003                    ANQ     61440,DU
         1 000673   000014 772000                    QRL     12
         1 000674   100151 552120                    STBQ    105,'20'O,PR1

      291     3674    1           GOTO ENDJJCL;

PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:48   
   3674  1 000675   000602 710000 1                  TRA     ENDJJCL

      292     3675    1   FSD$XFLUSH: ENTRY ALTRET;

   3675  1 000676   000000 700200 xent  FSD$XFLUSH   TSX0  ! X66_AUTO_0
         1 000677   000020 000000                    ZERO    16,0

      293     3676    2           DO WHILE (B$ROSEG.CR01ID.NOWIS=%CC_FROMXEQ# OR

   3676  1 000700   000737 710000 1                  TRA     s:3690

      294     3677    2             B$ROSEG.CR01ID.NOWIS=%CC_FROMXEQEND#);
      295     3678    2              IF B$ROSEG.CR01DCB=0 THEN

   3678  1 000701   000000 470400 xsym               LDP0    B$ROSEG$
         1 000702   000115 220100                    LDX0    77,,PR0
         1 000703   000707 601000 1                  TNZ     s:3680

      296     3679    2                 CALL FSD$C1GETDCB ALTRET(ALTRETUR);

   3679  1 000704   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000705   000000 701000 xent               TSX1    FSD$C1GETDCB
         1 000706   000640 702000 1                  TSX2    ALTRETUR

      297     3680    2              C1DCB$=PINCRW(B$ROSEG$,B$ROSEG.CR01DCB);

   3680  1 000707   000000 470400 xsym               LDP0    B$ROSEG$
         1 000710   000115 220100                    LDX0    77,,PR0
         1 000711   000000 636010                    EAQ     0,X0
         1 000712   000000 036000 xsym               ADLQ    B$ROSEG$
         1 000713   200004 756100                    STQ     C1DCB$,,AUTO

      298     3681    2              B$JIT.DCB$=C1DCB$;

   3681  1 000714   000000 471400 xsym               LDP1    B$JIT$
         1 000715   100232 756100                    STQ     154,,PR1

PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:49   
      299     3682    2              IF C1DCB$->F$DCB.IASN~=%FILE# THEN

   3682  1 000716   200004 473500                    LDP3    C1DCB$,,AUTO
         1 000717   300103 236100                    LDQ     67,,PR3
         1 000720   000777 376007                    ANQ     511,DL
         1 000721   000001 116007                    CMPQ    1,DL
         1 000722   000725 600000 1                  TZE     s:3684

      300     3683    2                 CALL OPENDCB ALTRET(ERROR_CR01);

   3683  1 000723   001004 701000 1                  TSX1    OPENDCB
         1 000724   000257 702000 1                  TSX2    ERROR_CR01

      301     3684    2              CALL ENDJLOOK ALTRET(ERROR_CR01);

   3684  1 000725   001255 701000 1                  TSX1    ENDJLOOK
         1 000726   000257 702000 1                  TSX2    ERROR_CR01

      302     3685    2              CALL HFF$NILERASE (B$PS0$)

   3685  1 000727   000007 630400 2                  EPPR0   7
         1 000730   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000731   000000 701000 xent               TSX1    HFF$NILERASE
         1 000732   000737 702000 1                  TSX2    s:3690

      303     3686    3              WHENRETURN DO;

      304     3687    3                 IF FPT$XFLUSH_V.ONELEVEL

   3687  1 000733   000000 470400 xsym               LDP0    B$PS0$
         1 000734   000000 234100                    SZN     0,,PR0
         1 000735   000737 605000 1                  TPL     s:3690

      305     3688    3                 THEN RETURN;

   3688  1 000736   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:50   
      306     3689    3                 END;
      307     3690    2              END;

   3690  1 000737   000000 470400 xsym               LDP0    B$ROSEG$
         1 000740   000114 236100                    LDQ     76,,PR0
         1 000741   170000 376003                    ANQ     61440,DU
         1 000742   020000 116003                    CMPQ    8192,DU
         1 000743   000701 600000 1                  TZE     s:3678
         1 000744   040000 116003                    CMPQ    16384,DU
         1 000745   000701 600000 1                  TZE     s:3678

      308     3691    1   CHKJ:
      309     3692    2           IF B$ROSEG.CR01ID.NOWIS=%CC_FROMJOB# THEN DO;

   3692  1 000746   010000 116003       CHKJ         CMPQ    4096,DU
         1 000747   001003 601000 1                  TNZ     s:3703

      310     3693    3              IF DCBADDR(%M$UC#)->F$DCB.IASN=%FILE# THEN DO;

   3693  1 000750   000004 471400 2                  LDP1    4
         1 000751   100000 473500                    LDP3    0,,PR1
         1 000752   300003 474500                    LDP4    3,,PR3
         1 000753   400103 236100                    LDQ     67,,PR4
         1 000754   000777 376007                    ANQ     511,DL
         1 000755   000001 116007                    CMPQ    1,DL
         1 000756   000775 601000 1                  TNZ     s:3700

      311     3694    3                 C1DCB$=PINCRW(B$ROSEG$,B$ROSEG.CR01DCB);

   3694  1 000757   000115 220100                    LDX0    77,,PR0
         1 000760   000000 636010                    EAQ     0,X0
         1 000761   000000 036000 xsym               ADLQ    B$ROSEG$
         1 000762   200004 756100                    STQ     C1DCB$,,AUTO

      312     3695    3                 B$JIT.DCB$=C1DCB$;

   3695  1 000763   000000 475400 xsym               LDP5    B$JIT$
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:51   
         1 000764   500232 756100                    STQ     154,,PR5

      313     3696    3                 CALL FMP$CLSF;

   3696  1 000765   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000766   000000 701000 xent               TSX1    FMP$CLSF
         1 000767   000000 011000                    NOP     0

      314     3697    3                 C1DCB$->F$DCB.IASN=0;

   3697  1 000770   200004 470500                    LDP0    C1DCB$,,AUTO
         1 000771   000000 236003                    LDQ     0,DU
         1 000772   000103 552104                    STBQ    67,'04'O,PR0

      315     3698    3                 C1DCB$->F$DCB.FCD=%YES#;

   3698  1 000773   020000 236007                    LDQ     8192,DL
         1 000774   000031 256100                    ORSQ    25,,PR0

      316     3699    3                 END;

      317     3700    2              B$ROSEG.CR01ID.NOWIS=%CC_FROMNO#;

   3700  1 000775   000000 470400 xsym               LDP0    B$ROSEG$
         1 000776   000002 236000 2                  LDQ     2
         1 000777   000114 356100                    ANSQ    76,,PR0

      318     3701    2              B$JIT.NEXTCC=%CC_FROMNO#;

   3701  1 001000   000000 471400 xsym               LDP1    B$JIT$
         1 001001   000000 236003                    LDQ     0,DU
         1 001002   100151 552120                    STBQ    105,'20'O,PR1

      319     3702    2              END;

      320     3703    1           RETURN;

PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:52   
   3703  1 001003   000000 702200 xent               TSX2  ! X66_ARET

      321     3704        %EJECT;
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:53   
      322     3705        /**** * * * * ****/
      323     3706    1   OPENDCB:PROC ALTRET;

   3706  1 001004   200014 741300       OPENDCB      STX1  ! FS$XEQSAVE+2,,AUTO

      324     3707        /*      OPENDCB opens the control command file DCB and positions it
      325     3708         *         to the right place for the next read.
      326     3709         */
      327     3710    2           B$JIT.ERR='0'B;

   3710  1 001005   000000 470400 xsym               LDP0    B$JIT$
         1 001006   000012 450100                    STZ     10,,PR0

      328     3711    2           IF B$ROSEG.CR01ID.INT THEN

   3711  1 001007   000000 471400 xsym               LDP1    B$ROSEG$
         1 001010   100114 234100                    SZN     76,,PR1
         1 001011   001016 605000 1                  TPL     s:3714

      329     3712    2              CALL FMM$DFLOPNP;

   3712  1 001012   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001013   000000 701000 xent               TSX1    FMM$DFLOPNP
         1 001014   000000 011000                    NOP     0
         1 001015   001110 710000 1                  TRA     s:3740

      330     3713    3           ELSE DO;

      331     3714    3              C1DCB$->F$DCB.ASN=%FILE#;

   3714  1 001016   200004 473500                    LDP3    C1DCB$,,AUTO
         1 001017   001000 236007                    LDQ     512,DL
         1 001020   300032 552110                    STBQ    26,'10'O,PR3

      332     3715    3              C1DCB$->F$DCB.RES=' ';

   3715  1 001021   000035 236000 xsym               LDQ     B_VECTNIL+29
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:54   
         1 001022   300026 756100                    STQ     22,,PR3

      333     3716    3              C1DCB$->F$DCB.PSN=' ';

   3716  1 001023   040100 100400                    MLR     fill='040'O
         1 001024   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 001025   300024 000006                    ADSC9   20,,PR3                  cn=0,n=6

      334     3717    4              IF B$ROSEG.CR01ID.NOWIS=%CC_FROMXEQ# THEN DO;

   3717  1 001026   100114 236100                    LDQ     76,,PR1
         1 001027   170000 376003                    ANQ     61440,DU
         1 001030   020000 116003                    CMPQ    8192,DU
         1 001031   001043 601000 1                  TNZ     s:3723

      335     3718    4                 C1DCB$->F$DCB.NAME.L=2;

   3718  1 001032   002000 236003                    LDQ     1024,DU
         1 001033   300010 552140                    STBQ    8,'40'O,PR3

      336     3719    4                 C1DCB$->F$DCB.NAME.C='*X';

   3719  1 001034   040100 100400                    MLR     fill='040'O
         1 001035   000041 000002 0                  ADSC9   ERR$EOF+1                cn=0,n=2
         1 001036   300010 200037                    ADSC9   8,,PR3                   cn=1,n=31

      337     3720    4                 C1DCB$->F$DCB.ACCT=' ';

   3720  1 001037   000035 235000 xsym               LDA     B_VECTNIL+29
         1 001040   000035 236000 xsym               LDQ     B_VECTNIL+29
         1 001041   300020 757100                    STAQ    16,,PR3

      338     3721    4                 END;

   3721  1 001042   001061 710000 1                  TRA     s:3729

      339     3722    4              ELSE DO;
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:55   

      340     3723    4                 C1DCB$->F$DCB.NAME.L=7;

   3723  1 001043   007000 236003                    LDQ     3584,DU
         1 001044   300010 552140                    STBQ    8,'40'O,PR3

      341     3724    4                 C1DCB$->F$DCB.NAME.C='xxxxxxS';

   3724  1 001045   040100 100400                    MLR     fill='040'O
         1 001046   000042 000007 0                  ADSC9   ERR$EOF+2                cn=0,n=7
         1 001047   300010 200037                    ADSC9   8,,PR3                   cn=1,n=31

      342     3725    4                 J=B$JIT.SYSID;

   3725  1 001050   000000 236100                    LDQ     0,,PR0
         1 001051   777777 376007                    ANQ     -1,DL
         1 001052   200010 756100                    STQ     J,,AUTO

      343     3726    4                 CALL BINCHAR(SUBSTR(C1DCB$->F$DCB.NAME.C,0,6),J);

   3726  1 001053   000100 301500                    BTD
         1 001054   200010 000004                    NDSC9   J,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
         1 001055   300010 230006                    NDSC9   8,,PR3                   cn=1,s=nosgn,sf=0,n=6

      344     3727    4                 C1DCB$->F$DCB.ACCT=':SYMI';

   3727  1 001056   040100 100400                    MLR     fill='040'O
         1 001057   000044 000005 0                  ADSC9   ERR$EOF+4                cn=0,n=5
         1 001060   300020 000010                    ADSC9   16,,PR3                  cn=0,n=8

      345     3728    4                 END;

      346     3729    3              C1DCB$->F$DCB.FUN=%UPDATE#;

   3729  1 001061   000001 236003                    LDQ     1,DU
         1 001062   300032 552120                    STBQ    26,'20'O,PR3

PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:56   
      347     3730    3              CALL FMM$DFLOPNP;

   3730  1 001063   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001064   000000 701000 xent               TSX1    FMM$DFLOPNP
         1 001065   000000 011000                    NOP     0

      348     3731    4              IF NOT C1DCB$->F$DCB.FCD THEN DO;

   3731  1 001066   200004 470500                    LDP0    C1DCB$,,AUTO
         1 001067   000031 236100                    LDQ     25,,PR0
         1 001070   020000 316007                    CANQ    8192,DL
         1 001071   001076 601000 1                  TNZ     s:3735

      349     3732    4                 C1DCB$->F$DCB.IASN=0;

   3732  1 001072   000000 236003                    LDQ     0,DU
         1 001073   000103 552104                    STBQ    67,'04'O,PR0

      350     3733    4                 C1DCB$->F$DCB.FCD=%YES#;

   3733  1 001074   020000 236007                    LDQ     8192,DL
         1 001075   000031 256100                    ORSQ    25,,PR0

      351     3734    4                 END;

      352     3735    3              C1DCB$->F$DCB.ASN=%DEVICE#;

   3735  1 001076   003000 236007                    LDQ     1536,DL
         1 001077   000032 552110                    STBQ    26,'10'O,PR0

      353     3736    3              C1DCB$->F$DCB.RES='NO';

   3736  1 001100   000046 236000 0                  LDQ     ERR$EOF+6
         1 001101   777777 376003                    ANQ     -1,DU
         1 001102   040040 276007                    ORQ     16416,DL
         1 001103   000026 756100                    STQ     22,,PR0

PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:57   
      354     3737    3              C1DCB$->F$DCB.IFMT=FMTNO#;

   3737  1 001104   007000 236003                    LDQ     3584,DU
         1 001105   000103 552140                    STBQ    67,'40'O,PR0

      355     3738    3              C1DCB$->F$DCB.FFLG=%FFLG_OWNER#;

   3738  1 001106   765700 220003                    LDX0    -5184,DU
         1 001107   000004 740100                    STX0    4,,PR0

      356     3739    3              END;

      357     3740    2           IF B$JIT.ERR.CODE~=0 THEN ALTRETURN;

   3740  1 001110   000000 470400 xsym               LDP0    B$JIT$
         1 001111   000012 236100                    LDQ     10,,PR0
         1 001112   377770 316007                    CANQ    131064,DL
         1 001113   001116 600000 1                  TZE     s:3741

   3740  1 001114   200014 221300                    LDX1  ! FS$XEQSAVE+2,,AUTO
         1 001115   000000 702211                    TSX2  ! 0,X1

      358     3741    2           C1DCB$->F$DCB.WAIT=1;

   3741  1 001116   200004 471500                    LDP1    C1DCB$,,AUTO
         1 001117   000020 236007                    LDQ     16,DL
         1 001120   100064 256100                    ORSQ    52,,PR1

      359     3742    2           IF B$ROSEG.CR01ID.NOWIS=%CC_FROMXEQ# THEN

   3742  1 001121   000000 473400 xsym               LDP3    B$ROSEG$
         1 001122   300114 236100                    LDQ     76,,PR3
         1 001123   170000 376003                    ANQ     61440,DU
         1 001124   020000 116003                    CMPQ    8192,DU
         1 001125   001130 601000 1                  TNZ     s:3744

      360     3743    2              C1DCB$->F$DCB.DDEV=%DDEV_XEQ#;
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:58   

   3743  1 001126   040000 236007                    LDQ     16384,DL
         1 001127   100004 552110                    STBQ    4,'10'O,PR1

      361     3744    3           IF B$ROSEG.CR01ID.POSN~=0 THEN DO;

   3744  1 001130   300114 236100                    LDQ     76,,PR3
         1 001131   000032 316000 xsym               CANQ    B_VECTNIL+26
         1 001132   001143 600000 1                  TZE     s:3748

      362     3745    3              C1DCB$->F$DCB.UBYTES=B$ROSEG.CR01ID.POSN;

   3745  1 001133   200004 471500                    LDP1    C1DCB$,,AUTO
         1 001134   300114 236100                    LDQ     76,,PR3
         1 001135   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 001136   100076 756100                    STQ     62,,PR1

      363     3746    3              CALL FMH$PREC(FPTPREC) ALTRET(ALTRETUR);

   3746  1 001137   000010 630400 2                  EPPR0   8
         1 001140   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001141   000000 701000 xent               TSX1    FMH$PREC
         1 001142   001145 702000 1                  TSX2    ALTRETUR

      364     3747    3              END;

      365     3748    2           RETURN;

   3748  1 001143   200014 221300                    LDX1  ! FS$XEQSAVE+2,,AUTO
         1 001144   000001 702211                    TSX2  ! 1,X1

   3744  1 001145                       ALTRETUR     null
      366     3749    2   ALTRETUR:;
      367     3750    2           ALTRETURN;

   3750  1 001145   200014 221300                    LDX1  ! FS$XEQSAVE+2,,AUTO
         1 001146   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:59   

      368     3751    2   END;
      369     3752        /**** * * * * ****/
      370     3753    1   LOOKAHEAD: PROC ALTRET;

   3753  1 001147   200014 741300       LOOKAHEAD    STX1  ! FS$XEQSAVE+2,,AUTO

      371     3754        /*      LOOKAHEAD gets next control command's DVBYTE into "secret" DCB.
      372     3755         *         If there is one, Return with J=0.
      373     3756         *         If no next record, get control command file's FIT.CODE11
      374     3757         *         which tells where to go back to to find next record to read,
      375     3758         *         and close "secret" DCB.
      376     3759         *         If next record is to come from another control command file,
      377     3760         *         set file's name into "secret" DCB filename and set record #
      378     3761         *         to position to into ROSEG, and Return with J=1.
      379     3762         *         If next record not from another control command file, mark
      380     3763         *         all user DCB's pointing to "secret" DCB closed and free
      381     3764         *         ROSEG space of "secret" DCB.  Then set identity of new place
      382     3765         *         into CR01 identity in ROSEG and set new place positioning
      383     3766         *         into ROSEG.  Then Return with J=2.
      384     3767         *         If errors occur during any of this processing, Return with
      385     3768         *         J=3.
      386     3769         */
      387     3770    2           C1DCB$->F$DCB.ARS=0;

   3770  1 001150   200004 470500                    LDP0    C1DCB$,,AUTO
         1 001151   000000 450100                    STZ     0,,PR0

      388     3771    2           C1DCB$->F$DCB.TYC(1)='0'B;

   3771  1 001152   200004 470500                    LDP0    C1DCB$,,AUTO
         1 001153   000002 450100                    STZ     2,,PR0

      389     3772    2           CALL FMH$LOOKAHD ALTRET(ENDOFFILE);

   3772  1 001154   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001155   000000 701000 xent               TSX1    FMH$LOOKAHD
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:60   
         1 001156   001162 702000 1                  TSX2    ENDOFFILE

      390     3773    2           J=0;

   3773  1 001157   200010 450100                    STZ     J,,AUTO

      391     3774    2           RETURN;

   3774  1 001160   200014 221300                    LDX1  ! FS$XEQSAVE+2,,AUTO
         1 001161   000001 702211                    TSX2  ! 1,X1

   3773  1 001162                       ENDOFFILE    null
      392     3775    2   ENDOFFILE:;
      393     3776    2           IF B$JIT.ERR.CODE~=%E$EOF THEN GOTO JIS2;

   3776  1 001162   000000 470400 xsym               LDP0    B$JIT$
         1 001163   000012 236100                    LDQ     10,,PR0
         1 001164   377770 376007                    ANQ     131064,DL
         1 001165   000060 116007                    CMPQ    48,DL
         1 001166   001253 601000 1                  TNZ     JIS2

      394     3777    3           IF B$ROSEG.CR01ID.NOWIS~=%CC_FROMXEQ# THEN DO;

   3777  1 001167   000000 471400 xsym               LDP1    B$ROSEG$
         1 001170   100114 236100                    LDQ     76,,PR1
         1 001171   170000 376003                    ANQ     61440,DU
         1 001172   020000 116003                    CMPQ    8192,DU
         1 001173   001216 600000 1                  TZE     s:3786

      395     3778    3              CALL FMP$CLSF;

   3778  1 001174   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001175   000000 701000 xent               TSX1    FMP$CLSF
         1 001176   000000 011000                    NOP     0

      396     3779    3              C1DCB$->F$DCB.IASN=0;

PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:61   
   3779  1 001177   200004 470500                    LDP0    C1DCB$,,AUTO
         1 001200   000000 236003                    LDQ     0,DU
         1 001201   000103 552104                    STBQ    67,'04'O,PR0

      397     3780    3              C1DCB$->F$DCB.FCD=%YES#;

   3780  1 001202   020000 236007                    LDQ     8192,DL
         1 001203   000031 256100                    ORSQ    25,,PR0

      398     3781    3              B$ROSEG.CR01ID.NOWIS=%CC_FROMNO#;

   3781  1 001204   000000 471400 xsym               LDP1    B$ROSEG$
         1 001205   000002 236000 2                  LDQ     2
         1 001206   100114 356100                    ANSQ    76,,PR1

      399     3782    3              B$JIT.NEXTCC=%CC_FROMNO#;

   3782  1 001207   000000 473400 xsym               LDP3    B$JIT$
         1 001210   000000 236003                    LDQ     0,DU
         1 001211   300151 552120                    STBQ    105,'20'O,PR3

      400     3783    3              J=2;

   3783  1 001212   000002 235007                    LDA     2,DL
         1 001213   200010 755100                    STA     J,,AUTO

      401     3784    3              RETURN;

   3784  1 001214   200014 221300                    LDX1  ! FS$XEQSAVE+2,,AUTO
         1 001215   000001 702211                    TSX2  ! 1,X1

      402     3785    3              END;
      403     3786    2           J=1;

   3786  1 001216   000001 235007                    LDA     1,DL
         1 001217   200010 755100                    STA     J,,AUTO

PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:62   
      404     3787    2           CALL FMN$GETFIT(FIT$,J) ALTRET(JIS2);

   3787  1 001220   200010 633500                    EPPR3   J,,AUTO
         1 001221   200017 453500                    STP3    FS$XEQSAVE+5,,AUTO
         1 001222   200007 634500                    EPPR4   FIT$,,AUTO
         1 001223   200016 454500                    STP4    FS$XEQSAVE+4,,AUTO
         1 001224   200016 630500                    EPPR0   FS$XEQSAVE+4,,AUTO
         1 001225   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001226   000000 701000 xent               TSX1    FMN$GETFIT
         1 001227   001253 702000 1                  TSX2    JIS2

      405     3788    2           FIT$=PINCRW(FIT$,SIZEW(FM$GRAN));

   3788  1 001230   200007 236100                    LDQ     FIT$,,AUTO
         1 001231   000005 036003                    ADLQ    5,DU
         1 001232   200007 756100                    STQ     FIT$,,AUTO

      406     3789    2           CALL FMO$LOCCODP(FIT$,11)ALTRET(JIS2);

   3789  1 001233   000011 236000 2                  LDQ     9
         1 001234   200017 756100                    STQ     FS$XEQSAVE+5,,AUTO
         1 001235   200007 630500                    EPPR0   FIT$,,AUTO
         1 001236   200016 450500                    STP0    FS$XEQSAVE+4,,AUTO
         1 001237   200016 630500                    EPPR0   FS$XEQSAVE+4,,AUTO
         1 001240   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001241   000000 701000 xent               TSX1    FMO$LOCCODP
         1 001242   001253 702000 1                  TSX2    JIS2

      407     3790    2           FS$XEQSAVE=FIT$->UATTRWORDS;

   3790  1 001243   200007 470500                    LDP0    FIT$,,AUTO
         1 001244   000100 100500                    MLR     fill='000'O
         1 001245   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         1 001246   200012 000010                    ADSC9   FS$XEQSAVE,,AUTO         cn=0,n=8

      408     3791    2           J=4;

PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:63   
   3791  1 001247   000004 235007                    LDA     4,DL
         1 001250   200010 755100                    STA     J,,AUTO

      409     3792    2           RETURN;

   3792  1 001251   200014 221300                    LDX1  ! FS$XEQSAVE+2,,AUTO
         1 001252   000001 702211                    TSX2  ! 1,X1

      410     3793    2   JIS2:   ALTRETURN;

   3793  1 001253   200014 221300       JIS2         LDX1  ! FS$XEQSAVE+2,,AUTO
         1 001254   000000 702211                    TSX2  ! 0,X1

      411     3794    2   END LOOKAHEAD;
      412     3795        /**/
      413     3796    1   ENDJLOOK: PROC ALTRET;

   3796  1 001255   200014 741300       ENDJLOOK     STX1  ! FS$XEQSAVE+2,,AUTO

      414     3797    2           J=1;

   3797  1 001256   000001 235007                    LDA     1,DL
         1 001257   200010 755100                    STA     J,,AUTO

      415     3798    2           CALL FMN$GETFIT(FIT$,J) ALTRET(JIS2);

   3798  1 001260   200010 630500                    EPPR0   J,,AUTO
         1 001261   200017 450500                    STP0    FS$XEQSAVE+5,,AUTO
         1 001262   200007 631500                    EPPR1   FIT$,,AUTO
         1 001263   200016 451500                    STP1    FS$XEQSAVE+4,,AUTO
         1 001264   200016 630500                    EPPR0   FS$XEQSAVE+4,,AUTO
         1 001265   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001266   000000 701000 xent               TSX1    FMN$GETFIT
         1 001267   001437 702000 1                  TSX2    JIS2

      416     3799    2           FIT$=PINCRW(FIT$,SIZEW(FM$GRAN));

PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:64   
   3799  1 001270   200007 236100                    LDQ     FIT$,,AUTO
         1 001271   000005 036003                    ADLQ    5,DU
         1 001272   200007 756100                    STQ     FIT$,,AUTO

      417     3800    2           CALL FMO$LOCCODP(FIT$,11)ALTRET(JIS2);

   3800  1 001273   000011 236000 2                  LDQ     9
         1 001274   200017 756100                    STQ     FS$XEQSAVE+5,,AUTO
         1 001275   200007 630500                    EPPR0   FIT$,,AUTO
         1 001276   200016 450500                    STP0    FS$XEQSAVE+4,,AUTO
         1 001277   200016 630500                    EPPR0   FS$XEQSAVE+4,,AUTO
         1 001300   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001301   000000 701000 xent               TSX1    FMO$LOCCODP
         1 001302   001437 702000 1                  TSX2    JIS2

      418     3801    2           FS$XEQSAVE=FIT$->UATTRWORDS;

   3801  1 001303   200007 470500                    LDP0    FIT$,,AUTO
         1 001304   000100 100500                    MLR     fill='000'O
         1 001305   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         1 001306   200012 000010                    ADSC9   FS$XEQSAVE,,AUTO         cn=0,n=8

      419     3802    2           CALL FMP$CLSF(MYPN$); /* Release file                       */

   3802  1 001307   000003 630400 2                  EPPR0   3
         1 001310   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001311   000000 701000 xent               TSX1    FMP$CLSF
         1 001312   000000 011000                    NOP     0

      420     3803    2           IF C1DCB$=DCBADDR(%M$UC#) THEN

   3803  1 001313   000004 470400 2                  LDP0    4
         1 001314   000000 471500                    LDP1    0,,PR0
         1 001315   200004 236100                    LDQ     C1DCB$,,AUTO
         1 001316   100003 116100                    CMPQ    3,,PR1
         1 001317   001323 601000 1                  TNZ     s:3805

PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:65   
      421     3804    2              C1DCB$->F$DCB.FCD=%YES#;

   3804  1 001320   200004 473500                    LDP3    C1DCB$,,AUTO
         1 001321   020000 236007                    LDQ     8192,DL
         1 001322   300031 256100                    ORSQ    25,,PR3

      422     3805    2           C1DCB$->F$DCB.IASN=0;

   3805  1 001323   200004 473500                    LDP3    C1DCB$,,AUTO
         1 001324   000000 236003                    LDQ     0,DU
         1 001325   300103 552104                    STBQ    67,'04'O,PR3

      423     3806    2           B$ROSEG.CR01ID=FS$XEQSAVE.CR01ID;

   3806  1 001326   200012 236100                    LDQ     FS$XEQSAVE,,AUTO
         1 001327   000000 474400 xsym               LDP4    B$ROSEG$
         1 001330   400114 756100                    STQ     76,,PR4

      424     3807                /* CSLEV is the count IBEX uses to know how many levels
      425     3808                   down he is is a nested XEQ type situation.  Whenever
      426     3809                   we are coming up a level in a nest we decrement CSLEV
      427     3810                   and make sure it is never less then 0.  When we go down
      428     3811                   a level, we just increment CSLEV one more.  CSLEV is
      429     3812                   initialized to 0 in LOGON.
      430     3813                */
      431     3814    2           B$JIT.CSLEV = B$JIT.CSLEV - 1;

   3814  1 001331   000000 475400 xsym               LDP5    B$JIT$
         1 001332   500170 236100                    LDQ     120,,PR5
         1 001333   000777 036003                    ADLQ    511,DU
         1 001334   500170 552120                    STBQ    120,'20'O,PR5

      432     3815    2           B$JIT.NEXTCC=B$ROSEG.CR01ID.NOWIS;

   3815  1 001335   400114 236100                    LDQ     76,,PR4
         1 001336   170000 376003                    ANQ     61440,DU
         1 001337   000014 772000                    QRL     12
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:66   
         1 001340   500151 552120                    STBQ    105,'20'O,PR5

      433     3816    3           DO CASE(B$ROSEG.CR01ID.NOWIS);

   3816  1 001341   400114 236100                    LDQ     76,,PR4
         1 001342   000036 772000                    QRL     30
         1 001343   000017 376007                    ANQ     15,DL
         1 001344   000004 116007                    CMPQ    4,DL
         1 001345   001347 602006 1                  TNC     s:3816+6,QL
         1 001346   001433 710000 1                  TRA     s:3836
         1 001347   001353 710000 1                  TRA     s:3818
         1 001350   001433 710000 1                  TRA     s:3836
         1 001351   001431 710000 1                  TRA     s:3834
         1 001352   001357 710000 1                  TRA     s:3821

      434     3817    3            CASE(%CC_FROMNO#);

      435     3818    3              J=2;

   3818  1 001353   000002 235007                    LDA     2,DL
         1 001354   200010 755100                    STA     J,,AUTO

      436     3819    3              RETURN;

   3819  1 001355   200014 221300                    LDX1  ! FS$XEQSAVE+2,,AUTO
         1 001356   000001 702211                    TSX2  ! 1,X1

      437     3820    3            CASE(%CC_FROMUC#);

      438     3821    3              J=B$ROSEG.NUMDCBS;

   3821  1 001357   400002 236100                    LDQ     2,,PR4
         1 001360   000022 772000                    QRL     18
         1 001361   200010 756100                    STQ     J,,AUTO

      439     3822    4              DO WHILE (J>=%M$MAXNEG#);

PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:67   
   3822  1 001362   001401 710000 1                  TRA     s:3827

      440     3823    4                 IF DCBADDR(J)~=ADDR(NIL) THEN

   3823  1 001363   000004 470400 2                  LDP0    4
         1 001364   000000 471500                    LDP1    0,,PR0
         1 001365   200010 720100                    LXL0    J,,AUTO
         1 001366   100000 236110                    LDQ     0,X0,PR1
         1 001367   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001370   001377 600000 1                  TZE     s:3826

      441     3824    4                    IF DCBADDR(J)->F$DCB.CFU$=C1DCB$ THEN

   3824  1 001371   100000 473510                    LDP3    0,X0,PR1
         1 001372   300066 236100                    LDQ     54,,PR3
         1 001373   200004 116100                    CMPQ    C1DCB$,,AUTO
         1 001374   001377 601000 1                  TNZ     s:3826

      442     3825    4                       DCBADDR(J)->F$DCB.CFU$=DCBADDR(%M$UC#);

   3825  1 001375   100003 236100                    LDQ     3,,PR1
         1 001376   300066 756100                    STQ     54,,PR3

      443     3826    4                 J=J-1;

   3826  1 001377   000001 336007                    LCQ     1,DL
         1 001400   200010 056100                    ASQ     J,,AUTO

      444     3827    4                 END;

   3827  1 001401   200010 235100                    LDA     J,,AUTO
         1 001402   000005 115000 2                  CMPA    5
         1 001403   001363 605000 1                  TPL     s:3823

      445     3828    3              CALL FSA$FDCB(C1DCB$);

   3828  1 001404   200004 633500                    EPPR3   C1DCB$,,AUTO
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:68   
         1 001405   200016 453500                    STP3    FS$XEQSAVE+4,,AUTO
         1 001406   200016 630500                    EPPR0   FS$XEQSAVE+4,,AUTO
         1 001407   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001410   000000 701000 xent               TSX1    FSA$FDCB
         1 001411   000000 011000                    NOP     0

      446     3829    3              B$ROSEG.CR01DCB=POFFW(DCBADDR(%M$UC#),B$ROSEG$);

   3829  1 001412   000004 470400 2                  LDP0    4
         1 001413   000000 471500                    LDP1    0,,PR0
         1 001414   000000 235000 xsym               LDA     B$ROSEG$
         1 001415   000022 771000                    ARL     18
         1 001416   200016 755100                    STA     FS$XEQSAVE+4,,AUTO
         1 001417   100003 236100                    LDQ     3,,PR1
         1 001420   000022 772000                    QRL     18
         1 001421   200016 136100                    SBLQ    FS$XEQSAVE+4,,AUTO
         1 001422   000000 620006                    EAX0    0,QL
         1 001423   000000 473400 xsym               LDP3    B$ROSEG$
         1 001424   300115 740100                    STX0    77,,PR3

      447     3830    3              J=2;

   3830  1 001425   000002 236007                    LDQ     2,DL
         1 001426   200010 756100                    STQ     J,,AUTO

      448     3831    3              RETURN;

   3831  1 001427   200014 221300                    LDX1  ! FS$XEQSAVE+2,,AUTO
         1 001430   000001 702211                    TSX2  ! 1,X1

      449     3832    3            CASE(%CC_FROMJOB#);

      450     3833    3            CASE(%CC_FROMXEQ#);

      451     3834    3              B$JIT.STAR.DA(6)=FS$XEQSAVE.STARDA;

   3834  1 001431   200013 235100                    LDA     FS$XEQSAVE+1,,AUTO
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:69   
         1 001432   500230 755100                    STA     152,,PR5

      452     3835    3            END;

      453     3836    2           J=1;

   3836  1 001433   000001 235007                    LDA     1,DL
         1 001434   200010 755100                    STA     J,,AUTO

      454     3837    2           RETURN;

   3837  1 001435   200014 221300                    LDX1  ! FS$XEQSAVE+2,,AUTO
         1 001436   000001 702211                    TSX2  ! 1,X1

      455     3838    2   JIS2:   ALTRETURN;

   3838  1 001437   200014 221300       JIS2         LDX1  ! FS$XEQSAVE+2,,AUTO
         1 001440   000000 702211                    TSX2  ! 0,X1

MYFPT
 Sect OctLoc
   0     000   000005 777640   000010 006000   000000 177640   000000 006014    ................
   0     004   000000 177640   000000 006014   000000 177640   000000 006014    ................
   0     010   000000 400000   000000 000000   000000 000000   000000 000000    ................
   0     014   000000 000000   000000 000000                                    ........

MYPN$
 Sect OctLoc
   0     016   000034 006000   000000 006014   000000 006014   000000 006014    ................
   0     022   000000 006014   000000 006014   000000 006014   000000 006014    ................
   0     032*  000000 006014   ****** ******   000000 000001   000000 000040    ...............
   0     036   000220 000000   000000 000000                                    ........

ERR$EOF
 Sect OctLoc
   0     040   062304 000062                                                    2..2

PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:70   
(unnamed)
 Sect OctLoc
   0     041   052130 040040   170170 170170   170170 123040   072123 131115    *X  xxxxxxS :SYM
   0     045   111040 040040   116117 040040                                    I   NO

(unnamed)
 Sect OctLoc
   2     000   000002 006000   000010 006000   607777 777777   000016 006000    ................
   2     004   000000 006003   777777 777740   577777 777777   000000 006000    ................
   2     010   000005 006000   000015 006000                                    ........
      456     3839    2   END ENDJLOOK;
      457     3840    1   END;
      458     3841        %EOD;

PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:71   
--  Include file information  --

   FM$MACROS.:E05TOU  is referenced.
   FS$FIT.:E05TOU  is referenced.
   F_FMTCODE_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   F$CP6V_C.:E05TOU  is referenced.
   F_CP6.:E05TOU  is referenced.
   F_FPTCODE_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   B$ROSEG.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
      No diagnostics issued in procedure FSD$C1.
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:72   

 **** Variables and constants ****

  ****  Section 000 RoData FSD$C1

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    40-0-0/b STRC        r     1 ERR$EOF                    0-0-0/d STRC(504)   r     1 MYFPT
    16-0-0/d STRC(648)   r     1 MYPN$

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 C1DCB$                     7-0-0/w PTR         r     1 FIT$
    12-0-0/w STRC(72)    r     1 FS$XEQSAVE                11-0-0/b BIT         r     1 HIDEYHOLE
    10-0-0/w SBIN        r     1 J                          3-0-0/w PTR         r     1 JDCB$
     6-0-0/b BIT         r     1 MYERROR                    5-0-0/w UBIN        r     1 WSR

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$PS0$
     0-0-0/w PTR         r     1 B$ROSEG$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/d STRC(3024)  r     1 B$ROSEG
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(180)   r     1 FM$GRAN
     0-0-0/d STRC(72)    r     1 FPT$XFLUSH_V               0-0-0/w STRC(72)    r     1 UATTRWORDS

PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:73   

   Procedure FSD$C1 requires 801 words for executable code.
   Procedure FSD$C1 requires 16 words of local(AUTO) storage.
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:74   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:75   
          MINI XREF LISTING

ALTRETUR
      3662**LABEL    3653--CALLALT  3679--CALLALT
ALTRETUR IN PROCEDURE OPENDCB
      3744**LABEL    3746--CALLALT
B$JIT.CPFLAGS1.SLEAZE
       488**DCL       488--REDEF
B$JIT.CSLEV
       549**DCL      3814<<ASSIGN   3814>>ASSIGN
B$JIT.DCB$
       555**DCL      3504>>ASSIGN   3506<<ASSIGN   3560<<ASSIGN   3566>>ASSIGN   3568<<ASSIGN   3613>>ASSIGN
      3615<<ASSIGN   3623<<ASSIGN   3644<<ASSIGN   3652<<ASSIGN   3681<<ASSIGN   3695<<ASSIGN
B$JIT.ERR
       394**DCL      3534<<ASSIGN   3536<<ASSIGN   3540>>ASSIGN   3562<<ASSIGN   3574>>ASSIGN   3710<<ASSIGN
B$JIT.ERR.CODE
       395**DCL      3740>>IF       3776>>IF
B$JIT.ERR.MID
       395**DCL       395--REDEF
B$JIT.NEXTCC
       536**DCL      3554<<ASSIGN   3597<<ASSIGN   3599<<ASSIGN   3600>>ASSIGN   3622<<ASSIGN   3629>>DOCASE
      3634<<ASSIGN   3655<<ASSIGN   3673<<ASSIGN   3701<<ASSIGN   3782<<ASSIGN   3815<<ASSIGN
B$JIT.STAR.DA
       555**DCL      3834<<ASSIGN
B$JIT.SYSID
       394**DCL      3725>>ASSIGN
B$JIT$
        71**DCL       389--IMP-PTR  3504>>ASSIGN   3506>>ASSIGN   3534>>ASSIGN   3536>>ASSIGN   3540>>ASSIGN
      3554>>ASSIGN   3560>>ASSIGN   3562>>ASSIGN   3566>>ASSIGN   3568>>ASSIGN   3574>>ASSIGN   3597>>ASSIGN
      3599>>ASSIGN   3600>>ASSIGN   3613>>ASSIGN   3615>>ASSIGN   3622>>ASSIGN   3623>>ASSIGN   3629>>DOCASE
      3634>>ASSIGN   3644>>ASSIGN   3652>>ASSIGN   3655>>ASSIGN   3673>>ASSIGN   3681>>ASSIGN   3695>>ASSIGN
      3701>>ASSIGN   3710>>ASSIGN   3725>>ASSIGN   3740>>IF       3776>>IF       3782>>ASSIGN   3814>>ASSIGN
      3814>>ASSIGN   3815>>ASSIGN   3834>>ASSIGN
B$PS0$
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:76   
        73**DCL      3099--IMP-PTR  3685<>CALL     3687>>IF
B$ROSEG.CR01DCB
       672**DCL      3505>>ASSIGN   3567>>ASSIGN   3589<<ASSIGN   3614>>ASSIGN   3627>>IF       3636<<ASSIGN
      3641>>IF       3643>>ASSIGN   3651>>ASSIGN   3668<<ASSIGN   3678>>IF       3680>>ASSIGN   3694>>ASSIGN
      3829<<ASSIGN
B$ROSEG.CR01ID
       664**DCL      3552>>ASSIGN   3553<<ASSIGN   3555<<ASSIGN   3628<<ASSIGN   3806<<ASSIGN
B$ROSEG.CR01ID.INT
       665**DCL      3596>>IF       3667>>IF       3711>>IF
B$ROSEG.CR01ID.JCL
       666**DCL      3608>>IF       3631<<ASSIGN   3650>>IF       3657<<ASSIGN
B$ROSEG.CR01ID.NOWIS
       667**DCL      3554>>ASSIGN   3556<<ASSIGN   3600<<ASSIGN   3604>>DOCASE   3609<<ASSIGN   3611<<ASSIGN
      3622>>ASSIGN   3632<<ASSIGN   3639>>DOWHILE  3639>>DOWHILE  3656<<ASSIGN   3669<<ASSIGN   3672<<ASSIGN
      3673>>ASSIGN   3676>>DOWHILE  3676>>DOWHILE  3692>>IF       3700<<ASSIGN   3717>>IF       3742>>IF
      3777>>IF       3781<<ASSIGN   3815>>ASSIGN   3816>>DOCASE
B$ROSEG.CR01ID.POSN
       671**DCL      3531<<ASSIGN   3531>>ASSIGN   3621<<ASSIGN   3638<<ASSIGN   3744>>IF       3745>>ASSIGN
B$ROSEG.NUMDCBS
       645**DCL      3579>>ASSIGN   3821>>ASSIGN
B$ROSEG$
        72**DCL       642--IMP-PTR   678--IMP-PTR   680--IMP-PTR  3505>>ASSIGN   3505>>ASSIGN   3531>>ASSIGN
      3531>>ASSIGN   3552>>ASSIGN   3553>>ASSIGN   3554>>ASSIGN   3555>>ASSIGN   3556>>ASSIGN   3567>>ASSIGN
      3567>>ASSIGN   3579>>ASSIGN   3589>>ASSIGN   3589>>ASSIGN   3596>>IF       3600>>ASSIGN   3604>>DOCASE
      3608>>IF       3609>>ASSIGN   3611>>ASSIGN   3614>>ASSIGN   3614>>ASSIGN   3621>>ASSIGN   3622>>ASSIGN
      3627>>IF       3628>>ASSIGN   3631>>ASSIGN   3632>>ASSIGN   3636>>ASSIGN   3636>>ASSIGN   3638>>ASSIGN
      3639>>DOWHILE  3639>>DOWHILE  3641>>IF       3643>>ASSIGN   3643>>ASSIGN   3650>>IF       3651>>ASSIGN
      3651>>ASSIGN   3656>>ASSIGN   3657>>ASSIGN   3667>>IF       3668>>ASSIGN   3669>>ASSIGN   3672>>ASSIGN
      3673>>ASSIGN   3676>>DOWHILE  3676>>DOWHILE  3678>>IF       3680>>ASSIGN   3680>>ASSIGN   3692>>IF
      3694>>ASSIGN   3694>>ASSIGN   3700>>ASSIGN   3711>>IF       3717>>IF       3742>>IF       3744>>IF
      3745>>ASSIGN   3777>>IF       3781>>ASSIGN   3806>>ASSIGN   3815>>ASSIGN   3816>>DOCASE   3821>>ASSIGN
      3829>>ASSIGN   3829>>ASSIGN
C1DCB$
      3492**DCL      3505<<ASSIGN   3506>>ASSIGN   3507>>IF       3520>>ASSIGN   3522>>IF       3529>>ASSIGN
      3530>>ASSIGN   3535>>IF       3541>>ASSIGN   3543>>ASSIGN   3544>>ASSIGN   3545>>ASSIGN   3567<<ASSIGN
      3568>>ASSIGN   3575>>IF       3576>>IF       3578>>IF       3583>>IF       3588<>CALL     3592>>ASSIGN
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:77   
      3593>>ASSIGN   3614<<ASSIGN   3615>>ASSIGN   3616>>IF       3618>>ASSIGN   3619>>IF       3620>>ASSIGN
      3643<<ASSIGN   3644>>ASSIGN   3645>>IF       3651<<ASSIGN   3652>>ASSIGN   3658>>ASSIGN   3659>>ASSIGN
      3664>>IF       3665<>CALL     3680<<ASSIGN   3681>>ASSIGN   3682>>IF       3694<<ASSIGN   3695>>ASSIGN
      3697>>ASSIGN   3698>>ASSIGN   3714>>ASSIGN   3715>>ASSIGN   3716>>ASSIGN   3718>>ASSIGN   3719>>ASSIGN
      3720>>ASSIGN   3723>>ASSIGN   3724>>ASSIGN   3726>>CALLBLT  3727>>ASSIGN   3729>>ASSIGN   3731>>IF
      3732>>ASSIGN   3733>>ASSIGN   3735>>ASSIGN   3736>>ASSIGN   3737>>ASSIGN   3738>>ASSIGN   3741>>ASSIGN
      3743>>ASSIGN   3745>>ASSIGN   3770>>ASSIGN   3771>>ASSIGN   3779>>ASSIGN   3780>>ASSIGN   3803>>IF
      3804>>ASSIGN   3805>>ASSIGN   3824>>IF       3828<>CALL
ENDJALT2
      3664**LABEL    3642--CALLALT
ENDJALTR
      3656**LABEL    3646--CALLALT
ENDJJCL
      3645**LABEL    3674--GOTO
ENDJLOOK
      3796**PROC     3511--CALL     3569--CALL     3647--CALL     3684--CALL
ENDOFFILE IN PROCEDURE LOOKAHEAD
      3773**LABEL    3772--CALLALT
ERR$EOF
      3483**DCL      3525>>ASSIGN   3536>>ASSIGN
ERROR_CR01
      3570**LABEL    3509--CALLALT  3510--CALLALT  3511--CALLALT  3517--GOTO     3546--CALLALT  3569--CALLALT
      3647--CALLALT  3683--CALLALT  3684--CALLALT
F$DCB.ACCT
      1073**DCL      3720<<ASSIGN   3727<<ASSIGN
F$DCB.ACTPOS
      1088**DCL      1088--REDEF
F$DCB.ARS
      1063**DCL      1063--REDEF    3543<<ASSIGN   3543>>ASSIGN   3770<<ASSIGN
F$DCB.ASN
      1078**DCL      3714<<ASSIGN   3735<<ASSIGN
F$DCB.ATTR
      1081**DCL      1082--REDEF
F$DCB.BORROW
      1096**DCL      1096--REDEF    1096--REDEF    1096--REDEF
F$DCB.CFU$
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:78   
      1097**DCL      3583>>IF       3585<<ASSIGN   3824>>IF       3825<<ASSIGN
F$DCB.DCBNAME.L
      1110**DCL      1110--IMP-SIZ
F$DCB.DDEV
      1069**DCL      3520<<ASSIGN   3520>>ASSIGN   3520>>ASSIGN   3743<<ASSIGN
F$DCB.DVBYTE
      1066**DCL      3522>>IF       3535>>IF       3544<<ASSIGN   3544>>ASSIGN
F$DCB.DVBYTE.TOP
      1066**DCL      3550<<ASSIGN   3557<<ASSIGN
F$DCB.EOMCHAR
      1067**DCL      1067--REDEF    3545<<ASSIGN   3545>>ASSIGN
F$DCB.FCD
      1076**DCL      3592<<ASSIGN   3620<<ASSIGN   3658<<ASSIGN   3698<<ASSIGN   3731>>IF       3733<<ASSIGN
      3780<<ASSIGN   3804<<ASSIGN
F$DCB.FFLG
      1067**DCL      3738<<ASSIGN
F$DCB.FLDID
      1091**DCL      1091--REDEF
F$DCB.FORM$
      1085**DCL      1085--REDEF
F$DCB.FSECT
      1101**DCL      1101--REDEF
F$DCB.FSN
      1078**DCL      1078--REDEF    1078--REDEF    1079--REDEF
F$DCB.FUN
      1077**DCL      3729<<ASSIGN
F$DCB.HEADER$
      1084**DCL      1084--REDEF
F$DCB.IASN
      1104**DCL      3507>>IF       3576>>IF       3593<<ASSIGN   3616>>IF       3618<<ASSIGN   3645>>IF
      3659<<ASSIGN   3682>>IF       3693>>IF       3697<<ASSIGN   3732<<ASSIGN   3779<<ASSIGN   3805<<ASSIGN
F$DCB.IFMT
      1103**DCL      3737<<ASSIGN
F$DCB.IXTNSIZE
      1082**DCL      1082--REDEF
F$DCB.LASTSTA$
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:79   
      1072**DCL      1072--REDEF
F$DCB.LVL
      1097**DCL      1097--REDEF
F$DCB.NAME.C
      1072**DCL      1072--REDEF    3719<<ASSIGN   3724<<ASSIGN   3726<<CALLBLT
F$DCB.NAME.L
      1072**DCL      3718<<ASSIGN   3723<<ASSIGN
F$DCB.NOEOF
      1093**DCL      1093--REDEF
F$DCB.NRECS
      1083**DCL      1083--REDEF
F$DCB.NRECX
      1102**DCL      1102--REDEF
F$DCB.OHDR
      1094**DCL      1094--REDEF
F$DCB.ORG
      1077**DCL      1077--REDEF
F$DCB.PRECNO
      1100**DCL      1100--REDEF
F$DCB.PSN
      1073**DCL      3716<<ASSIGN
F$DCB.RCSZ
      1105**DCL      1105--REDEF
F$DCB.RES
      1073**DCL      1073--REDEF    3715<<ASSIGN   3736<<ASSIGN
F$DCB.SETX
      1085**DCL      1085--REDEF
F$DCB.TAB$
      1084**DCL      1085--REDEF
F$DCB.TDA
      1099**DCL      1099--REDEF
F$DCB.TYC
      1063**DCL      3541<<ASSIGN   3541>>ASSIGN   3541>>ASSIGN   3771<<ASSIGN
F$DCB.TYC.EOD
      1064**DCL      3537<<ASSIGN
F$DCB.UB$
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:80   
      1101**DCL      3529<<ASSIGN   3529>>ASSIGN
F$DCB.UBYTES
      1101**DCL      3530<<ASSIGN   3530>>ASSIGN   3745<<ASSIGN
F$DCB.WAIT
      1095**DCL      3537>>ASSIGN   3541>>ASSIGN   3541>>ASSIGN   3741<<ASSIGN
F$DCB.WSN
      1074**DCL      1074--REDEF
FIT$
      3495**DCL      3787<>CALL     3788<<ASSIGN   3788>>ASSIGN   3789<>CALL     3790>>ASSIGN   3798<>CALL
      3799<<ASSIGN   3799>>ASSIGN   3800<>CALL     3801>>ASSIGN
FM$GRAN
      3479**DCL      3788--ASSIGN   3799--ASSIGN
FMH$CPMME
        59**DCL-ENT  3533--CALL
FMH$LOOKAHD
        58**DCL-ENT  3772--CALL
FMH$PREC
        67**DCL-ENT  3746--CALL
FMM$DFLOPNP
        66**DCL-ENT  3712--CALL     3730--CALL
FMN$GETFIT
        61**DCL-ENT  3787--CALL     3798--CALL
FMO$GETDOMAIN
        60**DCL-ENT  3523--CALL
FMO$LOCCODP
        63**DCL-ENT  3789--CALL     3800--CALL
FMP$CLSF
        64**DCL-ENT  3577--CALL     3617--CALL     3654--CALL     3696--CALL     3778--CALL     3802--CALL
FPT$XFLUSH_V.ONELEVEL
      3099**DCL      3687>>IF
FS$XEQSAVE
      3501**DCL      3790<<ASSIGN   3801<<ASSIGN
FS$XEQSAVE.CR01ID
      3501**DCL      3553>>ASSIGN   3806>>ASSIGN
FS$XEQSAVE.STARDA
      3501**DCL      3834>>ASSIGN
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:81   
FSA$FDCB
        65**DCL-ENT  3588--CALL     3665--CALL     3828--CALL
FSD$C1GETDCB
        62**DCL-ENT  3642--CALL     3679--CALL
HFF$NILERASE
        69**DCL-ENT  3685--CALL
HIDEYHOLE
      3497**DCL      3552<<ASSIGN   3555>>ASSIGN
J
      3496**DCL      3511>>IF       3512>>DOCASE   3547>>DOCASE   3579<<ASSIGN   3580>>DOWHILE  3581--IF
      3583--IF       3585--ASSIGN   3586<<ASSIGN   3586>>ASSIGN   3725<<ASSIGN   3726>>CALLBLT  3773<<ASSIGN
      3783<<ASSIGN   3786<<ASSIGN   3787<>CALL     3791<<ASSIGN   3797<<ASSIGN   3798<>CALL     3818<<ASSIGN
      3821<<ASSIGN   3822>>DOWHILE  3823--IF       3824--IF       3825--ASSIGN   3826<<ASSIGN   3826>>ASSIGN
      3830<<ASSIGN   3836<<ASSIGN
JDCB$
      3491**DCL      3504<<ASSIGN   3520>>ASSIGN   3520>>ASSIGN   3529>>ASSIGN   3530>>ASSIGN   3537>>ASSIGN
      3537>>ASSIGN   3541>>ASSIGN   3541>>ASSIGN   3541>>ASSIGN   3541>>ASSIGN   3543>>ASSIGN   3544>>ASSIGN
      3545>>ASSIGN   3550>>ASSIGN   3557>>ASSIGN   3560>>ASSIGN   3566<<ASSIGN   3613<<ASSIGN   3623>>ASSIGN
JIS2 IN PROCEDURE ENDJLOOK
      3838**LABEL    3798--CALLALT  3800--CALLALT
JIS2 IN PROCEDURE LOOKAHEAD
      3793**LABEL    3776--GOTO     3787--CALLALT  3789--CALLALT
LOOKAHEAD
      3753**PROC     3510--CALL     3546--CALL
MYERROR
      3494**DCL      3525<<ASSIGN   3540<<ASSIGN   3561>>IF       3562>>ASSIGN   3570<<ASSIGN   3574<<ASSIGN
MYFPT.STATION_
      3036**DCL      3037--REDEF
MYFPT.V
      3037**DCL      3033--DCLINIT  3533<>CALL
MYFPT.V.DVBYTE.REREAD#
      3048**DCL      3048--REDEF
MYFPT.V.INDX#
      3046**DCL      3046--REDEF
MYPN$
      3079**DCL      3577<>CALL     3654<>CALL     3802<>CALL
PL6.E3A0      #001=FSD$C1 File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:28 Page:82   
MYPN$.SN_
      3079**DCL      3079--REDEF
MYPN$.UTL_
      3080**DCL      3080--REDEF
MYPN$.V
      3084**DCL      3079--DCLINIT
MYPN$.V.EXPIRE#
      3094**DCL      3094--REDEF
MYPN$.V.TYPE#
      3092**DCL      3092--REDEF
MYPN$.V.XTNSIZE#
      3089**DCL      3089--REDEF    3091--REDEF
OPENDCB
      3706**PROC     3509--CALL     3646--CALL     3653--CALL     3683--CALL
PREREADLOOKMORE
      3507**LABEL    3515--GOTO
UATTRWORDS
      3498**DCL      3790>>ASSIGN   3801>>ASSIGN
USERERR
      3535**LABEL    3533--CALLALT
USERRET
      3554**LABEL    3526--GOTO     3571--GOTO     3601--GOTO
WSR
      3493**DCL      3523<>CALL     3524>>IF

PL6.E3A0      #002=FSD$C1GETDCB File=FSD$JCL.:E05TSI                             TUE 07/29/97 17:28 Page:83   
      459        1        /*T***********************************************************/
      460        2        /*T*                                                         */
      461        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      462        4        /*T*                                                         */
      463        5        /*T***********************************************************/
      464        6        /*F*    NAME: FSD$C1GETDCB
      465        7                PURPOSE: FSD$C1GETDCB gets a DCB for interactive XEQ
      466        8                   reading.
      467        9                DESCRIPTION: A DCB-sized ROSEG space is gotten and
      468       10                   filled in.
      469       11         */
      470       12        FSD$C1GETDCB: PROC ALTRET;
      471       13        /**/
      472       14    1   DCL FSA$GSP ENTRY(2)ALTRET;
      473       15    1   DCL B$JIT$ PTR SYMREF;
      474       16    1   DCL B$ROSEG$ PTR SYMREF;
      475       17        /**/
      476       18        %INCLUDE F$JIT_C;
      477      448        %MACRO B$ROSEG(BASED=BASED);
      478      449        %INCLUDE B$ROSEG;
      479      512        %MEND;
      480      513        %B$ROSEG(BASED="BASED(B$ROSEG$)");
      481      573        %INCLUDE F_DCB_D;
      482      661        %MACRO F$DCBI(BASED=BASED);
      483      662        %INCLUDE F$DCB;
      484      711        %MEND;
      485      712        %F$DCBI(BASED="BASED(SDCB$)");
      486      762        %INCLUDE CP_6_SUBS;
      487     1302        /**/
      488     1303        %M$MDCB(DCBN=CR01DCB,STCLASS=CONSTANT,ASN=FILE,
      489     1304                NAME='*X',FUN=UPDATE);
      490     1378        /**/
      491     1379    1   DCL SDCB$ PTR;
      492     1380    1   DCL I UBIN;
      493     1381        %EJECT;
PL6.E3A0      #002=FSD$C1GETDCB File=FSD$JCL.:E05TSI                             TUE 07/29/97 17:28 Page:84   
      494     1382    1           CALL FSA$GSP(SIZEW(CR01DCB)+2,SDCB$)ALTRET(ALTRETUR);
      495     1383    1           B$JIT.DCB$=SDCB$;
      496     1384    1           F$DCB.DCBNAME.L=0;
      497     1385    1           F$DCB=CR01DCB;
      498     1386    1           F$DCB.DCBNAME.L=4;
      499     1387    1           F$DCB.DCBNAME.N='CR01';
      500     1388    1           B$ROSEG.CR01DCB=POFFW(SDCB$,B$ROSEG$);
      501     1389    1           RETURN;
      502     1390    1   ALTRETUR: ALTRETURN;
      503     1391    1   END FSD$C1GETDCB;
      504     1392        %EOD;

PL6.E3A0      #002=FSD$C1GETDCB File=FSD$JCL.:E05TSI                             TUE 07/29/97 17:28 Page:85   
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   F$DCB.:E05TOU  is referenced.
   F_DCB_D.:E05TOU  is referenced.
   B$ROSEG.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FSD$C1GETDCB.

   Procedure FSD$C1GETDCB requires 46 words for executable code.
   Procedure FSD$C1GETDCB requires 8 words of local(AUTO) storage.

PL6.E3A0      #002=FSD$C1GETDCB File=FSD$JCL.:E05TSI                             TUE 07/29/97 17:28 Page:86   

 Object Unit name= FSD$C1GETDCB                               File name= FSD$JCL.:E05TOU
 UTS= JUL 29 '97 17:28:53.84 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     97    141  FSD$C1GETDCB
    1   Proc  even  none    46     56  FSD$C1GETDCB
    2  RoData even  none     3      3  FSD$C1GETDCB

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        0  FSD$C1GETDCB

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 FSA$GSP
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$JIT$                                B$ROSEG$                              B_VECTNIL
PL6.E3A0      #002=FSD$C1GETDCB File=FSD$JCL.:E05TSI                             TUE 07/29/97 17:28 Page:87   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #002=FSD$C1GETDCB File=FSD$JCL.:E05TSI                             TUE 07/29/97 17:28 Page:88   


      459        1        /*T***********************************************************/
      460        2        /*T*                                                         */
      461        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      462        4        /*T*                                                         */
      463        5        /*T***********************************************************/
      464        6        /*F*    NAME: FSD$C1GETDCB
      465        7                PURPOSE: FSD$C1GETDCB gets a DCB for interactive XEQ
      466        8                   reading.
      467        9                DESCRIPTION: A DCB-sized ROSEG space is gotten and
      468       10                   filled in.
      469       11         */
      470       12        FSD$C1GETDCB: PROC ALTRET;

     12  1 000000   000000 700200 xent  FSD$C1GETDCB TSX0  ! X66_AUTO_0
         1 000001   000010 000000                    ZERO    8,0

      471       13        /**/
      472       14    1   DCL FSA$GSP ENTRY(2)ALTRET;
      473       15    1   DCL B$JIT$ PTR SYMREF;
      474       16    1   DCL B$ROSEG$ PTR SYMREF;
      475       17        /**/
      476       18        %INCLUDE F$JIT_C;
      477      448        %MACRO B$ROSEG(BASED=BASED);
      478      449        %INCLUDE B$ROSEG;
      479      512        %MEND;
      480      513        %B$ROSEG(BASED="BASED(B$ROSEG$)");
      481      573        %INCLUDE F_DCB_D;
      482      661        %MACRO F$DCBI(BASED=BASED);
      483      662        %INCLUDE F$DCB;
      484      711        %MEND;
      485      712        %F$DCBI(BASED="BASED(SDCB$)");
      486      762        %INCLUDE CP_6_SUBS;
      487     1302        /**/
      488     1303        %M$MDCB(DCBN=CR01DCB,STCLASS=CONSTANT,ASN=FILE,
      489     1304                NAME='*X',FUN=UPDATE);
      490     1378        /**/
PL6.E3A0      #002=FSD$C1GETDCB File=FSD$JCL.:E05TSI                             TUE 07/29/97 17:28 Page:89   
      491     1379    1   DCL SDCB$ PTR;
      492     1380    1   DCL I UBIN;
      493     1381        %EJECT;
PL6.E3A0      #002=FSD$C1GETDCB File=FSD$JCL.:E05TSI                             TUE 07/29/97 17:28 Page:90   
      494     1382    1           CALL FSA$GSP(SIZEW(CR01DCB)+2,SDCB$)ALTRET(ALTRETUR);

   1382  1 000002   200003 630500                    EPPR0   SDCB$,,AUTO
         1 000003   200007 450500                    STP0    SDCB$+4,,AUTO
         1 000004   000001 236000 2                  LDQ     1
         1 000005   200006 756100                    STQ     SDCB$+3,,AUTO
         1 000006   200006 630500                    EPPR0   SDCB$+3,,AUTO
         1 000007   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000010   000000 701000 xent               TSX1    FSA$GSP
         1 000011   000055 702000 1                  TSX2    ALTRETUR

      495     1383    1           B$JIT.DCB$=SDCB$;

   1383  1 000012   200003 236100                    LDQ     SDCB$,,AUTO
         1 000013   000000 470400 xsym               LDP0    B$JIT$
         1 000014   000232 756100                    STQ     154,,PR0

      496     1384    1           F$DCB.DCBNAME.L=0;

   1384  1 000015   200003 471500                    LDP1    SDCB$,,AUTO
         1 000016   000002 236000 2                  LDQ     2
         1 000017   100140 356100                    ANSQ    96,,PR1

      497     1385    1           F$DCB=CR01DCB;

   1385  1 000020   100140 236100                    LDQ     96,,PR1
         1 000021   000033 772000                    QRL     27
         1 000022   000037 376007                    ANQ     31,DL
         1 000023   000601 620006                    EAX0    385,QL
         1 000024   000140 100400                    MLR     fill='000'O
         1 000025   000000 000600 0                  ADSC9   CR01DCB                  cn=0,n=384
         1 000026   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

      498     1386    1           F$DCB.DCBNAME.L=4;

   1386  1 000027   200003 470500                    LDP0    SDCB$,,AUTO
         1 000030   000140 236100                    LDQ     96,,PR0
PL6.E3A0      #002=FSD$C1GETDCB File=FSD$JCL.:E05TSI                             TUE 07/29/97 17:28 Page:91   
         1 000031   000002 376000 2                  ANQ     2
         1 000032   004000 276003                    ORQ     2048,DU
         1 000033   000140 756100                    STQ     96,,PR0

      499     1387    1           F$DCB.DCBNAME.N='CR01';

   1387  1 000034   000140 236100                    LDQ     96,,PR0
         1 000035   000033 772000                    QRL     27
         1 000036   000037 376007                    ANQ     31,DL
         1 000037   000000 620006                    EAX0    0,QL
         1 000040   040140 100400                    MLR     fill='040'O
         1 000041   000140 000004 0                  ADSC9   CR01DCB+96               cn=0,n=4
         1 000042   000140 200010                    ADSC9   96,,PR0                  cn=1,n=*X0

      500     1388    1           B$ROSEG.CR01DCB=POFFW(SDCB$,B$ROSEG$);

   1388  1 000043   000000 235000 xsym               LDA     B$ROSEG$
         1 000044   000022 771000                    ARL     18
         1 000045   200006 755100                    STA     SDCB$+3,,AUTO
         1 000046   200003 236100                    LDQ     SDCB$,,AUTO
         1 000047   000022 772000                    QRL     18
         1 000050   200006 136100                    SBLQ    SDCB$+3,,AUTO
         1 000051   000000 621006                    EAX1    0,QL
         1 000052   000000 471400 xsym               LDP1    B$ROSEG$
         1 000053   100115 741100                    STX1    77,,PR1

      501     1389    1           RETURN;

   1389  1 000054   000000 702200 xent               TSX2  ! X66_ARET

      502     1390    1   ALTRETUR: ALTRETURN;

   1390  1 000055   000000 702200 xent  ALTRETUR     TSX2  ! X66_AALT

CR01DCB
 Sect OctLoc
   0     000   000000 000000   000000 000000   000000 000000   000000 000501    ................
PL6.E3A0      #002=FSD$C1GETDCB File=FSD$JCL.:E05TSI                             TUE 07/29/97 17:28 Page:92   
   0     004   000000 000000   000000 000000   000000 006014   000000 006014    ................
   0     010   002052 130040   040040 040040   040040 040040   040040 040040    .*X
   0     014   040040 040040   040040 040040   040040 040040   040040 040040
   0     024*  040040 040040   040040 040040   115105 040040   040040 040040            ME
   0     030   040040 040040   000000 203015   000001 001000   000000 000000        ............
   0     034   000000 000000   000000 000000   000000 000000   000002 776003    ................
   0     040   001000 000000   000000 000002   000000 000000   000000 000000    ................
   0     044   000000 000111   040040 040040   000000 006014   000000 006014    ...I    ........
   0     050   000000 006014   000000 000000   000000 000000   000000 006014    ................
   0     054   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     060   000000 010000   000000 000000   000000 000000   000000 000000    ................
   0     064   000000 000020   000000 000000   000000 006014   000000 000000    ................
   0     070   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     074   000000 000000   000000 006014   000000 000000   000000 000000    ................
   0     100   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     104   ****** ******   ****** ******   000000 000000   ****** ******    ................
   0     110   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     124*  000000 000000   000000 000000   000000 000000   ****** ******    ................
   0     134*  ****** ******   ****** ******   ****** ******   000000 070707    ..............8.

(unnamed)
 Sect OctLoc
   0     140   103122 060061                                                    CR01

(unnamed)
 Sect OctLoc
   2     000   000000 000142   000000 006000   740777 777777                    ...b........
      503     1391    1   END FSD$C1GETDCB;
      504     1392        %EOD;

PL6.E3A0      #002=FSD$C1GETDCB File=FSD$JCL.:E05TSI                             TUE 07/29/97 17:28 Page:93   
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   F$DCB.:E05TOU  is referenced.
   F_DCB_D.:E05TOU  is referenced.
   B$ROSEG.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FSD$C1GETDCB.
PL6.E3A0      #002=FSD$C1GETDCB File=FSD$JCL.:E05TSI                             TUE 07/29/97 17:28 Page:94   

 **** Variables and constants ****

  ****  Section 000 RoData FSD$C1GETDCB

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3456)  r     1 CR01DCB

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 SDCB$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$ROSEG$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/d STRC(3024)  r     1 B$ROSEG
     0-0-0/d ASTR(3528)  r     1 F$DCB


   Procedure FSD$C1GETDCB requires 46 words for executable code.
   Procedure FSD$C1GETDCB requires 8 words of local(AUTO) storage.
PL6.E3A0      #002=FSD$C1GETDCB File=FSD$JCL.:E05TSI                             TUE 07/29/97 17:28 Page:95   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=FSD$C1GETDCB File=FSD$JCL.:E05TSI                             TUE 07/29/97 17:28 Page:96   
          MINI XREF LISTING

ALTRETUR
      1390**LABEL    1382--CALLALT
B$JIT.DCB$
       435**DCL      1383<<ASSIGN
B$JIT.ERR.MID
       346**DCL       346--REDEF
B$JIT$
        15**DCL       340--IMP-PTR  1383>>ASSIGN
B$ROSEG.CR01DCB
       552**DCL      1388<<ASSIGN
B$ROSEG$
        16**DCL       522--IMP-PTR   558--IMP-PTR   560--IMP-PTR  1388>>ASSIGN   1388>>ASSIGN
CR01DCB
      1305**DCL      1382--CALL     1385>>ASSIGN
CR01DCB.ACTPOS
      1346**DCL      1346--REDEF
CR01DCB.ARS#
      1305**DCL      1305--REDEF
CR01DCB.ATTR#
      1335**DCL      1335--REDEF    1337--REDEF
CR01DCB.BORROW
      1357**DCL      1357--REDEF    1357--REDEF    1357--REDEF
CR01DCB.EOMCHAR#
      1312**DCL      1313--REDEF
CR01DCB.FLDID
      1349**DCL      1350--REDEF
CR01DCB.FORM$
      1341**DCL      1341--REDEF
CR01DCB.FSECT
      1364**DCL      1364--REDEF
CR01DCB.FSN#
      1331**DCL      1331--REDEF    1331--REDEF    1332--REDEF
PL6.E3A0      #002=FSD$C1GETDCB File=FSD$JCL.:E05TSI                             TUE 07/29/97 17:28 Page:97   
CR01DCB.HEADER$
      1340**DCL      1341--REDEF
CR01DCB.IXTNSIZE#
      1337**DCL      1338--REDEF
CR01DCB.LASTSTA$
      1321**DCL      1321--REDEF
CR01DCB.LVL
      1358**DCL      1358--REDEF
CR01DCB.NAME#.C
      1321**DCL      1322--REDEF
CR01DCB.NOEOF
      1353**DCL      1353--REDEF
CR01DCB.NRECS#
      1338**DCL      1338--REDEF
CR01DCB.NRECX
      1365**DCL      1365--REDEF
CR01DCB.OHDR
      1354**DCL      1354--REDEF
CR01DCB.ORG#
      1329**DCL      1330--REDEF
CR01DCB.PRECNO
      1362**DCL      1362--REDEF
CR01DCB.RCSZ
      1370**DCL      1370--REDEF
CR01DCB.RES#
      1323**DCL      1323--REDEF
CR01DCB.SETX
      1342**DCL      1342--REDEF
CR01DCB.TAB$
      1341**DCL      1341--REDEF
CR01DCB.TDA
      1361**DCL      1362--REDEF
CR01DCB.WSN#
      1323**DCL      1324--REDEF
F$DCB
       713**DCL      1385<<ASSIGN
PL6.E3A0      #002=FSD$C1GETDCB File=FSD$JCL.:E05TSI                             TUE 07/29/97 17:28 Page:98   
F$DCB.ACTPOS
       738**DCL       738--REDEF
F$DCB.ARS
       713**DCL       713--REDEF
F$DCB.ATTR
       731**DCL       732--REDEF
F$DCB.BORROW
       746**DCL       746--REDEF     746--REDEF     746--REDEF
F$DCB.DCBNAME.L
       760**DCL       760--IMP-SIZ  1384<<ASSIGN   1385>>ASSIGN   1386<<ASSIGN   1387>>ASSIGN
F$DCB.DCBNAME.N
       760**DCL      1387<<ASSIGN
F$DCB.EOMCHAR
       717**DCL       717--REDEF
F$DCB.FLDID
       741**DCL       741--REDEF
F$DCB.FORM$
       735**DCL       735--REDEF
F$DCB.FSECT
       751**DCL       751--REDEF
F$DCB.FSN
       728**DCL       728--REDEF     728--REDEF     729--REDEF
F$DCB.HEADER$
       734**DCL       734--REDEF
F$DCB.IXTNSIZE
       732**DCL       732--REDEF
F$DCB.LASTSTA$
       722**DCL       722--REDEF
F$DCB.LVL
       747**DCL       747--REDEF
F$DCB.NAME.C
       722**DCL       722--REDEF
F$DCB.NOEOF
       743**DCL       743--REDEF
F$DCB.NRECS
       733**DCL       733--REDEF
PL6.E3A0      #002=FSD$C1GETDCB File=FSD$JCL.:E05TSI                             TUE 07/29/97 17:28 Page:99   
F$DCB.NRECX
       752**DCL       752--REDEF
F$DCB.OHDR
       744**DCL       744--REDEF
F$DCB.ORG
       727**DCL       727--REDEF
F$DCB.PRECNO
       750**DCL       750--REDEF
F$DCB.RCSZ
       755**DCL       755--REDEF
F$DCB.RES
       723**DCL       723--REDEF
F$DCB.SETX
       735**DCL       735--REDEF
F$DCB.TAB$
       734**DCL       735--REDEF
F$DCB.TDA
       749**DCL       749--REDEF
F$DCB.WSN
       724**DCL       724--REDEF
FSA$GSP
        14**DCL-ENT  1382--CALL
SDCB$
      1379**DCL       713--IMP-PTR  1382<>CALL     1383>>ASSIGN   1384>>ASSIGN   1385>>ASSIGN   1385>>ASSIGN
      1386>>ASSIGN   1387>>ASSIGN   1387>>ASSIGN   1388>>ASSIGN

PL6.E3A0      #003=FSD$JE File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:29 Page:100  
      505        1        /*T***********************************************************/
      506        2        /*T*                                                         */
      507        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      508        4        /*T*                                                         */
      509        5        /*T***********************************************************/
      510        6        /*F*    NAME: FSD$JE
      511        7         *      PURPOSE: FSD$JE handles user M$WRITE and M$WEOF PMME's which
      512        8         *         create control command files.  User DCB's for such writes
      513        9         *         have user-visible assignments to device oplabels JE and
      514       10         *         JF; internally, they are files in the input symbiont
      515       11         *         account (:SYMI).
      516       12         *      DESCRIPTION:   On M$WRITE, the user record is examined.  If
      517       13         *         it doesn't start with a '!', it is just written.  If it
      518       14         *         starts with a '!' and isn't '!EOD', it is written with
      519       15         *         a device byte flag which will cause it to be an EOF when
      520       16         *         read.  If it is '!EOD', it is written with a device byte
      521       17         *         flag which will cause it to be an EOD when read, as a
      522       18         *         zero-length record.
      523       19         *            M$WEOF always writes a zero-length EOD record.
      524       20         */
      525       21        /*D*    NAME: FSD$JE
      526       22         *      CALL: CALL FSD$JE(FPTCODE) ALTRET;
      527       23         *      INTERFACE:  FMH$CPMME
      528       24         *      ENVIRONMENT:   Monitor (for user) LS.
      529       25         *      INPUT: DCB (B$JIT.DCB$)
      530       26         *      OUTPUT: none
      531       27         */
      532       28        FSD$JE: PROC(FPTCODE,FPTV) ALTRET;
      533       29    1   DCL FPTCODE SBIN;
      534       30        %INCLUDE F$CP6V_C;
      535      256        %FPT$WRITE_V(FPTN=FPTV,BASED=);
      536      262        /**/
      537      263    1   DCL FMH$CPMME ENTRY(3) ALTRET; /* Perform PMME to consec file        */
      538      264        /**/
      539      265    1   DCL B$JIT$ PTR SYMREF; /* NOTE: JIT is BASED (B$JIT$).       */
      540      266        %INCLUDE F$JIT_C;
      541      696        %INCLUDE F$DCB;
PL6.E3A0      #003=FSD$JE File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:29 Page:101  
      542      745        %INCLUDE F_FPTCODE_C;
      543      781        %INCLUDE F_CP6;
      544     1806        %INCLUDE CP_6_SUBS;
      545     2346        %FPT_WRITE(FPTN=CONSTFPT,STCLASS=CONSTANT,WAIT=YES);
      546     2377        /**/
      547     2378    1   DCL JDCB$ PTR; /* Holds address of user DCB          */
      548     2379        %FPT$WRITE_V(FPTN=MYFPTV,BASED=);
      549     2385    1   DCL CHAR1 CHAR(1)BASED;
      550     2386    1   DCL UBYTES UBIN;
      551     2387    1   DCL CHARUB CHAR(UBYTES)BASED;
      552     2388        %EJECT;
PL6.E3A0      #003=FSD$JE File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:29 Page:102  
      553     2389    1           JDCB$= B$JIT.DCB$;
      554     2390    2           DO CASE(FPTCODE);
      555     2391    2            CASE(FPTWEOF);
      556     2392    2              MYFPTV=CONSTFPT.V;
      557     2393    2              MYFPTV.DVBYTE=MYFPTV.DVBYTE | %DVBYTE_DCBHDR#;
      558     2394    2              JDCB$->F$DCB.UBYTES=0;
      559     2395    2              JDCB$->F$DCB.UB$=ADDR(B$JIT);
      560     2396    2            CASE(FPTWRITE);
      561     2397    2              MYFPTV=FPTV;
      562     2398    2              MYFPTV.DVBYTE=MYFPTV.DVBYTE&
      563     2399    2                (%DVBYTE_BP#|%DVBYTE_BIN#|%DVBYTE_TRANS#);
      564     2400    2              UBYTES=JDCB$->F$DCB.UBYTES;
      565     2401    2              IF UBYTES ~=0 THEN
      566     2402    2                 IF JDCB$->F$DCB.UB$->CHAR1='!' THEN
      567     2403    3   BANG_RECORD:  DO;
      568     2404    3                    IF UBYTES > 1
      569     2405    3                    THEN
      570     2406    3                       IF SUBSTR (JDCB$ -> F$DCB.UB$ -> CHARUB, 0, 2) = '!!'
      571     2407    4                       THEN DO;
      572     2408    4                          JDCB$ -> F$DCB.UB$ = PINCRC(JDCB$ -> F$DCB.UB$, 1);
      573     2409    4                          JDCB$ -> F$DCB.UBYTES = UBYTES - 1;
      574     2410    4                          EXIT BANG_RECORD;
      575     2411    4                          END;
      576     2412    4                    IF JDCB$->F$DCB.UB$->CHARUB = '!EOD' THEN DO;
      577     2413    4                       MYFPTV.DVBYTE=MYFPTV.DVBYTE|%DVBYTE_DCBHDR#;
      578     2414    4                       JDCB$->F$DCB.UBYTES=0;
      579     2415    4                       END;
      580     2416    3                    ELSE
      581     2417    3                       MYFPTV.DVBYTE=MYFPTV.DVBYTE|%DVBYTE_NODAT#;
      582     2418    3                    END BANG_RECORD;
      583     2419    2            CASE(ELSE);
      584     2420    2              RETURN;
      585     2421    2            END;
      586     2422    1           CALL FMH$CPMME(FPTWRITE,MYFPTV)ALTRET(ALTRETUR);
      587     2423    1           RETURN;
      588     2424    1   ALTRETUR:;
      589     2425    1           ALTRETURN;
PL6.E3A0      #003=FSD$JE File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:29 Page:103  
      590     2426    1   END;
      591     2427        %EOD;

PL6.E3A0      #003=FSD$JE File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:29 Page:104  
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   F_CP6.:E05TOU  is referenced.
   F_FPTCODE_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
   F$CP6V_C.:E05TOU  is referenced.
      No diagnostics issued in procedure FSD$JE.

   Procedure FSD$JE requires 86 words for executable code.
   Procedure FSD$JE requires 14 words of local(AUTO) storage.

PL6.E3A0      #003=FSD$JE File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:29 Page:105  

 Object Unit name= FSD$JE                                     File name= FSD$JCL.:E05TOU
 UTS= JUL 29 '97 17:29:02.64 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     14     16  FSD$JE
    1   Proc  even  none    86    126  FSD$JE
    2  RoData even  none     2      2  FSD$JE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        2  FSD$JE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 FMH$CPMME
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$JIT$                                B_VECTNIL
PL6.E3A0      #003=FSD$JE File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:29 Page:106  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #003=FSD$JE File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:29 Page:107  


      505        1        /*T***********************************************************/
      506        2        /*T*                                                         */
      507        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      508        4        /*T*                                                         */
      509        5        /*T***********************************************************/
      510        6        /*F*    NAME: FSD$JE
      511        7         *      PURPOSE: FSD$JE handles user M$WRITE and M$WEOF PMME's which
      512        8         *         create control command files.  User DCB's for such writes
      513        9         *         have user-visible assignments to device oplabels JE and
      514       10         *         JF; internally, they are files in the input symbiont
      515       11         *         account (:SYMI).
      516       12         *      DESCRIPTION:   On M$WRITE, the user record is examined.  If
      517       13         *         it doesn't start with a '!', it is just written.  If it
      518       14         *         starts with a '!' and isn't '!EOD', it is written with
      519       15         *         a device byte flag which will cause it to be an EOF when
      520       16         *         read.  If it is '!EOD', it is written with a device byte
      521       17         *         flag which will cause it to be an EOD when read, as a
      522       18         *         zero-length record.
      523       19         *            M$WEOF always writes a zero-length EOD record.
      524       20         */
      525       21        /*D*    NAME: FSD$JE
      526       22         *      CALL: CALL FSD$JE(FPTCODE) ALTRET;
      527       23         *      INTERFACE:  FMH$CPMME
      528       24         *      ENVIRONMENT:   Monitor (for user) LS.
      529       25         *      INPUT: DCB (B$JIT.DCB$)
      530       26         *      OUTPUT: none
      531       27         */
      532       28        FSD$JE: PROC(FPTCODE,FPTV) ALTRET;

     28  1 000000   000000 700200 xent  FSD$JE       TSX0  ! X66_AUTO_2
         1 000001   000016 000002                    ZERO    14,2

      533       29    1   DCL FPTCODE SBIN;
      534       30        %INCLUDE F$CP6V_C;
      535      256        %FPT$WRITE_V(FPTN=FPTV,BASED=);
      536      262        /**/
PL6.E3A0      #003=FSD$JE File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:29 Page:108  
      537      263    1   DCL FMH$CPMME ENTRY(3) ALTRET; /* Perform PMME to consec file        */
      538      264        /**/
      539      265    1   DCL B$JIT$ PTR SYMREF; /* NOTE: JIT is BASED (B$JIT$).       */
      540      266        %INCLUDE F$JIT_C;
      541      696        %INCLUDE F$DCB;
      542      745        %INCLUDE F_FPTCODE_C;
      543      781        %INCLUDE F_CP6;
      544     1806        %INCLUDE CP_6_SUBS;
      545     2346        %FPT_WRITE(FPTN=CONSTFPT,STCLASS=CONSTANT,WAIT=YES);
      546     2377        /**/
      547     2378    1   DCL JDCB$ PTR; /* Holds address of user DCB          */
      548     2379        %FPT$WRITE_V(FPTN=MYFPTV,BASED=);
      549     2385    1   DCL CHAR1 CHAR(1)BASED;
      550     2386    1   DCL UBYTES UBIN;
      551     2387    1   DCL CHARUB CHAR(UBYTES)BASED;
      552     2388        %EJECT;
PL6.E3A0      #003=FSD$JE File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:29 Page:109  
      553     2389    1           JDCB$= B$JIT.DCB$;

   2389  1 000002   000000 470400 xsym               LDP0    B$JIT$
         1 000003   000232 236100                    LDQ     154,,PR0
         1 000004   200005 756100                    STQ     JDCB$,,AUTO

      554     2390    2           DO CASE(FPTCODE);

   2390  1 000005   200003 471500                    LDP1    @FPTCODE,,AUTO
         1 000006   100000 235100                    LDA     0,,PR1
         1 000007   000010 115007                    CMPA    8,DL
         1 000010   000012 602005 1                  TNC     s:2390+5,AL
         1 000011   000113 710000 1                  TRA     s:2420
         1 000012   000113 710000 1                  TRA     s:2420
         1 000013   000036 710000 1                  TRA     s:2397
         1 000014   000113 710000 1                  TRA     s:2420
         1 000015   000113 710000 1                  TRA     s:2420
         1 000016   000113 710000 1                  TRA     s:2420
         1 000017   000113 710000 1                  TRA     s:2420
         1 000020   000113 710000 1                  TRA     s:2420
         1 000021   000022 710000 1                  TRA     s:2392

      555     2391    2            CASE(FPTWEOF);

      556     2392    2              MYFPTV=CONSTFPT.V;

   2392  1 000022   000100 100400                    MLR     fill='000'O
         1 000023   000010 000020 0                  ADSC9   CONSTFPT+8               cn=0,n=16
         1 000024   200006 000020                    ADSC9   MYFPTV,,AUTO             cn=0,n=16

      557     2393    2              MYFPTV.DVBYTE=MYFPTV.DVBYTE | %DVBYTE_DCBHDR#;

   2393  1 000025   200011 236100                    LDQ     MYFPTV+3,,AUTO
         1 000026   777000 376003                    ANQ     -512,DU
         1 000027   002000 276003                    ORQ     1024,DU
         1 000030   200011 552140                    STBQ    MYFPTV+3,'40'O,AUTO

PL6.E3A0      #003=FSD$JE File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:29 Page:110  
      558     2394    2              JDCB$->F$DCB.UBYTES=0;

   2394  1 000031   200005 473500                    LDP3    JDCB$,,AUTO
         1 000032   300076 450100                    STZ     62,,PR3

      559     2395    2              JDCB$->F$DCB.UB$=ADDR(B$JIT);

   2395  1 000033   000000 236000 xsym               LDQ     B$JIT$
         1 000034   300075 756100                    STQ     61,,PR3
         1 000035   000114 710000 1                  TRA     s:2422

      560     2396    2            CASE(FPTWRITE);

      561     2397    2              MYFPTV=FPTV;

   2397  1 000036   200004 473500                    LDP3    @FPTV,,AUTO
         1 000037   000100 100500                    MLR     fill='000'O
         1 000040   300000 000020                    ADSC9   0,,PR3                   cn=0,n=16
         1 000041   200006 000020                    ADSC9   MYFPTV,,AUTO             cn=0,n=16

      562     2398    2              MYFPTV.DVBYTE=MYFPTV.DVBYTE&

   2398  1 000042   200011 236100                    LDQ     MYFPTV+3,,AUTO
         1 000043   777000 376003                    ANQ     -512,DU
         1 000044   260000 376003                    ANQ     90112,DU
         1 000045   200011 552140                    STBQ    MYFPTV+3,'40'O,AUTO

      563     2399    2                (%DVBYTE_BP#|%DVBYTE_BIN#|%DVBYTE_TRANS#);
      564     2400    2              UBYTES=JDCB$->F$DCB.UBYTES;

   2400  1 000046   200005 474500                    LDP4    JDCB$,,AUTO
         1 000047   400076 235100                    LDA     62,,PR4
         1 000050   200012 755100                    STA     UBYTES,,AUTO

      565     2401    2              IF UBYTES ~=0 THEN

   2401  1 000051   000114 600000 1                  TZE     s:2422
PL6.E3A0      #003=FSD$JE File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:29 Page:111  

      566     2402    2                 IF JDCB$->F$DCB.UB$->CHAR1='!' THEN

   2402  1 000052   400075 475500                    LDP5    61,,PR4
         1 000053   040000 106500                    CMPC    fill='040'O
         1 000054   500000 000001                    ADSC9   0,,PR5                   cn=0,n=1
         1 000055   000000 000001 2                  ADSC9   0                        cn=0,n=1
         1 000056   000114 601000 1                  TNZ     s:2422

      567     2403    3   BANG_RECORD:  DO;

   2403  1 000057                       BANG_RECORD  null
      568     2404    3                    IF UBYTES > 1

   2404  1 000057   000002 115007                    CMPA    2,DL
         1 000060   000073 602000 1                  TNC     s:2412

      569     2405    3                    THEN
      570     2406    3                       IF SUBSTR (JDCB$ -> F$DCB.UB$ -> CHARUB, 0, 2) = '!!'

   2406  1 000061   040000 106500                    CMPC    fill='040'O
         1 000062   500000 000002                    ADSC9   0,,PR5                   cn=0,n=2
         1 000063   000014 000002 0                  ADSC9   CONSTFPT+12              cn=0,n=2
         1 000064   000073 601000 1                  TNZ     s:2412

      571     2407    4                       THEN DO;

      572     2408    4                          JDCB$ -> F$DCB.UB$ = PINCRC(JDCB$ -> F$DCB.UB$, 1);

   2408  1 000065   400075 236100                    LDQ     61,,PR4
         1 000066   200000 036007                    ADLQ    65536,DL
         1 000067   400075 756100                    STQ     61,,PR4

      573     2409    4                          JDCB$ -> F$DCB.UBYTES = UBYTES - 1;

   2409  1 000070   000001 135007                    SBLA    1,DL
         1 000071   400076 755100                    STA     62,,PR4
PL6.E3A0      #003=FSD$JE File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:29 Page:112  

      574     2410    4                          EXIT BANG_RECORD;

   2410  1 000072   000112 710000 1                  TRA     s:2418

      575     2411    4                          END;
      576     2412    4                    IF JDCB$->F$DCB.UB$->CHARUB = '!EOD' THEN DO;

   2412  1 000073   000000 620005                    EAX0    0,AL
         1 000074   040000 106540                    CMPC    fill='040'O
         1 000075   500000 000010                    ADSC9   0,,PR5                   cn=0,n=*X0
         1 000076   000015 000004 0                  ADSC9   CONSTFPT+13              cn=0,n=4
         1 000077   000106 601000 1                  TNZ     s:2417

      577     2413    4                       MYFPTV.DVBYTE=MYFPTV.DVBYTE|%DVBYTE_DCBHDR#;

   2413  1 000100   200011 236100                    LDQ     MYFPTV+3,,AUTO
         1 000101   777000 376003                    ANQ     -512,DU
         1 000102   002000 276003                    ORQ     1024,DU
         1 000103   200011 552140                    STBQ    MYFPTV+3,'40'O,AUTO

      578     2414    4                       JDCB$->F$DCB.UBYTES=0;

   2414  1 000104   400076 450100                    STZ     62,,PR4

      579     2415    4                       END;

   2415  1 000105   000114 710000 1                  TRA     s:2422

      580     2416    3                    ELSE
      581     2417    3                       MYFPTV.DVBYTE=MYFPTV.DVBYTE|%DVBYTE_NODAT#;

   2417  1 000106   200011 236100                    LDQ     MYFPTV+3,,AUTO
         1 000107   777000 376003                    ANQ     -512,DU
         1 000110   004000 276003                    ORQ     2048,DU
         1 000111   200011 552140                    STBQ    MYFPTV+3,'40'O,AUTO

PL6.E3A0      #003=FSD$JE File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:29 Page:113  
      582     2418    3                    END BANG_RECORD;

   2418  1 000112   000114 710000 1                  TRA     s:2422

      583     2419    2            CASE(ELSE);

      584     2420    2              RETURN;

   2420  1 000113   000000 702200 xent               TSX2  ! X66_ARET

      585     2421    2            END;

      586     2422    1           CALL FMH$CPMME(FPTWRITE,MYFPTV)ALTRET(ALTRETUR);

   2422  1 000114   200006 633500                    EPPR3   MYFPTV,,AUTO
         1 000115   200015 453500                    STP3    UBYTES+3,,AUTO
         1 000116   000001 236000 2                  LDQ     1
         1 000117   200014 756100                    STQ     UBYTES+2,,AUTO
         1 000120   200014 630500                    EPPR0   UBYTES+2,,AUTO
         1 000121   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000122   000000 701000 xent               TSX1    FMH$CPMME
         1 000123   000125 702000 1                  TSX2    ALTRETUR

      587     2423    1           RETURN;

   2423  1 000124   000000 702200 xent               TSX2  ! X66_ARET

   2419  1 000125                       ALTRETUR     null
      588     2424    1   ALTRETUR:;
      589     2425    1           ALTRETURN;

   2425  1 000125   000000 702200 xent               TSX2  ! X66_AALT

CONSTFPT
 Sect OctLoc
   0     000   000003 777640   000010 006000   000000 177640   000000 006014    ................
   0     004   000000 177640   000000 006014   000000 177640   000000 006014    ................
PL6.E3A0      #003=FSD$JE File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:29 Page:114  
   0     010   000000 400400   000000 000000   000000 000000   000000 000000    ................

(unnamed)
 Sect OctLoc
   0     014   041041 040040   041105 117104                                    !!  !EOD

(unnamed)
 Sect OctLoc
   2     000   041040 040040   000003 006000                                    !   ....
      590     2426    1   END;
      591     2427        %EOD;

PL6.E3A0      #003=FSD$JE File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:29 Page:115  
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   F_CP6.:E05TOU  is referenced.
   F_FPTCODE_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
   F$CP6V_C.:E05TOU  is referenced.
      No diagnostics issued in procedure FSD$JE.
PL6.E3A0      #003=FSD$JE File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:29 Page:116  

 **** Variables and constants ****

  ****  Section 000 RoData FSD$JE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(432)   r     1 CONSTFPT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FPTCODE                   4-0-0/w PTR         r     1 @FPTV
    *0-0-0/w SBIN        r     1 FPTCODE                   *0-0-0/d STRC(144)   r     1 FPTV
     5-0-0/w PTR         r     1 JDCB$                      6-0-0/d STRC(144)   r     1 MYFPTV
    12-0-0/w UBIN        r     1 UBYTES

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/c CHAR        r     1 CHAR1
     0-0-0/c ACHR        r     1 CHARUB                     0-0-0/d ASTR(3528)  r     1 F$DCB


   Procedure FSD$JE requires 86 words for executable code.
PL6.E3A0      #003=FSD$JE File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:29 Page:117  
   Procedure FSD$JE requires 14 words of local(AUTO) storage.
PL6.E3A0      #003=FSD$JE File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:29 Page:118  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=FSD$JE File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:29 Page:119  
          MINI XREF LISTING

ALTRETUR
      2419**LABEL    2422--CALLALT
B$JIT
       588**DCL      2395--ASSIGN
B$JIT.DCB$
       683**DCL      2389>>ASSIGN
B$JIT.ERR.MID
       594**DCL       594--REDEF
B$JIT$
       265**DCL       588--IMP-PTR  2389>>ASSIGN   2395>>ASSIGN
BANG_RECORD
      2403**LABEL    2410--EXIT
CHAR1
      2385**DCL      2402>>IF
CHARUB
      2387**DCL      2406>>IF       2412>>IF
CONSTFPT.STATION_
      2365**DCL      2365--REDEF
CONSTFPT.V
      2366**DCL      2363--DCLINIT  2392>>ASSIGN
CONSTFPT.V.DVBYTE.VFC#
      2372**DCL      2372--REDEF
F$DCB.ACTPOS
       722**DCL       722--REDEF
F$DCB.ARS
       697**DCL       697--REDEF
F$DCB.ATTR
       715**DCL       716--REDEF
F$DCB.BORROW
       730**DCL       730--REDEF     730--REDEF     730--REDEF
F$DCB.DCBNAME.L
       744**DCL       744--IMP-SIZ
PL6.E3A0      #003=FSD$JE File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:29 Page:120  
F$DCB.EOMCHAR
       701**DCL       701--REDEF
F$DCB.FLDID
       725**DCL       725--REDEF
F$DCB.FORM$
       719**DCL       719--REDEF
F$DCB.FSECT
       735**DCL       735--REDEF
F$DCB.FSN
       712**DCL       712--REDEF     712--REDEF     713--REDEF
F$DCB.HEADER$
       718**DCL       718--REDEF
F$DCB.IXTNSIZE
       716**DCL       716--REDEF
F$DCB.LASTSTA$
       706**DCL       706--REDEF
F$DCB.LVL
       731**DCL       731--REDEF
F$DCB.NAME.C
       706**DCL       706--REDEF
F$DCB.NOEOF
       727**DCL       727--REDEF
F$DCB.NRECS
       717**DCL       717--REDEF
F$DCB.NRECX
       736**DCL       736--REDEF
F$DCB.OHDR
       728**DCL       728--REDEF
F$DCB.ORG
       711**DCL       711--REDEF
F$DCB.PRECNO
       734**DCL       734--REDEF
F$DCB.RCSZ
       739**DCL       739--REDEF
F$DCB.RES
       707**DCL       707--REDEF
PL6.E3A0      #003=FSD$JE File=FSD$JCL.:E05TSI                                   TUE 07/29/97 17:29 Page:121  
F$DCB.SETX
       719**DCL       719--REDEF
F$DCB.TAB$
       718**DCL       719--REDEF
F$DCB.TDA
       733**DCL       733--REDEF
F$DCB.UB$
       735**DCL      2395<<ASSIGN   2402>>IF       2406>>IF       2408<<ASSIGN   2408>>ASSIGN   2412>>IF
F$DCB.UBYTES
       735**DCL      2394<<ASSIGN   2400>>ASSIGN   2409<<ASSIGN   2414<<ASSIGN
F$DCB.WSN
       708**DCL       708--REDEF
FMH$CPMME
       263**DCL-ENT  2422--CALL
FPTCODE
        29**DCL        28--PROC     2390>>DOCASE
FPTV
       257**DCL        28--PROC     2397>>ASSIGN
FPTV.DVBYTE.VFC
       259**DCL       259--REDEF
JDCB$
      2378**DCL      2389<<ASSIGN   2394>>ASSIGN   2395>>ASSIGN   2400>>ASSIGN   2402>>IF       2406>>IF
      2408>>ASSIGN   2408>>ASSIGN   2409>>ASSIGN   2412>>IF       2414>>ASSIGN
MYFPTV
      2380**DCL      2392<<ASSIGN   2397<<ASSIGN   2422<>CALL
MYFPTV.DVBYTE
      2381**DCL      2393<<ASSIGN   2393>>ASSIGN   2398<<ASSIGN   2398>>ASSIGN   2413<<ASSIGN   2413>>ASSIGN
      2417<<ASSIGN   2417>>ASSIGN
MYFPTV.DVBYTE.VFC
      2382**DCL      2382--REDEF
UBYTES
      2386**DCL      2387--IMP-SIZ  2400<<ASSIGN   2401>>IF       2404>>IF       2406>>IF       2409>>ASSIGN
      2412>>IF

PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:122  
      592        1        /*T***********************************************************/
      593        2        /*T*                                                         */
      594        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      595        4        /*T*                                                         */
      596        5        /*T***********************************************************/
      597        6        /*F*    NAME: FSD$JEJFOPN
      598        7         *      PURPOSE: FSD$JEJFOPN handles user M$OPEN PMME's to devices
      599        8         *         JE and JF.  These "devices" create control command files.
      600        9         *         JE files are batch jobs; JF files are XEQ's for this user.
      601       10         *      DESCRIPTION:   A DCB which is perceived by the user to be
      602       11         *         attached to DEVICE 'JE' is set up to be internally a file
      603       12         *         attached to DEVICE 'JE', is set up to be internally a file
      604       13         *         in the input symbiont account :SYMI.  The name of the file
      605       14         *         is made unique by developing it from a new Sysid which is
      606       15         *         gotten.
      607       16         *            Certain information which Prescan will need is placed
      608       17         *         in the UATTR of the file's FIT -- default wsn-of-origin,
      609       18         *         max job priority, etc.  If the opening user is the input
      610       19         *         symbiont, this information is taken from the user M$OPEN
      611       20         *         instead.
      612       21         *            A DCB which is perceived by the user to be attached
      613       22         *         to DEVICE 'JF' is set up to be internally a scratch file
      614       23         *         named '*X'.  (When the DCB is closed with SAVE, this will
      615       24         *         be internally fudged to become the star file '*X'; see
      616       25         *         FSD$JFCLS.)
      617       26         */
      618       27        /*D*    NAME: FSD$JEJFOPN
      619       28         *      CALL: CALL FSD$JEJFOPN(PN$) ALTRET;
      620       29         *      INTERFACE:  UMS$NXTSID, FMN$OPNF.
      621       30         *      ENVIRONMENT:   Monitor (for user) LS.
      622       31         *      INPUT:   DCB (B$JIT.DCB$).
      623       32         *               M$OPEN FPT (PN$).
      624       33         *      OURPUT:  DCB IS OPEN TO SYMBIONT FILE.
      625       34         */
      626       35        FSD$JEJFOPN: PROC(PN$) ALTRET;
      627       36        /*** * * * ***/
      628       37    1   DCL UMS$NXTSID ENTRY(1)ALTRET; /* Get next Sysid */
PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:123  
      629       38    1   DCL FMN$OPNF ENTRY(1); /* Open DCB to file                   */
      630       39        /*** * * * ***/
      631       40    1   DCL B$JIT$ PTR SYMREF; /* Note: B$JIT is BASED(B$JIT$).      */
      632       41    1   DCL FS_JEOK UBIN SYMREF; /* Nonzero if batching is disallowed */
      633       42        /*** * * * ***/
      634       43        %INCLUDE F_CP6;
      635     1068        %INCLUDE F$CP6P_C;
      636     1079        %MACRO F$DCBI(BASED=BASED);
      637     1080        %INCLUDE F$DCB;
      638     1129        %MEND;
      639     1130        %F$DCBI(BASED="BASED(JDCB$)");
      640     1180        %INCLUDE B$JIT;
      641     1783        %INCLUDE CP_6_SUBS;
      642     2323        %INCLUDE FS$FIT;
      643     2366        %FS$JOBORIG(STCLASS=BASED,SIZ=FIT);
      644     2372        %INCLUDE JG_GHOSTS_C;
      645     2462        %INCLUDE F_FMTCODE_C;
      646     2496        %INCLUDE F_ERRORS_C;
      647     2736        %INCLUDE FM$MACROS;
      648     3111        %SUB FCG#="'0623'O";
      649     3112        %SUB MID#="'04'O";
      650     3113        %ERRCODE(NAME=ERR$NOBATCH,COD#=%E$BATOFF);
      651     3117        /*E*    ERROR:   FSD-E$BATOFF-2
      652     3118                MESSAGE: Batching of jobs is disallowed.
      653     3119        */
      654     3120        /*** * * * ***/
      655     3121        %FPT_OPEN(FPTN=PN$,PFMT=PTR,STCLASS=);
      656     3230    1   DCL JDCB$ PTR;
      657     3231    1   DCL J UBIN;
      658     3232        %FPT$OPEN_P(FPTN=MYPN$,STCLASS=,PFMT=PTR);
      659     3238        %FS$JOBORIG(NAME=JEUATTR,STCLASS=,SIZ=NAWNDW);
      660     3244        /***   CONSTANT STORAGE   ***/
      661     3245    1   DCL 1 JEATTR CONSTANT,
      662     3246    1         2 NAW UBIN HALF UNAL INIT(200),
      663     3247    1         2 NDW UBIN HALF UNAL INIT(0);
      664     3248        %FPT_OPEN(FPTN=JEPN$,STCLASS=CONSTANT,PFMT=PTR,VECTOR=ADDR,
      665     3249                PROCATTR=JEATTR,INSTATTR=JEATTR);
PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:124  
      666     3358        %FS$XEQSAVE;
      667     3361    1   DCL 1 JFUATTR CONSTANT,
      668     3362    1         2 NAW UBIN HALF UNAL INIT(SIZEW(FS$XEQSAVE)),
      669     3363    1         2 NDW UBIN HALF UNAL INIT(0);
      670     3364        %FPT_OPEN(FPTN=JFPN$,STCLASS=CONSTANT,PFMT=PTR,VECTOR=ADDR,
      671     3365                UATTR=JFUATTR);
      672     3474        %EJECT;
PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:125  
      673     3475    1           JDCB$= B$JIT.DCB$;
      674     3476    1           F$DCB.IASN=%FILE#;
      675     3477    1           F$DCB.ORG=%CONSEC#;
      676     3478    1           F$DCB.FUN=%CREATE#;
      677     3479    1           F$DCB.ACS=%SEQUEN#;
      678     3480    1           F$DCB.COMP=%NO#;
      679     3481    1           F$DCB.CTG=%NO#;
      680     3482    1           F$DCB.PASS=' ';
      681     3483    1           F$DCB.PASSF=%NO#;
      682     3484    1           F$DCB.PSN=' ';
      683     3485    1           F$DCB.EXIST=%NEWFILE#;
      684     3486    1           F$DCB.TYPE='  ';
      685     3487    1           F$DCB.WSR=1;
      686     3488    1           B$JIT.FEXT(F$DCB.FEXTX)=%NO#; /*Never extend JE-JF*/
      687     3489    2           IF F$DCB.RES='JE' THEN DO;
      688     3490    2              F$DCB.NAME.L=7;
      689     3491    2              F$DCB.NAME.C='xxxxxxP';
      690     3492    2              F$DCB.ACCT=':SYMI';
      691     3493    2              F$DCB.DISP=%NAMED#;
      692     3494    2              F$DCB.RES='  ';
      693     3495    3              IF FS_JEOK~=0 THEN DO;
      694     3496    3   BATCHNOGOOD:  B$JIT.ERR=ERR$NOBATCH;
      695     3497    3                 ALTRETURN;
      696     3498    3                 END;
      697     3499    2              CALL UMS$NXTSID(J)ALTRET(BATCHNOGOOD);
      698     3500    2              B$JIT.LBJID=J;
      699     3501    2              CALL BINCHAR(SUBSTR(F$DCB.NAME.C,0,6),J);
      700     3502    2              MYPN$=JEPN$;
      701     3503    3              IF B$JIT.SYSID=JG_INSYM# AND PN$.UATTR_~=ADDR(NIL) THEN DO;
      702     3504    3                 JEUATTR=PN$.UATTR_->FS$JOBORIG;
      703     3505    3                 JEUATTR.NAW=200;
      704     3506    3                 END;
      705     3507    3              ELSE DO;
      706     3508    3                 JEUATTR.NAW=200;
      707     3509    3                 JEUATTR.NDW=SIZEW(JEUATTR)-1;
      708     3510    3                 JEUATTR.WOO=B$JIT.WOO;
      709     3511    3                 JEUATTR.SYSID=B$JIT.SYSID;
PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:126  
      710     3512    3                 JEUATTR.MAXPRI=B$JIT.MAXPRI;
      711     3513    3                 JEUATTR.DEFPRI=B$JIT.DEFPRI;
      712     3514    3                 JEUATTR.FLAG=B$JIT.MODE;
      713     3515    4                 IF B$JIT.ORIGINATOR_MODE=0 THEN DO;
      714     3516    4                    JEUATTR.ORIGINATOR_MODE=B$JIT.MODE;
      715     3517    4                    IF B$JIT.MODE=%M_GHOST# THEN
      716     3518    4                       JEUATTR.ORIGINATOR_PORT.FROM_GHOST.SYSID=B$JIT.SYSID;
      717     3519    5                    ELSE DO;
      718     3520    5                       JEUATTR.ORIGINATOR_PORT.FROM_INT.TSLINE=B$JIT.TSLINE;
      719     3521    5                       JEUATTR.ORIGINATOR_PORT.FROM_INT.SYSID=B$JIT.SYSID;
      720     3522    5                       END;
      721     3523    4                    END;
      722     3524    4                 ELSE DO;
      723     3525    4                    JEUATTR.ORIGINATOR_MODE=B$JIT.ORIGINATOR_MODE;
      724     3526    4                    JEUATTR.ORIGINATOR_PORT=B$JIT.ORIGINATOR_PORT;
      725     3527    4                    END;
      726     3528    3                 END;
      727     3529    2              MYPN$.UATTR_=ADDR(JEUATTR);
      728     3530    2              CALL FMN$OPNF(MYPN$);
      729     3531    2              F$DCB.RES='JE';
      730     3532    2              END;
      731     3533    2           ELSE DO;
      732     3534    2              F$DCB.RES='  ';
      733     3535    2              F$DCB.NAME.L=2;
      734     3536    2              F$DCB.NAME.C='*X';
      735     3537    2              F$DCB.DISP=%SCRATCH#;
      736     3538    2              MYPN$=JFPN$;
      737     3539    2              CALL FMN$OPNF(MYPN$);
      738     3540    2              F$DCB.RES='JF';
      739     3541    2              END;
      740     3542    1           IF B$JIT.ERR.CODE~=0 THEN ALTRETURN;
      741     3543    1           F$DCB.FFLG=%FFLG_WNEW#;
      742     3544    1           F$DCB.IFMT=FMTJCLOUT#;
      743     3545    1           RETURN;
      744     3546    1   END FSD$JEJFOPN;
      745     3547        %EOD;

PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:127  
--  Include file information  --

   FM$MACROS.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   F_FMTCODE_C.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   FS$FIT.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  is referenced.
   F$CP6P_C.:E05TOU  is referenced.
   F_CP6.:E05TOU  is referenced.
      No diagnostics issued in procedure FSD$JEJFOPN.

   Procedure FSD$JEJFOPN requires 191 words for executable code.
   Procedure FSD$JEJFOPN requires 36 words of local(AUTO) storage.

PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:128  

 Object Unit name= FSD$JEJFOPN                                File name= FSD$JCL.:E05TOU
 UTS= JUL 29 '97 17:29:11.64 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     92    134  FSD$JEJFOPN
    1   Proc  even  none   191    277  FSD$JEJFOPN
    2  RoData even  none     3      3  FSD$JEJFOPN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        1  FSD$JEJFOPN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 UMS$NXTSID
         yes           Std       1 FMN$OPNF
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$JIT$                                FS_JEOK                               B_VECTNIL
PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:129  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:130  


      592        1        /*T***********************************************************/
      593        2        /*T*                                                         */
      594        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      595        4        /*T*                                                         */
      596        5        /*T***********************************************************/
      597        6        /*F*    NAME: FSD$JEJFOPN
      598        7         *      PURPOSE: FSD$JEJFOPN handles user M$OPEN PMME's to devices
      599        8         *         JE and JF.  These "devices" create control command files.
      600        9         *         JE files are batch jobs; JF files are XEQ's for this user.
      601       10         *      DESCRIPTION:   A DCB which is perceived by the user to be
      602       11         *         attached to DEVICE 'JE' is set up to be internally a file
      603       12         *         attached to DEVICE 'JE', is set up to be internally a file
      604       13         *         in the input symbiont account :SYMI.  The name of the file
      605       14         *         is made unique by developing it from a new Sysid which is
      606       15         *         gotten.
      607       16         *            Certain information which Prescan will need is placed
      608       17         *         in the UATTR of the file's FIT -- default wsn-of-origin,
      609       18         *         max job priority, etc.  If the opening user is the input
      610       19         *         symbiont, this information is taken from the user M$OPEN
      611       20         *         instead.
      612       21         *            A DCB which is perceived by the user to be attached
      613       22         *         to DEVICE 'JF' is set up to be internally a scratch file
      614       23         *         named '*X'.  (When the DCB is closed with SAVE, this will
      615       24         *         be internally fudged to become the star file '*X'; see
      616       25         *         FSD$JFCLS.)
      617       26         */
      618       27        /*D*    NAME: FSD$JEJFOPN
      619       28         *      CALL: CALL FSD$JEJFOPN(PN$) ALTRET;
      620       29         *      INTERFACE:  UMS$NXTSID, FMN$OPNF.
      621       30         *      ENVIRONMENT:   Monitor (for user) LS.
      622       31         *      INPUT:   DCB (B$JIT.DCB$).
      623       32         *               M$OPEN FPT (PN$).
      624       33         *      OURPUT:  DCB IS OPEN TO SYMBIONT FILE.
      625       34         */
      626       35        FSD$JEJFOPN: PROC(PN$) ALTRET;

PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:131  
     35  1 000000   000000 700200 xent  FSD$JEJFOPN  TSX0  ! X66_AUTO_1
         1 000001   000044 000001                    ZERO    36,1

      627       36        /*** * * * ***/
      628       37    1   DCL UMS$NXTSID ENTRY(1)ALTRET; /* Get next Sysid */
      629       38    1   DCL FMN$OPNF ENTRY(1); /* Open DCB to file                   */
      630       39        /*** * * * ***/
      631       40    1   DCL B$JIT$ PTR SYMREF; /* Note: B$JIT is BASED(B$JIT$).      */
      632       41    1   DCL FS_JEOK UBIN SYMREF; /* Nonzero if batching is disallowed */
      633       42        /*** * * * ***/
      634       43        %INCLUDE F_CP6;
      635     1068        %INCLUDE F$CP6P_C;
      636     1079        %MACRO F$DCBI(BASED=BASED);
      637     1080        %INCLUDE F$DCB;
      638     1129        %MEND;
      639     1130        %F$DCBI(BASED="BASED(JDCB$)");
      640     1180        %INCLUDE B$JIT;
      641     1783        %INCLUDE CP_6_SUBS;
      642     2323        %INCLUDE FS$FIT;
      643     2366        %FS$JOBORIG(STCLASS=BASED,SIZ=FIT);
      644     2372        %INCLUDE JG_GHOSTS_C;
      645     2462        %INCLUDE F_FMTCODE_C;
      646     2496        %INCLUDE F_ERRORS_C;
      647     2736        %INCLUDE FM$MACROS;
      648     3111        %SUB FCG#="'0623'O";
      649     3112        %SUB MID#="'04'O";
      650     3113        %ERRCODE(NAME=ERR$NOBATCH,COD#=%E$BATOFF);
      651     3117        /*E*    ERROR:   FSD-E$BATOFF-2
      652     3118                MESSAGE: Batching of jobs is disallowed.
      653     3119        */
      654     3120        /*** * * * ***/
      655     3121        %FPT_OPEN(FPTN=PN$,PFMT=PTR,STCLASS=);
      656     3230    1   DCL JDCB$ PTR;
      657     3231    1   DCL J UBIN;
      658     3232        %FPT$OPEN_P(FPTN=MYPN$,STCLASS=,PFMT=PTR);
      659     3238        %FS$JOBORIG(NAME=JEUATTR,STCLASS=,SIZ=NAWNDW);
      660     3244        /***   CONSTANT STORAGE   ***/
PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:132  
      661     3245    1   DCL 1 JEATTR CONSTANT,
      662     3246    1         2 NAW UBIN HALF UNAL INIT(200),
      663     3247    1         2 NDW UBIN HALF UNAL INIT(0);
      664     3248        %FPT_OPEN(FPTN=JEPN$,STCLASS=CONSTANT,PFMT=PTR,VECTOR=ADDR,
      665     3249                PROCATTR=JEATTR,INSTATTR=JEATTR);
      666     3358        %FS$XEQSAVE;
      667     3361    1   DCL 1 JFUATTR CONSTANT,
      668     3362    1         2 NAW UBIN HALF UNAL INIT(SIZEW(FS$XEQSAVE)),
      669     3363    1         2 NDW UBIN HALF UNAL INIT(0);
      670     3364        %FPT_OPEN(FPTN=JFPN$,STCLASS=CONSTANT,PFMT=PTR,VECTOR=ADDR,
      671     3365                UATTR=JFUATTR);
      672     3474        %EJECT;
PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:133  
      673     3475    1           JDCB$= B$JIT.DCB$;

   3475  1 000002   000000 470400 xsym               LDP0    B$JIT$
         1 000003   000232 236100                    LDQ     154,,PR0
         1 000004   200004 756100                    STQ     JDCB$,,AUTO

      674     3476    1           F$DCB.IASN=%FILE#;

   3476  1 000005   200004 471500                    LDP1    JDCB$,,AUTO
         1 000006   000001 236007                    LDQ     1,DL
         1 000007   100103 552104                    STBQ    67,'04'O,PR1

      675     3477    1           F$DCB.ORG=%CONSEC#;

   3477  1 000010   001000 236003                    LDQ     512,DU
         1 000011   100032 552140                    STBQ    26,'40'O,PR1

      676     3478    1           F$DCB.FUN=%CREATE#;

   3478  1 000012   000003 236003                    LDQ     3,DU
         1 000013   100032 552120                    STBQ    26,'20'O,PR1

      677     3479    1           F$DCB.ACS=%SEQUEN#;

   3479  1 000014   000001 236007                    LDQ     1,DL
         1 000015   100036 552104                    STBQ    30,'04'O,PR1

      678     3480    1           F$DCB.COMP=%NO#;

   3480  1 000016   000000 236000 2                  LDQ     0
         1 000017   100031 356100                    ANSQ    25,,PR1

      679     3481    1           F$DCB.CTG=%NO#;

   3481  1 000020   000001 236000 2                  LDQ     1
         1 000021   100031 356100                    ANSQ    25,,PR1

PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:134  
      680     3482    1           F$DCB.PASS=' ';

   3482  1 000022   000035 235000 xsym               LDA     B_VECTNIL+29
         1 000023   000035 236000 xsym               LDQ     B_VECTNIL+29
         1 000024   100022 757100                    STAQ    18,,PR1

      681     3483    1           F$DCB.PASSF=%NO#;

   3483  1 000025   000002 236000 2                  LDQ     2
         1 000026   100031 356100                    ANSQ    25,,PR1

      682     3484    1           F$DCB.PSN=' ';

   3484  1 000027   040100 100400                    MLR     fill='040'O
         1 000030   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000031   100024 000006                    ADSC9   20,,PR1                  cn=0,n=6

      683     3485    1           F$DCB.EXIST=%NEWFILE#;

   3485  1 000032   003000 236007                    LDQ     1536,DL
         1 000033   100031 256100                    ORSQ    25,,PR1

      684     3486    1           F$DCB.TYPE='  ';

   3486  1 000034   000124 220000 0                  LDX0    JFPN$+40
         1 000035   100025 440100                    SXL0    21,,PR1

      685     3487    1           F$DCB.WSR=1;

   3487  1 000036   000001 236003                    LDQ     1,DU
         1 000037   100040 552120                    STBQ    32,'20'O,PR1

      686     3488    1           B$JIT.FEXT(F$DCB.FEXTX)=%NO#; /*Never extend JE-JF*/

   3488  1 000040   100034 236100                    LDQ     28,,PR1
         1 000041   000011 772000                    QRL     9
         1 000042   000777 376007                    ANQ     511,DL
PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:135  
         1 000043   003106 060400                    CSL     bolr='003'O
         1 000044   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         1 000045   000220 000001                    BDSC    144,Q,PR0                by=0,bit=0,n=1

      687     3489    2           IF F$DCB.RES='JE' THEN DO;

   3489  1 000046   040000 106500                    CMPC    fill='040'O
         1 000047   100026 000004                    ADSC9   22,,PR1                  cn=0,n=4
         1 000050   000125 000002 0                  ADSC9   JFPN$+41                 cn=0,n=2
         1 000051   000234 601000 1                  TNZ     s:3534

      688     3490    2              F$DCB.NAME.L=7;

   3490  1 000052   007000 236003                    LDQ     3584,DU
         1 000053   100010 552140                    STBQ    8,'40'O,PR1

      689     3491    2              F$DCB.NAME.C='xxxxxxP';

   3491  1 000054   040100 100400                    MLR     fill='040'O
         1 000055   000126 000007 0                  ADSC9   JFPN$+42                 cn=0,n=7
         1 000056   100010 200037                    ADSC9   8,,PR1                   cn=1,n=31

      690     3492    2              F$DCB.ACCT=':SYMI';

   3492  1 000057   040100 100400                    MLR     fill='040'O
         1 000060   000130 000005 0                  ADSC9   JFPN$+44                 cn=0,n=5
         1 000061   100020 000010                    ADSC9   16,,PR1                  cn=0,n=8

      691     3493    2              F$DCB.DISP=%NAMED#;

   3493  1 000062   000002 236007                    LDQ     2,DL
         1 000063   100032 552104                    STBQ    26,'04'O,PR1

      692     3494    2              F$DCB.RES='  ';

   3494  1 000064   000124 236000 0                  LDQ     JFPN$+40
         1 000065   777777 376003                    ANQ     -1,DU
PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:136  
         1 000066   040040 276007                    ORQ     16416,DL
         1 000067   100026 756100                    STQ     22,,PR1

      693     3495    3              IF FS_JEOK~=0 THEN DO;

   3495  1 000070   000000 235000 xsym               LDA     FS_JEOK
         1 000071   000076 600000 1                  TZE     s:3499

      694     3496    3   BATCHNOGOOD:  B$JIT.ERR=ERR$NOBATCH;

   3496  1 000072   000000 236000 0     BATCHNOGOOD  LDQ     ERR$NOBATCH
         1 000073   000000 470400 xsym               LDP0    B$JIT$
         1 000074   000012 756100                    STQ     10,,PR0

      695     3497    3                 ALTRETURN;

   3497  1 000075   000000 702200 xent               TSX2  ! X66_AALT

      696     3498    3                 END;
      697     3499    2              CALL UMS$NXTSID(J)ALTRET(BATCHNOGOOD);

   3499  1 000076   200005 630500                    EPPR0   J,,AUTO
         1 000077   200042 450500                    STP0    JEUATTR+9,,AUTO
         1 000100   200042 630500                    EPPR0   JEUATTR+9,,AUTO
         1 000101   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000102   000000 701000 xent               TSX1    UMS$NXTSID
         1 000103   000072 702000 1                  TSX2    BATCHNOGOOD

      698     3500    2              B$JIT.LBJID=J;

   3500  1 000104   200005 720100                    LXL0    J,,AUTO
         1 000105   000000 470400 xsym               LDP0    B$JIT$
         1 000106   000302 440100                    SXL0    194,,PR0

      699     3501    2              CALL BINCHAR(SUBSTR(F$DCB.NAME.C,0,6),J);

   3501  1 000107   200005 235100                    LDA     J,,AUTO
PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:137  
         1 000110   000044 773000                    LRL     36
         1 000111   200042 757100                    STAQ    JEUATTR+9,,AUTO
         1 000112   200004 471500                    LDP1    JDCB$,,AUTO
         1 000113   000100 301500                    BTD
         1 000114   200042 000010                    NDSC9   JEUATTR+9,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         1 000115   100010 230006                    NDSC9   8,,PR1                   cn=1,s=nosgn,sf=0,n=6

      700     3502    2              MYPN$=JEPN$;

   3502  1 000116   000100 100400                    MLR     fill='000'O
         1 000117   000002 000114 0                  ADSC9   JEPN$                    cn=0,n=76
         1 000120   200006 000114                    ADSC9   MYPN$,,AUTO              cn=0,n=76

      701     3503    3              IF B$JIT.SYSID=JG_INSYM# AND PN$.UATTR_~=ADDR(NIL) THEN DO;

   3503  1 000121   000000 721100                    LXL1    0,,PR0
         1 000122   000005 101003                    CMPX1   5,DU
         1 000123   000137 601000 1                  TNZ     s:3508
         1 000124   200003 473500                    LDP3    @PN$,,AUTO
         1 000125   300007 236100                    LDQ     7,,PR3
         1 000126   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000127   000137 600000 1                  TZE     s:3508

      702     3504    3                 JEUATTR=PN$.UATTR_->FS$JOBORIG;

   3504  1 000130   300007 474500                    LDP4    7,,PR3
         1 000131   000100 100500                    MLR     fill='000'O
         1 000132   400000 000044                    ADSC9   0,,PR4                   cn=0,n=36
         1 000133   200031 000044                    ADSC9   JEUATTR,,AUTO            cn=0,n=36

      703     3505    3                 JEUATTR.NAW=200;

   3505  1 000134   000310 221003                    LDX1    200,DU
         1 000135   200031 741100                    STX1    JEUATTR,,AUTO

      704     3506    3                 END;

PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:138  
   3506  1 000136   000216 710000 1                  TRA     s:3529

      705     3507    3              ELSE DO;

      706     3508    3                 JEUATTR.NAW=200;

   3508  1 000137   000310 222003                    LDX2    200,DU
         1 000140   200031 742100                    STX2    JEUATTR,,AUTO

      707     3509    3                 JEUATTR.NDW=SIZEW(JEUATTR)-1;

   3509  1 000141   000010 221003                    LDX1    8,DU
         1 000142   200031 441100                    SXL1    JEUATTR,,AUTO

      708     3510    3                 JEUATTR.WOO=B$JIT.WOO;

   3510  1 000143   000010 237100                    LDAQ    8,,PR0
         1 000144   200035 755100                    STA     JEUATTR+4,,AUTO
         1 000145   200036 756100                    STQ     JEUATTR+5,,AUTO

      709     3511    3                 JEUATTR.SYSID=B$JIT.SYSID;

   3511  1 000146   000000 723100                    LXL3    0,,PR0
         1 000147   200037 743100                    STX3    JEUATTR+6,,AUTO

      710     3512    3                 JEUATTR.MAXPRI=B$JIT.MAXPRI;

   3512  1 000150   000153 236100                    LDQ     107,,PR0
         1 000151   000011 772000                    QRL     9
         1 000152   200037 552110                    STBQ    JEUATTR+6,'10'O,AUTO

      711     3513    3                 JEUATTR.DEFPRI=B$JIT.DEFPRI;

   3513  1 000153   000153 236100                    LDQ     107,,PR0
         1 000154   000033 772000                    QRL     27
         1 000155   200037 552104                    STBQ    JEUATTR+6,'04'O,AUTO

PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:139  
      712     3514    3                 JEUATTR.FLAG=B$JIT.MODE;

   3514  1 000156   000000 236100                    LDQ     0,,PR0
         1 000157   740000 376003                    ANQ     -16384,DU
         1 000160   000005 772000                    QRL     5
         1 000161   200040 552140                    STBQ    JEUATTR+7,'40'O,AUTO

      713     3515    4                 IF B$JIT.ORIGINATOR_MODE=0 THEN DO;

   3515  1 000162   000325 236100                    LDQ     213,,PR0
         1 000163   000017 316003                    CANQ    15,DU
         1 000164   000207 601000 1                  TNZ     s:3525

      714     3516    4                    JEUATTR.ORIGINATOR_MODE=B$JIT.MODE;

   3516  1 000165   000000 236100                    LDQ     0,,PR0
         1 000166   000011 772000                    QRL     9
         1 000167   200040 676100                    ERQ     JEUATTR+7,,AUTO
         1 000170   000740 376003                    ANQ     480,DU
         1 000171   200040 656100                    ERSQ    JEUATTR+7,,AUTO

      715     3517    4                    IF B$JIT.MODE=%M_GHOST# THEN

   3517  1 000172   000000 236100                    LDQ     0,,PR0
         1 000173   740000 376003                    ANQ     -16384,DU
         1 000174   100000 116003                    CMPQ    32768,DU
         1 000175   000201 601000 1                  TNZ     s:3520

      716     3518    4                       JEUATTR.ORIGINATOR_PORT.FROM_GHOST.SYSID=B$JIT.SYSID;

   3518  1 000176   000000 723100                    LXL3    0,,PR0
         1 000177   200032 743100                    STX3    JEUATTR+1,,AUTO
         1 000200   000216 710000 1                  TRA     s:3529

      717     3519    5                    ELSE DO;

      718     3520    5                       JEUATTR.ORIGINATOR_PORT.FROM_INT.TSLINE=B$JIT.TSLINE;
PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:140  

   3520  1 000201   000100 100500                    MLR     fill='000'O
         1 000202   000337 000012                    ADSC9   223,,PR0                 cn=0,n=10
         1 000203   200032 000012                    ADSC9   JEUATTR+1,,AUTO          cn=0,n=10

      719     3521    5                       JEUATTR.ORIGINATOR_PORT.FROM_INT.SYSID=B$JIT.SYSID;

   3521  1 000204   000000 723100                    LXL3    0,,PR0
         1 000205   200034 443100                    SXL3    JEUATTR+3,,AUTO

      720     3522    5                       END;

      721     3523    4                    END;

   3523  1 000206   000216 710000 1                  TRA     s:3529

      722     3524    4                 ELSE DO;

      723     3525    4                    JEUATTR.ORIGINATOR_MODE=B$JIT.ORIGINATOR_MODE;

   3525  1 000207   000005 736000                    QLS     5
         1 000210   200040 676100                    ERQ     JEUATTR+7,,AUTO
         1 000211   000740 376003                    ANQ     480,DU
         1 000212   200040 656100                    ERSQ    JEUATTR+7,,AUTO

      724     3526    4                    JEUATTR.ORIGINATOR_PORT=B$JIT.ORIGINATOR_PORT;

   3526  1 000213   000100 100500                    MLR     fill='000'O
         1 000214   000337 000014                    ADSC9   223,,PR0                 cn=0,n=12
         1 000215   200032 000014                    ADSC9   JEUATTR+1,,AUTO          cn=0,n=12

      725     3527    4                    END;

      726     3528    3                 END;

      727     3529    2              MYPN$.UATTR_=ADDR(JEUATTR);

PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:141  
   3529  1 000216   200031 633500                    EPPR3   JEUATTR,,AUTO
         1 000217   200015 453500                    STP3    MYPN$+7,,AUTO

      728     3530    2              CALL FMN$OPNF(MYPN$);

   3530  1 000220   200006 634500                    EPPR4   MYPN$,,AUTO
         1 000221   200042 454500                    STP4    JEUATTR+9,,AUTO
         1 000222   200042 630500                    EPPR0   JEUATTR+9,,AUTO
         1 000223   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000224   000000 701000 xent               TSX1    FMN$OPNF
         1 000225   000000 011000                    NOP     0

      729     3531    2              F$DCB.RES='JE';

   3531  1 000226   000125 236000 0                  LDQ     JFPN$+41
         1 000227   777777 376003                    ANQ     -1,DU
         1 000230   040040 276007                    ORQ     16416,DL
         1 000231   200004 470500                    LDP0    JDCB$,,AUTO
         1 000232   000026 756100                    STQ     22,,PR0

      730     3532    2              END;

   3532  1 000233   000265 710000 1                  TRA     s:3542

      731     3533    2           ELSE DO;

      732     3534    2              F$DCB.RES='  ';

   3534  1 000234   000124 236000 0                  LDQ     JFPN$+40
         1 000235   777777 376003                    ANQ     -1,DU
         1 000236   040040 276007                    ORQ     16416,DL
         1 000237   100026 756100                    STQ     22,,PR1

      733     3535    2              F$DCB.NAME.L=2;

   3535  1 000240   002000 236003                    LDQ     1024,DU
         1 000241   100010 552140                    STBQ    8,'40'O,PR1
PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:142  

      734     3536    2              F$DCB.NAME.C='*X';

   3536  1 000242   040100 100400                    MLR     fill='040'O
         1 000243   000132 000002 0                  ADSC9   JFPN$+46                 cn=0,n=2
         1 000244   100010 200037                    ADSC9   8,,PR1                   cn=1,n=31

      735     3537    2              F$DCB.DISP=%SCRATCH#;

   3537  1 000245   000001 236007                    LDQ     1,DL
         1 000246   100032 552104                    STBQ    26,'04'O,PR1

      736     3538    2              MYPN$=JFPN$;

   3538  1 000247   000100 100400                    MLR     fill='000'O
         1 000250   000054 000114 0                  ADSC9   JFPN$                    cn=0,n=76
         1 000251   200006 000114                    ADSC9   MYPN$,,AUTO              cn=0,n=76

      737     3539    2              CALL FMN$OPNF(MYPN$);

   3539  1 000252   200006 630500                    EPPR0   MYPN$,,AUTO
         1 000253   200042 450500                    STP0    JEUATTR+9,,AUTO
         1 000254   200042 630500                    EPPR0   JEUATTR+9,,AUTO
         1 000255   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000256   000000 701000 xent               TSX1    FMN$OPNF
         1 000257   000000 011000                    NOP     0

      738     3540    2              F$DCB.RES='JF';

   3540  1 000260   000133 236000 0                  LDQ     JFPN$+47
         1 000261   777777 376003                    ANQ     -1,DU
         1 000262   040040 276007                    ORQ     16416,DL
         1 000263   200004 470500                    LDP0    JDCB$,,AUTO
         1 000264   000026 756100                    STQ     22,,PR0

      739     3541    2              END;

PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:143  
      740     3542    1           IF B$JIT.ERR.CODE~=0 THEN ALTRETURN;

   3542  1 000265   000000 471400 xsym               LDP1    B$JIT$
         1 000266   100012 236100                    LDQ     10,,PR1
         1 000267   377770 316007                    CANQ    131064,DL
         1 000270   000272 600000 1                  TZE     s:3543

   3542  1 000271   000000 702200 xent               TSX2  ! X66_AALT

      741     3543    1           F$DCB.FFLG=%FFLG_WNEW#;

   3543  1 000272   100000 220003                    LDX0    32768,DU
         1 000273   000004 740100                    STX0    4,,PR0

      742     3544    1           F$DCB.IFMT=FMTJCLOUT#;

   3544  1 000274   011000 236003                    LDQ     4608,DU
         1 000275   000103 552140                    STBQ    67,'40'O,PR0

      743     3545    1           RETURN;

   3545  1 000276   000000 702200 xent               TSX2  ! X66_ARET

ERR$NOBATCH
 Sect OctLoc
   0     000   062304 014032                                                    2...

JEATTR
 Sect OctLoc
   0     001   000310 000000                                                    ....

JEPN$
 Sect OctLoc
   0     002   000024 006000   000000 006014   000000 006014   000000 006014    ................
   0     006   000000 006014   000000 006014   000000 006014   000000 006014    ................
   0     012   000001 006000   000001 006000   000000 006014   000000 006014    ................
   0     016   000000 006014   000000 006014   000000 006014   000000 006014    ................
PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:144  
   0     022   000000 006014   000000 006014   000000 000042   000000 000000    ..........."....
   0     026   252525 000000   000040 252520   000040 040040   000000 000000    ..... ...   ....
   0     032   000000 777777   000000 000000   000000 000000   000000 000000    ................
   0     036   000000 000000   000000 000000   251000 622000   000000 000000    ................
   0     042   000000 000000   111250 000000   040040 040040   000000 000000    ....I...    ....
   0     046   000000 000000   000000 000000   000000 000000   ****** ******    ................

JFUATTR
 Sect OctLoc
   0     052   000002 000000                                                    ....

JFPN$
 Sect OctLoc
   0     054   000076 006000   000000 006014   000000 006014   000000 006014    .>..............
   0     060   000000 006014   000000 006014   000000 006014   000052 006000    .............*..
   0     064   000000 006014   000000 006014   000000 006014   000000 006014    ................
   0     074*  000000 006014   000000 006014   000000 000042   000000 000000    ..........."....
   0     100   252525 000000   000040 252520   000040 040040   000000 000000    ..... ...   ....
   0     104   000000 777777   000000 000000   000000 000000   000000 000000    ................
   0     110   000000 000000   000000 000000   251000 622000   000000 000000    ................
   0     114   000000 000000   111250 000000   040040 040040   000000 000000    ....I...    ....
   0     120   000000 000000   000000 000000   000000 000000   ****** ******    ................

(unnamed)
 Sect OctLoc
   0     124   040040 040040   112105 040040   170170 170170   170170 120040        JE  xxxxxxP
   0     130   072123 131115   111040 040040   052130 040040   112106 040040    :SYMI   *X  JF

(unnamed)
 Sect OctLoc
   2     000   777777 777677   777777 773777   777777 377777                    ............
      744     3546    1   END FSD$JEJFOPN;
      745     3547        %EOD;

PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:145  
--  Include file information  --

   FM$MACROS.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   F_FMTCODE_C.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   FS$FIT.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  is referenced.
   F$CP6P_C.:E05TOU  is referenced.
   F_CP6.:E05TOU  is referenced.
      No diagnostics issued in procedure FSD$JEJFOPN.
PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:146  

 **** Variables and constants ****

  ****  Section 000 RoData FSD$JEJFOPN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b STRC        r     1 ERR$NOBATCH                1-0-0/b STRC        r     1 JEATTR
     2-0-0/d STRC(1440)  r     1 JEPN$                     54-0-0/d STRC(1440)  r     1 JFPN$
    52-0-0/b STRC        r     1 JFUATTR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @PN$                       5-0-0/w UBIN        r     1 J
     4-0-0/w PTR         r     1 JDCB$                     31-0-0/w STRC(324)   r     1 JEUATTR
     6-0-0/w STRC(684)   r     1 MYPN$                     *0-0-0/d STRC(1440)  r     1 PN$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w UBIN        r     1 FS_JEOK

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/w STRC(324)   r     1 FS$JOBORIG                 0-0-0/w STRC(72)    r     1 FS$XEQSAVE

PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:147  

   Procedure FSD$JEJFOPN requires 191 words for executable code.
   Procedure FSD$JEJFOPN requires 36 words of local(AUTO) storage.
PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:148  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:149  
          MINI XREF LISTING

B$JIT.CPFLAGS1.SLEAZE
      1601**DCL      1601--REDEF
B$JIT.DCB$
      1675**DCL      3475>>ASSIGN
B$JIT.DEFPRI
      1655**DCL      3513>>ASSIGN
B$JIT.ERR
      1507**DCL      3496<<ASSIGN
B$JIT.ERR.CODE
      1508**DCL      3542>>IF
B$JIT.ERR.MID
      1508**DCL      1508--REDEF
B$JIT.FEXT
      1675**DCL      3488<<ASSIGN
B$JIT.JRESPEAK
      1669**DCL      1670--REDEF
B$JIT.LBJID
      1683**DCL      3500<<ASSIGN
B$JIT.MAXPRI
      1655**DCL      3512>>ASSIGN
B$JIT.MODE
      1502**DCL      3514>>ASSIGN   3516>>ASSIGN   3517>>IF
B$JIT.ORIGINATOR_MODE
      1774**DCL      3515>>IF       3525>>ASSIGN
B$JIT.ORIGINATOR_PORT
      1777**DCL      3526>>ASSIGN
B$JIT.ORIGINATOR_PORT.FROM_CR
      1778**DCL      1778--REDEF    1779--REDEF
B$JIT.PNR
      1682**DCL      1682--REDEF
B$JIT.SYSID
      1507**DCL      3503>>IF       3511>>ASSIGN   3518>>ASSIGN   3521>>ASSIGN
PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:150  
B$JIT.TSLINE
      1776**DCL      1777--REDEF    3520>>ASSIGN
B$JIT.WOO
      1507**DCL      3510>>ASSIGN
B$JIT$
        40**DCL      1502--IMP-PTR  3475>>ASSIGN   3488>>ASSIGN   3496>>ASSIGN   3500>>ASSIGN   3503>>IF
      3510>>ASSIGN   3511>>ASSIGN   3512>>ASSIGN   3513>>ASSIGN   3514>>ASSIGN   3515>>IF       3516>>ASSIGN
      3517>>IF       3518>>ASSIGN   3520>>ASSIGN   3521>>ASSIGN   3525>>ASSIGN   3526>>ASSIGN   3542>>IF
BATCHNOGOOD
      3496**LABEL    3499--CALLALT
ERR$NOBATCH
      3114**DCL      3496>>ASSIGN
F$DCB.ACCT
      1141**DCL      3492<<ASSIGN
F$DCB.ACS
      1148**DCL      3479<<ASSIGN
F$DCB.ACTPOS
      1156**DCL      1156--REDEF
F$DCB.ARS
      1131**DCL      1131--REDEF
F$DCB.ATTR
      1149**DCL      1150--REDEF
F$DCB.BORROW
      1164**DCL      1164--REDEF    1164--REDEF    1164--REDEF
F$DCB.COMP
      1144**DCL      3480<<ASSIGN
F$DCB.CTG
      1144**DCL      3481<<ASSIGN
F$DCB.DCBNAME.L
      1178**DCL      1178--IMP-SIZ
F$DCB.DISP
      1146**DCL      3493<<ASSIGN   3537<<ASSIGN
F$DCB.EOMCHAR
      1135**DCL      1135--REDEF
F$DCB.EXIST
      1144**DCL      3485<<ASSIGN
PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:151  
F$DCB.FEXTX
      1147**DCL      3488>>ASSIGN
F$DCB.FFLG
      1135**DCL      3543<<ASSIGN
F$DCB.FLDID
      1159**DCL      1159--REDEF
F$DCB.FORM$
      1153**DCL      1153--REDEF
F$DCB.FSECT
      1169**DCL      1169--REDEF
F$DCB.FSN
      1146**DCL      1146--REDEF    1146--REDEF    1147--REDEF
F$DCB.FUN
      1145**DCL      3478<<ASSIGN
F$DCB.HEADER$
      1152**DCL      1152--REDEF
F$DCB.IASN
      1172**DCL      3476<<ASSIGN
F$DCB.IFMT
      1171**DCL      3544<<ASSIGN
F$DCB.IXTNSIZE
      1150**DCL      1150--REDEF
F$DCB.LASTSTA$
      1140**DCL      1140--REDEF
F$DCB.LVL
      1165**DCL      1165--REDEF
F$DCB.NAME.C
      1140**DCL      1140--REDEF    3491<<ASSIGN   3501<<CALLBLT  3536<<ASSIGN
F$DCB.NAME.L
      1140**DCL      3490<<ASSIGN   3535<<ASSIGN
F$DCB.NOEOF
      1161**DCL      1161--REDEF
F$DCB.NRECS
      1151**DCL      1151--REDEF
F$DCB.NRECX
      1170**DCL      1170--REDEF
PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:152  
F$DCB.OHDR
      1162**DCL      1162--REDEF
F$DCB.ORG
      1145**DCL      1145--REDEF    3477<<ASSIGN
F$DCB.PASS
      1141**DCL      3482<<ASSIGN
F$DCB.PASSF
      1143**DCL      3483<<ASSIGN
F$DCB.PRECNO
      1168**DCL      1168--REDEF
F$DCB.PSN
      1141**DCL      3484<<ASSIGN
F$DCB.RCSZ
      1173**DCL      1173--REDEF
F$DCB.RES
      1141**DCL      1141--REDEF    3489>>IF       3494<<ASSIGN   3531<<ASSIGN   3534<<ASSIGN   3540<<ASSIGN
F$DCB.SETX
      1153**DCL      1153--REDEF
F$DCB.TAB$
      1152**DCL      1153--REDEF
F$DCB.TDA
      1167**DCL      1167--REDEF
F$DCB.TYPE
      1141**DCL      3486<<ASSIGN
F$DCB.WSN
      1142**DCL      1142--REDEF
F$DCB.WSR
      1148**DCL      3487<<ASSIGN
FMN$OPNF
        38**DCL-ENT  3530--CALL     3539--CALL
FS$JOBORIG
      2367**DCL      3504>>ASSIGN
FS$JOBORIG.ORIGINATOR_PORT.FROM_CR
      2367**DCL      2367--REDEF    2368--REDEF
FS$XEQSAVE
      3359**DCL      3362--DCLINIT
PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:153  
FS_JEOK
        41**DCL      3495>>IF
J
      3231**DCL      3499<>CALL     3500>>ASSIGN   3501>>CALLBLT
JDCB$
      3230**DCL      1131--IMP-PTR  3475<<ASSIGN   3476>>ASSIGN   3477>>ASSIGN   3478>>ASSIGN   3479>>ASSIGN
      3480>>ASSIGN   3481>>ASSIGN   3482>>ASSIGN   3483>>ASSIGN   3484>>ASSIGN   3485>>ASSIGN   3486>>ASSIGN
      3487>>ASSIGN   3488>>ASSIGN   3489>>IF       3490>>ASSIGN   3491>>ASSIGN   3492>>ASSIGN   3493>>ASSIGN
      3494>>ASSIGN   3501>>CALLBLT  3531>>ASSIGN   3534>>ASSIGN   3535>>ASSIGN   3536>>ASSIGN   3537>>ASSIGN
      3540>>ASSIGN   3543>>ASSIGN   3544>>ASSIGN
JEATTR
      3245**DCL      3318--DCLINIT  3318--DCLINIT
JEPN$
      3314**DCL      3502>>ASSIGN
JEPN$.ACSVEH_
      3316**DCL      3317--REDEF
JEPN$.ALTKEYS_
      3322**DCL      3323--REDEF    3323--REDEF
JEPN$.HDR_
      3321**DCL      3322--REDEF
JEPN$.TAB_
      3320**DCL      3321--REDEF
JEPN$.UHL_
      3314**DCL      3315--REDEF    3315--REDEF
JEPN$.V
      3323**DCL      3314--DCLINIT
JEPN$.V.FSN#
      3354**DCL      3354--REDEF    3354--REDEF
JEPN$.WSN_
      3320**DCL      3320--REDEF
JEUATTR
      3239**DCL      3504<<ASSIGN   3509--ASSIGN   3529--ASSIGN
JEUATTR.DEFPRI
      3242**DCL      3513<<ASSIGN
JEUATTR.FLAG
      3242**DCL      3514<<ASSIGN
PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:154  
JEUATTR.MAXPRI
      3242**DCL      3512<<ASSIGN
JEUATTR.NAW
      3239**DCL      3505<<ASSIGN   3508<<ASSIGN
JEUATTR.NDW
      3239**DCL      3509<<ASSIGN
JEUATTR.ORIGINATOR_MODE
      3242**DCL      3516<<ASSIGN   3525<<ASSIGN
JEUATTR.ORIGINATOR_PORT
      3239**DCL      3526<<ASSIGN
JEUATTR.ORIGINATOR_PORT.FROM_CR
      3239**DCL      3239--REDEF    3240--REDEF
JEUATTR.ORIGINATOR_PORT.FROM_GHOST.SYSID
      3239**DCL      3518<<ASSIGN
JEUATTR.ORIGINATOR_PORT.FROM_INT.SYSID
      3241**DCL      3521<<ASSIGN
JEUATTR.ORIGINATOR_PORT.FROM_INT.TSLINE
      3240**DCL      3520<<ASSIGN
JEUATTR.SYSID
      3241**DCL      3511<<ASSIGN
JEUATTR.WOO
      3241**DCL      3510<<ASSIGN
JFPN$
      3430**DCL      3538>>ASSIGN
JFPN$.ACSVEH_
      3432**DCL      3433--REDEF
JFPN$.ALTKEYS_
      3438**DCL      3439--REDEF    3439--REDEF
JFPN$.HDR_
      3437**DCL      3438--REDEF
JFPN$.TAB_
      3436**DCL      3437--REDEF
JFPN$.UHL_
      3430**DCL      3431--REDEF    3431--REDEF
JFPN$.V
      3439**DCL      3430--DCLINIT
PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:155  
JFPN$.V.FSN#
      3470**DCL      3470--REDEF    3470--REDEF
JFPN$.WSN_
      3436**DCL      3436--REDEF
JFUATTR
      3361**DCL      3433--DCLINIT
MYPN$
      3233**DCL      3502<<ASSIGN   3530<>CALL     3538<<ASSIGN   3539<>CALL
MYPN$.ACSVEH_
      3234**DCL      3234--REDEF
MYPN$.ALTKEYS_
      3236**DCL      3236--REDEF    3236--REDEF
MYPN$.HDR_
      3235**DCL      3235--REDEF
MYPN$.TAB_
      3235**DCL      3235--REDEF
MYPN$.UATTR_
      3234**DCL      3529<<ASSIGN
MYPN$.UHL_
      3233**DCL      3233--REDEF    3233--REDEF
MYPN$.WSN_
      3235**DCL      3235--REDEF
PN$
      3186**DCL        35--PROC
PN$.ACSVEH_
      3188**DCL      3189--REDEF
PN$.ALTKEYS_
      3194**DCL      3195--REDEF    3195--REDEF
PN$.HDR_
      3193**DCL      3194--REDEF
PN$.TAB_
      3192**DCL      3193--REDEF
PN$.UATTR_
      3189**DCL      3503>>IF       3504>>ASSIGN
PN$.UHL_
      3186**DCL      3187--REDEF    3187--REDEF
PL6.E3A0      #004=FSD$JEJFOPN File=FSD$JCL.:E05TSI                              TUE 07/29/97 17:29 Page:156  
PN$.V.FSN#
      3226**DCL      3226--REDEF    3226--REDEF
PN$.WSN_
      3192**DCL      3192--REDEF
UMS$NXTSID
        37**DCL-ENT  3499--CALL

PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:157  
      746        1        /*T***********************************************************/
      747        2        /*T*                                                         */
      748        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      749        4        /*T*                                                         */
      750        5        /*T***********************************************************/
      751        6        /*F*    NAME: FSD$JFCLS
      752        7         *      PURPOSE: FSD$JFCLS handles user M$CLOSE PMME's to JF (i.e.,
      753        8         *         converting an XEQ file into control command input).
      754        9         *      DESCRIPTION: The DCB, which is perceived by the user to be
      755       10         *         attached to device 'JE', is actually at this point in
      756       11         *         time attached to file '*X', opened for scratch create.
      757       12         *            We never get called on a non-SAVE M$CLOSE; the
      758       13         *         file is simply closed.
      759       14         *            On an M$CLOSE with SAVE, the scratch file attached
      760       15         *         to the DCB is converted to a SAVE file named '*X'.  If
      761       16         *         there already is a *X, its FIT disk address is remembered
      762       17         *         in the new file (XEQ within XEQ).  This requires that
      763       18         *         DCB's open to current command stream be closed so that the
      764       19         *         old *X won't be open.  Some CFU fudging takes place.
      765       20         *            The CR01 stream description is then updated to indicate
      766       21         *         that *X, record #0, is the current control command place.
      767       22         */
      768       23        FSD$JFCLS: PROC(PN$);
      769       24        /*** * * * ***/
      770       25    1   DCL FSD$C1END ENTRY ALTRET; /* Dump after-ended XEQ file */
      771       26    1   DCL FMP$CLSF ENTRY(1); /* Close Disk File                    */
      772       27    1   DCL FMR$L8 ENTRY; /* Lock CFU area                      */
      773       28    1   DCL FMR$U8 ENTRY; /* Unlock CFU area                    */
      774       29    1   DCL FMR$G8 ENTRY(2)ALTRET; /* Get a CFU block                    */
      775       30    1   DCL FMR$ZA ENTRY(1); /* ZAP & Free a CFU block             */
      776       31    1   DCL FMS$SCANNAME ENTRY ALTRET; /* Establish CFU name pointer         */
      777       32    1   DCL FMR$Z8 ENTRY(1); /* ZAP & Free a CFU block             */
      778       33    1   DCL FSD$C1GETDCB ENTRY ALTRET;
      779       34        /*** * * * ***/
      780       35    1   DCL B$JIT$ PTR SYMREF; /* Note: B$JIT is BASED(B$JIT$).      */
      781       36    1   DCL B$ROSEG$ PTR SYMREF;
      782       37    1   DCL S_CUN UBIN SYMREF;
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:158  
      783       38        /*** * * * ***/
      784       39        %MACRO F$DCBI(BASED=BASED);
      785       40        %INCLUDE F$DCB;
      786       89        %MEND;
      787       90        %MACRO B$ROSEG(BASED=BASED);
      788       91        %INCLUDE B$ROSEG;
      789      154        %MEND;
      790      155        %INCLUDE B$JIT_C;
      791      469        %B$JIT0;
      792      558        %U$JIT1;
      793      632        %M$JIT2X;
      794      635        %F$JIT3;
      795      640        %S$JIT4X;
      796      643        %J$JIT5X;
      797      646        %A$JIT6X;
      798      649        %B$ROSEG(BASED="BASED(B$ROSEG$)");
      799      709        %F$DCBI(BASED="BASED(JDCB$)");
      800      759        %INCLUDE F_CP6;
      801     1784        %INCLUDE CP_6_SUBS;
      802     2324        %INCLUDE F_FMTCODE_C;
      803     2358        %INCLUDE F_FPTCODE_C;
      804     2394        %INCLUDE FS$FIT;
      805     2437        %INCLUDE FM$CFU;
      806     2482        %INCLUDE F$CP6V_C;
      807     2708        %FM$CFU;
      808     2714        %FM$CFUF;
      809     2717        /*** * * * ***/
      810     2718        %FPT_CLOSE(FPTN=PN$,PFMT=PTR,STCLASS=);
      811     2760    1   DCL FUDGEMOVE CHAR(I) BASED;
      812     2761        %FPT_CLOSE(FPTN=CONSTANTSAVEFPT$,PFMT=PTR,VECTOR=ADDR,
      813     2762                STCLASS=CONSTANT,DISP=SAVE,CHGATT=YES);
      814     2804    1   DCL JDCB$ PTR;
      815     2805    1   DCL OLDCFU$ PTR;
      816     2806    1   DCL NEWCFU$ PTR;
      817     2807    1   DCL I SBIN;
      818     2808        %FS$XEQSAVE(SIZ=FIT,STCLASS=);
      819     2811        %EJECT;
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:159  
      820     2812    1           JDCB$= B$JIT.DCB$;
      821     2813    2           DO CASE(B$ROSEG.CR01ID.NOWIS);
      822     2814    2            CASE(%CC_FROMXEQ#,%CC_FROMJOB#);
      823     2815    3              IF B$ROSEG.CR01DCB~=0 THEN DO;
      824     2816    3                 B$JIT.DCB$=PINCRW(B$ROSEG$,B$ROSEG.CR01DCB);
      825     2817    3                 IF B$JIT.DCB$->F$DCB.FCD AND
      826     2818    4                   B$JIT.DCB$->F$DCB.IASN=%FILE# THEN DO;
      827     2819    4                    CALL FMP$CLSF;
      828     2820    4                    B$JIT.DCB$->F$DCB.IASN=0;
      829     2821    4                    IF B$JIT.DCB$=DCBADDR(%M$UC#) THEN
      830     2822    4                       B$JIT.DCB$->F$DCB.FCD=%YES#;
      831     2823    4                    END;
      832     2824    3                 B$JIT.DCB$=JDCB$;
      833     2825    3                 END;
      834     2826    2            CASE(%CC_FROMXEQEND#);
      835     2827    2              CALL FSD$C1END;
      836     2828    2            END;
      837     2829    1           I=POFFC(ADDR(CONSTANTSAVEFPT$.V),ADDR(CONSTANTSAVEFPT$));
      838     2830    1           ADDR(PN$)->FUDGEMOVE=ADDR(CONSTANTSAVEFPT$)->FUDGEMOVE;
      839     2831    1           PN$.UATTR_=ADDR(FS$XEQSAVE);
      840     2832    1           FS$XEQSAVE.CR01ID=B$ROSEG.CR01ID;
      841     2833    1           FS$XEQSAVE.STARDA=B$JIT.STAR.DA(6);
      842     2834    1           FS$XEQSAVE.SIZ=SIZEW(FS$XEQSAVE)-1;
      843     2835                /* CSLEV is the count IBEX uses to know how many levels
      844     2836                   down he is is a nested XEQ type situation.  Whenever
      845     2837                   we are coming up a level in a nest we decrement CSLEV
      846     2838                   and make sure it is never less then 0.  When we go down
      847     2839                   a level, we just increment CSLEV one more.  CSLEV is
      848     2840                   initialized to 0 in LOGON.
      849     2841                */
      850     2842    1           B$JIT.CSLEV = B$JIT.CSLEV + 1;
      851     2843        /*         At this point, command file is closed and we have
      852     2844         *         established our memory of where command place is now.
      853     2845         *         It is now possible to do our CFU fudging.*/
      854     2846    1           OLDCFU$=F$DCB.CFU$;
      855     2847    1           CALL FMR$G8(NEWCFU$,I)ALTRET(SCRATCHIT);
      856     2848    1           NEWCFU$->FM$CFU.STARX.F=1;
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:160  
      857     2849    1           NEWCFU$->FM$CFU.STARX.SYSID=B$JIT.SYSID;
      858     2850    1           NEWCFU$->FM$CFU.SHARE=%NONE#;
      859     2851    1           NEWCFU$->FM$CFU.FUN=%CREATE#;
      860     2852        /*         OLDCFU$ is the SCRATCH CFU which contains the file's
      861     2853         *            disk addresses etc.
      862     2854         *         NEWCFU$ is a new SAVE CFU which we will get linked up
      863     2855         *            to the name-acct list by calling FMS$SCANNAME.*/
      864     2856    1           F$DCB.CFU$=NEWCFU$;
      865     2857    1           F$DCB.STARF='1'B;
      866     2858    1           F$DCB.STARX=6;
      867     2859    1           F$DCB.DISP=%SAVE#;
      868     2860    1           B$JIT.FEXT(F$DCB.FEXTX)='0'B;
      869     2861    1           B$JIT.ERR='0'B;
      870     2862    1           CALL FMS$SCANNAME ALTRET(NOTHERCFU);
      871     2863    1           IF B$JIT.ERR.CODE~=0 THEN GOTO CFUSCRATCHIT;
      872     2864    1   NOTHERCFU: ;
      873     2865    1           CALL FMR$L8;
      874     2866    1           OLDCFU$->FM$CFUF.ACCNAM=F$DCB.CFU$->FM$CFUF.ACCNAM;
      875     2867    1           F$DCB.CFU$->FM$CFU=OLDCFU$->FM$CFU;
      876     2868    1           CALL FMR$ZA(OLDCFU$);
      877     2869    1           CALL FMR$U8;
      878     2870        /*         The DCB is now hooked up to a new CFU which contains the
      879     2871         *         disk address info of the old CFU, but which is SAVEable.
      880     2872         *         We have the disk address of any old *X file in our
      881     2873         *         FS$XEQSAVE, which will be written as UATTR on the close;
      882     2874         *         thus we will zero *X disk address in the JIT since we
      883     2875         *         don't want to release the old *X now (nested XEQ).*/
      884     2876    1           B$JIT.STAR.DA(6)=0;
      885     2877    1           JDCB$->F$DCB.FFLG=%FFLG_WNEW#|%FFLG_REATTR#;
      886     2878    1           JDCB$->F$DCB.WSR=0;
      887     2879    1           CALL FMP$CLSF(PN$);
      888     2880    1           B$ROSEG.CR01ID.POSN=0;
      889     2881    2           IF B$ROSEG.CR01ID.NOWIS=%CC_FROMUC# THEN DO;
      890     2882    2              B$ROSEG.CR01DCB=0;
      891     2883    2              I=B$ROSEG.NUMDCBS;
      892     2884    3              DO WHILE(I>=%M$MAXNEG#);
      893     2885    3                 IF DCBADDR(I)~=ADDR(NIL) THEN
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:161  
      894     2886    3                    IF DCBADDR(I)->F$DCB.FCD AND
      895     2887    4                      DCBADDR(I)->F$DCB.CTLCMDIN THEN DO;
      896     2888    4                       IF B$ROSEG.CR01DCB=0 THEN
      897     2889    4                          CALL FSD$C1GETDCB ALTRET(TRASHTHEM);
      898     2890    4                       DCBADDR(I)->F$DCB.CFU$=B$JIT.DCB$;
      899     2891    4                       END;
      900     2892    3                 I=I-1;
      901     2893    3                 END;
      902     2894    2              END;
      903     2895    1   RETUR:  ;
      904     2896    1           B$JIT.NEXTCC=%CC_FROMXEQ#;
      905     2897    1           B$ROSEG.CR01ID.NOWIS=%CC_FROMXEQ#;
      906     2898    1           RETURN;
      907     2899    1   TRASHTHEM:;
      908     2900    2           DO WHILE (I>=%M$MAXNEG#);
      909     2901    2              IF DCBADDR(I)~=ADDR(NIL) THEN
      910     2902    2                 IF DCBADDR(I)->F$DCB.CTLCMDIN THEN
      911     2903    2                    DCBADDR(I)->F$DCB.FCD=%NO#;
      912     2904    2              I=I-1;
      913     2905    2              END;
      914     2906    1           GOTO RETUR;
      915     2907    1   CFUSCRATCHIT:;
      916     2908    1           F$DCB.CFU$=OLDCFU$;
      917     2909    1           CALL FMR$Z8(NEWCFU$);
      918     2910    1   SCRATCHIT:;
      919     2911    1           CALL FMP$CLSF;
      920     2912    1           RETURN;
      921     2913    1   END FSD$JFCLS;

PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:162  
--  Include file information  --

   F$CP6V_C.:E05TOU  is referenced.
   FM$CFU.:E05TOU  is referenced.
   FS$FIT.:E05TOU  is referenced.
   F_FPTCODE_C.:E05TOU  is referenced.
   F_FMTCODE_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   F_CP6.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$ROSEG.:E05TOU  is referenced.
   F$DCB.:E05TOU  is referenced.
      No diagnostics issued in procedure FSD$JFCLS.

   Procedure FSD$JFCLS requires 251 words for executable code.
   Procedure FSD$JFCLS requires 14 words of local(AUTO) storage.

    No errors detected in file FSD$JCL.:E05TSI    .

PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:163  

 Object Unit name= FSD$JFCLS                                  File name= FSD$JCL.:E05TOU
 UTS= JUL 29 '97 17:29:29.44 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     18     22  FSD$JFCLS
    1   Proc  even  none   251    373  FSD$JFCLS
    2  RoData even  none     8     10  FSD$JFCLS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        1  FSD$JFCLS

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 FMP$CLSF
         yes           Std       1 FMR$Z8
 yes     yes           Std       0 FSD$C1END
         yes           Std       1 FMR$ZA
 yes     yes           Std       2 FMR$G8
 yes     yes           Std       0 FSD$C1GETDCB
 yes     yes           Std       0 FMS$SCANNAME
         yes           Std       0 FMR$L8
         yes           Std       0 FMR$U8
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:164  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$JIT$                                B$ROSEG$                              B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:165  


      746        1        /*T***********************************************************/
      747        2        /*T*                                                         */
      748        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      749        4        /*T*                                                         */
      750        5        /*T***********************************************************/
      751        6        /*F*    NAME: FSD$JFCLS
      752        7         *      PURPOSE: FSD$JFCLS handles user M$CLOSE PMME's to JF (i.e.,
      753        8         *         converting an XEQ file into control command input).
      754        9         *      DESCRIPTION: The DCB, which is perceived by the user to be
      755       10         *         attached to device 'JE', is actually at this point in
      756       11         *         time attached to file '*X', opened for scratch create.
      757       12         *            We never get called on a non-SAVE M$CLOSE; the
      758       13         *         file is simply closed.
      759       14         *            On an M$CLOSE with SAVE, the scratch file attached
      760       15         *         to the DCB is converted to a SAVE file named '*X'.  If
      761       16         *         there already is a *X, its FIT disk address is remembered
      762       17         *         in the new file (XEQ within XEQ).  This requires that
      763       18         *         DCB's open to current command stream be closed so that the
      764       19         *         old *X won't be open.  Some CFU fudging takes place.
      765       20         *            The CR01 stream description is then updated to indicate
      766       21         *         that *X, record #0, is the current control command place.
      767       22         */
      768       23        FSD$JFCLS: PROC(PN$);

     23  1 000000   000000 700200 xent  FSD$JFCLS    TSX0  ! X66_AUTO_1
         1 000001   000016 000001                    ZERO    14,1

      769       24        /*** * * * ***/
      770       25    1   DCL FSD$C1END ENTRY ALTRET; /* Dump after-ended XEQ file */
      771       26    1   DCL FMP$CLSF ENTRY(1); /* Close Disk File                    */
      772       27    1   DCL FMR$L8 ENTRY; /* Lock CFU area                      */
      773       28    1   DCL FMR$U8 ENTRY; /* Unlock CFU area                    */
      774       29    1   DCL FMR$G8 ENTRY(2)ALTRET; /* Get a CFU block                    */
      775       30    1   DCL FMR$ZA ENTRY(1); /* ZAP & Free a CFU block             */
      776       31    1   DCL FMS$SCANNAME ENTRY ALTRET; /* Establish CFU name pointer         */
      777       32    1   DCL FMR$Z8 ENTRY(1); /* ZAP & Free a CFU block             */
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:166  
      778       33    1   DCL FSD$C1GETDCB ENTRY ALTRET;
      779       34        /*** * * * ***/
      780       35    1   DCL B$JIT$ PTR SYMREF; /* Note: B$JIT is BASED(B$JIT$).      */
      781       36    1   DCL B$ROSEG$ PTR SYMREF;
      782       37    1   DCL S_CUN UBIN SYMREF;
      783       38        /*** * * * ***/
      784       39        %MACRO F$DCBI(BASED=BASED);
      785       40        %INCLUDE F$DCB;
      786       89        %MEND;
      787       90        %MACRO B$ROSEG(BASED=BASED);
      788       91        %INCLUDE B$ROSEG;
      789      154        %MEND;
      790      155        %INCLUDE B$JIT_C;
      791      469        %B$JIT0;
      792      558        %U$JIT1;
      793      632        %M$JIT2X;
      794      635        %F$JIT3;
      795      640        %S$JIT4X;
      796      643        %J$JIT5X;
      797      646        %A$JIT6X;
      798      649        %B$ROSEG(BASED="BASED(B$ROSEG$)");
      799      709        %F$DCBI(BASED="BASED(JDCB$)");
      800      759        %INCLUDE F_CP6;
      801     1784        %INCLUDE CP_6_SUBS;
      802     2324        %INCLUDE F_FMTCODE_C;
      803     2358        %INCLUDE F_FPTCODE_C;
      804     2394        %INCLUDE FS$FIT;
      805     2437        %INCLUDE FM$CFU;
      806     2482        %INCLUDE F$CP6V_C;
      807     2708        %FM$CFU;
      808     2714        %FM$CFUF;
      809     2717        /*** * * * ***/
      810     2718        %FPT_CLOSE(FPTN=PN$,PFMT=PTR,STCLASS=);
      811     2760    1   DCL FUDGEMOVE CHAR(I) BASED;
      812     2761        %FPT_CLOSE(FPTN=CONSTANTSAVEFPT$,PFMT=PTR,VECTOR=ADDR,
      813     2762                STCLASS=CONSTANT,DISP=SAVE,CHGATT=YES);
      814     2804    1   DCL JDCB$ PTR;
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:167  
      815     2805    1   DCL OLDCFU$ PTR;
      816     2806    1   DCL NEWCFU$ PTR;
      817     2807    1   DCL I SBIN;
      818     2808        %FS$XEQSAVE(SIZ=FIT,STCLASS=);
      819     2811        %EJECT;
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:168  
      820     2812    1           JDCB$= B$JIT.DCB$;

   2812  1 000002   000000 470400 xsym               LDP0    B$JIT$
         1 000003   000232 236100                    LDQ     154,,PR0
         1 000004   200004 756100                    STQ     JDCB$,,AUTO

      821     2813    2           DO CASE(B$ROSEG.CR01ID.NOWIS);

   2813  1 000005   000000 471400 xsym               LDP1    B$ROSEG$
         1 000006   100114 236100                    LDQ     76,,PR1
         1 000007   000036 772000                    QRL     30
         1 000010   000017 376007                    ANQ     15,DL
         1 000011   000005 116007                    CMPQ    5,DL
         1 000012   000014 602006 1                  TNC     s:2813+7,QL
         1 000013   000063 710000 1                  TRA     s:2829
         1 000014   000063 710000 1                  TRA     s:2829
         1 000015   000021 710000 1                  TRA     s:2815
         1 000016   000021 710000 1                  TRA     s:2815
         1 000017   000063 710000 1                  TRA     s:2829
         1 000020   000060 710000 1                  TRA     s:2827

      822     2814    2            CASE(%CC_FROMXEQ#,%CC_FROMJOB#);

      823     2815    3              IF B$ROSEG.CR01DCB~=0 THEN DO;

   2815  1 000021   100115 220100                    LDX0    77,,PR1
         1 000022   000063 600000 1                  TZE     s:2829

      824     2816    3                 B$JIT.DCB$=PINCRW(B$ROSEG$,B$ROSEG.CR01DCB);

   2816  1 000023   000000 636010                    EAQ     0,X0
         1 000024   000000 036000 xsym               ADLQ    B$ROSEG$
         1 000025   000232 756100                    STQ     154,,PR0

      825     2817    3                 IF B$JIT.DCB$->F$DCB.FCD AND

   2817  1 000026   000232 473500                    LDP3    154,,PR0
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:169  
         1 000027   300031 236100                    LDQ     25,,PR3
         1 000030   020000 316007                    CANQ    8192,DL
         1 000031   000055 600000 1                  TZE     s:2824
         1 000032   300103 236100                    LDQ     67,,PR3
         1 000033   000777 376007                    ANQ     511,DL
         1 000034   000001 116007                    CMPQ    1,DL
         1 000035   000055 601000 1                  TNZ     s:2824

      826     2818    4                   B$JIT.DCB$->F$DCB.IASN=%FILE# THEN DO;

      827     2819    4                    CALL FMP$CLSF;

   2819  1 000036   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000037   000000 701000 xent               TSX1    FMP$CLSF
         1 000040   000000 011000                    NOP     0

      828     2820    4                    B$JIT.DCB$->F$DCB.IASN=0;

   2820  1 000041   000000 470400 xsym               LDP0    B$JIT$
         1 000042   000232 471500                    LDP1    154,,PR0
         1 000043   000000 236003                    LDQ     0,DU
         1 000044   100103 552104                    STBQ    67,'04'O,PR1

      829     2821    4                    IF B$JIT.DCB$=DCBADDR(%M$UC#) THEN

   2821  1 000045   000000 471400 2                  LDP1    0
         1 000046   100000 473500                    LDP3    0,,PR1
         1 000047   000232 236100                    LDQ     154,,PR0
         1 000050   300003 116100                    CMPQ    3,,PR3
         1 000051   000055 601000 1                  TNZ     s:2824

      830     2822    4                       B$JIT.DCB$->F$DCB.FCD=%YES#;

   2822  1 000052   000232 474500                    LDP4    154,,PR0
         1 000053   020000 236007                    LDQ     8192,DL
         1 000054   400031 256100                    ORSQ    25,,PR4

PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:170  
      831     2823    4                    END;

      832     2824    3                 B$JIT.DCB$=JDCB$;

   2824  1 000055   200004 236100                    LDQ     JDCB$,,AUTO
         1 000056   000232 756100                    STQ     154,,PR0

      833     2825    3                 END;

   2825  1 000057   000063 710000 1                  TRA     s:2829

      834     2826    2            CASE(%CC_FROMXEQEND#);

      835     2827    2              CALL FSD$C1END;

   2827  1 000060   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000061   000000 701000 xent               TSX1    FSD$C1END
         1 000062   000000 011000                    NOP     0

      836     2828    2            END;

      837     2829    1           I=POFFC(ADDR(CONSTANTSAVEFPT$.V),ADDR(CONSTANTSAVEFPT$));

   2829  1 000063   000001 236000 2                  LDQ     1
         1 000064   000020 772000                    QRL     16
         1 000065   200014 756100                    STQ     FS$XEQSAVE+4,,AUTO
         1 000066   000002 236000 2                  LDQ     2
         1 000067   000020 772000                    QRL     16
         1 000070   200014 136100                    SBLQ    FS$XEQSAVE+4,,AUTO
         1 000071   200007 756100                    STQ     I,,AUTO

      838     2830    1           ADDR(PN$)->FUDGEMOVE=ADDR(CONSTANTSAVEFPT$)->FUDGEMOVE;

   2830  1 000072   000000 620006                    EAX0    0,QL
         1 000073   200003 470500                    LDP0    @PN$,,AUTO
         1 000074   200007 721100                    LXL1    I,,AUTO
         1 000075   040140 100440                    MLR     fill='040'O
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:171  
         1 000076   000000 000010 0                  ADSC9   CONSTANTSAVEFPT$         cn=0,n=*X0
         1 000077   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

      839     2831    1           PN$.UATTR_=ADDR(FS$XEQSAVE);

   2831  1 000100   200010 631500                    EPPR1   FS$XEQSAVE,,AUTO
         1 000101   000007 451500                    STP1    7,,PR0

      840     2832    1           FS$XEQSAVE.CR01ID=B$ROSEG.CR01ID;

   2832  1 000102   000000 473400 xsym               LDP3    B$ROSEG$
         1 000103   300114 236100                    LDQ     76,,PR3
         1 000104   200011 756100                    STQ     FS$XEQSAVE+1,,AUTO

      841     2833    1           FS$XEQSAVE.STARDA=B$JIT.STAR.DA(6);

   2833  1 000105   000000 471400 xsym               LDP1    B$JIT$
         1 000106   100230 235100                    LDA     152,,PR1
         1 000107   200012 755100                    STA     FS$XEQSAVE+2,,AUTO

      842     2834    1           FS$XEQSAVE.SIZ=SIZEW(FS$XEQSAVE)-1;

   2834  1 000110   000002 235007                    LDA     2,DL
         1 000111   200010 755100                    STA     FS$XEQSAVE,,AUTO

      843     2835                /* CSLEV is the count IBEX uses to know how many levels
      844     2836                   down he is is a nested XEQ type situation.  Whenever
      845     2837                   we are coming up a level in a nest we decrement CSLEV
      846     2838                   and make sure it is never less then 0.  When we go down
      847     2839                   a level, we just increment CSLEV one more.  CSLEV is
      848     2840                   initialized to 0 in LOGON.
      849     2841                */
      850     2842    1           B$JIT.CSLEV = B$JIT.CSLEV + 1;

   2842  1 000112   100170 236100                    LDQ     120,,PR1
         1 000113   000001 036003                    ADLQ    1,DU
         1 000114   100170 552120                    STBQ    120,'20'O,PR1
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:172  

      851     2843        /*         At this point, command file is closed and we have
      852     2844         *         established our memory of where command place is now.
      853     2845         *         It is now possible to do our CFU fudging.*/
      854     2846    1           OLDCFU$=F$DCB.CFU$;

   2846  1 000115   200004 474500                    LDP4    JDCB$,,AUTO
         1 000116   400066 236100                    LDQ     54,,PR4
         1 000117   200005 756100                    STQ     OLDCFU$,,AUTO

      855     2847    1           CALL FMR$G8(NEWCFU$,I)ALTRET(SCRATCHIT);

   2847  1 000120   200007 635500                    EPPR5   I,,AUTO
         1 000121   200015 455500                    STP5    FS$XEQSAVE+5,,AUTO
         1 000122   200006 636500                    EPPR6   NEWCFU$,,AUTO
         1 000123   200014 456500                    STP6    FS$XEQSAVE+4,,AUTO
         1 000124   200014 630500                    EPPR0   FS$XEQSAVE+4,,AUTO
         1 000125   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000126   000000 701000 xent               TSX1    FMR$G8
         1 000127   000367 702000 1                  TSX2    SCRATCHIT

      856     2848    1           NEWCFU$->FM$CFU.STARX.F=1;

   2848  1 000130   200006 470500                    LDP0    NEWCFU$,,AUTO
         1 000131   400000 236003                    LDQ     -131072,DU
         1 000132   000002 256100                    ORSQ    2,,PR0

      857     2849    1           NEWCFU$->FM$CFU.STARX.SYSID=B$JIT.SYSID;

   2849  1 000133   200006 470500                    LDP0    NEWCFU$,,AUTO
         1 000134   000000 471400 xsym               LDP1    B$JIT$
         1 000135   100000 236100                    LDQ     0,,PR1
         1 000136   000022 736000                    QLS     18
         1 000137   000002 676100                    ERQ     2,,PR0
         1 000140   377777 376003                    ANQ     131071,DU
         1 000141   000002 656100                    ERSQ    2,,PR0

PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:173  
      858     2850    1           NEWCFU$->FM$CFU.SHARE=%NONE#;

   2850  1 000142   200006 470500                    LDP0    NEWCFU$,,AUTO
         1 000143   060000 236003                    LDQ     24576,DU
         1 000144   000000 256100                    ORSQ    0,,PR0

      859     2851    1           NEWCFU$->FM$CFU.FUN=%CREATE#;

   2851  1 000145   200006 470500                    LDP0    NEWCFU$,,AUTO
         1 000146   000000 236100                    LDQ     0,,PR0
         1 000147   000003 376000 2                  ANQ     3
         1 000150   300000 276003                    ORQ     98304,DU
         1 000151   000000 756100                    STQ     0,,PR0

      860     2852        /*         OLDCFU$ is the SCRATCH CFU which contains the file's
      861     2853         *            disk addresses etc.
      862     2854         *         NEWCFU$ is a new SAVE CFU which we will get linked up
      863     2855         *            to the name-acct list by calling FMS$SCANNAME.*/
      864     2856    1           F$DCB.CFU$=NEWCFU$;

   2856  1 000152   200006 236100                    LDQ     NEWCFU$,,AUTO
         1 000153   200004 470500                    LDP0    JDCB$,,AUTO
         1 000154   000066 756100                    STQ     54,,PR0

      865     2857    1           F$DCB.STARF='1'B;

   2857  1 000155   200000 236003                    LDQ     65536,DU
         1 000156   000064 256100                    ORSQ    52,,PR0

      866     2858    1           F$DCB.STARX=6;

   2858  1 000157   000064 236100                    LDQ     52,,PR0
         1 000160   000004 376000 2                  ANQ     4
         1 000161   006000 276007                    ORQ     3072,DL
         1 000162   000064 756100                    STQ     52,,PR0

      867     2859    1           F$DCB.DISP=%SAVE#;
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:174  

   2859  1 000163   000002 236007                    LDQ     2,DL
         1 000164   000032 552104                    STBQ    26,'04'O,PR0

      868     2860    1           B$JIT.FEXT(F$DCB.FEXTX)='0'B;

   2860  1 000165   000034 236100                    LDQ     28,,PR0
         1 000166   000011 772000                    QRL     9
         1 000167   000777 376007                    ANQ     511,DL
         1 000170   000000 471400 xsym               LDP1    B$JIT$
         1 000171   003106 060400                    CSL     bolr='003'O
         1 000172   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         1 000173   100220 000001                    BDSC    144,Q,PR1                by=0,bit=0,n=1

      869     2861    1           B$JIT.ERR='0'B;

   2861  1 000174   000000 471400 xsym               LDP1    B$JIT$
         1 000175   100012 450100                    STZ     10,,PR1

      870     2862    1           CALL FMS$SCANNAME ALTRET(NOTHERCFU);

   2862  1 000176   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000177   000000 701000 xent               TSX1    FMS$SCANNAME
         1 000200   000205 702000 1                  TSX2    NOTHERCFU

      871     2863    1           IF B$JIT.ERR.CODE~=0 THEN GOTO CFUSCRATCHIT;

   2863  1 000201   000000 470400 xsym               LDP0    B$JIT$
         1 000202   000012 236100                    LDQ     10,,PR0
         1 000203   377770 316007                    CANQ    131064,DL
         1 000204   000356 601000 1                  TNZ     CFUSCRATCHIT

   2863  1 000205                       NOTHERCFU    null
      872     2864    1   NOTHERCFU: ;
      873     2865    1           CALL FMR$L8;

   2865  1 000205   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:175  
         1 000206   000000 701000 xent               TSX1    FMR$L8
         1 000207   000000 011000                    NOP     0

      874     2866    1           OLDCFU$->FM$CFUF.ACCNAM=F$DCB.CFU$->FM$CFUF.ACCNAM;

   2866  1 000210   200004 470500                    LDP0    JDCB$,,AUTO
         1 000211   000066 471500                    LDP1    54,,PR0
         1 000212   200005 473500                    LDP3    OLDCFU$,,AUTO
         1 000213   100002 235100                    LDA     2,,PR1
         1 000214   300002 755100                    STA     2,,PR3

      875     2867    1           F$DCB.CFU$->FM$CFU=OLDCFU$->FM$CFU;

   2867  1 000215   000066 471500                    LDP1    54,,PR0
         1 000216   200005 473500                    LDP3    OLDCFU$,,AUTO
         1 000217   000100 100500                    MLR     fill='000'O
         1 000220   300000 000040                    ADSC9   0,,PR3                   cn=0,n=32
         1 000221   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32

      876     2868    1           CALL FMR$ZA(OLDCFU$);

   2868  1 000222   200005 631500                    EPPR1   OLDCFU$,,AUTO
         1 000223   200014 451500                    STP1    FS$XEQSAVE+4,,AUTO
         1 000224   200014 630500                    EPPR0   FS$XEQSAVE+4,,AUTO
         1 000225   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000226   000000 701000 xent               TSX1    FMR$ZA
         1 000227   000000 011000                    NOP     0

      877     2869    1           CALL FMR$U8;

   2869  1 000230   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000231   000000 701000 xent               TSX1    FMR$U8
         1 000232   000000 011000                    NOP     0

      878     2870        /*         The DCB is now hooked up to a new CFU which contains the
      879     2871         *         disk address info of the old CFU, but which is SAVEable.
      880     2872         *         We have the disk address of any old *X file in our
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:176  
      881     2873         *         FS$XEQSAVE, which will be written as UATTR on the close;
      882     2874         *         thus we will zero *X disk address in the JIT since we
      883     2875         *         don't want to release the old *X now (nested XEQ).*/
      884     2876    1           B$JIT.STAR.DA(6)=0;

   2876  1 000233   000000 470400 xsym               LDP0    B$JIT$
         1 000234   000230 450100                    STZ     152,,PR0

      885     2877    1           JDCB$->F$DCB.FFLG=%FFLG_WNEW#|%FFLG_REATTR#;

   2877  1 000235   104000 220003                    LDX0    34816,DU
         1 000236   200004 471500                    LDP1    JDCB$,,AUTO
         1 000237   100004 740100                    STX0    4,,PR1

      886     2878    1           JDCB$->F$DCB.WSR=0;

   2878  1 000240   000000 236003                    LDQ     0,DU
         1 000241   100040 552120                    STBQ    32,'20'O,PR1

      887     2879    1           CALL FMP$CLSF(PN$);

   2879  1 000242   200003 630500                    EPPR0   @PN$,,AUTO
         1 000243   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000244   000000 701000 xent               TSX1    FMP$CLSF
         1 000245   000000 011000                    NOP     0

      888     2880    1           B$ROSEG.CR01ID.POSN=0;

   2880  1 000246   000000 470400 xsym               LDP0    B$ROSEG$
         1 000247   000000 236003                    LDQ     0,DU
         1 000250   000114 552134                    STBQ    76,'34'O,PR0

      889     2881    2           IF B$ROSEG.CR01ID.NOWIS=%CC_FROMUC# THEN DO;

   2881  1 000251   000114 236100                    LDQ     76,,PR0
         1 000252   170000 376003                    ANQ     61440,DU
         1 000253   030000 116003                    CMPQ    12288,DU
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:177  
         1 000254   000322 601000 1                  TNZ     RETUR

      890     2882    2              B$ROSEG.CR01DCB=0;

   2882  1 000255   000000 220003                    LDX0    0,DU
         1 000256   000115 740100                    STX0    77,,PR0

      891     2883    2              I=B$ROSEG.NUMDCBS;

   2883  1 000257   000002 236100                    LDQ     2,,PR0
         1 000260   000022 772000                    QRL     18
         1 000261   200007 756100                    STQ     I,,AUTO

      892     2884    3              DO WHILE(I>=%M$MAXNEG#);

   2884  1 000262   000317 710000 1                  TRA     s:2893

      893     2885    3                 IF DCBADDR(I)~=ADDR(NIL) THEN

   2885  1 000263   000000 470400 2                  LDP0    0
         1 000264   000000 471500                    LDP1    0,,PR0
         1 000265   200007 720100                    LXL0    I,,AUTO
         1 000266   100000 236110                    LDQ     0,X0,PR1
         1 000267   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000270   000315 600000 1                  TZE     s:2892

      894     2886    3                    IF DCBADDR(I)->F$DCB.FCD AND

   2886  1 000271   100000 473510                    LDP3    0,X0,PR1
         1 000272   300031 236100                    LDQ     25,,PR3
         1 000273   020000 316007                    CANQ    8192,DL
         1 000274   000315 600000 1                  TZE     s:2892
         1 000275   300103 236100                    LDQ     67,,PR3
         1 000276   004000 316007                    CANQ    2048,DL
         1 000277   000315 600000 1                  TZE     s:2892

      895     2887    4                      DCBADDR(I)->F$DCB.CTLCMDIN THEN DO;
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:178  

      896     2888    4                       IF B$ROSEG.CR01DCB=0 THEN

   2888  1 000300   000000 474400 xsym               LDP4    B$ROSEG$
         1 000301   400115 221100                    LDX1    77,,PR4
         1 000302   000306 601000 1                  TNZ     s:2890

      897     2889    4                          CALL FSD$C1GETDCB ALTRET(TRASHTHEM);

   2889  1 000303   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000304   000000 701000 xent               TSX1    FSD$C1GETDCB
         1 000305   000333 702000 1                  TSX2    TRASHTHEM

      898     2890    4                       DCBADDR(I)->F$DCB.CFU$=B$JIT.DCB$;

   2890  1 000306   000000 470400 2                  LDP0    0
         1 000307   000000 471500                    LDP1    0,,PR0
         1 000310   200007 720100                    LXL0    I,,AUTO
         1 000311   100000 473510                    LDP3    0,X0,PR1
         1 000312   000000 474400 xsym               LDP4    B$JIT$
         1 000313   400232 236100                    LDQ     154,,PR4
         1 000314   300066 756100                    STQ     54,,PR3

      899     2891    4                       END;

      900     2892    3                 I=I-1;

   2892  1 000315   000001 336007                    LCQ     1,DL
         1 000316   200007 056100                    ASQ     I,,AUTO

      901     2893    3                 END;

   2893  1 000317   200007 235100                    LDA     I,,AUTO
         1 000320   000005 115000 2                  CMPA    5
         1 000321   000263 605000 1                  TPL     s:2885

      902     2894    2              END;
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:179  

      903     2895    1   RETUR:  ;

   2895  1 000322                       RETUR        null
      904     2896    1           B$JIT.NEXTCC=%CC_FROMXEQ#;

   2896  1 000322   000000 470400 xsym               LDP0    B$JIT$
         1 000323   000002 236003                    LDQ     2,DU
         1 000324   000151 552120                    STBQ    105,'20'O,PR0

      905     2897    1           B$ROSEG.CR01ID.NOWIS=%CC_FROMXEQ#;

   2897  1 000325   000000 471400 xsym               LDP1    B$ROSEG$
         1 000326   100114 236100                    LDQ     76,,PR1
         1 000327   000006 376000 2                  ANQ     6
         1 000330   020000 276003                    ORQ     8192,DU
         1 000331   100114 756100                    STQ     76,,PR1

      906     2898    1           RETURN;

   2898  1 000332   000000 702200 xent               TSX2  ! X66_ARET

   2897  1 000333                       TRASHTHEM    null
      907     2899    1   TRASHTHEM:;
      908     2900    2           DO WHILE (I>=%M$MAXNEG#);

   2900  1 000333   000352 710000 1                  TRA     s:2905

      909     2901    2              IF DCBADDR(I)~=ADDR(NIL) THEN

   2901  1 000334   000000 470400 2                  LDP0    0
         1 000335   000000 471500                    LDP1    0,,PR0
         1 000336   200007 720100                    LXL0    I,,AUTO
         1 000337   100000 236110                    LDQ     0,X0,PR1
         1 000340   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000341   000350 600000 1                  TZE     s:2904

PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:180  
      910     2902    2                 IF DCBADDR(I)->F$DCB.CTLCMDIN THEN

   2902  1 000342   100000 473510                    LDP3    0,X0,PR1
         1 000343   300103 236100                    LDQ     67,,PR3
         1 000344   004000 316007                    CANQ    2048,DL
         1 000345   000350 600000 1                  TZE     s:2904

      911     2903    2                    DCBADDR(I)->F$DCB.FCD=%NO#;

   2903  1 000346   000007 236000 2                  LDQ     7
         1 000347   300031 356100                    ANSQ    25,,PR3

      912     2904    2              I=I-1;

   2904  1 000350   000001 336007                    LCQ     1,DL
         1 000351   200007 056100                    ASQ     I,,AUTO

      913     2905    2              END;

   2905  1 000352   200007 235100                    LDA     I,,AUTO
         1 000353   000005 115000 2                  CMPA    5
         1 000354   000334 605000 1                  TPL     s:2901

      914     2906    1           GOTO RETUR;

   2906  1 000355   000322 710000 1                  TRA     RETUR

      915     2907    1   CFUSCRATCHIT:;

   2907  1 000356                       CFUSCRATCHIT null
      916     2908    1           F$DCB.CFU$=OLDCFU$;

   2908  1 000356   200005 236100                    LDQ     OLDCFU$,,AUTO
         1 000357   200004 471500                    LDP1    JDCB$,,AUTO
         1 000360   100066 756100                    STQ     54,,PR1

      917     2909    1           CALL FMR$Z8(NEWCFU$);
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:181  

   2909  1 000361   200006 633500                    EPPR3   NEWCFU$,,AUTO
         1 000362   200014 453500                    STP3    FS$XEQSAVE+4,,AUTO
         1 000363   200014 630500                    EPPR0   FS$XEQSAVE+4,,AUTO
         1 000364   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000365   000000 701000 xent               TSX1    FMR$Z8
         1 000366   000000 011000                    NOP     0

   2908  1 000367                       SCRATCHIT    null
      918     2910    1   SCRATCHIT:;
      919     2911    1           CALL FMP$CLSF;

   2911  1 000367   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000370   000000 701000 xent               TSX1    FMP$CLSF
         1 000371   000000 011000                    NOP     0

      920     2912    1           RETURN;

   2912  1 000372   000000 702200 xent               TSX2  ! X66_ARET

CONSTANTSAVEFPT$
 Sect OctLoc
   0     000   000016 006000   000000 006014   000000 006014   000000 006014    ................
   0     004   000000 006014   000000 006014   000000 006014   000000 006014    ................
   0     014*  000000 006014   ****** ******   000000 400002   000000 000040    ...............
   0     020   000220 000000   000000 000000                                    ........

(unnamed)
 Sect OctLoc
   2     000   000000 006003   000000 006000   000016 006000   077777 777777    ............?...
   2     004   777777 770777   777777 777740   607777 777777   777777 757777    ................
      921     2913    1   END FSD$JFCLS;

PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:182  
--  Include file information  --

   F$CP6V_C.:E05TOU  is referenced.
   FM$CFU.:E05TOU  is referenced.
   FS$FIT.:E05TOU  is referenced.
   F_FPTCODE_C.:E05TOU  is referenced.
   F_FMTCODE_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   F_CP6.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$ROSEG.:E05TOU  is referenced.
   F$DCB.:E05TOU  is referenced.
      No diagnostics issued in procedure FSD$JFCLS.
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:183  

 **** Variables and constants ****

  ****  Section 000 RoData FSD$JFCLS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(648)   r     1 CONSTANTSAVEFPT$

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @PN$                      10-0-0/w STRC(108)   r     1 FS$XEQSAVE
     7-0-0/w SBIN        r     1 I                          4-0-0/w PTR         r     1 JDCB$
     6-0-0/w PTR         r     1 NEWCFU$                    5-0-0/w PTR         r     1 OLDCFU$
    *0-0-0/d STRC(648)   r     1 PN$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$ROSEG$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/d STRC(3024)  r     1 B$ROSEG
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(288)   r     1 FM$CFU
     0-0-0/w STRC(288)   r     1 FM$CFUF                    0-0-0/c ACHR        r     1 FUDGEMOVE

PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:184  

   Procedure FSD$JFCLS requires 251 words for executable code.
   Procedure FSD$JFCLS requires 14 words of local(AUTO) storage.

    No errors detected in file FSD$JCL.:E05TSI    .
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:185  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:186  
          MINI XREF LISTING

B$JIT.CPFLAGS1.SLEAZE
       569**DCL       569--REDEF
B$JIT.CSLEV
       630**DCL      2842<<ASSIGN   2842>>ASSIGN
B$JIT.DCB$
       636**DCL      2812>>ASSIGN   2816<<ASSIGN   2817>>IF       2817>>IF       2820>>ASSIGN   2821>>IF
      2822>>ASSIGN   2824<<ASSIGN   2890>>ASSIGN
B$JIT.ERR
       475**DCL      2861<<ASSIGN
B$JIT.ERR.CODE
       476**DCL      2863>>IF
B$JIT.ERR.MID
       476**DCL       476--REDEF
B$JIT.FEXT
       636**DCL      2860<<ASSIGN
B$JIT.NEXTCC
       617**DCL      2896<<ASSIGN
B$JIT.STAR.DA
       636**DCL      2833>>ASSIGN   2876<<ASSIGN
B$JIT.SYSID
       475**DCL      2849>>ASSIGN
B$JIT$
        35**DCL       470--IMP-PTR  2812>>ASSIGN   2816>>ASSIGN   2817>>IF       2817>>IF       2820>>ASSIGN
      2821>>IF       2822>>ASSIGN   2824>>ASSIGN   2833>>ASSIGN   2842>>ASSIGN   2842>>ASSIGN   2849>>ASSIGN
      2860>>ASSIGN   2861>>ASSIGN   2863>>IF       2876>>ASSIGN   2890>>ASSIGN   2896>>ASSIGN
B$ROSEG.CR01DCB
       688**DCL      2815>>IF       2816>>ASSIGN   2882<<ASSIGN   2888>>IF
B$ROSEG.CR01ID
       680**DCL      2832>>ASSIGN
B$ROSEG.CR01ID.NOWIS
       683**DCL      2813>>DOCASE   2881>>IF       2897<<ASSIGN
B$ROSEG.CR01ID.POSN
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:187  
       687**DCL      2880<<ASSIGN
B$ROSEG.NUMDCBS
       661**DCL      2883>>ASSIGN
B$ROSEG$
        36**DCL       658--IMP-PTR   694--IMP-PTR   696--IMP-PTR  2813>>DOCASE   2815>>IF       2816>>ASSIGN
      2816>>ASSIGN   2832>>ASSIGN   2880>>ASSIGN   2881>>IF       2882>>ASSIGN   2883>>ASSIGN   2888>>IF
      2897>>ASSIGN
CFUSCRATCHIT
      2907**LABEL    2863--GOTO
CONSTANTSAVEFPT$
      2785**DCL      2829--ASSIGN   2830--ASSIGN
CONSTANTSAVEFPT$.SN_
      2785**DCL      2785--REDEF
CONSTANTSAVEFPT$.UTL_
      2786**DCL      2786--REDEF
CONSTANTSAVEFPT$.V
      2790**DCL      2785--DCLINIT  2829--ASSIGN
CONSTANTSAVEFPT$.V.EXPIRE#
      2800**DCL      2800--REDEF
CONSTANTSAVEFPT$.V.TYPE#
      2798**DCL      2798--REDEF
CONSTANTSAVEFPT$.V.XTNSIZE#
      2795**DCL      2795--REDEF    2797--REDEF
F$DCB.ACTPOS
       735**DCL       735--REDEF
F$DCB.ARS
       710**DCL       710--REDEF
F$DCB.ATTR
       728**DCL       729--REDEF
F$DCB.BORROW
       743**DCL       743--REDEF     743--REDEF     743--REDEF
F$DCB.CFU$
       744**DCL      2846>>ASSIGN   2856<<ASSIGN   2866>>ASSIGN   2867>>ASSIGN   2890<<ASSIGN   2908<<ASSIGN
F$DCB.CTLCMDIN
       751**DCL      2886>>IF       2902>>IF
F$DCB.DCBNAME.L
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:188  
       757**DCL       757--IMP-SIZ
F$DCB.DISP
       725**DCL      2859<<ASSIGN
F$DCB.EOMCHAR
       714**DCL       714--REDEF
F$DCB.FCD
       723**DCL      2817>>IF       2822<<ASSIGN   2886>>IF       2903<<ASSIGN
F$DCB.FEXTX
       726**DCL      2860>>ASSIGN
F$DCB.FFLG
       714**DCL      2877<<ASSIGN
F$DCB.FLDID
       738**DCL       738--REDEF
F$DCB.FORM$
       732**DCL       732--REDEF
F$DCB.FSECT
       748**DCL       748--REDEF
F$DCB.FSN
       725**DCL       725--REDEF     725--REDEF     726--REDEF
F$DCB.HEADER$
       731**DCL       731--REDEF
F$DCB.IASN
       751**DCL      2817>>IF       2820<<ASSIGN
F$DCB.IXTNSIZE
       729**DCL       729--REDEF
F$DCB.LASTSTA$
       719**DCL       719--REDEF
F$DCB.LVL
       744**DCL       744--REDEF
F$DCB.NAME.C
       719**DCL       719--REDEF
F$DCB.NOEOF
       740**DCL       740--REDEF
F$DCB.NRECS
       730**DCL       730--REDEF
F$DCB.NRECX
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:189  
       749**DCL       749--REDEF
F$DCB.OHDR
       741**DCL       741--REDEF
F$DCB.ORG
       724**DCL       724--REDEF
F$DCB.PRECNO
       747**DCL       747--REDEF
F$DCB.RCSZ
       752**DCL       752--REDEF
F$DCB.RES
       720**DCL       720--REDEF
F$DCB.SETX
       732**DCL       732--REDEF
F$DCB.STARF
       739**DCL      2857<<ASSIGN
F$DCB.STARX
       741**DCL      2858<<ASSIGN
F$DCB.TAB$
       731**DCL       732--REDEF
F$DCB.TDA
       746**DCL       746--REDEF
F$DCB.WSN
       721**DCL       721--REDEF
F$DCB.WSR
       727**DCL      2878<<ASSIGN
FM$CFU
      2709**DCL      2867<<ASSIGN   2867>>ASSIGN
FM$CFU.ACCTX
      2710**DCL      2710--REDEF
FM$CFU.FUN
      2709**DCL      2851<<ASSIGN
FM$CFU.SHARE
      2709**DCL      2850<<ASSIGN
FM$CFU.STARX.F
      2710**DCL      2848<<ASSIGN
FM$CFU.STARX.SYSID
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:190  
      2710**DCL      2849<<ASSIGN
FM$CFUF.ACCNAM
      2715**DCL      2866<<ASSIGN   2866>>ASSIGN
FMP$CLSF
        26**DCL-ENT  2819--CALL     2879--CALL     2911--CALL
FMR$G8
        29**DCL-ENT  2847--CALL
FMR$L8
        27**DCL-ENT  2865--CALL
FMR$U8
        28**DCL-ENT  2869--CALL
FMR$Z8
        32**DCL-ENT  2909--CALL
FMR$ZA
        30**DCL-ENT  2868--CALL
FMS$SCANNAME
        31**DCL-ENT  2862--CALL
FS$XEQSAVE
      2809**DCL      2831--ASSIGN   2834--ASSIGN
FS$XEQSAVE.CR01ID
      2809**DCL      2832<<ASSIGN
FS$XEQSAVE.SIZ
      2809**DCL      2834<<ASSIGN
FS$XEQSAVE.STARDA
      2809**DCL      2833<<ASSIGN
FSD$C1END
        25**DCL-ENT  2827--CALL
FSD$C1GETDCB
        33**DCL-ENT  2889--CALL
FUDGEMOVE
      2760**DCL      2830<<ASSIGN   2830>>ASSIGN
I
      2807**DCL      2760--IMP-SIZ  2829<<ASSIGN   2830>>ASSIGN   2830>>ASSIGN   2847<>CALL     2883<<ASSIGN
      2884>>DOWHILE  2885--IF       2886--IF       2886--IF       2890--ASSIGN   2892<<ASSIGN   2892>>ASSIGN
      2900>>DOWHILE  2901--IF       2902--IF       2903--ASSIGN   2904<<ASSIGN   2904>>ASSIGN
JDCB$
PL6.E3A0      #005=FSD$JFCLS File=FSD$JCL.:E05TSI                                TUE 07/29/97 17:29 Page:191  
      2804**DCL       710--IMP-PTR  2812<<ASSIGN   2824>>ASSIGN   2846>>ASSIGN   2856>>ASSIGN   2857>>ASSIGN
      2858>>ASSIGN   2859>>ASSIGN   2860>>ASSIGN   2866>>ASSIGN   2867>>ASSIGN   2877>>ASSIGN   2878>>ASSIGN
      2908>>ASSIGN
NEWCFU$
      2806**DCL      2847<>CALL     2848>>ASSIGN   2849>>ASSIGN   2850>>ASSIGN   2851>>ASSIGN   2856>>ASSIGN
      2909<>CALL
NOTHERCFU
      2863**LABEL    2862--CALLALT
OLDCFU$
      2805**DCL      2846<<ASSIGN   2866>>ASSIGN   2867>>ASSIGN   2868<>CALL     2908>>ASSIGN
PN$
      2741**DCL        23--PROC     2830--ASSIGN   2879<>CALL
PN$.SN_
      2741**DCL      2741--REDEF
PN$.UATTR_
      2744**DCL      2831<<ASSIGN
PN$.UTL_
      2742**DCL      2742--REDEF
PN$.V.EXPIRE#
      2756**DCL      2756--REDEF
PN$.V.TYPE#
      2754**DCL      2754--REDEF
PN$.V.XTNSIZE#
      2751**DCL      2751--REDEF    2753--REDEF
RETUR
      2895**LABEL    2906--GOTO
SCRATCHIT
      2908**LABEL    2847--CALLALT
TRASHTHEM
      2897**LABEL    2889--CALLALT
