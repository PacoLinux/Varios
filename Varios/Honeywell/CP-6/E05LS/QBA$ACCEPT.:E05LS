VERSION E05

PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:1    
        1        1        /*M* QBA$ACCEPT:  ACCEPT field, or ACCEPT dataname FROM whatever.  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=0,DCI=4,CSI=2,IAD=2,DTI=2,AND,ECI=0,DIN=2,STI=2 */
        8        8
        9        9        /*P*  NAME:         QBA$ACCEPT
       10       10              PURPOSE:      Accept an elementary field DAD, or
       11       11                            accept DATE, DAY, DAY-OF-WEEK, LOADER, TIME,
       12       12                            or TERMINAL-ATTRIBUTES into a COBOL-type DAD.
       13       13              DESCRIPTION:  Execute an ACCEPT op-code, whose argument
       14       14                            may be a field, a list of fields, or a COBOL DAD,
       15       15                            depending on a function-code within the op-code
       16       16                            sequence.
       17       17        */
       18       18
       19       19        QBA$ACCEPT: PROC;
       20       20
       21       21        /*D*  NAME:         QBA$ACCEPT
       22       22              CALL:         CALL QBA$ACCEPT;
       23       23              PARAMETERS:   None.
       24       24              INTERFACE:    Called by QAT$TALLYHO when an ACCEPT op-code
       25       25                            is encountered.
       26       26              ENVIRONMENT:  Nothing unusual.
       27       27              INPUT:        QI_1,
       28       28                            FPL rununit static data following the op-code.
       29       29              OUTPUT:       Places data into the DAD's buffer (data of one sort
       30       30                            or another, DAD of one sort or another).
       31       31              SCRATCH:      Various otter stuff.
       32       32              DESCRIPTION:  The ACCEPT verb is divided into two radically different
       33       33                            types (which probably should have been given separate
       34       34                            routines to call):
       35       35                            1)  "ACCEPT fieldname [,fieldname...]"
       36       36                                uses QCR$READ to M$READ data from
       37       37                                a terminal into the field DAD's buffer.  The
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:2    
       38       38                                fieldname(s) must be elementary, but may be arrays.
       39       39                                An INVALID clause may be present.
       40       40                            2)  "ACCEPT dataname FROM DATE",
       41       41                                "ACCEPT dataname FROM DAY",
       42       42                                "ACCEPT dataname FROM DAY-OF-WEEK",
       43       43                                "ACCEPT dataname FROM LOADER",
       44       44                                "ACCEPT dataname FROM TIME",
       45       45                                "ACCEPT dataname FROM TERMINAL-ATTRIBUTES"
       46       46                                uses M$TIME or M$GTRMATTR to put the appropriate
       47       47                                stuff into a COBOL-type DAD.
       48       48        */
       49       49
       50       50          %INCLUDE GM_VIRTUAL_E;
       51      260          %INCLUDE LCP_6;
       52      451          %FPT_FDS ( FPTN = FPT@FDS,
       53      452                     STCLASS = AUTO );
       54      474          %FPT_GDS ( FPTN = FPT@GDS,
       55      475                     STCLASS = AUTO );
       56      499          %FPT_GLINEATTR ( FPTN = FPT@GLINEATTR,
       57      500                           STCLASS = AUTO );
       58      525          %VLP_LINEATTR ( FPTN = VLP@LINEATTR,
       59      526                          STCLASS = AUTO );
       60      548          %FPT_TIME ( FPTN = FPT@TIME,
       61      549                      STCLASS = AUTO );
       62      573          %FPT_TRMATTR ( FPTN = FPT@TRMATTR,
       63      574                         STCLASS = AUTO );
       64      599          %VLP_TRMATTR ( FPTN = VLP@TRMATTR,
       65      600                         STCLASS = AUTO );
       66      638          %FPT_TRMCTL ( FPTN = FPT@TRMCTL,
       67      639                        STCLASS = AUTO );
       68      666          %VLP_TRMCTL ( FPTN = VLP@TRMCTL,
       69      667                        STCLASS = AUTO );
       70      707          %VLP_WINDOW ( FPTN = VLP@WINDOW,
       71      708                        STCLASS = AUTO );
       72      752
       73      753          %INCLUDE G_JIT_M;
       74     1018          %G$JIT;
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:3    
       75     1432    1     DCL G$JIT$ PTR SYMREF;
       76     1433
       77     1434    1     DCL M$ME DCB;
       78     1435
       79     1436          %INCLUDE QG_MACRO_M;
       80     1573          %INCLUDE QI_EQUATES_E;
       81     1932          %INCLUDE QI_PERR_C;
       82     2100          %INCLUDE QI_MACROS_M;
       83     7158          %QI$ALL;
       84    18271          %QI_FPTS;
       85    20316
       86    20317    1     DCL ERROR_STATUS$ PTR;
       87    20318    1     DCL FIELD_COUNT UBIN;
       88    20319    1     DCL FIELD_DAD$ PTR;
       89    20320    1     DCL FIELD_DAD_P$ PTR;
       90    20321    1     DCL FIELD_INDEX UBIN;
       91    20322    1     DCL FILE$ PTR;
       92    20323    1     DCL FILE_STATUS$ PTR;
       93    20324    1     DCL FRAME$ PTR;
       94    20325    1     DCL FRAME_INDEX UBIN;
       95    20326    1     DCL INSTR$ PTR;
       96    20327    1     DCL LAST_FILE$ PTR;
       97    20328    1     DCL PROMPT_INDEX SBIN;
       98    20329    1     DCL P_ITEM_INDEX UBIN;
       99    20330    1     DCL THIS_FIELD_HAS_A_PROMPT BIT(1) ALIGNED;
      100    20331    1     DCL TIME_TYPE_STUFF_BUF CHAR(8);
      101    20332    1     DCL VARIABLE_SOURCE$ PTR;
      102    20333    1     DCL VARIABLE_TARGET$ CPTR;
      103    20334    1     DCL WEEKDAY_INDEX UBIN;
      104    20335
      105    20336    1     DCL WEEKDAY_MON_ETC_TABLE(0:6) CHAR(3) CONSTANT
      106    20337    1         INIT ( 'MON', 'TUE', 'WED', 'THU', 'FRI', 'SAT', 'SUN' );
      107    20338    1     DCL WEEKDAY_1_ETC_TABLE(0:6) CHAR(1) CONSTANT
      108    20339    1         INIT ( '1', '2', '3', '4', '5', '6', '7' );
      109    20340
      110    20341    1     DCL QCC$CDB ENTRY (1) ALTRET;
      111    20342    1     DCL QCC$DMC ENTRY (1) ALTRET;
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:4    
      112    20343    1     DCL QCE$ERROR ENTRY (4);
      113    20344    1     DCL QCE$ERROR_INTERNAL ENTRY (4);
      114    20345    1     DCL QCE$ERROR_M$INTERNAL ENTRY (4);
      115    20346    1     DCL QCF$FIND_CURRENTS ENTRY;
      116    20347    1     DCL QCM$MESS ENTRY (1);
      117    20348    1     DCL QCM$MESS_ERASE ENTRY (1);
      118    20349    1     DCL QCR$READ ENTRY (1);
      119    20350    1     DCL QCS$SETUP_SOURCE ENTRY;
      120    20351    1     DCL QCS$SETUP_TARGET ENTRY;
      121    20352    1     DCL QCU$USE_INVALID_IO ENTRY (1);
      122    20353
      123    20354          %SET LISTMAC = '1'B;
      124    20355
      125    20356          %INCLUDE QCM_MESS_M;
      126    20398          %QCM@MESS;
             20399            %BEGIN_MACRO;
             20400            %SET LISTDIR = '0'B;
             20413    1     DCL 1 QCM@MESS ALIGNED,
             20414    1           2 MESSAGE_LINE_GZ_HEADER$ PTR,
             20415                           /* Pointer to QI$GZ_HEADER for the
             20416                              MESSAGE LINE to use.  */
             20417    1           2 IS_MESSAGE_A_DAD BIT(1) ALIGNED,
             20418                           /* Set if MESSAGE$ points to a DAD,
             20419                              reset if MESSAGE$ points to text
             20420                              (in which case MESSAGE_LENGTH is valid).  */
             20421    1           2 MESSAGE_LENGTH UBIN,
             20422                           /* Length, in bytes, of the error message.  */
             20423    1           2 MESSAGE$ PTR,
             20424                           /* See IS_MESSAGE_A_DAD.  */
             20425    1           2 FRAME_INDEX UBIN,
             20426                           /* Index of the current frame.  */
             20427    1           2 FIELD_INDEX UBIN,
             20428                           /* Index of the field to re-get (if any).  */
             20429    1           2 STATUS UBIN,
             20430                           /* Returned status code:  0 -> Immediate return to level 0;
             20431                                                    >0 -> Status is ok.  */
             20432    1           2 FIELD_ERROR_STOP_INDEX UBIN,
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:5    
             20433                           /* Passed index for QCG$GET_FIELD processing.  */
             20434    1           2 VISUAL_ATTRIBUTE UBIN;
             20435                           /* Matches %EQUs for QI#xxx_VISUAL_ATTR
             20436                              (currently, blinking or non-blinking message line).  */
             20443            %ENDIF;
      127    20446
      128    20447          %INCLUDE QCR_READ_M;
      129    20487          %QCR@READ;
             20488            %BEGIN_MACRO ( STCLASS = STCLASS );
             20489            %SET LISTDIR = '0'B;
             20502    1     DCL 1 QCR@READ ALIGNED,
             20503    1           2 FRAME_START_INDEX UBIN,
             20504                          /* Starting index into QI$FORM_FILE.FRAME_LIST_A@P.  */
             20505    1           2 FRAME_STOP_INDEX UBIN,
             20506                          /* Starting index into QI$FORM_FILE.FRAME_LIST_A@P.  */
             20507    1           2 IS_FIELD_INDEXES_VALID BIT(1) ALIGNED,
             20508                          /* If IS_FIELD_INDEXES_VALID, use them;
             20509                             else use all the fields in the frame.  */
             20510    1           2 FIELD_START_INDEX UBIN,
             20511                          /* Starting index into QI$GZ_FIELD table.  */
             20512    1           2 FIELD_STOP_INDEX UBIN,
             20513                          /* Stopping index into QI$GZ_FIELD table.  */
             20514    1           2 IS_CURSOR_POSITION_VALID BIT(1) ALIGNED,
             20515                          /* If IS_CURSOR_POSITION_VALID, use it;
             20516                             else allow cursor to default to upper-left-most field.  */
             20517    1           2 CURSOR_POSITION BIT(16) ALIGNED,
             20518                          /* POSition of the field on which to place the cursor.  */
             20519    1           2 STATUS UBIN,
             20520                          /* Returned status code:  0 -> Immediate return to level 0;
             20521                                                   >0 -> Status is ok.  */
             20522    1           2 FIELD_ERROR_STOP_INDEX UBIN;
             20523                          /* Passed index for QCG$GET_FIELD processing.  */
             20530            %ENDIF;
      130    20533
      131    20534          %INCLUDE QCU_USE_M;
      132    20588          %QCU@USE;
             20589            %BEGIN_MACRO;
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:6    
             20590            %SET LISTDIR = '0'B;
             20603    1     DCL 1 QCU@USE AUTO ALIGNED,
             20604    1           2 CURR_FRAME$ PTR,
             20605                          /* Pointer to DAD of current frame or ADDR (NIL).  */
             20606    1           2 CURR_NODE$ PTR,
             20607                          /* Pointer to current node or ADDR (NIL).  */
             20608    1           2 USE_DEFAULT_IO UBIN,
             20609                          /* For USE procedures which default applies
             20610                             (see corresponding EQUs).  */
             20611    1           2 IS_TIME_TO_SAVE_AWAY_FIELDS BIT(1) ALIGNED,
             20612                          /* If IS_TIME_TO_SAVE_AWAY_FIELDS, then
             20613                             save the fields within the bounds of
             20614                             FRAME_START_INDEX, FRAME_STOP_INDEX,
             20615                             FIELD_START_INDEX, and FIELD_STOP_INDEX
             20616                             before calling the USE procedure.  */
             20617    1           2 FRAME_START_INDEX UBIN,
             20618                          /* Foist frame of the CURRENT.FORM$
             20619                             involved with the I-O error.  */
             20620    1           2 FRAME_STOP_INDEX UBIN,
             20621                          /* Larst frame of the CURRENT.FORM$
             20622                             involved with the I-O error.  */
             20623    1           2 IS_FIELD_INDEXES_VALID BIT(1) ALIGNED,
             20624                          /* If IS_FIELD_INDEXES_VALID, use them;
             20625                             else use all the fields in the frame.  */
             20626    1           2 FIELD_START_INDEX UBIN,
             20627                          /* Starting index into QI$GZ_FIELD
             20628                             which may have values "pushed".  */
             20629    1           2 FIELD_STOP_INDEX UBIN,
             20630                          /* Stopping index into QI$GZ_FIELD
             20631                             which may have values "pushed".  */
             20632    1           2 IS_CURSOR_POSITION_VALID BIT(1) ALIGNED,
             20633                          /* If IS_CURSOR_POSITION_VALID, use it;
             20634                             else allow cursor to default to upper-left-most field.  */
             20635    1           2 CURSOR_POSITION BIT(16) ALIGNED,
             20636                          /* POSition of the field on which to place the cursor.  */
             20637    1           2 STATUS UBIN;
             20638                          /* Returned action code; see corresponding EQUs.  */
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:7    
             20645            %ENDIF;
      133    20648
      134    20649          %QI$TERMINAL_ATTRIBUTES ( NAME = QI@TERMINAL_ATTRIBUTES,
      135    20650                                    STCLASS = AUTO );
             20651            %BEGIN_MACRO ( STCLASS = STCLASS );
             20652            %SET LISTDIR = '0'B;
             20665        /*    Although the compiler never explicitly generates this,
             20666              it's implicitly the largest possible *thing* to say
             20667              ACCEPT *thing* FROM TERMINAL-ATTRIBUTES
             20668              about.  See the FPL manual under the ACCEPT verb.
             20669        */
             20670    1     DCL 1 QI@TERMINAL_ATTRIBUTES AUTO CALIGNED,
             20671    1           2 STATION_NAME CHAR(8) CALIGNED,
             20672    1           2 CURRENT_DEVICE_PROFILE CHAR(12) CALIGNED,
             20673    1           2 NUMBER_OF_LINES CHAR(4) CALIGNED,
             20674    1           2 NUMBER_OF_COLUMNS CHAR(4) CALIGNED,
             20675    1           2 DEVICE_I_O_CAPABILITY CHAR(1) CALIGNED,
             20676    1           2 CONNECTION_TYPE CHAR(1) CALIGNED,
             20677    1           2 CP_6_NODE CHAR(4) CALIGNED,
             20678    1           2 CP_6_PORT CHAR(4) CALIGNED,
             20679    1           2 PROGRAM_EXECUTION CHAR(1) CALIGNED,
             20680    1           2 DEVICE_TYPE CHAR(1) CALIGNED,
             20681    1           2 CP_6_CONTROLLER CHAR(4) CALIGNED,
             20682    1           2 CP_6_DEVICE CHAR(4) CALIGNED;
             20683    1     DCL 1 QI@TERMINAL_ATTRIBUTES_TEXT REDEF QI@TERMINAL_ATTRIBUTES CHAR(48);
             20690            %ENDIF;
      136    20693
      137    20694          %SET LISTMAC = '0'B;
      138    20695        %EJECT;
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:8    
      139    20696    1       IF QI_1.INSTR$ -> QI$OP_ACCEPT.TYPE = %QI#ACCEPT_FIELD
      140    20697    1       THEN
      141    20698    1   ACCEPT_FIELDNAME:
      142    20699    2         DO;
      143    20700    2           FIELD_COUNT = QI_1.INSTR$ -> QI$OP_ACCEPT.FIELD_COUNT;
      144    20701    2           INSTR$ = QI_1.INSTR$;
      145    20702    2           QI_1.INSTR$ = PINCRW ( INSTR$, FIELD_COUNT + 2 );
      146    20703
      147    20704    2           LAST_FILE$ = ADDR (NIL);
      148    20705
      149    20706    2   ACCEPT_ALL_THE_FIELDS:
      150    20707    3           DO FIELD_INDEX = 0 TO FIELD_COUNT - 1;
      151    20708
      152    20709                  %PROC_ADDRESS ( THING@P =
             20709                      "INSTR$ -> QI$OP_ACCEPT.FIELD_A@P ( FIELD_INDEX )",
      153    20710                  CHECK_FOR_INDIRECTION = YES,
      154    20711                  RESULT$ = FIELD_DAD$ );
      155    20748
      156    20749                  %IF QI#DEBUG;
      157    20750
      158    20751    4             DO CASE ( FIELD_DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.TYPE );
      159    20752
      160    20753    4               CASE ( %QI#TYPE_DISPLAY,
      161    20754    4               %QI#TYPE_ALPHANUMERIC );
      162    20755
      163    20756    4               CASE ( ELSE );
      164    20757    4                 CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );
      165    20758
      166    20759    4             END;
      167    20760
      168    20761                  %ENDIF;
      169    20762
      170    20763    3             QI_1.CURRENT.NODE$ = FIELD_DAD$;
      171    20764
      172    20765    3   RETRY_FIELD_ACCEPT:
      173    20766    3             CALL QCF$FIND_CURRENTS;
      174    20767
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:9    
      175    20768    3             IF NOT QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.INDICATORS.IS_ACTIVE
      176    20769    3             THEN
      177    20770    4               DO;
      178    20771    4                 QI_1.ERROR_STATUS = %E$FRAME_NOT_ACTIVE;
      179    20772    4                 GOTO CHECK_USE_PROCEDURE_OR_INVALID;
      180    20773    4               END;
      181    20774
      182    20775    3             IF NOT QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.
             20775                      IS_INPUT
      183    20776    3             THEN
      184    20777    4               DO;
      185    20778    4                 IF NOT QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.INDICATORS.
             20778                          OPEN_FLAGS.IS_OUTPUT
      186    20779    4                 THEN
      187    20780    4                   QI_1.ERROR_STATUS = %E$FILE_NOT_OPEN;
      188    20781    4                 ELSE
      189    20782    4                   QI_1.ERROR_STATUS = %E$FILE_NOT_OPEN_INPUT;
      190    20783    4                 GOTO CHECK_USE_PROCEDURE_OR_INVALID;
      191    20784    4               END;
      192    20785
      193    20786                  %IF QI#DEBUG;
      194    20787
      195    20788    3             IF NOT QI_1.CURRENT.NODE$ -> QI$FIELD_DAD.WORD0_FLAGS.IO_FLAGS.IS_INPUT
      196    20789    3             THEN
      197    20790    3               CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );
      198    20791
      199    20792    3             IF QI_1.CURRENT.NODE_STATUS$ -> QI$FIELD_STATUS.GZ.FIELD_START_INDEX ~=
      200    20793    3               QI_1.CURRENT.NODE_STATUS$ -> QI$FIELD_STATUS.GZ.FIELD_STOP_INDEX
      201    20794    3             THEN
      202    20795    3               CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );
      203    20796
      204    20797                  %ENDIF;
      205    20798
      206    20799        %EJECT;
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:10   
      207    20800                  /*  Increment past any level_multipliers to get to the
      208    20801                      P.whatever flags.  */
      209    20802    3             FIELD_DAD_P$ = ADDR ( FIELD_DAD$ -> QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS.
             20802                      LEVEL_MULTIPLIER_A
      210    20803    3               ( FIELD_DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT )
      211    20804    3               );
      212    20805
      213    20806    3             IF FIELD_DAD_P$ -> QI$FIELD_DAD_P.P.PROMPT
      214    20807    3             THEN
      215    20808    3   WE_GOTTA_PROMPT:
      216    20809    4               DO;
      217    20810
      218    20811                      %PRESENCE_DISPLACEMENT (
      219    20812                      PRESENCE_THING$ = FIELD_DAD_P$,
      220    20813                      INDEX = P_ITEM_INDEX,
      221    20814                      START = %QI#P_FIELD_FIRST_INDEX,
      222    20815                      STOP = %QI#P_PROMPT_INDEX,
      223    20816                      RESULT = PROMPT_INDEX
      224    20817                      );
      225    20849
      226    20850    4                 QI_1.SOURCE$ = ADDR ( FIELD_DAD_P$ -> QI$FIELD_DAD_P.P_ITEM_A (
             20850                          PROMPT_INDEX ) );
      227    20851
      228    20852    4                 CALL QCS$SETUP_SOURCE;
      229    20853
      230    20854                      %IF QI#DEBUG;
      231    20855
      232    20856    4                 IF QI_1.TYPE.S ~= %QI#TYPE_DISPLAY
      233    20857    4                   AND QI_1.TYPE.S ~= %QI#TYPE_ALPHANUMERIC
      234    20858    4                 THEN
      235    20859    4                   CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );
      236    20860
      237    20861                      %ENDIF;
      238    20862
      239    20863        /*N*
      240    20864              OK, so let's say someone decides to honor the MESSAGE LINE
      241    20865              clause.  Then we'll pull out something like
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:11   
      242    20866              "QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.MESSAGE_LINE.GZ.HEADER$"
      243    20867              to use for the GZ_HEADER$ to the MESSAGE LINE.
      244    20868        */
      245    20869    4                 QCM@MESS.MESSAGE_LINE_GZ_HEADER$ = QI_1.MESSAGE_LINE_GZ.HEADER$;
      246    20870    4                 QCM@MESS.IS_MESSAGE_A_DAD = %YES;
      247    20871    4                 QCM@MESS.MESSAGE$ = QI_1.DAD.S$;
      248    20872    4                 QCM@MESS.VISUAL_ATTRIBUTE = %QI#OUTPUT_VISUAL_ATTRIBUTE;
      249    20873
      250    20874    4                 CALL QCM$MESS ( QCM@MESS );
      251    20875
      252    20876    4                 IF QCM@MESS.STATUS = %QI#USE_INVALID_RETURN
      253    20877    4                 THEN
      254    20878    4                   RETURN;
      255    20879
      256    20880    4                 THIS_FIELD_HAS_A_PROMPT = %YES;
      257    20881
      258    20882    4               END WE_GOTTA_PROMPT;
      259    20883    3             ELSE
      260    20884    3               THIS_FIELD_HAS_A_PROMPT = %NO;
      261    20885
      262    20886    3             QCR@READ.IS_CURSOR_POSITION_VALID = %NO;
      263    20887    3             QCR@READ.FRAME_START_INDEX = QI_1.CURRENT.FRAME_INDEX;
      264    20888    3             QCR@READ.FRAME_STOP_INDEX = QI_1.CURRENT.FRAME_INDEX;
      265    20889    3             QCR@READ.IS_FIELD_INDEXES_VALID = %YES;
      266    20890    3             QCR@READ.FIELD_START_INDEX = QI_1.CURRENT.NODE_STATUS$ -> QI$FIELD_STATUS.
             20890                      GZ.FIELD_START_INDEX;
      267    20891    3             QCR@READ.FIELD_STOP_INDEX = QI_1.CURRENT.NODE_STATUS$ -> QI$FIELD_STATUS.
             20891                      GZ.FIELD_STOP_INDEX;
      268    20892
      269    20893    3             CALL QCR$READ ( QCR@READ );
      270    20894
      271    20895    3             IF QCR@READ.STATUS = %QI#USE_INVALID_RETURN
      272    20896    3             THEN
      273    20897    3               RETURN;
      274    20898
      275    20899    3             IF THIS_FIELD_HAS_A_PROMPT
      276    20900    3             THEN
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:12   
      277    20901    3   WE_GOTTA_GET_RIDDA_THE_PROMPT:
      278    20902    4               DO;
      279    20903    4                 CALL QCM$MESS_ERASE ( QCM@MESS );
      280    20904
      281    20905    4                 IF QCM@MESS.STATUS = %QI#USE_INVALID_RETURN
      282    20906    4                 THEN
      283    20907    4                   RETURN;
      284    20908
      285    20909    4               END WE_GOTTA_GET_RIDDA_THE_PROMPT;
      286    20910
      287    20911    3             IF QI_1.CURRENT.FORM$ -> QI$FORM_FILE.WORD0_FLAGS.IS_ERROR_STATUS_VALID
      288    20912    3             THEN
      289    20913    4               DO;
      290    20914
      291    20915    4                 IF QI_1.CURRENT.FORM$ ~= LAST_FILE$
      292    20916    4                 THEN
      293    20917    5                   DO;
      294    20918
      295    20919    5                     LAST_FILE$ = QI_1.CURRENT.FORM$;
      296    20920
      297    20921                          %DATA_ADDRESS ( THING@D =
             20921                              "QI_1.CURRENT.FORM$ -> QI$FORM_FILE.ERROR_STATUS@D",
      298    20922                          CHECK_FOR_INDIRECTION = NO,
      299    20923                          RESULT$ = ERROR_STATUS$ );
      300    20960
      301    20961    5                     ERROR_STATUS$ -> QI$ERROR_STATUS.TEXT = %QI#OP_ACCEPT_TEXT;
      302    20962
      303    20963    5                   END;
      304    20964
      305    20965    4               END;
      306    20966
      307    20967    3   NEXT_FIELD_PLEASE:
      308    20968
      309    20969    3           END ACCEPT_ALL_THE_FIELDS;
      310    20970
      311    20971    2         END ACCEPT_FIELDNAME;
      312    20972        %EJECT;
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:13   
      313    20973    1       ELSE
      314    20974    1   ACCEPT_DATANAME_FROM_WHATEVER:
      315    20975    2         DO;
      316    20976
      317    20977                /*  We gotta handle ACCEPT
      318    20978                    {DATE|DAY|TIME|DAY-OF-WEEK|LOADER|TERMINAL-ATTRIBUTES}  */
      319    20979    2           INSTR$ = QI_1.INSTR$;
      320    20980    2           QI_1.INSTR$ = ADDR ( INSTR$ -> QI$OP_ACCEPT.NEXT_CODE@P );
      321    20981
      322    20982    2           QI_1.SOURCE$ = ADDR ( INSTR$ -> QI$OP_ACCEPT.DATANAME@P );
      323    20983    2           CALL QCS$SETUP_TARGET;
      324    20984
      325    20985    3           DO CASE ( INSTR$ -> QI$OP_ACCEPT.TYPE );
      326    20986
      327    20987    3             CASE ( %QI#ACCEPT_TERMINAL_ATTRIBUTES );
      328    20988    3               FPT@TRMATTR = QI_FPT_TRMATTR;
      329    20989    3               VBASE ( FPT@TRMATTR.V_ ) = ADDR ( FPT@TRMATTR.V );
      330    20990    3               FPT@TRMATTR.V.DCB# = QI_1.MESSAGE_LINE_GZ.HEADER$ -> QI$GZ_HEADER.DCB#;
      331    20991    3               FPT@TRMATTR.TRMATTR_ = VECTOR ( VLP@TRMATTR );
      332    20992
      333    20993    3               CALL M$GTRMATTR ( FPT@TRMATTR )
      334    20994    3               WHENALTRETURN
      335    20995    4                 DO;
      336    20996    4                   CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );
      337    20997    4                 END;
      338    20998
      339    20999    3               FPT@GLINEATTR = QI_FPT_GLINEATTR;
      340    21000    3               VBASE ( FPT@GLINEATTR.V_ ) = ADDR ( FPT@GLINEATTR.V );
      341    21001    3               FPT@GLINEATTR.V.DCB# = QI_1.MESSAGE_LINE_GZ.HEADER$ -> QI$GZ_HEADER.DCB#
             21001                        ;
      342    21002    3               FPT@GLINEATTR.LINEATTR_ = VECTOR ( VLP@LINEATTR );
      343    21003
      344    21004    3               CALL M$GLINEATTR ( FPT@GLINEATTR )
      345    21005    3               WHENALTRETURN
      346    21006    4                 DO;
      347    21007    4                   CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );
      348    21008    4                 END;
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:14   
      349    21009
      350    21010    3               FPT@TRMCTL = QI_FPT_TRMCTL;
      351    21011    3               VBASE ( FPT@TRMCTL.V_ ) = ADDR ( FPT@TRMCTL.V );
      352    21012    3               FPT@TRMCTL.V.DCB# = QI_1.MESSAGE_LINE_GZ.HEADER$ -> QI$GZ_HEADER.DCB#;
      353    21013    3               FPT@TRMCTL.TRMCTL_ = VECTOR ( VLP@TRMCTL );
      354    21014
      355    21015    3               CALL M$GTRMCTL ( FPT@TRMCTL )
      356    21016    3               WHENALTRETURN
      357    21017    4                 DO;
      358    21018    4                   CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );
      359    21019    4                 END;
      360    21020
      361    21021    3               FPT@TRMCTL = QI_FPT_TRMCTL;
      362    21022    3               VBASE ( FPT@TRMCTL.V_ ) = ADDR ( FPT@TRMCTL.V );
      363    21023    3               FPT@TRMCTL.V.DCB# = DCBNUM ( M$ME );
      364    21024    3               FPT@TRMCTL.V.VLPTYPE = %G_TRMCTL_WINDOW#;
      365    21025    3               FPT@TRMCTL.TRMCTL_ = VECTOR ( VLP@WINDOW );
      366    21026
      367    21027    3               CALL M$GTRMCTL ( FPT@TRMCTL )
      368    21028    3               WHENALTRETURN
      369    21029    4                 DO;
      370    21030    4                   CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );
      371    21031    4                 END;
      372    21032
      373    21033    3               QI@TERMINAL_ATTRIBUTES.STATION_NAME =
      374    21034    3                 G$JIT$ -> G$JIT.ACCN;
      375    21035
      376    21036    3               QI@TERMINAL_ATTRIBUTES.CURRENT_DEVICE_PROFILE =
      377    21037    3                 SUBSTR ( VLP@LINEATTR.PROTXTC.TXT, 0, VLP@LINEATTR.PROTXTC.CNT );
      378    21038
      379    21039    3               CALL BINCHAR ( QI@TERMINAL_ATTRIBUTES.NUMBER_OF_LINES,
      380    21040    3                 VLP@WINDOW.LENGTH );
      381    21041
      382    21042    3               CALL BINCHAR ( QI@TERMINAL_ATTRIBUTES.NUMBER_OF_COLUMNS,
      383    21043    3                 VLP@WINDOW.WIDTH );
      384    21044
      385    21045    3               IF VLP@TRMATTR.INPUT
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:15   
      386    21046    3                 AND VLP@TRMATTR.OUTPUT
      387    21047    3               THEN
      388    21048    3                 QI@TERMINAL_ATTRIBUTES.DEVICE_I_O_CAPABILITY =
      389    21049    3                   %QI#CAPABLE_OF_I_O;
      390    21050    3               ELSE
      391    21051    3                 IF VLP@TRMATTR.INPUT
      392    21052    3                 THEN
      393    21053    3                   QI@TERMINAL_ATTRIBUTES.DEVICE_I_O_CAPABILITY =
      394    21054    3                     %QI#CAPABLE_OF_INPUT;
      395    21055    3                 ELSE
      396    21056    3                   IF VLP@TRMATTR.OUTPUT
      397    21057    3                   THEN
      398    21058    3                     QI@TERMINAL_ATTRIBUTES.DEVICE_I_O_CAPABILITY =
      399    21059    3                       %QI#CAPABLE_OF_OUTPUT;
      400    21060    3                   ELSE
      401    21061    3                     QI@TERMINAL_ATTRIBUTES.DEVICE_I_O_CAPABILITY =
      402    21062    3                       %QI#CAPABLE_OF_NOTHIN;
      403    21063
      404    21064    3               IF VLP@LINEATTR.HARDWIRE
      405    21065    3               THEN
      406    21066    3                 QI@TERMINAL_ATTRIBUTES.CONNECTION_TYPE =
      407    21067    3                   %QI#DEVICE_IS_HARDWIRED;
      408    21068    3               ELSE
      409    21069    3                 QI@TERMINAL_ATTRIBUTES.CONNECTION_TYPE =
      410    21070    3                   %QI#DEVICE_IS_DIALED_UP;
      411    21071
      412    21072    3               QI@TERMINAL_ATTRIBUTES.CP_6_NODE =
      413    21073    3                 VLP@LINEATTR.NODE;
      414    21074
      415    21075    3               QI@TERMINAL_ATTRIBUTES.CP_6_PORT =
      416    21076    3                 VLP@LINEATTR.PORT;
      417    21077
      418    21078    3               IF G$JIT$ -> G$JIT.DB# ~= 0
      419    21079    3               THEN
      420    21080    3                 QI@TERMINAL_ATTRIBUTES.PROGRAM_EXECUTION =
      421    21081    3                   %QI#DEBUGGER_IS_ASSOCIATED;
      422    21082    3               ELSE
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:16   
      423    21083    3                 QI@TERMINAL_ATTRIBUTES.PROGRAM_EXECUTION =
      424    21084    3                   %QI#DEBUGGER_IS_NOT_ASSOCIATED;
      425    21085
      426    21086    3               IF VLP@TRMCTL.RETYPOVR
      427    21087    3               THEN
      428    21088    3                 QI@TERMINAL_ATTRIBUTES.DEVICE_TYPE =
      429    21089    3                   %QI#DEVICE_IS_NOT_HARDCOPY;
      430    21090    3               ELSE
      431    21091    3                 QI@TERMINAL_ATTRIBUTES.DEVICE_TYPE =
      432    21092    3                   %QI#DEVICE_IS_HARDCOPY;
      433    21093
      434    21094    3               QI@TERMINAL_ATTRIBUTES.CP_6_CONTROLLER =
      435    21095    3                 VLP@LINEATTR.CONTROLLER;
      436    21096
      437    21097    3               QI@TERMINAL_ATTRIBUTES.CP_6_DEVICE =
      438    21098    3                 VLP@LINEATTR.DEVICE;
      439    21099
      440    21100    3               ADDR ( QI_1.OP.DATA.T$ -> QI$UBYTE_A ( QI_1.OFFSET.T ) ) ->
      441    21101    3                 QI$VARIABLE_STRING_TARGET.TEXT =
      442    21102    3                 QI@TERMINAL_ATTRIBUTES_TEXT;
      443    21103
      444    21104    3               RETURN;
      445    21105
      446    21106    3             CASE ( %QI#ACCEPT_LOADER );
      447    21107    3               FPT@GDS = QI_FPT_GDS_LOAD;
      448    21108    3               VBASE ( FPT@GDS.V_ ) = ADDR ( FPT@GDS.V );
      449    21109                    /*  ZERO pages means "status request".  */
      450    21110    3               FPT@GDS.V.PAGES = 0;
      451    21111    3               QI_VLP_SEGMENT_LOAD.BASE = %GM_USRDS4_BASE;
      452    21112
      453    21113    3               CALL M$GDS ( FPT@GDS )
      454    21114    3               WHENALTRETURN
      455    21115    4                 DO;
      456    21116    4                   CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );
      457    21117    4                 END;
      458    21118
      459    21119    3               IF QI_VLP_SEGMENT_LOAD.PAGES = 0
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:17   
      460    21120    3               THEN
      461    21121    3   NO_LOADER_INFORMATION:
      462    21122    4                 DO;
      463    21123    4                   IF QI_1.INSTR$ -> QI$OP_SEQUENCE.CODE = %QI#OP_JAZ
      464    21124    4                   THEN
      465    21125    5                     DO;
      466    21126    5                       QI_1.A_REG = 1;
      467    21127    5                       RETURN;
      468    21128    5                     END;
      469    21129    4                   CALL QCE$ERROR ( %E$NO_LOADER_INFORMATION );
      470    21130    4                 END NO_LOADER_INFORMATION;
      471    21131
      472    21132    3               QI_1.A_REG = 0;
      473    21133
      474    21134    3               QI_1.OP.DATA.S$ = QI_VLP_SEGMENT_LOAD.BASE$;
      475    21135    3               QI_1.OP.LEN.S = QI_1.OP.DATA.S$ -> QI$UWORD_A (0);
      476    21136
      477    21137    3               QI_1.OP.DATA.S$ = ADDR ( QI_1.OP.DATA.S$ -> QI$UWORD_A (1) );
      478    21138    3               QI_1.OP.DATA.T$ -> QI$VARIABLE_STRING_TARGET.TEXT =
      479    21139    3                 QI_1.OP.DATA.S$ -> QI$VARIABLE_STRING_SOURCE.TEXT;
      480    21140
      481    21141    3               FPT@FDS = QI_FPT_FDS_LOAD;
      482    21142    3               VBASE ( FPT@FDS.V_ ) = ADDR ( FPT@FDS.V );
      483    21143
      484    21144    3               FPT@FDS.V.PAGES = QI_VLP_SEGMENT_LOAD.PAGES;
      485    21145
      486    21146    3               CALL M$FDS ( FPT@FDS )
      487    21147    3               WHENALTRETURN
      488    21148    4                 DO;
      489    21149    4                   CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );
      490    21150    4                 END;
      491    21151
      492    21152    3               RETURN;
      493    21153
      494    21154    3             CASE ( ELSE );
      495    21155    3               FPT@TIME = QI_FPT_TIME;
      496    21156    3               VBASE ( FPT@TIME.V_ ) = ADDR ( FPT@TIME.V );
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:18   
      497    21157
      498    21158    4               DO CASE ( INSTR$ -> QI$OP_ACCEPT.TYPE );
      499    21159    4                 CASE ( %QI#ACCEPT_DATE );
      500    21160    4                   FPT@TIME.DATE_ = VECTOR ( TIME_TYPE_STUFF_BUF );
      501    21161
      502    21162    4                   QI_1.OP.LEN.S = 6;
      503    21163
      504    21164    4                 CASE ( %QI#ACCEPT_DAY );
      505    21165    4                   FPT@TIME.DAY_ = VECTOR ( TIME_TYPE_STUFF_BUF );
      506    21166
      507    21167    4                   QI_1.OP.LEN.S = 5;
      508    21168
      509    21169    4                 CASE ( %QI#ACCEPT_TIME );
      510    21170    4                   FPT@TIME.TIME_ = VECTOR ( TIME_TYPE_STUFF_BUF );
      511    21171
      512    21172    4                   QI_1.OP.LEN.S = 8;
      513    21173
      514    21174    4                 CASE ( %QI#ACCEPT_DAY_OF_WEEK );
      515    21175    4                   FPT@TIME.V.DEST = 3 /* %LOCAL# */;
      516    21176    4                   FPT@TIME.DAY_ = VECTOR ( TIME_TYPE_STUFF_BUF );
      517    21177
      518    21178    4                   QI_1.OP.LEN.S = 3;
      519    21179
      520    21180    4                 CASE ( ELSE );
      521    21181    4                   CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );
      522    21182
      523    21183    4               END;
      524    21184
      525    21185    3               CALL M$TIME ( FPT@TIME )
      526    21186    3               WHENALTRETURN
      527    21187    4                 DO;
      528    21188    4                   CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );
      529    21189    4                 END;
      530    21190
      531    21191                    /*  Y.O.Y.O.Y. did somebody decide to use
      532    21192                        "1" through "7" as the days?  */
      533    21193    3               IF INSTR$ -> QI$OP_ACCEPT.TYPE = %QI#ACCEPT_DAY_OF_WEEK
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:19   
      534    21194    3               THEN
      535    21195    3   CONVERT_MON_TO_1_ETC:
      536    21196    4                 DO;
      537    21197    5                   DO WEEKDAY_INDEX = 0 TO 6;
      538    21198    5                     IF SUBSTR ( TIME_TYPE_STUFF_BUF, 0, 3 ) =
      539    21199    5                       WEEKDAY_MON_ETC_TABLE ( WEEKDAY_INDEX )
      540    21200    5                     THEN
      541    21201    6                       DO;
      542    21202    6                         SUBSTR ( TIME_TYPE_STUFF_BUF, 0, 1 ) =
      543    21203    6                           WEEKDAY_1_ETC_TABLE ( WEEKDAY_INDEX );
      544    21204    6                         QI_1.OP.LEN.S = 1;
      545    21205    6                         EXIT CONVERT_MON_TO_1_ETC;
      546    21206    6                       END;
      547    21207    5                   END;
      548    21208    4                   CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );
      549    21209    4                 END CONVERT_MON_TO_1_ETC;
      550    21210
      551    21211    3               QI_1.OP.DATA.S$ = ADDR ( TIME_TYPE_STUFF_BUF );
      552    21212
      553    21213    3               IF QI_1.TYPE.T = %QI#TYPE_ALPHANUMERIC
      554    21214    3               THEN
      555    21215    4                 DO;
      556    21216    4                   VARIABLE_SOURCE$ = QI_1.OP.DATA.S$;
      557    21217    4                   VARIABLE_TARGET$ = PINCRC ( QI_1.OP.DATA.T$,
      558    21218    4                     QI_1.OFFSET.T );
      559    21219
      560    21220    4                   VARIABLE_TARGET$ -> QI$VARIABLE_STRING_TARGET.TEXT =
      561    21221    4                     VARIABLE_SOURCE$ -> QI$VARIABLE_STRING_SOURCE.TEXT;
      562    21222    4                 END;
      563    21223    3               ELSE
      564    21224    4                 DO;
      565    21225    4                   QI_1.OP.CIP.S_A (0) = %QI#CIP_DEFAULT_AS;
      566    21226    4                   QI_1.OP.CIP.S.LEN = QI_1.OP.LEN.S;
      567    21227    4                   QI_1.OP.DEC.S = 0;
      568    21228
      569    21229    4                   QI_1.OP.SIZE_ERROR = %QI#DONT_CHECK_FOR_SIZE_ERROR;
      570    21230
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:20   
      571    21231    4                   IF QI_1.TYPE.T = %QI#TYPE_BINARY
      572    21232    4                   THEN
      573    21233    5                     DO;
      574    21234    5                       CALL QCC$CDB ( QI_1.OP )
      575    21235    5                       WHENALTRETURN
      576    21236    6                         DO;
      577    21237    6                           CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );
      578    21238    6                         END;
      579    21239    5                     END;
      580    21240    4                   ELSE
      581    21241    5                     DO;
      582    21242    5                       CALL QCC$DMC ( QI_1.OP )
      583    21243    5                       WHENALTRETURN
      584    21244    6                         DO;
      585    21245    6                           CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );
      586    21246    6                         END;
      587    21247    5                     END;
      588    21248    4                 END;
      589    21249
      590    21250    3           END;
      591    21251
      592    21252    2         END ACCEPT_DATANAME_FROM_WHATEVER;
      593    21253
      594    21254    1       RETURN;
      595    21255
      596    21256        %EJECT;
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:21   
      597    21257    1   CHECK_USE_PROCEDURE_OR_INVALID:
      598    21258    1       QCU@USE.USE_DEFAULT_IO = %QI#USE_DEFAULT_NONE;
      599    21259    1       QCU@USE.IS_TIME_TO_SAVE_AWAY_FIELDS = %NO;
      600    21260    1       QCU@USE.CURR_FRAME$ = QI_1.CURRENT.FRAME$;
      601    21261
      602    21262    1       IF QI_1.CURRENT.NODE$ -> QI$DAD.WORD0_FLAGS.TYPE < %QI#TYPE_MINOR
      603    21263    1       THEN
      604    21264    1         QCU@USE.CURR_NODE$ = QI_1.CURRENT.NODE$;
      605    21265    1       ELSE
      606    21266    1         QCU@USE.CURR_NODE$ = ADDR (NIL);
      607    21267
      608    21268    1       CALL QCU$USE_INVALID_IO ( QCU@USE );
      609    21269
      610    21270    2       DO CASE ( QCU@USE.STATUS );
      611    21271
      612    21272    2         CASE ( %QI#USE_INVALID_RETURN );
      613    21273    2           RETURN;
      614    21274
      615    21275    2         CASE ( %QI#USE_INVALID_RETRY );
      616    21276    2           GOTO RETRY_FIELD_ACCEPT;
      617    21277
      618    21278    2         CASE ( %QI#USE_INVALID_SKIP_TO_NEXT );
      619    21279    2           LAST_FILE$ = ADDR (NIL);
      620    21280    2           GOTO NEXT_FIELD_PLEASE;
      621    21281
      622    21282    2         CASE ( ELSE );
      623    21283    2           CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );
      624    21284
      625    21285    2       END;
      626    21286
      627    21287    1   END QBA$ACCEPT;

PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:22   
--  Include file information  --

   QCU_USE_M.:E05TOU  is referenced.
   QCR_READ_M.:E05TOU  is referenced.
   QCM_MESS_M.:E05TOU  is referenced.
   QI_MACROS_M.:E05TOU  is referenced.
   QI_PERR_C.:E05TOU  is referenced.
   QI_EQUATES_E.:E05TOU  is referenced.
   QG_MACRO_M.:E05TOU  is referenced.
   G_JIT_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   GM_VIRTUAL_E.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QBA$ACCEPT.

   Procedure QBA$ACCEPT requires 1341 words for executable code.
   Procedure QBA$ACCEPT requires 229 words of local(AUTO) storage.

    No errors detected in file QBA$ACCEPT.:E05TSI    .

PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:23   

 Object Unit name= QBA$ACCEPT                                 File name= QBA$ACCEPT.:E05TOU
 UTS= JUL 30 '97 04:39:57.32 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   DCB   even  none     0      0  M$ME
    1  RoData even  UTS     16     10  QBA$ACCEPT
    2   Proc  even  none  1341    53D  QBA$ACCEPT
    3  RoData even  none    16     10  QBA$ACCEPT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        0  QBA$ACCEPT
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:24   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       4 QCE$ERROR_INTERNAL
         yes           Std       0 QCS$SETUP_SOURCE
         yes           Std       0 QCF$FIND_CURRENTS
         yes           Std       1 QCM$MESS
         yes           Std       1 QCR$READ
         yes           Std       1 QCM$MESS_ERASE
         yes           Std       0 QCS$SETUP_TARGET
         yes           Std       4 QCE$ERROR_M$INTERNAL
 yes     yes           Std       1 QCC$CDB
         yes           Std       4 QCE$ERROR
 yes     yes           Std       1 QCC$DMC
         yes           Std       1 QCU$USE_INVALID_IO
                       nStd      0 X6A_AUTO_0
                       nStd      0 X6A_ARET
                       nStd      0 X6C_ALR

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     G$JIT$                                M$ME                                  QI_1
     QI_4_CHAR_ALPHANUMERIC                QI_31_DIGIT_SLS_DISPLAY               QI_16_BIT_BINARY
     QI_32_BIT_BINARY                      QI_31_DIGIT_ST_PACKED                 QI_PICTURE_STRING
     QI_FPT_FDS_LOAD                       QI_FPT_GDS_LOAD                       QI_VLP_SEGMENT_LOAD
     QI_FPT_GLINEATTR                      QI_FPT_TIME                           QI_FPT_TRMATTR
     QI_FPT_TRMCTL                    r    G$ROS$
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:25   


        1        1        /*M* QBA$ACCEPT:  ACCEPT field, or ACCEPT dataname FROM whatever.  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=0,DCI=4,CSI=2,IAD=2,DTI=2,AND,ECI=0,DIN=2,STI=2 */
        8        8
        9        9        /*P*  NAME:         QBA$ACCEPT
       10       10              PURPOSE:      Accept an elementary field DAD, or
       11       11                            accept DATE, DAY, DAY-OF-WEEK, LOADER, TIME,
       12       12                            or TERMINAL-ATTRIBUTES into a COBOL-type DAD.
       13       13              DESCRIPTION:  Execute an ACCEPT op-code, whose argument
       14       14                            may be a field, a list of fields, or a COBOL DAD,
       15       15                            depending on a function-code within the op-code
       16       16                            sequence.
       17       17        */
       18       18
       19       19        QBA$ACCEPT: PROC;

     19   2 000000  D380 0000 0000  xent QBA$ACCEPT      LNJ,B5   X6A_AUTO_0
          2 000003       00E5 0000                       DC       229,0

       20       20
       21       21        /*D*  NAME:         QBA$ACCEPT
       22       22              CALL:         CALL QBA$ACCEPT;
       23       23              PARAMETERS:   None.
       24       24              INTERFACE:    Called by QAT$TALLYHO when an ACCEPT op-code
       25       25                            is encountered.
       26       26              ENVIRONMENT:  Nothing unusual.
       27       27              INPUT:        QI_1,
       28       28                            FPL rununit static data following the op-code.
       29       29              OUTPUT:       Places data into the DAD's buffer (data of one sort
       30       30                            or another, DAD of one sort or another).
       31       31              SCRATCH:      Various otter stuff.
       32       32              DESCRIPTION:  The ACCEPT verb is divided into two radically different
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:26   
       33       33                            types (which probably should have been given separate
       34       34                            routines to call):
       35       35                            1)  "ACCEPT fieldname [,fieldname...]"
       36       36                                uses QCR$READ to M$READ data from
       37       37                                a terminal into the field DAD's buffer.  The
       38       38                                fieldname(s) must be elementary, but may be arrays.
       39       39                                An INVALID clause may be present.
       40       40                            2)  "ACCEPT dataname FROM DATE",
       41       41                                "ACCEPT dataname FROM DAY",
       42       42                                "ACCEPT dataname FROM DAY-OF-WEEK",
       43       43                                "ACCEPT dataname FROM LOADER",
       44       44                                "ACCEPT dataname FROM TIME",
       45       45                                "ACCEPT dataname FROM TERMINAL-ATTRIBUTES"
       46       46                                uses M$TIME or M$GTRMATTR to put the appropriate
       47       47                                stuff into a COBOL-type DAD.
       48       48        */
       49       49
       50       50          %INCLUDE GM_VIRTUAL_E;
       51      260          %INCLUDE LCP_6;
       52      451          %FPT_FDS ( FPTN = FPT@FDS,
       53      452                     STCLASS = AUTO );
       54      474          %FPT_GDS ( FPTN = FPT@GDS,
       55      475                     STCLASS = AUTO );
       56      499          %FPT_GLINEATTR ( FPTN = FPT@GLINEATTR,
       57      500                           STCLASS = AUTO );
       58      525          %VLP_LINEATTR ( FPTN = VLP@LINEATTR,
       59      526                          STCLASS = AUTO );
       60      548          %FPT_TIME ( FPTN = FPT@TIME,
       61      549                      STCLASS = AUTO );
       62      573          %FPT_TRMATTR ( FPTN = FPT@TRMATTR,
       63      574                         STCLASS = AUTO );
       64      599          %VLP_TRMATTR ( FPTN = VLP@TRMATTR,
       65      600                         STCLASS = AUTO );
       66      638          %FPT_TRMCTL ( FPTN = FPT@TRMCTL,
       67      639                        STCLASS = AUTO );
       68      666          %VLP_TRMCTL ( FPTN = VLP@TRMCTL,
       69      667                        STCLASS = AUTO );
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:27   
       70      707          %VLP_WINDOW ( FPTN = VLP@WINDOW,
       71      708                        STCLASS = AUTO );
       72      752
       73      753          %INCLUDE G_JIT_M;
       74     1018          %G$JIT;
       75     1432    1     DCL G$JIT$ PTR SYMREF;
       76     1433
       77     1434    1     DCL M$ME DCB;
       78     1435
       79     1436          %INCLUDE QG_MACRO_M;
       80     1573          %INCLUDE QI_EQUATES_E;
       81     1932          %INCLUDE QI_PERR_C;
       82     2100          %INCLUDE QI_MACROS_M;
       83     7158          %QI$ALL;
       84    18271          %QI_FPTS;
       85    20316
       86    20317    1     DCL ERROR_STATUS$ PTR;
       87    20318    1     DCL FIELD_COUNT UBIN;
       88    20319    1     DCL FIELD_DAD$ PTR;
       89    20320    1     DCL FIELD_DAD_P$ PTR;
       90    20321    1     DCL FIELD_INDEX UBIN;
       91    20322    1     DCL FILE$ PTR;
       92    20323    1     DCL FILE_STATUS$ PTR;
       93    20324    1     DCL FRAME$ PTR;
       94    20325    1     DCL FRAME_INDEX UBIN;
       95    20326    1     DCL INSTR$ PTR;
       96    20327    1     DCL LAST_FILE$ PTR;
       97    20328    1     DCL PROMPT_INDEX SBIN;
       98    20329    1     DCL P_ITEM_INDEX UBIN;
       99    20330    1     DCL THIS_FIELD_HAS_A_PROMPT BIT(1) ALIGNED;
      100    20331    1     DCL TIME_TYPE_STUFF_BUF CHAR(8);
      101    20332    1     DCL VARIABLE_SOURCE$ PTR;
      102    20333    1     DCL VARIABLE_TARGET$ CPTR;
      103    20334    1     DCL WEEKDAY_INDEX UBIN;
      104    20335
      105    20336    1     DCL WEEKDAY_MON_ETC_TABLE(0:6) CHAR(3) CONSTANT
      106    20337    1         INIT ( 'MON', 'TUE', 'WED', 'THU', 'FRI', 'SAT', 'SUN' );
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:28   
      107    20338    1     DCL WEEKDAY_1_ETC_TABLE(0:6) CHAR(1) CONSTANT
      108    20339    1         INIT ( '1', '2', '3', '4', '5', '6', '7' );
      109    20340
      110    20341    1     DCL QCC$CDB ENTRY (1) ALTRET;
      111    20342    1     DCL QCC$DMC ENTRY (1) ALTRET;
      112    20343    1     DCL QCE$ERROR ENTRY (4);
      113    20344    1     DCL QCE$ERROR_INTERNAL ENTRY (4);
      114    20345    1     DCL QCE$ERROR_M$INTERNAL ENTRY (4);
      115    20346    1     DCL QCF$FIND_CURRENTS ENTRY;
      116    20347    1     DCL QCM$MESS ENTRY (1);
      117    20348    1     DCL QCM$MESS_ERASE ENTRY (1);
      118    20349    1     DCL QCR$READ ENTRY (1);
      119    20350    1     DCL QCS$SETUP_SOURCE ENTRY;
      120    20351    1     DCL QCS$SETUP_TARGET ENTRY;
      121    20352    1     DCL QCU$USE_INVALID_IO ENTRY (1);
      122    20353
      123    20354          %SET LISTMAC = '1'B;
      124    20355
      125    20356          %INCLUDE QCM_MESS_M;
      126    20398          %QCM@MESS;
             20399            %BEGIN_MACRO;
             20400            %SET LISTDIR = '0'B;
             20413    1     DCL 1 QCM@MESS ALIGNED,
             20414    1           2 MESSAGE_LINE_GZ_HEADER$ PTR,
             20415                           /* Pointer to QI$GZ_HEADER for the
             20416                              MESSAGE LINE to use.  */
             20417    1           2 IS_MESSAGE_A_DAD BIT(1) ALIGNED,
             20418                           /* Set if MESSAGE$ points to a DAD,
             20419                              reset if MESSAGE$ points to text
             20420                              (in which case MESSAGE_LENGTH is valid).  */
             20421    1           2 MESSAGE_LENGTH UBIN,
             20422                           /* Length, in bytes, of the error message.  */
             20423    1           2 MESSAGE$ PTR,
             20424                           /* See IS_MESSAGE_A_DAD.  */
             20425    1           2 FRAME_INDEX UBIN,
             20426                           /* Index of the current frame.  */
             20427    1           2 FIELD_INDEX UBIN,
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:29   
             20428                           /* Index of the field to re-get (if any).  */
             20429    1           2 STATUS UBIN,
             20430                           /* Returned status code:  0 -> Immediate return to level 0;
             20431                                                    >0 -> Status is ok.  */
             20432    1           2 FIELD_ERROR_STOP_INDEX UBIN,
             20433                           /* Passed index for QCG$GET_FIELD processing.  */
             20434    1           2 VISUAL_ATTRIBUTE UBIN;
             20435                           /* Matches %EQUs for QI#xxx_VISUAL_ATTR
             20436                              (currently, blinking or non-blinking message line).  */
             20443            %ENDIF;
      127    20446
      128    20447          %INCLUDE QCR_READ_M;
      129    20487          %QCR@READ;
             20488            %BEGIN_MACRO ( STCLASS = STCLASS );
             20489            %SET LISTDIR = '0'B;
             20502    1     DCL 1 QCR@READ ALIGNED,
             20503    1           2 FRAME_START_INDEX UBIN,
             20504                          /* Starting index into QI$FORM_FILE.FRAME_LIST_A@P.  */
             20505    1           2 FRAME_STOP_INDEX UBIN,
             20506                          /* Starting index into QI$FORM_FILE.FRAME_LIST_A@P.  */
             20507    1           2 IS_FIELD_INDEXES_VALID BIT(1) ALIGNED,
             20508                          /* If IS_FIELD_INDEXES_VALID, use them;
             20509                             else use all the fields in the frame.  */
             20510    1           2 FIELD_START_INDEX UBIN,
             20511                          /* Starting index into QI$GZ_FIELD table.  */
             20512    1           2 FIELD_STOP_INDEX UBIN,
             20513                          /* Stopping index into QI$GZ_FIELD table.  */
             20514    1           2 IS_CURSOR_POSITION_VALID BIT(1) ALIGNED,
             20515                          /* If IS_CURSOR_POSITION_VALID, use it;
             20516                             else allow cursor to default to upper-left-most field.  */
             20517    1           2 CURSOR_POSITION BIT(16) ALIGNED,
             20518                          /* POSition of the field on which to place the cursor.  */
             20519    1           2 STATUS UBIN,
             20520                          /* Returned status code:  0 -> Immediate return to level 0;
             20521                                                   >0 -> Status is ok.  */
             20522    1           2 FIELD_ERROR_STOP_INDEX UBIN;
             20523                          /* Passed index for QCG$GET_FIELD processing.  */
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:30   
             20530            %ENDIF;
      130    20533
      131    20534          %INCLUDE QCU_USE_M;
      132    20588          %QCU@USE;
             20589            %BEGIN_MACRO;
             20590            %SET LISTDIR = '0'B;
             20603    1     DCL 1 QCU@USE AUTO ALIGNED,
             20604    1           2 CURR_FRAME$ PTR,
             20605                          /* Pointer to DAD of current frame or ADDR (NIL).  */
             20606    1           2 CURR_NODE$ PTR,
             20607                          /* Pointer to current node or ADDR (NIL).  */
             20608    1           2 USE_DEFAULT_IO UBIN,
             20609                          /* For USE procedures which default applies
             20610                             (see corresponding EQUs).  */
             20611    1           2 IS_TIME_TO_SAVE_AWAY_FIELDS BIT(1) ALIGNED,
             20612                          /* If IS_TIME_TO_SAVE_AWAY_FIELDS, then
             20613                             save the fields within the bounds of
             20614                             FRAME_START_INDEX, FRAME_STOP_INDEX,
             20615                             FIELD_START_INDEX, and FIELD_STOP_INDEX
             20616                             before calling the USE procedure.  */
             20617    1           2 FRAME_START_INDEX UBIN,
             20618                          /* Foist frame of the CURRENT.FORM$
             20619                             involved with the I-O error.  */
             20620    1           2 FRAME_STOP_INDEX UBIN,
             20621                          /* Larst frame of the CURRENT.FORM$
             20622                             involved with the I-O error.  */
             20623    1           2 IS_FIELD_INDEXES_VALID BIT(1) ALIGNED,
             20624                          /* If IS_FIELD_INDEXES_VALID, use them;
             20625                             else use all the fields in the frame.  */
             20626    1           2 FIELD_START_INDEX UBIN,
             20627                          /* Starting index into QI$GZ_FIELD
             20628                             which may have values "pushed".  */
             20629    1           2 FIELD_STOP_INDEX UBIN,
             20630                          /* Stopping index into QI$GZ_FIELD
             20631                             which may have values "pushed".  */
             20632    1           2 IS_CURSOR_POSITION_VALID BIT(1) ALIGNED,
             20633                          /* If IS_CURSOR_POSITION_VALID, use it;
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:31   
             20634                             else allow cursor to default to upper-left-most field.  */
             20635    1           2 CURSOR_POSITION BIT(16) ALIGNED,
             20636                          /* POSition of the field on which to place the cursor.  */
             20637    1           2 STATUS UBIN;
             20638                          /* Returned action code; see corresponding EQUs.  */
             20645            %ENDIF;
      133    20648
      134    20649          %QI$TERMINAL_ATTRIBUTES ( NAME = QI@TERMINAL_ATTRIBUTES,
      135    20650                                    STCLASS = AUTO );
             20651            %BEGIN_MACRO ( STCLASS = STCLASS );
             20652            %SET LISTDIR = '0'B;
             20665        /*    Although the compiler never explicitly generates this,
             20666              it's implicitly the largest possible *thing* to say
             20667              ACCEPT *thing* FROM TERMINAL-ATTRIBUTES
             20668              about.  See the FPL manual under the ACCEPT verb.
             20669        */
             20670    1     DCL 1 QI@TERMINAL_ATTRIBUTES AUTO CALIGNED,
             20671    1           2 STATION_NAME CHAR(8) CALIGNED,
             20672    1           2 CURRENT_DEVICE_PROFILE CHAR(12) CALIGNED,
             20673    1           2 NUMBER_OF_LINES CHAR(4) CALIGNED,
             20674    1           2 NUMBER_OF_COLUMNS CHAR(4) CALIGNED,
             20675    1           2 DEVICE_I_O_CAPABILITY CHAR(1) CALIGNED,
             20676    1           2 CONNECTION_TYPE CHAR(1) CALIGNED,
             20677    1           2 CP_6_NODE CHAR(4) CALIGNED,
             20678    1           2 CP_6_PORT CHAR(4) CALIGNED,
             20679    1           2 PROGRAM_EXECUTION CHAR(1) CALIGNED,
             20680    1           2 DEVICE_TYPE CHAR(1) CALIGNED,
             20681    1           2 CP_6_CONTROLLER CHAR(4) CALIGNED,
             20682    1           2 CP_6_DEVICE CHAR(4) CALIGNED;
             20683    1     DCL 1 QI@TERMINAL_ATTRIBUTES_TEXT REDEF QI@TERMINAL_ATTRIBUTES CHAR(48);
             20690            %ENDIF;
      136    20693
      137    20694          %SET LISTMAC = '0'B;
      138    20695        %EJECT;
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:32   
      139    20696    1       IF QI_1.INSTR$ -> QI$OP_ACCEPT.TYPE = %QI#ACCEPT_FIELD

  20696   2 000005  EC80 0000 0006  xsym                 LDB,B6   QI_1+6
          2 000008  82C6 0001                            LB,'E000'X        1,B6
          2 00000A       E000
          2 00000B  0501 0189                            BBT      s:20975,PREL

      140    20697    1       THEN
      141    20698    1   ACCEPT_FIELDNAME:
      142    20699    2         DO;

  20699   2                              ACCEPT_FIELDNAMEnull
      143    20700    2           FIELD_COUNT = QI_1.INSTR$ -> QI$OP_ACCEPT.FIELD_COUNT;

  20700   2 00000D  E846 0001            ACCEPT_FIELDNAMELDR,R6   1,B6
          2 00000F  E570 1FFF                            AND,R6   8191,IMO
          2 000011  EF47 0088                            STR,R6   FIELD_COUNT,AUTO

      144    20701    2           INSTR$ = QI_1.INSTR$;

  20701   2 000013  EFC7 0095                            STB,B6   INSTR$,AUTO

      145    20702    2           QI_1.INSTR$ = PINCRW ( INSTR$, FIELD_COUNT + 2 );

  20702   2 000015  F856                                 LDR,R7   R6
          2 000016  6C00                                 LDV,R6   0
          2 000017  8447 0095                            AID      INSTR$,AUTO
          2 000019  8470 0000 0002                       AID      2,IMO
          2 00001C  8D00 0000 0006  xsym                 SDI      QI_1+6

      146    20703
      147    20704    2           LAST_FILE$ = ADDR (NIL);

  20704   2 00001F  DB80 0000 0000                       LAB,B5   0
          2 000022  DFC7 0097                            STB,B5   LAST_FILE$,AUTO

      148    20705
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:33   
      149    20706    2   ACCEPT_ALL_THE_FIELDS:
      150    20707    3           DO FIELD_INDEX = 0 TO FIELD_COUNT - 1;

  20707   2 000024  8747 008D            ACCEPT_ALL_THE_*CL       FIELD_INDEX,AUTO
          2 000026  0F81 0166                            B        s:20965+3,PREL

      151    20708
      152    20709                  %PROC_ADDRESS ( THING@P =
             20709                      "INSTR$ -> QI$OP_ACCEPT.FIELD_A@P ( FIELD_INDEX )",
      153    20710                  CHECK_FOR_INDIRECTION = YES,
      154    20711                  RESULT$ = FIELD_DAD$ );

  20729   2 000028  ECC7 0095                            LDB,B6   INSTR$,AUTO
          2 00002A  B847 008D                            LDR,R3   FIELD_INDEX,AUTO
          2 00002C  3E02                                 ADV,R3   2
          2 00002D  A836                                 LDR,R2   ,B6,R3
          2 00002E  F852                                 LDR,R7   R2
          2 00002F  6C00                                 LDV,R6   0
          2 000030  8400 0000 0002  xsym                 AID      QI_1+2
          2 000033  8D47 0089                            SDI      FIELD_DAD$,AUTO

  20731   2 000035  DCC7 0089                            LDB,B5   FIELD_DAD$,AUTO
          2 000037  8985                                 CMZ      ,B5
          2 000038  0881 0019                            BAGE     s:20751,PREL

  20732   2 00003A  ECC7 0089                            LDB,B6   FIELD_DAD$,AUTO
          2 00003C  E806                                 LDR,R6   ,B6
          2 00003D  6046                                 SOR,R6   6
          2 00003E  E570 0001                            AND,R6   1,IMO
          2 000040  B846 0002                            LDR,R3   2,B6
          2 000042  A856                                 LDR,R2   R6
          2 000043  DCA0 0000 0000  xsym                 LDB,B5   QI_1,R2
          2 000046  DFC7 00E0                            STB,B5   QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 000048  F853                                 LDR,R7   R3
          2 000049  6C00                                 LDV,R6   0
          2 00004A  8447 00E0                            AID      QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 00004C  8D47 0089                            SDI      FIELD_DAD$,AUTO
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:34   

  20736   2 00004E  ECC7 0089                            LDB,B6   FIELD_DAD$,AUTO
          2 000050  8986                                 CMZ      ,B6
          2 000051  0869                                 BAL      s:20732,SPREL

      155    20748
      156    20749                  %IF QI#DEBUG;
      157    20750
      158    20751    4             DO CASE ( FIELD_DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.TYPE );

  20751   2 000052  ECC7 0089                            LDB,B6   FIELD_DAD$,AUTO
          2 000054  B806                                 LDR,R3   ,B6
          2 000055  B570 000F                            AND,R3   15,IMO
          2 000057  3D04                                 CMV,R3   4
          2 000058  0281 000B                            BGE      s:20757,PREL
          2 00005A  A830 0000 0060  02                   LDR,R2   s:20751+14,R3
          2 00005D  83A0 0000 0064  02                   JMP      s:20757,R2
          2 000060       0009                            DC       s:20763,PREL
          2 000061       0000                            DC       s:20757,PREL
          2 000062       0000                            DC       s:20757,PREL
          2 000063       0009                            DC       s:20763,PREL

      159    20752
      160    20753    4               CASE ( %QI#TYPE_DISPLAY,

      161    20754    4               %QI#TYPE_ALPHANUMERIC );
      162    20755
      163    20756    4               CASE ( ELSE );

      164    20757    4                 CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );

  20757   2 000064  BB80 0000 0001  03                   LAB,B3   +1
          2 000067  CBF0 0100                            LAB,B4   256,IMO
          2 000069  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          2 00006C       0001                            DC       s:20763,PREL

      165    20758
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:35   
      166    20759    4             END;

      167    20760
      168    20761                  %ENDIF;
      169    20762
      170    20763    3             QI_1.CURRENT.NODE$ = FIELD_DAD$;

  20763   2 00006D  ECC7 0089                            LDB,B6   FIELD_DAD$,AUTO
          2 00006F  EF80 0000 0080  xsym                 STB,B6   QI_1+128

      171    20764
      172    20765    3   RETRY_FIELD_ACCEPT:
      173    20766    3             CALL QCF$FIND_CURRENTS;

  20766   2 000072  CBF0 0000            RETRY_FIELD_ACC*LAB,B4   0,IMO
          2 000074  E380 0000 0000  xent                 LNJ,B6   QCF$FIND_CURRENTS
          2 000077       0001                            DC       s:20768,PREL

      174    20767
      175    20768    3             IF NOT QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.INDICATORS.IS_ACTIVE

  20768   2 000078  EC80 0000 007C  xsym                 LDB,B6   QI_1+124
          2 00007B  89C6 000C                            CMZ      12,B6
          2 00007D  0801 0007                            BAL      s:20775,PREL

      176    20769    3             THEN
      177    20770    4               DO;

      178    20771    4                 QI_1.ERROR_STATUS = %E$FRAME_NOT_ACTIVE;

  20771   2 00007F  6C07                                 LDV,R6   7
          2 000080  EF00 0000 008C  xsym                 STR,R6   QI_1+140

      179    20772    4                 GOTO CHECK_USE_PROCEDURE_OR_INVALID;

  20772   2 000083  0F81 046C                            B        s:21258,PREL

PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:36   
      180    20773    4               END;
      181    20774
      182    20775    3             IF NOT QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.
             20775                      IS_INPUT

  20775   2 000085  DC80 0000 0078  xsym                 LDB,B5   QI_1+120
          2 000088  82C5 0008                            LB,'0200'X        8,B5
          2 00008A       0200
          2 00008B  0501 0012                            BBT      s:20788,PREL

      183    20776    3             THEN
      184    20777    4               DO;

      185    20778    4                 IF NOT QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.INDICATORS.
             20778                          OPEN_FLAGS.IS_OUTPUT

  20778   2 00008D  82C5 0008                            LB,'0400'X        8,B5
  20778   2 00008F       0400
          2 000090  0501 0007                            BBT      s:20782,PREL

      186    20779    4                 THEN
      187    20780    4                   QI_1.ERROR_STATUS = %E$FILE_NOT_OPEN;

  20780   2 000092  6C01                                 LDV,R6   1
          2 000093  EF00 0000 008C  xsym                 STR,R6   QI_1+140
          2 000096  0F81 0005                            B        s:20783,PREL

      188    20781    4                 ELSE
      189    20782    4                   QI_1.ERROR_STATUS = %E$FILE_NOT_OPEN_INPUT;

  20782   2 000098  6C05                                 LDV,R6   5
          2 000099  EF00 0000 008C  xsym                 STR,R6   QI_1+140

      190    20783    4                 GOTO CHECK_USE_PROCEDURE_OR_INVALID;

  20783   2 00009C  0F81 0453                            B        s:21258,PREL

PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:37   
      191    20784    4               END;
      192    20785
      193    20786                  %IF QI#DEBUG;
      194    20787
      195    20788    3             IF NOT QI_1.CURRENT.NODE$ -> QI$FIELD_DAD.WORD0_FLAGS.IO_FLAGS.IS_INPUT

  20788   2 00009E  CC80 0000 0080  xsym                 LDB,B4   QI_1+128
          2 0000A1  8284                                 LB,'2000'X        ,B4
          2 0000A2       2000
          2 0000A3  0501 000A                            BBT      s:20792,PREL

      196    20789    3             THEN
      197    20790    3               CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );

  20790   2 0000A5  BB80 0000 0001  03                   LAB,B3   +1
          2 0000A8  CBF0 0100                            LAB,B4   256,IMO
          2 0000AA  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          2 0000AD       0001                            DC       s:20792,PREL

      198    20791
      199    20792    3             IF QI_1.CURRENT.NODE_STATUS$ -> QI$FIELD_STATUS.GZ.FIELD_START_INDEX ~=

  20792   2 0000AE  EC80 0000 0082  xsym                 LDB,B6   QI_1+130
          2 0000B1  E806                                 LDR,R6   ,B6
          2 0000B2  E946 0001                            CMR,R6   1,B6
          2 0000B4  0901 000A                            BE       s:20802,PREL

      200    20793    3               QI_1.CURRENT.NODE_STATUS$ -> QI$FIELD_STATUS.GZ.FIELD_STOP_INDEX
      201    20794    3             THEN
      202    20795    3               CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );

  20795   2 0000B6  BB80 0000 0004  03                   LAB,B3   +4
          2 0000B9  CBF0 0100                            LAB,B4   256,IMO
          2 0000BB  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          2 0000BE       0001                            DC       s:20802,PREL

      203    20796
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:38   
      204    20797                  %ENDIF;
      205    20798
      206    20799        %EJECT;
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:39   
      207    20800                  /*  Increment past any level_multipliers to get to the
      208    20801                      P.whatever flags.  */
      209    20802    3             FIELD_DAD_P$ = ADDR ( FIELD_DAD$ -> QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS.
             20802                      LEVEL_MULTIPLIER_A

  20802   2 0000BF  ECC7 0089                            LDB,B6   FIELD_DAD$,AUTO
          2 0000C1  B806                                 LDR,R3   ,B6
          2 0000C2  3044                                 SOR,R3   4
          2 0000C3  B570 0003                            AND,R3   3,IMO
          2 0000C5  3001                                 SOL,R3   1
          2 0000C6  3E0B                                 ADV,R3   11
          2 0000C7  DBB6                                 LAB,B5   ,B6,R3
          2 0000C8  DFC7 008B                            STB,B5   FIELD_DAD_P$,AUTO

      210    20803    3               ( FIELD_DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT )
      211    20804    3               );
      212    20805
      213    20806    3             IF FIELD_DAD_P$ -> QI$FIELD_DAD_P.P.PROMPT

  20806   2 0000CA  8285                                 LB,'1000'X        ,B5
  20806   2 0000CB       1000
          2 0000CC  0581 005B                            BBF      s:20884,PREL

      214    20807    3             THEN
      215    20808    3   WE_GOTTA_PROMPT:
      216    20809    4               DO;

  20809   2                              WE_GOTTA_PROMPT null
      217    20810
      218    20811                      %PRESENCE_DISPLACEMENT (
      219    20812                      PRESENCE_THING$ = FIELD_DAD_P$,
      220    20813                      INDEX = P_ITEM_INDEX,
      221    20814                      START = %QI#P_FIELD_FIRST_INDEX,
      222    20815                      STOP = %QI#P_PROMPT_INDEX,
      223    20816                      RESULT = PROMPT_INDEX
      224    20817                      );

PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:40   
  20833   2 0000CE  8947 0099            WE_GOTTA_PROMPT LBT,'FFFF'X       PROMPT_INDEX,AUTO
  20833   2 0000D0       FFFF

  20834   2 0000D1  8747 009A                            CL       P_ITEM_INDEX,AUTO

  20835   2 0000D3  ECC7 008B                            LDB,B6   FIELD_DAD_P$,AUTO
          2 0000D5  B847 009A                            LDR,R3   P_ITEM_INDEX,AUTO
          2 0000D7  82B6                                 LB       ,B6,R3
          2 0000D8  0581 0003                            BBF      s:20838,PREL

  20837   2 0000DA  8AC7 0099                            INC      PROMPT_INDEX,AUTO

  20838   2 0000DC  8AC7 009A                            INC      P_ITEM_INDEX,AUTO
          2 0000DE  E847 009A                            LDR,R6   P_ITEM_INDEX,AUTO
          2 0000E0  6D03                                 CMV,R6   3
          2 0000E1  03F2                                 BLE      s:20835,SPREL

      225    20849
      226    20850    4                 QI_1.SOURCE$ = ADDR ( FIELD_DAD_P$ -> QI$FIELD_DAD_P.P_ITEM_A (
             20850                          PROMPT_INDEX ) );

  20850   2 0000E2  B847 0099                            LDR,R3   PROMPT_INDEX,AUTO
          2 0000E4  3E01                                 ADV,R3   1
          2 0000E5  DBB6                                 LAB,B5   ,B6,R3
          2 0000E6  DF80 0000 0018  xsym                 STB,B5   QI_1+24

      227    20851
      228    20852    4                 CALL QCS$SETUP_SOURCE;

  20852   2 0000E9  CBF0 0000                            LAB,B4   0,IMO
          2 0000EB  E380 0000 0000  xent                 LNJ,B6   QCS$SETUP_SOURCE
          2 0000EE       0001                            DC       s:20856,PREL

      229    20853
      230    20854                      %IF QI#DEBUG;
      231    20855
      232    20856    4                 IF QI_1.TYPE.S ~= %QI#TYPE_DISPLAY
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:41   

  20856   2 0000EF  E800 0000 0050  xsym                 LDR,R6   QI_1+80
          2 0000F2  6901 000D                            BEZ,R6   s:20869,PREL
          2 0000F4  6D03                                 CMV,R6   3
          2 0000F5  0901 000A                            BE       s:20869,PREL

      233    20857    4                   AND QI_1.TYPE.S ~= %QI#TYPE_ALPHANUMERIC
      234    20858    4                 THEN
      235    20859    4                   CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );

  20859   2 0000F7  BB80 0000 0001  03                   LAB,B3   +1
          2 0000FA  CBF0 0100                            LAB,B4   256,IMO
          2 0000FC  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          2 0000FF       0001                            DC       s:20869,PREL

      236    20860
      237    20861                      %ENDIF;
      238    20862
      239    20863        /*N*
      240    20864              OK, so let's say someone decides to honor the MESSAGE LINE
      241    20865              clause.  Then we'll pull out something like
      242    20866              "QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.MESSAGE_LINE.GZ.HEADER$"
      243    20867              to use for the GZ_HEADER$ to the MESSAGE LINE.
      244    20868        */
      245    20869    4                 QCM@MESS.MESSAGE_LINE_GZ_HEADER$ = QI_1.MESSAGE_LINE_GZ.HEADER$;

  20869   2 000100  EC80 0000 0064  xsym                 LDB,B6   QI_1+100
          2 000103  EFC7 00A5                            STB,B6   QCM@MESS,AUTO

      246    20870    4                 QCM@MESS.IS_MESSAGE_A_DAD = %YES;

  20870   2 000105  8947 00A7                            LBT,'8000'X       QCM@MESS+2,AUTO
  20870   2 000107       8000

      247    20871    4                 QCM@MESS.MESSAGE$ = QI_1.DAD.S$;

  20871   2 000108  DC80 0000 0032  xsym                 LDB,B5   QI_1+50
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:42   
          2 00010B  DFC7 00A9                            STB,B5   QCM@MESS+4,AUTO

      248    20872    4                 QCM@MESS.VISUAL_ATTRIBUTE = %QI#OUTPUT_VISUAL_ATTRIBUTE;

  20872   2 00010D  6C05                                 LDV,R6   5
          2 00010E  EF47 00AF                            STR,R6   QCM@MESS+10,AUTO

      249    20873
      250    20874    4                 CALL QCM$MESS ( QCM@MESS );

  20874   2 000110  CBC7 00A5                            LAB,B4   QCM@MESS,AUTO
          2 000112  CFC7 00E0                            STB,B4   QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 000114  BBC7 00E0                            LAB,B3   QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 000116  CBF0 0100                            LAB,B4   256,IMO
          2 000118  E380 0000 0000  xent                 LNJ,B6   QCM$MESS
          2 00011B       0001                            DC       s:20876,PREL

      251    20875
      252    20876    4                 IF QCM@MESS.STATUS = %QI#USE_INVALID_RETURN

  20876   2 00011C  E847 00AD                            LDR,R6   QCM@MESS+8,AUTO
          2 00011E  6981 0004                            BNEZ,R6  s:20880,PREL

      253    20877    4                 THEN
      254    20878    4                   RETURN;

  20878   2 000120  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      255    20879
      256    20880    4                 THIS_FIELD_HAS_A_PROMPT = %YES;

  20880   2 000123  8947 009B                            LBT,'8000'X       THIS_FIELD_HAS_A_PROMPT,AUTO
  20880   2 000125       8000

      257    20881
      258    20882    4               END WE_GOTTA_PROMPT;

PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:43   
  20882   2 000126  0F81 0003                            B        s:20886,PREL

      259    20883    3             ELSE
      260    20884    3               THIS_FIELD_HAS_A_PROMPT = %NO;

  20884   2 000128  8747 009B                            CL       THIS_FIELD_HAS_A_PROMPT,AUTO

      261    20885
      262    20886    3             QCR@READ.IS_CURSOR_POSITION_VALID = %NO;

  20886   2 00012A  8747 00B5                            CL       QCR@READ+5,AUTO

      263    20887    3             QCR@READ.FRAME_START_INDEX = QI_1.CURRENT.FRAME_INDEX;

  20887   2 00012C  E800 0000 007E  xsym                 LDR,R6   QI_1+126
          2 00012F  EF47 00B0                            STR,R6   QCR@READ,AUTO

      264    20888    3             QCR@READ.FRAME_STOP_INDEX = QI_1.CURRENT.FRAME_INDEX;

  20888   2 000131  EF47 00B1                            STR,R6   QCR@READ+1,AUTO

      265    20889    3             QCR@READ.IS_FIELD_INDEXES_VALID = %YES;

  20889   2 000133  8947 00B2                            LBT,'8000'X       QCR@READ+2,AUTO
  20889   2 000135       8000

      266    20890    3            QCR@READ.FIELD_START_INDEX = QI_1.CURRENT.NODE_STATUS$ -> QI$FIELD_STATUS.
             20890                      GZ.FIELD_START_INDEX;

  20890   2 000136  EC80 0000 0082  xsym                 LDB,B6   QI_1+130
          2 000139  D806                                 LDR,R5   ,B6
          2 00013A  DF47 00B3                            STR,R5   QCR@READ+3,AUTO

      267    20891    3             QCR@READ.FIELD_STOP_INDEX = QI_1.CURRENT.NODE_STATUS$ -> QI$FIELD_STATUS.
             20891                      GZ.FIELD_STOP_INDEX;

  20891   2 00013C  C846 0001                            LDR,R4   1,B6
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:44   
          2 00013E  CF47 00B4                            STR,R4   QCR@READ+4,AUTO

      268    20892
      269    20893    3             CALL QCR$READ ( QCR@READ );

  20893   2 000140  DBC7 00B0                            LAB,B5   QCR@READ,AUTO
          2 000142  DFC7 00E0                            STB,B5   QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 000144  BBC7 00E0                            LAB,B3   QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 000146  CBF0 0100                            LAB,B4   256,IMO
          2 000148  E380 0000 0000  xent                 LNJ,B6   QCR$READ
          2 00014B       0001                            DC       s:20895,PREL

      270    20894
      271    20895    3             IF QCR@READ.STATUS = %QI#USE_INVALID_RETURN

  20895   2 00014C  E847 00B7                            LDR,R6   QCR@READ+7,AUTO
          2 00014E  6981 0004                            BNEZ,R6  s:20899,PREL

      272    20896    3             THEN
      273    20897    3               RETURN;

  20897   2 000150  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      274    20898
      275    20899    3             IF THIS_FIELD_HAS_A_PROMPT

  20899   2 000153  89C7 009B                            CMZ      THIS_FIELD_HAS_A_PROMPT,AUTO
          2 000155  0881 0014                            BAGE     s:20911,PREL

      276    20900    3             THEN
      277    20901    3   WE_GOTTA_GET_RIDDA_THE_PROMPT:
      278    20902    4               DO;

  20902   2                              WE_GOTTA_GET_RI*null
      279    20903    4                 CALL QCM$MESS_ERASE ( QCM@MESS );

  20903   2 000157  EBC7 00A5            WE_GOTTA_GET_RI*LAB,B6   QCM@MESS,AUTO
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:45   
          2 000159  EFC7 00E0                            STB,B6   QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 00015B  BBC7 00E0                            LAB,B3   QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 00015D  CBF0 0100                            LAB,B4   256,IMO
          2 00015F  E380 0000 0000  xent                 LNJ,B6   QCM$MESS_ERASE
          2 000162       0001                            DC       s:20905,PREL

      280    20904
      281    20905    4                 IF QCM@MESS.STATUS = %QI#USE_INVALID_RETURN

  20905   2 000163  E847 00AD                            LDR,R6   QCM@MESS+8,AUTO
          2 000165  6981 0004                            BNEZ,R6  s:20911,PREL

      282    20906    4                 THEN
      283    20907    4                   RETURN;

  20907   2 000167  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      284    20908
      285    20909    4               END WE_GOTTA_GET_RIDDA_THE_PROMPT;
      286    20910
      287    20911    3             IF QI_1.CURRENT.FORM$ -> QI$FORM_FILE.WORD0_FLAGS.IS_ERROR_STATUS_VALID

  20911   2 00016A  EC80 0000 0076  xsym                 LDB,B6   QI_1+118
          2 00016D  8286                                 LB,'4000'X        ,B6
          2 00016E       4000
          2 00016F  0581 001A                            BBF      s:20965,PREL

      288    20912    3             THEN
      289    20913    4               DO;

      290    20914
      291    20915    4                 IF QI_1.CURRENT.FORM$ ~= LAST_FILE$

  20915   2 000171  EDC7 0097                            CMB,B6   LAST_FILE$,AUTO
          2 000173  0901 0016                            BE       s:20965,PREL

      292    20916    4                 THEN
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:46   
      293    20917    5                   DO;

      294    20918
      295    20919    5                     LAST_FILE$ = QI_1.CURRENT.FORM$;

  20919   2 000175  EFC7 0097                            STB,B6   LAST_FILE$,AUTO

      296    20920
      297    20921                          %DATA_ADDRESS ( THING@D =
             20921                              "QI_1.CURRENT.FORM$ -> QI$FORM_FILE.ERROR_STATUS@D",
      298    20922                          CHECK_FOR_INDIRECTION = NO,
      299    20923                          RESULT$ = ERROR_STATUS$ );

  20941   2 000177  B846 0003                            LDR,R3   3,B6
          2 000179  F853                                 LDR,R7   R3
          2 00017A  6C00                                 LDV,R6   0
          2 00017B  8400 0000 0000  xsym                 AID      QI_1
          2 00017E  8D47 0086                            SDI      ERROR_STATUS$,AUTO

      300    20960
      301    20961    5                     ERROR_STATUS$ -> QI$ERROR_STATUS.TEXT = %QI#OP_ACCEPT_TEXT;

  20961   2 000180  DB80 0000 0000  01                   LAB,B5   WEEKDAY_MON_ETC_TABLE
          2 000183  CCC7 0086                            LDB,B4   ERROR_STATUS$,AUTO
          2 000185  0021                                 ALR      ;
          2 000186       4205 000F                                ALPHANUM(15,B5,,2),;
          2 000188       4804 0000                                ALPHANUM(0,B4,,8,FILL)

      302    20962
      303    20963    5                   END;

      304    20964
      305    20965    4               END;

      306    20966
      307    20967    3   NEXT_FIELD_PLEASE:
      308    20968
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:47   
      309    20969    3           END ACCEPT_ALL_THE_FIELDS;

  20969   2 00018A  437F                 NEXT_FIELD_PLEA*CSYNC    s:20961+9,SPREL
          2 00018B  8AC7 008D                            INC      FIELD_INDEX,AUTO
          2 00018D  E847 008D                            LDR,R6   FIELD_INDEX,AUTO
          2 00018F  E947 0088                            CMR,R6   FIELD_COUNT,AUTO
          2 000191  0201 FE96                            BL       s:20729,PREL

      310    20970
      311    20971    2         END ACCEPT_FIELDNAME;

  20971   2 000193  0F81 0359                            B        s:21254,PREL

      312    20972        %EJECT;
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:48   
      313    20973    1       ELSE
      314    20974    1   ACCEPT_DATANAME_FROM_WHATEVER:
      315    20975    2         DO;

  20975   2                              ACCEPT_DATANAME*null
      316    20976
      317    20977                /*  We gotta handle ACCEPT
      318    20978                    {DATE|DAY|TIME|DAY-OF-WEEK|LOADER|TERMINAL-ATTRIBUTES}  */
      319    20979    2           INSTR$ = QI_1.INSTR$;

  20979   2 000195  EFC7 0095            ACCEPT_DATANAME*STB,B6   INSTR$,AUTO

      320    20980    2           QI_1.INSTR$ = ADDR ( INSTR$ -> QI$OP_ACCEPT.NEXT_CODE@P );

  20980   2 000197  DBC6 0003                            LAB,B5   3,B6
          2 000199  DF80 0000 0006  xsym                 STB,B5   QI_1+6

      321    20981
      322    20982    2           QI_1.SOURCE$ = ADDR ( INSTR$ -> QI$OP_ACCEPT.DATANAME@P );

  20982   2 00019C  CBC6 0002                            LAB,B4   2,B6
          2 00019E  CF80 0000 0018  xsym                 STB,B4   QI_1+24

      323    20983    2           CALL QCS$SETUP_TARGET;

  20983   2 0001A1  CBF0 0000                            LAB,B4   0,IMO
          2 0001A3  E380 0000 0000  xent                 LNJ,B6   QCS$SETUP_TARGET
          2 0001A6       0001                            DC       s:20985,PREL

      324    20984
      325    20985    3           DO CASE ( INSTR$ -> QI$OP_ACCEPT.TYPE );

  20985   2 0001A7  ECC7 0095                            LDB,B6   INSTR$,AUTO
          2 0001A9  B846 0001                            LDR,R3   1,B6
          2 0001AB  304D                                 SOR,R3   13
          2 0001AC  3EFB                                 ADV,R3   -5
          2 0001AD  3D02                                 CMV,R3   2
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:49   
          2 0001AE  0281 0206                            BGE      s:21155,PREL
          2 0001B0  A830 0000 01B6  02                   LDR,R2   s:20985+15,R3
          2 0001B3  83A0 0000 01B8  02                   JMP      s:20988,R2
          2 0001B6       0000                            DC       s:20988,PREL
          2 0001B7       0179                            DC       s:21107,PREL

      326    20986
      327    20987    3             CASE ( %QI#ACCEPT_TERMINAL_ATTRIBUTES );

      328    20988    3               FPT@TRMATTR = QI_FPT_TRMATTR;

  20988   2 0001B8  AB80 0000 0000  xsym                 LAB,B2   QI_FPT_TRMATTR
          2 0001BB  2C00                                 LDV,R2   0
          2 0001BC  6C0E                                 LDV,R6   14
          2 0001BD  BBC7 004B                            LAB,B3   FPT@TRMATTR,AUTO
          2 0001BF  3C00                                 LDV,R3   0
          2 0001C0  0008                                 MMM

      329    20989    3               VBASE ( FPT@TRMATTR.V_ ) = ADDR ( FPT@TRMATTR.V );

  20989   2 0001C1  EBC7 0051                            LAB,B6   FPT@TRMATTR+6,AUTO
          2 0001C3  EFC7 004C                            STB,B6   FPT@TRMATTR+1,AUTO

      330    20990    3               FPT@TRMATTR.V.DCB# = QI_1.MESSAGE_LINE_GZ.HEADER$ -> QI$GZ_HEADER.DCB#;

  20990   2 0001C5  DC80 0000 0064  xsym                 LDB,B5   QI_1+100
          2 0001C8  E845 0003                            LDR,R6   3,B5
          2 0001CA  E7C7 0051                            STH,R6   FPT@TRMATTR+6,AUTO

      331    20991    3               FPT@TRMATTR.TRMATTR_ = VECTOR ( VLP@TRMATTR );

  20991   2 0001CC  CBC7 0052                            LAB,B4   VLP@TRMATTR,AUTO
          2 0001CE  CFC7 00E1                            STB,B4   QI@TERMINAL_ATTRIBUTES+26,AUTO
          2 0001D0  6C27                                 LDV,R6   39
          2 0001D1  EF47 00E0                            STR,R6   QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 0001D3  ABC7 00E0                            LAB,B2   QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 0001D5  2C00                                 LDV,R2   0
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:50   
          2 0001D6  6C06                                 LDV,R6   6
          2 0001D7  BBC7 004E                            LAB,B3   FPT@TRMATTR+3,AUTO
          2 0001D9  3C00                                 LDV,R3   0
          2 0001DA  0008                                 MMM

      332    20992
      333    20993    3               CALL M$GTRMATTR ( FPT@TRMATTR )

  20993   2 0001DB  BBC7 004B                            LAB,B3   FPT@TRMATTR,AUTO
          2 0001DD  B870 0987                            LDR,R3   2439,IMO
          2 0001DF  0001                                 MCL
          2 0001E0       0003                            DC       s:20996,PREL
          2 0001E1  0F81 000A                            B        s:20999,PREL

      334    20994    3               WHENALTRETURN
      335    20995    4                 DO;

      336    20996    4                   CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );

  20996   2 0001E3  BB80 0000 0007  03                   LAB,B3   +7
          2 0001E6  CBF0 0100                            LAB,B4   256,IMO
          2 0001E8  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_M$INTERNAL
          2 0001EB       0001                            DC       s:20999,PREL

      337    20997    4                 END;

      338    20998
      339    20999    3               FPT@GLINEATTR = QI_FPT_GLINEATTR;

  20999   2 0001EC  AB80 0000 0000  xsym                 LAB,B2   QI_FPT_GLINEATTR
          2 0001EF  2C00                                 LDV,R2   0
          2 0001F0  6C0E                                 LDV,R6   14
          2 0001F1  BB87                                 LAB,B3   ,AUTO
          2 0001F2  3C28                                 LDV,R3   40
          2 0001F3  0008                                 MMM

      340    21000    3               VBASE ( FPT@GLINEATTR.V_ ) = ADDR ( FPT@GLINEATTR.V );
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:51   

  21000   2 0001F4  EBC7 001A                            LAB,B6   FPT@GLINEATTR+6,AUTO
          2 0001F6  EFC7 0015                            STB,B6   FPT@GLINEATTR+1,AUTO

      341    21001    3              FPT@GLINEATTR.V.DCB# = QI_1.MESSAGE_LINE_GZ.HEADER$ -> QI$GZ_HEADER.DCB#
             21001                        ;

  21001   2 0001F8  DC80 0000 0064  xsym                 LDB,B5   QI_1+100
          2 0001FB  E845 0003                            LDR,R6   3,B5
          2 0001FD  E7C7 001A                            STH,R6   FPT@GLINEATTR+6,AUTO

      342    21002    3               FPT@GLINEATTR.LINEATTR_ = VECTOR ( VLP@LINEATTR );

  21002   2 0001FF  CBC7 001B                            LAB,B4   VLP@LINEATTR,AUTO
          2 000201  CFC7 00E1                            STB,B4   QI@TERMINAL_ATTRIBUTES+26,AUTO
          2 000203  6C3F                                 LDV,R6   63
          2 000204  EF47 00E0                            STR,R6   QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 000206  ABC7 00E0                            LAB,B2   QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 000208  2C00                                 LDV,R2   0
          2 000209  6C06                                 LDV,R6   6
          2 00020A  BB87                                 LAB,B3   ,AUTO
          2 00020B  3C2E                                 LDV,R3   46
          2 00020C  0008                                 MMM

      343    21003
      344    21004    3               CALL M$GLINEATTR ( FPT@GLINEATTR )

  21004   2 00020D  BBC7 0014                            LAB,B3   FPT@GLINEATTR,AUTO
          2 00020F  B870 0985                            LDR,R3   2437,IMO
          2 000211  0001                                 MCL
          2 000212       0003                            DC       s:21007,PREL
          2 000213  0F81 000A                            B        s:21010,PREL

      345    21005    3               WHENALTRETURN
      346    21006    4                 DO;

      347    21007    4                   CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:52   

  21007   2 000215  BB80 0000 0007  03                   LAB,B3   +7
          2 000218  CBF0 0100                            LAB,B4   256,IMO
          2 00021A  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_M$INTERNAL
          2 00021D       0001                            DC       s:21010,PREL

      348    21008    4                 END;

      349    21009
      350    21010    3               FPT@TRMCTL = QI_FPT_TRMCTL;

  21010   2 00021E  AB80 0000 0000  xsym                 LAB,B2   QI_FPT_TRMCTL
          2 000221  2C00                                 LDV,R2   0
          2 000222  6C10                                 LDV,R6   16
          2 000223  BBC7 0066                            LAB,B3   FPT@TRMCTL,AUTO
          2 000225  3C00                                 LDV,R3   0
          2 000226  0008                                 MMM

      351    21011    3               VBASE ( FPT@TRMCTL.V_ ) = ADDR ( FPT@TRMCTL.V );

  21011   2 000227  EBC7 006C                            LAB,B6   FPT@TRMCTL+6,AUTO
          2 000229  EFC7 0067                            STB,B6   FPT@TRMCTL+1,AUTO

      352    21012    3               FPT@TRMCTL.V.DCB# = QI_1.MESSAGE_LINE_GZ.HEADER$ -> QI$GZ_HEADER.DCB#;

  21012   2 00022B  DC80 0000 0064  xsym                 LDB,B5   QI_1+100
          2 00022E  E845 0003                            LDR,R6   3,B5
          2 000230  E7C7 006C                            STH,R6   FPT@TRMCTL+6,AUTO

      353    21013    3               FPT@TRMCTL.TRMCTL_ = VECTOR ( VLP@TRMCTL );

  21013   2 000232  CBC7 006E                            LAB,B4   VLP@TRMCTL,AUTO
          2 000234  CFC7 00E1                            STB,B4   QI@TERMINAL_ATTRIBUTES+26,AUTO
          2 000236  6C0F                                 LDV,R6   15
          2 000237  EF47 00E0                            STR,R6   QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 000239  ABC7 00E0                            LAB,B2   QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 00023B  2C00                                 LDV,R2   0
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:53   
          2 00023C  6C06                                 LDV,R6   6
          2 00023D  BBC7 0069                            LAB,B3   FPT@TRMCTL+3,AUTO
          2 00023F  3C00                                 LDV,R3   0
          2 000240  0008                                 MMM

      354    21014
      355    21015    3               CALL M$GTRMCTL ( FPT@TRMCTL )

  21015   2 000241  BBC7 0066                            LAB,B3   FPT@TRMCTL,AUTO
          2 000243  B870 0981                            LDR,R3   2433,IMO
          2 000245  0001                                 MCL
          2 000246       0003                            DC       s:21018,PREL
          2 000247  0F81 000A                            B        s:21021,PREL

      356    21016    3               WHENALTRETURN
      357    21017    4                 DO;

      358    21018    4                   CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );

  21018   2 000249  BB80 0000 0007  03                   LAB,B3   +7
          2 00024C  CBF0 0100                            LAB,B4   256,IMO
          2 00024E  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_M$INTERNAL
          2 000251       0001                            DC       s:21021,PREL

      359    21019    4                 END;

      360    21020
      361    21021    3               FPT@TRMCTL = QI_FPT_TRMCTL;

  21021   2 000252  AB80 0000 0000  xsym                 LAB,B2   QI_FPT_TRMCTL
          2 000255  2C00                                 LDV,R2   0
          2 000256  6C10                                 LDV,R6   16
          2 000257  BBC7 0066                            LAB,B3   FPT@TRMCTL,AUTO
          2 000259  3C00                                 LDV,R3   0
          2 00025A  0008                                 MMM

      362    21022    3               VBASE ( FPT@TRMCTL.V_ ) = ADDR ( FPT@TRMCTL.V );
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:54   

  21022   2 00025B  EBC7 006C                            LAB,B6   FPT@TRMCTL+6,AUTO
          2 00025D  EFC7 0067                            STB,B6   FPT@TRMCTL+1,AUTO

      363    21023    3               FPT@TRMCTL.V.DCB# = DCBNUM ( M$ME );

  21023   2 00025F  E800 0000 000A  03                   LDR,R6   +10
          2 000262  E7C7 006C                            STH,R6   FPT@TRMCTL+6,AUTO

      364    21024    3               FPT@TRMCTL.V.VLPTYPE = %G_TRMCTL_WINDOW#;

  21024   2 000264  5C01                                 LDV,R5   1
          2 000265  DAC7 006C                            SRM,R5,'00FF'X    FPT@TRMCTL+6,AUTO
          2 000267       00FF

      365    21025    3               FPT@TRMCTL.TRMCTL_ = VECTOR ( VLP@WINDOW );

  21025   2 000268  DBC7 0076                            LAB,B5   VLP@WINDOW,AUTO
          2 00026A  DFC7 00E1                            STB,B5   QI@TERMINAL_ATTRIBUTES+26,AUTO
          2 00026C  4C1F                                 LDV,R4   31
          2 00026D  CF47 00E0                            STR,R4   QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 00026F  ABC7 00E0                            LAB,B2   QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 000271  2C00                                 LDV,R2   0
          2 000272  6C06                                 LDV,R6   6
          2 000273  BBC7 0069                            LAB,B3   FPT@TRMCTL+3,AUTO
          2 000275  3C00                                 LDV,R3   0
          2 000276  0008                                 MMM

      366    21026
      367    21027    3               CALL M$GTRMCTL ( FPT@TRMCTL )

  21027   2 000277  BBC7 0066                            LAB,B3   FPT@TRMCTL,AUTO
          2 000279  B870 0981                            LDR,R3   2433,IMO
          2 00027B  0001                                 MCL
          2 00027C       0003                            DC       s:21030,PREL
          2 00027D  0F81 000A                            B        s:21033,PREL

PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:55   
      368    21028    3               WHENALTRETURN
      369    21029    4                 DO;

      370    21030    4                   CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );

  21030   2 00027F  BB80 0000 0007  03                   LAB,B3   +7
          2 000282  CBF0 0100                            LAB,B4   256,IMO
          2 000284  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_M$INTERNAL
          2 000287       0001                            DC       s:21033,PREL

      371    21031    4                 END;

      372    21032
      373    21033    3               QI@TERMINAL_ATTRIBUTES.STATION_NAME =

  21033   2 000288  AC80 0000 0000  xsym                 LDB,B2   G$JIT$
          2 00028B  2C0C                                 LDV,R2   12
          2 00028C  6C08                                 LDV,R6   8
          2 00028D  BBC7 00C7                            LAB,B3   QI@TERMINAL_ATTRIBUTES,AUTO
          2 00028F  3C00                                 LDV,R3   0
          2 000290  0008                                 MMM

      374    21034    3                 G$JIT$ -> G$JIT.ACCN;
      375    21035
      376    21036    3               QI@TERMINAL_ATTRIBUTES.CURRENT_DEVICE_PROFILE =

  21036   2 000291  C2C7 001F                            LLH,R4   VLP@LINEATTR+4,AUTO
          2 000293  0021                                 ALR      ;
          2 000294       C007 001F                                ALPHANUM(VLP@LINEATTR+4,AUTO,1,R4),;
          2 000296       4C07 00CB                           ALPHANUM(QI@TERMINAL_ATTRIBUTES+4,AUTO,,12,FILL)

      377    21037    3                 SUBSTR ( VLP@LINEATTR.PROTXTC.TXT, 0, VLP@LINEATTR.PROTXTC.CNT );
      378    21038
      379    21039    3               CALL BINCHAR ( QI@TERMINAL_ATTRIBUTES.NUMBER_OF_LINES,

  21039   2 000298  E847 0078                            LDR,R6   VLP@WINDOW+2,AUTO
          2 00029A  70F0                                 DAR,R7   16
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:56   
          2 00029B  437F                                 CSYNC    s:21039+2,SPREL
          2 00029C  8D47 00E0                            SDI      QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 00029E  0027                                 CBD      ;
          2 00029F       0407 00E0                                BINARY(QI@TERMINAL_ATTRIBUTES+25,AUTO,,4),;
          2 0002A1       0407 00D1                       UNPACKED(QI@TERMINAL_ATTRIBUTES+10,AUTO,,4,UNSIGNED)

      380    21040    3                 VLP@WINDOW.LENGTH );
      381    21041
      382    21042    3               CALL BINCHAR ( QI@TERMINAL_ATTRIBUTES.NUMBER_OF_COLUMNS,

  21042   2 0002A3  E847 0079                            LDR,R6   VLP@WINDOW+3,AUTO
          2 0002A5  70F0                                 DAR,R7   16
          2 0002A6  437F                                 CSYNC    s:21042+2,SPREL
          2 0002A7  8D47 00E0                            SDI      QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 0002A9  0027                                 CBD      ;
          2 0002AA       0407 00E0                                BINARY(QI@TERMINAL_ATTRIBUTES+25,AUTO,,4),;
          2 0002AC       0407 00D3                       UNPACKED(QI@TERMINAL_ATTRIBUTES+12,AUTO,,4,UNSIGNED)

      383    21043    3                 VLP@WINDOW.WIDTH );
      384    21044
      385    21045    3               IF VLP@TRMATTR.INPUT

  21045   2 0002AE  82C7 0054                            LB,'00C0'X        VLP@TRMATTR+2,AUTO
  21045   2 0002B0       00C0
          2 0002B1  437F                                 CSYNC    s:21045+2,SPREL
          2 0002B2  0581 000B                            BBF      s:21051,PREL
          2 0002B4  82C7 0054                            LB,'0030'X        VLP@TRMATTR+2,AUTO
          2 0002B6       0030
          2 0002B7  0581 0006                            BBF      s:21051,PREL

      386    21046    3                 AND VLP@TRMATTR.OUTPUT
      387    21047    3               THEN
      388    21048    3                 QI@TERMINAL_ATTRIBUTES.DEVICE_I_O_CAPABILITY =

  21048   2 0002B9  5C33                                 LDV,R5   51
          2 0002BA  D7C7 00D5                            STH,R5   QI@TERMINAL_ATTRIBUTES+14,AUTO
          2 0002BC  0F81 0018                            B        s:21064,PREL
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:57   

      389    21049    3                   %QI#CAPABLE_OF_I_O;
      390    21050    3               ELSE
      391    21051    3                 IF VLP@TRMATTR.INPUT

  21051   2 0002BE  82C7 0054                            LB,'00C0'X        VLP@TRMATTR+2,AUTO
  21051   2 0002C0       00C0
          2 0002C1  0581 0006                            BBF      s:21056,PREL

      392    21052    3                 THEN
      393    21053    3                   QI@TERMINAL_ATTRIBUTES.DEVICE_I_O_CAPABILITY =

  21053   2 0002C3  5C31                                 LDV,R5   49
          2 0002C4  D7C7 00D5                            STH,R5   QI@TERMINAL_ATTRIBUTES+14,AUTO
          2 0002C6  0F81 000E                            B        s:21064,PREL

      394    21054    3                     %QI#CAPABLE_OF_INPUT;
      395    21055    3                 ELSE
      396    21056    3                   IF VLP@TRMATTR.OUTPUT

  21056   2 0002C8  82C7 0054                            LB,'0030'X        VLP@TRMATTR+2,AUTO
  21056   2 0002CA       0030
          2 0002CB  0581 0006                            BBF      s:21061,PREL

      397    21057    3                   THEN
      398    21058    3                     QI@TERMINAL_ATTRIBUTES.DEVICE_I_O_CAPABILITY =

  21058   2 0002CD  5C32                                 LDV,R5   50
          2 0002CE  D7C7 00D5                            STH,R5   QI@TERMINAL_ATTRIBUTES+14,AUTO
          2 0002D0  0F81 0004                            B        s:21064,PREL

      399    21059    3                       %QI#CAPABLE_OF_OUTPUT;
      400    21060    3                   ELSE
      401    21061    3                     QI@TERMINAL_ATTRIBUTES.DEVICE_I_O_CAPABILITY =

  21061   2 0002D2  5C30                                 LDV,R5   48
          2 0002D3  D7C7 00D5                            STH,R5   QI@TERMINAL_ATTRIBUTES+14,AUTO
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:58   

      402    21062    3                       %QI#CAPABLE_OF_NOTHIN;
      403    21063
      404    21064    3               IF VLP@LINEATTR.HARDWIRE

  21064   2 0002D5  82C7 001B                            LB,'0200'X        VLP@LINEATTR,AUTO
  21064   2 0002D7       0200
          2 0002D8  0581 0007                            BBF      s:21069,PREL

      405    21065    3               THEN
      406    21066    3                 QI@TERMINAL_ATTRIBUTES.CONNECTION_TYPE =

  21066   2 0002DA  3C31                                 LDV,R3   49
          2 0002DB  BAC7 00D5                            SRM,R3,'00FF'X    QI@TERMINAL_ATTRIBUTES+14,AUTO
          2 0002DD       00FF
          2 0002DE  0F81 0005                            B        s:21072,PREL

      407    21067    3                   %QI#DEVICE_IS_HARDWIRED;
      408    21068    3               ELSE
      409    21069    3                 QI@TERMINAL_ATTRIBUTES.CONNECTION_TYPE =

  21069   2 0002E0  3C32                                 LDV,R3   50
          2 0002E1  BAC7 00D5                            SRM,R3,'00FF'X    QI@TERMINAL_ATTRIBUTES+14,AUTO
          2 0002E3       00FF

      410    21070    3                   %QI#DEVICE_IS_DIALED_UP;
      411    21071
      412    21072    3               QI@TERMINAL_ATTRIBUTES.CP_6_NODE =

  21072   2 0002E4  AB87                                 LAB,B2   ,AUTO
          2 0002E5  2C4A                                 LDV,R2   74
          2 0002E6  6C04                                 LDV,R6   4
          2 0002E7  BBC7 00D6                            LAB,B3   QI@TERMINAL_ATTRIBUTES+15,AUTO
          2 0002E9  3C00                                 LDV,R3   0
          2 0002EA  0008                                 MMM

      413    21073    3                 VLP@LINEATTR.NODE;
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:59   
      414    21074
      415    21075    3               QI@TERMINAL_ATTRIBUTES.CP_6_PORT =

  21075   2 0002EB  AB87                                 LAB,B2   ,AUTO
          2 0002EC  2C4E                                 LDV,R2   78
          2 0002ED  6C04                                 LDV,R6   4
          2 0002EE  BBC7 00D8                            LAB,B3   QI@TERMINAL_ATTRIBUTES+17,AUTO
          2 0002F0  3C00                                 LDV,R3   0
          2 0002F1  0008                                 MMM

      416    21076    3                 VLP@LINEATTR.PORT;
      417    21077
      418    21078    3               IF G$JIT$ -> G$JIT.DB# ~= 0

  21078   2 0002F2  EC80 0000 0000  xsym                 LDB,B6   G$JIT$
          2 0002F5  E2C6 008D                            LLH,R6   141,B6
          2 0002F7  6901 0006                            BEZ,R6   s:21083,PREL

      419    21079    3               THEN
      420    21080    3                 QI@TERMINAL_ATTRIBUTES.PROGRAM_EXECUTION =

  21080   2 0002F9  5C31                                 LDV,R5   49
          2 0002FA  D7C7 00DA                            STH,R5   QI@TERMINAL_ATTRIBUTES+19,AUTO
          2 0002FC  0F81 0004                            B        s:21086,PREL

      421    21081    3                   %QI#DEBUGGER_IS_ASSOCIATED;
      422    21082    3               ELSE
      423    21083    3                 QI@TERMINAL_ATTRIBUTES.PROGRAM_EXECUTION =

  21083   2 0002FE  5C30                                 LDV,R5   48
          2 0002FF  D7C7 00DA                            STH,R5   QI@TERMINAL_ATTRIBUTES+19,AUTO

      424    21084    3                   %QI#DEBUGGER_IS_NOT_ASSOCIATED;
      425    21085
      426    21086    3               IF VLP@TRMCTL.RETYPOVR

  21086   2 000301  82C7 006F                            LB,'000C'X        VLP@TRMCTL+1,AUTO
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:60   
  21086   2 000303       000C
          2 000304  0581 0007                            BBF      s:21091,PREL

      427    21087    3               THEN
      428    21088    3                 QI@TERMINAL_ATTRIBUTES.DEVICE_TYPE =

  21088   2 000306  4C30                                 LDV,R4   48
          2 000307  CAC7 00DA                            SRM,R4,'00FF'X    QI@TERMINAL_ATTRIBUTES+19,AUTO
          2 000309       00FF
          2 00030A  0F81 0005                            B        s:21094,PREL

      429    21089    3                   %QI#DEVICE_IS_NOT_HARDCOPY;
      430    21090    3               ELSE
      431    21091    3                 QI@TERMINAL_ATTRIBUTES.DEVICE_TYPE =

  21091   2 00030C  4C31                                 LDV,R4   49
          2 00030D  CAC7 00DA                            SRM,R4,'00FF'X    QI@TERMINAL_ATTRIBUTES+19,AUTO
          2 00030F       00FF

      432    21092    3                   %QI#DEVICE_IS_HARDCOPY;
      433    21093
      434    21094    3               QI@TERMINAL_ATTRIBUTES.CP_6_CONTROLLER =

  21094   2 000310  AB87                                 LAB,B2   ,AUTO
          2 000311  2C52                                 LDV,R2   82
          2 000312  6C04                                 LDV,R6   4
          2 000313  BBC7 00DB                            LAB,B3   QI@TERMINAL_ATTRIBUTES+20,AUTO
          2 000315  3C00                                 LDV,R3   0
          2 000316  0008                                 MMM

      435    21095    3                 VLP@LINEATTR.CONTROLLER;
      436    21096
      437    21097    3               QI@TERMINAL_ATTRIBUTES.CP_6_DEVICE =

  21097   2 000317  AB87                                 LAB,B2   ,AUTO
          2 000318  2C56                                 LDV,R2   86
          2 000319  6C04                                 LDV,R6   4
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:61   
          2 00031A  BBC7 00DD                            LAB,B3   QI@TERMINAL_ATTRIBUTES+22,AUTO
          2 00031C  3C00                                 LDV,R3   0
          2 00031D  0008                                 MMM

      438    21098    3                 VLP@LINEATTR.DEVICE;
      439    21099
      440    21100    3               ADDR ( QI_1.OP.DATA.T$ -> QI$UBYTE_A ( QI_1.OFFSET.T ) ) ->

  21100   2 00031E  ABC7 00C7                            LAB,B2   QI@TERMINAL_ATTRIBUTES,AUTO
          2 000320  2C00                                 LDV,R2   0
          2 000321  6C30                                 LDV,R6   48
          2 000322  BC80 0000 0022  xsym                 LDB,B3   QI_1+34
          2 000325  B800 0000 0042  xsym                 LDR,R3   QI_1+66
          2 000328  F800 0000 0027  xsym                 LDR,R7   QI_1+39
          2 00032B  D380 0000 0000  xent                 LNJ,B5   X6C_ALR

      441    21101    3                 QI$VARIABLE_STRING_TARGET.TEXT =
      442    21102    3                 QI@TERMINAL_ATTRIBUTES_TEXT;
      443    21103
      444    21104    3               RETURN;

  21104   2 00032E  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      445    21105
      446    21106    3             CASE ( %QI#ACCEPT_LOADER );

      447    21107    3               FPT@GDS = QI_FPT_GDS_LOAD;

  21107   2 000331  AB80 0000 0000  xsym                 LAB,B2   QI_FPT_GDS_LOAD
          2 000334  2C00                                 LDV,R2   0
          2 000335  6C10                                 LDV,R6   16
          2 000336  BB87                                 LAB,B3   ,AUTO
          2 000337  3C18                                 LDV,R3   24
          2 000338  0008                                 MMM

      448    21108    3               VBASE ( FPT@GDS.V_ ) = ADDR ( FPT@GDS.V );

PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:62   
  21108   2 000339  EBC7 0012                            LAB,B6   FPT@GDS+6,AUTO
          2 00033B  EFC7 000D                            STB,B6   FPT@GDS+1,AUTO

      449    21109                    /*  ZERO pages means "status request".  */
      450    21110    3               FPT@GDS.V.PAGES = 0;

  21110   2 00033D  8747 0012                            CL       FPT@GDS+6,AUTO

      451    21111    3               QI_VLP_SEGMENT_LOAD.BASE = %GM_USRDS4_BASE;

  21111   2 00033F  8CF0 000C 0000                       LDI      786432,IMO
          2 000342  8D00 0000 0000  xsym                 SDI      QI_VLP_SEGMENT_LOAD

      452    21112
      453    21113    3               CALL M$GDS ( FPT@GDS )

  21113   2 000345  BBC7 000C                            LAB,B3   FPT@GDS,AUTO
          2 000347  B870 0902                            LDR,R3   2306,IMO
          2 000349  0001                                 MCL
          2 00034A       0003                            DC       s:21116,PREL
          2 00034B  0F81 000A                            B        s:21119,PREL

      454    21114    3               WHENALTRETURN
      455    21115    4                 DO;

      456    21116    4                   CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );

  21116   2 00034D  BB80 0000 0007  03                   LAB,B3   +7
          2 000350  CBF0 0100                            LAB,B4   256,IMO
          2 000352  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_M$INTERNAL
          2 000355       0001                            DC       s:21119,PREL

      457    21117    4                 END;

      458    21118
      459    21119    3               IF QI_VLP_SEGMENT_LOAD.PAGES = 0

PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:63   
  21119   2 000356  E800 0000 0002  xsym                 LDR,R6   QI_VLP_SEGMENT_LOAD+2
          2 000359  6981 0018                            BNEZ,R6  s:21132,PREL

      460    21120    3               THEN
      461    21121    3   NO_LOADER_INFORMATION:
      462    21122    4                 DO;

  21122   2                              NO_LOADER_INFOR*null
      463    21123    4                   IF QI_1.INSTR$ -> QI$OP_SEQUENCE.CODE = %QI#OP_JAZ

  21123   2 00035B  EC80 0000 0006  xsym NO_LOADER_INFOR*LDB,B6   QI_1+6
          2 00035E  D806                                 LDR,R5   ,B6
          2 00035F  5D5B                                 CMV,R5   91
          2 000360  0981 0008                            BNE      s:21129,PREL

      464    21124    4                   THEN
      465    21125    5                     DO;

      466    21126    5                       QI_1.A_REG = 1;

  21126   2 000362  4C01                                 LDV,R4   1
          2 000363  CF00 0000 0054  xsym                 STR,R4   QI_1+84

      467    21127    5                       RETURN;

  21127   2 000366  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      468    21128    5                     END;
      469    21129    4                   CALL QCE$ERROR ( %E$NO_LOADER_INFORMATION );

  21129   2 000369  BB80 0000 000C  03                   LAB,B3   +12
          2 00036C  CBF0 0100                            LAB,B4   256,IMO
          2 00036E  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR
          2 000371       0001                            DC       s:21132,PREL

      470    21130    4                 END NO_LOADER_INFORMATION;

PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:64   
      471    21131
      472    21132    3               QI_1.A_REG = 0;

  21132   2 000372  8700 0000 0054  xsym                 CL       QI_1+84

      473    21133
      474    21134    3               QI_1.OP.DATA.S$ = QI_VLP_SEGMENT_LOAD.BASE$;

  21134   2 000375  EC80 0000 0000  xsym                 LDB,B6   QI_VLP_SEGMENT_LOAD
          2 000378  EF80 0000 0020  xsym                 STB,B6   QI_1+32

      475    21135    3               QI_1.OP.LEN.S = QI_1.OP.DATA.S$ -> QI$UWORD_A (0);

  21135   2 00037B  E806                                 LDR,R6   ,B6
          2 00037C  EF00 0000 0026  xsym                 STR,R6   QI_1+38

      476    21136
      477    21137    3               QI_1.OP.DATA.S$ = ADDR ( QI_1.OP.DATA.S$ -> QI$UWORD_A (1) );

  21137   2 00037F  DBC6 0001                            LAB,B5   1,B6
          2 000381  DF80 0000 0020  xsym                 STB,B5   QI_1+32

      478    21138    3               QI_1.OP.DATA.T$ -> QI$VARIABLE_STRING_TARGET.TEXT =

  21138   2 000384  AB85                                 LAB,B2   ,B5
          2 000385  2C00                                 LDV,R2   0
          2 000386  BC80 0000 0022  xsym                 LDB,B3   QI_1+34
          2 000389  3C00                                 LDV,R3   0
          2 00038A  F800 0000 0027  xsym                 LDR,R7   QI_1+39
          2 00038D  D380 0000 0000  xent                 LNJ,B5   X6C_ALR

      479    21139    3                 QI_1.OP.DATA.S$ -> QI$VARIABLE_STRING_SOURCE.TEXT;
      480    21140
      481    21141    3               FPT@FDS = QI_FPT_FDS_LOAD;

  21141   2 000390  AB80 0000 0000  xsym                 LAB,B2   QI_FPT_FDS_LOAD
          2 000393  2C00                                 LDV,R2   0
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:65   
          2 000394  6C10                                 LDV,R6   16
          2 000395  BB87                                 LAB,B3   ,AUTO
          2 000396  3C08                                 LDV,R3   8
          2 000397  0008                                 MMM

      482    21142    3               VBASE ( FPT@FDS.V_ ) = ADDR ( FPT@FDS.V );

  21142   2 000398  EBC7 000A                            LAB,B6   FPT@FDS+6,AUTO
          2 00039A  EFC7 0005                            STB,B6   FPT@FDS+1,AUTO

      483    21143
      484    21144    3               FPT@FDS.V.PAGES = QI_VLP_SEGMENT_LOAD.PAGES;

  21144   2 00039C  E800 0000 0002  xsym                 LDR,R6   QI_VLP_SEGMENT_LOAD+2
          2 00039F  EF47 000A                            STR,R6   FPT@FDS+6,AUTO

      485    21145
      486    21146    3               CALL M$FDS ( FPT@FDS )

  21146   2 0003A1  BBC7 0004                            LAB,B3   FPT@FDS,AUTO
          2 0003A3  B870 0903                            LDR,R3   2307,IMO
          2 0003A5  0001                                 MCL
          2 0003A6       0003                            DC       s:21149,PREL
          2 0003A7  0F81 000A                            B        s:21152,PREL

      487    21147    3               WHENALTRETURN
      488    21148    4                 DO;

      489    21149    4                   CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );

  21149   2 0003A9  BB80 0000 0007  03                   LAB,B3   +7
          2 0003AC  CBF0 0100                            LAB,B4   256,IMO
          2 0003AE  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_M$INTERNAL
          2 0003B1       0001                            DC       s:21152,PREL

      490    21150    4                 END;

PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:66   
      491    21151
      492    21152    3               RETURN;

  21152   2 0003B2  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      493    21153
      494    21154    3             CASE ( ELSE );

      495    21155    3               FPT@TIME = QI_FPT_TIME;

  21155   2 0003B5  AB80 0000 0000  xsym                 LAB,B2   QI_FPT_TIME
          2 0003B8  2C00                                 LDV,R2   0
          2 0003B9  6C20                                 LDV,R6   32
          2 0003BA  BB87                                 LAB,B3   ,AUTO
          2 0003BB  3C76                                 LDV,R3   118
          2 0003BC  0008                                 MMM

      496    21156    3               VBASE ( FPT@TIME.V_ ) = ADDR ( FPT@TIME.V );

  21156   2 0003BD  EBC7 004A                            LAB,B6   FPT@TIME+15,AUTO
          2 0003BF  EFC7 003C                            STB,B6   FPT@TIME+1,AUTO

      497    21157
      498    21158    4               DO CASE ( INSTR$ -> QI$OP_ACCEPT.TYPE );

  21158   2 0003C1  DCC7 0095                            LDB,B5   INSTR$,AUTO
          2 0003C3  B845 0001                            LDR,R3   1,B5
          2 0003C5  304D                                 SOR,R3   13
          2 0003C6  3D05                                 CMV,R3   5
          2 0003C7  0281 0063                            BGE      s:21181,PREL
          2 0003C9  A830 0000 03CF  02                   LDR,R2   s:21158+14,R3
          2 0003CC  83A0 0000 03D4  02                   JMP      s:21160,R2
          2 0003CF       0057                            DC       s:21181,PREL
          2 0003D0       0000                            DC       s:21160,PREL
          2 0003D1       0014                            DC       s:21165,PREL
          2 0003D2       0029                            DC       s:21170,PREL
          2 0003D3       003E                            DC       s:21175,PREL
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:67   

      499    21159    4                 CASE ( %QI#ACCEPT_DATE );

      500    21160    4                   FPT@TIME.DATE_ = VECTOR ( TIME_TYPE_STUFF_BUF );

  21160   2 0003D4  CBC7 009C                            LAB,B4   TIME_TYPE_STUFF_BUF,AUTO
          2 0003D6  CFC7 00E1                            STB,B4   QI@TERMINAL_ATTRIBUTES+26,AUTO
          2 0003D8  6C07                                 LDV,R6   7
          2 0003D9  EF47 00E0                            STR,R6   QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 0003DB  ABC7 00E0                            LAB,B2   QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 0003DD  2C00                                 LDV,R2   0
          2 0003DE  6C06                                 LDV,R6   6
          2 0003DF  BB87                                 LAB,B3   ,AUTO
          2 0003E0  3C7C                                 LDV,R3   124
          2 0003E1  0008                                 MMM

      501    21161
      502    21162    4                   QI_1.OP.LEN.S = 6;

  21162   2 0003E2  6C06                                 LDV,R6   6
          2 0003E3  EF00 0000 0026  xsym                 STR,R6   QI_1+38
          2 0003E6  0F81 004D                            B        s:21185,PREL

      503    21163
      504    21164    4                 CASE ( %QI#ACCEPT_DAY );

      505    21165    4                   FPT@TIME.DAY_ = VECTOR ( TIME_TYPE_STUFF_BUF );

  21165   2 0003E8  CBC7 009C                            LAB,B4   TIME_TYPE_STUFF_BUF,AUTO
          2 0003EA  CFC7 00E1                            STB,B4   QI@TERMINAL_ATTRIBUTES+26,AUTO
          2 0003EC  6C07                                 LDV,R6   7
          2 0003ED  EF47 00E0                            STR,R6   QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 0003EF  ABC7 00E0                            LAB,B2   QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 0003F1  2C00                                 LDV,R2   0
          2 0003F2  6C06                                 LDV,R6   6
          2 0003F3  BBC7 0044                            LAB,B3   FPT@TIME+9,AUTO
          2 0003F5  3C00                                 LDV,R3   0
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:68   
          2 0003F6  0008                                 MMM

      506    21166
      507    21167    4                   QI_1.OP.LEN.S = 5;

  21167   2 0003F7  6C05                                 LDV,R6   5
          2 0003F8  EF00 0000 0026  xsym                 STR,R6   QI_1+38
          2 0003FB  0F81 0038                            B        s:21185,PREL

      508    21168
      509    21169    4                 CASE ( %QI#ACCEPT_TIME );

      510    21170    4                   FPT@TIME.TIME_ = VECTOR ( TIME_TYPE_STUFF_BUF );

  21170   2 0003FD  CBC7 009C                            LAB,B4   TIME_TYPE_STUFF_BUF,AUTO
          2 0003FF  CFC7 00E1                            STB,B4   QI@TERMINAL_ATTRIBUTES+26,AUTO
          2 000401  6C07                                 LDV,R6   7
          2 000402  EF47 00E0                            STR,R6   QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 000404  ABC7 00E0                            LAB,B2   QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 000406  2C00                                 LDV,R2   0
          2 000407  6C06                                 LDV,R6   6
          2 000408  BBC7 0041                            LAB,B3   FPT@TIME+6,AUTO
          2 00040A  3C00                                 LDV,R3   0
          2 00040B  0008                                 MMM

      511    21171
      512    21172    4                   QI_1.OP.LEN.S = 8;

  21172   2 00040C  6C08                                 LDV,R6   8
          2 00040D  EF00 0000 0026  xsym                 STR,R6   QI_1+38
          2 000410  0F81 0023                            B        s:21185,PREL

      513    21173
      514    21174    4                 CASE ( %QI#ACCEPT_DAY_OF_WEEK );

      515    21175    4                   FPT@TIME.V.DEST = 3 /* %LOCAL# */;

PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:69   
  21175   2 000412  6C03                                 LDV,R6   3
          2 000413  EAC7 004A                            SRM,R6,'00FF'X    FPT@TIME+15,AUTO
          2 000415       00FF

      516    21176    4                   FPT@TIME.DAY_ = VECTOR ( TIME_TYPE_STUFF_BUF );

  21176   2 000416  CBC7 009C                            LAB,B4   TIME_TYPE_STUFF_BUF,AUTO
          2 000418  CFC7 00E1                            STB,B4   QI@TERMINAL_ATTRIBUTES+26,AUTO
          2 00041A  5C07                                 LDV,R5   7
          2 00041B  DF47 00E0                            STR,R5   QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 00041D  ABC7 00E0                            LAB,B2   QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 00041F  2C00                                 LDV,R2   0
          2 000420  6C06                                 LDV,R6   6
          2 000421  BBC7 0044                            LAB,B3   FPT@TIME+9,AUTO
          2 000423  3C00                                 LDV,R3   0
          2 000424  0008                                 MMM

      517    21177
      518    21178    4                   QI_1.OP.LEN.S = 3;

  21178   2 000425  6C03                                 LDV,R6   3
          2 000426  EF00 0000 0026  xsym                 STR,R6   QI_1+38
          2 000429  0F81 000A                            B        s:21185,PREL

      519    21179
      520    21180    4                 CASE ( ELSE );

      521    21181    4                   CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );

  21181   2 00042B  BB80 0000 0001  03                   LAB,B3   +1
          2 00042E  CBF0 0100                            LAB,B4   256,IMO
          2 000430  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          2 000433       0001                            DC       s:21185,PREL

      522    21182
      523    21183    4               END;

PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:70   
      524    21184
      525    21185    3               CALL M$TIME ( FPT@TIME )

  21185   2 000434  BBC7 003B                            LAB,B3   FPT@TIME,AUTO
          2 000436  B870 14D4                            LDR,R3   5332,IMO
          2 000438  0001                                 MCL
          2 000439       0003                            DC       s:21188,PREL
          2 00043A  0F81 000A                            B        s:21193,PREL

      526    21186    3               WHENALTRETURN
      527    21187    4                 DO;

      528    21188    4                   CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );

  21188   2 00043C  BB80 0000 0007  03                   LAB,B3   +7
          2 00043F  CBF0 0100                            LAB,B4   256,IMO
          2 000441  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_M$INTERNAL
          2 000444       0001                            DC       s:21193,PREL

      529    21189    4                 END;

      530    21190
      531    21191                    /*  Y.O.Y.O.Y. did somebody decide to use
      532    21192                        "1" through "7" as the days?  */
      533    21193    3               IF INSTR$ -> QI$OP_ACCEPT.TYPE = %QI#ACCEPT_DAY_OF_WEEK

  21193   2 000445  ECC7 0095                            LDB,B6   INSTR$,AUTO
          2 000447  E846 0001                            LDR,R6   1,B6
          2 000449  604D                                 SOR,R6   13
          2 00044A  6D04                                 CMV,R6   4
          2 00044B  0981 002C                            BNE      s:21211,PREL

      534    21194    3               THEN
      535    21195    3   CONVERT_MON_TO_1_ETC:
      536    21196    4                 DO;

  21196   2                              CONVERT_MON_TO_*null
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:71   
      537    21197    5                   DO WEEKDAY_INDEX = 0 TO 6;

  21197   2 00044D  8747 00A4            CONVERT_MON_TO_*CL       WEEKDAY_INDEX,AUTO

      538    21198    5                     IF SUBSTR ( TIME_TYPE_STUFF_BUF, 0, 3 ) =

  21198   2 00044F  EB80 0000 0000  01                   LAB,B6   WEEKDAY_MON_ETC_TABLE
          2 000452  B847 00A4                            LDR,R3   WEEKDAY_INDEX,AUTO
          2 000454  3F03                                 MLV,R3   3
          2 000455  0022                                 ACM      ;
          2 000456       4307 009C                               ALPHANUM(TIME_TYPE_STUFF_BUF,AUTO,,3,FILL),;
          2 000458       4336 0000                                ALPHANUM(0,B6,R3,,3,FILL)
          2 00045A  5301 000E                            CBNE     s:21207,PREL

      539    21199    5                       WEEKDAY_MON_ETC_TABLE ( WEEKDAY_INDEX )
      540    21200    5                     THEN
      541    21201    6                       DO;

      542    21202    6                         SUBSTR ( TIME_TYPE_STUFF_BUF, 0, 1 ) =

  21202   2 00045C  A847 00A4                            LDR,R2   WEEKDAY_INDEX,AUTO
          2 00045E  E0A0 0000 000B  01                   LDH,R6   WEEKDAY_1_ETC_TABLE,R2
          2 000461  E7C7 009C                            STH,R6   TIME_TYPE_STUFF_BUF,AUTO

      543    21203    6                           WEEKDAY_1_ETC_TABLE ( WEEKDAY_INDEX );
      544    21204    6                         QI_1.OP.LEN.S = 1;

  21204   2 000463  5C01                                 LDV,R5   1
          2 000464  DF00 0000 0026  xsym                 STR,R5   QI_1+38

      545    21205    6                         EXIT CONVERT_MON_TO_1_ETC;

  21205   2 000467  0F81 0010                            B        s:21211,PREL

      546    21206    6                       END;
      547    21207    5                   END;

PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:72   
  21207   2 000469  8AC7 00A4                            INC      WEEKDAY_INDEX,AUTO
          2 00046B  E847 00A4                            LDR,R6   WEEKDAY_INDEX,AUTO
          2 00046D  6D06                                 CMV,R6   6
          2 00046E  03E1                                 BLE      s:21198,SPREL

      548    21208    4                   CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );

  21208   2 00046F  BB80 0000 0004  03                   LAB,B3   +4
          2 000472  CBF0 0100                            LAB,B4   256,IMO
          2 000474  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          2 000477       0001                            DC       s:21211,PREL

      549    21209    4                 END CONVERT_MON_TO_1_ETC;

      550    21210
      551    21211    3               QI_1.OP.DATA.S$ = ADDR ( TIME_TYPE_STUFF_BUF );

  21211   2 000478  EBC7 009C                            LAB,B6   TIME_TYPE_STUFF_BUF,AUTO
          2 00047A  EF80 0000 0020  xsym                 STB,B6   QI_1+32

      552    21212
      553    21213    3               IF QI_1.TYPE.T = %QI#TYPE_ALPHANUMERIC

  21213   2 00047D  E800 0000 0051  xsym                 LDR,R6   QI_1+81
          2 000480  6D03                                 CMV,R6   3
          2 000481  0981 002C                            BNE      s:21225,PREL

      554    21214    3               THEN
      555    21215    4                 DO;

      556    21216    4                   VARIABLE_SOURCE$ = QI_1.OP.DATA.S$;

  21216   2 000483  EFC7 00A0                            STB,B6   VARIABLE_SOURCE$,AUTO

      557    21217    4                   VARIABLE_TARGET$ = PINCRC ( QI_1.OP.DATA.T$,

  21217   2 000485  8C80 0000 0022  xsym                 LDI      QI_1+34
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:73   
          2 000488  7031                                 DCL,R7   1
          2 000489  8D47 00E0                            SDI      QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 00048B  F800 0000 0042  xsym                 LDR,R7   QI_1+66
          2 00048E  6C00                                 LDV,R6   0
          2 00048F  8447 00E0                            AID      QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 000491  7071                                 DCR,R7   1
          2 000492  8D47 00A2                            SDI      VARIABLE_TARGET$,AUTO

      558    21218    4                     QI_1.OFFSET.T );
      559    21219
      560    21220    4                   VARIABLE_TARGET$ -> QI$VARIABLE_STRING_TARGET.TEXT =

  21220   2 000494  B856                                 LDR,R3   R6
          2 000495  E570 7FFF                            AND,R6   32767,IMO
          2 000497  8D47 00E0                            SDI      QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 000499  DCC7 00E0                            LDB,B5   QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 00049B  304F                                 SOR,R3   15
          2 00049C  BF47 00E2                            STR,R3   QI@TERMINAL_ATTRIBUTES+27,AUTO
          2 00049E  DFC7 00E3                            STB,B5   QI@TERMINAL_ATTRIBUTES+28,AUTO
          2 0004A0  AB86                                 LAB,B2   ,B6
          2 0004A1  2C00                                 LDV,R2   0
          2 0004A2  E800 0000 0026  xsym                 LDR,R6   QI_1+38
          2 0004A5  BB85                                 LAB,B3   ,B5
          2 0004A6  F800 0000 0027  xsym                 LDR,R7   QI_1+39
          2 0004A9  D380 0000 0000  xent                 LNJ,B5   X6C_ALR

      561    21221    4                     VARIABLE_SOURCE$ -> QI$VARIABLE_STRING_SOURCE.TEXT;
      562    21222    4                 END;

  21222   2 0004AC  0F81 0040                            B        s:21254,PREL

      563    21223    3               ELSE
      564    21224    4                 DO;

      565    21225    4                   QI_1.OP.CIP.S_A (0) = %QI#CIP_DEFAULT_AS;

  21225   2 0004AE  5C0B                                 LDV,R5   11
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:74   
          2 0004AF  DF00 0000 001A  xsym                 STR,R5   QI_1+26

      566    21226    4                   QI_1.OP.CIP.S.LEN = QI_1.OP.LEN.S;

  21226   2 0004B2  C800 0000 0026  xsym                 LDR,R4   QI_1+38
          2 0004B5  4008                                 SOL,R4   8
          2 0004B6  CA80 0000 001A  xsym                 SRM,R4,'1F00'X    QI_1+26
          2 0004B9       1F00

      567    21227    4                   QI_1.OP.DEC.S = 0;

  21227   2 0004BA  8700 0000 0029  xsym                 CL       QI_1+41

      568    21228
      569    21229    4                   QI_1.OP.SIZE_ERROR = %QI#DONT_CHECK_FOR_SIZE_ERROR;

  21229   2 0004BD  8700 0000 0030  xsym                 CL       QI_1+48

      570    21230
      571    21231    4                   IF QI_1.TYPE.T = %QI#TYPE_BINARY

  21231   2 0004C0  6D02                                 CMV,R6   2
          2 0004C1  0981 0017                            BNE      s:21242,PREL

      572    21232    4                   THEN
      573    21233    5                     DO;

      574    21234    5                       CALL QCC$CDB ( QI_1.OP )

  21234   2 0004C3  BB80 0000 000E  03                   LAB,B3   +14
          2 0004C6  CBF0 0100                            LAB,B4   256,IMO
          2 0004C8  E380 0000 0000  xent                 LNJ,B6   QCC$CDB
          2 0004CB       0003                            DC       s:21237,PREL
          2 0004CC  0F81 000A                            B        s:21239,PREL

      575    21235    5                       WHENALTRETURN
      576    21236    6                         DO;
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:75   

      577    21237    6                           CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );

  21237   2 0004CE  BB80 0000 0004  03                   LAB,B3   +4
          2 0004D1  CBF0 0100                            LAB,B4   256,IMO
          2 0004D3  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          2 0004D6       0001                            DC       s:21239,PREL

      578    21238    6                         END;

      579    21239    5                     END;

  21239   2 0004D7  0F81 0015                            B        s:21254,PREL

      580    21240    4                   ELSE
      581    21241    5                     DO;

      582    21242    5                       CALL QCC$DMC ( QI_1.OP )

  21242   2 0004D9  BB80 0000 000E  03                   LAB,B3   +14
          2 0004DC  CBF0 0100                            LAB,B4   256,IMO
          2 0004DE  E380 0000 0000  xent                 LNJ,B6   QCC$DMC
          2 0004E1       0003                            DC       s:21245,PREL
          2 0004E2  0F81 000A                            B        s:21254,PREL

      583    21243    5                       WHENALTRETURN
      584    21244    6                         DO;

      585    21245    6                           CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );

  21245   2 0004E4  BB80 0000 0004  03                   LAB,B3   +4
          2 0004E7  CBF0 0100                            LAB,B4   256,IMO
          2 0004E9  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          2 0004EC       0001                            DC       s:21254,PREL

      586    21246    6                         END;

PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:76   
      587    21247    5                     END;

      588    21248    4                 END;

      589    21249
      590    21250    3           END;

      591    21251
      592    21252    2         END ACCEPT_DATANAME_FROM_WHATEVER;

      593    21253
      594    21254    1       RETURN;

  21254   2 0004ED  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      595    21255
      596    21256        %EJECT;
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:77   
      597    21257    1   CHECK_USE_PROCEDURE_OR_INVALID:
      598    21258    1       QCU@USE.USE_DEFAULT_IO = %QI#USE_DEFAULT_NONE;

  21258   2 0004F0  8747 00BD            CHECK_USE_PROCE*CL       QCU@USE+4,AUTO

      599    21259    1       QCU@USE.IS_TIME_TO_SAVE_AWAY_FIELDS = %NO;

  21259   2 0004F2  8747 00BE                            CL       QCU@USE+5,AUTO

      600    21260    1       QCU@USE.CURR_FRAME$ = QI_1.CURRENT.FRAME$;

  21260   2 0004F4  DC80 0000 007A  xsym                 LDB,B5   QI_1+122
          2 0004F7  DFC7 00B9                            STB,B5   QCU@USE,AUTO

      601    21261
      602    21262    1       IF QI_1.CURRENT.NODE$ -> QI$DAD.WORD0_FLAGS.TYPE < %QI#TYPE_MINOR

  21262   2 0004F9  CC80 0000 0080  xsym                 LDB,B4   QI_1+128
          2 0004FC  D804                                 LDR,R5   ,B4
          2 0004FD  D570 000F                            AND,R5   15,IMO
          2 0004FF  5D08                                 CMV,R5   8
          2 000500  0281 0005                            BGE      s:21266,PREL

      603    21263    1       THEN
      604    21264    1         QCU@USE.CURR_NODE$ = QI_1.CURRENT.NODE$;

  21264   2 000502  CFC7 00BB                            STB,B4   QCU@USE+2,AUTO
          2 000504  0F81 0006                            B        s:21268,PREL

      605    21265    1       ELSE
      606    21266    1         QCU@USE.CURR_NODE$ = ADDR (NIL);

  21266   2 000506  BB80 0000 0000                       LAB,B3   0
          2 000509  BFC7 00BB                            STB,B3   QCU@USE+2,AUTO

      607    21267
      608    21268    1       CALL QCU$USE_INVALID_IO ( QCU@USE );
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:78   

  21268   2 00050B  BBC7 00B9                            LAB,B3   QCU@USE,AUTO
          2 00050D  BFC7 00E0                            STB,B3   QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 00050F  BBC7 00E0                            LAB,B3   QI@TERMINAL_ATTRIBUTES+25,AUTO
          2 000511  CBF0 0100                            LAB,B4   256,IMO
          2 000513  E380 0000 0000  xent                 LNJ,B6   QCU$USE_INVALID_IO
          2 000516       0001                            DC       s:21270,PREL

      609    21269
      610    21270    2       DO CASE ( QCU@USE.STATUS );

  21270   2 000517  B847 00C6                            LDR,R3   QCU@USE+13,AUTO
          2 000519  3D03                                 CMV,R3   3
          2 00051A  0281 0016                            BGE      s:21283,PREL
          2 00051C  A830 0000 0522  02                   LDR,R2   s:21270+11,R3
          2 00051F  83A0 0000 0525  02                   JMP      s:21273,R2
          2 000522       0000                            DC       s:21273,PREL
          2 000523       0003                            DC       s:21276,PREL
          2 000524       0005                            DC       s:21279,PREL

      611    21271
      612    21272    2         CASE ( %QI#USE_INVALID_RETURN );

      613    21273    2           RETURN;

  21273   2 000525  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      614    21274
      615    21275    2         CASE ( %QI#USE_INVALID_RETRY );

      616    21276    2           GOTO RETRY_FIELD_ACCEPT;

  21276   2 000528  0F81 FB49                            B        s:20766,PREL

      617    21277
      618    21278    2         CASE ( %QI#USE_INVALID_SKIP_TO_NEXT );

PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:79   
      619    21279    2           LAST_FILE$ = ADDR (NIL);

  21279   2 00052A  EB80 0000 0000                       LAB,B6   0
          2 00052D  EFC7 0097                            STB,B6   LAST_FILE$,AUTO

      620    21280    2           GOTO NEXT_FIELD_PLEASE;

  21280   2 00052F  0F81 FC5A                            B        s:20965,PREL

      621    21281
      622    21282    2         CASE ( ELSE );

      623    21283    2           CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );

  21283   2 000531  BB80 0000 0004  03                   LAB,B3   +4
          2 000534  CBF0 0100                            LAB,B4   256,IMO
          2 000536  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          2 000539       0001                            DC       s:21287,PREL

      624    21284
      625    21285    2       END;

      626    21286
      627    21287    1   END QBA$ACCEPT;

  21287   2 00053A  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:80   
--  Include file information  --

   QCU_USE_M.:E05TOU  is referenced.
   QCR_READ_M.:E05TOU  is referenced.
   QCM_MESS_M.:E05TOU  is referenced.
   QI_MACROS_M.:E05TOU  is referenced.
   QI_PERR_C.:E05TOU  is referenced.
   QI_EQUATES_E.:E05TOU  is referenced.
   QG_MACRO_M.:E05TOU  is referenced.
   G_JIT_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   GM_VIRTUAL_E.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QBA$ACCEPT.
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:81   

 **** Variables and constants ****

  ****  Section 001 RoData QBA$ACCEPT

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     B-0-0/c CHAR        r     1 WEEKDAY_1_ETC_TABLE(0:6)
     0-0-0/c CHAR(3)     r     1 WEEKDAY_MON_ETC_TABLE(0:6)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

    86-0-0/w PTR         r     1 ERROR_STATUS$             88-0-0/w UBIN(16)    r     1 FIELD_COUNT
    89-0-0/w PTR         r     1 FIELD_DAD$                8B-0-0/w PTR         r     1 FIELD_DAD_P$
    8D-0-0/w UBIN(16)    r     1 FIELD_INDEX                4-0-0/w STRC(128)   r     1 FPT@FDS
     C-0-0/w STRC(128)   r     1 FPT@GDS                   14-0-0/w STRC(112)   r     1 FPT@GLINEATTR
    3B-0-0/w STRC(256)   r     1 FPT@TIME                  4B-0-0/w STRC(112)   r     1 FPT@TRMATTR
    66-0-0/w STRC(128)   r     1 FPT@TRMCTL                95-0-0/w PTR         r     1 INSTR$
    97-0-0/w PTR         r     1 LAST_FILE$                99-0-0/w SBIN(16)    r     1 PROMPT_INDEX
    9A-0-0/w UBIN(16)    r     1 P_ITEM_INDEX              A5-0-0/w STRC(176)   r     1 QCM@MESS
    B0-0-0/w STRC(144)   r     1 QCR@READ                  B9-0-0/w STRC(224)   r     1 QCU@USE
    C7-0-0/c STRC(384)   r     1 QI@TERMINAL_ATTRIBUTES
    C7-0-0/c CHAR(48)    r     1 QI@TERMINAL_ATTRIBUTES_TEXT
    9B-0-0/w BIT         r     1 THIS_FIELD_HAS_A_PROMPT
    9C-0-0/c CHAR(8)     r     1 TIME_TYPE_STUFF_BUF       A0-0-0/w PTR         r     1 VARIABLE_SOURCE$
    A2-0-0/w PTR         r     1 VARIABLE_TARGET$          1B-0-0/w STRC(512)   r     1 VLP@LINEATTR
    52-0-0/w STRC(320)   r     1 VLP@TRMATTR               6E-0-0/w STRC(128)   r     1 VLP@TRMCTL
    76-0-0/w STRC(256)   r     1 VLP@WINDOW                A4-0-0/w UBIN(16)    r     1 WEEKDAY_INDEX

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:82   
     0-0-0/w PTR         r     1 G$JIT$                     0-0-0/d STRC(2576)  r     1 QI_1
     0-0-0/w STRC(128)   r     1 QI_FPT_FDS_LOAD            0-0-0/w STRC(128)   r     1 QI_FPT_GDS_LOAD
     0-0-0/w STRC(112)   r     1 QI_FPT_GLINEATTR           0-0-0/w STRC(256)   r     1 QI_FPT_TIME
     0-0-0/w STRC(112)   r     1 QI_FPT_TRMATTR             0-0-0/w STRC(128)   r     1 QI_FPT_TRMCTL
     0-0-0/w STRC(48)    r     1 QI_VLP_SEGMENT_LOAD

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(5616)  r     1 G$JIT                      0-0-0N  NULL        r     1 M$ME
     0-0-0/w STRC        r     1 QI$BITS                    0-0-0/w STRC(48)    r     1 QI$DAD
     0-0-0/c STRC(64)    r     1 QI$ERROR_STATUS            0-0-0/w STRC(384)   r     1 QI$FIELD_DAD
     0-0-0/w STRC(112)   r     1 QI$FIELD_DAD_P             0-0-0/w STRC(48)    r     1 QI$FIELD_STATUS
     0-0-0/w STRC(192)   r     1 QI$FORM_FILE               0-0-0/w STRC(144)   r     1 QI$FORM_STATUS
     0-0-0/w STRC(208)   r     1 QI$FRAME_STATUS            0-0-0/w STRC(176)   r     1 QI$GZ_HEADER
     0-0-0/w STRC(64)    r     1 QI$OP_ACCEPT               0-0-0/w STRC(32)    r     1 QI$OP_SEQUENCE
     0-0-0/c UBIN(8)     r     1 QI$UBYTE_A(0:0)
     0-0-0/w UBIN(16)    r     1 QI$UWORD_A(0:0)
     0-0-0/c ASTR(8)     r     1 QI$VARIABLE_IDENTIFIER
     0-0-0/c ASTR(0)     r     1 QI$VARIABLE_STRING_SOURCE
     0-0-0/c ASTR(0)     r     1 QI$VARIABLE_STRING_TARGET


   Procedure QBA$ACCEPT requires 1341 words for executable code.
   Procedure QBA$ACCEPT requires 229 words of local(AUTO) storage.

    No errors detected in file QBA$ACCEPT.:E05TSI    .
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:83   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:84   
          MINI XREF LISTING

CHECK_USE_PROCEDURE_OR_INVALID
     21258**LABEL   20772--GOTO    20783--GOTO
CONVERT_MON_TO_1_ETC
     21196**LABEL   21205--EXIT
ERROR_STATUS$
     20317**DCL     20941<<ASSIGN  20961>>ASSIGN
FIELD_COUNT
     20318**DCL     20700<<ASSIGN  20702>>ASSIGN  20707>>DOINDEX
FIELD_DAD$
     20319**DCL     20729<<ASSIGN  20731>>DOWHILE 20732<<ASSIGN  20732>>ASSIGN  20732>>ASSIGN  20751>>DOCASE
     20763>>ASSIGN  20802>>ASSIGN  20802>>ASSIGN
FIELD_DAD_P$
     20320**DCL     20802<<ASSIGN  20806>>IF      20835>>IF      20850>>ASSIGN
FIELD_INDEX
     20321**DCL     20707<<DOINDEX 20729>>ASSIGN
FPT@FDS
       465**DCL     21141<<ASSIGN  21146<>CALL
FPT@FDS.V
       468**DCL     21142--ASSIGN
FPT@FDS.V.PAGES
       472**DCL     21144<<ASSIGN
FPT@FDS.V_
       468**DCL     21142<<ASSIGN
FPT@GDS
       488**DCL     21107<<ASSIGN  21113<>CALL
FPT@GDS.V
       491**DCL     21108--ASSIGN
FPT@GDS.V.PAGES
       495**DCL     21110<<ASSIGN
FPT@GDS.V_
       491**DCL     21108<<ASSIGN
FPT@GLINEATTR
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:85   
       515**DCL     20999<<ASSIGN  21004<>CALL
FPT@GLINEATTR.LINEATTR_
       521**DCL     21002<<ASSIGN
FPT@GLINEATTR.V
       523**DCL     21000--ASSIGN
FPT@GLINEATTR.V.DCB#
       523**DCL     21001<<ASSIGN
FPT@GLINEATTR.V_
       517**DCL     21000<<ASSIGN
FPT@TIME
       562**DCL     21155<<ASSIGN  21185<>CALL
FPT@TIME.DATE_
       565**DCL     21160<<ASSIGN
FPT@TIME.DAY_
       566**DCL     21165<<ASSIGN  21176<<ASSIGN
FPT@TIME.TIME_
       565**DCL     21170<<ASSIGN
FPT@TIME.V
       566**DCL     21156--ASSIGN
FPT@TIME.V.DEST
       571**DCL     21175<<ASSIGN
FPT@TIME.V_
       565**DCL     21156<<ASSIGN
FPT@TRMATTR
       589**DCL     20988<<ASSIGN  20993<>CALL
FPT@TRMATTR.TRMATTR_
       595**DCL     20991<<ASSIGN
FPT@TRMATTR.V
       597**DCL     20989--ASSIGN
FPT@TRMATTR.V.DCB#
       597**DCL     20990<<ASSIGN
FPT@TRMATTR.V_
       591**DCL     20989<<ASSIGN
FPT@TRMCTL
       655**DCL     21010<<ASSIGN  21015<>CALL    21021<<ASSIGN  21027<>CALL
FPT@TRMCTL.TRMCTL_
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:86   
       661**DCL     21013<<ASSIGN  21025<<ASSIGN
FPT@TRMCTL.V
       663**DCL     21011--ASSIGN  21022--ASSIGN
FPT@TRMCTL.V.DCB#
       663**DCL     21012<<ASSIGN  21023<<ASSIGN
FPT@TRMCTL.V.VLPTYPE
       663**DCL     21024<<ASSIGN
FPT@TRMCTL.V_
       657**DCL     21011<<ASSIGN  21022<<ASSIGN
G$JIT.ACCN
      1091**DCL     21033>>ASSIGN
G$JIT.DB#
      1213**DCL     21078>>IF
G$JIT.ERRLOG
      1362**DCL      1365--REDEF
G$JIT.JSUNIT
      1101**DCL      1102--REDEF
G$JIT.MCLS
      1100**DCL      1100--REDEF
G$JIT.TMRZ
      1369**DCL      1370--REDEF
G$JIT.USER_EXTIME
      1093**DCL      1094--REDEF
G$JIT.USER_MEMTIME
      1096**DCL      1096--REDEF
G$JIT.USER_SVTIME
      1095**DCL      1095--REDEF
G$JIT$
      1432**DCL     21033>>ASSIGN  21078>>IF
INSTR$
     20326**DCL     20701<<ASSIGN  20702>>ASSIGN  20729>>ASSIGN  20979<<ASSIGN  20980>>ASSIGN  20982>>ASSIGN
     20985>>DOCASE  21158>>DOCASE  21193>>IF
LAST_FILE$
     20327**DCL     20704<<ASSIGN  20915>>IF      20919<<ASSIGN  21279<<ASSIGN
M$FDS
       427**DCL-ENT 21146--CALL
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:87   
M$GDS
       427**DCL-ENT 21113--CALL
M$GLINEATTR
       439**DCL-ENT 21004--CALL
M$GTRMATTR
       440**DCL-ENT 20993--CALL
M$GTRMCTL
       438**DCL-ENT 21015--CALL    21027--CALL
M$ME
      1434**DCL     21023>>ASSIGN
M$TIME
       422**DCL-ENT 21185--CALL
NEXT_FIELD_PLEASE
     20969**LABEL   21280--GOTO
PROMPT_INDEX
     20328**DCL     20833<<ASSIGN  20837<<ASSIGN  20837>>ASSIGN  20850>>ASSIGN
P_ITEM_INDEX
     20329**DCL     20834<<DOINDEX 20835>>IF
QCC$CDB
     20341**DCL-ENT 21234--CALL
QCC$DMC
     20342**DCL-ENT 21242--CALL
QCE$ERROR
     20343**DCL-ENT 21129--CALL
QCE$ERROR_INTERNAL
     20344**DCL-ENT 20757--CALL    20790--CALL    20795--CALL    20859--CALL    21181--CALL    21208--CALL
     21237--CALL    21245--CALL    21283--CALL
QCE$ERROR_M$INTERNAL
     20345**DCL-ENT 20996--CALL    21007--CALL    21018--CALL    21030--CALL    21116--CALL    21149--CALL
     21188--CALL
QCF$FIND_CURRENTS
     20346**DCL-ENT 20766--CALL
QCM$MESS
     20347**DCL-ENT 20874--CALL
QCM$MESS_ERASE
     20348**DCL-ENT 20903--CALL
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:88   
QCM@MESS
     20413**DCL     20874<>CALL    20903<>CALL
QCM@MESS.IS_MESSAGE_A_DAD
     20417**DCL     20870<<ASSIGN
QCM@MESS.MESSAGE$
     20423**DCL     20871<<ASSIGN
QCM@MESS.MESSAGE_LINE_GZ_HEADER$
     20414**DCL     20869<<ASSIGN
QCM@MESS.STATUS
     20429**DCL     20876>>IF      20905>>IF
QCM@MESS.VISUAL_ATTRIBUTE
     20434**DCL     20872<<ASSIGN
QCR$READ
     20349**DCL-ENT 20893--CALL
QCR@READ
     20502**DCL     20893<>CALL
QCR@READ.FIELD_START_INDEX
     20510**DCL     20890<<ASSIGN
QCR@READ.FIELD_STOP_INDEX
     20512**DCL     20891<<ASSIGN
QCR@READ.FRAME_START_INDEX
     20503**DCL     20887<<ASSIGN
QCR@READ.FRAME_STOP_INDEX
     20505**DCL     20888<<ASSIGN
QCR@READ.IS_CURSOR_POSITION_VALID
     20514**DCL     20886<<ASSIGN
QCR@READ.IS_FIELD_INDEXES_VALID
     20507**DCL     20889<<ASSIGN
QCR@READ.STATUS
     20519**DCL     20895>>IF
QCS$SETUP_SOURCE
     20350**DCL-ENT 20852--CALL
QCS$SETUP_TARGET
     20351**DCL-ENT 20983--CALL
QCU$USE_INVALID_IO
     20352**DCL-ENT 21268--CALL
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:89   
QCU@USE
     20603**DCL     21268<>CALL
QCU@USE.CURR_FRAME$
     20604**DCL     21260<<ASSIGN
QCU@USE.CURR_NODE$
     20606**DCL     21264<<ASSIGN  21266<<ASSIGN
QCU@USE.IS_TIME_TO_SAVE_AWAY_FIELDS
     20611**DCL     21259<<ASSIGN
QCU@USE.STATUS
     20637**DCL     21270>>DOCASE
QCU@USE.USE_DEFAULT_IO
     20608**DCL     21258<<ASSIGN
QGB_PARAM.DVE.DVBYTE.VFC
     12755**DCL     12756--REDEF
QGB_PARAM.DVE.EOMCHAR
     12767**DCL     12768--REDEF
QGB_PARAM.MSG$
     12749**DCL     12750--REDEF
QGB_PARAM.UHDR$
     12774**DCL     12775--REDEF
QI$ACTIVATION_STATUS
     10513**DCL     10519--REDEF
QI$BITS.BIT_A
     12848**DCL     20835>>IF
QI$CIP
      9354**DCL      9424--REDEF
QI$CIP.CA
      9359**DCL      9363--REDEF    9366--REDEF    9369--REDEF
QI$COBOL_DAD.PSEUDO_CIP
      9598**DCL      9623--REDEF
QI$COBOL_DAD.PSEUDO_CIP.ALPHANUMERIC
      9600**DCL      9605--REDEF
QI$COBOL_DAD.PSEUDO_CIP.NUMERIC.CB
      9606**DCL      9609--REDEF    9612--REDEF
QI$COBOL_DAD.VARIABLE_LENGTH_ITEMS
      9634**DCL      9650--REDEF    9658--REDEF    9666--REDEF
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:90   
QI$COBOL_DAD.VARIABLE_LENGTH_ITEMS.LEVEL_MULTIPLIERS
      9635**DCL      9645--REDEF    9648--REDEF
QI$COBOL_DAD.WORD0
      9562**DCL      9563--REDEF    9577--REDEF
QI$COBOL_DAD_P_BITS.P
      9702**DCL      9708--REDEF
QI$CONDITION_CONTROL_BLOCK.LIST_A@P
      9188**DCL      9189--REDEF
QI$CONDITION_CONTROL_BLOCK.WORD0_FLAGS
      9184**DCL      9187--REDEF
QI$CONDITION_LEGAL_BLOCK.ARRAY@P
      9221**DCL      9222--REDEF    9223--REDEF
QI$DAD.PSEUDO_CIP
      9501**DCL      9526--REDEF
QI$DAD.PSEUDO_CIP.ALPHANUMERIC
      9503**DCL      9508--REDEF
QI$DAD.PSEUDO_CIP.DATA@
      9525**DCL     20732>>ASSIGN
QI$DAD.PSEUDO_CIP.NUMERIC.CB
      9509**DCL      9512--REDEF    9515--REDEF
QI$DAD.WORD0
      9470**DCL      9471--REDEF
QI$DAD.WORD0_FLAGS.INDIRECT
      9472**DCL     20731>>DOWHILE
QI$DAD.WORD0_FLAGS.IS_CONSTANT
      9477**DCL     20732>>ASSIGN
QI$DAD.WORD0_FLAGS.TYPE
      9479**DCL     21262>>IF
QI$ERROR_MESSAGE_LINE
     12862**DCL     12864--REDEF
QI$ERROR_STATUS
     12859**DCL     12861--REDEF
QI$ERROR_STATUS.TEXT
     12860**DCL     20961<<ASSIGN
QI$FIELD_DAD.ELEMENTARY_ITEM.P
      9916**DCL      9923--REDEF
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:91   
QI$FIELD_DAD.ONE_DIMENSIONAL_ITEM.P
      9936**DCL      9943--REDEF
QI$FIELD_DAD.PSEUDO_CIP
      9843**DCL      9868--REDEF
QI$FIELD_DAD.PSEUDO_CIP.ALPHANUMERIC
      9845**DCL      9850--REDEF
QI$FIELD_DAD.PSEUDO_CIP.NUMERIC.CB
      9851**DCL      9854--REDEF    9857--REDEF
QI$FIELD_DAD.TWO_DIMENSIONAL_ITEM.P
      9956**DCL      9963--REDEF
QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS
      9899**DCL      9915--REDEF    9933--REDEF    9951--REDEF
QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS.LEVEL_MULTIPLIERS
      9900**DCL      9910--REDEF    9913--REDEF
QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS.LEVEL_MULTIPLIER_A
      9910**DCL     20802--ASSIGN
QI$FIELD_DAD.WORD0
      9795**DCL      9796--REDEF
QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT
      9819**DCL     20802>>ASSIGN
QI$FIELD_DAD.WORD0_FLAGS.IO_FLAGS
      9799**DCL      9804--REDEF
QI$FIELD_DAD.WORD0_FLAGS.IO_FLAGS.IS_INPUT
      9802**DCL     20788>>IF
QI$FIELD_DAD.WORD0_FLAGS.TYPE
      9821**DCL     20751>>DOCASE
QI$FIELD_DAD_P.P
      9997**DCL     10004--REDEF
QI$FIELD_DAD_P.P.PROMPT
     10001**DCL     20806>>IF
QI$FIELD_DAD_P.P_ITEM_A
     10007**DCL     20850--ASSIGN
QI$FIELD_STATUS.GZ.FIELD_START_INDEX
     10639**DCL     20792>>IF      20890>>ASSIGN
QI$FIELD_STATUS.GZ.FIELD_STOP_INDEX
     10641**DCL     20792>>IF      20891>>ASSIGN
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:92   
QI$FIELD_STATUS.INDICATORS
     10663**DCL     10695--REDEF
QI$FIELD_STATUS.INDICATORS.ENABLED_FLAGS
     10667**DCL     10672--REDEF
QI$FIELD_STATUS.INDICATORS.OPEN_FLAGS
     10679**DCL     10686--REDEF
QI$FIELD_STATUS.INDICATORS.STATE_FLAGS
     10673**DCL     10678--REDEF
QI$FILE.WORD0
     10119**DCL     10120--REDEF
QI$FILE_STATUS.INDICATORS
     10956**DCL     10988--REDEF
QI$FILE_STATUS.INDICATORS.ENABLED_FLAGS
     10960**DCL     10965--REDEF
QI$FILE_STATUS.INDICATORS.OPEN_FLAGS
     10972**DCL     10979--REDEF
QI$FILE_STATUS.INDICATORS.STATE_FLAGS
     10966**DCL     10971--REDEF
QI$FORM_FILE.ERROR_STATUS@D
     10203**DCL     20941>>ASSIGN
QI$FORM_FILE.USE_PROCEDURE
     10219**DCL     10226--REDEF
QI$FORM_FILE.WORD0
     10173**DCL     10174--REDEF
QI$FORM_FILE.WORD0_FLAGS.IS_ERROR_STATUS_VALID
     10178**DCL     20911>>IF
QI$FORM_STATUS.INDICATORS
     11077**DCL     11109--REDEF
QI$FORM_STATUS.INDICATORS.ENABLED_FLAGS
     11081**DCL     11086--REDEF
QI$FORM_STATUS.INDICATORS.OPEN_FLAGS
     11093**DCL     11100--REDEF
QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.IS_INPUT
     11097**DCL     20775>>IF
QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.IS_OUTPUT
     11094**DCL     20778>>IF
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:93   
QI$FORM_STATUS.INDICATORS.STATE_FLAGS
     11087**DCL     11092--REDEF
QI$FRAME.WORD0
     10334**DCL     10335--REDEF
QI$FRAME_STATUS.INDICATORS
     11306**DCL     11338--REDEF
QI$FRAME_STATUS.INDICATORS.ENABLED_FLAGS
     11310**DCL     11315--REDEF
QI$FRAME_STATUS.INDICATORS.IS_ACTIVE
     11308**DCL     20768>>IF
QI$FRAME_STATUS.INDICATORS.OPEN_FLAGS
     11322**DCL     11329--REDEF
QI$FRAME_STATUS.INDICATORS.STATE_FLAGS
     11316**DCL     11321--REDEF
QI$GZ_FIELD.DESCRIPTION.IO_FLAGS
     18188**DCL     18193--REDEF
QI$GZ_HEADER.DCB#
     18142**DCL     20990>>ASSIGN  21001>>ASSIGN  21012>>ASSIGN
QI$IDENTIFIER
     12865**DCL     12867--REDEF
QI$INDICATORS
     10577**DCL     10607--REDEF
QI$INDICATORS.ENABLED_FLAGS
     10583**DCL     10588--REDEF
QI$INDICATORS.OPEN_FLAGS
     10595**DCL     10602--REDEF
QI$INDICATORS.STATE_FLAGS
     10589**DCL     10594--REDEF
QI$MAJOR_NODE.WORD0
     10033**DCL     10034--REDEF
QI$MAJOR_STATUS.INDICATORS
     10756**DCL     10788--REDEF
QI$MAJOR_STATUS.INDICATORS.ENABLED_FLAGS
     10760**DCL     10765--REDEF
QI$MAJOR_STATUS.INDICATORS.OPEN_FLAGS
     10772**DCL     10779--REDEF
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:94   
QI$MAJOR_STATUS.INDICATORS.STATE_FLAGS
     10766**DCL     10771--REDEF
QI$MESSAGE_TYPE
     12856**DCL     12858--REDEF
QI$MINOR_NODE.WORD0
     10076**DCL     10077--REDEF
QI$MINOR_STATUS.INDICATORS
     10849**DCL     10881--REDEF
QI$MINOR_STATUS.INDICATORS.ENABLED_FLAGS
     10853**DCL     10858--REDEF
QI$MINOR_STATUS.INDICATORS.OPEN_FLAGS
     10865**DCL     10872--REDEF
QI$MINOR_STATUS.INDICATORS.STATE_FLAGS
     10859**DCL     10864--REDEF
QI$OP_ACCEPT.DATANAME@P
      7264**DCL      7265--REDEF   20982--ASSIGN
QI$OP_ACCEPT.FIELD_A@P
      7265**DCL     20729>>ASSIGN
QI$OP_ACCEPT.FIELD_COUNT
      7263**DCL     20700>>ASSIGN
QI$OP_ACCEPT.NEXT_CODE@P
      7266**DCL     20980--ASSIGN
QI$OP_ACCEPT.TYPE
      7262**DCL     20696>>IF      20985>>DOCASE  21158>>DOCASE  21193>>IF
QI$OP_CALL.EPTR$
      7436**DCL      7437--REDEF
QI$OP_CLEAR.IO_FLAGS
      7469**DCL      7472--REDEF
QI$OP_DISPLAY.FIELD_A@P
      7736**DCL      7737--REDEF
QI$OP_ENABLE.IO_FLAGS
      7823**DCL      7826--REDEF
QI$OP_IFCLS.ATTRIBUTE.TYPE
      7916**DCL      7921--REDEF
QI$OP_INSPECT.TALLYING_FOR_ITEM@P
      8150**DCL      8151--REDEF
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:95   
QI$OP_INSPECT.TALLYING_INITIAL_ITEM@P
      8152**DCL      8153--REDEF
QI$OP_INSPECT.TALLYING_ITEM@P
      8148**DCL      8149--REDEF
QI$OP_OPEN.IO_FLAGS
      8710**DCL      8713--REDEF
QI$OP_PERFM.BINARY_ITERATION_COUNT@P
      8748**DCL      8749--REDEF
QI$OP_SEQUENCE.CODE
      7204**DCL     21123>>IF
QI$PSEUDO_CIP
      9249**DCL      9273--REDEF
QI$PSEUDO_CIP.ALPHANUMERIC
      9253**DCL      9258--REDEF
QI$PSEUDO_CIP.NUMERIC.CB
      9259**DCL      9262--REDEF    9265--REDEF
QI$TERMINAL_ATTRIBUTES
     10470**DCL     10483--REDEF
QI$TRAN_FILE.WORD0
     10255**DCL     10256--REDEF
QI$TRAN_STATUS.INDICATORS
     11190**DCL     11222--REDEF
QI$TRAN_STATUS.INDICATORS.ENABLED_FLAGS
     11194**DCL     11199--REDEF
QI$TRAN_STATUS.INDICATORS.OPEN_FLAGS
     11206**DCL     11213--REDEF
QI$TRAN_STATUS.INDICATORS.STATE_FLAGS
     11200**DCL     11205--REDEF
QI$UBYTE_A
     12850**DCL     21100--ASSIGN
QI$UWORD_A
     12852**DCL     21135>>ASSIGN  21137--ASSIGN
QI$VARIABLE_IDENTIFIER.LENGTH
     12869**DCL     12870--IMP-SIZ
QI$VARIABLE_STRING_SOURCE.TEXT
     12876**DCL     21138>>ASSIGN  21220>>ASSIGN
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:96   
QI$VARIABLE_STRING_TARGET.TEXT
     12878**DCL     21100<<ASSIGN  21138<<ASSIGN  21220<<ASSIGN
QI@TERMINAL_ATTRIBUTES
     20670**DCL     20683--REDEF
QI@TERMINAL_ATTRIBUTES.CONNECTION_TYPE
     20676**DCL     21066<<ASSIGN  21069<<ASSIGN
QI@TERMINAL_ATTRIBUTES.CP_6_CONTROLLER
     20681**DCL     21094<<ASSIGN
QI@TERMINAL_ATTRIBUTES.CP_6_DEVICE
     20682**DCL     21097<<ASSIGN
QI@TERMINAL_ATTRIBUTES.CP_6_NODE
     20677**DCL     21072<<ASSIGN
QI@TERMINAL_ATTRIBUTES.CP_6_PORT
     20678**DCL     21075<<ASSIGN
QI@TERMINAL_ATTRIBUTES.CURRENT_DEVICE_PROFILE
     20672**DCL     21036<<ASSIGN
QI@TERMINAL_ATTRIBUTES.DEVICE_I_O_CAPABILITY
     20675**DCL     21048<<ASSIGN  21053<<ASSIGN  21058<<ASSIGN  21061<<ASSIGN
QI@TERMINAL_ATTRIBUTES.DEVICE_TYPE
     20680**DCL     21088<<ASSIGN  21091<<ASSIGN
QI@TERMINAL_ATTRIBUTES.NUMBER_OF_COLUMNS
     20674**DCL     21042<<CALLBLT
QI@TERMINAL_ATTRIBUTES.NUMBER_OF_LINES
     20673**DCL     21039<<CALLBLT
QI@TERMINAL_ATTRIBUTES.PROGRAM_EXECUTION
     20679**DCL     21080<<ASSIGN  21083<<ASSIGN
QI@TERMINAL_ATTRIBUTES.STATION_NAME
     20671**DCL     21033<<ASSIGN
QI@TERMINAL_ATTRIBUTES_TEXT
     20683**DCL     21100>>ASSIGN
QI_1.A_REG
     12143**DCL     21126<<ASSIGN  21132<<ASSIGN
QI_1.BASE
     11398**DCL     11405--REDEF
QI_1.BASE.DATA$
     11399**DCL     20941>>ASSIGN
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:97   
QI_1.BASE.PROC$
     11401**DCL     20729>>ASSIGN
QI_1.BASE_A$
     11405**DCL     20732>>ASSIGN
QI_1.CURRENT.FILE$
     12289**DCL     12291--REDEF   12293--REDEF
QI_1.CURRENT.FILE_STATUS$
     12295**DCL     12297--REDEF   12299--REDEF
QI_1.CURRENT.FORM$
     12291**DCL     20911>>IF      20915>>IF      20919>>ASSIGN  20941>>ASSIGN
QI_1.CURRENT.FORM_STATUS$
     12297**DCL     20775>>IF      20778>>IF
QI_1.CURRENT.FRAME$
     12301**DCL     21260>>ASSIGN
QI_1.CURRENT.FRAME_INDEX
     12305**DCL     20887>>ASSIGN  20888>>ASSIGN
QI_1.CURRENT.FRAME_STATUS$
     12303**DCL     20768>>IF
QI_1.CURRENT.NODE$
     12308**DCL     20763<<ASSIGN  20788>>IF      21262>>IF      21264>>ASSIGN
QI_1.CURRENT.NODE_STATUS$
     12310**DCL     20792>>IF      20792>>IF      20890>>ASSIGN  20891>>ASSIGN
QI_1.DAD
     12093**DCL     12098--REDEF
QI_1.DAD.S$
     12095**DCL     20871>>ASSIGN
QI_1.ERROR_STATUS
     12323**DCL     20771<<ASSIGN  20780<<ASSIGN  20782<<ASSIGN
QI_1.FILE_HEAD
     12276**DCL     12283--REDEF
QI_1.INSTR$
     11406**DCL     20696>>IF      20700>>ASSIGN  20701>>ASSIGN  20702<<ASSIGN  20979>>ASSIGN  20980<<ASSIGN
     21123>>IF
QI_1.IS_ALL_LIT
     12099**DCL     12104--REDEF
QI_1.IS_FORM_VARIABLE
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:98   
     12105**DCL     12110--REDEF
QI_1.IS_TEMP
     12111**DCL     12116--REDEF
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP
     12209**DCL     12234--REDEF
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP.ALPHANUMERIC
     12211**DCL     12216--REDEF
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP.NUMERIC.CB
     12217**DCL     12220--REDEF   12223--REDEF
QI_1.MESSAGE_LINE_DAD.WORD0
     12178**DCL     12179--REDEF
QI_1.MESSAGE_LINE_GZ.HEADER$
     12255**DCL     20869>>ASSIGN  20990>>ASSIGN  21001>>ASSIGN  21012>>ASSIGN
QI_1.OFFSET
     12117**DCL     12122--REDEF
QI_1.OFFSET.T
     12120**DCL     21100>>ASSIGN  21217>>ASSIGN
QI_1.OP
     11476**DCL     21234<>CALL    21242<>CALL
QI_1.OP.CIP
     11478**DCL     11929--REDEF
QI_1.OP.CIP.AUX
     11844**DCL     11915--REDEF
QI_1.OP.CIP.AUX.CD
     11889**DCL     11892--REDEF   11896--REDEF   11899--REDEF
QI_1.OP.CIP.S
     11548**DCL     11619--REDEF
QI_1.OP.CIP.S.CD
     11593**DCL     11596--REDEF   11600--REDEF   11603--REDEF
QI_1.OP.CIP.S.LEN
     11607**DCL     21226<<ASSIGN
QI_1.OP.CIP.S_A
     11619**DCL     21225<<ASSIGN
QI_1.OP.CIP.T
     11696**DCL     11767--REDEF
QI_1.OP.CIP.T.CD
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:99   
     11741**DCL     11744--REDEF   11748--REDEF   11751--REDEF
QI_1.OP.DATA
     11936**DCL     11940--REDEF
QI_1.OP.DATA.S$
     11937**DCL     21134<<ASSIGN  21135>>ASSIGN  21137<<ASSIGN  21137>>ASSIGN  21138>>ASSIGN  21211<<ASSIGN
     21216>>ASSIGN
QI_1.OP.DATA.T$
     11938**DCL     21100>>ASSIGN  21138>>ASSIGN  21217>>ASSIGN
QI_1.OP.DEC.S
     11999**DCL     21227<<ASSIGN
QI_1.OP.FILL_CHAR
     12060**DCL     12063--REDEF
QI_1.OP.INX
     11993**DCL     11997--REDEF   11998--REDEF   12002--REDEF
QI_1.OP.LEN
     11976**DCL     11980--REDEF   11981--REDEF   11985--REDEF   11986--REDEF   11990--REDEF
QI_1.OP.LEN.AUX
     11979**DCL     12880--IMP-SIZ
QI_1.OP.LEN.S
     11977**DCL     12876--IMP-SIZ 21135<<ASSIGN  21138>>ASSIGN  21162<<ASSIGN  21167<<ASSIGN  21172<<ASSIGN
     21178<<ASSIGN  21204<<ASSIGN  21220>>ASSIGN  21226>>ASSIGN
QI_1.OP.LEN.T
     11978**DCL     12878--IMP-SIZ 21100>>ASSIGN  21138>>ASSIGN  21220>>ASSIGN
QI_1.OP.PICTURE_STRING
     12046**DCL     12049--REDEF   12050--REDEF   12053--REDEF   12054--REDEF   12057--REDEF
QI_1.OP.ROUND
     12079**DCL     12080--REDEF   12081--REDEF
QI_1.OP.SIZE_ERROR
     12063**DCL     21229<<ASSIGN
QI_1.OP.SRCH_VRFY_ELEMS
     12015**DCL     12018--REDEF
QI_1.OPENED_COUNT
     12284**DCL     12287--REDEF
QI_1.OTTER_SPACE
     12123**DCL     12128--REDEF
QI_1.PICTURE_STRING
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:100  
     12129**DCL     12134--REDEF
QI_1.SOURCE$
     11449**DCL     20850<<ASSIGN  20982<<ASSIGN
QI_1.SPECIAL_NAMES
     12312**DCL     12321--REDEF
QI_1.TYPE
     12135**DCL     12140--REDEF
QI_1.TYPE.S
     12137**DCL     20856>>IF      20856>>IF
QI_1.TYPE.T
     12138**DCL     21213>>IF      21231>>IF
QI_16_BIT_BINARY
     17325**DCL     17395--REDEF
QI_16_BIT_BINARY.CB
     17344**DCL     17347--REDEF   17351--REDEF   17354--REDEF
QI_31_DIGIT_SLS_DISPLAY
     17158**DCL     17228--REDEF
QI_31_DIGIT_SLS_DISPLAY.CD
     17205**DCL     17208--REDEF   17212--REDEF   17215--REDEF
QI_31_DIGIT_ST_PACKED
     17660**DCL     17730--REDEF
QI_31_DIGIT_ST_PACKED.CP
     17693**DCL     17696--REDEF   17700--REDEF   17703--REDEF
QI_32_BIT_BINARY
     17492**DCL     17562--REDEF
QI_32_BIT_BINARY.CB
     17511**DCL     17514--REDEF   17518--REDEF   17521--REDEF
QI_4_CHAR_ALPHANUMERIC
     16990**DCL     17060--REDEF
QI_4_CHAR_ALPHANUMERIC.CA
     16995**DCL     16999--REDEF   17002--REDEF   17005--REDEF
QI_ACCUMULATOR_DAD.CIP
     18003**DCL     18074--REDEF
QI_ACCUMULATOR_DAD.CIP.CP
     18034**DCL     18037--REDEF   18041--REDEF   18044--REDEF
QI_ALR.CIP
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:101  
     12955**DCL     13406--REDEF
QI_ALR.CIP.AUX
     13321**DCL     13392--REDEF
QI_ALR.CIP.AUX.CA
     13324**DCL     13328--REDEF   13331--REDEF   13334--REDEF
QI_ALR.CIP.S
     13025**DCL     13096--REDEF
QI_ALR.CIP.S.CA
     13028**DCL     13032--REDEF   13035--REDEF   13038--REDEF
QI_ALR.CIP.T
     13173**DCL     13244--REDEF
QI_ALR.CIP.T.CA
     13176**DCL     13180--REDEF   13183--REDEF   13186--REDEF
QI_ALR.DATA
     13413**DCL     13417--REDEF
QI_ALR.FILL_CHAR
     13537**DCL     13540--REDEF
QI_ALR.INX
     13470**DCL     13474--REDEF   13475--REDEF   13479--REDEF
QI_ALR.LEN
     13453**DCL     13457--REDEF   13458--REDEF   13462--REDEF   13463--REDEF   13467--REDEF
QI_ALR.PICTURE_STRING
     13523**DCL     13526--REDEF   13527--REDEF   13530--REDEF   13531--REDEF   13534--REDEF
QI_ALR.ROUND
     13556**DCL     13557--REDEF   13558--REDEF
QI_ALR.SRCH_VRFY_ELEMS
     13492**DCL     13495--REDEF
QI_FPT_DBCONTROL.V_
     18375**DCL     18375--REDEF
QI_FPT_FDS_LOAD
     18808**DCL     21141>>ASSIGN
QI_FPT_GDS_LOAD
     19054**DCL     21107>>ASSIGN
QI_FPT_GLINEATTR
     19152**DCL     20999>>ASSIGN
QI_FPT_INT.V_
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:102  
     19213**DCL     19213--REDEF
QI_FPT_TIME
     19701**DCL     21155>>ASSIGN
QI_FPT_TRMATTR
     19986**DCL     20988>>ASSIGN
QI_FPT_TRMCTL
     20038**DCL     21010>>ASSIGN  21021>>ASSIGN
QI_MAT.CIP
     16294**DCL     16745--REDEF
QI_MAT.CIP.AUX
     16660**DCL     16731--REDEF
QI_MAT.CIP.AUX.CA
     16663**DCL     16667--REDEF   16670--REDEF   16673--REDEF
QI_MAT.CIP.S
     16364**DCL     16435--REDEF
QI_MAT.CIP.S.CA
     16367**DCL     16371--REDEF   16374--REDEF   16377--REDEF
QI_MAT.CIP.T
     16512**DCL     16583--REDEF
QI_MAT.CIP.T.CA
     16515**DCL     16519--REDEF   16522--REDEF   16525--REDEF
QI_MAT.DATA
     16752**DCL     16756--REDEF
QI_MAT.DEC
     16820**DCL     16824--REDEF   16825--REDEF   16829--REDEF
QI_MAT.FILL_CHAR
     16876**DCL     16879--REDEF
QI_MAT.LEN
     16792**DCL     16796--REDEF   16797--REDEF   16801--REDEF   16802--REDEF   16806--REDEF
QI_MAT.PICTURE_STRING
     16862**DCL     16865--REDEF   16866--REDEF   16869--REDEF   16870--REDEF   16873--REDEF
QI_MAT.ROUND
     16895**DCL     16896--REDEF   16897--REDEF
QI_MAT.SRCH_VRFY_ELEMS
     16831**DCL     16834--REDEF
QI_PICTURE_STRING
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:103  
     17828**DCL     17898--REDEF
QI_PICTURE_STRING.CA
     17833**DCL     17837--REDEF   17840--REDEF   17843--REDEF
QI_SRCH_VRFY.CIP
     15625**DCL     16076--REDEF
QI_SRCH_VRFY.CIP.AUX
     15991**DCL     16062--REDEF
QI_SRCH_VRFY.CIP.AUX.CA
     15994**DCL     15998--REDEF   16001--REDEF   16004--REDEF
QI_SRCH_VRFY.CIP.S
     15695**DCL     15766--REDEF
QI_SRCH_VRFY.CIP.S.CA
     15698**DCL     15702--REDEF   15705--REDEF   15708--REDEF
QI_SRCH_VRFY.CIP.T
     15843**DCL     15914--REDEF
QI_SRCH_VRFY.CIP.T.CA
     15846**DCL     15850--REDEF   15853--REDEF   15856--REDEF
QI_SRCH_VRFY.DATA
     16083**DCL     16087--REDEF
QI_SRCH_VRFY.DEC
     16151**DCL     16155--REDEF   16156--REDEF   16160--REDEF
QI_SRCH_VRFY.FILL_CHAR
     16207**DCL     16210--REDEF
QI_SRCH_VRFY.ROUND
     16226**DCL     16227--REDEF   16228--REDEF
QI_SRCH_VRFY.SRCH_RESULT
     16167**DCL     16170--REDEF   16171--REDEF   16174--REDEF   16175--REDEF   16178--REDEF
QI_SRCH_VRFY.SRCH_VRFY_ARGS
     16091**DCL     16095--REDEF   16096--REDEF   16100--REDEF   16101--REDEF   16105--REDEF
QI_SRCH_VRFY.SRCH_VRFY_ELEMS
     16162**DCL     16165--REDEF
QI_TYPE_BINARY_TARGET.CIP
     14952**DCL     15403--REDEF
QI_TYPE_BINARY_TARGET.CIP.AUX
     15318**DCL     15389--REDEF
QI_TYPE_BINARY_TARGET.CIP.AUX.CA
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:104  
     15321**DCL     15325--REDEF   15328--REDEF   15331--REDEF
QI_TYPE_BINARY_TARGET.CIP.S
     15022**DCL     15093--REDEF
QI_TYPE_BINARY_TARGET.CIP.S.CA
     15025**DCL     15029--REDEF   15032--REDEF   15035--REDEF
QI_TYPE_BINARY_TARGET.CIP.T
     15170**DCL     15241--REDEF
QI_TYPE_BINARY_TARGET.CIP.T.CB
     15187**DCL     15190--REDEF   15194--REDEF   15197--REDEF
QI_TYPE_BINARY_TARGET.DATA
     15410**DCL     15414--REDEF
QI_TYPE_BINARY_TARGET.DEC
     15478**DCL     15482--REDEF   15483--REDEF   15487--REDEF
QI_TYPE_BINARY_TARGET.LEN
     15450**DCL     15454--REDEF   15455--REDEF   15459--REDEF   15460--REDEF   15464--REDEF
QI_TYPE_BINARY_TARGET.PICTURE_STRING
     15520**DCL     15523--REDEF   15524--REDEF   15527--REDEF   15528--REDEF   15531--REDEF
QI_TYPE_BINARY_TARGET.ROUND
     15553**DCL     15554--REDEF   15555--REDEF
QI_TYPE_BINARY_TARGET.SIZE_ERROR
     15539**DCL     15540--REDEF
QI_TYPE_BINARY_TARGET.SRCH_VRFY_ELEMS
     15489**DCL     15492--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP
     13620**DCL     14071--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.AUX
     13986**DCL     14057--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.AUX.CA
     13989**DCL     13993--REDEF   13996--REDEF   13999--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.S
     13690**DCL     13761--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.S.CD
     13735**DCL     13738--REDEF   13742--REDEF   13745--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.T
     13838**DCL     13909--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.T.CA
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:105  
     13841**DCL     13845--REDEF   13848--REDEF   13851--REDEF
QI_TYPE_DISPLAY_SOURCE.DATA
     14078**DCL     14082--REDEF
QI_TYPE_DISPLAY_SOURCE.DEC
     14146**DCL     14150--REDEF   14151--REDEF   14155--REDEF
QI_TYPE_DISPLAY_SOURCE.LEN
     14118**DCL     14122--REDEF   14123--REDEF   14127--REDEF   14128--REDEF   14132--REDEF
QI_TYPE_DISPLAY_SOURCE.PICTURE_STRING
     14188**DCL     14191--REDEF   14192--REDEF   14195--REDEF   14196--REDEF   14199--REDEF
QI_TYPE_DISPLAY_SOURCE.ROUND
     14221**DCL     14222--REDEF   14223--REDEF
QI_TYPE_DISPLAY_SOURCE.SIZE_ERROR
     14207**DCL     14208--REDEF
QI_TYPE_DISPLAY_SOURCE.SRCH_VRFY_ELEMS
     14157**DCL     14160--REDEF
QI_TYPE_DISPLAY_TARGET.CIP
     14286**DCL     14737--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.AUX
     14652**DCL     14723--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.AUX.CA
     14655**DCL     14659--REDEF   14662--REDEF   14665--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.S
     14356**DCL     14427--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.S.CA
     14359**DCL     14363--REDEF   14366--REDEF   14369--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.T
     14504**DCL     14575--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.T.CD
     14549**DCL     14552--REDEF   14556--REDEF   14559--REDEF
QI_TYPE_DISPLAY_TARGET.DATA
     14744**DCL     14748--REDEF
QI_TYPE_DISPLAY_TARGET.DEC
     14812**DCL     14816--REDEF   14817--REDEF   14821--REDEF
QI_TYPE_DISPLAY_TARGET.LEN
     14784**DCL     14788--REDEF   14789--REDEF   14793--REDEF   14794--REDEF   14798--REDEF
QI_TYPE_DISPLAY_TARGET.PICTURE_STRING
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:106  
     14854**DCL     14857--REDEF   14858--REDEF   14861--REDEF   14862--REDEF   14865--REDEF
QI_TYPE_DISPLAY_TARGET.ROUND
     14887**DCL     14888--REDEF   14889--REDEF
QI_TYPE_DISPLAY_TARGET.SIZE_ERROR
     14873**DCL     14874--REDEF
QI_TYPE_DISPLAY_TARGET.SRCH_VRFY_ELEMS
     14823**DCL     14826--REDEF
QI_VLP_SEGMENT.BASE
     18912**DCL     18912--REDEF
QI_VLP_SEGMENT_BUFFER.BASE
     19010**DCL     19010--REDEF
QI_VLP_SEGMENT_LOAD.BASE
     19108**DCL     19108--REDEF   21111<<ASSIGN
QI_VLP_SEGMENT_LOAD.BASE$
     19108**DCL     21134>>ASSIGN
QI_VLP_SEGMENT_LOAD.PAGES
     19108**DCL     21119>>IF      21144>>ASSIGN
QI_VLP_TRMCTL.BREAKCOUNT
     20102**DCL     20103--REDEF
QI_VLP_XBREAK.IC
     20292**DCL     20292--REDEF
QI_VLP_XBREAK.OLDIC
     20292**DCL     20293--REDEF   20293--REDEF
RETRY_FIELD_ACCEPT
     20766**LABEL   21276--GOTO
THIS_FIELD_HAS_A_PROMPT
     20330**DCL     20880<<ASSIGN  20884<<ASSIGN  20899>>IF
TIME_TYPE_STUFF_BUF
     20331**DCL     21160--ASSIGN  21165--ASSIGN  21170--ASSIGN  21176--ASSIGN  21198>>IF      21202<<ASSIGN
     21211--ASSIGN
VARIABLE_SOURCE$
     20332**DCL     21216<<ASSIGN  21220>>ASSIGN
VARIABLE_TARGET$
     20333**DCL     21217<<ASSIGN  21220>>ASSIGN
VLP@LINEATTR
       542**DCL     21002--ASSIGN
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:107  
VLP@LINEATTR.CONTROLLER
       545**DCL     21094>>ASSIGN
VLP@LINEATTR.DEVICE
       546**DCL     21097>>ASSIGN
VLP@LINEATTR.HARDWIRE
       543**DCL     21064>>IF
VLP@LINEATTR.NODE
       545**DCL     21072>>ASSIGN
VLP@LINEATTR.PORT
       545**DCL     21075>>ASSIGN
VLP@LINEATTR.PROFILE
       544**DCL       544--REDEF
VLP@LINEATTR.PROTXTC.CNT
       544**DCL     21036>>ASSIGN
VLP@LINEATTR.PROTXTC.TXT
       545**DCL     21036>>ASSIGN
VLP@TRMATTR
       617**DCL     20991--ASSIGN
VLP@TRMATTR.INPUT
       626**DCL     21045>>IF      21051>>IF
VLP@TRMATTR.OUTPUT
       626**DCL     21045>>IF      21056>>IF
VLP@TRMCTL
       684**DCL     21013--ASSIGN
VLP@TRMCTL.BREAKCOUNT
       695**DCL       696--REDEF
VLP@TRMCTL.RETYPOVR
       690**DCL     21086>>IF
VLP@WINDOW
       726**DCL     21025--ASSIGN
VLP@WINDOW.FWINDOW
       726**DCL       726--REDEF     727--REDEF
VLP@WINDOW.LENGTH
       740**DCL     21039>>CALLBLT
VLP@WINDOW.WIDTH
       740**DCL     21042>>CALLBLT
PL6.E3A0      #001=QBA$ACCEPT File=QBA$ACCEPT.:E05TSI                            WED 07/30/97 04:39 Page:108  
WEEKDAY_1_ETC_TABLE
     20338**DCL     21202>>ASSIGN
WEEKDAY_INDEX
     20334**DCL     21197<<DOINDEX 21198>>IF      21202>>ASSIGN
WEEKDAY_MON_ETC_TABLE
     20336**DCL     21198>>IF
