VERSION E05

PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:1    
        1        1        /*M* KQI$INFO COMGROUP AU info routines */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*P* NAME:         KQI$INFO
       10       10             PURPOSE:      To provide comgroup functions related to
       11       11                           the infomational services provided to the AU
       12       12        */
       13       13        /**/
       14       14        KQI$CGINFO: PROC (KQ$CG) ALTRET;
       15       15        /**/
       16       16
       17       17
       18       18
       19       19        /**/
       20       20        /* INCLUDES */
       21       21        /**/
       22       22        %INCLUDE KQ_SUBS_C;
       23      322        %INCLUDE KQ_MAC_C;
       24     2872        %INCLUDE HF_LOCK_C;
       25     2886        %INCLUDE KQ_DATA_R;
       26     3718        %INCLUDE CP_6_SUBS;
       27     4258        %INCLUDE KC$CP6V_C;
       28     4378        %INCLUDE B$JIT_C;
       29     4692        %INCLUDE UD_SEV_C;
       30     4706        %INCLUDE KQ_ERRORS_C;
       31     4754        %INCLUDE KC_ERRORS_C;
       32     4801        %INCLUDE NK$LDCT;
       33     4903        %INCLUDE KC_CP6;
       34     5463        %INCLUDE KI_CP6;
       35     6559        %INCLUDE KI$CP6V_C;
       36     6998        %INCLUDE KC$CGBLK;
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:2    
       37     7046
       38     7047
       39     7048
       40     7049        /**/
       41     7050        /* PARAMETERS */
       42     7051        /**/
       43     7052        %KQ_CG (FPTN=KQ$CG,STCLASS="");
       44     7791
       45     7792
       46     7793
       47     7794        /**/
       48     7795        /* MACROS */
       49     7796        /**/
       50     7797        %MACRO $ERROR (NAME=GORGO,CODE=0,SEV=SEV_ERROR#);
       51     7798        DCL 1 NAME CONSTANT ALIGNED,
       52     7799              2 * BIT(18) UNAL INIT('132111'O),
       53     7800              2 * UBIN(15) UNAL INIT(CODE),
       54     7801              2 * UBIN(3) UNAL INIT(SEV);
       55     7802        %MEND;
       56     7803
       57     7804
       58     7805
       59     7806        /**/
       60     7807        /* BASED STRUCTURES */
       61     7808        /**/
       62     7809        %NK$LDCT;
       63     7855        %KQ_STA  (FPTN=KQ$STA ,STCLASS="BASED(STA$)");
       64     8194        %KQ_MTYP (FPTN=KQ$MTYP,STCLASS="BASED(MTYP$)");
       65     8268        %KQ_QTN  (FPTN=KQ$QTN ,STCLASS="BASED(QTN$)");
       66     8741        %KQ_THDR (FPTN=KQ$THDR,STCLASS=BASED);
       67     8779        %FPT$CGINFO_V   (FPTN=FPT$CGINFO,BASED="BASED(B$PS0$)");
       68     8782        %VLP$CGTYPL_V   (FPTN=VLR$CGTYPL,BASED="BASED(B$PS1$)",NTYP=1);
       69     8787        %VLP$CGSTAL_V   (FPTN=VLR$CGSTAL,BASED="BASED(B$PS2$)",NSTA=1);
       70     8791        %VLP$CGCP_V     (FPTN=VLR$CGCP  ,BASED="BASED(B$PS3$)");
       71     8810        %VLP$SETSTA_V   (FPTN=VLR$SETSTA,BASED="BASED(B$PS4$)");
       72     8822        %VLR$CGSTATS_V  (FPTN=VLR$STATS ,BASED="BASED(B$PS5$)");
       73     8832        %VLP$CGQL_V     (FPTN=VLR$CGQL  ,BASED="BASED(B$PS6$)",NLIST=1);
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:3    
       74     8836        %VLP$STATION_V (FPTN=VLP$STATION,BASED="BASED(B$PS8$)");
       75     8848        %VLP_JRNLFIDV (FPTN=VLP$JRNLFID);
       76     8855        %B$JIT0;
       77     8944        %A$JIT6X;
       78     8947
       79     8948
       80     8949
       81     8950        /**/
       82     8951        /* AUTO */
       83     8952        /**/
       84     8953    1   DCL STA$ PTR;
       85     8954    1   DCL MTYP$ PTR;
       86     8955    1   DCL QTN$ PTR;
       87     8956    1   DCL DSIZ SBIN;
       88     8957    1   DCL NTYP SBIN;
       89     8958    1   DCL TYPX SBIN;
       90     8959    1   DCL KEY CHAR(8);
       91     8960    1   DCL PRIO UBIN;
       92     8961    1   DCL STAX SBIN;
       93     8962    1   DCL NSTA SBIN;
       94     8963    1   DCL P$ PTR;
       95     8964    1   DCL RBLK$ PTR;
       96     8965    1   DCL RAS BIT(1);
       97     8966    1   DCL PP$ PTR;
       98     8967    1   DCL QLIST UBIN;
       99     8968    1   DCL QX SBIN;
      100     8969    1   DCL NQ SBIN;
      101     8970    1   DCL WILDLEN SBIN;
      102     8971    1   DCL WILDC CHAR(8);
      103     8972
      104     8973
      105     8974
      106     8975        /**/
      107     8976        /* CONSTANT */
      108     8977        /**/
      109     8978        %$ERROR (NAME=E_CGIQLS,CODE=%E$CGIQLS);
      110     8984        %$ERROR (NAME=E_CGISLS,CODE=%E$CGISLS);
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:4    
      111     8990        %$ERROR (NAME=E_CGITLS,CODE=%E$CGITLS);
      112     8996        %$ERROR (NAME=E_CGIWILD,CODE=%E$CGIWILD);
      113     9002        %$ERROR (NAME=E_CGTTRP,CODE=%E$CGTTRP);
      114     9008        %$ERROR (NAME=E_CGSTRP,CODE=%E$CGSTRP);
      115     9014        %$ERROR (NAME=E_CGUAFC,CODE=%E$CGUAFC);
      116     9020        %$ERROR (NAME=E_CGAFNT,CODE=%E$CGAFNT);
      117     9026        %$ERROR (NAME=E_CGAFNS,CODE=%E$CGAFNS);
      118     9032        %$ERROR (NAME=E_BDJFID,CODE=%E$BDJFID);
      119     9038
      120     9039        /**/
      121     9040        /* REFS */
      122     9041        /**/
      123     9042    1   DCL KQB$SRCH      ENTRY(3) ALTRET;
      124     9043    1   DCL HFF$TRAPALT   ENTRY(1) ALTRET;
      125     9044    1   DCL HFF$NILERASE  ENTRY(1) ALTRET;
      126     9045    1   DCL HFF$DSIZ      ENTRY(2) ALTRET;
      127     9046    1   DCL B$PS0$ PTR SYMREF READONLY;
      128     9047    1   DCL B$PS1$ PTR SYMREF READONLY;
      129     9048    1   DCL B$PS2$ PTR SYMREF READONLY;
      130     9049    1   DCL B$PS3$ PTR SYMREF READONLY;
      131     9050    1   DCL B$PS4$ PTR SYMREF READONLY;
      132     9051    1   DCL B$PS5$ PTR SYMREF READONLY;
      133     9052    1   DCL B$PS6$ PTR SYMREF READONLY;
      134     9053    1   DCL B$PS7$ PTR SYMREF READONLY;
      135     9054    1   DCL B$PS8$ PTR SYMREF READONLY;
      136     9055    1   DCL B$PS9$ PTR SYMREF READONLY;
      137     9056    1   DCL B$PS10$ PTR SYMREF READONLY;
      138     9057    1   DCL B$PS11$ PTR SYMREF READONLY;
      139     9058    1   DCL B$JIT$ PTR SYMREF;
      140     9059        %VLP_STATION (FPTN=KC_VLPSTATION,STCLASS=SYMREF);
      141     9086
      142     9087
      143     9088
      144     9089        /**/
      145     9090        /* SUBS */
      146     9091        /**/
      147     9092        %SUB KQ$QTREE="KQ$CG.QUEUE.QTREE$->KQ$THDR";
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:5    
      148     9093        %SUB KQ$TTREE="KQ$CG.TTREE";
      149     9094        %SUB KQ$STREE="KQ$CG.STREE";
      150     9095        %EQU_CG;
      151     9143        %EJECT;
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:6    
      152     9144        /**/
      153     9145        /*F* NAME:         KQI$CGINFO
      154     9146             PURPOSE:      To process the M$CGINFO PMME
      155     9147             DESCRIPTION:  Enter here from KCP$PMME after verifying that
      156     9148                           the PMME issuer is indeed the AU.
      157     9149
      158     9150        KQI$CGINFO: ENTRY (KQ$CG) ALTRET;
      159     9151        */
      160     9152        /**/
      161     9153    1         QLIST=0;
      162     9154    1         CALL HFF$DSIZ (6,DSIZ) ALTRET(NOQL);
      163     9155    1         NQ=DSIZ/LENGTHC(VLR$CGQL.LIST(0));
      164     9156    1         QLIST=1;
      165     9157    1   NOQL: ;
      166     9158
      167     9159                 /****************************************
      168     9160                  *                                      *
      169     9161                  *        PROCESS TYP LIST              *
      170     9162                  *                                      *
      171     9163                  ****************************************/
      172     9164
      173     9165    1         CALL HFF$DSIZ (1,DSIZ) ALTRET(NOTYPL);
      174     9166    1         NTYP=(DSIZ-4)/LENGTHC(VLR$CGTYPL.LIST(0));
      175     9167    1         IF NTYP = 0 THEN GOTO NOTYPL;
      176     9168    1         IF  QLIST ~= 0
      177     9169    1         AND KQ$CG.QISS = '0'B THEN
      178     9170    1          IF NQ < NTYP THEN
      179     9171    2            DO;
      180     9172    2   IQLS:    ;
      181     9173    2            B$JIT.ERR=E_CGIQLS;
      182     9174        /*E* ERROR:   KQI-E$CGIQLS-E
      183     9175             MESSAGE: Insufficient QLIST area space for M$CGINFO
      184     9176             MESSAGE1: The QLIST area specified by your M$CGINFO service
      185     9177                       is not as long as the list (STALIST or TYPLIST) it
      186     9178                       is parallel to. */
      187     9179    2            ALTRETURN;
      188     9180    2            END;
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:7    
      189     9181              %LOCK (G=KQ$TTREE.GATE);
      190     9184    1         CALL HFF$TRAPALT ALTRET(TYPTRAP);
      191     9185    2           DO CASE (FPT$CGINFO.TYPFC);
      192     9186
      193     9187    2             CASE (%CG_INFFC_SELECT#);
      194     9188    3                 DO QX = 0 TO NTYP-1;
      195     9189    3                 KEY=VLR$CGTYPL.LIST.NAME(QX);
      196     9190    3                 CALL KQB$SRCH (KQ$TTREE,KEY,QTN$) ALTRET(NOTYP0);
      197     9191    3                 CALL FILLTYP;
      198     9192    3                 END;
      199     9193
      200     9194    2             CASE (%CG_INFFC_DUMP#,%CG_INFFC_WILD#);
      201     9195    2               IF FPT$CGINFO.TYPFC=%CG_INFFC_WILD#
      202     9196    2               THEN CALL INDEX(WILDLEN,'?',VLR$CGTYPL.LIST.NAME(0)) ALTRET(NOQUESTT);
      203     9197    2               ELSE WILDLEN = 0;
      204     9198    2               WILDC = SUBSTR(VLR$CGTYPL.LIST.NAME(0),0,WILDLEN);
      205     9199    2               QX=0;
      206     9200    2               VLR$CGTYPL.FOUND=0;
      207     9201    2               QTN$=KQ$TTREE.HEAD$;
      208     9202    3                 DO WHILE (QTN$ ~= ADDR(NIL));
      209     9203    3                 IF SUBSTR(QTN$->KQ$MTYP.BTN.KEY,0,WILDLEN)=WILDC
      210     9204    4                 THEN DO;
      211     9205    4                   IF QX >= NTYP THEN
      212     9206    5                     DO;
      213     9207    5                     B$JIT.ERR=E_CGITLS;
      214     9208        /*E* ERROR:   KQI-E$CGITLS-E
      215     9209             MESSAGE: Insufficient M$CGINFO TYPE list space
      216     9210             MESSAGE1: The TYPLIST area specified in your M$CGINFO service
      217     9211                       is not large enough to hold all the message types
      218     9212                       you requested.  All that it would hold have been
      219     9213                       returned to you. */
      220     9214    6                       DO WHILE('0'B);
      221     9215    6   NOQUESTT:           B$JIT.ERR=E_CGIWILD;
      222     9216        /*E* ERROR:   KQI-E$CGIWILD-E
      223     9217             MESSAGE: '?' not found as trailing character of TYPE or STATION
      224     9218             MESSAGE1: You specified TYPFC=WILD but did not supply a wildcarded
      225     9219                       type in VLR_CGTYPL.LIST.NAME(0), or
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:8    
      226     9220                       you specified STAFC=WILD but did not supply a wildcarded
      227     9221                       station in VLR_CGSTAL.LIST.NAME(0). */
      228     9222    6                       END;
      229     9223                          %UNLOCK (G=KQ$TTREE.GATE);
      230     9226    5                     ALTRETURN;
      231     9227    5                     END;
      232     9228    4                   VLR$CGTYPL.FOUND=VLR$CGTYPL.FOUND+1;
      233     9229    4                   CALL FILLTYP;
      234     9230    4                   QX=QX+1;
      235     9231    4                   END;
      236     9232    3                 QTN$=QTN$->KQ$MTYP.BTN.FLINK$;
      237     9233    3                 END;
      238     9234
      239     9235    2             CASE (ELSE);
      240     9236                    %UNLOCK (G=KQ$TTREE.GATE);
      241     9239    2   BADOPT:     ;
      242     9240    2               B$JIT.ERR=E_CGUAFC;
      243     9241        /*E* ERROR:   KQI-E$CGUAFC-E
      244     9242             MESSAGE: Unknown M$CGINFO function code
      245     9243             MESSAGE1: The STAFC or TYPFC code in your M$CGINFO FPT is
      246     9244                       unknown. */
      247     9245    2               ALTRETURN;
      248     9246
      249     9247    2           END; /*CASE FPT$CGINFO.TYPFC*/
      250     9248              %UNLOCK (G=KQ$TTREE.GATE);
      251     9251    1         GOTO NOTYPL;
      252     9252    1   NOTYP0:;
      253     9253    1         CALL HFF$TRAPALT;
      254     9254              %UNLOCK (G=KQ$TTREE.GATE);
      255     9257    1         B$JIT.ERR=E_CGAFNT;
      256     9258        /*E* ERROR:   KQI-E$CGAFNT-E
      257     9259             MESSAGE: M$CGINFO can't find that message type
      258     9260             MESSAGE1: One of the message types in your M$CGINFO
      259     9261                       service's TYPLIST could not be found. */
      260     9262    1         ALTRETURN;
      261     9263    1   TYPTRAP:;
      262     9264              %UNLOCK (G=KQ$TTREE.GATE);
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:9    
      263     9267    1         B$JIT.ERR=E_CGTTRP;
      264     9268        /*E* ERROR:   KQI-E$CGTTRP-E
      265     9269             MESSAGE: Bad TYPLIST or QLIST area specified by M$CGINFO
      266     9270             MESSAGE1: Either the TYPLIST or QLIST area specified by your
      267     9271                       M$CGINFO service is inaccessible. */
      268     9272    1         ALTRETURN;
      269     9273    1   NOTYPL:;
      270     9274        %EJECT;
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:10   
      271     9275        /**/
      272     9276
      273     9277                 /****************************************
      274     9278                  *                                      *
      275     9279                  *        PROCESS STA LIST              *
      276     9280                  *                                      *
      277     9281                  ****************************************/
      278     9282
      279     9283    1         CALL HFF$DSIZ (2,DSIZ) ALTRET(NOSTAL);
      280     9284    1         NSTA=(DSIZ-4)/LENGTHC(VLR$CGSTAL.LIST(0));
      281     9285    1         IF NSTA = 0 THEN GOTO NOSTAL;
      282     9286    1         IF  QLIST ~= 0
      283     9287    1         AND KQ$CG.QISS THEN
      284     9288    1          IF NQ < NSTA THEN GOTO IQLS;
      285     9289              %LOCK (G=KQ$STREE.GATE);
      286     9292    1         CALL HFF$TRAPALT ALTRET(STATRAP);
      287     9293
      288     9294    2           DO CASE (FPT$CGINFO.STAFC);
      289     9295
      290     9296    2             CASE (%CG_INFFC_SELECT#);
      291     9297    3                 DO QX = 0 TO NSTA-1;
      292     9298    3                 KEY=VLR$CGSTAL.LIST.NAME(QX);
      293     9299    3                 CALL KQB$SRCH (KQ$STREE,KEY,QTN$) ALTRET(NOSTA0);
      294     9300    3                 CALL FILLSTA ALTRET(NOSTA0);
      295     9301    3                 END;
      296     9302
      297     9303    2             CASE (%CG_INFFC_DUMP#,%CG_INFFC_WILD#);
      298     9304    2               IF FPT$CGINFO.STAFC=%CG_INFFC_WILD#
      299     9305    2               THEN CALL INDEX(WILDLEN,'?',VLR$CGSTAL.LIST.NAME(0)) ALTRET(NOQUESTS);
      300     9306    2               ELSE WILDLEN = 0;
      301     9307    2               WILDC = SUBSTR(VLR$CGSTAL.LIST.NAME(0),0,WILDLEN);
      302     9308    2               QX=0;
      303     9309    2               VLR$CGSTAL.FOUND=0;
      304     9310    2               QTN$=KQ$STREE.HEAD$;
      305     9311    3                 DO WHILE (QTN$ ~= ADDR(NIL));
      306     9312    3                 IF SUBSTR(QTN$->KQ$MTYP.BTN.KEY,0,WILDLEN)=WILDC
      307     9313    4                 THEN DO;
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:11   
      308     9314    4                   IF NOT ( QTN$->KQ$STA.LDCT$~=ADDR(NIL)
      309     9315    4                   AND QTN$->KQ$STA.LDCT$->NK$LDCT.RLCID.LDCTX=0
      310     9316    4                   AND QTN$->KQ$STA.PERM='0'B AND QTN$->KQ$STA.TERM )
      311     9317    5                   THEN DO;     /* Don't tell about terminals that have not yet      */
      312     9318                                     /* completed connection (unless they are PERManent)  */
      313     9319    5                     IF QX >= NSTA THEN
      314     9320    6                       DO;
      315     9321    6                       B$JIT.ERR=E_CGISLS;
      316     9322        /*E* ERROR:   KQI-E$CGISLS-E
      317     9323             MESSAGE: Insufficient M$CGINFO STATION list space
      318     9324             MESSAGE1: The STALIST area specified in your M$CGINFO service
      319     9325                       is not large enough to hold all the stations you
      320     9326                       requested.  All that it would hold have been
      321     9327                       returned to you. */
      322     9328    7                         DO WHILE('0'B);
      323     9329    7   NOQUESTS:             B$JIT.ERR = E_CGIWILD;
      324     9330    7                         END;
      325     9331                            %UNLOCK (G=KQ$STREE.GATE);
      326     9334    6                       ALTRETURN;
      327     9335    6                       END;
      328     9336    5                     VLR$CGSTAL.FOUND=VLR$CGSTAL.FOUND+1;
      329     9337    5                     CALL FILLSTA;
      330     9338    5                     QX=QX+1;
      331     9339    5                     END;
      332     9340    4                   END;
      333     9341    3                 QTN$=QTN$->KQ$STA.BTN.FLINK$;
      334     9342    3                 END;
      335     9343
      336     9344    2             CASE (ELSE);
      337     9345                    %UNLOCK (G=KQ$STREE.GATE);
      338     9348    2               GOTO BADOPT;
      339     9349
      340     9350    2           END; /*CASE FPT$CGINFO.STAFC*/
      341     9351              %UNLOCK (G=KQ$STREE.GATE);
      342     9354    1         GOTO NOSTAL;
      343     9355    1   NOSTA0:;
      344     9356    1         CALL HFF$TRAPALT;
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:12   
      345     9357              %UNLOCK (G=KQ$STREE.GATE);
      346     9360    1         B$JIT.ERR=E_CGAFNS;
      347     9361        /*E* ERROR:   KQI-E$CGAFNS-E
      348     9362             MESSAGE: M$CGINFO can't find that station
      349     9363             MESSAGE1: One of the stations in your M$CGINFO
      350     9364                       service's STALIST could not be found. */
      351     9365    1         ALTRETURN;
      352     9366    1   STATRAP:;
      353     9367              %UNLOCK (G=KQ$STREE.GATE);
      354     9370    1         B$JIT.ERR=E_CGSTRP;
      355     9371        /*E* ERROR:   KQI-E$CGSTRP-E
      356     9372             MESSAGE: Bad STALIST or QLIST area specified by M$CGINFO
      357     9373             MESSAGE1: Either the STALIST or QLIST area specified by your
      358     9374                       M$CGINFO service is inaccessible. */
      359     9375    1         ALTRETURN;
      360     9376    1   NOSTAL:;
      361     9377        %EJECT;
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:13   
      362     9378        /**/
      363     9379
      364     9380                 /****************************************
      365     9381                  *                                      *
      366     9382                  *        PROCESS CONTROL PARAMS        *
      367     9383                  *                                      *
      368     9384                  ****************************************/
      369     9385
      370     9386    1         CALL HFF$NILERASE (3) ALTRET(NOCTL);
      371     9387    1         VLR$CGCP=KQ$CG.AUCTL;
      372     9388    1   NOCTL:;
      373     9389                 /****************************************
      374     9390                  *                                      *
      375     9391                  *        PROCESS VLP_SETSTA            *
      376     9392                  *                                      *
      377     9393                  ****************************************/
      378     9394
      379     9395    1         CALL HFF$NILERASE (4) ALTRET(NOSETSTA);
      380     9396    1         VLR$SETSTA=KQ$CG.SETSTA;
      381     9397    1   NOSETSTA:;
      382     9398                 /****************************************
      383     9399                  *                                      *
      384     9400                  *        PROCESS STATS                 *
      385     9401                  *                                      *
      386     9402                  ****************************************/
      387     9403
      388     9404    1         CALL HFF$NILERASE (5) ALTRET(NOSTATS);
      389     9405    1         KQ$CG.STATS.WRDSFREE = (KQ$CG.UGRANS+KQ$CG.NGAVAL)*1024 -
      390     9406    1         KQ$CG.STATS.WRDSUSED;
      391     9407    1         VLR$STATS=KQ$CG.STATS;
      392     9408    1   NOSTATS:;
      393     9409                 /****************************************
      394     9410                  *                                      *
      395     9411                  *        PROCESS HOLDSTA               *
      396     9412                  *                                      *
      397     9413                  ****************************************/
      398     9414
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:14   
      399     9415    1         CALL HFF$NILERASE (9) ALTRET(NOHOLDS);
      400     9416    1         B$PS9$->VLP$STATION=KC_VLPSTATION;
      401     9417              %LOCK (G=KQ$STREE.GATE);
      402     9420    1         IF KQ$CG.HOLDSTA$ ~= ADDR(NIL) THEN
      403     9421    1          B$PS9$->VLP$STATION.STATION=KQ$CG.HOLDSTA$->KQ$STA.BTN.KEY;
      404     9422              %UNLOCK (G=KQ$STREE.GATE);
      405     9425    1   NOHOLDS:;
      406     9426                 /****************************************
      407     9427                  *                                      *
      408     9428                  *        PROCESS JRNLSTA               *
      409     9429                  *                                      *
      410     9430                  ****************************************/
      411     9431
      412     9432    1         CALL HFF$NILERASE (10) ALTRET(NOJRNLS);
      413     9433    1         B$PS10$->VLP$STATION=KC_VLPSTATION;
      414     9434              %LOCK (G=KQ$STREE.GATE);
      415     9437    1         IF KQ$CG.JRNLSTA$ ~= ADDR(NIL) THEN
      416     9438    1          B$PS10$->VLP$STATION.STATION=KQ$CG.JRNLSTA$->KQ$STA.BTN.KEY;
      417     9439              %UNLOCK (G=KQ$STREE.GATE);
      418     9442    1   NOJRNLS:;
      419     9443                 /****************************************
      420     9444                  *                                      *
      421     9445                  *        PROCESS JRNLFID               *
      422     9446                  *                                      *
      423     9447                  ****************************************/
      424     9448
      425     9449    1         CALL HFF$NILERASE (11) ALTRET(NOJF);
      426     9450              %LOCK (G=KQ$CG.GATE.MISC);
      427     9453    1         CALL HFF$TRAPALT ALTRET(BADJF);
      428     9454    1         IF KQ$CG.JRNLFID$ = ADDR(NIL) THEN
      429     9455    1          B$PS11$->VLP$JRNLFID.L#=0;
      430     9456    1         ELSE
      431     9457    2           DO;
      432     9458    2           B$PS11$->VLP$JRNLFID.L#=KQ$CG.JRNLFID$->VLP$JRNLFID.L#;
      433     9459    2           B$PS11$->VLP$JRNLFID=KQ$CG.JRNLFID$->VLP$JRNLFID;
      434     9460    2           END;
      435     9461              %UNLOCK (G=KQ$CG.GATE.MISC);
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:15   
      436     9464    1         CALL HFF$TRAPALT;
      437     9465    1         GOTO NOJF;
      438     9466    1   BADJF:;
      439     9467    1         CALL HFF$TRAPALT;
      440     9468    1         B$JIT.ERR=E_BDJFID;
      441     9469        /*E* ERROR:   KQI-E$BDJFID-E
      442     9470             MESSAGE: Bad JRNLFID passed to M$CGINFO
      443     9471             MESSAGE1: The JRNFID parameter on your M$CGINFO call is
      444     9472                       insufficiently large to receive the entire journal
      445     9473                       FID of the comgroup. */
      446     9474    1         ALTRETURN;
      447     9475    1   NOJF: ;
      448     9476    1         RETURN;
      449     9477        %EJECT;
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:16   
      450     9478        /**/
      451     9479        /*********************************************************************************
      452     9480        *                                                                                *
      453     9481        *   SSS   U   U  BBBB   RRRR    OOO   U   U  TTTTT   III   N   N  EEEEE   SSS    *
      454     9482        *  S   S  U   U  B   B  R   R  O O O  U   U    T      I    N   N  E      S   S   *
      455     9483        *  S      U   U  B   B  R   R  O O O  U   U    T      I    NN  N  E      S       *
      456     9484        *   SSS   U   U  BBBB   RRRR   O  OO  U   U    T      I    N N N  EEEE    SSS    *
      457     9485        *      S  U   U  B   B  R R    O   O  U   U    T      I    N  NN  E          S   *
      458     9486        *  S   S  U   U  B   B  R  R   O   O  U   U    T      I    N   N  E      S   S   *
      459     9487        *   SSS    UUU   BBBB   R   R   OOO    UUU     T     III   N   N  EEEEE   SSS    *
      460     9488        *                                                                                *
      461     9489        *********************************************************************************/
      462     9490
      463     9491        /***************************************************
      464     9492        ****************************************************/
      465     9493        /*D* NAME:         FILLTYP
      466     9494             PURPOSE:      To fill in a VLR$CGTYPL.LIST entry
      467     9495                           about a message type.
      468     9496        */
      469     9497    1   FILLTYP: PROC ALTRET;  /* !!!Does not ALTRET!!! */
      470     9498    2         VLR$CGTYPL.LIST.NAME(QX)=QTN$->KQ$MTYP.BTN.KEY;
      471     9499    2         VLR$CGTYPL.LIST.PERM(QX)=QTN$->KQ$MTYP.PERM;
      472     9500    2         VLR$CGTYPL.LIST.PRIO(QX)=QTN$->KQ$MTYP.MPRIO;
      473     9501    2         VLR$CGTYPL.LIST.JOURNAL(QX)=QTN$->KQ$MTYP.JOURNAL;
      474     9502    2         VLR$CGTYPL.LIST.ONEREPORT(QX)=QTN$->KQ$MTYP.ONEREPORT;
      475     9503    2         VLR$CGTYPL.LIST.NUMWRITES(QX) = QTN$->KQ$MTYP.NUMWRITES;
      476     9504    2         VLR$CGTYPL.LIST.MAXLATCH(QX)  = QTN$->KQ$MTYP.MAXLATCH;
      477     9505    2         IF  QLIST ~= 0
      478     9506    2         AND KQ$CG.QISS = '0'B THEN
      479     9507    2          GOTO FILLQ;
      480     9508    2         RETURN;
      481     9509        /*D* NAME:         FILLSTA
      482     9510             PURPOSE:      To fill in a VLR$CGSTAL.LIST entry
      483     9511                           about a station.
      484     9512        */
      485     9513    2   FILLSTA: ENTRY ALTRET;   /* DOES NOT ALTRET!!! */
      486     9514    2         VLR$CGSTAL.LIST.NAME(QX)  =QTN$->KQ$STA.BTN.KEY;
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:17   
      487     9515    2         VLR$CGSTAL.LIST.PERM(QX)  =QTN$->KQ$STA.PERM;
      488     9516    2         VLR$CGSTAL.LIST.PRIO(QX)  =QTN$->KQ$STA.MPRIO;
      489     9517    2         VLR$CGSTAL.LIST.MSGCNT(QX)=QTN$->KQ$STA.MLH.COUNT;
      490     9518    2         VLR$CGSTAL.LIST.READS (QX)=QTN$->KQ$STA.READS;
      491     9519    2         VLR$CGSTAL.LIST.WRITES(QX)=QTN$->KQ$STA.WRITES;
      492     9520    2         VLR$CGSTAL.LIST.AUP(QX)=QTN$->KQ$STA.AUP;
      493     9521    2         VLR$CGSTAL.LIST.CON   (QX)='0'B;
      494     9522    2         VLR$CGSTAL.LIST.ACTIVE(QX)='0'B;
      495     9523    2         IF QTN$->KQ$STA.LDCT$ ~= ADDR(NIL) THEN
      496     9524    3           DO;
      497     9525                %LOCK (G=QTN$->KQ$STA.GATE);
      498     9528    3           IF QTN$->KQ$STA.LDCT$ ~= ADDR(NIL) THEN
      499     9529    4             DO;
      500     9530    4             IF QTN$->KQ$STA.LDCT$->NK$LDCT.RLCID.LDCTX~=0
      501     9531    4             OR QTN$->KQ$STA.LDCT$->NK$LDCT.DFLG.LOCAL
      502     9532    4             THEN VLR$CGSTAL.LIST.CON(QX)='1'B;
      503     9533    4             VLR$CGSTAL.LIST.ACTIVE(QX)=QTN$->KQ$STA.LDCT$->NK$LDCT.LKFLG.ACTIVE;
      504     9534    4             END;
      505     9535                %UNLOCK (G=QTN$->KQ$STA.GATE);
      506     9538    3           END;
      507     9539    2         IF  QLIST ~= 0
      508     9540    2         AND KQ$CG.QISS THEN
      509     9541    2          GOTO FILLQ;
      510     9542    2         RETURN;
      511     9543    2   FILLQ:;
      512     9544    2         VLR$CGQL.LIST.MXACT(QX)  =QTN$->KQ$QTN.MXACT;
      513     9545    2         VLR$CGQL.LIST.CNACT(QX)  =QTN$->KQ$QTN.CNACT;
      514     9546    2         VLR$CGQL.LIST.MSGCNT(QX) =QTN$->KQ$QTN.MLH.COUNT;
      515     9547    2         RETURN;
      516     9548    2   END FILLTYP;
      517     9549    1   END KQI$CGINFO;

PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:18   
--  Include file information  --

   KC$CGBLK.:E05TOU  is referenced.
   KI$CP6V_C.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   KC_CP6.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
   KC_ERRORS_C.:E05TOU  is referenced.
   KQ_ERRORS_C.:E05TOU  is referenced.
   UD_SEV_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   KC$CP6V_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   KQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   KQ_MAC_C.:E05TOU  is referenced.
   KQ_SUBS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure KQI$CGINFO.

   Procedure KQI$CGINFO requires 684 words for executable code.
   Procedure KQI$CGINFO requires 32 words of local(AUTO) storage.

    No errors detected in file KQI$INFO.:E05TSI    .

PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:19   

 Object Unit name= KQI$CGINFO                                 File name= KQI$INFO.:E05TOU
 UTS= JUL 30 '97 01:28:59.20 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     10     12  KQI$CGINFO
    1   Proc  even  none   684   1254  KQI$CGINFO
    2  RoData even  none    12     14  KQI$CGINFO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        1  KQI$CGINFO

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 HFF$DSIZ
         yes           Std       1 HFC$UNLOCK
 yes     yes           Std       1 HFF$NILERASE
         yes           Std       1 HFC$LOCK
 yes     yes           Std       1 HFF$TRAPALT
 yes     yes           Std       3 KQB$SRCH
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:20   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    B$PS0$                           r    B$PS1$                           r    B$PS2$
r    B$PS3$                           r    B$PS4$                           r    B$PS5$
r    B$PS6$                           r    B$PS8$                           r    B$PS9$
r    B$PS10$                          r    B$PS11$                               B$JIT$
     KC_VLPSTATION                         B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:21   


        1        1        /*M* KQI$INFO COMGROUP AU info routines */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7       /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*P* NAME:         KQI$INFO
       10       10             PURPOSE:      To provide comgroup functions related to
       11       11                           the infomational services provided to the AU
       12       12        */
       13       13        /**/
       14       14        KQI$CGINFO: PROC (KQ$CG) ALTRET;

     14  1 000000   000000 700200 xent  KQI$CGINFO   TSX0  ! X66_AUTO_1
         1 000001   000040 000001                    ZERO    32,1

       15       15        /**/
       16       16
       17       17
       18       18
       19       19        /**/
       20       20        /* INCLUDES */
       21       21        /**/
       22       22        %INCLUDE KQ_SUBS_C;
       23      322        %INCLUDE KQ_MAC_C;
       24     2872        %INCLUDE HF_LOCK_C;
       25     2886        %INCLUDE KQ_DATA_R;
       26     3718        %INCLUDE CP_6_SUBS;
       27     4258        %INCLUDE KC$CP6V_C;
       28     4378        %INCLUDE B$JIT_C;
       29     4692        %INCLUDE UD_SEV_C;
       30     4706        %INCLUDE KQ_ERRORS_C;
       31     4754        %INCLUDE KC_ERRORS_C;
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:22   
       32     4801        %INCLUDE NK$LDCT;
       33     4903        %INCLUDE KC_CP6;
       34     5463        %INCLUDE KI_CP6;
       35     6559        %INCLUDE KI$CP6V_C;
       36     6998        %INCLUDE KC$CGBLK;
       37     7046
       38     7047
       39     7048
       40     7049        /**/
       41     7050        /* PARAMETERS */
       42     7051        /**/
       43     7052        %KQ_CG (FPTN=KQ$CG,STCLASS="");
       44     7791
       45     7792
       46     7793
       47     7794        /**/
       48     7795        /* MACROS */
       49     7796        /**/
       50     7797        %MACRO $ERROR (NAME=GORGO,CODE=0,SEV=SEV_ERROR#);
       51     7798        DCL 1 NAME CONSTANT ALIGNED,
       52     7799              2 * BIT(18) UNAL INIT('132111'O),
       53     7800              2 * UBIN(15) UNAL INIT(CODE),
       54     7801              2 * UBIN(3) UNAL INIT(SEV);
       55     7802        %MEND;
       56     7803
       57     7804
       58     7805
       59     7806        /**/
       60     7807        /* BASED STRUCTURES */
       61     7808        /**/
       62     7809        %NK$LDCT;
       63     7855        %KQ_STA  (FPTN=KQ$STA ,STCLASS="BASED(STA$)");
       64     8194        %KQ_MTYP (FPTN=KQ$MTYP,STCLASS="BASED(MTYP$)");
       65     8268        %KQ_QTN  (FPTN=KQ$QTN ,STCLASS="BASED(QTN$)");
       66     8741        %KQ_THDR (FPTN=KQ$THDR,STCLASS=BASED);
       67     8779        %FPT$CGINFO_V   (FPTN=FPT$CGINFO,BASED="BASED(B$PS0$)");
       68     8782        %VLP$CGTYPL_V   (FPTN=VLR$CGTYPL,BASED="BASED(B$PS1$)",NTYP=1);
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:23   
       69     8787        %VLP$CGSTAL_V   (FPTN=VLR$CGSTAL,BASED="BASED(B$PS2$)",NSTA=1);
       70     8791        %VLP$CGCP_V     (FPTN=VLR$CGCP  ,BASED="BASED(B$PS3$)");
       71     8810        %VLP$SETSTA_V   (FPTN=VLR$SETSTA,BASED="BASED(B$PS4$)");
       72     8822        %VLR$CGSTATS_V  (FPTN=VLR$STATS ,BASED="BASED(B$PS5$)");
       73     8832        %VLP$CGQL_V     (FPTN=VLR$CGQL  ,BASED="BASED(B$PS6$)",NLIST=1);
       74     8836        %VLP$STATION_V (FPTN=VLP$STATION,BASED="BASED(B$PS8$)");
       75     8848        %VLP_JRNLFIDV (FPTN=VLP$JRNLFID);
       76     8855        %B$JIT0;
       77     8944        %A$JIT6X;
       78     8947
       79     8948
       80     8949
       81     8950        /**/
       82     8951        /* AUTO */
       83     8952        /**/
       84     8953    1   DCL STA$ PTR;
       85     8954    1   DCL MTYP$ PTR;
       86     8955    1   DCL QTN$ PTR;
       87     8956    1   DCL DSIZ SBIN;
       88     8957    1   DCL NTYP SBIN;
       89     8958    1   DCL TYPX SBIN;
       90     8959    1   DCL KEY CHAR(8);
       91     8960    1   DCL PRIO UBIN;
       92     8961    1   DCL STAX SBIN;
       93     8962    1   DCL NSTA SBIN;
       94     8963    1   DCL P$ PTR;
       95     8964    1   DCL RBLK$ PTR;
       96     8965    1   DCL RAS BIT(1);
       97     8966    1   DCL PP$ PTR;
       98     8967    1   DCL QLIST UBIN;
       99     8968    1   DCL QX SBIN;
      100     8969    1   DCL NQ SBIN;
      101     8970    1   DCL WILDLEN SBIN;
      102     8971    1   DCL WILDC CHAR(8);
      103     8972
      104     8973
      105     8974
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:24   
      106     8975        /**/
      107     8976        /* CONSTANT */
      108     8977        /**/
      109     8978        %$ERROR (NAME=E_CGIQLS,CODE=%E$CGIQLS);
      110     8984        %$ERROR (NAME=E_CGISLS,CODE=%E$CGISLS);
      111     8990        %$ERROR (NAME=E_CGITLS,CODE=%E$CGITLS);
      112     8996        %$ERROR (NAME=E_CGIWILD,CODE=%E$CGIWILD);
      113     9002        %$ERROR (NAME=E_CGTTRP,CODE=%E$CGTTRP);
      114     9008        %$ERROR (NAME=E_CGSTRP,CODE=%E$CGSTRP);
      115     9014        %$ERROR (NAME=E_CGUAFC,CODE=%E$CGUAFC);
      116     9020        %$ERROR (NAME=E_CGAFNT,CODE=%E$CGAFNT);
      117     9026        %$ERROR (NAME=E_CGAFNS,CODE=%E$CGAFNS);
      118     9032        %$ERROR (NAME=E_BDJFID,CODE=%E$BDJFID);
      119     9038
      120     9039        /**/
      121     9040        /* REFS */
      122     9041        /**/
      123     9042    1   DCL KQB$SRCH      ENTRY(3) ALTRET;
      124     9043    1   DCL HFF$TRAPALT   ENTRY(1) ALTRET;
      125     9044    1   DCL HFF$NILERASE  ENTRY(1) ALTRET;
      126     9045    1   DCL HFF$DSIZ      ENTRY(2) ALTRET;
      127     9046    1   DCL B$PS0$ PTR SYMREF READONLY;
      128     9047    1   DCL B$PS1$ PTR SYMREF READONLY;
      129     9048    1   DCL B$PS2$ PTR SYMREF READONLY;
      130     9049    1   DCL B$PS3$ PTR SYMREF READONLY;
      131     9050    1   DCL B$PS4$ PTR SYMREF READONLY;
      132     9051    1   DCL B$PS5$ PTR SYMREF READONLY;
      133     9052    1   DCL B$PS6$ PTR SYMREF READONLY;
      134     9053    1   DCL B$PS7$ PTR SYMREF READONLY;
      135     9054    1   DCL B$PS8$ PTR SYMREF READONLY;
      136     9055    1   DCL B$PS9$ PTR SYMREF READONLY;
      137     9056    1   DCL B$PS10$ PTR SYMREF READONLY;
      138     9057    1   DCL B$PS11$ PTR SYMREF READONLY;
      139     9058    1   DCL B$JIT$ PTR SYMREF;
      140     9059        %VLP_STATION (FPTN=KC_VLPSTATION,STCLASS=SYMREF);
      141     9086
      142     9087
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:25   
      143     9088
      144     9089        /**/
      145     9090        /* SUBS */
      146     9091        /**/
      147     9092        %SUB KQ$QTREE="KQ$CG.QUEUE.QTREE$->KQ$THDR";
      148     9093        %SUB KQ$TTREE="KQ$CG.TTREE";
      149     9094        %SUB KQ$STREE="KQ$CG.STREE";
      150     9095        %EQU_CG;
      151     9143        %EJECT;
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:26   
      152     9144        /**/
      153     9145        /*F* NAME:         KQI$CGINFO
      154     9146             PURPOSE:      To process the M$CGINFO PMME
      155     9147             DESCRIPTION:  Enter here from KCP$PMME after verifying that
      156     9148                           the PMME issuer is indeed the AU.
      157     9149
      158     9150        KQI$CGINFO: ENTRY (KQ$CG) ALTRET;
      159     9151        */
      160     9152        /**/
      161     9153    1         QLIST=0;

   9153  1 000002   200023 450100                    STZ     QLIST,,AUTO

      162     9154    1         CALL HFF$DSIZ (6,DSIZ) ALTRET(NOQL);

   9154  1 000003   200007 630500                    EPPR0   DSIZ,,AUTO
         1 000004   200035 450500                    STP0    WILDC+6,,AUTO
         1 000005   000000 236000 2                  LDQ     0
         1 000006   200034 756100                    STQ     WILDC+5,,AUTO
         1 000007   200034 630500                    EPPR0   WILDC+5,,AUTO
         1 000010   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000011   000000 701000 xent               TSX1    HFF$DSIZ
         1 000012   000020 702000 1                  TSX2    NOQL

      163     9155    1         NQ=DSIZ/LENGTHC(VLR$CGQL.LIST(0));

   9155  1 000013   200007 236100                    LDQ     DSIZ,,AUTO
         1 000014   000044 506007                    DIV     36,DL
         1 000015   200025 756100                    STQ     NQ,,AUTO

      164     9156    1         QLIST=1;

   9156  1 000016   000001 235007                    LDA     1,DL
         1 000017   200023 755100                    STA     QLIST,,AUTO

   9156  1 000020                       NOQL         null
      165     9157    1   NOQL: ;
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:27   
      166     9158
      167     9159                 /****************************************
      168     9160                  *                                      *
      169     9161                  *        PROCESS TYP LIST              *
      170     9162                  *                                      *
      171     9163                  ****************************************/
      172     9164
      173     9165    1         CALL HFF$DSIZ (1,DSIZ) ALTRET(NOTYPL);

   9165  1 000020   200007 630500                    EPPR0   DSIZ,,AUTO
         1 000021   200035 450500                    STP0    WILDC+6,,AUTO
         1 000022   000001 236000 2                  LDQ     1
         1 000023   200034 756100                    STQ     WILDC+5,,AUTO
         1 000024   200034 630500                    EPPR0   WILDC+5,,AUTO
         1 000025   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000026   000000 701000 xent               TSX1    HFF$DSIZ
         1 000027   000277 702000 1                  TSX2    NOTYPL

      174     9166    1         NTYP=(DSIZ-4)/LENGTHC(VLR$CGTYPL.LIST(0));

   9166  1 000030   200007 236100                    LDQ     DSIZ,,AUTO
         1 000031   000004 136007                    SBLQ    4,DL
         1 000032   000034 506007                    DIV     28,DL
         1 000033   200010 756100                    STQ     NTYP,,AUTO

      175     9167    1         IF NTYP = 0 THEN GOTO NOTYPL;

   9167  1 000034   000000 116003                    CMPQ    0,DU
         1 000035   000277 600000 1                  TZE     NOTYPL

      176     9168    1         IF  QLIST ~= 0

   9168  1 000036   200023 235100                    LDA     QLIST,,AUTO
         1 000037   000051 600000 1                  TZE     s:9182
         1 000040   200003 470500                    LDP0    @KQ$CG,,AUTO
         1 000041   000106 235100                    LDA     70,,PR0
         1 000042   000051 601000 1                  TNZ     s:9182
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:28   

      177     9169    1         AND KQ$CG.QISS = '0'B THEN
      178     9170    1          IF NQ < NTYP THEN

   9170  1 000043   200025 116100                    CMPQ    NQ,,AUTO
         1 000044   000051 604400 1                  TMOZ    s:9182

      179     9171    2            DO;

      180     9172    2   IQLS:    ;

   9172  1 000045                       IQLS         null
      181     9173    2            B$JIT.ERR=E_CGIQLS;

   9173  1 000045   000000 236000 0                  LDQ     E_CGIQLS
         1 000046   000000 470400 xsym               LDP0    B$JIT$
         1 000047   000012 756100                    STQ     10,,PR0

      182     9174        /*E* ERROR:   KQI-E$CGIQLS-E
      183     9175             MESSAGE: Insufficient QLIST area space for M$CGINFO
      184     9176             MESSAGE1: The QLIST area specified by your M$CGINFO service
      185     9177                       is not as long as the list (STALIST or TYPLIST) it
      186     9178                       is parallel to. */
      187     9179    2            ALTRETURN;

   9179  1 000050   000000 702200 xent               TSX2  ! X66_AALT

      188     9180    2            END;
      189     9181              %LOCK (G=KQ$TTREE.GATE);

   9182  1 000051   200003 236100                    LDQ     @KQ$CG,,AUTO
         1 000052   000067 036003                    ADLQ    55,DU
         1 000053   200034 756100                    STQ     WILDC+5,,AUTO
         1 000054   200034 630500                    EPPR0   WILDC+5,,AUTO
         1 000055   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000056   000000 701000 xent               TSX1    HFC$LOCK
         1 000057   000000 011000                    NOP     0
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:29   

      190     9184    1         CALL HFF$TRAPALT ALTRET(TYPTRAP);

   9184  1 000060   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000061   000000 701000 xent               TSX1    HFF$TRAPALT
         1 000062   000264 702000 1                  TSX2    TYPTRAP

      191     9185    2           DO CASE (FPT$CGINFO.TYPFC);

   9185  1 000063   000000 470400 xsym               LDP0    B$PS0$
         1 000064   000000 236100                    LDQ     0,,PR0
         1 000065   000003 772000                    QRL     3
         1 000066   000007 376007                    ANQ     7,DL
         1 000067   000004 116007                    CMPQ    4,DL
         1 000070   000072 602006 1                  TNC     s:9185+7,QL
         1 000071   000223 710000 1                  TRA     s:9237
         1 000072   000223 710000 1                  TRA     s:9237
         1 000073   000076 710000 1                  TRA     s:9188
         1 000074   000130 710000 1                  TRA     s:9195
         1 000075   000130 710000 1                  TRA     s:9195

      192     9186
      193     9187    2             CASE (%CG_INFFC_SELECT#);

      194     9188    3                 DO QX = 0 TO NTYP-1;

   9188  1 000076   200024 450100                    STZ     QX,,AUTO
         1 000077   000124 710000 1                  TRA     s:9192+1

      195     9189    3                 KEY=VLR$CGTYPL.LIST.NAME(QX);

   9189  1 000100   200024 236100                    LDQ     QX,,AUTO
         1 000101   000034 402007                    MPY     28,DL
         1 000102   000000 470400 xsym               LDP0    B$PS1$
         1 000103   040100 100506                    MLR     fill='040'O
         1 000104   000001 000010                    ADSC9   1,Q,PR0                  cn=0,n=8
         1 000105   200012 000010                    ADSC9   KEY,,AUTO                cn=0,n=8
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:30   

      196     9190    3                 CALL KQB$SRCH (KQ$TTREE,KEY,QTN$) ALTRET(NOTYP0);

   9190  1 000106   200006 631500                    EPPR1   QTN$,,AUTO
         1 000107   200036 451500                    STP1    WILDC+7,,AUTO
         1 000110   200012 633500                    EPPR3   KEY,,AUTO
         1 000111   200035 453500                    STP3    WILDC+6,,AUTO
         1 000112   200003 236100                    LDQ     @KQ$CG,,AUTO
         1 000113   000067 036003                    ADLQ    55,DU
         1 000114   200034 756100                    STQ     WILDC+5,,AUTO
         1 000115   200034 630500                    EPPR0   WILDC+5,,AUTO
         1 000116   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000117   000000 701000 xent               TSX1    KQB$SRCH
         1 000120   000246 702000 1                  TSX2    NOTYP0

      197     9191    3                 CALL FILLTYP;

   9191  1 000121   001021 701000 1                  TSX1    FILLTYP
         1 000122   000000 011000                    NOP     0

      198     9192    3                 END;

   9192  1 000123   200024 054100                    AOS     QX,,AUTO
         1 000124   200024 236100                    LDQ     QX,,AUTO
         1 000125   200010 116100                    CMPQ    NTYP,,AUTO
         1 000126   000100 604000 1                  TMI     s:9189
         1 000127   000236 710000 1                  TRA     s:9249

      199     9193
      200     9194    2             CASE (%CG_INFFC_DUMP#,%CG_INFFC_WILD#);

      201     9195    2               IF FPT$CGINFO.TYPFC=%CG_INFFC_WILD#

   9195  1 000130   000003 736000                    QLS     3
         1 000131   000030 116007                    CMPQ    24,DL
         1 000132   000142 601000 1                  TNZ     s:9197

PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:31   
      202     9196    2               THEN CALL INDEX(WILDLEN,'?',VLR$CGTYPL.LIST.NAME(0)) ALTRET(NOQUESTT);

   9196  1 000133   000000 471400 xsym               LDP1    B$PS1$
         1 000134   000000 124500                    SCM     mask='000'O
         1 000135   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         1 000136   000002 000001 2                  ADSC9   2                        cn=0,n=1
         1 000137   200026 000100                    ARG     WILDLEN,,AUTO
         1 000140   000173 606400 1                  TTN     NOQUESTT
         1 000141   000143 710000 1                  TRA     s:9198

      203     9197    2               ELSE WILDLEN = 0;

   9197  1 000142   200026 450100                    STZ     WILDLEN,,AUTO

      204     9198    2               WILDC = SUBSTR(VLR$CGTYPL.LIST.NAME(0),0,WILDLEN);

   9198  1 000143   000000 471400 xsym               LDP1    B$PS1$
         1 000144   200026 720100                    LXL0    WILDLEN,,AUTO
         1 000145   040100 100540                    MLR     fill='040'O
         1 000146   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0
         1 000147   200027 000010                    ADSC9   WILDC,,AUTO              cn=0,n=8

      205     9199    2               QX=0;

   9199  1 000150   200024 450100                    STZ     QX,,AUTO

      206     9200    2               VLR$CGTYPL.FOUND=0;

   9200  1 000151   100000 450100                    STZ     0,,PR1

      207     9201    2               QTN$=KQ$TTREE.HEAD$;

   9201  1 000152   200003 473500                    LDP3    @KQ$CG,,AUTO
         1 000153   300073 236100                    LDQ     59,,PR3
         1 000154   200006 756100                    STQ     QTN$,,AUTO

      208     9202    3                 DO WHILE (QTN$ ~= ADDR(NIL));
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:32   

   9202  1 000155   000220 710000 1                  TRA     s:9233

      209     9203    3                 IF SUBSTR(QTN$->KQ$MTYP.BTN.KEY,0,WILDLEN)=WILDC

   9203  1 000156   200006 470500                    LDP0    QTN$,,AUTO
         1 000157   200026 720100                    LXL0    WILDLEN,,AUTO
         1 000160   040100 106540                    CMPC    fill='040'O
         1 000161   000005 000010                    ADSC9   5,,PR0                   cn=0,n=*X0
         1 000162   200027 000010                    ADSC9   WILDC,,AUTO              cn=0,n=8
         1 000163   000215 601000 1                  TNZ     s:9232

      210     9204    4                 THEN DO;

      211     9205    4                   IF QX >= NTYP THEN

   9205  1 000164   200024 236100                    LDQ     QX,,AUTO
         1 000165   200010 116100                    CMPQ    NTYP,,AUTO
         1 000166   000206 604000 1                  TMI     s:9228

      212     9206    5                     DO;

      213     9207    5                     B$JIT.ERR=E_CGITLS;

   9207  1 000167   000002 236000 0                  LDQ     E_CGITLS
         1 000170   000000 471400 xsym               LDP1    B$JIT$
         1 000171   100012 756100                    STQ     10,,PR1

      214     9208        /*E* ERROR:   KQI-E$CGITLS-E
      215     9209             MESSAGE: Insufficient M$CGINFO TYPE list space
      216     9210             MESSAGE1: The TYPLIST area specified in your M$CGINFO service
      217     9211                       is not large enough to hold all the message types
      218     9212                       you requested.  All that it would hold have been
      219     9213                       returned to you. */
      220     9214    6                       DO WHILE('0'B);

   9214  1 000172   000176 710000 1                  TRA     s:9224
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:33   

      221     9215    6   NOQUESTT:           B$JIT.ERR=E_CGIWILD;

   9215  1 000173   000003 236000 0     NOQUESTT     LDQ     E_CGIWILD
         1 000174   000000 470400 xsym               LDP0    B$JIT$
         1 000175   000012 756100                    STQ     10,,PR0

      222     9216        /*E* ERROR:   KQI-E$CGIWILD-E
      223     9217             MESSAGE: '?' not found as trailing character of TYPE or STATION
      224     9218             MESSAGE1: You specified TYPFC=WILD but did not supply a wildcarded
      225     9219                       type in VLR_CGTYPL.LIST.NAME(0), or
      226     9220                       you specified STAFC=WILD but did not supply a wildcarded
      227     9221                       station in VLR_CGSTAL.LIST.NAME(0). */
      228     9222    6                       END;

      229     9223                          %UNLOCK (G=KQ$TTREE.GATE);

   9224  1 000176   200003 236100                    LDQ     @KQ$CG,,AUTO
         1 000177   000067 036003                    ADLQ    55,DU
         1 000200   200034 756100                    STQ     WILDC+5,,AUTO
         1 000201   200034 630500                    EPPR0   WILDC+5,,AUTO
         1 000202   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000203   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000204   000000 011000                    NOP     0

      230     9226    5                     ALTRETURN;

   9226  1 000205   000000 702200 xent               TSX2  ! X66_AALT

      231     9227    5                     END;
      232     9228    4                   VLR$CGTYPL.FOUND=VLR$CGTYPL.FOUND+1;

   9228  1 000206   000000 471400 xsym               LDP1    B$PS1$
         1 000207   100000 235100                    LDA     0,,PR1
         1 000210   000001 035007                    ADLA    1,DL
         1 000211   100000 755100                    STA     0,,PR1

PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:34   
      233     9229    4                   CALL FILLTYP;

   9229  1 000212   001021 701000 1                  TSX1    FILLTYP
         1 000213   000000 011000                    NOP     0

      234     9230    4                   QX=QX+1;

   9230  1 000214   200024 054100                    AOS     QX,,AUTO

      235     9231    4                   END;

      236     9232    3                 QTN$=QTN$->KQ$MTYP.BTN.FLINK$;

   9232  1 000215   200006 470500                    LDP0    QTN$,,AUTO
         1 000216   000004 236100                    LDQ     4,,PR0
         1 000217   200006 756100                    STQ     QTN$,,AUTO

      237     9233    3                 END;

   9233  1 000220   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000221   000156 601000 1                  TNZ     s:9203
         1 000222   000236 710000 1                  TRA     s:9249

      238     9234
      239     9235    2             CASE (ELSE);

      240     9236                    %UNLOCK (G=KQ$TTREE.GATE);

   9237  1 000223   200003 236100                    LDQ     @KQ$CG,,AUTO
         1 000224   000067 036003                    ADLQ    55,DU
         1 000225   200034 756100                    STQ     WILDC+5,,AUTO
         1 000226   200034 630500                    EPPR0   WILDC+5,,AUTO
         1 000227   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000230   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000231   000000 011000                    NOP     0

   9237  1 000232                       BADOPT       null
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:35   
      241     9239    2   BADOPT:     ;
      242     9240    2               B$JIT.ERR=E_CGUAFC;

   9240  1 000232   000006 236000 0                  LDQ     E_CGUAFC
         1 000233   000000 470400 xsym               LDP0    B$JIT$
         1 000234   000012 756100                    STQ     10,,PR0

      243     9241        /*E* ERROR:   KQI-E$CGUAFC-E
      244     9242             MESSAGE: Unknown M$CGINFO function code
      245     9243             MESSAGE1: The STAFC or TYPFC code in your M$CGINFO FPT is
      246     9244                       unknown. */
      247     9245    2               ALTRETURN;

   9245  1 000235   000000 702200 xent               TSX2  ! X66_AALT

      248     9246
      249     9247    2           END; /*CASE FPT$CGINFO.TYPFC*/

      250     9248              %UNLOCK (G=KQ$TTREE.GATE);

   9249  1 000236   200003 236100                    LDQ     @KQ$CG,,AUTO
         1 000237   000067 036003                    ADLQ    55,DU
         1 000240   200034 756100                    STQ     WILDC+5,,AUTO
         1 000241   200034 630500                    EPPR0   WILDC+5,,AUTO
         1 000242   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000243   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000244   000000 011000                    NOP     0

      251     9251    1         GOTO NOTYPL;

   9251  1 000245   000277 710000 1                  TRA     NOTYPL

   9240  1 000246                       NOTYP0       null
      252     9252    1   NOTYP0:;
      253     9253    1         CALL HFF$TRAPALT;

   9253  1 000246   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:36   
         1 000247   000000 701000 xent               TSX1    HFF$TRAPALT
         1 000250   000000 011000                    NOP     0

      254     9254              %UNLOCK (G=KQ$TTREE.GATE);

   9255  1 000251   200003 236100                    LDQ     @KQ$CG,,AUTO
         1 000252   000067 036003                    ADLQ    55,DU
         1 000253   200034 756100                    STQ     WILDC+5,,AUTO
         1 000254   200034 630500                    EPPR0   WILDC+5,,AUTO
         1 000255   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000256   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000257   000000 011000                    NOP     0

      255     9257    1         B$JIT.ERR=E_CGAFNT;

   9257  1 000260   000007 236000 0                  LDQ     E_CGAFNT
         1 000261   000000 470400 xsym               LDP0    B$JIT$
         1 000262   000012 756100                    STQ     10,,PR0

      256     9258        /*E* ERROR:   KQI-E$CGAFNT-E
      257     9259             MESSAGE: M$CGINFO can't find that message type
      258     9260             MESSAGE1: One of the message types in your M$CGINFO
      259     9261                       service's TYPLIST could not be found. */
      260     9262    1         ALTRETURN;

   9262  1 000263   000000 702200 xent               TSX2  ! X66_AALT

   9257  1 000264                       TYPTRAP      null
      261     9263    1   TYPTRAP:;
      262     9264              %UNLOCK (G=KQ$TTREE.GATE);

   9265  1 000264   200003 236100                    LDQ     @KQ$CG,,AUTO
         1 000265   000067 036003                    ADLQ    55,DU
         1 000266   200034 756100                    STQ     WILDC+5,,AUTO
         1 000267   200034 630500                    EPPR0   WILDC+5,,AUTO
         1 000270   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000271   000000 701000 xent               TSX1    HFC$UNLOCK
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:37   
         1 000272   000000 011000                    NOP     0

      263     9267    1         B$JIT.ERR=E_CGTTRP;

   9267  1 000273   000004 236000 0                  LDQ     E_CGTTRP
         1 000274   000000 470400 xsym               LDP0    B$JIT$
         1 000275   000012 756100                    STQ     10,,PR0

      264     9268        /*E* ERROR:   KQI-E$CGTTRP-E
      265     9269             MESSAGE: Bad TYPLIST or QLIST area specified by M$CGINFO
      266     9270             MESSAGE1: Either the TYPLIST or QLIST area specified by your
      267     9271                       M$CGINFO service is inaccessible. */
      268     9272    1         ALTRETURN;

   9272  1 000276   000000 702200 xent               TSX2  ! X66_AALT

   9267  1 000277                       NOTYPL       null
      269     9273    1   NOTYPL:;
      270     9274        %EJECT;
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:38   
      271     9275        /**/
      272     9276
      273     9277                 /****************************************
      274     9278                  *                                      *
      275     9279                  *        PROCESS STA LIST              *
      276     9280                  *                                      *
      277     9281                  ****************************************/
      278     9282
      279     9283    1         CALL HFF$DSIZ (2,DSIZ) ALTRET(NOSTAL);

   9283  1 000277   200007 630500                    EPPR0   DSIZ,,AUTO
         1 000300   200035 450500                    STP0    WILDC+6,,AUTO
         1 000301   000003 236000 2                  LDQ     3
         1 000302   200034 756100                    STQ     WILDC+5,,AUTO
         1 000303   200034 630500                    EPPR0   WILDC+5,,AUTO
         1 000304   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000305   000000 701000 xent               TSX1    HFF$DSIZ
         1 000306   000562 702000 1                  TSX2    NOSTAL

      280     9284    1         NSTA=(DSIZ-4)/LENGTHC(VLR$CGSTAL.LIST(0));

   9284  1 000307   200007 236100                    LDQ     DSIZ,,AUTO
         1 000310   000004 136007                    SBLQ    4,DL
         1 000311   000040 506007                    DIV     32,DL
         1 000312   200016 756100                    STQ     NSTA,,AUTO

      281     9285    1         IF NSTA = 0 THEN GOTO NOSTAL;

   9285  1 000313   000000 116003                    CMPQ    0,DU
         1 000314   000562 600000 1                  TZE     NOSTAL

      282     9286    1         IF  QLIST ~= 0

   9286  1 000315   200023 235100                    LDA     QLIST,,AUTO
         1 000316   000324 600000 1                  TZE     s:9290
         1 000317   200003 470500                    LDP0    @KQ$CG,,AUTO
         1 000320   000106 235100                    LDA     70,,PR0
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:39   
         1 000321   000324 600000 1                  TZE     s:9290

      283     9287    1         AND KQ$CG.QISS THEN
      284     9288    1          IF NQ < NSTA THEN GOTO IQLS;

   9288  1 000322   200025 116100                    CMPQ    NQ,,AUTO
         1 000323   000045 605400 1                  TPNZ    IQLS

      285     9289              %LOCK (G=KQ$STREE.GATE);

   9290  1 000324   200003 236100                    LDQ     @KQ$CG,,AUTO
         1 000325   000075 036003                    ADLQ    61,DU
         1 000326   200034 756100                    STQ     WILDC+5,,AUTO
         1 000327   200034 630500                    EPPR0   WILDC+5,,AUTO
         1 000330   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000331   000000 701000 xent               TSX1    HFC$LOCK
         1 000332   000000 011000                    NOP     0

      286     9292    1         CALL HFF$TRAPALT ALTRET(STATRAP);

   9292  1 000333   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000334   000000 701000 xent               TSX1    HFF$TRAPALT
         1 000335   000547 702000 1                  TSX2    STATRAP

      287     9293
      288     9294    2           DO CASE (FPT$CGINFO.STAFC);

   9294  1 000336   000000 470400 xsym               LDP0    B$PS0$
         1 000337   000000 720100                    LXL0    0,,PR0
         1 000340   000007 360003                    ANX0    7,DU
         1 000341   000004 100003                    CMPX0   4,DU
         1 000342   000344 602010 1                  TNC     s:9294+6,X0
         1 000343   000511 710000 1                  TRA     s:9346
         1 000344   000511 710000 1                  TRA     s:9346
         1 000345   000350 710000 1                  TRA     s:9297
         1 000346   000402 710000 1                  TRA     s:9304
         1 000347   000402 710000 1                  TRA     s:9304
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:40   

      289     9295
      290     9296    2             CASE (%CG_INFFC_SELECT#);

      291     9297    3                 DO QX = 0 TO NSTA-1;

   9297  1 000350   200024 450100                    STZ     QX,,AUTO
         1 000351   000376 710000 1                  TRA     s:9301+1

      292     9298    3                 KEY=VLR$CGSTAL.LIST.NAME(QX);

   9298  1 000352   200024 235100                    LDA     QX,,AUTO
         1 000353   000005 735000                    ALS     5
         1 000354   000000 470400 xsym               LDP0    B$PS2$
         1 000355   040100 100505                    MLR     fill='040'O
         1 000356   000001 000010                    ADSC9   1,A,PR0                  cn=0,n=8
         1 000357   200012 000010                    ADSC9   KEY,,AUTO                cn=0,n=8

      293     9299    3                 CALL KQB$SRCH (KQ$STREE,KEY,QTN$) ALTRET(NOSTA0);

   9299  1 000360   200006 631500                    EPPR1   QTN$,,AUTO
         1 000361   200036 451500                    STP1    WILDC+7,,AUTO
         1 000362   200012 633500                    EPPR3   KEY,,AUTO
         1 000363   200035 453500                    STP3    WILDC+6,,AUTO
         1 000364   200003 236100                    LDQ     @KQ$CG,,AUTO
         1 000365   000075 036003                    ADLQ    61,DU
         1 000366   200034 756100                    STQ     WILDC+5,,AUTO
         1 000367   200034 630500                    EPPR0   WILDC+5,,AUTO
         1 000370   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000371   000000 701000 xent               TSX1    KQB$SRCH
         1 000372   000531 702000 1                  TSX2    NOSTA0

      294     9300    3                 CALL FILLSTA ALTRET(NOSTA0);

   9300  1 000373   001101 701000 1                  TSX1    FILLSTA
         1 000374   000531 702000 1                  TSX2    NOSTA0

PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:41   
      295     9301    3                 END;

   9301  1 000375   200024 054100                    AOS     QX,,AUTO
         1 000376   200024 236100                    LDQ     QX,,AUTO
         1 000377   200016 116100                    CMPQ    NSTA,,AUTO
         1 000400   000352 604000 1                  TMI     s:9298
         1 000401   000521 710000 1                  TRA     s:9352

      296     9302
      297     9303    2             CASE (%CG_INFFC_DUMP#,%CG_INFFC_WILD#);

      298     9304    2               IF FPT$CGINFO.STAFC=%CG_INFFC_WILD#

   9304  1 000402   000000 236100                    LDQ     0,,PR0
         1 000403   000007 376007                    ANQ     7,DL
         1 000404   000003 116007                    CMPQ    3,DL
         1 000405   000415 601000 1                  TNZ     s:9306

      299     9305    2               THEN CALL INDEX(WILDLEN,'?',VLR$CGSTAL.LIST.NAME(0)) ALTRET(NOQUESTS);

   9305  1 000406   000000 471400 xsym               LDP1    B$PS2$
         1 000407   000000 124500                    SCM     mask='000'O
         1 000410   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         1 000411   000002 000001 2                  ADSC9   2                        cn=0,n=1
         1 000412   200026 000100                    ARG     WILDLEN,,AUTO
         1 000413   000461 606400 1                  TTN     NOQUESTS
         1 000414   000416 710000 1                  TRA     s:9307

      300     9306    2               ELSE WILDLEN = 0;

   9306  1 000415   200026 450100                    STZ     WILDLEN,,AUTO

      301     9307    2               WILDC = SUBSTR(VLR$CGSTAL.LIST.NAME(0),0,WILDLEN);

   9307  1 000416   000000 471400 xsym               LDP1    B$PS2$
         1 000417   200026 721100                    LXL1    WILDLEN,,AUTO
         1 000420   040100 100540                    MLR     fill='040'O
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:42   
         1 000421   100001 000011                    ADSC9   1,,PR1                   cn=0,n=*X1
         1 000422   200027 000010                    ADSC9   WILDC,,AUTO              cn=0,n=8

      302     9308    2               QX=0;

   9308  1 000423   200024 450100                    STZ     QX,,AUTO

      303     9309    2               VLR$CGSTAL.FOUND=0;

   9309  1 000424   100000 450100                    STZ     0,,PR1

      304     9310    2               QTN$=KQ$STREE.HEAD$;

   9310  1 000425   200003 473500                    LDP3    @KQ$CG,,AUTO
         1 000426   300101 236100                    LDQ     65,,PR3
         1 000427   200006 756100                    STQ     QTN$,,AUTO

      305     9311    3                 DO WHILE (QTN$ ~= ADDR(NIL));

   9311  1 000430   000506 710000 1                  TRA     s:9342

      306     9312    3                 IF SUBSTR(QTN$->KQ$MTYP.BTN.KEY,0,WILDLEN)=WILDC

   9312  1 000431   200006 470500                    LDP0    QTN$,,AUTO
         1 000432   200026 720100                    LXL0    WILDLEN,,AUTO
         1 000433   040100 106540                    CMPC    fill='040'O
         1 000434   000005 000010                    ADSC9   5,,PR0                   cn=0,n=*X0
         1 000435   200027 000010                    ADSC9   WILDC,,AUTO              cn=0,n=8
         1 000436   000503 601000 1                  TNZ     s:9341

      307     9313    4                 THEN DO;

      308     9314    4                   IF NOT ( QTN$->KQ$STA.LDCT$~=ADDR(NIL)

   9314  1 000437   000010 236100                    LDQ     8,,PR0
         1 000440   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000441   000452 600000 1                  TZE     s:9319
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:43   
         1 000442   000010 471500                    LDP1    8,,PR0
         1 000443   100015 721100                    LXL1    13,,PR1
         1 000444   000452 601000 1                  TNZ     s:9319
         1 000445   000020 236100                    LDQ     16,,PR0
         1 000446   020000 316003                    CANQ    8192,DU
         1 000447   000452 601000 1                  TNZ     s:9319
         1 000450   040000 316003                    CANQ    16384,DU
         1 000451   000503 601000 1                  TNZ     s:9341

      309     9315    4                   AND QTN$->KQ$STA.LDCT$->NK$LDCT.RLCID.LDCTX=0
      310     9316    4                   AND QTN$->KQ$STA.PERM='0'B AND QTN$->KQ$STA.TERM )
      311     9317    5                   THEN DO;     /* Don't tell about terminals that have not yet     */

      312     9318                                     /* completed connection (unless they are PERManent) */
      313     9319    5                     IF QX >= NSTA THEN

   9319  1 000452   200024 236100                    LDQ     QX,,AUTO
         1 000453   200016 116100                    CMPQ    NSTA,,AUTO
         1 000454   000474 604000 1                  TMI     s:9336

      314     9320    6                       DO;

      315     9321    6                       B$JIT.ERR=E_CGISLS;

   9321  1 000455   000001 236000 0                  LDQ     E_CGISLS
         1 000456   000000 471400 xsym               LDP1    B$JIT$
         1 000457   100012 756100                    STQ     10,,PR1

      316     9322        /*E* ERROR:   KQI-E$CGISLS-E
      317     9323             MESSAGE: Insufficient M$CGINFO STATION list space
      318     9324             MESSAGE1: The STALIST area specified in your M$CGINFO service
      319     9325                       is not large enough to hold all the stations you
      320     9326                       requested.  All that it would hold have been
      321     9327                       returned to you. */
      322     9328    7                         DO WHILE('0'B);

   9328  1 000460   000464 710000 1                  TRA     s:9332
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:44   

      323     9329    7   NOQUESTS:             B$JIT.ERR = E_CGIWILD;

   9329  1 000461   000003 236000 0     NOQUESTS     LDQ     E_CGIWILD
         1 000462   000000 470400 xsym               LDP0    B$JIT$
         1 000463   000012 756100                    STQ     10,,PR0

      324     9330    7                         END;

      325     9331                            %UNLOCK (G=KQ$STREE.GATE);

   9332  1 000464   200003 236100                    LDQ     @KQ$CG,,AUTO
         1 000465   000075 036003                    ADLQ    61,DU
         1 000466   200034 756100                    STQ     WILDC+5,,AUTO
         1 000467   200034 630500                    EPPR0   WILDC+5,,AUTO
         1 000470   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000471   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000472   000000 011000                    NOP     0

      326     9334    6                       ALTRETURN;

   9334  1 000473   000000 702200 xent               TSX2  ! X66_AALT

      327     9335    6                       END;
      328     9336    5                     VLR$CGSTAL.FOUND=VLR$CGSTAL.FOUND+1;

   9336  1 000474   000000 471400 xsym               LDP1    B$PS2$
         1 000475   100000 235100                    LDA     0,,PR1
         1 000476   000001 035007                    ADLA    1,DL
         1 000477   100000 755100                    STA     0,,PR1

      329     9337    5                     CALL FILLSTA;

   9337  1 000500   001101 701000 1                  TSX1    FILLSTA
         1 000501   000000 011000                    NOP     0

      330     9338    5                     QX=QX+1;
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:45   

   9338  1 000502   200024 054100                    AOS     QX,,AUTO

      331     9339    5                     END;

      332     9340    4                   END;

      333     9341    3                 QTN$=QTN$->KQ$STA.BTN.FLINK$;

   9341  1 000503   200006 470500                    LDP0    QTN$,,AUTO
         1 000504   000004 236100                    LDQ     4,,PR0
         1 000505   200006 756100                    STQ     QTN$,,AUTO

      334     9342    3                 END;

   9342  1 000506   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000507   000431 601000 1                  TNZ     s:9312
         1 000510   000521 710000 1                  TRA     s:9352

      335     9343
      336     9344    2             CASE (ELSE);

      337     9345                    %UNLOCK (G=KQ$STREE.GATE);

   9346  1 000511   200003 236100                    LDQ     @KQ$CG,,AUTO
         1 000512   000075 036003                    ADLQ    61,DU
         1 000513   200034 756100                    STQ     WILDC+5,,AUTO
         1 000514   200034 630500                    EPPR0   WILDC+5,,AUTO
         1 000515   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000516   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000517   000000 011000                    NOP     0

      338     9348    2               GOTO BADOPT;

   9348  1 000520   000232 710000 1                  TRA     BADOPT

      339     9349
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:46   
      340     9350    2           END; /*CASE FPT$CGINFO.STAFC*/

      341     9351              %UNLOCK (G=KQ$STREE.GATE);

   9352  1 000521   200003 236100                    LDQ     @KQ$CG,,AUTO
         1 000522   000075 036003                    ADLQ    61,DU
         1 000523   200034 756100                    STQ     WILDC+5,,AUTO
         1 000524   200034 630500                    EPPR0   WILDC+5,,AUTO
         1 000525   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000526   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000527   000000 011000                    NOP     0

      342     9354    1         GOTO NOSTAL;

   9354  1 000530   000562 710000 1                  TRA     NOSTAL

   9350  1 000531                       NOSTA0       null
      343     9355    1   NOSTA0:;
      344     9356    1         CALL HFF$TRAPALT;

   9356  1 000531   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000532   000000 701000 xent               TSX1    HFF$TRAPALT
         1 000533   000000 011000                    NOP     0

      345     9357              %UNLOCK (G=KQ$STREE.GATE);

   9358  1 000534   200003 236100                    LDQ     @KQ$CG,,AUTO
         1 000535   000075 036003                    ADLQ    61,DU
         1 000536   200034 756100                    STQ     WILDC+5,,AUTO
         1 000537   200034 630500                    EPPR0   WILDC+5,,AUTO
         1 000540   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000541   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000542   000000 011000                    NOP     0

      346     9360    1         B$JIT.ERR=E_CGAFNS;

   9360  1 000543   000010 236000 0                  LDQ     E_CGAFNS
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:47   
         1 000544   000000 470400 xsym               LDP0    B$JIT$
         1 000545   000012 756100                    STQ     10,,PR0

      347     9361        /*E* ERROR:   KQI-E$CGAFNS-E
      348     9362             MESSAGE: M$CGINFO can't find that station
      349     9363             MESSAGE1: One of the stations in your M$CGINFO
      350     9364                       service's STALIST could not be found. */
      351     9365    1         ALTRETURN;

   9365  1 000546   000000 702200 xent               TSX2  ! X66_AALT

   9360  1 000547                       STATRAP      null
      352     9366    1   STATRAP:;
      353     9367              %UNLOCK (G=KQ$STREE.GATE);

   9368  1 000547   200003 236100                    LDQ     @KQ$CG,,AUTO
         1 000550   000075 036003                    ADLQ    61,DU
         1 000551   200034 756100                    STQ     WILDC+5,,AUTO
         1 000552   200034 630500                    EPPR0   WILDC+5,,AUTO
         1 000553   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000554   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000555   000000 011000                    NOP     0

      354     9370    1         B$JIT.ERR=E_CGSTRP;

   9370  1 000556   000005 236000 0                  LDQ     E_CGSTRP
         1 000557   000000 470400 xsym               LDP0    B$JIT$
         1 000560   000012 756100                    STQ     10,,PR0

      355     9371        /*E* ERROR:   KQI-E$CGSTRP-E
      356     9372             MESSAGE: Bad STALIST or QLIST area specified by M$CGINFO
      357     9373             MESSAGE1: Either the STALIST or QLIST area specified by your
      358     9374                       M$CGINFO service is inaccessible. */
      359     9375    1         ALTRETURN;

   9375  1 000561   000000 702200 xent               TSX2  ! X66_AALT

PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:48   
   9370  1 000562                       NOSTAL       null
      360     9376    1   NOSTAL:;
      361     9377        %EJECT;
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:49   
      362     9378        /**/
      363     9379
      364     9380                 /****************************************
      365     9381                  *                                      *
      366     9382                  *        PROCESS CONTROL PARAMS        *
      367     9383                  *                                      *
      368     9384                  ****************************************/
      369     9385
      370     9386    1         CALL HFF$NILERASE (3) ALTRET(NOCTL);

   9386  1 000562   000004 630400 2                  EPPR0   4
         1 000563   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000564   000000 701000 xent               TSX1    HFF$NILERASE
         1 000565   000573 702000 1                  TSX2    NOCTL

      371     9387    1         VLR$CGCP=KQ$CG.AUCTL;

   9387  1 000566   200003 470500                    LDP0    @KQ$CG,,AUTO
         1 000567   000000 471400 xsym               LDP1    B$PS3$
         1 000570   000100 100500                    MLR     fill='000'O
         1 000571   000125 000120                    ADSC9   85,,PR0                  cn=0,n=80
         1 000572   100000 000120                    ADSC9   0,,PR1                   cn=0,n=80

   9387  1 000573                       NOCTL        null
      372     9388    1   NOCTL:;
      373     9389                 /****************************************
      374     9390                  *                                      *
      375     9391                  *        PROCESS VLP_SETSTA            *
      376     9392                  *                                      *
      377     9393                  ****************************************/
      378     9394
      379     9395    1         CALL HFF$NILERASE (4) ALTRET(NOSETSTA);

   9395  1 000573   000005 630400 2                  EPPR0   5
         1 000574   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000575   000000 701000 xent               TSX1    HFF$NILERASE
         1 000576   000604 702000 1                  TSX2    NOSETSTA
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:50   

      380     9396    1         VLR$SETSTA=KQ$CG.SETSTA;

   9396  1 000577   200003 470500                    LDP0    @KQ$CG,,AUTO
         1 000600   000000 471400 xsym               LDP1    B$PS4$
         1 000601   000100 100500                    MLR     fill='000'O
         1 000602   000151 000060                    ADSC9   105,,PR0                 cn=0,n=48
         1 000603   100000 000060                    ADSC9   0,,PR1                   cn=0,n=48

   9396  1 000604                       NOSETSTA     null
      381     9397    1   NOSETSTA:;
      382     9398                 /****************************************
      383     9399                  *                                      *
      384     9400                  *        PROCESS STATS                 *
      385     9401                  *                                      *
      386     9402                  ****************************************/
      387     9403
      388     9404    1         CALL HFF$NILERASE (5) ALTRET(NOSTATS);

   9404  1 000604   000006 630400 2                  EPPR0   6
         1 000605   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000606   000000 701000 xent               TSX1    HFF$NILERASE
         1 000607   000626 702000 1                  TSX2    NOSTATS

      389     9405    1         KQ$CG.STATS.WRDSFREE = (KQ$CG.UGRANS+KQ$CG.NGAVAL)*1024 -

   9405  1 000610   200003 470500                    LDP0    @KQ$CG,,AUTO
         1 000611   000220 236100                    LDQ     144,,PR0
         1 000612   000217 036100                    ADLQ    143,,PR0
         1 000613   000012 736000                    QLS     10
         1 000614   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 000615   000001 036007                    ADLQ    1,DL
         1 000616   000202 036100                    ADLQ    130,,PR0
         1 000617   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 000620   000001 036007                    ADLQ    1,DL
         1 000621   000203 756100                    STQ     131,,PR0

PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:51   
      390     9406    1         KQ$CG.STATS.WRDSUSED;
      391     9407    1         VLR$STATS=KQ$CG.STATS;

   9407  1 000622   000000 471400 xsym               LDP1    B$PS5$
         1 000623   000100 100500                    MLR     fill='000'O
         1 000624   000165 000110                    ADSC9   117,,PR0                 cn=0,n=72
         1 000625   100000 000110                    ADSC9   0,,PR1                   cn=0,n=72

   9407  1 000626                       NOSTATS      null
      392     9408    1   NOSTATS:;
      393     9409                 /****************************************
      394     9410                  *                                      *
      395     9411                  *        PROCESS HOLDSTA               *
      396     9412                  *                                      *
      397     9413                  ****************************************/
      398     9414
      399     9415    1         CALL HFF$NILERASE (9) ALTRET(NOHOLDS);

   9415  1 000626   000007 630400 2                  EPPR0   7
         1 000627   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000630   000000 701000 xent               TSX1    HFF$NILERASE
         1 000631   000665 702000 1                  TSX2    NOHOLDS

      400     9416    1         B$PS9$->VLP$STATION=KC_VLPSTATION;

   9416  1 000632   000000 470400 xsym               LDP0    B$PS9$
         1 000633   000100 100400                    MLR     fill='000'O
         1 000634   000000 000040 xsym               ADSC9   KC_VLPSTATION            cn=0,n=32
         1 000635   000000 000040                    ADSC9   0,,PR0                   cn=0,n=32

      401     9417              %LOCK (G=KQ$STREE.GATE);

   9418  1 000636   200003 236100                    LDQ     @KQ$CG,,AUTO
         1 000637   000075 036003                    ADLQ    61,DU
         1 000640   200034 756100                    STQ     WILDC+5,,AUTO
         1 000641   200034 630500                    EPPR0   WILDC+5,,AUTO
         1 000642   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:52   
         1 000643   000000 701000 xent               TSX1    HFC$LOCK
         1 000644   000000 011000                    NOP     0

      402     9420    1         IF KQ$CG.HOLDSTA$ ~= ADDR(NIL) THEN

   9420  1 000645   200003 470500                    LDP0    @KQ$CG,,AUTO
         1 000646   000124 236100                    LDQ     84,,PR0
         1 000647   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000650   000656 600000 1                  TZE     s:9423

      403     9421    1          B$PS9$->VLP$STATION.STATION=KQ$CG.HOLDSTA$->KQ$STA.BTN.KEY;

   9421  1 000651   000124 471500                    LDP1    84,,PR0
         1 000652   000000 473400 xsym               LDP3    B$PS9$
         1 000653   040100 100500                    MLR     fill='040'O
         1 000654   100005 000010                    ADSC9   5,,PR1                   cn=0,n=8
         1 000655   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8

      404     9422              %UNLOCK (G=KQ$STREE.GATE);

   9423  1 000656   200003 236100                    LDQ     @KQ$CG,,AUTO
         1 000657   000075 036003                    ADLQ    61,DU
         1 000660   200034 756100                    STQ     WILDC+5,,AUTO
         1 000661   200034 630500                    EPPR0   WILDC+5,,AUTO
         1 000662   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000663   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000664   000000 011000                    NOP     0

   9420  1 000665                       NOHOLDS      null
      405     9425    1   NOHOLDS:;
      406     9426                 /****************************************
      407     9427                  *                                      *
      408     9428                  *        PROCESS JRNLSTA               *
      409     9429                  *                                      *
      410     9430                  ****************************************/
      411     9431
      412     9432    1         CALL HFF$NILERASE (10) ALTRET(NOJRNLS);
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:53   

   9432  1 000665   000010 630400 2                  EPPR0   8
         1 000666   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000667   000000 701000 xent               TSX1    HFF$NILERASE
         1 000670   000724 702000 1                  TSX2    NOJRNLS

      413     9433    1         B$PS10$->VLP$STATION=KC_VLPSTATION;

   9433  1 000671   000000 470400 xsym               LDP0    B$PS10$
         1 000672   000100 100400                    MLR     fill='000'O
         1 000673   000000 000040 xsym               ADSC9   KC_VLPSTATION            cn=0,n=32
         1 000674   000000 000040                    ADSC9   0,,PR0                   cn=0,n=32

      414     9434              %LOCK (G=KQ$STREE.GATE);

   9435  1 000675   200003 236100                    LDQ     @KQ$CG,,AUTO
         1 000676   000075 036003                    ADLQ    61,DU
         1 000677   200034 756100                    STQ     WILDC+5,,AUTO
         1 000700   200034 630500                    EPPR0   WILDC+5,,AUTO
         1 000701   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000702   000000 701000 xent               TSX1    HFC$LOCK
         1 000703   000000 011000                    NOP     0

      415     9437    1         IF KQ$CG.JRNLSTA$ ~= ADDR(NIL) THEN

   9437  1 000704   200003 470500                    LDP0    @KQ$CG,,AUTO
         1 000705   000210 236100                    LDQ     136,,PR0
         1 000706   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000707   000715 600000 1                  TZE     s:9440

      416     9438    1          B$PS10$->VLP$STATION.STATION=KQ$CG.JRNLSTA$->KQ$STA.BTN.KEY;

   9438  1 000710   000210 471500                    LDP1    136,,PR0
         1 000711   000000 473400 xsym               LDP3    B$PS10$
         1 000712   040100 100500                    MLR     fill='040'O
         1 000713   100005 000010                    ADSC9   5,,PR1                   cn=0,n=8
         1 000714   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:54   

      417     9439              %UNLOCK (G=KQ$STREE.GATE);

   9440  1 000715   200003 236100                    LDQ     @KQ$CG,,AUTO
         1 000716   000075 036003                    ADLQ    61,DU
         1 000717   200034 756100                    STQ     WILDC+5,,AUTO
         1 000720   200034 630500                    EPPR0   WILDC+5,,AUTO
         1 000721   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000722   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000723   000000 011000                    NOP     0

   9437  1 000724                       NOJRNLS      null
      418     9442    1   NOJRNLS:;
      419     9443                 /****************************************
      420     9444                  *                                      *
      421     9445                  *        PROCESS JRNLFID               *
      422     9446                  *                                      *
      423     9447                  ****************************************/
      424     9448
      425     9449    1         CALL HFF$NILERASE (11) ALTRET(NOJF);

   9449  1 000724   000011 630400 2                  EPPR0   9
         1 000725   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000726   000000 701000 xent               TSX1    HFF$NILERASE
         1 000727   001020 702000 1                  TSX2    NOJF

      426     9450              %LOCK (G=KQ$CG.GATE.MISC);

   9451  1 000730   200003 236100                    LDQ     @KQ$CG,,AUTO
         1 000731   000111 036003                    ADLQ    73,DU
         1 000732   200034 756100                    STQ     WILDC+5,,AUTO
         1 000733   200034 630500                    EPPR0   WILDC+5,,AUTO
         1 000734   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000735   000000 701000 xent               TSX1    HFC$LOCK
         1 000736   000000 011000                    NOP     0

      427     9453    1         CALL HFF$TRAPALT ALTRET(BADJF);
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:55   

   9453  1 000737   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000740   000000 701000 xent               TSX1    HFF$TRAPALT
         1 000741   001011 702000 1                  TSX2    BADJF

      428     9454    1         IF KQ$CG.JRNLFID$ = ADDR(NIL) THEN

   9454  1 000742   200003 470500                    LDP0    @KQ$CG,,AUTO
         1 000743   000223 236100                    LDQ     147,,PR0
         1 000744   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000745   000753 601000 1                  TNZ     s:9458

      429     9455    1          B$PS11$->VLP$JRNLFID.L#=0;

   9455  1 000746   000000 471400 xsym               LDP1    B$PS11$
         1 000747   000100 101400                    MRL     fill='000'O
         1 000750   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         1 000751   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2
         1 000752   000776 710000 1                  TRA     s:9462

      430     9456    1         ELSE
      431     9457    2           DO;

      432     9458    2           B$PS11$->VLP$JRNLFID.L#=KQ$CG.JRNLFID$->VLP$JRNLFID.L#;

   9458  1 000753   000223 471500                    LDP1    147,,PR0
         1 000754   000000 473400 xsym               LDP3    B$PS11$
         1 000755   000100 100500                    MLR     fill='000'O
         1 000756   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2
         1 000757   300000 000002                    ADSC9   0,,PR3                   cn=0,n=2

      433     9459    2           B$PS11$->VLP$JRNLFID=KQ$CG.JRNLFID$->VLP$JRNLFID;

   9459  1 000760   000100 100500                    MLR     fill='000'O
         1 000761   300000 000002                    ADSC9   0,,PR3                   cn=0,n=2
         1 000762   200034 000004                    ADSC9   WILDC+5,,AUTO            cn=0,n=4
         1 000763   200034 220100                    LDX0    WILDC+5,,AUTO
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:56   
         1 000764   000002 621010                    EAX1    2,X0
         1 000765   000223 471500                    LDP1    147,,PR0
         1 000766   000100 100500                    MLR     fill='000'O
         1 000767   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2
         1 000770   200035 000004                    ADSC9   WILDC+6,,AUTO            cn=0,n=4
         1 000771   200035 222100                    LDX2    WILDC+6,,AUTO
         1 000772   000002 623012                    EAX3    2,X2
         1 000773   000140 100540                    MLR     fill='000'O
         1 000774   100000 000013                    ADSC9   0,,PR1                   cn=0,n=*X3
         1 000775   300000 000011                    ADSC9   0,,PR3                   cn=0,n=*X1

      434     9460    2           END;

      435     9461              %UNLOCK (G=KQ$CG.GATE.MISC);

   9462  1 000776   200003 236100                    LDQ     @KQ$CG,,AUTO
         1 000777   000111 036003                    ADLQ    73,DU
         1 001000   200034 756100                    STQ     WILDC+5,,AUTO
         1 001001   200034 630500                    EPPR0   WILDC+5,,AUTO
         1 001002   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001003   000000 701000 xent               TSX1    HFC$UNLOCK
         1 001004   000000 011000                    NOP     0

      436     9464    1         CALL HFF$TRAPALT;

   9464  1 001005   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001006   000000 701000 xent               TSX1    HFF$TRAPALT
         1 001007   000000 011000                    NOP     0

      437     9465    1         GOTO NOJF;

   9465  1 001010   001020 710000 1                  TRA     NOJF

   9462  1 001011                       BADJF        null
      438     9466    1   BADJF:;
      439     9467    1         CALL HFF$TRAPALT;

PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:57   
   9467  1 001011   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001012   000000 701000 xent               TSX1    HFF$TRAPALT
         1 001013   000000 011000                    NOP     0

      440     9468    1         B$JIT.ERR=E_BDJFID;

   9468  1 001014   000011 236000 0                  LDQ     E_BDJFID
         1 001015   000000 470400 xsym               LDP0    B$JIT$
         1 001016   000012 756100                    STQ     10,,PR0

      441     9469        /*E* ERROR:   KQI-E$BDJFID-E
      442     9470             MESSAGE: Bad JRNLFID passed to M$CGINFO
      443     9471             MESSAGE1: The JRNFID parameter on your M$CGINFO call is
      444     9472                       insufficiently large to receive the entire journal
      445     9473                       FID of the comgroup. */
      446     9474    1         ALTRETURN;

   9474  1 001017   000000 702200 xent               TSX2  ! X66_AALT

   9468  1 001020                       NOJF         null
      447     9475    1   NOJF: ;
      448     9476    1         RETURN;

   9476  1 001020   000000 702200 xent               TSX2  ! X66_ARET

      449     9477        %EJECT;
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:58   
      450     9478        /**/
      451     9479        /*********************************************************************************
      452     9480        *                                                                                *
      453     9481        *   SSS   U   U  BBBB   RRRR    OOO   U   U  TTTTT   III   N   N  EEEEE   SSS    *
      454     9482        *  S   S  U   U  B   B  R   R  O O O  U   U    T      I    N   N  E      S   S   *
      455     9483        *  S      U   U  B   B  R   R  O O O  U   U    T      I    NN  N  E      S       *
      456     9484        *   SSS   U   U  BBBB   RRRR   O  OO  U   U    T      I    N N N  EEEE    SSS    *
      457     9485        *      S  U   U  B   B  R R    O   O  U   U    T      I    N  NN  E          S   *
      458     9486        *  S   S  U   U  B   B  R  R   O   O  U   U    T      I    N   N  E      S   S   *
      459     9487        *   SSS    UUU   BBBB   R   R   OOO    UUU     T     III   N   N  EEEEE   SSS    *
      460     9488        *                                                                                *
      461     9489        *********************************************************************************/
      462     9490
      463     9491        /***************************************************
      464     9492        ****************************************************/
      465     9493        /*D* NAME:         FILLTYP
      466     9494             PURPOSE:      To fill in a VLR$CGTYPL.LIST entry
      467     9495                           about a message type.
      468     9496        */
      469     9497    1   FILLTYP: PROC ALTRET;  /* !!!Does not ALTRET!!! */

   9497  1 001021   200032 741300       FILLTYP      STX1  ! WILDC+3,,AUTO

      470     9498    2         VLR$CGTYPL.LIST.NAME(QX)=QTN$->KQ$MTYP.BTN.KEY;

   9498  1 001022   200024 236100                    LDQ     QX,,AUTO
         1 001023   000007 402007                    MPY     7,DL
         1 001024   000002 736000                    QLS     2
         1 001025   200006 470500                    LDP0    QTN$,,AUTO
         1 001026   000000 471400 xsym               LDP1    B$PS1$
         1 001027   040106 100500                    MLR     fill='040'O
         1 001030   000005 000010                    ADSC9   5,,PR0                   cn=0,n=8
         1 001031   100001 000010                    ADSC9   1,Q,PR1                  cn=0,n=8

      471     9499    2         VLR$CGTYPL.LIST.PERM(QX)=QTN$->KQ$MTYP.PERM;

   9499  1 001032   200024 236100                    LDQ     QX,,AUTO
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:59   
         1 001033   000007 402007                    MPY     7,DL
         1 001034   200006 470500                    LDP0    QTN$,,AUTO
         1 001035   000000 620006                    EAX0    0,QL
         1 001036   000007 236100                    LDQ     7,,PR0
         1 001037   000003 736000                    QLS     3
         1 001040   100003 676110                    ERQ     3,X0,PR1
         1 001041   000400 376003                    ANQ     256,DU
         1 001042   100003 656110                    ERSQ    3,X0,PR1

      472     9500    2         VLR$CGTYPL.LIST.PRIO(QX)=QTN$->KQ$MTYP.MPRIO;

   9500  1 001043   200006 470500                    LDP0    QTN$,,AUTO
         1 001044   000007 236100                    LDQ     7,,PR0
         1 001045   100003 676110                    ERQ     3,X0,PR1
         1 001046   777000 376003                    ANQ     -512,DU
         1 001047   100003 656110                    ERSQ    3,X0,PR1

      473     9501    2         VLR$CGTYPL.LIST.JOURNAL(QX)=QTN$->KQ$MTYP.JOURNAL;

   9501  1 001050   200006 470500                    LDP0    QTN$,,AUTO
         1 001051   000007 236100                    LDQ     7,,PR0
         1 001052   000001 772000                    QRL     1
         1 001053   100003 676110                    ERQ     3,X0,PR1
         1 001054   000200 376003                    ANQ     128,DU
         1 001055   100003 656110                    ERSQ    3,X0,PR1

      474     9502    2         VLR$CGTYPL.LIST.ONEREPORT(QX)=QTN$->KQ$MTYP.ONEREPORT;

   9502  1 001056   200006 470500                    LDP0    QTN$,,AUTO
         1 001057   000007 236100                    LDQ     7,,PR0
         1 001060   000001 772000                    QRL     1
         1 001061   100003 676110                    ERQ     3,X0,PR1
         1 001062   000100 376003                    ANQ     64,DU
         1 001063   100003 656110                    ERSQ    3,X0,PR1

      475     9503    2         VLR$CGTYPL.LIST.NUMWRITES(QX) = QTN$->KQ$MTYP.NUMWRITES;

PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:60   
   9503  1 001064   200006 470500                    LDP0    QTN$,,AUTO
         1 001065   000010 235100                    LDA     8,,PR0
         1 001066   100004 755110                    STA     4,X0,PR1

      476     9504    2         VLR$CGTYPL.LIST.MAXLATCH(QX)  = QTN$->KQ$MTYP.MAXLATCH;

   9504  1 001067   200006 470500                    LDP0    QTN$,,AUTO
         1 001070   000007 721100                    LXL1    7,,PR0
         1 001071   100005 741110                    STX1    5,X0,PR1

      477     9505    2         IF  QLIST ~= 0

   9505  1 001072   200023 235100                    LDA     QLIST,,AUTO
         1 001073   001077 600000 1                  TZE     s:9508
         1 001074   200003 470500                    LDP0    @KQ$CG,,AUTO
         1 001075   000106 235100                    LDA     70,,PR0
         1 001076   001236 600000 1                  TZE     FILLQ

      478     9506    2         AND KQ$CG.QISS = '0'B THEN
      479     9507    2          GOTO FILLQ;
      480     9508    2         RETURN;

   9508  1 001077   200032 221300                    LDX1  ! WILDC+3,,AUTO
         1 001100   000001 702211                    TSX2  ! 1,X1

      481     9509        /*D* NAME:         FILLSTA
      482     9510             PURPOSE:      To fill in a VLR$CGSTAL.LIST entry
      483     9511                           about a station.
      484     9512        */
      485     9513    2   FILLSTA: ENTRY ALTRET;   /* DOES NOT ALTRET!!! */

   9513  1 001101   200032 741300       FILLSTA      STX1  ! WILDC+3,,AUTO

      486     9514    2         VLR$CGSTAL.LIST.NAME(QX)  =QTN$->KQ$STA.BTN.KEY;

   9514  1 001102   200024 235100                    LDA     QX,,AUTO
         1 001103   000003 735000                    ALS     3
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:61   
         1 001104   000002 735000                    ALS     2
         1 001105   200006 470500                    LDP0    QTN$,,AUTO
         1 001106   000000 471400 xsym               LDP1    B$PS2$
         1 001107   040105 100500                    MLR     fill='040'O
         1 001110   000005 000010                    ADSC9   5,,PR0                   cn=0,n=8
         1 001111   100001 000010                    ADSC9   1,A,PR1                  cn=0,n=8

      487     9515    2         VLR$CGSTAL.LIST.PERM(QX)  =QTN$->KQ$STA.PERM;

   9515  1 001112   200024 235100                    LDA     QX,,AUTO
         1 001113   000003 735000                    ALS     3
         1 001114   200006 470500                    LDP0    QTN$,,AUTO
         1 001115   000020 236100                    LDQ     16,,PR0
         1 001116   000005 772000                    QRL     5
         1 001117   100003 676105                    ERQ     3,AL,PR1
         1 001120   000400 376003                    ANQ     256,DU
         1 001121   100003 656105                    ERSQ    3,AL,PR1

      488     9516    2         VLR$CGSTAL.LIST.PRIO(QX)  =QTN$->KQ$STA.MPRIO;

   9516  1 001122   200006 470500                    LDP0    QTN$,,AUTO
         1 001123   000015 236100                    LDQ     13,,PR0
         1 001124   000011 736000                    QLS     9
         1 001125   100003 676105                    ERQ     3,AL,PR1
         1 001126   777000 376003                    ANQ     -512,DU
         1 001127   100003 656105                    ERSQ    3,AL,PR1

      489     9517    2         VLR$CGSTAL.LIST.MSGCNT(QX)=QTN$->KQ$STA.MLH.COUNT;

   9517  1 001130   200006 470500                    LDP0    QTN$,,AUTO
         1 001131   000000 620005                    EAX0    0,AL
         1 001132   000041 235100                    LDA     33,,PR0
         1 001133   100004 755110                    STA     4,X0,PR1

      490     9518    2         VLR$CGSTAL.LIST.READS (QX)=QTN$->KQ$STA.READS;

   9518  1 001134   200006 470500                    LDP0    QTN$,,AUTO
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:62   
         1 001135   000026 235100                    LDA     22,,PR0
         1 001136   100005 755110                    STA     5,X0,PR1

      491     9519    2         VLR$CGSTAL.LIST.WRITES(QX)=QTN$->KQ$STA.WRITES;

   9519  1 001137   200006 470500                    LDP0    QTN$,,AUTO
         1 001140   000027 235100                    LDA     23,,PR0
         1 001141   100006 755110                    STA     6,X0,PR1

      492     9520    2         VLR$CGSTAL.LIST.AUP(QX)=QTN$->KQ$STA.AUP;

   9520  1 001142   200006 470500                    LDP0    QTN$,,AUTO
         1 001143   000023 236100                    LDQ     19,,PR0
         1 001144   000006 736000                    QLS     6
         1 001145   100003 676110                    ERQ     3,X0,PR1
         1 001146   000040 376003                    ANQ     32,DU
         1 001147   100003 656110                    ERSQ    3,X0,PR1

      493     9521    2         VLR$CGSTAL.LIST.CON   (QX)='0'B;

   9521  1 001150   000012 236000 2                  LDQ     10
         1 001151   100003 356110                    ANSQ    3,X0,PR1

      494     9522    2         VLR$CGSTAL.LIST.ACTIVE(QX)='0'B;

   9522  1 001152   000013 236000 2                  LDQ     11
         1 001153   100003 356110                    ANSQ    3,X0,PR1

      495     9523    2         IF QTN$->KQ$STA.LDCT$ ~= ADDR(NIL) THEN

   9523  1 001154   200006 470500                    LDP0    QTN$,,AUTO
         1 001155   000010 236100                    LDQ     8,,PR0
         1 001156   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001157   001227 600000 1                  TZE     s:9539

      496     9524    3           DO;

PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:63   
      497     9525                %LOCK (G=QTN$->KQ$STA.GATE);

   9526  1 001160   200006 236100                    LDQ     QTN$,,AUTO
         1 001161   000016 036003                    ADLQ    14,DU
         1 001162   200034 756100                    STQ     WILDC+5,,AUTO
         1 001163   200034 630500                    EPPR0   WILDC+5,,AUTO
         1 001164   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001165   000000 701000 xent               TSX1    HFC$LOCK
         1 001166   000000 011000                    NOP     0

      498     9528    3           IF QTN$->KQ$STA.LDCT$ ~= ADDR(NIL) THEN

   9528  1 001167   200006 470500                    LDP0    QTN$,,AUTO
         1 001170   000010 236100                    LDQ     8,,PR0
         1 001171   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001172   001220 600000 1                  TZE     s:9536

      499     9529    4             DO;

      500     9530    4             IF QTN$->KQ$STA.LDCT$->NK$LDCT.RLCID.LDCTX~=0

   9530  1 001173   000010 471500                    LDP1    8,,PR0
         1 001174   100015 720100                    LXL0    13,,PR1
         1 001175   001201 601000 1                  TNZ     s:9532
         1 001176   100006 236100                    LDQ     6,,PR1
         1 001177   002000 316007                    CANQ    1024,DL
         1 001200   001206 600000 1                  TZE     s:9533

      501     9531    4             OR QTN$->KQ$STA.LDCT$->NK$LDCT.DFLG.LOCAL
      502     9532    4             THEN VLR$CGSTAL.LIST.CON(QX)='1'B;

   9532  1 001201   200024 235100                    LDA     QX,,AUTO
         1 001202   000003 735000                    ALS     3
         1 001203   000000 473400 xsym               LDP3    B$PS2$
         1 001204   000200 236003                    LDQ     128,DU
         1 001205   300003 256105                    ORSQ    3,AL,PR3

PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:64   
      503     9533    4             VLR$CGSTAL.LIST.ACTIVE(QX)=QTN$->KQ$STA.LDCT$->NK$LDCT.LKFLG.ACTIVE;

   9533  1 001206   200024 235100                    LDA     QX,,AUTO
         1 001207   000003 735000                    ALS     3
         1 001210   200006 470500                    LDP0    QTN$,,AUTO
         1 001211   000010 471500                    LDP1    8,,PR0
         1 001212   000000 473400 xsym               LDP3    B$PS2$
         1 001213   100011 236100                    LDQ     9,,PR1
         1 001214   000001 736000                    QLS     1
         1 001215   300003 676105                    ERQ     3,AL,PR3
         1 001216   000100 376003                    ANQ     64,DU
         1 001217   300003 656105                    ERSQ    3,AL,PR3

      504     9534    4             END;

      505     9535                %UNLOCK (G=QTN$->KQ$STA.GATE);

   9536  1 001220   200006 236100                    LDQ     QTN$,,AUTO
         1 001221   000016 036003                    ADLQ    14,DU
         1 001222   200034 756100                    STQ     WILDC+5,,AUTO
         1 001223   200034 630500                    EPPR0   WILDC+5,,AUTO
         1 001224   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001225   000000 701000 xent               TSX1    HFC$UNLOCK
         1 001226   000000 011000                    NOP     0

      506     9538    3           END;

      507     9539    2         IF  QLIST ~= 0

   9539  1 001227   200023 235100                    LDA     QLIST,,AUTO
         1 001230   001234 600000 1                  TZE     s:9542
         1 001231   200003 470500                    LDP0    @KQ$CG,,AUTO
         1 001232   000106 235100                    LDA     70,,PR0
         1 001233   001236 601000 1                  TNZ     FILLQ

      508     9540    2         AND KQ$CG.QISS THEN
      509     9541    2          GOTO FILLQ;
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:65   
      510     9542    2         RETURN;

   9542  1 001234   200032 221300                    LDX1  ! WILDC+3,,AUTO
         1 001235   000001 702211                    TSX2  ! 1,X1

   9539  1 001236                       FILLQ        null
      511     9543    2   FILLQ:;
      512     9544    2         VLR$CGQL.LIST.MXACT(QX)  =QTN$->KQ$QTN.MXACT;

   9544  1 001236   200024 236100                    LDQ     QX,,AUTO
         1 001237   000011 402007                    MPY     9,DL
         1 001240   200006 471500                    LDP1    QTN$,,AUTO
         1 001241   100045 235100                    LDA     37,,PR1
         1 001242   000000 473400 xsym               LDP3    B$PS6$
         1 001243   300000 755106                    STA     0,QL,PR3

      513     9545    2         VLR$CGQL.LIST.CNACT(QX)  =QTN$->KQ$QTN.CNACT;

   9545  1 001244   200006 471500                    LDP1    QTN$,,AUTO
         1 001245   100044 235100                    LDA     36,,PR1
         1 001246   300001 755106                    STA     1,QL,PR3

      514     9546    2         VLR$CGQL.LIST.MSGCNT(QX) =QTN$->KQ$QTN.MLH.COUNT;

   9546  1 001247   200006 471500                    LDP1    QTN$,,AUTO
         1 001250   100062 235100                    LDA     50,,PR1
         1 001251   300002 755106                    STA     2,QL,PR3

      515     9547    2         RETURN;

   9547  1 001252   200032 221300                    LDX1  ! WILDC+3,,AUTO
         1 001253   000001 702211                    TSX2  ! 1,X1

E_CGIQLS
 Sect OctLoc
   0     000   132111 021764                                                    ZI..

PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:66   
E_CGISLS
 Sect OctLoc
   0     001   132111 021754                                                    ZI..

E_CGITLS
 Sect OctLoc
   0     002   132111 021744                                                    ZI..

E_CGIWILD
 Sect OctLoc
   0     003   132111 022244                                                    ZI..

E_CGTTRP
 Sect OctLoc
   0     004   132111 021774                                                    ZI..

E_CGSTRP
 Sect OctLoc
   0     005   132111 022004                                                    ZI..

E_CGUAFC
 Sect OctLoc
   0     006   132111 021714                                                    ZI..

E_CGAFNT
 Sect OctLoc
   0     007   132111 022014                                                    ZI..

E_CGAFNS
 Sect OctLoc
   0     010   132111 022024                                                    ZI..

E_BDJFID
 Sect OctLoc
   0     011   132111 022474                                                    ZI..

(unnamed)
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:67   
 Sect OctLoc
   2     000   000010 006000   000003 006000   077040 040040   000004 006000    ........?   ....
   2     004   000005 006000   000006 006000   000007 006000   000013 006000    ................
   2     010   000014 006000   000015 006000   777577 777777   777677 777777    ................
      516     9548    2   END FILLTYP;
      517     9549    1   END KQI$CGINFO;

PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:68   
--  Include file information  --

   KC$CGBLK.:E05TOU  is referenced.
   KI$CP6V_C.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   KC_CP6.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
   KC_ERRORS_C.:E05TOU  is referenced.
   KQ_ERRORS_C.:E05TOU  is referenced.
   UD_SEV_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   KC$CP6V_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   KQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   KQ_MAC_C.:E05TOU  is referenced.
   KQ_SUBS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure KQI$CGINFO.
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:69   

 **** Variables and constants ****

  ****  Section 000 RoData KQI$CGINFO

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    11-0-0/w STRC        r     1 E_BDJFID                  10-0-0/w STRC        r     1 E_CGAFNS
     7-0-0/w STRC        r     1 E_CGAFNT                   0-0-0/w STRC        r     1 E_CGIQLS
     1-0-0/w STRC        r     1 E_CGISLS                   2-0-0/w STRC        r     1 E_CGITLS
     3-0-0/w STRC        r     1 E_CGIWILD                  5-0-0/w STRC        r     1 E_CGSTRP
     4-0-0/w STRC        r     1 E_CGTTRP                   6-0-0/w STRC        r     1 E_CGUAFC

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @KQ$CG                     7-0-0/w SBIN        r     1 DSIZ
    12-0-0/c CHAR(8)     r     1 KEY                       *0-0-0/d STRC(6516)  r     1 KQ$CG
     5-0-0/w PTR         r     1 MTYP$                     25-0-0/w SBIN        r     1 NQ
    16-0-0/w SBIN        r     1 NSTA                      10-0-0/w SBIN        r     1 NTYP
    23-0-0/w UBIN        r     1 QLIST                      6-0-0/w PTR         r     1 QTN$
    24-0-0/w SBIN        r     1 QX                         4-0-0/w PTR         r     1 STA$
    27-0-0/c CHAR(8)     r     1 WILDC                     26-0-0/w SBIN        r     1 WILDLEN

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$PS0$
     0-0-0/w PTR         r     1 B$PS1$                     0-0-0/w PTR         r     1 B$PS10$
     0-0-0/w PTR         r     1 B$PS11$                    0-0-0/w PTR         r     1 B$PS2$
     0-0-0/w PTR         r     1 B$PS3$                     0-0-0/w PTR         r     1 B$PS4$
     0-0-0/w PTR         r     1 B$PS5$                     0-0-0/w PTR         r     1 B$PS6$
     0-0-0/w PTR         r     1 B$PS8$                     0-0-0/w PTR         r     1 B$PS9$
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:70   
     0-0-0/w STRC(288)   r     1 KC_VLPSTATION

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(2088)  r     1 B$JIT                      0-0-0/d STRC(324)   r     1 FPT$CGINFO
     0-0-0/d STRC(360)   r     1 KQ$MTYP                    0-0-0/d STRC(1908)  r     1 KQ$QTN
     0-0-0/d STRC(1296)  r     1 KQ$STA                     0-0-0/d STRC(864)   r     1 NK$LDCT
     0-0-0/c ASTR(18)    r     1 VLP$JRNLFID                0-0-0/w STRC(288)   r     1 VLP$STATION
     0-0-0/d STRC(720)   r     1 VLR$CGCP                   0-0-0/d STRC(324)   r     1 VLR$CGQL
     0-0-0/d STRC(324)   r     1 VLR$CGSTAL                 0-0-0/d STRC(288)   r     1 VLR$CGTYPL
     0-0-0/w STRC(432)   r     1 VLR$SETSTA                 0-0-0/d STRC(648)   r     1 VLR$STATS


   Procedure KQI$CGINFO requires 684 words for executable code.
   Procedure KQI$CGINFO requires 32 words of local(AUTO) storage.

    No errors detected in file KQI$INFO.:E05TSI    .
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:71   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:72   
          MINI XREF LISTING

B$JIT.ERR
      8861**DCL      9173<<ASSIGN   9207<<ASSIGN   9215<<ASSIGN   9240<<ASSIGN   9257<<ASSIGN   9267<<ASSIGN
      9321<<ASSIGN   9329<<ASSIGN   9360<<ASSIGN   9370<<ASSIGN   9468<<ASSIGN
B$JIT.ERR.MID
      8862**DCL      8862--REDEF
B$JIT$
      9058**DCL      8856--IMP-PTR  9173>>ASSIGN   9207>>ASSIGN   9215>>ASSIGN   9240>>ASSIGN   9257>>ASSIGN
      9267>>ASSIGN   9321>>ASSIGN   9329>>ASSIGN   9360>>ASSIGN   9370>>ASSIGN   9468>>ASSIGN
B$PS0$
      9046**DCL      8780--IMP-PTR  9185>>DOCASE   9195>>IF       9294>>DOCASE   9304>>IF
B$PS1$
      9047**DCL      8783--IMP-PTR  9189>>ASSIGN   9196>>CALLBLT  9198>>ASSIGN   9200>>ASSIGN   9228>>ASSIGN
      9228>>ASSIGN   9498>>ASSIGN   9499>>ASSIGN   9500>>ASSIGN   9501>>ASSIGN   9502>>ASSIGN   9503>>ASSIGN
      9504>>ASSIGN
B$PS10$
      9056**DCL      9433>>ASSIGN   9438>>ASSIGN
B$PS11$
      9057**DCL      9455>>ASSIGN   9458>>ASSIGN   9459>>ASSIGN   9459>>ASSIGN
B$PS2$
      9048**DCL      8788--IMP-PTR  9298>>ASSIGN   9305>>CALLBLT  9307>>ASSIGN   9309>>ASSIGN   9336>>ASSIGN
      9336>>ASSIGN   9514>>ASSIGN   9515>>ASSIGN   9516>>ASSIGN   9517>>ASSIGN   9518>>ASSIGN   9519>>ASSIGN
      9520>>ASSIGN   9521>>ASSIGN   9522>>ASSIGN   9532>>ASSIGN   9533>>ASSIGN
B$PS3$
      9049**DCL      8793--IMP-PTR  9387>>ASSIGN
B$PS4$
      9050**DCL      8812--IMP-PTR  9396>>ASSIGN
B$PS5$
      9051**DCL      8824--IMP-PTR  9407>>ASSIGN
B$PS6$
      9052**DCL      8833--IMP-PTR  9544>>ASSIGN   9545>>ASSIGN   9546>>ASSIGN
B$PS8$
      9054**DCL      8838--IMP-PTR
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:73   
B$PS9$
      9055**DCL      9416>>ASSIGN   9421>>ASSIGN
BADJF
      9462**LABEL    9453--CALLALT
BADOPT
      9237**LABEL    9348--GOTO
DSIZ
      8956**DCL      9154<>CALL     9155>>ASSIGN   9165<>CALL     9166>>ASSIGN   9283<>CALL     9284>>ASSIGN
E_BDJFID
      9033**DCL      9468>>ASSIGN
E_CGAFNS
      9027**DCL      9360>>ASSIGN
E_CGAFNT
      9021**DCL      9257>>ASSIGN
E_CGIQLS
      8979**DCL      9173>>ASSIGN
E_CGISLS
      8985**DCL      9321>>ASSIGN
E_CGITLS
      8991**DCL      9207>>ASSIGN
E_CGIWILD
      8997**DCL      9215>>ASSIGN   9329>>ASSIGN
E_CGSTRP
      9009**DCL      9370>>ASSIGN
E_CGTTRP
      9003**DCL      9267>>ASSIGN
E_CGUAFC
      9015**DCL      9240>>ASSIGN
FILLQ IN PROCEDURE FILLTYP
      9539**LABEL    9507--GOTO     9541--GOTO
FILLSTA IN PROCEDURE FILLTYP
      9513**ENTRY    9300--CALL     9337--CALL
FILLTYP
      9497**PROC     9191--CALL     9229--CALL
FPT$CGINFO.STAFC
      8780**DCL      9294>>DOCASE   9304>>IF
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:74   
FPT$CGINFO.TYPFC
      8780**DCL      9185>>DOCASE   9195>>IF
HFC$LOCK
      2885**DCL-ENT  9182--CALL     9290--CALL     9418--CALL     9435--CALL     9451--CALL     9526--CALL
HFC$UNLOCK
      2885**DCL-ENT  9224--CALL     9237--CALL     9249--CALL     9255--CALL     9265--CALL     9332--CALL
      9346--CALL     9352--CALL     9358--CALL     9368--CALL     9423--CALL     9440--CALL     9462--CALL
      9536--CALL
HFF$DSIZ
      9045**DCL-ENT  9154--CALL     9165--CALL     9283--CALL
HFF$NILERASE
      9044**DCL-ENT  9386--CALL     9395--CALL     9404--CALL     9415--CALL     9432--CALL     9449--CALL
HFF$TRAPALT
      9043**DCL-ENT  9184--CALL     9253--CALL     9292--CALL     9356--CALL     9453--CALL     9464--CALL
      9467--CALL
IQLS
      9172**LABEL    9288--GOTO
KC_VLPSTATION
      9071**DCL      9416>>ASSIGN   9433>>ASSIGN
KC_VLPSTATION.MSGIDXT
      9081**DCL      9084--REDEF
KEY
      8959**DCL      9189<<ASSIGN   9190<>CALL     9298<<ASSIGN   9299<>CALL
KQ$CG
      7067**DCL        14--PROC
KQ$CG.AUCTL
      7504**DCL      9387>>ASSIGN
KQ$CG.AUCTL.DVBYTE.REREAD
      7510**DCL      7511--REDEF
KQ$CG.GATE.MISC
      7459**DCL      9451<>CALL     9462<>CALL
KQ$CG.HOLDSTA$
      7497**DCL      9420>>IF       9421>>ASSIGN
KQ$CG.JRNLFID$
      7600**DCL      9454>>IF       9458>>ASSIGN   9459>>ASSIGN   9459>>ASSIGN
KQ$CG.JRNLSTA$
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:75   
      7570**DCL      9437>>IF       9438>>ASSIGN
KQ$CG.NGAVAL
      7592**DCL      9405>>ASSIGN
KQ$CG.QISS
      7453**DCL      9168>>IF       9286>>IF       9505>>IF       9539>>IF
KQ$CG.SETSTA
      7537**DCL      9396>>ASSIGN
KQ$CG.STATS
      7557**DCL      9407>>ASSIGN
KQ$CG.STATS.WRDSFREE
      7561**DCL      9405<<ASSIGN
KQ$CG.STATS.WRDSUSED
      7561**DCL      9405>>ASSIGN
KQ$CG.STREE
      7399**DCL      9299<>CALL
KQ$CG.STREE.GATE
      7401**DCL      9290<>CALL     9332<>CALL     9346<>CALL     9352<>CALL     9358<>CALL     9368<>CALL
      9418<>CALL     9423<>CALL     9435<>CALL     9440<>CALL
KQ$CG.STREE.HEAD$
      7409**DCL      9310>>ASSIGN
KQ$CG.TTREE
      7360**DCL      9190<>CALL
KQ$CG.TTREE.GATE
      7362**DCL      9182<>CALL     9224<>CALL     9237<>CALL     9249<>CALL     9255<>CALL     9265<>CALL
KQ$CG.TTREE.HEAD$
      7370**DCL      9201>>ASSIGN
KQ$CG.UGRANS
      7594**DCL      9405>>ASSIGN
KQ$MTYP.BTN.FLINK$
      8237**DCL      9232>>ASSIGN
KQ$MTYP.BTN.KEY
      8239**DCL      9203>>IF       9312>>IF       9498>>ASSIGN
KQ$MTYP.JOURNAL
      8247**DCL      9501>>ASSIGN
KQ$MTYP.MAXLATCH
      8258**DCL      9504>>ASSIGN
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:76   
KQ$MTYP.MPRIO
      8243**DCL      9500>>ASSIGN
KQ$MTYP.NUMWRITES
      8261**DCL      9503>>ASSIGN
KQ$MTYP.ONEREPORT
      8250**DCL      9502>>ASSIGN
KQ$MTYP.PERM
      8255**DCL      9499>>ASSIGN
KQ$QTN.CNACT
      8624**DCL      9545>>ASSIGN
KQ$QTN.MLH.COUNT
      8730**DCL      9546>>ASSIGN
KQ$QTN.MXACT
      8627**DCL      8629--REDEF    9544>>ASSIGN
KQ$QTN.STA.ACTTYC
      8349**DCL      8353--REDEF
KQ$QTN.STA.DCBLNK$
      8356**DCL      8359--REDEF    8363--REDEF
KQ$QTN.STA.EVCNT
      8442**DCL      8445--REDEF
KQ$QTN.STA.EVNT
      8408**DCL      8412--REDEF    8415--REDEF
KQ$QTN.STA.OPNBLKED
      8469**DCL      8472--REDEF
KQ$QTN.STA.OPNREJ
      8475**DCL      8477--REDEF
KQ$QTN.STA.SUCCREAD
      8398**DCL      8402--REDEF
KQ$QTN.STA.TCOUNT
      8527**DCL      8533--REDEF
KQ$QTN.STA.VGOT$
      8512**DCL      8516--REDEF    8520--REDEF
KQ$STA.ACTTYC
      7921**DCL      7925--REDEF
KQ$STA.AUP
      8023**DCL      9520>>ASSIGN
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:77   
KQ$STA.BTN.FLINK$
      7903**DCL      9341>>ASSIGN
KQ$STA.BTN.KEY
      7905**DCL      9421>>ASSIGN   9438>>ASSIGN   9514>>ASSIGN
KQ$STA.DCBLNK$
      7928**DCL      7931--REDEF    7935--REDEF
KQ$STA.EVCNT
      8014**DCL      8017--REDEF
KQ$STA.EVNT
      7980**DCL      7984--REDEF    7987--REDEF
KQ$STA.GATE
      7947**DCL      9526<>CALL     9536<>CALL
KQ$STA.LDCT$
      7910**DCL      9314>>IF       9314>>IF       9523>>IF       9528>>IF       9530>>IF       9530>>IF
      9533>>ASSIGN
KQ$STA.MLH.COUNT
      8182**DCL      9517>>ASSIGN
KQ$STA.MPRIO
      7942**DCL      9516>>ASSIGN
KQ$STA.OPNBLKED
      8041**DCL      8044--REDEF
KQ$STA.OPNREJ
      8047**DCL      8049--REDEF
KQ$STA.PERM
      7967**DCL      9314>>IF       9515>>ASSIGN
KQ$STA.READS
      8095**DCL      9518>>ASSIGN
KQ$STA.SUCCREAD
      7970**DCL      7974--REDEF
KQ$STA.TCOUNT
      8099**DCL      8105--REDEF
KQ$STA.TERM
      7965**DCL      9314>>IF
KQ$STA.VGOT$
      8084**DCL      8088--REDEF    8092--REDEF
KQ$STA.WRITES
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:78   
      8097**DCL      9519>>ASSIGN
KQB$SRCH
      9042**DCL-ENT  9190--CALL     9299--CALL
KQ_IMBLK.DVE.EOMCHAR
      3560**DCL      3562--REDEF
KQ_IMBLK.KEY1
      3486**DCL      3488--REDEF
KQ_IMBLK.KEY2
      3495**DCL      3513--REDEF
KQ_IMBLK.LNK$
      3460**DCL      3462--REDEF    3468--REDEF    3472--REDEF
KQ_IMBLK.TYC
      3609**DCL      3611--REDEF
KQ_IMBLK.XSP.MREQ$
      3515**DCL      3519--REDEF
KQ_IRBLK.BUF$
      3064**DCL      3066--REDEF
KQ_IRBLK.CNACTD
      2978**DCL      2987--REDEF
KQ_IRBLK.DBLKX
      3084**DCL      3088--REDEF
KQ_IRBLK.EOFNONE
      2956**DCL      2959--REDEF
KQ_IRBLK.FROMQ
      2962**DCL      2965--REDEF
KQ_IRBLK.KEY1R
      3003**DCL      3004--REDEF
KQ_IRBLK.KEY2R
      3008**DCL      3009--REDEF
KQ_IRBLK.LATCH
      2951**DCL      2953--REDEF
KQ_IRBLK.LWRITES$
      3095**DCL      3099--REDEF
KQ_IRBLKT.CNACTD
      3164**DCL      3173--REDEF
KQ_IRBLKT.DBLK$
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:79   
      3227**DCL      3231--REDEF    3234--REDEF
KQ_IRBLKT.EOFNONE
      3142**DCL      3145--REDEF
KQ_IRBLKT.FROMQ
      3148**DCL      3151--REDEF
KQ_IRBLKT.KEY1R
      3189**DCL      3190--REDEF
KQ_IRBLKT.KEY2R
      3194**DCL      3195--REDEF
KQ_IRBLKT.LATCH
      3137**DCL      3139--REDEF
MTYP$
      8954**DCL      8207--IMP-PTR
NK$LDCT.DDT$
      7824**DCL      7824--REDEF
NK$LDCT.DFLG.LOCAL
      7828**DCL      9530>>IF
NK$LDCT.IOQ$
      7823**DCL      7824--REDEF
NK$LDCT.LDCTX
      7825**DCL      7825--REDEF
NK$LDCT.LKFLG.ABORTED
      7837**DCL      7838--REDEF
NK$LDCT.LKFLG.ACTIVE
      7841**DCL      9533>>ASSIGN
NK$LDCT.RLCID.LDCTX
      7847**DCL      7847--REDEF    9314>>IF       9530>>IF
NK$LDCT.STA$
      7843**DCL      7844--REDEF
NK$LDCT.SYMB$
      7822**DCL      7822--REDEF    7822--REDEF    7823--REDEF
NOCTL
      9387**LABEL    9386--CALLALT
NOHOLDS
      9420**LABEL    9415--CALLALT
NOJF
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:80   
      9468**LABEL    9449--CALLALT  9465--GOTO
NOJRNLS
      9437**LABEL    9432--CALLALT
NOQL
      9156**LABEL    9154--CALLALT
NOQUESTS
      9329**LABEL    9305--CALLALT
NOQUESTT
      9215**LABEL    9196--CALLALT
NOSETSTA
      9396**LABEL    9395--CALLALT
NOSTA0
      9350**LABEL    9299--CALLALT  9300--CALLALT
NOSTAL
      9370**LABEL    9283--CALLALT  9285--GOTO     9354--GOTO
NOSTATS
      9407**LABEL    9404--CALLALT
NOTYP0
      9240**LABEL    9190--CALLALT
NOTYPL
      9267**LABEL    9165--CALLALT  9167--GOTO     9251--GOTO
NQ
      8969**DCL      9155<<ASSIGN   9170>>IF       9288>>IF
NSTA
      8962**DCL      9284<<ASSIGN   9285>>IF       9288>>IF       9297>>DOINDEX  9319>>IF
NTYP
      8957**DCL      9166<<ASSIGN   9167>>IF       9170>>IF       9188>>DOINDEX  9205>>IF
QLIST
      8967**DCL      9153<<ASSIGN   9156<<ASSIGN   9168>>IF       9286>>IF       9505>>IF       9539>>IF
QTN$
      8955**DCL      8281--IMP-PTR  9190<>CALL     9201<<ASSIGN   9202>>DOWHILE  9203>>IF       9232<<ASSIGN
      9232>>ASSIGN   9299<>CALL     9310<<ASSIGN   9311>>DOWHILE  9312>>IF       9314>>IF       9314>>IF
      9314>>IF       9314>>IF       9341<<ASSIGN   9341>>ASSIGN   9498>>ASSIGN   9499>>ASSIGN   9500>>ASSIGN
      9501>>ASSIGN   9502>>ASSIGN   9503>>ASSIGN   9504>>ASSIGN   9514>>ASSIGN   9515>>ASSIGN   9516>>ASSIGN
      9517>>ASSIGN   9518>>ASSIGN   9519>>ASSIGN   9520>>ASSIGN   9523>>IF       9526>>CALL     9528>>IF
      9530>>IF       9530>>IF       9533>>ASSIGN   9536>>CALL     9544>>ASSIGN   9545>>ASSIGN   9546>>ASSIGN
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:81   
QX
      8968**DCL      9188<<DOINDEX  9189>>ASSIGN   9199<<ASSIGN   9205>>IF       9230<<ASSIGN   9230>>ASSIGN
      9297<<DOINDEX  9298>>ASSIGN   9308<<ASSIGN   9319>>IF       9338<<ASSIGN   9338>>ASSIGN   9498>>ASSIGN
      9499>>ASSIGN   9500>>ASSIGN   9501>>ASSIGN   9502>>ASSIGN   9503>>ASSIGN   9504>>ASSIGN   9514>>ASSIGN
      9515>>ASSIGN   9516>>ASSIGN   9517>>ASSIGN   9518>>ASSIGN   9519>>ASSIGN   9520>>ASSIGN   9521>>ASSIGN
      9522>>ASSIGN   9532>>ASSIGN   9533>>ASSIGN   9544>>ASSIGN   9545>>ASSIGN   9546>>ASSIGN
STA$
      8953**DCL      7869--IMP-PTR
STATRAP
      9360**LABEL    9292--CALLALT
TYPTRAP
      9257**LABEL    9184--CALLALT
VLP$JRNLFID
      8853**DCL      9459<<ASSIGN   9459>>ASSIGN
VLP$JRNLFID.L#
      8853**DCL      8853--IMP-SIZ  9455<<ASSIGN   9458<<ASSIGN   9458>>ASSIGN   9459>>ASSIGN   9459>>ASSIGN
VLP$STATION
      8838**DCL      9416<<ASSIGN   9433<<ASSIGN
VLP$STATION.MSGIDXT
      8844**DCL      8846--REDEF
VLP$STATION.STATION
      8842**DCL      9421<<ASSIGN   9438<<ASSIGN
VLR$CGCP
      8793**DCL      9387<<ASSIGN
VLR$CGCP.DVBYTE.REREAD
      8801**DCL      8802--REDEF
VLR$CGQL.LIST
      8833**DCL      9155--ASSIGN
VLR$CGQL.LIST.CNACT
      8833**DCL      9545<<ASSIGN
VLR$CGQL.LIST.MSGCNT
      8833**DCL      9546<<ASSIGN
VLR$CGQL.LIST.MXACT
      8833**DCL      9544<<ASSIGN
VLR$CGSTAL.FOUND
      8788**DCL      9309<<ASSIGN   9336<<ASSIGN   9336>>ASSIGN
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:82   
VLR$CGSTAL.LIST
      8788**DCL      9284--ASSIGN
VLR$CGSTAL.LIST.ACTIVE
      8789**DCL      9522<<ASSIGN   9533<<ASSIGN
VLR$CGSTAL.LIST.AUP
      8789**DCL      9520<<ASSIGN
VLR$CGSTAL.LIST.CON
      8788**DCL      9521<<ASSIGN   9532<<ASSIGN
VLR$CGSTAL.LIST.MSGCNT
      8789**DCL      9517<<ASSIGN
VLR$CGSTAL.LIST.NAME
      8788**DCL      9298>>ASSIGN   9305>>CALLBLT  9307>>ASSIGN   9514<<ASSIGN
VLR$CGSTAL.LIST.PERM
      8788**DCL      9515<<ASSIGN
VLR$CGSTAL.LIST.PRIO
      8788**DCL      9516<<ASSIGN
VLR$CGSTAL.LIST.READS
      8789**DCL      9518<<ASSIGN
VLR$CGSTAL.LIST.WRITES
      8789**DCL      9519<<ASSIGN
VLR$CGTYPL.FOUND
      8783**DCL      9200<<ASSIGN   9228<<ASSIGN   9228>>ASSIGN
VLR$CGTYPL.LIST
      8783**DCL      9166--ASSIGN
VLR$CGTYPL.LIST.JOURNAL
      8783**DCL      9501<<ASSIGN
VLR$CGTYPL.LIST.MAXLATCH
      8784**DCL      9504<<ASSIGN
VLR$CGTYPL.LIST.NAME
      8783**DCL      9189>>ASSIGN   9196>>CALLBLT  9198>>ASSIGN   9498<<ASSIGN
VLR$CGTYPL.LIST.NUMWRITES
      8784**DCL      9503<<ASSIGN
VLR$CGTYPL.LIST.ONEREPORT
      8784**DCL      9502<<ASSIGN
VLR$CGTYPL.LIST.PERM
      8783**DCL      9499<<ASSIGN
PL6.E3A0      #001=KQI$CGINFO File=KQI$INFO.:E05TSI                              WED 07/30/97 01:28 Page:83   
VLR$CGTYPL.LIST.PRIO
      8783**DCL      9500<<ASSIGN
VLR$SETSTA
      8812**DCL      9396<<ASSIGN
VLR$STATS
      8824**DCL      9407<<ASSIGN
WILDC
      8971**DCL      9198<<ASSIGN   9203>>IF       9307<<ASSIGN   9312>>IF
WILDLEN
      8970**DCL      9196<<CALLBLT  9197<<ASSIGN   9198>>ASSIGN   9203>>IF       9305<<CALLBLT  9306<<ASSIGN
      9307>>ASSIGN   9312>>IF
