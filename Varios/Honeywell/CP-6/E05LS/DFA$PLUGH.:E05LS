VERSION E05

PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:1    
        1        1        /*M* DFA$PLUGH - Trace through the AUTO stack for FEP programs */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*P* NAME: DFA$PLUGH
       10       10             DESCRIPTION: PLUGH (Procedure List Used to Get Here) will
       11       11                          go through the AUTO stack , reporting how the
       12       12                          current procedure was arrived at. */
       13       13        /**/
       14       14        DFA$PLUGH: PROC;
       15       15        /* Local Auto */
       16       16    1   DCL 1 VALUE ALIGNED,
       17       17    1         2 SIZE UBIN,
       18       18    1         2 OPS(0:15) UBIN;
       19       19    1   DCL ADDRESS UBIN;
       20       20    1   DCL SEG UBIN;
       21       21    1   DCL DESC# UBIN;
       22       22    1   DCL NOT_IS BIT(1) ALIGNED;
       23       23    1   DCL SIZE UBIN;
       24       24    1   DCL EXPR_OP BIT(1) ALIGNED;
       25       25    1   DCL USEG UBIN;
       26       26    1   DCL UDESC# UBIN;
       27       27    1   DCL UNOT_IS BIT(1) ALIGNED;
       28       28    1   DCL FRAME_SIZE UBIN;
       29       29    1   DCL RETURN_ADDRESS UBIN;
       30       30    1   DCL T_REG UBIN;
       31       31    1   DCL FRAME_TYPE SBIN;
       32       32    1   DCL BOTTOM_FRAME UBIN;
       33       33    1   DCL PREV_FRAME_SIZE SBIN;
       34       34    1   DCL MONITOR_STACK BIT(1) ALIGNED;
       35       35    1   DCL OUT$ PTR;
       36       36    1   DCL NCARS UBIN;
       37       37        %EQU SHIFT_16 = %(BITBIN('10000'X));
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:2    
       38       38        /* Includes and Based Structures */
       39       39        %INCLUDE XUH_MACRO_C;
       40      123        %INCLUDE DD_SD_M;
       41     1459        %S_D;
       42     2777        %INCLUDE DD$BASED;
       43     4080        %DOO(NAME=PLUGH$CMD);
       44     4095        %FPRG$CONTEXT;
       45     4158        %INCLUDE GM_VIRTUAL_E;
       46     4368        %INCLUDE DD_ERR_C;
       47     4765        /* Entry DCLs */
       48     4766    1   DCL DDE$ERROR ENTRY;
       49     4767    1   DCL DDR$MOVE ENTRY(4) ALTRET;
       50     4768    1   DCL DDR$POSIT ENTRY(5) ALTRET;
       51     4769    1   DCL DDQ$WRITE ENTRY(2);
       52     4770    1   DCL DFK$EVAL ENTRY(8) ALTRET;
       53     4771    1   DCL DFK$GETMVAL ENTRY(6) ALTRET;
       54     4772    1   DCL DFR$INSTR ENTRY(4) ALTRET;
       55     4773        /**/
       56     4774    1        OUT$ = ADDR(S_D.OUTPUT);
       57     4775    1        USEG = 3;
       58     4776    1        UDESC# = 0;
       59     4777    1        UNOT_IS = '0'B;
       60     4778    1        IF S_D.RUM
       61     4779    2        THEN DO;
       62     4780    2             S_D.ERROR = 229;       /* E@NOTINRUM */
       63     4781    2             GOTO ARET;
       64     4782    2           END;
       65     4783    1        IF S_D.ANLZ
       66     4784    2        THEN DO;
       67     4785    2             S_D.ERROR = 250;    /* E@NOTANLZMODE */
       68     4786    2             GOTO ARET;
       69     4787    2           END;
       70     4788    1        IF S_D.DO$ -> PLUGH$CMD.DDESC
       71     4789    2        THEN DO;
       72     4790    2             S_D.DESC$ = S_D.D$;
       73     4791    2             CALL DFK$EVAL(VALUE, ADDRESS, SEG, DESC#, NOT_IS, SIZE, EXPR_OP, '0'B)
       74     4792    2               ALTRET(ARET);
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:3    
       75     4793    2           END;
       76     4794    2        ELSE DO;
       77     4795    2             SEG = 9;
       78     4796    2             DESC# = 4;
       79     4797    2             NOT_IS = '1'B;
       80     4798    2             ADDRESS = 0;
       81     4799    2             CALL DFK$GETMVAL(VALUE, ADDRESS, SEG, DESC#, NOT_IS, '0'B)
       82     4800    2               ALTRET(ARET);
       83     4801    2           END;
       84     4802                                                /* Get current T (stack) register */
       85     4803    1        SEG = 3;
       86     4804    1        DESC# = 0;
       87     4805    1        ADDRESS = 0;
       88     4806    1        NOT_IS = '1'B;
       89     4807    1        T_REG = (VALUE.OPS(0) * %SHIFT_16) + VALUE.OPS(1);
       90     4808    1        IF VALUE.OPS(4) = 0                /* Monitor stack */
       91     4809    1        THEN MONITOR_STACK = '1'B;
       92     4810    1        ELSE IF VALUE.OPS(4) = 1           /* User stack */
       93     4811    1             THEN MONITOR_STACK = '0'B;
       94     4812    1             ELSE GOTO BAD_STACK;
       95     4813        /**/
       96     4814    1        IF MONITOR_STACK
       97     4815    2        THEN DO;
       98     4816    2             BOTTOM_FRAME = T_REG;
       99     4817    2             CALL DFK$GETMVAL(VALUE, T_REG, SEG, DESC#, NOT_IS, '0'B)
      100     4818    2               ALTRET(ARET);
      101     4819    2             ADDRESS = T_REG - VALUE.OPS(0) /* CURRENT USED */;
      102     4820    2           END;
      103     4821    2        ELSE DO;                           /* User stack */
      104     4822    2             BOTTOM_FRAME = (VALUE.OPS(2) * %SHIFT_16) + VALUE.OPS(3) - 1;
      105     4823    2             CALL DFK$GETMVAL(VALUE, 0, 10, /*B7*/ 7, '1'B, '0'B)
      106     4824    2               ALTRET(ARET);
      107     4825    2             ADDRESS = (VALUE.OPS(0) * %SHIFT_16) + VALUE.OPS(1) - 1; /* $B7 */
      108     4826    2           END;
      109     4827    2        DO WHILE ('1'B);
      110     4828    2             CALL DFK$GETMVAL(VALUE, ADDRESS, SEG, DESC#, NOT_IS, '0'B)
      111     4829    2               ALTRET(ARET);
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:4    
      112     4830    2             FRAME_SIZE = VALUE.OPS(0);
      113     4831    2             RETURN_ADDRESS = (VALUE.OPS(1) * %SHIFT_16) + VALUE.OPS(2);
      114     4832    2             FRAME_TYPE = VALUE.OPS(3);
      115     4833    2             PREV_FRAME_SIZE = VALUE.OPS(4);
      116     4834    2             CALL PRINT_LOC;
      117     4835    2             IF BINBIT (FRAME_TYPE, 16) = 'FFFF'X
      118     4836    3             THEN DO;
      119     4837    3                  S_D.OUTPUT = 'Bottom Frame';
      120     4838    3                  NCARS = LENGTHC('Bottom Frame');
      121     4839    3                  CALL DDQ$WRITE(OUT$, NCARS);
      122     4840    3                END;
      123     4841    2             IF BINBIT (FRAME_TYPE, 16) = 'FFFE'X
      124     4842    3             THEN DO;
      125     4843    3                  S_D.OUTPUT = 'Async frame';
      126     4844    3                  NCARS = LENGTHC('Async frame');
      127     4845    3                  CALL DDQ$WRITE(OUT$, NCARS);
      128     4846    3                END;
      129     4847    2             IF (ADDRESS = BOTTOM_FRAME) THEN EXIT;
      130     4848    2             IF MONITOR_STACK
      131     4849    2             THEN ADDRESS = ADDRESS + FRAME_SIZE + 1;
      132     4850    2             ELSE ADDRESS = ADDRESS - PREV_FRAME_SIZE - 1;
      133     4851    2           END;                            /* DO WHILE (ADDRESS ~= BOTTOM_FRAME) */
      134     4852    1        RETURN;
      135     4853
      136     4854    1   BAD_STACK: ;
      137     4855    1        S_D.ERROR = 215;
      138     4856    1   ARET: ;
      139     4857    1        CALL DDE$ERROR;
      140     4858    1        RETURN;
      141     4859        %EJECT;
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:5    
      142     4860    1   PRINT_LOC: PROC;
      143     4861        /* Local Auto */
      144     4862    2   DCL BB$ PTR;
      145     4863    2   DCL REM UBIN;
      146     4864    2   DCL NCARS UBIN;
      147     4865    2   DCL FNDOFFSET BIT(1) ALIGNED;
      148     4866    2   DCL SAVE_D$ PTR;
      149     4867    2   DCL SAVE_DESCL$ PTR;
      150     4868    2   DCL UADDRESS UBIN;
      151     4869    2   DCL CANT_SEE BIT(1) ALIGNED;
      152     4870    2   DCL LNJ_INDEX UBIN;
      153     4871        /**/
      154     4872    2        CANT_SEE = '0'B;
      155     4873    2        BB$ = OUT$;
      156     4874    2        REM = SIZEC(S_D.OUTPUT);
      157     4875    2        S_D.FNDOFFSET = '0'B;
      158     4876                                                /* Get address to point to actual LNJ */
      159     4877    2        UADDRESS = RETURN_ADDRESS - 3;
      160     4878    2        CALL DFK$GETMVAL(VALUE, UADDRESS, USEG, UDESC#, UNOT_IS, '0'B)
      161     4879    3        WHENALTRETURN DO;
      162     4880    3             CANT_SEE = '1'B;
      163     4881    3           END;
      164     4882    2        IF (BINBIT(VALUE.OPS(0), 16) & '8F80'X) = '8380'X
      165     4883    2        THEN LNJ_INDEX = 0;
      166     4884    2        ELSE IF (BINBIT(VALUE.OPS(1), 16) & '8F80'X) = '8380'X
      167     4885    2             THEN LNJ_INDEX = 1;
      168     4886    2             ELSE LNJ_INDEX = 2;
      169     4887    2        CALL DDR$POSIT(UADDRESS + LNJ_INDEX, BB$, REM, NCARS);
      170     4888    2        FNDOFFSET = S_D.FNDOFFSET;
      171     4889    2        BB$ = PINCRC(BB$, NCARS);
      172     4890    2        REM = REM - NCARS;
      173     4891    2        CALL DDR$MOVE( '/', LENGTHC( '/' ), BB$, REM) ALTRET(ARET);
      174     4892    2        IF CANT_SEE
      175     4893    2        THEN CALL DDR$MOVE( 'can''t see this location',
      176     4894    2               LENGTHC( 'can''t see this location' ),
      177     4895    2               BB$, REM ) ALTRET( ARET );
      178     4896    3        ELSE DO;
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:6    
      179     4897    3             SAVE_D$ = S_D.D$;
      180     4898    3             SAVE_DESCL$ = S_D.DESCL$;
      181     4899    3             S_D.D$ = BB$;
      182     4900    3             S_D.DESCL$ = PINCRC(S_D.D$, REM);
      183     4901    3             CALL DFR$INSTR(VALUE.OPS(LNJ_INDEX), NCARS, '1'B) ALTRET(ARET);
      184     4902    3             BB$ = S_D.D$;
      185     4903    3             REM = POFFC(S_D.DESCL$, BB$);
      186     4904    3             S_D.D$ = SAVE_D$;
      187     4905    3             S_D.DESCL$ = SAVE_DESCL$;
      188     4906    3           END;
      189     4907    2        CALL DDQ$WRITE(OUT$, POFFC(BB$, OUT$));
      190     4908    2        RETURN;
      191     4909
      192     4910    2   ARET: ;
      193     4911    2        CALL DDE$ERROR;
      194     4912    2        RETURN;
      195     4913    2   END PRINT_LOC;
      196     4914    1   END DFA$PLUGH;

PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:7    
--  Include file information  --

   DD_ERR_C.:E05TOU  is referenced.
   GM_VIRTUAL_E.:E05TOU  is referenced.
   DD$BASED.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DFA$PLUGH.

   Procedure DFA$PLUGH requires 379 words for executable code.
   Procedure DFA$PLUGH requires 56 words of local(AUTO) storage.

    No errors detected in file DFA$PLUGH.:E05TSI    .

PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:8    

 Object Unit name= DFA$PLUGH                                  File name= DFA$PLUGH.:E05TOU
 UTS= JUL 29 '97 14:35:19.80 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     12     14  DFA$PLUGH
    1   Proc  even  none   379    573  DFA$PLUGH
    2  RoData even  none    12     14  DFA$PLUGH

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        0  DFA$PLUGH

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       8 DFK$EVAL
         yes           Std       2 DDQ$WRITE
 yes     yes           Std       6 DFK$GETMVAL
         yes           Std       0 DDE$ERROR
 yes     yes           Std       5 DDR$POSIT
 yes     yes           Std       4 DDR$MOVE
 yes     yes           Std       4 DFR$INSTR
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:9    

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    S_D$                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:10   


        1        1        /*M* DFA$PLUGH - Trace through the AUTO stack for FEP programs */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*P* NAME: DFA$PLUGH
       10       10             DESCRIPTION: PLUGH (Procedure List Used to Get Here) will
       11       11                          go through the AUTO stack , reporting how the
       12       12                          current procedure was arrived at. */
       13       13        /**/
       14       14        DFA$PLUGH: PROC;

     14  1 000000   000000 700200 xent  DFA$PLUGH    TSX0  ! X66_AUTO_0
         1 000001   000070 000000                    ZERO    56,0

       15       15        /* Local Auto */
       16       16    1   DCL 1 VALUE ALIGNED,
       17       17    1         2 SIZE UBIN,
       18       18    1         2 OPS(0:15) UBIN;
       19       19    1   DCL ADDRESS UBIN;
       20       20    1   DCL SEG UBIN;
       21       21    1   DCL DESC# UBIN;
       22       22    1   DCL NOT_IS BIT(1) ALIGNED;
       23       23    1   DCL SIZE UBIN;
       24       24    1   DCL EXPR_OP BIT(1) ALIGNED;
       25       25    1   DCL USEG UBIN;
       26       26    1   DCL UDESC# UBIN;
       27       27    1   DCL UNOT_IS BIT(1) ALIGNED;
       28       28    1   DCL FRAME_SIZE UBIN;
       29       29    1   DCL RETURN_ADDRESS UBIN;
       30       30    1   DCL T_REG UBIN;
       31       31    1   DCL FRAME_TYPE SBIN;
       32       32    1   DCL BOTTOM_FRAME UBIN;
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:11   
       33       33    1   DCL PREV_FRAME_SIZE SBIN;
       34       34    1   DCL MONITOR_STACK BIT(1) ALIGNED;
       35       35    1   DCL OUT$ PTR;
       36       36    1   DCL NCARS UBIN;
       37       37        %EQU SHIFT_16 = %(BITBIN('10000'X));
       38       38        /* Includes and Based Structures */
       39       39        %INCLUDE XUH_MACRO_C;
       40      123        %INCLUDE DD_SD_M;
       41     1459        %S_D;
       42     2777        %INCLUDE DD$BASED;
       43     4080        %DOO(NAME=PLUGH$CMD);
       44     4095        %FPRG$CONTEXT;
       45     4158        %INCLUDE GM_VIRTUAL_E;
       46     4368        %INCLUDE DD_ERR_C;
       47     4765        /* Entry DCLs */
       48     4766    1   DCL DDE$ERROR ENTRY;
       49     4767    1   DCL DDR$MOVE ENTRY(4) ALTRET;
       50     4768    1   DCL DDR$POSIT ENTRY(5) ALTRET;
       51     4769    1   DCL DDQ$WRITE ENTRY(2);
       52     4770    1   DCL DFK$EVAL ENTRY(8) ALTRET;
       53     4771    1   DCL DFK$GETMVAL ENTRY(6) ALTRET;
       54     4772    1   DCL DFR$INSTR ENTRY(4) ALTRET;
       55     4773        /**/
       56     4774    1        OUT$ = ADDR(S_D.OUTPUT);

   4774  1 000002   000000 236000 xsym               LDQ     S_D$
         1 000003   005335 036003                    ADLQ    2781,DU
         1 000004   200044 756100                    STQ     OUT$,,AUTO

       57     4775    1        USEG = 3;

   4775  1 000005   000003 235007                    LDA     3,DL
         1 000006   200032 755100                    STA     USEG,,AUTO

       58     4776    1        UDESC# = 0;

   4776  1 000007   200033 450100                    STZ     UDESC#,,AUTO
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:12   

       59     4777    1        UNOT_IS = '0'B;

   4777  1 000010   200034 450100                    STZ     UNOT_IS,,AUTO

       60     4778    1        IF S_D.RUM

   4778  1 000011   000000 470400 xsym               LDP0    S_D$
         1 000012   004755 234100                    SZN     2541,,PR0
         1 000013   000017 605000 1                  TPL     s:4783

       61     4779    2        THEN DO;

       62     4780    2             S_D.ERROR = 229;       /* E@NOTINRUM */

   4780  1 000014   000345 235007                    LDA     229,DL
         1 000015   000013 755100                    STA     11,,PR0

       63     4781    2             GOTO ARET;

   4781  1 000016   000330 710000 1                  TRA     ARET

       64     4782    2           END;
       65     4783    1        IF S_D.ANLZ

   4783  1 000017   004756 234100                    SZN     2542,,PR0
         1 000020   000024 605000 1                  TPL     s:4788

       66     4784    2        THEN DO;

       67     4785    2             S_D.ERROR = 250;    /* E@NOTANLZMODE */

   4785  1 000021   000372 235007                    LDA     250,DL
         1 000022   000013 755100                    STA     11,,PR0

       68     4786    2             GOTO ARET;

PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:13   
   4786  1 000023   000330 710000 1                  TRA     ARET

       69     4787    2           END;
       70     4788    1        IF S_D.DO$ -> PLUGH$CMD.DDESC

   4788  1 000024   000031 471500                    LDP1    25,,PR0
         1 000025   100001 236100                    LDQ     1,,PR1
         1 000026   200000 316007                    CANQ    65536,DL
         1 000027   000057 600000 1                  TZE     s:4795

       71     4789    2        THEN DO;

       72     4790    2             S_D.DESC$ = S_D.D$;

   4790  1 000030   000044 236100                    LDQ     36,,PR0
         1 000031   000041 756100                    STQ     33,,PR0

       73     4791    2             CALL DFK$EVAL(VALUE, ADDRESS, SEG, DESC#, NOT_IS, SIZE, EXPR_OP, '0'B)

   4791  1 000032   000000 236000 2                  LDQ     0
         1 000033   200067 756100                    STQ     LNJ_INDEX+8,,AUTO
         1 000034   200031 631500                    EPPR1   EXPR_OP,,AUTO
         1 000035   200066 451500                    STP1    LNJ_INDEX+7,,AUTO
         1 000036   200030 633500                    EPPR3   SIZE,,AUTO
         1 000037   200065 453500                    STP3    LNJ_INDEX+6,,AUTO
         1 000040   200027 634500                    EPPR4   NOT_IS,,AUTO
         1 000041   200064 454500                    STP4    LNJ_INDEX+5,,AUTO
         1 000042   200026 635500                    EPPR5   DESC#,,AUTO
         1 000043   200063 455500                    STP5    LNJ_INDEX+4,,AUTO
         1 000044   200025 636500                    EPPR6   SEG,,AUTO
         1 000045   200062 456500                    STP6    LNJ_INDEX+3,,AUTO
         1 000046   200024 637500                    EPPR7   ADDRESS,,AUTO
         1 000047   200061 457500                    STP7    LNJ_INDEX+2,,AUTO
         1 000050   200003 630500                    EPPR0   VALUE,,AUTO
         1 000051   200060 450500                    STP0    LNJ_INDEX+1,,AUTO
         1 000052   200060 630500                    EPPR0   LNJ_INDEX+1,,AUTO
         1 000053   000026 631400 xsym               EPPR1   B_VECTNIL+22
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:14   
         1 000054   000000 701000 xent               TSX1    DFK$EVAL
         1 000055   000330 702000 1                  TSX2    ARET

       74     4792    2               ALTRET(ARET);
       75     4793    2           END;

   4793  1 000056   000106 710000 1                  TRA     s:4803

       76     4794    2        ELSE DO;

       77     4795    2             SEG = 9;

   4795  1 000057   000011 235007                    LDA     9,DL
         1 000060   200025 755100                    STA     SEG,,AUTO

       78     4796    2             DESC# = 4;

   4796  1 000061   000004 236007                    LDQ     4,DL
         1 000062   200026 756100                    STQ     DESC#,,AUTO

       79     4797    2             NOT_IS = '1'B;

   4797  1 000063   400000 236003                    LDQ     -131072,DU
         1 000064   200027 756100                    STQ     NOT_IS,,AUTO

       80     4798    2             ADDRESS = 0;

   4798  1 000065   200024 450100                    STZ     ADDRESS,,AUTO

       81     4799    2             CALL DFK$GETMVAL(VALUE, ADDRESS, SEG, DESC#, NOT_IS, '0'B)

   4799  1 000066   000000 236000 2                  LDQ     0
         1 000067   200065 756100                    STQ     LNJ_INDEX+6,,AUTO
         1 000070   200027 631500                    EPPR1   NOT_IS,,AUTO
         1 000071   200064 451500                    STP1    LNJ_INDEX+5,,AUTO
         1 000072   200026 633500                    EPPR3   DESC#,,AUTO
         1 000073   200063 453500                    STP3    LNJ_INDEX+4,,AUTO
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:15   
         1 000074   200025 634500                    EPPR4   SEG,,AUTO
         1 000075   200062 454500                    STP4    LNJ_INDEX+3,,AUTO
         1 000076   200024 635500                    EPPR5   ADDRESS,,AUTO
         1 000077   200061 455500                    STP5    LNJ_INDEX+2,,AUTO
         1 000100   200003 636500                    EPPR6   VALUE,,AUTO
         1 000101   200060 456500                    STP6    LNJ_INDEX+1,,AUTO
         1 000102   200060 630500                    EPPR0   LNJ_INDEX+1,,AUTO
         1 000103   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 000104   000000 701000 xent               TSX1    DFK$GETMVAL
         1 000105   000330 702000 1                  TSX2    ARET

       82     4800    2               ALTRET(ARET);
       83     4801    2           END;

       84     4802                                                /* Get current T (stack) register */
       85     4803    1        SEG = 3;

   4803  1 000106   000003 235007                    LDA     3,DL
         1 000107   200025 755100                    STA     SEG,,AUTO

       86     4804    1        DESC# = 0;

   4804  1 000110   200026 450100                    STZ     DESC#,,AUTO

       87     4805    1        ADDRESS = 0;

   4805  1 000111   200024 450100                    STZ     ADDRESS,,AUTO

       88     4806    1        NOT_IS = '1'B;

   4806  1 000112   400000 236003                    LDQ     -131072,DU
         1 000113   200027 756100                    STQ     NOT_IS,,AUTO

       89     4807    1        T_REG = (VALUE.OPS(0) * %SHIFT_16) + VALUE.OPS(1);

   4807  1 000114   200004 236100                    LDQ     VALUE+1,,AUTO
         1 000115   000020 736000                    QLS     16
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:16   
         1 000116   200005 036100                    ADLQ    VALUE+2,,AUTO
         1 000117   200037 756100                    STQ     T_REG,,AUTO

       90     4808    1        IF VALUE.OPS(4) = 0                /* Monitor stack */

   4808  1 000120   200010 235100                    LDA     VALUE+5,,AUTO
         1 000121   000125 601000 1                  TNZ     s:4810

       91     4809    1        THEN MONITOR_STACK = '1'B;

   4809  1 000122   400000 236003                    LDQ     -131072,DU
         1 000123   200043 756100                    STQ     MONITOR_STACK,,AUTO
         1 000124   000131 710000 1                  TRA     s:4814

       92     4810    1        ELSE IF VALUE.OPS(4) = 1           /* User stack */

   4810  1 000125   000001 115007                    CMPA    1,DL
         1 000126   000325 601000 1                  TNZ     BAD_STACK

       93     4811    1             THEN MONITOR_STACK = '0'B;

   4811  1 000127   200043 450100                    STZ     MONITOR_STACK,,AUTO
         1 000130   000131 710000 1                  TRA     s:4814

       94     4812    1             ELSE GOTO BAD_STACK;
       95     4813        /**/
       96     4814    1        IF MONITOR_STACK

   4814  1 000131   200043 234100                    SZN     MONITOR_STACK,,AUTO
         1 000132   000161 605000 1                  TPL     s:4822

       97     4815    2        THEN DO;

       98     4816    2             BOTTOM_FRAME = T_REG;

   4816  1 000133   200037 236100                    LDQ     T_REG,,AUTO
         1 000134   200041 756100                    STQ     BOTTOM_FRAME,,AUTO
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:17   

       99     4817    2             CALL DFK$GETMVAL(VALUE, T_REG, SEG, DESC#, NOT_IS, '0'B)

   4817  1 000135   000000 236000 2                  LDQ     0
         1 000136   200065 756100                    STQ     LNJ_INDEX+6,,AUTO
         1 000137   200027 630500                    EPPR0   NOT_IS,,AUTO
         1 000140   200064 450500                    STP0    LNJ_INDEX+5,,AUTO
         1 000141   200026 631500                    EPPR1   DESC#,,AUTO
         1 000142   200063 451500                    STP1    LNJ_INDEX+4,,AUTO
         1 000143   200025 633500                    EPPR3   SEG,,AUTO
         1 000144   200062 453500                    STP3    LNJ_INDEX+3,,AUTO
         1 000145   200037 634500                    EPPR4   T_REG,,AUTO
         1 000146   200061 454500                    STP4    LNJ_INDEX+2,,AUTO
         1 000147   200003 635500                    EPPR5   VALUE,,AUTO
         1 000150   200060 455500                    STP5    LNJ_INDEX+1,,AUTO
         1 000151   200060 630500                    EPPR0   LNJ_INDEX+1,,AUTO
         1 000152   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 000153   000000 701000 xent               TSX1    DFK$GETMVAL
         1 000154   000330 702000 1                  TSX2    ARET

      100     4818    2               ALTRET(ARET);
      101     4819    2             ADDRESS = T_REG - VALUE.OPS(0) /* CURRENT USED */;

   4819  1 000155   200037 236100                    LDQ     T_REG,,AUTO
         1 000156   200004 136100                    SBLQ    VALUE+1,,AUTO
         1 000157   200024 756100                    STQ     ADDRESS,,AUTO

      102     4820    2           END;

   4820  1 000160   000207 710000 1                  TRA     s:4828

      103     4821    2        ELSE DO;                           /* User stack */

      104     4822    2             BOTTOM_FRAME = (VALUE.OPS(2) * %SHIFT_16) + VALUE.OPS(3) - 1;

   4822  1 000161   200006 236100                    LDQ     VALUE+3,,AUTO
         1 000162   000020 736000                    QLS     16
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:18   
         1 000163   200007 036100                    ADLQ    VALUE+4,,AUTO
         1 000164   000001 136007                    SBLQ    1,DL
         1 000165   200041 756100                    STQ     BOTTOM_FRAME,,AUTO

      105     4823    2             CALL DFK$GETMVAL(VALUE, 0, 10, /*B7*/ 7, '1'B, '0'B)

   4823  1 000166   000002 237000 2                  LDAQ    2
         1 000167   200064 757100                    STAQ    LNJ_INDEX+5,,AUTO
         1 000170   000004 237000 2                  LDAQ    4
         1 000171   200062 757100                    STAQ    LNJ_INDEX+3,,AUTO
         1 000172   000000 236000 2                  LDQ     0
         1 000173   200061 756100                    STQ     LNJ_INDEX+2,,AUTO
         1 000174   200003 630500                    EPPR0   VALUE,,AUTO
         1 000175   200060 450500                    STP0    LNJ_INDEX+1,,AUTO
         1 000176   200060 630500                    EPPR0   LNJ_INDEX+1,,AUTO
         1 000177   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 000200   000000 701000 xent               TSX1    DFK$GETMVAL
         1 000201   000330 702000 1                  TSX2    ARET

      106     4824    2               ALTRET(ARET);
      107     4825    2             ADDRESS = (VALUE.OPS(0) * %SHIFT_16) + VALUE.OPS(1) - 1; /* $B7 */

   4825  1 000202   200004 236100                    LDQ     VALUE+1,,AUTO
         1 000203   000020 736000                    QLS     16
         1 000204   200005 036100                    ADLQ    VALUE+2,,AUTO
         1 000205   000001 136007                    SBLQ    1,DL
         1 000206   200024 756100                    STQ     ADDRESS,,AUTO

      108     4826    2           END;

      109     4827    2        DO WHILE ('1'B);

      110     4828    2             CALL DFK$GETMVAL(VALUE, ADDRESS, SEG, DESC#, NOT_IS, '0'B)

   4828  1 000207   000000 236000 2                  LDQ     0
         1 000210   200065 756100                    STQ     LNJ_INDEX+6,,AUTO
         1 000211   200027 630500                    EPPR0   NOT_IS,,AUTO
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:19   
         1 000212   200064 450500                    STP0    LNJ_INDEX+5,,AUTO
         1 000213   200026 631500                    EPPR1   DESC#,,AUTO
         1 000214   200063 451500                    STP1    LNJ_INDEX+4,,AUTO
         1 000215   200025 633500                    EPPR3   SEG,,AUTO
         1 000216   200062 453500                    STP3    LNJ_INDEX+3,,AUTO
         1 000217   200024 634500                    EPPR4   ADDRESS,,AUTO
         1 000220   200061 454500                    STP4    LNJ_INDEX+2,,AUTO
         1 000221   200003 635500                    EPPR5   VALUE,,AUTO
         1 000222   200060 455500                    STP5    LNJ_INDEX+1,,AUTO
         1 000223   200060 630500                    EPPR0   LNJ_INDEX+1,,AUTO
         1 000224   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 000225   000000 701000 xent               TSX1    DFK$GETMVAL
         1 000226   000330 702000 1                  TSX2    ARET

      111     4829    2               ALTRET(ARET);
      112     4830    2             FRAME_SIZE = VALUE.OPS(0);

   4830  1 000227   200004 235100                    LDA     VALUE+1,,AUTO
         1 000230   200035 755100                    STA     FRAME_SIZE,,AUTO

      113     4831    2             RETURN_ADDRESS = (VALUE.OPS(1) * %SHIFT_16) + VALUE.OPS(2);

   4831  1 000231   200005 236100                    LDQ     VALUE+2,,AUTO
         1 000232   000020 736000                    QLS     16
         1 000233   200006 036100                    ADLQ    VALUE+3,,AUTO
         1 000234   200036 756100                    STQ     RETURN_ADDRESS,,AUTO

      114     4832    2             FRAME_TYPE = VALUE.OPS(3);

   4832  1 000235   200007 235100                    LDA     VALUE+4,,AUTO
         1 000236   200040 755100                    STA     FRAME_TYPE,,AUTO

      115     4833    2             PREV_FRAME_SIZE = VALUE.OPS(4);

   4833  1 000237   200010 235100                    LDA     VALUE+5,,AUTO
         1 000240   200042 755100                    STA     PREV_FRAME_SIZE,,AUTO

PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:20   
      116     4834    2             CALL PRINT_LOC;

   4834  1 000241   000334 701000 1                  TSX1    PRINT_LOC
         1 000242   000000 011000                    NOP     0

      117     4835    2             IF BINBIT (FRAME_TYPE, 16) = 'FFFF'X

   4835  1 000243   200040 236100                    LDQ     FRAME_TYPE,,AUTO
         1 000244   000024 736000                    QLS     20
         1 000245   777774 116003                    CMPQ    -4,DU
         1 000246   000265 601000 1                  TNZ     s:4841

      118     4836    3             THEN DO;

      119     4837    3                  S_D.OUTPUT = 'Bottom Frame';

   4837  1 000247   000000 470400 xsym               LDP0    S_D$
         1 000250   040100 100400                    MLR     fill='040'O
         1 000251   000000 000014 0                  ADSC9   0                        cn=0,n=12
         1 000252   005335 004000                    ADSC9   2781,,PR0                cn=0,n=2048

      120     4838    3                  NCARS = LENGTHC('Bottom Frame');

   4838  1 000253   000014 235007                    LDA     12,DL
         1 000254   200045 755100                    STA     NCARS,,AUTO

      121     4839    3                  CALL DDQ$WRITE(OUT$, NCARS);

   4839  1 000255   200045 631500                    EPPR1   NCARS,,AUTO
         1 000256   200061 451500                    STP1    LNJ_INDEX+2,,AUTO
         1 000257   200044 633500                    EPPR3   OUT$,,AUTO
         1 000260   200060 453500                    STP3    LNJ_INDEX+1,,AUTO
         1 000261   200060 630500                    EPPR0   LNJ_INDEX+1,,AUTO
         1 000262   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000263   000000 701000 xent               TSX1    DDQ$WRITE
         1 000264   000000 011000                    NOP     0

PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:21   
      122     4840    3                END;

      123     4841    2             IF BINBIT (FRAME_TYPE, 16) = 'FFFE'X

   4841  1 000265   200040 236100                    LDQ     FRAME_TYPE,,AUTO
         1 000266   000024 736000                    QLS     20
         1 000267   777770 116003                    CMPQ    -8,DU
         1 000270   000307 601000 1                  TNZ     s:4847

      124     4842    3             THEN DO;

      125     4843    3                  S_D.OUTPUT = 'Async frame';

   4843  1 000271   000000 470400 xsym               LDP0    S_D$
         1 000272   040100 100400                    MLR     fill='040'O
         1 000273   000003 000013 0                  ADSC9   3                        cn=0,n=11
         1 000274   005335 004000                    ADSC9   2781,,PR0                cn=0,n=2048

      126     4844    3                  NCARS = LENGTHC('Async frame');

   4844  1 000275   000013 235007                    LDA     11,DL
         1 000276   200045 755100                    STA     NCARS,,AUTO

      127     4845    3                  CALL DDQ$WRITE(OUT$, NCARS);

   4845  1 000277   200045 631500                    EPPR1   NCARS,,AUTO
         1 000300   200061 451500                    STP1    LNJ_INDEX+2,,AUTO
         1 000301   200044 633500                    EPPR3   OUT$,,AUTO
         1 000302   200060 453500                    STP3    LNJ_INDEX+1,,AUTO
         1 000303   200060 630500                    EPPR0   LNJ_INDEX+1,,AUTO
         1 000304   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000305   000000 701000 xent               TSX1    DDQ$WRITE
         1 000306   000000 011000                    NOP     0

      128     4846    3                END;

      129     4847    2             IF (ADDRESS = BOTTOM_FRAME) THEN EXIT;
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:22   

   4847  1 000307   200024 236100                    LDQ     ADDRESS,,AUTO
         1 000310   200041 116100                    CMPQ    BOTTOM_FRAME,,AUTO
         1 000311   000324 600000 1                  TZE     s:4852

      130     4848    2             IF MONITOR_STACK

   4848  1 000312   200043 234100                    SZN     MONITOR_STACK,,AUTO
         1 000313   000320 605000 1                  TPL     s:4850

      131     4849    2             THEN ADDRESS = ADDRESS + FRAME_SIZE + 1;

   4849  1 000314   200035 036100                    ADLQ    FRAME_SIZE,,AUTO
         1 000315   000001 036007                    ADLQ    1,DL
         1 000316   200024 756100                    STQ     ADDRESS,,AUTO
         1 000317   000207 710000 1                  TRA     s:4828

      132     4850    2             ELSE ADDRESS = ADDRESS - PREV_FRAME_SIZE - 1;

   4850  1 000320   200042 136100                    SBLQ    PREV_FRAME_SIZE,,AUTO
         1 000321   000001 136007                    SBLQ    1,DL
         1 000322   200024 756100                    STQ     ADDRESS,,AUTO

      133     4851    2           END;                            /* DO WHILE (ADDRESS ~= BOTTOM_FRAME) */

   4851  1 000323   000207 710000 1                  TRA     s:4828

      134     4852    1        RETURN;

   4852  1 000324   000000 702200 xent               TSX2  ! X66_ARET

   4849  1 000325                       BAD_STACK    null
      135     4853
      136     4854    1   BAD_STACK: ;
      137     4855    1        S_D.ERROR = 215;

   4855  1 000325   000327 235007                    LDA     215,DL
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:23   
         1 000326   000000 470400 xsym               LDP0    S_D$
         1 000327   000013 755100                    STA     11,,PR0

   4855  1 000330                       ARET         null
      138     4856    1   ARET: ;
      139     4857    1        CALL DDE$ERROR;

   4857  1 000330   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000331   000000 701000 xent               TSX1    DDE$ERROR
         1 000332   000000 011000                    NOP     0

      140     4858    1        RETURN;

   4858  1 000333   000000 702200 xent               TSX2  ! X66_ARET

      141     4859        %EJECT;
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:24   
      142     4860    1   PRINT_LOC: PROC;

   4860  1 000334   200046 741300       PRINT_LOC    STX1  ! NCARS+1,,AUTO

      143     4861        /* Local Auto */
      144     4862    2   DCL BB$ PTR;
      145     4863    2   DCL REM UBIN;
      146     4864    2   DCL NCARS UBIN;
      147     4865    2   DCL FNDOFFSET BIT(1) ALIGNED;
      148     4866    2   DCL SAVE_D$ PTR;
      149     4867    2   DCL SAVE_DESCL$ PTR;
      150     4868    2   DCL UADDRESS UBIN;
      151     4869    2   DCL CANT_SEE BIT(1) ALIGNED;
      152     4870    2   DCL LNJ_INDEX UBIN;
      153     4871        /**/
      154     4872    2        CANT_SEE = '0'B;

   4872  1 000335   200056 450100                    STZ     CANT_SEE,,AUTO

      155     4873    2        BB$ = OUT$;

   4873  1 000336   200044 236100                    LDQ     OUT$,,AUTO
         1 000337   200047 756100                    STQ     BB$,,AUTO

      156     4874    2        REM = SIZEC(S_D.OUTPUT);

   4874  1 000340   004000 235007                    LDA     2048,DL
         1 000341   200050 755100                    STA     REM,,AUTO

      157     4875    2        S_D.FNDOFFSET = '0'B;

   4875  1 000342   000000 470400 xsym               LDP0    S_D$
         1 000343   000513 450100                    STZ     331,,PR0

      158     4876                                                /* Get address to point to actual LNJ */
      159     4877    2        UADDRESS = RETURN_ADDRESS - 3;

PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:25   
   4877  1 000344   200036 235100                    LDA     RETURN_ADDRESS,,AUTO
         1 000345   000003 135007                    SBLA    3,DL
         1 000346   200055 755100                    STA     UADDRESS,,AUTO

      160     4878    2        CALL DFK$GETMVAL(VALUE, UADDRESS, USEG, UDESC#, UNOT_IS, '0'B)

   4878  1 000347   000000 236000 2                  LDQ     0
         1 000350   200065 756100                    STQ     LNJ_INDEX+6,,AUTO
         1 000351   200034 631500                    EPPR1   UNOT_IS,,AUTO
         1 000352   200064 451500                    STP1    LNJ_INDEX+5,,AUTO
         1 000353   200033 633500                    EPPR3   UDESC#,,AUTO
         1 000354   200063 453500                    STP3    LNJ_INDEX+4,,AUTO
         1 000355   200032 634500                    EPPR4   USEG,,AUTO
         1 000356   200062 454500                    STP4    LNJ_INDEX+3,,AUTO
         1 000357   200055 635500                    EPPR5   UADDRESS,,AUTO
         1 000360   200061 455500                    STP5    LNJ_INDEX+2,,AUTO
         1 000361   200003 636500                    EPPR6   VALUE,,AUTO
         1 000362   200060 456500                    STP6    LNJ_INDEX+1,,AUTO
         1 000363   200060 630500                    EPPR0   LNJ_INDEX+1,,AUTO
         1 000364   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 000365   000000 701000 xent               TSX1    DFK$GETMVAL
         1 000366   000370 702000 1                  TSX2    s:4880
         1 000367   000372 710000 1                  TRA     s:4882

      161     4879    3        WHENALTRETURN DO;

      162     4880    3             CANT_SEE = '1'B;

   4880  1 000370   400000 236003                    LDQ     -131072,DU
         1 000371   200056 756100                    STQ     CANT_SEE,,AUTO

      163     4881    3           END;

      164     4882    2        IF (BINBIT(VALUE.OPS(0), 16) & '8F80'X) = '8380'X

   4882  1 000372   200004 236100                    LDQ     VALUE+1,,AUTO
         1 000373   000024 736000                    QLS     20
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:26   
         1 000374   000022 772000                    QRL     18
         1 000375   000000 620006                    EAX0    0,QL
         1 000376   437000 360003                    ANX0    -115200,DU
         1 000377   407000 100003                    CMPX0   -127488,DU
         1 000400   000403 601000 1                  TNZ     s:4884

      165     4883    2        THEN LNJ_INDEX = 0;

   4883  1 000401   200057 450100                    STZ     LNJ_INDEX,,AUTO
         1 000402   000417 710000 1                  TRA     s:4887

      166     4884    2        ELSE IF (BINBIT(VALUE.OPS(1), 16) & '8F80'X) = '8380'X

   4884  1 000403   200005 236100                    LDQ     VALUE+2,,AUTO
         1 000404   000024 736000                    QLS     20
         1 000405   000022 772000                    QRL     18
         1 000406   000000 620006                    EAX0    0,QL
         1 000407   437000 360003                    ANX0    -115200,DU
         1 000410   407000 100003                    CMPX0   -127488,DU
         1 000411   000415 601000 1                  TNZ     s:4886

      167     4885    2             THEN LNJ_INDEX = 1;

   4885  1 000412   000001 235007                    LDA     1,DL
         1 000413   200057 755100                    STA     LNJ_INDEX,,AUTO
         1 000414   000417 710000 1                  TRA     s:4887

      168     4886    2             ELSE LNJ_INDEX = 2;

   4886  1 000415   000002 235007                    LDA     2,DL
         1 000416   200057 755100                    STA     LNJ_INDEX,,AUTO

      169     4887    2        CALL DDR$POSIT(UADDRESS + LNJ_INDEX, BB$, REM, NCARS);

   4887  1 000417   200055 236100                    LDQ     UADDRESS,,AUTO
         1 000420   200057 036100                    ADLQ    LNJ_INDEX,,AUTO
         1 000421   200060 756100                    STQ     LNJ_INDEX+1,,AUTO
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:27   
         1 000422   200051 630500                    EPPR0   NCARS,,AUTO
         1 000423   200065 450500                    STP0    LNJ_INDEX+6,,AUTO
         1 000424   200050 631500                    EPPR1   REM,,AUTO
         1 000425   200064 451500                    STP1    LNJ_INDEX+5,,AUTO
         1 000426   200047 633500                    EPPR3   BB$,,AUTO
         1 000427   200063 453500                    STP3    LNJ_INDEX+4,,AUTO
         1 000430   200060 634500                    EPPR4   LNJ_INDEX+1,,AUTO
         1 000431   200062 454500                    STP4    LNJ_INDEX+3,,AUTO
         1 000432   200062 630500                    EPPR0   LNJ_INDEX+3,,AUTO
         1 000433   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000434   000000 701000 xent               TSX1    DDR$POSIT
         1 000435   000000 011000                    NOP     0

      170     4888    2        FNDOFFSET = S_D.FNDOFFSET;

   4888  1 000436   000000 470400 xsym               LDP0    S_D$
         1 000437   000513 236100                    LDQ     331,,PR0
         1 000440   400000 376003                    ANQ     -131072,DU
         1 000441   200052 756100                    STQ     FNDOFFSET,,AUTO

      171     4889    2        BB$ = PINCRC(BB$, NCARS);

   4889  1 000442   200051 236100                    LDQ     NCARS,,AUTO
         1 000443   000020 736000                    QLS     16
         1 000444   200047 036100                    ADLQ    BB$,,AUTO
         1 000445   200047 756100                    STQ     BB$,,AUTO

      172     4890    2        REM = REM - NCARS;

   4890  1 000446   200050 236100                    LDQ     REM,,AUTO
         1 000447   200051 136100                    SBLQ    NCARS,,AUTO
         1 000450   200050 756100                    STQ     REM,,AUTO

      173     4891    2        CALL DDR$MOVE( '/', LENGTHC( '/' ), BB$, REM) ALTRET(ARET);

   4891  1 000451   200050 631500                    EPPR1   REM,,AUTO
         1 000452   200063 451500                    STP1    LNJ_INDEX+4,,AUTO
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:28   
         1 000453   200047 633500                    EPPR3   BB$,,AUTO
         1 000454   200062 453500                    STP3    LNJ_INDEX+3,,AUTO
         1 000455   000010 237000 2                  LDAQ    8
         1 000456   200060 757100                    STAQ    LNJ_INDEX+1,,AUTO
         1 000457   200060 630500                    EPPR0   LNJ_INDEX+1,,AUTO
         1 000460   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000461   000000 701000 xent               TSX1    DDR$MOVE
         1 000462   000566 702000 1                  TSX2    ARET

      174     4892    2        IF CANT_SEE

   4892  1 000463   200056 234100                    SZN     CANT_SEE,,AUTO
         1 000464   000500 605000 1                  TPL     s:4897

      175     4893    2        THEN CALL DDR$MOVE( 'can''t see this location',

   4893  1 000465   200050 630500                    EPPR0   REM,,AUTO
         1 000466   200063 450500                    STP0    LNJ_INDEX+4,,AUTO
         1 000467   200047 631500                    EPPR1   BB$,,AUTO
         1 000470   200062 451500                    STP1    LNJ_INDEX+3,,AUTO
         1 000471   000012 237000 2                  LDAQ    10
         1 000472   200060 757100                    STAQ    LNJ_INDEX+1,,AUTO
         1 000473   200060 630500                    EPPR0   LNJ_INDEX+1,,AUTO
         1 000474   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000475   000000 701000 xent               TSX1    DDR$MOVE
         1 000476   000566 702000 1                  TSX2    ARET
         1 000477   000545 710000 1                  TRA     s:4907

      176     4894    2               LENGTHC( 'can''t see this location' ),
      177     4895    2               BB$, REM ) ALTRET( ARET );
      178     4896    3        ELSE DO;

      179     4897    3             SAVE_D$ = S_D.D$;

   4897  1 000500   000000 470400 xsym               LDP0    S_D$
         1 000501   000044 236100                    LDQ     36,,PR0
         1 000502   200053 756100                    STQ     SAVE_D$,,AUTO
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:29   

      180     4898    3             SAVE_DESCL$ = S_D.DESCL$;

   4898  1 000503   000042 236100                    LDQ     34,,PR0
         1 000504   200054 756100                    STQ     SAVE_DESCL$,,AUTO

      181     4899    3             S_D.D$ = BB$;

   4899  1 000505   200047 236100                    LDQ     BB$,,AUTO
         1 000506   000044 756100                    STQ     36,,PR0

      182     4900    3             S_D.DESCL$ = PINCRC(S_D.D$, REM);

   4900  1 000507   000044 471500                    LDP1    36,,PR0
         1 000510   200050 236100                    LDQ     REM,,AUTO
         1 000511   000011 402007                    MPY     9,DL
         1 000512   100000 503506                    ABD     0,QL,PR1
         1 000513   000042 451500                    STP1    34,,PR0

      183     4901    3             CALL DFR$INSTR(VALUE.OPS(LNJ_INDEX), NCARS, '1'B) ALTRET(ARET);

   4901  1 000514   000002 236000 2                  LDQ     2
         1 000515   200062 756100                    STQ     LNJ_INDEX+3,,AUTO
         1 000516   200051 631500                    EPPR1   NCARS,,AUTO
         1 000517   200061 451500                    STP1    LNJ_INDEX+2,,AUTO
         1 000520   200057 720100                    LXL0    LNJ_INDEX,,AUTO
         1 000521   200004 633510                    EPPR3   VALUE+1,X0,AUTO
         1 000522   200060 453500                    STP3    LNJ_INDEX+1,,AUTO
         1 000523   200060 630500                    EPPR0   LNJ_INDEX+1,,AUTO
         1 000524   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000525   000000 701000 xent               TSX1    DFR$INSTR
         1 000526   000566 702000 1                  TSX2    ARET

      184     4902    3             BB$ = S_D.D$;

   4902  1 000527   000000 470400 xsym               LDP0    S_D$
         1 000530   000044 236100                    LDQ     36,,PR0
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:30   
         1 000531   200047 756100                    STQ     BB$,,AUTO

      185     4903    3             REM = POFFC(S_D.DESCL$, BB$);

   4903  1 000532   200047 236100                    LDQ     BB$,,AUTO
         1 000533   000020 772000                    QRL     16
         1 000534   200060 756100                    STQ     LNJ_INDEX+1,,AUTO
         1 000535   000042 236100                    LDQ     34,,PR0
         1 000536   000020 772000                    QRL     16
         1 000537   200060 136100                    SBLQ    LNJ_INDEX+1,,AUTO
         1 000540   200050 756100                    STQ     REM,,AUTO

      186     4904    3             S_D.D$ = SAVE_D$;

   4904  1 000541   200053 236100                    LDQ     SAVE_D$,,AUTO
         1 000542   000044 756100                    STQ     36,,PR0

      187     4905    3             S_D.DESCL$ = SAVE_DESCL$;

   4905  1 000543   200054 236100                    LDQ     SAVE_DESCL$,,AUTO
         1 000544   000042 756100                    STQ     34,,PR0

      188     4906    3           END;

      189     4907    2        CALL DDQ$WRITE(OUT$, POFFC(BB$, OUT$));

   4907  1 000545   200044 236100                    LDQ     OUT$,,AUTO
         1 000546   000020 772000                    QRL     16
         1 000547   200060 756100                    STQ     LNJ_INDEX+1,,AUTO
         1 000550   200047 236100                    LDQ     BB$,,AUTO
         1 000551   000020 772000                    QRL     16
         1 000552   200060 136100                    SBLQ    LNJ_INDEX+1,,AUTO
         1 000553   200061 756100                    STQ     LNJ_INDEX+2,,AUTO
         1 000554   200061 630500                    EPPR0   LNJ_INDEX+2,,AUTO
         1 000555   200063 450500                    STP0    LNJ_INDEX+4,,AUTO
         1 000556   200044 631500                    EPPR1   OUT$,,AUTO
         1 000557   200062 451500                    STP1    LNJ_INDEX+3,,AUTO
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:31   
         1 000560   200062 630500                    EPPR0   LNJ_INDEX+3,,AUTO
         1 000561   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000562   000000 701000 xent               TSX1    DDQ$WRITE
         1 000563   000000 011000                    NOP     0

      190     4908    2        RETURN;

   4908  1 000564   200046 221300                    LDX1  ! NCARS+1,,AUTO
         1 000565   000001 702211                    TSX2  ! 1,X1

   4905  1 000566                       ARET         null
      191     4909
      192     4910    2   ARET: ;
      193     4911    2        CALL DDE$ERROR;

   4911  1 000566   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000567   000000 701000 xent               TSX1    DDE$ERROR
         1 000570   000000 011000                    NOP     0

      194     4912    2        RETURN;

   4912  1 000571   200046 221300                    LDX1  ! NCARS+1,,AUTO
         1 000572   000001 702211                    TSX2  ! 1,X1

(unnamed)
 Sect OctLoc
   0     000   102157 164164   157155 040106   162141 155145   101163 171156    Bottom FrameAsyn
   0     004   143040 146162   141155 145040   143141 156047   164040 163145    c frame can't se
   0     010   145040 164150   151163 040154   157143 141164   151157 156040    e this location

(unnamed)
 Sect OctLoc
   2     000   000002 006000   000000 000000   000030 006000   000002 006000    ................
   2     004   000014 006000   000011 006000   057040 040040   000000 000027    ......../   ....
   2     010   000006 006000   000003 006000   000006 006000   000007 006000    ................
      195     4913    2   END PRINT_LOC;
      196     4914    1   END DFA$PLUGH;
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:32   

PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:33   
--  Include file information  --

   DD_ERR_C.:E05TOU  is referenced.
   GM_VIRTUAL_E.:E05TOU  is referenced.
   DD$BASED.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DFA$PLUGH.

   Procedure DFA$PLUGH requires 379 words for executable code.
   Procedure DFA$PLUGH requires 56 words of local(AUTO) storage.

    No errors detected in file DFA$PLUGH.:E05TSI    .
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:34   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:35   
          MINI XREF LISTING

ADDRESS
        19**DCL      4791<>CALL     4798<<ASSIGN   4799<>CALL     4805<<ASSIGN   4819<<ASSIGN   4825<<ASSIGN
      4828<>CALL     4847>>IF       4849<<ASSIGN   4849>>ASSIGN   4850<<ASSIGN   4850>>ASSIGN
ARET
      4855**LABEL    4781--GOTO     4786--GOTO     4791--CALLALT  4799--CALLALT  4817--CALLALT  4823--CALLALT
      4828--CALLALT
ARET IN PROCEDURE PRINT_LOC
      4905**LABEL    4891--CALLALT  4893--CALLALT  4901--CALLALT
BAD_STACK
      4849**LABEL    4812--GOTO
BB$ IN PROCEDURE PRINT_LOC
      4862**DCL      4873<<ASSIGN   4887<>CALL     4889<<ASSIGN   4889>>ASSIGN   4891<>CALL     4893<>CALL
      4899>>ASSIGN   4902<<ASSIGN   4903>>ASSIGN   4907>>CALL
BOTTOM_FRAME
        32**DCL      4816<<ASSIGN   4822<<ASSIGN   4847>>IF
CANT_SEE IN PROCEDURE PRINT_LOC
      4869**DCL      4872<<ASSIGN   4880<<ASSIGN   4892>>IF
DDE$ERROR
      4766**DCL-ENT  4857--CALL     4911--CALL
DDQ$WRITE
      4769**DCL-ENT  4839--CALL     4845--CALL     4907--CALL
DDR$MOVE
      4767**DCL-ENT  4891--CALL     4893--CALL
DDR$POSIT
      4768**DCL-ENT  4887--CALL
DESC#
        21**DCL      4791<>CALL     4796<<ASSIGN   4799<>CALL     4804<<ASSIGN   4817<>CALL     4828<>CALL
DFK$EVAL
      4770**DCL-ENT  4791--CALL
DFK$GETMVAL
      4771**DCL-ENT  4799--CALL     4817--CALL     4823--CALL     4828--CALL     4878--CALL
DFR$INSTR
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:36   
      4772**DCL-ENT  4901--CALL
EXPR_OP
        24**DCL      4791<>CALL
FNDOFFSET IN PROCEDURE PRINT_LOC
      4865**DCL      4888<<ASSIGN
FRAME_SIZE
        28**DCL      4830<<ASSIGN   4849>>ASSIGN
FRAME_TYPE
        31**DCL      4832<<ASSIGN   4835>>IF       4841>>IF
LNJ_INDEX IN PROCEDURE PRINT_LOC
      4870**DCL      4883<<ASSIGN   4885<<ASSIGN   4886<<ASSIGN   4887>>CALL     4901>>CALL
MONITOR_STACK
        34**DCL      4809<<ASSIGN   4811<<ASSIGN   4814>>IF       4848>>IF
NCARS
        36**DCL      4838<<ASSIGN   4839<>CALL     4844<<ASSIGN   4845<>CALL
NCARS IN PROCEDURE PRINT_LOC
      4864**DCL      4887<>CALL     4889>>ASSIGN   4890>>ASSIGN   4901<>CALL
NOT_IS
        22**DCL      4791<>CALL     4797<<ASSIGN   4799<>CALL     4806<<ASSIGN   4817<>CALL     4828<>CALL
OUT$
        35**DCL      4774<<ASSIGN   4839<>CALL     4845<>CALL     4873>>ASSIGN   4907<>CALL     4907>>CALL
PLUGH$CMD.DDESC
      4089**DCL      4788>>IF
PREV_FRAME_SIZE
        33**DCL      4833<<ASSIGN   4850>>ASSIGN
PRINT_LOC
      4860**PROC     4834--CALL
REM IN PROCEDURE PRINT_LOC
      4863**DCL      4874<<ASSIGN   4887<>CALL     4890<<ASSIGN   4890>>ASSIGN   4891<>CALL     4893<>CALL
      4900>>ASSIGN   4903<<ASSIGN
RETURN_ADDRESS
        29**DCL      4831<<ASSIGN   4877>>ASSIGN
SAVE_D$ IN PROCEDURE PRINT_LOC
      4866**DCL      4897<<ASSIGN   4904>>ASSIGN
SAVE_DESCL$ IN PROCEDURE PRINT_LOC
      4867**DCL      4898<<ASSIGN   4905>>ASSIGN
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:37   
SEG
        20**DCL      4791<>CALL     4795<<ASSIGN   4799<>CALL     4803<<ASSIGN   4817<>CALL     4828<>CALL
SIZE
        23**DCL      4791<>CALL
S_D.ANLZ
      2111**DCL      4783>>IF
S_D.CURRENT_CHANNEL
      2411**DCL      2413--REDEF
S_D.D$
      1549**DCL      4790>>ASSIGN   4897>>ASSIGN   4899<<ASSIGN   4900>>ASSIGN   4902>>ASSIGN   4904<<ASSIGN
S_D.DEBUGA
      1563**DCL      1565--REDEF
S_D.DESC$
      1543**DCL      4790<<ASSIGN
S_D.DESCL$
      1545**DCL      4898>>ASSIGN   4900<<ASSIGN   4903>>ASSIGN   4905<<ASSIGN
S_D.DO$
      1514**DCL      4788>>IF
S_D.EIS
      2521**DCL      2550--REDEF
S_D.ERROR
      1492**DCL      4780<<ASSIGN   4785<<ASSIGN   4855<<ASSIGN
S_D.FNDOFFSET
      1688**DCL      4875<<ASSIGN   4888>>ASSIGN
S_D.HOST_MESSAGE_BUF_REMOTE
      2454**DCL      2455--REDEF    2469--REDEF
S_D.JDE
      2068**DCL      2069--REDEF
S_D.L$.VALUE
      1621**DCL      1627--REDEF    1635--REDEF    1638--REDEF    1641--REDEF    1644--REDEF
S_D.L$.VALUE.L
      1622**DCL      1623--REDEF    1624--REDEF
S_D.L6_MESSAGE_BUF
      2475**DCL      2477--REDEF
S_D.OUTPUT
      2441**DCL      2443--REDEF    4774--ASSIGN   4837<<ASSIGN   4843<<ASSIGN   4874--ASSIGN
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:38   
S_D.REMOTE_MSG.FNCC
      2460**DCL      2461--REDEF
S_D.REMOTE_MSG.STXC
      2456**DCL      2457--REDEF
S_D.REMOTE_MSG.SUBFNCC
      2464**DCL      2465--REDEF
S_D.RUM
      2109**DCL      4778>>IF
S_D.SV
      1520**DCL      1541--REDEF
S_D$
      2772**DCL      1468--IMP-PTR  4774>>ASSIGN   4778>>IF       4780>>ASSIGN   4783>>IF       4785>>ASSIGN
      4788>>IF       4790>>ASSIGN   4790>>ASSIGN   4837>>ASSIGN   4843>>ASSIGN   4855>>ASSIGN   4875>>ASSIGN
      4888>>ASSIGN   4897>>ASSIGN   4898>>ASSIGN   4899>>ASSIGN   4900>>ASSIGN   4900>>ASSIGN   4902>>ASSIGN
      4903>>ASSIGN   4904>>ASSIGN   4905>>ASSIGN
T_REG
        30**DCL      4807<<ASSIGN   4816>>ASSIGN   4817<>CALL     4819>>ASSIGN
UADDRESS IN PROCEDURE PRINT_LOC
      4868**DCL      4877<<ASSIGN   4878<>CALL     4887>>CALL
UDESC#
        26**DCL      4776<<ASSIGN   4878<>CALL
UNOT_IS
        27**DCL      4777<<ASSIGN   4878<>CALL
USEG
        25**DCL      4775<<ASSIGN   4878<>CALL
VALUE
        16**DCL      4791<>CALL     4799<>CALL     4817<>CALL     4823<>CALL     4828<>CALL     4878<>CALL
VALUE.OPS
        18**DCL      4807>>ASSIGN   4807>>ASSIGN   4808>>IF       4810>>IF       4819>>ASSIGN   4822>>ASSIGN
      4822>>ASSIGN   4825>>ASSIGN   4825>>ASSIGN   4830>>ASSIGN   4831>>ASSIGN   4831>>ASSIGN   4832>>ASSIGN
      4833>>ASSIGN   4882>>IF       4884>>IF       4901<>CALL
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:39   
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DFA$PLUGH File=DFA$PLUGH.:E05TSI                              TUE 07/29/97 14:35 Page:40   
              MINI UREF LISTING

DFA$PLUGH      14**PROC
FPRG$CONTEXT    4096**DCL
