VERSION E05

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:1    
        1        1        /*M*  IGG$GET - Copy files from PO tape to disk */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* NSO,MOC,MEC,CLM=6,EXM=6,PLM=3,IND=0,IAD=3,ENU=0,CSU=3,ECU=3,THI=0,DTI=0 */
        8        8              /**/
        9        9        /**/
       10       10        /**/
       11       11        /*P*   NAME:   IGG$GETFILES
       12       12        *      PURPOSE:  Copy all files from PO tape to disk */
       13       13        /**/
       14       14        /**/
       15       15        IGG$GET: PROC(BOOTFLAG);
       16       16    1   DCL BOOTFLAG UBIN ALIGNED;
       17       17        %SUB TRUE='1'B;
       18       18        %SUB FALSE='0'B;
       19       19        %INCLUDE F$DCB;
       20       68        %INCLUDE CP_6;
       21      149        %INCLUDE F_ERRORS_C;
       22      389        %INCLUDE CP_6_SUBS;
       23      929        %INCLUDE FM$MACROS;
       24     1304        %INCLUDE I_SUBS_C;
       25     1328        %INCLUDE XUD_UTS_M;
       26     1410        %XUD$UTS_ENTRIES;
       27     1442        /**/
       28     1443        %FM$GRAN(BASED="BASED(G$)");
       29     1447        %FM$KEYTBL;
       30     1450        %CODE04(BASED="BASED(T$)");
       31     1458        %FPT_OPEN (FPTN=OPNEI,
       32     1459              DCB=M$EI,
       33     1460              DISP=NAMED,
       34     1461              ACCT=VLP_ACCT,
       35     1462              SN=VLP_SN,
       36     1463              FINDPOS=YES,
       37     1464              FPARAM=FIT_BUF.GRAN,
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:2    
       38     1465              NXTF=YES,
       39     1466              RES='MT',
       40     1467              ORG=KEYED,
       41     1468              ASN=TAPE,
       42     1469                 ACS=SEQUEN,
       43     1470              FUN=IN);
       44     1579        /**/
       45     1580        %FPT_OPEN (FPTN=OPNEO,
       46     1581               DCB=M$EO,
       47     1582               DISP=NAMED,
       48     1583               SCRUB=YES,
       49     1584               NAME=VLP_NAME,
       50     1585               ACCT=VLP_ACCT,
       51     1586               IFPARAM=FIT_BUF.GRAN,
       52     1587               ASN=FILE,
       53     1588               FUN=CREATE);
       54     1697        %FPT_OPEN(FPTN=OPNDP,
       55     1698                 DCB=M$DP,
       56     1699                 RES='DP',
       57     1700                 ASN=DEVICE,
       58     1701                 SN=ERASE,
       59     1702                 FUN=UPDATE);
       60     1811        %FPT_READ(FPTN=RSTAT,KEY=STATKEY,KEYS=YES,DCB=M$EO,BUF=FIT_BUF,STCLASS=CONSTANT);
       61     1850        %INCLUDE FX$CAT;
       62     1867        %FX$STAT(MAX=0);
       63     1870    1   DCL STATKEY BIT(18)INIT('001000'O)CONSTANT;
       64     1871        %VLP_NAME(FPTN=CATNAME,NAME=':CAT',STCLASS=CONSTANT);
       65     1898        %VLP_SN(FPTN=OPNSN,SN='SYS',STCLASS="CONSTANT SYMDEF");
       66     1911        %VLP_ACCT(FPTN=SYMI,ACCT=':SYMI');
       67     1924        %VLP_ACCT(FPTN=SYMO,ACCT=':SYMO');
       68     1937        %VLP_ACCT(FPTN=SYSTAC,ACCT=':SYSTAC');
       69     1950        %VLP_ACCT(FPTN=MAIL,ACCT=':MAIL');
       70     1963        %VLP_ACCT(FPTN=MOVE,ACCT=':MOVE');
       71     1976        /**/
       72     1977        %FPT_CLOSE (FPTN=CLSEO,DCB=M$EO,DISP=SAVE,RELG=YES);
       73     2019        %FPT_CLOSE (FPTN=CLSEI,DCB=M$EI,DISP=SAVE);
       74     2061        %FPT_CLOSE (FPTN=CLSEOREL,DCB=M$EO,DISP=SCRATCH);
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:3    
       75     2103        %FPT_CLOSE(FPTN=CLSDP,
       76     2104                 DISP=SAVE,
       77     2105                 DCB=M$DP);
       78     2147        %FPT_LDEV(STREAMNAME='LP01',REMOVE=YES);
       79     2172        %FPT_OPEN (FPTN=GETPO,STCLASS=CONSTANT,DCB=M$EI,ASN=DEVICE,
       80     2173                   SN=POSN,RES='MT',FUN=IN,ORG=FREE,SCRUB=YES);
       81     2282        %FPT_CLOSE (FPTN=RELPO,STCLASS=CONSTANT,DCB=M$EI,POS=REL);
       82     2324        %VLP_SN (FPTN=POSN,STCLASS=STATIC,N=1,SN='CP6PO1');
       83     2337        %FPT_RESCTL (FPTN=RELRESPO,STCLASS=CONSTANT,PRES=PORES);
       84     2354        %VLP_PRES (FPTN=PORES,STCLASS=STATIC,N=1,RNAME='MT01');
       85     2370        /**/
       86     2371        %FPT_WRITE  (FPTN=WRT,
       87     2372              KEY=KEYBUF,
       88     2373              DCB=M$EO,
       89     2374              FULL=YES,
       90     2375              BUF=FIT_BUF);
       91     2406        %FPT_READ (FPTN=RDT,
       92     2407              KEY=KEYBUF,
       93     2408              DCB=M$EI,
       94     2409              KEYS=NO,
       95     2410              KEYR=YES,
       96     2411              FULL=YES,
       97     2412              BUF=FIT_BUF);
       98     2451        %FPT_READ(FPTN=RDDP,
       99     2452                 DCB=M$DP,
      100     2453        KEYS=YES,KEY=GRANULE,
      101     2454                 BUF=VIDBUF);
      102     2493        %FPT_WRITE(FPTN=WRDP,
      103     2494                 DCB=M$DP,
      104     2495                 BUF=FIT_BUF.GRAN,
      105     2496                 KEY=GRANULE);
      106     2527        %FPT_WAIT(FPTN=WAIT20,UNITS=20);
      107     2541        %FPT_TIME(FPTN=CREATIME,STCLASS=CONSTANT,DEST=UTS,TSTAMP=PADFIT.CREATION);
      108     2560        /**/
      109     2561    1   DCL FXD$PMME ENTRY(1) ALTRET OPTIONAL;
      110     2562    1   DCL FXH$COUNT ENTRY ALTRET;
      111     2563    1   DCL FXH$GPSUM ENTRY ALTRET;
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:4    
      112     2564    1   DCL FXH$RECON ENTRY(1)ALTRET;
      113     2565    1   DCL XSF$LOCCODT ENTRY(2)ALTRET;
      114     2566        /**/
      115     2567    1   DCL M$DP$ PTR SYMREF;
      116     2568    1   DCL JDCB$ REDEF M$DP$ PTR;
      117     2569    1   DCL CP6VSN UBIN STATIC INIT(0);
      118     2570    1   DCL ADJSYSOK SBIN STATIC INIT(-1);
      119     2571    1   DCL 1 VSNSN STATIC,
      120     2572    1         2 * UBIN INIT(1),
      121     2573    1         2 VSN UBIN,
      122     2574    1         2 * CHAR(4) INIT(' ');
      123     2575    1   DCL BREAK UBIN STATIC SYMDEF INIT(0);
      124     2576    1   DCL SGRANS SBIN SYMREF;
      125     2577    1   DCL 1 ERR STATIC,
      126     2578    1         2 F(0:2) UBIN(6) UNAL,
      127     2579    1         2 * BIT(1),
      128     2580    1         2 CODE UBIN(14) UNAL,
      129     2581    1         2 SEV UBIN(3)UNAL;
      130     2582    1   DCL ERRCODE BIT(36) SYMREF;
      131     2583    1   DCL NEWFILES BIT(1)INIT('1'B)STATIC;
      132     2584    1   DCL RECON BIT(1)INIT('1'B)STATIC;
      133     2585    1   DCL SYSFILES BIT(1)INIT('1'B)STATIC;
      134     2586    1   DCL IGG_RECONUTS UBIN STATIC SYMDEF INIT(0);
      135     2587    1   DCL T$ PTR;
      136     2588    1   DCL M$DP DCB;
      137     2589    1   DCL M$EO DCB;
      138     2590    1   DCL M$EI DCB;
      139     2591    1   DCL M$LO DCB;
      140     2592        %VLP_ACCT (ACCT=':SYS');
      141     2605        %VLP_SN (N=9,SN=
              2605          "'CP6PO1','CP6PO2','CP6PO3','CP6PO4','CP6PO5','CP6PO6','CP6PO7','CP6PO8','CP6PO9'"
              2605            );
      142     2618    1   DCL 1 VLP_NAME STATIC DALIGNED,
      143     2619    1         2 L UBIN(9) UNAL INIT(0),
      144     2620    1         2 NAME CHAR(31) UNAL INIT(' ');
      145     2621        /**/
      146     2622    1   DCL 1 FIT_BUF STATIC SYMDEF DALIGNED,
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:5    
      147     2623    1         2 GRAN(0:1023) UBIN,
      148     2624    1         2 MRR,
      149     2625    1           3 DVC(0:1023) CHAR(4),
      150     2626    1           3 VSN(0:1023) UBIN;
      151     2627        /**/
      152     2628    1   DCL KEYBUF CHAR(256) STATIC SYMDEF;
      153     2629    1   DCL KEYBUFW(0:63) REDEF KEYBUF UBIN;
      154     2630    1   DCL 1 KEYBUFB REDEF KEYBUF,
      155     2631    1         2 * CHAR(256);
      156     2632        /**/
      157     2633    1   DCL B$TCB$ PTR SYMREF;
      158     2634        %B$TCB(STCLASS="BASED(B$TCB$)");
      159     2637        %B$ALT;
      160     2645        %SUB B$ALT=B$TCB.ALT$->B$ALT;
      161     2646        /**/
      162     2647        %VLP_NAME(FPTN=SLUGNAME,NAME='SLUG',STCLASS=CONSTANT);
      163     2674    1   DCL GRANULE STATIC UBIN INIT(0);
      164     2675    1   DCL I UBIN STATIC;
      165     2676    1   DCL SETX STATIC UBIN INIT(0);
      166     2677    1   DCL MRRCNT SBIN STATIC INIT(0);
      167     2678        %FM$VID(FM$VID=VIDBUF,BASED="STATIC SYMDEF");
      168     2684    1   DCL VIDBUFW(0:1023)REDEF VIDBUF UBIN;
      169     2685    1   DCL G$ PTR CONSTANT INIT(ADDR(FIT_BUF));
      170     2686    1   DCL 1 INITKEYTBL CONSTANT,
      171     2687    1         2 * UBIN(9) UNAL INIT(SIZEC(FM$KEYTBL));
      172     2688        %FM$GRAN(FM$GRAN=GPBUF,BASED="CONSTANT SYMDEF",
      173     2689        HASH="* INIT(BITBIN('525252525'O))",
      174     2690        GMOD="* INIT(1)",
      175     2691        NAVX="* INIT(SIZEW(FM$GRAN))",
      176     2692        FCEX="* INIT(SIZEW(FM$GRAN))",
      177     2693        HDR="* INIT('1'B)",
      178     2694        LVL="* INIT(FMGTGP)",
      179     2695        ORG="* INIT(0)",
      180     2696        ENDLVL="* INIT('0'B)",
      181     2697        X="* INIT('0'B)",
      182     2698        KEYCNT="* INIT(0)",
      183     2699        BLINK="* INIT(0)",
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:6    
      184     2700        FLINK="* INIT(0)");
      185     2704        /**/
      186     2705    1   DCL 1 PSMSG STATIC,
      187     2706    1         2 H CHAR(0) INIT('SYSTEM SET #SYS VSN LIST: '),
      188     2707    1         2 SNS CHAR(50),
      189     2708    1         2 TSN CHAR(10);
      190     2709    1   DCL SECTS(0:25) UBIN;
      191     2710    1   DCL 1 PADFIT STATIC,
      192     2711    1         2 C(0:3)BIT(36)INIT('060020'O,
      193     2712    1           '100054026004'O,
      194     2713    1           '340040020017'O,
      195     2714    1           '220000000027'O),
      196     2715        %CODE04(LEVEL=0,END=",",ACCESS=MOUNT,
      197     2716        UBIN="INIT(0)UBIN",
      198     2717        NAME="NAME INIT('GHOST1')",
      199     2718        ACCT="ACCT INIT(':SYS')");
      200     2726        %CODE14(LEVEL=0,CHAR="INIT(' ')CHAR",
      201     2727        WCDATA="* INIT('0'B)",
      202     2728        LIST="* INIT('0'B)",
      203     2729        WRCMP="* INIT('0'B)",
      204     2730        BUPF="* INIT('0'B)",
      205     2731        BUPM="* INIT('0'B)",
      206     2732        NPUR="* INIT('0'B)",
      207     2733        OWNERF="* INIT('1'B)",
      208     2734        NOACUP="NOACUP INIT('0'B)",
      209     2735        NOSTOW="* INIT('0'B)",
      210     2736        MERGEAC="* INIT('0'B)",
      211     2737        X="* INIT('0'B)",
      212     2738        GACSHELF="* INIT('0'B)",
      213     2739        NEWFD="* INIT('1'B)",
      214     2740        DFLTALL="DFLTALL INIT(%FFLG_READ#)",
      215     2741        CGMEM="CGMEM INIT(0)",
      216     2742        MGRANS="MGRANS INIT(1000)",
      217     2743        CGRANS="* INIT(0)");
      218     2753    1   DCL PADFITB(0:63)BIT(36)BASED ALIGNED;
      219     2754    1   DCL 1 VLP$ACCESS BASED ALIGNED,
      220     2755    1         2 FFLG BIT(18),
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:7    
      221     2756    1         2 ACCT CHAR(8);
      222     2757        %EJECT;
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:8    
      223     2758        /**/
      224     2759        /* Mount the system packset */
      225     2760        /* Leave any others for PIG to mount */
      226     2761        /**/
      227     2762    1   IGG$GETFILES: ENTRY(BOOTFLAG);
      228     2763    2      DO CASE(BOOTFLAG);
      229     2764    2      CASE(I_SYSFILES);
      230     2765    2         NEWFILES='0'B;
      231     2766    2         RECON='0'B;
      232     2767    2      CASE(I_SYSFILES_RECON);
      233     2768    2         NEWFILES='0'B;
      234     2769    2      CASE(I_NOFILES_RECON,I_DISKBOOT_RECON);
      235     2770    2         NEWFILES='0'B;
      236     2771    2         SYSFILES='0'B;
      237     2772    2      CASE(I_NEWFILES);
      238     2773    2      CASE(ELSE);
      239     2774    2         NEWFILES='0'B;
      240     2775    2         SYSFILES='0'B;
      241     2776    2         RECON='0'B;
      242     2777    2      END;
      243     2778    1      IF DCBADDR(DCBNUM(M$DP))~=ADDR(NIL) THEN JDCB$=DCBADDR(DCBNUM(M$DP));
      244     2779    2      ELSE DO;
      245     2780    2         GRANULE=0; SETX=0; CP6VSN=0; OPNDP.SN_=VECTOR(ERASE);
      246     2781    2         END;
      247     2782    2      DO WHILE(TRUE);
      248     2783    2         CALL M$OPEN(OPNDP)ALTRET(DPDONE);
      249     2784    2   SETNEXT: ;
      250     2785    3         CALL M$READ(RDDP) WHENRETURN DO;
      251     2786    3            IF VIDBUF.ID='CP6' THEN IF VIDBUF.PSN='CP-6''S'
      252     2787    3              AND (CP6VSN=0 OR CP6VSN=VIDBUF.VSN)
      253     2788    3            THEN CP6VSN=VIDBUF.VSN;
      254     2789    3            ELSE IF VIDBUF.PSN='SYS' AND VIDBUF.VOLCNT~=0 AND SETX=0
      255     2790    3            THEN SETX=BITBIN(VIDBUF.SNLIST.VSN(0));
      256     2791    3            ELSE IF CP6VSN~=0 AND VIDBUF.VSN=CP6VSN AND ADJSYSOK<0
      257     2792    3            THEN ADJSYSOK=VIDBUF.VOLCNT; /* >0 MEANS DONT CHANGE IT!!            */
      258     2793    4   MRRCHK:  DO;
      259     2794    4               IF VIDBUF.ID~='CP6' OR VIDBUF.VSN=0 THEN EXIT;
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:9    
      260     2795    4               IF JDCB$->F$DCB.SETX~=JDCB$->F$DCB.XTNSIZE
      261     2796    4               THEN EXIT; /* Only consider each device once                      */
      262     2797    4               FIT_BUF.MRR.VSN(MRRCNT)=0;
      263     2798    5               DO I=0 TO MRRCNT-1;
      264     2799    6                  IF FIT_BUF.MRR.VSN(I)=VIDBUF.VSN THEN DO;
      265     2800    6                     FIT_BUF.MRR.VSN(I)=FIT_BUF.MRR.VSN(I+1);
      266     2801    6                     FIT_BUF.MRR.DVC(I)=FIT_BUF.MRR.DVC(I+1);
      267     2802    6                     FIT_BUF.MRR.VSN(I+1)=VIDBUF.VSN;
      268     2803    6                     END;
      269     2804    5                  END;
      270     2805    5               IF FIT_BUF.MRR.VSN(MRRCNT)~=0 THEN DO;
      271     2806    5                  MRRCNT=MRRCNT-1;
      272     2807    5                  EXIT MRRCHK;
      273     2808    5                  END;
      274     2809    4               IF VIDBUF.MIRROR.C~='MIRROR' OR VIDBUF.MIRROR.STATE(1)~=0 THEN EXIT;
      275     2810    4               FIT_BUF.MRR.VSN(MRRCNT)=VIDBUF.VSN;
      276     2811    4               FIT_BUF.MRR.DVC(MRRCNT)=JDCB$->F$DCB.PASS;
      277     2812    4               MRRCNT=MRRCNT+1;
      278     2813    4               END;
      279     2814    3            END;
      280     2815    3         WHENALTRETURN DO;
      281     2816    3            IF ENTADDR(FXD$PMME)~=ENTADDR(NIL) THEN CALL FXD$PMME;
      282     2817    3            END;
      283     2818    2         CALL M$CLOSE(CLSDP)ALTRET(DPERR);
      284     2819    2         END;
      285     2820        /**/
      286     2821    1   DPDONE: IF ENTADDR(FXD$PMME)~=ENTADDR(NIL) THEN CALL FXD$PMME(ERR);
      287     2822    1      ELSE ERR=B$ALT.ERR;
      288     2823    1      IF ERR.CODE~=%E$SETDOWN THEN GOTO DPERR1;
      289     2824    1      OPNDP.SN_=VECTOR(VSNSN);
      290     2825    1      IF MRRCNT>0 THEN CALL WROC(11) ALTRET(SETNEXT);
      291     2826    1      VSNSN.VSN=CP6VSN;
      292     2827    1      CALL M$OPEN(OPNDP) ALTRET(DPERR);
      293     2828    1      CALL M$READ(RDDP) ALTRET(DPERR);
      294     2829    1      VIDBUF.VOLCNT=1;
      295     2830    1      VIDBUF.SNLIST.VSN.N(0)=CP6VSN;
      296     2831    1      VIDBUF.SNLIST.VSN.S(0)=1;
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:10   
      297     2832    1      VIDBUF.SNLIST.TYPE(0)=JDCB$->F$DCB.ACCT;
      298     2833    1      IF ADJSYSOK>0 THEN VIDBUF.SYSSIZE=VIDBUF.SECTSTRT(1);
      299     2834    1      VIDBUF.SNLIST.SIZE(0)=VIDBUF.SYSSIZE;
      300     2835    1      CALL M$WRITE(RDDP) ALTRET(DPERR);
      301     2836    2      IF NEWFILES THEN DO;
      302     2837    2         IF VIDBUF.SECTSTRT(1)>=JDCB$->F$DCB.IXTNSIZE
      303     2838    2         THEN VIDBUF.SECTSTRT(1)=0;
      304     2839    2         IF VIDBUF.SECTSTRT(2)<VIDBUF.SYSSIZE
      305     2840    2           OR VIDBUF.SECTSTRT(2)>JDCB$->F$DCB.IXTNSIZE
      306     2841    2         THEN VIDBUF.SECTSTRT(2)=MINIMUM (JDCB$->F$DCB.IXTNSIZE,262144);
      307     2842    2         SECTS=VIDBUF.SECTSTRT;
      308     2843    3         IF VIDBUF.SYSSIZE~=VIDBUF.SECTSTRT(1) OR SETX=0 AND ADJSYSOK<=0 THEN DO;
      309     2844    4            DO I=0 TO 62;
      310     2845    4               IF VIDBUF.SYSSIZE+3>=VIDBUF.DGT.FGRAN(I)
      311     2846    4                 AND VIDBUF.SYSSIZE<=VIDBUF.DGT.LGRAN(I)
      312     2847    4                 AND VIDBUF.DTT(I)~=262143
      313     2848    4               THEN VIDBUF.SYSSIZE=VIDBUF.DGT.LGRAN(I)+1;
      314     2849    4               END;
      315     2850    3            VIDBUF.SECTSTRT(1)=VIDBUF.SYSSIZE;
      316     2851    3            VIDBUF.SNLIST.SIZE(0)=VIDBUF.SYSSIZE;
      317     2852    3            CALL M$WRITE(RDDP) ALTRET(DPERR);
      318     2853    3            FIT_BUF.GRAN=VIDBUF;
      319     2854    3            GRANULE=SECTS(1);
      320     2855    3            SECTS(1)=VIDBUF.SECTSTRT(1);
      321     2856    3            CALL M$READ(RDDP) ALTRET(DPERR);
      322     2857    3            IF GRANULE=0 THEN VIDBUF.VOLCNT=0; /* Make a scratch if not #SYS     */
      323     2858    3            IF SETX=0 AND (GRANULE=0 OR VIDBUF.ID~='CP6'
      324     2859    4              OR VIDBUF.VOLCNT=0) THEN DO;
      325     2860    4               VIDBUF=FIT_BUF.GRAN;
      326     2861    4               VIDBUF.PSN='SYS';
      327     2862    4               VIDBUF.VOLCNT=1;
      328     2863    4               VIDBUF.SYSSIZE=0;
      329     2864    4               VIDBUF.SYSDIRDA=0;
      330     2865    4               VIDBUF.SNLIST.VSN.N(0)=VIDBUF.VSN;
      331     2866    4               VIDBUF.SNLIST.VSN.S(0)=2;
      332     2867    4               VIDBUF.SNLIST.SIZE(0)=SECTS(2)-SECTS(1);
      333     2868    4               VIDBUF.SNLIST.TYPE(0)=JDCB$->F$DCB.ACCT;
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:11   
      334     2869    4               SETX=BITBIN(VIDBUF.SNLIST.VSN(0));
      335     2870    4               END;
      336     2871    3            ELSE VIDBUF.SECTSTRT=SECTS;
      337     2872    3            GRANULE=SECTS(1);
      338     2873    4            IF VIDBUF.ID~='CP6' THEN DO;
      339     2874    4               VIDBUF=FIT_BUF.GRAN;
      340     2875    4               VIDBUF.VOLCNT=0;
      341     2876    4               END;
      342     2877    3            CALL M$WRITE(RDDP) ALTRET(DPERR);
      343     2878    3            I=2;
      344     2879    4            DO WHILE(I<26 AND GRANULE<SECTS(I)
      345     2880    4              AND SECTS(I)<JDCB$->F$DCB.IXTNSIZE);
      346     2881    4               GRANULE=SECTS(I);
      347     2882    4               CALL M$READ(RDDP) ALTRET(DPERR);
      348     2883    5               IF VIDBUF.ID~='CP6' THEN DO;
      349     2884    5                  VIDBUF=FIT_BUF.GRAN;
      350     2885    5                  VIDBUF.VOLCNT=0;
      351     2886    5                  END;
      352     2887    4               VIDBUF.SECTSTRT=SECTS;
      353     2888    4               IF VIDBUF.ID='CP6' THEN CALL M$WRITE(RDDP) ALTRET(DPERR);
      354     2889    4               I=I+1;
      355     2890    4               END;
      356     2891    3            END;
      357     2892              /* NOW FIX THE #SYS VIDS IF IT'S SECTION 2                              */
      358     2893    2         GRANULE=0;
      359     2894    2         CALL M$CLOSE(CLSDP) ALTRET(DPERR);
      360     2895    2         IF SETX=0 THEN GOTO SETERR;
      361     2896    2         VSNSN.VSN=SETX;
      362     2897    2         CALL M$OPEN(OPNDP) ALTRET(DPERR);
      363     2898    2         CALL M$READ(RDDP)ALTRET(DPERR);
      364     2899    2         I=0;
      365     2900    3         DO WHILE(I<VIDBUF.VOLCNT /* WHAT VOLUME IS IT?                          */
      366     2901    3           AND (VIDBUF.SNLIST.VSN.N(I)~=CP6VSN
      367     2902    3           OR VIDBUF.SNLIST.VSN.S(I)~=2));
      368     2903    3            I=I+1;
      369     2904    3            END;
      370     2905    2         IF I<VIDBUF.VOLCNT AND NEWFILES
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:12   
      371     2906    3           AND SECTS(2)-SECTS(1)~=VIDBUF.SNLIST.SIZE(I) THEN DO;
      372     2907    3            SECTS(0)=I;
      373     2908    4            DO I=0 TO VIDBUF.VOLCNT-1;
      374     2909    4               CALL M$CLOSE(CLSDP) ALTRET(DPERR);
      375     2910    4               VSNSN.VSN=BITBIN(VIDBUF.SNLIST.VSN(I));
      376     2911    4               CALL M$OPEN(OPNDP) ALTRET(DPERR);
      377     2912    4               CALL M$READ(RDDP) ALTRET(DPERR);
      378     2913    4               VIDBUF.SNLIST.SIZE(SECTS(0))=SECTS(2)-SECTS(1);
      379     2914    4               VIDBUF.PSN=' SYS'; /* TRASH IT SO IT CAN REJOIN ITS BUDDIES       */
      380     2915    4               CALL M$WRITE(RDDP) ALTRET(DPERR);
      381     2916    4               CALL M$CLOSE(CLSDP) ALTRET(DPERR);
      382     2917    4               CALL M$OPEN(OPNDP) ALTRET(DPERR);
      383     2918    4               VIDBUF.PSN='SYS';
      384     2919    4               CALL M$WRITE(RDDP) ALTRET(DPERR);
      385     2920    4               END;
      386     2921    3            END;
      387     2922    2         END; /* OF DO NEWFILES                                                  */
      388     2923    1      CALL M$CLOSE(CLSDP) ALTRET(DPERR);
      389     2924    1      OPNDP.SN_=VECTOR(OPNSN);
      390     2925    2      CALL M$OPEN(OPNDP) WHENALTRETURN DO;
      391     2926    2         IF ENTADDR(FXD$PMME)~=ENTADDR(NIL) THEN CALL FXD$PMME(ERR);
      392     2927    2         ELSE ERR=B$ALT.ERR;
      393     2928    2         GOTO SETERR;
      394     2929    2         END;
      395     2930    1      CALL M$READ(RDDP) ALTRET(DPERR);
      396     2931    1      SETX=0;
      397     2932    2      DO I=0 TO VIDBUF.VOLCNT-1;
      398     2933    2         CALL BINCHAR(PSMSG.TSN,VIDBUF.SNLIST.VSN.N(I));
      399     2934    2         CALL EDITSTR(PSMSG.TSN,0,9,'111'O,PSMSG.TSN);
      400     2935    2         CALL INDEX1R(SETX,' ',PSMSG.TSN);
      401     2936    2         PSMSG.TSN=SUBSTR(PSMSG.TSN,SETX+1);
      402     2937    3         IF I~=0 THEN DO;
      403     2938    3            CALL INDEX(SETX,'  ',PSMSG.SNS);
      404     2939    3            CALL INSERT(PSMSG.SNS,SETX,2,', ');
      405     2940    3            SETX=SETX+2;
      406     2941    3            END;
      407     2942    2         ELSE SETX=0;
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:13   
      408     2943    2         CALL INSERT(PSMSG.SNS,SETX,12,PSMSG.TSN);
      409     2944    3         IF VIDBUF.SNLIST.VSN.S(I)~=0 THEN DO;
      410     2945    3            CALL INDEX(SETX,'  ',PSMSG.SNS);
      411     2946    3            CALL INSERT(PSMSG.SNS,SETX,1,BINASC(VIDBUF.SNLIST.VSN.S(I)+64));
      412     2947    3            END;
      413     2948    2         END;
      414     2949    1      IF NEWFILES THEN CALL WROC(6)ALTRET(NOTOK);
      415     2950    1      FIT_BUF.GRAN=GPBUF; /* GRANULE POOL HEADER                                 */
      416     2951    1      FM$GRAN.AVAIL=1024-FM$GRAN.NAVX;
      417     2952    2      IF NEWFILES THEN DO;
      418     2953    2         GRANULE=1;
      419     2954    2         CALL M$WRITE(WRDP)ALTRET(DPERR);
      420     2955    2         CALL M$TIME(CREATIME);
      421     2956    2         FM$GRAN.FCEX=SIZEW(FM$GRAN)+SIZEW(PADFIT);
      422     2957    2         FM$GRAN.NAVX=FM$GRAN.FCEX+SIZEW(FM$KEYTBL);
      423     2958    2         FM$GRAN.AVAIL=1024-FM$GRAN.NAVX;
      424     2959    2         FM$GRAN.STAMP='274274274002'O;
      425     2960    2         FM$GRAN.LVL=FMGTPAD;
      426     2961    2         T$=PINCRW(G$,SIZEW(FM$GRAN));
      427     2962    2         T$->PADFITB=PADFIT;
      428     2963    2         T$=PINCRW(T$,SIZEW(PADFIT));
      429     2964    2         T$->FM$KEYTBL=INITKEYTBL;
      430     2965    2         GRANULE=2;
      431     2966    2         CALL M$WRITE(WRDP)ALTRET(DPERR);
      432     2967    2         FM$GRAN.FCEX=SIZEW(FM$GRAN);
      433     2968    2         FM$GRAN.NAVX=FM$GRAN.FCEX+SIZEW(FM$KEYTBL);
      434     2969    2         FM$GRAN.AVAIL=1024-FM$GRAN.NAVX;
      435     2970    2         FM$GRAN.STAMP='142142142003'O;
      436     2971    2         FM$GRAN.LVL=FMGTMAD;
      437     2972    2         PINCRW(G$,FM$GRAN.FCEX)->FM$KEYTBL=INITKEYTBL;
      438     2973    2         GRANULE=3;
      439     2974    2         CALL M$WRITE(WRDP)ALTRET(DPERR);
      440     2975    2         GRANULE=0;
      441     2976    2         END;
      442     2977    1      CLSDP.V.DISP#=%SETPRIV#;
      443     2978    1      I=0;
      444     2979    2      CALL M$CLOSE(CLSDP) WHENALTRETURN DO;
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:14   
      445     2980    2         IF ENTADDR(FXD$PMME)~=ENTADDR(NIL) THEN CALL FXD$PMME(ERR);
      446     2981    2         ELSE ERR=B$ALT.ERR;
      447     2982    2         I=ERR.CODE;
      448     2983    2         END;
      449     2984    1      IF I=%E$DUPSN THEN GOTO SETERR;
      450     2985    2      IF I=%E$PSGRANS OR I=0 AND RECON THEN DO;
      451     2986    2         IF NOT NEWFILES THEN CALL WROC(6);
      452     2987    2         ELSE IF ENTADDR(FXD$PMME)~=ENTADDR(NIL) THEN RETURN;
      453     2988    2         CALL FXH$RECON ALTRET(RECONERR);
      454     2989    2         IF NOT NEWFILES THEN CALL FXH$COUNT;
      455     2990    2         CALL M$LDEV(FPT_LDEV)ALTRET(CHKR1);
      456     2991    2   CHKR1: ;
      457     2992    2         END;
      458     2993    1      ELSE IF I~=0 THEN GOTO DPERR1;
      459     2994    2      ELSE DO;
      460     2995    2         CALL WROC(6);
      461     2996    2         CALL FXH$GPSUM;
      462     2997    2         END;
      463     2998    2      IF NEWFILES THEN DO;
      464     2999    2         OPNDP.IFPARAM_=VECTOR(PADFIT);
      465     3000    2         PADFIT.C(1)='0'B; /* NO CODE04                                          */
      466     3001    2         PADFIT.ACCESS.NOACUP='1'B; /*NOACUP,OWNERF*/
      467     3002    2         PADFIT.DFLTALL=%FFLG_EXEC#;
      468     3003    2         PADFIT.MGRANS=99999;
      469     3004    2         PADFIT.CGMEM=511;
      470     3005    2         OPNDP.ACCT_=OPNEO.ACCT_;
      471     3006    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);
      472     3007    2         OPNDP.ACCT_=VECTOR(MAIL);
      473     3008    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);
      474     3009    2         OPNDP.ACCT_=VECTOR(SYSTAC);
      475     3010    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);
      476     3011    2         PADFIT.DFLTALL='0'B;
      477     3012    2         OPNDP.ACCT_=VECTOR(SYMI);
      478     3013    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);
      479     3014    2         OPNDP.ACCT_=VECTOR(SYMO);
      480     3015    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);
      481     3016    2         PADFIT.C(3)='220014006004'O; /* ACCess account                          */
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:15   
      482     3017    2         ADDR(PADFIT.MOUNT)->VLP$ACCESS.FFLG=%FFLG_WRITE#;
      483     3018    2         ADDR(PADFIT.MOUNT)->VLP$ACCESS.ACCT=':NCTL';
      484     3019    2         PADFIT.DFLTALL=%FFLG_NOLIST#;
      485     3020    2         OPNDP.ACCT_=VECTOR(MOVE);
      486     3021    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);
      487     3022    2         OPNDP.IFPARAM_=VECTOR(NIL);
      488     3023    2         END;
      489     3024    2      ELSE DO WHILE SGRANS<2000;
      490     3025    3         CALL WROC(9) WHENALTRETURN DO;
      491     3026    3            CALL WROC (10);
      492     3027    3            END;
      493     3028    2         END;
      494     3029    1      CALL M$OPEN(OPNDP)ALTRET(RECON_LEFT_OPEN);
      495     3030    1   RECON_LEFT_OPEN:;
      496     3031        /* REMEMBER RECONSTRUCT TIME FOR RELSTARF IN RECOVERY */
      497     3032    1      GRANULE=2;
      498     3033    1      CALL M$READ(RDDP)ALTRET(DPERR);
      499     3034    1      T$=ADDR(VIDBUFW(SIZEW(FM$GRAN)));
      500     3035    1      CALL XSF$LOCCODT(T$,4)ALTRET(NORECUTS);
      501     3036    1      IGG_RECONUTS=CODE04.MODIFY.TIME;
      502     3037    1   NORECUTS:;
      503     3038    1      CLSDP.V.DISP#=%SETPUB#;
      504     3039    1      CALL M$CLOSE(CLSDP)ALTRET(SETERR);
      505     3040    2      IF NOT SYSFILES THEN DO;
      506     3041    2   ALLDONE: ;
      507     3042    2         IF BOOTFLAG=I_RECOVERY THEN RETURN;
      508     3043    3         IF BOOTFLAG<I_DISKBOOT THEN DO;
      509     3044    3            IF NOT SYSFILES THEN CALL M$OPEN(GETPO) ALTRET(RELPOERR1);
      510     3045    3            CALL M$CLOSE(RELPO) ALTRET(RELPOERR1);
      511     3046    4            DO WHILE(FALSE);
      512     3047    4   RELPOERR1:  CALL M$RELRES(RELRESPO) ALTRET(RELPOERR2);
      513     3048    4               END;
      514     3049    3   RELPOERR2: END;
      515     3050    2         OPNEO.V.FUN#=%UPDATE#;
      516     3051    2         OPNEO.V.ACS#=%DIRECT#;
      517     3052    2         VLP_NAME=CATNAME;
      518     3053    2         OPNEO.IFPARAM_=VECTOR(NIL);
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:16   
      519     3054    2         CALL M$OPEN(OPNEO)ALTRET(NOCAT);
      520     3055    2         CALL M$READ(RSTAT)ALTRET(NOCAT);
      521     3056    2         ADDR(FIT_BUF)->FX$STAT.NUM=0;
      522     3057    2         ADDR(FIT_BUF)->FX$STAT.SETS.SETX(0)=0;
      523     3058    2         WRT.BUF_.BOUND=SIZEV(FX$STAT);
      524     3059    2         WRT.BUF_.BUF$=ADDR(FIT_BUF);
      525     3060    2         KEYBUFB=STATKEY;
      526     3061    2         CALL M$WRITE(WRT)ALTRET(NOCAT);
      527     3062    2         CALL M$CLOSE(CLSEO)ALTRET(NOCAT);
      528     3063    2   NOCAT: ;
      529     3064    2         RETURN;
      530     3065    2         END;
      531     3066    1      JDCB$=DCBADDR(DCBNUM(M$EI));
      532     3067        /*
      533     3068        *  COPY THE FILES IN FROM THE TAPE TO THE DISK.
      534     3069        **/
      535     3070    2      DO WHILE (TRUE);
      536     3071    2         CALL M$OPEN(OPNEI) ALTRET(CONTTEST);
      537     3072    2         OPNEI.V.OPER.NXTF#='1'B;
      538     3073    2         OPNEI.V.VOL#=0;
      539     3074    2         IF JDCB$->F$DCB.NAME.C='$DUMMYFILE' THEN GOTO NXTPHASE2;
      540     3075    2         VLP_NAME=JDCB$->F$DCB.NAME;
      541     3076    2   OPNSLUG: ;
      542     3077    2         IF JDCB$->F$DCB.IORG=%RANDOM# THEN RDT.BUF_.BOUND=4095;
      543     3078    2         ELSE RDT.BUF_.BOUND=SIZEV(FIT_BUF);
      544     3079    2         IF JDCB$->F$DCB.ORG=%RESTRICT# THEN OPNEO.V.ACS#=%BLOCK#;
      545     3080    2         ELSE OPNEO.V.ACS#=%DIRECT#;
      546     3081    2         CALL M$OPEN(OPNEO) ALTRET(OUTERR);
      547     3082        /**/
      548     3083    3         DO WHILE (TRUE);
      549     3084    4            CALL M$READ(RDT) WHENRETURN DO;
      550     3085    4               IF JDCB$->F$DCB.ORG=%RESTRICT# THEN
      551     3086    4               KEYBUFW(0)=FIT_BUF.GRAN(0);
      552     3087    4               WRT.V.DVBYTE=JDCB$->F$DCB.DVBYTE;
      553     3088    4               WRT.V.DVBYTE.CONT#='0'B;
      554     3089    4               END; WHENALTRETURN DO;
      555     3090    4               WRT.V.DVBYTE=JDCB$->F$DCB.DVBYTE;
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:17   
      556     3091    4               IF B$ALT.ERR.CODE=%E$LD THEN WRT.V.DVBYTE.CONT#='1'B;
      557     3092    4               ELSE GOTO TESTEOF;
      558     3093    4               END;
      559     3094    4            IF JDCB$->F$DCB.ARS>0 THEN DO;
      560     3095    4               WRT.BUF_.BUF$=ADDR(FIT_BUF);
      561     3096    4               WRT.BUF_.BOUND=JDCB$->F$DCB.ARS-1;
      562     3097    4               END;
      563     3098    3            ELSE
      564     3099    3            WRT.BUF_=VECTOR(NIL);
      565     3100    3            CALL M$WRITE(WRT) ALTRET(IOERR);
      566     3101    3            RDT.V.DVBYTE.CONT#=WRT.V.DVBYTE.CONT#;
      567     3102    3            END;
      568     3103        /**/
      569     3104    2   TESTEOF: IF B$ALT.ERR.CODE~=%E$EOF
      570     3105    2         THEN CALL WROC(2,0);
      571     3106    2   NXTPHASE1:
      572     3107    2         CALL M$CLOSE(CLSEO) ALTRET(CLSEOERR);
      573     3108    2   NXTPHASE2:
      574     3109    2         IF JDCB$->F$DCB.FCD
      575     3110    2         THEN CALL M$CLOSE(CLSEI) ALTRET(CLSEIERR);
      576     3111    2         CLSEI.V.POS#=0;
      577     3112    2   NXTPHASE3:
      578     3113    2         IF OPNEI.V.ASN#=%FILE# THEN GOTO ALLDONE;
      579     3114    2         END;
      580     3115        /**/
      581     3116    1   CONTTEST:
      582     3117    1      IF B$ALT.ERR.CODE~=%E$EOSET THEN
      583     3118    1      CALL WROC(0,0) ALTRET (NXTPHASE2);
      584     3119    1      OPNEI.V.ASN#=%FILE#;
      585     3120    1      OPNEI.SN_=VECTOR(ERASE);
      586     3121    1      OPNEI.V.OPER.THISF#=%YES#;
      587     3122    1      OPNEI.V.OPER.TEST#=%YES#;
      588     3123    1      OPNEI.NAME_=VECTOR(SLUGNAME);
      589     3124    1      CALL M$OPEN(OPNEI);
      590     3125    2      IF JDCB$->F$DCB.NAME.L>4 AND SUBSTR(JDCB$->F$DCB.NAME.C,0,4)='SLUG' THEN DO;
      591     3126    2         VLP_NAME=SLUGNAME;
      592     3127    2         GOTO OPNSLUG;
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:18   
      593     3128    2         END;
      594     3129    1      GOTO ALLDONE;
      595     3130        /**/
      596     3131    1   RECONERR: ERR=ERRCODE;
      597     3132    1      GOTO DPERR1;
      598     3133    1   DPERR:
      599     3134    1      IF ENTADDR(FXD$PMME)~=ENTADDR(NIL) THEN CALL FXD$PMME(ERR);
      600     3135    1      ELSE ERR=B$ALT.ERR;
      601     3136    1   DPERR1:;
      602     3137    1      ERR.SEV=0;
      603     3138    2      DO WHILE '1'B;
      604     3139    2         CALL WROC1(4,2);
      605     3140    2         END;
      606     3141    1   SETERR: VIDBUF.PSN=JDCB$->F$DCB.PSN;
      607     3142    1      OPNDP.SN_=VECTOR(ERASE);
      608     3143        /* WAIT FOR OPERATOR TO MOUNT SOMETHING */
      609     3144    2      IF CLSDP.V.DISP#=%SAVE# THEN DO;
      610     3145    2   SETERR1: ERR.SEV=0;
      611     3146    2         CALL WROC1(0,3);
      612     3147    2         CALL M$WAIT(WAIT20);
      613     3148    2         END;
      614     3149    2      ELSE DO I=0 TO 9999;
      615     3150    2         CLSDP.V.DISP#=%SAVE#;
      616     3151    2         END;
      617     3152    1      SETX=0;
      618     3153    1      CALL M$OPEN(OPNDP)ALTRET(SETERR1);
      619     3154    1      GOTO SETNEXT;
      620     3155    1   NOTOK: ;
      621     3156    1      CALL M$CLOSE(CLSDP) ALTRET(NOTOK1);
      622     3157    1   NOTOK1: ;
      623     3158    1      CALL WROC(7);
      624     3159    1      OPNDP.SN_=VECTOR(ERASE);
      625     3160    1      CALL M$WAIT(WAIT20);
      626     3161    1      CALL M$OPEN(OPNDP)ALTRET(NOTOK);
      627     3162    1      SETX=0;
      628     3163    1      GOTO SETNEXT;
      629     3164    1   CLSEIERR:
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:19   
      630     3165    1      CALL WROC(1,0);
      631     3166    1      GOTO NXTPHASE3;
      632     3167    1   CLSEOERR:
      633     3168    1      CALL WROC(1,1);
      634     3169    1      GOTO NXTPHASE2;
      635     3170    1   IOERR:
      636     3171    1      CALL WROC(3,1);
      637     3172    1      CALL M$CLOSE(CLSEI);
      638     3173    1      CALL M$CLOSE(CLSEOREL);
      639     3174    1      GOTO NXTPHASE3;
      640     3175    1   OUTERR:
      641     3176    1      CALL WROC(0,1);
      642     3177    1      CALL M$CLOSE(CLSEI);
      643     3178    1      GOTO NXTPHASE3;
      644     3179        %EJECT;
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:20   
      645     3180        /**/
      646     3181        /**/
      647     3182        /**/
      648     3183    1   WROC: PROC(PMME,ASN)ALTRET;
      649     3184    2   DCL PMME UBIN;
      650     3185    2   DCL ASN UBIN;
      651     3186    2   DCL TEMP_INT SBIN WORD;
      652     3187        /**/
      653     3188    2   DCL DCB$ PTR;
      654     3189    2   DCL I UBIN;
      655     3190        %FPT_ERRMSG(BUF=FIT_BUF,CODE=ERR,FPTN=EFPT);
      656     3217    2   DCL CHAR1200 BASED CHAR(1200);
      657     3218    2   DCL EBUF BASED(FPT_TEMPWROC.BUFW_.BUFW$)CHAR(120);
      658     3219    2   DCL 1 MSG1 STATIC,
      659     3220    2         2 * CHAR(0) INIT('ERROR '),
      660     3221    2         2 F(0:2) CHAR(1),
      661     3222    2         2 * CHAR(0) INIT('-'),
      662     3223    2         2 D CHAR(5),
      663     3224    2         2 B CHAR(0) INIT(' '),
      664     3225    2         2 P CHAR(4),
      665     3226    2         2 * CHAR(0) INIT('ING '),
      666     3227    2         2 A CHAR(4);
      667     3228    2   DCL MSG2 CONSTANT CHAR(0) INIT(', FILE=');
      668     3229    2   DCL MSG3 CONSTANT BIT(18) INIT('015012'O);
      669     3230    2   DCL MSG3C REDEF MSG3 CHAR(2);
      670     3231    2   DCL MSG8 CONSTANT CHAR(0)INIT('INITIALIZATION ABORTED');
      671     3232    2   DCL P(0:4) CONSTANT CHAR(4) INIT('OPEN','CLOS','READ','WRIT','INIT');
      672     3233    2   DCL A(0:3) CONSTANT CHAR(4) INIT('TAPE','DISK','PACK','SET');
      673     3234    2   DCL MSG4 CONSTANT CHAR(0) INIT('VSN=');
      674     3235    2   DCL MSG7 CONSTANT CHAR(0)INIT('AS YOU WISH . . . PLEASE MOUNT SOMETHING ELSE');
      675     3236    2   DCL 1 WMSG CONSTANT,
      676     3237    2         2 * BIT(18) INIT('015012'O),
      677     3238    2         2 * CHAR(0) INIT('OK TO PROCEED (Y/N)? ');
      678     3239    2   DCL DELMSG1 CONSTANT CHAR(0) INIT('DP#SYS HAS ONLY ');
      679     3240    2   DCL 1 DELMSG2 CONSTANT,
      680     3241    2         2 * CHAR(0) INIT(' FREE GRANULES.'),
      681     3242    2         2 * BIT(18) INIT('015012'O),
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:21   
      682     3243    2         2 * CHAR(0) INIT('ENTER ACCOUNT NAME TO REVIEW: ');
      683     3244    2   DCL DELMSG3 CONSTANT CHAR(0) INIT('FILENAME .. GRANULES:(D-ELETE/Q-UIT)');
      684     3245    2   DCL MRRMSG1 CONSTANT CHAR(0)
      685     3246    2    INIT('UNPAIRED MIRROR DISKS DETECTED - LIST FOLLOWS');
      686     3247    2   DCL 1 MRRMSG2 CONSTANT,
      687     3248    2         2 * BIT(18) INIT('015012'O),
      688     3249    2         2 * CHAR(0) INIT('ENTER Y TO TERMINATE MIRROR, N TO SKIP, Q TO GET OUT');
      689     3250    2   DCL 1 MRRMSG3 STATIC,
      690     3251    2         2 * BIT(18) INIT('015012'O),
      691     3252    2         2 * CHAR(0) INIT('DONT MIRROR '),
      692     3253    2         2 DVC CHAR(4),
      693     3254    2         2 * CHAR(0) INIT(' VSN='),
      694     3255    2         2 VSN CHAR(0) INIT('123456789012 (Y/N/Q)?');
      695     3256    2   DCL INMSG CHAR(12) STATIC;
      696     3257    2   DCL 1 MSGW1 REDEF INMSG,
      697     3258    2         2 T BIT(27),
      698     3259    2         2 * CHAR(9);
      699     3260    2   DCL 1 MSGW2 REDEF INMSG,
      700     3261    2         2 W1 BIT(36),
      701     3262    2         2 W2 BIT(36),
      702     3263    2         2 W3 BIT(36);
      703     3264    2   DCL 1 MSG9 STATIC,
      704     3265    2         2 * BIT(18)INIT('015012'O),
      705     3266    2         2 * CHAR(0)INIT(
      706     3267    2   'TIMEWARP DETECTED. YOU SAY IT''S '),
      707     3268    2         2 NT CHAR(5),2 * CHAR(2)INIT(', '),
      708     3269    2         2 ND CHAR(3),2 NP CHAR(12),2 NM CHAR(10),
      709     3270    2         2 * BIT(18)INIT('015012'O),
      710     3271    2         2 * CHAR(0)INIT(
      711     3272    2   'CP6 WAS UP AT '),
      712     3273    2         2 PT CHAR(5),2 * CHAR(2)INIT(', '),
      713     3274    2         2 PD CHAR(3),2 PP CHAR(12),2 PM CHAR(10),
      714     3275    2         2 * CHAR(0)INIT('. ? FOR HELP ');
      715     3276    2   DCL PERS(0:3) CONSTANT CHAR(11) INIT(
      716     3277    2   ' WEE HOURS,',' MORNING,',' AFTERNOON,',' EVENING,');
      717     3278    2   DCL 1 MSG91 CONSTANT,
      718     3279    2         2 * BIT(18)INIT('015012'O),2 * CHAR(0) INIT(
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:22   
      719     3280    2   'DID YOU ENTER THE CORRECT TIME AND DATE? IF NOT, YOU MUST REBOOT'),
      720     3281    2         2 * BIT(18)INIT('015012'O),2 * CHAR(0) INIT(
      721     3282    2   'IF CP6 WAS DOWN FOR >9 HOURS THEN TYPE ''YES$'' TO PROCEED.');
      722     3283    2   DCL 1 TERMSG CONSTANT,
      723     3284    2         2 * BIT(18) INIT('015012'O),
      724     3285    2         2 * CHAR(0) INIT('Y TO TRY A NEW TAPE - ELSE SKIP THE FILE?');
      725     3286        %EJECT;
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:23   
      726     3287        %FPT_OPEN (FPTN=DEL1ST, SCRUB=YES, ACCT=INMSG, NXTF=YES, TEST=YES, FUN=IN,
      727     3288                   FPARAM=FIT_BUF, SN=OPNSN, ASN=FILE, DCB=M$EO, STCLASS=CONSTANT);
      728     3397        %FPT_OPEN (FPTN=DELNXT, NXTF=YES, TEST=YES, FPARAM=FIT_BUF, DCB=M$EO,
      729     3398                   STCLASS=CONSTANT);
      730     3507        %FPT_OPEN (FPTN=DELTHIS, DCB=M$EO, DELETE=YES);
      731     3616        %FPT_OPEN(FPTN=TESTERRLOG,STCLASS=CONSTANT,DCB=M$EO,NAME=ERRNAME,ASN=FILE,
      732     3617              ACCT=SYSTAC,SN=OPNSN,NXTF=YES,REV=YES,FUN=IN);
      733     3726        %VLP_NAME(FPTN=ERRNAME,STCLASS=CONSTANT,NAME=':ERRLOGA');
      734     3753        %FPT_PRECORD(FPTN=ERRLOGTIME,STCLASS=CONSTANT,KEY=ERRK,KEYS=YES,N=-1,
      735     3754              KEYR=YES,DCB=M$EO);
      736     3775        %FPT_CLOSE(FPTN=CLOSLOG,STCLASS=CONSTANT,DCB=M$EO);
      737     3817        %FPT_TIME(STCLASS=CONSTANT,TSTAMP=NOWTIME,DATE=MSG9.NM,TIME=INMSG,DAY=MSG9.ND);
      738     3836        %FPT_TIME(STCLASS=CONSTANT,TSTAMP=ERRK,DATE=MSG9.PM,TIME=INMSG,DAY=MSG9.PD,
      739     3837              FPTN=ERRTIME,SOURCE=UTS);
      740     3856        %SUB WINDOW=9;
      741     3857        %FPT_MONINFO(STCLASS=CONSTANT,SITEINFO=FIT_BUF);
      742     3872        %VLR_SITEINFO(STCLASS=BASED);
      743     3891    2   DCL NOWTIME UBIN STATIC;
      744     3892    2   DCL 1 ERRK STATIC,
      745     3893    2         2 TIME UBIN INIT(BITBIN('777777777777'O)),
      746     3894    2         2 * CHAR(4);
      747     3895    2   DCL ALPH CONSTANT CHAR(0) INIT(
      748     3896    2         '?ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789');
      749     3897    2   DCL ALPHA(0:36) REDEF ALPH CHAR(1);
      750     3898        %FPT_REM (DISP=REM);
      751     3912        %FPT_TEMPWROC;
      752     3928        /**/
      753     3929    2      ERR=B$ALT.ERR; /* SAVE THE ERROR                                           */
      754     3930    2      ERR.SEV=0;
      755     3931    2   WROC1: ENTRY(PMME,ASN)ALTRET;
      756     3932    2      FPT_TEMPWROC.BUFW_=VECTOR(MSG3);
      757     3933    2      FPT_TEMPWROC.BUFR_=VECTOR(NIL);
      758     3934    2      CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);
      759     3935    3      IF PMME=11 THEN DO;
      760     3936    3         FPT_TEMPWROC.BUFW_=VECTOR(MRRMSG1);
      761     3937    3         CALL M$TEMPWROC (FPT_TEMPWROC) ALTRET(NOWROC);
      762     3938    3         FPT_TEMPWROC.BUFW_=VECTOR(MRRMSG2);
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:24   
      763     3939    3         CALL M$TEMPWROC (FPT_TEMPWROC) ALTRET(NOWROC);
      764     3940    3         FPT_TEMPWROC.BUFR_=VECTOR(INMSG);
      765     3941    4         DO I=0 TO MRRCNT-1;
      766     3942    4            FPT_TEMPWROC.BUFW_=VECTOR(MRRMSG3);
      767     3943    4            MRRMSG3.DVC=FIT_BUF.MRR.DVC(I);
      768     3944    4            CALL BINCHAR(SUBSTR(MRRMSG3.VSN,0,12),FIT_BUF.MRR.VSN(I));
      769     3945    5            DO WHILE SUBSTR(MRRMSG3.VSN,0,1)='0';
      770     3946    5               MRRMSG3.VSN=SUBSTR(MRRMSG3.VSN,1);
      771     3947    5               FPT_TEMPWROC.BUFW_.BOUND=FPT_TEMPWROC.BUFW_.BOUND-1;
      772     3948    5               END;
      773     3949    4            IF FIT_BUF.MRR.VSN(I)=CP6VSN AND SETX=0 THEN INMSG='Y';
      774     3950    4            ELSE INMSG=' ';
      775     3951    4            CALL M$TEMPWROC (FPT_TEMPWROC) ALTRET(NOWROC);
      776     3952    4            IF (MSGW1.T&'737'O)=(ASCBIT('Q')) THEN EXIT;
      777     3953    5            IF (MSGW1.T&'737'O)=(ASCBIT('Y')) THEN DO;
      778     3954    5               VSNSN.VSN=FIT_BUF.MRR.VSN(I);
      779     3955    6               CALL M$OPEN (OPNDP) WHENRETURN DO;
      780     3956    6                  CALL M$READ(RDDP) ALTRET(DPERR);
      781     3957    6                  VIDBUF.MIRROR.C=' ';
      782     3958    6                  CALL M$WRITE(RDDP) ALTRET(DPERR);
      783     3959    6                  CALL M$CLOSE(CLSDP) ALTRET(DPERR);
      784     3960    6                  END;
      785     3961    6               WHENALTRETURN DO;
      786     3962    6   DPERR:         IF ENTADDR(FXD$PMME)~=ENTADDR(NIL) THEN CALL FXD$PMME;
      787     3963    6                  END;
      788     3964    5               FIT_BUF.MRR.VSN(0)=0;
      789     3965    5               END;
      790     3966    4            END;
      791     3967    3         MRRCNT=0;
      792     3968    3         IF FIT_BUF.MRR.VSN(0)~=0 THEN RETURN;
      793     3969    3         OPNDP.SN_=VECTOR(ERASE);
      794     3970    4         CALL M$OPEN (OPNDP) WHENALTRETURN DO;
      795     3971    4            IF ENTADDR(FXD$PMME)~=ENTADDR(NIL) THEN CALL FXD$PMME;
      796     3972    4            END;
      797     3973    3         ALTRETURN;
      798     3974    3         END;
      799     3975        /**/
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:25   
      800     3976    3      IF PMME=10 THEN DO;
      801     3977    3         FPT_TEMPWROC.BUFW_=VECTOR(DELMSG3);
      802     3978    3         CALL M$TEMPWROC (FPT_TEMPWROC) ALTRET(NOWROC);
      803     3979    4   OP1:  CALL M$OPEN (DEL1ST) WHENALTRETURN DO;
      804     3980    4            I=BITBIN(MSGW2.W1&'140140140140'O);
      805     3981    4            MSGW2.W3=BINBIT(I,36)&BINBIT(I/2,36);
      806     3982    4            MSGW2.W1=MSGW2.W1\MSGW2.W3;
      807     3983    4            I=BITBIN(MSGW2.W2&'140140140140'O);
      808     3984    4            I=BITBIN(BINBIT(I,36)&BINBIT(I/2,36));
      809     3985    4            IF I=0 AND MSGW2.W3='0'B
      810     3986    4            THEN RETURN;
      811     3987    4            MSGW2.W2=MSGW2.W2&BINBIT(I,36);
      812     3988    4            GOTO OP1;
      813     3989    4            END;
      814     3990    3         FPT_TEMPWROC.BUFR_=VECTOR(INMSG);
      815     3991    3         FPT_TEMPWROC.BUFW_.BUFW$=ADDR(FIT_BUF);
      816     3992    3         DCB$=DCBADDR(DCBNUM(M$EO));
      817     3993    3   NXTFILE:;
      818     3994    4         IF DCB$->F$DCB.IXTNSIZE>99 THEN DO;
      819     3995    4            SUBSTR(EBUF,0,2)=%CONCAT(BITASC('015'O),BITASC('012'O));
      820     3996    4            I=DCB$->F$DCB.NAME.L;
      821     3997    4            SUBSTR(EBUF,2,I+1)=SUBSTR(DCB$->F$DCB.NAME.C,0,I);
      822     3998    4            CALL BINCHAR (SUBSTR(EBUF,I+3,5),DCB$->F$DCB.IXTNSIZE);
      823     3999    4            SUBSTR(EBUF,I+8,3)=' ? ';
      824     4000    4            FPT_TEMPWROC.BUFW_.BOUND=I+10;
      825     4001    4            INMSG=' ';
      826     4002    4            CALL M$TEMPWROC (FPT_TEMPWROC) ALTRET(NOWROC);
      827     4003    5            IF (MSGW1.T&'737'O)=ASCBIT('D') THEN DO;
      828     4004    6               CALL M$OPEN (DELTHIS) WHENRETURN DO;
      829     4005    6                  SGRANS=SGRANS+DCB$->F$DCB.IXTNSIZE;
      830     4006    6                  END;
      831     4007    5               END;
      832     4008    4            ELSE IF (MSGW1.T&'737'O)=ASCBIT('Q') THEN RETURN;
      833     4009    4            END;
      834     4010    4         CALL M$OPEN (DELNXT) WHENRETURN DO;
      835     4011    4            GOTO NXTFILE;
      836     4012    4            END;
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:26   
      837     4013    3         RETURN;
      838     4014    3         END;
      839     4015        /**/
      840     4016    3      IF PMME=9 THEN DO;
      841     4017    3         FPT_TEMPWROC.BUFW_=VECTOR(DELMSG1);
      842     4018    3         CALL M$TEMPWROC (FPT_TEMPWROC) ALTRET(NOWROC);
      843     4019    3         CALL BINCHAR (INMSG, SGRANS);
      844     4020    3         I=0;
      845     4021    4         DO WHILE SUBSTR(INMSG,I,1)='0' AND I<11;
      846     4022    4            I=I+1;
      847     4023    4            END;
      848     4024    3         FPT_TEMPWROC.BUFW_=VECTOR(SUBSTR(INMSG,I));
      849     4025    3         CALL M$TEMPWROC (FPT_TEMPWROC) ALTRET(NOWROC);
      850     4026    3         FPT_TEMPWROC.BUFW_=VECTOR(DELMSG2);
      851     4027    3         INMSG=' ';
      852     4028    3         FPT_TEMPWROC.BUFR_=VECTOR(INMSG);
      853     4029    3         FPT_TEMPWROC.V.TYC='1'B;
      854     4030    4         DO WHILE FPT_TEMPWROC.V.TYC;
      855     4031    4            CALL M$TEMPWROC (FPT_TEMPWROC) ALTRET(NOWROC);
      856     4032    4            FPT_TEMPWROC.BUFW_=VECTOR(NIL);
      857     4033    4            END;
      858     4034    3         IF INMSG=' ' THEN SGRANS=2000;
      859     4035    3         ELSE ALTRETURN; RETURN;
      860     4036    3         END;
      861     4037    3      IF PMME=7 THEN DO;
      862     4038    3         FPT_TEMPWROC.BUFW_=VECTOR(MSG7);
      863     4039    3         CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);
      864     4040    3         RETURN;
      865     4041    3         END;
      866     4042    3      IF PMME=6 THEN DO;
      867     4043    3         FPT_TEMPWROC.BUFW_.BUFW$=ADDR(PSMSG);
      868     4044    3         CALL INDEX(I,'  ',PSMSG.SNS);
      869     4045    3         FPT_TEMPWROC.BUFW_.BOUND=I+SIZEV(PSMSG.H);
      870     4046    3         CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);
      871     4047    3         CALL M$MONINFO(FPT_MONINFO);
      872     4048    4         IF NOT NEWFILES THEN DO;
      873     4049    4            CALL M$OPEN(TESTERRLOG)ALTRET(TIMEOK);
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:27   
      874     4050    4            CALL M$TIME(FPT_TIME);
      875     4051    4            CALL M$PRECORD(ERRLOGTIME)ALTRET(TIMEOK);
      876     4052    5            IF NOWTIME> ERRK.TIME THEN DO;
      877     4053    5               CALL XUD$UTS_DIFF_SEC(TEMP_INT,NOWTIME,ERRK.TIME);
      878     4054    5               IF TEMP_INT < WINDOW*3600 THEN GOTO TIMEOK;
      879     4055    5               END;
      880     4056    4            MSG9.NT=INMSG;
      881     4057    4            CALL CHARBIN(I,SUBSTR(INMSG,0,2));
      882     4058    4            MSG9.NP=PERS(I/6);
      883     4059    4            CALL M$TIME(ERRTIME);
      884     4060    4            MSG9.PT=INMSG;
      885     4061    4            CALL CHARBIN(I,SUBSTR(INMSG,0,2));
      886     4062    4            MSG9.PP=PERS(I/6);
      887     4063    4            FPT_TEMPWROC.BUFW_=VECTOR(MSG9);
      888     4064    4            FPT_TEMPWROC.BUFR_=VECTOR(INMSG);
      889     4065    4   TIMEAGIN: ;
      890     4066    4            INMSG='0';
      891     4067    4            FPT_TEMPWROC.V.TYC='1'B;
      892     4068    5            DO WHILE(FPT_TEMPWROC.V.TYC);
      893     4069    5               CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);
      894     4070    6               IF INMSG='?' THEN DO;
      895     4071    6                  FPT_TEMPWROC.BUFW_=VECTOR(MSG91);
      896     4072    6                  GOTO TIMEAGIN;
      897     4073    6                  END;
      898     4074    5               FPT_TEMPWROC.BUFW_=VECTOR(NIL);
      899     4075    5               END;
      900     4076    4            MSGW1.T=MSGW1.T&'737737737'O; /* CONVERT TO U.C.                     */
      901     4077    4            IF INMSG~='YES$' THEN CALL INDEX(I,'LADC L66C',
      902     4078    4              ADDR(FIT_BUF)->VLR_SITEINFO.SITE_NAME#.C)
      903     4079    4              ALTRET(ABORT);
      904     4080    4   TIMEOK:  CALL M$CLOSE(CLOSLOG);
      905     4081    4            RETURN;
      906     4082    4            END;
      907     4083    3         FPT_TEMPWROC.BUFW_=VECTOR(WMSG);
      908     4084    3         FPT_TEMPWROC.BUFR_=VECTOR(INMSG);
      909     4085    3         INMSG='Y';
      910     4086    3         FPT_TEMPWROC.V.TYC='1'B;
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:28   
      911     4087    4         DO WHILE(FPT_TEMPWROC.V.TYC);
      912     4088    4            CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);
      913     4089    4            FPT_TEMPWROC.BUFW_=VECTOR(NIL);
      914     4090    4            END;
      915     4091    3         IF (MSGW1.T&'737'O)=ASCBIT('Y') THEN RETURN;
      916     4092    3         ALTRETURN;
      917     4093    3         END;
      918     4094    3      IF ERR.SEV=7 THEN DO;
      919     4095    3   ABORT: ;
      920     4096    3         FPT_TEMPWROC.BUFW_=VECTOR(MSG8);
      921     4097    3         CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);
      922     4098    4         DO WHILE('1'B);
      923     4099    4            I=1;
      924     4100    4            END;
      925     4101    3         END;
      926     4102    2      ADDR(FIT_BUF)->CHAR1200=' ';
      927     4103    2      IF ASN=0 THEN EFPT.V.DCB#=DCBNUM(M$EI);
      928     4104    2      ELSE IF ASN=1 THEN EFPT.V.DCB#=DCBNUM(M$EO);
      929     4105    2      ELSE EFPT.V.DCB#=DCBNUM(M$DP);
      930     4106    2      IF NEWFILES AND CLSDP.V.DISP#=%SAVE# THEN GOTO NOERMSG;
      931     4107    2      CALL M$ERRMSG(EFPT)ALTRET(NOERMSG);
      932     4108    2      FPT_TEMPWROC.BUFW_.BUFW$=ADDR(FIT_BUF);
      933     4109    3      DO WHILE(SUBSTR(EBUF,2,118)~=' ');
      934     4110    3         I=119;
      935     4111    4         DO WHILE(SUBSTR(EBUF,I,1)=' ');
      936     4112    4            I=I-1;
      937     4113    4            END;
      938     4114    3         FPT_TEMPWROC.BUFW_.BOUND=I;
      939     4115    3         CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);
      940     4116    3         FPT_TEMPWROC.BUFW_.BUFW$=PINCRW(FPT_TEMPWROC.BUFW_.BUFW$,30);
      941     4117    3         IF SUBSTR(EBUF,0,2)~=' '
      942     4118    3         THEN FPT_TEMPWROC.BUFW_.BUFW$=PINCRC(FPT_TEMPWROC.BUFW_.BUFW$,-2);
      943     4119    3         CALL INSERT(EBUF,0,2,MSG3C);
      944     4120    3         END;
      945     4121    2      GOTO ERMSGOK;
      946     4122    2   NOERMSG:;
      947     4123    3      DO I=0 TO 2;
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:29   
      948     4124    3         MSG1.F(I)=ALPHA(ERR.F(I));
      949     4125    3         END;
      950     4126    2      CALL BINCHAR(MSG1.D,ERR.CODE);
      951     4127    2      MSG1.P=P(PMME);
      952     4128    2      MSG1.A=A(ASN);
      953     4129    2      FPT_TEMPWROC.BUFW_=VECTOR(MSG1);
      954     4130    2      CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);
      955     4131    3      IF PMME+ASN~=0 THEN DO;
      956     4132    3         IF ASN=0 THEN
      957     4133    3         DCB$=DCBADDR(DCBNUM(M$EI));
      958     4134    3         ELSE
      959     4135    3         DCB$=DCBADDR(DCBNUM(M$EO));
      960     4136    4         IF PMME=4 THEN DO;
      961     4137    4            FPT_TEMPWROC.BUFW_=VECTOR(MSG1.B);
      962     4138    4            CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);
      963     4139    4            FPT_TEMPWROC.BUFW_=VECTOR(JDCB$->F$DCB.PASS);
      964     4140    4            CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);
      965     4141    4            END;
      966     4142    4         IF ASN=3 AND SETX~=0 THEN DO;
      967     4143    4            FPT_TEMPWROC.BUFW_=VECTOR(MSG4);
      968     4144    4            CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);
      969     4145    4            FPT_TEMPWROC.BUFW_=VECTOR(VIDBUF.PSN);
      970     4146    4            CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);
      971     4147    4            END;
      972     4148    4         IF DCB$->F$DCB.NAME.C~=' ' AND ASN~=3 THEN DO;
      973     4149    4            FPT_TEMPWROC.BUFW_=VECTOR(MSG2);
      974     4150    4            CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);
      975     4151    4            FPT_TEMPWROC.BUFW_.BUFW$=ADDR(DCB$->F$DCB.NAME.C);
      976     4152    4            FPT_TEMPWROC.BUFW_.BOUND=DCB$->F$DCB.NAME.L-1;
      977     4153    4            CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);
      978     4154    4            END;
      979     4155    3         END;
      980     4156    2   ERMSGOK:;
      981     4157    3      IF ASN=0 THEN DO;
      982     4158    3         FPT_TEMPWROC.BUFW_=VECTOR(TERMSG);
      983     4159    3         FPT_TEMPWROC.BUFR_=VECTOR(INMSG);
      984     4160    3         INMSG='N';
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:30   
      985     4161    4         DO UNTIL NOT FPT_TEMPWROC.V.TYC;
      986     4162    4            CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);
      987     4163    4            FPT_TEMPWROC.BUFW_=VECTOR(NIL);
      988     4164    4            END;
      989     4165    3         IF (MSGW1.T&'737'O)~=ASCBIT('Y') THEN ALTRETURN;
      990     4166    3         CLSEI.V.POS#=%REM#;
      991     4167    3         IF JDCB$->F$DCB.FSECT>1
      992     4168    3         THEN OPNEI.V.VOL#=JDCB$->F$DCB.VOL-1;
      993     4169    4         IF PMME=0 THEN DO;
      994     4170    4            FPT_REM.V.PSN#=VLP_SN.SN#(JDCB$->F$DCB.VOL-1);
      995     4171    4            CALL M$REM (FPT_REM);
      996     4172    4            END;
      997     4173    3         OPNEI.V.OPER.NXTF#='0'B;
      998     4174    3         ALTRETURN;
      999     4175    3         END;
     1000     4176    2      ERR.SEV=ERR.SEV+1;
     1001     4177    2      RETURN;
     1002     4178        /**/
     1003     4179    2   NOWROC:; /* Altret has to mean running in debug mode. Let FXD do it.          */
     1004     4180    2      IF ENTADDR(FXD$PMME)~=ENTADDR(NIL) THEN CALL FXD$PMME;
     1005     4181    2      ELSE CALL M$MERC;
     1006     4182    2   END WROC;
     1007     4183    1   END IGG$GET;

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:31   
--  Include file information  --

   FX$CAT.:E05TOU  is referenced.
   XUD_UTS_M.:E05TOU  is referenced.
   I_SUBS_C.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure IGG$GET.

   Procedure IGG$GET requires 1987 words for executable code.
   Procedure IGG$GET requires 42 words of local(AUTO) storage.

    No errors detected in file IGG$GET.:E05TSI    .

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:32   

 Object Unit name= IGG$GET                                    File name= IGG$GET.:E05TOU
 UTS= JUL 29 '97 22:33:33.16 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none  4798  11276  IGG$GET
    2  RoData even  UTS    582   1106  IGG$GET
    3   DCB   even  none     0      0  M$DP
    4   DCB   even  none     0      0  M$EO
    5   DCB   even  none     0      0  M$EI
    6   DCB   even  none     0      0  M$LO
    7   Proc  even  none  1987   3703  IGG$GET
    8  RoData even  none    99    143  IGG$GET

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     7      0   yes            yes      Std        1  IGG$GET
     7      3                  yes      Std        1  IGG$GETFILES

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    2     22  OPNSN                              1    621  BREAK
    1    626  IGG_RECONUTS                       1    662  FIT_BUF
    1   6662  KEYBUF                             1   6766  VIDBUF
    2    220  GPBUF
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:33   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 FXH$COUNT
 yes     yes           Std       0 FXH$GPSUM
 yes     yes    yes    Std       1 FXD$PMME
 yes     yes           Std       2 XSF$LOCCODT
 yes     yes           Std       1 FXH$RECON
 yes     yes           Std       3 XUD$UTS_DIFF_SEC
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_INDEX

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$DP$                                 SGRANS
     ERRCODE                               M$DP                                  M$EO
     M$EI                                  M$LO                                  B$TCB$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:34   


        1        1        /*M*  IGG$GET - Copy files from PO tape to disk */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* NSO,MOC,MEC,CLM=6,EXM=6,PLM=3,IND=0,IAD=3,ENU=0,CSU=3,ECU=3,THI=0,DTI=0 */
        8        8              /**/
        9        9        /**/
       10       10        /**/
       11       11        /*P*   NAME:   IGG$GETFILES
       12       12        *      PURPOSE:  Copy all files from PO tape to disk */
       13       13        /**/
       14       14        /**/
       15       15        IGG$GET: PROC(BOOTFLAG);

     15  7 000000   000000 700200 xent  IGG$GET      TSX0  ! X66_AUTO_1
         7 000001   000052 000001                    ZERO    42,1
         7 000002   000005 710000 7                  TRA     s:2763

       16       16    1   DCL BOOTFLAG UBIN ALIGNED;
       17       17        %SUB TRUE='1'B;
       18       18        %SUB FALSE='0'B;
       19       19        %INCLUDE F$DCB;
       20       68        %INCLUDE CP_6;
       21      149        %INCLUDE F_ERRORS_C;
       22      389        %INCLUDE CP_6_SUBS;
       23      929        %INCLUDE FM$MACROS;
       24     1304        %INCLUDE I_SUBS_C;
       25     1328        %INCLUDE XUD_UTS_M;
       26     1410        %XUD$UTS_ENTRIES;
       27     1442        /**/
       28     1443        %FM$GRAN(BASED="BASED(G$)");
       29     1447        %FM$KEYTBL;
       30     1450        %CODE04(BASED="BASED(T$)");
       31     1458        %FPT_OPEN (FPTN=OPNEI,
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:35   
       32     1459              DCB=M$EI,
       33     1460              DISP=NAMED,
       34     1461              ACCT=VLP_ACCT,
       35     1462              SN=VLP_SN,
       36     1463              FINDPOS=YES,
       37     1464              FPARAM=FIT_BUF.GRAN,
       38     1465              NXTF=YES,
       39     1466              RES='MT',
       40     1467              ORG=KEYED,
       41     1468              ASN=TAPE,
       42     1469                 ACS=SEQUEN,
       43     1470              FUN=IN);
       44     1579        /**/
       45     1580        %FPT_OPEN (FPTN=OPNEO,
       46     1581               DCB=M$EO,
       47     1582               DISP=NAMED,
       48     1583               SCRUB=YES,
       49     1584               NAME=VLP_NAME,
       50     1585               ACCT=VLP_ACCT,
       51     1586               IFPARAM=FIT_BUF.GRAN,
       52     1587               ASN=FILE,
       53     1588               FUN=CREATE);
       54     1697        %FPT_OPEN(FPTN=OPNDP,
       55     1698                 DCB=M$DP,
       56     1699                 RES='DP',
       57     1700                 ASN=DEVICE,
       58     1701                 SN=ERASE,
       59     1702                 FUN=UPDATE);
       60     1811        %FPT_READ(FPTN=RSTAT,KEY=STATKEY,KEYS=YES,DCB=M$EO,BUF=FIT_BUF,STCLASS=CONSTANT);
       61     1850        %INCLUDE FX$CAT;
       62     1867        %FX$STAT(MAX=0);
       63     1870    1   DCL STATKEY BIT(18)INIT('001000'O)CONSTANT;
       64     1871        %VLP_NAME(FPTN=CATNAME,NAME=':CAT',STCLASS=CONSTANT);
       65     1898        %VLP_SN(FPTN=OPNSN,SN='SYS',STCLASS="CONSTANT SYMDEF");
       66     1911        %VLP_ACCT(FPTN=SYMI,ACCT=':SYMI');
       67     1924        %VLP_ACCT(FPTN=SYMO,ACCT=':SYMO');
       68     1937        %VLP_ACCT(FPTN=SYSTAC,ACCT=':SYSTAC');
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:36   
       69     1950        %VLP_ACCT(FPTN=MAIL,ACCT=':MAIL');
       70     1963        %VLP_ACCT(FPTN=MOVE,ACCT=':MOVE');
       71     1976        /**/
       72     1977        %FPT_CLOSE (FPTN=CLSEO,DCB=M$EO,DISP=SAVE,RELG=YES);
       73     2019        %FPT_CLOSE (FPTN=CLSEI,DCB=M$EI,DISP=SAVE);
       74     2061        %FPT_CLOSE (FPTN=CLSEOREL,DCB=M$EO,DISP=SCRATCH);
       75     2103        %FPT_CLOSE(FPTN=CLSDP,
       76     2104                 DISP=SAVE,
       77     2105                 DCB=M$DP);
       78     2147        %FPT_LDEV(STREAMNAME='LP01',REMOVE=YES);
       79     2172        %FPT_OPEN (FPTN=GETPO,STCLASS=CONSTANT,DCB=M$EI,ASN=DEVICE,
       80     2173                   SN=POSN,RES='MT',FUN=IN,ORG=FREE,SCRUB=YES);
       81     2282        %FPT_CLOSE (FPTN=RELPO,STCLASS=CONSTANT,DCB=M$EI,POS=REL);
       82     2324        %VLP_SN (FPTN=POSN,STCLASS=STATIC,N=1,SN='CP6PO1');
       83     2337        %FPT_RESCTL (FPTN=RELRESPO,STCLASS=CONSTANT,PRES=PORES);
       84     2354        %VLP_PRES (FPTN=PORES,STCLASS=STATIC,N=1,RNAME='MT01');
       85     2370        /**/
       86     2371        %FPT_WRITE  (FPTN=WRT,
       87     2372              KEY=KEYBUF,
       88     2373              DCB=M$EO,
       89     2374              FULL=YES,
       90     2375              BUF=FIT_BUF);
       91     2406        %FPT_READ (FPTN=RDT,
       92     2407              KEY=KEYBUF,
       93     2408              DCB=M$EI,
       94     2409              KEYS=NO,
       95     2410              KEYR=YES,
       96     2411              FULL=YES,
       97     2412              BUF=FIT_BUF);
       98     2451        %FPT_READ(FPTN=RDDP,
       99     2452                 DCB=M$DP,
      100     2453        KEYS=YES,KEY=GRANULE,
      101     2454                 BUF=VIDBUF);
      102     2493        %FPT_WRITE(FPTN=WRDP,
      103     2494                 DCB=M$DP,
      104     2495                 BUF=FIT_BUF.GRAN,
      105     2496                 KEY=GRANULE);
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:37   
      106     2527        %FPT_WAIT(FPTN=WAIT20,UNITS=20);
      107     2541        %FPT_TIME(FPTN=CREATIME,STCLASS=CONSTANT,DEST=UTS,TSTAMP=PADFIT.CREATION);
      108     2560        /**/
      109     2561    1   DCL FXD$PMME ENTRY(1) ALTRET OPTIONAL;
      110     2562    1   DCL FXH$COUNT ENTRY ALTRET;
      111     2563    1   DCL FXH$GPSUM ENTRY ALTRET;
      112     2564    1   DCL FXH$RECON ENTRY(1)ALTRET;
      113     2565    1   DCL XSF$LOCCODT ENTRY(2)ALTRET;
      114     2566        /**/
      115     2567    1   DCL M$DP$ PTR SYMREF;
      116     2568    1   DCL JDCB$ REDEF M$DP$ PTR;
      117     2569    1   DCL CP6VSN UBIN STATIC INIT(0);
      118     2570    1   DCL ADJSYSOK SBIN STATIC INIT(-1);
      119     2571    1   DCL 1 VSNSN STATIC,
      120     2572    1         2 * UBIN INIT(1),
      121     2573    1         2 VSN UBIN,
      122     2574    1         2 * CHAR(4) INIT(' ');
      123     2575    1   DCL BREAK UBIN STATIC SYMDEF INIT(0);
      124     2576    1   DCL SGRANS SBIN SYMREF;
      125     2577    1   DCL 1 ERR STATIC,
      126     2578    1         2 F(0:2) UBIN(6) UNAL,
      127     2579    1         2 * BIT(1),
      128     2580    1         2 CODE UBIN(14) UNAL,
      129     2581    1         2 SEV UBIN(3)UNAL;
      130     2582    1   DCL ERRCODE BIT(36) SYMREF;
      131     2583    1   DCL NEWFILES BIT(1)INIT('1'B)STATIC;
      132     2584    1   DCL RECON BIT(1)INIT('1'B)STATIC;
      133     2585    1   DCL SYSFILES BIT(1)INIT('1'B)STATIC;
      134     2586    1   DCL IGG_RECONUTS UBIN STATIC SYMDEF INIT(0);
      135     2587    1   DCL T$ PTR;
      136     2588    1   DCL M$DP DCB;
      137     2589    1   DCL M$EO DCB;
      138     2590    1   DCL M$EI DCB;
      139     2591    1   DCL M$LO DCB;
      140     2592        %VLP_ACCT (ACCT=':SYS');
      141     2605        %VLP_SN (N=9,SN=
              2605         "'CP6PO1','CP6PO2','CP6PO3','CP6PO4','CP6PO5','CP6PO6','CP6PO7','CP6PO8','CP6PO9'"
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:38   
              2605            );
      142     2618    1   DCL 1 VLP_NAME STATIC DALIGNED,
      143     2619    1         2 L UBIN(9) UNAL INIT(0),
      144     2620    1         2 NAME CHAR(31) UNAL INIT(' ');
      145     2621        /**/
      146     2622    1   DCL 1 FIT_BUF STATIC SYMDEF DALIGNED,
      147     2623    1         2 GRAN(0:1023) UBIN,
      148     2624    1         2 MRR,
      149     2625    1           3 DVC(0:1023) CHAR(4),
      150     2626    1           3 VSN(0:1023) UBIN;
      151     2627        /**/
      152     2628    1   DCL KEYBUF CHAR(256) STATIC SYMDEF;
      153     2629    1   DCL KEYBUFW(0:63) REDEF KEYBUF UBIN;
      154     2630    1   DCL 1 KEYBUFB REDEF KEYBUF,
      155     2631    1         2 * CHAR(256);
      156     2632        /**/
      157     2633    1   DCL B$TCB$ PTR SYMREF;
      158     2634        %B$TCB(STCLASS="BASED(B$TCB$)");
      159     2637        %B$ALT;
      160     2645        %SUB B$ALT=B$TCB.ALT$->B$ALT;
      161     2646        /**/
      162     2647        %VLP_NAME(FPTN=SLUGNAME,NAME='SLUG',STCLASS=CONSTANT);
      163     2674    1   DCL GRANULE STATIC UBIN INIT(0);
      164     2675    1   DCL I UBIN STATIC;
      165     2676    1   DCL SETX STATIC UBIN INIT(0);
      166     2677    1   DCL MRRCNT SBIN STATIC INIT(0);
      167     2678        %FM$VID(FM$VID=VIDBUF,BASED="STATIC SYMDEF");
      168     2684    1   DCL VIDBUFW(0:1023)REDEF VIDBUF UBIN;
      169     2685    1   DCL G$ PTR CONSTANT INIT(ADDR(FIT_BUF));
      170     2686    1   DCL 1 INITKEYTBL CONSTANT,
      171     2687    1         2 * UBIN(9) UNAL INIT(SIZEC(FM$KEYTBL));
      172     2688        %FM$GRAN(FM$GRAN=GPBUF,BASED="CONSTANT SYMDEF",
      173     2689        HASH="* INIT(BITBIN('525252525'O))",
      174     2690        GMOD="* INIT(1)",
      175     2691        NAVX="* INIT(SIZEW(FM$GRAN))",
      176     2692        FCEX="* INIT(SIZEW(FM$GRAN))",
      177     2693        HDR="* INIT('1'B)",
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:39   
      178     2694        LVL="* INIT(FMGTGP)",
      179     2695        ORG="* INIT(0)",
      180     2696        ENDLVL="* INIT('0'B)",
      181     2697        X="* INIT('0'B)",
      182     2698        KEYCNT="* INIT(0)",
      183     2699        BLINK="* INIT(0)",
      184     2700        FLINK="* INIT(0)");
      185     2704        /**/
      186     2705    1   DCL 1 PSMSG STATIC,
      187     2706    1         2 H CHAR(0) INIT('SYSTEM SET #SYS VSN LIST: '),
      188     2707    1         2 SNS CHAR(50),
      189     2708    1         2 TSN CHAR(10);
      190     2709    1   DCL SECTS(0:25) UBIN;
      191     2710    1   DCL 1 PADFIT STATIC,
      192     2711    1         2 C(0:3)BIT(36)INIT('060020'O,
      193     2712    1           '100054026004'O,
      194     2713    1           '340040020017'O,
      195     2714    1           '220000000027'O),
      196     2715        %CODE04(LEVEL=0,END=",",ACCESS=MOUNT,
      197     2716        UBIN="INIT(0)UBIN",
      198     2717        NAME="NAME INIT('GHOST1')",
      199     2718        ACCT="ACCT INIT(':SYS')");
      200     2726        %CODE14(LEVEL=0,CHAR="INIT(' ')CHAR",
      201     2727        WCDATA="* INIT('0'B)",
      202     2728        LIST="* INIT('0'B)",
      203     2729        WRCMP="* INIT('0'B)",
      204     2730        BUPF="* INIT('0'B)",
      205     2731        BUPM="* INIT('0'B)",
      206     2732        NPUR="* INIT('0'B)",
      207     2733        OWNERF="* INIT('1'B)",
      208     2734        NOACUP="NOACUP INIT('0'B)",
      209     2735        NOSTOW="* INIT('0'B)",
      210     2736        MERGEAC="* INIT('0'B)",
      211     2737        X="* INIT('0'B)",
      212     2738        GACSHELF="* INIT('0'B)",
      213     2739        NEWFD="* INIT('1'B)",
      214     2740        DFLTALL="DFLTALL INIT(%FFLG_READ#)",
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:40   
      215     2741        CGMEM="CGMEM INIT(0)",
      216     2742        MGRANS="MGRANS INIT(1000)",
      217     2743        CGRANS="* INIT(0)");
      218     2753    1   DCL PADFITB(0:63)BIT(36)BASED ALIGNED;
      219     2754    1   DCL 1 VLP$ACCESS BASED ALIGNED,
      220     2755    1         2 FFLG BIT(18),
      221     2756    1         2 ACCT CHAR(8);
      222     2757        %EJECT;
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:41   
      223     2758        /**/
      224     2759        /* Mount the system packset */
      225     2760        /* Leave any others for PIG to mount */
      226     2761        /**/
      227     2762    1   IGG$GETFILES: ENTRY(BOOTFLAG);

   2762  7 000003   000000 700200 xent  IGG$GETFILES TSX0  ! X66_AUTO_1
         7 000004   000052 000001                    ZERO    42,1

      228     2763    2      DO CASE(BOOTFLAG);

   2763  7 000005   200003 470500                    LDP0    @BOOTFLAG,,AUTO
         7 000006   000000 235100                    LDA     0,,PR0
         7 000007   000011 115007                    CMPA    9,DL
         7 000010   000012 602005 7                  TNC     s:2763+5,AL
         7 000011   000033 710000 7                  TRA     s:2774
         7 000012   000033 710000 7                  TRA     s:2774
         7 000013   000033 710000 7                  TRA     s:2774
         7 000014   000036 710000 7                  TRA     s:2778
         7 000015   000023 710000 7                  TRA     s:2765
         7 000016   000033 710000 7                  TRA     s:2774
         7 000017   000026 710000 7                  TRA     s:2768
         7 000020   000030 710000 7                  TRA     s:2770
         7 000021   000033 710000 7                  TRA     s:2774
         7 000022   000030 710000 7                  TRA     s:2770

      229     2764    2      CASE(I_SYSFILES);

      230     2765    2         NEWFILES='0'B;

   2765  7 000023   000623 450000 1                  STZ     NEWFILES

      231     2766    2         RECON='0'B;

   2766  7 000024   000624 450000 1                  STZ     RECON
         7 000025   000036 710000 7                  TRA     s:2778

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:42   
      232     2767    2      CASE(I_SYSFILES_RECON);

      233     2768    2         NEWFILES='0'B;

   2768  7 000026   000623 450000 1                  STZ     NEWFILES
         7 000027   000036 710000 7                  TRA     s:2778

      234     2769    2      CASE(I_NOFILES_RECON,I_DISKBOOT_RECON);

      235     2770    2         NEWFILES='0'B;

   2770  7 000030   000623 450000 1                  STZ     NEWFILES

      236     2771    2         SYSFILES='0'B;

   2771  7 000031   000625 450000 1                  STZ     SYSFILES
         7 000032   000036 710000 7                  TRA     s:2778

      237     2772    2      CASE(I_NEWFILES);

      238     2773    2      CASE(ELSE);

      239     2774    2         NEWFILES='0'B;

   2774  7 000033   000623 450000 1                  STZ     NEWFILES

      240     2775    2         SYSFILES='0'B;

   2775  7 000034   000625 450000 1                  STZ     SYSFILES

      241     2776    2         RECON='0'B;

   2776  7 000035   000624 450000 1                  STZ     RECON

      242     2777    2      END;

      243     2778    1      IF DCBADDR(DCBNUM(M$DP))~=ADDR(NIL) THEN JDCB$=DCBADDR(DCBNUM(M$DP));
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:43   

   2778  7 000036   000000 236007 xsym               LDQ     M$DP,DL
         7 000037   000000 471400 8                  LDP1    0
         7 000040   100000 473500                    LDP3    0,,PR1
         7 000041   300000 236106                    LDQ     0,QL,PR3
         7 000042   000001 116000 xsym               CMPQ    B_VECTNIL+1
         7 000043   000050 600000 7                  TZE     s:2780

   2778  7 000044   000000 236007 xsym               LDQ     M$DP,DL
         7 000045   300000 236106                    LDQ     0,QL,PR3
         7 000046   000000 756000 xsym               STQ     M$DP$
         7 000047   000055 710000 7                  TRA     s:2783

      244     2779    2      ELSE DO;

      245     2780    2         GRANULE=0; SETX=0; CP6VSN=0; OPNDP.SN_=VECTOR(ERASE);

   2780  7 000050   006762 450000 1                  STZ     GRANULE

   2780  7 000051   006764 450000 1                  STZ     SETX

   2780  7 000052   000614 450000 1                  STZ     CP6VSN

   2780  7 000053   000002 237000 8                  LDAQ    2
         7 000054   000166 757000 1                  STAQ    OPNDP+2

      246     2781    2         END;

      247     2782    2      DO WHILE(TRUE);

      248     2783    2         CALL M$OPEN(OPNDP)ALTRET(DPDONE);

   2783  7 000055   000164 630400 1                  EPPR0   OPNDP
         7 000056   450000 713400                    CLIMB   alt,open
         7 000057   410400 401760                    pmme    nvectors=18
         7 000060   000230 702000 7                  TSX2    DPDONE

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:44   
   2783  7 000061                       SETNEXT      null
      249     2784    2   SETNEXT: ;
      250     2785    3         CALL M$READ(RDDP) WHENRETURN DO;

   2785  7 000061   000554 630400 1                  EPPR0   RDDP
         7 000062   440000 713400                    CLIMB   alt,read
         7 000063   401400 401760                    pmme    nvectors=4
         7 000064   000215 702000 7                  TSX2    s:2816

      251     2786    3            IF VIDBUF.ID='CP6' THEN IF VIDBUF.PSN='CP-6''S'

   2786  7 000065   040000 106400                    CMPC    fill='040'O
         7 000066   006766 000004 1                  ADSC9   VIDBUF                   cn=0,n=4
         7 000067   001054 000003 2                  ADSC9   ALPH+10                  cn=0,n=3
         7 000070   000132 601000 7                  TNZ     MRRCHK

   2786  7 000071   040000 106400                    CMPC    fill='040'O
         7 000072   006771 000006 1                  ADSC9   VIDBUF+3                 cn=0,n=6
         7 000073   001055 000006 2                  ADSC9   ALPH+11                  cn=0,n=6
         7 000074   000105 601000 7                  TNZ     s:2789
         7 000075   000614 235000 1                  LDA     CP6VSN
         7 000076   000102 600000 7                  TZE     s:2788
         7 000077   000614 236000 1                  LDQ     CP6VSN
         7 000100   006770 116000 1                  CMPQ    VIDBUF+2
         7 000101   000105 601000 7                  TNZ     s:2789

      252     2787    3              AND (CP6VSN=0 OR CP6VSN=VIDBUF.VSN)
      253     2788    3            THEN CP6VSN=VIDBUF.VSN;

   2788  7 000102   006770 236000 1                  LDQ     VIDBUF+2
         7 000103   000614 756000 1                  STQ     CP6VSN
         7 000104   000132 710000 7                  TRA     MRRCHK

      254     2789    3            ELSE IF VIDBUF.PSN='SYS' AND VIDBUF.VOLCNT~=0 AND SETX=0

   2789  7 000105   040000 106400                    CMPC    fill='040'O
         7 000106   006771 000006 1                  ADSC9   VIDBUF+3                 cn=0,n=6
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:45   
         7 000107   001057 000003 2                  ADSC9   ALPH+13                  cn=0,n=3
         7 000110   000120 601000 7                  TNZ     s:2791
         7 000111   006772 720000 1                  LXL0    VIDBUF+4
         7 000112   000120 600000 7                  TZE     s:2791
         7 000113   006764 235000 1                  LDA     SETX
         7 000114   000120 601000 7                  TNZ     s:2791

      255     2790    3            THEN SETX=BITBIN(VIDBUF.SNLIST.VSN(0));

   2790  7 000115   007466 236000 1                  LDQ     VIDBUF+320
         7 000116   006764 756000 1                  STQ     SETX
         7 000117   000132 710000 7                  TRA     MRRCHK

      256     2791    3            ELSE IF CP6VSN~=0 AND VIDBUF.VSN=CP6VSN AND ADJSYSOK<0

   2791  7 000120   000614 235000 1                  LDA     CP6VSN
         7 000121   000132 600000 7                  TZE     MRRCHK
         7 000122   006770 236000 1                  LDQ     VIDBUF+2
         7 000123   000614 116000 1                  CMPQ    CP6VSN
         7 000124   000132 601000 7                  TNZ     MRRCHK
         7 000125   000615 235000 1                  LDA     ADJSYSOK
         7 000126   000132 605000 7                  TPL     MRRCHK

      257     2792    3            THEN ADJSYSOK=VIDBUF.VOLCNT; /* >0 MEANS DONT CHANGE IT!!            */

   2792  7 000127   006772 236000 1                  LDQ     VIDBUF+4
         7 000130   777777 376007                    ANQ     -1,DL
         7 000131   000615 756000 1                  STQ     ADJSYSOK

      258     2793    4   MRRCHK:  DO;

   2793  7 000132                       MRRCHK       null
      259     2794    4               IF VIDBUF.ID~='CP6' OR VIDBUF.VSN=0 THEN EXIT;

   2794  7 000132   040000 106400                    CMPC    fill='040'O
         7 000133   006766 000004 1                  ADSC9   VIDBUF                   cn=0,n=4
         7 000134   001054 000003 2                  ADSC9   ALPH+10                  cn=0,n=3
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:46   
         7 000135   000214 601000 7                  TNZ     s:2814
         7 000136   006770 235000 1                  LDA     VIDBUF+2
         7 000137   000214 600000 7                  TZE     s:2814

      260     2795    4               IF JDCB$->F$DCB.SETX~=JDCB$->F$DCB.XTNSIZE

   2795  7 000140   000000 470400 xsym               LDP0    M$DP$
         7 000141   000051 720100                    LXL0    41,,PR0
         7 000142   000037 100100                    CMPX0   31,,PR0
         7 000143   000214 601000 7                  TNZ     s:2814

      261     2796    4               THEN EXIT; /* Only consider each device once                      */
      262     2797    4               FIT_BUF.MRR.VSN(MRRCNT)=0;

   2797  7 000144   006765 721000 1                  LXL1    MRRCNT
         7 000145   004662 450011 1                  STZ     FIT_BUF+2048,X1

      263     2798    5               DO I=0 TO MRRCNT-1;

   2798  7 000146   006763 450000 1                  STZ     I
         7 000147   000165 710000 7                  TRA     s:2804+3

      264     2799    6                  IF FIT_BUF.MRR.VSN(I)=VIDBUF.VSN THEN DO;

   2799  7 000150   006763 720000 1                  LXL0    I
         7 000151   004662 236010 1                  LDQ     FIT_BUF+2048,X0
         7 000152   006770 116000 1                  CMPQ    VIDBUF+2
         7 000153   000162 601000 7                  TNZ     s:2804

      265     2800    6                     FIT_BUF.MRR.VSN(I)=FIT_BUF.MRR.VSN(I+1);

   2800  7 000154   004663 235010 1                  LDA     FIT_BUF+2049,X0
         7 000155   004662 755010 1                  STA     FIT_BUF+2048,X0

      266     2801    6                     FIT_BUF.MRR.DVC(I)=FIT_BUF.MRR.DVC(I+1);

   2801  7 000156   002663 236010 1                  LDQ     FIT_BUF+1025,X0
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:47   
         7 000157   002662 756010 1                  STQ     FIT_BUF+1024,X0

      267     2802    6                     FIT_BUF.MRR.VSN(I+1)=VIDBUF.VSN;

   2802  7 000160   006770 235000 1                  LDA     VIDBUF+2
         7 000161   004663 755010 1                  STA     FIT_BUF+2049,X0

      268     2803    6                     END;

      269     2804    5                  END;

   2804  7 000162   006763 235000 1                  LDA     I
         7 000163   000001 035007                    ADLA    1,DL
         7 000164   006763 755000 1                  STA     I
         7 000165   006763 236000 1                  LDQ     I
         7 000166   000171 604000 7                  TMI     s:2805
         7 000167   006765 116000 1                  CMPQ    MRRCNT
         7 000170   000150 604000 7                  TMI     s:2799

      270     2805    5               IF FIT_BUF.MRR.VSN(MRRCNT)~=0 THEN DO;

   2805  7 000171   006765 720000 1                  LXL0    MRRCNT
         7 000172   004662 235010 1                  LDA     FIT_BUF+2048,X0
         7 000173   000177 600000 7                  TZE     s:2809

      271     2806    5                  MRRCNT=MRRCNT-1;

   2806  7 000174   000001 336007                    LCQ     1,DL
         7 000175   006765 056000 1                  ASQ     MRRCNT

      272     2807    5                  EXIT MRRCHK;

   2807  7 000176   000214 710000 7                  TRA     s:2814

      273     2808    5                  END;
      274     2809    4               IF VIDBUF.MIRROR.C~='MIRROR' OR VIDBUF.MIRROR.STATE(1)~=0 THEN EXIT;

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:48   
   2809  7 000177   040000 106400                    CMPC    fill='040'O
         7 000200   007030 000010 1                  ADSC9   VIDBUF+34                cn=0,n=8
         7 000201   001060 000006 2                  ADSC9   ALPH+14                  cn=0,n=6
         7 000202   000214 601000 7                  TNZ     s:2814
         7 000203   007033 236000 1                  LDQ     VIDBUF+37
         7 000204   007700 316003                    CANQ    4032,DU
         7 000205   000214 601000 7                  TNZ     s:2814

      275     2810    4               FIT_BUF.MRR.VSN(MRRCNT)=VIDBUF.VSN;

   2810  7 000206   006770 235000 1                  LDA     VIDBUF+2
         7 000207   004662 755010 1                  STA     FIT_BUF+2048,X0

      276     2811    4               FIT_BUF.MRR.DVC(MRRCNT)=JDCB$->F$DCB.PASS;

   2811  7 000210   000000 470400 xsym               LDP0    M$DP$
         7 000211   000022 236100                    LDQ     18,,PR0
         7 000212   002662 756010 1                  STQ     FIT_BUF+1024,X0

      277     2812    4               MRRCNT=MRRCNT+1;

   2812  7 000213   006765 054000 1                  AOS     MRRCNT

      278     2813    4               END;

      279     2814    3            END;

   2814  7 000214   000223 710000 7                  TRA     s:2818

      280     2815    3         WHENALTRETURN DO;

      281     2816    3            IF ENTADDR(FXD$PMME)~=ENTADDR(NIL) THEN CALL FXD$PMME;

   2816  7 000215   000000 636000 xent               EAQ     FXD$PMME
         7 000216   000002 116000 xsym               CMPQ    B_VECTNIL+2
         7 000217   000223 600000 7                  TZE     s:2818

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:49   
   2816  7 000220   000002 631400 xsym               EPPR1   B_VECTNIL+2
         7 000221   000000 701000 xent               TSX1    FXD$PMME
         7 000222   000000 011000                    NOP     0

      282     2817    3            END;

      283     2818    2         CALL M$CLOSE(CLSDP)ALTRET(DPERR);

   2818  7 000223   000422 630400 1                  EPPR0   CLSDP
         7 000224   450001 713400                    CLIMB   alt,close
         7 000225   406000 401760                    pmme    nvectors=13
         7 000226   002120 702000 7                  TSX2    DPERR

      284     2819    2         END;

   2819  7 000227   000055 710000 7                  TRA     s:2783

      285     2820        /**/
      286     2821    1   DPDONE: IF ENTADDR(FXD$PMME)~=ENTADDR(NIL) THEN CALL FXD$PMME(ERR);

   2821  7 000230   000000 636000 xent  DPDONE       EAQ     FXD$PMME
         7 000231   000002 116000 xsym               CMPQ    B_VECTNIL+2
         7 000232   000240 600000 7                  TZE     s:2822

   2821  7 000233   000004 630400 8                  EPPR0   4
         7 000234   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 000235   000000 701000 xent               TSX1    FXD$PMME
         7 000236   000000 011000                    NOP     0
         7 000237   000244 710000 7                  TRA     s:2823

      287     2822    1      ELSE ERR=B$ALT.ERR;

   2822  7 000240   000000 470400 xsym               LDP0    B$TCB$
         7 000241   000000 471500                    LDP1    0,,PR0
         7 000242   100102 236100                    LDQ     66,,PR1
         7 000243   000622 756000 1                  STQ     ERR

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:50   
      288     2823    1      IF ERR.CODE~=%E$SETDOWN THEN GOTO DPERR1;

   2823  7 000244   000622 236000 1                  LDQ     ERR
         7 000245   377770 376007                    ANQ     131064,DL
         7 000246   002200 116007                    CMPQ    1152,DL
         7 000247   002134 601000 7                  TNZ     DPERR1

      289     2824    1      OPNDP.SN_=VECTOR(VSNSN);

   2824  7 000250   000006 237000 8                  LDAQ    6
         7 000251   000166 757000 1                  STAQ    OPNDP+2

      290     2825    1      IF MRRCNT>0 THEN CALL WROC(11) ALTRET(SETNEXT);

   2825  7 000252   006765 235000 1                  LDA     MRRCNT
         7 000253   000262 604400 7                  TMOZ    s:2826

   2825  7 000254   000001 236000 xsym               LDQ     B_VECTNIL+1
         7 000255   200042 756100                    STQ     @PMME+1,,AUTO
         7 000256   000010 236000 8                  LDQ     8
         7 000257   200041 756100                    STQ     SECTS+28,,AUTO
         7 000260   002302 701000 7                  TSX1    WROC
         7 000261   000061 702000 7                  TSX2    SETNEXT

      291     2826    1      VSNSN.VSN=CP6VSN;

   2826  7 000262   000614 235000 1                  LDA     CP6VSN
         7 000263   000617 755000 1                  STA     VSNSN+1

      292     2827    1      CALL M$OPEN(OPNDP) ALTRET(DPERR);

   2827  7 000264   000164 630400 1                  EPPR0   OPNDP
         7 000265   450000 713400                    CLIMB   alt,open
         7 000266   410400 401760                    pmme    nvectors=18
         7 000267   002120 702000 7                  TSX2    DPERR

      293     2828    1      CALL M$READ(RDDP) ALTRET(DPERR);
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:51   

   2828  7 000270   000554 630400 1                  EPPR0   RDDP
         7 000271   440000 713400                    CLIMB   alt,read
         7 000272   401400 401760                    pmme    nvectors=4
         7 000273   002120 702000 7                  TSX2    DPERR

      294     2829    1      VIDBUF.VOLCNT=1;

   2829  7 000274   000001 220003                    LDX0    1,DU
         7 000275   006772 440000 1                  SXL0    VIDBUF+4

      295     2830    1      VIDBUF.SNLIST.VSN.N(0)=CP6VSN;

   2830  7 000276   000614 236000 1                  LDQ     CP6VSN
         7 000277   007466 552034 1                  STBQ    VIDBUF+320,'34'O

      296     2831    1      VIDBUF.SNLIST.VSN.S(0)=1;

   2831  7 000300   001000 236003                    LDQ     512,DU
         7 000301   007466 552040 1                  STBQ    VIDBUF+320,'40'O

      297     2832    1      VIDBUF.SNLIST.TYPE(0)=JDCB$->F$DCB.ACCT;

   2832  7 000302   000000 470400 xsym               LDP0    M$DP$
         7 000303   000020 237100                    LDAQ    16,,PR0
         7 000304   007470 757000 1                  STAQ    VIDBUF+322

      298     2833    1      IF ADJSYSOK>0 THEN VIDBUF.SYSSIZE=VIDBUF.SECTSTRT(1);

   2833  7 000305   000615 235000 1                  LDA     ADJSYSOK
         7 000306   000311 604400 7                  TMOZ    s:2834

   2833  7 000307   006777 235000 1                  LDA     VIDBUF+9
         7 000310   006773 755000 1                  STA     VIDBUF+5

      299     2834    1      VIDBUF.SNLIST.SIZE(0)=VIDBUF.SYSSIZE;

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:52   
   2834  7 000311   006773 235000 1                  LDA     VIDBUF+5
         7 000312   007467 755000 1                  STA     VIDBUF+321

      300     2835    1      CALL M$WRITE(RDDP) ALTRET(DPERR);

   2835  7 000313   000554 630400 1                  EPPR0   RDDP
         7 000314   440001 713400                    CLIMB   alt,write
         7 000315   401400 401760                    pmme    nvectors=4
         7 000316   002120 702000 7                  TSX2    DPERR

      301     2836    2      IF NEWFILES THEN DO;

   2836  7 000317   000623 234000 1                  SZN     NEWFILES
         7 000320   000750 605000 7                  TPL     s:2923

      302     2837    2         IF VIDBUF.SECTSTRT(1)>=JDCB$->F$DCB.IXTNSIZE

   2837  7 000321   000000 470400 xsym               LDP0    M$DP$
         7 000322   006777 236000 1                  LDQ     VIDBUF+9
         7 000323   000326 604000 7                  TMI     s:2838
         7 000324   000041 116100                    CMPQ    33,,PR0
         7 000325   000327 604000 7                  TMI     s:2839

      303     2838    2         THEN VIDBUF.SECTSTRT(1)=0;

   2838  7 000326   006777 450000 1                  STZ     VIDBUF+9

      304     2839    2         IF VIDBUF.SECTSTRT(2)<VIDBUF.SYSSIZE

   2839  7 000327   007000 236000 1                  LDQ     VIDBUF+10
         7 000330   006773 116000 1                  CMPQ    VIDBUF+5
         7 000331   000336 602000 7                  TNC     s:2841
         7 000332   000000 116003                    CMPQ    0,DU
         7 000333   000336 604000 7                  TMI     s:2841
         7 000334   000041 116100                    CMPQ    33,,PR0
         7 000335   000344 604400 7                  TMOZ    s:2842

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:53   
      305     2840    2           OR VIDBUF.SECTSTRT(2)>JDCB$->F$DCB.IXTNSIZE
      306     2841    2         THEN VIDBUF.SECTSTRT(2)=MINIMUM (JDCB$->F$DCB.IXTNSIZE,262144);

   2841  7 000336   000001 236003                    LDQ     1,DU
         7 000337   000342 604000 7                  TMI     s:2841+4
         7 000340   000041 116100                    CMPQ    33,,PR0
         7 000341   000343 604400 7                  TMOZ    s:2841+5
         7 000342   000041 236100                    LDQ     33,,PR0
         7 000343   007000 756000 1                  STQ     VIDBUF+10

      307     2842    2         SECTS=VIDBUF.SECTSTRT;

   2842  7 000344   000100 100400                    MLR     fill='000'O
         7 000345   006776 000150 1                  ADSC9   VIDBUF+8                 cn=0,n=104
         7 000346   200005 000150                    ADSC9   SECTS,,AUTO              cn=0,n=104

      308     2843    3         IF VIDBUF.SYSSIZE~=VIDBUF.SECTSTRT(1) OR SETX=0 AND ADJSYSOK<=0 THEN DO;

   2843  7 000347   006773 236000 1                  LDQ     VIDBUF+5
         7 000350   006777 116000 1                  CMPQ    VIDBUF+9
         7 000351   000356 601000 7                  TNZ     s:2844
         7 000352   006764 235000 1                  LDA     SETX
         7 000353   000576 601000 7                  TNZ     s:2893
         7 000354   000615 235000 1                  LDA     ADJSYSOK
         7 000355   000576 605400 7                  TPNZ    s:2893

      309     2844    4            DO I=0 TO 62;

   2844  7 000356   006763 450000 1                  STZ     I

      310     2845    4               IF VIDBUF.SYSSIZE+3>=VIDBUF.DGT.FGRAN(I)

   2845  7 000357   006763 720000 1                  LXL0    I
         7 000360   007266 236010 1                  LDQ     VIDBUF+192,X0
         7 000361   000022 772000                    QRL     18
         7 000362   200046 756100                    STQ     I+1,,AUTO
         7 000363   006773 236000 1                  LDQ     VIDBUF+5
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:54   
         7 000364   000003 036007                    ADLQ    3,DL
         7 000365   200046 116100                    CMPQ    I+1,,AUTO
         7 000366   000400 602000 7                  TNC     s:2849
         7 000367   007266 236010 1                  LDQ     VIDBUF+192,X0
         7 000370   777777 376007                    ANQ     -1,DL
         7 000371   006773 116000 1                  CMPQ    VIDBUF+5
         7 000372   000400 602000 7                  TNC     s:2849
         7 000373   007366 221010 1                  LDX1    VIDBUF+256,X0
         7 000374   777777 101003                    CMPX1   -1,DU
         7 000375   000400 600000 7                  TZE     s:2849

      311     2846    4                 AND VIDBUF.SYSSIZE<=VIDBUF.DGT.LGRAN(I)
      312     2847    4                 AND VIDBUF.DTT(I)~=262143
      313     2848    4               THEN VIDBUF.SYSSIZE=VIDBUF.DGT.LGRAN(I)+1;

   2848  7 000376   000001 036007                    ADLQ    1,DL
         7 000377   006773 756000 1                  STQ     VIDBUF+5

      314     2849    4               END;

   2849  7 000400   006763 235000 1                  LDA     I
         7 000401   000001 035007                    ADLA    1,DL
         7 000402   006763 755000 1                  STA     I
         7 000403   000077 115007                    CMPA    63,DL
         7 000404   000357 602000 7                  TNC     s:2845

      315     2850    3            VIDBUF.SECTSTRT(1)=VIDBUF.SYSSIZE;

   2850  7 000405   006773 236000 1                  LDQ     VIDBUF+5
         7 000406   006777 756000 1                  STQ     VIDBUF+9

      316     2851    3            VIDBUF.SNLIST.SIZE(0)=VIDBUF.SYSSIZE;

   2851  7 000407   007467 756000 1                  STQ     VIDBUF+321

      317     2852    3            CALL M$WRITE(RDDP) ALTRET(DPERR);

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:55   
   2852  7 000410   000554 630400 1                  EPPR0   RDDP
         7 000411   440001 713400                    CLIMB   alt,write
         7 000412   401400 401760                    pmme    nvectors=4
         7 000413   002120 702000 7                  TSX2    DPERR

      318     2853    3            FIT_BUF.GRAN=VIDBUF;

   2853  7 000414   010000 220003                    LDX0    4096,DU
         7 000415   000040 100440                    MLR     fill='000'O
         7 000416   006766 000010 1                  ADSC9   VIDBUF                   cn=0,n=*X0
         7 000417   000662 000010 1                  ADSC9   FIT_BUF                  cn=0,n=*X0

      319     2854    3            GRANULE=SECTS(1);

   2854  7 000420   200006 235100                    LDA     SECTS+1,,AUTO
         7 000421   006762 755000 1                  STA     GRANULE

      320     2855    3            SECTS(1)=VIDBUF.SECTSTRT(1);

   2855  7 000422   006777 236000 1                  LDQ     VIDBUF+9
         7 000423   200006 756100                    STQ     SECTS+1,,AUTO

      321     2856    3            CALL M$READ(RDDP) ALTRET(DPERR);

   2856  7 000424   000554 630400 1                  EPPR0   RDDP
         7 000425   440000 713400                    CLIMB   alt,read
         7 000426   401400 401760                    pmme    nvectors=4
         7 000427   002120 702000 7                  TSX2    DPERR

      322     2857    3            IF GRANULE=0 THEN VIDBUF.VOLCNT=0; /* Make a scratch if not #SYS     */

   2857  7 000430   006762 235000 1                  LDA     GRANULE
         7 000431   000434 601000 7                  TNZ     s:2858

   2857  7 000432   000000 220003                    LDX0    0,DU
         7 000433   006772 440000 1                  SXL0    VIDBUF+4

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:56   
      323     2858    3            IF SETX=0 AND (GRANULE=0 OR VIDBUF.ID~='CP6'

   2858  7 000434   006764 236000 1                  LDQ     SETX
         7 000435   000476 601000 7                  TNZ     s:2871
         7 000436   000000 115003                    CMPA    0,DU
         7 000437   000446 600000 7                  TZE     s:2860
         7 000440   040000 106400                    CMPC    fill='040'O
         7 000441   006766 000004 1                  ADSC9   VIDBUF                   cn=0,n=4
         7 000442   001054 000003 2                  ADSC9   ALPH+10                  cn=0,n=3
         7 000443   000446 601000 7                  TNZ     s:2860
         7 000444   006772 720000 1                  LXL0    VIDBUF+4
         7 000445   000476 601000 7                  TNZ     s:2871

      324     2859    4              OR VIDBUF.VOLCNT=0) THEN DO;

      325     2860    4               VIDBUF=FIT_BUF.GRAN;

   2860  7 000446   010000 220003                    LDX0    4096,DU
         7 000447   000040 100440                    MLR     fill='000'O
         7 000450   000662 000010 1                  ADSC9   FIT_BUF                  cn=0,n=*X0
         7 000451   006766 000010 1                  ADSC9   VIDBUF                   cn=0,n=*X0

      326     2861    4               VIDBUF.PSN='SYS';

   2861  7 000452   040000 100400                    MLR     fill='040'O
         7 000453   001057 000003 2                  ADSC9   ALPH+13                  cn=0,n=3
         7 000454   006771 000006 1                  ADSC9   VIDBUF+3                 cn=0,n=6

      327     2862    4               VIDBUF.VOLCNT=1;

   2862  7 000455   000001 221003                    LDX1    1,DU
         7 000456   006772 441000 1                  SXL1    VIDBUF+4

      328     2863    4               VIDBUF.SYSSIZE=0;

   2863  7 000457   006773 450000 1                  STZ     VIDBUF+5

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:57   
      329     2864    4               VIDBUF.SYSDIRDA=0;

   2864  7 000460   006774 450000 1                  STZ     VIDBUF+6

      330     2865    4               VIDBUF.SNLIST.VSN.N(0)=VIDBUF.VSN;

   2865  7 000461   006770 236000 1                  LDQ     VIDBUF+2
         7 000462   007466 552034 1                  STBQ    VIDBUF+320,'34'O

      331     2866    4               VIDBUF.SNLIST.VSN.S(0)=2;

   2866  7 000463   002000 236003                    LDQ     1024,DU
         7 000464   007466 552040 1                  STBQ    VIDBUF+320,'40'O

      332     2867    4               VIDBUF.SNLIST.SIZE(0)=SECTS(2)-SECTS(1);

   2867  7 000465   200007 236100                    LDQ     SECTS+2,,AUTO
         7 000466   200006 136100                    SBLQ    SECTS+1,,AUTO
         7 000467   007467 756000 1                  STQ     VIDBUF+321

      333     2868    4               VIDBUF.SNLIST.TYPE(0)=JDCB$->F$DCB.ACCT;

   2868  7 000470   000000 470400 xsym               LDP0    M$DP$
         7 000471   000020 237100                    LDAQ    16,,PR0
         7 000472   007470 757000 1                  STAQ    VIDBUF+322

      334     2869    4               SETX=BITBIN(VIDBUF.SNLIST.VSN(0));

   2869  7 000473   007466 235000 1                  LDA     VIDBUF+320
         7 000474   006764 755000 1                  STA     SETX

      335     2870    4               END;

   2870  7 000475   000501 710000 7                  TRA     s:2872

      336     2871    3            ELSE VIDBUF.SECTSTRT=SECTS;

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:58   
   2871  7 000476   000000 100500                    MLR     fill='000'O
         7 000477   200005 000150                    ADSC9   SECTS,,AUTO              cn=0,n=104
         7 000500   006776 000150 1                  ADSC9   VIDBUF+8                 cn=0,n=104

      337     2872    3            GRANULE=SECTS(1);

   2872  7 000501   200006 235100                    LDA     SECTS+1,,AUTO
         7 000502   006762 755000 1                  STA     GRANULE

      338     2873    4            IF VIDBUF.ID~='CP6' THEN DO;

   2873  7 000503   040000 106400                    CMPC    fill='040'O
         7 000504   006766 000004 1                  ADSC9   VIDBUF                   cn=0,n=4
         7 000505   001054 000003 2                  ADSC9   ALPH+10                  cn=0,n=3
         7 000506   000515 600000 7                  TZE     s:2877

      339     2874    4               VIDBUF=FIT_BUF.GRAN;

   2874  7 000507   010000 220003                    LDX0    4096,DU
         7 000510   000040 100440                    MLR     fill='000'O
         7 000511   000662 000010 1                  ADSC9   FIT_BUF                  cn=0,n=*X0
         7 000512   006766 000010 1                  ADSC9   VIDBUF                   cn=0,n=*X0

      340     2875    4               VIDBUF.VOLCNT=0;

   2875  7 000513   000000 221003                    LDX1    0,DU
         7 000514   006772 441000 1                  SXL1    VIDBUF+4

      341     2876    4               END;

      342     2877    3            CALL M$WRITE(RDDP) ALTRET(DPERR);

   2877  7 000515   000554 630400 1                  EPPR0   RDDP
         7 000516   440001 713400                    CLIMB   alt,write
         7 000517   401400 401760                    pmme    nvectors=4
         7 000520   002120 702000 7                  TSX2    DPERR

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:59   
      343     2878    3            I=2;

   2878  7 000521   000002 235007                    LDA     2,DL
         7 000522   006763 755000 1                  STA     I

      344     2879    4            DO WHILE(I<26 AND GRANULE<SECTS(I)

   2879  7 000523   000563 710000 7                  TRA     s:2890

      345     2880    4              AND SECTS(I)<JDCB$->F$DCB.IXTNSIZE);
      346     2881    4               GRANULE=SECTS(I);

   2881  7 000524   006763 720000 1                  LXL0    I
         7 000525   200005 235110                    LDA     SECTS,X0,AUTO
         7 000526   006762 755000 1                  STA     GRANULE

      347     2882    4               CALL M$READ(RDDP) ALTRET(DPERR);

   2882  7 000527   000554 630400 1                  EPPR0   RDDP
         7 000530   440000 713400                    CLIMB   alt,read
         7 000531   401400 401760                    pmme    nvectors=4
         7 000532   002120 702000 7                  TSX2    DPERR

      348     2883    5               IF VIDBUF.ID~='CP6' THEN DO;

   2883  7 000533   040000 106400                    CMPC    fill='040'O
         7 000534   006766 000004 1                  ADSC9   VIDBUF                   cn=0,n=4
         7 000535   001054 000003 2                  ADSC9   ALPH+10                  cn=0,n=3
         7 000536   000545 600000 7                  TZE     s:2887

      349     2884    5                  VIDBUF=FIT_BUF.GRAN;

   2884  7 000537   010000 220003                    LDX0    4096,DU
         7 000540   000040 100440                    MLR     fill='000'O
         7 000541   000662 000010 1                  ADSC9   FIT_BUF                  cn=0,n=*X0
         7 000542   006766 000010 1                  ADSC9   VIDBUF                   cn=0,n=*X0

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:60   
      350     2885    5                  VIDBUF.VOLCNT=0;

   2885  7 000543   000000 221003                    LDX1    0,DU
         7 000544   006772 441000 1                  SXL1    VIDBUF+4

      351     2886    5                  END;

      352     2887    4               VIDBUF.SECTSTRT=SECTS;

   2887  7 000545   000000 100500                    MLR     fill='000'O
         7 000546   200005 000150                    ADSC9   SECTS,,AUTO              cn=0,n=104
         7 000547   006776 000150 1                  ADSC9   VIDBUF+8                 cn=0,n=104

      353     2888    4               IF VIDBUF.ID='CP6' THEN CALL M$WRITE(RDDP) ALTRET(DPERR);

   2888  7 000550   040000 106400                    CMPC    fill='040'O
         7 000551   006766 000004 1                  ADSC9   VIDBUF                   cn=0,n=4
         7 000552   001054 000003 2                  ADSC9   ALPH+10                  cn=0,n=3
         7 000553   000560 601000 7                  TNZ     s:2889

   2888  7 000554   000554 630400 1                  EPPR0   RDDP
         7 000555   440001 713400                    CLIMB   alt,write
         7 000556   401400 401760                    pmme    nvectors=4
         7 000557   002120 702000 7                  TSX2    DPERR

      354     2889    4               I=I+1;

   2889  7 000560   006763 235000 1                  LDA     I
         7 000561   000001 035007                    ADLA    1,DL
         7 000562   006763 755000 1                  STA     I

      355     2890    4               END;

   2890  7 000563   000032 115007                    CMPA    26,DL
         7 000564   000576 603000 7                  TRC     s:2893
         7 000565   006762 236000 1                  LDQ     GRANULE
         7 000566   200005 116105                    CMPQ    SECTS,AL,AUTO
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:61   
         7 000567   000576 603000 7                  TRC     s:2893
         7 000570   000000 470400 xsym               LDP0    M$DP$
         7 000571   006763 720000 1                  LXL0    I
         7 000572   200005 236110                    LDQ     SECTS,X0,AUTO
         7 000573   000576 604000 7                  TMI     s:2893
         7 000574   000041 116100                    CMPQ    33,,PR0
         7 000575   000524 604000 7                  TMI     s:2881

      356     2891    3            END;

      357     2892              /* NOW FIX THE #SYS VIDS IF IT'S SECTION 2                              */
      358     2893    2         GRANULE=0;

   2893  7 000576   006762 450000 1                  STZ     GRANULE

      359     2894    2         CALL M$CLOSE(CLSDP) ALTRET(DPERR);

   2894  7 000577   000422 630400 1                  EPPR0   CLSDP
         7 000600   450001 713400                    CLIMB   alt,close
         7 000601   406000 401760                    pmme    nvectors=13
         7 000602   002120 702000 7                  TSX2    DPERR

      360     2895    2         IF SETX=0 THEN GOTO SETERR;

   2895  7 000603   006764 235000 1                  LDA     SETX
         7 000604   002145 600000 7                  TZE     SETERR

      361     2896    2         VSNSN.VSN=SETX;

   2896  7 000605   000617 755000 1                  STA     VSNSN+1

      362     2897    2         CALL M$OPEN(OPNDP) ALTRET(DPERR);

   2897  7 000606   000164 630400 1                  EPPR0   OPNDP
         7 000607   450000 713400                    CLIMB   alt,open
         7 000610   410400 401760                    pmme    nvectors=18
         7 000611   002120 702000 7                  TSX2    DPERR
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:62   

      363     2898    2         CALL M$READ(RDDP)ALTRET(DPERR);

   2898  7 000612   000554 630400 1                  EPPR0   RDDP
         7 000613   440000 713400                    CLIMB   alt,read
         7 000614   401400 401760                    pmme    nvectors=4
         7 000615   002120 702000 7                  TSX2    DPERR

      364     2899    2         I=0;

   2899  7 000616   006763 450000 1                  STZ     I

      365     2900    3         DO WHILE(I<VIDBUF.VOLCNT /* WHAT VOLUME IS IT?                          */

   2900  7 000617   000623 710000 7                  TRA     s:2904

      366     2901    3           AND (VIDBUF.SNLIST.VSN.N(I)~=CP6VSN
      367     2902    3           OR VIDBUF.SNLIST.VSN.S(I)~=2));
      368     2903    3            I=I+1;

   2903  7 000620   006763 235000 1                  LDA     I
         7 000621   000001 035007                    ADLA    1,DL
         7 000622   006763 755000 1                  STA     I

      369     2904    3            END;

   2904  7 000623   006772 236000 1                  LDQ     VIDBUF+4
         7 000624   777777 376007                    ANQ     -1,DL
         7 000625   006763 116000 1                  CMPQ    I
         7 000626   000642 602000 7                  TNC     s:2905
         7 000627   000642 600000 7                  TZE     s:2905
         7 000630   006763 235000 1                  LDA     I
         7 000631   000002 735000                    ALS     2
         7 000632   007466 236005 1                  LDQ     VIDBUF+320,AL
         7 000633   000032 376000 xsym               ANQ     B_VECTNIL+26
         7 000634   000614 116000 1                  CMPQ    CP6VSN
         7 000635   000620 601000 7                  TNZ     s:2903
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:63   
         7 000636   007466 236005 1                  LDQ     VIDBUF+320,AL
         7 000637   777000 376003                    ANQ     -512,DU
         7 000640   002000 116003                    CMPQ    1024,DU
         7 000641   000620 601000 7                  TNZ     s:2903

      370     2905    2         IF I<VIDBUF.VOLCNT AND NEWFILES

   2905  7 000642   006772 236000 1                  LDQ     VIDBUF+4
         7 000643   777777 376007                    ANQ     -1,DL
         7 000644   006763 116000 1                  CMPQ    I
         7 000645   000750 602000 7                  TNC     s:2923
         7 000646   000750 600000 7                  TZE     s:2923
         7 000647   000623 234000 1                  SZN     NEWFILES
         7 000650   000750 605000 7                  TPL     s:2923
         7 000651   200007 236100                    LDQ     SECTS+2,,AUTO
         7 000652   200006 136100                    SBLQ    SECTS+1,,AUTO
         7 000653   006763 235000 1                  LDA     I
         7 000654   000002 735000                    ALS     2
         7 000655   000000 116003                    CMPQ    0,DU
         7 000656   000661 604000 7                  TMI     s:2907
         7 000657   007467 116005 1                  CMPQ    VIDBUF+321,AL
         7 000660   000750 600000 7                  TZE     s:2923

      371     2906    3           AND SECTS(2)-SECTS(1)~=VIDBUF.SNLIST.SIZE(I) THEN DO;

      372     2907    3            SECTS(0)=I;

   2907  7 000661   006763 236000 1                  LDQ     I
         7 000662   200005 756100                    STQ     SECTS,,AUTO

      373     2908    4            DO I=0 TO VIDBUF.VOLCNT-1;

   2908  7 000663   006763 450000 1                  STZ     I
         7 000664   000743 710000 7                  TRA     s:2920+3

      374     2909    4               CALL M$CLOSE(CLSDP) ALTRET(DPERR);

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:64   
   2909  7 000665   000422 630400 1                  EPPR0   CLSDP
         7 000666   450001 713400                    CLIMB   alt,close
         7 000667   406000 401760                    pmme    nvectors=13
         7 000670   002120 702000 7                  TSX2    DPERR

      375     2910    4               VSNSN.VSN=BITBIN(VIDBUF.SNLIST.VSN(I));

   2910  7 000671   006763 235000 1                  LDA     I
         7 000672   000002 735000                    ALS     2
         7 000673   007466 235005 1                  LDA     VIDBUF+320,AL
         7 000674   000617 755000 1                  STA     VSNSN+1

      376     2911    4               CALL M$OPEN(OPNDP) ALTRET(DPERR);

   2911  7 000675   000164 630400 1                  EPPR0   OPNDP
         7 000676   450000 713400                    CLIMB   alt,open
         7 000677   410400 401760                    pmme    nvectors=18
         7 000700   002120 702000 7                  TSX2    DPERR

      377     2912    4               CALL M$READ(RDDP) ALTRET(DPERR);

   2912  7 000701   000554 630400 1                  EPPR0   RDDP
         7 000702   440000 713400                    CLIMB   alt,read
         7 000703   401400 401760                    pmme    nvectors=4
         7 000704   002120 702000 7                  TSX2    DPERR

      378     2913    4               VIDBUF.SNLIST.SIZE(SECTS(0))=SECTS(2)-SECTS(1);

   2913  7 000705   200005 235100                    LDA     SECTS,,AUTO
         7 000706   000002 735000                    ALS     2
         7 000707   200007 236100                    LDQ     SECTS+2,,AUTO
         7 000710   200006 136100                    SBLQ    SECTS+1,,AUTO
         7 000711   007467 756005 1                  STQ     VIDBUF+321,AL

      379     2914    4               VIDBUF.PSN=' SYS'; /* TRASH IT SO IT CAN REJOIN ITS BUDDIES       */

   2914  7 000712   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:65   
         7 000713   001062 000004 2                  ADSC9   ALPH+16                  cn=0,n=4
         7 000714   006771 000006 1                  ADSC9   VIDBUF+3                 cn=0,n=6

      380     2915    4               CALL M$WRITE(RDDP) ALTRET(DPERR);

   2915  7 000715   000554 630400 1                  EPPR0   RDDP
         7 000716   440001 713400                    CLIMB   alt,write
         7 000717   401400 401760                    pmme    nvectors=4
         7 000720   002120 702000 7                  TSX2    DPERR

      381     2916    4               CALL M$CLOSE(CLSDP) ALTRET(DPERR);

   2916  7 000721   000422 630400 1                  EPPR0   CLSDP
         7 000722   450001 713400                    CLIMB   alt,close
         7 000723   406000 401760                    pmme    nvectors=13
         7 000724   002120 702000 7                  TSX2    DPERR

      382     2917    4               CALL M$OPEN(OPNDP) ALTRET(DPERR);

   2917  7 000725   000164 630400 1                  EPPR0   OPNDP
         7 000726   450000 713400                    CLIMB   alt,open
         7 000727   410400 401760                    pmme    nvectors=18
         7 000730   002120 702000 7                  TSX2    DPERR

      383     2918    4               VIDBUF.PSN='SYS';

   2918  7 000731   040000 100400                    MLR     fill='040'O
         7 000732   001057 000003 2                  ADSC9   ALPH+13                  cn=0,n=3
         7 000733   006771 000006 1                  ADSC9   VIDBUF+3                 cn=0,n=6

      384     2919    4               CALL M$WRITE(RDDP) ALTRET(DPERR);

   2919  7 000734   000554 630400 1                  EPPR0   RDDP
         7 000735   440001 713400                    CLIMB   alt,write
         7 000736   401400 401760                    pmme    nvectors=4
         7 000737   002120 702000 7                  TSX2    DPERR

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:66   
      385     2920    4               END;

   2920  7 000740   006763 235000 1                  LDA     I
         7 000741   000001 035007                    ADLA    1,DL
         7 000742   006763 755000 1                  STA     I
         7 000743   006772 236000 1                  LDQ     VIDBUF+4
         7 000744   777777 376007                    ANQ     -1,DL
         7 000745   006763 116000 1                  CMPQ    I
         7 000746   000750 600000 7                  TZE     s:2923
         7 000747   000665 603000 7                  TRC     s:2909

      386     2921    3            END;

      387     2922    2         END; /* OF DO NEWFILES                                                  */

      388     2923    1      CALL M$CLOSE(CLSDP) ALTRET(DPERR);

   2923  7 000750   000422 630400 1                  EPPR0   CLSDP
         7 000751   450001 713400                    CLIMB   alt,close
         7 000752   406000 401760                    pmme    nvectors=13
         7 000753   002120 702000 7                  TSX2    DPERR

      389     2924    1      OPNDP.SN_=VECTOR(OPNSN);

   2924  7 000754   000012 237000 8                  LDAQ    10
         7 000755   000166 757000 1                  STAQ    OPNDP+2

      390     2925    2      CALL M$OPEN(OPNDP) WHENALTRETURN DO;

   2925  7 000756   000164 630400 1                  EPPR0   OPNDP
         7 000757   450000 713400                    CLIMB   alt,open
         7 000760   410400 401760                    pmme    nvectors=18
         7 000761   000763 702000 7                  TSX2    s:2926
         7 000762   001000 710000 7                  TRA     s:2930

      391     2926    2         IF ENTADDR(FXD$PMME)~=ENTADDR(NIL) THEN CALL FXD$PMME(ERR);

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:67   
   2926  7 000763   000000 636000 xent               EAQ     FXD$PMME
         7 000764   000002 116000 xsym               CMPQ    B_VECTNIL+2
         7 000765   000773 600000 7                  TZE     s:2927

   2926  7 000766   000004 630400 8                  EPPR0   4
         7 000767   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 000770   000000 701000 xent               TSX1    FXD$PMME
         7 000771   000000 011000                    NOP     0
         7 000772   000777 710000 7                  TRA     s:2928

      392     2927    2         ELSE ERR=B$ALT.ERR;

   2927  7 000773   000000 470400 xsym               LDP0    B$TCB$
         7 000774   000000 471500                    LDP1    0,,PR0
         7 000775   100102 236100                    LDQ     66,,PR1
         7 000776   000622 756000 1                  STQ     ERR

      393     2928    2         GOTO SETERR;

   2928  7 000777   002145 710000 7                  TRA     SETERR

      394     2929    2         END;
      395     2930    1      CALL M$READ(RDDP) ALTRET(DPERR);

   2930  7 001000   000554 630400 1                  EPPR0   RDDP
         7 001001   440000 713400                    CLIMB   alt,read
         7 001002   401400 401760                    pmme    nvectors=4
         7 001003   002120 702000 7                  TSX2    DPERR

      396     2931    1      SETX=0;

   2931  7 001004   006764 450000 1                  STZ     SETX

      397     2932    2      DO I=0 TO VIDBUF.VOLCNT-1;

   2932  7 001005   006763 450000 1                  STZ     I
         7 001006   001115 710000 7                  TRA     s:2948+3
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:68   

      398     2933    2         CALL BINCHAR(PSMSG.TSN,VIDBUF.SNLIST.VSN.N(I));

   2933  7 001007   006763 235000 1                  LDA     I
         7 001010   000002 735000                    ALS     2
         7 001011   007466 236005 1                  LDQ     VIDBUF+320,AL
         7 001012   000032 376000 xsym               ANQ     B_VECTNIL+26
         7 001013   000000 235003                    LDA     0,DU
         7 001014   200046 757100                    STAQ    I+1,,AUTO
         7 001015   000000 301500                    BTD
         7 001016   200046 000010                    NDSC9   I+1,,AUTO                cn=0,s=lsgnf,sf=0,n=8
         7 001017   011011 030012 1                  NDSC9   PSMSG+19                 cn=0,s=nosgn,sf=0,n=10

      399     2934    2         CALL EDITSTR(PSMSG.TSN,0,9,'111'O,PSMSG.TSN);

   2934  7 001020   000000 020400                    MVE
         7 001021   011011 000012 1                  ADSC9   PSMSG+19                 cn=0,n=10
         7 001022   000014 000001 8                  ADSC9   12                       cn=0,n=1
         7 001023   011011 000011 1                  ADSC9   PSMSG+19                 cn=0,n=9

      400     2935    2         CALL INDEX1R(SETX,' ',PSMSG.TSN);

   2935  7 001024   000000 125400                    SCMR    mask='000'O
         7 001025   011011 000012 1                  ADSC9   PSMSG+19                 cn=0,n=10
         7 001026   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         7 001027   006764 000000 1                  ARG     SETX
         7 001030   001033 606400 7                  TTN     s:2936
         7 001031   000011 236007                    LDQ     9,DL
         7 001032   006764 156000 1                  SSQ     SETX

      401     2936    2         PSMSG.TSN=SUBSTR(PSMSG.TSN,SETX+1);

   2936  7 001033   006764 720000 1                  LXL0    SETX
         7 001034   777766 620010                    EAX0    -10,X0
         7 001035   777777 660003                    ERX0    -1,DU
         7 001036   006764 236000 1                  LDQ     SETX
         7 001037   040000 100446                    MLR     fill='040'O
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:69   
         7 001040   011011 200010 1                  ADSC9   PSMSG+19,Q               cn=1,n=*X0
         7 001041   011011 000012 1                  ADSC9   PSMSG+19                 cn=0,n=10

      402     2937    3         IF I~=0 THEN DO;

   2937  7 001042   006763 235000 1                  LDA     I
         7 001043   001061 600000 7                  TZE     s:2942

      403     2938    3            CALL INDEX(SETX,'  ',PSMSG.SNS);

   2938  7 001044   000000 120400                    SCD
         7 001045   010774 400062 1                  ADSC9   PSMSG+6                  cn=2,n=50
         7 001046   001063 000002 2                  ADSC9   ALPH+17                  cn=0,n=2
         7 001047   006764 000000 1                  ARG     SETX
         7 001050   001052 607000 7                  TTF     s:2939
         7 001051   006764 054000 1                  AOS     SETX

      404     2939    3            CALL INSERT(PSMSG.SNS,SETX,2,', ');

   2939  7 001052   006764 236000 1                  LDQ     SETX
         7 001053   040006 100400                    MLR     fill='040'O
         7 001054   001064 000002 2                  ADSC9   ALPH+18                  cn=0,n=2
         7 001055   010774 400002 1                  ADSC9   PSMSG+6,Q                cn=2,n=2

      405     2940    3            SETX=SETX+2;

   2940  7 001056   000002 036007                    ADLQ    2,DL
         7 001057   006764 756000 1                  STQ     SETX

      406     2941    3            END;

   2941  7 001060   001062 710000 7                  TRA     s:2943

      407     2942    2         ELSE SETX=0;

   2942  7 001061   006764 450000 1                  STZ     SETX

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:70   
      408     2943    2         CALL INSERT(PSMSG.SNS,SETX,12,PSMSG.TSN);

   2943  7 001062   006764 236000 1                  LDQ     SETX
         7 001063   040006 100400                    MLR     fill='040'O
         7 001064   011011 000012 1                  ADSC9   PSMSG+19                 cn=0,n=10
         7 001065   010774 400014 1                  ADSC9   PSMSG+6,Q                cn=2,n=12

      409     2944    3         IF VIDBUF.SNLIST.VSN.S(I)~=0 THEN DO;

   2944  7 001066   000002 735000                    ALS     2
         7 001067   007466 236005 1                  LDQ     VIDBUF+320,AL
         7 001070   777000 316003                    CANQ    -512,DU
         7 001071   001112 600000 7                  TZE     s:2948

      410     2945    3            CALL INDEX(SETX,'  ',PSMSG.SNS);

   2945  7 001072   000000 120400                    SCD
         7 001073   010774 400062 1                  ADSC9   PSMSG+6                  cn=2,n=50
         7 001074   001063 000002 2                  ADSC9   ALPH+17                  cn=0,n=2
         7 001075   006764 000000 1                  ARG     SETX
         7 001076   001100 607000 7                  TTF     s:2946
         7 001077   006764 054000 1                  AOS     SETX

      411     2946    3            CALL INSERT(PSMSG.SNS,SETX,1,BINASC(VIDBUF.SNLIST.VSN.S(I)+64));

   2946  7 001100   007466 236005 1                  LDQ     VIDBUF+320,AL
         7 001101   000033 772000                    QRL     27
         7 001102   000100 036007                    ADLQ    64,DL
         7 001103   000033 736000                    QLS     27
         7 001104   000015 276000 8                  ORQ     13
         7 001105   200046 756100                    STQ     I+1,,AUTO
         7 001106   006764 235000 1                  LDA     SETX
         7 001107   040005 100500                    MLR     fill='040'O
         7 001110   200046 000004                    ADSC9   I+1,,AUTO                cn=0,n=4
         7 001111   010774 400001 1                  ADSC9   PSMSG+6,A                cn=2,n=1

      412     2947    3            END;
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:71   

      413     2948    2         END;

   2948  7 001112   006763 235000 1                  LDA     I
         7 001113   000001 035007                    ADLA    1,DL
         7 001114   006763 755000 1                  STA     I
         7 001115   006772 236000 1                  LDQ     VIDBUF+4
         7 001116   777777 376007                    ANQ     -1,DL
         7 001117   006763 116000 1                  CMPQ    I
         7 001120   001122 600000 7                  TZE     s:2949
         7 001121   001007 603000 7                  TRC     s:2933

      414     2949    1      IF NEWFILES THEN CALL WROC(6)ALTRET(NOTOK);

   2949  7 001122   000623 234000 1                  SZN     NEWFILES
         7 001123   001132 605000 7                  TPL     s:2950

   2949  7 001124   000001 236000 xsym               LDQ     B_VECTNIL+1
         7 001125   200042 756100                    STQ     @PMME+1,,AUTO
         7 001126   000016 236000 8                  LDQ     14
         7 001127   200041 756100                    STQ     SECTS+28,,AUTO
         7 001130   002302 701000 7                  TSX1    WROC
         7 001131   002211 702000 7                  TSX2    NOTOK

      415     2950    1      FIT_BUF.GRAN=GPBUF; /* GRANULE POOL HEADER                                 */

   2950  7 001132   010000 220003                    LDX0    4096,DU
         7 001133   000040 100400                    MLR     fill='000'O
         7 001134   000220 000024 2                  ADSC9   GPBUF                    cn=0,n=20
         7 001135   000662 000010 1                  ADSC9   FIT_BUF                  cn=0,n=*X0

      416     2951    1      FM$GRAN.AVAIL=1024-FM$GRAN.NAVX;

   2951  7 001136   000216 470400 2                  LDP0    G$
         7 001137   000001 236100                    LDQ     1,,PR0
         7 001140   000022 772000                    QRL     18
         7 001141   000027 676000 xsym               ERQ     B_VECTNIL+23
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:72   
         7 001142   002001 036007                    ADLQ    1025,DL
         7 001143   000001 676100                    ERQ     1,,PR0
         7 001144   001777 376007                    ANQ     1023,DL
         7 001145   000001 656100                    ERSQ    1,,PR0

      417     2952    2      IF NEWFILES THEN DO;

   2952  7 001146   000623 234000 1                  SZN     NEWFILES
         7 001147   001265 605000 7                  TPL     s:2977

      418     2953    2         GRANULE=1;

   2953  7 001150   000001 235007                    LDA     1,DL
         7 001151   006762 755000 1                  STA     GRANULE

      419     2954    2         CALL M$WRITE(WRDP)ALTRET(DPERR);

   2954  7 001152   000572 630400 1                  EPPR0   WRDP
         7 001153   440001 713400                    CLIMB   alt,write
         7 001154   401400 401760                    pmme    nvectors=4
         7 001155   002120 702000 7                  TSX2    DPERR

      420     2955    2         CALL M$TIME(CREATIME);

   2955  7 001156   000200 630400 2                  EPPR0   CREATIME
         7 001157   020004 713400                    CLIMB   8196
         7 001160   402000 401760                    pmme    nvectors=5

      421     2956    2         FM$GRAN.FCEX=SIZEW(FM$GRAN)+SIZEW(PADFIT);

   2956  7 001161   000034 220003                    LDX0    28,DU
         7 001162   000216 470400 2                  LDP0    G$
         7 001163   000002 740100                    STX0    2,,PR0

      422     2957    2         FM$GRAN.NAVX=FM$GRAN.FCEX+SIZEW(FM$KEYTBL);

   2957  7 001164   000106 621010                    EAX1    70,X0
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:73   
         7 001165   000001 741100                    STX1    1,,PR0

      423     2958    2         FM$GRAN.AVAIL=1024-FM$GRAN.NAVX;

   2958  7 001166   000001 236100                    LDQ     1,,PR0
         7 001167   000022 772000                    QRL     18
         7 001170   000027 676000 xsym               ERQ     B_VECTNIL+23
         7 001171   002001 036007                    ADLQ    1025,DL
         7 001172   000001 676100                    ERQ     1,,PR0
         7 001173   001777 376007                    ANQ     1023,DL
         7 001174   000001 656100                    ERSQ    1,,PR0

      424     2959    2         FM$GRAN.STAMP='274274274002'O;

   2959  7 001175   001065 236000 2                  LDQ     ALPH+19
         7 001176   000000 756100                    STQ     0,,PR0

      425     2960    2         FM$GRAN.LVL=FMGTPAD;

   2960  7 001177   000001 236100                    LDQ     1,,PR0
         7 001200   000017 376000 8                  ANQ     15
         7 001201   140000 276007                    ORQ     49152,DL
         7 001202   000001 756100                    STQ     1,,PR0

      426     2961    2         T$=PINCRW(G$,SIZEW(FM$GRAN));

   2961  7 001203   000216 236000 2                  LDQ     G$
         7 001204   000005 036003                    ADLQ    5,DU
         7 001205   200004 756100                    STQ     T$,,AUTO

      427     2962    2         T$->PADFITB=PADFIT;

   2962  7 001206   200004 471500                    LDP1    T$,,AUTO
         7 001207   000100 100400                    MLR     fill='000'O
         7 001210   011014 000134 1                  ADSC9   PADFIT                   cn=0,n=92
         7 001211   100000 000400                    ADSC9   0,,PR1                   cn=0,n=256

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:74   
      428     2963    2         T$=PINCRW(T$,SIZEW(PADFIT));

   2963  7 001212   200004 236100                    LDQ     T$,,AUTO
         7 001213   000027 036003                    ADLQ    23,DU
         7 001214   200004 756100                    STQ     T$,,AUTO

      429     2964    2         T$->FM$KEYTBL=INITKEYTBL;

   2964  7 001215   200004 471500                    LDP1    T$,,AUTO
         7 001216   000100 100400                    MLR     fill='000'O
         7 001217   000217 000001 2                  ADSC9   INITKEYTBL               cn=0,n=1
         7 001220   100000 000430                    ADSC9   0,,PR1                   cn=0,n=280

      430     2965    2         GRANULE=2;

   2965  7 001221   000002 235007                    LDA     2,DL
         7 001222   006762 755000 1                  STA     GRANULE

      431     2966    2         CALL M$WRITE(WRDP)ALTRET(DPERR);

   2966  7 001223   000572 630400 1                  EPPR0   WRDP
         7 001224   440001 713400                    CLIMB   alt,write
         7 001225   401400 401760                    pmme    nvectors=4
         7 001226   002120 702000 7                  TSX2    DPERR

      432     2967    2         FM$GRAN.FCEX=SIZEW(FM$GRAN);

   2967  7 001227   000005 220003                    LDX0    5,DU
         7 001230   000216 470400 2                  LDP0    G$
         7 001231   000002 740100                    STX0    2,,PR0

      433     2968    2         FM$GRAN.NAVX=FM$GRAN.FCEX+SIZEW(FM$KEYTBL);

   2968  7 001232   000106 621010                    EAX1    70,X0
         7 001233   000001 741100                    STX1    1,,PR0

      434     2969    2         FM$GRAN.AVAIL=1024-FM$GRAN.NAVX;
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:75   

   2969  7 001234   000001 236100                    LDQ     1,,PR0
         7 001235   000022 772000                    QRL     18
         7 001236   000027 676000 xsym               ERQ     B_VECTNIL+23
         7 001237   002001 036007                    ADLQ    1025,DL
         7 001240   000001 676100                    ERQ     1,,PR0
         7 001241   001777 376007                    ANQ     1023,DL
         7 001242   000001 656100                    ERSQ    1,,PR0

      435     2970    2         FM$GRAN.STAMP='142142142003'O;

   2970  7 001243   001066 236000 2                  LDQ     ALPH+20
         7 001244   000000 756100                    STQ     0,,PR0

      436     2971    2         FM$GRAN.LVL=FMGTMAD;

   2971  7 001245   000001 236100                    LDQ     1,,PR0
         7 001246   000017 376000 8                  ANQ     15
         7 001247   100000 276007                    ORQ     32768,DL
         7 001250   000001 756100                    STQ     1,,PR0

      437     2972    2         PINCRW(G$,FM$GRAN.FCEX)->FM$KEYTBL=INITKEYTBL;

   2972  7 001251   000000 635010                    EAA     0,X0
         7 001252   000020 771000                    ARL     16
         7 001253   000105 100400                    MLR     fill='000'O
         7 001254   000217 000001 2                  ADSC9   INITKEYTBL               cn=0,n=1
         7 001255   000000 000430                    ADSC9   0,A,PR0                  cn=0,n=280

      438     2973    2         GRANULE=3;

   2973  7 001256   000003 235007                    LDA     3,DL
         7 001257   006762 755000 1                  STA     GRANULE

      439     2974    2         CALL M$WRITE(WRDP)ALTRET(DPERR);

   2974  7 001260   000572 630400 1                  EPPR0   WRDP
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:76   
         7 001261   440001 713400                    CLIMB   alt,write
         7 001262   401400 401760                    pmme    nvectors=4
         7 001263   002120 702000 7                  TSX2    DPERR

      440     2975    2         GRANULE=0;

   2975  7 001264   006762 450000 1                  STZ     GRANULE

      441     2976    2         END;

      442     2977    1      CLSDP.V.DISP#=%SETPRIV#;

   2977  7 001265   000011 236007                    LDQ     9,DL
         7 001266   000454 552004 1                  STBQ    CLSDP+26,'04'O

      443     2978    1      I=0;

   2978  7 001267   006763 450000 1                  STZ     I

      444     2979    2      CALL M$CLOSE(CLSDP) WHENALTRETURN DO;

   2979  7 001270   000422 630400 1                  EPPR0   CLSDP
         7 001271   450001 713400                    CLIMB   alt,close
         7 001272   406000 401760                    pmme    nvectors=13
         7 001273   001275 702000 7                  TSX2    s:2980
         7 001274   001315 710000 7                  TRA     s:2984

      445     2980    2         IF ENTADDR(FXD$PMME)~=ENTADDR(NIL) THEN CALL FXD$PMME(ERR);

   2980  7 001275   000000 636000 xent               EAQ     FXD$PMME
         7 001276   000002 116000 xsym               CMPQ    B_VECTNIL+2
         7 001277   001305 600000 7                  TZE     s:2981

   2980  7 001300   000004 630400 8                  EPPR0   4
         7 001301   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 001302   000000 701000 xent               TSX1    FXD$PMME
         7 001303   000000 011000                    NOP     0
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:77   
         7 001304   001311 710000 7                  TRA     s:2982

      446     2981    2         ELSE ERR=B$ALT.ERR;

   2981  7 001305   000000 470400 xsym               LDP0    B$TCB$
         7 001306   000000 471500                    LDP1    0,,PR0
         7 001307   100102 236100                    LDQ     66,,PR1
         7 001310   000622 756000 1                  STQ     ERR

      447     2982    2         I=ERR.CODE;

   2982  7 001311   000622 236000 1                  LDQ     ERR
         7 001312   000003 772000                    QRL     3
         7 001313   037777 376007                    ANQ     16383,DL
         7 001314   006763 756000 1                  STQ     I

      448     2983    2         END;

      449     2984    1      IF I=%E$DUPSN THEN GOTO SETERR;

   2984  7 001315   006763 235000 1                  LDA     I
         7 001316   000221 115007                    CMPA    145,DL
         7 001317   002145 600000 7                  TZE     SETERR

      450     2985    2      IF I=%E$PSGRANS OR I=0 AND RECON THEN DO;

   2985  7 001320   000214 115007                    CMPA    140,DL
         7 001321   001326 600000 7                  TZE     s:2986
         7 001322   000000 115003                    CMPA    0,DU
         7 001323   001360 601000 7                  TNZ     s:2993
         7 001324   000624 234000 1                  SZN     RECON
         7 001325   001360 605000 7                  TPL     s:2993

      451     2986    2         IF NOT NEWFILES THEN CALL WROC(6);

   2986  7 001326   000623 234000 1                  SZN     NEWFILES
         7 001327   001337 604000 7                  TMI     s:2987
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:78   

   2986  7 001330   000001 236000 xsym               LDQ     B_VECTNIL+1
         7 001331   200042 756100                    STQ     @PMME+1,,AUTO
         7 001332   000016 236000 8                  LDQ     14
         7 001333   200041 756100                    STQ     SECTS+28,,AUTO
         7 001334   002302 701000 7                  TSX1    WROC
         7 001335   000000 011000                    NOP     0
         7 001336   001343 710000 7                  TRA     s:2988

      452     2987    2         ELSE IF ENTADDR(FXD$PMME)~=ENTADDR(NIL) THEN RETURN;

   2987  7 001337   000000 636000 xent               EAQ     FXD$PMME
         7 001340   000002 116000 xsym               CMPQ    B_VECTNIL+2
         7 001341   001343 600000 7                  TZE     s:2988

   2987  7 001342   000000 702200 xent               TSX2  ! X66_ARET

      453     2988    2         CALL FXH$RECON ALTRET(RECONERR);

   2988  7 001343   000002 631400 xsym               EPPR1   B_VECTNIL+2
         7 001344   000000 701000 xent               TSX1    FXH$RECON
         7 001345   002115 702000 7                  TSX2    RECONERR

      454     2989    2         IF NOT NEWFILES THEN CALL FXH$COUNT;

   2989  7 001346   000623 234000 1                  SZN     NEWFILES
         7 001347   001353 604000 7                  TMI     s:2990

   2989  7 001350   000002 631400 xsym               EPPR1   B_VECTNIL+2
         7 001351   000000 701000 xent               TSX1    FXH$COUNT
         7 001352   000000 011000                    NOP     0

      455     2990    2         CALL M$LDEV(FPT_LDEV)ALTRET(CHKR1);

   2990  7 001353   000460 630400 1                  EPPR0   FPT_LDEV
         7 001354   460004 713400                    CLIMB   alt,+24580
         7 001355   403000 401760                    pmme    nvectors=7
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:79   
         7 001356   001357 702000 7                  TSX2    CHKR1

   2989  7 001357                       CHKR1        null
      456     2991    2   CHKR1: ;
      457     2992    2         END;

   2992  7 001357   001373 710000 7                  TRA     s:2998

      458     2993    1      ELSE IF I~=0 THEN GOTO DPERR1;

   2993  7 001360   000000 115003                    CMPA    0,DU
         7 001361   002134 601000 7                  TNZ     DPERR1

      459     2994    2      ELSE DO;

      460     2995    2         CALL WROC(6);

   2995  7 001362   000001 236000 xsym               LDQ     B_VECTNIL+1
         7 001363   200042 756100                    STQ     @PMME+1,,AUTO
         7 001364   000016 236000 8                  LDQ     14
         7 001365   200041 756100                    STQ     SECTS+28,,AUTO
         7 001366   002302 701000 7                  TSX1    WROC
         7 001367   000000 011000                    NOP     0

      461     2996    2         CALL FXH$GPSUM;

   2996  7 001370   000002 631400 xsym               EPPR1   B_VECTNIL+2
         7 001371   000000 701000 xent               TSX1    FXH$GPSUM
         7 001372   000000 011000                    NOP     0

      462     2997    2         END;

      463     2998    2      IF NEWFILES THEN DO;

   2998  7 001373   000623 234000 1                  SZN     NEWFILES
         7 001374   001472 605000 7                  TPL     s:3024

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:80   
      464     2999    2         OPNDP.IFPARAM_=VECTOR(PADFIT);

   2999  7 001375   000020 237000 8                  LDAQ    16
         7 001376   000212 757000 1                  STAQ    OPNDP+22

      465     3000    2         PADFIT.C(1)='0'B; /* NO CODE04                                          */

   3000  7 001377   011015 450000 1                  STZ     PADFIT+1

      466     3001    2         PADFIT.ACCESS.NOACUP='1'B; /*NOACUP,OWNERF*/

   3001  7 001400   002000 236003                    LDQ     1024,DU
         7 001401   011033 256000 1                  ORSQ    PADFIT+15

      467     3002    2         PADFIT.DFLTALL=%FFLG_EXEC#;

   3002  7 001402   002000 220003                    LDX0    1024,DU
         7 001403   011033 440000 1                  SXL0    PADFIT+15

      468     3003    2         PADFIT.MGRANS=99999;

   3003  7 001404   303237 236007                    LDQ     99999,DL
         7 001405   011034 552034 1                  STBQ    PADFIT+16,'34'O

      469     3004    2         PADFIT.CGMEM=511;

   3004  7 001406   777000 236003                    LDQ     -512,DU
         7 001407   011034 552040 1                  STBQ    PADFIT+16,'40'O

      470     3005    2         OPNDP.ACCT_=OPNEO.ACCT_;

   3005  7 001410   000116 237000 1                  LDAQ    OPNEO+20
         7 001411   000210 757000 1                  STAQ    OPNDP+20

      471     3006    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);

   3006  7 001412   000164 630400 1                  EPPR0   OPNDP
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:81   
         7 001413   450000 713400                    CLIMB   alt,open
         7 001414   410400 401760                    pmme    nvectors=18
         7 001415   002120 702000 7                  TSX2    DPERR

      472     3007    2         OPNDP.ACCT_=VECTOR(MAIL);

   3007  7 001416   000022 237000 8                  LDAQ    18
         7 001417   000210 757000 1                  STAQ    OPNDP+20

      473     3008    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);

   3008  7 001420   000164 630400 1                  EPPR0   OPNDP
         7 001421   450000 713400                    CLIMB   alt,open
         7 001422   410400 401760                    pmme    nvectors=18
         7 001423   002120 702000 7                  TSX2    DPERR

      474     3009    2         OPNDP.ACCT_=VECTOR(SYSTAC);

   3009  7 001424   000024 237000 8                  LDAQ    20
         7 001425   000210 757000 1                  STAQ    OPNDP+20

      475     3010    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);

   3010  7 001426   000164 630400 1                  EPPR0   OPNDP
         7 001427   450000 713400                    CLIMB   alt,open
         7 001430   410400 401760                    pmme    nvectors=18
         7 001431   002120 702000 7                  TSX2    DPERR

      476     3011    2         PADFIT.DFLTALL='0'B;

   3011  7 001432   000000 220003                    LDX0    0,DU
         7 001433   011033 440000 1                  SXL0    PADFIT+15

      477     3012    2         OPNDP.ACCT_=VECTOR(SYMI);

   3012  7 001434   000026 237000 8                  LDAQ    22
         7 001435   000210 757000 1                  STAQ    OPNDP+20
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:82   

      478     3013    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);

   3013  7 001436   000164 630400 1                  EPPR0   OPNDP
         7 001437   450000 713400                    CLIMB   alt,open
         7 001440   410400 401760                    pmme    nvectors=18
         7 001441   002120 702000 7                  TSX2    DPERR

      479     3014    2         OPNDP.ACCT_=VECTOR(SYMO);

   3014  7 001442   000030 237000 8                  LDAQ    24
         7 001443   000210 757000 1                  STAQ    OPNDP+20

      480     3015    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);

   3015  7 001444   000164 630400 1                  EPPR0   OPNDP
         7 001445   450000 713400                    CLIMB   alt,open
         7 001446   410400 401760                    pmme    nvectors=18
         7 001447   002120 702000 7                  TSX2    DPERR

      481     3016    2         PADFIT.C(3)='220014006004'O; /* ACCess account                          */

   3016  7 001450   001067 236000 2                  LDQ     ALPH+21
         7 001451   011017 756000 1                  STQ     PADFIT+3

      482     3017    2         ADDR(PADFIT.MOUNT)->VLP$ACCESS.FFLG=%FFLG_WRITE#;

   3017  7 001452   765000 220003                    LDX0    -5632,DU
         7 001453   011020 740000 1                  STX0    PADFIT+4

      483     3018    2         ADDR(PADFIT.MOUNT)->VLP$ACCESS.ACCT=':NCTL';

   3018  7 001454   040000 100400                    MLR     fill='040'O
         7 001455   001070 000005 2                  ADSC9   ALPH+22                  cn=0,n=5
         7 001456   011020 400010 1                  ADSC9   PADFIT+4                 cn=2,n=8

      484     3019    2         PADFIT.DFLTALL=%FFLG_NOLIST#;
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:83   

   3019  7 001457   010000 221003                    LDX1    4096,DU
         7 001460   011033 441000 1                  SXL1    PADFIT+15

      485     3020    2         OPNDP.ACCT_=VECTOR(MOVE);

   3020  7 001461   000032 237000 8                  LDAQ    26
         7 001462   000210 757000 1                  STAQ    OPNDP+20

      486     3021    2         CALL M$OPEN(OPNDP)ALTRET(DPERR);

   3021  7 001463   000164 630400 1                  EPPR0   OPNDP
         7 001464   450000 713400                    CLIMB   alt,open
         7 001465   410400 401760                    pmme    nvectors=18
         7 001466   002120 702000 7                  TSX2    DPERR

      487     3022    2         OPNDP.IFPARAM_=VECTOR(NIL);

   3022  7 001467   000034 237000 8                  LDAQ    28
         7 001470   000212 757000 1                  STAQ    OPNDP+22

      488     3023    2         END;

   3023  7 001471   001515 710000 7                  TRA     s:3029

      489     3024    2      ELSE DO WHILE SGRANS<2000;

   3024  7 001472   000000 235000 xsym               LDA     SGRANS
         7 001473   003720 115007                    CMPA    2000,DL
         7 001474   001515 605000 7                  TPL     s:3029

      490     3025    3         CALL WROC(9) WHENALTRETURN DO;

   3025  7 001475   000001 236000 xsym               LDQ     B_VECTNIL+1
         7 001476   200042 756100                    STQ     @PMME+1,,AUTO
         7 001477   000036 236000 8                  LDQ     30
         7 001500   200041 756100                    STQ     SECTS+28,,AUTO
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:84   
         7 001501   002302 701000 7                  TSX1    WROC
         7 001502   001504 702000 7                  TSX2    s:3026
         7 001503   001512 710000 7                  TRA     s:3028

      491     3026    3            CALL WROC (10);

   3026  7 001504   000001 236000 xsym               LDQ     B_VECTNIL+1
         7 001505   200042 756100                    STQ     @PMME+1,,AUTO
         7 001506   000037 236000 8                  LDQ     31
         7 001507   200041 756100                    STQ     SECTS+28,,AUTO
         7 001510   002302 701000 7                  TSX1    WROC
         7 001511   000000 011000                    NOP     0

      492     3027    3            END;

      493     3028    2         END;

   3028  7 001512   000000 235000 xsym               LDA     SGRANS
         7 001513   003720 115007                    CMPA    2000,DL
         7 001514   001475 604000 7                  TMI     s:3025

      494     3029    1      CALL M$OPEN(OPNDP)ALTRET(RECON_LEFT_OPEN);

   3029  7 001515   000164 630400 1                  EPPR0   OPNDP
         7 001516   450000 713400                    CLIMB   alt,open
         7 001517   410400 401760                    pmme    nvectors=18
         7 001520   001521 702000 7                  TSX2    RECON_LEFT_OPEN

      495     3030    1   RECON_LEFT_OPEN:;

   3030  7 001521                       RECON_LEFT_* null
      496     3031        /* REMEMBER RECONSTRUCT TIME FOR RELSTARF IN RECOVERY */
      497     3032    1      GRANULE=2;

   3032  7 001521   000002 235007                    LDA     2,DL
         7 001522   006762 755000 1                  STA     GRANULE

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:85   
      498     3033    1      CALL M$READ(RDDP)ALTRET(DPERR);

   3033  7 001523   000554 630400 1                  EPPR0   RDDP
         7 001524   440000 713400                    CLIMB   alt,read
         7 001525   401400 401760                    pmme    nvectors=4
         7 001526   002120 702000 7                  TSX2    DPERR

      499     3034    1      T$=ADDR(VIDBUFW(SIZEW(FM$GRAN)));

   3034  7 001527   000040 236000 8                  LDQ     32
         7 001530   200004 756100                    STQ     T$,,AUTO

      500     3035    1      CALL XSF$LOCCODT(T$,4)ALTRET(NORECUTS);

   3035  7 001531   000041 236000 8                  LDQ     33
         7 001532   200047 756100                    STQ     I+2,,AUTO
         7 001533   200004 630500                    EPPR0   T$,,AUTO
         7 001534   200046 450500                    STP0    I+1,,AUTO
         7 001535   200046 630500                    EPPR0   I+1,,AUTO
         7 001536   000020 631400 xsym               EPPR1   B_VECTNIL+16
         7 001537   000000 701000 xent               TSX1    XSF$LOCCODT
         7 001540   001544 702000 7                  TSX2    NORECUTS

      501     3036    1      IGG_RECONUTS=CODE04.MODIFY.TIME;

   3036  7 001541   200004 470500                    LDP0    T$,,AUTO
         7 001542   000001 235100                    LDA     1,,PR0
         7 001543   000626 755000 1                  STA     IGG_RECONUTS

   3036  7 001544                       NORECUTS     null
      502     3037    1   NORECUTS:;
      503     3038    1      CLSDP.V.DISP#=%SETPUB#;

   3038  7 001544   000010 236007                    LDQ     8,DL
         7 001545   000454 552004 1                  STBQ    CLSDP+26,'04'O

      504     3039    1      CALL M$CLOSE(CLSDP)ALTRET(SETERR);
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:86   

   3039  7 001546   000422 630400 1                  EPPR0   CLSDP
         7 001547   450001 713400                    CLIMB   alt,close
         7 001550   406000 401760                    pmme    nvectors=13
         7 001551   002145 702000 7                  TSX2    SETERR

      505     3040    2      IF NOT SYSFILES THEN DO;

   3040  7 001552   000625 234000 1                  SZN     SYSFILES
         7 001553   001650 604000 7                  TMI     s:3066

      506     3041    2   ALLDONE: ;

   3041  7 001554                       ALLDONE      null
      507     3042    2         IF BOOTFLAG=I_RECOVERY THEN RETURN;

   3042  7 001554   200003 470500                    LDP0    @BOOTFLAG,,AUTO
         7 001555   000000 235100                    LDA     0,,PR0
         7 001556   000011 115007                    CMPA    9,DL
         7 001557   001561 601000 7                  TNZ     s:3043

   3042  7 001560   000000 702200 xent               TSX2  ! X66_ARET

      508     3043    3         IF BOOTFLAG<I_DISKBOOT THEN DO;

   3043  7 001561   000007 115007                    CMPA    7,DL
         7 001562   001602 603000 7                  TRC     RELPOERR2

      509     3044    3            IF NOT SYSFILES THEN CALL M$OPEN(GETPO) ALTRET(RELPOERR1);

   3044  7 001563   000625 234000 1                  SZN     SYSFILES
         7 001564   001571 604000 7                  TMI     s:3045

   3044  7 001565   000026 630400 2                  EPPR0   GETPO
         7 001566   450000 713400                    CLIMB   alt,open
         7 001567   410400 401760                    pmme    nvectors=18
         7 001570   001576 702000 7                  TSX2    RELPOERR1
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:87   

      510     3045    3            CALL M$CLOSE(RELPO) ALTRET(RELPOERR1);

   3045  7 001571   000120 630400 2                  EPPR0   RELPO
         7 001572   450001 713400                    CLIMB   alt,close
         7 001573   406000 401760                    pmme    nvectors=13
         7 001574   001576 702000 7                  TSX2    RELPOERR1

      511     3046    4            DO WHILE(FALSE);

   3046  7 001575   001602 710000 7                  TRA     RELPOERR2

      512     3047    4   RELPOERR1:  CALL M$RELRES(RELRESPO) ALTRET(RELPOERR2);

   3047  7 001576   000156 630400 2     RELPOERR1    EPPR0   RELRESPO
         7 001577   550003 713400                    CLIMB   alt,+53251
         7 001600   402400 401760                    pmme    nvectors=6
         7 001601   001602 702000 7                  TSX2    RELPOERR2

      513     3048    4               END;

      514     3049    3   RELPOERR2: END;

   3049  7 001602                       RELPOERR2    null
      515     3050    2         OPNEO.V.FUN#=%UPDATE#;

   3050  7 001602   001000 236007                    LDQ     512,DL
         7 001603   000137 552010 1                  STBQ    OPNEO+37,'10'O

      516     3051    2         OPNEO.V.ACS#=%DIRECT#;

   3051  7 001604   000002 236007                    LDQ     2,DL
         7 001605   000140 552004 1                  STBQ    OPNEO+38,'04'O

      517     3052    2         VLP_NAME=CATNAME;

   3052  7 001606   000000 100400                    MLR     fill='000'O
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:88   
         7 001607   000017 000005 2                  ADSC9   CATNAME                  cn=0,n=5
         7 001610   000652 000040 1                  ADSC9   VLP_NAME                 cn=0,n=32

      518     3053    2         OPNEO.IFPARAM_=VECTOR(NIL);

   3053  7 001611   000034 237000 8                  LDAQ    28
         7 001612   000120 757000 1                  STAQ    OPNEO+22

      519     3054    2         CALL M$OPEN(OPNEO)ALTRET(NOCAT);

   3054  7 001613   000072 630400 1                  EPPR0   OPNEO
         7 001614   450000 713400                    CLIMB   alt,open
         7 001615   410400 401760                    pmme    nvectors=18
         7 001616   001647 702000 7                  TSX2    NOCAT

      520     3055    2         CALL M$READ(RSTAT)ALTRET(NOCAT);

   3055  7 001617   000000 630400 2                  EPPR0   RSTAT
         7 001620   440000 713400                    CLIMB   alt,read
         7 001621   401400 401760                    pmme    nvectors=4
         7 001622   001647 702000 7                  TSX2    NOCAT

      521     3056    2         ADDR(FIT_BUF)->FX$STAT.NUM=0;

   3056  7 001623   000662 450000 1                  STZ     FIT_BUF

      522     3057    2         ADDR(FIT_BUF)->FX$STAT.SETS.SETX(0)=0;

   3057  7 001624   000000 236003                    LDQ     0,DU
         7 001625   000665 552004 1                  STBQ    FIT_BUF+3,'04'O

      523     3058    2         WRT.BUF_.BOUND=SIZEV(FX$STAT);

   3058  7 001626   000526 236000 1                  LDQ     WRT+4
         7 001627   177777 376007                    ANQ     65535,DL
         7 001630   000042 276000 8                  ORQ     34
         7 001631   000526 756000 1                  STQ     WRT+4
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:89   

      524     3059    2         WRT.BUF_.BUF$=ADDR(FIT_BUF);

   3059  7 001632   000043 236000 8                  LDQ     35
         7 001633   000527 756000 1                  STQ     WRT+5

      525     3060    2         KEYBUFB=STATKEY;

   3060  7 001634   000000 100400                    MLR     fill='000'O
         7 001635   000016 000002 2                  ADSC9   STATKEY                  cn=0,n=2
         7 001636   006662 000400 1                  ADSC9   KEYBUF                   cn=0,n=256

      526     3061    2         CALL M$WRITE(WRT)ALTRET(NOCAT);

   3061  7 001637   000522 630400 1                  EPPR0   WRT
         7 001640   440001 713400                    CLIMB   alt,write
         7 001641   401400 401760                    pmme    nvectors=4
         7 001642   001647 702000 7                  TSX2    NOCAT

      527     3062    2         CALL M$CLOSE(CLSEO)ALTRET(NOCAT);

   3062  7 001643   000270 630400 1                  EPPR0   CLSEO
         7 001644   450001 713400                    CLIMB   alt,close
         7 001645   406000 401760                    pmme    nvectors=13
         7 001646   001647 702000 7                  TSX2    NOCAT

   3060  7 001647                       NOCAT        null
      528     3063    2   NOCAT: ;
      529     3064    2         RETURN;

   3064  7 001647   000000 702200 xent               TSX2  ! X66_ARET

      530     3065    2         END;
      531     3066    1      JDCB$=DCBADDR(DCBNUM(M$EI));

   3066  7 001650   000000 236007 xsym               LDQ     M$EI,DL
         7 001651   000000 470400 8                  LDP0    0
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:90   
         7 001652   000000 471500                    LDP1    0,,PR0
         7 001653   100000 236106                    LDQ     0,QL,PR1
         7 001654   000000 756000 xsym               STQ     M$DP$

      532     3067        /*
      533     3068        *  COPY THE FILES IN FROM THE TAPE TO THE DISK.
      534     3069        **/
      535     3070    2      DO WHILE (TRUE);

      536     3071    2         CALL M$OPEN(OPNEI) ALTRET(CONTTEST);

   3071  7 001655   000000 630400 1                  EPPR0   OPNEI
         7 001656   450000 713400                    CLIMB   alt,open
         7 001657   410400 401760                    pmme    nvectors=18
         7 001660   002047 702000 7                  TSX2    CONTTEST

      537     3072    2         OPNEI.V.OPER.NXTF#='1'B;

   3072  7 001661   004000 236007                    LDQ     2048,DL
         7 001662   000044 256000 1                  ORSQ    OPNEI+36

      538     3073    2         OPNEI.V.VOL#=0;

   3073  7 001663   000000 236003                    LDQ     0,DU
         7 001664   000061 552040 1                  STBQ    OPNEI+49,'40'O

      539     3074    2         IF JDCB$->F$DCB.NAME.C='$DUMMYFILE' THEN GOTO NXTPHASE2;

   3074  7 001665   000000 470400 xsym               LDP0    M$DP$
         7 001666   040000 106500                    CMPC    fill='040'O
         7 001667   000010 200037                    ADSC9   8,,PR0                   cn=1,n=31
         7 001670   001072 000012 2                  ADSC9   ALPH+24                  cn=0,n=10
         7 001671   002030 600000 7                  TZE     NXTPHASE2

      540     3075    2         VLP_NAME=JDCB$->F$DCB.NAME;

   3075  7 001672   000000 100500                    MLR     fill='000'O
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:91   
         7 001673   000010 000040                    ADSC9   8,,PR0                   cn=0,n=32
         7 001674   000652 000040 1                  ADSC9   VLP_NAME                 cn=0,n=32

   3075  7 001675                       OPNSLUG      null
      541     3076    2   OPNSLUG: ;
      542     3077    2         IF JDCB$->F$DCB.IORG=%RANDOM# THEN RDT.BUF_.BOUND=4095;

   3077  7 001675   000000 470400 xsym               LDP0    M$DP$
         7 001676   000070 236100                    LDQ     56,,PR0
         7 001677   077000 376003                    ANQ     32256,DU
         7 001700   003000 116003                    CMPQ    1536,DU
         7 001701   001707 601000 7                  TNZ     s:3078

   3077  7 001702   000542 236000 1                  LDQ     RDT+4
         7 001703   177777 376007                    ANQ     65535,DL
         7 001704   000044 276000 8                  ORQ     36
         7 001705   000542 756000 1                  STQ     RDT+4
         7 001706   001713 710000 7                  TRA     s:3079

      543     3078    2         ELSE RDT.BUF_.BOUND=SIZEV(FIT_BUF);

   3078  7 001707   000542 236000 1                  LDQ     RDT+4
         7 001710   177777 376007                    ANQ     65535,DL
         7 001711   000045 276000 8                  ORQ     37
         7 001712   000542 756000 1                  STQ     RDT+4

      544     3079    2         IF JDCB$->F$DCB.ORG=%RESTRICT# THEN OPNEO.V.ACS#=%BLOCK#;

   3079  7 001713   000032 236100                    LDQ     26,,PR0
         7 001714   777000 376003                    ANQ     -512,DU
         7 001715   022000 116003                    CMPQ    9216,DU
         7 001716   001722 601000 7                  TNZ     s:3080

   3079  7 001717   000003 236007                    LDQ     3,DL
         7 001720   000140 552004 1                  STBQ    OPNEO+38,'04'O
         7 001721   001724 710000 7                  TRA     s:3081

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:92   
      545     3080    2         ELSE OPNEO.V.ACS#=%DIRECT#;

   3080  7 001722   000002 236007                    LDQ     2,DL
         7 001723   000140 552004 1                  STBQ    OPNEO+38,'04'O

      546     3081    2         CALL M$OPEN(OPNEO) ALTRET(OUTERR);

   3081  7 001724   000072 630400 1                  EPPR0   OPNEO
         7 001725   450000 713400                    CLIMB   alt,open
         7 001726   410400 401760                    pmme    nvectors=18
         7 001727   002270 702000 7                  TSX2    OUTERR

      547     3082        /**/
      548     3083    3         DO WHILE (TRUE);

      549     3084    4            CALL M$READ(RDT) WHENRETURN DO;

   3084  7 001730   000536 630400 1                  EPPR0   RDT
         7 001731   440000 713400                    CLIMB   alt,read
         7 001732   401400 401760                    pmme    nvectors=4
         7 001733   001751 702000 7                  TSX2    s:3090

      550     3085    4               IF JDCB$->F$DCB.ORG=%RESTRICT# THEN

   3085  7 001734   000000 470400 xsym               LDP0    M$DP$
         7 001735   000032 236100                    LDQ     26,,PR0
         7 001736   777000 376003                    ANQ     -512,DU
         7 001737   022000 116003                    CMPQ    9216,DU
         7 001740   001743 601000 7                  TNZ     s:3087

      551     3086    4               KEYBUFW(0)=FIT_BUF.GRAN(0);

   3086  7 001741   000662 235000 1                  LDA     FIT_BUF
         7 001742   006662 755000 1                  STA     KEYBUF

      552     3087    4               WRT.V.DVBYTE=JDCB$->F$DCB.DVBYTE;

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:93   
   3087  7 001743   000003 236100                    LDQ     3,,PR0
         7 001744   776000 376003                    ANQ     -1024,DU
         7 001745   000535 552040 1                  STBQ    WRT+11,'40'O

      553     3088    4               WRT.V.DVBYTE.CONT#='0'B;

   3088  7 001746   000046 236000 8                  LDQ     38
         7 001747   000535 356000 1                  ANSQ    WRT+11

      554     3089    4               END; WHENALTRETURN DO;

   3089  7 001750   001766 710000 7                  TRA     s:3094

      555     3090    4               WRT.V.DVBYTE=JDCB$->F$DCB.DVBYTE;

   3090  7 001751   000000 470400 xsym               LDP0    M$DP$
         7 001752   000003 236100                    LDQ     3,,PR0
         7 001753   776000 376003                    ANQ     -1024,DU
         7 001754   000535 552040 1                  STBQ    WRT+11,'40'O

      556     3091    4               IF B$ALT.ERR.CODE=%E$LD THEN WRT.V.DVBYTE.CONT#='1'B;

   3091  7 001755   000000 471400 xsym               LDP1    B$TCB$
         7 001756   100000 473500                    LDP3    0,,PR1
         7 001757   300102 236100                    LDQ     66,,PR3
         7 001760   377770 376007                    ANQ     131064,DL
         7 001761   000070 116007                    CMPQ    56,DL
         7 001762   002014 601000 7                  TNZ     TESTEOF

   3091  7 001763   001000 236003                    LDQ     512,DU
         7 001764   000535 256000 1                  ORSQ    WRT+11
         7 001765   001766 710000 7                  TRA     s:3094

      557     3092    4               ELSE GOTO TESTEOF;
      558     3093    4               END;
      559     3094    4            IF JDCB$->F$DCB.ARS>0 THEN DO;

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:94   
   3094  7 001766   000000 235100                    LDA     0,,PR0
         7 001767   002001 604400 7                  TMOZ    s:3099

      560     3095    4               WRT.BUF_.BUF$=ADDR(FIT_BUF);

   3095  7 001770   000043 236000 8                  LDQ     35
         7 001771   000527 756000 1                  STQ     WRT+5

      561     3096    4               WRT.BUF_.BOUND=JDCB$->F$DCB.ARS-1;

   3096  7 001772   000000 236100                    LDQ     0,,PR0
         7 001773   000001 136007                    SBLQ    1,DL
         7 001774   000020 736000                    QLS     16
         7 001775   000526 676000 1                  ERQ     WRT+4
         7 001776   000034 376000 xsym               ANQ     B_VECTNIL+28
         7 001777   000526 656000 1                  ERSQ    WRT+4

      562     3097    4               END;

   3097  7 002000   002003 710000 7                  TRA     s:3100

      563     3098    3            ELSE
      564     3099    3            WRT.BUF_=VECTOR(NIL);

   3099  7 002001   000034 237000 8                  LDAQ    28
         7 002002   000526 757000 1                  STAQ    WRT+4

      565     3100    3            CALL M$WRITE(WRT) ALTRET(IOERR);

   3100  7 002003   000522 630400 1                  EPPR0   WRT
         7 002004   440001 713400                    CLIMB   alt,write
         7 002005   401400 401760                    pmme    nvectors=4
         7 002006   002253 702000 7                  TSX2    IOERR

      566     3101    3            RDT.V.DVBYTE.CONT#=WRT.V.DVBYTE.CONT#;

   3101  7 002007   000535 236000 1                  LDQ     WRT+11
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:95   
         7 002010   000551 676000 1                  ERQ     RDT+11
         7 002011   001000 376003                    ANQ     512,DU
         7 002012   000551 656000 1                  ERSQ    RDT+11

      567     3102    3            END;

   3102  7 002013   001730 710000 7                  TRA     s:3084

      568     3103        /**/
      569     3104    2   TESTEOF: IF B$ALT.ERR.CODE~=%E$EOF

   3104  7 002014   000060 116007       TESTEOF      CMPQ    48,DL
         7 002015   002024 600000 7                  TZE     NXTPHASE1

      570     3105    2         THEN CALL WROC(2,0);

   3105  7 002016   000047 236000 8                  LDQ     39
         7 002017   200042 756100                    STQ     @PMME+1,,AUTO
         7 002020   000050 236000 8                  LDQ     40
         7 002021   200041 756100                    STQ     SECTS+28,,AUTO
         7 002022   002302 701000 7                  TSX1    WROC
         7 002023   000000 011000                    NOP     0

      571     3106    2   NXTPHASE1:
      572     3107    2         CALL M$CLOSE(CLSEO) ALTRET(CLSEOERR);

   3107  7 002024   000270 630400 1     NXTPHASE1    EPPR0   CLSEO
         7 002025   450001 713400                    CLIMB   alt,close
         7 002026   406000 401760                    pmme    nvectors=13
         7 002027   002245 702000 7                  TSX2    CLSEOERR

      573     3108    2   NXTPHASE2:
      574     3109    2         IF JDCB$->F$DCB.FCD

   3109  7 002030   000000 470400 xsym  NXTPHASE2    LDP0    M$DP$
         7 002031   000031 236100                    LDQ     25,,PR0
         7 002032   020000 316007                    CANQ    8192,DL
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:96   
         7 002033   002040 600000 7                  TZE     s:3111

      575     3110    2         THEN CALL M$CLOSE(CLSEI) ALTRET(CLSEIERR);

   3110  7 002034   000326 630400 1                  EPPR0   CLSEI
         7 002035   450001 713400                    CLIMB   alt,close
         7 002036   406000 401760                    pmme    nvectors=13
         7 002037   002236 702000 7                  TSX2    CLSEIERR

      576     3111    2         CLSEI.V.POS#=0;

   3111  7 002040   000000 236003                    LDQ     0,DU
         7 002041   000362 552040 1                  STBQ    CLSEI+28,'40'O

      577     3112    2   NXTPHASE3:
      578     3113    2         IF OPNEI.V.ASN#=%FILE# THEN GOTO ALLDONE;

   3113  7 002042   000045 236000 1     NXTPHASE3    LDQ     OPNEI+37
         7 002043   000777 376007                    ANQ     511,DL
         7 002044   000001 116007                    CMPQ    1,DL
         7 002045   001554 600000 7                  TZE     ALLDONE

      579     3114    2         END;

   3114  7 002046   001655 710000 7                  TRA     s:3071

      580     3115        /**/
      581     3116    1   CONTTEST:
      582     3117    1      IF B$ALT.ERR.CODE~=%E$EOSET THEN

   3117  7 002047   000000 470400 xsym  CONTTEST     LDP0    B$TCB$
         7 002050   000000 471500                    LDP1    0,,PR0
         7 002051   100102 236100                    LDQ     66,,PR1
         7 002052   377770 376007                    ANQ     131064,DL
         7 002053   013140 116007                    CMPQ    5728,DL
         7 002054   002062 600000 7                  TZE     s:3119

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:97   
      583     3118    1      CALL WROC(0,0) ALTRET (NXTPHASE2);

   3118  7 002055   000047 236000 8                  LDQ     39
         7 002056   200042 756100                    STQ     @PMME+1,,AUTO
         7 002057   200041 756100                    STQ     SECTS+28,,AUTO
         7 002060   002302 701000 7                  TSX1    WROC
         7 002061   002030 702000 7                  TSX2    NXTPHASE2

      584     3119    1      OPNEI.V.ASN#=%FILE#;

   3119  7 002062   000001 236007                    LDQ     1,DL
         7 002063   000045 552004 1                  STBQ    OPNEI+37,'04'O

      585     3120    1      OPNEI.SN_=VECTOR(ERASE);

   3120  7 002064   000002 237000 8                  LDAQ    2
         7 002065   000002 757000 1                  STAQ    OPNEI+2

      586     3121    1      OPNEI.V.OPER.THISF#=%YES#;

   3121  7 002066   002000 236007                    LDQ     1024,DL
         7 002067   000044 256000 1                  ORSQ    OPNEI+36

      587     3122    1      OPNEI.V.OPER.TEST#=%YES#;

   3122  7 002070   020000 236007                    LDQ     8192,DL
         7 002071   000044 256000 1                  ORSQ    OPNEI+36

      588     3123    1      OPNEI.NAME_=VECTOR(SLUGNAME);

   3123  7 002072   000052 237000 8                  LDAQ    42
         7 002073   000006 757000 1                  STAQ    OPNEI+6

      589     3124    1      CALL M$OPEN(OPNEI);

   3124  7 002074   000000 630400 1                  EPPR0   OPNEI
         7 002075   050000 713400                    CLIMB   open
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:98   
         7 002076   410400 401760                    pmme    nvectors=18

      590     3125    2      IF JDCB$->F$DCB.NAME.L>4 AND SUBSTR(JDCB$->F$DCB.NAME.C,0,4)='SLUG' THEN DO;

   3125  7 002077   000000 470400 xsym               LDP0    M$DP$
         7 002100   000010 236100                    LDQ     8,,PR0
         7 002101   777000 376003                    ANQ     -512,DU
         7 002102   005000 116003                    CMPQ    2560,DU
         7 002103   002114 602000 7                  TNC     s:3129
         7 002104   040000 106500                    CMPC    fill='040'O
         7 002105   000010 200004                    ADSC9   8,,PR0                   cn=1,n=4
         7 002106   001075 000004 2                  ADSC9   ALPH+27                  cn=0,n=4
         7 002107   002114 601000 7                  TNZ     s:3129

      591     3126    2         VLP_NAME=SLUGNAME;

   3126  7 002110   000000 100400                    MLR     fill='000'O
         7 002111   000214 000005 2                  ADSC9   SLUGNAME                 cn=0,n=5
         7 002112   000652 000040 1                  ADSC9   VLP_NAME                 cn=0,n=32

      592     3127    2         GOTO OPNSLUG;

   3127  7 002113   001675 710000 7                  TRA     OPNSLUG

      593     3128    2         END;
      594     3129    1      GOTO ALLDONE;

   3129  7 002114   001554 710000 7                  TRA     ALLDONE

      595     3130        /**/
      596     3131    1   RECONERR: ERR=ERRCODE;

   3131  7 002115   000000 236000 xsym  RECONERR     LDQ     ERRCODE
         7 002116   000622 756000 1                  STQ     ERR

      597     3132    1      GOTO DPERR1;

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:99   
   3132  7 002117   002134 710000 7                  TRA     DPERR1

      598     3133    1   DPERR:
      599     3134    1      IF ENTADDR(FXD$PMME)~=ENTADDR(NIL) THEN CALL FXD$PMME(ERR);

   3134  7 002120   000000 636000 xent  DPERR        EAQ     FXD$PMME
         7 002121   000002 116000 xsym               CMPQ    B_VECTNIL+2
         7 002122   002130 600000 7                  TZE     s:3135

   3134  7 002123   000004 630400 8                  EPPR0   4
         7 002124   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 002125   000000 701000 xent               TSX1    FXD$PMME
         7 002126   000000 011000                    NOP     0
         7 002127   002134 710000 7                  TRA     DPERR1

      600     3135    1      ELSE ERR=B$ALT.ERR;

   3135  7 002130   000000 470400 xsym               LDP0    B$TCB$
         7 002131   000000 471500                    LDP1    0,,PR0
         7 002132   100102 236100                    LDQ     66,,PR1
         7 002133   000622 756000 1                  STQ     ERR

   3134  7 002134                       DPERR1       null
      601     3136    1   DPERR1:;
      602     3137    1      ERR.SEV=0;

   3137  7 002134   000054 236000 8                  LDQ     44
         7 002135   000622 356000 1                  ANSQ    ERR

      603     3138    2      DO WHILE '1'B;

      604     3139    2         CALL WROC1(4,2);

   3139  7 002136   000050 236000 8                  LDQ     40
         7 002137   200042 756100                    STQ     @PMME+1,,AUTO
         7 002140   000041 236000 8                  LDQ     33
         7 002141   200041 756100                    STQ     SECTS+28,,AUTO
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:100  
         7 002142   002312 701000 7                  TSX1    WROC1
         7 002143   000000 011000                    NOP     0

      605     3140    2         END;

   3140  7 002144   002136 710000 7                  TRA     s:3139

      606     3141    1   SETERR: VIDBUF.PSN=JDCB$->F$DCB.PSN;

   3141  7 002145   000000 470400 xsym  SETERR       LDP0    M$DP$
         7 002146   040000 100500                    MLR     fill='040'O
         7 002147   000024 000006                    ADSC9   20,,PR0                  cn=0,n=6
         7 002150   006771 000006 1                  ADSC9   VIDBUF+3                 cn=0,n=6

      607     3142    1      OPNDP.SN_=VECTOR(ERASE);

   3142  7 002151   000002 237000 8                  LDAQ    2
         7 002152   000166 757000 1                  STAQ    OPNDP+2

      608     3143        /* WAIT FOR OPERATOR TO MOUNT SOMETHING */
      609     3144    2      IF CLSDP.V.DISP#=%SAVE# THEN DO;

   3144  7 002153   000454 236000 1                  LDQ     CLSDP+26
         7 002154   000777 376007                    ANQ     511,DL
         7 002155   000002 116007                    CMPQ    2,DL
         7 002156   002173 601000 7                  TNZ     s:3149

      610     3145    2   SETERR1: ERR.SEV=0;

   3145  7 002157   000054 236000 8     SETERR1      LDQ     44
         7 002160   000622 356000 1                  ANSQ    ERR

      611     3146    2         CALL WROC1(0,3);

   3146  7 002161   000055 236000 8                  LDQ     45
         7 002162   200042 756100                    STQ     @PMME+1,,AUTO
         7 002163   000047 236000 8                  LDQ     39
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:101  
         7 002164   200041 756100                    STQ     SECTS+28,,AUTO
         7 002165   002312 701000 7                  TSX1    WROC1
         7 002166   000000 011000                    NOP     0

      612     3147    2         CALL M$WAIT(WAIT20);

   3147  7 002167   000606 630400 1                  EPPR0   WAIT20
         7 002170   020006 713400                    CLIMB   8198
         7 002171   400400 401760                    pmme    nvectors=2

      613     3148    2         END;

   3148  7 002172   002203 710000 7                  TRA     s:3152

      614     3149    2      ELSE DO I=0 TO 9999;

   3149  7 002173   006763 450000 1                  STZ     I

      615     3150    2         CLSDP.V.DISP#=%SAVE#;

   3150  7 002174   000002 236007                    LDQ     2,DL
         7 002175   000454 552004 1                  STBQ    CLSDP+26,'04'O

      616     3151    2         END;

   3151  7 002176   006763 235000 1                  LDA     I
         7 002177   000001 035007                    ADLA    1,DL
         7 002200   006763 755000 1                  STA     I
         7 002201   023420 115007                    CMPA    10000,DL
         7 002202   002174 602000 7                  TNC     s:3150

      617     3152    1      SETX=0;

   3152  7 002203   006764 450000 1                  STZ     SETX

      618     3153    1      CALL M$OPEN(OPNDP)ALTRET(SETERR1);

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:102  
   3153  7 002204   000164 630400 1                  EPPR0   OPNDP
         7 002205   450000 713400                    CLIMB   alt,open
         7 002206   410400 401760                    pmme    nvectors=18
         7 002207   002157 702000 7                  TSX2    SETERR1

      619     3154    1      GOTO SETNEXT;

   3154  7 002210   000061 710000 7                  TRA     SETNEXT

   3152  7 002211                       NOTOK        null
      620     3155    1   NOTOK: ;
      621     3156    1      CALL M$CLOSE(CLSDP) ALTRET(NOTOK1);

   3156  7 002211   000422 630400 1                  EPPR0   CLSDP
         7 002212   450001 713400                    CLIMB   alt,close
         7 002213   406000 401760                    pmme    nvectors=13
         7 002214   002215 702000 7                  TSX2    NOTOK1

   3152  7 002215                       NOTOK1       null
      622     3157    1   NOTOK1: ;
      623     3158    1      CALL WROC(7);

   3158  7 002215   000001 236000 xsym               LDQ     B_VECTNIL+1
         7 002216   200042 756100                    STQ     @PMME+1,,AUTO
         7 002217   000056 236000 8                  LDQ     46
         7 002220   200041 756100                    STQ     SECTS+28,,AUTO
         7 002221   002302 701000 7                  TSX1    WROC
         7 002222   000000 011000                    NOP     0

      624     3159    1      OPNDP.SN_=VECTOR(ERASE);

   3159  7 002223   000002 237000 8                  LDAQ    2
         7 002224   000166 757000 1                  STAQ    OPNDP+2

      625     3160    1      CALL M$WAIT(WAIT20);

   3160  7 002225   000606 630400 1                  EPPR0   WAIT20
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:103  
         7 002226   020006 713400                    CLIMB   8198
         7 002227   400400 401760                    pmme    nvectors=2

      626     3161    1      CALL M$OPEN(OPNDP)ALTRET(NOTOK);

   3161  7 002230   000164 630400 1                  EPPR0   OPNDP
         7 002231   450000 713400                    CLIMB   alt,open
         7 002232   410400 401760                    pmme    nvectors=18
         7 002233   002211 702000 7                  TSX2    NOTOK

      627     3162    1      SETX=0;

   3162  7 002234   006764 450000 1                  STZ     SETX

      628     3163    1      GOTO SETNEXT;

   3163  7 002235   000061 710000 7                  TRA     SETNEXT

      629     3164    1   CLSEIERR:
      630     3165    1      CALL WROC(1,0);

   3165  7 002236   000047 236000 8     CLSEIERR     LDQ     39
         7 002237   200042 756100                    STQ     @PMME+1,,AUTO
         7 002240   000057 236000 8                  LDQ     47
         7 002241   200041 756100                    STQ     SECTS+28,,AUTO
         7 002242   002302 701000 7                  TSX1    WROC
         7 002243   000000 011000                    NOP     0

      631     3166    1      GOTO NXTPHASE3;

   3166  7 002244   002042 710000 7                  TRA     NXTPHASE3

      632     3167    1   CLSEOERR:
      633     3168    1      CALL WROC(1,1);

   3168  7 002245   000057 236000 8     CLSEOERR     LDQ     47
         7 002246   200042 756100                    STQ     @PMME+1,,AUTO
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:104  
         7 002247   200041 756100                    STQ     SECTS+28,,AUTO
         7 002250   002302 701000 7                  TSX1    WROC
         7 002251   000000 011000                    NOP     0

      634     3169    1      GOTO NXTPHASE2;

   3169  7 002252   002030 710000 7                  TRA     NXTPHASE2

      635     3170    1   IOERR:
      636     3171    1      CALL WROC(3,1);

   3171  7 002253   000057 236000 8     IOERR        LDQ     47
         7 002254   200042 756100                    STQ     @PMME+1,,AUTO
         7 002255   000055 236000 8                  LDQ     45
         7 002256   200041 756100                    STQ     SECTS+28,,AUTO
         7 002257   002302 701000 7                  TSX1    WROC
         7 002260   000000 011000                    NOP     0

      637     3172    1      CALL M$CLOSE(CLSEI);

   3172  7 002261   000326 630400 1                  EPPR0   CLSEI
         7 002262   050001 713400                    CLIMB   close
         7 002263   406000 401760                    pmme    nvectors=13

      638     3173    1      CALL M$CLOSE(CLSEOREL);

   3173  7 002264   000364 630400 1                  EPPR0   CLSEOREL
         7 002265   050001 713400                    CLIMB   close
         7 002266   406000 401760                    pmme    nvectors=13

      639     3174    1      GOTO NXTPHASE3;

   3174  7 002267   002042 710000 7                  TRA     NXTPHASE3

      640     3175    1   OUTERR:
      641     3176    1      CALL WROC(0,1);

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:105  
   3176  7 002270   000057 236000 8     OUTERR       LDQ     47
         7 002271   200042 756100                    STQ     @PMME+1,,AUTO
         7 002272   000047 236000 8                  LDQ     39
         7 002273   200041 756100                    STQ     SECTS+28,,AUTO
         7 002274   002302 701000 7                  TSX1    WROC
         7 002275   000000 011000                    NOP     0

      642     3177    1      CALL M$CLOSE(CLSEI);

   3177  7 002276   000326 630400 1                  EPPR0   CLSEI
         7 002277   050001 713400                    CLIMB   close
         7 002300   406000 401760                    pmme    nvectors=13

      643     3178    1      GOTO NXTPHASE3;

   3178  7 002301   002042 710000 7                  TRA     NXTPHASE3

      644     3179        %EJECT;
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:106  
      645     3180        /**/
      646     3181        /**/
      647     3182        /**/
      648     3183    1   WROC: PROC(PMME,ASN)ALTRET;

   3183  7 002302   200040 741300       WROC         STX1  ! SECTS+27,,AUTO

      649     3184    2   DCL PMME UBIN;
      650     3185    2   DCL ASN UBIN;
      651     3186    2   DCL TEMP_INT SBIN WORD;
      652     3187        /**/
      653     3188    2   DCL DCB$ PTR;
      654     3189    2   DCL I UBIN;
      655     3190        %FPT_ERRMSG(BUF=FIT_BUF,CODE=ERR,FPTN=EFPT);
      656     3217    2   DCL CHAR1200 BASED CHAR(1200);
      657     3218    2   DCL EBUF BASED(FPT_TEMPWROC.BUFW_.BUFW$)CHAR(120);
      658     3219    2   DCL 1 MSG1 STATIC,
      659     3220    2         2 * CHAR(0) INIT('ERROR '),
      660     3221    2         2 F(0:2) CHAR(1),
      661     3222    2         2 * CHAR(0) INIT('-'),
      662     3223    2         2 D CHAR(5),
      663     3224    2         2 B CHAR(0) INIT(' '),
      664     3225    2         2 P CHAR(4),
      665     3226    2         2 * CHAR(0) INIT('ING '),
      666     3227    2         2 A CHAR(4);
      667     3228    2   DCL MSG2 CONSTANT CHAR(0) INIT(', FILE=');
      668     3229    2   DCL MSG3 CONSTANT BIT(18) INIT('015012'O);
      669     3230    2   DCL MSG3C REDEF MSG3 CHAR(2);
      670     3231    2   DCL MSG8 CONSTANT CHAR(0)INIT('INITIALIZATION ABORTED');
      671     3232    2   DCL P(0:4) CONSTANT CHAR(4) INIT('OPEN','CLOS','READ','WRIT','INIT');
      672     3233    2   DCL A(0:3) CONSTANT CHAR(4) INIT('TAPE','DISK','PACK','SET');
      673     3234    2   DCL MSG4 CONSTANT CHAR(0) INIT('VSN=');
      674     3235    2   DCL MSG7 CONSTANT CHAR(0)INIT('AS YOU WISH . . . PLEASE MOUNT SOMETHING ELSE');
      675     3236    2   DCL 1 WMSG CONSTANT,
      676     3237    2         2 * BIT(18) INIT('015012'O),
      677     3238    2         2 * CHAR(0) INIT('OK TO PROCEED (Y/N)? ');
      678     3239    2   DCL DELMSG1 CONSTANT CHAR(0) INIT('DP#SYS HAS ONLY ');
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:107  
      679     3240    2   DCL 1 DELMSG2 CONSTANT,
      680     3241    2         2 * CHAR(0) INIT(' FREE GRANULES.'),
      681     3242    2         2 * BIT(18) INIT('015012'O),
      682     3243    2         2 * CHAR(0) INIT('ENTER ACCOUNT NAME TO REVIEW: ');
      683     3244    2   DCL DELMSG3 CONSTANT CHAR(0) INIT('FILENAME .. GRANULES:(D-ELETE/Q-UIT)');
      684     3245    2   DCL MRRMSG1 CONSTANT CHAR(0)
      685     3246    2    INIT('UNPAIRED MIRROR DISKS DETECTED - LIST FOLLOWS');
      686     3247    2   DCL 1 MRRMSG2 CONSTANT,
      687     3248    2         2 * BIT(18) INIT('015012'O),
      688     3249    2         2 * CHAR(0) INIT('ENTER Y TO TERMINATE MIRROR, N TO SKIP, Q TO GET OUT');
      689     3250    2   DCL 1 MRRMSG3 STATIC,
      690     3251    2         2 * BIT(18) INIT('015012'O),
      691     3252    2         2 * CHAR(0) INIT('DONT MIRROR '),
      692     3253    2         2 DVC CHAR(4),
      693     3254    2         2 * CHAR(0) INIT(' VSN='),
      694     3255    2         2 VSN CHAR(0) INIT('123456789012 (Y/N/Q)?');
      695     3256    2   DCL INMSG CHAR(12) STATIC;
      696     3257    2   DCL 1 MSGW1 REDEF INMSG,
      697     3258    2         2 T BIT(27),
      698     3259    2         2 * CHAR(9);
      699     3260    2   DCL 1 MSGW2 REDEF INMSG,
      700     3261    2         2 W1 BIT(36),
      701     3262    2         2 W2 BIT(36),
      702     3263    2         2 W3 BIT(36);
      703     3264    2   DCL 1 MSG9 STATIC,
      704     3265    2         2 * BIT(18)INIT('015012'O),
      705     3266    2         2 * CHAR(0)INIT(
      706     3267    2   'TIMEWARP DETECTED. YOU SAY IT''S '),
      707     3268    2         2 NT CHAR(5),2 * CHAR(2)INIT(', '),
      708     3269    2         2 ND CHAR(3),2 NP CHAR(12),2 NM CHAR(10),
      709     3270    2         2 * BIT(18)INIT('015012'O),
      710     3271    2         2 * CHAR(0)INIT(
      711     3272    2   'CP6 WAS UP AT '),
      712     3273    2         2 PT CHAR(5),2 * CHAR(2)INIT(', '),
      713     3274    2         2 PD CHAR(3),2 PP CHAR(12),2 PM CHAR(10),
      714     3275    2         2 * CHAR(0)INIT('. ? FOR HELP ');
      715     3276    2   DCL PERS(0:3) CONSTANT CHAR(11) INIT(
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:108  
      716     3277    2   ' WEE HOURS,',' MORNING,',' AFTERNOON,',' EVENING,');
      717     3278    2   DCL 1 MSG91 CONSTANT,
      718     3279    2         2 * BIT(18)INIT('015012'O),2 * CHAR(0) INIT(
      719     3280    2   'DID YOU ENTER THE CORRECT TIME AND DATE? IF NOT, YOU MUST REBOOT'),
      720     3281    2         2 * BIT(18)INIT('015012'O),2 * CHAR(0) INIT(
      721     3282    2   'IF CP6 WAS DOWN FOR >9 HOURS THEN TYPE ''YES$'' TO PROCEED.');
      722     3283    2   DCL 1 TERMSG CONSTANT,
      723     3284    2         2 * BIT(18) INIT('015012'O),
      724     3285    2         2 * CHAR(0) INIT('Y TO TRY A NEW TAPE - ELSE SKIP THE FILE?');
      725     3286        %EJECT;
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:109  
      726     3287        %FPT_OPEN (FPTN=DEL1ST, SCRUB=YES, ACCT=INMSG, NXTF=YES, TEST=YES, FUN=IN,
      727     3288                   FPARAM=FIT_BUF, SN=OPNSN, ASN=FILE, DCB=M$EO, STCLASS=CONSTANT);
      728     3397        %FPT_OPEN (FPTN=DELNXT, NXTF=YES, TEST=YES, FPARAM=FIT_BUF, DCB=M$EO,
      729     3398                   STCLASS=CONSTANT);
      730     3507        %FPT_OPEN (FPTN=DELTHIS, DCB=M$EO, DELETE=YES);
      731     3616        %FPT_OPEN(FPTN=TESTERRLOG,STCLASS=CONSTANT,DCB=M$EO,NAME=ERRNAME,ASN=FILE,
      732     3617              ACCT=SYSTAC,SN=OPNSN,NXTF=YES,REV=YES,FUN=IN);
      733     3726        %VLP_NAME(FPTN=ERRNAME,STCLASS=CONSTANT,NAME=':ERRLOGA');
      734     3753        %FPT_PRECORD(FPTN=ERRLOGTIME,STCLASS=CONSTANT,KEY=ERRK,KEYS=YES,N=-1,
      735     3754              KEYR=YES,DCB=M$EO);
      736     3775        %FPT_CLOSE(FPTN=CLOSLOG,STCLASS=CONSTANT,DCB=M$EO);
      737     3817        %FPT_TIME(STCLASS=CONSTANT,TSTAMP=NOWTIME,DATE=MSG9.NM,TIME=INMSG,DAY=MSG9.ND);
      738     3836        %FPT_TIME(STCLASS=CONSTANT,TSTAMP=ERRK,DATE=MSG9.PM,TIME=INMSG,DAY=MSG9.PD,
      739     3837              FPTN=ERRTIME,SOURCE=UTS);
      740     3856        %SUB WINDOW=9;
      741     3857        %FPT_MONINFO(STCLASS=CONSTANT,SITEINFO=FIT_BUF);
      742     3872        %VLR_SITEINFO(STCLASS=BASED);
      743     3891    2   DCL NOWTIME UBIN STATIC;
      744     3892    2   DCL 1 ERRK STATIC,
      745     3893    2         2 TIME UBIN INIT(BITBIN('777777777777'O)),
      746     3894    2         2 * CHAR(4);
      747     3895    2   DCL ALPH CONSTANT CHAR(0) INIT(
      748     3896    2         '?ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789');
      749     3897    2   DCL ALPHA(0:36) REDEF ALPH CHAR(1);
      750     3898        %FPT_REM (DISP=REM);
      751     3912        %FPT_TEMPWROC;
      752     3928        /**/
      753     3929    2      ERR=B$ALT.ERR; /* SAVE THE ERROR                                           */

   3929  7 002303   000000 470400 xsym               LDP0    B$TCB$
         7 002304   000000 471500                    LDP1    0,,PR0
         7 002305   100102 236100                    LDQ     66,,PR1
         7 002306   000622 756000 1                  STQ     ERR

      754     3930    2      ERR.SEV=0;

   3930  7 002307   000054 236000 8                  LDQ     44
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:110  
         7 002310   000622 356000 1                  ANSQ    ERR
         7 002311   002313 710000 7                  TRA     s:3932

      755     3931    2   WROC1: ENTRY(PMME,ASN)ALTRET;

   3931  7 002312   200040 741300       WROC1        STX1  ! SECTS+27,,AUTO

      756     3932    2      FPT_TEMPWROC.BUFW_=VECTOR(MSG3);

   3932  7 002313   000060 237000 8                  LDAQ    48
         7 002314   011270 757000 1                  STAQ    FPT_TEMPWROC+2

      757     3933    2      FPT_TEMPWROC.BUFR_=VECTOR(NIL);

   3933  7 002315   000034 237000 8                  LDAQ    28
         7 002316   011272 757000 1                  STAQ    FPT_TEMPWROC+4

      758     3934    2      CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);

   3934  7 002317   011266 630400 1                  EPPR0   FPT_TEMPWROC
         7 002320   510000 713400                    CLIMB   alt,+36864
         7 002321   401000 401760                    pmme    nvectors=3
         7 002322   003670 702000 7                  TSX2    NOWROC

      759     3935    3      IF PMME=11 THEN DO;

   3935  7 002323   200041 470500                    LDP0    @PMME,,AUTO
         7 002324   000000 235100                    LDA     0,,PR0
         7 002325   000013 115007                    CMPA    11,DL
         7 002326   002530 601000 7                  TNZ     s:3976

      760     3936    3         FPT_TEMPWROC.BUFW_=VECTOR(MRRMSG1);

   3936  7 002327   000062 237000 8                  LDAQ    50
         7 002330   011270 757000 1                  STAQ    FPT_TEMPWROC+2

      761     3937    3         CALL M$TEMPWROC (FPT_TEMPWROC) ALTRET(NOWROC);
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:111  

   3937  7 002331   011266 630400 1                  EPPR0   FPT_TEMPWROC
         7 002332   510000 713400                    CLIMB   alt,+36864
         7 002333   401000 401760                    pmme    nvectors=3
         7 002334   003670 702000 7                  TSX2    NOWROC

      762     3938    3         FPT_TEMPWROC.BUFW_=VECTOR(MRRMSG2);

   3938  7 002335   000064 237000 8                  LDAQ    52
         7 002336   011270 757000 1                  STAQ    FPT_TEMPWROC+2

      763     3939    3         CALL M$TEMPWROC (FPT_TEMPWROC) ALTRET(NOWROC);

   3939  7 002337   011266 630400 1                  EPPR0   FPT_TEMPWROC
         7 002340   510000 713400                    CLIMB   alt,+36864
         7 002341   401000 401760                    pmme    nvectors=3
         7 002342   003670 702000 7                  TSX2    NOWROC

      764     3940    3         FPT_TEMPWROC.BUFR_=VECTOR(INMSG);

   3940  7 002343   000066 237000 8                  LDAQ    54
         7 002344   011272 757000 1                  STAQ    FPT_TEMPWROC+4

      765     3941    4         DO I=0 TO MRRCNT-1;

   3941  7 002345   200045 450100                    STZ     I,,AUTO
         7 002346   002500 710000 7                  TRA     s:3966+3

      766     3942    4            FPT_TEMPWROC.BUFW_=VECTOR(MRRMSG3);

   3942  7 002347   000070 237000 8                  LDAQ    56
         7 002350   011270 757000 1                  STAQ    FPT_TEMPWROC+2

      767     3943    4            MRRMSG3.DVC=FIT_BUF.MRR.DVC(I);

   3943  7 002351   200045 235100                    LDA     I,,AUTO
         7 002352   000002 735000                    ALS     2
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:112  
         7 002353   040000 100405                    MLR     fill='040'O
         7 002354   002662 000004 1                  ADSC9   FIT_BUF+1024,A           cn=0,n=4
         7 002355   011110 400004 1                  ADSC9   MRRMSG3+3                cn=2,n=4

      768     3944    4            CALL BINCHAR(SUBSTR(MRRMSG3.VSN,0,12),FIT_BUF.MRR.VSN(I));

   3944  7 002356   200045 720100                    LXL0    I,,AUTO
         7 002357   004662 235010 1                  LDA     FIT_BUF+2048,X0
         7 002360   000044 773000                    LRL     36
         7 002361   200046 757100                    STAQ    I+1,,AUTO
         7 002362   000000 301500                    BTD
         7 002363   200046 000010                    NDSC9   I+1,,AUTO                cn=0,s=lsgnf,sf=0,n=8
         7 002364   011112 630014 1                  NDSC9   MRRMSG3+5                cn=3,s=nosgn,sf=0,n=12

      769     3945    5            DO WHILE SUBSTR(MRRMSG3.VSN,0,1)='0';

   3945  7 002365   002400 710000 7                  TRA     s:3948

      770     3946    5               MRRMSG3.VSN=SUBSTR(MRRMSG3.VSN,1);

   3946  7 002366   040000 100400                    MLR     fill='040'O
         7 002367   011113 000024 1                  ADSC9   MRRMSG3+6                cn=0,n=20
         7 002370   011112 600025 1                  ADSC9   MRRMSG3+5                cn=3,n=21

      771     3947    5               FPT_TEMPWROC.BUFW_.BOUND=FPT_TEMPWROC.BUFW_.BOUND-1;

   3947  7 002371   011270 236000 1                  LDQ     FPT_TEMPWROC+2
         7 002372   000020 772000                    QRL     16
         7 002373   000001 136007                    SBLQ    1,DL
         7 002374   000020 736000                    QLS     16
         7 002375   011270 676000 1                  ERQ     FPT_TEMPWROC+2
         7 002376   000034 376000 xsym               ANQ     B_VECTNIL+28
         7 002377   011270 656000 1                  ERSQ    FPT_TEMPWROC+2

      772     3948    5               END;

   3948  7 002400   011112 236000 1                  LDQ     MRRMSG3+5
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:113  
         7 002401   000777 376007                    ANQ     511,DL
         7 002402   000060 116007                    CMPQ    48,DL
         7 002403   002366 600000 7                  TZE     s:3946

      773     3949    4            IF FIT_BUF.MRR.VSN(I)=CP6VSN AND SETX=0 THEN INMSG='Y';

   3949  7 002404   200045 720100                    LXL0    I,,AUTO
         7 002405   004662 236010 1                  LDQ     FIT_BUF+2048,X0
         7 002406   000614 116000 1                  CMPQ    CP6VSN
         7 002407   002416 601000 7                  TNZ     s:3950
         7 002410   006764 235000 1                  LDA     SETX
         7 002411   002416 601000 7                  TNZ     s:3950

   3949  7 002412   040000 100400                    MLR     fill='040'O
         7 002413   000072 000001 8                  ADSC9   58                       cn=0,n=1
         7 002414   011120 000014 1                  ADSC9   INMSG                    cn=0,n=12
         7 002415   002421 710000 7                  TRA     s:3951

      774     3950    4            ELSE INMSG=' ';

   3950  7 002416   040000 100400                    MLR     fill='040'O
         7 002417   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         7 002420   011120 000014 1                  ADSC9   INMSG                    cn=0,n=12

      775     3951    4            CALL M$TEMPWROC (FPT_TEMPWROC) ALTRET(NOWROC);

   3951  7 002421   011266 630400 1                  EPPR0   FPT_TEMPWROC
         7 002422   510000 713400                    CLIMB   alt,+36864
         7 002423   401000 401760                    pmme    nvectors=3
         7 002424   003670 702000 7                  TSX2    NOWROC

      776     3952    4            IF (MSGW1.T&'737'O)=(ASCBIT('Q')) THEN EXIT;

   3952  7 002425   011120 236000 1                  LDQ     INMSG
         7 002426   000073 376000 8                  ANQ     59
         7 002427   737000 376003                    ANQ     -16896,DU
         7 002430   121000 116003                    CMPQ    41472,DU
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:114  
         7 002431   002504 600000 7                  TZE     s:3967

      777     3953    5            IF (MSGW1.T&'737'O)=(ASCBIT('Y')) THEN DO;

   3953  7 002432   011120 236000 1                  LDQ     INMSG
         7 002433   000073 376000 8                  ANQ     59
         7 002434   737000 376003                    ANQ     -16896,DU
         7 002435   131000 116003                    CMPQ    45568,DU
         7 002436   002475 601000 7                  TNZ     s:3966

      778     3954    5               VSNSN.VSN=FIT_BUF.MRR.VSN(I);

   3954  7 002437   200045 720100                    LXL0    I,,AUTO
         7 002440   004662 235010 1                  LDA     FIT_BUF+2048,X0
         7 002441   000617 755000 1                  STA     VSNSN+1

      779     3955    6               CALL M$OPEN (OPNDP) WHENRETURN DO;

   3955  7 002442   000164 630400 1                  EPPR0   OPNDP
         7 002443   450000 713400                    CLIMB   alt,open
         7 002444   410400 401760                    pmme    nvectors=18
         7 002445   002466 702000 7                  TSX2    DPERR

      780     3956    6                  CALL M$READ(RDDP) ALTRET(DPERR);

   3956  7 002446   000554 630400 1                  EPPR0   RDDP
         7 002447   440000 713400                    CLIMB   alt,read
         7 002450   401400 401760                    pmme    nvectors=4
         7 002451   002466 702000 7                  TSX2    DPERR

      781     3957    6                  VIDBUF.MIRROR.C=' ';

   3957  7 002452   000035 235000 xsym               LDA     B_VECTNIL+29
         7 002453   000035 236000 xsym               LDQ     B_VECTNIL+29
         7 002454   007030 757000 1                  STAQ    VIDBUF+34

      782     3958    6                  CALL M$WRITE(RDDP) ALTRET(DPERR);
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:115  

   3958  7 002455   000554 630400 1                  EPPR0   RDDP
         7 002456   440001 713400                    CLIMB   alt,write
         7 002457   401400 401760                    pmme    nvectors=4
         7 002460   002466 702000 7                  TSX2    DPERR

      783     3959    6                  CALL M$CLOSE(CLSDP) ALTRET(DPERR);

   3959  7 002461   000422 630400 1                  EPPR0   CLSDP
         7 002462   450001 713400                    CLIMB   alt,close
         7 002463   406000 401760                    pmme    nvectors=13
         7 002464   002466 702000 7                  TSX2    DPERR

      784     3960    6                  END;

   3960  7 002465   002474 710000 7                  TRA     s:3964

      785     3961    6               WHENALTRETURN DO;

      786     3962    6   DPERR:         IF ENTADDR(FXD$PMME)~=ENTADDR(NIL) THEN CALL FXD$PMME;

   3962  7 002466   000000 636000 xent  DPERR        EAQ     FXD$PMME
         7 002467   000002 116000 xsym               CMPQ    B_VECTNIL+2
         7 002470   002474 600000 7                  TZE     s:3964

   3962  7 002471   000002 631400 xsym               EPPR1   B_VECTNIL+2
         7 002472   000000 701000 xent               TSX1    FXD$PMME
         7 002473   000000 011000                    NOP     0

      787     3963    6                  END;

      788     3964    5               FIT_BUF.MRR.VSN(0)=0;

   3964  7 002474   004662 450000 1                  STZ     FIT_BUF+2048

      789     3965    5               END;

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:116  
      790     3966    4            END;

   3966  7 002475   200045 235100                    LDA     I,,AUTO
         7 002476   000001 035007                    ADLA    1,DL
         7 002477   200045 755100                    STA     I,,AUTO
         7 002500   200045 236100                    LDQ     I,,AUTO
         7 002501   002504 604000 7                  TMI     s:3967
         7 002502   006765 116000 1                  CMPQ    MRRCNT
         7 002503   002347 604000 7                  TMI     s:3942

      791     3967    3         MRRCNT=0;

   3967  7 002504   006765 450000 1                  STZ     MRRCNT

      792     3968    3         IF FIT_BUF.MRR.VSN(0)~=0 THEN RETURN;

   3968  7 002505   004662 235000 1                  LDA     FIT_BUF+2048
         7 002506   002511 600000 7                  TZE     s:3969

   3968  7 002507   200040 221300                    LDX1  ! SECTS+27,,AUTO
         7 002510   000001 702211                    TSX2  ! 1,X1

      793     3969    3         OPNDP.SN_=VECTOR(ERASE);

   3969  7 002511   000002 237000 8                  LDAQ    2
         7 002512   000166 757000 1                  STAQ    OPNDP+2

      794     3970    4         CALL M$OPEN (OPNDP) WHENALTRETURN DO;

   3970  7 002513   000164 630400 1                  EPPR0   OPNDP
         7 002514   450000 713400                    CLIMB   alt,open
         7 002515   410400 401760                    pmme    nvectors=18
         7 002516   002520 702000 7                  TSX2    s:3971
         7 002517   002526 710000 7                  TRA     s:3973

      795     3971    4            IF ENTADDR(FXD$PMME)~=ENTADDR(NIL) THEN CALL FXD$PMME;

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:117  
   3971  7 002520   000000 636000 xent               EAQ     FXD$PMME
         7 002521   000002 116000 xsym               CMPQ    B_VECTNIL+2
         7 002522   002526 600000 7                  TZE     s:3973

   3971  7 002523   000002 631400 xsym               EPPR1   B_VECTNIL+2
         7 002524   000000 701000 xent               TSX1    FXD$PMME
         7 002525   000000 011000                    NOP     0

      796     3972    4            END;

      797     3973    3         ALTRETURN;

   3973  7 002526   200040 221300                    LDX1  ! SECTS+27,,AUTO
         7 002527   000000 702211                    TSX2  ! 0,X1

      798     3974    3         END;
      799     3975        /**/
      800     3976    3      IF PMME=10 THEN DO;

   3976  7 002530   000012 115007                    CMPA    10,DL
         7 002531   002710 601000 7                  TNZ     s:4016

      801     3977    3         FPT_TEMPWROC.BUFW_=VECTOR(DELMSG3);

   3977  7 002532   000074 237000 8                  LDAQ    60
         7 002533   011270 757000 1                  STAQ    FPT_TEMPWROC+2

      802     3978    3         CALL M$TEMPWROC (FPT_TEMPWROC) ALTRET(NOWROC);

   3978  7 002534   011266 630400 1                  EPPR0   FPT_TEMPWROC
         7 002535   510000 713400                    CLIMB   alt,+36864
         7 002536   401000 401760                    pmme    nvectors=3
         7 002537   003670 702000 7                  TSX2    NOWROC

      803     3979    4   OP1:  CALL M$OPEN (DEL1ST) WHENALTRETURN DO;

   3979  7 002540   000444 630400 2     OP1          EPPR0   DEL1ST
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:118  
         7 002541   450000 713400                    CLIMB   alt,open
         7 002542   410400 401760                    pmme    nvectors=18
         7 002543   002545 702000 7                  TSX2    s:3980
         7 002544   002574 710000 7                  TRA     s:3990

      804     3980    4            I=BITBIN(MSGW2.W1&'140140140140'O);

   3980  7 002545   011120 236000 1                  LDQ     INMSG
         7 002546   001076 376000 2                  ANQ     ALPH+28
         7 002547   200045 756100                    STQ     I,,AUTO

      805     3981    4            MSGW2.W3=BINBIT(I,36)&BINBIT(I/2,36);

   3981  7 002550   000001 772000                    QRL     1
         7 002551   200045 376100                    ANQ     I,,AUTO
         7 002552   011122 756000 1                  STQ     INMSG+2

      806     3982    4            MSGW2.W1=MSGW2.W1\MSGW2.W3;

   3982  7 002553   011120 676000 1                  ERQ     INMSG
         7 002554   011120 756000 1                  STQ     INMSG

      807     3983    4            I=BITBIN(MSGW2.W2&'140140140140'O);

   3983  7 002555   011121 236000 1                  LDQ     INMSG+1
         7 002556   001076 376000 2                  ANQ     ALPH+28
         7 002557   200045 756100                    STQ     I,,AUTO

      808     3984    4            I=BITBIN(BINBIT(I,36)&BINBIT(I/2,36));

   3984  7 002560   000001 772000                    QRL     1
         7 002561   200045 376100                    ANQ     I,,AUTO
         7 002562   200045 756100                    STQ     I,,AUTO

      809     3985    4            IF I=0 AND MSGW2.W3='0'B

   3985  7 002563   002570 601000 7                  TNZ     s:3987
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:119  
         7 002564   011122 235000 1                  LDA     INMSG+2
         7 002565   002570 601000 7                  TNZ     s:3987

      810     3986    4            THEN RETURN;

   3986  7 002566   200040 221300                    LDX1  ! SECTS+27,,AUTO
         7 002567   000001 702211                    TSX2  ! 1,X1

      811     3987    4            MSGW2.W2=MSGW2.W2&BINBIT(I,36);

   3987  7 002570   200045 236100                    LDQ     I,,AUTO
         7 002571   011121 376000 1                  ANQ     INMSG+1
         7 002572   011121 756000 1                  STQ     INMSG+1

      812     3988    4            GOTO OP1;

   3988  7 002573   002540 710000 7                  TRA     OP1

      813     3989    4            END;
      814     3990    3         FPT_TEMPWROC.BUFR_=VECTOR(INMSG);

   3990  7 002574   000066 237000 8                  LDAQ    54
         7 002575   011272 757000 1                  STAQ    FPT_TEMPWROC+4

      815     3991    3         FPT_TEMPWROC.BUFW_.BUFW$=ADDR(FIT_BUF);

   3991  7 002576   000043 236000 8                  LDQ     35
         7 002577   011271 756000 1                  STQ     FPT_TEMPWROC+3

      816     3992    3         DCB$=DCBADDR(DCBNUM(M$EO));

   3992  7 002600   000000 236007 xsym               LDQ     M$EO,DL
         7 002601   000000 470400 8                  LDP0    0
         7 002602   000000 471500                    LDP1    0,,PR0
         7 002603   100000 236106                    LDQ     0,QL,PR1
         7 002604   200044 756100                    STQ     DCB$,,AUTO

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:120  
   3992  7 002605                       NXTFILE      null
      817     3993    3   NXTFILE:;
      818     3994    4         IF DCB$->F$DCB.IXTNSIZE>99 THEN DO;

   3994  7 002605   200044 470500                    LDP0    DCB$,,AUTO
         7 002606   000041 235100                    LDA     33,,PR0
         7 002607   000143 115007                    CMPA    99,DL
         7 002610   002701 604400 7                  TMOZ    s:4010

      819     3995    4            SUBSTR(EBUF,0,2)=%CONCAT(BITASC('015'O),BITASC('012'O));

   3995  7 002611   011271 471400 1                  LDP1    FPT_TEMPWROC+3
         7 002612   040100 100400                    MLR     fill='040'O
         7 002613   001077 000002 2                  ADSC9   ALPH+29                  cn=0,n=2
         7 002614   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2

      820     3996    4            I=DCB$->F$DCB.NAME.L;

   3996  7 002615   000010 236100                    LDQ     8,,PR0
         7 002616   000033 772000                    QRL     27
         7 002617   200045 756100                    STQ     I,,AUTO

      821     3997    4            SUBSTR(EBUF,2,I+1)=SUBSTR(DCB$->F$DCB.NAME.C,0,I);

   3997  7 002620   000001 620006                    EAX0    1,QL
         7 002621   000000 621006                    EAX1    0,QL
         7 002622   011271 471400 1                  LDP1    FPT_TEMPWROC+3
         7 002623   040140 100540                    MLR     fill='040'O
         7 002624   000010 200011                    ADSC9   8,,PR0                   cn=1,n=*X1
         7 002625   100000 400010                    ADSC9   0,,PR1                   cn=2,n=*X0

      822     3998    4            CALL BINCHAR (SUBSTR(EBUF,I+3,5),DCB$->F$DCB.IXTNSIZE);

   3998  7 002626   011271 471400 1                  LDP1    FPT_TEMPWROC+3
         7 002627   200045 235100                    LDA     I,,AUTO
         7 002630   000105 301500                    BTD
         7 002631   000041 000004                    NDSC9   33,,PR0                  cn=0,s=lsgnf,sf=0,n=4
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:121  
         7 002632   100000 630005                    NDSC9   0,A,PR1                  cn=3,s=nosgn,sf=0,n=5

      823     3999    4            SUBSTR(EBUF,I+8,3)=' ? ';

   3999  7 002633   011271 471400 1                  LDP1    FPT_TEMPWROC+3
         7 002634   040105 100400                    MLR     fill='040'O
         7 002635   001100 000003 2                  ADSC9   ALPH+30                  cn=0,n=3
         7 002636   100002 000003                    ADSC9   2,A,PR1                  cn=0,n=3

      824     4000    4            FPT_TEMPWROC.BUFW_.BOUND=I+10;

   4000  7 002637   200045 236100                    LDQ     I,,AUTO
         7 002640   000012 036007                    ADLQ    10,DL
         7 002641   000020 736000                    QLS     16
         7 002642   011270 676000 1                  ERQ     FPT_TEMPWROC+2
         7 002643   000034 376000 xsym               ANQ     B_VECTNIL+28
         7 002644   011270 656000 1                  ERSQ    FPT_TEMPWROC+2

      825     4001    4            INMSG=' ';

   4001  7 002645   040000 100400                    MLR     fill='040'O
         7 002646   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         7 002647   011120 000014 1                  ADSC9   INMSG                    cn=0,n=12

      826     4002    4            CALL M$TEMPWROC (FPT_TEMPWROC) ALTRET(NOWROC);

   4002  7 002650   011266 630400 1                  EPPR0   FPT_TEMPWROC
         7 002651   510000 713400                    CLIMB   alt,+36864
         7 002652   401000 401760                    pmme    nvectors=3
         7 002653   003670 702000 7                  TSX2    NOWROC

      827     4003    5            IF (MSGW1.T&'737'O)=ASCBIT('D') THEN DO;

   4003  7 002654   011120 236000 1                  LDQ     INMSG
         7 002655   000073 376000 8                  ANQ     59
         7 002656   737000 376003                    ANQ     -16896,DU
         7 002657   104000 116003                    CMPQ    34816,DU
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:122  
         7 002660   002672 601000 7                  TNZ     s:4008

      828     4004    6               CALL M$OPEN (DELTHIS) WHENRETURN DO;

   4004  7 002661   011164 630400 1                  EPPR0   DELTHIS
         7 002662   450000 713400                    CLIMB   alt,open
         7 002663   410400 401760                    pmme    nvectors=18
         7 002664   002671 702000 7                  TSX2    s:4007

      829     4005    6                  SGRANS=SGRANS+DCB$->F$DCB.IXTNSIZE;

   4005  7 002665   200044 470500                    LDP0    DCB$,,AUTO
         7 002666   000000 236000 xsym               LDQ     SGRANS
         7 002667   000041 036100                    ADLQ    33,,PR0
         7 002670   000000 756000 xsym               STQ     SGRANS

      830     4006    6                  END;

      831     4007    5               END;

   4007  7 002671   002701 710000 7                  TRA     s:4010

      832     4008    4            ELSE IF (MSGW1.T&'737'O)=ASCBIT('Q') THEN RETURN;

   4008  7 002672   011120 236000 1                  LDQ     INMSG
         7 002673   000073 376000 8                  ANQ     59
         7 002674   737000 376003                    ANQ     -16896,DU
         7 002675   121000 116003                    CMPQ    41472,DU
         7 002676   002701 601000 7                  TNZ     s:4010

   4008  7 002677   200040 221300                    LDX1  ! SECTS+27,,AUTO
         7 002700   000001 702211                    TSX2  ! 1,X1

      833     4009    4            END;
      834     4010    4         CALL M$OPEN (DELNXT) WHENRETURN DO;

   4010  7 002701   000536 630400 2                  EPPR0   DELNXT
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:123  
         7 002702   450000 713400                    CLIMB   alt,open
         7 002703   410400 401760                    pmme    nvectors=18
         7 002704   002706 702000 7                  TSX2    s:4013

      835     4011    4            GOTO NXTFILE;

   4011  7 002705   002605 710000 7                  TRA     NXTFILE

      836     4012    4            END;
      837     4013    3         RETURN;

   4013  7 002706   200040 221300                    LDX1  ! SECTS+27,,AUTO
         7 002707   000001 702211                    TSX2  ! 1,X1

      838     4014    3         END;
      839     4015        /**/
      840     4016    3      IF PMME=9 THEN DO;

   4016  7 002710   000011 115007                    CMPA    9,DL
         7 002711   003007 601000 7                  TNZ     s:4037

      841     4017    3         FPT_TEMPWROC.BUFW_=VECTOR(DELMSG1);

   4017  7 002712   000076 237000 8                  LDAQ    62
         7 002713   011270 757000 1                  STAQ    FPT_TEMPWROC+2

      842     4018    3         CALL M$TEMPWROC (FPT_TEMPWROC) ALTRET(NOWROC);

   4018  7 002714   011266 630400 1                  EPPR0   FPT_TEMPWROC
         7 002715   510000 713400                    CLIMB   alt,+36864
         7 002716   401000 401760                    pmme    nvectors=3
         7 002717   003670 702000 7                  TSX2    NOWROC

      843     4019    3         CALL BINCHAR (INMSG, SGRANS);

   4019  7 002720   000000 301400                    BTD
         7 002721   000000 000004 xsym               NDSC9   SGRANS                   cn=0,s=lsgnf,sf=0,n=4
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:124  
         7 002722   011120 030014 1                  NDSC9   INMSG                    cn=0,s=nosgn,sf=0,n=12

      844     4020    3         I=0;

   4020  7 002723   200045 450100                    STZ     I,,AUTO

      845     4021    4         DO WHILE SUBSTR(INMSG,I,1)='0' AND I<11;

   4021  7 002724   002730 710000 7                  TRA     s:4023

      846     4022    4            I=I+1;

   4022  7 002725   200045 235100                    LDA     I,,AUTO
         7 002726   000001 035007                    ADLA    1,DL
         7 002727   200045 755100                    STA     I,,AUTO

      847     4023    4            END;

   4023  7 002730   200045 235100                    LDA     I,,AUTO
         7 002731   040000 106405                    CMPC    fill='040'O
         7 002732   011120 000001 1                  ADSC9   INMSG,A                  cn=0,n=1
         7 002733   000100 000001 8                  ADSC9   64                       cn=0,n=1
         7 002734   002737 601000 7                  TNZ     s:4024
         7 002735   000013 115007                    CMPA    11,DL
         7 002736   002725 602000 7                  TNC     s:4022

      848     4024    3         FPT_TEMPWROC.BUFW_=VECTOR(SUBSTR(INMSG,I));

   4024  7 002737   000020 735000                    ALS     16
         7 002740   000027 675000 xsym               ERA     B_VECTNIL+23
         7 002741   000101 035000 8                  ADLA    65
         7 002742   200045 236100                    LDQ     I,,AUTO
         7 002743   000020 736000                    QLS     16
         7 002744   000067 036000 8                  ADLQ    55
         7 002745   011270 757000 1                  STAQ    FPT_TEMPWROC+2

      849     4025    3         CALL M$TEMPWROC (FPT_TEMPWROC) ALTRET(NOWROC);
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:125  

   4025  7 002746   011266 630400 1                  EPPR0   FPT_TEMPWROC
         7 002747   510000 713400                    CLIMB   alt,+36864
         7 002750   401000 401760                    pmme    nvectors=3
         7 002751   003670 702000 7                  TSX2    NOWROC

      850     4026    3         FPT_TEMPWROC.BUFW_=VECTOR(DELMSG2);

   4026  7 002752   000102 237000 8                  LDAQ    66
         7 002753   011270 757000 1                  STAQ    FPT_TEMPWROC+2

      851     4027    3         INMSG=' ';

   4027  7 002754   040000 100400                    MLR     fill='040'O
         7 002755   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         7 002756   011120 000014 1                  ADSC9   INMSG                    cn=0,n=12

      852     4028    3         FPT_TEMPWROC.BUFR_=VECTOR(INMSG);

   4028  7 002757   000066 237000 8                  LDAQ    54
         7 002760   011272 757000 1                  STAQ    FPT_TEMPWROC+4

      853     4029    3         FPT_TEMPWROC.V.TYC='1'B;

   4029  7 002761   400000 236003                    LDQ     -131072,DU
         7 002762   011275 756000 1                  STQ     FPT_TEMPWROC+7

      854     4030    4         DO WHILE FPT_TEMPWROC.V.TYC;

   4030  7 002763   002774 600000 7                  TZE     s:4034

      855     4031    4            CALL M$TEMPWROC (FPT_TEMPWROC) ALTRET(NOWROC);

   4031  7 002764   011266 630400 1                  EPPR0   FPT_TEMPWROC
         7 002765   510000 713400                    CLIMB   alt,+36864
         7 002766   401000 401760                    pmme    nvectors=3
         7 002767   003670 702000 7                  TSX2    NOWROC
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:126  

      856     4032    4            FPT_TEMPWROC.BUFW_=VECTOR(NIL);

   4032  7 002770   000034 237000 8                  LDAQ    28
         7 002771   011270 757000 1                  STAQ    FPT_TEMPWROC+2

      857     4033    4            END;

   4033  7 002772   011275 235000 1                  LDA     FPT_TEMPWROC+7
         7 002773   002764 601000 7                  TNZ     s:4031

      858     4034    3         IF INMSG=' ' THEN SGRANS=2000;

   4034  7 002774   040000 106400                    CMPC    fill='040'O
         7 002775   011120 000014 1                  ADSC9   INMSG                    cn=0,n=12
         7 002776   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         7 002777   003003 601000 7                  TNZ     s:4035

   4034  7 003000   003720 235007                    LDA     2000,DL
         7 003001   000000 755000 xsym               STA     SGRANS
         7 003002   003005 710000 7                  TRA     s:4035+2

      859     4035    3         ELSE ALTRETURN; RETURN;

   4035  7 003003   200040 221300                    LDX1  ! SECTS+27,,AUTO
         7 003004   000000 702211                    TSX2  ! 0,X1

   4035  7 003005   200040 221300                    LDX1  ! SECTS+27,,AUTO
         7 003006   000001 702211                    TSX2  ! 1,X1

      860     4036    3         END;
      861     4037    3      IF PMME=7 THEN DO;

   4037  7 003007   000007 115007                    CMPA    7,DL
         7 003010   003021 601000 7                  TNZ     s:4042

      862     4038    3         FPT_TEMPWROC.BUFW_=VECTOR(MSG7);
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:127  

   4038  7 003011   000104 237000 8                  LDAQ    68
         7 003012   011270 757000 1                  STAQ    FPT_TEMPWROC+2

      863     4039    3         CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);

   4039  7 003013   011266 630400 1                  EPPR0   FPT_TEMPWROC
         7 003014   510000 713400                    CLIMB   alt,+36864
         7 003015   401000 401760                    pmme    nvectors=3
         7 003016   003670 702000 7                  TSX2    NOWROC

      864     4040    3         RETURN;

   4040  7 003017   200040 221300                    LDX1  ! SECTS+27,,AUTO
         7 003020   000001 702211                    TSX2  ! 1,X1

      865     4041    3         END;
      866     4042    3      IF PMME=6 THEN DO;

   4042  7 003021   000006 115007                    CMPA    6,DL
         7 003022   003261 601000 7                  TNZ     s:4094

      867     4043    3         FPT_TEMPWROC.BUFW_.BUFW$=ADDR(PSMSG);

   4043  7 003023   000106 236000 8                  LDQ     70
         7 003024   011271 756000 1                  STQ     FPT_TEMPWROC+3

      868     4044    3         CALL INDEX(I,'  ',PSMSG.SNS);

   4044  7 003025   000000 120400                    SCD
         7 003026   010774 400062 1                  ADSC9   PSMSG+6                  cn=2,n=50
         7 003027   001063 000002 2                  ADSC9   ALPH+17                  cn=0,n=2
         7 003030   200045 000100                    ARG     I,,AUTO
         7 003031   003033 607000 7                  TTF     s:4045
         7 003032   200045 054100                    AOS     I,,AUTO

      869     4045    3         FPT_TEMPWROC.BUFW_.BOUND=I+SIZEV(PSMSG.H);
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:128  

   4045  7 003033   200045 236100                    LDQ     I,,AUTO
         7 003034   000031 036007                    ADLQ    25,DL
         7 003035   000020 736000                    QLS     16
         7 003036   011270 676000 1                  ERQ     FPT_TEMPWROC+2
         7 003037   000034 376000 xsym               ANQ     B_VECTNIL+28
         7 003040   011270 656000 1                  ERSQ    FPT_TEMPWROC+2

      870     4046    3         CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);

   4046  7 003041   011266 630400 1                  EPPR0   FPT_TEMPWROC
         7 003042   510000 713400                    CLIMB   alt,+36864
         7 003043   401000 401760                    pmme    nvectors=3
         7 003044   003670 702000 7                  TSX2    NOWROC

      871     4047    3         CALL M$MONINFO(FPT_MONINFO);

   4047  7 003045   001026 630400 2                  EPPR0   FPT_MONINFO
         7 003046   020023 713400                    CLIMB   8211
         7 003047   402400 401760                    pmme    nvectors=6

      872     4048    4         IF NOT NEWFILES THEN DO;

   4048  7 003050   000623 234000 1                  SZN     NEWFILES
         7 003051   003226 604000 7                  TMI     s:4083

      873     4049    4            CALL M$OPEN(TESTERRLOG)ALTRET(TIMEOK);

   4049  7 003052   000630 630400 2                  EPPR0   TESTERRLOG
         7 003053   450000 713400                    CLIMB   alt,open
         7 003054   410400 401760                    pmme    nvectors=18
         7 003055   003221 702000 7                  TSX2    TIMEOK

      874     4050    4            CALL M$TIME(FPT_TIME);

   4050  7 003056   000776 630400 2                  EPPR0   FPT_TIME
         7 003057   020004 713400                    CLIMB   8196
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:129  
         7 003060   402000 401760                    pmme    nvectors=5

      875     4051    4            CALL M$PRECORD(ERRLOGTIME)ALTRET(TIMEOK);

   4051  7 003061   000726 630400 2                  EPPR0   ERRLOGTIME
         7 003062   440003 713400                    CLIMB   alt,+16387
         7 003063   401000 401760                    pmme    nvectors=3
         7 003064   003221 702000 7                  TSX2    TIMEOK

      876     4052    5            IF NOWTIME> ERRK.TIME THEN DO;

   4052  7 003065   011257 236000 1                  LDQ     ERRK
         7 003066   011256 116000 1                  CMPQ    NOWTIME
         7 003067   003105 603000 7                  TRC     s:4056

      877     4053    5               CALL XUD$UTS_DIFF_SEC(TEMP_INT,NOWTIME,ERRK.TIME);

   4053  7 003070   000107 236000 8                  LDQ     71
         7 003071   200050 756100                    STQ     I+3,,AUTO
         7 003072   000110 236000 8                  LDQ     72
         7 003073   200047 756100                    STQ     I+2,,AUTO
         7 003074   200043 630500                    EPPR0   TEMP_INT,,AUTO
         7 003075   200046 450500                    STP0    I+1,,AUTO
         7 003076   200046 630500                    EPPR0   I+1,,AUTO
         7 003077   000021 631400 xsym               EPPR1   B_VECTNIL+17
         7 003100   000000 701000 xent               TSX1    XUD$UTS_DIFF_SEC
         7 003101   000000 011000                    NOP     0

      878     4054    5               IF TEMP_INT < WINDOW*3600 THEN GOTO TIMEOK;

   4054  7 003102   200043 235100                    LDA     TEMP_INT,,AUTO
         7 003103   077220 115007                    CMPA    32400,DL
         7 003104   003221 604000 7                  TMI     TIMEOK

      879     4055    5               END;

      880     4056    4            MSG9.NT=INMSG;
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:130  

   4056  7 003105   040000 100400                    MLR     fill='040'O
         7 003106   011120 000005 1                  ADSC9   INMSG                    cn=0,n=5
         7 003107   011133 400005 1                  ADSC9   MSG9+8                   cn=2,n=5

      881     4057    4            CALL CHARBIN(I,SUBSTR(INMSG,0,2));

   4057  7 003110   000100 305400                    DTB
         7 003111   011120 030002 1                  NDSC9   INMSG                    cn=0,s=nosgn,sf=0,n=2
         7 003112   200046 000010                    NDSC9   I+1,,AUTO                cn=0,s=lsgnf,sf=0,n=8
         7 003113   200047 235100                    LDA     I+2,,AUTO
         7 003114   200045 755100                    STA     I,,AUTO

      882     4058    4            MSG9.NP=PERS(I/6);

   4058  7 003115   200045 236100                    LDQ     I,,AUTO
         7 003116   000001 772000                    QRL     1
         7 003117   000003 506007                    DIV     3,DL
         7 003120   000013 402007                    MPY     11,DL
         7 003121   040000 100406                    MLR     fill='040'O
         7 003122   000355 000013 2                  ADSC9   PERS,Q                   cn=0,n=11
         7 003123   011136 000014 1                  ADSC9   MSG9+11                  cn=0,n=12

      883     4059    4            CALL M$TIME(ERRTIME);

   4059  7 003124   001012 630400 2                  EPPR0   ERRTIME
         7 003125   020004 713400                    CLIMB   8196
         7 003126   402000 401760                    pmme    nvectors=5

      884     4060    4            MSG9.PT=INMSG;

   4060  7 003127   040000 100400                    MLR     fill='040'O
         7 003130   011120 000005 1                  ADSC9   INMSG                    cn=0,n=5
         7 003131   011147 400005 1                  ADSC9   MSG9+20                  cn=2,n=5

      885     4061    4            CALL CHARBIN(I,SUBSTR(INMSG,0,2));

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:131  
   4061  7 003132   000100 305400                    DTB
         7 003133   011120 030002 1                  NDSC9   INMSG                    cn=0,s=nosgn,sf=0,n=2
         7 003134   200046 000010                    NDSC9   I+1,,AUTO                cn=0,s=lsgnf,sf=0,n=8
         7 003135   200047 235100                    LDA     I+2,,AUTO
         7 003136   200045 755100                    STA     I,,AUTO

      886     4062    4            MSG9.PP=PERS(I/6);

   4062  7 003137   200045 236100                    LDQ     I,,AUTO
         7 003140   000001 772000                    QRL     1
         7 003141   000003 506007                    DIV     3,DL
         7 003142   000013 402007                    MPY     11,DL
         7 003143   040000 100406                    MLR     fill='040'O
         7 003144   000355 000013 2                  ADSC9   PERS,Q                   cn=0,n=11
         7 003145   011152 000014 1                  ADSC9   MSG9+23                  cn=0,n=12

      887     4063    4            FPT_TEMPWROC.BUFW_=VECTOR(MSG9);

   4063  7 003146   000112 237000 8                  LDAQ    74
         7 003147   011270 757000 1                  STAQ    FPT_TEMPWROC+2

      888     4064    4            FPT_TEMPWROC.BUFR_=VECTOR(INMSG);

   4064  7 003150   000066 237000 8                  LDAQ    54
         7 003151   011272 757000 1                  STAQ    FPT_TEMPWROC+4

   4064  7 003152                       TIMEAGIN     null
      889     4065    4   TIMEAGIN: ;
      890     4066    4            INMSG='0';

   4066  7 003152   040000 100400                    MLR     fill='040'O
         7 003153   000100 000001 8                  ADSC9   64                       cn=0,n=1
         7 003154   011120 000014 1                  ADSC9   INMSG                    cn=0,n=12

      891     4067    4            FPT_TEMPWROC.V.TYC='1'B;

   4067  7 003155   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:132  
         7 003156   011275 756000 1                  STQ     FPT_TEMPWROC+7

      892     4068    5            DO WHILE(FPT_TEMPWROC.V.TYC);

   4068  7 003157   003177 600000 7                  TZE     s:4076

      893     4069    5               CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);

   4069  7 003160   011266 630400 1                  EPPR0   FPT_TEMPWROC
         7 003161   510000 713400                    CLIMB   alt,+36864
         7 003162   401000 401760                    pmme    nvectors=3
         7 003163   003670 702000 7                  TSX2    NOWROC

      894     4070    6               IF INMSG='?' THEN DO;

   4070  7 003164   040000 106400                    CMPC    fill='040'O
         7 003165   011120 000014 1                  ADSC9   INMSG                    cn=0,n=12
         7 003166   000114 000001 8                  ADSC9   76                       cn=0,n=1
         7 003167   003173 601000 7                  TNZ     s:4074

      895     4071    6                  FPT_TEMPWROC.BUFW_=VECTOR(MSG91);

   4071  7 003170   000116 237000 8                  LDAQ    78
         7 003171   011270 757000 1                  STAQ    FPT_TEMPWROC+2

      896     4072    6                  GOTO TIMEAGIN;

   4072  7 003172   003152 710000 7                  TRA     TIMEAGIN

      897     4073    6                  END;
      898     4074    5               FPT_TEMPWROC.BUFW_=VECTOR(NIL);

   4074  7 003173   000034 237000 8                  LDAQ    28
         7 003174   011270 757000 1                  STAQ    FPT_TEMPWROC+2

      899     4075    5               END;

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:133  
   4075  7 003175   011275 235000 1                  LDA     FPT_TEMPWROC+7
         7 003176   003160 601000 7                  TNZ     s:4069

      900     4076    4            MSGW1.T=MSGW1.T&'737737737'O; /* CONVERT TO U.C.                     */

   4076  7 003177   011120 236000 1                  LDQ     INMSG
         7 003200   000073 376000 8                  ANQ     59
         7 003201   001101 376000 2                  ANQ     ALPH+31
         7 003202   011120 552070 1                  STBQ    INMSG,'70'O

      901     4077    4            IF INMSG~='YES$' THEN CALL INDEX(I,'LADC L66C',

   4077  7 003203   040000 106400                    CMPC    fill='040'O
         7 003204   011120 000014 1                  ADSC9   INMSG                    cn=0,n=12
         7 003205   001102 000004 2                  ADSC9   ALPH+32                  cn=0,n=4
         7 003206   003221 600000 7                  TZE     TIMEOK

   4077  7 003207   200045 631500                    EPPR1   I,,AUTO
         7 003210   001103 633400 2                  EPPR3   ALPH+33
         7 003211   000011 223003                    LDX3    9,DU
         7 003212   000663 630400 1                  EPPR0   FIT_BUF+1
         7 003213   000001 220003                    LDX0    1,DU
         7 003214   000000 500510                    A9BD    0,X0,PR0
         7 003215   000167 220003                    LDX0    119,DU
         7 003216   000000 236003                    LDQ     0,DU
         7 003217   000000 701000 xent               TSX1    X66_INDEX
         7 003220   003265 710000 7                  TRA     ABORT

      902     4078    4              ADDR(FIT_BUF)->VLR_SITEINFO.SITE_NAME#.C)
      903     4079    4              ALTRET(ABORT);
      904     4080    4   TIMEOK:  CALL M$CLOSE(CLOSLOG);

   4080  7 003221   000740 630400 2     TIMEOK       EPPR0   CLOSLOG
         7 003222   050001 713400                    CLIMB   close
         7 003223   406000 401760                    pmme    nvectors=13

      905     4081    4            RETURN;
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:134  

   4081  7 003224   200040 221300                    LDX1  ! SECTS+27,,AUTO
         7 003225   000001 702211                    TSX2  ! 1,X1

      906     4082    4            END;
      907     4083    3         FPT_TEMPWROC.BUFW_=VECTOR(WMSG);

   4083  7 003226   000120 237000 8                  LDAQ    80
         7 003227   011270 757000 1                  STAQ    FPT_TEMPWROC+2

      908     4084    3         FPT_TEMPWROC.BUFR_=VECTOR(INMSG);

   4084  7 003230   000066 237000 8                  LDAQ    54
         7 003231   011272 757000 1                  STAQ    FPT_TEMPWROC+4

      909     4085    3         INMSG='Y';

   4085  7 003232   040000 100400                    MLR     fill='040'O
         7 003233   000072 000001 8                  ADSC9   58                       cn=0,n=1
         7 003234   011120 000014 1                  ADSC9   INMSG                    cn=0,n=12

      910     4086    3         FPT_TEMPWROC.V.TYC='1'B;

   4086  7 003235   400000 236003                    LDQ     -131072,DU
         7 003236   011275 756000 1                  STQ     FPT_TEMPWROC+7

      911     4087    4         DO WHILE(FPT_TEMPWROC.V.TYC);

   4087  7 003237   003250 600000 7                  TZE     s:4091

      912     4088    4            CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);

   4088  7 003240   011266 630400 1                  EPPR0   FPT_TEMPWROC
         7 003241   510000 713400                    CLIMB   alt,+36864
         7 003242   401000 401760                    pmme    nvectors=3
         7 003243   003670 702000 7                  TSX2    NOWROC

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:135  
      913     4089    4            FPT_TEMPWROC.BUFW_=VECTOR(NIL);

   4089  7 003244   000034 237000 8                  LDAQ    28
         7 003245   011270 757000 1                  STAQ    FPT_TEMPWROC+2

      914     4090    4            END;

   4090  7 003246   011275 235000 1                  LDA     FPT_TEMPWROC+7
         7 003247   003240 601000 7                  TNZ     s:4088

      915     4091    3         IF (MSGW1.T&'737'O)=ASCBIT('Y') THEN RETURN;

   4091  7 003250   011120 236000 1                  LDQ     INMSG
         7 003251   000073 376000 8                  ANQ     59
         7 003252   737000 376003                    ANQ     -16896,DU
         7 003253   131000 116003                    CMPQ    45568,DU
         7 003254   003257 601000 7                  TNZ     s:4092

   4091  7 003255   200040 221300                    LDX1  ! SECTS+27,,AUTO
         7 003256   000001 702211                    TSX2  ! 1,X1

      916     4092    3         ALTRETURN;

   4092  7 003257   200040 221300                    LDX1  ! SECTS+27,,AUTO
         7 003260   000000 702211                    TSX2  ! 0,X1

      917     4093    3         END;
      918     4094    3      IF ERR.SEV=7 THEN DO;

   4094  7 003261   000622 236000 1                  LDQ     ERR
         7 003262   000007 376007                    ANQ     7,DL
         7 003263   000007 116007                    CMPQ    7,DL
         7 003264   003276 601000 7                  TNZ     s:4102

   4092  7 003265                       ABORT        null
      919     4095    3   ABORT: ;
      920     4096    3         FPT_TEMPWROC.BUFW_=VECTOR(MSG8);
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:136  

   4096  7 003265   000122 237000 8                  LDAQ    82
         7 003266   011270 757000 1                  STAQ    FPT_TEMPWROC+2

      921     4097    3         CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);

   4097  7 003267   011266 630400 1                  EPPR0   FPT_TEMPWROC
         7 003270   510000 713400                    CLIMB   alt,+36864
         7 003271   401000 401760                    pmme    nvectors=3
         7 003272   003670 702000 7                  TSX2    NOWROC

      922     4098    4         DO WHILE('1'B);

      923     4099    4            I=1;

   4099  7 003273   000001 235007                    LDA     1,DL
         7 003274   200045 755100                    STA     I,,AUTO

      924     4100    4            END;

   4100  7 003275   003273 710000 7                  TRA     s:4099

      925     4101    3         END;
      926     4102    2      ADDR(FIT_BUF)->CHAR1200=' ';

   4102  7 003276   040000 100400                    MLR     fill='040'O
         7 003277   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         7 003300   000662 002260 1                  ADSC9   FIT_BUF                  cn=0,n=1200

      927     4103    2      IF ASN=0 THEN EFPT.V.DCB#=DCBNUM(M$EI);

   4103  7 003301   200042 471500                    LDP1    @ASN,,AUTO
         7 003302   100000 235100                    LDA     0,,PR1
         7 003303   003310 601000 7                  TNZ     s:4104

   4103  7 003304   000000 236007 xsym               LDQ     M$EI,DL
         7 003305   000000 620006                    EAX0    0,QL
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:137  
         7 003306   011072 740000 1                  STX0    EFPT+22
         7 003307   003321 710000 7                  TRA     s:4106

      928     4104    2      ELSE IF ASN=1 THEN EFPT.V.DCB#=DCBNUM(M$EO);

   4104  7 003310   000001 115007                    CMPA    1,DL
         7 003311   003316 601000 7                  TNZ     s:4105

   4104  7 003312   000000 236007 xsym               LDQ     M$EO,DL
         7 003313   000000 620006                    EAX0    0,QL
         7 003314   011072 740000 1                  STX0    EFPT+22
         7 003315   003321 710000 7                  TRA     s:4106

      929     4105    2      ELSE EFPT.V.DCB#=DCBNUM(M$DP);

   4105  7 003316   000000 236007 xsym               LDQ     M$DP,DL
         7 003317   000000 620006                    EAX0    0,QL
         7 003320   011072 740000 1                  STX0    EFPT+22

      930     4106    2      IF NEWFILES AND CLSDP.V.DISP#=%SAVE# THEN GOTO NOERMSG;

   4106  7 003321   000623 234000 1                  SZN     NEWFILES
         7 003322   003327 605000 7                  TPL     s:4107
         7 003323   000454 236000 1                  LDQ     CLSDP+26
         7 003324   000777 376007                    ANQ     511,DL
         7 003325   000002 116007                    CMPQ    2,DL
         7 003326   003406 600000 7                  TZE     NOERMSG

      931     4107    2      CALL M$ERRMSG(EFPT)ALTRET(NOERMSG);

   4107  7 003327   011044 630400 1                  EPPR0   EFPT
         7 003330   420000 713400                    CLIMB   alt,+8192
         7 003331   405000 401760                    pmme    nvectors=11
         7 003332   003406 702000 7                  TSX2    NOERMSG

      932     4108    2      FPT_TEMPWROC.BUFW_.BUFW$=ADDR(FIT_BUF);

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:138  
   4108  7 003333   000043 236000 8                  LDQ     35
         7 003334   011271 756000 1                  STQ     FPT_TEMPWROC+3

      933     4109    3      DO WHILE(SUBSTR(EBUF,2,118)~=' ');

   4109  7 003335   003400 710000 7                  TRA     s:4120

      934     4110    3         I=119;

   4110  7 003336   000167 235007                    LDA     119,DL
         7 003337   200045 755100                    STA     I,,AUTO

      935     4111    4         DO WHILE(SUBSTR(EBUF,I,1)=' ');

   4111  7 003340   003344 710000 7                  TRA     s:4113

      936     4112    4            I=I-1;

   4112  7 003341   200045 235100                    LDA     I,,AUTO
         7 003342   000001 135007                    SBLA    1,DL
         7 003343   200045 755100                    STA     I,,AUTO

      937     4113    4            END;

   4113  7 003344   011271 470400 1                  LDP0    FPT_TEMPWROC+3
         7 003345   040000 106505                    CMPC    fill='040'O
         7 003346   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         7 003347   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         7 003350   003341 600000 7                  TZE     s:4112

      938     4114    3         FPT_TEMPWROC.BUFW_.BOUND=I;

   4114  7 003351   200045 236100                    LDQ     I,,AUTO
         7 003352   000020 736000                    QLS     16
         7 003353   011270 676000 1                  ERQ     FPT_TEMPWROC+2
         7 003354   000034 376000 xsym               ANQ     B_VECTNIL+28
         7 003355   011270 656000 1                  ERSQ    FPT_TEMPWROC+2
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:139  

      939     4115    3         CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);

   4115  7 003356   011266 630400 1                  EPPR0   FPT_TEMPWROC
         7 003357   510000 713400                    CLIMB   alt,+36864
         7 003360   401000 401760                    pmme    nvectors=3
         7 003361   003670 702000 7                  TSX2    NOWROC

      940     4116    3         FPT_TEMPWROC.BUFW_.BUFW$=PINCRW(FPT_TEMPWROC.BUFW_.BUFW$,30);

   4116  7 003362   011271 236000 1                  LDQ     FPT_TEMPWROC+3
         7 003363   000036 036003                    ADLQ    30,DU
         7 003364   011271 756000 1                  STQ     FPT_TEMPWROC+3

      941     4117    3         IF SUBSTR(EBUF,0,2)~=' '

   4117  7 003365   011271 470400 1                  LDP0    FPT_TEMPWROC+3
         7 003366   040000 106500                    CMPC    fill='040'O
         7 003367   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         7 003370   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         7 003371   003374 600000 7                  TZE     s:4119

      942     4118    3         THEN FPT_TEMPWROC.BUFW_.BUFW$=PINCRC(FPT_TEMPWROC.BUFW_.BUFW$,-2);

   4118  7 003372   000115 036000 8                  ADLQ    77
         7 003373   011271 756000 1                  STQ     FPT_TEMPWROC+3

      943     4119    3         CALL INSERT(EBUF,0,2,MSG3C);

   4119  7 003374   011271 470400 1                  LDP0    FPT_TEMPWROC+3
         7 003375   040100 100400                    MLR     fill='040'O
         7 003376   000227 000002 2                  ADSC9   MSG3                     cn=0,n=2
         7 003377   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2

      944     4120    3         END;

   4120  7 003400   011271 470400 1                  LDP0    FPT_TEMPWROC+3
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:140  
         7 003401   040000 106500                    CMPC    fill='040'O
         7 003402   000000 400166                    ADSC9   0,,PR0                   cn=2,n=118
         7 003403   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         7 003404   003336 601000 7                  TNZ     s:4110

      945     4121    2      GOTO ERMSGOK;

   4121  7 003405   003574 710000 7                  TRA     ERMSGOK

   4119  7 003406                       NOERMSG      null
      946     4122    2   NOERMSG:;
      947     4123    3      DO I=0 TO 2;

   4123  7 003406   200045 450100                    STZ     I,,AUTO

      948     4124    3         MSG1.F(I)=ALPHA(ERR.F(I));

   4124  7 003407   200045 235100                    LDA     I,,AUTO
         7 003410   000100 101405                    MRL     fill='000'O
         7 003411   000622 020001 1                  ADSC6   ERR,A                    cn=0,n=1
         7 003412   200046 020006                    ADSC6   I+1,,AUTO                cn=0,n=6
         7 003413   200046 236100                    LDQ     I+1,,AUTO
         7 003414   040005 100406                    MLR     fill='040'O
         7 003415   001042 000001 2                  ADSC9   ALPH,Q                   cn=0,n=1
         7 003416   011077 400001 1                  ADSC9   MSG1+1,A                 cn=2,n=1

      949     4125    3         END;

   4125  7 003417   000001 035007                    ADLA    1,DL
         7 003420   200045 755100                    STA     I,,AUTO
         7 003421   000003 115007                    CMPA    3,DL
         7 003422   003407 602000 7                  TNC     s:4124

      950     4126    2      CALL BINCHAR(MSG1.D,ERR.CODE);

   4126  7 003423   000622 236000 1                  LDQ     ERR
         7 003424   000003 772000                    QRL     3
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:141  
         7 003425   037777 376007                    ANQ     16383,DL
         7 003426   000000 235003                    LDA     0,DU
         7 003427   200046 757100                    STAQ    I+1,,AUTO
         7 003430   000000 301500                    BTD
         7 003431   200046 000010                    NDSC9   I+1,,AUTO                cn=0,s=lsgnf,sf=0,n=8
         7 003432   011100 430005 1                  NDSC9   MSG1+2                   cn=2,s=nosgn,sf=0,n=5

      951     4127    2      MSG1.P=P(PMME);

   4127  7 003433   200041 470500                    LDP0    @PMME,,AUTO
         7 003434   000000 720100                    LXL0    0,,PR0
         7 003435   000236 236010 2                  LDQ     P,X0
         7 003436   011102 756000 1                  STQ     MSG1+4

      952     4128    2      MSG1.A=A(ASN);

   4128  7 003437   200042 471500                    LDP1    @ASN,,AUTO
         7 003440   100000 720100                    LXL0    0,,PR1
         7 003441   000243 236010 2                  LDQ     A,X0
         7 003442   011104 756000 1                  STQ     MSG1+6

      953     4129    2      FPT_TEMPWROC.BUFW_=VECTOR(MSG1);

   4129  7 003443   000124 237000 8                  LDAQ    84
         7 003444   011270 757000 1                  STAQ    FPT_TEMPWROC+2

      954     4130    2      CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);

   4130  7 003445   011266 630400 1                  EPPR0   FPT_TEMPWROC
         7 003446   510000 713400                    CLIMB   alt,+36864
         7 003447   401000 401760                    pmme    nvectors=3
         7 003450   003670 702000 7                  TSX2    NOWROC

      955     4131    3      IF PMME+ASN~=0 THEN DO;

   4131  7 003451   200041 470500                    LDP0    @PMME,,AUTO
         7 003452   200042 471500                    LDP1    @ASN,,AUTO
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:142  
         7 003453   000000 236100                    LDQ     0,,PR0
         7 003454   100000 036100                    ADLQ    0,,PR1
         7 003455   003574 600000 7                  TZE     ERMSGOK

      956     4132    3         IF ASN=0 THEN

   4132  7 003456   100000 235100                    LDA     0,,PR1
         7 003457   003466 601000 7                  TNZ     s:4135

      957     4133    3         DCB$=DCBADDR(DCBNUM(M$EI));

   4133  7 003460   000000 236007 xsym               LDQ     M$EI,DL
         7 003461   000000 473400 8                  LDP3    0
         7 003462   300000 474500                    LDP4    0,,PR3
         7 003463   400000 236106                    LDQ     0,QL,PR4
         7 003464   200044 756100                    STQ     DCB$,,AUTO
         7 003465   003473 710000 7                  TRA     s:4136

      958     4134    3         ELSE
      959     4135    3         DCB$=DCBADDR(DCBNUM(M$EO));

   4135  7 003466   000000 236007 xsym               LDQ     M$EO,DL
         7 003467   000000 473400 8                  LDP3    0
         7 003470   300000 474500                    LDP4    0,,PR3
         7 003471   400000 236106                    LDQ     0,QL,PR4
         7 003472   200044 756100                    STQ     DCB$,,AUTO

      960     4136    4         IF PMME=4 THEN DO;

   4136  7 003473   000000 235100                    LDA     0,,PR0
         7 003474   000004 115007                    CMPA    4,DL
         7 003475   003514 601000 7                  TNZ     s:4142

      961     4137    4            FPT_TEMPWROC.BUFW_=VECTOR(MSG1.B);

   4137  7 003476   000126 237000 8                  LDAQ    86
         7 003477   011270 757000 1                  STAQ    FPT_TEMPWROC+2
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:143  

      962     4138    4            CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);

   4138  7 003500   011266 630400 1                  EPPR0   FPT_TEMPWROC
         7 003501   510000 713400                    CLIMB   alt,+36864
         7 003502   401000 401760                    pmme    nvectors=3
         7 003503   003670 702000 7                  TSX2    NOWROC

      963     4139    4            FPT_TEMPWROC.BUFW_=VECTOR(JDCB$->F$DCB.PASS);

   4139  7 003504   000022 235000 8                  LDA     18
         7 003505   000000 236000 xsym               LDQ     M$DP$
         7 003506   000022 036003                    ADLQ    18,DU
         7 003507   011270 757000 1                  STAQ    FPT_TEMPWROC+2

      964     4140    4            CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);

   4140  7 003510   011266 630400 1                  EPPR0   FPT_TEMPWROC
         7 003511   510000 713400                    CLIMB   alt,+36864
         7 003512   401000 401760                    pmme    nvectors=3
         7 003513   003670 702000 7                  TSX2    NOWROC

      965     4141    4            END;

      966     4142    4         IF ASN=3 AND SETX~=0 THEN DO;

   4142  7 003514   200042 470500                    LDP0    @ASN,,AUTO
         7 003515   000000 235100                    LDA     0,,PR0
         7 003516   000003 115007                    CMPA    3,DL
         7 003517   003536 601000 7                  TNZ     s:4148
         7 003520   006764 236000 1                  LDQ     SETX
         7 003521   003536 600000 7                  TZE     s:4148

      967     4143    4            FPT_TEMPWROC.BUFW_=VECTOR(MSG4);

   4143  7 003522   000130 237000 8                  LDAQ    88
         7 003523   011270 757000 1                  STAQ    FPT_TEMPWROC+2
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:144  

      968     4144    4            CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);

   4144  7 003524   011266 630400 1                  EPPR0   FPT_TEMPWROC
         7 003525   510000 713400                    CLIMB   alt,+36864
         7 003526   401000 401760                    pmme    nvectors=3
         7 003527   003670 702000 7                  TSX2    NOWROC

      969     4145    4            FPT_TEMPWROC.BUFW_=VECTOR(VIDBUF.PSN);

   4145  7 003530   000132 237000 8                  LDAQ    90
         7 003531   011270 757000 1                  STAQ    FPT_TEMPWROC+2

      970     4146    4            CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);

   4146  7 003532   011266 630400 1                  EPPR0   FPT_TEMPWROC
         7 003533   510000 713400                    CLIMB   alt,+36864
         7 003534   401000 401760                    pmme    nvectors=3
         7 003535   003670 702000 7                  TSX2    NOWROC

      971     4147    4            END;

      972     4148    4         IF DCB$->F$DCB.NAME.C~=' ' AND ASN~=3 THEN DO;

   4148  7 003536   200044 470500                    LDP0    DCB$,,AUTO
         7 003537   040000 106500                    CMPC    fill='040'O
         7 003540   000010 200037                    ADSC9   8,,PR0                   cn=1,n=31
         7 003541   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         7 003542   003574 600000 7                  TZE     ERMSGOK
         7 003543   200042 471500                    LDP1    @ASN,,AUTO
         7 003544   100000 235100                    LDA     0,,PR1
         7 003545   000003 115007                    CMPA    3,DL
         7 003546   003574 600000 7                  TZE     ERMSGOK

      973     4149    4            FPT_TEMPWROC.BUFW_=VECTOR(MSG2);

   4149  7 003547   000134 237000 8                  LDAQ    92
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:145  
         7 003550   011270 757000 1                  STAQ    FPT_TEMPWROC+2

      974     4150    4            CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);

   4150  7 003551   011266 630400 1                  EPPR0   FPT_TEMPWROC
         7 003552   510000 713400                    CLIMB   alt,+36864
         7 003553   401000 401760                    pmme    nvectors=3
         7 003554   003670 702000 7                  TSX2    NOWROC

      975     4151    4            FPT_TEMPWROC.BUFW_.BUFW$=ADDR(DCB$->F$DCB.NAME.C);

   4151  7 003555   200044 236100                    LDQ     DCB$,,AUTO
         7 003556   000136 036000 8                  ADLQ    94
         7 003557   011271 756000 1                  STQ     FPT_TEMPWROC+3

      976     4152    4            FPT_TEMPWROC.BUFW_.BOUND=DCB$->F$DCB.NAME.L-1;

   4152  7 003560   200044 470500                    LDP0    DCB$,,AUTO
         7 003561   000010 236100                    LDQ     8,,PR0
         7 003562   000033 772000                    QRL     27
         7 003563   000001 136007                    SBLQ    1,DL
         7 003564   000020 736000                    QLS     16
         7 003565   011270 676000 1                  ERQ     FPT_TEMPWROC+2
         7 003566   000034 376000 xsym               ANQ     B_VECTNIL+28
         7 003567   011270 656000 1                  ERSQ    FPT_TEMPWROC+2

      977     4153    4            CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);

   4153  7 003570   011266 630400 1                  EPPR0   FPT_TEMPWROC
         7 003571   510000 713400                    CLIMB   alt,+36864
         7 003572   401000 401760                    pmme    nvectors=3
         7 003573   003670 702000 7                  TSX2    NOWROC

      978     4154    4            END;

      979     4155    3         END;

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:146  
   4152  7 003574                       ERMSGOK      null
      980     4156    2   ERMSGOK:;
      981     4157    3      IF ASN=0 THEN DO;

   4157  7 003574   200042 470500                    LDP0    @ASN,,AUTO
         7 003575   000000 235100                    LDA     0,,PR0
         7 003576   003660 601000 7                  TNZ     s:4176

      982     4158    3         FPT_TEMPWROC.BUFW_=VECTOR(TERMSG);

   4158  7 003577   000140 237000 8                  LDAQ    96
         7 003600   011270 757000 1                  STAQ    FPT_TEMPWROC+2

      983     4159    3         FPT_TEMPWROC.BUFR_=VECTOR(INMSG);

   4159  7 003601   000066 237000 8                  LDAQ    54
         7 003602   011272 757000 1                  STAQ    FPT_TEMPWROC+4

      984     4160    3         INMSG='N';

   4160  7 003603   040000 100400                    MLR     fill='040'O
         7 003604   000137 000001 8                  ADSC9   95                       cn=0,n=1
         7 003605   011120 000014 1                  ADSC9   INMSG                    cn=0,n=12

      985     4161    4         DO UNTIL NOT FPT_TEMPWROC.V.TYC;

      986     4162    4            CALL M$TEMPWROC(FPT_TEMPWROC) ALTRET(NOWROC);

   4162  7 003606   011266 630400 1                  EPPR0   FPT_TEMPWROC
         7 003607   510000 713400                    CLIMB   alt,+36864
         7 003610   401000 401760                    pmme    nvectors=3
         7 003611   003670 702000 7                  TSX2    NOWROC

      987     4163    4            FPT_TEMPWROC.BUFW_=VECTOR(NIL);

   4163  7 003612   000034 237000 8                  LDAQ    28
         7 003613   011270 757000 1                  STAQ    FPT_TEMPWROC+2
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:147  

      988     4164    4            END;

   4164  7 003614   011275 235000 1                  LDA     FPT_TEMPWROC+7
         7 003615   003606 601000 7                  TNZ     s:4162

      989     4165    3         IF (MSGW1.T&'737'O)~=ASCBIT('Y') THEN ALTRETURN;

   4165  7 003616   011120 236000 1                  LDQ     INMSG
         7 003617   000073 376000 8                  ANQ     59
         7 003620   737000 376003                    ANQ     -16896,DU
         7 003621   131000 116003                    CMPQ    45568,DU
         7 003622   003625 600000 7                  TZE     s:4166

   4165  7 003623   200040 221300                    LDX1  ! SECTS+27,,AUTO
         7 003624   000000 702211                    TSX2  ! 0,X1

      990     4166    3         CLSEI.V.POS#=%REM#;

   4166  7 003625   002000 236003                    LDQ     1024,DU
         7 003626   000362 552040 1                  STBQ    CLSEI+28,'40'O

      991     4167    3         IF JDCB$->F$DCB.FSECT>1

   4167  7 003627   000000 470400 xsym               LDP0    M$DP$
         7 003630   000077 220100                    LDX0    63,,PR0
         7 003631   000002 100003                    CMPX0   2,DU
         7 003632   003640 602000 7                  TNC     s:4169

      992     4168    3         THEN OPNEI.V.VOL#=JDCB$->F$DCB.VOL-1;

   4168  7 003633   000043 236100                    LDQ     35,,PR0
         7 003634   000033 772000                    QRL     27
         7 003635   000001 136007                    SBLQ    1,DL
         7 003636   000033 736000                    QLS     27
         7 003637   000061 552040 1                  STBQ    OPNEI+49,'40'O

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:148  
      993     4169    4         IF PMME=0 THEN DO;

   4169  7 003640   200041 471500                    LDP1    @PMME,,AUTO
         7 003641   100000 235100                    LDA     0,,PR1
         7 003642   003654 601000 7                  TNZ     s:4173

      994     4170    4            FPT_REM.V.PSN#=VLP_SN.SN#(JDCB$->F$DCB.VOL-1);

   4170  7 003643   000043 236100                    LDQ     35,,PR0
         7 003644   000033 772000                    QRL     27
         7 003645   000006 402007                    MPY     6,DL
         7 003646   040000 100406                    MLR     fill='040'O
         7 003647   000631 400006 1                  ADSC9   VLP_ACCT+2,Q             cn=2,n=6
         7 003650   011264 400006 1                  ADSC9   FPT_REM+2                cn=2,n=6

      995     4171    4            CALL M$REM (FPT_REM);

   4171  7 003651   011262 630400 1                  EPPR0   FPT_REM
         7 003652   060006 713400                    CLIMB   24582
         7 003653   400000 401760                    pmme    nvectors=1

      996     4172    4            END;

      997     4173    3         OPNEI.V.OPER.NXTF#='0'B;

   4173  7 003654   000142 236000 8                  LDQ     98
         7 003655   000044 356000 1                  ANSQ    OPNEI+36

      998     4174    3         ALTRETURN;

   4174  7 003656   200040 221300                    LDX1  ! SECTS+27,,AUTO
         7 003657   000000 702211                    TSX2  ! 0,X1

      999     4175    3         END;
     1000     4176    2      ERR.SEV=ERR.SEV+1;

   4176  7 003660   000622 236000 1                  LDQ     ERR
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:149  
         7 003661   000007 376007                    ANQ     7,DL
         7 003662   000001 036007                    ADLQ    1,DL
         7 003663   000622 676000 1                  ERQ     ERR
         7 003664   000007 376007                    ANQ     7,DL
         7 003665   000622 656000 1                  ERSQ    ERR

     1001     4177    2      RETURN;

   4177  7 003666   200040 221300                    LDX1  ! SECTS+27,,AUTO
         7 003667   000001 702211                    TSX2  ! 1,X1

   4176  7 003670                       NOWROC       null
     1002     4178        /**/
     1003     4179    2   NOWROC:; /* Altret has to mean running in debug mode. Let FXD do it.          */
     1004     4180    2      IF ENTADDR(FXD$PMME)~=ENTADDR(NIL) THEN CALL FXD$PMME;

   4180  7 003670   000000 636000 xent               EAQ     FXD$PMME
         7 003671   000002 116000 xsym               CMPQ    B_VECTNIL+2
         7 003672   003677 600000 7                  TZE     s:4181

   4180  7 003673   000002 631400 xsym               EPPR1   B_VECTNIL+2
         7 003674   000000 701000 xent               TSX1    FXD$PMME
         7 003675   000000 011000                    NOP     0
         7 003676   003701 710000 7                  TRA     s:4182

     1005     4181    2      ELSE CALL M$MERC;

   4181  7 003677   010007 713400                    CLIMB   4103
         7 003700   000000 401760                    pmme    nvectors=0

     1006     4182    2   END WROC;

   4182  7 003701   200040 221300                    LDX1  ! SECTS+27,,AUTO
         7 003702   000001 702211                    TSX2  ! 1,X1
     1007     4183    1   END IGG$GET;

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:150  
--  Include file information  --

   FX$CAT.:E05TOU  is referenced.
   XUD_UTS_M.:E05TOU  is referenced.
   I_SUBS_C.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure IGG$GET.
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:151  

 **** Variables and constants ****

  ****  Section 001  Data  IGG$GET

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   615-0-0/w SBIN        r     1 ADJSYSOK                 422-0-0/d STRC(1080)  r     1 CLSDP
   326-0-0/d STRC(1080)  r     1 CLSEI                    270-0-0/d STRC(1080)  r     1 CLSEO
   364-0-0/d STRC(1080)  r     1 CLSEOREL                 614-0-0/w UBIN        r     1 CP6VSN
 11164-0-0/d STRC(2088)  r     1 DELTHIS                11044-0-0/d STRC(936)   r     1 EFPT
   622-0-0/b STRC        r     1 ERR                    11257-0-0/w STRC(72)    r     1 ERRK
   662-0-0/d STRC)       r     1 FIT_BUF                  460-0-0/d STRC(720)   r     1 FPT_LDEV
 11262-0-0/d STRC(144)   r     1 FPT_REM                11266-0-0/d STRC(288)   r     1 FPT_TEMPWROC
  6762-0-0/w UBIN        r     1 GRANULE                 6763-0-0/w UBIN        r     1 I
   626-0-0/w UBIN        r     1 IGG_RECONUTS           11120-0-0/c CHAR(12)    r     1 INMSG
  6662-0-0/c CHAR(256)   r     1 KEYBUF                  6662-0-0/c STRC(2304)  r     1 KEYBUFB
  6662-0-0/w UBIN        r     1 KEYBUFW(0:63)            264-0-0/c STRC(72)    r     1 MAIL
   266-0-0/c STRC(72)    r     1 MOVE                    6765-0-0/w SBIN        r     1 MRRCNT
 11105-0-0/c STRC(396)   r     1 MRRMSG3                11076-0-0/c STRC(252)   r     1 MSG1
 11123-0-0/c STRC(1143)  r     1 MSG9                   11120-0-0/c STRC(108)   r     1 MSGW1
 11120-0-0/c STRC(108)   r     1 MSGW2                    623-0-0/b BIT         r     1 NEWFILES
 11256-0-0/w UBIN        r     1 NOWTIME                  164-0-0/d STRC(2088)  r     1 OPNDP
     0-0-0/d STRC(2088)  r     1 OPNEI                     72-0-0/d STRC(2088)  r     1 OPNEO
 11014-0-0/w STRC(828)   r     1 PADFIT                   510-0-0/d STRC(360)   r     1 PORES
   504-0-0/d STRC(90)    r     1 POSN                   10766-0-0/c STRC(774)   r     1 PSMSG
   554-0-0/d STRC(504)   r     1 RDDP                     536-0-0/d STRC(504)   r     1 RDT
   624-0-0/b BIT         r     1 RECON                   6764-0-0/w UBIN        r     1 SETX
   256-0-0/c STRC(72)    r     1 SYMI                     260-0-0/c STRC(72)    r     1 SYMO
   625-0-0/b BIT         r     1 SYSFILES                 262-0-0/c STRC(72)    r     1 SYSTAC
  6766-0-0/w STRC(36864) r     1 VIDBUF                  6766-0-0/w UBIN        r     1 VIDBUFW(0:1023)
   627-0-0/c STRC(72)    r     1 VLP_ACCT                 652-0-0/d STRC(288)   r     1 VLP_NAME
   632-0-0/d STRC(522)   r     1 VLP_SN                   616-0-0/w STRC(108)   r     1 VSNSN
   606-0-0/d STRC(216)   r     1 WAIT20                   572-0-0/d STRC(432)   r     1 WRDP
   522-0-0/d STRC(432)   r     1 WRT

  ****  Section 002 RoData IGG$GET
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:152  

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   243-0-0/c CHAR(4)     r     1 A(0:3)                  1042-0-0/c CHAR(37)    r     1 ALPH
  1042-0-0/c CHAR        r     1 ALPHA(0:36)               17-0-0/c STRC(45)    r     1 CATNAME
   740-0-0/d STRC(1080)  r     1 CLOSLOG                  200-0-0/d STRC(432)   r     1 CREATIME
   444-0-0/d STRC(2088)  r     1 DEL1ST                   272-0-0/c CHAR(16)    r     1 DELMSG1
   276-0-0/c STRC(423)   r     1 DELMSG2                  312-0-0/c CHAR        r     1 DELMSG3
   536-0-0/d STRC(2088)  r     1 DELNXT                   726-0-0/d STRC(360)   r     1 ERRLOGTIME
   722-0-0/c STRC(81)    r     1 ERRNAME                 1012-0-0/d STRC(432)   r     1 ERRTIME
  1026-0-0/d STRC(432)   r     1 FPT_MONINFO              776-0-0/d STRC(432)   r     1 FPT_TIME
   216-0-0/w PTR         r     1 G$                        26-0-0/d STRC(2088)  r     1 GETPO
   220-0-0/w STRC(180)   r     1 GPBUF                    217-0-0/b STRC(9)     r     1 INITKEYTBL
   323-0-0/c CHAR(45)    r     1 MRRMSG1                  337-0-0/c STRC(486)   r     1 MRRMSG2
   225-0-0/c CHAR(7)     r     1 MSG2                     227-0-0/b BIT (18)    r     1 MSG3
   227-0-0/c CHAR(2)     r     1 MSG3C                    247-0-0/c CHAR(4)     r     1 MSG4
   250-0-0/c CHAR(45)    r     1 MSG7                     230-0-0/c CHAR(22)    r     1 MSG8
   370-0-0/c STRC(1125)  r     1 MSG91                     22-0-0/d STRC(90)    r     1 OPNSN
   236-0-0/c CHAR(4)     r     1 P(0:4)                   355-0-0/c CHAR(11)    r     1 PERS(0:3)
   120-0-0/d STRC(1080)  r     1 RELPO                    156-0-0/d STRC(648)   r     1 RELRESPO
     0-0-0/d STRC(504)   r     1 RSTAT                    214-0-0/c STRC(45)    r     1 SLUGNAME
    16-0-0/b BIT (18)    r     1 STATKEY                  430-0-0/c STRC(387)   r     1 TERMSG
   630-0-0/d STRC(2088)  r     1 TESTERRLOG               264-0-0/c STRC(207)   r     1 WMSG

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    42-0-0/w PTR         r     1 @ASN                       3-0-0/w PTR         r     1 @BOOTFLAG
    41-0-0/w PTR         r     1 @PMME                     *0-0-0/w UBIN        r     1 ASN
    *0-0-0/w UBIN        r     1 BOOTFLAG                  44-0-0/w PTR         r     1 DCB$
    45-0-0/w UBIN        r     1 I                         *0-0-0/w UBIN        r     1 PMME
     5-0-0/w UBIN        r     1 SECTS(0:25)                4-0-0/w PTR         r     1 T$
    43-0-0/w SBIN        r     1 TEMP_INT

PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:153  
  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/b BIT         r     1 ERRCODE
     0-0-0/w PTR         r     1 JDCB$                      0-0-0/w PTR         r     1 M$DP$
     0-0-0/w SBIN        r     1 SGRANS

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/c CHAR(1200)  r     1 CHAR1200                   0-0-0/w STRC(396)   r     1 CODE04
     0-0-0/c CHAR(120)   r     1 EBUF                       0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/w STRC(180)   r     1 FM$GRAN
     0-0-0/w UBIN(9)     r     1 FM$KEYTBL(0:279)
     0-0-0/w UBIN        r     1 FM$KT(0:69)                0-0-0/w STRC(144)   r     1 FX$STAT
     0-0-0N  NULL        r     1 M$DP                       0-0-0N  NULL        r     1 M$EI
     0-0-0N  NULL        r     1 M$EO                       0-0-0/w BIT         r     1 PADFITB(0:63)
     0-0-0/w STRC(90)    r     1 VLP$ACCESS                 0-0-0/d STRC(2232)  r     1 VLR_SITEINFO


   Procedure IGG$GET requires 1987 words for executable code.
   Procedure IGG$GET requires 42 words of local(AUTO) storage.

    No errors detected in file IGG$GET.:E05TSI    .
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:154  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:155  
          MINI XREF LISTING

A IN PROCEDURE WROC
      3233**DCL      4128>>ASSIGN
ABORT IN PROCEDURE WROC
      4092**LABEL    4077--CALLALT
ADJSYSOK
      2570**DCL      2791>>IF       2792<<ASSIGN   2833>>IF       2843>>IF
ALLDONE
      3041**LABEL    3113--GOTO     3129--GOTO
ALPH IN PROCEDURE WROC
      3895**DCL      3897--REDEF
ALPHA IN PROCEDURE WROC
      3897**DCL      4124>>ASSIGN
ASN IN PROCEDURE WROC
      3185**DCL      3183--PROC     3931--ENTRY    4103>>IF       4104>>IF       4128>>ASSIGN   4131>>IF
      4132>>IF       4142>>IF       4148>>IF       4157>>IF
B$ALT.CODE
      2639**DCL      2639--REDEF    2640--REDEF    2640--REDEF
B$ALT.ERR
      2640**DCL      2822>>ASSIGN   2927>>ASSIGN   2981>>ASSIGN   3135>>ASSIGN   3929>>ASSIGN
B$ALT.ERR.CODE
      2641**DCL      3091>>IF       3104>>IF       3117>>IF
B$ALT.ERR.ERR#
      2641**DCL      2641--REDEF
B$ALT.EVID
      2640**DCL      2640--REDEF    2640--REDEF
B$TCB.ALT$
      2635**DCL      2822>>ASSIGN   2927>>ASSIGN   2981>>ASSIGN   3091>>IF       3104>>IF       3117>>IF
      3135>>ASSIGN   3929>>ASSIGN
B$TCB$
      2633**DCL      2635--IMP-PTR  2822>>ASSIGN   2927>>ASSIGN   2981>>ASSIGN   3091>>IF       3104>>IF
      3117>>IF       3135>>ASSIGN   3929>>ASSIGN
BOOTFLAG
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:156  
        16**DCL        15--PROC     2762--ENTRY    2763>>DOCASE   3042>>IF       3043>>IF
CATNAME
      1896**DCL      3052>>ASSIGN
CHAR1200 IN PROCEDURE WROC
      3217**DCL      4102<<ASSIGN
CHKR1
      2989**LABEL    2990--CALLALT
CLOSLOG IN PROCEDURE WROC
      3798**DCL      4080<>CALL
CLOSLOG.SN_ IN PROCEDURE WROC
      3798**DCL      3798--REDEF
CLOSLOG.UTL_ IN PROCEDURE WROC
      3799**DCL      3799--REDEF
CLOSLOG.V IN PROCEDURE WROC
      3803**DCL      3798--DCLINIT
CLOSLOG.V.EXPIRE# IN PROCEDURE WROC
      3813**DCL      3813--REDEF
CLOSLOG.V.TYPE# IN PROCEDURE WROC
      3811**DCL      3811--REDEF
CLOSLOG.V.XTNSIZE# IN PROCEDURE WROC
      3808**DCL      3808--REDEF    3810--REDEF
CLSDP
      2128**DCL      2818<>CALL     2894<>CALL     2909<>CALL     2916<>CALL     2923<>CALL     2979<>CALL
      3039<>CALL     3156<>CALL     3959<>CALL
CLSDP.SN_
      2128**DCL      2128--REDEF
CLSDP.UTL_
      2129**DCL      2129--REDEF
CLSDP.V
      2133**DCL      2128--DCLINIT
CLSDP.V.DISP#
      2137**DCL      2977<<ASSIGN   3038<<ASSIGN   3144>>IF       3150<<ASSIGN   4106>>IF
CLSDP.V.EXPIRE#
      2143**DCL      2143--REDEF
CLSDP.V.TYPE#
      2141**DCL      2141--REDEF
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:157  
CLSDP.V.XTNSIZE#
      2138**DCL      2138--REDEF    2140--REDEF
CLSEI
      2042**DCL      3110<>CALL     3172<>CALL     3177<>CALL
CLSEI.SN_
      2042**DCL      2042--REDEF
CLSEI.UTL_
      2043**DCL      2043--REDEF
CLSEI.V
      2047**DCL      2042--DCLINIT
CLSEI.V.EXPIRE#
      2057**DCL      2057--REDEF
CLSEI.V.POS#
      2055**DCL      3111<<ASSIGN   4166<<ASSIGN
CLSEI.V.TYPE#
      2055**DCL      2055--REDEF
CLSEI.V.XTNSIZE#
      2052**DCL      2052--REDEF    2054--REDEF
CLSEIERR
      3165**LABEL    3110--CALLALT
CLSEO
      2000**DCL      3062<>CALL     3107<>CALL
CLSEO.SN_
      2000**DCL      2000--REDEF
CLSEO.UTL_
      2001**DCL      2001--REDEF
CLSEO.V
      2005**DCL      2000--DCLINIT
CLSEO.V.EXPIRE#
      2015**DCL      2015--REDEF
CLSEO.V.TYPE#
      2013**DCL      2013--REDEF
CLSEO.V.XTNSIZE#
      2010**DCL      2010--REDEF    2012--REDEF
CLSEOERR
      3168**LABEL    3107--CALLALT
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:158  
CLSEOREL
      2084**DCL      3173<>CALL
CLSEOREL.SN_
      2084**DCL      2084--REDEF
CLSEOREL.UTL_
      2085**DCL      2085--REDEF
CLSEOREL.V
      2089**DCL      2084--DCLINIT
CLSEOREL.V.EXPIRE#
      2099**DCL      2099--REDEF
CLSEOREL.V.TYPE#
      2097**DCL      2097--REDEF
CLSEOREL.V.XTNSIZE#
      2094**DCL      2094--REDEF    2096--REDEF
CODE04.MODIFY.TIME
      1455**DCL      3036>>ASSIGN
CONTTEST
      3117**LABEL    3071--CALLALT
CP6VSN
      2569**DCL      2780<<ASSIGN   2786>>IF       2786>>IF       2788<<ASSIGN   2791>>IF       2791>>IF
      2826>>ASSIGN   2830>>ASSIGN   2900>>DOWHILE  3949>>IF
CREATIME
      2552**DCL      2955<>CALL
CREATIME.V
      2556**DCL      2552--DCLINIT
DCB$ IN PROCEDURE WROC
      3188**DCL      3992<<ASSIGN   3994>>IF       3996>>ASSIGN   3997>>ASSIGN   3998>>CALLBLT  4005>>ASSIGN
      4133<<ASSIGN   4135<<ASSIGN   4148>>IF       4151>>ASSIGN   4152>>ASSIGN
DEL1ST IN PROCEDURE WROC
      3353**DCL      3979<>CALL
DEL1ST.ACSVEH_ IN PROCEDURE WROC
      3355**DCL      3356--REDEF
DEL1ST.ALTKEYS_ IN PROCEDURE WROC
      3361**DCL      3362--REDEF    3362--REDEF
DEL1ST.HDR_ IN PROCEDURE WROC
      3360**DCL      3361--REDEF
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:159  
DEL1ST.TAB_ IN PROCEDURE WROC
      3359**DCL      3360--REDEF
DEL1ST.UHL_ IN PROCEDURE WROC
      3353**DCL      3354--REDEF    3354--REDEF
DEL1ST.V IN PROCEDURE WROC
      3362**DCL      3353--DCLINIT
DEL1ST.V.FSN# IN PROCEDURE WROC
      3393**DCL      3393--REDEF    3393--REDEF
DEL1ST.WSN_ IN PROCEDURE WROC
      3359**DCL      3359--REDEF
DELMSG1 IN PROCEDURE WROC
      3239**DCL      4017--ASSIGN
DELMSG2 IN PROCEDURE WROC
      3240**DCL      4026--ASSIGN
DELMSG3 IN PROCEDURE WROC
      3244**DCL      3977--ASSIGN
DELNXT IN PROCEDURE WROC
      3463**DCL      4010<>CALL
DELNXT.ACSVEH_ IN PROCEDURE WROC
      3465**DCL      3466--REDEF
DELNXT.ALTKEYS_ IN PROCEDURE WROC
      3471**DCL      3472--REDEF    3472--REDEF
DELNXT.HDR_ IN PROCEDURE WROC
      3470**DCL      3471--REDEF
DELNXT.TAB_ IN PROCEDURE WROC
      3469**DCL      3470--REDEF
DELNXT.UHL_ IN PROCEDURE WROC
      3463**DCL      3464--REDEF    3464--REDEF
DELNXT.V IN PROCEDURE WROC
      3472**DCL      3463--DCLINIT
DELNXT.V.FSN# IN PROCEDURE WROC
      3503**DCL      3503--REDEF    3503--REDEF
DELNXT.WSN_ IN PROCEDURE WROC
      3469**DCL      3469--REDEF
DELTHIS IN PROCEDURE WROC
      3572**DCL      4004<>CALL
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:160  
DELTHIS.ACSVEH_ IN PROCEDURE WROC
      3574**DCL      3575--REDEF
DELTHIS.ALTKEYS_ IN PROCEDURE WROC
      3580**DCL      3581--REDEF    3581--REDEF
DELTHIS.HDR_ IN PROCEDURE WROC
      3579**DCL      3580--REDEF
DELTHIS.TAB_ IN PROCEDURE WROC
      3578**DCL      3579--REDEF
DELTHIS.UHL_ IN PROCEDURE WROC
      3572**DCL      3573--REDEF    3573--REDEF
DELTHIS.V IN PROCEDURE WROC
      3581**DCL      3572--DCLINIT
DELTHIS.V.FSN# IN PROCEDURE WROC
      3612**DCL      3612--REDEF    3612--REDEF
DELTHIS.WSN_ IN PROCEDURE WROC
      3578**DCL      3578--REDEF
DPDONE
      2821**LABEL    2783--CALLALT
DPERR
      3134**LABEL    2818--CALLALT  2827--CALLALT  2828--CALLALT  2835--CALLALT  2852--CALLALT  2856--CALLALT
      2877--CALLALT  2882--CALLALT  2888--CALLALT  2894--CALLALT  2897--CALLALT  2898--CALLALT  2909--CALLALT
      2911--CALLALT  2912--CALLALT  2915--CALLALT  2916--CALLALT  2917--CALLALT  2919--CALLALT  2923--CALLALT
      2930--CALLALT  2954--CALLALT  2966--CALLALT  2974--CALLALT  3006--CALLALT  3008--CALLALT  3010--CALLALT
      3013--CALLALT  3015--CALLALT  3021--CALLALT  3033--CALLALT
DPERR IN PROCEDURE WROC
      3962**LABEL    3956--CALLALT  3958--CALLALT  3959--CALLALT
DPERR1
      3134**LABEL    2823--GOTO     2993--GOTO     3132--GOTO
EBUF IN PROCEDURE WROC
      3218**DCL      3995<<ASSIGN   3997<<ASSIGN   3998<<CALLBLT  3999<<ASSIGN   4109>>DOWHILE  4111>>DOWHILE
      4117>>IF       4119<<CALLBLT
EFPT IN PROCEDURE WROC
      3201**DCL      4107<>CALL
EFPT.V IN PROCEDURE WROC
      3205**DCL      3201--DCLINIT
EFPT.V.DCB# IN PROCEDURE WROC
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:161  
      3205**DCL      4103<<ASSIGN   4104<<ASSIGN   4105<<ASSIGN
ERMSGOK IN PROCEDURE WROC
      4152**LABEL    4121--GOTO
ERR
      2577**DCL      2821<>CALL     2822<<ASSIGN   2926<>CALL     2927<<ASSIGN   2980<>CALL     2981<<ASSIGN
      3131<<ASSIGN   3134<>CALL     3135<<ASSIGN   3201--DCLINIT  3929<<ASSIGN
ERR.CODE
      2580**DCL      2823>>IF       2982>>ASSIGN   4126>>CALLBLT
ERR.F
      2578**DCL      4124>>ASSIGN
ERR.SEV
      2581**DCL      3137<<ASSIGN   3145<<ASSIGN   3930<<ASSIGN   4094>>IF       4176<<ASSIGN   4176>>ASSIGN
ERRCODE
      2582**DCL      3131>>ASSIGN
ERRK IN PROCEDURE WROC
      3892**DCL      3765--DCLINIT  3766--DCLINIT  3852--DCLINIT
ERRK.TIME IN PROCEDURE WROC
      3893**DCL      4052>>IF       4053<>CALL
ERRLOGTIME IN PROCEDURE WROC
      3765**DCL      4051<>CALL
ERRLOGTIME.V IN PROCEDURE WROC
      3767**DCL      3765--DCLINIT
ERRNAME IN PROCEDURE WROC
      3751**DCL      3683--DCLINIT
ERRTIME IN PROCEDURE WROC
      3848**DCL      4059<>CALL
ERRTIME.V IN PROCEDURE WROC
      3852**DCL      3848--DCLINIT
F$DCB.ACCT
        30**DCL      2832>>ASSIGN   2868>>ASSIGN
F$DCB.ACTPOS
        45**DCL        45--REDEF
F$DCB.ARS
        20**DCL        20--REDEF    3094>>IF       3096>>ASSIGN
F$DCB.ATTR
        38**DCL        39--REDEF
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:162  
F$DCB.BORROW
        53**DCL        53--REDEF      53--REDEF      53--REDEF
F$DCB.DCBNAME.L
        67**DCL        67--IMP-SIZ
F$DCB.DVBYTE
        23**DCL      3087>>ASSIGN   3090>>ASSIGN
F$DCB.EOMCHAR
        24**DCL        24--REDEF
F$DCB.FCD
        33**DCL      3109>>IF
F$DCB.FLDID
        48**DCL        48--REDEF
F$DCB.FORM$
        42**DCL        42--REDEF
F$DCB.FSECT
        58**DCL        58--REDEF    4167>>IF
F$DCB.FSN
        35**DCL        35--REDEF      35--REDEF      36--REDEF
F$DCB.HEADER$
        41**DCL        41--REDEF
F$DCB.IORG
        56**DCL      3077>>IF
F$DCB.IXTNSIZE
        39**DCL        39--REDEF    2837>>IF       2839>>IF       2841>>ASSIGN   2879>>DOWHILE  3994>>IF
      3998>>CALLBLT  4005>>ASSIGN
F$DCB.LASTSTA$
        29**DCL        29--REDEF
F$DCB.LVL
        54**DCL        54--REDEF
F$DCB.NAME
        29**DCL      3075>>ASSIGN
F$DCB.NAME.C
        29**DCL        29--REDEF    3074>>IF       3125>>IF       3997>>ASSIGN   4148>>IF       4151--ASSIGN
F$DCB.NAME.L
        29**DCL      3125>>IF       3996>>ASSIGN   4152>>ASSIGN
F$DCB.NOEOF
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:163  
        50**DCL        50--REDEF
F$DCB.NRECS
        40**DCL        40--REDEF
F$DCB.NRECX
        59**DCL        59--REDEF
F$DCB.OHDR
        51**DCL        51--REDEF
F$DCB.ORG
        34**DCL        34--REDEF    3079>>IF       3085>>IF
F$DCB.PASS
        30**DCL      2811>>ASSIGN   4139--ASSIGN
F$DCB.PRECNO
        57**DCL        57--REDEF
F$DCB.PSN
        30**DCL      3141>>ASSIGN
F$DCB.RCSZ
        62**DCL        62--REDEF
F$DCB.RES
        30**DCL        30--REDEF
F$DCB.SETX
        42**DCL        42--REDEF    2795>>IF
F$DCB.TAB$
        41**DCL        42--REDEF
F$DCB.TDA
        56**DCL        56--REDEF
F$DCB.VOL
        40**DCL      4168>>ASSIGN   4170>>ASSIGN
F$DCB.WSN
        31**DCL        31--REDEF
F$DCB.XTNSIZE
        37**DCL      2795>>IF
FIT_BUF
      2622**DCL      1830--DCLINIT  1831--DCLINIT  2393--DCLINIT  2394--DCLINIT  2431--DCLINIT  2432--DCLINIT
      2685--DCLINIT  3056--ASSIGN   3057--ASSIGN   3059--ASSIGN   3078--ASSIGN   3095--ASSIGN   3202--DCLINIT
      3358--DCLINIT  3468--DCLINIT  3868--DCLINIT  3991--ASSIGN   4077--CALLBLT  4102--ASSIGN   4108--ASSIGN
FIT_BUF.GRAN
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:164  
      2623**DCL      1540--DCLINIT  1658--DCLINIT  2514--DCLINIT  2515--DCLINIT  2853<<ASSIGN   2860>>ASSIGN
      2874>>ASSIGN   2884>>ASSIGN   2950<<ASSIGN   3086>>ASSIGN
FIT_BUF.MRR.DVC
      2625**DCL      2801<<ASSIGN   2801>>ASSIGN   2811<<ASSIGN   3943>>ASSIGN
FIT_BUF.MRR.VSN
      2626**DCL      2797<<ASSIGN   2799>>IF       2800<<ASSIGN   2800>>ASSIGN   2802<<ASSIGN   2805>>IF
      2810<<ASSIGN   3944>>CALLBLT  3949>>IF       3954>>ASSIGN   3964<<ASSIGN   3968>>IF
FM$GRAN
      1444**DCL      2701--DCLINIT  2702--DCLINIT  2956--ASSIGN   2961--ASSIGN   2967--ASSIGN   3034--ASSIGN
FM$GRAN.AVAIL
      1445**DCL      2951<<ASSIGN   2958<<ASSIGN   2969<<ASSIGN
FM$GRAN.FCEX
      1445**DCL      2956<<ASSIGN   2957>>ASSIGN   2967<<ASSIGN   2968>>ASSIGN   2972>>ASSIGN
FM$GRAN.LVL
      1444**DCL      2960<<ASSIGN   2971<<ASSIGN
FM$GRAN.NAVX
      1444**DCL      2951>>ASSIGN   2957<<ASSIGN   2958>>ASSIGN   2968<<ASSIGN   2969>>ASSIGN
FM$GRAN.STAMP
      1444**DCL      2959<<ASSIGN   2970<<ASSIGN
FM$KEYTBL
      1448**DCL      2687--DCLINIT  2957--ASSIGN   2964<<ASSIGN   2968--ASSIGN   2972<<ASSIGN
FM$KT
      1448**DCL      1448--REDEF
FPT_LDEV
      2159**DCL      2990<>CALL
FPT_LDEV.V
      2161**DCL      2159--DCLINIT
FPT_MONINFO IN PROCEDURE WROC
      3868**DCL      4047<>CALL
FPT_REM IN PROCEDURE WROC
      3909**DCL      4171<>CALL
FPT_REM.V IN PROCEDURE WROC
      3909**DCL      3909--DCLINIT
FPT_REM.V.PSN# IN PROCEDURE WROC
      3910**DCL      4170<<ASSIGN
FPT_TEMPWROC IN PROCEDURE WROC
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:165  
      3923**DCL      3934<>CALL     3937<>CALL     3939<>CALL     3951<>CALL     3978<>CALL     4002<>CALL
      4018<>CALL     4025<>CALL     4031<>CALL     4039<>CALL     4046<>CALL     4069<>CALL     4088<>CALL
      4097<>CALL     4115<>CALL     4130<>CALL     4138<>CALL     4140<>CALL     4144<>CALL     4146<>CALL
      4150<>CALL     4153<>CALL     4162<>CALL
FPT_TEMPWROC.BUFR_ IN PROCEDURE WROC
      3924**DCL      3933<<ASSIGN   3940<<ASSIGN   3990<<ASSIGN   4028<<ASSIGN   4064<<ASSIGN   4084<<ASSIGN
      4159<<ASSIGN
FPT_TEMPWROC.BUFW_ IN PROCEDURE WROC
      3923**DCL      3932<<ASSIGN   3936<<ASSIGN   3938<<ASSIGN   3942<<ASSIGN   3977<<ASSIGN   4017<<ASSIGN
      4024<<ASSIGN   4026<<ASSIGN   4032<<ASSIGN   4038<<ASSIGN   4063<<ASSIGN   4071<<ASSIGN   4074<<ASSIGN
      4083<<ASSIGN   4089<<ASSIGN   4096<<ASSIGN   4129<<ASSIGN   4137<<ASSIGN   4139<<ASSIGN   4143<<ASSIGN
      4145<<ASSIGN   4149<<ASSIGN   4158<<ASSIGN   4163<<ASSIGN
FPT_TEMPWROC.BUFW_.BOUND IN PROCEDURE WROC
      3923**DCL      3947<<ASSIGN   3947>>ASSIGN   4000<<ASSIGN   4045<<ASSIGN   4114<<ASSIGN   4152<<ASSIGN
FPT_TEMPWROC.BUFW_.BUFW$ IN PROCEDURE WROC
      3924**DCL      3218--IMP-PTR  3991<<ASSIGN   3995>>ASSIGN   3997>>ASSIGN   3998>>CALLBLT  3999>>ASSIGN
      4043<<ASSIGN   4108<<ASSIGN   4109>>DOWHILE  4111>>DOWHILE  4116<<ASSIGN   4116>>ASSIGN   4117>>IF
      4118<<ASSIGN   4118>>ASSIGN   4119>>CALLBLT  4151<<ASSIGN
FPT_TEMPWROC.V IN PROCEDURE WROC
      3926**DCL      3923--DCLINIT
FPT_TEMPWROC.V.TYC IN PROCEDURE WROC
      3926**DCL      4029<<ASSIGN   4030>>DOWHILE  4067<<ASSIGN   4068>>DOWHILE  4086<<ASSIGN   4087>>DOWHILE
      4161>>DOUNTIL
FPT_TIME IN PROCEDURE WROC
      3828**DCL      4050<>CALL
FPT_TIME.V IN PROCEDURE WROC
      3832**DCL      3828--DCLINIT
FX$STAT
      1868**DCL      3058--ASSIGN
FX$STAT.NUM
      1868**DCL      3056<<ASSIGN
FX$STAT.SETS.SETX
      1868**DCL      3057<<ASSIGN
FXD$PMME
      2561**DCL-ENT  2816--IF       2816--CALL     2821--IF       2821--CALL     2926--IF       2926--CALL
      2980--IF       2980--CALL     2987--IF       3134--IF       3134--CALL     3962--IF       3962--CALL
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:166  
      3971--IF       3971--CALL     4180--IF       4180--CALL
FXH$COUNT
      2562**DCL-ENT  2989--CALL
FXH$GPSUM
      2563**DCL-ENT  2996--CALL
FXH$RECON
      2564**DCL-ENT  2988--CALL
G$
      2685**DCL      1444--IMP-PTR  2951>>ASSIGN   2951>>ASSIGN   2956>>ASSIGN   2957>>ASSIGN   2957>>ASSIGN
      2958>>ASSIGN   2958>>ASSIGN   2959>>ASSIGN   2960>>ASSIGN   2961>>ASSIGN   2967>>ASSIGN   2968>>ASSIGN
      2968>>ASSIGN   2969>>ASSIGN   2969>>ASSIGN   2970>>ASSIGN   2971>>ASSIGN   2972>>ASSIGN   2972>>ASSIGN
GETPO
      2238**DCL      3044<>CALL
GETPO.ACSVEH_
      2240**DCL      2241--REDEF
GETPO.ALTKEYS_
      2246**DCL      2247--REDEF    2247--REDEF
GETPO.HDR_
      2245**DCL      2246--REDEF
GETPO.TAB_
      2244**DCL      2245--REDEF
GETPO.UHL_
      2238**DCL      2239--REDEF    2239--REDEF
GETPO.V
      2247**DCL      2238--DCLINIT
GETPO.V.FSN#
      2278**DCL      2278--REDEF    2278--REDEF
GETPO.WSN_
      2244**DCL      2244--REDEF
GPBUF
      2701**DCL      2950>>ASSIGN
GRANULE
      2674**DCL      2471--DCLINIT  2472--DCLINIT  2513--DCLINIT  2780<<ASSIGN   2854<<ASSIGN   2857>>IF
      2858>>IF       2872<<ASSIGN   2879>>DOWHILE  2881<<ASSIGN   2893<<ASSIGN   2953<<ASSIGN   2965<<ASSIGN
      2973<<ASSIGN   2975<<ASSIGN   3032<<ASSIGN
I
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:167  
      2675**DCL      2798<<DOINDEX  2799>>IF       2800>>ASSIGN   2800>>ASSIGN   2801>>ASSIGN   2801>>ASSIGN
      2802>>ASSIGN   2844<<DOINDEX  2845>>IF       2845>>IF       2845>>IF       2848>>ASSIGN   2878<<ASSIGN
      2879>>DOWHILE  2879>>DOWHILE  2879>>DOWHILE  2881>>ASSIGN   2889<<ASSIGN   2889>>ASSIGN   2899<<ASSIGN
      2900>>DOWHILE  2900>>DOWHILE  2900>>DOWHILE  2903<<ASSIGN   2903>>ASSIGN   2905>>IF       2905>>IF
      2907>>ASSIGN   2908<<DOINDEX  2910>>ASSIGN   2932<<DOINDEX  2933>>CALLBLT  2937>>IF       2944>>IF
      2946>>CALLBLT  2978<<ASSIGN   2982<<ASSIGN   2984>>IF       2985>>IF       2985>>IF       2993>>IF
      3149<<DOINDEX
I IN PROCEDURE WROC
      3189**DCL      3941<<DOINDEX  3943>>ASSIGN   3944>>CALLBLT  3949>>IF       3954>>ASSIGN   3980<<ASSIGN
      3981>>ASSIGN   3981>>ASSIGN   3983<<ASSIGN   3984<<ASSIGN   3984>>ASSIGN   3984>>ASSIGN   3985>>IF
      3987>>ASSIGN   3996<<ASSIGN   3997>>ASSIGN   3997>>ASSIGN   3998>>CALLBLT  3999>>ASSIGN   4000>>ASSIGN
      4020<<ASSIGN   4021>>DOWHILE  4021>>DOWHILE  4022<<ASSIGN   4022>>ASSIGN   4024>>ASSIGN   4044<<CALLBLT
      4045>>ASSIGN   4057<<CALLBLT  4058>>ASSIGN   4061<<CALLBLT  4062>>ASSIGN   4077<<CALLBLT  4099<<ASSIGN
      4110<<ASSIGN   4111>>DOWHILE  4112<<ASSIGN   4112>>ASSIGN   4114>>ASSIGN   4123<<DOINDEX  4124>>ASSIGN
      4124>>ASSIGN
IGG_RECONUTS
      2586**DCL      3036<<ASSIGN
INITKEYTBL
      2686**DCL      2964>>ASSIGN   2972>>ASSIGN
INMSG IN PROCEDURE WROC
      3256**DCL      3257--REDEF    3260--REDEF    3358--DCLINIT  3830--DCLINIT  3831--DCLINIT  3850--DCLINIT
      3851--DCLINIT  3940--ASSIGN   3949<<ASSIGN   3950<<ASSIGN   3990--ASSIGN   4001<<ASSIGN   4019<<CALLBLT
      4021>>DOWHILE  4024--ASSIGN   4027<<ASSIGN   4028--ASSIGN   4034>>IF       4056>>ASSIGN   4057>>CALLBLT
      4060>>ASSIGN   4061>>CALLBLT  4064--ASSIGN   4066<<ASSIGN   4070>>IF       4077>>IF       4084--ASSIGN
      4085<<ASSIGN   4159--ASSIGN   4160<<ASSIGN
IOERR
      3171**LABEL    3100--CALLALT
JDCB$
      2568**DCL      2778<<ASSIGN   2795>>IF       2795>>IF       2811>>ASSIGN   2832>>ASSIGN   2837>>IF
      2839>>IF       2841>>ASSIGN   2868>>ASSIGN   2879>>DOWHILE  3066<<ASSIGN   3074>>IF       3075>>ASSIGN
      3077>>IF       3079>>IF       3085>>IF       3087>>ASSIGN   3090>>ASSIGN   3094>>IF       3096>>ASSIGN
      3109>>IF       3125>>IF       3125>>IF       3141>>ASSIGN   4139>>ASSIGN   4167>>IF       4168>>ASSIGN
      4170>>ASSIGN
KEYBUF
      2628**DCL      2392--DCLINIT  2429--DCLINIT  2430--DCLINIT  2629--REDEF    2630--REDEF
KEYBUFB
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:168  
      2630**DCL      3060<<ASSIGN
KEYBUFW
      2629**DCL      3086<<ASSIGN
M$CLOSE
        77**DCL-ENT  2818--CALL     2894--CALL     2909--CALL     2916--CALL     2923--CALL     2979--CALL
      3039--CALL     3045--CALL     3062--CALL     3107--CALL     3110--CALL     3156--CALL     3172--CALL
      3173--CALL     3177--CALL     3959--CALL     4080--CALL
M$DP
      2588**DCL      2778--IF       2778--ASSIGN   4105>>ASSIGN
M$DP$
      2567**DCL      2568--REDEF
M$EI
      2590**DCL      3066--ASSIGN   4103>>ASSIGN   4133--ASSIGN
M$EO
      2589**DCL      3992--ASSIGN   4104>>ASSIGN   4135--ASSIGN
M$ERRMSG
       140**DCL-ENT  4107--CALL
M$LDEV
        77**DCL-ENT  2990--CALL
M$MERC
       133**DCL-ENT  4181--CALL
M$MONINFO
       145**DCL-ENT  4047--CALL
M$OPEN
        77**DCL-ENT  2783--CALL     2827--CALL     2897--CALL     2911--CALL     2917--CALL     2925--CALL
      3006--CALL     3008--CALL     3010--CALL     3013--CALL     3015--CALL     3021--CALL     3029--CALL
      3044--CALL     3054--CALL     3071--CALL     3081--CALL     3124--CALL     3153--CALL     3161--CALL
      3955--CALL     3970--CALL     3979--CALL     4004--CALL     4010--CALL     4049--CALL
M$PRECORD
        81**DCL-ENT  4051--CALL
M$READ
        78**DCL-ENT  2785--CALL     2828--CALL     2856--CALL     2882--CALL     2898--CALL     2912--CALL
      2930--CALL     3033--CALL     3055--CALL     3084--CALL     3956--CALL
M$RELRES
        84**DCL-ENT  3047--CALL
M$REM
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:169  
        86**DCL-ENT  4171--CALL
M$TEMPWROC
       121**DCL-ENT  3934--CALL     3937--CALL     3939--CALL     3951--CALL     3978--CALL     4002--CALL
      4018--CALL     4025--CALL     4031--CALL     4039--CALL     4046--CALL     4069--CALL     4088--CALL
      4097--CALL     4115--CALL     4130--CALL     4138--CALL     4140--CALL     4144--CALL     4146--CALL
      4150--CALL     4153--CALL     4162--CALL
M$TIME
       144**DCL-ENT  2955--CALL     4050--CALL     4059--CALL
M$WAIT
       135**DCL-ENT  3147--CALL     3160--CALL
M$WRITE
        78**DCL-ENT  2835--CALL     2852--CALL     2877--CALL     2888--CALL     2915--CALL     2919--CALL
      2954--CALL     2966--CALL     2974--CALL     3061--CALL     3100--CALL     3958--CALL
MAIL
      1961**DCL      3007--ASSIGN
MOVE
      1974**DCL      3020--ASSIGN
MRRCHK
      2793**LABEL    2807--EXIT
MRRCNT
      2677**DCL      2797>>ASSIGN   2798>>DOINDEX  2805>>IF       2806<<ASSIGN   2806>>ASSIGN   2810>>ASSIGN
      2811>>ASSIGN   2812<<ASSIGN   2812>>ASSIGN   2825>>IF       3941>>DOINDEX  3967<<ASSIGN
MRRMSG1 IN PROCEDURE WROC
      3245**DCL      3936--ASSIGN
MRRMSG2 IN PROCEDURE WROC
      3247**DCL      3938--ASSIGN
MRRMSG3 IN PROCEDURE WROC
      3250**DCL      3942--ASSIGN
MRRMSG3.DVC IN PROCEDURE WROC
      3253**DCL      3943<<ASSIGN
MRRMSG3.VSN IN PROCEDURE WROC
      3255**DCL      3944<<CALLBLT  3945>>DOWHILE  3946<<ASSIGN   3946>>ASSIGN
MSG1 IN PROCEDURE WROC
      3219**DCL      4129--ASSIGN
MSG1.A IN PROCEDURE WROC
      3227**DCL      4128<<ASSIGN
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:170  
MSG1.B IN PROCEDURE WROC
      3224**DCL      4137--ASSIGN
MSG1.D IN PROCEDURE WROC
      3223**DCL      4126<<CALLBLT
MSG1.F IN PROCEDURE WROC
      3221**DCL      4124<<ASSIGN
MSG1.P IN PROCEDURE WROC
      3225**DCL      4127<<ASSIGN
MSG2 IN PROCEDURE WROC
      3228**DCL      4149--ASSIGN
MSG3 IN PROCEDURE WROC
      3229**DCL      3230--REDEF    3932--ASSIGN
MSG3C IN PROCEDURE WROC
      3230**DCL      4119>>CALLBLT
MSG4 IN PROCEDURE WROC
      3234**DCL      4143--ASSIGN
MSG7 IN PROCEDURE WROC
      3235**DCL      4038--ASSIGN
MSG8 IN PROCEDURE WROC
      3231**DCL      4096--ASSIGN
MSG9 IN PROCEDURE WROC
      3264**DCL      4063--ASSIGN
MSG9.ND IN PROCEDURE WROC
      3269**DCL      3831--DCLINIT
MSG9.NM IN PROCEDURE WROC
      3269**DCL      3828--DCLINIT  3829--DCLINIT
MSG9.NP IN PROCEDURE WROC
      3269**DCL      4058<<ASSIGN
MSG9.NT IN PROCEDURE WROC
      3268**DCL      4056<<ASSIGN
MSG9.PD IN PROCEDURE WROC
      3274**DCL      3851--DCLINIT
MSG9.PM IN PROCEDURE WROC
      3274**DCL      3848--DCLINIT  3849--DCLINIT
MSG9.PP IN PROCEDURE WROC
      3274**DCL      4062<<ASSIGN
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:171  
MSG9.PT IN PROCEDURE WROC
      3273**DCL      4060<<ASSIGN
MSG91 IN PROCEDURE WROC
      3278**DCL      4071--ASSIGN
MSGW1.T IN PROCEDURE WROC
      3258**DCL      3952>>IF       3953>>IF       4003>>IF       4008>>IF       4076<<ASSIGN   4076>>ASSIGN
      4091>>IF       4165>>IF
MSGW2.W1 IN PROCEDURE WROC
      3261**DCL      3980>>ASSIGN   3982<<ASSIGN   3982>>ASSIGN
MSGW2.W2 IN PROCEDURE WROC
      3262**DCL      3983>>ASSIGN   3987<<ASSIGN   3987>>ASSIGN
MSGW2.W3 IN PROCEDURE WROC
      3263**DCL      3981<<ASSIGN   3982>>ASSIGN   3985>>IF
NEWFILES
      2583**DCL      2765<<ASSIGN   2768<<ASSIGN   2770<<ASSIGN   2774<<ASSIGN   2836>>IF       2905>>IF
      2949>>IF       2952>>IF       2986>>IF       2989>>IF       2998>>IF       4048>>IF       4106>>IF
NOCAT
      3060**LABEL    3054--CALLALT  3055--CALLALT  3061--CALLALT  3062--CALLALT
NOERMSG IN PROCEDURE WROC
      4119**LABEL    4106--GOTO     4107--CALLALT
NORECUTS
      3036**LABEL    3035--CALLALT
NOTOK
      3152**LABEL    2949--CALLALT  3161--CALLALT
NOTOK1
      3152**LABEL    3156--CALLALT
NOWROC IN PROCEDURE WROC
      4176**LABEL    3934--CALLALT  3937--CALLALT  3939--CALLALT  3951--CALLALT  3978--CALLALT  4002--CALLALT
      4018--CALLALT  4025--CALLALT  4031--CALLALT  4039--CALLALT  4046--CALLALT  4069--CALLALT  4088--CALLALT
      4097--CALLALT  4115--CALLALT  4130--CALLALT  4138--CALLALT  4140--CALLALT  4144--CALLALT  4146--CALLALT
      4150--CALLALT  4153--CALLALT  4162--CALLALT
NOWTIME IN PROCEDURE WROC
      3891**DCL      3832--DCLINIT  4052>>IF       4053<>CALL
NXTFILE IN PROCEDURE WROC
      3992**LABEL    4011--GOTO
NXTPHASE2
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:172  
      3109**LABEL    3074--GOTO     3118--CALLALT  3169--GOTO
NXTPHASE3
      3113**LABEL    3166--GOTO     3174--GOTO     3178--GOTO
OP1 IN PROCEDURE WROC
      3979**LABEL    3988--GOTO
OPNDP
      1767**DCL      2783<>CALL     2827<>CALL     2897<>CALL     2911<>CALL     2917<>CALL     2925<>CALL
      3006<>CALL     3008<>CALL     3010<>CALL     3013<>CALL     3015<>CALL     3021<>CALL     3029<>CALL
      3153<>CALL     3161<>CALL     3955<>CALL     3970<>CALL
OPNDP.ACCT_
      1771**DCL      3005<<ASSIGN   3007<<ASSIGN   3009<<ASSIGN   3012<<ASSIGN   3014<<ASSIGN   3020<<ASSIGN
OPNDP.ACSVEH_
      1769**DCL      1770--REDEF
OPNDP.ALTKEYS_
      1775**DCL      1776--REDEF    1776--REDEF
OPNDP.HDR_
      1774**DCL      1775--REDEF
OPNDP.IFPARAM_
      1772**DCL      2999<<ASSIGN   3022<<ASSIGN
OPNDP.SN_
      1767**DCL      2780<<ASSIGN   2824<<ASSIGN   2924<<ASSIGN   3142<<ASSIGN   3159<<ASSIGN   3969<<ASSIGN
OPNDP.TAB_
      1773**DCL      1774--REDEF
OPNDP.UHL_
      1767**DCL      1768--REDEF    1768--REDEF
OPNDP.V
      1776**DCL      1767--DCLINIT
OPNDP.V.FSN#
      1807**DCL      1807--REDEF    1807--REDEF
OPNDP.WSN_
      1773**DCL      1773--REDEF
OPNEI
      1535**DCL      3071<>CALL     3124<>CALL
OPNEI.ACSVEH_
      1537**DCL      1538--REDEF
OPNEI.ALTKEYS_
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:173  
      1543**DCL      1544--REDEF    1544--REDEF
OPNEI.HDR_
      1542**DCL      1543--REDEF
OPNEI.NAME_
      1536**DCL      3123<<ASSIGN
OPNEI.SN_
      1535**DCL      3120<<ASSIGN
OPNEI.TAB_
      1541**DCL      1542--REDEF
OPNEI.UHL_
      1535**DCL      1536--REDEF    1536--REDEF
OPNEI.V
      1544**DCL      1535--DCLINIT
OPNEI.V.ASN#
      1554**DCL      3113>>IF       3119<<ASSIGN
OPNEI.V.FSN#
      1575**DCL      1575--REDEF    1575--REDEF
OPNEI.V.OPER.NXTF#
      1547**DCL      3072<<ASSIGN   4173<<ASSIGN
OPNEI.V.OPER.TEST#
      1546**DCL      3122<<ASSIGN
OPNEI.V.OPER.THISF#
      1547**DCL      3121<<ASSIGN
OPNEI.V.VOL#
      1569**DCL      3073<<ASSIGN   4168<<ASSIGN
OPNEI.WSN_
      1541**DCL      1541--REDEF
OPNEO
      1653**DCL      3054<>CALL     3081<>CALL
OPNEO.ACCT_
      1657**DCL      3005>>ASSIGN
OPNEO.ACSVEH_
      1655**DCL      1656--REDEF
OPNEO.ALTKEYS_
      1661**DCL      1662--REDEF    1662--REDEF
OPNEO.HDR_
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:174  
      1660**DCL      1661--REDEF
OPNEO.IFPARAM_
      1658**DCL      3053<<ASSIGN
OPNEO.TAB_
      1659**DCL      1660--REDEF
OPNEO.UHL_
      1653**DCL      1654--REDEF    1654--REDEF
OPNEO.V
      1662**DCL      1653--DCLINIT
OPNEO.V.ACS#
      1673**DCL      3051<<ASSIGN   3079<<ASSIGN   3080<<ASSIGN
OPNEO.V.FSN#
      1693**DCL      1693--REDEF    1693--REDEF
OPNEO.V.FUN#
      1672**DCL      3050<<ASSIGN
OPNEO.WSN_
      1659**DCL      1659--REDEF
OPNSLUG
      3075**LABEL    3127--GOTO
OPNSN
      1909**DCL      2924--ASSIGN   3353--DCLINIT  3682--DCLINIT
OUTERR
      3176**LABEL    3081--CALLALT
P IN PROCEDURE WROC
      3232**DCL      4127>>ASSIGN
PADFIT
      2710**DCL      2956--ASSIGN   2962>>ASSIGN   2963--ASSIGN   2999--ASSIGN
PADFIT.ACCESS.NOACUP
      2748**DCL      3001<<ASSIGN
PADFIT.C
      2711**DCL      3000<<ASSIGN   3016<<ASSIGN
PADFIT.CGMEM
      2749**DCL      3004<<ASSIGN
PADFIT.CREATION
      2723**DCL      2556--DCLINIT
PADFIT.DFLTALL
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:175  
      2749**DCL      3002<<ASSIGN   3011<<ASSIGN   3019<<ASSIGN
PADFIT.MGRANS
      2751**DCL      3003<<ASSIGN
PADFIT.MOUNT
      2723**DCL      3017--ASSIGN   3018--ASSIGN
PADFITB
      2753**DCL      2962<<ASSIGN
PERS IN PROCEDURE WROC
      3276**DCL      4058>>ASSIGN   4062>>ASSIGN
PMME IN PROCEDURE WROC
      3184**DCL      3183--PROC     3931--ENTRY    3935>>IF       3976>>IF       4016>>IF       4037>>IF
      4042>>IF       4127>>ASSIGN   4131>>IF       4136>>IF       4169>>IF
PORES
      2365**DCL      2349--DCLINIT
PORES.PRLIST.RNAME#
      2365**DCL      2366--REDEF
POSN
      2335**DCL      2238--DCLINIT
PSMSG
      2705**DCL      4043--ASSIGN
PSMSG.H
      2706**DCL      4045--ASSIGN
PSMSG.SNS
      2707**DCL      2938>>CALLBLT  2939<<CALLBLT  2943<<CALLBLT  2945>>CALLBLT  2946<<CALLBLT  4044>>CALLBLT
PSMSG.TSN
      2708**DCL      2933<<CALLBLT  2934<<CALLBLT  2934>>CALLBLT  2935>>CALLBLT  2936<<ASSIGN   2936>>ASSIGN
      2943>>CALLBLT
RDDP
      2471**DCL      2785<>CALL     2828<>CALL     2835<>CALL     2852<>CALL     2856<>CALL     2877<>CALL
      2882<>CALL     2888<>CALL     2898<>CALL     2912<>CALL     2915<>CALL     2919<>CALL     2930<>CALL
      3033<>CALL     3956<>CALL     3958<>CALL
RDDP.STATION_
      2474**DCL      2475--REDEF
RDDP.V
      2475**DCL      2471--DCLINIT
RDDP.V.DVBYTE.REREAD#
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:176  
      2486**DCL      2486--REDEF
RDDP.V.INDX#
      2484**DCL      2484--REDEF
RDT
      2429**DCL      3084<>CALL
RDT.BUF_.BOUND
      2431**DCL      3077<<ASSIGN   3078<<ASSIGN
RDT.STATION_
      2432**DCL      2433--REDEF
RDT.V
      2433**DCL      2429--DCLINIT
RDT.V.DVBYTE.CONT#
      2446**DCL      3101<<ASSIGN
RDT.V.DVBYTE.REREAD#
      2444**DCL      2444--REDEF
RDT.V.INDX#
      2442**DCL      2442--REDEF
RECON
      2584**DCL      2766<<ASSIGN   2776<<ASSIGN   2985>>IF
RECONERR
      3131**LABEL    2988--CALLALT
RECON_LEFT_OPEN
      3030**LABEL    3029--CALLALT
RELPO
      2305**DCL      3045<>CALL
RELPO.SN_
      2305**DCL      2305--REDEF
RELPO.UTL_
      2306**DCL      2306--REDEF
RELPO.V
      2310**DCL      2305--DCLINIT
RELPO.V.EXPIRE#
      2320**DCL      2320--REDEF
RELPO.V.TYPE#
      2318**DCL      2318--REDEF
RELPO.V.XTNSIZE#
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:177  
      2315**DCL      2315--REDEF    2317--REDEF
RELPOERR1
      3047**LABEL    3044--CALLALT  3045--CALLALT
RELPOERR2
      3049**LABEL    3047--CALLALT
RELRESPO
      2348**DCL      3047<>CALL
RELRESPO.V
      2350**DCL      2348--DCLINIT
RSTAT
      1828**DCL      3055<>CALL
RSTAT.STATION_
      1831**DCL      1832--REDEF
RSTAT.V
      1832**DCL      1828--DCLINIT
RSTAT.V.DVBYTE.REREAD#
      1843**DCL      1843--REDEF
RSTAT.V.INDX#
      1841**DCL      1841--REDEF
SECTS
      2709**DCL      2842<<ASSIGN   2854>>ASSIGN   2855<<ASSIGN   2867>>ASSIGN   2867>>ASSIGN   2871>>ASSIGN
      2872>>ASSIGN   2879>>DOWHILE  2879>>DOWHILE  2881>>ASSIGN   2887>>ASSIGN   2905>>IF       2905>>IF
      2907<<ASSIGN   2913>>ASSIGN   2913>>ASSIGN   2913>>ASSIGN
SETERR
      3141**LABEL    2895--GOTO     2928--GOTO     2984--GOTO     3039--CALLALT
SETERR1
      3145**LABEL    3153--CALLALT
SETNEXT
      2783**LABEL    2825--CALLALT  3154--GOTO     3163--GOTO
SETX
      2676**DCL      2780<<ASSIGN   2789>>IF       2790<<ASSIGN   2843>>IF       2858>>IF       2869<<ASSIGN
      2895>>IF       2896>>ASSIGN   2931<<ASSIGN   2935<<CALLBLT  2936>>ASSIGN   2938<<CALLBLT  2939>>CALLBLT
      2940<<ASSIGN   2940>>ASSIGN   2942<<ASSIGN   2943>>CALLBLT  2945<<CALLBLT  2946>>CALLBLT  3152<<ASSIGN
      3162<<ASSIGN   3949>>IF       4142>>IF
SGRANS
      2576**DCL      3024>>DOWHILE  4005<<ASSIGN   4005>>ASSIGN   4019>>CALLBLT  4034<<ASSIGN
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:178  
SLUGNAME
      2672**DCL      3123--ASSIGN   3126>>ASSIGN
STATKEY
      1870**DCL      1828--DCLINIT  1829--DCLINIT  3060>>ASSIGN
SYMI
      1922**DCL      3012--ASSIGN
SYMO
      1935**DCL      3014--ASSIGN
SYSFILES
      2585**DCL      2771<<ASSIGN   2775<<ASSIGN   3040>>IF       3044>>IF
SYSTAC
      1948**DCL      3009--ASSIGN   3687--DCLINIT
T$
      2587**DCL      1453--IMP-PTR  2961<<ASSIGN   2962>>ASSIGN   2963<<ASSIGN   2963>>ASSIGN   2964>>ASSIGN
      3034<<ASSIGN   3035<>CALL     3036>>ASSIGN
TEMP_INT IN PROCEDURE WROC
      3186**DCL      4053<>CALL     4054>>IF
TERMSG IN PROCEDURE WROC
      3283**DCL      4158--ASSIGN
TESTEOF
      3104**LABEL    3092--GOTO
TESTERRLOG IN PROCEDURE WROC
      3682**DCL      4049<>CALL
TESTERRLOG.ACSVEH_ IN PROCEDURE WROC
      3684**DCL      3685--REDEF
TESTERRLOG.ALTKEYS_ IN PROCEDURE WROC
      3690**DCL      3691--REDEF    3691--REDEF
TESTERRLOG.HDR_ IN PROCEDURE WROC
      3689**DCL      3690--REDEF
TESTERRLOG.TAB_ IN PROCEDURE WROC
      3688**DCL      3689--REDEF
TESTERRLOG.UHL_ IN PROCEDURE WROC
      3682**DCL      3683--REDEF    3683--REDEF
TESTERRLOG.V IN PROCEDURE WROC
      3691**DCL      3682--DCLINIT
TESTERRLOG.V.FSN# IN PROCEDURE WROC
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:179  
      3722**DCL      3722--REDEF    3722--REDEF
TESTERRLOG.WSN_ IN PROCEDURE WROC
      3688**DCL      3688--REDEF
TIMEAGIN IN PROCEDURE WROC
      4064**LABEL    4072--GOTO
TIMEOK IN PROCEDURE WROC
      4080**LABEL    4049--CALLALT  4051--CALLALT  4054--GOTO
VIDBUF
      2679**DCL      2473--DCLINIT  2474--DCLINIT  2684--REDEF    2853>>ASSIGN   2860<<ASSIGN   2874<<ASSIGN
      2884<<ASSIGN
VIDBUF.DGT.FGRAN
      2681**DCL      2845>>IF
VIDBUF.DGT.LGRAN
      2681**DCL      2845>>IF       2848>>ASSIGN
VIDBUF.DTT
      2681**DCL      2681--REDEF    2845>>IF
VIDBUF.ID
      2679**DCL      2786>>IF       2794>>IF       2858>>IF       2873>>IF       2883>>IF       2888>>IF
VIDBUF.MIRROR.C
      2680**DCL      2809>>IF       3957<<ASSIGN
VIDBUF.MIRROR.STATE
      2680**DCL      2809>>IF
VIDBUF.PSN
      2679**DCL      2786>>IF       2789>>IF       2861<<ASSIGN   2914<<ASSIGN   2918<<ASSIGN   3141<<ASSIGN
      4145--ASSIGN
VIDBUF.SECTSTRT
      2680**DCL      2833>>ASSIGN   2837>>IF       2838<<ASSIGN   2839>>IF       2839>>IF       2841<<ASSIGN
      2842>>ASSIGN   2843>>IF       2850<<ASSIGN   2855>>ASSIGN   2871<<ASSIGN   2887<<ASSIGN
VIDBUF.SNLIST.SIZE
      2682**DCL      2834<<ASSIGN   2851<<ASSIGN   2867<<ASSIGN   2905>>IF       2913<<ASSIGN
VIDBUF.SNLIST.TYPE
      2682**DCL      2832<<ASSIGN   2868<<ASSIGN
VIDBUF.SNLIST.VSN
      2682**DCL      2790>>ASSIGN   2869>>ASSIGN   2910>>ASSIGN
VIDBUF.SNLIST.VSN.N
      2682**DCL      2830<<ASSIGN   2865<<ASSIGN   2900>>DOWHILE  2933>>CALLBLT
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:180  
VIDBUF.SNLIST.VSN.S
      2682**DCL      2831<<ASSIGN   2866<<ASSIGN   2900>>DOWHILE  2944>>IF       2946>>CALLBLT
VIDBUF.SYSDIRDA
      2679**DCL      2864<<ASSIGN
VIDBUF.SYSSIZE
      2679**DCL      2833<<ASSIGN   2834>>ASSIGN   2839>>IF       2843>>IF       2845>>IF       2845>>IF
      2848<<ASSIGN   2850>>ASSIGN   2851>>ASSIGN   2863<<ASSIGN
VIDBUF.VOLCNT
      2679**DCL      2789>>IF       2792>>ASSIGN   2829<<ASSIGN   2857<<ASSIGN   2858>>IF       2862<<ASSIGN
      2875<<ASSIGN   2885<<ASSIGN   2900>>DOWHILE  2905>>IF       2908>>DOINDEX  2932>>DOINDEX
VIDBUF.VSN
      2679**DCL      2786>>IF       2788>>ASSIGN   2791>>IF       2794>>IF       2799>>IF       2802>>ASSIGN
      2810>>ASSIGN   2865>>ASSIGN
VIDBUFW
      2684**DCL      3034--ASSIGN
VLP$ACCESS.ACCT
      2756**DCL      3018<<ASSIGN
VLP$ACCESS.FFLG
      2755**DCL      3017<<ASSIGN
VLP_ACCT
      2603**DCL      1540--DCLINIT  1658--DCLINIT
VLP_NAME
      2618**DCL      1654--DCLINIT  3052<<ASSIGN   3075<<ASSIGN   3126<<ASSIGN
VLP_SN
      2616**DCL      1535--DCLINIT
VLP_SN.SN#
      2616**DCL      4170>>ASSIGN
VLR_SITEINFO.SITE_NAME#.C IN PROCEDURE WROC
      3884**DCL      4077>>CALLBLT
VSNSN
      2571**DCL      2824--ASSIGN
VSNSN.VSN
      2573**DCL      2826<<ASSIGN   2896<<ASSIGN   2910<<ASSIGN   3954<<ASSIGN
WAIT20
      2538**DCL      3147<>CALL     3160<>CALL
WAIT20.V
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:181  
      2539**DCL      2538--DCLINIT
WMSG IN PROCEDURE WROC
      3236**DCL      4083--ASSIGN
WRDP
      2513**DCL      2954<>CALL     2966<>CALL     2974<>CALL
WRDP.STATION_
      2515**DCL      2515--REDEF
WRDP.V
      2516**DCL      2513--DCLINIT
WRDP.V.DVBYTE.VFC#
      2522**DCL      2522--REDEF
WROC
      3183**PROC     2825--CALL     2949--CALL     2986--CALL     2995--CALL     3025--CALL     3026--CALL
      3105--CALL     3118--CALL     3158--CALL     3165--CALL     3168--CALL     3171--CALL     3176--CALL
WROC1 IN PROCEDURE WROC
      3931**ENTRY    3139--CALL     3146--CALL
WRT
      2392**DCL      3061<>CALL     3100<>CALL
WRT.BUF_
      2392**DCL      3099<<ASSIGN
WRT.BUF_.BOUND
      2392**DCL      3058<<ASSIGN   3096<<ASSIGN
WRT.BUF_.BUF$
      2394**DCL      3059<<ASSIGN   3095<<ASSIGN
WRT.STATION_
      2394**DCL      2394--REDEF
WRT.V
      2395**DCL      2392--DCLINIT
WRT.V.DVBYTE
      2400**DCL      3087<<ASSIGN   3090<<ASSIGN
WRT.V.DVBYTE.CONT#
      2403**DCL      3088<<ASSIGN   3091<<ASSIGN   3101>>ASSIGN
WRT.V.DVBYTE.VFC#
      2401**DCL      2401--REDEF
XSF$LOCCODT
      2565**DCL-ENT  3035--CALL
PL6.E3A0      #001=IGG$GET File=IGG$GET.:E05TSI                                  TUE 07/29/97 22:33 Page:182  
XUD$UTS_DIFF_SEC
      1417**DCL-ENT  4053--CALL
