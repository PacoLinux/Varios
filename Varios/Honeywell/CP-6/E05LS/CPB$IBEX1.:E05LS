VERSION E05

PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:1    
        1        1        /*M* LDEV and Accounting cmds, PLATEN, CANCEL, CHECK, MESSAGE, SET/ADJUST/RESET */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,DFC */
        8        8        /*P*   NAME:   CPB$IBEX1
        9        9               PURPOSE: To perform all the required operations in  the execution
       10       10                       of selected IBEX commands.
       11       11               DESCRIPTION:
       12       12               REFERENCE: Programmers Reference Manual
       13       13        */
       14       14        /**********************************************************************/
       15       15        CPB$IBEX1:
       16       16          PROC(P$PCB)    ALTRET;
       17       17                   %PLIST;
       18       18                   %INCLUDE CP_6;
       19       99                   %INCLUDE AZ_MACRO_C;
       20     2686                   %INCLUDE AZ_SUBS_C;
       21     2755                   %INCLUDE B$JIT;
       22     3045                   %INCLUDE B_STRINGS_C;
       23     3174                   %INCLUDE B_MACROS_C;
       24     3285                   %INCLUDE CP_MACROS_C;
       25     4037                   %INCLUDE XU_MACRO_C;
       26     7143                   %INCLUDE CP_SUBS_C;
       27     8060                   %INCLUDE CP_PERR_C;
       28     8398                   %INCLUDE CP_6_SUBS;
       29     8938                   %INCLUDE B_ERRORS_C;
       30    10065                   %INCLUDE OC_SUBS_C;
       31    10796                  %INCLUDE CP_DATA_R;
       32    13359             /***** Ptr variable declarations *****/
       33    13360    1   DCL P$ PTR;
       34    13361    1   DCL BLK$ PTR;
       35    13362    1   DCL TEMP$ PTR;
       36    13363    1   DCL TEMPBUF$ PTR;
       37    13364    1   DCL DEST$ PTR;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:2    
       38    13365             /***** External procedure (entry) declarations *****/
       39    13366    1   DCL AZA$LOGOFF ENTRY(1) ALTRET;
       40    13367    1   DCL CPA$BYE ENTRY(1) ALTRET;
       41    13368    1   DCL CPB$FIND_UCNN ENTRY(2) ALTRET;
       42    13369    1   DCL CPC$WRITEMSGE ENTRY(6);
       43    13370    1   DCL CPC$OPEN_LL ENTRY;
       44    13371    1   DCL CPC$OPEN_S ENTRY(1) ALTRET;
       45    13372    1   DCL CPE$RZEROS ENTRY(3);
       46    13373    1   DCL CPB$BLDIMAGE ENTRY(5) ALTRET;
       47    13374    1   DCL CPE$LISTOUT ENTRY(1) ALTRET;
       48    13375    1   DCL CXP$POSTERR ENTRY(5);
       49    13376             /***** Based STRUCTURES *****/
       50    13377        %SEG$2;
       51    13437        %B$TCB (STCLASS="BASED(B$TCB$)");
       52    13440        %B$ALT;
       53    13448             /***** Character string declarations *****/
       54    13449    1   DCL PLATENHDR CONSTANT CHAR(19) INIT('   Platen: Width = ');
       55    13450    1   DCL REPORTHDR CONSTANT CHAR(11) INIT('   Report: ');
       56    13451    1   DCL  1  TMDATE AUTO,
       57    13452    1        2  COUNT UBIN BYTE UNAL,
       58    13453    1        2  DATE CHAR(10),
       59    13454    1        2  *  CHAR(2),
       60    13455    1        2  TIME,
       61    13456    1           3  HR  CHAR(3),
       62    13457    1           3  MIN CHAR(2),
       63    13458    1           3  SEC CHAR(3),
       64    13459    1           3  MSEC CHAR(3);
       65    13460    1     DCL TMDATEBUF REDEF TMDATE CHAR(24);
       66    13461    1   DCL TBUFF REDEF TMDATE CHAR(24);
       67    13462    1   DCL TEMPBUF CHAR(256);
       68    13463    1   DCL  1  TEMP_BUF REDEF TEMPBUF,
       69    13464    1        2  COUNT UBIN BYTE UNAL,
       70    13465    1        2  TEXT CHAR(255);
       71    13466             /***** Word declarations *****/
       72    13467    1   DCL I SBIN;
       73    13468    1   DCL J SBIN;
       74    13469    1   DCL K SBIN;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:3    
       75    13470    1   DCL TEMP UBIN WORD;
       76    13471    1   DCL TEMP2 UBIN WORD;
       77    13472    1   DCL TEMP3 UBIN WORD;
       78    13473    1   DCL TAB_VAL UBIN WORD;
       79    13474    1   DCL CPOS UBIN WORD AUTO;
       80    13475    1   DCL STRM CHAR(2) AUTO;
       81    13476    1   DCL DCB# UBIN WORD AUTO ;
       82    13477             /***** Based FPTS *****/
       83    13478        %FPT_WRITE (FPTN=FPT$WRITE,STCLASS=BASED);
       84    13509        %FPT_CLOSE (FPTN=FPT$CLOSE,STCLASS=BASED);
       85    13551        %FPT_FID (FPTN=FPT$FID,STCLASS=BASED);
       86    13574        %F$DCB (DCBN=F$DCB);
       87    13631             /***** Auto FPTS *****/
       88    13632        %LOGOFF$PARAM (NAME=LOGOFF,STCLASS=AUTO);
       89    13673        %FPT_OPEN (FPTN=FPT_OPEN,STCLASS=AUTO);
       90    13782        %FPT_WRITE (FPTN=FPT_WRITE,STCLASS=AUTO);
       91    13813        %FPT_CLOSE (FPTN=FPT_CLOSE,STCLASS=AUTO);
       92    13855        %FPT_DELREC (FPTN=FPT_DELREC,STCLASS=AUTO);
       93    13874        %FPT_KEYIN (FPTN=FPT_KEYIN,STCLASS=AUTO);
       94    13893        %FPT_LDEV (FPTN=FPT_LDEV,STCLASS=AUTO);
       95    13918        %FPT_PLATEN (FPTN=FPT_PLATEN,STCLASS=AUTO);
       96    13943             /***** Based VLPS *****/
       97    13944             /***** Auto VLPS *****/
       98    13945        %VLP_ACCT (FPTN=FID_ACCT,STCLASS=AUTO);
       99    13958        %VLP_HDR (FPTN=VLP_HDR,LEN=511,STCLASS=AUTO);
      100    13974        %VLP_PLATEN (FPTN=PLATEN_VLP,STCLASS=AUTO);
      101    13996             /***** Error codes *****/
      102    13997        %ERR_CODE (NAME=E_RPTATJS,MID#=CPB$IBEXMID,CODE#=E$RPTATJS,STCLASS=CONSTANT);
      103    14017                   %EJECT;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:4    
      104    14018        /*         Parsing macros                        */
      105    14019        %PLIST;
      106    14020        %PARSE$OUT(NAME=P$B,STCLASS=BASED);
      107    14065        %PARSE$SYM(NAME=P$S,STCLASS=BASED);
      108    14103        %P$PCB(NAME=P$PCB,STCLASS="");
      109    14304        %P$PCB(NAME=PCB,STCLASS=AUTO);
      110    14505                   %EJECT;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:5    
      111    14506        /*********************************************************************/
      112    14507        /*F*    NAME:       CPB$ATITLE
      113    14508                PURPOSE:  To process the ATITLE command
      114    14509                DESCRIPTION:  The title portion of the ATITLE command is extracted
      115    14510                         from the command line and written to the *S file with the
      116    14511                         key 'ATITLE'.
      117    14512               REFERENCE: Programmers Reference Manual
      118    14513        */
      119    14514        /*D*   NAME:   CPB$ATITLE
      120    14515               CALL:   CALL CPB$ATITLE (P$PCB)
      121    14516               INPUT:  P$PCB - parse control block framing command.
      122    14517               OUTPUT:
      123    14518               DESCRIPTION: The ATITLE command writes a record into the *S file
      124    14519                      which will be associated with accounting information.
      125    14520        */
      126    14521        /*********************************************************************/
      127    14522    1   CPB$ATITLE:
      128    14523    1     ENTRY(P$PCB)   ALTRET;
      129    14524        /**/
      130    14525        /*
      131    14526        *****   Begin procedure
      132    14527        */
      133    14528    1     BLK$ = P$PCB.OUT$;
      134    14529    1     CALL CPC$OPEN_S(M$IBEX1_NUM) ALTRET(E_C$OPEN_S);
      135    14530        /*
      136    14531             ***** If there are no sublks then the current
      137    14532                   definition for atitle should be deleted...
      138    14533        */
      139    14534    1     IF BLK$ -> P$B.NSUBLKS = 0
      140    14535    1        THEN
      141    14536    2           DO;
      142    14537    2              FPT_DELREC = CFPT_DELREC;
      143    14538    2              FPT_DELREC.V_ = VECTOR(FPT_DELREC.V);
      144    14539    2              FPT_DELREC.KEY_ = VECTOR(K_ATITLE);
      145    14540    2              FPT_DELREC.V.DCB# = M$IBEX1_NUM;
      146    14541    2              CALL M$DELREC (FPT_DELREC) ALTRET(NO_ATITLE);
      147    14542    2           END;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:6    
      148    14543    1        ELSE
      149    14544    2           DO;
      150    14545    2              TEMPBUF = BLK$ -> P$B.SUBLK$(0) -> P$S.TEXT;
      151    14546    2              FPT_WRITE = CFPT_WRITE;
      152    14547    2              FPT_WRITE.V_ = VECTOR(FPT_WRITE.V);
      153    14548    2              FPT_WRITE.KEY_ = VECTOR(K_ATITLE);
      154    14549    2              FPT_WRITE.BUF_ = VECTOR(SUBSTR(TEMPBUF,0,32));
      155    14550    2              FPT_WRITE.V.DCB# = M$IBEX1_NUM;
      156    14551    2              FPT_WRITE.V.ONEWKEY# = %YES#;
      157    14552    2              CALL M$WRITE(FPT_WRITE) ALTRET(E_ATITLE_WRT);
      158    14553    2           END;
      159    14554        /**/
      160    14555    1   NO_ATITLE:
      161    14556    1     FPT_CLOSE = CFPT_CLOSE;
      162    14557    1     FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V);
      163    14558    1     FPT_CLOSE.V.DISP# = %SAVE#;
      164    14559    1     FPT_CLOSE.V.DCB# = M$IBEX1_NUM;
      165    14560    1     CALL M$CLOSE (FPT_CLOSE) ALTRET(E_C$OPEN_S);
      166    14561    1     RETURN;
      167    14562    1   E_ATITLE_WRT:
      168    14563    1     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$TCB.ALT$->B$ALT.ERR,,
      169    14564    1           B$TCB.ALT$->B$ALT.DCB#);
      170    14565    1     FPT_CLOSE = CFPT_CLOSE;
      171    14566    1     FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V);
      172    14567    1     FPT_CLOSE.V.DISP# = %SAVE#;
      173    14568    1     FPT_CLOSE.V.DCB# = M$IBEX1_NUM;
      174    14569    1     CALL M$CLOSE (FPT_CLOSE) ALTRET(E_C$OPEN_S);
      175    14570    1     ALTRETURN;
      176    14571    1   E_C$OPEN_S:
      177    14572    1     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$JIT.USRERR,,M$IBEX1_NUM);
      178    14573    1     ALTRETURN;
      179    14574        %EJECT;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:7    
      180    14575    1   CPB$COUPLE:
      181    14576    1     ENTRY(P$PCB)   ALTRET;
      182    14577    1     RETURN;
      183    14578    1   CPB$DECOUPLE:
      184    14579    1     ENTRY(P$PCB)   ALTRET;
      185    14580    1     RETURN;
      186    14581        %EJECT;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:8    
      187    14582    1   CPB$LOCATE:
      188    14583    1     ENTRY(P$PCB)   ALTRET;
      189    14584    1     RETURN;
      190    14585        %EJECT;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:9    
      191    14586        /*********************************************************************/
      192    14587        /*F*       NAME:    CPB$MESSAGE
      193    14588                   PURPOSE: To process the MESSAGE command
      194    14589               REFERENCE: Programmers Reference Manual
      195    14590        */
      196    14591        /*D*   NAME:   CPB$MESSAGE
      197    14592               CALL:   CALL CPB$MESSAGE (P$PCB)
      198    14593               INPUT:  P$PCB - parse control block framing command.
      199    14594                   DESCRIPTION:   The text portion of the MESSAGE command
      200    14595                            is sent to the system operator's console.
      201    14596        */
      202    14597        /*********************************************************************/
      203    14598    1   CPB$MESSAGE:
      204    14599    1     ENTRY(P$PCB)   ALTRET;
      205    14600        /**/
      206    14601    1     BLK$ = P$PCB.OUT$;
      207    14602        /*
      208    14603             ***** If no options then ignore ...
      209    14604        */
      210    14605    1     IF BLK$ -> P$B.NSUBLKS = 0
      211    14606    1        THEN  /* Why bother the operator */
      212    14607    1           RETURN;
      213    14608        /*
      214    14609             ***** Initialize FPT_KEYIN ...
      215    14610        */
      216    14611    1     FPT_KEYIN = CFPT_KEYIN;
      217    14612    1     FPT_KEYIN.V_ = VECTOR(FPT_KEYIN.V);
      218    14613    1     FPT_KEYIN.MESS_ = VECTOR(TEMPBUF);
      219    14614    1     FPT_KEYIN.RESULTS_ = VECTOR(FID_ACCT);
      220    14615        /*
      221    14616             ***** Pull the information out of the parse tree ...
      222    14617        */
      223    14618    2     DO I = 0 TO BLK$ -> P$B.NSUBLKS - 1;
      224    14619    2        TEMP$ = BLK$ -> P$B.SUBLK$(I);
      225    14620    3        DO CASE (TEMP$ -> P$B.CODE);
      226    14621    3           CASE (MESS_OPT);
      227    14622    3              IF TEMP$ -> P$S.COUNT = 0
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:10   
      228    14623    3                 THEN   /* Dont bother the operator */
      229    14624    3                    RETURN;
      230    14625    3              TEMPBUF = TEMP$ -> P$S.TEXT;
      231    14626    3           CASE (MESS_ADMIN);
      232    14627    3              FPT_KEYIN.V.OCTYPE# = %TYPE_ADMIN#;
      233    14628    3           CASE (MESS_WSN);
      234    14629    3              FPT_KEYIN.V.WSN# = TEMP$ -> P$S.TEXT;
      235    14630    3           CASE (MESS_ADCOM);
      236    14631    3              FPT_KEYIN.V.OCTYPE# = %TYPE_SYSTEM#;
      237    14632    3           CASE (MESS_COMM);
      238    14633    3              FPT_KEYIN.V.OCTYPE# = %TYPE_COMM#;
      239    14634    3           CASE (MESS_DEVC);
      240    14635    3              FPT_KEYIN.V.OCTYPE# = %TYPE_DEVICE#;
      241    14636    3           CASE (MESS_DISK);
      242    14637    3              FPT_KEYIN.V.OCTYPE# = %TYPE_DISK#;
      243    14638    3           CASE (MESS_DLTA);
      244    14639    3              FPT_KEYIN.V.OCTYPE# = %TYPE_SYSTEM#;
      245    14640    3           CASE (MESS_LIBRN);
      246    14641    3              FPT_KEYIN.V.OCTYPE# = %TYPE_DEVICE#;
      247    14642    3           CASE (MESS_NONSYS);
      248    14643    3              FPT_KEYIN.V.OCTYPE# = %TYPE_ADMIN#;
      249    14644    3           CASE (MESS_SYS);
      250    14645    3              FPT_KEYIN.V.OCTYPE# = %TYPE_SYSTEM#;
      251    14646    3           CASE (MESS_TAPE);
      252    14647    3              FPT_KEYIN.V.OCTYPE# = %TYPE_TAPE#;
      253    14648    3           CASE (MESS_UR);
      254    14649    3              FPT_KEYIN.V.OCTYPE# = %TYPE_UR#;
      255    14650    3        END;   /* Do case ... end */
      256    14651    2     END;   /* Do i= ... end */
      257    14652        /*
      258    14653             ***** Write the msg...
      259    14654        */
      260    14655    1     CALL M$KEYIN (FPT_KEYIN) ALTRET(E_MESSAGE);
      261    14656    1     RETURN;
      262    14657    1   E_MESSAGE:
      263    14658    1     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$TCB.ALT$->B$ALT.ERR);
      264    14659    1     ALTRETURN;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:11   
      265    14660        %EJECT;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:12   
      266    14661        /*F*    NAME:    CPB$PLATEN
      267    14662                PURPOSE:    To process the PLATEN command.
      268    14663                REFERENCE:  Programmer's Reference Manual
      269    14664        */
      270    14665    1   CPB$PLATEN:
      271    14666    1     ENTRY(P$PCB)   ALTRET;
      272    14667        /**/
      273    14668    1     BLK$ = P$PCB.OUT$;
      274    14669        /*
      275    14670          ***** Set up FPT_PLATEN
      276    14671        */
      277    14672    1     FPT_PLATEN = CFPT_PLATEN;
      278    14673    1     FPT_PLATEN.V_ = VECTOR(FPT_PLATEN.V);
      279    14674    1     PLATEN_VLP = CVLP_PLATEN;
      280    14675    1     FPT_PLATEN.PLATEN_ = VECTOR(PLATEN_VLP) ;
      281    14676        /*
      282    14677          **** No options after platen indicates platen to be displayed
      283    14678        */
      284    14679    1     IF BLK$->P$B.NSUBLKS=0
      285    14680    1        THEN
      286    14681    2           DO;
      287    14682    2   DISPLAY_PLATEN:
      288    14683    2              TEMPBUF$=ADDR(TEMPBUF);
      289    14684    2              DEST$=TEMPBUF$;                     /*Dynamic ptr*/
      290    14685    2              TEMPBUF=PLATENHDR;
      291    14686    2              DEST$=PINCRC(DEST$,SIZEC(PLATENHDR));
      292    14687    2              TAB_VAL=6;
      293    14688    2              CALL M$GPLATEN(FPT_PLATEN) ALTRET(E_PLATEN) ;
      294    14689    2              IF DCBADDR(M$IBEX1_NUM)->F$DCB.FCD#
      295    14690    2                THEN
      296    14691    3                   DO;
      297    14692    3                     FPT_CLOSE = CFPT_CLOSE ;
      298    14693    3                     FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V) ;
      299    14694    3                     FPT_CLOSE.V.DCB#=M$IBEX1_NUM ;
      300    14695    3                     FPT_CLOSE.V.DISP#=%SAVE#;
      301    14696    3                     CALL M$CLOSE(FPT_CLOSE) WHENALTRETURN
      302    14697    4                                             DO ;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:13   
      303    14698    4                                             END ;
      304    14699    3                   END;
      305    14700        /*
      306    14701          **** Insert platen settings into image
      307    14702        */
      308    14703    2              TEMP = PLATEN_VLP.WIDTH# ;
      309    14704    2              IF PLATEN_VLP.EXTWID#
      310    14705    2               THEN
      311    14706    2                 TEMP = TEMP + 254 ;
      312    14707    2              CALL BINCHAR(TBUFF,TEMP);
      313    14708    2              CALL CPE$RZEROS(TBUFF,SIZEC(TBUFF),K);
      314    14709    2              CALL CPB$BLDIMAGE(TEMPBUF$,DEST$,ADDR(TBUFF),K,TAB_VAL)
      315    14710    2                   ALTRET(E_PLATEN_LIST);
      316    14711    2              DEST$=PINCRC(DEST$,2);                    /*Insert blanks*/
      317    14712    2              TBUFF='Length = ';
      318    14713    2              CALL CPB$BLDIMAGE(TEMPBUF$,DEST$,ADDR(TBUFF),SIZEC('Length = '),
      319    14714    2                   TAB_VAL) ALTRET(E_PLATEN_LIST);
      320    14715    2              CALL BINCHAR(TBUFF,PLATEN_VLP.LENGTH#);
      321    14716    2              CALL CPE$RZEROS(TBUFF,SIZEC(TBUFF),K);
      322    14717    2              CALL CPB$BLDIMAGE(TEMPBUF$,DEST$,ADDR(TBUFF),K,TAB_VAL)
      323    14718    2                   ALTRET(E_PLATEN_LIST);
      324    14719    2              DEST$=PINCRC(DEST$,2);                    /*Insert blanks*/
      325    14720    2              TBUFF='Limbo = ';
      326    14721    2              CALL CPB$BLDIMAGE(TEMPBUF$,DEST$,ADDR(TBUFF),SIZEC('Limbo = '),
      327    14722    2                   TAB_VAL) ALTRET(E_PLATEN_LIST);
      328    14723    2              CALL BINCHAR(TBUFF,PLATEN_VLP.LIMBO#);
      329    14724    2              CALL CPE$RZEROS(TBUFF,SIZEC(TBUFF),K);
      330    14725    2              CALL CPB$BLDIMAGE(TEMPBUF$,DEST$,ADDR(TBUFF),K,TAB_VAL)
      331    14726    2                   ALTRET(E_PLATEN_LIST);
      332    14727    2              DEST$=PINCRC(DEST$,2);                    /*Insert blanks*/
      333    14728    2              TBUFF='FirstLine = ';
      334    14729    2              CALL CPB$BLDIMAGE(TEMPBUF$,DEST$,ADDR(TBUFF),SIZEC('FirstLine = '),
      335    14730    2                   TAB_VAL) ALTRET(E_PLATEN_LIST);
      336    14731    2              CALL BINCHAR(TBUFF,PLATEN_VLP.FIRSTLINE#);
      337    14732    2              CALL CPE$RZEROS(TBUFF,SIZEC(TBUFF),K);
      338    14733    2              CALL CPB$BLDIMAGE(TEMPBUF$,DEST$,ADDR(TBUFF),K,TAB_VAL)
      339    14734    2                   ALTRET(E_PLATEN_LIST);
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:14   
      340    14735    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,TEMPBUF$);
      341    14736    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=TEMPBUF$;
      342    14737    2              CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(E_PLATEN_LIST);
      343    14738    2              RETURN;
      344    14739    2           END;
      345    14740    1     IF BLK$->P$B.SUBLK$(0)->P$B.CODE = PL_UCNN
      346    14741    1         THEN
      347    14742    2             DO ;
      348    14743    2               STRM = BLK$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$S.TEXT ;
      349    14744    2               FPT_OPEN = CFPT_OPEN ;
      350    14745    2               FPT_OPEN.V_ = VECTOR(FPT_OPEN.V) ;
      351    14746    2               FPT_OPEN.V.DCB# = M$IBEX1_NUM ;
      352    14747    2               DCB# = M$IBEX1_NUM ;
      353    14748    2               CALL CONCAT(FPT_OPEN.V.RES#, 'UC', STRM) ;
      354    14749    2               FPT_OPEN.V.ORG# = %TERMINAL# ;
      355    14750    2               CALL M$OPEN (FPT_OPEN) WHENALTRETURN
      356    14751    3                             DO ;
      357    14752    3                               IF B$TCB.ALT$ -> B$ALT.ERR.CODE ~= %E$ORGNOTCOM
      358    14753    3                                 THEN
      359    14754    3                                   GOTO E_PLATEN ;
      360    14755    3                               CALL CPB$FIND_UCNN(STRM, DCB#) ALTRET(E_PLATEN_LIST) ;
      361    14756    3                             END ; /* Whenaltreturn */
      362    14757    2               FPT_PLATEN.V.DCB# = DCB# ;
      363    14758    2               IF BLK$->P$B.NSUBLKS = 1
      364    14759    2                 THEN
      365    14760    2                   GOTO DISPLAY_PLATEN ;
      366    14761    2               I = 1 ; /* Bump past UCnn option. */
      367    14762    2             END ; /* Then Do */
      368    14763    1         ELSE
      369    14764    1             I = 0 ; /* Start with the first option */
      370    14765        /*
      371    14766             ***** New platen values...
      372    14767        */
      373    14768    2     DO WHILE(I < BLK$->P$B.NSUBLKS);
      374    14769    2        P$ = BLK$->P$B.SUBLK$(I);
      375    14770    2        CALL CHARBIN(TEMP,P$->P$S.TEXT);
      376    14771    3        DO CASE(P$->P$B.CODE);
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:15   
      377    14772        /**/
      378    14773    3         CASE(PL_WIDTH);
      379    14774    3           IF TEMP > 254
      380    14775    3              THEN
      381    14776    4                 DO;
      382    14777    4                    PLATEN_VLP.EXTWID# = %YES#;
      383    14778    4                    TEMP = TEMP - 254;
      384    14779    4                 END;
      385    14780    3           PLATEN_VLP.WIDTH# = TEMP;
      386    14781        /**/
      387    14782    3         CASE(PL_LENGTH);
      388    14783    3           PLATEN_VLP.LENGTH# = TEMP;
      389    14784        /**/
      390    14785    3         CASE(PL_LIMBO);
      391    14786    3           PLATEN_VLP.LIMBO# = TEMP;
      392    14787        /**/
      393    14788    3         CASE(PL_1STLINE);
      394    14789    3           PLATEN_VLP.FIRSTLINE# = TEMP;
      395    14790    3         END;
      396    14791        /**/
      397    14792    2        I = I + 1;
      398    14793    2     END;
      399    14794    1     CALL M$PLATEN(FPT_PLATEN) ALTRET(E_PLATEN);
      400    14795    1     IF DCBADDR(M$IBEX1_NUM)->F$DCB.FCD#
      401    14796    1         THEN
      402    14797    2             DO;
      403    14798    2               FPT_CLOSE = CFPT_CLOSE ;
      404    14799    2               FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V) ;
      405    14800    2               FPT_CLOSE.V.DCB#=M$IBEX1_NUM ;
      406    14801    2               FPT_CLOSE.V.DISP#=%SAVE#;
      407    14802    2               CALL M$CLOSE(FPT_CLOSE) WHENALTRETURN
      408    14803    3                                       DO ;
      409    14804    3                                       END ;
      410    14805    2             END;
      411    14806    1     RETURN;
      412    14807    1   E_PLATEN:
      413    14808        /* ****    When running in batch mode, refrain from outputting msge.
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:16   
      414    14809                   Indicating terminal control pmme's are illegal if not in t/s
      415    14810                   mode.                                 */
      416    14811    1     IF B$TCB.ALT$ -> B$ALT.ERR.CODE = %E$NOTTS
      417    14812    1        THEN
      418    14813    1           RETURN;
      419    14814    1     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$TCB.ALT$->B$ALT.ERR);
      420    14815    1   E_PLATEN_LIST:
      421    14816    1     IF DCBADDR(M$IBEX1_NUM)->F$DCB.FCD#
      422    14817    1        THEN
      423    14818    2           DO;
      424    14819    2             FPT_CLOSE = CFPT_CLOSE ;
      425    14820    2             FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V) ;
      426    14821    2             FPT_CLOSE.V.DCB#=M$IBEX1_NUM ;
      427    14822    2             FPT_CLOSE.V.DISP#=%SAVE#;
      428    14823    2             CALL M$CLOSE(FPT_CLOSE) WHENALTRETURN
      429    14824    3                                       DO ;
      430    14825    3                                       END ;
      431    14826    2           END;
      432    14827    1     ALTRETURN;
      433    14828        %EJECT;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:17   
      434    14829        /*F*    NAME:      CPB$REPORT
      435    14830                PURPOSE:   To process the REPORT command.
      436    14831                REFERENCE: Programmers Reference Manual
      437    14832        */
      438    14833    1   CPB$REPORT:
      439    14834    1     ENTRY(P$PCB) ALTRET;
      440    14835        /**/
      441    14836    1     BLK$ = P$PCB.OUT$;
      442    14837    1     IF BLK$ -> P$B.NSUBLKS = 0
      443    14838    1        THEN
      444    14839    2           DO; /* Display level of reporting */
      445    14840    2              TEMPBUF$ = ADDR(TEMPBUF);
      446    14841    2              DEST$ = TEMPBUF$;
      447    14842    2              TEMPBUF = REPORTHDR;
      448    14843    2              DEST$ = PINCRC(DEST$,SIZEC(REPORTHDR));
      449    14844    2              TAB_VAL = 6;
      450    14845    2              TBUFF = 'Job = ';
      451    14846    2              CALL CPB$BLDIMAGE(TEMPBUF$,DEST$,ADDR(TBUFF),SIZEC('Job = '),
      452    14847    2                    TAB_VAL) ALTRET(E_REPORT);
      453    14848    2              TEMP = B$JIT.JSLEV;
      454    14849    2              CALL PUT_LEVEL(TEMP);
      455    14850    2              DEST$ = PINCRC(DEST$,2);
      456    14851    2              TBUFF = 'Step = ';
      457    14852    2              CALL CPB$BLDIMAGE(TEMPBUF$,DEST$,ADDR(TBUFF),SIZEC('Step = '),
      458    14853    2                    TAB_VAL) ALTRET(E_REPORT);
      459    14854    2              TEMP = B$JIT.SSLEV;
      460    14855    2              CALL PUT_LEVEL(TEMP);
      461    14856    2              DEST$ = PINCRC(DEST$,2);
      462    14857    2              TBUFF = 'Proprietary = ';
      463    14858    2              CALL CPB$BLDIMAGE(TEMPBUF$,DEST$,ADDR(TBUFF),SIZEC('Proprietary = '),
      464    14859    2                    TAB_VAL) ALTRET(E_REPORT);
      465    14860    2              TEMP = B$JIT.PSLEV;
      466    14861    2              CALL PUT_LEVEL(TEMP);
      467    14862    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,TEMPBUF$);
      468    14863    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=TEMPBUF$;
      469    14864    2              CALL CPE$LISTOUT (SEG$2.FPT_WRITE$) ALTRET(E_REPORT);
      470    14865    2              RETURN;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:18   
      471    14866    2           END;
      472    14867        /*
      473    14868             ***** Only allowed to turn step reporting on/off when not at
      474    14869                   job step.
      475    14870        */
      476    14871        /*E*    ERROR: CPB-E$RPTATJS-0
      477    14872              MESSAGE: Can't change STEP/PROPRIETARY reporting to/from NONE during job step.
      478    14873        */
      479    14874        /*
      480    14875             ***** Set B$JIT.??LEV to reflect the level desired...
      481    14876        */
      482    14877    1     TEMP2 = BLK$ -> P$B.SUBLK$(0) -> P$B.CODE;   /* TYPE OF REPORT */
      483    14878    1     IF BLK$ -> P$B.NSUBLKS = 1  THEN
      484    14879    2           DO;   /* Backward compatablity code */
      485    14880    2              TEMP3 = BLK$ -> P$B.SUBLK$(0) -> P$B.CODE;
      486    14881    2              CPOS = BLK$ -> P$B.SUBLK$(0) -> P$B.CPOS;
      487    14882    2           END;   /* Backward compatablity code */
      488    14883    1     ELSE
      489    14884    2           DO;
      490    14885    2              TEMP3 = BLK$ -> P$B.SUBLK$(1) -> P$B.CODE;
      491    14886    2              CPOS = BLK$ -> P$B.SUBLK$(1) -> P$B.CPOS;
      492    14887    2           END;
      493    14888        /*
      494    14889             ***** It is not possible to change the level of reporting
      495    14890                   for STEP or PROPRIATARY reports if no stats snapshot
      496    14891                   was done before the rununit was invoked. And if a
      497    14892                   snapshot was done then you may not turn off the report.
      498    14893                   This would cause an extraneous snapshot to lay around
      499    14894                   and would confuse accounting at logoff time ...
      500    14895        */
      501    14896    2     DO CASE(TEMP3);
      502    14897    2      CASE (RE_FULL);
      503    14898    2        IF NOT(B$JIT.CPFLAGS1 & %CP_JSTEP#)
      504    14899    2           THEN
      505    14900    3              DO;
      506    14901    3                 IF B$JIT.SSLEV = %AZ_NONE#
      507    14902    3                 AND (TEMP2 = RE_STEP OR TEMP2 = RE_ALL)
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:19   
      508    14903    3                    THEN   /* Not allowed to change */
      509    14904    4                       DO;
      510    14905    4                          CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_RPTATJS);
      511    14906    4                          ALTRETURN;
      512    14907    4                       END;
      513    14908    3                 IF B$JIT.PSLEV = %AZ_NONE#
      514    14909    3                 AND (TEMP2 = RE_PROP OR TEMP2 = RE_ALL)
      515    14910    3                    THEN   /* Not allowed to change */
      516    14911    4                       DO;
      517    14912    4                          CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_RPTATJS);
      518    14913    4                          ALTRETURN;
      519    14914    4                       END;
      520    14915    3              END;
      521    14916    2        TEMP = %AZ_ALL#;
      522    14917    2      CASE (RE_SUMMARY);
      523    14918    2        IF NOT(B$JIT.CPFLAGS1 & %CP_JSTEP#)
      524    14919    2           THEN
      525    14920    3              DO;
      526    14921    3                 IF B$JIT.SSLEV = %AZ_NONE#
      527    14922    3                 AND (TEMP2 = RE_STEP OR TEMP2 = RE_ALL)
      528    14923    3                    THEN   /* Not allowed to change */
      529    14924    4                       DO;
      530    14925    4                          CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_RPTATJS);
      531    14926    4                          ALTRETURN;
      532    14927    4                       END;
      533    14928    3                 IF B$JIT.PSLEV = %AZ_NONE#
      534    14929    3                 AND (TEMP2 = RE_PROP OR TEMP2 = RE_ALL)
      535    14930    3                    THEN   /* Not allowed to change */
      536    14931    4                       DO;
      537    14932    4                          CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_RPTATJS);
      538    14933    4                          ALTRETURN;
      539    14934    4                       END;
      540    14935    3              END;
      541    14936    2        TEMP = %AZ_SUMMARY#;
      542    14937    2      CASE (RE_NONE);
      543    14938    2        IF NOT(B$JIT.CPFLAGS1 & %CP_JSTEP#)
      544    14939    2           THEN
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:20   
      545    14940    3              DO;
      546    14941    3                 IF B$JIT.SSLEV ~= %AZ_NONE#
      547    14942    3                 AND (TEMP2 = RE_STEP OR TEMP2 = RE_ALL)
      548    14943    3                    THEN   /* Not allowed to change */
      549    14944    4                       DO;
      550    14945    4                          CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_RPTATJS);
      551    14946    4                          ALTRETURN;
      552    14947    4                       END;
      553    14948    3                 IF B$JIT.PSLEV ~= %AZ_NONE#
      554    14949    3                 AND (TEMP2 = RE_PROP OR TEMP2 = RE_ALL)
      555    14950    3                    THEN   /* Not allowed to change */
      556    14951    4                       DO;
      557    14952    4                          CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_RPTATJS);
      558    14953    4                          ALTRETURN;
      559    14954    4                       END;
      560    14955    3              END;
      561    14956    2        TEMP = %AZ_NONE#;
      562    14957    2      END; /* do case ... end */
      563    14958        /*
      564    14959          **** This code has been included for backward compatibility.
      565    14960        */
      566    14961    1     IF BLK$ -> P$B.NSUBLKS = 1
      567    14962    1        THEN
      568    14963    2           DO;   /* Handle old form */
      569    14964    2              IF NOT(B$JIT.CPFLAGS1 & %CP_JSTEP#)
      570    14965    2              AND ((B$JIT.SSLEV = %AZ_NONE# AND TEMP ~= %AZ_NONE#)
      571    14966    2              OR (TEMP = %AZ_NONE# AND B$JIT.SSLEV ~= TEMP))
      572    14967    2                 THEN   /* Not allowed to change */
      573    14968    3                    DO;
      574    14969    3                       CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_RPTATJS);
      575    14970    3                       ALTRETURN;
      576    14971    3                    END;
      577    14972    2                 ELSE   /* Ok to change */
      578    14973    2                    B$JIT.SSLEV = TEMP;
      579    14974    2           END;   /* Handle old form */
      580    14975    1     ELSE
      581    14976    2        DO;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:21   
      582    14977    3     DO CASE (TEMP2);
      583    14978    3      CASE(RE_JOB);
      584    14979    3        B$JIT.JSLEV = TEMP;
      585    14980    3      CASE(RE_STEP);
      586    14981    3        B$JIT.SSLEV = TEMP;
      587    14982    3      CASE(RE_PROP);
      588    14983    3        B$JIT.PSLEV = TEMP;
      589    14984    3      CASE(RE_ALL);
      590    14985    3        B$JIT.JSLEV = TEMP;
      591    14986    3        B$JIT.SSLEV = TEMP;
      592    14987    3        B$JIT.PSLEV = TEMP;
      593    14988    3     END;
      594    14989    2        END;
      595    14990    1     RETURN;
      596    14991    1   E_REPORT:
      597    14992    1     ALTRETURN;
      598    14993        %EJECT;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:22   
      599    14994        /*F*    NAME:      CPB$STATUS
      600    14995                PURPOSE:   To process the STATUS command.
      601    14996                REFERENCE: Programmers Reference Manual
      602    14997        */
      603    14998    1   CPB$STATUS:
      604    14999    1     ENTRY(P$PCB)   ALTRET;
      605    15000        /*
      606    15001             ***** Save B$JIT.JSLEV
      607    15002                   set by report command...
      608    15003        */
      609    15004    1     I = B$JIT.JSLEV;
      610    15005    1     IF P$PCB.OUT$ -> P$B.NSUBLKS ~= 0
      611    15006    1        THEN
      612    15007    2           DO CASE (P$PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE);
      613    15008    2            CASE (RE_FULL);
      614    15009    2              B$JIT.JSLEV = %AZ_ALL#;
      615    15010    2            CASE (RE_SUMMARY);
      616    15011    2              B$JIT.JSLEV = %AZ_SUMMARY#;
      617    15012    2            CASE (RE_NONE);
      618    15013    2              RETURN;   /* Dont bother */
      619    15014    2            END;
      620    15015    1        ELSE /* use %AZ_SUMMARY# as default */
      621    15016    1           B$JIT.JSLEV = %AZ_SUMMARY#;
      622    15017        /*
      623    15018             ***** Get M$LL for LOGOFF to write thru ...
      624    15019        */
      625    15020    1     CALL CPC$OPEN_LL;
      626    15021        /*
      627    15022             ***** Call AZA$LOGOFF to write the status message...
      628    15023        */
      629    15024    1     LOGOFF.CODE = %AZ$STATUS;
      630    15025    1     LOGOFF.ERR = 0;
      631    15026    1     LOGOFF.DCB1 = M$IBEX1_NUM;
      632    15027    1     LOGOFF.DCB_LL = SEG$2.LLDCB#;
      633    15028    1     CALL AZA$LOGOFF (LOGOFF) ALTRET(E_STATUS);
      634    15029    2     DO WHILE(%NO#);
      635    15030    2   E_STATUS:
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:23   
      636    15031    2        B$JIT.JSLEV = I;
      637    15032    2        CALL CPC$WRITEMSGE(B$JIT.USRERR,B$JIT.USRDCB);
      638    15033    2        IF LOGOFF.ERR ~= %AZ$STATSERR  THEN
      639    15034    2           CALL CPA$BYE;
      640    15035    2      END;
      641    15036        /*
      642    15037             ***** restore B$JIT.JSLEV ...
      643    15038        */
      644    15039    1     B$JIT.JSLEV = I;
      645    15040    1     RETURN;
      646    15041        %EJECT;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:24   
      647    15042        /*F*    NAME:    CPB$TITLE
      648    15043                PURPOSE:    To process the TITLE command in IBEX.
      649    15044                REFERENCE:  Programmer's Reference Manual
      650    15045        */
      651    15046    1   CPB$TITLE:
      652    15047    1     ENTRY(P$PCB)   ALTRET;
      653    15048        /**/
      654    15049    1     FPT_LDEV = CFPT_LDEV;
      655    15050    1     FPT_LDEV.V_ = VECTOR(FPT_LDEV.V);
      656    15051    1     FPT_LDEV.V.STREAMNAME# = 'LP01';
      657    15052    1     FPT_LDEV.V.CONTINUE# = %YES#;
      658    15053    1     BLK$ = P$PCB.OUT$;
      659    15054    1     IF BLK$->P$B.NSUBLKS = 0
      660    15055    1        THEN
      661    15056    1           FPT_LDEV.HDR_ = VECTOR(ERASE);
      662    15057    1        ELSE
      663    15058    2           DO;
      664    15059    2              VLP_HDR = CVLP_HDR;
      665    15060    2              VLP_HDR.TITL.L# = BLK$ -> P$B.SUBLK$(0) -> P$S.COUNT;
      666    15061    2              VLP_HDR.TITL.TITLE# = SUBSTR(BLK$ -> P$B.SUBLK$(0) -> P$S.TEXT,
      667    15062    2                   0,VLP_HDR.TITL.L#);
      668    15063    2              IF VLP_HDR.TITL.L# = 0
      669    15064    2                 THEN
      670    15065    2                    FPT_LDEV.HDR_ = VECTOR(ERASE);
      671    15066    2                 ELSE
      672    15067    2                    FPT_LDEV.HDR_ = VECTOR(VLP_HDR);
      673    15068    2           END;
      674    15069        /**/
      675    15070    1     CALL M$LDEV(FPT_LDEV) ALTRET(E_TITLE);
      676    15071    1     RETURN;
      677    15072        /**/
      678    15073    1   E_TITLE:
      679    15074    1     ALTRETURN;
      680    15075                   %EJECT;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:25   
      681    15076        /********************************************************************/
      682    15077        /*I*   NAME: PUT_LEVEL
      683    15078               PURPOSE: Puts the report level into the print image for the REPORT command
      684    15079               DESCRIPTION: Puts the report level (NONE,FULL,SUMMARY) into the print
      685    15080                         image for the REPORT command.
      686    15081        */
      687    15082        /********************************************************************/
      688    15083    1   PUT_LEVEL: PROC(TEMP) ALTRET;
      689    15084    2   DCL TEMP UBIN WORD;
      690    15085    3     DO CASE(TEMP);
      691    15086    3        CASE(%AZ_NONE#);
      692    15087    3           TBUFF = 'None';
      693    15088    3        CASE(%AZ_ALL#);
      694    15089    3           TBUFF = 'Full';
      695    15090    3        CASE(%AZ_SUMMARY#);
      696    15091    3           TBUFF = 'Summary';
      697    15092    3     END;
      698    15093    2     CALL INDEX(K,' ',TBUFF);
      699    15094    2     CALL CPB$BLDIMAGE(TEMPBUF$,DEST$,ADDR(TBUFF),K,
      700    15095    2           TAB_VAL) ALTRET(E_PUT_LEVEL);
      701    15096    2     RETURN;
      702    15097    2   E_PUT_LEVEL:
      703    15098    2     ALTRETURN;
      704    15099    2   END PUT_LEVEL;
      705    15100                %EJECT;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:26   
      706    15101    1   END CPB$IBEX1;

PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:27   
--  Include file information  --

   CP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_PERR_C.:E05TOU  is referenced.
   CP_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_MACROS_C.:E05TOU  is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   AZ_SUBS_C.:E05TOU  is referenced.
   G_JIT_M.:E05TOU  is referenced.
   AZ_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure CPB$IBEX1.

   Procedure CPB$IBEX1 requires 1361 words for executable code.
   Procedure CPB$IBEX1 requires 406 words of local(AUTO) storage.

    No errors detected in file CPB$IBEX1.:E05TSI    .

PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:28   

 Object Unit name= CPB$IBEX1                                  File name= CPB$IBEX1.:E05TOU
 UTS= JUL 29 '97 11:21:01.96 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     32     40  CPB$IBEX1
    2   Proc  even  none  1361   2521  CPB$IBEX1
    3  RoData even  none    31     37  CPB$IBEX1

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        1  CPB$IBEX1
     2      3          yes     yes      Std        1  CPB$ATITLE
     2    204          yes     yes      Std        1  CPB$COUPLE
     2    207          yes     yes      Std        1  CPB$DECOUPLE
     2    212          yes     yes      Std        1  CPB$LOCATE
     2    215          yes     yes      Std        1  CPB$MESSAGE
     2    450          yes     yes      Std        1  CPB$PLATEN
     2   1411          yes     yes      Std        1  CPB$REPORT
     2   2233          yes     yes      Std        1  CPB$STATUS
     2   2355          yes     yes      Std        1  CPB$TITLE
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:29   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 CPC$OPEN_S
         yes           Std       3 CPE$RZEROS
 yes     yes           Std       2 CPB$FIND_UCNN
 yes     yes           Std       5 CPB$BLDIMAGE
 yes     yes           Std       1 CPE$LISTOUT
         yes           Std       5 CXP$POSTERR
         yes           Std       6 CPC$WRITEMSGE
         yes           Std       0 CPC$OPEN_LL
 yes     yes           Std       1 AZA$LOGOFF
 yes     yes           Std       1 CPA$BYE
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  CFPT_OPEN                             CFPT_CLOSE
     CFPT_WRITE                            CFPT_DELREC                           CFPT_KEYIN
     CFPT_LDEV                             CVLP_HDR                              CFPT_PLATEN
     CVLP_PLATEN                      r    SEG2$                            r    B$JIT$
r    B$TCB$                                M$IBEX1_NUM                           K_ATITLE
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ROSID                                 NULLSID                               ISSID
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:30   


        1        1        /*M* LDEV and Accounting cmds, PLATEN, CANCEL, CHECK, MESSAGE, SET/ADJUST/RESET */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,DFC */
        8        8        /*P*   NAME:   CPB$IBEX1
        9        9               PURPOSE: To perform all the required operations in  the execution
       10       10                       of selected IBEX commands.
       11       11               DESCRIPTION:
       12       12               REFERENCE: Programmers Reference Manual
       13       13        */
       14       14        /**********************************************************************/
       15       15        CPB$IBEX1:
       16       16          PROC(P$PCB)    ALTRET;

     16  2 000000   000000 700200 xent  CPB$IBEX1    TSX0  ! X66_AUTO_1
         2 000001   000626 000001                    ZERO    406,1
         2 000002   000005 710000 2                  TRA     s:14528

       17       17                   %PLIST;
       18       18                   %INCLUDE CP_6;
       19       99                   %INCLUDE AZ_MACRO_C;
       20     2686                   %INCLUDE AZ_SUBS_C;
       21     2755                   %INCLUDE B$JIT;
       22     3045                   %INCLUDE B_STRINGS_C;
       23     3174                   %INCLUDE B_MACROS_C;
       24     3285                   %INCLUDE CP_MACROS_C;
       25     4037                   %INCLUDE XU_MACRO_C;
       26     7143                   %INCLUDE CP_SUBS_C;
       27     8060                   %INCLUDE CP_PERR_C;
       28     8398                   %INCLUDE CP_6_SUBS;
       29     8938                   %INCLUDE B_ERRORS_C;
       30    10065                   %INCLUDE OC_SUBS_C;
       31    10796                  %INCLUDE CP_DATA_R;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:31   
       32    13359             /***** Ptr variable declarations *****/
       33    13360    1   DCL P$ PTR;
       34    13361    1   DCL BLK$ PTR;
       35    13362    1   DCL TEMP$ PTR;
       36    13363    1   DCL TEMPBUF$ PTR;
       37    13364    1   DCL DEST$ PTR;
       38    13365             /***** External procedure (entry) declarations *****/
       39    13366    1   DCL AZA$LOGOFF ENTRY(1) ALTRET;
       40    13367    1   DCL CPA$BYE ENTRY(1) ALTRET;
       41    13368    1   DCL CPB$FIND_UCNN ENTRY(2) ALTRET;
       42    13369    1   DCL CPC$WRITEMSGE ENTRY(6);
       43    13370    1   DCL CPC$OPEN_LL ENTRY;
       44    13371    1   DCL CPC$OPEN_S ENTRY(1) ALTRET;
       45    13372    1   DCL CPE$RZEROS ENTRY(3);
       46    13373    1   DCL CPB$BLDIMAGE ENTRY(5) ALTRET;
       47    13374    1   DCL CPE$LISTOUT ENTRY(1) ALTRET;
       48    13375    1   DCL CXP$POSTERR ENTRY(5);
       49    13376             /***** Based STRUCTURES *****/
       50    13377        %SEG$2;
       51    13437        %B$TCB (STCLASS="BASED(B$TCB$)");
       52    13440        %B$ALT;
       53    13448             /***** Character string declarations *****/
       54    13449    1   DCL PLATENHDR CONSTANT CHAR(19) INIT('   Platen: Width = ');
       55    13450    1   DCL REPORTHDR CONSTANT CHAR(11) INIT('   Report: ');
       56    13451    1   DCL  1  TMDATE AUTO,
       57    13452    1        2  COUNT UBIN BYTE UNAL,
       58    13453    1        2  DATE CHAR(10),
       59    13454    1        2  *  CHAR(2),
       60    13455    1        2  TIME,
       61    13456    1           3  HR  CHAR(3),
       62    13457    1           3  MIN CHAR(2),
       63    13458    1           3  SEC CHAR(3),
       64    13459    1           3  MSEC CHAR(3);
       65    13460    1     DCL TMDATEBUF REDEF TMDATE CHAR(24);
       66    13461    1   DCL TBUFF REDEF TMDATE CHAR(24);
       67    13462    1   DCL TEMPBUF CHAR(256);
       68    13463    1   DCL  1  TEMP_BUF REDEF TEMPBUF,
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:32   
       69    13464    1        2  COUNT UBIN BYTE UNAL,
       70    13465    1        2  TEXT CHAR(255);
       71    13466             /***** Word declarations *****/
       72    13467    1   DCL I SBIN;
       73    13468    1   DCL J SBIN;
       74    13469    1   DCL K SBIN;
       75    13470    1   DCL TEMP UBIN WORD;
       76    13471    1   DCL TEMP2 UBIN WORD;
       77    13472    1   DCL TEMP3 UBIN WORD;
       78    13473    1   DCL TAB_VAL UBIN WORD;
       79    13474    1   DCL CPOS UBIN WORD AUTO;
       80    13475    1   DCL STRM CHAR(2) AUTO;
       81    13476    1   DCL DCB# UBIN WORD AUTO ;
       82    13477             /***** Based FPTS *****/
       83    13478        %FPT_WRITE (FPTN=FPT$WRITE,STCLASS=BASED);
       84    13509        %FPT_CLOSE (FPTN=FPT$CLOSE,STCLASS=BASED);
       85    13551        %FPT_FID (FPTN=FPT$FID,STCLASS=BASED);
       86    13574        %F$DCB (DCBN=F$DCB);
       87    13631             /***** Auto FPTS *****/
       88    13632        %LOGOFF$PARAM (NAME=LOGOFF,STCLASS=AUTO);
       89    13673        %FPT_OPEN (FPTN=FPT_OPEN,STCLASS=AUTO);
       90    13782        %FPT_WRITE (FPTN=FPT_WRITE,STCLASS=AUTO);
       91    13813        %FPT_CLOSE (FPTN=FPT_CLOSE,STCLASS=AUTO);
       92    13855        %FPT_DELREC (FPTN=FPT_DELREC,STCLASS=AUTO);
       93    13874        %FPT_KEYIN (FPTN=FPT_KEYIN,STCLASS=AUTO);
       94    13893        %FPT_LDEV (FPTN=FPT_LDEV,STCLASS=AUTO);
       95    13918        %FPT_PLATEN (FPTN=FPT_PLATEN,STCLASS=AUTO);
       96    13943             /***** Based VLPS *****/
       97    13944             /***** Auto VLPS *****/
       98    13945        %VLP_ACCT (FPTN=FID_ACCT,STCLASS=AUTO);
       99    13958        %VLP_HDR (FPTN=VLP_HDR,LEN=511,STCLASS=AUTO);
      100    13974        %VLP_PLATEN (FPTN=PLATEN_VLP,STCLASS=AUTO);
      101    13996             /***** Error codes *****/
      102    13997        %ERR_CODE (NAME=E_RPTATJS,MID#=CPB$IBEXMID,CODE#=E$RPTATJS,STCLASS=CONSTANT);
      103    14017                   %EJECT;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:33   
      104    14018        /*         Parsing macros                        */
      105    14019        %PLIST;
      106    14020        %PARSE$OUT(NAME=P$B,STCLASS=BASED);
      107    14065        %PARSE$SYM(NAME=P$S,STCLASS=BASED);
      108    14103        %P$PCB(NAME=P$PCB,STCLASS="");
      109    14304        %P$PCB(NAME=PCB,STCLASS=AUTO);
      110    14505                   %EJECT;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:34   
      111    14506        /*********************************************************************/
      112    14507        /*F*    NAME:       CPB$ATITLE
      113    14508                PURPOSE:  To process the ATITLE command
      114    14509                DESCRIPTION:  The title portion of the ATITLE command is extracted
      115    14510                         from the command line and written to the *S file with the
      116    14511                         key 'ATITLE'.
      117    14512               REFERENCE: Programmers Reference Manual
      118    14513        */
      119    14514        /*D*   NAME:   CPB$ATITLE
      120    14515               CALL:   CALL CPB$ATITLE (P$PCB)
      121    14516               INPUT:  P$PCB - parse control block framing command.
      122    14517               OUTPUT:
      123    14518               DESCRIPTION: The ATITLE command writes a record into the *S file
      124    14519                      which will be associated with accounting information.
      125    14520        */
      126    14521        /*********************************************************************/
      127    14522    1   CPB$ATITLE:
      128    14523    1     ENTRY(P$PCB)   ALTRET;

  14523  2 000003   000000 700200 xent  CPB$ATITLE   TSX0  ! X66_AUTO_1
         2 000004   000626 000001                    ZERO    406,1

      129    14524        /**/
      130    14525        /*
      131    14526        *****   Begin procedure
      132    14527        */
      133    14528    1     BLK$ = P$PCB.OUT$;

  14528  2 000005   200003 470500                    LDP0    @P$PCB,,AUTO
         2 000006   000003 236100                    LDQ     3,,PR0
         2 000007   200005 756100                    STQ     BLK$,,AUTO

      134    14529    1     CALL CPC$OPEN_S(M$IBEX1_NUM) ALTRET(E_C$OPEN_S);

  14529  2 000010   000000 630400 3                  EPPR0   0
         2 000011   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000012   000000 701000 xent               TSX1    CPC$OPEN_S
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:35   
         2 000013   000163 702000 2                  TSX2    E_C$OPEN_S

      135    14530        /*
      136    14531             ***** If there are no sublks then the current
      137    14532                   definition for atitle should be deleted...
      138    14533        */
      139    14534    1     IF BLK$ -> P$B.NSUBLKS = 0

  14534  2 000014   200005 470500                    LDP0    BLK$,,AUTO
         2 000015   000001 220100                    LDX0    1,,PR0
         2 000016   000040 601000 2                  TNZ     s:14545

      140    14535    1        THEN
      141    14536    2           DO;

      142    14537    2              FPT_DELREC = CFPT_DELREC;

  14537  2 000017   000100 100400                    MLR     fill='000'O
         2 000020   000000 000050 xsym               ADSC9   CFPT_DELREC              cn=0,n=40
         2 000021   200304 000050                    ADSC9   FPT_DELREC,,AUTO         cn=0,n=40

      143    14538    2              FPT_DELREC.V_ = VECTOR(FPT_DELREC.V);

  14538  2 000022   000001 235000 3                  LDA     1
         2 000023   200620 452500                    STP2    @TEMP+1,,AUTO
         2 000024   200620 236100                    LDQ     @TEMP+1,,AUTO
         2 000025   000314 036003                    ADLQ    204,DU
         2 000026   200304 757100                    STAQ    FPT_DELREC,,AUTO

      144    14539    2              FPT_DELREC.KEY_ = VECTOR(K_ATITLE);

  14539  2 000027   000002 237000 3                  LDAQ    2
         2 000030   200306 757100                    STAQ    FPT_DELREC+2,,AUTO

      145    14540    2              FPT_DELREC.V.DCB# = M$IBEX1_NUM;

  14540  2 000031   000000 720000 xsym               LXL0    M$IBEX1_NUM
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:36   
         2 000032   200314 740100                    STX0    FPT_DELREC+8,,AUTO

      146    14541    2              CALL M$DELREC (FPT_DELREC) ALTRET(NO_ATITLE);

  14541  2 000033   200304 630500                    EPPR0   FPT_DELREC,,AUTO
         2 000034   440002 713400                    CLIMB   alt,+16386
         2 000035   401400 401760                    pmme    nvectors=4
         2 000036   000076 702000 2                  TSX2    NO_ATITLE

      147    14542    2           END;

  14542  2 000037   000076 710000 2                  TRA     NO_ATITLE

      148    14543    1        ELSE
      149    14544    2           DO;

      150    14545    2              TEMPBUF = BLK$ -> P$B.SUBLK$(0) -> P$S.TEXT;

  14545  2 000040   000003 471500                    LDP1    3,,PR0
         2 000041   100004 236100                    LDQ     4,,PR1
         2 000042   000033 772000                    QRL     27
         2 000043   000000 621006                    EAX1    0,QL
         2 000044   040100 100540                    MLR     fill='040'O
         2 000045   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         2 000046   200017 000400                    ADSC9   TEMPBUF,,AUTO            cn=0,n=256

      151    14546    2              FPT_WRITE = CFPT_WRITE;

  14546  2 000047   000100 100400                    MLR     fill='000'O
         2 000050   000000 000060 xsym               ADSC9   CFPT_WRITE               cn=0,n=48
         2 000051   200232 000060                    ADSC9   FPT_WRITE,,AUTO          cn=0,n=48

      152    14547    2              FPT_WRITE.V_ = VECTOR(FPT_WRITE.V);

  14547  2 000052   000004 235000 3                  LDA     4
         2 000053   200620 452500                    STP2    @TEMP+1,,AUTO
         2 000054   200620 236100                    LDQ     @TEMP+1,,AUTO
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:37   
         2 000055   000242 036003                    ADLQ    162,DU
         2 000056   200232 757100                    STAQ    FPT_WRITE,,AUTO

      153    14548    2              FPT_WRITE.KEY_ = VECTOR(K_ATITLE);

  14548  2 000057   000002 237000 3                  LDAQ    2
         2 000060   200234 757100                    STAQ    FPT_WRITE+2,,AUTO

      154    14549    2              FPT_WRITE.BUF_ = VECTOR(SUBSTR(TEMPBUF,0,32));

  14549  2 000061   000005 235000 3                  LDA     5
         2 000062   200620 452500                    STP2    @TEMP+1,,AUTO
         2 000063   200620 236100                    LDQ     @TEMP+1,,AUTO
         2 000064   000017 036003                    ADLQ    15,DU
         2 000065   200236 757100                    STAQ    FPT_WRITE+4,,AUTO

      155    14550    2              FPT_WRITE.V.DCB# = M$IBEX1_NUM;

  14550  2 000066   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 000067   200242 740100                    STX0    FPT_WRITE+8,,AUTO

      156    14551    2              FPT_WRITE.V.ONEWKEY# = %YES#;

  14551  2 000070   000400 236007                    LDQ     256,DL
         2 000071   200242 256100                    ORSQ    FPT_WRITE+8,,AUTO

      157    14552    2              CALL M$WRITE(FPT_WRITE) ALTRET(E_ATITLE_WRT);

  14552  2 000072   200232 630500                    EPPR0   FPT_WRITE,,AUTO
         2 000073   440001 713400                    CLIMB   alt,write
         2 000074   401400 401760                    pmme    nvectors=4
         2 000075   000117 702000 2                  TSX2    E_ATITLE_WRT

      158    14553    2           END;

      159    14554        /**/
      160    14555    1   NO_ATITLE:
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:38   
      161    14556    1     FPT_CLOSE = CFPT_CLOSE;

  14556  2 000076   000100 100400       NO_ATITLE    MLR     fill='000'O
         2 000077   000000 000170 xsym               ADSC9   CFPT_CLOSE               cn=0,n=120
         2 000100   200246 000170                    ADSC9   FPT_CLOSE,,AUTO          cn=0,n=120

      162    14557    1     FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V);

  14557  2 000101   000004 235000 3                  LDA     4
         2 000102   200620 452500                    STP2    @TEMP+1,,AUTO
         2 000103   200620 236100                    LDQ     @TEMP+1,,AUTO
         2 000104   000300 036003                    ADLQ    192,DU
         2 000105   200246 757100                    STAQ    FPT_CLOSE,,AUTO

      163    14558    1     FPT_CLOSE.V.DISP# = %SAVE#;

  14558  2 000106   000002 236007                    LDQ     2,DL
         2 000107   200300 552104                    STBQ    FPT_CLOSE+26,'04'O,AUTO

      164    14559    1     FPT_CLOSE.V.DCB# = M$IBEX1_NUM;

  14559  2 000110   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 000111   200300 740100                    STX0    FPT_CLOSE+26,,AUTO

      165    14560    1     CALL M$CLOSE (FPT_CLOSE) ALTRET(E_C$OPEN_S);

  14560  2 000112   200246 630500                    EPPR0   FPT_CLOSE,,AUTO
         2 000113   450001 713400                    CLIMB   alt,close
         2 000114   406000 401760                    pmme    nvectors=13
         2 000115   000163 702000 2                  TSX2    E_C$OPEN_S

      166    14561    1     RETURN;

  14561  2 000116   000000 702200 xent               TSX2  ! X66_ARET

      167    14562    1   E_ATITLE_WRT:
      168    14563    1     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$TCB.ALT$->B$ALT.ERR,,
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:39   

  14563  2 000117   000000 470400 xsym  E_ATITLE_WRT LDP0    B$TCB$
         2 000120   000000 471500                    LDP1    0,,PR0
         2 000121   000000 236000 xsym               LDQ     SEG2$
         2 000122   000003 036003                    ADLQ    3,DU
         2 000123   200620 756100                    STQ     @TEMP+1,,AUTO
         2 000124   100101 633500                    EPPR3   65,,PR1
         2 000125   200625 453500                    STP3    @TEMP+6,,AUTO
         2 000126   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000127   200624 756100                    STQ     @TEMP+5,,AUTO
         2 000130   100102 634500                    EPPR4   66,,PR1
         2 000131   200623 454500                    STP4    @TEMP+4,,AUTO
         2 000132   000007 236000 3                  LDQ     7
         2 000133   200622 756100                    STQ     @TEMP+3,,AUTO
         2 000134   200620 631500                    EPPR1   @TEMP+1,,AUTO
         2 000135   200621 451500                    STP1    @TEMP+2,,AUTO
         2 000136   200621 630500                    EPPR0   @TEMP+2,,AUTO
         2 000137   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000140   000000 701000 xent               TSX1    CXP$POSTERR
         2 000141   000000 011000                    NOP     0

      169    14564    1           B$TCB.ALT$->B$ALT.DCB#);
      170    14565    1     FPT_CLOSE = CFPT_CLOSE;

  14565  2 000142   000100 100400                    MLR     fill='000'O
         2 000143   000000 000170 xsym               ADSC9   CFPT_CLOSE               cn=0,n=120
         2 000144   200246 000170                    ADSC9   FPT_CLOSE,,AUTO          cn=0,n=120

      171    14566    1     FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V);

  14566  2 000145   000004 235000 3                  LDA     4
         2 000146   200620 452500                    STP2    @TEMP+1,,AUTO
         2 000147   200620 236100                    LDQ     @TEMP+1,,AUTO
         2 000150   000300 036003                    ADLQ    192,DU
         2 000151   200246 757100                    STAQ    FPT_CLOSE,,AUTO

      172    14567    1     FPT_CLOSE.V.DISP# = %SAVE#;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:40   

  14567  2 000152   000002 236007                    LDQ     2,DL
         2 000153   200300 552104                    STBQ    FPT_CLOSE+26,'04'O,AUTO

      173    14568    1     FPT_CLOSE.V.DCB# = M$IBEX1_NUM;

  14568  2 000154   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 000155   200300 740100                    STX0    FPT_CLOSE+26,,AUTO

      174    14569    1     CALL M$CLOSE (FPT_CLOSE) ALTRET(E_C$OPEN_S);

  14569  2 000156   200246 630500                    EPPR0   FPT_CLOSE,,AUTO
         2 000157   450001 713400                    CLIMB   alt,close
         2 000160   406000 401760                    pmme    nvectors=13
         2 000161   000163 702000 2                  TSX2    E_C$OPEN_S

      175    14570    1     ALTRETURN;

  14570  2 000162   000000 702200 xent               TSX2  ! X66_AALT

      176    14571    1   E_C$OPEN_S:
      177    14572    1     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$JIT.USRERR,,M$IBEX1_NUM);

  14572  2 000163   000000 236000 xsym  E_C$OPEN_S   LDQ     SEG2$
         2 000164   000003 036003                    ADLQ    3,DU
         2 000165   200620 756100                    STQ     @TEMP+1,,AUTO
         2 000166   000000 236000 3                  LDQ     0
         2 000167   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000170   200624 757100                    STAQ    @TEMP+5,,AUTO
         2 000171   000000 236000 xsym               LDQ     B$JIT$
         2 000172   000144 036003                    ADLQ    100,DU
         2 000173   000007 235000 3                  LDA     7
         2 000174   200622 757100                    STAQ    @TEMP+3,,AUTO
         2 000175   200620 630500                    EPPR0   @TEMP+1,,AUTO
         2 000176   200621 450500                    STP0    @TEMP+2,,AUTO
         2 000177   200621 630500                    EPPR0   @TEMP+2,,AUTO
         2 000200   000023 631400 xsym               EPPR1   B_VECTNIL+19
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:41   
         2 000201   000000 701000 xent               TSX1    CXP$POSTERR
         2 000202   000000 011000                    NOP     0

      178    14573    1     ALTRETURN;

  14573  2 000203   000000 702200 xent               TSX2  ! X66_AALT

      179    14574        %EJECT;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:42   
      180    14575    1   CPB$COUPLE:
      181    14576    1     ENTRY(P$PCB)   ALTRET;

  14576  2 000204   000000 700200 xent  CPB$COUPLE   TSX0  ! X66_AUTO_1
         2 000205   000626 000001                    ZERO    406,1

      182    14577    1     RETURN;

  14577  2 000206   000000 702200 xent               TSX2  ! X66_ARET

      183    14578    1   CPB$DECOUPLE:
      184    14579    1     ENTRY(P$PCB)   ALTRET;

  14579  2 000207   000000 700200 xent  CPB$DECOUPLE TSX0  ! X66_AUTO_1
         2 000210   000626 000001                    ZERO    406,1

      185    14580    1     RETURN;

  14580  2 000211   000000 702200 xent               TSX2  ! X66_ARET

      186    14581        %EJECT;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:43   
      187    14582    1   CPB$LOCATE:
      188    14583    1     ENTRY(P$PCB)   ALTRET;

  14583  2 000212   000000 700200 xent  CPB$LOCATE   TSX0  ! X66_AUTO_1
         2 000213   000626 000001                    ZERO    406,1

      189    14584    1     RETURN;

  14584  2 000214   000000 702200 xent               TSX2  ! X66_ARET

      190    14585        %EJECT;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:44   
      191    14586        /*********************************************************************/
      192    14587        /*F*       NAME:    CPB$MESSAGE
      193    14588                   PURPOSE: To process the MESSAGE command
      194    14589               REFERENCE: Programmers Reference Manual
      195    14590        */
      196    14591        /*D*   NAME:   CPB$MESSAGE
      197    14592               CALL:   CALL CPB$MESSAGE (P$PCB)
      198    14593               INPUT:  P$PCB - parse control block framing command.
      199    14594                   DESCRIPTION:   The text portion of the MESSAGE command
      200    14595                            is sent to the system operator's console.
      201    14596        */
      202    14597        /*********************************************************************/
      203    14598    1   CPB$MESSAGE:
      204    14599    1     ENTRY(P$PCB)   ALTRET;

  14599  2 000215   000000 700200 xent  CPB$MESSAGE  TSX0  ! X66_AUTO_1
         2 000216   000626 000001                    ZERO    406,1

      205    14600        /**/
      206    14601    1     BLK$ = P$PCB.OUT$;

  14601  2 000217   200003 470500                    LDP0    @P$PCB,,AUTO
         2 000220   000003 236100                    LDQ     3,,PR0
         2 000221   200005 756100                    STQ     BLK$,,AUTO

      207    14602        /*
      208    14603             ***** If no options then ignore ...
      209    14604        */
      210    14605    1     IF BLK$ -> P$B.NSUBLKS = 0

  14605  2 000222   200005 471500                    LDP1    BLK$,,AUTO
         2 000223   100001 220100                    LDX0    1,,PR1
         2 000224   000226 601000 2                  TNZ     s:14611

      211    14606    1        THEN  /* Why bother the operator */
      212    14607    1           RETURN;

PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:45   
  14607  2 000225   000000 702200 xent               TSX2  ! X66_ARET

      213    14608        /*
      214    14609             ***** Initialize FPT_KEYIN ...
      215    14610        */
      216    14611    1     FPT_KEYIN = CFPT_KEYIN;

  14611  2 000226   000100 100400                    MLR     fill='000'O
         2 000227   000000 000070 xsym               ADSC9   CFPT_KEYIN               cn=0,n=56
         2 000230   200316 000070                    ADSC9   FPT_KEYIN,,AUTO          cn=0,n=56

      217    14612    1     FPT_KEYIN.V_ = VECTOR(FPT_KEYIN.V);

  14612  2 000231   000010 235000 3                  LDA     8
         2 000232   200620 452500                    STP2    @TEMP+1,,AUTO
         2 000233   200620 236100                    LDQ     @TEMP+1,,AUTO
         2 000234   000326 036003                    ADLQ    214,DU
         2 000235   200316 757100                    STAQ    FPT_KEYIN,,AUTO

      218    14613    1     FPT_KEYIN.MESS_ = VECTOR(TEMPBUF);

  14613  2 000236   000011 235000 3                  LDA     9
         2 000237   200620 452500                    STP2    @TEMP+1,,AUTO
         2 000240   200620 236100                    LDQ     @TEMP+1,,AUTO
         2 000241   000017 036003                    ADLQ    15,DU
         2 000242   200320 757100                    STAQ    FPT_KEYIN+2,,AUTO

      219    14614    1     FPT_KEYIN.RESULTS_ = VECTOR(FID_ACCT);

  14614  2 000243   000001 235000 3                  LDA     1
         2 000244   200620 452500                    STP2    @TEMP+1,,AUTO
         2 000245   200620 236100                    LDQ     @TEMP+1,,AUTO
         2 000246   000370 036003                    ADLQ    248,DU
         2 000247   200324 757100                    STAQ    FPT_KEYIN+6,,AUTO

      220    14615        /*
      221    14616             ***** Pull the information out of the parse tree ...
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:46   
      222    14617        */
      223    14618    2     DO I = 0 TO BLK$ -> P$B.NSUBLKS - 1;

  14618  2 000250   200117 450100                    STZ     I,,AUTO
         2 000251   000416 710000 2                  TRA     s:14651+1

      224    14619    2        TEMP$ = BLK$ -> P$B.SUBLK$(I);

  14619  2 000252   200005 470500                    LDP0    BLK$,,AUTO
         2 000253   200117 720100                    LXL0    I,,AUTO
         2 000254   000003 236110                    LDQ     3,X0,PR0
         2 000255   200006 756100                    STQ     TEMP$,,AUTO

      225    14620    3        DO CASE (TEMP$ -> P$B.CODE);

  14620  2 000256   200006 471500                    LDP1    TEMP$,,AUTO
         2 000257   100000 721100                    LXL1    0,,PR1
         2 000260   000026 101003                    CMPX1   22,DU
         2 000261   000263 602011 2                  TNC     s:14620+5,X1
         2 000262   000415 710000 2                  TRA     s:14651
         2 000263   000415 710000 2                  TRA     s:14651
         2 000264   000311 710000 2                  TRA     s:14622
         2 000265   000327 710000 2                  TRA     s:14629
         2 000266   000415 710000 2                  TRA     s:14651
         2 000267   000415 710000 2                  TRA     s:14651
         2 000270   000415 710000 2                  TRA     s:14651
         2 000271   000415 710000 2                  TRA     s:14651
         2 000272   000415 710000 2                  TRA     s:14651
         2 000273   000415 710000 2                  TRA     s:14651
         2 000274   000415 710000 2                  TRA     s:14651
         2 000275   000415 710000 2                  TRA     s:14651
         2 000276   000324 710000 2                  TRA     s:14627
         2 000277   000336 710000 2                  TRA     s:14631
         2 000300   000343 710000 2                  TRA     s:14633
         2 000301   000350 710000 2                  TRA     s:14635
         2 000302   000355 710000 2                  TRA     s:14637
         2 000303   000362 710000 2                  TRA     s:14639
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:47   
         2 000304   000367 710000 2                  TRA     s:14641
         2 000305   000374 710000 2                  TRA     s:14643
         2 000306   000377 710000 2                  TRA     s:14645
         2 000307   000404 710000 2                  TRA     s:14647
         2 000310   000411 710000 2                  TRA     s:14649

      226    14621    3           CASE (MESS_OPT);

      227    14622    3              IF TEMP$ -> P$S.COUNT = 0

  14622  2 000311   100004 236100                    LDQ     4,,PR1
         2 000312   777000 316003                    CANQ    -512,DU
         2 000313   000315 601000 2                  TNZ     s:14625

      228    14623    3                 THEN   /* Dont bother the operator */
      229    14624    3                    RETURN;

  14624  2 000314   000000 702200 xent               TSX2  ! X66_ARET

      230    14625    3              TEMPBUF = TEMP$ -> P$S.TEXT;

  14625  2 000315   100004 236100                    LDQ     4,,PR1
         2 000316   000033 772000                    QRL     27
         2 000317   000000 622006                    EAX2    0,QL
         2 000320   040100 100540                    MLR     fill='040'O
         2 000321   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
         2 000322   200017 000400                    ADSC9   TEMPBUF,,AUTO            cn=0,n=256
         2 000323   000415 710000 2                  TRA     s:14651

      231    14626    3           CASE (MESS_ADMIN);

      232    14627    3              FPT_KEYIN.V.OCTYPE# = %TYPE_ADMIN#;

  14627  2 000324   000012 236000 3                  LDQ     10
         2 000325   200331 356100                    ANSQ    FPT_KEYIN+11,,AUTO
         2 000326   000415 710000 2                  TRA     s:14651

PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:48   
      233    14628    3           CASE (MESS_WSN);

      234    14629    3              FPT_KEYIN.V.WSN# = TEMP$ -> P$S.TEXT;

  14629  2 000327   100004 236100                    LDQ     4,,PR1
         2 000330   000033 772000                    QRL     27
         2 000331   000000 622006                    EAX2    0,QL
         2 000332   040100 100540                    MLR     fill='040'O
         2 000333   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
         2 000334   200326 000010                    ADSC9   FPT_KEYIN+8,,AUTO        cn=0,n=8
         2 000335   000415 710000 2                  TRA     s:14651

      235    14630    3           CASE (MESS_ADCOM);

      236    14631    3              FPT_KEYIN.V.OCTYPE# = %TYPE_SYSTEM#;

  14631  2 000336   200331 236100                    LDQ     FPT_KEYIN+11,,AUTO
         2 000337   000012 376000 3                  ANQ     10
         2 000340   001000 276003                    ORQ     512,DU
         2 000341   200331 756100                    STQ     FPT_KEYIN+11,,AUTO
         2 000342   000415 710000 2                  TRA     s:14651

      237    14632    3           CASE (MESS_COMM);

      238    14633    3              FPT_KEYIN.V.OCTYPE# = %TYPE_COMM#;

  14633  2 000343   200331 236100                    LDQ     FPT_KEYIN+11,,AUTO
         2 000344   000012 376000 3                  ANQ     10
         2 000345   004000 276003                    ORQ     2048,DU
         2 000346   200331 756100                    STQ     FPT_KEYIN+11,,AUTO
         2 000347   000415 710000 2                  TRA     s:14651

      239    14634    3           CASE (MESS_DEVC);

      240    14635    3              FPT_KEYIN.V.OCTYPE# = %TYPE_DEVICE#;

  14635  2 000350   200331 236100                    LDQ     FPT_KEYIN+11,,AUTO
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:49   
         2 000351   000012 376000 3                  ANQ     10
         2 000352   002000 276003                    ORQ     1024,DU
         2 000353   200331 756100                    STQ     FPT_KEYIN+11,,AUTO
         2 000354   000415 710000 2                  TRA     s:14651

      241    14636    3           CASE (MESS_DISK);

      242    14637    3              FPT_KEYIN.V.OCTYPE# = %TYPE_DISK#;

  14637  2 000355   200331 236100                    LDQ     FPT_KEYIN+11,,AUTO
         2 000356   000012 376000 3                  ANQ     10
         2 000357   006000 276003                    ORQ     3072,DU
         2 000360   200331 756100                    STQ     FPT_KEYIN+11,,AUTO
         2 000361   000415 710000 2                  TRA     s:14651

      243    14638    3           CASE (MESS_DLTA);

      244    14639    3              FPT_KEYIN.V.OCTYPE# = %TYPE_SYSTEM#;

  14639  2 000362   200331 236100                    LDQ     FPT_KEYIN+11,,AUTO
         2 000363   000012 376000 3                  ANQ     10
         2 000364   001000 276003                    ORQ     512,DU
         2 000365   200331 756100                    STQ     FPT_KEYIN+11,,AUTO
         2 000366   000415 710000 2                  TRA     s:14651

      245    14640    3           CASE (MESS_LIBRN);

      246    14641    3              FPT_KEYIN.V.OCTYPE# = %TYPE_DEVICE#;

  14641  2 000367   200331 236100                    LDQ     FPT_KEYIN+11,,AUTO
         2 000370   000012 376000 3                  ANQ     10
         2 000371   002000 276003                    ORQ     1024,DU
         2 000372   200331 756100                    STQ     FPT_KEYIN+11,,AUTO
         2 000373   000415 710000 2                  TRA     s:14651

      247    14642    3           CASE (MESS_NONSYS);

PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:50   
      248    14643    3              FPT_KEYIN.V.OCTYPE# = %TYPE_ADMIN#;

  14643  2 000374   000012 236000 3                  LDQ     10
         2 000375   200331 356100                    ANSQ    FPT_KEYIN+11,,AUTO
         2 000376   000415 710000 2                  TRA     s:14651

      249    14644    3           CASE (MESS_SYS);

      250    14645    3              FPT_KEYIN.V.OCTYPE# = %TYPE_SYSTEM#;

  14645  2 000377   200331 236100                    LDQ     FPT_KEYIN+11,,AUTO
         2 000400   000012 376000 3                  ANQ     10
         2 000401   001000 276003                    ORQ     512,DU
         2 000402   200331 756100                    STQ     FPT_KEYIN+11,,AUTO
         2 000403   000415 710000 2                  TRA     s:14651

      251    14646    3           CASE (MESS_TAPE);

      252    14647    3              FPT_KEYIN.V.OCTYPE# = %TYPE_TAPE#;

  14647  2 000404   200331 236100                    LDQ     FPT_KEYIN+11,,AUTO
         2 000405   000012 376000 3                  ANQ     10
         2 000406   005000 276003                    ORQ     2560,DU
         2 000407   200331 756100                    STQ     FPT_KEYIN+11,,AUTO
         2 000410   000415 710000 2                  TRA     s:14651

      253    14648    3           CASE (MESS_UR);

      254    14649    3              FPT_KEYIN.V.OCTYPE# = %TYPE_UR#;

  14649  2 000411   200331 236100                    LDQ     FPT_KEYIN+11,,AUTO
         2 000412   000012 376000 3                  ANQ     10
         2 000413   007000 276003                    ORQ     3584,DU
         2 000414   200331 756100                    STQ     FPT_KEYIN+11,,AUTO

      255    14650    3        END;   /* Do case ... end */

PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:51   
      256    14651    2     END;   /* Do i= ... end */

  14651  2 000415   200117 054100                    AOS     I,,AUTO
         2 000416   200005 470500                    LDP0    BLK$,,AUTO
         2 000417   000001 236100                    LDQ     1,,PR0
         2 000420   000022 772000                    QRL     18
         2 000421   200117 116100                    CMPQ    I,,AUTO
         2 000422   000252 605400 2                  TPNZ    s:14619

      257    14652        /*
      258    14653             ***** Write the msg...
      259    14654        */
      260    14655    1     CALL M$KEYIN (FPT_KEYIN) ALTRET(E_MESSAGE);

  14655  2 000423   200316 630500                    EPPR0   FPT_KEYIN,,AUTO
         2 000424   520000 713400                    CLIMB   alt,+40960
         2 000425   401400 401760                    pmme    nvectors=4
         2 000426   000430 702000 2                  TSX2    E_MESSAGE

      261    14656    1     RETURN;

  14656  2 000427   000000 702200 xent               TSX2  ! X66_ARET

      262    14657    1   E_MESSAGE:
      263    14658    1     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$TCB.ALT$->B$ALT.ERR);

  14658  2 000430   000000 470400 xsym  E_MESSAGE    LDP0    B$TCB$
         2 000431   000000 471500                    LDP1    0,,PR0
         2 000432   000000 236000 xsym               LDQ     SEG2$
         2 000433   000003 036003                    ADLQ    3,DU
         2 000434   200620 756100                    STQ     @TEMP+1,,AUTO
         2 000435   100102 633500                    EPPR3   66,,PR1
         2 000436   200623 453500                    STP3    @TEMP+4,,AUTO
         2 000437   000007 236000 3                  LDQ     7
         2 000440   200622 756100                    STQ     @TEMP+3,,AUTO
         2 000441   200620 631500                    EPPR1   @TEMP+1,,AUTO
         2 000442   200621 451500                    STP1    @TEMP+2,,AUTO
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:52   
         2 000443   200621 630500                    EPPR0   @TEMP+2,,AUTO
         2 000444   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000445   000000 701000 xent               TSX1    CXP$POSTERR
         2 000446   000000 011000                    NOP     0

      264    14659    1     ALTRETURN;

  14659  2 000447   000000 702200 xent               TSX2  ! X66_AALT

      265    14660        %EJECT;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:53   
      266    14661        /*F*    NAME:    CPB$PLATEN
      267    14662                PURPOSE:    To process the PLATEN command.
      268    14663                REFERENCE:  Programmer's Reference Manual
      269    14664        */
      270    14665    1   CPB$PLATEN:
      271    14666    1     ENTRY(P$PCB)   ALTRET;

  14666  2 000450   000000 700200 xent  CPB$PLATEN   TSX0  ! X66_AUTO_1
         2 000451   000626 000001                    ZERO    406,1

      272    14667        /**/
      273    14668    1     BLK$ = P$PCB.OUT$;

  14668  2 000452   200003 470500                    LDP0    @P$PCB,,AUTO
         2 000453   000003 236100                    LDQ     3,,PR0
         2 000454   200005 756100                    STQ     BLK$,,AUTO

      274    14669        /*
      275    14670          ***** Set up FPT_PLATEN
      276    14671        */
      277    14672    1     FPT_PLATEN = CFPT_PLATEN;

  14672  2 000455   000100 100400                    MLR     fill='000'O
         2 000456   000000 000040 xsym               ADSC9   CFPT_PLATEN              cn=0,n=32
         2 000457   200360 000040                    ADSC9   FPT_PLATEN,,AUTO         cn=0,n=32

      278    14673    1     FPT_PLATEN.V_ = VECTOR(FPT_PLATEN.V);

  14673  2 000460   000001 235000 3                  LDA     1
         2 000461   200620 452500                    STP2    @TEMP+1,,AUTO
         2 000462   200620 236100                    LDQ     @TEMP+1,,AUTO
         2 000463   000366 036003                    ADLQ    246,DU
         2 000464   200360 757100                    STAQ    FPT_PLATEN,,AUTO

      279    14674    1     PLATEN_VLP = CVLP_PLATEN;

  14674  2 000465   000100 100400                    MLR     fill='000'O
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:54   
         2 000466   000000 000020 xsym               ADSC9   CVLP_PLATEN              cn=0,n=16
         2 000467   200574 000020                    ADSC9   PLATEN_VLP,,AUTO         cn=0,n=16

      280    14675    1     FPT_PLATEN.PLATEN_ = VECTOR(PLATEN_VLP) ;

  14675  2 000470   000004 235000 3                  LDA     4
         2 000471   200620 452500                    STP2    @TEMP+1,,AUTO
         2 000472   200620 236100                    LDQ     @TEMP+1,,AUTO
         2 000473   000574 036003                    ADLQ    380,DU
         2 000474   200364 757100                    STAQ    FPT_PLATEN+4,,AUTO

      281    14676        /*
      282    14677          **** No options after platen indicates platen to be displayed
      283    14678        */
      284    14679    1     IF BLK$->P$B.NSUBLKS=0

  14679  2 000475   200005 471500                    LDP1    BLK$,,AUTO
         2 000476   100001 220100                    LDX0    1,,PR1
         2 000477   001113 601000 2                  TNZ     s:14740

      285    14680    1        THEN
      286    14681    2           DO;

      287    14682    2   DISPLAY_PLATEN:
      288    14683    2              TEMPBUF$=ADDR(TEMPBUF);

  14683  2 000500   200017 630500       DISPLAY_PLA* EPPR0   TEMPBUF,,AUTO
         2 000501   200007 450500                    STP0    TEMPBUF$,,AUTO

      289    14684    2              DEST$=TEMPBUF$;                     /*Dynamic ptr*/

  14684  2 000502   200007 236100                    LDQ     TEMPBUF$,,AUTO
         2 000503   200010 756100                    STQ     DEST$,,AUTO

      290    14685    2              TEMPBUF=PLATENHDR;

  14685  2 000504   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:55   
         2 000505   000000 000023 1                  ADSC9   PLATENHDR                cn=0,n=19
         2 000506   200017 000400                    ADSC9   TEMPBUF,,AUTO            cn=0,n=256

      291    14686    2              DEST$=PINCRC(DEST$,SIZEC(PLATENHDR));

  14686  2 000507   000013 036000 3                  ADLQ    11
         2 000510   200010 756100                    STQ     DEST$,,AUTO

      292    14687    2              TAB_VAL=6;

  14687  2 000511   000006 235007                    LDA     6,DL
         2 000512   200125 755100                    STA     TAB_VAL,,AUTO

      293    14688    2              CALL M$GPLATEN(FPT_PLATEN) ALTRET(E_PLATEN) ;

  14688  2 000513   200360 630500                    EPPR0   FPT_PLATEN,,AUTO
         2 000514   560033 713400                    CLIMB   alt,+57371
         2 000515   401000 401760                    pmme    nvectors=3
         2 000516   001335 702000 2                  TSX2    E_PLATEN

      294    14689    2              IF DCBADDR(M$IBEX1_NUM)->F$DCB.FCD#

  14689  2 000517   000014 470400 3                  LDP0    12
         2 000520   000000 471500                    LDP1    0,,PR0
         2 000521   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 000522   100000 473510                    LDP3    0,X0,PR1
         2 000523   300031 236100                    LDQ     25,,PR3
         2 000524   020000 316007                    CANQ    8192,DL
         2 000525   000546 600000 2                  TZE     s:14703

      295    14690    2                THEN
      296    14691    3                   DO;

      297    14692    3                     FPT_CLOSE = CFPT_CLOSE ;

  14692  2 000526   000100 100400                    MLR     fill='000'O
         2 000527   000000 000170 xsym               ADSC9   CFPT_CLOSE               cn=0,n=120
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:56   
         2 000530   200246 000170                    ADSC9   FPT_CLOSE,,AUTO          cn=0,n=120

      298    14693    3                     FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V) ;

  14693  2 000531   000004 235000 3                  LDA     4
         2 000532   200620 452500                    STP2    @TEMP+1,,AUTO
         2 000533   200620 236100                    LDQ     @TEMP+1,,AUTO
         2 000534   000300 036003                    ADLQ    192,DU
         2 000535   200246 757100                    STAQ    FPT_CLOSE,,AUTO

      299    14694    3                     FPT_CLOSE.V.DCB#=M$IBEX1_NUM ;

  14694  2 000536   200300 740100                    STX0    FPT_CLOSE+26,,AUTO

      300    14695    3                     FPT_CLOSE.V.DISP#=%SAVE#;

  14695  2 000537   000002 236007                    LDQ     2,DL
         2 000540   200300 552104                    STBQ    FPT_CLOSE+26,'04'O,AUTO

      301    14696    3                     CALL M$CLOSE(FPT_CLOSE) WHENALTRETURN

  14696  2 000541   200246 630500                    EPPR0   FPT_CLOSE,,AUTO
         2 000542   450001 713400                    CLIMB   alt,close
         2 000543   406000 401760                    pmme    nvectors=13
         2 000544   000546 702000 2                  TSX2    s:14703
         2 000545   000546 710000 2                  TRA     s:14703

      302    14697    4                                             DO ;

      303    14698    4                                             END ;

      304    14699    3                   END;

      305    14700        /*
      306    14701          **** Insert platen settings into image
      307    14702        */
      308    14703    2              TEMP = PLATEN_VLP.WIDTH# ;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:57   

  14703  2 000546   200574 236100                    LDQ     PLATEN_VLP,,AUTO
         2 000547   000033 772000                    QRL     27
         2 000550   000377 376007                    ANQ     255,DL
         2 000551   200122 756100                    STQ     TEMP,,AUTO

      309    14704    2              IF PLATEN_VLP.EXTWID#

  14704  2 000552   200575 430100                    FSZN    PLATEN_VLP+1,,AUTO
         2 000553   000556 605000 2                  TPL     s:14707

      310    14705    2               THEN
      311    14706    2                 TEMP = TEMP + 254 ;

  14706  2 000554   000376 036007                    ADLQ    254,DL
         2 000555   200122 756100                    STQ     TEMP,,AUTO

      312    14707    2              CALL BINCHAR(TBUFF,TEMP);

  14707  2 000556   000000 235003                    LDA     0,DU
         2 000557   200620 757100                    STAQ    @TEMP+1,,AUTO
         2 000560   000100 301500                    BTD
         2 000561   200620 000010                    NDSC9   @TEMP+1,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         2 000562   200011 030030                    NDSC9   TMDATE,,AUTO             cn=0,s=nosgn,sf=0,n=24

      313    14708    2              CALL CPE$RZEROS(TBUFF,SIZEC(TBUFF),K);

  14708  2 000563   200121 630500                    EPPR0   K,,AUTO
         2 000564   200622 450500                    STP0    @TEMP+3,,AUTO
         2 000565   000016 236000 3                  LDQ     14
         2 000566   200621 756100                    STQ     @TEMP+2,,AUTO
         2 000567   200011 631500                    EPPR1   TMDATE,,AUTO
         2 000570   200620 451500                    STP1    @TEMP+1,,AUTO
         2 000571   200620 630500                    EPPR0   @TEMP+1,,AUTO
         2 000572   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000573   000000 701000 xent               TSX1    CPE$RZEROS
         2 000574   000000 011000                    NOP     0
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:58   

      314    14709    2              CALL CPB$BLDIMAGE(TEMPBUF$,DEST$,ADDR(TBUFF),K,TAB_VAL)

  14709  2 000575   200011 630500                    EPPR0   TMDATE,,AUTO
         2 000576   200620 450500                    STP0    @TEMP+1,,AUTO
         2 000577   200125 631500                    EPPR1   TAB_VAL,,AUTO
         2 000600   200625 451500                    STP1    @TEMP+6,,AUTO
         2 000601   200121 633500                    EPPR3   K,,AUTO
         2 000602   200624 453500                    STP3    @TEMP+5,,AUTO
         2 000603   200620 634500                    EPPR4   @TEMP+1,,AUTO
         2 000604   200623 454500                    STP4    @TEMP+4,,AUTO
         2 000605   200010 635500                    EPPR5   DEST$,,AUTO
         2 000606   200622 455500                    STP5    @TEMP+3,,AUTO
         2 000607   200007 636500                    EPPR6   TEMPBUF$,,AUTO
         2 000610   200621 456500                    STP6    @TEMP+2,,AUTO
         2 000611   200621 630500                    EPPR0   @TEMP+2,,AUTO
         2 000612   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000613   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 000614   001361 702000 2                  TSX2    E_PLATEN_LIST

      315    14710    2                   ALTRET(E_PLATEN_LIST);
      316    14711    2              DEST$=PINCRC(DEST$,2);                    /*Insert blanks*/

  14711  2 000615   200010 236100                    LDQ     DEST$,,AUTO
         2 000616   400000 036007                    ADLQ    -131072,DL
         2 000617   200010 756100                    STQ     DEST$,,AUTO

      317    14712    2              TBUFF='Length = ';

  14712  2 000620   040100 100400                    MLR     fill='040'O
         2 000621   000011 000011 1                  ADSC9   E_RPTATJS+1              cn=0,n=9
         2 000622   200011 000030                    ADSC9   TMDATE,,AUTO             cn=0,n=24

      318    14713    2              CALL CPB$BLDIMAGE(TEMPBUF$,DEST$,ADDR(TBUFF),SIZEC('Length = '),

  14713  2 000623   200011 630500                    EPPR0   TMDATE,,AUTO
         2 000624   200620 450500                    STP0    @TEMP+1,,AUTO
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:59   
         2 000625   200125 631500                    EPPR1   TAB_VAL,,AUTO
         2 000626   200625 451500                    STP1    @TEMP+6,,AUTO
         2 000627   000017 236000 3                  LDQ     15
         2 000630   200624 756100                    STQ     @TEMP+5,,AUTO
         2 000631   200620 633500                    EPPR3   @TEMP+1,,AUTO
         2 000632   200623 453500                    STP3    @TEMP+4,,AUTO
         2 000633   200010 634500                    EPPR4   DEST$,,AUTO
         2 000634   200622 454500                    STP4    @TEMP+3,,AUTO
         2 000635   200007 635500                    EPPR5   TEMPBUF$,,AUTO
         2 000636   200621 455500                    STP5    @TEMP+2,,AUTO
         2 000637   200621 630500                    EPPR0   @TEMP+2,,AUTO
         2 000640   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000641   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 000642   001361 702000 2                  TSX2    E_PLATEN_LIST

      319    14714    2                   TAB_VAL) ALTRET(E_PLATEN_LIST);
      320    14715    2              CALL BINCHAR(TBUFF,PLATEN_VLP.LENGTH#);

  14715  2 000643   200574 236100                    LDQ     PLATEN_VLP,,AUTO
         2 000644   000022 772000                    QRL     18
         2 000645   000377 376007                    ANQ     255,DL
         2 000646   000000 235003                    LDA     0,DU
         2 000647   200620 757100                    STAQ    @TEMP+1,,AUTO
         2 000650   000100 301500                    BTD
         2 000651   200620 000010                    NDSC9   @TEMP+1,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         2 000652   200011 030030                    NDSC9   TMDATE,,AUTO             cn=0,s=nosgn,sf=0,n=24

      321    14716    2              CALL CPE$RZEROS(TBUFF,SIZEC(TBUFF),K);

  14716  2 000653   200121 630500                    EPPR0   K,,AUTO
         2 000654   200622 450500                    STP0    @TEMP+3,,AUTO
         2 000655   000016 236000 3                  LDQ     14
         2 000656   200621 756100                    STQ     @TEMP+2,,AUTO
         2 000657   200011 631500                    EPPR1   TMDATE,,AUTO
         2 000660   200620 451500                    STP1    @TEMP+1,,AUTO
         2 000661   200620 630500                    EPPR0   @TEMP+1,,AUTO
         2 000662   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:60   
         2 000663   000000 701000 xent               TSX1    CPE$RZEROS
         2 000664   000000 011000                    NOP     0

      322    14717    2              CALL CPB$BLDIMAGE(TEMPBUF$,DEST$,ADDR(TBUFF),K,TAB_VAL)

  14717  2 000665   200011 630500                    EPPR0   TMDATE,,AUTO
         2 000666   200620 450500                    STP0    @TEMP+1,,AUTO
         2 000667   200125 631500                    EPPR1   TAB_VAL,,AUTO
         2 000670   200625 451500                    STP1    @TEMP+6,,AUTO
         2 000671   200121 633500                    EPPR3   K,,AUTO
         2 000672   200624 453500                    STP3    @TEMP+5,,AUTO
         2 000673   200620 634500                    EPPR4   @TEMP+1,,AUTO
         2 000674   200623 454500                    STP4    @TEMP+4,,AUTO
         2 000675   200010 635500                    EPPR5   DEST$,,AUTO
         2 000676   200622 455500                    STP5    @TEMP+3,,AUTO
         2 000677   200007 636500                    EPPR6   TEMPBUF$,,AUTO
         2 000700   200621 456500                    STP6    @TEMP+2,,AUTO
         2 000701   200621 630500                    EPPR0   @TEMP+2,,AUTO
         2 000702   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000703   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 000704   001361 702000 2                  TSX2    E_PLATEN_LIST

      323    14718    2                   ALTRET(E_PLATEN_LIST);
      324    14719    2              DEST$=PINCRC(DEST$,2);                    /*Insert blanks*/

  14719  2 000705   200010 236100                    LDQ     DEST$,,AUTO
         2 000706   400000 036007                    ADLQ    -131072,DL
         2 000707   200010 756100                    STQ     DEST$,,AUTO

      325    14720    2              TBUFF='Limbo = ';

  14720  2 000710   040100 100400                    MLR     fill='040'O
         2 000711   000014 000010 1                  ADSC9   E_RPTATJS+4              cn=0,n=8
         2 000712   200011 000030                    ADSC9   TMDATE,,AUTO             cn=0,n=24

      326    14721    2              CALL CPB$BLDIMAGE(TEMPBUF$,DEST$,ADDR(TBUFF),SIZEC('Limbo = '),

PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:61   
  14721  2 000713   200011 630500                    EPPR0   TMDATE,,AUTO
         2 000714   200620 450500                    STP0    @TEMP+1,,AUTO
         2 000715   200125 631500                    EPPR1   TAB_VAL,,AUTO
         2 000716   200625 451500                    STP1    @TEMP+6,,AUTO
         2 000717   000020 236000 3                  LDQ     16
         2 000720   200624 756100                    STQ     @TEMP+5,,AUTO
         2 000721   200620 633500                    EPPR3   @TEMP+1,,AUTO
         2 000722   200623 453500                    STP3    @TEMP+4,,AUTO
         2 000723   200010 634500                    EPPR4   DEST$,,AUTO
         2 000724   200622 454500                    STP4    @TEMP+3,,AUTO
         2 000725   200007 635500                    EPPR5   TEMPBUF$,,AUTO
         2 000726   200621 455500                    STP5    @TEMP+2,,AUTO
         2 000727   200621 630500                    EPPR0   @TEMP+2,,AUTO
         2 000730   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000731   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 000732   001361 702000 2                  TSX2    E_PLATEN_LIST

      327    14722    2                   TAB_VAL) ALTRET(E_PLATEN_LIST);
      328    14723    2              CALL BINCHAR(TBUFF,PLATEN_VLP.LIMBO#);

  14723  2 000733   200574 236100                    LDQ     PLATEN_VLP,,AUTO
         2 000734   000011 772000                    QRL     9
         2 000735   000377 376007                    ANQ     255,DL
         2 000736   000000 235003                    LDA     0,DU
         2 000737   200620 757100                    STAQ    @TEMP+1,,AUTO
         2 000740   000100 301500                    BTD
         2 000741   200620 000010                    NDSC9   @TEMP+1,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         2 000742   200011 030030                    NDSC9   TMDATE,,AUTO             cn=0,s=nosgn,sf=0,n=24

      329    14724    2              CALL CPE$RZEROS(TBUFF,SIZEC(TBUFF),K);

  14724  2 000743   200121 630500                    EPPR0   K,,AUTO
         2 000744   200622 450500                    STP0    @TEMP+3,,AUTO
         2 000745   000016 236000 3                  LDQ     14
         2 000746   200621 756100                    STQ     @TEMP+2,,AUTO
         2 000747   200011 631500                    EPPR1   TMDATE,,AUTO
         2 000750   200620 451500                    STP1    @TEMP+1,,AUTO
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:62   
         2 000751   200620 630500                    EPPR0   @TEMP+1,,AUTO
         2 000752   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000753   000000 701000 xent               TSX1    CPE$RZEROS
         2 000754   000000 011000                    NOP     0

      330    14725    2              CALL CPB$BLDIMAGE(TEMPBUF$,DEST$,ADDR(TBUFF),K,TAB_VAL)

  14725  2 000755   200011 630500                    EPPR0   TMDATE,,AUTO
         2 000756   200620 450500                    STP0    @TEMP+1,,AUTO
         2 000757   200125 631500                    EPPR1   TAB_VAL,,AUTO
         2 000760   200625 451500                    STP1    @TEMP+6,,AUTO
         2 000761   200121 633500                    EPPR3   K,,AUTO
         2 000762   200624 453500                    STP3    @TEMP+5,,AUTO
         2 000763   200620 634500                    EPPR4   @TEMP+1,,AUTO
         2 000764   200623 454500                    STP4    @TEMP+4,,AUTO
         2 000765   200010 635500                    EPPR5   DEST$,,AUTO
         2 000766   200622 455500                    STP5    @TEMP+3,,AUTO
         2 000767   200007 636500                    EPPR6   TEMPBUF$,,AUTO
         2 000770   200621 456500                    STP6    @TEMP+2,,AUTO
         2 000771   200621 630500                    EPPR0   @TEMP+2,,AUTO
         2 000772   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000773   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 000774   001361 702000 2                  TSX2    E_PLATEN_LIST

      331    14726    2                   ALTRET(E_PLATEN_LIST);
      332    14727    2              DEST$=PINCRC(DEST$,2);                    /*Insert blanks*/

  14727  2 000775   200010 236100                    LDQ     DEST$,,AUTO
         2 000776   400000 036007                    ADLQ    -131072,DL
         2 000777   200010 756100                    STQ     DEST$,,AUTO

      333    14728    2              TBUFF='FirstLine = ';

  14728  2 001000   040100 100400                    MLR     fill='040'O
         2 001001   000016 000014 1                  ADSC9   E_RPTATJS+6              cn=0,n=12
         2 001002   200011 000030                    ADSC9   TMDATE,,AUTO             cn=0,n=24

PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:63   
      334    14729    2              CALL CPB$BLDIMAGE(TEMPBUF$,DEST$,ADDR(TBUFF),SIZEC('FirstLine = '),

  14729  2 001003   200011 630500                    EPPR0   TMDATE,,AUTO
         2 001004   200620 450500                    STP0    @TEMP+1,,AUTO
         2 001005   200125 631500                    EPPR1   TAB_VAL,,AUTO
         2 001006   200625 451500                    STP1    @TEMP+6,,AUTO
         2 001007   000022 236000 3                  LDQ     18
         2 001010   200624 756100                    STQ     @TEMP+5,,AUTO
         2 001011   200620 633500                    EPPR3   @TEMP+1,,AUTO
         2 001012   200623 453500                    STP3    @TEMP+4,,AUTO
         2 001013   200010 634500                    EPPR4   DEST$,,AUTO
         2 001014   200622 454500                    STP4    @TEMP+3,,AUTO
         2 001015   200007 635500                    EPPR5   TEMPBUF$,,AUTO
         2 001016   200621 455500                    STP5    @TEMP+2,,AUTO
         2 001017   200621 630500                    EPPR0   @TEMP+2,,AUTO
         2 001020   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 001021   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 001022   001361 702000 2                  TSX2    E_PLATEN_LIST

      335    14730    2                   TAB_VAL) ALTRET(E_PLATEN_LIST);
      336    14731    2              CALL BINCHAR(TBUFF,PLATEN_VLP.FIRSTLINE#);

  14731  2 001023   200574 236100                    LDQ     PLATEN_VLP,,AUTO
         2 001024   000377 376007                    ANQ     255,DL
         2 001025   000000 235003                    LDA     0,DU
         2 001026   200620 757100                    STAQ    @TEMP+1,,AUTO
         2 001027   000100 301500                    BTD
         2 001030   200620 000010                    NDSC9   @TEMP+1,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         2 001031   200011 030030                    NDSC9   TMDATE,,AUTO             cn=0,s=nosgn,sf=0,n=24

      337    14732    2              CALL CPE$RZEROS(TBUFF,SIZEC(TBUFF),K);

  14732  2 001032   200121 630500                    EPPR0   K,,AUTO
         2 001033   200622 450500                    STP0    @TEMP+3,,AUTO
         2 001034   000016 236000 3                  LDQ     14
         2 001035   200621 756100                    STQ     @TEMP+2,,AUTO
         2 001036   200011 631500                    EPPR1   TMDATE,,AUTO
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:64   
         2 001037   200620 451500                    STP1    @TEMP+1,,AUTO
         2 001040   200620 630500                    EPPR0   @TEMP+1,,AUTO
         2 001041   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001042   000000 701000 xent               TSX1    CPE$RZEROS
         2 001043   000000 011000                    NOP     0

      338    14733    2              CALL CPB$BLDIMAGE(TEMPBUF$,DEST$,ADDR(TBUFF),K,TAB_VAL)

  14733  2 001044   200011 630500                    EPPR0   TMDATE,,AUTO
         2 001045   200620 450500                    STP0    @TEMP+1,,AUTO
         2 001046   200125 631500                    EPPR1   TAB_VAL,,AUTO
         2 001047   200625 451500                    STP1    @TEMP+6,,AUTO
         2 001050   200121 633500                    EPPR3   K,,AUTO
         2 001051   200624 453500                    STP3    @TEMP+5,,AUTO
         2 001052   200620 634500                    EPPR4   @TEMP+1,,AUTO
         2 001053   200623 454500                    STP4    @TEMP+4,,AUTO
         2 001054   200010 635500                    EPPR5   DEST$,,AUTO
         2 001055   200622 455500                    STP5    @TEMP+3,,AUTO
         2 001056   200007 636500                    EPPR6   TEMPBUF$,,AUTO
         2 001057   200621 456500                    STP6    @TEMP+2,,AUTO
         2 001060   200621 630500                    EPPR0   @TEMP+2,,AUTO
         2 001061   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 001062   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 001063   001361 702000 2                  TSX2    E_PLATEN_LIST

      339    14734    2                   ALTRET(E_PLATEN_LIST);
      340    14735    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,TEMPBUF$);

  14735  2 001064   000000 470400 xsym               LDP0    SEG2$
         2 001065   000165 471500                    LDP1    117,,PR0
         2 001066   200007 236100                    LDQ     TEMPBUF$,,AUTO
         2 001067   000020 772000                    QRL     16
         2 001070   200620 756100                    STQ     @TEMP+1,,AUTO
         2 001071   200010 236100                    LDQ     DEST$,,AUTO
         2 001072   000020 772000                    QRL     16
         2 001073   200620 136100                    SBLQ    @TEMP+1,,AUTO
         2 001074   000020 736000                    QLS     16
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:65   
         2 001075   100004 676100                    ERQ     4,,PR1
         2 001076   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 001077   100004 656100                    ERSQ    4,,PR1

      341    14736    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=TEMPBUF$;

  14736  2 001100   000165 471500                    LDP1    117,,PR0
         2 001101   200007 236100                    LDQ     TEMPBUF$,,AUTO
         2 001102   100005 756100                    STQ     5,,PR1

      342    14737    2              CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(E_PLATEN_LIST);

  14737  2 001103   000000 236000 xsym               LDQ     SEG2$
         2 001104   000165 036003                    ADLQ    117,DU
         2 001105   200620 756100                    STQ     @TEMP+1,,AUTO
         2 001106   200620 630500                    EPPR0   @TEMP+1,,AUTO
         2 001107   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001110   000000 701000 xent               TSX1    CPE$LISTOUT
         2 001111   001361 702000 2                  TSX2    E_PLATEN_LIST

      343    14738    2              RETURN;

  14738  2 001112   000000 702200 xent               TSX2  ! X66_ARET

      344    14739    2           END;
      345    14740    1     IF BLK$->P$B.SUBLK$(0)->P$B.CODE = PL_UCNN

  14740  2 001113   100003 473500                    LDP3    3,,PR1
         2 001114   300000 721100                    LXL1    0,,PR3
         2 001115   000005 101003                    CMPX1   5,DU
         2 001116   001204 601000 2                  TNZ     s:14764

      346    14741    1         THEN
      347    14742    2             DO ;

      348    14743    2               STRM = BLK$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$S.TEXT ;

PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:66   
  14743  2 001117   300003 474500                    LDP4    3,,PR3
         2 001120   400004 236100                    LDQ     4,,PR4
         2 001121   000033 772000                    QRL     27
         2 001122   000000 622006                    EAX2    0,QL
         2 001123   040100 100540                    MLR     fill='040'O
         2 001124   400004 200012                    ADSC9   4,,PR4                   cn=1,n=*X2
         2 001125   200127 000002                    ADSC9   STRM,,AUTO               cn=0,n=2

      349    14744    2               FPT_OPEN = CFPT_OPEN ;

  14744  2 001126   000100 100400                    MLR     fill='000'O
         2 001127   000000 000350 xsym               ADSC9   CFPT_OPEN                cn=0,n=232
         2 001130   200140 000350                    ADSC9   FPT_OPEN,,AUTO           cn=0,n=232

      350    14745    2               FPT_OPEN.V_ = VECTOR(FPT_OPEN.V) ;

  14745  2 001131   000023 235000 3                  LDA     19
         2 001132   200620 452500                    STP2    @TEMP+1,,AUTO
         2 001133   200620 236100                    LDQ     @TEMP+1,,AUTO
         2 001134   000204 036003                    ADLQ    132,DU
         2 001135   200140 757100                    STAQ    FPT_OPEN,,AUTO

      351    14746    2               FPT_OPEN.V.DCB# = M$IBEX1_NUM ;

  14746  2 001136   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 001137   200204 740100                    STX0    FPT_OPEN+36,,AUTO

      352    14747    2               DCB# = M$IBEX1_NUM ;

  14747  2 001140   000000 235000 xsym               LDA     M$IBEX1_NUM
         2 001141   200130 755100                    STA     DCB#,,AUTO

      353    14748    2               CALL CONCAT(FPT_OPEN.V.RES#, 'UC', STRM) ;

  14748  2 001142   000021 221000 1                  LDX1    E_RPTATJS+9
         2 001143   200210 741100                    STX1    FPT_OPEN+40,,AUTO
         2 001144   200127 222100                    LDX2    STRM,,AUTO
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:67   
         2 001145   200210 442100                    SXL2    FPT_OPEN+40,,AUTO

      354    14749    2               FPT_OPEN.V.ORG# = %TERMINAL# ;

  14749  2 001146   010000 236007                    LDQ     4096,DL
         2 001147   200206 552110                    STBQ    FPT_OPEN+38,'10'O,AUTO

      355    14750    2               CALL M$OPEN (FPT_OPEN) WHENALTRETURN

  14750  2 001150   200140 630500                    EPPR0   FPT_OPEN,,AUTO
         2 001151   450000 713400                    CLIMB   alt,open
         2 001152   410400 401760                    pmme    nvectors=18
         2 001153   001155 702000 2                  TSX2    s:14752
         2 001154   001173 710000 2                  TRA     s:14757

      356    14751    3                             DO ;

      357    14752    3                               IF B$TCB.ALT$ -> B$ALT.ERR.CODE ~= %E$ORGNOTCOM

  14752  2 001155   000000 470400 xsym               LDP0    B$TCB$
         2 001156   000000 471500                    LDP1    0,,PR0
         2 001157   100102 236100                    LDQ     66,,PR1
         2 001160   377770 376007                    ANQ     131064,DL
         2 001161   014170 116007                    CMPQ    6264,DL
         2 001162   001335 601000 2                  TNZ     E_PLATEN

      358    14753    3                                 THEN
      359    14754    3                                   GOTO E_PLATEN ;
      360    14755    3                               CALL CPB$FIND_UCNN(STRM, DCB#) ALTRET(E_PLATEN_LIST) ;

  14755  2 001163   200130 633500                    EPPR3   DCB#,,AUTO
         2 001164   200621 453500                    STP3    @TEMP+2,,AUTO
         2 001165   200127 631500                    EPPR1   STRM,,AUTO
         2 001166   200620 451500                    STP1    @TEMP+1,,AUTO
         2 001167   200620 630500                    EPPR0   @TEMP+1,,AUTO
         2 001170   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001171   000000 701000 xent               TSX1    CPB$FIND_UCNN
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:68   
         2 001172   001361 702000 2                  TSX2    E_PLATEN_LIST

      361    14756    3                             END ; /* Whenaltreturn */

      362    14757    2               FPT_PLATEN.V.DCB# = DCB# ;

  14757  2 001173   200130 720100                    LXL0    DCB#,,AUTO
         2 001174   200366 740100                    STX0    FPT_PLATEN+6,,AUTO

      363    14758    2               IF BLK$->P$B.NSUBLKS = 1

  14758  2 001175   200005 470500                    LDP0    BLK$,,AUTO
         2 001176   000001 221100                    LDX1    1,,PR0
         2 001177   000001 101003                    CMPX1   1,DU
         2 001200   000500 600000 2                  TZE     DISPLAY_PLATEN

      364    14759    2                 THEN
      365    14760    2                   GOTO DISPLAY_PLATEN ;
      366    14761    2               I = 1 ; /* Bump past UCnn option. */

  14761  2 001201   000001 235007                    LDA     1,DL
         2 001202   200117 755100                    STA     I,,AUTO

      367    14762    2             END ; /* Then Do */

  14762  2 001203   001205 710000 2                  TRA     s:14768

      368    14763    1         ELSE
      369    14764    1             I = 0 ; /* Start with the first option */

  14764  2 001204   200117 450100                    STZ     I,,AUTO

      370    14765        /*
      371    14766             ***** New platen values...
      372    14767        */
      373    14768    2     DO WHILE(I < BLK$->P$B.NSUBLKS);

PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:69   
  14768  2 001205   200005 470500                    LDP0    BLK$,,AUTO
         2 001206   000001 236100                    LDQ     1,,PR0
         2 001207   000022 772000                    QRL     18
         2 001210   200117 116100                    CMPQ    I,,AUTO
         2 001211   001301 604400 2                  TMOZ    s:14794

      374    14769    2        P$ = BLK$->P$B.SUBLK$(I);

  14769  2 001212   200005 470500                    LDP0    BLK$,,AUTO
         2 001213   200117 720100                    LXL0    I,,AUTO
         2 001214   000003 236110                    LDQ     3,X0,PR0
         2 001215   200004 756100                    STQ     P$,,AUTO

      375    14770    2        CALL CHARBIN(TEMP,P$->P$S.TEXT);

  14770  2 001216   200004 471500                    LDP1    P$,,AUTO
         2 001217   100004 236100                    LDQ     4,,PR1
         2 001220   000033 772000                    QRL     27
         2 001221   000000 621006                    EAX1    0,QL
         2 001222   000100 305540                    DTB
         2 001223   100004 230011                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X1
         2 001224   200620 000010                    NDSC9   @TEMP+1,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         2 001225   200621 235100                    LDA     @TEMP+2,,AUTO
         2 001226   200122 755100                    STA     TEMP,,AUTO

      376    14771    3        DO CASE(P$->P$B.CODE);

  14771  2 001227   100000 721100                    LXL1    0,,PR1
         2 001230   000005 101003                    CMPX1   5,DU
         2 001231   001233 602011 2                  TNC     s:14771+4,X1
         2 001232   001274 710000 2                  TRA     s:14792
         2 001233   001274 710000 2                  TRA     s:14792
         2 001234   001240 710000 2                  TRA     s:14774
         2 001235   001254 710000 2                  TRA     s:14783
         2 001236   001262 710000 2                  TRA     s:14786
         2 001237   001270 710000 2                  TRA     s:14789

PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:70   
      377    14772        /**/
      378    14773    3         CASE(PL_WIDTH);

      379    14774    3           IF TEMP > 254

  14774  2 001240   000377 115007                    CMPA    255,DL
         2 001241   001246 602000 2                  TNC     s:14780

      380    14775    3              THEN
      381    14776    4                 DO;

      382    14777    4                    PLATEN_VLP.EXTWID# = %YES#;

  14777  2 001242   001000 236003                    LDQ     512,DU
         2 001243   200575 256100                    ORSQ    PLATEN_VLP+1,,AUTO

      383    14778    4                    TEMP = TEMP - 254;

  14778  2 001244   000376 135007                    SBLA    254,DL
         2 001245   200122 755100                    STA     TEMP,,AUTO

      384    14779    4                 END;

      385    14780    3           PLATEN_VLP.WIDTH# = TEMP;

  14780  2 001246   200122 236100                    LDQ     TEMP,,AUTO
         2 001247   000033 736000                    QLS     27
         2 001250   200574 676100                    ERQ     PLATEN_VLP,,AUTO
         2 001251   377000 376003                    ANQ     130560,DU
         2 001252   200574 656100                    ERSQ    PLATEN_VLP,,AUTO
         2 001253   001274 710000 2                  TRA     s:14792

      386    14781        /**/
      387    14782    3         CASE(PL_LENGTH);

      388    14783    3           PLATEN_VLP.LENGTH# = TEMP;

PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:71   
  14783  2 001254   200122 236100                    LDQ     TEMP,,AUTO
         2 001255   000022 736000                    QLS     18
         2 001256   200574 676100                    ERQ     PLATEN_VLP,,AUTO
         2 001257   000377 376003                    ANQ     255,DU
         2 001260   200574 656100                    ERSQ    PLATEN_VLP,,AUTO
         2 001261   001274 710000 2                  TRA     s:14792

      389    14784        /**/
      390    14785    3         CASE(PL_LIMBO);

      391    14786    3           PLATEN_VLP.LIMBO# = TEMP;

  14786  2 001262   200122 236100                    LDQ     TEMP,,AUTO
         2 001263   000011 736000                    QLS     9
         2 001264   200574 676100                    ERQ     PLATEN_VLP,,AUTO
         2 001265   377000 376007                    ANQ     130560,DL
         2 001266   200574 656100                    ERSQ    PLATEN_VLP,,AUTO
         2 001267   001274 710000 2                  TRA     s:14792

      392    14787        /**/
      393    14788    3         CASE(PL_1STLINE);

      394    14789    3           PLATEN_VLP.FIRSTLINE# = TEMP;

  14789  2 001270   200122 236100                    LDQ     TEMP,,AUTO
         2 001271   200574 676100                    ERQ     PLATEN_VLP,,AUTO
         2 001272   000377 376007                    ANQ     255,DL
         2 001273   200574 656100                    ERSQ    PLATEN_VLP,,AUTO

      395    14790    3         END;

      396    14791        /**/
      397    14792    2        I = I + 1;

  14792  2 001274   200117 054100                    AOS     I,,AUTO

      398    14793    2     END;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:72   

  14793  2 001275   000001 236100                    LDQ     1,,PR0
         2 001276   000022 772000                    QRL     18
         2 001277   200117 116100                    CMPQ    I,,AUTO
         2 001300   001212 605400 2                  TPNZ    s:14769

      399    14794    1     CALL M$PLATEN(FPT_PLATEN) ALTRET(E_PLATEN);

  14794  2 001301   200360 630500                    EPPR0   FPT_PLATEN,,AUTO
         2 001302   560010 713400                    CLIMB   alt,+57352
         2 001303   401000 401760                    pmme    nvectors=3
         2 001304   001335 702000 2                  TSX2    E_PLATEN

      400    14795    1     IF DCBADDR(M$IBEX1_NUM)->F$DCB.FCD#

  14795  2 001305   000014 470400 3                  LDP0    12
         2 001306   000000 471500                    LDP1    0,,PR0
         2 001307   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 001310   100000 473510                    LDP3    0,X0,PR1
         2 001311   300031 236100                    LDQ     25,,PR3
         2 001312   020000 316007                    CANQ    8192,DL
         2 001313   001334 600000 2                  TZE     s:14806

      401    14796    1         THEN
      402    14797    2             DO;

      403    14798    2               FPT_CLOSE = CFPT_CLOSE ;

  14798  2 001314   000100 100400                    MLR     fill='000'O
         2 001315   000000 000170 xsym               ADSC9   CFPT_CLOSE               cn=0,n=120
         2 001316   200246 000170                    ADSC9   FPT_CLOSE,,AUTO          cn=0,n=120

      404    14799    2               FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V) ;

  14799  2 001317   000004 235000 3                  LDA     4
         2 001320   200620 452500                    STP2    @TEMP+1,,AUTO
         2 001321   200620 236100                    LDQ     @TEMP+1,,AUTO
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:73   
         2 001322   000300 036003                    ADLQ    192,DU
         2 001323   200246 757100                    STAQ    FPT_CLOSE,,AUTO

      405    14800    2               FPT_CLOSE.V.DCB#=M$IBEX1_NUM ;

  14800  2 001324   200300 740100                    STX0    FPT_CLOSE+26,,AUTO

      406    14801    2               FPT_CLOSE.V.DISP#=%SAVE#;

  14801  2 001325   000002 236007                    LDQ     2,DL
         2 001326   200300 552104                    STBQ    FPT_CLOSE+26,'04'O,AUTO

      407    14802    2               CALL M$CLOSE(FPT_CLOSE) WHENALTRETURN

  14802  2 001327   200246 630500                    EPPR0   FPT_CLOSE,,AUTO
         2 001330   450001 713400                    CLIMB   alt,close
         2 001331   406000 401760                    pmme    nvectors=13
         2 001332   001334 702000 2                  TSX2    s:14806
         2 001333   001334 710000 2                  TRA     s:14806

      408    14803    3                                       DO ;

      409    14804    3                                       END ;

      410    14805    2             END;

      411    14806    1     RETURN;

  14806  2 001334   000000 702200 xent               TSX2  ! X66_ARET

      412    14807    1   E_PLATEN:
      413    14808        /* ****    When running in batch mode, refrain from outputting msge.
      414    14809                   Indicating terminal control pmme's are illegal if not in t/s
      415    14810                   mode.                                 */
      416    14811    1     IF B$TCB.ALT$ -> B$ALT.ERR.CODE = %E$NOTTS

  14811  2 001335   000000 470400 xsym  E_PLATEN     LDP0    B$TCB$
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:74   
         2 001336   000000 471500                    LDP1    0,,PR0
         2 001337   100102 236100                    LDQ     66,,PR1
         2 001340   377770 376007                    ANQ     131064,DL
         2 001341   020330 116007                    CMPQ    8408,DL
         2 001342   001344 601000 2                  TNZ     s:14814

      417    14812    1        THEN
      418    14813    1           RETURN;

  14813  2 001343   000000 702200 xent               TSX2  ! X66_ARET

      419    14814    1     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$TCB.ALT$->B$ALT.ERR);

  14814  2 001344   000000 236000 xsym               LDQ     SEG2$
         2 001345   000003 036003                    ADLQ    3,DU
         2 001346   200620 756100                    STQ     @TEMP+1,,AUTO
         2 001347   100102 633500                    EPPR3   66,,PR1
         2 001350   200623 453500                    STP3    @TEMP+4,,AUTO
         2 001351   000007 236000 3                  LDQ     7
         2 001352   200622 756100                    STQ     @TEMP+3,,AUTO
         2 001353   200620 631500                    EPPR1   @TEMP+1,,AUTO
         2 001354   200621 451500                    STP1    @TEMP+2,,AUTO
         2 001355   200621 630500                    EPPR0   @TEMP+2,,AUTO
         2 001356   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001357   000000 701000 xent               TSX1    CXP$POSTERR
         2 001360   000000 011000                    NOP     0

      420    14815    1   E_PLATEN_LIST:
      421    14816    1     IF DCBADDR(M$IBEX1_NUM)->F$DCB.FCD#

  14816  2 001361   000014 470400 3     E_PLATEN_LI* LDP0    12
         2 001362   000000 471500                    LDP1    0,,PR0
         2 001363   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 001364   100000 473510                    LDP3    0,X0,PR1
         2 001365   300031 236100                    LDQ     25,,PR3
         2 001366   020000 316007                    CANQ    8192,DL
         2 001367   001410 600000 2                  TZE     s:14827
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:75   

      422    14817    1        THEN
      423    14818    2           DO;

      424    14819    2             FPT_CLOSE = CFPT_CLOSE ;

  14819  2 001370   000100 100400                    MLR     fill='000'O
         2 001371   000000 000170 xsym               ADSC9   CFPT_CLOSE               cn=0,n=120
         2 001372   200246 000170                    ADSC9   FPT_CLOSE,,AUTO          cn=0,n=120

      425    14820    2             FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V) ;

  14820  2 001373   000004 235000 3                  LDA     4
         2 001374   200620 452500                    STP2    @TEMP+1,,AUTO
         2 001375   200620 236100                    LDQ     @TEMP+1,,AUTO
         2 001376   000300 036003                    ADLQ    192,DU
         2 001377   200246 757100                    STAQ    FPT_CLOSE,,AUTO

      426    14821    2             FPT_CLOSE.V.DCB#=M$IBEX1_NUM ;

  14821  2 001400   200300 740100                    STX0    FPT_CLOSE+26,,AUTO

      427    14822    2             FPT_CLOSE.V.DISP#=%SAVE#;

  14822  2 001401   000002 236007                    LDQ     2,DL
         2 001402   200300 552104                    STBQ    FPT_CLOSE+26,'04'O,AUTO

      428    14823    2             CALL M$CLOSE(FPT_CLOSE) WHENALTRETURN

  14823  2 001403   200246 630500                    EPPR0   FPT_CLOSE,,AUTO
         2 001404   450001 713400                    CLIMB   alt,close
         2 001405   406000 401760                    pmme    nvectors=13
         2 001406   001410 702000 2                  TSX2    s:14827
         2 001407   001410 710000 2                  TRA     s:14827

      429    14824    3                                       DO ;

PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:76   
      430    14825    3                                       END ;

      431    14826    2           END;

      432    14827    1     ALTRETURN;

  14827  2 001410   000000 702200 xent               TSX2  ! X66_AALT

      433    14828        %EJECT;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:77   
      434    14829        /*F*    NAME:      CPB$REPORT
      435    14830                PURPOSE:   To process the REPORT command.
      436    14831                REFERENCE: Programmers Reference Manual
      437    14832        */
      438    14833    1   CPB$REPORT:
      439    14834    1     ENTRY(P$PCB) ALTRET;

  14834  2 001411   000000 700200 xent  CPB$REPORT   TSX0  ! X66_AUTO_1
         2 001412   000626 000001                    ZERO    406,1

      440    14835        /**/
      441    14836    1     BLK$ = P$PCB.OUT$;

  14836  2 001413   200003 470500                    LDP0    @P$PCB,,AUTO
         2 001414   000003 236100                    LDQ     3,,PR0
         2 001415   200005 756100                    STQ     BLK$,,AUTO

      442    14837    1     IF BLK$ -> P$B.NSUBLKS = 0

  14837  2 001416   200005 471500                    LDP1    BLK$,,AUTO
         2 001417   100001 220100                    LDX0    1,,PR1
         2 001420   001614 601000 2                  TNZ     s:14877

      443    14838    1        THEN
      444    14839    2           DO; /* Display level of reporting */

      445    14840    2              TEMPBUF$ = ADDR(TEMPBUF);

  14840  2 001421   200017 633500                    EPPR3   TEMPBUF,,AUTO
         2 001422   200007 453500                    STP3    TEMPBUF$,,AUTO

      446    14841    2              DEST$ = TEMPBUF$;

  14841  2 001423   200007 236100                    LDQ     TEMPBUF$,,AUTO
         2 001424   200010 756100                    STQ     DEST$,,AUTO

      447    14842    2              TEMPBUF = REPORTHDR;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:78   

  14842  2 001425   040100 100400                    MLR     fill='040'O
         2 001426   000005 000013 1                  ADSC9   REPORTHDR                cn=0,n=11
         2 001427   200017 000400                    ADSC9   TEMPBUF,,AUTO            cn=0,n=256

      448    14843    2              DEST$ = PINCRC(DEST$,SIZEC(REPORTHDR));

  14843  2 001430   000024 036000 3                  ADLQ    20
         2 001431   200010 756100                    STQ     DEST$,,AUTO

      449    14844    2              TAB_VAL = 6;

  14844  2 001432   000006 235007                    LDA     6,DL
         2 001433   200125 755100                    STA     TAB_VAL,,AUTO

      450    14845    2              TBUFF = 'Job = ';

  14845  2 001434   040100 100400                    MLR     fill='040'O
         2 001435   000022 000006 1                  ADSC9   E_RPTATJS+10             cn=0,n=6
         2 001436   200011 000030                    ADSC9   TMDATE,,AUTO             cn=0,n=24

      451    14846    2              CALL CPB$BLDIMAGE(TEMPBUF$,DEST$,ADDR(TBUFF),SIZEC('Job = '),

  14846  2 001437   200011 634500                    EPPR4   TMDATE,,AUTO
         2 001440   200620 454500                    STP4    @TEMP+1,,AUTO
         2 001441   200125 635500                    EPPR5   TAB_VAL,,AUTO
         2 001442   200625 455500                    STP5    @TEMP+6,,AUTO
         2 001443   000025 236000 3                  LDQ     21
         2 001444   200624 756100                    STQ     @TEMP+5,,AUTO
         2 001445   200620 636500                    EPPR6   @TEMP+1,,AUTO
         2 001446   200623 456500                    STP6    @TEMP+4,,AUTO
         2 001447   200010 637500                    EPPR7   DEST$,,AUTO
         2 001450   200622 457500                    STP7    @TEMP+3,,AUTO
         2 001451   200007 630500                    EPPR0   TEMPBUF$,,AUTO
         2 001452   200621 450500                    STP0    @TEMP+2,,AUTO
         2 001453   200621 630500                    EPPR0   @TEMP+2,,AUTO
         2 001454   000023 631400 xsym               EPPR1   B_VECTNIL+19
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:79   
         2 001455   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 001456   002232 702000 2                  TSX2    E_REPORT

      452    14847    2                    TAB_VAL) ALTRET(E_REPORT);
      453    14848    2              TEMP = B$JIT.JSLEV;

  14848  2 001457   000000 470400 xsym               LDP0    B$JIT$
         2 001460   000151 236100                    LDQ     105,,PR0
         2 001461   000041 772000                    QRL     33
         2 001462   200122 756100                    STQ     TEMP,,AUTO

      454    14849    2              CALL PUT_LEVEL(TEMP);

  14849  2 001463   200122 631500                    EPPR1   TEMP,,AUTO
         2 001464   200617 451500                    STP1    PLATEN_VLP+19,,AUTO
         2 001465   002444 701000 2                  TSX1    PUT_LEVEL
         2 001466   000000 011000                    NOP     0

      455    14850    2              DEST$ = PINCRC(DEST$,2);

  14850  2 001467   200010 236100                    LDQ     DEST$,,AUTO
         2 001470   400000 036007                    ADLQ    -131072,DL
         2 001471   200010 756100                    STQ     DEST$,,AUTO

      456    14851    2              TBUFF = 'Step = ';

  14851  2 001472   040100 100400                    MLR     fill='040'O
         2 001473   000024 000007 1                  ADSC9   E_RPTATJS+12             cn=0,n=7
         2 001474   200011 000030                    ADSC9   TMDATE,,AUTO             cn=0,n=24

      457    14852    2              CALL CPB$BLDIMAGE(TEMPBUF$,DEST$,ADDR(TBUFF),SIZEC('Step = '),

  14852  2 001475   200011 630500                    EPPR0   TMDATE,,AUTO
         2 001476   200620 450500                    STP0    @TEMP+1,,AUTO
         2 001477   200125 631500                    EPPR1   TAB_VAL,,AUTO
         2 001500   200625 451500                    STP1    @TEMP+6,,AUTO
         2 001501   000026 236000 3                  LDQ     22
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:80   
         2 001502   200624 756100                    STQ     @TEMP+5,,AUTO
         2 001503   200620 633500                    EPPR3   @TEMP+1,,AUTO
         2 001504   200623 453500                    STP3    @TEMP+4,,AUTO
         2 001505   200010 634500                    EPPR4   DEST$,,AUTO
         2 001506   200622 454500                    STP4    @TEMP+3,,AUTO
         2 001507   200007 635500                    EPPR5   TEMPBUF$,,AUTO
         2 001510   200621 455500                    STP5    @TEMP+2,,AUTO
         2 001511   200621 630500                    EPPR0   @TEMP+2,,AUTO
         2 001512   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 001513   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 001514   002232 702000 2                  TSX2    E_REPORT

      458    14853    2                    TAB_VAL) ALTRET(E_REPORT);
      459    14854    2              TEMP = B$JIT.SSLEV;

  14854  2 001515   000000 470400 xsym               LDP0    B$JIT$
         2 001516   000151 236100                    LDQ     105,,PR0
         2 001517   000033 772000                    QRL     27
         2 001520   000007 376007                    ANQ     7,DL
         2 001521   200122 756100                    STQ     TEMP,,AUTO

      460    14855    2              CALL PUT_LEVEL(TEMP);

  14855  2 001522   200122 631500                    EPPR1   TEMP,,AUTO
         2 001523   200617 451500                    STP1    PLATEN_VLP+19,,AUTO
         2 001524   002444 701000 2                  TSX1    PUT_LEVEL
         2 001525   000000 011000                    NOP     0

      461    14856    2              DEST$ = PINCRC(DEST$,2);

  14856  2 001526   200010 236100                    LDQ     DEST$,,AUTO
         2 001527   400000 036007                    ADLQ    -131072,DL
         2 001530   200010 756100                    STQ     DEST$,,AUTO

      462    14857    2              TBUFF = 'Proprietary = ';

  14857  2 001531   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:81   
         2 001532   000026 000016 1                  ADSC9   E_RPTATJS+14             cn=0,n=14
         2 001533   200011 000030                    ADSC9   TMDATE,,AUTO             cn=0,n=24

      463    14858    2              CALL CPB$BLDIMAGE(TEMPBUF$,DEST$,ADDR(TBUFF),SIZEC('Proprietary = '),

  14858  2 001534   200011 630500                    EPPR0   TMDATE,,AUTO
         2 001535   200620 450500                    STP0    @TEMP+1,,AUTO
         2 001536   200125 631500                    EPPR1   TAB_VAL,,AUTO
         2 001537   200625 451500                    STP1    @TEMP+6,,AUTO
         2 001540   000030 236000 3                  LDQ     24
         2 001541   200624 756100                    STQ     @TEMP+5,,AUTO
         2 001542   200620 633500                    EPPR3   @TEMP+1,,AUTO
         2 001543   200623 453500                    STP3    @TEMP+4,,AUTO
         2 001544   200010 634500                    EPPR4   DEST$,,AUTO
         2 001545   200622 454500                    STP4    @TEMP+3,,AUTO
         2 001546   200007 635500                    EPPR5   TEMPBUF$,,AUTO
         2 001547   200621 455500                    STP5    @TEMP+2,,AUTO
         2 001550   200621 630500                    EPPR0   @TEMP+2,,AUTO
         2 001551   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 001552   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 001553   002232 702000 2                  TSX2    E_REPORT

      464    14859    2                    TAB_VAL) ALTRET(E_REPORT);
      465    14860    2              TEMP = B$JIT.PSLEV;

  14860  2 001554   000000 470400 xsym               LDP0    B$JIT$
         2 001555   000151 236100                    LDQ     105,,PR0
         2 001556   000036 772000                    QRL     30
         2 001557   000007 376007                    ANQ     7,DL
         2 001560   200122 756100                    STQ     TEMP,,AUTO

      466    14861    2              CALL PUT_LEVEL(TEMP);

  14861  2 001561   200122 631500                    EPPR1   TEMP,,AUTO
         2 001562   200617 451500                    STP1    PLATEN_VLP+19,,AUTO
         2 001563   002444 701000 2                  TSX1    PUT_LEVEL
         2 001564   000000 011000                    NOP     0
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:82   

      467    14862    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,TEMPBUF$);

  14862  2 001565   000000 470400 xsym               LDP0    SEG2$
         2 001566   000165 471500                    LDP1    117,,PR0
         2 001567   200007 236100                    LDQ     TEMPBUF$,,AUTO
         2 001570   000020 772000                    QRL     16
         2 001571   200620 756100                    STQ     @TEMP+1,,AUTO
         2 001572   200010 236100                    LDQ     DEST$,,AUTO
         2 001573   000020 772000                    QRL     16
         2 001574   200620 136100                    SBLQ    @TEMP+1,,AUTO
         2 001575   000020 736000                    QLS     16
         2 001576   100004 676100                    ERQ     4,,PR1
         2 001577   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 001600   100004 656100                    ERSQ    4,,PR1

      468    14863    2              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=TEMPBUF$;

  14863  2 001601   000165 471500                    LDP1    117,,PR0
         2 001602   200007 236100                    LDQ     TEMPBUF$,,AUTO
         2 001603   100005 756100                    STQ     5,,PR1

      469    14864    2              CALL CPE$LISTOUT (SEG$2.FPT_WRITE$) ALTRET(E_REPORT);

  14864  2 001604   000000 236000 xsym               LDQ     SEG2$
         2 001605   000165 036003                    ADLQ    117,DU
         2 001606   200620 756100                    STQ     @TEMP+1,,AUTO
         2 001607   200620 630500                    EPPR0   @TEMP+1,,AUTO
         2 001610   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001611   000000 701000 xent               TSX1    CPE$LISTOUT
         2 001612   002232 702000 2                  TSX2    E_REPORT

      470    14865    2              RETURN;

  14865  2 001613   000000 702200 xent               TSX2  ! X66_ARET

      471    14866    2           END;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:83   
      472    14867        /*
      473    14868             ***** Only allowed to turn step reporting on/off when not at
      474    14869                   job step.
      475    14870        */
      476    14871        /*E*    ERROR: CPB-E$RPTATJS-0
      477    14872             MESSAGE: Can't change STEP/PROPRIETARY reporting to/from NONE during job step.
      478    14873        */
      479    14874        /*
      480    14875             ***** Set B$JIT.??LEV to reflect the level desired...
      481    14876        */
      482    14877    1     TEMP2 = BLK$ -> P$B.SUBLK$(0) -> P$B.CODE;   /* TYPE OF REPORT */

  14877  2 001614   100003 473500                    LDP3    3,,PR1
         2 001615   300000 236100                    LDQ     0,,PR3
         2 001616   777777 376007                    ANQ     -1,DL
         2 001617   200123 756100                    STQ     TEMP2,,AUTO

      483    14878    1     IF BLK$ -> P$B.NSUBLKS = 1  THEN

  14878  2 001620   000001 100003                    CMPX0   1,DU
         2 001621   001626 601000 2                  TNZ     s:14885

      484    14879    2           DO;   /* Backward compatablity code */

      485    14880    2              TEMP3 = BLK$ -> P$B.SUBLK$(0) -> P$B.CODE;

  14880  2 001622   200124 756100                    STQ     TEMP3,,AUTO

      486    14881    2              CPOS = BLK$ -> P$B.SUBLK$(0) -> P$B.CPOS;

  14881  2 001623   300002 235100                    LDA     2,,PR3
         2 001624   200126 755100                    STA     CPOS,,AUTO

      487    14882    2           END;   /* Backward compatablity code */

  14882  2 001625   001634 710000 2                  TRA     s:14896

PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:84   
      488    14883    1     ELSE
      489    14884    2           DO;

      490    14885    2              TEMP3 = BLK$ -> P$B.SUBLK$(1) -> P$B.CODE;

  14885  2 001626   100004 474500                    LDP4    4,,PR1
         2 001627   400000 236100                    LDQ     0,,PR4
         2 001630   777777 376007                    ANQ     -1,DL
         2 001631   200124 756100                    STQ     TEMP3,,AUTO

      491    14886    2              CPOS = BLK$ -> P$B.SUBLK$(1) -> P$B.CPOS;

  14886  2 001632   400002 235100                    LDA     2,,PR4
         2 001633   200126 755100                    STA     CPOS,,AUTO

      492    14887    2           END;

      493    14888        /*
      494    14889             ***** It is not possible to change the level of reporting
      495    14890                   for STEP or PROPRIATARY reports if no stats snapshot
      496    14891                   was done before the rununit was invoked. And if a
      497    14892                   snapshot was done then you may not turn off the report.
      498    14893                   This would cause an extraneous snapshot to lay around
      499    14894                   and would confuse accounting at logoff time ...
      500    14895        */
      501    14896    2     DO CASE(TEMP3);

  14896  2 001634   000004 116007                    CMPQ    4,DL
         2 001635   001637 602006 2                  TNC     s:14896+3,QL
         2 001636   002101 710000 2                  TRA     s:14961
         2 001637   002101 710000 2                  TRA     s:14961
         2 001640   001643 710000 2                  TRA     s:14898
         2 001641   001730 710000 2                  TRA     s:14918
         2 001642   002015 710000 2                  TRA     s:14938

      502    14897    2      CASE (RE_FULL);

PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:85   
      503    14898    2        IF NOT(B$JIT.CPFLAGS1 & %CP_JSTEP#)

  14898  2 001643   000000 473400 xsym               LDP3    B$JIT$
         2 001644   300143 236100                    LDQ     99,,PR3
         2 001645   000032 376000 1                  ANQ     E_RPTATJS+18
         2 001646   001725 601000 2                  TNZ     s:14916

      504    14899    2           THEN
      505    14900    3              DO;

      506    14901    3                 IF B$JIT.SSLEV = %AZ_NONE#

  14901  2 001647   300151 236100                    LDQ     105,,PR3
         2 001650   007000 376003                    ANQ     3584,DU
         2 001651   003000 116003                    CMPQ    1536,DU
         2 001652   001676 601000 2                  TNZ     s:14908
         2 001653   200123 235100                    LDA     TEMP2,,AUTO
         2 001654   000004 115007                    CMPA    4,DL
         2 001655   001660 600000 2                  TZE     s:14905
         2 001656   000007 115007                    CMPA    7,DL
         2 001657   001676 601000 2                  TNZ     s:14908

      507    14902    3                 AND (TEMP2 = RE_STEP OR TEMP2 = RE_ALL)
      508    14903    3                    THEN   /* Not allowed to change */
      509    14904    4                       DO;

      510    14905    4                          CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_RPTATJS);

  14905  2 001660   000000 236000 xsym               LDQ     SEG2$
         2 001661   000003 036003                    ADLQ    3,DU
         2 001662   200620 756100                    STQ     @TEMP+1,,AUTO
         2 001663   000031 236000 3                  LDQ     25
         2 001664   200623 756100                    STQ     @TEMP+4,,AUTO
         2 001665   200126 634500                    EPPR4   CPOS,,AUTO
         2 001666   200622 454500                    STP4    @TEMP+3,,AUTO
         2 001667   200620 635500                    EPPR5   @TEMP+1,,AUTO
         2 001670   200621 455500                    STP5    @TEMP+2,,AUTO
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:86   
         2 001671   200621 630500                    EPPR0   @TEMP+2,,AUTO
         2 001672   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001673   000000 701000 xent               TSX1    CXP$POSTERR
         2 001674   000000 011000                    NOP     0

      511    14906    4                          ALTRETURN;

  14906  2 001675   000000 702200 xent               TSX2  ! X66_AALT

      512    14907    4                       END;
      513    14908    3                 IF B$JIT.PSLEV = %AZ_NONE#

  14908  2 001676   300151 236100                    LDQ     105,,PR3
         2 001677   070000 376003                    ANQ     28672,DU
         2 001700   030000 116003                    CMPQ    12288,DU
         2 001701   001725 601000 2                  TNZ     s:14916
         2 001702   200123 235100                    LDA     TEMP2,,AUTO
         2 001703   000005 115007                    CMPA    5,DL
         2 001704   001707 600000 2                  TZE     s:14912
         2 001705   000007 115007                    CMPA    7,DL
         2 001706   001725 601000 2                  TNZ     s:14916

      514    14909    3                 AND (TEMP2 = RE_PROP OR TEMP2 = RE_ALL)
      515    14910    3                    THEN   /* Not allowed to change */
      516    14911    4                       DO;

      517    14912    4                          CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_RPTATJS);

  14912  2 001707   000000 236000 xsym               LDQ     SEG2$
         2 001710   000003 036003                    ADLQ    3,DU
         2 001711   200620 756100                    STQ     @TEMP+1,,AUTO
         2 001712   000031 236000 3                  LDQ     25
         2 001713   200623 756100                    STQ     @TEMP+4,,AUTO
         2 001714   200126 634500                    EPPR4   CPOS,,AUTO
         2 001715   200622 454500                    STP4    @TEMP+3,,AUTO
         2 001716   200620 635500                    EPPR5   @TEMP+1,,AUTO
         2 001717   200621 455500                    STP5    @TEMP+2,,AUTO
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:87   
         2 001720   200621 630500                    EPPR0   @TEMP+2,,AUTO
         2 001721   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001722   000000 701000 xent               TSX1    CXP$POSTERR
         2 001723   000000 011000                    NOP     0

      518    14913    4                          ALTRETURN;

  14913  2 001724   000000 702200 xent               TSX2  ! X66_AALT

      519    14914    4                       END;
      520    14915    3              END;
      521    14916    2        TEMP = %AZ_ALL#;

  14916  2 001725   000001 235007                    LDA     1,DL
         2 001726   200122 755100                    STA     TEMP,,AUTO
         2 001727   002101 710000 2                  TRA     s:14961

      522    14917    2      CASE (RE_SUMMARY);

      523    14918    2        IF NOT(B$JIT.CPFLAGS1 & %CP_JSTEP#)

  14918  2 001730   000000 473400 xsym               LDP3    B$JIT$
         2 001731   300143 236100                    LDQ     99,,PR3
         2 001732   000032 376000 1                  ANQ     E_RPTATJS+18
         2 001733   002012 601000 2                  TNZ     s:14936

      524    14919    2           THEN
      525    14920    3              DO;

      526    14921    3                 IF B$JIT.SSLEV = %AZ_NONE#

  14921  2 001734   300151 236100                    LDQ     105,,PR3
         2 001735   007000 376003                    ANQ     3584,DU
         2 001736   003000 116003                    CMPQ    1536,DU
         2 001737   001763 601000 2                  TNZ     s:14928
         2 001740   200123 235100                    LDA     TEMP2,,AUTO
         2 001741   000004 115007                    CMPA    4,DL
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:88   
         2 001742   001745 600000 2                  TZE     s:14925
         2 001743   000007 115007                    CMPA    7,DL
         2 001744   001763 601000 2                  TNZ     s:14928

      527    14922    3                 AND (TEMP2 = RE_STEP OR TEMP2 = RE_ALL)
      528    14923    3                    THEN   /* Not allowed to change */
      529    14924    4                       DO;

      530    14925    4                          CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_RPTATJS);

  14925  2 001745   000000 236000 xsym               LDQ     SEG2$
         2 001746   000003 036003                    ADLQ    3,DU
         2 001747   200620 756100                    STQ     @TEMP+1,,AUTO
         2 001750   000031 236000 3                  LDQ     25
         2 001751   200623 756100                    STQ     @TEMP+4,,AUTO
         2 001752   200126 634500                    EPPR4   CPOS,,AUTO
         2 001753   200622 454500                    STP4    @TEMP+3,,AUTO
         2 001754   200620 635500                    EPPR5   @TEMP+1,,AUTO
         2 001755   200621 455500                    STP5    @TEMP+2,,AUTO
         2 001756   200621 630500                    EPPR0   @TEMP+2,,AUTO
         2 001757   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001760   000000 701000 xent               TSX1    CXP$POSTERR
         2 001761   000000 011000                    NOP     0

      531    14926    4                          ALTRETURN;

  14926  2 001762   000000 702200 xent               TSX2  ! X66_AALT

      532    14927    4                       END;
      533    14928    3                 IF B$JIT.PSLEV = %AZ_NONE#

  14928  2 001763   300151 236100                    LDQ     105,,PR3
         2 001764   070000 376003                    ANQ     28672,DU
         2 001765   030000 116003                    CMPQ    12288,DU
         2 001766   002012 601000 2                  TNZ     s:14936
         2 001767   200123 235100                    LDA     TEMP2,,AUTO
         2 001770   000005 115007                    CMPA    5,DL
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:89   
         2 001771   001774 600000 2                  TZE     s:14932
         2 001772   000007 115007                    CMPA    7,DL
         2 001773   002012 601000 2                  TNZ     s:14936

      534    14929    3                 AND (TEMP2 = RE_PROP OR TEMP2 = RE_ALL)
      535    14930    3                    THEN   /* Not allowed to change */
      536    14931    4                       DO;

      537    14932    4                          CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_RPTATJS);

  14932  2 001774   000000 236000 xsym               LDQ     SEG2$
         2 001775   000003 036003                    ADLQ    3,DU
         2 001776   200620 756100                    STQ     @TEMP+1,,AUTO
         2 001777   000031 236000 3                  LDQ     25
         2 002000   200623 756100                    STQ     @TEMP+4,,AUTO
         2 002001   200126 634500                    EPPR4   CPOS,,AUTO
         2 002002   200622 454500                    STP4    @TEMP+3,,AUTO
         2 002003   200620 635500                    EPPR5   @TEMP+1,,AUTO
         2 002004   200621 455500                    STP5    @TEMP+2,,AUTO
         2 002005   200621 630500                    EPPR0   @TEMP+2,,AUTO
         2 002006   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 002007   000000 701000 xent               TSX1    CXP$POSTERR
         2 002010   000000 011000                    NOP     0

      538    14933    4                          ALTRETURN;

  14933  2 002011   000000 702200 xent               TSX2  ! X66_AALT

      539    14934    4                       END;
      540    14935    3              END;
      541    14936    2        TEMP = %AZ_SUMMARY#;

  14936  2 002012   000002 235007                    LDA     2,DL
         2 002013   200122 755100                    STA     TEMP,,AUTO
         2 002014   002101 710000 2                  TRA     s:14961

      542    14937    2      CASE (RE_NONE);
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:90   

      543    14938    2        IF NOT(B$JIT.CPFLAGS1 & %CP_JSTEP#)

  14938  2 002015   000000 473400 xsym               LDP3    B$JIT$
         2 002016   300143 236100                    LDQ     99,,PR3
         2 002017   000032 376000 1                  ANQ     E_RPTATJS+18
         2 002020   002077 601000 2                  TNZ     s:14956

      544    14939    2           THEN
      545    14940    3              DO;

      546    14941    3                 IF B$JIT.SSLEV ~= %AZ_NONE#

  14941  2 002021   300151 236100                    LDQ     105,,PR3
         2 002022   007000 376003                    ANQ     3584,DU
         2 002023   003000 116003                    CMPQ    1536,DU
         2 002024   002050 600000 2                  TZE     s:14948
         2 002025   200123 235100                    LDA     TEMP2,,AUTO
         2 002026   000004 115007                    CMPA    4,DL
         2 002027   002032 600000 2                  TZE     s:14945
         2 002030   000007 115007                    CMPA    7,DL
         2 002031   002050 601000 2                  TNZ     s:14948

      547    14942    3                 AND (TEMP2 = RE_STEP OR TEMP2 = RE_ALL)
      548    14943    3                    THEN   /* Not allowed to change */
      549    14944    4                       DO;

      550    14945    4                          CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_RPTATJS);

  14945  2 002032   000000 236000 xsym               LDQ     SEG2$
         2 002033   000003 036003                    ADLQ    3,DU
         2 002034   200620 756100                    STQ     @TEMP+1,,AUTO
         2 002035   000031 236000 3                  LDQ     25
         2 002036   200623 756100                    STQ     @TEMP+4,,AUTO
         2 002037   200126 634500                    EPPR4   CPOS,,AUTO
         2 002040   200622 454500                    STP4    @TEMP+3,,AUTO
         2 002041   200620 635500                    EPPR5   @TEMP+1,,AUTO
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:91   
         2 002042   200621 455500                    STP5    @TEMP+2,,AUTO
         2 002043   200621 630500                    EPPR0   @TEMP+2,,AUTO
         2 002044   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 002045   000000 701000 xent               TSX1    CXP$POSTERR
         2 002046   000000 011000                    NOP     0

      551    14946    4                          ALTRETURN;

  14946  2 002047   000000 702200 xent               TSX2  ! X66_AALT

      552    14947    4                       END;
      553    14948    3                 IF B$JIT.PSLEV ~= %AZ_NONE#

  14948  2 002050   300151 236100                    LDQ     105,,PR3
         2 002051   070000 376003                    ANQ     28672,DU
         2 002052   030000 116003                    CMPQ    12288,DU
         2 002053   002077 600000 2                  TZE     s:14956
         2 002054   200123 235100                    LDA     TEMP2,,AUTO
         2 002055   000005 115007                    CMPA    5,DL
         2 002056   002061 600000 2                  TZE     s:14952
         2 002057   000007 115007                    CMPA    7,DL
         2 002060   002077 601000 2                  TNZ     s:14956

      554    14949    3                 AND (TEMP2 = RE_PROP OR TEMP2 = RE_ALL)
      555    14950    3                    THEN   /* Not allowed to change */
      556    14951    4                       DO;

      557    14952    4                          CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_RPTATJS);

  14952  2 002061   000000 236000 xsym               LDQ     SEG2$
         2 002062   000003 036003                    ADLQ    3,DU
         2 002063   200620 756100                    STQ     @TEMP+1,,AUTO
         2 002064   000031 236000 3                  LDQ     25
         2 002065   200623 756100                    STQ     @TEMP+4,,AUTO
         2 002066   200126 634500                    EPPR4   CPOS,,AUTO
         2 002067   200622 454500                    STP4    @TEMP+3,,AUTO
         2 002070   200620 635500                    EPPR5   @TEMP+1,,AUTO
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:92   
         2 002071   200621 455500                    STP5    @TEMP+2,,AUTO
         2 002072   200621 630500                    EPPR0   @TEMP+2,,AUTO
         2 002073   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 002074   000000 701000 xent               TSX1    CXP$POSTERR
         2 002075   000000 011000                    NOP     0

      558    14953    4                          ALTRETURN;

  14953  2 002076   000000 702200 xent               TSX2  ! X66_AALT

      559    14954    4                       END;
      560    14955    3              END;
      561    14956    2        TEMP = %AZ_NONE#;

  14956  2 002077   000003 235007                    LDA     3,DL
         2 002100   200122 755100                    STA     TEMP,,AUTO

      562    14957    2      END; /* do case ... end */

      563    14958        /*
      564    14959          **** This code has been included for backward compatibility.
      565    14960        */
      566    14961    1     IF BLK$ -> P$B.NSUBLKS = 1

  14961  2 002101   100001 220100                    LDX0    1,,PR1
         2 002102   000001 100003                    CMPX0   1,DU
         2 002103   002153 601000 2                  TNZ     s:14977

      567    14962    1        THEN
      568    14963    2           DO;   /* Handle old form */

      569    14964    2              IF NOT(B$JIT.CPFLAGS1 & %CP_JSTEP#)

  14964  2 002104   000000 473400 xsym               LDP3    B$JIT$
         2 002105   300143 236100                    LDQ     99,,PR3
         2 002106   000032 376000 1                  ANQ     E_RPTATJS+18
         2 002107   002145 601000 2                  TNZ     s:14973
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:93   
         2 002110   300151 236100                    LDQ     105,,PR3
         2 002111   007000 376003                    ANQ     3584,DU
         2 002112   003000 116003                    CMPQ    1536,DU
         2 002113   002117 601000 2                  TNZ     s:14964+11
         2 002114   200122 235100                    LDA     TEMP,,AUTO
         2 002115   000003 115007                    CMPA    3,DL
         2 002116   002127 601000 2                  TNZ     s:14969
         2 002117   200122 235100                    LDA     TEMP,,AUTO
         2 002120   000003 115007                    CMPA    3,DL
         2 002121   002145 601000 2                  TNZ     s:14973
         2 002122   300151 236100                    LDQ     105,,PR3
         2 002123   000033 772000                    QRL     27
         2 002124   000007 376007                    ANQ     7,DL
         2 002125   200122 116100                    CMPQ    TEMP,,AUTO
         2 002126   002145 600000 2                  TZE     s:14973

      570    14965    2              AND ((B$JIT.SSLEV = %AZ_NONE# AND TEMP ~= %AZ_NONE#)
      571    14966    2              OR (TEMP = %AZ_NONE# AND B$JIT.SSLEV ~= TEMP))
      572    14967    2                 THEN   /* Not allowed to change */
      573    14968    3                    DO;

      574    14969    3                       CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_RPTATJS);

  14969  2 002127   000000 236000 xsym               LDQ     SEG2$
         2 002130   000003 036003                    ADLQ    3,DU
         2 002131   200620 756100                    STQ     @TEMP+1,,AUTO
         2 002132   000031 236000 3                  LDQ     25
         2 002133   200623 756100                    STQ     @TEMP+4,,AUTO
         2 002134   200126 634500                    EPPR4   CPOS,,AUTO
         2 002135   200622 454500                    STP4    @TEMP+3,,AUTO
         2 002136   200620 635500                    EPPR5   @TEMP+1,,AUTO
         2 002137   200621 455500                    STP5    @TEMP+2,,AUTO
         2 002140   200621 630500                    EPPR0   @TEMP+2,,AUTO
         2 002141   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 002142   000000 701000 xent               TSX1    CXP$POSTERR
         2 002143   000000 011000                    NOP     0

PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:94   
      575    14970    3                       ALTRETURN;

  14970  2 002144   000000 702200 xent               TSX2  ! X66_AALT

      576    14971    3                    END;
      577    14972    2                 ELSE   /* Ok to change */
      578    14973    2                    B$JIT.SSLEV = TEMP;

  14973  2 002145   200122 236100                    LDQ     TEMP,,AUTO
         2 002146   000033 736000                    QLS     27
         2 002147   300151 676100                    ERQ     105,,PR3
         2 002150   007000 376003                    ANQ     3584,DU
         2 002151   300151 656100                    ERSQ    105,,PR3

      579    14974    2           END;   /* Handle old form */

  14974  2 002152   002231 710000 2                  TRA     s:14990

      580    14975    1     ELSE
      581    14976    2        DO;

      582    14977    3     DO CASE (TEMP2);

  14977  2 002153   200123 235100                    LDA     TEMP2,,AUTO
         2 002154   000004 135007                    SBLA    4,DL
         2 002155   000004 115007                    CMPA    4,DL
         2 002156   002160 602005 2                  TNC     s:14977+5,AL
         2 002157   002231 710000 2                  TRA     s:14990
         2 002160   002173 710000 2                  TRA     s:14981
         2 002161   002202 710000 2                  TRA     s:14983
         2 002162   002164 710000 2                  TRA     s:14979
         2 002163   002211 710000 2                  TRA     s:14985

      583    14978    3      CASE(RE_JOB);

      584    14979    3        B$JIT.JSLEV = TEMP;

PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:95   
  14979  2 002164   000000 473400 xsym               LDP3    B$JIT$
         2 002165   200122 236100                    LDQ     TEMP,,AUTO
         2 002166   000041 736000                    QLS     33
         2 002167   300151 676100                    ERQ     105,,PR3
         2 002170   700000 376003                    ANQ     -32768,DU
         2 002171   300151 656100                    ERSQ    105,,PR3
         2 002172   002231 710000 2                  TRA     s:14990

      585    14980    3      CASE(RE_STEP);

      586    14981    3        B$JIT.SSLEV = TEMP;

  14981  2 002173   000000 473400 xsym               LDP3    B$JIT$
         2 002174   200122 236100                    LDQ     TEMP,,AUTO
         2 002175   000033 736000                    QLS     27
         2 002176   300151 676100                    ERQ     105,,PR3
         2 002177   007000 376003                    ANQ     3584,DU
         2 002200   300151 656100                    ERSQ    105,,PR3
         2 002201   002231 710000 2                  TRA     s:14990

      587    14982    3      CASE(RE_PROP);

      588    14983    3        B$JIT.PSLEV = TEMP;

  14983  2 002202   000000 473400 xsym               LDP3    B$JIT$
         2 002203   200122 236100                    LDQ     TEMP,,AUTO
         2 002204   000036 736000                    QLS     30
         2 002205   300151 676100                    ERQ     105,,PR3
         2 002206   070000 376003                    ANQ     28672,DU
         2 002207   300151 656100                    ERSQ    105,,PR3
         2 002210   002231 710000 2                  TRA     s:14990

      589    14984    3      CASE(RE_ALL);

      590    14985    3        B$JIT.JSLEV = TEMP;

  14985  2 002211   000000 473400 xsym               LDP3    B$JIT$
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:96   
         2 002212   200122 236100                    LDQ     TEMP,,AUTO
         2 002213   000041 736000                    QLS     33
         2 002214   300151 676100                    ERQ     105,,PR3
         2 002215   700000 376003                    ANQ     -32768,DU
         2 002216   300151 656100                    ERSQ    105,,PR3

      591    14986    3        B$JIT.SSLEV = TEMP;

  14986  2 002217   200122 236100                    LDQ     TEMP,,AUTO
         2 002220   000033 736000                    QLS     27
         2 002221   300151 676100                    ERQ     105,,PR3
         2 002222   007000 376003                    ANQ     3584,DU
         2 002223   300151 656100                    ERSQ    105,,PR3

      592    14987    3        B$JIT.PSLEV = TEMP;

  14987  2 002224   200122 236100                    LDQ     TEMP,,AUTO
         2 002225   000036 736000                    QLS     30
         2 002226   300151 676100                    ERQ     105,,PR3
         2 002227   070000 376003                    ANQ     28672,DU
         2 002230   300151 656100                    ERSQ    105,,PR3

      593    14988    3     END;

      594    14989    2        END;

      595    14990    1     RETURN;

  14990  2 002231   000000 702200 xent               TSX2  ! X66_ARET

      596    14991    1   E_REPORT:
      597    14992    1     ALTRETURN;

  14992  2 002232   000000 702200 xent  E_REPORT     TSX2  ! X66_AALT

      598    14993        %EJECT;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:97   
      599    14994        /*F*    NAME:      CPB$STATUS
      600    14995                PURPOSE:   To process the STATUS command.
      601    14996                REFERENCE: Programmers Reference Manual
      602    14997        */
      603    14998    1   CPB$STATUS:
      604    14999    1     ENTRY(P$PCB)   ALTRET;

  14999  2 002233   000000 700200 xent  CPB$STATUS   TSX0  ! X66_AUTO_1
         2 002234   000626 000001                    ZERO    406,1

      605    15000        /*
      606    15001             ***** Save B$JIT.JSLEV
      607    15002                   set by report command...
      608    15003        */
      609    15004    1     I = B$JIT.JSLEV;

  15004  2 002235   000000 470400 xsym               LDP0    B$JIT$
         2 002236   000151 236100                    LDQ     105,,PR0
         2 002237   000041 772000                    QRL     33
         2 002240   200117 756100                    STQ     I,,AUTO

      610    15005    1     IF P$PCB.OUT$ -> P$B.NSUBLKS ~= 0

  15005  2 002241   200003 471500                    LDP1    @P$PCB,,AUTO
         2 002242   100003 473500                    LDP3    3,,PR1
         2 002243   300001 220100                    LDX0    1,,PR3
         2 002244   002272 600000 2                  TZE     s:15016

      611    15006    1        THEN
      612    15007    2           DO CASE (P$PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE);

  15007  2 002245   300003 474500                    LDP4    3,,PR3
         2 002246   400000 721100                    LXL1    0,,PR4
         2 002247   000004 101003                    CMPX1   4,DU
         2 002250   002252 602011 2                  TNC     s:15007+5,X1
         2 002251   002276 710000 2                  TRA     s:15020
         2 002252   002271 710000 2                  TRA     s:15014
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:98   
         2 002253   002256 710000 2                  TRA     s:15009
         2 002254   002263 710000 2                  TRA     s:15011
         2 002255   002270 710000 2                  TRA     s:15013

      613    15008    2            CASE (RE_FULL);

      614    15009    2              B$JIT.JSLEV = %AZ_ALL#;

  15009  2 002256   000151 236100                    LDQ     105,,PR0
         2 002257   000032 376000 3                  ANQ     26
         2 002260   100000 276003                    ORQ     32768,DU
         2 002261   000151 756100                    STQ     105,,PR0
         2 002262   002276 710000 2                  TRA     s:15020

      615    15010    2            CASE (RE_SUMMARY);

      616    15011    2              B$JIT.JSLEV = %AZ_SUMMARY#;

  15011  2 002263   000151 236100                    LDQ     105,,PR0
         2 002264   000032 376000 3                  ANQ     26
         2 002265   200000 276003                    ORQ     65536,DU
         2 002266   000151 756100                    STQ     105,,PR0
         2 002267   002276 710000 2                  TRA     s:15020

      617    15012    2            CASE (RE_NONE);

      618    15013    2              RETURN;   /* Dont bother */

  15013  2 002270   000000 702200 xent               TSX2  ! X66_ARET

      619    15014    2            END;

  15014  2 002271   002276 710000 2                  TRA     s:15020

      620    15015    1        ELSE /* use %AZ_SUMMARY# as default */
      621    15016    1           B$JIT.JSLEV = %AZ_SUMMARY#;

PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:99   
  15016  2 002272   000151 236100                    LDQ     105,,PR0
         2 002273   000032 376000 3                  ANQ     26
         2 002274   200000 276003                    ORQ     65536,DU
         2 002275   000151 756100                    STQ     105,,PR0

      622    15017        /*
      623    15018             ***** Get M$LL for LOGOFF to write thru ...
      624    15019        */
      625    15020    1     CALL CPC$OPEN_LL;

  15020  2 002276   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002277   000000 701000 xent               TSX1    CPC$OPEN_LL
         2 002300   000000 011000                    NOP     0

      626    15021        /*
      627    15022             ***** Call AZA$LOGOFF to write the status message...
      628    15023        */
      629    15024    1     LOGOFF.CODE = %AZ$STATUS;

  15024  2 002301   000003 235007                    LDA     3,DL
         2 002302   200131 755100                    STA     LOGOFF,,AUTO

      630    15025    1     LOGOFF.ERR = 0;

  15025  2 002303   200132 450100                    STZ     LOGOFF+1,,AUTO

      631    15026    1     LOGOFF.DCB1 = M$IBEX1_NUM;

  15026  2 002304   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 002305   200133 740100                    STX0    LOGOFF+2,,AUTO

      632    15027    1     LOGOFF.DCB_LL = SEG$2.LLDCB#;

  15027  2 002306   000000 470400 xsym               LDP0    SEG2$
         2 002307   000000 721100                    LXL1    0,,PR0
         2 002310   200133 441100                    SXL1    LOGOFF+2,,AUTO

PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:100  
      633    15028    1     CALL AZA$LOGOFF (LOGOFF) ALTRET(E_STATUS);

  15028  2 002311   200131 631500                    EPPR1   LOGOFF,,AUTO
         2 002312   200620 451500                    STP1    @TEMP+1,,AUTO
         2 002313   200620 630500                    EPPR0   @TEMP+1,,AUTO
         2 002314   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002315   000000 701000 xent               TSX1    AZA$LOGOFF
         2 002316   002320 702000 2                  TSX2    E_STATUS

      634    15029    2     DO WHILE(%NO#);

  15029  2 002317   002346 710000 2                  TRA     s:15039

      635    15030    2   E_STATUS:
      636    15031    2        B$JIT.JSLEV = I;

  15031  2 002320   000000 470400 xsym  E_STATUS     LDP0    B$JIT$
         2 002321   200117 236100                    LDQ     I,,AUTO
         2 002322   000041 736000                    QLS     33
         2 002323   000151 676100                    ERQ     105,,PR0
         2 002324   700000 376003                    ANQ     -32768,DU
         2 002325   000151 656100                    ERSQ    105,,PR0

      637    15032    2        CALL CPC$WRITEMSGE(B$JIT.USRERR,B$JIT.USRDCB);

  15032  2 002326   000000 236000 xsym               LDQ     B$JIT$
         2 002327   000033 036000 3                  ADLQ    27
         2 002330   200621 756100                    STQ     @TEMP+2,,AUTO
         2 002331   000000 236000 xsym               LDQ     B$JIT$
         2 002332   000144 036003                    ADLQ    100,DU
         2 002333   200620 756100                    STQ     @TEMP+1,,AUTO
         2 002334   200620 630500                    EPPR0   @TEMP+1,,AUTO
         2 002335   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002336   000000 701000 xent               TSX1    CPC$WRITEMSGE
         2 002337   000000 011000                    NOP     0

      638    15033    2        IF LOGOFF.ERR ~= %AZ$STATSERR  THEN
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:101  

  15033  2 002340   200132 235100                    LDA     LOGOFF+1,,AUTO
         2 002341   000001 115007                    CMPA    1,DL
         2 002342   002346 600000 2                  TZE     s:15039

      639    15034    2           CALL CPA$BYE;

  15034  2 002343   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002344   000000 701000 xent               TSX1    CPA$BYE
         2 002345   000000 011000                    NOP     0

      640    15035    2      END;

      641    15036        /*
      642    15037             ***** restore B$JIT.JSLEV ...
      643    15038        */
      644    15039    1     B$JIT.JSLEV = I;

  15039  2 002346   000000 470400 xsym               LDP0    B$JIT$
         2 002347   200117 236100                    LDQ     I,,AUTO
         2 002350   000041 736000                    QLS     33
         2 002351   000151 676100                    ERQ     105,,PR0
         2 002352   700000 376003                    ANQ     -32768,DU
         2 002353   000151 656100                    ERSQ    105,,PR0

      645    15040    1     RETURN;

  15040  2 002354   000000 702200 xent               TSX2  ! X66_ARET

      646    15041        %EJECT;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:102  
      647    15042        /*F*    NAME:    CPB$TITLE
      648    15043                PURPOSE:    To process the TITLE command in IBEX.
      649    15044                REFERENCE:  Programmer's Reference Manual
      650    15045        */
      651    15046    1   CPB$TITLE:
      652    15047    1     ENTRY(P$PCB)   ALTRET;

  15047  2 002355   000000 700200 xent  CPB$TITLE    TSX0  ! X66_AUTO_1
         2 002356   000626 000001                    ZERO    406,1

      653    15048        /**/
      654    15049    1     FPT_LDEV = CFPT_LDEV;

  15049  2 002357   000100 100400                    MLR     fill='000'O
         2 002360   000000 000120 xsym               ADSC9   CFPT_LDEV                cn=0,n=80
         2 002361   200334 000120                    ADSC9   FPT_LDEV,,AUTO           cn=0,n=80

      655    15050    1     FPT_LDEV.V_ = VECTOR(FPT_LDEV.V);

  15050  2 002362   000010 235000 3                  LDA     8
         2 002363   200620 452500                    STP2    @TEMP+1,,AUTO
         2 002364   200620 236100                    LDQ     @TEMP+1,,AUTO
         2 002365   000352 036003                    ADLQ    234,DU
         2 002366   200334 757100                    STAQ    FPT_LDEV,,AUTO

      656    15051    1     FPT_LDEV.V.STREAMNAME# = 'LP01';

  15051  2 002367   000033 236000 1                  LDQ     E_RPTATJS+19
         2 002370   200352 756100                    STQ     FPT_LDEV+14,,AUTO

      657    15052    1     FPT_LDEV.V.CONTINUE# = %YES#;

  15052  2 002371   400000 236003                    LDQ     -131072,DU
         2 002372   200353 256100                    ORSQ    FPT_LDEV+15,,AUTO

      658    15053    1     BLK$ = P$PCB.OUT$;

PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:103  
  15053  2 002373   200003 470500                    LDP0    @P$PCB,,AUTO
         2 002374   000003 236100                    LDQ     3,,PR0
         2 002375   200005 756100                    STQ     BLK$,,AUTO

      659    15054    1     IF BLK$->P$B.NSUBLKS = 0

  15054  2 002376   200005 471500                    LDP1    BLK$,,AUTO
         2 002377   100001 220100                    LDX0    1,,PR1
         2 002400   002404 601000 2                  TNZ     s:15059

      660    15055    1        THEN
      661    15056    1           FPT_LDEV.HDR_ = VECTOR(ERASE);

  15056  2 002401   000034 237000 3                  LDAQ    28
         2 002402   200340 757100                    STAQ    FPT_LDEV+4,,AUTO
         2 002403   002436 710000 2                  TRA     s:15070

      662    15057    1        ELSE
      663    15058    2           DO;

      664    15059    2              VLP_HDR = CVLP_HDR;

  15059  2 002404   000100 100400                    MLR     fill='000'O
         2 002405   000000 000010 xsym               ADSC9   CVLP_HDR                 cn=0,n=8
         2 002406   200372 001004                    ADSC9   VLP_HDR,,AUTO            cn=0,n=516

      665    15060    2              VLP_HDR.TITL.L# = BLK$ -> P$B.SUBLK$(0) -> P$S.COUNT;

  15060  2 002407   100003 473500                    LDP3    3,,PR1
         2 002410   300004 236100                    LDQ     4,,PR3
         2 002411   200373 552140                    STBQ    VLP_HDR+1,'40'O,AUTO

      666    15061    2              VLP_HDR.TITL.TITLE# = SUBSTR(BLK$ -> P$B.SUBLK$(0) -> P$S.TEXT,

  15061  2 002412   100003 473500                    LDP3    3,,PR1
         2 002413   300004 236100                    LDQ     4,,PR3
         2 002414   000033 772000                    QRL     27
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:104  
         2 002415   200373 236100                    LDQ     VLP_HDR+1,,AUTO
         2 002416   000033 772000                    QRL     27
         2 002417   000000 620006                    EAX0    0,QL
         2 002420   040100 100540                    MLR     fill='040'O
         2 002421   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         2 002422   200373 200777                    ADSC9   VLP_HDR+1,,AUTO          cn=1,n=511

      667    15062    2                   0,VLP_HDR.TITL.L#);
      668    15063    2              IF VLP_HDR.TITL.L# = 0

  15063  2 002423   200373 236100                    LDQ     VLP_HDR+1,,AUTO
         2 002424   777000 316003                    CANQ    -512,DU
         2 002425   002431 601000 2                  TNZ     s:15067

      669    15064    2                 THEN
      670    15065    2                    FPT_LDEV.HDR_ = VECTOR(ERASE);

  15065  2 002426   000034 237000 3                  LDAQ    28
         2 002427   200340 757100                    STAQ    FPT_LDEV+4,,AUTO
         2 002430   002436 710000 2                  TRA     s:15070

      671    15066    2                 ELSE
      672    15067    2                    FPT_LDEV.HDR_ = VECTOR(VLP_HDR);

  15067  2 002431   000036 235000 3                  LDA     30
         2 002432   200620 452500                    STP2    @TEMP+1,,AUTO
         2 002433   200620 236100                    LDQ     @TEMP+1,,AUTO
         2 002434   000372 036003                    ADLQ    250,DU
         2 002435   200340 757100                    STAQ    FPT_LDEV+4,,AUTO

      673    15068    2           END;

      674    15069        /**/
      675    15070    1     CALL M$LDEV(FPT_LDEV) ALTRET(E_TITLE);

  15070  2 002436   200334 630500                    EPPR0   FPT_LDEV,,AUTO
         2 002437   460004 713400                    CLIMB   alt,+24580
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:105  
         2 002440   403000 401760                    pmme    nvectors=7
         2 002441   002443 702000 2                  TSX2    E_TITLE

      676    15071    1     RETURN;

  15071  2 002442   000000 702200 xent               TSX2  ! X66_ARET

      677    15072        /**/
      678    15073    1   E_TITLE:
      679    15074    1     ALTRETURN;

  15074  2 002443   000000 702200 xent  E_TITLE      TSX2  ! X66_AALT

      680    15075                   %EJECT;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:106  
      681    15076        /********************************************************************/
      682    15077        /*I*   NAME: PUT_LEVEL
      683    15078               PURPOSE: Puts the report level into the print image for the REPORT command
      684    15079               DESCRIPTION: Puts the report level (NONE,FULL,SUMMARY) into the print
      685    15080                         image for the REPORT command.
      686    15081        */
      687    15082        /********************************************************************/
      688    15083    1   PUT_LEVEL: PROC(TEMP) ALTRET;

  15083  2 002444   200616 741300       PUT_LEVEL    STX1  ! PLATEN_VLP+18,,AUTO

      689    15084    2   DCL TEMP UBIN WORD;
      690    15085    3     DO CASE(TEMP);

  15085  2 002445   200617 470500                    LDP0    @TEMP,,AUTO
         2 002446   000000 235100                    LDA     0,,PR0
         2 002447   000004 115007                    CMPA    4,DL
         2 002450   002452 602005 2                  TNC     s:15085+5,AL
         2 002451   002471 710000 2                  TRA     s:15093
         2 002452   002471 710000 2                  TRA     s:15093
         2 002453   002462 710000 2                  TRA     s:15089
         2 002454   002466 710000 2                  TRA     s:15091
         2 002455   002456 710000 2                  TRA     s:15087

      691    15086    3        CASE(%AZ_NONE#);

      692    15087    3           TBUFF = 'None';

  15087  2 002456   040100 100400                    MLR     fill='040'O
         2 002457   000034 000004 1                  ADSC9   E_RPTATJS+20             cn=0,n=4
         2 002460   200011 000030                    ADSC9   TMDATE,,AUTO             cn=0,n=24
         2 002461   002471 710000 2                  TRA     s:15093

      693    15088    3        CASE(%AZ_ALL#);

      694    15089    3           TBUFF = 'Full';

PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:107  
  15089  2 002462   040100 100400                    MLR     fill='040'O
         2 002463   000035 000004 1                  ADSC9   E_RPTATJS+21             cn=0,n=4
         2 002464   200011 000030                    ADSC9   TMDATE,,AUTO             cn=0,n=24
         2 002465   002471 710000 2                  TRA     s:15093

      695    15090    3        CASE(%AZ_SUMMARY#);

      696    15091    3           TBUFF = 'Summary';

  15091  2 002466   040100 100400                    MLR     fill='040'O
         2 002467   000036 000007 1                  ADSC9   E_RPTATJS+22             cn=0,n=7
         2 002470   200011 000030                    ADSC9   TMDATE,,AUTO             cn=0,n=24

      697    15092    3     END;

      698    15093    2     CALL INDEX(K,' ',TBUFF);

  15093  2 002471   000000 124500                    SCM     mask='000'O
         2 002472   200011 000030                    ADSC9   TMDATE,,AUTO             cn=0,n=24
         2 002473   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 002474   200121 000100                    ARG     K,,AUTO

      699    15094    2     CALL CPB$BLDIMAGE(TEMPBUF$,DEST$,ADDR(TBUFF),K,

  15094  2 002475   200011 631500                    EPPR1   TMDATE,,AUTO
         2 002476   200620 451500                    STP1    @TEMP+1,,AUTO
         2 002477   200125 633500                    EPPR3   TAB_VAL,,AUTO
         2 002500   200625 453500                    STP3    @TEMP+6,,AUTO
         2 002501   200121 634500                    EPPR4   K,,AUTO
         2 002502   200624 454500                    STP4    @TEMP+5,,AUTO
         2 002503   200620 635500                    EPPR5   @TEMP+1,,AUTO
         2 002504   200623 455500                    STP5    @TEMP+4,,AUTO
         2 002505   200010 636500                    EPPR6   DEST$,,AUTO
         2 002506   200622 456500                    STP6    @TEMP+3,,AUTO
         2 002507   200007 637500                    EPPR7   TEMPBUF$,,AUTO
         2 002510   200621 457500                    STP7    @TEMP+2,,AUTO
         2 002511   200621 630500                    EPPR0   @TEMP+2,,AUTO
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:108  
         2 002512   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 002513   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 002514   002517 702000 2                  TSX2    E_PUT_LEVEL

      700    15095    2           TAB_VAL) ALTRET(E_PUT_LEVEL);
      701    15096    2     RETURN;

  15096  2 002515   200616 221300                    LDX1  ! PLATEN_VLP+18,,AUTO
         2 002516   000001 702211                    TSX2  ! 1,X1

      702    15097    2   E_PUT_LEVEL:
      703    15098    2     ALTRETURN;

  15098  2 002517   200616 221300       E_PUT_LEVEL  LDX1  ! PLATEN_VLP+18,,AUTO
         2 002520   000000 702211                    TSX2  ! 0,X1
      704    15099    2   END PUT_LEVEL;
      705    15100                %EJECT;
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:109  
      706    15101    1   END CPB$IBEX1;

PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:110  
--  Include file information  --

   CP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_PERR_C.:E05TOU  is referenced.
   CP_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_MACROS_C.:E05TOU  is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   AZ_SUBS_C.:E05TOU  is referenced.
   G_JIT_M.:E05TOU  is referenced.
   AZ_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure CPB$IBEX1.
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:111  

 **** Variables and constants ****

  ****  Section 001 RoData CPB$IBEX1

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    10-0-0/w STRC        r     1 E_RPTATJS                  0-0-0/c CHAR(19)    r     1 PLATENHDR
     5-0-0/c CHAR(11)    r     1 REPORTHDR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @P$PCB                   617-0-0/w PTR         r     1 @TEMP
     5-0-0/w PTR         r     1 BLK$                     126-0-0/w UBIN        r     1 CPOS
   130-0-0/w UBIN        r     1 DCB#                      10-0-0/w PTR         r     1 DEST$
   370-0-0/c STRC(72)    r     1 FID_ACCT                 246-0-0/d STRC(1080)  r     1 FPT_CLOSE
   304-0-0/d STRC(360)   r     1 FPT_DELREC               316-0-0/d STRC(504)   r     1 FPT_KEYIN
   334-0-0/d STRC(720)   r     1 FPT_LDEV                 140-0-0/d STRC(2088)  r     1 FPT_OPEN
   360-0-0/d STRC(288)   r     1 FPT_PLATEN               232-0-0/d STRC(432)   r     1 FPT_WRITE
   117-0-0/w SBIN        r     1 I                        121-0-0/w SBIN        r     1 K
   131-0-0/w STRC(216)   r     1 LOGOFF                     4-0-0/w PTR         r     1 P$
    *0-0-0/w STRC(504)   r     1 P$PCB                    574-0-0/d STRC(144)   r     1 PLATEN_VLP
   127-0-0/c CHAR(2)     r     1 STRM                     125-0-0/w UBIN        r     1 TAB_VAL
    11-0-0/c CHAR(24)    r     1 TBUFF                    122-0-0/w UBIN        r     1 TEMP
    *0-0-0/w UBIN        r     1 TEMP                       6-0-0/w PTR         r     1 TEMP$
   123-0-0/w UBIN        r     1 TEMP2                    124-0-0/w UBIN        r     1 TEMP3
    17-0-0/c CHAR(256)   r     1 TEMPBUF                    7-0-0/w PTR         r     1 TEMPBUF$
    11-0-0/c STRC(216)   r     1 TMDATE                   372-0-0/w STRC(4644)  r     1 VLP_HDR

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:112  
     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/d STRC(1080)  r     1 CFPT_CLOSE                 0-0-0/d STRC(360)   r     1 CFPT_DELREC
     0-0-0/d STRC(504)   r     1 CFPT_KEYIN                 0-0-0/d STRC(720)   r     1 CFPT_LDEV
     0-0-0/d STRC(2088)  r     1 CFPT_OPEN                  0-0-0/d STRC(288)   r     1 CFPT_PLATEN
     0-0-0/d STRC(432)   r     1 CFPT_WRITE                 0-0-0/w STRC(72)    r     1 CVLP_HDR
     0-0-0/d STRC(144)   r     1 CVLP_PLATEN                0-0-0/c STRC(63)    r     1 K_ATITLE
     0-0-0/w UBIN        r     1 M$IBEX1_NUM                0-0-0/w PTR         r     1 SEG2$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/d STRC(432)   r     1 FPT$WRITE                  0-0-0/w STRC(144)   r     1 P$B
     0-0-0/w ASTR(153)   r     1 P$S                        0-0-0/w STRC(6264)  r     1 SEG$2


   Procedure CPB$IBEX1 requires 1361 words for executable code.
   Procedure CPB$IBEX1 requires 406 words of local(AUTO) storage.

    No errors detected in file CPB$IBEX1.:E05TSI    .
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:113  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:114  
          MINI XREF LISTING

AZA$LOGOFF
     13366**DCL-ENT 15028--CALL
B$ALT.CODE
     13442**DCL     13442--REDEF   13443--REDEF   13443--REDEF
B$ALT.DCB#
     13443**DCL     14563<>CALL
B$ALT.ERR
     13443**DCL     14563<>CALL    14658<>CALL    14814<>CALL
B$ALT.ERR.CODE
     13444**DCL     14752>>IF      14811>>IF
B$ALT.ERR.ERR#
     13444**DCL     13444--REDEF
B$ALT.EVID
     13443**DCL     13443--REDEF   13443--REDEF
B$JIT.CPFLAGS1
      2858**DCL     14898>>IF      14918>>IF      14938>>IF      14964>>IF
B$JIT.CPFLAGS1.SLEAZE
      2863**DCL      2863--REDEF
B$JIT.ERR.MID
      2770**DCL      2770--REDEF
B$JIT.JRESPEAK
      2931**DCL      2932--REDEF
B$JIT.JSLEV
      2906**DCL     14848>>ASSIGN  14979<<ASSIGN  14985<<ASSIGN  15004>>ASSIGN  15009<<ASSIGN  15011<<ASSIGN
     15016<<ASSIGN  15031<<ASSIGN  15039<<ASSIGN
B$JIT.ORIGINATOR_PORT.FROM_CR
      3040**DCL      3040--REDEF    3041--REDEF
B$JIT.PNR
      2944**DCL      2944--REDEF
B$JIT.PSLEV
      2906**DCL     14860>>ASSIGN  14908>>IF      14928>>IF      14948>>IF      14983<<ASSIGN  14987<<ASSIGN
B$JIT.SSLEV
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:115  
      2906**DCL     14854>>ASSIGN  14901>>IF      14921>>IF      14941>>IF      14964>>IF      14964>>IF
     14973<<ASSIGN  14981<<ASSIGN  14986<<ASSIGN
B$JIT.TSLINE
      3038**DCL      3039--REDEF
B$JIT.USRDCB
      2918**DCL     15032<>CALL
B$JIT.USRERR
      2905**DCL     14572<>CALL    15032<>CALL
B$JIT$
     13292**DCL      2764--IMP-PTR 14572>>CALL    14848>>ASSIGN  14854>>ASSIGN  14860>>ASSIGN  14898>>IF
     14901>>IF      14908>>IF      14918>>IF      14921>>IF      14928>>IF      14938>>IF      14941>>IF
     14948>>IF      14964>>IF      14964>>IF      14964>>IF      14973>>ASSIGN  14979>>ASSIGN  14981>>ASSIGN
     14983>>ASSIGN  14985>>ASSIGN  14986>>ASSIGN  14987>>ASSIGN  15004>>ASSIGN  15009>>ASSIGN  15011>>ASSIGN
     15016>>ASSIGN  15031>>ASSIGN  15032>>CALL    15032>>CALL    15039>>ASSIGN
B$TCB.ALT$
     13438**DCL     14563>>CALL    14563>>CALL    14658>>CALL    14752>>IF      14811>>IF      14814>>CALL
B$TCB$
     13294**DCL     13438--IMP-PTR 14563>>CALL    14563>>CALL    14658>>CALL    14752>>IF      14811>>IF
     14814>>CALL
BLK$
     13361**DCL     14528<<ASSIGN  14534>>IF      14545>>ASSIGN  14545>>ASSIGN  14601<<ASSIGN  14605>>IF
     14618>>DOINDEX 14619>>ASSIGN  14668<<ASSIGN  14679>>IF      14740>>IF      14743>>ASSIGN  14743>>ASSIGN
     14758>>IF      14768>>DOWHILE 14769>>ASSIGN  14836<<ASSIGN  14837>>IF      14877>>ASSIGN  14878>>IF
     14880>>ASSIGN  14881>>ASSIGN  14885>>ASSIGN  14886>>ASSIGN  14961>>IF      15053<<ASSIGN  15054>>IF
     15060>>ASSIGN  15061>>ASSIGN  15061>>ASSIGN
CAMR_REC.ACSVEH_
     12331**DCL     12332--REDEF
CAMR_REC.ALTKEYS_
     12337**DCL     12338--REDEF   12338--REDEF
CAMR_REC.HDR_
     12336**DCL     12337--REDEF
CAMR_REC.TAB_
     12335**DCL     12336--REDEF
CAMR_REC.UHL_
     12329**DCL     12330--REDEF   12330--REDEF
CAMR_REC.V.FSN#
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:116  
     12369**DCL     12369--REDEF   12369--REDEF
CAMR_REC.WSN_
     12335**DCL     12335--REDEF
CFPT_CLOSE
     11173**DCL     14556>>ASSIGN  14565>>ASSIGN  14692>>ASSIGN  14798>>ASSIGN  14819>>ASSIGN
CFPT_CLOSE.SN_
     11173**DCL     11173--REDEF
CFPT_CLOSE.UTL_
     11174**DCL     11174--REDEF
CFPT_CLOSE.V.EXPIRE#
     11188**DCL     11188--REDEF
CFPT_CLOSE.V.TYPE#
     11186**DCL     11186--REDEF
CFPT_CLOSE.V.XTNSIZE#
     11183**DCL     11183--REDEF   11185--REDEF
CFPT_DELREC
     11381**DCL     14537>>ASSIGN
CFPT_KEYIN
     11435**DCL     14611>>ASSIGN
CFPT_LDEV
     11613**DCL     15049>>ASSIGN
CFPT_OPEN
     11106**DCL     14744>>ASSIGN
CFPT_OPEN.ACSVEH_
     11108**DCL     11109--REDEF
CFPT_OPEN.ALTKEYS_
     11114**DCL     11115--REDEF   11115--REDEF
CFPT_OPEN.HDR_
     11113**DCL     11114--REDEF
CFPT_OPEN.TAB_
     11112**DCL     11113--REDEF
CFPT_OPEN.UHL_
     11106**DCL     11107--REDEF   11107--REDEF
CFPT_OPEN.V.FSN#
     11146**DCL     11146--REDEF   11146--REDEF
CFPT_OPEN.WSN_
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:117  
     11112**DCL     11112--REDEF
CFPT_PLATEN
     11716**DCL     14672>>ASSIGN
CFPT_READ.STATION_
     11212**DCL     11213--REDEF
CFPT_READ.V.DVBYTE.REREAD#
     11224**DCL     11224--REDEF
CFPT_READ.V.INDX#
     11222**DCL     11222--REDEF
CFPT_READUC.STATION_
     11582**DCL     11583--REDEF
CFPT_READUC.V.DVBYTE.REREAD#
     11594**DCL     11594--REDEF
CFPT_READUC.V.INDX#
     11592**DCL     11592--REDEF
CFPT_TRTN.V.IR#
     11818**DCL     11819--REDEF
CFPT_WRITE
     11248**DCL     14546>>ASSIGN
CFPT_WRITE.STATION_
     11250**DCL     11250--REDEF
CFPT_WRITE.V.DVBYTE.VFC#
     11257**DCL     11257--REDEF
CFPT_WRITEUC.STATION_
     11550**DCL     11550--REDEF
CFPT_WRITEUC.V.DVBYTE.VFC#
     11557**DCL     11557--REDEF
CFPT_XXX.V.STEPCC#
     12530**DCL     12530--REDEF
CGETCMD.OUT$
     12551**DCL     12557--REDEF
CPA$BYE
     13367**DCL-ENT 15034--CALL
CPB$BLDIMAGE
     13373**DCL-ENT 14709--CALL    14713--CALL    14717--CALL    14721--CALL    14725--CALL    14729--CALL
     14733--CALL    14846--CALL    14852--CALL    14858--CALL    15094--CALL
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:118  
CPB$FIND_UCNN
     13368**DCL-ENT 14755--CALL
CPC$OPEN_LL
     13370**DCL-ENT 15020--CALL
CPC$OPEN_S
     13371**DCL-ENT 14529--CALL
CPC$WRITEMSGE
     13369**DCL-ENT 15032--CALL
CPE$LISTOUT
     13374**DCL-ENT 14737--CALL    14864--CALL
CPE$RZEROS
     13372**DCL-ENT 14708--CALL    14716--CALL    14724--CALL    14732--CALL
CPOS
     13474**DCL     14881<<ASSIGN  14886<<ASSIGN  14905<>CALL    14912<>CALL    14925<>CALL    14932<>CALL
     14945<>CALL    14952<>CALL    14969<>CALL
CVLP_HDR
     11682**DCL     15059>>ASSIGN
CVLP_PLATEN
     11743**DCL     14674>>ASSIGN
CVLP_TRMCTL.BREAKCOUNT
     12142**DCL     12143--REDEF
CVLP_WINDOW.FWINDOW#
     12238**DCL     12238--REDEF   12239--REDEF
CXP$POSTERR
     13375**DCL-ENT 14563--CALL    14572--CALL    14658--CALL    14814--CALL    14905--CALL    14912--CALL
     14925--CALL    14932--CALL    14945--CALL    14952--CALL    14969--CALL
DCB#
     13476**DCL     14747<<ASSIGN  14755<>CALL    14757>>ASSIGN
DEST$
     13364**DCL     14684<<ASSIGN  14686<<ASSIGN  14686>>ASSIGN  14709<>CALL    14711<<ASSIGN  14711>>ASSIGN
     14713<>CALL    14717<>CALL    14719<<ASSIGN  14719>>ASSIGN  14721<>CALL    14725<>CALL    14727<<ASSIGN
     14727>>ASSIGN  14729<>CALL    14733<>CALL    14735>>ASSIGN  14841<<ASSIGN  14843<<ASSIGN  14843>>ASSIGN
     14846<>CALL    14850<<ASSIGN  14850>>ASSIGN  14852<>CALL    14856<<ASSIGN  14856>>ASSIGN  14858<>CALL
     14862>>ASSIGN  15094<>CALL
DISPLAY_PLATEN
     14683**LABEL   14760--GOTO
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:119  
E_ATITLE_WRT
     14563**LABEL   14552--CALLALT
E_C$OPEN_S
     14572**LABEL   14529--CALLALT 14560--CALLALT 14569--CALLALT
E_MESSAGE
     14658**LABEL   14655--CALLALT
E_PLATEN
     14811**LABEL   14688--CALLALT 14754--GOTO    14794--CALLALT
E_PLATEN_LIST
     14816**LABEL   14709--CALLALT 14713--CALLALT 14717--CALLALT 14721--CALLALT 14725--CALLALT 14729--CALLALT
     14733--CALLALT 14737--CALLALT 14755--CALLALT
E_PUT_LEVEL IN PROCEDURE PUT_LEVEL
     15098**LABEL   15094--CALLALT
E_REPORT
     14992**LABEL   14846--CALLALT 14852--CALLALT 14858--CALLALT 14864--CALLALT
E_RPTATJS
     14010**DCL     14905<>CALL    14912<>CALL    14925<>CALL    14932<>CALL    14945<>CALL    14952<>CALL
     14969<>CALL
E_STATUS
     15031**LABEL   15028--CALLALT
E_TITLE
     15074**LABEL   15070--CALLALT
F$DCB.ACTPOS
     13607**DCL     13607--REDEF
F$DCB.ARS#
     13581**DCL     13581--REDEF
F$DCB.ATTR
     13600**DCL     13601--REDEF
F$DCB.BORROW
     13615**DCL     13615--REDEF   13615--REDEF   13615--REDEF
F$DCB.DCBNAME.L
     13629**DCL     13629--IMP-SIZ
F$DCB.EOMCHAR#
     13585**DCL     13585--REDEF
F$DCB.FCD#
     13594**DCL     14689>>IF      14795>>IF      14816>>IF
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:120  
F$DCB.FLDID
     13610**DCL     13610--REDEF
F$DCB.FORM$
     13604**DCL     13604--REDEF
F$DCB.FSECT
     13620**DCL     13620--REDEF
F$DCB.FSN#
     13597**DCL     13597--REDEF   13597--REDEF   13598--REDEF
F$DCB.HEADER$
     13603**DCL     13603--REDEF
F$DCB.IXTNSIZE#
     13601**DCL     13601--REDEF
F$DCB.LASTSTA$
     13590**DCL     13590--REDEF
F$DCB.LVL
     13616**DCL     13616--REDEF
F$DCB.NAME#.C
     13591**DCL     13591--REDEF
F$DCB.NOEOF
     13613**DCL     13613--REDEF
F$DCB.NRECS#
     13602**DCL     13602--REDEF
F$DCB.NRECX
     13621**DCL     13621--REDEF
F$DCB.OHDR
     13613**DCL     13613--REDEF
F$DCB.ORG#
     13596**DCL     13596--REDEF
F$DCB.PRECNO
     13619**DCL     13619--REDEF
F$DCB.RCSZ
     13625**DCL     13625--REDEF
F$DCB.RES#
     13592**DCL     13592--REDEF
F$DCB.SETX
     13604**DCL     13604--REDEF
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:121  
F$DCB.TAB$
     13604**DCL     13604--REDEF
F$DCB.TDA
     13618**DCL     13619--REDEF
F$DCB.WSN#
     13592**DCL     13592--REDEF
FID_ACCT
     13956**DCL     14614--ASSIGN
FPT$CLOSE.SN_
     13532**DCL     13532--REDEF
FPT$CLOSE.UTL_
     13533**DCL     13533--REDEF
FPT$CLOSE.V.EXPIRE#
     13547**DCL     13547--REDEF
FPT$CLOSE.V.TYPE#
     13545**DCL     13545--REDEF
FPT$CLOSE.V.XTNSIZE#
     13542**DCL     13542--REDEF   13544--REDEF
FPT$WRITE.BUF_.BOUND
     13495**DCL     14735<<ASSIGN  14862<<ASSIGN
FPT$WRITE.BUF_.BUF$
     13497**DCL     14736<<ASSIGN  14863<<ASSIGN
FPT$WRITE.STATION_
     13497**DCL     13497--REDEF
FPT$WRITE.V.DVBYTE.VFC#
     13504**DCL     13504--REDEF
FPT_CLOSE
     13836**DCL     14556<<ASSIGN  14560<>CALL    14565<<ASSIGN  14569<>CALL    14692<<ASSIGN  14696<>CALL
     14798<<ASSIGN  14802<>CALL    14819<<ASSIGN  14823<>CALL
FPT_CLOSE.SN_
     13836**DCL     13836--REDEF
FPT_CLOSE.UTL_
     13837**DCL     13837--REDEF
FPT_CLOSE.V
     13841**DCL     14557--ASSIGN  14566--ASSIGN  14693--ASSIGN  14799--ASSIGN  14820--ASSIGN
FPT_CLOSE.V.DCB#
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:122  
     13842**DCL     14559<<ASSIGN  14568<<ASSIGN  14694<<ASSIGN  14800<<ASSIGN  14821<<ASSIGN
FPT_CLOSE.V.DISP#
     13845**DCL     14558<<ASSIGN  14567<<ASSIGN  14695<<ASSIGN  14801<<ASSIGN  14822<<ASSIGN
FPT_CLOSE.V.EXPIRE#
     13851**DCL     13851--REDEF
FPT_CLOSE.V.TYPE#
     13849**DCL     13849--REDEF
FPT_CLOSE.V.XTNSIZE#
     13846**DCL     13846--REDEF   13848--REDEF
FPT_CLOSE.V_
     13836**DCL     14557<<ASSIGN  14566<<ASSIGN  14693<<ASSIGN  14799<<ASSIGN  14820<<ASSIGN
FPT_DELREC
     13866**DCL     14537<<ASSIGN  14541<>CALL
FPT_DELREC.KEY_
     13866**DCL     14539<<ASSIGN
FPT_DELREC.V
     13869**DCL     14538--ASSIGN
FPT_DELREC.V.DCB#
     13870**DCL     14540<<ASSIGN
FPT_DELREC.V_
     13866**DCL     14538<<ASSIGN
FPT_KEYIN
     13885**DCL     14611<<ASSIGN  14655<>CALL
FPT_KEYIN.MESS_
     13885**DCL     14613<<ASSIGN
FPT_KEYIN.RESULTS_
     13887**DCL     14614<<ASSIGN
FPT_KEYIN.V
     13888**DCL     14612--ASSIGN
FPT_KEYIN.V.OCTYPE#
     13889**DCL     14627<<ASSIGN  14631<<ASSIGN  14633<<ASSIGN  14635<<ASSIGN  14637<<ASSIGN  14639<<ASSIGN
     14641<<ASSIGN  14643<<ASSIGN  14645<<ASSIGN  14647<<ASSIGN  14649<<ASSIGN
FPT_KEYIN.V.WSN#
     13888**DCL     14629<<ASSIGN
FPT_KEYIN.V_
     13885**DCL     14612<<ASSIGN
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:123  
FPT_LDEV
     13905**DCL     15049<<ASSIGN  15070<>CALL
FPT_LDEV.HDR_
     13905**DCL     15056<<ASSIGN  15065<<ASSIGN  15067<<ASSIGN
FPT_LDEV.V
     13907**DCL     15050--ASSIGN
FPT_LDEV.V.CONTINUE#
     13908**DCL     15052<<ASSIGN
FPT_LDEV.V.STREAMNAME#
     13908**DCL     15051<<ASSIGN
FPT_LDEV.V_
     13905**DCL     15050<<ASSIGN
FPT_OPEN
     13738**DCL     14744<<ASSIGN  14750<>CALL
FPT_OPEN.ACSVEH_
     13740**DCL     13741--REDEF
FPT_OPEN.ALTKEYS_
     13746**DCL     13747--REDEF   13747--REDEF
FPT_OPEN.HDR_
     13745**DCL     13746--REDEF
FPT_OPEN.TAB_
     13744**DCL     13745--REDEF
FPT_OPEN.UHL_
     13738**DCL     13739--REDEF   13739--REDEF
FPT_OPEN.V
     13747**DCL     14745--ASSIGN
FPT_OPEN.V.DCB#
     13747**DCL     14746<<ASSIGN
FPT_OPEN.V.FSN#
     13778**DCL     13778--REDEF   13778--REDEF
FPT_OPEN.V.ORG#
     13758**DCL     14749<<ASSIGN
FPT_OPEN.V.RES#
     13762**DCL     14748<<CALLBLT
FPT_OPEN.V_
     13738**DCL     14745<<ASSIGN
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:124  
FPT_OPEN.WSN_
     13744**DCL     13744--REDEF
FPT_PLATEN
     13933**DCL     14672<<ASSIGN  14688<>CALL    14794<>CALL
FPT_PLATEN.PLATEN_
     13939**DCL     14675<<ASSIGN
FPT_PLATEN.V
     13941**DCL     14673--ASSIGN
FPT_PLATEN.V.DCB#
     13941**DCL     14757<<ASSIGN
FPT_PLATEN.V_
     13935**DCL     14673<<ASSIGN
FPT_WRITE
     13799**DCL     14546<<ASSIGN  14552<>CALL
FPT_WRITE.BUF_
     13799**DCL     14549<<ASSIGN
FPT_WRITE.KEY_
     13799**DCL     14548<<ASSIGN
FPT_WRITE.STATION_
     13801**DCL     13801--REDEF
FPT_WRITE.V
     13802**DCL     14547--ASSIGN
FPT_WRITE.V.DCB#
     13802**DCL     14550<<ASSIGN
FPT_WRITE.V.DVBYTE.VFC#
     13808**DCL     13808--REDEF
FPT_WRITE.V.ONEWKEY#
     13804**DCL     14551<<ASSIGN
FPT_WRITE.V_
     13799**DCL     14547<<ASSIGN
I
     13467**DCL     14618<<DOINDEX 14619>>ASSIGN  14761<<ASSIGN  14764<<ASSIGN  14768>>DOWHILE 14769>>ASSIGN
     14792<<ASSIGN  14792>>ASSIGN  15004<<ASSIGN  15031>>ASSIGN  15039>>ASSIGN
K
     13469**DCL     14708<>CALL    14709<>CALL    14716<>CALL    14717<>CALL    14724<>CALL    14725<>CALL
     14732<>CALL    14733<>CALL    15093<<CALLBLT 15094<>CALL
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:125  
K_ATITLE
     13320**DCL     14539--ASSIGN  14548--ASSIGN
LOGOFF
     13637**DCL     15028<>CALL
LOGOFF.CODE
     13638**DCL     15024<<ASSIGN
LOGOFF.DCB1
     13649**DCL     15026<<ASSIGN
LOGOFF.DCB_LL
     13653**DCL     15027<<ASSIGN
LOGOFF.ERR
     13643**DCL     15025<<ASSIGN  15033>>IF
M$CLOSE
        27**DCL-ENT 14560--CALL    14569--CALL    14696--CALL    14802--CALL    14823--CALL
M$DELREC
        29**DCL-ENT 14541--CALL
M$GPLATEN
        60**DCL-ENT 14688--CALL
M$IBEX1_NUM
     13298**DCL     14529<>CALL    14540>>ASSIGN  14550>>ASSIGN  14559>>ASSIGN  14568>>ASSIGN  14572<>CALL
     14689--IF      14694>>ASSIGN  14746>>ASSIGN  14747>>ASSIGN  14795--IF      14800>>ASSIGN  14816--IF
     14821>>ASSIGN  15026>>ASSIGN
M$KEYIN
        32**DCL-ENT 14655--CALL
M$LDEV
        27**DCL-ENT 15070--CALL
M$OPEN
        27**DCL-ENT 14750--CALL
M$PLATEN
        53**DCL-ENT 14794--CALL
M$WRITE
        28**DCL-ENT 14552--CALL
NO_ATITLE
     14556**LABEL   14541--CALLALT
P$
     13360**DCL     14769<<ASSIGN  14770>>CALLBLT 14770>>CALLBLT 14771>>DOCASE
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:126  
P$B.CODE
     14034**DCL     14620>>DOCASE  14740>>IF      14771>>DOCASE  14877>>ASSIGN  14880>>ASSIGN  14885>>ASSIGN
     15007>>DOCASE
P$B.CPOS
     14052**DCL     14881>>ASSIGN  14886>>ASSIGN
P$B.NSUBLKS
     14038**DCL     14534>>IF      14605>>IF      14618>>DOINDEX 14679>>IF      14758>>IF      14768>>DOWHILE
     14837>>IF      14878>>IF      14961>>IF      15005>>IF      15054>>IF
P$B.SUBLK$
     14059**DCL     14545>>ASSIGN  14545>>ASSIGN  14619>>ASSIGN  14740>>IF      14743>>ASSIGN  14743>>ASSIGN
     14743>>ASSIGN  14743>>ASSIGN  14769>>ASSIGN  14877>>ASSIGN  14880>>ASSIGN  14881>>ASSIGN  14885>>ASSIGN
     14886>>ASSIGN  15007>>DOCASE  15060>>ASSIGN  15061>>ASSIGN  15061>>ASSIGN
P$PCB
     14122**DCL        15--PROC    14522--ENTRY   14575--ENTRY   14578--ENTRY   14582--ENTRY   14598--ENTRY
     14665--ENTRY   14833--ENTRY   14998--ENTRY   15046--ENTRY
P$PCB.OUT$
     14135**DCL     14528>>ASSIGN  14601>>ASSIGN  14668>>ASSIGN  14836>>ASSIGN  15005>>IF      15007>>DOCASE
     15053>>ASSIGN
P$S.COUNT
     14095**DCL     14098--IMP-SIZ 14545>>ASSIGN  14622>>IF      14625>>ASSIGN  14629>>ASSIGN  14743>>ASSIGN
     14770>>CALLBLT 15060>>ASSIGN  15061>>ASSIGN
P$S.TEXT
     14098**DCL     14545>>ASSIGN  14625>>ASSIGN  14629>>ASSIGN  14743>>ASSIGN  14770>>CALLBLT 15061>>ASSIGN
PLATENHDR
     13449**DCL     14685>>ASSIGN  14686--ASSIGN
PLATEN_VLP
     13991**DCL     14674<<ASSIGN  14675--ASSIGN
PLATEN_VLP.EXTWID#
     13993**DCL     14704>>IF      14777<<ASSIGN
PLATEN_VLP.FIRSTLINE#
     13992**DCL     14731>>CALLBLT 14789<<ASSIGN
PLATEN_VLP.LENGTH#
     13991**DCL     14715>>CALLBLT 14783<<ASSIGN
PLATEN_VLP.LIMBO#
     13992**DCL     14723>>CALLBLT 14786<<ASSIGN
PLATEN_VLP.WIDTH#
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:127  
     13991**DCL     14703>>ASSIGN  14780<<ASSIGN
PUT_LEVEL
     15083**PROC    14849--CALL    14855--CALL    14861--CALL
REPORTHDR
     13450**DCL     14842>>ASSIGN  14843--ASSIGN
SEG$2.ERRBUF
     13403**DCL     14563--CALL    14572--CALL    14658--CALL    14814--CALL    14905--CALL    14912--CALL
     14925--CALL    14932--CALL    14945--CALL    14952--CALL    14969--CALL
SEG$2.FPT_WRITE$
     13418**DCL     14735>>ASSIGN  14736>>ASSIGN  14737<>CALL    14862>>ASSIGN  14863>>ASSIGN  14864<>CALL
SEG$2.LLDCB#
     13398**DCL     15027>>ASSIGN
SEG2$
     13285**DCL     13378--IMP-PTR 14563>>CALL    14572>>CALL    14658>>CALL    14735>>ASSIGN  14736>>ASSIGN
     14737>>CALL    14814>>CALL    14862>>ASSIGN  14863>>ASSIGN  14864>>CALL    14905>>CALL    14912>>CALL
     14925>>CALL    14932>>CALL    14945>>CALL    14952>>CALL    14969>>CALL    15027>>ASSIGN
STRM
     13475**DCL     14743<<ASSIGN  14748>>CALLBLT 14755<>CALL
TAB_VAL
     13473**DCL     14687<<ASSIGN  14709<>CALL    14713<>CALL    14717<>CALL    14721<>CALL    14725<>CALL
     14729<>CALL    14733<>CALL    14844<<ASSIGN  14846<>CALL    14852<>CALL    14858<>CALL    15094<>CALL
TBUFF
     13461**DCL     14707<<CALLBLT 14708<>CALL    14708--CALL    14709--CALL    14712<<ASSIGN  14713--CALL
     14715<<CALLBLT 14716<>CALL    14716--CALL    14717--CALL    14720<<ASSIGN  14721--CALL    14723<<CALLBLT
     14724<>CALL    14724--CALL    14725--CALL    14728<<ASSIGN  14729--CALL    14731<<CALLBLT 14732<>CALL
     14732--CALL    14733--CALL    14845<<ASSIGN  14846--CALL    14851<<ASSIGN  14852--CALL    14857<<ASSIGN
     14858--CALL    15087<<ASSIGN  15089<<ASSIGN  15091<<ASSIGN  15093>>CALLBLT 15094--CALL
TEMP
     13470**DCL     14703<<ASSIGN  14706<<ASSIGN  14706>>ASSIGN  14707>>CALLBLT 14770<<CALLBLT 14774>>IF
     14778<<ASSIGN  14778>>ASSIGN  14780>>ASSIGN  14783>>ASSIGN  14786>>ASSIGN  14789>>ASSIGN  14848<<ASSIGN
     14849<>CALL    14854<<ASSIGN  14855<>CALL    14860<<ASSIGN  14861<>CALL    14916<<ASSIGN  14936<<ASSIGN
     14956<<ASSIGN  14964>>IF      14964>>IF      14964>>IF      14973>>ASSIGN  14979>>ASSIGN  14981>>ASSIGN
     14983>>ASSIGN  14985>>ASSIGN  14986>>ASSIGN  14987>>ASSIGN
TEMP IN PROCEDURE PUT_LEVEL
     15084**DCL     15083--PROC    15085>>DOCASE
TEMP$
PL6.E3A0      #001=CPB$IBEX1 File=CPB$IBEX1.:E05TSI                              TUE 07/29/97 11:21 Page:128  
     13362**DCL     14619<<ASSIGN  14620>>DOCASE  14622>>IF      14625>>ASSIGN  14625>>ASSIGN  14629>>ASSIGN
     14629>>ASSIGN
TEMP2
     13471**DCL     14877<<ASSIGN  14901>>IF      14901>>IF      14908>>IF      14908>>IF      14921>>IF
     14921>>IF      14928>>IF      14928>>IF      14941>>IF      14941>>IF      14948>>IF      14948>>IF
     14977>>DOCASE
TEMP3
     13472**DCL     14880<<ASSIGN  14885<<ASSIGN  14896>>DOCASE
TEMPBUF
     13462**DCL     13463--REDEF   14545<<ASSIGN  14549--ASSIGN  14613--ASSIGN  14625<<ASSIGN  14683--ASSIGN
     14685<<ASSIGN  14840--ASSIGN  14842<<ASSIGN
TEMPBUF$
     13363**DCL     14683<<ASSIGN  14684>>ASSIGN  14709<>CALL    14713<>CALL    14717<>CALL    14721<>CALL
     14725<>CALL    14729<>CALL    14733<>CALL    14735>>ASSIGN  14736>>ASSIGN  14840<<ASSIGN  14841>>ASSIGN
     14846<>CALL    14852<>CALL    14858<>CALL    14862>>ASSIGN  14863>>ASSIGN  15094<>CALL
TMDATE
     13451**DCL     13460--REDEF   13461--REDEF
VLP_HDR
     13969**DCL     15059<<ASSIGN  15067--ASSIGN
VLP_HDR.TITL.L#
     13971**DCL     15060<<ASSIGN  15061>>ASSIGN  15063>>IF
VLP_HDR.TITL.TITLE#
     13972**DCL     15061<<ASSIGN
