VERSION E05

PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:1    
        1        1        /*M* QTC$WRITE_TRADER - Write a record to the TRADER file */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QTC$WRITE_TRADER:
        9        9                PROC(P_MSGTYP, P_TYPE);
       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE QT_DATA_R;
       15       83        %INCLUDE QT_SUBS_C;
       16      167        %INCLUDE QT_MACROS_C;
       17      325        %INCLUDE CP_6;
       18      406        %INCLUDE B_ERRORS_C;
       19     1533        %PAGE(ARG="Parameters");

              1550    1   /***************************************************************************
              1551    1    *                                                                         *
              1552    1    *                                 Parameters                              *
              1553    1    *                                                                         *
              1554    1    ***************************************************************************/

       20     1558    1   DCL P_MSGTYP CHAR(8);
       21     1559    1   DCL P_TYPE UBIN WORD;
       22     1560        %PAGE(ARG="Externally defined routines");

PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:2    
              1577    1   /***************************************************************************
              1578    1    *                                                                         *
              1579    1    *                        Externally defined routines                      *
              1580    1    *                                                                         *
              1581    1    ***************************************************************************/

       23     1585    1   DCL QTC$PROCESS_SET ENTRY(3);
       24     1586    1   DCL QTC$MON_ERR ENTRY(1);
       25     1587        %PAGE(ARG="DCBs");

              1604    1   /***************************************************************************
              1605    1    *                                                                         *
              1606    1    *                                    DCBs                                 *
              1607    1    *                                                                         *
              1608    1    ***************************************************************************/

       26     1612    1   DCL M$TRADER DCB;
       27     1613        %PAGE(ARG="Based");

              1630    1   /***************************************************************************
              1631    1    *                                                                         *
              1632    1    *                                   Based                                 *
              1633    1    *                                                                         *
              1634    1    ***************************************************************************/

       28     1638        %QT$ENTRY;
       29     1692        %QT$SETBITS;
       30     1713        %QT$SETTEXT;
       31     1723        %QT$FORM;
       32     1762        %PAGE(ARG="Static");

              1779    1   /***************************************************************************
              1780    1    *                                                                         *
              1781    1    *                                   Static                                *
              1782    1    *                                                                         *
              1783    1    ***************************************************************************/

PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:3    
       33     1787    1   DCL UTS UBIN WORD STATIC;
       34     1788
       35     1789    1   DCL 1 KEY STATIC,
       36     1790    1         2 * UBIN(9) UNAL INIT(10),
       37     1791    1         2 MSGTYP CHAR(8),
       38     1792    1         2 SUFFIX CHAR(2);
       39     1793        %PAGE(ARG="Auto");

              1810    1   /***************************************************************************
              1811    1    *                                                                         *
              1812    1    *                                    Auto                                 *
              1813    1    *                                                                         *
              1814    1    ***************************************************************************/

       40     1818    1   DCL I SBIN WORD;
       41     1819    1   DCL BYTE_COUNT SBIN WORD;
       42     1820
       43     1821    1   DCL REC$ PTR;
       44     1822
       45     1823    1   DCL SAVE_MUST_FINISH_FLAG BIT(1) ALIGNED;
       46     1824        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:4    
              1841    1   /***************************************************************************
              1842    1    *                                                                         *
              1843    1    *                                    FPTs                                 *
              1844    1    *                                                                         *
              1845    1    ***************************************************************************/

       47     1849        %FPT_TIME(SOURCE=CLOCK, TSTAMP=UTS);
       48     1868
       49     1869        %FPT_WRITE(DCB=M$TRADER,  KEY=KEY);
       50     1900
       51     1901        %FPT_DELREC(DCB=M$TRADER, KEY=KEY);
       52     1920        %PAGE(ARG="QTC$WRITE_TRADER", PAGE=YES);

PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:5    
              1937    1   /***************************************************************************
              1938    1    *                                                                         *
              1939    1    *                              QTC$WRITE_TRADER                           *
              1940    1    *                                                                         *
              1941    1    ***************************************************************************/

       53     1945    1           CALL M$TIME(FPT_TIME);
       54     1946
       55     1947    1           SAVE_MUST_FINISH_FLAG = QT_GLOBAL.MUST_FINISH;
       56     1948    1           QT_GLOBAL.MUST_FINISH = '1'B;
       57     1949    1           KEY.MSGTYP = P_MSGTYP;
       58     1950
       59     1951    1           IF P_TYPE = 2 /* TYPE_F */ THEN
       60     1952    2             DO;
       61     1953    2               CALL WRITE_FORM;
       62     1954    2             END;
       63     1955    1           ELSE
       64     1956    2             DO;
       65     1957    2               CALL WRITE_ENTRY;
       66     1958    2             END;
       67     1959
       68     1960    1           QT_GLOBAL.MUST_FINISH = SAVE_MUST_FINISH_FLAG;
       69     1961
       70     1962    1           RETURN;
       71     1963                %PAGE(ARG="WRITE_FORM", PAGE=YES);

PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:6    
              1980    1   /***************************************************************************
              1981    1    *                                                                         *
              1982    1    *                                 WRITE_FORM                              *
              1983    1    *                                                                         *
              1984    1    ***************************************************************************/

       72     1988    1   WRITE_FORM:
       73     1989    1           PROC;
       74     1990
       75     1991    2           QT$FORM.UTS = UTS;
       76     1992    2           KEY.SUFFIX = '_F';
       77     1993    2           FPT_WRITE.BUF_.BUF$ = QT_GLOBAL.QT$FORM$;
       78     1994    2           FPT_WRITE.BUF_.BOUND = SIZEC(QT$FORM) - 1;
       79     1995
       80     1996    2           CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);
       81     1997
       82     1998    2           RETURN;
       83     1999
       84     2000    2   MON_ERR:
       85     2001    2           CALL QTC$MON_ERR('1'B);
       86     2002
       87     2003    2   END WRITE_FORM;
       88     2004                %PAGE(ARG="WRITE_ENTRY", PAGE=YES);

PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:7    
              2021    2   /***************************************************************************
              2022    2    *                                                                         *
              2023    2    *                                WRITE_ENTRY                              *
              2024    2    *                                                                         *
              2025    2    ***************************************************************************/

       89     2029    1   WRITE_ENTRY:
       90     2030    1           PROC;
       91     2031
       92     2032    2           QT$ENTRY.UTS = UTS;
       93     2033    2           KEY.SUFFIX = '_S';
       94     2034
       95     2035    2           IF QT$ENTRY.FLAGS.DCBS_SET AND QT$ENTRY.SET_COUNT = 0 THEN
       96     2036    3             DO;
       97     2037    3               QT$ENTRY.FLAGS.DCBS_SET = '0'B;
       98     2038    3               CALL M$DELREC(FPT_DELREC) ALTRET(MON_ERR);
       99     2039    3             END;
      100     2040
      101     2041    2           IF QT$ENTRY.SET_COUNT > 0 THEN
      102     2042    3             DO;
      103     2043    3               QT$ENTRY.FLAGS.DCBS_SET = '1'B;
      104     2044
      105     2045    3               IF QT$ENTRY.FLAGS.OLD_LOCK ~= QT$ENTRY.FLAGS.NEW_LOCK THEN
      106     2046    4                 DO;
      107     2047    5                   DO I = 1 TO QT$ENTRY.SET_COUNT;
      108     2048    5                     CALL QTC$PROCESS_SET(QT$SETTEXT, '1'B, P_MSGTYP);
      109     2049    5                   END;
      110     2050    4                 END;
      111     2051
      112     2052    3               QT$ENTRY.FLAGS.OLD_LOCK = QT$ENTRY.FLAGS.NEW_LOCK;
      113     2053    3               REC$ = QT_GLOBAL.QT$SETTEXT$;
      114     2054    3               BYTE_COUNT = 0;
      115     2055
      116     2056    4               DO I = 1 TO QT$ENTRY.SET_COUNT;
      117     2057    4                 BYTE_COUNT = BYTE_COUNT + SIZEW(REC$ -> QT$SETTEXT);
      118     2058    4                 REC$ = PINCRW(REC$, SIZEW(REC$ -> QT$SETTEXT));
      119     2059    4               END;
PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:8    
      120     2060
      121     2061    3               FPT_WRITE.BUF_.BUF$ = QT_GLOBAL.QT$SETTEXT$;
      122     2062    3               FPT_WRITE.BUF_.BOUND = BYTE_COUNT*4 - 1;
      123     2063    3               CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);
      124     2064    3             END;
      125     2065
      126     2066    2           KEY.SUFFIX = '_E';
      127     2067    2           BYTE_COUNT = SIZEW(QT$ENTRY);
      128     2068    2           REC$ = PINCRW(QT_GLOBAL.QT$ENTRY$, BYTE_COUNT);
      129     2069
      130     2070    3           DO I = 1 TO QT$ENTRY.SET_COUNT;
      131     2071    3             BYTE_COUNT = BYTE_COUNT + SIZEW(REC$ -> QT$SETBITS);
      132     2072    3             REC$ = PINCRW(REC$, SIZEW(REC$ -> QT$SETBITS));
      133     2073    3           END;
      134     2074
      135     2075    2           FPT_WRITE.BUF_.BUF$ = QT_GLOBAL.QT$ENTRY$;
      136     2076    2           FPT_WRITE.BUF_.BOUND = BYTE_COUNT*4 - 1;
      137     2077    2           CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);
      138     2078
      139     2079    2           RETURN;
      140     2080
      141     2081    2   MON_ERR:
      142     2082    2           CALL QTC$MON_ERR('1'B);
      143     2083
      144     2084    2   END WRITE_ENTRY;
      145     2085    1   END QTC$WRITE_TRADER;

PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:9    
--  Include file information  --

   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   QT_MACROS_C.:E05TOU  is referenced.
   QT_SUBS_C.:E05TOU  is referenced.
   QT_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QTC$WRITE_TRADER.

   Procedure QTC$WRITE_TRADER requires 217 words for executable code.
   Procedure QTC$WRITE_TRADER requires 16 words of local(AUTO) storage.

    No errors detected in file QTC$WRITE_TRADER.:E05TSI    .

PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:10   

 Object Unit name= QTC$WRITE_TRADER                           File name= QTC$WRITE_TRADER.:E05TOU
 UTS= JUL 30 '97 05:51:42.60 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$TRADER
    2   Data  even  none    38     46  QTC$WRITE_TRADER
    3  RoData even  UTS      3      3  QTC$WRITE_TRADER
    4   Proc  even  none   217    331  QTC$WRITE_TRADER
    5  RoData even  none     2      2  QTC$WRITE_TRADER

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        2  QTC$WRITE_TRADER

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 QTC$MON_ERR
         yes           Std       3 QTC$PROCESS_SET
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:11   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     QT_GLOBAL                             M$UC                                  M$TRADER
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:12   


        1        1        /*M* QTC$WRITE_TRADER - Write a record to the TRADER file */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QTC$WRITE_TRADER:
        9        9                PROC(P_MSGTYP, P_TYPE);

      9  4 000000   000000 700200 xent  QTC$WRITE_T* TSX0  ! X66_AUTO_2
         4 000001   000020 000002                    ZERO    16,2

       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE QT_DATA_R;
       15       83        %INCLUDE QT_SUBS_C;
       16      167        %INCLUDE QT_MACROS_C;
       17      325        %INCLUDE CP_6;
       18      406        %INCLUDE B_ERRORS_C;
       19     1533        %PAGE(ARG="Parameters");

              1550    1   /***************************************************************************
              1551    1    *                                                                         *
              1552    1    *                                 Parameters                              *
              1553    1    *                                                                         *
              1554    1    ***************************************************************************/
PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:13   

       20     1558    1   DCL P_MSGTYP CHAR(8);
       21     1559    1   DCL P_TYPE UBIN WORD;
       22     1560        %PAGE(ARG="Externally defined routines");

              1577    1   /***************************************************************************
              1578    1    *                                                                         *
              1579    1    *                        Externally defined routines                      *
              1580    1    *                                                                         *
              1581    1    ***************************************************************************/

       23     1585    1   DCL QTC$PROCESS_SET ENTRY(3);
       24     1586    1   DCL QTC$MON_ERR ENTRY(1);
       25     1587        %PAGE(ARG="DCBs");

              1604    1   /***************************************************************************
              1605    1    *                                                                         *
              1606    1    *                                    DCBs                                 *
              1607    1    *                                                                         *
              1608    1    ***************************************************************************/

       26     1612    1   DCL M$TRADER DCB;
       27     1613        %PAGE(ARG="Based");

              1630    1   /***************************************************************************
              1631    1    *                                                                         *
              1632    1    *                                   Based                                 *
              1633    1    *                                                                         *
              1634    1    ***************************************************************************/

       28     1638        %QT$ENTRY;
       29     1692        %QT$SETBITS;
       30     1713        %QT$SETTEXT;
       31     1723        %QT$FORM;
       32     1762        %PAGE(ARG="Static");

              1779    1   /***************************************************************************
PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:14   
              1780    1    *                                                                         *
              1781    1    *                                   Static                                *
              1782    1    *                                                                         *
              1783    1    ***************************************************************************/

       33     1787    1   DCL UTS UBIN WORD STATIC;
       34     1788
       35     1789    1   DCL 1 KEY STATIC,
       36     1790    1         2 * UBIN(9) UNAL INIT(10),
       37     1791    1         2 MSGTYP CHAR(8),
       38     1792    1         2 SUFFIX CHAR(2);
       39     1793        %PAGE(ARG="Auto");

              1810    1   /***************************************************************************
              1811    1    *                                                                         *
              1812    1    *                                    Auto                                 *
              1813    1    *                                                                         *
              1814    1    ***************************************************************************/

       40     1818    1   DCL I SBIN WORD;
       41     1819    1   DCL BYTE_COUNT SBIN WORD;
       42     1820
       43     1821    1   DCL REC$ PTR;
       44     1822
       45     1823    1   DCL SAVE_MUST_FINISH_FLAG BIT(1) ALIGNED;
       46     1824        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:15   
              1841    1   /***************************************************************************
              1842    1    *                                                                         *
              1843    1    *                                    FPTs                                 *
              1844    1    *                                                                         *
              1845    1    ***************************************************************************/

       47     1849        %FPT_TIME(SOURCE=CLOCK, TSTAMP=UTS);
       48     1868
       49     1869        %FPT_WRITE(DCB=M$TRADER,  KEY=KEY);
       50     1900
       51     1901        %FPT_DELREC(DCB=M$TRADER, KEY=KEY);
       52     1920        %PAGE(ARG="QTC$WRITE_TRADER", PAGE=YES);

PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:16   
              1937    1   /***************************************************************************
              1938    1    *                                                                         *
              1939    1    *                              QTC$WRITE_TRADER                           *
              1940    1    *                                                                         *
              1941    1    ***************************************************************************/

       53     1945    1           CALL M$TIME(FPT_TIME);

   1945  4 000002   000004 630400 2                  EPPR0   FPT_TIME
         4 000003   020004 713400                    CLIMB   8196
         4 000004   402000 401760                    pmme    nvectors=5

       54     1946
       55     1947    1           SAVE_MUST_FINISH_FLAG = QT_GLOBAL.MUST_FINISH;

   1947  4 000005   000004 236000 xsym               LDQ     QT_GLOBAL+4
         4 000006   400000 376003                    ANQ     -131072,DU
         4 000007   200010 756100                    STQ     SAVE_MUST_FINISH_FLAG,,AUTO

       56     1948    1           QT_GLOBAL.MUST_FINISH = '1'B;

   1948  4 000010   400000 236003                    LDQ     -131072,DU
         4 000011   000004 756000 xsym               STQ     QT_GLOBAL+4

       57     1949    1           KEY.MSGTYP = P_MSGTYP;

   1949  4 000012   200003 470500                    LDP0    @P_MSGTYP,,AUTO
         4 000013   040000 100500                    MLR     fill='040'O
         4 000014   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         4 000015   000001 200010 2                  ADSC9   KEY                      cn=1,n=8

       58     1950
       59     1951    1           IF P_TYPE = 2 /* TYPE_F */ THEN

   1951  4 000016   200004 471500                    LDP1    @P_TYPE,,AUTO
         4 000017   100000 235100                    LDA     0,,PR1
         4 000020   000002 115007                    CMPA    2,DL
PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:17   
         4 000021   000025 601000 4                  TNZ     s:1957

       60     1952    2             DO;

       61     1953    2               CALL WRITE_FORM;

   1953  4 000022   000033 701000 4                  TSX1    WRITE_FORM
         4 000023   000000 011000                    NOP     0

       62     1954    2             END;

   1954  4 000024   000027 710000 4                  TRA     s:1960

       63     1955    1           ELSE
       64     1956    2             DO;

       65     1957    2               CALL WRITE_ENTRY;

   1957  4 000025   000064 701000 4                  TSX1    WRITE_ENTRY
         4 000026   000000 011000                    NOP     0

       66     1958    2             END;

       67     1959
       68     1960    1           QT_GLOBAL.MUST_FINISH = SAVE_MUST_FINISH_FLAG;

   1960  4 000027   200010 236100                    LDQ     SAVE_MUST_FINISH_FLAG,,AUTO
         4 000030   400000 376003                    ANQ     -131072,DU
         4 000031   000004 756000 xsym               STQ     QT_GLOBAL+4

       69     1961
       70     1962    1           RETURN;

   1962  4 000032   000000 702200 xent               TSX2  ! X66_ARET

       71     1963                %PAGE(ARG="WRITE_FORM", PAGE=YES);

PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:18   
              1980    1   /***************************************************************************
              1981    1    *                                                                         *
              1982    1    *                                 WRITE_FORM                              *
              1983    1    *                                                                         *
              1984    1    ***************************************************************************/

       72     1988    1   WRITE_FORM:

   1988  4 000033   200012 741300       WRITE_FORM   STX1  ! SAVE_MUST_FINISH_FLAG+2,,AUTO

       73     1989    1           PROC;
       74     1990
       75     1991    2           QT$FORM.UTS = UTS;

   1991  4 000034   000033 470400 xsym               LDP0    QT_GLOBAL+27
         4 000035   000000 235000 2                  LDA     UTS
         4 000036   000001 755100                    STA     1,,PR0

       76     1992    2           KEY.SUFFIX = '_F';

   1992  4 000037   000000 236000 3                  LDQ     0
         4 000040   000011 772000                    QRL     9
         4 000041   000003 552030 2                  STBQ    KEY+2,'30'O

       77     1993    2           FPT_WRITE.BUF_.BUF$ = QT_GLOBAL.QT$FORM$;

   1993  4 000042   000033 236000 xsym               LDQ     QT_GLOBAL+27
         4 000043   000025 756000 2                  STQ     FPT_WRITE+5

       78     1994    2           FPT_WRITE.BUF_.BOUND = SIZEC(QT$FORM) - 1;

   1994  4 000044   000024 236000 2                  LDQ     FPT_WRITE+4
         4 000045   177777 376007                    ANQ     65535,DL
         4 000046   000000 276000 5                  ORQ     0
         4 000047   000024 756000 2                  STQ     FPT_WRITE+4

       79     1995
PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:19   
       80     1996    2           CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);

   1996  4 000050   000020 630400 2                  EPPR0   FPT_WRITE
         4 000051   440001 713400                    CLIMB   alt,write
         4 000052   401400 401760                    pmme    nvectors=4
         4 000053   000056 702000 4                  TSX2    MON_ERR

       81     1997
       82     1998    2           RETURN;

   1998  4 000054   200012 221300                    LDX1  ! SAVE_MUST_FINISH_FLAG+2,,AUTO
         4 000055   000001 702211                    TSX2  ! 1,X1

       83     1999
       84     2000    2   MON_ERR:
       85     2001    2           CALL QTC$MON_ERR('1'B);

   2001  4 000056   000001 630400 5     MON_ERR      EPPR0   1
         4 000057   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000060   000000 701000 xent               TSX1    QTC$MON_ERR
         4 000061   000000 011000                    NOP     0

       86     2002
       87     2003    2   END WRITE_FORM;

   2003  4 000062   200012 221300                    LDX1  ! SAVE_MUST_FINISH_FLAG+2,,AUTO
         4 000063   000001 702211                    TSX2  ! 1,X1

       88     2004                %PAGE(ARG="WRITE_ENTRY", PAGE=YES);

PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:20   
              2021    2   /***************************************************************************
              2022    2    *                                                                         *
              2023    2    *                                WRITE_ENTRY                              *
              2024    2    *                                                                         *
              2025    2    ***************************************************************************/

       89     2029    1   WRITE_ENTRY:

   2029  4 000064   200012 741300       WRITE_ENTRY  STX1  ! SAVE_MUST_FINISH_FLAG+2,,AUTO

       90     2030    1           PROC;
       91     2031
       92     2032    2           QT$ENTRY.UTS = UTS;

   2032  4 000065   000031 470400 xsym               LDP0    QT_GLOBAL+25
         4 000066   000000 235000 2                  LDA     UTS
         4 000067   000001 755100                    STA     1,,PR0

       93     2033    2           KEY.SUFFIX = '_S';

   2033  4 000070   000001 236000 3                  LDQ     1
         4 000071   000011 772000                    QRL     9
         4 000072   000003 552030 2                  STBQ    KEY+2,'30'O

       94     2034
       95     2035    2           IF QT$ENTRY.FLAGS.DCBS_SET AND QT$ENTRY.SET_COUNT = 0 THEN

   2035  4 000073   000031 470400 xsym               LDP0    QT_GLOBAL+25
         4 000074   000000 234100                    SZN     0,,PR0
         4 000075   000107 605000 4                  TPL     s:2041
         4 000076   000023 236100                    LDQ     19,,PR0
         4 000077   777000 316007                    CANQ    -512,DL
         4 000100   000107 601000 4                  TNZ     s:2041

       96     2036    3             DO;

       97     2037    3               QT$ENTRY.FLAGS.DCBS_SET = '0'B;
PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:21   

   2037  4 000101   000031 236000 xsym               LDQ     B_VECTNIL+25
         4 000102   000000 356100                    ANSQ    0,,PR0

       98     2038    3               CALL M$DELREC(FPT_DELREC) ALTRET(MON_ERR);

   2038  4 000103   000034 630400 2                  EPPR0   FPT_DELREC
         4 000104   440002 713400                    CLIMB   alt,+16386
         4 000105   401400 401760                    pmme    nvectors=4
         4 000106   000323 702000 4                  TSX2    MON_ERR

       99     2039    3             END;

      100     2040
      101     2041    2           IF QT$ENTRY.SET_COUNT > 0 THEN

   2041  4 000107   000031 470400 xsym               LDP0    QT_GLOBAL+25
         4 000110   000023 236100                    LDQ     19,,PR0
         4 000111   777000 316007                    CANQ    -512,DL
         4 000112   000227 600000 4                  TZE     s:2066

      102     2042    3             DO;

      103     2043    3               QT$ENTRY.FLAGS.DCBS_SET = '1'B;

   2043  4 000113   400000 236003                    LDQ     -131072,DU
         4 000114   000000 256100                    ORSQ    0,,PR0

      104     2044
      105     2045    3               IF QT$ENTRY.FLAGS.OLD_LOCK ~= QT$ENTRY.FLAGS.NEW_LOCK THEN

   2045  4 000115   000031 470400 xsym               LDP0    QT_GLOBAL+25
         4 000116   000100 066500                    CMPB    filb='0'B
         4 000117   000000 010001                    BDSC    0,,PR0                   by=0,bit=1,n=1
         4 000120   000000 020001                    BDSC    0,,PR0                   by=0,bit=2,n=1
         4 000121   000145 600000 4                  TZE     s:2052

PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:22   
      106     2046    4                 DO;

      107     2047    5                   DO I = 1 TO QT$ENTRY.SET_COUNT;

   2047  4 000122   000001 235007                    LDA     1,DL
         4 000123   200005 755100                    STA     I,,AUTO
         4 000124   000137 710000 4                  TRA     s:2049+1

      108     2048    5                     CALL QTC$PROCESS_SET(QT$SETTEXT, '1'B, P_MSGTYP);

   2048  4 000125   200003 236100                    LDQ     @P_MSGTYP,,AUTO
         4 000126   200016 756100                    STQ     SAVE_MUST_FINISH_FLAG+6,,AUTO
         4 000127   000001 236000 5                  LDQ     1
         4 000130   000032 235000 xsym               LDA     QT_GLOBAL+26
         4 000131   200014 757100                    STAQ    SAVE_MUST_FINISH_FLAG+4,,AUTO
         4 000132   200014 630500                    EPPR0   SAVE_MUST_FINISH_FLAG+4,,AUTO
         4 000133   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000134   000000 701000 xent               TSX1    QTC$PROCESS_SET
         4 000135   000000 011000                    NOP     0

      109     2049    5                   END;

   2049  4 000136   200005 054100                    AOS     I,,AUTO
         4 000137   000031 470400 xsym               LDP0    QT_GLOBAL+25
         4 000140   000023 236100                    LDQ     19,,PR0
         4 000141   000011 772000                    QRL     9
         4 000142   000777 376007                    ANQ     511,DL
         4 000143   200005 116100                    CMPQ    I,,AUTO
         4 000144   000125 605000 4                  TPL     s:2048

      110     2050    4                 END;

      111     2051
      112     2052    3               QT$ENTRY.FLAGS.OLD_LOCK = QT$ENTRY.FLAGS.NEW_LOCK;

   2052  4 000145   000000 236100                    LDQ     0,,PR0
         4 000146   000001 736000                    QLS     1
PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:23   
         4 000147   000000 676100                    ERQ     0,,PR0
         4 000150   200000 376003                    ANQ     65536,DU
         4 000151   000000 656100                    ERSQ    0,,PR0

      113     2053    3               REC$ = QT_GLOBAL.QT$SETTEXT$;

   2053  4 000152   000032 236000 xsym               LDQ     QT_GLOBAL+26
         4 000153   200007 756100                    STQ     REC$,,AUTO

      114     2054    3               BYTE_COUNT = 0;

   2054  4 000154   200006 450100                    STZ     BYTE_COUNT,,AUTO

      115     2055
      116     2056    4               DO I = 1 TO QT$ENTRY.SET_COUNT;

   2056  4 000155   000001 235007                    LDA     1,DL
         4 000156   200005 755100                    STA     I,,AUTO
         4 000157   000204 710000 4                  TRA     s:2059+1

      117     2057    4                 BYTE_COUNT = BYTE_COUNT + SIZEW(REC$ -> QT$SETTEXT);

   2057  4 000160   200007 470500                    LDP0    REC$,,AUTO
         4 000161   000000 236100                    LDQ     0,,PR0
         4 000162   000033 772000                    QRL     27
         4 000163   000020 620006                    EAX0    16,QL
         4 000164   000000 636010                    EAQ     0,X0
         4 000165   000022 772000                    QRL     18
         4 000166   000011 402007                    MPY     9,DL
         4 000167   000043 036007                    ADLQ    35,DL
         4 000170   000044 506007                    DIV     36,DL
         4 000171   200006 036100                    ADLQ    BYTE_COUNT,,AUTO
         4 000172   200006 756100                    STQ     BYTE_COUNT,,AUTO

      118     2058    4                 REC$ = PINCRW(REC$, SIZEW(REC$ -> QT$SETTEXT));

   2058  4 000173   000000 636010                    EAQ     0,X0
PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:24   
         4 000174   000022 772000                    QRL     18
         4 000175   000011 402007                    MPY     9,DL
         4 000176   000043 036007                    ADLQ    35,DL
         4 000177   000044 506007                    DIV     36,DL
         4 000200   000022 736000                    QLS     18
         4 000201   200007 036100                    ADLQ    REC$,,AUTO
         4 000202   200007 756100                    STQ     REC$,,AUTO

      119     2059    4               END;

   2059  4 000203   200005 054100                    AOS     I,,AUTO
         4 000204   000031 470400 xsym               LDP0    QT_GLOBAL+25
         4 000205   000023 236100                    LDQ     19,,PR0
         4 000206   000011 772000                    QRL     9
         4 000207   000777 376007                    ANQ     511,DL
         4 000210   200005 116100                    CMPQ    I,,AUTO
         4 000211   000160 605000 4                  TPL     s:2057

      120     2060
      121     2061    3               FPT_WRITE.BUF_.BUF$ = QT_GLOBAL.QT$SETTEXT$;

   2061  4 000212   000032 236000 xsym               LDQ     QT_GLOBAL+26
         4 000213   000025 756000 2                  STQ     FPT_WRITE+5

      122     2062    3               FPT_WRITE.BUF_.BOUND = BYTE_COUNT*4 - 1;

   2062  4 000214   200006 236100                    LDQ     BYTE_COUNT,,AUTO
         4 000215   000002 736000                    QLS     2
         4 000216   000001 136007                    SBLQ    1,DL
         4 000217   000020 736000                    QLS     16
         4 000220   000024 676000 2                  ERQ     FPT_WRITE+4
         4 000221   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000222   000024 656000 2                  ERSQ    FPT_WRITE+4

      123     2063    3               CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);

   2063  4 000223   000020 630400 2                  EPPR0   FPT_WRITE
PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:25   
         4 000224   440001 713400                    CLIMB   alt,write
         4 000225   401400 401760                    pmme    nvectors=4
         4 000226   000323 702000 4                  TSX2    MON_ERR

      124     2064    3             END;

      125     2065
      126     2066    2           KEY.SUFFIX = '_E';

   2066  4 000227   000002 236000 3                  LDQ     2
         4 000230   000011 772000                    QRL     9
         4 000231   000003 552030 2                  STBQ    KEY+2,'30'O

      127     2067    2           BYTE_COUNT = SIZEW(QT$ENTRY);

   2067  4 000232   000032 235007                    LDA     26,DL
         4 000233   200006 755100                    STA     BYTE_COUNT,,AUTO

      128     2068    2           REC$ = PINCRW(QT_GLOBAL.QT$ENTRY$, BYTE_COUNT);

   2068  4 000234   200006 236100                    LDQ     BYTE_COUNT,,AUTO
         4 000235   000022 736000                    QLS     18
         4 000236   000031 036000 xsym               ADLQ    QT_GLOBAL+25
         4 000237   200007 756100                    STQ     REC$,,AUTO

      129     2069
      130     2070    3           DO I = 1 TO QT$ENTRY.SET_COUNT;

   2070  4 000240   000001 235007                    LDA     1,DL
         4 000241   200005 755100                    STA     I,,AUTO
         4 000242   000276 710000 4                  TRA     s:2073+1

      131     2071    3             BYTE_COUNT = BYTE_COUNT + SIZEW(REC$ -> QT$SETBITS);

   2071  4 000243   200007 470500                    LDP0    REC$,,AUTO
         4 000244   000100 101500                    MRL     fill='000'O
         4 000245   000013 000001                    ADSC9   11,,PR0                  cn=0,n=1
PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:26   
         4 000246   200014 000002                    ADSC9   SAVE_MUST_FINISH_FLAG+4,,AUTO cn=0,n=2
         4 000247   200014 220100                    LDX0    SAVE_MUST_FINISH_FLAG+4,,AUTO
         4 000250   000055 621010                    EAX1    45,X0
         4 000251   000000 636011                    EAQ     0,X1
         4 000252   000022 772000                    QRL     18
         4 000253   000011 402007                    MPY     9,DL
         4 000254   000043 036007                    ADLQ    35,DL
         4 000255   000044 506007                    DIV     36,DL
         4 000256   200006 036100                    ADLQ    BYTE_COUNT,,AUTO
         4 000257   200006 756100                    STQ     BYTE_COUNT,,AUTO

      132     2072    3             REC$ = PINCRW(REC$, SIZEW(REC$ -> QT$SETBITS));

   2072  4 000260   000100 101500                    MRL     fill='000'O
         4 000261   000013 000001                    ADSC9   11,,PR0                  cn=0,n=1
         4 000262   200014 000002                    ADSC9   SAVE_MUST_FINISH_FLAG+4,,AUTO cn=0,n=2
         4 000263   200014 220100                    LDX0    SAVE_MUST_FINISH_FLAG+4,,AUTO
         4 000264   000055 621010                    EAX1    45,X0
         4 000265   000000 636011                    EAQ     0,X1
         4 000266   000022 772000                    QRL     18
         4 000267   000011 402007                    MPY     9,DL
         4 000270   000043 036007                    ADLQ    35,DL
         4 000271   000044 506007                    DIV     36,DL
         4 000272   000022 736000                    QLS     18
         4 000273   200007 036100                    ADLQ    REC$,,AUTO
         4 000274   200007 756100                    STQ     REC$,,AUTO

      133     2073    3           END;

   2073  4 000275   200005 054100                    AOS     I,,AUTO
         4 000276   000031 470400 xsym               LDP0    QT_GLOBAL+25
         4 000277   000023 236100                    LDQ     19,,PR0
         4 000300   000011 772000                    QRL     9
         4 000301   000777 376007                    ANQ     511,DL
         4 000302   200005 116100                    CMPQ    I,,AUTO
         4 000303   000243 605000 4                  TPL     s:2071

PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:27   
      134     2074
      135     2075    2           FPT_WRITE.BUF_.BUF$ = QT_GLOBAL.QT$ENTRY$;

   2075  4 000304   000031 236000 xsym               LDQ     QT_GLOBAL+25
         4 000305   000025 756000 2                  STQ     FPT_WRITE+5

      136     2076    2           FPT_WRITE.BUF_.BOUND = BYTE_COUNT*4 - 1;

   2076  4 000306   200006 236100                    LDQ     BYTE_COUNT,,AUTO
         4 000307   000002 736000                    QLS     2
         4 000310   000001 136007                    SBLQ    1,DL
         4 000311   000020 736000                    QLS     16
         4 000312   000024 676000 2                  ERQ     FPT_WRITE+4
         4 000313   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000314   000024 656000 2                  ERSQ    FPT_WRITE+4

      137     2077    2           CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);

   2077  4 000315   000020 630400 2                  EPPR0   FPT_WRITE
         4 000316   440001 713400                    CLIMB   alt,write
         4 000317   401400 401760                    pmme    nvectors=4
         4 000320   000323 702000 4                  TSX2    MON_ERR

      138     2078
      139     2079    2           RETURN;

   2079  4 000321   200012 221300                    LDX1  ! SAVE_MUST_FINISH_FLAG+2,,AUTO
         4 000322   000001 702211                    TSX2  ! 1,X1

      140     2080
      141     2081    2   MON_ERR:
      142     2082    2           CALL QTC$MON_ERR('1'B);

   2082  4 000323   000001 630400 5     MON_ERR      EPPR0   1
         4 000324   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000325   000000 701000 xent               TSX1    QTC$MON_ERR
         4 000326   000000 011000                    NOP     0
PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:28   

      143     2083
      144     2084    2   END WRITE_ENTRY;

   2084  4 000327   200012 221300                    LDX1  ! SAVE_MUST_FINISH_FLAG+2,,AUTO
         4 000330   000001 702211                    TSX2  ! 1,X1
      145     2085    1   END QTC$WRITE_TRADER;

PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:29   
--  Include file information  --

   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   QT_MACROS_C.:E05TOU  is referenced.
   QT_SUBS_C.:E05TOU  is referenced.
   QT_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QTC$WRITE_TRADER.
PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:30   

 **** Variables and constants ****

  ****  Section 002  Data  QTC$WRITE_TRADER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    34-0-0/d STRC(360)   r     1 FPT_DELREC                 4-0-0/d STRC(432)   r     1 FPT_TIME
    20-0-0/d STRC(432)   r     1 FPT_WRITE                  1-0-0/c STRC(99)    r     1 KEY
     0-0-0/w UBIN        r     1 UTS

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @P_MSGTYP                  4-0-0/w PTR         r     1 @P_TYPE
     6-0-0/w SBIN        r     1 BYTE_COUNT                 5-0-0/w SBIN        r     1 I
    *0-0-0/c CHAR(8)     r     1 P_MSGTYP                  *0-0-0/w UBIN        r     1 P_TYPE
     7-0-0/w PTR         r     1 REC$
    10-0-0/w BIT         r     1 SAVE_MUST_FINISH_FLAG

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1872)  r     1 QT_GLOBAL

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0N  NULL        r     1 M$TRADER                   0-0-0/w STRC(936)   r     1 QT$ENTRY
     0-0-0/w STRC(828)   r     1 QT$FORM                    0-0-0/c ASTR(405)   r     1 QT$SETBITS
     0-0-0/w ASTR(144)   r     1 QT$SETTEXT
PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:31   


   Procedure QTC$WRITE_TRADER requires 217 words for executable code.
   Procedure QTC$WRITE_TRADER requires 16 words of local(AUTO) storage.

    No errors detected in file QTC$WRITE_TRADER.:E05TSI    .
PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:32   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:33   
          MINI XREF LISTING

BYTE_COUNT
      1819**DCL      2054<<ASSIGN   2057<<ASSIGN   2057>>ASSIGN   2062>>ASSIGN   2067<<ASSIGN   2068>>ASSIGN
      2071<<ASSIGN   2071>>ASSIGN   2076>>ASSIGN
FPT_DELREC
      1912**DCL      2038<>CALL
FPT_DELREC.V
      1915**DCL      1912--DCLINIT
FPT_TIME
      1860**DCL      1945<>CALL
FPT_TIME.V
      1864**DCL      1860--DCLINIT
FPT_WRITE
      1886**DCL      1996<>CALL     2063<>CALL     2077<>CALL
FPT_WRITE.BUF_.BOUND
      1886**DCL      1994<<ASSIGN   2062<<ASSIGN   2076<<ASSIGN
FPT_WRITE.BUF_.BUF$
      1888**DCL      1993<<ASSIGN   2061<<ASSIGN   2075<<ASSIGN
FPT_WRITE.STATION_
      1888**DCL      1888--REDEF
FPT_WRITE.V
      1889**DCL      1886--DCLINIT
FPT_WRITE.V.DVBYTE.VFC#
      1895**DCL      1895--REDEF
I
      1818**DCL      2047<<DOINDEX  2056<<DOINDEX  2070<<DOINDEX
KEY
      1789**DCL      1886--DCLINIT  1912--DCLINIT  1913--DCLINIT
KEY.MSGTYP
      1791**DCL      1949<<ASSIGN
KEY.SUFFIX
      1792**DCL      1992<<ASSIGN   2033<<ASSIGN   2066<<ASSIGN
M$DELREC
PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:34   
       336**DCL-ENT  2038--CALL
M$TIME
       401**DCL-ENT  1945--CALL
M$WRITE
       335**DCL-ENT  1996--CALL     2063--CALL     2077--CALL
MON_ERR IN PROCEDURE WRITE_ENTRY
      2082**LABEL    2038--CALLALT  2063--CALLALT  2077--CALLALT
MON_ERR IN PROCEDURE WRITE_FORM
      2001**LABEL    1996--CALLALT
P_MSGTYP
      1558**DCL         8--PROC     1949>>ASSIGN   2048<>CALL
P_TYPE
      1559**DCL         8--PROC     1951>>IF
QT$ENTRY
      1649**DCL      2067--ASSIGN
QT$ENTRY.FLAGS.DCBS_SET
      1652**DCL      2035>>IF       2037<<ASSIGN   2043<<ASSIGN
QT$ENTRY.FLAGS.NEW_LOCK
      1656**DCL      2045>>IF       2052>>ASSIGN
QT$ENTRY.FLAGS.OLD_LOCK
      1654**DCL      2045>>IF       2052<<ASSIGN
QT$ENTRY.SET_COUNT
      1685**DCL      2035>>IF       2041>>IF       2047>>DOINDEX  2056>>DOINDEX  2070>>DOINDEX
QT$ENTRY.UTS
      1664**DCL      2032<<ASSIGN
QT$FORM
      1734**DCL      1994--ASSIGN
QT$FORM.UTS
      1743**DCL      1991<<ASSIGN
QT$SETBITS
      1693**DCL      2071--ASSIGN   2072--ASSIGN
QT$SETBITS.ASN_MERGE.COUNT
      1710**DCL      1711--IMP-SIZ  2071>>ASSIGN   2072>>ASSIGN
QT$SETTEXT
      1714**DCL      2048<>CALL     2057--ASSIGN   2058--ASSIGN
QT$SETTEXT.COUNT
PL6.E3A0      #001=QTC$WRITE_TRADER File=QTC$WRITE_TRADER.:E05TSI                WED 07/30/97 05:51 Page:35   
      1715**DCL      1720--IMP-SIZ  2048>>CALL     2057>>ASSIGN   2058>>ASSIGN
QTC$MON_ERR
      1586**DCL-ENT  2001--CALL     2082--CALL
QTC$PROCESS_SET
      1585**DCL-ENT  2048--CALL
QT_CMDBLK.OUT$
        80**DCL        81--REDEF
QT_GLOBAL.MUST_FINISH
        77**DCL      1947>>ASSIGN   1948<<ASSIGN   1960<<ASSIGN
QT_GLOBAL.QT$ENTRY$
        78**DCL      1649--IMP-PTR  2032>>ASSIGN   2035>>IF       2035>>IF       2037>>ASSIGN   2041>>IF
      2043>>ASSIGN   2045>>IF       2045>>IF       2047>>DOINDEX  2052>>ASSIGN   2052>>ASSIGN   2056>>DOINDEX
      2068>>ASSIGN   2070>>DOINDEX  2075>>ASSIGN
QT_GLOBAL.QT$FORM$
        78**DCL      1734--IMP-PTR  1991>>ASSIGN   1993>>ASSIGN
QT_GLOBAL.QT$SETTEXT$
        78**DCL      1714--IMP-PTR  2048>>CALL     2048>>CALL     2053>>ASSIGN   2061>>ASSIGN
REC$
      1821**DCL      2053<<ASSIGN   2057>>ASSIGN   2057>>ASSIGN   2058<<ASSIGN   2058>>ASSIGN   2058>>ASSIGN
      2058>>ASSIGN   2068<<ASSIGN   2071>>ASSIGN   2071>>ASSIGN   2072<<ASSIGN   2072>>ASSIGN   2072>>ASSIGN
      2072>>ASSIGN
SAVE_MUST_FINISH_FLAG
      1823**DCL      1947<<ASSIGN   1960>>ASSIGN
UTS
      1787**DCL      1864--DCLINIT  1991>>ASSIGN   2032>>ASSIGN
WRITE_ENTRY
      2030**PROC     1957--CALL
WRITE_FORM
      1989**PROC     1953--CALL
