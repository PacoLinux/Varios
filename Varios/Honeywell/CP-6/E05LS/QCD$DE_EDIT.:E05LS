VERSION E05

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:1    
        1        1        /*M* QCD$DE_EDIT:  De-editor for edited numbers.  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=0,DCI=4,CSI=2,IAD=2,DTI=2,AND,ECI=0,DIN=2,STI=2 */
        8        8
        9        9        /*P*  NAME:         QCD$DE_EDIT
       10       10              PURPOSE:      Check numeric-edited items against their PICture
       11       11                            strings to see if they're "legal".
       12       12              DESCRIPTION:  Aw, man.  This gets called from:
       13       13                            1)  QBM$MOVDE (which may have been called by
       14       14                                MOVE_IT within QBV$VERI_PRES) before moving a
       15       15                                numeric edited number to a numeric number;
       16       16                            2)  QCR$READ while "just checking out" a numeric
       17       17                                edited input from the screen.
       18       18                            So, it checks to see if the numeric edited source
       19       19                            matches its associated DADs PICture string, and
       20       20                            returns a lousy status to its caller if not.
       21       21        */
       22       22
       23       23        QCD$DE_EDIT: PROC ( QCD@DE_EDIT );
       24       24
       25       25        /*D*  NAME:         QCD$DE_EDIT
       26       26              CALL:         CALL QCD$DE_EDIT ( QCD@DE_EDIT );
       27       27              PARAMETERS:   QCD@DE_EDIT is a structure which contains information
       28       28                            concerning the field to be "de-edited"; it's generated
       29       29                            by invoking the QCD@DE_EDIT %MACRO within the QCD_DE_EDIT_M
       30       30                            %INCLUDE file (see commentary within that file).
       31       31              INTERFACE:    Called by QBM$MOVDE and QCR$READ.
       32       32              ENVIRONMENT:  Nothing unusual.
       33       33              INPUT:        QI_1.
       34       34              OUTPUT:       Various stuff in QCD@DE_EDIT filled in.
       35       35              SCRATCH:      Various otter data.
       36       36              DESCRIPTION:  Aw, man.
       37       37                            I don't know where to start.
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:2    
       38       38                            First, the CIP's MOP string (compiler-generated) is
       39       39                            reversed, then it's read through, and a sort of
       40       40                            "inverse" operation from what the CIP's DME instruction
       41       41                            would perform is, well, performed.
       42       42                            The edited input string, then, is more or less checked
       43       43                            to see if the DME instruction would have caused it as
       44       44                            result of being performed on some numeric data item.
       45       45                            In the process, that data item is "inferred" into
       46       46                            existence.
       47       47                            Face it, this thing's a monster.  If it ever breaks,
       48       48                            yer ass is in trouble.
       49       49                            The EPS-1 of the CIP instructions (Review E is the
       50       50                            latest as of this code being written) is invaluable.
       51       51        */
       52       52
       53       53          %INCLUDE LCP_6;
       54      244
       55      245          %INCLUDE QG_MACRO_M;
       56      382          %INCLUDE QI_EQUATES_E;
       57      741          %INCLUDE QI_MACROS_M;
       58     5799          %QI$ALL;
       59    16912
       60    16913          %EQU CHT  = BITBIN('0'X);
       61    16914          %EQU ENF  = BITBIN('1'X);
       62    16915          %EQU IGN  = BITBIN('2'X);
       63    16916          %EQU INSA = BITBIN('3'X);
       64    16917          %EQU INSB = BITBIN('4'X);
       65    16918          %EQU INSM = BITBIN('5'X);
       66    16919          %EQU INSN = BITBIN('6'X);
       67    16920          %EQU INSP = BITBIN('7'X);
       68    16921          %EQU MFLC = BITBIN('8'X);
       69    16922          %EQU MFLS = BITBIN('9'X);
       70    16923          %EQU MVC  = BITBIN('C'X);
       71    16924          %EQU MVZA = BITBIN('D'X);
       72    16925          %EQU MVZB = BITBIN('E'X);
       73    16926          %EQU SEF  = BITBIN('F'X);
       74    16927
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:3    
       75    16928          %SET LISTMAC = '1'B;
       76    16929
       77    16930          %INCLUDE QCD_DE_EDIT_M;
       78    16960          %QCD@DE_EDIT;
             16961            %BEGIN_MACRO ( STCLASS = STCLASS );
             16962            %SET LISTDIR = '0'B;
             16975    1     DCL 1 QCD@DE_EDIT ALIGNED,
             16976    1           2 IS_NUMBER_INVALID BIT(1) ALIGNED,
             16977                                           /* Set to 1 if the input is bad,
             16978                                                     0 otherwise.           */
             16979    1           2 RESULT ALIGNED,
             16980    1             3 DIGIT_A(0:30) UBIN BYTE UNAL,
             16981                                           /* The de-edited number, in the form:
             16982                                              UNPACKED((INDEX(RESULT),B7),0,31,LEADING) */
             16983    1             3 DEC SBIN,
             16984                                           /* Decimal position for DIGIT_A */
             16985    1             3 INPUT_SIZE SBIN;
             16986                                           /* Length of input minus
             16987                                              leading or trailing blanks */
             16994            %ENDIF;
       79    16997
       80    16998          %SET LISTMAC = '0'B;
       81    16999
       82    17000    1     DCL 1 EF,
       83    17001    1           2 ES BIT(1) UNAL,
       84    17002                                           /* ES = 1, end suppression must be on
       85    17003                                              ES = 0, unknown                    */
       86    17004    1           2 ES_OFF BIT(1) UNAL,
       87    17005                                           /* ES_OFF = 1, ES must be off */
       88    17006    1           2 SN BIT(1) UNAL,
       89    17007    1           2 SP BIT(1) UNAL,
       90    17008    1           2 BZ BIT(1) UNAL,
       91    17009    1           2 AZ BIT(1) UNAL,
       92    17010    1           2 PM BIT(1) UNAL;
       93    17011
       94    17012    1     DCL EIT(0:8) UBIN BYTE;
       95    17013
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:4    
       96    17014    1     DCL 1 MOP_ITEM_A(0:60),
       97    17015    1           2 OPERATION UBIN(4) UNAL,
       98    17016    1           2 INFORMATION_FIELD UBIN(4) UNAL,
       99    17017    1           2 INFORMATION_FIELD_FLAG_BITS REDEF INFORMATION_FIELD,
      100    17018    1             3 ES BIT(1) UNAL,
      101    17019    1             3 BZ BIT(1) UNAL,
      102    17020    1             3 AZ BIT(1) UNAL,
      103    17021    1             3 PM BIT(1) UNAL,
      104    17022    1             3 ES_WAS_SET_BEFORE_THIS_ENF REDEF PM BIT(1);
      105    17023    1     DCL MOP_A(0:60) REDEF MOP_ITEM_A UBIN BYTE UNAL;
      106    17024
      107    17025    1     DCL 1 MOP_ITEM ALIGNED,
      108    17026    1           2 OPERATION UBIN(4) UNAL,
      109    17027    1           2 INFORMATION_FIELD UBIN(4) UNAL,
      110    17028    1           2 INFORMATION_FIELD_FLAG_BITS REDEF INFORMATION_FIELD,
      111    17029    1             3 ES BIT(1) UNAL,
      112    17030    1             3 BZ BIT(1) UNAL,
      113    17031    1             3 AZ BIT(1) UNAL,
      114    17032    1             3 PM BIT(1) UNAL,
      115    17033    1             3 ES_WAS_SET_BEFORE_THIS_ENF REDEF PM BIT(1);
      116    17034    1     DCL MOP REDEF MOP_ITEM UBIN BYTE ALIGNED;
      117    17035
      118    17036          /* The next two items are usually the same as
      119    17037             MOP_ITEM.OPERATION and MOP_ITEM.INFORMATION_FIELD,
      120    17038             respectively, and are used so as to provide a more
      121    17039             efficient method of checking their values, especially
      122    17040             for the two DO CASE (OPERATION)s. */
      123    17041    1     DCL OPERATION UBIN;
      124    17042    1     DCL INFORMATION_FIELD SBIN;
      125    17043    1     DCL 1 INFORMATION_FIELD_FLAG_BITS REDEF INFORMATION_FIELD,
      126    17044    1           2 * BIT(12) UNAL,
      127    17045    1           2 ES BIT(1) UNAL,
      128    17046    1           2 BZ BIT(1) UNAL,
      129    17047    1           2 AZ BIT(1) UNAL,
      130    17048    1           2 PM BIT(1) UNAL,
      131    17049    1           2 ES_WAS_SET_BEFORE_THIS_ENF REDEF PM BIT(1);
      132    17050
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:5    
      133    17051    1     DCL CURRENT_SOURCE_INDEX SBIN;
      134    17052    1     DCL ENDING_SOURCE_INDEX SBIN;
      135    17053    1     DCL MOP_STRING_INDEX SBIN;
      136    17054    1     DCL NEW_MOP_STRING_INDEX SBIN;
      137    17055    1     DCL PIC$ PTR;
      138    17056    1     DCL RESULT_INDEX SBIN;
      139    17057    1     DCL SAVE_ES_FLAG BIT(1) ALIGNED;
      140    17058    1     DCL SOURCE_CHARACTER_TO_MATCH UBIN BYTE ALIGNED;
      141    17059    1     DCL STARTING_SOURCE_INDEX SBIN;
      142    17060    1     DCL TEMP_SOURCE_INDEX SBIN;
      143    17061    1     DCL WEVE_ENCOUNTERED_A_DECIMAL BIT(1) ALIGNED;
      144    17062        %EJECT;
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:6    
      145    17063    1       PIC$ = QI_1.PICTURE_STRING_A$ ( %QI#DE_EDIT );
      146    17064
      147    17065    1       EF = '0'B;
      148    17066    1       MOP_ITEM_A = '0'B;
      149    17067    1       CURRENT_SOURCE_INDEX = 0;
      150    17068    1       STARTING_SOURCE_INDEX = 0;
      151    17069
      152    17070    1       QCD@DE_EDIT = '0'B;
      153    17071
      154    17072    1       EIT(1) = %ASCBIN(' ');
      155    17073    1       EIT(2) = %ASCBIN('*');
      156    17074    1       EIT(3) = %ASCBIN('+');
      157    17075    1       EIT(4) = %ASCBIN('-');
      158    17076    1       EIT(5) = %ASCBIN('$');
      159    17077    1       EIT(6) = %ASCBIN(',');
      160    17078    1       EIT(7) = %ASCBIN('.');
      161    17079    1       EIT(8) = %ASCBIN('0');
      162    17080
      163    17081    2       DO RESULT_INDEX = 1 TO 30;
      164    17082    2         QCD@DE_EDIT.RESULT.DIGIT_A (RESULT_INDEX) = %ASCBIN('0');
      165    17083    2       END;
      166    17084
      167    17085    1       RESULT_INDEX = 30;
      168    17086
      169    17087    1       QCD@DE_EDIT.RESULT.DIGIT_A (0) = %ASCBIN('+');
      170    17088
      171    17089    1       QCD@DE_EDIT.RESULT.DEC = PIC$ -> QI$NUMERIC_PICTURE_STRING.DECIMAL_SCALING;
      172    17090        %EJECT;
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:7    
      173    17091            /* Reverse the CIP MOP string */
      174    17092    1       NEW_MOP_STRING_INDEX = 0;
      175    17093
      176    17094    2       DO MOP_STRING_INDEX = 0 TO PIC$ -> QI$NUMERIC_PICTURE_STRING.MOP_STRING_COUNT -
             17094                1;
      177    17095
      178    17096    2         MOP = PIC$ -> QI$NUMERIC_PICTURE_STRING.MOP_STRING_A (MOP_STRING_INDEX);
      179    17097    2         OPERATION = MOP_ITEM.OPERATION;
      180    17098    2         INFORMATION_FIELD = MOP_ITEM.INFORMATION_FIELD;
      181    17099
      182    17100    3         DO CASE ( OPERATION );
      183    17101
      184    17102    3           CASE ( %SEF );
      185    17103    3             IF INFORMATION_FIELD_FLAG_BITS.PM
      186    17104    3             THEN
      187    17105    3               EF.PM = %SET;
      188    17106    3             IF INFORMATION_FIELD_FLAG_BITS.AZ
      189    17107    3             THEN
      190    17108    3               EF.AZ = %SET;
      191    17109    3             IF INFORMATION_FIELD_FLAG_BITS.BZ
      192    17110    3             THEN
      193    17111    3               EF.BZ = %SET;
      194    17112    3             SAVE_ES_FLAG = INFORMATION_FIELD_FLAG_BITS.ES;
      195    17113    3             MOP_ITEM.INFORMATION_FIELD_FLAG_BITS.ES = %RESET;
      196    17114    3             IF EF.ES
      197    17115    3             THEN
      198    17116    3               MOP_ITEM.INFORMATION_FIELD_FLAG_BITS.ES = %SET;
      199    17117    3             IF SAVE_ES_FLAG
      200    17118    3             THEN
      201    17119    3               EF.ES = %SET;
      202    17120    3             ELSE
      203    17121    3               EF.ES = %RESET;
      204    17122    3             MOP_A (NEW_MOP_STRING_INDEX) = MOP;
      205    17123    3             NEW_MOP_STRING_INDEX = NEW_MOP_STRING_INDEX + 1;
      206    17124
      207    17125    3           CASE ( %CHT );
      208    17126    3             MOP_STRING_INDEX = MOP_STRING_INDEX + 1;
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:8    
      209    17127    3             OPERATION = PIC$ -> QI$NUMERIC_PICTURE_STRING.MOP_STRING_A (
             17127                      MOP_STRING_INDEX);
      210    17128    3             MOP_A (NEW_MOP_STRING_INDEX) = EIT(INFORMATION_FIELD);
      211    17129    3             NEW_MOP_STRING_INDEX = NEW_MOP_STRING_INDEX + 1;
      212    17130    3             EIT(INFORMATION_FIELD) = OPERATION;
      213    17131    3             MOP_A (NEW_MOP_STRING_INDEX) = INFORMATION_FIELD;
      214    17132    3             NEW_MOP_STRING_INDEX = NEW_MOP_STRING_INDEX + 1;
      215    17133
      216    17134    3           CASE ( %INSA,
      217    17135    3               %INSB,
      218    17136    3               %INSN,
      219    17137    3               %INSP );
      220    17138    3             IF INFORMATION_FIELD = 0
      221    17139    3             THEN
      222    17140    4               DO;
      223    17141    4                 MOP_STRING_INDEX = MOP_STRING_INDEX + 1;
      224    17142    4                 MOP_A (NEW_MOP_STRING_INDEX) = PIC$ -> QI$NUMERIC_PICTURE_STRING.
             17142                          MOP_STRING_A (MOP_STRING_INDEX);
      225    17143    4                 NEW_MOP_STRING_INDEX = NEW_MOP_STRING_INDEX + 1;
      226    17144    4                 MOP_A (NEW_MOP_STRING_INDEX) = MOP;
      227    17145    4                 NEW_MOP_STRING_INDEX = NEW_MOP_STRING_INDEX + 1;
      228    17146    4               END;
      229    17147    3             ELSE
      230    17148    4               DO;
      231    17149    4                 MOP_A (NEW_MOP_STRING_INDEX) = PIC$ -> QI$NUMERIC_PICTURE_STRING.
             17149                          MOP_STRING_A (MOP_STRING_INDEX);
      232    17150    4                 NEW_MOP_STRING_INDEX = NEW_MOP_STRING_INDEX + 1;
      233    17151    4               END;
      234    17152
      235    17153    3           CASE ( %INSM );
      236    17154    3             MOP_A (NEW_MOP_STRING_INDEX) = PIC$ -> QI$NUMERIC_PICTURE_STRING.
             17154                      MOP_STRING_A (MOP_STRING_INDEX);
      237    17155    3             NEW_MOP_STRING_INDEX = NEW_MOP_STRING_INDEX + 1;
      238    17156
      239    17157    3           CASE ( %ENF );
      240    17158    3             MOP_A (NEW_MOP_STRING_INDEX) = PIC$ -> QI$NUMERIC_PICTURE_STRING.
             17158                      MOP_STRING_A (MOP_STRING_INDEX);
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:9    
      241    17159    3             IF EF.ES                          /* Remember ES flag */
      242    17160    3             THEN
      243    17161    3               MOP_ITEM_A.INFORMATION_FIELD_FLAG_BITS.ES_WAS_SET_BEFORE_THIS_ENF (
             17161                        NEW_MOP_STRING_INDEX) = %SET;
      244    17162    3             NEW_MOP_STRING_INDEX = NEW_MOP_STRING_INDEX + 1;
      245    17163    3             EF.ES = %SET;
      246    17164    3             IF INFORMATION_FIELD_FLAG_BITS.BZ
      247    17165    3             THEN
      248    17166    3               EF.BZ = %SET;
      249    17167
      250    17168    3           CASE ( %MFLC,
      251    17169    3                 %MFLS,
      252    17170    3                 %MVC,
      253    17171    3                 %MVZA,
      254    17172    3                 %MVZB );
      255    17173    3             MOP_A (NEW_MOP_STRING_INDEX) = PIC$ -> QI$NUMERIC_PICTURE_STRING.
             17173                      MOP_STRING_A (MOP_STRING_INDEX);
      256    17174    3             NEW_MOP_STRING_INDEX = NEW_MOP_STRING_INDEX + 1;
      257    17175
      258    17176    3           CASE ( ELSE );
      259    17177    3             GOTO ABORT;
      260    17178
      261    17179    3         END; /* DO CASE ( OPERATION ) */
      262    17180
      263    17181    2       END; /* DO MOP_STRING_INDEX = ... */
      264    17182        %EJECT;
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:10   
      265    17183            /* MOP string is now set up to read backwards */
      266    17184    1       NEW_MOP_STRING_INDEX = NEW_MOP_STRING_INDEX - 1;
      267    17185
      268    17186            /* We'll just index past the trailing blanks... */
      269    17187    1       CURRENT_SOURCE_INDEX = QI_1.OP.LEN_A (%QI#DE_EDIT)
      270    17188    1         + QI_1.OFFSET_A (%QI#DE_EDIT)
      271    17189    1         - 1;
      272    17190
      273    17191    2       DO WHILE ( CURRENT_SOURCE_INDEX >= QI_1.OFFSET_A (%QI#DE_EDIT)
      274    17192    2         AND ( QI_1.OP.DATA_A$ (%QI#DE_EDIT) -> QI$UBYTE_A (CURRENT_SOURCE_INDEX) = %
             17192                  ASCBIN(' ') ) );
      275    17193    2         CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;
      276    17194    2       END;
      277    17195
      278    17196    1       STARTING_SOURCE_INDEX = CURRENT_SOURCE_INDEX;
      279    17197
      280    17198            /* ...and check for all blanks, legal only if EF:BZ is set... */
      281    17199    1       IF STARTING_SOURCE_INDEX < QI_1.OFFSET_A (%QI#DE_EDIT)
      282    17200    1       THEN
      283    17201    2         DO;
      284    17202    2           QCD@DE_EDIT.RESULT.INPUT_SIZE = 0;
      285    17203    2           IF EF.BZ
      286    17204    2           THEN
      287    17205    2             GOTO SUCCEED;
      288    17206    2           ELSE
      289    17207    2             GOTO ABORT;
      290    17208    2         END;
      291    17209
      292    17210            /* ...and maybe index past the leading blanks, too. */
      293    17211    1       ENDING_SOURCE_INDEX = QI_1.OFFSET_A (%QI#DE_EDIT);
      294    17212
      295    17213    2       DO WHILE ( ( ENDING_SOURCE_INDEX < STARTING_SOURCE_INDEX )
      296    17214    2         AND ( QI_1.OP.DATA_A$ (%QI#DE_EDIT) -> QI$UBYTE_A (ENDING_SOURCE_INDEX) = %
             17214                  ASCBIN(' ') ) );
      297    17215    2         ENDING_SOURCE_INDEX = ENDING_SOURCE_INDEX + 1;
      298    17216    2       END;
      299    17217
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:11   
      300    17218    1       QCD@DE_EDIT.RESULT.INPUT_SIZE = STARTING_SOURCE_INDEX - ENDING_SOURCE_INDEX + 1;
      301    17219
      302    17220            /* Check for "asterisk-when-zero"... */
      303    17221    1       IF EF.AZ
      304    17222    1       THEN
      305    17223    2         DO;
      306    17224    2           TEMP_SOURCE_INDEX = STARTING_SOURCE_INDEX;
      307    17225    2           WEVE_ENCOUNTERED_A_DECIMAL = %NO;
      308    17226    3           DO WHILE ( TEMP_SOURCE_INDEX >= ENDING_SOURCE_INDEX );
      309    17227    3             SOURCE_CHARACTER_TO_MATCH = QI_1.OP.DATA_A$ (%QI#DE_EDIT) -> QI$UBYTE_A (
             17227                      TEMP_SOURCE_INDEX);
      310    17228    3             IF SOURCE_CHARACTER_TO_MATCH = EIT (2)  /* '*' */
      311    17229    3             THEN
      312    17230    3               TEMP_SOURCE_INDEX = TEMP_SOURCE_INDEX - 1;
      313    17231    3             ELSE
      314    17232    4               DO;
      315    17233    4                 IF SOURCE_CHARACTER_TO_MATCH = EIT (7)  /* '.' */
      316    17234    4                 THEN
      317    17235    5                   DO;
      318    17236    5                     IF WEVE_ENCOUNTERED_A_DECIMAL = %YES
      319    17237    5                     THEN
      320    17238    5                       GOTO NOT_AZ;
      321    17239    5                     WEVE_ENCOUNTERED_A_DECIMAL = %YES;
      322    17240    5                     TEMP_SOURCE_INDEX = TEMP_SOURCE_INDEX - 1;
      323    17241    5                   END;
      324    17242    4                 ELSE
      325    17243    4                   GOTO NOT_AZ;
      326    17244    4               END;
      327    17245    3           END;
      328    17246    2           GOTO SUCCEED;
      329    17247    2         END;
      330    17248        %EJECT;
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:12   
      331    17249    1   NOT_AZ:
      332    17250            /* Main loop:  reads backwards through the MOP string
      333    17251                           trying to match characters from the input string... */
      334    17252    2       DO WHILE ( NEW_MOP_STRING_INDEX >= 0 );
      335    17253
      336    17254    2         MOP = MOP_A (NEW_MOP_STRING_INDEX);
      337    17255    2         NEW_MOP_STRING_INDEX = NEW_MOP_STRING_INDEX - 1;
      338    17256    2         OPERATION = MOP_ITEM.OPERATION;
      339    17257    2         INFORMATION_FIELD = MOP_ITEM.INFORMATION_FIELD;
      340    17258
      341    17259              /* Process some common features (bugs?) */
      342    17260    2         IF (OPERATION = %INSA)
      343    17261    2           OR (OPERATION = %INSB)
      344    17262    2           OR (OPERATION = %INSN)
      345    17263    2           OR (OPERATION = %INSP)
      346    17264    2         THEN
      347    17265
      348    17266    3           DO;
      349    17267    3             IF INFORMATION_FIELD = 0
      350    17268    3             THEN
      351    17269    4               DO;
      352    17270    4                 INFORMATION_FIELD = MOP_A (NEW_MOP_STRING_INDEX);
      353    17271    4                 NEW_MOP_STRING_INDEX = NEW_MOP_STRING_INDEX - 1;
      354    17272    4               END;
      355    17273    3             ELSE
      356    17274    3               INFORMATION_FIELD = EIT (INFORMATION_FIELD);
      357    17275
      358    17276    3             IF CURRENT_SOURCE_INDEX < ENDING_SOURCE_INDEX
      359    17277    3             THEN
      360    17278    3               SOURCE_CHARACTER_TO_MATCH = %ASCBIN(' ');
      361    17279    3             ELSE
      362    17280    3               SOURCE_CHARACTER_TO_MATCH = QI_1.OP.DATA_A$ (%QI#DE_EDIT) -> QI$UBYTE_A
             17280                        (CURRENT_SOURCE_INDEX);
      363    17281    3           END;
      364    17282
      365    17283    2         ELSE
      366    17284
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:13   
      367    17285    2           IF ( (OPERATION = %MVC)
      368    17286    2             OR (OPERATION = %MFLC)
      369    17287    2             OR (OPERATION = %MFLS)
      370    17288    2             OR (OPERATION = %MVZB)
      371    17289    2             OR (OPERATION = %MVZA)
      372    17290    2             OR (OPERATION = %INSM) )
      373    17291    2             AND (INFORMATION_FIELD = 0)
      374    17292    2           THEN
      375    17293
      376    17294    2             INFORMATION_FIELD = 16;
      377    17295
      378    17296
      379    17297    3         DO CASE ( OPERATION );
      380    17298
      381    17299    3           CASE ( %SEF );
      382    17300    3             IF INFORMATION_FIELD_FLAG_BITS.PM
      383    17301    3             THEN
      384    17302    3               EF.PM = %RESET;
      385    17303    3             IF INFORMATION_FIELD_FLAG_BITS.ES
      386    17304    3             THEN
      387    17305    3               EF.ES = %SET;
      388    17306    3             ELSE
      389    17307    3               EF.ES = %RESET;
      390    17308    3             EF.ES_OFF = %RESET;
      391    17309
      392    17310    3           CASE ( %CHT );
      393    17311    3             EIT (INFORMATION_FIELD) = MOP_A (NEW_MOP_STRING_INDEX);
      394    17312    3             NEW_MOP_STRING_INDEX = NEW_MOP_STRING_INDEX - 1;
      395    17313
      396    17314    3           CASE ( %INSA );
      397    17315    3             IF ( SOURCE_CHARACTER_TO_MATCH = INFORMATION_FIELD )
      398    17316    3               AND NOT EF.ES_OFF
      399    17317    3             THEN
      400    17318    3               CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;
      401    17319    3             ELSE
      402    17320    3               IF  ( SOURCE_CHARACTER_TO_MATCH = EIT (2) )
      403    17321    3                 AND NOT EF.ES
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:14   
      404    17322    3               THEN
      405    17323    4                 DO;
      406    17324    4                   CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;
      407    17325    4                   EF.ES_OFF = %SET;
      408    17326    4                 END;
      409    17327    3               ELSE
      410    17328    3                 IF  ( CURRENT_SOURCE_INDEX = STARTING_SOURCE_INDEX )
      411    17329    3                   AND ( ( INFORMATION_FIELD ~= %ASCBIN(' ') ) OR EF.ES_OFF )
      412    17330    3                   AND ( ( EIT (2) ~= %ASCBIN(' ') ) OR EF.ES )
      413    17331    3                 THEN
      414    17332    3                   GOTO ABORT;
      415    17333
      416    17334    3           CASE ( %INSB );
      417    17335    3             IF  ( SOURCE_CHARACTER_TO_MATCH = INFORMATION_FIELD )
      418    17336    3               AND NOT EF.ES_OFF
      419    17337    3             THEN
      420    17338    3               CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;
      421    17339    3             ELSE
      422    17340    3               IF  ( SOURCE_CHARACTER_TO_MATCH = EIT (1) )
      423    17341    3                 AND NOT EF.ES
      424    17342    3               THEN
      425    17343    4                 DO;
      426    17344    4                   CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;
      427    17345    4                   EF.ES_OFF = %SET;
      428    17346    4                 END;
      429    17347    3               ELSE
      430    17348    3                 IF CURRENT_SOURCE_INDEX = STARTING_SOURCE_INDEX
      431    17349    3                 THEN
      432    17350    4                   DO;
      433    17351    4                     IF  ( ( INFORMATION_FIELD ~= %ASCBIN(' ') ) OR EF.ES_OFF )
      434    17352    4                       AND ( ( EIT (1) ~= %ASCBIN(' ') ) OR EF.ES )
      435    17353    4                     THEN
      436    17354    4                       GOTO ABORT;
      437    17355    4                   END;
      438    17356    3                 ELSE
      439    17357    3                   IF  ( SOURCE_CHARACTER_TO_MATCH ~= INFORMATION_FIELD )
      440    17358    3                     AND EF.ES
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:15   
      441    17359    3                   THEN
      442    17360    3                     GOTO ABORT;
      443    17361
      444    17362    3           CASE ( %INSN );
      445    17363    3             IF SOURCE_CHARACTER_TO_MATCH = INFORMATION_FIELD
      446    17364    3             THEN
      447    17365    4               DO;
      448    17366    4                 EF.SN = %SET;
      449    17367    4                 IF EF.SP
      450    17368    4                 THEN
      451    17369    4                   GOTO ABORT_SIGN;
      452    17370    4                 CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;
      453    17371    4               END;
      454    17372    3             ELSE
      455    17373                    /* This next test is a kludge to allow an entry of '+'
      456    17374                       into a PICture string of '-'...
      457    17375                       The '+' is treated as if it were a ' ' (EIT (1)) */
      458    17376    3               IF  ( INFORMATION_FIELD = %ASCBIN('-') )
      459    17377    3                 AND ( SOURCE_CHARACTER_TO_MATCH = %ASCBIN('+') )
      460    17378    3               THEN
      461    17379    4                 DO;
      462    17380    4                   EF.SP = %SET;
      463    17381    4                   IF EF.SN
      464    17382    4                   THEN
      465    17383    4                     GOTO ABORT_SIGN;
      466    17384    4                   CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;
      467    17385    4                 END;
      468    17386    3               ELSE
      469    17387    3                 IF SOURCE_CHARACTER_TO_MATCH = EIT (1)
      470    17388    3                 THEN
      471    17389    4                   DO;
      472    17390    4                     CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;
      473    17391    4                     EF.SP = %SET;
      474    17392    4                     IF EF.SN
      475    17393    4                     THEN
      476    17394    4                       GOTO ABORT_SIGN;
      477    17395    4                   END;
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:16   
      478    17396    3                 ELSE
      479    17397    3                   IF CURRENT_SOURCE_INDEX = STARTING_SOURCE_INDEX
      480    17398    3                   THEN
      481    17399    4                     DO;
      482    17400    4                       IF INFORMATION_FIELD = %ASCBIN(' ')
      483    17401    4                       THEN
      484    17402    5                         DO;
      485    17403    5                           EF.SN = %SET;
      486    17404    5                           IF EF.SP
      487    17405    5                           THEN
      488    17406    5                             GOTO ABORT_SIGN;
      489    17407    5                         END;
      490    17408    4                       ELSE
      491    17409    5                         DO;
      492    17410    5                           IF EIT (1) = %ASCBIN(' ')
      493    17411    5                           THEN
      494    17412    6                             DO;
      495    17413    6                               EF.SP = %SET;
      496    17414    6                               IF EF.SN
      497    17415    6                               THEN
      498    17416    6                                 GOTO ABORT_SIGN;
      499    17417    6                             END;
      500    17418    5                           ELSE
      501    17419    5                             GOTO ABORT;
      502    17420    5                         END;
      503    17421    4                     END;
      504    17422    3                   ELSE
      505    17423    3                     GOTO ABORT;
      506    17424
      507    17425    3           CASE ( %INSP );
      508    17426    3             IF EF.PM
      509    17427    3             THEN
      510    17428    3               IF SOURCE_CHARACTER_TO_MATCH = EIT (3)
      511    17429    3               THEN
      512    17430    4                 DO;
      513    17431    4                   CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;
      514    17432    4                   EF.SP = %SET;
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:17   
      515    17433    4                   IF EF.SN
      516    17434    4                   THEN
      517    17435    4                     GOTO ABORT_SIGN;
      518    17436    4                 END;
      519    17437    3               ELSE
      520    17438    3                 IF SOURCE_CHARACTER_TO_MATCH = EIT (4)
      521    17439    3                 THEN
      522    17440    4                   DO;
      523    17441    4                     CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;
      524    17442    4                     EF.SN = %SET;
      525    17443    4                     IF EF.SP
      526    17444    4                     THEN
      527    17445    4                       GOTO ABORT_SIGN;
      528    17446    4                   END;
      529    17447    3                 ELSE /* IF (not) EF.PM */
      530    17448    3                   IF SOURCE_CHARACTER_TO_MATCH = INFORMATION_FIELD
      531    17449    3                   THEN
      532    17450    4                     DO;
      533    17451    4                       CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;
      534    17452    4                       EF.SP = %SET;
      535    17453    4                       IF EF.SN
      536    17454    4                       THEN
      537    17455    4                         GOTO ABORT_SIGN;
      538    17456    4                     END;
      539    17457    3                   ELSE
      540    17458    3                     IF SOURCE_CHARACTER_TO_MATCH = EIT (1)
      541    17459    3                     THEN
      542    17460    3                       CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;
      543    17461    3                     ELSE
      544    17462    3                       IF CURRENT_SOURCE_INDEX = STARTING_SOURCE_INDEX
      545    17463    3                       THEN
      546    17464    4                         DO;
      547    17465    4                           IF INFORMATION_FIELD = %ASCBIN(' ')
      548    17466    4                           THEN
      549    17467    5                             DO;
      550    17468    5                               EF.SP = %SET;
      551    17469    5                               IF EF.SN
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:18   
      552    17470    5                               THEN
      553    17471    5                                 GOTO ABORT_SIGN;
      554    17472    5                             END;
      555    17473    4                           ELSE
      556    17474    4                             IF EIT (1) = %ASCBIN(' ')
      557    17475    4                             THEN
      558    17476    5                               DO;
      559    17477    5                                 EF.SN = %SET;
      560    17478    5                                 IF EF.SP
      561    17479    5                                 THEN
      562    17480    5                                   GOTO ABORT_SIGN;
      563    17481    5                               END;
      564    17482    4                         END;
      565    17483    3                       ELSE
      566    17484    3                         GOTO ABORT;
      567    17485
      568    17486    3           CASE ( %MVC );
      569    17487    3   DO_MVC:
      570    17488    4             DO WHILE ( INFORMATION_FIELD ~= 0 );
      571    17489    4               SOURCE_CHARACTER_TO_MATCH = QI_1.OP.DATA_A$ (%QI#DE_EDIT) -> QI$UBYTE_A
             17489                        (CURRENT_SOURCE_INDEX);
      572    17490    4               IF ( SOURCE_CHARACTER_TO_MATCH < %ASCBIN('0') )
      573    17491    4                 OR ( SOURCE_CHARACTER_TO_MATCH > %ASCBIN('9') )
      574    17492    4               THEN
      575    17493    4                 GOTO ABORT;
      576    17494    4               ELSE
      577    17495    5                 DO;
      578    17496    5                   QCD@DE_EDIT.RESULT.DIGIT_A (RESULT_INDEX) =
             17496                            SOURCE_CHARACTER_TO_MATCH;
      579    17497    5                   RESULT_INDEX = RESULT_INDEX - 1;
      580    17498    5                 END;
      581    17499    4               CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;
      582    17500    4               INFORMATION_FIELD = INFORMATION_FIELD - 1;
      583    17501    4             END;
      584    17502
      585    17503    3           CASE ( %MFLC );
      586    17504    3             IF EF.ES
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:19   
      587    17505    3             THEN
      588    17506    3               GOTO DO_MVC;
      589    17507    4             DO WHILE ( ( INFORMATION_FIELD > 0 )
      590    17508    4               OR ( ( INFORMATION_FIELD >= 0 ) AND NOT EF.ES_OFF ) );
      591    17509    4               IF CURRENT_SOURCE_INDEX < ENDING_SOURCE_INDEX
      592    17510    4               THEN
      593    17511    4                 SOURCE_CHARACTER_TO_MATCH = %ASCBIN(' ');
      594    17512    4               ELSE
      595    17513    4                 SOURCE_CHARACTER_TO_MATCH = QI_1.OP.DATA_A$ (%QI#DE_EDIT) ->
             17513                          QI$UBYTE_A (CURRENT_SOURCE_INDEX);
      596    17514    4               CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;
      597    17515    4               IF  ( SOURCE_CHARACTER_TO_MATCH = EIT (5) )
      598    17516    4                 AND NOT EF.ES_OFF
      599    17517    4               THEN
      600    17518    5                 DO;
      601    17519    5                   EF.ES_OFF = %SET;
      602    17520    5                   INFORMATION_FIELD = INFORMATION_FIELD + 1;
      603    17521    5                 END;
      604    17522    4               ELSE
      605    17523    4                 IF SOURCE_CHARACTER_TO_MATCH = EIT (1)
      606    17524    4                 THEN
      607    17525    4                   EF.ES_OFF = %SET;
      608    17526    4                 ELSE
      609    17527    4                   IF ( SOURCE_CHARACTER_TO_MATCH < %ASCBIN('0') )
      610    17528    4                     OR ( SOURCE_CHARACTER_TO_MATCH > %ASCBIN('9') )
      611    17529    4                     OR EF.ES_OFF
      612    17530    4                   THEN
      613    17531    5                     DO;
      614    17532    5                       INFORMATION_FIELD = 0;
      615    17533    5                       CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX + 1;
      616    17534    5                     END;
      617    17535    4                   ELSE
      618    17536    5                     DO;
      619    17537    5                       IF INFORMATION_FIELD <= 0
      620    17538    5                       THEN
      621    17539    5                         GOTO ABORT;
      622    17540    5                       QCD@DE_EDIT.RESULT.DIGIT_A (RESULT_INDEX) =
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:20   
             17540                                SOURCE_CHARACTER_TO_MATCH;
      623    17541    5                       RESULT_INDEX = RESULT_INDEX - 1;
      624    17542    5                     END;
      625    17543    4               INFORMATION_FIELD = INFORMATION_FIELD - 1;
      626    17544    4             END;
      627    17545
      628    17546    3           CASE ( %MFLS );
      629    17547    3             IF EF.ES
      630    17548    3             THEN
      631    17549    3               GOTO DO_MVC;
      632    17550    4             DO WHILE ( ( INFORMATION_FIELD > 0 )
      633    17551    4               OR ( ( INFORMATION_FIELD >= 0 ) AND NOT EF.ES_OFF ) );
      634    17552    4               IF CURRENT_SOURCE_INDEX < ENDING_SOURCE_INDEX
      635    17553    4               THEN
      636    17554    4                 SOURCE_CHARACTER_TO_MATCH = %ASCBIN(' ');
      637    17555    4               ELSE
      638    17556    4                 SOURCE_CHARACTER_TO_MATCH = QI_1.OP.DATA_A$ (%QI#DE_EDIT) ->
             17556                          QI$UBYTE_A (CURRENT_SOURCE_INDEX);
      639    17557    4               CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;
      640    17558    4               IF  ( SOURCE_CHARACTER_TO_MATCH = EIT (4) )
      641    17559    4                 AND NOT EF.ES_OFF
      642    17560    4               THEN
      643    17561    5                 DO;
      644    17562    5                   EF.ES_OFF = %SET;
      645    17563    5                   EF.SN = %SET;
      646    17564    5                   IF EF.SP
      647    17565    5                   THEN
      648    17566    5                     GOTO ABORT_SIGN;
      649    17567    5                   INFORMATION_FIELD = INFORMATION_FIELD + 1;
      650    17568    5                 END;
      651    17569    4               ELSE
      652    17570    4                 IF  ( SOURCE_CHARACTER_TO_MATCH = EIT (3) )
      653    17571    4                   AND NOT EF.ES_OFF
      654    17572    4                 THEN
      655    17573    5                   DO;
      656    17574    5                     EF.ES_OFF = %SET;
      657    17575    5                     EF.SP = %SET;
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:21   
      658    17576    5                     INFORMATION_FIELD = INFORMATION_FIELD + 1;
      659    17577    5                     IF EF.SN
      660    17578    5                     THEN
      661    17579    5                       GOTO ABORT_SIGN;
      662    17580    5                     IF NOT EF.PM
      663    17581    5                     THEN
      664    17582    5                       GOTO ABORT;
      665    17583    5                   END;
      666    17584    4                 ELSE
      667    17585    4                   IF SOURCE_CHARACTER_TO_MATCH = EIT (1)
      668    17586    4                   THEN
      669    17587    4                     EF.ES_OFF = %SET;
      670    17588    4                   ELSE
      671    17589    4                     IF ( SOURCE_CHARACTER_TO_MATCH < %ASCBIN('0') )
      672    17590    4                       OR ( SOURCE_CHARACTER_TO_MATCH > %ASCBIN('9') )
      673    17591    4                       OR EF.ES_OFF
      674    17592    4                     THEN
      675    17593    5                       DO;
      676    17594    5                         INFORMATION_FIELD = 0;
      677    17595    5                         CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX + 1;
      678    17596    5                       END;
      679    17597    4                     ELSE
      680    17598    5                       DO;
      681    17599                              /* move into temp */
      682    17600    5                         IF INFORMATION_FIELD <= 0
      683    17601    5                         THEN
      684    17602    5                           GOTO ABORT;
      685    17603    5                         QCD@DE_EDIT.RESULT.DIGIT_A (RESULT_INDEX) =
             17603                                  SOURCE_CHARACTER_TO_MATCH;
      686    17604    5                         RESULT_INDEX = RESULT_INDEX - 1;
      687    17605    5                       END;
      688    17606    4               INFORMATION_FIELD = INFORMATION_FIELD - 1;
      689    17607    4             END;
      690    17608
      691    17609    3           CASE ( %MVZB );
      692    17610    3             IF EF.ES
      693    17611    3             THEN
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:22   
      694    17612    3               GOTO DO_MVC;
      695    17613    4             DO WHILE ( INFORMATION_FIELD ~= 0 );
      696    17614    4               IF CURRENT_SOURCE_INDEX < ENDING_SOURCE_INDEX
      697    17615    4               THEN
      698    17616    4                 SOURCE_CHARACTER_TO_MATCH = %ASCBIN(' ');
      699    17617    4               ELSE
      700    17618    4                 SOURCE_CHARACTER_TO_MATCH = QI_1.OP.DATA_A$ (%QI#DE_EDIT) ->
             17618                          QI$UBYTE_A (CURRENT_SOURCE_INDEX);
      701    17619    4               CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;
      702    17620    4               IF SOURCE_CHARACTER_TO_MATCH = EIT (1)
      703    17621    4               THEN
      704    17622    4                 EF.ES_OFF = %SET;
      705    17623    4               ELSE
      706    17624    4                 IF ( SOURCE_CHARACTER_TO_MATCH < %ASCBIN('0') )
      707    17625    4                   OR ( SOURCE_CHARACTER_TO_MATCH > %ASCBIN('9') )
      708    17626    4                   OR EF.ES_OFF
      709    17627    4                 THEN
      710    17628    5                   DO;
      711    17629    5                     INFORMATION_FIELD = 1;
      712    17630    5                     CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX + 1;
      713    17631    5                   END;
      714    17632    4                 ELSE
      715    17633    5                   DO;
      716    17634                          /* move it to temp */
      717    17635    5                     QCD@DE_EDIT.RESULT.DIGIT_A (RESULT_INDEX) =
             17635                              SOURCE_CHARACTER_TO_MATCH;
      718    17636    5                     RESULT_INDEX = RESULT_INDEX - 1;
      719    17637    5                   END;
      720    17638    4               INFORMATION_FIELD = INFORMATION_FIELD - 1;
      721    17639    4             END;
      722    17640
      723    17641    3           CASE ( %MVZA );
      724    17642    3             IF EF.ES
      725    17643    3             THEN
      726    17644    3               GOTO DO_MVC;
      727    17645    4             DO WHILE ( INFORMATION_FIELD ~= 0 );
      728    17646    4               IF CURRENT_SOURCE_INDEX < ENDING_SOURCE_INDEX
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:23   
      729    17647    4               THEN
      730    17648    4                 SOURCE_CHARACTER_TO_MATCH = %ASCBIN(' ');
      731    17649    4               ELSE
      732    17650    4                 SOURCE_CHARACTER_TO_MATCH = QI_1.OP.DATA_A$ (%QI#DE_EDIT) ->
             17650                          QI$UBYTE_A (CURRENT_SOURCE_INDEX);
      733    17651    4               CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;
      734    17652    4               IF SOURCE_CHARACTER_TO_MATCH = EIT (2)
      735    17653    4               THEN
      736    17654    4                 EF.ES_OFF = %SET;
      737    17655    4               ELSE
      738    17656    4                 IF ( SOURCE_CHARACTER_TO_MATCH < %ASCBIN('0') )
      739    17657    4                   OR ( SOURCE_CHARACTER_TO_MATCH > %ASCBIN('9') )
      740    17658    4                   OR EF.ES_OFF
      741    17659    4                 THEN
      742    17660    5                   DO;
      743    17661    5                     INFORMATION_FIELD = 1;
      744    17662    5                     CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX + 1;
      745    17663    5                   END;
      746    17664    4                 ELSE
      747    17665    5                   DO;
      748    17666                          /* move it to temp */
      749    17667    5                     QCD@DE_EDIT.RESULT.DIGIT_A (RESULT_INDEX) =
             17667                              SOURCE_CHARACTER_TO_MATCH;
      750    17668    5                     RESULT_INDEX = RESULT_INDEX - 1;
      751    17669    5                   END;
      752    17670    4               INFORMATION_FIELD = INFORMATION_FIELD - 1;
      753    17671    4             END;
      754    17672
      755    17673    3           CASE ( %INSM );
      756    17674    4             DO WHILE ( INFORMATION_FIELD ~= 0 );
      757    17675    4               IF CURRENT_SOURCE_INDEX < ENDING_SOURCE_INDEX
      758    17676    4               THEN
      759    17677    4                 SOURCE_CHARACTER_TO_MATCH = %ASCBIN(' ');
      760    17678    4               ELSE
      761    17679    4                 SOURCE_CHARACTER_TO_MATCH = QI_1.OP.DATA_A$ (%QI#DE_EDIT) ->
             17679                          QI$UBYTE_A (CURRENT_SOURCE_INDEX);
      762    17680    4               IF SOURCE_CHARACTER_TO_MATCH = EIT (1)
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:24   
      763    17681    4               THEN
      764    17682    4                 CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;
      765    17683    4               ELSE
      766    17684    4                 IF ( EIT (1) ~= %ASCBIN(' ') )
      767    17685    4                   OR ( CURRENT_SOURCE_INDEX ~= STARTING_SOURCE_INDEX )
      768    17686    4                 THEN
      769    17687    4                   GOTO ABORT;
      770    17688    4               INFORMATION_FIELD = INFORMATION_FIELD - 1;
      771    17689    4             END;
      772    17690
      773    17691    3           CASE ( %ENF );
      774    17692    3             IF INFORMATION_FIELD_FLAG_BITS.ES_WAS_SET_BEFORE_THIS_ENF
      775    17693    3             THEN
      776    17694    3               EF.ES = %SET;
      777    17695    3             ELSE
      778    17696    3               EF.ES = %RESET;
      779    17697    3             EF.ES_OFF = %RESET;
      780    17698    3             SOURCE_CHARACTER_TO_MATCH = QI_1.OP.DATA_A$ (%QI#DE_EDIT) -> QI$UBYTE_A (
             17698                      CURRENT_SOURCE_INDEX);
      781    17699    3             IF SOURCE_CHARACTER_TO_MATCH = EIT (5)  /* '$' */
      782    17700    3             THEN
      783    17701    4               DO;
      784    17702    4                 EF.ES_OFF = %SET;
      785    17703    4                 CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;
      786    17704    4               END;
      787    17705    3             ELSE
      788    17706    3               IF SOURCE_CHARACTER_TO_MATCH = EIT (4)  /* '-' */
      789    17707    3               THEN
      790    17708    4                 DO;
      791    17709    4                   EF.SN = %SET;
      792    17710    4                   IF EF.SP
      793    17711    4                   THEN
      794    17712    4                     GOTO ABORT_SIGN;
      795    17713    4                   EF.ES_OFF = %SET;
      796    17714    4                   CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;
      797    17715    4                 END;
      798    17716    3               ELSE
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:25   
      799    17717    3                 IF SOURCE_CHARACTER_TO_MATCH = EIT (3)  /* '+' */
      800    17718    3                 THEN
      801    17719    4                   DO;
      802    17720    4                     EF.SP = %SET;
      803    17721    4                     IF EF.SN
      804    17722    4                     THEN
      805    17723    4                       GOTO ABORT_SIGN;
      806    17724    4                     IF NOT EF.PM
      807    17725    4                     THEN
      808    17726    4                       GOTO ABORT;
      809    17727    4                     EF.ES_OFF = %SET;
      810    17728    4                     CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;
      811    17729    4                   END;
      812    17730    3                 ELSE
      813    17731    3                   IF SOURCE_CHARACTER_TO_MATCH = EIT (1)  /* ' ' */
      814    17732    3                   THEN
      815    17733    4                     DO;
      816    17734    4                       EF.SP = %SET;
      817    17735    4                       IF EF.SN
      818    17736    4                       THEN
      819    17737    4                         GOTO ABORT_SIGN;
      820    17738    4                       EF.ES_OFF = %SET;
      821    17739    4                       CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;
      822    17740    4                     END;
      823    17741
      824    17742    3         END;  /* of DO CASE ( OPERATION ) */
      825    17743
      826    17744
      827    17745    2       END;  /* of main loop */
      828    17746
      829    17747
      830    17748    1       IF EF.SN                 /* negative? */
      831    17749    1       THEN
      832    17750    1         QCD@DE_EDIT.RESULT.DIGIT_A (0) = %ASCBIN('-');
      833    17751
      834    17752    1       IF CURRENT_SOURCE_INDEX >= ENDING_SOURCE_INDEX
      835    17753    1       THEN
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:26   
      836    17754              /* "Garbage at left end of number..." */
      837    17755    1         QCD@DE_EDIT.IS_NUMBER_INVALID = %YES;
      838    17756
      839    17757    1   SUCCEED:
      840    17758    1       RETURN;
      841    17759
      842    17760    1   ABORT:
      843    17761            /* "Bad value in QI$MOVDE..." */
      844    17762    1       QCD@DE_EDIT.IS_NUMBER_INVALID = %YES;
      845    17763    1       GOTO SUCCEED;
      846    17764
      847    17765    1   ABORT_SIGN:
      848    17766            /* "Contradictory sign information..." */
      849    17767    1       QCD@DE_EDIT.IS_NUMBER_INVALID = %YES;
      850    17768    1       GOTO SUCCEED;
      851    17769
      852    17770
      853    17771
      854    17772    1   END QCD$DE_EDIT;

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:27   
--  Include file information  --

   QCD_DE_EDIT_M.:E05TOU  is referenced.
   QI_MACROS_M.:E05TOU  is referenced.
   QI_EQUATES_E.:E05TOU  is referenced.
   QG_MACRO_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QCD$DE_EDIT.

   Procedure QCD$DE_EDIT requires 1511 words for executable code.
   Procedure QCD$DE_EDIT requires 62 words of local(AUTO) storage.

    No errors detected in file QCD$DE_EDIT.:E05TSI    .

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:28   

 Object Unit name= QCD$DE_EDIT                                File name= QCD$DE_EDIT.:E05TOU
 UTS= JUL 30 '97 05:05:54.24 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   Proc  even  none  1511    5E7  QCD$DE_EDIT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        1  QCD$DE_EDIT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X6A_AUTO_1
                       nStd      0 X6A_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     QI_1                                  QI_4_CHAR_ALPHANUMERIC                QI_31_DIGIT_SLS_DISPLAY
     QI_16_BIT_BINARY                      QI_32_BIT_BINARY                      QI_31_DIGIT_ST_PACKED
     QI_PICTURE_STRING                r    G$ROS$
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:29   


        1        1        /*M* QCD$DE_EDIT:  De-editor for edited numbers.  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=0,DCI=4,CSI=2,IAD=2,DTI=2,AND,ECI=0,DIN=2,STI=2 */
        8        8
        9        9        /*P*  NAME:         QCD$DE_EDIT
       10       10              PURPOSE:      Check numeric-edited items against their PICture
       11       11                            strings to see if they're "legal".
       12       12              DESCRIPTION:  Aw, man.  This gets called from:
       13       13                            1)  QBM$MOVDE (which may have been called by
       14       14                                MOVE_IT within QBV$VERI_PRES) before moving a
       15       15                                numeric edited number to a numeric number;
       16       16                            2)  QCR$READ while "just checking out" a numeric
       17       17                                edited input from the screen.
       18       18                            So, it checks to see if the numeric edited source
       19       19                            matches its associated DADs PICture string, and
       20       20                            returns a lousy status to its caller if not.
       21       21        */
       22       22
       23       23        QCD$DE_EDIT: PROC ( QCD@DE_EDIT );

     23   0 000000  D380 0000 0000  xent QCD$DE_EDIT     LNJ,B5   X6A_AUTO_1
          0 000003       003E 0001                       DC       62,1

       24       24
       25       25        /*D*  NAME:         QCD$DE_EDIT
       26       26              CALL:         CALL QCD$DE_EDIT ( QCD@DE_EDIT );
       27       27              PARAMETERS:   QCD@DE_EDIT is a structure which contains information
       28       28                            concerning the field to be "de-edited"; it's generated
       29       29                            by invoking the QCD@DE_EDIT %MACRO within the QCD_DE_EDIT_M
       30       30                            %INCLUDE file (see commentary within that file).
       31       31              INTERFACE:    Called by QBM$MOVDE and QCR$READ.
       32       32              ENVIRONMENT:  Nothing unusual.
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:30   
       33       33              INPUT:        QI_1.
       34       34              OUTPUT:       Various stuff in QCD@DE_EDIT filled in.
       35       35              SCRATCH:      Various otter data.
       36       36              DESCRIPTION:  Aw, man.
       37       37                            I don't know where to start.
       38       38                            First, the CIP's MOP string (compiler-generated) is
       39       39                            reversed, then it's read through, and a sort of
       40       40                            "inverse" operation from what the CIP's DME instruction
       41       41                            would perform is, well, performed.
       42       42                            The edited input string, then, is more or less checked
       43       43                            to see if the DME instruction would have caused it as
       44       44                            result of being performed on some numeric data item.
       45       45                            In the process, that data item is "inferred" into
       46       46                            existence.
       47       47                            Face it, this thing's a monster.  If it ever breaks,
       48       48                            yer ass is in trouble.
       49       49                            The EPS-1 of the CIP instructions (Review E is the
       50       50                            latest as of this code being written) is invaluable.
       51       51        */
       52       52
       53       53          %INCLUDE LCP_6;
       54      244
       55      245          %INCLUDE QG_MACRO_M;
       56      382          %INCLUDE QI_EQUATES_E;
       57      741          %INCLUDE QI_MACROS_M;
       58     5799          %QI$ALL;
       59    16912
       60    16913          %EQU CHT  = BITBIN('0'X);
       61    16914          %EQU ENF  = BITBIN('1'X);
       62    16915          %EQU IGN  = BITBIN('2'X);
       63    16916          %EQU INSA = BITBIN('3'X);
       64    16917          %EQU INSB = BITBIN('4'X);
       65    16918          %EQU INSM = BITBIN('5'X);
       66    16919          %EQU INSN = BITBIN('6'X);
       67    16920          %EQU INSP = BITBIN('7'X);
       68    16921          %EQU MFLC = BITBIN('8'X);
       69    16922          %EQU MFLS = BITBIN('9'X);
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:31   
       70    16923          %EQU MVC  = BITBIN('C'X);
       71    16924          %EQU MVZA = BITBIN('D'X);
       72    16925          %EQU MVZB = BITBIN('E'X);
       73    16926          %EQU SEF  = BITBIN('F'X);
       74    16927
       75    16928          %SET LISTMAC = '1'B;
       76    16929
       77    16930          %INCLUDE QCD_DE_EDIT_M;
       78    16960          %QCD@DE_EDIT;
             16961            %BEGIN_MACRO ( STCLASS = STCLASS );
             16962            %SET LISTDIR = '0'B;
             16975    1     DCL 1 QCD@DE_EDIT ALIGNED,
             16976    1           2 IS_NUMBER_INVALID BIT(1) ALIGNED,
             16977                                           /* Set to 1 if the input is bad,
             16978                                                     0 otherwise.           */
             16979    1           2 RESULT ALIGNED,
             16980    1             3 DIGIT_A(0:30) UBIN BYTE UNAL,
             16981                                           /* The de-edited number, in the form:
             16982                                              UNPACKED((INDEX(RESULT),B7),0,31,LEADING) */
             16983    1             3 DEC SBIN,
             16984                                           /* Decimal position for DIGIT_A */
             16985    1             3 INPUT_SIZE SBIN;
             16986                                           /* Length of input minus
             16987                                              leading or trailing blanks */
             16994            %ENDIF;
       79    16997
       80    16998          %SET LISTMAC = '0'B;
       81    16999
       82    17000    1     DCL 1 EF,
       83    17001    1           2 ES BIT(1) UNAL,
       84    17002                                           /* ES = 1, end suppression must be on
       85    17003                                              ES = 0, unknown                    */
       86    17004    1           2 ES_OFF BIT(1) UNAL,
       87    17005                                           /* ES_OFF = 1, ES must be off */
       88    17006    1           2 SN BIT(1) UNAL,
       89    17007    1           2 SP BIT(1) UNAL,
       90    17008    1           2 BZ BIT(1) UNAL,
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:32   
       91    17009    1           2 AZ BIT(1) UNAL,
       92    17010    1           2 PM BIT(1) UNAL;
       93    17011
       94    17012    1     DCL EIT(0:8) UBIN BYTE;
       95    17013
       96    17014    1     DCL 1 MOP_ITEM_A(0:60),
       97    17015    1           2 OPERATION UBIN(4) UNAL,
       98    17016    1           2 INFORMATION_FIELD UBIN(4) UNAL,
       99    17017    1           2 INFORMATION_FIELD_FLAG_BITS REDEF INFORMATION_FIELD,
      100    17018    1             3 ES BIT(1) UNAL,
      101    17019    1             3 BZ BIT(1) UNAL,
      102    17020    1             3 AZ BIT(1) UNAL,
      103    17021    1             3 PM BIT(1) UNAL,
      104    17022    1             3 ES_WAS_SET_BEFORE_THIS_ENF REDEF PM BIT(1);
      105    17023    1     DCL MOP_A(0:60) REDEF MOP_ITEM_A UBIN BYTE UNAL;
      106    17024
      107    17025    1     DCL 1 MOP_ITEM ALIGNED,
      108    17026    1           2 OPERATION UBIN(4) UNAL,
      109    17027    1           2 INFORMATION_FIELD UBIN(4) UNAL,
      110    17028    1           2 INFORMATION_FIELD_FLAG_BITS REDEF INFORMATION_FIELD,
      111    17029    1             3 ES BIT(1) UNAL,
      112    17030    1             3 BZ BIT(1) UNAL,
      113    17031    1             3 AZ BIT(1) UNAL,
      114    17032    1             3 PM BIT(1) UNAL,
      115    17033    1             3 ES_WAS_SET_BEFORE_THIS_ENF REDEF PM BIT(1);
      116    17034    1     DCL MOP REDEF MOP_ITEM UBIN BYTE ALIGNED;
      117    17035
      118    17036          /* The next two items are usually the same as
      119    17037             MOP_ITEM.OPERATION and MOP_ITEM.INFORMATION_FIELD,
      120    17038             respectively, and are used so as to provide a more
      121    17039             efficient method of checking their values, especially
      122    17040             for the two DO CASE (OPERATION)s. */
      123    17041    1     DCL OPERATION UBIN;
      124    17042    1     DCL INFORMATION_FIELD SBIN;
      125    17043    1     DCL 1 INFORMATION_FIELD_FLAG_BITS REDEF INFORMATION_FIELD,
      126    17044    1           2 * BIT(12) UNAL,
      127    17045    1           2 ES BIT(1) UNAL,
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:33   
      128    17046    1           2 BZ BIT(1) UNAL,
      129    17047    1           2 AZ BIT(1) UNAL,
      130    17048    1           2 PM BIT(1) UNAL,
      131    17049    1           2 ES_WAS_SET_BEFORE_THIS_ENF REDEF PM BIT(1);
      132    17050
      133    17051    1     DCL CURRENT_SOURCE_INDEX SBIN;
      134    17052    1     DCL ENDING_SOURCE_INDEX SBIN;
      135    17053    1     DCL MOP_STRING_INDEX SBIN;
      136    17054    1     DCL NEW_MOP_STRING_INDEX SBIN;
      137    17055    1     DCL PIC$ PTR;
      138    17056    1     DCL RESULT_INDEX SBIN;
      139    17057    1     DCL SAVE_ES_FLAG BIT(1) ALIGNED;
      140    17058    1     DCL SOURCE_CHARACTER_TO_MATCH UBIN BYTE ALIGNED;
      141    17059    1     DCL STARTING_SOURCE_INDEX SBIN;
      142    17060    1     DCL TEMP_SOURCE_INDEX SBIN;
      143    17061    1     DCL WEVE_ENCOUNTERED_A_DECIMAL BIT(1) ALIGNED;
      144    17062        %EJECT;
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:34   
      145    17063    1       PIC$ = QI_1.PICTURE_STRING_A$ ( %QI#DE_EDIT );

  17063   0 000005  EC80 0000 004E  xsym                 LDB,B6   QI_1+78
          0 000008  EFC7 0036                            STB,B6   PIC$,AUTO

      146    17064
      147    17065    1       EF = '0'B;

  17065   0 00000A  8747 0006                            CL       EF,AUTO

      148    17066    1       MOP_ITEM_A = '0'B;

  17066   0 00000C  5C3D                                 LDV,R5   61
          0 00000D  0021                                 ALR      ;
          0 00000E       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          0 000010       4007 0010                                ALPHANUM(MOP_ITEM_A,AUTO,,R5,FILL)

      149    17067    1       CURRENT_SOURCE_INDEX = 0;

  17067   0 000012  437F                                 CSYNC    s:17066+5,SPREL
          0 000013  8747 0032                            CL       CURRENT_SOURCE_INDEX,AUTO

      150    17068    1       STARTING_SOURCE_INDEX = 0;

  17068   0 000015  8747 003B                            CL       STARTING_SOURCE_INDEX,AUTO

      151    17069
      152    17070    1       QCD@DE_EDIT = '0'B;

  17070   0 000017  DCC7 0004                            LDB,B5   @QCD@DE_EDIT,AUTO
          0 000019  5C26                                 LDV,R5   38
          0 00001A  0021                                 ALR      ;
          0 00001B       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          0 00001D       4005 0000                                ALPHANUM(0,B5,,R5,FILL)

      153    17071
      154    17072    1       EIT(1) = %ASCBIN(' ');
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:35   

  17072   0 00001F  6C20                                 LDV,R6   32
          0 000020  437F                                 CSYNC    s:17072,SPREL
          0 000021  E7C7 0008                            STH,R6   EIT+1,AUTO

      155    17073    1       EIT(2) = %ASCBIN('*');

  17073   0 000023  4C2A                                 LDV,R4   42
          0 000024  C7C7 0009                            STH,R4   EIT+2,AUTO

      156    17074    1       EIT(3) = %ASCBIN('+');

  17074   0 000026  3C2B                                 LDV,R3   43
          0 000027  B7C7 000A                            STH,R3   EIT+3,AUTO

      157    17075    1       EIT(4) = %ASCBIN('-');

  17075   0 000029  2C2D                                 LDV,R2   45
          0 00002A  A7C7 000B                            STH,R2   EIT+4,AUTO

      158    17076    1       EIT(5) = %ASCBIN('$');

  17076   0 00002C  1C24                                 LDV,R1   36
          0 00002D  97C7 000C                            STH,R1   EIT+5,AUTO

      159    17077    1       EIT(6) = %ASCBIN(',');

  17077   0 00002F  6C2C                                 LDV,R6   44
          0 000030  E7C7 000D                            STH,R6   EIT+6,AUTO

      160    17078    1       EIT(7) = %ASCBIN('.');

  17078   0 000032  6C2E                                 LDV,R6   46
          0 000033  E7C7 000E                            STH,R6   EIT+7,AUTO

      161    17079    1       EIT(8) = %ASCBIN('0');

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:36   
  17079   0 000035  6C30                                 LDV,R6   48
          0 000036  E7C7 000F                            STH,R6   EIT+8,AUTO

      162    17080
      163    17081    2       DO RESULT_INDEX = 1 TO 30;

  17081   0 000038  6C01                                 LDV,R6   1
          0 000039  EF47 0038                            STR,R6   RESULT_INDEX,AUTO

      164    17082    2         QCD@DE_EDIT.RESULT.DIGIT_A (RESULT_INDEX) = %ASCBIN('0');

  17082   0 00003B  6C30                                 LDV,R6   48
          0 00003C  ECC7 0004                            LDB,B6   @QCD@DE_EDIT,AUTO
          0 00003E  B847 0038                            LDR,R3   RESULT_INDEX,AUTO
          0 000040  3E02                                 ADV,R3   2
          0 000041  E7B6                                 STH,R6   ,B6,R3

      165    17083    2       END;

  17083   0 000042  8AC7 0038                            INC      RESULT_INDEX,AUTO
          0 000044  D847 0038                            LDR,R5   RESULT_INDEX,AUTO
          0 000046  5D1E                                 CMV,R5   30
          0 000047  0AF4                                 BALE     s:17082,SPREL

      166    17084
      167    17085    1       RESULT_INDEX = 30;

  17085   0 000048  5C1E                                 LDV,R5   30
          0 000049  DF47 0038                            STR,R5   RESULT_INDEX,AUTO

      168    17086
      169    17087    1       QCD@DE_EDIT.RESULT.DIGIT_A (0) = %ASCBIN('+');

  17087   0 00004B  4C2B                                 LDV,R4   43
          0 00004C  C7C6 0001                            STH,R4   1,B6

      170    17088
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:37   
      171    17089    1       QCD@DE_EDIT.RESULT.DEC = PIC$ -> QI$NUMERIC_PICTURE_STRING.DECIMAL_SCALING;

  17089   0 00004E  DCC7 0036                            LDB,B5   PIC$,AUTO
          0 000050  B805                                 LDR,R3   ,B5
          0 000051  B570 003F                            AND,R3   63,IMO
          0 000053  BF46 0011                            STR,R3   17,B6

      172    17090        %EJECT;
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:38   
      173    17091            /* Reverse the CIP MOP string */
      174    17092    1       NEW_MOP_STRING_INDEX = 0;

  17092   0 000055  8747 0035                            CL       NEW_MOP_STRING_INDEX,AUTO

      175    17093
      176    17094    2       DO MOP_STRING_INDEX = 0 TO PIC$ -> QI$NUMERIC_PICTURE_STRING.MOP_STRING_COUNT -
             17094                1;

  17094   0 000057  8747 0034                            CL       MOP_STRING_INDEX,AUTO
          0 000059  0F81 00DB                            B        s:17181+2,PREL

      177    17095
      178    17096    2         MOP = PIC$ -> QI$NUMERIC_PICTURE_STRING.MOP_STRING_A (MOP_STRING_INDEX);

  17096   0 00005B  ECC7 0036                            LDB,B6   PIC$,AUTO
          0 00005D  B847 0034                            LDR,R3   MOP_STRING_INDEX,AUTO
          0 00005F  3E03                                 ADV,R3   3
          0 000060  E2B6                                 LLH,R6   ,B6,R3
          0 000061  E7C7 002F                            STH,R6   MOP_ITEM,AUTO

      179    17097    2         OPERATION = MOP_ITEM.OPERATION;

  17097   0 000063  D847 002F                            LDR,R5   MOP_ITEM,AUTO
          0 000065  504C                                 SOR,R5   12
          0 000066  DF47 0030                            STR,R5   OPERATION,AUTO

      180    17098    2         INFORMATION_FIELD = MOP_ITEM.INFORMATION_FIELD;

  17098   0 000068  C847 002F                            LDR,R4   MOP_ITEM,AUTO
          0 00006A  4048                                 SOR,R4   8
          0 00006B  C570 000F                            AND,R4   15,IMO
          0 00006D  CF47 0031                            STR,R4   INFORMATION_FIELD,AUTO

      181    17099
      182    17100    3         DO CASE ( OPERATION );

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:39   
  17100   0 00006F  A855                                 LDR,R2   R5
          0 000070  2D10                                 CMV,R2   16
          0 000071  0281 00BF                            BGE      s:17177,PREL
          0 000073  9820 0000 0079  00                   LDR,R1   s:17100+10,R2
          0 000076  8390 0000 0089  00                   JMP      s:17103,R1
          0 000079       003F                            DC       s:17126,PREL
          0 00007A       0082                            DC       s:17158,PREL
          0 00007B       00A8                            DC       s:17177,PREL
          0 00007C       005A                            DC       s:17138,PREL
          0 00007D       005A                            DC       s:17138,PREL
          0 00007E       007A                            DC       s:17154,PREL
          0 00007F       005A                            DC       s:17138,PREL
          0 000080       005A                            DC       s:17138,PREL
          0 000081       00A0                            DC       s:17173,PREL
          0 000082       00A0                            DC       s:17173,PREL
          0 000083       00A8                            DC       s:17177,PREL
          0 000084       00A8                            DC       s:17177,PREL
          0 000085       00A0                            DC       s:17173,PREL
          0 000086       00A0                            DC       s:17173,PREL
          0 000087       00A0                            DC       s:17173,PREL
          0 000088       0000                            DC       s:17103,PREL

      183    17101
      184    17102    3           CASE ( %SEF );

      185    17103    3             IF INFORMATION_FIELD_FLAG_BITS.PM

  17103   0 000089  82C7 0031                            LB,'0001'X        INFORMATION_FIELD,AUTO
  17103   0 00008B       0001
          0 00008C  0581 0004                            BBF      s:17106,PREL

      186    17104    3             THEN
      187    17105    3               EF.PM = %SET;

  17105   0 00008E  8947 0006                            LBT,'0200'X       EF,AUTO
  17105   0 000090       0200

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:40   
      188    17106    3             IF INFORMATION_FIELD_FLAG_BITS.AZ

  17106   0 000091  82C7 0031                            LB,'0002'X        INFORMATION_FIELD,AUTO
  17106   0 000093       0002
          0 000094  0581 0004                            BBF      s:17109,PREL

      189    17107    3             THEN
      190    17108    3               EF.AZ = %SET;

  17108   0 000096  8947 0006                            LBT,'0400'X       EF,AUTO
  17108   0 000098       0400

      191    17109    3             IF INFORMATION_FIELD_FLAG_BITS.BZ

  17109   0 000099  82C7 0031                            LB,'0004'X        INFORMATION_FIELD,AUTO
  17109   0 00009B       0004
          0 00009C  0581 0004                            BBF      s:17112,PREL

      192    17110    3             THEN
      193    17111    3               EF.BZ = %SET;

  17111   0 00009E  8947 0006                            LBT,'0800'X       EF,AUTO
  17111   0 0000A0       0800

      194    17112    3             SAVE_ES_FLAG = INFORMATION_FIELD_FLAG_BITS.ES;

  17112   0 0000A1  E847 0031                            LDR,R6   INFORMATION_FIELD,AUTO
          0 0000A3  600C                                 SOL,R6   12
          0 0000A4  E570 8000                            AND,R6   -32768,IMO
          0 0000A6  EF47 0039                            STR,R6   SAVE_ES_FLAG,AUTO

      195    17113    3             MOP_ITEM.INFORMATION_FIELD_FLAG_BITS.ES = %RESET;

  17113   0 0000A8  8847 002F                            LBF,'0800'X       MOP_ITEM,AUTO
  17113   0 0000AA       0800

      196    17114    3             IF EF.ES
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:41   

  17114   0 0000AB  89C7 0006                            CMZ      EF,AUTO
          0 0000AD  0881 0004                            BAGE     s:17117,PREL

      197    17115    3             THEN
      198    17116    3               MOP_ITEM.INFORMATION_FIELD_FLAG_BITS.ES = %SET;

  17116   0 0000AF  8947 002F                            LBT,'0800'X       MOP_ITEM,AUTO
  17116   0 0000B1       0800

      199    17117    3             IF SAVE_ES_FLAG

  17117   0 0000B2  89C7 0039                            CMZ      SAVE_ES_FLAG,AUTO
          0 0000B4  0881 0006                            BAGE     s:17121,PREL

      200    17118    3             THEN
      201    17119    3               EF.ES = %SET;

  17119   0 0000B6  8947 0006                            LBT,'8000'X       EF,AUTO
  17119   0 0000B8       8000
          0 0000B9  0F81 0004                            B        s:17122,PREL

      202    17120    3             ELSE
      203    17121    3               EF.ES = %RESET;

  17121   0 0000BB  8847 0006                            LBF,'8000'X       EF,AUTO
  17121   0 0000BD       8000

      204    17122    3             MOP_A (NEW_MOP_STRING_INDEX) = MOP;

  17122   0 0000BE  E2C7 002F                            LLH,R6   MOP_ITEM,AUTO
          0 0000C0  B847 0035                            LDR,R3   NEW_MOP_STRING_INDEX,AUTO
          0 0000C2  3E20                                 ADV,R3   32
          0 0000C3  E7B7                                 STH,R6   ,AUTO,R3

      205    17123    3             NEW_MOP_STRING_INDEX = NEW_MOP_STRING_INDEX + 1;

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:42   
  17123   0 0000C4  8AC7 0035                            INC      NEW_MOP_STRING_INDEX,AUTO
          0 0000C6  0F81 006C                            B        s:17181,PREL

      206    17124
      207    17125    3           CASE ( %CHT );

      208    17126    3             MOP_STRING_INDEX = MOP_STRING_INDEX + 1;

  17126   0 0000C8  8AC7 0034                            INC      MOP_STRING_INDEX,AUTO

      209    17127    3             OPERATION = PIC$ -> QI$NUMERIC_PICTURE_STRING.MOP_STRING_A (
             17127                      MOP_STRING_INDEX);

  17127   0 0000CA  B847 0034                            LDR,R3   MOP_STRING_INDEX,AUTO
          0 0000CC  3E03                                 ADV,R3   3
          0 0000CD  A2B6                                 LLH,R2   ,B6,R3
          0 0000CE  AF47 0030                            STR,R2   OPERATION,AUTO

      210    17128    3             MOP_A (NEW_MOP_STRING_INDEX) = EIT(INFORMATION_FIELD);

  17128   0 0000D0  9854                                 LDR,R1   R4
          0 0000D1  1001                                 SOL,R1   1
          0 0000D2  1E0E                                 ADV,R1   14
          0 0000D3  E297                                 LLH,R6   ,AUTO,R1
          0 0000D4  B847 0035                            LDR,R3   NEW_MOP_STRING_INDEX,AUTO
          0 0000D6  3E20                                 ADV,R3   32
          0 0000D7  E7B7                                 STH,R6   ,AUTO,R3

      211    17129    3             NEW_MOP_STRING_INDEX = NEW_MOP_STRING_INDEX + 1;

  17129   0 0000D8  8AC7 0035                            INC      NEW_MOP_STRING_INDEX,AUTO

      212    17130    3             EIT(INFORMATION_FIELD) = OPERATION;

  17130   0 0000DA  A797                                 STH,R2   ,AUTO,R1

      213    17131    3             MOP_A (NEW_MOP_STRING_INDEX) = INFORMATION_FIELD;
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:43   

  17131   0 0000DB  B847 0035                            LDR,R3   NEW_MOP_STRING_INDEX,AUTO
          0 0000DD  3E20                                 ADV,R3   32
          0 0000DE  C7B7                                 STH,R4   ,AUTO,R3

      214    17132    3             NEW_MOP_STRING_INDEX = NEW_MOP_STRING_INDEX + 1;

  17132   0 0000DF  8AC7 0035                            INC      NEW_MOP_STRING_INDEX,AUTO
          0 0000E1  0F81 0051                            B        s:17181,PREL

      215    17133
      216    17134    3           CASE ( %INSA,

      217    17135    3               %INSB,
      218    17136    3               %INSN,
      219    17137    3               %INSP );
      220    17138    3             IF INFORMATION_FIELD = 0

  17138   0 0000E3  4981 0017                            BNEZ,R4  s:17149,PREL

      221    17139    3             THEN
      222    17140    4               DO;

      223    17141    4                 MOP_STRING_INDEX = MOP_STRING_INDEX + 1;

  17141   0 0000E5  8AC7 0034                            INC      MOP_STRING_INDEX,AUTO

      224    17142    4                 MOP_A (NEW_MOP_STRING_INDEX) = PIC$ -> QI$NUMERIC_PICTURE_STRING.
             17142                          MOP_STRING_A (MOP_STRING_INDEX);

  17142   0 0000E7  B847 0034                            LDR,R3   MOP_STRING_INDEX,AUTO
          0 0000E9  3E03                                 ADV,R3   3
          0 0000EA  E2B6                                 LLH,R6   ,B6,R3
          0 0000EB  B847 0035                            LDR,R3   NEW_MOP_STRING_INDEX,AUTO
          0 0000ED  3E20                                 ADV,R3   32
          0 0000EE  E7B7                                 STH,R6   ,AUTO,R3

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:44   
      225    17143    4                 NEW_MOP_STRING_INDEX = NEW_MOP_STRING_INDEX + 1;

  17143   0 0000EF  8AC7 0035                            INC      NEW_MOP_STRING_INDEX,AUTO

      226    17144    4                 MOP_A (NEW_MOP_STRING_INDEX) = MOP;

  17144   0 0000F1  E2C7 002F                            LLH,R6   MOP_ITEM,AUTO
          0 0000F3  B847 0035                            LDR,R3   NEW_MOP_STRING_INDEX,AUTO
          0 0000F5  3E20                                 ADV,R3   32
          0 0000F6  E7B7                                 STH,R6   ,AUTO,R3

      227    17145    4                 NEW_MOP_STRING_INDEX = NEW_MOP_STRING_INDEX + 1;

  17145   0 0000F7  8AC7 0035                            INC      NEW_MOP_STRING_INDEX,AUTO

      228    17146    4               END;

  17146   0 0000F9  0F81 0039                            B        s:17181,PREL

      229    17147    3             ELSE
      230    17148    4               DO;

      231    17149    4                 MOP_A (NEW_MOP_STRING_INDEX) = PIC$ -> QI$NUMERIC_PICTURE_STRING.
             17149                          MOP_STRING_A (MOP_STRING_INDEX);

  17149   0 0000FB  B847 0035                            LDR,R3   NEW_MOP_STRING_INDEX,AUTO
          0 0000FD  3E20                                 ADV,R3   32
          0 0000FE  E7B7                                 STH,R6   ,AUTO,R3

      232    17150    4                 NEW_MOP_STRING_INDEX = NEW_MOP_STRING_INDEX + 1;

  17150   0 0000FF  8AC7 0035                            INC      NEW_MOP_STRING_INDEX,AUTO

      233    17151    4               END;

  17151   0 000101  0F81 0031                            B        s:17181,PREL

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:45   
      234    17152
      235    17153    3           CASE ( %INSM );

      236    17154    3             MOP_A (NEW_MOP_STRING_INDEX) = PIC$ -> QI$NUMERIC_PICTURE_STRING.
             17154                      MOP_STRING_A (MOP_STRING_INDEX);

  17154   0 000103  B847 0035                            LDR,R3   NEW_MOP_STRING_INDEX,AUTO
          0 000105  3E20                                 ADV,R3   32
          0 000106  E7B7                                 STH,R6   ,AUTO,R3

      237    17155    3             NEW_MOP_STRING_INDEX = NEW_MOP_STRING_INDEX + 1;

  17155   0 000107  8AC7 0035                            INC      NEW_MOP_STRING_INDEX,AUTO
          0 000109  0F81 0029                            B        s:17181,PREL

      238    17156
      239    17157    3           CASE ( %ENF );

      240    17158    3             MOP_A (NEW_MOP_STRING_INDEX) = PIC$ -> QI$NUMERIC_PICTURE_STRING.
             17158                      MOP_STRING_A (MOP_STRING_INDEX);

  17158   0 00010B  B847 0035                            LDR,R3   NEW_MOP_STRING_INDEX,AUTO
          0 00010D  3E20                                 ADV,R3   32
          0 00010E  E7B7                                 STH,R6   ,AUTO,R3

      241    17159    3             IF EF.ES                          /* Remember ES flag */

  17159   0 00010F  89C7 0006                            CMZ      EF,AUTO
          0 000111  0881 0008                            BAGE     s:17162,PREL

      242    17160    3             THEN
      243    17161    3               MOP_ITEM_A.INFORMATION_FIELD_FLAG_BITS.ES_WAS_SET_BEFORE_THIS_ENF (
             17161                        NEW_MOP_STRING_INDEX) = %SET;

  17161   0 000113  DBC7 0010                            LAB,B5   MOP_ITEM_A,AUTO
          0 000115  B847 0035                            LDR,R3   NEW_MOP_STRING_INDEX,AUTO
          0 000117  3003                                 SOL,R3   3
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:46   
          0 000118  3E07                                 ADV,R3   7
          0 000119  8935                                 LBT      ,B5,R3

      244    17162    3             NEW_MOP_STRING_INDEX = NEW_MOP_STRING_INDEX + 1;

  17162   0 00011A  8AC7 0035                            INC      NEW_MOP_STRING_INDEX,AUTO

      245    17163    3             EF.ES = %SET;

  17163   0 00011C  8947 0006                            LBT,'8000'X       EF,AUTO
  17163   0 00011E       8000

      246    17164    3             IF INFORMATION_FIELD_FLAG_BITS.BZ

  17164   0 00011F  82C7 0031                            LB,'0004'X        INFORMATION_FIELD,AUTO
  17164   0 000121       0004
          0 000122  0581 0010                            BBF      s:17181,PREL

      247    17165    3             THEN
      248    17166    3               EF.BZ = %SET;

  17166   0 000124  8947 0006                            LBT,'0800'X       EF,AUTO
  17166   0 000126       0800
          0 000127  0F81 000B                            B        s:17181,PREL

      249    17167
      250    17168    3           CASE ( %MFLC,

      251    17169    3                 %MFLS,
      252    17170    3                 %MVC,
      253    17171    3                 %MVZA,
      254    17172    3                 %MVZB );
      255    17173    3             MOP_A (NEW_MOP_STRING_INDEX) = PIC$ -> QI$NUMERIC_PICTURE_STRING.
             17173                      MOP_STRING_A (MOP_STRING_INDEX);

  17173   0 000129  B847 0035                            LDR,R3   NEW_MOP_STRING_INDEX,AUTO
          0 00012B  3E20                                 ADV,R3   32
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:47   
          0 00012C  E7B7                                 STH,R6   ,AUTO,R3

      256    17174    3             NEW_MOP_STRING_INDEX = NEW_MOP_STRING_INDEX + 1;

  17174   0 00012D  8AC7 0035                            INC      NEW_MOP_STRING_INDEX,AUTO
          0 00012F  0F81 0003                            B        s:17181,PREL

      257    17175
      258    17176    3           CASE ( ELSE );

      259    17177    3             GOTO ABORT;

  17177   0 000131  0F81 04AB                            B        s:17762,PREL

      260    17178
      261    17179    3         END; /* DO CASE ( OPERATION ) */

      262    17180
      263    17181    2       END; /* DO MOP_STRING_INDEX = ... */

  17181   0 000133  8AC7 0034                            INC      MOP_STRING_INDEX,AUTO
          0 000135  ECC7 0036                            LDB,B6   PIC$,AUTO
          0 000137  E2C6 0001                            LLH,R6   1,B6
          0 000139  E947 0034                            CMR,R6   MOP_STRING_INDEX,AUTO
          0 00013B  0A01 FF1F                            BAG      s:17096,PREL

      264    17182        %EJECT;
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:48   
      265    17183            /* MOP string is now set up to read backwards */
      266    17184    1       NEW_MOP_STRING_INDEX = NEW_MOP_STRING_INDEX - 1;

  17184   0 00013D  88C7 0035                            DEC      NEW_MOP_STRING_INDEX,AUTO

      267    17185
      268    17186            /* We'll just index past the trailing blanks... */
      269    17187    1       CURRENT_SOURCE_INDEX = QI_1.OP.LEN_A (%QI#DE_EDIT)

  17187   0 00013F  D800 0000 0028  xsym                 LDR,R5   QI_1+40
          0 000142  DA00 0000 0043  xsym                 ADD,R5   QI_1+67
          0 000145  5EFF                                 ADV,R5   -1
          0 000146  DF47 0032                            STR,R5   CURRENT_SOURCE_INDEX,AUTO

      270    17188    1         + QI_1.OFFSET_A (%QI#DE_EDIT)
      271    17189    1         - 1;
      272    17190
      273    17191    2       DO WHILE ( CURRENT_SOURCE_INDEX >= QI_1.OFFSET_A (%QI#DE_EDIT)

  17191   0 000148  0F81 0003                            B        s:17194,PREL

      274    17192    2         AND ( QI_1.OP.DATA_A$ (%QI#DE_EDIT) -> QI$UBYTE_A (CURRENT_SOURCE_INDEX) = %
             17192                  ASCBIN(' ') ) );
      275    17193    2         CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;

  17193   0 00014A  88C7 0032                            DEC      CURRENT_SOURCE_INDEX,AUTO

      276    17194    2       END;

  17194   0 00014C  E847 0032                            LDR,R6   CURRENT_SOURCE_INDEX,AUTO
          0 00014E  6801 000D                            BLZ,R6   s:17196,PREL
          0 000150  E900 0000 0043  xsym                 CMR,R6   QI_1+67
          0 000153  0201 0008                            BL       s:17196,PREL
          0 000155  EC80 0000 0024  xsym                 LDB,B6   QI_1+36
          0 000158  B856                                 LDR,R3   R6
          0 000159  D2B6                                 LLH,R5   ,B6,R3
          0 00015A  5D20                                 CMV,R5   32
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:49   
          0 00015B  096F                                 BE       s:17193,SPREL

      277    17195
      278    17196    1       STARTING_SOURCE_INDEX = CURRENT_SOURCE_INDEX;

  17196   0 00015C  EF47 003B                            STR,R6   STARTING_SOURCE_INDEX,AUTO

      279    17197
      280    17198            /* ...and check for all blanks, legal only if EF:BZ is set... */
      281    17199    1       IF STARTING_SOURCE_INDEX < QI_1.OFFSET_A (%QI#DE_EDIT)

  17199   0 00015E  6801 0006                            BLZ,R6   s:17202,PREL
          0 000160  E900 0000 0043  xsym                 CMR,R6   QI_1+67
          0 000163  0281 000C                            BGE      s:17211,PREL

      282    17200    1       THEN
      283    17201    2         DO;

      284    17202    2           QCD@DE_EDIT.RESULT.INPUT_SIZE = 0;

  17202   0 000165  ECC7 0004                            LDB,B6   @QCD@DE_EDIT,AUTO
          0 000167  8746 0012                            CL       18,B6

      285    17203    2           IF EF.BZ

  17203   0 000169  82C7 0006                            LB,'0800'X        EF,AUTO
  17203   0 00016B       0800
          0 00016C  0501 046D                            BBT      s:17758,PREL

      286    17204    2           THEN
      287    17205    2             GOTO SUCCEED;
      288    17206    2           ELSE
      289    17207    2             GOTO ABORT;

  17207   0 00016E  0F81 046E                            B        s:17762,PREL

      290    17208    2         END;
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:50   
      291    17209
      292    17210            /* ...and maybe index past the leading blanks, too. */
      293    17211    1       ENDING_SOURCE_INDEX = QI_1.OFFSET_A (%QI#DE_EDIT);

  17211   0 000170  D800 0000 0043  xsym                 LDR,R5   QI_1+67
          0 000173  DF47 0033                            STR,R5   ENDING_SOURCE_INDEX,AUTO

      294    17212
      295    17213    2       DO WHILE ( ( ENDING_SOURCE_INDEX < STARTING_SOURCE_INDEX )

  17213   0 000175  0F81 0003                            B        s:17216,PREL

      296    17214    2         AND ( QI_1.OP.DATA_A$ (%QI#DE_EDIT) -> QI$UBYTE_A (ENDING_SOURCE_INDEX) = %
             17214                  ASCBIN(' ') ) );
      297    17215    2         ENDING_SOURCE_INDEX = ENDING_SOURCE_INDEX + 1;

  17215   0 000177  8AC7 0033                            INC      ENDING_SOURCE_INDEX,AUTO

      298    17216    2       END;

  17216   0 000179  E847 0033                            LDR,R6   ENDING_SOURCE_INDEX,AUTO
          0 00017B  E947 003B                            CMR,R6   STARTING_SOURCE_INDEX,AUTO
          0 00017D  0881 0008                            BAGE     s:17218,PREL
          0 00017F  EC80 0000 0024  xsym                 LDB,B6   QI_1+36
          0 000182  B856                                 LDR,R3   R6
          0 000183  D2B6                                 LLH,R5   ,B6,R3
          0 000184  5D20                                 CMV,R5   32
          0 000185  0972                                 BE       s:17215,SPREL

      299    17217
      300    17218    1      QCD@DE_EDIT.RESULT.INPUT_SIZE = STARTING_SOURCE_INDEX - ENDING_SOURCE_INDEX + 1;

  17218   0 000186  E247 003B                            SUB,R6   STARTING_SOURCE_INDEX,AUTO
          0 000188  ECC7 0004                            LDB,B6   @QCD@DE_EDIT,AUTO
          0 00018A  8256                                 NEG      R6
          0 00018B  6E01                                 ADV,R6   1
          0 00018C  EF46 0012                            STR,R6   18,B6
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:51   

      301    17219
      302    17220            /* Check for "asterisk-when-zero"... */
      303    17221    1       IF EF.AZ

  17221   0 00018E  82C7 0006                            LB,'0400'X        EF,AUTO
  17221   0 000190       0400
          0 000191  0581 0035                            BBF      s:17252,PREL

      304    17222    1       THEN
      305    17223    2         DO;

      306    17224    2           TEMP_SOURCE_INDEX = STARTING_SOURCE_INDEX;

  17224   0 000193  D847 003B                            LDR,R5   STARTING_SOURCE_INDEX,AUTO
          0 000195  DF47 003C                            STR,R5   TEMP_SOURCE_INDEX,AUTO

      307    17225    2           WEVE_ENCOUNTERED_A_DECIMAL = %NO;

  17225   0 000197  8747 003D                            CL       WEVE_ENCOUNTERED_A_DECIMAL,AUTO

      308    17226    3           DO WHILE ( TEMP_SOURCE_INDEX >= ENDING_SOURCE_INDEX );

  17226   0 000199  D947 0033                            CMR,R5   ENDING_SOURCE_INDEX,AUTO
          0 00019B  0801 0029                            BAL      s:17246,PREL

      309    17227    3             SOURCE_CHARACTER_TO_MATCH = QI_1.OP.DATA_A$ (%QI#DE_EDIT) -> QI$UBYTE_A (
             17227                      TEMP_SOURCE_INDEX);

  17227   0 00019D  EC80 0000 0024  xsym                 LDB,B6   QI_1+36
          0 0001A0  B847 003C                            LDR,R3   TEMP_SOURCE_INDEX,AUTO
          0 0001A2  E2B6                                 LLH,R6   ,B6,R3
          0 0001A3  E7C7 003A                            STH,R6   SOURCE_CHARACTER_TO_MATCH,AUTO

      310    17228    3             IF SOURCE_CHARACTER_TO_MATCH = EIT (2)  /* '*' */

  17228   0 0001A5  D2C7 003A                            LLH,R5   SOURCE_CHARACTER_TO_MATCH,AUTO
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:52   
          0 0001A7  C2C7 0009                            LLH,R4   EIT+2,AUTO
          0 0001A9  D954                                 CMR,R5   R4
          0 0001AA  0981 0005                            BNE      s:17233,PREL

      311    17229    3             THEN
      312    17230    3               TEMP_SOURCE_INDEX = TEMP_SOURCE_INDEX - 1;

  17230   0 0001AC  88C7 003C                            DEC      TEMP_SOURCE_INDEX,AUTO
          0 0001AE  0F81 0011                            B        s:17245,PREL

      313    17231    3             ELSE
      314    17232    4               DO;

      315    17233    4                 IF SOURCE_CHARACTER_TO_MATCH = EIT (7)  /* '.' */

  17233   0 0001B0  A2C7 000E                            LLH,R2   EIT+7,AUTO
          0 0001B2  D952                                 CMR,R5   R2
          0 0001B3  0981 0013                            BNE      s:17252,PREL

      316    17234    4                 THEN
      317    17235    5                   DO;

      318    17236    5                     IF WEVE_ENCOUNTERED_A_DECIMAL = %YES

  17236   0 0001B5  89C7 003D                            CMZ      WEVE_ENCOUNTERED_A_DECIMAL,AUTO
          0 0001B7  0801 000F                            BAL      s:17252,PREL

      319    17237    5                     THEN
      320    17238    5                       GOTO NOT_AZ;
      321    17239    5                     WEVE_ENCOUNTERED_A_DECIMAL = %YES;

  17239   0 0001B9  8947 003D                            LBT,'8000'X       WEVE_ENCOUNTERED_A_DECIMAL,AUTO
  17239   0 0001BB       8000

      322    17240    5                     TEMP_SOURCE_INDEX = TEMP_SOURCE_INDEX - 1;

  17240   0 0001BC  88C7 003C                            DEC      TEMP_SOURCE_INDEX,AUTO
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:53   

      323    17241    5                   END;

  17241   0 0001BE  0F81 0001                            B        s:17245,PREL

      324    17242    4                 ELSE
      325    17243    4                   GOTO NOT_AZ;
      326    17244    4               END;
      327    17245    3           END;

  17245   0 0001C0  E847 003C                            LDR,R6   TEMP_SOURCE_INDEX,AUTO
          0 0001C2  E947 0033                            CMR,R6   ENDING_SOURCE_INDEX,AUTO
          0 0001C4  08D9                                 BAGE     s:17227,SPREL

      328    17246    2           GOTO SUCCEED;

  17246   0 0001C5  0F81 0414                            B        s:17758,PREL

      329    17247    2         END;
      330    17248        %EJECT;
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:54   
      331    17249    1   NOT_AZ:
      332    17250            /* Main loop:  reads backwards through the MOP string
      333    17251                           trying to match characters from the input string... */
      334    17252    2       DO WHILE ( NEW_MOP_STRING_INDEX >= 0 );

  17252   0 0001C7  E847 0035            NOT_AZ          LDR,R6   NEW_MOP_STRING_INDEX,AUTO
          0 0001C9  6801 03FC                            BLZ,R6   s:17748,PREL

      335    17253
      336    17254    2         MOP = MOP_A (NEW_MOP_STRING_INDEX);

  17254   0 0001CB  B847 0035                            LDR,R3   NEW_MOP_STRING_INDEX,AUTO
          0 0001CD  3E20                                 ADV,R3   32
          0 0001CE  E2B7                                 LLH,R6   ,AUTO,R3
          0 0001CF  E7C7 002F                            STH,R6   MOP_ITEM,AUTO

      337    17255    2         NEW_MOP_STRING_INDEX = NEW_MOP_STRING_INDEX - 1;

  17255   0 0001D1  88C7 0035                            DEC      NEW_MOP_STRING_INDEX,AUTO

      338    17256    2         OPERATION = MOP_ITEM.OPERATION;

  17256   0 0001D3  E847 002F                            LDR,R6   MOP_ITEM,AUTO
          0 0001D5  604C                                 SOR,R6   12
          0 0001D6  EF47 0030                            STR,R6   OPERATION,AUTO

      339    17257    2         INFORMATION_FIELD = MOP_ITEM.INFORMATION_FIELD;

  17257   0 0001D8  D847 002F                            LDR,R5   MOP_ITEM,AUTO
          0 0001DA  5048                                 SOR,R5   8
          0 0001DB  D570 000F                            AND,R5   15,IMO
          0 0001DD  DF47 0031                            STR,R5   INFORMATION_FIELD,AUTO

      340    17258
      341    17259              /* Process some common features (bugs?) */
      342    17260    2         IF (OPERATION = %INSA)

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:55   
  17260   0 0001DF  6D03                                 CMV,R6   3
          0 0001E0  0901 000A                            BE       s:17267,PREL
          0 0001E2  6D04                                 CMV,R6   4
          0 0001E3  0901 0007                            BE       s:17267,PREL
          0 0001E5  6D06                                 CMV,R6   6
          0 0001E6  0901 0004                            BE       s:17267,PREL
          0 0001E8  6D07                                 CMV,R6   7
          0 0001E9  0981 0027                            BNE      s:17285,PREL

      343    17261    2           OR (OPERATION = %INSB)
      344    17262    2           OR (OPERATION = %INSN)
      345    17263    2           OR (OPERATION = %INSP)
      346    17264    2         THEN
      347    17265
      348    17266    3           DO;

      349    17267    3             IF INFORMATION_FIELD = 0

  17267   0 0001EB  5981 000B                            BNEZ,R5  s:17274,PREL

      350    17268    3             THEN
      351    17269    4               DO;

      352    17270    4                 INFORMATION_FIELD = MOP_A (NEW_MOP_STRING_INDEX);

  17270   0 0001ED  B847 0035                            LDR,R3   NEW_MOP_STRING_INDEX,AUTO
          0 0001EF  3E20                                 ADV,R3   32
          0 0001F0  D2B7                                 LLH,R5   ,AUTO,R3
          0 0001F1  DF47 0031                            STR,R5   INFORMATION_FIELD,AUTO

      353    17271    4                 NEW_MOP_STRING_INDEX = NEW_MOP_STRING_INDEX - 1;

  17271   0 0001F3  88C7 0035                            DEC      NEW_MOP_STRING_INDEX,AUTO

      354    17272    4               END;

  17272   0 0001F5  0F81 0007                            B        s:17276,PREL
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:56   

      355    17273    3             ELSE
      356    17274    3               INFORMATION_FIELD = EIT (INFORMATION_FIELD);

  17274   0 0001F7  B855                                 LDR,R3   R5
          0 0001F8  3001                                 SOL,R3   1
          0 0001F9  3E0E                                 ADV,R3   14
          0 0001FA  D2B7                                 LLH,R5   ,AUTO,R3
          0 0001FB  DF47 0031                            STR,R5   INFORMATION_FIELD,AUTO

      357    17275
      358    17276    3             IF CURRENT_SOURCE_INDEX < ENDING_SOURCE_INDEX

  17276   0 0001FD  C847 0032                            LDR,R4   CURRENT_SOURCE_INDEX,AUTO
          0 0001FF  C947 0033                            CMR,R4   ENDING_SOURCE_INDEX,AUTO
          0 000201  0881 0006                            BAGE     s:17280,PREL

      359    17277    3             THEN
      360    17278    3               SOURCE_CHARACTER_TO_MATCH = %ASCBIN(' ');

  17278   0 000203  3C20                                 LDV,R3   32
          0 000204  B7C7 003A                            STH,R3   SOURCE_CHARACTER_TO_MATCH,AUTO
          0 000206  0F81 0021                            B        s:17297,PREL

      361    17279    3             ELSE
      362    17280    3               SOURCE_CHARACTER_TO_MATCH = QI_1.OP.DATA_A$ (%QI#DE_EDIT) -> QI$UBYTE_A
             17280                        (CURRENT_SOURCE_INDEX);

  17280   0 000208  EC80 0000 0024  xsym                 LDB,B6   QI_1+36
          0 00020B  B854                                 LDR,R3   R4
          0 00020C  A2B6                                 LLH,R2   ,B6,R3
          0 00020D  A7C7 003A                            STH,R2   SOURCE_CHARACTER_TO_MATCH,AUTO

      363    17281    3           END;

  17281   0 00020F  0F81 0018                            B        s:17297,PREL

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:57   
      364    17282
      365    17283    2         ELSE
      366    17284
      367    17285    2           IF ( (OPERATION = %MVC)

  17285   0 000211  6D0C                                 CMV,R6   12
          0 000212  0901 0010                            BE       s:17285+18,PREL
          0 000214  6D08                                 CMV,R6   8
          0 000215  0901 000D                            BE       s:17285+18,PREL
          0 000217  6D09                                 CMV,R6   9
          0 000218  0901 000A                            BE       s:17285+18,PREL
          0 00021A  6D0E                                 CMV,R6   14
          0 00021B  0901 0007                            BE       s:17285+18,PREL
          0 00021D  6D0D                                 CMV,R6   13
          0 00021E  0901 0004                            BE       s:17285+18,PREL
          0 000220  6D05                                 CMV,R6   5
          0 000221  0981 0006                            BNE      s:17297,PREL
          0 000223  5981 0004                            BNEZ,R5  s:17297,PREL

      368    17286    2             OR (OPERATION = %MFLC)
      369    17287    2             OR (OPERATION = %MFLS)
      370    17288    2             OR (OPERATION = %MVZB)
      371    17289    2             OR (OPERATION = %MVZA)
      372    17290    2             OR (OPERATION = %INSM) )
      373    17291    2             AND (INFORMATION_FIELD = 0)
      374    17292    2           THEN
      375    17293
      376    17294    2             INFORMATION_FIELD = 16;

  17294   0 000225  5C10                                 LDV,R5   16
          0 000226  DF47 0031                            STR,R5   INFORMATION_FIELD,AUTO

      377    17295
      378    17296
      379    17297    3         DO CASE ( OPERATION );

  17297   0 000228  B856                                 LDR,R3   R6
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:58   
          0 000229  3D10                                 CMV,R3   16
          0 00022A  0281 0397                            BGE      s:17745,PREL
          0 00022C  A830 0000 0232  00                   LDR,R2   s:17297+10,R3
          0 00022F  83A0 0000 0242  00                   JMP      s:17300,R2
          0 000232       001A                            DC       s:17311,PREL
          0 000233       031B                            DC       s:17692,PREL
          0 000234       0380                            DC       s:17745,PREL
          0 000235       0026                            DC       s:17315,PREL
          0 000236       005B                            DC       s:17335,PREL
          0 000237       02EE                            DC       s:17674,PREL
          0 000238       0099                            DC       s:17363,PREL
          0 000239       00ED                            DC       s:17426,PREL
          0 00023A       0175                            DC       s:17504,PREL
          0 00023B       01D7                            DC       s:17547,PREL
          0 00023C       0380                            DC       s:17745,PREL
          0 00023D       0380                            DC       s:17745,PREL
          0 00023E       0150                            DC       s:17486,PREL
          0 00023F       02A7                            DC       s:17642,PREL
          0 000240       0260                            DC       s:17610,PREL
          0 000241       0000                            DC       s:17300,PREL

      380    17298
      381    17299    3           CASE ( %SEF );

      382    17300    3             IF INFORMATION_FIELD_FLAG_BITS.PM

  17300   0 000242  82C7 0031                            LB,'0001'X        INFORMATION_FIELD,AUTO
  17300   0 000244       0001
          0 000245  0581 0004                            BBF      s:17303,PREL

      383    17301    3             THEN
      384    17302    3               EF.PM = %RESET;

  17302   0 000247  8847 0006                            LBF,'0200'X       EF,AUTO
  17302   0 000249       0200

      385    17303    3             IF INFORMATION_FIELD_FLAG_BITS.ES
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:59   

  17303   0 00024A  82C7 0031                            LB,'0008'X        INFORMATION_FIELD,AUTO
  17303   0 00024C       0008
          0 00024D  0581 0006                            BBF      s:17307,PREL

      386    17304    3             THEN
      387    17305    3               EF.ES = %SET;

  17305   0 00024F  8947 0006                            LBT,'8000'X       EF,AUTO
  17305   0 000251       8000
          0 000252  0F81 0004                            B        s:17308,PREL

      388    17306    3             ELSE
      389    17307    3               EF.ES = %RESET;

  17307   0 000254  8847 0006                            LBF,'8000'X       EF,AUTO
  17307   0 000256       8000

      390    17308    3             EF.ES_OFF = %RESET;

  17308   0 000257  8847 0006                            LBF,'4000'X       EF,AUTO
  17308   0 000259       4000
          0 00025A  0F81 0367                            B        s:17745,PREL

      391    17309
      392    17310    3           CASE ( %CHT );

      393    17311    3             EIT (INFORMATION_FIELD) = MOP_A (NEW_MOP_STRING_INDEX);

  17311   0 00025C  9847 0035                            LDR,R1   NEW_MOP_STRING_INDEX,AUTO
          0 00025E  1E20                                 ADV,R1   32
          0 00025F  C297                                 LLH,R4   ,AUTO,R1
          0 000260  B855                                 LDR,R3   R5
          0 000261  3001                                 SOL,R3   1
          0 000262  3E0E                                 ADV,R3   14
          0 000263  C7B7                                 STH,R4   ,AUTO,R3

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:60   
      394    17312    3             NEW_MOP_STRING_INDEX = NEW_MOP_STRING_INDEX - 1;

  17312   0 000264  88C7 0035                            DEC      NEW_MOP_STRING_INDEX,AUTO
          0 000266  0F81 035B                            B        s:17745,PREL

      395    17313
      396    17314    3           CASE ( %INSA );

      397    17315    3             IF ( SOURCE_CHARACTER_TO_MATCH = INFORMATION_FIELD )

  17315   0 000268  C2C7 003A                            LLH,R4   SOURCE_CHARACTER_TO_MATCH,AUTO
          0 00026A  C955                                 CMR,R4   R5
          0 00026B  0981 000A                            BNE      s:17320,PREL
          0 00026D  82C7 0006                            LB,'4000'X        EF,AUTO
          0 00026F       4000
          0 000270  0501 0005                            BBT      s:17320,PREL

      398    17316    3               AND NOT EF.ES_OFF
      399    17317    3             THEN
      400    17318    3               CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;

  17318   0 000272  88C7 0032                            DEC      CURRENT_SOURCE_INDEX,AUTO
          0 000274  0F81 034D                            B        s:17745,PREL

      401    17319    3             ELSE
      402    17320    3               IF  ( SOURCE_CHARACTER_TO_MATCH = EIT (2) )

  17320   0 000276  92C7 0009                            LLH,R1   EIT+2,AUTO
          0 000278  C951                                 CMR,R4   R1
          0 000279  0981 000C                            BNE      s:17328,PREL
          0 00027B  89C7 0006                            CMZ      EF,AUTO
          0 00027D  0801 0008                            BAL      s:17328,PREL

      403    17321    3                 AND NOT EF.ES
      404    17322    3               THEN
      405    17323    4                 DO;

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:61   
      406    17324    4                   CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;

  17324   0 00027F  88C7 0032                            DEC      CURRENT_SOURCE_INDEX,AUTO

      407    17325    4                   EF.ES_OFF = %SET;

  17325   0 000281  8947 0006                            LBT,'4000'X       EF,AUTO
  17325   0 000283       4000

      408    17326    4                 END;

  17326   0 000284  0F81 033D                            B        s:17745,PREL

      409    17327    3               ELSE
      410    17328    3                 IF  ( CURRENT_SOURCE_INDEX = STARTING_SOURCE_INDEX )

  17328   0 000286  E847 0032                            LDR,R6   CURRENT_SOURCE_INDEX,AUTO
          0 000288  E947 003B                            CMR,R6   STARTING_SOURCE_INDEX,AUTO
          0 00028A  0981 0010                            BNE      s:17328+21,PREL
          0 00028C  5D20                                 CMV,R5   32
          0 00028D  0981 0006                            BNE      s:17328+14,PREL
          0 00028F  82C7 0006                            LB,'4000'X        EF,AUTO
          0 000291       4000
          0 000292  0581 0008                            BBF      s:17328+21,PREL
          0 000294  1D20                                 CMV,R1   32
          0 000295  0981 0347                            BNE      s:17762,PREL
          0 000297  89C7 0006                            CMZ      EF,AUTO
          0 000299  0801 0343                            BAL      s:17762,PREL
          0 00029B  0F81 0326                            B        s:17745,PREL

      411    17329    3                   AND ( ( INFORMATION_FIELD ~= %ASCBIN(' ') ) OR EF.ES_OFF )
      412    17330    3                   AND ( ( EIT (2) ~= %ASCBIN(' ') ) OR EF.ES )
      413    17331    3                 THEN
      414    17332    3                   GOTO ABORT;
      415    17333
      416    17334    3           CASE ( %INSB );

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:62   
      417    17335    3             IF  ( SOURCE_CHARACTER_TO_MATCH = INFORMATION_FIELD )

  17335   0 00029D  C2C7 003A                            LLH,R4   SOURCE_CHARACTER_TO_MATCH,AUTO
          0 00029F  C955                                 CMR,R4   R5
          0 0002A0  0981 000A                            BNE      s:17340,PREL
          0 0002A2  82C7 0006                            LB,'4000'X        EF,AUTO
          0 0002A4       4000
          0 0002A5  0501 0005                            BBT      s:17340,PREL

      418    17336    3               AND NOT EF.ES_OFF
      419    17337    3             THEN
      420    17338    3               CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;

  17338   0 0002A7  88C7 0032                            DEC      CURRENT_SOURCE_INDEX,AUTO
          0 0002A9  0F81 0318                            B        s:17745,PREL

      421    17339    3             ELSE
      422    17340    3               IF  ( SOURCE_CHARACTER_TO_MATCH = EIT (1) )

  17340   0 0002AB  92C7 0008                            LLH,R1   EIT+1,AUTO
          0 0002AD  C951                                 CMR,R4   R1
          0 0002AE  0981 000C                            BNE      s:17348,PREL
          0 0002B0  89C7 0006                            CMZ      EF,AUTO
          0 0002B2  0801 0008                            BAL      s:17348,PREL

      423    17341    3                 AND NOT EF.ES
      424    17342    3               THEN
      425    17343    4                 DO;

      426    17344    4                   CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;

  17344   0 0002B4  88C7 0032                            DEC      CURRENT_SOURCE_INDEX,AUTO

      427    17345    4                   EF.ES_OFF = %SET;

  17345   0 0002B6  8947 0006                            LBT,'4000'X       EF,AUTO
  17345   0 0002B8       4000
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:63   

      428    17346    4                 END;

  17346   0 0002B9  0F81 0308                            B        s:17745,PREL

      429    17347    3               ELSE
      430    17348    3                 IF CURRENT_SOURCE_INDEX = STARTING_SOURCE_INDEX

  17348   0 0002BB  E847 0032                            LDR,R6   CURRENT_SOURCE_INDEX,AUTO
          0 0002BD  E947 003B                            CMR,R6   STARTING_SOURCE_INDEX,AUTO
          0 0002BF  0981 0012                            BNE      s:17357,PREL

      431    17349    3                 THEN
      432    17350    4                   DO;

      433    17351    4                     IF  ( ( INFORMATION_FIELD ~= %ASCBIN(' ') ) OR EF.ES_OFF )

  17351   0 0002C1  5D20                                 CMV,R5   32
          0 0002C2  0981 0006                            BNE      s:17351+8,PREL
          0 0002C4  82C7 0006                            LB,'4000'X        EF,AUTO
          0 0002C6       4000
          0 0002C7  0581 0008                            BBF      s:17355,PREL
          0 0002C9  1D20                                 CMV,R1   32
          0 0002CA  0981 0312                            BNE      s:17762,PREL
          0 0002CC  89C7 0006                            CMZ      EF,AUTO
          0 0002CE  0801 030E                            BAL      s:17762,PREL

      434    17352    4                       AND ( ( EIT (1) ~= %ASCBIN(' ') ) OR EF.ES )
      435    17353    4                     THEN
      436    17354    4                       GOTO ABORT;
      437    17355    4                   END;

  17355   0 0002D0  0F81 02F1                            B        s:17745,PREL

      438    17356    3                 ELSE
      439    17357    3                   IF  ( SOURCE_CHARACTER_TO_MATCH ~= INFORMATION_FIELD )

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:64   
  17357   0 0002D2  C955                                 CMR,R4   R5
          0 0002D3  0901 0005                            BE       s:17357+7,PREL
          0 0002D5  89C7 0006                            CMZ      EF,AUTO
          0 0002D7  0801 0305                            BAL      s:17762,PREL
          0 0002D9  0F81 02E8                            B        s:17745,PREL

      440    17358    3                     AND EF.ES
      441    17359    3                   THEN
      442    17360    3                     GOTO ABORT;
      443    17361
      444    17362    3           CASE ( %INSN );

      445    17363    3             IF SOURCE_CHARACTER_TO_MATCH = INFORMATION_FIELD

  17363   0 0002DB  C2C7 003A                            LLH,R4   SOURCE_CHARACTER_TO_MATCH,AUTO
          0 0002DD  C955                                 CMR,R4   R5
          0 0002DE  0981 000D                            BNE      s:17376,PREL

      446    17364    3             THEN
      447    17365    4               DO;

      448    17366    4                 EF.SN = %SET;

  17366   0 0002E0  8947 0006                            LBT,'2000'X       EF,AUTO
  17366   0 0002E2       2000

      449    17367    4                 IF EF.SP

  17367   0 0002E3  82C7 0006                            LB,'1000'X        EF,AUTO
  17367   0 0002E5       1000
          0 0002E6  0501 02FB                            BBT      s:17767,PREL

      450    17368    4                 THEN
      451    17369    4                   GOTO ABORT_SIGN;
      452    17370    4                 CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;

  17370   0 0002E8  88C7 0032                            DEC      CURRENT_SOURCE_INDEX,AUTO
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:65   

      453    17371    4               END;

  17371   0 0002EA  0F81 02D7                            B        s:17745,PREL

      454    17372    3             ELSE
      455    17373                    /* This next test is a kludge to allow an entry of '+'
      456    17374                       into a PICture string of '-'...
      457    17375                       The '+' is treated as if it were a ' ' (EIT (1)) */
      458    17376    3               IF  ( INFORMATION_FIELD = %ASCBIN('-') )

  17376   0 0002EC  5D2D                                 CMV,R5   45
          0 0002ED  0981 0010                            BNE      s:17387,PREL
          0 0002EF  4D2B                                 CMV,R4   43
          0 0002F0  0981 000D                            BNE      s:17387,PREL

      459    17377    3                 AND ( SOURCE_CHARACTER_TO_MATCH = %ASCBIN('+') )
      460    17378    3               THEN
      461    17379    4                 DO;

      462    17380    4                   EF.SP = %SET;

  17380   0 0002F2  8947 0006                            LBT,'1000'X       EF,AUTO
  17380   0 0002F4       1000

      463    17381    4                   IF EF.SN

  17381   0 0002F5  82C7 0006                            LB,'2000'X        EF,AUTO
  17381   0 0002F7       2000
          0 0002F8  0501 02E9                            BBT      s:17767,PREL

      464    17382    4                   THEN
      465    17383    4                     GOTO ABORT_SIGN;
      466    17384    4                   CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;

  17384   0 0002FA  88C7 0032                            DEC      CURRENT_SOURCE_INDEX,AUTO

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:66   
      467    17385    4                 END;

  17385   0 0002FC  0F81 02C5                            B        s:17745,PREL

      468    17386    3               ELSE
      469    17387    3                 IF SOURCE_CHARACTER_TO_MATCH = EIT (1)

  17387   0 0002FE  92C7 0008                            LLH,R1   EIT+1,AUTO
          0 000300  C951                                 CMR,R4   R1
          0 000301  0981 000D                            BNE      s:17397,PREL

      470    17388    3                 THEN
      471    17389    4                   DO;

      472    17390    4                     CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;

  17390   0 000303  88C7 0032                            DEC      CURRENT_SOURCE_INDEX,AUTO

      473    17391    4                     EF.SP = %SET;

  17391   0 000305  8947 0006                            LBT,'1000'X       EF,AUTO
  17391   0 000307       1000

      474    17392    4                     IF EF.SN

  17392   0 000308  82C7 0006                            LB,'2000'X        EF,AUTO
  17392   0 00030A       2000
          0 00030B  0501 02D6                            BBT      s:17767,PREL

      475    17393    4                     THEN
      476    17394    4                       GOTO ABORT_SIGN;
      477    17395    4                   END;

  17395   0 00030D  0F81 02B4                            B        s:17745,PREL

      478    17396    3                 ELSE
      479    17397    3                   IF CURRENT_SOURCE_INDEX = STARTING_SOURCE_INDEX
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:67   

  17397   0 00030F  E847 0032                            LDR,R6   CURRENT_SOURCE_INDEX,AUTO
          0 000311  E947 003B                            CMR,R6   STARTING_SOURCE_INDEX,AUTO
          0 000313  0981 02C9                            BNE      s:17762,PREL

      480    17398    3                   THEN
      481    17399    4                     DO;

      482    17400    4                       IF INFORMATION_FIELD = %ASCBIN(' ')

  17400   0 000315  5D20                                 CMV,R5   32
          0 000316  0981 000B                            BNE      s:17410,PREL

      483    17401    4                       THEN
      484    17402    5                         DO;

      485    17403    5                           EF.SN = %SET;

  17403   0 000318  8947 0006                            LBT,'2000'X       EF,AUTO
  17403   0 00031A       2000

      486    17404    5                           IF EF.SP

  17404   0 00031B  82C7 0006                            LB,'1000'X        EF,AUTO
  17404   0 00031D       1000
          0 00031E  0501 02C3                            BBT      s:17767,PREL

      487    17405    5                           THEN
      488    17406    5                             GOTO ABORT_SIGN;
      489    17407    5                         END;

  17407   0 000320  0F81 02A1                            B        s:17745,PREL

      490    17408    4                       ELSE
      491    17409    5                         DO;

      492    17410    5                           IF EIT (1) = %ASCBIN(' ')
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:68   

  17410   0 000322  1D20                                 CMV,R1   32
          0 000323  0981 02B9                            BNE      s:17762,PREL

      493    17411    5                           THEN
      494    17412    6                             DO;

      495    17413    6                               EF.SP = %SET;

  17413   0 000325  8947 0006                            LBT,'1000'X       EF,AUTO
  17413   0 000327       1000

      496    17414    6                               IF EF.SN

  17414   0 000328  82C7 0006                            LB,'2000'X        EF,AUTO
  17414   0 00032A       2000
          0 00032B  0501 02B6                            BBT      s:17767,PREL

      497    17415    6                               THEN
      498    17416    6                                 GOTO ABORT_SIGN;
      499    17417    6                             END;

  17417   0 00032D  0F81 0294                            B        s:17745,PREL

      500    17418    5                           ELSE
      501    17419    5                             GOTO ABORT;
      502    17420    5                         END;
      503    17421    4                     END;
      504    17422    3                   ELSE
      505    17423    3                     GOTO ABORT;
      506    17424
      507    17425    3           CASE ( %INSP );

      508    17426    3             IF EF.PM

  17426   0 00032F  82C7 0006                            LB,'0200'X        EF,AUTO
  17426   0 000331       0200
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:69   
          0 000332  0581 028F                            BBF      s:17745,PREL

      509    17427    3             THEN
      510    17428    3               IF SOURCE_CHARACTER_TO_MATCH = EIT (3)

  17428   0 000334  C2C7 003A                            LLH,R4   SOURCE_CHARACTER_TO_MATCH,AUTO
          0 000336  92C7 000A                            LLH,R1   EIT+3,AUTO
          0 000338  C951                                 CMR,R4   R1
          0 000339  0981 000D                            BNE      s:17438,PREL

      511    17429    3               THEN
      512    17430    4                 DO;

      513    17431    4                   CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;

  17431   0 00033B  88C7 0032                            DEC      CURRENT_SOURCE_INDEX,AUTO

      514    17432    4                   EF.SP = %SET;

  17432   0 00033D  8947 0006                            LBT,'1000'X       EF,AUTO
  17432   0 00033F       1000

      515    17433    4                   IF EF.SN

  17433   0 000340  82C7 0006                            LB,'2000'X        EF,AUTO
  17433   0 000342       2000
          0 000343  0501 029E                            BBT      s:17767,PREL

      516    17434    4                   THEN
      517    17435    4                     GOTO ABORT_SIGN;
      518    17436    4                 END;

  17436   0 000345  0F81 027C                            B        s:17745,PREL

      519    17437    3               ELSE
      520    17438    3                 IF SOURCE_CHARACTER_TO_MATCH = EIT (4)

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:70   
  17438   0 000347  E2C7 000B                            LLH,R6   EIT+4,AUTO
          0 000349  C956                                 CMR,R4   R6
          0 00034A  0981 000D                            BNE      s:17448,PREL

      521    17439    3                 THEN
      522    17440    4                   DO;

      523    17441    4                     CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;

  17441   0 00034C  88C7 0032                            DEC      CURRENT_SOURCE_INDEX,AUTO

      524    17442    4                     EF.SN = %SET;

  17442   0 00034E  8947 0006                            LBT,'2000'X       EF,AUTO
  17442   0 000350       2000

      525    17443    4                     IF EF.SP

  17443   0 000351  82C7 0006                            LB,'1000'X        EF,AUTO
  17443   0 000353       1000
          0 000354  0501 028D                            BBT      s:17767,PREL

      526    17444    4                     THEN
      527    17445    4                       GOTO ABORT_SIGN;
      528    17446    4                   END;

  17446   0 000356  0F81 026B                            B        s:17745,PREL

      529    17447    3                 ELSE /* IF (not) EF.PM */
      530    17448    3                   IF SOURCE_CHARACTER_TO_MATCH = INFORMATION_FIELD

  17448   0 000358  C955                                 CMR,R4   R5
          0 000359  0981 000D                            BNE      s:17458,PREL

      531    17449    3                   THEN
      532    17450    4                     DO;

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:71   
      533    17451    4                       CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;

  17451   0 00035B  88C7 0032                            DEC      CURRENT_SOURCE_INDEX,AUTO

      534    17452    4                       EF.SP = %SET;

  17452   0 00035D  8947 0006                            LBT,'1000'X       EF,AUTO
  17452   0 00035F       1000

      535    17453    4                       IF EF.SN

  17453   0 000360  82C7 0006                            LB,'2000'X        EF,AUTO
  17453   0 000362       2000
          0 000363  0501 027E                            BBT      s:17767,PREL

      536    17454    4                       THEN
      537    17455    4                         GOTO ABORT_SIGN;
      538    17456    4                     END;

  17456   0 000365  0F81 025C                            B        s:17745,PREL

      539    17457    3                   ELSE
      540    17458    3                     IF SOURCE_CHARACTER_TO_MATCH = EIT (1)

  17458   0 000367  E2C7 0008                            LLH,R6   EIT+1,AUTO
          0 000369  C956                                 CMR,R4   R6
          0 00036A  0981 0005                            BNE      s:17462,PREL

      541    17459    3                     THEN
      542    17460    3                       CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;

  17460   0 00036C  88C7 0032                            DEC      CURRENT_SOURCE_INDEX,AUTO
          0 00036E  0F81 0253                            B        s:17745,PREL

      543    17461    3                     ELSE
      544    17462    3                       IF CURRENT_SOURCE_INDEX = STARTING_SOURCE_INDEX

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:72   
  17462   0 000370  E847 0032                            LDR,R6   CURRENT_SOURCE_INDEX,AUTO
          0 000372  E947 003B                            CMR,R6   STARTING_SOURCE_INDEX,AUTO
          0 000374  0981 0268                            BNE      s:17762,PREL

      545    17463    3                       THEN
      546    17464    4                         DO;

      547    17465    4                           IF INFORMATION_FIELD = %ASCBIN(' ')

  17465   0 000376  5D20                                 CMV,R5   32
          0 000377  0981 000B                            BNE      s:17474,PREL

      548    17466    4                           THEN
      549    17467    5                             DO;

      550    17468    5                               EF.SP = %SET;

  17468   0 000379  8947 0006                            LBT,'1000'X       EF,AUTO
  17468   0 00037B       1000

      551    17469    5                               IF EF.SN

  17469   0 00037C  82C7 0006                            LB,'2000'X        EF,AUTO
  17469   0 00037E       2000
          0 00037F  0501 0262                            BBT      s:17767,PREL

      552    17470    5                               THEN
      553    17471    5                                 GOTO ABORT_SIGN;
      554    17472    5                             END;

  17472   0 000381  0F81 0240                            B        s:17745,PREL

      555    17473    4                           ELSE
      556    17474    4                             IF EIT (1) = %ASCBIN(' ')

  17474   0 000383  E2C7 0008                            LLH,R6   EIT+1,AUTO
          0 000385  6D20                                 CMV,R6   32
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:73   
          0 000386  0981 023B                            BNE      s:17745,PREL

      557    17475    4                             THEN
      558    17476    5                               DO;

      559    17477    5                                 EF.SN = %SET;

  17477   0 000388  8947 0006                            LBT,'2000'X       EF,AUTO
  17477   0 00038A       2000

      560    17478    5                                 IF EF.SP

  17478   0 00038B  82C7 0006                            LB,'1000'X        EF,AUTO
  17478   0 00038D       1000
          0 00038E  0501 0253                            BBT      s:17767,PREL

      561    17479    5                                 THEN
      562    17480    5                                   GOTO ABORT_SIGN;
      563    17481    5                               END;

      564    17482    4                         END;

  17482   0 000390  0F81 0231                            B        s:17745,PREL

      565    17483    3                       ELSE
      566    17484    3                         GOTO ABORT;
      567    17485
      568    17486    3           CASE ( %MVC );

      569    17487    3   DO_MVC:
      570    17488    4             DO WHILE ( INFORMATION_FIELD ~= 0 );

  17488   0 000392  E847 0031            DO_MVC          LDR,R6   INFORMATION_FIELD,AUTO
          0 000394  6901 022D                            BEZ,R6   s:17745,PREL

      571    17489    4               SOURCE_CHARACTER_TO_MATCH = QI_1.OP.DATA_A$ (%QI#DE_EDIT) -> QI$UBYTE_A
             17489                        (CURRENT_SOURCE_INDEX);
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:74   

  17489   0 000396  EC80 0000 0024  xsym                 LDB,B6   QI_1+36
          0 000399  B847 0032                            LDR,R3   CURRENT_SOURCE_INDEX,AUTO
          0 00039B  E2B6                                 LLH,R6   ,B6,R3
          0 00039C  E7C7 003A                            STH,R6   SOURCE_CHARACTER_TO_MATCH,AUTO

      572    17490    4               IF ( SOURCE_CHARACTER_TO_MATCH < %ASCBIN('0') )

  17490   0 00039E  D2C7 003A                            LLH,R5   SOURCE_CHARACTER_TO_MATCH,AUTO
          0 0003A0  5D30                                 CMV,R5   48
          0 0003A1  0201 023B                            BL       s:17762,PREL
          0 0003A3  5D39                                 CMV,R5   57
          0 0003A4  0301 0238                            BG       s:17762,PREL

      573    17491    4                 OR ( SOURCE_CHARACTER_TO_MATCH > %ASCBIN('9') )
      574    17492    4               THEN
      575    17493    4                 GOTO ABORT;
      576    17494    4               ELSE
      577    17495    5                 DO;

      578    17496    5                   QCD@DE_EDIT.RESULT.DIGIT_A (RESULT_INDEX) =
             17496                            SOURCE_CHARACTER_TO_MATCH;

  17496   0 0003A6  DCC7 0004                            LDB,B5   @QCD@DE_EDIT,AUTO
          0 0003A8  A847 0038                            LDR,R2   RESULT_INDEX,AUTO
          0 0003AA  2E02                                 ADV,R2   2
          0 0003AB  D7A5                                 STH,R5   ,B5,R2

      579    17497    5                   RESULT_INDEX = RESULT_INDEX - 1;

  17497   0 0003AC  88C7 0038                            DEC      RESULT_INDEX,AUTO

      580    17498    5                 END;

      581    17499    4               CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;

  17499   0 0003AE  88C7 0032                            DEC      CURRENT_SOURCE_INDEX,AUTO
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:75   

      582    17500    4               INFORMATION_FIELD = INFORMATION_FIELD - 1;

  17500   0 0003B0  88C7 0031                            DEC      INFORMATION_FIELD,AUTO

      583    17501    4             END;

  17501   0 0003B2  E847 0031                            LDR,R6   INFORMATION_FIELD,AUTO
          0 0003B4  69E2                                 BNEZ,R6  s:17489,SPREL
          0 0003B5  0F81 020C                            B        s:17745,PREL

      584    17502
      585    17503    3           CASE ( %MFLC );

      586    17504    3             IF EF.ES

  17504   0 0003B7  89C7 0006                            CMZ      EF,AUTO
          0 0003B9  0859                                 BAL      s:17486,SPREL

      587    17505    3             THEN
      588    17506    3               GOTO DO_MVC;
      589    17507    4             DO WHILE ( ( INFORMATION_FIELD > 0 )

  17507   0 0003BA  0F81 0051                            B        s:17544,PREL

      590    17508    4               OR ( ( INFORMATION_FIELD >= 0 ) AND NOT EF.ES_OFF ) );
      591    17509    4               IF CURRENT_SOURCE_INDEX < ENDING_SOURCE_INDEX

  17509   0 0003BC  E847 0032                            LDR,R6   CURRENT_SOURCE_INDEX,AUTO
          0 0003BE  E947 0033                            CMR,R6   ENDING_SOURCE_INDEX,AUTO
          0 0003C0  0881 0006                            BAGE     s:17513,PREL

      592    17510    4               THEN
      593    17511    4                 SOURCE_CHARACTER_TO_MATCH = %ASCBIN(' ');

  17511   0 0003C2  5C20                                 LDV,R5   32
          0 0003C3  D7C7 003A                            STH,R5   SOURCE_CHARACTER_TO_MATCH,AUTO
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:76   
          0 0003C5  0F81 0008                            B        s:17514,PREL

      594    17512    4               ELSE
      595    17513    4                 SOURCE_CHARACTER_TO_MATCH = QI_1.OP.DATA_A$ (%QI#DE_EDIT) ->
             17513                          QI$UBYTE_A (CURRENT_SOURCE_INDEX);

  17513   0 0003C7  EC80 0000 0024  xsym                 LDB,B6   QI_1+36
          0 0003CA  B856                                 LDR,R3   R6
          0 0003CB  D2B6                                 LLH,R5   ,B6,R3
          0 0003CC  D7C7 003A                            STH,R5   SOURCE_CHARACTER_TO_MATCH,AUTO

      596    17514    4               CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;

  17514   0 0003CE  88C7 0032                            DEC      CURRENT_SOURCE_INDEX,AUTO

      597    17515    4               IF  ( SOURCE_CHARACTER_TO_MATCH = EIT (5) )

  17515   0 0003D0  E2C7 003A                            LLH,R6   SOURCE_CHARACTER_TO_MATCH,AUTO
          0 0003D2  D2C7 000C                            LLH,R5   EIT+5,AUTO
          0 0003D4  E955                                 CMR,R6   R5
          0 0003D5  0981 000D                            BNE      s:17523,PREL
          0 0003D7  82C7 0006                            LB,'4000'X        EF,AUTO
          0 0003D9       4000
          0 0003DA  0501 0008                            BBT      s:17523,PREL

      598    17516    4                 AND NOT EF.ES_OFF
      599    17517    4               THEN
      600    17518    5                 DO;

      601    17519    5                   EF.ES_OFF = %SET;

  17519   0 0003DC  8947 0006                            LBT,'4000'X       EF,AUTO
  17519   0 0003DE       4000

      602    17520    5                   INFORMATION_FIELD = INFORMATION_FIELD + 1;

  17520   0 0003DF  8AC7 0031                            INC      INFORMATION_FIELD,AUTO
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:77   

      603    17521    5                 END;

  17521   0 0003E1  0F81 0028                            B        s:17543,PREL

      604    17522    4               ELSE
      605    17523    4                 IF SOURCE_CHARACTER_TO_MATCH = EIT (1)

  17523   0 0003E3  C2C7 0008                            LLH,R4   EIT+1,AUTO
          0 0003E5  E954                                 CMR,R6   R4
          0 0003E6  0981 0006                            BNE      s:17527,PREL

      606    17524    4                 THEN
      607    17525    4                   EF.ES_OFF = %SET;

  17525   0 0003E8  8947 0006                            LBT,'4000'X       EF,AUTO
  17525   0 0003EA       4000
          0 0003EB  0F81 001E                            B        s:17543,PREL

      608    17526    4                 ELSE
      609    17527    4                   IF ( SOURCE_CHARACTER_TO_MATCH < %ASCBIN('0') )

  17527   0 0003ED  6D30                                 CMV,R6   48
          0 0003EE  0201 0009                            BL       s:17532,PREL
          0 0003F0  6D39                                 CMV,R6   57
          0 0003F1  0301 0006                            BG       s:17532,PREL
          0 0003F3  82C7 0006                            LB,'4000'X        EF,AUTO
          0 0003F5       4000
          0 0003F6  0581 0007                            BBF      s:17537,PREL

      610    17528    4                     OR ( SOURCE_CHARACTER_TO_MATCH > %ASCBIN('9') )
      611    17529    4                     OR EF.ES_OFF
      612    17530    4                   THEN
      613    17531    5                     DO;

      614    17532    5                       INFORMATION_FIELD = 0;

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:78   
  17532   0 0003F8  8747 0031                            CL       INFORMATION_FIELD,AUTO

      615    17533    5                       CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX + 1;

  17533   0 0003FA  8AC7 0032                            INC      CURRENT_SOURCE_INDEX,AUTO

      616    17534    5                     END;

  17534   0 0003FC  0F81 000D                            B        s:17543,PREL

      617    17535    4                   ELSE
      618    17536    5                     DO;

      619    17537    5                       IF INFORMATION_FIELD <= 0

  17537   0 0003FE  B847 0031                            LDR,R3   INFORMATION_FIELD,AUTO
          0 000400  3A81 01DC                            BLEZ,R3  s:17762,PREL

      620    17538    5                       THEN
      621    17539    5                         GOTO ABORT;
      622    17540    5                       QCD@DE_EDIT.RESULT.DIGIT_A (RESULT_INDEX) =
             17540                                SOURCE_CHARACTER_TO_MATCH;

  17540   0 000402  ECC7 0004                            LDB,B6   @QCD@DE_EDIT,AUTO
          0 000404  A847 0038                            LDR,R2   RESULT_INDEX,AUTO
          0 000406  2E02                                 ADV,R2   2
          0 000407  E7A6                                 STH,R6   ,B6,R2

      623    17541    5                       RESULT_INDEX = RESULT_INDEX - 1;

  17541   0 000408  88C7 0038                            DEC      RESULT_INDEX,AUTO

      624    17542    5                     END;

      625    17543    4               INFORMATION_FIELD = INFORMATION_FIELD - 1;

  17543   0 00040A  88C7 0031                            DEC      INFORMATION_FIELD,AUTO
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:79   

      626    17544    4             END;

  17544   0 00040C  E847 0031                            LDR,R6   INFORMATION_FIELD,AUTO
          0 00040E  6A01 FFAD                            BGZ,R6   s:17509,PREL
          0 000410  6801 0006                            BLZ,R6   s:17544+11,PREL
          0 000412  82C7 0006                            LB,'4000'X        EF,AUTO
          0 000414       4000
          0 000415  0581 FFA6                            BBF      s:17509,PREL
          0 000417  0F81 01AA                            B        s:17745,PREL

      627    17545
      628    17546    3           CASE ( %MFLS );

      629    17547    3             IF EF.ES

  17547   0 000419  89C7 0006                            CMZ      EF,AUTO
          0 00041B  0801 FF76                            BAL      s:17486,PREL

      630    17548    3             THEN
      631    17549    3               GOTO DO_MVC;
      632    17550    4             DO WHILE ( ( INFORMATION_FIELD > 0 )

  17550   0 00041D  0F81 0077                            B        s:17607,PREL

      633    17551    4               OR ( ( INFORMATION_FIELD >= 0 ) AND NOT EF.ES_OFF ) );
      634    17552    4               IF CURRENT_SOURCE_INDEX < ENDING_SOURCE_INDEX

  17552   0 00041F  E847 0032                            LDR,R6   CURRENT_SOURCE_INDEX,AUTO
          0 000421  E947 0033                            CMR,R6   ENDING_SOURCE_INDEX,AUTO
          0 000423  0881 0006                            BAGE     s:17556,PREL

      635    17553    4               THEN
      636    17554    4                 SOURCE_CHARACTER_TO_MATCH = %ASCBIN(' ');

  17554   0 000425  5C20                                 LDV,R5   32
          0 000426  D7C7 003A                            STH,R5   SOURCE_CHARACTER_TO_MATCH,AUTO
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:80   
          0 000428  0F81 0008                            B        s:17557,PREL

      637    17555    4               ELSE
      638    17556    4                 SOURCE_CHARACTER_TO_MATCH = QI_1.OP.DATA_A$ (%QI#DE_EDIT) ->
             17556                          QI$UBYTE_A (CURRENT_SOURCE_INDEX);

  17556   0 00042A  EC80 0000 0024  xsym                 LDB,B6   QI_1+36
          0 00042D  B856                                 LDR,R3   R6
          0 00042E  D2B6                                 LLH,R5   ,B6,R3
          0 00042F  D7C7 003A                            STH,R5   SOURCE_CHARACTER_TO_MATCH,AUTO

      639    17557    4               CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;

  17557   0 000431  88C7 0032                            DEC      CURRENT_SOURCE_INDEX,AUTO

      640    17558    4               IF  ( SOURCE_CHARACTER_TO_MATCH = EIT (4) )

  17558   0 000433  E2C7 003A                            LLH,R6   SOURCE_CHARACTER_TO_MATCH,AUTO
          0 000435  D2C7 000B                            LLH,R5   EIT+4,AUTO
          0 000437  E955                                 CMR,R6   R5
          0 000438  0981 0015                            BNE      s:17570,PREL
          0 00043A  82C7 0006                            LB,'4000'X        EF,AUTO
          0 00043C       4000
          0 00043D  0501 0010                            BBT      s:17570,PREL

      641    17559    4                 AND NOT EF.ES_OFF
      642    17560    4               THEN
      643    17561    5                 DO;

      644    17562    5                   EF.ES_OFF = %SET;

  17562   0 00043F  8947 0006                            LBT,'4000'X       EF,AUTO
  17562   0 000441       4000

      645    17563    5                   EF.SN = %SET;

  17563   0 000442  8947 0006                            LBT,'2000'X       EF,AUTO
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:81   
  17563   0 000444       2000

      646    17564    5                   IF EF.SP

  17564   0 000445  82C7 0006                            LB,'1000'X        EF,AUTO
  17564   0 000447       1000
          0 000448  0501 0199                            BBT      s:17767,PREL

      647    17565    5                   THEN
      648    17566    5                     GOTO ABORT_SIGN;
      649    17567    5                   INFORMATION_FIELD = INFORMATION_FIELD + 1;

  17567   0 00044A  8AC7 0031                            INC      INFORMATION_FIELD,AUTO

      650    17568    5                 END;

  17568   0 00044C  0F81 0046                            B        s:17606,PREL

      651    17569    4               ELSE
      652    17570    4                 IF  ( SOURCE_CHARACTER_TO_MATCH = EIT (3) )

  17570   0 00044E  C2C7 000A                            LLH,R4   EIT+3,AUTO
          0 000450  E954                                 CMR,R6   R4
          0 000451  0981 001A                            BNE      s:17585,PREL
          0 000453  82C7 0006                            LB,'4000'X        EF,AUTO
          0 000455       4000
          0 000456  0501 0015                            BBT      s:17585,PREL

      653    17571    4                   AND NOT EF.ES_OFF
      654    17572    4                 THEN
      655    17573    5                   DO;

      656    17574    5                     EF.ES_OFF = %SET;

  17574   0 000458  8947 0006                            LBT,'4000'X       EF,AUTO
  17574   0 00045A       4000

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:82   
      657    17575    5                     EF.SP = %SET;

  17575   0 00045B  8947 0006                            LBT,'1000'X       EF,AUTO
  17575   0 00045D       1000

      658    17576    5                     INFORMATION_FIELD = INFORMATION_FIELD + 1;

  17576   0 00045E  8AC7 0031                            INC      INFORMATION_FIELD,AUTO

      659    17577    5                     IF EF.SN

  17577   0 000460  82C7 0006                            LB,'2000'X        EF,AUTO
  17577   0 000462       2000
          0 000463  0501 017E                            BBT      s:17767,PREL

      660    17578    5                     THEN
      661    17579    5                       GOTO ABORT_SIGN;
      662    17580    5                     IF NOT EF.PM

  17580   0 000465  82C7 0006                            LB,'0200'X        EF,AUTO
  17580   0 000467       0200
          0 000468  0581 0174                            BBF      s:17762,PREL

      663    17581    5                     THEN
      664    17582    5                       GOTO ABORT;
      665    17583    5                   END;

  17583   0 00046A  0F81 0028                            B        s:17606,PREL

      666    17584    4                 ELSE
      667    17585    4                   IF SOURCE_CHARACTER_TO_MATCH = EIT (1)

  17585   0 00046C  B2C7 0008                            LLH,R3   EIT+1,AUTO
          0 00046E  E953                                 CMR,R6   R3
          0 00046F  0981 0006                            BNE      s:17589,PREL

      668    17586    4                   THEN
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:83   
      669    17587    4                     EF.ES_OFF = %SET;

  17587   0 000471  8947 0006                            LBT,'4000'X       EF,AUTO
  17587   0 000473       4000
          0 000474  0F81 001E                            B        s:17606,PREL

      670    17588    4                   ELSE
      671    17589    4                     IF ( SOURCE_CHARACTER_TO_MATCH < %ASCBIN('0') )

  17589   0 000476  6D30                                 CMV,R6   48
          0 000477  0201 0009                            BL       s:17594,PREL
          0 000479  6D39                                 CMV,R6   57
          0 00047A  0301 0006                            BG       s:17594,PREL
          0 00047C  82C7 0006                            LB,'4000'X        EF,AUTO
          0 00047E       4000
          0 00047F  0581 0007                            BBF      s:17600,PREL

      672    17590    4                       OR ( SOURCE_CHARACTER_TO_MATCH > %ASCBIN('9') )
      673    17591    4                       OR EF.ES_OFF
      674    17592    4                     THEN
      675    17593    5                       DO;

      676    17594    5                         INFORMATION_FIELD = 0;

  17594   0 000481  8747 0031                            CL       INFORMATION_FIELD,AUTO

      677    17595    5                         CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX + 1;

  17595   0 000483  8AC7 0032                            INC      CURRENT_SOURCE_INDEX,AUTO

      678    17596    5                       END;

  17596   0 000485  0F81 000D                            B        s:17606,PREL

      679    17597    4                     ELSE
      680    17598    5                       DO;

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:84   
      681    17599                              /* move into temp */
      682    17600    5                         IF INFORMATION_FIELD <= 0

  17600   0 000487  A847 0031                            LDR,R2   INFORMATION_FIELD,AUTO
          0 000489  2A81 0153                            BLEZ,R2  s:17762,PREL

      683    17601    5                         THEN
      684    17602    5                           GOTO ABORT;
      685    17603    5                         QCD@DE_EDIT.RESULT.DIGIT_A (RESULT_INDEX) =
             17603                                  SOURCE_CHARACTER_TO_MATCH;

  17603   0 00048B  ECC7 0004                            LDB,B6   @QCD@DE_EDIT,AUTO
          0 00048D  9847 0038                            LDR,R1   RESULT_INDEX,AUTO
          0 00048F  1E02                                 ADV,R1   2
          0 000490  E796                                 STH,R6   ,B6,R1

      686    17604    5                         RESULT_INDEX = RESULT_INDEX - 1;

  17604   0 000491  88C7 0038                            DEC      RESULT_INDEX,AUTO

      687    17605    5                       END;

      688    17606    4               INFORMATION_FIELD = INFORMATION_FIELD - 1;

  17606   0 000493  88C7 0031                            DEC      INFORMATION_FIELD,AUTO

      689    17607    4             END;

  17607   0 000495  E847 0031                            LDR,R6   INFORMATION_FIELD,AUTO
          0 000497  6A01 FF87                            BGZ,R6   s:17552,PREL
          0 000499  6801 0006                            BLZ,R6   s:17607+11,PREL
          0 00049B  82C7 0006                            LB,'4000'X        EF,AUTO
          0 00049D       4000
          0 00049E  0581 FF80                            BBF      s:17552,PREL
          0 0004A0  0F81 0121                            B        s:17745,PREL

      690    17608
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:85   
      691    17609    3           CASE ( %MVZB );

      692    17610    3             IF EF.ES

  17610   0 0004A2  89C7 0006                            CMZ      EF,AUTO
          0 0004A4  0801 FEED                            BAL      s:17486,PREL

      693    17611    3             THEN
      694    17612    3               GOTO DO_MVC;
      695    17613    4             DO WHILE ( INFORMATION_FIELD ~= 0 );

  17613   0 0004A6  5901 011B                            BEZ,R5   s:17745,PREL

      696    17614    4               IF CURRENT_SOURCE_INDEX < ENDING_SOURCE_INDEX

  17614   0 0004A8  E847 0032                            LDR,R6   CURRENT_SOURCE_INDEX,AUTO
          0 0004AA  E947 0033                            CMR,R6   ENDING_SOURCE_INDEX,AUTO
          0 0004AC  0881 0006                            BAGE     s:17618,PREL

      697    17615    4               THEN
      698    17616    4                 SOURCE_CHARACTER_TO_MATCH = %ASCBIN(' ');

  17616   0 0004AE  5C20                                 LDV,R5   32
          0 0004AF  D7C7 003A                            STH,R5   SOURCE_CHARACTER_TO_MATCH,AUTO
          0 0004B1  0F81 0008                            B        s:17619,PREL

      699    17617    4               ELSE
      700    17618    4                 SOURCE_CHARACTER_TO_MATCH = QI_1.OP.DATA_A$ (%QI#DE_EDIT) ->
             17618                          QI$UBYTE_A (CURRENT_SOURCE_INDEX);

  17618   0 0004B3  EC80 0000 0024  xsym                 LDB,B6   QI_1+36
          0 0004B6  B856                                 LDR,R3   R6
          0 0004B7  D2B6                                 LLH,R5   ,B6,R3
          0 0004B8  D7C7 003A                            STH,R5   SOURCE_CHARACTER_TO_MATCH,AUTO

      701    17619    4               CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:86   
  17619   0 0004BA  88C7 0032                            DEC      CURRENT_SOURCE_INDEX,AUTO

      702    17620    4               IF SOURCE_CHARACTER_TO_MATCH = EIT (1)

  17620   0 0004BC  E2C7 003A                            LLH,R6   SOURCE_CHARACTER_TO_MATCH,AUTO
          0 0004BE  D2C7 0008                            LLH,R5   EIT+1,AUTO
          0 0004C0  E955                                 CMR,R6   R5
          0 0004C1  0981 0006                            BNE      s:17624,PREL

      703    17621    4               THEN
      704    17622    4                 EF.ES_OFF = %SET;

  17622   0 0004C3  8947 0006                            LBT,'4000'X       EF,AUTO
  17622   0 0004C5       4000
          0 0004C6  0F81 001B                            B        s:17638,PREL

      705    17623    4               ELSE
      706    17624    4                 IF ( SOURCE_CHARACTER_TO_MATCH < %ASCBIN('0') )

  17624   0 0004C8  6D30                                 CMV,R6   48
          0 0004C9  0201 0009                            BL       s:17629,PREL
          0 0004CB  6D39                                 CMV,R6   57
          0 0004CC  0301 0006                            BG       s:17629,PREL
          0 0004CE  82C7 0006                            LB,'4000'X        EF,AUTO
          0 0004D0       4000
          0 0004D1  0581 0008                            BBF      s:17635,PREL

      707    17625    4                   OR ( SOURCE_CHARACTER_TO_MATCH > %ASCBIN('9') )
      708    17626    4                   OR EF.ES_OFF
      709    17627    4                 THEN
      710    17628    5                   DO;

      711    17629    5                     INFORMATION_FIELD = 1;

  17629   0 0004D3  4C01                                 LDV,R4   1
          0 0004D4  CF47 0031                            STR,R4   INFORMATION_FIELD,AUTO

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:87   
      712    17630    5                     CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX + 1;

  17630   0 0004D6  8AC7 0032                            INC      CURRENT_SOURCE_INDEX,AUTO

      713    17631    5                   END;

  17631   0 0004D8  0F81 0009                            B        s:17638,PREL

      714    17632    4                 ELSE
      715    17633    5                   DO;

      716    17634                          /* move it to temp */
      717    17635    5                     QCD@DE_EDIT.RESULT.DIGIT_A (RESULT_INDEX) =
             17635                              SOURCE_CHARACTER_TO_MATCH;

  17635   0 0004DA  ECC7 0004                            LDB,B6   @QCD@DE_EDIT,AUTO
          0 0004DC  B847 0038                            LDR,R3   RESULT_INDEX,AUTO
          0 0004DE  3E02                                 ADV,R3   2
          0 0004DF  E7B6                                 STH,R6   ,B6,R3

      718    17636    5                     RESULT_INDEX = RESULT_INDEX - 1;

  17636   0 0004E0  88C7 0038                            DEC      RESULT_INDEX,AUTO

      719    17637    5                   END;

      720    17638    4               INFORMATION_FIELD = INFORMATION_FIELD - 1;

  17638   0 0004E2  88C7 0031                            DEC      INFORMATION_FIELD,AUTO

      721    17639    4             END;

  17639   0 0004E4  C847 0031                            LDR,R4   INFORMATION_FIELD,AUTO
          0 0004E6  49C2                                 BNEZ,R4  s:17614,SPREL
          0 0004E7  0F81 00DA                            B        s:17745,PREL

      722    17640
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:88   
      723    17641    3           CASE ( %MVZA );

      724    17642    3             IF EF.ES

  17642   0 0004E9  89C7 0006                            CMZ      EF,AUTO
          0 0004EB  0801 FEA6                            BAL      s:17486,PREL

      725    17643    3             THEN
      726    17644    3               GOTO DO_MVC;
      727    17645    4             DO WHILE ( INFORMATION_FIELD ~= 0 );

  17645   0 0004ED  5901 00D4                            BEZ,R5   s:17745,PREL

      728    17646    4               IF CURRENT_SOURCE_INDEX < ENDING_SOURCE_INDEX

  17646   0 0004EF  E847 0032                            LDR,R6   CURRENT_SOURCE_INDEX,AUTO
          0 0004F1  E947 0033                            CMR,R6   ENDING_SOURCE_INDEX,AUTO
          0 0004F3  0881 0006                            BAGE     s:17650,PREL

      729    17647    4               THEN
      730    17648    4                 SOURCE_CHARACTER_TO_MATCH = %ASCBIN(' ');

  17648   0 0004F5  5C20                                 LDV,R5   32
          0 0004F6  D7C7 003A                            STH,R5   SOURCE_CHARACTER_TO_MATCH,AUTO
          0 0004F8  0F81 0008                            B        s:17651,PREL

      731    17649    4               ELSE
      732    17650    4                 SOURCE_CHARACTER_TO_MATCH = QI_1.OP.DATA_A$ (%QI#DE_EDIT) ->
             17650                          QI$UBYTE_A (CURRENT_SOURCE_INDEX);

  17650   0 0004FA  EC80 0000 0024  xsym                 LDB,B6   QI_1+36
          0 0004FD  B856                                 LDR,R3   R6
          0 0004FE  D2B6                                 LLH,R5   ,B6,R3
          0 0004FF  D7C7 003A                            STH,R5   SOURCE_CHARACTER_TO_MATCH,AUTO

      733    17651    4               CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:89   
  17651   0 000501  88C7 0032                            DEC      CURRENT_SOURCE_INDEX,AUTO

      734    17652    4               IF SOURCE_CHARACTER_TO_MATCH = EIT (2)

  17652   0 000503  E2C7 003A                            LLH,R6   SOURCE_CHARACTER_TO_MATCH,AUTO
          0 000505  D2C7 0009                            LLH,R5   EIT+2,AUTO
          0 000507  E955                                 CMR,R6   R5
          0 000508  0981 0006                            BNE      s:17656,PREL

      735    17653    4               THEN
      736    17654    4                 EF.ES_OFF = %SET;

  17654   0 00050A  8947 0006                            LBT,'4000'X       EF,AUTO
  17654   0 00050C       4000
          0 00050D  0F81 001B                            B        s:17670,PREL

      737    17655    4               ELSE
      738    17656    4                 IF ( SOURCE_CHARACTER_TO_MATCH < %ASCBIN('0') )

  17656   0 00050F  6D30                                 CMV,R6   48
          0 000510  0201 0009                            BL       s:17661,PREL
          0 000512  6D39                                 CMV,R6   57
          0 000513  0301 0006                            BG       s:17661,PREL
          0 000515  82C7 0006                            LB,'4000'X        EF,AUTO
          0 000517       4000
          0 000518  0581 0008                            BBF      s:17667,PREL

      739    17657    4                   OR ( SOURCE_CHARACTER_TO_MATCH > %ASCBIN('9') )
      740    17658    4                   OR EF.ES_OFF
      741    17659    4                 THEN
      742    17660    5                   DO;

      743    17661    5                     INFORMATION_FIELD = 1;

  17661   0 00051A  4C01                                 LDV,R4   1
          0 00051B  CF47 0031                            STR,R4   INFORMATION_FIELD,AUTO

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:90   
      744    17662    5                     CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX + 1;

  17662   0 00051D  8AC7 0032                            INC      CURRENT_SOURCE_INDEX,AUTO

      745    17663    5                   END;

  17663   0 00051F  0F81 0009                            B        s:17670,PREL

      746    17664    4                 ELSE
      747    17665    5                   DO;

      748    17666                          /* move it to temp */
      749    17667    5                     QCD@DE_EDIT.RESULT.DIGIT_A (RESULT_INDEX) =
             17667                              SOURCE_CHARACTER_TO_MATCH;

  17667   0 000521  ECC7 0004                            LDB,B6   @QCD@DE_EDIT,AUTO
          0 000523  B847 0038                            LDR,R3   RESULT_INDEX,AUTO
          0 000525  3E02                                 ADV,R3   2
          0 000526  E7B6                                 STH,R6   ,B6,R3

      750    17668    5                     RESULT_INDEX = RESULT_INDEX - 1;

  17668   0 000527  88C7 0038                            DEC      RESULT_INDEX,AUTO

      751    17669    5                   END;

      752    17670    4               INFORMATION_FIELD = INFORMATION_FIELD - 1;

  17670   0 000529  88C7 0031                            DEC      INFORMATION_FIELD,AUTO

      753    17671    4             END;

  17671   0 00052B  C847 0031                            LDR,R4   INFORMATION_FIELD,AUTO
          0 00052D  49C2                                 BNEZ,R4  s:17646,SPREL
          0 00052E  0F81 0093                            B        s:17745,PREL

      754    17672
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:91   
      755    17673    3           CASE ( %INSM );

      756    17674    4             DO WHILE ( INFORMATION_FIELD ~= 0 );

  17674   0 000530  5901 0091                            BEZ,R5   s:17745,PREL

      757    17675    4               IF CURRENT_SOURCE_INDEX < ENDING_SOURCE_INDEX

  17675   0 000532  E847 0032                            LDR,R6   CURRENT_SOURCE_INDEX,AUTO
          0 000534  E947 0033                            CMR,R6   ENDING_SOURCE_INDEX,AUTO
          0 000536  0881 0006                            BAGE     s:17679,PREL

      758    17676    4               THEN
      759    17677    4                 SOURCE_CHARACTER_TO_MATCH = %ASCBIN(' ');

  17677   0 000538  5C20                                 LDV,R5   32
          0 000539  D7C7 003A                            STH,R5   SOURCE_CHARACTER_TO_MATCH,AUTO
          0 00053B  0F81 0008                            B        s:17680,PREL

      760    17678    4               ELSE
      761    17679    4                 SOURCE_CHARACTER_TO_MATCH = QI_1.OP.DATA_A$ (%QI#DE_EDIT) ->
             17679                          QI$UBYTE_A (CURRENT_SOURCE_INDEX);

  17679   0 00053D  EC80 0000 0024  xsym                 LDB,B6   QI_1+36
          0 000540  B856                                 LDR,R3   R6
          0 000541  D2B6                                 LLH,R5   ,B6,R3
          0 000542  D7C7 003A                            STH,R5   SOURCE_CHARACTER_TO_MATCH,AUTO

      762    17680    4               IF SOURCE_CHARACTER_TO_MATCH = EIT (1)

  17680   0 000544  D2C7 003A                            LLH,R5   SOURCE_CHARACTER_TO_MATCH,AUTO
          0 000546  C2C7 0008                            LLH,R4   EIT+1,AUTO
          0 000548  D954                                 CMR,R5   R4
          0 000549  0981 0005                            BNE      s:17684,PREL

      763    17681    4               THEN
      764    17682    4                 CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:92   

  17682   0 00054B  88C7 0032                            DEC      CURRENT_SOURCE_INDEX,AUTO
          0 00054D  0F81 0008                            B        s:17688,PREL

      765    17683    4               ELSE
      766    17684    4                 IF ( EIT (1) ~= %ASCBIN(' ') )

  17684   0 00054F  4D20                                 CMV,R4   32
          0 000550  0981 008C                            BNE      s:17762,PREL
          0 000552  E947 003B                            CMR,R6   STARTING_SOURCE_INDEX,AUTO
          0 000554  0981 0088                            BNE      s:17762,PREL

      767    17685    4                   OR ( CURRENT_SOURCE_INDEX ~= STARTING_SOURCE_INDEX )
      768    17686    4                 THEN
      769    17687    4                   GOTO ABORT;
      770    17688    4               INFORMATION_FIELD = INFORMATION_FIELD - 1;

  17688   0 000556  88C7 0031                            DEC      INFORMATION_FIELD,AUTO

      771    17689    4             END;

  17689   0 000558  E847 0031                            LDR,R6   INFORMATION_FIELD,AUTO
          0 00055A  69D8                                 BNEZ,R6  s:17675,SPREL
          0 00055B  0F81 0066                            B        s:17745,PREL

      772    17690
      773    17691    3           CASE ( %ENF );

      774    17692    3             IF INFORMATION_FIELD_FLAG_BITS.ES_WAS_SET_BEFORE_THIS_ENF

  17692   0 00055D  82C7 0031                            LB,'0001'X        INFORMATION_FIELD,AUTO
  17692   0 00055F       0001
          0 000560  0581 0006                            BBF      s:17696,PREL

      775    17693    3             THEN
      776    17694    3               EF.ES = %SET;

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:93   
  17694   0 000562  8947 0006                            LBT,'8000'X       EF,AUTO
  17694   0 000564       8000
          0 000565  0F81 0004                            B        s:17697,PREL

      777    17695    3             ELSE
      778    17696    3               EF.ES = %RESET;

  17696   0 000567  8847 0006                            LBF,'8000'X       EF,AUTO
  17696   0 000569       8000

      779    17697    3             EF.ES_OFF = %RESET;

  17697   0 00056A  8847 0006                            LBF,'4000'X       EF,AUTO
  17697   0 00056C       4000

      780    17698    3             SOURCE_CHARACTER_TO_MATCH = QI_1.OP.DATA_A$ (%QI#DE_EDIT) -> QI$UBYTE_A (
             17698                      CURRENT_SOURCE_INDEX);

  17698   0 00056D  EC80 0000 0024  xsym                 LDB,B6   QI_1+36
          0 000570  9847 0032                            LDR,R1   CURRENT_SOURCE_INDEX,AUTO
          0 000572  C296                                 LLH,R4   ,B6,R1
          0 000573  C7C7 003A                            STH,R4   SOURCE_CHARACTER_TO_MATCH,AUTO

      781    17699    3             IF SOURCE_CHARACTER_TO_MATCH = EIT (5)  /* '$' */

  17699   0 000575  E2C7 003A                            LLH,R6   SOURCE_CHARACTER_TO_MATCH,AUTO
          0 000577  D2C7 000C                            LLH,R5   EIT+5,AUTO
          0 000579  E955                                 CMR,R6   R5
          0 00057A  0981 0008                            BNE      s:17706,PREL

      782    17700    3             THEN
      783    17701    4               DO;

      784    17702    4                 EF.ES_OFF = %SET;

  17702   0 00057C  8947 0006                            LBT,'4000'X       EF,AUTO
  17702   0 00057E       4000
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:94   

      785    17703    4                 CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;

  17703   0 00057F  88C7 0032                            DEC      CURRENT_SOURCE_INDEX,AUTO

      786    17704    4               END;

  17704   0 000581  0F81 0040                            B        s:17745,PREL

      787    17705    3             ELSE
      788    17706    3               IF SOURCE_CHARACTER_TO_MATCH = EIT (4)  /* '-' */

  17706   0 000583  D2C7 000B                            LLH,R5   EIT+4,AUTO
          0 000585  E955                                 CMR,R6   R5
          0 000586  0981 0010                            BNE      s:17717,PREL

      789    17707    3               THEN
      790    17708    4                 DO;

      791    17709    4                   EF.SN = %SET;

  17709   0 000588  8947 0006                            LBT,'2000'X       EF,AUTO
  17709   0 00058A       2000

      792    17710    4                   IF EF.SP

  17710   0 00058B  82C7 0006                            LB,'1000'X        EF,AUTO
  17710   0 00058D       1000
          0 00058E  0501 0053                            BBT      s:17767,PREL

      793    17711    4                   THEN
      794    17712    4                     GOTO ABORT_SIGN;
      795    17713    4                   EF.ES_OFF = %SET;

  17713   0 000590  8947 0006                            LBT,'4000'X       EF,AUTO
  17713   0 000592       4000

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:95   
      796    17714    4                   CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;

  17714   0 000593  88C7 0032                            DEC      CURRENT_SOURCE_INDEX,AUTO

      797    17715    4                 END;

  17715   0 000595  0F81 002C                            B        s:17745,PREL

      798    17716    3               ELSE
      799    17717    3                 IF SOURCE_CHARACTER_TO_MATCH = EIT (3)  /* '+' */

  17717   0 000597  D2C7 000A                            LLH,R5   EIT+3,AUTO
          0 000599  E955                                 CMR,R6   R5
          0 00059A  0981 0015                            BNE      s:17731,PREL

      800    17718    3                 THEN
      801    17719    4                   DO;

      802    17720    4                     EF.SP = %SET;

  17720   0 00059C  8947 0006                            LBT,'1000'X       EF,AUTO
  17720   0 00059E       1000

      803    17721    4                     IF EF.SN

  17721   0 00059F  82C7 0006                            LB,'2000'X        EF,AUTO
  17721   0 0005A1       2000
          0 0005A2  0501 003F                            BBT      s:17767,PREL

      804    17722    4                     THEN
      805    17723    4                       GOTO ABORT_SIGN;
      806    17724    4                     IF NOT EF.PM

  17724   0 0005A4  82C7 0006                            LB,'0200'X        EF,AUTO
  17724   0 0005A6       0200
          0 0005A7  0581 0035                            BBF      s:17762,PREL

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:96   
      807    17725    4                     THEN
      808    17726    4                       GOTO ABORT;
      809    17727    4                     EF.ES_OFF = %SET;

  17727   0 0005A9  8947 0006                            LBT,'4000'X       EF,AUTO
  17727   0 0005AB       4000

      810    17728    4                     CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;

  17728   0 0005AC  88C7 0032                            DEC      CURRENT_SOURCE_INDEX,AUTO

      811    17729    4                   END;

  17729   0 0005AE  0F81 0013                            B        s:17745,PREL

      812    17730    3                 ELSE
      813    17731    3                   IF SOURCE_CHARACTER_TO_MATCH = EIT (1)  /* ' ' */

  17731   0 0005B0  D2C7 0008                            LLH,R5   EIT+1,AUTO
          0 0005B2  E955                                 CMR,R6   R5
          0 0005B3  0981 000E                            BNE      s:17745,PREL

      814    17732    3                   THEN
      815    17733    4                     DO;

      816    17734    4                       EF.SP = %SET;

  17734   0 0005B5  8947 0006                            LBT,'1000'X       EF,AUTO
  17734   0 0005B7       1000

      817    17735    4                       IF EF.SN

  17735   0 0005B8  82C7 0006                            LB,'2000'X        EF,AUTO
  17735   0 0005BA       2000
          0 0005BB  0501 0026                            BBT      s:17767,PREL

      818    17736    4                       THEN
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:97   
      819    17737    4                         GOTO ABORT_SIGN;
      820    17738    4                       EF.ES_OFF = %SET;

  17738   0 0005BD  8947 0006                            LBT,'4000'X       EF,AUTO
  17738   0 0005BF       4000

      821    17739    4                       CURRENT_SOURCE_INDEX = CURRENT_SOURCE_INDEX - 1;

  17739   0 0005C0  88C7 0032                            DEC      CURRENT_SOURCE_INDEX,AUTO

      822    17740    4                     END;

      823    17741
      824    17742    3         END;  /* of DO CASE ( OPERATION ) */

      825    17743
      826    17744
      827    17745    2       END;  /* of main loop */

  17745   0 0005C2  E847 0035                            LDR,R6   NEW_MOP_STRING_INDEX,AUTO
          0 0005C4  6881 FC06                            BGEZ,R6  s:17254,PREL

      828    17746
      829    17747
      830    17748    1       IF EF.SN                 /* negative? */

  17748   0 0005C6  82C7 0006                            LB,'2000'X        EF,AUTO
  17748   0 0005C8       2000
          0 0005C9  0581 0006                            BBF      s:17752,PREL

      831    17749    1       THEN
      832    17750    1         QCD@DE_EDIT.RESULT.DIGIT_A (0) = %ASCBIN('-');

  17750   0 0005CB  5C2D                                 LDV,R5   45
          0 0005CC  ECC7 0004                            LDB,B6   @QCD@DE_EDIT,AUTO
          0 0005CE  D7C6 0001                            STH,R5   1,B6

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:98   
      833    17751
      834    17752    1       IF CURRENT_SOURCE_INDEX >= ENDING_SOURCE_INDEX

  17752   0 0005D0  D847 0032                            LDR,R5   CURRENT_SOURCE_INDEX,AUTO
          0 0005D2  D947 0033                            CMR,R5   ENDING_SOURCE_INDEX,AUTO
          0 0005D4  0801 0005                            BAL      s:17758,PREL

      835    17753    1       THEN
      836    17754              /* "Garbage at left end of number..." */
      837    17755    1         QCD@DE_EDIT.IS_NUMBER_INVALID = %YES;

  17755   0 0005D6  ECC7 0004                            LDB,B6   @QCD@DE_EDIT,AUTO
          0 0005D8  8906                                 LBT,'8000'X       ,B6
          0 0005D9       8000

      838    17756
      839    17757    1   SUCCEED:
      840    17758    1       RETURN;

  17758   0 0005DA  C380 0000 0000  xent SUCCEED         LNJ,B4   X6A_ARET

      841    17759
      842    17760    1   ABORT:
      843    17761            /* "Bad value in QI$MOVDE..." */
      844    17762    1       QCD@DE_EDIT.IS_NUMBER_INVALID = %YES;

  17762   0 0005DD  ECC7 0004            ABORT           LDB,B6   @QCD@DE_EDIT,AUTO
          0 0005DF  8906                                 LBT,'8000'X       ,B6
          0 0005E0       8000

      845    17763    1       GOTO SUCCEED;

  17763   0 0005E1  0FF9                                 B        s:17758,SPREL

      846    17764
      847    17765    1   ABORT_SIGN:
      848    17766            /* "Contradictory sign information..." */
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:99   
      849    17767    1       QCD@DE_EDIT.IS_NUMBER_INVALID = %YES;

  17767   0 0005E2  ECC7 0004            ABORT_SIGN      LDB,B6   @QCD@DE_EDIT,AUTO
          0 0005E4  8906                                 LBT,'8000'X       ,B6
          0 0005E5       8000

      850    17768    1       GOTO SUCCEED;

  17768   0 0005E6  0FF4                                 B        s:17758,SPREL
      851    17769
      852    17770
      853    17771
      854    17772    1   END QCD$DE_EDIT;

PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:100  
--  Include file information  --

   QCD_DE_EDIT_M.:E05TOU  is referenced.
   QI_MACROS_M.:E05TOU  is referenced.
   QI_EQUATES_E.:E05TOU  is referenced.
   QG_MACRO_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QCD$DE_EDIT.
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:101  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @QCD@DE_EDIT              32-0-0/w SBIN(16)    r     1 CURRENT_SOURCE_INDEX
     6-0-0/b STRC(7)     r     1 EF                         7-0-0/w UBIN(8)     r     1 EIT(0:8)
    33-0-0/w SBIN(16)    r     1 ENDING_SOURCE_INDEX       31-0-0/w SBIN(16)    r     1 INFORMATION_FIELD
    31-0-0/w STRC(16)    r     1 INFORMATION_FIELD_FLAG_BITS
    2F-0-0/w UBIN(8)     r     1 MOP                       10-0-0/b UBIN(8)     r     1 MOP_A(0:60)
    2F-0-0/w STRC(8)     r     1 MOP_ITEM
    10-0-0/b STRC(8)     r     1 MOP_ITEM_A(0:60)
    34-0-0/w SBIN(16)    r     1 MOP_STRING_INDEX          35-0-0/w SBIN(16)    r     1 NEW_MOP_STRING_INDEX
    30-0-0/w UBIN(16)    r     1 OPERATION                 36-0-0/w PTR         r     1 PIC$
    *0-0-0/w STRC(304)   r     1 QCD@DE_EDIT               38-0-0/w SBIN(16)    r     1 RESULT_INDEX
    39-0-0/w BIT         r     1 SAVE_ES_FLAG
    3A-0-0/w UBIN(8)     r     1 SOURCE_CHARACTER_TO_MATCH
    3B-0-0/w SBIN(16)    r     1 STARTING_SOURCE_INDEX
    3C-0-0/w SBIN(16)    r     1 TEMP_SOURCE_INDEX
    3D-0-0/w BIT         r     1 WEVE_ENCOUNTERED_A_DECIMAL

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(2576)  r     1 QI_1

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(32)    r     1 QI$NUMERIC_PICTURE_STRING
     0-0-0/c UBIN(8)     r     1 QI$UBYTE_A(0:0)
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:102  
     0-0-0/c ASTR(8)     r     1 QI$VARIABLE_IDENTIFIER


   Procedure QCD$DE_EDIT requires 1511 words for executable code.
   Procedure QCD$DE_EDIT requires 62 words of local(AUTO) storage.

    No errors detected in file QCD$DE_EDIT.:E05TSI    .
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:103  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:104  
          MINI XREF LISTING

ABORT
     17762**LABEL   17177--GOTO    17207--GOTO    17332--GOTO    17354--GOTO    17360--GOTO    17419--GOTO
     17423--GOTO    17484--GOTO    17493--GOTO    17539--GOTO    17582--GOTO    17602--GOTO    17687--GOTO
     17726--GOTO
ABORT_SIGN
     17767**LABEL   17369--GOTO    17383--GOTO    17394--GOTO    17406--GOTO    17416--GOTO    17435--GOTO
     17445--GOTO    17455--GOTO    17471--GOTO    17480--GOTO    17566--GOTO    17579--GOTO    17712--GOTO
     17723--GOTO    17737--GOTO
CURRENT_SOURCE_INDEX
     17051**DCL     17067<<ASSIGN  17187<<ASSIGN  17191>>DOWHILE 17191>>DOWHILE 17193<<ASSIGN  17193>>ASSIGN
     17196>>ASSIGN  17276>>IF      17280>>ASSIGN  17318<<ASSIGN  17318>>ASSIGN  17324<<ASSIGN  17324>>ASSIGN
     17328>>IF      17338<<ASSIGN  17338>>ASSIGN  17344<<ASSIGN  17344>>ASSIGN  17348>>IF      17370<<ASSIGN
     17370>>ASSIGN  17384<<ASSIGN  17384>>ASSIGN  17390<<ASSIGN  17390>>ASSIGN  17397>>IF      17431<<ASSIGN
     17431>>ASSIGN  17441<<ASSIGN  17441>>ASSIGN  17451<<ASSIGN  17451>>ASSIGN  17460<<ASSIGN  17460>>ASSIGN
     17462>>IF      17489>>ASSIGN  17499<<ASSIGN  17499>>ASSIGN  17509>>IF      17513>>ASSIGN  17514<<ASSIGN
     17514>>ASSIGN  17533<<ASSIGN  17533>>ASSIGN  17552>>IF      17556>>ASSIGN  17557<<ASSIGN  17557>>ASSIGN
     17595<<ASSIGN  17595>>ASSIGN  17614>>IF      17618>>ASSIGN  17619<<ASSIGN  17619>>ASSIGN  17630<<ASSIGN
     17630>>ASSIGN  17646>>IF      17650>>ASSIGN  17651<<ASSIGN  17651>>ASSIGN  17662<<ASSIGN  17662>>ASSIGN
     17675>>IF      17679>>ASSIGN  17682<<ASSIGN  17682>>ASSIGN  17684>>IF      17698>>ASSIGN  17703<<ASSIGN
     17703>>ASSIGN  17714<<ASSIGN  17714>>ASSIGN  17728<<ASSIGN  17728>>ASSIGN  17739<<ASSIGN  17739>>ASSIGN
     17752>>IF
DO_MVC
     17488**LABEL   17506--GOTO    17549--GOTO    17612--GOTO    17644--GOTO
EF
     17000**DCL     17065<<ASSIGN
EF.AZ
     17009**DCL     17108<<ASSIGN  17221>>IF
EF.BZ
     17008**DCL     17111<<ASSIGN  17166<<ASSIGN  17203>>IF
EF.ES
     17001**DCL     17114>>IF      17119<<ASSIGN  17121<<ASSIGN  17159>>IF      17163<<ASSIGN  17305<<ASSIGN
     17307<<ASSIGN  17320>>IF      17328>>IF      17340>>IF      17351>>IF      17357>>IF      17504>>IF
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:105  
     17547>>IF      17610>>IF      17642>>IF      17694<<ASSIGN  17696<<ASSIGN
EF.ES_OFF
     17004**DCL     17308<<ASSIGN  17315>>IF      17325<<ASSIGN  17328>>IF      17335>>IF      17345<<ASSIGN
     17351>>IF      17507>>DOWHILE 17515>>IF      17519<<ASSIGN  17525<<ASSIGN  17527>>IF      17550>>DOWHILE
     17558>>IF      17562<<ASSIGN  17570>>IF      17574<<ASSIGN  17587<<ASSIGN  17589>>IF      17622<<ASSIGN
     17624>>IF      17654<<ASSIGN  17656>>IF      17697<<ASSIGN  17702<<ASSIGN  17713<<ASSIGN  17727<<ASSIGN
     17738<<ASSIGN
EF.PM
     17010**DCL     17105<<ASSIGN  17302<<ASSIGN  17426>>IF      17580>>IF      17724>>IF
EF.SN
     17006**DCL     17366<<ASSIGN  17381>>IF      17392>>IF      17403<<ASSIGN  17414>>IF      17433>>IF
     17442<<ASSIGN  17453>>IF      17469>>IF      17477<<ASSIGN  17563<<ASSIGN  17577>>IF      17709<<ASSIGN
     17721>>IF      17735>>IF      17748>>IF
EF.SP
     17007**DCL     17367>>IF      17380<<ASSIGN  17391<<ASSIGN  17404>>IF      17413<<ASSIGN  17432<<ASSIGN
     17443>>IF      17452<<ASSIGN  17468<<ASSIGN  17478>>IF      17564>>IF      17575<<ASSIGN  17710>>IF
     17720<<ASSIGN  17734<<ASSIGN
EIT
     17012**DCL     17072<<ASSIGN  17073<<ASSIGN  17074<<ASSIGN  17075<<ASSIGN  17076<<ASSIGN  17077<<ASSIGN
     17078<<ASSIGN  17079<<ASSIGN  17128>>ASSIGN  17130<<ASSIGN  17228>>IF      17233>>IF      17274>>ASSIGN
     17311<<ASSIGN  17320>>IF      17328>>IF      17340>>IF      17351>>IF      17387>>IF      17410>>IF
     17428>>IF      17438>>IF      17458>>IF      17474>>IF      17515>>IF      17523>>IF      17558>>IF
     17570>>IF      17585>>IF      17620>>IF      17652>>IF      17680>>IF      17684>>IF      17699>>IF
     17706>>IF      17717>>IF      17731>>IF
ENDING_SOURCE_INDEX
     17052**DCL     17211<<ASSIGN  17213>>DOWHILE 17213>>DOWHILE 17215<<ASSIGN  17215>>ASSIGN  17218>>ASSIGN
     17226>>DOWHILE 17276>>IF      17509>>IF      17552>>IF      17614>>IF      17646>>IF      17675>>IF
     17752>>IF
INFORMATION_FIELD
     17042**DCL     17043--REDEF   17098<<ASSIGN  17128>>ASSIGN  17130>>ASSIGN  17131>>ASSIGN  17138>>IF
     17257<<ASSIGN  17267>>IF      17270<<ASSIGN  17274<<ASSIGN  17274>>ASSIGN  17285>>IF      17294<<ASSIGN
     17311>>ASSIGN  17315>>IF      17328>>IF      17335>>IF      17351>>IF      17357>>IF      17363>>IF
     17376>>IF      17400>>IF      17448>>IF      17465>>IF      17488>>DOWHILE 17500<<ASSIGN  17500>>ASSIGN
     17507>>DOWHILE 17507>>DOWHILE 17520<<ASSIGN  17520>>ASSIGN  17532<<ASSIGN  17537>>IF      17543<<ASSIGN
     17543>>ASSIGN  17550>>DOWHILE 17550>>DOWHILE 17567<<ASSIGN  17567>>ASSIGN  17576<<ASSIGN  17576>>ASSIGN
     17594<<ASSIGN  17600>>IF      17606<<ASSIGN  17606>>ASSIGN  17613>>DOWHILE 17629<<ASSIGN  17638<<ASSIGN
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:106  
     17638>>ASSIGN  17645>>DOWHILE 17661<<ASSIGN  17670<<ASSIGN  17670>>ASSIGN  17674>>DOWHILE 17688<<ASSIGN
     17688>>ASSIGN
INFORMATION_FIELD_FLAG_BITS.AZ
     17047**DCL     17106>>IF
INFORMATION_FIELD_FLAG_BITS.BZ
     17046**DCL     17109>>IF      17164>>IF
INFORMATION_FIELD_FLAG_BITS.ES
     17045**DCL     17112>>ASSIGN  17303>>IF
INFORMATION_FIELD_FLAG_BITS.ES_WAS_SET_BEFORE_THIS_ENF
     17049**DCL     17692>>IF
INFORMATION_FIELD_FLAG_BITS.PM
     17048**DCL     17049--REDEF   17103>>IF      17300>>IF
MOP
     17034**DCL     17096<<ASSIGN  17122>>ASSIGN  17144>>ASSIGN  17254<<ASSIGN
MOP_A
     17023**DCL     17122<<ASSIGN  17128<<ASSIGN  17131<<ASSIGN  17142<<ASSIGN  17144<<ASSIGN  17149<<ASSIGN
     17154<<ASSIGN  17158<<ASSIGN  17173<<ASSIGN  17254>>ASSIGN  17270>>ASSIGN  17311>>ASSIGN
MOP_ITEM
     17025**DCL     17034--REDEF
MOP_ITEM.INFORMATION_FIELD
     17027**DCL     17028--REDEF   17098>>ASSIGN  17257>>ASSIGN
MOP_ITEM.INFORMATION_FIELD_FLAG_BITS.ES
     17029**DCL     17113<<ASSIGN  17116<<ASSIGN
MOP_ITEM.INFORMATION_FIELD_FLAG_BITS.PM
     17032**DCL     17033--REDEF
MOP_ITEM.OPERATION
     17026**DCL     17097>>ASSIGN  17256>>ASSIGN
MOP_ITEM_A
     17014**DCL     17023--REDEF   17066<<ASSIGN
MOP_ITEM_A.INFORMATION_FIELD
     17016**DCL     17017--REDEF
MOP_ITEM_A.INFORMATION_FIELD_FLAG_BITS.ES_WAS_SET_BEFORE_THIS_ENF
     17022**DCL     17161<<ASSIGN
MOP_ITEM_A.INFORMATION_FIELD_FLAG_BITS.PM
     17021**DCL     17022--REDEF
MOP_STRING_INDEX
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:107  
     17053**DCL     17094<<DOINDEX 17096>>ASSIGN  17126<<ASSIGN  17126>>ASSIGN  17127>>ASSIGN  17141<<ASSIGN
     17141>>ASSIGN  17142>>ASSIGN  17149>>ASSIGN  17154>>ASSIGN  17158>>ASSIGN  17173>>ASSIGN
NEW_MOP_STRING_INDEX
     17054**DCL     17092<<ASSIGN  17122>>ASSIGN  17123<<ASSIGN  17123>>ASSIGN  17128>>ASSIGN  17129<<ASSIGN
     17129>>ASSIGN  17131>>ASSIGN  17132<<ASSIGN  17132>>ASSIGN  17142>>ASSIGN  17143<<ASSIGN  17143>>ASSIGN
     17144>>ASSIGN  17145<<ASSIGN  17145>>ASSIGN  17149>>ASSIGN  17150<<ASSIGN  17150>>ASSIGN  17154>>ASSIGN
     17155<<ASSIGN  17155>>ASSIGN  17158>>ASSIGN  17161>>ASSIGN  17162<<ASSIGN  17162>>ASSIGN  17173>>ASSIGN
     17174<<ASSIGN  17174>>ASSIGN  17184<<ASSIGN  17184>>ASSIGN  17252>>DOWHILE 17254>>ASSIGN  17255<<ASSIGN
     17255>>ASSIGN  17270>>ASSIGN  17271<<ASSIGN  17271>>ASSIGN  17311>>ASSIGN  17312<<ASSIGN  17312>>ASSIGN
NOT_AZ
     17252**LABEL   17238--GOTO    17243--GOTO
OPERATION
     17041**DCL     17097<<ASSIGN  17100>>DOCASE  17127<<ASSIGN  17130>>ASSIGN  17256<<ASSIGN  17260>>IF
     17260>>IF      17260>>IF      17260>>IF      17285>>IF      17285>>IF      17285>>IF      17285>>IF
     17285>>IF      17285>>IF      17297>>DOCASE
PIC$
     17055**DCL     17063<<ASSIGN  17089>>ASSIGN  17094>>DOINDEX 17096>>ASSIGN  17127>>ASSIGN  17142>>ASSIGN
     17149>>ASSIGN  17154>>ASSIGN  17158>>ASSIGN  17173>>ASSIGN
QCD@DE_EDIT
     16975**DCL        23--PROC    17070<<ASSIGN
QCD@DE_EDIT.IS_NUMBER_INVALID
     16976**DCL     17755<<ASSIGN  17762<<ASSIGN  17767<<ASSIGN
QCD@DE_EDIT.RESULT.DEC
     16983**DCL     17089<<ASSIGN
QCD@DE_EDIT.RESULT.DIGIT_A
     16980**DCL     17082<<ASSIGN  17087<<ASSIGN  17496<<ASSIGN  17540<<ASSIGN  17603<<ASSIGN  17635<<ASSIGN
     17667<<ASSIGN  17750<<ASSIGN
QCD@DE_EDIT.RESULT.INPUT_SIZE
     16985**DCL     17202<<ASSIGN  17218<<ASSIGN
QGB_PARAM.DVE.DVBYTE.VFC
     11396**DCL     11397--REDEF
QGB_PARAM.DVE.EOMCHAR
     11408**DCL     11409--REDEF
QGB_PARAM.MSG$
     11390**DCL     11391--REDEF
QGB_PARAM.UHDR$
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:108  
     11415**DCL     11416--REDEF
QI$ACTIVATION_STATUS
      9154**DCL      9160--REDEF
QI$CIP
      7995**DCL      8065--REDEF
QI$CIP.CA
      8000**DCL      8004--REDEF    8007--REDEF    8010--REDEF
QI$COBOL_DAD.PSEUDO_CIP
      8239**DCL      8264--REDEF
QI$COBOL_DAD.PSEUDO_CIP.ALPHANUMERIC
      8241**DCL      8246--REDEF
QI$COBOL_DAD.PSEUDO_CIP.NUMERIC.CB
      8247**DCL      8250--REDEF    8253--REDEF
QI$COBOL_DAD.VARIABLE_LENGTH_ITEMS
      8275**DCL      8291--REDEF    8299--REDEF    8307--REDEF
QI$COBOL_DAD.VARIABLE_LENGTH_ITEMS.LEVEL_MULTIPLIERS
      8276**DCL      8286--REDEF    8289--REDEF
QI$COBOL_DAD.WORD0
      8203**DCL      8204--REDEF    8218--REDEF
QI$COBOL_DAD_P_BITS.P
      8343**DCL      8349--REDEF
QI$CONDITION_CONTROL_BLOCK.LIST_A@P
      7829**DCL      7830--REDEF
QI$CONDITION_CONTROL_BLOCK.WORD0_FLAGS
      7825**DCL      7828--REDEF
QI$CONDITION_LEGAL_BLOCK.ARRAY@P
      7862**DCL      7863--REDEF    7864--REDEF
QI$DAD.PSEUDO_CIP
      8142**DCL      8167--REDEF
QI$DAD.PSEUDO_CIP.ALPHANUMERIC
      8144**DCL      8149--REDEF
QI$DAD.PSEUDO_CIP.NUMERIC.CB
      8150**DCL      8153--REDEF    8156--REDEF
QI$DAD.WORD0
      8111**DCL      8112--REDEF
QI$ERROR_MESSAGE_LINE
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:109  
     11503**DCL     11505--REDEF
QI$ERROR_STATUS
     11500**DCL     11502--REDEF
QI$FIELD_DAD.ELEMENTARY_ITEM.P
      8557**DCL      8564--REDEF
QI$FIELD_DAD.ONE_DIMENSIONAL_ITEM.P
      8577**DCL      8584--REDEF
QI$FIELD_DAD.PSEUDO_CIP
      8484**DCL      8509--REDEF
QI$FIELD_DAD.PSEUDO_CIP.ALPHANUMERIC
      8486**DCL      8491--REDEF
QI$FIELD_DAD.PSEUDO_CIP.NUMERIC.CB
      8492**DCL      8495--REDEF    8498--REDEF
QI$FIELD_DAD.TWO_DIMENSIONAL_ITEM.P
      8597**DCL      8604--REDEF
QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS
      8540**DCL      8556--REDEF    8574--REDEF    8592--REDEF
QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS.LEVEL_MULTIPLIERS
      8541**DCL      8551--REDEF    8554--REDEF
QI$FIELD_DAD.WORD0
      8436**DCL      8437--REDEF
QI$FIELD_DAD.WORD0_FLAGS.IO_FLAGS
      8440**DCL      8445--REDEF
QI$FIELD_DAD_P.P
      8638**DCL      8645--REDEF
QI$FIELD_STATUS.INDICATORS
      9304**DCL      9336--REDEF
QI$FIELD_STATUS.INDICATORS.ENABLED_FLAGS
      9308**DCL      9313--REDEF
QI$FIELD_STATUS.INDICATORS.OPEN_FLAGS
      9320**DCL      9327--REDEF
QI$FIELD_STATUS.INDICATORS.STATE_FLAGS
      9314**DCL      9319--REDEF
QI$FILE.WORD0
      8760**DCL      8761--REDEF
QI$FILE_STATUS.INDICATORS
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:110  
      9597**DCL      9629--REDEF
QI$FILE_STATUS.INDICATORS.ENABLED_FLAGS
      9601**DCL      9606--REDEF
QI$FILE_STATUS.INDICATORS.OPEN_FLAGS
      9613**DCL      9620--REDEF
QI$FILE_STATUS.INDICATORS.STATE_FLAGS
      9607**DCL      9612--REDEF
QI$FORM_FILE.USE_PROCEDURE
      8860**DCL      8867--REDEF
QI$FORM_FILE.WORD0
      8814**DCL      8815--REDEF
QI$FORM_STATUS.INDICATORS
      9718**DCL      9750--REDEF
QI$FORM_STATUS.INDICATORS.ENABLED_FLAGS
      9722**DCL      9727--REDEF
QI$FORM_STATUS.INDICATORS.OPEN_FLAGS
      9734**DCL      9741--REDEF
QI$FORM_STATUS.INDICATORS.STATE_FLAGS
      9728**DCL      9733--REDEF
QI$FRAME.WORD0
      8975**DCL      8976--REDEF
QI$FRAME_STATUS.INDICATORS
      9947**DCL      9979--REDEF
QI$FRAME_STATUS.INDICATORS.ENABLED_FLAGS
      9951**DCL      9956--REDEF
QI$FRAME_STATUS.INDICATORS.OPEN_FLAGS
      9963**DCL      9970--REDEF
QI$FRAME_STATUS.INDICATORS.STATE_FLAGS
      9957**DCL      9962--REDEF
QI$GZ_FIELD.DESCRIPTION.IO_FLAGS
     16829**DCL     16834--REDEF
QI$IDENTIFIER
     11506**DCL     11508--REDEF
QI$INDICATORS
      9218**DCL      9248--REDEF
QI$INDICATORS.ENABLED_FLAGS
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:111  
      9224**DCL      9229--REDEF
QI$INDICATORS.OPEN_FLAGS
      9236**DCL      9243--REDEF
QI$INDICATORS.STATE_FLAGS
      9230**DCL      9235--REDEF
QI$MAJOR_NODE.WORD0
      8674**DCL      8675--REDEF
QI$MAJOR_STATUS.INDICATORS
      9397**DCL      9429--REDEF
QI$MAJOR_STATUS.INDICATORS.ENABLED_FLAGS
      9401**DCL      9406--REDEF
QI$MAJOR_STATUS.INDICATORS.OPEN_FLAGS
      9413**DCL      9420--REDEF
QI$MAJOR_STATUS.INDICATORS.STATE_FLAGS
      9407**DCL      9412--REDEF
QI$MESSAGE_TYPE
     11497**DCL     11499--REDEF
QI$MINOR_NODE.WORD0
      8717**DCL      8718--REDEF
QI$MINOR_STATUS.INDICATORS
      9490**DCL      9522--REDEF
QI$MINOR_STATUS.INDICATORS.ENABLED_FLAGS
      9494**DCL      9499--REDEF
QI$MINOR_STATUS.INDICATORS.OPEN_FLAGS
      9506**DCL      9513--REDEF
QI$MINOR_STATUS.INDICATORS.STATE_FLAGS
      9500**DCL      9505--REDEF
QI$NUMERIC_PICTURE_STRING.DECIMAL_SCALING
      9049**DCL     17089>>ASSIGN
QI$NUMERIC_PICTURE_STRING.MOP_STRING_A
      9051**DCL     17096>>ASSIGN  17127>>ASSIGN  17142>>ASSIGN  17149>>ASSIGN  17154>>ASSIGN  17158>>ASSIGN
     17173>>ASSIGN
QI$NUMERIC_PICTURE_STRING.MOP_STRING_COUNT
      9050**DCL     17094>>DOINDEX
QI$OP_ACCEPT.DATANAME@P
      5905**DCL      5906--REDEF
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:112  
QI$OP_CALL.EPTR$
      6077**DCL      6078--REDEF
QI$OP_CLEAR.IO_FLAGS
      6110**DCL      6113--REDEF
QI$OP_DISPLAY.FIELD_A@P
      6377**DCL      6378--REDEF
QI$OP_ENABLE.IO_FLAGS
      6464**DCL      6467--REDEF
QI$OP_IFCLS.ATTRIBUTE.TYPE
      6557**DCL      6562--REDEF
QI$OP_INSPECT.TALLYING_FOR_ITEM@P
      6791**DCL      6792--REDEF
QI$OP_INSPECT.TALLYING_INITIAL_ITEM@P
      6793**DCL      6794--REDEF
QI$OP_INSPECT.TALLYING_ITEM@P
      6789**DCL      6790--REDEF
QI$OP_OPEN.IO_FLAGS
      7351**DCL      7354--REDEF
QI$OP_PERFM.BINARY_ITERATION_COUNT@P
      7389**DCL      7390--REDEF
QI$PSEUDO_CIP
      7890**DCL      7914--REDEF
QI$PSEUDO_CIP.ALPHANUMERIC
      7894**DCL      7899--REDEF
QI$PSEUDO_CIP.NUMERIC.CB
      7900**DCL      7903--REDEF    7906--REDEF
QI$TERMINAL_ATTRIBUTES
      9111**DCL      9124--REDEF
QI$TRAN_FILE.WORD0
      8896**DCL      8897--REDEF
QI$TRAN_STATUS.INDICATORS
      9831**DCL      9863--REDEF
QI$TRAN_STATUS.INDICATORS.ENABLED_FLAGS
      9835**DCL      9840--REDEF
QI$TRAN_STATUS.INDICATORS.OPEN_FLAGS
      9847**DCL      9854--REDEF
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:113  
QI$TRAN_STATUS.INDICATORS.STATE_FLAGS
      9841**DCL      9846--REDEF
QI$UBYTE_A
     11491**DCL     17191>>DOWHILE 17213>>DOWHILE 17227>>ASSIGN  17280>>ASSIGN  17489>>ASSIGN  17513>>ASSIGN
     17556>>ASSIGN  17618>>ASSIGN  17650>>ASSIGN  17679>>ASSIGN  17698>>ASSIGN
QI$VARIABLE_IDENTIFIER.LENGTH
     11510**DCL     11511--IMP-SIZ
QI_1.BASE
     10039**DCL     10046--REDEF
QI_1.CURRENT.FILE$
     10930**DCL     10932--REDEF   10934--REDEF
QI_1.CURRENT.FILE_STATUS$
     10936**DCL     10938--REDEF   10940--REDEF
QI_1.DAD
     10734**DCL     10739--REDEF
QI_1.FILE_HEAD
     10917**DCL     10924--REDEF
QI_1.IS_ALL_LIT
     10740**DCL     10745--REDEF
QI_1.IS_FORM_VARIABLE
     10746**DCL     10751--REDEF
QI_1.IS_TEMP
     10752**DCL     10757--REDEF
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP
     10850**DCL     10875--REDEF
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP.ALPHANUMERIC
     10852**DCL     10857--REDEF
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP.NUMERIC.CB
     10858**DCL     10861--REDEF   10864--REDEF
QI_1.MESSAGE_LINE_DAD.WORD0
     10819**DCL     10820--REDEF
QI_1.OFFSET
     10758**DCL     10763--REDEF
QI_1.OFFSET_A
     10763**DCL     17187>>ASSIGN  17191>>DOWHILE 17199>>IF      17211>>ASSIGN
QI_1.OP.CIP
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:114  
     10119**DCL     10570--REDEF
QI_1.OP.CIP.AUX
     10485**DCL     10556--REDEF
QI_1.OP.CIP.AUX.CD
     10530**DCL     10533--REDEF   10537--REDEF   10540--REDEF
QI_1.OP.CIP.S
     10189**DCL     10260--REDEF
QI_1.OP.CIP.S.CD
     10234**DCL     10237--REDEF   10241--REDEF   10244--REDEF
QI_1.OP.CIP.T
     10337**DCL     10408--REDEF
QI_1.OP.CIP.T.CD
     10382**DCL     10385--REDEF   10389--REDEF   10392--REDEF
QI_1.OP.DATA
     10577**DCL     10581--REDEF
QI_1.OP.DATA_A$
     10581**DCL     17191>>DOWHILE 17213>>DOWHILE 17227>>ASSIGN  17280>>ASSIGN  17489>>ASSIGN  17513>>ASSIGN
     17556>>ASSIGN  17618>>ASSIGN  17650>>ASSIGN  17679>>ASSIGN  17698>>ASSIGN
QI_1.OP.FILL_CHAR
     10701**DCL     10704--REDEF
QI_1.OP.INX
     10634**DCL     10638--REDEF   10639--REDEF   10643--REDEF
QI_1.OP.LEN
     10617**DCL     10621--REDEF   10622--REDEF   10626--REDEF   10627--REDEF   10631--REDEF
QI_1.OP.LEN.AUX
     10620**DCL     11521--IMP-SIZ
QI_1.OP.LEN.S
     10618**DCL     11517--IMP-SIZ
QI_1.OP.LEN.T
     10619**DCL     11519--IMP-SIZ
QI_1.OP.LEN_A
     10621**DCL     17187>>ASSIGN
QI_1.OP.PICTURE_STRING
     10687**DCL     10690--REDEF   10691--REDEF   10694--REDEF   10695--REDEF   10698--REDEF
QI_1.OP.ROUND
     10720**DCL     10721--REDEF   10722--REDEF
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:115  
QI_1.OP.SRCH_VRFY_ELEMS
     10656**DCL     10659--REDEF
QI_1.OPENED_COUNT
     10925**DCL     10928--REDEF
QI_1.OTTER_SPACE
     10764**DCL     10769--REDEF
QI_1.PICTURE_STRING
     10770**DCL     10775--REDEF
QI_1.PICTURE_STRING_A$
     10775**DCL     17063>>ASSIGN
QI_1.SPECIAL_NAMES
     10953**DCL     10962--REDEF
QI_1.TYPE
     10776**DCL     10781--REDEF
QI_16_BIT_BINARY
     15966**DCL     16036--REDEF
QI_16_BIT_BINARY.CB
     15985**DCL     15988--REDEF   15992--REDEF   15995--REDEF
QI_31_DIGIT_SLS_DISPLAY
     15799**DCL     15869--REDEF
QI_31_DIGIT_SLS_DISPLAY.CD
     15846**DCL     15849--REDEF   15853--REDEF   15856--REDEF
QI_31_DIGIT_ST_PACKED
     16301**DCL     16371--REDEF
QI_31_DIGIT_ST_PACKED.CP
     16334**DCL     16337--REDEF   16341--REDEF   16344--REDEF
QI_32_BIT_BINARY
     16133**DCL     16203--REDEF
QI_32_BIT_BINARY.CB
     16152**DCL     16155--REDEF   16159--REDEF   16162--REDEF
QI_4_CHAR_ALPHANUMERIC
     15631**DCL     15701--REDEF
QI_4_CHAR_ALPHANUMERIC.CA
     15636**DCL     15640--REDEF   15643--REDEF   15646--REDEF
QI_ACCUMULATOR_DAD.CIP
     16644**DCL     16715--REDEF
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:116  
QI_ACCUMULATOR_DAD.CIP.CP
     16675**DCL     16678--REDEF   16682--REDEF   16685--REDEF
QI_ALR.CIP
     11596**DCL     12047--REDEF
QI_ALR.CIP.AUX
     11962**DCL     12033--REDEF
QI_ALR.CIP.AUX.CA
     11965**DCL     11969--REDEF   11972--REDEF   11975--REDEF
QI_ALR.CIP.S
     11666**DCL     11737--REDEF
QI_ALR.CIP.S.CA
     11669**DCL     11673--REDEF   11676--REDEF   11679--REDEF
QI_ALR.CIP.T
     11814**DCL     11885--REDEF
QI_ALR.CIP.T.CA
     11817**DCL     11821--REDEF   11824--REDEF   11827--REDEF
QI_ALR.DATA
     12054**DCL     12058--REDEF
QI_ALR.FILL_CHAR
     12178**DCL     12181--REDEF
QI_ALR.INX
     12111**DCL     12115--REDEF   12116--REDEF   12120--REDEF
QI_ALR.LEN
     12094**DCL     12098--REDEF   12099--REDEF   12103--REDEF   12104--REDEF   12108--REDEF
QI_ALR.PICTURE_STRING
     12164**DCL     12167--REDEF   12168--REDEF   12171--REDEF   12172--REDEF   12175--REDEF
QI_ALR.ROUND
     12197**DCL     12198--REDEF   12199--REDEF
QI_ALR.SRCH_VRFY_ELEMS
     12133**DCL     12136--REDEF
QI_MAT.CIP
     14935**DCL     15386--REDEF
QI_MAT.CIP.AUX
     15301**DCL     15372--REDEF
QI_MAT.CIP.AUX.CA
     15304**DCL     15308--REDEF   15311--REDEF   15314--REDEF
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:117  
QI_MAT.CIP.S
     15005**DCL     15076--REDEF
QI_MAT.CIP.S.CA
     15008**DCL     15012--REDEF   15015--REDEF   15018--REDEF
QI_MAT.CIP.T
     15153**DCL     15224--REDEF
QI_MAT.CIP.T.CA
     15156**DCL     15160--REDEF   15163--REDEF   15166--REDEF
QI_MAT.DATA
     15393**DCL     15397--REDEF
QI_MAT.DEC
     15461**DCL     15465--REDEF   15466--REDEF   15470--REDEF
QI_MAT.FILL_CHAR
     15517**DCL     15520--REDEF
QI_MAT.LEN
     15433**DCL     15437--REDEF   15438--REDEF   15442--REDEF   15443--REDEF   15447--REDEF
QI_MAT.PICTURE_STRING
     15503**DCL     15506--REDEF   15507--REDEF   15510--REDEF   15511--REDEF   15514--REDEF
QI_MAT.ROUND
     15536**DCL     15537--REDEF   15538--REDEF
QI_MAT.SRCH_VRFY_ELEMS
     15472**DCL     15475--REDEF
QI_PICTURE_STRING
     16469**DCL     16539--REDEF
QI_PICTURE_STRING.CA
     16474**DCL     16478--REDEF   16481--REDEF   16484--REDEF
QI_SRCH_VRFY.CIP
     14266**DCL     14717--REDEF
QI_SRCH_VRFY.CIP.AUX
     14632**DCL     14703--REDEF
QI_SRCH_VRFY.CIP.AUX.CA
     14635**DCL     14639--REDEF   14642--REDEF   14645--REDEF
QI_SRCH_VRFY.CIP.S
     14336**DCL     14407--REDEF
QI_SRCH_VRFY.CIP.S.CA
     14339**DCL     14343--REDEF   14346--REDEF   14349--REDEF
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:118  
QI_SRCH_VRFY.CIP.T
     14484**DCL     14555--REDEF
QI_SRCH_VRFY.CIP.T.CA
     14487**DCL     14491--REDEF   14494--REDEF   14497--REDEF
QI_SRCH_VRFY.DATA
     14724**DCL     14728--REDEF
QI_SRCH_VRFY.DEC
     14792**DCL     14796--REDEF   14797--REDEF   14801--REDEF
QI_SRCH_VRFY.FILL_CHAR
     14848**DCL     14851--REDEF
QI_SRCH_VRFY.ROUND
     14867**DCL     14868--REDEF   14869--REDEF
QI_SRCH_VRFY.SRCH_RESULT
     14808**DCL     14811--REDEF   14812--REDEF   14815--REDEF   14816--REDEF   14819--REDEF
QI_SRCH_VRFY.SRCH_VRFY_ARGS
     14732**DCL     14736--REDEF   14737--REDEF   14741--REDEF   14742--REDEF   14746--REDEF
QI_SRCH_VRFY.SRCH_VRFY_ELEMS
     14803**DCL     14806--REDEF
QI_TYPE_BINARY_TARGET.CIP
     13593**DCL     14044--REDEF
QI_TYPE_BINARY_TARGET.CIP.AUX
     13959**DCL     14030--REDEF
QI_TYPE_BINARY_TARGET.CIP.AUX.CA
     13962**DCL     13966--REDEF   13969--REDEF   13972--REDEF
QI_TYPE_BINARY_TARGET.CIP.S
     13663**DCL     13734--REDEF
QI_TYPE_BINARY_TARGET.CIP.S.CA
     13666**DCL     13670--REDEF   13673--REDEF   13676--REDEF
QI_TYPE_BINARY_TARGET.CIP.T
     13811**DCL     13882--REDEF
QI_TYPE_BINARY_TARGET.CIP.T.CB
     13828**DCL     13831--REDEF   13835--REDEF   13838--REDEF
QI_TYPE_BINARY_TARGET.DATA
     14051**DCL     14055--REDEF
QI_TYPE_BINARY_TARGET.DEC
     14119**DCL     14123--REDEF   14124--REDEF   14128--REDEF
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:119  
QI_TYPE_BINARY_TARGET.LEN
     14091**DCL     14095--REDEF   14096--REDEF   14100--REDEF   14101--REDEF   14105--REDEF
QI_TYPE_BINARY_TARGET.PICTURE_STRING
     14161**DCL     14164--REDEF   14165--REDEF   14168--REDEF   14169--REDEF   14172--REDEF
QI_TYPE_BINARY_TARGET.ROUND
     14194**DCL     14195--REDEF   14196--REDEF
QI_TYPE_BINARY_TARGET.SIZE_ERROR
     14180**DCL     14181--REDEF
QI_TYPE_BINARY_TARGET.SRCH_VRFY_ELEMS
     14130**DCL     14133--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP
     12261**DCL     12712--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.AUX
     12627**DCL     12698--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.AUX.CA
     12630**DCL     12634--REDEF   12637--REDEF   12640--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.S
     12331**DCL     12402--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.S.CD
     12376**DCL     12379--REDEF   12383--REDEF   12386--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.T
     12479**DCL     12550--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.T.CA
     12482**DCL     12486--REDEF   12489--REDEF   12492--REDEF
QI_TYPE_DISPLAY_SOURCE.DATA
     12719**DCL     12723--REDEF
QI_TYPE_DISPLAY_SOURCE.DEC
     12787**DCL     12791--REDEF   12792--REDEF   12796--REDEF
QI_TYPE_DISPLAY_SOURCE.LEN
     12759**DCL     12763--REDEF   12764--REDEF   12768--REDEF   12769--REDEF   12773--REDEF
QI_TYPE_DISPLAY_SOURCE.PICTURE_STRING
     12829**DCL     12832--REDEF   12833--REDEF   12836--REDEF   12837--REDEF   12840--REDEF
QI_TYPE_DISPLAY_SOURCE.ROUND
     12862**DCL     12863--REDEF   12864--REDEF
QI_TYPE_DISPLAY_SOURCE.SIZE_ERROR
     12848**DCL     12849--REDEF
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:120  
QI_TYPE_DISPLAY_SOURCE.SRCH_VRFY_ELEMS
     12798**DCL     12801--REDEF
QI_TYPE_DISPLAY_TARGET.CIP
     12927**DCL     13378--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.AUX
     13293**DCL     13364--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.AUX.CA
     13296**DCL     13300--REDEF   13303--REDEF   13306--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.S
     12997**DCL     13068--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.S.CA
     13000**DCL     13004--REDEF   13007--REDEF   13010--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.T
     13145**DCL     13216--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.T.CD
     13190**DCL     13193--REDEF   13197--REDEF   13200--REDEF
QI_TYPE_DISPLAY_TARGET.DATA
     13385**DCL     13389--REDEF
QI_TYPE_DISPLAY_TARGET.DEC
     13453**DCL     13457--REDEF   13458--REDEF   13462--REDEF
QI_TYPE_DISPLAY_TARGET.LEN
     13425**DCL     13429--REDEF   13430--REDEF   13434--REDEF   13435--REDEF   13439--REDEF
QI_TYPE_DISPLAY_TARGET.PICTURE_STRING
     13495**DCL     13498--REDEF   13499--REDEF   13502--REDEF   13503--REDEF   13506--REDEF
QI_TYPE_DISPLAY_TARGET.ROUND
     13528**DCL     13529--REDEF   13530--REDEF
QI_TYPE_DISPLAY_TARGET.SIZE_ERROR
     13514**DCL     13515--REDEF
QI_TYPE_DISPLAY_TARGET.SRCH_VRFY_ELEMS
     13464**DCL     13467--REDEF
RESULT_INDEX
     17056**DCL     17081<<DOINDEX 17082>>ASSIGN  17085<<ASSIGN  17496>>ASSIGN  17497<<ASSIGN  17497>>ASSIGN
     17540>>ASSIGN  17541<<ASSIGN  17541>>ASSIGN  17603>>ASSIGN  17604<<ASSIGN  17604>>ASSIGN  17635>>ASSIGN
     17636<<ASSIGN  17636>>ASSIGN  17667>>ASSIGN  17668<<ASSIGN  17668>>ASSIGN
SAVE_ES_FLAG
     17057**DCL     17112<<ASSIGN  17117>>IF
PL6.E3A0      #001=QCD$DE_EDIT File=QCD$DE_EDIT.:E05TSI                          WED 07/30/97 05:05 Page:121  
SOURCE_CHARACTER_TO_MATCH
     17058**DCL     17227<<ASSIGN  17228>>IF      17233>>IF      17278<<ASSIGN  17280<<ASSIGN  17315>>IF
     17320>>IF      17335>>IF      17340>>IF      17357>>IF      17363>>IF      17376>>IF      17387>>IF
     17428>>IF      17438>>IF      17448>>IF      17458>>IF      17489<<ASSIGN  17490>>IF      17490>>IF
     17496>>ASSIGN  17511<<ASSIGN  17513<<ASSIGN  17515>>IF      17523>>IF      17527>>IF      17527>>IF
     17540>>ASSIGN  17554<<ASSIGN  17556<<ASSIGN  17558>>IF      17570>>IF      17585>>IF      17589>>IF
     17589>>IF      17603>>ASSIGN  17616<<ASSIGN  17618<<ASSIGN  17620>>IF      17624>>IF      17624>>IF
     17635>>ASSIGN  17648<<ASSIGN  17650<<ASSIGN  17652>>IF      17656>>IF      17656>>IF      17667>>ASSIGN
     17677<<ASSIGN  17679<<ASSIGN  17680>>IF      17698<<ASSIGN  17699>>IF      17706>>IF      17717>>IF
     17731>>IF
STARTING_SOURCE_INDEX
     17059**DCL     17068<<ASSIGN  17196<<ASSIGN  17199>>IF      17213>>DOWHILE 17218>>ASSIGN  17224>>ASSIGN
     17328>>IF      17348>>IF      17397>>IF      17462>>IF      17684>>IF
SUCCEED
     17758**LABEL   17205--GOTO    17246--GOTO    17763--GOTO    17768--GOTO
TEMP_SOURCE_INDEX
     17060**DCL     17224<<ASSIGN  17226>>DOWHILE 17227>>ASSIGN  17230<<ASSIGN  17230>>ASSIGN  17240<<ASSIGN
     17240>>ASSIGN
WEVE_ENCOUNTERED_A_DECIMAL
     17061**DCL     17225<<ASSIGN  17236>>IF      17239<<ASSIGN
