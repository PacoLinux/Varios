VERSION E05

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:1    
        1        1        /*M* FLP$PRINTER - EFT's report printing routines */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* THI=1,PLM=3 */
        8        8
        9        9        FLP$WR_FILE_INFO: PROC( DCB$, FPARAM$, TSN, FSN, CROSS, ACCT_ONLY, ERR, DEV_LT,
                 9            FITONLY ) ALTRET;
       10       10        /*F*  NAME: FLP$WR_FILE_INFO
       11       11              PURPOSE: Print standard output line for file information.
       12       12         */
       13       13
       14       14    1   DCL DCB$ PTR ALIGNED;    /* DCB pointer to DCB containing file information    */
       15       15    1   DCL FPARAM$ PTR ALIGNED;                /* Pointer to FPARAM of file          */
       16       16    1   DCL TSN CHAR(6) CALIGNED;               /* Tape serial number                 */
       17       17    1   DCL FSN SBIN ALIGNED;                   /* File sequence number               */
       18       18    1   DCL CROSS CHAR(1) CALIGNED;             /* Indicates file section > 1         */
       19       19    1   DCL ACCT_ONLY BIT(1) ALIGNED;           /* Passed if account only (no file)   */
       20       20    1   DCL 1 ERR ALIGNED,                      /* Error code                         */
       21       21    1         2 * BIT(12),
       22       22    1         2 * BIT(6),
       23       23    1         2 * BIT(1),
       24       24    1         2 CODE UBIN(14) UNAL,
       25       25    1         2 * BIT(3);
       26       26    1   DCL DEV_LT BIT(1) ALIGNED;         /* Indicates if LT device for account line */
       27       27    1   DCL FITONLY BIT(1) ALIGNED;        /* Indicates fit only file for WHERE cmnd. */
       28       28
       29       29         /***
       30       30          *** INCLUDE
       31       31          ***/
       32       32
       33       33        %INCLUDE B_ERRORS_C;
       34     1160        %INCLUDE CP_6;
       35     6719        %INCLUDE CP_6_SUBS;
       36     7259        %INCLUDE FLI_DATA_R;
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:2    
       37     8673        %INCLUDE FLW_DATA_R;
       38     8687        %INCLUDE FM$FIT;
       39     8908        %INCLUDE FM$GRAN;
       40     8977        %INCLUDE XUD_UTS_M;
       41     9059
       42     9060         /***
       43     9061          *** ENTRY
       44     9062          ***/
       45     9063
       46     9064    1   DCL FLI$RPT_ERR ENTRY(5);
       47     9065    1   DCL XSF$LOCCODP ENTRY(2) ALTRET;
       48     9066        %XUD$UTS_ENTRIES;
       49     9098
       50     9099         /***
       51     9100          *** EQU
       52     9101          ***/
       53     9102
       54     9103        %XUD_UTS_EQU;
       55     9114
       56     9115         /***
       57     9116          *** DCB
       58     9117          ***/
       59     9118
       60     9119    1   DCL M$LO DCB;
       61     9120    1   DCL M$CATALOG DCB;
       62     9121
       63     9122         /***
       64     9123          *** STATIC
       65     9124          ***/
       66     9125
       67     9126    1   DCL 1 ACCT_LINE STATIC,                 /* Account information                */
       68     9127    1         2 ACCT CHAR(8),                   /* Account                            */
       69     9128    1         2 * CHAR(2) INIT(' '),
       70     9129    1         2 * CHAR(4) INIT(' DP#'),
       71     9130    1         2 PSN CHAR(6),                    /* Pack set name                      */
       72     9131    1         2 * CHAR(1) INIT(' '),
       73     9132    1         2 DATE CHAR(8),                   /* LOCAL format date                  */
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:3    
       74     9133    1         2 * CHAR(1) INIT(' '),
       75     9134    1         2 TIME CHAR(5),                   /* LOCAL format time                  */
       76     9135    1         2 * CHAR(1) INIT(' '),
       77     9136    1         2 FSN CHAR(6),
       78     9137    1         2 * CHAR(1) INIT(' '),
       79     9138    1         2 LT CHAR(3),
       80     9139    1         2 TSN CHAR(6),
       81     9140    1         2 CONT CHAR(8);
       82     9141    1   DCL ACCT_LINE_CHARS REDEF ACCT_LINE CHAR(60);
       83     9142
       84     9143    1   DCL 1 FILE_LINE STATIC,                 /* File information                   */
       85     9144    1         2 * CHAR(4) INIT(' '),
       86     9145    1         2 NAME CHAR(31),                  /* Name of file                       */
       87     9146    1         2 * CHAR(1) INIT(' '),
       88     9147    1         2 FSN CHAR(6),                    /* File sequence number               */
       89     9148    1         2 CROSS CHAR(1),                  /* '*' if current file section > 1    */
       90     9149    1         2 ORG CHAR(3),                    /* PCL-style file organization        */
       91     9150    1         2 TYSLASH CHAR(1),
       92     9151    1         2 TYPE CHAR(2),                   /* File type                          */
       93     9152    1         2 * CHAR(1) INIT(' '),
       94     9153    1         2 QUEUED_FOR CHAR(1),        /* F - fetch, S - stow,   - not queued     */
       95     9154    1         2 ARCDEL CHAR(1),  /* A - active, I - inactive, D - deleted,  - neither */
       96     9155    1         2 BAD CHAR(1),                    /* B - bad,   - not bad               */
       97     9156    1         2 * CHAR(1) INIT(' '),
       98     9157    1         2 UGRANS CHAR(6),                 /* Number of granules in file         */
       99     9158    1         2 * CHAR(1) INIT(' '),
      100     9159    1         2 NRECS CHAR(7),                  /* Number of records in file          */
      101     9160    1         2 * CHAR(1) INIT(' '),
      102     9161    1         2 MOD_DATE CHAR(6),               /* ANS format modification date       */
      103     9162    1         2 * CHAR(1) INIT(' '),
      104     9163    1         2 STAR_ERROR CHAR(3);
      105     9164
      106     9165    1   DCL 1 FILE_LINE2 REDEF FILE_LINE,
      107     9166    1         2 * CHAR(43),
      108     9167    1         2 TSN CHAR(6),
      109     9168    1         2 * CHAR(9),
      110     9169    1         2 WHERE_ON CHAR(17),
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:4    
      111     9170    1         2 * CHAR(4);
      112     9171
      113     9172    1   DCL 1 FILE_LINE_CHARS REDEF FILE_LINE,
      114     9173    1         2 * CHAR(36),
      115     9174    1         2 INFO CHAR(43);
      116     9175
      117     9176    1   DCL FILE_NAME CHAR(31) STATIC;
      118     9177
      119     9178    1   DCL 1 LEA1 STATIC,                      /* Additional information             */
      120     9179    1         2 * CHAR(6) INIT(' '),
      121     9180    1         2 * CHAR(2) INIT(' '),
      122     9181    1         2 CREATED_ON CHAR(17),
      123     9182    1         2 * CHAR(6) INIT(' '),
      124     9183    1         2 * CHAR(2) INIT(' '),
      125     9184    1         2 MODIFIED_ON CHAR(17),
      126     9185    1         2 * CHAR(2) INIT(' '),
      127     9186    1         2 ACCESSED_ON CHAR(17);
      128     9187
      129     9188    1   DCL 1 LEA2 STATIC,
      130     9189    1         2 * CHAR(6) INIT(' '),
      131     9190    1         2 * CHAR(2) INIT(' '),
      132     9191    1         2 ACCT CHAR(8),
      133     9192    1         2 ACCT_NAME_SEP CHAR(1) INIT(','),
      134     9193    1         2 NAME CHAR(12),
      135     9194    1         2 * CHAR(2) INIT(' '),
      136     9195    1         2 * CHAR(2) INIT(' '),
      137     9196    1         2 BACKED_UP_ON CHAR(17),
      138     9197    1         2 * CHAR(2) INIT(' '),
      139     9198    1         2 ARCHIVED_ON CHAR(17);
      140     9199
      141     9200    1   DCL 1 LEA3 STATIC,
      142     9201    1         2 * CHAR(6) INIT(' '),
      143     9202    1         2 * CHAR(2) INIT(' '),
      144     9203    1         2 WILL_EXPIRE_ON CHAR(17),
      145     9204    1         2 * CHAR(6) INIT(' '),
      146     9205    1         2 * CHAR(2) INIT(' '),
      147     9206    1         2 BLT CHAR(3),
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:5    
      148     9207    1         2 BACKUP_REEL CHAR(6),
      149     9208    1         2 * CHAR(1) INIT(' '),
      150     9209    1         2 BACKUP_REEL_CROSSES CHAR(1),
      151     9210    1         2 * CHAR(2) INIT(' '),
      152     9211    1         2 BACKUP_FSN CHAR(4),
      153     9212    1         2 * CHAR(2) INIT(' '),
      154     9213    1         2 ALT CHAR(3),
      155     9214    1         2 ARCHIVE_REEL CHAR(6),
      156     9215    1         2 * CHAR(1) INIT(' '),
      157     9216    1         2 ARCHIVE_REEL_CROSSES CHAR(1),
      158     9217    1         2 * CHAR(1) INIT(' '),
      159     9218    1         2 ARCHIVE_FSN CHAR(6);
      160     9219
      161     9220    1   DCL CODE$ PTR STATIC;
      162     9221    1   DCL TSTAMP UBIN WORD STATIC;
      163     9222    1   DCL OUTPUT_WIDTH SBIN STATIC;
      164     9223    1   DCL FIT$ PTR STATIC;
      165     9224    1   DCL FLAG BIT(1) STATIC;
      166     9225    1   DCL 1 LEA_DATE STATIC,
      167     9226    1         2 DATE CHAR(8),
      168     9227    1         2 * CHAR(1) INIT(' '),
      169     9228    1         2 TIME CHAR(8);
      170     9229    1   DCL LEA_DATE_CHARS REDEF LEA_DATE CHAR(17);
      171     9230    1   DCL EXPIRE SBIN STATIC;
      172     9231    1   DCL TEMP_UBIN UBIN WORD STATIC;
      173     9232    1   DCL NBR_LINES_NEEDED SBIN STATIC;
      174     9233    1   DCL ACCOUNT_ONLY BIT(1) STATIC;
      175     9234    1   DCL ACCT_CHANGE BIT(1) STATIC;
      176     9235    1   DCL BACKUP_FSN CHAR(4) STATIC;
      177     9236
      178     9237         /***
      179     9238          *** CONSTANT
      180     9239          ***/
      181     9240
      182     9241    1   DCL BLANK CHAR(0) CONSTANT INIT('  ');
      183     9242    1   DCL ORG_STR_TBL(0:25) CHAR(3) CONSTANT INIT('   ', /* From PCL                */
      184     9243    1                       'CON','KEY','RAN','UR ','REL',
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:6    
      185     9244    1                       'IND','IDS','TER','SYM','FPR',
      186     9245    1                       'CG ','   ','IRL','   ','FIX',
      187     9246    1                       'VAR','UND','RES','FRE','   ',
      188     9247    1                       '   '*5);
      189     9248
      190     9249         /***
      191     9250          *** BASED
      192     9251          ***/
      193     9252
      194     9253        %F$DCB(BASED="BASED(DCB$)");
      195     9310        %B$TCB( STCLASS="BASED(B$TCB$)" );
      196     9313        %B$ALT;
      197     9321        %FM$GRAN;
      198     9325        %CODE03(BASED="BASED(CODE$)");
      199     9332        %CODE04(BASED="BASED(CODE$)");
      200     9340        %CODE05(BASED="BASED(CODE$)");
      201     9343        %CODE06(BASED="BASED(CODE$)");
      202     9347
      203     9348         /***
      204     9349          *** FPT
      205     9350          ***/
      206     9351
      207     9352        %FPT_WRITE( FPTN=WRITE_LO,
      208     9353                    DCB=M$LO,
      209     9354                    BUF=FILE_LINE,
      210     9355                    WAIT=YES );
      211     9386
      212     9387        %FPT_TIME( FPTN=GET_ACCT_LINE_DATE,
      213     9388                   SOURCE=CLOCK,
      214     9389                   DEST=LOCAL,
      215     9390                   DATE="ACCT_LINE.DATE",
      216     9391                   TIME="ACCT_LINE.TIME" );
      217     9410
      218     9411        %FPT_TIME( FPTN=GET_FILE_LINE_MOD_DATE,
      219     9412                   SOURCE=UTS,
      220     9413                   TSTAMP=TSTAMP,
      221     9414                   DEST=ANS,
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:7    
      222     9415                   DATE="FILE_LINE.MOD_DATE" );
      223     9434
      224     9435        %FPT_TIME( FPTN=GET_LEA_DATE,
      225     9436                   SOURCE=UTS,
      226     9437                   TSTAMP=TSTAMP,
      227     9438                   DEST=LOCAL,
      228     9439                   DATE="LEA_DATE.DATE",
      229     9440                   TIME="LEA_DATE.TIME" );
      230     9459
      231     9460        %FPT_DEVICE( FPTN=SET_LO_HEADER,
      232     9461                     DCB=M$LO,
      233     9462                     HDR=LO_HEADER );
      234     9480
      235     9481        %VLP_HDR( FPTN=LO_HEADER,
      236     9482                  COUNT=76,
      237     9483                  TITLE=
              9483              '                                                                           '
              9483                      );
      238     9499
      239     9500        %FPT_LINES( FPTN=GET_LO_LINES,
      240     9501                    DCB=M$LO,
      241     9502                    LINES=VLR_LINES );
      242     9516
      243     9517        %VLR_LINES;
      244     9531
      245     9532        %FPT_DEVICE( FPTN=PAGE_LO,
      246     9533                     DCB=M$LO,
      247     9534                     PAGE=YES );
      248     9552
      249     9553        %FPT_DEVICE( FPTN=ERASE_HEADER,
      250     9554                     DCB=M$LO,
      251     9555                     HDR=BLANK_HEADER );
      252     9573
      253     9574        %VLP_HDR( FPTN=BLANK_HEADER,
      254     9575                  COUNT=76,
      255     9576                  TITLE=' ' );
      256     9592
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:8    
      257     9593        %VLP_ACCT( FPTN=BACKUP_ACCT,
      258     9594                   ACCT='$$EFT' );
      259     9607
      260     9608        %FPT_WRITE( FPTN=CATALOG_WRITE,
      261     9609                    DCB=M$CATALOG,
      262     9610                    KEY=CAT_KEY,
      263     9611                    BUF=CAT_REC,
      264     9612                    NEWKEY=YES );
      265     9643
      266     9644        %FPT_READ( FPTN=CATALOG_READ,
      267     9645                   DCB=M$CATALOG,
      268     9646                   KEY=CAT_KEY,
      269     9647                   BUF=CAT_REC,
      270     9648                   KEYS=YES );
      271     9687
      272     9688        /****************************************/
      273     9689
      274     9690         /***
      275     9691          *** Initialization call if no arguments.
      276     9692          ***/
      277     9693
      278     9694    1      IF ADDR(DCB$) = ADDR(NIL)
      279     9695    2       THEN DO;
      280     9696    2         ACCT_LINE.ACCT = ' ';
      281     9697    2         ACCT_LINE.TSN = ' ';
      282     9698    2         ACCT_LINE.LT = ' ';
      283     9699    2         FILE_LINE.STAR_ERROR = ' ';
      284     9700    2         OUTPUT_WIDTH = DCBADDR(DCBNUM(M$LO))->F$DCB.WIDTH#;
      285     9701    2         IF OUTPUT_WIDTH > 132
      286     9702    2          THEN OUTPUT_WIDTH = 132;
      287     9703    2          ELSE IF OUTPUT_WIDTH <= 0
      288     9704    2             THEN OUTPUT_WIDTH = 72;
      289     9705    2         CALL M$DEVICE( SET_LO_HEADER ) ALTRET( ERROR_OUT );
      290     9706    2         RETURN;
      291     9707    2         END;
      292     9708
      293     9709         /***
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:9    
      294     9710          *** Skip to next page if not enough space on current page to contain
      295     9711          *** entire information unit (account or file).
      296     9712          ***/
      297     9713
      298     9714    1      IF ERR.CODE = %E$ADEOF THEN RETURN;  /* Nothing to print                   */
      299     9715
      300     9716    1      IF ADDR(ACCT_ONLY) ~= ADDR(NIL)
      301     9717    1       THEN ACCOUNT_ONLY = ACCT_ONLY;
      302     9718    1       ELSE ACCOUNT_ONLY = '0'B;
      303     9719
      304     9720    1      IF ERR.CODE = %E$EOVOL
      305     9721    1       THEN IF ACCT_LINE.ACCT = ' '
      306     9722    1          THEN ACCT_CHANGE = '1'B;
      307     9723    1          ELSE ACCT_CHANGE = '0'B;
      308     9724    1       ELSE IF F$DCB.ACCT# ~= ACCT_LINE.ACCT OR ERR.CODE = %E$NOPROC
      309     9725    1           OR ERR.CODE = %E$NOKEY OR ERR.CODE = %E$NEWREC
      310     9726    1          THEN ACCT_CHANGE = '1'B;
      311     9727    1          ELSE IF F$DCB.PSN# ~= ACCT_LINE.PSN
      312     9728    1             THEN ACCT_CHANGE = '1'B;
      313     9729    1             ELSE ACCT_CHANGE = '0'B;
      314     9730
      315     9731    1      IF ACCT_CHANGE
      316     9732    1       THEN NBR_LINES_NEEDED = 2;
      317     9733    1       ELSE IF TSN ~= ACCT_LINE.TSN
      318     9734    1          THEN NBR_LINES_NEEDED = 1;
      319     9735    1          ELSE NBR_LINES_NEEDED = 0;
      320     9736
      321     9737    1      IF NOT ACCOUNT_ONLY
      322     9738    1       THEN IF DISK_OPTION.LEA
      323     9739    1          THEN NBR_LINES_NEEDED = NBR_LINES_NEEDED + 4;
      324     9740    1          ELSE NBR_LINES_NEEDED = NBR_LINES_NEEDED + 1;
      325     9741
      326     9742    1      IF NBR_LINES_NEEDED > 1
      327     9743    2       THEN DO;
      328     9744    2         CALL M$LINES( GET_LO_LINES ) ALTRET( ERROR_OUT );
      329     9745    2         IF VLR_LINES.RLINES# < NBR_LINES_NEEDED
      330     9746    2           AND VLR_LINES.RLINES# > 0
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:10   
      331     9747    2          THEN CALL M$DEVICE( PAGE_LO ) ALTRET( ERROR_OUT );
      332     9748    2         END;
      333     9749
      334     9750        /***
      335     9751         *** If account or tape has changed, print new account line.
      336     9752         ***/
      337     9753
      338     9754    1      IF ACCT_CHANGE OR (TSN ~= ACCT_LINE.TSN AND ERR.CODE ~= %E$OLDREC)
      339     9755    2       THEN DO;                  /* Account or tape change; print new header     */
      340     9756    2         CALL M$DEVICE( ERASE_HEADER ) ALTRET( ERROR_OUT );
      341     9757    2         IF ACCT_CHANGE
      342     9758    3          THEN DO;
      343     9759    3            WRITE_LO.BUF_ = VECTOR(BLANK);
      344     9760    3            CALL M$WRITE( WRITE_LO ) ALTRET( ERROR_OUT );
      345     9761    3            END;
      346     9762    2         ACCT_LINE.ACCT = F$DCB.ACCT#;
      347     9763    2         IF NOT TEST_MODE
      348     9764    2          THEN CALL M$TIME( GET_ACCT_LINE_DATE );
      349     9765    3          ELSE DO;
      350     9766    3            ACCT_LINE.DATE = ' ';
      351     9767    3            ACCT_LINE.TIME = ' ';
      352     9768    3            END;
      353     9769    2         ACCT_LINE.PSN = F$DCB.PSN#;
      354     9770    2         IF ERR.CODE = %E$OLDREC
      355     9771    3          THEN DO;                         /* Called from WHERE command          */
      356     9772    3            ACCT_LINE.TSN = ' ';
      357     9773    3            ACCT_LINE.LT = ' ';
      358     9774    3            ACCT_LINE.FSN = ' ';
      359     9775    3            END;
      360     9776    3          ELSE DO;
      361     9777    3            ACCT_LINE.TSN = TSN;
      362     9778    3            IF ACCT_LINE.TSN ~= ' '
      363     9779    4             THEN DO;
      364     9780    4               IF DEV_LT
      365     9781    5                THEN DO;
      366     9782    5                  IF SUBSTR(TAPE_OPEN.V.RES#,0,2) = 'OD'
      367     9783    5                   THEN ACCT_LINE.LT = 'OD#';
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:11   
      368     9784    5                   ELSE ACCT_LINE.LT = 'LT#';
      369     9785    5                  END;
      370     9786    4                ELSE ACCT_LINE.LT = 'DP#';
      371     9787    4               END;
      372     9788    3             ELSE ACCT_LINE.LT = ' ';
      373     9789    3            IF ADDR(FSN) ~= ADDR(NIL)
      374     9790    4             THEN DO;
      375     9791    4               CALL BINCHAR( ACCT_LINE.FSN, FSN );
      376     9792    4               CALL EDITCHAR( ACCT_LINE.FSN, , , NO_LEADING_6_ZEROS, ACCT_LINE.FSN );
      377     9793    4               END;
      378     9794    3             ELSE ACCT_LINE.FSN = ' ';
      379     9795    3            END;
      380     9796    3         DO SELECT( ERR.CODE );
      381     9797    3            SELECT( %E$NOKEY );
      382     9798    3            ACCT_LINE.CONT = ' deleted';
      383     9799    3            ACCOUNT_ONLY = '1'B;
      384     9800    3            SELECT( %E$NOPROC );
      385     9801    3            ACCT_LINE.CONT = ' cleanup';
      386     9802    3            ACCOUNT_ONLY = '1'B;
      387     9803    3            SELECT( %E$FDEOF );
      388     9804    3            ACCT_LINE.CONT = ' ';
      389     9805    3            ACCOUNT_ONLY = '1'B;
      390     9806    3            SELECT( %E$EOVOL );
      391     9807    3            ACCT_LINE.CONT = ' ';
      392     9808    3            ACCT_LINE.DATE = 'checking';
      393     9809    3            ACCT_LINE.TIME = 'at';
      394     9810    3            SELECT( 0 );                   /* No error                           */
      395     9811    3            ACCT_LINE.CONT = ' ';
      396     9812    3            SELECT( %E$NEWREC );
      397     9813    3            ACCT_LINE.CONT = ' skip';
      398     9814    3            SELECT( ELSE );
      399     9815    3         IF ACCOUNT_ONLY
      400     9816    3          THEN ACCT_LINE.CONT = ' ***';
      401     9817    3          ELSE ACCT_LINE.CONT = ' ';
      402     9818    3            END;
      403     9819    2      WRITE_LO.BUF_ = VECTOR(ACCT_LINE);
      404     9820    2      IF OVER_FIL      /* if OVER DP#psn2 is issued, assign 2nd packset,write,*/
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:12   
      405     9821    3       THEN DO;             /* reassign psn,so format of printout will stay same */
      406     9822    3         ACCT_LINE.PSN = DISK_DEST_SN.SN#(0);
      407     9823    3         CALL M$WRITE( WRITE_LO ) ALTRET( ERROR_OUT );
      408     9824    3         ACCT_LINE.PSN = F$DCB.PSN#;
      409     9825    3         END;                              /* if over_fil                        */
      410     9826    2       ELSE CALL M$WRITE ( WRITE_LO ) ALTRET( ERROR_OUT );
      411     9827    2      ACCT_LINE.CONT = ' (cont.)';
      412     9828    2      ACCT_LINE.FSN = ' ';
      413     9829    2      ACCT_LINE.DATE = ' ';
      414     9830    2      ACCT_LINE.TIME = ' ';
      415     9831    2      LO_HEADER.TITL.L# = LENGTHC(ACCT_LINE);
      416     9832    2      LO_HEADER.TITL.TITLE# = ACCT_LINE_CHARS;
      417     9833    2      CALL M$DEVICE( SET_LO_HEADER ) ALTRET( ERROR_OUT );
      418     9834    2      WRITE_LO.BUF_ = VECTOR(FILE_LINE);
      419     9835    2      FILE_NAME = ' ';
      420     9836    2         END;
      421     9837
      422     9838    1      IF ACCOUNT_ONLY THEN RETURN;
      423     9839
      424     9840         /***
      425     9841          *** Print file line.
      426     9842          ***/
      427     9843
      428     9844    1      FILE_LINE_CHARS.INFO = ' ';
      429     9845    1      IF FILE_NAME = F$DCB.NAME#.C
      430     9846    1       THEN FILE_LINE.NAME = ' "';
      431     9847    2       ELSE DO;
      432     9848    2         FILE_NAME = F$DCB.NAME#.C;
      433     9849    2         FILE_LINE.NAME = FILE_NAME;
      434     9850    2         END;
      435     9851    1      IF ERR
      436     9852    2       THEN DO;
      437     9853    2         IF ERR.CODE = %E$NOPRS /* Error on DUAL INCR(1st pass) - no source file */
      438     9854    3          THEN DO;
      439     9855    3            FILE_LINE.ARCDEL = 'D';        /* Source file previously deleted     */
      440     9856    3            FILE_LINE.MOD_DATE = 'unknwn'; /* Deletion time unknown              */
      441     9857    3            CALL M$WRITE( WRITE_LO ) ALTRET(ERROR_OUT);
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:13   
      442     9858    3            TOTAL_FILES = TOTAL_FILES+1;
      443     9859    3            RETURN;
      444     9860    3            END;
      445     9861
      446     9862    2         IF ERR.CODE ~= %E$FIT_ONLY        /* Error or info. "fit" to be output? */
      447     9863    3          THEN DO;
      448     9864    3            FILE_LINE.STAR_ERROR = '***';
      449     9865    3            IF ERR.CODE ~= %E$DI AND ERR.CODE ~= %E$IOERR
      450     9866    3              AND ERR.CODE ~= %E$BROKEN /* Don't print skip - was possibly moved */
      451     9867    4             THEN DO;                      /* Just file name and error indicator */
      452     9868    4               IF ERR.CODE = %E$NOFILE OR ERR.CODE = %E$OLDREC
      453     9869    5                THEN DO;
      454     9870    5                  IF ADDR(FSN) ~= ADDR(NIL)
      455     9871    6                   THEN DO;
      456     9872    6                     CALL BINCHAR( FILE_LINE.FSN, FSN );
      457     9873    6                     CALL EDITCHAR( FILE_LINE.FSN, , , NO_LEADING_6_ZEROS, FILE_LINE.
              9873                              FSN );
      458     9874    6                     END;
      459     9875    5                  IF ERR.CODE = %E$NOFILE
      460     9876    5                   THEN FILE_LINE.MOD_DATE = ' clnup';
      461     9877    6                   ELSE DO;
      462     9878    6                     IF F$DCB.DESC.DELF#
      463     9879    6                      THEN IF F$DCB.DESC.ARCHIVE#
      464     9880    6                         THEN FILE_LINE.ARCDEL = 'I'; /* Inactively archived     */
      465     9881    6                         ELSE FILE_LINE.ARCDEL = 'D'; /* Deleted                 */
      466     9882    6                      ELSE IF F$DCB.DESC.ARCHIVE#
      467     9883    6                         THEN FILE_LINE.ARCDEL = 'A'; /* Actively archived       */
      468     9884    6                     IF F$DCB.DESC.BAD#
      469     9885    6                      THEN FILE_LINE.BAD = 'B';
      470     9886    6                     FILE_LINE2.TSN = TSN;
      471     9887    6                     IF TEST_MODE AND F$DCB.ACCT# = BACKUP_ACCT.ACCT#
      472     9888    6                       AND FILE_LINE.ARCDEL = 'D'
      473     9889    6                      THEN TSTAMP = 0;
      474     9890    6                      ELSE TSTAMP = F$DCB.EXPIRE#;
      475     9891    6                     CALL M$TIME( GET_LEA_DATE );
      476     9892    6                     FILE_LINE2.WHERE_ON = LEA_DATE_CHARS;
      477     9893    6                     END;
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:14   
      478     9894    5                  FILE_LINE.STAR_ERROR = ' ';
      479     9895    5                  IF ADDR(FITONLY) ~= ADDR(NIL) /* Output "fit" if fit only      */
      480     9896    6                   THEN DO;
      481     9897    6                     IF FITONLY
      482     9898    6                      THEN FILE_LINE.STAR_ERROR = 'fit';
      483     9899    6                     END;
      484     9900    5                  END;
      485     9901    4                ELSE FILE_LINE.MOD_DATE = ' skip';
      486     9902    4               CALL M$WRITE( WRITE_LO ) ALTRET( ERROR_OUT );
      487     9903    4               RETURN;
      488     9904    4               END;
      489     9905    3            END;
      490     9906    2          ELSE FILE_LINE.STAR_ERROR = 'fit'; /* Info. Occurs only on ACUP tape save */
      491     9907    2         END;
      492     9908
      493     9909    1      TOTAL_FILES = TOTAL_FILES + 1;
      494     9910
      495     9911    1      IF ADDR(FSN) ~= ADDR(NIL)
      496     9912    2       THEN DO;
      497     9913    2         CALL BINCHAR( FILE_LINE.FSN, FSN );
      498     9914    2         CALL EDITCHAR( FILE_LINE.FSN, , , NO_LEADING_6_ZEROS, FILE_LINE.FSN );
      499     9915    2         END;
      500     9916    1      IF ADDR(CROSS) ~= ADDR(NIL)
      501     9917    1       THEN FILE_LINE.CROSS = CROSS;
      502     9918
      503     9919        /***
      504     9920         *** All opens are assumed to be ACS=BLOCK.  Determine pointer to
      505     9921         *** first word of FIT.
      506     9922         ***/
      507     9923
      508     9924    1      IF F$DCB.DESC.DELF#
      509     9925    1       THEN IF F$DCB.DESC.ARCHIVE#
      510     9926    1          THEN FIT$ = FPARAM$;
      511     9927    1          ELSE FIT$ = ADDR(NIL);
      512     9928    1       ELSE IF FPARAM$ = ADDR(NIL)
      513     9929    1          THEN FIT$ = ADDR(NIL);
      514     9930    1          ELSE FIT$ = PINCRW( FPARAM$, SIZEW(FM$GRAN) );
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:15   
      515     9931
      516     9932        /***
      517     9933         *** CODE03 items.
      518     9934         ***/
      519     9935
      520     9936    1      EXPIRE = -1;
      521     9937    1      FLAG = '0'B;
      522     9938    1      IF FIT$ ~= ADDR(NIL)
      523     9939    2       THEN DO;
      524     9940    2         CODE$ = FIT$;
      525     9941    2         CALL XSF$LOCCODP( CODE$, 03 )
      526     9942    3          WHENRETURN DO;
      527     9943    3            FLAG = '1'B;
      528     9944    3            END;
      529     9945    2         END;
      530     9946
      531     9947    1      IF FLAG
      532     9948    2       THEN DO;
      533     9949    2         FILE_LINE.ORG = ORG_STR_TBL(CODE03.ORG);
      534     9950    2         FILE_LINE.TYPE = CODE03.TYPE;
      535     9951    2         IF FILE_LINE.TYPE ~= ' '
      536     9952    2          THEN FILE_LINE.TYSLASH = '/';
      537     9953    2         CALL BINCHAR( FILE_LINE.UGRANS, CODE03.UGRANS );
      538     9954    2         CALL EDITCHAR( FILE_LINE.UGRANS, , , NO_5_LEADING_ZEROS, FILE_LINE.UGRANS );
      539     9955    2         CALL BINCHAR( FILE_LINE.NRECS, CODE03.NRECS );
      540     9956    2         CALL EDITCHAR( FILE_LINE.NRECS, , , NO_6_LEADING_ZEROS, FILE_LINE.NRECS );
      541     9957    2         EXPIRE = CODE03.EXPIRE;
      542     9958    2         TOTAL_GRANS = TOTAL_GRANS + CODE03.UGRANS;
      543     9959    2         END;
      544     9960
      545     9961        /***
      546     9962         *** DCB.DESC items.
      547     9963         ***/
      548     9964
      549     9965    1      IF F$DCB.DESC.DELF#
      550     9966    1       THEN IF F$DCB.DESC.ARCHIVE#
      551     9967    1          THEN FILE_LINE.ARCDEL = 'I';     /* Inactively archived                */
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:16   
      552     9968    1          ELSE FILE_LINE.ARCDEL = 'D';     /* Deleted                            */
      553     9969    1       ELSE IF F$DCB.DESC.ARCHIVE#
      554     9970    1          THEN FILE_LINE.ARCDEL = 'A';     /* Actively archived                  */
      555     9971
      556     9972    1      IF F$DCB.DESC.QS#
      557     9973    1       THEN IF F$DCB.DESC.FETCH#
      558     9974    1          THEN FILE_LINE.QUEUED_FOR = 'F'; /* Queued for retrieval (fetch)       */
      559     9975    2          ELSE DO;
      560     9976    2            FILE_LINE.QUEUED_FOR = 'S';    /* Queued for archival (stow)         */
      561     9977    2            IF F$DCB.DESC.ACTIVE#
      562     9978    2             THEN FILE_LINE.ARCDEL = 'A';  /* STOW ACTIVE                        */
      563     9979    2             ELSE FILE_LINE.ARCDEL = 'I';  /* STOW INACTIVE                      */
      564     9980    2            END;
      565     9981
      566     9982    1      IF F$DCB.DESC.BAD#
      567     9983    1       THEN FILE_LINE.BAD = 'B';           /* Bad                                */
      568     9984
      569     9985        /***
      570     9986         *** CODE04 items.
      571     9987         ***/
      572     9988
      573     9989    1      FLAG = '0'B;
      574     9990    1      IF FIT$ ~= ADDR(NIL)
      575     9991    2       THEN DO;
      576     9992    2         CODE$ = FIT$;
      577     9993    2         CALL XSF$LOCCODP( CODE$, 04 )
      578     9994    3          WHENRETURN DO;
      579     9995    3            FLAG = '1'B;
      580     9996    3            END;
      581     9997    2         END;
      582     9998
      583     9999    1      IF DISK_OPTION.LEA
      584    10000    2       THEN DO;
      585    10001    2         IF FLAG
      586    10002    3          THEN DO;
      587    10003    3            IF TEST_MODE
      588    10004    3             THEN TSTAMP = 0;
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:17   
      589    10005    3             ELSE TSTAMP = CODE04.ACCESS.TIME;
      590    10006    3            CALL M$TIME( GET_LEA_DATE );
      591    10007    3            LEA1.ACCESSED_ON = LEA_DATE_CHARS;
      592    10008    3            TSTAMP = CODE04.CREATION.TIME;
      593    10009    3            CALL M$TIME( GET_LEA_DATE );
      594    10010    3            LEA1.CREATED_ON = LEA_DATE_CHARS;
      595    10011    3            IF EXPIRE < 0
      596    10012    3             THEN LEA3.WILL_EXPIRE_ON = '      never';
      597    10013    4             ELSE DO;
      598    10014    4               CALL XUD$UTS_DIFF_SEC(TEMP_UBIN,BITBIN('777777777777'O),TSTAMP);
      599    10015    4               TEMP_UBIN = TEMP_UBIN / 86400;
      600    10016    4               IF TEMP_UBIN > EXPIRE       /* Limit expiration to maximum        */
      601    10017    4                THEN TEMP_UBIN = EXPIRE;
      602    10018    4               CALL XUD$UTS_ADJ_25TH(TSTAMP,TSTAMP,TEMP_UBIN*%UTS_25TH_DAY#);
      603    10019    4               CALL M$TIME( GET_LEA_DATE );
      604    10020    4               LEA3.WILL_EXPIRE_ON = LEA_DATE_CHARS;
      605    10021    4               END;
      606    10022    3            IF TEST_MODE AND F$DCB.ACCT# = BACKUP_ACCT.ACCT#
      607    10023    3             THEN TSTAMP = 0;
      608    10024    3             ELSE TSTAMP = CODE04.MODIFY.TIME;
      609    10025    3            CALL M$TIME( GET_LEA_DATE );
      610    10026    3            LEA1.MODIFIED_ON = LEA_DATE_CHARS;
      611    10027    3            FILE_LINE.MOD_DATE = ' ';
      612    10028    3            LEA2.ACCT = CODE04.CREATOR.ACCT;
      613    10029    3            LEA2.NAME = CODE04.CREATOR.NAME;
      614    10030    3            IF LEA2.ACCT = ' ' AND LEA2.NAME = ' '
      615    10031    3             THEN LEA2.ACCT_NAME_SEP = ' ';
      616    10032    3             ELSE LEA2.ACCT_NAME_SEP = ',';
      617    10033    3            END;
      618    10034    3          ELSE DO;
      619    10035    3            IF FIT$ ~= ADDR(NIL)
      620    10036    3             THEN LEA1.CREATED_ON = ' ';
      621    10037    4             ELSE DO;                 /* Deleted file...indicate deletion time   */
      622    10038    4               IF TEST_MODE AND F$DCB.ACCT# = BACKUP_ACCT.ACCT#
      623    10039    4                THEN TSTAMP = 0;
      624    10040    4                ELSE TSTAMP = F$DCB.EXPIRE#;
      625    10041    4               CALL M$TIME( GET_LEA_DATE );
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:18   
      626    10042    4               LEA1.CREATED_ON = LEA_DATE_CHARS;
      627    10043    4               END;
      628    10044    3            LEA3.WILL_EXPIRE_ON = '      never';
      629    10045    3            LEA1.ACCESSED_ON = ' ';
      630    10046    3            LEA1.MODIFIED_ON = ' ';
      631    10047    3            LEA2.ACCT = ' ';
      632    10048    3            LEA2.NAME = ' ';
      633    10049    3            LEA2.ACCT_NAME_SEP = ' ';
      634    10050    3            END;
      635    10051    2         END;
      636    10052    2       ELSE DO;
      637    10053    2         IF FLAG
      638    10054    3          THEN DO;
      639    10055    3            IF TEST_MODE AND F$DCB.ACCT# = BACKUP_ACCT.ACCT#
      640    10056    3             THEN TSTAMP = 0;
      641    10057    3             ELSE TSTAMP = CODE04.MODIFY.TIME;
      642    10058    3            CALL M$TIME( GET_FILE_LINE_MOD_DATE );
      643    10059    3            END;
      644    10060    3          ELSE DO;
      645    10061    3            IF FIT$ = ADDR(NIL)
      646    10062    4             THEN DO;                      /* Deleted file                       */
      647    10063    4               IF TEST_MODE AND F$DCB.ACCT# = BACKUP_ACCT.ACCT#
      648    10064    4                THEN TSTAMP = 0;
      649    10065    4                ELSE TSTAMP = F$DCB.EXPIRE#;
      650    10066    4               CALL M$TIME( GET_FILE_LINE_MOD_DATE );
      651    10067    4               END;
      652    10068    3             ELSE IF F$DCB.DESC.ARCHIVE# AND F$DCB.DESC.DELF#
      653    10069    4                THEN DO;                   /* Inactively archived                */
      654    10070    4                  CODE$ = FIT$;
      655    10071    4                  CALL XSF$LOCCODP( CODE$, 06 )
      656    10072    5                   WHENRETURN DO;
      657    10073    5                     TSTAMP = CODE06.STOW.TIME;
      658    10074    5                     CALL M$TIME( GET_FILE_LINE_MOD_DATE );
      659    10075    5                     END;
      660    10076    5                   WHENALTRETURN DO;
      661    10077    5                     FILE_LINE.MOD_DATE = '??????';
      662    10078    5                     TSTAMP = 0;
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:19   
      663    10079    5                     END;
      664    10080    4                  END;
      665    10081    3            END;
      666    10082    2         END;
      667    10083
      668    10084    1      CALL M$WRITE( WRITE_LO ) ALTRET( ERROR_OUT );
      669    10085
      670    10086        /***
      671    10087         *** Handle cataloging.  Usually we'll just have to create the
      672    10088         *** appropriate key and record and write, but sometimes we'll
      673    10089         *** have to handle the case where additional records describing
      674    10090         *** the same file are inserted into (ONTO) the catalog file.
      675    10091         ***/
      676    10092
      677    10093    1      IF CATALOG_ON
      678    10094    2       THEN DO;
      679    10095    2         CAT_KEY.L = LENGTHC(CAT_KEY.PSN)+LENGTHC(CAT_KEY.ACCT)+F$DCB.NAME#.L
      680    10096    2           +LENGTHC(CAT_KEY.NAME.L)+LENGTHC(CAT_KEY.VERSION);
      681    10097    2         CAT_KEY.PSN = ACCT_LINE.PSN;
      682    10098    2         CAT_KEY.ACCT = ACCT_LINE.ACCT;
      683    10099    2         CAT_KEY.NAME.C = FILE_LINE.NAME;
      684    10100    2         CAT_KEY3.VERSION(F$DCB.NAME#.L) = F$DCB.NAME#.L;
      685    10101    2         CAT_KEY3.VERSION(F$DCB.NAME#.L+1) = 0;
             10101                  /* Expect first cataloging of this file */
      686    10102    2         CAT_REC.TSN = ACCT_LINE.TSN;
      687    10103    2         CAT_REC.UTS = TSTAMP;             /* Mod time, del time, or arc time    */
      688    10104    2         CAT_REC.VERSION = 0;
      689    10105    2         IF F$DCB.DESC.ODSTOW#
      690    10106    3          THEN DO;
      691    10107    3            IF ADDR(FSN) = ADDR(NIL)
      692    10108    3             THEN CAT_REC.ODFSN = 0;
      693    10109    3             ELSE CAT_REC.ODFSN = FSN;
      694    10110    3            IF FILE_LINE.CROSS = ' '
      695    10111    3             THEN CAT_REC.ODCROSS = '0'B;
      696    10112    3             ELSE CAT_REC.ODCROSS = '1'B;
      697    10113    3            END;
      698    10114    3          ELSE DO;
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:20   
      699    10115    3            IF ADDR(FSN) = ADDR(NIL)
      700    10116    3             THEN CAT_REC.LT.FSN = 0;
      701    10117    3             ELSE CAT_REC.LT.FSN = FSN;
      702    10118    3            IF FILE_LINE.CROSS = ' '
      703    10119    3             THEN CAT_REC.LT.CROSS = '0'B;
      704    10120    3             ELSE CAT_REC.LT.CROSS = '1'B;
      705    10121    3            END;
      706    10122    2         CAT_REC.DESC = F$DCB.DESC;
      707    10123    2         IF ERR.CODE = %E$FIT_ONLY
      708    10124    2          THEN CAT_REC.FITONLY = '1'B;
      709    10125    2          ELSE CAT_REC.FITONLY = '0'B;
      710    10126    2         IF CATALOG_ONTO
      711    10127    2          THEN CATALOG_WRITE.V.ONEWKEY# = %NO#;
      712    10128    2          ELSE CATALOG_WRITE.V.ONEWKEY# = %YES#;
      713    10129    2         CALL M$WRITE( CATALOG_WRITE )
      714    10130    3          WHENALTRETURN DO;
      715    10131    3            IF B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$OLDREC
      716    10132    3             THEN GOTO ERROR_OUT;
      717    10133    4             ELSE DO;                 /* File's already in this catalog file     */
      718    10134    4               CALL M$READ( CATALOG_READ ) ALTRET( ERROR_OUT );
      719    10135    4               CAT_REC.VERSION = CAT_REC.VERSION + 1; /* File version            */
      720    10136    4               CATALOG_WRITE.V.ONEWKEY# = %YES#;
      721    10137    4               CALL M$WRITE( CATALOG_WRITE ) ALTRET( ERROR_OUT );
      722    10138    4               CAT_KEY3.VERSION(F$DCB.NAME#.L+1) = CAT_REC.VERSION;
      723    10139    4               CAT_REC.TSN = ACCT_LINE.TSN;
      724    10140    4               CAT_REC.UTS = TSTAMP;       /* Mod time, del time, or arc time    */
      725    10141    4               CAT_REC.VERSION = 0;
      726    10142    4               IF F$DCB.DESC.ODSTOW#
      727    10143    5                THEN DO;
      728    10144    5                  IF ADDR(FSN) = ADDR(NIL)
      729    10145    5                   THEN CAT_REC.ODFSN = 0;
      730    10146    5                   ELSE CAT_REC.ODFSN = FSN;
      731    10147    5                  IF FILE_LINE.CROSS = ' '
      732    10148    5                   THEN CAT_REC.ODCROSS = '0'B;
      733    10149    5                   ELSE CAT_REC.ODCROSS = '1'B;
      734    10150    5                  END;
      735    10151    5                ELSE DO;
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:21   
      736    10152    5                  IF ADDR(FSN) = ADDR(NIL)
      737    10153    5                   THEN CAT_REC.LT.FSN = 0;
      738    10154    5                   ELSE CAT_REC.LT.FSN = FSN;
      739    10155    5                  IF FILE_LINE.CROSS = ' '
      740    10156    5                   THEN CAT_REC.LT.CROSS = '0'B;
      741    10157    5                   ELSE CAT_REC.LT.CROSS = '1'B;
      742    10158    5                  END;
      743    10159    4               CALL M$WRITE( CATALOG_WRITE ) ALTRET( ERROR_OUT );
      744    10160    4               END;
      745    10161    3            END;
      746    10162    2         END;
      747    10163    1      IF NOT DISK_OPTION.LEA THEN RETURN;
      748    10164
      749    10165        /***
      750    10166         *** CODE05 items.
      751    10167         ***/
      752    10168
      753    10169    1      TSTAMP = 0;
      754    10170    1      IF FIT$ ~= ADDR(NIL)
      755    10171    2       THEN DO;
      756    10172    2         CODE$ = FIT$;
      757    10173    2         CALL XSF$LOCCODP( CODE$, 05 )
      758    10174    3          WHENRETURN DO;
      759    10175    3            TSTAMP = CODE05.BACKUP.TIME;
      760    10176    3            END;
      761    10177    2         END;
      762    10178
      763    10179    1      IF TSTAMP > 0
      764    10180    2       THEN DO;
      765    10181    2         IF TEST_MODE
      766    10182    2          THEN TSTAMP = 0;
      767    10183    2         CALL M$TIME( GET_LEA_DATE );
      768    10184    2         LEA2.BACKED_UP_ON = LEA_DATE_CHARS;
      769    10185    2         EFTWORD = CODE05.BACKUP.EFT;
      770    10186    2         IF EFTWORD.CROSS
      771    10187    2          THEN LEA3.BACKUP_REEL_CROSSES = '*';
      772    10188    2          ELSE LEA3.BACKUP_REEL_CROSSES = ' ';
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:22   
      773    10189    2         LEA3.BACKUP_REEL = CODE05.BACKUP.REEL;
      774    10190    2         CALL BINCHAR( BACKUP_FSN, EFTWORD.FSN );
      775    10191    2         CALL EDITCHAR( LEA3.BACKUP_FSN, , , NO_LEADING_4_ZEROS, BACKUP_FSN );
      776    10192    2         IF F$DCB.DESC.TPB#
      777    10193    2          THEN LEA3.BLT = 'LT#';
      778    10194    2          ELSE LEA3.BLT = 'DP#';
      779    10195    2         END;
      780    10196    2       ELSE DO;
      781    10197    2         LEA2.BACKED_UP_ON = '      never';
      782    10198    2         LEA3.BACKUP_REEL_CROSSES = ' ';
      783    10199    2         LEA3.BACKUP_REEL = ' ';
      784    10200    2         LEA3.BLT = ' ';
      785    10201    2         LEA3.BACKUP_FSN = ' ';
      786    10202    2         END;
      787    10203
      788    10204        /***
      789    10205         *** CODE06 items.
      790    10206         ***/
      791    10207
      792    10208    1      TSTAMP = 0;
      793    10209    1      IF FIT$ ~= ADDR(NIL)
      794    10210    2       THEN DO;
      795    10211    2         CODE$ = FIT$;
      796    10212    2         CALL XSF$LOCCODP( CODE$, 06 )
      797    10213    3          WHENRETURN DO;
      798    10214    3            TSTAMP = CODE06.STOW.TIME;
      799    10215    3            END;
      800    10216    2         END;
      801    10217
      802    10218    1      IF TSTAMP > 0
      803    10219    2       THEN DO;
      804    10220    2         IF TEST_MODE
      805    10221    2          THEN TSTAMP = 0;
      806    10222    2         CALL M$TIME( GET_LEA_DATE );
      807    10223    2         LEA2.ARCHIVED_ON = LEA_DATE_CHARS;
      808    10224    2         LEA3.ARCHIVE_REEL = CODE06.STOW.REEL;
      809    10225    2         EFTWORD = CODE06.STOW.EFT;
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:23   
      810    10226    2         IF F$DCB.DESC.ODSTOW#
      811    10227    3          THEN DO;
      812    10228    3            LEA3.ARCHIVE_REEL_CROSSES = ' '; /* EFTWORD.CROSS not avail for OD   */
      813    10229    3            LEA3.ALT = 'OD#';
      814    10230    3            END;
      815    10231    3          ELSE DO;
      816    10232    3            IF EFTWORD.CROSS
      817    10233    3             THEN LEA3.ARCHIVE_REEL_CROSSES = '*';
      818    10234    3             ELSE LEA3.ARCHIVE_REEL_CROSSES = ' ';
      819    10235    3            LEA3.ALT = 'LT#';
      820    10236    3            END;
      821    10237    2         CALL BINCHAR( FILE_LINE.FSN, EFTWORD.FSN );
      822    10238    2         CALL EDITCHAR( LEA3.ARCHIVE_FSN, , , NO_LEADING_6_ZEROS, FILE_LINE.FSN );
      823    10239    2         END;
      824    10240    2       ELSE DO;
      825    10241    2         LEA2.ARCHIVED_ON = '      never';
      826    10242    2         LEA3.ARCHIVE_REEL_CROSSES = ' ';
      827    10243    2         LEA3.ALT = ' ';
      828    10244    2         LEA3.ARCHIVE_REEL = ' ';
      829    10245    2         LEA3.ARCHIVE_FSN = ' ';
      830    10246    2         END;
      831    10247
      832    10248    1      WRITE_LO.BUF_ = VECTOR(LEA1);
      833    10249    1      CALL M$WRITE( WRITE_LO ) ALTRET( ERROR_OUT );
      834    10250    1      WRITE_LO.BUF_ = VECTOR(LEA2);
      835    10251    1      CALL M$WRITE( WRITE_LO ) ALTRET( ERROR_OUT );
      836    10252    1      WRITE_LO.BUF_ = VECTOR(LEA3);
      837    10253    1      CALL M$WRITE( WRITE_LO ) ALTRET( ERROR_OUT );
      838    10254    1      WRITE_LO.BUF_ = VECTOR(FILE_LINE);
      839    10255
      840    10256    1      RETURN;
      841    10257
      842    10258    1   ERROR_OUT: ;
      843    10259    1      CALL FLI$RPT_ERR;
      844    10260    1      ALTRETURN;
      845    10261
      846    10262    1   END FLP$WR_FILE_INFO;
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:24   
      847    10263        %EOD;

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:25   
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   FM$GRAN.:E05TOU  is referenced.
   FM$FIT.:E05TOU  is referenced.
   FLW_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure FLP$WR_FILE_INFO.

   Procedure FLP$WR_FILE_INFO requires 1229 words for executable code.
   Procedure FLP$WR_FILE_INFO requires 16 words of local(AUTO) storage.

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:26   

 Object Unit name= FLP$WR_FILE_INFO                           File name= FLP$PRINTER.:E05TOU
 UTS= JUL 29 '97 16:16:55.92 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$PRE_RET
    2   Data  even  none   256    400  FLP$WR_FILE_INFO
    3   DCB   even  none     0      0  M$LO
    4   DCB   even  none     0      0  M$CATALOG
    5  RoData even  UTS     49     61  FLP$WR_FILE_INFO
    6   Proc  even  none  1229   2315  FLP$WR_FILE_INFO
    7  RoData even  none    34     42  FLP$WR_FILE_INFO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     6      0   yes    yes     yes      Std        9  FLP$WR_FILE_INFO

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 XUD$UTS_DIFF_SEC
 yes     yes           Std       2 XSF$LOCCODP
 yes     yes           Std       3 XUD$UTS_ADJ_25TH
         yes           Std       5 FLI$RPT_ERR
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_N
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:27   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TAPE_DCBLIST$                         TAPE_OPEN
     SNVECLIST$                            B$TCB$                                OVER_FIL
     DPLIST$                               DPRESLIST$                            DISK_FILE_SPEC$
     SPECCHARS                             DISK_OPTION                           DISK_DEST_SN
     EFTWORD                               TOTAL_FILES                           TOTAL_GRANS
r    NO_LEADING_4_ZEROS               r    NO_LEADING_6_ZEROS               r    NO_6_LEADING_ZEROS
r    NO_5_LEADING_ZEROS                    M$PRE_RET                             RET_CMDS_NAME
     TEST_MODE                             CAT_KEY                               CAT_REC
     CATALOG_ON                            CATALOG_ONTO                          M$LO
     M$CATALOG                             B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:28   


        1        1        /*M* FLP$PRINTER - EFT's report printing routines */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* THI=1,PLM=3 */
        8        8
        9        9        FLP$WR_FILE_INFO: PROC( DCB$, FPARAM$, TSN, FSN, CROSS, ACCT_ONLY, ERR, DEV_LT,
                 9            FITONLY ) ALTRET;

      9  6 000000   000000 700200 xent  FLP$WR_FILE* TSX0  ! X66_AUTO_N
         6 000001   000020 000011                    ZERO    16,9

       10       10        /*F*  NAME: FLP$WR_FILE_INFO
       11       11              PURPOSE: Print standard output line for file information.
       12       12         */
       13       13
       14       14    1   DCL DCB$ PTR ALIGNED;    /* DCB pointer to DCB containing file information    */
       15       15    1   DCL FPARAM$ PTR ALIGNED;                /* Pointer to FPARAM of file          */
       16       16    1   DCL TSN CHAR(6) CALIGNED;               /* Tape serial number                 */
       17       17    1   DCL FSN SBIN ALIGNED;                   /* File sequence number               */
       18       18    1   DCL CROSS CHAR(1) CALIGNED;             /* Indicates file section > 1         */
       19       19    1   DCL ACCT_ONLY BIT(1) ALIGNED;           /* Passed if account only (no file)   */
       20       20    1   DCL 1 ERR ALIGNED,                      /* Error code                         */
       21       21    1         2 * BIT(12),
       22       22    1         2 * BIT(6),
       23       23    1         2 * BIT(1),
       24       24    1         2 CODE UBIN(14) UNAL,
       25       25    1         2 * BIT(3);
       26       26    1   DCL DEV_LT BIT(1) ALIGNED;         /* Indicates if LT device for account line */
       27       27    1   DCL FITONLY BIT(1) ALIGNED;        /* Indicates fit only file for WHERE cmnd. */
       28       28
       29       29         /***
       30       30          *** INCLUDE
       31       31          ***/
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:29   
       32       32
       33       33        %INCLUDE B_ERRORS_C;
       34     1160        %INCLUDE CP_6;
       35     6719        %INCLUDE CP_6_SUBS;
       36     7259        %INCLUDE FLI_DATA_R;
       37     8673        %INCLUDE FLW_DATA_R;
       38     8687        %INCLUDE FM$FIT;
       39     8908        %INCLUDE FM$GRAN;
       40     8977        %INCLUDE XUD_UTS_M;
       41     9059
       42     9060         /***
       43     9061          *** ENTRY
       44     9062          ***/
       45     9063
       46     9064    1   DCL FLI$RPT_ERR ENTRY(5);
       47     9065    1   DCL XSF$LOCCODP ENTRY(2) ALTRET;
       48     9066        %XUD$UTS_ENTRIES;
       49     9098
       50     9099         /***
       51     9100          *** EQU
       52     9101          ***/
       53     9102
       54     9103        %XUD_UTS_EQU;
       55     9114
       56     9115         /***
       57     9116          *** DCB
       58     9117          ***/
       59     9118
       60     9119    1   DCL M$LO DCB;
       61     9120    1   DCL M$CATALOG DCB;
       62     9121
       63     9122         /***
       64     9123          *** STATIC
       65     9124          ***/
       66     9125
       67     9126    1   DCL 1 ACCT_LINE STATIC,                 /* Account information                */
       68     9127    1         2 ACCT CHAR(8),                   /* Account                            */
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:30   
       69     9128    1         2 * CHAR(2) INIT(' '),
       70     9129    1         2 * CHAR(4) INIT(' DP#'),
       71     9130    1         2 PSN CHAR(6),                    /* Pack set name                      */
       72     9131    1         2 * CHAR(1) INIT(' '),
       73     9132    1         2 DATE CHAR(8),                   /* LOCAL format date                  */
       74     9133    1         2 * CHAR(1) INIT(' '),
       75     9134    1         2 TIME CHAR(5),                   /* LOCAL format time                  */
       76     9135    1         2 * CHAR(1) INIT(' '),
       77     9136    1         2 FSN CHAR(6),
       78     9137    1         2 * CHAR(1) INIT(' '),
       79     9138    1         2 LT CHAR(3),
       80     9139    1         2 TSN CHAR(6),
       81     9140    1         2 CONT CHAR(8);
       82     9141    1   DCL ACCT_LINE_CHARS REDEF ACCT_LINE CHAR(60);
       83     9142
       84     9143    1   DCL 1 FILE_LINE STATIC,                 /* File information                   */
       85     9144    1         2 * CHAR(4) INIT(' '),
       86     9145    1         2 NAME CHAR(31),                  /* Name of file                       */
       87     9146    1         2 * CHAR(1) INIT(' '),
       88     9147    1         2 FSN CHAR(6),                    /* File sequence number               */
       89     9148    1         2 CROSS CHAR(1),                  /* '*' if current file section > 1    */
       90     9149    1         2 ORG CHAR(3),                    /* PCL-style file organization        */
       91     9150    1         2 TYSLASH CHAR(1),
       92     9151    1         2 TYPE CHAR(2),                   /* File type                          */
       93     9152    1         2 * CHAR(1) INIT(' '),
       94     9153    1         2 QUEUED_FOR CHAR(1),        /* F - fetch, S - stow,   - not queued     */
       95     9154    1         2 ARCDEL CHAR(1),  /* A - active, I - inactive, D - deleted,  - neither */
       96     9155    1         2 BAD CHAR(1),                    /* B - bad,   - not bad               */
       97     9156    1         2 * CHAR(1) INIT(' '),
       98     9157    1         2 UGRANS CHAR(6),                 /* Number of granules in file         */
       99     9158    1         2 * CHAR(1) INIT(' '),
      100     9159    1         2 NRECS CHAR(7),                  /* Number of records in file          */
      101     9160    1         2 * CHAR(1) INIT(' '),
      102     9161    1         2 MOD_DATE CHAR(6),               /* ANS format modification date       */
      103     9162    1         2 * CHAR(1) INIT(' '),
      104     9163    1         2 STAR_ERROR CHAR(3);
      105     9164
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:31   
      106     9165    1   DCL 1 FILE_LINE2 REDEF FILE_LINE,
      107     9166    1         2 * CHAR(43),
      108     9167    1         2 TSN CHAR(6),
      109     9168    1         2 * CHAR(9),
      110     9169    1         2 WHERE_ON CHAR(17),
      111     9170    1         2 * CHAR(4);
      112     9171
      113     9172    1   DCL 1 FILE_LINE_CHARS REDEF FILE_LINE,
      114     9173    1         2 * CHAR(36),
      115     9174    1         2 INFO CHAR(43);
      116     9175
      117     9176    1   DCL FILE_NAME CHAR(31) STATIC;
      118     9177
      119     9178    1   DCL 1 LEA1 STATIC,                      /* Additional information             */
      120     9179    1         2 * CHAR(6) INIT(' '),
      121     9180    1         2 * CHAR(2) INIT(' '),
      122     9181    1         2 CREATED_ON CHAR(17),
      123     9182    1         2 * CHAR(6) INIT(' '),
      124     9183    1         2 * CHAR(2) INIT(' '),
      125     9184    1         2 MODIFIED_ON CHAR(17),
      126     9185    1         2 * CHAR(2) INIT(' '),
      127     9186    1         2 ACCESSED_ON CHAR(17);
      128     9187
      129     9188    1   DCL 1 LEA2 STATIC,
      130     9189    1         2 * CHAR(6) INIT(' '),
      131     9190    1         2 * CHAR(2) INIT(' '),
      132     9191    1         2 ACCT CHAR(8),
      133     9192    1         2 ACCT_NAME_SEP CHAR(1) INIT(','),
      134     9193    1         2 NAME CHAR(12),
      135     9194    1         2 * CHAR(2) INIT(' '),
      136     9195    1         2 * CHAR(2) INIT(' '),
      137     9196    1         2 BACKED_UP_ON CHAR(17),
      138     9197    1         2 * CHAR(2) INIT(' '),
      139     9198    1         2 ARCHIVED_ON CHAR(17);
      140     9199
      141     9200    1   DCL 1 LEA3 STATIC,
      142     9201    1         2 * CHAR(6) INIT(' '),
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:32   
      143     9202    1         2 * CHAR(2) INIT(' '),
      144     9203    1         2 WILL_EXPIRE_ON CHAR(17),
      145     9204    1         2 * CHAR(6) INIT(' '),
      146     9205    1         2 * CHAR(2) INIT(' '),
      147     9206    1         2 BLT CHAR(3),
      148     9207    1         2 BACKUP_REEL CHAR(6),
      149     9208    1         2 * CHAR(1) INIT(' '),
      150     9209    1         2 BACKUP_REEL_CROSSES CHAR(1),
      151     9210    1         2 * CHAR(2) INIT(' '),
      152     9211    1         2 BACKUP_FSN CHAR(4),
      153     9212    1         2 * CHAR(2) INIT(' '),
      154     9213    1         2 ALT CHAR(3),
      155     9214    1         2 ARCHIVE_REEL CHAR(6),
      156     9215    1         2 * CHAR(1) INIT(' '),
      157     9216    1         2 ARCHIVE_REEL_CROSSES CHAR(1),
      158     9217    1         2 * CHAR(1) INIT(' '),
      159     9218    1         2 ARCHIVE_FSN CHAR(6);
      160     9219
      161     9220    1   DCL CODE$ PTR STATIC;
      162     9221    1   DCL TSTAMP UBIN WORD STATIC;
      163     9222    1   DCL OUTPUT_WIDTH SBIN STATIC;
      164     9223    1   DCL FIT$ PTR STATIC;
      165     9224    1   DCL FLAG BIT(1) STATIC;
      166     9225    1   DCL 1 LEA_DATE STATIC,
      167     9226    1         2 DATE CHAR(8),
      168     9227    1         2 * CHAR(1) INIT(' '),
      169     9228    1         2 TIME CHAR(8);
      170     9229    1   DCL LEA_DATE_CHARS REDEF LEA_DATE CHAR(17);
      171     9230    1   DCL EXPIRE SBIN STATIC;
      172     9231    1   DCL TEMP_UBIN UBIN WORD STATIC;
      173     9232    1   DCL NBR_LINES_NEEDED SBIN STATIC;
      174     9233    1   DCL ACCOUNT_ONLY BIT(1) STATIC;
      175     9234    1   DCL ACCT_CHANGE BIT(1) STATIC;
      176     9235    1   DCL BACKUP_FSN CHAR(4) STATIC;
      177     9236
      178     9237         /***
      179     9238          *** CONSTANT
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:33   
      180     9239          ***/
      181     9240
      182     9241    1   DCL BLANK CHAR(0) CONSTANT INIT('  ');
      183     9242    1   DCL ORG_STR_TBL(0:25) CHAR(3) CONSTANT INIT('   ', /* From PCL                */
      184     9243    1                       'CON','KEY','RAN','UR ','REL',
      185     9244    1                       'IND','IDS','TER','SYM','FPR',
      186     9245    1                       'CG ','   ','IRL','   ','FIX',
      187     9246    1                       'VAR','UND','RES','FRE','   ',
      188     9247    1                       '   '*5);
      189     9248
      190     9249         /***
      191     9250          *** BASED
      192     9251          ***/
      193     9252
      194     9253        %F$DCB(BASED="BASED(DCB$)");
      195     9310        %B$TCB( STCLASS="BASED(B$TCB$)" );
      196     9313        %B$ALT;
      197     9321        %FM$GRAN;
      198     9325        %CODE03(BASED="BASED(CODE$)");
      199     9332        %CODE04(BASED="BASED(CODE$)");
      200     9340        %CODE05(BASED="BASED(CODE$)");
      201     9343        %CODE06(BASED="BASED(CODE$)");
      202     9347
      203     9348         /***
      204     9349          *** FPT
      205     9350          ***/
      206     9351
      207     9352        %FPT_WRITE( FPTN=WRITE_LO,
      208     9353                    DCB=M$LO,
      209     9354                    BUF=FILE_LINE,
      210     9355                    WAIT=YES );
      211     9386
      212     9387        %FPT_TIME( FPTN=GET_ACCT_LINE_DATE,
      213     9388                   SOURCE=CLOCK,
      214     9389                   DEST=LOCAL,
      215     9390                   DATE="ACCT_LINE.DATE",
      216     9391                   TIME="ACCT_LINE.TIME" );
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:34   
      217     9410
      218     9411        %FPT_TIME( FPTN=GET_FILE_LINE_MOD_DATE,
      219     9412                   SOURCE=UTS,
      220     9413                   TSTAMP=TSTAMP,
      221     9414                   DEST=ANS,
      222     9415                   DATE="FILE_LINE.MOD_DATE" );
      223     9434
      224     9435        %FPT_TIME( FPTN=GET_LEA_DATE,
      225     9436                   SOURCE=UTS,
      226     9437                   TSTAMP=TSTAMP,
      227     9438                   DEST=LOCAL,
      228     9439                   DATE="LEA_DATE.DATE",
      229     9440                   TIME="LEA_DATE.TIME" );
      230     9459
      231     9460        %FPT_DEVICE( FPTN=SET_LO_HEADER,
      232     9461                     DCB=M$LO,
      233     9462                     HDR=LO_HEADER );
      234     9480
      235     9481        %VLP_HDR( FPTN=LO_HEADER,
      236     9482                  COUNT=76,
      237     9483                  TITLE=
              9483              '                                                                           '
              9483                      );
      238     9499
      239     9500        %FPT_LINES( FPTN=GET_LO_LINES,
      240     9501                    DCB=M$LO,
      241     9502                    LINES=VLR_LINES );
      242     9516
      243     9517        %VLR_LINES;
      244     9531
      245     9532        %FPT_DEVICE( FPTN=PAGE_LO,
      246     9533                     DCB=M$LO,
      247     9534                     PAGE=YES );
      248     9552
      249     9553        %FPT_DEVICE( FPTN=ERASE_HEADER,
      250     9554                     DCB=M$LO,
      251     9555                     HDR=BLANK_HEADER );
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:35   
      252     9573
      253     9574        %VLP_HDR( FPTN=BLANK_HEADER,
      254     9575                  COUNT=76,
      255     9576                  TITLE=' ' );
      256     9592
      257     9593        %VLP_ACCT( FPTN=BACKUP_ACCT,
      258     9594                   ACCT='$$EFT' );
      259     9607
      260     9608        %FPT_WRITE( FPTN=CATALOG_WRITE,
      261     9609                    DCB=M$CATALOG,
      262     9610                    KEY=CAT_KEY,
      263     9611                    BUF=CAT_REC,
      264     9612                    NEWKEY=YES );
      265     9643
      266     9644        %FPT_READ( FPTN=CATALOG_READ,
      267     9645                   DCB=M$CATALOG,
      268     9646                   KEY=CAT_KEY,
      269     9647                   BUF=CAT_REC,
      270     9648                   KEYS=YES );
      271     9687
      272     9688        /****************************************/
      273     9689
      274     9690         /***
      275     9691          *** Initialization call if no arguments.
      276     9692          ***/
      277     9693
      278     9694    1      IF ADDR(DCB$) = ADDR(NIL)

   9694  6 000002   200003 236100                    LDQ     @DCB$,,AUTO
         6 000003   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 000004   000045 601000 6                  TNZ     s:9714

      279     9695    2       THEN DO;

      280     9696    2         ACCT_LINE.ACCT = ' ';

   9696  6 000005   000035 235000 xsym               LDA     B_VECTNIL+29
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:36   
         6 000006   000035 236000 xsym               LDQ     B_VECTNIL+29
         6 000007   000006 757000 2                  STAQ    ACCT_LINE

      281     9697    2         ACCT_LINE.TSN = ' ';

   9697  6 000010   040000 100400                    MLR     fill='040'O
         6 000011   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000012   000021 400006 2                  ADSC9   ACCT_LINE+11             cn=2,n=6

      282     9698    2         ACCT_LINE.LT = ' ';

   9698  6 000013   040000 100400                    MLR     fill='040'O
         6 000014   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000015   000020 600003 2                  ADSC9   ACCT_LINE+10             cn=3,n=3

      283     9699    2         FILE_LINE.STAR_ERROR = ' ';

   9699  6 000016   000000 236000 7                  LDQ     0
         6 000017   000050 552070 2                  STBQ    FILE_LINE+19,'70'O

      284     9700    2         OUTPUT_WIDTH = DCBADDR(DCBNUM(M$LO))->F$DCB.WIDTH#;

   9700  6 000020   000000 236007 xsym               LDQ     M$LO,DL
         6 000021   000001 470400 7                  LDP0    1
         6 000022   000000 471500                    LDP1    0,,PR0
         6 000023   100000 473506                    LDP3    0,QL,PR1
         6 000024   300004 236100                    LDQ     4,,PR3
         6 000025   000777 376007                    ANQ     511,DL
         6 000026   000151 756000 2                  STQ     OUTPUT_WIDTH

      285     9701    2         IF OUTPUT_WIDTH > 132

   9701  6 000027   000204 116007                    CMPQ    132,DL
         6 000030   000034 604400 6                  TMOZ    s:9703

      286     9702    2          THEN OUTPUT_WIDTH = 132;

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:37   
   9702  6 000031   000204 235007                    LDA     132,DL
         6 000032   000151 755000 2                  STA     OUTPUT_WIDTH
         6 000033   000040 710000 6                  TRA     s:9705

      287     9703    2          ELSE IF OUTPUT_WIDTH <= 0

   9703  6 000034   000000 116003                    CMPQ    0,DU
         6 000035   000040 605400 6                  TPNZ    s:9705

      288     9704    2             THEN OUTPUT_WIDTH = 72;

   9704  6 000036   000110 235007                    LDA     72,DL
         6 000037   000151 755000 2                  STA     OUTPUT_WIDTH

      289     9705    2         CALL M$DEVICE( SET_LO_HEADER ) ALTRET( ERROR_OUT );

   9705  6 000040   000250 630400 2                  EPPR0   SET_LO_HEADER
         6 000041   450006 713400                    CLIMB   alt,+20486
         6 000042   401000 401760                    pmme    nvectors=3
         6 000043   002311 702000 6                  TSX2    ERROR_OUT

      290     9706    2         RETURN;

   9706  6 000044   000000 702200 xent               TSX2  ! X66_ARET

      291     9707    2         END;
      292     9708
      293     9709         /***
      294     9710          *** Skip to next page if not enough space on current page to contain
      295     9711          *** entire information unit (account or file).
      296     9712          ***/
      297     9713
      298     9714    1      IF ERR.CODE = %E$ADEOF THEN RETURN;  /* Nothing to print                   */

   9714  6 000045   200011 470500                    LDP0    @ERR,,AUTO
         6 000046   000000 236100                    LDQ     0,,PR0
         6 000047   377770 376007                    ANQ     131064,DL
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:38   
         6 000050   001750 116007                    CMPQ    1000,DL
         6 000051   000053 601000 6                  TNZ     s:9716

   9714  6 000052   000000 702200 xent               TSX2  ! X66_ARET

      299     9715
      300     9716    1      IF ADDR(ACCT_ONLY) ~= ADDR(NIL)

   9716  6 000053   200010 236100                    LDQ     @ACCT_ONLY,,AUTO
         6 000054   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 000055   000063 600000 6                  TZE     s:9718

      301     9717    1       THEN ACCOUNT_ONLY = ACCT_ONLY;

   9717  6 000056   200010 471500                    LDP1    @ACCT_ONLY,,AUTO
         6 000057   100000 236100                    LDQ     0,,PR1
         6 000060   400000 376003                    ANQ     -131072,DU
         6 000061   000164 756000 2                  STQ     ACCOUNT_ONLY
         6 000062   000064 710000 6                  TRA     s:9720

      302     9718    1       ELSE ACCOUNT_ONLY = '0'B;

   9718  6 000063   000164 450000 2                  STZ     ACCOUNT_ONLY

      303     9719
      304     9720    1      IF ERR.CODE = %E$EOVOL

   9720  6 000064   000000 236100                    LDQ     0,,PR0
         6 000065   377770 376007                    ANQ     131064,DL
         6 000066   013130 116007                    CMPQ    5720,DL
         6 000067   000100 601000 6                  TNZ     s:9724

      305     9721    1       THEN IF ACCT_LINE.ACCT = ' '

   9721  6 000070   000006 237000 2                  LDAQ    ACCT_LINE
         6 000071   000002 117000 7                  CMPAQ   2
         6 000072   000076 601000 6                  TNZ     s:9723
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:39   

      306     9722    1          THEN ACCT_CHANGE = '1'B;

   9722  6 000073   400000 236003                    LDQ     -131072,DU
         6 000074   000165 756000 2                  STQ     ACCT_CHANGE
         6 000075   000130 710000 6                  TRA     s:9731

      307     9723    1          ELSE ACCT_CHANGE = '0'B;

   9723  6 000076   000165 450000 2                  STZ     ACCT_CHANGE
         6 000077   000130 710000 6                  TRA     s:9731

      308     9724    1       ELSE IF F$DCB.ACCT# ~= ACCT_LINE.ACCT OR ERR.CODE = %E$NOPROC

   9724  6 000100   200003 471500                    LDP1    @DCB$,,AUTO
         6 000101   100000 473500                    LDP3    0,,PR1
         6 000102   300020 237100                    LDAQ    16,,PR3
         6 000103   000006 117000 2                  CMPAQ   ACCT_LINE
         6 000104   000115 601000 6                  TNZ     s:9726
         6 000105   000000 236100                    LDQ     0,,PR0
         6 000106   377770 376007                    ANQ     131064,DL
         6 000107   003520 116007                    CMPQ    1872,DL
         6 000110   000115 600000 6                  TZE     s:9726
         6 000111   001020 116007                    CMPQ    528,DL
         6 000112   000115 600000 6                  TZE     s:9726
         6 000113   000760 116007                    CMPQ    496,DL
         6 000114   000120 601000 6                  TNZ     s:9727

      309     9725    1           OR ERR.CODE = %E$NOKEY OR ERR.CODE = %E$NEWREC
      310     9726    1          THEN ACCT_CHANGE = '1'B;

   9726  6 000115   400000 236003                    LDQ     -131072,DU
         6 000116   000165 756000 2                  STQ     ACCT_CHANGE
         6 000117   000130 710000 6                  TRA     s:9731

      311     9727    1          ELSE IF F$DCB.PSN# ~= ACCT_LINE.PSN

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:40   
   9727  6 000120   040000 106500                    CMPC    fill='040'O
         6 000121   300024 000006                    ADSC9   20,,PR3                  cn=0,n=6
         6 000122   000011 400006 2                  ADSC9   ACCT_LINE+3              cn=2,n=6
         6 000123   000127 600000 6                  TZE     s:9729

      312     9728    1             THEN ACCT_CHANGE = '1'B;

   9728  6 000124   400000 236003                    LDQ     -131072,DU
         6 000125   000165 756000 2                  STQ     ACCT_CHANGE
         6 000126   000130 710000 6                  TRA     s:9731

      313     9729    1             ELSE ACCT_CHANGE = '0'B;

   9729  6 000127   000165 450000 2                  STZ     ACCT_CHANGE

      314     9730
      315     9731    1      IF ACCT_CHANGE

   9731  6 000130   000165 234000 2                  SZN     ACCT_CHANGE
         6 000131   000135 605000 6                  TPL     s:9733

      316     9732    1       THEN NBR_LINES_NEEDED = 2;

   9732  6 000132   000002 235007                    LDA     2,DL
         6 000133   000163 755000 2                  STA     NBR_LINES_NEEDED
         6 000134   000146 710000 6                  TRA     s:9737

      317     9733    1       ELSE IF TSN ~= ACCT_LINE.TSN

   9733  6 000135   200005 471500                    LDP1    @TSN,,AUTO
         6 000136   040000 106500                    CMPC    fill='040'O
         6 000137   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6
         6 000140   000021 400006 2                  ADSC9   ACCT_LINE+11             cn=2,n=6
         6 000141   000145 600000 6                  TZE     s:9735

      318     9734    1          THEN NBR_LINES_NEEDED = 1;

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:41   
   9734  6 000142   000001 235007                    LDA     1,DL
         6 000143   000163 755000 2                  STA     NBR_LINES_NEEDED
         6 000144   000146 710000 6                  TRA     s:9737

      319     9735    1          ELSE NBR_LINES_NEEDED = 0;

   9735  6 000145   000163 450000 2                  STZ     NBR_LINES_NEEDED

      320     9736
      321     9737    1      IF NOT ACCOUNT_ONLY

   9737  6 000146   000164 234000 2                  SZN     ACCOUNT_ONLY
         6 000147   000157 604000 6                  TMI     s:9742

      322     9738    1       THEN IF DISK_OPTION.LEA

   9738  6 000150   000000 236000 xsym               LDQ     DISK_OPTION
         6 000151   040000 316003                    CANQ    16384,DU
         6 000152   000156 600000 6                  TZE     s:9740

      323     9739    1          THEN NBR_LINES_NEEDED = NBR_LINES_NEEDED + 4;

   9739  6 000153   000004 236007                    LDQ     4,DL
         6 000154   000163 056000 2                  ASQ     NBR_LINES_NEEDED
         6 000155   000157 710000 6                  TRA     s:9742

      324     9740    1          ELSE NBR_LINES_NEEDED = NBR_LINES_NEEDED + 1;

   9740  6 000156   000163 054000 2                  AOS     NBR_LINES_NEEDED

      325     9741
      326     9742    1      IF NBR_LINES_NEEDED > 1

   9742  6 000157   000163 235000 2                  LDA     NBR_LINES_NEEDED
         6 000160   000001 115007                    CMPA    1,DL
         6 000161   000200 604400 6                  TMOZ    s:9754

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:42   
      327     9743    2       THEN DO;

      328     9744    2         CALL M$LINES( GET_LO_LINES ) ALTRET( ERROR_OUT );

   9744  6 000162   000306 630400 2                  EPPR0   GET_LO_LINES
         6 000163   450005 713400                    CLIMB   alt,+20485
         6 000164   400400 401760                    pmme    nvectors=2
         6 000165   002311 702000 6                  TSX2    ERROR_OUT

      329     9745    2         IF VLR_LINES.RLINES# < NBR_LINES_NEEDED

   9745  6 000166   000314 236000 2                  LDQ     VLR_LINES
         6 000167   000022 732000                    QRS     18
         6 000170   000163 116000 2                  CMPQ    NBR_LINES_NEEDED
         6 000171   000200 605000 6                  TPL     s:9754
         6 000172   000000 620006                    EAX0    0,QL
         6 000173   000200 604400 6                  TMOZ    s:9754

      330     9746    2           AND VLR_LINES.RLINES# > 0
      331     9747    2          THEN CALL M$DEVICE( PAGE_LO ) ALTRET( ERROR_OUT );

   9747  6 000174   000316 630400 2                  EPPR0   PAGE_LO
         6 000175   450006 713400                    CLIMB   alt,+20486
         6 000176   401000 401760                    pmme    nvectors=3
         6 000177   002311 702000 6                  TSX2    ERROR_OUT

      332     9748    2         END;

      333     9749
      334     9750        /***
      335     9751         *** If account or tape has changed, print new account line.
      336     9752         ***/
      337     9753
      338     9754    1      IF ACCT_CHANGE OR (TSN ~= ACCT_LINE.TSN AND ERR.CODE ~= %E$OLDREC)

   9754  6 000200   000165 234000 2                  SZN     ACCT_CHANGE
         6 000201   000214 604000 6                  TMI     s:9756
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:43   
         6 000202   200005 470500                    LDP0    @TSN,,AUTO
         6 000203   040000 106500                    CMPC    fill='040'O
         6 000204   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6
         6 000205   000021 400006 2                  ADSC9   ACCT_LINE+11             cn=2,n=6
         6 000206   000543 600000 6                  TZE     s:9838
         6 000207   200011 471500                    LDP1    @ERR,,AUTO
         6 000210   100000 236100                    LDQ     0,,PR1
         6 000211   377770 376007                    ANQ     131064,DL
         6 000212   000750 116007                    CMPQ    488,DL
         6 000213   000543 600000 6                  TZE     s:9838

      339     9755    2       THEN DO;                  /* Account or tape change; print new header     */

      340     9756    2         CALL M$DEVICE( ERASE_HEADER ) ALTRET( ERROR_OUT );

   9756  6 000214   000330 630400 2                  EPPR0   ERASE_HEADER
         6 000215   450006 713400                    CLIMB   alt,+20486
         6 000216   401000 401760                    pmme    nvectors=3
         6 000217   002311 702000 6                  TSX2    ERROR_OUT

      341     9757    2         IF ACCT_CHANGE

   9757  6 000220   000165 234000 2                  SZN     ACCT_CHANGE
         6 000221   000230 605000 6                  TPL     s:9762

      342     9758    3          THEN DO;

      343     9759    3            WRITE_LO.BUF_ = VECTOR(BLANK);

   9759  6 000222   000004 237000 7                  LDAQ    4
         6 000223   000174 757000 2                  STAQ    WRITE_LO+4

      344     9760    3            CALL M$WRITE( WRITE_LO ) ALTRET( ERROR_OUT );

   9760  6 000224   000170 630400 2                  EPPR0   WRITE_LO
         6 000225   440001 713400                    CLIMB   alt,write
         6 000226   401400 401760                    pmme    nvectors=4
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:44   
         6 000227   002311 702000 6                  TSX2    ERROR_OUT

      345     9761    3            END;

      346     9762    2         ACCT_LINE.ACCT = F$DCB.ACCT#;

   9762  6 000230   200003 470500                    LDP0    @DCB$,,AUTO
         6 000231   000000 471500                    LDP1    0,,PR0
         6 000232   100020 237100                    LDAQ    16,,PR1
         6 000233   000006 757000 2                  STAQ    ACCT_LINE

      347     9763    2         IF NOT TEST_MODE

   9763  6 000234   000000 234000 xsym               SZN     TEST_MODE
         6 000235   000242 604000 6                  TMI     s:9766

      348     9764    2          THEN CALL M$TIME( GET_ACCT_LINE_DATE );

   9764  6 000236   000204 630400 2                  EPPR0   GET_ACCT_LINE_DATE
         6 000237   020004 713400                    CLIMB   8196
         6 000240   402000 401760                    pmme    nvectors=5
         6 000241   000250 710000 6                  TRA     s:9769

      349     9765    3          ELSE DO;

      350     9766    3            ACCT_LINE.DATE = ' ';

   9766  6 000242   040000 100400                    MLR     fill='040'O
         6 000243   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000244   000013 200010 2                  ADSC9   ACCT_LINE+5              cn=1,n=8

      351     9767    3            ACCT_LINE.TIME = ' ';

   9767  6 000245   040000 100400                    MLR     fill='040'O
         6 000246   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000247   000015 400005 2                  ADSC9   ACCT_LINE+7              cn=2,n=5

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:45   
      352     9768    3            END;

      353     9769    2         ACCT_LINE.PSN = F$DCB.PSN#;

   9769  6 000250   200003 470500                    LDP0    @DCB$,,AUTO
         6 000251   000000 471500                    LDP1    0,,PR0
         6 000252   040000 100500                    MLR     fill='040'O
         6 000253   100024 000006                    ADSC9   20,,PR1                  cn=0,n=6
         6 000254   000011 400006 2                  ADSC9   ACCT_LINE+3              cn=2,n=6

      354     9770    2         IF ERR.CODE = %E$OLDREC

   9770  6 000255   200011 471500                    LDP1    @ERR,,AUTO
         6 000256   100000 236100                    LDQ     0,,PR1
         6 000257   377770 376007                    ANQ     131064,DL
         6 000260   000750 116007                    CMPQ    488,DL
         6 000261   000274 601000 6                  TNZ     s:9777

      355     9771    3          THEN DO;                         /* Called from WHERE command          */

      356     9772    3            ACCT_LINE.TSN = ' ';

   9772  6 000262   040000 100400                    MLR     fill='040'O
         6 000263   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000264   000021 400006 2                  ADSC9   ACCT_LINE+11             cn=2,n=6

      357     9773    3            ACCT_LINE.LT = ' ';

   9773  6 000265   040000 100400                    MLR     fill='040'O
         6 000266   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000267   000020 600003 2                  ADSC9   ACCT_LINE+10             cn=3,n=3

      358     9774    3            ACCT_LINE.FSN = ' ';

   9774  6 000270   040000 100400                    MLR     fill='040'O
         6 000271   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000272   000017 000006 2                  ADSC9   ACCT_LINE+9              cn=0,n=6
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:46   

      359     9775    3            END;

   9775  6 000273   000350 710000 6                  TRA     s:9796

      360     9776    3          ELSE DO;

      361     9777    3            ACCT_LINE.TSN = TSN;

   9777  6 000274   200005 473500                    LDP3    @TSN,,AUTO
         6 000275   040000 100500                    MLR     fill='040'O
         6 000276   300000 000006                    ADSC9   0,,PR3                   cn=0,n=6
         6 000277   000021 400006 2                  ADSC9   ACCT_LINE+11             cn=2,n=6

      362     9778    3            IF ACCT_LINE.TSN ~= ' '

   9778  6 000300   040000 106400                    CMPC    fill='040'O
         6 000301   000021 400006 2                  ADSC9   ACCT_LINE+11             cn=2,n=6
         6 000302   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000303   000326 600000 6                  TZE     s:9788

      363     9779    4             THEN DO;

      364     9780    4               IF DEV_LT

   9780  6 000304   200012 474500                    LDP4    @DEV_LT,,AUTO
         6 000305   400000 234100                    SZN     0,,PR4
         6 000306   000322 605000 6                  TPL     s:9786

      365     9781    5                THEN DO;

      366     9782    5                  IF SUBSTR(TAPE_OPEN.V.RES#,0,2) = 'OD'

   9782  6 000307   000050 220000 xsym               LDX0    TAPE_OPEN+40
         6 000310   000025 100000 5                  CMPX0   ORG_STR_TBL+20
         6 000311   000316 601000 6                  TNZ     s:9784

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:47   
      367     9783    5                   THEN ACCT_LINE.LT = 'OD#';

   9783  6 000312   040000 100400                    MLR     fill='040'O
         6 000313   000026 000003 5                  ADSC9   ORG_STR_TBL+21           cn=0,n=3
         6 000314   000020 600003 2                  ADSC9   ACCT_LINE+10             cn=3,n=3
         6 000315   000331 710000 6                  TRA     s:9789

      368     9784    5                   ELSE ACCT_LINE.LT = 'LT#';

   9784  6 000316   040000 100400                    MLR     fill='040'O
         6 000317   000027 000003 5                  ADSC9   ORG_STR_TBL+22           cn=0,n=3
         6 000320   000020 600003 2                  ADSC9   ACCT_LINE+10             cn=3,n=3

      369     9785    5                  END;

   9785  6 000321   000331 710000 6                  TRA     s:9789

      370     9786    4                ELSE ACCT_LINE.LT = 'DP#';

   9786  6 000322   040000 100400                    MLR     fill='040'O
         6 000323   000030 000003 5                  ADSC9   ORG_STR_TBL+23           cn=0,n=3
         6 000324   000020 600003 2                  ADSC9   ACCT_LINE+10             cn=3,n=3

      371     9787    4               END;

   9787  6 000325   000331 710000 6                  TRA     s:9789

      372     9788    3             ELSE ACCT_LINE.LT = ' ';

   9788  6 000326   040000 100400                    MLR     fill='040'O
         6 000327   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000330   000020 600003 2                  ADSC9   ACCT_LINE+10             cn=3,n=3

      373     9789    3            IF ADDR(FSN) ~= ADDR(NIL)

   9789  6 000331   200006 236100                    LDQ     @FSN,,AUTO
         6 000332   000001 116000 xsym               CMPQ    B_VECTNIL+1
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:48   
         6 000333   000345 600000 6                  TZE     s:9794

      374     9790    4             THEN DO;

      375     9791    4               CALL BINCHAR( ACCT_LINE.FSN, FSN );

   9791  6 000334   200006 474500                    LDP4    @FSN,,AUTO
         6 000335   000000 301500                    BTD
         6 000336   400000 000004                    NDSC9   0,,PR4                   cn=0,s=lsgnf,sf=0,n=4
         6 000337   000017 030006 2                  NDSC9   ACCT_LINE+9              cn=0,s=nosgn,sf=0,n=6

      376     9792    4               CALL EDITCHAR( ACCT_LINE.FSN, , , NO_LEADING_6_ZEROS, ACCT_LINE.FSN );

   9792  6 000340   000000 024400                    MVNE
         6 000341   000017 030006 2                  NDSC9   ACCT_LINE+9              cn=0,s=nosgn,sf=0,n=6
         6 000342   000000 000001 xsym               ADSC9   NO_LEADING_6_ZEROS       cn=0,n=1
         6 000343   000017 000006 2                  ADSC9   ACCT_LINE+9              cn=0,n=6

      377     9793    4               END;

   9793  6 000344   000350 710000 6                  TRA     s:9796

      378     9794    3             ELSE ACCT_LINE.FSN = ' ';

   9794  6 000345   040000 100400                    MLR     fill='040'O
         6 000346   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000347   000017 000006 2                  ADSC9   ACCT_LINE+9              cn=0,n=6

      379     9795    3            END;

      380     9796    3         DO SELECT( ERR.CODE );

   9796  6 000350   100000 236100                    LDQ     0,,PR1
         6 000351   000003 772000                    QRL     3
         6 000352   037777 376007                    ANQ     16383,DL
         6 000353   000154 116007                    CMPQ    108,DL
         6 000354   000365 602000 6                  TNC     s:9796+13
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:49   
         6 000355   000417 600000 6                  TZE     s:9804
         6 000356   000352 116007                    CMPQ    234,DL
         6 000357   000452 602000 6                  TNC     s:9815
         6 000360   000411 600000 6                  TZE     s:9801
         6 000361   000003 736000                    QLS     3
         6 000362   013130 116007                    CMPQ    5720,DL
         6 000363   000452 601000 6                  TNZ     s:9815
         6 000364   000426 710000 6                  TRA     s:9807
         6 000365   100000 236100                    LDQ     0,,PR1
         6 000366   000003 772000                    QRL     3
         6 000367   037777 376007                    ANQ     16383,DL
         6 000370   000076 116007                    CMPQ    62,DL
         6 000371   000377 602000 6                  TNC     s:9796+23
         6 000372   000446 600000 6                  TZE     s:9813
         6 000373   000003 736000                    QLS     3
         6 000374   001020 116007                    CMPQ    528,DL
         6 000375   000452 601000 6                  TNZ     s:9815
         6 000376   000403 710000 6                  TRA     s:9798
         6 000377   100000 236100                    LDQ     0,,PR1
         6 000400   377770 316007                    CANQ    131064,DL
         6 000401   000441 600000 6                  TZE     s:9811
         6 000402   000452 710000 6                  TRA     s:9815

      381     9797    3            SELECT( %E$NOKEY );

      382     9798    3            ACCT_LINE.CONT = ' deleted';

   9798  6 000403   040000 100400                    MLR     fill='040'O
         6 000404   000031 000010 5                  ADSC9   ORG_STR_TBL+24           cn=0,n=8
         6 000405   000023 000010 2                  ADSC9   ACCT_LINE+13             cn=0,n=8

      383     9799    3            ACCOUNT_ONLY = '1'B;

   9799  6 000406   400000 236003                    LDQ     -131072,DU
         6 000407   000164 756000 2                  STQ     ACCOUNT_ONLY
         6 000410   000464 710000 6                  TRA     s:9819

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:50   
      384     9800    3            SELECT( %E$NOPROC );

      385     9801    3            ACCT_LINE.CONT = ' cleanup';

   9801  6 000411   040000 100400                    MLR     fill='040'O
         6 000412   000033 000010 5                  ADSC9   ORG_STR_TBL+26           cn=0,n=8
         6 000413   000023 000010 2                  ADSC9   ACCT_LINE+13             cn=0,n=8

      386     9802    3            ACCOUNT_ONLY = '1'B;

   9802  6 000414   400000 236003                    LDQ     -131072,DU
         6 000415   000164 756000 2                  STQ     ACCOUNT_ONLY
         6 000416   000464 710000 6                  TRA     s:9819

      387     9803    3            SELECT( %E$FDEOF );

      388     9804    3            ACCT_LINE.CONT = ' ';

   9804  6 000417   000035 235000 xsym               LDA     B_VECTNIL+29
         6 000420   000035 236000 xsym               LDQ     B_VECTNIL+29
         6 000421   000023 755000 2                  STA     ACCT_LINE+13
         6 000422   000024 756000 2                  STQ     ACCT_LINE+14

      389     9805    3            ACCOUNT_ONLY = '1'B;

   9805  6 000423   400000 236003                    LDQ     -131072,DU
         6 000424   000164 756000 2                  STQ     ACCOUNT_ONLY
         6 000425   000464 710000 6                  TRA     s:9819

      390     9806    3            SELECT( %E$EOVOL );

      391     9807    3            ACCT_LINE.CONT = ' ';

   9807  6 000426   000035 235000 xsym               LDA     B_VECTNIL+29
         6 000427   000035 236000 xsym               LDQ     B_VECTNIL+29
         6 000430   000023 755000 2                  STA     ACCT_LINE+13
         6 000431   000024 756000 2                  STQ     ACCT_LINE+14
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:51   

      392     9808    3            ACCT_LINE.DATE = 'checking';

   9808  6 000432   040000 100400                    MLR     fill='040'O
         6 000433   000035 000010 5                  ADSC9   ORG_STR_TBL+28           cn=0,n=8
         6 000434   000013 200010 2                  ADSC9   ACCT_LINE+5              cn=1,n=8

      393     9809    3            ACCT_LINE.TIME = 'at';

   9809  6 000435   040000 100400                    MLR     fill='040'O
         6 000436   000037 000002 5                  ADSC9   ORG_STR_TBL+30           cn=0,n=2
         6 000437   000015 400005 2                  ADSC9   ACCT_LINE+7              cn=2,n=5
         6 000440   000464 710000 6                  TRA     s:9819

      394     9810    3            SELECT( 0 );                   /* No error                           */

      395     9811    3            ACCT_LINE.CONT = ' ';

   9811  6 000441   000035 235000 xsym               LDA     B_VECTNIL+29
         6 000442   000035 236000 xsym               LDQ     B_VECTNIL+29
         6 000443   000023 755000 2                  STA     ACCT_LINE+13
         6 000444   000024 756000 2                  STQ     ACCT_LINE+14
         6 000445   000464 710000 6                  TRA     s:9819

      396     9812    3            SELECT( %E$NEWREC );

      397     9813    3            ACCT_LINE.CONT = ' skip';

   9813  6 000446   040000 100400                    MLR     fill='040'O
         6 000447   000040 000005 5                  ADSC9   ORG_STR_TBL+31           cn=0,n=5
         6 000450   000023 000010 2                  ADSC9   ACCT_LINE+13             cn=0,n=8
         6 000451   000464 710000 6                  TRA     s:9819

      398     9814    3            SELECT( ELSE );

      399     9815    3         IF ACCOUNT_ONLY

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:52   
   9815  6 000452   000164 234000 2                  SZN     ACCOUNT_ONLY
         6 000453   000460 605000 6                  TPL     s:9817

      400     9816    3          THEN ACCT_LINE.CONT = ' ***';

   9816  6 000454   040000 100400                    MLR     fill='040'O
         6 000455   000042 000004 5                  ADSC9   ORG_STR_TBL+33           cn=0,n=4
         6 000456   000023 000010 2                  ADSC9   ACCT_LINE+13             cn=0,n=8
         6 000457   000464 710000 6                  TRA     s:9819

      401     9817    3          ELSE ACCT_LINE.CONT = ' ';

   9817  6 000460   000035 235000 xsym               LDA     B_VECTNIL+29
         6 000461   000035 236000 xsym               LDQ     B_VECTNIL+29
         6 000462   000023 755000 2                  STA     ACCT_LINE+13
         6 000463   000024 756000 2                  STQ     ACCT_LINE+14

      402     9818    3            END;

      403     9819    2      WRITE_LO.BUF_ = VECTOR(ACCT_LINE);

   9819  6 000464   000006 237000 7                  LDAQ    6
         6 000465   000174 757000 2                  STAQ    WRITE_LO+4

      404     9820    2      IF OVER_FIL      /* if OVER DP#psn2 is issued, assign 2nd packset,write,*/

   9820  6 000466   000000 234000 xsym               SZN     OVER_FIL
         6 000467   000505 605000 6                  TPL     s:9826

      405     9821    3       THEN DO;             /* reassign psn,so format of printout will stay same */

      406     9822    3         ACCT_LINE.PSN = DISK_DEST_SN.SN#(0);

   9822  6 000470   040000 100400                    MLR     fill='040'O
         6 000471   000001 000006 xsym               ADSC9   DISK_DEST_SN+1           cn=0,n=6
         6 000472   000011 400006 2                  ADSC9   ACCT_LINE+3              cn=2,n=6

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:53   
      407     9823    3         CALL M$WRITE( WRITE_LO ) ALTRET( ERROR_OUT );

   9823  6 000473   000170 630400 2                  EPPR0   WRITE_LO
         6 000474   440001 713400                    CLIMB   alt,write
         6 000475   401400 401760                    pmme    nvectors=4
         6 000476   002311 702000 6                  TSX2    ERROR_OUT

      408     9824    3         ACCT_LINE.PSN = F$DCB.PSN#;

   9824  6 000477   200003 470500                    LDP0    @DCB$,,AUTO
         6 000500   000000 471500                    LDP1    0,,PR0
         6 000501   040000 100500                    MLR     fill='040'O
         6 000502   100024 000006                    ADSC9   20,,PR1                  cn=0,n=6
         6 000503   000011 400006 2                  ADSC9   ACCT_LINE+3              cn=2,n=6

      409     9825    3         END;                              /* if over_fil                        */

   9825  6 000504   000511 710000 6                  TRA     s:9827

      410     9826    2       ELSE CALL M$WRITE ( WRITE_LO ) ALTRET( ERROR_OUT );

   9826  6 000505   000170 630400 2                  EPPR0   WRITE_LO
         6 000506   440001 713400                    CLIMB   alt,write
         6 000507   401400 401760                    pmme    nvectors=4
         6 000510   002311 702000 6                  TSX2    ERROR_OUT

      411     9827    2      ACCT_LINE.CONT = ' (cont.)';

   9827  6 000511   040000 100400                    MLR     fill='040'O
         6 000512   000043 000010 5                  ADSC9   ORG_STR_TBL+34           cn=0,n=8
         6 000513   000023 000010 2                  ADSC9   ACCT_LINE+13             cn=0,n=8

      412     9828    2      ACCT_LINE.FSN = ' ';

   9828  6 000514   040000 100400                    MLR     fill='040'O
         6 000515   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000516   000017 000006 2                  ADSC9   ACCT_LINE+9              cn=0,n=6
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:54   

      413     9829    2      ACCT_LINE.DATE = ' ';

   9829  6 000517   040000 100400                    MLR     fill='040'O
         6 000520   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000521   000013 200010 2                  ADSC9   ACCT_LINE+5              cn=1,n=8

      414     9830    2      ACCT_LINE.TIME = ' ';

   9830  6 000522   040000 100400                    MLR     fill='040'O
         6 000523   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000524   000015 400005 2                  ADSC9   ACCT_LINE+7              cn=2,n=5

      415     9831    2      LO_HEADER.TITL.L# = LENGTHC(ACCT_LINE);

   9831  6 000525   074000 236003                    LDQ     30720,DU
         6 000526   000263 552040 2                  STBQ    LO_HEADER+1,'40'O

      416     9832    2      LO_HEADER.TITL.TITLE# = ACCT_LINE_CHARS;

   9832  6 000527   040000 100400                    MLR     fill='040'O
         6 000530   000006 000074 2                  ADSC9   ACCT_LINE                cn=0,n=60
         6 000531   000263 200113 2                  ADSC9   LO_HEADER+1              cn=1,n=75

      417     9833    2      CALL M$DEVICE( SET_LO_HEADER ) ALTRET( ERROR_OUT );

   9833  6 000532   000250 630400 2                  EPPR0   SET_LO_HEADER
         6 000533   450006 713400                    CLIMB   alt,+20486
         6 000534   401000 401760                    pmme    nvectors=3
         6 000535   002311 702000 6                  TSX2    ERROR_OUT

      418     9834    2      WRITE_LO.BUF_ = VECTOR(FILE_LINE);

   9834  6 000536   000010 237000 7                  LDAQ    8
         6 000537   000174 757000 2                  STAQ    WRITE_LO+4

      419     9835    2      FILE_NAME = ' ';
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:55   

   9835  6 000540   040000 100400                    MLR     fill='040'O
         6 000541   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000542   000051 000037 2                  ADSC9   FILE_NAME                cn=0,n=31

      420     9836    2         END;

      421     9837
      422     9838    1      IF ACCOUNT_ONLY THEN RETURN;

   9838  6 000543   000164 234000 2                  SZN     ACCOUNT_ONLY
         6 000544   000546 605000 6                  TPL     s:9844

   9838  6 000545   000000 702200 xent               TSX2  ! X66_ARET

      423     9839
      424     9840         /***
      425     9841          *** Print file line.
      426     9842          ***/
      427     9843
      428     9844    1      FILE_LINE_CHARS.INFO = ' ';

   9844  6 000546   040000 100400                    MLR     fill='040'O
         6 000547   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000550   000036 000053 2                  ADSC9   FILE_LINE+9              cn=0,n=43

      429     9845    1      IF FILE_NAME = F$DCB.NAME#.C

   9845  6 000551   200003 470500                    LDP0    @DCB$,,AUTO
         6 000552   000000 471500                    LDP1    0,,PR0
         6 000553   040100 106400                    CMPC    fill='040'O
         6 000554   000051 000037 2                  ADSC9   FILE_NAME                cn=0,n=31
         6 000555   100010 200037                    ADSC9   8,,PR1                   cn=1,n=31
         6 000556   000563 601000 6                  TNZ     s:9848

      430     9846    1       THEN FILE_LINE.NAME = ' "';

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:56   
   9846  6 000557   040000 100400                    MLR     fill='040'O
         6 000560   000045 000002 5                  ADSC9   ORG_STR_TBL+36           cn=0,n=2
         6 000561   000026 000037 2                  ADSC9   FILE_LINE+1              cn=0,n=31
         6 000562   000571 710000 6                  TRA     s:9851

      431     9847    2       ELSE DO;

      432     9848    2         FILE_NAME = F$DCB.NAME#.C;

   9848  6 000563   040000 100500                    MLR     fill='040'O
         6 000564   100010 200037                    ADSC9   8,,PR1                   cn=1,n=31
         6 000565   000051 000037 2                  ADSC9   FILE_NAME                cn=0,n=31

      433     9849    2         FILE_LINE.NAME = FILE_NAME;

   9849  6 000566   040000 100400                    MLR     fill='040'O
         6 000567   000051 000037 2                  ADSC9   FILE_NAME                cn=0,n=31
         6 000570   000026 000037 2                  ADSC9   FILE_LINE+1              cn=0,n=31

      434     9850    2         END;

      435     9851    1      IF ERR

   9851  6 000571   200011 471500                    LDP1    @ERR,,AUTO
         6 000572   100000 235100                    LDA     0,,PR1
         6 000573   000762 600000 6                  TZE     s:9909

      436     9852    2       THEN DO;

      437     9853    2         IF ERR.CODE = %E$NOPRS /* Error on DUAL INCR(1st pass) - no source file */

   9853  6 000574   100000 236100                    LDQ     0,,PR1
         6 000575   377770 376007                    ANQ     131064,DL
         6 000576   023010 116007                    CMPQ    9736,DL
         6 000577   000613 601000 6                  TNZ     s:9862

      438     9854    3          THEN DO;
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:57   

      439     9855    3            FILE_LINE.ARCDEL = 'D';        /* Source file previously deleted     */

   9855  6 000600   000104 236007                    LDQ     68,DL
         6 000601   000041 552004 2                  STBQ    FILE_LINE+12,'04'O

      440     9856    3            FILE_LINE.MOD_DATE = 'unknwn'; /* Deletion time unknown              */

   9856  6 000602   040000 100400                    MLR     fill='040'O
         6 000603   000046 000006 5                  ADSC9   ORG_STR_TBL+37           cn=0,n=6
         6 000604   000046 200006 2                  ADSC9   FILE_LINE+17             cn=1,n=6

      441     9857    3            CALL M$WRITE( WRITE_LO ) ALTRET(ERROR_OUT);

   9857  6 000605   000170 630400 2                  EPPR0   WRITE_LO
         6 000606   440001 713400                    CLIMB   alt,write
         6 000607   401400 401760                    pmme    nvectors=4
         6 000610   002311 702000 6                  TSX2    ERROR_OUT

      442     9858    3            TOTAL_FILES = TOTAL_FILES+1;

   9858  6 000611   000000 054000 xsym               AOS     TOTAL_FILES

      443     9859    3            RETURN;

   9859  6 000612   000000 702200 xent               TSX2  ! X66_ARET

      444     9860    3            END;
      445     9861
      446     9862    2         IF ERR.CODE ~= %E$FIT_ONLY        /* Error or info. "fit" to be output? */

   9862  6 000613   007640 116007                    CMPQ    4000,DL
         6 000614   000760 600000 6                  TZE     s:9906

      447     9863    3          THEN DO;

      448     9864    3            FILE_LINE.STAR_ERROR = '***';
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:58   

   9864  6 000615   000050 236000 5                  LDQ     ORG_STR_TBL+39
         6 000616   000050 552070 2                  STBQ    FILE_LINE+19,'70'O

      449     9865    3            IF ERR.CODE ~= %E$DI AND ERR.CODE ~= %E$IOERR

   9865  6 000617   100000 236100                    LDQ     0,,PR1
         6 000620   377770 376007                    ANQ     131064,DL
         6 000621   000110 116007                    CMPQ    72,DL
         6 000622   000762 600000 6                  TZE     s:9909
         6 000623   000100 116007                    CMPQ    64,DL
         6 000624   000762 600000 6                  TZE     s:9909
         6 000625   001350 116007                    CMPQ    744,DL
         6 000626   000762 600000 6                  TZE     s:9909

      450     9866    3              AND ERR.CODE ~= %E$BROKEN /* Don't print skip - was possibly moved */
      451     9867    4             THEN DO;                      /* Just file name and error indicator */

      452     9868    4               IF ERR.CODE = %E$NOFILE OR ERR.CODE = %E$OLDREC

   9868  6 000627   001610 116007                    CMPQ    904,DL
         6 000630   000633 600000 6                  TZE     s:9870
         6 000631   000750 116007                    CMPQ    488,DL
         6 000632   000750 601000 6                  TNZ     s:9901

      453     9869    5                THEN DO;

      454     9870    5                  IF ADDR(FSN) ~= ADDR(NIL)

   9870  6 000633   200006 236100                    LDQ     @FSN,,AUTO
         6 000634   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 000635   000646 600000 6                  TZE     s:9875

      455     9871    6                   THEN DO;

      456     9872    6                     CALL BINCHAR( FILE_LINE.FSN, FSN );

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:59   
   9872  6 000636   200006 473500                    LDP3    @FSN,,AUTO
         6 000637   000000 301500                    BTD
         6 000640   300000 000004                    NDSC9   0,,PR3                   cn=0,s=lsgnf,sf=0,n=4
         6 000641   000036 030006 2                  NDSC9   FILE_LINE+9              cn=0,s=nosgn,sf=0,n=6

      457     9873    6                     CALL EDITCHAR( FILE_LINE.FSN, , , NO_LEADING_6_ZEROS, FILE_LINE.
              9873                              FSN );

   9873  6 000642   000000 024400                    MVNE
         6 000643   000036 030006 2                  NDSC9   FILE_LINE+9              cn=0,s=nosgn,sf=0,n=6
         6 000644   000000 000001 xsym               ADSC9   NO_LEADING_6_ZEROS       cn=0,n=1
         6 000645   000036 000006 2                  ADSC9   FILE_LINE+9              cn=0,n=6

      458     9874    6                     END;

      459     9875    5                  IF ERR.CODE = %E$NOFILE

   9875  6 000646   100000 236100                    LDQ     0,,PR1
         6 000647   377770 376007                    ANQ     131064,DL
         6 000650   001610 116007                    CMPQ    904,DL
         6 000651   000656 601000 6                  TNZ     s:9878

      460     9876    5                   THEN FILE_LINE.MOD_DATE = ' clnup';

   9876  6 000652   040000 100400                    MLR     fill='040'O
         6 000653   000051 000006 5                  ADSC9   ORG_STR_TBL+40           cn=0,n=6
         6 000654   000046 200006 2                  ADSC9   FILE_LINE+17             cn=1,n=6
         6 000655   000735 710000 6                  TRA     s:9894

      461     9877    6                   ELSE DO;

      462     9878    6                     IF F$DCB.DESC.DELF#

   9878  6 000656   000000 473500                    LDP3    0,,PR0
         6 000657   300005 236100                    LDQ     5,,PR3
         6 000660   400000 316007                    CANQ    -131072,DL
         6 000661   000672 600000 6                  TZE     s:9882
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:60   

      463     9879    6                      THEN IF F$DCB.DESC.ARCHIVE#

   9879  6 000662   001000 316007                    CANQ    512,DL
         6 000663   000667 600000 6                  TZE     s:9881

      464     9880    6                         THEN FILE_LINE.ARCDEL = 'I'; /* Inactively archived     */

   9880  6 000664   000111 236007                    LDQ     73,DL
         6 000665   000041 552004 2                  STBQ    FILE_LINE+12,'04'O
         6 000666   000676 710000 6                  TRA     s:9884

      465     9881    6                         ELSE FILE_LINE.ARCDEL = 'D'; /* Deleted                 */

   9881  6 000667   000104 236007                    LDQ     68,DL
         6 000670   000041 552004 2                  STBQ    FILE_LINE+12,'04'O
         6 000671   000676 710000 6                  TRA     s:9884

      466     9882    6                      ELSE IF F$DCB.DESC.ARCHIVE#

   9882  6 000672   001000 316007                    CANQ    512,DL
         6 000673   000676 600000 6                  TZE     s:9884

      467     9883    6                         THEN FILE_LINE.ARCDEL = 'A'; /* Actively archived       */

   9883  6 000674   000101 236007                    LDQ     65,DL
         6 000675   000041 552004 2                  STBQ    FILE_LINE+12,'04'O

      468     9884    6                     IF F$DCB.DESC.BAD#

   9884  6 000676   000000 473500                    LDP3    0,,PR0
         6 000677   300005 236100                    LDQ     5,,PR3
         6 000700   020000 316007                    CANQ    8192,DL
         6 000701   000704 600000 6                  TZE     s:9886

      469     9885    6                      THEN FILE_LINE.BAD = 'B';

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:61   
   9885  6 000702   102000 236003                    LDQ     33792,DU
         6 000703   000042 552040 2                  STBQ    FILE_LINE+13,'40'O

      470     9886    6                     FILE_LINE2.TSN = TSN;

   9886  6 000704   200005 473500                    LDP3    @TSN,,AUTO
         6 000705   040000 100500                    MLR     fill='040'O
         6 000706   300000 000006                    ADSC9   0,,PR3                   cn=0,n=6
         6 000707   000037 600006 2                  ADSC9   FILE_LINE+10             cn=3,n=6

      471     9887    6                     IF TEST_MODE AND F$DCB.ACCT# = BACKUP_ACCT.ACCT#

   9887  6 000710   000000 234000 xsym               SZN     TEST_MODE
         6 000711   000724 605000 6                  TPL     s:9890
         6 000712   000000 474500                    LDP4    0,,PR0
         6 000713   400020 237100                    LDAQ    16,,PR4
         6 000714   000344 117000 2                  CMPAQ   BACKUP_ACCT
         6 000715   000724 601000 6                  TNZ     s:9890
         6 000716   000041 236000 2                  LDQ     FILE_LINE+12
         6 000717   000777 376007                    ANQ     511,DL
         6 000720   000104 116007                    CMPQ    68,DL
         6 000721   000724 601000 6                  TNZ     s:9890

      472     9888    6                       AND FILE_LINE.ARCDEL = 'D'
      473     9889    6                      THEN TSTAMP = 0;

   9889  6 000722   000150 450000 2                  STZ     TSTAMP
         6 000723   000727 710000 6                  TRA     s:9891

      474     9890    6                      ELSE TSTAMP = F$DCB.EXPIRE#;

   9890  6 000724   000000 474500                    LDP4    0,,PR0
         6 000725   400035 235100                    LDA     29,,PR4
         6 000726   000150 755000 2                  STA     TSTAMP

      475     9891    6                     CALL M$TIME( GET_LEA_DATE );

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:62   
   9891  6 000727   000234 630400 2                  EPPR0   GET_LEA_DATE
         6 000730   020004 713400                    CLIMB   8196
         6 000731   402000 401760                    pmme    nvectors=5

      476     9892    6                     FILE_LINE2.WHERE_ON = LEA_DATE_CHARS;

   9892  6 000732   040000 100400                    MLR     fill='040'O
         6 000733   000154 000021 2                  ADSC9   LEA_DATE                 cn=0,n=17
         6 000734   000043 400021 2                  ADSC9   FILE_LINE+14             cn=2,n=17

      477     9893    6                     END;

      478     9894    5                  FILE_LINE.STAR_ERROR = ' ';

   9894  6 000735   000000 236000 7                  LDQ     0
         6 000736   000050 552070 2                  STBQ    FILE_LINE+19,'70'O

      479     9895    5                  IF ADDR(FITONLY) ~= ADDR(NIL) /* Output "fit" if fit only      */

   9895  6 000737   200013 236100                    LDQ     @FITONLY,,AUTO
         6 000740   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 000741   000753 600000 6                  TZE     s:9902

      480     9896    6                   THEN DO;

      481     9897    6                     IF FITONLY

   9897  6 000742   200013 470500                    LDP0    @FITONLY,,AUTO
         6 000743   000000 234100                    SZN     0,,PR0
         6 000744   000753 605000 6                  TPL     s:9902

      482     9898    6                      THEN FILE_LINE.STAR_ERROR = 'fit';

   9898  6 000745   000053 236000 5                  LDQ     ORG_STR_TBL+42
         6 000746   000050 552070 2                  STBQ    FILE_LINE+19,'70'O

      483     9899    6                     END;
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:63   

      484     9900    5                  END;

   9900  6 000747   000753 710000 6                  TRA     s:9902

      485     9901    4                ELSE FILE_LINE.MOD_DATE = ' skip';

   9901  6 000750   040000 100400                    MLR     fill='040'O
         6 000751   000040 000005 5                  ADSC9   ORG_STR_TBL+31           cn=0,n=5
         6 000752   000046 200006 2                  ADSC9   FILE_LINE+17             cn=1,n=6

      486     9902    4               CALL M$WRITE( WRITE_LO ) ALTRET( ERROR_OUT );

   9902  6 000753   000170 630400 2                  EPPR0   WRITE_LO
         6 000754   440001 713400                    CLIMB   alt,write
         6 000755   401400 401760                    pmme    nvectors=4
         6 000756   002311 702000 6                  TSX2    ERROR_OUT

      487     9903    4               RETURN;

   9903  6 000757   000000 702200 xent               TSX2  ! X66_ARET

      488     9904    4               END;
      489     9905    3            END;
      490     9906    2          ELSE FILE_LINE.STAR_ERROR = 'fit'; /* Info. Occurs only on ACUP tape save */

   9906  6 000760   000053 236000 5                  LDQ     ORG_STR_TBL+42
         6 000761   000050 552070 2                  STBQ    FILE_LINE+19,'70'O

      491     9907    2         END;

      492     9908
      493     9909    1      TOTAL_FILES = TOTAL_FILES + 1;

   9909  6 000762   000000 054000 xsym               AOS     TOTAL_FILES

      494     9910
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:64   
      495     9911    1      IF ADDR(FSN) ~= ADDR(NIL)

   9911  6 000763   200006 236100                    LDQ     @FSN,,AUTO
         6 000764   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 000765   000776 600000 6                  TZE     s:9916

      496     9912    2       THEN DO;

      497     9913    2         CALL BINCHAR( FILE_LINE.FSN, FSN );

   9913  6 000766   200006 473500                    LDP3    @FSN,,AUTO
         6 000767   000000 301500                    BTD
         6 000770   300000 000004                    NDSC9   0,,PR3                   cn=0,s=lsgnf,sf=0,n=4
         6 000771   000036 030006 2                  NDSC9   FILE_LINE+9              cn=0,s=nosgn,sf=0,n=6

      498     9914    2         CALL EDITCHAR( FILE_LINE.FSN, , , NO_LEADING_6_ZEROS, FILE_LINE.FSN );

   9914  6 000772   000000 024400                    MVNE
         6 000773   000036 030006 2                  NDSC9   FILE_LINE+9              cn=0,s=nosgn,sf=0,n=6
         6 000774   000000 000001 xsym               ADSC9   NO_LEADING_6_ZEROS       cn=0,n=1
         6 000775   000036 000006 2                  ADSC9   FILE_LINE+9              cn=0,n=6

      499     9915    2         END;

      500     9916    1      IF ADDR(CROSS) ~= ADDR(NIL)

   9916  6 000776   200007 236100                    LDQ     @CROSS,,AUTO
         6 000777   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 001000   001005 600000 6                  TZE     s:9924

      501     9917    1       THEN FILE_LINE.CROSS = CROSS;

   9917  6 001001   200007 473500                    LDP3    @CROSS,,AUTO
         6 001002   040000 100500                    MLR     fill='040'O
         6 001003   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         6 001004   000037 400001 2                  ADSC9   FILE_LINE+10             cn=2,n=1

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:65   
      502     9918
      503     9919        /***
      504     9920         *** All opens are assumed to be ACS=BLOCK.  Determine pointer to
      505     9921         *** first word of FIT.
      506     9922         ***/
      507     9923
      508     9924    1      IF F$DCB.DESC.DELF#

   9924  6 001005   000000 473500                    LDP3    0,,PR0
         6 001006   300005 236100                    LDQ     5,,PR3
         6 001007   400000 316007                    CANQ    -131072,DL
         6 001010   001022 600000 6                  TZE     s:9928

      509     9925    1       THEN IF F$DCB.DESC.ARCHIVE#

   9925  6 001011   001000 316007                    CANQ    512,DL
         6 001012   001017 600000 6                  TZE     s:9927

      510     9926    1          THEN FIT$ = FPARAM$;

   9926  6 001013   200004 474500                    LDP4    @FPARAM$,,AUTO
         6 001014   400000 236100                    LDQ     0,,PR4
         6 001015   000152 756000 2                  STQ     FIT$
         6 001016   001033 710000 6                  TRA     s:9936

      511     9927    1          ELSE FIT$ = ADDR(NIL);

   9927  6 001017   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 001020   000152 756000 2                  STQ     FIT$
         6 001021   001033 710000 6                  TRA     s:9936

      512     9928    1       ELSE IF FPARAM$ = ADDR(NIL)

   9928  6 001022   200004 474500                    LDP4    @FPARAM$,,AUTO
         6 001023   400000 236100                    LDQ     0,,PR4
         6 001024   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 001025   001031 601000 6                  TNZ     s:9930
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:66   

      513     9929    1          THEN FIT$ = ADDR(NIL);

   9929  6 001026   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 001027   000152 756000 2                  STQ     FIT$
         6 001030   001033 710000 6                  TRA     s:9936

      514     9930    1          ELSE FIT$ = PINCRW( FPARAM$, SIZEW(FM$GRAN) );

   9930  6 001031   000005 036003                    ADLQ    5,DU
         6 001032   000152 756000 2                  STQ     FIT$

      515     9931
      516     9932        /***
      517     9933         *** CODE03 items.
      518     9934         ***/
      519     9935
      520     9936    1      EXPIRE = -1;

   9936  6 001033   000001 335007                    LCA     1,DL
         6 001034   000161 755000 2                  STA     EXPIRE

      521     9937    1      FLAG = '0'B;

   9937  6 001035   000153 450000 2                  STZ     FLAG

      522     9938    1      IF FIT$ ~= ADDR(NIL)

   9938  6 001036   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 001037   001047 600000 6                  TZE     s:9947

      523     9939    2       THEN DO;

      524     9940    2         CODE$ = FIT$;

   9940  6 001040   000147 756000 2                  STQ     CODE$

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:67   
      525     9941    2         CALL XSF$LOCCODP( CODE$, 03 )

   9941  6 001041   000012 630400 7                  EPPR0   10
         6 001042   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 001043   000000 701000 xent               TSX1    XSF$LOCCODP
         6 001044   001047 702000 6                  TSX2    s:9947

      526     9942    3          WHENRETURN DO;

      527     9943    3            FLAG = '1'B;

   9943  6 001045   400000 236003                    LDQ     -131072,DU
         6 001046   000153 756000 2                  STQ     FLAG

      528     9944    3            END;

      529     9945    2         END;

      530     9946
      531     9947    1      IF FLAG

   9947  6 001047   000153 234000 2                  SZN     FLAG
         6 001050   001122 605000 6                  TPL     s:9965

      532     9948    2       THEN DO;

      533     9949    2         FILE_LINE.ORG = ORG_STR_TBL(CODE03.ORG);

   9949  6 001051   000147 470400 2                  LDP0    CODE$
         6 001052   000000 236100                    LDQ     0,,PR0
         6 001053   000033 772000                    QRL     27
         6 001054   000003 402007                    MPY     3,DL
         6 001055   040000 100406                    MLR     fill='040'O
         6 001056   000001 000003 5                  ADSC9   ORG_STR_TBL,Q            cn=0,n=3
         6 001057   000037 600003 2                  ADSC9   FILE_LINE+10             cn=3,n=3

      534     9950    2         FILE_LINE.TYPE = CODE03.TYPE;
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:68   

   9950  6 001060   040000 100500                    MLR     fill='040'O
         6 001061   000001 400002                    ADSC9   1,,PR0                   cn=2,n=2
         6 001062   000040 600002 2                  ADSC9   FILE_LINE+11             cn=3,n=2

      535     9951    2         IF FILE_LINE.TYPE ~= ' '

   9951  6 001063   040000 106400                    CMPC    fill='040'O
         6 001064   000040 600002 2                  ADSC9   FILE_LINE+11             cn=3,n=2
         6 001065   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 001066   001071 600000 6                  TZE     s:9953

      536     9952    2          THEN FILE_LINE.TYSLASH = '/';

   9952  6 001067   057000 236007                    LDQ     24064,DL
         6 001070   000040 552010 2                  STBQ    FILE_LINE+11,'10'O

      537     9953    2         CALL BINCHAR( FILE_LINE.UGRANS, CODE03.UGRANS );

   9953  6 001071   000000 236100                    LDQ     0,,PR0
         6 001072   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 001073   000000 235003                    LDA     0,DU
         6 001074   200014 757100                    STAQ    @FITONLY+1,,AUTO
         6 001075   000000 301500                    BTD
         6 001076   200014 000010                    NDSC9   @FITONLY+1,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         6 001077   000042 430006 2                  NDSC9   FILE_LINE+13             cn=2,s=nosgn,sf=0,n=6

      538     9954    2         CALL EDITCHAR( FILE_LINE.UGRANS, , , NO_5_LEADING_ZEROS, FILE_LINE.UGRANS );

   9954  6 001100   000000 024400                    MVNE
         6 001101   000042 430006 2                  NDSC9   FILE_LINE+13             cn=2,s=nosgn,sf=0,n=6
         6 001102   000000 000003 xsym               ADSC9   NO_5_LEADING_ZEROS       cn=0,n=3
         6 001103   000042 400006 2                  ADSC9   FILE_LINE+13             cn=2,n=6

      539     9955    2         CALL BINCHAR( FILE_LINE.NRECS, CODE03.NRECS );

   9955  6 001104   000000 301500                    BTD
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:69   
         6 001105   000002 000004                    NDSC9   2,,PR0                   cn=0,s=lsgnf,sf=0,n=4
         6 001106   000044 230007 2                  NDSC9   FILE_LINE+15             cn=1,s=nosgn,sf=0,n=7

      540     9956    2         CALL EDITCHAR( FILE_LINE.NRECS, , , NO_6_LEADING_ZEROS, FILE_LINE.NRECS );

   9956  6 001107   000000 024400                    MVNE
         6 001110   000044 230007 2                  NDSC9   FILE_LINE+15             cn=1,s=nosgn,sf=0,n=7
         6 001111   000000 000003 xsym               ADSC9   NO_6_LEADING_ZEROS       cn=0,n=3
         6 001112   000044 200007 2                  ADSC9   FILE_LINE+15             cn=1,n=7

      541     9957    2         EXPIRE = CODE03.EXPIRE;

   9957  6 001113   000007 236100                    LDQ     7,,PR0
         6 001114   000022 732000                    QRS     18
         6 001115   000161 756000 2                  STQ     EXPIRE

      542     9958    2         TOTAL_GRANS = TOTAL_GRANS + CODE03.UGRANS;

   9958  6 001116   000000 236100                    LDQ     0,,PR0
         6 001117   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 001120   000000 036000 xsym               ADLQ    TOTAL_GRANS
         6 001121   000000 756000 xsym               STQ     TOTAL_GRANS

      543     9959    2         END;

      544     9960
      545     9961        /***
      546     9962         *** DCB.DESC items.
      547     9963         ***/
      548     9964
      549     9965    1      IF F$DCB.DESC.DELF#

   9965  6 001122   200003 470500                    LDP0    @DCB$,,AUTO
         6 001123   000000 471500                    LDP1    0,,PR0
         6 001124   100005 236100                    LDQ     5,,PR1
         6 001125   400000 316007                    CANQ    -131072,DL
         6 001126   001137 600000 6                  TZE     s:9969
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:70   

      550     9966    1       THEN IF F$DCB.DESC.ARCHIVE#

   9966  6 001127   001000 316007                    CANQ    512,DL
         6 001130   001134 600000 6                  TZE     s:9968

      551     9967    1          THEN FILE_LINE.ARCDEL = 'I';     /* Inactively archived                */

   9967  6 001131   000111 236007                    LDQ     73,DL
         6 001132   000041 552004 2                  STBQ    FILE_LINE+12,'04'O
         6 001133   001143 710000 6                  TRA     s:9972

      552     9968    1          ELSE FILE_LINE.ARCDEL = 'D';     /* Deleted                            */

   9968  6 001134   000104 236007                    LDQ     68,DL
         6 001135   000041 552004 2                  STBQ    FILE_LINE+12,'04'O
         6 001136   001143 710000 6                  TRA     s:9972

      553     9969    1       ELSE IF F$DCB.DESC.ARCHIVE#

   9969  6 001137   001000 316007                    CANQ    512,DL
         6 001140   001143 600000 6                  TZE     s:9972

      554     9970    1          THEN FILE_LINE.ARCDEL = 'A';     /* Actively archived                  */

   9970  6 001141   000101 236007                    LDQ     65,DL
         6 001142   000041 552004 2                  STBQ    FILE_LINE+12,'04'O

      555     9971
      556     9972    1      IF F$DCB.DESC.QS#

   9972  6 001143   000000 471500                    LDP1    0,,PR0
         6 001144   100005 236100                    LDQ     5,,PR1
         6 001145   010000 316007                    CANQ    4096,DL
         6 001146   001167 600000 6                  TZE     s:9982

      557     9973    1       THEN IF F$DCB.DESC.FETCH#
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:71   

   9973  6 001147   000010 316007                    CANQ    8,DL
         6 001150   001154 600000 6                  TZE     s:9976

      558     9974    1          THEN FILE_LINE.QUEUED_FOR = 'F'; /* Queued for retrieval (fetch)       */

   9974  6 001151   106000 236007                    LDQ     35840,DL
         6 001152   000041 552010 2                  STBQ    FILE_LINE+12,'10'O
         6 001153   001167 710000 6                  TRA     s:9982

      559     9975    2          ELSE DO;

      560     9976    2            FILE_LINE.QUEUED_FOR = 'S';    /* Queued for archival (stow)         */

   9976  6 001154   123000 236007                    LDQ     42496,DL
         6 001155   000041 552010 2                  STBQ    FILE_LINE+12,'10'O

      561     9977    2            IF F$DCB.DESC.ACTIVE#

   9977  6 001156   000000 471500                    LDP1    0,,PR0
         6 001157   100005 236100                    LDQ     5,,PR1
         6 001160   000100 316007                    CANQ    64,DL
         6 001161   001165 600000 6                  TZE     s:9979

      562     9978    2             THEN FILE_LINE.ARCDEL = 'A';  /* STOW ACTIVE                        */

   9978  6 001162   000101 236007                    LDQ     65,DL
         6 001163   000041 552004 2                  STBQ    FILE_LINE+12,'04'O
         6 001164   001167 710000 6                  TRA     s:9982

      563     9979    2             ELSE FILE_LINE.ARCDEL = 'I';  /* STOW INACTIVE                      */

   9979  6 001165   000111 236007                    LDQ     73,DL
         6 001166   000041 552004 2                  STBQ    FILE_LINE+12,'04'O

      564     9980    2            END;

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:72   
      565     9981
      566     9982    1      IF F$DCB.DESC.BAD#

   9982  6 001167   000000 471500                    LDP1    0,,PR0
         6 001170   100005 236100                    LDQ     5,,PR1
         6 001171   020000 316007                    CANQ    8192,DL
         6 001172   001175 600000 6                  TZE     s:9989

      567     9983    1       THEN FILE_LINE.BAD = 'B';           /* Bad                                */

   9983  6 001173   102000 236003                    LDQ     33792,DU
         6 001174   000042 552040 2                  STBQ    FILE_LINE+13,'40'O

      568     9984
      569     9985        /***
      570     9986         *** CODE04 items.
      571     9987         ***/
      572     9988
      573     9989    1      FLAG = '0'B;

   9989  6 001175   000153 450000 2                  STZ     FLAG

      574     9990    1      IF FIT$ ~= ADDR(NIL)

   9990  6 001176   000152 236000 2                  LDQ     FIT$
         6 001177   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 001200   001210 600000 6                  TZE     s:9999

      575     9991    2       THEN DO;

      576     9992    2         CODE$ = FIT$;

   9992  6 001201   000147 756000 2                  STQ     CODE$

      577     9993    2         CALL XSF$LOCCODP( CODE$, 04 )

   9993  6 001202   000014 630400 7                  EPPR0   12
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:73   
         6 001203   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 001204   000000 701000 xent               TSX1    XSF$LOCCODP
         6 001205   001210 702000 6                  TSX2    s:9999

      578     9994    3          WHENRETURN DO;

      579     9995    3            FLAG = '1'B;

   9995  6 001206   400000 236003                    LDQ     -131072,DU
         6 001207   000153 756000 2                  STQ     FLAG

      580     9996    3            END;

      581     9997    2         END;

      582     9998
      583     9999    1      IF DISK_OPTION.LEA

   9999  6 001210   000000 236000 xsym               LDQ     DISK_OPTION
         6 001211   040000 316003                    CANQ    16384,DU
         6 001212   001440 600000 6                  TZE     s:10053

      584    10000    2       THEN DO;

      585    10001    2         IF FLAG

  10001  6 001213   000153 234000 2                  SZN     FLAG
         6 001214   001363 605000 6                  TPL     s:10035

      586    10002    3          THEN DO;

      587    10003    3            IF TEST_MODE

  10003  6 001215   000000 234000 xsym               SZN     TEST_MODE
         6 001216   001221 605000 6                  TPL     s:10005

      588    10004    3             THEN TSTAMP = 0;
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:74   

  10004  6 001217   000150 450000 2                  STZ     TSTAMP
         6 001220   001224 710000 6                  TRA     s:10006

      589    10005    3             ELSE TSTAMP = CODE04.ACCESS.TIME;

  10005  6 001221   000147 470400 2                  LDP0    CODE$
         6 001222   000000 235100                    LDA     0,,PR0
         6 001223   000150 755000 2                  STA     TSTAMP

      590    10006    3            CALL M$TIME( GET_LEA_DATE );

  10006  6 001224   000234 630400 2                  EPPR0   GET_LEA_DATE
         6 001225   020004 713400                    CLIMB   8196
         6 001226   402000 401760                    pmme    nvectors=5

      591    10007    3            LEA1.ACCESSED_ON = LEA_DATE_CHARS;

  10007  6 001227   040000 100400                    MLR     fill='040'O
         6 001230   000154 000021 2                  ADSC9   LEA_DATE                 cn=0,n=17
         6 001231   000076 000021 2                  ADSC9   LEA1+13                  cn=0,n=17

      592    10008    3            TSTAMP = CODE04.CREATION.TIME;

  10008  6 001232   000147 470400 2                  LDP0    CODE$
         6 001233   000002 235100                    LDA     2,,PR0
         6 001234   000150 755000 2                  STA     TSTAMP

      593    10009    3            CALL M$TIME( GET_LEA_DATE );

  10009  6 001235   000234 630400 2                  EPPR0   GET_LEA_DATE
         6 001236   020004 713400                    CLIMB   8196
         6 001237   402000 401760                    pmme    nvectors=5

      594    10010    3            LEA1.CREATED_ON = LEA_DATE_CHARS;

  10010  6 001240   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:75   
         6 001241   000154 000021 2                  ADSC9   LEA_DATE                 cn=0,n=17
         6 001242   000063 000021 2                  ADSC9   LEA1+2                   cn=0,n=17

      595    10011    3            IF EXPIRE < 0

  10011  6 001243   000161 235000 2                  LDA     EXPIRE
         6 001244   001251 605000 6                  TPL     s:10014

      596    10012    3             THEN LEA3.WILL_EXPIRE_ON = '      never';

  10012  6 001245   040000 100400                    MLR     fill='040'O
         6 001246   000054 000013 5                  ADSC9   ORG_STR_TBL+43           cn=0,n=11
         6 001247   000127 000021 2                  ADSC9   LEA3+2                   cn=0,n=17
         6 001250   001311 710000 6                  TRA     s:10022

      597    10013    4             ELSE DO;

      598    10014    4               CALL XUD$UTS_DIFF_SEC(TEMP_UBIN,BITBIN('777777777777'O),TSTAMP);

  10014  6 001251   000016 630400 7                  EPPR0   14
         6 001252   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 001253   000000 701000 xent               TSX1    XUD$UTS_DIFF_SEC
         6 001254   000000 011000                    NOP     0

      599    10015    4               TEMP_UBIN = TEMP_UBIN / 86400;

  10015  6 001255   000162 236000 2                  LDQ     TEMP_UBIN
         6 001256   000001 772000                    QRL     1
         6 001257   124300 506007                    DIV     43200,DL
         6 001260   000162 756000 2                  STQ     TEMP_UBIN

      600    10016    4               IF TEMP_UBIN > EXPIRE       /* Limit expiration to maximum        */

  10016  6 001261   000000 116003                    CMPQ    0,DU
         6 001262   001265 604000 6                  TMI     s:10017
         6 001263   000161 116000 2                  CMPQ    EXPIRE
         6 001264   001267 604400 6                  TMOZ    s:10018
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:76   

      601    10017    4                THEN TEMP_UBIN = EXPIRE;

  10017  6 001265   000161 235000 2                  LDA     EXPIRE
         6 001266   000162 755000 2                  STA     TEMP_UBIN

      602    10018    4               CALL XUD$UTS_ADJ_25TH(TSTAMP,TSTAMP,TEMP_UBIN*%UTS_25TH_DAY#);

  10018  6 001267   000162 236000 2                  LDQ     TEMP_UBIN
         6 001270   000021 402000 7                  MPY     17
         6 001271   200014 756100                    STQ     @FITONLY+1,,AUTO
         6 001272   200014 630500                    EPPR0   @FITONLY+1,,AUTO
         6 001273   200017 450500                    STP0    @FITONLY+4,,AUTO
         6 001274   000020 236000 7                  LDQ     16
         6 001275   200016 756100                    STQ     @FITONLY+3,,AUTO
         6 001276   200015 756100                    STQ     @FITONLY+2,,AUTO
         6 001277   200015 630500                    EPPR0   @FITONLY+2,,AUTO
         6 001300   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 001301   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         6 001302   000000 011000                    NOP     0

      603    10019    4               CALL M$TIME( GET_LEA_DATE );

  10019  6 001303   000234 630400 2                  EPPR0   GET_LEA_DATE
         6 001304   020004 713400                    CLIMB   8196
         6 001305   402000 401760                    pmme    nvectors=5

      604    10020    4               LEA3.WILL_EXPIRE_ON = LEA_DATE_CHARS;

  10020  6 001306   040000 100400                    MLR     fill='040'O
         6 001307   000154 000021 2                  ADSC9   LEA_DATE                 cn=0,n=17
         6 001310   000127 000021 2                  ADSC9   LEA3+2                   cn=0,n=17

      605    10021    4               END;

      606    10022    3            IF TEST_MODE AND F$DCB.ACCT# = BACKUP_ACCT.ACCT#

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:77   
  10022  6 001311   000000 234000 xsym               SZN     TEST_MODE
         6 001312   001322 605000 6                  TPL     s:10024
         6 001313   200003 470500                    LDP0    @DCB$,,AUTO
         6 001314   000000 471500                    LDP1    0,,PR0
         6 001315   100020 237100                    LDAQ    16,,PR1
         6 001316   000344 117000 2                  CMPAQ   BACKUP_ACCT
         6 001317   001322 601000 6                  TNZ     s:10024

      607    10023    3             THEN TSTAMP = 0;

  10023  6 001320   000150 450000 2                  STZ     TSTAMP
         6 001321   001325 710000 6                  TRA     s:10025

      608    10024    3             ELSE TSTAMP = CODE04.MODIFY.TIME;

  10024  6 001322   000147 470400 2                  LDP0    CODE$
         6 001323   000001 235100                    LDA     1,,PR0
         6 001324   000150 755000 2                  STA     TSTAMP

      609    10025    3            CALL M$TIME( GET_LEA_DATE );

  10025  6 001325   000234 630400 2                  EPPR0   GET_LEA_DATE
         6 001326   020004 713400                    CLIMB   8196
         6 001327   402000 401760                    pmme    nvectors=5

      610    10026    3            LEA1.MODIFIED_ON = LEA_DATE_CHARS;

  10026  6 001330   040000 100400                    MLR     fill='040'O
         6 001331   000154 000021 2                  ADSC9   LEA_DATE                 cn=0,n=17
         6 001332   000071 200021 2                  ADSC9   LEA1+8                   cn=1,n=17

      611    10027    3            FILE_LINE.MOD_DATE = ' ';

  10027  6 001333   040000 100400                    MLR     fill='040'O
         6 001334   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 001335   000046 200006 2                  ADSC9   FILE_LINE+17             cn=1,n=6

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:78   
      612    10028    3            LEA2.ACCT = CODE04.CREATOR.ACCT;

  10028  6 001336   000147 470400 2                  LDP0    CODE$
         6 001337   040000 100500                    MLR     fill='040'O
         6 001340   000003 000010                    ADSC9   3,,PR0                   cn=0,n=8
         6 001341   000105 000010 2                  ADSC9   LEA2+2                   cn=0,n=8

      613    10029    3            LEA2.NAME = CODE04.CREATOR.NAME;

  10029  6 001342   040000 100500                    MLR     fill='040'O
         6 001343   000005 000014                    ADSC9   5,,PR0                   cn=0,n=12
         6 001344   000107 200014 2                  ADSC9   LEA2+4                   cn=1,n=12

      614    10030    3            IF LEA2.ACCT = ' ' AND LEA2.NAME = ' '

  10030  6 001345   040000 106400                    CMPC    fill='040'O
         6 001346   000105 000010 2                  ADSC9   LEA2+2                   cn=0,n=8
         6 001347   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 001350   001360 601000 6                  TNZ     s:10032
         6 001351   040000 106400                    CMPC    fill='040'O
         6 001352   000107 200014 2                  ADSC9   LEA2+4                   cn=1,n=12
         6 001353   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 001354   001360 601000 6                  TNZ     s:10032

      615    10031    3             THEN LEA2.ACCT_NAME_SEP = ' ';

  10031  6 001355   040000 236003                    LDQ     16384,DU
         6 001356   000107 552040 2                  STBQ    LEA2+4,'40'O
         6 001357   001536 710000 6                  TRA     s:10084

      616    10032    3             ELSE LEA2.ACCT_NAME_SEP = ',';

  10032  6 001360   054000 236003                    LDQ     22528,DU
         6 001361   000107 552040 2                  STBQ    LEA2+4,'40'O

      617    10033    3            END;

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:79   
  10033  6 001362   001536 710000 6                  TRA     s:10084

      618    10034    3          ELSE DO;

      619    10035    3            IF FIT$ ~= ADDR(NIL)

  10035  6 001363   000152 236000 2                  LDQ     FIT$
         6 001364   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 001365   001372 600000 6                  TZE     s:10038

      620    10036    3             THEN LEA1.CREATED_ON = ' ';

  10036  6 001366   040000 100400                    MLR     fill='040'O
         6 001367   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 001370   000063 000021 2                  ADSC9   LEA1+2                   cn=0,n=17
         6 001371   001415 710000 6                  TRA     s:10044

      621    10037    4             ELSE DO;                 /* Deleted file...indicate deletion time   */

      622    10038    4               IF TEST_MODE AND F$DCB.ACCT# = BACKUP_ACCT.ACCT#

  10038  6 001372   000000 234000 xsym               SZN     TEST_MODE
         6 001373   001403 605000 6                  TPL     s:10040
         6 001374   200003 470500                    LDP0    @DCB$,,AUTO
         6 001375   000000 471500                    LDP1    0,,PR0
         6 001376   100020 237100                    LDAQ    16,,PR1
         6 001377   000344 117000 2                  CMPAQ   BACKUP_ACCT
         6 001400   001403 601000 6                  TNZ     s:10040

      623    10039    4                THEN TSTAMP = 0;

  10039  6 001401   000150 450000 2                  STZ     TSTAMP
         6 001402   001407 710000 6                  TRA     s:10041

      624    10040    4                ELSE TSTAMP = F$DCB.EXPIRE#;

  10040  6 001403   200003 470500                    LDP0    @DCB$,,AUTO
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:80   
         6 001404   000000 471500                    LDP1    0,,PR0
         6 001405   100035 235100                    LDA     29,,PR1
         6 001406   000150 755000 2                  STA     TSTAMP

      625    10041    4               CALL M$TIME( GET_LEA_DATE );

  10041  6 001407   000234 630400 2                  EPPR0   GET_LEA_DATE
         6 001410   020004 713400                    CLIMB   8196
         6 001411   402000 401760                    pmme    nvectors=5

      626    10042    4               LEA1.CREATED_ON = LEA_DATE_CHARS;

  10042  6 001412   040000 100400                    MLR     fill='040'O
         6 001413   000154 000021 2                  ADSC9   LEA_DATE                 cn=0,n=17
         6 001414   000063 000021 2                  ADSC9   LEA1+2                   cn=0,n=17

      627    10043    4               END;

      628    10044    3            LEA3.WILL_EXPIRE_ON = '      never';

  10044  6 001415   040000 100400                    MLR     fill='040'O
         6 001416   000054 000013 5                  ADSC9   ORG_STR_TBL+43           cn=0,n=11
         6 001417   000127 000021 2                  ADSC9   LEA3+2                   cn=0,n=17

      629    10045    3            LEA1.ACCESSED_ON = ' ';

  10045  6 001420   040000 100400                    MLR     fill='040'O
         6 001421   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 001422   000076 000021 2                  ADSC9   LEA1+13                  cn=0,n=17

      630    10046    3            LEA1.MODIFIED_ON = ' ';

  10046  6 001423   040000 100400                    MLR     fill='040'O
         6 001424   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 001425   000071 200021 2                  ADSC9   LEA1+8                   cn=1,n=17

      631    10047    3            LEA2.ACCT = ' ';
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:81   

  10047  6 001426   000035 235000 xsym               LDA     B_VECTNIL+29
         6 001427   000035 236000 xsym               LDQ     B_VECTNIL+29
         6 001430   000105 755000 2                  STA     LEA2+2
         6 001431   000106 756000 2                  STQ     LEA2+3

      632    10048    3            LEA2.NAME = ' ';

  10048  6 001432   040000 100400                    MLR     fill='040'O
         6 001433   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 001434   000107 200014 2                  ADSC9   LEA2+4                   cn=1,n=12

      633    10049    3            LEA2.ACCT_NAME_SEP = ' ';

  10049  6 001435   040000 236003                    LDQ     16384,DU
         6 001436   000107 552040 2                  STBQ    LEA2+4,'40'O

      634    10050    3            END;

      635    10051    2         END;

  10051  6 001437   001536 710000 6                  TRA     s:10084

      636    10052    2       ELSE DO;

      637    10053    2         IF FLAG

  10053  6 001440   000153 234000 2                  SZN     FLAG
         6 001441   001462 605000 6                  TPL     s:10061

      638    10054    3          THEN DO;

      639    10055    3            IF TEST_MODE AND F$DCB.ACCT# = BACKUP_ACCT.ACCT#

  10055  6 001442   000000 234000 xsym               SZN     TEST_MODE
         6 001443   001453 605000 6                  TPL     s:10057
         6 001444   200003 470500                    LDP0    @DCB$,,AUTO
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:82   
         6 001445   000000 471500                    LDP1    0,,PR0
         6 001446   100020 237100                    LDAQ    16,,PR1
         6 001447   000344 117000 2                  CMPAQ   BACKUP_ACCT
         6 001450   001453 601000 6                  TNZ     s:10057

      640    10056    3             THEN TSTAMP = 0;

  10056  6 001451   000150 450000 2                  STZ     TSTAMP
         6 001452   001456 710000 6                  TRA     s:10058

      641    10057    3             ELSE TSTAMP = CODE04.MODIFY.TIME;

  10057  6 001453   000147 470400 2                  LDP0    CODE$
         6 001454   000001 235100                    LDA     1,,PR0
         6 001455   000150 755000 2                  STA     TSTAMP

      642    10058    3            CALL M$TIME( GET_FILE_LINE_MOD_DATE );

  10058  6 001456   000220 630400 2                  EPPR0   GET_FILE_LINE_MOD_DATE
         6 001457   020004 713400                    CLIMB   8196
         6 001460   402000 401760                    pmme    nvectors=5

      643    10059    3            END;

  10059  6 001461   001536 710000 6                  TRA     s:10084

      644    10060    3          ELSE DO;

      645    10061    3            IF FIT$ = ADDR(NIL)

  10061  6 001462   000152 236000 2                  LDQ     FIT$
         6 001463   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 001464   001506 601000 6                  TNZ     s:10068

      646    10062    4             THEN DO;                      /* Deleted file                       */

      647    10063    4               IF TEST_MODE AND F$DCB.ACCT# = BACKUP_ACCT.ACCT#
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:83   

  10063  6 001465   000000 234000 xsym               SZN     TEST_MODE
         6 001466   001476 605000 6                  TPL     s:10065
         6 001467   200003 470500                    LDP0    @DCB$,,AUTO
         6 001470   000000 471500                    LDP1    0,,PR0
         6 001471   100020 237100                    LDAQ    16,,PR1
         6 001472   000344 117000 2                  CMPAQ   BACKUP_ACCT
         6 001473   001476 601000 6                  TNZ     s:10065

      648    10064    4                THEN TSTAMP = 0;

  10064  6 001474   000150 450000 2                  STZ     TSTAMP
         6 001475   001502 710000 6                  TRA     s:10066

      649    10065    4                ELSE TSTAMP = F$DCB.EXPIRE#;

  10065  6 001476   200003 470500                    LDP0    @DCB$,,AUTO
         6 001477   000000 471500                    LDP1    0,,PR0
         6 001500   100035 235100                    LDA     29,,PR1
         6 001501   000150 755000 2                  STA     TSTAMP

      650    10066    4               CALL M$TIME( GET_FILE_LINE_MOD_DATE );

  10066  6 001502   000220 630400 2                  EPPR0   GET_FILE_LINE_MOD_DATE
         6 001503   020004 713400                    CLIMB   8196
         6 001504   402000 401760                    pmme    nvectors=5

      651    10067    4               END;

  10067  6 001505   001536 710000 6                  TRA     s:10084

      652    10068    3             ELSE IF F$DCB.DESC.ARCHIVE# AND F$DCB.DESC.DELF#

  10068  6 001506   200003 470500                    LDP0    @DCB$,,AUTO
         6 001507   000000 471500                    LDP1    0,,PR0
         6 001510   100005 236100                    LDQ     5,,PR1
         6 001511   001000 316007                    CANQ    512,DL
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:84   
         6 001512   001536 600000 6                  TZE     s:10084
         6 001513   400000 316007                    CANQ    -131072,DL
         6 001514   001536 600000 6                  TZE     s:10084

      653    10069    4                THEN DO;                   /* Inactively archived                */

      654    10070    4                  CODE$ = FIT$;

  10070  6 001515   000152 236000 2                  LDQ     FIT$
         6 001516   000147 756000 2                  STQ     CODE$

      655    10071    4                  CALL XSF$LOCCODP( CODE$, 06 )

  10071  6 001517   000022 630400 7                  EPPR0   18
         6 001520   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 001521   000000 701000 xent               TSX1    XSF$LOCCODP
         6 001522   001532 702000 6                  TSX2    s:10077

      656    10072    5                   WHENRETURN DO;

      657    10073    5                     TSTAMP = CODE06.STOW.TIME;

  10073  6 001523   000147 470400 2                  LDP0    CODE$
         6 001524   000000 235100                    LDA     0,,PR0
         6 001525   000150 755000 2                  STA     TSTAMP

      658    10074    5                     CALL M$TIME( GET_FILE_LINE_MOD_DATE );

  10074  6 001526   000220 630400 2                  EPPR0   GET_FILE_LINE_MOD_DATE
         6 001527   020004 713400                    CLIMB   8196
         6 001530   402000 401760                    pmme    nvectors=5

      659    10075    5                     END;

  10075  6 001531   001536 710000 6                  TRA     s:10084

      660    10076    5                   WHENALTRETURN DO;
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:85   

      661    10077    5                     FILE_LINE.MOD_DATE = '??????';

  10077  6 001532   040000 100400                    MLR     fill='040'O
         6 001533   000057 000006 5                  ADSC9   ORG_STR_TBL+46           cn=0,n=6
         6 001534   000046 200006 2                  ADSC9   FILE_LINE+17             cn=1,n=6

      662    10078    5                     TSTAMP = 0;

  10078  6 001535   000150 450000 2                  STZ     TSTAMP

      663    10079    5                     END;

      664    10080    4                  END;

      665    10081    3            END;

      666    10082    2         END;

      667    10083
      668    10084    1      CALL M$WRITE( WRITE_LO ) ALTRET( ERROR_OUT );

  10084  6 001536   000170 630400 2                  EPPR0   WRITE_LO
         6 001537   440001 713400                    CLIMB   alt,write
         6 001540   401400 401760                    pmme    nvectors=4
         6 001541   002311 702000 6                  TSX2    ERROR_OUT

      669    10085
      670    10086        /***
      671    10087         *** Handle cataloging.  Usually we'll just have to create the
      672    10088         *** appropriate key and record and write, but sometimes we'll
      673    10089         *** have to handle the case where additional records describing
      674    10090         *** the same file are inserted into (ONTO) the catalog file.
      675    10091         ***/
      676    10092
      677    10093    1      IF CATALOG_ON

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:86   
  10093  6 001542   000000 234000 xsym               SZN     CATALOG_ON
         6 001543   002034 605000 6                  TPL     s:10163

      678    10094    2       THEN DO;

      679    10095    2         CAT_KEY.L = LENGTHC(CAT_KEY.PSN)+LENGTHC(CAT_KEY.ACCT)+F$DCB.NAME#.L

  10095  6 001544   200003 470500                    LDP0    @DCB$,,AUTO
         6 001545   000000 471500                    LDP1    0,,PR0
         6 001546   100010 236100                    LDQ     8,,PR1
         6 001547   000033 772000                    QRL     27
         6 001550   000020 036007                    ADLQ    16,DL
         6 001551   000033 736000                    QLS     27
         6 001552   000000 552040 xsym               STBQ    CAT_KEY,'40'O

      680    10096    2           +LENGTHC(CAT_KEY.NAME.L)+LENGTHC(CAT_KEY.VERSION);
      681    10097    2         CAT_KEY.PSN = ACCT_LINE.PSN;

  10097  6 001553   040000 100400                    MLR     fill='040'O
         6 001554   000011 400006 2                  ADSC9   ACCT_LINE+3              cn=2,n=6
         6 001555   000000 200006 xsym               ADSC9   CAT_KEY                  cn=1,n=6

      682    10098    2         CAT_KEY.ACCT = ACCT_LINE.ACCT;

  10098  6 001556   040000 100400                    MLR     fill='040'O
         6 001557   000006 000010 2                  ADSC9   ACCT_LINE                cn=0,n=8
         6 001560   000001 600010 xsym               ADSC9   CAT_KEY+1                cn=3,n=8

      683    10099    2         CAT_KEY.NAME.C = FILE_LINE.NAME;

  10099  6 001561   040000 100400                    MLR     fill='040'O
         6 001562   000026 000037 2                  ADSC9   FILE_LINE+1              cn=0,n=31
         6 001563   000003 600037 xsym               ADSC9   CAT_KEY+3                cn=3,n=31

      684    10100    2         CAT_KEY3.VERSION(F$DCB.NAME#.L) = F$DCB.NAME#.L;

  10100  6 001564   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:87   
         6 001565   100010 236100                    LDQ     8,,PR1
         6 001566   000033 772000                    QRL     27
         6 001567   000006 100500                    MLR     fill='000'O
         6 001570   100010 000001                    ADSC9   8,,PR1                   cn=0,n=1
         6 001571   000003 600001 xsym               ADSC9   CAT_KEY+3,Q              cn=3,n=1

      685    10101    2         CAT_KEY3.VERSION(F$DCB.NAME#.L+1) = 0;
             10101                  /* Expect first cataloging of this file */

  10101  6 001572   000000 471500                    LDP1    0,,PR0
         6 001573   100010 236100                    LDQ     8,,PR1
         6 001574   000033 772000                    QRL     27
         6 001575   000006 101400                    MRL     fill='000'O
         6 001576   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         6 001577   000004 000001 xsym               ADSC9   CAT_KEY+4,Q              cn=0,n=1

      686    10102    2         CAT_REC.TSN = ACCT_LINE.TSN;

  10102  6 001600   040000 100400                    MLR     fill='040'O
         6 001601   000021 400006 2                  ADSC9   ACCT_LINE+11             cn=2,n=6
         6 001602   000001 000006 xsym               ADSC9   CAT_REC+1                cn=0,n=6

      687    10103    2         CAT_REC.UTS = TSTAMP;             /* Mod time, del time, or arc time    */

  10103  6 001603   000150 235000 2                  LDA     TSTAMP
         6 001604   000000 755000 xsym               STA     CAT_REC

      688    10104    2         CAT_REC.VERSION = 0;

  10104  6 001605   000000 236003                    LDQ     0,DU
         6 001606   000003 552040 xsym               STBQ    CAT_REC+3,'40'O

      689    10105    2         IF F$DCB.DESC.ODSTOW#

  10105  6 001607   000000 471500                    LDP1    0,,PR0
         6 001610   100005 236100                    LDQ     5,,PR1
         6 001611   040000 316007                    CANQ    16384,DL
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:88   
         6 001612   001636 600000 6                  TZE     s:10115

      690    10106    3          THEN DO;

      691    10107    3            IF ADDR(FSN) = ADDR(NIL)

  10107  6 001613   200006 236100                    LDQ     @FSN,,AUTO
         6 001614   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 001615   001621 601000 6                  TNZ     s:10109

      692    10108    3             THEN CAT_REC.ODFSN = 0;

  10108  6 001616   000000 220003                    LDX0    0,DU
         6 001617   000002 440000 xsym               SXL0    CAT_REC+2
         6 001620   001624 710000 6                  TRA     s:10110

      693    10109    3             ELSE CAT_REC.ODFSN = FSN;

  10109  6 001621   200006 473500                    LDP3    @FSN,,AUTO
         6 001622   300000 720100                    LXL0    0,,PR3
         6 001623   000002 440000 xsym               SXL0    CAT_REC+2

      694    10110    3            IF FILE_LINE.CROSS = ' '

  10110  6 001624   000037 236000 2                  LDQ     FILE_LINE+10
         6 001625   777000 376007                    ANQ     -512,DL
         6 001626   040000 116007                    CMPQ    16384,DL
         6 001627   001633 601000 6                  TNZ     s:10112

      695    10111    3             THEN CAT_REC.ODCROSS = '0'B;

  10111  6 001630   000024 236000 7                  LDQ     20
         6 001631   000003 356000 xsym               ANSQ    CAT_REC+3
         6 001632   001662 710000 6                  TRA     s:10122

      696    10112    3             ELSE CAT_REC.ODCROSS = '1'B;

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:89   
  10112  6 001633   000200 236007                    LDQ     128,DL
         6 001634   000003 256000 xsym               ORSQ    CAT_REC+3

      697    10113    3            END;

  10113  6 001635   001662 710000 6                  TRA     s:10122

      698    10114    3          ELSE DO;

      699    10115    3            IF ADDR(FSN) = ADDR(NIL)

  10115  6 001636   200006 236100                    LDQ     @FSN,,AUTO
         6 001637   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 001640   001644 601000 6                  TNZ     s:10117

      700    10116    3             THEN CAT_REC.LT.FSN = 0;

  10116  6 001641   000025 236000 7                  LDQ     21
         6 001642   000002 356000 xsym               ANSQ    CAT_REC+2
         6 001643   001651 710000 6                  TRA     s:10118

      701    10117    3             ELSE CAT_REC.LT.FSN = FSN;

  10117  6 001644   200006 473500                    LDP3    @FSN,,AUTO
         6 001645   300000 236100                    LDQ     0,,PR3
         6 001646   000002 676000 xsym               ERQ     CAT_REC+2
         6 001647   037777 376007                    ANQ     16383,DL
         6 001650   000002 656000 xsym               ERSQ    CAT_REC+2

      702    10118    3            IF FILE_LINE.CROSS = ' '

  10118  6 001651   000037 236000 2                  LDQ     FILE_LINE+10
         6 001652   777000 376007                    ANQ     -512,DL
         6 001653   040000 116007                    CMPQ    16384,DL
         6 001654   001660 601000 6                  TNZ     s:10120

      703    10119    3             THEN CAT_REC.LT.CROSS = '0'B;
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:90   

  10119  6 001655   000026 236000 7                  LDQ     22
         6 001656   000002 356000 xsym               ANSQ    CAT_REC+2
         6 001657   001662 710000 6                  TRA     s:10122

      704    10120    3             ELSE CAT_REC.LT.CROSS = '1'B;

  10120  6 001660   400000 236007                    LDQ     -131072,DL
         6 001661   000002 256000 xsym               ORSQ    CAT_REC+2

      705    10121    3            END;

      706    10122    2         CAT_REC.DESC = F$DCB.DESC;

  10122  6 001662   000000 471500                    LDP1    0,,PR0
         6 001663   100005 236100                    LDQ     5,,PR1
         6 001664   000011 736000                    QLS     9
         6 001665   000003 552030 xsym               STBQ    CAT_REC+3,'30'O

      707    10123    2         IF ERR.CODE = %E$FIT_ONLY

  10123  6 001666   200011 471500                    LDP1    @ERR,,AUTO
         6 001667   100000 236100                    LDQ     0,,PR1
         6 001670   377770 376007                    ANQ     131064,DL
         6 001671   007640 116007                    CMPQ    4000,DL
         6 001672   001676 601000 6                  TNZ     s:10125

      708    10124    2          THEN CAT_REC.FITONLY = '1'B;

  10124  6 001673   000400 236007                    LDQ     256,DL
         6 001674   000003 256000 xsym               ORSQ    CAT_REC+3
         6 001675   001700 710000 6                  TRA     s:10126

      709    10125    2          ELSE CAT_REC.FITONLY = '0'B;

  10125  6 001676   000027 236000 7                  LDQ     23
         6 001677   000003 356000 xsym               ANSQ    CAT_REC+3
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:91   

      710    10126    2         IF CATALOG_ONTO

  10126  6 001700   000000 234000 xsym               SZN     CATALOG_ONTO
         6 001701   001705 605000 6                  TPL     s:10128

      711    10127    2          THEN CATALOG_WRITE.V.ONEWKEY# = %NO#;

  10127  6 001702   000027 236000 7                  LDQ     23
         6 001703   000356 356000 2                  ANSQ    CATALOG_WRITE+8
         6 001704   001707 710000 6                  TRA     s:10129

      712    10128    2          ELSE CATALOG_WRITE.V.ONEWKEY# = %YES#;

  10128  6 001705   000400 236007                    LDQ     256,DL
         6 001706   000356 256000 2                  ORSQ    CATALOG_WRITE+8

      713    10129    2         CALL M$WRITE( CATALOG_WRITE )

  10129  6 001707   000346 630400 2                  EPPR0   CATALOG_WRITE
         6 001710   440001 713400                    CLIMB   alt,write
         6 001711   401400 401760                    pmme    nvectors=4
         6 001712   001714 702000 6                  TSX2    s:10131
         6 001713   002034 710000 6                  TRA     s:10163

      714    10130    3          WHENALTRETURN DO;

      715    10131    3            IF B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$OLDREC

  10131  6 001714   000000 470400 xsym               LDP0    B$TCB$
         6 001715   000000 471500                    LDP1    0,,PR0
         6 001716   100102 236100                    LDQ     66,,PR1
         6 001717   377770 376007                    ANQ     131064,DL
         6 001720   000750 116007                    CMPQ    488,DL
         6 001721   002311 601000 6                  TNZ     ERROR_OUT

      716    10132    3             THEN GOTO ERROR_OUT;
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:92   
      717    10133    4             ELSE DO;                 /* File's already in this catalog file     */

      718    10134    4               CALL M$READ( CATALOG_READ ) ALTRET( ERROR_OUT );

  10134  6 001722   000362 630400 2                  EPPR0   CATALOG_READ
         6 001723   440000 713400                    CLIMB   alt,read
         6 001724   401400 401760                    pmme    nvectors=4
         6 001725   002311 702000 6                  TSX2    ERROR_OUT

      719    10135    4               CAT_REC.VERSION = CAT_REC.VERSION + 1; /* File version            */

  10135  6 001726   000003 236000 xsym               LDQ     CAT_REC+3
         6 001727   001000 036003                    ADLQ    512,DU
         6 001730   000003 552040 xsym               STBQ    CAT_REC+3,'40'O

      720    10136    4               CATALOG_WRITE.V.ONEWKEY# = %YES#;

  10136  6 001731   000400 236007                    LDQ     256,DL
         6 001732   000356 256000 2                  ORSQ    CATALOG_WRITE+8

      721    10137    4               CALL M$WRITE( CATALOG_WRITE ) ALTRET( ERROR_OUT );

  10137  6 001733   000346 630400 2                  EPPR0   CATALOG_WRITE
         6 001734   440001 713400                    CLIMB   alt,write
         6 001735   401400 401760                    pmme    nvectors=4
         6 001736   002311 702000 6                  TSX2    ERROR_OUT

      722    10138    4               CAT_KEY3.VERSION(F$DCB.NAME#.L+1) = CAT_REC.VERSION;

  10138  6 001737   200003 470500                    LDP0    @DCB$,,AUTO
         6 001740   000000 471500                    LDP1    0,,PR0
         6 001741   100010 236100                    LDQ     8,,PR1
         6 001742   000033 772000                    QRL     27
         6 001743   000006 100400                    MLR     fill='000'O
         6 001744   000003 000001 xsym               ADSC9   CAT_REC+3                cn=0,n=1
         6 001745   000004 000001 xsym               ADSC9   CAT_KEY+4,Q              cn=0,n=1

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:93   
      723    10139    4               CAT_REC.TSN = ACCT_LINE.TSN;

  10139  6 001746   040000 100400                    MLR     fill='040'O
         6 001747   000021 400006 2                  ADSC9   ACCT_LINE+11             cn=2,n=6
         6 001750   000001 000006 xsym               ADSC9   CAT_REC+1                cn=0,n=6

      724    10140    4               CAT_REC.UTS = TSTAMP;       /* Mod time, del time, or arc time    */

  10140  6 001751   000150 235000 2                  LDA     TSTAMP
         6 001752   000000 755000 xsym               STA     CAT_REC

      725    10141    4               CAT_REC.VERSION = 0;

  10141  6 001753   000000 236003                    LDQ     0,DU
         6 001754   000003 552040 xsym               STBQ    CAT_REC+3,'40'O

      726    10142    4               IF F$DCB.DESC.ODSTOW#

  10142  6 001755   000000 471500                    LDP1    0,,PR0
         6 001756   100005 236100                    LDQ     5,,PR1
         6 001757   040000 316007                    CANQ    16384,DL
         6 001760   002004 600000 6                  TZE     s:10152

      727    10143    5                THEN DO;

      728    10144    5                  IF ADDR(FSN) = ADDR(NIL)

  10144  6 001761   200006 236100                    LDQ     @FSN,,AUTO
         6 001762   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 001763   001767 601000 6                  TNZ     s:10146

      729    10145    5                   THEN CAT_REC.ODFSN = 0;

  10145  6 001764   000000 220003                    LDX0    0,DU
         6 001765   000002 440000 xsym               SXL0    CAT_REC+2
         6 001766   001772 710000 6                  TRA     s:10147

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:94   
      730    10146    5                   ELSE CAT_REC.ODFSN = FSN;

  10146  6 001767   200006 473500                    LDP3    @FSN,,AUTO
         6 001770   300000 720100                    LXL0    0,,PR3
         6 001771   000002 440000 xsym               SXL0    CAT_REC+2

      731    10147    5                  IF FILE_LINE.CROSS = ' '

  10147  6 001772   000037 236000 2                  LDQ     FILE_LINE+10
         6 001773   777000 376007                    ANQ     -512,DL
         6 001774   040000 116007                    CMPQ    16384,DL
         6 001775   002001 601000 6                  TNZ     s:10149

      732    10148    5                   THEN CAT_REC.ODCROSS = '0'B;

  10148  6 001776   000024 236000 7                  LDQ     20
         6 001777   000003 356000 xsym               ANSQ    CAT_REC+3
         6 002000   002030 710000 6                  TRA     s:10159

      733    10149    5                   ELSE CAT_REC.ODCROSS = '1'B;

  10149  6 002001   000200 236007                    LDQ     128,DL
         6 002002   000003 256000 xsym               ORSQ    CAT_REC+3

      734    10150    5                  END;

  10150  6 002003   002030 710000 6                  TRA     s:10159

      735    10151    5                ELSE DO;

      736    10152    5                  IF ADDR(FSN) = ADDR(NIL)

  10152  6 002004   200006 236100                    LDQ     @FSN,,AUTO
         6 002005   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 002006   002012 601000 6                  TNZ     s:10154

      737    10153    5                   THEN CAT_REC.LT.FSN = 0;
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:95   

  10153  6 002007   000025 236000 7                  LDQ     21
         6 002010   000002 356000 xsym               ANSQ    CAT_REC+2
         6 002011   002017 710000 6                  TRA     s:10155

      738    10154    5                   ELSE CAT_REC.LT.FSN = FSN;

  10154  6 002012   200006 473500                    LDP3    @FSN,,AUTO
         6 002013   300000 236100                    LDQ     0,,PR3
         6 002014   000002 676000 xsym               ERQ     CAT_REC+2
         6 002015   037777 376007                    ANQ     16383,DL
         6 002016   000002 656000 xsym               ERSQ    CAT_REC+2

      739    10155    5                  IF FILE_LINE.CROSS = ' '

  10155  6 002017   000037 236000 2                  LDQ     FILE_LINE+10
         6 002020   777000 376007                    ANQ     -512,DL
         6 002021   040000 116007                    CMPQ    16384,DL
         6 002022   002026 601000 6                  TNZ     s:10157

      740    10156    5                   THEN CAT_REC.LT.CROSS = '0'B;

  10156  6 002023   000026 236000 7                  LDQ     22
         6 002024   000002 356000 xsym               ANSQ    CAT_REC+2
         6 002025   002030 710000 6                  TRA     s:10159

      741    10157    5                   ELSE CAT_REC.LT.CROSS = '1'B;

  10157  6 002026   400000 236007                    LDQ     -131072,DL
         6 002027   000002 256000 xsym               ORSQ    CAT_REC+2

      742    10158    5                  END;

      743    10159    4               CALL M$WRITE( CATALOG_WRITE ) ALTRET( ERROR_OUT );

  10159  6 002030   000346 630400 2                  EPPR0   CATALOG_WRITE
         6 002031   440001 713400                    CLIMB   alt,write
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:96   
         6 002032   401400 401760                    pmme    nvectors=4
         6 002033   002311 702000 6                  TSX2    ERROR_OUT

      744    10160    4               END;

      745    10161    3            END;

      746    10162    2         END;

      747    10163    1      IF NOT DISK_OPTION.LEA THEN RETURN;

  10163  6 002034   000000 236000 xsym               LDQ     DISK_OPTION
         6 002035   040000 316003                    CANQ    16384,DU
         6 002036   002040 601000 6                  TNZ     s:10169

  10163  6 002037   000000 702200 xent               TSX2  ! X66_ARET

      748    10164
      749    10165        /***
      750    10166         *** CODE05 items.
      751    10167         ***/
      752    10168
      753    10169    1      TSTAMP = 0;

  10169  6 002040   000150 450000 2                  STZ     TSTAMP

      754    10170    1      IF FIT$ ~= ADDR(NIL)

  10170  6 002041   000152 236000 2                  LDQ     FIT$
         6 002042   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 002043   002054 600000 6                  TZE     s:10179

      755    10171    2       THEN DO;

      756    10172    2         CODE$ = FIT$;

  10172  6 002044   000147 756000 2                  STQ     CODE$
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:97   

      757    10173    2         CALL XSF$LOCCODP( CODE$, 05 )

  10173  6 002045   000030 630400 7                  EPPR0   24
         6 002046   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 002047   000000 701000 xent               TSX1    XSF$LOCCODP
         6 002050   002054 702000 6                  TSX2    s:10179

      758    10174    3          WHENRETURN DO;

      759    10175    3            TSTAMP = CODE05.BACKUP.TIME;

  10175  6 002051   000147 470400 2                  LDP0    CODE$
         6 002052   000000 235100                    LDA     0,,PR0
         6 002053   000150 755000 2                  STA     TSTAMP

      760    10176    3            END;

      761    10177    2         END;

      762    10178
      763    10179    1      IF TSTAMP > 0

  10179  6 002054   000150 235000 2                  LDA     TSTAMP
         6 002055   002135 600000 6                  TZE     s:10197

      764    10180    2       THEN DO;

      765    10181    2         IF TEST_MODE

  10181  6 002056   000000 234000 xsym               SZN     TEST_MODE
         6 002057   002061 605000 6                  TPL     s:10183

      766    10182    2          THEN TSTAMP = 0;

  10182  6 002060   000150 450000 2                  STZ     TSTAMP

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:98   
      767    10183    2         CALL M$TIME( GET_LEA_DATE );

  10183  6 002061   000234 630400 2                  EPPR0   GET_LEA_DATE
         6 002062   020004 713400                    CLIMB   8196
         6 002063   402000 401760                    pmme    nvectors=5

      768    10184    2         LEA2.BACKED_UP_ON = LEA_DATE_CHARS;

  10184  6 002064   040000 100400                    MLR     fill='040'O
         6 002065   000154 000021 2                  ADSC9   LEA_DATE                 cn=0,n=17
         6 002066   000113 200021 2                  ADSC9   LEA2+8                   cn=1,n=17

      769    10185    2         EFTWORD = CODE05.BACKUP.EFT;

  10185  6 002067   000147 470400 2                  LDP0    CODE$
         6 002070   000002 720100                    LXL0    2,,PR0
         6 002071   000000 740000 xsym               STX0    EFTWORD

      770    10186    2         IF EFTWORD.CROSS

  10186  6 002072   000000 234000 xsym               SZN     EFTWORD
         6 002073   002077 605000 6                  TPL     s:10188

      771    10187    2          THEN LEA3.BACKUP_REEL_CROSSES = '*';

  10187  6 002074   000052 236007                    LDQ     42,DL
         6 002075   000137 552004 2                  STBQ    LEA3+10,'04'O
         6 002076   002101 710000 6                  TRA     s:10189

      772    10188    2          ELSE LEA3.BACKUP_REEL_CROSSES = ' ';

  10188  6 002077   000040 236007                    LDQ     32,DL
         6 002100   000137 552004 2                  STBQ    LEA3+10,'04'O

      773    10189    2         LEA3.BACKUP_REEL = CODE05.BACKUP.REEL;

  10189  6 002101   040000 100500                    MLR     fill='040'O
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:99   
         6 002102   000001 000006                    ADSC9   1,,PR0                   cn=0,n=6
         6 002103   000136 000006 2                  ADSC9   LEA3+9                   cn=0,n=6

      774    10190    2         CALL BINCHAR( BACKUP_FSN, EFTWORD.FSN );

  10190  6 002104   000000 236000 xsym               LDQ     EFTWORD
         6 002105   000022 772000                    QRL     18
         6 002106   037777 376007                    ANQ     16383,DL
         6 002107   000000 235003                    LDA     0,DU
         6 002110   200014 757100                    STAQ    @FITONLY+1,,AUTO
         6 002111   000000 301500                    BTD
         6 002112   200014 000010                    NDSC9   @FITONLY+1,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         6 002113   000166 030004 2                  NDSC9   BACKUP_FSN               cn=0,s=nosgn,sf=0,n=4

      775    10191    2         CALL EDITCHAR( LEA3.BACKUP_FSN, , , NO_LEADING_4_ZEROS, BACKUP_FSN );

  10191  6 002114   000000 024400                    MVNE
         6 002115   000166 030004 2                  NDSC9   BACKUP_FSN               cn=0,s=nosgn,sf=0,n=4
         6 002116   000000 000001 xsym               ADSC9   NO_LEADING_4_ZEROS       cn=0,n=1
         6 002117   000140 400004 2                  ADSC9   LEA3+11                  cn=2,n=4

      776    10192    2         IF F$DCB.DESC.TPB#

  10192  6 002120   200003 471500                    LDP1    @DCB$,,AUTO
         6 002121   100000 473500                    LDP3    0,,PR1
         6 002122   300005 236100                    LDQ     5,,PR3
         6 002123   000040 316007                    CANQ    32,DL
         6 002124   002131 600000 6                  TZE     s:10194

      777    10193    2          THEN LEA3.BLT = 'LT#';

  10193  6 002125   000027 236000 5                  LDQ     ORG_STR_TBL+22
         6 002126   000011 772000                    QRL     9
         6 002127   000135 552034 2                  STBQ    LEA3+8,'34'O
         6 002130   002152 710000 6                  TRA     s:10208

      778    10194    2          ELSE LEA3.BLT = 'DP#';
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:100  

  10194  6 002131   000030 236000 5                  LDQ     ORG_STR_TBL+23
         6 002132   000011 772000                    QRL     9
         6 002133   000135 552034 2                  STBQ    LEA3+8,'34'O

      779    10195    2         END;

  10195  6 002134   002152 710000 6                  TRA     s:10208

      780    10196    2       ELSE DO;

      781    10197    2         LEA2.BACKED_UP_ON = '      never';

  10197  6 002135   040000 100400                    MLR     fill='040'O
         6 002136   000054 000013 5                  ADSC9   ORG_STR_TBL+43           cn=0,n=11
         6 002137   000113 200021 2                  ADSC9   LEA2+8                   cn=1,n=17

      782    10198    2         LEA3.BACKUP_REEL_CROSSES = ' ';

  10198  6 002140   000040 236007                    LDQ     32,DL
         6 002141   000137 552004 2                  STBQ    LEA3+10,'04'O

      783    10199    2         LEA3.BACKUP_REEL = ' ';

  10199  6 002142   040000 100400                    MLR     fill='040'O
         6 002143   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 002144   000136 000006 2                  ADSC9   LEA3+9                   cn=0,n=6

      784    10200    2         LEA3.BLT = ' ';

  10200  6 002145   000032 236000 7                  LDQ     26
         6 002146   000135 552034 2                  STBQ    LEA3+8,'34'O

      785    10201    2         LEA3.BACKUP_FSN = ' ';

  10201  6 002147   040000 100400                    MLR     fill='040'O
         6 002150   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:101  
         6 002151   000140 400004 2                  ADSC9   LEA3+11                  cn=2,n=4

      786    10202    2         END;

      787    10203
      788    10204        /***
      789    10205         *** CODE06 items.
      790    10206         ***/
      791    10207
      792    10208    1      TSTAMP = 0;

  10208  6 002152   000150 450000 2                  STZ     TSTAMP

      793    10209    1      IF FIT$ ~= ADDR(NIL)

  10209  6 002153   000152 236000 2                  LDQ     FIT$
         6 002154   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 002155   002166 600000 6                  TZE     s:10218

      794    10210    2       THEN DO;

      795    10211    2         CODE$ = FIT$;

  10211  6 002156   000147 756000 2                  STQ     CODE$

      796    10212    2         CALL XSF$LOCCODP( CODE$, 06 )

  10212  6 002157   000022 630400 7                  EPPR0   18
         6 002160   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 002161   000000 701000 xent               TSX1    XSF$LOCCODP
         6 002162   002166 702000 6                  TSX2    s:10218

      797    10213    3          WHENRETURN DO;

      798    10214    3            TSTAMP = CODE06.STOW.TIME;

  10214  6 002163   000147 470400 2                  LDP0    CODE$
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:102  
         6 002164   000000 235100                    LDA     0,,PR0
         6 002165   000150 755000 2                  STA     TSTAMP

      799    10215    3            END;

      800    10216    2         END;

      801    10217
      802    10218    1      IF TSTAMP > 0

  10218  6 002166   000150 235000 2                  LDA     TSTAMP
         6 002167   002247 600000 6                  TZE     s:10241

      803    10219    2       THEN DO;

      804    10220    2         IF TEST_MODE

  10220  6 002170   000000 234000 xsym               SZN     TEST_MODE
         6 002171   002173 605000 6                  TPL     s:10222

      805    10221    2          THEN TSTAMP = 0;

  10221  6 002172   000150 450000 2                  STZ     TSTAMP

      806    10222    2         CALL M$TIME( GET_LEA_DATE );

  10222  6 002173   000234 630400 2                  EPPR0   GET_LEA_DATE
         6 002174   020004 713400                    CLIMB   8196
         6 002175   402000 401760                    pmme    nvectors=5

      807    10223    2         LEA2.ARCHIVED_ON = LEA_DATE_CHARS;

  10223  6 002176   040000 100400                    MLR     fill='040'O
         6 002177   000154 000021 2                  ADSC9   LEA_DATE                 cn=0,n=17
         6 002200   000120 000021 2                  ADSC9   LEA2+13                  cn=0,n=17

      808    10224    2         LEA3.ARCHIVE_REEL = CODE06.STOW.REEL;
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:103  

  10224  6 002201   000147 470400 2                  LDP0    CODE$
         6 002202   040000 100500                    MLR     fill='040'O
         6 002203   000001 000006                    ADSC9   1,,PR0                   cn=0,n=6
         6 002204   000142 600006 2                  ADSC9   LEA3+13                  cn=3,n=6

      809    10225    2         EFTWORD = CODE06.STOW.EFT;

  10225  6 002205   000002 720100                    LXL0    2,,PR0
         6 002206   000000 740000 xsym               STX0    EFTWORD

      810    10226    2         IF F$DCB.DESC.ODSTOW#

  10226  6 002207   200003 471500                    LDP1    @DCB$,,AUTO
         6 002210   100000 473500                    LDP3    0,,PR1
         6 002211   300005 236100                    LDQ     5,,PR3
         6 002212   040000 316007                    CANQ    16384,DL
         6 002213   002221 600000 6                  TZE     s:10232

      811    10227    3          THEN DO;

      812    10228    3            LEA3.ARCHIVE_REEL_CROSSES = ' '; /* EFTWORD.CROSS not avail for OD   */

  10228  6 002214   040000 236007                    LDQ     16384,DL
         6 002215   000144 552010 2                  STBQ    LEA3+15,'10'O

      813    10229    3            LEA3.ALT = 'OD#';

  10229  6 002216   000026 236000 5                  LDQ     ORG_STR_TBL+21
         6 002217   000142 552070 2                  STBQ    LEA3+13,'70'O

      814    10230    3            END;

  10230  6 002220   002232 710000 6                  TRA     s:10237

      815    10231    3          ELSE DO;

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:104  
      816    10232    3            IF EFTWORD.CROSS

  10232  6 002221   000000 234000 xsym               SZN     EFTWORD
         6 002222   002226 605000 6                  TPL     s:10234

      817    10233    3             THEN LEA3.ARCHIVE_REEL_CROSSES = '*';

  10233  6 002223   052000 236007                    LDQ     21504,DL
         6 002224   000144 552010 2                  STBQ    LEA3+15,'10'O
         6 002225   002230 710000 6                  TRA     s:10235

      818    10234    3             ELSE LEA3.ARCHIVE_REEL_CROSSES = ' ';

  10234  6 002226   040000 236007                    LDQ     16384,DL
         6 002227   000144 552010 2                  STBQ    LEA3+15,'10'O

      819    10235    3            LEA3.ALT = 'LT#';

  10235  6 002230   000027 236000 5                  LDQ     ORG_STR_TBL+22
         6 002231   000142 552070 2                  STBQ    LEA3+13,'70'O

      820    10236    3            END;

      821    10237    2         CALL BINCHAR( FILE_LINE.FSN, EFTWORD.FSN );

  10237  6 002232   000000 236000 xsym               LDQ     EFTWORD
         6 002233   000022 772000                    QRL     18
         6 002234   037777 376007                    ANQ     16383,DL
         6 002235   000000 235003                    LDA     0,DU
         6 002236   200014 757100                    STAQ    @FITONLY+1,,AUTO
         6 002237   000000 301500                    BTD
         6 002240   200014 000010                    NDSC9   @FITONLY+1,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         6 002241   000036 030006 2                  NDSC9   FILE_LINE+9              cn=0,s=nosgn,sf=0,n=6

      822    10238    2         CALL EDITCHAR( LEA3.ARCHIVE_FSN, , , NO_LEADING_6_ZEROS, FILE_LINE.FSN );

  10238  6 002242   000000 024400                    MVNE
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:105  
         6 002243   000036 030006 2                  NDSC9   FILE_LINE+9              cn=0,s=nosgn,sf=0,n=6
         6 002244   000000 000001 xsym               ADSC9   NO_LEADING_6_ZEROS       cn=0,n=1
         6 002245   000145 000006 2                  ADSC9   LEA3+16                  cn=0,n=6

      823    10239    2         END;

  10239  6 002246   002264 710000 6                  TRA     s:10248

      824    10240    2       ELSE DO;

      825    10241    2         LEA2.ARCHIVED_ON = '      never';

  10241  6 002247   040000 100400                    MLR     fill='040'O
         6 002250   000054 000013 5                  ADSC9   ORG_STR_TBL+43           cn=0,n=11
         6 002251   000120 000021 2                  ADSC9   LEA2+13                  cn=0,n=17

      826    10242    2         LEA3.ARCHIVE_REEL_CROSSES = ' ';

  10242  6 002252   040000 236007                    LDQ     16384,DL
         6 002253   000144 552010 2                  STBQ    LEA3+15,'10'O

      827    10243    2         LEA3.ALT = ' ';

  10243  6 002254   000000 236000 7                  LDQ     0
         6 002255   000142 552070 2                  STBQ    LEA3+13,'70'O

      828    10244    2         LEA3.ARCHIVE_REEL = ' ';

  10244  6 002256   040000 100400                    MLR     fill='040'O
         6 002257   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 002260   000142 600006 2                  ADSC9   LEA3+13                  cn=3,n=6

      829    10245    2         LEA3.ARCHIVE_FSN = ' ';

  10245  6 002261   040000 100400                    MLR     fill='040'O
         6 002262   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 002263   000145 000006 2                  ADSC9   LEA3+16                  cn=0,n=6
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:106  

      830    10246    2         END;

      831    10247
      832    10248    1      WRITE_LO.BUF_ = VECTOR(LEA1);

  10248  6 002264   000034 237000 7                  LDAQ    28
         6 002265   000174 757000 2                  STAQ    WRITE_LO+4

      833    10249    1      CALL M$WRITE( WRITE_LO ) ALTRET( ERROR_OUT );

  10249  6 002266   000170 630400 2                  EPPR0   WRITE_LO
         6 002267   440001 713400                    CLIMB   alt,write
         6 002270   401400 401760                    pmme    nvectors=4
         6 002271   002311 702000 6                  TSX2    ERROR_OUT

      834    10250    1      WRITE_LO.BUF_ = VECTOR(LEA2);

  10250  6 002272   000036 237000 7                  LDAQ    30
         6 002273   000174 757000 2                  STAQ    WRITE_LO+4

      835    10251    1      CALL M$WRITE( WRITE_LO ) ALTRET( ERROR_OUT );

  10251  6 002274   000170 630400 2                  EPPR0   WRITE_LO
         6 002275   440001 713400                    CLIMB   alt,write
         6 002276   401400 401760                    pmme    nvectors=4
         6 002277   002311 702000 6                  TSX2    ERROR_OUT

      836    10252    1      WRITE_LO.BUF_ = VECTOR(LEA3);

  10252  6 002300   000040 237000 7                  LDAQ    32
         6 002301   000174 757000 2                  STAQ    WRITE_LO+4

      837    10253    1      CALL M$WRITE( WRITE_LO ) ALTRET( ERROR_OUT );

  10253  6 002302   000170 630400 2                  EPPR0   WRITE_LO
         6 002303   440001 713400                    CLIMB   alt,write
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:107  
         6 002304   401400 401760                    pmme    nvectors=4
         6 002305   002311 702000 6                  TSX2    ERROR_OUT

      838    10254    1      WRITE_LO.BUF_ = VECTOR(FILE_LINE);

  10254  6 002306   000010 237000 7                  LDAQ    8
         6 002307   000174 757000 2                  STAQ    WRITE_LO+4

      839    10255
      840    10256    1      RETURN;

  10256  6 002310   000000 702200 xent               TSX2  ! X66_ARET

  10254  6 002311                       ERROR_OUT    null
      841    10257
      842    10258    1   ERROR_OUT: ;
      843    10259    1      CALL FLI$RPT_ERR;

  10259  6 002311   000002 631400 xsym               EPPR1   B_VECTNIL+2
         6 002312   000000 701000 xent               TSX1    FLI$RPT_ERR
         6 002313   000000 011000                    NOP     0

      844    10260    1      ALTRETURN;

  10260  6 002314   000000 702200 xent               TSX2  ! X66_AALT
      845    10261
      846    10262    1   END FLP$WR_FILE_INFO;
      847    10263        %EOD;

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:108  
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   FM$GRAN.:E05TOU  is referenced.
   FM$FIT.:E05TOU  is referenced.
   FLW_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure FLP$WR_FILE_INFO.
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:109  

 **** Variables and constants ****

  ****  Section 002  Data  FLP$WR_FILE_INFO

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   164-0-0/b BIT         r     1 ACCOUNT_ONLY             165-0-0/b BIT         r     1 ACCT_CHANGE
     6-0-0/c STRC(540)   r     1 ACCT_LINE                  6-0-0/c CHAR(60)    r     1 ACCT_LINE_CHARS
   344-0-0/c STRC(72)    r     1 BACKUP_ACCT              166-0-0/c CHAR(4)     r     1 BACKUP_FSN
   342-0-0/w STRC(54)    r     1 BLANK_HEADER             362-0-0/d STRC(504)   r     1 CATALOG_READ
   346-0-0/d STRC(432)   r     1 CATALOG_WRITE            147-0-0/w PTR         r     1 CODE$
   330-0-0/d STRC(360)   r     1 ERASE_HEADER             161-0-0/w SBIN        r     1 EXPIRE
    25-0-0/c STRC(711)   r     1 FILE_LINE                 25-0-0/c STRC(711)   r     1 FILE_LINE2
    25-0-0/c STRC(711)   r     1 FILE_LINE_CHARS           51-0-0/c CHAR(31)    r     1 FILE_NAME
   152-0-0/w PTR         r     1 FIT$                     153-0-0/b BIT         r     1 FLAG
   204-0-0/d STRC(432)   r     1 GET_ACCT_LINE_DATE
   220-0-0/d STRC(432)   r     1 GET_FILE_LINE_MOD_DATE
   234-0-0/d STRC(432)   r     1 GET_LEA_DATE             306-0-0/d STRC(216)   r     1 GET_LO_LINES
    61-0-0/c STRC(621)   r     1 LEA1                     103-0-0/c STRC(621)   r     1 LEA2
   125-0-0/c STRC(630)   r     1 LEA3                     154-0-0/c STRC(153)   r     1 LEA_DATE
   154-0-0/c CHAR(17)    r     1 LEA_DATE_CHARS           262-0-0/w STRC(720)   r     1 LO_HEADER
   163-0-0/w SBIN        r     1 NBR_LINES_NEEDED         151-0-0/w SBIN        r     1 OUTPUT_WIDTH
   316-0-0/d STRC(360)   r     1 PAGE_LO                  250-0-0/d STRC(360)   r     1 SET_LO_HEADER
   162-0-0/w UBIN        r     1 TEMP_UBIN                150-0-0/w UBIN        r     1 TSTAMP
   314-0-0/d STRC(72)    r     1 VLR_LINES                170-0-0/d STRC(432)   r     1 WRITE_LO

  ****  Section 005 RoData FLP$WR_FILE_INFO

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(2)     r     1 BLANK
     1-0-0/c CHAR(3)     r     1 ORG_STR_TBL(0:25)

  ****  Auto variables  ****

PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:110  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    10-0-0/w PTR         r     1 @ACCT_ONLY                 7-0-0/w PTR         r     1 @CROSS
     3-0-0/w PTR         r     1 @DCB$                     12-0-0/w PTR         r     1 @DEV_LT
    11-0-0/w PTR         r     1 @ERR                      13-0-0/w PTR         r     1 @FITONLY
     4-0-0/w PTR         r     1 @FPARAM$                   6-0-0/w PTR         r     1 @FSN
     5-0-0/w PTR         r     1 @TSN                      *0-0-0/w BIT         r     1 ACCT_ONLY
    *0-0-0/c CHAR        r     1 CROSS                     *0-0-0/w PTR         r     1 DCB$
    *0-0-0/w BIT         r     1 DEV_LT                    *0-0-0/w STRC        r     1 ERR
    *0-0-0/w BIT         r     1 FITONLY                   *0-0-0/w PTR         r     1 FPARAM$
    *0-0-0/w SBIN        r     1 FSN                       *0-0-0/c CHAR(6)     r     1 TSN

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/b BIT         r     1 CATALOG_ON
     0-0-0/b BIT         r     1 CATALOG_ONTO               0-0-0/c STRC(432)   r     1 CAT_KEY
     0-0-0/c STRC(432)   r     1 CAT_KEY3                   0-0-0/w STRC(144)   r     1 CAT_REC
     0-0-0/d STRC(90)    r     1 DISK_DEST_SN               0-0-0/w PTR         r     1 DISK_FILE_SPEC$
     0-0-0/w STRC(145)   r     1 DISK_OPTION                0-0-0/w PTR         r     1 DPLIST$
     0-0-0/w PTR         r     1 DPRESLIST$                 0-0-0/b STRC(18)    r     1 EFTWORD
     0-0-0/c BIT (9)     r     1 NO_5_LEADING_ZEROS(0:2)
     0-0-0/c BIT (9)     r     1 NO_6_LEADING_ZEROS(0:2)
     0-0-0/c BIT (9)     r     1 NO_LEADING_4_ZEROS(0:0)
     0-0-0/c BIT (9)     r     1 NO_LEADING_6_ZEROS(0:0)
     0-0-0/b BIT         r     1 OVER_FIL                   0-0-0/c ASTR(9)     r     1 RET_CMDS_NAME
     0-0-0/w PTR         r     1 SNVECLIST$                 0-0-0/w PTR         r     1 TAPE_DCBLIST$
     0-0-0/d STRC(2088)  r     1 TAPE_OPEN                  0-0-0/b BIT         r     1 TEST_MODE
     0-0-0/w SBIN        r     1 TOTAL_FILES                0-0-0/w SBIN        r     1 TOTAL_GRANS

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:111  

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/w STRC(324)   r     1 CODE03                     0-0-0/w STRC(396)   r     1 CODE04
     0-0-0/w STRC(108)   r     1 CODE05                     0-0-0/w STRC(108)   r     1 CODE06
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(180)   r     1 FM$GRAN
     0-0-0N  NULL        r     1 M$CATALOG                  0-0-0N  NULL        r     1 M$LO


   Procedure FLP$WR_FILE_INFO requires 1229 words for executable code.
   Procedure FLP$WR_FILE_INFO requires 16 words of local(AUTO) storage.
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:112  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:113  
          MINI XREF LISTING

ACCOUNT_ONLY
      9233**DCL      9717<<ASSIGN   9718<<ASSIGN   9737>>IF       9799<<ASSIGN   9802<<ASSIGN   9805<<ASSIGN
      9815>>IF       9838>>IF
ACCT_CHANGE
      9234**DCL      9722<<ASSIGN   9723<<ASSIGN   9726<<ASSIGN   9728<<ASSIGN   9729<<ASSIGN   9731>>IF
      9754>>IF       9757>>IF
ACCT_LINE
      9126**DCL      9141--REDEF    9819--ASSIGN   9831--ASSIGN
ACCT_LINE.ACCT
      9127**DCL      9696<<ASSIGN   9721>>IF       9724>>IF       9762<<ASSIGN  10098>>ASSIGN
ACCT_LINE.CONT
      9140**DCL      9798<<ASSIGN   9801<<ASSIGN   9804<<ASSIGN   9807<<ASSIGN   9811<<ASSIGN   9813<<ASSIGN
      9816<<ASSIGN   9817<<ASSIGN   9827<<ASSIGN
ACCT_LINE.DATE
      9132**DCL      9402--DCLINIT  9403--DCLINIT  9766<<ASSIGN   9808<<ASSIGN   9829<<ASSIGN
ACCT_LINE.FSN
      9136**DCL      9774<<ASSIGN   9791<<CALLBLT  9792<<CALLBLT  9792>>CALLBLT  9794<<ASSIGN   9828<<ASSIGN
ACCT_LINE.LT
      9138**DCL      9698<<ASSIGN   9773<<ASSIGN   9783<<ASSIGN   9784<<ASSIGN   9786<<ASSIGN   9788<<ASSIGN
ACCT_LINE.PSN
      9130**DCL      9727>>IF       9769<<ASSIGN   9822<<ASSIGN   9824<<ASSIGN  10097>>ASSIGN
ACCT_LINE.TIME
      9134**DCL      9404--DCLINIT  9405--DCLINIT  9767<<ASSIGN   9809<<ASSIGN   9830<<ASSIGN
ACCT_LINE.TSN
      9139**DCL      9697<<ASSIGN   9733>>IF       9754>>IF       9772<<ASSIGN   9777<<ASSIGN   9778>>IF
     10102>>ASSIGN  10139>>ASSIGN
ACCT_LINE_CHARS
      9141**DCL      9832>>ASSIGN
ACCT_ONLY
        19**DCL         9--PROC     9716--IF       9717>>ASSIGN
B$ALT.CODE
      9315**DCL      9315--REDEF    9316--REDEF    9316--REDEF
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:114  
B$ALT.ERR.CODE
      9317**DCL     10131>>IF
B$ALT.ERR.ERR#
      9317**DCL      9317--REDEF
B$ALT.EVID
      9316**DCL      9316--REDEF    9316--REDEF
B$TCB.ALT$
      9311**DCL     10131>>IF
B$TCB$
      8190**DCL      9311--IMP-PTR 10131>>IF
BACKUP_ACCT.ACCT#
      9605**DCL      9887>>IF      10022>>IF      10038>>IF      10055>>IF      10063>>IF
BACKUP_FSN
      9235**DCL     10190<<CALLBLT 10191>>CALLBLT
BLANK
      9241**DCL      9759--ASSIGN
BLANK_HEADER
      9587**DCL      9567--DCLINIT
CATALOG_ON
      8686**DCL     10093>>IF
CATALOG_ONTO
      8686**DCL     10126>>IF
CATALOG_READ
      9665**DCL     10134<>CALL
CATALOG_READ.STATION_
      9668**DCL      9669--REDEF
CATALOG_READ.V
      9669**DCL      9665--DCLINIT
CATALOG_READ.V.DVBYTE.REREAD#
      9680**DCL      9680--REDEF
CATALOG_READ.V.INDX#
      9678**DCL      9678--REDEF
CATALOG_WRITE
      9629**DCL     10129<>CALL    10137<>CALL    10159<>CALL
CATALOG_WRITE.STATION_
      9631**DCL      9631--REDEF
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:115  
CATALOG_WRITE.V
      9632**DCL      9629--DCLINIT
CATALOG_WRITE.V.DVBYTE.VFC#
      9638**DCL      9638--REDEF
CATALOG_WRITE.V.ONEWKEY#
      9634**DCL     10127<<ASSIGN  10128<<ASSIGN  10136<<ASSIGN
CAT_KEY
      8680**DCL      8681--REDEF    8682--REDEF    9629--DCLINIT  9665--DCLINIT  9666--DCLINIT
CAT_KEY.ACCT
      8680**DCL     10095--ASSIGN  10098<<ASSIGN
CAT_KEY.L
      8680**DCL     10095<<ASSIGN
CAT_KEY.NAME.C
      8680**DCL     10099<<ASSIGN
CAT_KEY.NAME.L
      8680**DCL     10095--ASSIGN
CAT_KEY.PSN
      8680**DCL     10095--ASSIGN  10097<<ASSIGN
CAT_KEY.VERSION
      8680**DCL     10095--ASSIGN
CAT_KEY3.VERSION
      8682**DCL     10100<<ASSIGN  10101<<ASSIGN  10138<<ASSIGN
CAT_REC
      8682**DCL      9630--DCLINIT  9631--DCLINIT  9667--DCLINIT  9668--DCLINIT
CAT_REC.DESC
      8684**DCL     10122<<ASSIGN
CAT_REC.FITONLY
      8685**DCL     10124<<ASSIGN  10125<<ASSIGN
CAT_REC.LT
      8683**DCL      8683--REDEF
CAT_REC.LT.CROSS
      8683**DCL     10119<<ASSIGN  10120<<ASSIGN  10156<<ASSIGN  10157<<ASSIGN
CAT_REC.LT.FSN
      8683**DCL     10116<<ASSIGN  10117<<ASSIGN  10153<<ASSIGN  10154<<ASSIGN
CAT_REC.ODCROSS
      8685**DCL     10111<<ASSIGN  10112<<ASSIGN  10148<<ASSIGN  10149<<ASSIGN
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:116  
CAT_REC.ODFSN
      8683**DCL     10108<<ASSIGN  10109<<ASSIGN  10145<<ASSIGN  10146<<ASSIGN
CAT_REC.TSN
      8683**DCL     10102<<ASSIGN  10139<<ASSIGN
CAT_REC.UTS
      8682**DCL     10103<<ASSIGN  10140<<ASSIGN
CAT_REC.VERSION
      8683**DCL     10104<<ASSIGN  10135<<ASSIGN  10135>>ASSIGN  10138>>ASSIGN  10141<<ASSIGN
CODE$
      9220**DCL      9326--IMP-PTR  9335--IMP-PTR  9341--IMP-PTR  9344--IMP-PTR  9940<<ASSIGN   9941<>CALL
      9949>>ASSIGN   9950>>ASSIGN   9953>>CALLBLT  9955>>CALLBLT  9957>>ASSIGN   9958>>ASSIGN   9992<<ASSIGN
      9993<>CALL    10005>>ASSIGN  10008>>ASSIGN  10024>>ASSIGN  10028>>ASSIGN  10029>>ASSIGN  10057>>ASSIGN
     10070<<ASSIGN  10071<>CALL    10073>>ASSIGN  10172<<ASSIGN  10173<>CALL    10175>>ASSIGN  10185>>ASSIGN
     10189>>ASSIGN  10211<<ASSIGN  10212<>CALL    10214>>ASSIGN  10224>>ASSIGN  10225>>ASSIGN
CODE03.EXPIRE
      9329**DCL      9957>>ASSIGN
CODE03.NRECS
      9328**DCL      9955>>CALLBLT
CODE03.ORG
      9326**DCL      9949>>ASSIGN
CODE03.TYPE
      9328**DCL      9950>>ASSIGN
CODE03.UGRANS
      9326**DCL      9953>>CALLBLT  9958>>ASSIGN
CODE04.ACCESS.TIME
      9337**DCL     10005>>ASSIGN
CODE04.CREATION.TIME
      9337**DCL     10008>>ASSIGN
CODE04.CREATOR.ACCT
      9337**DCL     10028>>ASSIGN
CODE04.CREATOR.NAME
      9337**DCL     10029>>ASSIGN
CODE04.MODIFY.TIME
      9337**DCL     10024>>ASSIGN  10057>>ASSIGN
CODE05.BACKUP.EFT
      9341**DCL     10185>>ASSIGN
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:117  
CODE05.BACKUP.REEL
      9341**DCL     10189>>ASSIGN
CODE05.BACKUP.TIME
      9341**DCL     10175>>ASSIGN
CODE06.STOW.EFT
      9344**DCL      9345--REDEF   10225>>ASSIGN
CODE06.STOW.REEL
      9344**DCL     10224>>ASSIGN
CODE06.STOW.TIME
      9344**DCL     10073>>ASSIGN  10214>>ASSIGN
CROSS
        18**DCL         9--PROC     9916--IF       9917>>ASSIGN
DCB$
        14**DCL         9--PROC     9254--IMP-PTR  9694--IF       9724>>IF       9727>>IF       9762>>ASSIGN
      9769>>ASSIGN   9824>>ASSIGN   9845>>IF       9848>>ASSIGN   9878>>IF       9879>>IF       9882>>IF
      9884>>IF       9887>>IF       9890>>ASSIGN   9924>>IF       9925>>IF       9965>>IF       9966>>IF
      9969>>IF       9972>>IF       9973>>IF       9977>>IF       9982>>IF      10022>>IF      10038>>IF
     10040>>ASSIGN  10055>>IF      10063>>IF      10065>>ASSIGN  10068>>IF      10068>>IF      10095>>ASSIGN
     10100>>ASSIGN  10100>>ASSIGN  10101>>ASSIGN  10105>>IF      10122>>ASSIGN  10138>>ASSIGN  10142>>IF
     10192>>IF      10226>>IF
DEV_LT
        26**DCL         9--PROC     9780>>IF
DISK_CLOSE.SN_
      7870**DCL      7870--REDEF
DISK_CLOSE.UTL_
      7871**DCL      7871--REDEF
DISK_CLOSE.V.EXPIRE#
      7885**DCL      7885--REDEF
DISK_CLOSE.V.TYPE#
      7883**DCL      7883--REDEF
DISK_CLOSE.V.XTNSIZE#
      7880**DCL      7880--REDEF    7882--REDEF
DISK_DEST_SN.SN#
      8339**DCL      9822>>ASSIGN
DISK_FILE_SPEC.SPEC
      8235**DCL      8237--REDEF
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:118  
DISK_FILE_SPEC.SPEC.START
      8236**DCL      8236--REDEF
DISK_FILE_SPEC.SPEC.STOP
      8237**DCL      8237--REDEF
DISK_FILE_SPEC$
      8234**DCL      8235--IMP-PTR
DISK_OPEN.ACSVEH_
      7735**DCL      7736--REDEF
DISK_OPEN.ALTKEYS_
      7741**DCL      7742--REDEF    7742--REDEF
DISK_OPEN.HDR_
      7740**DCL      7741--REDEF
DISK_OPEN.TAB_
      7739**DCL      7740--REDEF
DISK_OPEN.UHL_
      7733**DCL      7734--REDEF    7734--REDEF
DISK_OPEN.V.FSN#
      7773**DCL      7773--REDEF    7773--REDEF
DISK_OPEN.WSN_
      7739**DCL      7739--REDEF
DISK_OPTION.LEA
      8247**DCL      9738>>IF       9999>>IF      10163>>IF
DISK_READ.STATION_
      7797**DCL      7798--REDEF
DISK_READ.V.DVBYTE.REREAD#
      7809**DCL      7809--REDEF
DISK_READ.V.INDX#
      7807**DCL      7807--REDEF
DISK_WRITE.STATION_
      7835**DCL      7835--REDEF
DISK_WRITE.V.DVBYTE.VFC#
      7842**DCL      7842--REDEF
DPLIST$
      8220**DCL      8232--IMP-PTR
DPRESLIST$
      8234**DCL      8234--IMP-PTR
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:119  
EFTWORD
      8355**DCL      8355--REDEF   10185<<ASSIGN  10225<<ASSIGN
EFTWORD.CROSS
      8355**DCL     10186>>IF      10232>>IF
EFTWORD.FSN
      8355**DCL     10190>>CALLBLT 10237>>CALLBLT
ERASE_HEADER
      9566**DCL      9756<>CALL
ERASE_HEADER.V
      9567**DCL      9566--DCLINIT
ERR
        20**DCL         9--PROC     9851>>IF
ERR.CODE
        24**DCL      9714>>IF       9720>>IF       9724>>IF       9724>>IF       9724>>IF       9754>>IF
      9770>>IF       9796>>DOSELCT  9853>>IF       9862>>IF       9865>>IF       9865>>IF       9865>>IF
      9868>>IF       9868>>IF       9875>>IF      10123>>IF
ERROR_OUT
     10254**LABEL    9705--CALLALT  9744--CALLALT  9747--CALLALT  9756--CALLALT  9760--CALLALT  9823--CALLALT
      9826--CALLALT  9833--CALLALT  9857--CALLALT  9902--CALLALT 10084--CALLALT 10132--GOTO    10134--CALLALT
     10137--CALLALT 10159--CALLALT 10249--CALLALT 10251--CALLALT 10253--CALLALT
EXPIRE
      9230**DCL      9936<<ASSIGN   9957<<ASSIGN  10011>>IF      10016>>IF      10017>>ASSIGN
F$DCB.ACCT#
      9270**DCL      9724>>IF       9762>>ASSIGN   9887>>IF      10022>>IF      10038>>IF      10055>>IF
     10063>>IF
F$DCB.ACTPOS
      9286**DCL      9286--REDEF
F$DCB.ARS#
      9260**DCL      9260--REDEF
F$DCB.ATTR
      9279**DCL      9280--REDEF
F$DCB.BORROW
      9294**DCL      9294--REDEF    9294--REDEF    9294--REDEF
F$DCB.DCBNAME.L
      9308**DCL      9308--IMP-SIZ
F$DCB.DESC
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:120  
      9267**DCL     10122>>ASSIGN
F$DCB.DESC.ACTIVE#
      9269**DCL      9977>>IF
F$DCB.DESC.ARCHIVE#
      9268**DCL      9879>>IF       9882>>IF       9925>>IF       9966>>IF       9969>>IF      10068>>IF
F$DCB.DESC.BAD#
      9268**DCL      9884>>IF       9982>>IF
F$DCB.DESC.DELF#
      9267**DCL      9878>>IF       9924>>IF       9965>>IF      10068>>IF
F$DCB.DESC.FETCH#
      9269**DCL      9973>>IF
F$DCB.DESC.ODSTOW#
      9268**DCL     10105>>IF      10142>>IF      10226>>IF
F$DCB.DESC.QS#
      9268**DCL      9972>>IF
F$DCB.DESC.TPB#
      9269**DCL     10192>>IF
F$DCB.EOMCHAR#
      9264**DCL      9264--REDEF
F$DCB.EXPIRE#
      9277**DCL      9890>>ASSIGN  10040>>ASSIGN  10065>>ASSIGN
F$DCB.FLDID
      9289**DCL      9289--REDEF
F$DCB.FORM$
      9283**DCL      9283--REDEF
F$DCB.FSECT
      9299**DCL      9299--REDEF
F$DCB.FSN#
      9276**DCL      9276--REDEF    9276--REDEF    9277--REDEF
F$DCB.HEADER$
      9282**DCL      9282--REDEF
F$DCB.IXTNSIZE#
      9280**DCL      9280--REDEF
F$DCB.LASTSTA$
      9269**DCL      9269--REDEF
F$DCB.LVL
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:121  
      9295**DCL      9295--REDEF
F$DCB.NAME#.C
      9270**DCL      9270--REDEF    9845>>IF       9848>>ASSIGN
F$DCB.NAME#.L
      9270**DCL     10095>>ASSIGN  10100>>ASSIGN  10100>>ASSIGN  10101>>ASSIGN  10138>>ASSIGN
F$DCB.NOEOF
      9292**DCL      9292--REDEF
F$DCB.NRECS#
      9281**DCL      9281--REDEF
F$DCB.NRECX
      9300**DCL      9300--REDEF
F$DCB.OHDR
      9292**DCL      9292--REDEF
F$DCB.ORG#
      9275**DCL      9275--REDEF
F$DCB.PRECNO
      9298**DCL      9298--REDEF
F$DCB.PSN#
      9270**DCL      9727>>IF       9769>>ASSIGN   9824>>ASSIGN
F$DCB.RCSZ
      9304**DCL      9304--REDEF
F$DCB.RES#
      9271**DCL      9271--REDEF
F$DCB.SETX
      9283**DCL      9283--REDEF
F$DCB.TAB$
      9283**DCL      9283--REDEF
F$DCB.TDA
      9297**DCL      9298--REDEF
F$DCB.WIDTH#
      9267**DCL      9700>>ASSIGN
F$DCB.WSN#
      9271**DCL      9271--REDEF
FILE_LINE
      9143**DCL      9165--REDEF    9172--REDEF    9373--DCLINIT  9374--DCLINIT  9834--ASSIGN  10254--ASSIGN
FILE_LINE.ARCDEL
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:122  
      9154**DCL      9855<<ASSIGN   9880<<ASSIGN   9881<<ASSIGN   9883<<ASSIGN   9887>>IF       9967<<ASSIGN
      9968<<ASSIGN   9970<<ASSIGN   9978<<ASSIGN   9979<<ASSIGN
FILE_LINE.BAD
      9155**DCL      9885<<ASSIGN   9983<<ASSIGN
FILE_LINE.CROSS
      9148**DCL      9917<<ASSIGN  10110>>IF      10118>>IF      10147>>IF      10155>>IF
FILE_LINE.FSN
      9147**DCL      9872<<CALLBLT  9873<<CALLBLT  9873>>CALLBLT  9913<<CALLBLT  9914<<CALLBLT  9914>>CALLBLT
     10237<<CALLBLT 10238>>CALLBLT
FILE_LINE.MOD_DATE
      9161**DCL      9426--DCLINIT  9427--DCLINIT  9856<<ASSIGN   9876<<ASSIGN   9901<<ASSIGN  10027<<ASSIGN
     10077<<ASSIGN
FILE_LINE.NAME
      9145**DCL      9846<<ASSIGN   9849<<ASSIGN  10099>>ASSIGN
FILE_LINE.NRECS
      9159**DCL      9955<<CALLBLT  9956<<CALLBLT  9956>>CALLBLT
FILE_LINE.ORG
      9149**DCL      9949<<ASSIGN
FILE_LINE.QUEUED_FOR
      9153**DCL      9974<<ASSIGN   9976<<ASSIGN
FILE_LINE.STAR_ERROR
      9163**DCL      9699<<ASSIGN   9864<<ASSIGN   9894<<ASSIGN   9898<<ASSIGN   9906<<ASSIGN
FILE_LINE.TYPE
      9151**DCL      9950<<ASSIGN   9951>>IF
FILE_LINE.TYSLASH
      9150**DCL      9952<<ASSIGN
FILE_LINE.UGRANS
      9157**DCL      9953<<CALLBLT  9954<<CALLBLT  9954>>CALLBLT
FILE_LINE2.TSN
      9167**DCL      9886<<ASSIGN
FILE_LINE2.WHERE_ON
      9169**DCL      9892<<ASSIGN
FILE_LINE_CHARS.INFO
      9174**DCL      9844<<ASSIGN
FILE_NAME
      9176**DCL      9835<<ASSIGN   9845>>IF       9848<<ASSIGN   9849>>ASSIGN
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:123  
FIT$
      9223**DCL      9926<<ASSIGN   9927<<ASSIGN   9929<<ASSIGN   9930<<ASSIGN   9938>>IF       9940>>ASSIGN
      9990>>IF       9992>>ASSIGN  10035>>IF      10061>>IF      10070>>ASSIGN  10170>>IF      10172>>ASSIGN
     10209>>IF      10211>>ASSIGN
FITONLY
        27**DCL         9--PROC     9895--IF       9897>>IF
FLAG
      9224**DCL      9937<<ASSIGN   9943<<ASSIGN   9947>>IF       9989<<ASSIGN   9995<<ASSIGN  10001>>IF
     10053>>IF
FLI$RPT_ERR
      9064**DCL-ENT 10259--CALL
FM$GRAN
      9322**DCL      9930--ASSIGN
FPARAM$
        15**DCL         9--PROC     9926>>ASSIGN   9928>>IF       9930>>ASSIGN
FPT_EXIT.V.STEPCC#
      7660**DCL      7660--REDEF
FSN
        17**DCL         9--PROC     9789--IF       9791>>CALLBLT  9870--IF       9872>>CALLBLT  9911--IF
      9913>>CALLBLT 10107--IF      10109>>ASSIGN  10115--IF      10117>>ASSIGN  10144--IF      10146>>ASSIGN
     10152--IF      10154>>ASSIGN
GET_ACCT_LINE_DATE
      9402**DCL      9764<>CALL
GET_ACCT_LINE_DATE.V
      9406**DCL      9402--DCLINIT
GET_FILE_LINE_MOD_DATE
      9426**DCL     10058<>CALL    10066<>CALL    10074<>CALL
GET_FILE_LINE_MOD_DATE.V
      9430**DCL      9426--DCLINIT
GET_LEA_DATE
      9451**DCL      9891<>CALL    10006<>CALL    10009<>CALL    10019<>CALL    10025<>CALL    10041<>CALL
     10183<>CALL    10222<>CALL
GET_LEA_DATE.V
      9455**DCL      9451--DCLINIT
GET_LO_LINES
      9513**DCL      9744<>CALL
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:124  
GET_LO_LINES.V
      9513**DCL      9513--DCLINIT
LEA1
      9178**DCL     10248--ASSIGN
LEA1.ACCESSED_ON
      9186**DCL     10007<<ASSIGN  10045<<ASSIGN
LEA1.CREATED_ON
      9181**DCL     10010<<ASSIGN  10036<<ASSIGN  10042<<ASSIGN
LEA1.MODIFIED_ON
      9184**DCL     10026<<ASSIGN  10046<<ASSIGN
LEA2
      9188**DCL     10250--ASSIGN
LEA2.ACCT
      9191**DCL     10028<<ASSIGN  10030>>IF      10047<<ASSIGN
LEA2.ACCT_NAME_SEP
      9192**DCL     10031<<ASSIGN  10032<<ASSIGN  10049<<ASSIGN
LEA2.ARCHIVED_ON
      9198**DCL     10223<<ASSIGN  10241<<ASSIGN
LEA2.BACKED_UP_ON
      9196**DCL     10184<<ASSIGN  10197<<ASSIGN
LEA2.NAME
      9193**DCL     10029<<ASSIGN  10030>>IF      10048<<ASSIGN
LEA3
      9200**DCL     10252--ASSIGN
LEA3.ALT
      9213**DCL     10229<<ASSIGN  10235<<ASSIGN  10243<<ASSIGN
LEA3.ARCHIVE_FSN
      9218**DCL     10238<<CALLBLT 10245<<ASSIGN
LEA3.ARCHIVE_REEL
      9214**DCL     10224<<ASSIGN  10244<<ASSIGN
LEA3.ARCHIVE_REEL_CROSSES
      9216**DCL     10228<<ASSIGN  10233<<ASSIGN  10234<<ASSIGN  10242<<ASSIGN
LEA3.BACKUP_FSN
      9211**DCL     10191<<CALLBLT 10201<<ASSIGN
LEA3.BACKUP_REEL
      9207**DCL     10189<<ASSIGN  10199<<ASSIGN
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:125  
LEA3.BACKUP_REEL_CROSSES
      9209**DCL     10187<<ASSIGN  10188<<ASSIGN  10198<<ASSIGN
LEA3.BLT
      9206**DCL     10193<<ASSIGN  10194<<ASSIGN  10200<<ASSIGN
LEA3.WILL_EXPIRE_ON
      9203**DCL     10012<<ASSIGN  10020<<ASSIGN  10044<<ASSIGN
LEA_DATE
      9225**DCL      9229--REDEF
LEA_DATE.DATE
      9226**DCL      9451--DCLINIT  9452--DCLINIT
LEA_DATE.TIME
      9228**DCL      9453--DCLINIT  9454--DCLINIT
LEA_DATE_CHARS
      9229**DCL      9892>>ASSIGN  10007>>ASSIGN  10010>>ASSIGN  10020>>ASSIGN  10026>>ASSIGN  10042>>ASSIGN
     10184>>ASSIGN  10223>>ASSIGN
LO_HEADER
      9494**DCL      9474--DCLINIT
LO_HEADER.TITL.L#
      9496**DCL      9831<<ASSIGN
LO_HEADER.TITL.TITLE#
      9497**DCL      9832<<ASSIGN
M$DEVICE
      6651**DCL-ENT  9705--CALL     9747--CALL     9756--CALL     9833--CALL
M$LINES
      6652**DCL-ENT  9744--CALL
M$LO
      9119**DCL      9700--ASSIGN
M$READ
      6648**DCL-ENT 10134--CALL
M$TIME
      6714**DCL-ENT  9764--CALL     9891--CALL    10006--CALL    10009--CALL    10019--CALL    10025--CALL
     10041--CALL    10058--CALL    10066--CALL    10074--CALL    10183--CALL    10222--CALL
M$WRITE
      6648**DCL-ENT  9760--CALL     9823--CALL     9826--CALL     9857--CALL     9902--CALL    10084--CALL
     10129--CALL    10137--CALL    10159--CALL    10249--CALL    10251--CALL    10253--CALL
NBR_LINES_NEEDED
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:126  
      9232**DCL      9732<<ASSIGN   9734<<ASSIGN   9735<<ASSIGN   9739<<ASSIGN   9739>>ASSIGN   9740<<ASSIGN
      9740>>ASSIGN   9742>>IF       9745>>IF
NO_5_LEADING_ZEROS
      8364**DCL      9954>>CALLBLT
NO_6_LEADING_ZEROS
      8363**DCL      9956>>CALLBLT
NO_LEADING_4_ZEROS
      8362**DCL     10191>>CALLBLT
NO_LEADING_6_ZEROS
      8363**DCL      9792>>CALLBLT  9873>>CALLBLT  9914>>CALLBLT 10238>>CALLBLT
ORG_STR_TBL
      9242**DCL      9949>>ASSIGN
OUTPUT_WIDTH
      9222**DCL      9700<<ASSIGN   9701>>IF       9702<<ASSIGN   9703>>IF       9704<<ASSIGN
OVER_FIL
      8191**DCL      9820>>IF
PAGE_LO
      9545**DCL      9747<>CALL
PAGE_LO.V
      9546**DCL      9545--DCLINIT
PRE_RET_CLOSE.SN_
      8598**DCL      8598--REDEF
PRE_RET_CLOSE.UTL_
      8599**DCL      8599--REDEF
PRE_RET_CLOSE.V.EXPIRE#
      8613**DCL      8613--REDEF
PRE_RET_CLOSE.V.TYPE#
      8611**DCL      8611--REDEF
PRE_RET_CLOSE.V.XTNSIZE#
      8608**DCL      8608--REDEF    8610--REDEF
PRE_RET_OPEN.ACSVEH_
      8533**DCL      8534--REDEF
PRE_RET_OPEN.ALTKEYS_
      8539**DCL      8540--REDEF    8540--REDEF
PRE_RET_OPEN.HDR_
      8538**DCL      8539--REDEF
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:127  
PRE_RET_OPEN.TAB_
      8537**DCL      8538--REDEF
PRE_RET_OPEN.UHL_
      8531**DCL      8532--REDEF    8532--REDEF
PRE_RET_OPEN.V.FSN#
      8571**DCL      8571--REDEF    8571--REDEF
PRE_RET_OPEN.WSN_
      8537**DCL      8537--REDEF
PRE_RET_READ.STATION_
      8388**DCL      8389--REDEF
PRE_RET_READ.V.DVBYTE.REREAD#
      8400**DCL      8400--REDEF
PRE_RET_READ.V.INDX#
      8398**DCL      8398--REDEF
PRE_RET_WRITE.STATION_
      8426**DCL      8426--REDEF
PRE_RET_WRITE.V.DVBYTE.VFC#
      8433**DCL      8433--REDEF
RET_CMDS_NAME.L#
      8642**DCL      8642--IMP-SIZ
SET_LO_HEADER
      9473**DCL      9705<>CALL     9833<>CALL
SET_LO_HEADER.V
      9474**DCL      9473--DCLINIT
SNVECLIST$
      8174**DCL      8174--IMP-PTR
SPEC.START
      8238**DCL      8239--REDEF
SPEC.STOP
      8239**DCL      8240--REDEF
SPECCHARS
      8238**DCL      8238--REDEF
TAPE_CLOSE.SN_
      8091**DCL      8091--REDEF
TAPE_CLOSE.UTL_
      8092**DCL      8092--REDEF
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:128  
TAPE_CLOSE.V.EXPIRE#
      8106**DCL      8106--REDEF
TAPE_CLOSE.V.TYPE#
      8104**DCL      8104--REDEF
TAPE_CLOSE.V.XTNSIZE#
      8101**DCL      8101--REDEF    8103--REDEF
TAPE_DCBLIST$
      7647**DCL      7647--IMP-PTR
TAPE_OPEN.ACSVEH_
      7956**DCL      7957--REDEF
TAPE_OPEN.ALTKEYS_
      7962**DCL      7963--REDEF    7963--REDEF
TAPE_OPEN.HDR_
      7961**DCL      7962--REDEF
TAPE_OPEN.TAB_
      7960**DCL      7961--REDEF
TAPE_OPEN.UHL_
      7954**DCL      7955--REDEF    7955--REDEF
TAPE_OPEN.V.FSN#
      7994**DCL      7994--REDEF    7994--REDEF
TAPE_OPEN.V.RES#
      7978**DCL      9782>>IF
TAPE_OPEN.WSN_
      7960**DCL      7960--REDEF
TAPE_READ.STATION_
      8018**DCL      8019--REDEF
TAPE_READ.V.DVBYTE.REREAD#
      8030**DCL      8030--REDEF
TAPE_READ.V.INDX#
      8028**DCL      8028--REDEF
TAPE_WRITE.STATION_
      8056**DCL      8056--REDEF
TAPE_WRITE.V.DVBYTE.VFC#
      8063**DCL      8063--REDEF
TEMP_UBIN
      9231**DCL     10014<>CALL    10015<<ASSIGN  10015>>ASSIGN  10016>>IF      10017<<ASSIGN  10018>>CALL
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:129  
TEST_MODE
      8672**DCL      9763>>IF       9887>>IF      10003>>IF      10022>>IF      10038>>IF      10055>>IF
     10063>>IF      10181>>IF      10220>>IF
TOTAL_FILES
      8360**DCL      9858<<ASSIGN   9858>>ASSIGN   9909<<ASSIGN   9909>>ASSIGN
TOTAL_GRANS
      8360**DCL      9958<<ASSIGN   9958>>ASSIGN
TSN
        16**DCL         9--PROC     9733>>IF       9754>>IF       9777>>ASSIGN   9886>>ASSIGN
TSTAMP
      9221**DCL      9430--DCLINIT  9455--DCLINIT  9889<<ASSIGN   9890<<ASSIGN  10004<<ASSIGN  10005<<ASSIGN
     10008<<ASSIGN  10014<>CALL    10018<>CALL    10018<>CALL    10023<<ASSIGN  10024<<ASSIGN  10039<<ASSIGN
     10040<<ASSIGN  10056<<ASSIGN  10057<<ASSIGN  10064<<ASSIGN  10065<<ASSIGN  10073<<ASSIGN  10078<<ASSIGN
     10103>>ASSIGN  10140>>ASSIGN  10169<<ASSIGN  10175<<ASSIGN  10179>>IF      10182<<ASSIGN  10208<<ASSIGN
     10214<<ASSIGN  10218>>IF      10221<<ASSIGN
TVECTOR.W2
      8187**DCL      8188--REDEF
VLR_LINES
      9528**DCL      9513--DCLINIT
VLR_LINES.RLINES#
      9528**DCL      9745>>IF       9745>>IF
WRITE_LO
      9372**DCL      9760<>CALL     9823<>CALL     9826<>CALL     9857<>CALL     9902<>CALL    10084<>CALL
     10249<>CALL    10251<>CALL    10253<>CALL
WRITE_LO.BUF_
      9372**DCL      9759<<ASSIGN   9819<<ASSIGN   9834<<ASSIGN  10248<<ASSIGN  10250<<ASSIGN  10252<<ASSIGN
     10254<<ASSIGN
WRITE_LO.STATION_
      9374**DCL      9374--REDEF
WRITE_LO.V
      9375**DCL      9372--DCLINIT
WRITE_LO.V.DVBYTE.VFC#
      9381**DCL      9381--REDEF
XSF$LOCCODP
      9065**DCL-ENT  9941--CALL     9993--CALL    10071--CALL    10173--CALL    10212--CALL
XUD$UTS_ADJ_25TH
PL6.E3A0      #001=FLP$WR_FILE_INFO File=FLP$PRINTER.:E05TSI                     TUE 07/29/97 16:16 Page:130  
      9091**DCL-ENT 10018--CALL
XUD$UTS_DIFF_SEC
      9073**DCL-ENT 10014--CALL

PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:131  
      848        1        /*T***********************************************************/
      849        2        /*T*                                                         */
      850        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      851        4        /*T*                                                         */
      852        5        /*T***********************************************************/
      853        6        FLI$RPT_ERR: PROC( ERR, DCB#, V1_, V2_, V3_ );
      854        7        /*F*  NAME: FLI$RPT_ERR
      855        8              PURPOSE: Reports errors.
      856        9         */
      857       10
      858       11    1   DCL ERR BIT(36) ALIGNED;                /* Error word in standard format      */
      859       12    1   DCL DCB# UBIN WORD ALIGNED;        /* Number of DCB associated with error     */
      860       13    1   DCL V1_ VECTOR DALIGNED;      /* Text string to be substituted in message     */
      861       14    1   DCL V2_ VECTOR DALIGNED;      /* Text string to be substituted in message     */
      862       15    1   DCL V3_ VECTOR DALIGNED;      /* Text string to be substituted in message     */
      863       16
      864       17         /***
      865       18          *** INCLUDE
      866       19          ***/
      867       20
      868       21        %INCLUDE CP_6;
      869     5580        %INCLUDE B$JIT;
      870     6183        %INCLUDE XUR_ENTRY;
      871     6215        %INCLUDE FLI_DATA_R;
      872     7629
      873     7630        /***
      874     7631         *** DCB
      875     7632         ***/
      876     7633
      877     7634    1   DCL M$LO DCB;
      878     7635    1   DCL M$EFT_ERRORS DCB;
      879     7636
      880     7637         /***
      881     7638          *** AUTO
      882     7639          ***/
      883     7640
      884     7641    1   DCL 1 ERRCODE AUTO,
PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:132  
      885     7642    1         2 * BIT(33) UNAL,
      886     7643    1         2 SEV UBIN(3) UNAL;
      887     7644    1   DCL THE_DCB# UBIN WORD AUTO;
      888     7645
      889     7646         /***
      890     7647          *** BASED
      891     7648          ***/
      892     7649
      893     7650        %B$TCB;
      894     7653        %B$ALT;
      895     7661        %F$DCB;
      896     7718
      897     7719        /***
      898     7720         *** FPT
      899     7721         ***/
      900     7722
      901     7723        %FPT_OPEN( FPTN=OPEN_EFT_ERRORS,
      902     7724                   DCB=M$EFT_ERRORS,
      903     7725                   CTG=YES,
      904     7726                   ORG=CONSEC,
      905     7727                   FUN=CREATE,
      906     7728                   ASN=FILE,
      907     7729                   NAME=STAR_EFT_ERRORS );
      908     7838
      909     7839        %VLP_NAME( FPTN=STAR_EFT_ERRORS,
      910     7840                   NAME='*EFT_ERRORS' );
      911     7867
      912     7868        %FPT_WRITE( FPTN=WRITE_EFT_ERRORS,
      913     7869                    DCB=M$EFT_ERRORS,
      914     7870                    BUF=VLR_LINES );
      915     7901
      916     7902        %FPT_LINES( FPTN=GET_LO_LINES,
      917     7903                    DCB=M$LO,
      918     7904                    LINES=VLR_LINES );
      919     7918
      920     7919        %VLR_LINES;
      921     7933
PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:133  
      922     7934        %VLP_VECTOR( FPTN=F1_ );
      923     7949        %VLP_VECTOR( FPTN=F2_ );
      924     7964        %VLP_VECTOR( FPTN=F3_ );
      925     7979
      926     7980        /****************************************/
      927     7981
      928     7982    1      IF ADDR(DCB#) ~= ADDR(NIL)
      929     7983    1       THEN THE_DCB# = DCB#;
      930     7984    1       ELSE THE_DCB# = B$TCB$->B$TCB.ALT$->B$ALT.DCB#;
      931     7985
      932     7986    1      IF ADDR(ERR) ~= ADDR(NIL)
      933     7987    1       THEN ERRCODE = ERR;
      934     7988    1       ELSE ERRCODE = B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      935     7989
      936     7990    1      IF ADDR(V1_) ~= ADDR(NIL)
      937     7991    1       THEN F1_ = V1_;
      938     7992    1       ELSE F1_ = VECTOR(NIL);
      939     7993    1      IF ADDR(V2_) ~= ADDR(NIL)
      940     7994    1       THEN F2_ = V2_;
      941     7995    1       ELSE F2_ = VECTOR(NIL);
      942     7996    1      IF ADDR(V3_) ~= ADDR(NIL)
      943     7997    1       THEN F3_ = V3_;
      944     7998    1       ELSE F3_ = VECTOR(NIL);
      945     7999
      946     8000    1      IF B$JIT.MODE = %M_INT#
      947     8001    1       THEN ERRCODE.SEV = 0;               /* Use one-liner                      */
      948     8002
      949     8003    1      IF THE_DCB# = 0
      950     8004    1       THEN CALL XUR$ERRMSG( ERRCODE, , , F1_, F2_, F3_ ) ALTRET( JUSTXXX );
      951     8005    1       ELSE CALL XUR$ERRMSG( ERRCODE, THE_DCB#, , F1_, F2_, F3_ ) ALTRET( JUSTXXX );
      952     8006
      953     8007    1      IF NOT DCBADDR(DCBNUM(M$EFT_ERRORS))->F$DCB.FCD#
      954     8008    1       THEN CALL M$OPEN( OPEN_EFT_ERRORS ) ALTRET( JUSTXXX );
      955     8009
      956     8010    1      CALL M$LINES( GET_LO_LINES ) ALTRET( JUSTXXX );
      957     8011    1      VLR_LINES.RLINES# = DCBADDR(DCBNUM(M$LO))->F$DCB.LINES# - VLR_LINES.RLINES#;
      958     8012    1      CALL M$WRITE( WRITE_EFT_ERRORS ) ALTRET( JUSTXXX );
PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:134  
      959     8013    1      CALL XUR$ERRMSG( ERRCODE, THE_DCB#, DCBNUM(M$EFT_ERRORS) ) ALTRET( JUSTXXX );
      960     8014
      961     8015    1      TOTAL_ERRORS = TOTAL_ERRORS + 1;
      962     8016    1      RETURN;
      963     8017
      964     8018    1   JUSTXXX: ;
      965     8019    1      CALL M$XXX;
      966     8020
      967     8021    1   END FLI$RPT_ERR;
      968     8022        %EOD;

PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:135  
--  Include file information  --

   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XUR_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLI$RPT_ERR.

   Procedure FLI$RPT_ERR requires 135 words for executable code.
   Procedure FLI$RPT_ERR requires 16 words of local(AUTO) storage.

PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:136  

 Object Unit name= FLI$RPT_ERR                                File name= FLP$PRINTER.:E05TOU
 UTS= JUL 29 '97 16:18:46.28 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$PRE_RET
    2   Data  even  none    94    136  FLI$RPT_ERR
    3   DCB   even  none     0      0  M$LO
    4   DCB   even  none     0      0  M$EFT_ERRORS
    5   Proc  even  none   135    207  FLI$RPT_ERR
    6  RoData even  none     7      7  FLI$RPT_ERR

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes            yes      Std        5  FLI$RPT_ERR

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       7 XUR$ERRMSG
                       nStd      0 X66_AUTO_5
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:137  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TAPE_DCBLIST$                         SNVECLIST$
     B$JIT$                                B$TCB$                                DPLIST$
     DPRESLIST$                            DISK_FILE_SPEC$                       SPECCHARS
     EFTWORD                               TOTAL_ERRORS                          M$PRE_RET
     RET_CMDS_NAME                         M$LO                                  M$EFT_ERRORS
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:138  


      848        1        /*T***********************************************************/
      849        2        /*T*                                                         */
      850        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      851        4        /*T*                                                         */
      852        5        /*T***********************************************************/
      853        6        FLI$RPT_ERR: PROC( ERR, DCB#, V1_, V2_, V3_ );

      6  5 000000   000000 700200 xent  FLI$RPT_ERR  TSX0  ! X66_AUTO_5
         5 000001   000020 000005                    ZERO    16,5

      854        7        /*F*  NAME: FLI$RPT_ERR
      855        8              PURPOSE: Reports errors.
      856        9         */
      857       10
      858       11    1   DCL ERR BIT(36) ALIGNED;                /* Error word in standard format      */
      859       12    1   DCL DCB# UBIN WORD ALIGNED;        /* Number of DCB associated with error     */
      860       13    1   DCL V1_ VECTOR DALIGNED;      /* Text string to be substituted in message     */
      861       14    1   DCL V2_ VECTOR DALIGNED;      /* Text string to be substituted in message     */
      862       15    1   DCL V3_ VECTOR DALIGNED;      /* Text string to be substituted in message     */
      863       16
      864       17         /***
      865       18          *** INCLUDE
      866       19          ***/
      867       20
      868       21        %INCLUDE CP_6;
      869     5580        %INCLUDE B$JIT;
      870     6183        %INCLUDE XUR_ENTRY;
      871     6215        %INCLUDE FLI_DATA_R;
      872     7629
      873     7630        /***
      874     7631         *** DCB
      875     7632         ***/
      876     7633
      877     7634    1   DCL M$LO DCB;
      878     7635    1   DCL M$EFT_ERRORS DCB;
      879     7636
PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:139  
      880     7637         /***
      881     7638          *** AUTO
      882     7639          ***/
      883     7640
      884     7641    1   DCL 1 ERRCODE AUTO,
      885     7642    1         2 * BIT(33) UNAL,
      886     7643    1         2 SEV UBIN(3) UNAL;
      887     7644    1   DCL THE_DCB# UBIN WORD AUTO;
      888     7645
      889     7646         /***
      890     7647          *** BASED
      891     7648          ***/
      892     7649
      893     7650        %B$TCB;
      894     7653        %B$ALT;
      895     7661        %F$DCB;
      896     7718
      897     7719        /***
      898     7720         *** FPT
      899     7721         ***/
      900     7722
      901     7723        %FPT_OPEN( FPTN=OPEN_EFT_ERRORS,
      902     7724                   DCB=M$EFT_ERRORS,
      903     7725                   CTG=YES,
      904     7726                   ORG=CONSEC,
      905     7727                   FUN=CREATE,
      906     7728                   ASN=FILE,
      907     7729                   NAME=STAR_EFT_ERRORS );
      908     7838
      909     7839        %VLP_NAME( FPTN=STAR_EFT_ERRORS,
      910     7840                   NAME='*EFT_ERRORS' );
      911     7867
      912     7868        %FPT_WRITE( FPTN=WRITE_EFT_ERRORS,
      913     7869                    DCB=M$EFT_ERRORS,
      914     7870                    BUF=VLR_LINES );
      915     7901
      916     7902        %FPT_LINES( FPTN=GET_LO_LINES,
PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:140  
      917     7903                    DCB=M$LO,
      918     7904                    LINES=VLR_LINES );
      919     7918
      920     7919        %VLR_LINES;
      921     7933
      922     7934        %VLP_VECTOR( FPTN=F1_ );
      923     7949        %VLP_VECTOR( FPTN=F2_ );
      924     7964        %VLP_VECTOR( FPTN=F3_ );
      925     7979
      926     7980        /****************************************/
      927     7981
      928     7982    1      IF ADDR(DCB#) ~= ADDR(NIL)

   7982  5 000002   200004 236100                    LDQ     @DCB#,,AUTO
         5 000003   000001 116000 xsym               CMPQ    B_VECTNIL+1
         5 000004   000011 600000 5                  TZE     s:7984

      929     7983    1       THEN THE_DCB# = DCB#;

   7983  5 000005   200004 470500                    LDP0    @DCB#,,AUTO
         5 000006   000000 235100                    LDA     0,,PR0
         5 000007   200011 755100                    STA     THE_DCB#,,AUTO
         5 000010   000015 710000 5                  TRA     s:7986

      930     7984    1       ELSE THE_DCB# = B$TCB$->B$TCB.ALT$->B$ALT.DCB#;

   7984  5 000011   000000 470400 xsym               LDP0    B$TCB$
         5 000012   000000 471500                    LDP1    0,,PR0
         5 000013   100101 235100                    LDA     65,,PR1
         5 000014   200011 755100                    STA     THE_DCB#,,AUTO

      931     7985
      932     7986    1      IF ADDR(ERR) ~= ADDR(NIL)

   7986  5 000015   200003 236100                    LDQ     @ERR,,AUTO
         5 000016   000001 116000 xsym               CMPQ    B_VECTNIL+1
         5 000017   000024 600000 5                  TZE     s:7988
PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:141  

      933     7987    1       THEN ERRCODE = ERR;

   7987  5 000020   200003 470500                    LDP0    @ERR,,AUTO
         5 000021   000000 236100                    LDQ     0,,PR0
         5 000022   200010 756100                    STQ     ERRCODE,,AUTO
         5 000023   000030 710000 5                  TRA     s:7990

      934     7988    1       ELSE ERRCODE = B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   7988  5 000024   000000 470400 xsym               LDP0    B$TCB$
         5 000025   000000 471500                    LDP1    0,,PR0
         5 000026   100102 236100                    LDQ     66,,PR1
         5 000027   200010 756100                    STQ     ERRCODE,,AUTO

      935     7989
      936     7990    1      IF ADDR(V1_) ~= ADDR(NIL)

   7990  5 000030   200005 236100                    LDQ     @V1_,,AUTO
         5 000031   000001 116000 xsym               CMPQ    B_VECTNIL+1
         5 000032   000037 600000 5                  TZE     s:7992

      937     7991    1       THEN F1_ = V1_;

   7991  5 000033   200005 470500                    LDP0    @V1_,,AUTO
         5 000034   000000 237100                    LDAQ    0,,PR0
         5 000035   000130 757000 2                  STAQ    F1_
         5 000036   000041 710000 5                  TRA     s:7993

      938     7992    1       ELSE F1_ = VECTOR(NIL);

   7992  5 000037   000000 237000 6                  LDAQ    0
         5 000040   000130 757000 2                  STAQ    F1_

      939     7993    1      IF ADDR(V2_) ~= ADDR(NIL)

   7993  5 000041   200006 236100                    LDQ     @V2_,,AUTO
PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:142  
         5 000042   000001 116000 xsym               CMPQ    B_VECTNIL+1
         5 000043   000050 600000 5                  TZE     s:7995

      940     7994    1       THEN F2_ = V2_;

   7994  5 000044   200006 470500                    LDP0    @V2_,,AUTO
         5 000045   000000 237100                    LDAQ    0,,PR0
         5 000046   000132 757000 2                  STAQ    F2_
         5 000047   000052 710000 5                  TRA     s:7996

      941     7995    1       ELSE F2_ = VECTOR(NIL);

   7995  5 000050   000000 237000 6                  LDAQ    0
         5 000051   000132 757000 2                  STAQ    F2_

      942     7996    1      IF ADDR(V3_) ~= ADDR(NIL)

   7996  5 000052   200007 236100                    LDQ     @V3_,,AUTO
         5 000053   000001 116000 xsym               CMPQ    B_VECTNIL+1
         5 000054   000061 600000 5                  TZE     s:7998

      943     7997    1       THEN F3_ = V3_;

   7997  5 000055   200007 470500                    LDP0    @V3_,,AUTO
         5 000056   000000 237100                    LDAQ    0,,PR0
         5 000057   000134 757000 2                  STAQ    F3_
         5 000060   000063 710000 5                  TRA     s:8000

      944     7998    1       ELSE F3_ = VECTOR(NIL);

   7998  5 000061   000000 237000 6                  LDAQ    0
         5 000062   000134 757000 2                  STAQ    F3_

      945     7999
      946     8000    1      IF B$JIT.MODE = %M_INT#

   8000  5 000063   000000 470400 xsym               LDP0    B$JIT$
PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:143  
         5 000064   000000 236100                    LDQ     0,,PR0
         5 000065   740000 376003                    ANQ     -16384,DU
         5 000066   140000 116003                    CMPQ    49152,DU
         5 000067   000072 601000 5                  TNZ     s:8003

      947     8001    1       THEN ERRCODE.SEV = 0;               /* Use one-liner                      */

   8001  5 000070   000002 236000 6                  LDQ     2
         5 000071   200010 356100                    ANSQ    ERRCODE,,AUTO

      948     8002
      949     8003    1      IF THE_DCB# = 0

   8003  5 000072   200011 236100                    LDQ     THE_DCB#,,AUTO
         5 000073   000112 601000 5                  TNZ     s:8005

      950     8004    1       THEN CALL XUR$ERRMSG( ERRCODE, , , F1_, F2_, F3_ ) ALTRET( JUSTXXX );

   8004  5 000074   000004 237000 6                  LDAQ    4
         5 000075   200016 757100                    STAQ    THE_DCB#+5,,AUTO
         5 000076   000003 236000 6                  LDQ     3
         5 000077   000001 235000 xsym               LDA     B_VECTNIL+1
         5 000100   200014 757100                    STAQ    THE_DCB#+3,,AUTO
         5 000101   000001 236000 xsym               LDQ     B_VECTNIL+1
         5 000102   200013 756100                    STQ     THE_DCB#+2,,AUTO
         5 000103   200010 631500                    EPPR1   ERRCODE,,AUTO
         5 000104   200012 451500                    STP1    THE_DCB#+1,,AUTO
         5 000105   200012 630500                    EPPR0   THE_DCB#+1,,AUTO
         5 000106   000024 631400 xsym               EPPR1   B_VECTNIL+20
         5 000107   000000 701000 xent               TSX1    XUR$ERRMSG
         5 000110   000204 702000 5                  TSX2    JUSTXXX
         5 000111   000127 710000 5                  TRA     s:8007

      951     8005    1       ELSE CALL XUR$ERRMSG( ERRCODE, THE_DCB#, , F1_, F2_, F3_ ) ALTRET( JUSTXXX );

   8005  5 000112   000004 237000 6                  LDAQ    4
         5 000113   200016 757100                    STAQ    THE_DCB#+5,,AUTO
PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:144  
         5 000114   000003 236000 6                  LDQ     3
         5 000115   000001 235000 xsym               LDA     B_VECTNIL+1
         5 000116   200014 757100                    STAQ    THE_DCB#+3,,AUTO
         5 000117   200011 631500                    EPPR1   THE_DCB#,,AUTO
         5 000120   200013 451500                    STP1    THE_DCB#+2,,AUTO
         5 000121   200010 633500                    EPPR3   ERRCODE,,AUTO
         5 000122   200012 453500                    STP3    THE_DCB#+1,,AUTO
         5 000123   200012 630500                    EPPR0   THE_DCB#+1,,AUTO
         5 000124   000024 631400 xsym               EPPR1   B_VECTNIL+20
         5 000125   000000 701000 xent               TSX1    XUR$ERRMSG
         5 000126   000204 702000 5                  TSX2    JUSTXXX

      952     8006
      953     8007    1      IF NOT DCBADDR(DCBNUM(M$EFT_ERRORS))->F$DCB.FCD#

   8007  5 000127   000000 236007 xsym               LDQ     M$EFT_ERRORS,DL
         5 000130   000006 470400 6                  LDP0    6
         5 000131   000000 471500                    LDP1    0,,PR0
         5 000132   100000 473506                    LDP3    0,QL,PR1
         5 000133   300031 236100                    LDQ     25,,PR3
         5 000134   020000 316007                    CANQ    8192,DL
         5 000135   000142 601000 5                  TNZ     s:8010

      954     8008    1       THEN CALL M$OPEN( OPEN_EFT_ERRORS ) ALTRET( JUSTXXX );

   8008  5 000136   000006 630400 2                  EPPR0   OPEN_EFT_ERRORS
         5 000137   450000 713400                    CLIMB   alt,open
         5 000140   410400 401760                    pmme    nvectors=18
         5 000141   000204 702000 5                  TSX2    JUSTXXX

      955     8009
      956     8010    1      CALL M$LINES( GET_LO_LINES ) ALTRET( JUSTXXX );

   8010  5 000142   000120 630400 2                  EPPR0   GET_LO_LINES
         5 000143   450005 713400                    CLIMB   alt,+20485
         5 000144   400400 401760                    pmme    nvectors=2
         5 000145   000204 702000 5                  TSX2    JUSTXXX
PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:145  

      957     8011    1      VLR_LINES.RLINES# = DCBADDR(DCBNUM(M$LO))->F$DCB.LINES# - VLR_LINES.RLINES#;

   8011  5 000146   000000 236007 xsym               LDQ     M$LO,DL
         5 000147   000006 470400 6                  LDP0    6
         5 000150   000000 471500                    LDP1    0,,PR0
         5 000151   100000 473506                    LDP3    0,QL,PR1
         5 000152   000126 235000 2                  LDA     VLR_LINES
         5 000153   000022 731000                    ARS     18
         5 000154   200012 755100                    STA     THE_DCB#+1,,AUTO
         5 000155   300044 236100                    LDQ     36,,PR3
         5 000156   000022 772000                    QRL     18
         5 000157   200012 136100                    SBLQ    THE_DCB#+1,,AUTO
         5 000160   000000 620006                    EAX0    0,QL
         5 000161   000126 740000 2                  STX0    VLR_LINES

      958     8012    1      CALL M$WRITE( WRITE_EFT_ERRORS ) ALTRET( JUSTXXX );

   8012  5 000162   000104 630400 2                  EPPR0   WRITE_EFT_ERRORS
         5 000163   440001 713400                    CLIMB   alt,write
         5 000164   401400 401760                    pmme    nvectors=4
         5 000165   000204 702000 5                  TSX2    JUSTXXX

      959     8013    1      CALL XUR$ERRMSG( ERRCODE, THE_DCB#, DCBNUM(M$EFT_ERRORS) ) ALTRET( JUSTXXX );

   8013  5 000166   000000 236007 xsym               LDQ     M$EFT_ERRORS,DL
         5 000167   200012 756100                    STQ     THE_DCB#+1,,AUTO
         5 000170   200012 630500                    EPPR0   THE_DCB#+1,,AUTO
         5 000171   200015 450500                    STP0    THE_DCB#+4,,AUTO
         5 000172   200011 631500                    EPPR1   THE_DCB#,,AUTO
         5 000173   200014 451500                    STP1    THE_DCB#+3,,AUTO
         5 000174   200010 633500                    EPPR3   ERRCODE,,AUTO
         5 000175   200013 453500                    STP3    THE_DCB#+2,,AUTO
         5 000176   200013 630500                    EPPR0   THE_DCB#+2,,AUTO
         5 000177   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 000200   000000 701000 xent               TSX1    XUR$ERRMSG
         5 000201   000204 702000 5                  TSX2    JUSTXXX
PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:146  

      960     8014
      961     8015    1      TOTAL_ERRORS = TOTAL_ERRORS + 1;

   8015  5 000202   000000 054000 xsym               AOS     TOTAL_ERRORS

      962     8016    1      RETURN;

   8016  5 000203   000000 702200 xent               TSX2  ! X66_ARET

   8015  5 000204                       JUSTXXX      null
      963     8017
      964     8018    1   JUSTXXX: ;
      965     8019    1      CALL M$XXX;

   8019  5 000204   000003 713400                    CLIMB   3
         5 000205   000000 401760                    pmme    nvectors=0

      966     8020
      967     8021    1   END FLI$RPT_ERR;

   8021  5 000206   000000 702200 xent               TSX2  ! X66_ARET
      968     8022        %EOD;

PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:147  
--  Include file information  --

   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XUR_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLI$RPT_ERR.
PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:148  

 **** Variables and constants ****

  ****  Section 002  Data  FLI$RPT_ERR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   130-0-0/d STRC(72)    r     1 F1_                      132-0-0/d STRC(72)    r     1 F2_
   134-0-0/d STRC(72)    r     1 F3_                      120-0-0/d STRC(216)   r     1 GET_LO_LINES
     6-0-0/d STRC(2088)  r     1 OPEN_EFT_ERRORS          100-0-0/c STRC(108)   r     1 STAR_EFT_ERRORS
   126-0-0/d STRC(72)    r     1 VLR_LINES                104-0-0/d STRC(432)   r     1 WRITE_EFT_ERRORS

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @DCB#                      3-0-0/w PTR         r     1 @ERR
     5-0-0/w PTR         r     1 @V1_                       6-0-0/w PTR         r     1 @V2_
     7-0-0/w PTR         r     1 @V3_                      *0-0-0/w UBIN        r     1 DCB#
    *0-0-0/w BIT         r     1 ERR                       10-0-0/b STRC        r     1 ERRCODE
    11-0-0/w UBIN        r     1 THE_DCB#                  *0-0-0/d VECT        r     1 V1_
    *0-0-0/d VECT        r     1 V2_                       *0-0-0/d VECT        r     1 V3_

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/w PTR         r     1 DISK_FILE_SPEC$            0-0-0/w PTR         r     1 DPLIST$
     0-0-0/w PTR         r     1 DPRESLIST$                 0-0-0/c ASTR(9)     r     1 RET_CMDS_NAME
     0-0-0/w PTR         r     1 SNVECLIST$                 0-0-0/w PTR         r     1 TAPE_DCBLIST$
     0-0-0/w SBIN        r     1 TOTAL_ERRORS

  ****  BASED and DCB variables  ****

PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:149  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 M$EFT_ERRORS               0-0-0N  NULL        r     1 M$LO


   Procedure FLI$RPT_ERR requires 135 words for executable code.
   Procedure FLI$RPT_ERR requires 16 words of local(AUTO) storage.
PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:150  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:151  
          MINI XREF LISTING

B$ALT.CODE
      7655**DCL      7655--REDEF    7656--REDEF    7656--REDEF
B$ALT.DCB#
      7656**DCL      7984>>ASSIGN
B$ALT.ERR
      7656**DCL      7988>>ASSIGN
B$ALT.ERR.ERR#
      7657**DCL      7657--REDEF
B$ALT.EVID
      7656**DCL      7656--REDEF    7656--REDEF
B$JIT.CPFLAGS1.SLEAZE
      6001**DCL      6001--REDEF
B$JIT.ERR.MID
      5908**DCL      5908--REDEF
B$JIT.JRESPEAK
      6069**DCL      6070--REDEF
B$JIT.MODE
      5902**DCL      8000>>IF
B$JIT.ORIGINATOR_PORT.FROM_CR
      6178**DCL      6178--REDEF    6179--REDEF
B$JIT.PNR
      6082**DCL      6082--REDEF
B$JIT.TSLINE
      6176**DCL      6177--REDEF
B$JIT$
      7146**DCL      5902--IMP-PTR  8000>>IF
B$TCB.ALT$
      7651**DCL      7984>>ASSIGN   7988>>ASSIGN
B$TCB$
      7146**DCL      7984>>ASSIGN   7988>>ASSIGN
DCB#
        12**DCL         6--PROC     7982--IF       7983>>ASSIGN
PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:152  
DISK_CLOSE.SN_
      6826**DCL      6826--REDEF
DISK_CLOSE.UTL_
      6827**DCL      6827--REDEF
DISK_CLOSE.V.EXPIRE#
      6841**DCL      6841--REDEF
DISK_CLOSE.V.TYPE#
      6839**DCL      6839--REDEF
DISK_CLOSE.V.XTNSIZE#
      6836**DCL      6836--REDEF    6838--REDEF
DISK_FILE_SPEC.SPEC
      7191**DCL      7193--REDEF
DISK_FILE_SPEC.SPEC.START
      7192**DCL      7192--REDEF
DISK_FILE_SPEC.SPEC.STOP
      7193**DCL      7193--REDEF
DISK_FILE_SPEC$
      7190**DCL      7191--IMP-PTR
DISK_OPEN.ACSVEH_
      6691**DCL      6692--REDEF
DISK_OPEN.ALTKEYS_
      6697**DCL      6698--REDEF    6698--REDEF
DISK_OPEN.HDR_
      6696**DCL      6697--REDEF
DISK_OPEN.TAB_
      6695**DCL      6696--REDEF
DISK_OPEN.UHL_
      6689**DCL      6690--REDEF    6690--REDEF
DISK_OPEN.V.FSN#
      6729**DCL      6729--REDEF    6729--REDEF
DISK_OPEN.WSN_
      6695**DCL      6695--REDEF
DISK_READ.STATION_
      6753**DCL      6754--REDEF
DISK_READ.V.DVBYTE.REREAD#
      6765**DCL      6765--REDEF
PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:153  
DISK_READ.V.INDX#
      6763**DCL      6763--REDEF
DISK_WRITE.STATION_
      6791**DCL      6791--REDEF
DISK_WRITE.V.DVBYTE.VFC#
      6798**DCL      6798--REDEF
DPLIST$
      7176**DCL      7188--IMP-PTR
DPRESLIST$
      7190**DCL      7190--IMP-PTR
EFTWORD
      7311**DCL      7311--REDEF
ERR
        11**DCL         6--PROC     7986--IF       7987>>ASSIGN
ERRCODE
      7641**DCL      7987<<ASSIGN   7988<<ASSIGN   8004<>CALL     8005<>CALL     8013<>CALL
ERRCODE.SEV
      7643**DCL      8001<<ASSIGN
F$DCB.ACTPOS
      7694**DCL      7694--REDEF
F$DCB.ARS#
      7668**DCL      7668--REDEF
F$DCB.ATTR
      7687**DCL      7688--REDEF
F$DCB.BORROW
      7702**DCL      7702--REDEF    7702--REDEF    7702--REDEF
F$DCB.DCBNAME.L
      7716**DCL      7716--IMP-SIZ
F$DCB.EOMCHAR#
      7672**DCL      7672--REDEF
F$DCB.FCD#
      7681**DCL      8007>>IF
F$DCB.FLDID
      7697**DCL      7697--REDEF
F$DCB.FORM$
      7691**DCL      7691--REDEF
PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:154  
F$DCB.FSECT
      7707**DCL      7707--REDEF
F$DCB.FSN#
      7684**DCL      7684--REDEF    7684--REDEF    7685--REDEF
F$DCB.HEADER$
      7690**DCL      7690--REDEF
F$DCB.IXTNSIZE#
      7688**DCL      7688--REDEF
F$DCB.LASTSTA$
      7677**DCL      7677--REDEF
F$DCB.LINES#
      7690**DCL      8011>>ASSIGN
F$DCB.LVL
      7703**DCL      7703--REDEF
F$DCB.NAME#.C
      7678**DCL      7678--REDEF
F$DCB.NOEOF
      7700**DCL      7700--REDEF
F$DCB.NRECS#
      7689**DCL      7689--REDEF
F$DCB.NRECX
      7708**DCL      7708--REDEF
F$DCB.OHDR
      7700**DCL      7700--REDEF
F$DCB.ORG#
      7683**DCL      7683--REDEF
F$DCB.PRECNO
      7706**DCL      7706--REDEF
F$DCB.RCSZ
      7712**DCL      7712--REDEF
F$DCB.RES#
      7679**DCL      7679--REDEF
F$DCB.SETX
      7691**DCL      7691--REDEF
F$DCB.TAB$
      7691**DCL      7691--REDEF
PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:155  
F$DCB.TDA
      7705**DCL      7706--REDEF
F$DCB.WSN#
      7679**DCL      7679--REDEF
F1_
      7945**DCL      7991<<ASSIGN   7992<<ASSIGN   8004<>CALL     8005<>CALL
F1_.W2
      7946**DCL      7947--REDEF
F2_
      7960**DCL      7994<<ASSIGN   7995<<ASSIGN   8004<>CALL     8005<>CALL
F2_.W2
      7961**DCL      7962--REDEF
F3_
      7975**DCL      7997<<ASSIGN   7998<<ASSIGN   8004<>CALL     8005<>CALL
F3_.W2
      7976**DCL      7977--REDEF
FPT_EXIT.V.STEPCC#
      6616**DCL      6616--REDEF
GET_LO_LINES
      7915**DCL      8010<>CALL
GET_LO_LINES.V
      7915**DCL      7915--DCLINIT
JUSTXXX
      8015**LABEL    8004--CALLALT  8005--CALLALT  8008--CALLALT  8010--CALLALT  8012--CALLALT  8013--CALLALT
M$EFT_ERRORS
      7635**DCL      8007--IF       8013<>CALL
M$LINES
      5513**DCL-ENT  8010--CALL
M$LO
      7634**DCL      8011--ASSIGN
M$OPEN
      5508**DCL-ENT  8008--CALL
M$WRITE
      5509**DCL-ENT  8012--CALL
M$XXX
      5520**DCL-ENT  8019--CALL
PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:156  
OPEN_EFT_ERRORS
      7794**DCL      8008<>CALL
OPEN_EFT_ERRORS.ACSVEH_
      7796**DCL      7797--REDEF
OPEN_EFT_ERRORS.ALTKEYS_
      7802**DCL      7803--REDEF    7803--REDEF
OPEN_EFT_ERRORS.HDR_
      7801**DCL      7802--REDEF
OPEN_EFT_ERRORS.TAB_
      7800**DCL      7801--REDEF
OPEN_EFT_ERRORS.UHL_
      7794**DCL      7795--REDEF    7795--REDEF
OPEN_EFT_ERRORS.V
      7803**DCL      7794--DCLINIT
OPEN_EFT_ERRORS.V.FSN#
      7834**DCL      7834--REDEF    7834--REDEF
OPEN_EFT_ERRORS.WSN_
      7800**DCL      7800--REDEF
PRE_RET_CLOSE.SN_
      7554**DCL      7554--REDEF
PRE_RET_CLOSE.UTL_
      7555**DCL      7555--REDEF
PRE_RET_CLOSE.V.EXPIRE#
      7569**DCL      7569--REDEF
PRE_RET_CLOSE.V.TYPE#
      7567**DCL      7567--REDEF
PRE_RET_CLOSE.V.XTNSIZE#
      7564**DCL      7564--REDEF    7566--REDEF
PRE_RET_OPEN.ACSVEH_
      7489**DCL      7490--REDEF
PRE_RET_OPEN.ALTKEYS_
      7495**DCL      7496--REDEF    7496--REDEF
PRE_RET_OPEN.HDR_
      7494**DCL      7495--REDEF
PRE_RET_OPEN.TAB_
      7493**DCL      7494--REDEF
PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:157  
PRE_RET_OPEN.UHL_
      7487**DCL      7488--REDEF    7488--REDEF
PRE_RET_OPEN.V.FSN#
      7527**DCL      7527--REDEF    7527--REDEF
PRE_RET_OPEN.WSN_
      7493**DCL      7493--REDEF
PRE_RET_READ.STATION_
      7344**DCL      7345--REDEF
PRE_RET_READ.V.DVBYTE.REREAD#
      7356**DCL      7356--REDEF
PRE_RET_READ.V.INDX#
      7354**DCL      7354--REDEF
PRE_RET_WRITE.STATION_
      7382**DCL      7382--REDEF
PRE_RET_WRITE.V.DVBYTE.VFC#
      7389**DCL      7389--REDEF
RET_CMDS_NAME.L#
      7598**DCL      7598--IMP-SIZ
SNVECLIST$
      7130**DCL      7130--IMP-PTR
SPEC.START
      7194**DCL      7195--REDEF
SPEC.STOP
      7195**DCL      7196--REDEF
SPECCHARS
      7194**DCL      7194--REDEF
STAR_EFT_ERRORS
      7865**DCL      7795--DCLINIT
TAPE_CLOSE.SN_
      7047**DCL      7047--REDEF
TAPE_CLOSE.UTL_
      7048**DCL      7048--REDEF
TAPE_CLOSE.V.EXPIRE#
      7062**DCL      7062--REDEF
TAPE_CLOSE.V.TYPE#
      7060**DCL      7060--REDEF
PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:158  
TAPE_CLOSE.V.XTNSIZE#
      7057**DCL      7057--REDEF    7059--REDEF
TAPE_DCBLIST$
      6603**DCL      6603--IMP-PTR
TAPE_OPEN.ACSVEH_
      6912**DCL      6913--REDEF
TAPE_OPEN.ALTKEYS_
      6918**DCL      6919--REDEF    6919--REDEF
TAPE_OPEN.HDR_
      6917**DCL      6918--REDEF
TAPE_OPEN.TAB_
      6916**DCL      6917--REDEF
TAPE_OPEN.UHL_
      6910**DCL      6911--REDEF    6911--REDEF
TAPE_OPEN.V.FSN#
      6950**DCL      6950--REDEF    6950--REDEF
TAPE_OPEN.WSN_
      6916**DCL      6916--REDEF
TAPE_READ.STATION_
      6974**DCL      6975--REDEF
TAPE_READ.V.DVBYTE.REREAD#
      6986**DCL      6986--REDEF
TAPE_READ.V.INDX#
      6984**DCL      6984--REDEF
TAPE_WRITE.STATION_
      7012**DCL      7012--REDEF
TAPE_WRITE.V.DVBYTE.VFC#
      7019**DCL      7019--REDEF
THE_DCB#
      7644**DCL      7983<<ASSIGN   7984<<ASSIGN   8003>>IF       8005<>CALL     8013<>CALL
TOTAL_ERRORS
      7316**DCL      8015<<ASSIGN   8015>>ASSIGN
TVECTOR.W2
      7143**DCL      7144--REDEF
V1_
        13**DCL         6--PROC     7990--IF       7991>>ASSIGN
PL6.E3A0      #002=FLI$RPT_ERR File=FLP$PRINTER.:E05TSI                          TUE 07/29/97 16:18 Page:159  
V2_
        14**DCL         6--PROC     7993--IF       7994>>ASSIGN
V3_
        15**DCL         6--PROC     7996--IF       7997>>ASSIGN
VLR_LINES
      7930**DCL      7888--DCLINIT  7889--DCLINIT  7915--DCLINIT
VLR_LINES.RLINES#
      7930**DCL      8011<<ASSIGN   8011>>ASSIGN
WRITE_EFT_ERRORS
      7887**DCL      8012<>CALL
WRITE_EFT_ERRORS.STATION_
      7889**DCL      7889--REDEF
WRITE_EFT_ERRORS.V
      7890**DCL      7887--DCLINIT
WRITE_EFT_ERRORS.V.DVBYTE.VFC#
      7896**DCL      7896--REDEF
XUR$ERRMSG
      6198**DCL-ENT  8004--CALL     8005--CALL     8013--CALL

PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:160  
      969        1        /*T***********************************************************/
      970        2        /*T*                                                         */
      971        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      972        4        /*T*                                                         */
      973        5        /*T***********************************************************/
      974        6        FLI$ERROR_SUMMARY: PROC( LIST_ERRORS );
      975        7        /*F* NAME: FLI$ERROR_SUMMARY
      976        8             PURPOSE: Summarizes any errors that have occurred.
      977        9        */
      978       10
      979       11    1   DCL LIST_ERRORS BIT(1) ALIGNED;         /* Indicates list error file          */
      980       12
      981       13        /***
      982       14         *** INCLUDE
      983       15         ***/
      984       16
      985       17        %INCLUDE B_ERRORS_C;
      986     1144        %INCLUDE CP_6;
      987     6703        %INCLUDE FLI_DATA_R;
      988     8117
      989     8118        /***
      990     8119         *** ENTRY
      991     8120         ***/
      992     8121
      993     8122    1   DCL FLI$RPT_ERR ENTRY(5);
      994     8123
      995     8124        /***
      996     8125         *** DCB
      997     8126         ***/
      998     8127
      999     8128    1   DCL M$LO DCB;
     1000     8129    1   DCL M$EFT_ERRORS DCB;
     1001     8130
     1002     8131        /***
     1003     8132         *** STATIC
     1004     8133         ***/
     1005     8134
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:161  
     1006     8135    1   DCL M$EFT_ERRORS$ PTR STATIC;
     1007     8136    1   DCL 1 ERROR_LINE STATIC,
     1008     8137    1         2 PAGE CHAR(4),
     1009     8138    1         2 * CHAR(1) INIT(' '),
     1010     8139    1         2 LINE CHAR(4),
     1011     8140    1         2 * CHAR(2) INIT(' '),
     1012     8141    1         2 MESSAGE CHAR(120);
     1013     8142
     1014     8143        /***
     1015     8144         *** AUTO
     1016     8145         ***/
     1017     8146
     1018     8147    1   DCL 1 EFT_ERROR_RECORD AUTO,
     1019     8148    1         2 CHARS CHAR(120),
     1020     8149    1         2 C(0:119) REDEF CHARS CHAR(1) CALIGNED,
     1021     8150    1         2 VLR_LINES REDEF CHARS,
     1022     8151    1           3 RLINES# UBIN HALF HALIGNED,
     1023     8152    1           3 PAGE# UBIN HALF HALIGNED,
     1024     8153    1           3 * UBIN WORD,
     1025     8154    1           3 * CHAR(112);
     1026     8155    1   DCL NBR_BLANKS SBIN AUTO;
     1027     8156
     1028     8157        /***
     1029     8158         *** CONSTANT
     1030     8159         ***/
     1031     8160
     1032     8161    1   DCL BLANK CHAR(1) CONSTANT INIT(' ');
     1033     8162    1   DCL NO_ERRORS CHAR(0) CONSTANT INIT('No errors');
     1034     8163
     1035     8164        /***
     1036     8165         *** BASED
     1037     8166         ***/
     1038     8167
     1039     8168        %B$TCB(STCLASS="BASED(B$TCB$)");
     1040     8171        %B$ALT;
     1041     8179        %F$DCB(BASED="BASED(M$EFT_ERRORS$)");
     1042     8236
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:162  
     1043     8237        /***
     1044     8238         *** FPT
     1045     8239         ***/
     1046     8240
     1047     8241        %FPT_OPEN( FPTN=OPEN_EFT_ERRORS,
     1048     8242                   DCB=M$EFT_ERRORS,
     1049     8243                   FUN=IN,
     1050     8244                   ASN=FILE,
     1051     8245                   NAME=STAR_EFT_ERRORS );
     1052     8354
     1053     8355        %VLP_NAME( FPTN=STAR_EFT_ERRORS,
     1054     8356                   NAME='*EFT_ERRORS' );
     1055     8383
     1056     8384        %FPT_READ( FPTN=READ_EFT_ERRORS,
     1057     8385                   DCB=M$EFT_ERRORS );
     1058     8424
     1059     8425        %FPT_PFIL( FPTN=BOF_EFT_ERRORS,
     1060     8426                   DCB=M$EFT_ERRORS,
     1061     8427                   BOF=YES );
     1062     8442
     1063     8443        %FPT_CLOSE( FPTN=CLOSE_EFT_ERRORS,
     1064     8444                    DCB=M$EFT_ERRORS,
     1065     8445                    DISP=SAVE );
     1066     8487
     1067     8488        %FPT_WRITE( FPTN=WRITE_LO,
     1068     8489                    DCB=M$LO );
     1069     8520
     1070     8521        %FPT_DEVICE( FPTN=PAGE_LO,
     1071     8522                     DCB=M$LO,
     1072     8523                     PAGE=YES,
     1073     8524                     HDR=NO_HDR );
     1074     8542
     1075     8543        %VLP_HDR( FPTN=NO_HDR,
     1076     8544                  COUNT=76,
     1077     8545                  TITLE= ' ' );
     1078     8561
     1079     8562        %FPT_DEVICE( FPTN=PAGE_LO_HDR,
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:163  
     1080     8563                     DCB=M$LO,
     1081     8564                     PAGE=YES,
     1082     8565                     HDR=LO_HEADER );
     1083     8583
     1084     8584        %VLP_HDR( FPTN=LO_HEADER,
     1085     8585                  COUNT=76,
     1086     8586                  TITLE='                         Error Summary' );
     1087     8602
     1088     8603        %VLP_HDR( FPTN=LO_HEADER_2,
     1089     8604                  COUNT=76,
     1090     8605                  TITLE='Page Line  Error Message' );
     1091     8621
     1092     8622        %FPT_DEVICE( FPTN=SET_LO_HEADER_2,
     1093     8623                     DCB=M$LO,
     1094     8624                     HDR=LO_HEADER_2 );
     1095     8642
     1096     8643        %VLR_LINES;
     1097     8657
     1098     8658        /****************************************/
     1099     8659
     1100     8660        /***
     1101     8661         *** If error summary file isn't open, there aren't any errors.
     1102     8662         ***/
     1103     8663
     1104     8664    1      M$EFT_ERRORS$ = DCBADDR(DCBNUM(M$EFT_ERRORS));
     1105     8665    1      IF NOT F$DCB.FCD#
     1106     8666    1       THEN IF ADDR(LIST_ERRORS) = ADDR(NIL)
     1107     8667    1          THEN RETURN;
     1108     8668    2          ELSE DO;
     1109     8669    2            CALL M$OPEN( OPEN_EFT_ERRORS )
     1110     8670    3             WHENALTRETURN DO;
     1111     8671    3               IF B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOFILE
     1112     8672    4                THEN DO;
     1113     8673    4                  WRITE_LO.BUF_ = VECTOR(NO_ERRORS);
     1114     8674    4                  CALL M$WRITE( WRITE_LO ) ALTRET( JUSTXXX );
     1115     8675    4                  END;
     1116     8676    3                ELSE CALL FLI$RPT_ERR;
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:164  
     1117     8677    3               RETURN;
     1118     8678    3               END;
     1119     8679    2            END;
     1120     8680
     1121     8681    1      IF ADDR(LIST_ERRORS) = ADDR(NIL)
     1122     8682    2       THEN DO;
     1123     8683    2         IF DCBADDR(DCBNUM(M$LO))->F$DCB.DDEV.UCOUT#
     1124     8684    2           OR NOT DCBADDR(DCBNUM(M$LO))->F$DCB.DDEV.LP#
     1125     8685    3          THEN DO;          /* No error summary for terminals unless asked for   */
     1126     8686    3            IF F$DCB.FCD#
     1127     8687    3             THEN CALL M$CLOSE( CLOSE_EFT_ERRORS )
     1128     8688    4                WHENALTRETURN DO;
     1129     8689    4                  CALL FLI$RPT_ERR;
     1130     8690    4                  END;
     1131     8691    3            RETURN;
     1132     8692    3            END;
     1133     8693    2         END;
     1134     8694
     1135     8695        /***
     1136     8696         *** Ready error summary file and print page headings.
     1137     8697         ***/
     1138     8698
     1139     8699    1      CALL M$PFIL( BOF_EFT_ERRORS ) ALTRET(JUSTXXX);
     1140     8700    1      CALL M$DEVICE( PAGE_LO_HDR ) ALTRET(JUSTXXX);
     1141     8701    1      WRITE_LO.BUF_ = VECTOR(BLANK);
     1142     8702    1      CALL M$WRITE( WRITE_LO ) ALTRET( JUSTXXX );
     1143     8703
     1144     8704    1      ERROR_LINE.PAGE = 'Page';
     1145     8705    1      ERROR_LINE.LINE = 'Line';
     1146     8706    1      ERROR_LINE.MESSAGE = 'Error Message';
     1147     8707    1      WRITE_LO.BUF_ = VECTOR(ERROR_LINE);
     1148     8708    1      CALL M$WRITE( WRITE_LO ) ALTRET( JUSTXXX );
     1149     8709
     1150     8710    1      CALL M$DEVICE( SET_LO_HEADER_2 ) ALTRET( JUSTXXX );
     1151     8711
     1152     8712    1      READ_EFT_ERRORS.BUF_ = VECTOR(EFT_ERROR_RECORD);
     1153     8713
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:165  
     1154     8714        /***
     1155     8715         *** Format and print summary file.
     1156     8716         ***/
     1157     8717
     1158     8718    2      DO WHILE('1'B);
     1159     8719    2         CALL M$READ( READ_EFT_ERRORS ) ALTRET( CHKERR );
     1160     8720    2         IF F$DCB.ARS# = LENGTHC(VLR_LINES)
     1161     8721    2           AND EFT_ERROR_RECORD.VLR_LINES.PAGE# <= BITBIN('040040'O)
     1162     8722    3          THEN DO;                         /* New VLR_LINES                      */
     1163     8723    3            IF EFT_ERROR_RECORD.VLR_LINES.PAGE# = 0
     1164     8724    4             THEN DO;                 /* Output to terminal or non-UR device     */
     1165     8725    4               ERROR_LINE.PAGE = ' ';
     1166     8726    4               ERROR_LINE.LINE = ' ';
     1167     8727    4               END;
     1168     8728    4             ELSE DO;
     1169     8729    4               CALL BINCHAR( ERROR_LINE.PAGE, EFT_ERROR_RECORD.VLR_LINES.PAGE# );
     1170     8730    4               CALL EDITCHAR( ERROR_LINE.PAGE, , , NO_4_LEADING_ZEROS, ERROR_LINE.PAGE
              8730                        );
     1171     8731    4               CALL BINCHAR( ERROR_LINE.LINE, EFT_ERROR_RECORD.VLR_LINES.RLINES# );
     1172     8732    4               CALL EDITCHAR( ERROR_LINE.LINE, , , NO_4_LEADING_ZEROS, ERROR_LINE.LINE
              8732                        );
     1173     8733    4               END;
     1174     8734    3            END;
     1175     8735    3          ELSE DO;
     1176     8736    3            NBR_BLANKS = 0;
     1177     8737    4            DO WHILE( NBR_BLANKS < F$DCB.ARS# - 1 AND EFT_ERROR_RECORD.C(NBR_BLANKS) =
              8737                     ' ' );
     1178     8738    4               NBR_BLANKS = NBR_BLANKS + 1;
     1179     8739    4               END;
     1180     8740    3            ERROR_LINE.MESSAGE = SUBSTR( EFT_ERROR_RECORD.CHARS, NBR_BLANKS, F$DCB.ARS#
              8740                     - NBR_BLANKS );
     1181     8741    3            WRITE_LO.BUF_.BOUND = LENGTHV(ERROR_LINE) + F$DCB.ARS# - LENGTHC(ERROR_LINE
              8741                     .MESSAGE) - NBR_BLANKS;
     1182     8742    3            CALL M$WRITE( WRITE_LO ) ALTRET( JUSTXXX );
     1183     8743    3            ERROR_LINE.PAGE = ' ';
     1184     8744    3            ERROR_LINE.LINE = ' ';
     1185     8745    3            END;
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:166  
     1186     8746                                                /* format and print                   */
     1187     8747    2         END;
     1188     8748
     1189     8749    1   CHKERR: ;
     1190     8750    1      IF B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$EOF
     1191     8751    2       THEN DO;
     1192     8752    2   JUSTXXX: ;
     1193     8753    2         CALL FLI$RPT_ERR;
     1194     8754    2         CALL M$CLOSE( CLOSE_EFT_ERRORS )
     1195     8755    3          WHENALTRETURN DO;
     1196     8756    3            END;
     1197     8757    2         CALL M$XXX;
     1198     8758    2         END;
     1199     8759    1      CALL M$CLOSE( CLOSE_EFT_ERRORS ) ALTRET( JUSTXXX );
     1200     8760    1      CALL M$DEVICE( PAGE_LO ) ALTRET( JUSTXXX );
     1201     8761    1      RETURN;
     1202     8762
     1203     8763    1   END FLI$ERROR_SUMMARY;

PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:167  
--  Include file information  --

   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure FLI$ERROR_SUMMARY.

   Procedure FLI$ERROR_SUMMARY requires 206 words for executable code.
   Procedure FLI$ERROR_SUMMARY requires 38 words of local(AUTO) storage.

    No errors detected in file FLP$PRINTER.:E05TSI    .

PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:168  

 Object Unit name= FLI$ERROR_SUMMARY                          File name= FLP$PRINTER.:E05TOU
 UTS= JUL 29 '97 16:19:58.08 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$PRE_RET
    2   Data  even  none   216    330  FLI$ERROR_SUMMARY
    3   DCB   even  none     0      0  M$LO
    4   DCB   even  none     0      0  M$EFT_ERRORS
    5  RoData even  UTS     10     12  FLI$ERROR_SUMMARY
    6   Proc  even  none   206    316  FLI$ERROR_SUMMARY
    7  RoData even  none     9     11  FLI$ERROR_SUMMARY

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     6      0   yes            yes      Std        1  FLI$ERROR_SUMMARY

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       5 FLI$RPT_ERR
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:169  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TAPE_DCBLIST$                         SNVECLIST$
     B$TCB$                                DPLIST$                               DPRESLIST$
     DISK_FILE_SPEC$                       SPECCHARS                             EFTWORD
r    NO_4_LEADING_ZEROS                    M$PRE_RET                             RET_CMDS_NAME
     M$LO                                  M$EFT_ERRORS                          B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:170  


      969        1        /*T***********************************************************/
      970        2        /*T*                                                         */
      971        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      972        4        /*T*                                                         */
      973        5        /*T***********************************************************/
      974        6        FLI$ERROR_SUMMARY: PROC( LIST_ERRORS );

      6  6 000000   000000 700200 xent  FLI$ERROR_S* TSX0  ! X66_AUTO_1
         6 000001   000046 000001                    ZERO    38,1

      975        7        /*F* NAME: FLI$ERROR_SUMMARY
      976        8             PURPOSE: Summarizes any errors that have occurred.
      977        9        */
      978       10
      979       11    1   DCL LIST_ERRORS BIT(1) ALIGNED;         /* Indicates list error file          */
      980       12
      981       13        /***
      982       14         *** INCLUDE
      983       15         ***/
      984       16
      985       17        %INCLUDE B_ERRORS_C;
      986     1144        %INCLUDE CP_6;
      987     6703        %INCLUDE FLI_DATA_R;
      988     8117
      989     8118        /***
      990     8119         *** ENTRY
      991     8120         ***/
      992     8121
      993     8122    1   DCL FLI$RPT_ERR ENTRY(5);
      994     8123
      995     8124        /***
      996     8125         *** DCB
      997     8126         ***/
      998     8127
      999     8128    1   DCL M$LO DCB;
     1000     8129    1   DCL M$EFT_ERRORS DCB;
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:171  
     1001     8130
     1002     8131        /***
     1003     8132         *** STATIC
     1004     8133         ***/
     1005     8134
     1006     8135    1   DCL M$EFT_ERRORS$ PTR STATIC;
     1007     8136    1   DCL 1 ERROR_LINE STATIC,
     1008     8137    1         2 PAGE CHAR(4),
     1009     8138    1         2 * CHAR(1) INIT(' '),
     1010     8139    1         2 LINE CHAR(4),
     1011     8140    1         2 * CHAR(2) INIT(' '),
     1012     8141    1         2 MESSAGE CHAR(120);
     1013     8142
     1014     8143        /***
     1015     8144         *** AUTO
     1016     8145         ***/
     1017     8146
     1018     8147    1   DCL 1 EFT_ERROR_RECORD AUTO,
     1019     8148    1         2 CHARS CHAR(120),
     1020     8149    1         2 C(0:119) REDEF CHARS CHAR(1) CALIGNED,
     1021     8150    1         2 VLR_LINES REDEF CHARS,
     1022     8151    1           3 RLINES# UBIN HALF HALIGNED,
     1023     8152    1           3 PAGE# UBIN HALF HALIGNED,
     1024     8153    1           3 * UBIN WORD,
     1025     8154    1           3 * CHAR(112);
     1026     8155    1   DCL NBR_BLANKS SBIN AUTO;
     1027     8156
     1028     8157        /***
     1029     8158         *** CONSTANT
     1030     8159         ***/
     1031     8160
     1032     8161    1   DCL BLANK CHAR(1) CONSTANT INIT(' ');
     1033     8162    1   DCL NO_ERRORS CHAR(0) CONSTANT INIT('No errors');
     1034     8163
     1035     8164        /***
     1036     8165         *** BASED
     1037     8166         ***/
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:172  
     1038     8167
     1039     8168        %B$TCB(STCLASS="BASED(B$TCB$)");
     1040     8171        %B$ALT;
     1041     8179        %F$DCB(BASED="BASED(M$EFT_ERRORS$)");
     1042     8236
     1043     8237        /***
     1044     8238         *** FPT
     1045     8239         ***/
     1046     8240
     1047     8241        %FPT_OPEN( FPTN=OPEN_EFT_ERRORS,
     1048     8242                   DCB=M$EFT_ERRORS,
     1049     8243                   FUN=IN,
     1050     8244                   ASN=FILE,
     1051     8245                   NAME=STAR_EFT_ERRORS );
     1052     8354
     1053     8355        %VLP_NAME( FPTN=STAR_EFT_ERRORS,
     1054     8356                   NAME='*EFT_ERRORS' );
     1055     8383
     1056     8384        %FPT_READ( FPTN=READ_EFT_ERRORS,
     1057     8385                   DCB=M$EFT_ERRORS );
     1058     8424
     1059     8425        %FPT_PFIL( FPTN=BOF_EFT_ERRORS,
     1060     8426                   DCB=M$EFT_ERRORS,
     1061     8427                   BOF=YES );
     1062     8442
     1063     8443        %FPT_CLOSE( FPTN=CLOSE_EFT_ERRORS,
     1064     8444                    DCB=M$EFT_ERRORS,
     1065     8445                    DISP=SAVE );
     1066     8487
     1067     8488        %FPT_WRITE( FPTN=WRITE_LO,
     1068     8489                    DCB=M$LO );
     1069     8520
     1070     8521        %FPT_DEVICE( FPTN=PAGE_LO,
     1071     8522                     DCB=M$LO,
     1072     8523                     PAGE=YES,
     1073     8524                     HDR=NO_HDR );
     1074     8542
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:173  
     1075     8543        %VLP_HDR( FPTN=NO_HDR,
     1076     8544                  COUNT=76,
     1077     8545                  TITLE= ' ' );
     1078     8561
     1079     8562        %FPT_DEVICE( FPTN=PAGE_LO_HDR,
     1080     8563                     DCB=M$LO,
     1081     8564                     PAGE=YES,
     1082     8565                     HDR=LO_HEADER );
     1083     8583
     1084     8584        %VLP_HDR( FPTN=LO_HEADER,
     1085     8585                  COUNT=76,
     1086     8586                  TITLE='                         Error Summary' );
     1087     8602
     1088     8603        %VLP_HDR( FPTN=LO_HEADER_2,
     1089     8604                  COUNT=76,
     1090     8605                  TITLE='Page Line  Error Message' );
     1091     8621
     1092     8622        %FPT_DEVICE( FPTN=SET_LO_HEADER_2,
     1093     8623                     DCB=M$LO,
     1094     8624                     HDR=LO_HEADER_2 );
     1095     8642
     1096     8643        %VLR_LINES;
     1097     8657
     1098     8658        /****************************************/
     1099     8659
     1100     8660        /***
     1101     8661         *** If error summary file isn't open, there aren't any errors.
     1102     8662         ***/
     1103     8663
     1104     8664    1      M$EFT_ERRORS$ = DCBADDR(DCBNUM(M$EFT_ERRORS));

   8664  6 000002   000000 236007 xsym               LDQ     M$EFT_ERRORS,DL
         6 000003   000000 470400 7                  LDP0    0
         6 000004   000000 471500                    LDP1    0,,PR0
         6 000005   100000 236106                    LDQ     0,QL,PR1
         6 000006   000006 756000 2                  STQ     M$EFT_ERRORS$

PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:174  
     1105     8665    1      IF NOT F$DCB.FCD#

   8665  6 000007   000006 473400 2                  LDP3    M$EFT_ERRORS$
         6 000010   300031 236100                    LDQ     25,,PR3
         6 000011   020000 316007                    CANQ    8192,DL
         6 000012   000045 601000 6                  TNZ     s:8681

     1106     8666    1       THEN IF ADDR(LIST_ERRORS) = ADDR(NIL)

   8666  6 000013   200003 236100                    LDQ     @LIST_ERRORS,,AUTO
         6 000014   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 000015   000017 601000 6                  TNZ     s:8669

     1107     8667    1          THEN RETURN;

   8667  6 000016   000000 702200 xent               TSX2  ! X66_ARET

     1108     8668    2          ELSE DO;

     1109     8669    2            CALL M$OPEN( OPEN_EFT_ERRORS )

   8669  6 000017   000050 630400 2                  EPPR0   OPEN_EFT_ERRORS
         6 000020   450000 713400                    CLIMB   alt,open
         6 000021   410400 401760                    pmme    nvectors=18
         6 000022   000024 702000 6                  TSX2    s:8671
         6 000023   000045 710000 6                  TRA     s:8681

     1110     8670    3             WHENALTRETURN DO;

     1111     8671    3               IF B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOFILE

   8671  6 000024   000000 470400 xsym               LDP0    B$TCB$
         6 000025   000000 471500                    LDP1    0,,PR0
         6 000026   100102 236100                    LDQ     66,,PR1
         6 000027   377770 376007                    ANQ     131064,DL
         6 000030   001610 116007                    CMPQ    904,DL
         6 000031   000041 601000 6                  TNZ     s:8676
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:175  

     1112     8672    4                THEN DO;

     1113     8673    4                  WRITE_LO.BUF_ = VECTOR(NO_ERRORS);

   8673  6 000032   000002 237000 7                  LDAQ    2
         6 000033   000232 757000 2                  STAQ    WRITE_LO+4

     1114     8674    4                  CALL M$WRITE( WRITE_LO ) ALTRET( JUSTXXX );

   8674  6 000034   000226 630400 2                  EPPR0   WRITE_LO
         6 000035   440001 713400                    CLIMB   alt,write
         6 000036   401400 401760                    pmme    nvectors=4
         6 000037   000273 702000 6                  TSX2    JUSTXXX

     1115     8675    4                  END;

   8675  6 000040   000044 710000 6                  TRA     s:8677

     1116     8676    3                ELSE CALL FLI$RPT_ERR;

   8676  6 000041   000002 631400 xsym               EPPR1   B_VECTNIL+2
         6 000042   000000 701000 xent               TSX1    FLI$RPT_ERR
         6 000043   000000 011000                    NOP     0

     1117     8677    3               RETURN;

   8677  6 000044   000000 702200 xent               TSX2  ! X66_ARET

     1118     8678    3               END;
     1119     8679    2            END;

     1120     8680
     1121     8681    1      IF ADDR(LIST_ERRORS) = ADDR(NIL)

   8681  6 000045   200003 236100                    LDQ     @LIST_ERRORS,,AUTO
         6 000046   000001 116000 xsym               CMPQ    B_VECTNIL+1
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:176  
         6 000047   000101 601000 6                  TNZ     s:8699

     1122     8682    2       THEN DO;

     1123     8683    2         IF DCBADDR(DCBNUM(M$LO))->F$DCB.DDEV.UCOUT#

   8683  6 000050   000000 236007 xsym               LDQ     M$LO,DL
         6 000051   000000 470400 7                  LDP0    0
         6 000052   000000 471500                    LDP1    0,,PR0
         6 000053   100000 473506                    LDP3    0,QL,PR1
         6 000054   300004 236100                    LDQ     4,,PR3
         6 000055   020000 316007                    CANQ    8192,DL
         6 000056   000064 601000 6                  TNZ     s:8686
         6 000057   000000 236007 xsym               LDQ     M$LO,DL
         6 000060   100000 473506                    LDP3    0,QL,PR1
         6 000061   300004 236100                    LDQ     4,,PR3
         6 000062   400000 316007                    CANQ    -131072,DL
         6 000063   000101 601000 6                  TNZ     s:8699

     1124     8684    2           OR NOT DCBADDR(DCBNUM(M$LO))->F$DCB.DDEV.LP#
     1125     8685    3          THEN DO;          /* No error summary for terminals unless asked for   */

     1126     8686    3            IF F$DCB.FCD#

   8686  6 000064   000006 473400 2                  LDP3    M$EFT_ERRORS$
         6 000065   300031 236100                    LDQ     25,,PR3
         6 000066   020000 316007                    CANQ    8192,DL
         6 000067   000100 600000 6                  TZE     s:8691

     1127     8687    3             THEN CALL M$CLOSE( CLOSE_EFT_ERRORS )

   8687  6 000070   000170 630400 2                  EPPR0   CLOSE_EFT_ERRORS
         6 000071   450001 713400                    CLIMB   alt,close
         6 000072   406000 401760                    pmme    nvectors=13
         6 000073   000075 702000 6                  TSX2    s:8689
         6 000074   000100 710000 6                  TRA     s:8691

PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:177  
     1128     8688    4                WHENALTRETURN DO;

     1129     8689    4                  CALL FLI$RPT_ERR;

   8689  6 000075   000002 631400 xsym               EPPR1   B_VECTNIL+2
         6 000076   000000 701000 xent               TSX1    FLI$RPT_ERR
         6 000077   000000 011000                    NOP     0

     1130     8690    4                  END;

     1131     8691    3            RETURN;

   8691  6 000100   000000 702200 xent               TSX2  ! X66_ARET

     1132     8692    3            END;
     1133     8693    2         END;
     1134     8694
     1135     8695        /***
     1136     8696         *** Ready error summary file and print page headings.
     1137     8697         ***/
     1138     8698
     1139     8699    1      CALL M$PFIL( BOF_EFT_ERRORS ) ALTRET(JUSTXXX);

   8699  6 000101   000164 630400 2                  EPPR0   BOF_EFT_ERRORS
         6 000102   440004 713400                    CLIMB   alt,+16388
         6 000103   400000 401760                    pmme    nvectors=1
         6 000104   000273 702000 6                  TSX2    JUSTXXX

     1140     8700    1      CALL M$DEVICE( PAGE_LO_HDR ) ALTRET(JUSTXXX);

   8700  6 000105   000256 630400 2                  EPPR0   PAGE_LO_HDR
         6 000106   450006 713400                    CLIMB   alt,+20486
         6 000107   401000 401760                    pmme    nvectors=3
         6 000110   000273 702000 6                  TSX2    JUSTXXX

     1141     8701    1      WRITE_LO.BUF_ = VECTOR(BLANK);

PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:178  
   8701  6 000111   000004 237000 7                  LDAQ    4
         6 000112   000232 757000 2                  STAQ    WRITE_LO+4

     1142     8702    1      CALL M$WRITE( WRITE_LO ) ALTRET( JUSTXXX );

   8702  6 000113   000226 630400 2                  EPPR0   WRITE_LO
         6 000114   440001 713400                    CLIMB   alt,write
         6 000115   401400 401760                    pmme    nvectors=4
         6 000116   000273 702000 6                  TSX2    JUSTXXX

     1143     8703
     1144     8704    1      ERROR_LINE.PAGE = 'Page';

   8704  6 000117   000004 236000 5                  LDQ     NO_ERRORS+3
         6 000120   000007 756000 2                  STQ     ERROR_LINE

     1145     8705    1      ERROR_LINE.LINE = 'Line';

   8705  6 000121   040000 100400                    MLR     fill='040'O
         6 000122   000005 000004 5                  ADSC9   NO_ERRORS+4              cn=0,n=4
         6 000123   000010 200004 2                  ADSC9   ERROR_LINE+1             cn=1,n=4

     1146     8706    1      ERROR_LINE.MESSAGE = 'Error Message';

   8706  6 000124   040000 100400                    MLR     fill='040'O
         6 000125   000006 000015 5                  ADSC9   NO_ERRORS+5              cn=0,n=13
         6 000126   000011 600170 2                  ADSC9   ERROR_LINE+2             cn=3,n=120

     1147     8707    1      WRITE_LO.BUF_ = VECTOR(ERROR_LINE);

   8707  6 000127   000006 237000 7                  LDAQ    6
         6 000130   000232 757000 2                  STAQ    WRITE_LO+4

     1148     8708    1      CALL M$WRITE( WRITE_LO ) ALTRET( JUSTXXX );

   8708  6 000131   000226 630400 2                  EPPR0   WRITE_LO
         6 000132   440001 713400                    CLIMB   alt,write
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:179  
         6 000133   401400 401760                    pmme    nvectors=4
         6 000134   000273 702000 6                  TSX2    JUSTXXX

     1149     8709
     1150     8710    1      CALL M$DEVICE( SET_LO_HEADER_2 ) ALTRET( JUSTXXX );

   8710  6 000135   000314 630400 2                  EPPR0   SET_LO_HEADER_2
         6 000136   450006 713400                    CLIMB   alt,+20486
         6 000137   401000 401760                    pmme    nvectors=3
         6 000140   000273 702000 6                  TSX2    JUSTXXX

     1151     8711
     1152     8712    1      READ_EFT_ERRORS.BUF_ = VECTOR(EFT_ERROR_RECORD);

   8712  6 000141   000010 235000 7                  LDA     8
         6 000142   200044 452500                    STP2    NBR_BLANKS+2,,AUTO
         6 000143   200044 236100                    LDQ     NBR_BLANKS+2,,AUTO
         6 000144   000004 036003                    ADLQ    4,DU
         6 000145   000152 757000 2                  STAQ    READ_EFT_ERRORS+4

     1153     8713
     1154     8714        /***
     1155     8715         *** Format and print summary file.
     1156     8716         ***/
     1157     8717
     1158     8718    2      DO WHILE('1'B);

     1159     8719    2         CALL M$READ( READ_EFT_ERRORS ) ALTRET( CHKERR );

   8719  6 000146   000146 630400 2                  EPPR0   READ_EFT_ERRORS
         6 000147   440000 713400                    CLIMB   alt,read
         6 000150   401400 401760                    pmme    nvectors=4
         6 000151   000265 702000 6                  TSX2    CHKERR

     1160     8720    2         IF F$DCB.ARS# = LENGTHC(VLR_LINES)

   8720  6 000152   000006 470400 2                  LDP0    M$EFT_ERRORS$
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:180  
         6 000153   000000 235100                    LDA     0,,PR0
         6 000154   000010 115007                    CMPA    8,DL
         6 000155   000220 601000 6                  TNZ     s:8736
         6 000156   200004 720100                    LXL0    EFT_ERROR_RECORD,,AUTO
         6 000157   040041 100003                    CMPX0   16417,DU
         6 000160   000220 603000 6                  TRC     s:8736

     1161     8721    2           AND EFT_ERROR_RECORD.VLR_LINES.PAGE# <= BITBIN('040040'O)
     1162     8722    3          THEN DO;                         /* New VLR_LINES                      */

     1163     8723    3            IF EFT_ERROR_RECORD.VLR_LINES.PAGE# = 0

   8723  6 000161   000000 100003                    CMPX0   0,DU
         6 000162   000171 601000 6                  TNZ     s:8729

     1164     8724    4             THEN DO;                 /* Output to terminal or non-UR device     */

     1165     8725    4               ERROR_LINE.PAGE = ' ';

   8725  6 000163   000035 236000 xsym               LDQ     B_VECTNIL+29
         6 000164   000007 756000 2                  STQ     ERROR_LINE

     1166     8726    4               ERROR_LINE.LINE = ' ';

   8726  6 000165   040000 100400                    MLR     fill='040'O
         6 000166   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000167   000010 200004 2                  ADSC9   ERROR_LINE+1             cn=1,n=4

     1167     8727    4               END;

   8727  6 000170   000146 710000 6                  TRA     s:8719

     1168     8728    4             ELSE DO;

     1169     8729    4               CALL BINCHAR( ERROR_LINE.PAGE, EFT_ERROR_RECORD.VLR_LINES.PAGE# );

   8729  6 000171   200004 236100                    LDQ     EFT_ERROR_RECORD,,AUTO
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:181  
         6 000172   777777 376007                    ANQ     -1,DL
         6 000173   000000 235003                    LDA     0,DU
         6 000174   200044 757100                    STAQ    NBR_BLANKS+2,,AUTO
         6 000175   000000 301500                    BTD
         6 000176   200044 000010                    NDSC9   NBR_BLANKS+2,,AUTO       cn=0,s=lsgnf,sf=0,n=8
         6 000177   000007 030004 2                  NDSC9   ERROR_LINE               cn=0,s=nosgn,sf=0,n=4

     1170     8730    4               CALL EDITCHAR( ERROR_LINE.PAGE, , , NO_4_LEADING_ZEROS, ERROR_LINE.PAGE
              8730                        );

   8730  6 000200   000000 024400                    MVNE
         6 000201   000007 030004 2                  NDSC9   ERROR_LINE               cn=0,s=nosgn,sf=0,n=4
         6 000202   000000 000003 xsym               ADSC9   NO_4_LEADING_ZEROS       cn=0,n=3
         6 000203   000007 000004 2                  ADSC9   ERROR_LINE               cn=0,n=4

     1171     8731    4               CALL BINCHAR( ERROR_LINE.LINE, EFT_ERROR_RECORD.VLR_LINES.RLINES# );

   8731  6 000204   200004 236100                    LDQ     EFT_ERROR_RECORD,,AUTO
         6 000205   000022 772000                    QRL     18
         6 000206   000000 235003                    LDA     0,DU
         6 000207   200044 757100                    STAQ    NBR_BLANKS+2,,AUTO
         6 000210   000000 301500                    BTD
         6 000211   200044 000010                    NDSC9   NBR_BLANKS+2,,AUTO       cn=0,s=lsgnf,sf=0,n=8
         6 000212   000010 230004 2                  NDSC9   ERROR_LINE+1             cn=1,s=nosgn,sf=0,n=4

     1172     8732    4               CALL EDITCHAR( ERROR_LINE.LINE, , , NO_4_LEADING_ZEROS, ERROR_LINE.LINE
              8732                        );

   8732  6 000213   000000 024400                    MVNE
         6 000214   000010 230004 2                  NDSC9   ERROR_LINE+1             cn=1,s=nosgn,sf=0,n=4
         6 000215   000000 000003 xsym               ADSC9   NO_4_LEADING_ZEROS       cn=0,n=3
         6 000216   000010 200004 2                  ADSC9   ERROR_LINE+1             cn=1,n=4

     1173     8733    4               END;

     1174     8734    3            END;

PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:182  
   8734  6 000217   000146 710000 6                  TRA     s:8719

     1175     8735    3          ELSE DO;

     1176     8736    3            NBR_BLANKS = 0;

   8736  6 000220   200042 450100                    STZ     NBR_BLANKS,,AUTO

     1177     8737    4            DO WHILE( NBR_BLANKS < F$DCB.ARS# - 1 AND EFT_ERROR_RECORD.C(NBR_BLANKS) =
              8737                     ' ' );

   8737  6 000221   000223 710000 6                  TRA     s:8739

     1178     8738    4               NBR_BLANKS = NBR_BLANKS + 1;

   8738  6 000222   200042 054100                    AOS     NBR_BLANKS,,AUTO

     1179     8739    4               END;

   8739  6 000223   000006 470400 2                  LDP0    M$EFT_ERRORS$
         6 000224   000000 236100                    LDQ     0,,PR0
         6 000225   000001 136007                    SBLQ    1,DL
         6 000226   200042 116100                    CMPQ    NBR_BLANKS,,AUTO
         6 000227   000235 604400 6                  TMOZ    s:8740
         6 000230   200042 235100                    LDA     NBR_BLANKS,,AUTO
         6 000231   040000 106505                    CMPC    fill='040'O
         6 000232   200004 000001                    ADSC9   EFT_ERROR_RECORD,A,AUTO  cn=0,n=1
         6 000233   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000234   000222 600000 6                  TZE     s:8738

     1180     8740    3           ERROR_LINE.MESSAGE = SUBSTR( EFT_ERROR_RECORD.CHARS, NBR_BLANKS, F$DCB.ARS#
              8740                     - NBR_BLANKS );

   8740  6 000235   000000 236100                    LDQ     0,,PR0
         6 000236   200042 136100                    SBLQ    NBR_BLANKS,,AUTO
         6 000237   000000 620006                    EAX0    0,QL
         6 000240   200042 235100                    LDA     NBR_BLANKS,,AUTO
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:183  
         6 000241   040000 100545                    MLR     fill='040'O
         6 000242   200004 000010                    ADSC9   EFT_ERROR_RECORD,A,AUTO  cn=0,n=*X0
         6 000243   000011 600170 2                  ADSC9   ERROR_LINE+2             cn=3,n=120

     1181     8741    3           WRITE_LO.BUF_.BOUND = LENGTHV(ERROR_LINE) + F$DCB.ARS# - LENGTHC(ERROR_LINE
              8741                     .MESSAGE) - NBR_BLANKS;

   8741  6 000244   000000 236100                    LDQ     0,,PR0
         6 000245   200042 136100                    SBLQ    NBR_BLANKS,,AUTO
         6 000246   000012 036007                    ADLQ    10,DL
         6 000247   000020 736000                    QLS     16
         6 000250   000232 676000 2                  ERQ     WRITE_LO+4
         6 000251   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 000252   000232 656000 2                  ERSQ    WRITE_LO+4

     1182     8742    3            CALL M$WRITE( WRITE_LO ) ALTRET( JUSTXXX );

   8742  6 000253   000226 630400 2                  EPPR0   WRITE_LO
         6 000254   440001 713400                    CLIMB   alt,write
         6 000255   401400 401760                    pmme    nvectors=4
         6 000256   000273 702000 6                  TSX2    JUSTXXX

     1183     8743    3            ERROR_LINE.PAGE = ' ';

   8743  6 000257   000035 236000 xsym               LDQ     B_VECTNIL+29
         6 000260   000007 756000 2                  STQ     ERROR_LINE

     1184     8744    3            ERROR_LINE.LINE = ' ';

   8744  6 000261   040000 100400                    MLR     fill='040'O
         6 000262   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000263   000010 200004 2                  ADSC9   ERROR_LINE+1             cn=1,n=4

     1185     8745    3            END;

     1186     8746                                                /* format and print                   */
     1187     8747    2         END;
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:184  

   8747  6 000264   000146 710000 6                  TRA     s:8719

   8742  6 000265                       CHKERR       null
     1188     8748
     1189     8749    1   CHKERR: ;
     1190     8750    1      IF B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$EOF

   8750  6 000265   000000 470400 xsym               LDP0    B$TCB$
         6 000266   000000 471500                    LDP1    0,,PR0
         6 000267   100102 236100                    LDQ     66,,PR1
         6 000270   377770 376007                    ANQ     131064,DL
         6 000271   000060 116007                    CMPQ    48,DL
         6 000272   000305 600000 6                  TZE     s:8759

     1191     8751    2       THEN DO;

   8750  6 000273                       JUSTXXX      null
     1192     8752    2   JUSTXXX: ;
     1193     8753    2         CALL FLI$RPT_ERR;

   8753  6 000273   000002 631400 xsym               EPPR1   B_VECTNIL+2
         6 000274   000000 701000 xent               TSX1    FLI$RPT_ERR
         6 000275   000000 011000                    NOP     0

     1194     8754    2         CALL M$CLOSE( CLOSE_EFT_ERRORS )

   8754  6 000276   000170 630400 2                  EPPR0   CLOSE_EFT_ERRORS
         6 000277   450001 713400                    CLIMB   alt,close
         6 000300   406000 401760                    pmme    nvectors=13
         6 000301   000303 702000 6                  TSX2    s:8757
         6 000302   000303 710000 6                  TRA     s:8757

     1195     8755    3          WHENALTRETURN DO;

     1196     8756    3            END;

PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:185  
     1197     8757    2         CALL M$XXX;

   8757  6 000303   000003 713400                    CLIMB   3
         6 000304   000000 401760                    pmme    nvectors=0

     1198     8758    2         END;

     1199     8759    1      CALL M$CLOSE( CLOSE_EFT_ERRORS ) ALTRET( JUSTXXX );

   8759  6 000305   000170 630400 2                  EPPR0   CLOSE_EFT_ERRORS
         6 000306   450001 713400                    CLIMB   alt,close
         6 000307   406000 401760                    pmme    nvectors=13
         6 000310   000273 702000 6                  TSX2    JUSTXXX

     1200     8760    1      CALL M$DEVICE( PAGE_LO ) ALTRET( JUSTXXX );

   8760  6 000311   000242 630400 2                  EPPR0   PAGE_LO
         6 000312   450006 713400                    CLIMB   alt,+20486
         6 000313   401000 401760                    pmme    nvectors=3
         6 000314   000273 702000 6                  TSX2    JUSTXXX

     1201     8761    1      RETURN;

   8761  6 000315   000000 702200 xent               TSX2  ! X66_ARET
     1202     8762
     1203     8763    1   END FLI$ERROR_SUMMARY;

PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:186  
--  Include file information  --

   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure FLI$ERROR_SUMMARY.
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:187  

 **** Variables and constants ****

  ****  Section 002  Data  FLI$ERROR_SUMMARY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   164-0-0/d STRC(144)   r     1 BOF_EFT_ERRORS           170-0-0/d STRC(1080)  r     1 CLOSE_EFT_ERRORS
     7-0-0/c STRC(1179)  r     1 ERROR_LINE               270-0-0/w STRC(387)   r     1 LO_HEADER
   303-0-0/w STRC(261)   r     1 LO_HEADER_2                6-0-0/w PTR         r     1 M$EFT_ERRORS$
   254-0-0/w STRC(54)    r     1 NO_HDR                    50-0-0/d STRC(2088)  r     1 OPEN_EFT_ERRORS
   242-0-0/d STRC(360)   r     1 PAGE_LO                  256-0-0/d STRC(360)   r     1 PAGE_LO_HDR
   146-0-0/d STRC(504)   r     1 READ_EFT_ERRORS          314-0-0/d STRC(360)   r     1 SET_LO_HEADER_2
   142-0-0/c STRC(108)   r     1 STAR_EFT_ERRORS          326-0-0/d STRC(72)    r     1 VLR_LINES
   226-0-0/d STRC(432)   r     1 WRITE_LO

  ****  Section 005 RoData FLI$ERROR_SUMMARY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 BLANK                      1-0-0/c CHAR(9)     r     1 NO_ERRORS

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @LIST_ERRORS               4-0-0/w STRC(1080)  r     1 EFT_ERROR_RECORD
    *0-0-0/w BIT         r     1 LIST_ERRORS               42-0-0/w SBIN        r     1 NBR_BLANKS

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w PTR         r     1 DISK_FILE_SPEC$
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:188  
     0-0-0/w PTR         r     1 DPLIST$                    0-0-0/w PTR         r     1 DPRESLIST$
     0-0-0/c BIT (9)     r     1 NO_4_LEADING_ZEROS(0:2)
     0-0-0/c ASTR(9)     r     1 RET_CMDS_NAME              0-0-0/w PTR         r     1 SNVECLIST$
     0-0-0/w PTR         r     1 TAPE_DCBLIST$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$EFT_ERRORS
     0-0-0N  NULL        r     1 M$LO


   Procedure FLI$ERROR_SUMMARY requires 206 words for executable code.
   Procedure FLI$ERROR_SUMMARY requires 38 words of local(AUTO) storage.

    No errors detected in file FLP$PRINTER.:E05TSI    .
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:189  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:190  
          MINI XREF LISTING

B$ALT.CODE
      8173**DCL      8173--REDEF    8174--REDEF    8174--REDEF
B$ALT.ERR.CODE
      8175**DCL      8671>>IF       8750>>IF
B$ALT.ERR.ERR#
      8175**DCL      8175--REDEF
B$ALT.EVID
      8174**DCL      8174--REDEF    8174--REDEF
B$TCB.ALT$
      8169**DCL      8671>>IF       8750>>IF
B$TCB$
      7634**DCL      8169--IMP-PTR  8671>>IF       8750>>IF
BLANK
      8161**DCL      8701--ASSIGN
BOF_EFT_ERRORS
      8438**DCL      8699<>CALL
BOF_EFT_ERRORS.V
      8438**DCL      8438--DCLINIT
CHKERR
      8742**LABEL    8719--CALLALT
CLOSE_EFT_ERRORS
      8468**DCL      8687<>CALL     8754<>CALL     8759<>CALL
CLOSE_EFT_ERRORS.SN_
      8468**DCL      8468--REDEF
CLOSE_EFT_ERRORS.UTL_
      8469**DCL      8469--REDEF
CLOSE_EFT_ERRORS.V
      8473**DCL      8468--DCLINIT
CLOSE_EFT_ERRORS.V.EXPIRE#
      8483**DCL      8483--REDEF
CLOSE_EFT_ERRORS.V.TYPE#
      8481**DCL      8481--REDEF
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:191  
CLOSE_EFT_ERRORS.V.XTNSIZE#
      8478**DCL      8478--REDEF    8480--REDEF
DISK_CLOSE.SN_
      7314**DCL      7314--REDEF
DISK_CLOSE.UTL_
      7315**DCL      7315--REDEF
DISK_CLOSE.V.EXPIRE#
      7329**DCL      7329--REDEF
DISK_CLOSE.V.TYPE#
      7327**DCL      7327--REDEF
DISK_CLOSE.V.XTNSIZE#
      7324**DCL      7324--REDEF    7326--REDEF
DISK_FILE_SPEC.SPEC
      7679**DCL      7681--REDEF
DISK_FILE_SPEC.SPEC.START
      7680**DCL      7680--REDEF
DISK_FILE_SPEC.SPEC.STOP
      7681**DCL      7681--REDEF
DISK_FILE_SPEC$
      7678**DCL      7679--IMP-PTR
DISK_OPEN.ACSVEH_
      7179**DCL      7180--REDEF
DISK_OPEN.ALTKEYS_
      7185**DCL      7186--REDEF    7186--REDEF
DISK_OPEN.HDR_
      7184**DCL      7185--REDEF
DISK_OPEN.TAB_
      7183**DCL      7184--REDEF
DISK_OPEN.UHL_
      7177**DCL      7178--REDEF    7178--REDEF
DISK_OPEN.V.FSN#
      7217**DCL      7217--REDEF    7217--REDEF
DISK_OPEN.WSN_
      7183**DCL      7183--REDEF
DISK_READ.STATION_
      7241**DCL      7242--REDEF
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:192  
DISK_READ.V.DVBYTE.REREAD#
      7253**DCL      7253--REDEF
DISK_READ.V.INDX#
      7251**DCL      7251--REDEF
DISK_WRITE.STATION_
      7279**DCL      7279--REDEF
DISK_WRITE.V.DVBYTE.VFC#
      7286**DCL      7286--REDEF
DPLIST$
      7664**DCL      7676--IMP-PTR
DPRESLIST$
      7678**DCL      7678--IMP-PTR
EFTWORD
      7799**DCL      7799--REDEF
EFT_ERROR_RECORD
      8147**DCL      8712--ASSIGN
EFT_ERROR_RECORD.C
      8149**DCL      8737>>DOWHILE
EFT_ERROR_RECORD.CHARS
      8148**DCL      8149--REDEF    8150--REDEF    8740>>ASSIGN
EFT_ERROR_RECORD.VLR_LINES.PAGE#
      8152**DCL      8720>>IF       8723>>IF       8729>>CALLBLT
EFT_ERROR_RECORD.VLR_LINES.RLINES#
      8151**DCL      8731>>CALLBLT
ERROR_LINE
      8136**DCL      8707--ASSIGN   8741--ASSIGN
ERROR_LINE.LINE
      8139**DCL      8705<<ASSIGN   8726<<ASSIGN   8731<<CALLBLT  8732<<CALLBLT  8732>>CALLBLT  8744<<ASSIGN
ERROR_LINE.MESSAGE
      8141**DCL      8706<<ASSIGN   8740<<ASSIGN   8741--ASSIGN
ERROR_LINE.PAGE
      8137**DCL      8704<<ASSIGN   8725<<ASSIGN   8729<<CALLBLT  8730<<CALLBLT  8730>>CALLBLT  8743<<ASSIGN
F$DCB.ACTPOS
      8212**DCL      8212--REDEF
F$DCB.ARS#
      8186**DCL      8186--REDEF    8720>>IF       8737>>DOWHILE  8740>>ASSIGN   8741>>ASSIGN
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:193  
F$DCB.ATTR
      8205**DCL      8206--REDEF
F$DCB.BORROW
      8220**DCL      8220--REDEF    8220--REDEF    8220--REDEF
F$DCB.DCBNAME.L
      8234**DCL      8234--IMP-SIZ
F$DCB.DDEV.LP#
      8192**DCL      8683>>IF
F$DCB.DDEV.UCOUT#
      8193**DCL      8683>>IF
F$DCB.EOMCHAR#
      8190**DCL      8190--REDEF
F$DCB.FCD#
      8199**DCL      8665>>IF       8686>>IF
F$DCB.FLDID
      8215**DCL      8215--REDEF
F$DCB.FORM$
      8209**DCL      8209--REDEF
F$DCB.FSECT
      8225**DCL      8225--REDEF
F$DCB.FSN#
      8202**DCL      8202--REDEF    8202--REDEF    8203--REDEF
F$DCB.HEADER$
      8208**DCL      8208--REDEF
F$DCB.IXTNSIZE#
      8206**DCL      8206--REDEF
F$DCB.LASTSTA$
      8195**DCL      8195--REDEF
F$DCB.LVL
      8221**DCL      8221--REDEF
F$DCB.NAME#.C
      8196**DCL      8196--REDEF
F$DCB.NOEOF
      8218**DCL      8218--REDEF
F$DCB.NRECS#
      8207**DCL      8207--REDEF
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:194  
F$DCB.NRECX
      8226**DCL      8226--REDEF
F$DCB.OHDR
      8218**DCL      8218--REDEF
F$DCB.ORG#
      8201**DCL      8201--REDEF
F$DCB.PRECNO
      8224**DCL      8224--REDEF
F$DCB.RCSZ
      8230**DCL      8230--REDEF
F$DCB.RES#
      8197**DCL      8197--REDEF
F$DCB.SETX
      8209**DCL      8209--REDEF
F$DCB.TAB$
      8209**DCL      8209--REDEF
F$DCB.TDA
      8223**DCL      8224--REDEF
F$DCB.WSN#
      8197**DCL      8197--REDEF
FLI$RPT_ERR
      8122**DCL-ENT  8676--CALL     8689--CALL     8753--CALL
FPT_EXIT.V.STEPCC#
      7104**DCL      7104--REDEF
JUSTXXX
      8750**LABEL    8674--CALLALT  8699--CALLALT  8700--CALLALT  8702--CALLALT  8708--CALLALT  8710--CALLALT
      8742--CALLALT  8759--CALLALT  8760--CALLALT
LIST_ERRORS
        11**DCL         6--PROC     8666--IF       8681--IF
LO_HEADER
      8597**DCL      8577--DCLINIT
LO_HEADER_2
      8616**DCL      8636--DCLINIT
M$CLOSE
      6631**DCL-ENT  8687--CALL     8754--CALL     8759--CALL
M$DEVICE
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:195  
      6635**DCL-ENT  8700--CALL     8710--CALL     8760--CALL
M$EFT_ERRORS
      8129**DCL      8664--ASSIGN
M$EFT_ERRORS$
      8135**DCL      8180--IMP-PTR  8664<<ASSIGN   8665>>IF       8686>>IF       8720>>IF       8737>>DOWHILE
      8740>>ASSIGN   8741>>ASSIGN
M$LO
      8128**DCL      8683--IF       8683--IF
M$OPEN
      6631**DCL-ENT  8669--CALL
M$PFIL
      6633**DCL-ENT  8699--CALL
M$READ
      6632**DCL-ENT  8719--CALL
M$WRITE
      6632**DCL-ENT  8674--CALL     8702--CALL     8708--CALL     8742--CALL
M$XXX
      6643**DCL-ENT  8757--CALL
NBR_BLANKS
      8155**DCL      8736<<ASSIGN   8737>>DOWHILE  8737>>DOWHILE  8738<<ASSIGN   8738>>ASSIGN   8740>>ASSIGN
      8740>>ASSIGN   8741>>ASSIGN
NO_4_LEADING_ZEROS
      7808**DCL      8730>>CALLBLT  8732>>CALLBLT
NO_ERRORS
      8162**DCL      8673--ASSIGN
NO_HDR
      8556**DCL      8536--DCLINIT
OPEN_EFT_ERRORS
      8310**DCL      8669<>CALL
OPEN_EFT_ERRORS.ACSVEH_
      8312**DCL      8313--REDEF
OPEN_EFT_ERRORS.ALTKEYS_
      8318**DCL      8319--REDEF    8319--REDEF
OPEN_EFT_ERRORS.HDR_
      8317**DCL      8318--REDEF
OPEN_EFT_ERRORS.TAB_
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:196  
      8316**DCL      8317--REDEF
OPEN_EFT_ERRORS.UHL_
      8310**DCL      8311--REDEF    8311--REDEF
OPEN_EFT_ERRORS.V
      8319**DCL      8310--DCLINIT
OPEN_EFT_ERRORS.V.FSN#
      8350**DCL      8350--REDEF    8350--REDEF
OPEN_EFT_ERRORS.WSN_
      8316**DCL      8316--REDEF
PAGE_LO
      8535**DCL      8760<>CALL
PAGE_LO.V
      8536**DCL      8535--DCLINIT
PAGE_LO_HDR
      8576**DCL      8700<>CALL
PAGE_LO_HDR.V
      8577**DCL      8576--DCLINIT
PRE_RET_CLOSE.SN_
      8042**DCL      8042--REDEF
PRE_RET_CLOSE.UTL_
      8043**DCL      8043--REDEF
PRE_RET_CLOSE.V.EXPIRE#
      8057**DCL      8057--REDEF
PRE_RET_CLOSE.V.TYPE#
      8055**DCL      8055--REDEF
PRE_RET_CLOSE.V.XTNSIZE#
      8052**DCL      8052--REDEF    8054--REDEF
PRE_RET_OPEN.ACSVEH_
      7977**DCL      7978--REDEF
PRE_RET_OPEN.ALTKEYS_
      7983**DCL      7984--REDEF    7984--REDEF
PRE_RET_OPEN.HDR_
      7982**DCL      7983--REDEF
PRE_RET_OPEN.TAB_
      7981**DCL      7982--REDEF
PRE_RET_OPEN.UHL_
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:197  
      7975**DCL      7976--REDEF    7976--REDEF
PRE_RET_OPEN.V.FSN#
      8015**DCL      8015--REDEF    8015--REDEF
PRE_RET_OPEN.WSN_
      7981**DCL      7981--REDEF
PRE_RET_READ.STATION_
      7832**DCL      7833--REDEF
PRE_RET_READ.V.DVBYTE.REREAD#
      7844**DCL      7844--REDEF
PRE_RET_READ.V.INDX#
      7842**DCL      7842--REDEF
PRE_RET_WRITE.STATION_
      7870**DCL      7870--REDEF
PRE_RET_WRITE.V.DVBYTE.VFC#
      7877**DCL      7877--REDEF
READ_EFT_ERRORS
      8402**DCL      8719<>CALL
READ_EFT_ERRORS.BUF_
      8404**DCL      8712<<ASSIGN
READ_EFT_ERRORS.STATION_
      8405**DCL      8406--REDEF
READ_EFT_ERRORS.V
      8406**DCL      8402--DCLINIT
READ_EFT_ERRORS.V.DVBYTE.REREAD#
      8417**DCL      8417--REDEF
READ_EFT_ERRORS.V.INDX#
      8415**DCL      8415--REDEF
RET_CMDS_NAME.L#
      8086**DCL      8086--IMP-SIZ
SET_LO_HEADER_2
      8635**DCL      8710<>CALL
SET_LO_HEADER_2.V
      8636**DCL      8635--DCLINIT
SNVECLIST$
      7618**DCL      7618--IMP-PTR
SPEC.START
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:198  
      7682**DCL      7683--REDEF
SPEC.STOP
      7683**DCL      7684--REDEF
SPECCHARS
      7682**DCL      7682--REDEF
STAR_EFT_ERRORS
      8381**DCL      8311--DCLINIT
TAPE_CLOSE.SN_
      7535**DCL      7535--REDEF
TAPE_CLOSE.UTL_
      7536**DCL      7536--REDEF
TAPE_CLOSE.V.EXPIRE#
      7550**DCL      7550--REDEF
TAPE_CLOSE.V.TYPE#
      7548**DCL      7548--REDEF
TAPE_CLOSE.V.XTNSIZE#
      7545**DCL      7545--REDEF    7547--REDEF
TAPE_DCBLIST$
      7091**DCL      7091--IMP-PTR
TAPE_OPEN.ACSVEH_
      7400**DCL      7401--REDEF
TAPE_OPEN.ALTKEYS_
      7406**DCL      7407--REDEF    7407--REDEF
TAPE_OPEN.HDR_
      7405**DCL      7406--REDEF
TAPE_OPEN.TAB_
      7404**DCL      7405--REDEF
TAPE_OPEN.UHL_
      7398**DCL      7399--REDEF    7399--REDEF
TAPE_OPEN.V.FSN#
      7438**DCL      7438--REDEF    7438--REDEF
TAPE_OPEN.WSN_
      7404**DCL      7404--REDEF
TAPE_READ.STATION_
      7462**DCL      7463--REDEF
TAPE_READ.V.DVBYTE.REREAD#
PL6.E3A0      #003=FLI$ERROR_SUMMARY File=FLP$PRINTER.:E05TSI                    TUE 07/29/97 16:19 Page:199  
      7474**DCL      7474--REDEF
TAPE_READ.V.INDX#
      7472**DCL      7472--REDEF
TAPE_WRITE.STATION_
      7500**DCL      7500--REDEF
TAPE_WRITE.V.DVBYTE.VFC#
      7507**DCL      7507--REDEF
TVECTOR.W2
      7631**DCL      7632--REDEF
VLR_LINES
      8654**DCL      8720--IF
WRITE_LO
      8506**DCL      8674<>CALL     8702<>CALL     8708<>CALL     8742<>CALL
WRITE_LO.BUF_
      8506**DCL      8673<<ASSIGN   8701<<ASSIGN   8707<<ASSIGN
WRITE_LO.BUF_.BOUND
      8506**DCL      8741<<ASSIGN
WRITE_LO.STATION_
      8508**DCL      8508--REDEF
WRITE_LO.V
      8509**DCL      8506--DCLINIT
WRITE_LO.V.DVBYTE.VFC#
      8515**DCL      8515--REDEF
