VERSION E05

PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:1    
        1        1        /*M* ODD$DOG Main routine for DOG ghost */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*P* NAME:         ODD$DOG
       10       10
       11       11             PURPOSE:      To provide the main routine for the DOG ghost
       12       12
       13       13             DESCRIPTION:  The system ghost DOG is responsible for the
       14       14                           various forms of the DISP keyin.
       15       15
       16       16                           The DISP keyin has several forms (e.g. DISP JOB,
       17       17                           DISP OUTPUT, etc.).  KEYIN sends all of these
       18       18                           keyins to station DOG on the CSCG, which is in
       19       19                           fact the DOG ghost.  DOG then processes the keyin,
       20       20                           which usually involves issuing some form of the
       21       21                           M$JOBSTATS PMME, and sends the requested information
       22       22                           to the requesting console by means of templated
       23       23                           writes through KEYIN.
       24       24
       25       25                           DOG can also be run as a normal processor, by
       26       26                           invoking DOG.:SYS in an online or batch user.
       27       27                           In this mode, DOG will accept commands which
       28       28                           are the analogues of the operator keyins,
       29       29                           and display the same information thru M$ME.
       30       30                           The difference is that the user of DOG can
       31       31                           only see jobs in his account, unless he
       32       32                           has DISPJOB privilege.  See the *P* for
       33       33                           ODP$PARSE for more details.
       34       34        */
       35       35        /**/
       36       36        ODD$DOG: PROC MAIN;
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:2    
       37       37        /**/
       38       38
       39       39
       40       40
       41       41        /**/
       42       42        /* INCLUDES */
       43       43        /**/
       44       44        %INCLUDE CP_6;
       45      125        %INCLUDE CP_6_SUBS;
       46      665        %INCLUDE OC_MESSHD_C;
       47      718        %INCLUDE OC_SUBS_C;
       48     1449        %INCLUDE OD_SUBS_C;
       49     1510        %INCLUDE OD_MAC_C;
       50     1598 S      %INCLUDE B$JIT_C;
       51     1599        %INCLUDE JG_GHOSTS_C;
       52     1689        %INCLUDE OD_DATA_R;
       53     1915        %INCLUDE NK_SUBS;
       54     1940        %INCLUDE F_ERRORS_C;
       55     2180        %INCLUDE FO_ERRORS_C;
       56     2212        %INCLUDE KC_ERRORS_C;
       57     2259        %INCLUDE F$DCB;
       58     2308        %INCLUDE XSJ_MAC_C;
       59     2387        %INCLUDE XSJ_SUBS_C;
       60     2414
       61     2415
       62     2416
       63     2417        /**/
       64     2418        /* BASED STRUCTURES */
       65     2419        /**/
       66     2420        %B$JIT0(STCLASS=BASED);
       67     2509        %A$JIT6X;
       68     2512        %B$TCB;
       69     2515        %B$ALT;
       70     2523        %VLR_JOBSTATS_OSRCH     (FPTN=R$OUTPUT,STCLASS=BASED,NFIL=0);
       71     2537        %VLA_JOBSTATS_OSRCH     (FPTN=A$OUTPUT,STCLASS=BASED);
       72     2554        %VLR_JOBSTATS_ISRCH     (FPTN=R$INPUT ,STCLASS=BASED,NJOB=0);
       73     2568        %VLA_JOBSTATS_ISRCH     (FPTN=A$INPUT ,STCLASS=BASED);
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:3    
       74     2595        %VLR_JOBSTATS_ISRCH_SN  (FPTN=A$SN    ,STCLASS=BASED,NSN =0);
       75     2608        %VLR_JOBSTATS_ISRCH_RES (FPTN=A$RES   ,STCLASS=BASED,NRES=0);
       76     2621    1   DCL B$CHARS CHAR(K) BASED DALIGNED;
       77     2622    1   DCL B$$PAGE (0:1023) UBIN WORD ALIGNED BASED;
       78     2623        %VLP_VECTOR (FPTN=B$$VECTOR,STCLASS=BASED);
       79     2638        %OD_KEYIN     (FPTN=OD$KEYIN,STCLASS=BASED);
       80     2682
       81     2683
       82     2684
       83     2685        /**/
       84     2686        /* AUTO */
       85     2687        /**/
       86     2688    1   DCL I UBIN WORD;
       87     2689        %VLP_CRITERIA (FPTN=O_CRITERIA,STCLASS=AUTO);
       88     2717        %VLP_CRITERIA (FPTN=I_CRITERIA,STCLASS=AUTO);
       89     2745    1   DCL J UBIN WORD;
       90     2746    1   DCL K UBIN WORD;
       91     2747    1   DCL RESLIST UBIN WORD;
       92     2748    1   DCL BUF$ PTR;
       93     2749    1   DCL SN$ PTR;
       94     2750    1   DCL RES$ PTR;
       95     2751        %FPT_JOBSTATS (FPTN=GET_STAT,STCLASS=AUTO);
       96     2771
       97     2772
       98     2773
       99     2774        /**/
      100     2775        /* STATIC */
      101     2776        /**/
      102     2777    1   DCL ALLFLG UBIN WORD STATIC ALIGNED INIT(0);
      103     2778    1   DCL 1 HIMSG CHAR(15) STATIC INIT (' ');
      104     2779    1   DCL EHMSG CHAR(8) STATIC ALIGNED INIT('...EH?');
      105     2780    1   DCL NONEMSG CHAR(8) STATIC ALIGNED INIT('...NONE');
      106     2781    1   DCL 1 TMMSG STATIC,
      107     2782    1         2 * CHAR(4) UNAL INIT('....'),
      108     2783    1         2 NUM CHAR(4) UNAL,
      109     2784    1         2 * CHAR(12) UNAL INIT(' ITEMS FOUND');
      110     2785    1   DCL NOMEMMSG CHAR(32) STATIC ALIGNED INIT('...INSUFFICIENT DYNAMIC MEMORY');
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:4    
      111     2786    1   DCL SQRIPMSG CHAR(40) STATIC ALIGNED INIT('...SYMBIONT QUEUES RECOVERY IN PROGRESS')
              2786            ;
      112     2787        %XSJ_PARAM              (FPTN=JOPN,
      113     2788                 MODE      = %IN#,
      114     2789                 DCB       = M$JSF,
      115     2790                 STCLASS   = STATIC);
      116     2807        %XSJ_JOBINFO  (FPTN=JREC,STCLASS=STATIC);
      117     2822        %XSJ_PARAM              (FPTN=JREAD,
      118     2823                 DCB       = M$JSF,
      119     2824                 TYPE      = %TYP_INFO#,
      120     2825                 BUF       = JREC,
      121     2826                 STCLASS   = STATIC);
      122     2843    1   DCL GOODNGT UBIN WORD STATIC ALIGNED INIT(0);
      123     2844        %OC_MESSHD_D            (NAME=ZAPRESP,
      124     2845                 STCLASS   = CONSTANT,
      125     2846                 FUNC      = ZAP,
      126     2847                 DELIM     =";");
      127     2860        %OC_MESSHD_D       (NAME=OPMSG_KERR,
      128     2861            NPARMS    = 13,
      129     2862            ATR       = M_UR,
      130     2863            MSG       = OD_KERR_MSG#,
      131     2864            STCLASS   = STATIC);
      132     2877    1         2 * UBIN BYTE UNAL INIT(1),
      133     2878    1         2 * UBIN BYTE UNAL INIT(2),
      134     2879    1         2 * UBIN BYTE UNAL INIT(2),
      135     2880    1         2 * UBIN BYTE UNAL INIT(2),
      136     2881    1         2 * UBIN BYTE UNAL INIT(1),
      137     2882    1         2 * UBIN BYTE UNAL INIT(8),
      138     2883    1         2 * UBIN BYTE UNAL INIT(8),
      139     2884    1         2 * UBIN BYTE UNAL INIT(8),
      140     2885    1         2 * UBIN BYTE UNAL INIT(1),
      141     2886    1         2 * UBIN BYTE UNAL INIT(1),
      142     2887    1         2 * UBIN BYTE UNAL INIT(1),
      143     2888    1         2 * UBIN BYTE UNAL INIT(6),
      144     2889    1         2 * UBIN BYTE UNAL INIT(8),
      145     2890    1         2 SUBC UBIN BYTE UNAL,
      146     2891    1         2 NFOUND UBIN HALF UNAL,
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:5    
      147     2892    1         2 ERRC UBIN HALF UNAL,
      148     2893    1         2 DEVTYP CHAR(2) UNAL,
      149     2894    1         2 PWSN UBIN BYTE UNAL,
      150     2895    1         2 ATWSN CHAR(8) UNAL,
      151     2896    1         2 ATTERM CHAR(8) UNAL,
      152     2897    1         2 ACCT CHAR(8) UNAL,
      153     2898    1         2 NOTACCT UBIN BYTE UNAL,
      154     2899    1         2 NOTFORM UBIN BYTE UNAL,
      155     2900    1         2 NOTWSN UBIN BYTE UNAL,
      156     2901    1         2 NOTTERM REDEF NOTWSN UBIN BYTE UNAL,
      157     2902    1         2 FORM CHAR(6) UNAL,
      158     2903    1         2 LPWSN CHAR(8) UNAL;
      159     2904        %OC_MESSHD_D            (NAME=OPMSG_RESP,
      160     2905                 NPARMS    = 2,
      161     2906                 ATR       = M_UR,
      162     2907                 MSG       = OD_RESP_MSG#,
      163     2908                 STCLASS   = STATIC);
      164     2921    1         2 * UBIN BYTE UNAL INIT(4),
      165     2922    1         2 * UBIN BYTE UNAL INIT(4),
      166     2923    1         2 SUBC UBIN WORD UNAL,
      167     2924    1         2 NDISPED UBIN WORD UNAL;
      168     2925        %OC_MESSHD_D            (NAME=OPMSG_UNIMP,
      169     2926                 NPARMS    = 0,
      170     2927                 ATR       = M_UR,
      171     2928                 MSG       = UNIMP_MSG#,
      172     2929                 DELIM     =";",
      173     2930                 STCLASS   = STATIC);
      174     2943        %OC_MESSHD_D            (NAME=OPMSG_ILLKEY,
      175     2944                 NPARMS    = 1,
      176     2945                 ATR       = M_UR,
      177     2946                 MSG       = GENL_ERR_MSG#,
      178     2947                 STCLASS   = STATIC);
      179     2960    1         2 * UBIN BYTE UNAL INIT(1),
      180     2961    1         2 SUBC UBIN BYTE UNAL INIT(16);
      181     2962
      182     2963
      183     2964
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:6    
      184     2965        /**/
      185     2966        /* DCBS */
      186     2967        /**/
      187     2968    1   DCL M$CSCG DCB;
      188     2969    1   DCL M$LO DCB;
      189     2970    1   DCL M$SI DCB;
      190     2971    1   DCL M$ME DCB;
      191     2972    1   DCL M$JSF DCB;
      192     2973
      193     2974
      194     2975
      195     2976        /**/
      196     2977        /* REFS */
      197     2978        /**/
      198     2979    1   DCL B$JIT$ PTR SYMREF;
      199     2980    1   DCL B$TCB$ PTR SYMREF;
      200     2981    1   DCL FOI$GBUF      ENTRY(2) ALTRET;
      201     2982    1   DCL FOI$RBUF      ENTRY(2) ALTRET;
      202     2983    1   DCL ODE$EVNT      ENTRY    ASYNC;
      203     2984    1   DCL ODE$XCON      ENTRY    ASYNC;
      204     2985    1   DCL ODF$FORMAT    ENTRY(1);
      205     2986    1   DCL ODP$PARSE     ENTRY(1) ALTRET;
      206     2987    1   DCL XSJ$CLOSE     ENTRY(1) ALTRET;
      207     2988    1   DCL XSJ$OPEN      ENTRY(1) ALTRET;
      208     2989    1   DCL XSJ$READ      ENTRY(1) ALTRET;
      209     2990
      210     2991    1   DCL 1 B_VERSION SYMREF ALIGNED,
      211     2992    1         2 L# UBIN(9) UNAL,
      212     2993    1         2 TXT CHAR(B_VERSION.L#) UNAL;
      213     2994
      214     2995
      215     2996
      216     2997        /**/
      217     2998        /* PMME FPTS */
      218     2999        /**/
      219     3000        %FPT_XCON                              (FPTN=XCONSET,
      220     3001                 STCLASS   = CONSTANT,
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:7    
      221     3002                 UENTRY    = ODE$XCON);
      222     3016        %FPT_INT                               (FPTN=INTSET,
      223     3017                 UENTRY    = ODE$EVNT,
      224     3018                 STCLASS   = CONSTANT);
      225     3032        %FPT_OPEN                              (FPTN=OPEN_CSCG,
      226     3033                 DCB       = M$CSCG,
      227     3034                 SCRUB     = YES,
      228     3035                 NAME      = CSCGNAME,
      229     3036                 SETSTA    = DOGNAME,
      230     3037                 ASN       = COMGROUP,
      231     3038                 FUN       = UPDATE,
      232     3039                 STCLASS   = CONSTANT);
      233     3148        %VLP_NAME          (FPTN=CSCGNAME,
      234     3149                 NAME      = 'CSCG',
      235     3150                 STCLASS   = CONSTANT);
      236     3177        %VLP_SETSTA        (FPTN=DOGNAME,
      237     3178                   MYSTATION='DOG',
      238     3179                   OSTATION='KEYIN',
      239     3180                   DIRONLY=YES,
      240     3181                   STCLASS=CONSTANT);
      241     3209        %FPT_WRITE                             (FPTN=WRITE_ZAPRESP,
      242     3210                 BUF       = ZAPRESP,
      243     3211                 DCB       = M$CSCG,
      244     3212                 STCLASS   = CONSTANT);
      245     3243        %FPT_WRITE                             (FPTN=OCMSG_KERR,
      246     3244                 BUF       = OPMSG_KERR,
      247     3245                 DCB       = M$CSCG,
      248     3246                 STCLASS   = CONSTANT);
      249     3277        %FPT_WRITE                             (FPTN=OCMSG_RESP,
      250     3278                 BUF       = OPMSG_RESP,
      251     3279                 DCB       = M$CSCG,
      252     3280                 STCLASS   = CONSTANT);
      253     3311        %FPT_WRITE                             (FPTN=OCMSG_ILLKEY,
      254     3312                 BUF       = OPMSG_ILLKEY,
      255     3313                 DCB       = M$CSCG,
      256     3314                 STCLASS   = CONSTANT);
      257     3345        %FPT_WRITE                             (FPTN=OCMSG_UNIMP,
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:8    
      258     3346                 BUF       = OPMSG_UNIMP,
      259     3347                 DCB       = M$CSCG,
      260     3348                 STCLASS   = CONSTANT);
      261     3379        %FPT_JOBSTATS                          (FPTN=STAT_FPT,
      262     3380                 ORDER     = SRCH,
      263     3381                 STCLASS   = STATIC);
      264     3401        %VLP_CRITERIA                          (FPTN=STAT_CRITERIA,
      265     3402                 STCLASS   = STATIC);
      266     3430        %FPT_OPEN                              (FPTN=OPEN_LOGHST,
      267     3431                 DCB       = M$LO,
      268     3432                 ASN       = DEVICE,
      269     3433                 RES       = 'LP',
      270     3434                 FUN       = CREATE,
      271     3435                 SCRUB     = YES,
      272     3436                 STCLASS   = STATIC);
      273     3545        %FPT_OPEN                              (FPTN=OPEN_LOUSER,
      274     3546                 DCB       = M$LO,
      275     3547                 STCLASS   = CONSTANT);
      276     3656        %VLP_WSN           (FPTN=SC_LPWSN,
      277     3657                 WSN       = '@',
      278     3658                 STCLASS   = CONSTANT);
      279     3671        %FPT_CLOSE                             (FPTN=CLOSE_LO,
      280     3672                 DCB       = M$LO,
      281     3673                 DISP      = SAVE,
      282     3674                 STCLASS   = CONSTANT);
      283     3716        %FPT_RESCTL                            (FPTN=GET_PSEUDOS,
      284     3717                 PSEUDO    = OD_PSEUDOS,
      285     3718                 MBSDISP   = YES,
      286     3719                 STCLASS   = STATIC);
      287     3736        %FPT_READ                              (FPTN=READ_SI,
      288     3737                 STCLASS   = CONSTANT,
      289     3738                 DCB       = M$SI,
      290     3739                 BUF       = OD_CSCGBUF,
      291     3740                 WAIT      = YES);
      292     3779        %FPT_WRITE                             (FPTN=WRITE_SQRIP,
      293     3780                 STCLASS   = CONSTANT,
      294     3781                 DCB       = M$ME,
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:9    
      295     3782                 VFC       = NO,
      296     3783                 BUF       = SQRIPMSG);
      297     3814        %FPT_WRITE                             (FPTN=WRITE_HI,
      298     3815                 STCLASS   = CONSTANT,
      299     3816                 DCB       = M$ME,
      300     3817                 VFC       = NO,
      301     3818                 BUF       = HIMSG);
      302     3849        %FPT_WRITE                             (FPTN=WRITE_EH,
      303     3850                 STCLASS   = CONSTANT,
      304     3851                 DCB       = M$ME,
      305     3852                 VFC       = NO,
      306     3853                 BUF       = EHMSG);
      307     3884        %FPT_WRITE                             (FPTN=WRITE_NONE,
      308     3885                 STCLASS   = CONSTANT,
      309     3886                 DCB       = M$ME,
      310     3887                 VFC       = NO,
      311     3888                 BUF       = NONEMSG);
      312     3919        %FPT_WRITE                             (FPTN=WRITE_NOMEM,
      313     3920                 STCLASS   = CONSTANT,
      314     3921                 DCB       = M$ME,
      315     3922                 VFC       = NO,
      316     3923                 BUF       = NOMEMMSG);
      317     3954        %FPT_WRITE                             (FPTN=WRITE_TM,
      318     3955                 STCLASS   = CONSTANT,
      319     3956                 DCB       = M$ME,
      320     3957                 VFC       = NO,
      321     3958                 BUF       = TMMSG);
      322     3989        %FPT_GDP                              (FPTN=GETP,
      323     3990                 PAGES     = ODMI_NPGG#,
      324     3991                 RESULTS   = GDPVEC,
      325     3992                 STCLASS   = CONSTANT);
      326     4006        %FPT_GDP                              (FPTN=GETP3,
      327     4007                 PAGES     = 3,
      328     4008                 RESULTS   = GDPVEC,
      329     4009                 STCLASS   = CONSTANT);
      330     4023        %VLP_VECTOR                           (FPTN=GDPVEC,
      331     4024                 STCLASS   = STATIC);
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:10   
      332     4039        %FPT_FDP                              (FPTN=RELP,
      333     4040                 PAGES     = 512,
      334     4041                 RESULTS   = GDPVEC,
      335     4042                 STCLASS   = CONSTANT);
      336     4056
      337     4057
      338     4058
      339     4059        /**/
      340     4060        /* SUBS */
      341     4061        /**/
      342     4062        %SUB B$ERRCODE = B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE;
      343     4063        %SUB FOREVER="WHILE ('1'B)";
      344     4064        %EJECT;
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:11   
      345     4065        /**/
      346     4066        /**/
      347     4067        /* BEGIN HERE */
      348     4068        /**/
      349     4069
      350     4070
      351     4071    1         IF B$JIT$->B$JIT.USER = JG_DOG# THEN
      352     4072    2           DO;
      353     4073    2           OD_SGHST='1'B;
      354     4074
      355     4075                                /* GET XCON */
      356     4076    2           CALL M$XCON (XCONSET);
      357     4077                                /* SET UP GOODIES */
      358     4078    2           CALL MISC_SETUP;
      359     4079                                /* CONNECT TO CS COMGROUP */
      360     4080    2           CALL M$OPEN (OPEN_CSCG);
      361     4081    2           END;
      362     4082    1         ELSE
      363     4083    2           DO;
      364     4084    2           OD_SGHST='0'B;
      365     4085    2           CALL MISC_SETUP;
      366     4086    2           CALL M$INT (INTSET);
      367     4087    2           CALL CONCAT (HIMSG,'DOG ',SUBSTR(B_VERSION.TXT, 0,
      368     4088    2           B_VERSION.L#),' Here');
      369     4089    2           CALL M$WRITE (WRITE_HI);
      370     4090    2           IF DCBADDR(DCBNUM(M$ME))->F$DCB.WIDTH ~= 0 THEN
      371     4091    3             DO;
      372     4092    3             OD_OBMAX= DCBADDR(DCBNUM(M$ME))->F$DCB.WIDTH;
      373     4093    3             IF OD_OBMAX > ODMI_OBSZ# THEN OD_OBMAX=ODMI_OBSZ#;
      374     4094    3             END;
      375     4095    2           END;
      376     4096        %EJECT;
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:12   
      377     4097        /*
      378     4098
      379     4099                    #   #    ###     ###    #   #
      380     4100                    ## ##   #   #     #     #   #
      381     4101                    # # #   #   #     #     ##  #
      382     4102                    #   #   #####     #     # # #
      383     4103                    #   #   #   #     #     #  ##
      384     4104                    #   #   #   #     #     #   #
      385     4105                    #   #   #   #    ###    #   #
      386     4106
      387     4107
      388     4108                    #        ###     ###    ####
      389     4109                    #       #   #   #   #   #   #
      390     4110                    #       #   #   #   #   #   #
      391     4111                    #       #   #   #   #   ####
      392     4112                    #       #   #   #   #   #
      393     4113                    #       #   #   #   #   #
      394     4114                    #####    ###     ###    #
      395     4115
      396     4116        */
      397     4117    1         IF OD_SGHST THEN
      398     4118    2           DO FOREVER;
      399     4119    2           CALL M$READ (OD_READCSCG);
      400     4120    2           OD_CXT=OD_CXT_INIT;
      401     4121    2           ADDR(OD_CXT.KIN#)->OD$KEYIN=ADDR(OD_CSCGBUF)->OD$KEYIN;
      402     4122    2           IF OD_CXT.KIN# = KEY_ZAP# THEN
      403     4123    3             DO;
      404     4124    3             CALL M$WRITE (WRITE_ZAPRESP);
      405     4125    3             GOODNGT=1;
      406     4126    3             CALL XSJ$CLOSE (JOPN) ALTRET(ZAP01);
      407     4127    3   ZAP01:    ;
      408     4128    3             END;
      409     4129    2           ELSE IF GOODNGT = 0 THEN
      410     4130    3              DO;
      411     4131    3              OPMSG_KERR.CADDR=OD_CXT.CADDR;
      412     4132    3              CALL SETUP_CXT ALTRET(KEYEND);
      413     4133    3   MSGLOOP:   ;
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:13   
      414     4134    3              CALL DRIVE_CXT ALTRET(MSGLOOP);
      415     4135    3   KEYEND:    ;
      416     4136    3              END;
      417     4137    2           END;
      418     4138    1         ELSE
      419     4139    2           DO;
      420     4140                                /* ONLINE DOG HERE */
      421     4141    3             DO FOREVER;
      422     4142    3             CALL M$READ (READ_SI) ALTRET(SIALT);
      423     4143    3             CALL ODP$PARSE (ALLFLG) ALTRET(BADCMD);
      424     4144    3             IF OD_CXT.KIN# = 0 THEN GOTO ENDCMD;
      425     4145    3             OD_INT=0;
      426     4146    3   CMD00:    ;
      427     4147    3             CALL SETUP_CXT ALTRET(ENDCMD);
      428     4148    3   CMD0:     ;
      429     4149    3             CALL DRIVE_CXT ALTRET(CMD0);
      430     4150    3             GOTO ENDCMD;
      431     4151    3   BADCMD:   ;
      432     4152    3             CALL M$WRITE (WRITE_EH);
      433     4153    3   ENDCMD:   ;
      434     4154    3             END;
      435     4155    2   SIALT:  ;
      436     4156    2           CALL M$EXIT;
      437     4157    2           END;
      438     4158        %EJECT;
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:14   
      439     4159
      440     4160
      441     4161        /*
      442     4162         K   K  EEEEE  Y   Y   III   N   N
      443     4163         K  K   E      Y   Y    I    N   N
      444     4164         K K    E       Y Y     I    NN  N
      445     4165         KK     EEEE     Y      I    N N N
      446     4166         K K    E        Y      I    N  NN
      447     4167         K  K   E        Y      I    N   N
      448     4168         K   K  EEEEE    Y     III   N   N
      449     4169
      450     4170
      451     4171         PPPP   RRRR    OOO    CCC   EEEEE   SSS    SSS    III   N   N   GGG
      452     4172         P   P  R   R  O O O  C   C  E      S   S  S   S    I    N   N  G   G
      453     4173         P   P  R   R  O O O  C      E      S      S        I    NN  N  G
      454     4174         PPPP   RRRR   O  OO  C      EEEE    SSS    SSS     I    N N N  G
      455     4175         P      R R    O   O  C      E          S      S    I    N  NN  G  GG
      456     4176         P      R  R   O   O  C   C  E      S   S  S   S    I    N   N  G   G
      457     4177         P      R   R   OOO    CCC   EEEEE   SSS    SSS    III   N   N   GGG
      458     4178
      459     4179
      460     4180        */
      461     4181
      462     4182
      463     4183
      464     4184        /**************************************
      465     4185         **************************************
      466     4186                    SETUP_CXT
      467     4187         **************************************
      468     4188         **************************************/
      469     4189        /*D* NAME:         SETUP_CXT
      470     4190             PURPOSE:      To set up keyin context for output
      471     4191             DESCRIPTION:  The context
      472     4192                           is to be readied for output.  This
      473     4193                           involves performing the appropriate form
      474     4194                           of M$JOBSTATS SRCH into the obtained buffer,
      475     4195                           and setting the counters in the context to
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:15   
      476     4196                           say that we have printed 0 items.
      477     4197
      478     4198                           If all this is successfully done, the routine
      479     4199                           returns.  It ALTRETs if any of the following
      480     4200                           conditions cause failure (after releasing the
      481     4201                           context frame and issuing an error message if
      482     4202                           appropriate):
      483     4203
      484     4204                           o unexpected M$JOBSTATS ALTRET
      485     4205
      486     4206                           o nothing to display
      487     4207
      488     4208                           o unknown keyin number (causes a SNAP)
      489     4209
      490     4210                           o Insufficient buffer space available to hold
      491     4211                           all the selected items
      492     4212
      493     4213                           o Invalid parameters on the keyin
      494     4214
      495     4215                           o Display is for console (not LP) and has more
      496     4216                           than the limiting number of items, and keyin
      497     4217                           did not specify FORCE or SHORT
      498     4218
      499     4219                           o display was to LP and M$LO could not be
      500     4220                           opened
      501     4221        */
      502     4222    1   SETUP_CXT: PROC ALTRET;
      503     4223    2         OD_CXT.NDONE=0;
      504     4224    2         O_CRITERIA=STAT_CRITERIA;
      505     4225    2         I_CRITERIA=STAT_CRITERIA;
      506     4226    2         GET_STAT=STAT_FPT;
      507     4227    2         GET_STAT.V_=VECTOR(GET_STAT.V);
      508     4228    2         IF OD_CXT.CATTR.OUTPUT & M_SYS THEN
      509     4229                           /* SYS has all the attrs we're interested in
      510     4230                              so just turn 'em all on. */
      511     4231    2          OD_CXT.CATTR.OUTPUT = '777777'O;
      512     4232
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:16   
      513     4233                                /* Check to see if the keyin is legal
      514     4234                                   from this console */
      515     4235    3           DO CASE (OD_CXT.KIN#);
      516     4236
      517     4237    3             CASE (KEY_DISPNSFORM#);
      518     4238    3               IF NOT OD_CXT.CATTR.OUTPUT & M_DEVC THEN
      519     4239    4                 DO;
      520     4240    4   ILLKEY:       OPMSG_ILLKEY.CADDR=OD_CXT.CADDR;
      521     4241    4                 CALL M$WRITE (OCMSG_ILLKEY);
      522     4242    4                 ALTRETURN;
      523     4243    4                 END;
      524     4244
      525     4245    3             CASE (KEY_DISPJOB#,KEY_DISPINPUT#,KEY_DISPDEFER#,
      526     4246    3                 KEY_DISPNORUN#,KEY_DISPPRIO#);
      527     4247    3               IF NOT OD_CXT.CATTR.OUTPUT & M_ADMIN THEN GOTO ILLKEY;
      528     4248
      529     4249    3             CASE (KEY_DISPSYSID#,KEY_DISPALL#);
      530     4250    3               IF NOT (OD_CXT.CATTR.OUTPUT & (M_ADMIN|M_DEVC)) THEN
      531     4251    3                GOTO ILLKEY;
      532     4252
      533     4253    3           END;
      534     4254
      535     4255                                /* VECTOR OFF
      536     4256                                   ON KEYIN TYPE */
      537     4257
      538     4258    3           DO CASE (OD_CXT.KIN#);
      539     4259
      540     4260
      541     4261    3             CASE (KEY_DISPNSFORM#);
      542     4262
      543     4263    3               O_CRITERIA.NSFORM#='1'B;
      544     4264    3               OPMSG_KERR.SUBC=ODKE_NONSF#;
      545     4265    3               GOTO DISPO;
      546     4266
      547     4267
      548     4268    3             CASE (KEY_DISPOUTPUT#);
      549     4269
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:17   
      550     4270    3               OPMSG_KERR.SUBC=ODKE_NOUTP#;
      551     4271    3               IF OD_CXT.DEVTYP ~= ' ' THEN
      552     4272    4                 DO;
      553     4273    4                 O_CRITERIA.DEVTYP#=OD_CXT.DEVTYP;
      554     4274    4                 OPMSG_KERR.SUBC=ODKE_NDOUT#;
      555     4275    4                 OPMSG_KERR.DEVTYP=OD_CXT.DEVTYP;
      556     4276    4                 END;
      557     4277    3   DISPO:      ;
      558     4278        /*  Here's the deal:  for C00, we're really getting a (possibly
      559     4279            wildcarded) WSN in TNAME.  Why, who knows.  */
      560     4280    3               OD_CXT.SWSN=OD_CXT.STNAME;                                    /*#13.37*/
      561     4281    3               OD_CXT.NOTWSN=OD_CXT.NOTTERM;
      562     4282    3               CALL GETO ALTRET(ERRX);
      563     4283    3   DONE:       ;
      564     4284    3               OD_CXT.NDISPED=OD_CXT.NFOUND-OD_CXT.NDONE;
      565     4285    3               IF OD_CXT.NDISPED <= 0 THEN GOTO ERRX;
      566     4286    3               CALL DONESUB ALTRET(ERRX);
      567     4287    3               RETURN;
      568     4288    3   ERRX:       ;
      569     4289    3               OPMSG_KERR.FORM = OD_CXT.SFORM;
      570     4290    3               OPMSG_KERR.NOTACCT= OD_CXT.NOTACCT;
      571     4291    3               OPMSG_KERR.NOTWSN = OD_CXT.NOTWSN;
      572     4292    3               OPMSG_KERR.NOTTERM= OD_CXT.NOTTERM;
      573     4293    3               OPMSG_KERR.NOTFORM= OD_CXT.NOTFORM;
      574     4294    3               OPMSG_KERR.CADDR=OD_CXT.CADDR;
      575     4295    3               IF OD_CXT.CATTR.OUTPUT & M_SYS THEN
      576     4296    4                 DO;
      577     4297    4                 OPMSG_KERR.PWSN=1;
      578     4298    4                 OPMSG_KERR.ATWSN=OD_CXT.SWSN;
      579     4299    4                 OPMSG_KERR.ATTERM=OD_CXT.STNAME;
      580     4300    4                 END;
      581     4301    3               ELSE OPMSG_KERR.PWSN=0;
      582     4302    3               OPMSG_KERR.ACCT=OD_CXT.SACCT;
      583     4303    3               IF OD_SGHST THEN
      584     4304    3                CALL M$WRITE (OCMSG_KERR);
      585     4305    3               ELSE
      586     4306    4                 DO CASE (OPMSG_KERR.SUBC);
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:18   
      587     4307
      588     4308    4                   CASE (ODKE_NDATA#);
      589     4309    4                     CALL M$WRITE (WRITE_NOMEM);
      590     4310
      591     4311    4                   CASE (ODKE_TMITM#);
      592     4312    4                     I=OD_CXT.NFOUND;
      593     4313    4                     CALL BINCHAR (TMMSG.NUM,I);
      594     4314    4                     CALL M$WRITE (WRITE_TM);
      595     4315
      596     4316    4                   CASE (ODKE_BPRIO#);
      597     4317    4                     CALL M$WRITE (WRITE_EH);
      598     4318
      599     4319    4                   CASE (ODKE_SQRIP#);
      600     4320    4                     CALL M$WRITE (WRITE_SQRIP);
      601     4321
      602     4322    4                   CASE (ELSE);
      603     4323    4                     CALL M$WRITE (WRITE_NONE);
      604     4324
      605     4325    4                 END;
      606     4326    3   ERRX1:      ;
      607     4327    3               CALL RELMEM_CXT;
      608     4328    3               ALTRETURN;
      609     4329
      610     4330
      611     4331    3             CASE (KEY_DISPJOB#);
      612     4332
      613     4333    3               I_CRITERIA.RUNNING#='1'B;
      614     4334    3               OPMSG_KERR.SUBC=ODKE_NORUN#;
      615     4335    3               GOTO DISPINR;
      616     4336
      617     4337
      618     4338    3             CASE (KEY_DISPINPUT#);
      619     4339
      620     4340    3               OPMSG_KERR.SUBC=ODKE_NOJOB#;
      621     4341    3               GOTO DISPI;
      622     4342
      623     4343
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:19   
      624     4344    3             CASE (KEY_DISPDEFER#);
      625     4345
      626     4346    3               I_CRITERIA.RUNAFTER#='1'B;
      627     4347    3               OPMSG_KERR.SUBC=ODKE_NODFR#;
      628     4348    3               GOTO DISPINR;
      629     4349
      630     4350
      631     4351    3             CASE (KEY_DISPNORUN#);
      632     4352
      633     4353    3               I_CRITERIA.NORUN#='1'B;
      634     4354    3               OPMSG_KERR.SUBC=ODKE_NNORN#;
      635     4355    3               GOTO DISPI;
      636     4356
      637     4357
      638     4358    3             CASE (KEY_DISPPRIO#);
      639     4359
      640     4360    3               OPMSG_KERR.SUBC=ODKE_BPRIO#;
      641     4361    3               IF OD_CXT.HIPRIOR = -1 THEN OD_CXT.HIPRIO=OD_CXT.LOPRIO;
      642     4362    3               IF OD_CXT.LOPRIO > OD_CXT.HIPRIO
      643     4363    3               OR OD_CXT.HIPRIO > 15 THEN GOTO ERRX;
      644     4364    3               OPMSG_KERR.SUBC=ODKE_NPRIO#;
      645     4365    3               I_CRITERIA.PRIO#=OD_CXT.LOPRIO;
      646     4366    3               I_CRITERIA.PRIO1#=OD_CXT.HIPRIO;
      647     4367    3   DISPINR:    ;
      648     4368    3               RESLIST=0;
      649     4369    3               GOTO DISPI2;
      650     4370    3   DISPI:      ;
      651     4371    3               RESLIST=1;
      652     4372    3   DISPI2:     ;
      653     4373    3               CALL GETI ALTRET(ERRX);
      654     4374    3               IF OD_CXT.KIN# = KEY_DISPINPUT# THEN
      655     4375    4                 DO WHILE (OD_CXT.NDONE < OD_CXT.NFOUND);
      656     4376    4                 BUF$=ADDR(OD_CXT.SEG$->R$INPUT.J(OD_CXT.NDONE));
      657     4377    4                 IF BUF$->A$INPUT.PRIO ~= %JP_RUN# THEN GOTO DONE;
      658     4378    4                 OD_CXT.NDONE=OD_CXT.NDONE+1;
      659     4379    4                 END;
      660     4380    3               GOTO DONE;
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:20   
      661     4381
      662     4382
      663     4383    3             CASE (KEY_DISPSYSID#);
      664     4384
      665     4385    3               OD_CXT.SACCT=' ';
      666     4386    3               OD_CXT.INOUT=1;
      667     4387                     /* Sheesh.  If SYSID = 0, M$JOBSTATS will think
      668     4388                        we're searching all SYSIDs, so we'll just go right
      669     4389                        ahead and check for it EVERY time... */
      670     4390    3               IF OD_CXT.SYSID ~= 0 THEN
      671     4391    4                 DO;
      672     4392    4                 IF OD_CXT.CATTR.OUTPUT & M_ADMIN THEN
      673     4393    4                  IF OD_CXT.INPCOMP = 0 THEN
      674     4394    5                    DO;
      675     4395                                /* FIRST PASS - LOOK FOR SYSID AS JOB */
      676     4396    5                    I_CRITERIA.SYSID#=OD_CXT.SYSID;
      677     4397    5                    I_CRITERIA.SYSID1#=OD_CXT.SYSID;
      678     4398    5                    RESLIST=1;
      679     4399    5                    CALL GETI1 ALTRET(ERRX);
      680     4400    5                    IF OD_CXT.NFOUND ~= 0 THEN GOTO DONE;
      681     4401    5                    IF GOODNGT = 0 THEN
      682     4402    6                      DO;
      683     4403                                /* TRY TO READ :JOBSTATS */
      684     4404    6                      IF DCBADDR(DCBNUM(M$JSF))->F$DCB.FCD = '0'B THEN
      685     4405    6                       CALL XSJ$OPEN (JOPN) ALTRET(DISPSY1);
      686     4406    6                      JREAD.SYSID#=OD_CXT.SYSID;
      687     4407    6                      CALL XSJ$READ (JREAD) ALTRET(DISPSY1);
      688     4408    6                      OD_CXT.SEG$=ADDR(JREC);
      689     4409    6                      I = OD_CXT.ONLP;
      690     4410    6                      OD_CXT.ONLP = 0;
      691     4411    6                      CALL ODF$FORMAT (ODFT_JSFID#);
      692     4412    6                      OD_CXT.ONLP = I;
      693     4413    6                      OD_CXT.INPCOMP=1;
      694     4414    6   DISPSY1:           ;
      695     4415    6                      END;
      696     4416    5                    CALL RELMEM_CXT;
      697     4417                                /* FAILED TO FIND IT. LOOK FOR OUTPUT */
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:21   
      698     4418    5                    GET_STAT=STAT_FPT;
      699     4419    5                    GET_STAT.V_=VECTOR(GET_STAT.V);
      700     4420    5                    END;
      701     4421
      702     4422                                /* SECOND PASS - LOOK FOR SYSID AS OUTPUT */
      703     4423    4                 IF OD_CXT.CATTR.OUTPUT & M_DEVC THEN
      704     4424    5                   DO;
      705     4425    5                   O_CRITERIA.SYSID#=OD_CXT.SYSID;
      706     4426    5                   O_CRITERIA.SYSID1#=OD_CXT.SYSID;
      707     4427    5                   CALL GETO1 ALTRET(ERRX);
      708     4428    5                   IF OD_CXT.NFOUND ~= 0 THEN
      709     4429    6                     DO;
      710     4430    6                     OD_CXT.INPCOMP=1;
      711     4431    6                     GOTO DONE;
      712     4432    6                     END;
      713     4433    5                   END;
      714     4434    4                 END;
      715     4435    3               IF OD_CXT.INPCOMP = 0 THEN
      716     4436    4                 DO;
      717     4437    4                 OPMSG_KERR.SUBC=ODKE_NOSYS#;
      718     4438    4                 OPMSG_KERR.SYSID=OD_CXT.SYSID;
      719     4439    4                 GOTO ERRX;
      720     4440    4                 END;
      721     4441    3               GOTO ERRX1;
      722     4442
      723     4443
      724     4444    3             CASE (KEY_DISPALL#);
      725     4445
      726     4446    3               OPMSG_KERR.SUBC=ODKE_NOALL#;                                  /*#13.27*/
      727     4447    3               OD_CXT.INOUT=1;
      728     4448    3               IF OD_CXT.CATTR.OUTPUT & M_ADMIN THEN
      729     4449    3                IF OD_CXT.INPCOMP = 0 THEN
      730     4450    4                  DO;
      731     4451                                /* 1ST PASS: GET INPUT */
      732     4452    4                  RESLIST=1;
      733     4453    4                  CALL GETI ALTRET(ERRX);
      734     4454    4                  IF OD_CXT.NFOUND ~= 0 THEN GOTO DONE;
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:22   
      735     4455                                /* DIDNT FIND ANY */
      736     4456    4                  CALL RELMEM_CXT;
      737     4457    4                  GET_STAT=STAT_FPT;
      738     4458    4                  GET_STAT.V_=VECTOR(GET_STAT.V);
      739     4459    4                  END;
      740     4460    3               IF OD_CXT.CATTR.OUTPUT & M_DEVC THEN
      741     4461    4                 DO;
      742     4462    4                 CALL GETO ALTRET(DISPALL1);
      743     4463    4                 GOTO DISPALL2;
      744     4464    4   DISPALL1:     ;
      745     4465    4                 IF OD_CXT.ONLP ~= 0 THEN CALL M$CLOSE (CLOSE_LO) ALTRET(ERRX);
      746     4466    4                 GOTO ERRX;
      747     4467    4   DISPALL2:     ;
      748     4468    4                 IF OD_CXT.NFOUND ~= 0 THEN
      749     4469    5                   DO;
      750     4470    5                   OD_CXT.INPCOMP=1;
      751     4471    5                   OD_CXT.NDISPED=OD_CXT.NDISPED+OD_CXT.NFOUND;
      752     4472    5                   OD_CXT.HDRDUN=0;
      753     4473    5                   CALL DONESUB ALTRET(DISPALL1);
      754     4474    5                   RETURN;
      755     4475    5                   END;
      756     4476    4                 END;
      757     4477    3               IF OD_CXT.INPCOMP = 0 THEN
      758     4478    4                 DO;
      759     4479    4                 OPMSG_KERR.SUBC=ODKE_NOALL#;
      760     4480    4                 GOTO ERRX;
      761     4481    4                 END;
      762     4482    3               GOTO ERRX1;
      763     4483
      764     4484
      765     4485    3             CASE (ELSE);
      766     4486
      767     4487    3               OPMSG_UNIMP.CADDR=OD_CXT.CADDR;
      768     4488    3               CALL M$WRITE (OCMSG_UNIMP);
      769     4489    3               GOTO ERRX1;
      770     4490
      771     4491
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:23   
      772     4492    3           END;
      773     4493
      774     4494
      775     4495                           /* SUBROUTINE EXECUTED WHEN 'DONE' */
      776     4496    2   DONESUB: PROC ALTRET;
      777     4497    3         IF OD_CXT.ONLP ~= 0
      778     4498    3         OR OD_CXT.FORCE ~= 0
      779     4499    3         OR OD_CXT.NDISPED <= ODMI_ITMX# THEN
      780     4500    4           DO;
      781     4501    4           IF OD_CXT.ONLP ~= 0                                               /*#13.29*/
      782     4502    4           AND NOT DCBADDR(DCBNUM(M$LO))->F$DCB.FCD THEN
      783     4503    5             DO;
      784     4504    5             IF OD_SGHST THEN
      785     4505    6               DO;
      786     4506    6               IF OD_CXT.LPWSN = ' ' THEN
      787     4507    6                OPEN_LOGHST.WSN_=VECTOR(SC_LPWSN);
      788     4508    6               ELSE OPEN_LOGHST.WSN_=VECTOR(OD_CXT.LPWSN);
      789     4509    6               CALL M$OPEN (OPEN_LOGHST) ALTRET(LOALT);
      790     4510    6               END;
      791     4511    5             ELSE CALL M$OPEN (OPEN_LOUSER);
      792     4512    5             END;
      793     4513    4           RETURN;
      794     4514    4   LOALT:  ;
      795     4515    4           OPMSG_KERR.SUBC=ODKE_NOPLO#;
      796     4516    4           OPMSG_KERR.ERRC=B$ERRCODE;
      797     4517    4           OPMSG_KERR.LPWSN=OD_CXT.LPWSN;
      798     4518    4           ALTRETURN;
      799     4519    4           END;
      800     4520
      801     4521    3         OPMSG_KERR.SUBC=ODKE_TMITM#;
      802     4522    3         OPMSG_KERR.NFOUND=OD_CXT.NDISPED;
      803     4523    3         ALTRETURN;
      804     4524    3   END DONESUB;
      805     4525
      806     4526
      807     4527
      808     4528
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:24   
      809     4529                                /* ALLOCATE A BUFFER AND DO M$JOBSTATS INTO IT */
      810     4530
      811     4531    2   GETO: PROC ALTRET;
      812     4532    3         O_CRITERIA.FORM#     =OD_CXT.SFORM;
      813     4533    3         O_CRITERIA.NOTFORM#=BINBIT(OD_CXT.NOTFORM,1);
      814     4534    3         O_CRITERIA.NOTACCT#=BINBIT(OD_CXT.NOTACCT,1);
      815     4535    3         IF OD_SGHST THEN O_CRITERIA.ACCT#=OD_CXT.SACCT;
      816     4536    3         ELSE
      817     4537    4           DO;
      818     4538    4           IF OD_CXT.SACCT ~= ' ' THEN
      819     4539    4            O_CRITERIA.ACCT#=OD_CXT.SACCT;
      820     4540    4           ELSE IF ALLFLG = 0 THEN O_CRITERIA.ACCT#=B$JIT$->B$JIT.ACCN;
      821     4541    4           END;
      822     4542    3   GETO1: ENTRY ALTRET;
      823     4543    3         GET_STAT.V.OUTPUT#='1'B;
      824     4544    3         GET_STAT.CRITERIA_=VECTOR(O_CRITERIA);
      825     4545    3         O_CRITERIA.WSN#=OD_CXT.SWSN;
      826     4546    3         O_CRITERIA.NOTWSN#=BINBIT(OD_CXT.NOTWSN,1);
      827     4547    3         CALL M$GDP (GETP) ALTRET(NOMEM);
      828     4548    3         OD_CXT.SEG$=GDPVEC.PTR$;
      829     4549    3         GET_STAT.RESULTS_=GDPVEC;
      830     4550    3   LOOP: ;
      831     4551    3         CALL M$JOBSTATS (GET_STAT) ALTRET(JALT);
      832     4552    3   DONE: ;
      833     4553    3         OD_CXT.NFOUND=OD_CXT.SEG$->R$OUTPUT.FOUND;
      834     4554    3         RETURN;
      835     4555    3   JALT: ;
      836     4556    3         IF B$ERRCODE = %E$JSIRAS THEN
      837     4557    4           DO;
      838     4558    4           ADDR(GET_STAT.RESULTS_)->B$$VECTOR.W1.VSIZE#=
      839     4559    4           ADDR(GET_STAT.RESULTS_)->B$$VECTOR.W1.VSIZE#+(ODMI_NPGG#*4096);
      840     4560    4           CALL M$GDP (GETP) ALTRET(NOMEM);
      841     4561    4           GOTO LOOP;
      842     4562    4           END;
      843     4563    3   JALT1:;
      844     4564    3         IF B$ERRCODE = %E$SQRCVR THEN
      845     4565    4           DO;
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:25   
      846     4566    4           OPMSG_KERR.SUBC=ODKE_SQRIP#;
      847     4567    4           ALTRETURN;
      848     4568    4           END;
      849     4569    3         IF B$ERRCODE = %E$NOTFND THEN
      850     4570    4           DO;
      851     4571    4           OD_CXT.NFOUND=0;
      852     4572    4           RETURN;
      853     4573    4           END;
      854     4574    3         IF NOT OD_SGHST THEN CALL M$MERC;
      855     4575    3         OPMSG_KERR.SUBC=ODKE_JSERR#;
      856     4576    3         OPMSG_KERR.ERRC=B$ERRCODE;
      857     4577    3         ALTRETURN;
      858     4578    3   NOMEM:;
      859     4579    3         OPMSG_KERR.SUBC=ODKE_NDATA#;
      860     4580    3         ALTRETURN;
      861     4581
      862     4582
      863     4583    3   GETI: ENTRY ALTRET;
      864     4584    3         I_CRITERIA.NOTACCT#=BINBIT(OD_CXT.NOTACCT,1);
      865     4585    3         IF OD_SGHST THEN I_CRITERIA.ACCT#=OD_CXT.SACCT;
      866     4586    3         ELSE
      867     4587    4           DO;
      868     4588    4           IF OD_CXT.SACCT ~= ' ' THEN
      869     4589    4            I_CRITERIA.ACCT#=OD_CXT.SACCT;
      870     4590    4           ELSE IF ALLFLG = 0 THEN I_CRITERIA.ACCT#=B$JIT$->B$JIT.ACCN;
      871     4591    4           END;
      872     4592    3   GETI1: ENTRY ALTRET;
      873     4593    3         GET_STAT.V.OUTPUT#='0'B;
      874     4594    3         GET_STAT.CRITERIA_=VECTOR(I_CRITERIA);
      875     4595    3         I_CRITERIA.NOTWSN#=BINBIT(OD_CXT.NOTWSN,1);
      876     4596    3         I_CRITERIA.WSN#=OD_CXT.SWSN;
      877     4597    3         CALL M$GDP (GETP3) ALTRET(NOMEM);
      878     4598    3         OD_CXT.SEG$=GDPVEC.PTR$;
      879     4599    3         IF RESLIST = 0 THEN
      880     4600    3          GET_STAT.RESULTS_=GDPVEC;
      881     4601    3         ELSE
      882     4602    4           DO;
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:26   
      883     4603    4           GET_STAT.RESULTS_=VECTOR(OD_CXT.SEG$->B$$PAGE);
      884     4604    4           OD_CXT.RES$=PINCRW(OD_CXT.SEG$,1024);
      885     4605    4           OD_CXT.SN$ =PINCRW(OD_CXT.RES$,1024);
      886     4606    4           GET_STAT.RESLIST_=VECTOR(OD_CXT.RES$->B$$PAGE);
      887     4607    4           GET_STAT.SNLIST_=VECTOR(OD_CXT.SN$->B$$PAGE);
      888     4608    4           END;
      889     4609    3   ILOOP:;
      890     4610    3         CALL M$JOBSTATS (GET_STAT) ALTRET(JIALT);
      891     4611    3         GOTO DONE;
      892     4612    3   JIALT:;
      893     4613    3         IF B$ERRCODE = %E$JSIRAS THEN
      894     4614    4           DO;
      895     4615    4           ADDR(GET_STAT.RESULTS_)->B$$VECTOR.W1.VSIZE#=
      896     4616    4           ADDR(GET_STAT.RESULTS_)->B$$VECTOR.W1.VSIZE#+(ODMI_NPGG#*4096);
      897     4617    4           IF RESLIST ~= 0 THEN
      898     4618    5             DO;
      899     4619    5             OD_CXT.RES$=PINCRW(OD_CXT.RES$,ODMI_NPGG#*1024);
      900     4620    5             ADDR(GET_STAT.RESLIST_)->B$$VECTOR.PTR$=OD_CXT.RES$;
      901     4621    5   GETMORE1: ;
      902     4622    5             OD_CXT.SN$=PINCRW(OD_CXT.SN$,ODMI_NPGG#*1024);
      903     4623    5             ADDR(GET_STAT.SNLIST_)->B$$VECTOR.PTR$=OD_CXT.SN$;
      904     4624    5             END;
      905     4625    4   GETMORE:;
      906     4626    4           CALL M$GDP (GETP) ALTRET(NOMEM);
      907     4627    4           GOTO ILOOP;
      908     4628    4           END;
      909     4629    3         ELSE IF B$ERRCODE = %E$JSIRLS THEN
      910     4630    4            DO;
      911     4631    4            ADDR(GET_STAT.RESLIST_)->B$$VECTOR.W1.VSIZE#=
      912     4632    4            ADDR(GET_STAT.RESLIST_)->B$$VECTOR.W1.VSIZE#+(ODMI_NPGG#*4096);
      913     4633    4            GOTO GETMORE1;
      914     4634    4            END;
      915     4635    3          ELSE IF B$ERRCODE = %E$JSISLS THEN
      916     4636    4             DO;
      917     4637    4             ADDR(GET_STAT.SNLIST_)->B$$VECTOR.W1.VSIZE#=
      918     4638    4             ADDR(GET_STAT.SNLIST_)->B$$VECTOR.W1.VSIZE#+(ODMI_NPGG#*4096);
      919     4639    4             GOTO GETMORE;
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:27   
      920     4640    4             END;
      921     4641    3         GOTO JALT1;
      922     4642    3   END GETO;
      923     4643    2   END SETUP_CXT;
      924     4644
      925     4645
      926     4646
      927     4647
      928     4648
      929     4649        /**************************************
      930     4650         **************************************
      931     4651                    DRIVE_CXT
      932     4652         **************************************
      933     4653         **************************************/
      934     4654        /*D* NAME:         DRIVE_CXT
      935     4655             PURPOSE:      To produce output for a given keyin context
      936     4656             DESCRIPTION:  The keyin context is in
      937     4657                           the busy state and needs the next piece of
      938     4658                           output produced.  This routine writes the
      939     4659                           next item to the appropriate destination,
      940     4660                           and then if more output is required, ALTRETs,
      941     4661                           or if all output has been produced, returns
      942     4662                           after doing all required cleanup (e.g. releasing
      943     4663                           the keyin context).
      944     4664
      945     4665                           If the display is to LP, we produce the entire
      946     4666                           display before returning.  This enables us to
      947     4667                           use only one output DCB for LP displays, because
      948     4668                           the DCB is opened in SETUP_CXT, and written and
      949     4669                           then closed here. */
      950     4670    1   DRIVE_CXT: PROC ALTRET;
      951     4671
      952     4672    2   DRIVE:;
      953     4673    3           DO CASE (OD_CXT.KIN#);
      954     4674    3             CASE (KEY_DISPNSFORM#);
      955     4675    3               CALL ODF$FORMAT (ODFT_OUTNS#);
      956     4676    3             CASE (KEY_DISPOUTPUT#);
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:28   
      957     4677    3   DISPOUTPUT: ;
      958     4678    3               CALL ODF$FORMAT (ODFT_OUTSF#);
      959     4679    3             CASE (KEY_DISPPRIO#);
      960     4680    3   DISPPRIO:   ;
      961     4681    3               CALL ODF$FORMAT (ODFT_INPRI#);
      962     4682    3             CASE (KEY_DISPDEFER#);
      963     4683    3   DISPDEFER:  ;
      964     4684    3               CALL ODF$FORMAT (ODFT_INDFR#);
      965     4685    3             CASE (KEY_DISPJOB#);
      966     4686    3   DISPJOB:    ;
      967     4687    3               CALL ODF$FORMAT (ODFT_INRUN#);
      968     4688    3             CASE (KEY_DISPINPUT#);
      969     4689    3   DISPINPUT:  ;
      970     4690    3               BUF$=ADDR(OD_CXT.SEG$->R$INPUT.J(OD_CXT.NDONE));
      971     4691    4                 DO CASE (BUF$->A$INPUT.PRIO);
      972     4692    4                   CASE (%JP_RUN#);
      973     4693    4                     GOTO DISPJOB;
      974     4694    4                   CASE (%JP_RUNAFTER#);
      975     4695    4                     GOTO DISPDEFER;
      976     4696    4                   CASE (%JP_WPART#,%JP_WPS#);
      977     4697    4                     GOTO DISPNORUN;
      978     4698    4                   CASE (%JP_FOLL#);
      979     4699    4   DISPFOLL:         ;
      980     4700    4                     CALL ODF$FORMAT (ODFT_INFOL#);
      981     4701    4                   CASE (ELSE);
      982     4702    4                     GOTO DISPPRIO;
      983     4703    4                 END;
      984     4704    3             CASE (KEY_DISPALL#);
      985     4705    3               IF OD_CXT.INPCOMP ~= 0 THEN GOTO DISPOUTPUT;
      986     4706    3               GOTO DISPINPUT;
      987     4707    3             CASE (KEY_DISPSYSID#);
      988     4708    3               IF OD_CXT.INPCOMP ~= 0 THEN GOTO DISPOUTPUT;
      989     4709    3               IF OD_CXT.FULL = 0 THEN GOTO DISPINPUT;
      990     4710                                /* FULL DISPLAY OF WAITING JOB */
      991     4711    3               CALL ODF$FORMAT (ODFT_SYSID#);
      992     4712    3             CASE (KEY_DISPNORUN#);
      993     4713    3   DISPNORUN:  ;
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:29   
      994     4714    3               CALL ODF$FORMAT (ODFT_NORUN#);
      995     4715
      996     4716    3           END;
      997     4717
      998     4718
      999     4719                                /* FALL THRU TO HERE AFTER PRODUCING ONE
     1000     4720                                   ITEM OF DISPLAY */
     1001     4721
     1002     4722    2         OD_CXT.NDONE=OD_CXT.NDONE+1;
     1003     4723    2         IF OD_CXT.NDONE < OD_CXT.NFOUND
     1004     4724    2         AND OD_INT = 0 THEN
     1005     4725    3           DO;
     1006     4726                           /* NOT DONE YET */
     1007     4727                                /* FORCE = 2 MEANS SHORT DISPLAY UNLESS
     1008     4728                                   ON LP */
     1009     4729    3           IF OD_CXT.ONLP ~= 0 THEN GOTO DRIVE;
     1010     4730    3           IF OD_CXT.FORCE ~= 2
     1011     4731    3           OR OD_CXT.NDONE < ODMI_ITMX# THEN ALTRETURN;
     1012     4732    3           END;
     1013     4733
     1014     4734
     1015     4735                           /* FINISHED */
     1016     4736    2         OPMSG_RESP.CADDR=OD_CXT.CADDR;                                   /*#13.38*/
     1017     4737    2         OPMSG_RESP.NDISPED=OD_CXT.NDISPED;                               /*#13.38*/
     1018     4738    2         OPMSG_RESP.SUBC=ODKR_DISPD#;                                        /*#13.38*/
     1019     4739    2         CALL RELMEM_CXT;
     1020     4740    2         IF  OD_CXT.KIN# = KEY_DISPALL#
     1021     4741    2         AND OD_CXT.ONLP ~= 0 THEN
     1022     4742    2          IF OD_CXT.INPCOMP = 0 THEN
     1023     4743    3            DO;
     1024     4744    3            OD_CXT.INPCOMP=1;
     1025     4745    3            CALL SETUP_CXT ALTRET(MARCH_ON);
     1026     4746    3            GOTO DRIVE;
     1027     4747    3            END;
     1028     4748    2         IF OD_CXT.ONLP ~= 0 THEN
     1029     4749    3           DO;
     1030     4750    3           CALL M$CLOSE (CLOSE_LO);
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:30   
     1031     4751    3           IF OD_SGHST THEN
     1032     4752    4             DO;
     1033     4753    4             CALL M$WRITE (OCMSG_RESP);
     1034     4754    4             END;
     1035     4755    3           END;
     1036     4756    2         IF  OD_CXT.INOUT ~= 0
     1037     4757    2         AND OD_CXT.INPCOMP = 0
     1038     4758    2         AND OD_INT = 0 THEN
     1039     4759    3           DO;
     1040     4760    3           OD_CXT.INPCOMP=1;
     1041     4761    3           CALL SETUP_CXT ALTRET(MARCH_ON1);
     1042     4762    3           GOTO DRIVE;
     1043     4763    3   MARCH_ON1:;
     1044     4764    3           END;
     1045     4765    2         RETURN;
     1046     4766    2   MARCH_ON:;                                                                /*#13.38*/
     1047     4767    2         CALL M$CLOSE (CLOSE_LO);                                            /*#13.38*/
     1048     4768    2         IF OD_SGHST THEN                                                    /*#13.38*/
     1049     4769    3           DO;                                                               /*#13.38*/
     1050     4770    3           CALL M$WRITE (OCMSG_RESP);                                        /*#13.38*/
     1051     4771    3           END;                                                              /*#13.38*/
     1052     4772    2         RETURN;                                                             /*#13.38*/
     1053     4773    2   END DRIVE_CXT;
     1054     4774
     1055     4775
     1056     4776
     1057     4777
     1058     4778        /**************************************
     1059     4779         **************************************
     1060     4780                    RELMEM_CXT
     1061     4781         **************************************
     1062     4782         **************************************/
     1063     4783        /*D* NAME:         RELMEM_CXT
     1064     4784             PURPOSE:      To release the memory in a context's buffer segment
     1065     4785        */
     1066     4786    1   RELMEM_CXT: PROC;
     1067     4787    2         CALL M$FDP (RELP) ALTRET(A1);
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:31   
     1068     4788    2   A1:   ;
     1069     4789    2         RETURN;
     1070     4790    2   END RELMEM_CXT;
     1071     4791        /**************************************
     1072     4792         **************************************
     1073     4793                    MISC_SETUP
     1074     4794         **************************************
     1075     4795         **************************************/
     1076     4796    1   MISC_SETUP: PROC;
     1077     4797    2         CALL M$DISPRES (GET_PSEUDOS);
     1078     4798    2   END MISC_SETUP;
     1079     4799    1   END ODD$DOG;

PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:32   
--  Include file information  --

   XSJ_SUBS_C.:E05TOU  is referenced.
   XSJ_MAC_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   KC_ERRORS_C.:E05TOU  is referenced.
   FO_ERRORS_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   OD_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   OD_MAC_C.:E05TOU  is referenced.
   OD_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ODD$DOG.

   Procedure ODD$DOG requires 1008 words for executable code.
   Procedure ODD$DOG requires 94 words of local(AUTO) storage.

    No errors detected in file ODD$DOG.:E05TSI    .

PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:33   

 Object Unit name= ODD$DOG                                    File name= ODD$DOG.:E05TOU
 UTS= JUL 30 '97 04:10:13.88 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none   230    346  ODD$DOG
    2  RoData even  UTS    345    531  ODD$DOG
    3   DCB   even  none     0      0  M$CSCG
    4   DCB   even  none     0      0  M$LO
    5   DCB   even  none     0      0  M$SI
    6   DCB   even  none     0      0  M$ME
    7   DCB   even  none     0      0  M$JSF
    8   Proc  even  none  1008   1760  ODD$DOG
    9  RoData even  none    22     26  ODD$DOG

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     8      0   yes            yes      Main       0  ODD$DOG
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:34   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          Async      0 ODE$XCON
         yes          Async      0 ODE$EVNT
 yes     yes           Std       1 XSJ$CLOSE
 yes     yes           Std       1 ODP$PARSE
 yes     yes           Std       1 XSJ$OPEN
 yes     yes           Std       1 XSJ$READ
         yes           Std       1 ODF$FORMAT
                       nStd      0 X66_MAUTO
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_MARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  OD_CSCGBUF                            OD_SGHST
     OD_INT                                OD_OBMAX                              OD_CXT_INIT
     OD_CXT                                OD_READCSCG                           OD_PSEUDOS
     M$CSCG                                M$LO                                  M$SI
     M$ME                                  M$JSF                                 B$JIT$
     B$TCB$                                B_VERSION                             B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID                                 ROSID
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:35   


        1        1        /*M* ODD$DOG Main routine for DOG ghost */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7       /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*P* NAME:         ODD$DOG
       10       10
       11       11             PURPOSE:      To provide the main routine for the DOG ghost
       12       12
       13       13             DESCRIPTION:  The system ghost DOG is responsible for the
       14       14                           various forms of the DISP keyin.
       15       15
       16       16                           The DISP keyin has several forms (e.g. DISP JOB,
       17       17                           DISP OUTPUT, etc.).  KEYIN sends all of these
       18       18                           keyins to station DOG on the CSCG, which is in
       19       19                           fact the DOG ghost.  DOG then processes the keyin,
       20       20                           which usually involves issuing some form of the
       21       21                           M$JOBSTATS PMME, and sends the requested information
       22       22                           to the requesting console by means of templated
       23       23                           writes through KEYIN.
       24       24
       25       25                           DOG can also be run as a normal processor, by
       26       26                           invoking DOG.:SYS in an online or batch user.
       27       27                           In this mode, DOG will accept commands which
       28       28                           are the analogues of the operator keyins,
       29       29                           and display the same information thru M$ME.
       30       30                           The difference is that the user of DOG can
       31       31                           only see jobs in his account, unless he
       32       32                           has DISPJOB privilege.  See the *P* for
       33       33                           ODP$PARSE for more details.
       34       34        */
       35       35        /**/
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:36   
       36       36        ODD$DOG: PROC MAIN;

     36  8 000000   000000 700200 xent  ODD$DOG      TSX0  ! X66_MAUTO
         8 000001   000136 000000                    ZERO    94,0

       37       37        /**/
       38       38
       39       39
       40       40
       41       41        /**/
       42       42        /* INCLUDES */
       43       43        /**/
       44       44        %INCLUDE CP_6;
       45      125        %INCLUDE CP_6_SUBS;
       46      665        %INCLUDE OC_MESSHD_C;
       47      718        %INCLUDE OC_SUBS_C;
       48     1449        %INCLUDE OD_SUBS_C;
       49     1510        %INCLUDE OD_MAC_C;
       50     1598 S      %INCLUDE B$JIT_C;
       51     1599        %INCLUDE JG_GHOSTS_C;
       52     1689        %INCLUDE OD_DATA_R;
       53     1915        %INCLUDE NK_SUBS;
       54     1940        %INCLUDE F_ERRORS_C;
       55     2180        %INCLUDE FO_ERRORS_C;
       56     2212        %INCLUDE KC_ERRORS_C;
       57     2259        %INCLUDE F$DCB;
       58     2308        %INCLUDE XSJ_MAC_C;
       59     2387        %INCLUDE XSJ_SUBS_C;
       60     2414
       61     2415
       62     2416
       63     2417        /**/
       64     2418        /* BASED STRUCTURES */
       65     2419        /**/
       66     2420        %B$JIT0(STCLASS=BASED);
       67     2509        %A$JIT6X;
       68     2512        %B$TCB;
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:37   
       69     2515        %B$ALT;
       70     2523        %VLR_JOBSTATS_OSRCH     (FPTN=R$OUTPUT,STCLASS=BASED,NFIL=0);
       71     2537        %VLA_JOBSTATS_OSRCH     (FPTN=A$OUTPUT,STCLASS=BASED);
       72     2554        %VLR_JOBSTATS_ISRCH     (FPTN=R$INPUT ,STCLASS=BASED,NJOB=0);
       73     2568        %VLA_JOBSTATS_ISRCH     (FPTN=A$INPUT ,STCLASS=BASED);
       74     2595        %VLR_JOBSTATS_ISRCH_SN  (FPTN=A$SN    ,STCLASS=BASED,NSN =0);
       75     2608        %VLR_JOBSTATS_ISRCH_RES (FPTN=A$RES   ,STCLASS=BASED,NRES=0);
       76     2621    1   DCL B$CHARS CHAR(K) BASED DALIGNED;
       77     2622    1   DCL B$$PAGE (0:1023) UBIN WORD ALIGNED BASED;
       78     2623        %VLP_VECTOR (FPTN=B$$VECTOR,STCLASS=BASED);
       79     2638        %OD_KEYIN     (FPTN=OD$KEYIN,STCLASS=BASED);
       80     2682
       81     2683
       82     2684
       83     2685        /**/
       84     2686        /* AUTO */
       85     2687        /**/
       86     2688    1   DCL I UBIN WORD;
       87     2689        %VLP_CRITERIA (FPTN=O_CRITERIA,STCLASS=AUTO);
       88     2717        %VLP_CRITERIA (FPTN=I_CRITERIA,STCLASS=AUTO);
       89     2745    1   DCL J UBIN WORD;
       90     2746    1   DCL K UBIN WORD;
       91     2747    1   DCL RESLIST UBIN WORD;
       92     2748    1   DCL BUF$ PTR;
       93     2749    1   DCL SN$ PTR;
       94     2750    1   DCL RES$ PTR;
       95     2751        %FPT_JOBSTATS (FPTN=GET_STAT,STCLASS=AUTO);
       96     2771
       97     2772
       98     2773
       99     2774        /**/
      100     2775        /* STATIC */
      101     2776        /**/
      102     2777    1   DCL ALLFLG UBIN WORD STATIC ALIGNED INIT(0);
      103     2778    1   DCL 1 HIMSG CHAR(15) STATIC INIT (' ');
      104     2779    1   DCL EHMSG CHAR(8) STATIC ALIGNED INIT('...EH?');
      105     2780    1   DCL NONEMSG CHAR(8) STATIC ALIGNED INIT('...NONE');
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:38   
      106     2781    1   DCL 1 TMMSG STATIC,
      107     2782    1         2 * CHAR(4) UNAL INIT('....'),
      108     2783    1         2 NUM CHAR(4) UNAL,
      109     2784    1         2 * CHAR(12) UNAL INIT(' ITEMS FOUND');
      110     2785    1   DCL NOMEMMSG CHAR(32) STATIC ALIGNED INIT('...INSUFFICIENT DYNAMIC MEMORY');
      111     2786    1  DCL SQRIPMSG CHAR(40) STATIC ALIGNED INIT('...SYMBIONT QUEUES RECOVERY IN PROGRESS')
              2786            ;
      112     2787        %XSJ_PARAM              (FPTN=JOPN,
      113     2788                 MODE      = %IN#,
      114     2789                 DCB       = M$JSF,
      115     2790                 STCLASS   = STATIC);
      116     2807        %XSJ_JOBINFO  (FPTN=JREC,STCLASS=STATIC);
      117     2822        %XSJ_PARAM              (FPTN=JREAD,
      118     2823                 DCB       = M$JSF,
      119     2824                 TYPE      = %TYP_INFO#,
      120     2825                 BUF       = JREC,
      121     2826                 STCLASS   = STATIC);
      122     2843    1   DCL GOODNGT UBIN WORD STATIC ALIGNED INIT(0);
      123     2844        %OC_MESSHD_D            (NAME=ZAPRESP,
      124     2845                 STCLASS   = CONSTANT,
      125     2846                 FUNC      = ZAP,
      126     2847                 DELIM     =";");
      127     2860        %OC_MESSHD_D       (NAME=OPMSG_KERR,
      128     2861            NPARMS    = 13,
      129     2862            ATR       = M_UR,
      130     2863            MSG       = OD_KERR_MSG#,
      131     2864            STCLASS   = STATIC);
      132     2877    1         2 * UBIN BYTE UNAL INIT(1),
      133     2878    1         2 * UBIN BYTE UNAL INIT(2),
      134     2879    1         2 * UBIN BYTE UNAL INIT(2),
      135     2880    1         2 * UBIN BYTE UNAL INIT(2),
      136     2881    1         2 * UBIN BYTE UNAL INIT(1),
      137     2882    1         2 * UBIN BYTE UNAL INIT(8),
      138     2883    1         2 * UBIN BYTE UNAL INIT(8),
      139     2884    1         2 * UBIN BYTE UNAL INIT(8),
      140     2885    1         2 * UBIN BYTE UNAL INIT(1),
      141     2886    1         2 * UBIN BYTE UNAL INIT(1),
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:39   
      142     2887    1         2 * UBIN BYTE UNAL INIT(1),
      143     2888    1         2 * UBIN BYTE UNAL INIT(6),
      144     2889    1         2 * UBIN BYTE UNAL INIT(8),
      145     2890    1         2 SUBC UBIN BYTE UNAL,
      146     2891    1         2 NFOUND UBIN HALF UNAL,
      147     2892    1         2 ERRC UBIN HALF UNAL,
      148     2893    1         2 DEVTYP CHAR(2) UNAL,
      149     2894    1         2 PWSN UBIN BYTE UNAL,
      150     2895    1         2 ATWSN CHAR(8) UNAL,
      151     2896    1         2 ATTERM CHAR(8) UNAL,
      152     2897    1         2 ACCT CHAR(8) UNAL,
      153     2898    1         2 NOTACCT UBIN BYTE UNAL,
      154     2899    1         2 NOTFORM UBIN BYTE UNAL,
      155     2900    1         2 NOTWSN UBIN BYTE UNAL,
      156     2901    1         2 NOTTERM REDEF NOTWSN UBIN BYTE UNAL,
      157     2902    1         2 FORM CHAR(6) UNAL,
      158     2903    1         2 LPWSN CHAR(8) UNAL;
      159     2904        %OC_MESSHD_D            (NAME=OPMSG_RESP,
      160     2905                 NPARMS    = 2,
      161     2906                 ATR       = M_UR,
      162     2907                 MSG       = OD_RESP_MSG#,
      163     2908                 STCLASS   = STATIC);
      164     2921    1         2 * UBIN BYTE UNAL INIT(4),
      165     2922    1         2 * UBIN BYTE UNAL INIT(4),
      166     2923    1         2 SUBC UBIN WORD UNAL,
      167     2924    1         2 NDISPED UBIN WORD UNAL;
      168     2925        %OC_MESSHD_D            (NAME=OPMSG_UNIMP,
      169     2926                 NPARMS    = 0,
      170     2927                 ATR       = M_UR,
      171     2928                 MSG       = UNIMP_MSG#,
      172     2929                 DELIM     =";",
      173     2930                 STCLASS   = STATIC);
      174     2943        %OC_MESSHD_D            (NAME=OPMSG_ILLKEY,
      175     2944                 NPARMS    = 1,
      176     2945                 ATR       = M_UR,
      177     2946                 MSG       = GENL_ERR_MSG#,
      178     2947                 STCLASS   = STATIC);
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:40   
      179     2960    1         2 * UBIN BYTE UNAL INIT(1),
      180     2961    1         2 SUBC UBIN BYTE UNAL INIT(16);
      181     2962
      182     2963
      183     2964
      184     2965        /**/
      185     2966        /* DCBS */
      186     2967        /**/
      187     2968    1   DCL M$CSCG DCB;
      188     2969    1   DCL M$LO DCB;
      189     2970    1   DCL M$SI DCB;
      190     2971    1   DCL M$ME DCB;
      191     2972    1   DCL M$JSF DCB;
      192     2973
      193     2974
      194     2975
      195     2976        /**/
      196     2977        /* REFS */
      197     2978        /**/
      198     2979    1   DCL B$JIT$ PTR SYMREF;
      199     2980    1   DCL B$TCB$ PTR SYMREF;
      200     2981    1   DCL FOI$GBUF      ENTRY(2) ALTRET;
      201     2982    1   DCL FOI$RBUF      ENTRY(2) ALTRET;
      202     2983    1   DCL ODE$EVNT      ENTRY    ASYNC;
      203     2984    1   DCL ODE$XCON      ENTRY    ASYNC;
      204     2985    1   DCL ODF$FORMAT    ENTRY(1);
      205     2986    1   DCL ODP$PARSE     ENTRY(1) ALTRET;
      206     2987    1   DCL XSJ$CLOSE     ENTRY(1) ALTRET;
      207     2988    1   DCL XSJ$OPEN      ENTRY(1) ALTRET;
      208     2989    1   DCL XSJ$READ      ENTRY(1) ALTRET;
      209     2990
      210     2991    1   DCL 1 B_VERSION SYMREF ALIGNED,
      211     2992    1         2 L# UBIN(9) UNAL,
      212     2993    1         2 TXT CHAR(B_VERSION.L#) UNAL;
      213     2994
      214     2995
      215     2996
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:41   
      216     2997        /**/
      217     2998        /* PMME FPTS */
      218     2999        /**/
      219     3000        %FPT_XCON                              (FPTN=XCONSET,
      220     3001                 STCLASS   = CONSTANT,
      221     3002                 UENTRY    = ODE$XCON);
      222     3016        %FPT_INT                               (FPTN=INTSET,
      223     3017                 UENTRY    = ODE$EVNT,
      224     3018                 STCLASS   = CONSTANT);
      225     3032        %FPT_OPEN                              (FPTN=OPEN_CSCG,
      226     3033                 DCB       = M$CSCG,
      227     3034                 SCRUB     = YES,
      228     3035                 NAME      = CSCGNAME,
      229     3036                 SETSTA    = DOGNAME,
      230     3037                 ASN       = COMGROUP,
      231     3038                 FUN       = UPDATE,
      232     3039                 STCLASS   = CONSTANT);
      233     3148        %VLP_NAME          (FPTN=CSCGNAME,
      234     3149                 NAME      = 'CSCG',
      235     3150                 STCLASS   = CONSTANT);
      236     3177        %VLP_SETSTA        (FPTN=DOGNAME,
      237     3178                   MYSTATION='DOG',
      238     3179                   OSTATION='KEYIN',
      239     3180                   DIRONLY=YES,
      240     3181                   STCLASS=CONSTANT);
      241     3209        %FPT_WRITE                             (FPTN=WRITE_ZAPRESP,
      242     3210                 BUF       = ZAPRESP,
      243     3211                 DCB       = M$CSCG,
      244     3212                 STCLASS   = CONSTANT);
      245     3243        %FPT_WRITE                             (FPTN=OCMSG_KERR,
      246     3244                 BUF       = OPMSG_KERR,
      247     3245                 DCB       = M$CSCG,
      248     3246                 STCLASS   = CONSTANT);
      249     3277        %FPT_WRITE                             (FPTN=OCMSG_RESP,
      250     3278                 BUF       = OPMSG_RESP,
      251     3279                 DCB       = M$CSCG,
      252     3280                 STCLASS   = CONSTANT);
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:42   
      253     3311        %FPT_WRITE                             (FPTN=OCMSG_ILLKEY,
      254     3312                 BUF       = OPMSG_ILLKEY,
      255     3313                 DCB       = M$CSCG,
      256     3314                 STCLASS   = CONSTANT);
      257     3345        %FPT_WRITE                             (FPTN=OCMSG_UNIMP,
      258     3346                 BUF       = OPMSG_UNIMP,
      259     3347                 DCB       = M$CSCG,
      260     3348                 STCLASS   = CONSTANT);
      261     3379        %FPT_JOBSTATS                          (FPTN=STAT_FPT,
      262     3380                 ORDER     = SRCH,
      263     3381                 STCLASS   = STATIC);
      264     3401        %VLP_CRITERIA                          (FPTN=STAT_CRITERIA,
      265     3402                 STCLASS   = STATIC);
      266     3430        %FPT_OPEN                              (FPTN=OPEN_LOGHST,
      267     3431                 DCB       = M$LO,
      268     3432                 ASN       = DEVICE,
      269     3433                 RES       = 'LP',
      270     3434                 FUN       = CREATE,
      271     3435                 SCRUB     = YES,
      272     3436                 STCLASS   = STATIC);
      273     3545        %FPT_OPEN                              (FPTN=OPEN_LOUSER,
      274     3546                 DCB       = M$LO,
      275     3547                 STCLASS   = CONSTANT);
      276     3656        %VLP_WSN           (FPTN=SC_LPWSN,
      277     3657                 WSN       = '@',
      278     3658                 STCLASS   = CONSTANT);
      279     3671        %FPT_CLOSE                             (FPTN=CLOSE_LO,
      280     3672                 DCB       = M$LO,
      281     3673                 DISP      = SAVE,
      282     3674                 STCLASS   = CONSTANT);
      283     3716        %FPT_RESCTL                            (FPTN=GET_PSEUDOS,
      284     3717                 PSEUDO    = OD_PSEUDOS,
      285     3718                 MBSDISP   = YES,
      286     3719                 STCLASS   = STATIC);
      287     3736        %FPT_READ                              (FPTN=READ_SI,
      288     3737                 STCLASS   = CONSTANT,
      289     3738                 DCB       = M$SI,
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:43   
      290     3739                 BUF       = OD_CSCGBUF,
      291     3740                 WAIT      = YES);
      292     3779        %FPT_WRITE                             (FPTN=WRITE_SQRIP,
      293     3780                 STCLASS   = CONSTANT,
      294     3781                 DCB       = M$ME,
      295     3782                 VFC       = NO,
      296     3783                 BUF       = SQRIPMSG);
      297     3814        %FPT_WRITE                             (FPTN=WRITE_HI,
      298     3815                 STCLASS   = CONSTANT,
      299     3816                 DCB       = M$ME,
      300     3817                 VFC       = NO,
      301     3818                 BUF       = HIMSG);
      302     3849        %FPT_WRITE                             (FPTN=WRITE_EH,
      303     3850                 STCLASS   = CONSTANT,
      304     3851                 DCB       = M$ME,
      305     3852                 VFC       = NO,
      306     3853                 BUF       = EHMSG);
      307     3884        %FPT_WRITE                             (FPTN=WRITE_NONE,
      308     3885                 STCLASS   = CONSTANT,
      309     3886                 DCB       = M$ME,
      310     3887                 VFC       = NO,
      311     3888                 BUF       = NONEMSG);
      312     3919        %FPT_WRITE                             (FPTN=WRITE_NOMEM,
      313     3920                 STCLASS   = CONSTANT,
      314     3921                 DCB       = M$ME,
      315     3922                 VFC       = NO,
      316     3923                 BUF       = NOMEMMSG);
      317     3954        %FPT_WRITE                             (FPTN=WRITE_TM,
      318     3955                 STCLASS   = CONSTANT,
      319     3956                 DCB       = M$ME,
      320     3957                 VFC       = NO,
      321     3958                 BUF       = TMMSG);
      322     3989        %FPT_GDP                              (FPTN=GETP,
      323     3990                 PAGES     = ODMI_NPGG#,
      324     3991                 RESULTS   = GDPVEC,
      325     3992                 STCLASS   = CONSTANT);
      326     4006        %FPT_GDP                              (FPTN=GETP3,
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:44   
      327     4007                 PAGES     = 3,
      328     4008                 RESULTS   = GDPVEC,
      329     4009                 STCLASS   = CONSTANT);
      330     4023        %VLP_VECTOR                           (FPTN=GDPVEC,
      331     4024                 STCLASS   = STATIC);
      332     4039        %FPT_FDP                              (FPTN=RELP,
      333     4040                 PAGES     = 512,
      334     4041                 RESULTS   = GDPVEC,
      335     4042                 STCLASS   = CONSTANT);
      336     4056
      337     4057
      338     4058
      339     4059        /**/
      340     4060        /* SUBS */
      341     4061        /**/
      342     4062        %SUB B$ERRCODE = B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE;
      343     4063        %SUB FOREVER="WHILE ('1'B)";
      344     4064        %EJECT;
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:45   
      345     4065        /**/
      346     4066        /**/
      347     4067        /* BEGIN HERE */
      348     4068        /**/
      349     4069
      350     4070
      351     4071    1         IF B$JIT$->B$JIT.USER = JG_DOG# THEN

   4071  8 000002   000000 470400 xsym               LDP0    B$JIT$
         8 000003   000000 236100                    LDQ     0,,PR0
         8 000004   000777 376003                    ANQ     511,DU
         8 000005   000011 116003                    CMPQ    9,DU
         8 000006   000022 601000 8                  TNZ     s:4084

      352     4072    2           DO;

      353     4073    2           OD_SGHST='1'B;

   4073  8 000007   400000 236003                    LDQ     -131072,DU
         8 000010   000000 756000 xsym               STQ     OD_SGHST

      354     4074
      355     4075                                /* GET XCON */
      356     4076    2           CALL M$XCON (XCONSET);

   4076  8 000011   000006 630400 2                  EPPR0   XCONSET
         8 000012   010003 713400                    CLIMB   4099
         8 000013   400400 401760                    pmme    nvectors=2

      357     4077                                /* SET UP GOODIES */
      358     4078    2           CALL MISC_SETUP;

   4078  8 000014   001751 701000 8                  TSX1    MISC_SETUP
         8 000015   000000 011000                    NOP     0

      359     4079                                /* CONNECT TO CS COMGROUP */
      360     4080    2           CALL M$OPEN (OPEN_CSCG);
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:46   

   4080  8 000016   000020 630400 2                  EPPR0   OPEN_CSCG
         8 000017   050000 713400                    CLIMB   open
         8 000020   410400 401760                    pmme    nvectors=18

      361     4081    2           END;

   4081  8 000021   000077 710000 8                  TRA     s:4117

      362     4082    1         ELSE
      363     4083    2           DO;

      364     4084    2           OD_SGHST='0'B;

   4084  8 000022   000000 450000 xsym               STZ     OD_SGHST

      365     4085    2           CALL MISC_SETUP;

   4085  8 000023   001751 701000 8                  TSX1    MISC_SETUP
         8 000024   000000 011000                    NOP     0

      366     4086    2           CALL M$INT (INTSET);

   4086  8 000025   000014 630400 2                  EPPR0   INTSET
         8 000026   010002 713400                    CLIMB   4098
         8 000027   400000 401760                    pmme    nvectors=1

      367     4087    2           CALL CONCAT (HIMSG,'DOG ',SUBSTR(B_VERSION.TXT, 0,

   4087  8 000030   000000 236000 xsym               LDQ     B_VERSION
         8 000031   000033 772000                    QRL     27
         8 000032   000000 620006                    EAX0    0,QL
         8 000033   000526 236000 2                  LDQ     RELP+6
         8 000034   000001 756000 1                  STQ     HIMSG
         8 000035   040000 100440                    MLR     fill='040'O
         8 000036   000000 200010 xsym               ADSC9   B_VERSION                cn=1,n=*X0
         8 000037   000002 000013 1                  ADSC9   HIMSG+1                  cn=0,n=11
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:47   
         8 000040   000000 636010                    EAQ     0,X0
         8 000041   000022 772000                    QRL     18
         8 000042   000013 116007                    CMPQ    11,DL
         8 000043   000054 603000 8                  TRC     s:4089
         8 000044   200134 740100                    STX0    GET_STAT+42,,AUTO
         8 000045   777764 620010                    EAX0    -12,X0
         8 000046   777777 660003                    ERX0    -1,DU
         8 000047   200134 235100                    LDA     GET_STAT+42,,AUTO
         8 000050   000022 771000                    ARL     18
         8 000051   040045 100400                    MLR     fill='040'O
         8 000052   000527 000005 2                  ADSC9   RELP+7                   cn=0,n=5
         8 000053   000002 000010 1                  ADSC9   HIMSG+1,A                cn=0,n=*X0

      368     4088    2           B_VERSION.L#),' Here');
      369     4089    2           CALL M$WRITE (WRITE_HI);

   4089  8 000054   000410 630400 2                  EPPR0   WRITE_HI
         8 000055   040001 713400                    CLIMB   write
         8 000056   401400 401760                    pmme    nvectors=4

      370     4090    2           IF DCBADDR(DCBNUM(M$ME))->F$DCB.WIDTH ~= 0 THEN

   4090  8 000057   000000 236007 xsym               LDQ     M$ME,DL
         8 000060   000000 470400 9                  LDP0    0
         8 000061   000000 471500                    LDP1    0,,PR0
         8 000062   100000 473506                    LDP3    0,QL,PR1
         8 000063   300004 236100                    LDQ     4,,PR3
         8 000064   000777 316007                    CANQ    511,DL
         8 000065   000077 600000 8                  TZE     s:4117

      371     4091    3             DO;

      372     4092    3             OD_OBMAX= DCBADDR(DCBNUM(M$ME))->F$DCB.WIDTH;

   4092  8 000066   000000 236007 xsym               LDQ     M$ME,DL
         8 000067   100000 473506                    LDP3    0,QL,PR1
         8 000070   300004 236100                    LDQ     4,,PR3
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:48   
         8 000071   000777 376007                    ANQ     511,DL
         8 000072   000000 756000 xsym               STQ     OD_OBMAX

      373     4093    3             IF OD_OBMAX > ODMI_OBSZ# THEN OD_OBMAX=ODMI_OBSZ#;

   4093  8 000073   000205 116007                    CMPQ    133,DL
         8 000074   000077 602000 8                  TNC     s:4117

   4093  8 000075   000204 235007                    LDA     132,DL
         8 000076   000000 755000 xsym               STA     OD_OBMAX

      374     4094    3             END;

      375     4095    2           END;

      376     4096        %EJECT;
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:49   
      377     4097        /*
      378     4098
      379     4099                    #   #    ###     ###    #   #
      380     4100                    ## ##   #   #     #     #   #
      381     4101                    # # #   #   #     #     ##  #
      382     4102                    #   #   #####     #     # # #
      383     4103                    #   #   #   #     #     #  ##
      384     4104                    #   #   #   #     #     #   #
      385     4105                    #   #   #   #    ###    #   #
      386     4106
      387     4107
      388     4108                    #        ###     ###    ####
      389     4109                    #       #   #   #   #   #   #
      390     4110                    #       #   #   #   #   #   #
      391     4111                    #       #   #   #   #   ####
      392     4112                    #       #   #   #   #   #
      393     4113                    #       #   #   #   #   #
      394     4114                    #####    ###     ###    #
      395     4115
      396     4116        */
      397     4117    1         IF OD_SGHST THEN

   4117  8 000077   000000 235000 xsym               LDA     OD_SGHST
         8 000100   000140 600000 8                  TZE     s:4142

      398     4118    2           DO FOREVER;

      399     4119    2           CALL M$READ (OD_READCSCG);

   4119  8 000101   000000 630400 xsym               EPPR0   OD_READCSCG
         8 000102   040000 713400                    CLIMB   read
         8 000103   401400 401760                    pmme    nvectors=4

      400     4120    2           OD_CXT=OD_CXT_INIT;

   4120  8 000104   000000 100400                    MLR     fill='000'O
         8 000105   000000 000130 xsym               ADSC9   OD_CXT_INIT              cn=0,n=88
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:50   
         8 000106   000000 000130 xsym               ADSC9   OD_CXT                   cn=0,n=88

      401     4121    2           ADDR(OD_CXT.KIN#)->OD$KEYIN=ADDR(OD_CSCGBUF)->OD$KEYIN;

   4121  8 000107   000000 100400                    MLR     fill='000'O
         8 000110   000000 000100 xsym               ADSC9   OD_CSCGBUF               cn=0,n=64
         8 000111   000006 000100 xsym               ADSC9   OD_CXT+6                 cn=0,n=64

      402     4122    2           IF OD_CXT.KIN# = KEY_ZAP# THEN

   4122  8 000112   000006 220000 xsym               LDX0    OD_CXT+6
         8 000113   000067 100003                    CMPX0   55,DU
         8 000114   000127 601000 8                  TNZ     s:4129

      403     4123    3             DO;

      404     4124    3             CALL M$WRITE (WRITE_ZAPRESP);

   4124  8 000115   000130 630400 2                  EPPR0   WRITE_ZAPRESP
         8 000116   040001 713400                    CLIMB   write
         8 000117   401400 401760                    pmme    nvectors=4

      405     4125    3             GOODNGT=1;

   4125  8 000120   000001 235007                    LDA     1,DL
         8 000121   000066 755000 1                  STA     GOODNGT

      406     4126    3             CALL XSJ$CLOSE (JOPN) ALTRET(ZAP01);

   4126  8 000122   000001 630400 9                  EPPR0   1
         8 000123   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 000124   000000 701000 xent               TSX1    XSJ$CLOSE
         8 000125   000126 702000 8                  TSX2    ZAP01

   4125  8 000126                       ZAP01        null
      407     4127    3   ZAP01:    ;
      408     4128    3             END;
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:51   

   4128  8 000126   000101 710000 8                  TRA     s:4119

      409     4129    2           ELSE IF GOODNGT = 0 THEN

   4129  8 000127   000066 235000 1                  LDA     GOODNGT
         8 000130   000101 601000 8                  TNZ     s:4119

      410     4130    3              DO;

      411     4131    3              OPMSG_KERR.CADDR=OD_CXT.CADDR;

   4131  8 000131   000006 721000 xsym               LXL1    OD_CXT+6
         8 000132   000067 741000 1                  STX1    OPMSG_KERR

      412     4132    3              CALL SETUP_CXT ALTRET(KEYEND);

   4132  8 000133   000167 701000 8                  TSX1    SETUP_CXT
         8 000134   000137 702000 8                  TSX2    KEYEND

   4131  8 000135                       MSGLOOP      null
      413     4133    3   MSGLOOP:   ;
      414     4134    3              CALL DRIVE_CXT ALTRET(MSGLOOP);

   4134  8 000135   001505 701000 8                  TSX1    DRIVE_CXT
         8 000136   000135 702000 8                  TSX2    MSGLOOP

   4131  8 000137                       KEYEND       null
      415     4135    3   KEYEND:    ;
      416     4136    3              END;

      417     4137    2           END;

   4137  8 000137   000101 710000 8                  TRA     s:4119

      418     4138    1         ELSE
      419     4139    2           DO;
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:52   

      420     4140                                /* ONLINE DOG HERE */
      421     4141    3             DO FOREVER;

      422     4142    3             CALL M$READ (READ_SI) ALTRET(SIALT);

   4142  8 000140   000356 630400 2                  EPPR0   READ_SI
         8 000141   440000 713400                    CLIMB   alt,read
         8 000142   401400 401760                    pmme    nvectors=4
         8 000143   000164 702000 8                  TSX2    SIALT

      423     4143    3             CALL ODP$PARSE (ALLFLG) ALTRET(BADCMD);

   4143  8 000144   000002 630400 9                  EPPR0   2
         8 000145   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 000146   000000 701000 xent               TSX1    ODP$PARSE
         8 000147   000160 702000 8                  TSX2    BADCMD

      424     4144    3             IF OD_CXT.KIN# = 0 THEN GOTO ENDCMD;

   4144  8 000150   000006 220000 xsym               LDX0    OD_CXT+6
         8 000151   000163 600000 8                  TZE     ENDCMD

      425     4145    3             OD_INT=0;

   4145  8 000152   000000 450000 xsym               STZ     OD_INT

   4145  8 000153                       CMD00        null
      426     4146    3   CMD00:    ;
      427     4147    3             CALL SETUP_CXT ALTRET(ENDCMD);

   4147  8 000153   000167 701000 8                  TSX1    SETUP_CXT
         8 000154   000163 702000 8                  TSX2    ENDCMD

   4145  8 000155                       CMD0         null
      428     4148    3   CMD0:     ;
      429     4149    3             CALL DRIVE_CXT ALTRET(CMD0);
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:53   

   4149  8 000155   001505 701000 8                  TSX1    DRIVE_CXT
         8 000156   000155 702000 8                  TSX2    CMD0

      430     4150    3             GOTO ENDCMD;

   4150  8 000157   000163 710000 8                  TRA     ENDCMD

   4145  8 000160                       BADCMD       null
      431     4151    3   BADCMD:   ;
      432     4152    3             CALL M$WRITE (WRITE_EH);

   4152  8 000160   000424 630400 2                  EPPR0   WRITE_EH
         8 000161   040001 713400                    CLIMB   write
         8 000162   401400 401760                    pmme    nvectors=4

   4145  8 000163                       ENDCMD       null
      433     4153    3   ENDCMD:   ;
      434     4154    3             END;

   4154  8 000163   000140 710000 8                  TRA     s:4142

   4153  8 000164                       SIALT        null
      435     4155    2   SIALT:  ;
      436     4156    2           CALL M$EXIT;

   4156  8 000164   000001 713400                    CLIMB   exit
         8 000165   000000 401760                    pmme    nvectors=0

      437     4157    2           END;

   4157  8 000166   001757 710000 8                  TRA     s:4799

      438     4158        %EJECT;
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:54   
      439     4159
      440     4160
      441     4161        /*
      442     4162         K   K  EEEEE  Y   Y   III   N   N
      443     4163         K  K   E      Y   Y    I    N   N
      444     4164         K K    E       Y Y     I    NN  N
      445     4165         KK     EEEE     Y      I    N N N
      446     4166         K K    E        Y      I    N  NN
      447     4167         K  K   E        Y      I    N   N
      448     4168         K   K  EEEEE    Y     III   N   N
      449     4169
      450     4170
      451     4171         PPPP   RRRR    OOO    CCC   EEEEE   SSS    SSS    III   N   N   GGG
      452     4172         P   P  R   R  O O O  C   C  E      S   S  S   S    I    N   N  G   G
      453     4173         P   P  R   R  O O O  C      E      S      S        I    NN  N  G
      454     4174         PPPP   RRRR   O  OO  C      EEEE    SSS    SSS     I    N N N  G
      455     4175         P      R R    O   O  C      E          S      S    I    N  NN  G  GG
      456     4176         P      R  R   O   O  C   C  E      S   S  S   S    I    N   N  G   G
      457     4177         P      R   R   OOO    CCC   EEEEE   SSS    SSS    III   N   N   GGG
      458     4178
      459     4179
      460     4180        */
      461     4181
      462     4182
      463     4183
      464     4184        /**************************************
      465     4185         **************************************
      466     4186                    SETUP_CXT
      467     4187         **************************************
      468     4188         **************************************/
      469     4189        /*D* NAME:         SETUP_CXT
      470     4190             PURPOSE:      To set up keyin context for output
      471     4191             DESCRIPTION:  The context
      472     4192                           is to be readied for output.  This
      473     4193                           involves performing the appropriate form
      474     4194                           of M$JOBSTATS SRCH into the obtained buffer,
      475     4195                           and setting the counters in the context to
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:55   
      476     4196                           say that we have printed 0 items.
      477     4197
      478     4198                           If all this is successfully done, the routine
      479     4199                           returns.  It ALTRETs if any of the following
      480     4200                           conditions cause failure (after releasing the
      481     4201                           context frame and issuing an error message if
      482     4202                           appropriate):
      483     4203
      484     4204                           o unexpected M$JOBSTATS ALTRET
      485     4205
      486     4206                           o nothing to display
      487     4207
      488     4208                           o unknown keyin number (causes a SNAP)
      489     4209
      490     4210                           o Insufficient buffer space available to hold
      491     4211                           all the selected items
      492     4212
      493     4213                           o Invalid parameters on the keyin
      494     4214
      495     4215                           o Display is for console (not LP) and has more
      496     4216                           than the limiting number of items, and keyin
      497     4217                           did not specify FORCE or SHORT
      498     4218
      499     4219                           o display was to LP and M$LO could not be
      500     4220                           opened
      501     4221        */
      502     4222    1   SETUP_CXT: PROC ALTRET;

   4222  8 000167   200130 741300       SETUP_CXT    STX1  ! GET_STAT+38,,AUTO

      503     4223    2         OD_CXT.NDONE=0;

   4223  8 000170   000000 220003                    LDX0    0,DU
         8 000171   000001 440000 xsym               SXL0    OD_CXT+1

      504     4224    2         O_CRITERIA=STAT_CRITERIA;

PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:56   
   4224  8 000172   000100 100400                    MLR     fill='000'O
         8 000173   000204 000116 1                  ADSC9   STAT_CRITERIA            cn=0,n=78
         8 000174   200004 000116                    ADSC9   O_CRITERIA,,AUTO         cn=0,n=78

      505     4225    2         I_CRITERIA=STAT_CRITERIA;

   4225  8 000175   000100 100400                    MLR     fill='000'O
         8 000176   000204 000116 1                  ADSC9   STAT_CRITERIA            cn=0,n=78
         8 000177   200030 000116                    ADSC9   I_CRITERIA,,AUTO         cn=0,n=78

      506     4226    2         GET_STAT=STAT_FPT;

   4226  8 000200   000100 100400                    MLR     fill='000'O
         8 000201   000140 000220 1                  ADSC9   STAT_FPT                 cn=0,n=144
         8 000202   200062 000220                    ADSC9   GET_STAT,,AUTO           cn=0,n=144

      507     4227    2         GET_STAT.V_=VECTOR(GET_STAT.V);

   4227  8 000203   000003 235000 9                  LDA     3
         8 000204   200134 452500                    STP2    GET_STAT+42,,AUTO
         8 000205   200134 236100                    LDQ     GET_STAT+42,,AUTO
         8 000206   000112 036003                    ADLQ    74,DU
         8 000207   200062 757100                    STAQ    GET_STAT,,AUTO

      508     4228    2         IF OD_CXT.CATTR.OUTPUT & M_SYS THEN

   4228  8 000210   000025 722000 xsym               LXL2    OD_CXT+21
         8 000211   200000 362003                    ANX2    65536,DU
         8 000212   000215 600000 8                  TZE     s:4235

      509     4229                           /* SYS has all the attrs we're interested in
      510     4230                              so just turn 'em all on. */
      511     4231    2          OD_CXT.CATTR.OUTPUT = '777777'O;

   4231  8 000213   777777 222003                    LDX2    -1,DU
         8 000214   000025 442000 xsym               SXL2    OD_CXT+21

PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:57   
      512     4232
      513     4233                                /* Check to see if the keyin is legal
      514     4234                                   from this console */
      515     4235    3           DO CASE (OD_CXT.KIN#);

   4235  8 000215   000006 222000 xsym               LDX2    OD_CXT+6
         8 000216   000012 102003                    CMPX2   10,DU
         8 000217   000221 602012 8                  TNC     s:4235+4,X2
         8 000220   000254 710000 8                  TRA     s:4258
         8 000221   000254 710000 8                  TRA     s:4258
         8 000222   000245 710000 8                  TRA     s:4247
         8 000223   000245 710000 8                  TRA     s:4247
         8 000224   000254 710000 8                  TRA     s:4258
         8 000225   000233 710000 8                  TRA     s:4238
         8 000226   000245 710000 8                  TRA     s:4247
         8 000227   000245 710000 8                  TRA     s:4247
         8 000230   000245 710000 8                  TRA     s:4247
         8 000231   000251 710000 8                  TRA     s:4250
         8 000232   000251 710000 8                  TRA     s:4250

      516     4236
      517     4237    3             CASE (KEY_DISPNSFORM#);

      518     4238    3               IF NOT OD_CXT.CATTR.OUTPUT & M_DEVC THEN

   4238  8 000233   000025 723000 xsym               LXL3    OD_CXT+21
         8 000234   100000 363003                    ANX3    32768,DU
         8 000235   000254 601000 8                  TNZ     s:4258

      519     4239    4                 DO;

      520     4240    4   ILLKEY:       OPMSG_ILLKEY.CADDR=OD_CXT.CADDR;

   4240  8 000236   000006 720000 xsym  ILLKEY       LXL0    OD_CXT+6
         8 000237   000131 740000 1                  STX0    OPMSG_ILLKEY

      521     4241    4                 CALL M$WRITE (OCMSG_ILLKEY);
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:58   

   4241  8 000240   000174 630400 2                  EPPR0   OCMSG_ILLKEY
         8 000241   040001 713400                    CLIMB   write
         8 000242   401400 401760                    pmme    nvectors=4

      522     4242    4                 ALTRETURN;

   4242  8 000243   200130 221300                    LDX1  ! GET_STAT+38,,AUTO
         8 000244   000000 702211                    TSX2  ! 0,X1

      523     4243    4                 END;
      524     4244
      525     4245    3             CASE (KEY_DISPJOB#,KEY_DISPINPUT#,KEY_DISPDEFER#,

      526     4246    3                 KEY_DISPNORUN#,KEY_DISPPRIO#);
      527     4247    3               IF NOT OD_CXT.CATTR.OUTPUT & M_ADMIN THEN GOTO ILLKEY;

   4247  8 000245   000025 723000 xsym               LXL3    OD_CXT+21
         8 000246   040000 363003                    ANX3    16384,DU
         8 000247   000236 600000 8                  TZE     ILLKEY
         8 000250   000254 710000 8                  TRA     s:4258

      528     4248
      529     4249    3             CASE (KEY_DISPSYSID#,KEY_DISPALL#);

      530     4250    3               IF NOT (OD_CXT.CATTR.OUTPUT & (M_ADMIN|M_DEVC)) THEN

   4250  8 000251   000025 723000 xsym               LXL3    OD_CXT+21
         8 000252   140000 363003                    ANX3    49152,DU
         8 000253   000236 600000 8                  TZE     ILLKEY

      531     4251    3                GOTO ILLKEY;
      532     4252
      533     4253    3           END;

      534     4254
      535     4255                                /* VECTOR OFF
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:59   
      536     4256                                   ON KEYIN TYPE */
      537     4257
      538     4258    3           DO CASE (OD_CXT.KIN#);

   4258  8 000254   000012 102003                    CMPX2   10,DU
         8 000255   000257 602012 8                  TNC     s:4258+3,X2
         8 000256   001007 710000 8                  TRA     s:4487
         8 000257   001007 710000 8                  TRA     s:4487
         8 000260   000460 710000 8                  TRA     s:4333
         8 000261   000465 710000 8                  TRA     s:4340
         8 000262   000276 710000 8                  TRA     s:4270
         8 000263   000271 710000 8                  TRA     s:4263
         8 000264   000475 710000 8                  TRA     s:4353
         8 000265   000470 710000 8                  TRA     s:4346
         8 000266   000502 710000 8                  TRA     s:4360
         8 000267   000564 710000 8                  TRA     s:4385
         8 000270   000715 710000 8                  TRA     s:4446

      539     4259
      540     4260
      541     4261    3             CASE (KEY_DISPNSFORM#);

      542     4262
      543     4263    3               O_CRITERIA.NSFORM#='1'B;

   4263  8 000271   020000 236003                    LDQ     8192,DU
         8 000272   200014 256100                    ORSQ    O_CRITERIA+8,,AUTO

      544     4264    3               OPMSG_KERR.SUBC=ODKE_NONSF#;

   4264  8 000273   000010 236003                    LDQ     8,DU
         8 000274   000077 552020 1                  STBQ    OPMSG_KERR+8,'20'O

      545     4265    3               GOTO DISPO;

   4265  8 000275   000307 710000 8                  TRA     DISPO

PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:60   
      546     4266
      547     4267
      548     4268    3             CASE (KEY_DISPOUTPUT#);

      549     4269
      550     4270    3               OPMSG_KERR.SUBC=ODKE_NOUTP#;

   4270  8 000276   000006 236003                    LDQ     6,DU
         8 000277   000077 552020 1                  STBQ    OPMSG_KERR+8,'20'O

      551     4271    3               IF OD_CXT.DEVTYP ~= ' ' THEN

   4271  8 000300   000013 223000 xsym               LDX3    OD_CXT+11
         8 000301   040040 103003                    CMPX3   16416,DU
         8 000302   000307 600000 8                  TZE     DISPO

      552     4272    4                 DO;

      553     4273    4                 O_CRITERIA.DEVTYP#=OD_CXT.DEVTYP;

   4273  8 000303   200017 743100                    STX3    O_CRITERIA+11,,AUTO

      554     4274    4                 OPMSG_KERR.SUBC=ODKE_NDOUT#;

   4274  8 000304   000007 236003                    LDQ     7,DU
         8 000305   000077 552020 1                  STBQ    OPMSG_KERR+8,'20'O

      555     4275    4                 OPMSG_KERR.DEVTYP=OD_CXT.DEVTYP;

   4275  8 000306   000100 443000 1                  SXL3    OPMSG_KERR+9

      556     4276    4                 END;

   4271  8 000307                       DISPO        null
      557     4277    3   DISPO:      ;
      558     4278        /*  Here's the deal:  for C00, we're really getting a (possibly
      559     4279            wildcarded) WSN in TNAME.  Why, who knows.  */
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:61   
      560     4280    3               OD_CXT.SWSN=OD_CXT.STNAME;                                   /*#13.37*/

   4280  8 000307   040000 100400                    MLR     fill='040'O
         8 000310   000017 000010 xsym               ADSC9   OD_CXT+15                cn=0,n=8
         8 000311   000015 000010 xsym               ADSC9   OD_CXT+13                cn=0,n=8

      561     4281    3               OD_CXT.NOTWSN=OD_CXT.NOTTERM;

      562     4282    3               CALL GETO ALTRET(ERRX);

   4282  8 000312   001106 701000 8                  TSX1    GETO
         8 000313   000330 702000 8                  TSX2    ERRX

   4281  8 000314                       DONE         null
      563     4283    3   DONE:       ;
      564     4284    3               OD_CXT.NDISPED=OD_CXT.NFOUND-OD_CXT.NDONE;

   4284  8 000314   000001 236000 xsym               LDQ     OD_CXT+1
         8 000315   777777 376007                    ANQ     -1,DL
         8 000316   200134 756100                    STQ     GET_STAT+42,,AUTO
         8 000317   000001 236000 xsym               LDQ     OD_CXT+1
         8 000320   000022 772000                    QRL     18
         8 000321   200134 136100                    SBLQ    GET_STAT+42,,AUTO
         8 000322   000002 756000 xsym               STQ     OD_CXT+2

      565     4285    3               IF OD_CXT.NDISPED <= 0 THEN GOTO ERRX;

   4285  8 000323   000330 604400 8                  TMOZ    ERRX

      566     4286    3               CALL DONESUB ALTRET(ERRX);

   4286  8 000324   001015 701000 8                  TSX1    DONESUB
         8 000325   000330 702000 8                  TSX2    ERRX

      567     4287    3               RETURN;

   4287  8 000326   200130 221300                    LDX1  ! GET_STAT+38,,AUTO
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:62   
         8 000327   000001 702211                    TSX2  ! 1,X1

   4285  8 000330                       ERRX         null
      568     4288    3   ERRX:       ;
      569     4289    3               OPMSG_KERR.FORM = OD_CXT.SFORM;

   4289  8 000330   040000 100400                    MLR     fill='040'O
         8 000331   000023 000006 xsym               ADSC9   OD_CXT+19                cn=0,n=6
         8 000332   000110 000006 1                  ADSC9   OPMSG_KERR+17            cn=0,n=6

      570     4290    3               OPMSG_KERR.NOTACCT= OD_CXT.NOTACCT;

   4290  8 000333   000013 236000 xsym               LDQ     OD_CXT+11
         8 000334   000011 736000                    QLS     9
         8 000335   000107 552020 1                  STBQ    OPMSG_KERR+16,'20'O

      571     4291    3               OPMSG_KERR.NOTWSN = OD_CXT.NOTWSN;

   4291  8 000336   000013 236000 xsym               LDQ     OD_CXT+11
         8 000337   000107 552004 1                  STBQ    OPMSG_KERR+16,'04'O

      572     4292    3               OPMSG_KERR.NOTTERM= OD_CXT.NOTTERM;

   4292  8 000340   000107 552004 1                  STBQ    OPMSG_KERR+16,'04'O

      573     4293    3               OPMSG_KERR.NOTFORM= OD_CXT.NOTFORM;

   4293  8 000341   000024 236000 xsym               LDQ     OD_CXT+20
         8 000342   000107 552010 1                  STBQ    OPMSG_KERR+16,'10'O

      574     4294    3               OPMSG_KERR.CADDR=OD_CXT.CADDR;

   4294  8 000343   000006 720000 xsym               LXL0    OD_CXT+6
         8 000344   000067 740000 1                  STX0    OPMSG_KERR

      575     4295    3               IF OD_CXT.CATTR.OUTPUT & M_SYS THEN

PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:63   
   4295  8 000345   000025 721000 xsym               LXL1    OD_CXT+21
         8 000346   200000 361003                    ANX1    65536,DU
         8 000347   000361 600000 8                  TZE     s:4301

      576     4296    4                 DO;

      577     4297    4                 OPMSG_KERR.PWSN=1;

   4297  8 000350   001000 236003                    LDQ     512,DU
         8 000351   000101 552040 1                  STBQ    OPMSG_KERR+10,'40'O

      578     4298    4                 OPMSG_KERR.ATWSN=OD_CXT.SWSN;

   4298  8 000352   040000 100400                    MLR     fill='040'O
         8 000353   000015 000010 xsym               ADSC9   OD_CXT+13                cn=0,n=8
         8 000354   000101 200010 1                  ADSC9   OPMSG_KERR+10            cn=1,n=8

      579     4299    4                 OPMSG_KERR.ATTERM=OD_CXT.STNAME;

   4299  8 000355   040000 100400                    MLR     fill='040'O
         8 000356   000017 000010 xsym               ADSC9   OD_CXT+15                cn=0,n=8
         8 000357   000103 200010 1                  ADSC9   OPMSG_KERR+12            cn=1,n=8

      580     4300    4                 END;

   4300  8 000360   000363 710000 8                  TRA     s:4302

      581     4301    3               ELSE OPMSG_KERR.PWSN=0;

   4301  8 000361   000000 236003                    LDQ     0,DU
         8 000362   000101 552040 1                  STBQ    OPMSG_KERR+10,'40'O

      582     4302    3               OPMSG_KERR.ACCT=OD_CXT.SACCT;

   4302  8 000363   040000 100400                    MLR     fill='040'O
         8 000364   000021 000010 xsym               ADSC9   OD_CXT+17                cn=0,n=8
         8 000365   000105 200010 1                  ADSC9   OPMSG_KERR+14            cn=1,n=8
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:64   

      583     4303    3               IF OD_SGHST THEN

   4303  8 000366   000000 235000 xsym               LDA     OD_SGHST
         8 000367   000374 600000 8                  TZE     s:4306

      584     4304    3                CALL M$WRITE (OCMSG_KERR);

   4304  8 000370   000144 630400 2                  EPPR0   OCMSG_KERR
         8 000371   040001 713400                    CLIMB   write
         8 000372   401400 401760                    pmme    nvectors=4
         8 000373   000454 710000 8                  TRA     ERRX1

      585     4305    3               ELSE
      586     4306    4                 DO CASE (OPMSG_KERR.SUBC);

   4306  8 000374   000077 221000 1                  LDX1    OPMSG_KERR+8
         8 000375   000777 361003                    ANX1    511,DU
         8 000376   000020 101003                    CMPX1   16,DU
         8 000377   000401 602011 8                  TNC     s:4306+5,X1
         8 000400   000451 710000 8                  TRA     s:4323
         8 000401   000421 710000 8                  TRA     s:4309
         8 000402   000425 710000 8                  TRA     s:4312
         8 000403   000451 710000 8                  TRA     s:4323
         8 000404   000451 710000 8                  TRA     s:4323
         8 000405   000451 710000 8                  TRA     s:4323
         8 000406   000451 710000 8                  TRA     s:4323
         8 000407   000451 710000 8                  TRA     s:4323
         8 000410   000451 710000 8                  TRA     s:4323
         8 000411   000451 710000 8                  TRA     s:4323
         8 000412   000451 710000 8                  TRA     s:4323
         8 000413   000451 710000 8                  TRA     s:4323
         8 000414   000441 710000 8                  TRA     s:4317
         8 000415   000451 710000 8                  TRA     s:4323
         8 000416   000451 710000 8                  TRA     s:4323
         8 000417   000451 710000 8                  TRA     s:4323
         8 000420   000445 710000 8                  TRA     s:4320
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:65   

      587     4307
      588     4308    4                   CASE (ODKE_NDATA#);

      589     4309    4                     CALL M$WRITE (WRITE_NOMEM);

   4309  8 000421   000454 630400 2                  EPPR0   WRITE_NOMEM
         8 000422   040001 713400                    CLIMB   write
         8 000423   401400 401760                    pmme    nvectors=4
         8 000424   000454 710000 8                  TRA     ERRX1

      590     4310
      591     4311    4                   CASE (ODKE_TMITM#);

      592     4312    4                     I=OD_CXT.NFOUND;

   4312  8 000425   000001 236000 xsym               LDQ     OD_CXT+1
         8 000426   000022 772000                    QRL     18
         8 000427   200003 756100                    STQ     I,,AUTO

      593     4313    4                     CALL BINCHAR (TMMSG.NUM,I);

   4313  8 000430   000000 235003                    LDA     0,DU
         8 000431   200134 757100                    STAQ    GET_STAT+42,,AUTO
         8 000432   000000 301500                    BTD
         8 000433   200134 000010                    NDSC9   GET_STAT+42,,AUTO        cn=0,s=lsgnf,sf=0,n=8
         8 000434   000012 030004 1                  NDSC9   TMMSG+1                  cn=0,s=nosgn,sf=0,n=4

      594     4314    4                     CALL M$WRITE (WRITE_TM);

   4314  8 000435   000470 630400 2                  EPPR0   WRITE_TM
         8 000436   040001 713400                    CLIMB   write
         8 000437   401400 401760                    pmme    nvectors=4
         8 000440   000454 710000 8                  TRA     ERRX1

      595     4315
      596     4316    4                   CASE (ODKE_BPRIO#);
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:66   

      597     4317    4                     CALL M$WRITE (WRITE_EH);

   4317  8 000441   000424 630400 2                  EPPR0   WRITE_EH
         8 000442   040001 713400                    CLIMB   write
         8 000443   401400 401760                    pmme    nvectors=4
         8 000444   000454 710000 8                  TRA     ERRX1

      598     4318
      599     4319    4                   CASE (ODKE_SQRIP#);

      600     4320    4                     CALL M$WRITE (WRITE_SQRIP);

   4320  8 000445   000374 630400 2                  EPPR0   WRITE_SQRIP
         8 000446   040001 713400                    CLIMB   write
         8 000447   401400 401760                    pmme    nvectors=4
         8 000450   000454 710000 8                  TRA     ERRX1

      601     4321
      602     4322    4                   CASE (ELSE);

      603     4323    4                     CALL M$WRITE (WRITE_NONE);

   4323  8 000451   000440 630400 2                  EPPR0   WRITE_NONE
         8 000452   040001 713400                    CLIMB   write
         8 000453   401400 401760                    pmme    nvectors=4

      604     4324
      605     4325    4                 END;

   4314  8 000454                       ERRX1        null
      606     4326    3   ERRX1:      ;
      607     4327    3               CALL RELMEM_CXT;

   4327  8 000454   001742 701000 8                  TSX1    RELMEM_CXT
         8 000455   000000 011000                    NOP     0

PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:67   
      608     4328    3               ALTRETURN;

   4328  8 000456   200130 221300                    LDX1  ! GET_STAT+38,,AUTO
         8 000457   000000 702211                    TSX2  ! 0,X1

      609     4329
      610     4330
      611     4331    3             CASE (KEY_DISPJOB#);

      612     4332
      613     4333    3               I_CRITERIA.RUNNING#='1'B;

   4333  8 000460   010000 236003                    LDQ     4096,DU
         8 000461   200040 256100                    ORSQ    I_CRITERIA+8,,AUTO

      614     4334    3               OPMSG_KERR.SUBC=ODKE_NORUN#;

   4334  8 000462   000002 236003                    LDQ     2,DU
         8 000463   000077 552020 1                  STBQ    OPMSG_KERR+8,'20'O

      615     4335    3               GOTO DISPINR;

   4335  8 000464   000526 710000 8                  TRA     DISPINR

      616     4336
      617     4337
      618     4338    3             CASE (KEY_DISPINPUT#);

      619     4339
      620     4340    3               OPMSG_KERR.SUBC=ODKE_NOJOB#;

   4340  8 000465   000005 236003                    LDQ     5,DU
         8 000466   000077 552020 1                  STBQ    OPMSG_KERR+8,'20'O

      621     4341    3               GOTO DISPI;

   4341  8 000467   000530 710000 8                  TRA     DISPI
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:68   

      622     4342
      623     4343
      624     4344    3             CASE (KEY_DISPDEFER#);

      625     4345
      626     4346    3               I_CRITERIA.RUNAFTER#='1'B;

   4346  8 000470   200000 236003                    LDQ     65536,DU
         8 000471   200040 256100                    ORSQ    I_CRITERIA+8,,AUTO

      627     4347    3               OPMSG_KERR.SUBC=ODKE_NODFR#;

   4347  8 000472   000014 236003                    LDQ     12,DU
         8 000473   000077 552020 1                  STBQ    OPMSG_KERR+8,'20'O

      628     4348    3               GOTO DISPINR;

   4348  8 000474   000526 710000 8                  TRA     DISPINR

      629     4349
      630     4350
      631     4351    3             CASE (KEY_DISPNORUN#);

      632     4352
      633     4353    3               I_CRITERIA.NORUN#='1'B;

   4353  8 000475   400000 236003                    LDQ     -131072,DU
         8 000476   200040 256100                    ORSQ    I_CRITERIA+8,,AUTO

      634     4354    3               OPMSG_KERR.SUBC=ODKE_NNORN#;

   4354  8 000477   000003 236003                    LDQ     3,DU
         8 000500   000077 552020 1                  STBQ    OPMSG_KERR+8,'20'O

      635     4355    3               GOTO DISPI;

PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:69   
   4355  8 000501   000530 710000 8                  TRA     DISPI

      636     4356
      637     4357
      638     4358    3             CASE (KEY_DISPPRIO#);

      639     4359
      640     4360    3               OPMSG_KERR.SUBC=ODKE_BPRIO#;

   4360  8 000502   000013 236003                    LDQ     11,DU
         8 000503   000077 552020 1                  STBQ    OPMSG_KERR+8,'20'O

      641     4361    3               IF OD_CXT.HIPRIOR = -1 THEN OD_CXT.HIPRIO=OD_CXT.LOPRIO;

   4361  8 000504   000014 723000 xsym               LXL3    OD_CXT+12
         8 000505   777777 103003                    CMPX3   -1,DU
         8 000506   000511 601000 8                  TNZ     s:4362

   4361  8 000507   000014 224000 xsym               LDX4    OD_CXT+12
         8 000510   000014 444000 xsym               SXL4    OD_CXT+12

      642     4362    3               IF OD_CXT.LOPRIO > OD_CXT.HIPRIO

   4362  8 000511   000014 723000 xsym               LXL3    OD_CXT+12
         8 000512   000014 103000 xsym               CMPX3   OD_CXT+12
         8 000513   000330 602000 8                  TNC     ERRX
         8 000514   000020 103003                    CMPX3   16,DU
         8 000515   000330 603000 8                  TRC     ERRX

      643     4363    3               OR OD_CXT.HIPRIO > 15 THEN GOTO ERRX;
      644     4364    3               OPMSG_KERR.SUBC=ODKE_NPRIO#;

   4364  8 000516   000004 236003                    LDQ     4,DU
         8 000517   000077 552020 1                  STBQ    OPMSG_KERR+8,'20'O

      645     4365    3               I_CRITERIA.PRIO#=OD_CXT.LOPRIO;

PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:70   
   4365  8 000520   000014 235000 xsym               LDA     OD_CXT+12
         8 000521   000022 771000                    ARL     18
         8 000522   200041 755100                    STA     I_CRITERIA+9,,AUTO

      646     4366    3               I_CRITERIA.PRIO1#=OD_CXT.HIPRIO;

   4366  8 000523   000014 236000 xsym               LDQ     OD_CXT+12
         8 000524   777777 376007                    ANQ     -1,DL
         8 000525   200042 756100                    STQ     I_CRITERIA+10,,AUTO

   4366  8 000526                       DISPINR      null
      647     4367    3   DISPINR:    ;
      648     4368    3               RESLIST=0;

   4368  8 000526   200056 450100                    STZ     RESLIST,,AUTO

      649     4369    3               GOTO DISPI2;

   4369  8 000527   000532 710000 8                  TRA     DISPI2

   4368  8 000530                       DISPI        null
      650     4370    3   DISPI:      ;
      651     4371    3               RESLIST=1;

   4371  8 000530   000001 236007                    LDQ     1,DL
         8 000531   200056 756100                    STQ     RESLIST,,AUTO

   4371  8 000532                       DISPI2       null
      652     4372    3   DISPI2:     ;
      653     4373    3               CALL GETI ALTRET(ERRX);

   4373  8 000532   001307 701000 8                  TSX1    GETI
         8 000533   000330 702000 8                  TSX2    ERRX

      654     4374    3               IF OD_CXT.KIN# = KEY_DISPINPUT# THEN

   4374  8 000534   000006 220000 xsym               LDX0    OD_CXT+6
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:71   
         8 000535   000002 100003                    CMPX0   2,DU
         8 000536   000563 601000 8                  TNZ     s:4380

      655     4375    4                 DO WHILE (OD_CXT.NDONE < OD_CXT.NFOUND);

   4375  8 000537   000001 721000 xsym               LXL1    OD_CXT+1
         8 000540   000001 101000 xsym               CMPX1   OD_CXT+1
         8 000541   000563 603000 8                  TRC     s:4380

      656     4376    4                 BUF$=ADDR(OD_CXT.SEG$->R$INPUT.J(OD_CXT.NDONE));

   4376  8 000542   000001 236000 xsym               LDQ     OD_CXT+1
         8 000543   000005 736000                    QLS     5
         8 000544   000004 376000 9                  ANQ     4
         8 000545   000023 736000                    QLS     19
         8 000546   000002 036003                    ADLQ    2,DU
         8 000547   000000 036000 xsym               ADLQ    OD_CXT
         8 000550   200057 756100                    STQ     BUF$,,AUTO

      657     4377    4                 IF BUF$->A$INPUT.PRIO ~= %JP_RUN# THEN GOTO DONE;

   4377  8 000551   200057 470500                    LDP0    BUF$,,AUTO
         8 000552   000003 236100                    LDQ     3,,PR0
         8 000553   000777 376007                    ANQ     511,DL
         8 000554   000020 116007                    CMPQ    16,DL
         8 000555   000314 601000 8                  TNZ     DONE

      658     4378    4                 OD_CXT.NDONE=OD_CXT.NDONE+1;

   4378  8 000556   000001 720000 xsym               LXL0    OD_CXT+1
         8 000557   000001 621010                    EAX1    1,X0
         8 000560   000001 441000 xsym               SXL1    OD_CXT+1

      659     4379    4                 END;

   4379  8 000561   000001 101000 xsym               CMPX1   OD_CXT+1
         8 000562   000542 602000 8                  TNC     s:4376
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:72   

      660     4380    3               GOTO DONE;

   4380  8 000563   000314 710000 8                  TRA     DONE

      661     4381
      662     4382
      663     4383    3             CASE (KEY_DISPSYSID#);

      664     4384
      665     4385    3               OD_CXT.SACCT=' ';

   4385  8 000564   000035 235000 xsym               LDA     B_VECTNIL+29
         8 000565   000035 236000 xsym               LDQ     B_VECTNIL+29
         8 000566   000021 755000 xsym               STA     OD_CXT+17
         8 000567   000022 756000 xsym               STQ     OD_CXT+18

      666     4386    3               OD_CXT.INOUT=1;

   4386  8 000570   001000 236003                    LDQ     512,DU
         8 000571   000005 552040 xsym               STBQ    OD_CXT+5,'40'O

      667     4387                     /* Sheesh.  If SYSID = 0, M$JOBSTATS will think
      668     4388                        we're searching all SYSIDs, so we'll just go right
      669     4389                        ahead and check for it EVERY time... */
      670     4390    3               IF OD_CXT.SYSID ~= 0 THEN

   4390  8 000572   000010 723000 xsym               LXL3    OD_CXT+8
         8 000573   000705 600000 8                  TZE     s:4435

      671     4391    4                 DO;

      672     4392    4                 IF OD_CXT.CATTR.OUTPUT & M_ADMIN THEN

   4392  8 000574   000025 724000 xsym               LXL4    OD_CXT+21
         8 000575   040000 364003                    ANX4    16384,DU
         8 000576   000667 600000 8                  TZE     s:4423
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:73   

      673     4393    4                  IF OD_CXT.INPCOMP = 0 THEN

   4393  8 000577   000005 724000 xsym               LXL4    OD_CXT+5
         8 000600   000667 601000 8                  TNZ     s:4423

      674     4394    5                    DO;

      675     4395                                /* FIRST PASS - LOOK FOR SYSID AS JOB */
      676     4396    5                    I_CRITERIA.SYSID#=OD_CXT.SYSID;

   4396  8 000601   000010 236000 xsym               LDQ     OD_CXT+8
         8 000602   777777 376007                    ANQ     -1,DL
         8 000603   200036 756100                    STQ     I_CRITERIA+6,,AUTO

      677     4397    5                    I_CRITERIA.SYSID1#=OD_CXT.SYSID;

   4397  8 000604   200037 756100                    STQ     I_CRITERIA+7,,AUTO

      678     4398    5                    RESLIST=1;

   4398  8 000605   000001 235007                    LDA     1,DL
         8 000606   200056 755100                    STA     RESLIST,,AUTO

      679     4399    5                    CALL GETI1 ALTRET(ERRX);

   4399  8 000607   001345 701000 8                  TSX1    GETI1
         8 000610   000330 702000 8                  TSX2    ERRX

      680     4400    5                    IF OD_CXT.NFOUND ~= 0 THEN GOTO DONE;

   4400  8 000611   000001 220000 xsym               LDX0    OD_CXT+1
         8 000612   000314 601000 8                  TNZ     DONE

      681     4401    5                    IF GOODNGT = 0 THEN

   4401  8 000613   000066 235000 1                  LDA     GOODNGT
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:74   
         8 000614   000655 601000 8                  TNZ     DISPSY1

      682     4402    6                      DO;

      683     4403                                /* TRY TO READ :JOBSTATS */
      684     4404    6                      IF DCBADDR(DCBNUM(M$JSF))->F$DCB.FCD = '0'B THEN

   4404  8 000615   000000 236007 xsym               LDQ     M$JSF,DL
         8 000616   000000 470400 9                  LDP0    0
         8 000617   000000 471500                    LDP1    0,,PR0
         8 000620   100000 473506                    LDP3    0,QL,PR1
         8 000621   300031 236100                    LDQ     25,,PR3
         8 000622   020000 316007                    CANQ    8192,DL
         8 000623   000630 601000 8                  TNZ     s:4406

      685     4405    6                       CALL XSJ$OPEN (JOPN) ALTRET(DISPSY1);

   4405  8 000624   000001 630400 9                  EPPR0   1
         8 000625   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 000626   000000 701000 xent               TSX1    XSJ$OPEN
         8 000627   000655 702000 8                  TSX2    DISPSY1

      686     4406    6                      JREAD.SYSID#=OD_CXT.SYSID;

   4406  8 000630   000010 720000 xsym               LXL0    OD_CXT+8
         8 000631   000062 440000 1                  SXL0    JREAD+4

      687     4407    6                      CALL XSJ$READ (JREAD) ALTRET(DISPSY1);

   4407  8 000632   000005 630400 9                  EPPR0   5
         8 000633   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 000634   000000 701000 xent               TSX1    XSJ$READ
         8 000635   000655 702000 8                  TSX2    DISPSY1

      688     4408    6                      OD_CXT.SEG$=ADDR(JREC);

   4408  8 000636   000006 236000 9                  LDQ     6
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:75   
         8 000637   000000 756000 xsym               STQ     OD_CXT

      689     4409    6                      I = OD_CXT.ONLP;

   4409  8 000640   000007 235000 xsym               LDA     OD_CXT+7
         8 000641   000022 771000                    ARL     18
         8 000642   200003 755100                    STA     I,,AUTO

      690     4410    6                      OD_CXT.ONLP = 0;

   4410  8 000643   000000 220003                    LDX0    0,DU
         8 000644   000007 740000 xsym               STX0    OD_CXT+7

      691     4411    6                      CALL ODF$FORMAT (ODFT_JSFID#);

   4411  8 000645   000007 630400 9                  EPPR0   7
         8 000646   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 000647   000000 701000 xent               TSX1    ODF$FORMAT
         8 000650   000000 011000                    NOP     0

      692     4412    6                      OD_CXT.ONLP = I;

   4412  8 000651   200003 720100                    LXL0    I,,AUTO
         8 000652   000007 740000 xsym               STX0    OD_CXT+7

      693     4413    6                      OD_CXT.INPCOMP=1;

   4413  8 000653   000001 221003                    LDX1    1,DU
         8 000654   000005 441000 xsym               SXL1    OD_CXT+5

   4413  8 000655                       DISPSY1      null
      694     4414    6   DISPSY1:           ;
      695     4415    6                      END;

      696     4416    5                    CALL RELMEM_CXT;

   4416  8 000655   001742 701000 8                  TSX1    RELMEM_CXT
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:76   
         8 000656   000000 011000                    NOP     0

      697     4417                                /* FAILED TO FIND IT. LOOK FOR OUTPUT */
      698     4418    5                    GET_STAT=STAT_FPT;

   4418  8 000657   000100 100400                    MLR     fill='000'O
         8 000660   000140 000220 1                  ADSC9   STAT_FPT                 cn=0,n=144
         8 000661   200062 000220                    ADSC9   GET_STAT,,AUTO           cn=0,n=144

      699     4419    5                    GET_STAT.V_=VECTOR(GET_STAT.V);

   4419  8 000662   000003 235000 9                  LDA     3
         8 000663   200134 452500                    STP2    GET_STAT+42,,AUTO
         8 000664   200134 236100                    LDQ     GET_STAT+42,,AUTO
         8 000665   000112 036003                    ADLQ    74,DU
         8 000666   200062 757100                    STAQ    GET_STAT,,AUTO

      700     4420    5                    END;

      701     4421
      702     4422                                /* SECOND PASS - LOOK FOR SYSID AS OUTPUT */
      703     4423    4                 IF OD_CXT.CATTR.OUTPUT & M_DEVC THEN

   4423  8 000667   000025 720000 xsym               LXL0    OD_CXT+21
         8 000670   100000 360003                    ANX0    32768,DU
         8 000671   000705 600000 8                  TZE     s:4435

      704     4424    5                   DO;

      705     4425    5                   O_CRITERIA.SYSID#=OD_CXT.SYSID;

   4425  8 000672   000010 236000 xsym               LDQ     OD_CXT+8
         8 000673   777777 376007                    ANQ     -1,DL
         8 000674   200012 756100                    STQ     O_CRITERIA+6,,AUTO

      706     4426    5                   O_CRITERIA.SYSID1#=OD_CXT.SYSID;

PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:77   
   4426  8 000675   200013 756100                    STQ     O_CRITERIA+7,,AUTO

      707     4427    5                   CALL GETO1 ALTRET(ERRX);

   4427  8 000676   001157 701000 8                  TSX1    GETO1
         8 000677   000330 702000 8                  TSX2    ERRX

      708     4428    5                   IF OD_CXT.NFOUND ~= 0 THEN

   4428  8 000700   000001 220000 xsym               LDX0    OD_CXT+1
         8 000701   000705 600000 8                  TZE     s:4435

      709     4429    6                     DO;

      710     4430    6                     OD_CXT.INPCOMP=1;

   4430  8 000702   000001 221003                    LDX1    1,DU
         8 000703   000005 441000 xsym               SXL1    OD_CXT+5

      711     4431    6                     GOTO DONE;

   4431  8 000704   000314 710000 8                  TRA     DONE

      712     4432    6                     END;
      713     4433    5                   END;
      714     4434    4                 END;
      715     4435    3               IF OD_CXT.INPCOMP = 0 THEN

   4435  8 000705   000005 720000 xsym               LXL0    OD_CXT+5
         8 000706   000714 601000 8                  TNZ     s:4441

      716     4436    4                 DO;

      717     4437    4                 OPMSG_KERR.SUBC=ODKE_NOSYS#;

   4437  8 000707   000011 236003                    LDQ     9,DU
         8 000710   000077 552020 1                  STBQ    OPMSG_KERR+8,'20'O
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:78   

      718     4438    4                 OPMSG_KERR.SYSID=OD_CXT.SYSID;

   4438  8 000711   000010 721000 xsym               LXL1    OD_CXT+8
         8 000712   000070 741000 1                  STX1    OPMSG_KERR+1

      719     4439    4                 GOTO ERRX;

   4439  8 000713   000330 710000 8                  TRA     ERRX

      720     4440    4                 END;
      721     4441    3               GOTO ERRX1;

   4441  8 000714   000454 710000 8                  TRA     ERRX1

      722     4442
      723     4443
      724     4444    3             CASE (KEY_DISPALL#);

      725     4445
      726     4446    3               OPMSG_KERR.SUBC=ODKE_NOALL#;                                 /*#13.27*/

   4446  8 000715   000016 236003                    LDQ     14,DU
         8 000716   000077 552020 1                  STBQ    OPMSG_KERR+8,'20'O

      727     4447    3               OD_CXT.INOUT=1;

   4447  8 000717   001000 236003                    LDQ     512,DU
         8 000720   000005 552040 xsym               STBQ    OD_CXT+5,'40'O

      728     4448    3               IF OD_CXT.CATTR.OUTPUT & M_ADMIN THEN

   4448  8 000721   000025 723000 xsym               LXL3    OD_CXT+21
         8 000722   040000 363003                    ANX3    16384,DU
         8 000723   000746 600000 8                  TZE     s:4460

      729     4449    3                IF OD_CXT.INPCOMP = 0 THEN
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:79   

   4449  8 000724   000005 723000 xsym               LXL3    OD_CXT+5
         8 000725   000746 601000 8                  TNZ     s:4460

      730     4450    4                  DO;

      731     4451                                /* 1ST PASS: GET INPUT */
      732     4452    4                  RESLIST=1;

   4452  8 000726   000001 235007                    LDA     1,DL
         8 000727   200056 755100                    STA     RESLIST,,AUTO

      733     4453    4                  CALL GETI ALTRET(ERRX);

   4453  8 000730   001307 701000 8                  TSX1    GETI
         8 000731   000330 702000 8                  TSX2    ERRX

      734     4454    4                  IF OD_CXT.NFOUND ~= 0 THEN GOTO DONE;

   4454  8 000732   000001 220000 xsym               LDX0    OD_CXT+1
         8 000733   000314 601000 8                  TNZ     DONE

      735     4455                                /* DIDNT FIND ANY */
      736     4456    4                  CALL RELMEM_CXT;

   4456  8 000734   001742 701000 8                  TSX1    RELMEM_CXT
         8 000735   000000 011000                    NOP     0

      737     4457    4                  GET_STAT=STAT_FPT;

   4457  8 000736   000100 100400                    MLR     fill='000'O
         8 000737   000140 000220 1                  ADSC9   STAT_FPT                 cn=0,n=144
         8 000740   200062 000220                    ADSC9   GET_STAT,,AUTO           cn=0,n=144

      738     4458    4                  GET_STAT.V_=VECTOR(GET_STAT.V);

   4458  8 000741   000003 235000 9                  LDA     3
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:80   
         8 000742   200134 452500                    STP2    GET_STAT+42,,AUTO
         8 000743   200134 236100                    LDQ     GET_STAT+42,,AUTO
         8 000744   000112 036003                    ADLQ    74,DU
         8 000745   200062 757100                    STAQ    GET_STAT,,AUTO

      739     4459    4                  END;

      740     4460    3               IF OD_CXT.CATTR.OUTPUT & M_DEVC THEN

   4460  8 000746   000025 720000 xsym               LXL0    OD_CXT+21
         8 000747   100000 360003                    ANX0    32768,DU
         8 000750   001001 600000 8                  TZE     s:4477

      741     4461    4                 DO;

      742     4462    4                 CALL GETO ALTRET(DISPALL1);

   4462  8 000751   001106 701000 8                  TSX1    GETO
         8 000752   000754 702000 8                  TSX2    DISPALL1

      743     4463    4                 GOTO DISPALL2;

   4463  8 000753   000763 710000 8                  TRA     DISPALL2

   4462  8 000754                       DISPALL1     null
      744     4464    4   DISPALL1:     ;
      745     4465    4                 IF OD_CXT.ONLP ~= 0 THEN CALL M$CLOSE (CLOSE_LO) ALTRET(ERRX);

   4465  8 000754   000007 220000 xsym               LDX0    OD_CXT+7
         8 000755   000762 600000 8                  TZE     s:4466

   4465  8 000756   000320 630400 2                  EPPR0   CLOSE_LO
         8 000757   450001 713400                    CLIMB   alt,close
         8 000760   406000 401760                    pmme    nvectors=13
         8 000761   000330 702000 8                  TSX2    ERRX

      746     4466    4                 GOTO ERRX;
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:81   

   4466  8 000762   000330 710000 8                  TRA     ERRX

   4465  8 000763                       DISPALL2     null
      747     4467    4   DISPALL2:     ;
      748     4468    4                 IF OD_CXT.NFOUND ~= 0 THEN

   4468  8 000763   000001 220000 xsym               LDX0    OD_CXT+1
         8 000764   001001 600000 8                  TZE     s:4477

      749     4469    5                   DO;

      750     4470    5                   OD_CXT.INPCOMP=1;

   4470  8 000765   000001 221003                    LDX1    1,DU
         8 000766   000005 441000 xsym               SXL1    OD_CXT+5

      751     4471    5                   OD_CXT.NDISPED=OD_CXT.NDISPED+OD_CXT.NFOUND;

   4471  8 000767   000001 236000 xsym               LDQ     OD_CXT+1
         8 000770   000022 772000                    QRL     18
         8 000771   000002 036000 xsym               ADLQ    OD_CXT+2
         8 000772   000002 756000 xsym               STQ     OD_CXT+2

      752     4472    5                   OD_CXT.HDRDUN=0;

   4472  8 000773   000000 236003                    LDQ     0,DU
         8 000774   000005 552020 xsym               STBQ    OD_CXT+5,'20'O

      753     4473    5                   CALL DONESUB ALTRET(DISPALL1);

   4473  8 000775   001015 701000 8                  TSX1    DONESUB
         8 000776   000754 702000 8                  TSX2    DISPALL1

      754     4474    5                   RETURN;

   4474  8 000777   200130 221300                    LDX1  ! GET_STAT+38,,AUTO
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:82   
         8 001000   000001 702211                    TSX2  ! 1,X1

      755     4475    5                   END;
      756     4476    4                 END;
      757     4477    3               IF OD_CXT.INPCOMP = 0 THEN

   4477  8 001001   000005 720000 xsym               LXL0    OD_CXT+5
         8 001002   001006 601000 8                  TNZ     s:4482

      758     4478    4                 DO;

      759     4479    4                 OPMSG_KERR.SUBC=ODKE_NOALL#;

   4479  8 001003   000016 236003                    LDQ     14,DU
         8 001004   000077 552020 1                  STBQ    OPMSG_KERR+8,'20'O

      760     4480    4                 GOTO ERRX;

   4480  8 001005   000330 710000 8                  TRA     ERRX

      761     4481    4                 END;
      762     4482    3               GOTO ERRX1;

   4482  8 001006   000454 710000 8                  TRA     ERRX1

      763     4483
      764     4484
      765     4485    3             CASE (ELSE);

      766     4486
      767     4487    3               OPMSG_UNIMP.CADDR=OD_CXT.CADDR;

   4487  8 001007   000006 723000 xsym               LXL3    OD_CXT+6
         8 001010   000124 743000 1                  STX3    OPMSG_UNIMP

      768     4488    3               CALL M$WRITE (OCMSG_UNIMP);

PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:83   
   4488  8 001011   000210 630400 2                  EPPR0   OCMSG_UNIMP
         8 001012   040001 713400                    CLIMB   write
         8 001013   401400 401760                    pmme    nvectors=4

      769     4489    3               GOTO ERRX1;

   4489  8 001014   000454 710000 8                  TRA     ERRX1

      770     4490
      771     4491
      772     4492    3           END;

      773     4493
      774     4494
      775     4495                           /* SUBROUTINE EXECUTED WHEN 'DONE' */
      776     4496    2   DONESUB: PROC ALTRET;

   4496  8 001015   200132 741300       DONESUB      STX1  ! GET_STAT+40,,AUTO

      777     4497    3         IF OD_CXT.ONLP ~= 0

   4497  8 001016   000007 220000 xsym               LDX0    OD_CXT+7
         8 001017   001025 601000 8                  TNZ     s:4501
         8 001020   000007 722000 xsym               LXL2    OD_CXT+7
         8 001021   001025 601000 8                  TNZ     s:4501
         8 001022   000002 235000 xsym               LDA     OD_CXT+2
         8 001023   000017 115007                    CMPA    15,DL
         8 001024   001101 605400 8                  TPNZ    s:4521

      778     4498    3         OR OD_CXT.FORCE ~= 0
      779     4499    3         OR OD_CXT.NDISPED <= ODMI_ITMX# THEN
      780     4500    4           DO;

      781     4501    4           IF OD_CXT.ONLP ~= 0                                              /*#13.29*/

   4501  8 001025   000000 100003                    CMPX0   0,DU
         8 001026   001061 600000 8                  TZE     s:4513
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:84   
         8 001027   000000 236007 xsym               LDQ     M$LO,DL
         8 001030   000000 470400 9                  LDP0    0
         8 001031   000000 471500                    LDP1    0,,PR0
         8 001032   100000 473506                    LDP3    0,QL,PR1
         8 001033   300031 236100                    LDQ     25,,PR3
         8 001034   020000 316007                    CANQ    8192,DL
         8 001035   001061 601000 8                  TNZ     s:4513

      782     4502    4           AND NOT DCBADDR(DCBNUM(M$LO))->F$DCB.FCD THEN
      783     4503    5             DO;

      784     4504    5             IF OD_SGHST THEN

   4504  8 001036   000000 235000 xsym               LDA     OD_SGHST
         8 001037   001056 600000 8                  TZE     s:4511

      785     4505    6               DO;

      786     4506    6               IF OD_CXT.LPWSN = ' ' THEN

   4506  8 001040   040000 106400                    CMPC    fill='040'O
         8 001041   000011 000010 xsym               ADSC9   OD_CXT+9                 cn=0,n=8
         8 001042   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         8 001043   001047 601000 8                  TNZ     s:4508

      787     4507    6                OPEN_LOGHST.WSN_=VECTOR(SC_LPWSN);

   4507  8 001044   000010 237000 9                  LDAQ    8
         8 001045   000262 757000 1                  STAQ    OPEN_LOGHST+26
         8 001046   001051 710000 8                  TRA     s:4509

      788     4508    6               ELSE OPEN_LOGHST.WSN_=VECTOR(OD_CXT.LPWSN);

   4508  8 001047   000012 237000 9                  LDAQ    10
         8 001050   000262 757000 1                  STAQ    OPEN_LOGHST+26

      789     4509    6               CALL M$OPEN (OPEN_LOGHST) ALTRET(LOALT);
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:85   

   4509  8 001051   000230 630400 1                  EPPR0   OPEN_LOGHST
         8 001052   450000 713400                    CLIMB   alt,open
         8 001053   410400 401760                    pmme    nvectors=18
         8 001054   001063 702000 8                  TSX2    LOALT

      790     4510    6               END;

   4510  8 001055   001061 710000 8                  TRA     s:4513

      791     4511    5             ELSE CALL M$OPEN (OPEN_LOUSER);

   4511  8 001056   000224 630400 2                  EPPR0   OPEN_LOUSER
         8 001057   050000 713400                    CLIMB   open
         8 001060   410400 401760                    pmme    nvectors=18

      792     4512    5             END;

      793     4513    4           RETURN;

   4513  8 001061   200132 221300                    LDX1  ! GET_STAT+40,,AUTO
         8 001062   000001 702211                    TSX2  ! 1,X1

   4511  8 001063                       LOALT        null
      794     4514    4   LOALT:  ;
      795     4515    4           OPMSG_KERR.SUBC=ODKE_NOPLO#;

   4515  8 001063   000015 236003                    LDQ     13,DU
         8 001064   000077 552020 1                  STBQ    OPMSG_KERR+8,'20'O

      796     4516    4           OPMSG_KERR.ERRC=B$ERRCODE;

   4516  8 001065   000000 470400 xsym               LDP0    B$TCB$
         8 001066   000000 471500                    LDP1    0,,PR0
         8 001067   100102 236100                    LDQ     66,,PR1
         8 001070   000003 772000                    QRL     3
         8 001071   037777 376007                    ANQ     16383,DL
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:86   
         8 001072   000000 620006                    EAX0    0,QL
         8 001073   000100 740000 1                  STX0    OPMSG_KERR+9

      797     4517    4           OPMSG_KERR.LPWSN=OD_CXT.LPWSN;

   4517  8 001074   040000 100400                    MLR     fill='040'O
         8 001075   000011 000010 xsym               ADSC9   OD_CXT+9                 cn=0,n=8
         8 001076   000111 400010 1                  ADSC9   OPMSG_KERR+18            cn=2,n=8

      798     4518    4           ALTRETURN;

   4518  8 001077   200132 221300                    LDX1  ! GET_STAT+40,,AUTO
         8 001100   000000 702211                    TSX2  ! 0,X1

      799     4519    4           END;
      800     4520
      801     4521    3         OPMSG_KERR.SUBC=ODKE_TMITM#;

   4521  8 001101   000001 236003                    LDQ     1,DU
         8 001102   000077 552020 1                  STBQ    OPMSG_KERR+8,'20'O

      802     4522    3         OPMSG_KERR.NFOUND=OD_CXT.NDISPED;

   4522  8 001103   000000 623005                    EAX3    0,AL
         8 001104   000077 443000 1                  SXL3    OPMSG_KERR+8

      803     4523    3         ALTRETURN;

   4523  8 001105   000000 702211                    TSX2  ! 0,X1

      804     4524    3   END DONESUB;
      805     4525
      806     4526
      807     4527
      808     4528
      809     4529                                /* ALLOCATE A BUFFER AND DO M$JOBSTATS INTO IT */
      810     4530
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:87   
      811     4531    2   GETO: PROC ALTRET;

   4531  8 001106   200132 741300       GETO         STX1  ! GET_STAT+40,,AUTO

      812     4532    3         O_CRITERIA.FORM#     =OD_CXT.SFORM;

   4532  8 001107   040100 100400                    MLR     fill='040'O
         8 001110   000023 000006 xsym               ADSC9   OD_CXT+19                cn=0,n=6
         8 001111   200021 000006                    ADSC9   O_CRITERIA+13,,AUTO      cn=0,n=6

      813     4533    3         O_CRITERIA.NOTFORM#=BINBIT(OD_CXT.NOTFORM,1);

   4533  8 001112   000024 236000 xsym               LDQ     OD_CXT+20
         8 001113   000011 772000                    QRL     9
         8 001114   000777 376007                    ANQ     511,DL
         8 001115   000043 736000                    QLS     35
         8 001116   000013 772000                    QRL     11
         8 001117   200014 676100                    ERQ     O_CRITERIA+8,,AUTO
         8 001120   000100 376003                    ANQ     64,DU
         8 001121   200014 656100                    ERSQ    O_CRITERIA+8,,AUTO

      814     4534    3         O_CRITERIA.NOTACCT#=BINBIT(OD_CXT.NOTACCT,1);

   4534  8 001122   000013 236000 xsym               LDQ     OD_CXT+11
         8 001123   000011 772000                    QRL     9
         8 001124   000777 376007                    ANQ     511,DL
         8 001125   000043 736000                    QLS     35
         8 001126   000010 772000                    QRL     8
         8 001127   200014 676100                    ERQ     O_CRITERIA+8,,AUTO
         8 001130   001000 376003                    ANQ     512,DU
         8 001131   200014 656100                    ERSQ    O_CRITERIA+8,,AUTO

      815     4535    3         IF OD_SGHST THEN O_CRITERIA.ACCT#=OD_CXT.SACCT;

   4535  8 001132   000000 235000 xsym               LDA     OD_SGHST
         8 001133   001140 600000 8                  TZE     s:4538

PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:88   
   4535  8 001134   040100 100400                    MLR     fill='040'O
         8 001135   000021 000010 xsym               ADSC9   OD_CXT+17                cn=0,n=8
         8 001136   200010 000010                    ADSC9   O_CRITERIA+4,,AUTO       cn=0,n=8
         8 001137   001156 710000 8                  TRA     s:4541

      816     4536    3         ELSE
      817     4537    4           DO;

      818     4538    4           IF OD_CXT.SACCT ~= ' ' THEN

   4538  8 001140   040000 106400                    CMPC    fill='040'O
         8 001141   000021 000010 xsym               ADSC9   OD_CXT+17                cn=0,n=8
         8 001142   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         8 001143   001150 600000 8                  TZE     s:4540

      819     4539    4            O_CRITERIA.ACCT#=OD_CXT.SACCT;

   4539  8 001144   040100 100400                    MLR     fill='040'O
         8 001145   000021 000010 xsym               ADSC9   OD_CXT+17                cn=0,n=8
         8 001146   200010 000010                    ADSC9   O_CRITERIA+4,,AUTO       cn=0,n=8
         8 001147   001156 710000 8                  TRA     s:4541

      820     4540    4           ELSE IF ALLFLG = 0 THEN O_CRITERIA.ACCT#=B$JIT$->B$JIT.ACCN;

   4540  8 001150   000000 236000 1                  LDQ     ALLFLG
         8 001151   001156 601000 8                  TNZ     s:4541

   4540  8 001152   000000 470400 xsym               LDP0    B$JIT$
         8 001153   040100 100500                    MLR     fill='040'O
         8 001154   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         8 001155   200010 000010                    ADSC9   O_CRITERIA+4,,AUTO       cn=0,n=8

      821     4541    4           END;

   4541  8 001156   001160 710000 8                  TRA     s:4543

      822     4542    3   GETO1: ENTRY ALTRET;
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:89   

   4542  8 001157   200132 741300       GETO1        STX1  ! GET_STAT+40,,AUTO

      823     4543    3         GET_STAT.V.OUTPUT#='1'B;

   4543  8 001160   400000 236003                    LDQ     -131072,DU
         8 001161   200115 256100                    ORSQ    GET_STAT+27,,AUTO

      824     4544    3         GET_STAT.CRITERIA_=VECTOR(O_CRITERIA);

   4544  8 001162   000014 235000 9                  LDA     12
         8 001163   200134 452500                    STP2    GET_STAT+42,,AUTO
         8 001164   200134 236100                    LDQ     GET_STAT+42,,AUTO
         8 001165   000004 036003                    ADLQ    4,DU
         8 001166   200070 757100                    STAQ    GET_STAT+6,,AUTO

      825     4545    3         O_CRITERIA.WSN#=OD_CXT.SWSN;

   4545  8 001167   040100 100400                    MLR     fill='040'O
         8 001170   000015 000010 xsym               ADSC9   OD_CXT+13                cn=0,n=8
         8 001171   200006 000010                    ADSC9   O_CRITERIA+2,,AUTO       cn=0,n=8

      826     4546    3         O_CRITERIA.NOTWSN#=BINBIT(OD_CXT.NOTWSN,1);

   4546  8 001172   000013 236000 xsym               LDQ     OD_CXT+11
         8 001173   000777 376007                    ANQ     511,DL
         8 001174   000043 736000                    QLS     35
         8 001175   000011 772000                    QRL     9
         8 001176   200014 676100                    ERQ     O_CRITERIA+8,,AUTO
         8 001177   000400 376003                    ANQ     256,DU
         8 001200   200014 656100                    ERSQ    O_CRITERIA+8,,AUTO

      827     4547    3         CALL M$GDP (GETP) ALTRET(NOMEM);

   4547  8 001201   000504 630400 2                  EPPR0   GETP
         8 001202   430003 713400                    CLIMB   alt,+12291
         8 001203   400400 401760                    pmme    nvectors=2
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:90   
         8 001204   001303 702000 8                  TSX2    NOMEM

      828     4548    3         OD_CXT.SEG$=GDPVEC.PTR$;

   4548  8 001205   000345 236000 1                  LDQ     GDPVEC+1
         8 001206   000000 756000 xsym               STQ     OD_CXT

      829     4549    3         GET_STAT.RESULTS_=GDPVEC;

   4549  8 001207   000344 237000 1                  LDAQ    GDPVEC
         8 001210   200066 757100                    STAQ    GET_STAT+4,,AUTO

   4549  8 001211                       LOOP         null
      830     4550    3   LOOP: ;
      831     4551    3         CALL M$JOBSTATS (GET_STAT) ALTRET(JALT);

   4551  8 001211   200062 630500                    EPPR0   GET_STAT,,AUTO
         8 001212   570001 713400                    CLIMB   alt,+61441
         8 001213   405400 401760                    pmme    nvectors=12
         8 001214   001222 702000 8                  TSX2    JALT

   4549  8 001215                       DONE         null
      832     4552    3   DONE: ;
      833     4553    3         OD_CXT.NFOUND=OD_CXT.SEG$->R$OUTPUT.FOUND;

   4553  8 001215   000000 470400 xsym               LDP0    OD_CXT
         8 001216   000000 720100                    LXL0    0,,PR0
         8 001217   000001 740000 xsym               STX0    OD_CXT+1

      834     4554    3         RETURN;

   4554  8 001220   200132 221300                    LDX1  ! GET_STAT+40,,AUTO
         8 001221   000001 702211                    TSX2  ! 1,X1

   4553  8 001222                       JALT         null
      835     4555    3   JALT: ;
      836     4556    3         IF B$ERRCODE = %E$JSIRAS THEN
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:91   

   4556  8 001222   000000 470400 xsym               LDP0    B$TCB$
         8 001223   000000 471500                    LDP1    0,,PR0
         8 001224   100102 236100                    LDQ     66,,PR1
         8 001225   377770 376007                    ANQ     131064,DL
         8 001226   021320 116007                    CMPQ    8912,DL
         8 001227   001244 601000 8                  TNZ     JALT1

      837     4557    4           DO;

      838     4558    4           ADDR(GET_STAT.RESULTS_)->B$$VECTOR.W1.VSIZE#=

   4558  8 001230   200066 236100                    LDQ     GET_STAT+4,,AUTO
         8 001231   000020 772000                    QRL     16
         8 001232   050000 036007                    ADLQ    20480,DL
         8 001233   000020 736000                    QLS     16
         8 001234   200066 676100                    ERQ     GET_STAT+4,,AUTO
         8 001235   000034 376000 xsym               ANQ     B_VECTNIL+28
         8 001236   200066 656100                    ERSQ    GET_STAT+4,,AUTO

      839     4559    4           ADDR(GET_STAT.RESULTS_)->B$$VECTOR.W1.VSIZE#+(ODMI_NPGG#*4096);
      840     4560    4           CALL M$GDP (GETP) ALTRET(NOMEM);

   4560  8 001237   000504 630400 2                  EPPR0   GETP
         8 001240   430003 713400                    CLIMB   alt,+12291
         8 001241   400400 401760                    pmme    nvectors=2
         8 001242   001303 702000 8                  TSX2    NOMEM

      841     4561    4           GOTO LOOP;

   4561  8 001243   001211 710000 8                  TRA     LOOP

   4560  8 001244                       JALT1        null
      842     4562    4           END;
      843     4563    3   JALT1:;
      844     4564    3         IF B$ERRCODE = %E$SQRCVR THEN

PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:92   
   4564  8 001244   000000 470400 xsym               LDP0    B$TCB$
         8 001245   000000 471500                    LDP1    0,,PR0
         8 001246   100102 236100                    LDQ     66,,PR1
         8 001247   377770 376007                    ANQ     131064,DL
         8 001250   021400 116007                    CMPQ    8960,DL
         8 001251   001256 601000 8                  TNZ     s:4569

      845     4565    4           DO;

      846     4566    4           OPMSG_KERR.SUBC=ODKE_SQRIP#;

   4566  8 001252   000017 236003                    LDQ     15,DU
         8 001253   000077 552020 1                  STBQ    OPMSG_KERR+8,'20'O

      847     4567    4           ALTRETURN;

   4567  8 001254   200132 221300                    LDX1  ! GET_STAT+40,,AUTO
         8 001255   000000 702211                    TSX2  ! 0,X1

      848     4568    4           END;
      849     4569    3         IF B$ERRCODE = %E$NOTFND THEN

   4569  8 001256   021260 116007                    CMPQ    8880,DL
         8 001257   001264 601000 8                  TNZ     s:4574

      850     4570    4           DO;

      851     4571    4           OD_CXT.NFOUND=0;

   4571  8 001260   000000 220003                    LDX0    0,DU
         8 001261   000001 740000 xsym               STX0    OD_CXT+1

      852     4572    4           RETURN;

   4572  8 001262   200132 221300                    LDX1  ! GET_STAT+40,,AUTO
         8 001263   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:93   
      853     4573    4           END;
      854     4574    3         IF NOT OD_SGHST THEN CALL M$MERC;

   4574  8 001264   000000 235000 xsym               LDA     OD_SGHST
         8 001265   001270 601000 8                  TNZ     s:4575

   4574  8 001266   010007 713400                    CLIMB   4103
         8 001267   000000 401760                    pmme    nvectors=0

      855     4575    3         OPMSG_KERR.SUBC=ODKE_JSERR#;

   4575  8 001270   000012 236003                    LDQ     10,DU
         8 001271   000077 552020 1                  STBQ    OPMSG_KERR+8,'20'O

      856     4576    3         OPMSG_KERR.ERRC=B$ERRCODE;

   4576  8 001272   000000 470400 xsym               LDP0    B$TCB$
         8 001273   000000 471500                    LDP1    0,,PR0
         8 001274   100102 236100                    LDQ     66,,PR1
         8 001275   000003 772000                    QRL     3
         8 001276   037777 376007                    ANQ     16383,DL
         8 001277   000000 620006                    EAX0    0,QL
         8 001300   000100 740000 1                  STX0    OPMSG_KERR+9

      857     4577    3         ALTRETURN;

   4577  8 001301   200132 221300                    LDX1  ! GET_STAT+40,,AUTO
         8 001302   000000 702211                    TSX2  ! 0,X1

   4576  8 001303                       NOMEM        null
      858     4578    3   NOMEM:;
      859     4579    3         OPMSG_KERR.SUBC=ODKE_NDATA#;

   4579  8 001303   000000 236003                    LDQ     0,DU
         8 001304   000077 552020 1                  STBQ    OPMSG_KERR+8,'20'O

      860     4580    3         ALTRETURN;
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:94   

   4580  8 001305   200132 221300                    LDX1  ! GET_STAT+40,,AUTO
         8 001306   000000 702211                    TSX2  ! 0,X1

      861     4581
      862     4582
      863     4583    3   GETI: ENTRY ALTRET;

   4583  8 001307   200132 741300       GETI         STX1  ! GET_STAT+40,,AUTO

      864     4584    3         I_CRITERIA.NOTACCT#=BINBIT(OD_CXT.NOTACCT,1);

   4584  8 001310   000013 236000 xsym               LDQ     OD_CXT+11
         8 001311   000011 772000                    QRL     9
         8 001312   000777 376007                    ANQ     511,DL
         8 001313   000043 736000                    QLS     35
         8 001314   000010 772000                    QRL     8
         8 001315   200040 676100                    ERQ     I_CRITERIA+8,,AUTO
         8 001316   001000 376003                    ANQ     512,DU
         8 001317   200040 656100                    ERSQ    I_CRITERIA+8,,AUTO

      865     4585    3         IF OD_SGHST THEN I_CRITERIA.ACCT#=OD_CXT.SACCT;

   4585  8 001320   000000 235000 xsym               LDA     OD_SGHST
         8 001321   001326 600000 8                  TZE     s:4588

   4585  8 001322   040100 100400                    MLR     fill='040'O
         8 001323   000021 000010 xsym               ADSC9   OD_CXT+17                cn=0,n=8
         8 001324   200034 000010                    ADSC9   I_CRITERIA+4,,AUTO       cn=0,n=8
         8 001325   001344 710000 8                  TRA     s:4591

      866     4586    3         ELSE
      867     4587    4           DO;

      868     4588    4           IF OD_CXT.SACCT ~= ' ' THEN

   4588  8 001326   040000 106400                    CMPC    fill='040'O
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:95   
         8 001327   000021 000010 xsym               ADSC9   OD_CXT+17                cn=0,n=8
         8 001330   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         8 001331   001336 600000 8                  TZE     s:4590

      869     4589    4            I_CRITERIA.ACCT#=OD_CXT.SACCT;

   4589  8 001332   040100 100400                    MLR     fill='040'O
         8 001333   000021 000010 xsym               ADSC9   OD_CXT+17                cn=0,n=8
         8 001334   200034 000010                    ADSC9   I_CRITERIA+4,,AUTO       cn=0,n=8
         8 001335   001344 710000 8                  TRA     s:4591

      870     4590    4           ELSE IF ALLFLG = 0 THEN I_CRITERIA.ACCT#=B$JIT$->B$JIT.ACCN;

   4590  8 001336   000000 236000 1                  LDQ     ALLFLG
         8 001337   001344 601000 8                  TNZ     s:4591

   4590  8 001340   000000 470400 xsym               LDP0    B$JIT$
         8 001341   040100 100500                    MLR     fill='040'O
         8 001342   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         8 001343   200034 000010                    ADSC9   I_CRITERIA+4,,AUTO       cn=0,n=8

      871     4591    4           END;

   4591  8 001344   001346 710000 8                  TRA     s:4593

      872     4592    3   GETI1: ENTRY ALTRET;

   4592  8 001345   200132 741300       GETI1        STX1  ! GET_STAT+40,,AUTO

      873     4593    3         GET_STAT.V.OUTPUT#='0'B;

   4593  8 001346   000031 236000 xsym               LDQ     B_VECTNIL+25
         8 001347   200115 356100                    ANSQ    GET_STAT+27,,AUTO

      874     4594    3         GET_STAT.CRITERIA_=VECTOR(I_CRITERIA);

   4594  8 001350   000014 235000 9                  LDA     12
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:96   
         8 001351   200134 452500                    STP2    GET_STAT+42,,AUTO
         8 001352   200134 236100                    LDQ     GET_STAT+42,,AUTO
         8 001353   000030 036003                    ADLQ    24,DU
         8 001354   200070 757100                    STAQ    GET_STAT+6,,AUTO

      875     4595    3         I_CRITERIA.NOTWSN#=BINBIT(OD_CXT.NOTWSN,1);

   4595  8 001355   000013 236000 xsym               LDQ     OD_CXT+11
         8 001356   000777 376007                    ANQ     511,DL
         8 001357   000043 736000                    QLS     35
         8 001360   000011 772000                    QRL     9
         8 001361   200040 676100                    ERQ     I_CRITERIA+8,,AUTO
         8 001362   000400 376003                    ANQ     256,DU
         8 001363   200040 656100                    ERSQ    I_CRITERIA+8,,AUTO

      876     4596    3         I_CRITERIA.WSN#=OD_CXT.SWSN;

   4596  8 001364   040100 100400                    MLR     fill='040'O
         8 001365   000015 000010 xsym               ADSC9   OD_CXT+13                cn=0,n=8
         8 001366   200032 000010                    ADSC9   I_CRITERIA+2,,AUTO       cn=0,n=8

      877     4597    3         CALL M$GDP (GETP3) ALTRET(NOMEM);

   4597  8 001367   000512 630400 2                  EPPR0   GETP3
         8 001370   430003 713400                    CLIMB   alt,+12291
         8 001371   400400 401760                    pmme    nvectors=2
         8 001372   001303 702000 8                  TSX2    NOMEM

      878     4598    3         OD_CXT.SEG$=GDPVEC.PTR$;

   4598  8 001373   000345 236000 1                  LDQ     GDPVEC+1
         8 001374   000000 756000 xsym               STQ     OD_CXT

      879     4599    3         IF RESLIST = 0 THEN

   4599  8 001375   200056 235100                    LDA     RESLIST,,AUTO
         8 001376   001402 601000 8                  TNZ     s:4603
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:97   

      880     4600    3          GET_STAT.RESULTS_=GDPVEC;

   4600  8 001377   000344 237000 1                  LDAQ    GDPVEC
         8 001400   200066 757100                    STAQ    GET_STAT+4,,AUTO
         8 001401   001417 710000 8                  TRA     ILOOP

      881     4601    3         ELSE
      882     4602    4           DO;

      883     4603    4           GET_STAT.RESULTS_=VECTOR(OD_CXT.SEG$->B$$PAGE);

   4603  8 001402   000015 235000 9                  LDA     13
         8 001403   200066 757100                    STAQ    GET_STAT+4,,AUTO

      884     4604    4           OD_CXT.RES$=PINCRW(OD_CXT.SEG$,1024);

   4604  8 001404   000000 236000 xsym               LDQ     OD_CXT
         8 001405   002000 036003                    ADLQ    1024,DU
         8 001406   000004 756000 xsym               STQ     OD_CXT+4

      885     4605    4           OD_CXT.SN$ =PINCRW(OD_CXT.RES$,1024);

   4605  8 001407   002000 036003                    ADLQ    1024,DU
         8 001410   000003 756000 xsym               STQ     OD_CXT+3

      886     4606    4           GET_STAT.RESLIST_=VECTOR(OD_CXT.RES$->B$$PAGE);

   4606  8 001411   000015 235000 9                  LDA     13
         8 001412   000004 236000 xsym               LDQ     OD_CXT+4
         8 001413   200100 757100                    STAQ    GET_STAT+14,,AUTO

      887     4607    4           GET_STAT.SNLIST_=VECTOR(OD_CXT.SN$->B$$PAGE);

   4607  8 001414   000015 235000 9                  LDA     13
         8 001415   000003 236000 xsym               LDQ     OD_CXT+3
         8 001416   200076 757100                    STAQ    GET_STAT+12,,AUTO
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:98   

      888     4608    4           END;

   4605  8 001417                       ILOOP        null
      889     4609    3   ILOOP:;
      890     4610    3         CALL M$JOBSTATS (GET_STAT) ALTRET(JIALT);

   4610  8 001417   200062 630500                    EPPR0   GET_STAT,,AUTO
         8 001420   570001 713400                    CLIMB   alt,+61441
         8 001421   405400 401760                    pmme    nvectors=12
         8 001422   001424 702000 8                  TSX2    JIALT

      891     4611    3         GOTO DONE;

   4611  8 001423   001215 710000 8                  TRA     DONE

   4605  8 001424                       JIALT        null
      892     4612    3   JIALT:;
      893     4613    3         IF B$ERRCODE = %E$JSIRAS THEN

   4613  8 001424   000000 470400 xsym               LDP0    B$TCB$
         8 001425   000000 471500                    LDP1    0,,PR0
         8 001426   100102 236100                    LDQ     66,,PR1
         8 001427   377770 376007                    ANQ     131064,DL
         8 001430   021320 116007                    CMPQ    8912,DL
         8 001431   001460 601000 8                  TNZ     s:4629

      894     4614    4           DO;

      895     4615    4           ADDR(GET_STAT.RESULTS_)->B$$VECTOR.W1.VSIZE#=

   4615  8 001432   200066 236100                    LDQ     GET_STAT+4,,AUTO
         8 001433   000020 772000                    QRL     16
         8 001434   050000 036007                    ADLQ    20480,DL
         8 001435   000020 736000                    QLS     16
         8 001436   200066 676100                    ERQ     GET_STAT+4,,AUTO
         8 001437   000034 376000 xsym               ANQ     B_VECTNIL+28
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:99   
         8 001440   200066 656100                    ERSQ    GET_STAT+4,,AUTO

      896     4616    4           ADDR(GET_STAT.RESULTS_)->B$$VECTOR.W1.VSIZE#+(ODMI_NPGG#*4096);
      897     4617    4           IF RESLIST ~= 0 THEN

   4617  8 001441   200056 235100                    LDA     RESLIST,,AUTO
         8 001442   001453 600000 8                  TZE     GETMORE

      898     4618    5             DO;

      899     4619    5             OD_CXT.RES$=PINCRW(OD_CXT.RES$,ODMI_NPGG#*1024);

   4619  8 001443   000004 236000 xsym               LDQ     OD_CXT+4
         8 001444   012000 036003                    ADLQ    5120,DU
         8 001445   000004 756000 xsym               STQ     OD_CXT+4

      900     4620    5             ADDR(GET_STAT.RESLIST_)->B$$VECTOR.PTR$=OD_CXT.RES$;

   4620  8 001446   200101 756100                    STQ     GET_STAT+15,,AUTO

   4620  8 001447                       GETMORE1     null
      901     4621    5   GETMORE1: ;
      902     4622    5             OD_CXT.SN$=PINCRW(OD_CXT.SN$,ODMI_NPGG#*1024);

   4622  8 001447   000003 236000 xsym               LDQ     OD_CXT+3
         8 001450   012000 036003                    ADLQ    5120,DU
         8 001451   000003 756000 xsym               STQ     OD_CXT+3

      903     4623    5             ADDR(GET_STAT.SNLIST_)->B$$VECTOR.PTR$=OD_CXT.SN$;

   4623  8 001452   200077 756100                    STQ     GET_STAT+13,,AUTO

      904     4624    5             END;

   4622  8 001453                       GETMORE      null
      905     4625    4   GETMORE:;
      906     4626    4           CALL M$GDP (GETP) ALTRET(NOMEM);
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:100  

   4626  8 001453   000504 630400 2                  EPPR0   GETP
         8 001454   430003 713400                    CLIMB   alt,+12291
         8 001455   400400 401760                    pmme    nvectors=2
         8 001456   001303 702000 8                  TSX2    NOMEM

      907     4627    4           GOTO ILOOP;

   4627  8 001457   001417 710000 8                  TRA     ILOOP

      908     4628    4           END;
      909     4629    3         ELSE IF B$ERRCODE = %E$JSIRLS THEN

   4629  8 001460   021330 116007                    CMPQ    8920,DL
         8 001461   001472 601000 8                  TNZ     s:4635

      910     4630    4            DO;

      911     4631    4            ADDR(GET_STAT.RESLIST_)->B$$VECTOR.W1.VSIZE#=

   4631  8 001462   200100 236100                    LDQ     GET_STAT+14,,AUTO
         8 001463   000020 772000                    QRL     16
         8 001464   050000 036007                    ADLQ    20480,DL
         8 001465   000020 736000                    QLS     16
         8 001466   200100 676100                    ERQ     GET_STAT+14,,AUTO
         8 001467   000034 376000 xsym               ANQ     B_VECTNIL+28
         8 001470   200100 656100                    ERSQ    GET_STAT+14,,AUTO

      912     4632    4            ADDR(GET_STAT.RESLIST_)->B$$VECTOR.W1.VSIZE#+(ODMI_NPGG#*4096);
      913     4633    4            GOTO GETMORE1;

   4633  8 001471   001447 710000 8                  TRA     GETMORE1

      914     4634    4            END;
      915     4635    3          ELSE IF B$ERRCODE = %E$JSISLS THEN

   4635  8 001472   021340 116007                    CMPQ    8928,DL
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:101  
         8 001473   001504 601000 8                  TNZ     s:4641

      916     4636    4             DO;

      917     4637    4             ADDR(GET_STAT.SNLIST_)->B$$VECTOR.W1.VSIZE#=

   4637  8 001474   200076 236100                    LDQ     GET_STAT+12,,AUTO
         8 001475   000020 772000                    QRL     16
         8 001476   050000 036007                    ADLQ    20480,DL
         8 001477   000020 736000                    QLS     16
         8 001500   200076 676100                    ERQ     GET_STAT+12,,AUTO
         8 001501   000034 376000 xsym               ANQ     B_VECTNIL+28
         8 001502   200076 656100                    ERSQ    GET_STAT+12,,AUTO

      918     4638    4             ADDR(GET_STAT.SNLIST_)->B$$VECTOR.W1.VSIZE#+(ODMI_NPGG#*4096);
      919     4639    4             GOTO GETMORE;

   4639  8 001503   001453 710000 8                  TRA     GETMORE

      920     4640    4             END;
      921     4641    3         GOTO JALT1;

   4641  8 001504   001244 710000 8                  TRA     JALT1

      922     4642    3   END GETO;
      923     4643    2   END SETUP_CXT;
      924     4644
      925     4645
      926     4646
      927     4647
      928     4648
      929     4649        /**************************************
      930     4650         **************************************
      931     4651                    DRIVE_CXT
      932     4652         **************************************
      933     4653         **************************************/
      934     4654        /*D* NAME:         DRIVE_CXT
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:102  
      935     4655             PURPOSE:      To produce output for a given keyin context
      936     4656             DESCRIPTION:  The keyin context is in
      937     4657                           the busy state and needs the next piece of
      938     4658                           output produced.  This routine writes the
      939     4659                           next item to the appropriate destination,
      940     4660                           and then if more output is required, ALTRETs,
      941     4661                           or if all output has been produced, returns
      942     4662                           after doing all required cleanup (e.g. releasing
      943     4663                           the keyin context).
      944     4664
      945     4665                           If the display is to LP, we produce the entire
      946     4666                           display before returning.  This enables us to
      947     4667                           use only one output DCB for LP displays, because
      948     4668                           the DCB is opened in SETUP_CXT, and written and
      949     4669                           then closed here. */
      950     4670    1   DRIVE_CXT: PROC ALTRET;

   4670  8 001505   200126 741300       DRIVE_CXT    STX1  ! GET_STAT+36,,AUTO

   4670  8 001506                       DRIVE        null
      951     4671
      952     4672    2   DRIVE:;
      953     4673    3           DO CASE (OD_CXT.KIN#);

   4673  8 001506   000006 220000 xsym               LDX0    OD_CXT+6
         8 001507   000012 100003                    CMPX0   10,DU
         8 001510   001512 602010 8                  TNC     DRIVE+4,X0
         8 001511   001632 710000 8                  TRA     s:4722
         8 001512   001632 710000 8                  TRA     s:4722
         8 001513   001550 710000 8                  TRA     DISPJOB
         8 001514   001555 710000 8                  TRA     DISPINPUT
         8 001515   001531 710000 8                  TRA     DISPOUTPUT
         8 001516   001524 710000 8                  TRA     s:4675
         8 001517   001626 710000 8                  TRA     DISPNORUN
         8 001520   001543 710000 8                  TRA     DISPDEFER
         8 001521   001536 710000 8                  TRA     DISPPRIO
         8 001522   001615 710000 8                  TRA     s:4708
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:103  
         8 001523   001612 710000 8                  TRA     s:4705

      954     4674    3             CASE (KEY_DISPNSFORM#);

      955     4675    3               CALL ODF$FORMAT (ODFT_OUTNS#);

   4675  8 001524   000016 630400 9                  EPPR0   14
         8 001525   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 001526   000000 701000 xent               TSX1    ODF$FORMAT
         8 001527   000000 011000                    NOP     0
         8 001530   001632 710000 8                  TRA     s:4722

      956     4676    3             CASE (KEY_DISPOUTPUT#);

   4675  8 001531                       DISPOUTPUT   null
      957     4677    3   DISPOUTPUT: ;
      958     4678    3               CALL ODF$FORMAT (ODFT_OUTSF#);

   4678  8 001531   000017 630400 9                  EPPR0   15
         8 001532   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 001533   000000 701000 xent               TSX1    ODF$FORMAT
         8 001534   000000 011000                    NOP     0
         8 001535   001632 710000 8                  TRA     s:4722

      959     4679    3             CASE (KEY_DISPPRIO#);

   4675  8 001536                       DISPPRIO     null
      960     4680    3   DISPPRIO:   ;
      961     4681    3               CALL ODF$FORMAT (ODFT_INPRI#);

   4681  8 001536   000020 630400 9                  EPPR0   16
         8 001537   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 001540   000000 701000 xent               TSX1    ODF$FORMAT
         8 001541   000000 011000                    NOP     0
         8 001542   001632 710000 8                  TRA     s:4722

      962     4682    3             CASE (KEY_DISPDEFER#);
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:104  

   4675  8 001543                       DISPDEFER    null
      963     4683    3   DISPDEFER:  ;
      964     4684    3               CALL ODF$FORMAT (ODFT_INDFR#);

   4684  8 001543   000021 630400 9                  EPPR0   17
         8 001544   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 001545   000000 701000 xent               TSX1    ODF$FORMAT
         8 001546   000000 011000                    NOP     0
         8 001547   001632 710000 8                  TRA     s:4722

      965     4685    3             CASE (KEY_DISPJOB#);

   4675  8 001550                       DISPJOB      null
      966     4686    3   DISPJOB:    ;
      967     4687    3               CALL ODF$FORMAT (ODFT_INRUN#);

   4687  8 001550   000022 630400 9                  EPPR0   18
         8 001551   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 001552   000000 701000 xent               TSX1    ODF$FORMAT
         8 001553   000000 011000                    NOP     0
         8 001554   001632 710000 8                  TRA     s:4722

      968     4688    3             CASE (KEY_DISPINPUT#);

   4687  8 001555                       DISPINPUT    null
      969     4689    3   DISPINPUT:  ;
      970     4690    3               BUF$=ADDR(OD_CXT.SEG$->R$INPUT.J(OD_CXT.NDONE));

   4690  8 001555   000001 236000 xsym               LDQ     OD_CXT+1
         8 001556   000005 736000                    QLS     5
         8 001557   000004 376000 9                  ANQ     4
         8 001560   000023 736000                    QLS     19
         8 001561   000002 036003                    ADLQ    2,DU
         8 001562   000000 036000 xsym               ADLQ    OD_CXT
         8 001563   200057 756100                    STQ     BUF$,,AUTO

PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:105  
      971     4691    4                 DO CASE (BUF$->A$INPUT.PRIO);

   4691  8 001564   200057 470500                    LDP0    BUF$,,AUTO
         8 001565   000003 236100                    LDQ     3,,PR0
         8 001566   000777 376007                    ANQ     511,DL
         8 001567   000020 136007                    SBLQ    16,DL
         8 001570   000006 116007                    CMPQ    6,DL
         8 001571   001573 602006 8                  TNC     s:4691+7,QL
         8 001572   001611 710000 8                  TRA     s:4702
         8 001573   001601 710000 8                  TRA     s:4693
         8 001574   001604 710000 8                  TRA     DISPFOLL
         8 001575   001602 710000 8                  TRA     s:4695
         8 001576   001603 710000 8                  TRA     s:4697
         8 001577   001611 710000 8                  TRA     s:4702
         8 001600   001603 710000 8                  TRA     s:4697

      972     4692    4                   CASE (%JP_RUN#);

      973     4693    4                     GOTO DISPJOB;

   4693  8 001601   001550 710000 8                  TRA     DISPJOB

      974     4694    4                   CASE (%JP_RUNAFTER#);

      975     4695    4                     GOTO DISPDEFER;

   4695  8 001602   001543 710000 8                  TRA     DISPDEFER

      976     4696    4                   CASE (%JP_WPART#,%JP_WPS#);

      977     4697    4                     GOTO DISPNORUN;

   4697  8 001603   001626 710000 8                  TRA     DISPNORUN

      978     4698    4                   CASE (%JP_FOLL#);

   4690  8 001604                       DISPFOLL     null
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:106  
      979     4699    4   DISPFOLL:         ;
      980     4700    4                     CALL ODF$FORMAT (ODFT_INFOL#);

   4700  8 001604   000023 630400 9                  EPPR0   19
         8 001605   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 001606   000000 701000 xent               TSX1    ODF$FORMAT
         8 001607   000000 011000                    NOP     0
         8 001610   001632 710000 8                  TRA     s:4722

      981     4701    4                   CASE (ELSE);

      982     4702    4                     GOTO DISPPRIO;

   4702  8 001611   001536 710000 8                  TRA     DISPPRIO

      983     4703    4                 END;

      984     4704    3             CASE (KEY_DISPALL#);

      985     4705    3               IF OD_CXT.INPCOMP ~= 0 THEN GOTO DISPOUTPUT;

   4705  8 001612   000005 721000 xsym               LXL1    OD_CXT+5
         8 001613   001531 601000 8                  TNZ     DISPOUTPUT

      986     4706    3               GOTO DISPINPUT;

   4706  8 001614   001555 710000 8                  TRA     DISPINPUT

      987     4707    3             CASE (KEY_DISPSYSID#);

      988     4708    3               IF OD_CXT.INPCOMP ~= 0 THEN GOTO DISPOUTPUT;

   4708  8 001615   000005 721000 xsym               LXL1    OD_CXT+5
         8 001616   001531 601000 8                  TNZ     DISPOUTPUT

      989     4709    3               IF OD_CXT.FULL = 0 THEN GOTO DISPINPUT;

PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:107  
   4709  8 001617   000010 222000 xsym               LDX2    OD_CXT+8
         8 001620   001555 600000 8                  TZE     DISPINPUT

      990     4710                                /* FULL DISPLAY OF WAITING JOB */
      991     4711    3               CALL ODF$FORMAT (ODFT_SYSID#);

   4711  8 001621   000024 630400 9                  EPPR0   20
         8 001622   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 001623   000000 701000 xent               TSX1    ODF$FORMAT
         8 001624   000000 011000                    NOP     0
         8 001625   001632 710000 8                  TRA     s:4722

      992     4712    3             CASE (KEY_DISPNORUN#);

   4708  8 001626                       DISPNORUN    null
      993     4713    3   DISPNORUN:  ;
      994     4714    3               CALL ODF$FORMAT (ODFT_NORUN#);

   4714  8 001626   000025 630400 9                  EPPR0   21
         8 001627   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 001630   000000 701000 xent               TSX1    ODF$FORMAT
         8 001631   000000 011000                    NOP     0

      995     4715
      996     4716    3           END;

      997     4717
      998     4718
      999     4719                                /* FALL THRU TO HERE AFTER PRODUCING ONE
     1000     4720                                   ITEM OF DISPLAY */
     1001     4721
     1002     4722    2         OD_CXT.NDONE=OD_CXT.NDONE+1;

   4722  8 001632   000001 720000 xsym               LXL0    OD_CXT+1
         8 001633   000001 621010                    EAX1    1,X0
         8 001634   000001 441000 xsym               SXL1    OD_CXT+1

PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:108  
     1003     4723    2         IF OD_CXT.NDONE < OD_CXT.NFOUND

   4723  8 001635   000001 101000 xsym               CMPX1   OD_CXT+1
         8 001636   001652 603000 8                  TRC     s:4736
         8 001637   000000 235000 xsym               LDA     OD_INT
         8 001640   001652 601000 8                  TNZ     s:4736

     1004     4724    2         AND OD_INT = 0 THEN
     1005     4725    3           DO;

     1006     4726                           /* NOT DONE YET */
     1007     4727                                /* FORCE = 2 MEANS SHORT DISPLAY UNLESS
     1008     4728                                   ON LP */
     1009     4729    3           IF OD_CXT.ONLP ~= 0 THEN GOTO DRIVE;

   4729  8 001641   000007 220000 xsym               LDX0    OD_CXT+7
         8 001642   001506 601000 8                  TNZ     DRIVE

     1010     4730    3           IF OD_CXT.FORCE ~= 2

   4730  8 001643   000007 722000 xsym               LXL2    OD_CXT+7
         8 001644   000002 102003                    CMPX2   2,DU
         8 001645   001650 601000 8                  TNZ     s:4731
         8 001646   000017 101003                    CMPX1   15,DU
         8 001647   001652 603000 8                  TRC     s:4736

     1011     4731    3           OR OD_CXT.NDONE < ODMI_ITMX# THEN ALTRETURN;

   4731  8 001650   200126 221300                    LDX1  ! GET_STAT+36,,AUTO
         8 001651   000000 702211                    TSX2  ! 0,X1

     1012     4732    3           END;
     1013     4733
     1014     4734
     1015     4735                           /* FINISHED */
     1016     4736    2         OPMSG_RESP.CADDR=OD_CXT.CADDR;                                   /*#13.38*/

PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:109  
   4736  8 001652   000006 720000 xsym               LXL0    OD_CXT+6
         8 001653   000114 740000 1                  STX0    OPMSG_RESP

     1017     4737    2         OPMSG_RESP.NDISPED=OD_CXT.NDISPED;                               /*#13.38*/

   4737  8 001654   000000 100400                    MLR     fill='000'O
         8 001655   000002 000004 xsym               ADSC9   OD_CXT+2                 cn=0,n=4
         8 001656   000122 400004 1                  ADSC9   OPMSG_RESP+6             cn=2,n=4

     1018     4738    2         OPMSG_RESP.SUBC=ODKR_DISPD#;                                       /*#13.38*/

   4738  8 001657   000000 100400                    MLR     fill='000'O
         8 001660   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         8 001661   000121 400004 1                  ADSC9   OPMSG_RESP+5             cn=2,n=4

     1019     4739    2         CALL RELMEM_CXT;

   4739  8 001662   001742 701000 8                  TSX1    RELMEM_CXT
         8 001663   000000 011000                    NOP     0

     1020     4740    2         IF  OD_CXT.KIN# = KEY_DISPALL#

   4740  8 001664   000006 220000 xsym               LDX0    OD_CXT+6
         8 001665   000011 100003                    CMPX0   9,DU
         8 001666   001700 601000 8                  TNZ     s:4748
         8 001667   000007 221000 xsym               LDX1    OD_CXT+7
         8 001670   001700 600000 8                  TZE     s:4748

     1021     4741    2         AND OD_CXT.ONLP ~= 0 THEN
     1022     4742    2          IF OD_CXT.INPCOMP = 0 THEN

   4742  8 001671   000005 722000 xsym               LXL2    OD_CXT+5
         8 001672   001700 601000 8                  TNZ     s:4748

     1023     4743    3            DO;

     1024     4744    3            OD_CXT.INPCOMP=1;
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:110  

   4744  8 001673   000001 223003                    LDX3    1,DU
         8 001674   000005 443000 xsym               SXL3    OD_CXT+5

     1025     4745    3            CALL SETUP_CXT ALTRET(MARCH_ON);

   4745  8 001675   000167 701000 8                  TSX1    SETUP_CXT
         8 001676   001730 702000 8                  TSX2    MARCH_ON

     1026     4746    3            GOTO DRIVE;

   4746  8 001677   001506 710000 8                  TRA     DRIVE

     1027     4747    3            END;
     1028     4748    2         IF OD_CXT.ONLP ~= 0 THEN

   4748  8 001700   000007 221000 xsym               LDX1    OD_CXT+7
         8 001701   001712 600000 8                  TZE     s:4756

     1029     4749    3           DO;

     1030     4750    3           CALL M$CLOSE (CLOSE_LO);

   4750  8 001702   000320 630400 2                  EPPR0   CLOSE_LO
         8 001703   050001 713400                    CLIMB   close
         8 001704   406000 401760                    pmme    nvectors=13

     1031     4751    3           IF OD_SGHST THEN

   4751  8 001705   000000 235000 xsym               LDA     OD_SGHST
         8 001706   001712 600000 8                  TZE     s:4756

     1032     4752    4             DO;

     1033     4753    4             CALL M$WRITE (OCMSG_RESP);

   4753  8 001707   000160 630400 2                  EPPR0   OCMSG_RESP
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:111  
         8 001710   040001 713400                    CLIMB   write
         8 001711   401400 401760                    pmme    nvectors=4

     1034     4754    4             END;

     1035     4755    3           END;

     1036     4756    2         IF  OD_CXT.INOUT ~= 0

   4756  8 001712   000005 236000 xsym               LDQ     OD_CXT+5
         8 001713   777000 316003                    CANQ    -512,DU
         8 001714   001726 600000 8                  TZE     MARCH_ON1
         8 001715   000005 720000 xsym               LXL0    OD_CXT+5
         8 001716   001726 601000 8                  TNZ     MARCH_ON1
         8 001717   000000 235000 xsym               LDA     OD_INT
         8 001720   001726 601000 8                  TNZ     MARCH_ON1

     1037     4757    2         AND OD_CXT.INPCOMP = 0
     1038     4758    2         AND OD_INT = 0 THEN
     1039     4759    3           DO;

     1040     4760    3           OD_CXT.INPCOMP=1;

   4760  8 001721   000001 221003                    LDX1    1,DU
         8 001722   000005 441000 xsym               SXL1    OD_CXT+5

     1041     4761    3           CALL SETUP_CXT ALTRET(MARCH_ON1);

   4761  8 001723   000167 701000 8                  TSX1    SETUP_CXT
         8 001724   001726 702000 8                  TSX2    MARCH_ON1

     1042     4762    3           GOTO DRIVE;

   4762  8 001725   001506 710000 8                  TRA     DRIVE

   4760  8 001726                       MARCH_ON1    null
     1043     4763    3   MARCH_ON1:;
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:112  
     1044     4764    3           END;

     1045     4765    2         RETURN;

   4765  8 001726   200126 221300                    LDX1  ! GET_STAT+36,,AUTO
         8 001727   000001 702211                    TSX2  ! 1,X1

   4756  8 001730                       MARCH_ON     null
     1046     4766    2   MARCH_ON:;                                                               /*#13.38*/
     1047     4767    2         CALL M$CLOSE (CLOSE_LO);                                           /*#13.38*/

   4767  8 001730   000320 630400 2                  EPPR0   CLOSE_LO
         8 001731   050001 713400                    CLIMB   close
         8 001732   406000 401760                    pmme    nvectors=13

     1048     4768    2         IF OD_SGHST THEN                                                   /*#13.38*/

   4768  8 001733   000000 235000 xsym               LDA     OD_SGHST
         8 001734   001740 600000 8                  TZE     s:4772

     1049     4769    3           DO;                                                              /*#13.38*/

     1050     4770    3           CALL M$WRITE (OCMSG_RESP);                                       /*#13.38*/

   4770  8 001735   000160 630400 2                  EPPR0   OCMSG_RESP
         8 001736   040001 713400                    CLIMB   write
         8 001737   401400 401760                    pmme    nvectors=4

     1051     4771    3           END;                                                             /*#13.38*/

     1052     4772    2         RETURN;                                                            /*#13.38*/

   4772  8 001740   200126 221300                    LDX1  ! GET_STAT+36,,AUTO
         8 001741   000001 702211                    TSX2  ! 1,X1

     1053     4773    2   END DRIVE_CXT;
     1054     4774
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:113  
     1055     4775
     1056     4776
     1057     4777
     1058     4778        /**************************************
     1059     4779         **************************************
     1060     4780                    RELMEM_CXT
     1061     4781         **************************************
     1062     4782         **************************************/
     1063     4783        /*D* NAME:         RELMEM_CXT
     1064     4784             PURPOSE:      To release the memory in a context's buffer segment
     1065     4785        */
     1066     4786    1   RELMEM_CXT: PROC;

   4786  8 001742   200132 741300       RELMEM_CXT   STX1  ! GET_STAT+40,,AUTO

     1067     4787    2         CALL M$FDP (RELP) ALTRET(A1);

   4787  8 001743   000520 630400 2                  EPPR0   RELP
         8 001744   430004 713400                    CLIMB   alt,+12292
         8 001745   400400 401760                    pmme    nvectors=2
         8 001746   001747 702000 8                  TSX2    A1

   4787  8 001747                       A1           null
     1068     4788    2   A1:   ;
     1069     4789    2         RETURN;

   4789  8 001747   200132 221300                    LDX1  ! GET_STAT+40,,AUTO
         8 001750   000001 702211                    TSX2  ! 1,X1

     1070     4790    2   END RELMEM_CXT;
     1071     4791        /**************************************
     1072     4792         **************************************
     1073     4793                    MISC_SETUP
     1074     4794         **************************************
     1075     4795         **************************************/
     1076     4796    1   MISC_SETUP: PROC;

PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:114  
   4796  8 001751   200126 741300       MISC_SETUP   STX1  ! GET_STAT+36,,AUTO

     1077     4797    2         CALL M$DISPRES (GET_PSEUDOS);

   4797  8 001752   000322 630400 1                  EPPR0   GET_PSEUDOS
         8 001753   150002 713400                    CLIMB   53250
         8 001754   402400 401760                    pmme    nvectors=6

     1078     4798    2   END MISC_SETUP;

   4798  8 001755   200126 221300                    LDX1  ! GET_STAT+36,,AUTO
         8 001756   000001 702211                    TSX2  ! 1,X1

     1079     4799    1   END ODD$DOG;

   4799  8 001757   000000 702200 xent               TSX2  ! X66_MARET

PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:115  
--  Include file information  --

   XSJ_SUBS_C.:E05TOU  is referenced.
   XSJ_MAC_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   KC_ERRORS_C.:E05TOU  is referenced.
   FO_ERRORS_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   OD_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   OD_MAC_C.:E05TOU  is referenced.
   OD_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ODD$DOG.
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:116  

 **** Variables and constants ****

  ****  Section 001  Data  ODD$DOG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 ALLFLG                     5-0-0/w CHAR(8)     r     1 EHMSG
   344-0-0/d STRC(72)    r     1 GDPVEC                   322-0-0/d STRC(648)   r     1 GET_PSEUDOS
    66-0-0/w UBIN        r     1 GOODNGT                    1-0-0/c CHAR(15)    r     1 HIMSG
    40-0-0/d STRC(288)   r     1 JOPN                      56-0-0/d STRC(288)   r     1 JREAD
    50-0-0/w STRC(180)   r     1 JREC                      16-0-0/w CHAR(32)    r     1 NOMEMMSG
     7-0-0/w CHAR(8)     r     1 NONEMSG                  230-0-0/d STRC(2088)  r     1 OPEN_LOGHST
   131-0-0/c STRC(198)   r     1 OPMSG_ILLKEY              67-0-0/c STRC(738)   r     1 OPMSG_KERR
   114-0-0/c STRC(270)   r     1 OPMSG_RESP               124-0-0/c STRC(180)   r     1 OPMSG_UNIMP
    26-0-0/w CHAR(40)    r     1 SQRIPMSG                 204-0-0/d STRC(702)   r     1 STAT_CRITERIA
   140-0-0/d STRC(1296)  r     1 STAT_FPT                  11-0-0/c STRC(180)   r     1 TMMSG

  ****  Section 002 RoData ODD$DOG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   320-0-0/d STRC(1080)  r     1 CLOSE_LO                 112-0-0/c STRC(45)    r     1 CSCGNAME
   114-0-0/w STRC(432)   r     1 DOGNAME                  504-0-0/d STRC(216)   r     1 GETP
   512-0-0/d STRC(216)   r     1 GETP3                     14-0-0/d STRC(144)   r     1 INTSET
   174-0-0/d STRC(432)   r     1 OCMSG_ILLKEY             144-0-0/d STRC(432)   r     1 OCMSG_KERR
   160-0-0/d STRC(432)   r     1 OCMSG_RESP               210-0-0/d STRC(432)   r     1 OCMSG_UNIMP
    20-0-0/d STRC(2088)  r     1 OPEN_CSCG                224-0-0/d STRC(2088)  r     1 OPEN_LOUSER
   356-0-0/d STRC(504)   r     1 READ_SI                  520-0-0/d STRC(216)   r     1 RELP
   316-0-0/c STRC(72)    r     1 SC_LPWSN                 424-0-0/d STRC(432)   r     1 WRITE_EH
   410-0-0/d STRC(432)   r     1 WRITE_HI                 454-0-0/d STRC(432)   r     1 WRITE_NOMEM
   440-0-0/d STRC(432)   r     1 WRITE_NONE               374-0-0/d STRC(432)   r     1 WRITE_SQRIP
   470-0-0/d STRC(432)   r     1 WRITE_TM                 130-0-0/d STRC(432)   r     1 WRITE_ZAPRESP
     6-0-0/d STRC(216)   r     1 XCONSET                    0-0-0/c STRC(180)   r     1 ZAPRESP

  ****  Auto variables  ****
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:117  

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    57-0-0/w PTR         r     1 BUF$                      62-0-0/d STRC(1296)  r     1 GET_STAT
     3-0-0/w UBIN        r     1 I                         30-0-0/d STRC(702)   r     1 I_CRITERIA
    55-0-0/w UBIN        r     1 K                          4-0-0/d STRC(702)   r     1 O_CRITERIA
    56-0-0/w UBIN        r     1 RESLIST

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/w ASTR(9)     r     1 B_VERSION                  0-0-0/d CHAR(140)   r     1 OD_CSCGBUF
     0-0-0/w STRC(792)   r     1 OD_CXT                     0-0-0/w STRC(792)   r     1 OD_CXT_INIT
     0-0-0/w UBIN        r     1 OD_INT                     0-0-0/w UBIN        r     1 OD_OBMAX
     0-0-0/d STRC(1116)  r     1 OD_PSEUDOS                 0-0-0/d STRC(504)   r     1 OD_READCSCG
     0-0-0/w BIT         r     1 OD_SGHST

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2304)  r     1 A$INPUT                    0-0-0/w UBIN        r     1 B$$PAGE(0:1023)
     0-0-0/d STRC(72)    r     1 B$$VECTOR                  0-0-0/w STRC(2448)  r     1 B$ALT
     0-0-0/d STRC(2088)  r     1 B$JIT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$CSCG
     0-0-0N  NULL        r     1 M$JSF                      0-0-0N  NULL        r     1 M$LO
     0-0-0N  NULL        r     1 M$ME                       0-0-0N  NULL        r     1 M$SI
     0-0-0/w STRC(576)   r     1 OD$KEYIN                   0-0-0/d STRC(2376)  r     1 R$INPUT
     0-0-0/d STRC(1080)  r     1 R$OUTPUT

PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:118  

   Procedure ODD$DOG requires 1008 words for executable code.
   Procedure ODD$DOG requires 94 words of local(AUTO) storage.

    No errors detected in file ODD$DOG.:E05TSI    .
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:119  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:120  
          MINI XREF LISTING

A$INPUT.PRIO
      2582**DCL      4377>>IF       4691>>DOCASE
A1 IN PROCEDURE RELMEM_CXT
      4787**LABEL    4787--CALLALT
ALLFLG
      2777**DCL      4143<>CALL     4540>>IF       4590>>IF
B$$PAGE
      2622**DCL      4603--ASSIGN   4606--ASSIGN   4607--ASSIGN
B$$VECTOR.PTR$
      2636**DCL      4620<<ASSIGN   4623<<ASSIGN
B$$VECTOR.W1.VSIZE#
      2634**DCL      4558<<ASSIGN   4558>>ASSIGN   4615<<ASSIGN   4615>>ASSIGN   4631<<ASSIGN   4631>>ASSIGN
      4637<<ASSIGN   4637>>ASSIGN
B$$VECTOR.W2
      2635**DCL      2636--REDEF
B$ALT.CODE
      2517**DCL      2517--REDEF    2518--REDEF    2518--REDEF
B$ALT.ERR.CODE
      2519**DCL      4516>>ASSIGN   4556>>IF       4564>>IF       4569>>IF       4576>>ASSIGN   4613>>IF
      4629>>IF       4635>>IF
B$ALT.ERR.ERR#
      2519**DCL      2519--REDEF
B$ALT.EVID
      2518**DCL      2518--REDEF    2518--REDEF
B$JIT.ACCN
      2426**DCL      4540>>ASSIGN   4590>>ASSIGN
B$JIT.ERR.MID
      2427**DCL      2427--REDEF
B$JIT.USER
      2426**DCL      4071>>IF
B$JIT$
      2979**DCL      4071>>IF       4540>>ASSIGN   4590>>ASSIGN
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:121  
B$TCB.ALT$
      2513**DCL      4516>>ASSIGN   4556>>IF       4564>>IF       4569>>IF       4576>>ASSIGN   4613>>IF
      4629>>IF       4635>>IF
B$TCB$
      2980**DCL      4516>>ASSIGN   4556>>IF       4564>>IF       4569>>IF       4576>>ASSIGN   4613>>IF
      4629>>IF       4635>>IF
BADCMD
      4145**LABEL    4143--CALLALT
BUF$
      2748**DCL      4376<<ASSIGN   4377>>IF       4690<<ASSIGN   4691>>DOCASE
B_VERSION.L#
      2992**DCL      2993--IMP-SIZ  4087>>CALLBLT  4087>>CALLBLT
B_VERSION.TXT
      2993**DCL      4087>>CALLBLT
CLOSE_LO
      3697**DCL      4465<>CALL     4750<>CALL     4767<>CALL
CLOSE_LO.SN_
      3697**DCL      3697--REDEF
CLOSE_LO.UTL_
      3698**DCL      3698--REDEF
CLOSE_LO.V
      3702**DCL      3697--DCLINIT
CLOSE_LO.V.EXPIRE#
      3712**DCL      3712--REDEF
CLOSE_LO.V.TYPE#
      3710**DCL      3710--REDEF
CLOSE_LO.V.XTNSIZE#
      3707**DCL      3707--REDEF    3709--REDEF
CMD0
      4145**LABEL    4149--CALLALT
CSCGNAME
      3175**DCL      3105--DCLINIT
DISPALL1 IN PROCEDURE SETUP_CXT
      4462**LABEL    4462--CALLALT  4473--CALLALT
DISPALL2 IN PROCEDURE SETUP_CXT
      4465**LABEL    4463--GOTO
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:122  
DISPDEFER IN PROCEDURE DRIVE_CXT
      4675**LABEL    4695--GOTO
DISPI IN PROCEDURE SETUP_CXT
      4368**LABEL    4341--GOTO     4355--GOTO
DISPI2 IN PROCEDURE SETUP_CXT
      4371**LABEL    4369--GOTO
DISPINPUT IN PROCEDURE DRIVE_CXT
      4687**LABEL    4706--GOTO     4709--GOTO
DISPINR IN PROCEDURE SETUP_CXT
      4366**LABEL    4335--GOTO     4348--GOTO
DISPJOB IN PROCEDURE DRIVE_CXT
      4675**LABEL    4693--GOTO
DISPNORUN IN PROCEDURE DRIVE_CXT
      4708**LABEL    4697--GOTO
DISPO IN PROCEDURE SETUP_CXT
      4271**LABEL    4265--GOTO
DISPOUTPUT IN PROCEDURE DRIVE_CXT
      4675**LABEL    4705--GOTO     4708--GOTO
DISPPRIO IN PROCEDURE DRIVE_CXT
      4675**LABEL    4702--GOTO
DISPSY1 IN PROCEDURE SETUP_CXT
      4413**LABEL    4405--CALLALT  4407--CALLALT
DOGNAME
      3193**DCL      3105--DCLINIT
DONE IN PROCEDURE GETO
      4549**LABEL    4611--GOTO
DONE IN PROCEDURE SETUP_CXT
      4281**LABEL    4377--GOTO     4380--GOTO     4400--GOTO     4431--GOTO     4454--GOTO
DONESUB IN PROCEDURE SETUP_CXT
      4496**PROC     4286--CALL     4473--CALL
DRIVE IN PROCEDURE DRIVE_CXT
      4670**LABEL    4729--GOTO     4746--GOTO     4762--GOTO
DRIVE_CXT
      4670**PROC     4134--CALL     4149--CALL
EHMSG
      2779**DCL      3871--DCLINIT  3872--DCLINIT
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:123  
ENDCMD
      4145**LABEL    4144--GOTO     4147--CALLALT  4150--GOTO
ERRX IN PROCEDURE SETUP_CXT
      4285**LABEL    4282--CALLALT  4285--GOTO     4286--CALLALT  4363--GOTO     4373--CALLALT  4399--CALLALT
      4427--CALLALT  4439--GOTO     4453--CALLALT  4465--CALLALT  4466--GOTO     4480--GOTO
ERRX1 IN PROCEDURE SETUP_CXT
      4314**LABEL    4441--GOTO     4482--GOTO     4489--GOTO
F$DCB.ACTPOS
      2285**DCL      2285--REDEF
F$DCB.ARS
      2260**DCL      2260--REDEF
F$DCB.ATTR
      2278**DCL      2279--REDEF
F$DCB.BORROW
      2293**DCL      2293--REDEF    2293--REDEF    2293--REDEF
F$DCB.DCBNAME.L
      2307**DCL      2307--IMP-SIZ
F$DCB.EOMCHAR
      2264**DCL      2264--REDEF
F$DCB.FCD
      2273**DCL      4404>>IF       4501>>IF
F$DCB.FLDID
      2288**DCL      2288--REDEF
F$DCB.FORM$
      2282**DCL      2282--REDEF
F$DCB.FSECT
      2298**DCL      2298--REDEF
F$DCB.FSN
      2275**DCL      2275--REDEF    2275--REDEF    2276--REDEF
F$DCB.HEADER$
      2281**DCL      2281--REDEF
F$DCB.IXTNSIZE
      2279**DCL      2279--REDEF
F$DCB.LASTSTA$
      2269**DCL      2269--REDEF
F$DCB.LVL
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:124  
      2294**DCL      2294--REDEF
F$DCB.NAME.C
      2269**DCL      2269--REDEF
F$DCB.NOEOF
      2290**DCL      2290--REDEF
F$DCB.NRECS
      2280**DCL      2280--REDEF
F$DCB.NRECX
      2299**DCL      2299--REDEF
F$DCB.OHDR
      2291**DCL      2291--REDEF
F$DCB.ORG
      2274**DCL      2274--REDEF
F$DCB.PRECNO
      2297**DCL      2297--REDEF
F$DCB.RCSZ
      2302**DCL      2302--REDEF
F$DCB.RES
      2270**DCL      2270--REDEF
F$DCB.SETX
      2282**DCL      2282--REDEF
F$DCB.TAB$
      2281**DCL      2282--REDEF
F$DCB.TDA
      2296**DCL      2296--REDEF
F$DCB.WIDTH
      2267**DCL      4090>>IF       4092>>ASSIGN
F$DCB.WSN
      2271**DCL      2271--REDEF
GDPVEC
      4035**DCL      4003--DCLINIT  4020--DCLINIT  4053--DCLINIT  4549>>ASSIGN   4600>>ASSIGN
GDPVEC.PTR$
      4037**DCL      4548>>ASSIGN   4598>>ASSIGN
GDPVEC.W2
      4036**DCL      4037--REDEF
GETI IN PROCEDURE GETO
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:125  
      4583**ENTRY    4373--CALL     4453--CALL
GETI1 IN PROCEDURE GETO
      4592**ENTRY    4399--CALL
GETMORE IN PROCEDURE GETO
      4622**LABEL    4639--GOTO
GETMORE1 IN PROCEDURE GETO
      4620**LABEL    4633--GOTO
GETO IN PROCEDURE SETUP_CXT
      4531**PROC     4282--CALL     4462--CALL
GETO1 IN PROCEDURE GETO
      4542**ENTRY    4427--CALL
GETP
      4003**DCL      4547<>CALL     4560<>CALL     4626<>CALL
GETP.V
      4003**DCL      4003--DCLINIT
GETP3
      4020**DCL      4597<>CALL
GETP3.V
      4020**DCL      4020--DCLINIT
GET_PSEUDOS
      3730**DCL      4797<>CALL
GET_PSEUDOS.V
      3732**DCL      3730--DCLINIT
GET_STAT
      2762**DCL      4226<<ASSIGN   4418<<ASSIGN   4457<<ASSIGN   4551<>CALL     4610<>CALL
GET_STAT.CRITERIA_
      2763**DCL      4544<<ASSIGN   4594<<ASSIGN
GET_STAT.RESLIST_
      2765**DCL      4606<<ASSIGN   4620--ASSIGN   4631--ASSIGN   4631--ASSIGN
GET_STAT.RESULTS_
      2762**DCL      4549<<ASSIGN   4558--ASSIGN   4558--ASSIGN   4600<<ASSIGN   4603<<ASSIGN   4615--ASSIGN
      4615--ASSIGN
GET_STAT.SNLIST_
      2764**DCL      4607<<ASSIGN   4623--ASSIGN   4637--ASSIGN   4637--ASSIGN
GET_STAT.V
      2766**DCL      4227--ASSIGN   4419--ASSIGN   4458--ASSIGN
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:126  
GET_STAT.V.OUTPUT#
      2767**DCL      4543<<ASSIGN   4593<<ASSIGN
GET_STAT.V_
      2762**DCL      4227<<ASSIGN   4419<<ASSIGN   4458<<ASSIGN
GOODNGT
      2843**DCL      4125<<ASSIGN   4129>>IF       4401>>IF
HIMSG
      2778**DCL      3836--DCLINIT  3837--DCLINIT  4087<<CALLBLT
I
      2688**DCL      4312<<ASSIGN   4313>>CALLBLT  4409<<ASSIGN   4412>>ASSIGN
ILLKEY IN PROCEDURE SETUP_CXT
      4240**LABEL    4247--GOTO     4251--GOTO
ILOOP IN PROCEDURE GETO
      4605**LABEL    4627--GOTO
INTSET
      3029**DCL      4086<>CALL
INTSET.V
      3029**DCL      3029--DCLINIT
I_CRITERIA
      2729**DCL      4225<<ASSIGN   4594--ASSIGN
I_CRITERIA.ACCT#
      2733**DCL      4585<<ASSIGN   4589<<ASSIGN   4590<<ASSIGN
I_CRITERIA.NORUN#
      2735**DCL      4353<<ASSIGN
I_CRITERIA.NOTACCT#
      2738**DCL      4584<<ASSIGN
I_CRITERIA.NOTWSN#
      2738**DCL      4595<<ASSIGN
I_CRITERIA.PRIO#
      2740**DCL      4365<<ASSIGN
I_CRITERIA.PRIO1#
      2741**DCL      4366<<ASSIGN
I_CRITERIA.RUNAFTER#
      2735**DCL      4346<<ASSIGN
I_CRITERIA.RUNNING#
      2737**DCL      4333<<ASSIGN
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:127  
I_CRITERIA.SYSID#
      2734**DCL      4396<<ASSIGN
I_CRITERIA.SYSID1#
      2734**DCL      4397<<ASSIGN
I_CRITERIA.WSN#
      2733**DCL      4596<<ASSIGN
JALT IN PROCEDURE GETO
      4553**LABEL    4551--CALLALT
JALT1 IN PROCEDURE GETO
      4560**LABEL    4641--GOTO
JIALT IN PROCEDURE GETO
      4605**LABEL    4610--CALLALT
JOPN
      2801**DCL      4126<>CALL     4405<>CALL
JREAD
      2837**DCL      4407<>CALL
JREAD.SYSID#
      2840**DCL      4406<<ASSIGN
JREC
      2818**DCL      2837--DCLINIT  2838--DCLINIT  4408--ASSIGN
K
      2746**DCL      2621--IMP-SIZ
KEYEND
      4131**LABEL    4132--CALLALT
LOALT IN PROCEDURE DONESUB
      4511**LABEL    4509--CALLALT
LOOP IN PROCEDURE GETO
      4549**LABEL    4561--GOTO
M$CLOSE
        53**DCL-ENT  4465--CALL     4750--CALL     4767--CALL
M$DISPRES
        60**DCL-ENT  4797--CALL
M$EXIT
        65**DCL-ENT  4156--CALL
M$FDP
        89**DCL-ENT  4787--CALL
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:128  
M$GDP
        89**DCL-ENT  4547--CALL     4560--CALL     4597--CALL     4626--CALL
M$INT
       108**DCL-ENT  4086--CALL
M$JOBSTATS
       118**DCL-ENT  4551--CALL     4610--CALL
M$JSF
      2972**DCL      4404--IF
M$LO
      2969**DCL      4501--IF
M$ME
      2971**DCL      4090--IF       4092--ASSIGN
M$MERC
       109**DCL-ENT  4574--CALL
M$OPEN
        53**DCL-ENT  4080--CALL     4509--CALL     4511--CALL
M$READ
        54**DCL-ENT  4119--CALL     4142--CALL
M$WRITE
        54**DCL-ENT  4089--CALL     4124--CALL     4152--CALL     4241--CALL     4304--CALL     4309--CALL
      4314--CALL     4317--CALL     4320--CALL     4323--CALL     4488--CALL     4753--CALL     4770--CALL
M$XCON
       108**DCL-ENT  4076--CALL
MARCH_ON IN PROCEDURE DRIVE_CXT
      4756**LABEL    4745--CALLALT
MARCH_ON1 IN PROCEDURE DRIVE_CXT
      4760**LABEL    4761--CALLALT
MISC_SETUP
      4796**PROC     4078--CALL     4085--CALL
MSGLOOP
      4131**LABEL    4134--CALLALT
NOMEM IN PROCEDURE GETO
      4576**LABEL    4547--CALLALT  4560--CALLALT  4597--CALLALT  4626--CALLALT
NOMEMMSG
      2785**DCL      3941--DCLINIT  3942--DCLINIT
NONEMSG
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:129  
      2780**DCL      3906--DCLINIT  3907--DCLINIT
OCMSG_ILLKEY
      3331**DCL      4241<>CALL
OCMSG_ILLKEY.STATION_
      3333**DCL      3333--REDEF
OCMSG_ILLKEY.V
      3334**DCL      3331--DCLINIT
OCMSG_ILLKEY.V.DVBYTE.VFC#
      3340**DCL      3340--REDEF
OCMSG_KERR
      3263**DCL      4304<>CALL
OCMSG_KERR.STATION_
      3265**DCL      3265--REDEF
OCMSG_KERR.V
      3266**DCL      3263--DCLINIT
OCMSG_KERR.V.DVBYTE.VFC#
      3272**DCL      3272--REDEF
OCMSG_RESP
      3297**DCL      4753<>CALL     4770<>CALL
OCMSG_RESP.STATION_
      3299**DCL      3299--REDEF
OCMSG_RESP.V
      3300**DCL      3297--DCLINIT
OCMSG_RESP.V.DVBYTE.VFC#
      3306**DCL      3306--REDEF
OCMSG_UNIMP
      3365**DCL      4488<>CALL
OCMSG_UNIMP.STATION_
      3367**DCL      3367--REDEF
OCMSG_UNIMP.V
      3368**DCL      3365--DCLINIT
OCMSG_UNIMP.V.DVBYTE.VFC#
      3374**DCL      3374--REDEF
OD$KEYIN
      2653**DCL      4121<<ASSIGN   4121>>ASSIGN
OD$KEYIN.HIPRIO
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:130  
      2670**DCL      2671--REDEF
OD$KEYIN.NOTWSN
      2667**DCL      2668--REDEF
ODE$EVNT
      2983**DCL-ENT  3029--DCLINIT
ODE$XCON
      2984**DCL-ENT  3014--DCLINIT
ODF$FORMAT
      2985**DCL-ENT  4411--CALL     4675--CALL     4678--CALL     4681--CALL     4684--CALL     4687--CALL
      4700--CALL     4711--CALL     4714--CALL
ODP$PARSE
      2986**DCL-ENT  4143--CALL
OD_CSCGBUF
      1698**DCL      3759--DCLINIT  3760--DCLINIT  4121--ASSIGN
OD_CXT
      1790**DCL      4120<<ASSIGN
OD_CXT.CADDR
      1821**DCL      4131>>ASSIGN   4240>>ASSIGN   4294>>ASSIGN   4487>>ASSIGN   4736>>ASSIGN
OD_CXT.CATTR.OUTPUT
      1842**DCL      4228>>IF       4231<<ASSIGN   4238>>IF       4247>>IF       4250>>IF       4295>>IF
      4392>>IF       4423>>IF       4448>>IF       4460>>IF
OD_CXT.DEVTYP
      1827**DCL      4271>>IF       4273>>ASSIGN   4275>>ASSIGN
OD_CXT.FORCE
      1823**DCL      4497>>IF       4730>>IF
OD_CXT.FULL
      1824**DCL      4709>>IF
OD_CXT.HDRDUN
      1798**DCL      4472<<ASSIGN
OD_CXT.HIPRIO
      1832**DCL      1833--REDEF    4361<<ASSIGN   4362>>IF       4362>>IF       4366>>ASSIGN
OD_CXT.HIPRIOR
      1833**DCL      4361>>IF
OD_CXT.INOUT
      1797**DCL      4386<<ASSIGN   4447<<ASSIGN   4756>>IF
OD_CXT.INPCOMP
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:131  
      1799**DCL      4393>>IF       4413<<ASSIGN   4430<<ASSIGN   4435>>IF       4449>>IF       4470<<ASSIGN
      4477>>IF       4705>>IF       4708>>IF       4742>>IF       4744<<ASSIGN   4756>>IF       4760<<ASSIGN
OD_CXT.KIN#
      1820**DCL      4121--ASSIGN   4122>>IF       4144>>IF       4235>>DOCASE   4258>>DOCASE   4374>>IF
      4673>>DOCASE   4740>>IF
OD_CXT.LOPRIO
      1831**DCL      4361>>ASSIGN   4362>>IF       4365>>ASSIGN
OD_CXT.LPWSN
      1826**DCL      4506>>IF       4508--ASSIGN   4517>>ASSIGN
OD_CXT.NDISPED
      1794**DCL      4284<<ASSIGN   4285>>IF       4471<<ASSIGN   4471>>ASSIGN   4497>>IF       4522>>ASSIGN
      4737>>ASSIGN
OD_CXT.NDONE
      1793**DCL      4223<<ASSIGN   4284>>ASSIGN   4375>>DOWHILE  4376>>ASSIGN   4378<<ASSIGN   4378>>ASSIGN
      4690>>ASSIGN   4722<<ASSIGN   4722>>ASSIGN   4723>>IF       4730>>IF
OD_CXT.NFOUND
      1792**DCL      4284>>ASSIGN   4312>>ASSIGN   4375>>DOWHILE  4400>>IF       4428>>IF       4454>>IF
      4468>>IF       4471>>ASSIGN   4553<<ASSIGN   4571<<ASSIGN   4723>>IF
OD_CXT.NOTACCT
      1828**DCL      4290>>ASSIGN   4534>>ASSIGN   4584>>ASSIGN
OD_CXT.NOTFORM
      1838**DCL      4293>>ASSIGN   4533>>ASSIGN
OD_CXT.NOTTERM
      1830**DCL      4281>>ASSIGN   4292>>ASSIGN
OD_CXT.NOTWSN
      1829**DCL      1830--REDEF    4281<<ASSIGN   4291>>ASSIGN   4546>>ASSIGN   4595>>ASSIGN
OD_CXT.ONLP
      1822**DCL      4409>>ASSIGN   4410<<ASSIGN   4412<<ASSIGN   4465>>IF       4497>>IF       4501>>IF
      4729>>IF       4740>>IF       4748>>IF
OD_CXT.RES$
      1796**DCL      4604<<ASSIGN   4605>>ASSIGN   4606>>ASSIGN   4619<<ASSIGN   4619>>ASSIGN   4620>>ASSIGN
OD_CXT.SACCT
      1836**DCL      4302>>ASSIGN   4385<<ASSIGN   4535>>ASSIGN   4538>>IF       4539>>ASSIGN   4585>>ASSIGN
      4588>>IF       4589>>ASSIGN
OD_CXT.SEG$
      1791**DCL      4376>>ASSIGN   4408<<ASSIGN   4548<<ASSIGN   4553>>ASSIGN   4598<<ASSIGN   4603>>ASSIGN
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:132  
      4604>>ASSIGN   4690>>ASSIGN
OD_CXT.SFORM
      1837**DCL      4289>>ASSIGN   4532>>ASSIGN
OD_CXT.SN$
      1795**DCL      4605<<ASSIGN   4607>>ASSIGN   4622<<ASSIGN   4622>>ASSIGN   4623>>ASSIGN
OD_CXT.STNAME
      1835**DCL      4280>>ASSIGN   4299>>ASSIGN
OD_CXT.SWSN
      1834**DCL      4280<<ASSIGN   4298>>ASSIGN   4545>>ASSIGN   4596>>ASSIGN
OD_CXT.SYSID
      1825**DCL      4390>>IF       4396>>ASSIGN   4397>>ASSIGN   4406>>ASSIGN   4425>>ASSIGN   4426>>ASSIGN
      4438>>ASSIGN
OD_CXT_INIT
      1721**DCL      4120>>ASSIGN
OD_CXT_INIT.HIPRIO
      1763**DCL      1764--REDEF
OD_CXT_INIT.NOTWSN
      1760**DCL      1761--REDEF
OD_INT
      1700**DCL      4145<<ASSIGN   4723>>IF       4756>>IF
OD_OBMAX
      1701**DCL      4092<<ASSIGN   4093>>IF       4093<<ASSIGN
OD_PSEUDOS
      1909**DCL      3730--DCLINIT
OD_READCSCG
      1876**DCL      4119<>CALL
OD_READCSCG.STATION_
      1879**DCL      1880--REDEF
OD_READCSCG.V.DVBYTE.REREAD#
      1891**DCL      1891--REDEF
OD_READCSCG.V.INDX#
      1889**DCL      1889--REDEF
OD_SGHST
      1699**DCL      4073<<ASSIGN   4084<<ASSIGN   4117>>IF       4303>>IF       4504>>IF       4535>>IF
      4574>>IF       4585>>IF       4751>>IF       4768>>IF
OPEN_CSCG
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:133  
      3104**DCL      4080<>CALL
OPEN_CSCG.ACSVEH_
      3106**DCL      3107--REDEF
OPEN_CSCG.ALTKEYS_
      3112**DCL      3113--REDEF    3113--REDEF
OPEN_CSCG.HDR_
      3111**DCL      3112--REDEF
OPEN_CSCG.TAB_
      3110**DCL      3111--REDEF
OPEN_CSCG.UHL_
      3104**DCL      3105--REDEF    3105--REDEF
OPEN_CSCG.V
      3113**DCL      3104--DCLINIT
OPEN_CSCG.V.FSN#
      3144**DCL      3144--REDEF    3144--REDEF
OPEN_CSCG.WSN_
      3110**DCL      3110--REDEF
OPEN_LOGHST
      3501**DCL      4509<>CALL
OPEN_LOGHST.ACSVEH_
      3503**DCL      3504--REDEF
OPEN_LOGHST.ALTKEYS_
      3509**DCL      3510--REDEF    3510--REDEF
OPEN_LOGHST.HDR_
      3508**DCL      3509--REDEF
OPEN_LOGHST.TAB_
      3507**DCL      3508--REDEF
OPEN_LOGHST.UHL_
      3501**DCL      3502--REDEF    3502--REDEF
OPEN_LOGHST.V
      3510**DCL      3501--DCLINIT
OPEN_LOGHST.V.FSN#
      3541**DCL      3541--REDEF    3541--REDEF
OPEN_LOGHST.WSN_
      3507**DCL      3507--REDEF    4507<<ASSIGN   4508<<ASSIGN
OPEN_LOUSER
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:134  
      3612**DCL      4511<>CALL
OPEN_LOUSER.ACSVEH_
      3614**DCL      3615--REDEF
OPEN_LOUSER.ALTKEYS_
      3620**DCL      3621--REDEF    3621--REDEF
OPEN_LOUSER.HDR_
      3619**DCL      3620--REDEF
OPEN_LOUSER.TAB_
      3618**DCL      3619--REDEF
OPEN_LOUSER.UHL_
      3612**DCL      3613--REDEF    3613--REDEF
OPEN_LOUSER.V
      3621**DCL      3612--DCLINIT
OPEN_LOUSER.V.FSN#
      3652**DCL      3652--REDEF    3652--REDEF
OPEN_LOUSER.WSN_
      3618**DCL      3618--REDEF
OPMSG_ILLKEY
      2948**DCL      3332--DCLINIT  3333--DCLINIT
OPMSG_ILLKEY.CADDR
      2949**DCL      4240<<ASSIGN
OPMSG_ILLKEY.FLAGS
      2955**DCL      2956--REDEF
OPMSG_ILLKEY.MSGID
      2951**DCL      2952--REDEF
OPMSG_KERR
      2865**DCL      3264--DCLINIT  3265--DCLINIT
OPMSG_KERR.ACCT
      2897**DCL      4302<<ASSIGN
OPMSG_KERR.ATTERM
      2896**DCL      4299<<ASSIGN
OPMSG_KERR.ATWSN
      2895**DCL      4298<<ASSIGN
OPMSG_KERR.CADDR
      2866**DCL      4131<<ASSIGN   4294<<ASSIGN
OPMSG_KERR.DEVTYP
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:135  
      2893**DCL      4275<<ASSIGN
OPMSG_KERR.ERRC
      2892**DCL      4516<<ASSIGN   4576<<ASSIGN
OPMSG_KERR.FLAGS
      2872**DCL      2873--REDEF
OPMSG_KERR.FORM
      2902**DCL      4289<<ASSIGN
OPMSG_KERR.LPWSN
      2903**DCL      4517<<ASSIGN
OPMSG_KERR.MSGID
      2868**DCL      2869--REDEF
OPMSG_KERR.NFOUND
      2891**DCL      4522<<ASSIGN
OPMSG_KERR.NOTACCT
      2898**DCL      4290<<ASSIGN
OPMSG_KERR.NOTFORM
      2899**DCL      4293<<ASSIGN
OPMSG_KERR.NOTTERM
      2901**DCL      4292<<ASSIGN
OPMSG_KERR.NOTWSN
      2900**DCL      2901--REDEF    4291<<ASSIGN
OPMSG_KERR.PWSN
      2894**DCL      4297<<ASSIGN   4301<<ASSIGN
OPMSG_KERR.SUBC
      2890**DCL      4264<<ASSIGN   4270<<ASSIGN   4274<<ASSIGN   4306>>DOCASE   4334<<ASSIGN   4340<<ASSIGN
      4347<<ASSIGN   4354<<ASSIGN   4360<<ASSIGN   4364<<ASSIGN   4437<<ASSIGN   4446<<ASSIGN   4479<<ASSIGN
      4515<<ASSIGN   4521<<ASSIGN   4566<<ASSIGN   4575<<ASSIGN   4579<<ASSIGN
OPMSG_KERR.SYSID
      2869**DCL      4438<<ASSIGN
OPMSG_RESP
      2909**DCL      3298--DCLINIT  3299--DCLINIT
OPMSG_RESP.CADDR
      2910**DCL      4736<<ASSIGN
OPMSG_RESP.FLAGS
      2916**DCL      2917--REDEF
OPMSG_RESP.MSGID
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:136  
      2912**DCL      2913--REDEF
OPMSG_RESP.NDISPED
      2924**DCL      4737<<ASSIGN
OPMSG_RESP.SUBC
      2923**DCL      4738<<ASSIGN
OPMSG_UNIMP
      2931**DCL      3366--DCLINIT  3367--DCLINIT
OPMSG_UNIMP.CADDR
      2932**DCL      4487<<ASSIGN
OPMSG_UNIMP.FLAGS
      2938**DCL      2939--REDEF
OPMSG_UNIMP.MSGID
      2934**DCL      2935--REDEF
O_CRITERIA
      2701**DCL      4224<<ASSIGN   4544--ASSIGN
O_CRITERIA.ACCT#
      2705**DCL      4535<<ASSIGN   4539<<ASSIGN   4540<<ASSIGN
O_CRITERIA.DEVTYP#
      2713**DCL      4273<<ASSIGN
O_CRITERIA.FORM#
      2714**DCL      4532<<ASSIGN
O_CRITERIA.NOTACCT#
      2710**DCL      4534<<ASSIGN
O_CRITERIA.NOTFORM#
      2711**DCL      4533<<ASSIGN
O_CRITERIA.NOTWSN#
      2710**DCL      4546<<ASSIGN
O_CRITERIA.NSFORM#
      2708**DCL      4263<<ASSIGN
O_CRITERIA.SYSID#
      2706**DCL      4425<<ASSIGN
O_CRITERIA.SYSID1#
      2706**DCL      4426<<ASSIGN
O_CRITERIA.WSN#
      2705**DCL      4545<<ASSIGN
R$INPUT.J
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:137  
      2565**DCL      4376--ASSIGN   4690--ASSIGN
R$OUTPUT.FOUND
      2534**DCL      4553>>ASSIGN
READ_SI
      3757**DCL      4142<>CALL
READ_SI.STATION_
      3760**DCL      3761--REDEF
READ_SI.V
      3761**DCL      3757--DCLINIT
READ_SI.V.DVBYTE.REREAD#
      3772**DCL      3772--REDEF
READ_SI.V.INDX#
      3770**DCL      3770--REDEF
RELMEM_CXT
      4786**PROC     4327--CALL     4416--CALL     4456--CALL     4739--CALL
RELP
      4053**DCL      4787<>CALL
RELP.V
      4053**DCL      4053--DCLINIT
RESLIST
      2747**DCL      4368<<ASSIGN   4371<<ASSIGN   4398<<ASSIGN   4452<<ASSIGN   4599>>IF       4617>>IF
SC_LPWSN
      3669**DCL      4507--ASSIGN
SETUP_CXT
      4222**PROC     4132--CALL     4147--CALL     4745--CALL     4761--CALL
SIALT
      4153**LABEL    4142--CALLALT
SQRIPMSG
      2786**DCL      3801--DCLINIT  3802--DCLINIT
STAT_CRITERIA
      3414**DCL      4224>>ASSIGN   4225>>ASSIGN
STAT_FPT
      3392**DCL      4226>>ASSIGN   4418>>ASSIGN   4457>>ASSIGN
STAT_FPT.V
      3396**DCL      3392--DCLINIT
TMMSG
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:138  
      2781**DCL      3976--DCLINIT  3977--DCLINIT
TMMSG.NUM
      2783**DCL      4313<<CALLBLT
WRITE_EH
      3870**DCL      4152<>CALL     4317<>CALL
WRITE_EH.STATION_
      3872**DCL      3872--REDEF
WRITE_EH.V
      3873**DCL      3870--DCLINIT
WRITE_EH.V.DVBYTE.VFC#
      3879**DCL      3879--REDEF
WRITE_HI
      3835**DCL      4089<>CALL
WRITE_HI.STATION_
      3837**DCL      3837--REDEF
WRITE_HI.V
      3838**DCL      3835--DCLINIT
WRITE_HI.V.DVBYTE.VFC#
      3844**DCL      3844--REDEF
WRITE_NOMEM
      3940**DCL      4309<>CALL
WRITE_NOMEM.STATION_
      3942**DCL      3942--REDEF
WRITE_NOMEM.V
      3943**DCL      3940--DCLINIT
WRITE_NOMEM.V.DVBYTE.VFC#
      3949**DCL      3949--REDEF
WRITE_NONE
      3905**DCL      4323<>CALL
WRITE_NONE.STATION_
      3907**DCL      3907--REDEF
WRITE_NONE.V
      3908**DCL      3905--DCLINIT
WRITE_NONE.V.DVBYTE.VFC#
      3914**DCL      3914--REDEF
WRITE_SQRIP
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:139  
      3800**DCL      4320<>CALL
WRITE_SQRIP.STATION_
      3802**DCL      3802--REDEF
WRITE_SQRIP.V
      3803**DCL      3800--DCLINIT
WRITE_SQRIP.V.DVBYTE.VFC#
      3809**DCL      3809--REDEF
WRITE_TM
      3975**DCL      4314<>CALL
WRITE_TM.STATION_
      3977**DCL      3977--REDEF
WRITE_TM.V
      3978**DCL      3975--DCLINIT
WRITE_TM.V.DVBYTE.VFC#
      3984**DCL      3984--REDEF
WRITE_ZAPRESP
      3229**DCL      4124<>CALL
WRITE_ZAPRESP.STATION_
      3231**DCL      3231--REDEF
WRITE_ZAPRESP.V
      3232**DCL      3229--DCLINIT
WRITE_ZAPRESP.V.DVBYTE.VFC#
      3238**DCL      3238--REDEF
XCONSET
      3013**DCL      4076<>CALL
XCONSET.V
      3014**DCL      3013--DCLINIT
XSJ$CLOSE
      2987**DCL-ENT  4126--CALL
XSJ$OPEN
      2988**DCL-ENT  4405--CALL
XSJ$READ
      2989**DCL-ENT  4407--CALL
ZAP01
      4125**LABEL    4126--CALLALT
ZAPRESP
PL6.E3A0      #001=ODD$DOG File=ODD$DOG.:E05TSI                                  WED 07/30/97 04:10 Page:140  
      2848**DCL      3230--DCLINIT  3231--DCLINIT
ZAPRESP.FLAGS
      2855**DCL      2856--REDEF
ZAPRESP.MSGID
      2851**DCL      2852--REDEF
