VERSION E05

PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:1    
        1        1        /*M* DAD$ENQ - DISPLAY ENQ/DEQ TABLES FOR ANLZ */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        DAD$ENQ: PROC(ENQBLK);
        8        8        %INCLUDE CP_6;
        9       89        %INCLUDE B_SEGIDS_C;
       10      628        %SUB U_BASE$=ENQ$;
       11      629        %INCLUDE UQ$NODES;
       12      760        %INCLUDE XU_FORMAT_C;
       13      922        %INCLUDE XU_MACRO_C;
       14     4028 S      %INCLUDE B$JIT_C;
       15     4029        %INCLUDE B$TABLES_C;
       16     4137        %B$XL_ASC_DUMP;
       17     4141        %INCLUDE DA_ANLZ_R;
       18     4154    1   DCL DAA$NXTUSR ENTRY(1)ALTRET;
       19     4155    1   DCL DAB$OCTDUMP ENTRY(5);
       20     4156        %INCLUDE DA_MAP_R;
       21     4186        %INCLUDE DA_CMD_C;
       22     4535        %B$JIT0;
       23     4624        %U$JIT1X;
       24     4627        %M$JIT2X;
       25     4630        %F$JIT3X;
       26     4633        %S$JIT4X;
       27     4636        %J$JIT5X;
       28     4639        %A$JIT6X;
       29     4642        %SUB ENQ_NULL=0;
       30     4643    1   DCL B$JIT$ PTR SYMREF;
       31     4644    1   DCL B$TCB$ PTR SYMREF;
       32     4645        %PARSE$OUT(NAME=ENQBLK,STCLASS=);
       33     4690        %PARSE$OUT(NAME=SUBLK,STCLASS=BASED);
       34     4735    1   DCL B$IS$ PTR SYMREF;
       35     4736        %INCLUDE DA_FORMAT_C;
       36     4978    1   DCL DAF$INIT ENTRY(1) ALTRET;
       37     4979    1   DCL DAF$WRITE EPTR SYMREF;
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:2    
       38     4980    1   DCL DAF$NEWPAGE ENTRY;
       39     4981        %INCLUDE FM$CFU;
       40     5026        %FM$CFU;
       41     5032        %FM$CFUA;
       42     5038        %FM$CFUN;
       43     5041        %SUB F$CFU$=CM$;
       44     5042        %FM$CFUX;
       45     5047        %INCLUDE FM$SET;
       46     5074        %FM$SET(ARY=);
       47     5079        %FM$SET(FM$SET=FM$SETA,BASED="BASED(CM$)");
       48     5084    1   DCL DAM$MAP ENTRY(5) ALTRET;
       49     5085        %REPORT (NAME=REPORT,TITLE='ENQ/DEQ TABLES.',HEADER=YES,WRAPTAB=14);
       50     5151        %HEADER(TEXT=
       51     5152        ' QENTRY STATE     REQUEST UPGRADE W D USER     EVENT_ID',LAST=NO);
       52     5194        %HEADER(TEXT=
       53     5195        ' ------ --------- ------- ------- - - ---- ------------');
       54     5237    1   DCL M$DO DCB;
       55     5238    1   DCL M$LO DCB;
       56     5239    1   DCL I SBIN WORD;
       57     5240    1   DCL P$ PTR;
       58     5241    1   DCL Q$ PTR;
       59     5242    1   DCL R$ PTR;
       60     5243    1   DCL 1 C_ STATIC,
       61     5244    1         2 * BIT(15) UNAL,
       62     5245    1         2 X UBIN(3) UNAL,
       63     5246    1         2 * UBIN HALF UNAL;
       64     5247    1   DCL C$ REDEF C_  PTR;
       65     5248    1   DCL CM$ PTR;
       66     5249    1   DCL CA$ PTR;
       67     5250    1   DCL J SBIN WORD;
       68     5251    1   DCL NEXTH@ SBIN WORD;
       69     5252    1   DCL NEXTX@ SBIN WORD;
       70     5253    1   DCL NEXTP@ SBIN WORD;
       71     5254    1   DCL COUNT SBIN WORD;
       72     5255    1   DCL ALLFLAG BIT(1);
       73     5256    1   DCL ERRFLAG BIT(1);
       74     5257    1   DCL USER# SBIN ;
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:3    
       75     5258    1   DCL USERS CHAR(512);
       76     5259    1   DCL 1 RNAME,
       77     5260    1         2 R$ PTR,
       78     5261    1         2 TC REDEF R$,
       79     5262    1            3 * BIT(27),
       80     5263    1            3 C UBIN(9)UNAL,
       81     5264    1         2 PSN CHAR(9),
       82     5265    1         2 SEP CHAR(1),
       83     5266    1         2 NDOTA CHAR(40),
       84     5267    1         2 NAME BIT(18),
       85     5268    1         2 TFLG UBIN(18)UNAL,
       86     5269    1         2 TXT(0:39) CHAR(13);
       87     5270    1   DCL 1 QNTRY,
       88     5271    1         2 Q$ PTR,
       89     5272    1         2 STATE CHAR(10),
       90     5273    1         2 REQ CHAR(8),
       91     5274    1         2 UPG CHAR(8),
       92     5275    1         2 W1 UBIN(18)UNAL,
       93     5276    1         2 EVID UBIN;
       94     5277    1   DCL STATE_NAMES(0:2) CHAR(9) CONSTANT INIT(
       95     5278    1        'Queued','Pending','Allocated');
       96     5279    1   DCL SMODE_NAMES(0:7) CHAR(6) CONSTANT INIT(
       97     5280    1         '------'*2,'All---','All-lc','Ltd---','Ltd-lc','None--'*2);
       98     5281    1   DCL 1 ENQ_BASE STATIC,
       99     5282    1         2 OFFSET UBIN HALF UNAL INIT(0),
      100     5283    1         2 * UBIN HALF UNAL INIT(BITBIN(%DS3SID));
      101     5284    1   DCL ENQ_BASE$ REDEF ENQ_BASE PTR;
      102     5285    1   DCL CFU_ UBIN WORD STATIC INIT(BITBIN(%DS1SID));
      103     5286    1   DCL CFU$ REDEF CFU_ PTR;
      104     5287    1   DCL CFU@ UBIN STATIC;
      105     5288    1   DCL ENQ$ PTR;
      106     5289    1   DCL T$ PTR;
      107     5290    1   DCL LOOP_MESS CHAR(0)CONSTANT INIT(
      108     5291    1    ' **** ENQ/DEQ Table inconsistency (looping) ****');
      109     5292    1   DCL FREEMESS CHAR(0) CONSTANT INIT(
      110     5293    1    ' %D Free blocks, %+D in use, %+D unaccounted for');
      111     5294    1   DCL QENTRY_MESS CHAR(0) CONSTANT INIT(
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:4    
      112     5295    1    ' %6.18ZO%2S %26AN%1N.5N(%35-Y%) %1.3D .%3.9ZO %12ZO%S');
      113     5296    1   DCL QIDER_MESS CHAR(0)CONSTANT INIT(
      114     5297    1    ' *** Bad QID at .%6ZO  %4(%12ZO %)');
      115     5298    1   DCL 1 RNAME_MESS CONSTANT,2 * CHAR(0) INIT(
      116     5299    1    ' Rname @ %5.18ZO: %.9N>T%..54P %45>-%6.18ZO%18N:=:1&( ''%9N:1=:?(%.1#.1A%)'''),
      117     5300    1      2 * CHAR(0) INIT('%#:2/[%1Q%]%/%..58P%14-''%9N(%3.9ZO%)''O%1Q');
      118     5301        %EJECT;
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:5    
      119     5302    1           USER#=0;
      120     5303    1           ALLFLAG='0'B;
      121     5304    1           ERRFLAG='0'B;
      122     5305    1           IF ENQBLK.NSUBLKS=0 THEN ALLFLAG='1'B;
      123     5306    1           ELSE IF ENQBLK.SUBLK$(0)->SUBLK.CODE=%DA_ENQ_ALL THEN ALLFLAG='1'B;
      124     5307    2              ELSE DO I=0 TO ENQBLK.NSUBLKS-1;
      125     5308    2                 DA_CUN=0;
      126     5309    2                 IF ENQBLK.SUBLK$(I)->SUBLK.CODE=%DA_USERSEL_ALL THEN I=512;
      127     5310    3                 ELSE DO WHILE('1'B);
      128     5311    3                    CALL DAA$NXTUSR(ENQBLK.SUBLK$(I)->SUBLK)ALTRET(NONXTUSR);
      129     5312    3                    CALL INDEX(J,BINASC(DA_CUN),SUBSTR(USERS,0,USER#))ALTRET(NOTIN);
      130     5313    4                    DO WHILE('0'B);
      131     5314    4   NOTIN:              CALL INSERT(USERS,USER#,1,BINASC(DA_CUN));
      132     5315    4                       USER#=USER#+1;
      133     5316    4                       END;
      134     5317    3                    END;
      135     5318    2   NONXTUSR:     ;
      136     5319    2                 END;
      137     5320    1           IF I>=511 THEN USER#=0;
      138     5321    1           ELSE IF NOT ALLFLAG AND USER#=0 THEN RETURN;
      139     5322    1           CALL DAF$INIT(REPORT);
      140     5323    1           CALL DAM$MAP(ENQ_BASE,ENQ$) ALTRET(MAP_ERR);
      141     5324    1           COUNT=(UQ_.NEXT_PAGE@-SIZEW(UQ_))/SIZEW(P$->QID)+50;
      142     5325    2           DO NEXTP@=0 TO SIZEC(UQ_.QBUCKET@)/SIZEC(UQ_.QBUCKET@(0))-1;
      143     5326    2              P$=PINCRW(ENQ$,UQ_.QBUCKET@(NEXTP@));
      144     5327    3              DO WHILE(P$~=ENQ$);
      145     5328    3                 NEXTH@=P$->QID.HCHAIN@;
      146     5329    3                 CALL DO_QID;
      147     5330    3                 P$=PINCRW(ENQ$,NEXTH@);
      148     5331    3                 IF COUNT<0 THEN P$=ENQ$;
      149     5332    4                 ELSE IF COUNT<=25 THEN DO;
      150     5333    4                       ALLFLAG='1'B;
      151     5334    4                       USER#=0;
      152     5335    4                       CALL DAF$WRITE(VECTOR(LOOP_MESS));
      153     5336    4                       COUNT=0;
      154     5337    4                       END;
      155     5338    3                 END;
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:6    
      156     5339    2              END;
      157     5340    1           COUNT=COUNT-50;
      158     5341    1           I=COUNT-UQ_.FREE_BLOCKS;
      159     5342    1           COUNT=(UQ_.NEXT_PAGE@-SIZEW(UQ_))/SIZEW(P$->QID)-COUNT;
      160     5343    1           IF REPORT.CURLINE=1 THEN REPORT.CURLINE=2;
      161     5344    1           CALL DAF$WRITE(VECTOR(FREEMESS),VECTOR(ENQ$->UQ_.FREE_BLOCKS),
      162     5345    1             VECTOR(COUNT),VECTOR(I));
      163     5346    2           IF ERRFLAG THEN DO;
      164     5347    2              CALL DAM$MAP(ENQ_BASE,ENQ$) ALTRET(MAP_ERR);
      165     5348    2              COUNT=UQ_.NEXT_PAGE@;
      166     5349    2              CALL DAB$OCTDUMP(UQ_,COUNT,0,'1'B);
      167     5350    2              END;
      168     5351    1   MAP_ERR: ;
      169     5352    1           RETURN;
      170     5353        %EJECT;
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:7    
      171     5354    1   DO_QID: PROC;
      172     5355    2           COUNT=COUNT-1;
      173     5356    2           IF P$->QID.TYPE~=QID_TYPE OR MOD(BITBIN(P$->QID.NAME),262144)~=CFU_
      174     5357    3           OR P$->QID.NAME&'6'O THEN DO;
      175     5358    3              I=POFFW(P$,ENQ$);
      176     5359    3              ERRFLAG='1'B;
      177     5360    3              CALL DAF$WRITE(VECTOR(QIDER_MESS),VECTOR(I),VECTOR(P$->QID));
      178     5361    3              END;
      179     5362    3           ELSE DO;
      180     5363    3              NEXTX@=P$->QID.XCHAIN@;
      181     5364    3              CFU@=BITBIN(P$->QID.NAME)/262144;
      182     5365    3              RNAME.SEP=' ';
      183     5366    3              RNAME.NDOTA='Account Directory';
      184     5367    3              RNAME.NAME=P$->QID.NAME;
      185     5368    3              IF NOT P$->QID.NAME&'77777'O THEN RNAME.PSN=' Master';
      186     5369    4              ELSE DO;
      187     5370    4                 CALL DAM$MAP(CFU$,CM$) ALTRET(RETRET);
      188     5371    4                 C$=PINCRW(CM$,CFU@);
      189     5372    4                 IF C_.X=6 THEN RNAME.NDOTA='Free Extent List';
      190     5373    4                 C_.X=0;
      191     5374    4                 T$=ADDR(FM$SETA(FM$CFUX.SETH));
      192     5375    5                 DO WHILE(T$~=CM$ AND T$~=C$);
      193     5376    5                    T$=ADDR(FM$SETA(T$->FM$SET.SETL));
      194     5377    5                    END;
      195     5378    5                 IF C$->FM$CFU.FUN~=0 THEN DO;
      196     5379    5                    CA$=PINCRW(CM$,C$->FM$CFU.ACCTX/8*8);
      197     5380    6                    DO WHILE(C$->FM$CFU.NAMEX<FM$CFUX.CFUT);
      198     5381    6                       C$=PINCRW(CM$,C$->FM$CFU.NAMEX);
      199     5382    6                       END;
      200     5383    5                    C$=PINCRC(CM$,C$->FM$CFU.NAMEX);
      201     5384    5                    I=C$->FM$CFUN.L;
      202     5385    5                    RNAME.NDOTA=C$->FM$CFUN.C;
      203     5386    5                    IF CA$=CM$ THEN RNAME.NDOTA='/deleted//////';
      204     5387    6                    ELSE IF CA$<C$ THEN DO;
      205     5388    6                       CALL INSERT(RNAME.NDOTA,I,9,'.',CA$->FM$CFUA.ACCT);
      206     5389    6                       C$=ADDR(FM$SETA(CA$->FM$CFUA.SETX));
      207     5390    6                       END;
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:8    
      208     5391    5                    RNAME.SEP='/';
      209     5392    5                    END;
      210     5393    5                 ELSE IF T$=CM$ THEN DO;
      211     5394    5                    RNAME.SEP='.';
      212     5395    5                    RNAME.NDOTA=C$->FM$CFUA.ACCT;
      213     5396    5                    C$=ADDR(FM$SETA(C$->FM$CFUA.SETX));
      214     5397    5                    END;
      215     5398    5                 IF SUBSTR(RNAME.NDOTA,0,1)='*' OR SUBSTR(RNAME.NDOTA,0,1)='/' THEN DO;
      216     5399    5                    IF SUBSTR(RNAME.NDOTA,0,1)='*' THEN RNAME.PSN='DP#SYS';
      217     5400    5                    ELSE RNAME.PSN='   //////';
      218     5401    5                    END;
      219     5402    5                 ELSE DO;
      220     5403    5                    CALL CONCAT(RNAME.PSN,'DP#',C$->FM$SET.PSN);
      221     5404    5                    END;
      222     5405    4                 CALL DAM$MAP(ENQ_BASE,ENQ$) ALTRET(RETRET);
      223     5406    4                 END;
      224     5407    3              RNAME.TFLG=1;
      225     5408    4              IF NEXTX@=ENQ_NULL THEN DO;
      226     5409    4                 RNAME.TFLG=0;
      227     5410    4                 RNAME.R$=R$;
      228     5411    4                 RNAME.TC.C=50;
      229     5412    4                 IF ALLFLAG THEN CALL DAF$WRITE(VECTOR(RNAME_MESS),VECTOR(RNAME));
      230     5413    4                 END;
      231     5414    4              ELSE DO WHILE(NEXTX@~=ENQ_NULL AND COUNT>=0);
      232     5415    4                 R$=PINCRW(ENQ$,NEXTX@);
      233     5416    4                 NEXTX@=R$->RNAME1.XCHAIN@;
      234     5417    5                 DO WHILE(R$~=ENQ$ AND COUNT>=0);
      235     5418    5                    RNAME.R$=R$;
      236     5419    5                    RNAME.TC.C=50;
      237     5420    5                    CALL DO_RNAME;
      238     5421    5                    R$=PINCRW(ENQ$,R$->RNAME1.RCHAIN@);
      239     5422    5                    END;
      240     5423    4                 END;
      241     5424    3              END;
      242     5425    2   RETRET:;
      243     5426    2           RETURN;
      244     5427    2   END DO_QID;
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:9    
      245     5428        %EJECT;
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:10   
      246     5429    1   DO_RNAME: PROC;
      247     5430    2           COUNT=COUNT-1;
      248     5431    2           RNAME.TXT(0)=BINASC(0);
      249     5432    2           T$=PINCRW(ENQ$,R$->RNAME1.NCHAIN@);
      250     5433    2           J=0;
      251     5434    3           DO WHILE(T$~=ENQ$ AND J<SIZEC(RNAME.TXT)/13);
      252     5435    3              COUNT=COUNT-1;
      253     5436    3              CALL XLATE (RNAME.TXT(J),B$XL_ASC_DUMP,T$->NNODE.TEXT);
      254     5437    4              IF J=0 THEN DO;
      255     5438    4                 I=ASCBIN(SUBSTR(T$->NNODE.TEXT,0,1));
      256     5439    4                 SUBSTR(RNAME.TXT(0),0,1)=BINASC(I);
      257     5440    4                 END;
      258     5441    4              IF RNAME.TXT(J)~=T$->NNODE.TEXT THEN DO;
      259     5442    5                 IF J=I/13 THEN DO;
      260     5443    5                    I=I-J*13+1;
      261     5444    5                    IF SUBSTR(RNAME.TXT(J),0,I)~=SUBSTR(T$->NNODE.TEXT,0,I)
      262     5445    5                    THEN RNAME.TFLG=RNAME.TFLG+2;
      263     5446    5                    END;
      264     5447    4                 ELSE RNAME.TFLG=RNAME.TFLG+2;
      265     5448    4                 RNAME.TXT(J)=T$->NNODE.TEXT;
      266     5449    4                 END;
      267     5450    3              J=J+1;
      268     5451    3              T$=PINCRW(ENQ$,T$->NNODE.NCHAIN@);
      269     5452    3              END;
      270     5453    2           Q$=PINCRW(ENQ$,R$->RNAME1.QCHAIN@);
      271     5454    2           IF ALLFLAG OR Q$~=ENQ$ AND USER#=0 THEN CALL DAF$WRITE
      272     5455    2                (VECTOR(RNAME_MESS),VECTOR(RNAME));
      273     5456    3           DO WHILE(Q$~=ENQ$ AND COUNT>=0);
      274     5457    3              COUNT=COUNT-1;
      275     5458    3              IF USER#~=0 THEN CALL INDEX(J,
      276     5459    3                   BINASC(Q$->QENTRY.DOM_USER.USER),
      277     5460    3                   SUBSTR(USERS,0,USER#))ALTRET(NOTUSER);
      278     5461    3              QNTRY.W1=Q$->QID.XCHAIN@;
      279     5462    3              QNTRY.Q$=Q$;
      280     5463    4              IF USER#~=0 AND T$~=ADDR(NIL) THEN DO;
      281     5464    4                 CALL DAF$WRITE(VECTOR(RNAME_MESS),VECTOR(RNAME));
      282     5465    4                 T$=ADDR(NIL);
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:11   
      283     5466    4                 END;
      284     5467    3              QNTRY.STATE=STATE_NAMES(Q$->QENTRY.STATE);
      285     5468    3              QNTRY.REQ=SMODE_NAMES(Q$->QENTRY.REQ_);
      286     5469    3              QNTRY.UPG=SMODE_NAMES(Q$->QENTRY.UPG_);
      287     5470    3              QNTRY.EVID=Q$->QENTRY.EVENT_ID;
      288     5471    3              CALL DAF$WRITE(VECTOR(QENTRY_MESS),VECTOR(QNTRY));
      289     5472    3   NOTUSER:;
      290     5473    3              Q$=PINCRW(ENQ$,Q$->QENTRY.QCHAIN@);
      291     5474    3              END;
      292     5475    2           RETURN;
      293     5476    2   END DO_RNAME;
      294     5477    1   END DAD$ENQ;

PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:12   
--  Include file information  --

   FM$SET.:E05TOU  is referenced.
   FM$CFU.:E05TOU  is referenced.
   DA_FORMAT_C.:E05TOU  is referenced.
   DA_CMD_C.:E05TOU  is referenced.
   DA_MAP_R.:E05TOU  cannot be made into a system file and is referenced.
   DA_ANLZ_R.:E05TOU  cannot be made into a system file and is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   UQ$NODES.:E05TOU  cannot be made into a system file and is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure DAD$ENQ.

   Procedure DAD$ENQ requires 687 words for executable code.
   Procedure DAD$ENQ requires 326 words of local(AUTO) storage.

    No errors detected in file DAD$ENQ.:E05TSI    .

PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:13   

 Object Unit name= DAD$ENQ                                    File name= DAD$ENQ.:E05TOU
 UTS= JUL 29 '97 12:43:36.32 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    52     64  DAD$ENQ
    2   DCB   even  none     0      0  M$DO
    3   DCB   even  none     0      0  M$LO
    4  RoData even  UTS    115    163  DAD$ENQ
    5   Proc  even  none   687   1257  DAD$ENQ
    6  RoData even  none    30     36  DAD$ENQ

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes            yes      Std        1  DAD$ENQ

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 B_POINTER
 yes     yes           Std       1 DAA$NXTUSR
 yes     yes           Std       1 DAF$INIT
 yes     yes           Std       5 DAM$MAP
         yes           Std       5 DAB$OCTDUMP
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:14   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    B$XL_ASC_DUMP$                        DA_CUN
     B$JIT$                                DAF$WRITE                             M$DO
     M$LO                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:15   


        1        1        /*M* DAD$ENQ - DISPLAY ENQ/DEQ TABLES FOR ANLZ */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        DAD$ENQ: PROC(ENQBLK);

      7  5 000000   000000 700200 xent  DAD$ENQ      TSX0  ! X66_AUTO_1
         5 000001   000506 000001                    ZERO    326,1

        8        8        %INCLUDE CP_6;
        9       89        %INCLUDE B_SEGIDS_C;
       10      628        %SUB U_BASE$=ENQ$;
       11      629        %INCLUDE UQ$NODES;
       12      760        %INCLUDE XU_FORMAT_C;
       13      922        %INCLUDE XU_MACRO_C;
       14     4028 S      %INCLUDE B$JIT_C;
       15     4029        %INCLUDE B$TABLES_C;
       16     4137        %B$XL_ASC_DUMP;
       17     4141        %INCLUDE DA_ANLZ_R;
       18     4154    1   DCL DAA$NXTUSR ENTRY(1)ALTRET;
       19     4155    1   DCL DAB$OCTDUMP ENTRY(5);
       20     4156        %INCLUDE DA_MAP_R;
       21     4186        %INCLUDE DA_CMD_C;
       22     4535        %B$JIT0;
       23     4624        %U$JIT1X;
       24     4627        %M$JIT2X;
       25     4630        %F$JIT3X;
       26     4633        %S$JIT4X;
       27     4636        %J$JIT5X;
       28     4639        %A$JIT6X;
       29     4642        %SUB ENQ_NULL=0;
       30     4643    1   DCL B$JIT$ PTR SYMREF;
       31     4644    1   DCL B$TCB$ PTR SYMREF;
       32     4645        %PARSE$OUT(NAME=ENQBLK,STCLASS=);
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:16   
       33     4690        %PARSE$OUT(NAME=SUBLK,STCLASS=BASED);
       34     4735    1   DCL B$IS$ PTR SYMREF;
       35     4736        %INCLUDE DA_FORMAT_C;
       36     4978    1   DCL DAF$INIT ENTRY(1) ALTRET;
       37     4979    1   DCL DAF$WRITE EPTR SYMREF;
       38     4980    1   DCL DAF$NEWPAGE ENTRY;
       39     4981        %INCLUDE FM$CFU;
       40     5026        %FM$CFU;
       41     5032        %FM$CFUA;
       42     5038        %FM$CFUN;
       43     5041        %SUB F$CFU$=CM$;
       44     5042        %FM$CFUX;
       45     5047        %INCLUDE FM$SET;
       46     5074        %FM$SET(ARY=);
       47     5079        %FM$SET(FM$SET=FM$SETA,BASED="BASED(CM$)");
       48     5084    1   DCL DAM$MAP ENTRY(5) ALTRET;
       49     5085        %REPORT (NAME=REPORT,TITLE='ENQ/DEQ TABLES.',HEADER=YES,WRAPTAB=14);
       50     5151        %HEADER(TEXT=
       51     5152        ' QENTRY STATE     REQUEST UPGRADE W D USER     EVENT_ID',LAST=NO);
       52     5194        %HEADER(TEXT=
       53     5195        ' ------ --------- ------- ------- - - ---- ------------');
       54     5237    1   DCL M$DO DCB;
       55     5238    1   DCL M$LO DCB;
       56     5239    1   DCL I SBIN WORD;
       57     5240    1   DCL P$ PTR;
       58     5241    1   DCL Q$ PTR;
       59     5242    1   DCL R$ PTR;
       60     5243    1   DCL 1 C_ STATIC,
       61     5244    1         2 * BIT(15) UNAL,
       62     5245    1         2 X UBIN(3) UNAL,
       63     5246    1         2 * UBIN HALF UNAL;
       64     5247    1   DCL C$ REDEF C_  PTR;
       65     5248    1   DCL CM$ PTR;
       66     5249    1   DCL CA$ PTR;
       67     5250    1   DCL J SBIN WORD;
       68     5251    1   DCL NEXTH@ SBIN WORD;
       69     5252    1   DCL NEXTX@ SBIN WORD;
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:17   
       70     5253    1   DCL NEXTP@ SBIN WORD;
       71     5254    1   DCL COUNT SBIN WORD;
       72     5255    1   DCL ALLFLAG BIT(1);
       73     5256    1   DCL ERRFLAG BIT(1);
       74     5257    1   DCL USER# SBIN ;
       75     5258    1   DCL USERS CHAR(512);
       76     5259    1   DCL 1 RNAME,
       77     5260    1         2 R$ PTR,
       78     5261    1         2 TC REDEF R$,
       79     5262    1            3 * BIT(27),
       80     5263    1            3 C UBIN(9)UNAL,
       81     5264    1         2 PSN CHAR(9),
       82     5265    1         2 SEP CHAR(1),
       83     5266    1         2 NDOTA CHAR(40),
       84     5267    1         2 NAME BIT(18),
       85     5268    1         2 TFLG UBIN(18)UNAL,
       86     5269    1         2 TXT(0:39) CHAR(13);
       87     5270    1   DCL 1 QNTRY,
       88     5271    1         2 Q$ PTR,
       89     5272    1         2 STATE CHAR(10),
       90     5273    1         2 REQ CHAR(8),
       91     5274    1         2 UPG CHAR(8),
       92     5275    1         2 W1 UBIN(18)UNAL,
       93     5276    1         2 EVID UBIN;
       94     5277    1   DCL STATE_NAMES(0:2) CHAR(9) CONSTANT INIT(
       95     5278    1        'Queued','Pending','Allocated');
       96     5279    1   DCL SMODE_NAMES(0:7) CHAR(6) CONSTANT INIT(
       97     5280    1         '------'*2,'All---','All-lc','Ltd---','Ltd-lc','None--'*2);
       98     5281    1   DCL 1 ENQ_BASE STATIC,
       99     5282    1         2 OFFSET UBIN HALF UNAL INIT(0),
      100     5283    1         2 * UBIN HALF UNAL INIT(BITBIN(%DS3SID));
      101     5284    1   DCL ENQ_BASE$ REDEF ENQ_BASE PTR;
      102     5285    1   DCL CFU_ UBIN WORD STATIC INIT(BITBIN(%DS1SID));
      103     5286    1   DCL CFU$ REDEF CFU_ PTR;
      104     5287    1   DCL CFU@ UBIN STATIC;
      105     5288    1   DCL ENQ$ PTR;
      106     5289    1   DCL T$ PTR;
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:18   
      107     5290    1   DCL LOOP_MESS CHAR(0)CONSTANT INIT(
      108     5291    1    ' **** ENQ/DEQ Table inconsistency (looping) ****');
      109     5292    1   DCL FREEMESS CHAR(0) CONSTANT INIT(
      110     5293    1    ' %D Free blocks, %+D in use, %+D unaccounted for');
      111     5294    1   DCL QENTRY_MESS CHAR(0) CONSTANT INIT(
      112     5295    1    ' %6.18ZO%2S %26AN%1N.5N(%35-Y%) %1.3D .%3.9ZO %12ZO%S');
      113     5296    1   DCL QIDER_MESS CHAR(0)CONSTANT INIT(
      114     5297    1    ' *** Bad QID at .%6ZO  %4(%12ZO %)');
      115     5298    1   DCL 1 RNAME_MESS CONSTANT,2 * CHAR(0) INIT(
      116     5299    1    ' Rname @ %5.18ZO: %.9N>T%..54P %45>-%6.18ZO%18N:=:1&( ''%9N:1=:?(%.1#.1A%)'''),
      117     5300    1      2 * CHAR(0) INIT('%#:2/[%1Q%]%/%..58P%14-''%9N(%3.9ZO%)''O%1Q');
      118     5301        %EJECT;
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:19   
      119     5302    1           USER#=0;

   5302  5 000002   200021 450100                    STZ     USER#,,AUTO

      120     5303    1           ALLFLAG='0'B;

   5303  5 000003   200017 450100                    STZ     ALLFLAG,,AUTO

      121     5304    1           ERRFLAG='0'B;

   5304  5 000004   200020 450100                    STZ     ERRFLAG,,AUTO

      122     5305    1           IF ENQBLK.NSUBLKS=0 THEN ALLFLAG='1'B;

   5305  5 000005   200003 470500                    LDP0    @ENQBLK,,AUTO
         5 000006   000001 220100                    LDX0    1,,PR0
         5 000007   000013 601000 5                  TNZ     s:5306

   5305  5 000010   400000 236003                    LDQ     -131072,DU
         5 000011   200017 756100                    STQ     ALLFLAG,,AUTO
         5 000012   000100 710000 5                  TRA     s:5320

      123     5306    1           ELSE IF ENQBLK.SUBLK$(0)->SUBLK.CODE=%DA_ENQ_ALL THEN ALLFLAG='1'B;

   5306  5 000013   000003 471500                    LDP1    3,,PR0
         5 000014   100000 721100                    LXL1    0,,PR1
         5 000015   000001 101003                    CMPX1   1,DU
         5 000016   000022 601000 5                  TNZ     s:5307

   5306  5 000017   400000 236003                    LDQ     -131072,DU
         5 000020   200017 756100                    STQ     ALLFLAG,,AUTO
         5 000021   000100 710000 5                  TRA     s:5320

      124     5307    2              ELSE DO I=0 TO ENQBLK.NSUBLKS-1;

   5307  5 000022   200004 450100                    STZ     I,,AUTO
         5 000023   000073 710000 5                  TRA     NONXTUSR+1
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:20   

      125     5308    2                 DA_CUN=0;

   5308  5 000024   000000 450000 xsym               STZ     DA_CUN

      126     5309    2                 IF ENQBLK.SUBLK$(I)->SUBLK.CODE=%DA_USERSEL_ALL THEN I=512;

   5309  5 000025   200003 470500                    LDP0    @ENQBLK,,AUTO
         5 000026   200004 720100                    LXL0    I,,AUTO
         5 000027   000003 471510                    LDP1    3,X0,PR0
         5 000030   100000 721100                    LXL1    0,,PR1
         5 000031   000035 601000 5                  TNZ     s:5311

   5309  5 000032   001000 235007                    LDA     512,DL
         5 000033   200004 755100                    STA     I,,AUTO
         5 000034   000072 710000 5                  TRA     NONXTUSR

      127     5310    3                 ELSE DO WHILE('1'B);

      128     5311    3                    CALL DAA$NXTUSR(ENQBLK.SUBLK$(I)->SUBLK)ALTRET(NONXTUSR);

   5311  5 000035   200003 470500                    LDP0    @ENQBLK,,AUTO
         5 000036   200004 720100                    LXL0    I,,AUTO
         5 000037   000003 471510                    LDP1    3,X0,PR0
         5 000040   200462 451500                    STP1    T$+5,,AUTO
         5 000041   200462 630500                    EPPR0   T$+5,,AUTO
         5 000042   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000043   000000 701000 xent               TSX1    DAA$NXTUSR
         5 000044   000072 702000 5                  TSX2    NONXTUSR

      129     5312    3                    CALL INDEX(J,BINASC(DA_CUN),SUBSTR(USERS,0,USER#))ALTRET(NOTIN);

   5312  5 000045   000000 236000 xsym               LDQ     DA_CUN
         5 000046   000033 736000                    QLS     27
         5 000047   000000 276000 6                  ORQ     0
         5 000050   200021 720100                    LXL0    USER#,,AUTO
         5 000051   200462 756100                    STQ     T$+5,,AUTO
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:21   
         5 000052   000100 124540                    SCM     mask='000'O
         5 000053   200022 000010                    ADSC9   USERS,,AUTO              cn=0,n=*X0
         5 000054   200462 000001                    ADSC9   T$+5,,AUTO               cn=0,n=1
         5 000055   200012 000100                    ARG     J,,AUTO
         5 000056   000060 606400 5                  TTN     NOTIN

      130     5313    4                    DO WHILE('0'B);

   5313  5 000057   000035 710000 5                  TRA     s:5311

      131     5314    4   NOTIN:              CALL INSERT(USERS,USER#,1,BINASC(DA_CUN));

   5314  5 000060   000000 236000 xsym  NOTIN        LDQ     DA_CUN
         5 000061   000033 736000                    QLS     27
         5 000062   000000 276000 6                  ORQ     0
         5 000063   200462 756100                    STQ     T$+5,,AUTO
         5 000064   200021 235100                    LDA     USER#,,AUTO
         5 000065   040105 100500                    MLR     fill='040'O
         5 000066   200462 000004                    ADSC9   T$+5,,AUTO               cn=0,n=4
         5 000067   200022 000001                    ADSC9   USERS,A,AUTO             cn=0,n=1

      132     5315    4                       USER#=USER#+1;

   5315  5 000070   200021 054100                    AOS     USER#,,AUTO

      133     5316    4                       END;

      134     5317    3                    END;

   5317  5 000071   000035 710000 5                  TRA     s:5311

   5312  5 000072                       NONXTUSR     null
      135     5318    2   NONXTUSR:     ;
      136     5319    2                 END;

   5319  5 000072   200004 054100                    AOS     I,,AUTO
         5 000073   200003 470500                    LDP0    @ENQBLK,,AUTO
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:22   
         5 000074   000001 236100                    LDQ     1,,PR0
         5 000075   000022 772000                    QRL     18
         5 000076   200004 116100                    CMPQ    I,,AUTO
         5 000077   000024 605400 5                  TPNZ    s:5308

      137     5320    1           IF I>=511 THEN USER#=0;

   5320  5 000100   200004 235100                    LDA     I,,AUTO
         5 000101   000777 115007                    CMPA    511,DL
         5 000102   000105 604000 5                  TMI     s:5321

   5320  5 000103   200021 450100                    STZ     USER#,,AUTO
         5 000104   000112 710000 5                  TRA     s:5322

      138     5321    1           ELSE IF NOT ALLFLAG AND USER#=0 THEN RETURN;

   5321  5 000105   200017 234100                    SZN     ALLFLAG,,AUTO
         5 000106   000112 604000 5                  TMI     s:5322
         5 000107   200021 236100                    LDQ     USER#,,AUTO
         5 000110   000112 601000 5                  TNZ     s:5322

   5321  5 000111   000000 702200 xent               TSX2  ! X66_ARET

      139     5322    1           CALL DAF$INIT(REPORT);

   5322  5 000112   000001 630400 6                  EPPR0   1
         5 000113   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000114   000000 701000 xent               TSX1    DAF$INIT
         5 000115   000000 011000                    NOP     0

      140     5323    1           CALL DAM$MAP(ENQ_BASE,ENQ$) ALTRET(MAP_ERR);

   5323  5 000116   200454 630500                    EPPR0   ENQ$,,AUTO
         5 000117   200463 450500                    STP0    T$+6,,AUTO
         5 000120   000002 236000 6                  LDQ     2
         5 000121   200462 756100                    STQ     T$+5,,AUTO
         5 000122   200462 630500                    EPPR0   T$+5,,AUTO
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:23   
         5 000123   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000124   000000 701000 xent               TSX1    DAM$MAP
         5 000125   000317 702000 5                  TSX2    MAP_ERR

      141     5324    1           COUNT=(UQ_.NEXT_PAGE@-SIZEW(UQ_))/SIZEW(P$->QID)+50;

   5324  5 000126   200454 470500                    LDP0    ENQ$,,AUTO
         5 000127   000041 236100                    LDQ     33,,PR0
         5 000130   000044 136007                    SBLQ    36,DL
         5 000131   000004 506007                    DIV     4,DL
         5 000132   000062 036007                    ADLQ    50,DL
         5 000133   200016 756100                    STQ     COUNT,,AUTO

      142     5325    2           DO NEXTP@=0 TO SIZEC(UQ_.QBUCKET@)/SIZEC(UQ_.QBUCKET@(0))-1;

   5325  5 000134   200015 450100                    STZ     NEXTP@,,AUTO
         5 000135   000204 710000 5                  TRA     s:5339+1

      143     5326    2              P$=PINCRW(ENQ$,UQ_.QBUCKET@(NEXTP@));

   5326  5 000136   200454 470500                    LDP0    ENQ$,,AUTO
         5 000137   200015 720100                    LXL0    NEXTP@,,AUTO
         5 000140   000000 221110                    LDX1    0,X0,PR0
         5 000141   000000 636011                    EAQ     0,X1
         5 000142   200454 036100                    ADLQ    ENQ$,,AUTO
         5 000143   200005 756100                    STQ     P$,,AUTO

      144     5327    3              DO WHILE(P$~=ENQ$);

   5327  5 000144   200454 116100                    CMPQ    ENQ$,,AUTO
         5 000145   000203 600000 5                  TZE     s:5339

      145     5328    3                 NEXTH@=P$->QID.HCHAIN@;

   5328  5 000146   200005 470500                    LDP0    P$,,AUTO
         5 000147   000001 236100                    LDQ     1,,PR0
         5 000150   000022 772000                    QRL     18
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:24   
         5 000151   200013 756100                    STQ     NEXTH@,,AUTO

      146     5329    3                 CALL DO_QID;

   5329  5 000152   000320 701000 5                  TSX1    DO_QID
         5 000153   000000 011000                    NOP     0

      147     5330    3                 P$=PINCRW(ENQ$,NEXTH@);

   5330  5 000154   200013 236100                    LDQ     NEXTH@,,AUTO
         5 000155   000022 736000                    QLS     18
         5 000156   200454 036100                    ADLQ    ENQ$,,AUTO
         5 000157   200005 756100                    STQ     P$,,AUTO

      148     5331    3                 IF COUNT<0 THEN P$=ENQ$;

   5331  5 000160   200016 235100                    LDA     COUNT,,AUTO
         5 000161   000165 605000 5                  TPL     s:5332

   5331  5 000162   200454 236100                    LDQ     ENQ$,,AUTO
         5 000163   200005 756100                    STQ     P$,,AUTO
         5 000164   000200 710000 5                  TRA     s:5338

      149     5332    4                 ELSE IF COUNT<=25 THEN DO;

   5332  5 000165   000031 115007                    CMPA    25,DL
         5 000166   000200 605400 5                  TPNZ    s:5338

      150     5333    4                       ALLFLAG='1'B;

   5333  5 000167   400000 236003                    LDQ     -131072,DU
         5 000170   200017 756100                    STQ     ALLFLAG,,AUTO

      151     5334    4                       USER#=0;

   5334  5 000171   200021 450100                    STZ     USER#,,AUTO

PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:25   
      152     5335    4                       CALL DAF$WRITE(VECTOR(LOOP_MESS));

   5335  5 000172   000006 630400 6                  EPPR0   6
         5 000173   000000 220000 xsym               LDX0    DAF$WRITE
         5 000174   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000175   000000 701010                    TSX1    0,X0
         5 000176   000000 011000                    NOP     0

      153     5336    4                       COUNT=0;

   5336  5 000177   200016 450100                    STZ     COUNT,,AUTO

      154     5337    4                       END;

      155     5338    3                 END;

   5338  5 000200   200005 236100                    LDQ     P$,,AUTO
         5 000201   200454 116100                    CMPQ    ENQ$,,AUTO
         5 000202   000146 601000 5                  TNZ     s:5328

      156     5339    2              END;

   5339  5 000203   200015 054100                    AOS     NEXTP@,,AUTO
         5 000204   200015 235100                    LDA     NEXTP@,,AUTO
         5 000205   000037 115007                    CMPA    31,DL
         5 000206   000136 604400 5                  TMOZ    s:5326

      157     5340    1           COUNT=COUNT-50;

   5340  5 000207   000062 336007                    LCQ     50,DL
         5 000210   200016 056100                    ASQ     COUNT,,AUTO

      158     5341    1           I=COUNT-UQ_.FREE_BLOCKS;

   5341  5 000211   200454 470500                    LDP0    ENQ$,,AUTO
         5 000212   200016 236100                    LDQ     COUNT,,AUTO
         5 000213   000042 136100                    SBLQ    34,,PR0
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:26   
         5 000214   200004 756100                    STQ     I,,AUTO

      159     5342    1           COUNT=(UQ_.NEXT_PAGE@-SIZEW(UQ_))/SIZEW(P$->QID)-COUNT;

   5342  5 000215   000041 236100                    LDQ     33,,PR0
         5 000216   000044 136007                    SBLQ    36,DL
         5 000217   000004 506007                    DIV     4,DL
         5 000220   200016 136100                    SBLQ    COUNT,,AUTO
         5 000221   200016 756100                    STQ     COUNT,,AUTO

      160     5343    1           IF REPORT.CURLINE=1 THEN REPORT.CURLINE=2;

   5343  5 000222   000001 220000 1                  LDX0    REPORT+1
         5 000223   000001 100003                    CMPX0   1,DU
         5 000224   000227 601000 5                  TNZ     s:5344

   5343  5 000225   000002 221003                    LDX1    2,DU
         5 000226   000001 741000 1                  STX1    REPORT+1

      161     5344    1           CALL DAF$WRITE(VECTOR(FREEMESS),VECTOR(ENQ$->UQ_.FREE_BLOCKS),

   5344  5 000227   777640 235007                    LDA     -96,DL
         5 000230   200454 236100                    LDQ     ENQ$,,AUTO
         5 000231   000042 036003                    ADLQ    34,DU
         5 000232   200462 757100                    STAQ    T$+5,,AUTO
         5 000233   777640 235007                    LDA     -96,DL
         5 000234   200464 452500                    STP2    T$+7,,AUTO
         5 000235   200464 236100                    LDQ     T$+7,,AUTO
         5 000236   000016 036003                    ADLQ    14,DU
         5 000237   200466 757100                    STAQ    T$+9,,AUTO
         5 000240   777640 235007                    LDA     -96,DL
         5 000241   200470 452500                    STP2    T$+11,,AUTO
         5 000242   200470 236100                    LDQ     T$+11,,AUTO
         5 000243   000004 036003                    ADLQ    4,DU
         5 000244   200474 757100                    STAQ    T$+15,,AUTO
         5 000245   200462 237100                    LDAQ    T$+5,,AUTO
         5 000246   200472 757100                    STAQ    T$+13,,AUTO
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:27   
         5 000247   200466 237100                    LDAQ    T$+9,,AUTO
         5 000250   200476 757100                    STAQ    T$+17,,AUTO
         5 000251   200474 237100                    LDAQ    T$+15,,AUTO
         5 000252   200500 757100                    STAQ    T$+19,,AUTO
         5 000253   200500 631500                    EPPR1   T$+19,,AUTO
         5 000254   200505 451500                    STP1    T$+24,,AUTO
         5 000255   200476 633500                    EPPR3   T$+17,,AUTO
         5 000256   200504 453500                    STP3    T$+23,,AUTO
         5 000257   200472 634500                    EPPR4   T$+13,,AUTO
         5 000260   200503 454500                    STP4    T$+22,,AUTO
         5 000261   000012 236000 6                  LDQ     10
         5 000262   200502 756100                    STQ     T$+21,,AUTO
         5 000263   200502 630500                    EPPR0   T$+21,,AUTO
         5 000264   000000 220000 xsym               LDX0    DAF$WRITE
         5 000265   000022 631400 xsym               EPPR1   B_VECTNIL+18
         5 000266   000000 701010                    TSX1    0,X0
         5 000267   000000 011000                    NOP     0

      162     5345    1             VECTOR(COUNT),VECTOR(I));
      163     5346    2           IF ERRFLAG THEN DO;

   5346  5 000270   200020 234100                    SZN     ERRFLAG,,AUTO
         5 000271   000317 605000 5                  TPL     MAP_ERR

      164     5347    2              CALL DAM$MAP(ENQ_BASE,ENQ$) ALTRET(MAP_ERR);

   5347  5 000272   200454 630500                    EPPR0   ENQ$,,AUTO
         5 000273   200463 450500                    STP0    T$+6,,AUTO
         5 000274   000002 236000 6                  LDQ     2
         5 000275   200462 756100                    STQ     T$+5,,AUTO
         5 000276   200462 630500                    EPPR0   T$+5,,AUTO
         5 000277   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000300   000000 701000 xent               TSX1    DAM$MAP
         5 000301   000317 702000 5                  TSX2    MAP_ERR

      165     5348    2              COUNT=UQ_.NEXT_PAGE@;

PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:28   
   5348  5 000302   200454 470500                    LDP0    ENQ$,,AUTO
         5 000303   000041 235100                    LDA     33,,PR0
         5 000304   200016 755100                    STA     COUNT,,AUTO

      166     5349    2              CALL DAB$OCTDUMP(UQ_,COUNT,0,'1'B);

   5349  5 000305   000014 237000 6                  LDAQ    12
         5 000306   200464 757100                    STAQ    T$+7,,AUTO
         5 000307   200016 631500                    EPPR1   COUNT,,AUTO
         5 000310   200463 451500                    STP1    T$+6,,AUTO
         5 000311   200454 236100                    LDQ     ENQ$,,AUTO
         5 000312   200462 756100                    STQ     T$+5,,AUTO
         5 000313   200462 630500                    EPPR0   T$+5,,AUTO
         5 000314   000022 631400 xsym               EPPR1   B_VECTNIL+18
         5 000315   000000 701000 xent               TSX1    DAB$OCTDUMP
         5 000316   000000 011000                    NOP     0

      167     5350    2              END;

   5346  5 000317                       MAP_ERR      null
      168     5351    1   MAP_ERR: ;
      169     5352    1           RETURN;

   5352  5 000317   000000 702200 xent               TSX2  ! X66_ARET

      170     5353        %EJECT;
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:29   
      171     5354    1   DO_QID: PROC;

   5354  5 000320   200456 741300       DO_QID       STX1  ! T$+1,,AUTO

      172     5355    2           COUNT=COUNT-1;

   5355  5 000321   000001 336007                    LCQ     1,DL
         5 000322   200016 056100                    ASQ     COUNT,,AUTO

      173     5356    2           IF P$->QID.TYPE~=QID_TYPE OR MOD(BITBIN(P$->QID.NAME),262144)~=CFU_

   5356  5 000323   200005 470500                    LDP0    P$,,AUTO
         5 000324   000000 236100                    LDQ     0,,PR0
         5 000325   777000 376003                    ANQ     -512,DU
         5 000326   030000 116003                    CMPQ    12288,DU
         5 000327   000337 601000 5                  TNZ     s:5358
         5 000330   000003 236100                    LDQ     3,,PR0
         5 000331   777777 376007                    ANQ     -1,DL
         5 000332   000062 116000 1                  CMPQ    CFU_
         5 000333   000337 601000 5                  TNZ     s:5358
         5 000334   000003 236100                    LDQ     3,,PR0
         5 000335   600000 376003                    ANQ     -65536,DU
         5 000336   000400 600000 5                  TZE     s:5363

      174     5357    3           OR P$->QID.NAME&'6'O THEN DO;

      175     5358    3              I=POFFW(P$,ENQ$);

   5358  5 000337   200454 235100                    LDA     ENQ$,,AUTO
         5 000340   000022 771000                    ARL     18
         5 000341   200462 755100                    STA     T$+5,,AUTO
         5 000342   200005 236100                    LDQ     P$,,AUTO
         5 000343   000022 772000                    QRL     18
         5 000344   200462 136100                    SBLQ    T$+5,,AUTO
         5 000345   200004 756100                    STQ     I,,AUTO

      176     5359    3              ERRFLAG='1'B;
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:30   

   5359  5 000346   400000 236003                    LDQ     -131072,DU
         5 000347   200020 756100                    STQ     ERRFLAG,,AUTO

      177     5360    3              CALL DAF$WRITE(VECTOR(QIDER_MESS),VECTOR(I),VECTOR(P$->QID));

   5360  5 000350   777640 235007                    LDA     -96,DL
         5 000351   200462 452500                    STP2    T$+5,,AUTO
         5 000352   200462 236100                    LDQ     T$+5,,AUTO
         5 000353   000004 036003                    ADLQ    4,DU
         5 000354   200464 757100                    STAQ    T$+7,,AUTO
         5 000355   000020 235000 6                  LDA     16
         5 000356   200005 236100                    LDQ     P$,,AUTO
         5 000357   200470 757100                    STAQ    T$+11,,AUTO
         5 000360   200464 237100                    LDAQ    T$+7,,AUTO
         5 000361   200466 757100                    STAQ    T$+9,,AUTO
         5 000362   200470 237100                    LDAQ    T$+11,,AUTO
         5 000363   200472 757100                    STAQ    T$+13,,AUTO
         5 000364   200472 631500                    EPPR1   T$+13,,AUTO
         5 000365   200476 451500                    STP1    T$+17,,AUTO
         5 000366   200466 633500                    EPPR3   T$+9,,AUTO
         5 000367   200475 453500                    STP3    T$+16,,AUTO
         5 000370   000021 236000 6                  LDQ     17
         5 000371   200474 756100                    STQ     T$+15,,AUTO
         5 000372   200474 630500                    EPPR0   T$+15,,AUTO
         5 000373   000000 220000 xsym               LDX0    DAF$WRITE
         5 000374   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 000375   000000 701010                    TSX1    0,X0
         5 000376   000000 011000                    NOP     0

      178     5361    3              END;

   5361  5 000377   000751 710000 5                  TRA     RETRET

      179     5362    3           ELSE DO;

      180     5363    3              NEXTX@=P$->QID.XCHAIN@;
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:31   

   5363  5 000400   000000 236100                    LDQ     0,,PR0
         5 000401   777777 376007                    ANQ     -1,DL
         5 000402   200014 756100                    STQ     NEXTX@,,AUTO

      181     5364    3              CFU@=BITBIN(P$->QID.NAME)/262144;

   5364  5 000403   000003 236100                    LDQ     3,,PR0
         5 000404   000022 772000                    QRL     18
         5 000405   000063 756000 1                  STQ     CFU@

      182     5365    3              RNAME.SEP=' ';

   5365  5 000406   000040 236003                    LDQ     32,DU
         5 000407   200225 552120                    STBQ    RNAME+3,'20'O,AUTO

      183     5366    3              RNAME.NDOTA='Account Directory';

   5366  5 000410   040100 100400                    MLR     fill='040'O
         5 000411   000137 000021 4                  ADSC9   RNAME_MESS+29            cn=0,n=17
         5 000412   200225 400050                    ADSC9   RNAME+3,,AUTO            cn=2,n=40

      184     5367    3              RNAME.NAME=P$->QID.NAME;

   5367  5 000413   000003 220100                    LDX0    3,,PR0
         5 000414   200237 440100                    SXL0    RNAME+13,,AUTO

      185     5368    3              IF NOT P$->QID.NAME&'77777'O THEN RNAME.PSN=' Master';

   5368  5 000415   000003 236100                    LDQ     3,,PR0
         5 000416   777770 376003                    ANQ     -8,DU
         5 000417   000424 601000 5                  TNZ     s:5370

   5368  5 000420   040100 100400                    MLR     fill='040'O
         5 000421   000144 000007 4                  ADSC9   RNAME_MESS+34            cn=0,n=7
         5 000422   200223 000011                    ADSC9   RNAME+1,,AUTO            cn=0,n=9
         5 000423   000660 710000 5                  TRA     s:5407
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:32   

      186     5369    4              ELSE DO;

      187     5370    4                 CALL DAM$MAP(CFU$,CM$) ALTRET(RETRET);

   5370  5 000424   200010 631500                    EPPR1   CM$,,AUTO
         5 000425   200463 451500                    STP1    T$+6,,AUTO
         5 000426   000022 236000 6                  LDQ     18
         5 000427   200462 756100                    STQ     T$+5,,AUTO
         5 000430   200462 630500                    EPPR0   T$+5,,AUTO
         5 000431   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000432   000000 701000 xent               TSX1    DAM$MAP
         5 000433   000751 702000 5                  TSX2    RETRET

      188     5371    4                 C$=PINCRW(CM$,CFU@);

   5371  5 000434   000063 236000 1                  LDQ     CFU@
         5 000435   000022 736000                    QLS     18
         5 000436   200010 036100                    ADLQ    CM$,,AUTO
         5 000437   000060 756000 1                  STQ     C_

      189     5372    4                 IF C_.X=6 THEN RNAME.NDOTA='Free Extent List';

   5372  5 000440   000060 236000 1                  LDQ     C_
         5 000441   000007 376003                    ANQ     7,DU
         5 000442   000006 116003                    CMPQ    6,DU
         5 000443   000447 601000 5                  TNZ     s:5373

   5372  5 000444   040100 100400                    MLR     fill='040'O
         5 000445   000146 000020 4                  ADSC9   RNAME_MESS+36            cn=0,n=16
         5 000446   200225 400050                    ADSC9   RNAME+3,,AUTO            cn=2,n=40

      190     5373    4                 C_.X=0;

   5373  5 000447   000023 236000 6                  LDQ     19
         5 000450   000060 356000 1                  ANSQ    C_

PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:33   
      191     5374    4                 T$=ADDR(FM$SETA(FM$CFUX.SETH));

   5374  5 000451   200010 470500                    LDP0    CM$,,AUTO
         5 000452   000005 236100                    LDQ     5,,PR0
         5 000453   000017 772000                    QRL     15
         5 000454   000024 376000 6                  ANQ     20
         5 000455   000022 736000                    QLS     18
         5 000456   200010 036100                    ADLQ    CM$,,AUTO
         5 000457   200455 756100                    STQ     T$,,AUTO

      192     5375    5                 DO WHILE(T$~=CM$ AND T$~=C$);

   5375  5 000460   000470 710000 5                  TRA     s:5377

      193     5376    5                    T$=ADDR(FM$SETA(T$->FM$SET.SETL));

   5376  5 000461   200455 470500                    LDP0    T$,,AUTO
         5 000462   000005 236100                    LDQ     5,,PR0
         5 000463   000017 772000                    QRL     15
         5 000464   000024 376000 6                  ANQ     20
         5 000465   000022 736000                    QLS     18
         5 000466   200010 036100                    ADLQ    CM$,,AUTO
         5 000467   200455 756100                    STQ     T$,,AUTO

      194     5377    5                    END;

   5377  5 000470   200010 116100                    CMPQ    CM$,,AUTO
         5 000471   000474 600000 5                  TZE     s:5378
         5 000472   000060 116000 1                  CMPQ    C_
         5 000473   000461 601000 5                  TNZ     s:5376

      195     5378    5                 IF C$->FM$CFU.FUN~=0 THEN DO;

   5378  5 000474   000060 470400 1                  LDP0    C_
         5 000475   000000 236100                    LDQ     0,,PR0
         5 000476   700000 316003                    CANQ    -32768,DU
         5 000477   000600 600000 5                  TZE     s:5393
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:34   

      196     5379    5                    CA$=PINCRW(CM$,C$->FM$CFU.ACCTX/8*8);

   5379  5 000500   000002 236100                    LDQ     2,,PR0
         5 000501   000022 772000                    QRL     18
         5 000502   000003 772000                    QRL     3
         5 000503   000025 736000                    QLS     21
         5 000504   200010 036100                    ADLQ    CM$,,AUTO
         5 000505   200011 756100                    STQ     CA$,,AUTO

      197     5380    6                    DO WHILE(C$->FM$CFU.NAMEX<FM$CFUX.CFUT);

   5380  5 000506   000002 720100                    LXL0    2,,PR0
         5 000507   200010 471500                    LDP1    CM$,,AUTO
         5 000510   100002 100100                    CMPX0   2,,PR1
         5 000511   000524 603000 5                  TRC     s:5383

      198     5381    6                       C$=PINCRW(CM$,C$->FM$CFU.NAMEX);

   5381  5 000512   000060 470400 1                  LDP0    C_
         5 000513   000002 720100                    LXL0    2,,PR0
         5 000514   000000 636010                    EAQ     0,X0
         5 000515   200010 036100                    ADLQ    CM$,,AUTO
         5 000516   000060 756000 1                  STQ     C_

      199     5382    6                       END;

   5382  5 000517   000060 470400 1                  LDP0    C_
         5 000520   000002 720100                    LXL0    2,,PR0
         5 000521   200010 471500                    LDP1    CM$,,AUTO
         5 000522   100002 100100                    CMPX0   2,,PR1
         5 000523   000512 602000 5                  TNC     s:5381

      200     5383    5                    C$=PINCRC(CM$,C$->FM$CFU.NAMEX);

   5383  5 000524   000002 236100                    LDQ     2,,PR0
         5 000525   777777 376007                    ANQ     -1,DL
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:35   
         5 000526   000020 736000                    QLS     16
         5 000527   200010 036100                    ADLQ    CM$,,AUTO
         5 000530   000060 756000 1                  STQ     C_

      201     5384    5                    I=C$->FM$CFUN.L;

   5384  5 000531   000060 470400 1                  LDP0    C_
         5 000532   000100 101500                    MRL     fill='000'O
         5 000533   000000 400001                    ADSC9   0,,PR0                   cn=2,n=1
         5 000534   200004 000004                    ADSC9   I,,AUTO                  cn=0,n=4

      202     5385    5                    RNAME.NDOTA=C$->FM$CFUN.C;

   5385  5 000535   000100 101500                    MRL     fill='000'O
         5 000536   000000 400001                    ADSC9   0,,PR0                   cn=2,n=1
         5 000537   200462 000002                    ADSC9   T$+5,,AUTO               cn=0,n=2
         5 000540   200462 220100                    LDX0    T$+5,,AUTO
         5 000541   040100 100540                    MLR     fill='040'O
         5 000542   000000 600010                    ADSC9   0,,PR0                   cn=3,n=*X0
         5 000543   200225 400050                    ADSC9   RNAME+3,,AUTO            cn=2,n=40

      203     5386    5                    IF CA$=CM$ THEN RNAME.NDOTA='/deleted//////';

   5386  5 000544   200011 236100                    LDQ     CA$,,AUTO
         5 000545   200010 116100                    CMPQ    CM$,,AUTO
         5 000546   000553 601000 5                  TNZ     s:5387

   5386  5 000547   040100 100400                    MLR     fill='040'O
         5 000550   000152 000016 4                  ADSC9   RNAME_MESS+40            cn=0,n=14
         5 000551   200225 400050                    ADSC9   RNAME+3,,AUTO            cn=2,n=40
         5 000552   000575 710000 5                  TRA     s:5391

      204     5387    6                    ELSE IF CA$<C$ THEN DO;

   5387  5 000553   000060 116000 1                  CMPQ    C_
         5 000554   000575 603000 5                  TRC     s:5391

PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:36   
      205     5388    6                       CALL INSERT(RNAME.NDOTA,I,9,'.',CA$->FM$CFUA.ACCT);

   5388  5 000555   200004 235100                    LDA     I,,AUTO
         5 000556   040105 100400                    MLR     fill='040'O
         5 000557   000025 000001 6                  ADSC9   21                       cn=0,n=1
         5 000560   200225 400001                    ADSC9   RNAME+3,A,AUTO           cn=2,n=1
         5 000561   200011 471500                    LDP1    CA$,,AUTO
         5 000562   200004 235100                    LDA     I,,AUTO
         5 000563   040105 100500                    MLR     fill='040'O
         5 000564   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         5 000565   200225 600010                    ADSC9   RNAME+3,A,AUTO           cn=3,n=8

      206     5389    6                       C$=ADDR(FM$SETA(CA$->FM$CFUA.SETX));

   5389  5 000566   200011 470500                    LDP0    CA$,,AUTO
         5 000567   000000 236100                    LDQ     0,,PR0
         5 000570   000017 772000                    QRL     15
         5 000571   000024 376000 6                  ANQ     20
         5 000572   000022 736000                    QLS     18
         5 000573   200010 036100                    ADLQ    CM$,,AUTO
         5 000574   000060 756000 1                  STQ     C_

      207     5390    6                       END;

      208     5391    5                    RNAME.SEP='/';

   5391  5 000575   000057 236003                    LDQ     47,DU
         5 000576   200225 552120                    STBQ    RNAME+3,'20'O,AUTO

      209     5392    5                    END;

   5392  5 000577   000616 710000 5                  TRA     s:5398

      210     5393    5                 ELSE IF T$=CM$ THEN DO;

   5393  5 000600   200455 236100                    LDQ     T$,,AUTO
         5 000601   200010 116100                    CMPQ    CM$,,AUTO
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:37   
         5 000602   000616 601000 5                  TNZ     s:5398

      211     5394    5                    RNAME.SEP='.';

   5394  5 000603   000056 236003                    LDQ     46,DU
         5 000604   200225 552120                    STBQ    RNAME+3,'20'O,AUTO

      212     5395    5                    RNAME.NDOTA=C$->FM$CFUA.ACCT;

   5395  5 000605   040100 100500                    MLR     fill='040'O
         5 000606   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         5 000607   200225 400050                    ADSC9   RNAME+3,,AUTO            cn=2,n=40

      213     5396    5                    C$=ADDR(FM$SETA(C$->FM$CFUA.SETX));

   5396  5 000610   000000 236100                    LDQ     0,,PR0
         5 000611   000017 772000                    QRL     15
         5 000612   000024 376000 6                  ANQ     20
         5 000613   000022 736000                    QLS     18
         5 000614   200010 036100                    ADLQ    CM$,,AUTO
         5 000615   000060 756000 1                  STQ     C_

      214     5397    5                    END;

      215     5398    5                IF SUBSTR(RNAME.NDOTA,0,1)='*' OR SUBSTR(RNAME.NDOTA,0,1)='/' THEN DO;

   5398  5 000616   200225 236100                    LDQ     RNAME+3,,AUTO
         5 000617   777000 376007                    ANQ     -512,DL
         5 000620   052000 116007                    CMPQ    21504,DL
         5 000621   000626 600000 5                  TZE     s:5399
         5 000622   200225 236100                    LDQ     RNAME+3,,AUTO
         5 000623   777000 376007                    ANQ     -512,DL
         5 000624   057000 116007                    CMPQ    24064,DL
         5 000625   000642 601000 5                  TNZ     s:5403

      216     5399    5                    IF SUBSTR(RNAME.NDOTA,0,1)='*' THEN RNAME.PSN='DP#SYS';

PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:38   
   5399  5 000626   200225 236100                    LDQ     RNAME+3,,AUTO
         5 000627   777000 376007                    ANQ     -512,DL
         5 000630   052000 116007                    CMPQ    21504,DL
         5 000631   000636 601000 5                  TNZ     s:5400

   5399  5 000632   040100 100400                    MLR     fill='040'O
         5 000633   000156 000006 4                  ADSC9   RNAME_MESS+44            cn=0,n=6
         5 000634   200223 000011                    ADSC9   RNAME+1,,AUTO            cn=0,n=9
         5 000635   000650 710000 5                  TRA     s:5405

      217     5400    5                    ELSE RNAME.PSN='   //////';

   5400  5 000636   040100 100400                    MLR     fill='040'O
         5 000637   000160 000011 4                  ADSC9   RNAME_MESS+46            cn=0,n=9
         5 000640   200223 000011                    ADSC9   RNAME+1,,AUTO            cn=0,n=9

      218     5401    5                    END;

   5401  5 000641   000650 710000 5                  TRA     s:5405

      219     5402    5                 ELSE DO;

      220     5403    5                    CALL CONCAT(RNAME.PSN,'DP#',C$->FM$SET.PSN);

   5403  5 000642   000156 236000 4                  LDQ     RNAME_MESS+44
         5 000643   200223 552170                    STBQ    RNAME+1,'70'O,AUTO
         5 000644   000060 470400 1                  LDP0    C_
         5 000645   040100 100500                    MLR     fill='040'O
         5 000646   000000 400006                    ADSC9   0,,PR0                   cn=2,n=6
         5 000647   200223 600006                    ADSC9   RNAME+1,,AUTO            cn=3,n=6

      221     5404    5                    END;

      222     5405    4                 CALL DAM$MAP(ENQ_BASE,ENQ$) ALTRET(RETRET);

   5405  5 000650   200454 630500                    EPPR0   ENQ$,,AUTO
         5 000651   200463 450500                    STP0    T$+6,,AUTO
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:39   
         5 000652   000002 236000 6                  LDQ     2
         5 000653   200462 756100                    STQ     T$+5,,AUTO
         5 000654   200462 630500                    EPPR0   T$+5,,AUTO
         5 000655   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000656   000000 701000 xent               TSX1    DAM$MAP
         5 000657   000751 702000 5                  TSX2    RETRET

      223     5406    4                 END;

      224     5407    3              RNAME.TFLG=1;

   5407  5 000660   000001 220003                    LDX0    1,DU
         5 000661   200240 740100                    STX0    RNAME+14,,AUTO

      225     5408    4              IF NEXTX@=ENQ_NULL THEN DO;

   5408  5 000662   200014 235100                    LDA     NEXTX@,,AUTO
         5 000663   000713 601000 5                  TNZ     s:5414

      226     5409    4                 RNAME.TFLG=0;

   5409  5 000664   000000 221003                    LDX1    0,DU
         5 000665   200240 741100                    STX1    RNAME+14,,AUTO

      227     5410    4                 RNAME.R$=R$;

   5410  5 000666   200007 236100                    LDQ     R$,,AUTO
         5 000667   200222 756100                    STQ     RNAME,,AUTO

      228     5411    4                 RNAME.TC.C=50;

   5411  5 000670   000062 236007                    LDQ     50,DL
         5 000671   200222 552104                    STBQ    RNAME,'04'O,AUTO

      229     5412    4                 IF ALLFLAG THEN CALL DAF$WRITE(VECTOR(RNAME_MESS),VECTOR(RNAME));

   5412  5 000672   200017 234100                    SZN     ALLFLAG,,AUTO
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:40   
         5 000673   000751 605000 5                  TPL     RETRET

   5412  5 000674   000030 235000 6                  LDA     24
         5 000675   200462 452500                    STP2    T$+5,,AUTO
         5 000676   200462 236100                    LDQ     T$+5,,AUTO
         5 000677   000222 036003                    ADLQ    146,DU
         5 000700   200464 757100                    STAQ    T$+7,,AUTO
         5 000701   200464 630500                    EPPR0   T$+7,,AUTO
         5 000702   200467 450500                    STP0    T$+10,,AUTO
         5 000703   000031 236000 6                  LDQ     25
         5 000704   200466 756100                    STQ     T$+9,,AUTO
         5 000705   200466 630500                    EPPR0   T$+9,,AUTO
         5 000706   000000 222000 xsym               LDX2    DAF$WRITE
         5 000707   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000710   000000 701012                    TSX1    0,X2
         5 000711   000000 011000                    NOP     0

      230     5413    4                 END;

   5413  5 000712   000751 710000 5                  TRA     RETRET

      231     5414    4              ELSE DO WHILE(NEXTX@~=ENQ_NULL AND COUNT>=0);

   5414  5 000713   000745 710000 5                  TRA     s:5423

      232     5415    4                 R$=PINCRW(ENQ$,NEXTX@);

   5415  5 000714   200014 236100                    LDQ     NEXTX@,,AUTO
         5 000715   000022 736000                    QLS     18
         5 000716   200454 036100                    ADLQ    ENQ$,,AUTO
         5 000717   200007 756100                    STQ     R$,,AUTO

      233     5416    4                 NEXTX@=R$->RNAME1.XCHAIN@;

   5416  5 000720   200007 470500                    LDP0    R$,,AUTO
         5 000721   000000 236100                    LDQ     0,,PR0
         5 000722   777777 376007                    ANQ     -1,DL
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:41   
         5 000723   200014 756100                    STQ     NEXTX@,,AUTO

      234     5417    5                 DO WHILE(R$~=ENQ$ AND COUNT>=0);

   5417  5 000724   000740 710000 5                  TRA     s:5422

      235     5418    5                    RNAME.R$=R$;

   5418  5 000725   200007 236100                    LDQ     R$,,AUTO
         5 000726   200222 756100                    STQ     RNAME,,AUTO

      236     5419    5                    RNAME.TC.C=50;

   5419  5 000727   000062 236007                    LDQ     50,DL
         5 000730   200222 552104                    STBQ    RNAME,'04'O,AUTO

      237     5420    5                    CALL DO_RNAME;

   5420  5 000731   000753 701000 5                  TSX1    DO_RNAME
         5 000732   000000 011000                    NOP     0

      238     5421    5                    R$=PINCRW(ENQ$,R$->RNAME1.RCHAIN@);

   5421  5 000733   200007 470500                    LDP0    R$,,AUTO
         5 000734   000001 720100                    LXL0    1,,PR0
         5 000735   000000 636010                    EAQ     0,X0
         5 000736   200454 036100                    ADLQ    ENQ$,,AUTO
         5 000737   200007 756100                    STQ     R$,,AUTO

      239     5422    5                    END;

   5422  5 000740   200007 236100                    LDQ     R$,,AUTO
         5 000741   200454 116100                    CMPQ    ENQ$,,AUTO
         5 000742   000745 600000 5                  TZE     s:5423
         5 000743   200016 235100                    LDA     COUNT,,AUTO
         5 000744   000725 605000 5                  TPL     s:5418

PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:42   
      240     5423    4                 END;

   5423  5 000745   200014 235100                    LDA     NEXTX@,,AUTO
         5 000746   000751 600000 5                  TZE     RETRET
         5 000747   200016 236100                    LDQ     COUNT,,AUTO
         5 000750   000714 605000 5                  TPL     s:5415

      241     5424    3              END;

   5421  5 000751                       RETRET       null
      242     5425    2   RETRET:;
      243     5426    2           RETURN;

   5426  5 000751   200456 221300                    LDX1  ! T$+1,,AUTO
         5 000752   000001 702211                    TSX2  ! 1,X1

      244     5427    2   END DO_QID;
      245     5428        %EJECT;
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:43   
      246     5429    1   DO_RNAME: PROC;

   5429  5 000753   200460 741300       DO_RNAME     STX1  ! T$+3,,AUTO

      247     5430    2           COUNT=COUNT-1;

   5430  5 000754   000001 336007                    LCQ     1,DL
         5 000755   200016 056100                    ASQ     COUNT,,AUTO

      248     5431    2           RNAME.TXT(0)=BINASC(0);

   5431  5 000756   040100 100400                    MLR     fill='040'O
         5 000757   000000 000001 6                  ADSC9   0                        cn=0,n=1
         5 000760   200240 400015                    ADSC9   RNAME+14,,AUTO           cn=2,n=13

      249     5432    2           T$=PINCRW(ENQ$,R$->RNAME1.NCHAIN@);

   5432  5 000761   200007 470500                    LDP0    R$,,AUTO
         5 000762   000003 720100                    LXL0    3,,PR0
         5 000763   000000 636010                    EAQ     0,X0
         5 000764   200454 036100                    ADLQ    ENQ$,,AUTO
         5 000765   200455 756100                    STQ     T$,,AUTO

      250     5433    2           J=0;

   5433  5 000766   200012 450100                    STZ     J,,AUTO

      251     5434    3           DO WHILE(T$~=ENQ$ AND J<SIZEC(RNAME.TXT)/13);

   5434  5 000767   001064 710000 5                  TRA     s:5452

      252     5435    3              COUNT=COUNT-1;

   5435  5 000770   000001 336007                    LCQ     1,DL
         5 000771   200016 056100                    ASQ     COUNT,,AUTO

      253     5436    3              CALL XLATE (RNAME.TXT(J),B$XL_ASC_DUMP,T$->NNODE.TEXT);
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:44   

   5436  5 000772   200012 236100                    LDQ     J,,AUTO
         5 000773   000015 402007                    MPY     13,DL
         5 000774   200455 470500                    LDP0    T$,,AUTO
         5 000775   000000 471400 xsym               LDP1    B$XL_ASC_DUMP$
         5 000776   040106 160500                    MVT     fill='040'O
         5 000777   000000 200015                    ADSC9   0,,PR0                   cn=1,n=13
         5 001000   200240 400015                    ADSC9   RNAME+14,Q,AUTO          cn=2,n=13
         5 001001   100000 000100                    ARG     0,,PR1

      254     5437    4              IF J=0 THEN DO;

   5437  5 001002   200012 235100                    LDA     J,,AUTO
         5 001003   001014 601000 5                  TNZ     s:5441

      255     5438    4                 I=ASCBIN(SUBSTR(T$->NNODE.TEXT,0,1));

   5438  5 001004   000000 236100                    LDQ     0,,PR0
         5 001005   000022 772000                    QRL     18
         5 001006   000777 376007                    ANQ     511,DL
         5 001007   200004 756100                    STQ     I,,AUTO

      256     5439    4                 SUBSTR(RNAME.TXT(0),0,1)=BINASC(I);

   5439  5 001010   000033 736000                    QLS     27
         5 001011   000000 276000 6                  ORQ     0
         5 001012   000022 772000                    QRL     18
         5 001013   200240 552110                    STBQ    RNAME+14,'10'O,AUTO

      257     5440    4                 END;

      258     5441    4              IF RNAME.TXT(J)~=T$->NNODE.TEXT THEN DO;

   5441  5 001014   200012 236100                    LDQ     J,,AUTO
         5 001015   000015 402007                    MPY     13,DL
         5 001016   040100 106506                    CMPC    fill='040'O
         5 001017   200240 400015                    ADSC9   RNAME+14,Q,AUTO          cn=2,n=13
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:45   
         5 001020   000000 200015                    ADSC9   0,,PR0                   cn=1,n=13
         5 001021   001057 600000 5                  TZE     s:5450

      259     5442    5                 IF J=I/13 THEN DO;

   5442  5 001022   200004 236100                    LDQ     I,,AUTO
         5 001023   000015 506007                    DIV     13,DL
         5 001024   200012 116100                    CMPQ    J,,AUTO
         5 001025   001047 601000 5                  TNZ     s:5447

      260     5443    5                    I=I-J*13+1;

   5443  5 001026   000000 236003                    LDQ     0,DU
         5 001027   200012 136100                    SBLQ    J,,AUTO
         5 001030   000015 402007                    MPY     13,DL
         5 001031   200004 036100                    ADLQ    I,,AUTO
         5 001032   000001 036007                    ADLQ    1,DL
         5 001033   200004 756100                    STQ     I,,AUTO

      261     5444    5                    IF SUBSTR(RNAME.TXT(J),0,I)~=SUBSTR(T$->NNODE.TEXT,0,I)

   5444  5 001034   200012 236100                    LDQ     J,,AUTO
         5 001035   000015 402007                    MPY     13,DL
         5 001036   200004 720100                    LXL0    I,,AUTO
         5 001037   040140 106546                    CMPC    fill='040'O
         5 001040   200240 400010                    ADSC9   RNAME+14,Q,AUTO          cn=2,n=*X0
         5 001041   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
         5 001042   001052 600000 5                  TZE     s:5448

      262     5445    5                    THEN RNAME.TFLG=RNAME.TFLG+2;

   5445  5 001043   200240 221100                    LDX1    RNAME+14,,AUTO
         5 001044   000002 622011                    EAX2    2,X1
         5 001045   200240 742100                    STX2    RNAME+14,,AUTO

      263     5446    5                    END;

PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:46   
   5446  5 001046   001052 710000 5                  TRA     s:5448

      264     5447    4                 ELSE RNAME.TFLG=RNAME.TFLG+2;

   5447  5 001047   200240 220100                    LDX0    RNAME+14,,AUTO
         5 001050   000002 621010                    EAX1    2,X0
         5 001051   200240 741100                    STX1    RNAME+14,,AUTO

      265     5448    4                 RNAME.TXT(J)=T$->NNODE.TEXT;

   5448  5 001052   200012 236100                    LDQ     J,,AUTO
         5 001053   000015 402007                    MPY     13,DL
         5 001054   040106 100500                    MLR     fill='040'O
         5 001055   000000 200015                    ADSC9   0,,PR0                   cn=1,n=13
         5 001056   200240 400015                    ADSC9   RNAME+14,Q,AUTO          cn=2,n=13

      266     5449    4                 END;

      267     5450    3              J=J+1;

   5450  5 001057   200012 054100                    AOS     J,,AUTO

      268     5451    3              T$=PINCRW(ENQ$,T$->NNODE.NCHAIN@);

   5451  5 001060   000003 720100                    LXL0    3,,PR0
         5 001061   000000 636010                    EAQ     0,X0
         5 001062   200454 036100                    ADLQ    ENQ$,,AUTO
         5 001063   200455 756100                    STQ     T$,,AUTO

      269     5452    3              END;

   5452  5 001064   200454 116100                    CMPQ    ENQ$,,AUTO
         5 001065   001071 600000 5                  TZE     s:5453
         5 001066   200012 235100                    LDA     J,,AUTO
         5 001067   000050 115007                    CMPA    40,DL
         5 001070   000770 604000 5                  TMI     s:5435

PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:47   
      270     5453    2           Q$=PINCRW(ENQ$,R$->RNAME1.QCHAIN@);

   5453  5 001071   200007 470500                    LDP0    R$,,AUTO
         5 001072   000001 220100                    LDX0    1,,PR0
         5 001073   000000 636010                    EAQ     0,X0
         5 001074   200454 036100                    ADLQ    ENQ$,,AUTO
         5 001075   200006 756100                    STQ     Q$,,AUTO

      271     5454    2           IF ALLFLAG OR Q$~=ENQ$ AND USER#=0 THEN CALL DAF$WRITE

   5454  5 001076   200017 234100                    SZN     ALLFLAG,,AUTO
         5 001077   001104 604000 5                  TMI     s:5454+6
         5 001100   200454 116100                    CMPQ    ENQ$,,AUTO
         5 001101   001122 600000 5                  TZE     s:5456
         5 001102   200021 235100                    LDA     USER#,,AUTO
         5 001103   001122 601000 5                  TNZ     s:5456

   5454  5 001104   000030 235000 6                  LDA     24
         5 001105   200462 452500                    STP2    T$+5,,AUTO
         5 001106   200462 236100                    LDQ     T$+5,,AUTO
         5 001107   000222 036003                    ADLQ    146,DU
         5 001110   200464 757100                    STAQ    T$+7,,AUTO
         5 001111   200464 631500                    EPPR1   T$+7,,AUTO
         5 001112   200467 451500                    STP1    T$+10,,AUTO
         5 001113   000031 236000 6                  LDQ     25
         5 001114   200466 756100                    STQ     T$+9,,AUTO
         5 001115   200466 630500                    EPPR0   T$+9,,AUTO
         5 001116   000000 220000 xsym               LDX0    DAF$WRITE
         5 001117   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 001120   000000 701010                    TSX1    0,X0
         5 001121   000000 011000                    NOP     0

      272     5455    2                (VECTOR(RNAME_MESS),VECTOR(RNAME));
      273     5456    3           DO WHILE(Q$~=ENQ$ AND COUNT>=0);

   5456  5 001122   001250 710000 5                  TRA     s:5474

PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:48   
      274     5457    3              COUNT=COUNT-1;

   5457  5 001123   000001 336007                    LCQ     1,DL
         5 001124   200016 056100                    ASQ     COUNT,,AUTO

      275     5458    3              IF USER#~=0 THEN CALL INDEX(J,

   5458  5 001125   200021 235100                    LDA     USER#,,AUTO
         5 001126   001143 600000 5                  TZE     s:5461

   5458  5 001127   200006 470500                    LDP0    Q$,,AUTO
         5 001130   000000 236100                    LDQ     0,,PR0
         5 001131   000777 376007                    ANQ     511,DL
         5 001132   000033 736000                    QLS     27
         5 001133   000000 276000 6                  ORQ     0
         5 001134   000000 620005                    EAX0    0,AL
         5 001135   200462 756100                    STQ     T$+5,,AUTO
         5 001136   000100 124540                    SCM     mask='000'O
         5 001137   200022 000010                    ADSC9   USERS,,AUTO              cn=0,n=*X0
         5 001140   200462 000001                    ADSC9   T$+5,,AUTO               cn=0,n=1
         5 001141   200012 000100                    ARG     J,,AUTO
         5 001142   001243 606400 5                  TTN     NOTUSER

      276     5459    3                   BINASC(Q$->QENTRY.DOM_USER.USER),
      277     5460    3                   SUBSTR(USERS,0,USER#))ALTRET(NOTUSER);
      278     5461    3              QNTRY.W1=Q$->QID.XCHAIN@;

   5461  5 001143   200006 470500                    LDP0    Q$,,AUTO
         5 001144   000000 720100                    LXL0    0,,PR0
         5 001145   200452 440100                    SXL0    QNTRY+7,,AUTO

      279     5462    3              QNTRY.Q$=Q$;

   5462  5 001146   200006 236100                    LDQ     Q$,,AUTO
         5 001147   200443 756100                    STQ     QNTRY,,AUTO

      280     5463    4              IF USER#~=0 AND T$~=ADDR(NIL) THEN DO;
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:49   

   5463  5 001150   200021 235100                    LDA     USER#,,AUTO
         5 001151   001175 600000 5                  TZE     s:5467
         5 001152   200455 236100                    LDQ     T$,,AUTO
         5 001153   000001 116000 xsym               CMPQ    B_VECTNIL+1
         5 001154   001175 600000 5                  TZE     s:5467

      281     5464    4                 CALL DAF$WRITE(VECTOR(RNAME_MESS),VECTOR(RNAME));

   5464  5 001155   000030 235000 6                  LDA     24
         5 001156   200462 452500                    STP2    T$+5,,AUTO
         5 001157   200462 236100                    LDQ     T$+5,,AUTO
         5 001160   000222 036003                    ADLQ    146,DU
         5 001161   200464 757100                    STAQ    T$+7,,AUTO
         5 001162   200464 631500                    EPPR1   T$+7,,AUTO
         5 001163   200467 451500                    STP1    T$+10,,AUTO
         5 001164   000031 236000 6                  LDQ     25
         5 001165   200466 756100                    STQ     T$+9,,AUTO
         5 001166   200466 630500                    EPPR0   T$+9,,AUTO
         5 001167   000000 221000 xsym               LDX1    DAF$WRITE
         5 001170   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 001171   000000 701011                    TSX1    0,X1
         5 001172   000000 011000                    NOP     0

      282     5465    4                 T$=ADDR(NIL);

   5465  5 001173   000001 236000 xsym               LDQ     B_VECTNIL+1
         5 001174   200455 756100                    STQ     T$,,AUTO

      283     5466    4                 END;

      284     5467    3              QNTRY.STATE=STATE_NAMES(Q$->QENTRY.STATE);

   5467  5 001175   200006 470500                    LDP0    Q$,,AUTO
         5 001176   000000 236100                    LDQ     0,,PR0
         5 001177   000030 772000                    QRL     24
         5 001200   000007 376007                    ANQ     7,DL
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:50   
         5 001201   000011 402007                    MPY     9,DL
         5 001202   040100 100406                    MLR     fill='040'O
         5 001203   000000 000011 4                  ADSC9   STATE_NAMES,Q            cn=0,n=9
         5 001204   200444 000012                    ADSC9   QNTRY+1,,AUTO            cn=0,n=10

      285     5468    3              QNTRY.REQ=SMODE_NAMES(Q$->QENTRY.REQ_);

   5468  5 001205   000000 236100                    LDQ     0,,PR0
         5 001206   000025 772000                    QRL     21
         5 001207   000007 376007                    ANQ     7,DL
         5 001210   000006 402007                    MPY     6,DL
         5 001211   040100 100406                    MLR     fill='040'O
         5 001212   000007 000006 4                  ADSC9   SMODE_NAMES,Q            cn=0,n=6
         5 001213   200446 400010                    ADSC9   QNTRY+3,,AUTO            cn=2,n=8

      286     5469    3              QNTRY.UPG=SMODE_NAMES(Q$->QENTRY.UPG_);

   5469  5 001214   000000 236100                    LDQ     0,,PR0
         5 001215   000022 772000                    QRL     18
         5 001216   000007 376007                    ANQ     7,DL
         5 001217   000006 402007                    MPY     6,DL
         5 001220   040100 100406                    MLR     fill='040'O
         5 001221   000007 000006 4                  ADSC9   SMODE_NAMES,Q            cn=0,n=6
         5 001222   200450 400010                    ADSC9   QNTRY+5,,AUTO            cn=2,n=8

      287     5470    3              QNTRY.EVID=Q$->QENTRY.EVENT_ID;

   5470  5 001223   000003 235100                    LDA     3,,PR0
         5 001224   200453 755100                    STA     QNTRY+8,,AUTO

      288     5471    3              CALL DAF$WRITE(VECTOR(QENTRY_MESS),VECTOR(QNTRY));

   5471  5 001225   000034 235000 6                  LDA     28
         5 001226   200462 452500                    STP2    T$+5,,AUTO
         5 001227   200462 236100                    LDQ     T$+5,,AUTO
         5 001230   000443 036003                    ADLQ    291,DU
         5 001231   200464 757100                    STAQ    T$+7,,AUTO
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:51   
         5 001232   200464 631500                    EPPR1   T$+7,,AUTO
         5 001233   200467 451500                    STP1    T$+10,,AUTO
         5 001234   000035 236000 6                  LDQ     29
         5 001235   200466 756100                    STQ     T$+9,,AUTO
         5 001236   200466 630500                    EPPR0   T$+9,,AUTO
         5 001237   000000 220000 xsym               LDX0    DAF$WRITE
         5 001240   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 001241   000000 701010                    TSX1    0,X0
         5 001242   000000 011000                    NOP     0

   5470  5 001243                       NOTUSER      null
      289     5472    3   NOTUSER:;
      290     5473    3              Q$=PINCRW(ENQ$,Q$->QENTRY.QCHAIN@);

   5473  5 001243   200006 470500                    LDP0    Q$,,AUTO
         5 001244   000001 220100                    LDX0    1,,PR0
         5 001245   000000 636010                    EAQ     0,X0
         5 001246   200454 036100                    ADLQ    ENQ$,,AUTO
         5 001247   200006 756100                    STQ     Q$,,AUTO

      291     5474    3              END;

   5474  5 001250   200006 236100                    LDQ     Q$,,AUTO
         5 001251   200454 116100                    CMPQ    ENQ$,,AUTO
         5 001252   001255 600000 5                  TZE     s:5475
         5 001253   200016 235100                    LDA     COUNT,,AUTO
         5 001254   001123 605000 5                  TPL     s:5457

      292     5475    2           RETURN;

   5475  5 001255   200460 221300                    LDX1  ! T$+3,,AUTO
         5 001256   000001 702211                    TSX2  ! 1,X1
      293     5476    2   END DO_RNAME;
      294     5477    1   END DAD$ENQ;

PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:52   
--  Include file information  --

   FM$SET.:E05TOU  is referenced.
   FM$CFU.:E05TOU  is referenced.
   DA_FORMAT_C.:E05TOU  is referenced.
   DA_CMD_C.:E05TOU  is referenced.
   DA_MAP_R.:E05TOU  cannot be made into a system file and is referenced.
   DA_ANLZ_R.:E05TOU  cannot be made into a system file and is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   UQ$NODES.:E05TOU  cannot be made into a system file and is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure DAD$ENQ.
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:53   

 **** Variables and constants ****

  ****  Section 001  Data  DAD$ENQ

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    60-0-0/w PTR         r     1 C$                        62-0-0/w PTR         r     1 CFU$
    63-0-0/w UBIN        r     1 CFU@                      62-0-0/w UBIN        r     1 CFU_
    60-0-0/b STRC        r     1 C_                        61-0-0/b STRC        r     1 ENQ_BASE
     0-0-0/w STRC(288)   r     1 REPORT                    14-0-0/w STRC(144)   r     1 REPORTHD00
    36-0-0/w STRC(144)   r     1 REPORTHD01                10-0-0/c STRC(144)   r     1 REPORTTX00
    20-0-0/c STRC(504)   r     1 REPORTTX01                42-0-0/c STRC(504)   r     1 REPORTTX02

  ****  Section 004 RoData DAD$ENQ

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    37-0-0/c CHAR(48)    r     1 FREEMESS                  23-0-0/c CHAR(48)    r     1 LOOP_MESS
    53-0-0/c CHAR(53)    r     1 QENTRY_MESS               71-0-0/c CHAR(34)    r     1 QIDER_MESS
   102-0-0/c STRC(1035)  r     1 RNAME_MESS
     7-0-0/c CHAR(6)     r     1 SMODE_NAMES(0:7)
     0-0-0/c CHAR(9)     r     1 STATE_NAMES(0:2)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @ENQBLK                   17-0-0/b BIT         r     1 ALLFLAG
    11-0-0/w PTR         r     1 CA$                       10-0-0/w PTR         r     1 CM$
    16-0-0/w SBIN        r     1 COUNT                    454-0-0/w PTR         r     1 ENQ$
    *0-0-0/w STRC(144)   r     1 ENQBLK                    20-0-0/b BIT         r     1 ERRFLAG
     4-0-0/w SBIN        r     1 I                         12-0-0/w SBIN        r     1 J
    13-0-0/w SBIN        r     1 NEXTH@                    15-0-0/w SBIN        r     1 NEXTP@
    14-0-0/w SBIN        r     1 NEXTX@                     5-0-0/w PTR         r     1 P$
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:54   
     6-0-0/w PTR         r     1 Q$                       443-0-0/w STRC(324)   r     1 QNTRY
     7-0-0/w PTR         r     1 R$                       222-0-0/w STRC(5202)  r     1 RNAME
   455-0-0/w PTR         r     1 T$                        21-0-0/w SBIN        r     1 USER#
    22-0-0/c CHAR(512)   r     1 USERS

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$XL_ASC_DUMP$
     0-0-0/w EPTR        r     1 DAF$WRITE                  0-0-0/w SBIN        r     1 DA_CUN

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(4608)  r     1 B$XL_ASC_DUMP              0-0-0/w STRC(288)   r     1 FM$CFU
     0-0-0/w STRC(288)   r     1 FM$CFUA                    0-0-0/c ASTR(27)    r     1 FM$CFUN
     0-0-0/w STRC(288)   r     1 FM$CFUX                    0-0-0/w STRC(288)   r     1 FM$SET
     0-0-0/w STRC(288)   r     1 FM$SETA(0:0)
     0-0-0/w STRC(144)   r     1 NNODE                      0-0-0/w STRC(144)   r     1 QENTRY
     0-0-0/w STRC(144)   r     1 QID                        0-0-0/w STRC(144)   r     1 RNAME1
     0-0-0/w STRC(144)   r     1 SUBLK                      0-0-0/w STRC(1296)  r     1 UQ_


   Procedure DAD$ENQ requires 687 words for executable code.
   Procedure DAD$ENQ requires 326 words of local(AUTO) storage.

    No errors detected in file DAD$ENQ.:E05TSI    .
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:55   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:56   
          MINI XREF LISTING

ALLFLAG
      5255**DCL      5303<<ASSIGN   5305<<ASSIGN   5306<<ASSIGN   5321>>IF       5333<<ASSIGN   5412>>IF
      5454>>IF
B$JIT.ERR.MID
      4542**DCL      4542--REDEF
B$JIT$
      4643**DCL      4536--IMP-PTR
B$XL_ASC_DUMP
      4139**DCL      5436>>CALLBLT
B$XL_ASC_DUMP$
      4138**DCL      4139--IMP-PTR  5436>>CALLBLT
C$
      5247**DCL      5371<<ASSIGN   5375>>DOWHILE  5378>>IF       5379>>ASSIGN   5380>>DOWHILE  5381<<ASSIGN
      5381>>ASSIGN   5383<<ASSIGN   5383>>ASSIGN   5384>>ASSIGN   5385>>ASSIGN   5385>>ASSIGN   5387>>IF
      5389<<ASSIGN   5395>>ASSIGN   5396<<ASSIGN   5396>>ASSIGN   5403>>CALLBLT
CA$
      5249**DCL      5379<<ASSIGN   5386>>IF       5387>>IF       5388>>CALLBLT  5389>>ASSIGN
CFU$
      5286**DCL      5370<>CALL
CFU@
      5287**DCL      5364<<ASSIGN   5371>>ASSIGN
CFU_
      5285**DCL      5286--REDEF    5356>>IF
CM$
      5248**DCL      5043--IMP-PTR  5080--IMP-PTR  5370<>CALL     5371>>ASSIGN   5374>>ASSIGN   5374>>ASSIGN
      5375>>DOWHILE  5376>>ASSIGN   5379>>ASSIGN   5380>>DOWHILE  5381>>ASSIGN   5383>>ASSIGN   5386>>IF
      5389>>ASSIGN   5393>>IF       5396>>ASSIGN
COUNT
      5254**DCL      5324<<ASSIGN   5331>>IF       5332>>IF       5336<<ASSIGN   5340<<ASSIGN   5340>>ASSIGN
      5341>>ASSIGN   5342<<ASSIGN   5342>>ASSIGN   5344--CALL     5348<<ASSIGN   5349<>CALL     5355<<ASSIGN
      5355>>ASSIGN   5414>>DOWHILE  5417>>DOWHILE  5430<<ASSIGN   5430>>ASSIGN   5435<<ASSIGN   5435>>ASSIGN
      5456>>DOWHILE  5457<<ASSIGN   5457>>ASSIGN
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:57   
C_
      5243**DCL      5247--REDEF
C_.X
      5245**DCL      5372>>IF       5373<<ASSIGN
DAA$NXTUSR
      4154**DCL-ENT  5311--CALL
DAB$OCTDUMP
      4155**DCL-ENT  5349--CALL
DAF$INIT
      4978**DCL-ENT  5322--CALL
DAF$WRITE
      4979**DCL      5335>>CALL     5344>>CALL     5360>>CALL     5412>>CALL     5454>>CALL     5464>>CALL
      5471>>CALL
DAM$MAP
      5084**DCL-ENT  5323--CALL     5347--CALL     5370--CALL     5405--CALL
DA_CUN
      4149**DCL      5308<<ASSIGN   5312>>CALLBLT  5314>>CALLBLT
DA_MAPSEG.P
      4181**DCL      4182--REDEF
DA_SDASN.DESC.TYPE0
      4166**DCL      4166--REDEF
DA_TIGRSEG.P
      4182**DCL      4183--REDEF
DO_QID
      5354**PROC     5329--CALL
DO_RNAME
      5429**PROC     5420--CALL
ENQ$
      5288**DCL       743--IMP-PTR  5323<>CALL     5324>>ASSIGN   5326>>ASSIGN   5326>>ASSIGN   5327>>DOWHILE
      5330>>ASSIGN   5331>>ASSIGN   5341>>ASSIGN   5342>>ASSIGN   5344>>CALL     5347<>CALL     5348>>ASSIGN
      5349>>CALL     5358>>ASSIGN   5405<>CALL     5415>>ASSIGN   5417>>DOWHILE  5421>>ASSIGN   5432>>ASSIGN
      5434>>DOWHILE  5451>>ASSIGN   5453>>ASSIGN   5454>>IF       5456>>DOWHILE  5473>>ASSIGN
ENQBLK
      4651**DCL         7--PROC
ENQBLK.NSUBLKS
      4663**DCL      5305>>IF       5307>>DOINDEX
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:58   
ENQBLK.SUBLK$
      4684**DCL      5306>>IF       5309>>IF       5311>>CALL
ENQ_BASE
      5281**DCL      5284--REDEF    5323<>CALL     5347<>CALL     5405<>CALL
ERRFLAG
      5256**DCL      5304<<ASSIGN   5346>>IF       5359<<ASSIGN
FM$CFU.ACCTX
      5028**DCL      5028--REDEF    5379>>ASSIGN
FM$CFU.FUN
      5027**DCL      5378>>IF
FM$CFU.NAMEX
      5028**DCL      5380>>DOWHILE  5381>>ASSIGN   5383>>ASSIGN
FM$CFUA.ACCT
      5033**DCL      5388>>CALLBLT  5395>>ASSIGN
FM$CFUA.SETX
      5033**DCL      5389>>ASSIGN   5396>>ASSIGN
FM$CFUN.C
      5039**DCL      5385>>ASSIGN
FM$CFUN.L
      5039**DCL      5039--IMP-SIZ  5384>>ASSIGN   5385>>ASSIGN
FM$CFUX.CFUT
      5043**DCL      5380>>DOWHILE
FM$CFUX.SETH
      5044**DCL      5374>>ASSIGN
FM$SET.PSN
      5075**DCL      5403>>CALLBLT
FM$SET.SETL
      5077**DCL      5376>>ASSIGN
FM$SET.USERLIST
      5076**DCL      5076--REDEF
FM$SETA
      5080**DCL      5374--ASSIGN   5376--ASSIGN   5389--ASSIGN   5396--ASSIGN
FM$SETA.USERLIST
      5081**DCL      5081--REDEF
FREEMESS
      5292**DCL      5344--CALL
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:59   
I
      5239**DCL      5307<<DOINDEX  5309>>IF       5309<<ASSIGN   5311>>CALL     5320>>IF       5341<<ASSIGN
      5344--CALL     5358<<ASSIGN   5360--CALL     5384<<ASSIGN   5388>>CALLBLT  5438<<ASSIGN   5439>>ASSIGN
      5442>>IF       5443<<ASSIGN   5443>>ASSIGN   5444>>IF       5444>>IF
J
      5250**DCL      5312<<CALLBLT  5433<<ASSIGN   5434>>DOWHILE  5436>>CALLBLT  5437>>IF       5441>>IF
      5442>>IF       5443>>ASSIGN   5444>>IF       5448>>ASSIGN   5450<<ASSIGN   5450>>ASSIGN   5458<<CALLBLT
LOOP_MESS
      5290**DCL      5335--CALL
MAP_ERR
      5346**LABEL    5323--CALLALT  5347--CALLALT
NEXTH@
      5251**DCL      5328<<ASSIGN   5330>>ASSIGN
NEXTP@
      5253**DCL      5325<<DOINDEX  5326>>ASSIGN
NEXTX@
      5252**DCL      5363<<ASSIGN   5408>>IF       5414>>DOWHILE  5415>>ASSIGN   5416<<ASSIGN
NNODE.NCHAIN@
       658**DCL      5451>>ASSIGN
NNODE.TEXT
       657**DCL      5436>>CALLBLT  5438>>ASSIGN   5441>>IF       5444>>IF       5448>>ASSIGN
NONXTUSR
      5312**LABEL    5311--CALLALT
NOTIN
      5314**LABEL    5312--CALLALT
NOTUSER IN PROCEDURE DO_RNAME
      5470**LABEL    5458--CALLALT
P$
      5240**DCL      5324>>ASSIGN   5326<<ASSIGN   5327>>DOWHILE  5328>>ASSIGN   5330<<ASSIGN   5331<<ASSIGN
      5342>>ASSIGN   5356>>IF       5356>>IF       5356>>IF       5358>>ASSIGN   5360>>CALL     5363>>ASSIGN
      5364>>ASSIGN   5367>>ASSIGN   5368>>IF
Q$
      5241**DCL      5453<<ASSIGN   5454>>IF       5456>>DOWHILE  5458>>CALLBLT  5461>>ASSIGN   5462>>ASSIGN
      5467>>ASSIGN   5468>>ASSIGN   5469>>ASSIGN   5470>>ASSIGN   5473<<ASSIGN   5473>>ASSIGN
QENTRY.DOM_USER
       731**DCL       734--REDEF
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:60   
QENTRY.DOM_USER.USER
       733**DCL      5458>>CALLBLT
QENTRY.EVENT_ID
       739**DCL      5470>>ASSIGN
QENTRY.QCHAIN@
       735**DCL      5473>>ASSIGN
QENTRY.REQUEST
       718**DCL       721--REDEF
QENTRY.REQ_
       721**DCL      5468>>ASSIGN
QENTRY.STATE
       714**DCL      5467>>ASSIGN
QENTRY.UPGRADE
       722**DCL       725--REDEF
QENTRY.UPG_
       725**DCL      5469>>ASSIGN
QENTRY_MESS
      5294**DCL      5471--CALL
QID
       672**DCL      5324--ASSIGN   5342--ASSIGN   5360--CALL
QID.HCHAIN@
       676**DCL      5328>>ASSIGN
QID.NAME
       679**DCL      5356>>IF       5356>>IF       5364>>ASSIGN   5367>>ASSIGN   5368>>IF
QID.TYPE
       673**DCL      5356>>IF
QID.XCHAIN@
       675**DCL      5363>>ASSIGN   5461>>ASSIGN
QIDER_MESS
      5296**DCL      5360--CALL
QNTRY
      5270**DCL      5471--CALL
QNTRY.EVID
      5276**DCL      5470<<ASSIGN
QNTRY.Q$
      5271**DCL      5462<<ASSIGN
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:61   
QNTRY.REQ
      5273**DCL      5468<<ASSIGN
QNTRY.STATE
      5272**DCL      5467<<ASSIGN
QNTRY.UPG
      5274**DCL      5469<<ASSIGN
QNTRY.W1
      5275**DCL      5461<<ASSIGN
R$
      5242**DCL      5410>>ASSIGN   5415<<ASSIGN   5416>>ASSIGN   5417>>DOWHILE  5418>>ASSIGN   5421<<ASSIGN
      5421>>ASSIGN   5432>>ASSIGN   5453>>ASSIGN
REPORT
      5102**DCL      5322<>CALL
REPORT.CURLINE
      5119**DCL      5343>>IF       5343<<ASSIGN
REPORTHD00
      5169**DCL      5137--DCLINIT
REPORTHD01
      5212**DCL      5184--DCLINIT
REPORTTX00
      5145**DCL      5132--DCLINIT
REPORTTX01
      5187**DCL      5177--DCLINIT
REPORTTX02
      5230**DCL      5220--DCLINIT
RETRET IN PROCEDURE DO_QID
      5421**LABEL    5370--CALLALT  5405--CALLALT
RNAME
      5259**DCL      5412--CALL     5454--CALL     5464--CALL
RNAME.NAME
      5267**DCL      5367<<ASSIGN
RNAME.NDOTA
      5266**DCL      5366<<ASSIGN   5372<<ASSIGN   5385<<ASSIGN   5386<<ASSIGN   5388<<CALLBLT  5395<<ASSIGN
      5398>>IF       5398>>IF       5399>>IF
RNAME.PSN
      5264**DCL      5368<<ASSIGN   5399<<ASSIGN   5400<<ASSIGN   5403<<CALLBLT
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:62   
RNAME.R$
      5260**DCL      5261--REDEF    5410<<ASSIGN   5418<<ASSIGN
RNAME.SEP
      5265**DCL      5365<<ASSIGN   5391<<ASSIGN   5394<<ASSIGN
RNAME.TC.C
      5263**DCL      5411<<ASSIGN   5419<<ASSIGN
RNAME.TFLG
      5268**DCL      5407<<ASSIGN   5409<<ASSIGN   5445<<ASSIGN   5445>>ASSIGN   5447<<ASSIGN   5447>>ASSIGN
RNAME.TXT
      5269**DCL      5431<<ASSIGN   5434--DOWHILE  5436<<CALLBLT  5439<<ASSIGN   5441>>IF       5444>>IF
      5448<<ASSIGN
RNAME1.NCHAIN@
       693**DCL      5432>>ASSIGN
RNAME1.QCHAIN@
       689**DCL      5453>>ASSIGN
RNAME1.RCHAIN@
       690**DCL      5421>>ASSIGN
RNAME1.XCHAIN@
       688**DCL      5416>>ASSIGN
RNAME_MESS
      5298**DCL      5412--CALL     5454--CALL     5464--CALL
SMODE_NAMES
      5279**DCL      5468>>ASSIGN   5469>>ASSIGN
STATE_NAMES
      5277**DCL      5467>>ASSIGN
SUBLK
      4696**DCL      5311<>CALL
SUBLK.CODE
      4704**DCL      5306>>IF       5309>>IF
T$
      5289**DCL      5374<<ASSIGN   5375>>DOWHILE  5375>>DOWHILE  5376<<ASSIGN   5376>>ASSIGN   5393>>IF
      5432<<ASSIGN   5434>>DOWHILE  5436>>CALLBLT  5438>>ASSIGN   5441>>IF       5444>>IF       5448>>ASSIGN
      5451<<ASSIGN   5451>>ASSIGN   5463>>IF       5465<<ASSIGN
UQ_
       743**DCL      5324--ASSIGN   5342--ASSIGN   5349<>CALL
UQ_.FREE_BLOCKS
PL6.E3A0      #001=DAD$ENQ File=DAD$ENQ.:E05TSI                                  TUE 07/29/97 12:43 Page:63   
       750**DCL      5341>>ASSIGN   5344--CALL
UQ_.NEXT_PAGE@
       746**DCL       747--REDEF    5324>>ASSIGN   5342>>ASSIGN   5348>>ASSIGN
UQ_.QBUCKET@
       744**DCL      5325--DOINDEX  5325--DOINDEX  5326>>ASSIGN
USER#
      5257**DCL      5302<<ASSIGN   5312>>CALLBLT  5314>>CALLBLT  5315<<ASSIGN   5315>>ASSIGN   5320<<ASSIGN
      5321>>IF       5334<<ASSIGN   5454>>IF       5458>>IF       5458>>CALLBLT  5463>>IF
USERS
      5258**DCL      5312>>CALLBLT  5314<<CALLBLT  5458>>CALLBLT
